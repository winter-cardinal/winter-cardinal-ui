/*
 Winter Cardinal UI v0.67.0
 Copyright (C) 2019 Toshiba Corporation
 SPDX-License-Identifier: Apache-2.0

 Material Design icons by Google
 Apache license version 2.0.
*/
!function(t){"use strict";var n,i={};!function(t){t[t.CIRCLE=0]="CIRCLE",t[t.RECTANGLE=1]="RECTANGLE",t[t.RECTANGLE_ROUNDED=2]="RECTANGLE_ROUNDED",t[t.TRIANGLE=3]="TRIANGLE",t[t.TRIANGLE_ROUNDED=4]="TRIANGLE_ROUNDED",t[t.LINE=5]="LINE",t[t.IMAGE=6]="IMAGE",t[t.IMAGE_SDF=7]="IMAGE_SDF",t[t.GROUP=8]="GROUP",t[t.BAR=9]="BAR",t[t.LABEL=10]="LABEL",t[t.NULL=11]="NULL",t[t.GROUP_SHADOWED=12]="GROUP_SHADOWED",t[t.LINE_OF_CIRCLES=13]="LINE_OF_CIRCLES",t[t.LINE_OF_RECTANGLES=14]="LINE_OF_RECTANGLES",t[t.LINE_OF_RECTANGLE_ROUNDEDS=15]="LINE_OF_RECTANGLE_ROUNDEDS",t[t.LINE_OF_TRIANGLES=16]="LINE_OF_TRIANGLES",t[t.LINE_OF_TRIANGLE_ROUNDEDS=17]="LINE_OF_TRIANGLE_ROUNDEDS",t[t.EMBEDDED=18]="EMBEDDED",t[t.LAYER=19]="LAYER",t[t.EXTENSION=1e3]="EXTENSION"}(n||(n={}));var r,e={};!function(t){t[t.NONE=0]="NONE",t[t.CLOSED=1]="CLOSED",t[t.NON_EXPANDING_WIDTH=2]="NON_EXPANDING_WIDTH",t[t.NON_SHRINKING_WIDTH=4]="NON_SHRINKING_WIDTH",t[t.NON_SCALING_DOT_AND_DASH=8]="NON_SCALING_DOT_AND_DASH",t[t.DOTTED=16]="DOTTED",t[t.DOTTED_DENSELY=32]="DOTTED_DENSELY",t[t.DOTTED_LOOSELY=64]="DOTTED_LOOSELY",t[t.DASHED=128]="DASHED",t[t.DASHED_DENSELY=256]="DASHED_DENSELY",t[t.DASHED_LOOSELY=512]="DASHED_LOOSELY",t[t.DOTTED_MASK=112]="DOTTED_MASK",t[t.DASHED_MASK=896]="DASHED_MASK",t[t.NON_SOLID_MASK=1008]="NON_SOLID_MASK"}(r||(r={}));var u,s,h,o,a,c=function(t,n,i,e){return e.set(2*t,0),i&r.NON_SOLID_MASK&&(i&r.DOTTED?e.set(n,n):i&r.DOTTED_DENSELY?e.set(n,.5*n):i&r.DOTTED_LOOSELY?e.set(n,2*n):i&r.DASHED?e.set(2*n,n):i&r.DASHED_DENSELY?e.set(2*n,.5*n):i&r.DASHED_LOOSELY&&e.set(2*n,2*n)),e},f=function(t){var n=t&r.NON_EXPANDING_WIDTH?1:0,i=t&r.NON_SHRINKING_WIDTH?2:0,e=t&r.NON_SCALING_DOT_AND_DASH?4:0;return t&r.NON_SOLID_MASK?n|i|e:n|i},l=new t.Point,v=function(){function t(){this.i="",this.u=0}return Object.defineProperty(t.prototype,"position",{get:function(){return this.u},set:function(t){this.u=t},enumerable:!1,configurable:!0}),t.prototype.init=function(t){this.i=t,this.u=0},t.prototype.hasNext=function(){return this.u<this.i.length},t.prototype.findNextBreak=function(t,n){for(var i=t.length,r=n;r<i;++r){var e=t.charCodeAt(r);if(!this.isLowSurrogate(e)&&!this.isVariationSelector(e))return r}return i},t.prototype.isHighSurrogate=function(t){return 55296<=t&&t<=56319},t.prototype.isLowSurrogate=function(t){return 56320<=t&&t<=57343},t.prototype.isVariationSelector=function(t){return 65024<=t&&t<=65039},t.prototype.next=function(){var t=this.i,n=this.u,i=this.findNextBreak(t,n+1),r=t.substring(n,i);return this.u=i,r},t.prototype.advance=function(t){var n=this.i,i=this.u,r=this.findNextBreak(n,i+1);return n.substring(i,r)!==t&&(this.u=r,!0)},t.from=function(n){null==t.h&&(t.h=new t);var i=t.h;return i.init(n),i},t.h=null,t}();!function(t){t[t.NORMAL=0]="NORMAL",t[t.BOLD=1]="BOLD"}(u||(u={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ITALIC=1]="ITALIC"}(s||(s={})),function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t[t.OUTSIDE_LEFT=3]="OUTSIDE_LEFT",t[t.OUTSIDE_RIGHT=4]="OUTSIDE_RIGHT"}(h||(h={})),function(t){t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM",t[t.OUTSIDE_TOP=3]="OUTSIDE_TOP",t[t.OUTSIDE_BOTTOM=4]="OUTSIDE_BOTTOM"}(o||(o={})),function(t){t[t.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",t[t.TOP_TO_BOTTOM=1]="TOP_TO_BOTTOM",t[t.BOTTOM_TO_TOP=2]="BOTTOM_TO_TOP"}(a||(a={}));var b,g=function(t,n,i,r){var e=i-t,u=r-n;return Math.sqrt(e*e+u*u)},d=1e-5,m=new t.Point,w=function(t){return 12*Math.ceil(t.text.value.length/12)},p=function(t,n,i){for(var r=3*n,e=r+3*i;r<e;r+=3)t[r+0]=0,t[r+1]=0,t[r+2]=2},O=function(t,n,i,r){for(var e=0,u=3*i,s=r>>1;e<s;e+=1,u+=6){var h=n+(e<<2);t[u+0]=h+0,t[u+1]=h+1,t[u+2]=h+3,t[u+3]=h+1,t[u+4]=h+2,t[u+5]=h+3}},D=function(t,n,i,r,e,s,h,o){var a;if(null!=r)for(var c=.4/12*o*(r.font.size/e),f=.4*s,l=h===u.NORMAL?0:.05,v=(a=6*n)+6*i;a<v;a+=6)t[a+0]=c,t[a+1]=f,t[a+2]=l,t[a+3]=d,t[a+4]=d,t[a+5]=d;else for(v=(a=6*n)+6*i;a<v;a+=6)t[a+0]=0,t[a+1]=0,t[a+2]=d,t[a+3]=d,t[a+4]=d,t[a+5]=d},E=function(t,n,i,r,e,u,s,a,c,f,l,v,b,g,d,m,w,p,O,D,E){switch(t){case h.LEFT:switch(n){case o.TOP:E.x=c+w*(i+e)+O*(r+u),E.y=f+p*(i+e)+D*(r+u);break;case o.MIDDLE:E.x=.5*(c+d)+w*(i+e)+O*(r-.5*a),E.y=.5*(f+m)+p*(i+e)+D*(r-.5*a);break;case o.BOTTOM:E.x=d+w*(i+e)+O*(r-u-a),E.y=m+p*(i+e)+D*(r-u-a);break;case o.OUTSIDE_TOP:E.x=c+w*(i+e)+O*(r-u-a),E.y=f+p*(i+e)+D*(r-u-a);break;case o.OUTSIDE_BOTTOM:E.x=d+w*(i+e)+O*(r+u),E.y=m+p*(i+e)+D*(r+u)}break;case h.CENTER:switch(n){case o.TOP:E.x=.5*(c+l)+w*(i-.5*s)+O*(r+u),E.y=.5*(f+v)+p*(i-.5*s)+D*(r+u);break;case o.MIDDLE:E.x=.5*(c+b)+w*(i-.5*s)+O*(r-.5*a),E.y=.5*(f+g)+p*(i-.5*s)+D*(r-.5*a);break;case o.BOTTOM:E.x=.5*(d+b)+w*(i-.5*s)+O*(r-u-a),E.y=.5*(m+g)+p*(i-.5*s)+D*(r-u-a);break;case o.OUTSIDE_TOP:E.x=.5*(c+l)+w*(i-.5*s)+O*(r-u-a),E.y=.5*(f+v)+p*(i-.5*s)+D*(r-u-a);break;case o.OUTSIDE_BOTTOM:E.x=.5*(d+b)+w*(i-.5*s)+O*(r+u),E.y=.5*(m+g)+p*(i-.5*s)+D*(r+u)}break;case h.RIGHT:switch(n){case o.TOP:E.x=l+w*(i-e-s)+O*(r+u),E.y=v+p*(i-e-s)+D*(r+u);break;case o.MIDDLE:E.x=.5*(l+b)+w*(i-e-s)+O*(r-.5*a),E.y=.5*(v+g)+p*(i-e-s)+D*(r-.5*a);break;case o.BOTTOM:E.x=b+w*(i-e-s)+O*(r-u-a),E.y=g+p*(i-e-s)+D*(r-u-a);break;case o.OUTSIDE_TOP:E.x=l+w*(i-e-s)+O*(r-u-a),E.y=v+p*(i-e-s)+D*(r-u-a);break;case o.OUTSIDE_BOTTOM:E.x=b+w*(i-e-s)+O*(r+u),E.y=g+p*(i-e-s)+D*(r+u)}break;case h.OUTSIDE_LEFT:switch(n){case o.TOP:E.x=c+w*(i-e-s)+O*(r+u),E.y=f+p*(i-e-s)+D*(r+u);break;case o.MIDDLE:E.x=.5*(c+d)+w*(i-e-s)+O*(r-.5*a),E.y=.5*(f+m)+p*(i-e-s)+D*(r-.5*a);break;case o.BOTTOM:E.x=d+w*(i-e-s)+O*(r-u-a),E.y=m+p*(i-e-s)+D*(r-u-a);break;case o.OUTSIDE_TOP:E.x=c+w*(i-e-s)+O*(r-u-a),E.y=f+p*(i-e-s)+D*(r-u-a);break;case o.OUTSIDE_BOTTOM:E.x=d+w*(i-e-s)+O*(r+u),E.y=m+p*(i-e-s)+D*(r+u)}break;case h.OUTSIDE_RIGHT:switch(n){case o.TOP:E.x=l+w*(i+e)+O*(r+u),E.y=v+p*(i+e)+D*(r+u);break;case o.MIDDLE:E.x=.5*(l+b)+w*(i+e)+O*(r-.5*a),E.y=.5*(v+g)+p*(i+e)+D*(r-.5*a);break;case o.BOTTOM:E.x=b+w*(i+e)+O*(r-u-a),E.y=g+p*(i+e)+D*(r-u-a);break;case o.OUTSIDE_TOP:E.x=l+w*(i+e)+O*(r-u-a),E.y=v+p*(i+e)+D*(r-u-a);break;case o.OUTSIDE_BOTTOM:E.x=b+w*(i+e)+O*(r+u),E.y=g+p*(i+e)+D*(r+u)}}},M=function(t,n,i,r,e){var u=t*t+n*n;if(d<u){var s=Math.sqrt(u),h=1/s;return e.set(t*h,n*h),s}return e.set(i,r),0},S=function(t,n,i,r,e,u,c,f,l,b,d,w,p,O,D,S,N,I,C,R,y,k,x,L,B){var _=.5*c,P=.5*f,F=m;F.set(e-_,u-P),B.apply(F,F);var U=F.x,z=F.y;F.set(e+_,u-P),B.apply(F,F);var G=F.x,H=F.y;F.set(e+_,u+P),B.apply(F,F);var V=F.x,W=F.y,X=U+(V-G),Y=z+(W-H),K=g(U,z,G,H);M(B.a,B.b,1,0,F);var J=F.x,Z=F.y,q=g(U,z,X,Y);M(B.c,B.d,0,1,F);for(var $=F.x,Q=F.y,tt=0,nt=0,it=0,rt=Math.max(0,b+I),et=0,ut=l.characters,st=v.from(d),ht=0;st.hasNext();)"\n"!==(zt=st.next())?(0<ht&&(et+=Math.max(0,ht+N)),(Ht=ut[zt])?(ht=Ht.advance,it=Ht.height):ht=0):(et+=ht,ht=0,tt=Math.max(tt,et),et=0,nt+=rt);var ot=b/l.font.size;et+=ht,tt=Math.max(tt,et)*ot,et=0,it*=ot,nt+=b;var at=0,ct=0,ft=NaN;switch(C){case a.LEFT_TO_RIGHT:if(E(p,O,D,S,R,y,tt,nt,U,z,G,H,V,W,X,Y,J,Z,$,Q,F),at=F.x,ct=F.y,k)switch(p){case h.LEFT:case h.CENTER:case h.RIGHT:switch(O){case o.TOP:case o.MIDDLE:case o.BOTTOM:ft=K-2*R}}break;case a.TOP_TO_BOTTOM:if(F.set($,Q),$=-J,Q=-Z,J=F.x,Z=F.y,E(function(t){switch(t){case o.TOP:return h.LEFT;case o.MIDDLE:return h.CENTER;case o.BOTTOM:return h.RIGHT;case o.OUTSIDE_TOP:return h.OUTSIDE_LEFT;case o.OUTSIDE_BOTTOM:return h.OUTSIDE_RIGHT}}(O),function(t){switch(t){case h.LEFT:return o.BOTTOM;case h.CENTER:return o.MIDDLE;case h.RIGHT:return o.TOP;case h.OUTSIDE_LEFT:return o.OUTSIDE_BOTTOM;case h.OUTSIDE_RIGHT:return o.OUTSIDE_TOP}}(p),S,D,y,R,tt,nt,G,H,V,W,X,Y,U,z,J,Z,$,Q,F),at=F.x,ct=F.y,k)switch(O){case o.TOP:case o.MIDDLE:case o.BOTTOM:switch(p){case h.LEFT:case h.CENTER:case h.RIGHT:ft=q-2*y}}break;case a.BOTTOM_TO_TOP:if(F.set($,Q),$=J,Q=Z,J=-F.x,Z=-F.y,E(function(t){switch(t){case o.TOP:return h.RIGHT;case o.MIDDLE:return h.CENTER;case o.BOTTOM:return h.LEFT;case o.OUTSIDE_TOP:return h.OUTSIDE_RIGHT;case o.OUTSIDE_BOTTOM:return h.OUTSIDE_LEFT}}(O),function(t){switch(t){case h.LEFT:return o.TOP;case h.CENTER:return o.MIDDLE;case h.RIGHT:return o.BOTTOM;case h.OUTSIDE_LEFT:return o.OUTSIDE_TOP;case h.OUTSIDE_RIGHT:return o.OUTSIDE_BOTTOM}}(p),S,D,y,R,tt,nt,X,Y,U,z,G,H,V,W,J,Z,$,Q,F),at=F.x,ct=F.y,k)switch(O){case o.TOP:case o.MIDDLE:case o.BOTTOM:switch(p){case h.LEFT:case h.CENTER:case h.RIGHT:ft=q-2*y}}}if(ft<tt){var lt=.5*(tt-ft);x[0]=at+J*lt,x[1]=ct+Z*lt,x[2]=J,x[3]=Z,x[4]=$,x[5]=Q,x[6]=ft,x[7]=nt}else x[0]=at,x[1]=ct,x[2]=J,x[3]=Z,x[4]=$,x[5]=Q,x[6]=tt,x[7]=nt;var vt=L.x0,bt=L.x1,gt=L.x3,dt=L.y0,mt=L.y1,wt=L.y3,pt=bt-vt,Ot=mt-dt,Dt=gt-vt,Et=wt-dt,Mt=rt*$,St=rt*Q,Tt=ot*J,jt=ot*Z,Nt=.5*(it-b),It=Nt*$,Ct=Nt*Q,At=w===s.NORMAL?0:.25*b,Rt=at-It+At*Tt,yt=ct-Ct+At*jt,kt=at+It+b*$,xt=ct+Ct+b*Q,Lt=Rt,Bt=yt,_t=kt,Pt=xt;et=0,ht=0,st.position=0;for(var Ft=0,Ut=2*i;st.hasNext();Ut+=8){var zt;if("\n"!==(zt=st.next())){var Gt=et;0<ht&&(et+=Math.max(0,ht+N));var Ht,Vt=et*Tt,Wt=et*jt;if(Lt=Rt+Vt,Bt=yt+Wt,_t=kt+Vt,Pt=xt+Wt,Ft+=1,Ht=ut[zt]){var Xt=Ht.advance;if(ft<(et+Xt)*ot){var Yt=ut["..."];if(Yt){if(1<Ft&&ft<(et+Yt.advance)*ot){Ut-=8,Ft-=1;var Kt=(et=Gt)*Tt,Jt=et*jt;Lt=Rt+Kt,Bt=yt+Jt,_t=kt+Kt,Pt=xt+Jt}for(ht=Yt.advance,j(t,n,Ut,Yt,l,Tt,jt,Lt,Bt,_t,Pt,pt,Ot,Dt,Et,vt,dt),Ut+=8;;Ut+=8){if(!st.hasNext()||!st.advance("\n")){Ut-=8;break}T(t,n,Ut,Lt,Bt,_t,Pt,vt,dt,gt,wt),Ft+=1}}else ht=Xt,T(t,n,Ut,Lt,Bt,_t,Pt,vt,dt,gt,wt)}else ht=Xt,j(t,n,Ut,Ht,l,Tt,jt,Lt,Bt,_t,Pt,pt,Ot,Dt,Et,vt,dt)}else ht=0,T(t,n,Ut,Lt,Bt,_t,Pt,vt,dt,gt,wt)}else et+=ht,ht=0,T(t,n,Ut,Lt=Rt+=Mt,Bt=yt+=St,_t=kt+=Mt,Pt=xt+=St,vt,dt,gt,wt),A(t,J,Z,Ft,Ut,tt-et*ot,C,p,O),et=0,Ft=0}A(t,J,Z,Ft,Ut,tt-(et+=ht)*ot,C,p,O);for(var Zt=2*(i+r);Ut<Zt;Ut+=2)t[Ut+0]=at,t[Ut+1]=ct,n[Ut+0]=vt,n[Ut+1]=dt},T=function(t,n,i,r,e,u,s,h,o,a,c){t[i+0]=r,t[i+1]=e,t[i+2]=r,t[i+3]=e,t[i+4]=u,t[i+5]=s,t[i+6]=u,t[i+7]=s,n[i+0]=h,n[i+1]=o,n[i+2]=h,n[i+3]=o,n[i+4]=a,n[i+5]=c,n[i+6]=a,n[i+7]=c},j=function(t,n,i,r,e,u,s,h,o,a,c,f,l,v,b,g,d){var m=r.x-r.origin.x,w=r.width,p=m*u,O=m*s,D=(m+w)*u,E=(m+w)*s;t[i+0]=h+p,t[i+1]=o+O,t[i+2]=h+D,t[i+3]=o+E,t[i+4]=a+D,t[i+5]=c+E,t[i+6]=a+p,t[i+7]=c+O;var M=r.x/e.width,S=r.y/e.height,T=(r.x+r.width)/e.width,j=(r.y+r.height)/e.height,N=f*M,I=l*M,C=f*T,A=l*T,R=v*S,y=b*S,k=v*j,x=b*j;n[i+0]=g+N+R,n[i+1]=d+I+y,n[i+2]=g+C+R,n[i+3]=d+A+y,n[i+4]=g+C+k,n[i+5]=d+A+x,n[i+6]=g+N+k,n[i+7]=d+I+x},N=function(t,n,i,r,e){for(var u=0,s=n-8*i;u<i;u+=1,s+=8)t[s+0]+=r,t[s+1]+=e,t[s+2]+=r,t[s+3]+=e,t[s+4]+=r,t[s+5]+=e,t[s+6]+=r,t[s+7]+=e},I=function(t,n,i,r,e,u){N(t,n,i,(r*=.5)*e,r*u)},C=function(t,n,i,r,e,u){N(t,n,i,r*e,r*u)},A=function(t,n,i,r,e,u,s,c,f){if(d<u)switch(s){case a.LEFT_TO_RIGHT:switch(c){case h.OUTSIDE_RIGHT:case h.LEFT:break;case h.CENTER:I(t,e,r,u,n,i);break;case h.OUTSIDE_LEFT:case h.RIGHT:C(t,e,r,u,n,i)}break;case a.TOP_TO_BOTTOM:switch(f){case o.OUTSIDE_BOTTOM:case o.TOP:break;case o.MIDDLE:I(t,e,r,u,n,i);break;case o.OUTSIDE_TOP:case o.BOTTOM:C(t,e,r,u,n,i)}break;case a.BOTTOM_TO_TOP:switch(f){case o.OUTSIDE_BOTTOM:case o.TOP:C(t,e,r,u,n,i);break;case o.MIDDLE:I(t,e,r,u,n,i);break;case o.OUTSIDE_TOP:case o.BOTTOM:}}},R=function(t,n){return(R=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])})(t,n)};function y(t,n){function i(){this.constructor=t}R(t,n),t.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}!function(t){t[t.TOP=0]="TOP",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=3]="BOTTOM"}(b||(b={}));var k,x,L=function(){function n(t,n,i,e){this.o=t,this.l=0,this.v=[0,0,0,0],this.g=[],this.O=null!=e?e:r.NONE,this.S=null!=i?i:-1,this.u=n,this.T=NaN,this.j=NaN,this.N=NaN,this.I=NaN}return n.prototype.getComputedSize=function(t,n,i,r){if(0<=t)return t;switch(n){case b.TOP:case b.BOTTOM:return Math.abs(r);case b.RIGHT:case b.LEFT:return Math.abs(i)}return 0},n.prototype.update=function(){var t=this.o.size,n=t.x,i=t.y,r=this.u,e=this.S;if(this.T!==e||this.j!==n||this.N!==i||this.I!==r){this.l+=1,this.T=e,this.j=n,this.N=i,this.I=r;var u=.5*n,s=.5*i,h=this.getComputedSize(e,r,n,i),o=this.v;switch(r){case b.TOP:o[0]=0,o[1]=-s,o[2]=0,o[3]=-s+h;break;case b.RIGHT:o[0]=u,o[1]=0,o[2]=u-h,o[3]=0;break;case b.BOTTOM:o[0]=0,o[1]=s,o[2]=0,o[3]=s-h;break;case b.LEFT:o[0]=-u,o[1]=0,o[2]=-u+h,o[3]=0}}},Object.defineProperty(n.prototype,"length",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.update(),this.l},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){return this.update(),this.v},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"segments",{get:function(){return this.g},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this.S},set:function(t){this.moveTo(void 0,t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.u},set:function(t){this.moveTo(t,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.O},set:function(t){this.moveTo(void 0,void 0,t)},enumerable:!1,configurable:!0}),n.prototype.copy=function(t){return t instanceof n?this.moveTo(t.position,t.size,t.style):this.moveTo(void 0,void 0,t.style)},n.prototype.set=function(t,n,i){var r,e;if(null!=t){var u=t[0];if(0===u){var s=t[1];r=s<=0?b.TOP:b.BOTTOM,e=Math.abs(t[3]-s)}else r=u<=0?b.LEFT:b.RIGHT,e=Math.abs(t[2]-u)}return this.moveTo(r,e,i)},n.prototype.moveTo=function(t,n,i){var r=!1;return null!=i&&this.O!==i&&(this.O=i,r=!0),null!=t&&this.u!==t&&(this.u=t,r=!0),null!=n&&this.S!==n&&(this.S=n,r=!0),r&&this.o.updateUploaded(),this},n.prototype.clone=function(t){return new n(t,this.u,this.S,this.O)},n.prototype.toPoints=function(n){for(var i=[],r=this.values,e=0,u=r.length;e<u;e+=2){var s=new t.Point(r[e+0],r[e+1]);i.push(n.apply(s,s))}return i},n.prototype.serialize=function(t){return t.addResource("["+this.u+","+this.S+","+this.O+"]")},n.prototype.deserialize=function(t,n){if(0<=t&&t<n.resources.length){var i=n.resources[t],r=JSON.parse(i);this.moveTo(r[0],r[1],r[2])}},n.prototype.calcHitPointAbs=function(t,n,i,r,e,u,s,h){if(2<=this.length){var o=this.v;if(s(t,n,o[0],o[1],o[2],o[3],0,e,h))return!0}return!1},n}(),B=function(){function t(){}return t.add=function(n){t.INSTANCES.push(n)},t.first=function(){var n=t.INSTANCES;if(0<n.length)return n[0];throw new Error("No application found.")},t.last=function(){var n=t.INSTANCES;if(0<n.length)return n[n.length-1];throw new Error("No application found.")},t.get=function(n){var i=t.INSTANCES;return 0<=n&&n<i.length?i[n]:null},t.indexOf=function(n){return t.INSTANCES.indexOf(n)},t.size=function(){return t.INSTANCES.length},t.getStage=function(t){for(var n=t;n.parent;)n=n.parent;return"application"in n&&"layer"in n?n:null},t.find=function(t){var n=this.getStage(t);return n?n.layer.application:null},t.getLayerBase=function(t){var n=this.getStage(t);return n?n.layer.application.getLayerBase():null},t.getLayerOverlay=function(t){var n=this.getStage(t);return n?n.layer.application.getLayerOverlay():null},t.getLayer=function(t){var n=this.getStage(t);return n?n.layer:null},t.getResolution=function(t){var n,i=this.getLayer(t);return i?i.renderer.resolution:null!==(n=window.devicePixelRatio)&&void 0!==n?n:1},t.update=function(n){if(n){var i=this.getStage(n);i&&i.layer.update()}else for(var r=t.INSTANCES,e=0,u=r.length;e<u;++e)r[e].update()},t.render=function(n){if(n){var i=this.getStage(n);i&&i.layer.render()}else for(var r=t.INSTANCES,e=0,u=r.length;e<u;++e)r[e].render()},t.INSTANCES=[],t}(),_=function(){function t(){this.values=[]}return t.prototype.add=function(t,n){var i=this.values;null!=n?i.splice(n,0,t):i.push(t)},t.prototype.addAll=function(t){for(var n=t,i=this.values,r=0,e=n.length;r<e;++r)i.push(n[r])},t.prototype.indexOf=function(t){for(var n=this.values,i=0,r=n.length;i<r;++i)if(n[i]===t)return i;for(i=0,r=n.length;i<r;++i)if(n[i].isEquals(t))return i;return-1},t.prototype.get=function(t){var n=this.values[t];return null!=n?n:null},t.prototype.set=function(t,n){this.values[t]=n},t.prototype.remove=function(t){this.values.splice(t,1)},t.prototype.clear=function(){this.values.length=0},t.prototype.size=function(){return this.values.length},t.prototype.swap=function(t,n){var i=this.values,r=i[n];i[n]=i[t],i[t]=r},t.prototype.serialize=function(t){for(var n=[],i=this.values,r=0,e=i.length;r<e;++r)n.push(i[r].serialize(t));return n},t}();!function(t){t[t.NONE=0]="NONE",t[t.TRANSFORM=1]="TRANSFORM",t[t.SIZE=2]="SIZE",t[t.STYLE=4]="STYLE",t[t.ACTION=8]="ACTION",t[t.POINTS=16]="POINTS",t[t.STATE=32]="STATE",t[t.ALL=63]="ALL"}(k||(k={})),function(t){t[t.NONE=0]="NONE",t[t.HOVERED=1]="HOVERED",t[t.ACTIVE=2]="ACTIVE",t[t.FOCUSED=4]="FOCUSED",t[t.UNFOCUSABLE=8]="UNFOCUSABLE",t[t.FOCUS_ROOT=16]="FOCUS_ROOT",t[t.FOCUS_REVERSE=32]="FOCUS_REVERSE",t[t.READ_ONLY=64]="READ_ONLY",t[t.DISABLED=128]="DISABLED",t[t.DRAGGING=256]="DRAGGING",t[t.PRESSED=512]="PRESSED",t[t.INVALID=1024]="INVALID",t[t.SUCCEEDED=2048]="SUCCEEDED",t[t.FAILED=4096]="FAILED",t[t.WARNED=8192]="WARNED",t[t.CHANGED=16384]="CHANGED",t[t.ALTERNATED=32768]="ALTERNATED",t[t.CUSTOM=65536]="CUSTOM"}(x||(x={}));var P,F=function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},U=function(){function t(t){this.C=x.NONE,this.A=x.NONE,this.R=x.NONE,this.k=x.NONE,this.L=t}return t.prototype.is=function(t){return!!(this.C&t)},t.prototype.in=function(t){return!!(this.A&t)},t.prototype.on=function(t){return!!(this.R&t)},t.prototype.under=function(t){return!!(this.k&t)},t.prototype.add=function(t){return this.set(t,!0)},t.prototype.remove=function(t){return this.set(t,!1)},t.prototype.set=function(t,n){var i=this.C,r=F(n)?(i|t)&~n:n?i|t:i&~t;if(i!==r){this.C=r;var e=this.R,u=this.k;this.onChange(r,e,u,i,e,u)}return this},t.prototype.update=function(n){if(n instanceof t){var i=n.local,r=n.merged,e=this.R,u=this.k;if(i!==e||r!==u){this.R=i,this.k=r;var s=this.C;this.onChange(s,i,r,s,e,u)}}return this},t.prototype.copy=function(n,i,r,e){return F(n)?(this.C=n,this.R=i,this.k=r,this.A=e):n instanceof t&&(this.C=n.local,this.R=n.parentLocal,this.k=n.parentMerged,this.A=n.merged),this},t.prototype.onChange=function(n,i,r,e,u,s){var h=n|r,o=this.A;this.A=h;var a=this.L;if(a){var c=this.B;null==c&&(c=new t,this.B=c),c.copy(e,u,s,o),a(this,c)}},Object.defineProperty(t.prototype,"local",{get:function(){return this.C},set:function(t){this.C=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentLocal",{get:function(){return this.R},set:function(t){this.R=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parentMerged",{get:function(){return this.k},set:function(t){this.k=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"merged",{get:function(){return this.A},set:function(t){this.A=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isHovered",{get:function(){return this.is(x.HOVERED)},set:function(t){this.set(x.HOVERED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inHovered",{get:function(){return this.in(x.HOVERED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHovered",{get:function(){return this.on(x.HOVERED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underHovered",{get:function(){return this.under(x.HOVERED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this.is(x.ACTIVE)},set:function(t){this.set(x.ACTIVE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inActive",{get:function(){return this.in(x.ACTIVE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onActive",{get:function(){return this.on(x.ACTIVE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underActive",{get:function(){return this.under(x.ACTIVE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPressed",{get:function(){return this.is(x.PRESSED)},set:function(t){this.set(x.PRESSED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inPressed",{get:function(){return this.in(x.PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onPressed",{get:function(){return this.on(x.PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underPressed",{get:function(){return this.under(x.PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this.is(x.READ_ONLY)},set:function(t){this.set(x.READ_ONLY,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inReadOnly",{get:function(){return this.in(x.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onReadOnly",{get:function(){return this.on(x.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underReadOnly",{get:function(){return this.under(x.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return!this.is(x.DISABLED)},set:function(t){this.set(x.DISABLED,!t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inEnabled",{get:function(){return!this.in(x.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onEnabled",{get:function(){return!this.on(x.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underEnabled",{get:function(){return!this.under(x.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDisabled",{get:function(){return this.is(x.DISABLED)},set:function(t){this.set(x.DISABLED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inDisabled",{get:function(){return this.in(x.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDisabled",{get:function(){return this.on(x.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underDisabled",{get:function(){return this.under(x.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActionable",{get:function(){return!this.in(x.DISABLED|x.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDragging",{get:function(){return this.is(x.DRAGGING)},set:function(t){this.set(x.DRAGGING,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inDragging",{get:function(){return this.in(x.DRAGGING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDragging",{get:function(){return this.on(x.DRAGGING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underDragging",{get:function(){return this.under(x.DRAGGING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocused",{get:function(){return this.is(x.FOCUSED)},set:function(t){this.set(x.FOCUSED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocused",{get:function(){return this.in(x.FOCUSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocused",{get:function(){return this.on(x.FOCUSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocused",{get:function(){return this.under(x.FOCUSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusRoot",{get:function(){return this.is(x.FOCUS_ROOT)},set:function(t){this.set(x.FOCUS_ROOT,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocusRoot",{get:function(){return this.in(x.FOCUS_ROOT)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusRoot",{get:function(){return this.on(x.FOCUS_ROOT)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocusRoot",{get:function(){return this.under(x.FOCUS_ROOT)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusReverse",{get:function(){return this.is(x.FOCUS_REVERSE)},set:function(t){this.set(x.FOCUS_REVERSE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocusReverse",{get:function(){return this.in(x.FOCUS_REVERSE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusReverse",{get:function(){return this.on(x.FOCUS_REVERSE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocusReverse",{get:function(){return this.under(x.FOCUS_REVERSE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return!this.is(x.UNFOCUSABLE)},set:function(t){this.set(x.UNFOCUSABLE,!t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocusable",{get:function(){return!this.in(x.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusable",{get:function(){return!this.on(x.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocusable",{get:function(){return!this.under(x.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUnfocusable",{get:function(){return this.is(x.UNFOCUSABLE)},set:function(t){this.set(x.UNFOCUSABLE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inUnfocusable",{get:function(){return this.in(x.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onUnfocusable",{get:function(){return this.on(x.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underUnfocusable",{get:function(){return this.under(x.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInvalid",{get:function(){return this.is(x.INVALID)},set:function(t){this.set(x.INVALID,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inInvalid",{get:function(){return this.in(x.INVALID)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onInvalid",{get:function(){return this.on(x.INVALID)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underInvalid",{get:function(){return this.on(x.INVALID)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSucceeded",{get:function(){return this.is(x.SUCCEEDED)},set:function(t){this.set(x.SUCCEEDED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inSucceeded",{get:function(){return this.in(x.SUCCEEDED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSucceeded",{get:function(){return this.on(x.SUCCEEDED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underSucceeded",{get:function(){return this.under(x.SUCCEEDED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFailed",{get:function(){return this.is(x.FAILED)},set:function(t){this.set(x.FAILED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFailed",{get:function(){return this.in(x.FAILED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFailed",{get:function(){return this.on(x.FAILED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFailed",{get:function(){return this.under(x.FAILED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWarned",{get:function(){return this.is(x.WARNED)},set:function(t){this.set(x.WARNED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inWarned",{get:function(){return this.in(x.WARNED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onWarned",{get:function(){return this.on(x.WARNED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underWarned",{get:function(){return this.on(x.WARNED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChanged",{get:function(){return this.is(x.CHANGED)},set:function(t){this.set(x.CHANGED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inChanged",{get:function(){return this.in(x.CHANGED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onChanged",{get:function(){return this.on(x.CHANGED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underChanged",{get:function(){return this.on(x.CHANGED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAlternated",{get:function(){return this.is(x.ALTERNATED)},set:function(t){this.set(x.ALTERNATED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inAlternated",{get:function(){return this.in(x.ALTERNATED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onAlternated",{get:function(){return this.on(x.ALTERNATED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underAlternated",{get:function(){return this.on(x.ALTERNATED)},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return"["+this.C.toString(2)+","+this.R.toString(2)+","+this.k.toString(2)+"]"},t}(),z={CLICKED:x.CUSTOM,DOWN:2*x.CUSTOM,UP:4*x.CUSTOM},G=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),Object.defineProperty(n.prototype,"isClicked",{get:function(){return this.is(z.CLICKED)},set:function(t){this.set(z.CLICKED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"inClicked",{get:function(){return this.in(z.CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onClicked",{get:function(){return this.on(z.CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"underClicked",{get:function(){return this.under(z.CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isDown",{get:function(){return this.is(z.DOWN)},set:function(t){this.set(z.DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"inDown",{get:function(){return this.in(z.DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onDown",{get:function(){return this.on(z.DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"underDown",{get:function(){return this.under(z.DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isUp",{get:function(){return this.is(z.UP)},set:function(t){this.set(z.UP,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"inUp",{get:function(){return this.in(z.UP)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"onUp",{get:function(){return this.on(z.UP)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"underUp",{get:function(){return this.under(z.UP)},enumerable:!1,configurable:!0}),n}(U),H=function(n){function i(i){var r=n.call(this)||this;return r.internalTransform=new t.Matrix,r.o=i,r}return y(i,n),i.prototype.onChange=function(){n.prototype.onChange.call(this),this.o.onTransformChange()},i.prototype.updateSkew=function(){n.prototype.updateSkew.call(this),this.o.onTransformChange()},i.prototype.getLocalIdCurrent=function(){return this._currentLocalID},i.prototype.getLocalId=function(){return this._localID},i.prototype.getParentId=function(){return this._parentID},i.prototype.getWorldId=function(){return this._worldID},i.prototype.updateTransform=function(t){var r=this._currentLocalID,e=this._worldID;n.prototype.updateTransform.call(this,t);var u=this._currentLocalID,s=this._worldID;if(r!==u){var h=this.localTransform,o=this.internalTransform;h.copyTo(o),t instanceof i&&o.prepend(t.internalTransform)}else e!==s&&(h=this.localTransform,o=this.internalTransform,t instanceof i&&(h.copyTo(o).prepend(t.internalTransform),this._currentLocalID+=1,this._localID=this._currentLocalID))},i}(t.Transform),V=function(t,n,i){var r=t.length;if(n<r)return t;for(var e="",u=0,s=n-r;u<s;++u)e+=i;return e+t},W=function(){function t(){}return t.toCode=function(t){return V(t.toString(16).toUpperCase(),6,"0")},t.fromCode=function(t){var n=t.trim().toLowerCase();if(6===n.length){var i=Number("0x"+n);if(i==i)return i}return null},t.fromRgb=function(t,n,i){return(255*t<<16)+(255*n<<8)+(255*i|0)},t.blend=function(t,n,i){var r=t>>16&255,e=t>>8&255,u=255&(0|t),s=n>>16&255,h=n>>8&255,o=255&(0|n),a=Math.max(0,Math.min(1,i)),c=1-a;return(Math.max(0,Math.min(255,r*c+s*a))<<16)+(Math.max(0,Math.min(255,e*c+h*a))<<8)+(0|Math.max(0,Math.min(255,u*c+o*a)))},t.brighten=function(t,n){return this.blend(t,16777215,n)},t.darken=function(t,n){return this.blend(t,0,n)},t}(),X=function(){function t(){}return t.serializeGradient=function(t){for(var n=t.points,i="["+t.direction,r=0,e=n.length,u=1;r<e;r+=1,u+=3){var s=n[r];i+=","+s.color+","+s.alpha+","+s.position}return i+"]"},t.parseGradient=function(t){try{return JSON.parse(t)}catch(t){return null}},t.deserializeGradient=function(t){var n=this.parseGradient(t);if(!(null==n||n.length<7)){for(var i=n[0],r=[],e=1,u=n.length;e<u;e+=3)r.push({color:n[e+0],alpha:n[e+1],position:n[e+2]});return{points:r,direction:i}}},t.toGradientId=function(t,n){return null!=t?(null==t.serialized&&(t.serialized=this.serializeGradient(t)),n.addResource(t.serialized)):-1},t.toGradientImageUrl=function(t){for(var n=t.direction,i=t.points,r="",e=0,u=i.length;e<u;++e){var s=i[e],h=W.toCode(s.color),o=s.alpha;r+='<stop offset="'+100*s.position+'%" stop-color="#'+h+'" stop-opacity="'+o+'" />'}var a=n*Math.PI/180,c=.5*Math.cos(a),f=-.5*Math.sin(a);return"data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><linearGradient id="o2glkm3aeu2oio" x1="'+(.5-c)+'" x2="'+(.5+c)+'" y1="'+(.5-f)+'" y2="'+(.5+f)+'">'+r+'</linearGradient></defs><rect x="0" y="0" width="32" height="32" stroke="none" fill="url(#o2glkm3aeu2oio)" /></svg>')},t}(),Y=function(n){function i(t){var i=n.call(this)||this;return i.id="",i.uuid=0,i.type=t,i.transform=i.newTransform(),i._=0,i.P=!1,i.action=new _,i.F=!0,i.U=0,i.G=!1,i.V=!1,i.W=NaN,i.K=NaN,i.J=NaN,i.Z=new G((function(t,n){i.onStateChange(t,n)})),i.interactive=!1,i.parent=null,i.children=[],i.selected=!1,i.index=0,i.reference=0,i}return y(i,n),i.prototype.newTransform=function(){return new H(this)},i.prototype.onSizeChange=function(){this.W=NaN,this.K=NaN,this.J=NaN,this.q(),this.updateUploaded()},i.prototype.onTransformChange=function(){this.q(),this.updateUploadedRecursively()},i.prototype.q=function(){if(0===this._){var t=this.parent;null!=t&&t.onChildTransformChange()}else this.P=!0},i.prototype.disallowOnTransformChange=function(){this._+=1,1===this._&&(this.P=!1)},i.prototype.allowOnTransformChange=function(t){this._-=1,0===this._&&this.P&&(this.P=!1,t&&this.onTransformChange())},i.prototype.onChildTransformChange=function(){},i.prototype.disallowUploadedUpdate=function(){this.U+=1,1===this.U&&(this.G=!1,this.V=!1)},i.prototype.allowUploadedUpdate=function(){this.U-=1,0===this.U&&(this.V?(this.V=!1,this.G=!1,this.updateUploadedRecursively()):this.G&&(this.G=!1,this.updateUploaded()))},i.prototype.updateUploadedRecursively=function(){if(0===this.U){this.updateUploaded();for(var t=this.children,n=0,i=t.length;n<i;++n)t[n].updateUploadedRecursively()}else this.V=!0},i.prototype.updateUploaded=function(){if(0===this.U){var t=this.uploaded;null!=t&&t.update(this)}else this.G=!0},Object.defineProperty(i.prototype,"image",{get:function(){return this.$},set:function(t){this.$=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"root",{get:function(){for(var t=this;t.parent instanceof i;)t=t.parent;return t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"visible",{get:function(){var t=this.parent;return t instanceof i?t.visible&&this.F:this.F},set:function(t){this.F!==t&&(this.F=t,this.updateUploadedRecursively())},enumerable:!1,configurable:!0}),i.prototype.toDirty=function(){var t=this.parent;null!=t&&t.toDirty()},i.prototype.attach=function(t,n){this.detach(),this.parent=t;var i=t.children;return null!=n&&0<=n&&n<i.length?i.splice(n,0,this):i.push(this),this.uploaded=void 0,t.onChildTransformChange(),t.toDirty(),this},i.prototype.detach=function(){var t=this.parent;if(null!=t){this.parent=null,this.uploaded=void 0;var n=t.children,i=n.indexOf(this);0<=i&&(n.splice(i,1),t.onChildTransformChange(),t.toDirty())}return this},i.prototype.updateTransform=function(){var n=this.parent;n?(n.parent&&n.updateTransform(),this.transform.updateTransform(n.transform)):this.transform.updateTransform(t.Transform.IDENTITY)},i.prototype.serializeChildren=function(t){for(var n=this.children,i=[],r=0,e=n.length;r<e;++r){var u=n[r];i.push(u.serialize(t))}return i},i.prototype.serializeImage=function(t){var n=this.$;return null!=n?t.addResource(n.src):-1},i.prototype.serializeGradient=function(t){return X.toGradientId(this.gradient,t)},i.prototype.serialize=function(t){var n=this.transform,i=n.position,r=n.pivot,e=this.size,u=this.shortcut,s=null!=u?t.addResource(u):-1,h=this.title,o=null!=h?t.addResource(h):-1;return[this.type,t.addResource(this.id),i.x,i.y,e.x,e.y,n.rotation,n.skew.x,this.fill.serialize(t),this.stroke.serialize(t),t.addResource(this.cursor.trim()),this.text.serialize(t),this.tag.serialize(t),this.radius,this.corner,-1,-1,this.action.serialize(t),this.serializeImage(t),this.serializeGradient(t),this.serializeChildren(t),r.x,r.y,(this.interactive?1:0)|(this.state.isFocusable?0:2),s,o,this.uuid]},i.prototype.addUuid=function(t){this.uuid=t.addUuid(this.uuid);for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].addUuid(t)},i.prototype.updateUuid=function(t){this.uuid=t.updateUuid(this.uuid);for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].updateUuid(t)},i.prototype.toLocalRect=function(t,n){var i=t.x,r=t.y,e=this.size,u=.5*e.x,s=.5*e.y,h=this.transform.pivot,o=i-h.x,a=r-h.y,c=this.stroke,f=c.width*c.align;return 0<=u?0<=s?(n.x=+o,n.y=+a,n.width=+u+f,n.height=+s+f):(n.x=+o,n.y=-a,n.width=+u+f,n.height=-s+f):0<=s?(n.x=-o,n.y=+a,n.width=-u+f,n.height=+s+f):(n.x=-o,n.y=-a,n.width=-u+f,n.height=-s+f),n},i.prototype.contains=function(t){var n=this.toLocalRect(t,i.WORK_RECT);if(this.containsAbs(n.x,n.y,n.width,n.height))return this;var r=t.x,e=t.y;return this.containsText(r,e,t)||this.containsChildren(r,e,t)},i.prototype.containsText=function(t,n,i){var r=this.text;if(null!=r.atlas){var e=r.world;if(null!=e){i.set(t,n),this.transform.internalTransform.apply(i,i);var u=i.x-e[0],s=i.y-e[1],h=e[2]*u+e[3]*s,o=e[4]*u+e[5]*s;if(0<=h&&h<=e[6]&&0<=o&&o<=e[7])return this}}return null},i.prototype.containsChildren=function(t,n,i){for(var r=this.children,e=r.length-1;0<=e;--e){var u=r[e];i.set(t,n),u.updateTransform(),u.transform.localTransform.applyInverse(i,i);var s=u.contains(i);if(null!=s)return s}return null},i.prototype.containsBBox=function(t){var n=this.toLocalRect(t,i.WORK_RECT);return this.containsAbsBBox(n.x,n.y,n.width,n.height)},i.prototype.containsAbs=function(t,n,i,r){return this.containsAbsBBox(t,n,i,r)},i.prototype.containsAbsBBox=function(t,n,i,r){return-i<=t&&t<=+i&&-r<=n&&n<=+r},i.prototype.select=function(t){return!1},i.prototype.toGlobal=function(t,n,i){return!0!==i&&this.updateTransform(),n.copyFrom(t),this.transform.worldTransform.apply(n,n),n},i.prototype.toLocal=function(n,i,r,e){return!0!==e&&this.updateTransform(),void 0===r&&(r=new t.Point),r.copyFrom(n),this.transform.worldTransform.applyInverse(r,r),r},i.prototype.getBounds=function(n,i,r){!0!==i&&this.updateTransform();var e=this._bounds=this._bounds||new t.Rectangle,u=this.transform.getWorldId();return u!==this.W&&(this.W=u,this.nt(this.transform.worldTransform,n,e)),r.copyFrom(e),r},i.prototype.getBoundsInternal=function(n,i,r){!0!==i&&this.updateTransform();var e=this.it=this.it||new t.Rectangle,u=this.transform.getLocalIdCurrent();return u!==this.K&&(this.K=u,this.nt(this.transform.internalTransform,n,e)),r.copyFrom(e),r},i.prototype.getBoundsLocal=function(n,i,r){!0!==i&&this.updateTransform();var e=this.rt=this.rt||new t.Rectangle,u=this.transform.getLocalIdCurrent();return u!==this.J&&(this.J=u,this.nt(this.transform.localTransform,n,e)),r.copyFrom(e),r},i.prototype.getBoundsSize=function(){return this.size},i.prototype.nt=function(t,n,i){var r=this.transform.pivot,e=r.x,u=r.y,s=this.getBoundsSize(),h=.5*s.x,o=.5*s.y,a=t.a,c=t.b,f=t.c,l=t.d,v=-h+e,b=-o+u,g=a*v+f*b,d=c*v+l*b,m=a*(v=+h+e)+f*(b=-o+u),w=c*v+l*b,p=a*(v=-h+e)+f*(b=+o+u),O=c*v+l*b,D=a*(v=+h+e)+f*(b=+o+u),E=c*v+l*b,M=Math.min(g,m,p,D),S=Math.min(d,w,O,E),T=Math.max(g,m,p,D),j=Math.max(d,w,O,E);return i.x=M+t.tx,i.y=S+t.ty,i.width=T-M,i.height=j-S,i},i.prototype.destroy=function(){for(var t=this.children,n=t.length-1;0<=n;--n)t[n].destroy();t.length=0},i.prototype.onStateChange=function(t,n){var r=this.runtime;null!=r&&r.onStateChange(this,t,n);for(var e=this.children,u=0,s=e.length;u<s;++u){var h=e[u];h instanceof i&&h.Z.update(t)}},Object.defineProperty(i.prototype,"state",{get:function(){return this.Z},enumerable:!1,configurable:!0}),i.prototype.focus=function(){return this.setFocused(!0),this},i.prototype.blur=function(){return this.setFocused(!1),this},i.prototype.setFocused=function(t){if(this.state.isFocused!==t){var n=B.getLayer(this);n&&n.getFocusController().set(this,t)}},Object.defineProperty(i.prototype,"shadowed",{get:function(){return!1},enumerable:!1,configurable:!0}),i.prototype.onDblClick=function(t){var n=this.runtime;return null!=n&&n.onPointerDblClick(this)},i.prototype.onShortcut=function(t){var n=this.runtime;if(null!=n)return n.onPointerClick(this)},i.prototype.onKeyDown=function(t){var n=this.runtime;return null!=n&&n.onKeyDown(this,t)},i.prototype.onKeyUp=function(t){var n=this.runtime;return null!=n&&n.onKeyUp(this,t)},i.prototype.update=function(t){var n=this.runtime;null!=n&&n.update(this,t)},i.prototype.updateRecursively=function(t){this.update(t);for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].update(t)},i.prototype.copy=function(t,n){if(void 0===n&&(n=k.ALL),this.id=t.id,this.uuid=t.uuid,0!=(n&k.TRANSFORM)){var i=this.transform,r=t.transform;i.position.copyFrom(r.position),i.rotation=r.rotation,i.skew.copyFrom(r.skew),i.pivot.copyFrom(r.pivot),i.scale.copyFrom(r.scale)}if(0!=(n&k.SIZE)&&this.size.copyFrom(t.size),0!=(n&k.STYLE)&&(this.fill.copy(t.fill),this.stroke.copy(t.stroke),this.tag.copy(t.tag),this.text.copy(t.text),this.radius=t.radius,this.corner=t.corner,null==this.$&&(this.$=t.image)),0!=(n&k.ACTION)&&(this.action.addAll(t.action.values),this.interactive=t.interactive,this.cursor=t.cursor,this.shortcut=t.shortcut),0!=(n&k.POINTS)){var e=t.points;if(null!=e){var u=this.points;null!=u?u.copy(e):this.tt=e.clone(this)}}return 0!=(n&k.STATE)&&this.state.copy(t.state),this},i.WORK_RECT=new t.Rectangle,i}(t.utils.EventEmitter);!function(t){t[t.NONE=0]="NONE",t[t.TOP_LEFT=1]="TOP_LEFT",t[t.TOP_RIGHT=2]="TOP_RIGHT",t[t.BOTTOM_LEFT=4]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT",t[t.TOP=3]="TOP",t[t.BOTTOM=12]="BOTTOM",t[t.LEFT=5]="LEFT",t[t.RIGHT=10]="RIGHT",t[t.ALL=15]="ALL"}(P||(P={}));var K,J,Z=function(){function t(){}return t.setDefaultThemeClass=function(t){this.DEFAULT_THEME_CLASS=t},t.getDefaultThemeClass=function(){return this.DEFAULT_THEME_CLASS},t.getInstance=function(){if(null==this.INSTANCE){var t=this.getDefaultThemeClass();if(null==t)throw new Error("No default theme class found");this.INSTANCE=new t}return this.INSTANCE},t.setInstance=function(t){var n=this.INSTANCE;return this.INSTANCE=t,n},t.DEFAULT_THEME_CLASS=null,t.INSTANCE=null,t}(),q=function(){function t(){}return Object.defineProperty(t,"THEME",{get:function(){var t=this.et;if(null!=t)return t;var n=Z.getInstance().get("EShape");return this.et=n,n},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILL_COLOR",{get:function(){return this.THEME.getFillColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILL_ALPHA",{get:function(){return this.THEME.getFillAlpha()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_COLOR",{get:function(){return this.THEME.getStrokeColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_ALPHA",{get:function(){return this.THEME.getStrokeAlpha()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_WIDTH",{get:function(){return this.THEME.getStrokeWidth()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_ALIGN",{get:function(){return this.THEME.getStrokeAlign()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_SIDE",{get:function(){return this.THEME.getStrokeSide()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_VALUE",{get:function(){return this.THEME.getTextValue()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_COLOR",{get:function(){return this.THEME.getTextColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_ALPHA",{get:function(){return this.THEME.getTextAlpha()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_FAMILY",{get:function(){return this.THEME.getTextFamily()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_SIZE",{get:function(){return this.THEME.getTextSize()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CURSOR",{get:function(){return this.THEME.getCursor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"RADIUS",{get:function(){return this.THEME.getRadius()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SIZE_X",{get:function(){return this.THEME.getSizeX()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SIZE_Y",{get:function(){return this.THEME.getSizeY()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"HIGHLIGHT_COLOR",{get:function(){return this.THEME.getHighlightColor()},enumerable:!1,configurable:!0}),t}(),$=function(){function t(t,n,i,r){this.o=t,this.ut=n,this.st=i,this.ht=r}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ut},set:function(t){this.ut!==t&&(this.ut=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.st!==t&&(this.st=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.ht!==t&&(this.ht=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha)},t.prototype.set=function(t,n,i){var r=!1;void 0!==t&&this.ut!==t&&(this.ut=t,r=!0),void 0!==n&&this.st!==n&&(this.st=n,r=!0),void 0!==i&&this.ht!==i&&(this.ht=i,r=!0),r&&this.o.updateUploaded()},t.prototype.clone=function(){return new t(this.o,this.ut,this.st,this.ht)},t.prototype.toObject=function(){return{enable:this.ut,color:this.st,alpha:this.ht}},t.prototype.serialize=function(t){var n="["+(this.ut?1:0)+","+this.st+","+this.ht+"]";return t.addResource(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getFill(t);if(null!=r)this.set(0!==r[0],r[1],r[2]);else{var e=JSON.parse(i[t]);n.setFill(t,e),this.set(0!==e[0],e[1],e[2])}}},t}(),Q=function(){function t(t,n,i,r,e,u,s){this.o=t,this.ut=n,this.st=i,this.ht=r,this.ot=e,this.at=u,this.ct=s}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ut},set:function(t){this.ut!==t&&(this.ut=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.st!==t&&(this.st=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.ht!==t&&(this.ht=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.ot},set:function(t){this.ot!==t&&(this.ot=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this.at},set:function(t){this.at!==t&&(this.at=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){return this.ct},set:function(t){this.ct!==t&&(this.ct=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha,t.width,t.align,t.side)},t.prototype.set=function(t,n,i,r,e,u){var s=!1;void 0!==t&&this.ut!==t&&(this.ut=t,s=!0),void 0!==n&&this.st!==n&&(this.st=n,s=!0),void 0!==i&&this.ht!==i&&(this.ht=i,s=!0),void 0!==r&&this.ot!==r&&(this.ot=r,s=!0),void 0!==e&&this.at!==e&&(this.at=e,s=!0),void 0!==u&&this.ct!==u&&(this.ct=u,s=!0),s&&this.o.updateUploaded()},t.prototype.clone=function(){return new t(this.o,this.ut,this.st,this.ht,this.ot,this.at,this.ct)},t.prototype.toObject=function(){return{enable:this.ut,color:this.st,alpha:this.ht,width:this.ot,align:this.at,side:this.ct}},t.prototype.serialize=function(t){var n="["+(this.ut?1:0)+","+this.st+","+this.ht+","+this.ot+","+this.at+","+this.ct+"]";return t.addResource(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getStroke(t);if(null!=r)this.set(0!==r[0],r[1],r[2],r[3],r[4],r[5]);else{var e=JSON.parse(i[t]);n.setStroke(t,e),this.set(0!==e[0],e[1],e[2],e[3],e[4],e[5])}}},t}();!function(t){t[t.ASCENDING=0]="ASCENDING",t[t.DESCENDING=1]="DESCENDING"}(K||(K={})),function(t){t[t.NONE=0]="NONE",t[t.FROM=1]="FROM",t[t.TO=2]="TO",t[t.FROM_TO=3]="FROM_TO"}(J||(J={}));var tt,nt=function(){function t(){this.ft=J.NONE,this.lt=0,this.vt=1}return Object.defineProperty(t.prototype,"type",{get:function(){return this.ft},set:function(t){if(this.ft!==t){this.ft=t;var n=this.parent;null!=n&&(n.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"from",{get:function(){return this.lt},set:function(t){if(this.lt!==t){this.lt=t;var n=this.parent;null!=n&&(n.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.vt},set:function(t){if(this.vt!==t){this.vt=t;var n=this.parent;null!=n&&(n.isChanged=!0)}},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=!1;if(void 0!==t&&void 0!==n)if(null!==t&&null!==n){var r=this.ft|J.FROM|J.TO;this.ft===r&&this.lt===t&&this.vt===n||(this.ft=r,this.lt=t,this.vt=n,i=!0)}else null!==t?(r=(this.ft|J.FROM)&~J.TO,this.ft===r&&this.lt===t||(this.ft=r,this.lt=t,i=!0)):null!==n?(r=(this.ft|J.TO)&~J.FROM,this.ft===r&&this.lt===t||(this.ft=r,this.vt=n,i=!0)):(r=this.ft&~(J.TO|J.FROM),this.ft!==r&&(this.ft=r,i=!0));else void 0!==t?null!==t?(r=this.ft|J.FROM,this.ft===r&&this.lt===t||(this.ft=r,this.lt=t,i=!0)):(r=this.ft&~J.FROM,this.ft!==r&&(this.ft=r,i=!0)):void 0!==n&&(null!==n?(r=this.ft|J.TO,this.ft===r&&this.vt===n||(this.ft=r,this.vt=n,i=!0)):(r=this.ft&~J.TO,this.ft!==r&&(this.ft=r,i=!0)));if(i){var e=this.parent;null!=e&&(e.isChanged=!0)}return i},t.prototype.normalize=function(t){var n=this.ft,i=this.lt,r=this.vt;switch(n){case J.FROM_TO:return(t-i)/(r-i);case J.FROM:return t-i;case J.TO:return r-t;case J.NONE:default:return t}},t.prototype.isEquals=function(t){return this.ft===t.type&&this.lt===t.from&&this.vt===t.to},t.prototype.copy=function(t){return this.bt(t.type,t.from,t.to)},t.prototype.bt=function(t,n,i){var r=!1;if(this.ft!==t&&(this.ft=t,r=!0),this.lt!==n&&(this.lt=n,r=!0),this.vt!==i&&(this.vt=i,r=!0),r){var e=this.parent;null!=e&&(e.isChanged=!0)}return this},t.prototype.toObject=function(){return{type:this.type,from:this.from,to:this.to}},t.prototype.serialize=function(t){var n="["+this.ft+","+this.lt+","+this.vt+"]";return t.addResource(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getRange(t);if(null!=r)this.bt(r[0],r[1],r[2]);else{var e=JSON.parse(i[t]);n.setRange(t,e),this.bt(e[0],e[1],e[2])}}},t}(),it=function(t,n){return t-n},rt=function(){function t(){this.id="",this.initial="",this.format="",this.range=new nt,this.gt=0,this.wt=0,this.Ot=0,this.Dt=K.ASCENDING}return Object.defineProperty(t.prototype,"parent",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.range.parent=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.gt},set:function(t){var n=this.formatter;null!=n&&(t=n(t));var i=this.Ot;if(i<=0){if(this.gt!==t){this.gt=t;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var e=this.v;null==e&&(e=[],this.v=e),this.gt=t;var u=this.Dt;u===K.ASCENDING?e.push(t):e.unshift(t);var s=e.length-i;if(0<s)if(u===K.ASCENDING)for(var h=0;h<s;++h)e.shift();else e.length=i;var o=this.parent;null!=o&&(o.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nvalue",{get:function(){return this.range.normalize(this.gt)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var t=this.v;return null==t&&(t=[],this.v=t),t},set:function(t){if(0<t.length){var n=this.Ot;if(n<=0){var i=t[t.length-1];if(null!=(u=this.formatter)&&(i=u(i)),this.gt!==i){this.gt=i;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var e=this.v;null==e&&(e=[],this.v=e);var u,s=this.Dt;if(null!=(u=this.formatter))if(this.gt=u(t[t.length-1]),s===K.ASCENDING)for(var h=0,o=t.length;h<o;++h)e.push(u(t[h]));else for(h=0,o=t.length;h<o;++h)e.unshift(u(t[h]));else if(this.gt=t[t.length-1],s===K.ASCENDING)for(h=0,o=t.length;h<o;++h)e.push(t[h]);else for(h=0,o=t.length;h<o;++h)e.unshift(t[h]);var a=e.length-n;if(0<a)if(s===K.ASCENDING)for(h=0;h<a;++h)e.shift();else e.length=n;var c=this.parent;null!=c&&(c.isChanged=!0)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this.wt},set:function(t){var n=this.Ot;if(n<=0){if(this.wt!==t){this.wt=t;var i=this.parent;null!=i&&(i.isChanged=!0)}}else{var r=this.Et;null==r&&(r=[],this.Et=r),this.wt=t;var e=this.Dt;e===K.ASCENDING?r.push(t):r.unshift(t);var u=r.length-n;if(0<u)if(e===K.ASCENDING)for(var s=0;s<u;++s)r.shift();else r.length=n;var h=this.parent;null!=h&&(h.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"times",{get:function(){var t=this.Et;return null==t&&(t=[],this.Et=t),t},set:function(t){if(0<t.length){var n=this.Ot;if(n<=0){var i=t[t.length-1];if(this.wt!==i){this.wt=i;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var e=this.Et;null==e&&(e=[],this.Et=e),this.wt=t[t.length-1];var u=this.Dt;if(u===K.ASCENDING)for(var s=0,h=t.length;s<h;++s)e.push(t[s]);else for(s=0,h=t.length;s<h;++s)e.unshift(t[s]);var o=e.length-n;if(0<o)if(u===K.ASCENDING)for(s=0;s<o;++s)e.shift();else e.length=n;var a=this.parent;null!=a&&(a.isChanged=!0)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){return this.Ot},set:function(t){if(this.Ot<t)this.Ot=t;else if(t<this.Ot){this.Ot=t;var n=!1,i=this.Dt,r=this.v;if(null!=r&&0<(u=r.length-t)){if(i===K.ASCENDING)for(var e=0;e<u;++e)r.shift();else r.length=t;n=!0}var u,s=this.Et;if(null!=s&&0<(u=s.length-t)){if(i===K.ASCENDING)for(e=0;e<u;++e)s.shift();else s.length=t;n=!0}if(n){var h=this.parent;null!=h&&(h.isChanged=!0)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this.Dt},set:function(t){this.Dt=t},enumerable:!1,configurable:!0}),t.prototype.remove=function(t){var n=!1,i=this.v;null!=i&&0<=t&&t<i.length&&(i.splice(t,1),n=!0);var r=this.Et;if(null!=r&&0<=t&&t<r.length&&(r.splice(t,1),n=!0),n){var e=this.parent;null!=e&&(e.isChanged=!0)}},t.prototype.removeAll=function(t){var n=!1,i=this.v,r=this.Et,e=t.slice(0).sort(it);if(null!=i)if(null!=r)for(var u=e.length-1;0<=u;--u)0<=(s=e[u])&&(s<i.length&&(i.splice(s,1),n=!0),s<r.length&&(r.splice(s,1),n=!0));else for(u=e.length-1;0<=u;--u)0<=(s=e[u])&&s<i.length&&(i.splice(s,1),n=!0);else if(null!=r)for(u=e.length-1;0<=u;--u){var s;0<=(s=e[u])&&s<r.length&&(r.splice(s,1),n=!0)}if(n){var h=this.parent;null!=h&&(h.isChanged=!0)}},t.prototype.clear=function(){var t=!1,n=this.v;null!=n&&(n.length=0,t=!0);var i=this.Et;if(null!=i&&(i.length=0,t=!0),t){var r=this.parent;null!=r&&(r.isChanged=!0)}},t.prototype.copy=function(t){return this.id=t.id,this.initial=t.initial,this.format=t.format,this.formatter=t.formatter,this.range.copy(t.range),this.gt=t.value,this.wt=t.time,this.Ot=t.capacity,this},t.prototype.isEquals=function(t){return this.id===t.id&&this.initial===t.initial&&this.formatter===t.formatter&&this.range.isEquals(t.range)},t.prototype.serialize=function(t){var n=t.addTag(this.id),i=t.addResource(this.initial),r=t.addResource(this.format.trim()),e=this.range.serialize(t);return t.addResource("["+n+","+i+","+r+","+e+","+this.Ot+","+this.Dt+"]")},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getTagValue(t);null==r&&(r=JSON.parse(i[t]),n.setTagValue(t,r)),this.id=n.tags[r[0]]||"",this.initial=i[r[1]]||"",this.format=i[r[2]]||"",this.range.deserialize(r[3],n),this.Ot=r[4],this.Dt=r[5]}return this},t}(),et=function(){function t(){this.v=[],this.isChanged=!0}return Object.defineProperty(t.prototype,"id",{get:function(){var t=this.v;if(0<t.length)return t[0].id;var n=this.inherited;return null!=n?n.id:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){var t=this.v;if(0<t.length)return t[0].initial;var n=this.inherited;return null!=n?n.initial:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){var t=this.v;if(0<t.length)return t[0].format;var n=this.inherited;return null!=n?n.format:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){var n=this.v;if(0<n.length)return n[0].range;var i=this.inherited;return null!=i?i.range:t.RANGE_DUMMY},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var t=this.v;if(0<t.length)return t[0].value;var n=this.inherited;return null!=n?n.value:0},set:function(t){var n=this.v;if(0<n.length)n[0].value=t;else{var i=this.inherited;null!=i&&(i.value=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nvalue",{get:function(){var t=this.v;if(0<t.length)return t[0].nvalue;var n=this.inherited;return null!=n?n.nvalue:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var t=this.v;if(0<t.length)return t[0].time;var n=this.inherited;return null!=n?n.time:0},set:function(t){var n=this.v;if(0<n.length)n[0].time=t;else{var i=this.inherited;null!=i&&(i.time=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var n=this.v;if(0<n.length)return n[0].values;var i=this.inherited;return null!=i?i.values:t.EMPTY_ARRAY},set:function(t){var n=this.v;if(0<n.length)n[0].values=t;else{var i=this.inherited;null!=i&&(i.values=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"times",{get:function(){var n=this.v;if(0<n.length)return n[0].times;var i=this.inherited;return null!=i?i.times:t.EMPTY_ARRAY},set:function(t){var n=this.v;if(0<n.length)n[0].times=t;else{var i=this.inherited;null!=i&&(i.times=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){var t=this.v;if(0<t.length)return t[0].capacity;var n=this.inherited;return null!=n?n.capacity:0},set:function(t){var n=this.v;if(0<n.length)n[0].capacity=t;else{var i=this.inherited;null!=i&&(i.capacity=t)}},enumerable:!1,configurable:!0}),t.prototype.add=function(t,n){var i=this.v;t.parent=this,void 0===n?i.push(t):i.splice(n,0,t)},t.prototype.set=function(t,n){var i=this.v;if(0<=t&&t<i.length){var r=i[t];return n.parent=this,i[t]=n,r.parent=void 0,r}return null},t.prototype.remove=function(t){var n=this.v;0<=t&&t<n.length&&(n.splice(t,1)[0].parent=void 0)},t.prototype.indexOf=function(t){for(var n=this.v,i=n.length,r=0;r<i;++r)if(n[r]===t)return r;for(r=0;r<i;++r)if(n[r].isEquals(t))return r;for(r=0;r<i;++r)if(n[r].id===t.id)return r;return-1},t.prototype.get=function(t){var n=this.v;return 0<=t&&t<n.length?n[t]:null},t.prototype.size=function(){return this.v.length},t.prototype.swap=function(t,n){var i=this.v,r=i[n];i[n]=i[t],i[t]=r},t.prototype.copy=function(t){var n=this.v;n.length=0;for(var i=0,r=t.size();i<r;++i){var e=t.get(i);if(null!=e){var u=(new rt).copy(e);u.parent=this,n.push(u)}}return this},t.prototype.serialize=function(t){var n=this.v;if(n.length<=0)return t.addResource("[]");for(var i="["+n[0].serialize(t),r=1,e=n.length;r<e;++r)i+=","+n[r].serialize(t);return i+="]",t.addResource(i)},t.prototype.deserialize=function(t,n){if(0<=t&&t<n.resources.length){var i=n.getTag(t);null==i&&(i=JSON.parse(n.resources[t]),n.setTag(t,i));var r=this.v;r.length=0;for(var e=i.length,u=0;u<e;++u){var s=i[u],h=new rt;h.parent=this,h.deserialize(s,n),r.push(h)}}},t.RANGE_DUMMY=new nt,t.EMPTY_ARRAY=[],t}(),ut=function(){function t(t,n,i){this.o=t,this.Mt=n,this.St=i}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return this.Mt},set:function(t){this.Mt!==t&&(this.Mt=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this.St},set:function(t){this.St!==t&&(this.St=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.horizontal,t.vertical)},t.prototype.set=function(t,n){var i=!1;null!=t&&this.Mt!==t&&(this.Mt=t,i=!0),null!=n&&this.St!==n&&(this.St=n,i=!0),i&&this.o.updateUploaded()},t.prototype.toObject=function(){return{horizontal:this.Mt,vertical:this.St}},t.prototype.serialize=function(t){return t.addResource("["+this.Mt+","+this.St+"]")},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getAlign(t);if(null!=r)this.set(r[0],r[1]);else{var e=JSON.parse(i[t]);n.setAlign(t,e),this.set(e[0],e[1])}}},t}(),st=function(){function t(t,n,i){this.o=t,this.Mt=n,this.St=i}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return this.Mt},set:function(t){this.Mt!==t&&(this.Mt=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this.St},set:function(t){this.St!==t&&(this.St=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.horizontal,t.vertical)},t.prototype.set=function(t,n){var i=!1;null!=t&&this.Mt!==t&&(this.Mt=t,i=!0),null!=n&&this.St!==n&&(this.St=n,i=!0),i&&this.o.updateUploaded()},t.prototype.toObject=function(){return{horizontal:this.Mt,vertical:this.St}},t.prototype.serialize=function(t){return t.addResource("["+this.Mt+","+this.St+"]")},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getMargin(t);if(null!=r)this.set(r[0],r[1]);else{var e=JSON.parse(i[t]);n.setMargin(t,e),this.set(e[0],e[1])}}},t}(),ht=function(){function t(t,n,i,r,e){this.o=t,this.ut=n,this.st=i,this.ht=r,this.ot=e}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ut},set:function(t){this.ut!==t&&(this.ut=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.st!==t&&(this.st=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.ht!==t&&(this.ht=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.ot},set:function(t){this.ot!==t&&(this.ot=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha,t.width)},t.prototype.set=function(t,n,i,r){var e=!1;void 0!==t&&this.ut!==t&&(this.ut=t,e=!0),void 0!==n&&this.st!==n&&(this.st=n,e=!0),void 0!==i&&this.ht!==i&&(this.ht=i,e=!0),void 0!==r&&this.ot!==r&&(this.ot=r,e=!0),e&&this.o.updateUploaded()},t.prototype.clone=function(){return new t(this.o,this.ut,this.st,this.ht,this.ot)},t.prototype.toObject=function(){return{enable:this.ut,color:this.st,alpha:this.ht,width:this.ot}},t.prototype.serialize=function(t){var n="["+(this.ut?1:0)+","+this.st+","+this.ht+","+this.ot+"]";return t.addResource(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getTextOutline(t);if(null!=r)this.set(0!==r[0],r[1],r[2],r[3]);else{var e=JSON.parse(i[t]);n.setTextOutline(t,e),this.set(0!==e[0],e[1],e[2],e[3])}}},t}(),ot=function(){function t(t,n,i,r,e,c){this.o=t,this.ut=!0,this.gt=n,this.st=i,this.ht=r,this.Tt=e,this.S=c,this.jt=u.NORMAL,this.align=new ut(t,h.CENTER,o.MIDDLE),this.offset=new st(t,0,0),this.O=s.NORMAL,this.spacing=new st(t,0,0),this.outline=new ht(t,!1,16777215,1,.5),this.Nt=a.LEFT_TO_RIGHT,this.padding=new st(t,10,10),this.It=!1}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ut},set:function(t){this.ut!==t&&(this.ut=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.gt},set:function(t){if(this.gt!==t){this.gt=t;var n=this.o,i=n.uploaded;if(null==i||!i.isCompatible(n))return this.atlas=void 0,void n.toDirty();var r=this.atlas,e=r&&r.characters;if(null==e)return this.atlas=void 0,void n.toDirty();for(var u=0,s=t.length;u<s;++u)if(!(t[u]in e))return this.atlas=void 0,void n.toDirty();n.updateUploaded()}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.Tt},set:function(t){this.Tt!==t&&(this.Tt=t,this.o.toDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.st!==t&&(this.st=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.ht!==t&&(this.ht=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.S},set:function(t){this.S!==t&&(this.S=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this.jt},set:function(t){this.jt!==t&&(this.jt=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.O},set:function(t){this.O!==t&&(this.O=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this.Nt},set:function(t){this.Nt!==t&&(this.Nt=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){return this.It},set:function(t){this.It!==t&&(this.It=t,this.o.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){return t&&(this.set(t.value,t.color,t.alpha,t.family,t.size,t.weight,t.style,t.direction,t.clipping),this.align.copy(t.align),this.offset.copy(t.offset),this.outline.copy(t.outline),this.spacing.copy(t.spacing),this.padding.copy(t.padding)),this},t.prototype.set=function(t,n,i,r,e,u,s,h,o){var a=!1,c=!1;return null!=t&&this.gt!==t&&(this.gt=t,a=!0),null!=n&&this.st!==n&&(this.st=n,c=!0),null!=i&&this.ht!==i&&(this.ht=i,c=!0),null!=r&&this.Tt!==r&&(this.Tt=r,a=!0),null!=e&&this.S!==e&&(this.S=e,c=!0),null!=u&&this.jt!==u&&(this.jt=u,c=!0),null!=s&&this.O!==s&&(this.O=s,c=!0),null!=h&&this.Nt!==h&&(this.Nt=h,c=!0),null!=o&&this.It!==o&&(this.It=o,c=!0),a?this.o.toDirty():c&&this.o.updateUploaded(),this},t.prototype.toObject=function(){return{value:this.gt,color:this.st,alpha:this.ht,family:this.Tt,size:this.S,weight:this.jt,align:this.align.toObject(),offset:this.offset.toObject(),style:this.O,outline:this.outline.toObject(),direction:this.Nt,spacing:this.spacing.toObject(),padding:this.padding.toObject(),clipping:this.It}},t.prototype.serialize=function(t){var n=this.align.serialize(t),i=this.offset.serialize(t),r=this.outline.serialize(t),e=this.spacing.serialize(t),u=this.padding.serialize(t),s="["+t.addResource(this.gt)+","+this.st+","+this.ht+","+t.addResource(this.Tt)+","+this.S+","+this.jt+","+n+","+i+","+this.O+","+r+","+e+","+this.Nt+","+u+","+(this.It?1:0)+"]";return t.addResource(s)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getText(t);null==r&&(r=JSON.parse(i[t]),n.setText(t,r)),this.set(i[r[0]]||"",r[1],r[2],i[r[3]]||"auto",r[4],r[5],r[8],r[11],0!==r[13]),this.align.deserialize(r[6],n),this.offset.deserialize(r[7],n),this.outline.deserialize(r[9],n),this.spacing.deserialize(r[10],n),this.padding.deserialize(r[12],n)}},t}(),at=function(n){function i(t){var i=n.call(this,t)||this;return i.size=i.newSize(),i.fill=i.newFill(),i.stroke=i.newStroke(),i.Ct=q.RADIUS,i.At=P.ALL,i.tag=new et,i.text=i.newText(),i.cursor=q.CURSOR,i}return y(i,n),i.prototype.newSize=function(){var n=this;return new t.ObservablePoint((function(){n.onSizeChange()}),void 0,q.SIZE_X,q.SIZE_Y)},i.prototype.newFill=function(){return new $(this,!0,q.FILL_COLOR,q.FILL_ALPHA)},i.prototype.newStroke=function(){return new Q(this,!0,q.STROKE_COLOR,q.STROKE_ALPHA,q.STROKE_WIDTH,q.STROKE_ALIGN,q.STROKE_SIDE)},i.prototype.newText=function(){return new ot(this,q.TEXT_VALUE,q.STROKE_COLOR,q.STROKE_ALPHA,q.TEXT_FAMILY,q.TEXT_SIZE)},Object.defineProperty(i.prototype,"corner",{get:function(){return this.At},set:function(t){this.At!==t&&(this.At=t,this.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"radius",{get:function(){return this.Ct},set:function(t){this.Ct!==t&&(this.Ct=t,this.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"image",{get:function(){return this.$},set:function(t){if(this.$!==t){null!=t?(this.$=t,this.imageSrc=t.src):(this.$=void 0,this.imageSrc=void 0);var n=this.parent;null!=n&&n.toDirty()}},enumerable:!1,configurable:!0}),i}(Y),ct=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.serialize=function(n){var i=t.prototype.serialize.call(this,n);return i[15]=this.tt.serialize(n),i},n.prototype.getPixelScale=function(){var t=this.root.parent;return null!=t&&null!=t.getPixelScale?t.getPixelScale():1},n.prototype.getStrokeWidthScale=function(t){var n=t.style;return n&r.NON_EXPANDING_WIDTH?n&r.NON_SHRINKING_WIDTH?this.getPixelScale():Math.min(1,this.getPixelScale()):n&r.NON_SHRINKING_WIDTH?Math.max(1,this.getPixelScale()):1},n.prototype.toHitThreshold=function(t){var n=this.stroke,i=n.enable?n.width:0,r=this.getStrokeWidthScale(this.tt);return t?t(i,r):i*r*.5},n.prototype.containsAbs=function(t,n,i,r){var e=this.tt,u=this.toHitThreshold(null);return!!this.containsAbsBBox(t,n,i+u,r+u)&&e.calcHitPointAbs(t,n,i,r,u,null,this.calcHitPointAbsHitTester,null)},n.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.tt,s=this.toHitThreshold(n),h=this.toLocalRect(t,Y.WORK_RECT);return!!this.containsAbsBBox(h.x,h.y,h.width+s,h.height+s)&&u.calcHitPointAbs(h.x,h.y,h.width,h.height,s,i,r,e)},n.prototype.calcHitPointAbsHitTester=function(t,n,i,r,e,u,s,h,o){var a=e-i,c=u-r,f=t-i,l=n-r,v=a*a+c*c,b=a*f+c*l,g=f*f+l*l;if(1e-4<v){var d=Math.max(0,Math.min(1,b/v));if(v*d*d-2*b*d+g<h*h)return!0}return!1},n.WORK_RANGE=[0,0],n}(at),ft=function(t){function i(i,r,e,u){var s=t.call(this,n.BAR)||this;return s.fill.enable=!1,s.stroke.set(!0,void 0,void 0,e),s.tt=new L(s,i,r,u),s}return y(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),i.prototype.clone=function(){var t=this.tt;return new i(t.position,t.size,this.stroke.width,t.style).copy(this)},i.prototype.containsAbsBBox=function(n,i,r,e){var u=Math.max(0,this.tt.size);return t.prototype.containsAbsBBox.call(this,n,i,r+u,e+u)},i}(ct),lt=function(t,n,i,r,e){for(var u=(t>>16&255)/255*n,s=(t>>8&255)/255*n,h=(t>>0&255)/255*n,o=n,a=i<<2,c=0;c<r;++c)e[a+0]=u,e[a+1]=s,e[a+2]=h,e[a+3]=o,a+=4},vt=function(){function n(t,n,i,r,e,u){this.buffer=t,this.transformLocalId=-1,this.vertexOffset=n,this.vertexCount=r,this.indexOffset=i,this.indexCount=e,this.colorFill=NaN,this.alphaFill=-1,this.colorStroke=NaN,this.alphaStroke=-1,this.sizeX=NaN,this.sizeY=NaN,this.strokeWidth=NaN,this.strokeAlign=NaN,this.strokeSide=NaN,this.radius=NaN,this.corner=NaN,this.texture=null,this.textureTransformId=NaN,this.antialiasWeight=u}return n.prototype.init=function(t){return t.uploaded=this,this},n.prototype.isCompatible=function(t){return!0},n.prototype.getBuffer=function(){return this.buffer},n.prototype.getVertexOffset=function(){return this.vertexOffset},n.prototype.getVertexCount=function(){return this.vertexCount},n.prototype.getIndexOffset=function(){return this.indexOffset},n.prototype.getIndexCount=function(){return this.indexCount},n.prototype.toTransformLocalId=function(t){return t.updateTransform(),t.transform.getLocalId()},n.prototype.toTexture=function(n){return n.texture||t.Texture.WHITE},n.prototype.toTextureTransformId=function(t){var n=t;return null==n._uvs&&t.updateUvs(),n._updateID},n.prototype.toTextureUvs=function(t){return t._uvs},n.prototype.updateColorFill=function(t,n,i){var r=n.fill,e=n.visible&&r.enable,u=r.color,s=e?r.alpha:0;u===this.colorFill&&s===this.alphaFill||(this.colorFill=u,this.alphaFill=s,t.updateColorFills(),lt(u,s,this.vertexOffset,i,t.colorFills))},n.prototype.updateColorStroke=function(t,n,i){var r=n.stroke,e=n.visible&&r.enable&&0<r.width,u=r.color,s=e?r.alpha:0;u===this.colorStroke&&s===this.alphaStroke||(this.colorStroke=u,this.alphaStroke=s,t.updateColorStrokes(),lt(u,s,this.vertexOffset,i,t.colorStrokes))},n.prototype.updateColorFillAndStroke=function(t,n,i){this.updateColorFill(t,n,i),this.updateColorStroke(t,n,i)},n.prototype.buildUnit=function(n){var i=this.texture||t.Texture.WHITE,r=i.baseTexture;if(r!==n.baseTexture){n.baseTexture=r;var e=this.indexOffset;n.push(i,e)}},n}(),bt=function(n){function i(t,i,r,e,u,s,h,o){var a=n.call(this,t,i,r,s,h,o)||this;return a.textSize=NaN,a.textFamily="auto",a.textValue="",a.textTexture=null,a.textTextureTransformId=NaN,a.textColor=NaN,a.textAlpha=NaN,a.textWeight=NaN,a.textStyle=NaN,a.textAlignHorizontal=NaN,a.textAlignVertical=NaN,a.textOffsetHorizontal=NaN,a.textOffsetVertical=NaN,a.textOutlineWidth=NaN,a.textOutlineColor=NaN,a.textOutlineAlpha=NaN,a.textSpacingHorizontal=NaN,a.textSpacingVertical=NaN,a.textDirection=NaN,a.textPaddingHorizontal=NaN,a.textPaddingVertical=NaN,a.textClipping=!1,a.textVertexOffset=a.vertexOffset+a.vertexCount-e,a.textIndexOffset=a.indexOffset+a.indexCount-u,a.textVertexCount=e,a.textIndexCount=u,a}return y(i,n),i.prototype.initText=function(){var t=this.textVertexCount;if(0<t){var n=this.buffer,i=this.textVertexOffset;n.updateClippings(),p(n.clippings,i,t),n.updateIndices(),O(n.indices,i,this.textIndexOffset,this.textIndexCount)}},i.prototype.isCompatible=function(t){return!!n.prototype.isCompatible.call(this,t)&&4*w(t)===this.textVertexCount},i.prototype.updateText=function(t,n){if(0<this.textVertexCount){var i=n.text.atlas;null!=i&&(this.updateTextVertex(t,n,i),this.updateTextColorFill(t,n),this.updateTextColorStroke(t,n),this.updateTextStep(t,n))}},i.prototype.updateColor=function(t,n){var i=this.vertexCount-this.textVertexCount;this.updateColorFillAndStroke(t,n,i)},i.prototype.updateTextVertex=function(n,i,r){var e=i.text,u=e.size,s=e.family,h=e.value,o=e.style,a=e.align.horizontal,c=e.align.vertical,f=e.offset.horizontal,l=e.offset.vertical,v=e.spacing.horizontal,b=e.spacing.vertical,g=e.direction,d=e.padding.horizontal,m=e.padding.vertical,w=e.clipping,p=e.texture||t.Texture.WHITE,O=this.toTextureTransformId(p),D=h!==this.textValue||s!==this.textFamily,E=u!==this.textSize,M=o!==this.textStyle,T=a!==this.textAlignHorizontal||c!==this.textAlignVertical,j=f!==this.textOffsetHorizontal||l!==this.textOffsetVertical,N=v!==this.textSpacingHorizontal||b!==this.textSpacingVertical||d!==this.textPaddingHorizontal||m!==this.textPaddingVertical,I=g!==this.textDirection,C=this.textClipping!==w,A=p!==this.textTexture||O!==this.textTextureTransformId;if(D||E||M||T||j||N||I||C||A){this.textSize=u,this.textFamily=s,this.textValue=h,this.textStyle=o,this.textAlignHorizontal=a,this.textAlignVertical=c,this.textOffsetHorizontal=f,this.textOffsetVertical=l,this.textSpacingHorizontal=v,this.textSpacingVertical=b,this.textDirection=g,this.textPaddingHorizontal=d,this.textPaddingVertical=m,this.textClipping=w,this.textTexture=p,this.textTextureTransformId=O,E&&(this.textWeight=NaN),n.updateVertices(),n.updateUvs();var R=i.size,y=e.world=e.world||new Float32Array(8);S(n.vertices,n.uvs,this.textVertexOffset,this.textVertexCount,0,0,R.x,R.y,r,u,h,o,a,c,f,l,v,b,g,d,m,w,y,this.toTextureUvs(p),i.transform.internalTransform)}},i.prototype.updateTextColorFill=function(t,n){var i=n.text,r=i.color,e=n.visible&&i.enable?i.alpha:0;r===this.textColor&&e===this.textAlpha||(this.textColor=r,this.textAlpha=e,t.updateColorFills(),lt(r,e,this.textVertexOffset,this.textVertexCount,t.colorFills))},i.prototype.updateTextColorStroke=function(t,n){var i=n.text,r=i.outline,e=r.color,u=n.visible&&i.enable?r.alpha:0;e===this.textOutlineColor&&u===this.textOutlineAlpha||(this.textOutlineColor=e,this.textOutlineAlpha=u,t.updateColorStrokes(),lt(e,u,this.textVertexOffset,this.textVertexCount,t.colorStrokes))},i.prototype.updateTextStep=function(t,n){var i=n.text,r=i.outline,e=r.enable?r.width:0,u=i.weight;u===this.textWeight&&e===this.textOutlineWidth||(this.textWeight=u,this.textOutlineWidth=e,t.updateSteps(),D(t.steps,this.textVertexOffset,this.textVertexCount,i.atlas,i.size,e,u,this.antialiasWeight))},i.prototype.buildUnit=function(i){if(n.prototype.buildUnit.call(this,i),0<this.textVertexCount){var r=this.textTexture||t.Texture.WHITE,e=r.baseTexture;e!==i.baseTexture&&(i.baseTexture=e,i.push(r,this.textIndexOffset))}},i}(vt),gt=function(t){function n(n,i,e,u,s,h,o,a){var c=t.call(this,n,i,e,u,s,h,o,a)||this;return c.pointsId=NaN,c.pointsStyle=r.NONE,c}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer,r=this.vertexOffset,e=this.indexOffset;return i.updateClippings(),i.updateIndices(),function(t,n){var i=3*n;t[i+0]=1,t[i+1]=0,t[i+2]=3,t[i+3]=0,t[i+4]=1,t[i+5]=5,t[i+6]=1,t[i+7]=0,t[i+8]=3,t[i+9]=0,t[i+10]=1,t[i+11]=5}(i.clippings,r),function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+2,t[r+2]=n+1,t[r+3]=n+1,t[r+4]=n+2,t[r+5]=n+3}(i.indices,r,e),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexStepAndColorFill(n,t),this.updateColor(n,t),this.updateUv(n,t),this.updateText(n,t)},n.prototype.updateVertexStepAndColorFill=function(t,n){if(n instanceof ft){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=n.stroke,h=s.enable?s.width:0,o=h!==this.strokeWidth,a=this.toTransformLocalId(n),v=this.transformLocalId!==a,b=n.points,g=b.id,d=g!==this.pointsId,m=b.style,w=m!==this.pointsStyle;(u||v||o||d||w)&&(this.sizeX=r,this.sizeY=e,this.strokeWidth=h,this.transformLocalId=a,this.pointsId=g,this.pointsStyle=m,(u||v)&&(this.textSpacingHorizontal=NaN),d&&(this.textureTransformId=NaN),t.updateVertices(),t.updateSteps(),t.updateColorFills(),function(t,n,i,r,e,u,s,h,o){var a=o.a,v=o.b,b=o.c,g=o.d,d=o.tx,m=o.ty,w=e[0],p=e[1],O=a*w+b*p+d,D=v*w+g*p+m,E=e[2],M=e[3],S=a*E+b*M+d,T=v*E+g*M+m,j=S-O,N=T-D,I=Math.sqrt(j*j+N*N),C=I;if(0<=s&&1e-5<I){var A=s/I;S=O+(j*=A),T=D+(N*=A),C=s}var R=O-j,y=D-N,k=S+j,x=T+N,L=f(u),B=r<<1,_=r<<2,P=6*r;t[B+0]=O,t[B+1]=D,t[B+2]=O,t[B+3]=D,n[P+0]=h,n[P+1]=L,n[P+2]=R,n[P+3]=y,n[P+4]=S,n[P+5]=T,n[P+6]=h,n[P+7]=L,n[P+8]=R,n[P+9]=y,n[P+10]=S,n[P+11]=T,i[_+0]=0,i[_+4]=0,t[B+4]=S,t[B+5]=T,t[B+6]=S,t[B+7]=T,n[P+12]=h,n[P+13]=L,n[P+14]=O,n[P+15]=D,n[P+16]=k,n[P+17]=x,n[P+18]=h,n[P+19]=L,n[P+20]=O,n[P+21]=D,n[P+22]=k,n[P+23]=x,i[_+8]=C,i[_+12]=C;var F=c(C,h,u,l),U=F.x,z=F.y;i[_+1]=U,i[_+2]=z,i[_+3]=C,i[_+5]=U,i[_+6]=z,i[_+7]=C,i[_+9]=U,i[_+10]=z,i[_+11]=C,i[_+13]=U,i[_+14]=z,i[_+15]=C}(t.vertices,t.steps,t.colorFills,this.vertexOffset,b.values,m,b.size,h,n.transform.internalTransform))}},n.prototype.updateColorFillAndStroke=function(t,n,i){this.updateColorStroke(t,n,i)},n.prototype.updateUv=function(t,n){var i,r,e,u,s=this.toTexture(n),h=this.toTextureTransformId(s);s===this.texture&&h===this.textureTransformId||(this.texture=s,this.textureTransformId=h,i=t.uvs,r=this.vertexOffset,e=this.toTextureUvs(s),i[0+(u=r<<1)]=e.x0,i[u+1]=e.y0,i[u+2]=e.x3,i[u+3]=e.y3,i[u+4]=e.x1,i[u+5]=e.y1,i[u+6]=e.x2,i[u+7]=e.y2)},n}(bt),dt=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=4+s,a=2+h;return t.check(i,r,o,a)?new gt(t,i,r,s,h,o,a,e).init(n):null},mt=function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},wt=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},pt=function(){function t(){}return t.isActivateKey=function(t){return"Space"===t.key||"Enter"===t.key||32===t.which||13===t.which},t.isArrowUpKey=function(t){return"ArrowUp"===t.key||38===t.which},t.isArrowDownKey=function(t){return"ArrowDown"===t.key||40===t.which},t.isArrowLeftKey=function(t){return"ArrowLeft"===t.key||37===t.which},t.isArrowRightKey=function(t){return"ArrowRight"===t.key||39===t.which},t.isCancelKey=function(t){return"Esc"===t.key||27===t.which},t.isFocusKey=function(t){return"Tab"===t.key||9===t.which},t.isUndoKey=function(t){return t.ctrlKey&&("z"===t.key||90===t.which)},t.isRedoKey=function(t){return t.ctrlKey&&("y"===t.key||89===t.which)},t.isSaveKey=function(t){return t.ctrlKey&&!t.shiftKey&&("s"===t.key||83===t.which)},t.isSaveAsKey=function(t){return t.ctrlKey&&t.shiftKey&&("S"===t.key||83===t.which)},t.isDeleteKey=function(t){return"Delete"===t.key||46===t.which},t.isSelectAllKey=function(t){return t.ctrlKey&&!t.shiftKey&&("a"===t.key||65===t.which)},t.isOkKey=function(t){return"Enter"===t.key||13===t.which},t.getFocusDirection=function(t){return!0!==t.shiftKey},t.toShortcut=function(t){if(mt(t)){var n,i=t,r=i.indexOf("->"),e=void 0;0<=r?(e=i.substring(0,r).trim(),n=i.substring(r+2).trim()):e=i.trim();var u=e.toLowerCase().split("+");return function(t){var n=t.key;if(n.length<=1){t.shift&&(t.key=n.toUpperCase());var i=n.charCodeAt(0);t.which=97<=i&&i<=122?i-32:i}else switch(n){case"Enter":t.which=13;break;case"Space":t.key=" ",t.which=32;break;case"Escape":t.which=27;break;case"F1":t.which=112;break;case"F2":t.which=113;break;case"F3":t.which=114;break;case"F4":t.which=115;break;case"F5":t.which=116;break;case"F6":t.which=117;break;case"F7":t.which=118;break;case"F8":t.which=119;break;case"F9":t.which=120;break;case"F10":t.which=121;break;case"F11":t.which=122;break;case"F12":t.which=123;break;case"CapsLock":t.shift?t.which=20:t.which=240;break;case"ArrowUp":t.which=38;break;case"ArrowDown":t.which=40;break;case"ArrowLeft":t.which=37;break;case"ArrowRight":t.which=39;break;case"Insert":t.which=45;break;case"Delete":t.which=46;break;case"PageUp":t.which=33;break;case"PageDown":t.which=34;break;case"Backspace":t.which=8;break;case";":t.which=187;break;case"Pause":t.which=19;break;case"ScrollLock":t.which=145;break;case"Tab":t.which=9}return t}({alt:0<=u.indexOf("alt"),ctrl:0<=u.indexOf("ctrl"),shift:0<=u.indexOf("shift"),key:u[u.length-1],which:0,event:n})}return t},t.toString=function(t){var n=[];return t.ctrl&&n.push("Ctrl"),t.shift&&n.push("Shift"),t.alt&&n.push("Alt"),n.push(t.key.toUpperCase()),n.join("+")},t.on=function(t,n,i){var r=this.toShortcut(n);document.body.addEventListener("keydown",(function(n){n.altKey!==r.alt||n.ctrlKey!==r.ctrl||n.shiftKey!==r.shift||n.key!==r.key&&n.which!==r.which||(t.state.isActionable&&(null!=r.event?t.emit(r.event):null!=i&&i(n)),n.preventDefault())}))},t.moveFocusVertically=function(n,i,r){if(i.state.isActionable){var e=t.isArrowUpKey(n),u=t.isArrowDownKey(n);if(e||u)return this.moveFocus(u,i,r)}return!1},t.moveFocusHorizontally=function(n,i,r){if(i.state.isActionable){var e=t.isArrowLeftKey(n),u=t.isArrowRightKey(n);if(e||u)return this.moveFocus(u,i,r)}return!1},t.moveFocus=function(t,n,i){var r,e=null!==(r=null==i?void 0:i.picked)&&void 0!==r?r:B.getLayer(n);if(e){var u=e.getFocusController(),s=u.get();if(null!=s){var h=u.find(s,!1,s.state.isFocusRoot||t,t,n);if(null!=h)return u.focus(h),!0}}return!1},t}();!function(t){t[t.NONE=0]="NONE",t[t.POSITION_X=1]="POSITION_X",t[t.POSITION_Y=2]="POSITION_Y",t[t.POSITION=3]="POSITION",t[t.ROTATION=4]="ROTATION",t[t.COLOR_FILL=8]="COLOR_FILL",t[t.COLOR_STROKE=16]="COLOR_STROKE",t[t.COLOR_FILL_AND_STROKE=24]="COLOR_FILL_AND_STROKE",t[t.COLOR_TEXT=32]="COLOR_TEXT",t[t.COLOR_TEXT_OUTLINE=64]="COLOR_TEXT_OUTLINE",t[t.COLOR=120]="COLOR",t[t.VISIBILITY=128]="VISIBILITY",t[t.HEIGHT=256]="HEIGHT",t[t.WIDTH=512]="WIDTH",t[t.SIZE=768]="SIZE",t[t.TEXT=1024]="TEXT",t[t.CURSOR=2048]="CURSOR"}(tt||(tt={}));var Ot,Dt=function(){function n(n){var i=n.transform,r=i.position;this.x=r.x,this.y=r.y,this.size=new t.Point(n.size.x,n.size.y),this.rotation=i.rotation,this.actions=[],this.fill=n.fill.toObject(),this.stroke=n.stroke.toObject(),this.text=n.text.toObject(),this.cursor=n.cursor,this.reset=tt.NONE,this.written=tt.NONE,this.effect=NaN,this.isStateChanged=!1,this.interactive=!1}return n.prototype.onPointerClick=function(t,n){t.state.inDisabled||(t.state.isClicked=!0)},n.prototype.onPointerDblClick=function(t,n){return!1},n.prototype.onPointerOver=function(t,n){t.state.isHovered=!0},n.prototype.onPointerOut=function(t,n){t.state.isHovered=!1},n.prototype.onPointerDown=function(t,n){if(!t.state.isDown){t.state.add(z.DOWN|x.PRESSED);var i=B.getLayer(t);if(i){var r=i.getFocusController();r.focus(r.findParent(t))}}},n.prototype.onPointerUp=function(t,n){!t.state.isUp&&t.state.isPressed&&(t.state.set(z.UP,x.PRESSED),this.onPointerClick(t))},n.prototype.onPointerMove=function(t,n){},n.prototype.onKeyDown=function(t,n){return pt.isActivateKey(n)&&this.onPointerDown(t),!1},n.prototype.onKeyUp=function(t,n){return pt.isActivateKey(n)&&this.onPointerUp(t),!1},n.prototype.onStateChange=function(t,n,i){this.isStateChanged=!0,B.update(t)},n.prototype.update=function(t,n){var i=t.tag,r=this.effect<=n;(i.isChanged||this.isStateChanged||r)&&(r&&(this.effect=NaN),t.disallowUploadedUpdate(),this.onUpdate(t,n),t.allowUploadedUpdate(),t.state.remove(z.CLICKED|z.DOWN|z.UP),this.isStateChanged=!1,i.isChanged=!1)},n.prototype.onUpdate=function(t,n){0<this.actions.length&&(this.executeActions(t,n),this.resetUnwrittenProperties(t))},n.prototype.executeActions=function(t,n){this.written=tt.NONE;for(var i=this.actions,r=0,e=i.length;r<e;++r)i[r].execute(t,this,n)},n.prototype.resetUnwrittenProperties=function(t){var n=~this.written&this.reset;if(n!==tt.NONE){if(n&tt.POSITION_X&&(t.transform.position.x=this.x),n&tt.POSITION_Y&&(t.transform.position.y=this.y),n&tt.VISIBILITY&&(t.visible=!0),n&tt.COLOR_FILL){var i=this.fill;t.fill.set(void 0,i.color,i.alpha)}if(n&tt.COLOR_STROKE){var r=this.stroke;t.stroke.set(void 0,r.color,r.alpha)}if(n&tt.COLOR_TEXT){var e=this.text;t.text.set(void 0,e.color,e.alpha)}if(n&tt.COLOR_TEXT_OUTLINE){var u=this.text.outline;t.text.outline.set(void 0,u.color,u.alpha)}n&tt.HEIGHT&&(t.size.y=this.size.y),n&tt.WIDTH&&(t.size.x=this.size.x),n&tt.ROTATION&&(t.transform.rotation=this.rotation),n&tt.TEXT&&(t.text.value=this.text.value),n&tt.CURSOR&&(t.cursor=this.cursor)}},n}(),Et=function(){function t(){}return t.toBaseFill=function(t,n){return(n.written&tt.COLOR_FILL?t:n).fill},t.toBaseStroke=function(t,n){return(n.written&tt.COLOR_STROKE?t:n).stroke},t.toBaseText=function(t,n){return(n.written&tt.COLOR_TEXT?t:n).text},t.toBaseTextOutline=function(t,n){return(n.written&tt.COLOR_TEXT_OUTLINE?t:n).text.outline},t}(),Mt=function(){function t(){}return t.from=function(t,n,i,r,e){if(t.trim().length<=0)return i;try{return Function("shape","time","try{with( shape ) {with( state ) {"+(e?"var result = ("+t+");return (result != null ? "+n+"(result) : null);":"return "+n+"("+t+");")+"}}} catch( e ) {return "+r+";}")}catch(t){return i}},t.ofNumberOrNull=function(t){return this.from(t,"Number",this.NULL,"null",!0)},t.ofStringOrNull=function(t){return this.from(t,"String",this.NULL,"null",!0)},t.ofUnknown=function(t){return this.from(t,"",this.NULL,"null",!1)},t.ofNumber=function(t){return this.from(t,"Number",this.ZERO,"0",!1)},t.ofNumberOrOne=function(t){return this.from(t,"Number",this.ONE,"1",!1)},t.ofNumberOrOneHundred=function(t){return this.from(t,"Number",this.ONE_HUNDRED,"100",!1)},t.ofString=function(t){return this.from(t,"String",this.EMPTY,'""',!1)},t.ofBoolean=function(t){return this.from(t,"Boolean",this.TRUE,"true",!1)},t.ofBooleanOrTrue=function(t){return this.from(t,"Boolean",this.TRUE,"true",!1)},t.ofBooleanOrFalse=function(t){return this.from(t,"Boolean",this.FALSE,"false",!1)},t.NULL=function(){return null},t.ZERO=function(){return 0},t.ONE=function(){return 1},t.ONE_HUNDRED=function(){return 100},t.EMPTY=function(){return""},t.TRUE=function(){return!0},t.FALSE=function(){return!1},t}(),St=function(){function t(t){this.reset=t||tt.NONE}return t.prototype.execute=function(t,n,i){},t}(),Tt=function(t){function n(n,i){var r=t.call(this,i)||this;return r.condition=Mt.ofBoolean(n.condition),r}return y(n,t),n}(St),jt=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.interval=n.interval,r}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.interval,e=r<<1,u=i%e;u<r?(this.toOff(t,n),n.effect=i+(r-u)):(this.toOn(t,n),n.effect=i+(e-u))}},n.prototype.toOn=function(t,n){},n.prototype.toOff=function(t,n){},n}(Tt),Nt=function(t){function n(n){return t.call(this,n,tt.COLOR)||this}return y(n,t),n.prototype.toOn=function(t,n){var i=Et.toBaseFill(t,n);t.fill.set(void 0,W.brighten(i.color,.5),i.alpha);var r=Et.toBaseStroke(t,n);t.stroke.set(void 0,W.brighten(r.color,.5),r.alpha);var e=Et.toBaseText(t,n);t.text.set(void 0,W.brighten(e.color,.5),e.alpha);var u=Et.toBaseTextOutline(t,n);t.text.outline.set(void 0,W.brighten(u.color,.5),u.alpha),n.written|=this.reset},n}(jt),It=function(t){function n(n){var i=t.call(this,n,tt.COLOR_FILL)||this;return i.color=n.color,i.alpha=n.alpha,i}return y(n,t),n.prototype.toOn=function(t,n){t.fill.set(void 0,this.color,this.alpha),n.written|=this.reset},n}(jt),Ct=function(t){function n(n){var i=t.call(this,n,tt.COLOR_STROKE)||this;return i.color=n.color,i.alpha=n.alpha,i}return y(n,t),n.prototype.toOn=function(t,n){t.stroke.set(void 0,this.color,this.alpha),n.written|=this.reset},n}(jt),At=function(t){function n(n){return t.call(this,n,tt.COLOR)||this}return y(n,t),n.prototype.toOn=function(t,n){var i=Et.toBaseFill(t,n);t.fill.set(void 0,W.darken(i.color,.5),i.alpha);var r=Et.toBaseStroke(t,n);t.stroke.set(void 0,W.darken(r.color,.5),r.alpha);var e=Et.toBaseText(t,n);t.text.set(void 0,W.darken(e.color,.5),e.alpha);var u=Et.toBaseTextOutline(t,n);t.text.outline.set(void 0,W.darken(u.color,.5),u.alpha),n.written|=this.reset},n}(jt),Rt=function(t){function n(n){return t.call(this,n,tt.COLOR_FILL_AND_STROKE)||this}return y(n,t),n.prototype.toOn=function(t,n){var i=Et.toBaseFill(t,n);t.fill.set(void 0,i.color,.5*i.alpha);var r=Et.toBaseStroke(t,n);t.stroke.set(void 0,r.color,.5*r.alpha),n.written|=this.reset},n}(jt),yt=function(t){function n(n){return t.call(this,n,tt.VISIBILITY)||this}return y(n,t),n.prototype.toOn=function(t,n){t.visible=!0,n.written|=this.reset},n.prototype.toOff=function(t,n){t.visible=!1,n.written|=this.reset},n}(jt);!function(t){t[t.VISIBILITY=0]="VISIBILITY",t[t.BRIGHTEN=1]="BRIGHTEN",t[t.DARKEN=2]="DARKEN",t[t.OPACITY=3]="OPACITY",t[t.COLOR_FILL=4]="COLOR_FILL",t[t.COLOR_STROKE=5]="COLOR_STROKE"}(Ot||(Ot={}));var kt,xt=function(){function t(t,n){this.type=t,this.condition=n}return t.prototype.isEquals=function(t){return this.type===t.type&&this.condition===t.condition},t.prototype.toLabel=function(){return Z.getInstance().get("EShapeActionValue").toLabel(this)},t}(),Lt=function(t){function n(n,i,r){var e=t.call(this,n,i)||this;return e.subtype=r,e}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.subtype===i.subtype},n}(xt);!function(t){t[t.SHOW_HIDE=0]="SHOW_HIDE",t[t.BLINK=1]="BLINK",t[t.TRANSFORM=2]="TRANSFORM",t[t.OPEN=3]="OPEN",t[t.EMIT_EVENT=4]="EMIT_EVENT",t[t.CHANGE_COLOR_LEGACY=5]="CHANGE_COLOR_LEGACY",t[t.CHANGE_TEXT=6]="CHANGE_TEXT",t[t.CHANGE_CURSOR=7]="CHANGE_CURSOR",t[t.MISC=8]="MISC",t[t.CHANGE_COLOR=9]="CHANGE_COLOR"}(kt||(kt={}));var Bt,_t=function(){function t(){}return t.toResource=function(t,n,i){if(0<=t&&t<n.length){var r=n[t];if(F(r)&&0<=r&&r<i.length)return i[r]}return""},t}(),Pt=function(t){function n(n,i,r,e,u){var s=t.call(this,kt.BLINK,i,n)||this;return s.interval=r,s.color=e,s.alpha=u,s}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.interval===i.interval&&this.color===i.color&&this.alpha===i.alpha},n.prototype.toRuntime=function(){switch(this.subtype){case Ot.BRIGHTEN:return new Nt(this);case Ot.COLOR_FILL:return new It(this);case Ot.COLOR_STROKE:return new Ct(this);case Ot.DARKEN:return new At(this);case Ot.OPACITY:return new Rt(this);case Ot.VISIBILITY:return new yt(this)}},n.prototype.serialize=function(t){var n=t.addResource(this.condition);return t.addResource("["+this.type+","+n+","+this.subtype+","+this.interval+","+this.color+","+this.alpha+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources);return new n(t[2],r,t[3],t[4],t[5])},n}(Lt),Ft=function(){function t(){}return t.blend=function(t,n,i){var r=Math.max(0,Math.min(1,i));return Math.max(0,Math.min(1,t*(1-r)+n*r))},t}(),Ut=function(t){function n(n){return t.call(this,n,n.subtype<<3)||this}return y(n,t),n.prototype.set=function(t,n,i,r,e,u){var s=this.reset;if(null!=r){if(null!=e)if(null!=u){if(s&tt.COLOR_FILL){var h=Et.toBaseFill(t,n);t.fill.set(void 0,W.blend(h.color,r,u),Ft.blend(h.alpha,e,u))}s&tt.COLOR_STROKE&&(h=Et.toBaseStroke(t,n),t.stroke.set(void 0,W.blend(h.color,r,u),Ft.blend(h.alpha,e,u))),s&tt.COLOR_TEXT&&(h=Et.toBaseText(t,n),t.text.set(void 0,W.blend(h.color,r,u),Ft.blend(h.alpha,e,u))),s&tt.COLOR_TEXT_OUTLINE&&(h=Et.toBaseTextOutline(t,n),t.text.outline.set(void 0,W.blend(h.color,r,u),Ft.blend(h.alpha,e,u)))}else s&tt.COLOR_FILL&&t.fill.set(void 0,r,e),s&tt.COLOR_STROKE&&t.stroke.set(void 0,r,e),s&tt.COLOR_TEXT&&t.text.set(void 0,r,e),s&tt.COLOR_TEXT_OUTLINE&&t.text.outline.set(void 0,r,e);else null!=u?(s&tt.COLOR_FILL&&(h=Et.toBaseFill(t,n),t.fill.set(void 0,W.blend(h.color,r,u),h.alpha)),s&tt.COLOR_STROKE&&(h=Et.toBaseStroke(t,n),t.stroke.set(void 0,W.blend(h.color,r,u),h.alpha)),s&tt.COLOR_TEXT&&(h=Et.toBaseText(t,n),t.text.set(void 0,W.blend(h.color,r,u),h.alpha)),s&tt.COLOR_TEXT_OUTLINE&&(h=Et.toBaseTextOutline(t,n),t.text.outline.set(void 0,W.blend(h.color,r,u),h.alpha))):(s&tt.COLOR_FILL&&(h=Et.toBaseFill(t,n),t.fill.set(void 0,r,h.alpha)),s&tt.COLOR_STROKE&&(h=Et.toBaseStroke(t,n),t.stroke.set(void 0,r,h.alpha)),s&tt.COLOR_TEXT&&(h=Et.toBaseText(t,n),t.text.set(void 0,r,h.alpha)),s&tt.COLOR_TEXT_OUTLINE&&(h=Et.toBaseTextOutline(t,n),t.text.outline.set(void 0,r,h.alpha)));n.written|=s}else null!=e&&(null!=u?(s&tt.COLOR_FILL&&(h=Et.toBaseFill(t,n),t.fill.set(void 0,h.color,Ft.blend(h.alpha,e,u))),s&tt.COLOR_STROKE&&(h=Et.toBaseStroke(t,n),t.stroke.set(void 0,h.color,Ft.blend(h.alpha,e,u))),s&tt.COLOR_TEXT&&(h=Et.toBaseText(t,n),t.text.set(void 0,h.color,Ft.blend(h.alpha,e,u))),s&tt.COLOR_TEXT_OUTLINE&&(h=Et.toBaseTextOutline(t,n),t.text.outline.set(void 0,h.color,Ft.blend(h.alpha,e,u)))):(s&tt.COLOR_FILL&&(h=Et.toBaseFill(t,n),t.fill.set(void 0,h.color,e)),s&tt.COLOR_STROKE&&(h=Et.toBaseStroke(t,n),t.stroke.set(void 0,h.color,e)),s&tt.COLOR_TEXT&&(h=Et.toBaseText(t,n),t.text.set(void 0,h.color,e)),s&tt.COLOR_TEXT_OUTLINE&&(h=Et.toBaseTextOutline(t,n),t.text.outline.set(void 0,h.color,e))),n.written|=s)},n}(Tt);!function(t){t[t.COLOR_AND_ALPHA=0]="COLOR_AND_ALPHA",t[t.COLOR=1]="COLOR",t[t.ALPHA=2]="ALPHA",t[t.CODE=3]="CODE",t[t.BRIGHTNESS=4]="BRIGHTNESS"}(Bt||(Bt={}));var zt,Gt,Ht=function(t){function n(n){var i=t.call(this,n)||this;switch(n.target){case Bt.COLOR:i.color=n.color,i.alpha=null;break;case Bt.ALPHA:i.color=null,i.alpha=n.alpha;break;default:i.color=n.color,i.alpha=n.alpha}return i.blend=Mt.ofNumberOrNull(n.blend),i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.color,e=this.alpha,u=this.blend(t,i);this.set(t,n,i,r,e,u)}},n}(Ut);!function(t){t[t.NONE=0]="NONE",t[t.FILL=1]="FILL",t[t.STROKE=2]="STROKE",t[t.TEXT=4]="TEXT",t[t.TEXT_OUTLINE=8]="TEXT_OUTLINE",t[t.FILL_AND_STROKE=3]="FILL_AND_STROKE",t[t.ALL=15]="ALL"}(zt||(zt={})),function(t){t[t.FILL=0]="FILL",t[t.STROKE=1]="STROKE",t[t.FILL_AND_STROKE=2]="FILL_AND_STROKE",t[t.TEXT=3]="TEXT",t[t.TEXT_OUTLINE=4]="TEXT_OUTLINE",t[t.ALL=5]="ALL"}(Gt||(Gt={}));var Vt,Wt=function(){function t(){}return t.from=function(t){if(t[0]===kt.CHANGE_COLOR)return t[2];switch(t[2]){case Gt.FILL:return zt.FILL;case Gt.STROKE:return zt.STROKE;case Gt.FILL_AND_STROKE:return zt.FILL_AND_STROKE;case Gt.TEXT:return zt.TEXT;case Gt.TEXT_OUTLINE:return zt.TEXT_OUTLINE;case Gt.ALL:return zt.ALL}},t.unpack=function(t){var n=[];return t&zt.FILL&&n.push(zt.FILL),t&zt.STROKE&&n.push(zt.STROKE),t&zt.TEXT&&n.push(zt.TEXT),t&zt.TEXT_OUTLINE&&n.push(zt.TEXT_OUTLINE),n},t.pack=function(t){for(var n=zt.NONE,i=0,r=t.length;i<r;++i)n|=t[i];return n},t}(),Xt=function(t){function n(n,i,r,e,u,s){var h=t.call(this,kt.CHANGE_COLOR,i,n)||this;return h.target=r,h.color=e,h.alpha=u,h.blend=s,h}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.target===i.target&&this.color===i.color&&this.alpha===i.alpha&&this.blend===i.blend},n.prototype.toRuntime=function(){return new Ht(this)},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.blend);return t.addResource("["+this.type+","+n+","+this.subtype+","+this.target+","+this.color+","+this.alpha+","+i+"]")},n.deserialize=function(t,i){var r=Wt.from(t),e=_t.toResource(1,t,i.resources),u=_t.toResource(6,t,i.resources);return new n(r,e,t[3],t[4],t[5],u)},n}(Lt),Yt=function(t){function n(n){var i=t.call(this,n)||this;return i.brightness=Mt.ofNumberOrNull(n.brightness),i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.brightness(t,i);this.set(t,n,i,r)}},n.prototype.set=function(t,n,i,r){var e=this.reset;if(null!=r){var u=this.toAdjusted;if(e&tt.COLOR_FILL){var s=Et.toBaseFill(t,n);t.fill.set(void 0,u(s.color,r),s.alpha)}e&tt.COLOR_STROKE&&(s=Et.toBaseStroke(t,n),t.stroke.set(void 0,u(s.color,r),s.alpha)),e&tt.COLOR_TEXT&&(s=Et.toBaseText(t,n),t.text.set(void 0,u(s.color,r),s.alpha)),e&tt.COLOR_TEXT_OUTLINE&&(s=Et.toBaseTextOutline(t,n),t.text.outline.set(void 0,u(s.color,r),s.alpha)),n.written|=e}},n.prototype.toAdjusted=function(t,n){return 0<=n?W.brighten(t,+n):W.darken(t,-n)},n}(Ut),Kt=function(t){function n(n,i,r){var e=t.call(this,kt.CHANGE_COLOR,i,n)||this;return e.brightness=r,e}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.brightness===i.brightness},n.prototype.toRuntime=function(){return new Yt(this)},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=Bt.BRIGHTNESS,r=t.addResource(this.brightness);return t.addResource("["+this.type+","+n+","+this.subtype+","+i+","+r+"]")},n.deserialize=function(t,i){return new n(Wt.from(t),_t.toResource(1,t,i.resources),_t.toResource(4,t,i.resources))},n}(Lt),Jt=function(t){function n(n){var i=t.call(this,n)||this;return i.color=Mt.ofNumberOrNull(n.color),i.alpha=Mt.ofNumberOrNull(n.alpha),i.blend=Mt.ofNumberOrNull(n.blend),i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.color(t,i),e=this.alpha(t,i),u=this.blend(t,i);this.set(t,n,i,r,e,u)}},n}(Ut),Zt=function(t){function n(n,i,r,e,u){var s=t.call(this,kt.CHANGE_COLOR,i,n)||this;return s.color=r,s.alpha=e,s.blend=u,s}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.color===i.color&&this.alpha===i.alpha&&this.blend===i.blend},n.prototype.toRuntime=function(){return new Jt(this)},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=Bt.CODE,r=t.addResource(this.color),e=t.addResource(this.alpha),u=t.addResource(this.blend);return t.addResource("["+this.type+","+n+","+this.subtype+","+i+","+r+","+e+","+u+"]")},n.deserialize=function(t,i){return new n(Wt.from(t),_t.toResource(1,t,i.resources),_t.toResource(4,t,i.resources),_t.toResource(5,t,i.resources),_t.toResource(6,t,i.resources))},n}(Lt),qt=function(t){function n(n){var i=t.call(this,n,tt.CURSOR)||this;return i.name=Mt.ofStringOrNull(n.name),i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.name(t,i);null!=r&&(t.cursor=r,n.written|=this.reset)}},n}(Tt),$t=function(t){function n(n,i){var r=t.call(this,kt.CHANGE_CURSOR,n)||this;return r.name=i,r}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.name===i.name},n.prototype.toRuntime=function(){return new qt(this)},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.name);return t.addResource("["+this.type+","+n+","+i+"]")},n.deserialize=function(t,i){return new n(_t.toResource(1,t,i.resources),_t.toResource(2,t,i.resources))},n}(xt),Qt=function(){function t(){}return t.prototype.format=function(t,n,i){return i.getHours()<12?"AM":"PM"},t}(),tn=function(){function t(){}return t.prototype.format=function(t,n,i){return i.getHours()<12?"am":"pm"},t}(),nn=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getDate())},t}(),rn=function(){function t(){}return t.prototype.format=function(t,n,i){return""+(0|t)},t}(),en=function(t){this.precision=null!=t?+t.substring(1,t.length):void 0},un=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.format=function(t,n,i){return t.toExponential(this.precision)},n}(en),sn=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.format=function(t,n,i){return t.toFixed(this.precision)},n}(en),hn=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.format=function(t,n,i){var r=this.toAbs(t,n,i);return r<1e-24?this.Rt(t,1,""):r<1e-21?this.Rt(t,1e24,"y"):r<1e-18?this.Rt(t,1e21,"z"):r<1e-15?this.Rt(t,1e18,"a"):r<1e-12?this.Rt(t,1e15,"f"):r<1e-9?this.Rt(t,1e12,"p"):r<1e-6?this.Rt(t,1e9,"n"):r<.001?this.Rt(t,1e6,""):r<1?this.Rt(t,1e3,"m"):r<1e3?this.Rt(t,1,""):r<1e6?this.Rt(t,.001,"k"):r<1e9?this.Rt(t,1e-6,"M"):r<1e12?this.Rt(t,1e-9,"G"):r<1e15?this.Rt(t,1e-12,"T"):r<1e18?this.Rt(t,1e-15,"P"):r<1e21?this.Rt(t,1e-18,"E"):r<1e24?this.Rt(t,1e-21,"Z"):this.Rt(t,1e-24,"Y")},n.prototype.toAbs=function(t,n,i){return Math.abs(t)},n.prototype.Rt=function(t,n,i){return""+(t*n).toFixed(this.precision)+i},n}(en),on=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.format=function(t,n,i){return t.toPrecision(this.precision)},n}(en),an=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getHours())},t}(),cn=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getHours()%12)},t}(),fn=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getMonth()+1)},t}(),ln=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getMinutes())},t}(),vn=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getMilliseconds())},t}(),bn=function(){function t(){}return t.prototype.format=function(t,n,i){return(100*t|0)+"%"},t}(),gn=function(){function t(){}return t.prototype.format=function(t,n,i){return(0|t)+"%"},t}(),dn=function(){function t(t,n,i){this.length=t,this.character=n,this.node=i}return t.prototype.format=function(t,n,i){return V(this.node.format(t,n,i),this.length,this.character)},t}(),mn=function(){function t(t){this.node=t}return t.prototype.format=function(t,n,i){var r=this.node.format(t,n,i);return 0<r.length&&"-"===r[0]?"("+r.substring(1,r.length)+")":r},t}(),wn=function(){function t(t){this.node=t}return t.prototype.format=function(t,n,i){var r=this.node.format(t,n,i);return 0<r.length&&"-"!==r[0]?"+"+r:r},t}(),pn=function(){function t(){}return t.prototype.format=function(t,n,i){return Math.round(100*t)+"%"},t}(),On=function(){function t(){}return t.prototype.format=function(t,n,i){return Math.round(t)+"%"},t}(),Dn=function(){function t(t,n,i,r,e,u,s){this.Y=t,this.M=n,this.D=i,this.H=r,this.m=e,this.s=u,this.mi=s}return t.prototype.format=function(t,n,i){return n<1e3?this.s.format(t,n,i)+"."+this.mi.format(t,n,i):n<6e4?this.m.format(t,n,i)+":"+this.s.format(t,n,i):n<36e5?this.H.format(t,n,i)+":"+this.m.format(t,n,i):n<864e5?this.M.format(t,n,i)+"/"+this.D.format(t,n,i)+" "+this.H.format(t,n,i):n<2592e6?this.M.format(t,n,i)+"/"+this.D.format(t,n,i):this.Y.format(t,n,i)+"/"+this.M.format(t,n,i)},t}(),En=function(){function t(t){this.node=t}return t.prototype.format=function(t,n,i){var r=this.node.format(t,n,i);return 0<r.length&&"-"!==r[0]?" "+r:r},t}(),Mn=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.toAbs=function(t,n,i){return Math.abs(n)},n}(hn),Sn=function(){function t(t){this.str=t}return t.prototype.format=function(t,n,i){return this.str},t}(),Tn=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getFullYear())},t}(),jn=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getFullYear()%100)},t}(),Nn=function(){function t(){}return t.prototype.format=function(t,n,i){var r=i.getTimezoneOffset();return(r<=0?"+":"-")+V(String(Math.floor(Math.abs(r)/60)),2,"0")+":"+V(String(Math.floor(Math.abs(r)%60)),2,"0")},t}(),In=function(){function t(){}return t.prototype.format=function(t,n,i){return""+Math.round(t)},t}(),Cn=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getSeconds())},t}(),An=/%(0|_|-|\+|\()?(\.\d+)?(Y(?:MD?)?|y(?:MD?)?|MD?|D|H(?:ms?)?|h(?:ms?)?|m(?:i|s)?|a|A|s(?:s?i|dt)?|z|%|f(?:si)?|e|g|d|r(?:d|p)|p|P|RP)/g,Rn=function(){function t(t){var n=0,i=!1,r=[];for(An.lastIndex=0;;){var e=An.exec(t);if(null==e){n<t.length&&r.push(new Sn(t.substring(n,t.length)));break}var u=e.index;n<u&&r.push(new Sn(t.substring(n,u))),n=u+e[0].length;var s=e[0],h=e[1],o=e[2];switch(e[3]){case"Y":i=!0,r.push(new Tn);break;case"YM":i=!0,r.push(new Tn,new Sn("/"),this.toModifiedNodeDatetime2(h,new fn));break;case"YMD":i=!0,r.push(new Tn,new Sn("/"),this.toModifiedNodeDatetime2(h,new fn),new Sn("/"),this.toModifiedNodeDatetime2(h,new nn));break;case"y":i=!0,r.push(this.toModifiedNodeDatetime2(h,new jn));break;case"yM":i=!0,r.push(this.toModifiedNodeDatetime2(h,new jn),new Sn("/"),this.toModifiedNodeDatetime2(h,new fn));break;case"yMD":r.push(this.toModifiedNodeDatetime2(h,new jn),new Sn("/"),this.toModifiedNodeDatetime2(h,new fn),new Sn("/"),this.toModifiedNodeDatetime2(h,new nn));break;case"M":i=!0,r.push(this.toModifiedNodeDatetime2(h,new fn));break;case"MD":i=!0,r.push(this.toModifiedNodeDatetime2(h,new fn),new Sn("/"),this.toModifiedNodeDatetime2(h,new nn));break;case"D":i=!0,r.push(this.toModifiedNodeDatetime2(h,new nn));break;case"H":i=!0,r.push(this.toModifiedNodeDatetime2(h,new an));break;case"Hm":i=!0,r.push(this.toModifiedNodeDatetime2(h,new an),new Sn(":"),this.toModifiedNodeDatetime2(h,new ln));break;case"Hms":i=!0,r.push(this.toModifiedNodeDatetime2(h,new an),new Sn(":"),this.toModifiedNodeDatetime2(h,new ln),new Sn(":"),this.toModifiedNodeDatetime2(h,new Cn));break;case"h":i=!0,r.push(this.toModifiedNodeDatetime2(h,new cn));break;case"hm":i=!0,r.push(this.toModifiedNodeDatetime2(h,new cn),new Sn(":"),this.toModifiedNodeDatetime2(h,new ln));break;case"hms":i=!0,r.push(this.toModifiedNodeDatetime2(h,new cn),new Sn(":"),this.toModifiedNodeDatetime2(h,new ln),new Sn(":"),this.toModifiedNodeDatetime2(h,new Cn));break;case"m":i=!0,r.push(this.toModifiedNodeDatetime2(h,new ln));break;case"ms":i=!0,r.push(this.toModifiedNodeDatetime2(h,new ln),new Sn(":"),this.toModifiedNodeDatetime2(h,new Cn));break;case"mi":i=!0,r.push(this.toModifiedNodeDatetime3(h,new vn));break;case"a":i=!0,r.push(new tn);break;case"A":i=!0,r.push(new Qt);break;case"s":i=!0,r.push(this.toModifiedNodeDatetime2(h,new Cn));break;case"sdt":i=!0,r.push(new Dn(new Tn,this.toModifiedNodeDatetime2(h,new fn),this.toModifiedNodeDatetime2(h,new nn),this.toModifiedNodeDatetime2(h,new an),this.toModifiedNodeDatetime2(h,new ln),this.toModifiedNodeDatetime2(h,new Cn),this.toModifiedNodeDatetime3(h,new vn)));break;case"z":i=!0,r.push(new Nn);break;case"%":r.push(new Sn("%"));break;case"f":r.push(this.toModifiedNodeNumber(h,new sn(o)));break;case"e":r.push(this.toModifiedNodeNumber(h,new un(o)));break;case"g":r.push(this.toModifiedNodeNumber(h,new on(o)));break;case"rd":r.push(this.toModifiedNodeNumber(h,new In));break;case"d":r.push(this.toModifiedNodeNumber(h,new rn));break;case"P":r.push(this.toModifiedNodeNumber(h,new bn));break;case"p":r.push(this.toModifiedNodeNumber(h,new gn));break;case"RP":r.push(this.toModifiedNodeNumber(h,new pn));break;case"rp":r.push(this.toModifiedNodeNumber(h,new On));break;case"fsi":r.push(this.toModifiedNodeNumber(h,new hn(o)));break;case"ssi":r.push(this.toModifiedNodeNumber(h,new Mn(o)));break;default:r.push(new Sn(s))}}this.isDateRequired=i,this.nodes=r,this.date=new Date}return t.prototype.toModifiedNodeDatetime2=function(t,n){switch(t){case"_":return new dn(2," ",n);case"-":return n;default:return new dn(2,"0",n)}},t.prototype.toModifiedNodeDatetime3=function(t,n){switch(t){case"_":return new dn(3," ",n);case"-":return n;default:return new dn(3,"0",n)}},t.prototype.toModifiedNodeNumber=function(t,n){switch(t){case"_":return new En(n);case"+":return new wn(n);case"(":return new mn(n);default:return n}},t.prototype.format=function(t,n){var i=this.nodes,r=this.date;this.isDateRequired&&r.setTime(t);for(var e="",u=0,s=i.length;u<s;++u)e+=i[u].format(t,n,r);return e},t}(),yn=function(){function t(){}return t.create=function(t){return new Rn(t)},t}(),kn=function(t){function n(n,i){var r=t.call(this,n,tt.TEXT)||this;return r.number=Mt.ofNumber(n.value),i=i.trim(),r.formatter=0<i.length?yn.create(i):null,r}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.number(t,i);t.text.value=null!=this.formatter?this.formatter.format(r,0):String(r),n.written|=this.reset}},n}(Tt),xn=function(t){function n(n){var i=t.call(this,n,tt.TEXT)||this;return i.text=Mt.ofString(n.value),i}return y(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&(t.text.value=this.text(t,i),n.written|=this.reset)},n}(Tt);!function(t){t[t.TEXT=0]="TEXT",t[t.NUMBER=1]="NUMBER"}(Vt||(Vt={}));var Ln,Bn=function(t){function n(n,i,r){var e=t.call(this,kt.CHANGE_TEXT,i,n)||this;return e.value=r,e}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.value===i.value},n.prototype.toRuntime=function(t){switch(this.subtype){case Vt.TEXT:return new xn(this);case Vt.NUMBER:return new kn(this,t.text.value)}},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.value);return t.addResource("["+this.type+","+n+","+this.subtype+","+i+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources),e=_t.toResource(3,t,i.resources);return new n(t[2],r,e)},n}(Lt),_n=function(t){return"function"==typeof t},Pn=function(){function t(t,n,i){if(this.yt=t,this.kt=i,null!=n&&null!=n.background){var r=n.background;this.st=r.color,this.ht=r.alpha}}return t.prototype.getTheme=function(){return this.yt},t.prototype.setTheme=function(t){this.yt=t},t.prototype.getColor=function(t){var n=this.st;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getBackgroundColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.st!==t&&(this.st=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){var n=this.ht;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getBackgroundAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.ht!==t&&(this.ht=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.onChange=function(){var t=this.kt;null!=t&&t()},t}();!function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=4]="BOTTOM",t[t.LEFT=8]="LEFT",t[t.TOP_RIGHT=3]="TOP_RIGHT",t[t.TOP_BOTTOM=5]="TOP_BOTTOM",t[t.TOP_LEFT=9]="TOP_LEFT",t[t.RIGHT_BOTTOM=6]="RIGHT_BOTTOM",t[t.RIGHT_LEFT=10]="RIGHT_LEFT",t[t.BOTTOM_LEFT=12]="BOTTOM_LEFT",t[t.NOT_TOP=14]="NOT_TOP",t[t.NOT_RIGHT=13]="NOT_RIGHT",t[t.NOT_BOTTOM=11]="NOT_BOTTOM",t[t.NOT_LEFT=7]="NOT_LEFT",t[t.ALL=15]="ALL"}(Ln||(Ln={}));var Fn,Un=function(){function t(t,n,i){if(this.yt=t,this.kt=i,null!=n&&null!=n.border){var r=n.border;this.st=r.color,this.ht=r.alpha,this.ot=r.width,this.at=r.align,this.xt=mt(r.mask)?Ln[r.mask]:r.mask}}return t.prototype.getTheme=function(){return this.yt},t.prototype.setTheme=function(t){this.yt=t},t.prototype.getColor=function(t){var n=this.st;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getBorderColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.st!==t&&(this.st=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){var n=this.ht;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getBorderAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.ht!==t&&(this.ht=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getWidth=function(t){var n=this.ot;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getBorderWidth(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this.ot},set:function(t){this.ot!==t&&(this.ot=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getAlign=function(t){var n=this.at;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getBorderAlign(t)},Object.defineProperty(t.prototype,"align",{get:function(){return this.at},set:function(t){this.at!==t&&(this.at=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getMask=function(t){var n=this.xt;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getBorderMask(t)},Object.defineProperty(t.prototype,"mask",{get:function(){return this.xt},set:function(t){this.xt!==t&&(this.xt=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.onChange=function(){var t=this.kt;null!=t&&t()},t}();!function(t){t[t.NONE=0]="NONE",t[t.TOP_LEFT=1]="TOP_LEFT",t[t.TOP_RIGHT=2]="TOP_RIGHT",t[t.BOTTOM_LEFT=4]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT",t[t.TOP=3]="TOP",t[t.BOTTOM=12]="BOTTOM",t[t.LEFT=5]="LEFT",t[t.RIGHT=10]="RIGHT",t[t.ALL=15]="ALL"}(Fn||(Fn={}));var zn,Gn=function(){function t(t,n,i){if(this.yt=t,this.kt=i,null!=n&&null!=n.corner){var r=n.corner;F(r)?(this.Ct=r,this.xt=void 0):(this.Ct=r.radius,this.xt=mt(r.mask)?Fn[r.mask]:r.mask)}}return t.prototype.getTheme=function(){return this.yt},t.prototype.setTheme=function(t){this.yt=t},t.prototype.getRadius=function(){var t=this.Ct;return void 0!==t?t:this.yt.getCornerRadius()},Object.defineProperty(t.prototype,"radius",{get:function(){return this.Ct},set:function(t){if(this.Ct!==t){this.Ct=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t.prototype.getMask=function(){var t=this.xt;return void 0!==t?t:this.yt.getCornerMask()},Object.defineProperty(t.prototype,"mask",{get:function(){return this.xt},set:function(t){if(this.xt!==t){this.xt=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=!1;this.Ct!==t&&(this.Ct=t,i=!0),this.xt!==n&&(this.xt=n,i=!0);var r=this.kt;i&&null!=r&&r()},t}();!function(t){t[t.NONE=0]="NONE",t[t.SELF=1]="SELF",t[t.CHILDREN=2]="CHILDREN",t[t.BOTH=3]="BOTH"}(zn||(zn={}));var Hn,Vn,Wn=function(){function t(t,n,i){if(this.yt=t,this.kt=i,null!=n&&null!=n.outline){var r=n.outline;this.st=r.color,this.ht=r.alpha,this.ot=r.width,this.Lt=r.offset,this.at=r.align,this.xt=mt(r.mask)?Ln[r.mask]:r.mask}}return t.prototype.getTheme=function(){return this.yt},t.prototype.setTheme=function(t){this.yt=t},t.prototype.getColor=function(t){var n=this.st;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getOutlineColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){if(this.st!==t){this.st=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){var n=this.ht;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getOutlineAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){if(this.ht!==t){this.ht=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t.prototype.getWidth=function(t){var n=this.ot;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getOutlineWidth(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this.ot},set:function(t){if(this.ot!==t){this.ot=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t.prototype.getOffset=function(t){var n=this.Lt;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getOutlineOffset(t)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.Lt},set:function(t){if(this.Lt!==t){this.Lt=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t.prototype.getAlign=function(t){var n=this.at;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getOutlineAlign(t)},Object.defineProperty(t.prototype,"align",{get:function(){return this.at},set:function(t){if(this.at!==t){this.at=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t.prototype.getMask=function(t){var n=this.xt;if(void 0!==n){if(!_n(n))return n;var i=n(t);if(void 0!==i)return i}return this.yt.getOutlineMask(t)},Object.defineProperty(t.prototype,"mask",{get:function(){return this.xt},set:function(t){if(this.xt!==t){this.xt=t;var n=this.kt;null!=n&&n()}},enumerable:!1,configurable:!0}),t}(),Xn=function(){function t(t,n,i){if(this.yt=t,this.kt=i,null!=n&&null!=n.padding){var r=n.padding;F(r)?(this.Bt=r,this._t=r,this.Pt=r,this.Ft=r):(this.Bt=r.left,this._t=r.top,this.Pt=r.right,this.Ft=r.bottom)}}return t.prototype.getTheme=function(){return this.yt},t.prototype.setTheme=function(t){this.yt=t},t.prototype.getLeft=function(){var t=this.Bt;return void 0!==t?t:this.yt.getPaddingLeft()},Object.defineProperty(t.prototype,"left",{get:function(){return this.Bt},set:function(t){this.Bt!==t&&(this.Bt=t,null!=this.kt&&this.kt())},enumerable:!1,configurable:!0}),t.prototype.getTop=function(){var t=this._t;return void 0!==t?t:this.yt.getPaddingTop()},Object.defineProperty(t.prototype,"top",{get:function(){return this._t},set:function(t){this._t!==t&&(this._t=t,null!=this.kt&&this.kt())},enumerable:!1,configurable:!0}),t.prototype.getRight=function(){var t=this.Pt;return void 0!==t?t:this.yt.getPaddingRight()},Object.defineProperty(t.prototype,"right",{get:function(){return this.Pt},set:function(t){this.Pt!==t&&(this.Pt=t,null!=this.kt&&this.kt())},enumerable:!1,configurable:!0}),t.prototype.getBottom=function(){var t=this.Ft;return void 0!==t?t:this.yt.getPaddingBottom()},Object.defineProperty(t.prototype,"bottom",{get:function(){return this.Ft},set:function(t){this.Ft!==t&&(this.Ft=t,null!=this.kt&&this.kt())},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n,i,r){null==n?(this.top=t,this.right=t,this.bottom=t,this.left=t):null==i?(this.top=t,this.right=n,this.bottom=t,this.left=n):null==r?(this.top=t,this.right=n,this.bottom=i,this.left=n):(this.top=t,this.right=n,this.bottom=i,this.left=r),null!=this.kt&&this.kt()},t}(),Yn=function(){function t(t,n){this.Ut=t,this.L=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this.Ut.x},set:function(t){var n=this.Ut,i=n.x;if(i!==t){n.x=t;var r=n.y;this.L(t,r,i,r)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.Ut.y},set:function(t){var n=this.Ut,i=n.y;if(i!==t){n.y=t;var r=n.x;this.L(r,t,r,i)}},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=this.Ut,r=i.x,e=i.y;return r===t&&e===n||(i.set(t,n),this.L(t,n,r,e)),this},t.prototype.copyFrom=function(t){var n=t.x,i=t.y,r=this.Ut,e=r.x,u=r.y;return e===n&&u===i||(r.copyFrom(t),this.L(n,i,e,u)),this},t.prototype.copyTo=function(t){return t.copyFrom(this.Ut)},t.prototype.copy=function(){return this.copyFrom(arguments[0])},t.prototype.clone=function(n){return n=n||this.L,new t(this.Ut,n)},t.prototype.equals=function(t){return this.Ut.equals(t)},t}(),Kn=function(t){function n(n,i,r,e,u){var s=t.call(this,new Float32Array(56),new Float32Array(56),new Uint16Array(42))||this;return s.ot=i,s.zt=r,s.Gt=n,s.Ht=e,s.Vt=u,s.Wt=!0,s.Xt=NaN,s.Yt=s.getBuffer("aVertexPosition"),s.Kt=s.Yt.data,s.Jt=s.getBuffer("aTextureCoord"),s._uvs=s.Jt.data,s.Zt=s.getIndex(),s.qt=s.Zt.data,s}return y(n,t),Object.defineProperty(n.prototype,"borderSize",{get:function(){return this.Ht},set:function(t){this.Ht!==t&&(this.Ht=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cornerMask",{get:function(){return this.Vt},set:function(t){this.Vt!==t&&(this.Vt=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.ot},set:function(t){this.ot!==t&&(this.ot=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.zt},set:function(t){this.zt!==t&&(this.zt=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this.Gt},set:function(t){this.Gt!==t&&(this.Gt=t,this.Wt=!0,this.Xt=NaN)},enumerable:!1,configurable:!0}),n.prototype.getTextureId=function(){return this.Gt._updateID},n.prototype.fillVertices=function(t,n,i,r,e,u){n[t+0]=i,n[t+1]=e,n[t+2]=r,n[t+3]=e,n[t+4]=i,n[t+5]=u,n[t+6]=r,n[t+7]=u},n.prototype.fillIndices=function(t,n,i){n[t+0]=i+0,n[t+1]=i+1,n[t+2]=i+2,n[t+3]=i+1,n[t+4]=i+3,n[t+5]=i+2},n.prototype.fillUvsCorner=function(t,n,i,r,e,u,s,h,o,a,c){i?this.fillVertices(t,n,r,e,h,o):this.fillVertices(t,n,s,u,h,o)},n.prototype.fillUvs=function(t,n,i,r,e,u){this.fillVertices(t,n,i,r,e,u)},n.prototype.update=function(){var t=this.texture;if(t.valid){var n=this.getTextureId();if(this.Wt||this.Xt!==n){this.Wt=!1,this.Xt=n;var i=this.Kt,r=this._uvs,e=this.qt,u=this.ot,s=this.zt,h=this.Ht,o=Math.min(.5*u,h),a=Math.max(.5*u,u-h),c=u,f=Math.min(.5*s,h),l=Math.max(.5*s,s-h),v=s,b=t._uvs,g=b.x0,d=b.x1,m=b.y0,w=b.y3,p=(d-g)*(h/t.width),O=(w-m)*(h/t.height),D=g,E=g+p,M=d-p,S=d,T=m,j=m+O,N=w-O,I=w,C=this.Vt,A=!(C&Fn.TOP_LEFT),R=!(C&Fn.TOP_RIGHT),y=!(C&Fn.BOTTOM_LEFT),k=!(C&Fn.BOTTOM_RIGHT),x=0,L=0,B=0;this.fillVertices(x,i,0,o,0,f),this.fillUvsCorner(x,r,A,D,E,M,S,T,j,N,I),this.fillIndices(B,e,L),x+=8,L+=4,B+=6,this.fillVertices(x,i,o,a,0,f),this.fillUvs(x,r,E,M,T,j),this.fillIndices(B,e,L),x+=8,L+=4,B+=6,this.fillVertices(x,i,c,a,0,f),this.fillUvsCorner(x,r,R,D,E,M,S,T,j,N,I),this.fillIndices(B,e,L),x+=8,L+=4,B+=6,this.fillVertices(x,i,0,c,f,l),this.fillUvs(x,r,D,S,j,N),this.fillIndices(B,e,L),x+=8,L+=4,B+=6,this.fillVertices(x,i,0,o,v,l),this.fillUvsCorner(x,r,y,D,E,M,S,T,j,N,I),this.fillIndices(B,e,L),x+=8,L+=4,B+=6,this.fillVertices(x,i,o,a,l,v),this.fillUvs(x,r,E,M,N,I),this.fillIndices(B,e,L),x+=8,L+=4,B+=6,this.fillVertices(x,i,c,a,v,l),this.fillUvsCorner(x,r,k,S,M,E,D,I,N,j,T),this.fillIndices(B,e,L),this.Yt.update(),this.Jt.update(),this.Zt.update()}}},n}(t.MeshGeometry),Jn=function(n){function i(i,r,e){return n.call(this,new Kn(i,100,100,r,e),new t.MeshMaterial(i))||this}return y(i,n),Object.defineProperty(i.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this.geometry.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.geometry.width},set:function(t){this.geometry.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.geometry.height},set:function(t){this.geometry.height=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"borderSize",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.borderSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"cornerMask",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.cornerMask=t},enumerable:!1,configurable:!0}),i.prototype._render=function(t){this.geometry.update(),n.prototype._render.call(this,t)},i.prototype.update=function(){this.geometry.update()},i}(t.Mesh),Zn=function(t){function n(n,i,r,e,u,s){var h=t.call(this,new Float32Array(64),new Float32Array(64),new Uint16Array(48))||this;return h.ot=i,h.zt=r,h.Gt=n,h.Ht=e,h.$t=u,h.Vt=s,h.Wt=!0,h.Xt=NaN,h.Yt=h.getBuffer("aVertexPosition"),h.Kt=h.Yt.data,h.Jt=h.getBuffer("aTextureCoord"),h._uvs=h.Jt.data,h.Zt=h.getIndex(),h.qt=h.Zt.data,h}return y(n,t),Object.defineProperty(n.prototype,"borderMask",{get:function(){return this.$t},set:function(t){this.$t!==t&&(this.$t=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cornerMask",{get:function(){return this.Vt},set:function(t){this.Vt!==t&&(this.Vt=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"borderSize",{get:function(){return this.Ht},set:function(t){this.Ht!==t&&(this.Ht=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.ot},set:function(t){this.ot!==t&&(this.ot=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.zt},set:function(t){this.zt!==t&&(this.zt=t,this.Wt=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this.Gt},set:function(t){this.Gt!==t&&(this.Gt=t,this.Wt=!0,this.Xt=NaN)},enumerable:!1,configurable:!0}),n.prototype.fillVertices=function(t,n,i,r,e,u){n[t+0]=i,n[t+1]=e,n[t+2]=r,n[t+3]=e,n[t+4]=i,n[t+5]=u,n[t+6]=r,n[t+7]=u},n.prototype.fillIndices=function(t,n,i){n[t+0]=i+0,n[t+1]=i+1,n[t+2]=i+2,n[t+3]=i+1,n[t+4]=i+3,n[t+5]=i+2},n.prototype.fillUvsCorner=function(t,n,i,r,e,u,s,h,o,a,c,f,l){i||r?e?this.fillVertices(t,n,u,s,a,c):i&&r?this.fillVertices(t,n,o,h,a,c):i?this.fillVertices(t,n,s,h,a,c):this.fillVertices(t,n,u,s,c,f):this.fillVertices(t,n,s,s,c,c)},n.prototype.fillUvs=function(t,n,i,r,e,u,s,h,o){i?this.fillVertices(t,n,r,e,u,s):this.fillVertices(t,n,h,h,o,o)},n.prototype.update=function(){var t=this.Gt;if(t.valid){var n=t._updateID;if(this.Wt||this.Xt!==n){this.Wt=!1,this.Xt=n;var i=this.Kt,r=this._uvs,e=this.qt,u=this.ot,s=this.zt,h=this.Ht,o=Math.min(.5*u,h),a=Math.max(.5*u,u-h),c=u,f=Math.min(.5*s,h),l=Math.max(.5*s,s-h),v=s,b=t._uvs,g=b.x0,d=b.x1,m=b.y0,w=b.y3,p=(d-g)*(h/t.width),O=(w-m)*(h/t.height),D=g,E=g+p,M=d-p,S=d,T=m,j=m+O,N=w-O,I=w,C=this.$t,A=!(C&Ln.TOP),R=!(C&Ln.BOTTOM),y=!(C&Ln.LEFT),k=!(C&Ln.RIGHT),x=this.Vt,L=!(x&Fn.TOP_LEFT),B=!(x&Fn.TOP_RIGHT),_=!(x&Fn.BOTTOM_LEFT),P=!(x&Fn.BOTTOM_RIGHT),F=0,U=0,z=0;this.fillVertices(F,i,0,o,0,f),this.fillUvsCorner(F,r,A,y,L,D,E,M,S,T,j,N,I),this.fillIndices(z,e,U),F+=8,U+=4,z+=6,this.fillVertices(F,i,o,a,0,f),this.fillUvs(F,r,A,E,M,T,j,E,j),this.fillIndices(z,e,U),F+=8,U+=4,z+=6,this.fillVertices(F,i,c,a,0,f),this.fillUvsCorner(F,r,A,k,B,D,E,M,S,T,j,N,I),this.fillIndices(z,e,U),F+=8,U+=4,z+=6,this.fillVertices(F,i,0,o,f,l),this.fillUvs(F,r,y,D,E,j,N,E,j),this.fillIndices(z,e,U),F+=8,U+=4,z+=6,this.fillVertices(F,i,a,c,f,l),this.fillUvs(F,r,k,M,S,j,N,M,N),this.fillIndices(z,e,U),F+=8,U+=4,z+=6,this.fillVertices(F,i,0,o,v,l),this.fillUvsCorner(F,r,R,y,_,D,E,M,S,T,j,N,I),this.fillIndices(z,e,U),F+=8,U+=4,z+=6,this.fillVertices(F,i,o,a,l,v),this.fillUvs(F,r,R,E,M,N,I,M,N),this.fillIndices(z,e,U),F+=8,U+=4,z+=6,this.fillVertices(F,i,c,a,v,l),this.fillUvsCorner(F,r,R,k,P,S,M,E,D,I,N,j,T),this.fillIndices(z,e,U),this.Yt.update(),this.Jt.update(),this.Zt.update()}}},n}(t.MeshGeometry),qn=function(n){function i(i,r,e,u){return n.call(this,new Zn(i,100,100,r,e,u),new t.MeshMaterial(i))||this}return y(i,n),Object.defineProperty(i.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this.geometry.texture=t)},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.geometry.width},set:function(t){this.geometry.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.geometry.height},set:function(t){this.geometry.height=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"borderSize",{get:function(){return this.geometry.borderSize},set:function(t){this.geometry.borderSize=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"borderMask",{get:function(){return this.geometry.borderMask},set:function(t){this.geometry.borderMask=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"cornerMask",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.cornerMask=t},enumerable:!1,configurable:!0}),i.prototype._render=function(t){this.geometry.update(),n.prototype._render.call(this,t)},i.prototype.update=function(){this.geometry.update()},i}(t.Mesh),$n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n}(qn),Qn=function(){function t(t){var n=t.theme,i=t.corner,r=i.getRadius(),e=r+1,u=i.getMask(),s=this.Qt=new Jn(n.getBackgroundTexture(r),e,u);t.addRenderable(s,!0);var h=t.state,o=t.border,a=o.getWidth(h),c=o.getMask(h),f=this.tn=new qn(n.getBorderTexture(r,a),e,c,u);t.addRenderable(f,!1);var l=t.outline,v=l.getWidth(h),b=l.getMask(h),g=this.nn=new $n(n.getBorderTexture(r,v),e,b,u);t.addRenderable(g,!1),this.rn=r,this.en=r,this.un=a,this.sn=r,this.hn=v,t.addReflowable(this)}return t.prototype.onReflow=function(t,n,i){var r=t.theme,e=t.state,u=t.corner,s=u.getRadius(),h=s+1,o=u.getMask(),a=t.background,c=this.Qt,f=a.getColor(e);if(null!=f){var l=a.getAlpha(e);0<l?(this.rn!==s&&(this.rn=s,c.texture=r.getBackgroundTexture(s),c.borderSize=h),c.tint=f,c.alpha=l,c.width=n,c.height=i,c.cornerMask=o,c.visible=!0):c.visible=!1}else c.visible=!1;var v=t.border,b=this.tn,g=v.getColor(e);if(null!=g){var d=v.getAlpha(e);if(0<d){var m=v.getWidth(e);this.en===s&&this.un===m||(this.en=s,this.un=m,b.texture=r.getBorderTexture(s,m),b.borderSize=h);var w=v.getAlign(e),p=v.getMask(e);b.tint=g,b.alpha=d;var O=w*m;b.x=-O,b.y=-O,b.width=n+2*O,b.height=i+2*O,b.borderMask=p,b.cornerMask=o,b.visible=!0}else b.visible=!1}else b.visible=!1;var D=t.outline,E=this.nn,M=D.getColor(e);if(null!=M){var S=D.getAlpha(e);if(0<S){var T=D.getWidth(e);this.sn===s&&this.hn===T||(this.sn=s,this.hn=T,E.texture=r.getBorderTexture(s,T),E.borderSize=h);var j=D.getMask(e),N=D.getOffset(e),I=D.getAlign(e);E.tint=M,E.alpha=S;var C=N+I*T;E.x=-C,E.y=-C,E.width=n+2*C,E.height=i+2*C,E.borderMask=j,E.cornerMask=o,E.visible=!0}else E.visible=!1}else E.visible=!1},t}();!function(t){t[t.NONE=0]="NONE",t[t.BEFORE=1]="BEFORE",t[t.AFTER=2]="AFTER",t[t.BOTH=3]="BOTH"}(Hn||(Hn={})),function(t){t[t.OPEN=0]="OPEN",t[t.CLOSE=1]="CLOSE",t[t.PARENSESIS=2]="PARENSESIS",t[t.ADD_OR_PLUS=3]="ADD_OR_PLUS",t[t.SUB_OR_MINUS=4]="SUB_OR_MINUS",t[t.PLUS=5]="PLUS",t[t.MINUS=6]="MINUS",t[t.ADD=7]="ADD",t[t.SUB=8]="SUB",t[t.MUL=9]="MUL",t[t.DIV=10]="DIV",t[t.MIN=11]="MIN",t[t.MAX=12]="MAX",t[t.COMMA=13]="COMMA",t[t.PARENT=14]="PARENT",t[t.SELF=15]="SELF",t[t.PADDING=16]="PADDING",t[t.CURRENT=17]="CURRENT",t[t.NUMBER=18]="NUMBER"}(Vn||(Vn={}));var ti,ni={"+":3,"-":4,"*":9,"/":10,"(":0,")":1,",":13,min:11,max:12},ii={"%":14,s:15,p:16,c:17},ri=function(){function t(t){var n=this.toToken(t),i=0;do{i=this.toParensesis(n,i)}while(i<n.length);if(this.toUnary(n),this.toArithmetic(n,9,10),this.toArithmetic(n,7,8),1===n.length){var r=n[0];if(!F(r))return void(this.an=r)}throw new Error("Failed to parse '"+t+"'")}return t.prototype.toParensesis=function(t,n){for(var i=t.length,r=n;r<i;++r)if(0===t[r]){var e=r,u=2;if(0<r){var s=t[r-1];11!==s&&12!==s||(e-=1,u=s)}for(var h=r+1;h<i;++h){var o=t[h];if(1===o)return t[e]=[u,this.toComma(t,r+1,h)],t.splice(e+1,h-e),e+1;0===o&&(h=this.toParensesis(t,h)-1,i=t.length)}throw new Error("Malformed parensesis")}return i},t.prototype.toCommaOf=function(t,n,i){var r=i-n;if(r<=0)return[18,0];if(r<=1)return t[n];for(var e=[],u=n;u<i;++u)e.push(t[u]);return[2,e]},t.prototype.toComma=function(t,n,i){for(var r=null,e=n,u=n;u<i;++u)13===t[u]&&((r=r||[]).push(this.toCommaOf(t,e,u)),e=u+1);if(e<i){if(null==r){var s=[];for(u=e;u<i;++u)s.push(t[u]);return s}r.push(this.toCommaOf(t,e,i))}return r||[]},t.prototype.toUnaryNode=function(t){F(t)||2!==t[0]&&11!==t[0]&&12!==t[0]||this.toUnary(t[1])},t.prototype.toUnary=function(t){for(var n=0,i=t.length;n<i;++n){var r=t[n];if(3===r||4===r)if(n<=0||F(t[n-1])){if(!(n+1<i)||F(t[n+1]))throw new Error("Malformed unary operator");var e=t.splice(n+1,1)[0],u=3===r?5:6;t[n]=[u,e],i=t.length,this.toUnaryNode(e)}else u=3===r?7:8,t[n]=u;else this.toUnaryNode(r),i=t.length}},t.prototype.toArithmeticNode=function(t,n,i){F(t)||(2===t[0]||11===t[0]||12===t[0]?this.toArithmetic(t[1],n,i):5===t[0]||6===t[0]?this.toArithmeticNode(t[1],n,i):7!==t[0]&&8!==t[0]&&9!==t[0]&&10!==t[0]||(this.toArithmeticNode(t[1],n,i),this.toArithmeticNode(t[2],n,i)))},t.prototype.toArithmetic=function(t,n,i){for(var r=0,e=t.length;r<e;++r){var u=t[r];if(u===n||u===i){if(0<r&&r+1<e){var s=t[r-1],h=t[r+1];if(!F(s)&&!F(h)){t.splice(r,2),t[r-1]=[u,s,h],r-=1,e=t.length,this.toArithmeticNode(s,n,i),this.toArithmeticNode(h,n,i);continue}}throw new Error("Malformed operands for the operator "+u)}this.toArithmeticNode(u,n,i),e=t.length}},t.prototype.toToken=function(n){for(var i=[];;){var r=t.TOKEN_REGEX.exec(n);if(null==r)break;var e=r[0],u=ni[e];if(null!=u)i.push(u);else{var s=parseFloat(e);if(s!=s)throw new Error("Unexpected token '"+e+"' at "+r.index+" in '"+n+"'");var h=ii[e[e.length-1]];null!=h?i.push([h,.01*s]):i.push([18,s])}}return i},t.prototype.evaluate=function(t,n,i,r,e){switch(t[0]){case 2:var u=t[1];return this.evaluate(u[u.length-1],n,i,r,e);case 5:return+this.evaluate(t[1],n,i,r,e);case 6:return-this.evaluate(t[1],n,i,r,e);case 7:return this.evaluate(t[1],n,i,r,e)+this.evaluate(t[2],n,i,r,e);case 8:return this.evaluate(t[1],n,i,r,e)-this.evaluate(t[2],n,i,r,e);case 9:return this.evaluate(t[1],n,i,r,e)*this.evaluate(t[2],n,i,r,e);case 10:return this.evaluate(t[1],n,i,r,e)/this.evaluate(t[2],n,i,r,e);case 11:if(0<t[1].length){for(var s=t[1],h=this.evaluate(s[0],n,i,r,e),o=1,a=s.length;o<a;++o)h=Math.min(h,this.evaluate(s[o],n,i,r,e));return h}return 0;case 12:if(0<t[1].length){for(s=t[1],h=this.evaluate(s[0],n,i,r,e),o=1,a=s.length;o<a;++o)h=Math.max(h,this.evaluate(s[o],n,i,r,e));return h}return 0;case 14:return t[1]*n;case 15:return t[1]*i;case 16:return t[1]*r;case 17:return t[1]*e;case 18:return t[1]}return 0},t.prototype.calculate=function(t,n,i,r){return this.evaluate(this.an,t,n,i,r)},t.TOKEN_REGEX=/(?:\+|-|\*|\/|\(|\)|min|max|,|(?:\d+(?:\.\d*)?[%psc]?))/g,t}(),ei=function(t,n){return.5*(t-n)},ui=function(t,n,i){return i},si=function(t){return t},hi=function(t,n,i){return t-i},oi=function(){function t(){}return t.position=function(t){if(null==t||F(t))return null;if(mt(t)){switch(t){case"center":case"CENTER":return ei;case"padding":case"PADDING":return ui}var n=new ri(t);return function(t,i,r,e){return n.calculate(t,i,r,e)}}if(_n(t))return t;var i=t;return function(t,n,r,e){return i.calculate(t,n,r,e)}},t.size=function(t){if(null==t||F(t))return null;if(mt(t)){switch(t){case"100%":case"maximized":case"MAXIMIZED":return si;case"padding":case"PADDING":return hi}var n=new ri(t);return function(t,i,r,e){return n.calculate(t,i,r,e)}}if(_n(t))return t;var i=t;return function(t,n,r,e){return i.calculate(t,n,r,e)}},t}(),ai=function(){function t(){}return Object.defineProperty(t,"touchable",{get:function(){return"ontouchstart"in document},enumerable:!1,configurable:!0}),Object.defineProperty(t,"tap",{get:function(){return"pointertap"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"down",{get:function(){return"pointerdown"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"enter",{get:function(){return"pointerenter"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"leave",{get:function(){return"pointerleave"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"move",{get:function(){return"pointermove"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"out",{get:function(){return"pointerout"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"over",{get:function(){return"pointerover"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"up",{get:function(){return"pointerup"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cancel",{get:function(){return"pointercancel"},enumerable:!1,configurable:!0}),t.toGlobal=function(t,n,i){if("touches"in t){var r=t.changedTouches,e=r[r.length-1];null!=e?n.mapPositionToPoint(i,e.clientX,e.clientY):n.mapPositionToPoint(i,0,0)}else n.mapPositionToPoint(i,t.clientX,t.clientY);return i},t.onClick=function(t,n){var i=this;if(this.touchable){var r=!1,e=0,u=0,s=null,h=function(){r=!1,s&&(s.off(o,a),s=null)};t.on("click",(function(t){r&&h(),n(t)}));var o=this.up,a=function(s){r&&(h(),i.contains(t,s.target)&&function(t){var n=t.data.global,r=Math.abs(e-n.x),s=Math.abs(u-n.y),h=i.CLICK_DISTANCE_THRESHOLD;return r<=h&&s<=h}(s)&&n(s))};t.on(this.down,(function(n){if(r){var i=n.data.global;e=i.x,u=i.y}else{r=!0;var h=n.data.global;e=h.x,u=h.y,s&&(s.off(o,a),s=null);var c=B.getLayer(t);c&&(s=c.renderer.plugins.interaction).once(o,a)}}))}else t.on("click",n)},t.onLongClick=function(t,n,i){var r=this;if(this.touchable){var e=!1,u=0,s=0,h=null,o=null,a=function(){null!=h&&(clearTimeout(h),h=null)},c=function(){e=!1,o&&(o.off(l,b),o.off(v,g),o=null),a()},f=function(t){var n=t.data.global,i=Math.abs(u-n.x),e=Math.abs(s-n.y),h=r.CLICK_DISTANCE_THRESHOLD;return i<h&&e<h};t.on("click",(function(t){e&&c(),n(t)}));var l=this.up,v=this.move,b=function(i){e&&(c(),r.contains(t,i.target)&&f(i)&&n(i))},g=function(n){e&&r.contains(t,n.target)&&(f(n)||c())};t.on(this.down,(function(n){if(!e){e=!0;var f=n.data.global;u=f.x,s=f.y,a(),"touches"in n.data.originalEvent&&(h=window.setTimeout((function(){e&&(c(),i(n))}),r.LONG_CLICK_THRESHOLD)),o&&(o.off(l,b),o.off(v,g),o=null);var d=B.getLayer(t);d&&((o=d.renderer.plugins.interaction).once(l,b),o.on(v,g))}}))}else t.on("click",n)},t.onDblClick=function(t,n){var i=this;if(this.touchable){var r=0,e=0,u=0,s=0;t.addEventListener("dblclick",n),t.addEventListener("touchend",(function(t){if(1===r||3===r){var h=t.changedTouches,o=h[h.length-1];if(null!=o){var a=e-o.clientX,c=u-o.clientY;if(Math.abs(a)+Math.abs(c)<i.CLICK_DISTANCE_THRESHOLD)return void(4===(r+=1)?(r=0,t.timeStamp-s<i.DBLCLICK_INTERVAL_THRESHOLD?n(t):(s=t.timeStamp,r=2)):s=t.timeStamp)}}r=0})),t.addEventListener("touchstart",(function(t){if(0===r){if(null!=(n=t.touches.item(t.touches.length-1)))return r=1,e=n.clientX,void(u=n.clientY)}else if(2===r){var n;if(null!=(n=t.touches.item(t.touches.length-1)))return r=3,e=n.clientX,void(u=n.clientY)}r=0}))}else t.addEventListener("dblclick",n)},t.contains=function(t,n){for(var i=n;null!=i&&i!==t;)i=i.parent;return i===t},t.CLICK_DISTANCE_THRESHOLD=10,t.DBLCLICK_INTERVAL_THRESHOLD=333,t.LONG_CLICK_THRESHOLD=750,t}(),ci=function(){function t(){this.cn=!1}return Object.defineProperty(t.prototype,"isOff",{get:function(){return!this.cn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOn",{get:function(){return this.cn},enumerable:!1,configurable:!0}),t.prototype.toCoordinate=function(t){return this.cn?"auto":t},t.prototype.from=function(t){return"auto"===t||"AUTO"===t?(this.cn=!0,!0):(this.cn=!1,!1)},t}(),fi=function(){this.width=new ci,this.height=new ci},li=function(n){function i(t){var r=n.call(this)||this,e=r.transform;r.u=new Yn(e.position,(function(t,n,i,e){r.onPositionChanged(t,n,i,e)})),r.fn=new Yn(e.scale,(function(t,n,i,e){r.onScaleChanged(t,n,i,e)})),r.ln=new Yn(e.skew,(function(t,n,i,e){r.onSkewChanged(t,n,i,e)})),r.vn=t;var u=r.bn={};r.gn=new fi,r.Wt=!0,r.dn=!1,r.mn=!1,r.wn=null,r.name=t&&t.name||"";var s=r.yt=function(t){if(null!=t&&null!=t.theme){var n=t.theme;return mt(n)?Z.getInstance().get(n):n}return null}(t)||r.getThemeDefault();r.pn=[],r.On=[],r.Dn=[],r.En=t&&null!=t.clear?mt(t.clear)?Hn[t.clear]:t.clear:s.getClearType(),r.Mn=new Xn(s,t,(function(){r.layout(),r.toChildrenDirty(),B.update(r)}));var h=function(){r.toDirty(),B.update(r)};r.Sn=new Pn(s,t,h),r.Tn=new Un(s,t,h),r.jn=new Wn(s,t,h),r.At=new Gn(s,t,h);var o=e.position,a=t&&null!=t.x?t.x:s.getX();F(a)?o.x=a:(o.x=0,u.x=oi.position(a));var c=t&&null!=t.y?t.y:s.getY();F(c)?o.y=c:(o.y=0,u.y=oi.position(c));var f=t&&null!=t.width?t.width:s.getWidth();r.gn.width.from(f)?r.ot=100:F(f)?r.ot=f:(r.ot=100,u.width=oi.size(f));var l=t&&null!=t.height?t.height:s.getHeight();r.gn.height.from(l)?r.zt=100:F(l)?r.zt=l:(r.zt=100,u.height=oi.size(l)),t&&null!=t.visible&&(r.visible=t.visible),r.Z=new U((function(t,n){r.onStateChange(t,n)}));var v=t&&null!=t.interactive?mt(t.interactive)?zn[t.interactive]:t.interactive:s.getInteractive();r.interactive=0!=(v&zn.SELF),r.interactiveChildren=0!=(v&zn.CHILDREN);var b=t&&t.on;if(b)for(var g in b){var d=b[g];d&&r.on(g,d)}r.Nn=t&&null!=t.title?t.title:s.getTitle(),r.jt=t&&null!=t.weight?t.weight:s.getWeight(),r.initReflowable(),r.In=function(){B.update(r)};var m=t&&t.shadow||s.getShadow();if(m)if(mt(m))switch(m){case"WEAK":r.shadow=s.newShadowWeak();break;case"DEFAULT":r.shadow=s.newShadow()}else r.shadow=m;r.on(ai.over,(function(t){r.onOver(t)})),r.on(ai.out,(function(t){r.onOut(t)})),r.on(ai.down,(function(t){r.onDown(t)})),r.on(ai.up,(function(t){r.onUp(t)})),r.on("added",(function(){r.layout(),(r.isDirty()||r.hasDirty())&&r.toParentHasDirty(),r.mn&&r.toParentChildrenDirty();var t=r.parent;t instanceof i&&r.state.update(t.state),B.update(r)})),r.on("removed",(function(){r.blur(!0);var t=r.parent;t instanceof i&&r.state.update(t.state),B.update(r)}));var w=r.Cn=function(t){if(null!=t&&(null!=t.shortcuts||null!=t.shortcut)){var n=[];if(null!=t.shortcut&&n.push(pt.toShortcut(t.shortcut)),null!=t.shortcuts)for(var i=t.shortcuts,r=0,e=i.length;r<e;++r)pt.toShortcut(i[r]);return n}}(t);if(null!=w)for(var p=function(t){r.onShortcut(t)},O=0,D=w.length;O<D;++O)pt.on(r,w[O],p);var E=t&&t.cursor;if(null==E&&(E=s.getCursor()),null!=E&&(r.cursor=E),r.init(t),t&&null!=t.state){var M=t.state;if(mt(M))r.state.set(x[M],!0);else if(F(M))r.state.set(M,!0);else{var S=x.NONE;for(O=0,D=M.length;O<D;++O)S|=x[M[O]];r.state.set(S,!0)}}if(t&&null!=t.parent&&t.parent.addChild(r),t&&null!=t.children){var T=t.children;for(O=0,D=T.length;O<D;++O){var j=T[O];null!=j&&r.addChild(j)}}return r.emit("init",r),r}return y(i,n),i.prototype.addRenderable=function(t,n){t.parent=this,(n?this.pn:this.On).push(t)},i.prototype.addRenderableAt=function(t,n,i){t.parent=this;var r=n?this.pn:this.On;0<=i&&i<r.length?r.splice(i,0,t):r.push(t)},i.prototype.removeRenderable=function(t,n){t.parent=null;var i=n?this.pn:this.On,r=i.indexOf(t);0<=r&&i.splice(r,1)},i.prototype.addReflowable=function(t){this.Dn.push(t)},i.prototype.removeReflowable=function(t){var n=this.Dn,i=n.indexOf(t);0<=i&&n.splice(i,1)},i.prototype.initReflowable=function(){new Qn(this)},i.prototype.onChildrenChange=function(){this.toChildrenDirty(),n.prototype.onChildrenChange.call(this)},i.prototype.onShortcut=function(t){},i.prototype.init=function(t){},Object.defineProperty(i.prototype,"weight",{get:function(){return this.jt},enumerable:!1,configurable:!0}),i.prototype.onPositionChanged=function(t,n,i,r){this.moveChildren(t,n,i,r),B.update(this),this.emit("move",t,n,i,r,this)},i.prototype.resize=function(t,n){var i=this.ot,r=this.zt,e=i!==t,u=r!==n;e&&(this.ot=t),u&&(this.zt=n);var s,h=e||u;if(h&&this.onResize(t,n,i,r),e&&null!=(s=this.bn).x){var o=this.transform.position,a=this.getParentOfSize();a&&(this.x=s.x(a.width,t,a.padding.getLeft(),o.x))}if(u&&null!=(s=this.bn).y){o=this.transform.position;var c=this.getParentOfSize();c&&(this.y=s.y(c.height,n,c.padding.getTop(),o.y))}return h},i.prototype.getClearType=function(){return this.En},i.prototype.onResize=function(t,n,i,r){this.toDirty(),this.toChildrenDirty(),this.resizeChildren(),B.update(this),this.emit("resize",t,n,i,r,this)},i.prototype.onScaleChanged=function(t,n,i,r){B.update(this),this.emit("scale",t,n,i,r,this)},i.prototype.onSkewChanged=function(t,n,i,r){B.update(this),this.emit("skew",t,n,i,r,this)},Object.defineProperty(i.prototype,"type",{get:function(){return this.getType()},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"x",{get:function(){return this.u.x},set:function(t){this.u.x=t},enumerable:!1,configurable:!0}),i.prototype.getX=function(){var t=this.bn;return null!=t.x?t.x:this.x},i.prototype.setX=function(t){if(F(t))this.x=t;else{var n=this.bn,i=oi.position(t);n.x!==i&&(n.x=i,this.layout())}},Object.defineProperty(i.prototype,"y",{get:function(){return this.u.y},set:function(t){this.u.y=t},enumerable:!1,configurable:!0}),i.prototype.getY=function(){var t=this.bn;return null!=t.y?t.y:this.y},i.prototype.setY=function(t){if(F(t))this.y=t;else{var n=this.bn,i=oi.position(t);n.y!==i&&(n.y=i,this.layout())}},Object.defineProperty(i.prototype,"width",{get:function(){return this.ot},set:function(t){var n=this.ot;if(n!==t){this.ot=t;var i=this.zt;this.onResize(t,i,n,i);var r=this.bn;if(null!=r.x){var e=this.transform.position,u=this.getParentOfSize();u&&(this.x=r.x(u.width,t,u.padding.getLeft(),e.x))}}},enumerable:!1,configurable:!0}),i.prototype.getWidth=function(){return this.gn.width.toCoordinate(this.bn.width||this.ot)},i.prototype.setWidth=function(t){var n=this.gn.width,i=n.isOn,r=n.from(t);if(n.isOn!==i&&(this.toChildrenDirty(),B.update(this)),!r)if(F(t))this.width=t;else{var e=this.bn,u=oi.size(t);e.width!==u&&(e.width=u,this.layout())}},Object.defineProperty(i.prototype,"height",{get:function(){return this.zt},set:function(t){var n=this.zt;if(n!==t){this.zt=t;var i=this.ot;this.onResize(i,t,i,n);var r=this.bn;if(null!=r.y){var e=this.transform.position,u=this.getParentOfSize();u&&(this.y=r.y(u.height,t,u.padding.getTop(),e.y))}}},enumerable:!1,configurable:!0}),i.prototype.getHeight=function(){return this.gn.height.toCoordinate(this.bn.height||this.zt)},i.prototype.setHeight=function(t){var n=this.gn.height,i=n.isOn,r=n.from(t);if(n.isOn!==i&&(this.toChildrenDirty(),B.update(this)),!r)if(F(t))this.height=t;else{var e=this.bn,u=oi.size(t);e.height!==u&&(e.height=u,this.layout())}},Object.defineProperty(i.prototype,"position",{get:function(){return this.u},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scale",{get:function(){return this.fn},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"skew",{get:function(){return this.ln},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"padding",{get:function(){return this.Mn},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"corner",{get:function(){return this.At},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"background",{get:function(){return this.Sn},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"border",{get:function(){return this.Tn},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"outline",{get:function(){return this.jn},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"unsafe",{get:function(){return this.transform},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"title",{get:function(){return this.Nn},set:function(t){this.Nn!==t&&(this.Nn=t,this.state.isHovered&&this.applyTitle())},enumerable:!1,configurable:!0}),i.prototype.applyTitle=function(){var t=B.getLayer(this);t&&(t.view.title=this.Nn)},i.prototype.show=function(){return this.visible||(this.visible=!0,this.toParentChildrenDirty(),B.update(this)),this},i.prototype.isShown=function(){return this.visible},i.prototype.hide=function(){return this.visible&&(this.visible=!1,this.toParentChildrenDirty(),B.update(this)),this},i.prototype.isHidden=function(){return!this.visible},i.prototype.toDirty=function(){return!this.Wt&&(this.Wt=!0,this.toParentHasDirty(),!0)},i.prototype.toHasDirty=function(){return!this.dn&&(this.dn=!0,this.toParentHasDirty(),!0)},i.prototype.toParentHasDirty=function(){var t=this.parent;t instanceof i&&t.toHasDirty()},i.prototype.toChildrenDirty=function(){return!this.mn&&(this.mn=!0,this.onChildrenDirty(),this.toParentChildrenDirty(),!0)},i.prototype.toParentChildrenDirty=function(){var t=this.parent;t instanceof i&&t.toChildrenDirty()},i.prototype.isChildrenDirty=function(){return this.mn},i.prototype.onChildrenDirty=function(){},i.prototype.isDirty=function(){return this.Wt},i.prototype.hasDirty=function(){return this.dn},i.prototype.setFocused=function(t){if(this.state.isFocused!==t){var n=B.getLayer(this);n&&n.getFocusController().set(this,t)}return this},i.prototype.focus=function(){return this.setFocused(!0)},i.prototype.blur=function(t){if(t){var n=B.getLayer(this);if(n){var r=n.getFocusController().get();if(r instanceof i)for(var e=r;e;){if(e===this){r.setFocused(!1);break}e=e.parent}}}else this.setFocused(!1);return this},i.prototype.onStateChange=function(t,n){this.toDirty(),B.update(this),this.emit("statechange",t,n,this);for(var r=this.children,e=0,u=r.length;e<u;++e){var s=r[e];s instanceof i&&s.state.update(t)}t.isFocused?n.isFocused||this.onFocused():n.isFocused&&this.onBlured()},i.prototype.onChildFocused=function(t){var n=this.parent;n instanceof i&&n.onChildFocused(t)},i.prototype.onFocused=function(){var t=this.parent;t instanceof i&&t.onChildFocused(this)},i.prototype.onBlured=function(){},Object.defineProperty(i.prototype,"state",{get:function(){return this.Z},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"theme",{get:function(){return this.yt},set:function(t){this.yt!==t&&(this.yt=t,this.Mn.setTheme(t),this.Sn.setTheme(t),this.Tn.setTheme(t),this.jn.setTheme(t),this.At.setTheme(t),this.toDirty(),B.update(this))},enumerable:!1,configurable:!0}),i.prototype.refit=function(){if(this.mn){this.mn=!1;for(var t=this.children,n=0,r=t.length;n<r;++n){var e=t[n];e instanceof i&&e.refit()}this.onRefit()}},i.prototype.onRefit=function(){var t=this.gn,n=t.width.isOn,i=t.height.isOn;if(n&&i){for(var r=0,e=0,u=0,s=(o=this.children).length;u<s;++u)(a=o[u]).visible&&(this.hasRefitableWidth(a)&&(r=Math.max(r,a.x+a.width)),this.hasRefitableHeight(a)&&(e=Math.max(e,a.y+a.height)));var h=this.padding;this.resize(r+h.getRight(),e+h.getBottom())}else if(n){for(r=0,u=0,s=(o=this.children).length;u<s;++u)(a=o[u]).visible&&this.hasRefitableWidth(a)&&(r=Math.max(r,a.x+a.width));this.width=r+this.padding.getRight()}else if(i){var o;for(e=0,u=0,s=(o=this.children).length;u<s;++u){var a;(a=o[u]).visible&&this.hasRefitableHeight(a)&&(e=Math.max(e,a.y+a.height))}this.height=e+this.padding.getBottom()}},i.prototype.isRefitable=function(t){return t instanceof i},i.prototype.hasRefitableHeight=function(t){return this.isRefitable(t)&&!(t instanceof i&&_n(t.getHeight()))},i.prototype.hasRefitableWidth=function(t){return this.isRefitable(t)&&!(t instanceof i&&_n(t.getWidth()))},i.prototype.reflow=function(){if(this.Wt&&(this.onReflow(),this.Wt=!1),this.dn){for(var t=this.children,n=0,r=t.length;n<r;++n){var e=t[n];e instanceof i&&e.reflow()}this.dn=!1}},i.prototype.onReflow=function(){for(var t=this.ot,n=this.zt,i=this.Dn,r=0,e=i.length;r<e;++r)i[r].onReflow(this,t,n)},Object.defineProperty(i.prototype,"shadow",{get:function(){return this.wn},set:function(t){var n=this.wn;n!==t&&(null!=n&&(n.off("update",this.In),this.removeReflowable(n),this.removeRenderable(n,!0)),this.wn=t,null!=t&&(t.on("update",this.In),this.addReflowable(t),this.addRenderableAt(t,!0,0)),B.update(this))},enumerable:!1,configurable:!0}),i.prototype.layout=function(){var t=this.getParentOfSize();t&&this.onParentResize(t.width,t.height,t.padding)},i.prototype.getParentOfSize=function(){var t=this.parent;return t instanceof i?t:B.getLayer(this)},i.prototype.onParentResize=function(t,n,i){var r=this.bn,e=this.transform.position,u=e.x,s=e.y,h=this.ot,o=this.zt,a=i.getLeft()+i.getRight(),c=i.getTop()+i.getBottom(),f=null!=r.width?r.width(t,h,a,h):h,l=null!=r.height?r.height(n,o,c,o):o;this.resize(f,l);var v=null!=r.x?r.x(t,this.ot,i.getLeft(),u):u,b=null!=r.y?r.y(n,this.zt,i.getTop(),s):s;this.position.set(v,b)},i.prototype.resizeChildren=function(){for(var t=this.ot,n=this.zt,r=this.Mn,e=this.children,u=0,s=e.length;u<s;++u){var h=e[u];h instanceof i&&h.onParentResize(t,n,r)}},i.prototype.onParentMove=function(t,n,i,r){},i.prototype.moveChildren=function(t,n,r,e){for(var u=this.children,s=0,h=u.length;s<h;++s){var o=u[s];o instanceof i&&o.onParentMove(t,n,r,e)}},i.prototype.onWheel=function(t,n,i){return this.emit("wheel",t,n,i,this),!1},i.prototype.onKeyDown=function(t){return this.emit("keydown",t,this),!1},i.prototype.onKeyUp=function(t){return this.emit("keyup",t,this),!1},i.prototype.isEventTarget=function(t){var n=t.target;if(n===this)return!0;if(!(n instanceof i)){for(var r=n.parent;null!=r&&!(r instanceof i);)r=r.parent;return r===this}return!1},i.prototype.onDown=function(t){this.isEventTarget(t)&&this.onDownThis(t),this.emit("down",t,this)},i.prototype.onDownThis=function(n){if("touches"in n.data.originalEvent){var i=this.An||new t.Point;this.An=i,i.copyFrom(n.data.global)}else this.focusOnClosest()},i.prototype.onUp=function(t){this.isEventTarget(t)&&this.onUpThis(t),this.emit("up",t,this)},i.prototype.onUpThis=function(t){if("touches"in t.data.originalEvent){var n=this.An;if(n){var i=t.data.global,r=Math.abs(i.x-n.x),e=Math.abs(i.y-n.y),u=ai.CLICK_DISTANCE_THRESHOLD;r<u&&e<u&&this.focusOnClosest()}}},i.prototype.focusOnClosest=function(){var t=B.getLayer(this);if(t){var n=t.getFocusController();n.focus(n.findParent(this))}},i.prototype.onOver=function(t){this.state.isHovered=!0,t.target===this&&this.applyTitle(),this.emit("over",t,this)},i.prototype.onOut=function(t){this.state.isHovered=!1,this.emit("out",t,this)},i.prototype.onDblClick=function(t,n){return this.emit("dblclick",t,n,this),!1},i.prototype.render=function(t){this.visible&&0<this.worldAlpha&&this.renderable&&(this.renderBefore(t),n.prototype.render.call(this,t),this.renderAfter(t))},i.prototype.renderBefore=function(t){for(var n=this.pn,i=0,r=n.length;i<r;++i){var e=n[i];e.updateTransform(),e.render(t)}},i.prototype.renderAfter=function(t){for(var n=this.On,i=0,r=n.length;i<r;++i){var e=n[i];e.updateTransform(),e.render(t)}},i.prototype.getThemeDefault=function(){return Z.getInstance().get(this.getType())},i.prototype.getType=function(){return"DBase"},i.prototype._calculateBounds=function(){var t=this.transform.worldTransform,r=this._bounds,e=i.WORK_CONTAINS_POINT;e.set(0,0),t.apply(e,e),r.addPoint(e),e.set(this.ot,this.zt),t.apply(e,e),r.addPoint(e),n.prototype._calculateBounds.call(this)},i.prototype.containsPoint=function(t){return this.containsGlobalPoint(t)||this.containsLocalPoint(this.worldTransform.applyInverse(t,i.WORK_CONTAINS_POINT))},i.prototype.containsGlobalPoint=function(t){return!1},i.prototype.containsLocalPoint=function(t){return 0<=t.x&&t.x<=this.ot&&0<=t.y&&t.y<=this.zt},i.prototype.getClippingRect=function(t,n){n.x=0,n.y=0,n.width=this.ot,n.height=this.zt},i.prototype.destroy=function(){var t=this.bn;t.x=null,t.y=null,t.width=null,t.height=null;var i=this.wn;i&&(this.wn=null,i.destroy());for(var r=this.children,e=r.length-1;0<=e;--e)r[e].destroy();r.length=0,n.prototype.destroy.call(this)},i.WORK_CONTAINS_POINT=new t.Point,i}(t.Container),vi=function(t){function n(n){var i=t.call(this)||this;return i.parent=n,i}return y(n,t),n.prototype.render=function(n){this.updateTransform(),t.prototype.render.call(this,n)},n.prototype.onReflow=function(t,n,i){var r=t.corner,e=Math.max(0,r.getRadius()-.5),u=r.getMask(),s=u&Fn.TOP_LEFT?0:e,h=u&Fn.TOP_RIGHT?0:e,o=u&Fn.BOTTOM_LEFT?0:e,a=u&Fn.BOTTOM_RIGHT?0:e;this.clear(),this.beginFill(16777215,1),this.lineStyle(0,0,0,0,!1),s<=0&&h<=0&&o<=0&&a<=0?this.drawRect(0,0,n,i):(this.moveTo(0+s,0),0<h?this.arcTo(0+n,0,0+n,0+i,h):this.lineTo(0+n,0),0<a?this.arcTo(0+n,0+i,0,0+i,a):this.lineTo(0+n,0+i),0<o?this.arcTo(0,0+i,0,0,o):this.lineTo(0,0+i),0<s?this.arcTo(0,0,0+n,0,s):this.lineTo(0,0)),this.endFill()},n}(t.Graphics);!function(t){t[t.NONE=0]="NONE",t[t.CTRL=1]="CTRL",t[t.SHIFT=2]="SHIFT",t[t.ALT=4]="ALT",t[t.AND=8]="AND",t[t.OR=16]="OR",t[t.NOT_NONE=23]="NOT_NONE"}(ti||(ti={}));var bi,gi=function(){function t(){}return t.from=function(t){var n="data"in t?t.data.originalEvent:t;return(n.ctrlKey?ti.CTRL:ti.NONE)|(n.altKey?ti.ALT:ti.NONE)|(n.shiftKey?ti.SHIFT:ti.NONE)},t.match=function(n,i){return i&ti.OR?!!(t.from(n)&i):t.from(n)===i},t}();!function(t){t[t.OFF=0]="OFF",t[t.ON=1]="ON",t[t.TOUCH=2]="TOUCH"}(bi||(bi={}));var di,mi=function(){function t(){}return t.LINEAR=function(t){return t},t.ELASTIC=function(t){return t*(3*(1-t)*(1-t)+t*(3*(1-t)+t))},t.QUAD_IN_OUT=function(t){return t<.5?2*t*t:(4-2*t)*t-1},t}(),wi=function(t){function n(n){var i=t.call(this)||this;i.l=null,i.i=n&&null!=n.target?n.target:null,i.Rn=0,i.yn=null!=n&&null!=n.duration?n.duration:200,i.kn=1/Math.max(1,i.yn),i.xn=!1,i.Ln=null!=n?n.onTime:void 0,i.Bn=function(){i.onTimeBase()},i._n=null!=n?n.onStart:void 0,i.Pn=null!=n?n.onEnd:void 0,i.Fn=null!=n&&null!=n.timing?n.timing:mi.ELASTIC;var r=n&&n.on;if(r)for(var e in r){var u=r[e];u&&i.on(e,u)}return i}return y(n,t),Object.defineProperty(n.prototype,"target",{get:function(){return this.i},set:function(t){this.i=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.yn},set:function(t){this.yn=t,this.kn=1/Math.max(1,t)},enumerable:!1,configurable:!0}),n.prototype.start=function(t){void 0===t&&(t=!1),this.stop(),this.Rn=Date.now(),this.xn=t,this.l=window.setTimeout(this.Bn,0),this.onStart(t);var n=this.yn,i=this.toTime(t?n:0);this.onTime(i,t,0)},n.prototype.onStart=function(t){var n=this._n;null!=n&&n(t,this),this.emit("start",t,this)},n.prototype.onTime=function(t,n,i){var r=this.Ln;null!=r&&r(t,n,i,this),this.emit("time",t,n,i,this)},n.prototype.onEnd=function(t){var n=this.Pn;null!=n&&n(t,this),this.emit("end",t,this)},n.prototype.isStarted=function(){return null!=this.l},n.prototype.isReverse=function(){return this.xn},n.prototype.onTimeBase=function(){if(null!=this.l){this.l=null;var t=Date.now()-this.Rn,n=this.yn,i=this.xn;if(t<n){this.l=window.setTimeout(this.Bn,0);var r=this.toTime(i?n-t:t);this.onTime(r,i,t)}else r=this.toTime(i?0:n),this.onTime(r,i,t),this.onEnd(i)}},n.prototype.toTime=function(t){return this.Fn(t*this.kn,this)},n.prototype.stop=function(){var t=this.l;null!=t&&(this.l=null,window.clearTimeout(t))},n.prototype.end=function(){var t=this.l;if(null!=t){this.l=null,window.clearTimeout(t);var n=this.xn,i=Date.now()-this.Rn,r=this.yn,e=this.toTime(n?0:r);this.onTime(e,n,i),this.onEnd(n)}},n}(t.utils.EventEmitter),pi=function(){function t(t,n,i,r){this.dx=t,this.dy=n,this.ds=i,this.dt=r}return t.prototype.set=function(t,n,i,r){this.dx=t,this.dy=n,this.ds=i,this.dt=r},t}(),Oi=function(){function t(t,n){var i=this;this.Un=[],this.zn=[],this.Gn=0,this.Hn=-1,this.Vn=0,this.Wn=0,this.Xn=0,this.Yn=0,this.Kn=new wi({onTime:function(t){i.onEase(t)},timing:mi.LINEAR,duration:1e3});var r=n&&n.duration;r?F(r)?(this.Jn=r,this.Zn=r):(this.Jn=null!=r.position?r.position:1,this.Zn=null!=r.scale?r.scale:1):(this.Jn=1,this.Zn=1),this.qn=t}return t.prototype.onStart=function(){for(var n=this.Un,i=n.length,r=t.HISTORY_CAPACITY;i<r;++i)n.push(new pi(0,0,1,0));this.Gn=0,this.Hn=-1,this.Kn.stop()},t.prototype.onMove=function(n,i,r,e){var u=t.HISTORY_CAPACITY,s=this.Hn,h=(s+1)%u;this.Hn=h;var o=this.Gn;(h<s||0<=s&&s<o)&&(this.Gn=(o+1)%u),this.Un[h].set(n,i,r,e)},t.prototype.updateHistoriesSorted=function(t){var n=this.Un,i=this.zn,r=this.Gn,e=this.Hn,u=n.length;if(e<0)return i.length=0,t;if(e<r){var s=t;i.length=0;for(var h=e;0<=h;--h){var o=n[h];if(!(s+o.dt<160))return s;s+=o.dt,i.push(o)}for(h=u-1;r<=h;--h){var a=n[h];if(!(s+a.dt<160))return s;s+=a.dt,i.push(a)}return s}for(s=t,i.length=0,h=e;r<=h;--h){var c=n[h];if(!(s+c.dt<160))return s;s+=c.dt,i.push(c)}return s},t.prototype.onEnd=function(t){var n=this.updateHistoriesSorted(t),i=this.zn,r=i.length;if(0<r){for(var e=0,u=0,s=0,h=0,o=0;o<r;++o){var a=i[o];e+=a.dx,u+=a.dy,s+=a.ds,h+=a.dt}var c=(1-t/n)/r;e*=c,u*=c,s=1+(s-r)*c,h*=c,this.Vn=e,this.Wn=u,this.Xn=s,this.Yn=h;var f=40*this.Jn*Math.sqrt(e*e+u*u),l=1e4*this.Zn*Math.abs(s-1),v=this.Kn;v.duration=Math.max(f,l),v.start()}},t.prototype.onEase=function(t){var n=1-t;this.qn(this.Vn*n,this.Wn*n,1+(this.Xn-1)*n,t)},t.prototype.stop=function(){this.Kn.stop()},t.HISTORY_CAPACITY=5,t}(),Di=function(){function n(n){var i=this,r=this.i=n.target,e=n.on;e&&(this._n=e.start,this.qn=e.move,this.Pn=e.end),this.$n=n&&n.modifier||ti.NONE,this.Qn=function(t){var n=t&&t.checker,i=gi.match;return n?{start:n.start||i,move:n.move||i}:{start:i,move:i}}(n),this.ti=null,this.ni=new t.Point,this.fn=1,this.ii=new t.Point,this.wt=0;var u=n.easing;null!=u&&!1===u||(this.ri=new Oi((function(t,n,r,e){i.onEasingMove(t,n,r,e)}),function(t){return null==t||!0===t?void 0:t}(u))),this.ei=function(t){i.onDown(t)},this.si=function(t){i.onMove(t)},this.hi=function(t){i.onEnd(t)},n.touch?(this.oi="touchstart",this.ai="touchmove",this.ci="touchend"):(this.oi=ai.down,this.ai=ai.move,this.ci=ai.up),!1!==n.bind&&r.on(this.oi,this.ei)}return n.prototype.calcCenterAndScale=function(t,n,i){var r=t.data.originalEvent,e=t.data.global;if("touches"in r){var u=r.touches,s=u.length;if(0<s){for(var h=u[0],o=h.clientX,a=h.clientY,c=1,f=u.length;c<f;++c)o+=(v=u[c]).clientX,a+=v.clientY;if(o/=s,a/=s,i.mapPositionToPoint(n,o,a),1<s){var l=0;for(c=1,f=u.length;c<f;++c){var v,b=(v=u[c]).clientX-o,g=v.clientY-a;l=Math.max(l,b*b+g*g)}return Math.sqrt(l)}return 0}}return n.copyFrom(e),0},n.prototype.onDown=function(t){var n=this.i;if(this.Qn.start(t,this.$n,n)){var i=B.getLayer(n);if(i)if(t.stopPropagation(),n.state.isDragging){if(e=this.ti){var r=this.ni;this.fn=this.calcCenterAndScale(t,r,e)}}else{n.state.isDragging=!0;var e=i.renderer.plugins.interaction;this.ti=e,r=this.ni,this.fn=this.calcCenterAndScale(t,r,e),this.wt=t.data.originalEvent.timeStamp;var u=this.ri;u&&u.onStart();var s=this._n;null!=s&&s(),e.on(this.ai,this.si),e.on(this.ci,this.hi)}}},n.prototype.onMove=function(t){var i=this.i;if(i.state.isDragging&&this.Qn.move(t,this.$n,i)){var r=this.ti;if(r){var e=this.ni,u=e.x,s=e.y,h=this.calcCenterAndScale(t,e,r),o=this.fn;this.fn=h;var a=this.wt,c=t.data.originalEvent.timeStamp;this.wt=c;var f=e.x-u,l=e.y-s,v=c-a,b=n.EPSILON<o?h/o:1,g=this.ri;g&&g.onMove(f,l,b,v);var d=this.qn;null!=d&&(0===f&&0===l&&1===b||d(f,l,e.x,e.y,b))}}},n.prototype.onEnd=function(t){var n=this.i;if(n.state.isDragging){var i=this.ti;if(i){var r=this.ni;this.ii.copyFrom(r),this.fn=this.calcCenterAndScale(t,r,i);var e=t.data.originalEvent;if(!("touches"in e)||e.touches.length<=0){n.state.isDragging=!1,this.ti=null,i.off(this.ai,this.si),i.off(this.ci,this.hi);var u=this.Pn;null!=u&&u();var s=this.ri;s&&s.onEnd(t.data.originalEvent.timeStamp-this.wt)}}}},n.prototype.onEasingMove=function(t,n,i,r){var e=this.qn;if(null!=e&&(0!==t||0!==n||1!==i)){var u=this.ii;u.set(u.x+t,u.y+n),e(t,n,u.x,u.y,i)}},n.prototype.stop=function(){var t=this.ri;t&&t.stop()},n.EPSILON=1e-5,n}(),Ei=function(){function t(t,n,i,r,e){var u=this;this.o=t,this.fi=n,this.li=i;var s=e&&null!=e.mode?mt(e.mode)?bi[e.mode]:e.mode:r.getDragMode(),h=e&&null!=e.modifier?mt(e.modifier)?ti[e.modifier]:e.modifier:r.getDragModifier(),o=e&&null!=e.duration?e.duration:{position:r.getDragDurationPosition(),scale:r.getDragDurationScale()},a=s===bi.TOUCH;this.vi=a,s!==bi.ON&&s!==bi.TOUCH||(this.bi=new Di({target:t,touch:a,modifier:h,checker:e&&e.checker,easing:{duration:o},bind:a,on:{start:function(){u.li.stop()},move:function(r,e,u,s,h){var o=n(t);if(null!=o){var a=o.scale.y,c=i.toNormalizedScale(a*h),f=c/a,l=u-r,v=s-e,b=o.position,g=(b.x-l)*f+u,d=(b.y-v)*f+s;o.scale.set(c,c),o.position.set(g,d)}}}}))}return t.prototype.stop=function(){var t=this.bi;null!=t&&t.stop()},t.prototype.onDown=function(t){if(!this.vi){var n=this.bi;n&&n.onDown(t)}},t}(),Mi=function(){function t(t,n,i,r){var e=this;this.o=t,this.fi=n,this.gi=1,this.di=1,this.wi=0,this.pi=0,this.Oi=1,this.Di=1,this.Ei=0,this.Mi=0,this.Kn=new wi({onTime:function(t){e.onTime(t)},duration:r}),this.li=i,this.yn=r}return t.prototype.onTime=function(t){var n=1-t,i=t,r=this.Oi*n+this.gi*i,e=this.Di*n+this.di*i,u=this.Ei*n+this.wi*i,s=this.Mi*n+this.pi*i,h=this.fi(this.o);null!=h&&(h.scale.set(r,e),h.position.set(u,s))},t.prototype.start=function(t,n,i,r,e,u,s){if(!1!==s&&this.li.stop(),null==u&&(u=this.yn),u<=0)t.scale.set(r,e),t.position.set(n,i);else{var h=t.position,o=t.scale;this.Ei=h.x,this.Mi=h.y,this.Oi=o.x,this.Di=o.y,this.wi=n,this.pi=i,this.gi=r,this.di=e,this.Kn.duration=u,this.Kn.start()}},t.prototype.stop=function(){this.Kn.stop()},t}(),Si=function(){function n(n,i,r){this.o=n,this.fi=i,this.Si=new t.Rectangle;var e=this.toTheme(r)||this.getThemeDefault(),u=r&&r.zoom;this.Ti=new t.Point,this.ji=u&&null!=u.min?u.min:e.getZoomMin(),this.Ni=u&&null!=u.max?u.max:e.getZoomMax(),this.Ii=u&&null!=u.keepRatio?u.keepRatio:e.getZoomKeepRatio();var s=u&&u.wheel;this.Ci=s&&null!=s.enable?s.enable:e.isWheelZoomEnabled(),this.Ai=s&&null!=s.speed?s.speed:e.getWheelZoomSpeed(),this.Ri=s&&null!=s.modifier?mt(s.modifier)?ti[s.modifier]:s.modifier:e.getWheelZoomModifier(),this.yi=s&&s.checker||gi.match;var h=u&&u.dblclick;this.ki=h&&null!=h.enable?h.enable:e.isDblClickZoomEnabled(),this.xi=h&&null!=h.amount?h.amount:e.getDblClickZoomSpeed(),this.Li=h&&null!=h.modifier?mt(h.modifier)?ti[h.modifier]:h.modifier:e.getDblClickZoomModifier(),this.Bi=h&&h.checker||gi.match,this._i=h&&null!=h.duration?h.duration:e.getDblClickZoomDuration();var o=r&&r.translation&&r.translation.wheel;this.Pi=o&&null!=o.enable?o.enable:e.isWheelTranslationEnabled(),this.Fi=o&&null!=o.speed?o.speed:e.getWheelTranslationSpeed(),this.Ui=o&&null!=o.modifier?mt(o.modifier)?ti[o.modifier]:o.modifier:e.getWheelTranslationModifier(),this.zi=o&&o.checker||gi.match,this.Gi=new Ei(n,i,this,e,r&&r.drag),this.Hi=new Mi(n,i,this,this._i)}return Object.defineProperty(n.prototype,"drag",{get:function(){return this.Gi},enumerable:!1,configurable:!0}),n.prototype.stop=function(){this.Gi.stop(),this.Hi.stop()},n.prototype.reset=function(t,n){var i=this.o,r=this.fi(i);if(r){var e=r.getLocalBounds(this.Si),u=.5*(i.width-e.width)-e.x,s=.5*(i.height-e.height)-e.y;this.Hi.start(r,u,s,1,1,t,n)}},n.prototype.fit=function(t,n){var i=this.o,r=this.fi(i);if(r){var e=i.padding,u=i.width,s=i.height,h=r.getLocalBounds(this.Si),o=h.x,a=h.y,c=h.width,f=h.height,l=(u-e.getLeft()-e.getRight())/c,v=(s-e.getTop()-e.getBottom())/f;if(this.Ii){var b=this.toNormalizedScale(Math.min(l,v));l=b,v=b}else l=this.toNormalizedScale(l),v=this.toNormalizedScale(v);var g=.5*(u-c*l)-o*l,d=.5*(s-f*v)-a*v;this.Hi.start(r,g,d,l,v,t,n)}},n.prototype.zoomIn=function(t,n){var i=this.fi(this.o);if(i){var r=this.xi,e=i.scale;this.zoom(e.x*r,e.y*r,t,n)}},n.prototype.zoomOut=function(t,n){var i=this.fi(this.o);if(i){var r=1/this.xi,e=i.scale;this.zoom(e.x*r,e.y*r,t,n)}},n.prototype.zoomAt=function(t,n,i,r,e,u){var s=this.fi(this.o);if(s){var h=s.scale.x,o=s.scale.y,a=this.toNormalizedScale(i),c=this.toNormalizedScale(r),f=a/h,l=c/o,v=(s.position.x-t)*f+t,b=(s.position.y-n)*l+n;this.Hi.start(s,v,b,a,c,e,u)}},n.prototype.zoomAtGlobal=function(t,n,i,r,e,u){var s=this.Ti;s.set(t,n),this.toLocal(s,s),this.zoomAt(s.x,s.y,i,r,e,u)},n.prototype.zoom=function(t,n,i,r){var e=this.o;this.zoomAt(.5*e.width,.5*e.height,t,n,i,r)},Object.defineProperty(n.prototype,"scale",{get:function(){var n=this.fi(this.o);return n?n.scale:new t.Point(1,1)},set:function(t){var n=this.fi(this.o);if(n){var i=this.toNormalizedScale(t.x),r=this.toNormalizedScale(t.y);n.scale.set(i,r)}},enumerable:!1,configurable:!0}),n.prototype.moveTo=function(t,n,i,r){var e=this.fi(this.o);if(e){var u=e.scale;this.Hi.start(e,t,n,u.x,u.y,i,r)}},Object.defineProperty(n.prototype,"position",{get:function(){var n=this.fi(this.o);return n?n.position:new t.Point(0,0)},set:function(t){var n=this.fi(this.o);n&&n.position.set(t.x,t.y)},enumerable:!1,configurable:!0}),n.prototype.transform=function(t,n,i,r,e,u){var s=this.fi(this.o);s&&this.Hi.start(s,t,n,i,r,e,u)},n.prototype.toLocal=function(t,n,i){return this.o.toLocal(t,void 0,n,i)},n.prototype.toGlobal=function(t,n,i){return this.o.toGlobal(t,n,i)},n.prototype.toNormalizedScale=function(t){return Math.min(this.Ni,Math.max(this.ji,t))},n.prototype.onWheel=function(t,n,i){var r;if(this.Ci&&this.yi(t,this.Ri,this.o)&&0!==n.deltaY&&(r=this.fi(this.o))){var e=n.lowest*this.Ai,u=1+n.deltaY*e,s=r.scale;return this.zoomAtGlobal(i.x,i.y,s.x*u,s.y*u,0),!0}return!!(this.Pi&&this.zi(t,this.Ui,this.o)&&(r=this.fi(this.o)))&&(this.stop(),e=n.lowest*this.Fi,r.position.set(r.position.x-n.deltaX*e,r.position.y+n.deltaY*e),!0)},n.prototype.onDown=function(t){this.Gi.onDown(t)},n.prototype.onDblClick=function(t,n){if(this.ki&&this.Bi(t,this.Li,this.o)){var i=this.fi(this.o);if(i){var r=this.Ti;ai.toGlobal(t,n,r);var e=this.xi,u=i.scale;return this.zoomAtGlobal(r.x,r.y,u.x*e,u.y*e,this._i),!0}}return!1},n.prototype.toTheme=function(t){if(t&&t.theme){var n=t.theme;return mt(n)?Z.getInstance().get(n):n}return null},n.prototype.getThemeDefault=function(){return Z.getInstance().get(this.getType())},n.prototype.getType=function(){return"DView"},n}(),Ti=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Vi=null;var r=this.theme;this.Wi=new Si(this,(function(){return i.Vi}),n&&n.view);var e=n&&n.canvas?n.canvas:null;e instanceof li?(this.Xi=null,this.canvas=e):this.Xi=e,this.Yi=null,(n&&null!=n.mask?n.mask:r.isOverflowMaskEnabled())&&(this.mask=this.getOrCreateOverflowMask())},n.prototype.getType=function(){return"DCanvasContainer"},n.prototype.onResize=function(n,i,r,e){t.prototype.onResize.call(this,n,i,r,e),this.updateContentSize(n,i,r,e)},Object.defineProperty(n.prototype,"canvas",{get:function(){return this.Vi},set:function(t){var n=this.Vi;null!=n&&(this.Vi=null,this.removeChild(n),this.emit("unset",n,this),n.destroy()),this.Vi=t,null!=t?(this.addChild(t),this.Wi.reset(0),this.emit("set",t,this)):B.update(this)},enumerable:!1,configurable:!0}),n.prototype.getOrCreateOverflowMask=function(){return null==this.Yi&&(this.Yi=new vi(this),this.addReflowable(this.Yi),this.toDirty()),this.Yi},n.prototype.updateContentSize=function(t,n,i,r){var e=this.Vi;if(null!=e){var u=e.x+.5*(t-i),s=e.y+.5*(n-r);e.position.set(u,s)}},Object.defineProperty(n.prototype,"view",{get:function(){return this.Wi},enumerable:!1,configurable:!0}),n.prototype.onWheel=function(n,i,r){var e=this.Wi.onWheel(n,i,r),u=t.prototype.onWheel.call(this,n,i,r);return e||u},n.prototype.onDblClick=function(n,i){var r=this.Wi.onDblClick(n,i),e=t.prototype.onDblClick.call(this,n,i);return r||e},n.prototype.onDown=function(n){this.Wi.onDown(n),t.prototype.onDown.call(this,n)},n.prototype.destroy=function(){var n=this.Yi;null!=n&&(this.Yi=null,n.destroy()),this.mask=null,t.prototype.destroy.call(this)},n}(li),ji=function(){function t(){}return t.toContainer=function(t){for(var n=t;null!=n;){if(n instanceof Ti)return n;n=n.parent}return null},t.open=function(t,n){var i=this.toContainer(t);i&&i.openByName(n)},t.write=function(t,n,i,r,e){var u=this.toContainer(t);u&&(e?u.tag.remote.set(n,i,r):u.tag.set(n,i,r))},t.emit=function(n,i,r,e){var u=t.toContainer(n);void 0===e?(n.emit(i,n),u&&u.shape.emit(i,n)):(n.emit(i,r,e,n),u&&u.shape.emit(i,r,e,n))},t}(),Ni=function(t){function n(n){var i=t.call(this,n,tt.NONE)||this;return i.name=Mt.ofStringOrNull(n.name),i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.name(t,i);null!=r&&ji.emit(t,r)}},n}(Tt),Ii=function(t){function n(n,i){var r=t.call(this,kt.EMIT_EVENT,n)||this;return r.name=i,r}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.name===i.name},n.prototype.toRuntime=function(){return new Ni(this)},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.name);return t.addResource("["+this.type+","+n+","+i+"]")},n.deserialize=function(t,i){return new n(_t.toResource(1,t,i.resources),_t.toResource(2,t,i.resources))},n}(xt),Ci=function(t){function n(n){var i=t.call(this,n,tt.NONE)||this;return i.target=Mt.ofStringOrNull(n.target),i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);null!=r&&ji.emit(t,r)}},n}(Tt);!function(t){t[t.EMIT_EVENT=0]="EMIT_EVENT",t[t.WRITE_BOTH=1]="WRITE_BOTH",t[t.WRITE_LOCAL=2]="WRITE_LOCAL",t[t.WRITE_REMOTE=3]="WRITE_REMOTE"}(di||(di={}));var Ai,Ri=function(){function t(){}return t.execute=function(t,n,i,r,e){switch(n){case di.EMIT_EVENT:t.emit(i,t,r),ji.emit(t,i,r,e);break;case di.WRITE_LOCAL:ji.write(t,i,r,e,!1);break;case di.WRITE_REMOTE:ji.write(t,i,r,e,!0);break;case di.WRITE_BOTH:ji.write(t,i,r,e,!1),ji.write(t,i,r,e,!0)}},t}(),yi=function(t){function n(n){var i=t.call(this)||this;return i.target=Mt.ofStringOrNull(n.target),i.onInputAction=n.onInputAction,i}return y(n,t),n.prototype.execute=function(t,n,i){var r=this;if(!t.state.inDisabled){var e=this.getData();t.state.isFocused?e.isShown(t)||setTimeout((function(){e.show(t,r.toValue(t.text.value),(function(n,i){t.text.value=i;var e=Date.now(),u=r.target(t,e);null!=u&&Ri.execute(t,r.onInputAction,u,r.fromValue(i),e)}))}),0):e.isShown(t)&&(e.onInputChange(),e.hide())}},n}(St),ki=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",xi=function(t,n){this.x=t,this.y=n},Li=function(t,n,i,r){this.ref=1,this.life=10,this.x=0,this.y=0,this.width=n,this.height=i,this.advance=t,this.origin=new xi(0,0),this.reserved=r},Bi=function(){function t(){var t=this;this.Ki=null,this.Gt=null,this.Ji=null,this.Zi=NaN,this.qi=NaN,this.$i=NaN,this.Qi=NaN,this.tr=null,this.nr=null;var n=this.Vi=document.createElement("canvas");n.width=64,n.height=64,this.ir=function(t){t.preventDefault()},this.rr=function(){t.restore()},this.er=function(){t.destroy()},n.addEventListener("webglcontextlost",this.ir,!1),n.addEventListener("webglcontextrestored",this.rr,!1),window.addEventListener("unload",this.er,!1)}return t.prototype.init=function(){var t=this.Vi;if(null!=t&&(null==this.Ki||this.Ki.isContextLost())){var n={alpha:!0,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1},i=this.Ki=t.getContext("webgl",n)||t.getContext("experimental-webgl",n);null!=i&&(i.clearColor(1,1,1,0),this.makeVertexBuffer(),this.makeUvBuffer(),this.makeShaders(),this.Gt=null)}return this},t.prototype.restore=function(){this.init()},t.prototype.getCanvas=function(){return this.Vi},t.prototype.getShader=function(t,n,i){var r=i?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);return null==r||(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))?r:(console&&console.error("Failed to compile the shader: "+t.getShaderInfoLog(r)),null)},t.prototype.makeShaders=function(){var t=this.Ki;if(null!=t&&!0!==t.isContextLost()){var n=this.getShader(t,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nvarying mediump vec2 vTextureCoord;\nvoid main(void) {\n\tgl_Position = vec4(aVertexPosition, 0.0, 1.0);\n\tvTextureCoord = aTextureCoord;\n}\n",!1);if(null!=n){var i=this.getShader(t,"\nprecision mediump float;\n\nvarying mediump vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uSize;\n\nfloat calcDistance( float x, float y, float dx, float dy ) {\n\tfloat xd = x + dx;\n\tfloat yd = y + dy;\n\tfloat u = xd / uSize.x;\n\tfloat v = yd / uSize.y;\n\tfloat ul = (xd - 1.0) / uSize.x;\n\tfloat vt = (yd - 1.0) / uSize.y;\n\n\tfloat m = texture2D(uSampler, vec2(u , v )).a;\n\tfloat l = texture2D(uSampler, vec2(ul, v )).a;\n\tfloat t = texture2D(uSampler, vec2(u , vt)).a;\n\n\tfloat xl = mix( xd - 1.0, xd, (0.5 - l) / (m - l) );\n\tfloat yt = mix( yd - 1.0, yd, (0.5 - t) / (m - t) );\n\n\tbool bl = ( min(l, m) < 0.5 && 0.5 <= max(l, m) );\n\tbool bt = ( min(t, m) < 0.5 && 0.5 <= max(t, m) );\n\n\tfloat ll = (bl ? length( vec2( xl - x, yd - y ) ) : 100.0);\n\tfloat lt = (bt ? length( vec2( xd - x, yt - y ) ) : 100.0);\n\n\treturn min( ll, lt );\n}\n\nfloat calcDistancesY( float x, float y, float dx ) {\n\tfloat d = 100.0;\n\tfor( float dy=-6.0; dy<6.5; dy++ ) {\n\t\td = min( d, calcDistance( x, y, dx, dy ) );\n\t}\n\treturn d;\n}\n\nfloat calcDistances( float x, float y ) {\n\tfloat d = 100.0;\n\tfor( float dx=-6.0; dx<6.5; dx++ ) {\n\t\td = min( d, calcDistancesY( x, y, dx ) );\n\t}\n\treturn d;\n}\n\nvoid main(void) {\n\tfloat t = texture2D(uSampler, vTextureCoord).a;\n\tfloat x = vTextureCoord.x * uSize.x;\n\tfloat y = vTextureCoord.y * uSize.y;\n\tfloat d = min( 6.0, calcDistances( x, y ) ) / 12.0;\n\td = clamp( mix( 0.5 - d, 0.5 + d, step( 0.5, t ) ), 0.0, 1.0 );\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, d);\n}\n",!0);if(null!=i){var r=this.Ji=t.createProgram();if(null!=r)return t.attachShader(r,n),t.attachShader(r,i),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)?(t.deleteShader(n),t.deleteShader(i),t.useProgram(r),this.Zi=t.getAttribLocation(r,"aVertexPosition"),this.qi=t.getAttribLocation(r,"aTextureCoord"),this.$i=t.getUniformLocation(r,"uSampler"),this.Qi=t.getUniformLocation(r,"uSize"),t.useProgram(null),r):(console&&console.error("Failed to link the program: "+t.getError()),t.deleteShader(n),t.deleteShader(i),null);t.deleteShader(n),t.deleteShader(i)}else t.deleteShader(n)}}return null},t.prototype.destroyShaders=function(){var t=this.Ki;if(null!=t&&!0!==t.isContextLost()){var n=this.Ji;null!=n&&(this.Ji=null,t.useProgram(null),t.deleteProgram(n))}},t.prototype.updateTexture=function(t){var n=this.Ki,i=this.Vi;if(null!=n&&!0!==n.isContextLost()&&null!=i){var r=t.width,e=t.height;i.width===r&&i.height===e||(i.width=r,i.height=e,n.viewport(0,0,r,e));var u=this.Gt;return null==u?(u=this.Gt=n.createTexture(),n.bindTexture(n.TEXTURE_2D,u),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.bindTexture(n.TEXTURE_2D,null)):(n.bindTexture(n.TEXTURE_2D,u),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),n.bindTexture(n.TEXTURE_2D,null)),u}return null},t.prototype.destroyTexture=function(){var t=this.Ki,n=this.Gt;null!=t&&!0!==t.isContextLost()&&null!=n&&(this.Gt=null,t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(n))},t.prototype.makeVertexBuffer=function(){var t=this.Ki;if(null!=t&&!0!==t.isContextLost()){var n=this.tr=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,1,1,1,-1,-1,1,-1]),t.STATIC_DRAW),n}return null},t.prototype.destroyVertexBuffer=function(){var t=this.Ki,n=this.tr;null!=t&&!0!==t.isContextLost()&&null!=n&&(this.tr=null,t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(n))},t.prototype.makeUvBuffer=function(){var t=this.Ki;if(null!=t&&!0!==t.isContextLost()){var n=this.nr=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW),n}return null},t.prototype.destroyUvBuffer=function(){var t=this.Ki,n=this.nr;null!=t&&!0!==t.isContextLost()&&null!=n&&(this.nr=null,t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(n))},t.prototype.render=function(){var t=this.Ki,n=this.Vi,i=this.Ji,r=this.tr,e=this.nr,u=this.Gt;if(null!=t&&!0!==t.isContextLost()&&null!=n&&null!=i&&null!=r&&null!=e&&null!=u){t.clear(t.COLOR_BUFFER_BIT),t.useProgram(i),t.bindBuffer(t.ARRAY_BUFFER,r);var s=this.Zi;t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e);var h=this.qi;t.enableVertexAttribArray(h),t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,u),t.uniform1i(this.$i,0),t.uniform2f(this.Qi,n.width,n.height),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.bindTexture(t.TEXTURE_2D,null),t.bindBuffer(t.ARRAY_BUFFER,null),t.useProgram(null)}},t.prototype.read=function(t){var n=this.Ki,i=this.Vi;if(null!=n&&!0!==n.isContextLost()&&null!=i){var r=i.width,e=i.height;t.width=r,t.height=e;var u=t.getContext("2d");null!=u&&u.drawImage(i,0,0)}},t.prototype.destroy=function(){this.destroyVertexBuffer(),this.destroyUvBuffer(),this.destroyShaders();var t=this.Vi;null!=t&&(this.Vi=null,t.removeEventListener("webglcontextlost",this.ir,!1),t.removeEventListener("webglcontextrestored",this.rr,!1),window.removeEventListener("unload",this.er,!1));var n=this.Ki;if(null!=n){this.Ki=null;var i=n.getExtension("WEBGL_lose_context");null!=i&&i.loseContext()}},t.getInstance=function(){return null==t.ur&&(t.ur=new t),t.ur},t.ur=null,t}(),_i=function(){function t(n){this.l="font-atlas:"+n,this.sr=Bi.getInstance().init(),this.Vi=document.createElement("canvas"),this.hr={family:t.toFontFamily(n),size:32,italic:!1},this.ar={},this.cr=0,this.ot=1,this.zt=1,this.Wt=!0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.hr},set:function(t){this.hr.family=t.family,this.hr.size=t.size,this.hr.italic=t.italic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.ot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.zt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this.Vi},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"generator",{get:function(){return this.sr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"characters",{get:function(){return this.ar},enumerable:!1,configurable:!0}),t.prototype.begin=function(){this.cr=0;var t=this.ar;for(var n in t)t[n].ref=0},t.prototype.end=function(){var t=this.ar;for(var n in t){var i=t[n];i.ref<=0&&(i.life-=1,i.life<=0&&(delete t[n],this.Wt=!0))}},t.prototype.addAscii=function(){this.add(ki),this.addChar("...")},t.prototype.addChar=function(t){var n=this.ar;if("\n"!==t){var i=n[t];null!=i?(i.ref<=0&&(this.cr+=1),i.ref+=1):(n[t]=new Li(0,1,1,!1),this.cr+=1,this.Wt=!0)}},t.prototype.add=function(t){for(var n=v.from(t);n.hasNext();)this.addChar(n.next())},t.prototype.get=function(t){return this.ar[t]},t.prototype.update=function(){if(this.Wt){var n=this.Vi,i=this.sr;if(null!=n&&null!=i){var r=n.getContext("2d");if(null!=r){this.Wt=!1;var e=this.hr,u=this.ar,s=e.size+14,h=t.toPowerOf2(Math.ceil(Math.sqrt(this.cr))*s);this.ot=h;var o=(e.italic?"italic ":"")+e.size+"px "+e.family;r.font=o,r.textAlign="left",r.textBaseline="middle",r.lineWidth=0,r.lineCap="round",r.lineJoin="miter",r.miterLimit=0,r.fillStyle="#FFFFFF";var a=s>>1,c=0,f=0;for(var l in u){var v=u[l],b=r.measureText(l).width,g=Math.ceil(7+b+7),d=s;h<=c+g&&(c=0,f+=s),v.x=c,v.y=f,v.width=g,v.height=d,v.advance=b,v.origin.x=c+7,v.origin.y=f+a,c+=g}var m=this.zt=f+s;for(var l in n.width=h,n.height=m,r.font=o,r.textAlign="left",r.textBaseline="middle",r.lineWidth=0,r.lineCap="round",r.lineJoin="miter",r.miterLimit=4,r.fillStyle="#FFFFFF",r.clearRect(0,0,h,m),u)v=u[l],r.fillText(l,v.origin.x,v.origin.y);return i.updateTexture(n),i.render(),i.read(n),!0}}}return!1},Object.defineProperty(t.prototype,"length",{get:function(){return this.cr},enumerable:!1,configurable:!0}),t.prototype.toJson=function(){return{width:this.ot,height:this.zt,font:this.hr,characters:this.ar}},t.prototype.toString=function(){return JSON.stringify(this.toJson())},t.prototype.destroy=function(){null!=this.sr&&(this.sr=null),null!=this.Vi&&(this.Vi=null);var t=this.ar;for(var n in t)delete t[n]},t.toFontFamily=function(n){return"auto"===n?t.getAutoFontFamily():n},t.toPowerOf2=function(t){for(var n=32;n<t;)n<<=1;return n},t.getAutoFontFamily=function(){return null==t.FONT_FAMILY_AUTO&&(t.FONT_FAMILY_AUTO=Z.getInstance().get("DBase").getFontFamilly()),t.FONT_FAMILY_AUTO},t.FONT_FAMILY_AUTO=null,t}(),Pi=function(){function n(){var n=this;this.input=null,this.shape=null,this.value="",this.point=new t.Point,this.rect=new t.Rectangle,this.lr=function(t){n.onInputKeyDown(t)},this.vr=function(t){n.onInputBlur(t)},this.br=function(){n.updateInput()},this.gr=function(){n.onInputChange()},this.dr=function(t){n.onInputInput(t)},this.mr=null}return n.prototype.getInput=function(t){return null==this.input&&t.application.getRootElement().appendChild(this.input=this.createInput()),this.input},n.prototype.createInput=function(){var t=document.createElement("input");return t.setAttribute("spellcheck","false"),t},n.prototype.initInput=function(t,n,i){n.type=this.getInputType(),n.value=i,n.addEventListener("keydown",this.lr),n.addEventListener("blur",this.vr),n.addEventListener("change",this.gr),n.addEventListener("input",this.dr),n.setAttribute("style",this.getInputStyle(t)),t.state.inReadOnly?n.setAttribute("readonly","readonly"):n.removeAttribute("readonly"),t.state.inDisabled?n.setAttribute("disabled","disabled"):n.removeAttribute("disabled")},n.prototype.getInputStyleBackground=function(){return"background-color: transparent;"},n.prototype.getInputStyleBorder=function(){return"border: none; box-sizing: border-box;"},n.prototype.getInputStylePadding=function(t,n){var i=t.text.padding.horizontal*n;return"padding: 0px "+i+"px 0px "+i+"px;"},n.prototype.getInputStyleOutline=function(){return"outline: none;"},n.prototype.getInputStylePosition=function(t,n){return"position: absolute;left: "+t.x+"px;top: "+t.y+"px;width: "+t.width+"px;height: "+t.height+"px;line-height: "+t.height+"px;transform: matrix("+n.a+","+n.b+","+n.c+","+n.d+","+n.tx+","+n.ty+");"},n.prototype.getInputStyleText=function(t,n,i){var r=t.text;return"font-family: "+_i.toFontFamily(r.family)+";font-size: "+r.size*i+"px;font-weight: "+(r.weight===u.NORMAL?"normal":"bold")+";color: #"+r.color.toString(16)+";"},n.prototype.getInputStyleMargin=function(t,n,i){return"margin: 0;"},n.prototype.getInputStyle=function(t){var n=t.transform.pivot,i=t.size,r=i.x,e=i.y,u=this.rect;u.x=-.5*r+n.x,u.y=-.5*e+n.y,u.width=r,u.height=e,t.updateTransform();var s=t.transform.worldTransform;return this.getInputStylePosition(u,s)+this.getInputStyleMargin(t,u,1)+this.getInputStyleText(t,u,1)+this.getInputStyleBackground()+this.getInputStyleBorder()+this.getInputStylePadding(t,1)+this.getInputStyleOutline()},n.prototype.onInputKeyDown=function(t){if(pt.isFocusKey(t)){var n=this.shape;if(null!=n){this.onInputChange(),this.hide();var i=B.getLayer(n);if(i){var r=i.getFocusController(),e=pt.getFocusDirection(t),u=r.find(n,!1,!1,e);null!=u&&(i.view.focus(),t.preventDefault(),r.focus(u))}}}else pt.isOkKey(t)&&(this.onInputChange(),this.hide())},n.prototype.onInputBlur=function(t){this.onInputChange(),this.hide()},n.prototype.onInputInput=function(t){if(t.target instanceof HTMLInputElement){var n=this.shape,i=this.onInput;null!=n&&null!=i&&i(n,t.target.value)}},n.prototype.updateInput=function(){var t=this.shape;if(null!=t)if(t.visible){var n=this.input;null!=n&&n.setAttribute("style",this.getInputStyle(t))}else this.hide()},n.prototype.isShown=function(t){return this.shape===t},n.prototype.show=function(t,n,i,r){var e=this.shape;if(null!=e&&e!==t&&this.hide(),null==this.shape){this.shape=t,this.value=n,this.onChange=i,this.onInput=r;var u=t.text;null!=u&&(u.enable=!1);var s=B.getLayer(t);if(s){var h=this.getInput(s);if(h){this.initInput(t,h,n);var o=this.br,a=this.mr;null!=a&&a.off("postrender",o),this.mr=s.renderer,s.renderer.on("postrender",o),h.style.display="",h.focus(),h.select()}s.update()}}},n.prototype.hide=function(){var t=this.shape;if(null!=t){this.shape=null,this.value="";var n=t.text;null!=n&&(n.enable=!0);var i=this.input;null!=i&&(i.removeEventListener("keydown",this.lr),i.removeEventListener("blur",this.vr),i.removeEventListener("change",this.gr),i.removeEventListener("input",this.dr),i.style.display="none");var r=this.mr;null!=r&&(this.mr=null,r.off("postrender",this.br)),B.update(t)}},n.prototype.onInputChange=function(){var t=this.shape,n=this.input,i=this.onChange;if(null!=t&&null!=n&&null!=i){var r=n.value;this.value!==r&&i(t,r)}},n}(),Fi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getInputType=function(){return"number"},n.prototype.initInput=function(n,i,r){t.prototype.initInput.call(this,n,i,r),i.step="1"},n}(Pi),Ui=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getData=function(){return null==n.DATA&&(n.DATA=new Fi),n.DATA},n.prototype.fromValue=function(t){try{var n=parseInt(t,10);return n==n?n:0}catch(t){return 0}},n.prototype.toValue=function(t){return String(this.fromValue(t))},n}(yi),zi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getInputType=function(){return"number"},n.prototype.initInput=function(n,i,r){t.prototype.initInput.call(this,n,i,r),i.step="0.1"},n}(Pi),Gi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getData=function(){return null==n.DATA&&(n.DATA=new zi),n.DATA},n.prototype.fromValue=function(t){try{var n=parseFloat(t);return n==n?n:0}catch(t){return 0}},n.prototype.toValue=function(t){return String(this.fromValue(t))},n}(yi),Hi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getInputType=function(){return"text"},n}(Pi),Vi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getData=function(){return null==n.DATA&&(n.DATA=new Hi),n.DATA},n.prototype.fromValue=function(t){return t},n.prototype.toValue=function(t){return t},n}(yi),Wi=function(t){function n(n){var i=t.call(this,n,tt.NONE)||this;return i.target=Mt.ofStringOrNull(n.target),i.value=Mt.ofUnknown(n.value),i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);null!=r&&this.write(t,r,this.value(t,i),i)}},n}(Tt),Xi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.write=function(t,n,i,r){ji.write(t,n,i,r,!1),ji.write(t,n,i,r,!0)},n}(Wi),Yi=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.write=function(t,n,i,r){ji.write(t,n,i,r,!1)},n}(Wi),Ki=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.write=function(t,n,i,r){ji.write(t,n,i,r,!0)},n}(Wi);!function(t){t[t.INPUT_TEXT=0]="INPUT_TEXT",t[t.INPUT_INTEGER=1]="INPUT_INTEGER",t[t.INPUT_REAL=2]="INPUT_REAL",t[t.EMIT_EVENT=3]="EMIT_EVENT",t[t.WRITE_BOTH=4]="WRITE_BOTH",t[t.WRITE_LOCAL=5]="WRITE_LOCAL",t[t.WRITE_REMOTE=6]="WRITE_REMOTE"}(Ai||(Ai={}));var Ji,Zi,qi,$i=function(t){function n(n,i,r,e,u){var s=t.call(this,kt.MISC,i,n)||this;return s.target=r,s.onInputAction=e,s.value=u,s}return y(n,t),n.prototype.toRuntime=function(t){switch(this.subtype){case Ai.INPUT_TEXT:return new Vi(this);case Ai.INPUT_INTEGER:return new Ui(this);case Ai.INPUT_REAL:return new Gi(this);case Ai.EMIT_EVENT:return new Ci(this);case Ai.WRITE_BOTH:return new Xi(this);case Ai.WRITE_LOCAL:return new Yi(this);case Ai.WRITE_REMOTE:return new Ki(this)}},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.target),r=t.addResource(this.value);return t.addResource("["+this.type+","+n+","+this.subtype+","+i+","+this.onInputAction+","+r+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources),e=_t.toResource(3,t,i.resources),u=_t.toResource(5,t,i.resources);return new n(t[2],r,e,t[4],u)},n}(Lt);!function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(Ji||(Ji={})),function(t){t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM"}(Zi||(Zi={})),function(t){t[t.TEXT=0]="TEXT",t[t.PADDING=1]="PADDING",t[t.BORDER=2]="BORDER"}(qi||(qi={}));var Qi,tr=function(){function t(t,n,i){this.x=t,this.y=n,this.character=i}return t.prototype.set=function(t,n,i){this.x=t,this.y=n,this.character=i},t}(),nr=function(){function t(){this.count=0,this.width=0,this.height=0,this.characters=[],this.clipped=!1,this.x=0,this.y=0}return t.prototype.start=function(){this.count=0,this.width=0,this.height=0,this.clipped=!1,this.x=0,this.y=0},t.prototype.push=function(t){var n=this.x;this.x+=t.advance;var i=this.y,r=this.count,e=this.characters;r<e.length?e[r].set(n,i,t):e.push(new tr(n,i,t)),this.count+=1},t.prototype.newLine=function(t){this.width=Math.max(this.width,this.x),this.x=0,this.y+=t},t.prototype.pop=function(){if(0<this.x){var t=this.count,n=this.characters;if(0<t){var i=n[t-1];return this.x-=i.character.advance,this.count-=1,!0}}return!1},t.prototype.end=function(t){this.newLine(t),this.height=this.y},t}(),ir=function(){function t(){}return t.measure=function(n,i,r){var e=t.RESULT=t.RESULT||new nr;if(e.start(),null!=i){for(var u=v.from(n),s=i.font.height;u.hasNext();){var h=u.next();if("\n"===h)e.newLine(s);else{var o=i.get(h);if(null!=o)if(null!=r&&r<e.x+o.advance){e.clipped=!0;var a=i.get("...");if(null!=a){for(;r-a.advance<e.x&&e.pop(););e.x<=r-a.advance&&e.push(a)}for(;u.hasNext();)if("\n"===u.next()){e.newLine(s);break}}else e.push(o)}}e.end(s)}return e},t.RESULT=null,t}(),rr=function(t){function n(){var n=t.call(this,new Float32Array(64),new Float32Array(64),new Uint16Array(48))||this;return n.width=0,n.height=0,n.clipped=!1,n}return y(n,t),n.prototype.update=function(t,n,i){var r=this.getBuffer("aVertexPosition"),e=this.getBuffer("aTextureCoord"),u=this.getIndex(),s=ir.measure(t,n,i),h=Math.ceil(s.count/8)<<3,o=h<<3;r.data.length<o&&(r.data=new Float32Array(o),e.data=new Float32Array(o));var a=6*h;u.data.length<a&&(u.data=new Uint16Array(a));var c=r.data,f=e.data,l=u.data;if(null!=n){for(var v=s.count,b=s.characters,g=0;g<v;++g){var d=b[g];this.writeCharacter(c,f,l,g,d.x,d.y,d.character,n.width,n.height)}g=v;for(var m=c.length>>3;g<m;++g)this.writeCharacterEmpty(c,f,l,g);this.width=s.width,this.height=s.height,this.clipped=s.clipped}else{for(g=0,m=c.length>>3;g<m;++g)this.writeCharacterEmpty(c,f,l,g);this.width=0,this.height=0,this.clipped=!1}r.update(),e.update(),u.update()},n.prototype.writeCharacter=function(t,n,i,r,e,u,s,h,o){var a=s.x,c=s.y,f=s.width,l=s.height,v=e+(a-s.origin.x),b=u,g=v+f,d=b+l,m=r<<3;t[m+0]=v,t[m+1]=b,t[m+2]=g,t[m+3]=b,t[m+4]=g,t[m+5]=d,t[m+6]=v,t[m+7]=d;var w=a/h,p=c/o,O=(a+f)/h,D=(c+l)/o;n[m+0]=w,n[m+1]=p,n[m+2]=O,n[m+3]=p,n[m+4]=O,n[m+5]=D,n[m+6]=w,n[m+7]=D;var E=6*r,M=r<<2;i[E+0]=M+0,i[E+1]=M+1,i[E+2]=M+3,i[E+3]=M+1,i[E+4]=M+2,i[E+5]=M+3},n.prototype.writeCharacterEmpty=function(t,n,i,r){var e=r<<3;t[e+0]=0,t[e+1]=0,t[e+2]=0,t[e+3]=0,t[e+4]=0,t[e+5]=0,t[e+6]=0,t[e+7]=0,n[e+0]=0,n[e+1]=0,n[e+2]=0,n[e+3]=0,n[e+4]=0,n[e+5]=0,n[e+6]=0,n[e+7]=0;var u=6*r,s=r<<2;i[u+0]=s+0,i[u+1]=s+1,i[u+2]=s+3,i[u+3]=s+1,i[u+4]=s+2,i[u+5]=s+3},n}(t.MeshGeometry),er=function(){function t(t,n){var i,r,e,u,s,h,o,a;this.l=0,this.wr=-1;var c=this.getDefaultOptions();t?(this.at=null!==(i=t.align)&&void 0!==i?i:c.align,this.pr=null!==(r=t.fontFamily)&&void 0!==r?r:c.fontFamily,this.Or=null!==(e=t.fontSize)&&void 0!==e?e:c.fontSize,this.Dr=null!==(u=t.fontStyle)&&void 0!==u?u:c.fontStyle,this.Er=null!==(s=t.fontVariant)&&void 0!==s?s:c.fontVariant,this.Mr=null!==(h=t.fontWeight)&&void 0!==h?h:c.fontWeight,this.Sr=null!==(o=t.fill)&&void 0!==o?o:c.fill,this.It=null!==(a=t.clipping)&&void 0!==a?a:c.clipping):(this.at=c.align,this.pr=c.fontFamily,this.Or=c.fontSize,this.Dr=c.fontStyle,this.Er=c.fontVariant,this.Mr=c.fontWeight,this.Sr=c.fill,this.It=c.clipping),this.Tr=-1,this.jr="",this.Nr="",this.Ir=0,this.L=n}return t.prototype.getDefaultOptions=function(){var n=t.DEFAULT_OPTIONS;if(null==n){var i=Z.getInstance().get("DBase");n={align:"left",fontFamily:i.getFontFamilly(),fontSize:i.getFontSize(),fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",fill:i.getColor(new U),clipping:!0},t.DEFAULT_OPTIONS=n}return n},Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"idApproved",{get:function(){return this.wr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontId",{get:function(){return this.update(),this.jr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontIdApproved",{get:function(){return this.Nr},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this.Sr},set:function(t){this.Sr!==t&&(this.Sr=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.onChange=function(){this.l+=1,this.L()},Object.defineProperty(t.prototype,"fillApproved",{get:function(){return this.Ir},enumerable:!1,configurable:!0}),t.prototype.approve=function(){this.update(),this.wr=this.l,this.Nr=this.jr,this.Ir=this.Sr},Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this.pr},set:function(t){this.pr!==t&&(this.pr=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this.Or},set:function(t){this.Or!==t&&(this.Or=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this.Dr},set:function(t){this.Dr!==t&&(this.Dr=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this.Er},set:function(t){this.Er!==t&&(this.Er=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this.Mr},set:function(t){this.Mr!==t&&(this.Mr=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.update=function(){this.Tr!==this.l&&(this.Tr=this.l,this.jr=this.newFontId())},t.prototype.newFontId=function(){return this.Dr+" "+this.Er+" "+this.Mr+" "+this.Or+"px "+this.pr},Object.defineProperty(t.prototype,"clipping",{get:function(){return this.It},set:function(t){this.It!==t&&(this.It=t,this.onChange())},enumerable:!1,configurable:!0}),t}(),ur=function(n){function i(i,r){var e=n.call(this,new rr,new t.MeshMaterial(t.Texture.EMPTY))||this;return e.O=new er(r,(function(){e.Wt=!0,e.Cr=!0,e.Ar=null,e.Rr()})),e.yr=i,e.kr="",e.Wt=!0,e.Cr=!0,e.Ar=null,e.Lr=0,e.ot=0,e.zt=0,e.Br=0,e.Rr(),e}return y(i,n),i.prototype.Rr=function(){var t=B.getLayer(this);if(t){var n=this.O;if(this.Wt){this.Wt=!1;var i=this.yr,r=this.kr;this.kr=i;var e=n.fontId,u=n.fontIdApproved,s=n.fontSize,h=n.fill,o=n.fillApproved;n.approve();var a=t.getDynamicFontAtlases();i===r&&e===u&&h===o||(a.add(e,s,h,i),a.remove(u,o,r))}}},Object.defineProperty(i.prototype,"text",{get:function(){return this.yr},set:function(t){this.yr!==t&&(this.yr=t,this.Wt=!0,this.Cr=!0,this.Rr())},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"width",{get:function(){return this.update(),Math.abs(this.scale.x)*this.geometry.width},set:function(t){this.update();var n=this.geometry.width;if(1e-4<n){var i=t/n;this.scale.x=0<=this.scale.x?+i:-i}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.update(),Math.abs(this.scale.y)*this.geometry.height},set:function(t){this.update();var n=this.geometry.height;if(1e-4<n){var i=t/n;this.scale.y=0<=this.scale.y?+i:-i}},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"clipped",{get:function(){return this.geometry.clipped},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"style",{get:function(){return this.O},enumerable:!1,configurable:!0}),i.prototype.update=function(){this.Rr();var t=this.Ar;if(null==t){var n=B.getLayer(this);if(n){var i=this.O;null!=(t=n.getDynamicFontAtlases().get(i.fontId,i.fill))&&(this.Lr=t.getRevisionUpdate(),this.Ar=t,this.texture=t.texture,this.Cr=!0)}}else{var r=t.getRevisionUpdate();r!==this.Lr&&(this.Lr=r,this.Cr=!0)}var e=this._r,u=this.getClippingWidth();e!==u&&(this._r=u,this.Cr=!0),this.Cr&&(this.Cr=!1,this.geometry.update(this.yr,t,u))},i.prototype.getClippingWidth=function(){if(this.O.clipping){var t=this.parent;if(t instanceof li)return t.width-t.padding.getLeft()-t.padding.getRight()-this.Br}},i.prototype.setClippingWidthDelta=function(t){this.Br=t},i.prototype._calculateBounds=function(){this.update(),n.prototype._calculateBounds.call(this)},i.prototype._render=function(t){this.update(),n.prototype._render.call(this,t)},i}(t.Mesh),sr=function(){function t(t){this.yt=t}return t.prototype.getImageAlignHorizontal=function(){return this.yt.getSecondaryImageAlignHorizontal()},t.prototype.getImageAlignVertical=function(){return this.yt.getSecondaryImageAlignVertical()},t.prototype.getImageAlignWith=function(){return this.yt.getSecondaryImageAlignWith()},t.prototype.getImageMarginHorizontal=function(){return this.yt.getSecondaryImageMarginHorizontal()},t.prototype.getImageMarginVertial=function(){return this.yt.getSecondaryImageMarginVertial()},t.prototype.getImageTintColor=function(t){return this.yt.getSecondaryImageTintColor(t)},t.prototype.getImageTintAlpha=function(t){return this.yt.getSecondaryImageTintAlpha(t)},t.prototype.getImageSource=function(t){return this.yt.getSecondaryImageSource(t)},t}(),hr=function(){function t(t){this.yt=t}return t.prototype.getImageAlignHorizontal=function(){return this.yt.getTertiaryImageAlignHorizontal()},t.prototype.getImageAlignVertical=function(){return this.yt.getTertiaryImageAlignVertical()},t.prototype.getImageAlignWith=function(){return this.yt.getTertiaryImageAlignWith()},t.prototype.getImageMarginHorizontal=function(){return this.yt.getTertiaryImageMarginHorizontal()},t.prototype.getImageMarginVertial=function(){return this.yt.getTertiaryImageMarginVertial()},t.prototype.getImageTintColor=function(t){return this.yt.getTertiaryImageTintColor(t)},t.prototype.getImageTintAlpha=function(t){return this.yt.getTertiaryImageTintAlpha(t)},t.prototype.getImageSource=function(t){return this.yt.getTertiaryImageSource(t)},t}(),or=function(){function n(n,i,r,e,u,s){this.$=null,this.at=function(t,n){var i=n&&n.align;return i?{with:null!=i.with?mt(i.with)?qi[i.with]:i.with:t.getImageAlignWith(),vertical:null!=i.vertical?mt(i.vertical)?Zi[i.vertical]:i.vertical:t.getImageAlignVertical(),horizontal:null!=i.horizontal?mt(i.horizontal)?Ji[i.horizontal]:i.horizontal:t.getImageAlignHorizontal()}:{with:t.getImageAlignWith(),vertical:t.getImageAlignVertical(),horizontal:t.getImageAlignHorizontal()}}(i,r),this.Pr=function(t,n){var i=n&&n.margin;return i?{vertical:null!=i.vertical?i.vertical:t.getImageMarginVertial(),horizontal:null!=i.horizontal?i.horizontal:t.getImageMarginHorizontal()}:{vertical:t.getImageMarginVertial(),horizontal:t.getImageMarginHorizontal()}}(i,r),this.Fr=function(t,n){if(n&&null!=n.tint)return n.tint}(0,r),this.Ur=new t.Rectangle,this.Ut=new t.Point,this.zr=r&&r.source,this.Gr=null,this.o=n,this.yt=i,this.Hr=e,this.L=u,this.Vr=s}return Object.defineProperty(n.prototype,"image",{get:function(){return this.$},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this.at},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"margin",{get:function(){return this.Pr},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bound",{get:function(){return this.Ur},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"source",{get:function(){return this.zr},set:function(t){this.zr!==t&&(this.zr=t,this.L())},enumerable:!1,configurable:!0}),n.prototype.computeSource=function(){var t=this.zr;if(void 0!==t){if(!_n(t))return t;var n=t(this.o.state);if(void 0!==n)return n}return this.yt.getImageSource(this.o.state)},n.prototype.onStateChange=function(t,n){this.updateTint()},n.prototype.updateBound=function(){var t=this.Ur,n=this.$;if(null!=n){n.updateTransform(),n.getLocalBounds(t);var i=t.left,r=t.top,e=t.right,u=t.bottom,s=n.localTransform,h=s.a,o=s.b,a=s.c,c=s.d,f=h*i+a*r,l=o*i+c*r,v=h*e+a*r,b=o*e+c*r,g=h*e+a*u,d=o*e+c*u,m=h*i+a*u,w=o*i+c*u,p=Math.min(f,v,g,m),O=Math.max(f,v,g,m),D=Math.min(l,b,d,w),E=Math.max(l,b,d,w);t.x=p+s.tx,t.y=D+s.ty,t.width=O-p,t.height=E-D}else t.x=0,t.y=0,t.width=0,t.height=0},n.prototype.isTintAware=function(t){return null!=t&&"tint"in t},n.prototype.toTintColor=function(t,n){var i=this.Fr;if(i){var r=i.color;if(void 0!==r){if(!_n(r))return r;var e=r(n);if(void 0!==e)return e}}return t.getImageTintColor(n)},n.prototype.toTintAlpha=function(t,n){var i=this.Fr;if(i){var r=i.alpha;if(void 0!==r){if(!_n(r))return r;var e=r(n);if(void 0!==e)return e}}return t.getImageTintAlpha(n)},n.prototype.updateTint=function(){var t=this.$;if(t&&this.isTintAware(t)){var n=this.yt,i=this.o.state,r=this.toTintColor(n,i);if(null!=r){var e=!1;t.tint!==r&&(t.tint=r,e=!0);var u=this.toTintAlpha(n,i);return t.alpha!==u&&(t.alpha=u,e=!0),e}}return!1},n.prototype.updateSource=function(){var n=this.computeSource(),i=this.Gr;if(n!==i){this.Gr=n;var r=this.o,e=this.$;if(n instanceof t.Texture)if(i instanceof t.Texture)i.off("update",this.L),e instanceof t.Sprite&&(e.texture=n,n.on("update",this.L));else{null!=e&&r.removeChild(e);var u=new t.Sprite(n);this.Vr(u),n.on("update",this.L),r.addChild(u),this.$=u}else i instanceof t.Texture?(i.off("update",this.L),null!=e&&(r.removeChild(e),e.destroy())):null!=e&&r.removeChild(e),null!=n&&(this.Vr(n),r.addChild(n)),this.$=n;return!0}return!1},n.prototype.isRefitable=function(t){return null!=t&&t===this.$},n.prototype.destroy=function(){var n=this.$;if(n){this.$=null;var i=this.Gr;i instanceof t.Texture&&(i.off("update",this.L,this),n.destroy())}},n}(),ar=function(t){function n(n){var i=t.call(this)||this;return i.parent=n,i}return y(n,t),n.prototype.render=function(n){this.updateTransform(),t.prototype.render.call(this,n)},n.prototype.onReflow=function(t,n,i){this.clear(),this.beginFill(16777215,1),this.drawRect(0,0,n,i),this.endFill()},n}(t.Graphics),cr=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(t){var i,r,e,u,s,h,o;n.prototype.init.call(this,t);var a=this.theme;this.Wr=function(t,n){var i,r=null===(i=null==n?void 0:n.text)||void 0===i?void 0:i.value;return void 0!==r?r:t.newTextValue()}(a,t),this.Xr=this.computeTextValue(),this.Yr=null===(i=null==t?void 0:t.text)||void 0===i?void 0:i.color,this.Kr=null===(r=null==t?void 0:t.text)||void 0===r?void 0:r.alpha,this.Jr=function(t,n,i){var r,e,u,s,h,o,a,c,f=null===(r=null==n?void 0:n.text)||void 0===r?void 0:r.style;return null!=f?{fill:null!==(e=f.fill)&&void 0!==e?e:t.getColor(i),fontSize:null!==(u=f.fontSize)&&void 0!==u?u:t.getFontSize(),fontFamily:null!==(s=f.fontFamily)&&void 0!==s?s:t.getFontFamilly(),fontWeight:null!==(h=f.fontWeight)&&void 0!==h?h:t.getFontWeight(),fontStyle:null!==(o=f.fontStyle)&&void 0!==o?o:t.getFontStyle(),fontVariant:null!==(a=f.fontVariant)&&void 0!==a?a:t.getFontVariant(),clipping:null!==(c=f.clipping)&&void 0!==c?c:t.getTextStyleClipping()}:{fill:t.getColor(i),fontSize:t.getFontSize(),fontFamily:t.getFontFamilly(),fontWeight:t.getFontWeight(),fontStyle:t.getFontStyle(),fontVariant:t.getFontVariant(),clipping:t.getTextStyleClipping()}}(a,t,this.state),this.Hr=function(t,n){var i,r=null===(i=null==n?void 0:n.text)||void 0===i?void 0:i.align;return null!=r?{vertical:null!=r.vertical?mt(r.vertical)?Zi[r.vertical]:r.vertical:t.getTextAlignVertical(),horizontal:null!=r.horizontal?mt(r.horizontal)?Ji[r.horizontal]:r.horizontal:t.getTextAlignHorizontal()}:{vertical:t.getTextAlignVertical(),horizontal:t.getTextAlignHorizontal()}}(a,t),this.Zr=null!==(u=null===(e=null==t?void 0:t.text)||void 0===e?void 0:e.formatter)&&void 0!==u?u:a.getTextFormatter(),this.qr=null!==(h=null===(s=null==t?void 0:t.text)||void 0===s?void 0:s.dynamic)&&void 0!==h?h:a.isTextDynamic(),this.$r=null!==(o=null==t?void 0:t.mask)&&void 0!==o?o:a.isOverflowMaskEnabled(),this.Yi=null,this.onTextChange(),this.createOrUpdateText()},Object.defineProperty(i.prototype,"text",{get:function(){return this.Wr},set:function(t){this.Wr!==t&&(this.Wr=t,this.updateTextValue())},enumerable:!1,configurable:!0}),i.prototype.onTextChange=function(){},i.prototype.computeTextValue=function(){var t=this.Wr;if(void 0!==t){if(!_n(t))return t;var n=t(this.state);if(void 0!==n)return n}return this.theme.getTextValue(this.state)},i.prototype.createOrUpdateText=function(){var t=this.Zr(this.Xr,this),n=this.yr;if(null==n){if(0<t.length){var i=this.createText(t);this.yr=i,this.addChild(i),this.updateTextPosition(i),this.$r&&(i.mask=this.getOrCreateOverflowMask()),this.toDirty(),B.update(this)}}else n.text=t,this.toDirty(),B.update(this)},i.prototype.createText=function(n){if(this.qr)return new ur(n,this.Jr);var i=new t.Text(n,this.Jr);return i.texture.baseTexture.scaleMode=t.SCALE_MODES.NEAREST,i.resolution=B.getResolution(this),i},i.prototype.getOrCreateOverflowMask=function(){return null==this.Yi&&(this.Yi=new ar(this),this.addReflowable(this.Yi),this.toDirty()),this.Yi},i.prototype.updateTextPosition=function(t){var n=this.Hr,i=this.Mn,r=this.toRounded;switch(n.horizontal){case Ji.LEFT:t.x=r(i.getLeft());break;case Ji.CENTER:t.x=r(.5*(this.width-t.width));break;case Ji.RIGHT:t.x=r(this.width-t.width-i.getRight())}switch(n.vertical){case Zi.TOP:t.y=r(i.getTop());break;case Zi.MIDDLE:t.y=r(.5*(this.height-t.height));break;case Zi.BOTTOM:t.y=r(this.height-t.height-i.getBottom())}},i.prototype.toRounded=function(t){return Math.round(t)},i.prototype.getTextColor=function(t,n){var i=this.Yr;if(void 0!==i){if(!_n(i))return i;var r=i(n);if(void 0!==r)return r}return t.getColor(n)},i.prototype.getTextAlpha=function(t,n){var i=this.Kr;if(void 0!==i){if(!_n(i))return i;var r=i(n);if(void 0!==r)return r}return t.getAlpha(n)},i.prototype.updateTextColor=function(t){var n=this.theme,i=this.state;t.style.fill=this.getTextColor(n,i),t.alpha=this.getTextAlpha(n,i)},i.prototype.updateTextValue=function(){var t=this.computeTextValue();this.Xr!==t&&(this.Xr=t,this.onTextChange(),this.createOrUpdateText())},i.prototype.updateText=function(){var t=this.yr;null!=t&&(this.updateTextValue(),this.updateTextPosition(t),this.updateTextColor(t))},i.prototype.onReflow=function(){n.prototype.onReflow.call(this),this.updateText()},i.prototype.isRefitable=function(t){return n.prototype.isRefitable.call(this,t)||null!=t&&t===this.yr},i.prototype.applyTitle=function(){var t=this.yr;if(this.Nn.length<=0&&t&&"clipped"in t&&t.clipped){var i=B.getLayer(this);i&&(i.view.title=t.text)}else n.prototype.applyTitle.call(this)},i.prototype.getType=function(){return"DTextBase"},i.prototype.destroy=function(){var t=this.yr;null!=t&&(this.yr=null,t.destroy());var i=this.Yi;null!=i&&(this.Yi=null,i.destroy()),n.prototype.destroy.call(this)},i}(li),fr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;this.Qr=function(){i.toDirty(),B.update(i)},this.te=function(t){i.$r&&(t.mask=i.getOrCreateOverflowMask())},this.ne=this.newImages(this.theme,n),t.prototype.init.call(this,n)},n.prototype.newImages=function(t,n){var i=[];return i.push(this.newImage(t,this.toImageOptions(t,n&&n.image))),function(t){return!!t.getSecondaryImageSource}(t)&&i.push(this.newImage(new sr(t))),function(t){return!!t.getTertiaryImageSource}(t)&&i.push(this.newImage(new hr(t))),i},n.prototype.toImageOptions=function(t,n){return n},n.prototype.newImage=function(t,n){return new or(this,t,n,this.Hr,this.Qr,this.te)},Object.defineProperty(n.prototype,"image",{get:function(){return this.ne[0].source},set:function(t){this.ne[0].source=t},enumerable:!1,configurable:!0}),n.prototype.onStateChange=function(n,i){t.prototype.onStateChange.call(this,n,i);for(var r=this.ne,e=0,u=r.length;e<u;++e)r[e].onStateChange(n,i)},n.prototype.updateText=function(){this.updateTextValue(),this.updateTextAndImage()},n.prototype.updateTextAndImage=function(){for(var t=this.yr,n=this.ne,i=this.Mn,r=this.toRounded,e=this.width,u=this.height,s=i.getLeft(),h=i.getRight(),o=i.getTop(),a=i.getBottom(),c=null==t,f=c,l=c,v=0,b=0,g=0,d=0,m=0,w=0,p=s,O=e-h,D=o,E=u-a,M=0,S=e,T=0,j=u,N=0,I=n.length;N<I;++N)if((Y=n[N]).updateSource(),Y.updateTint(),Y.updateBound(),K=Y.image){var C=(J=Y.bound).width,A=J.height,R=Y.margin,y=R.horizontal,k=R.vertical;if(Y.align.with===qi.TEXT){switch(Y.align.horizontal){case Ji.LEFT:K.x=g,g+=C,f?f=!1:g+=y;break;case Ji.CENTER:break;case Ji.RIGHT:d-=C,K.x=d,d-=y,v=y}switch(Y.align.vertical){case Zi.TOP:K.y=m,m+=A,l?l=!1:m+=k;break;case Zi.MIDDLE:break;case Zi.BOTTOM:w-=A,K.y=w,w-=k,b=k}}if(Y.align.with===qi.PADDING){switch(Y.align.horizontal){case Ji.LEFT:p+=y,K.x=r(p),p+=C;break;case Ji.CENTER:break;case Ji.RIGHT:O-=C+y,K.x=r(O)}switch(Y.align.vertical){case Zi.TOP:D+=k,K.y=r(D),D+=A;break;case Zi.MIDDLE:break;case Zi.BOTTOM:E-=A+k,K.y=r(E)}}if(Y.align.with===qi.BORDER){switch(Y.align.horizontal){case Ji.LEFT:M+=y,K.x=r(M),M+=C;break;case Ji.CENTER:break;case Ji.RIGHT:S-=C+y,K.x=r(S)}switch(Y.align.vertical){case Zi.TOP:T+=k,K.y=r(T),T+=A;break;case Zi.MIDDLE:break;case Zi.BOTTOM:j-=A+k,K.y=r(j)}}}c&&(d+=v,w+=b);var x=0,L=0,B=0,_=0,P=0,F=0;if(null!=t){this.updateTextColor(t),t instanceof ur&&t.setClippingWidthDelta(g-d);var U=this.Hr,z=t.width,G=t.height;switch(U.horizontal){case Ji.LEFT:B=(x=s)+g+z-d;break;case Ji.CENTER:B=(x=.5*(e-g+d-z))+g+z-d;break;case Ji.RIGHT:x=(B=e-h)+d-z-g}switch(t.x=r(x+g),L=x+g+.5*z,U.vertical){case Zi.TOP:F=(_=o)+m+G-w;break;case Zi.MIDDLE:F=(_=.5*(u-m+w-G))+m+G-w;break;case Zi.BOTTOM:_=(F=u-a)+w-G-m}t.y=r(_+m),P=_+m+.5*G}else B=(x=.5*(e-g+d))+g-d,L=x+g,F=(_=.5*(u-m+w))+m-w,P=_+m;var H=.5*e,V=.5*u,W=.5*e,X=.5*u;for(N=0,I=n.length;N<I;++N){var Y,K;if(K=(Y=n[N]).image){var J;if(C=(J=Y.bound).width,A=J.height,Y.align.with===qi.TEXT){switch(Y.align.horizontal){case Ji.LEFT:K.x=r(K.x+x);break;case Ji.CENTER:K.x=r(L-.5*C);break;case Ji.RIGHT:K.x=r(K.x+B)}switch(Y.align.vertical){case Zi.TOP:K.y=r(K.y+_);break;case Zi.MIDDLE:K.y=r(P-.5*A);break;case Zi.BOTTOM:K.y=r(K.y+F)}}if(Y.align.with===qi.PADDING){switch(Y.align.horizontal){case Ji.CENTER:K.x=r(H-.5*C)}switch(Y.align.vertical){case Zi.MIDDLE:K.y=r(V-.5*A)}}if(Y.align.with===qi.BORDER){switch(Y.align.horizontal){case Ji.CENTER:K.x=r(W-.5*C)}switch(Y.align.vertical){case Zi.MIDDLE:K.y=r(X-.5*A)}}}}},n.prototype.isRefitable=function(n){if(t.prototype.isRefitable.call(this,n))return!0;for(var i=this.ne,r=0,e=i.length;r<e;++r)if(i[r].isRefitable(n))return!0;return!1},n.prototype.getType=function(){return"DImageBase"},n.prototype.destroy=function(){for(var n=this.ne,i=0,r=n.length;i<r;++i)n[i].destroy();t.prototype.destroy.call(this)},n}(cr),lr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.buttonMode=!0,this.ie=function(t,n){return null!=n&&null!=n.toggle?n.toggle:t.isToggle()}(this.theme,n),this.initOnClick(n),this.ie||this.initOnPress(n);var i=n&&n.group;i&&i.add(this)},n.prototype.onShortcut=function(n){t.prototype.onShortcut.call(this,n),this.onClick(n)},n.prototype.isToggle=function(){return this.ie},n.prototype.initOnClick=function(t){var n=this;ai.onClick(this,(function(t){n.onClick(t)}))},n.prototype.initOnPress=function(t){var n=this,i=null,r=function(){n.state.isPressed=!1,null!=i&&(i.off(ai.up,r),i=null)};this.on(ai.down,(function(){n.state.isPressed=!0;var t=B.getLayer(n);t&&(i=t.renderer.plugins.interaction).on(ai.up,r)}))},n.prototype.onStateChange=function(n,i){t.prototype.onStateChange.call(this,n,i),this.buttonMode=n.isActionable},n.prototype.getType=function(){return"DButton"},n.prototype.onClick=function(t){this.state.isActionable&&(this.isToggle()?(this.onToggleStart(),this.onToggleEnd()):this.onActivate(t))},n.prototype.onActivate=function(t){this.emit("active",this)},n.prototype.toggle=function(){this.state.isActionable&&this.isToggle()&&(this.onToggleStart(),this.onToggleEnd())},n.prototype.onToggleStart=function(){this.state.isActive=!this.state.isActive},n.prototype.onToggleEnd=function(){this.emit(this.state.isActive?"active":"inactive",this)},n.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this.isToggle()?this.onToggleStart():this.state.isPressed=!0)},n.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this.isToggle()?this.onToggleEnd():(this.state.isPressed&&this.onActivate(t),this.state.isPressed=!1))},n.prototype.onKeyDown=function(n){return pt.isActivateKey(n)&&this.onActivateKeyDown(n),t.prototype.onKeyDown.call(this,n)},n.prototype.onKeyUp=function(n){return pt.isActivateKey(n)&&this.onActivateKeyUp(n),t.prototype.onKeyUp.call(this,n)},n.prototype.destroy=function(){var n=this.vn;null!=n&&null!=n.group&&n.group.remove(this),t.prototype.destroy.call(this)},n}(fr),vr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButton"},n}(lr),br=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonPrimary"},n}(vr),gr=function(t){function n(n){var i=t.call(this,n)||this;if(i.re=0,i.ee=0,i.ue=0,i.se=0,i.he=null,i.oe=null,null!=n&&null!=n.shift){var r=n.shift;i.ae=null!=r.x?r.x:0,i.ce=null!=r.y?r.y:15}else i.ae=0,i.ce=15;return i.fe=function(){i.onPrerender()},i.le=function(){i.onPostrender()},i}return y(n,t),n.prototype.stop=function(){this.se=0,this.removeEventListeners(),t.prototype.stop.call(this)},n.prototype.addEventListeners=function(t){var n=B.getLayer(t);if(n){this.oe=n;var i=n.renderer;i.on("prerender",this.fe),i.on("postrender",this.le)}},n.prototype.removeEventListeners=function(){var t=this.oe;if(t){this.oe=null;var n=t.renderer;n.off("prerender",this.fe),n.off("postrender",this.le)}},n.prototype.onStart=function(n){var i=this.he=this.i;null!=i&&(this.se=0,this.removeEventListeners(),this.addEventListeners(i),n||(i.visible=!0),t.prototype.onStart.call(this,n))},n.prototype.onTime=function(n,i,r){if(null!=this.he){var e=this.oe;e?(this.se=n,t.prototype.onTime.call(this,n,i,r),e.update()):(this.se=n,t.prototype.onTime.call(this,n,i,r))}},n.prototype.onEnd=function(n){var i=this.he;null!=i&&(this.removeEventListeners(),n&&(i.visible=!1),t.prototype.onEnd.call(this,n))},n.prototype.onPrerender=function(){var t=this.he;if(null!=t){var n=this.se,i=t.unsafe.position;this.re=i.x,this.ee=i.y,i.set(i.x-this.ae*(1-n),i.y-this.ce*(1-n)),this.ue=t.alpha,t.alpha=n}},n.prototype.onPostrender=function(){var t=this.he;null!=t&&(t.unsafe.position.set(this.re,this.ee),t.alpha=this.ue)},n}(wi);!function(t){t[t.NONE=0]="NONE",t[t.ESC=1]="ESC",t[t.CLICK_OUTSIDE=2]="CLICK_OUTSIDE"}(Qi||(Qi={}));var dr,mr=function(){function n(){}return n.apply=function(t,n){var i=this;t.on(ai.down,(function(r){if(r.target===t){var e=i.point;e.copyFrom(r.data.global),t.toLocal(e,void 0,e,!0);var u=e.x,s=e.y;(u<0||s<0||t.width<u||t.height<s)&&n(r)}}))},n.point=new t.Point,n}(),wr=function(){function t(t){this.oe=null,this.ve=null==t||null==t.parent?B.last():null}return Object.defineProperty(t.prototype,"picked",{get:function(){return this.oe},enumerable:!1,configurable:!0}),t.prototype.pick=function(t){var n=this.oe;if(null==n){if(!(n=B.getLayerOverlay(t))){var i=this.ve;n=i?i.getLayerOverlay():B.last().getLayerOverlay()}this.oe=n}return n},t}(),pr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.visible=!1,this.state.isFocusRoot=!0,this.be=null,this.ge=!1;var r=this.Kn=n&&n.animation?n.animation:new gr;r.target=this,r.on("end",(function(t){i.onAnimationEnd(t)})),(this.de=n&&null!=n.closeOn?n.closeOn:this.theme.closeOn())&Qi.CLICK_OUTSIDE&&mr.apply(this,(function(){i.onCloseOn()})),this.me=new wr},n.prototype.onAnimationEnd=function(t){if(t){var n=this.parent;n&&n.removeChild(this)}else{var i=B.getLayer(this);if(i){var r=i.getFocusController();this.be=r.get();var e=r.find(this,!1,!0,!0);r.focus(e||this)}}},n.prototype.open=function(){if(!this.ge){var t=this.me.pick(this);this.ge=!0,t.stage.addChild(this),this.onOpen()}},n.prototype.onOpen=function(){this.emit("open",this),this.Kn.start()},n.prototype.isOpened=function(){return this.ge},n.prototype.close=function(){this.ge&&(this.ge=!1,this.onClose())},n.prototype.onClose=function(){var t=this.be;if(null!=t){this.be=null;var n=B.getLayer(this);n&&n.getFocusController().focus(t)}this.Kn.start(!0),this.emit("close",this)},n.prototype.getType=function(){return"DDialog"},n.prototype.onKeyDown=function(n){return this.de&Qi.ESC&&pt.isCancelKey(n)&&this.onCloseOn(),t.prototype.onKeyDown.call(this,n)},n.prototype.onCloseOn=function(){this.close()},n.prototype.containsGlobalPoint=function(t){return!0},n}(li);!function(t){t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL"}(dr||(dr={}));var Or,Dr=function(t){function n(n){var i=t.call(this,n)||this;return i.visible=!1,i.state.isFocusable=!1,i}return y(n,t),n.prototype.getType=function(){return"DLayoutSpace"},n}(li),Er=function(t){return t instanceof li&&(t.visible||t instanceof Dr)},Mr=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.state.isFocusable=!1;var i=this.theme;this.Pr=function(t,n){var i=null==n?void 0:n.margin;if(null!=i){if(F(i))return{horizontal:i,vertical:i};var r=t.getMargin();return{horizontal:null!=i.horizontal?i.horizontal:r,vertical:null!=i.vertical?i.vertical:r}}return{horizontal:r=t.getMargin(),vertical:r}}(i,n),this.Nt=function(t,n){var i=null==n?void 0:n.direction;return null!=i?mt(i)?dr[i]:i:t.getDirection()}(i,n),this.we=function(t,n){var i=null==n?void 0:n.corner;if(null!=i&&!F(i)){var r=i.adjust;if(null!=r)return r}return t.getCornerAdjust()}(i,n),this.pe=function(t,n){if(n){var i=n.row;if(null!=i)return i;var r=n.column;if(null!=r)return r}return t.getMultiplicity()}(i,n),this.xn=function(t,n){var i;return null!==(i=null==n?void 0:n.reverse)&&void 0!==i?i:t.getReverse()}(i,n)},Object.defineProperty(n.prototype,"margin",{get:function(){return this.Pr},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"multiplicity",{get:function(){return this.pe},enumerable:!1,configurable:!0}),n.prototype.getWeightTotal=function(){for(var t=this.children,n=0,i=this.pe,r=this.xn,e=0,u=t.length;e<u;){for(var s=-1,h=0;h<i&&e+h<u;++h){var o=t[r?u-1-(e+h):e+h];if(Er(o)){var a=o.getClearType();if(0!==h&&a&Hn.BEFORE)break;if(s=Math.max(s,o.weight),a&&Hn.AFTER){h+=1;break}}else e+=1,h-=1}e+=h,0<=s&&(n+=s)}return n},n.prototype.getSpaceLeft=function(t,n){var i=this.children,r=this.pe,e=this.xn;if(this.Nt===dr.VERTICAL){for(var u=t,s=0,h=0,o=i.length;h<o;){for(var a=0,c=-1,f=0;f<r&&h+f<o;++f){var l=i[e?o-1-(h+f):h+f];if(Er(l)){var v=l.getClearType();if(0!==f&&v&Hn.BEFORE)break;if(a=(c=Math.max(c,l.weight))<0?Math.max(a,l.height+s):s,v&Hn.AFTER){f+=1;break}}else h+=1,f-=1}h+=f,u-=a,s=n}return Math.max(0,u)}for(u=t,s=0,h=0,o=i.length;h<o;){var b=0;for(c=-1,f=0;f<r&&h+f<o;++f)if(l=i[e?o-1-(h+f):h+f],Er(l)){if(v=l.getClearType(),0!==f&&v&Hn.BEFORE)break;if(b=(c=Math.max(c,l.weight))<0?Math.max(b,l.width+s):s,v&Hn.AFTER){f+=1;break}}else h+=1,f-=1;h+=f,u-=b,s=n}return Math.max(0,u)},n.prototype.calcSpaceLeft=function(t,n,i,r){return t?0:this.getSpaceLeft(n-i,r)},n.prototype.onRefit=function(){var i=this.children,r=this.Mn,e=r.getTop(),u=r.getBottom(),s=r.getLeft(),h=r.getRight(),o=this.Pr,a=o.vertical,c=o.horizontal,f=this.getWeightTotal(),l=this.pe,v=this.xn,b=this.gn,g=null;if(this.we){var d=4+(i.length<<1);(null==n.CORNER_ADJUST_WORK||n.CORNER_ADJUST_WORK.length<d)&&(n.CORNER_ADJUST_WORK=new Float32Array(d)),(g=n.CORNER_ADJUST_WORK)[0]=-2,g[1]=-2,g[d-2]=-3,g[d-1]=-3}if(this.Nt===dr.VERTICAL){var m=0,w=e-a;if(0<f){for(var p=1/f,O=this.calcSpaceLeft(b.height.isOn,this.height,e+u,a),D=0,E=i.length;D<E;){for(var M=s-c,S=0,T=0;T<l&&D+T<E;++T){var j=i[v?E-1-(D+T):D+T];if(Er(j)){var N=j.getClearType();if(0!==T&&N&Hn.BEFORE)break;if(j.position.set(c+M,a+w),0<=(U=j.weight)&&(j.height=O*(U*p)),M+=c+j.width,S=Math.max(S,j.height),N&Hn.AFTER){null!=g&&(g[0+(z=D+T+1<<1)]=T,g[z+1]=m),T+=1;break}null!=g&&(g[0+(z=D+T+1<<1)]=T,g[z+1]=m)}else null!=g&&(g[0+(z=D+T+1<<1)]=T-1,g[z+1]=m),D+=1,T-=1}w+=a+S,D+=T,m+=1}if(null!=g)for(D=0,E=i.length;D<E;++D)if(j=i[v?E-1-D:D],Er(j)){var I=g[0+(G=2+(D<<1))],C=g[G+1],A=-2;if(!((N=j.getClearType())&Hn.BEFORE)){var R=this.findRowIndexPrevious(G,C,g);this.hasClearTypeAfter(i,R)||(A=g[R])}var y=-2;if(!(N&Hn.AFTER)){var k=this.findRowIndexNext(G,C,g);this.hasClearTypeBefore(i,k)||(y=g[k])}var x=this.countColumn(G,C,g);j.corner.mask=this.toCornerMaskColumn(A,I,y,x)}}else{for(D=0,E=i.length;D<E;){for(M=s-c,S=0,T=0;T<l&&D+T<E;++T)if(j=i[v?E-1-(D+T):D+T],Er(j)){if(N=j.getClearType(),0!==T&&N&Hn.BEFORE)break;if(j.position.set(c+M,a+w),0<=(U=j.weight)&&(j.height=0),M+=c+j.width,S=Math.max(S,j.height),N&Hn.AFTER){null!=g&&(g[0+(z=D+T+1<<1)]=T,g[z+1]=m),T+=1;break}null!=g&&(g[0+(z=D+T+1<<1)]=T,g[z+1]=m)}else null!=g&&(g[0+(z=D+T+1<<1)]=T-1,g[z+1]=m),D+=1,T-=1;w+=a+S,D+=T,m+=1}if(null!=g)for(D=0,E=i.length;D<E;++D)j=i[v?E-1-D:D],Er(j)&&(I=g[0+(G=2+(D<<1))],C=g[G+1],A=-2,(N=j.getClearType())&Hn.BEFORE||(R=this.findRowIndexPrevious(G,C,g),this.hasClearTypeAfter(i,R)||(A=g[R])),y=-2,N&Hn.AFTER||(k=this.findRowIndexNext(G,C,g),this.hasClearTypeBefore(i,k)||(y=g[k])),x=this.countColumn(G,C,g),j.corner.mask=this.toCornerMaskColumn(A,I,y,x))}}else{var L=0;if(M=s-c,0<f){for(p=1/f,O=this.calcSpaceLeft(b.width.isOn,this.width,s+h,c),D=0,E=i.length;D<E;){w=e-a;var B=0;for(T=0;T<l&&D+T<E;++T)if(j=i[v?E-1-(D+T):D+T],Er(j)){if(N=j.getClearType(),0!==T&&N&Hn.BEFORE)break;if(j.position.set(c+M,a+w),0<=(U=j.weight)&&(j.width=O*(U*p)),B=Math.max(B,j.width),w+=a+j.height,N&Hn.AFTER){null!=g&&(g[0+(z=D+T+1<<1)]=L,g[z+1]=T),T+=1;break}null!=g&&(g[0+(z=D+T+1<<1)]=L,g[z+1]=T)}else null!=g&&(g[0+(z=D+T+1<<1)]=L,g[z+1]=T-1),D+=1,T-=1;M+=c+B,D+=T,L+=1}if(null!=g)for(D=0,E=i.length;D<E;++D)if(j=i[v?E-1-D:D],Er(j)){I=g[0+(G=2+(D<<1))],C=g[G+1];var _=-2;(N=j.getClearType())&Hn.BEFORE||(R=this.findColumnIndexPrevious(G,I,g),this.hasClearTypeAfter(i,R)||(_=g[R+1]));var P=-2;N&Hn.AFTER||(k=this.findColumnIndexNext(G,I,g),this.hasClearTypeBefore(i,k)||(P=g[k+1]));var F=this.countRow(G,I,g);j.corner.mask=this.toCornerMaskRow(_,C,P,F)}}else{for(D=0,E=i.length;D<E;){for(w=e-a,B=0,T=0;T<l&&D+T<E;++T)if(j=i[v?E-1-(D+T):D+T],Er(j)){var U;if(N=j.getClearType(),0!==T&&N&Hn.BEFORE)break;if(j.position.set(c+M,a+w),0<=(U=j.weight)&&(j.width=0),B=Math.max(B,j.width),w+=a+j.height,N&Hn.AFTER){null!=g&&(g[0+(z=D+T+1<<1)]=L,g[z+1]=T),T+=1;break}null!=g&&(g[0+(z=D+T+1<<1)]=L,g[z+1]=T)}else{var z;null!=g&&(g[0+(z=D+T+1<<1)]=L,g[z+1]=T-1),D+=1,T-=1}M+=c+B,D+=T,L+=1}if(null!=g)for(D=0,E=i.length;D<E;++D){var G;j=i[v?E-1-D:D],Er(j)&&(I=g[0+(G=2+(D<<1))],C=g[G+1],_=-2,(N=j.getClearType())&Hn.BEFORE||(R=this.findColumnIndexPrevious(G,I,g),this.hasClearTypeAfter(i,R)||(_=g[R+1])),P=-2,N&Hn.AFTER||(k=this.findColumnIndexNext(G,I,g),this.hasClearTypeBefore(i,k)||(P=g[k+1])),F=this.countRow(G,I,g),j.corner.mask=this.toCornerMaskRow(_,C,P,F))}}}t.prototype.onRefit.call(this)},n.prototype.hasClearTypeBefore=function(t,n){return this.hasClearType(t,n,Hn.BEFORE)},n.prototype.hasClearTypeAfter=function(t,n){return this.hasClearType(t,n,Hn.AFTER)},n.prototype.hasClearType=function(t,n,i){if(2<=n){var r=n-2>>1;if(0<=r&&r<t.length){var e=t[r];if(e instanceof li)return!!(e.getClearType()&i)}}return!1},n.prototype.findColumnIndexPrevious=function(t,n,i){for(var r=t-2;0<=r;r-=2)if(i[r]!==n)return r;return 0},n.prototype.findColumnIndexNext=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2){var u=i[r];if(u!==n){for(var s=r+2;s<e;s+=2)if(i[s]!==u)return s-2;return r}}return i.length-2},n.prototype.countRow=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2)if(i[r]!==n)return i[r-2+1]+1;return 0},n.prototype.findRowIndexPrevious=function(t,n,i){for(var r=t-2;0<=r;r-=2)if(i[r+1]!==n)return r;return 0},n.prototype.findRowIndexNext=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2){var u=i[r+1];if(u!==n){for(var s=r+2;s<e;s+=2)if(i[s+1]!==u)return s-2;return r}}return i.length-2},n.prototype.countColumn=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2)if(i[r+1]!==n)return i[r-2+0]+1;return 0},n.prototype.toCornerMaskColumn=function(t,n,i,r){var e=Fn.NONE;return t+1<n&&0===n&&(e|=Fn.TOP_LEFT),i+1<n&&0===n&&(e|=Fn.BOTTOM_LEFT),t<n&&n+1===r&&(e|=Fn.TOP_RIGHT),i<n&&n+1===r&&(e|=Fn.BOTTOM_RIGHT),Fn.ALL&~e},n.prototype.toCornerMaskRow=function(t,n,i,r){var e=Fn.NONE;return t+1<n&&0===n&&(e|=Fn.TOP_LEFT),i+1<n&&0===n&&(e|=Fn.TOP_RIGHT),t<n&&n+1===r&&(e|=Fn.BOTTOM_LEFT),i<n&&n+1===r&&(e|=Fn.BOTTOM_RIGHT),Fn.ALL&~e},n.prototype.addSpace=function(t){return this.addChild(new Dr(t))},n.prototype.getType=function(){return"DLayout"},n.CORNER_ADJUST_WORK=null,n}(li),Sr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DLayoutHorizontal"},n}(Mr),Tr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DLayoutVertical"},n}(Mr),jr=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Oe=null,n.De=null,n.Ee=null,n}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=this.theme,e=new Tr({parent:this,x:r.getLayoutX(),y:r.getLayoutY(),width:r.getLayoutWidth(),height:r.getLayoutHeight(),margin:r.getLayoutMargin()});this.onInit(e,n);var u=n&&n.ok||r.getOk(),s=n&&n.cancel||r.getCancel();if(null!=u||null!=s){var h=new Sr({parent:e,width:"padding",height:"auto",padding:{top:Math.max(0,this.padding.getTop()-e.margin.vertical)}});this.Me=h,new Dr({parent:h,weight:1}),null!=u&&null!=s?(this.Se=new br({parent:h,text:{value:s},on:{active:function(){i.onCancel()}}}),this.Te=new vr({parent:h,text:{value:u},on:{active:function(){i.onOk()}}})):null!=u?this.Te=new br({parent:h,text:{value:u},on:{active:function(){i.onOk()}}}):null!=s&&(this.Se=new br({parent:h,text:{value:s},on:{active:function(){i.onCancel()}}})),new Dr({parent:h,weight:1})}},n.prototype.onInit=function(t,n){},n.prototype.open=function(){return t.prototype.open.call(this),this.Oe},n.prototype.onOpen=function(){var n=this;t.prototype.onOpen.call(this),null==this.Oe&&(this.Oe=new Promise((function(t,i){n.De=t,n.Ee=i})))},n.prototype.onClose=function(){t.prototype.onClose.call(this);var n=this.Ee;this.Oe=null,this.De=null,this.Ee=null,null!=n&&n()},n.prototype.onOk=function(){var t=this.De;this.Oe=null,this.De=null,this.Ee=null,this.close(),null!=t&&this.doResolve(t),this.emit("ok",this)},n.prototype.onCancel=function(){var t=this.Ee;this.Oe=null,this.De=null,this.Ee=null,this.close(),null!=t&&this.doReject(t),this.emit("cancel",this)},n.prototype.doResolve=function(t){t()},n.prototype.doReject=function(t){t()},n.prototype.getType=function(){return"DDialogCommand"},n}(pr),Nr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.state.isFocusable=!1},n.prototype.getType=function(){return"DText"},n}(cr),Ir=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=this.theme,e=this.toMargin(r,i),u=e.horizontal,s=e.vertical,h=this.toLabelOptions(r,i);h&&(this.je=new Nr(h),new Sr({parent:n,width:"padding",height:"auto",margin:0,children:[new Dr({width:u}),this.je]})),new Sr({parent:n,width:"padding",height:"auto",margin:0,padding:h?{top:s}:void 0,children:[new Dr({width:u}),this.input,new Dr({width:u})]})},n.prototype.toMargin=function(t,n){var i=n&&n.margin;if(null!=i){if(F(i))return{horizontal:i,vertical:i};var r=i.horizontal,e=i.vertical;return{horizontal:null!=r?r:t.getMarginHorizontal(),vertical:null!=e?e:t.getMarginVertical()}}return{horizontal:t.getMarginHorizontal(),vertical:t.getMarginVertical()}},n.prototype.toLabelOptions=function(t,n){var i=n&&n.label;if(null==i)return null;if(mt(i))return{weight:1,text:{value:i}};var r=i.text=i.text||{};return void 0===r.value&&(r.value=t.getLabel()),void 0===i.width&&void 0===i.weight&&(i.weight=1),i},Object.defineProperty(n.prototype,"label",{get:function(){return this.je},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"input",{get:function(){var t=this.Ne;if(null==t){var n=this.vn;t=this.newInput(n&&n.input),this.Ne=t}return t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.input.value},set:function(t){this.input.value=t},enumerable:!1,configurable:!0}),n.prototype.doResolve=function(t){t(this.value)},n.prototype.getType=function(){return"DDialogInput"},n}(jr),Cr=function(t){function n(n){var i=t.call(this)||this;if(i.Ie=[],i.Ce=null,i.Ae=function(t){i.active=t},null!=n){var r=n.on;if(null!=r)for(var e in r){var u=r[e];u&&i.on(e,u)}}return i.emit("init",i),i}return y(n,t),n.prototype.add=function(t){if(this.Ie.indexOf(t)<0){this.Ie.push(t);var n=this.Re;null!=n&&(t.state.isEnabled=n),t.on("active",this.Ae),t.state.isActive&&(this.active=t)}},Object.defineProperty(n.prototype,"active",{get:function(){return this.Ce},set:function(t){if((null==t||t.isToggle())&&this.Ce!==t){var n=this.Ce;this.Ce=null;for(var i=this.Ie,r=0,e=i.length;r<e;++r){var u=i[r];u!==t&&u.isToggle()&&u.state.isActive&&u.toggle()}this.emit("active",t,n,this)}},enumerable:!1,configurable:!0}),n.prototype.remove=function(t){var n=this.Ie,i=n.indexOf(t);0<=i&&(n.splice(i,1),t.off("active",this.Ae),this.Ce===t&&(this.active=null))},n.prototype.contains=function(t){return 0<=this.Ie.indexOf(t)},n.prototype.clear=function(){this.Ie.length=0,this.active=null},n.prototype.size=function(){return this.Ie.length},n.prototype.each=function(t){for(var n=this.Ie,i=0,r=n.length;i<r&&!1!==t(n[i]);++i);},n.prototype.disable=function(){for(var t=this.Ie,n=0,i=t.length;n<i;++n)t[n].state.isDisabled=!0;this.Re=!1},n.prototype.enable=function(){for(var t=this.Ie,n=0,i=t.length;n<i;++n)t[n].state.isDisabled=!1;this.Re=!0},n.prototype.destroy=function(){this.clear()},n}(t.utils.EventEmitter),Ar=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DInputBooleanButtonOff"},n}(vr),Rr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DInputBooleanButtonOn"},n}(vr),yr=function(t){function n(n){var i=t.call(this,n)||this;return i.addChild(i.getButtonOff()),i.addChild(i.getButtonOn()),n&&null!=n.value&&(i.value=n.value),i.getButtonGroup().on("active",(function(){var t=i.value;i.emit("change",t,!t,i)})),i}return y(n,t),n.prototype.getButtonGroup=function(){var t=this.ye;return null==t&&(t=this.newButtonGroup(),this.ye=t),t},n.prototype.newButtonGroup=function(){return new Cr},n.prototype.getButtonOn=function(){var t=this.ke;return null==t&&(t=this.newButtonOn(),this.ke=t),t},n.prototype.newButtonOn=function(){return new Rr({weight:1,group:this.getButtonGroup()})},n.prototype.getButtonOff=function(){var t=this.xe;return null==t&&(t=this.newButtonOff(),this.xe=t),t},n.prototype.newButtonOff=function(){return new Ar({weight:1,group:this.getButtonGroup(),state:x.ACTIVE})},Object.defineProperty(n.prototype,"value",{get:function(){return this.getButtonOn().state.isActive},set:function(t){this.value!==t&&(t?this.getButtonOn().onClick():this.getButtonOff().onClick())},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DInputBoolean"},n}(Sr),kr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newInput=function(t){return new yr(this.toInputOptions(t))},n.prototype.toInputOptions=function(t){var n=t||{};return void 0===n.weight&&(n.weight=1),n},n.prototype.getType=function(){return"DDialogInputBoolean"},n}(Ir),xr=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.target=Mt.ofStringOrNull(n.target),r}return y(n,t),n}(Tt),Lr=function(t){function n(n){var i=t.call(this,n,tt.NONE)||this;return i.onInputAction=n.onInputAction,i.isOpened=!1,i}return y(n,t),n.prototype.execute=function(t,n,i){var r=this;if(!this.isOpened&&this.condition(t,i)){var e=this.target(t,i);if(null!=e){var u=this.initial(t,i);this.isOpened=!0,setTimeout((function(){r.open(e,u).then((function(n){r.isOpened=!1,Ri.execute(t,r.onInputAction,e,n,i)}),(function(){r.isOpened=!1}))}),0)}}},n}(xr),Br=function(t){function n(n){var i=t.call(this,n)||this;return i.initial=Mt.ofBooleanOrFalse(n.initial),i}return y(n,t),n.prototype.open=function(t,i){var r=n.DIALOG;if(null==r)r=new kr({label:t}),n.DIALOG=r;else{var e=r.label;e&&(e.text=t)}return r.value=i,r.open()},n}(Lr);!function(t){t[t.FOCUSED=0]="FOCUSED",t[t.ALWAYS=1]="ALWAYS"}(Or||(Or={}));var _r,Pr=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(t){var i=this;n.prototype.init.call(this,t),this.Le=null;var r=this.theme,e=t&&t.clipper,u=e&&e.creator||r.getClipperCreator();this.Be=null,this._e=u,this.Pe=null;var s=t&&t.element,h=s&&s.creator||r.getElementCreator();this.Fe=null,this.Ue=h,this.ze=s&&s.style,this.Ge=null,this.He=!1,this.Ve=function(t){i.onElementFocused(t)};var o=t&&t.before;this.We=null,this.Xe=o&&o.creator||r.getBeforeCreator(),this.Ye=o&&o.style,this.Ke=function(t){i.onBeforeFocused(t)};var a=t&&t.after;this.Je=null,this.Ze=a&&a.creator||r.getAfterCreator(),this.qe=a&&a.style,this.$e=function(t){i.onAfterFocused(t)},this.Qe=!1,this.tu=t&&null!=t.select?t.select:r.getSelect(),this.nu=function(){i.doSelect()};var c=t&&null!=t.when?mt(t.when)?Or[t.when]:t.when:r.getWhen();this.iu=c,this.ru=c===Or.ALWAYS},Object.defineProperty(i.prototype,"element",{get:function(){return this.Fe},enumerable:!1,configurable:!0}),i.prototype.onDownThis=function(t){var i=this.Qe;n.prototype.onDownThis.call(this,t),!i&&this.Qe&&t.data.originalEvent.preventDefault()},i.prototype.onFocused=function(){if(n.prototype.onFocused.call(this),this.iu===Or.FOCUSED)this.start();else{var t=this.Fe;t&&t.focus()}},i.prototype.onBlured=function(){if(n.prototype.onBlured.call(this),this.iu===Or.FOCUSED)this.onEndByBlured(),this.cancel();else{var t=this.Fe;t&&t.blur()}},i.prototype.isStartable=function(){return this.iu!==Or.FOCUSED||this.state.isActionable},i.prototype.start=function(){!this.Qe&&this.isStartable()&&(this.Qe=!0,this.doStart(),B.update(this))},i.prototype.render=function(t){this.ru&&(this.ru=!1,this.doStart()),this.Qe&&(this.Qe=!1),n.prototype.render.call(this,t),this.He&&this.updateElement(t)},i.prototype.doStart=function(t){if(!this.He){this.He=!0,this.onStart();var n=this.getClipper();if(n){var i=this.getBefore(n),r=this.getElement(n),e=this.getAfter(n);if(r){var u=null==t?B.getResolution(this):t.resolution,s=this.getElementRect(u),h=this.getClipperRect(s,u),o=this.theme,a=this.state,c=this.Mn;this.setClipperStyle(n,a,o,c,s,h),this.setElementStyle(r,a,o,c,s,h),i&&this.setBeforeStyle(i,o),e&&this.setAfterStyle(e,o),this.onElementAttached(r,i,e),n.style.display="",this.state.isFocused&&r.focus(),n.scrollTop=0,n.scrollLeft=0,this.tu&&setTimeout(this.nu,0)}}}},i.prototype.doSelect=function(){var t=this.Fe;t&&(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&t.select()},i.prototype.getClipperRect=function(n,i){for(var r=this.Le=this.Le||new t.Point(0,0),e=this.Pe=this.Pe||new t.Rectangle,u=n.x,s=n.y,h=u+n.width,o=s+n.height,a=this.parent;a instanceof li;){a.getClippingRect(this,e),r.set(e.x,e.y),a.toGlobal(r,r,!1);var c=(r.x*i|0)/i,f=(r.y*i|0)/i;r.set(e.x+e.width,e.y+e.height),a.toGlobal(r,r,!0);var l=r.x-c,v=r.y-f;u=Math.min(Math.max(u,c),c+l),s=Math.min(Math.max(s,f),f+v),h=Math.min(Math.max(h,c),c+l),o=Math.min(Math.max(o,f),f+v),a=a.parent}return e.x=u,e.y=s,e.width=h-u,e.height=o-s,e},i.prototype.getElementRect=function(n){var i=this.Le=this.Le||new t.Point(0,0),r=this.Ge=null!=this.Ge?this.Ge:new t.Rectangle;return i.set(0,0),this.toGlobal(i,i,!1),r.x=i.x,r.y=i.y,i.set(this.width,this.height),this.toGlobal(i,i,!0),r.width=i.x-r.x,r.height=i.y-r.y,r.x=(r.x*n|0)/n,r.y=(r.y*n|0)/n,r},i.prototype.cancel=function(){if(this.He){this.He=!1,this.onCancel();var t=B.getLayer(this);if(t){var n=t.view;this.iu===Or.FOCUSED&&document.activeElement===this.Fe&&n.focus();var i=t.renderer.plugins.interaction;this.containsPoint(i.mouse.global)&&!this.state.isHovered&&(this.state.isHovered=!0,n.style.cursor=this.cursor),t.update()}var r=this.Fe;null!=r&&this.onElementDetached(r,this.We,this.Je);var e=this.Be;null!=e&&(e.style.display="none")}},i.prototype.onStart=function(){},i.prototype.onCancel=function(){},i.prototype.onElementAttached=function(t,n,i){n&&n.addEventListener("focus",this.Ke),i&&i.addEventListener("focus",this.$e),t.addEventListener("focus",this.Ve,!0)},i.prototype.onElementDetached=function(t,n,i){n&&n.removeEventListener("focus",this.Ke),i&&i.removeEventListener("focus",this.$e),t.removeEventListener("focus",this.Ve,!0)},i.prototype.getElement=function(t){var n=this.Fe;if(null==n){var i=this.Ue;i&&(n=i(t),this.Fe=n)}return n},i.prototype.getClipper=function(){var t=this.Be;if(null==t){var n=this._e,i=B.getLayer(this);n&&i&&(t=n(i.getElementContainer()),this.Be=t)}return t},i.prototype.getBefore=function(t){var n=this.We;if(null==n){var i=this.Xe;i&&(n=i(t),this.We=n)}return n},i.prototype.getAfter=function(t){var n=this.Je;if(null==n){var i=this.Ze;i&&(n=i(t),this.Je=n)}return n},i.prototype.setElementStyle=function(t,n,i,r,e,u){var s=this.ze;return s?s(t,n,i,r,e,u):this.theme.setElementStyle(t,n,r,e,u)},i.prototype.setClipperStyle=function(t,n,i,r,e,u){var s=this.eu;return s?s(t,n,i,r,e,u):this.theme.setClipperStyle(t,n,r,e,u)},i.prototype.setBeforeStyle=function(t,n){var i=this.Ye;return i?i(t,n):this.theme.setBeforeStyle(t)},i.prototype.setAfterStyle=function(t,n){var i=this.qe;return i?i(t,n):this.theme.setAfterStyle(t)},i.prototype.onBeforeFocused=function(t){var n=B.getLayer(this);if(n){var i=n.getFocusController(),r=i.find(this,!1,!1,!1);n.view.focus(),i.focus(r),t.preventDefault(),t.stopImmediatePropagation()}},i.prototype.onAfterFocused=function(t){var n=B.getLayer(this);if(n){var i=n.getFocusController(),r=i.find(this,!1,!1,!0);n.view.focus(),i.focus(r),t.preventDefault(),t.stopImmediatePropagation()}},i.prototype.onElementFocused=function(t){this.iu===Or.ALWAYS&&(this.state.isFocused||this.focus())},i.prototype.onEndByBlured=function(){this.onEnd()},i.prototype.onEnd=function(){},i.prototype.end=function(){this.onEnd(),this.cancel()},i.prototype.select=function(){return this.He&&this.tu&&this.doSelect(),this},i.prototype.updateElement=function(t){if(this.He)if(this.worldVisible){var n=this.Fe,i=this.Be;if(n&&i){var r=t.resolution,e=this.getElementRect(r),u=this.getClipperRect(e,r),s=this.theme,h=this.state,o=this.Mn;this.setClipperStyle(i,h,s,o,e,u),this.setElementStyle(n,h,s,o,e,u)}}else this.cancel()},i.prototype.getType=function(){return"DHtmlElement"},i}(fr),Fr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;this.uu=null,this.su=n&&n.editing&&n.editing.validator||this.theme.getEditingValidator(),t.prototype.init.call(this,n),this.hu=n&&n.description||"",this.ou=n&&n.editing&&n.editing.formatter||n&&n.text&&n.text.formatter||this.theme.getEditingFormatter(),this.au=n&&n.editing&&n.editing.unformatter||this.theme.getEditingUnformatter(),this.lr=function(t){i.onInputKeyDown(t)},this.gr=function(){i.onInputChange()},this.dr=function(t){i.onInputInput(t)}},Object.defineProperty(n.prototype,"value",{get:function(){return this.Xr},set:function(t){this.text=t},enumerable:!1,configurable:!0}),n.prototype.createText=function(n){var i=t.prototype.createText.call(this,n);return this.He&&(i.visible=!1),i},n.prototype.onTextChange=function(){t.prototype.onTextChange.call(this),this.validate()},n.prototype.validate=function(){var t=this.su(this.Xr,this);return this.uu!==t&&(this.uu=t,this.state.isInvalid=null!=t,this.state.isHovered&&this.applyTitle()),t},n.prototype.applyTitle=function(){var n=this.uu;if(mt(n)){var i=B.getLayer(this);i&&(i.view.title=n)}else t.prototype.applyTitle.call(this)},n.prototype.onStart=function(){t.prototype.onStart.call(this);var n=this.yr;null!=n&&(n.visible=!1)},n.prototype.onCancel=function(){t.prototype.onCancel.call(this);var n=this.yr;null!=n&&(n.visible=!0)},n.prototype.onEnd=function(){t.prototype.onEnd.call(this),this.onInputChange()},n.prototype.onElementAttached=function(n,i,r){t.prototype.onElementAttached.call(this,n,i,r),n.type=this.getInputType(),n.value=this.ou(this.Xr,this),n.addEventListener("keydown",this.lr),n.addEventListener("change",this.gr),n.addEventListener("input",this.dr)},n.prototype.onElementDetached=function(n,i,r){t.prototype.onElementDetached.call(this,n,i,r),n.removeEventListener("keydown",this.lr),n.removeEventListener("change",this.gr),n.removeEventListener("input",this.dr)},n.prototype.onInputKeyDown=function(t){pt.isOkKey(t)?(this.end(),this.emit("enter",this)):pt.isCancelKey(t)&&this.cancel()},n.prototype.onInputChange=function(){if(this.He){var t=this.Fe;if(null!=t){var n=this.toValue(t.value),i=this.Xr;i!==n&&(this.text=n,this.emit("change",n,i,this))}}},n.prototype.onInputInput=function(t){t.target instanceof HTMLInputElement&&this.emit("input",this.toValue(t.target.value),this)},n.prototype.onDownThis=function(n){this.state.isFocused&&this.start(),t.prototype.onDownThis.call(this,n)},n.prototype.getType=function(){return"DInput"},n}(Pr),Ur=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.theme;this.cu=function(t,n){return null!=n?null!=n.step?n.step:t.getStep():null}(i,n),this.fu=function(t,n){return null!=n?null!=n.min?n.min:t.getMin():null}(i,n),this.lu=function(t,n){return null!=n?null!=n.max?n.max:t.getMax():null}(i,n)},Object.defineProperty(n.prototype,"step",{get:function(){return this.cu},set:function(t){this.cu!==t&&(this.cu=t,this.updateInputStep())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"min",{get:function(){return this.fu},set:function(t){this.fu!==t&&(this.fu=t,this.updateInputMin())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"max",{get:function(){return this.lu},set:function(t){this.lu!==t&&(this.lu=t,this.updateInputMax())},enumerable:!1,configurable:!0}),n.prototype.toValue=function(t){var n=this.au(t,this);return n==n?null!=this.fu&&n<this.fu?this.fu:null!=this.lu&&this.lu<n?this.lu:n:this.value},n.prototype.updateInputStep=function(){if(this.He){var t=this.Fe;t&&this.initInputStep(t)}},n.prototype.updateInputMin=function(){if(this.He){var t=this.Fe;t&&this.initInputMin(t)}},n.prototype.updateInputMax=function(){if(this.He){var t=this.Fe;t&&this.initInputMax(t)}},n.prototype.initInputStep=function(t){null!=this.cu?t.step=String(this.cu):t.removeAttribute("step")},n.prototype.initInputMin=function(t){null!=this.fu?t.min=""+this.fu:t.removeAttribute("min")},n.prototype.initInputMax=function(t){null!=this.lu?t.max=""+this.lu:t.removeAttribute("max")},n.prototype.onElementAttached=function(n,i,r){t.prototype.onElementAttached.call(this,n,i,r),this.initInputStep(n),this.initInputMin(n),this.initInputMax(n)},n.prototype.getInputType=function(){return"number"},n}(Fr),zr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DInputInteger"},n}(Ur),Gr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newInput=function(t){var n=this,i=new zr(this.toInputOptions(t));return i.on("enter",(function(){n.onOk()})),i},n.prototype.toInputOptions=function(t){var n=t||{};return void 0===n.weight&&(n.weight=1),n},n.prototype.getType=function(){return"DDialogInputInteger"},n}(Ir),Hr=function(t){function n(n){var i=t.call(this,n)||this;return i.initial=Mt.ofNumber(n.initial),i}return y(n,t),n.prototype.open=function(t,i){var r=n.DIALOG;if(null==r)r=new Gr({label:t}),n.DIALOG=r;else{var e=r.label;e&&(e.text=t)}return r.value=i,r.open()},n}(Lr),Vr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DInputReal"},n}(Ur),Wr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newInput=function(t){var n=this,i=new Vr(this.toInputOptions(t));return i.on("enter",(function(){n.onOk()})),i},n.prototype.toInputOptions=function(t){var n=t||{};return void 0===n.weight&&(n.weight=1),n},n.prototype.getType=function(){return"DDialogInputReal"},n}(Ir),Xr=function(t){function n(n){var i=t.call(this,n)||this;return i.initial=Mt.ofNumber(n.initial),i}return y(n,t),n.prototype.open=function(t,i){var r=n.DIALOG;if(null==r)r=new Wr({label:t}),n.DIALOG=r;else{var e=r.label;e&&(e.text=t)}return r.value=i,r.open()},n}(Lr),Yr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.toValue=function(t){return this.au(t,this)},n.prototype.getInputType=function(){return"text"},n.prototype.getType=function(){return"DInputText"},n}(Fr),Kr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newInput=function(t){var n=this,i=new Yr(this.toInputOptions(t));return i.on("enter",(function(){n.onOk()})),i},n.prototype.toInputOptions=function(t){var n=t||{};return void 0===n.weight&&(n.weight=1),n},n.prototype.getType=function(){return"DDialogInputText"},n}(Ir),Jr=function(t){function n(n){var i=t.call(this,n)||this;return i.initial=Mt.ofString(n.initial),i}return y(n,t),n.prototype.open=function(t,i){var r=n.DIALOG;if(null==r)r=new Kr({label:t}),n.DIALOG=r;else{var e=r.label;e&&(e.text=t)}return r.value=i,r.open()},n}(Lr),Zr=function(t){function n(n){return t.call(this,n,tt.NONE)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);null!=r&&ji.open(t,r)}},n}(xr),qr=function(t){function n(n){return t.call(this,n,tt.NONE)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);null!=r&&window.open(r)}},n}(xr),$r=function(t){function n(n){return t.call(this,n,tt.NONE)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);null!=r&&(window.location.href=r)}},n}(xr);!function(t){t[t.DIAGRAM=0]="DIAGRAM",t[t.PAGE=1]="PAGE",t[t.PAGE_INPLACE=2]="PAGE_INPLACE",t[t.DIALOG_TEXT=3]="DIALOG_TEXT",t[t.DIALOG_INTEGER=4]="DIALOG_INTEGER",t[t.DIALOG_REAL=5]="DIALOG_REAL",t[t.DIALOG_BOOLEAN=6]="DIALOG_BOOLEAN",t[t.DIALOG_DATE=7]="DIALOG_DATE",t[t.DIALOG_TIME=8]="DIALOG_TIME",t[t.DIALOG_DATETIME=9]="DIALOG_DATETIME"}(_r||(_r={}));var Qr,te=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonAmbient"},n}(vr),ne=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DPickerDatetimeButtonBack"},n}(te),ie=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onToggleStart=function(){this.state.isActive||(this.state.isActive=!0)},n.prototype.onToggleEnd=function(){this.emit(this.state.isActive?"active":"inactive",this)},n.prototype.getType=function(){return"DPickerDatetimeButtonDate"},n}(te),re=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DPickerDatetimeButtonNext"},n}(te),ee=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DPickerDatetimeLabel"},n}(Nr),ue=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DPickerDatetimeLabelDate"},n}(Nr),se=function(t){function n(n){var i=t.call(this,n)||this;return i.state.isFocusable=!1,i.renderable=!1,i}return y(n,t),n.prototype.getType=function(){return"DPickerDatetimeSpace"},n}(li);!function(t){t[t.NONE=0]="NONE",t[t.DATE=1]="DATE",t[t.HOURS=2]="HOURS",t[t.MINUTES=4]="MINUTES",t[t.SECONDS=8]="SECONDS",t[t.TIME=14]="TIME",t[t.ALL=15]="ALL"}(Qr||(Qr={}));var he,oe=function(){function t(){}return t.from=function(t,n){var i=null==n?void 0:n.mask;if(null==i){if(mt(t)){var r=Z.getInstance().get(t);if(null!=r)return r.getMask()}else if(null!=t)return t.getMask();return Qr.NONE}if(mt(i))return Qr[i];if(F(i))return i;for(var e=Qr.NONE,u=0,s=i.length;u<s;++u)e|=Qr[i[u]];return e},t}(),ae=function(){function t(t,n){this.vu=t&&void 0!==t.date?t.date:null,this.bu=!(!t||void 0===t.inclusive)&&t.inclusive,this.L=n}return Object.defineProperty(t.prototype,"date",{get:function(){return this.vu},set:function(t){this.vu!==t&&(this.vu=t,this.L())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inclusive",{get:function(){return this.bu},set:function(t){this.bu!==t&&(this.bu=t,this.L())},enumerable:!1,configurable:!0}),t}(),ce=function(){function t(t){this.o=t}return t.prototype.min=function(t){var n=this.o,i=n.lower,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&Qr.DATE){if(r.getFullYear()<t.getFullYear())return e.hour.min;if(r.getMonth()<t.getMonth())return e.hour.min;if(r.getDate()<t.getDate())return e.hour.min}var s=r.getHours();return i.inclusive||u&Qr.SECONDS&&r.getSeconds()<e.second.max||u&Qr.MINUTES&&r.getMinutes()<e.minute.max?s:s+1}return e.hour.min},t.prototype.max=function(t){var n=this.o,i=n.upper,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&Qr.DATE){if(t.getFullYear()<r.getFullYear())return e.hour.max;if(t.getMonth()<r.getMonth())return e.hour.max;if(t.getDate()<r.getDate())return e.hour.max}var s=r.getHours();return i.inclusive||u&Qr.SECONDS&&e.second.min<r.getSeconds()||u&Qr.MINUTES&&e.minute.min<r.getMinutes()?s:s-1}return e.hour.max},t}(),fe=function(){function t(t){this.o=t}return t.prototype.min=function(t){var n=this.o,i=n.lower,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&Qr.DATE){if(r.getFullYear()<t.getFullYear())return e.minute.min;if(r.getMonth()<t.getMonth())return e.minute.min;if(r.getDate()<t.getDate())return e.minute.min}if(u&Qr.HOURS&&r.getHours()<t.getHours())return e.minute.min;var s=r.getMinutes();return i.inclusive||u&Qr.SECONDS&&r.getSeconds()<e.second.max?s:s+1}return e.minute.min},t.prototype.max=function(t){var n=this.o,i=n.upper,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&Qr.DATE){if(t.getFullYear()<r.getFullYear())return e.minute.max;if(t.getMonth()<r.getMonth())return e.minute.max;if(t.getDate()<r.getDate())return e.minute.max}if(u&Qr.HOURS&&t.getHours()<r.getHours())return e.minute.max;var s=r.getMinutes();return i.inclusive||u&Qr.SECONDS&&e.second.min<r.getSeconds()?s:s-1}return e.minute.max},t}(),le=function(){function t(t){this.o=t}return t.prototype.min=function(t){var n=this.o,i=n.lower,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&Qr.DATE){if(r.getFullYear()<t.getFullYear())return e.second.min;if(r.getMonth()<t.getMonth())return e.second.min;if(r.getDate()<t.getDate())return e.second.min}return u&Qr.HOURS&&r.getHours()<t.getHours()||u&Qr.MINUTES&&r.getMinutes()<t.getMinutes()?e.second.min:r.getSeconds()+(i.inclusive?0:1)}return e.second.min},t.prototype.max=function(t){var n=this.o,i=n.upper,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&Qr.DATE){if(t.getFullYear()<r.getFullYear())return e.second.max;if(t.getMonth()<r.getMonth())return e.second.max;if(t.getDate()<r.getDate())return e.second.max}return u&Qr.HOURS&&t.getHours()<r.getHours()||u&Qr.MINUTES&&t.getMinutes()<r.getMinutes()?e.second.max:r.getSeconds()-(i.inclusive?0:1)}return e.second.max},t}(),ve=function(){function t(t,n){this.constant=this.newConstant(),this.lower=new ae(t&&t.lower,n),this.upper=new ae(t&&t.upper,n),this.mask=Qr.ALL,this.hours=new ce(this),this.minutes=new fe(this),this.seconds=new le(this)}return t.prototype.newConstant=function(){return{second:{min:0,max:59},minute:{min:0,max:59},hour:{min:0,max:23}}},t.prototype.adjust=function(t){var n=this.test(t);if(n<0){var i=this.lower,r=i.date;if(r)return t.setTime(r.getTime()),i.inclusive||((e=this.mask)&Qr.SECONDS?t.setSeconds(r.getSeconds()+1):e&Qr.MINUTES?t.setMinutes(r.getMinutes()+1):e&Qr.HOURS?t.setHours(r.getHours()+1):e&Qr.DATE&&t.setDate(r.getDate()+1)),!0}else if(0<n){var e,u=this.upper,s=u.date;if(s)return t.setTime(s.getTime()),u.inclusive||((e=this.mask)&Qr.SECONDS?t.setSeconds(s.getSeconds()-1):e&Qr.MINUTES?t.setMinutes(s.getMinutes()-1):e&Qr.HOURS?t.setHours(s.getHours()-1):e&Qr.DATE&&t.setDate(s.getDate()-1)),!0}return!1},t.prototype.compare=function(t,n){var i=this.mask;if(i&Qr.DATE){var r,e,u,s,h=t.getFullYear(),o=n.getFullYear();if(h!==o)return h<o?-1:1;if((r=t.getMonth())!==(e=n.getMonth()))return r<e?-1:1;if((u=t.getDate())!==(s=n.getDate()))return u<s?-1:1}if(i&Qr.HOURS){var a=t.getHours(),c=n.getHours();if(a!==c)return a<c?-1:1}return i&Qr.MINUTES&&(r=t.getMinutes())!==(e=n.getMinutes())?r<e?-1:1:i&Qr.SECONDS&&(u=t.getSeconds())!==(s=n.getSeconds())?u<s?-1:1:0},t.prototype.test=function(t){var n=this.lower,i=n.date;if(null!=i){var r=this.compare(i,t);return n.inclusive?r<=0?0:-1:r<0?0:-1}var e=this.upper,u=e.date;return null!=u?(r=this.compare(t,u),e.inclusive?r<=0?0:1:r<0?0:1):0},t.prototype.contains=function(t){return 0===this.test(t)},t}(),be=function(t,n,i){return t?{date:void 0!==t.date?t.date:n,inclusive:void 0!==t.inclusive?t.inclusive:i}:{date:n,inclusive:i}},ge=function(t){function n(n){var i=t.call(this,n)||this;return i.onNewChanged(),i}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.state.isFocusable=!1;var r=this.theme;this.gu=new Date;var e=this.gu.getTime();this.du=new Date(e),this.mu=new ve(function(t,n){return n?{lower:be(n.lower,t.getLowerBound(),t.isLowerBoundInclusive()),upper:be(n.upper,t.getUpperBound(),t.isUpperBoundInclusive())}:{lower:{date:t.getLowerBound(),inclusive:t.isLowerBoundInclusive()},upper:{date:t.getUpperBound(),inclusive:t.isUpperBoundInclusive()}}}(r,n&&n.bounds),(function(){i.onNewChanged()}));var u=n&&null!=n.margin?n.margin:r.getMargin();new Tr({parent:this,x:"padding",y:"padding",width:"auto",height:"auto",margin:u,children:this.newChildren(r,n,u)})},Object.defineProperty(n.prototype,"current",{get:function(){return this.gu},set:function(t){this.gu.getTime()!==t.getTime()&&(this.gu=t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.du},set:function(t){this.du.getTime()!==t.getTime()&&(this.du=t,this.onNewChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"bounds",{get:function(){return this.mu},enumerable:!1,configurable:!0}),n.prototype.hasHours=function(){return null!=this.wu},n.prototype.hasMinutes=function(){return null!=this.pu},n.prototype.hasSeconds=function(){return null!=this.Ou},n.prototype.reset=function(){var t=this.gu.getTime();this.du.setTime(t),this.onReset()},n.prototype.onReset=function(){this.onNewChanged()},n.prototype.onNewChanged=function(){var t=this.du,n=this.mu;n.adjust(this.du);var i=this.wu;if(i){var r=n.hours;i.value=t.getHours(),i.min=r.min(t),i.max=r.max(t)}var e=this.pu;if(e){var u=n.minutes;e.value=t.getMinutes(),e.min=u.min(t),e.max=u.max(t)}var s=this.Ou;if(s){var h=n.seconds;s.value=t.getSeconds(),s.min=h.min(t),s.max=h.max(t)}},n.prototype.newChildren=function(t,n,i){var r=oe.from(t,n);return this.mu.mask=r,this.wu=r&Qr.HOURS?this.newInputHours(t,n):null,this.pu=r&Qr.MINUTES?this.newInputMinutes(t,n):null,this.Ou=r&Qr.SECONDS?this.newInputSeconds(t,n):null,[this.newTimeLayout(this.wu,this.pu,this.Ou,i)]},n.prototype.newTimeLayout=function(t,n,i,r){var e=this.newTimeLayoutChildren(t,n,i);return 0<e.length?new Sr({width:this.getTimeLayoutWidth(),height:this.getTimeLayoutHeight(),margin:r,children:e}):null},n.prototype.getTimeLayoutWidth=function(){return"auto"},n.prototype.getTimeLayoutHeight=function(){return"auto"},n.prototype.newTimeLayoutChildren=function(t,n,i){var r=[];return null!=t&&r.push(t),null!=n&&(0<r.length&&r.push(this.newMinuteSeparator()),r.push(n)),null!=i&&(0<r.length&&r.push(this.newSecondSeparator()),r.push(i)),r},n.prototype.newMinuteSeparator=function(){return new Nr({width:"auto",text:{value:this.getMinuteSeparator()}})},n.prototype.getMinuteSeparator=function(){return":"},n.prototype.newSecondSeparator=function(){return new Nr({width:"auto",text:{value:this.getSecondSeparator()}})},n.prototype.getSecondSeparator=function(){return":"},n.prototype.adjustInputOptions=function(t,n,i){return null==n.step&&(n.step=1),null==n.min&&(n.min=0),null==n.max&&(n.max=i),n},n.prototype.newInputHours=function(t,n){var i=this,r=n&&n.hours||t.getHoursOptions(),e=this.mu.constant.hour.max,u=new zr(this.adjustInputOptions(t,r,e));return u.on("change",(function(t){i.onHoursChanged(t)})),u},n.prototype.onHoursChanged=function(t){this.du.setHours(t),this.onNewChanged()},n.prototype.newInputMinutes=function(t,n){var i=this,r=n&&n.minutes||t.getMinutesOptions(),e=this.mu.constant.minute.max,u=new zr(this.adjustInputOptions(t,r,e));return u.on("change",(function(t){i.onMinutesChanged(t)})),u},n.prototype.onMinutesChanged=function(t){this.du.setMinutes(t),this.onNewChanged()},n.prototype.newInputSeconds=function(t,n){var i=this,r=n&&n.seconds||t.getSecondsOptions(),e=this.mu.constant.second.max,u=new zr(this.adjustInputOptions(t,r,e));return u.on("change",(function(t){i.onSecondsChanged(t)})),u},n.prototype.onSecondsChanged=function(t){this.du.setSeconds(t)},n.prototype.getType=function(){return"DPickerTime"},n}(li),de=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.Du=new Date(this.gu.getTime())},n.prototype.newChildren=function(n,i,r){this.Eu=this.newDateButtons(n,i),this.Mu=i&&i.date&&i.date.decorator||n.getDateDecorator(),this.je=this.newLabel(n,i);var e=t.prototype.newChildren.call(this,n,i,r);return e.unshift(new Sr({width:"100%",height:"auto",children:[this.newBackButton(n,i),this.je,this.newNextButton(n,i)]}),new Sr({width:"auto",height:"auto",margin:r,children:this.newDateLabels(n,i)}),new Tr({width:"auto",height:"auto",margin:r,column:7,children:this.Eu})),e},Object.defineProperty(n.prototype,"page",{get:function(){return this.Du},set:function(t){this.Du.getTime()!==t.getTime()&&(this.Du=t,this.onPageChanged())},enumerable:!1,configurable:!0}),n.prototype.onReset=function(){this.Du.setTime(this.gu.getTime()),t.prototype.onReset.call(this)},n.prototype.next=function(){var t=this.Du;t.setFullYear(t.getFullYear(),t.getMonth()+1,1),t.setHours(0,0,0,0),this.onPageChanged()},n.prototype.back=function(){var t=this.Du;t.setFullYear(t.getFullYear(),t.getMonth()-1,1),t.setHours(0,0,0,0),this.onPageChanged()},n.prototype.onNewChanged=function(){this.mu.adjust(this.Du),t.prototype.onNewChanged.call(this),this.onPageChanged()},n.prototype.onPageChanged=function(){var t=this.Eu,n=this.mu,i=this.Du,r=this.du,e=new Date(i.getTime());e.setDate(1),e.setHours(0,0,0,0);for(var u=this.theme,s=(e.getDay()-u.getDayStart()+7)%7,h=0;h<s;++h)t[h].show();for(h=s;h<7;++h)t[h].hide();var o=this.Mu;e.setFullYear(e.getFullYear(),e.getMonth()+1,0);var a=e.getDate(),c=r.getFullYear()===e.getFullYear()&&r.getMonth()===e.getMonth()?r.getDate():0;for(h=0;h<a;++h)e.setDate(h+1),(f=t[h+7]).state.isActive=c===h+1,f.state.isDisabled=!n.contains(e),f.show(),o(e,f);for(h=a;h<31;++h){var f;(f=t[h+7]).state.isActive=!1,f.hide()}e.setTime(i.getTime()),this.je.text=e},n.prototype.adjustInputOptions=function(n,i,r){return null==i.weight&&(i.weight=1),t.prototype.adjustInputOptions.call(this,n,i,r)},n.prototype.getTimeLayoutWidth=function(){return"100%"},n.prototype.toLabelOptions=function(t,n){var i=n&&n.label||{};void 0===i.weight&&(i.weight=1),void 0===i.padding&&(i.padding=0);var r=i.text=i.text||{},e=r.align=r.align||{};return void 0===e.horizontal&&(e.horizontal="CENTER"),void 0===r.formatter&&(r.formatter=t.getLabelFormatter()),i},n.prototype.newLabel=function(t,n){return new ee(this.toLabelOptions(t,n))},n.prototype.newBackButton=function(t,n){var i=this,r=n&&void 0!==n.back?n.back:t.getBackButtonOptions();if(null!=r){var e=new ne(r);return e.on("active",(function(){i.back()})),e}return null},n.prototype.newNextButton=function(t,n){var i=this,r=n&&void 0!==n.next?n.next:t.getNextButtonOptions();if(null!=r){var e=new re(r);return e.on("active",(function(){i.next()})),e}return null},n.prototype.newDateLabels=function(t,n){for(var i=t.getDayLabels(),r=t.getDayStart(),e=[],u=0;u<7;++u){var s=i[(r+u)%7];e.push(this.newDateLabel(t,n,s))}return e},n.prototype.newDateLabel=function(t,n,i){return new ue({text:{value:i}})},n.prototype.newDateButtons=function(t,n){for(var i=[],r=0;r<7;++r)i.push(this.newSpace(t,n));for(r=1;r<=31;++r)i.push(this.newDateButton(t,n,r));return i},n.prototype.newSpace=function(t,n){return new se},n.prototype.newDateButton=function(t,n,i){var r=this;return new ie({text:{value:String(i)},on:{active:function(){r.onDateButtonClicked(i)}}})},n.prototype.onDateButtonClicked=function(t){var n=this.du;if(n.getDate()!==t){var i=this.Du;n.setFullYear(i.getFullYear()),n.setMonth(i.getMonth()),n.setDate(t),this.onNewChanged()}},n.prototype.getType=function(){return"DPickerDatetime"},n}(ge),me=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new de(i&&i.picker);this.Su=r,n.addChild(r)},Object.defineProperty(n.prototype,"current",{get:function(){return this.Su.current},set:function(t){this.Su.current=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Su.new},set:function(t){this.Su.new=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"page",{get:function(){return this.Su.new},set:function(t){this.Su.page=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Su},enumerable:!1,configurable:!0}),n.prototype.doResolve=function(t){t(this.new)},n.prototype.getType=function(){return"DDialogDatetime"},n}(jr),we=function(t){function n(n){var i=t.call(this,n)||this;return i.initial=Mt.ofUnknown(n.initial),i}return y(n,t),n.prototype.open=function(t,i){var r=n.DIALOG;return null==r&&(r=new me,n.DIALOG=r),r.new=r.current=this.toDate(i),r.open().then((function(t){return t.toISOString()}))},n.prototype.toDate=function(t){return mt(t)||F(t)?new Date(t):t instanceof Date?t:new Date},n}(Lr),pe=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new ge(i&&i.picker);this.Su=r,n.addChild(r)},Object.defineProperty(n.prototype,"current",{get:function(){return this.Su.current},set:function(t){this.Su.current=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Su.new},set:function(t){this.Su.new=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Su},enumerable:!1,configurable:!0}),n.prototype.doResolve=function(t){t(this.new)},n.prototype.getType=function(){return"DDialogTime"},n}(jr),Oe=function(t){return t!=t},De=function(t){function n(n){var i=t.call(this,n)||this;return i.initial=Mt.ofUnknown(n.initial),i}return y(n,t),n.prototype.open=function(t,i){var r=this,e=n.DIALOG;return null==e&&(e=new pe,n.DIALOG=e),e.new=e.current=this.toDate(i),e.open().then((function(t){return r.getFormatter().format(t.getTime(),0)}))},n.prototype.toDate=function(t){if(F(t))return new Date(t);if(mt(t)){var n=new Date,i=this.getPattern().exec(t);if(null!=i){var r=this.toHours(i[1]);null!=r&&n.setHours(r);var e=this.toMinutes(i[2]);null!=e&&n.setMinutes(e);var u=this.toSeconds(i[3]);null!=u&&n.setSeconds(u);var s=this.toMilliseconds(i[4]);null!=s&&n.setMilliseconds(s)}return n}return t instanceof Date?t:new Date},n.prototype.toHours=function(t){return this.toNumber(t,0,23)},n.prototype.toMinutes=function(t){return this.toNumber(t,0,59)},n.prototype.toSeconds=function(t){return this.toNumber(t,0,59)},n.prototype.toMilliseconds=function(t){var n=this.toNumber(t,0,999);if(null!=n){var i=t.length;return 1===i?100*n:2===i?10*n:n}return n},n.prototype.toNumber=function(t,n,i){if(null!=t){var r=+t;if(!Oe(r))return Math.min(i,Math.max(n,r))}return null},n.prototype.getPattern=function(){var t=n.PATTERN;return null==t&&(t=this.newPattern(),n.PATTERN=t),t},n.prototype.newPattern=function(){return/^\s*(?:(\d+)(?::(\d+)(?::(\d+))?)?)?(?:\.(\d+))?\s*$/},n.prototype.getFormatter=function(){var t=n.FORMATTER;return null==t&&(t=this.newFormatter(),n.FORMATTER=t),t},n.prototype.newFormatter=function(){return yn.create("%Hm")},n}(Lr),Ee=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DPickerDate"},n}(de),Me=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new Ee(i&&i.picker);this.Su=r,n.addChild(r)},Object.defineProperty(n.prototype,"current",{get:function(){return this.Su.current},set:function(t){this.Su.current=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Su.new},set:function(t){this.Su.new=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"page",{get:function(){return this.Su.new},set:function(t){this.Su.page=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Su},enumerable:!1,configurable:!0}),n.prototype.doResolve=function(t){t(this.new)},n.prototype.getType=function(){return"DDialogDate"},n}(jr),Se=function(t){function n(n){var i=t.call(this,n)||this;return i.initial=Mt.ofUnknown(n.initial),i}return y(n,t),n.prototype.open=function(t,i){var r=this,e=n.DIALOG;return null==e&&(e=new Me,n.DIALOG=e),e.new=e.current=this.toDate(i),e.open().then((function(t){return r.getFormatter().format(t.getTime(),0)}))},n.prototype.toDate=function(t){return mt(t)||F(t)?new Date(t):t instanceof Date?t:new Date},n.prototype.getFormatter=function(){var t=n.FORMATTER;return null==t&&(t=this.newFormatter(),n.FORMATTER=t),t},n.prototype.newFormatter=function(){return yn.create("%Y-%M-%D")},n}(Lr),Te=function(t){function n(n,i,r,e,u){var s=t.call(this,kt.OPEN,i,n)||this;return s.target=r,s.onInputAction=e,s.initial=u,s}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.target===i.target},n.prototype.toRuntime=function(){switch(this.subtype){case _r.DIAGRAM:return new Zr(this);case _r.PAGE:return new qr(this);case _r.PAGE_INPLACE:return new $r(this);case _r.DIALOG_TEXT:return new Jr(this);case _r.DIALOG_INTEGER:return new Hr(this);case _r.DIALOG_REAL:return new Xr(this);case _r.DIALOG_BOOLEAN:return new Br(this);case _r.DIALOG_DATE:return new Se(this);case _r.DIALOG_TIME:return new De(this);case _r.DIALOG_DATETIME:return new we(this)}},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.target),r=t.addResource(this.initial);return t.addResource("["+this.type+","+n+","+this.subtype+","+i+","+this.onInputAction+","+r+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources),e=_t.toResource(3,t,i.resources),u=_t.toResource(5,t,i.resources);return new n(t[2],r,e,t[4],u)},n}(Lt);!function(t){t[t.SHOW=0]="SHOW",t[t.HIDE=1]="HIDE"}(he||(he={}));var je,Ne,Ie=function(t){function n(n){var i=t.call(this,n,tt.VISIBILITY)||this;return i.visibility=n.subtype===he.SHOW,i}return y(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&(t.visible=this.visibility,n.written|=this.reset)},n}(Tt),Ce=function(t){function n(n,i){return t.call(this,kt.SHOW_HIDE,i,n)||this}return y(n,t),n.prototype.toRuntime=function(){return new Ie(this)},n.prototype.serialize=function(t){var n=t.addResource(this.condition);return t.addResource("["+this.type+","+n+","+this.subtype+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources);return new n(t[2],r)},n}(Lt),Ae=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.amount=Mt.ofNumber(n.amount),r}return y(n,t),n}(Tt),Re=function(t){function n(n){return t.call(this,n,tt.POSITION_X)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i);t.transform.position.x=r,n.written|=this.reset}},n}(Ae),ye=function(t){function n(n){return t.call(this,n,tt.POSITION_Y)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i);t.transform.position.y=r,n.written|=this.reset}},n}(Ae),ke=function(t){function n(n){return t.call(this,n,tt.POSITION)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform.position,u=0!=(n.written&tt.POSITION_X),s=0!=(n.written&tt.POSITION_Y),h=u?e.x:n.x,o=s?e.y:n.y;t.updateTransform();var a=t.transform.localTransform;e.set(h-a.c*r,o-a.d*r),n.written|=this.reset}},n}(Ae),xe=function(t){function n(n){return t.call(this,n,tt.POSITION)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform.position,u=0!=(n.written&tt.POSITION_X),s=0!=(n.written&tt.POSITION_Y),h=u?e.x:n.x,o=s?e.y:n.y;t.updateTransform();var a=t.transform.localTransform;e.set(h+a.a*r,o+a.b*r),n.written|=this.reset}},n}(Ae),Le=function(t){function n(n){return t.call(this,n,tt.POSITION_X)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=0!=(n.written&tt.POSITION_X),u=t.transform.position,s=e?u.x:n.x;u.x=s+r,n.written|=this.reset}},n}(Ae),Be=function(t){function n(n){return t.call(this,n,tt.POSITION_Y)||this}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=0!=(n.written&tt.POSITION_Y),u=t.transform.position,s=e?u.y:n.y;u.y=s+r,n.written|=this.reset}},n}(Ae),_e=function(t){function n(n,i,r,e){var u=t.call(this,n,i,r)||this;return u.opetype=e,u}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.opetype===i.opetype},n}(Lt);!function(t){t[t.RELATIVE_X=0]="RELATIVE_X",t[t.RELATIVE_Y=1]="RELATIVE_Y",t[t.ABSOLUTE_X=2]="ABSOLUTE_X",t[t.ABSOLUTE_Y=3]="ABSOLUTE_Y",t[t.FORWARD_OR_BACKWARD=4]="FORWARD_OR_BACKWARD",t[t.LEFT_OR_RIGHT=5]="LEFT_OR_RIGHT"}(je||(je={})),function(t){t[t.RESIZE=0]="RESIZE",t[t.MOVE=1]="MOVE",t[t.ROTATE=2]="ROTATE"}(Ne||(Ne={}));var Pe,Fe=function(t){function n(n,i,r){var e=t.call(this,kt.TRANSFORM,i,Ne.MOVE,n)||this;return e.amount=r,e}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.amount===i.amount},n.prototype.toRuntime=function(){switch(this.opetype){case je.ABSOLUTE_X:return new Re(this);case je.ABSOLUTE_Y:return new ye(this);case je.FORWARD_OR_BACKWARD:return new ke(this);case je.LEFT_OR_RIGHT:return new xe(this);case je.RELATIVE_X:return new Le(this);case je.RELATIVE_Y:return new Be(this)}},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.amount);return t.addResource("["+this.type+","+n+","+this.subtype+","+this.opetype+","+i+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources),e=_t.toResource(4,t,i.resources);return new n(t[3],r,e)},n}(_e),Ue=function(){function t(){}return t.toRounded=function(t){return Math.round(100*t)/100},t.toNormalized=function(n){return Math.abs(n)<.001?n<0?-.001:.001:t.toRounded(n)},t.resize=function(n,i,r,e,u){n.disallowUploadedUpdate();var s=n.transform.position;if(e){var h=Math.abs(r.x-i.x),o=Math.abs(r.y-i.y);if(u){var a=(l=Math.max(h,o))+l;n.size.set(t.toNormalized(a),t.toNormalized(a)),s.set(t.toRounded(i.x),t.toRounded(i.y))}else n.size.set(t.toNormalized(h+h),t.toNormalized(o+o)),s.set(t.toRounded(i.x),t.toRounded(i.y))}else if(u){h=r.x-i.x,o=r.y-i.y,a=Math.max(Math.abs(h),Math.abs(o));var c=i.x+(h<0?-a:+a),f=i.y+(o<0?-a:+a),l=.5*a,v=Math.min(i.x,c)+l,b=Math.min(i.y,f)+l;n.size.set(t.toNormalized(a),t.toNormalized(a)),s.set(t.toRounded(v),t.toRounded(b))}else{var g=Math.min(i.x,r.x),d=Math.min(i.y,r.y),m=Math.max(i.x,r.x)-g,w=Math.max(i.y,r.y)-d,p=.5*m,O=.5*w;n.size.set(t.toNormalized(m),t.toNormalized(w)),s.set(t.toRounded(g+p),t.toRounded(d+O))}n.allowUploadedUpdate()},t}();!function(t){t[t.RELATIVE_SIZE=0]="RELATIVE_SIZE",t[t.RELATIVE_HEIGHT=1]="RELATIVE_HEIGHT",t[t.RELATIVE_WIDTH=2]="RELATIVE_WIDTH",t[t.ABSOLUTE_SIZE=3]="ABSOLUTE_SIZE",t[t.ABSOLUTE_HEIGHT=4]="ABSOLUTE_HEIGHT",t[t.ABSOLUTE_WIDTH=5]="ABSOLUTE_WIDTH"}(Pe||(Pe={}));var ze,Ge=function(t){function n(n,i){var r=t.call(this,n,i)||this;switch(n.opetype){case Pe.RELATIVE_SIZE:r.size=Mt.ofNumberOrOne(n.amount);break;case Pe.ABSOLUTE_SIZE:r.size=Mt.ofNumberOrOneHundred(n.amount);break;case Pe.RELATIVE_HEIGHT:r.size=Mt.ofNumberOrOne(n.amount);break;case Pe.ABSOLUTE_HEIGHT:r.size=Mt.ofNumberOrOneHundred(n.amount);break;case Pe.RELATIVE_WIDTH:r.size=Mt.ofNumberOrOne(n.amount);break;case Pe.ABSOLUTE_WIDTH:r.size=Mt.ofNumberOrOneHundred(n.amount);break;default:r.size=Mt.ONE}return r}return y(n,t),n.prototype.adjustPosition=function(t,n,i,r,e,u){var s=(-.5+e)*i,h=(-.5+u)*r;t.updateTransform();var o=t.transform,a=o.position,c=o.localTransform,f=0!=(n.written&tt.POSITION_X),l=0!=(n.written&tt.POSITION_Y),v=f?a.x:n.x,b=l?a.y:n.y;n.written|=tt.POSITION,a.set(v+s*c.a+h*c.c,b+s*c.b+h*c.d)},n}(Tt),He=function(t){function n(n){var i=t.call(this,n,tt.HEIGHT)||this;return i.origin=n.originY,i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&tt.HEIGHT)?e.y:n.size.y;e.y=Ue.toNormalized(r),n.written|=tt.HEIGHT,this.adjustPosition(t,n,0,u-e.y,.5,this.origin)}},n}(Ge),Ve=function(t){function n(n){var i=t.call(this,n,tt.HEIGHT)||this;return i.origin=n.originY,i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&tt.HEIGHT)?e.y:n.size.y;e.y=Ue.toNormalized(u*r),n.written|=tt.HEIGHT,this.adjustPosition(t,n,0,u-e.y,.5,this.origin)}},n}(Ge),We=function(t){function n(n){var i=t.call(this,n,tt.SIZE)||this;return i.originX=n.originX,i.originY=n.originY,i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=Ue.toNormalized(this.size(t,i)),e=t.size,u=0!=(n.written&tt.WIDTH),s=0!=(n.written&tt.HEIGHT),h=u?e.x:n.size.x,o=s?e.y:n.size.y;e.set(r,r),n.written|=tt.SIZE,this.adjustPosition(t,n,h-e.x,o-e.y,this.originX,this.originY)}},n}(Ge),Xe=function(t){function n(n){var i=t.call(this,n,tt.SIZE)||this;return i.originX=n.originX,i.originY=n.originY,i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&tt.WIDTH),s=0!=(n.written&tt.HEIGHT),h=u?e.x:n.size.x,o=s?e.y:n.size.y;e.set(Ue.toNormalized(h*r),Ue.toNormalized(o*r)),n.written|=tt.SIZE,this.adjustPosition(t,n,h-e.x,o-e.y,this.originX,this.originY)}},n}(Ge),Ye=function(t){function n(n){var i=t.call(this,n,tt.WIDTH)||this;return i.origin=n.originX,i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&tt.WIDTH)?e.x:n.size.x;e.x=Ue.toNormalized(r),n.written|=tt.WIDTH,this.adjustPosition(t,n,u-e.x,0,this.origin,.5)}},n}(Ge),Ke=function(t){function n(n){var i=t.call(this,n,tt.WIDTH)||this;return i.origin=n.originX,i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&tt.WIDTH)?e.x:n.size.x;e.x=Ue.toNormalized(u*r),n.written|=tt.WIDTH,this.adjustPosition(t,n,u-e.x,0,this.origin,.5)}},n}(Ge),Je=function(t){function n(n,i,r,e,u){var s=t.call(this,kt.TRANSFORM,i,Ne.RESIZE,n)||this;return s.originX=r,s.originY=e,s.amount=u,s}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.originX===i.originX&&this.originY===i.originY&&this.amount===i.amount},n.prototype.toRuntime=function(){switch(this.opetype){case Pe.ABSOLUTE_HEIGHT:return new He(this);case Pe.ABSOLUTE_WIDTH:return new Ye(this);case Pe.ABSOLUTE_SIZE:return new We(this);case Pe.RELATIVE_HEIGHT:return new Ve(this);case Pe.RELATIVE_WIDTH:return new Ke(this);case Pe.RELATIVE_SIZE:return new Xe(this)}},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.amount);return t.addResource("["+this.type+","+n+","+this.subtype+","+this.opetype+","+this.originX+","+this.originY+","+i+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources),e=_t.toResource(6,t,i.resources);return new n(t[3],r,t[4],t[5],e)},n}(_e),Ze=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.originX=n.originX,r.originY=n.originY,r.amount=Mt.ofNumber("("+n.amount+") * (Math.PI / 180)"),r}return y(n,t),n.prototype.adjustPosition=function(t,n,i,r,e,u){var s=0!=(n.written&tt.WIDTH),h=0!=(n.written&tt.HEIGHT),o=(-.5+e)*(s?t.size.x:n.size.x),a=(-.5+u)*(h?t.size.y:n.size.y),c=Math.sin(i)-Math.sin(r),f=Math.cos(i)-Math.cos(r),l=t.transform.position,v=0!=(n.written&tt.POSITION_X),b=0!=(n.written&tt.POSITION_Y),g=v?l.x:n.x,d=b?l.y:n.y;n.written|=tt.POSITION,l.set(g+o*f-a*c,d+o*c+a*f)},n}(Tt),qe=function(t){function n(n){var i=t.call(this,n,tt.ROTATION)||this;return i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform,u=0!=(n.written&tt.ROTATION)?e.rotation:n.rotation;e.rotation=r,n.written|=tt.ROTATION,this.adjustPosition(t,n,u,r,this.originX,this.originY)}},n}(Ze),$e=function(t){function n(n){var i=t.call(this,n,tt.ROTATION)||this;return i.reset|=tt.POSITION,i}return y(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform,u=0!=(n.written&tt.ROTATION)?e.rotation:n.rotation;e.rotation=u+r,n.written|=tt.ROTATION,this.adjustPosition(t,n,u,e.rotation,this.originX,this.originY)}},n}(Ze);!function(t){t[t.RELATIVE=0]="RELATIVE",t[t.ABSOLUTE=1]="ABSOLUTE"}(ze||(ze={}));var Qe,tu=function(t){function n(n,i,r,e,u){var s=t.call(this,kt.TRANSFORM,i,Ne.ROTATE,n)||this;return s.originX=r,s.originY=e,s.amount=u,s}return y(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.originX===i.originX&&this.originY===i.originY&&this.amount===i.amount},n.prototype.toRuntime=function(){switch(this.opetype){case ze.ABSOLUTE:return new qe(this);case ze.RELATIVE:return new $e(this)}},n.prototype.serialize=function(t){var n=t.addResource(this.condition),i=t.addResource(this.amount);return t.addResource("["+this.type+","+n+","+this.subtype+","+this.opetype+","+this.originX+","+this.originY+","+i+"]")},n.deserialize=function(t,i){var r=_t.toResource(1,t,i.resources),e=_t.toResource(6,t,i.resources);return new n(t[3],r,t[4],t[5],e)},n}(_e),nu=function(){function t(){}return t.toSerialized=function(t){try{var n=JSON.parse(t);if(wt(n)){for(var i=0,r=n.length;i<r;++i)if(!F(n[i]))return null;if(2<=n.length)return n}return null}catch(t){return null}},t.deserialize=function(t,n){var i=n.getAction(t);if(null!=i)return i;var r=n.resources[t];if(null!=r){var e=this.toSerialized(r);if(null!=e)switch(e[0]){case kt.SHOW_HIDE:return Ce.deserialize(e,n);case kt.BLINK:return Pt.deserialize(e,n);case kt.CHANGE_COLOR:case kt.CHANGE_COLOR_LEGACY:switch(e[3]){case Bt.COLOR_AND_ALPHA:case Bt.COLOR:case Bt.ALPHA:return Xt.deserialize(e,n);case Bt.CODE:return Zt.deserialize(e,n);case Bt.BRIGHTNESS:return Kt.deserialize(e,n)}case kt.CHANGE_TEXT:return Bn.deserialize(e,n);case kt.CHANGE_CURSOR:return $t.deserialize(e,n);case kt.EMIT_EVENT:return Ii.deserialize(e,n);case kt.OPEN:return Te.deserialize(e,n);case kt.TRANSFORM:switch(e[2]){case Ne.MOVE:return Fe.deserialize(e,n);case Ne.RESIZE:return Je.deserialize(e,n);case Ne.ROTATE:return tu.deserialize(e,n)}break;case kt.MISC:return $i.deserialize(e,n)}}return new Ce(he.SHOW,"")},t}(),iu=function(){function t(){}return t.toImageElement=function(n){var i=t.imageElements,r=i[n];if(null!=r)return r instanceof HTMLImageElement?Promise.resolve(r):r;var e=new Promise((function(t,r){var e=document.createElement("img");e.onload=function(){i[n]=e,t(e)},e.onabort=e.onerror=function(){r()},e.src=n}));return i[n]=e,e},t.imageElements={},t}(),ru=function(){function t(){}return t.toShape=function(t,n){var r=i[t[0]];return null!=r?r(t,n):null},t.deserialize=function(n,i,r){r.id=i.resources[n[1]]||"",r.transform.position.set(n[2],n[3]),r.transform.rotation=n[6],r.transform.skew.set(n[7],n[7]),r.transform.pivot.set(n[21],n[22]),r.size.set(Ue.toNormalized(n[4]),Ue.toNormalized(n[5])),r.fill.deserialize(n[8],i),r.stroke.deserialize(n[9],i),r.cursor=i.resources[n[10]]||"",r.text.deserialize(n[11],i),r.tag.deserialize(n[12],i),r.radius=n[13],r.corner=n[14],r.interactive=!!(1&n[23]),r.state.isFocusable=!(2&n[23]),r.shortcut=0<=n[24]?i.resources[n[24]]:void 0,r.title=0<=n[25]?i.resources[n[25]]:void 0,r.uuid=null!=n[26]?n[26]:0;var e=null,u=n[20];if(0<u.length){for(var s=[],h=0,o=u.length;h<o;++h){var a=u[h],c=t.toShape(a,i);null!=c&&s.push(c)}e=Promise.all(s).then((function(t){r.children=t;for(var n=0,i=t.length;n<i;++n)t[n].parent=r;return r.onChildTransformChange(),r.toDirty(),r}))}var f=n[17];for(h=0,o=f.length;h<o;++h)r.action.add(nu.deserialize(f[h],i));var l=n[19];if(0<=l&&l<i.resources.length){var v=i.resources[l];mt(v)&&(r.gradient=X.deserializeGradient(v))}var b=null,g=n[18];if(0<=g&&g<i.resources.length){var d=i.resources[g];mt(d)&&(b=iu.toImageElement(d).then((function(t){return r.image=t,r})))}return null!=e?null!=b?Promise.all([e,b]).then((function(){return r})):e:null!=b?b:r},t.deserializeAll=function(n,i){for(var r=[],e=0,u=n.length;e<u;++e){var s=n[e],h=t.toShape(s,i);if(null==h)return 0<r.length&&Promise.all(r).then((function(t){for(var n=0,i=t.length;n<i;++n)t[n].destroy()})),null;r.push(h)}return 0<r.length?Promise.all(r):null},t}(),eu=function(t,n){var i=new ft(b.RIGHT),r=ru.deserialize(t,n,i);return i.points.deserialize(t[15],n),r},uu=function(){e[n.BAR]=dt,i[n.BAR]=eu},su=function(t,n,i,r,e,u,s,h,o,a){for(var c=3*i,f=6*i,l=0;l<r;++l)t[f+0]=e*n[c+0],t[f+1]=u*n[c+1],t[f+2]=s,t[f+3]=h,t[f+4]=o,t[f+5]=a,c+=3,f+=6},hu=[0,0,0],ou=function(t,n,i,r){var e=1e-5;if(e<n){var u=t-n;if(e<u){var s=i/u,h=i/Math.max(e,t),o=1/Math.max(e,1-n/t);r[0]=o,r[1]=s,r[2]=h}else s=i/e,h=i/Math.max(e,t),o=1/e,r[0]=o,r[1]=s,r[2]=h}else{var a=i/Math.max(e,t);r[0]=1,r[1]=a,r[2]=a}return r},au=[0,0],cu=new t.Point,fu=function(t,n){var i=3*n;t[i+0]=1,t[i+1]=1,t[i+2]=1,t[i+3]=0,t[i+4]=1,t[i+5]=1,t[i+6]=1,t[i+7]=1,t[i+8]=1,t[i+9]=1,t[i+10]=0,t[i+11]=1,t[i+12]=0,t[i+13]=0,t[i+14]=1,t[i+15]=1,t[i+16]=0,t[i+17]=1,t[i+18]=1,t[i+19]=1,t[i+20]=1,t[i+21]=0,t[i+22]=1,t[i+23]=1,t[i+24]=1,t[i+25]=1,t[i+26]=1},lu=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+3,t[r+3]=n+1,t[r+4]=n+4,t[r+5]=n+3,t[r+6]=n+1,t[r+7]=n+2,t[r+8]=n+4,t[r+9]=n+2,t[r+10]=n+5,t[r+11]=n+4,t[r+12]=n+3,t[r+13]=n+4,t[r+14]=n+6,t[r+15]=n+4,t[r+16]=n+7,t[r+17]=n+6,t[r+18]=n+4,t[r+19]=n+5,t[r+20]=n+7,t[r+21]=n+5,t[r+22]=n+8,t[r+23]=n+7},vu=function(t,n,i,r,e,u,s,h,o,a){var c=cu,f=s*h,l=.5*e+(0<=e?+f:-f),v=.5*u+(0<=u?+f:-f);c.set(-l+i,-v+r),o.apply(c,c);var b=c.x,d=c.y;c.set(0+i,-v+r),o.apply(c,c);var m=c.x,w=c.y,p=m-b,O=w-d;c.set(i,r),o.apply(c,c);var D=c.x,E=c.y,M=D+(D-m),S=E+(E-w),T=D-p,j=E-O,N=2*n;t[N+0]=b,t[N+1]=d,t[N+2]=m,t[N+3]=w,t[N+4]=m+p,t[N+5]=w+O,t[N+6]=T,t[N+7]=j,t[N+8]=D,t[N+9]=E,t[N+10]=D+p,t[N+11]=E+O,t[N+12]=M-p,t[N+13]=S-O,t[N+14]=M,t[N+15]=S,t[N+16]=M+p,t[N+17]=S+O,a[0]=g(b,d,m,w),a[1]=g(b,d,T,j)},bu=function(t,n,i,r,e,u){ou(u[0],r,e,hu);var s=hu[0],h=hu[1],o=hu[2];ou(u[1],r,e,hu),su(t,n,i,9,s,hu[0],h,hu[1],o,hu[2])},gu=function(t,n,i){var r=i.x0,e=i.x1,u=i.x2,s=i.x3,h=i.y0,o=i.y1,a=i.y2,c=i.y3,f=2*n;t[f+0]=r,t[f+1]=h,t[f+2]=.5*(r+e),t[f+3]=.5*(h+o),t[f+4]=e,t[f+5]=o,t[f+6]=.5*(r+s),t[f+7]=.5*(h+c),t[f+8]=.5*(r+u),t[f+9]=.5*(h+a),t[f+10]=.5*(e+u),t[f+11]=.5*(o+a),t[f+12]=s,t[f+13]=c,t[f+14]=.5*(s+u),t[f+15]=.5*(c+a),t[f+16]=u,t[f+17]=a},du=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.updateClippings(),i.updateIndices();var r=this.vertexOffset;return fu(i.clippings,r),lu(i.indices,r,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateCircleVertexAndStep(n,t),this.updateColor(n,t),this.updateCircleUv(n,t),this.updateText(n,t)},n.prototype.updateCircleVertexAndStep=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s,o=n.stroke,a=o.enable?o.width:0,c=o.align,f=this.strokeAlign!==c||this.strokeWidth!==a;(u||h||f)&&(this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.strokeWidth=a,this.strokeAlign=c,this.textSpacingHorizontal=NaN,t.updateVertices(),t.updateSteps(),vu(t.vertices,this.vertexOffset,0,0,r,e,c,a,n.transform.internalTransform,au),bu(t.steps,t.clippings,this.vertexOffset,a,this.antialiasWeight,au))},n.prototype.updateCircleUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r,t.updateUvs();var e=this.toTextureUvs(i);gu(t.uvs,this.vertexOffset,e)}},n}(bt),mu=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=9+s,a=8+h;return t.check(i,r,o,a)?new du(t,i,r,s,h,o,a,e).init(n):null},wu=function(t){function i(i){return void 0===i&&(i=n.CIRCLE),t.call(this,i)||this}return y(i,t),i.prototype.clone=function(){return(new i).copy(this)},i.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=this.fill,s=this.stroke;if(u.enable){if((c=n*n)*(a=e*e)+(f=i*i)*(o=r*r)<=o*a)return!0}else{var h=s.width;if(s.enable&&0<h){var o,a,c=n*n,f=i*i,l=Math.max(0,r-h),v=Math.max(0,e-h),b=l*l,g=v*v;if(b*g<=c*g+f*b&&c*(a=e*e)+f*(o=r*r)<=o*a)return!0}}}return!1},i}(at),pu=function(t,n){return ru.deserialize(t,n,new wu)},Ou=function(){e[n.CIRCLE]=mu,i[n.CIRCLE]=pu};!function(t){t[t.NONE=0]="NONE",t[t.ID=1]="ID",t[t.POSITION=2]="POSITION",t[t.WIDTH=4]="WIDTH",t[t.HEIGHT=8]="HEIGHT",t[t.ROTATION=16]="ROTATION",t[t.SKEW=32]="SKEW",t[t.ALIGN=64]="ALIGN",t[t.REPLACING=128]="REPLACING",t[t.GROUPING=256]="GROUPING",t[t.FILL=512]="FILL",t[t.STROKE=1024]="STROKE",t[t.STROKE_SIDE=2048]="STROKE_SIDE",t[t.BORDER_RADIUS=4096]="BORDER_RADIUS",t[t.TEXT=8192]="TEXT",t[t.TEXTURE=16384]="TEXTURE",t[t.TAG=32768]="TAG",t[t.ACTION=65536]="ACTION",t[t.CURSOR=131072]="CURSOR",t[t.ORDER_IN_LAYER=262144]="ORDER_IN_LAYER",t[t.CHILDREN=524288]="CHILDREN",t[t.COORDINATE=127]="COORDINATE",t[t.SHAPE=1920]="SHAPE",t[t.LAYER=262144]="LAYER",t[t.PRIMITIVE=1042431]="PRIMITIVE",t[t.EMBEDDED=369151]="EMBEDDED",t[t.ALL=1048575]="ALL"}(Qe||(Qe={}));var Du,Eu=function(){function t(){}return t.get=function(t){var n=this.mappings[t];return null!=n?n:Qe.PRIMITIVE},t.contains=function(t,n){if(null!=t){var i=this.get(t.type);if(i&n)return!0;if(i&Qe.CHILDREN)for(var r=t.children,e=0,u=r.length;e<u;++e)if(this.contains(r[e],n))return!0}return!1},t.set=function(t,n){this.mappings[t]=n},t.mappings={},t}(),Mu=function(n){function i(t,i,r){return n.call(this,t,i,r,0,0,1)||this}return y(i,n),i.prototype.init=function(i){return n.prototype.init.call(this,i),this.texture=i.texture||t.Texture.WHITE,this},i.prototype.update=function(t){},i}(vt),Su=function(t,n,i,r){return new Mu(t,i,r).init(n)},Tu=function(){function t(t,n,i,r){this.resources=t.resources,this.tags=t.tags||t.resources,this.pieces=n,this.pieceData=i,this.isEditMode=r,this.Tu=new Map,this.ju=new Map,this.Nu=new Map,this.Iu=new Map,this.Cu=new Map,this.Au=new Map,this.Ru=new Map,this.yu=new Map,this.ku=new Map,this.xu=new Map,this.Lu=new Map}return t.prototype.getAction=function(t){return this.Tu.get(t)},t.prototype.setAction=function(t,n){this.Tu.set(t,n)},t.prototype.getFill=function(t){return this.ju.get(t)},t.prototype.setFill=function(t,n){this.ju.set(t,n)},t.prototype.getStroke=function(t){return this.Nu.get(t)},t.prototype.setStroke=function(t,n){this.Nu.set(t,n)},t.prototype.getTag=function(t){return this.Iu.get(t)},t.prototype.setTag=function(t,n){this.Iu.set(t,n)},t.prototype.getTagValue=function(t){return this.Cu.get(t)},t.prototype.setTagValue=function(t,n){this.Cu.set(t,n)},t.prototype.getRange=function(t){return this.Au.get(t)},t.prototype.setRange=function(t,n){this.Au.set(t,n)},t.prototype.getAlign=function(t){return this.Ru.get(t)},t.prototype.setAlign=function(t,n){this.Ru.set(t,n)},t.prototype.getMargin=function(t){return this.yu.get(t)},t.prototype.setMargin=function(t,n){this.yu.set(t,n)},t.prototype.getText=function(t){return this.ku.get(t)},t.prototype.setText=function(t,n){this.ku.set(t,n)},t.prototype.getTextOutline=function(t){return this.xu.get(t)},t.prototype.setTextOutline=function(t,n){this.xu.set(t,n)},t.prototype.getExtension=function(t){return this.Lu.get(t)},t.prototype.setExtension=function(t,n){this.Lu.set(t,n)},t}(),ju=function(t,n,i,r){this.name=t,this.width=n,this.height=i,this.layer=r},Nu=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n,i){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!0,color:16777215,alpha:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Iu=function(){this.localTransform=new t.Matrix,this.internalTransform=new t.Matrix,this.internalTransformParentInverse=new t.Matrix,this.rotation=0,this.size=new t.Point},Cu=function(){function t(){}return t.prepare=function(t){var n=t.editor=t.editor||new Iu;t.updateTransform();var i=t.parent;i instanceof Y?i.transform.internalTransform.copyTo(n.internalTransformParentInverse).invert():n.internalTransformParentInverse.identity(),t.transform.internalTransform.copyTo(n.internalTransform),n.rotation=t.transform.rotation,n.size.copyFrom(t.size),t.disallowOnTransformChange()},t.finalize=function(t){t.allowOnTransformChange(!0)},t.apply=function(t,n,i){var r=t.editor;if(null!=r){var e=r.localTransform;if(r.internalTransformParentInverse.copyTo(e).append(n).append(r.internalTransform),i)this.applyLocal(t,e);else{var u=r.size;this.applyLocal(t,e,u.x,u.y)}}},t.applyLocal=function(t,n,i,r){t.disallowUploadedUpdate();var e=n.a,u=n.b,s=n.c,h=n.d,o=n.tx,a=n.ty,c=t.transform,f=Math.atan2(-s,h),l=Math.atan2(+u,e);c.rotation=.5*(f+l);var v=.5*(l-f);c.skew.set(v,v);var b=c.pivot,g=b.x,d=b.y;if(c.position.set(o+(e*g+s*d),a+(u*g+h*d)),null!=i&&null!=r){var m=Math.sqrt(e*e+u*u),w=Math.sqrt(s*s+h*h);t.size.set(Ue.toNormalized(i*m),Ue.toNormalized(r*w))}t.allowUploadedUpdate()},t}(),Au=function(){function n(n,i,r){this.shape=n,this.base=new t.Point(i,r);var e=n.size;this.shapeBase=new t.Point(e.x,e.y),this.transform=new t.Matrix,n.updateTransform(),n.transform.localTransform.copyTo(this.transform)}return n.prototype.isCompatible=function(t){return this.shape===t},n.prototype.reset=function(t,n,i){this.base.set(n,i);var r=t.size;this.shapeBase.copyFrom(r),t.updateTransform(),t.transform.localTransform.copyTo(this.transform)},n.prototype.update=function(t,i,r,e,u){var s=i/this.base.x,h=r/this.base.y,o=this.shapeBase,a=n.WORK_TRANSFORM;a.identity().append(this.transform).translate(-e,-u).scale(s,h).translate(+e,+u),t.disallowOnTransformChange(),Cu.applyLocal(t,a,o.x,o.y),t.allowOnTransformChange(!1)},n.WORK_TRANSFORM=new t.Matrix,n}(),Ru=function(){function n(n,i,r,e){this.Le=new t.Point,this.Bu=new t.Rectangle,this._u=new t.Rectangle,this.o=n,this.Pu=[],this.S=new t.Point(i,r),this.Fu=e}return n.prototype.init=function(){},Object.defineProperty(n.prototype,"x",{get:function(){return this.S.x},set:function(t){var n=this.S;if(n.x!==t){var i=n.x;n.x=t,this.onChange(i,n.y)}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.S.y},set:function(t){var n=this.S;if(n.y!==t){var i=n.y;n.y=t,this.onChange(n.x,i)}},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n){var i=!1,r=this.S,e=r.x,u=r.y;return null!=t&&e!==t&&(i=!0,r.x=t),null!=n&&u!==n&&(i=!0,r.y=n),i&&this.onChange(e,u),this},n.prototype.clone=function(){var t=this.S;return new n(this.o,t.x,t.y,this.Fu)},n.prototype.copy=function(){},n.prototype.copyFrom=function(t){var n=t.x,i=t.y,r=this.S,e=r.x,u=r.y;return e===n&&u===i||(r.x=n,r.y=i,this.onChange(e,u)),this},n.prototype.copyTo=function(t){return this.S.copyTo(t)},n.prototype.equals=function(t){return this.S.equals(t)},n.prototype.fit=function(){this.Fu&&this.doFit()},n.prototype.doFit=function(){var t=this.o;t.disallowOnTransformChange();var n=this.calcRect(this._u),i=this.S;i.set(n.width,n.height),t.updateTransform();var r=t.transform,e=n.x+.5*n.width,u=n.y+.5*n.height,s=r.position,h=r.localTransform,o=h.a,a=h.b,c=h.c,f=h.d,l=r.pivot;s.set(s.x+(o*e+c*u)-(o*l.x+c*l.y),s.y+(a*e+f*u)-(a*l.x+f*l.y)),l.set(e,u),this.reset(t.children,this.Pu,i),t.allowOnTransformChange(!0)},n.prototype.reset=function(t,n,i){for(var r=0,e=Math.min(n.length,t.length);r<e;++r){var u=t[r],s=n[r];if(!s.isCompatible(u)){n.length=r;break}s.reset(u,i.x,i.y)}t.length<n.length&&(n.length=t.length)},n.prototype.calcRect=function(t){var n=this.o.children;if(n.length<=0)t.x=0,t.y=0,t.width=0,t.height=0;else{var i=this.Le,r=this.Bu;n[0].getBoundsLocal(i,!1,t);for(var e=1,u=n.length;e<u;++e)n[e].getBoundsLocal(i,!1,r),t.enlarge(r)}return t},n.prototype.onChange=function(t,n){var i=this.o,r=this.S,e=i.transform.pivot;this.Uu(i.children,this.Pu,r.x,r.y,e.x,e.y,t,n),i.onSizeChange()},n.prototype.Uu=function(t,n,i,r,e,u,s,h){for(var o=0,a=Math.min(n.length,t.length);o<a;++o){var c=t[o];if(!(f=n[o]).isCompatible(c)){n.length=o;break}f.update(c,i,r,e,u)}for(o=n.length,a=t.length;o<a;++o){var f;c=t[o],(f=this.newLayout(c,s,h)).update(c,i,r,e,u),n.push(f)}n.length!==t.length&&(n.length=t.length)},n.prototype.newLayout=function(t,n,i){return t.layout||new Au(t,n,i)},n}(),yu=function(){function n(n,i,r,e,u){this.o=n,this._x=i,this._y=r,this.zu=new t.Point(e,u)}return Object.defineProperty(n.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"base",{get:function(){return this.zu},enumerable:!1,configurable:!0}),n.prototype.init=function(){this.zu.copyFrom(this),this.onChange()},n.prototype.clone=function(){var t=this.zu;return new n(this.o,this._x,this._y,t.x,t.y)},n.prototype.set=function(t,n){var i=!1;return null!=t&&this._x!==t&&(this._x=t,i=!0),null!=n&&this._y!==n&&(this._y=n,i=!0),i&&this.onChange(),this},n.prototype.copyFrom=function(t){return t instanceof n&&this.zu.copyFrom(t.base),this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.onChange()),this},n.prototype.copyTo=function(t){return t instanceof n&&this.zu.copyTo(t.base),t.set(this._x,this._y),t},n.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},n.prototype.fit=function(){},n.prototype.onChange=function(){var t=this.zu;this.o.transform.scale.set(this._x/t.x,this._y/t.y)},n}();!function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=4]="BOTTOM",t[t.LEFT=8]="LEFT",t[t.TOP_OR_LEFT=9]="TOP_OR_LEFT",t[t.TOP_OR_RIGHT=3]="TOP_OR_RIGHT",t[t.BOTTOM_OR_LEFT=12]="BOTTOM_OR_LEFT",t[t.BOTTOM_OR_RIGHT=6]="BOTTOM_OR_RIGHT",t[t.ALL=15]="ALL"}(Du||(Du={}));var ku,xu,Lu=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){return Du.NONE},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n,i,r,e){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!1,color:16777215,alpha:1,width:1,align:0,side:Du.NONE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Bu=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return h.CENTER},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return o.MIDDLE},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:h.CENTER,vertical:o.MIDDLE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),_u=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Pu=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n,i,r){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!1,color:16777215,alpha:1,width:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Fu=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Uu=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),zu=function(){function t(){this.align=new Bu,this.offset=new _u,this.outline=new Pu,this.spacing=new Uu,this.padding=new Fu}return Object.defineProperty(t.prototype,"enable",{get:function(){return!0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return""},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return"auto"},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return 24},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return u.NORMAL},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return s.NORMAL},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return a.LEFT_TO_RIGHT},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){return!1},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){return this},t.prototype.set=function(t,n,i,r,e,u,s,h,o){return this},t.prototype.toObject=function(){return{value:"",color:0,alpha:1,family:"auto",size:24,weight:u.NORMAL,align:this.align.toObject(),offset:this.offset.toObject(),style:s.NORMAL,outline:this.outline.toObject(),spacing:this.spacing.toObject(),direction:a.LEFT_TO_RIGHT,padding:this.padding.toObject(),clipping:!1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Gu=function(t){function n(n,i){var r=t.call(this,i)||this;return r.Gu=n,r.tag=r.newTag(),r.size=r.newGroupSize(n),r.fill=r.newGroupFill(),r.stroke=r.newGroupStroke(),r.text=r.newGroupText(),r}return y(n,t),Object.defineProperty(n.prototype,"isEditMode",{get:function(){return this.Gu},enumerable:!1,configurable:!0}),n.prototype.newGroupSize=function(t){var n=q.SIZE_X,i=q.SIZE_Y;return t?new Ru(this,n,i,this.isGroupSizeFittable()):new yu(this,n,i,n,i)},n.prototype.isGroupSizeFittable=function(){return!0},n.prototype.newTag=function(){return new et},n.prototype.newGroupFill=function(){return new Nu},n.prototype.newGroupStroke=function(){return new Lu},n.prototype.newGroupText=function(){return new zu},n.prototype.getBoundsSize=function(){var t=this.size;return t instanceof yu?t.base:t},n.prototype.onChildTransformChange=function(){t.prototype.onChildTransformChange.call(this),this.size.fit()},Object.defineProperty(n.prototype,"corner",{get:function(){return P.NONE},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cursor",{get:function(){return""},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"gradient",{get:function(){},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"radius",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"image",{get:function(){},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"points",{get:function(){},set:function(t){},enumerable:!1,configurable:!0}),n.prototype.containsAbs=function(t,n,i,r){return!1},n}(Y),Hu=function(t){function i(i,r,e){void 0===e&&(e=n.LAYER);var u=t.call(this,r,e)||this;return u.Hu=i,u}return y(i,t),i.prototype.isGroupSizeFittable=function(){return!1},i.prototype.clone=function(){for(var t=this.newClone().copy(this),n=this.children,i=0,r=n.length;i<r;++i){var e=n[i].clone();e.parent=t,t.children.push(e)}return t.onChildTransformChange(),t.toDirty(),t.size.init(),t},i.prototype.newClone=function(){return new(0,this.constructor)(this.Hu,this.Gu,this.type)},i.prototype.serializeChildren=function(t){return[]},i.prototype.serializeImage=function(t){return-1},i.prototype.serializeGradient=function(t){return-1},i}(Gu),Vu=function(){function t(t,n,i){this.children=[],this._x=.5*-t,this._y=.5*-n,this.ot=t,this.zt=n,this.Gu=i}return t.prototype.create=function(t){var n=new Hu(t,this.Gu);return n.transform.position.set(this._x,this._y),n.size.set(this.ot,this.zt).init(),this.children.push(n),n},t}(),Wu=function(){function t(){}return t.toSimple=function(t){var n=t.tags,i=t.pieces;return{version:t.version,id:t.id,name:t.name,tags:null!=n?JSON.stringify(n):void 0,pieces:null!=i?JSON.stringify(i):void 0,thumbnail:t.thumbnail,data:JSON.stringify({width:t.width,height:t.height,background:t.background,tile:t.tile,resources:t.resources,layers:t.layers,items:t.items,snap:t.snap})}},t.toSerialized=function(t){if("data"in t){var n=JSON.parse(t.data);n.version=t.version,n.id=t.id,n.name=t.name;var i=t.tags;null!=i&&(n.tags=JSON.parse(i));var r=t.pieces;return null!=r&&(n.pieces=JSON.parse(r)),n.thumbnail=t.thumbnail,n}return t},t.newLayer=function(t,n,i){for(var r=t.layers,e=0,u=r.length;e<u;++e)n.create(r[e][0]||"");var s=t.items,h=ru.deserializeAll(s,i);return null!=h?h.then((function(t){for(var i=n.children,r=0,e=t.length;r<e;++r){var u=s[r],h=t[r],o=i[u[16]];null!=o&&h.attach(o)}return t})):Promise.resolve([])},t.toPieceData=function(t,n,i,r){var e=this;if(n&&0<n.length&&t){var u=r||new Map;return new Promise((function(r){for(var s=n.length,h=s,o=function(){(h-=1)<=0&&r(u)},a=function(n){u.has(n)?o():t.piece.getByName(n).then((function(r){e.toPieceDataSub(t,n,r,i,u).then(o,o)}),o)},c=0;c<s;++c)a(n[c])}))}},t.toPieceDataSub=function(t,n,i,r,e){var u=this,s=this.toSerialized(i),h=s.width,o=s.height,a=new Vu(h,o,r);e.set(n,new ju(n,h,o,a));var c=s.pieces,f=this.toPieceData(t,c,r,e);return null==f?this.newLayer(s,a,new Tu(s,void 0,void 0,r)):f.then((function(t){return u.newLayer(s,a,new Tu(s,c,t,r))}))},t}(),Xu=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.align.horizontal:h.CENTER},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.align.horizontal=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.align.vertical:o.MIDDLE},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.align.vertical=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.align.copy(t)},t.prototype.set=function(t,n){for(var i=this.o.children,r=0,e=i.length;r<e;++r)i[r].text.align.set(t,n)},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.align.toObject():{horizontal:h.CENTER,vertical:o.MIDDLE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Yu=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.offset.horizontal:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.offset.horizontal=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.offset.vertical:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.offset.vertical=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.offset.copy(t)},t.prototype.set=function(t,n){for(var i=this.o.children,r=0,e=i.length;r<e;++r)i[r].text.offset.set(t,n)},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.offset.toObject():{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Ku=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.o.children;return 0<t.length&&t[t.length-1].text.outline.enable},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.outline.enable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.outline.color:16777215},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.outline.color=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.outline.alpha:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.outline.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.outline.width:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.outline.width=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.outline.copy(t)},t.prototype.set=function(t,n,i,r){for(var e=this.o.children,u=0,s=e.length;u<s;++u)e[u].text.outline.set(t,n,i,r)},t.prototype.clone=function(){return new t(this.o)},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.outline.toObject():{enable:!1,color:16777215,alpha:1,width:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Ju=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.padding.horizontal:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.padding.horizontal=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.padding.vertical:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.padding.vertical=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.padding.copy(t)},t.prototype.set=function(t,n){for(var i=this.o.children,r=0,e=i.length;r<e;++r)i[r].text.padding.set(t,n)},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.padding.toObject():{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),Zu=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.spacing.horizontal:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.spacing.horizontal=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.spacing.vertical:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.spacing.vertical=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.spacing.copy(t)},t.prototype.set=function(t,n){for(var i=this.o.children,r=0,e=i.length;r<e;++r)i[r].text.spacing.set(t,n)},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.spacing.toObject():{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),qu=function(){function t(t){this.o=t,this.align=new Xu(t),this.offset=new Yu(t),this.outline=new Ku(t),this.spacing=new Zu(t),this.padding=new Ju(t)}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.o.children;return!(0<t.length)||t[t.length-1].text.enable},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.enable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.value:""},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.color:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.color=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.alpha:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.family:"auto"},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.family=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.size:24},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.size=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.weight:u.NORMAL},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.weight=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.style:s.NORMAL},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.style=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.direction:0},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.direction=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){var t=this.o.children;return 0<t.length&&t[t.length-1].text.clipping},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.clipping=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].text.copy(t);return this},t.prototype.set=function(t,n,i,r,e,u,s,h){for(var o=this.o.children,a=0,c=o.length;a<c;++a)o[a].text.set(t,n,i,r,e,u,s,h);return this},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].text.toObject():{value:"",color:0,alpha:1,family:"auto",size:24,weight:u.NORMAL,align:this.align.toObject(),offset:this.offset.toObject(),style:s.NORMAL,outline:this.outline.toObject(),spacing:this.spacing.toObject(),direction:a.LEFT_TO_RIGHT,padding:this.padding.toObject(),clipping:!1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),$u=function(t){function i(i,r,e){void 0===e&&(e=n.EMBEDDED);var u=t.call(this,r,e)||this;return u.Hu=i,u}return y(i,t),Object.defineProperty(i.prototype,"name",{get:function(){return this.Hu},enumerable:!1,configurable:!0}),i.prototype.newGroupText=function(){return new qu(this)},i.prototype.isGroupSizeFittable=function(){return!1},i.prototype.clone=function(){for(var t=this.newClone().copy(this),n=this.children,i=0,r=n.length;i<r;++i){var e=n[i].clone();e.parent=t,t.children.push(e)}return t.onChildTransformChange(),t.toDirty(),t},i.prototype.newClone=function(){return new(0,this.constructor)(this.Hu,this.Gu,this.type)},i.prototype.serializeChildren=function(t){return[]},i.prototype.serializeImage=function(t){return-1},i.prototype.serializeGradient=function(t){return-1},i.prototype.serialize=function(n){var i=t.prototype.serialize.call(this,n);return i[15]=n.addPiece(this.Hu),i},i.prototype.addUuid=function(t){this.uuid=t.addUuid(this.uuid)},i.prototype.updateUuid=function(t){this.uuid=t.updateUuid(this.uuid)},i}(Gu),Qu=function(){function t(){}return t.from=function(t,n,i){var r=this,e=Wu.toSerialized(t),u=e.pieces,s=Wu.toPieceData(n,u,i);return null==s?this.Vu(e,i):s.then((function(t){return r.Vu(e,i,u,t)}))},t.Vu=function(t,n,i,r){var e=this,u=t.width,s=t.height,h=new Vu(u,s,n),o=new Tu(t,i,r,n);return Wu.newLayer(t,h,o).then((function(){return e.create(t.name,u,s,h,o)}))},t.deserialize=function(t,n,i,r,e,u){var s=new $u(t,e.isEditMode),h=ru.deserialize(u,e,s),o=s.size,a=o.x,c=o.y;return s.size.set(n,i),this.init(s,r),s.size.set(a,c),h},t.create=function(t,n,i,r,e){var u=new $u(t,e.isEditMode);return u.size.set(n,i),this.init(u,r),u},t.init=function(t,n){for(var i=n.children,r=t.children,e=0,u=i.length;e<u;++e){var s=i[e].clone();s.parent=t,r.push(s)}t.onChildTransformChange(),t.toDirty(),t.size.init()},t}(),ts=function(t,n){var i=n.pieces,r=t[15];if(i&&0<=r&&r<i.length){var e=n.pieceData;if(e){var u=i[r],s=e.get(u);if(s)return Qu.deserialize(u,s.width,s.height,s.layer,n,t)}}return null},ns=function(){e[n.EMBEDDED]=Su,i[n.EMBEDDED]=ts,Eu.set(n.EMBEDDED,Qe.EMBEDDED)},is=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.o.children;return!(0<t.length)||t[t.length-1].fill.enable},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].fill.enable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].fill.color:16777215},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].fill.color=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].fill.alpha:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].fill.alpha=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].fill.copy(t)},t.prototype.set=function(t,n,i){for(var r=this.o.children,e=0,u=r.length;e<u;++e)r[e].fill.set(t,n,i)},t.prototype.clone=function(){return new t(this.o)},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].fill.toObject():{enable:!0,color:16777215,alpha:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),rs=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"length",{get:function(){var t=this.o.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.length}return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var t=this.o.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.id}return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var t=this.o.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.values}return[]},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&(e.values=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"segments",{get:function(){var t=this.o.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.segments}return[]},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&(e.segments=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){var t=this.o.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.style}return r.NONE},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&(e.style=t)}},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&e.copy(t)}return this},t.prototype.set=function(t,n,i){for(var r=this.o.children,e=0,u=r.length;e<u;++e){var s=r[e].points;null!=s&&s.set(t,n,i)}return this},t.prototype.clone=function(n){return new t(n)},t.prototype.toPoints=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i){var e=n[i].points;if(null!=e)return e.toPoints(t)}return[]},t.prototype.serialize=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i){var e=n[i].points;if(null!=e)return e.serialize(t)}return-1},t}(),es=function(){function t(t){this.o=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.o.children;return 0<t.length&&t[t.length-1].stroke.enable},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].stroke.enable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].stroke.color:16777215},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].stroke.color=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].stroke.alpha:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].stroke.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].stroke.width:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].stroke.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].stroke.align:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].stroke.align=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){var t=this.o.children;return 0<t.length?t[t.length-1].stroke.side:1},set:function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].stroke.side=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var n=this.o.children,i=0,r=n.length;i<r;++i)n[i].stroke.copy(t)},t.prototype.set=function(t,n,i,r,e){for(var u=this.o.children,s=0,h=u.length;s<h;++s)u[s].stroke.set(t,n,i,r,e)},t.prototype.clone=function(){return new t(this.o)},t.prototype.toObject=function(){var t=this.o.children;return 0<t.length?t[t.length-1].stroke.toObject():{enable:!1,color:16777215,alpha:1,width:1,align:0,side:Du.NONE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),us=function(t){function i(i,r){void 0===r&&(r=n.GROUP);var e=t.call(this,r)||this;return e.Gu=i,e.tag=new et,e.size=e.newGroupSize(i),e.fill=e.newGroupFill(),e.stroke=e.newGroupStroke(),e.text=e.newGroupText(),e.tt=e.newGroupPoints(),e}return y(i,t),Object.defineProperty(i.prototype,"isEditMode",{get:function(){return this.Gu},enumerable:!1,configurable:!0}),i.prototype.newGroupSize=function(t){var n=q.SIZE_X,i=q.SIZE_Y;return t?new Ru(this,n,i,this.isGroupSizeFittable()):new yu(this,n,i,n,i)},i.prototype.isGroupSizeFittable=function(){return!0},i.prototype.newGroupFill=function(){return new is(this)},i.prototype.newGroupStroke=function(){return new es(this)},i.prototype.newGroupText=function(){return new qu(this)},i.prototype.newGroupPoints=function(){return new rs(this)},i.prototype.getBoundsSize=function(){var t=this.size;return t instanceof yu?t.base:t},i.prototype.onChildTransformChange=function(){t.prototype.onChildTransformChange.call(this),this.size.fit()},Object.defineProperty(i.prototype,"corner",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].corner:P.ALL},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].corner=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"cursor",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].cursor:""},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].cursor=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"gradient",{get:function(){for(var t=this.children,n=t.length-1;0<=n;--n){var i=t[n].gradient;if(null!=i)return i}},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].gradient=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"radius",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].radius:.5},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"image",{get:function(){for(var t=this.children,n=t.length-1;0<=n;--n){var i=t[n].image;if(null!=i)return i}},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].image=t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"points",{get:function(){for(var t=this.children,n=t.length-1;0<=n;--n)if(null!=t[n].points)return this.tt},set:function(t){},enumerable:!1,configurable:!0}),i.prototype.clone=function(){for(var t=this.newClone().copy(this),n=this.children,i=0,r=n.length;i<r;++i){var e=n[i].clone();e.parent=t,t.children.push(e)}return t.onChildTransformChange(),t.toDirty(),t},i.prototype.newClone=function(){return new(0,this.constructor)(this.Gu,this.type)},i.prototype.containsAbs=function(t,n,i,r){return!1},i}(Y),ss=function(t,n){var i=new us(n.isEditMode),r=ru.deserialize(t,n,i);return i.size.init(),r},hs=function(){e[n.GROUP]=Su,i[n.GROUP]=ss},os=function(){function n(n,i,r){this.o=n,this.S=new t.Point(i,r)}return n.prototype.init=function(){},Object.defineProperty(n.prototype,"x",{get:function(){return this.S.x},set:function(t){var n=this.S;if(n.x!==t){var i=n.x;n.x=t,this.onChange(i,n.y)}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this.S.y},set:function(t){var n=this.S;if(n.y!==t){var i=n.y;n.y=t,this.onChange(n.x,i)}},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n){var i=!1,r=this.S,e=r.x,u=r.y;return null!=t&&e!==t&&(i=!0,r.x=t),null!=n&&u!==n&&(i=!0,r.y=n),i&&this.onChange(e,u),this},n.prototype.clone=function(){var t=this.S;return new n(this.o,t.x,t.y)},n.prototype.copy=function(){},n.prototype.copyFrom=function(t){var n=t.x,i=t.y,r=this.S,e=r.x,u=r.y;return e===n&&u===i||(r.x=n,r.y=i,this.onChange(e,u)),this},n.prototype.copyTo=function(t){return this.S.copyTo(t)},n.prototype.equals=function(t){return this.S.equals(t)},n.prototype.fit=function(){},n.prototype.onChange=function(t,n){this.o.onSizeChange()},n}(),as=function(t){function i(i,r){return void 0===r&&(r=n.GROUP_SHADOWED),t.call(this,i,r)||this}return y(i,t),i.prototype.newGroupSize=function(n){return n?new os(this,q.SIZE_X,q.SIZE_Y):t.prototype.newGroupSize.call(this,n)},i}(us),cs=function(t,n){var i=new as(n.isEditMode),r=ru.deserialize(t,n,i);return i.size.init(),r},fs=function(){e[n.GROUP_SHADOWED]=Su,i[n.GROUP_SHADOWED]=cs},ls=18,vs=[0,0,0],bs=new t.Point,gs=function(t,n,i){var r=1-i[0];i[1]<=i[2]?ds(0,1,0,r,t,n):ds(1,0,r,0,t,n)},ds=function(t,n,i,r,e,u){var s=3*u;e[s+0]=t,e[s+1]=n,e[s+2]=0,e[s+3]=t,e[s+4]=n,e[s+5]=0,e[s+6]=t,e[s+7]=n,e[s+8]=0,e[(s+=9)+0]=i,e[s+1]=r,e[s+2]=0,e[(s+=3)+0]=i,e[s+1]=r,e[s+2]=0,e[(s+=3)+0]=t,e[s+1]=n,e[s+2]=0,e[s+3]=t,e[s+4]=n,e[s+5]=0,e[s+6]=t,e[s+7]=n,e[s+8]=0,e[(s+=9)+0]=n,e[s+1]=t,e[s+2]=0,e[s+3]=n,e[s+4]=t,e[s+5]=0,e[s+6]=n,e[s+7]=t,e[s+8]=0,e[s+9]=n,e[s+10]=t,e[s+11]=0,e[(s+=12)+0]=0,e[s+1]=0,e[s+2]=0,e[(s+=3)+0]=0,e[s+1]=0,e[s+2]=0,e[(s+=3)+0]=n,e[s+1]=t,e[s+2]=0,e[s+3]=n,e[s+4]=t,e[s+5]=0,e[s+6]=n,e[s+7]=t,e[s+8]=0,e[s+9]=n,e[s+10]=t,e[s+11]=0},ms=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+3,t[(r+=3)+0]=n+1,t[r+1]=n+2,t[r+2]=n+3,t[(r+=3)+0]=n+4,t[r+1]=n+6,t[r+2]=n+5,t[(r+=3)+0]=n+4,t[r+1]=n+7,t[r+2]=n+6,t[(r+=3)+0]=n+8,t[r+1]=n+12,t[r+2]=n+9,t[(r+=3)+0]=n+9,t[r+1]=n+12,t[r+2]=n+10,t[(r+=3)+0]=n+10,t[r+1]=n+12,t[r+2]=n+13,t[(r+=3)+0]=n+10,t[r+1]=n+13,t[r+2]=n+11,t[(r+=3)+0]=n+14,t[r+1]=n+15,t[r+2]=n+12,t[(r+=3)+0]=n+12,t[r+1]=n+15,t[r+2]=n+16,t[(r+=3)+0]=n+16,t[r+1]=n+13,t[r+2]=n+12,t[(r+=3)+0]=n+13,t[r+1]=n+16,t[r+2]=n+17},ws=function(t,n,i,r,e,u,s,h,o,a){var c=s*h,f=.5*e+(0<=e?+c:-c),l=.5*u+(0<=u?+c:-c),v=bs;v.set(i-f,r-l),o.apply(v,v);var b=v.x,d=v.y;v.set(i+f,r-l),o.apply(v,v);var m=v.x,w=v.y;v.set(i+f,r+l),o.apply(v,v);var p=v.x,O=v.y,D=b+(p-m),E=d+(O-w),M=.5*g(b,d,m,w),S=.5*g(m,w,p,O);if(a[1]=M,a[2]=S,M<=S){var T=M/S;a[0]=T,ps(T,b,d,m,w,p,O,D,E,t,n)}else T=S/M,a[0]=T,ps(T,D,E,b,d,m,w,p,O,t,n)},ps=function(t,n,i,r,e,u,s,h,o,a,c,f){var l=n,v=i,b=.5*(n+r),g=.5*(i+e),d=r,m=e,w=.5*(n+u),p=.5*(i+s),O=b+t*(w-b),D=g+t*(p-g),E=h,M=o,S=.5*(h+u),T=.5*(o+s),j=u,N=s,I=S+t*(w-S),C=T+t*(p-T),A=c<<1;a[A+0]=l,a[A+1]=v,a[A+2]=b,a[A+3]=g,a[A+4]=d,a[A+5]=m,a[(A+=6)+0]=O,a[A+1]=D,a[(A+=2)+0]=I,a[A+1]=C,a[(A+=2)+0]=E,a[A+1]=M,a[A+2]=S,a[A+3]=T,a[A+4]=j,a[A+5]=N;var R=.5*(n+h),y=.5*(i+o),k=n,x=i,L=n+t*(R-n),B=i+t*(y-i),_=h+t*(R-h),P=o+t*(y-o),F=h,U=o,z=O,G=D,H=I,V=C,W=.5*(r+u),X=.5*(e+s),Y=r,K=e,J=r+t*(W-r),Z=e+t*(X-e),q=u+t*(W-u),$=s+t*(X-s),Q=u,tt=s;a[(A+=6)+0]=k,a[A+1]=x,a[A+2]=L,a[A+3]=B,a[A+4]=_,a[A+5]=P,a[A+6]=F,a[A+7]=U,a[(A+=8)+0]=z,a[A+1]=G,a[(A+=2)+0]=H,a[A+1]=V,a[(A+=2)+0]=Y,a[A+1]=K,a[A+2]=J,a[A+3]=Z,a[A+4]=q,a[A+5]=$,a[A+6]=Q,a[A+7]=tt},Os=function(t,n,i,r,e,u){var s=1-u[0],h=u[1],o=u[2];ou(h,i,e,hu);var a=hu[0],c=hu[1],f=hu[2];ou(o,i,e,hu);var l=hu[0],v=hu[1],b=hu[2],g=l,d=v;r&Du.TOP||(g=1,d=b);var m=a,w=c;r&Du.RIGHT||(m=1,w=f);var p=l,O=v;r&Du.BOTTOM||(p=1,O=b);var D=a,E=c;r&Du.LEFT||(D=1,E=f);var M=.5*(E+w),S=.5*(d+O);h<=o?Ds(s,a,c,f,l,v,b,g,d,m,w,p,O,D,E,M,S,t,n):Es(s,a,c,f,l,v,b,g,d,m,w,p,O,D,E,M,S,t,n)},Ds=function(t,n,i,r,e,u,s,h,o,a,c,f,l,v,b,g,d,m,w){var p=6*m;w[p]=v,w[p+1]=h,w[p+2]=b,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=0,w[p+1]=h,w[p+2]=g,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=h,w[p+2]=c,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=0,w[p+1]=t*h,w[p+2]=g,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=0,w[p+1]=t*f,w[p+2]=g,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=f,w[p+2]=b,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=0,w[p+1]=f,w[p+2]=g,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=f,w[p+2]=c,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=h,w[p+2]=b,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=t*h,w[p+2]=b,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=t*f,w[p+2]=b,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=f,w[p+2]=b,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=0,w[p+1]=t*h,w[p+2]=g,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=0,w[p+1]=t*f,w[p+2]=g,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=h,w[p+2]=c,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=t*h,w[p+2]=c,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=t*f,w[p+2]=c,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=f,w[p+2]=c,w[p+3]=l,w[p+4]=r,w[p+5]=s},Es=function(t,n,i,r,e,u,s,h,o,a,c,f,l,v,b,g,d,m,w){var p=6*m;w[p]=v,w[p+1]=f,w[p+2]=b,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=0,w[p+2]=b,w[p+3]=d,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=h,w[p+2]=b,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=t*v,w[p+1]=0,w[p+2]=b,w[p+3]=d,w[p+4]=r,w[p+5]=s,w[p+=6]=t*a,w[p+1]=0,w[p+2]=c,w[p+3]=d,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=f,w[p+2]=c,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=0,w[p+2]=c,w[p+3]=d,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=h,w[p+2]=c,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=f,w[p+2]=b,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=t*v,w[p+1]=f,w[p+2]=b,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=t*a,w[p+1]=f,w[p+2]=c,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=f,w[p+2]=c,w[p+3]=l,w[p+4]=r,w[p+5]=s,w[p+=6]=t*v,w[p+1]=0,w[p+2]=b,w[p+3]=d,w[p+4]=r,w[p+5]=s,w[p+=6]=t*a,w[p+1]=0,w[p+2]=c,w[p+3]=d,w[p+4]=r,w[p+5]=s,w[p+=6]=v,w[p+1]=h,w[p+2]=b,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=t*v,w[p+1]=h,w[p+2]=b,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=t*a,w[p+1]=h,w[p+2]=c,w[p+3]=o,w[p+4]=r,w[p+5]=s,w[p+=6]=a,w[p+1]=h,w[p+2]=c,w[p+3]=o,w[p+4]=r,w[p+5]=s},Ms=function(t,n,i,r){var e=1-r[0],u=r[1],s=r[2],h=i.x0,o=i.x1,a=i.x2,c=i.x3,f=i.y0,l=i.y1,v=i.y2,b=i.y3;u<=s?Ss(e,h,o,a,c,f,l,v,b,t,n):Ss(e,c,h,o,a,b,f,l,v,t,n)},Ss=function(t,n,i,r,e,u,s,h,o,a,c){var f=.5*(n+i),l=.5*(u+s),v=.5*(n+r),b=.5*(u+h),g=.5*(r+e),d=.5*(h+o),m=.5*(n+e),w=.5*(u+o),p=.5*(i+r),O=.5*(s+h),D=v+t*(f-v),E=b+t*(l-b),M=v+t*(g-v),S=b+t*(d-b),T=c<<1;a[T+0]=n,a[T+1]=u,a[T+2]=f,a[T+3]=l,a[T+4]=i,a[T+5]=s,a[(T+=6)+0]=D,a[T+1]=E,a[(T+=2)+0]=M,a[T+1]=S,a[(T+=2)+0]=e,a[T+1]=o,a[T+2]=g,a[T+3]=d,a[T+4]=r,a[T+5]=h,a[(T+=6)+0]=n,a[T+1]=u,a[T+2]=m+t*(n-m),a[T+3]=w+t*(u-w),a[T+4]=m+t*(e-m),a[T+5]=w+t*(o-w),a[T+6]=e,a[T+7]=o,a[(T+=8)+0]=D,a[T+1]=E,a[(T+=2)+0]=M,a[T+1]=S,a[(T+=2)+0]=i,a[T+1]=s,a[T+2]=p+t*(i-p),a[T+3]=O+t*(s-O),a[T+4]=p+t*(r-p),a[T+5]=O+t*(h-O),a[T+6]=r,a[T+7]=h},Ts=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.updateIndices(),ms(i.indices,this.vertexOffset,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexClippingStepAndUv(n,t),this.updateColor(n,t),this.updateText(n,t)},n.prototype.updateVertexClippingStepAndUv=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s,o=n.stroke,a=o.enable?o.width:0,c=o.align,f=o.side,l=this.strokeAlign!==c||this.strokeWidth!==a||this.strokeSide!==f,v=this.toTexture(n),b=this.toTextureTransformId(v),g=v!==this.texture||b!==this.textureTransformId,d=u||l;if(d||h||g){this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.strokeWidth=a,this.strokeAlign=c,this.strokeSide=f,this.texture=v,this.textureTransformId=b,(d||h)&&(this.textSpacingHorizontal=NaN);var m=this.vertexOffset;t.updateVertices(),ws(t.vertices,m,0,0,r,e,c,a,n.transform.internalTransform,vs),(d||h)&&(t.updateSteps(),Os(m,t.steps,a,f,this.antialiasWeight,vs)),d&&(t.updateClippings(),gs(t.clippings,m,vs)),(d||g)&&(t.updateUvs(),Ms(t.uvs,m,this.toTextureUvs(v),vs))}},n}(bt),js=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=ls+s,a=12+h;return t.check(i,r,o,a)?new Ts(t,i,r,s,h,o,a,e).init(n):null},Ns=function(t){function i(i){return void 0===i&&(i=n.RECTANGLE),t.call(this,i)||this}return y(i,t),i.prototype.clone=function(){return(new i).copy(this)},i.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=this.fill,s=this.stroke;if(u.enable)return!0;var h=s.width,o=s.side;if(s.enable&&0<h&&o!==Du.NONE){var a=Math.max(0,r-h),c=Math.max(0,e-h);if(!this.containsAbsBBox(n,i,a,c))return o===Du.ALL||(n<=-a?i<=-c?0!=(o&Du.TOP_OR_LEFT):+c<=i?0!=(o&Du.BOTTOM_OR_LEFT):0!=(o&Du.LEFT):+a<=n?i<=-c?0!=(o&Du.TOP_OR_RIGHT):+c<=i?0!=(o&Du.BOTTOM_OR_RIGHT):0!=(o&Du.RIGHT):i<=-c?0!=(o&Du.TOP):+c<=i&&0!=(o&Du.BOTTOM))}}return!1},i}(at),Is=function(t){function i(i,r){void 0===r&&(r=n.IMAGE);var e=t.call(this,r)||this;return null!=i&&(e.image=i,e.size.set(i.width,i.height)),e.fill.alpha=1,e}return y(i,t),i.prototype.clone=function(){return new i(this.image).copy(this)},i}(Ns),Cs=function(t,n){return ru.deserialize(t,n,new Is)},As=function(){e[n.IMAGE]=js,i[n.IMAGE]=Cs},Rs=[0,0],ys=1e-5,ks=new t.Point,xs=function(t,n){for(var i=3*n,r=3*(n+9);i<r;i+=3)t[i+0]=0,t[i+1]=0,t[i+2]=2},Ls=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+3,t[r+3]=n+1,t[r+4]=n+4,t[r+5]=n+3,t[(r+=6)+0]=n+1,t[r+1]=n+2,t[r+2]=n+4,t[r+3]=n+2,t[r+4]=n+5,t[r+5]=n+4,t[(r+=6)+0]=n+3,t[r+1]=n+4,t[r+2]=n+6,t[r+3]=n+4,t[r+4]=n+7,t[r+5]=n+6,t[(r+=6)+0]=n+4,t[r+1]=n+5,t[r+2]=n+7,t[r+3]=n+5,t[r+4]=n+8,t[r+5]=n+7},Bs=function(t,n,i,r,e,u,s,h){var o=.02775*s,a=o*(e/h[0]),c=o*(u/h[1]),f=.5*(a+c),l=.4*Math.max(0,Math.min(1,r/9.600000000000001)),v=-l*(1-i),b=6*n;t[b+0]=f,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=c,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=f,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=a,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=f,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=a,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=f,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=c,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,t[(b+=6)+0]=c,t[b+1]=l,t[b+2]=v,t[b+3]=ys,t[b+4]=ys,t[b+5]=ys,b+=6},_s=function(t,n,i,r,e,u,s,h){var o=ks,a=.5*e,c=.5*u;o.set(i-a,r-c),s.apply(o,o);var f=o.x,l=o.y;o.set(i+a,r-c),s.apply(o,o);var v=o.x,b=o.y;o.set(i+a,r+c),s.apply(o,o);var d=o.x,m=o.y,w=f+(d-v),p=l+(m-b),O=n<<1;t[O+0]=f,t[O+1]=l,t[O+2]=.5*(f+v),t[O+3]=.5*(l+b),t[O+4]=v,t[O+5]=b,t[(O+=6)+0]=.5*(f+w),t[O+1]=.5*(l+p),t[O+2]=.5*(f+d),t[O+3]=.5*(l+m),t[O+4]=.5*(v+d),t[O+5]=.5*(b+m),t[(O+=6)+0]=w,t[O+1]=p,t[O+2]=.5*(w+d),t[O+3]=.5*(p+m),t[O+4]=d,t[O+5]=m,h[0]=.5*g(f,l,v,b),h[1]=.5*g(f,l,w,p)},Ps=function(t,n,i){var r=i.x0,e=i.y0,u=i.x1,s=i.y1,h=i.x2,o=i.y2,a=i.x3,c=i.y3,f=n<<1;t[f+0]=r,t[f+1]=e,t[f+2]=.5*(u+r),t[f+3]=.5*(s+e),t[f+4]=u,t[f+5]=s,t[(f+=6)+0]=.5*(r+a),t[f+1]=.5*(e+c),t[f+2]=.5*(r+h),t[f+3]=.5*(e+o),t[f+4]=.5*(u+h),t[f+5]=.5*(s+o),t[(f+=6)+0]=a,t[f+1]=c,t[f+2]=.5*(a+h),t[f+3]=.5*(c+o),t[f+4]=h,t[f+5]=o},Fs=function(t){function n(n,i,r,e,u,s,h,o){var a=t.call(this,n,i,r,e,u,s,h,o)||this;return a.textureWidth=-1,a.textureHeight=-1,a}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer,r=this.vertexOffset;return i.updateClippings(),i.updateIndices(),xs(i.clippings,r),Ls(i.indices,r,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexAndStep(n,t),this.updateColor(n,t),this.updateUv(n,t),this.updateText(n,t)},n.prototype.updateVertexAndStep=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s,o=n.stroke,a=o.enable?o.width:0,c=o.align,f=this.strokeAlign!==c||this.strokeWidth!==a,l=this.toTexture(n),v=l.width*l.resolution,b=l.height*l.resolution,g=this.textureWidth!==v||this.textureHeight!==b;(u||h||f||g)&&(this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.strokeWidth=a,this.strokeAlign=c,this.textureWidth=v,this.textureHeight=b,this.textSpacingHorizontal=NaN,t.updateVertices(),_s(t.vertices,this.vertexOffset,0,0,r,e,n.transform.internalTransform,Rs),t.updateSteps(),Bs(t.steps,this.vertexOffset,c,a,v,b,this.antialiasWeight,Rs))},n.prototype.updateUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);i===this.texture&&r===this.textureTransformId||(this.texture=i,this.textureTransformId=r,t.updateUvs(),Ps(t.uvs,this.vertexOffset,this.toTextureUvs(i)))},n}(bt),Us=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=9+s,a=8+h;return t.check(i,r,o,a)?new Fs(t,i,r,s,h,o,a,e).init(n):null},zs=function(t){function i(i,r){return void 0===r&&(r=n.IMAGE_SDF),t.call(this,i,r)||this}return y(i,t),i.prototype.clone=function(){return new i(this.image).copy(this)},i}(Is),Gs=function(t,n){return ru.deserialize(t,n,new zs)},Hs=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){return t.prototype.init.call(this,n),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateLabelVertex(n,t),this.updateLabelUv(n,t),this.updateText(n,t)},n.prototype.updateLabelVertex=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s;(u||h)&&(this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.textSpacingHorizontal=NaN)},n.prototype.updateLabelUv=function(t,n){this.texture=this.toTexture(n)},n}(bt),Vs=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=s,a=h;return t.check(i,r,o,a)?new Hs(t,i,r,s,h,o,a,e).init(n):null},Ws=function(t){function i(i){return void 0===i&&(i=n.LABEL),t.call(this,i)||this}return y(i,t),i.prototype.clone=function(){return(new i).copy(this)},i}(at),Xs=function(t,n){return ru.deserialize(t,n,new Ws)},Ys=function(){e[n.LABEL]=Vs,i[n.LABEL]=Xs},Ks=function(t,n){for(var i=0,r=t.length-1;i<=r;){var e=i+(r-i>>1),u=t[e];if(n<u)r=e-1;else{if(!(u<n))return e;i=e+1}}return-1},Js=new t.Point,Zs=function(t){return 12*Math.ceil(t/12)*4+2},qs=function(t,n,i,r,e){var u=3*n;if(2<=r){e||(t[u+0]=1,t[u+1]=0,t[u+2]=3,t[u+3]=0,t[u+4]=1,t[u+5]=5,u+=6);for(var s=e?0:1,h=r-s;s<h;++s)t[u+0]=1,t[u+1]=0,t[u+2]=3,t[u+3]=0,t[u+4]=1,t[u+5]=5,t[u+6]=1,t[u+7]=0,t[u+8]=4,t[u+9]=0,t[u+10]=1,t[u+11]=6,u+=12;t[u+0]=1,t[u+1]=0,t[u+2]=3,t[u+3]=0,t[u+4]=1,t[u+5]=5,u+=6}for(var o=3*(n+i);u<o;u+=3)t[u+0]=0,t[u+1]=0,t[u+2]=0},$s=function(t,n,i,r){for(var e=3*i,u=3*(i+r),s=n;e<u;e+=6,s+=2)t[e+0]=s+0,t[e+1]=s+2,t[e+2]=s+1,t[e+3]=s+1,t[e+4]=s+2,t[e+5]=s+3},Qs=function(t,n,i,r,e,u,s,h){var o=i<<1;if(2<=e){var a=s.x0,c=s.x1,f=s.x2,l=s.x3,v=s.y0,b=s.y1,g=s.y2,d=s.y3,m=c-a,w=b-v,p=f-l,O=g-d,D=i<<2,E=1/Math.max(1e-5,h),M=0;u||(M=n[D]*E,t[o+0]=a+M*m,t[o+1]=v+M*w,t[o+2]=l+M*p,t[o+3]=d+M*O,o+=4,D+=8);for(var S=u?0:1,T=e-S;S<T;++S)M=n[D]*E,t[o+0]=a+M*m,t[o+1]=v+M*w,t[o+2]=l+M*p,t[o+3]=d+M*O,o+=4,M=n[D+=8]*E,t[o+0]=a+M*m,t[o+1]=v+M*w,t[o+2]=l+M*p,t[o+3]=d+M*O,o+=4,D+=8;M=n[D]*E,t[o+0]=a+M*m,t[o+1]=v+M*w,t[o+2]=l+M*p,t[o+3]=d+M*O,o+=4}for(var j=i+r<<1;o<j;o+=2)t[o+0]=0,t[o+1]=0},th=function(t,n,i,r,e,u,s,h,o,a,l,v){var b=r<<1,d=6*r,m=r<<2,w=0,p=0,O=0;if(2<=u){var D,E=f(a),M=0,S=0,T=0,j=0,N=0,I=0,C=0,A=0,R=0,y=!1,k=!1,x=m,L=0,B=v.a,_=v.b,P=v.c,F=v.d,U=v.tx,z=v.ty,G=h[0],H=h[1],V=B*G+P*H+U,W=_*G+F*H+z,X=0<=Ks(o,0),Y=u-1<<1,K=h[Y+0],J=h[Y+1],Z=B*K+P*J+U,q=_*K+F*J+z,$=0<=Ks(o,u-1),Q=Z,tt=q,nt=$;if(2<u){var it=h[2],rt=h[3];Q=B*it+P*rt+U,tt=_*it+F*rt+z,nt=0<=Ks(o,1)}s?(p=Z,O=q,A=V,R=W,y=$,k=X):(I=V-(Q-V),C=W-(tt-W),y=X,k=nt,T+=g(p=V,O=W,A=Q,R=tt),t[b+0]=p,t[b+1]=O,t[b+2]=p,t[b+3]=O,n[d+0]=l,n[d+1]=E,n[d+2]=I,n[d+3]=C,n[d+4]=A,n[d+5]=R,n[d+6]=l,n[d+7]=E,n[d+8]=I,n[d+9]=C,n[d+10]=A,n[d+11]=R,i[m+0]=N,i[m+4]=N,b+=4,d+=12,m+=8);for(var et=u-(bt=s?0:1);bt<et;++bt){if(I=p,C=O,p=A,O=R,y=k,bt===u-2)A=Z,R=q,k=$;else if(0===bt)A=Q,R=tt,k=nt;else if(bt<u-1){var ut=bt+1<<1,st=h[ut+0],ht=h[ut+1];A=B*st+P*ht+U,R=_*st+F*ht+z,k=0<=Ks(o,bt+1)}else A=V,R=W,k=X;S=M,M=T,T+=g(p,O,A,R);var ot=A,at=R,ct=L;if(y){I=p-(A-p),C=O-(R-O),w=Math.max(w,N);for(var ft=(D=c(j=S-L,l,a,Js)).x,lt=D.y,vt=x;vt<m+8;vt+=4)i[vt+1]=ft,i[vt+2]=lt,i[vt+3]=j;x=m+8,ct=L,L=M}else k&&(ot=p+(p-I),at=O+(O-C));t[b+0]=p,t[b+1]=O,t[b+2]=p,t[b+3]=O,n[d+0]=l,n[d+1]=E,n[d+2]=I,n[d+3]=C,n[d+4]=ot,n[d+5]=at,n[d+6]=l,n[d+7]=E,n[d+8]=I,n[d+9]=C,n[d+10]=ot,n[d+11]=at,j=M-ct,i[m+0]=j,i[m+4]=j,d+=12,m+=8,t[(b+=4)+0]=p,t[b+1]=O,t[b+2]=p,t[b+3]=O,n[d+0]=l,n[d+1]=E,n[d+2]=I,n[d+3]=C,n[d+4]=ot,n[d+5]=at,n[d+6]=l,n[d+7]=E,n[d+8]=I,n[d+9]=C,n[d+10]=ot,n[d+11]=at,N=M-L,i[m+0]=N,i[m+4]=N,b+=4,d+=12,m+=8}if(I=p,C=O,p=A,O=R,y=k,s?(A=Q,R=tt,k=nt):(A=p+(p-I),R=O+(O-C),k=!1),S=M,M=T,ot=A,at=R,ct=L,y){for(I=p-(A-p),C=O-(R-O),w=Math.max(w,N),ft=(D=c(j=S-L,l,a,Js)).x,lt=D.y,vt=x;vt<m+8;vt+=4)i[vt+1]=ft,i[vt+2]=lt,i[vt+3]=j;x=m+8,ct=L,L=M}else k&&(ot=p+(p-I),at=O+(O-C));if(t[b+0]=p,t[b+1]=O,t[b+2]=p,t[b+3]=O,n[d+0]=l,n[d+1]=E,n[d+2]=I,n[d+3]=C,n[d+4]=ot,n[d+5]=at,n[d+6]=l,n[d+7]=E,n[d+8]=I,n[d+9]=C,n[d+10]=ot,n[d+11]=at,j=M-ct,w=Math.max(w,j),i[m+0]=j,i[m+4]=j,b+=4,d+=12,x<(m+=8))if(ft=(D=c(j,l,a,Js)).x,lt=D.y,s)for(var bt=x;bt<m;bt+=4)i[bt+1]=ft,i[bt+2]=lt,i[bt+3]=-1;else for(bt=x;bt<m;bt+=4)i[bt+1]=ft,i[bt+2]=lt,i[bt+3]=j}for(var gt=r+e<<1;b<gt;b+=2,d+=6,m+=4)t[b+0]=p,t[b+1]=O,n[d+0]=0,n[d+1]=0,n[d+2]=0,n[d+3]=0,n[d+4]=0,n[d+5]=0,i[m+0]=0,i[m+1]=0,i[m+2]=0,i[m+4]=0;return w},nh=function(t){function n(n,i,r,e,u,s,h,o){var a=t.call(this,n,i,r,e,u,s,h,o)||this;return a.pointId=-1,a.pointCount=0,a.pointsClosed=!1,a.length=1,a}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.updateIndices(),$s(i.indices,this.vertexOffset,this.indexOffset,this.indexCount-this.textIndexCount),this.initText(),this.update(n),this},n.prototype.isCompatible=function(n){if(t.prototype.isCompatible.call(this,n)){var i=n.points;return Zs(i?i.length:0)===this.vertexCount-this.textVertexCount}return!1},n.prototype.update=function(t){var n=this.buffer;this.updateLineClipping(n,t),this.updateLineVertexStepAndColorFill(n,t),this.updateColor(n,t),this.updateLineUv(n,t),this.updateText(n,t)},n.prototype.updateLineClipping=function(t,n){var i=n.points;if(i){var e=i.length,u=!!(i.style&r.CLOSED);this.pointCount===e&&this.pointsClosed===u||(this.pointCount=e,this.pointsClosed=u,this.pointId=-1,t.updateClippings(),qs(t.clippings,this.vertexOffset,this.vertexCount-this.textVertexCount,e,u))}},n.prototype.updateLineVertexStepAndColorFill=function(t,n){var i=n.points;if(i){var r=i.id,e=r!==this.pointId,u=n.stroke,s=u.enable?u.width:0,h=s!==this.strokeWidth,o=this.toTransformLocalId(n),a=this.transformLocalId!==o;(e||a||h)&&(this.pointId=r,this.strokeWidth=s,this.transformLocalId=o,(e||a)&&(this.textSpacingHorizontal=NaN),e&&(this.textureTransformId=NaN),t.updateVertices(),t.updateSteps(),t.updateColorFills(),this.length=th(t.vertices,t.steps,t.colorFills,this.vertexOffset,this.vertexCount-this.textVertexCount,this.pointCount,this.pointsClosed,i.values,i.segments,i.style,s,n.transform.internalTransform))}},n.prototype.updateColorFillAndStroke=function(t,n,i){this.updateColorStroke(t,n,i)},n.prototype.updateLineUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r;var e=this.pointCount;t.updateUvs(),Qs(t.uvs,t.colorFills,this.vertexOffset,this.vertexCount-this.textVertexCount,e,this.pointsClosed,this.toTextureUvs(i),this.length)}},n}(bt),ih=function(t,n,i,r,e){var u=n.points,s=u?u.length:0,h=w(n),o=4*h,a=2*h,c=Zs(s)+o,f=c-o-2+a;return t.check(i,r,c,f)?new nh(t,i,r,o,a,c,f,e).init(n):null},rh=function(){function n(n,i,r,e){var u=[],s=0,h=0,o=0,a=0,c=i.length;if(2<=c){s=h=i[0],o=a=i[1];for(var f=2;f<c;f+=2){var l=i[f],v=i[f+1];s=Math.min(s,l),h=Math.max(h,l),o=Math.min(o,v),a=Math.max(a,v)}}var b=.5*(h+s),g=.5*(a+o);for(f=0;f<c;f+=2)l=i[f+0]-b,v=i[f+1]-g,u.push(l,v);var d=h-s,m=a-o;this.o=n,this.Wu=void 0,this.Xu=u.length,this.v=u,this.g=r.slice(0),this.Yu=new t.Point(d,m),this.size=new t.Point(d,m),this.position=new t.Point(b,g),this.l=0,this.O=e}return Object.defineProperty(n.prototype,"length",{get:function(){return this.v.length>>1},enumerable:!1,configurable:!0}),n.prototype.fitToParentSize=function(){var t=this.size,n=this.o.size,i=n.x,r=n.y,e=1e-5;if(e<Math.abs(i-t.x)||e<Math.abs(r-t.y)){t.set(i,r);var u=this.Yu,s=e<Math.abs(u.x),h=e<Math.abs(u.y);if(s||h){var o=s?i/u.x:1,a=h?r/u.y:1,c=this.v,f=this.Wu;if(null==f){f=[],this.Wu=f;for(var l=0,v=this.length<<1;l<v;l+=2){var b=c[l],g=c[l+1];c[l]=b*o,c[l+1]=g*a,f.push(b,g)}}else for(l=0,v=this.length<<1;l<v;l+=2)c[l]=f[l]*o,c[l+1]=f[l+1]*a;this.l+=1}}},Object.defineProperty(n.prototype,"id",{get:function(){return this.fitToParentSize(),this.l},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){return this.fitToParentSize(),this.v},set:function(t){this.set(t,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"segments",{get:function(){return this.g},set:function(t){this.set(void 0,t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.O},set:function(t){this.set(void 0,void 0,t)},enumerable:!1,configurable:!0}),n.prototype.copy=function(t){return this.set(t.values,t.segments,t.style)},n.prototype.set=function(t,n,i){var r=!1,e=!1;if(null!=t){var u=this.v,s=this.Xu,h=t.length,o=Math.min(h,s);if(this.Wu=void 0,u!==t){for(var a=0;a<o;++a)u[a]=t[a];for(a=o;a<h;++a)u.push(t[a]);s!==h?(u.length=h,this.Xu=h,r=!0):e=!0}else s!==h?(this.Xu=h,r=!0):e=!0}if(null!=n){var c=this.g;if(c!==n){var f=n.length;for(o=Math.min(c.length,f),a=0;a<o;++a)c[a]=n[a];for(a=o;a<f;++a)c.push(n[a]);c.length!==f&&(c.length=f)}e=!0}if(null!=i&&this.O!==i&&(this.O=i,e=!0),r){this.l+=1;var l=this.o,v=l.uploaded;v?v.isCompatible(l)?l.updateUploaded():(l.uploaded=void 0,l.toDirty()):l.updateUploaded()}else e&&(this.l+=1,this.o.updateUploaded());return this},n.prototype.clone=function(t){return new n(t,this.v,this.g,this.O)},n.prototype.toPoints=function(n){for(var i=[],r=this.values,e=0,u=r.length;e<u;e+=2){var s=new t.Point(r[e+0],r[e+1]);i.push(n.apply(s,s))}return i},n.prototype.serialize=function(t){return t.addResource("["+JSON.stringify(this.v)+","+JSON.stringify(this.g)+","+this.O+"]")},n.prototype.calcHitPointAbs=function(t,i,e,u,s,h,o,a){var c=this.length;if(2<=c){var f=this.v,l=this.g,v=0,b=c;if(h){var g=h(t,i,s,f,n.WORK_RANGE);v=g[0],b=g[1]}for(var d=v,m=Math.min(b,c-1),w=2*v;d<m;d+=1,w+=2)if(Ks(l,d+1)<0&&o(t,i,f[w+0],f[w+1],f[w+2],f[w+3],d,s,a))return!0;if(2<c&&c<=b&&this.style&r.CLOSED&&Ks(l,0)<0&&o(t,i,f[0+(w=(d=c-1)<<1)],f[w+1],f[0],f[1],d,s,a))return!0}return!1},n.WORK_RANGE=[0,0],n}(),eh=function(t){function i(r,e,u,s){var h=t.call(this,n.LINE)||this;return r instanceof i?h.copy(r):(h.fill.enable=!1,h.stroke.set(!0,void 0,void 0,u),h.tt=new rh(h,r,e,s),h.transform.position.copyFrom(h.tt.position),h.size.copyFrom(h.tt.size)),h}return y(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new i(this)},i}(ct),uh=function(t,n){var i=n.resources,r=t[15];if(0<=r&&r<i.length){var e=n.getExtension(r);null==e&&(e=JSON.parse(i[r]),n.setExtension(r,e));var u=new eh(e[0],e[1],q.STROKE_WIDTH,e[2]);return ru.deserialize(t,n,u)}return null},sh=function(){e[n.LINE]=ih,i[n.LINE]=uh},hh=function(t){return 12*Math.ceil(t/12)},oh=function(t,n,i,r,e,u,s,h){if(u)if(i.isStaticColor()){var o=i.getColor(0,s);if(i.isStaticAlpha()){var a=i.getAlpha(0,h);lt(o,a,t,n*r,e)}else for(var c=0,f=t;c<r;c+=1,f+=n)a=i.getAlpha(c,h),lt(o,a,f,n,e)}else if(i.isStaticAlpha())for(a=i.getAlpha(0,h),c=0,f=t;c<r;c+=1,f+=n)o=i.getColor(c,s),lt(o,a,f,n,e);else for(c=0,f=t;c<r;c+=1,f+=n)o=i.getColor(c,s),a=i.getAlpha(c,h),lt(o,a,f,n,e);else if(i.isStaticColor())o=i.getColor(0,s),lt(o,0,t,n*r,e);else for(c=0,f=t;c<r;c+=1,f+=n)o=i.getColor(c,s),lt(o,0,f,n,e)},ah=function(t,n,i,r,e,u,s,h){var o=w(n),a=4*o,c=2*o,f=n.points,l=hh(f?f.length:0),v=l*r+a,b=l*u+c;return t.check(i,e,v,b)?new h(t,i,e,a,c,v,b,s,l).init(n):null},ch=function(t,n,i){for(var r=3*n,e=3*(n+i);r<e;r+=3)t[r+0]=0,t[r+1]=0,t[r+2]=0},fh=function(t,n,i){for(var r=2*n,e=2*(n+i);r<e;r+=2)t[r+0]=0,t[r+1]=0},lh=function(t,n,i){for(var r=6*n,e=6*(n+i);r<e;r+=6)t[r+0]=0,t[r+1]=0,t[r+2]=0,t[r+3]=0,t[r+4]=0,t[r+5]=0},vh=function(t,n,i){for(var r=2*n,e=2*(n+i);r<e;r+=2)t[r+0]=0,t[r+1]=0},bh=function(t,n,i,r){for(var e=n+i,u=1;u<r;++u){for(var s=3*e,h=3*n,o=0;o<i;++o)t[s+0]=t[h+0],t[s+1]=t[h+1],t[s+2]=t[h+2],s+=3,h+=3;e+=i}},gh=function(t,n,i,r,e){for(var u=n,s=i+r,h=1;h<e;++h){for(var o=3*s,a=3*i,c=0;c<r;++c)t[o+0]=t[a+0]+u,t[o+1]=t[a+1]+u,t[o+2]=t[a+2]+u,o+=3,a+=3;u+=n,s+=r}},dh=function(t,n,i,r){for(var e=6*n,u=6*(n+i),s=1;s<r;++s)for(var h=e,o=0;o<i;++o)t[u+0]=t[h+0],t[u+1]=t[h+1],t[u+2]=t[h+2],t[u+3]=t[h+3],t[u+4]=t[h+4],t[u+5]=t[h+5],u+=6,h+=6},mh=function(t,n,i,r){for(var e=n+i,u=1;u<r;++u){for(var s=e<<1,h=n<<1,o=0;o<i;++o)t[s]=t[h],t[s+1]=t[h+1],s+=2,h+=2;e+=i}},wh=function(t,n,i,r,e,u,s){var h=n.a,o=n.b,a=n.c,c=n.d,f=e-1,l=i+f*r;if(s.isStaticX()&&s.isStaticY())for(var v=s.getX(0),b=s.getY(0);0<=f;--f){for(var g=h*(D=u[O=f<<1]+v)+a*(E=u[O+1]+b),d=o*D+c*E,m=l<<1,w=i<<1,p=0;p<r;++p)t[m]=t[w]+g,t[m+1]=t[w+1]+d,m+=2,w+=2;l-=r}else for(;0<=f;--f){var O,D,E;for(g=h*(D=u[O=f<<1]+s.getX(f))+a*(E=u[O+1]+s.getY(f)),d=o*D+c*E,m=l<<1,w=i<<1,p=0;p<r;++p)t[m]=t[w]+g,t[m+1]=t[w+1]+d,m+=2,w+=2;l-=r}},ph=function(t){return F(t)||null==t},Oh=function(t,n,i){return F(n)?n:_n(n)?n(t):n?n[t%n.length]:i},Dh=function(){function t(t){this.o=t,this.l=0,this.st=null,this.ht=null}return Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=!1;void 0!==t&&this.st!==t&&(i=!0,this.st=t),void 0!==n&&this.ht!==n&&(i=!0,this.ht=n),i&&(this.l+=1,this.o.updateUploaded())},t.prototype.getColor=function(t,n){return Oh(t,this.st,n)},t.prototype.getAlpha=function(t,n){return Oh(t,this.ht,n)},t.prototype.isStaticColor=function(){return ph(this.st)},t.prototype.isStaticAlpha=function(){return ph(this.ht)},t.prototype.toDirty=function(){this.l+=1},t}(),Eh=function(){function t(t,n,i){this.o=t,this.l=0,this._x=null,this._y=null,this.Ku=n,this.Ju=i,this.Zu=null,this.qu=0,this.$u=-1,this.Qu=0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"limit",{get:function(){return this.Zu},set:function(t){this.Zu=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=!1;void 0!==t&&this._x!==t&&(i=!0,this._x=t),void 0!==n&&this._y!==n&&(i=!0,this._y=n),i&&(this.l+=1,this.o.updateUploaded())},t.prototype.getX=function(t){return Oh(t,this._x,this.Ku)},t.prototype.getY=function(t){return Oh(t,this._y,this.Ju)},t.prototype.getLimit=function(){var t=this.Zu;return null!=t?t:(this.updateLimitComputed(),this.qu)},t.prototype.updateLimitComputed=function(){var t=this.l,n=this.o.length;this.$u===t&&this.Qu===n||(this.$u=t,this.Qu=n,this.qu=Math.max(this.calcLimit(this._x,n,this.Ku),this.calcLimit(this._y,n,this.Ju)))},t.prototype.calcLimit=function(t,n,i){if(F(t))return Math.abs(t);if(_n(t)){if(0<n){for(var r=Math.abs(t(0)),e=1;e<n;++e)r=Math.max(r,Math.abs(t(e)));return r}return 0}if(null!=t){var u=t.length;if(0<u){for(r=t[0],e=1;e<u;++e)r=Math.max(r,Math.abs(t[e]));return r}return 0}return Math.abs(i)},t.prototype.isStaticX=function(){return ph(this._x)},t.prototype.isStaticY=function(){return ph(this._y)},t.prototype.toDirty=function(){this.l+=1},t}(),Mh=function(){function t(t){this.o=t,this.l=0,this.st=null,this.ht=null}return Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=!1;void 0!==t&&this.st!==t&&(i=!0,this.st=t),void 0!==n&&this.ht!==n&&(i=!0,this.ht=n),i&&(this.l+=1,this.o.updateUploaded())},t.prototype.getColor=function(t,n){return Oh(t,this.st,n)},t.prototype.getAlpha=function(t,n){return Oh(t,this.ht,n)},t.prototype.isStaticColor=function(){return ph(this.st)},t.prototype.isStaticAlpha=function(){return ph(this.ht)},t.prototype.toDirty=function(){this.l+=1},t}(),Sh=function(){function n(t){this.o=t,this.v=[],this.ts=0,this.g=[],this.S=new Eh(this,q.SIZE_X,q.SIZE_Y),this.Lt=new Eh(this,0,0),this.Sr=new Dh(t),this.ns=new Mh(t),this.l=0}return Object.defineProperty(n.prototype,"length",{get:function(){return this.v.length>>1},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){return this.v},set:function(t){this.set(t,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"segments",{get:function(){return this.g},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return r.NONE},set:function(t){this.set(void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this.S},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"offset",{get:function(){return this.Lt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this.Sr},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this.ns},enumerable:!1,configurable:!0}),n.prototype.copy=function(t){return this.set(t.values,t.segments,t.style)},n.prototype.set=function(t,n,i){var r=!1,e=!1;if(null!=t){var u=this.v,s=this.ts,h=t.length;if(u!==t){for(var o=Math.min(s,h),a=0;a<o;++a)u[a]=t[a];for(a=o;a<h;++a)u.push(t[a]);s!==h?(u.length=h,this.ts=h,r=!0):e=!0}else s!==h?(this.ts=h,r=!0):e=!0}if(r){this.l+=1;var c=this.o,f=c.uploaded;f?f.isCompatible(c)?c.updateUploaded():(c.uploaded=void 0,c.toDirty()):c.updateUploaded()}else e&&(this.l+=1,this.o.updateUploaded());return this},n.prototype.updateUploaded=function(){this.o.updateUploaded()},n.prototype.clone=function(t){return new n(t)},n.prototype.toPoints=function(n){for(var i=[],r=this.values,e=0,u=r.length;e<u;e+=2){var s=new t.Point(r[e+0],r[e+1]);i.push(n.apply(s,s))}return i},n.prototype.serialize=function(t){return t.addResource("[]")},n.prototype.calcHitPointAbs=function(t,i,r,e,u,s){var h=this.length,o=this.v,a=this.S,c=this.Lt,f=0,l=h;if(e){var v=.5*a.getLimit(),b=c.getLimit(),g=e(t,i,v,v,b,b,r,o,n.WORK_RANGE);f=g[0],l=g[1]}u=u;for(var d=f,m=Math.min(l,h),w=f<<1;d<m;d+=1,w+=2){var p=o[w],O=o[w+1];if(u(t,i,.5*a.getX(d),.5*a.getY(d),c.getX(d),c.getY(d),p,O,d,r,s))return!0}return!1},n.WORK_RANGE=[0,0],n}(),Th=function(t){function n(n,i,r,e,u,s,h,o,a){var c=t.call(this,n,i,r,e,u,s,h,o)||this;return c.pointId=-1,c.pointCount=0,c.pointCountReserved=a,c.pointSizeId=-1,c.pointOffsetId=-1,c.pointFillId=-1,c.pointStrokeId=-1,c}return y(n,t),n.prototype.isCompatible=function(n){if(t.prototype.isCompatible.call(this,n)){var i=n.points;return hh(i?i.length:0)===this.pointCountReserved}return!1},n.prototype.updateLineOfAnyColorFill=function(t,n,i,r){var e=i.fill,u=e.id,s=u!==this.pointFillId,h=n.fill,o=n.visible&&h.enable,a=h.color,c=o?h.alpha:0,f=a!==this.colorFill||c!==this.alphaFill;(s||f)&&(this.colorFill=a,this.alphaFill=c,this.pointFillId=u,t.updateColorFills(),oh(this.vertexOffset,r,e,this.pointCountReserved,t.colorFills,o,a,c))},n.prototype.updateLineOfAnyColorStroke=function(t,n,i,r){var e=i.stroke,u=e.id,s=u!==this.pointStrokeId,h=n.stroke,o=n.visible&&h.enable,a=h.color,c=o?h.alpha:0,f=a!==this.colorStroke||c!==this.alphaStroke;(s||f)&&(this.colorStroke=a,this.alphaStroke=c,this.pointStrokeId=u,t.updateColorStrokes(),oh(this.vertexOffset,r,e,this.pointCountReserved,t.colorStrokes,o,a,c))},n}(bt),jh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.updateClippings(),i.updateIndices();var r=i.clippings,e=i.indices,u=this.vertexOffset,s=this.indexOffset,h=this.pointCountReserved;return 0<h&&(fu(r,u),bh(r,u,9,h),lu(e,u,s),gh(e,9,s,8,h)),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Sh&&(this.updateVertexAndStep(n,t,i),this.updateLineOfAnyColorFill(n,t,i,9),this.updateLineOfAnyColorStroke(n,t,i,9),this.updateUv(n,t),this.updateText(n,t))},n.prototype.updateVertexAndStep=function(t,n,i){var r=i.id,e=i.offset,u=e.id,s=r!==this.pointId||u!==this.pointOffsetId,h=i.size,o=h.id,a=o!==this.pointSizeId,c=n.size,f=c.x,l=c.y,v=f!==this.sizeX||l!==this.sizeY,b=this.toTransformLocalId(n),g=this.transformLocalId!==b,d=n.stroke,m=d.enable?d.width:0,w=d.align,p=this.strokeAlign!==w||this.strokeWidth!==m;if(s||a||v||g||p){this.pointId=r,this.pointCount=i.length,this.pointOffsetId=u,this.pointSizeId=o,this.sizeX=f,this.sizeY=l,this.transformLocalId=b,this.strokeWidth=m,this.strokeAlign=w,(v||g||p)&&(this.textSpacingHorizontal=NaN),t.updateVertices(),t.updateSteps();var O=this.pointCount,D=i.values,E=this.vertexOffset,M=t.vertices,S=t.steps,T=t.clippings,j=n.transform.internalTransform,N=this.antialiasWeight;if(0<O&&h.isStaticX()&&h.isStaticY()){var I=h.getX(0),C=h.getY(0);vu(M,E,0,0,I,C,w,m,j,au),wh(M,j,E,9,O,D,e),bu(S,T,E,m,N,au),dh(S,E,9,O)}else for(var A=0;A<O;++A){var R=A<<1,y=D[R]+e.getX(A),k=D[R+1]+e.getY(A),x=(I=h.getX(A),C=h.getY(A),E+9*A);vu(M,x,y,k,I,C,w,m,j,au),bu(S,T,x,m,N,au)}var L=E+9*O,B=9*(this.pointCountReserved-O);fh(M,L,B),lh(S,L,B)}},n.prototype.updateUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r,t.updateUvs();var e=t.uvs,u=this.vertexOffset,s=this.toTextureUvs(i),h=this.pointCountReserved;0<h&&(gu(e,u,s),mh(e,u,9,h))}},n}(Th),Nh=function(t,n,i,r,e){return ah(t,n,i,9,r,8,e,jh)},Ih=function(t,n){var i=t.stroke,r=t.points.size.getLimit()+(i.enable?i.width*i.align:0);return n?n(r,1):.5*r},Ch=function(t){function i(i){var r=t.call(this,n.LINE_OF_CIRCLES)||this;return i?r.copy(i):r.tt=new Sh(r),r.rs=function(t,n,i,e,u,s,h,o){return r.containsPointAbs(t,n,i,e,u,s,h,o)},r.es=function(t,n,i,e,u,s,h,o){return r.containsPointAbsBBox(t,n,i,e,u,s,h,o)},r}return y(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new i(this)},i.prototype.containsAbs=function(t,n,i,r){var e=Ih(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.tt.calcHitPointAbs(t,n,e,null,this.rs,null)},i.prototype.containsPointAbs=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbs.call(this,n-h-u,i-o-s,r,e)},i.prototype.containsPointAbsBBox=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbsBBox.call(this,n-h-u,i-o-s,r,e)},i.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,Y.WORK_RECT),s=Ih(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.tt.calcHitPointAbs(u.x,u.y,s,i,r||this.rs,e)},i}(wu),Ah=function(t,n){return ru.deserialize(t,n,new Ch)},Rh=function(){e[n.LINE_OF_CIRCLES]=Nh,i[n.LINE_OF_CIRCLES]=Ah},yh=36,kh=[0,0,0],xh=new t.Point,Lh=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+2,t[r+3]=n+1,t[r+4]=n+3,t[r+5]=n+2,t[(r+=6)+0]=n+4,t[r+1]=n+5,t[r+2]=n+6,t[r+3]=n+5,t[r+4]=n+7,t[r+5]=n+6,t[(r+=6)+0]=n+8,t[r+1]=n+9,t[r+2]=n+10,t[r+3]=n+9,t[r+4]=n+11,t[r+5]=n+10,t[(r+=6)+0]=n+12,t[r+1]=n+13,t[r+2]=n+14,t[r+3]=n+13,t[r+4]=n+15,t[r+5]=n+14,t[(r+=6)+0]=n+16,t[r+1]=n+17,t[r+2]=n+20,t[r+3]=n+17,t[r+4]=n+21,t[r+5]=n+20,t[(r+=6)+0]=n+17,t[r+1]=n+18,t[r+2]=n+21,t[r+3]=n+18,t[r+4]=n+22,t[r+5]=n+21,t[(r+=6)+0]=n+19,t[r+1]=n+21,t[r+2]=n+24,t[r+3]=n+21,t[r+4]=n+25,t[r+5]=n+24,t[(r+=6)+0]=n+21,t[r+1]=n+23,t[r+2]=n+26,t[r+3]=n+23,t[r+4]=n+27,t[r+5]=n+26,t[(r+=6)+0]=n+24,t[r+1]=n+25,t[r+2]=n+28,t[r+3]=n+25,t[r+4]=n+30,t[r+5]=n+28,t[(r+=6)+0]=n+26,t[r+1]=n+27,t[r+2]=n+30,t[r+3]=n+27,t[r+4]=n+32,t[r+5]=n+30,t[(r+=6)+0]=n+29,t[r+1]=n+30,t[r+2]=n+33,t[r+3]=n+30,t[r+4]=n+34,t[r+5]=n+33,t[(r+=6)+0]=n+30,t[r+1]=n+31,t[r+2]=n+34,t[r+3]=n+31,t[r+4]=n+35,t[r+5]=n+34},Bh=function(t,n,i,r,e,u,s,h,o,a,c){var f=s*h,l=.5*e+(0<=e?+f:-f),v=.5*u+(0<=u?+f:-f),b=Math.abs(l),d=Math.abs(v),m=o*Math.min(b,d),w=m/b,p=m/d,O=xh;O.set(i-l,r-v),a.apply(O,O);var D=O.x,E=O.y;O.set(i,r-v),a.apply(O,O);var M=O.x,S=O.y,T=M-D,j=S-E,N=w*T,I=w*j,C=D+N,A=E+I,R=M+T,y=S+j,k=R-N,x=y-I;O.set(i,r),a.apply(O,O);var L=O.x,B=O.y,_=L-M,P=B-S,F=p*_,U=p*P,z=M+F,G=S+U,H=z-T,V=G-j,W=H+N,X=V+I,Y=z+T,K=G+j,J=Y-N,Z=K-I,q=L-T,$=B-j,Q=L+T,tt=B+j,nt=L+_,it=B+P,rt=nt-F,et=it-U,ut=rt-T,st=et-j,ht=ut+N,ot=st+I,at=rt+T,ct=et+j,ft=at-N,lt=ct-I,vt=nt-T,bt=it-j,gt=vt+N,dt=bt+I,mt=nt+T,wt=it+j,pt=mt-N,Ot=wt-I;c[0]=g(D,E,C,A),c[1]=g(D,E,M,S),c[2]=g(D,E,q,$);var Dt=2*n;t[Dt+0]=D,t[Dt+1]=E,t[Dt+2]=C,t[Dt+3]=A,t[Dt+4]=H,t[Dt+5]=V,t[Dt+6]=W,t[Dt+7]=X,t[(Dt+=8)+0]=k,t[Dt+1]=x,t[Dt+2]=R,t[Dt+3]=y,t[Dt+4]=J,t[Dt+5]=Z,t[Dt+6]=Y,t[Dt+7]=K,t[(Dt+=8)+0]=ut,t[Dt+1]=st,t[Dt+2]=ht,t[Dt+3]=ot,t[Dt+4]=vt,t[Dt+5]=bt,t[Dt+6]=gt,t[Dt+7]=dt,t[(Dt+=8)+0]=ft,t[Dt+1]=lt,t[Dt+2]=at,t[Dt+3]=ct,t[Dt+4]=pt,t[Dt+5]=Ot,t[Dt+6]=mt,t[Dt+7]=wt,t[(Dt+=8)+0]=C,t[Dt+1]=A,t[Dt+2]=M,t[Dt+3]=S,t[Dt+4]=k,t[Dt+5]=x,t[(Dt+=6)+0]=H,t[Dt+1]=V,t[Dt+2]=W,t[Dt+3]=X,t[Dt+4]=z,t[Dt+5]=G,t[Dt+6]=J,t[Dt+7]=Z,t[Dt+8]=Y,t[Dt+9]=K,t[(Dt+=10)+0]=q,t[Dt+1]=$,t[Dt+2]=L,t[Dt+3]=B,t[Dt+4]=L,t[Dt+5]=B,t[Dt+6]=Q,t[Dt+7]=tt,t[(Dt+=8)+0]=ut,t[Dt+1]=st,t[Dt+2]=ht,t[Dt+3]=ot,t[Dt+4]=rt,t[Dt+5]=et,t[Dt+6]=ft,t[Dt+7]=lt,t[Dt+8]=at,t[Dt+9]=ct,t[(Dt+=10)+0]=gt,t[Dt+1]=dt,t[Dt+2]=nt,t[Dt+3]=it,t[Dt+4]=pt,t[Dt+5]=Ot},_h=function(t,n,i,r){var e=3*n,u=1-r[0]/r[1],s=1-r[0]/r[2];i&P.TOP_LEFT?(t[e+0]=1,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=1,e+=3):(t[e+0]=1,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,e+=3),i&P.TOP_RIGHT?(t[e+0]=0,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=1,e+=3):(t[e+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,e+=3),i&P.BOTTOM_LEFT?(t[e+0]=1,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=1,e+=3):(t[e+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,e+=3),i&P.BOTTOM_RIGHT?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=1,e+=3):(t[e+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=0,e+=3),t[e+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,e+=3},Ph=function(t,n,i,r,e,u,s){ou(s[0],i,u,hu);var h=hu[0],o=hu[1],a=hu[2];ou(s[1],i,u,hu);var c=hu[0],f=hu[1],l=hu[2];ou(s[2],i,u,hu);var v=hu[0],b=hu[1],g=hu[2],d=1-s[0]/s[1],m=1-s[0]/s[2],w=v,p=b,O=h,D=o;r&Du.TOP||(w=1,p=g,O=1,D=a);var E=c,M=f,S=h,T=o;r&Du.RIGHT||(E=1,M=l,S=1,T=a);var j=v,N=b,I=h,C=o;r&Du.BOTTOM||(j=1,N=g,I=1,C=a);var A=c,R=f,y=h,k=o;r&Du.LEFT||(A=1,R=l,y=1,k=a);var x=.5*(R+M),L=.5*(p+N),B=6*n;e&P.TOP_LEFT?(t[B+0]=y,t[B+1]=O,t[B+2]=k,t[B+3]=D,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=0,t[B+1]=O,t[B+2]=k,t[B+3]=D,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=y,t[B+1]=0,t[B+2]=k,t[B+3]=D,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=0,t[B+1]=0,t[B+2]=k,t[B+3]=D,t[B+4]=a,t[B+5]=a,B+=6):(t[B+0]=A,t[B+1]=w,t[B+2]=R,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A*d,t[B+1]=w,t[B+2]=R,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A,t[B+1]=w*m,t[B+2]=R,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A*d,t[B+1]=w*m,t[B+2]=R,t[B+3]=p,t[B+4]=l,t[B+5]=g,B+=6),e&P.TOP_RIGHT?(t[B+0]=0,t[B+1]=O,t[B+2]=T,t[B+3]=D,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=S,t[B+1]=O,t[B+2]=T,t[B+3]=D,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=0,t[B+1]=0,t[B+2]=T,t[B+3]=D,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=S,t[B+1]=0,t[B+2]=T,t[B+3]=D,t[B+4]=a,t[B+5]=a,B+=6):(t[B+0]=E*d,t[B+1]=w,t[B+2]=M,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E,t[B+1]=w,t[B+2]=M,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E*d,t[B+1]=w*m,t[B+2]=M,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E,t[B+1]=w*m,t[B+2]=M,t[B+3]=p,t[B+4]=l,t[B+5]=g,B+=6),e&P.BOTTOM_LEFT?(t[B+0]=y,t[B+1]=0,t[B+2]=k,t[B+3]=C,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=0,t[B+1]=0,t[B+2]=k,t[B+3]=C,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=y,t[B+1]=I,t[B+2]=k,t[B+3]=C,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=0,t[B+1]=I,t[B+2]=k,t[B+3]=C,t[B+4]=a,t[B+5]=a,B+=6):(t[B+0]=A,t[B+1]=j*m,t[B+2]=R,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A*d,t[B+1]=j*m,t[B+2]=R,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A,t[B+1]=j,t[B+2]=R,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A*d,t[B+1]=j,t[B+2]=R,t[B+3]=N,t[B+4]=l,t[B+5]=g,B+=6),e&P.BOTTOM_RIGHT?(t[B+0]=0,t[B+1]=0,t[B+2]=T,t[B+3]=C,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=S,t[B+1]=0,t[B+2]=T,t[B+3]=C,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=0,t[B+1]=I,t[B+2]=T,t[B+3]=C,t[B+4]=a,t[B+5]=a,t[(B+=6)+0]=S,t[B+1]=I,t[B+2]=T,t[B+3]=C,t[B+4]=a,t[B+5]=a,B+=6):(t[B+0]=E*d,t[B+1]=j*m,t[B+2]=M,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E,t[B+1]=j*m,t[B+2]=M,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E*d,t[B+1]=j,t[B+2]=M,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E,t[B+1]=j,t[B+2]=M,t[B+3]=N,t[B+4]=l,t[B+5]=g,B+=6),t[B+0]=A*d,t[B+1]=w,t[B+2]=R,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=0,t[B+1]=w,t[B+2]=x,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E*d,t[B+1]=w,t[B+2]=x,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A,t[B+1]=w*m,t[B+2]=R,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A*d,t[B+1]=w*m,t[B+2]=R,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=0,t[B+1]=w*m,t[B+2]=x,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E*d,t[B+1]=w*m,t[B+2]=M,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E,t[B+1]=w*m,t[B+2]=M,t[B+3]=p,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A,t[B+1]=0,t[B+2]=R,t[B+3]=L,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=0,t[B+1]=0,t[B+2]=R,t[B+3]=L,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=0,t[B+1]=0,t[B+2]=M,t[B+3]=L,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E,t[B+1]=0,t[B+2]=M,t[B+3]=L,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A,t[B+1]=j*m,t[B+2]=R,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A*d,t[B+1]=j*m,t[B+2]=R,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=0,t[B+1]=j*m,t[B+2]=x,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E*d,t[B+1]=j*m,t[B+2]=M,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E,t[B+1]=j*m,t[B+2]=M,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=A*d,t[B+1]=j,t[B+2]=R,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=0,t[B+1]=j,t[B+2]=x,t[B+3]=N,t[B+4]=l,t[B+5]=g,t[(B+=6)+0]=E*d,t[B+1]=j,t[B+2]=M,t[B+3]=N,t[B+4]=l,t[B+5]=g,B+=6},Fh=function(t,n,i,r){var e=i.x0,u=i.x1,s=i.x2,h=i.x3,o=i.y0,a=i.y1,c=i.y2,f=i.y3,l=.5*(e+u),v=.5*(o+a),b=.5*(h+s),g=.5*(f+c),d=.5*r[0]/r[1],m=.5*r[0]/r[2],w=d*(u-e),p=d*(a-o),O=m*(h-e),D=m*(f-o),E=2*n;t[E+0]=e,t[E+1]=o,t[E+2]=e+w,t[E+3]=o+p,t[E+4]=e+O,t[E+5]=o+D,t[E+6]=e+w+O,t[E+7]=o+p+D,t[(E+=8)+0]=u-w,t[E+1]=a-p,t[E+2]=u,t[E+3]=a,t[E+4]=u-w+O,t[E+5]=a-p+D,t[E+6]=u+O,t[E+7]=a+D,t[(E+=8)+0]=h-O,t[E+1]=f-D,t[E+2]=h+w-O,t[E+3]=f+p-D,t[E+4]=h,t[E+5]=f,t[E+6]=h+w,t[E+7]=f+p,t[(E+=8)+0]=s-w-O,t[E+1]=c-p-D,t[E+2]=s-O,t[E+3]=c-D,t[E+4]=s-w,t[E+5]=c-p,t[E+6]=s,t[E+7]=c,t[(E+=8)+0]=e+w,t[E+1]=o+p,t[E+2]=l,t[E+3]=v,t[E+4]=u-w,t[E+5]=a-p,t[(E+=6)+0]=e+O,t[E+1]=o+D,t[E+2]=e+O+w,t[E+3]=o+D+p,t[E+4]=l+O,t[E+5]=v+D,t[E+6]=u+O-w,t[E+7]=a+D-p,t[E+8]=u+O,t[E+9]=a+D;var M=.5*(e+s),S=.5*(o+c);t[(E+=10)+0]=.5*(e+h),t[E+1]=.5*(o+f),t[E+2]=M,t[E+3]=S,t[E+4]=M,t[E+5]=S,t[E+6]=.5*(u+s),t[E+7]=.5*(a+c),t[(E+=8)+0]=h-O,t[E+1]=f-D,t[E+2]=h-O+w,t[E+3]=f-D+p,t[E+4]=b-O,t[E+5]=g-D,t[E+6]=s-O-w,t[E+7]=c-D-p,t[E+8]=s-O,t[E+9]=c-D,t[(E+=10)+0]=h+w,t[E+1]=f+p,t[E+2]=b,t[E+3]=g,t[E+4]=s-w,t[E+5]=c-p},Uh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.updateIndices();var r=i.indices,e=this.vertexOffset,u=this.indexOffset,s=this.pointCountReserved;return 0<s&&(Lh(r,e,u),gh(r,yh,u,24,s)),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Sh&&(this.updateVertexClippingStepAndUv(n,t,i),this.updateLineOfAnyColorFill(n,t,i,yh),this.updateLineOfAnyColorStroke(n,t,i,yh),this.updateText(n,t))},n.prototype.updateVertexClippingStepAndUv=function(t,n,i){var r=i.id,e=i.offset,u=e.id,s=r!==this.pointId||u!==this.pointOffsetId,h=i.size,o=h.id,a=o!==this.pointSizeId,c=n.size,f=c.x,l=c.y,v=n.radius,b=f!==this.sizeX||l!==this.sizeY||v!==this.radius,g=this.toTransformLocalId(n),d=this.transformLocalId!==g,m=n.stroke,w=m.enable?m.width:0,p=m.align,O=m.side,D=this.strokeAlign!==p||this.strokeWidth!==w||this.strokeSide!==O,E=n.corner,M=E!==this.corner,S=this.toTexture(n),T=this.toTextureTransformId(S),j=S!==this.texture||T!==this.textureTransformId,N=s||a||b||D;if(N||d||M||j){this.pointId=r,this.pointCount=i.length,this.pointOffsetId=u,this.pointSizeId=o,this.sizeX=f,this.sizeY=l,this.radius=v,this.transformLocalId=g,this.strokeWidth=w,this.strokeAlign=p,this.strokeSide=O,this.corner=E,this.texture=S,this.textureTransformId=T,(b||d||D)&&(this.textSpacingHorizontal=NaN),t.updateVertices(),(N||d)&&t.updateSteps(),(N||M)&&t.updateClippings(),(N||j)&&t.updateUvs();var I=this.pointCount,C=i.values,A=this.vertexOffset,R=t.vertices,y=t.clippings,k=t.steps,x=t.uvs,L=n.transform.internalTransform,B=this.toTextureUvs(S),_=this.antialiasWeight;if(0<I&&h.isStaticX()&&h.isStaticY()){var P=h.getX(0),F=h.getY(0);Bh(R,A,0,0,P,F,p,w,v,L,kh),wh(R,L,A,yh,I,C,e),(N||d)&&(Ph(k,A,w,O,E,_,kh),dh(k,A,yh,I)),(N||M)&&(_h(y,A,E,kh),bh(y,A,yh,I)),(N||j)&&(Fh(x,A,B,kh),mh(x,A,yh,I))}else for(var U=0;U<I;++U){var z=U<<1,G=C[z]+e.getX(U),H=C[z+1]+e.getY(U),V=(P=h.getX(U),F=h.getY(U),A+U*yh);Bh(R,V,G,H,P,F,p,w,v,L,kh),(N||d)&&Ph(k,V,w,O,E,_,kh),(N||M)&&_h(y,V,E,kh),(N||j)&&Fh(x,V,B,kh)}var W=this.pointCountReserved,X=A+I*yh,Y=yh*(W-I);fh(R,X,Y),lh(k,X,Y),ch(y,X,Y),vh(x,X,Y)}},n}(Th),zh=function(t,n,i,r,e){return ah(t,n,i,yh,r,24,e,Uh)},Gh=function(t){function i(i){return void 0===i&&(i=n.RECTANGLE_ROUNDED),t.call(this,i)||this}return y(i,t),i.prototype.clone=function(){return(new i).copy(this)},i.prototype.us=function(t,n,i,r,e,u){var s=-i+e;if(t<=s)return n<=(h=-r+e)&&u&P.TOP_LEFT?(a=t-s)*a+(c=n-h)*c<=e*e:(o=+r-e)<=n&&u&P.BOTTOM_LEFT?(a=t-s)*a+(c=n-o)*c<=e*e:-i<=t;var h,o,a,c,f=+i-e;return f<=t?n<=(h=-r+e)&&u&P.TOP_RIGHT?(a=t-f)*a+(c=n-h)*c<=e*e:(o=+r-e)<=n&&u&P.BOTTOM_RIGHT?(a=t-f)*a+(c=n-o)*c<=e*e:t<=+i:-r<=n&&n<=+r},i.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=this.fill,s=this.stroke,h=s.enable?s.width:0;if(u.enable||0<h){var o=this.radius*Math.min(r,e),a=this.corner,c=s.side;if(this.us(n,i,r,e,o,a)){if(u.enable)return!0;var f=Math.max(0,r-h),l=Math.max(0,e-h),v=Math.max(0,o-h);if(!this.us(n,i,f,l,v,a)){if(c===Du.ALL)return!0;if(n<=-f+v){var b=0!=(c&Du.LEFT);return i<=-l+v?!(!(g=c&Du.TOP)||!b)||(g?-f<=i:!!b&&n<=-f):+l-v<=i?!(!(d=c&Du.BOTTOM)||!b)||(d?+f<=i:!!b&&n<=-f):b}if(+f-v<=n){var g,d,m=0!=(c&Du.RIGHT);return i<=-l+v?!(!(g=c&Du.TOP)||!m)||(g?-f<=i:!!m&&+f<=n):+l-v<=i?!(!(d=c&Du.BOTTOM)||!m)||(d?+f<=i:!!m&&+f<=n):m}return i<=-l+v?0!=(c&Du.TOP):+l-v<=i&&0!=(c&Du.BOTTOM)}}}}return!1},i}(at),Hh=function(t){function i(i){var r=t.call(this,n.LINE_OF_RECTANGLE_ROUNDEDS)||this;return i?r.copy(i):r.tt=new Sh(r),r.rs=function(t,n,i,e,u,s,h,o){return r.containsPointAbs(t,n,i,e,u,s,h,o)},r.es=function(t,n,i,e,u,s,h,o){return r.containsPointAbsBBox(t,n,i,e,u,s,h,o)},r}return y(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new i(this)},i.prototype.containsAbs=function(t,n,i,r){var e=Ih(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.tt.calcHitPointAbs(t,n,e,null,this.rs,null)},i.prototype.containsPointAbs=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbs.call(this,n-h-u,i-o-s,r,e)},i.prototype.containsPointAbsBBox=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbsBBox.call(this,n-h-u,i-o-s,r,e)},i.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,Y.WORK_RECT),s=Ih(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.tt.calcHitPointAbs(u.x,u.y,s,i,r||this.rs,e)},i}(Gh),Vh=function(t,n){return ru.deserialize(t,n,new Hh)},Wh=function(){e[n.LINE_OF_RECTANGLE_ROUNDEDS]=zh,i[n.LINE_OF_RECTANGLE_ROUNDEDS]=Vh,Eu.set(n.LINE_OF_RECTANGLE_ROUNDEDS,Qe.PRIMITIVE|Qe.STROKE_SIDE|Qe.BORDER_RADIUS)},Xh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.updateIndices();var r=i.indices,e=this.vertexOffset,u=this.indexOffset,s=this.pointCountReserved;return 0<s&&(ms(r,e,u),gh(r,ls,u,12,s)),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Sh&&(this.updateVertexClippingStepAndUv(n,t,i),this.updateLineOfAnyColorFill(n,t,i,ls),this.updateLineOfAnyColorStroke(n,t,i,ls),this.updateText(n,t))},n.prototype.updateVertexClippingStepAndUv=function(t,n,i){var r=i.id,e=i.offset,u=e.id,s=r!==this.pointId||u!==this.pointOffsetId,h=i.size,o=h.id,a=o!==this.pointSizeId,c=n.size,f=c.x,l=c.y,v=f!==this.sizeX||l!==this.sizeY,b=this.toTransformLocalId(n),g=this.transformLocalId!==b,d=n.stroke,m=d.enable?d.width:0,w=d.align,p=d.side,O=this.strokeAlign!==w||this.strokeWidth!==m||this.strokeSide!==p,D=this.toTexture(n),E=this.toTextureTransformId(D),M=D!==this.texture||E!==this.textureTransformId,S=s||a||v||O;if(S||g||M){this.pointId=r,this.pointCount=i.length,this.pointOffsetId=u,this.pointSizeId=o,this.transformLocalId=b,this.strokeWidth=m,this.strokeAlign=w,this.strokeSide=p,this.texture=D,this.textureTransformId=E,(v||g||O)&&(this.textSpacingHorizontal=NaN),t.updateVertices(),(S||g)&&t.updateSteps(),S&&t.updateClippings(),(S||M)&&t.updateUvs();var T=this.pointCount,j=i.values,N=this.vertexOffset,I=t.vertices,C=t.clippings,A=t.steps,R=t.uvs,y=n.transform.internalTransform,k=this.antialiasWeight,x=this.toTextureUvs(D);if(0<T&&h.isStaticX()&&h.isStaticY()){var L=h.getX(0),B=h.getY(0);ws(I,N,0,0,L,B,w,m,y,vs),wh(I,y,N,ls,T,j,e),(S||g)&&(Os(N,A,m,p,k,vs),dh(A,N,ls,T)),S&&(gs(C,N,vs),bh(C,N,ls,T)),(S||M)&&(Ms(R,N,x,vs),mh(R,N,ls,T))}else for(var _=0;_<T;++_){var P=_<<1,F=j[P]+e.getX(_),U=j[P+1]+e.getY(_),z=(L=h.getX(_),B=h.getY(_),N+_*ls);ws(I,z,F,U,L,B,w,m,y,vs),(S||g)&&Os(z,A,m,p,k,vs),S&&gs(C,z,vs),(S||M)&&Ms(R,z,x,vs)}var G=this.pointCountReserved,H=N+T*ls,V=ls*(G-T);fh(I,H,V),lh(A,H,V),ch(C,H,V),vh(R,H,V)}},n}(Th),Yh=function(t,n,i,r,e){return ah(t,n,i,ls,r,12,e,Xh)},Kh=function(t){function i(i){var r=t.call(this,n.LINE_OF_RECTANGLES)||this;return i?r.copy(i):r.tt=new Sh(r),r.rs=function(t,n,i,e,u,s,h,o){return r.containsPointAbs(t,n,i,e,u,s,h,o)},r.es=function(t,n,i,e,u,s,h,o){return r.containsPointAbsBBox(t,n,i,e,u,s,h,o)},r}return y(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new i(this)},i.prototype.containsAbs=function(t,n,i,r){var e=Ih(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.tt.calcHitPointAbs(t,n,e,null,this.rs,null)},i.prototype.containsPointAbs=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbs.call(this,n-h-u,i-o-s,r,e)},i.prototype.containsPointAbsBBox=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbsBBox.call(this,n-h-u,i-o-s,r,e)},i.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,Y.WORK_RECT),s=Ih(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.tt.calcHitPointAbs(u.x,u.y,s,i,r||this.rs,e)},i}(Ns),Jh=function(t,n){return ru.deserialize(t,n,new Kh)},Zh=function(){e[n.LINE_OF_RECTANGLES]=Yh,i[n.LINE_OF_RECTANGLES]=Jh,Eu.set(n.LINE_OF_RECTANGLES,Qe.PRIMITIVE|Qe.STROKE_SIDE)},qh=22,$h=[0,0,0,0,0],Qh=new t.Point,to=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+3,t[r+3]=n+1,t[r+4]=n+2,t[r+5]=n+3,t[r+6]=n+4,t[r+7]=n+5,t[r+8]=n+7,t[r+9]=n+5,t[r+10]=n+6,t[r+11]=n+7,t[r+12]=n+8,t[r+13]=n+9,t[r+14]=n+11,t[r+15]=n+9,t[r+16]=n+10,t[r+17]=n+11,t[r+18]=n+12,t[r+19]=n+13,t[r+20]=n+16,t[r+21]=n+13,t[r+22]=n+14,t[r+23]=n+16,t[r+24]=n+14,t[r+25]=n+15,t[r+26]=n+16,t[r+27]=n+12,t[r+28]=n+16,t[r+29]=n+19,t[r+30]=n+16,t[r+31]=n+17,t[r+32]=n+19,t[r+33]=n+17,t[r+34]=n+18,t[r+35]=n+19,t[r+36]=n+12,t[r+37]=n+19,t[r+38]=n+13,t[r+39]=n+19,t[r+40]=n+20,t[r+41]=n+13,t[r+42]=n+20,t[r+43]=n+21,t[r+44]=n+13},no=function(t,n,i,r,e,u,s,h,o,a,c){var f=s*h,l=.5*e+(0<=e?+f:-f),v=.5*u+(0<=u?+f:-f),b=Math.sqrt(l*l+4*v*v),d=2*l*v/(l+b),m=d*o/(2*v),w=.5*(b-d)*o/b,p=m*b/(2*l),O=Qh;O.set(i,r-v),a.apply(O,O);var D=O.x,E=O.y;O.set(i,r),a.apply(O,O);var M=O.x,S=O.y;O.set(i+l,r),a.apply(O,O);var T=M-D,j=S-E,N=O.x+T,I=O.y+j,C=M+(M-O.x)+T,A=S+(S-O.y)+j,R=N-D,y=I-E,k=D+w*R,x=E+w*y,L=N-m*R,B=I-m*y,_=p*(C-N),P=p*(A-I),F=N+_,U=I+P,z=C-_,G=A-P,H=D-C,V=E-A,W=C+m*H,X=A+m*V,Y=D-w*H,K=E-w*V;O.set(i,r+v-d),a.apply(O,O);var J=O.x,Z=O.y,q=D+o*(J-D),$=E+o*(Z-E),Q=N+o*(J-N),tt=I+o*(Z-I),nt=C+o*(J-C),it=A+o*(Z-A),rt=M+T,et=S+j;c[0]=g(rt,et,J,Z),c[1]=p,c[2]=m,c[3]=w,c[4]=1-.5*d/v;var ut=2*n;t[ut+0]=q,t[ut+1]=$,t[ut+2]=Y,t[ut+3]=K,t[ut+4]=D,t[ut+5]=E,t[ut+6]=k,t[ut+7]=x,t[ut+8]=Q,t[ut+9]=tt,t[ut+10]=L,t[ut+11]=B,t[ut+12]=N,t[ut+13]=I,t[ut+14]=F,t[ut+15]=U,t[ut+16]=nt,t[ut+17]=it,t[ut+18]=z,t[ut+19]=G,t[ut+20]=C,t[ut+21]=A,t[ut+22]=W,t[ut+23]=X,t[ut+24]=J,t[ut+25]=Z,t[ut+26]=q,t[ut+27]=$,t[ut+28]=k,t[ut+29]=x,t[ut+30]=L,t[ut+31]=B,t[ut+32]=Q,t[ut+33]=tt,t[ut+34]=F,t[ut+35]=U,t[ut+36]=z,t[ut+37]=G,t[ut+38]=nt,t[ut+39]=it,t[ut+40]=W,t[ut+41]=X,t[ut+42]=Y,t[ut+43]=K},io=function(t,n,i,r){var e=3*n,u=1-r;i&P.TOP?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[e+3]=1,t[e+4]=0,t[e+5]=1,t[e+6]=1,t[e+7]=1,t[e+8]=1,t[e+9]=0,t[e+10]=1,t[e+11]=1):(t[e+0]=u,t[e+1]=u,t[e+2]=0,t[e+3]=1,t[e+4]=u,t[e+5]=0,t[e+6]=1,t[e+7]=1,t[e+8]=0,t[e+9]=u,t[e+10]=1,t[e+11]=0),e+=12,i&P.BOTTOM_RIGHT?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[e+3]=1,t[e+4]=0,t[e+5]=1,t[e+6]=1,t[e+7]=1,t[e+8]=1,t[e+9]=0,t[e+10]=1,t[e+11]=1):(t[e+0]=u,t[e+1]=u,t[e+2]=0,t[e+3]=1,t[e+4]=u,t[e+5]=0,t[e+6]=1,t[e+7]=1,t[e+8]=0,t[e+9]=u,t[e+10]=1,t[e+11]=0),e+=12,i&P.BOTTOM_LEFT?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[e+3]=1,t[e+4]=0,t[e+5]=1,t[e+6]=1,t[e+7]=1,t[e+8]=1,t[e+9]=0,t[e+10]=1,t[e+11]=1):(t[e+0]=u,t[e+1]=u,t[e+2]=0,t[e+3]=1,t[e+4]=u,t[e+5]=0,t[e+6]=1,t[e+7]=1,t[e+8]=0,t[e+9]=u,t[e+10]=1,t[e+11]=0),t[(e+=12)+0]=0,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[e+3]=1,t[e+4]=0,t[e+5]=0,t[(e+=6)+0]=u,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[e+3]=1,t[e+4]=0,t[e+5]=0,t[(e+=6)+0]=u,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[e+3]=1,t[e+4]=0,t[e+5]=0},ro=function(t,n,i,r,e,u,s){var h=s[0];ou(h,r,u,hu);var o=hu[0],a=hu[1],c=hu[2];ou(e*h,r,u,hu);for(var f=hu[0],l=hu[1],v=hu[2],b=3*i,g=6*i,d=0;d<qh;++d){var m=o,w=a,p=c;.5<n[b+2]&&(m=f,w=l,p=v),t[g+0]=m*n[b+0],t[g+1]=m*n[b+1],t[g+2]=w,t[g+3]=w,t[g+4]=p,t[g+5]=p,b+=3,g+=6}},eo=function(t,n,i,r,e){var u=i.x0,s=i.x1,h=i.x2,o=i.x3,a=i.y0,c=i.y1,f=i.y2,l=i.y3,v=.5*(u+s),b=.5*(a+c),g=e[4],d=v+g*(o-u),m=b+g*(l-a),w=e[1],p=e[2],O=e[3],D=v+O*(o-v),E=b+O*(l-b),M=v+r*(d-v),S=b+r*(m-b),T=v+O*(h-v),j=b+O*(f-b),N=h+p*(v-h),I=f+p*(b-f),C=h+r*(d-h),A=f+r*(m-f),R=h+w*(o-h),y=f+w*(l-f),k=o+w*(h-o),x=l+w*(f-l),L=o+r*(d-o),B=l+r*(m-l),_=o+p*(v-o),P=l+p*(b-l),F=2*n;t[F+0]=M,t[F+1]=S,t[F+2]=D,t[F+3]=E,t[F+4]=v,t[F+5]=b,t[F+6]=T,t[F+7]=j,t[(F+=8)+0]=C,t[F+1]=A,t[F+2]=N,t[F+3]=I,t[F+4]=h,t[F+5]=f,t[F+6]=R,t[F+7]=y,t[(F+=8)+0]=L,t[F+1]=B,t[F+2]=k,t[F+3]=x,t[F+4]=o,t[F+5]=l,t[F+6]=_,t[F+7]=P,t[(F+=8)+0]=d,t[F+1]=m,t[F+2]=M,t[F+3]=S,t[F+4]=T,t[F+5]=j,t[F+6]=N,t[F+7]=I,t[F+8]=C,t[F+9]=A,t[F+10]=R,t[F+11]=y,t[F+12]=k,t[F+13]=x,t[F+14]=L,t[F+15]=B,t[F+16]=_,t[F+17]=P,t[F+18]=D,t[F+19]=E},uo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.updateIndices();var r=this.vertexOffset,e=this.indexOffset,u=this.pointCountReserved;return 0<u&&(to(i.indices,r,e),gh(i.indices,qh,e,15,u)),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Sh&&(this.updateVertexClippingStepAndUv(n,t,i),this.updateLineOfAnyColorFill(n,t,i,qh),this.updateLineOfAnyColorStroke(n,t,i,qh),this.updateText(n,t))},n.prototype.updateVertexClippingStepAndUv=function(t,n,i){var r=i.id,e=i.offset,u=e.id,s=r!==this.pointId||u!==this.pointOffsetId,h=i.size,o=h.id,a=o!==this.pointSizeId,c=n.size,f=c.x,l=c.y,v=f!==this.sizeX||l!==this.sizeY,b=n.radius,g=b!==this.radius,d=this.toTransformLocalId(n),m=this.transformLocalId!==d,w=n.stroke,p=w.enable?w.width:0,O=w.align,D=this.strokeAlign!==O||this.strokeWidth!==p,E=n.corner,M=this.corner!==E,S=this.toTexture(n),T=this.toTextureTransformId(S),j=S!==this.texture||T!==this.textureTransformId,N=s||a||v||g||D;if(N||m||M||j){this.pointId=r,this.pointCount=i.length,this.pointOffsetId=u,this.pointSizeId=o,this.sizeX=f,this.sizeY=l,this.radius=b,this.transformLocalId=d,this.strokeWidth=p,this.strokeAlign=O,this.corner=E,this.texture=S,this.textureTransformId=T,(v||m||D)&&(this.textSpacingHorizontal=NaN),t.updateVertices(),(N||M)&&t.updateClippings(),(N||m||M)&&t.updateSteps(),(N||j)&&t.updateUvs();var I=this.pointCount,C=i.values,A=this.vertexOffset,R=t.vertices,y=t.clippings,k=t.steps,x=t.uvs,L=n.transform.internalTransform,B=this.toTextureUvs(S),_=this.antialiasWeight;if(0<I&&h.isStaticX()&&h.isStaticY()){var P=h.getX(0),F=h.getY(0);no(R,A,0,0,P,F,O,p,b,L,$h),wh(R,L,A,qh,I,C,e),(N||M)&&(io(y,A,E,b),bh(y,A,qh,I)),(N||m||M)&&(ro(k,y,A,p,b,_,$h),dh(k,A,qh,I)),(N||j)&&(eo(x,A,B,b,$h),mh(x,A,qh,I))}else for(var U=0;U<I;++U){var z=U<<1,G=C[z]+e.getX(U),H=C[z+1]+e.getY(U),V=(P=h.getX(U),F=h.getY(U),A+U*qh);no(R,V,G,H,P,F,O,p,b,L,$h),(N||M)&&io(y,V,E,b),(N||m||M)&&ro(k,y,V,p,b,_,$h),(N||j)&&eo(x,V,B,b,$h)}var W=this.pointCountReserved,X=A+I*qh,Y=qh*(W-I);fh(R,X,Y),lh(k,X,Y),ch(y,X,Y),vh(x,X,Y)}},n}(Th),so=function(t,n,i,r,e){return ah(t,n,i,qh,r,15,e,uo)},ho=function(t){function i(i){return void 0===i&&(i=n.TRIANGLE),t.call(this,i)||this}return y(i,t),i.prototype.clone=function(){return(new i).copy(this)},i.prototype.us=function(t,n,i,r,e){return+i*t+r-n<=0&&-i*t+r-n<=0&&n<=e},i.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=2*e/r;if(this.fill.enable){if(this.us(n,i,u,-e,+e))return!0}else{var s=this.stroke,h=s.width;if(s.enable&&0<h&&this.us(n,i,u,-e,+e)){var o=2*r*e/(r+Math.sqrt(r*r+4*e*e)),a=e-o,c=a+(-e-a)*Math.max(0,o-h)/o,f=e-h;if(!this.us(n,i,u,c,f))return!0}}}return!1},i}(at),oo=1e-5,ao=function(t){function i(i){return void 0===i&&(i=n.TRIANGLE_ROUNDED),t.call(this,i)||this}return y(i,t),i.prototype.clone=function(){return(new i).copy(this)},i.prototype.ss=function(t,n,i,r){if(this.fill.enable){if(t*t+n*n<=i*i)return!0}else{var e=this.stroke,u=e.width;if(e.enable&&0<u){var s=t*t+n*n;if(s<=i*i){var h=Math.max(0,i*(1-u/r));if(h*h<=s)return!0}}}},i.prototype.containsCorner=function(t,n,i,r,e,u,s,h,o,a,c,f,l,v){var b=e+c*(s-e)-i,g=u+c*(h-u)-r,d=Math.sqrt(b*b+g*g);if(oo<d){var m=1/d,w=b*m,p=g*m,O=(e+f*(o-e)-i)*m,D=(u+f*(a-u)-r)*m,E=w*D-O*p;if(oo<Math.abs(E)){var M=1/E,S=t-i,T=n-r,j=(+D*S-O*T)*M,N=(-p*S+w*T)*M;if(this.ss(j,N,d,l*v))return!0}}},i.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=2*e/r;if(this.us(n,i,u,-e,+e)){var s=Math.sqrt(r*r+4*e*e),h=2*r*e/(r+s),o=this.radius,a=e-h,c=-e,f=+r,l=+e,v=-f,b=+l,g=0+0*o,d=c+o*(a-c),m=f+o*(0-f),w=l+o*(a-l),p=+w,O=-m,D=-u*n+d-i<=0,E=+u*n+d-i<=0,M=i<=w,S=this.corner;if(!D&&!E&&S&P.TOP){var T=.5*(s-h)*o/s;if(this.containsCorner(n,i,g,d,0,c,v,b,f,l,T,T,h,o))return!0}else if(!D&&!M&&S&P.BOTTOM_LEFT){var j=(N=h*o/(2*e))*s/(2*r);if(this.containsCorner(n,i,O,p,v,b,f,l,0,c,j,N,h,o))return!0}else if(!E&&!M&&S&P.BOTTOM_RIGHT){var N;if(j=(N=h*o/(2*e))*s/(2*r),this.containsCorner(n,i,m,w,f,l,0,c,v,b,N,j,h,o))return!0}else{if(this.fill.enable)return!0;var I=this.stroke,C=I.width;if(I.enable&&0<C){var A=e-h,R=A+(-e-A)*Math.max(0,h-C)/h,y=e-C;if(!this.us(n,i,u,R,y))return!0}}}}return!1},i}(ho),co=function(t){function i(i){var r=t.call(this,n.LINE_OF_TRIANGLE_ROUNDEDS)||this;return i?r.copy(i):r.tt=new Sh(r),r.rs=function(t,n,i,e,u,s,h,o){return r.containsPointAbs(t,n,i,e,u,s,h,o)},r.es=function(t,n,i,e,u,s,h,o){return r.containsPointAbsBBox(t,n,i,e,u,s,h,o)},r}return y(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new i(this)},i.prototype.containsAbs=function(t,n,i,r){var e=Ih(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.tt.calcHitPointAbs(t,n,e,null,this.rs,null)},i.prototype.containsPointAbs=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbs.call(this,n-h-u,i-o-s,r,e)},i.prototype.containsPointAbsBBox=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbsBBox.call(this,n-h-u,i-o-s,r,e)},i.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,Y.WORK_RECT),s=Ih(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.tt.calcHitPointAbs(u.x,u.y,s,i,r||this.rs,e)},i}(ao),fo=function(t,n){return ru.deserialize(t,n,new co)},lo=function(){e[n.LINE_OF_TRIANGLE_ROUNDEDS]=so,i[n.LINE_OF_TRIANGLE_ROUNDEDS]=fo,Eu.set(n.LINE_OF_TRIANGLE_ROUNDEDS,Qe.PRIMITIVE|Qe.STROKE_SIDE|Qe.BORDER_RADIUS)},vo=[0,0,0],bo=new t.Point,go=function(t,n){var i=3*n;t[i+0]=0,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=0,t[i+1]=1,t[i+2]=0,t[(i+=3)+0]=0,t[i+1]=1,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0},mo=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+2,t[r+3]=n+0,t[r+4]=n+3,t[r+5]=n+4,t[r+6]=n+0,t[r+7]=n+5,t[r+8]=n+6},wo=function(t,n,i,r,e,u,s,h,o,a){var c=s*h,f=.5*e+(0<=e?+c:-c),l=.5*u+(0<=u?+c:-c),v=2*f*l/(f+Math.sqrt(f*f+4*l*l)),b=bo;b.set(i,r-l),o.apply(b,b);var d=b.x,m=b.y;b.set(i,r),o.apply(b,b);var w=b.x,p=b.y;b.set(i+f,r),o.apply(b,b);var O=w-d,D=p-m,E=b.x+O,M=b.y+D,S=w+(w-b.x)+O,T=p+(p-b.y)+D;b.set(i,r+l-v),o.apply(b,b);var j=b.x,N=b.y,I=w+O,C=p+D;a[0]=g(I,C,j,N),a[1]=g(E,M,I,C),a[2]=g(d,m,w,p);var A=n<<1;t[A+0]=j,t[A+1]=N,t[A+2]=d,t[A+3]=m,t[A+4]=E,t[A+5]=M,t[A+6]=E,t[A+7]=M,t[A+8]=S,t[A+9]=T,t[A+10]=S,t[A+11]=T,t[A+12]=d,t[A+13]=m},po=function(t,n,i,r,e,u,s){ou(s[0],e,u,hu);var h=hu[0],o=hu[1],a=hu[2];su(t,n,i,r,h,h,o,o,a,a)},Oo=function(t,n,i,r){var e=n.x0,u=n.x1,s=n.x2,h=n.x3,o=n.y0,a=n.y1,c=n.y2,f=n.y3,l=.5*(e+u),v=.5*(o+a),b=1-.5*r[0]/r[2],g=l+b*(h-e),d=v+b*(f-o),m=i<<1;t[m+0]=g,t[m+1]=d,t[m+2]=l,t[m+3]=v,t[m+4]=s,t[m+5]=c,t[m+6]=s,t[m+7]=c,t[m+8]=h,t[m+9]=f,t[m+10]=h,t[m+11]=f,t[m+12]=l,t[m+13]=v},Do=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.updateClippings(),i.updateIndices();var r=i.clippings,e=i.indices,u=this.vertexOffset,s=this.indexOffset,h=this.pointCountReserved;return 0<h&&(go(r,u),bh(r,u,7,h),mo(e,u,s),gh(e,7,s,3,h)),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Sh&&(this.updateVertexStepAndUvs(n,t,i),this.updateLineOfAnyColorFill(n,t,i,7),this.updateLineOfAnyColorStroke(n,t,i,7),this.updateText(n,t))},n.prototype.updateVertexStepAndUvs=function(t,n,i){var r=i.id,e=i.offset,u=e.id,s=r!==this.pointId||u!==this.pointOffsetId,h=i.size,o=h.id,a=o!==this.pointSizeId,c=n.size,f=c.x,l=c.y,v=f!==this.sizeX||l!==this.sizeY,b=this.toTransformLocalId(n),g=this.transformLocalId!==b,d=n.stroke,m=d.enable?d.width:0,w=d.align,p=this.strokeAlign!==w||this.strokeWidth!==m,O=this.toTexture(n),D=this.toTextureTransformId(O),E=O!==this.texture||D!==this.textureTransformId,M=s||a||v||p;if(M||g||E){this.pointId=r,this.pointCount=i.length,this.pointOffsetId=u,this.pointSizeId=o,this.sizeX=f,this.sizeY=l,this.transformLocalId=b,this.strokeWidth=m,this.strokeAlign=w,(v||g||p)&&(this.textSpacingHorizontal=NaN),t.updateVertices(),(M||g)&&t.updateSteps(),(M||E)&&t.updateUvs();var S=this.pointCount,T=i.values,j=this.vertexOffset,N=t.vertices,I=t.steps,C=t.clippings,A=t.uvs,R=this.toTextureUvs(O),y=n.transform.internalTransform,k=this.antialiasWeight;if(0<S&&h.isStaticX()&&h.isStaticY()){var x=h.getX(0),L=h.getY(0);wo(N,j,0,0,x,L,w,m,y,vo),wh(N,y,j,7,S,T,e),(M||g)&&(po(I,C,j,7,m,k,vo),dh(I,j,7,S)),(M||E)&&(Oo(A,R,j,vo),mh(A,j,7,S))}else for(var B=0;B<S;++B){var _=B<<1,P=T[_]+e.getX(B),F=T[_+1]+e.getY(B),U=(x=h.getX(B),L=h.getY(B),j+7*B);wo(N,U,P,F,x,L,w,m,y,vo),(M||g)&&po(I,C,U,7,m,k,vo),(M||E)&&Oo(A,R,U,vo)}var z=j+7*S,G=7*(this.pointCountReserved-S);fh(N,z,G),lh(I,z,G),vh(A,z,G)}},n}(Th),Eo=function(t,n,i,r,e){return ah(t,n,i,7,r,3,e,Do)},Mo=function(t){function i(i){var r=t.call(this,n.LINE_OF_TRIANGLES)||this;return i?r.copy(i):r.tt=new Sh(r),r.rs=function(t,n,i,e,u,s,h,o){return r.containsPointAbs(t,n,i,e,u,s,h,o)},r.es=function(t,n,i,e,u,s,h,o){return r.containsPointAbsBBox(t,n,i,e,u,s,h,o)},r}return y(i,t),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),i.prototype.clone=function(){return new i(this)},i.prototype.containsAbs=function(t,n,i,r){var e=Ih(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.tt.calcHitPointAbs(t,n,e,null,this.rs,null)},i.prototype.containsPointAbs=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbs.call(this,n-h-u,i-o-s,r,e)},i.prototype.containsPointAbsBBox=function(n,i,r,e,u,s,h,o){return t.prototype.containsAbsBBox.call(this,n-h-u,i-o-s,r,e)},i.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,Y.WORK_RECT),s=Ih(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.tt.calcHitPointAbs(u.x,u.y,s,i,r||this.rs,e)},i}(ho),So=function(t,n){return ru.deserialize(t,n,new Mo)},To=function(){e[n.LINE_OF_TRIANGLES]=Eo,i[n.LINE_OF_TRIANGLES]=So},jo=function(n){function i(t,i,r){return n.call(this,t,i,r,0,0,1)||this}return y(i,n),i.prototype.init=function(i){return n.prototype.init.call(this,i),this.texture=i.texture||t.Texture.WHITE,this},i.prototype.update=function(t){},i}(vt),No=function(t,n,i,r){return new jo(t,i,r).init(n)},Io=function(t){function i(i){return void 0===i&&(i=n.NULL),t.call(this,i)||this}return y(i,t),i.prototype.clone=function(){return(new i).copy(this)},i}(at),Co=function(t,n){return ru.deserialize(t,n,new Io)},Ao=function(){e[n.NULL]=No,i[n.NULL]=Co},Ro=function(t,n){return ru.deserialize(t,n,new Ns)},yo=function(){e[n.RECTANGLE]=js,i[n.RECTANGLE]=Ro,Eu.set(n.RECTANGLE,Qe.PRIMITIVE|Qe.STROKE_SIDE)},ko=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.updateIndices(),Lh(i.indices,this.vertexOffset,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexClippingStepAndUv(n,t),this.updateColor(n,t),this.updateText(n,t)},n.prototype.updateVertexClippingStepAndUv=function(t,n){var i=n.size,r=i.x,e=i.y,u=n.radius,s=r!==this.sizeX||e!==this.sizeY||u!==this.radius,h=this.toTransformLocalId(n),o=this.transformLocalId!==h,a=n.stroke,c=a.enable?a.width:0,f=a.align,l=a.side,v=this.strokeAlign!==f||this.strokeWidth!==c||this.strokeSide!==l,b=n.corner,g=b!==this.corner,d=this.toTexture(n),m=this.toTextureTransformId(d),w=d!==this.texture||m!==this.textureTransformId,p=s||v;if(p||o||g||w){this.sizeX=r,this.sizeY=e,this.radius=u,this.transformLocalId=h,this.strokeAlign=f,this.strokeWidth=c,this.strokeSide=l,this.corner=b,this.texture=d,this.textureTransformId=m,(p||o)&&(this.textSpacingHorizontal=NaN);var O=this.vertexOffset;t.updateVertices(),Bh(t.vertices,O,0,0,r,e,f,c,u,n.transform.internalTransform,kh),(p||g||o)&&(t.updateSteps(),Ph(t.steps,O,c,l,b,this.antialiasWeight,kh)),(p||g)&&(t.updateClippings(),_h(t.clippings,O,b,kh)),(p||w)&&(t.updateUvs(),Fh(t.uvs,O,this.toTextureUvs(d),kh))}},n}(bt),xo=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=yh+s,a=24+h;return t.check(i,r,o,a)?new ko(t,i,r,s,h,o,a,e).init(n):null},Lo=function(t,n){return ru.deserialize(t,n,new Gh)},Bo=function(){e[n.RECTANGLE_ROUNDED]=xo,i[n.RECTANGLE_ROUNDED]=Lo,Eu.set(n.RECTANGLE_ROUNDED,Qe.PRIMITIVE|Qe.STROKE_SIDE|Qe.BORDER_RADIUS)},_o=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.updateClippings(),i.updateIndices(),go(i.clippings,this.vertexOffset),mo(i.indices,this.vertexOffset,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexStepAndUv(n,t),this.updateColor(n,t),this.updateText(n,t)},n.prototype.updateVertexStepAndUv=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s,o=n.stroke,a=o.enable?o.width:0,c=o.align,f=this.strokeAlign!==c||this.strokeWidth!==a,l=this.toTexture(n),v=this.toTextureTransformId(l),b=l!==this.texture||v!==this.textureTransformId,g=u||f;if(g||h||b){this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.strokeWidth=a,this.strokeAlign=c,this.texture=l,this.textureTransformId=v,(g||h)&&(this.textSpacingHorizontal=NaN);var d=this.vertexOffset;t.updateVertices(),wo(t.vertices,d,0,0,r,e,c,a,n.transform.internalTransform,vo),(g||h)&&(t.updateSteps(),po(t.steps,t.clippings,d,7,a,this.antialiasWeight,vo)),(g||b)&&(t.updateUvs(),Oo(t.uvs,this.toTextureUvs(l),d,vo))}},n}(bt),Po=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=7+s,a=3+h;return t.check(i,r,o,a)?new _o(t,i,r,s,h,o,a,e).init(n):null},Fo=function(t,n){return ru.deserialize(t,n,new ho)},Uo=function(){e[n.TRIANGLE]=Po,i[n.TRIANGLE]=Fo},zo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.updateIndices(),to(i.indices,this.vertexOffset,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexClippingStepAndUv(n,t),this.updateColor(n,t),this.updateText(n,t)},n.prototype.updateVertexClippingStepAndUv=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=n.radius,h=s!==this.radius,o=this.toTransformLocalId(n),a=this.transformLocalId!==o,c=n.stroke,f=c.enable?c.width:0,l=c.align,v=this.strokeAlign!==l||this.strokeWidth!==f,b=n.corner,g=b!==this.corner,d=this.toTexture(n),m=this.toTextureTransformId(d),w=d!==this.texture||m!==this.textureTransformId,p=u||h||v;if(p||a||g||w){this.sizeX=r,this.sizeY=e,this.radius=s,this.transformLocalId=o,this.strokeWidth=f,this.strokeAlign=l,this.corner=b,this.texture=d,this.textureTransformId=m,(u||a||v)&&(this.textSpacingHorizontal=NaN);var O=this.vertexOffset;t.updateVertices(),no(t.vertices,O,0,0,r,e,l,f,s,n.transform.internalTransform,$h),(h||g)&&(t.updateClippings(),io(t.clippings,O,b,s)),(p||a||g)&&(t.updateSteps(),ro(t.steps,t.clippings,O,f,n.radius,this.antialiasWeight,$h)),(p||w)&&(t.updateUvs(),eo(t.uvs,O,this.toTextureUvs(d),s,$h))}},n}(bt),Go=function(t,n,i,r,e){var u=w(n),s=4*u,h=2*u,o=qh+s,a=15+h;return t.check(i,r,o,a)?new zo(t,i,r,s,h,o,a,e).init(n):null},Ho=function(t,n){return ru.deserialize(t,n,new ao)},Vo=function(){e[n.TRIANGLE_ROUNDED]=Go,i[n.TRIANGLE_ROUNDED]=Ho,Eu.set(n.TRIANGLE_ROUNDED,Qe.PRIMITIVE|Qe.STROKE_SIDE|Qe.BORDER_RADIUS)},Wo=function(){uu(),Ou(),ns(),fs(),hs(),As(),e[n.IMAGE_SDF]=Us,i[n.IMAGE_SDF]=Gs,Ys(),sh(),Ao(),Bo(),yo(),Vo(),Uo(),Rh(),Wh(),Zh(),lo(),To()},Xo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DImage"},n}(fr),Yo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.buttonMode=!0,this.gt=function(t){return null!=t&&null!=t.value?t.value:null}(n)},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},set:function(t){this.gt=t},enumerable:!1,configurable:!0}),n.prototype.hasSelection=function(t){return t&&t.selection&&t.selection.add},n.prototype.getSelection=function(){for(var t=this.parent;t;){if(this.hasSelection(t))return t.selection;t=t.parent}return null},n.prototype.onSelect=function(t){this.emit("select",this);var n=this.getSelection();n&&n.add(this)},n.prototype.onKeyDown=function(n){return this.state.isActionable&&this.state.isFocused&&pt.isActivateKey(n)&&this.onSelect(n),t.prototype.onKeyDown.call(this,n)},n.prototype.onStateChange=function(n,i){t.prototype.onStateChange.call(this,n,i),this.buttonMode=n.isActionable},n.prototype.getType=function(){return"DListItem"},n}(Xo),Ko=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getContext=function(){for(var t=this.parent;t;){if(t.getContext)return t.getContext();t=t.parent}return null},n.prototype.getCloseable=function(){for(var t=this.parent;t;){if(t.getCloseable)return t.getCloseable();t=t.parent}return null},n.prototype.getType=function(){return"DMenuItem"},n}(Yo),Jo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.initOnClick(n),this.initOnOver(n),this.initShortcuts(n)},n.prototype.initOnClick=function(t){var n=this;ai.onClick(this,(function(t){n.state.isActionable&&n.onSelect(t)}))},n.prototype.initOnOver=function(t){var n=this;this.on(ai.over,(function(){var t=n.getContext();null!=t&&n.parent instanceof li&&t.trim(n.getCloseable())}))},n.prototype.initShortcuts=function(t){var n=this.Cn;if(this.hs=this.theme.getShortcutTextMargin(),null!=n&&0<n.length){var i=n[0],r=pt.toString(i);this.os=this.createText(r),this.addRenderable(this.os,!0)}else this.os=null},n.prototype.updateShortcutText=function(){var t=this.os;if(null!=t){var n=this.toRounded;t.position.set(n(this.width-this.hs-t.width),n(.5*(this.height-t.height)))}},n.prototype.updateTextColor=function(n){t.prototype.updateTextColor.call(this,n);var i=this.os;if(null!=i){var r=this.theme,e=this.state;i.style.fill=r.getShortcutColor(e),i.alpha=r.getShortcutAlpha(e)}},n.prototype.updateText=function(){t.prototype.updateText.call(this),this.updateShortcutText()},n.prototype.getType=function(){return"DMenuItemText"},n.prototype.onSelect=function(n){t.prototype.onSelect.call(this,n);var i=this.getCloseable();null!=i&&i.emit("select",this.value,this,i)},n.prototype.onShortcut=function(n){t.prototype.onShortcut.call(this,n),this.onSelect(n)},n}(Ko),Zo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),n&&n.check&&(this.state.isActive=!0)},n.prototype.getType=function(){return"DMenuItemCheck"},n.prototype.onSelect=function(n){this.state.isActive=!this.state.isActive,t.prototype.onSelect.call(this,n)},n.isCompatible=function(t){return"check"in t},n}(Jo);!function(t){t[t.OPEN_LINK_IN_NEW_WINDOW=0]="OPEN_LINK_IN_NEW_WINDOW",t[t.COPY_LINK_ADDRESS=1]="COPY_LINK_ADDRESS"}(ku||(ku={})),function(t){t[t.AUTO=0]="AUTO",t[t.THIS_WINDOW=1]="THIS_WINDOW",t[t.NEW_WINDOW=2]="NEW_WINDOW"}(xu||(xu={}));var qo,$o=function(){function n(){}return n.addItemCreator=function(t){this.CREATORS.push(t)},n.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},n.setMenuCreator=function(t){this.MENU_CREATOR=t},n.newItemOf=function(t,n,i,r){for(var e=0,u=t.length;e<u;++e){var s=t[e](i,r);if(null!=s)return s}return n?n(i,r):null},n.newItem=function(t,n){return this.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)},n.newItemsOf=function(n,i,r,e){for(var u=0,s=r.length;u<s;++u){var h=r[u];if(h instanceof t.DisplayObject)i.addChild(h);else if(null!=h){var o=n.newItem(h,e);if(null==o)throw new Error("No matching menu item creator found: "+JSON.stringify(h));i.addChild(o)}}},n.newItems=function(t,n,i){this.newItemsOf(this,t,n,i)},n.newMenu=function(t){if(null!=this.MENU_CREATOR)return this.MENU_CREATOR(t);throw new Error("Missing DMenu creator.")},n.CREATORS=[],n.CREATOR_DEFAULT=null,n}(),Qo=function(t){var n=document.getSelection();if(n){var i=document.createRange();i.selectNodeContents(t),n.removeAllRanges(),n.addRange(i)}return n},ta=function(t){return t.clipboardData||window.clipboardData},na=function(t){function n(){var n=t.call(this)||this,i=document.body;return i.addEventListener("copy",(function(t){t.target===i&&(t.preventDefault(),t.stopPropagation(),n.emit("copy",ta(t)))})),i.addEventListener("cut",(function(t){t.target===i&&(t.preventDefault(),t.stopPropagation(),n.emit("cut",ta(t)))})),i.addEventListener("paste",(function(t){t.target===i&&(t.preventDefault(),t.stopPropagation(),n.emit("paste",ta(t)))})),n}return y(n,t),n.copy=function(t){var n=navigator.clipboard;n&&n.writeText?n.writeText(t):function(t,n){if("undefined"==typeof ClipboardEvent){var i=t.clipboardData;if(void 0!==i&&void 0!==i.setData)return i.setData("Text",n),!0}return!1}(window,t)||function(t){var n=document.createElement("div");n.setAttribute("style","-webkit-user-select: text !important"),n.textContent="Dummy",document.body.appendChild(n);var i=Qo(n),r=!1;if(i){var e=function(i){if(i.target===n){var e=ta(i);e.setData("text/plain",t),r=e.getData("text/plain")===t,i.preventDefault()}};document.addEventListener("copy",e);try{document.execCommand("copy")}finally{document.removeEventListener("copy",e)}i.removeAllRanges()}return document.body.removeChild(n),r}(t)||navigator.userAgent.indexOf("Edge")<0&&function(t){var n=document.createElement("div");n.setAttribute("style","-webkit-user-select: text !important");var i=document.createElement("span");i.innerText=t,(n.attachShadow?n.attachShadow({mode:"open"}):n).appendChild(i),document.body.appendChild(n);var r=Qo(n);r&&(document.execCommand("copy"),r.removeAllRanges()),document.body.removeChild(n)}(t)},n}(t.utils.EventEmitter),ia=function(){function n(t,n){n&&(this.cs=n.url,this.i=n.target,this.Qn=n.checker,this.fs=n.menu),this.yt=t,this.Re=!0}return Object.defineProperty(n.prototype,"enable",{get:function(){return this.Re},set:function(t){this.Re=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"url",{get:function(){var t=this.cs;return mt(t)?t:null==t?null:t()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"target",{get:function(){return this.i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"menu",{get:function(){var t=this,n=this.ls;if(null==n){var i=this.fs||this.yt.getLinkMenuOptions();n=this.toMenu(i),this.ls=n,n.on("select",(function(n,i,r){t.onMenuSelect(n,i,r)}))}return n},enumerable:!1,configurable:!0}),n.prototype.toMenu=function(n){return n instanceof t.DisplayObject?n:this.newMenu(n)},n.prototype.newMenu=function(t){return $o.newMenu(t)},n.prototype.onMenuSelect=function(t,n,i){var r=this;switch(t){case ku.OPEN_LINK_IN_NEW_WINDOW:this.open(!0);break;case ku.COPY_LINK_ADDRESS:var e=this.url;null!=e&&(mt(e)?this.copy(e):e.then((function(t){null!=t&&r.copy(t)})))}},n.prototype.copy=function(t){var n=document.createElement("a");n.href=t,na.copy(n.href)},n.prototype.apply=function(t,n){var i=this,r=function(r){i.enable&&t.state.isActionable&&n(r)};this.i===xu.NEW_WINDOW?ai.onClick(t,r):ai.onLongClick(t,r,(function(n){if(i.enable&&t.state.isActionable){var r=i.menu;r.isHidden()&&r.open(t)}}))},n.prototype.open=function(t){var n=this,i=this.url;null!=i&&(mt(i)?this.check(i,t):i.then((function(i){i&&n.check(i,t)})))},n.prototype.check=function(t,n){var i=this,r=this.Qn;if(r){var e=r();!0===e?this.exec(t,n):!1===e||e.then((function(r){r&&i.exec(t,n)}))}else this.exec(t,n)},n.prototype.exec=function(t,n){if(n){var i=document.createElement("a");i.href=t,i.target="_blank",i.style.display="none",i.rel="noopener noreferrer",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i)}),100)}else window.location.href=t},n.prototype.inNewWindow=function(n){if(this.i===xu.NEW_WINDOW)return!0;if(null!=n){var i=n instanceof t.interaction.InteractionEvent?n.data.originalEvent:n;return i.ctrlKey||i.shiftKey||i.altKey||i.metaKey||"button"in i&&0!==i.button}return!1},n}(),ra={NEW_WINDOW:x.CUSTOM},ea=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.toLinkOptions=function(t){if(t)return{url:this.toUrl(t.url),target:t.target,checker:this.toChecker(t.checker),menu:t.menu}},n.prototype.toUrl=function(t){var n=this;return mt(t)||null==t?t:function(){return t(n)}},n.prototype.toChecker=function(t){var n=this;if(null!=t)return function(){return t(n)}},n.prototype.init=function(n){n&&n.target===xu.NEW_WINDOW&&(n.state=n.state||x.NONE||ra.NEW_WINDOW),this.vs=new ia(this.theme,this.toLinkOptions(n)),t.prototype.init.call(this,n)},Object.defineProperty(n.prototype,"url",{get:function(){return this.vs.url},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"menu",{get:function(){return this.vs.menu},enumerable:!1,configurable:!0}),n.prototype.initOnClick=function(t){var n=this;this.vs.apply(this,(function(t){return n.onSelect(t)}))},n.prototype.getType=function(){return"DMenuItemLink"},n.prototype.onSelect=function(n){t.prototype.onSelect.call(this,n),this.open(this.vs.inNewWindow(n))},n.prototype.open=function(t){this.vs.open(t)},n.prototype.onShortcut=function(n){t.prototype.onShortcut.call(this,n),this.onSelect(n)},n.isCompatible=function(t){return"url"in t},n}(Jo);!function(t){t[t.TOP=0]="TOP",t[t.TOP_LEFT=1]="TOP_LEFT",t[t.TOP_CENTER=2]="TOP_CENTER",t[t.TOP_RIGHT=3]="TOP_RIGHT",t[t.LEFT=4]="LEFT",t[t.LEFT_TOP=5]="LEFT_TOP",t[t.LEFT_MIDDLE=6]="LEFT_MIDDLE",t[t.LEFT_BOTTOM=7]="LEFT_BOTTOM",t[t.RIGHT=8]="RIGHT",t[t.RIGHT_TOP=9]="RIGHT_TOP",t[t.RIGHT_MIDDLE=10]="RIGHT_MIDDLE",t[t.RIGHT_BOTTOM=11]="RIGHT_BOTTOM",t[t.BOTTOM=12]="BOTTOM",t[t.BOTTOM_LEFT=13]="BOTTOM_LEFT",t[t.BOTTOM_CENTER=14]="BOTTOM_CENTER",t[t.BOTTOM_RIGHT=15]="BOTTOM_RIGHT",t[t.OVER=16]="OVER"}(qo||(qo={}));var ua,sa=function(){function t(){}return t.attach=function(t,n,i,r,e,u,s){var h=t.width,o=t.height,a=0;switch(s){case qo.LEFT:case qo.LEFT_TOP:case qo.LEFT_MIDDLE:case qo.LEFT_BOTTOM:(a=n.left-h-i)<i&&e-i<(a=n.right+i)+h&&(a=i);break;case qo.RIGHT:case qo.RIGHT_TOP:case qo.RIGHT_MIDDLE:case qo.RIGHT_BOTTOM:e-i<(a=n.right+i)+h&&(a=n.left-h-i)<i&&(a=e-h-i);break;case qo.TOP:case qo.TOP_LEFT:case qo.BOTTOM:case qo.BOTTOM_LEFT:a=this.adjust(n.left,h,i,e);break;case qo.TOP_RIGHT:case qo.BOTTOM_RIGHT:a=this.adjust(n.right-h,h,i,e);break;case qo.TOP_CENTER:case qo.BOTTOM_CENTER:case qo.OVER:a=this.adjust(.5*(n.left+n.right-h),h,i,e)}var c=0;switch(s){case qo.LEFT:case qo.LEFT_TOP:case qo.RIGHT:case qo.RIGHT_TOP:c=this.adjust(n.top,o,r,u);break;case qo.LEFT_MIDDLE:case qo.RIGHT_MIDDLE:case qo.OVER:c=this.adjust(.5*(n.top+n.bottom-o),o,r,u);break;case qo.LEFT_BOTTOM:case qo.RIGHT_BOTTOM:c=this.adjust(n.bottom,o,r,u);break;case qo.TOP:case qo.TOP_LEFT:case qo.TOP_RIGHT:case qo.TOP_CENTER:(c=n.top-o-r)<r&&u<(c=n.bottom+r)+o&&(c=r);break;case qo.BOTTOM:case qo.BOTTOM_LEFT:case qo.BOTTOM_RIGHT:case qo.BOTTOM_CENTER:u-r<(c=n.bottom+r)+o&&(c=n.top-o-r)<r&&(c=u-o-r)}t.position.set(a,c)},t.adjust=function(t,n,i,r){return t<i?r-i<t+n?.5*(r-n):i:r-i<t+n?r<n?.5*(r-n):r-n-i:t},t}(),ha=qo,oa=function(n){function i(t){return n.call(this,t)||this}return y(i,n),i.prototype.init=function(t){var i=this;n.prototype.init.call(this,t),ai.onClick(this,(function(){i.state.isActionable&&i.open()})),this.initHover(t);var r=this.toMenu(t);this.ls=r,r.on("select",(function(t,n,r){i.onMenuSelect(t,n,r)}))},i.prototype.initHover=function(t){var n=this;this.on(ai.over,(function(){n.state.isActionable&&n.open()}))},i.prototype.toMenu=function(n){var i=n.menu;return i instanceof t.DisplayObject?i:this.newMenu(i)},i.prototype.newMenu=function(t){return $o.newMenu(t)},Object.defineProperty(i.prototype,"menu",{get:function(){return this.ls},enumerable:!1,configurable:!0}),i.prototype.getType=function(){return"DMenuItemMenu"},i.prototype.open=function(){var t=this.ls;t.isHidden()&&this.onOpen(t)},i.prototype.onOpen=function(t){var n=this.getContext();null!=n&&t.open(this,this.getCloseable(),n)},i.prototype.close=function(){this.ls.close()},i.prototype.toggle=function(){var t=this.ls;t.isHidden()?this.onOpen(t):t.close()},i.prototype.onSelect=function(t){this.open(),n.prototype.onSelect.call(this,t)},i.prototype.onMenuSelect=function(t,n,i){var r=this.getCloseable();null!=r&&r.emit("select",t,n,i)},i.prototype.onKeyDown=function(t){return this.state.isActionable&&this.state.isFocused&&pt.isArrowRightKey(t)&&this.onSelect(t),n.prototype.onKeyDown.call(this,t)},i.isCompatible=function(t){return"menu"in t},i.toSubMenuOptions=function(n,i){var r=n.menu;return r instanceof t.DisplayObject||(null==r.sticky&&(r.sticky=i),null==r.align&&(r.align=ha.RIGHT)),n},i}(Ko),aa=function(t){function n(n){var i=t.call(this)||this;return n.addRenderable(i,!0),n.addReflowable(i),i}return y(n,t),n.prototype.onReflow=function(t,n,i){var r=t.state,e=t.border,u=e.getWidth(r),s=e.getColor(r);if(null!=s){var h=e.getAlpha(r),o=e.getAlign(r),a=t.padding,c=.5*i;this.clear(),this.lineStyle(u,s,h,o),this.moveTo(a.getLeft(),c),this.lineTo(n-a.getRight(),c),this.visible=!0}else this.clear(),this.visible=!1},n}(t.Graphics),ca=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.interactive=!1,this.buttonMode=!1,this.state.isFocusable=!1},n.prototype.initReflowable=function(){new aa(this)},n.prototype.getType=function(){return"DListItemSeparator"},n}(Yo),fa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemSeparator"},n.isCompatible=function(t){return"separator"in t},n}(ca),la=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemSpace"},n.isCompatible=function(t){return"space"in t},n}(Dr),va=function(){$o.addItemCreator((function(t){return Zo.isCompatible(t)?new Zo(t):null})),$o.addItemCreator((function(t){return ea.isCompatible(t)?new ea(t):null})),$o.addItemCreator((function(t,n){return oa.isCompatible(t)?new oa(oa.toSubMenuOptions(t,n)):null})),$o.addItemCreator((function(t){return fa.isCompatible(t)?new fa(t):null})),$o.addItemCreator((function(t){return la.isCompatible(t)?new la(t):null})),$o.setItemCreatorDefault((function(t){return new Jo(t)}))},ba=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemExpandableBody"},n}(Tr),ga=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on(ai.down,(function(t){i.state.isActionable&&i.onSelect(t)}))},n.prototype.getSelection=function(){return null},n.prototype.getType=function(){return"DMenuItemExpandableHeader"},n}(Yo),da=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,n){return $o.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)||$o.newItem(t,n)},t.newItems=function(t,n,i){$o.newItemsOf(this,t,n,i)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),ma=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(t){var i=this;n.prototype.init.call(this,t);var r=this.theme,e=this.toHeader(r,t);this.bs=e,e.on("select",(function(){i.toggle()})),this.addChild(e);var u=this.toBody(r,t);this.gs=u;var s=!(!t||null==t.sticky)&&t.sticky;this.newItems(u,s,r,t),this.addChild(u),this.state.isActive?this.onActivated():this.onDeactivated()},i.prototype.newItems=function(t,n,i,r){null!=r&&null!=r.items&&da.newItems(t,r.items,n)},i.prototype.toHeader=function(n,i){return i?i.header instanceof t.DisplayObject?i.header:this.newHeader(n,i.header):this.newHeader(n)},i.prototype.newHeader=function(t,n){return new ga(n)},i.prototype.toBody=function(n,i){return i&&i.body?i.body instanceof t.DisplayObject?i.body:this.newBody(n,i.body):this.newBody(n)},i.prototype.newBody=function(t,n){return new ba(n)},i.prototype.open=function(){this.state.isActive=!0},i.prototype.close=function(){this.state.isActive=!1},i.prototype.toggle=function(){this.state.isActive=!this.state.isActive},i.prototype.onActivated=function(){var t=this.gs;t instanceof li?t.show():t.visible=!0},i.prototype.onDeactivated=function(){var t=this.gs;t instanceof li?t.hide():t.visible=!1},i.prototype.onStateChange=function(t,i){n.prototype.onStateChange.call(this,t,i),t.isActive?i.isActive||this.onActivated():i.isActive&&this.onDeactivated()},i.prototype.onKeyDown=function(t){if(pt.isArrowRightKey(t))this.state.isActionable&&!this.state.isActive&&(i=this.bs)instanceof li&&i.state.isFocused&&(this.state.isActive=!0);else if(pt.isArrowLeftKey(t)){var i;if(this.state.isActionable&&this.state.isActive)return(i=this.bs)instanceof li?i.focus():this.focus(),this.state.isActive=!1,n.prototype.onKeyDown.call(this,t),!0}return n.prototype.onKeyDown.call(this,t)},i.prototype.getType=function(){return"DMenuItemExpandable"},i.isCompatible=function(t){return"header"in t},i}(Tr),wa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemCheck"},n}(Zo),pa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemLink"},n}(ea),Oa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemSeparator"},n}(fa),Da=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemSpace"},n}(la),Ea=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemText"},n}(Jo),Ma=function(){$o.addItemCreator((function(t){return ma.isCompatible(t)?new ma(t):null})),da.addItemCreator((function(t){return Zo.isCompatible(t)?new wa(t):null})),da.addItemCreator((function(t){return ea.isCompatible(t)?new pa(t):null})),da.addItemCreator((function(t){return fa.isCompatible(t)?new Oa(t):null})),da.addItemCreator((function(t){return la.isCompatible(t)?new Da(t):null})),da.setItemCreatorDefault((function(t){return new Ea(t)}))},Sa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemCheck"},n}(Zo),Ta=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getSelection=function(){return null},n.prototype.getType=function(){return"DMenuSidedItemLink"},n}(ea),ja=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.initHover=function(t){},n.prototype.onMenuSelect=function(n,i,r){t.prototype.onMenuSelect.call(this,n,i,r);var e=t.prototype.getSelection.call(this);e&&e.add(i)},n.prototype.onOpen=function(t){t.open(this,this)},n.prototype.getSelection=function(){return null},n.prototype.getType=function(){return"DMenuSidedItemMenu"},n}(oa),Na=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemSeparator"},n}(fa),Ia=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemSpace"},n}(la),Ca=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemText"},n}(Jo),Aa=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,n){return $o.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)||$o.newItem(t,n)},t.newItems=function(t,n,i){$o.newItemsOf(this,t,n,i)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),Ra=function(){Aa.setItemCreatorDefault((function(t){return new Ca(t)})),Aa.addItemCreator((function(t){return la.isCompatible(t)?new Ia(t):null})),Aa.addItemCreator((function(t){return fa.isCompatible(t)?new Na(t):null})),Aa.addItemCreator((function(t,n){return oa.isCompatible(t)?new ja(oa.toSubMenuOptions(t,n)):null})),Aa.addItemCreator((function(t){return ea.isCompatible(t)?new Ta(t):null})),Aa.addItemCreator((function(t){return Zo.isCompatible(t)?new Sa(t):null}))},ya=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,n){return $o.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)||Aa.newItem(t,n)},t.newItems=function(t,n,i){$o.newItemsOf(this,t,n,i)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),ka=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newItems=function(t,n,i,r){null!=r&&null!=r.items&&ya.newItems(t,r.items,n)},n.prototype.getType=function(){return"DMenuSidedItemExpandable"},n}(ma),xa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemCheck"},n}(wa),La=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemLink"},n}(ea),Ba=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemMenu"},n}(oa),_a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onOpen=function(t){t.open(this,this)},n.prototype.getType=function(){return"DMenuSidedItemExpandableItemMenu"},n}(Ba),Pa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemSeparator"},n}(Oa),Fa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemSpace"},n}(Da),Ua=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemText"},n}(Ea),za=function(){Aa.addItemCreator((function(t){return ma.isCompatible(t)?new ka(t):null})),ya.addItemCreator((function(t){return Zo.isCompatible(t)?new xa(t):null})),ya.addItemCreator((function(t){return ea.isCompatible(t)?new La(t):null})),ya.addItemCreator((function(t,n){return oa.isCompatible(t)?new _a(oa.toSubMenuOptions(t,n)):null})),ya.addItemCreator((function(t){return fa.isCompatible(t)?new Pa(t):null})),ya.addItemCreator((function(t){return la.isCompatible(t)?new Fa(t):null})),ya.setItemCreatorDefault((function(t){return new Ua(t)}))},Ga=function(){va(),Ma(),Ra(),za()},Ha=function(){Ga(),Wo()},Va=function(t,n){return n?iu.toImageElement(t).then((function(t){var n=Bi.getInstance().init();n.updateTexture(t),n.render();var i=document.createElement("canvas");return n.read(i),Va(i.toDataURL(),!1)})):iu.toImageElement(t).then((function(t){return new zs(t)}))},Wa=function(t,n){this.texture=t,this.indexOffset=n},Xa=function(){function t(){this.index=0,this.baseTexture=null,this.units=[]}return t.prototype.begin=function(){this.index=0,this.baseTexture=null},t.prototype.push=function(t,n){if(this.index<this.units.length){var i=this.units[this.index];i.texture=t,i.indexOffset=n}else this.units.push(new Wa(t,n));this.index+=1},t.prototype.end=function(){this.units.length!==this.index&&(this.units.length=this.index)},t.prototype.destroy=function(){this.units.length=0},t}(),Ya=function(){function i(t,n){var i=3*t,r=i;this.vertices=new Float32Array(2*r),this.ws=r,this.ps=0,this.Yt=null,this.clippings=new Float32Array(3*r),this.Os=null,this.steps=new Float32Array(6*r),this.Ds=null,this.colorFills=new Float32Array(4*r),this.Es=null,this.colorStrokes=new Float32Array(4*r),this.Ms=null,this.uvs=new Float32Array(2*r),this.Jt=null;var e=r<=65535;this.indices=e?new Uint16Array(i):new Uint32Array(i),this.Ss=t,this.Ts=0,this.indexCountRequested=0,this.Zt=null,this.js=n,this.Ns=new Xa,this.Is=null}return i.prototype.updateVertices=function(){var t=this.Yt;t&&t.update()},i.prototype.updateClippings=function(){var t=this.Os;t&&t.update()},i.prototype.updateSteps=function(){var t=this.Ds;t&&t.update()},i.prototype.updateColorFills=function(){var t=this.Es;t&&t.update()},i.prototype.updateColorStrokes=function(){var t=this.Ms;t&&t.update()},i.prototype.updateUvs=function(){var t=this.Jt;t&&t.update()},i.prototype.updateIndices=function(){var t=this.Zt;t&&t.update()},i.prototype.getGeometry=function(){var n=this.Is;return null==n&&(this.Yt=new t.Buffer(this.vertices,!1,!1),this.Os=new t.Buffer(this.clippings,!1,!1),this.Ds=new t.Buffer(this.steps,!1,!1),this.Es=new t.Buffer(this.colorFills,!1,!1),this.Ms=new t.Buffer(this.colorStrokes,!1,!1),this.Jt=new t.Buffer(this.uvs,!1,!1),this.Zt=new t.Buffer(this.indices,!1,!0),this.Is=n=(new t.Geometry).addIndex(this.Zt).addAttribute("aPosition",this.Yt,2).addAttribute("aClipping",this.Os,3).addAttribute("aStep",this.Ds,2).addAttribute("aAntialias",this.Ds,4).addAttribute("aColorFill",this.Es,4).addAttribute("aColorStroke",this.Ms,4).addAttribute("aUv",this.Jt,2)),n},i.prototype.upload=function(){this.js.geometry.bind(this.getGeometry())},i.prototype.render=function(n){var i=this.js;i.geometry.bind(this.getGeometry());var r=this.Ns.units,e=r.length;if(0<e){for(var u=t.DRAW_MODES.TRIANGLES,s=null,h=r[0],o=0,a=3*h.indexOffset,c=0,f=t.Texture.WHITE,l=0,v=e-1;l<v;++l)s=h,o=a,c=(a=3*(h=r[l+1]).indexOffset)-o,f=s.texture||t.Texture.WHITE,0<c&&f.valid&&(n.uniforms.sampler=i.texture.bind(f),i.geometry.draw(u,c,o));c=3*this.Ts-a,f=h.texture||t.Texture.WHITE,0<c&&f.valid&&(n.uniforms.sampler=i.texture.bind(f),i.geometry.draw(u,c,a))}},i.prototype.isCompatible=function(t,n,i,r){return n.getBuffer()===this&&n.getVertexOffset()===i&&n.getIndexOffset()===r&&n.isCompatible(t)},i.prototype.update=function(t,i,r){var u=this.Ns;u.begin();for(var s=0,h=0,o=t.get();null!=o&&null!=(a=o.uploaded)&&this.isCompatible(o,a,s,h);o=t.next())if(a.update(o),a.buildUnit(u),s+=a.getVertexCount(),h+=a.getIndexCount(),r)return t.next(),u.end(),this.ps=s,this.Ts=h,0<u.units.length;for(;null!=o;o=t.next()){var a,c=e[o.type]||e[n.GROUP];if(null==c)break;if(null==(a=c(this,o,s,h,i)))break;if(a.buildUnit(u),s+=a.getVertexCount(),h+=a.getIndexCount(),r){t.next();break}}return u.end(),this.ps=s,this.Ts=h,0<u.units.length},i.prototype.check=function(t,n,i,r){return this.indexCountRequested=r,t+i<=this.ws&&n+r<=this.Ss},i.prototype.destroy=function(){var t=this.Is;t&&t.destroy(),this.Ns.destroy()},i}(),Ka=function(){function n(n,i,r,e,u){this.id=n,this.ref=0;var s=u.resolution;this.frame=new t.Rectangle(0,0,i*s,r*s),this.texture=new t.Texture(u,new t.Rectangle(0,0,1,1)),this.width=i,this.height=r,this.strokeWidth=e}return n.prototype.applyFrame=function(){var t=1/this.texture.baseTexture.resolution;this.texture.frame.x=this.frame.x*t,this.texture.frame.y=this.frame.y*t,this.texture.frame.width=this.width,this.texture.frame.height=this.height,this.texture.updateUvs(),this.texture.emit("update",this)},n.prototype.destroy=function(){this.texture.destroy()},n}(),Ja=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.render=function(t){},n}(Ka),Za=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.render=function(t){var n=this.frame;t.save(),t.fillStyle="#ffffff",t.fillRect(n.x-1,n.y-1,n.width+2,n.height+2),t.restore()},n}(Ka),qa=function(){function n(n){var i=this.Vi=document.createElement("canvas");i.width=i.height=256;var r=this.Cs=t.BaseTexture.from(i,{mipmap:t.MIPMAP_MODES.OFF,resolution:n});this.As={},this.Rs=[],this.ys={empty:new Ja("empty",10,10,0,r),white:new Za("white",10,10,0,r)},this.Wt=!0}return n.prototype.updateFrames=function(t,n){for(var i=4,r=4,e=0,u=0,s=n.length;u<s;++u){var h=n[u];t<i+h.frame.width+4&&(i=4,r+=e+4,e=0),h.frame.x=0|i,h.frame.y=0|r,i+=h.frame.width+4,e=Math.max(e,h.frame.height)}for(var o=r+e+4,a=256;a<o;)a<<=1;return Math.min(4096,a)},n.prototype.renderFrames=function(t,n,i){var r=this.Vi;r.width=t,r.height=n;var e=r.getContext("2d");if(null!=e)for(var u=0,s=i.length;u<s;++u)i[u].render(e)},n.prototype.applyFrames=function(t){for(var n=0,i=t.length;n<i;++n)t[n].applyFrame()},n.prototype.calcCanvasWidth=function(t){for(var n=128,i=t.length-1;0<=i;--i)for(var r=t[i],e=Math.max(r.frame.width,r.frame.height);n<e;)n<<=1;return Math.min(4096,n<<1)},n.prototype.cleanup=function(t){t.sort(n.ITEM_COMPARATOR);for(var i=t.length-1;0<=i;--i)if(0<t[i].ref)return void(t.length=i+1);t.length=0},n.prototype.begin=function(){for(var t=this.Rs,n=0,i=t.length;n<i;++n)t[n].ref=0;this.Wt=!1},n.prototype.end=function(){for(var t=this.As,n=this.Rs,i=0,r=n.length;i<r;++i){var e=n[i];e.ref<=0&&(e.id in this.ys||e.destroy(),delete t[e.id],this.Wt=!0)}},n.prototype.repack=function(t){if(!0===t||this.Wt){this.Wt=!1;var n=this.Rs;this.cleanup(n);var i=this.calcCanvasWidth(n),r=this.updateFrames(i,n);this.renderFrames(i,r,n),this.Cs.setRealSize(i,r),this.applyFrames(n)}},n.prototype.get=function(t){var n=this.As[t];if(null!=n)return n.ref+=1,n;var i=this.ys[t];return null!=i?(this.set(t,i),i):null},n.prototype.set=function(t,n){var i=this.As[t];return n.ref+=1,this.As[t]=n,this.Rs.push(n),this.Wt=!0,i},n.prototype.toDirty=function(){this.Wt=!0},n.prototype.getDefaultTexture=function(){return this.get("white").texture},n.prototype.getBaseTexture=function(){return this.Cs},n.prototype.release=function(t){var n=this.As,i=n[t];null!=i&&(i.ref-=1,i.ref<=0&&(i.id in this.ys||i.destroy(),delete n[t],this.Wt=!0))},n.ITEM_COMPARATOR=function(t,n){return t.ref<=0?n.ref<=0?0:1:n.ref<=0||t.frame.height<n.frame.height?-1:n.frame.height<t.frame.height?1:t.frame.width-n.frame.width},n}(),$a=function(t){function n(n,i){var r=t.call(this,n.id,n.width/i.resolution,n.height/i.resolution,0,i)||this;return r.canvas=n.canvas,r}return y(n,t),n.prototype.render=function(t){var n=this.canvas;if(null!=n){var i=this.frame;t.drawImage(n,i.x,i.y,i.width,i.height)}},n}(Ka),Qa=function(){function t(){this.ks={}}return t.prototype.begin=function(){var t=this.ks;for(var n in t)t[n].begin()},t.prototype.end=function(){var t=this.ks;for(var n in t){var i=t[n];0<i.length&&i.addAscii(),i.end(),i.length<=0&&(i.destroy(),delete t[n])}},t.prototype.add=function(t,n){var i=this.ks[t];if(null!=i)i.add(n);else{var r=new _i(t);r.add(n),this.ks[t]=r}},t.prototype.get=function(t){var n=this.ks[t];return null!=n?n:null},t.prototype.update=function(t){var n=this.ks,i=t.getBaseTexture();for(var r in n){var e=n[r];if(e.update()){var u=e.id,s=t.get(u);if(null!=s){var h=e.width,o=e.height,a=i.resolution;s.frame.width=h,s.frame.height=o,s.width=h/a,s.height=o/a,t.toDirty()}else t.set(u,new $a(e,i))}}},t.prototype.destroy=function(){var t=this.ks;for(var n in t)t[n].destroy();this.ks={}},t}(),tc=function(t){function n(n,i){var r=t.call(this,n.src,n.width/i.resolution,n.height/i.resolution,0,i)||this;return r.image=n,r}return y(n,t),n.prototype.render=function(t){var n=this.frame,i=n.x,r=n.y,e=n.width,u=n.height,s=this.image;t.drawImage(s,i,r,e,u),t.drawImage(s,0,0,1,u,i-1,r-1,1,u+2),t.drawImage(s,0,0,e,1,i,r-1,e,1),t.drawImage(s,e-1,0,1,u,i+e,r-1,1,u+2),t.drawImage(s,0,u-1,e,1,i,r+u,e,1)},n}(Ka),nc=[],ic=function(){function t(){this.index=0,this.shapes=nc}return t.prototype.reset=function(t){this.index=-1,this.shapes=t},t.prototype.next=function(){var t=this.index=this.index+1,n=this.shapes;return t<n.length?n[t]:null},t}(),rc=function(){function t(){this.xs=-1,this.Ls=new ic,this.Bs=[this.Ls],this._s=null}return t.prototype.reset=function(t){return this.xs=0,(this.Ls=this.Bs[0]).reset(t),this._s=null,this.next()},t.prototype.get=function(){return this._s},t.prototype.next=function(){var t=this.Ls.next();if(null!=t){this._s=t;var n=t.children;if(0<n.length)if((r=this.xs=this.xs+1)<(e=this.Bs).length)(i=e[r]).reset(n),this.Ls=i;else{var i=new ic;e.push(i),i.reset(n),this.Ls=i}return t}var r=this.xs=this.xs-1,e=this.Bs;return 0<=r?(this.Ls=e[r],this._s=null,this.next()):(this._s=null,null)},t}(),ec=function(n){function i(r){var e=n.call(this,r)||this;return i.SHADER=i.SHADER||t.Shader.from("\nattribute vec2 aPosition;\nattribute vec3 aClipping;\nattribute vec2 aStep;\nattribute vec4 aAntialias;\nattribute vec4 aColorFill;\nattribute vec4 aColorStroke;\nattribute vec2 aUv;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mediump float pixelScale;\nuniform mediump float antialiasWeight;\n\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nvec2 toInverse( in vec2 v ) {\n\treturn vec2( -v.y, v.x );\n}\n\nvec2 toTransformedPosition( in vec2 v ) {\n\treturn (projectionMatrix * translationMatrix * vec3(v, 1.0)).xy;\n}\n\nvec4 toAntialias01( in vec4 antialias, in float scale ) {\n\t// Taylor series of 1 / ( 1 - a ) = 1 + a + a^2 + ....\n\treturn 1.0 + min( vec4( 1.0 ), antialias * scale );\n}\n\nvec4 toAntialias2( in vec2 step, in vec4 antialias, in float scale ) {\n\tfloat x = min( 0.4, step.x * scale );\n\tfloat y = 0.5 - antialias.x;\n\tfloat z = 0.5 - antialias.x - step.y;\n\treturn vec4( y, z, y - max( 0.01, y - x ), z - max( 0.01, z - x ) );\n}\n\nvec2 toPosition3456( in float type, in vec2 p, in vec2 pprev, in vec2 pnext, in float strokeWidth, out float shift ) {\n\tvec2 d0 = p - pprev;\n\tvec2 d1 = pnext - p;\n\tfloat l0 = dot( d0, d0 );\n\tfloat l1 = dot( d1, d1 );\n\tvec2 nd0 = normalize( toInverse( d0 ) );\n\tvec2 nd1 = normalize( toInverse( d1 ) );\n\tvec2 n0 = 0.00001 < l0 ? nd0 : nd1;\n\tvec2 n1 = 0.00001 < l1 ? nd1 : nd0;\n\tvec2 n0i = toInverse( n0 );\n\tvec2 n1i = toInverse( n1 );\n\tfloat direction = sign( 4.5 - type );\n\n\t// Offset\n\tfloat cross = dot( n0i, n1 );\n\tfloat crossInverse = ( 0.00001 < abs( cross ) ? 1.0 / cross : 0.0 );\n\tfloat b = dot(n1 - n0, n0) * crossInverse;\n\tfloat offsetSize = direction * strokeWidth * 0.5;\n\tvec2 offset = n1 + n1i * b;\n\n\t// Miter\n\tvec2 pmiter = p + offsetSize * offset;\n\tfloat miterAngle0 = dot( n0i, pmiter - pprev );\n\tfloat miterAngle1 = dot( n1i, pmiter - pnext );\n\tfloat miterLength = dot( offset, offset );\n\tfloat miterSide = direction * cross;\n\n\t// Bevel\n\tvec2 n = ( type == 4.0 || type == 6.0 ? n1 : n0 );\n\tvec2 pbevel = p + offsetSize * n;\n\n\t//\n\tvec2 presult = (\n\t\t0.0 <= miterAngle0 || miterAngle1 < 0.0 || miterSide < 0.0 ?\n\t\tpbevel : pmiter\n\t);\n\t/*\n\tvec2 presult = (\n\t\tmiterAngle0 < 0.0 && 0.0 <= miterAngle1 && miterLength < 50.0 ?\n\t\tpmiter : pbevel\n\t);\n\t*/\n\tvec2 ni = ( type == 4.0 || type == 6.0 ? n1i : n0i );\n\tshift = dot( ni, p - presult );\n\treturn toTransformedPosition( presult );\n}\n\nvec2 toStep3456( in float type ) {\n\treturn ( type < 4.5 ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 ) );\n}\n\nvec4 toAntialias3456( in float strokeWidth, in float scale ) {\n\tfloat a = antialiasWeight / max( 0.0001, strokeWidth );\n\treturn toAntialias01( vec4( a, a, a, a ), scale );\n}\n\nfloat toDotAndDashScale( in float scale, in float strokeWidthScale ) {\n\treturn (\n\t\tscale == 4.0 || scale == 5.0 || scale == 6.0 || scale == 7.0 ?\n\t\tstrokeWidthScale : 1.0\n\t);\n}\n\nvec4 toColorStroke3456( in float shift, in float scale ) {\n\tfloat x = aColorFill.x + shift;\n\tfloat y = scale * aColorFill.y;\n\tfloat z = scale * aColorFill.z;\n\tfloat w = aColorFill.w;\n\treturn vec4( x, y, z, w );\n}\n\nfloat toStrokeWidthScale( in float scale ) {\n\treturn (\n\t\tscale == 3.0 || scale == 7.0 ?\n\t\tpixelScale : (\n\t\t\tscale == 1.0 || scale == 5.0 ?\n\t\t\tmin( 1.0, pixelScale ) : (\n\t\t\t\tscale == 2.0 || scale == 6.0 ?\n\t\t\t\tmax( 1.0, pixelScale ) : 1.0\n\t\t\t)\n\t\t)\n\t);\n}\n\nvoid main(void) {\n\tvec2 p012 = toTransformedPosition( aPosition );\n\n\tfloat type = aClipping.z;\n\n\t// type === 0 or 1\n\tvec4 a01 = toAntialias01( aAntialias, pixelScale );\n\n\t// type === 2\n\tvec4 a2 = toAntialias2( aStep, aAntialias, pixelScale );\n\n\t// type === 3, 4, 5 or 6\n\tfloat shift3456 = 0.0;\n\tfloat strokeWidthScale = toStrokeWidthScale( aStep.y );\n\tfloat strokeWidth = strokeWidthScale * aStep.x;\n\tvec2 p3456 = toPosition3456( type, aPosition, aAntialias.xy, aAntialias.zw, strokeWidth, shift3456 );\n\tvec2 step3456 = toStep3456( type );\n\tvec4 a3456 = toAntialias3456( strokeWidth, pixelScale );\n\tvec4 colorStroke3456 = toColorStroke3456( shift3456, toDotAndDashScale( aStep.y, strokeWidthScale ) );\n\n\t//\n\tgl_Position = vec4( ( 2.5 < type ? p3456 : p012 ), 0.0, 1.0 );\n\tvAntialias = ( 1.5 < type ? ( 2.5 < type ? a3456 : a2 ) : a01 );\n\tvClipping = aClipping;\n\tvStep = ( 2.5 < type ? step3456 : aStep );\n\tvColorFill = ( 2.5 < type ? aColorStroke : aColorFill );\n\tvColorStroke = ( 2.5 < type ? colorStroke3456 : aColorStroke );\n\tvUv = aUv;\n}","\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec2 d01 = ( v0.x < v0.y ? vec2( v0.y, v2.y ) : vec2( v0.x, v2.x ) );\n\tvec2 d02 = ( v1.x < v1.y ? vec2( v1.y, v3.y ) : vec2( v1.x, v3.x ) );\n\tvec4 d0 = vec4( d01.x, d02.x, d01.y, d02.y );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = smoothstep( 1.0 - (d.zw - d.xy), vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat ld = 0.5 * pixelScale;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = smoothstep( 0.0, 0.0 + ld, lm );\n\tfloat ls1 = smoothstep( lp0, lp0 + ld, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - smoothstep( lt - ld, lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}"),e.Ps=i.SHADER,e.Fs=new rc,e.Us=e.getBufferSizeMax(r),e}return y(i,n),i.prototype.getBufferSizeMax=function(t){var n=t.context,i=n.extensions;return 1<n.webGLVersion||i.uint32ElementIndex?1431655765:21845},i.prototype.updateAtlas=function(t,n,i,r,e){var u=t.imageSrc;if(null!=u){var s=n.get(u);if(null!=s)t.texture=s.texture;else{var h=new tc(t.image,e);t.texture=h.texture,n.set(h.id,h)}}else t.texture=r;var o=t.text,a=o.value;0<a.length&&i.add(o.family,a)},i.prototype.updateAtlases=function(t,n,i,r,e){for(var u=0,s=t.length;u<s;++u){var h=t[u];this.updateAtlas(h,n,i,r,e);for(var o=h.children,a=0,c=o.length;a<c;++a){var f=o[a];this.updateAtlas(f,n,i,r,e),this.updateAtlases(f.children,n,i,r,e)}}},i.prototype.updateFontAtlas=function(t,n,i,r){var e=t.text,u=i.get(e.family);if(null!=u){var s=n.get(u.id);null!=s?(e.atlas=u,e.texture=s.texture):(e.atlas=void 0,e.texture=r)}else e.atlas=void 0,e.texture=r},i.prototype.updateFontAtlases=function(t,n,i,r){for(var e=0,u=t.length;e<u;++e){var s=t[e];this.updateFontAtlas(s,n,i,r);for(var h=s.children,o=0,a=h.length;o<a;++o){var c=h[o];this.updateFontAtlas(c,n,i,r),this.updateFontAtlases(c.children,n,i,r)}}},i.prototype.zs=function(n,i,r){var e=this.renderer,u=this.Ps;if(null!=u&&0<i.length){var s=e.resolution,h=n.getBuffers(),o=n.getAntialiasWeight(s);if(r){var a=n.getAtlas(s),c=n.getFontAtlases();a.begin(),c.begin();var f=a.getDefaultTexture(),l=a.getBaseTexture();this.updateAtlases(i,a,c,f,l),c.end(),c.update(a),this.updateFontAtlases(i,a,c,f),a.end(),a.repack(),this.updateBuffers(i,h,e,o)}u.uniforms.pixelScale=n.toPixelScale(s),u.uniforms.antialiasWeight=o,u.uniforms.translationMatrix=n.worldTransform.toArray(!0),e.shader.bind(u,!1),e.state.setBlendMode(t.utils.correctBlendMode(t.BLEND_MODES.NORMAL,!0));var v=h.length;if(1<v)for(var b=0;b<v;++b)h[b].upload();for(b=0;b<v;++b)h[b].render(u)}},i.prototype.updateBuffers=function(t,n,i,r){var e=this.Fs;e.reset(t);for(var u=0,s=0,h=5e3,o=this.Us;null!=e.get();){var a=null,c=!1;if(0<s?(a=new Ya(s,i),n.splice(u,0,a),c=!0):u<n.length?(a=n[u],c=!1):(a=new Ya(h,i),n.push(a),c=!1),a.update(e,r,c))s=0,u+=1;else{if(!((s=a.indexCountRequested)<=o))break;s=Math.ceil(s/h)*h,s=Math.min(s,o)}}if(u<n.length){for(var f=u,l=n.length;f<l;++f)n[f].destroy();n.length=u}},i.SHADER=null,i}(t.ObjectRenderer),uc=function(n){function i(){var i=n.call(this)||this;return i.Gs=null,i.children=[],i.Hs=0,i.Vs=-1,i.Ar=null,i.Ws=new Qa,i.Xs=1,i.Ys=NaN,i.Ks=new t.Point,i.Js=[],i}return y(i,n),i.prototype.calculateBounds=function(){this._bounds.clear()},i.prototype.onChildTransformChange=function(){},i.prototype.toDirty=function(){return this.Hs+=1},i.prototype.isDirty=function(){return this.Vs<this.Hs},i.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var n=this.Hs,i=this.Vs;this.Vs=n;var r=i<n,e=this.children,u=this.Gs;null==u&&(u=this.Gs=new ec(t)),t.batch.setObjectRenderer(u);var s=this.mask;s?(t.mask.push(this,s),u.zs(this,e,r),t.mask.pop(this)):u.zs(this,e,r)}},i.prototype.containsPoint=function(t){return!1},i.prototype.getFontAtlases=function(){return this.Ws},i.prototype.getAtlas=function(t){var n=this.Ar;return null==n&&(n=new qa(t),this.Ar=n),n},i.prototype.getBuffers=function(){return this.Js},i.prototype.toPixelScale=function(t){this.updateTransform();var n=this.transform,i=n._worldID;if(i!==this.Ys){this.Ys=i;var r=n.worldTransform,e=r.a,u=r.b,s=Math.sqrt(e*e+u*u);this.Xs=1/(t*s)}return this.Xs},i.prototype.getPixelScale=function(){return this.Xs},i.prototype.getAntialiasWeight=function(t){return 1.25/t},i.prototype.hitTest=function(t,n){for(var i=this.Ks,r=this.children,e=r.length-1;0<=e;--e){var u=r[e];if(u.visible){var s=u.toLocal(t,void 0,i),h=u.contains(s);if(null!=h&&(null==n||n(h)))return h}}return null},i.prototype.hitTestBBox=function(t,n){for(var i=this.Ks,r=this.children,e=r.length-1;0<=e;--e){var u=r[e];if(u.visible){var s=u.toLocal(t,void 0,i);if(u.containsBBox(s)&&(null==n||n(u)))return u}}return null},i.prototype.destroy=function(){var t=this.Js;if(null!=t)for(var i=0,r=t.length;i<r;++i)t[i].destroy();this.Js.length=0;var e=this.children;for(i=e.length-1;0<=i;--i)e[i].destroy();e.length=0,n.prototype.destroy.call(this)},i}(t.DisplayObject),sc=function(){function t(){}return t.toIndices=function(t){for(var n=[],i=0,r=t.length;i<r;++i)n.push(t[i].index);return n},t.toDepth=function(t){for(var n=0,i=t.parent;i instanceof Y;)n+=1,i=i.parent;return n},t.toSharedParent=function(t,n){if(this.toDepth(t)<this.toDepth(n)){for(var i=t.parent;i instanceof Y;){if(this.isParent(n,i))return i;i=i.parent}return i}for(var r=n.parent;r instanceof Y;){if(this.isParent(t,r))return r;r=r.parent}return r},t.toOfParent=function(t,n){for(var i=t.parent;i!==n&&i instanceof Y;)t=i,i=i.parent;return t},t.isParent=function(t,n){for(var i=t.parent;i instanceof Y;){if(i===n)return!0;i=i.parent}return!1},t.toSelected=function(t){for(var n=t;n instanceof Y;){if(n.selected)return n;n=n.parent}return null},t.findChildById=function(n,i,r){for(var e=n.children,u=0,s=e.length;u<s;++u){var h=e[u];if(h.id===i)return h;if(!0===r){var o=t.findChildById(h,i,r);if(null!=o)return o}}return null},t.findChildByType=function(n,i,r){for(var e=n.children,u=0,s=e.length;u<s;++u){var h=e[u];if(h.type===i)return h;if(!0===r){var o=t.findChildByType(h,i,r);if(null!=o)return o}}return null},t.findChild=function(n,i,r){for(var e=n.children,u=0,s=e.length;u<s;++u){var h=e[u];if(i(h))return h;if(!0===r){var o=t.findChild(h,i,r);if(null!=o)return o}}return null},t.findChildrenByType=function(n,i,r,e){e=e||[];for(var u=n.children,s=0,h=u.length;s<h;++s){var o=u[s];o.type===i&&e.push(o),!0===r&&t.findChildrenByType(o,i,r,e)}return e},t.findChildren=function(n,i,r,e){e=e||[];for(var u=n.children,s=0,h=u.length;s<h;++s){var o=u[s];i(o)&&e.push(o),!0===r&&t.findChildren(o,i,r,e)}return e},t.COMPARATOR_INDEX=function(t,n){return t.index-n.index},t}(),hc=function(){function t(){}return t.delete=function(t,n,i){for(var r=t.children,e=r.length,u=0;u<e;++u)(o=r[u]).selected?o.index=e+u:o.index=u;if(r.sort(sc.COMPARATOR_INDEX),!0===i){for(u=e-1;0<=u;--u){if(!(o=r[u]).selected){var s=r.length-(u+1);if(0<s){var h=r.splice(u+1,s);return null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty(),h}return null!=n&&(n.length=0),null}o.index-=e,o.parent=null,o.selected=!1,o.uploaded=void 0}return 0<r.length?(h=r.splice(0,r.length),null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty(),h):(null!=n&&(n.length=0),null)}for(u=e-1;0<=u;--u){var o;if(!(o=r[u]).selected)return r.length=u+1,null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty(),null;o.parent=null,o.selected=!1,o.uploaded=void 0}return 0<r.length?(r.length=0,null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty()):null!=n&&(n.length=0),null},t}(),oc=function(){function t(){this.resources=[],this.resourceToIndex=new Map,this.tags=[],this.tagToIndex=new Map,this.pieces=[],this.pieceToIndex=new Map,this.uuids=new Set,this.uuidNext=0}return t.prototype.addResource=function(t){return this.Zs(t,this.resources,this.resourceToIndex)},t.prototype.addTag=function(t){return this.Zs(t,this.tags,this.tagToIndex)},t.prototype.addPiece=function(t){return this.Zs(t,this.pieces,this.pieceToIndex)},t.prototype.addUuid=function(t){if(0!==t){var n=this.uuids;return n.has(t)?0:(n.add(t),t)}return 0},t.prototype.updateUuid=function(t){var n=this.uuids;if(0!==t)return t;var i=this.newUuid();return n.add(i),i},t.prototype.newUuid=function(){for(var t=this.uuids,n=this.uuidNext;;)if(0!==(n+=1)&&!t.has(n))return this.uuidNext=n,n},t.prototype.Zs=function(t,n,i){var r=i.get(t);if(null!=r)return r;var e=n.length;return n.push(t),i.set(t,e),e},t}(),ac={},cc=function(t){function n(){var n=t.call(this)||this;return n.Re=!0,n.S=10,n}return y(n,t),Object.defineProperty(n.prototype,"enable",{get:function(){return this.Re},set:function(t){this.Re!==t&&(this.Re=t,this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this.S},set:function(t){this.S!==t&&(this.S=t,this.emit("change",t,this))},enumerable:!1,configurable:!0}),n.prototype.snap=function(t,n){if(this.Re){var i=this.S;n.set(t,Math.round(t/i)*i)}},n.prototype.reset=function(){this.Re=!0,this.S=10,this.emit("change",this)},n.prototype.serialize=function(){return[this.Re?1:0,this.S]},n.prototype.deserialize=function(t){this.enable=0!==t[0],this.size=t[1]},n}(t.utils.EventEmitter),fc=function(){function t(){this.distance=NaN,this.result=0,this.threshold=10}return t.prototype.reset=function(t,n){this.distance=NaN,this.result=t,this.threshold=1e-4<n?10/n:10},t.prototype.set=function(t,n){var i=Math.abs(n-t);if(i<=this.threshold){var r=this.distance;(r!=r||i<r)&&(this.distance=i,this.result=n)}},t}();!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(ua||(ua={}));var lc,vc=function(){function t(t,n){this.type=t,this.position=n}return t.prototype.serialize=function(){return[this.type,this.position]},t}(),bc=function(t){function n(){var n=t.call(this)||this;return n.values=[],n.qs=!0,n.Re=!0,n}return y(n,t),Object.defineProperty(n.prototype,"enable",{get:function(){return this.Re},set:function(t){this.Re!==t&&(this.Re=t,this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"visible",{get:function(){return this.qs},set:function(t){this.qs!==t&&(this.qs=t,this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this.values.length},enumerable:!1,configurable:!0}),n.prototype.add=function(t,n){null!=n?this.values.splice(n,0,t):this.values.push(t),this.emit("change",this)},n.prototype.remove=function(t){var n=this.values;0<=t&&t<n.length&&(n.splice(t,1),this.emit("change",this))},n.prototype.replace=function(t,n){var i=this.values;if(0<=t&&t<i.length){var r=i[t];return i[t]=n,this.emit("change",this),r}return null},n.prototype.swap=function(t,n){if(t!==n){var i=this.values,r=i[t];i[t]=i[n],i[n]=r}},n.prototype.snap=function(t,n,i,r){if(this.Re)for(var e=this.values,u=0,s=e.length;u<s;++u){var h=e[u];h.type===ua.VERTICAL?i.set(t,h.position):r.set(n,h.position)}},n.prototype.reset=function(){this.Re=!0,this.qs=!0,this.values.length=0,this.emit("change",this)},n.prototype.serialize=function(){for(var t=[],n=this.values,i=0,r=n.length;i<r;++i)t.push(n[i].serialize());return[this.Re?1:0,this.qs?1:0,t]},n.prototype.deserialize=function(t){this.Re=0!==t[0],this.qs=0!==t[1];var n=t[2],i=this.values;i.length=0;for(var r=0,e=n.length;r<e;++r){var u=n[r];i.push(new vc(u[0],u[1]))}this.emit("change",this)},n}(t.utils.EventEmitter),gc=1e-5;!function(t){t[t.NONE=0]="NONE",t[t.TOP_LEFT=1]="TOP_LEFT",t[t.TOP_CENTER=2]="TOP_CENTER",t[t.TOP_RIGHT=3]="TOP_RIGHT",t[t.MIDDLE_LEFT=4]="MIDDLE_LEFT",t[t.MIDDLE_RIGHT=5]="MIDDLE_RIGHT",t[t.BOTTOM_LEFT=6]="BOTTOM_LEFT",t[t.BOTTOM_CENTER=7]="BOTTOM_CENTER",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT",t[t.ROTATION=9]="ROTATION"}(lc||(lc={}));var dc=function(n){function i(i){var r=n.call(this)||this;return r.tt=[new t.Point,new t.Point,new t.Point,new t.Point,new t.Point],r.$s=[new t.Point,new t.Point],r.Qs=[1,1],r.th=new t.Point,r.nh=new fc,r.ih=new fc,r.rh={distance:0,scale:new t.Point},r.eh=new t.Point,r.uh=new t.Rectangle,r.sh=new t.Point,r.grid=new cc,r.target=new bc,r.o=i,r.Re=!0,r}return y(i,n),Object.defineProperty(i.prototype,"enable",{get:function(){return this.Re},set:function(t){this.Re!==t&&(this.Re=t,this.emit("change",this))},enumerable:!1,configurable:!0}),i.prototype.prepare=function(t){t.updateTransform();var n=t.transform.localTransform,i=t.width,r=t.height,e=this.tt;e[0].set(0,0),e[1].set(i,0),e[2].set(i,r),e[3].set(0,r),e[4].set(.5*i,.5*r),n.apply(e[0],e[0]),n.apply(e[1],e[1]),n.apply(e[2],e[2]),n.apply(e[3],e[3]),n.apply(e[4],e[4])},i.prototype.prepareForTranslate=function(t){this.Re&&this.prepare(t)},i.prototype.snap=function(t,n){var i=t.x,r=t.y,e=this.o.canvas,u=this.nh,s=this.ih;if(null!=e){var h=Math.max(e.scale.x,e.scale.y);u.reset(i,h),s.reset(r,h),u.set(i,0),u.set(i,e.width),s.set(r,0),s.set(r,e.height)}else u.reset(i,1),s.reset(r,1);return this.target.snap(i,r,u,s),this.grid.snap(i,u),this.grid.snap(r,s),n.x=Oe(u.distance)?NaN:u.result,n.y=Oe(s.distance)?NaN:s.result,n},i.prototype.toSnapped=function(t,n){var i=t.x,r=t.y;if(this.Re){this.snap(t,n);var e=n.x,u=n.y;n.set(Oe(e)?i:e,Oe(u)?r:u)}else n.set(i,r);return n},i.prototype.toTranslationSnapped=function(t,n){var i=t.x,r=t.y,e=NaN,u=NaN;if(this.Re)for(var s=this.eh,h=this.tt,o=0,a=h.length;o<a;++o){var c=h[o];if(s.set(c.x+i,c.y+r),this.snap(s,s),!Oe(s.x)){var f=s.x-c.x;(Oe(e)||Math.abs(f-i)<Math.abs(e-i))&&(e=f)}if(!Oe(s.y)){var l=s.y-c.y;(Oe(u)||Math.abs(l-r)<Math.abs(u-r))&&(u=l)}}return n.x=Oe(e)?i:e,n.y=Oe(u)?r:u,n},i.prototype.prepareForRotate=function(t){},i.prototype.getGridSizeRotation=function(){return 5},i.prototype.toRadian=function(t){return t/180*Math.PI},i.prototype.toDegree=function(t){return t/Math.PI*180},i.prototype.toRotationSnapped=function(t,n){if(this.Re){var i=this.getGridSizeRotation(),r=t+n,e=Math.round(this.toDegree(r)),u=e%90;return Math.abs(u)<=i?this.toRadian(e-u)-t:90-i<=u?this.toRadian(e+(90-u))-t:u<=-90+i?this.toRadian(e-(90+u))-t:n}return n},i.prototype.calcNormalizedVector=function(t,n,i){var r=n.x-t.x,e=n.y-t.y,u=Math.sqrt(r*r+e*e);if(gc<u){var s=1/u;i.x=r*s,i.y=e*s}else i.x=1,i.y=0;return u},i.prototype.prepareForScale=function(t,n){if(this.Re){this.prepare(t);var i=this.tt,r=this.$s,e=this.Qs;switch(n){case lc.TOP_LEFT:e[0]=this.calcNormalizedVector(i[1],i[0],r[0]),e[1]=this.calcNormalizedVector(i[3],i[0],r[1]);break;case lc.TOP_CENTER:e[0]=this.calcNormalizedVector(i[3],i[0],r[0]);break;case lc.TOP_RIGHT:e[0]=this.calcNormalizedVector(i[0],i[1],r[0]),e[1]=this.calcNormalizedVector(i[2],i[1],r[1]);break;case lc.MIDDLE_LEFT:e[0]=this.calcNormalizedVector(i[1],i[0],r[0]);break;case lc.NONE:break;case lc.MIDDLE_RIGHT:e[0]=this.calcNormalizedVector(i[0],i[1],r[0]);break;case lc.BOTTOM_LEFT:e[0]=this.calcNormalizedVector(i[2],i[3],r[0]),e[1]=this.calcNormalizedVector(i[0],i[3],r[1]);break;case lc.BOTTOM_CENTER:e[0]=this.calcNormalizedVector(i[0],i[3],r[0]);break;case lc.BOTTOM_RIGHT:e[0]=this.calcNormalizedVector(i[3],i[2],r[0]),e[1]=this.calcNormalizedVector(i[1],i[2],r[1])}}},i.prototype.setScaleSnappedResult=function(t,n,i,r,e){if(gc<n&&(Oe(e.distance)||t<e.distance)){e.distance=t;var u=1+i/n;r?e.scale.x=u:e.scale.y=u}},i.prototype.calcScaleSnapped1D=function(t,n,i,r,e,u){var s=this.th;t.apply(n,s);var h=s.x,o=s.y;this.snap(s,s);var a=s.x,c=s.y;if(!Oe(a)){var f=Math.abs(i.x);if(gc<f){var l=(a-h)/i.x,v=Math.abs(l),b=(a-n.x)/i.x;this.setScaleSnappedResult(v,r,b,e,u)}}if(!Oe(c)){var g=Math.abs(i.y);if(gc<g){var d=(c-o)/i.y,m=(v=Math.abs(d),(c-n.y)/i.y);this.setScaleSnappedResult(v,r,m,e,u)}}},i.prototype.calcScaleSnappedX=function(t,n,i,r,e){this.calcScaleSnapped1D(t,n,i,r,!0,e)},i.prototype.calcScaleSnappedY=function(t,n,i,r,e){this.calcScaleSnapped1D(t,n,i,r,!1,e)},i.prototype.calcScaleSnapped2D=function(t,n,i,r,e){var u=this.th;t.apply(n,u);var s=u.x,h=u.y;this.snap(u,u);var o=u.x,a=u.y;if(Oe(o)){if(Oe(a))return;o=s}else Oe(a)&&(a=h);var c=i[0].x*i[1].y-i[1].x*i[0].y;if(gc<Math.abs(c)){var f=o-s,l=a-h,v=Math.abs(f*f+l*l);if(Oe(e.distance)||v<e.distance){e.distance=v;var b=o-n.x,g=a-n.y,d=(+i[1].y*b-i[1].x*g)/c,m=(-i[0].y*b+i[0].x*g)/c;e.scale.set(1+d/r[0],1+m/r[1])}}},i.prototype.calcScaleSnappedXY=function(t,n,i,r,e,u,s){this.calcScaleSnapped2D(t,n,e,u,s),this.calcScaleSnappedX(t,r,e[0],u[0],s),this.calcScaleSnappedY(t,i,e[1],u[1],s)},i.prototype.toScaleSnapped=function(t,n,i,r){if(this.Re){var e=this.tt,u=this.$s,s=this.Qs,h=this.rh;switch(h.distance=NaN,h.scale.set(r.x,r.y),n){case lc.TOP_LEFT:this.calcScaleSnappedXY(t,e[0],e[1],e[3],u,s,h);break;case lc.TOP_CENTER:this.calcScaleSnappedY(t,e[0],u[0],s[0],h),this.calcScaleSnappedY(t,e[1],u[0],s[0],h);break;case lc.TOP_RIGHT:this.calcScaleSnappedXY(t,e[1],e[0],e[2],u,s,h);break;case lc.MIDDLE_LEFT:this.calcScaleSnappedX(t,e[0],u[0],s[0],h),this.calcScaleSnappedX(t,e[3],u[0],s[0],h);break;case lc.NONE:break;case lc.MIDDLE_RIGHT:this.calcScaleSnappedX(t,e[1],u[0],s[0],h),this.calcScaleSnappedX(t,e[2],u[0],s[0],h);break;case lc.BOTTOM_LEFT:this.calcScaleSnappedXY(t,e[3],e[2],e[0],u,s,h);break;case lc.BOTTOM_CENTER:this.calcScaleSnappedY(t,e[2],u[0],s[0],h),this.calcScaleSnappedY(t,e[3],u[0],s[0],h);break;case lc.BOTTOM_RIGHT:this.calcScaleSnappedXY(t,e[2],e[3],e[1],u,s,h)}if(!Oe(h.distance)){if(r.copyFrom(h.scale),i)switch(n){case lc.TOP_LEFT:case lc.TOP_RIGHT:case lc.BOTTOM_LEFT:case lc.BOTTOM_RIGHT:r.x=r.y=Math.max(r.x,r.y);break;case lc.TOP_CENTER:case lc.BOTTOM_CENTER:r.x=r.y;break;case lc.MIDDLE_LEFT:case lc.MIDDLE_RIGHT:r.y=r.x;break;case lc.NONE:}return!0}}return!1},i.prototype.reset=function(){this.enable=!0,this.target.reset(),this.grid.reset()},i.prototype.serialize=function(){return[this.Re?1:0,this.target.serialize(),this.grid.serialize()]},i.prototype.deserialize=function(t){this.enable=0!==t[0],this.target.deserialize(t[1]),this.grid.deserialize(t[2])},i}(t.utils.EventEmitter),mc=function(t){function n(n,i,r){var e=t.call(this,n,i.width,i.height,0,r)||this;return e.yr=i,e}return y(n,t),n.prototype.render=function(t){var n=this.frame;t.drawImage(this.yr.canvas,n.x,n.y,n.width,n.height)},n}(Ka),wc=function(n,i,r,e){this.id=n,this.size=i,this.color=t.utils.hex2string(r),this.height=i+2*e;var u=t.TextMetrics.measureFont(n);this.ascent=u.ascent,this.descent=u.descent},pc=function(){function n(n,i,r,e){this.l=n,this.Vi=document.createElement("canvas"),this.hh=null,this.hr=new wc(n,i,r,3),this.ar={},this.cr=0,this.oh=0,this.ot=1,this.zt=1,this.ah=0,this.fh=0,this.Gt=t.Texture.from(this.Vi,{mipmap:t.MIPMAP_MODES.OFF,resolution:e,scaleMode:t.SCALE_MODES.NEAREST}),this.add(ki,!0),this.Zs("...",this.ar,!0)}return Object.defineProperty(n.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"font",{get:function(){return this.hr},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.ot},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.zt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"canvas",{get:function(){return this.Vi},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"characters",{get:function(){return this.ar},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this.Gt},enumerable:!1,configurable:!0}),n.prototype.Zs=function(t,n,i){if("\n"!==t){var r=n[t];if(null!=r)r.reserved||(0===r.ref&&(this.oh-=1),r.ref+=1);else{var e=this.getAdvance(t),u=Math.ceil(3+e+3),s=this.font.height;n[t]=new Li(e,u,s,!!i),this.cr+=1,this.ah+=1}}},n.prototype.lh=function(t,n){if("\n"!==t){var i=n[t];null!=i&&!i.reserved&&0<i.ref&&(i.ref-=1,0===i.ref&&(this.oh+=1))}},n.prototype.bh=function(){if(this.cr>>1<=this.oh){var t=this.ar;for(var n in t)t[n].ref<=0&&delete t[n];this.cr-=this.oh,this.ah+=1,this.oh=0}},n.prototype.add=function(t,n){for(var i=this.ar,r=v.from(t);r.hasNext();)this.Zs(r.next(),i,n)},n.prototype.remove=function(t){for(var n=this.ar,i=v.from(t);i.hasNext();)this.lh(i.next(),n)},n.prototype.get=function(t){return this.ar[t]},n.prototype.getAdvance=function(t){var n=this.getContext();return null!=n?n.measureText(t).width:0},n.prototype.getContext=function(){var t=this.hh;if(null==t){var n=this.Vi;if(null==n)return null;if(null==(t=this.hh=n.getContext("2d",{alpha:!0})))return null}var i=this.hr;return t.font!==i.id&&(t.font=i.id,i.id=t.font,t.textAlign="left",t.textBaseline="alphabetic",t.lineWidth=0,t.lineCap="round",t.lineJoin="miter",t.miterLimit=0,t.fillStyle=i.color,t.strokeStyle="#0000ff"),t},n.prototype.update=function(){if(this.bh(),this.fh<this.ah){this.fh=this.ah;var t=this.Vi;if(null!=t){var n=this.hr,i=n.height,r=this.ar,e=this.ot=this.toPowerOf2(Math.ceil(Math.sqrt(this.cr))*i),u=Math.round(.5*(i-(n.ascent+n.descent))+n.ascent),s=0,h=0;for(var o in r)e<=s+(g=r[o]).width&&(s=0,h+=i),g.x=s,g.y=h,g.origin.x=s+3,g.origin.y=h+u,s+=g.width;var a=this.zt=h+i,c=this.Gt.baseTexture,f=c.resolution,l=Math.ceil(e*f),v=Math.ceil(a*f);t.width=l,t.height=v;var b=this.getContext();if(null!=b){for(var o in b.save(),b.scale(f,f),b.clearRect(0,0,e,a),r){var g=r[o];b.fillText(o,g.origin.x,g.origin.y)}b.restore()}return c.setRealSize(l,v),!0}}return!1},n.prototype.getRevision=function(){return this.ah},n.prototype.getRevisionUpdate=function(){return this.fh},Object.defineProperty(n.prototype,"length",{get:function(){return this.cr},enumerable:!1,configurable:!0}),n.prototype.destroy=function(){null!=this.Vi&&(this.Vi=null);var t=this.ar;for(var n in t)delete t[n]},n.prototype.toPowerOf2=function(t){for(var n=32;n<t;)n<<=1;return n},n}(),Oc=function(t){t.update()},Dc=function(t){t.forEach(Oc)},Ec=function(t){t.update()},Mc=function(t){t.forEach(Ec)},Sc=function(){function t(t){var n=this;this.ks=new Map,this.gh=t.renderer.resolution,t.renderer.on("prerender",(function(){n.update()}))}return t.prototype.add=function(t,n,i,r){var e=this.ks,u=e.get(t);null==u&&(u=new Map,e.set(t,u));var s=u.get(i);null==s&&(s=new pc(t,n,i,this.gh),u.set(i,s)),s.add(r)},t.prototype.remove=function(t,n,i){var r=this.ks.get(t);if(null!=r){var e=r.get(n);null!=e&&e.remove(i)}},t.prototype.get=function(t,n){var i=this.ks.get(t);if(null==i)return null;var r=i.get(n);return null==r?null:r},t.prototype.update=function(){this.ks.forEach(Dc)},t.prototype.destroy=function(){var t=this.ks;t.forEach(Mc),t.clear()},t}(),Tc=function(){function t(t,n,i){var r=this;this.instance=null,this.newInstance=t,this.options=n,null!=i&&(i.state.isActive&&setTimeout((function(){r.get()}),0),i.on("active",(function(){r.get()})))}return t.prototype.get=function(){var t=this.instance;return null==t&&(t=this.instance=new this.newInstance(this.options)),t},t}(),jc=function(t,n,i,r){for(var e=0,u=Math.floor(t.length/i)-1;e<=u;){var s=e+(u-e>>1),h=t[s*i+r];if(n<h)u=s-1;else{if(!(h<n))return s;e=s+1}}return Math.max(e,u)},Nc=function(t){return null!=t?String(t):""},Ic=function(t){return"data:image/svg+xml;base64,"+btoa(t)},Cc=function(n){function i(i,r){var e=n.call(this,new Image)||this;return e.dh=null,e.ot=0,e.zt=0,e.svg=i,t.resources.BaseImageResource.crossOrigin(e.source,e.svg,r&&r.crossorigin),r&&!1===r.autoLoad||e.load(),e}return y(i,n),i.prototype.load=function(){var t=this;return this.dh||(this.dh=new Promise((function(n){var i=t.source;i.onerror=function(n){i.onerror=null,t.onError.run(n)};var r=navigator.userAgent;0<=r.indexOf("Trident/")||0<=r.indexOf("Edge/")?i.onload=function(){setTimeout((function(){t.resize(i.width,i.height),n()}),0)}:i.onload=function(){t.resize(i.width,i.height),n()},i.src=t.svg}))),this.dh},i.test=function(t,n){return"svg"===n||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},i}(t.resources.BaseImageResource);t.resources.INSTALLED.push(Cc);var Ac,Rc=function(){function n(t,n,i){this.ot=t,this.mh=n,this.Pr=i,this.wh={},this.ph="",this.Oh=0,this.Dh=0,this.zt=0}return Object.defineProperty(n.prototype,"width",{get:function(){return this.ot},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ratio",{get:function(){return this.mh},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"margin",{get:function(){return this.Pr},enumerable:!1,configurable:!0}),n.prototype.add=function(n,i,r,e){var u=this.wh;if(!(n in u)){var s=this.Pr,h=this.Oh,o=this.Dh;this.ot<=h+i?(h=0,o=this.Dh+this.zt+s,this.zt=r,this.Dh=o):this.zt=Math.max(this.zt,r),this.Oh=h+i+s,u[n]=new t.Rectangle(h,o,i,r);var a=this.mh;return this.ph+='<g transform="translate('+h*a+","+o*a+')">'+e+"</g>",!0}return!1},Object.defineProperty(n.prototype,"mappings",{get:function(){return this.build()},enumerable:!1,configurable:!0}),n.prototype.build=function(n){var i,r,e,u=this.Eh;if(null==u||(null==n?void 0:n.force)){var s=null!==(i=null==n?void 0:n.resolution)&&void 0!==i?i:null!==(r=window.devicePixelRatio)&&void 0!==r?r:1,h=this.ot,o=Math.pow(2,Math.ceil(Math.log(this.Dh+this.zt)/Math.LN2)),a=h*s,c=o*s,f=this.mh,l=Ic('<svg width="'+a+'" height="'+c+'" viewBox="0 0 '+h*f+" "+o*f+'" xmlns="http://www.w3.org/2000/svg">'+this.ph+"</svg>"),v=null!==(e=null==n?void 0:n.scaling)&&void 0!==e?e:t.SCALE_MODES.NEAREST,b=t.BaseTexture.from(l,{resolution:s,scaleMode:v}),g=this.wh;for(var d in u=this.Eh={},g)u[d]=new t.Texture(b,g[d])}return u},n}(),yc=function(){function n(){}return n.toTexture=function(n,i,r,e){var u=n.transform.scale,s=t.RenderTexture.create({width:n.width*u.x,height:n.height*u.y,scaleMode:t.SCALE_MODES.LINEAR,resolution:i}),h=new t.Matrix(void 0,void 0,void 0,void 0,-n.position.x,-n.position.y),o=B.getLayer(n);return o&&o.renderer.render(n,s,r,h,e),s},n.toPixels=function(t,n){var i=t.resolution,r=t.frame,e=Math.floor(r.width*i),u=Math.floor(r.height*i),s=new Uint8Array(4*e*u);n.renderTexture.bind(t);var h=n.gl;return h.readPixels(r.x*i,r.y*i,e,u,h.RGBA,h.UNSIGNED_BYTE,s),{width:e,height:u,array:s}},n.toCanvas=function(n,i,r){var e=n.width,u=n.height,s=n.array,h=new t.utils.CanvasRenderTarget(e,u,1),o=h.context.getImageData(0,0,e,u);if(r?o.data.set(s):t.Extract.arrayPostDivide(s,o.data),h.context.putImageData(o,0,0),null!=i&&1!==i){h.context.scale(i,i),h.context.drawImage(h.canvas,0,0);var a=Math.floor(e*i),c=Math.floor(u*i),f=h.context.getImageData(0,0,a,c);h.resize(a,c),h.context.putImageData(f,0,0)}return h},n.toBase64=function(t,n,i){return t.toDataURL(n,i)},n}(),kc=function(){function t(){}return t.downloadUrl=function(t,n){var i=document.createElement("a");"download"in i?(i.href=n,i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i)}),66)):window.open(n)||(location.href=n)},t.download=function(t,n,i){var r=new Blob(!1!==i?["\ufeff",n]:[n],{type:"text/plain"});window.navigator.msSaveBlob?window.navigator.msSaveBlob(r,t):this.downloadUrl(t,URL.createObjectURL(r))},t}(),xc=function(){function t(){}return t.texture=function(t){var n=t.target,i=function(t){var n=t.target;if(null!=t.resolution){if(F(t.resolution))return t.resolution;var i=n.transform.scale,r=Math.max(n.width*i.x,n.height*i.y);return Math.min(1,t.resolution.size/r)}return window.devicePixelRatio||1}(t),r=function(t){return t.transform&&t.transform.update}(t);return yc.toTexture(n,i,t.clear,r)},t.pixels=function(t){var n=function(t){if(t.renderer)return t.renderer;if(t.application)return t.application.getLayerBase().renderer;if(t.layer)return t.layer.renderer;var n=B.getLayer(t.target);if(n)return n.renderer;throw new Error("No renderer / application / layer found.")}(t),i=this.texture(t);try{return yc.toPixels(i,n)}finally{i&&i.destroy()}},t.canvas=function(t){var n=this.pixels(t),i=function(t){return t.alpha&&t.alpha.premultiplied&&t.alpha.premultiplied.ignore}(t),r=function(t,n){if(null!=n.scale){if(F(n.scale))return n.scale;var i=n.scale.size;return Math.min(1,i/t.width,i/t.height)}}(n,t);return yc.toCanvas(n,r,i)},t.base64=function(t){var n=this.canvas(t);try{return yc.toBase64(n.canvas,t.format,t.quality)}finally{n&&n.destroy()}},t.file=function(t){kc.downloadUrl(t.filename,this.base64(t))},t}();!function(t){t[t.TEXT=0]="TEXT",t[t.DATA_URL=1]="DATA_URL",t[t.BINARY_STRING=2]="BINARY_STRING",t[t.ARRAY_BUTTER=3]="ARRAY_BUTTER",t[t.FILE=4]="FILE"}(Ac||(Ac={}));var Lc,Bc=function(){function t(t,n){this.Ne=null,this.Mh=t,this.Sh=n}return t.prototype.open=function(){var t=this.getOrCreateInput();null!=t?t.click():this.onCancel()},t.prototype.getOrCreateInput=function(){var t=this;if("FileReader"in window&&null==this.Ne){var n=this.Ne=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("style","display:none"),n.addEventListener("change",(function(i){t.onInputChange(n),n.value="",i.stopImmediatePropagation(),i.preventDefault()})),document.body.appendChild(n)}return this.Ne},t.prototype.onInputChange=function(t){var n=this,i=t.files;if(null!=i&&0<i.length){var r=i[0];if(this.Mh===Ac.FILE)this.onOpen(r,r);else{var e=new FileReader;switch(e.onload=function(t){if(null!=t.target){var i=t.target;n.onOpen(i.result,r)}},e.onabort=function(t){n.onAboart(t)},this.Mh){case Ac.TEXT:e.readAsText(r);break;case Ac.DATA_URL:e.readAsDataURL(r);break;case Ac.BINARY_STRING:e.readAsBinaryString(r);break;case Ac.ARRAY_BUTTER:e.readAsArrayBuffer(r);break;default:e.readAsText(r)}}}else this.onCancel()},t.prototype.onOpen=function(t,n){var i=this.Sh;i.emit("open",t,n,i)},t.prototype.onAboart=function(t){var n=this.Sh;n.emit("abort",t,n)},t.prototype.onCancel=function(){var t=this.Sh;t.emit("cancel",t)},t}(),_c=function(){function t(){}return t.fromRgb=function(t){var n=(16711680&t)>>16,i=(65280&t)>>8,r=255&t|0,e=Math.max(n,i,r),u=e-Math.min(n,i,r),s=0;return 0<u&&(n===e?s=60*(i-r)/u:i===e?s=60*(r-n)/u+120:r===e&&(s=60*(n-i)/u+240),s<0&&(s+=360)),[s,u/e*255,e]},t.toRgb=function(t,n,i){var r=i-n/255*i,e=i-r,u=0,s=0,h=0;return t<=60?(u=i,s=t/60*e+r,h=r):t<=120?(u=(120-t)/60*e+r,s=i,h=r):t<=180?(u=r,s=i,h=(t-120)/60*e+r):t<=240?(u=r,s=(240-t)/60*e+r,h=i):t<=300?(u=(t-240)/60*e+r,s=r,h=i):(u=i,s=r,h=(360-t)/60*e+r),(u=Math.max(0,Math.min(255,u)))<<16|(s=Math.max(0,Math.min(255,s)))<<8|Math.max(0,Math.min(255,h))},t}(),Pc=function(){function t(){}return t.create=function(t){var n=this.Th;return t in n?t+" "+ ++n[t]:(n[t]=1,t+" 1")},t.Th={},t}(),Fc=function(){function t(){}return t.IDENTITY=function(){},t}(),Uc=function(){function t(){}return t.toCode=function(t,n){return"rgba("+(t>>16&255)+","+(t>>8&255)+","+(255&t)+","+n+")"},t}(),zc=function(){function t(t,n,i){var r=this;this.cn=!0,this.jh=new Set,this.Z=t,this.Nh=n,this.Ih=i,this.Ch=null;var e=function(){r.advance(),r.update(),r.Ch=window.setTimeout(e,i)};this.Ah=e}return t.prototype.start=function(){return null==this.Ch&&(this.Ch=window.setTimeout(this.Ah,this.Nh)),this},t.prototype.stop=function(){var t=this.Ch;return null!=t&&(this.Ch=null,clearTimeout(t)),this},t.prototype.add=function(t){return this.jh.add(t),t.state.set(this.Z,this.isOn()),this},t.prototype.remove=function(t){return!!this.jh.delete(t)&&(t.state.remove(this.Z),!0)},t.prototype.contains=function(t){return this.jh.has(t)},t.prototype.clear=function(){return this.jh.clear(),this},t.prototype.isOn=function(){return this.cn},t.prototype.isOff=function(){return!this.cn},t.prototype.advance=function(){return this.cn=!this.cn,this},t.prototype.update=function(){var t=this.isOn(),n=this.Z;return this.jh.forEach((function(i){i.state.set(n,t)})),this},t}(),Gc=function(){function n(){this.Rh=new Map,this.yh='fill="#fff" stroke="none"',this.kh=new Map,this.xh=function(t){return'fill="none" stroke="#fff" stroke-width="'+t+'"'},this.Lh=function(){B.update()}}return n.prototype.toCornerTl=function(t,n,i){return 0<i?"A"+i+" "+i+" 0 0 1 "+(t+i)+" "+t:""},n.prototype.toCornerBr=function(t,n,i){return 0<i?"A"+i+" "+i+" 0 0 1 "+(t+n-i)+" "+(t+n):""},n.prototype.make=function(t,n,i){var r=Math.max(0,t-n),e=2*r+4,u=e+2*n,s="M"+(n+r)+" "+n+"L"+(n+e)+" "+n+"L"+(n+e)+" "+(n+e-r)+this.toCornerBr(n,e,r)+"L"+n+" "+(n+e)+"L"+n+" "+(n+r)+this.toCornerTl(n,e,r)+"Z";return this.toSvg(u,i,s)},n.prototype.toSvg=function(n,i,r){var e=window.devicePixelRatio||1,u='<svg width="'+n*e+'" height="'+n*e+'" viewBox="0 0 '+n+" "+n+'" xmlns="http://www.w3.org/2000/svg"><path '+i+' d="'+r+'"></path></svg>';return t.Texture.from(Ic(u),{resolution:e})},n.prototype.newBackground=function(t){var n=this.make(t,0,this.yh);return n.on("update",this.Lh),n},n.prototype.newBorder=function(t,n){var i=this.make(t,.5*n,this.xh(n));return i.on("update",this.Lh),i},n.prototype.getBackground=function(t){var n=this.Rh,i=n.get(t);return null==i&&(i=this.newBackground(t),n.set(t,i)),i},n.prototype.getBorder=function(t,n){var i=this.kh,r=i.get(t);null==r&&(r=new Map,i.set(t,r));var e=r.get(n);return null==e&&(e=this.newBorder(t,n),r.set(n,e)),e},n.getInstance=function(){return null==n.INSTANCE&&(n.INSTANCE=new n),n.INSTANCE},n.INSTANCE=null,n}(),Hc=function(){function n(){}return n.fromImage=function(n,i,r){var e=t.Texture.from(n,{resolution:i});e.baseTexture.valid?r(e):e.once("update",r)},n}(),Vc=function(){function t(t){this.yn=null!=t&&null!=t.duration?t.duration:300,this._s=null,this.Bh=0,this._h=null}return t.prototype.show=function(t,n){var i=this,r=this._h;null!=r&&clearTimeout(r);var e=this._s;if(t!==e){var u=this.yn,s=this.Bh,h=Date.now(),o=s+u-h;!0===n||o<=0?this.update(h,t):this._h=window.setTimeout((function(){i.update(Date.now(),t)}),o)}},t.prototype.update=function(t,n){var i=this._s;i!==n&&(this.Bh=t,null!==i&&i.hide(),this._s=n,null!=n&&n.show())},t.prototype.hide=function(){this.show(null)},t}(),Wc=function(){function t(){this.Ph=null,this.Fh=0,this.Uh=null,this.zh=null,this.Gh="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DOMMouseScroll","MozMousePixelScroll"]}return t.prototype.on=function(t,n,i){void 0===i&&(i=!1);for(var r=this.Gh,e=r.length-1;0<=e;--e){var u=r[e];t.addEventListener(u,n,i)}},t.prototype.off=function(t,n,i){void 0===i&&(i=!1);for(var r=this.Gh,e=r.length-1;0<=e;--e){var u=r[e];t.removeEventListener(u,n,i)}},t.prototype.getLineHeight=function(){if(null==this.Uh){var t=Z.getInstance().get("DBase");this.Uh=t.getLineHeight()}return this.Uh},t.prototype.getPageHeight=function(){return null==this.zh&&(this.zh=12*this.getLineHeight()),this.zh},t.prototype.normalize=function(t){var n=0,i=0;if("detail"in t&&(i=-1*t.detail),"wheelDelta"in t&&(i=t.wheelDelta),"wheelDeltaY"in t&&(i=t.wheelDeltaY),"wheelDeltaX"in t&&(n=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(n=-1*i,i=0),"deltaY"in t&&(i=-1*t.deltaY),"deltaX"in t&&(n=t.deltaX),0===i&&0===n)return null;var r=Math.max(Math.abs(i),Math.abs(n)),e=Date.now();this.Fh+200<=e&&(this.Ph=null),this.Fh=e;var u="mousewheel"===t.type&&r%120==0;(!this.Ph||r<this.Ph)&&(this.Ph=r,u&&(this.Ph/=40)),u&&(r/=40,n/=40,i/=40);var s=this.Ph;r=Math.floor(r/s),n=Math[1<=n?"floor":"ceil"](n/s),i=Math[1<=i?"floor":"ceil"](i/s);var h=t.deltaMode||0;if(0!==h){var o=1===h?this.getLineHeight():this.getPageHeight();r*=o,n*=o,i*=o}return{mode:h,delta:r,deltaX:n,deltaY:i,lowest:s}},t.getInstance=function(){return null==this.INSTANCE&&(this.INSTANCE=new t),this.INSTANCE},t}(),Xc=function(t){function n(n){var i=t.call(this)||this;return i.i=n&&null!=n.target?n.target:null,i.xn=!1,i.Qe=!1,i.Ln=n&&n.onTime,i._n=n&&n.onStart,i.Pn=n&&n.onEnd,i}return y(n,t),Object.defineProperty(n.prototype,"target",{get:function(){return this.i},set:function(t){this.i=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),n.prototype.start=function(t){void 0===t&&(t=!1),this.stop(),this.Qe=!0,this.xn=t,this.onStart(t),this.Qe&&(this.onTime(t?1:0,t,0),this.Qe&&(this.onTime(t?0:1,t,0),this.Qe||this.onEnd(t)))},n.prototype.onStart=function(t){var n=this._n;null!=n&&n(t,this),this.emit("start",t,this)},n.prototype.onTime=function(t,n,i){var r=this.Ln;null!=r&&r(t,n,i,this),this.emit("time",t,n,i,this)},n.prototype.onEnd=function(t){var n=this.Pn;null!=n&&n(t,this),this.emit("end",t,this)},n.prototype.isStarted=function(){return this.Qe},n.prototype.isReverse=function(){return this.xn},n.prototype.stop=function(){this.Qe=!1},n.prototype.end=function(){if(this.Qe){this.Qe=!1;var t=this.xn,n=t?0:1;this.onTime(n,t,0),this.onEnd(t)}},n}(t.utils.EventEmitter),Yc=function(){function t(t,n,i,r){this.left=r,this.top=t,this.right=n,this.bottom=i}return t.prototype.getTheme=function(){throw new Error("Not supported")},t.prototype.setTheme=function(t){throw new Error("Not supported")},t.prototype.getTop=function(){return this.left},t.prototype.getRight=function(){return this.right},t.prototype.getBottom=function(){return this.bottom},t.prototype.getLeft=function(){return this.left},t.prototype.set=function(t,n,i,r){null==n?(this.top=t,this.right=t,this.bottom=t,this.left=t):null==i?(this.top=t,this.right=n,this.bottom=t,this.left=n):null==r?(this.top=t,this.right=n,this.bottom=i,this.left=n):(this.top=t,this.right=n,this.bottom=i,this.left=r)},t}(),Kc=function(){function t(t){var n=this.Hh=t.root;this.me=t.overlay;var i=t&&t.padding;F(i)?this.Mn=new Yc(i,i,i,i):this.Mn=null!=i?new Yc(i.top||0,i.right||0,i.bottom||0,i.left||0):new Yc(6,6,6,6);var r=100,e=100;if(t)if(null!=t.width)r=t.width,e=null!=t.height?t.height:n.getBoundingClientRect().height;else if(null!=t.height)r=n.getBoundingClientRect().width,e=t.height;else{var u;r=(u=n.getBoundingClientRect()).width,e=u.height}else r=(u=n.getBoundingClientRect()).width,e=u.height;var s=t&&t.background,h=0,o=!0;if(null!=s){var a=s.color;null!=a&&(h=a,o=!1)}var c=t.resolution,f=!(!t||null==t.antialias)&&t.antialias;this.Vh={width:r,height:e,autoStart:!1,backgroundColor:h,transparent:o,resolution:c,antialias:f}}return t.prototype.getRootElement=function(){return this.Hh},t.prototype.setRootElement=function(t,n){if(this.Hh!==t&&(this.Hh=t,!1!==n)){var i=t.getBoundingClientRect(),r=this.Vh;r.width=i.width,r.height=i.height}return this},t.prototype.getWidth=function(){return this.Vh.width},t.prototype.setWidth=function(t){return this.Vh.width=t,this},t.prototype.getHeight=function(){return this.Vh.height},t.prototype.setHeight=function(t){return this.Vh.height=t,this},t.prototype.getPadding=function(){return this.Mn},t.prototype.setPadding=function(t,n,i,r){var e=this.Mn;return e.left=t,e.top=n,e.right=i,e.bottom=r,this},t.prototype.getBackgroundColor=function(){return this.Vh.backgroundColor},t.prototype.setBackgroundColor=function(t){return this.Vh.backgroundColor=t,this},t.prototype.getAntialias=function(){return this.Vh.antialias},t.prototype.setAntialias=function(t){return this.Vh.antialias=t,this},t.prototype.isOverlay=function(){return this.me},t.prototype.getPixiApplicationOptions=function(){return this.Vh},t}(),Jc=function(){function t(){this.Wh=null}return t.prototype.focus=function(t){var n=this.Wh;return n!==t?(null!=n&&(n.state.isFocused=!1),this.Wh=t,this.isFocusable(t)&&(t.state.isFocused=!0),n):null},t.prototype.blur=function(t){return null!=t&&this.Wh===t?(this.Wh=null,t.state.isFocused=!1,t):null},t.prototype.clear=function(){return this.focus(null)},t.prototype.set=function(t,n){return n?this.focus(t):this.blur(t)},t.prototype.get=function(){return this.Wh},t.prototype.findParent=function(t){for(var n=t;null!=n;){if(this.isFocusable(n))return n;n=n.parent}return null},t.prototype.find=function(t,n,i,r,e){if(r){if(null!=(o=this.findNext(t,n,i)))return o;var u=t.parent;if(null!=u&&0<=(c=(a=u.children).indexOf(t))){var s=a.length;if(this.isFocusReverse(u)){for(var h=c-1;0<=h;--h)if(null!=(l=this.findNext(a[h],!0,!0)))return l;if(this.isFocusRoot(u))for(h=s-1;c<=h;--h)if(null!=(l=this.findNext(a[h],!0,!0)))return l}else{for(h=c+1;h<s;++h)if(null!=(l=this.findNext(a[h],!0,!0)))return l;if(this.isFocusRoot(u))for(h=0;h<=c;++h)if(null!=(l=this.findNext(a[h],!0,!0)))return l}if(u!==e)return this.find(u,!1,!1,!0,e)}}else{var o;if(null!=(o=this.findPrevious(t,n,i)))return o;var a,c,f=t.parent;if(null!=f&&0<=(c=(a=f.children).indexOf(t))){if(s=a.length,this.isFocusReverse(f)){for(h=c+1;h<s;++h)if(null!=(l=this.findPrevious(a[h],!0,!0)))return l;if(this.isFocusRoot(f)){for(h=0;h<=c;++h)if(null!=(l=this.findPrevious(a[h],!0,!0)))return l;return f}}else{for(h=c-1;0<=h;--h)if(null!=(l=this.findPrevious(a[h],!0,!0)))return l;if(this.isFocusRoot(f)){for(h=s-1;c<=h;--h){var l;if(null!=(l=this.findPrevious(a[h],!0,!0)))return l}return f}}if(f!==e)return this.find(f,!0,!1,!1,e)}}return null},t.prototype.findNext=function(t,n,i){if(n&&this.isFocusable(t))return t;if(i&&this.isFocusableContainer(t)&&t.visible){var r=t.children,e=r.length;if(this.isFocusReverse(t)){for(var u=e-1;0<=u;--u)if(null!=(s=this.findNext(r[u],!0,!0)))return s}else for(u=0;u<e;++u){var s;if(null!=(s=this.findNext(r[u],!0,!0)))return s}}return this.isFocusRoot(t)?t:null},t.prototype.findPrevious=function(t,n,i){if(i&&this.isFocusableContainer(t)&&t.visible){var r=t.children,e=r.length;if(this.isFocusReverse(t)){for(var u=0;u<e;++u)if(null!=(s=this.findPrevious(r[u],!0,!0)))return s}else for(u=e-1;0<=u;--u){var s;if(null!=(s=this.findPrevious(r[u],!0,!0)))return s}}return n&&this.isFocusable(t)||this.isFocusRoot(t)?t:null},t.prototype.isFocusable=function(t){return null!=t&&"state"in t&&t.state.inEnabled&&t.state.isFocusable&&t.visible},t.prototype.isFocusableContainer=function(t){return null!=t&&"children"in t},t.prototype.isFocusRoot=function(t){return null!=t&&"state"in t&&t.state.isFocusRoot&&t.visible},t.prototype.isFocusReverse=function(t){return null!=t&&"state"in t&&t.state.isFocusReverse},t}();!function(t){t[t.NONE=0]="NONE",t[t.UNSTORABLE=1]="UNSTORABLE",t[t.CLEAR=2]="CLEAR"}(Lc||(Lc={}));var Zc,qc=function(){function t(){}return t.prototype.execute=function(){return!0},t.prototype.redo=function(){throw new Error("Method not implemented.")},t.prototype.undo=function(){throw new Error("Method not implemented.")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Lc.UNSTORABLE|Lc.CLEAR},t}(),$c=function(){function t(){}return t.prototype.execute=function(){throw new Error("Not supported")},t.prototype.redo=function(){throw new Error("Not supported")},t.prototype.undo=function(){throw new Error("Not supported")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Lc.UNSTORABLE},t}(),Qc=function(){function t(){}return t.prototype.execute=function(){throw new Error("Not supported")},t.prototype.redo=function(){throw new Error("Not supported")},t.prototype.undo=function(){throw new Error("Not supported")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Lc.UNSTORABLE},t}(),tf=function(t){return 0==(t.getFlag()&Lc.UNSTORABLE)},nf=function(t){function n(){var n=t.call(this)||this;return n.u=0,n.Xh=[],n.Yh=[],n.Kh=null,n}return y(n,t),n.prototype.last=function(){var t=this.Xh,n=this.Yh;return n.length<=0?0<t.length?t[t.length-1]:null:n[n.length-1]},n.prototype.push=function(t){this.Yh.push(t),this.next()},n.prototype.next=function(){var t=this;if(null==this.Kh){var n=this.Yh;if(0<n.length){var i=n.shift();if(null!=i)if(i instanceof Qc){var r=this.Xh;if(this.u<r.length){var e=r[r.length-1-this.u];this.u+=1,this.emit("change",this),!0===(u=e.undo())?this.onSuccess(i):!1===u?this.onFail(i):this.Kh=u.then((function(){t.onSuccess(i)}),(function(){t.onFail(i)}))}}else if(i instanceof $c)r=this.Xh,0<this.u&&(e=r[r.length-this.u],this.u-=1,this.emit("change",this),!0===(u=e.redo())?this.onSuccess(i):!1===u?this.onFail(i):this.Kh=u.then((function(){t.onSuccess(i)}),(function(){t.onFail(i)})));else{var u,s=0!=(i.getFlag()&Lc.CLEAR),h=tf(i);if(s||h){var o=s?this.Xh.length:this.u;0<o&&(this.remove(o),this.u=0,this.emit("change",this)),this.cleanup()}!0===(u=i.execute())?this.onSuccess(i):!1===u?this.onFail(i):this.Kh=u.then((function(){t.onSuccess(i)}),(function(){t.onFail(i)}))}}}},n.prototype.cleanup=function(){var t=this.Xh,n=t.length-100;if(0<n)for(var i=0;i<n;++i)t[i].destroy(),t.shift()},n.prototype.remove=function(t){var n=this.Xh;if(0<t){var i=Math.max(0,n.length-t);if(0<(t=n.length-i)){for(var r=i,e=n.length;r<e;++r)n[r].destroy();return n.splice(i,n.length-i),!0}}return!1},n.prototype.onSuccess=function(t){this.Kh=null,tf(t)?(this.Xh.push(t),this.emit("dirty",this)):(t instanceof Qc||t instanceof $c)&&this.emit("dirty",this),this.emit("change",this),this.next()},n.prototype.onFail=function(t){this.Kh=null;var n=this.Yh;t.destroy();for(var i=0,r=n.length;i<r;++i)n[i].destroy();n.length=0,this.emit("change",this)},n.prototype.size=function(){return this.Xh.length},n.prototype.clear=function(){this.push(new qc)},n.prototype.redo=function(){this.isRedoable()&&(this.Yh.push(new $c),this.next())},n.prototype.undo=function(){this.isUndoable()&&(this.Yh.push(new Qc),this.next())},n.prototype.isRedoable=function(){return 0<this.u&&null==this.Kh},n.prototype.isUndoable=function(){return this.u<this.Xh.length&&null==this.Kh},n}(t.utils.EventEmitter),rf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(t,n,i){var r=this;t.addEventListener("keydown",(function(t){r.emit("keydown",t);var e=i.get();if(null!=e)for(var u=e;null!=u;){if(r.hasOnKeyDown(u)&&u.onKeyDown(t))return;u=u.parent}if(pt.isFocusKey(t)){var s=pt.getFocusDirection(t),h=null!=e?i.find(e,!1,e.state.isFocusRoot||s,s):i.find(n,!1,!0,s);null!=h&&(i.focus(h),t.preventDefault(),t.stopImmediatePropagation())}})),t.addEventListener("keyup",(function(t){r.emit("keyup",t);var n=i.get();if(null!=n)for(var e=n;null!=e;){if(r.hasOnKeyUp(e)&&e.onKeyUp(t))return;e=e.parent}}))},n.prototype.hasOnKeyDown=function(t){return"onKeyDown"in t},n.prototype.hasOnKeyUp=function(t){return"onKeyUp"in t},n}(t.utils.EventEmitter),ef=function(){function t(){}return t.getKeyboardController=function(){return null==this.KEYBOARD&&(this.KEYBOARD=new rf),this.KEYBOARD},t.setKeyboardController=function(t){var n=this.KEYBOARD;return this.KEYBOARD=t,n},t.getCommandController=function(){return null==this.COMMAND&&(this.COMMAND=new nf),this.COMMAND},t.setCommandController=function(t){var n=this.COMMAND;return this.COMMAND=t,n},t.getDocumentController=function(){if(null==this.DOCUMENT)throw new Error("Not supported");return this.DOCUMENT},t.setDocumentController=function(t){var n=this.DOCUMENT;return this.DOCUMENT=t,n},t}(),uf=function(n){function i(i,r){var e=n.call(this,r.getPixiApplicationOptions())||this;e.Jh=null,e.Zh=null,e.application=i;var u=e.stage;u.layer=e,u.application=i,e.vn=r,e.qh=!0,e.$h=5,e.Qh=5,e.qs=!0,e.no=function(){null!=e.Jh&&e.render()};var s=r.getRootElement(),h=document.createElement("div");h.setAttribute("style","position: absolute; top: 0; left: 0; width: 0; height: 0;margin: 0; padding: 0; outline: none;"),e.io=h;var o=s.children;if(r.isOverlay()){if(3<=o.length){var a=o[2];s.insertBefore(e.view,a),s.insertBefore(h,a)}else s.appendChild(e.view),s.appendChild(h);var c=u.onChildrenChange;u.onChildrenChange=function(){e.updateVisibility(),c.call(u)}}else if(0<o.length){var f=o[0];s.insertBefore(e.view,f),s.insertBefore(h,f)}else s.appendChild(e.view),s.appendChild(h);var l=s.style;s!==document.body&&"static"===window.getComputedStyle(s).position&&(l.position="relative"),l.margin="0",l.padding="0",l.overflow="hidden";var v=e.view.style;v.position="absolute",v.top="0",v.left="0",v.width="100%",v.height="100%",v.display="block",v.outline="none";var b=!1,g=e.getFocusController(),d=function(){b||g.clear()};s.addEventListener("focus",(function(t){b=!0}),!0),s.addEventListener("blur",(function(t){b=!1,setTimeout(d,0)}),!0),e.view.setAttribute("tabindex","0"),ef.getKeyboardController().init(e.view,e.stage,g);var m=e.renderer.plugins.interaction;m.on(ai.down,(function(t){null!=t.target&&t.target!==u||g.clear()}));var w=function(){var t=r.getRootElement().getBoundingClientRect();e.renderer.resize(t.width,t.height),e.resizeChildren(t.width,t.height,r.getPadding()),e.update()};window.addEventListener("resize",w),window.addEventListener("orientationchange",w);var p=new t.Point,O=Wc.getInstance();return O.on(e.view,(function(t){var n=t;ai.toGlobal(n,m,p);var i,r=m.hitTest(p),e=O.normalize(t);if(null!=e)for(;null!=r;){if(null!=(i=r)&&null!=i.onWheel&&r.onWheel(n,e,p)){n.preventDefault();break}r=r.parent}})),ai.onDblClick(e.view,(function(t){var n,i=g.get();if(null!=i)for(var r=i;null!=r&&(null==(n=r)||null==n.onDblClick||!r.onDblClick(t,m));)r=r.parent})),e.stage.interactive=!0,e}return y(i,n),i.prototype.disallowUpdate=function(){this.qh=!1},i.prototype.allowUpdate=function(){this.qh=!0},i.prototype.update=function(){this.qh&&null==this.Jh&&(this.Jh=requestAnimationFrame(this.no))},i.prototype.updateVisibility=function(){this.vn.isOverlay()&&(0<this.stage.children.length?this.qs||(this.qs=!0,this.view.style.display="block"):this.qs&&(this.qs=!1,this.view.style.display="none"))},i.prototype.render=function(){this.refit(),this.reflow(),this.Jh=null,n.prototype.render.call(this)},Object.defineProperty(i.prototype,"width",{get:function(){return this.screen.width},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"height",{get:function(){return this.screen.height},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"padding",{get:function(){return this.vn.getPadding()},enumerable:!1,configurable:!0}),i.prototype.resizeChildren=function(t,n,i){for(var r=this.stage.children,e=0,u=r.length;e<u;++e){var s=r[e];s instanceof li&&s.onParentResize(t,n,i)}},i.prototype.refit=function(){for(var t=this.stage.children,n=0,i=this.$h;n<i;++n){for(var r=!1,e=0,u=t.length;e<u;++e){var s=t[e];s instanceof li&&(s.refit(),r=r||s.isChildrenDirty())}if(!r)break}},i.prototype.reflow=function(){for(var t=this.stage.children,n=0,i=this.$h;n<i;++n){for(var r=!1,e=0,u=t.length;e<u;++e){var s=t[e];s instanceof li&&(s.reflow(),r=r||s.isDirty()||s.hasDirty())}if(!r)break}},i.prototype.getFocusController=function(){return null==this.ro&&(this.ro=new Jc),this.ro},i.prototype.getElementContainer=function(){return this.io},i.prototype.getDynamicFontAtlases=function(){return null==this.Zh&&(this.Zh=new Sc(this)),this.Zh},i}(t.Application),sf=function(){function n(n){B.add(this),this.Hh=this.toRootElement(n);var i=n&&null!=n.resolution?n.resolution:window.devicePixelRatio||1;this.gh=i,delete t.Renderer.__plugins.accessibility,this.vn=n;var r=this.zu=this.newLayerBase(n);this.eo=!(!n||!n.overlay),this.eo||(this.me=r)}return Object.defineProperty(n.prototype,"stage",{get:function(){return this.zu.stage},enumerable:!1,configurable:!0}),n.prototype.getRootElement=function(){return this.Hh},n.prototype.getResolution=function(){return this.gh},n.prototype.toRootElement=function(t){var n=t&&t.root;if(null!=n){if(!mt(n))return n;var i=document.querySelector(n);if(i)return i}return document.body},n.prototype.toLayerBaseOptions=function(t){var n=this.Hh,i=this.gh;return new Kc(t?{root:n,padding:t.padding,width:t.width,height:t.height,background:t.background,resolution:i,antialias:t.antialias,overlay:!1}:{root:n,resolution:i,overlay:!1})},n.prototype.newLayerBase=function(t){return new uf(this,this.toLayerBaseOptions(t))},n.prototype.getLayerBase=function(){return this.zu},n.prototype.toLayerOverlayOptions=function(t){var n=this.Hh,i=this.gh;return new Kc(t?{root:n,padding:t.padding,width:t.width,height:t.height,background:{color:null},resolution:i,antialias:t.antialias,overlay:!0}:{root:n,resolution:i,overlay:!0})},n.prototype.newLayerOverlay=function(t){return new uf(this,this.toLayerOverlayOptions(t))},n.prototype.getLayerOverlay=function(){return this.eo?(null==this.me&&(this.me=this.newLayerOverlay(this.vn)),this.me):this.zu},n.prototype.update=function(){if(!this.eo)return this.zu.update();this.zu.update();var t=this.me;t&&t.update()},n.prototype.render=function(){if(!this.eo)return this.zu.render();this.zu.render();var t=this.me;t&&t.render()},n}(),hf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DBoard"},n}(li),of=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonCheck"},n}(lr),af=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonCheckRight"},n}(of),cf=function(){function t(t,n,i,r,e){this.st=t,this.ht=n,this.u=i,this.kt=e,this.uo=r}return t.prototype.set=function(t,n,i,r){this.st===t&&this.ht===n&&this.u===i&&this.uo===r||(this.st=t,this.ht=n,this.u=i,this.uo=r,this.kt(this))},Object.defineProperty(t.prototype,"color",{get:function(){return this.st},set:function(t){this.st!==t&&(this.st=t,this.kt(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ht},set:function(t){this.ht!==t&&(this.ht=t,this.kt(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.u},set:function(t){this.u!==t&&(this.u=t,this.kt(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this.uo},set:function(t){this.uo!==t&&(this.uo=t,this.kt(this))},enumerable:!1,configurable:!0}),t.prototype.toObject=function(){return{color:this.st,alpha:this.ht,position:this.u}},t}(),ff=function(t,n){return t.position-n.position},lf=function(n){function i(){var t=n.call(this)||this;t.Qr=function(n){t.onChange(n)};var i=new cf(16777215,1,0,!1,t.Qr),r=new cf(8421504,1,1,!0,t.Qr);return t.tt=[i,r],t.Nt=-90,t.uo=r,t.so=[0,0,0],t}return y(i,n),i.prototype.onChange=function(t){var n=t.selected&&this.uo!==t;if(n){var i=this.uo;null!=i&&(i.uo=!1),this.uo=t}this.tt.sort(ff),n&&this.emit("selectionchange",this.uo,this),this.emit("change",this)},Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"direction",{get:function(){return this.Nt},set:function(t){this.Nt!==t&&(this.Nt=t,this.emit("directionchange",t,this),this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"selected",{get:function(){return this.uo},enumerable:!1,configurable:!0}),i.prototype.size=function(){return this.tt.length},i.prototype.get=function(t){var n=this.tt;return 0<=t&&t<n.length?n[t]:null},i.prototype.addAt=function(n){for(var i=this.tt,r=null,e=0,u=i.length;e<u;++e){var s=i[e];if(n<=s.position){if(null==r)return this.add(s.color,s.alpha,n,!0);var h=s.position-r.position;if(.001<h){var o=t.utils.hex2rgb(s.color,this.so),a=o[0],c=o[1],f=o[2],l=t.utils.hex2rgb(r.color,this.so),v=l[0],b=l[1],g=l[2],d=(n-r.position)/h,m=a*d+v*(1-d),w=c*d+b*(1-d),p=f*d+g*(1-d),O=this.so;O[0]=m,O[1]=w,O[2]=p;var D=t.utils.rgb2hex(O),E=s.alpha*d+r.alpha*(1-d);return this.add(D,E,n,!0)}}r=s}return null!=r?this.add(r.color,r.alpha,n,!0):this.add(16777215,1,n,!0)},i.prototype.add=function(t,n,i,r){var e=new cf(t,n,i,r,this.Qr);return this.tt.push(e),this.Qr(e),e},i.prototype.remove=function(t){var n=this.tt;if(2<n.length)for(var i=0,r=n.length;i<r;++i)if(n[i]===t){n.splice(i,1);var e=this.uo===t;return e&&(this.uo=i+1<r?n[i]:n[i-1]),e&&this.emit("selectionchange",this.uo,this),this.emit("change",this),!0}return!1},i.prototype.reset=function(){var t=this.Nt;this.Nt=-90;var n=this.tt,i=this.uo,r=i?n.indexOf(i):-1;if(n.length=0,n.push(new cf(16777215,0,0,!1,this.Qr)),n.push(new cf(16777215,0,1,!1,this.Qr)),0<=r&&r<n.length)(e=n[r]).uo=!0,this.uo=e;else if(0<n.length){var e;(e=n[n.length-1]).uo=!0,this.uo=e}else this.uo=null;return i!==this.uo&&this.emit("selectionchange",this.uo,this),t!==this.Nt&&this.emit("directionchange",this.Nt,this),this.emit("change",this),this},i.prototype.toObject=function(){for(var t=[],n=this.tt,i=0,r=n.length;i<r;++i)t.push(n[i].toObject());return{points:t,direction:this.Nt}},i.prototype.fromObject=function(t){var n=this.Nt;this.Nt=t.direction;var i=this.tt,r=this.uo,e=r?i.indexOf(r):-1;i.length=0;for(var u=0,s=t.points.length;u<s;++u){var h=t.points[u],o=new cf(h.color,h.alpha,h.position,!1,this.Qr);i.push(o)}return i.sort(ff),0<=e&&e<i.length?((o=i[e]).uo=!0,this.uo=o):0<i.length?((o=i[i.length-1]).uo=!0,this.uo=o):this.uo=null,r!==this.uo&&this.emit("selectionchange",this.uo,this),n!==this.Nt&&this.emit("directionchange",this.Nt,this),this.emit("change",this),this},i}(t.utils.EventEmitter),vf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DInputLabel"},n}(Nr),bf=function(t){function n(n){var i=t.call(this,n)||this;return i.addChild(i.je=new vf(null!=n?n.label:void 0)),i.addChild(i.Ne=i.createInput(null!=n?n.input:void 0)),null!=n&&null!=n.space&&i.addChild(new Dr(n.space)),i}return y(n,t),Object.defineProperty(n.prototype,"input",{get:function(){return this.Ne},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"label",{get:function(){return this.je},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DInputAndLabel"},n}(Sr),gf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.createInput=function(t){return new Vr(t)},n}(bf),df=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.createInput=function(t){return new Yr(t)},n}(bf),mf=function(){function t(t,n,i){this.ho=t,this.oo=n,this.ao=i}return Object.defineProperty(t.prototype,"color",{get:function(){return this.ho.color},set:function(t){if(this.ho.color!==t){var n=this.oo;null!=n&&n(t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.ho.alpha},set:function(t){if(this.ho.alpha!==t){var n=this.ao;null!=n&&n(t)}},enumerable:!1,configurable:!0}),t}(),wf=function(t){function n(n,i){var r=t.call(this)||this;return r.co=n,r.Ot=i,r}return y(n,t),n.prototype.get=function(t){var n=this.co;return 0<=t&&t<n.length?n[n.length-1-t]:null},n.prototype.set=function(t,n){var i=this.co;if(0<=t&&t<i.length){var r=i[i.length-1-t];return i[i.length-1-t]={color:n.color,alpha:n.alpha},this.emit("change",this),r}return null},n.prototype.contains=function(t){for(var n=this.co,i=0,r=n.length;i<r;++i){var e=n[i];if(e.color===t.color&&e.alpha===t.alpha)return!0}return!1},n.prototype.add=function(t){var n=this.co;return n.push({color:t.color,alpha:t.alpha}),this.Ot<n.length&&n.shift(),this.emit("change",this),this},n.prototype.pop=function(){var t=this.co.shift();return null!=t?(this.emit("change",this),t):null},n.prototype.size=function(){return this.co.length},n}(t.utils.EventEmitter),pf=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),Object.defineProperty(i.prototype,"current",{get:function(){return this.fo},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"new",{get:function(){return this.lo},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"recent",{get:function(){return this.vo},enumerable:!1,configurable:!0}),i.prototype.init=function(r){var e=this;n.prototype.init.call(this,r),this.state.isFocusable=!1,this.zu=16711680,this.bo={color:16777215,alpha:1},this.lo=new mf(this.bo,(function(t){e.setColorNew(t)}),(function(t){e.setAlphaNew(t)})),this._s={color:16777215,alpha:1},this.fo=new mf(this._s,(function(t){e.setColorCurrent(t)}),(function(t){e.setAlphaCurrent(t)}));var u=this.theme,s=this.Mn,h=s.getTop(),o=s.getRight(),a=s.getBottom(),c=s.getLeft();this.do=new t.Point;var f=u.getMainWidth(),l=u.getMainHeight(),v=this.mo=new t.Sprite(t.Texture.WHITE);v.x=c,v.y=h,v.width=f,v.height=l,v.interactive=!0,this.addChild(v);var b=this.wo=new t.Sprite(u.getMainTexture());b.x=c,b.y=h,b.tint=this.zu,b.interactive=!1,this.addChild(b),this.po=function(t){e.onMainMove(t)},this.Oo=function(t){e.onMainUp(t)},v.on(ai.down,(function(t){e.onMainDown(t)}));var g=this.Do=new t.Sprite(u.getBaseTexture());g.x=c,g.y=v.y+v.height+u.getBaseMargin(),g.interactive=!0,this.addChild(g),this.Eo=function(t){e.onBaseMove(t)},this.Mo=function(t){e.onBaseUp(t)},g.on(ai.down,(function(t){e.onBaseDown(t)}));var d=this.So=new t.Sprite(u.getAlphaCheckerboardTexture());d.x=s.getLeft(),d.y=g.y+u.getBaseHeight()+u.getBaseMargin(),d.interactive=!1,this.addChild(d);var m=new t.Sprite(u.getAlphaTexture());m.tint=this.bo.color,m.interactive=!0,d.addChild(m),this.To=function(t){e.onAlphaMove(t)},this.jo=function(t){e.onAlphaUp(t)},m.on(ai.down,(function(t){e.onAlphaDown(t)}));var w=this.No=new t.Sprite(u.getMainPointerTexture());w.x=c,w.y=h,w.anchor.x=.5,w.anchor.y=.5,w.tint=u.getMainPointerColor(),w.alpha=u.getMainPointerAlpha(),w.interactive=!1,this.addChild(w);var p=this.Io=new t.Sprite(u.getAlphaPointerTexture());p.x=f,p.y=.5*d.height,p.tint=u.getAlphaPointerColor(),p.alpha=u.getAlphaPointerAlpha(),p.anchor.set(.5,.5),p.interactive=!1,d.addChild(p);var O=this.Co=new t.Sprite(u.getBasePointerTexture());O.x=0,O.y=.5*g.height,O.tint=u.getBasePointerColor(),O.alpha=u.getBasePointerAlpha(),O.anchor.set(.5,.5),O.interactive=!1,g.addChild(O),this.Ao=[];var D=this.Ao,E=u.getRecentColorCount(),M=u.getRecentColorWidth(),S=u.getRecentColorHeight(),T=.5*M,j=.5*S,N=u.getRecentColorMargin(),I=d.y+u.getAlphaHeight()+u.getRecentMargin(),C=u.getRecentCheckerboardTexture();null==i.RECENT_COLORS&&(i.RECENT_COLORS=new wf(u.getRecents().slice(0),E));var A=this.vo=i.RECENT_COLORS;A.on("change",(function(){e.onRecentChange()}));for(var R=function(n){var i=n.currentTarget;if(i instanceof t.Container){var r=i.children[0];r instanceof t.Sprite&&(e.setColorNew(r.tint),e.setAlphaNew(r.alpha))}},y=0;y<E;++y){var k=c+y*(M+N),x=new t.Sprite(C);x.x=k+T,x.y=I+j,x.anchor.x=.5,x.anchor.y=.5,x.buttonMode=!0,x.interactive=!0,ai.onClick(x,R),this.addChild(x);var L=new t.Sprite(t.Texture.WHITE),B=A.get(y);null!=B?(L.tint=B.color,L.alpha=B.alpha):(L.tint=16777215,L.alpha=0),L.width=M,L.height=S,L.anchor.x=.5,L.anchor.y=.5,L.interactive=!1,x.addChild(L),D.push(L)}var _=u.getInputMargin(),P=I+S+_,F=.5*f,U=this.Ro=new df({parent:this,x:c,y:P,width:F,label:{width:u.getInputLabelWidth(),text:{value:"#"}},input:{weight:1,text:{value:"FFFFFF"},on:{input:function(t){var n=W.fromCode(t);null!=n&&e.setColorNew(n)}}}}),z=this.yo=new gf({parent:this,x:c,y:P+U.height+_,width:F,label:{width:u.getInputLabelWidth(),text:{value:"A"}},input:{weight:1,text:{value:1},min:0,max:1,on:{input:function(t){e.setAlphaNew(t)}}}}),G=u.getSampleWidth(),H=u.getSampleHeight(),V=c+.75*f-G,X=P+.5*(U.height+_+z.height-H),Y=this.ko=new t.Sprite(u.getSampleCheckerboardTexture());Y.x=V,Y.y=X,Y.width=G,Y.height=H,Y.interactive=!1,this.addChild(Y);var K=this._s,J=this.xo=new t.Sprite(t.Texture.WHITE);J.x=V,J.y=X,J.tint=K.color,J.alpha=K.alpha,J.width=G,J.height=H,J.interactive=!0,J.buttonMode=!0,ai.onClick(J,(function(){e.setColorNew(K.color),e.setAlphaNew(K.alpha)})),this.addChild(J);var Z=this.Lo=new t.Sprite(u.getSampleCheckerboardTexture());Z.x=V+G,Z.y=X,Z.width=G,Z.height=H,Z.interactive=!1,this.addChild(Z);var q=this.Bo=new t.Sprite(t.Texture.WHITE);q.x=V+G,q.y=X,q.tint=this.bo.color,q.alpha=this.bo.alpha,q.width=G,q.height=H,q.interactive=!1,this.addChild(q),null!=r&&null!=r.width||(this.width=c+f+o),null!=r&&null!=r.height||(this.height=P+U.height+_+z.height+a)},i.prototype.onMainDown=function(t){this.onMainPick(t.data.global);var n=B.getLayer(this);if(n){var i=n.stage;i.on(ai.move,this.po),i.on(ai.up,this.Oo)}},i.prototype.onMainMove=function(t){this.onMainPick(t.data.global)},i.prototype.onMainUp=function(t){var n=B.getLayer(this);if(n){var i=n.stage;i.off(ai.move,this.po),i.off(ai.up,this.Oo)}},i.prototype.toMainHex=function(t,n,i,r){return Math.max(0,Math.min(255,255*n+i*(t>>r&255)))<<r},i.prototype.toMainColor=function(t,n,i,r,e){var u=.5*r,s=Math.max(0,Math.min(1,((n-u)*(1-i/e)+u)/r)),h=Math.max(0,Math.min(1,i/e)),o=Math.abs(.5*h-s),a=1-o-h;return this.toMainHex(t,a,o,16)|this.toMainHex(t,a,o,8)|this.toMainHex(t,a,o,0)},i.prototype.onMainPick=function(t){var n=this.do,i=this.Mn,r=i.getLeft(),e=i.getTop(),u=this.theme,s=u.getMainWidth(),h=u.getMainHeight();this.toLocal(t,void 0,n);var o=Math.max(0,Math.min(s,n.x-r)),a=Math.max(0,Math.min(h,n.y-e));this.No.position.set(r+o,e+a),this.onColorNew(this.toMainColor(this.zu,o,a,s,h))},i.prototype.setColorCurrent=function(t){this.xo.tint=this._s.color=t},i.prototype.setAlphaCurrent=function(t){this.xo.alpha=this._s.alpha=t},i.prototype.setColorNew=function(t){var n=this.theme,i=n.getMainWidth(),r=n.getMainHeight(),e=this.Mn,u=_c.fromRgb(t);this.wo.tint=this.zu=_c.toRgb(u[0],255,255),this.Co.x=Math.max(0,Math.min(1,u[0]/360))*i;var s=Math.max(0,Math.min(1,u[1]/255)),h=Math.max(0,Math.min(1,1-u[2]/255)),o=this.No;o.tint=h<.45?n.getMainPointerColor():16777215,o.position.set(e.getLeft()+s*i,e.getTop()+h*r),this.onColorNew(t)},i.prototype.onColorNew=function(t){var n=B.getLayer(this);n&&n.disallowUpdate(),this.Bo.tint=this.bo.color=t,this.Ro.input.value=W.toCode(t),this.emit("newcolorchange",t,this),n&&(n.allowUpdate(),n.update())},i.prototype.onBaseDown=function(t){this.onBasePick(t.data.global);var n=B.getLayer(this);if(n){var i=n.stage;i.on(ai.move,this.Eo),i.on(ai.up,this.Mo)}},i.prototype.onBaseMove=function(t){this.onBasePick(t.data.global)},i.prototype.onBaseUp=function(t){var n=B.getLayer(this);if(n){var i=n.stage;i.off(ai.move,this.Eo),i.off(ai.up,this.Mo)}},i.prototype.toBaseHex=function(t,n){return Math.max(0,Math.min(255,6*t*255))<<n},i.prototype.toBaseColor=function(t){return t<=.167?16711680+this.toBaseHex(t,8):t<=.333?(t=.333-t,65280+this.toBaseHex(t,16)):t<=.5?(t-=.333,65280+this.toBaseHex(t,0)):t<.667?(t=.667-t,255+this.toBaseHex(t,8)):t<.883?(t-=.667,255+this.toBaseHex(t,16)):(t=.883-t,16711680+this.toBaseHex(t,0))},i.prototype.onBasePick=function(t){var n=this.do,i=this.Mn,r=this.theme.getMainWidth();this.toLocal(t,void 0,n);var e=Math.max(0,Math.min(r,n.x-i.getLeft()));this.Co.x=e,this.onColorBase(this.toBaseColor(e/r))},i.prototype.setColorBase=function(t){var n=this.theme.getMainWidth();this.Co.x=Math.max(0,Math.min(1,t/360))*n,this.onColorBase(_c.toRgb(t,255,255))},i.prototype.onColorBase=function(t){this.wo.tint=this.zu=t;var n=this.No,i=this.theme,r=i.getMainWidth(),e=i.getMainHeight(),u=this.Mn;this.onColorNew(this.toMainColor(this.zu,n.x-u.getLeft(),n.y-u.getTop(),r,e))},i.prototype.onAlphaDown=function(t){this.onAlphaPick(t.data.global);var n=B.getLayer(this);if(n){var i=n.stage;i.on(ai.move,this.To),i.on(ai.up,this.jo)}},i.prototype.onAlphaMove=function(t){this.onAlphaPick(t.data.global)},i.prototype.onAlphaUp=function(t){var n=B.getLayer(this);if(n){var i=n.stage;i.off(ai.move,this.To),i.off(ai.up,this.jo)}},i.prototype.onAlphaPick=function(t){var n=this.do,i=this.Mn,r=this.theme.getMainWidth();this.toLocal(t,void 0,n);var e=Math.max(0,Math.min(r,n.x-i.getLeft()));this.Io.x=e,this.onAlphaNew(e/r)},i.prototype.setAlphaNew=function(t){var n=this.theme.getMainWidth();this.Io.x=Math.max(0,Math.min(1,t))*n,this.onAlphaNew(t)},i.prototype.onAlphaNew=function(t){var n=B.getLayer(this);n&&n.disallowUpdate(),this.Bo.alpha=this.bo.alpha=t,this.yo.input.value=Number(t.toFixed(2)),this.emit("newalphachange",t,this),n&&(n.allowUpdate(),n.update())},i.prototype.onRecentChange=function(){for(var t=this.Ao,n=this.vo,i=0,r=t.length;i<r;++i){var e=t[i],u=n.get(i);null!=u?(e.tint=u.color,e.alpha=u.alpha):(e.tint=16777215,e.alpha=0)}},i.prototype.getType=function(){return"DPickerColor"},i.RECENT_COLORS=null,i}(li),Of=function(t,n){if(t.direction!==n.direction)return!1;var i=t.points,r=n.points;if(i.length!==r.length)return!1;for(var e=0,u=i.length;e<u;++e){var s=i[e],h=r[e];if(s.color!==h.color||s.alpha!==h.alpha||s.position!==h.position)return!1}return!0},Df=function(t){function n(n,i){var r=t.call(this)||this;return r.co=n,r.Ot=i,r}return y(n,t),n.prototype.getCapacity=function(){return this.Ot},n.prototype.get=function(t){var n=this.co;return 0<=t&&t<n.length?n[n.length-1-t]:null},n.prototype.set=function(t,n){var i=this.co;if(0<=t&&t<i.length){var r=i[i.length-1-t];return i[i.length-1-t]=n,this.emit("change",this),r}return null},n.prototype.contains=function(t){for(var n=this.co,i=0,r=n.length;i<r;++i)if(Of(n[i],t))return!0;return!1},n.prototype.add=function(t){var n=this.co;return n.push(t),this.Ot<n.length&&n.shift(),this.emit("change",this),this},n.prototype.pop=function(){var t=this.co.shift();return null!=t?(this.emit("change",this),t):null},n.prototype.size=function(){return this.co.length},n}(t.utils.EventEmitter),Ef=function(n){function i(i,r,e,u,s,h,o,a){var c=n.call(this,o,a)||this;return c.interactive=!0,c.interactiveChildren=!1,c.cursor="pointer",c._o=i,c.Kt=r,c._uvs=e,c.Po=u,c.qt=s,c.Fo=-1,c.so=[0,0,0],c.Le=new t.Point,c.Uo=h,a.uniforms.uSampler.on("update",(function(){c.update(),B.update(c)})),c.update(),c}return y(i,n),i.prototype.getRectangle=function(t){var n=this.Uo;return 0<=t&&t<n.length?n[t].rect:null},i.prototype.setRectangle=function(t,n,i,r,e){var u=this.Uo;if(0<=t&&t<u.length){var s=u[t].rect;s.x=n,s.y=i,s.width=r,s.height=e}},i.prototype.getData=function(t){var n=this.Uo;return 0<=t&&t<n.length?n[t].data:null},i.prototype.setData=function(t,n){var i=this.Uo;0<=t&&t<i.length&&(i[t].data=n)},i.prototype.getLastHitIndex=function(){return this.Fo},i.prototype.setColors=function(t,n,i,r){n[t+0]=i[0],n[t+1]=i[1],n[t+2]=i[2],n[t+3]=r,n[t+4]=i[0],n[t+5]=i[1],n[t+6]=i[2],n[t+7]=r},i.prototype.setColorsHex=function(n,i,r,e){var u=t.utils.hex2rgb(r,this.so);this.setColors(n,i,u,e)},i.prototype.setColorsWhite=function(t,n){var i=this.so;i[0]=1,i[1]=1,i[2]=1,this.setColors(t,n,i,0)},i.prototype.setColorsPoint=function(t,n,i,r){var e=n.points[i];null!=e?this.setColorsHex(t,r,e.color,e.alpha):this.setColorsWhite(t,r)},i.prototype.setVertices=function(t,n,i,r){var e=r.y+r.height*i;n[t+0]=r.x,n[t+1]=e,n[t+2]=r.x+r.width,n[t+3]=e},i.prototype.setUvs=function(t,n,i,r){var e=r.x0+(r.x3-r.x0)*i,u=r.y0+(r.y3-r.y0)*i,s=r.x1+(r.x2-r.x1)*i,h=r.y1+(r.y2-r.y1)*i;n[t+0]=e,n[t+1]=u,n[t+2]=s,n[t+3]=h},i.prototype.newIndices=function(t,n,i,r){for(var e=0;e<i;++e)r[t+0]=n+0,r[t+1]=n+1,r[t+2]=n+2,r[t+3]=n+2,r[t+4]=n+1,r[t+5]=n+3,t+=6,n+=2;return r},i.prototype._calculateBounds=function(){var t=this.Uo[0].rect,n=this._bounds,i=this.Le;i.set(t.x,t.y),n.addPoint(i),i.set(t.x+t.width,t.y+t.height),n.addPoint(i)},i.prototype.update=function(){var t=this.Kt,n=this._uvs,i=this.Po,r=this.qt,e=this.shader.uniforms.uSampler;null==e._uvs&&e.updateUvs();for(var u=e._uvs,s=0,h=0,o=0,a=0,c=this.Uo,f=0,l=c.length;f<l;++f){var v=c[f].data,b=c[f].rect;if(null==v)this.setVertices(s,t,0,b),this.setUvs(s,n,0,u),this.setColorsWhite(o,i),this.setVertices(s+4,t,1,b),this.setUvs(s,n,1,u),this.setColorsWhite(o+8,i),this.newIndices(a,h,1,r),s+=8,o+=16,h+=4,a+=6;else{this.setVertices(s,t,0,b),this.setUvs(s,n,0,u),this.setColorsPoint(o,v,0,i),s+=4,o+=8;for(var g=v.points.length,d=0,m=Math.min(g,this._o);d<m;++d){var w=v.points[d];this.setVertices(s,t,w.position,b),this.setUvs(s,n,w.position,u),this.setColorsHex(o,i,w.color,w.alpha),s+=4,o+=8}this.setVertices(s,t,1,b),this.setUvs(s,n,1,u),this.setColorsPoint(o,v,g-1,i),s+=4,o+=8,this.newIndices(a,h,g+1,r),a+=6*(g+1),h+=2*(g+2)}}this.size=a;var p=this.geometry;p.getBuffer("aPosition").update(),p.getBuffer("aUv").update(),p.getBuffer("aColor").update(),p.getIndex().update()},i.prototype.containsPoint=function(t){for(var n=this.toLocal(t,void 0,this.Le),i=this.Uo,r=0,e=i.length;r<e;++r)if(i[r].rect.contains(n.x,n.y))return this.Fo=r,!0;return!1},i.from=function(n,r,e,u){void 0===u&&(u=t.Texture.WHITE);for(var s=new Float32Array(n*(r+2)*2*2),h=new Float32Array(n*(r+2)*2*2),o=new Float32Array(n*(r+2)*2*4),a=new Uint16Array(n*(r+1)*6),c=[],f=0;f<n;++f)c.push({data:null,rect:new t.Rectangle});return new i(r,s,h,o,a,c,(new t.Geometry).addIndex(new t.Buffer(a,!1,!0)).addAttribute("aPosition",new t.Buffer(s,!1,!1),2).addAttribute("aUv",new t.Buffer(h,!1,!1),2).addAttribute("aColor",new t.Buffer(o,!1,!1),4),t.Shader.from("\nattribute vec2 aPosition;\nattribute vec2 aUv;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main(void) {\n\tvec3 position = vec3(aPosition.x, aPosition.y, 1.0);\n\tgl_Position = vec4((projectionMatrix * translationMatrix * position).xy, 0.0, 1.0);\n\tvUv = aUv;\n\tvColor = aColor;\n}\n","\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform vec2 uCheckerColors;\n\nvoid main(void) {\n\tvec4 texture = texture2D(uSampler, vUv);\n\tfloat cy = step( 1.0, mod( gl_FragCoord.y / 10.0, 2.0 ) );\n\tfloat cx = step( 1.0, mod( gl_FragCoord.x / 10.0 + cy, 2.0 ) );\n\tfloat c = mix( uCheckerColors.x, uCheckerColors.y, cx );\n\tgl_FragColor = texture * vec4( mix( vec3( c ), vColor.xyz, vColor.a ), 1.0 );\n}",{uSampler:u,uCheckerColors:e}))},i}(t.Mesh),Mf=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(r){var e=this;n.prototype.init.call(this,r),this.state.isFocusable=!1;var u=this.theme,s=this.Mn,h=s.getTop(),o=s.getRight(),a=s.getBottom(),c=s.getLeft();this.Ks=new t.Point;var f=u.getGradientPointsWidth(),l=u.getGradientPointsMargin(),v=this.Su=new pf({x:c+f+l,y:h});v.on("newcolorchange",(function(t){e.onAnchorColorChange(t)})),v.on("newalphachange",(function(t){e.onAnchorAlphaChange(t)})),this.addChild(v);var b=this.Wi=Ef.from(17,10,u.getGradientCheckerColors());b.setRectangle(0,c,h,f,v.height),this.addChild(b),b.on(ai.down,(function(t){0===b.getLastHitIndex()&&e.onViewDown(t)})),this.zo=function(t){e.onAnchorDown(t)},this.Go=function(t){e.onAnchorMove(t)},this.Ho=function(t){e.onAnchorUp(t)},this.Vo=[];var g=v.theme.getInputLabelWidth(),d=.5*v.theme.getMainWidth(),m=u.getGradientDirectionMargin(),w=u.getGradientDirectionTexture(),p=v.x+v.width+m,O=new Vr({parent:this,x:p+g+5,y:h,width:d-g-5,step:1,image:{source:w,align:{with:qi.BORDER},margin:{horizontal:-w.width-5}},on:{change:function(t){e.gt.Nt=t}}}),D=u.getGradientRecentColumn(),E=u.getGradientRecentWidth(),M=u.getGradientRecentMargin(),S=E+M,T=p,j=O.y+O.height+m;null==i.RECENT_COLOR_GRADIENT&&(i.RECENT_COLOR_GRADIENT=new Df(u.getGradientRecents(),u.getGradientRecentCount())),this.vo=i.RECENT_COLOR_GRADIENT;for(var N=this.vo,I=0,C=N.getCapacity();I<C;++I){var A=T+I%D*S,R=j+(I/D|0)*S;b.setRectangle(1+I,A,R,E,E)}N.on("change",(function(){e.onRecentUpdate()})),ai.onClick(b,(function(t){var n=b.getLastHitIndex();1<=n&&e.onRecentClick(b.getData(n))}));var y=this.gt=new lf;y.on("change",(function(){e.updateAnchors(),b.update()})),y.on("selectionchange",(function(t){e.onAnchorSelect(t)})),y.on("directionchange",(function(t){O.value=t})),b.setData(0,y),b.update(),O.value=y.direction,this.updateAnchors();var k=y.selected;null!=k&&this.onAnchorSelect(k),null!=r&&null!=r.width||(this.width=c+f+l+v.width+m+(D-1)*M+D*E+o),null!=r&&null!=r.height||(this.height=h+v.height+a)},Object.defineProperty(i.prototype,"value",{get:function(){return this.gt},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"recent",{get:function(){return this.vo},enumerable:!1,configurable:!0}),i.prototype.onRecentClick=function(t){var n=this.gt;null!=t?n.fromObject(t):n.reset()},i.prototype.onRecentUpdate=function(){for(var t=this.vo,n=this.Wi,i=0,r=t.size();i<r;++i)n.setData(1+i,t.get(i));n.update(),B.update(this)},i.prototype.toAnchorPosition=function(t){var n=this.toLocal(t.data.global,void 0,this.Ks);return Math.max(0,Math.min(1,(n.y-this.padding.getTop())/this.Su.height))},i.prototype.onViewDown=function(t){this.gt.addAt(this.toAnchorPosition(t)),this.onAnchorDragStart()},i.prototype.onAnchorDown=function(n){var i=n.target;if(i instanceof t.Sprite){var r=this.gt,e=this.Vo.indexOf(i);0<=e&&e<r.points.length&&(r.points[e].selected=!0,this.onAnchorDragStart())}},i.prototype.onAnchorSelect=function(t){var n=this.Su;n.current.color=t.color,n.current.alpha=t.alpha,n.new.color=t.color,n.new.alpha=t.alpha},i.prototype.onAnchorColorChange=function(t){var n=this.gt;if(null!=n){var i=n.selected;null!=i&&(i.color=t)}},i.prototype.onAnchorAlphaChange=function(t){var n=this.gt;if(null!=n){var i=n.selected;null!=i&&(i.alpha=t)}},i.prototype.onAnchorDragStart=function(){var t=B.getLayer(this);if(t){var n=t.stage;n.on(ai.move,this.Go),n.on(ai.up,this.Ho)}},i.prototype.onAnchorMove=function(t){var n=this.gt;if(null!=n){var i=n.selected;null!=i&&(i.position=this.toAnchorPosition(t))}},i.prototype.onAnchorUp=function(t){var n=B.getLayer(this);if(n){var i=n.stage;i.off(ai.move,this.Go),i.off(ai.up,this.Ho)}},i.prototype.updateAnchors=function(){for(var n=this.theme,i=n.getGradientAnchorTexture(),r=n.getGradientAnchorOutlinedTexture(),e=n.getGradientPointsWidth(),u=this.gt,s=u.points.length,h=this.Vo,o=h.length,a=o;a<s;++a){var c=new t.Sprite(i);c.anchor.set(.5,.5),c.cursor="pointer",c.interactive=!0,c.on(ai.down,this.zo),h.push(c),this.addChild(c)}for(a=o-1;s<=a;--a){var f=h[a];f.off(ai.down,this.zo),f.destroy()}h.length=s;var l=this.padding.getTop(),v=this.padding.getLeft()+e,b=this.Su.height;for(a=0;a<s;++a){var g=u.points[a],d=h[a];d.tint=g.color,d.position.set(v,l+b*g.position),d.texture=g.selected?r:i}B.update(this)},i.prototype.onKeyDown=function(t){if(pt.isDeleteKey(t)){var i=this.gt;if(null!=i){var r=i.selected;if(null!=r)return i.remove(r),n.prototype.onKeyDown.call(this,t),!0}}return n.prototype.onKeyDown.call(this,t)},i.prototype.getType=function(){return"DPickerColorGradient"},i.RECENT_COLOR_GRADIENT=null,i}(li),Sf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new Mf(i&&i.picker);this.Su=r,n.addChild(r),this.on("ok",(function(){var t=r.value,n=r.recent;n.contains(t)||n.add(t.toObject())}))},Object.defineProperty(n.prototype,"value",{get:function(){return this.Su.value},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"recent",{get:function(){return this.Su.recent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Su},enumerable:!1,configurable:!0}),n.prototype.doResolve=function(t){t(this.value)},n.prototype.onKeyDown=function(n){return this.Su.onKeyDown(n),t.prototype.onKeyDown.call(this,n)},n.prototype.getType=function(){return"DDialogColorGradient"},n}(jr),Tf=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(i){var r=this;n.prototype.init.call(this,i);var e=this.Xr;if(this.Wo=i&&i.dialog,null==i||null==i.image||void 0===i.image.source){var u=this.theme,s=u.getViewBaseTexture();if(s instanceof t.Texture){var h=u.getCheckerColors(),o=this.Wi=Ef.from(1,10,h,s);o.setRectangle(0,0,0,s.width,s.height),o.setData(0,e),o.update(),this.image=o}}this.on("active",(function(){var t=r.dialog;t.value.fromObject(e),t.open().then((function(){var n=t.value,i=(new lf).fromObject(e);e.fromObject(n);var u=r.Wi;null!=u&&u.update(),r.onTextChange(),r.createOrUpdateText(),B.update(r),r.emit("change",n,i,r)}))}))},Object.defineProperty(i.prototype,"dialog",{get:function(){var t=this.Xo;return null==t&&(null!=this.Wo?t=new Sf(this.Wo):(null==i.DIALOG&&(i.DIALOG=new Sf),t=i.DIALOG),this.Xo=t),t},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"value",{get:function(){return this.Xr},enumerable:!1,configurable:!0}),i.prototype.getType=function(){return"DButtonColorGradient"},i}(vr),jf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new pf(i&&i.picker);this.Su=r,n.addChild(r),this.on("ok",(function(){var t=r.recent;t.contains(r.new)||t.add(r.new)}))},Object.defineProperty(n.prototype,"current",{get:function(){return this.Su.current},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Su.new},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"recent",{get:function(){return this.Su.recent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Su},enumerable:!1,configurable:!0}),n.prototype.doResolve=function(t){t(this.new)},n.prototype.getType=function(){return"DDialogColor"},n}(jr),Nf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=this.Xr;this.gt=new mf(r,(function(t){r.color=t,i.onColorChange()}),(function(t){r.alpha=t,i.updateTextForcibly()})),this.on("active",(function(){var t=i.dialog;t.current.color=r.color,t.current.alpha=r.alpha,t.new.color=r.color,t.new.alpha=r.alpha,t.open().then((function(){var n=t.new,e=t.current;r.color=n.color,r.alpha=n.alpha,i.onColorChange(),i.emit("change",n,e,i)}))}))},n.prototype.toImageTintOptions=function(t){var n=this,i=function(){return n.Xr.color};return t?{color:t.color||i,alpha:t.alpha}:{color:i}},n.prototype.toImageOptions=function(t,n){return n?{source:n.source,tint:this.toImageTintOptions(n.tint),align:n.align,margin:n.margin}:{tint:this.toImageTintOptions()}},n.prototype.onColorChange=function(){this.ne[0].updateTint()&&B.update(this),this.updateTextForcibly()},n.prototype.updateTextForcibly=function(){this.onTextChange(),this.createOrUpdateText()},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.Xo;if(null==t){var i=this.vn,r=i&&i.dialog;null!=r?t=new jf(r):(null==n.DIALOG&&(n.DIALOG=new jf),t=n.DIALOG),this.Xo=t}return t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DButtonColor"},n}(vr),If=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonDanger"},n}(vr),Cf=function(){function t(){}return t.getInstance=function(){return null==t.INSTANCE&&(t.INSTANCE=new Me),t.INSTANCE},t}(),Af=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Wo=n&&n.dialog,this.on("active",(function(){var t=i.Xr.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.page=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.text=new Date(t.getTime()),i.emit("change",t,r,i)}))}))},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.Xo;return null==t&&(t=null!=this.Wo?new Me(this.Wo):Cf.getInstance(),this.Xo=t),t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.Xr},set:function(t){this.Xr.getTime()!==t.getTime()&&(this.text=t)},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DButtonDate"},n}(vr),Rf=function(){function t(){}return t.getInstance=function(){return null==t.INSTANCE&&(t.INSTANCE=new me),t.INSTANCE},t}(),yf=function(){function t(){}return t.format=function(t){return V(String(t.getFullYear()),4,"0")+"/"+V(String(t.getMonth()+1),2,"0")+"/"+V(String(t.getDate()),2,"0")},t}(),kf=function(){function t(){}return t.format=function(t,n){var i="";return n&Qr.HOURS&&(i+=V(String(t.getHours()),2,"0")),n&Qr.MINUTES&&(0<i.length&&(i+=":"),i+=V(String(t.getMinutes()),2,"0")),n&Qr.SECONDS&&(0<i.length&&(i+=":"),i+=V(String(t.getSeconds()),2,"0")),i},t.toMask=function(t){return oe.from("DPickerTime",t)},t}(),xf=function(){function t(){}return t.format=function(t,n){var i=kf.format(t,n);return 0<i.length?yf.format(t)+" "+i:""+yf.format(t)},t.toMask=function(t){return oe.from("DPickerDatetime",t)},t}(),Lf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on("active",(function(){var t=i.Xr.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.page=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.text=new Date(t.getTime()),i.emit("change",t,r,i)}))}))},n.prototype.getDatetimeMask=function(){var t,n,i=this.Yo;return null==i&&(i=xf.toMask(null===(n=null===(t=this.vn)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.picker),this.Yo=i),i},Object.defineProperty(n.prototype,"dialog",{get:function(){var t,n=this.Xo;if(null==n){var i=null===(t=this.vn)||void 0===t?void 0:t.dialog;n=null!=i?new me(i):Rf.getInstance(),this.Xo=n}return n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.Xr},set:function(t){this.Xr.getTime()!==t.getTime()&&(this.text=t)},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DButtonDatetime"},n}(vr),Bf=Ac,_f=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Qn=null!=n&&null!=n.checker?n.checker:void 0;var r=null!=n&&null!=n.as?mt(n.as)?Bf[n.as]:n.as:Bf.TEXT,e=new Bc(r,this);this.Ko=e,this.on("active",(function(){var t=i.onOpening();!0===t?e.open():!1===t||t.then((function(){e.open()}))}))},n.prototype.onOpening=function(){var t=this.Qn;return null==t||t()},n.prototype.open=function(){this.Ko.open()},n.prototype.getType=function(){return"DButtonFile"},n}(vr),Pf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.initOnClick=function(t){var n=this,i=new ia(this.theme,t);this.vs=i,i.apply(this,(function(t){n.onClick(t)}))},n.prototype.onActivate=function(n){t.prototype.onActivate.call(this,n),this.open(this.vs.inNewWindow(n))},n.prototype.open=function(t){this.vs.open(t)},n.prototype.getType=function(){return"DButtonLink"},n}(lr),Ff=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonRadio"},n}(lr),Uf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonRadioRight"},n}(Ff),zf=function(t){function n(n){var i=t.call(this,n)||this,r=ef.getCommandController();return i.state.isDisabled=!r.isRedoable(),r.on("change",(function(){i.state.isDisabled=!r.isRedoable()})),i.on("active",(function(){r.redo()})),i}return y(n,t),n}(vr),Gf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DButtonSecondary"},n}(vr);!function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULTIPLE=2]="MULTIPLE"}(Zc||(Zc={}));var Hf,Vf,Wf=function(t){function n(n,i){var r=t.call(this)||this;r.Jo=n,r.Wt=!1,r.qt=[],r.Zo=i&&null!=i.mode?i.mode:Zc.SINGLE;var e=i&&i.on;if(e)for(var u in e){var s=e[u];s&&r.on(u,s)}return r}return y(n,t),n.prototype.toDirty=function(){this.Wt=!0},n.prototype.update=function(){if(this.Wt){this.Wt=!1;var t=this.qt;t.length=0;for(var n=this.Jo.children,i=0,r=n.length;i<r;++i){var e=n[i];e instanceof li&&e.state.isActive&&t.push(i)}}},n.prototype.size=function(){return this.update(),this.qt.length},n.prototype.isEmpty=function(){return this.size()<=0},n.prototype.first=function(){return this.get(0)},n.prototype.get=function(t){this.update();var n=this.qt;if(0<=t&&t<n.length){var i=this.Jo.children[n[t]];if(null!=i)return i}return null},n.prototype.getIndex=function(t){this.update();var n=this.qt;return 0<=t&&t<n.length?n[t]:null},n.prototype.clear=function(){this.update();var t=this.qt;if(0<t.length){for(var n=this.Jo.children,i=0,r=t.length;i<r;++i){var e=n[t[i]];e instanceof li&&(e.state.isActive=!1)}t.length=0,this.emit("change",this)}},n.prototype.add=function(t){var n=this.Zo,i=this.Jo;if(n===Zc.SINGLE){if(!t.state.isActive){this.update();for(var r=this.qt,e=i.children,u=0,s=r.length;u<s;++u){var h=e[r[u]];h instanceof li&&(h.state.isActive=!1)}r.length=0,r.push(i.getChildIndex(t)),t.state.isActive=!0,this.emit("change",this)}}else if(n===Zc.MULTIPLE&&!t.state.isActive)if(this.Wt)t.state.isActive=!0,this.emit("change",this);else{r=this.qt;var o=i.getChildIndex(t);for(u=0,s=r.length;u<s;++u){var a=r[u];if(o===a)return void(t.state.isActive=!0);if(o<a)return r.splice(u,0,o),t.state.isActive=!0,void this.emit("change",this)}r.push(o),t.state.isActive=!0,this.emit("change",this)}},n.prototype.remove=function(t){if(!t.state.isActive)if(this.Wt)t.state.isActive=!1,this.emit("change",this);else for(var n=this.qt,i=this.Jo.getChildIndex(t),r=0,e=n.length;r<e;++r)if(i===n[r])return n.splice(r,1),t.state.isActive=!1,void this.emit("change",this)},n}(t.utils.EventEmitter),Xf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.state.isFocusable=!1},n.prototype.initReflowable=function(){},n.prototype.getType=function(){return"DContent"},n}(li),Yf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.qo=0,this.$o=1;var i=this.Qo=this.createThumb(null!=n?n.thumb:void 0);this.addChild(i),this.state.isFocusable=!1},Object.defineProperty(n.prototype,"thumb",{get:function(){return this.Qo},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DScrollBar"},n.prototype.setRegion=function(t,n,i){i<1?(t=0,n=1):(t=Math.max(0,Math.min(1,t/i)),n=Math.max(t,Math.min(1,n/i))),this.qo===t&&this.$o===n||(this.qo=t,this.$o=n,this.onRegionChange())},n.prototype.isRegionVisible=function(){return 0<this.qo||this.$o<1},n.prototype.onResize=function(n,i,r,e){t.prototype.onResize.call(this,n,i,r,e),this.onRegionChange()},n.prototype.onRegionChange=function(){},n.prototype.getRegionStart=function(){return this.qo},n.prototype.getRegionEnd=function(){return this.$o},n}(li),Kf=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(i){var r=this;n.prototype.init.call(this,i),this.state.isFocusable=!1;var e=new t.Point;this.bi=new Di({target:this,easing:!1,on:{start:function(){e.copyFrom(r.position)},move:function(t,n){e.set(e.x+t,e.y+n),r.onDragMove(e.x,e.y)}}})},i.prototype.getMinimumSize=function(){return this.theme.getMinimumSize()},i.prototype.getType=function(){return"DScrollBarThumb"},i}(li),Jf=function(t){function n(n){var i=t.call(this)||this;return n.addRenderable(i,!0),n.addReflowable(i),i}return y(n,t),n.prototype.onReflow=function(t,n,i){var r=t.state;this.clear();var e=t.background,u=e.getColor(r),s=e.getAlpha(r);null!=u?(this.beginFill(u,s),this.lineStyle(0,0,0,0),this.drawRect(0,.5*i-1,n,2),this.endFill(),this.visible=!0):this.visible=!1},n}(t.Graphics),Zf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onDragMove=function(t,n){this.emit("regionmove",t,this)},n.prototype.initReflowable=function(){new Jf(this)},n}(Kf),qf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on(ai.down,(function(t){if(t.target===i){var n=i.width;if(0<n){var r=i.$o-i.qo,e=t.data.getLocalPosition(i),u=Math.min(1-r,Math.max(0,e.x/n-.5*r));i.qo!==u&&i.emit("regionmove",u,i)}}})),this.Qo.on("regionmove",(function(t){var n=i.width;if(0<n){var r=i.$o-i.qo,e=Math.min(1-r,Math.max(0,t/n));i.qo!==e&&i.emit("regionmove",e,i)}}))},n.prototype.createThumb=function(t){return new Zf(t)},n.prototype.onRegionChange=function(){var n=this.Qo,i=this.width,r=this.height,e=Math.min(.5*i,n.getMinimumSize()),u=i-e,s=u*this.qo,h=u*this.$o+e-s;n.position.set(s,0),n.resize(h,r),t.prototype.onRegionChange.call(this)},n}(Yf),$f=function(t){function n(n){var i=t.call(this)||this;return n.addRenderable(i,!0),n.addReflowable(i),i}return y(n,t),n.prototype.onReflow=function(t,n,i){var r=t.state;this.clear();var e=t.background,u=e.getColor(r),s=e.getAlpha(r);null!=u?(this.beginFill(u,s),this.lineStyle(0,0,0,0),this.drawRect(.5*n-1,0,2,i),this.endFill(),this.visible=!0):this.visible=!1},n}(t.Graphics),Qf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onDragMove=function(t,n){this.emit("regionmove",n,this)},n.prototype.initReflowable=function(){new $f(this)},n}(Kf),tl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on(ai.down,(function(t){if(t.target===i){var n=i.height;if(0<n){var r=i.$o-i.qo,e=t.data.getLocalPosition(i),u=Math.min(1-r,Math.max(0,e.y/n-.5*r));i.qo!==u&&i.emit("regionmove",u,i)}t.stopPropagation()}})),this.Qo.on("regionmove",(function(t){var n=i.height;if(0<n){var r=i.$o-i.qo,e=Math.min(1-r,Math.max(0,t/n));i.qo!==e&&i.emit("regionmove",e,i)}}))},n.prototype.createThumb=function(t){return new Qf(t)},n.prototype.onRegionChange=function(){var n=this.Qo,i=this.width,r=this.height,e=Math.min(.5*r,n.getMinimumSize()),u=r-e,s=u*this.qo,h=u*this.$o+e-s;n.position.set(0,s),n.resize(i,h),t.prototype.onRegionChange.call(this)},n}(Yf),nl=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(t){n.prototype.init.call(this,t),this.Yi=null;var i=this.theme,r=this.Jo=this.toContent(t);(function(t,n){return n&&null!=n.mask?n.mask:t.isOverflowMaskEnabled()})(i,t)&&(this.mask=this.getOrCreateOverflowMask()),this.addChild(r),this.initScrollBar(r,i,t),this.initDrag(r,i,t)},i.prototype.initDrag=function(n,i,r){var e=this,u=r&&r.drag&&null!=r.drag.mode?mt(r.drag.mode)?bi[r.drag.mode]:r.drag.mode:i.getDragMode();if(u===bi.ON||u===bi.TOUCH){var s=new t.Point;this.bi=new Di({target:this,touch:u===bi.TOUCH,on:{start:function(){s.copyFrom(n.position)},move:function(t,i){s.set(s.x+t,s.y+i),n.position.set(e.toContentX(n,s.x),e.toContentY(n,s.y))}}})}},i.prototype.onRegionMoveX=function(t,n){var i=this.bi;null!=i&&i.stop(),t.x=-t.width*n},i.prototype.onRegionMoveY=function(t,n){var i=this.bi;null!=i&&i.stop(),t.y=-t.height*n},i.prototype.initScrollBar=function(t,n,i){var r=this,e=this.ta=new tl(function(t){return t&&t.bar&&t.bar.vertical}(i));e.on("regionmove",(function(n){r.onRegionMoveY(t,n)})),this.addChild(e);var u=this.na=new qf(function(t){return t&&t.bar&&t.bar.horizontal}(i));u.on("regionmove",(function(n){r.onRegionMoveX(t,n)})),this.addChild(u),t.on("move",(function(){r.onContentChanged()})),t.on("resize",(function(){r.onContentChanged()})),this.updateScrollBar()},i.prototype.getType=function(){return"DPane"},Object.defineProperty(i.prototype,"content",{get:function(){return this.Jo},enumerable:!1,configurable:!0}),i.prototype.toContent=function(t){if(t&&t.content){var n=t.content;return n instanceof li?n:this.newContent(n)}return this.newContent()},i.prototype.newContent=function(t){return new Xf(t)},i.prototype.getOrCreateOverflowMask=function(){return null==this.Yi&&(this.Yi=new vi(this),this.addReflowable(this.Yi),this.toDirty()),this.Yi},i.prototype.onWheel=function(t,n,i){var r=this.Jo,e=this.getWheelContentX(r,n.deltaX*n.lowest),u=this.getWheelContentY(r,n.deltaY*n.lowest);if(r.x!==e||r.y!==u){var s=this.bi;return null!=s&&s.stop(),r.position.set(e,u),!0}return!1},i.prototype.getWheelContentX=function(t,n){if(0<n||n<0){var i=this.theme.getWheelSpeed();return this.toContentX(t,t.x-n*i)}return t.x},i.prototype.getWheelContentY=function(t,n){if(0<n||n<0){var i=this.theme.getWheelSpeed();return this.toContentY(t,t.y+n*i)}return t.y},i.prototype.toContentX=function(t,n){return Math.min(0,Math.max(this.width-t.width,n))},i.prototype.toContentY=function(t,n){return Math.min(0,Math.max(this.height-t.height,n))},i.prototype.isRefitable=function(t){return n.prototype.isRefitable.call(this,t)&&!(t instanceof Yf)},i.prototype.onResize=function(t,i,r,e){n.prototype.onResize.call(this,t,i,r,e),this.updateScrollBar()},i.prototype.onContentChanged=function(){this.updateScrollBar()},i.prototype.updateScrollBar=function(){var t=this.ta,n=this.na;null!=t&&null!=n&&(this.updateScrollBarRegions(t,n),this.updateScrollBarVisibilities(t,n),this.updateScrollBarPositions(t,n))},i.prototype.getScrollBarOffsetHorizontalStart=function(t){return.5*t},i.prototype.getScrollBarOffsetHorizontalEnd=function(t){return.5*t},i.prototype.getScrollBarOffsetVerticalStart=function(t){return.5*t},i.prototype.getScrollBarOffsetVerticalEnd=function(t){return.5*t},i.prototype.updateScrollBarPositions=function(t,n){var i=this.width,r=this.height,e=t.width,u=this.getScrollBarOffsetVerticalStart(e),s=this.getScrollBarOffsetVerticalEnd(e);t.position.set(i-e,u),t.height=r-u-s;var h=n.height,o=this.getScrollBarOffsetHorizontalStart(h),a=this.getScrollBarOffsetHorizontalEnd(h);n.position.set(o,r-h),n.width=i-o-a},i.prototype.updateScrollBarRegions=function(t,n){var i=this.Jo,r=-i.x,e=-i.y;n.setRegion(r,r+this.width,i.width),t.setRegion(e,e+this.height,i.height)},i.prototype.updateScrollBarVisibilities=function(t,n){var i=this.updateScrollBarVisibility(n),r=this.updateScrollBarVisibility(t);if(i||r){var e,u=this.Yi;null!=u&&(n.visible||t.visible?(e=this.Jo).mask!==u&&(e.mask=u):(e=this.Jo).mask&&(e.mask=null)),B.update(this)}},i.prototype.updateScrollBarVisibility=function(t){var n=t.isRegionVisible();return t.visible!==n&&(t.visible=n,!0)},i.prototype.getFocusedChildClippingRect=function(t,n,i,r,e,u,s,h){return h.x=0,h.y=0,h.width=u,h.height=s,h},i.prototype.onChildFocused=function(r){var e=i.WORK_POINT=i.WORK_POINT||new t.Point,u=this.Jo,s=u.x,h=u.y,o=u.width,a=u.height;e.set(0,0),r.toGlobal(e,e,!1),u.toLocal(e,void 0,e,!1);var c=s+Math.min(o,Math.max(0,e.x)),f=h+Math.min(a,Math.max(0,e.y));e.set(r.width,r.height),r.toGlobal(e,e,!0),u.toLocal(e,void 0,e,!0);var l=s+Math.min(o,Math.max(0,e.x)),v=h+Math.min(a,Math.max(0,e.y)),b=this.width,g=this.height,d=i.WORK_RECTANGLE=i.WORK_RECTANGLE||new t.Rectangle;this.getFocusedChildClippingRect(r,s,h,o,a,b,g,d);var m=d.x,w=d.y,p=m,O=w,D=m+d.width,E=w+d.height,M=null;c<p?l<=D&&(M=s+Math.min(p-c,D-l),M=Math.max(b-o,Math.min(0,M))):D<l&&(M=s-Math.min(c-p,l-D),M=Math.max(b-o,Math.min(0,M)));var S=null;f<O?v<=E&&(S=h+Math.min(O-f,E-v),S=Math.max(g-a,Math.min(0,S))):E<v&&(S=h-Math.min(f-O,v-E),S=Math.max(g-a,Math.min(0,S)));var T=u.position;null!=M?null!=S?T.set(M,S):T.x=M:null!=S&&(T.y=S),n.prototype.onChildFocused.call(this,r)},i.prototype.destroy=function(){var t=this.Yi;null!=t&&(this.Yi=null,t.destroy()),this.mask=null,n.prototype.destroy.call(this)},i}(li),il=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=n&&n.selection;this.ia=r instanceof Wf?r:this.newSelection(r),ai.onClick(this,(function(t){var n=i.findItem(t.target);n instanceof li&&n.state.isActionable&&i.selection.add(n)}))},n.prototype.newSelection=function(t){return new Wf(this.Jo,t)},n.prototype.onChildrenDirty=function(){var n=this.ia;null!=n&&n.toDirty(),t.prototype.onChildrenDirty.call(this)},Object.defineProperty(n.prototype,"selection",{get:function(){return this.ia},enumerable:!1,configurable:!0}),n.prototype.findItem=function(t){for(var n=this.Jo,i=t;null!=i;){if(i.parent===n)return i;i=i.parent}return null},n.prototype.onRefit=function(){t.prototype.onRefit.call(this),this.updateChildPosition(),this.updateChildVisibility()},n.prototype.updateChildPosition=function(){for(var t=this.Jo,n=t.children,i=0,r=0,e=n.length;r<e;++r){var u=n[r];u instanceof li&&(u.y=i,i+=u.height)}var s=Math.min(0,-i+this.height);t.y<s&&(t.y=s),t.height=i},n.prototype.updateChildVisibility=function(){for(var t=this.Jo,n=t.children,i=-t.y,r=i+this.height,e=0,u=n.length;e<u;++e){var s=n[e];if(s instanceof li){var h=s.y;s.visible=i<=h+s.height&&h<=r}}},n.prototype.onContentChanged=function(){t.prototype.onContentChanged.call(this),this.updateChildVisibility()},n.prototype.onKeyDown=function(n){return pt.moveFocusVertically(n,this),t.prototype.onKeyDown.call(this,n)},n.prototype.getType=function(){return"DList"},n}(nl),rl=function(t){function n(n){var i=t.call(this,n)||this;return i.state.isFocusable=!1,i}return y(n,t),n.prototype.getType=function(){return"DDialogSelectList"},n}(il),el=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DDialogSelectListItem"},n}(Yo),ul=function(t){function n(n){var i=t.call(this)||this;return i.ra=n||function(t){return Promise.resolve([])},i.l=0,i.ea=0,i.ua=null,i}return y(n,t),n.prototype.create=function(t){var n=this,i=++this.l;this.ra(t[0]).then((function(t){n.l===i&&(n.ea=i,n.ua=t,n.emit("success",n,t),n.emit("change",n))}),(function(){n.l===i&&(n.ea=i,n.ua=null,n.emit("fail",n),n.emit("change",n))})),this.emit("change",this)},n.prototype.isDone=function(){return this.l===this.ea},n.prototype.getResult=function(){return this.ua},n}(t.utils.EventEmitter),sl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.visible=!1},n.prototype.getType=function(){return"DNote"},n}(Nr),hl=function(t,n,i){return null!=t?(null==t.parent&&(t.parent=n),null==t.text?t.text={value:i}:null==t.text.value&&(t.text.value=i),t):{parent:n,text:{value:i}}},ol=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(t,n){var i=this;this.gt=null;var r=this.theme;this.sa=function(t,n){if(n){var i=n.item;if(i){var r=i.text;if(r)return r.formatter||t.getItemTextFormatter()}}return t.getItemTextFormatter()}(r,n),this.ha=n&&n.item&&n.item.predefineds,this.Ne=new Yr({parent:t,width:"padding"});var e=this.oa=new rl({parent:t,width:"padding",selection:{on:{change:function(t){var n=t.first();null!=n&&(i.gt=n.value,i.onOk())}}}}),u=new sl(function(t,n,i){var r=n&&n.note;return hl(r&&r.noItems,i,t.getNoteNoItemsText())}(r,n,e));this.aa=u;var s=new sl(function(t,n,i){var r=n&&n.note;return hl(r&&r.noItems,i,t.getNoteSearchingText())}(r,n,e));this.ca=s;var h=function(t){if(t){var n=t.search;return"create"in n?n:new ul(n)}return new ul}(n&&n.controller);this.ra=h,this.Ne.on("input",(function(t){h.create([t])})),h.on("success",(function(t,n){i.onSearched(n)}));var o=new Vc;h.on("change",(function(){if(h.isDone()){var t=h.getResult();null!=t&&0<t.length?o.hide():o.show(u)}else o.show(s)}))},n.prototype.onSearched=function(t){for(var n=this.oa,i=this.sa,r=n.content,e=r.children,u=this.ha,s=e.length,h=t.length,o=u?u.length:0,a=o+h,c=Math.min(s,a),f=0;f<c;++f){var l=e[f],v=f<o?u[f]:t[f-o];if(l instanceof Yo)l.text=i(v,this),l.value=v;else{r.removeChildAt(f),l.destroy();var b=this.newItem(v,i(v,this));r.addChildAt(b,f)}}for(f=c;f<a;++f)v=f<o?u[f]:t[f-o],b=this.newItem(v,i(v,this)),r.addChild(b);for(f=s-1;c<=f;--f)e[f].destroy()},n.prototype.newItem=function(t,n){return new el({value:t,text:{value:n}})},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},enumerable:!1,configurable:!0}),n.prototype.doResolve=function(t){t(this.value)},n.prototype.getType=function(){return"DDialogSelect"},n.prototype.onOpen=function(){t.prototype.onOpen.call(this),this.oa.selection.clear(),this.ra.create([this.Ne.value])},n.prototype.onOk=function(){this.emit("select",this.gt,this),t.prototype.onOk.call(this)},n.prototype.destroy=function(){this.Ne.destroy(),this.aa.destroy(),this.ca.destroy(),this.oa.destroy(),t.prototype.destroy.call(this)},n}(jr),al=function(t){return t.value},cl=function(){},fl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,this.toOptions(n));var r=n&&n.getter||al,e=n&&n.setter||cl;this.on("active",(function(){var t=i.dialog;e(t,i.Xr),t.open().then((function(){var n=r(t),e=i.Xr;n!==e&&(i.text=n,i.emit("change",n,e,i))}))}))},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.Xo;if(null==t){var n=this.vn,i=n&&n.dialog;t=i&&"open"in i?i:new ol(i),this.Xo=t}return t},enumerable:!1,configurable:!0}),n.prototype.toOptions=function(t){var n,i,r;if(t){var e,u=null===(n=t.text)||void 0===n?void 0:n.formatter;if(void 0!==u){if(!(e=t.dialog)||!("open"in e)){var s=(e=e||{}).item=e.item||{};void 0===(h=s.text=s.text||{}).formatter&&(h.formatter=u)}}else if(!(e=t.dialog)||!("open"in e)){var h,o=null===(r=null===(i=null==e?void 0:e.item)||void 0===i?void 0:i.text)||void 0===r?void 0:r.formatter;void 0!==o&&void 0===(h=t.text=t.text||{}).formatter&&(h.formatter=o)}}return t},Object.defineProperty(n.prototype,"value",{get:function(){return this.Xr},set:function(t){this.text=t},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DButtonSelect"},n}(vr),ll=function(){function t(){}return t.getInstance=function(){return null==t.INSTANCE&&(t.INSTANCE=new pe),t.INSTANCE},t}(),vl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on("active",(function(){var t=i.Xr.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.text=new Date(t.getTime()),i.emit("change",t,r,i)}))}))},n.prototype.getDatetimeMask=function(){var t,n,i=this.Yo;return null==i&&(i=kf.toMask(null===(n=null===(t=this.vn)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.picker),this.Yo=i),i},Object.defineProperty(n.prototype,"dialog",{get:function(){var t,n=this.Xo;if(null==n){var i=null===(t=this.vn)||void 0===t?void 0:t.dialog;n=null!=i?new pe(i):ll.getInstance(),this.Xo=n}return n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.Xr},set:function(t){this.Xr.getTime()!==t.getTime()&&(this.text=t)},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DButtonTime"},n}(vr),bl=function(t){function n(n){var i=t.call(this,n)||this,r=ef.getCommandController();return i.state.isDisabled=!r.isUndoable(),r.on("change",(function(){i.state.isDisabled=!r.isUndoable()})),i.on("active",(function(){r.undo()})),i}return y(n,t),n}(vr),gl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DCanvas"},n}(li);!function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(Hf||(Hf={})),function(t){t[t.INSIDE=0]="INSIDE",t[t.OUTSIDE=1]="OUTSIDE"}(Vf||(Vf={}));var dl,ml=function(){function t(){}return t.from=function(t){if(mt(t))return r[t];if(F(t))return t;if(null!=t){for(var n=r.NONE,i=0,e=t.length;i<e;++i)n|=r[t[i]];return n}return r.NONE},t}(),wl=function(){function t(t,n){this.fa=n&&null!=n.coordinate?n.coordinate:0,this.u=this.toPosition(t,n),this.la=this.toTickContainer(t,n),this.je=this.toLabel(t,n),this.Mn=n&&null!=n.padding?n.padding:t.getPadding(),this.va=this.toBar(t,n)}return Object.defineProperty(t.prototype,"coordinateIndex",{get:function(){return this.fa},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.Mn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.u},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bar",{get:function(){return this.va},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tick",{get:function(){return this.la},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this.je},enumerable:!1,configurable:!0}),t.prototype.toPosition=function(t,n){var i=n&&n.position;return mt(i)?Hf[i]:null!=i?i:t.getPosition()},t.prototype.toBar=function(t,n){return{style:n&&null!=n.style?n.style:t.getStyle(),stroke:this.toBarStroke(t,n&&n.stroke),shape:void 0}},t.prototype.toTickContainer=function(t,n){var i=n&&n.tick;return{enable:i&&null!=i.enable?i.enable:t.getTickEnable(),major:this.toTickMajor(t,i),minor:this.toMinorTick(t,i)}},t.prototype.toTickMajor=function(t,n){var i=n&&n.major,r=i&&null!=i.position?i.position:n&&null!=n.position?n.position:t.getMajorTickPosition(),e=n&&n.style,u=ml.from(i&&null!=i.style?i.style:null!=e?e:t.getMajorTickStyle()),s=n&&n.stroke,h=this.toTickMajorStroke(t,i&&i.stroke,s);return{count:i&&null!=i.count?i.count:t.getMajorTickCount(),size:i&&null!=i.size?i.size:t.getMajorTickSize(),position:this.toTickPosition(r),style:u,stroke:h,text:this.toMajorTickText(t,i&&i.text),formatter:this.toMajorTickFormatter(t,i),shapes:void 0,gridline:this.toTickMajorGridline(t,i&&i.gridline,e,s)}},t.prototype.toTickMajorGridline=function(t,n,i,r){var e=ml.from(n&&null!=n.style?n.style:null!=i?i:t.getMajorTickGridlineStyle());return{enable:n&&null!=n.enable?n.enable:t.getMajorTickGridlineEnable(),style:e,stroke:this.toTickMajorGridlineStroke(t,n&&n.stroke,r),shapes:void 0}},t.prototype.toTickPosition=function(t){var n=this.u;if(t===Vf.OUTSIDE||"OUTSIDE"===t)switch(n){case Hf.TOP:return b.BOTTOM;case Hf.BOTTOM:return b.TOP;case Hf.LEFT:return b.RIGHT;case Hf.RIGHT:return b.LEFT;default:return b.TOP}else switch(n){case Hf.TOP:return b.TOP;case Hf.BOTTOM:return b.BOTTOM;case Hf.LEFT:return b.LEFT;case Hf.RIGHT:return b.RIGHT;default:return b.TOP}},t.prototype.toMinorTick=function(t,n){var i=n&&n.major,r=i&&null!=i.position?i.position:n&&null!=n.position?n.position:t.getMinorTickPosition(),e=ml.from(i&&null!=i.style?i.style:n&&null!=n.style?n.style:t.getMinorTickStyle());return{count:i&&null!=i.count?i.count:t.getMinorTickCount(),size:i&&null!=i.size?i.size:t.getMinorTickSize(),position:this.toTickPosition(r),style:e,stroke:this.toTickMinorStroke(t,i&&i.stroke,n&&n.stroke),shapes:void 0}},t.prototype.toBarStroke=function(t,n){return this.toStroke(n,void 0,t.getStrokeEnable(),t.getStrokeColor(),t.getStrokeAlpha(),t.getStrokeWidth(),t.getStrokeAlign(),t.getStrokeSide())},t.prototype.toTickMajorStroke=function(t,n,i){return this.toStroke(n,i,t.getMajorTickStrokeEnable(),t.getMajorTickStrokeColor(),t.getMajorTickStrokeAlpha(),t.getMajorTickStrokeWidth(),t.getMajorTickStrokeAlign(),t.getMajorTickStrokeSide())},t.prototype.toTickMajorGridlineStroke=function(t,n,i){return this.toStroke(n,i,t.getMajorTickGridlineStrokeEnable(),t.getMajorTickGridlineStrokeColor(),t.getMajorTickGridlineStrokeAlpha(),t.getMajorTickGridlineStrokeWidth(),t.getMajorTickGridlineStrokeAlign(),t.getMajorTickGridlineStrokeSide())},t.prototype.toTickMinorStroke=function(t,n,i){return this.toStroke(n,i,t.getMinorTickStrokeEnable(),t.getMinorTickStrokeColor(),t.getMinorTickStrokeAlpha(),t.getMinorTickStrokeWidth(),t.getMinorTickStrokeAlign(),t.getMinorTickStrokeSide())},t.prototype.toStroke=function(t,n,i,r,e,u,s,h){return t?n?{enable:null!=t.enable?t.enable:null!=n.enable?n.enable:i,color:null!=t.color?t.color:null!=n.color?n.color:r,alpha:null!=t.alpha?t.alpha:null!=n.alpha?n.alpha:e,width:null!=t.width?t.width:null!=n.width?n.width:u,align:null!=t.align?t.align:null!=n.align?n.align:s,side:null!=t.side?t.side:null!=n.side?n.side:h}:{enable:null!=t.enable?t.enable:i,color:null!=t.color?t.color:r,alpha:null!=t.alpha?t.alpha:e,width:null!=t.width?t.width:u,align:null!=t.align?t.align:s,side:null!=t.side?t.side:h}:n?{enable:null!=n.enable?n.enable:i,color:null!=n.color?n.color:r,alpha:null!=n.alpha?n.alpha:e,width:null!=n.width?n.width:u,align:null!=n.align?n.align:s,side:null!=n.side?n.side:h}:{enable:i,color:r,alpha:e,width:u,align:s,side:h}},t.prototype.toMajorTickFormatter=function(t,n){var i=n&&n.text;if(i){var r=i.format;if(null!=r)return yn.create(r);var e=i.formatter;if(e)return{format:e}}return yn.create(t.getMajorTickTextFormat())},t.prototype.toMajorTickText=function(t,n){return{format:(n=n||{}).format,color:this.toMajorTickTextColor(t,n.color),alpha:n.alpha,family:n.family,size:n.size,weight:n.weight,align:this.toMajorTickTextAlign(t,n.align),offset:this.toMajorTickTextOffset(t,n.offset),style:n.style,outline:this.toMajorTickTextOutline(t,n.outline),spacing:this.toMajorTickTextSpacing(t,n.spacing),direction:this.toTickMajorTextDirection(t,n.direction),padding:this.toMajorTickTextPadding(t,n.padding),clipping:n.clipping}},t.prototype.toMajorTickTextOutline=function(t,n){if(n)return{enable:n.enable,color:n.color,alpha:n.alpha,width:n.width}},t.prototype.toMajorTickTextAlign=function(t,n){var i=this.u;return n?{horizontal:null!=n.horizontal?n.horizontal:t.getMajorTickTextAlignHorizontal(i),vertical:null!=n.vertical?n.vertical:t.getMajorTickTextAlignVertical(i)}:{horizontal:t.getMajorTickTextAlignHorizontal(i),vertical:t.getMajorTickTextAlignVertical(i)}},t.prototype.toMajorTickTextOffset=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toMajorTickTextSpacing=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toMajorTickTextPadding=function(t,n){return{horizontal:n&&null!=n.horizontal?n.horizontal:t.getMajorTickTextPaddingHorizontal(),vertical:n&&null!=n.vertical?n.vertical:t.getMajorTickTextPaddingVertical()}},t.prototype.toTickMajorTextDirection=function(t,n){return null!=n?n:t.getMajorTickTextDirection()},t.prototype.toMajorTickTextColor=function(t,n){return null!=n?n:t.getMajorTickTextColor()},t.prototype.toLabel=function(t,n){var i=n&&n.label;if(i)return{value:i.value,color:this.toLabelColor(t,i.color),alpha:i.alpha,family:i.family,size:i.size,weight:i.weight,align:this.toLabelAlign(t,i.align),offset:this.toLabelOffset(t,i.offset),style:i.style,outline:this.toLabelOutline(t,i.outline),spacing:this.toLabelSpacing(t,i.spacing),direction:this.toLabelDirection(t,i.direction),padding:this.toLabelPadding(t,i.padding),clipping:i.clipping}},t.prototype.toLabelOutline=function(t,n){if(n)return{enable:n.enable,color:n.color,alpha:n.alpha,width:n.width}},t.prototype.toLabelAlign=function(t,n){var i=this.u;return n?{horizontal:null!=n.horizontal?n.horizontal:t.getLabelAlignHorizontal(i),vertical:null!=n.vertical?n.vertical:t.getLabelAlignVertical(i)}:{horizontal:t.getLabelAlignHorizontal(i),vertical:t.getLabelAlignVertical(i)}},t.prototype.toLabelOffset=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toLabelSpacing=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toLabelPadding=function(t,n){return{horizontal:n&&null!=n.horizontal?n.horizontal:t.getLabelPaddingHorizontal(),vertical:n&&null!=n.vertical?n.vertical:t.getLabelPaddingVertical()}},t.prototype.toLabelDirection=function(t,n){return null!=n?n:t.getLabelDirection()},t.prototype.toLabelColor=function(t,n){return null!=n?n:t.getLabelColor()},t}(),pl=function(){function t(t){var n=this.toTheme(t);this.yt=n,this.xs=0;var i=new wl(n,t);this.fa=i.coordinateIndex,this.Mn=i.padding,this.u=i.position;var r=i.tick;this.la=r,this.je=i.label,this.va=i.bar,this.ba=new Float64Array(3*r.major.count),this.ga=new Float64Array((r.major.count+1)*r.minor.count*3)}return Object.defineProperty(t.prototype,"position",{get:function(){return this.u},enumerable:!1,configurable:!0}),t.prototype.updateBar=function(t){var n=this.va.shape;if(n){var i=t.plotArea,r=i.width,e=i.height,u=this.Mn*this.xs;switch(n.disallowUploadedUpdate(),this.u){case Hf.TOP:n.transform.position.set(.5*r,0-u),n.size.set(r,0);break;case Hf.BOTTOM:n.transform.position.set(.5*r,e+u),n.size.set(r,0);break;case Hf.LEFT:n.transform.position.set(0-u,.5*e),n.size.set(0,e);break;case Hf.RIGHT:n.transform.position.set(r+u,.5*e),n.size.set(0,e)}n.allowUploadedUpdate()}},t.prototype.updateTicksX=function(t,n,i,r,e,u,s,h,o){var a=this.la,c=a.major.count,f=a.major.formatter,l=a.minor.count,v=(c+1)*l,b=this.ba,g=this.ga;i.ticks(t,n,c,l,v,b,g);for(var d=h.a,m=h.tx,w=0;w<c;++w){var p=r[w],O=3*w,D=b[O+0];if(Oe(D))p.visible=!1,u&&(u[w].visible=!1);else{var E=d*b[O+1]+m,M=b[O+2];if(p.disallowUploadedUpdate(),p.visible=!0,p.transform.position.set(E,s),p.text.value=f.format(D,M),p.allowUploadedUpdate(),u){var S=u[w];S.disallowUploadedUpdate(),S.visible=!0,S.transform.position.set(E,.5*o),S.size.set(0,o),S.allowUploadedUpdate()}}}for(w=0;w<v;++w){var T=e[w],j=3*w,N=g[j+0],I=g[j+1];Oe(N)?T.visible=!1:(T.disallowUploadedUpdate(),T.visible=!0,T.transform.position.set(d*I+m,s),T.allowUploadedUpdate())}},t.prototype.updateTicksY=function(t,n,i,r,e,u,s,h,o){var a=this.la,c=a.major.count,f=a.major.formatter,l=a.minor.count,v=(c+1)*l,b=this.ba,g=this.ga;i.ticks(t,n,c,l,v,b,g);for(var d=h.d,m=h.ty,w=0;w<c;++w){var p=r[w],O=3*w,D=b[O+0];if(Oe(D))p.visible=!1,u&&(u[w].visible=!1);else{var E=d*b[O+1]+m,M=b[O+2];if(p.disallowUploadedUpdate(),p.visible=!0,p.transform.position.set(s,E),p.text.value=f.format(D,M),p.allowUploadedUpdate(),u){var S=u[w];S.disallowUploadedUpdate(),S.visible=!0,S.transform.position.set(.5*o,E),S.size.set(o,0),S.allowUploadedUpdate()}}}for(w=0;w<v;++w){var T=e[w],j=3*w,N=g[j+0],I=g[j+1];Oe(N)?T.visible=!1:(T.disallowUploadedUpdate(),T.visible=!0,T.transform.position.set(s,d*I+m),T.allowUploadedUpdate())}},t.prototype.updateTicks=function(t){var n=this.la,i=n.major.shapes,r=n.minor.shapes;if(i&&r){var e=t.plotArea,u=e.getBoundsInContainer(),s=e.container.transform.localTransform,h=n.major.gridline.shapes,o=this.fa,a=this.Mn*this.xs,c=void 0;switch(this.u){case Hf.TOP:if(c=e.coordinate.x.get(o)){var f=c.unmap(c.transform.unmap(u.x)),l=c.unmap(c.transform.unmap(u.x+u.width)),v=e.height;this.updateTicksX(f,l,c,i,r,h,0-a,s,v)}break;case Hf.BOTTOM:(c=e.coordinate.x.get(o))&&(f=c.unmap(c.transform.unmap(u.x)),l=c.unmap(c.transform.unmap(u.x+u.width)),v=e.height,this.updateTicksX(f,l,c,i,r,h,v+a,s,v));break;case Hf.LEFT:if(c=e.coordinate.y.get(o)){f=c.unmap(c.transform.unmap(u.y)),l=c.unmap(c.transform.unmap(u.y+u.height));var b=e.width;this.updateTicksY(f,l,c,i,r,h,0-a,s,b)}break;case Hf.RIGHT:(c=e.coordinate.y.get(o))&&(f=c.unmap(c.transform.unmap(u.y)),l=c.unmap(c.transform.unmap(u.y+u.height)),b=e.width,this.updateTicksY(f,l,c,i,r,h,b+a,s,b))}}},t.prototype.bind=function(t,n){this.da=t,this.xs=n;var i=t.container,r=this.va,e=r.shape;if(!e){var u=(c=this.u)===Hf.LEFT||c===Hf.RIGHT?b.TOP:b.LEFT;(e=new ft(u,void 0,void 0,r.style)).stroke.copy(r.stroke),e.text.copy(this.je),this.va.shape=e}e.attach(t.container);var s=this.la,h=s.major,o=h.gridline,a=o.shapes;if(!a&&s.enable&&o.enable){a=[],o.shapes=a;for(var c,f=(c=this.u)===Hf.LEFT||c===Hf.RIGHT?b.LEFT:b.TOP,l=h.count,v=o.style,g=0;g<l;++g){var d=new ft(f,void 0,void 0,v);d.stroke.copy(o.stroke),a.push(d)}}if(a){g=0;for(var m=a.length;g<m;++g)a[g].attach(i)}var w=h.shapes;if(!w&&s.enable){w=[],h.shapes=w;var p=h.count,O=h.size,D=h.position,E=h.style;for(g=0;g<p;++g){var M=new ft(D,O,void 0,E);M.stroke.copy(h.stroke),M.text.copy(h.text),M.size.set(0,0),w.push(M)}}if(w)for(g=0,m=w.length;g<m;++g)w[g].attach(i);var S=s.minor,T=S.shapes;if(!T&&s.enable){T=[],S.shapes=T;var j=S.count,N=S.size,I=S.position,C=S.style;for(g=0,m=(h.count+1)*j;g<m;++g){var A=new ft(I,N,void 0,C);A.stroke.copy(S.stroke),A.size.set(0,0),T.push(A)}}if(T)for(g=0,m=T.length;g<m;++g)T[g].attach(i)},t.prototype.unbind=function(){var t=this.va.shape;t&&t.detach();var n=this.la,i=n.major.shapes;if(i)for(var r=0,e=i.length;r<e;++r)i[r].detach();var u=n.major.gridline.shapes;if(u)for(r=0,e=u.length;r<e;++r)u[r].detach();var s=n.minor.shapes;if(s)for(r=0,e=s.length;r<e;++r)s[r].detach();this.da=void 0},t.prototype.update=function(){var t=this.da;t&&(this.updateBar(t),this.updateTicks(t))},t.prototype.destroy=function(){var t=this.va.shape;t&&t.destroy();var n=this.la,i=n.major.shapes;if(i)for(var r=0,e=i.length;r<e;++r)i[r].destroy();var u=n.major.gridline.shapes;if(u)for(r=0,e=u.length;r<e;++r)u[r].destroy();var s=n.minor.shapes;if(s)for(r=0,e=s.length;r<e;++r)s[r].destroy();this.da=void 0},t.prototype.toTheme=function(t){return t&&t.theme||this.getThemeDefault()},t.prototype.getThemeDefault=function(){return Z.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartAxisBase"},t}(),Ol=function(){function t(t,n){this.ma=t,this.da=new uc,this.oa=new Map;var i=n&&n.list;if(i)for(var r=0,e=i.length;r<e;++r)this.add(i[r])}return Object.defineProperty(t.prototype,"container",{get:function(){return this.da},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this.ma},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var n=this.oa,i=n.get(t.position);null==i&&(i=[],n.set(t.position,i)),i.push(t),t.bind(this,i.length-1)},t.prototype.get=function(t,n){var i=this.oa.get(t);return i&&0<=n&&n<i.length?i[n]:null},t.prototype.indexOf=function(t){var n=this.oa.get(t.position);return n?n.indexOf(t):-1},t.prototype.clear=function(t){var n=this.oa.get(t);if(n){for(var i=0,r=n.length;i<r;++i)n[i].destroy();n.length=0}return this},t.prototype.size=function(t){var n=this.oa.get(t);return n?n.length:0},t.prototype.update=function(){this.oa.forEach((function(t){for(var n=0,i=t.length;n<i;++n)t[n].update()}))},t.prototype.destroy=function(){this.oa.forEach((function(t){for(var n=0,i=t.length;n<i;++n)t[n].destroy();t.length=0}))},t}(),Dl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DChartAxisX"},n}(pl),El=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DChartAxisXDatetime"},n}(Dl),Ml=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DChartAxisY"},n}(pl),Sl=[1095651,16667680,15778578,1858929],Tl=[Sl[0],W.brighten(Sl[0],.4),Sl[1],W.brighten(Sl[1],.4),Sl[2],W.brighten(Sl[2],.4),Sl[3],W.brighten(Sl[3],.4)],jl=function(t){return Tl[t%Tl.length]};!function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(dl||(dl={}));var Nl,Il=function(){function t(t,n){this.da=t,this.Nt=n,this.oa=[]}return Object.defineProperty(t.prototype,"container",{get:function(){return this.da},enumerable:!1,configurable:!0}),t.prototype.add=function(t,n){var i=this.oa;return null==n?i.push(t):0<=n&&n<i.length?i.splice(n,0,t):i.push(t),t.bind(this,this.Nt),this},t.prototype.get=function(t){var n=this.oa;return 0<=t&&t<n.length?n[t]:null},t.prototype.indexOf=function(t){return this.oa.indexOf(t)},t.prototype.remove=function(t){var n=this.oa;if(F(t)){if(0<=(r=t)&&r<n.length){var i=n.splice(r,1)[0];return i.unbind(),i}}else{var r,e=t;if(0<=(r=n.indexOf(e)))return n.splice(r,1),e.unbind(),e}return null},t.prototype.clear=function(){for(var t=this.oa,n=0,i=t.length;n<i;++n)t[n].unbind();return t.length=0,this},t.prototype.destroy=function(){return this.clear()},t.prototype.size=function(){return this.oa.length},t.prototype.fit=function(t,n){for(var i=this.oa,r=0,e=i.length;r<e;++r)i[r].fit(t,n);return this},t.prototype.mark=function(t,n){for(var i=this.oa,r=0,e=i.length;r<e;++r)i[r].mark(t,n);return this},t.prototype.blend=function(t){for(var n=this.oa,i=0,r=n.length;i<r;++i)n[i].blend(t);return this},t}(),Cl=function(){function t(t,n){this.ma=t;var i=this._x=new Il(this,dl.X),r=this._y=new Il(this,dl.Y);if(n){var e=n.x;if(e)if(wt(e))for(var u=0,s=e.length;u<s;++u)i.add(e[u]);else i.add(e);var h=n.y;if(h)if(wt(h))for(u=0,s=h.length;u<s;++u)r.add(h[u]);else r.add(h)}}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this.ma},enumerable:!1,configurable:!0}),t.prototype.fit=function(t,n,i,r){return this._x.fit(t,n),this._y.fit(i,r),this},t.prototype.mark=function(t,n,i,r){return this._x.mark(t,n),this._y.mark(i,r),this},t.prototype.blend=function(t){return this._x.blend(t),this._y.blend(t),this},t}(),Al=function(){function t(t){this.yt=t}return t.prototype.calcStepMajor=function(t,n,i){if(0<i){var r=Math.abs(n-t)/i,e=Math.floor(Math.log(r)/Math.LN10),u=Math.pow(10,e);return this.yt.toStepScale(r/u)*u}return-1},t.prototype.calcStepMinor=function(t,n){return 0<=t?t/(n+1):-1},t.prototype.calcTickMinorPositions=function(t,n,i,r,e,u,s){for(var h=0;h<n;h+=1){var o=i+(h+1)*t;r<=o&&o<=e&&(s[u++]=o)}},t.prototype.calculate=function(t,n,i,r,e,u,s,h){if(!(i<=0)){var o=h.transform,a=Math.min(t,n),c=Math.max(t,n),f=this.calcStepMajor(a,c,i);if(f<=0){u[0]=a,u[1]=o.map(h.map(a)),u[2]=0;for(var l=1;l<i;++l)u[0+(M=3*l)]=NaN,u[M+1]=NaN,u[M+2]=NaN;for(l=0;l<e;++l)s[0+(S=3*l)]=NaN,s[S+1]=NaN,s[S+2]=NaN}else{var v=Math.floor(a/f)-1,b=Math.ceil(c/f)+1,g=this.calcStepMinor(f,r),d=0,m=0;for(l=v;l<=b;++l){var w=l*f;if(d<i&&a<=w&&w<=c){var p=o.map(h.map(w));u[0+(M=3*d)]=w,u[M+1]=p,u[M+2]=f,d+=1}for(var O=0;O<r;O+=1)if(m<e){var D=w+(O+1)*g;if(a<=D&&D<=c){var E=o.map(h.map(D));s[0+(S=3*m)]=D,s[S+1]=E,s[S+2]=g,m+=1}}}for(l=d;l<i;++l){var M;u[0+(M=3*l)]=NaN,u[M+1]=NaN,u[M+2]=NaN}for(l=m;l<e;++l){var S;s[0+(S=3*l)]=NaN,s[S+1]=NaN,s[S+2]=NaN}}}},t}(),Rl=function(){function t(t){this.yt=t,this.l=0,this.wa=0,this.fn=1,this.pa=0,this.Oa=1}return Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"translate",{get:function(){return this.wa},set:function(t){this.set(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.fn},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.bind=function(t,n){this.set(0,n===dl.X?1:-1)},t.prototype.unbind=function(){},t.prototype.set=function(t,n){var i=!1;null!=t&&this.wa!==t&&(i=!0,this.wa=t),null!=n&&this.fn!==n&&(i=!0,this.fn=n),i&&(this.l+=1,this.Oa=this.yt.isZero(this.fn)?0:1/this.fn,this.pa=-this.wa*this.Oa)},t.prototype.blend=function(t,n){var i=1-t,r=n.newTranslate*t+n.oldTranslate*i,e=n.newScale*t+n.oldScale*i;this.set(r,e)},t.prototype.map=function(t){return this.wa+this.fn*t},t.prototype.mapAll=function(t,n,i,r,e){for(var u=this.wa,s=this.fn,h=n+e;h<i;h+=r)t[h]=u+s*t[h]},t.prototype.unmap=function(t){return this.pa+this.Oa*t},t.prototype.unmapAll=function(t,n,i,r,e){for(var u=this.pa,s=this.Oa,h=n+e;h<i;h+=r)t[h]=u+s*t[h]},t}(),yl=function(){function t(){this.oldTranslate=0,this.oldScale=1,this.newTranslate=0,this.newScale=1}return t.prototype.set=function(t,n){null!=t&&(this.newTranslate=t),null!=n&&(this.newScale=n)},t}(),kl=function(){function t(t,n){this.from=t,this.to=n}return t.prototype.set=function(t,n){return null!=t&&(this.from=t),null!=n&&(this.to=n),this},t.prototype.add=function(t,n){return Oe(t)||(this.from=Oe(this.from)?t:Math.min(this.from,t)),Oe(n)||(this.to=Oe(this.to)?n:Math.max(this.to,n)),this},t.prototype.clear=function(){return this.from=NaN,this.to=NaN,this},t}(),xl=function(){function t(t){this.l=0,this.Nt=dl.X;var n=this.toTheme(t);this.yt=n,this.Hi=new Rl(n),this.la=new Al(n),this.Ks=new kl(NaN,NaN),this.Da=new yl}return t.prototype.bind=function(t,n){this.da=t,this.Nt=n,this.Hi.bind(t,n)},t.prototype.unbind=function(){this.da=void 0,this.Hi.unbind()},t.prototype.fit=function(t,n){this.doFit(t,n,this.Hi)},t.prototype.mark=function(t,n){var i=this.Da,r=this.Hi;i.oldTranslate=r.translate,i.oldScale=r.scale,this.doFit(t,n,i)},t.prototype.blend=function(t){this.Hi.blend(t,this.Da)},t.prototype.doFit=function(t,n,i){var r=this.da;if(r){var e=r.container.plotArea,u=e.padding,s=this.Ks;switch(this.Nt){case dl.X:this.Ea(u.getLeft(),e.width-u.getRight(),this.toFitDomain(t,n,e,s),i);break;case dl.Y:this.Ea(e.height-u.getBottom(),u.getTop(),this.toFitRange(t,n,e,s),i)}}},t.prototype.toFitDomain=function(t,n,i,r){return null!=t&&null!=n||i.series.getDomain(this,r),r.set(t,n),r},t.prototype.toFitRange=function(t,n,i,r){return null!=t&&null!=n||i.series.getRange(this,r),r.set(t,n),r},t.prototype.Ea=function(t,n,i,r){var e=i.from,u=i.to;if(!Oe(e)&&!Oe(u)){var s,h=u-e,o=t-e*(s=this.yt.isZero(h)?n<t?-1:1:(n-t)/h);r.set(o,s)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return this.Hi},enumerable:!1,configurable:!0}),t.prototype.map=function(t){return t},t.prototype.mapAll=function(t,n,i,r,e){},t.prototype.unmap=function(t){return t},t.prototype.unmapAll=function(t,n,i,r,e){},t.prototype.ticks=function(t,n,i,r,e,u,s){this.la.calculate(t,n,i,r,e,u,s,this)},t.prototype.toTheme=function(t){return t&&t.theme||this.getThemeDefault()},t.prototype.getThemeDefault=function(){return Z.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinateLinear"},t}(),Ll=function(){function t(t){this.yt=t}return t.prototype.calcStepMajor=function(t,n,i){if(0<i){var r=Math.abs(n-t)/i,e=Math.floor(Math.log(r)/Math.LN10),u=Math.pow(10,e);return this.yt.toStepScale(r/u)*u}return-1},t.prototype.calcStepMinor=function(t,n){return 0<=t?t/(n+1):-1},t.prototype.calcTickMinorPositions=function(t,n,i,r,e,u,s){for(var h=0;h<n;h+=1){var o=i+(h+1)*t;r<=o&&o<=e&&(s[u++]=o)}},t.prototype.calculate=function(t,n,i,r,e,u,s,h){if(!(i<=0)){var o=h.transform,a=h.map(t),c=h.map(n),f=Math.min(a,c),l=Math.max(a,c),v=this.calcStepMajor(f,l,i);if(v<=0){var b=Math.min(t,n);u[0]=b,u[1]=o.map(h.map(b)),u[2]=0;for(var g=1;g<i;++g)u[0+(A=3*g)]=NaN,u[A+1]=NaN,u[A+2]=NaN;for(g=0;g<e;++g)s[0+(R=3*g)]=NaN,s[R+1]=NaN,s[R+2]=NaN}else{var d=Math.floor(f/v)-1,m=Math.ceil(l/v)+1,w=this.calcStepMinor(v,r),p=0,O=0;for(g=d;g<=m;++g){var D=g*v;if(p<i&&f<=D&&D<=l){var E=h.unmap(D),M=o.map(D),S=h.unmap(D-1);u[0+(A=3*p)]=E,u[A+1]=M,u[A+2]=S,p+=1}for(var T=0;T<r;T+=1)if(O<e){var j=D+(T+1)*w;if(f<=j&&j<=l){var N=h.unmap(j),I=o.map(j),C=h.unmap(j-1);s[0+(R=3*O)]=N,s[R+1]=I,s[R+2]=C,O+=1}}}for(g=p;g<i;++g){var A;u[0+(A=3*g)]=NaN,u[A+1]=NaN,u[A+2]=NaN}for(g=O;g<e;++g){var R;s[0+(R=3*g)]=NaN,s[R+1]=NaN,s[R+2]=NaN}}}},t}(),Bl=function(){function t(t){this.l=0,this.Nt=dl.X;var n=this.toTheme(t);this.yt=n,this.Hi=new Rl(n),this.la=new Ll(n),this.Ks=new kl(NaN,NaN),this.Da=new yl}return t.prototype.bind=function(t,n){this.da=t,this.Nt=n},t.prototype.unbind=function(){this.da=void 0},t.prototype.fit=function(t,n){this.doFit(t,n,this.Hi)},t.prototype.mark=function(t,n){var i=this.Da,r=this.Hi;i.oldTranslate=r.translate,i.oldScale=r.scale,this.doFit(t,n,i)},t.prototype.blend=function(t){this.Hi.blend(t,this.Da)},t.prototype.doFit=function(t,n,i){var r=this.da;if(r){var e=r.container.plotArea,u=e.padding,s=this.Ks;switch(this.Nt){case dl.X:this.Ea(u.getLeft(),e.width-u.getRight(),this.toFitDomain(t,n,e,s),i);break;case dl.Y:this.Ea(e.height-u.getBottom(),u.getTop(),this.toFitRange(t,n,e,s),i)}}},t.prototype.toFitDomain=function(t,n,i,r){return null!=t&&null!=n||i.series.getDomain(this,r),r.set(t,n),r},t.prototype.toFitRange=function(t,n,i,r){return null!=t&&null!=n||i.series.getRange(this,r),r.set(t,n),r},t.prototype.Ea=function(t,n,i,r){var e=i.from,u=i.to;if(!Oe(e)&&!Oe(u)){var s,h=this.map(e),o=this.map(u)-h,a=t-h*(s=this.yt.isZero(o)?n<t?-1:1:(n-t)/o);r.set(a,s)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return this.Hi},enumerable:!1,configurable:!0}),t.prototype.map=function(t){return Math.log(Math.max(0,t))/Math.LN10},t.prototype.mapAll=function(t,n,i,r,e){for(var u=1/Math.LN10,s=n+e;s<i;s+=r){var h=t[s];t[s]=Math.log(Math.max(0,h))*u}},t.prototype.unmap=function(t){return Math.pow(10,t)},t.prototype.unmapAll=function(t,n,i,r,e){for(var u=n+e;u<i;u+=r)t[u]=Math.pow(10,t[u])},t.prototype.ticks=function(t,n,i,r,e,u,s){this.la.calculate(t,n,i,r,e,u,s,this)},t.prototype.toTheme=function(t){return t&&t.theme||this.getThemeDefault()},t.prototype.getThemeDefault=function(){return Z.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinateLog"},t}(),_l=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DChartLegendItem"},n}(li),Pl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DChartLegend"},n}(li),Fl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DChartOverview"},n}(li),Ul=function(n){function i(i){var r=n.call(this)||this,e=r.transform;return r.u=new Yn(e.position,i),r.fn=new Yn(e.scale,i),r.Si=new t.Rectangle,r}return y(i,n),Object.defineProperty(i.prototype,"position",{get:function(){return this.u},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"scale",{get:function(){return this.fn},enumerable:!1,configurable:!0}),i.prototype.getBounds=function(t,i){return this._lastBoundsID=-1,n.prototype.getBounds.call(this,t,i)},i.prototype.calculateBounds=function(){var t=this._bounds,n=this.Ks,i=this.Si,r=this.transform.worldTransform,e=0,u=0,s=0,h=0,o=this.children;if(0<o.length)for(var a=!0,c=0,f=o.length;c<f;++c){var l=o[c];l.visible&&(l.getBoundsInternal(n,!1,i),a?(a=!1,e=i.x,s=i.y,u=i.x+i.width,h=i.y+i.height):(e=Math.min(e,i.x),s=Math.min(s,i.y),u=Math.max(u,i.x+i.width),h=Math.max(h,i.y+i.height)))}t.clear(),n.set(e,s),r.apply(n,n),t.addPoint(n),n.set(u,h),r.apply(n,n),t.addPoint(n)},i}(uc),zl=function(){function t(){this.shape=null,this.x=0,this.y=0,this.p0x=0,this.p0y=0,this.p1x=0,this.p1y=0,this.index=0,this.t=0,this.distance=0}return t.prototype.copyFrom=function(t){return this.shape=t.shape,this.x=t.x,this.y=t.y,this.p0x=t.p0x,this.p0y=t.p0y,this.p1x=t.p1x,this.p1y=t.p1y,this.index=t.index,this.t=t.t,this.distance=t.distance,this},t}(),Gl=function(){function t(t,n,i){this.enable=t,this.color=n,this.alpha=i}return t.from=function(n,i,r){return r?new t(null!=r.enable?r.enable:n.enable(i),null!=r.color?r.color:n.color(i),null!=r.alpha?r.alpha:n.alpha(i)):new t(n.enable(i),n.color(i),n.alpha(i))},t}(),Hl=function(){function t(){}return t.from=function(t,n){return wt(t)?function(n){return t[n%t.length]}:_n(t)?t:null!=t?function(){return t}:wt(n)?function(t){return n[t%n.length]}:_n(n)?n:function(){return n}},t}(),Vl=function(t){this.enable=Hl.from(t&&t.enable,!0),this.color=Hl.from(t&&t.color,jl),this.alpha=Hl.from(t&&t.alpha,q.FILL_ALPHA)},Wl=function(){function t(t,n){this.outer=t,this.inner=n}return t.from=function(n,i,r){return r?new t(null!=r.outer?r.outer:n.outer(i),null!=r.inner?r.inner:n.inner(i)):new t(n.outer(i),n.inner(i))},t}(),Xl=function(t){this.outer=Hl.from(t&&t.outer,.2),this.inner=Hl.from(t&&t.inner,.1)},Yl=function(){function t(t,n){this.x=t,this.y=n}return t.from=function(n,i,r,e,u){return r?new t(null!=r.x?r.x:null!=n.x?n.x(i):e,null!=r.y?r.y:null!=n.y?n.y(i):u):new t(null!=n.x?n.x(i):e,null!=n.y?n.y(i):u)},t}(),Kl=function(t){t&&(null!=t.x&&(this.x=Hl.from(t.x,0)),null!=t.y&&(this.y=Hl.from(t.y,0)))},Jl=function(){function t(t,n,i,r,e,u,s){this.enable=t,this.color=n,this.alpha=i,this.width=r,this.align=e,this.side=u,this.style=s}return t.from=function(n,i,r){return r?new t(null!=r.enable?r.enable:n.enable(i),null!=r.color?r.color:n.color(i),null!=r.alpha?r.alpha:n.alpha(i),null!=r.width?r.width:n.width(i),null!=r.align?r.align:n.align(i),null!=r.side?r.side:n.side(i),ml.from(null!=r.style?r.style:n.style(i))):new t(n.enable(i),n.color(i),n.alpha(i),n.width(i),n.align(i),n.side(i),ml.from(n.style(i)))},t}(),Zl=function(t){this.enable=Hl.from(t&&t.enable,!0),this.color=Hl.from(t&&t.color,jl),this.alpha=Hl.from(t&&t.alpha,q.STROKE_ALPHA),this.width=Hl.from(t&&t.width,q.STROKE_WIDTH),this.align=Hl.from(t&&t.width,q.STROKE_ALIGN),this.side=Hl.from(t&&t.side,Du.ALL),this.style=Hl.from(t&&t.style,r.NON_EXPANDING_WIDTH|r.NON_SHRINKING_WIDTH|r.NON_SCALING_DOT_AND_DASH)},ql=function(){function t(t,n){this.ma=t,this.Ma=new kl(NaN,NaN),this.Sa=new kl(NaN,NaN),this.ia=n&&n.selection||null,this.Sr=new Vl(n&&n.fill),this.ns=new Zl(n&&n.stroke),this.S=new Kl(n&&n.size),this.Lt=new Kl(n&&n.offset),this.Mn=new Xl(n&&n.padding),this.oa=[];var i=n&&n.list;if(i){var r=i.length;if(0<r){for(var e=0;e<r;++e)this.add(i[e]);this.update()}}}return t.prototype.newFill=function(t,n){return Gl.from(this.Sr,t,n)},t.prototype.newStroke=function(t,n){return Jl.from(this.ns,t,n)},t.prototype.newSize=function(t,n,i,r){return Yl.from(this.S,t,n,i,r)},t.prototype.newOffset=function(t,n,i,r){return Yl.from(this.Lt,t,n,i,r)},t.prototype.newPadding=function(t,n){return Wl.from(this.Mn,t,n)},Object.defineProperty(t.prototype,"plotArea",{get:function(){return this.ma},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this.ia},enumerable:!1,configurable:!0}),t.prototype.update=function(){for(var t=this.oa,n=0,i=t.length;n<i;++n)t[n].update();var r=this.ia;r&&r.update()},t.prototype.add=function(t){var n=this.oa;t.bind(this,n.length),n.push(t)},t.prototype.get=function(t){var n=this.oa;return 0<=t&&t<n.length?n[t]:null},t.prototype.indexOf=function(t){return this.oa.indexOf(t)},t.prototype.clear=function(){for(var t=this.oa,n=0,i=t.length;n<i;++n)t[n].destroy();return t.length=0,this},t.prototype.size=function(){return this.oa.length},t.prototype.destroy=function(){this.clear();var t=this.ia;t&&t.unbind()},t.prototype.getDomain=function(t,n){n.clear();for(var i=this.oa,r=0,e=i.length;r<e;++r){var u=i[r];if(u.coordinate.x===t){var s=u.domain;n.add(s.from,s.to)}}return n},t.prototype.getRange=function(t,n){n.clear();for(var i=this.oa,r=0,e=i.length;r<e;++r){var u=i[r];if(u.coordinate.y===t){var s=u.range;n.add(s.from,s.to)}}return n},Object.defineProperty(t.prototype,"domain",{get:function(){var t=this.Ma;t.clear();for(var n=this.oa,i=0,r=n.length;i<r;++i){var e=n[i].domain;t.add(e.from,e.to)}return t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){var t=this.Sa;t.clear();for(var n=this.oa,i=0,r=n.length;i<r;++i){var e=n[i].range;t.add(e.from,e.to)}return t},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(t){for(var n=this.oa,i=n.length-1;0<=i;--i){var r=n[i];if(r.hitTest(t))return r}return null},t.prototype.calcHitPoint=function(n,i){var r=i,e=t.WORK_CALCHITPOINT,u=this.oa,s=null;e.distance=1/0;for(var h=u.length-1;0<=h;--h){var o=u[h];if(o.calcHitPoint(n,r)&&r.distance<e.distance){s=o;var a=r;r=e,e=a}}return s&&e!==i&&i.copyFrom(e),s},t.WORK_CALCHITPOINT=new zl,t}(),$l=function(n){function i(t,i){var r=n.call(this,i)||this;return r.Ta=t,r.ja=0,r.Na=1e3,r.Ia=null,r.Ca=function(){r.onBlend()},r}return y(i,n),i.prototype.init=function(i){var r=this;n.prototype.init.call(this,i);var e=new Ul((function(){r.Aa=!0,r.Ra=!0,B.update(r)}));this.da=e,this.ya=new Cl(this,i&&i.coordinate);var u=new ql(this,i&&i.series);this.ka=u;var s=new Ol(this,i&&i.axis);this.xa=s,this.Aa=!0,this.Ra=!0,this.La=new t.Rectangle,this.Le=new t.Point,this.addChild(e),this.addChild(s.container),this.Wi=new Si(this,(function(){return e}),i&&i.view);var h=u.selection;h&&h.bind(u),this.Yi=null;var o=i&&i.mask;(null!=o?o:this.theme.isOverflowMaskEnabled())&&(e.mask=this.getOrCreateOverflowMask())},i.prototype.onResize=function(t,i,r,e){this.Aa=!0,this.Ra=!0,n.prototype.onResize.call(this,t,i,r,e)},i.prototype.getOrCreateOverflowMask=function(){return null==this.Yi&&(this.Yi=new vi(this),this.addReflowable(this.Yi),this.toDirty()),this.Yi},Object.defineProperty(i.prototype,"coordinate",{get:function(){return this.ya},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"chart",{get:function(){return this.Ta},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"series",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"container",{get:function(){return this.da},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"axis",{get:function(){return this.xa},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"view",{get:function(){return this.Wi},enumerable:!1,configurable:!0}),i.prototype.onWheel=function(t,i,r){var e=this.Wi.onWheel(t,i,r),u=n.prototype.onWheel.call(this,t,i,r);return e||u},i.prototype.onDblClick=function(t,i){var r=this.Wi.onDblClick(t,i),e=n.prototype.onDblClick.call(this,t,i);return r||e},i.prototype.onDown=function(t){this.Wi.onDown(t),n.prototype.onDown.call(this,t)},i.prototype.render=function(t){if(this.Aa){this.Aa=!1,this.xa.update();var i=this.ka.selection;i&&i.update()}n.prototype.render.call(this,t)},i.prototype.destroy=function(){this.da.destroy(),this.ka.destroy(),this.xa.destroy()},i.prototype.getType=function(){return"DChartPlotArea"},i.prototype.getBoundsInContainer=function(){var t=this.La;if(this.Ra){this.Ra=!1;var n=this.container;n.updateTransform();var i=n.transform.localTransform,r=this.Le;r.set(0,0),i.applyInverse(r,r),t.x=r.x,t.y=r.y,r.set(this.width,this.height),i.applyInverse(r,r),t.width=r.x-t.x,t.height=r.y-t.y}return t},i.prototype.fit=function(t,n,i,r,e){var u=this.ya,s=this.xa,h=this.ka;if(null!=t&&t<=0)u.fit(n,i,r,e),s.update(),h.update();else{this.Na=null!=t?t:200,this.ja=Date.now(),u.mark(n,i,r,e);var o=this.Ia;null!=o&&window.clearTimeout(o),this.Ia=window.setTimeout(this.Ca,0)}return this},i.prototype.onBlend=function(){var t=(Date.now()-this.ja)/this.Na;t<1?this.Ia=window.setTimeout(this.Ca,0):(this.Ia=null,t=1),this.ya.blend(mi.ELASTIC(t)),this.xa.update(),this.ka.update()},i}(li),Ql=function(){function t(t,n,i){this.lt=t,this.vt=n,this.L=i}return Object.defineProperty(t.prototype,"from",{get:function(){return this.lt},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.vt},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n){var i=!1;return null!=t&&this.lt!==t&&(Oe(this.lt)&&Oe(t)||(this.lt=t,i=!0)),null!=n&&this.vt!==n&&(Oe(this.vt)&&Oe(n)||(this.vt=n,i=!0)),i&&this.L(),this},t.prototype.add=function(t,n){var i,r;return Oe(t)||(i=Oe(this.from)?t:Math.min(this.from,t)),Oe(n)||(r=Oe(this.to)?n:Math.max(this.to,n)),this.set(i,r)},t.prototype.clear=function(){return this.set(NaN,NaN)},t}(),tv=function(){function t(t,n){this.o=t,this.Ba=n&&null!=n.x?n.x:0,this.Pa=n&&null!=n.y?n.y:0,this.Fa=NaN,this.Ua=NaN,this.za=NaN,this.Ga=NaN}return Object.defineProperty(t.prototype,"x",{get:function(){var t=this.o.container;return t?t.plotArea.coordinate.x.get(this.Ba):null},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){var t=this.o.container;return t?t.plotArea.coordinate.y.get(this.Pa):null},enumerable:!1,configurable:!0}),t.prototype.isDirty=function(t,n){var i=t.id,r=n.id,e=i!==this.Fa,u=r!==this.Ua;return this.Fa=i,this.Ua=r,e||u},t.prototype.isTransformDirty=function(t,n){var i=t.transform.id,r=n.transform.id,e=i!==this.za,u=r!==this.Ga;return this.za=i,this.Ga=r,e||u},t.prototype.reset=function(){this.Fa=NaN,this.Ua=NaN},t.prototype.destroy=function(){this.reset()},t}(),nv=function(t){function n(n){var i=t.call(this)||this;if(i.ya=new tv(i,n&&n.coordinate),i.xs=0,i.Ma=new kl(NaN,NaN),i.Sa=new kl(NaN,NaN),i.Ha=NaN,i.Z=new U((function(t,n){i.onStateChange(t,n)})),n){var r=n.on;if(null!=r)for(var e in r){var u=r[e];u&&i.on(e,u)}}return i}return y(n,t),n.prototype.bind=function(t,n){this.da=t,this.ya.reset(),this.xs=n;var i=t.plotArea.chart;i&&this.state.update(i.state)},n.prototype.unbind=function(){this.da=void 0},Object.defineProperty(n.prototype,"domain",{get:function(){return this.updateRegion(),this.Ma},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"range",{get:function(){return this.updateRegion(),this.Sa},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"container",{get:function(){return this.da||null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"index",{get:function(){return this.xs},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"coordinate",{get:function(){return this.ya},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"state",{get:function(){return this.Z},enumerable:!1,configurable:!0}),n.prototype.destroy=function(){this.da=void 0,this.ya.destroy()},n.prototype.hitTest=function(t){return!1},n.prototype.calcHitPoint=function(t,n){return!1},n.prototype.onStateChange=function(t,n){this.toDirty();var i=this.da,r=i&&i.plotArea.chart;B.update(r),this.emit("statechange",t,n,this)},n}(t.utils.EventEmitter),iv=function(n){function i(t){var i=n.call(this,t)||this;return i.Va=null,i.vn=t,i.tt=t&&t.points||[],i.Wa=0,i.Xa=NaN,i}return y(i,n),i.prototype.getSizeDefault=function(){return 10},i.prototype.getOffsetDefault=function(){return 0},i.prototype.bind=function(t,i){var r=this.Va;if(!r){r=this.Va=this.newLineOfAny();var e=this.vn;this.initLine(r,e,t,i)}r.attach(t.plotArea.container,i),this.Xa=NaN,n.prototype.bind.call(this,t,i)},i.prototype.initLine=function(t,n,i,r){var e=i.newFill(r,n&&n.fill);this.Sr=e,t.fill.copy(e);var u=i.newStroke(r,n&&n.stroke);this.ns=u,t.stroke.copy(u);var s=this.getSizeDefault(),h=i.newSize(r,n&&n.size,s,s);this.S=h,t.points.size.set(h.x,h.y);var o=this.getOffsetDefault(),a=i.newOffset(r,n&&n.offset,o,o);this.Lt=a,t.points.offset.set(a.x,a.y)},i.prototype.unbind=function(){var t=this.Va;t&&t.detach(),n.prototype.unbind.call(this)},Object.defineProperty(i.prototype,"shape",{get:function(){return this.Va},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},set:function(t){this.tt=t,this.Wa+=1},enumerable:!1,configurable:!0}),i.prototype.toDirty=function(){this.Wa+=1},i.prototype.update=function(){var t=this.Va;if(t){var n=this.ya,i=n.x,r=n.y;if(i&&r){var e=this.Wa,u=e!==this.Xa,s=n.isDirty(i,r),h=n.isTransformDirty(i,r);(u||s||h)&&(this.Xa=e,this.updateLine(t,i,r))}}},i.prototype.updateLine=function(t,n,r){for(var e=t.points.values,u=e.length,s=0,h=this.tt,o=NaN,a=NaN,c=NaN,f=NaN,l=0,v=h.length;l<v;l+=2){var b=h[l],g=h[l+1];null!=b&&null!=g&&(s<u?(e[s]=b,e[s+1]=g):e.push(b,g),s+=2,o!=o?(o=b,a=b,c=g,f=g):(o=Math.min(o,b),a=Math.max(a,b),c=Math.min(c,g),f=Math.max(f,g)))}e.length!==s&&(e.length=s),n.mapAll(e,0,s,2,0),r.mapAll(e,0,s,2,1),n.transform.mapAll(e,0,s,2,0),r.transform.mapAll(e,0,s,2,1),o!=o&&(o=0,a=0,c=0,f=0);var d=this.adjustLineRegion(o,a,c,f,i.WORK_REGION||{xmin:0,xmax:0,ymin:0,ymax:0});o=n.transform.map(n.map(d.xmin)),a=n.transform.map(n.map(d.xmax)),c=r.transform.map(r.map(d.ymin)),f=r.transform.map(r.map(d.ymax));var m=Math.abs(a-o),w=Math.abs(f-c),p=.5*(o+a),O=.5*(c+f);for(l=0,v=e.length;l<v;l+=2)e[l+0]-=p,e[l+1]-=O;t.disallowUploadedUpdate(),this.applyLine(t,n,r,m,w,p,O,e),t.allowUploadedUpdate(),B.update(t)},i.prototype.adjustLineRegion=function(t,n,i,r,e){return e.xmin=t,e.xmax=n,e.ymin=i,e.ymax=r,e},i.prototype.applyLine=function(t,n,i,r,e,u,s,h){t.points.set(h),t.size.set(r,e),t.transform.position.set(u,s)},i.prototype.updateRegion=function(){var t=this.Wa;if(this.Ha!==t){this.Ha=t;var n=this.tt,i=this.Ma,r=this.Sa;i.clear(),r.clear(),this.calcRegion(n,i,r)}},i.prototype.calcRegion=function(t,n,i){for(var r=0,e=t.length;r<e;r+=2){var u=t[r];null!=u&&n.add(u,u);var s=t[r+1];null!=s&&i.add(s,s)}},i.prototype.destroy=function(){var t=this.Va;t&&(this.Va=null,t.detach(),t.destroy()),this.tt.length=0,this.Wa=0,this.Xa=NaN,n.prototype.destroy.call(this)},i.prototype.hitTest=function(t){var n=this.Va;if(n){var r=i.WORK,e=n.toLocal(t,void 0,r);return null!=n.contains(e)}return!1},i.prototype.calcHitPoint=function(t,n){var r=this.Va;if(r){var e=i.WORK,u=r.toLocal(t,void 0,e);return n.shape=r,r.calcHitPoint(u,null,this.calcHitPointTestRange,this.calcHitPointHitTester,n)}return!1},i.prototype.calcHitPointTestRange=function(t,n,i,r,e,u,s,h,o){for(var a=jc(h,t+i+e,2,0),c=0,f=a-1,l=f<<1;0<=f;f-=1,l-=2)if(h[l]<=t-i){c=f;break}return o[0]=c,o[1]=c!==a?a:Math.min(h.length<<1,a+1),o},i.prototype.calcHitPointHitTester=function(t,n,i,r,e,u,s,h,o,a,c){var f=c.shape;if(f.containsPointAbs(t,n,i,r,e,u,s,h)){var l=f.transform,v=l.position,b=l.scale;c.x=c.p0x=c.p1x=v.x+b.x*s,c.y=c.p0y=c.p1y=v.y+b.y*h,c.t=a,c.index=o;var g=t-(s+e),d=n-(h+u);return c.distance=Math.sqrt(g*g+d*d),!0}return!1},i.WORK=new t.Point,i}(nv),rv=function(t){function n(n){var i=t.call(this,n)||this;return i.Ya=-1,i.Ka=-1,i.Ja=-1,i.Za=-1,i.qa=!1!==(n&&n.size&&n.size.auto),i}return y(n,t),n.prototype.bind=function(n,i){this.Ya=-1,this.Ka=-1,this.Ja=-1,this.Za=-1,t.prototype.bind.call(this,n,i)},n.prototype.initLine=function(n,i,r,e){t.prototype.initLine.call(this,n,i,r,e),this.Mn=r.newPadding(e,i&&i.padding)},n.prototype.newLineOfAny=function(){return new Kh},n.prototype.getSizeDefault=function(){return 1},n.prototype.adjustLineRegion=function(n,i,r,e,u){return t.prototype.adjustLineRegion.call(this,n,i,Math.min(0,r),Math.max(0,e),u)},n.prototype.updateBarCountAndIndex=function(){if(this.Ka<0||this.Ya<0){var t=0,i=0,r=this.da;if(r)for(var e=0,u=r.size();e<u;++e){var s=r.get(e);s===this&&(t=i),s instanceof n&&(i+=1)}return i=Math.max(1,i),this.Ya=i,this.Ka=t,!0}return!1},n.prototype.applyLine=function(n,i,r,e,u,s,h,o){var a=this.S,c=this.Lt,f=this.Mn;if(a&&c&&f){var l=i.id,v=i.transform.id;if(this.updateBarCountAndIndex()||this.Ja!==l||this.Za!==v){var b=this.Ya,g=this.Ka;this.Ja=l,this.Za=v;var d=Math.abs(i.transform.map(i.map(0))-i.transform.map(i.map(a.x)))*(1-f.outer);if(b<=1)n.points.offset.x=c.x,n.points.size.x=d;else{var m=d*(1-f.inner),w=m/b,p=w*(g+.5)+g*((d-m)/(b-1));n.points.offset.x=c.x+p-.5*d,n.points.size.x=w}}}var O=n.points.size.y;wt(O)||(O=[]);var D=O.length,E=n.points.offset.y;wt(E)||(E=[]);for(var M=E.length,S=0,T=r.transform.map(r.map(0))-h,j=0,N=o.length;j<N;j+=2,S+=1){var I=o[j+1]-T,C=Math.abs(I);S<D?O[S]=C:O.push(C);var A=-.5*I;S<M?E[S]=A:E.push(A)}O.length!==S&&(O.length=S),E.length!==S&&(E.length=S),n.points.size.y=O,n.points.offset.y=E,t.prototype.applyLine.call(this,n,i,r,e,u,s,h,o)},n.prototype.calcSizeX=function(t){var n=this.tt;if(2<n.length)for(var i=n.length,r=n[i-2],e=i-4;0<=e;e-=2){var u=n[e];if(null!=r&&null!=u)return Math.abs(r-u);r=u}return t},n.prototype.calcRegion=function(n,i,r){t.prototype.calcRegion.call(this,n,i,r);var e=this.S;if(e){var u=e.x;this.qa&&(u=this.calcSizeX(u),e.x=u);var s=.5*u;i.set(i.from-s,i.to+s)}r.add(0,0)},n}(iv),ev=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newLineOfAny=function(){return new Ch},n}(iv),uv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newLineOfAny=function(){return new Hh},n}(iv),sv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newLineOfAny=function(){return new Kh},n}(iv),hv=function(t){function n(n){var i=t.call(this,n)||this;return i.$a=0,i}return y(n,t),n.prototype.newLineOfAny=function(){return new Mo},n.prototype.applyLine=function(n,i,r,e,u,s,h,o){var a=this.S,c=this.Lt;a&&c&&this.$a!==a.y&&(this.$a=a.y,n.points.offset.y=c.y-.2*a.y),t.prototype.applyLine.call(this,n,i,r,e,u,s,h,o)},n}(iv),ov=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.newLineOfAny=function(){return new co},n}(hv),av=function(n){function i(t){var i=n.call(this,t)||this;return i.Va=null,i.vn=t,i.tt=t&&t.points||[],i.Wa=0,i.Xa=NaN,i.Qa=0,i.tc=0,i}return y(i,n),i.prototype.bind=function(t,i){var r,e=this.Va;if(!e){var u=this.ns=t.newStroke(i,null===(r=this.vn)||void 0===r?void 0:r.stroke);(e=this.Va=new eh([],[],u.width,u.style)).stroke.copy(u)}e.attach(t.plotArea.container,i),this.Xa=NaN,n.prototype.bind.call(this,t,i)},i.prototype.unbind=function(){var t=this.Va;t&&t.detach(),n.prototype.unbind.call(this)},Object.defineProperty(i.prototype,"shape",{get:function(){return this.Va},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"points",{get:function(){return this.tt},set:function(t){this.tt=t,this.Wa+=1},enumerable:!1,configurable:!0}),i.prototype.toDirty=function(){this.Wa+=1},i.prototype.update=function(){var t=this.Va;if(t){var n=this.ya,i=n.x,r=n.y;if(i&&r){var e=this.Wa,u=e!==this.Xa,s=n.isDirty(i,r),h=n.isTransformDirty(i,r);(u||s||h)&&(this.Xa=e,this.updateLine(t,i,r,u||s))}}},i.prototype.updateLine=function(t,n,i,r){if(t.disallowUploadedUpdate(),r){for(var e=t.points.values,u=t.points.segments,s=e.length,h=u.length,o=0,a=0,c=this.tt,f=NaN,l=NaN,v=NaN,b=NaN,g=0,d=c.length;g<d;g+=2){var m=c[g],w=c[g+1];if(null!=m&&null!=w)o<s?(e[o]=m,e[o+1]=w):e.push(m,w),o+=2,f!=f?(f=m,l=m,v=w,b=w):(f=Math.min(f,m),l=Math.max(l,m),v=Math.min(v,w),b=Math.max(b,w));else{var p=(g>>1)-a;a<h?u[a]=p:u.push(p),a+=1}}e.length!==o&&(e.length=o),u.length!==a&&(u.length=a),n.mapAll(e,0,o,2,0),i.mapAll(e,0,o,2,1),f!=f&&(f=0,l=0,v=0,b=0),f=n.map(f),l=n.map(l),v=i.map(v),b=i.map(b);var O=Math.abs(l-f),D=Math.abs(b-v),E=.5*(f+l),M=.5*(v+b);for(g=0,d=e.length;g<d;g+=2)e[g+0]-=E,e[g+1]-=M;t.size.set(O,D),t.points.set(e,u),this.Qa=E,this.tc=M}t.transform.position.set(n.transform.map(this.Qa),i.transform.map(this.tc)),t.transform.scale.set(n.transform.scale,i.transform.scale),t.allowUploadedUpdate(),B.update(t)},i.prototype.updateRegion=function(){var t=this.Wa;if(this.Ha!==t){this.Ha=t;var n=this.tt,i=this.Ma,r=this.Sa;if(i.clear(),r.clear(),null!=n)for(var e=0,u=n.length;e<u;e+=2){var s=n[e];null!=s&&i.add(s,s);var h=n[e+1];null!=h&&r.add(h,h)}}},i.prototype.destroy=function(){var t=this.Va;t&&(this.Va=null,t.detach(),t.destroy()),this.tt.length=0,this.Wa=0,this.Xa=NaN,n.prototype.destroy.call(this)},i.prototype.hitTest=function(t){var n=this.Va;if(n){var r=i.WORK,e=n.toLocal(t,void 0,r);return null!=n.contains(e)}return!1},i.prototype.calcHitPoint=function(t,n){var r=this.Va;if(r){var e=i.WORK,u=r.toLocal(t,void 0,e);return n.shape=r,r.calcHitPoint(u,this.toThreshold,this.calcHitPointTestRange,this.calcHitPointHitTester,n)}return!1},i.prototype.toThreshold=function(t,n){return 1/0},i.prototype.calcHitPointTestRange=function(t,n,i,r,e){var u=jc(r,t,2,0);return e[0]=Math.max(0,u-1),e[1]=u,e},i.prototype.calcHitPointHitTester=function(t,n,i,r,e,u,s,h,o){if(i<=t&&t<e){var a=e-i;if(1e-4<Math.abs(a)){var c=(t-i)/a,f=t,l=r+c*(u-r),v=Math.abs(l-n);if(v<h){var b=o.shape.transform,g=b.position,d=g.x,m=g.y,w=b.scale,p=w.x,O=w.y;return o.x=d+p*f,o.y=m+O*l,o.p0x=d+p*i,o.p0y=m+O*r,o.p1x=d+p*e,o.p1y=m+O*u,o.t=c,o.index=s,o.distance=v,!0}}}return!1},i.WORK=new t.Point,i}(nv),cv=function(){function t(t,n,i,r){this.l=0,this.nc=NaN,this._a=t,this._b=n,this._x0=i,this._y0=r}return Object.defineProperty(t.prototype,"a",{get:function(){return this._a},set:function(t){this._a!==t&&(this.l+=1,this._a=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this._b},set:function(t){this._b!==t&&(this.l+=1,this._b=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x0",{get:function(){return this._x0},set:function(t){this._x0!==t&&(this.l+=1,this._x0=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y0",{get:function(){return this._y0},set:function(t){this._y0!==t&&(this.l+=1,this._y0=t)},enumerable:!1,configurable:!0}),t.prototype.toDirty=function(){this.l+=1},t.prototype.isDirty=function(){return this.l!==this.nc},t.prototype.toClean=function(){this.nc=this.l},t.from=function(n){return n?new t(null!=n.a?n.a:1,null!=n.b?n.b:1,null!=n.x0?n.x0:0,null!=n.y0?n.y0:0):new t(1,1,0,0)},t}(),fv=function(n){function i(t){var i=n.call(this,t)||this;return i.Va=null,i.vn=t,i.ic=NaN,i.rc=NaN,i.ec=cv.from(t),i}return y(i,n),i.prototype.bind=function(t,i){var r,e=this.Va;if(!e){var u=this.ns=t.newStroke(i,null===(r=this.vn)||void 0===r?void 0:r.stroke);(e=this.Va=new eh([],[],u.width,u.style)).stroke.color=u.color,e.stroke.alpha=u.alpha}e.attach(t.plotArea.container,i),this.ec.toDirty(),this.ic=NaN,this.rc=NaN,n.prototype.bind.call(this,t,i)},i.prototype.unbind=function(){var t=this.Va;t&&t.detach(),n.prototype.unbind.call(this)},Object.defineProperty(i.prototype,"shape",{get:function(){return this.Va},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"parameters",{get:function(){return this.ec},enumerable:!1,configurable:!0}),i.prototype.toDirty=function(){this.ec.toDirty()},i.prototype.update=function(){var t=this.Va,n=this.da;if(t&&n){var i=n.plotArea,r=this.ya,e=r.x,u=r.y;if(e&&u){var s=i.width,h=i.height,o=this.ec,a=o.isDirty(),c=r.isDirty(e,u),f=r.isTransformDirty(e,u),l=s!==this.ic||h!==this.rc;(a||c||f||l)&&(o.toClean(),this.ic=s,this.rc=h,this.updateLine(t,e,u,s,h))}}},i.prototype.updateLine=function(t,n,i,r,e){var u=t.points.values,s=t.points.segments,h=this.ec,o=h.a,a=h.b,c=h.x0,f=h.y0,l=Math.abs(o),v=Math.abs(a),b=NaN,g=NaN,d=NaN,m=NaN,w=1e-5;if(v<=l){var p=n.unmap(n.transform.unmap(0)),O=n.unmap(n.transform.unmap(r));if(b=Math.min(p,O),d=Math.max(p,O),w<l){var D=a*(i.unmap(i.transform.unmap(0))-f)/o+c,E=a*(i.unmap(i.transform.unmap(e))-f)/o+c,M=Math.min(D,E),S=Math.max(D,E);b<M&&(b=M),S<d&&(d=S)}g=o*(b-c)+a*f,m=o*(d-c)+a*f}else{var T=i.unmap(i.transform.unmap(0)),j=i.unmap(i.transform.unmap(e));if(g=Math.min(T,j),m=Math.max(T,j),w<v){var N=o*(n.unmap(n.transform.unmap(0))-c)/a+f,I=o*(n.unmap(n.transform.unmap(r))-c)/a+f,C=Math.min(N,I),A=Math.max(N,I);g<C&&(g=C),A<m&&(m=A)}b=a*(g-f)+o*c,d=a*(m-f)+o*c}b=n.transform.map(n.map(b)),g=i.transform.map(i.map(g));var R=.5*(b+(d=n.transform.map(n.map(d)))),y=.5*(g+(m=i.transform.map(i.map(m)))),k=Math.abs(d-b),x=Math.abs(m-g);b-=R,g-=y,d-=R,m-=y,4!==u.length?(u.length=0,u.push(b,g,d,m)):(u[0]=b,u[1]=g,u[2]=d,u[3]=m),0!==s.length&&(s.length=0),t.disallowUploadedUpdate(),t.points.set(u,s),t.size.set(k,x),t.transform.position.set(R,y),t.allowUploadedUpdate(),B.update(t)},i.prototype.updateRegion=function(){},i.prototype.destroy=function(){var t=this.Va;t&&(this.Va=null,t.detach(),t.destroy()),n.prototype.destroy.call(this)},i.prototype.hitTest=function(t){var n=this.Va;if(n){var r=i.WORK,e=n.toLocal(t,void 0,r);return null!=n.contains(e)}return!1},i.prototype.calcHitPoint=function(t,n){var r=this.Va;if(r){var e=i.WORK,u=r.toLocal(t,void 0,e);return n.shape=r,r.calcHitPoint(u,this.toThreshold,null,this.calcHitPointHitTester,n)}return!1},i.prototype.toThreshold=function(t,n){return 1/0},i.prototype.calcHitPointHitTester=function(t,n,i,r,e,u,s,h,o){if(i<=t&&t<e){var a=e-i;if(1e-4<Math.abs(a)){var c=(t-i)/a,f=t,l=r+c*(u-r),v=Math.abs(l-n);if(v<h){var b=o.shape.transform,g=b.position,d=g.x,m=g.y,w=b.scale,p=w.x,O=w.y;return o.x=o.p0x=o.p1x=d+p*f,o.y=o.p0y=o.p1y=m+O*l,o.t=c,o.index=s,o.distance=v,!0}}}return!1},i.WORK=new t.Point,i}(nv),lv=function(){function t(t){var n,i,r,e=this.toTheme(t);this.yt=e;var u=(new U).add(null!==(n=null==t?void 0:t.state)&&void 0!==n?n:x.HOVERED);this.Z=u,this.Re=null!==(i=null==t?void 0:t.enable)&&void 0!==i?i:e.isEnabled(u),this.uc=null==t?void 0:t.shape,this.O=null!==(r=null==t?void 0:t.style)&&void 0!==r?r:this.setStyle}return t.prototype.bind=function(t){if(this.Re){var n=this.uc=this.uc||this.newShape(this.yt);n.attach(t.plotArea.axis.container),n.visible=!1}},t.prototype.unbind=function(){var t=this.uc;t&&t.detach()},t.prototype.newShape=function(t){return t.newShape(this.Z)},t.prototype.set=function(t,n,i){this.update(t,n);var r=this.uc;r&&this.O(r,i)},t.prototype.setStyle=function(t,n){var i=n.shape;i&&(t.stroke.color=i.stroke.color)},t.prototype.unset=function(){var t=this.uc;t&&(t.visible=!1)},t.prototype.toTheme=function(t){var n=t&&t.theme;return mt(n)?this.getTheme(n):null!=n?n:this.getTheme(this.getType())},t.prototype.getTheme=function(t){return Z.getInstance().get(t)},t}(),vv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.update=function(t,n){var i=this.uc;if(i){var r=n.x,e=t.plotArea.height;i.transform.position.set(r,.5*e),i.size.set(0,e),i.visible=this.isVisible(t,r)}},n.prototype.isVisible=function(t,n){return 0<=n&&n<=t.plotArea.width},n.prototype.getType=function(){return"DChartSelectionGridlineX"},n}(lv),bv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.update=function(t,n){var i=this.uc;if(i){var r=n.y,e=t.plotArea.width;i.transform.position.set(.5*e,r),i.size.set(e,0),i.visible=this.isVisible(t,r)}},n.prototype.isVisible=function(t,n){return 0<=n&&n<=t.plotArea.height},n.prototype.getType=function(){return"DChartSelectionGridlineY"},n}(lv),gv=function(){function t(t){this._x=new vv(t&&t.x),this._y=new bv(t&&t.y)}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),t.prototype.bind=function(t){this._x.bind(t),this._y.bind(t)},t.prototype.unbind=function(){this._x.unbind(),this._y.unbind()},t.prototype.set=function(t,n,i){this._x.set(t,n,i),this._y.set(t,n,i)},t.prototype.unset=function(){this._x.unset(),this._y.unset()},t.prototype.update=function(t,n){this._x.update(t,n),this._y.update(t,n)},t}(),dv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.update=function(t,n){var i=this.uc;i&&(i.transform.position.copyFrom(n),i.visible=this.isVisible(t,n))},n.prototype.isVisible=function(t,n){var i=n.x,r=n.y,e=t.plotArea;return 0<=i&&i<=e.width&&0<=r&&r<=e.height},n.prototype.getType=function(){return"DChartSelectionMarker"},n}(lv);!function(t){t[t.PREVIOUS=0]="PREVIOUS",t[t.NEXT=1]="NEXT",t[t.CLOSER=2]="CLOSER",t[t.INTERSECTION=3]="INTERSECTION"}(Nl||(Nl={}));var mv=function(n){function i(i){var r=n.call(this)||this;r.da=null,r.ka=null,r.Re=null==i.enable||i.enable,r.sc=new gv(i.gridline),r.hc=new dv(i.marker),r.Z=null!=i.state?i.state:x.HOVERED,r.oc=null,r.ac=null,r.u=new t.Point,r.Ut=null!=i.point?i.point:Nl.CLOSER,r.Ks=new t.Point;var e=i.on;if(e)for(var u in e){var s=e[u];s&&r.on(u,s)}return r}return y(i,n),i.prototype.bind=function(t){this.Re&&(this.da=t,this.sc.bind(t),this.hc.bind(t))},i.prototype.unbind=function(){this.hc.unbind(),this.sc.unbind(),this.da=null,this.oc=null,this.ac=null},Object.defineProperty(i.prototype,"series",{get:function(){return this.ka},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"position",{get:function(){return this.u},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"gridline",{get:function(){return this.sc},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"marker",{get:function(){return this.hc},enumerable:!1,configurable:!0}),i.prototype.set=function(t,n){var i=this.da,r=this.oc=t.coordinate.x,e=this.ac=t.coordinate.y;if(i&&r&&e){var u=i.plotArea.container.localTransform,s=this.u,h=this.Ks;if(n instanceof zl){var o=n.x,a=n.y;switch(this.Ut){case Nl.PREVIOUS:o=n.p0x,a=n.p0y;break;case Nl.NEXT:o=n.p1x,a=n.p1y;break;case Nl.CLOSER:Math.abs(n.p0x-n.x)<Math.abs(n.p1x-n.x)?(o=n.p0x,a=n.p0y):(o=n.p1x,a=n.p1y)}h.set(o,a),u.apply(h,h),s.set(r.unmap(r.transform.unmap(o)),e.unmap(e.transform.unmap(a)))}else s.copyFrom(n.position),h.set(r.transform.map(r.map(s.x)),e.transform.map(e.map(s.y))),u.apply(h,h);this.sc.set(i,h,t),this.hc.set(i,h,t),B.update(i.plotArea)}var c=this.ka;if(c!==t){var f=this.Z;c&&c.state.remove(f),this.ka=t,t.state.add(f)}this.emit("change",this)},i.prototype.setStyle=function(t,n){var i=n.shape;i&&(t.stroke.color=i.stroke.color)},i.prototype.unset=function(){var t=this.ka;t&&(this.ka=null,this.oc=null,this.ac=null,t.state.remove(this.Z),this.sc.unset(),this.hc.unset(),this.emit("change",this))},i.prototype.update=function(){var t=this.da,n=this.oc,i=this.ac;if(t&&n&&i){var r=this.u,e=this.Ks;e.set(n.transform.map(n.map(r.x)),i.transform.map(i.map(r.y))),t.plotArea.container.localTransform.apply(e,e),this.sc.update(t,e),this.hc.update(t,e)}},i}(t.utils.EventEmitter),wv=function(t){function n(n){var i=t.call(this)||this;i.da=null;var r=n&&null!=n.point?mt(n.point)?Nl[n.point]:n.point:Nl.CLOSER;if(i.uo=i.newSelected(r,n&&n.selected),i.cc=i.newHovered(r,n&&n.hovered),n){var e=n.on;if(null!=e)for(var u in e){var s=e[u];s&&i.on(u,s)}}return i.si=function(t){i.onMove(t)},i.fc=function(t){i.onClick(t)},i}return y(n,t),n.prototype.newSelected=function(t,n){return new mv(this.toSubOptions(t,n,x.ACTIVE))},n.prototype.newHovered=function(t,n){return new mv(this.toSubOptions(t,n,x.HOVERED))},n.prototype.toSubOptions=function(t,n,i){null==(n=n||{}).point&&(n.point=t),null==n.state&&(n.state=i);var r=n.gridline||{},e=r.x||{};null==e.state&&(e.state=i);var u=r.y||{};null==u.state&&(u.state=i);var s=n.marker||{};return null==s.state&&(s.state=i),n},n.prototype.onClick=function(t){var n=this.da;if(n&&t.target===n.plotArea){var i=this.cc,r=i.series,e=this.uo;r?e.set(r,i):e.unset()}},n.prototype.onMove=function(t){var i=this.da;if(i){var r=this.cc;if(t.target===i.plotArea){var e=n.WORK_SELECT,u=i.calcHitPoint(t.data.global,e);u?r.set(u,e):r.unset()}else r.unset()}},n.prototype.bind=function(t){this.da=t,this.uo.bind(t),this.cc.bind(t);var n=t.plotArea;n.on(ai.move,this.si),ai.onClick(n,this.fc)},n.prototype.unbind=function(){var t=this.da;this.da=null,t&&t.plotArea.off(ai.move,this.si),this.uo.unbind(),this.cc.unbind()},Object.defineProperty(n.prototype,"selected",{get:function(){return this.uo},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"hovered",{get:function(){return this.cc},enumerable:!1,configurable:!0}),n.prototype.update=function(){this.uo.update(),this.cc.update()},n.WORK_SELECT=new zl,n}(t.utils.EventEmitter),pv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=new $l(this,n&&n.plotArea);this.ma=i,this.addChild(i),this.Yi=null;var r=n&&n.mask;(null!=r?r:this.theme.isOverflowMaskEnabled())&&(i.axis.container.mask=this.getOrCreateOverflowMask())},n.prototype.getOrCreateOverflowMask=function(){return null==this.Yi&&(this.Yi=new vi(this),this.addReflowable(this.Yi),this.toDirty()),this.Yi},Object.defineProperty(n.prototype,"plotArea",{get:function(){return this.ma},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DChart"},n.prototype.destroy=function(){this._destroyed||(this.ma.destroy(),t.prototype.destroy.call(this))},n}(li),Ov=function(){function t(){}return t.prototype.redo=function(){throw new Error("Method not implemented.")},t.prototype.undo=function(){throw new Error("Method not implemented.")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Lc.UNSTORABLE|Lc.CLEAR},t}(),Dv=function(){function t(){}return t.prototype.execute=function(){return ef.getDocumentController().delete()},t.prototype.redo=function(){throw new Error("Method not implemented.")},t.prototype.undo=function(){throw new Error("Method not implemented.")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Lc.UNSTORABLE|Lc.CLEAR},t}(),Ev=function(){function t(t){this.Hu=t}return t.prototype.execute=function(){return ef.getDocumentController().saveAs(this.Hu)},t.prototype.redo=function(){return!0},t.prototype.undo=function(){return!0},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Lc.UNSTORABLE},t}(),Mv=function(){function t(){}return t.prototype.execute=function(){return ef.getDocumentController().save()},t.prototype.redo=function(){return!0},t.prototype.undo=function(){return!0},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Lc.UNSTORABLE},t}(),Sv=function(){function t(t,n){this.i=t,this.zu=n}return t.prototype.getTheme=function(){return this.i.getTheme()},t.prototype.setTheme=function(t){this.i.setTheme(t)},t.prototype.getBaseColor=function(){return this.zu},t.prototype.setBaseColor=function(t){this.zu=t},t.prototype.getColor=function(t){var n=this.i,i=this.zu,r=n.getColor(t);return null!=i?null!=r?W.blend(i,r,n.getAlpha(t)):i:r},Object.defineProperty(t.prototype,"color",{get:function(){return this.i.color},set:function(t){this.i.color=t},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){return null!=this.zu?1:this.i.getAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this.i.alpha},set:function(t){this.i.alpha=t},enumerable:!1,configurable:!0}),t}(),Tv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),Object.defineProperty(n.prototype,"lon",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"lat",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!0}),n.prototype.toObject=function(){return{lon:this.x,lat:this.y}},n}(t.ObservablePoint),jv=function(){function t(t,n,i,r,e,u){this.lc=t,!0===n||!1===n?(this.ut=n,this.lt=new Tv(t,null,i,r),this.vt=new Tv(t,null,e,u)):null!=n?(this.ut=n.enable,this.lt=new Tv(t,null,n.from.lon,n.from.lat),this.vt=new Tv(t,null,n.to.lon,n.to.lat)):(this.ut=!1,this.lt=new Tv(t,null,-180,85.05112877980659),this.vt=new Tv(t,null,180,-85.05112877980659))}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ut},set:function(t){this.ut!==t&&(this.ut=t,this.lc())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"from",{get:function(){return this.lt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.vt},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return{enable:this.ut,from:this.lt.toObject(),to:this.vt.toObject()}},t}(),Nv=function(){function t(t,n){var i=this;this.Vi=t,this.vc=n&&n.factory,this.Th=new jv((function(){i.onMappingChange()}),n&&n.mapping)}return t.prototype.init=function(){this.onMappingChange()},t.prototype.onMappingChange=function(){var t=this.vc;if(t){var n,i=this.Th;i.enable?(n=this.bc)?n.mapping=i:this.bc=t(this.Vi).fit():(n=this.bc)&&(this.bc=void 0,n.destroy())}},Object.defineProperty(t.prototype,"pyramid",{get:function(){return this.bc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"factory",{get:function(){return this.vc},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mapping",{get:function(){return this.Th},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return{mapping:this.Th.serialize()}},t.prototype.destroy=function(){var t=this.bc;null!=t&&(this.bc=void 0,t.destroy())},t}(),Iv=function(t){function n(n){var i=t.call(this)||this;return i.name=n,i.interactive=!1,i.reference=0,i}return y(n,t),n.prototype.destroy=function(){if(!this._destroyed){for(var n=this.children,i=n.length-1;0<=i;--i)n[i].destroy();n.length=0,t.prototype.destroy.call(this)}},n.prototype.serialize=function(t,n,i){for(var r=this.children,e=0,u=r.length;e<u;++e){var s=r[e].serialize(n);s[16]=t,i.push(s)}return[this.name||""]},n.prototype.addUuid=function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].addUuid(t)},n.prototype.updateUuid=function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].updateUuid(t)},n}(uc),Cv=function(t){function n(){var n=t.call(this)||this;return n.Ce=null,n.interactive=!1,n.interactiveChildren=!1,n}return y(n,t),n.prototype.init=function(){if(null==this.Ce){var t=this.children;0<t.length&&(this.Ce=t[0])}},Object.defineProperty(n.prototype,"active",{get:function(){return this.Ce},set:function(t){this.Ce!==t&&(null==t||0<=this.children.indexOf(t))&&(this.Ce=t,this.emit("change",this))},enumerable:!1,configurable:!0}),n.prototype.create=function(t,n){var i=new Iv(t);return this.attach(i,n),i},n.prototype.attach=function(t,n){this.addChild(t),!0===n&&(this.Ce=t),this.emit("change",this),B.update(this)},n.prototype.attachAt=function(t,n,i){this.addChildAt(t,n),!0===i&&(this.Ce=t),this.emit("change",this),B.update(this)},n.prototype.detach=function(t,n){var i=this.children,r=i.indexOf(t);0<=r&&(this.Ce=n,i.splice(r,1),t.parent=void 0,this.emit("change",this),B.update(this))},n.prototype.delete=function(t,n){var i=this.children,r=i.indexOf(t);return 0<=r&&(i.splice(r,1),t.parent=void 0,this.Ce===t&&(!0===n?r<i.length?this.Ce=i[r]:0<i.length?this.Ce=i[r-1]:this.Ce=null:this.Ce=null),this.emit("change",this),B.update(this)),r},n.prototype.get=function(t){var n=this.children[t];return null!=n?n:null},n.prototype.clear=function(){var t=this.children;if(0<t.length){for(var n=t.length-1;0<=n;--n){var i=t[n];i.parent=null,i.destroy()}t.length=0,this.emit("change",this),B.update(this)}},n.prototype.destroy=function(){this._destroyed||(this.clear(),t.prototype.destroy.call(this))},n.prototype.size=function(){return this.children.length},n.prototype.serialize=function(t,n){for(var i=[],r=this.children,e=0,u=r.length;e<u;++e)r[e].addUuid(t);for(e=0,u=r.length;e<u;++e)r[e].updateUuid(t);for(e=0,u=r.length;e<u;++e)i.push(r[e].serialize(e,t,n));return i},n}(t.Container),Av=function(t){function n(n){var i=t.call(this,n)||this;i.toBackgroundAmbient(i.theme,n)||(i.Sn=new Sv(i.Sn,i.toBackgroundColorBase(i.theme,n)));var r=new Cv;return i.oe=r,i.addChild(r),(i.gc=new Nv(i,n&&n.tile)).init(),i}return y(n,t),n.prototype.toBackgroundAmbient=function(t,n){var i=n&&n.background,r=i&&i.ambient;return null!=r?r:t.getBackgroundAmbient()},n.prototype.toBackgroundColorBase=function(t,n){var i=n&&n.background,r=i&&i.base;return null!=r?r:t.getBackgroundBase()},Object.defineProperty(n.prototype,"tile",{get:function(){return this.gc},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layer",{get:function(){return this.oe},enumerable:!1,configurable:!0}),n.prototype.initialize=function(t){},n.prototype.destroy=function(){this._destroyed||(this.gc.destroy(),this.oe.destroy(),t.prototype.destroy.call(this))},n.prototype.hitTest=function(t,n){for(var i=this.oe.children,r=i.length-1;0<=r;--r){var e=i[r].hitTest(t,n);if(null!=e)return e}return null},n.prototype.getType=function(){return"DDiagramCanvasBase"},n}(gl),Rv=function(n){function i(i){var r=n.call(this,i)||this,e=i.snapper;if(r.dc=e,e){var u=new t.Graphics;u.visible=!1,r.addChildAt(u,r.children.length-1),r.mc=u,e.target.on("change",(function(){r.toDirty(),B.update(r)}))}return r}return y(i,n),i.prototype.serialize=function(t,n){var i,r=new oc,e=[],u=this.Sn,s=u.color,h=u.alpha;return{version:1,id:t,name:this.name,width:this.width,height:this.height,background:{color:F(s)?s:16777215,alpha:F(h)?h:0},tile:this.gc.serialize(),resources:r.resources,tags:r.tags,pieces:r.pieces,layers:this.oe.serialize(r,e),items:e,snap:null===(i=this.dc)||void 0===i?void 0:i.serialize(),thumbnail:null==n?void 0:n.serialize()}},i.prototype.onReflow=function(){n.prototype.onReflow.call(this);var t=this.dc,i=this.mc;if(t&&i){var r=t.target;if(r.visible){var e=this.width+.5,u=this.height+.5,s=r.values;i.clear(),i.lineStyle(0,0,0,0),i.beginFill(2000880,.5);for(var h=0,o=s.length;h<o;++h){var a=s[h];a.type===ua.VERTICAL?i.drawRect(a.position,0,1,u):i.drawRect(0,a.position,e,1)}i.endFill(),i.visible=!0}else i.visible=!1}},i.prototype.getType=function(){return"DDiagramCanvasEditor"},i}(Av),yv=function(n){function i(i){var r=n.call(this,i)||this;return r.tags={},r.interactives=[],r.actionables=[],r.ids={},r.wc=new t.Point,r.Oc=new t.Point,r.Dc=null,r}return y(i,n),i.prototype.initialize=function(){for(var t=Date.now(),n=this.tags,i=this.interactives,r=this.actionables,e=this.ids,u=this.oe.children,s=0,h=u.length;s<h;++s)this.initializeShapes(u[s].children,n,i,r,e);for(s=0,h=u.length;s<h;++s)this.updateShapes(u[s].children,t);this.initializeFocus()},i.prototype.initializeFocus=function(){var t=B.getLayer(this);if(t){var n=t.getFocusController(),i=n.find(this,!1,!0,!0);i&&n.focus(i)}},i.prototype.initializeShapes=function(t,n,i,r,e){for(var u=function(u,h){for(var o=t[u],a=o.tag,c=0,f=a.size();c<f;++c){var l=a.get(c);if(l){var v=l.id;if(0<v.length){var b=n[v];null==b&&(b=[],n[v]=b),b.push(l)}}}var g=o.id;if(0<g.length){var d=e[g];null==d?e[g]=[o]:d.push(o)}var m=o.runtime;(o.interactive||0<o.cursor.length||m&&m.interactive)&&i.push(o),m&&0<m.actions.length&&r.push(o);var w=o.shortcut;null!=w&&pt.on(s,w,(function(t){o.onShortcut(t)}));var p=o.children;0<p.length&&s.initializeShapes(p,n,i,r,e)},s=this,h=0,o=t.length;h<o;++h)u(h)},i.prototype.updateShapes=function(t,n){for(var i=0,r=t.length;i<r;++i)t[i].update(n)},i.prototype.onShapeMove=function(t){for(var n=t.data.global,i=this.wc,r=this.interactives,e=null,u=r.length-1;0<=u;--u){var s=r[u];if(s.visible&&(s.toLocal(n,void 0,i),s.contains(i))){e=s;break}}var h=B.getLayer(this);if(e){if(h){var o,a=e.cursor;a.length<=0&&(a="auto"),(o=h.view.style).cursor!==a&&(o.cursor=a)}if(e===(b=this.Dc))(v=b.runtime)&&v.onPointerMove(b,t);else{if(this.Dc=e,b){var c=b.runtime;c&&c.onPointerOut(b,t);for(var f=b.parent;f instanceof Y&&f!==e;)(g=b.runtime)&&g.onPointerOut(f,t),f=f.parent}(v=e.runtime)&&v.onPointerOver(e,t),h&&(h.view.title=e.title||"");for(var l=e.parent;l instanceof Y;)(g=l.runtime)&&g.onPointerOver(l,t),l=l.parent}return!0}h&&"auto"!==(o=h.view.style).cursor&&(o.cursor="auto");var v,b=this.Dc;if(this.Dc=null,b)for((v=b.runtime)&&v.onPointerOut(b,t),f=b.parent;f instanceof Y;){var g;(g=f.runtime)&&g.onPointerOut(f,t),f=f.parent}return h&&(h.view.title=""),!1},i.prototype.onShapeDown=function(t){for(var n=this.interactives,i=t.data.global,r=this.wc,e=n.length-1;0<=e;--e){var u=n[e];if(u.visible&&(u.toLocal(i,void 0,r),u.contains(r))){var s=u.runtime;return s&&s.onPointerDown(u,t),!0}}return!1},i.prototype.onShapeUp=function(t){for(var n=this.interactives,i=t.data.global,r=this.wc,e=n.length-1;0<=e;--e){var u=n[e];if(u.visible&&(u.toLocal(i,void 0,r),u.contains(r))){var s=u.runtime;return s&&s.onPointerUp(u,t),!0}}return!1},i.prototype.onShapeClick=function(t){for(var n=this.interactives,i=t.data.global,r=this.wc,e=n.length-1;0<=e;--e){var u=n[e];if(u.visible&&(u.toLocal(i,void 0,r),u.contains(r))){for(var s=u;;){var h=s.runtime;h&&h.onPointerClick(s,t);var o=s.parent;if(!(o instanceof Y))break;s=o}return!0}}return!1},i.prototype.onShapeDblClick=function(t,n){for(var i=this.interactives,r=ai.toGlobal(t,n,this.Oc),e=this.wc,u=i.length-1;0<=u;--u){var s=i[u];if(s.visible&&(s.toLocal(r,void 0,e),s.contains(e))){for(var h=s;;){var o=h.runtime;o&&o.onPointerDblClick(h,t);var a=h.parent;if(!(a instanceof Y))break;h=a}return!0}}return!1},i.prototype.getType=function(){return"DDiagramCanvas"},i}(Av),kv=function(){function t(t){this.o=t}return t.prototype.createAsUrl=function(t){return this.create(t,(function(t){return xc.base64({target:t})}))},t.prototype.createAsFile=function(t,n){this.create(t,(function(t){return xc.file({target:t,filename:n})}))},t.prototype.create=function(t,n){var i=this.o,r=i.canvas;if(r){var e=i.view,u=e.position,s=e.scale,h=u.x,o=u.y,a=s.x,c=s.y,f=t/B.getResolution(r)/Math.max(r.width,r.height);e.transform(0,0,f,f,0);var l=n(r);return e.transform(h,o,a,c,0),l}},t}(),xv=function(t){function n(n){var i=t.call(this,n)||this;return i.Ec=null,i.Mc=null==n?void 0:n.tile,i.Sc=null==n?void 0:n.controller,i.Tc=i.toBackgroundAmbient(i.theme,i.vn),i.jc=new kv(i),i}return y(n,t),Object.defineProperty(n.prototype,"snapshot",{get:function(){return this.jc},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"controller",{get:function(){return this.Sc||null},enumerable:!1,configurable:!0}),n.prototype.set=function(t){var n=this.Ec;n!==t&&(n&&(this.Ec=null,this.onUnset()),this.Ec=t,t&&this.onSet(t))},n.prototype.onSet=function(t){var n=this,i=this.newCanvas(t),r=t.pieces,e=this.isEditMode(),u=Wu.toPieceData(this.Sc,r,e);null==u?this.newLayer(t,i,e):u.then((function(u){n.newLayer(t,i,e,r,u)})),this.canvas=i},n.prototype.newLayer=function(t,n,i,r,e){var u=this,s=n.layer,h=new Tu(t,r,e,i);if(Wu.newLayer(t,s,h).then((function(t){s.init(),u.initialize(t),n.initialize(t),B.update(u),u.emit("ready",u)})),this.Tc){var o=this.toBackground(t);this.background.color=o.color,this.background.alpha=o.alpha}},n.prototype.toCanvasBaseOptions=function(t,n){void 0===n.name&&(n.name=t.name),void 0===n.width&&(n.width=t.width),void 0===n.height&&(n.height=t.height);var i=n.background=n.background||{},r=this.Tc,e=this.toBackground(t);if(r){void 0===i.color&&(i.color=null);var u=n.border=n.border||{};void 0===u.color&&(u.color=null)}else void 0===i.color&&(i.color=e.color),void 0===i.alpha&&(i.alpha=e.alpha),void 0===n.shadow&&(n.shadow="WEAK");if(void 0===i.ambient){var s=this.vn;if(s){var h=s.background;h&&void 0!==h.ambient&&(i.ambient=r)}}var o=n.tile=n.tile||{};return void 0===o.factory&&(o.factory=this.Mc),void 0===o.mapping&&(o.mapping=t.tile&&t.tile.mapping),n},n.prototype.toBackgroundAmbient=function(t,n){var i=n&&n.background,r=i&&i.ambient;return null!=r?r:t.getBackgroundAmbient()},n.prototype.toBackground=function(t){var n=t.background;if(null!=n){var i=n.color,r=n.alpha;return{color:null!=i?i:16777215,alpha:null!=r?r:1}}return{color:16777215,alpha:1}},n.prototype.openByName=function(t){var n=this,i=this.Sc;i&&i.getByName(t).then((function(t){n.set(Wu.toSerialized(t))}))},n.prototype.initialize=function(t){},n.prototype.onUnset=function(){null!=this.canvas&&(this.canvas=null)},n.prototype.get=function(){return this.Ec},Object.defineProperty(n.prototype,"layer",{get:function(){var t=this.canvas;return null!=t?t.layer.active:null},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DDiagramBase"},n}(Ti),Lv=function(){function t(t,n,i){var r,e;this.jc=t,this.Re=null!==(r=null==i?void 0:i.enable)&&void 0!==r?r:n.isThumbnailEnabled(),this.S=null!==(e=null==i?void 0:i.size)&&void 0!==e?e:n.getThumbnailSize()}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.Re},set:function(t){this.Re=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this.S},set:function(t){this.S=t},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){if(this.Re)return this.jc.createAsUrl(this.S)},t}(),Bv=function(t){function n(n){var i=t.call(this,n)||this;return i.Nc=!1,i.Nc=!1,ef.getCommandController().on("dirty",(function(){!0!==i.Nc&&(i.Nc=!0,i.emit("change",i))})),i.dc=new dc(i),i.Ic=new Lv(i.jc,i.theme,null==n?void 0:n.thumbnail),i}return y(n,t),Object.defineProperty(n.prototype,"thumbnail",{get:function(){return this.Ic},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"snapper",{get:function(){return this.dc},enumerable:!1,configurable:!0}),n.prototype.isEditMode=function(){return!0},n.prototype.newCanvas=function(t){return new Rv(this.toCanvasOptions(t))},n.prototype.toCanvasOptions=function(n){var i=t.prototype.toCanvasBaseOptions.call(this,n,this.Xi||{snapper:this.dc});return void 0===i.snapper&&(i.snapper=this.dc),i},n.prototype.serialize=function(){var t=this.canvas,n=this.Ec;return null!=t&&null!=n?t.serialize(n.id,this.Ic):null},n.prototype.save=function(){var t=this,n=this.serialize();if(null!=n){var i=this.Sc;if(i){var r=Wu.toSimple(n);return this.emit("saving",r,this),i.save(r).then((function(i){t.Nc=!1,n.id=i,t.Ec=n,t.emit("change",t),t.emit("saved",null,t)}),(function(n){t.emit("saved",n,t)}))}return this.emit("saved","no-controller",this),Promise.reject()}return this.emit("saved",null,this),Promise.resolve()},n.prototype.saveAs=function(t){var n=this,i=this.serialize();if(null!=i){var r=this.Sc;if(r){i.id=void 0,i.name=t;var e=Wu.toSimple(i);return this.emit("saving",e,this),r.save(e).then((function(r){n.Nc=!1,i.id=r,n.Ec=i;var e=n.canvas;null!=e&&(e.name=t),n.emit("change",n),n.emit("saved",null,n)}),(function(t){n.emit("saved",t,n)}))}return this.emit("saved","no-controller",this),Promise.reject("no-controller")}return this.emit("saved",null,this),Promise.resolve()},n.prototype.delete=function(){var t=this,n=this.Ec;if(n&&null!=n.id){var i=this.Sc;return i?(this.emit("deleting",this),i.delete(n.id).then((function(){t.set(null),t.emit("deleted",t)}),(function(n){t.emit("deleted",n,t)}))):(this.emit("deleted","no-controller",this),Promise.reject("no-controller"))}return this.set(null),this.emit("deleted",null,this),Promise.resolve()},n.prototype.create=function(t,n,i){this.set({version:1,id:void 0,name:t,width:n,height:i,resources:[],tags:[],layers:[["Default layer"]],items:[],snap:void 0})},n.prototype.onSet=function(n){t.prototype.onSet.call(this,n);var i=n.snap,r=this.dc;null!=i?r.deserialize(i):r.reset(),this.Nc=!1,this.emit("change",this)},n.prototype.onUnset=function(){t.prototype.onUnset.call(this),this.Nc=!1,this.emit("change",this)},n.prototype.open=function(t){var n=this,i=this.Sc;return i?(this.emit("opening",this),i.get(t).then((function(t){n.set(Wu.toSerialized(t)),n.emit("opened",null,n)}),(function(t){n.emit("opened",t,n)}))):(this.emit("opened","no-controller",this),Promise.reject("no-controller"))},n.prototype.close=function(){this.set(null)},n.prototype.isChanged=function(){return this.Nc||this.isNew()},n.prototype.isNew=function(){var t=this.Ec;return null!=t&&null==t.id},n.prototype.getName=function(){var t=this.Ec;return null!=t?t.name:null},n.prototype.getType=function(){return"DDiagramEditor"},n}(xv),_v=function(t){function n(n){var i=t.call(this)||this;return i.Cc=n,i.Ah=function(){B.update(n)},i}return y(n,t),n.prototype.update=function(){var t=this.Cc.canvas;if(t){var n=t.actionables;if(0<n.length){for(var i=-1,r=Date.now(),e=0,u=n.length;e<u;++e){var s=n[e];s.update(r);var h=s.runtime;if(h&&r<h.effect){var o=h.effect;r<o&&(i=i<0?o:Math.min(i,o))}}0<=i&&setTimeout(this.Ah,i-Date.now())}}},n.prototype.get=function(t){var n=this.Cc.canvas,i=n&&n.ids[t];return i&&0<i.length?i[0]:null},n.prototype.getAll=function(t){var n=this.Cc.canvas;return n&&n.ids[t]||[]},n.prototype.each=function(t,n){void 0===n&&(n=!1);var i=this.Cc.canvas;if(null!=i){var r=i.layer.children;if(n){for(e=r.length-1;0<=e;--e)for(h=(s=r[e].children).length-1;0<=h;--h)if(!1===t(a=s[h]))return a}else for(var e=0,u=r.length;e<u;++e)for(var s,h=0,o=(s=r[e].children).length;h<o;++h){var a;if(!1===t(a=s[h]))return a}}return null},n}(t.utils.EventEmitter),Pv=function(){function t(t){this.Sc=t&&t.controller}return t.prototype.set=function(t,n,i){var r=this.Sc;r&&r.write(t,n)},t}(),Fv=function(){function t(t,n){this.Cc=t,this.Ac=n&&n.mapper||null,this.Rc=new Pv(n&&n.remote)}return t.prototype.update=function(){},Object.defineProperty(t.prototype,"mapper",{get:function(){return this.Ac},set:function(t){this.Ac=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remote",{get:function(){return this.Rc},enumerable:!1,configurable:!0}),t.prototype.getIds=function(){var t=this.Cc.canvas;return null!=t?Object.keys(t.tags):[]},t.prototype.each=function(t){var n=this.Cc.canvas;if(null!=n){var i=n.tags;for(var r in i)if(!1===t(r))return r}return null},t.prototype.set=function(t,n,i,r,e){var u=this.Cc.canvas;if(null!=u){var s=u.tags[t];if(null!=s)for(var h=0,o=s.length;h<o;++h){var a=s[h];a.range.set(r,e),void 0!==i&&(a.time=i),a.value=n}}},t.prototype.clear=function(t){var n=this.Cc.canvas;if(null!=n){var i=n.tags[t];if(null!=i)for(var r=0,e=i.length;r<e;++r)i[r].clear()}},t.prototype.setAll=function(t,n,i,r,e){var u=this.Cc.canvas;if(null!=u){var s=u.tags[t];if(null!=s)for(var h=0,o=s.length;h<o;++h){var a=s[h];a.range.set(r,e),void 0!==i&&(a.times=i),a.values=n}}},t.prototype.setValue=function(t,n,i){var r=this.Cc.canvas;if(null!=r){var e=r.tags[t];if(null!=e)for(var u=0,s=e.length;u<s;++u){var h=e[u];void 0!==i&&(h.time=i),h.value=n}}},t.prototype.setValues=function(t,n,i){var r=this.Cc.canvas;if(null!=r){var e=r.tags[t];if(null!=e)for(var u=0,s=e.length;u<s;++u){var h=e[u];void 0!==i&&(h.times=i),h.values=n}}},t.prototype.setTime=function(t,n){var i=this.Cc.canvas;if(null!=i){var r=i.tags[t];if(null!=r)for(var e=0,u=r.length;e<u;++e)r[e].time=n}},t.prototype.setTimes=function(t,n){var i=this.Cc.canvas;if(null!=i){var r=i.tags[t];if(null!=r)for(var e=0,u=r.length;e<u;++e)r[e].times=n}},t.prototype.setRange=function(t,n,i){var r=this.Cc.canvas;if(null!=r){var e=r.tags[t];if(null!=e)for(var u=0,s=e.length;u<s;++u){var h=e[u].range;void 0!==n&&(null!==n?(h.type|=J.FROM,h.from=n):h.type&=~J.FROM),void 0!==i&&(null!==i?(h.type|=J.TO,h.to=i):h.type&=~J.TO)}}},t}(),Uv=function(t){function i(n){var i=t.call(this,n)||this;return i.on(ai.move,(function(t){if(ai.contains(i,t.target)){var n=i.canvas;n&&n.onShapeMove(t)}})),i.on(ai.up,(function(t){if(ai.contains(i,t.target)){var n=i.canvas;n&&n.onShapeUp(t)}})),i.on("click",(function(t){if(ai.contains(i,t.target)){var n=i.canvas;n&&n.onShapeClick(t)}})),i.tag=new Fv(i,n&&n.tag),i.shape=new _v(i),i}return y(i,t),i.prototype.initialize=function(t){this.initializeShapes(t,null,this.tag.mapper)},i.prototype.initializeShapes=function(t,n,i){for(var r={},e={},u=new Map,s=0,h=t.length;s<h;++s){for(var o=t[s],a=ac[o.type]||Dt,c=o.runtime=new a(o),f=o.tag,l=0,v=f.size();l<v;++l)if(p=f.get(l)){i&&i(p,n||o);var b=p.format,g=p.initial;if(b in r)p.formatter=r[b];else if(0<b.length)try{var d=Function("value","try {return ("+b+");} catch( e1 ) {try {return ("+(0<g.length?g:0)+");} catch( e2 ) {return 0;}}");r[b]=d,p.formatter=d}catch(t){}if(g in e)p.value=e[g];else if(0<g.length)try{p.value=e[g]=Function("try {return ("+g+");} catch( e ) {return 0;}")()}catch(t){}}var m=o.action.values,w=c.actions;for(l=0,v=m.length;l<v;++l){var p=m[l],O=u.get(p);null==O?null!=(O=p.toRuntime(o))&&(O instanceof xr&&o.cursor.length<=0&&(o.cursor="pointer"),u.set(p,O),w.push(O),c.reset|=O.reset):(w.push(O),c.reset|=O.reset)}var D=o.children;0<D.length&&this.initializeShapes(D,this.toTagShape(n,o),i)}},i.prototype.toTagShape=function(t,i){return null!=t?t:i.type===n.EMBEDDED?i:null},i.prototype.isEditMode=function(){return!1},i.prototype.newCanvas=function(t){return new yv(this.toCanvasOptions(t))},i.prototype.toCanvasOptions=function(n){return t.prototype.toCanvasBaseOptions.call(this,n,this.Xi||{})},i.prototype.onDown=function(n){var i=this.canvas;i&&i.onShapeDown(n)||t.prototype.onDown.call(this,n)},i.prototype.onDblClick=function(n,i){var r=this.canvas;return!(!r||!r.onShapeDblClick(n,i))||t.prototype.onDblClick.call(this,n,i)},i.prototype.render=function(n){this.shape.update(),t.prototype.render.call(this,n)},i.prototype.getType=function(){return"DDiagram"},i}(xv),zv=function(t){function n(n){var i=t.call(this,n)||this;return i.state.isFocusable=!1,i}return y(n,t),n.prototype.getType=function(){return"DDialogConfirmMessage"},n}(Xo),Gv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=this.toMessage(this.theme,i);this.yc=r,n.addChild(r)},n.prototype.toMessage=function(t,n){if(n&&null!=n.message){var i=n.message;return mt(i)||_n(i)?this.newMessage(this.toMessageOptions(i)):i instanceof li?i:this.newMessage(this.toMessageOptionsMerged(i,t.getMessage()))}return this.newMessage(this.toMessageOptions(t.getMessage()))},n.prototype.toMessageOptionsMerged=function(t,n){return null==t.text&&(t.text={}),void 0===t.text.value&&(t.text.value=n),t},n.prototype.toMessageOptions=function(t){return{text:{value:t}}},n.prototype.newMessage=function(t){return new zv(t)},Object.defineProperty(n.prototype,"message",{get:function(){return this.yc},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DDialogConfirm"},n}(jr),Hv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DDialogConfirmDelete"},n}(Gv),Vv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DDialogConfirmDiscard"},n}(Gv),Wv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DDialogMessage"},n}(Gv),Xv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DDialogProcessingMessage"},n}(zv),Yv=function(t){function n(n){var i=t.call(this,n)||this;i.kc=!0,i.Rn=0;var r=n&&n.delay;return i.xc=r&&null!=r.done?r.done:i.theme.getDoneDelay(),i.Lc=r&&void 0!==r.close?r.close:i.theme.getCloseDelay(),i.Bc=i.yc.text,i}return y(n,t),n.prototype.newMessage=function(t){return new Xv(t)},n.prototype.onOpen=function(){this.kc=!1,this.Rn=Date.now();var n=this._c;null!=n&&clearTimeout(n);var i=this.Pc;null!=i&&clearTimeout(i);var r=this.yc;r.text=this.Bc,r.state.remove(x.SUCCEEDED|x.FAILED);var e=this.Me;null!=e&&e.hide(),t.prototype.onOpen.call(this)},n.prototype.onDone=function(t){var n=this;null!=t?this.Pc=window.setTimeout((function(){n.close()}),t):this.close()},n.prototype.onResolved=function(t){null!=t&&(this.yc.text=t),this.yc.state.set(x.SUCCEEDED,x.FAILED);var n=this.Lc;if(null!=n)this.onDone(n);else{var i=this.Me;null!=i?i.show():this.close()}},n.prototype.onRejected=function(t){null!=t&&(this.yc.text=t),this.yc.state.set(x.FAILED,x.SUCCEEDED);var n=this.Me;null!=n?n.show():this.onDone(this.Lc)},n.prototype.resolve=function(t){var n=this;if(!this.kc){this.kc=!0;var i=Date.now()-this.Rn,r=this.xc-i;0<r?this._c=window.setTimeout((function(){n._c=void 0,n.onResolved(t)}),r):this.onResolved(t)}},n.prototype.reject=function(t){var n=this;if(!this.kc){this.kc=!0;var i=Date.now()-this.Rn,r=this.xc-i;0<r?this._c=window.setTimeout((function(){n._c=void 0,n.onRejected(t)}),r):this.onRejected(t)}},n.prototype.onCloseOn=function(){this.kc&&t.prototype.onCloseOn.call(this)},n.prototype.getType=function(){return"DDialogProcessing"},n}(Gv),Kv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.onOpen=function(){var n=ef.getDocumentController().getName();null!=n&&(this.input.value=n),t.prototype.onOpen.call(this)},n.prototype.onOk=function(){t.prototype.onOk.call(this);var n=this.input.value;ef.getCommandController().push(new Ev(n))},n.prototype.getType=function(){return"DDialogSaveAs"},n}(Kr),Jv=function(){function t(t){this.Fc=t,this.Uc=[]}return t.prototype.indexOf=function(t){return this.Uc.indexOf(t)},t.prototype.close=function(t){for(var n=this.Uc,i=Math.max(0,t),r=n.length-1;i<=r;--r)n[r].close()},t.prototype.add=function(t){this.Uc.push(t)},t.prototype.trim=function(t){this.close(this.indexOf(t)+1)},t.prototype.remove=function(t){var n=this.indexOf(t);0<=n&&(this.close(n+1),this.Uc.splice(n,1))},t}(),Zv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.fe=function(){i.onPrerender()},null!=n?(this.at=null!=n.align?mt(n.align)?ha[n.align]:n.align:ha.BOTTOM,this.zc=null!=n.fit&&n.fit,this.Gc=null!=n.sticky&&n.sticky):(this.at=ha.BOTTOM,this.zc=!1,this.Gc=!1),this.Hc=!1,this.Fc=null,this.visible=!1,this.hh=null,this.state.isFocusRoot=!0,mr.apply(this,(function(){i.close()})),this.on("select",(function(){i.close()})),n&&n.items&&$o.newItems(this,n.items,this.Gc),this.me=new wr(n)},n.prototype.findItem=function(t){for(var n=this.children,i=0,r=n.length;i<r;++i){var e=n[i];if(e instanceof Ko&&e.value===t)return e}return null},n.prototype.getType=function(){return"DMenu"},n.prototype.getContext=function(){return this.hh},n.prototype.getCloseable=function(){return this},n.prototype.open=function(n,i,r){if(this.isHidden()){var e=this.me.pick(this);this.Fc=n;for(var u=this.children,s=0,h=u.length;s<h;++s){var o=u[s];o instanceof li&&o.state.remove(x.FOCUSED|x.HOVERED)}var a=e.renderer,c=this.fe;if(this.Gc?a.on("prerender",c):a.once("prerender",c),this.zc){var f=n.getBounds();null!=f&&(this.width=f.width)}this.Hc=null!=r,r=r||new Jv(n),null!=i&&r.trim(i),r.add(this),this.hh=r,e.stage.addChild(this),this.Wh=e.getFocusController().get(),this.focus(),t.prototype.show.call(this),this.emit("open",this)}return this},n.prototype.onPrerender=function(){var t=this.Fc;if(t){var n=t.getBounds();if(n){this.zc&&(this.width=n.width);var i=this.me.picked;if(i){var r=this.theme;sa.attach(this,n,r.getOffsetX(),r.getOffsetY(),i.width,i.height,this.at)}}}},n.prototype.close=function(){if(this.isShown()){var n=this.hh;n&&n.remove(this);var i=this.me.picked;i&&i.renderer.off("prerender",this.fe),this.Fc=null;var r=this.Wh;null!=r?(this.Wh=null,i?i.getFocusController().focus(r):this.blur(!0)):this.blur(!0),t.prototype.hide.call(this);var e=this.parent;e&&e.removeChild(this),this.emit("close",this)}return this},n.prototype.onKeyDown=function(n){return pt.moveFocusVertically(n,this,this.me),this.state.isActionable&&(pt.isArrowLeftKey(n)||pt.isCancelKey(n))&&this.close(),t.prototype.onKeyDown.call(this,n)},n.prototype.containsGlobalPoint=function(t){return!this.Hc},n}(Tr);$o.setMenuCreator((function(t){return new Zv(t)}));var qv,$v=function(t){function n(n){var i=t.call(this,n)||this;return i.on("active",(function(){i.start()})),i}return y(n,t),n.prototype.toItemText=function(t){if(t){var n=t.text;if(mt(n))return n;if(null!=n){var i=n(t.state);if(null!=i)return i}}return null},n.prototype.toMenu=function(t,n){var i=n&&n.menu;return i instanceof Zv?i:new Zv(this.toMenuOptions(t,i))},n.prototype.toMenuOptions=function(t,n){return null==(n=n||{}).fit&&(n.fit=!0),n},Object.defineProperty(n.prototype,"menu",{get:function(){var t=this.ls;return null==t&&(t=this.toMenu(this.theme,this.vn),this.ls=t),t},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DDropdownBase"},n.prototype.onKeyDown=function(n){return this.state.isActionable&&this.state.isFocused&&pt.isArrowDownKey(n)&&this.onClick(n),t.prototype.onKeyDown.call(this,n)},n.prototype.start=function(){this.menu.open(this)},n.prototype.close=function(){this.menu.close()},n}(lr),Qv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DDropdown"},n}($v),tb=function(t){function n(n){var i=t.call(this,n)||this;return i.on(ai.down,(function(){i.state.isActionable&&i.onSelect()})),i}return y(n,t),n.prototype.onSelect=function(){this.emit("select",this)},n.prototype.onKeyDown=function(n){return this.state.isActionable&&this.state.isFocused&&pt.isActivateKey(n)&&this.onSelect(),t.prototype.onKeyDown.call(this,n)},n.prototype.getType=function(){return"DExpandableHeader"},n}(Xo),nb=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(t){var i=this;n.prototype.init.call(this,t);var r=this.theme,e=this.toHeader(r,t);this.bs=e,e.on("select",(function(){i.toggle()})),this.addChild(e);var u=this.toBody(r,t);this.gs=u,this.addChild(u),this.state.isActive?this.onActivated():this.onDeactivated()},i.prototype.toHeader=function(n,i){return i&&i.header?i.header instanceof t.DisplayObject?i.header:this.newHeader(n,i.header):this.newHeader(n)},i.prototype.newHeader=function(t,n){return new tb(n)},i.prototype.toBody=function(t,n){return n.body},i.prototype.open=function(){this.state.isActive=!0},i.prototype.close=function(){this.state.isActive=!1},i.prototype.toggle=function(){this.state.isActive=!this.state.isActive},i.prototype.onActivated=function(){var t=this.gs;t instanceof li?t.show():t.visible=!0},i.prototype.onDeactivated=function(){var t=this.gs;t instanceof li?t.hide():t.visible=!1},i.prototype.onStateChange=function(t,i){n.prototype.onStateChange.call(this,t,i),t.isActive?i.isActive||this.onActivated():i.isActive&&this.onDeactivated()},i.prototype.getType=function(){return"DExpandable"},i}(Tr),ib=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.createInput=function(t){return new zr(t)},n}(bf),rb=function(){function t(t){void 0===t&&(t=256),this.Vc=t}return t.prototype.getTileSize=function(){return this.Vc},t.prototype.lonLatToMeters=function(n,i){var r=t.CIRCUMFERENCE_HALF;return i.x=n.x*r/180,i.y=Math.log(Math.tan((90+n.y)*Math.PI/360))*r/Math.PI,i},t.prototype.metersToLonLat=function(n,i){var r=t.CIRCUMFERENCE_HALF;return i.x=n.x/r*180,i.y=360*Math.atan(Math.exp(n.y*Math.PI/r))/Math.PI-90,i},t.prototype.pixelsToMeters=function(n,i,r,e){var u=this.toResolution(i,r),s=t.CIRCUMFERENCE_HALF;return e.x=n.x*u-s,e.y=s-n.y*u,e},t.prototype.metersToPixels=function(n,i,r,e){var u=this.toResolution(i,r),s=t.CIRCUMFERENCE_HALF;return e.x=(n.x+s)/u,e.y=(s-n.y)/u,e},t.prototype.pixelsToTile=function(t,n,i){return i.x=Math.ceil(t.x/n)-1,i.y=Math.ceil(t.y/n)-1,i},t.prototype.metersToTile=function(n,i,r){var e=t.CIRCUMFERENCE_HALF,u=1<<i;return r.x=Math.ceil(.5*(n.x/e+1)*u)-1,r.y=Math.ceil(.5*(1-n.y/e)*u)-1,r},t.prototype.lonLatToTile=function(t,n,i){return this.metersToTile(this.lonLatToMeters(t,i),n,i)},t.prototype.lonLatToPixels=function(t,n,i,r){return this.metersToPixels(this.lonLatToMeters(t,r),n,i,r)},t.prototype.pixelsToLonLat=function(t,n,i,r){return this.metersToLonLat(this.pixelsToMeters(t,n,i,r),r)},t.prototype.tileToPixels=function(t,n,i){return i.x=t.x*n,i.y=t.y*n,i},t.prototype.tileToMeters=function(n,i,r){var e=this.toResolutionMeter(i),u=t.CIRCUMFERENCE_HALF;return r.x=n.x*e+u,r.y=u-n.y*e,r},t.prototype.toResolutionMeter=function(n){return 2*t.CIRCUMFERENCE_HALF/(1<<n)},t.prototype.toResolution=function(n,i){return 2*t.CIRCUMFERENCE_HALF/(i<<n)},t.prototype.toTileCount=function(t){return 1<<t},t.prototype.toTileCode=function(t,n,i){return(n<<t)+i},t.CIRCUMFERENCE_HALF=6378137*Math.PI,t}(),eb=function(){function t(){}return Object.defineProperty(t,"DEFAULT",{get:function(){return null==this.Wc&&(this.Wc=new rb),this.Wc},enumerable:!1,configurable:!0}),t}(),ub=function(){function n(n,i,r,e,u,s){this.tx=i,this.ty=r;var h=new t.Sprite(t.Texture.EMPTY);h.parent=n,h.position.set(e,u),h.scale.set(s,s),this.Xc=h}return n.prototype.load=function(n,i){var r=t.Texture.from(n,{resolution:1});this.Xc.texture=r,r.valid?i():r.on("update",i)},n.prototype.transform=function(t,n,i){var r=this.Xc;r.position.set(t,n),r.scale.set(i,i)},Object.defineProperty(n.prototype,"loaded",{get:function(){return this.Xc.texture.valid},enumerable:!1,configurable:!0}),n.prototype.render=function(t){var n=this.Xc;n.updateTransform(),n.render(t)},n.prototype.destroy=function(){var n=this.Xc,i=n.texture,r=i.baseTexture.resource,e=null;r instanceof t.resources.BaseImageResource&&r.source instanceof HTMLImageElement&&(e=r.source),i.destroy(!0),n.destroy(),e&&(e.src="")},n}(),sb=function(){function n(t,n,i,r,e,u){var s=this;this.o=t,this.Ns=n,this.Yc=u,this.Kc=!1,this.Jc=!0,this.Zc=function(){s.onLoaded()},this.qc=i,this._lon0=NaN,this._lat0=NaN,this._lon1=NaN,this._lat1=NaN,this.$c=new Map,this.Qc=function(t){s.renderTile(t)},this.tf=NaN,this.nf=NaN,this.if=NaN,this.rf=NaN,this.ef=function(t,n,i){s.deleteTile(t,n,i)},this.uf=function(t){s.destroyTile(t)},this.sf=function(t){t.loaded||(s.hf=!1)},this.af=e.toTileCount(i),this.cf=1/this.af,this.ff=r.scale*this.cf,this.Vc=e.getTileSize()*r.scale,this.Th=r,this.ya=e,this.hf=!0}return n.prototype.newTile=function(t,n,i,r,e){return new ub(this.o,t,n,i,r,e)},n.prototype.renderTile=function(t){t.render(this.js)},Object.defineProperty(n.prototype,"tz",{get:function(){return this.qc},enumerable:!1,configurable:!0}),n.prototype.render=function(t){this.js=t,this.$c.forEach(this.Qc)},n.prototype.move=function(t,i,r,e){var u=this._lon0,s=this._lat0,h=this._lon1,o=this._lat1;if(u!==t||s!==i||h!==r||o!==e){this._lon0=t,this._lat0=i,this._lon1=r,this._lat1=e;var a=this.qc,c=this.ya,f=n.WORK;f.set(t,i),c.lonLatToTile(f,a,f);var l=f.x,v=f.y;f.set(r,e),c.lonLatToTile(f,a,f);var b=f.x,g=f.y,d=this.af,m=Math.max(0,l),w=Math.min(d-1,b),p=Math.max(0,v),O=Math.min(d-1,g),D=m-this.tf,E=w-this.nf,M=p-this.if,S=O-this.rf,T=D!=D||D<0||1<D,j=E!=E||0<E||E<-1,N=M!=M||M<0||1<M,I=S!=S||0<S||S<-1;if(T||j||N||I){T?this.tf=m:m=this.tf,j?this.nf=w:w=this.nf,N?this.if=p:p=this.if,I?this.rf=O:O=this.rf,this.$c.forEach(this.ef);var C=m+w>>1,A=p+O>>1,R=Math.max(C-m,w-C),y=Math.max(A-p,O-A),k=Math.max(R,y);this.toOffset(f);var x=f.x,L=f.y;this.Kc=!1,this.Jc=!1,this.loadTile(a,C,A,x,L,f);for(var B=1;B<=k;++B){var _=C-B;m<=_&&this.loadTilesY(a,_,A,B,p,O,x,L,f);var P=C+B;P<=w&&this.loadTilesY(a,P,A,B,p,O,x,L,f);var F=A-B;p<=F&&this.loadTilesX(a,C,B-1,m,w,F,x,L,f);var U=A+B;U<=O&&this.loadTilesX(a,C,B-1,m,w,U,x,L,f)}this.Jc=!0,this.Kc&&this.onLoaded()}}},n.prototype.loadTilesX=function(t,n,i,r,e,u,s,h,o){this.loadTile(t,n,u,s,h,o);for(var a=1;a<=i;++a){var c=n-a;r<=c&&this.loadTile(t,c,u,s,h,o);var f=n+a;f<=e&&this.loadTile(t,f,u,s,h,o)}},n.prototype.loadTilesY=function(t,n,i,r,e,u,s,h,o){this.loadTile(t,n,i,s,h,o);for(var a=1;a<=r;++a){var c=i-a;e<=c&&this.loadTile(t,n,c,s,h,o);var f=i+a;f<=u&&this.loadTile(t,n,f,s,h,o)}},n.prototype.loadTile=function(t,n,i,r,e,u){var s=this.ya.toTileCode(t,n,i),h=this.$c,o=h.get(s);null==o&&(this.toTilePosition(n,i,r,e,u),o=this.newTile(n,i,u.x,u.y,this.ff),h.set(s,o),o.load(this.Ns(t,n,i),this.Zc),this.hf=!1)},n.prototype.toTilePosition=function(t,n,i,r,e){var u=this.Vc,s=this.cf;return e.set(t,n),this.ya.tileToPixels(e,u,e),e.set(e.x*s+i,e.y*s+r),e},n.prototype.toOffset=function(t){var n=this.o,i=this.Th,r=this.Vc;return t.set(-i.x*r+.5*n.width,-i.y*r+.5*n.height),t},n.prototype.deleteTile=function(t,n,i){var r=t.tx,e=t.ty;(r<this.tf||this.nf<r||e<this.if||this.rf<e)&&(i.delete(n),t.destroy())},n.prototype.destroy=function(){var t=this.$c;t.forEach(this.uf),t.clear()},n.prototype.destroyTile=function(t){t.destroy()},n.prototype.updateLoadingState=function(){this.hf=!0,this.$c.forEach(this.sf)},n.prototype.onLoaded=function(){this.Jc?this.Yc():this.Kc=!0},Object.defineProperty(n.prototype,"loaded",{get:function(){return this.hf||this.updateLoadingState(),this.hf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mapping",{get:function(){return this.Th},set:function(t){var i=this,r=this.ya,e=t.scale*this.cf,u=r.getTileSize()*t.scale;this.ff=e,this.Vc=u,this.Th=t;var s=n.WORK;this.toOffset(s);var h=s.x,o=s.y;this.$c.forEach((function(t){i.toTilePosition(t.tx,t.ty,h,o,s),t.transform(s.x,s.y,e)}))},enumerable:!1,configurable:!0}),n.WORK=new t.Point,n}(),hb=function(n){function i(t){var i=n.call(this)||this,r=i.Vi=t.canvas;i.Ns=t.builder;var e=i.Th=t.mapping,u=i.ya=t.coordinate;i.lf=i.toMapping(r,e,u),i._z=NaN,i.qc=NaN,i.vf=t.plane.min,i.bf=t.plane.max,i.gf=[],i.Zc=function(){i.onLoaded()},i.df=function(){i.mf=void 0,i.fit()},i.wf=t.plane.throttle;var s=i.pf=function(){i.fitThrottled()};return r.on("scale",s),r.on("move",s),r.addRenderable(i,!0),i}return y(i,n),Object.defineProperty(i.prototype,"coordinate",{get:function(){return this.ya},enumerable:!1,configurable:!0}),i.prototype.fitThrottled=function(){null==this.mf&&(this.mf=window.setTimeout(this.df,this.wf))},i.prototype.toMapping=function(t,n,r){var e=i.WORK_LONLAT,u=r.getTileSize();e.set(n.from.lon,n.from.lat),r.lonLatToPixels(e,0,u,e);var s=e.x,h=e.y;e.set(n.to.lon,n.to.lat),r.lonLatToPixels(e,0,u,e);var o=e.x,a=e.y,c=Math.abs(o-s),f=Math.abs(a-h),l=1e-7,v=1;return l<c?v=l<f?Math.max(t.width/c,t.height/f):t.width/c:l<f&&(v=t.height/f),{scale:v,x:.5*(o+s)/u,y:.5*(a+h)/u}},Object.defineProperty(i.prototype,"mapping",{get:function(){return this.Th},set:function(t){var n=this.lf,i=this.toMapping(this.Vi,t,this.ya),r=1e-7;if(r<Math.abs(n.scale-i.scale)||r<Math.abs(n.x-i.x)||r<Math.abs(n.y-i.y)){this.lf=i;for(var e=this.gf,u=0,s=e.length;u<s;++u){var h=e[u];h&&(h.mapping=i)}B.update(this.Vi),this.pf()}},enumerable:!1,configurable:!0}),i.prototype.newPlane=function(t){return new sb(this.Vi,this.Ns,t,this.lf,this.ya,this.Zc)},i.prototype.render=function(t){for(var n=this.qc,i=this.gf,r=0;r<n;++r)null!=(e=i[r])&&e.render(t);for(r=i.length-1;n<r;--r){var e;null!=(e=i[r])&&e.render(t)}var u=i[n];null!=u&&u.render(t)},i.prototype.toTileZ=function(t){return Math.min(this.bf,Math.max(this.vf,Math.floor(t)))},i.prototype.updateTransform=function(){},i.prototype.toZ=function(t){return Math.log(this.lf.scale*t)/Math.log(2)},i.prototype.move=function(t,n,i,r,e){var u=this.gf,s=this.toZ(t);if(this._z!==s){this._z=s;var h=this.toTileZ(s);if(this.qc!==h){this.qc=h;var o=u[h];null==o&&(o=this.newPlane(h),u[h]=o)}}var a=u[this.qc];return null!=a&&a.move(n,i,r,e),this},i.prototype.fit=function(){var t=this.Vi;if(null!=t){var n=t.parent;if(null!=n){var r=t.scale,e=r.x,u=r.y,s=t.x,h=t.y,o=this.ya,a=this.lf,c=o.getTileSize()*a.scale,f=a.x*c-(s/e+.5*t.width),l=f+n.width/e,v=a.y*c-(h/u+.5*t.height),b=v+n.height/u,g=i.WORK_LONLAT;g.set(f,v),o.pixelsToLonLat(g,0,c,g);var d=g.x,m=g.y;g.set(l,b),o.pixelsToLonLat(g,0,c,g);var w=g.x,p=g.y;this.move(e,d,m,w,p)}}return this},i.prototype.destroyPlanesBefore=function(t,n){for(var i=0;i<t;++i){var r=n[i];r&&(r.destroy(),n[i]=void 0)}},i.prototype.destroyPlanesAfter=function(t,n){for(var i=t+1,r=n.length;i<r;++i){var e=n[i];e&&(e.destroy(),n[i]=void 0)}},i.prototype.cleanup=function(){var t=this.qc,n=this.gf,i=n[t];if(i&&i.loaded)return this.destroyPlanesBefore(t,n),void this.destroyPlanesAfter(t,n);for(var r=t+1,e=n.length;r<e;++r)if((u=n[r])&&u.loaded)return this.destroyPlanesBefore(t,n),void this.destroyPlanesAfter(r,n);for(r=t-1;0<=r;--r){var u;if((u=n[r])&&u.loaded)return void this.destroyPlanesBefore(r,n)}},i.prototype.onLoaded=function(){this.cleanup(),B.update(this.Vi)},i.prototype.destroy=function(){for(var t=this.gf,n=0,i=t.length;n<i;++n){var r=t[n];r&&(r.destroy(),t[n]=void 0)}var e=this.Vi,u=this.pf;return e.off("scale",u),e.off("move",u),e.removeRenderable(this,!0),this},i.WORK_LONLAT=new t.Point,i}(t.utils.EventEmitter),ob=function(t,n,i){return"https://j.tile.openstreetmap.jp/"+t+"/"+n+"/"+i+".png"},ab=function(){function t(){}return t.toPlaneOptions=function(t){var n=t.plane;return n?{min:null!=n.min?n.min:this.MIN,max:null!=n.max?n.max:this.MAX,throttle:null!=n.throttle?n.throttle:this.THROTTLE}:{min:this.MIN,max:this.MAX,throttle:this.THROTTLE}},t.from=function(t){return new hb({canvas:t.canvas,builder:t.builder||ob,mapping:t.canvas.tile.mapping,coordinate:t.coordinate||eb.DEFAULT,plane:this.toPlaneOptions(t)})},t.MIN=0,t.MAX=18,t.THROTTLE=333,t}(),cb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.ls=this.toMenu(this.theme,n),this.ls.on("select",(function(t,n,r){i.onMenuSelect(t,n,r)}))},n.prototype.toMenu=function(t,n){var i=null==n?void 0:n.menu;return i instanceof Zv?i:new Zv(this.toMenuOptions(t,i))},n.prototype.newMenu=function(t,n){return new Zv(this.toMenuOptions(t,n))},n.prototype.toMenuOptions=function(t,n){return null==(n=n||{}).fit&&(n.fit=!1),n},n.prototype.onActivate=function(n){t.prototype.onActivate.call(this,n),this.open()},n.prototype.open=function(){this.ls.open(this)},n.prototype.close=function(){this.ls.close()},Object.defineProperty(n.prototype,"menu",{get:function(){return this.ls},enumerable:!1,configurable:!0}),n.prototype.onMenuSelect=function(t,n,i){var r;null===(r=this.parent)||void 0===r||r.emit("select",t,n,i)},n.prototype.onKeyDown=function(n){return this.state.isActionable&&this.state.isFocused&&pt.isArrowDownKey(n)&&this.onActivate(n),t.prototype.onKeyDown.call(this,n)},n.prototype.getType=function(){return"DMenuBarItem"},n}(vr),fb=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(i){n.prototype.init.call(this,i),this.state.isFocusRoot=!0;var r=null==i?void 0:i.items;if(null!=r)for(var e=0,u=r.length;e<u;++e){var s=r[e],h=s instanceof t.DisplayObject?s:"space"in s?new Dr(s):new cb(s);this.addChild(h)}},i.prototype.onKeyDown=function(t){return pt.moveFocusHorizontally(t,this),n.prototype.onKeyDown.call(this,t)},i.prototype.getType=function(){return"DMenuBar"},i}(Sr),lb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.state.isFocusable=!1},n.prototype.initReflowable=function(){},n.prototype.getType=function(){return"DMenuSidedContent"},n}(Sr);!function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.SINGLE_ONCE=2]="SINGLE_ONCE",t[t.DEFAULT=2]="DEFAULT"}(qv||(qv={}));var vb,bb=function(){return!0},gb=function(n){function i(t,i){var r=n.call(this)||this;r.Jo=t,r.Of=null,r.Wt=!0,r.Zo=i&&null!=i.mode?mt(i.mode)?qv[i.mode]:i.mode:qv.DEFAULT,r.Df=i&&i.filter||r.getFilterDefault();var e=i&&i.on;if(e)for(var u in e){var s=e[u];s&&r.on(u,s)}return r}return y(i,n),i.prototype.toDirty=function(){this.Wt=!0},i.prototype.update=function(){this.Wt&&(this.Wt=!1,this.Rr(this.Jo))},i.prototype.hasMenu=function(t){return t&&t.menu instanceof Zv},i.prototype.Rr=function(n){for(var i=n.children,r=0,e=i.length;r<e;++r){var u=i[r];u instanceof Yo&&u.state.isActive&&this.Ef(u,!1),u instanceof t.Container&&this.Rr(u),this.hasMenu(u)&&this.Rr(u.menu)}},i.prototype.add=function(t){this.update(),this.Ef(t,!0)},i.prototype.set=function(t){this.update(),this.Ef(t,!0)},i.prototype.get=function(){return this.update(),this.Of},i.prototype.size=function(){return this.Of?1:0},i.prototype.isEmpty=function(){return null==this.Of},i.prototype.remove=function(t){this.update(),this.Of===t&&this.Ef(null,!0)},i.prototype.clear=function(){this.update(),this.Ef(null,!0)},i.prototype.getFilterDefault=function(){return bb},i.prototype.Ef=function(t,n){var i=this.Of,r=this.Zo;r!==qv.NONE&&this.Df(t)&&i!==t&&(this.setState(i,r,!1),this.Of=t,this.setState(t,r,!0),n&&this.emit("change",this))},i.prototype.setState=function(t,n,i){t&&(n===qv.SINGLE?t.state.isActive=i:t.state.set(x.ACTIVE|x.READ_ONLY,i))},i}(t.utils.EventEmitter),db=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=new Jv(this);this.hh=i,i.add(this);var r=n&&n.items;if(null!=r){var e=!(!n||null==n.sticky)&&n.sticky;this.newItems(r,e)}var u=n&&n.selection;this.ia=u instanceof gb?u:this.newSelection(u)},n.prototype.newSelection=function(t){return new gb(this.Jo,t)},n.prototype.onChildrenDirty=function(){var n=this.ia;null!=n&&n.toDirty(),t.prototype.onChildrenDirty.call(this)},n.prototype.newItems=function(t,n){Aa.newItems(this.Jo,t,n)},n.prototype.newContent=function(t){return new lb(t)},Object.defineProperty(n.prototype,"selection",{get:function(){return this.ia},enumerable:!1,configurable:!0}),n.prototype.getContext=function(){return this.hh},n.prototype.getCloseable=function(){return this},n.prototype.open=function(){},n.prototype.close=function(){},n.prototype.onKeyDown=function(n){return pt.moveFocusVertically(n,this),t.prototype.onKeyDown.call(this,n)},n.prototype.getType=function(){return"DMenuSided"},n}(nl),mb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n}(li),wb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DPaginationDotsButton"},n}(te),pb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.Mf=new wb({width:n.button.width,visible:!!n.button.dotsLeft}),this.Sf=new wb({width:n.button.width,visible:!!n.button.dotsRight}),this.addChild(this.Mf),this.addChild(this.Sf)},n.prototype.update=function(t){var n=this;if(null!=t.start&&null!=t.end){var i=t.end-t.start+1>0?t.end-t.start+1:0,r=this.children.slice(1,this.children.length-1);if(r.length<i){for(var e=r.length;e<i;e++){var u=new vr({width:t.button.width});this.addChildAt(u,this.children.length-1),u.on("active",(function(t){n.emit("active",t)}))}r=this.children.slice(1,this.children.length-1)}else if(r.length>i)for(e=i;e<r.length;e++)r[e].hide();for(e=0;e<i;e++)(u=r[e]).text=t.start+e+1,u.state.isActive=t.start+e===t.selected,u.isHidden()&&u.show();t.button.dotsLeft?this.Mf.show():this.Mf.hide(),t.button.dotsRight?this.Sf.show():this.Sf.hide()}},n.prototype.getType=function(){return"DPaginationDynamicButtons"},n}(Sr),Ob=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DPaginationNavigationButton"},n}(te),Db=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.DEFAULT_SELECTED=0,this.Tf=n.total,this.uo=n.selected?n.selected:this.DEFAULT_SELECTED,this.jf={first:!(!n.button||!n.button.first),last:!(!n.button||!n.button.last),width:n.button&&n.button.width},this.initButtons(this.getButtonWidth()),this.listenButtonClicked(),this.on("resize",(function(){i.Nf=i.toNumberVisible(),i.update()}))},Object.defineProperty(n.prototype,"selected",{get:function(){return this.uo},set:function(t){(t<0||t>=this.Tf||!Number.isInteger(t))&&(t=this.DEFAULT_SELECTED),this.uo=t,this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"total",{get:function(){return this.Tf},set:function(t){t>=0&&Number.isInteger(t)&&(this.Tf=t,this.Nf=this.toNumberVisible(),this.selected=this.uo,this.If.text=this.Tf,this.update())},enumerable:!1,configurable:!0}),n.prototype.initButtons=function(t){this.Cf=new Ob({width:t,image:{source:Z.getInstance().getAtlas().mappings.pagination_navigation_button_previous}}),this.Af=new Ob({width:t,image:{source:Z.getInstance().getAtlas().mappings.pagination_navigation_button_next}}),this.Rf=new Ob({width:t,image:{source:Z.getInstance().getAtlas().mappings.pagination_navigation_button_go_first},visible:this.jf.first}),this.yf=new Ob({width:t,image:{source:Z.getInstance().getAtlas().mappings.pagination_navigation_button_go_last},visible:this.jf.last}),this.kf=new pb({button:{width:t}}),this.xf=new vr({width:t,text:{value:1}}),this.If=new vr({width:t,text:{value:this.Tf}}),this.addChild(this.Rf),this.addChild(this.Cf),this.addChild(this.xf),this.addChild(this.kf),this.addChild(this.If),this.addChild(this.Af),this.addChild(this.yf)},n.prototype.listenButtonClicked=function(){var t=this;this.xf.on("active",(function(n){t.onClickPageButton(n)})),this.If.on("active",(function(n){t.onClickPageButton(n)})),this.kf.on("active",(function(n){t.onClickPageButton(n)})),this.Rf.on("active",(function(n){t.selected=t.DEFAULT_SELECTED})),this.yf.on("active",(function(n){t.selected=t.Tf-1})),this.Af.on("active",(function(n){t.selected!==t.Tf+1&&(t.selected=t.uo+1)})),this.Cf.on("active",(function(n){0!==t.uo&&(t.selected=t.uo-1)}))},n.prototype.update=function(){var t,n,i,r,e=0,u=0;this.updateStaticButtons();var s=Math.ceil(.5*(this.Nf-1)),h=Math.floor(.5*(this.Nf-1));this.uo<s?(e=this.uo,u=this.Nf-e-1):this.uo+h>this.Tf-1?(u=this.Tf-1-this.selected,e=this.Nf-u-1):(e=s,u=h),this.uo<=e?(t=1,i=!1):(t=this.uo-e+2,i=!0),this.uo+u>=this.Tf-1?(n=this.Tf-2,r=!1):(n=this.uo+u-2,r=!0),this.kf.update({start:t,end:n,selected:this.uo,button:{width:this.getButtonWidth(),dotsLeft:i,dotsRight:r}})},n.prototype.updateStaticButtons=function(){this.Tf>0?this.xf.show():this.xf.hide(),this.Tf>1?this.If.show():this.If.hide();var t=this.uo===this.DEFAULT_SELECTED,n=this.uo===this.Tf-1||0===this.Tf;this.xf.state.isActive=t,this.If.state.isActive=n,this.Rf.state.isDisabled=t,this.Cf.state.isDisabled=t,this.Af.state.isDisabled=n,this.yf.state.isDisabled=n},n.prototype.getButtonWidth=function(){return this.jf.width?this.jf.width:this.theme.getButtonWidth()},n.prototype.toNumberVisible=function(){var t=2;this.jf.first&&t++,this.jf.last&&t++;var n=t*(this.getButtonWidth()+2*this.Pr.horizontal),i=this.width-n,r=Math.floor(i/(this.getButtonWidth()+2*this.Pr.horizontal));return Math.min(this.Tf,Math.max(r,5))},n.prototype.onClickPageButton=function(t){var n=Number(t.text)-1;this.uo!==n&&(this.uo=n,this.update())},n.prototype.getType=function(){return"DPagination"},n}(Sr),Eb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n}(li),Mb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n}(li),Sb=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Lf=function(t,n){if(n instanceof Zo){var r=i.v,e=[],u=[],s=i.menu;n.state.isActive?i.updateMenuItems(s,r,t,void 0,e,u):i.updateMenuItems(s,r,void 0,t,e,u),i.v=e,i.onSelected(e,r,u,!0)}else i.emit("menuselect",t,n,i)},this.Bf=function(){i.onClosed()},this.v=[],n&&void 0!==n.values&&(this.values=n.values)},n.prototype.onSelected=function(t,n,i,r){this.text=i,r&&this.emit("change",t,n,i,this)},n.prototype.onClosed=function(){var t=this.menu;t.off("select",this.Lf),t.off("close",this.Bf)},n.prototype.start=function(){var n=this.menu;n.on("select",this.Lf),n.on("close",this.Bf),this.updateMenuItems(n,this.v),t.prototype.start.call(this)},Object.defineProperty(n.prototype,"values",{get:function(){return this.v},set:function(t){var n=this.v;if(!this.isSameValues(t,n)){var i=[],r=[];this.updateMenuItems(this.menu,t,void 0,void 0,i,r),this.v=i,this.onSelected(i,n,r,!1)}},enumerable:!1,configurable:!0}),n.prototype.isSameValues=function(t,n){if(t.length===n.length)for(var i=0,r=t.length;i<r;++i)if(n.indexOf(t[i])<0)return!1;return!1},n.prototype.updateMenuItems=function(t,n,i,r,e,u){for(var s=t.children,h=0,o=s.length;h<o;++h){var a=s[h];if(a instanceof oa)this.updateMenuItems(a.menu,n,i,r,e,u);else if(a instanceof Zo){var c=a.value;void 0!==r&&r===c?a.state.isActive=!1:void 0!==i&&a.value===i||0<=n.indexOf(a.value)?(e&&e.push(a.value),u&&u.push(a),a.state.isActive=!0):a.state.isActive=!1}}},n.prototype.getType=function(){return"DSelectMultiple"},n}($v),Tb=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Lf=function(t,n){i.onSelected(t,n,!0)},this.Bf=function(){i.onClosed()},this.gt=null,n&&void 0!==n.value&&(this.value=n.value)},n.prototype.onSelected=function(t,n,i){if(this.gt!==t){var r=this.gt;this.gt=t,this.text=n,i&&this.emit("change",t,r,n,this)}},n.prototype.onClosed=function(){var t=this.menu;t.off("select",this.Lf),t.off("close",this.Bf)},n.prototype.start=function(){var n=this.menu;n.on("select",this.Lf),n.on("close",this.Bf),t.prototype.start.call(this)},n.prototype.findMenuItem=function(t,n){for(var i=t.children,r=0,e=i.length;r<e;++r){var u=i[r];if(u instanceof oa){var s=this.findMenuItem(u.menu,n);if(null!=s)return s}else if(u instanceof Ko&&u.value===n)return u}return null},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},set:function(t){var n=this.findMenuItem(this.menu,t);null!=n?this.onSelected(t,n,!1):this.onSelected(null,null,!1)},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DSelect"},n}($v),jb=function(t){function n(n,i,r,e,u){var s=t.call(this,n,i,r,i,r)||this;return s._f=e,s.Pf=u,s.ae=.5*i,s.ce=.5*r,s.interactive=!1,s.interactiveChildren=!1,n.on("update",(function(){s.onTextureUpdate()})),s}return y(n,t),n.prototype.onTextureUpdate=function(){this.emit("update",this)},n.prototype.onReflow=function(t,n,i){var r=this.ae,e=this.ce;this.x=-r+this._f,this.y=-e+this.Pf,this.width=r+n+r,this.height=e+i+e},n}(t.NineSlicePlane),Nb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.state.isFocusable=!1,this.gt=n&&n.value||0},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},set:function(t){this.gt=t},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DSliderLabel"},n}(cr),Ib=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DSliderThumb"},n}(vr),Cb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.state.isFocusable=!1,this.gt=n&&n.value||0,this.Ff=this.toRounder(n)},n.prototype.toRounder=function(t){var n=t&&t.rounder;if(n)return n;var i=t&&t.precision?t.precision:this.theme.getPrecision();return function(t){var n=Math.pow(10,i);return Math.round(t*n)/n}},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},set:function(t){this.gt=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rounder",{get:function(){return this.Ff},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DSliderValue"},n}(cr),Ab=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Uf=0,this.zf=this.newTrack(n),this.addChild(this.zf),this.Gf=this.newTrackSelected(n),this.Gf.state.isActive=!0,this.addChild(this.Gf),this.Qo=this.newThumb(n),this.addChild(this.Qo),this.fu=this.newLabelMin(n),this.addChild(this.fu),this.lu=this.newLabelMax(n),this.addChild(this.lu),this.gt=this.newValue(n),this.addChild(this.gt),this.zf.on(ai.down,(function(t){i.gt.visible=i.state.inEnabled,i.onTrackDown(t.data.global)})),this.Gf.on(ai.down,(function(t){i.gt.visible=i.state.inEnabled,i.onTrackSelectedDown(t.data.global)})),this.Hf=function(t){i.onTrackUpBound(t),i.gt.visible=!1},this.Vf=function(t){i.onTrackSelectedUpBound(t),i.gt.visible=!1},this.Qo.on(ai.down,(function(t){i.gt.visible=!0,i.onThumbDown(t)})),this.Wf=function(t){i.onThumbMove(t)},this.Xf=function(t){i.onThumbUp(t),i.gt.visible=!1},this.onValuesChanged()},n.prototype.newThumb=function(t){return new Ib(t&&t.thumb)},n.prototype.newValue=function(t){return new Cb(this.toValueOptions(t&&t.value))},n.prototype.toValueOptions=function(t){null==(t=t||{}).value&&(t.value=0);var n=t.text=t.text||{};return null==n.value&&(n.value=t.value),null==t.visible&&(t.visible=!1),t},n.prototype.newLabelMin=function(t){return new Nb(this.toLabelMinOptions(t&&t.min))},n.prototype.toLabelMinOptions=function(t){null==(t=t||{}).value&&(t.value=0);var n=t.text=t.text||{};return null==n.value&&(n.value=""+t.value),t},n.prototype.newLabelMax=function(t){return new Nb(this.toLabelMaxOptions(t&&t.max))},n.prototype.toLabelMaxOptions=function(t){null==(t=t||{}).value&&(t.value=1);var n=t.text=t.text||{};return null==n.value&&(n.value=""+t.value),t},n.prototype.getValueMargin=function(){return 14},n.prototype.onTrackDown=function(t){if(!this.state.inDisabled){var n=B.getLayer(this);if(n){var i=n.renderer.plugins.interaction;this.ti=i,i.on(ai.up,this.Hf)}this.onPick(t)}},n.prototype.onTrackSelectedDown=function(t){if(!this.state.inDisabled){var n=B.getLayer(this);if(n){var i=n.renderer.plugins.interaction;this.ti=i,i.on(ai.up,this.Vf)}this.onPick(t)}},n.prototype.onTrackUpBound=function(t){var n=this.ti;n&&(this.ti=void 0,n.off(ai.up,this.Hf))},n.prototype.onTrackSelectedUpBound=function(t){var n=this.ti;n&&(this.ti=void 0,n.off(ai.up,this.Vf))},n.prototype.onThumbMove=function(t){this.state.inDisabled||this.onPick(t.data.global)},n.prototype.onThumbDown=function(t){var n=B.getLayer(this);if(n){var i=n.renderer.plugins.interaction;this.ti=i,i.on(ai.move,this.Wf),i.on(ai.up,this.Xf)}},n.prototype.onThumbUp=function(t){var n=this.ti;n&&(this.ti=void 0,n.off(ai.move,this.Wf),n.off(ai.up,this.Xf))},n.prototype.updateValue=function(){var t=this.fu.value,n=this.lu.value,i=this.gt,r=i.rounder(t+this.Uf*(n-t)),e=i.value;r!==e&&(i.value=r,i.text=i.value,this.emit("change",r,e,this))},n.prototype.onResize=function(n,i,r,e){t.prototype.onResize.call(this,n,i,r,e),this.onValuesChanged()},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt.value},set:function(t){t=Math.max(this.fu.value,Math.min(this.lu.value,t)),this.gt.value!==t&&(this.gt.value=t,this.onValuesChanged())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"min",{get:function(){return this.fu.value},set:function(t){var n=this.fu;if(t=Math.min(this.lu.value,t),n.value!==t){var i=this.gt;n.text=n.value=t,i.value=Math.max(t,i.value),this.onValuesChanged()}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"max",{get:function(){return this.lu.value},set:function(t){var n=this.lu;if(t=Math.max(this.fu.value,t),n.value!==t){var i=this.gt;n.text=n.value=t,i.value=Math.min(t,i.value),this.onValuesChanged()}},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DSlider"},n}(li),Rb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DSliderTrack"},n}(vr),yb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DSliderTrackHorizontal"},n}(Rb),kb=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.newTrack=function(t){return new yb(t&&t.track)},i.prototype.newTrackSelected=function(t){return new yb(t&&t.track)},i.prototype.toValueOptions=function(t){var i=this;return null==(t=n.prototype.toValueOptions.call(this,t)).y&&(t.y=function(t,n){return.5*t-n-i.getValueMargin()}),t},i.prototype.toLabelMinOptions=function(t){return null==(t=n.prototype.toLabelMinOptions.call(this,t)).x&&(t.x=function(t,n){return.5*-n}),null==t.y&&(t.y=function(t,n){return-n}),t},i.prototype.toLabelMaxOptions=function(t){return null==(t=n.prototype.toLabelMaxOptions.call(this,t)).x&&(t.x=function(t,n){return t-.5*n}),null==t.y&&(t.y=function(t,n){return-n}),t},i.prototype.onPick=function(n){var i=new t.Point(0,0);this.toLocal(n,void 0,i);var r=Math.max(0,Math.min(this.zf.width,i.x));this.Uf=r/this.zf.width,this.moveThumbPosition(r)},i.prototype.onValuesChanged=function(){var t=this.fu.value,n=this.lu.value,i=this.gt.value;this.Uf=(i-t)/(n-t);var r=this.Uf*this.zf.width;this.moveThumbPosition(r)},i.prototype.moveThumbPosition=function(t){var n=this.Qo;n.x=t-.5*n.width,this.Gf.width=t;var i=this.gt;i.x=t-.5*i.width,this.updateValue()},i.prototype.toThumbCoordinate=function(t){return t-.5*this.Qo.width},i.prototype.getType=function(){return"DSliderHorizontal"},i}(Ab),xb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DSliderTrackVertical"},n}(Rb),Lb=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.newTrack=function(t){return new xb(t&&t.track)},i.prototype.newTrackSelected=function(t){return new xb(t&&t.track)},i.prototype.toLabelMinOptions=function(t){null==(t=n.prototype.toLabelMinOptions.call(this,t)).x&&(t.x=function(t,n){return-n}),null==t.y&&(t.y=function(t,n){return t-.5*n});var i=t.text=t.text||{},r=i.align=i.align||{};return null==r.horizontal&&(r.horizontal=Ji.RIGHT),t},i.prototype.toLabelMaxOptions=function(t){null==(t=n.prototype.toLabelMaxOptions.call(this,t)).x&&(t.x=function(t,n){return-n}),null==t.y&&(t.y=function(t,n){return.5*-n});var i=t.text=t.text||{},r=i.align=i.align||{};return null==r.horizontal&&(r.horizontal=Ji.RIGHT),t},i.prototype.onPick=function(n){var i=new t.Point(0,0);this.toLocal(n,void 0,i);var r=this.height,e=Math.max(0,Math.min(r,i.y));this.Uf=(r-e)/r,this.moveThumbPosition(e)},i.prototype.onValuesChanged=function(){var t=this.fu.value,n=this.lu.value,i=this.gt.value;this.Uf=(i-t)/(n-t);var r=this.height*(1-this.Uf);this.moveThumbPosition(r)},i.prototype.moveThumbPosition=function(t){var n=this.Qo;n.y=t-.5*n.height;var i=this.Gf;i.y=t,i.height=this.height-t;var r=this.gt;r.y=t-r.height-this.getValueMargin(),this.updateValue()},i.prototype.getType=function(){return"DSliderVertical"},i}(Ab),Bb=function(){function t(){}return t.setReadOnly=function(t,n,i,r){t.state.isReadOnly=this.toReadOnly(n,i,r)},t.setRenderable=function(t,n,i,r){var e=this.toRenderable(n,i,r);t.renderable=e,t.state.isDisabled=!e},t.toReadOnly=function(t,n,i){var r=i.editing.enable;return!0!==r&&(!1===r||!r(t,n))},t.toRenderable=function(t,n,i){var r=i.renderable;return!0===r||!1!==r&&r(t,n)},t}(),_b=function(t){function n(n,i,r){var e=t.call(this,r)||this;e.Yf=-1,e.Kf=n,e.Jf=i;var u=e.toSync(e.theme,r),s=i.selecting,h=s.dialog;return null!=h&&e.on("active",(function(){s.setter(h,e.text),h.open().then((function(){var t=s.getter(h);if(u){var n=e.text;t!==n&&(e.text=t,e.onCellChange(t,n))}else e.onCellChange(t,null)}))})),e}return y(n,t),n.prototype.onCellChange=function(t,n){var i=this.Zf;if(void 0!==i){var r=this.Yf,e=this.Kf;this.Jf.setter(i,e,t),this.emit("cellchange",t,n,i,r,e,this)}},n.prototype.toSync=function(t,n){return n&&null!=n.sync?n.sync:t.isSyncEnabled()},Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.Xr},set:function(t){this.text=t},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,u?(this.Wr=t,this.Xr=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellSelectDialog"},n}(vr),Pb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DTableBodyCellActionDialog"},n}(_b),Fb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.Lf=function(t){e.onSelected(t)},e.Bf=function(){e.onClosed()},e}return y(n,t),n.prototype.onSelected=function(t){var n=this.Jf,i=this.Zf;if(void 0!==i){var r=this.Yf,e=this.Kf;n.setter(i,e,t),this.emit("cellchange",t,null,i,r,e,this)}},n.prototype.onClosed=function(){var t=this.menu;t.off("select",this.Lf),t.off("close",this.Bf)},n.prototype.start=function(){var n=this.menu;n.on("select",this.Lf),n.on("close",this.Bf),t.prototype.start.call(this)},Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.text=t;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellActionMenu"},n}(Qv),Ub=function(t){function n(n,i,r){var e=t.call(this,r)||this;e.Yf=-1,e.Kf=n,e.Jf=i;var u=e.toSync(e.theme,r),s=i.selecting.promise;return null!=s&&e.on("active",(function(){s().then((function(t){if(u){var n=e.text;t!==n&&(e.text=t,e.onCellChange(t,n))}else e.onCellChange(t,null)}))})),e}return y(n,t),n.prototype.onCellChange=function(t,n){var i=this.Zf;if(void 0!==i){var r=this.Yf,e=this.Kf;this.Jf.setter(i,e,t),this.emit("cellchange",t,n,i,r,e,this)}},n.prototype.toSync=function(t,n){return n&&null!=n.sync?n.sync:t.isSyncEnabled()},Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.Xr},set:function(t){this.text=t},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,u?(this.Wr=t,this.Xr=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellSelectPromise"},n}(vr),zb=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DTableBodyCellActionPromise"},n}(Ub),Gb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.text=t;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellText"},n}(fr),Hb=function(t){function n(n,i,r){var e=t.call(this,n,i,r)||this;return e.buttonMode=!0,e.initOnClick(r),e}return y(n,t),n.prototype.initOnClick=function(t){var n=this;ai.onClick(this,(function(t){n.state.isActionable&&n.onActive(t)}))},n.prototype.onActive=function(t){this.emit("active",this);var n=this.Zf;if(void 0!==n){var i=this.Yf,r=this.Kf;this.Jf.setter(n,r,null),this.emit("cellchange",null,null,n,i,r,this)}},n.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this.state.isPressed=!0)},n.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this.state.isPressed&&this.onActive(t),this.state.isPressed=!1)},n.prototype.onKeyDown=function(n){return pt.isActivateKey(n)&&this.onActivateKeyDown(n),t.prototype.onKeyDown.call(this,n)},n.prototype.onKeyUp=function(n){return pt.isActivateKey(n)&&this.onActivateKeyUp(n),t.prototype.onKeyUp.call(this,n)},n.prototype.onStateChange=function(n,i){t.prototype.onStateChange.call(this,n,i),this.buttonMode=n.isActionable},n.prototype.getType=function(){return"DTableBodyCellButton"},n}(Gb);!function(t){t[t.INDEX=0]="INDEX",t[t.TEXT=1]="TEXT",t[t.INTEGER=2]="INTEGER",t[t.REAL=3]="REAL",t[t.CHECK=4]="CHECK",t[t.CHECK_SINGLE=5]="CHECK_SINGLE",t[t.COLOR=6]="COLOR",t[t.BUTTON=7]="BUTTON",t[t.SELECT=8]="SELECT",t[t.DATE=9]="DATE",t[t.DATETIME=10]="DATETIME",t[t.TIME=11]="TIME",t[t.ACTION=12]="ACTION",t[t.LINK=13]="LINK",t[t.TREE=14]="TREE"}(vb||(vb={}));var Vb,Wb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("active",(function(){e.onChange(!0)})),e.on("inactive",(function(){e.onChange(!1)})),e}return y(n,t),n.prototype.onChangeSingle=function(t,n,i){var r=this,e=this.parent;if(e){var u=e.parent;if(u){var s=!1,h=i.getter,o=i.setter;u.data.each((function(i,e){return t===e||!h(i,n)||(o(i,n,!1),s=!0,r.emit("cellchange",!1,!0,i,e,n,r),!1)})),s&&u.update(!0)}}},n.prototype.onChange=function(t){var n=this.Zf;if(void 0!==n){var i=this.Yf,r=this.Kf,e=this.Jf;e.setter(n,r,t),this.emit("cellchange",t,!t,n,i,r,this),t&&e.type===vb.CHECK_SINGLE&&this.onChangeSingle(i,r,e)}},Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.state.isActive=!!t;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellCheck"},n}(of),Xb=function(t){return{color:t.color,alpha:t.alpha}},Yb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("change",(function(t,i){var r=e.Zf;if(void 0!==r){var u=Xb(t),s=Xb(i),h=e.Yf;e.Jf.setter(r,n,u),e.emit("cellchange",u,s,r,h,n,e)}})),e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r;var s=this.gt;if(F(t))s.color=t,s.alpha=1;else if(mt(t)){var h=Number(t);s.color=h==h?h:16777215,s.alpha=1}else null!=t?(function(t){return"color"in t}(t)?s.color=Number(t.color):s.color=16777215,function(t){return"alpha"in t}(t)?s.alpha=Number(t.alpha):s.alpha=1):(s.color=16777215,s.alpha=1);var o=this.Jf;Bb.setReadOnly(this,n,e,o),Bb.setRenderable(this,n,e,o)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellColor"},n}(Nf),Kb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("active",(function(){var t=e.Xr.getTime(),i=e.dialog;i.current=new Date(t),i.new=new Date(t),i.page=new Date(t),i.open().then((function(){var t=i.new,r=i.current;e.text=new Date(t.getTime());var u=e.Zf;if(void 0!==u){var s=e.Yf;e.Jf.setter(u,n,t),e.emit("cellchange",t,r,u,s,n,e)}}))})),e}return y(n,t),Object.defineProperty(n.prototype,"dialog",{get:function(){var t,n=this.Xo;if(null==n){var i=null===(t=this.vn)||void 0===t?void 0:t.dialog;n=i?new Me(i):Cf.getInstance(),this.Xo=n}return n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){if(this.Zf=n,this.Yf=r,t instanceof Date)u?(this.Wr=t,this.Xr=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;else if(F(t)){var s=this.Xr;s.getTime()!==t&&(s.setTime(t),this.onTextChange(),this.createOrUpdateText())}var h=this.Jf;Bb.setReadOnly(this,n,e,h),Bb.setRenderable(this,n,e,h)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellDate"},n}(vr),Jb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("active",(function(){var t=e.Xr.getTime(),i=e.dialog;i.current=new Date(t),i.new=new Date(t),i.page=new Date(t),i.open().then((function(){var t=i.new,r=i.current;e.text=new Date(t.getTime());var u=e.Zf;if(void 0!==u){var s=e.Yf;e.Jf.setter(u,n,t),e.emit("cellchange",t,r,u,s,n,e)}}))})),e}return y(n,t),n.prototype.getDatetimeMask=function(){var t,n,i=this.Yo;return null==i&&(i=xf.toMask(null===(n=null===(t=this.vn)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.picker),this.Yo=i),i},Object.defineProperty(n.prototype,"dialog",{get:function(){var t,n=this.Xo;if(null==n){var i=null===(t=this.vn)||void 0===t?void 0:t.dialog;n=null!=i?new me(i):Rf.getInstance(),this.Xo=n}return n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){if(this.Zf=n,this.Yf=r,t instanceof Date)u?(this.Wr=t,this.Xr=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;else if(F(t)){var s=this.Xr;s.getTime()!==t&&(s.setTime(t),this.onTextChange(),this.createOrUpdateText())}var h=this.Jf;Bb.setReadOnly(this,n,e,h),Bb.setRenderable(this,n,e,h)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellDatetime"},n}(vr),Zb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.text=r;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellIndex"},n}(fr),qb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("change",(function(t,i){var r=e.Zf;if(void 0!==r){var u=e.Yf;e.Jf.setter(r,n,t),e.emit("cellchange",t,i,r,u,n,e)}})),e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.text=Number(t);var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellInputInteger"},n}(zr),$b=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("change",(function(t,i){var r=e.Zf;if(void 0!==r){var u=e.Yf;e.Jf.setter(r,n,t),e.emit("cellchange",t,i,r,u,n,e)}})),e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.text=Number(t);var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellInputReal"},n}(Vr),Qb=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("change",(function(t,i){var r=e.Zf;if(void 0!==r){var u=e.Yf;e.Jf.setter(r,n,t),e.emit("cellchange",t,i,r,u,n,e)}})),e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.text=String(t);var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellInputText"},n}(Yr),tg=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DTableBodyCellInputTreeInput"},n}(Yr),ng=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DTableBodyCellInputTreeMarker"},n}(lr),ig={START:x.CUSTOM,END:2*x.CUSTOM,FROZEN:4*x.CUSTOM,FROZEN_END:8*x.CUSTOM,SORTED_ASCENDING:16*x.CUSTOM,SORTED_DESCENDING:32*x.CUSTOM,NEW_WINDOW:64*x.CUSTOM,HAS_CHILDREN:128*x.CUSTOM,OPENED:256*x.CUSTOM,CHECKABLE:512*x.CUSTOM,CUSTOM:1024*x.CUSTOM},rg=function(t){function n(n,i,r){var e=t.call(this,{weight:r.weight,width:r.width})||this;e.Yf=-1,e.Kf=n,e.Jf=i;var u=new ng({visible:!1,on:{active:function(){e.onMarkerActive()}}});e.hc=u,e.addChild(u);var s=new tg({weight:1,text:r.text,editing:r.editing});return e.Ne=s,s.on("change",(function(t,i){var r=e.Zf;if(void 0!==r){var u=e.Yf;e.Jf.setter(r,n,t),e.emit("cellchange",t,i,r,u,n,e)}})),e.addChild(s),e}return y(n,t),n.prototype.onMarkerActive=function(){if(this.hc.state.is(ig.HAS_CHILDREN)){var t=this.parent;if(t){var n=t.parent;if(n){var i=n.data;i&&i.toggle&&(i.toggle(this.Zf),this.emit("cellchange",null,null,this.Zf,this.Yf,this.Kf,this))}}}},Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.Ne.visible=!0,this.Ne.text=String(t);var s=this.hc;if(F(i)){var h=!!(1&i),o=i>>2;2&i?h?s.state.set(ig.HAS_CHILDREN|ig.OPENED,x.DISABLED):s.state.set(ig.HAS_CHILDREN,x.DISABLED|ig.OPENED):h?s.state.set(x.DISABLED|ig.OPENED,ig.HAS_CHILDREN):s.state.remove(ig.HAS_CHILDREN|ig.OPENED),s.show(),s.width=this.theme.getLevelPadding(o)}else s.state.remove(ig.OPENED|ig.HAS_CHILDREN),s.hide();var a=this.Jf;Bb.setReadOnly(this.Ne,n,e,a),Bb.setRenderable(this,n,e,a)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1,this.Ne.visible=!1,this.hc.hide()},n.prototype.getType=function(){return"DTableBodyCellInputTree"},n}(Sr),eg=function(t,n){if(n)return{url:ug(t,n.url),target:n.target,checker:sg(t,n.checker),menu:n.menu}},ug=function(t,n){return mt(n)||null==n?n:function(){var i=t.row;return void 0!==i?n(i,t.rowIndex,t.columnIndex,t):null}},sg=function(t,n){if(null!=n)return function(){var i=t.row;return void 0!==i&&n(i,t.rowIndex,t.columnIndex,t)}},hg=function(t){function n(n,i,r){return t.call(this,n,i,function(t){var n;return(null===(n=null==t?void 0:t.link)||void 0===n?void 0:n.target)===xu.NEW_WINDOW&&(t.state=t.state||x.NONE||ig.NEW_WINDOW),t}(r))||this}return y(n,t),n.prototype.initOnClick=function(t){var n=this;this.link.apply(this,(function(t){return n.onActive(t)}))},Object.defineProperty(n.prototype,"link",{get:function(){var t,n=this.vs;return null==n&&(n=new ia(this.theme,eg(this,null===(t=this.vn)||void 0===t?void 0:t.link)),this.vs=n),n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"url",{get:function(){return this.link.url},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"menu",{get:function(){return this.link.menu},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DTableBodyCellLink"},n.prototype.onActive=function(t){this.emit("active",this);var n=this.Zf;if(void 0!==n){var i=this.Yf,r=this.Kf;this.Jf.setter(n,r,null),this.emit("cellchange",null,null,n,i,r,this),this.open(this.link.inNewWindow(t))}},n.prototype.open=function(t){this.link.open(t)},n}(Hb),og=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("change",(function(t,i){var r=e.Zf;if(void 0!==r){var u=e.Yf;e.Jf.setter(r,n,t),e.emit("cellchange",t,i,r,u,n,e)}})),e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.value=t;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellSelectMenu"},n}(Tb),ag=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("change",(function(t,i){var r=e.Zf;if(void 0!==r){var u=e.Yf;e.Jf.setter(r,n,t),e.emit("cellchange",t,i,r,u,n,e)}})),e}return y(n,t),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.values=t;var s=this.Jf;Bb.setReadOnly(this,n,e,s),Bb.setRenderable(this,n,e,s)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellSelectMultiple"},n}(Sb),cg=function(){function t(t){this.i=t,this.qf={left:0,top:0,right:0,bottom:0}}return Object.defineProperty(t.prototype,"adjuster",{get:function(){return this.qf},enumerable:!1,configurable:!0}),t.prototype.getTheme=function(){return this.i.getTheme()},t.prototype.setTheme=function(t){this.i.setTheme(t)},t.prototype.getLeft=function(){return this.i.getLeft()+this.qf.left},Object.defineProperty(t.prototype,"left",{get:function(){return this.i.left},set:function(t){this.i.left=t},enumerable:!1,configurable:!0}),t.prototype.getTop=function(){return this.i.getTop()+this.qf.top},Object.defineProperty(t.prototype,"top",{get:function(){return this.i.top},set:function(t){this.i.top=t},enumerable:!1,configurable:!0}),t.prototype.getRight=function(){return this.i.getRight()+this.qf.right},Object.defineProperty(t.prototype,"right",{get:function(){return this.i.right},set:function(t){this.i.right=t},enumerable:!1,configurable:!0}),t.prototype.getBottom=function(){return this.i.getBottom()+this.qf.bottom},Object.defineProperty(t.prototype,"bottom",{get:function(){return this.i.bottom},set:function(t){this.i.bottom=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,n,i,r){this.i.set(t,n,i,r)},t}(),fg=function(t){function n(n,i,r){var e=t.call(this,n,i,function(t){var n;return(null===(n=null==t?void 0:t.link)||void 0===n?void 0:n.target)===xu.NEW_WINDOW&&(t.state=t.state||x.NONE||ig.NEW_WINDOW),t}(r))||this;return e.Mn=new cg(e.Mn),e}return y(n,t),n.prototype.initOnClick=function(n){var i=this,r=this.link;r?(r.apply(this,(function(t){return i.onActive(t)})),ai.onClick(this,(function(t){r.enable&&i.state.isActionable&&i.onActive(t)}))):t.prototype.initOnClick.call(this,n)},Object.defineProperty(n.prototype,"link",{get:function(){var t=this.vs;return void 0===t&&(t=this.newLink(),this.vs=t),t},enumerable:!1,configurable:!0}),n.prototype.newLink=function(){var t,n=null===(t=this.vn)||void 0===t?void 0:t.link;return n?new ia(this.theme,eg(this,n)):null},n.prototype.onActive=function(t){this.emit("active",this);var n=this.Zf;if(void 0!==n){var i=this.Yf,r=this.Kf;this.emit("cellchange",null,null,n,i,r,this);var e=this.link;if(null==e?void 0:e.enable)e.open(e.inNewWindow(t));else{var u=this.parent;if(u){var s=u.parent;if(s){var h=s.data;h&&h.toggle&&h.toggle(n)}}}}},n.prototype.set=function(t,n,i,r,e,u){this.Zf=n,this.Yf=r,this.text=t;var s=this.Jf;Bb.setRenderable(this,n,e,s);var h=this.link,o=this.Mn.adjuster;if(F(i)){var a=!!(1&i),c=i>>2;2&i?(a?this.state.add(ig.HAS_CHILDREN|ig.OPENED):this.state.set(ig.HAS_CHILDREN,ig.OPENED),h&&(h.enable=!0)):(a?this.state.set(ig.OPENED,ig.HAS_CHILDREN):this.state.remove(ig.HAS_CHILDREN|ig.OPENED),h&&(h.enable=!0)),o.left=this.theme.getLevelPadding(c)}else this.state.remove(ig.OPENED|ig.HAS_CHILDREN),o.left=0,h&&(h.enable=!1)},n.prototype.getType=function(){return"DTableBodyCellTree"},n}(Hb),lg=function(t){function n(n,i,r){var e=t.call(this,r)||this;return e.Yf=-1,e.Kf=n,e.Jf=i,e.on("active",(function(){var t=e.Xr.getTime(),i=e.dialog;i.current=new Date(t),i.new=new Date(t),i.open().then((function(){var t=i.new,r=i.current;e.text=new Date(t.getTime());var u=e.Zf;if(void 0!==u){var s=e.Yf;e.Jf.setter(u,n,t),e.emit("cellchange",t,r,u,s,n,e)}}))})),e}return y(n,t),n.prototype.getDatetimeMask=function(){var t,n,i=this.Yo;return null==i&&(i=kf.toMask(null===(n=null===(t=this.vn)||void 0===t?void 0:t.dialog)||void 0===n?void 0:n.picker),this.Yo=i),i},Object.defineProperty(n.prototype,"dialog",{get:function(){var t,i=this.Xo;if(null==i){var r=null===(t=this.vn)||void 0===t?void 0:t.dialog;null!=r?i=new pe(r):(null==n.DIALOG&&(n.DIALOG=new pe),i=n.DIALOG),this.Xo=i}return i},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"row",{get:function(){return this.Zf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rowIndex",{get:function(){return this.Yf},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r,e,u){if(this.Zf=n,this.Yf=r,t instanceof Date)u?(this.Wr=t,this.Xr=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;else if(F(t)){var s=this.Xr;s.getTime()!==t&&(s.setTime(t),this.onTextChange(),this.createOrUpdateText())}var h=this.Jf;Bb.setReadOnly(this,n,e,h),Bb.setRenderable(this,n,e,h)},n.prototype.unset=function(){this.Zf=void 0,this.Yf=-1},n.prototype.getType=function(){return"DTableBodyCellTime"},n}(vr),vg=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){var i;t.prototype.init.call(this,n),n.even&&(this.state.isAlternated=!0),this.state.isFocusReverse=!0,this.xn=!0;for(var r=this.$f=null!==(i=n.frozen)&&void 0!==i?i:0,e=this.Qf=n.columns||[],u=this.toIndexEnd(e),s=e.length-1;0<=s;--s){var h=this.newCell(s,e[s],e,n),o=this.toCellState(s,u,r);o&&h.state.add(o),this.addChild(h)}},n.prototype.toCellState=function(t,n,i){return(0===t?ig.START:x.NONE)|(t===n?ig.END:x.NONE)|(t<i?ig.FROZEN:x.NONE)|(t===i-1?ig.FROZEN_END:x.NONE)},n.prototype.toIndexEnd=function(t){for(var n=t.length,i=0;i<n;++i)if(void 0!==t[i].weight)return n-1;return n},n.prototype.onRefit=function(){t.prototype.onRefit.call(this),this.resetFrozenCellPosition()},n.prototype.getFocusedChildClippingPositionX=function(t){var n=this.$f;if(0<n){var i=this.children,r=i.indexOf(t);if(0<=r){var e=i.length;if(n<=e-1-r){var u=i[e-n];return u.position.x+u.width}}}return 0},n.prototype.updateFrozenCellPosition=function(t){for(var n=this.Qf,i=this.children,r=i.length,e=this.$f,u=0;u<e;++u){var s=n[u];i[r-1-u].position.x=-t+s.offset}},n.prototype.resetFrozenCellPosition=function(){for(var t=this.Qf,n=this.children,i=n.length,r=this.$f,e=this.getContentPositionX(),u=0;u<r;++u){var s=t[u],h=n[i-1-u];s.offset=h.position.x,h.position.x=-e+s.offset}},n.prototype.getClippingRect=function(n,i){t.prototype.getClippingRect.call(this,n,i);var r=this.$f;if(0<r&&n.parent===this){var e=this.children,u=e.indexOf(n);if(0<=u&&r<=e.length-1-u){var s=e[u+1],h=s.position.x+s.width;i.x+=h,i.width-=h}}},n.prototype.getType=function(){return"DTableRow"},n}(Sr),bg=function(t){return null!=t&&"set"in t},gg=function(t){function n(n){var i=t.call(this,n)||this;return i.gt=void 0,i.xs=-1,i}return y(n,t),n.prototype.init=function(n){var i=this;this.tl=function(t,n,r,e,u){i.emit("rowchange",t,n,r,e,u,i)},t.prototype.init.call(this,n)},n.prototype.newCell=function(t,n,i,r){var e=this.toCellOptions(t,n,r);if(!1!==n.editing.enable)return(u=this.newCellEditable(t,n,e)).on("cellchange",this.tl),u;var u=this.newCellUnediable(t,n,e);return n.type===vb.TREE?u.on("cellchange",this.tl):u.state.isReadOnly=!0,u},n.prototype.newCellEditable=function(t,n,i){switch(n.type){case vb.INDEX:return new Zb(t,n,i);case vb.TEXT:return new Qb(t,n,i);case vb.TREE:return new rg(t,n,i);case vb.INTEGER:return new qb(t,n,i);case vb.REAL:return new $b(t,n,i);case vb.CHECK:case vb.CHECK_SINGLE:return new Wb(t,n,i);case vb.COLOR:return new Yb(t,n,i);case vb.BUTTON:return new Hb(t,n,i);case vb.LINK:return new hg(t,n,i);case vb.SELECT:return this.newCellSelect(t,n,i);case vb.ACTION:return this.newCellAction(t,n,i);case vb.DATE:return new Kb(t,n,i);case vb.DATETIME:return new Jb(t,n,i);case vb.TIME:return new lg(t,n,i);default:return new Gb(t,n,i)}},n.prototype.newCellUnediable=function(t,n,i){switch(n.type){case vb.INDEX:return new Zb(t,n,i);case vb.TEXT:return new Gb(t,n,i);case vb.TREE:return new fg(t,n,i);case vb.INTEGER:case vb.REAL:return new Gb(t,n,i);case vb.CHECK:case vb.CHECK_SINGLE:return new Wb(t,n,i);case vb.COLOR:return new Yb(t,n,i);case vb.BUTTON:return new Hb(t,n,i);case vb.LINK:return new hg(t,n,i);case vb.SELECT:return this.newCellSelect(t,n,i);case vb.ACTION:return this.newCellAction(t,n,i);case vb.DATE:return new Kb(t,n,i);case vb.DATETIME:return new Jb(t,n,i);case vb.TIME:return new lg(t,n,i);default:return new Gb(t,n,i)}},n.prototype.newCellSelect=function(t,n,i){var r=n.selecting;return null!=r.menu?new og(t,n,i):null!=r.multiple?new ag(t,n,i):null!=r.dialog?new _b(t,n,i):null!=r.promise?new Ub(t,n,i):new Gb(t,n,i)},n.prototype.newCellAction=function(t,n,i){var r=n.selecting;return null!=r.menu?new Fb(t,n,i):null!=r.dialog?new Pb(t,n,i):null!=r.promise?new zb(t,n,i):new Gb(t,n,i)},n.prototype.toCellOptions=function(t,n,i){var r=n.body||i.cell;if(null!=r){r.weight=n.weight,r.width=n.width;var e=r.text=r.text||{};(e.align=e.align||{}).horizontal=n.align,e.formatter=n.formatter,n.selecting.menu&&(r.menu=n.selecting.menu),n.selecting.multiple&&(r.menu=n.selecting.menu)}else r={weight:n.weight,width:n.width,text:{formatter:n.formatter,align:{horizontal:n.align}},menu:n.selecting.menu||n.selecting.multiple};if(!1!==n.editing.enable){var u=r.editing=r.editing||{};u.formatter=u.formatter||n.editing.formatter,u.unformatter=u.unformatter||n.editing.unformatter,u.validator=u.validator||n.editing.validator}return n.link&&(r.link=n.link),r},n.prototype.getType=function(){return"DTableBodyRow"},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"index",{get:function(){return this.xs},enumerable:!1,configurable:!0}),n.prototype.set=function(t,n,i,r){if(r||this.gt!==t||this.xs!==i){this.gt=t,this.xs=i;for(var e=this.children,u=e.length,s=this.Qf,h=s.length,o=0;o<u;++o){var a=e[o],c=h-1-o,f=s[c];bg(a)&&a.set(f.getter(t,c),t,n,i,c,r)}this.onSet(t,i)}},n.prototype.onSet=function(t,n){this.emit("set",t,n,this)},n.prototype.unset=function(){if(void 0!==this.gt){this.gt=void 0,this.xs=-1;for(var t=this.children,n=t.length,i=0;i<n;++i){var r=t[i];bg(r)&&r.unset()}this.onUnset()}},n.prototype.onUnset=function(){this.emit("unset",this)},n.prototype.getContentPositionX=function(){var t=this.parent;if(t){var n=t.parent;if(n)return n.position.x}return 0},n}(vg),dg=function(t){function n(n){var i=t.call(this)||this;return i.l=0,i.nc=-1,i.nl=!1,i.il=-1,i.o=n,i.Df=null,i.rl=null,i}return y(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),n.prototype.apply=function(){this.nl=!0,this.l+=1,this.o.update()},n.prototype.unapply=function(){this.nl&&(this.nl=!1,this.l+=1,this.o.update())},n.prototype.isApplied=function(){return this.nl},n.prototype.newFiltered=function(){var t=this.Df;if(null!=t){var n,i=[],r=this.o,e=r.sorter,u=r.rows;if(_n(t))if(n=e.indices)for(var s=0,h=n.length;s<h;++s)t(u[o=n[s]],o)&&i.push(s);else for(s=0,h=u.length;s<h;++s)t(u[s],s)&&i.push(s);else if(n=e.indices)for(s=0,h=n.length;s<h;++s){var o=n[s];t.test(u[o],o)&&i.push(s)}else for(s=0,h=u.length;s<h;++s)t.test(u[s],s)&&i.push(s);return i}return null},n.prototype.get=function(){return this.Df},n.prototype.set=function(t){this.Df!==t&&(this.Df=t)},n.prototype.toDirty=function(){this.l+=1},n.prototype.update=function(){this.l===this.nc&&this.o.sorter.id===this.il||(this.nc=this.l,this.il=this.o.sorter.id,this.nl?(this.rl=this.newFiltered(),this.emit("change",this)):null!=this.rl&&(this.rl=null,this.emit("change",this)))},Object.defineProperty(n.prototype,"indices",{get:function(){return this.update(),this.rl},enumerable:!1,configurable:!0}),n.prototype.map=function(t){var n=t,i=this.indices;if(i){var r=i.indexOf(n);if(!(0<=r))return null;n=r}return n},n.prototype.unmap=function(t){var n=t,i=this.indices;return i&&(n=i[n]),n},n}(t.utils.EventEmitter),mg=function(){function t(t){this.o=t}return t.prototype.map=function(t){var n=this.o,i=n.sorter.map(t);return null!=i?n.filter.map(i):null},t.prototype.unmap=function(t){var n=this.o;return n.sorter.unmap(n.filter.unmap(t))},t.prototype.size=function(){var t=this.o,n=t.filter.indices;return null!=n?n.length:t.size()},t.prototype.get=function(t){return this.o.get(this.unmap(t))},t.prototype.each=function(t,n,i){var r=this.o,e=r.rows,u=r.supplimentals,s=r.filter.indices,h=r.sorter.indices;if(n=null!=n?Math.max(0,n):0,s){var o=s.length;if(i=null!=i?Math.min(o,i):o,h)for(var a=n;a<i&&!1!==t(e[c=h[s[a]]],u?u[c]:null,a,c);++a);else for(a=n;a<i&&!1!==t(e[c=s[a]],u?u[c]:null,a,c);++a);}else if(o=e.length,i=null!=i?Math.min(o,i):o,h)for(a=n;a<i;++a){var c;if(!1===t(e[c=h[a]],u?u[c]:null,a,c))break}else for(a=n;a<i&&!1!==t(e[a],u?u[a]:null,a,a);++a);},t}();!function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULTIPLE=2]="MULTIPLE"}(Vb||(Vb={}));var wg,pg=function(t,n){return t[0]-n[0]},Og=function(t){function n(n,i){var r=t.call(this)||this;return r.o=n,r.ft=r.toType(i),r.qt=new Set,r}return y(n,t),n.prototype.toType=function(t){return t&&null!=t.type?mt(t.type)?Vb[t.type]:t.type:Vb.NONE},Object.defineProperty(n.prototype,"type",{get:function(){return this.ft},enumerable:!1,configurable:!0}),n.prototype.onChange=function(){this.o.update(),this.emit("change",this)},n.prototype.toggle=function(t){var n=this.qt;n.has(t)?n.delete(t):n.add(t),this.onChange()},n.prototype.add=function(t){var n=this.qt,i=n.size;n.add(t),i!==n.size&&this.onChange()},Object.defineProperty(n.prototype,"first",{get:function(){var t=this.qt;if(0<t.size){var n=NaN;return t.forEach((function(t){n!=n&&(n=t)})),n}return null},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"last",{get:function(){var t=this.qt;if(0<t.size){var n=0;return t.forEach((function(t){n=t})),n}return null},enumerable:!1,configurable:!0}),n.prototype.addTo=function(t){var n=this.last;null!=n&&this.addRange(n,!1,t,!0)},n.prototype.addRange=function(t,n,i,r){var e=this.qt,u=e.size;if(t<i)for(var s=t+(n?0:1),h=i+(r?1:0);s<h;++s)e.add(s);else for(s=i+(r?0:1),h=t+(n?1:0);s<h;++s)e.add(s);u!==e.size&&this.onChange()},n.prototype.addAll=function(t){for(var n=this.qt,i=n.size,r=0,e=t.length;r<e;++r)n.add(t[r]);i!==n.size&&this.onChange()},n.prototype.contains=function(t){return this.qt.has(t)},n.prototype.remove=function(t){this.qt.delete(t)&&this.onChange()},n.prototype.clear=function(){var t=this.qt;0<t.size&&(t.clear(),this.onChange())},n.prototype.clearAndAdd=function(t){var n=this.qt;n.has(t)&&1===n.size||(n.clear(),n.add(t),this.onChange())},n.prototype.clearAndAddAll=function(t){var n=this.qt;if(0<n.size||0<t.length){n.clear();for(var i=0,r=t.length;i<r;++i)n.add(t[i]);this.onChange()}},n.prototype.shift=function(t,n){var i=[],r=this.qt;if(r.forEach((function(n){t<=n&&i.push(n)})),0<i.length){for(var e=0,u=i.length;e<u;++e)r.delete(i[e]);for(e=0,u=i.length;e<u;++e)r.add(i[e]+n);this.onChange()}},n.prototype.size=function(){return this.qt.size},n.prototype.isEmpty=function(){return 0===this.qt.size},Object.defineProperty(n.prototype,"indices",{get:function(){var t=[];return this.qt.forEach((function(n){t.push(n)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){var t=[],n=this.o;return this.qt.forEach((function(i){t.push(n.get(i))})),t},enumerable:!1,configurable:!0}),n.prototype.toArray=function(){var t=[],n=this.o;return this.qt.forEach((function(i){t.push([i,n.get(i)])})),t},n.prototype.toSortedArray=function(){return this.toArray().sort(pg)},n.prototype.toObject=function(){var t={},n=this.o;return this.qt.forEach((function(i){t[i]=n.get(i)})),t},n.prototype.toMap=function(){var t=new Map,n=this.o;return this.qt.forEach((function(i){t.set(i,n.get(i))})),t},n}(t.utils.EventEmitter);!function(t){t[t.ASCENDING=0]="ASCENDING",t[t.DESCENDING=1]="DESCENDING"}(wg||(wg={}));var Dg,Eg=function(t){function n(n){var i=t.call(this)||this;return i.l=0,i.nc=-1,i.nl=!1,i.o=n,i.el=null,i.ul=null,i.Dt=wg.ASCENDING,i}return y(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"order",{get:function(){return this.Dt},set:function(t){this.Dt=t},enumerable:!1,configurable:!0}),n.prototype.apply=function(){this.nl=!0,this.l+=1,this.o.update()},n.prototype.unapply=function(){this.nl&&(this.nl=!1,this.l+=1,this.o.update())},n.prototype.isApplied=function(){return this.nl},n.prototype.newSorted=function(){var t=this.el;if(null!=t){for(var n=[],i=this.o.rows,r=0,e=i.length;r<e;++r)n.push(r);return n.sort(this.toComparator(i,t)),n}return null},n.prototype.toComparator=function(t,n){var i=this.Dt;return _n(n)?i===wg.ASCENDING?function(i,r){return n(t[i],t[r],i,r)}:function(i,r){return n(t[r],t[i],r,i)}:i===wg.ASCENDING?function(i,r){return n.compare(t[i],t[r],i,r)}:function(i,r){return n.compare(t[r],t[i],r,i)}},n.prototype.get=function(){return this.el},n.prototype.set=function(t){this.el!==t&&(this.el=t)},n.prototype.toDirty=function(){this.l+=1},n.prototype.update=function(){this.l!==this.nc&&(this.nc=this.l,this.nl?(this.ul=this.newSorted(),this.emit("change",this)):null!=this.ul&&(this.ul=null,this.emit("change",this)))},Object.defineProperty(n.prototype,"indices",{get:function(){return this.update(),this.ul},enumerable:!1,configurable:!0}),n.prototype.map=function(t){var n=t,i=this.indices;if(i){var r=i.indexOf(n);if(!(0<=r))return null;n=r}return n},n.prototype.unmap=function(t){var n=t,i=this.indices;return i&&(n=i[n]),n},n}(t.utils.EventEmitter),Mg=function(t){function n(n){var i=t.call(this)||this;if(i.o=null,i.sl=new mg(i),i.hl=i.toRows(n&&n.rows),i.ia=new Og(i,n&&n.selection),i.Df=new dg(i),i.ol=new Eg(i),n){var r=n.filter;r&&i.Df.set(r);var e=n.comparator;e&&i.ol.set(e);var u=n.on;if(u)for(var s in u){var h=u[s];h&&i.on(s,h)}}return i}return y(n,t),n.prototype.bind=function(t){this.o=t},n.prototype.toRows=function(t){var n=[];if(null!=t)for(var i=0,r=t.length;i<r;++i)n.push(t[i]);return n},Object.defineProperty(n.prototype,"rows",{get:function(){return this.hl},enumerable:!1,configurable:!0}),n.prototype.update=function(){var t=this.o;t&&t.update()},n.prototype.lock=function(){var t=this.o;t&&t.lock()},n.prototype.unlock=function(){var t=this.o;t&&(t.unlock(!1),t.update())},n.prototype.size=function(){return this.hl.length},n.prototype.clear=function(){var t=this.hl;0<t.length&&(t.length=0,this.lock(),this.ia.clear(),this.ol.toDirty(),this.Df.toDirty(),this.unlock())},n.prototype.clearAndAdd=function(t){var n=this.hl;n.length=0,n.push(t),this.lock(),this.ia.clear(),this.ol.toDirty(),this.Df.toDirty(),this.unlock()},n.prototype.clearAndAddAll=function(t){var n=this.hl;n.length=0;for(var i=0,r=t.length;i<r;++i)n.push(t[i]);this.lock(),this.ia.clear(),this.ol.toDirty(),this.Df.toDirty(),this.unlock()},n.prototype.add=function(t,n){var i=this.hl,r=this.ia,e=this.ol,u=this.Df;null==n?(i.push(t),this.lock(),e.toDirty(),u.toDirty(),this.unlock()):0<=n&&n<i.length&&(i.splice(n,0,t),this.lock(),r.shift(n,1),e.toDirty(),u.toDirty(),this.unlock())},n.prototype.addAll=function(t,n){var i=this.hl,r=i.length,e=this.ia,u=this.ol,s=this.Df;if(null==n){for(var h=0,o=a=t.length;h<o;++h)i.push(t[h]);this.lock(),u.toDirty(),s.toDirty(),this.unlock()}else if(0<=n&&n<r){var a=t.length;for(h=0;h<a;++h)i.splice(n+h,0,t[h]);this.lock(),e.shift(n,a),u.toDirty(),s.toDirty(),this.unlock()}},n.prototype.get=function(t){var n=this.hl;return 0<=t&&t<n.length?n[t]:null},n.prototype.set=function(t,n){var i=this.hl;if(0<=t&&t<i.length){var r=i[t];return i[t]=n,this.lock(),this.ol.toDirty(),this.Df.toDirty(),this.unlock(),r}return null},n.prototype.remove=function(t){var n=this.hl;if(0<=t&&t<n.length){var i=n.splice(t,1)[0];return this.lock(),this.ia.remove(t),this.ol.toDirty(),this.Df.toDirty(),this.unlock(),i}return null},n.prototype.each=function(t,n,i){var r=this.hl;n=null!=n?Math.max(0,n):0,i=null!=i?Math.min(r.length,i):r.length;for(var e=n;e<i&&!1!==t(r[e],e);++e);},Object.defineProperty(n.prototype,"selection",{get:function(){return this.ia},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"filter",{get:function(){return this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sorter",{get:function(){return this.ol},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mapped",{get:function(){return this.sl},enumerable:!1,configurable:!0}),n}(t.utils.EventEmitter),Sg=function(n){function i(t){var i=n.call(this,t)||this;return i.state.isFocusable=!1,i.Bs.emit("init",i.Bs),i}return y(i,n),i.prototype.init=function(t){this.transform.position.y=t.offset||0,this.al=function(t,n,i,e,u){r.emit("change",t,n,i,e,u,r)},n.prototype.init.call(this,t);var i,r=null!=(i=t.data)&&"mapped"in i?t.data:new Mg(t.data);this.Bs=r,r.bind(this);var e=this.theme,u=function(t,n,i){var r=n.columns||[],e=n.row;return null!=e?(null==e.height&&(e.height=t.getRowHeight()),void 0===e.columns&&(e.columns=r),null==e.interactive&&i!==Vb.NONE&&(e.interactive="SELF"),null==e.frozen&&(e.frozen=n.frozen)):e={columns:r,height:t.getRowHeight(),interactive:i!==Vb.NONE?"SELF":void 0,frozen:n.frozen},e}(e,t,r.selection.type);this.cl=u,this.fl=null!=u.height?u.height:e.getRowHeight(),this.Qf=u.columns||[],this.ll=0,this.vl=0,this.bl=0,this.dl=!1,this.ml=!1,this.wl=[]},i.prototype.onResize=function(t,i,r,e){n.prototype.onResize.call(this,t,i,r,e),this.update()},Object.defineProperty(i.prototype,"selection",{get:function(){return this.Bs.selection},enumerable:!1,configurable:!0}),i.prototype.lock=function(){this.bl+=1,1===this.bl&&(this.dl=!1,this.ml=!1)},i.prototype.unlock=function(t){this.bl-=1,0===this.bl&&(t&&this.dl&&this.update(this.ml),this.dl=!1,this.ml=!1)},i.prototype.update=function(t){if(0<this.bl)return this.dl=!0,void(t&&(this.ml=!0));var n=this.parent,i=this.children,r=n.parent.height,e=this.fl,u=this.Bs,s=u.mapped.size(),h=this.ll,o=this.vl,a=o-h,c=this.transform.position.y,f=c+s*e,l=Math.max(r,f),v=Math.max(r-l,n.position.y),b=Math.floor((0-(v+c))/e),g=Math.floor((r-(v+c))/e),d=b-(b%2==0?2:1),m=g+((g-d+1)%2==0?3:2),w=m-d;if(w<a&&a-2<=w&&(m=d+(w=a)),a<w){for(var p=a;p<w;++p){var O=h+p,D=this.newRow(O%2==0);this.addChild(D)}o=h+(a=w)}else if(w<a){for(p=a-1;w<=p;--p)this.removeChild(i[p]);o=h+(a=w)}this.ll=d,this.vl=m;var E=d-h,M=Math.abs(E),S=i.length;if(0<M&&M<S){var T=this.wl;if(0<E){for(p=0;p<M;++p)T.push(this.resetRow(i[p]));for(p=M;p<S;++p)i[p-M]=i[p];for(p=0;p<M;++p)i[S-M+p]=T[p]}else{for(p=0;p<M;++p)T.push(this.resetRow(i[S-M+p]));for(p=S-M-1;0<=p;--p)i[p+M]=i[p];for(p=0;p<M;++p)i[p]=T[p]}T.length=0}var j=u.selection;for(u.mapped.each((function(n,r,u,s){var h=i[u-d];h.position.y=u*e,j.contains(s)?h.state.set(x.ACTIVE,x.DISABLED):h.state.remove(x.ACTIVE|x.DISABLED),h.set(n,r,s,t)}),d,d+S),p=0;d+p<0&&p<S;++p)(N=i[p]).position.y=(d+p)*e,N.state.set(x.DISABLED,x.ACTIVE),N.unset();for(p=S-1;s<=d+p&&0<=p;--p){var N;(N=i[p]).position.y=(d+p)*e,N.state.set(x.DISABLED,x.ACTIVE),N.unset()}this.lock(),n.position.y=v,n.height=l,this.height=f,this.unlock(!1)},i.prototype.resetRow=function(t){t.blur(!0);for(var n=t.children,i=0,r=n.length;i<r;++i){var e=n[i];e instanceof li&&(e.state.isPressed=!1)}return t},i.prototype.newRow=function(t){var n=this.cl;n.even=t;var i=new gg(n);return i.on("rowchange",this.al),i},i.prototype.onParentMove=function(t,i,r,e){n.prototype.onParentMove.call(this,t,i,r,e),this.updateFrozenCellPosition(t)},i.prototype.updateFrozenCellPosition=function(t){var n=this.cl.frozen;if(null!=n&&0<n)for(var i=this.children,r=0,e=i.length;r<e;++r)i[r].updateFrozenCellPosition(t)},i.prototype.getClippingRect=function(t,i){n.prototype.getClippingRect.call(this,t,i);var r=this.parent;if(r){var e=-r.transform.position.y;i.y+=e,i.height-=e}},i.prototype.onRowClicked=function(t){if(this.state.isActionable){var n=i.WORK_ON_CLICK;if(n.copyFrom(t.data.global),this.toLocal(n,void 0,n,!1),0<=this.parent.position.y+n.y){var r=Math.floor(n.y/this.fl),e=this.Bs,u=e.mapped,s=e.selection;if(0<=r&&r<u.size()){var h=s.type===Vb.SINGLE,o=!h,a=t.data.originalEvent,c=a.ctrlKey,f=a.shiftKey,l=u.unmap(r);if(h||s.isEmpty()||!o||!c&&!f)s.clearAndAdd(l);else if(c)s.toggle(l);else if(f){var v=s.last;if(null!=v){var b=e.sorter,g=e.filter,d=b.map(l),m=b.map(v);if(null!=d&&null!=m){var w=m+1,p=d+1;if(d<m&&(w=d,p=m),w<p){var O=[],D=g.indices,E=b.indices;if(D)if(E)for(var M=0,S=D.length;M<S;++M)w<=(T=D[M])&&T<p&&O.push(E[T]);else for(M=0,S=D.length;M<S;++M){var T;w<=(T=D[M])&&T<p&&O.push(T)}else if(E)for(M=w;M<p;++M)O.push(E[M]);else for(M=w;M<p;++M)O.push(M);s.addAll(O)}}}}}}}},i.prototype.onDblClick=function(t,r){var e=!1,u=this.Bs;if(this.state.isActionable&&u.selection.type!==Vb.NONE){var s=ai.toGlobal(t,r,i.WORK_ON_CLICK);this.toLocal(s,void 0,s,!1);var h=s.x,o=s.y;if(0<=this.parent.position.y+o){var a=Math.floor(o/this.fl);if(0<=a&&a<u.mapped.size()){var c=a-this.ll,f=this.children;if(0<=c&&c<f.length)for(var l=f[c].children,v=l.length,b=this.Qf.length,g=0,d=Math.min(v,b);g<d;++g){var m=l[v-g-1];if(m.state.isActionable){var w=h-m.position.x;0<=w&&w<=m.width&&(m.focus(),m instanceof lr&&m.onClick(t),e=!0)}}}}}return n.prototype.onDblClick.call(this,t,r)||e},i.prototype.getType=function(){return"DTableBody"},Object.defineProperty(i.prototype,"data",{get:function(){return this.Bs},enumerable:!1,configurable:!0}),i.WORK_ON_CLICK=new t.Point,i}(li),Tg=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DTableCategoryCell"},n}(Xo),jg=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){this.Lt=this.transform.position.y=n.offset||0,t.prototype.init.call(this,n)},n.prototype.onParentMove=function(n,i,r,e){t.prototype.onParentMove.call(this,n,i,r,e),this.transform.position.y=-i+this.Lt,this.updateFrozenCellPosition(n)},n.prototype.getContentPositionX=function(){var t=this.parent;return t?t.position.x:0},n.prototype.newCell=function(t,n,i,r){return new Tg(this.toCellOptions(t,n,r))},n.prototype.toCellOptions=function(t,n,i){var r=i.cell;if(r){r.weight=n.weight,r.width=n.width;var e=r.text=r.text||{};return e.value=e.value||n.label,r}return{weight:n.weight,width:n.width,text:{value:n.label}}},n.prototype.getType=function(){return"DTableCategory"},n}(vg),Ng=function(t){function n(n){var i=t.call(this)||this;return i.l=0,i.nc=-1,i.nl=!1,i.o=n,i.Df=null,i.rl=null,i}return y(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return this.l},enumerable:!1,configurable:!0}),n.prototype.apply=function(){this.nl=!0,this.l+=1,this.o.update()},n.prototype.unapply=function(){this.nl&&(this.nl=!1,this.l+=1,this.o.update())},n.prototype.isApplied=function(){return this.nl},n.prototype.isFiltered=function(t,n,i){return _n(i)?i(t,n):i.test(t,n)},n.prototype.hasFiltered=function(t,n,i){for(var r=0,e=n.length;r<e;++r){var u=n[r];if(this.isFiltered(u,-1,i))return!0;if(null!=u.children&&0<u.children.length&&this.hasFiltered(t,u.children,i))return!0}return!1},n.prototype.addAllToFiltered=function(t,n,i,r){for(var e=0,u=n.length;e<u;++e){var s=n[e];i.push(r[0]),r[0]+=1,null!=s.children&&0<s.children.length&&t.isOpened(s)&&this.addAllToFiltered(t,s.children,i,r)}},n.prototype.newFilteredSub=function(t,n,i,r,e){for(var u=!1,s=0,h=n.length;s<h;++s){var o=n[s],a=e[0];e[0]+=1;var c=this.isFiltered(o,a,i);if(null!=o.children&&0<o.children.length)if(t.isOpened(o))if(c)r.push(a),u=!0,this.addAllToFiltered(t,o.children,r,e);else{var f=r.length;this.newFilteredSub(t,o.children,i,r,e)&&(r.splice(f,0,a),u=!0)}else(c||this.hasFiltered(t,o.children,i))&&(r.push(a),u=!0);else c&&(r.push(a),u=!0)}return u},n.prototype.newFiltered=function(){var t=this.Df;if(null!=t){var n=[],i=this.o,r=i.nodes;return r&&this.newFilteredSub(i,r,t,n,[0]),n}return null},n.prototype.get=function(){return this.Df},n.prototype.set=function(t){this.Df!==t&&(this.Df=t)},n.prototype.toDirty=function(){this.l+=1},n.prototype.update=function(){this.l!==this.nc&&(this.nc=this.l,this.nl?(this.rl=this.newFiltered(),this.emit("change",this)):null!=this.rl&&(this.rl=null,this.emit("change",this)))},Object.defineProperty(n.prototype,"indices",{get:function(){return this.update(),this.rl},enumerable:!1,configurable:!0}),n.prototype.map=function(t){var n=t,i=this.indices;if(i){var r=i.indexOf(n);if(!(0<=r))return null;n=r}return n},n.prototype.unmap=function(t){var n=t,i=this.indices;return i&&(n=i[n]),n},n}(t.utils.EventEmitter),Ig=function(t){function n(){return t.call(this)||this}return y(n,t),Object.defineProperty(n.prototype,"id",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"order",{get:function(){return wg.ASCENDING},set:function(t){},enumerable:!1,configurable:!0}),n.prototype.apply=function(){},n.prototype.unapply=function(){},n.prototype.isApplied=function(){return!1},n.prototype.get=function(){return null},n.prototype.set=function(t){},n.prototype.toDirty=function(){},n.prototype.update=function(){},Object.defineProperty(n.prototype,"indices",{get:function(){return null},enumerable:!1,configurable:!0}),n.prototype.map=function(t){return t},n.prototype.unmap=function(t){return t},n}(t.utils.EventEmitter),Cg=function(t){function n(n){var i=t.call(this)||this;if(i.o=null,i.sl=new mg(i),i.hl=[],i.pl=!1,i.Ol=[],i.Dl=new WeakMap,i.ia=new Og(i,n&&n.selection),i.Df=new Ng(i),i.ol=new Ig,n){var r=n.filter;r&&i.Df.set(r);var e=n.on;if(e)for(var u in e){var s=e[u];s&&i.on(u,s)}}return i.nodes=n&&n.nodes,i}return y(n,t),n.prototype.bind=function(t){this.o=t},Object.defineProperty(n.prototype,"nodes",{get:function(){return this.El},set:function(t){this.El=t,this.pl=!0,this.Df.toDirty(),this.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){return this.pl&&(this.pl=!1,this.updateRows(this.El)),this.hl},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"supplimentals",{get:function(){return this.Ol},enumerable:!1,configurable:!0}),n.prototype.updateRows=function(t){var n=this.hl,i=this.Ol,r=this.Dl;if(null!=t){var e=this.Ml(t,0,0,n,i,r);e!==n.length&&(n.length=e,i.length=e)}else n.length=0,i.length=0},n.prototype.toSupplimental=function(t,n,i){return t<<2|(n?2:0)|(i?1:0)},n.prototype.Ml=function(t,n,i,r,e,u){for(var s=0,h=t.length;s<h;++s){var o=t[s],a=o.children,c=u.has(o),f=this.toSupplimental(i,!!(a&&0<a.length),c);n<r.length?(r[n]=o,e[n]=f):(r.push(o),e.push(f)),n+=1,c&&a&&(n=this.Ml(a,n,i+1,r,e,u))}return n},n.prototype.update=function(t){var n=this.o;n&&n.update(t)},n.prototype.size=function(){return this.rows.length},n.prototype.get=function(t){var n=this.rows;return 0<=t&&t<n.length?n[t]:null},n.prototype.open=function(t){var n=this.Dl;n.has(t)||(n.set(t,1),this.pl=!0,this.Df.toDirty(),this.update(!0))},n.prototype.close=function(t){var n=this.Dl;n.has(t)&&(n.delete(t),this.pl=!0,this.Df.toDirty(),this.update(!0))},n.prototype.isOpened=function(t){return this.Dl.has(t)},n.prototype.toggle=function(t){var n=this.Dl;n.has(t)?n.delete(t):n.set(t,1),this.pl=!0,this.Df.toDirty(),this.update(!0)},n.prototype.each=function(t,n,i){var r=this.rows;n=null!=n?Math.max(0,n):0,i=null!=i?Math.min(r.length,i):r.length;for(var e=n;e<i&&!1!==t(r[e],e);++e);},Object.defineProperty(n.prototype,"selection",{get:function(){return this.ia},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"filter",{get:function(){return this.Df},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sorter",{get:function(){return this.ol},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mapped",{get:function(){return this.sl},enumerable:!1,configurable:!0}),n}(t.utils.EventEmitter),Ag=function(){function t(t,n){var i,r,e;this.o=t,n?(this.Re=null!==(i=n.enable)&&void 0!==i&&i,this.Sl=null===(r=n.filterable)||void 0===r||r,this.Tl=null===(e=n.emittable)||void 0===e||e):(this.Re=!1,this.Sl=!0,this.Tl=!0)}return Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this.Re},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFilterable",{get:function(){return this.Sl},set:function(t){this.Sl=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmittable",{get:function(){return this.Tl},set:function(t){this.Tl=t},enumerable:!1,configurable:!0}),t.prototype.newIteratee=function(t,n){var i=this.o,r=i.column,e=i.columnIndex;if(null!=r&&null!=e){var u=r.getter,s=r.setter;if(this.Tl){var h=t.data;return function(t,i){return u(t,e)!==n&&(s(t,e,n),h.emit("change",n,!n,t,i,e,h),!0)}}return function(t){return u(t,e)!==n&&(s(t,e,n),!0)}}return null},t.prototype.execute=function(t){var n,i=null===(n=this.o.header)||void 0===n?void 0:n.table;if(i){var r=this.newIteratee(i,t);if(r){var e=!1;this.Sl?i.data.mapped.each((function(t,n,i,u){r(t,u)&&(e=!0)})):i.data.each((function(t,n){r(t,n)&&(e=!0)})),e&&i.body.update(!0)}}},t}(),Rg=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return y(i,n),i.prototype.init=function(t){null!=t?(this.bs=t.header,this.jl=t.column,this.Kf=t.columnIndex,this.Nl=new Ag(this,t.check)):this.Nl=new Ag(this),n.prototype.init.call(this,t),this.initOnClick(t)},Object.defineProperty(i.prototype,"column",{get:function(){return this.jl},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"columnIndex",{get:function(){return this.Kf},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"header",{get:function(){return this.bs},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"check",{get:function(){return this.Nl},enumerable:!1,configurable:!0}),i.prototype.initOnClick=function(t){var n=this,i=this.jl;if(i){var r=i.sorting.enable,e=this.Nl.isEnabled;(e||r)&&(this.buttonMode=this.state.isActionable,ai.onClick(this,(function(t){n.onClick(t)})),e&&this.state.add(ig.CHECKABLE))}},Object.defineProperty(i.prototype,"sorter",{get:function(){var t=this,n=this.ol;if(null==n){var i=this.bs;if(!i)return null;var r=i.table;if(!r)return null;n=r.data.sorter,this.ol=n,this.Il=this.Il||function(){t.onSorterChange()},n.on("change",this.Il)}return n},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"comparator",{get:function(){var t=this.jl;return t&&t.sorting.comparator||null},enumerable:!1,configurable:!0}),i.prototype.onSorterChange=function(){var t=this.comparator;if(t){var n=this.ol;if(n){var i=ig.SORTED_ASCENDING,r=ig.SORTED_DESCENDING;n.isApplied()&&n.get()===t?n.order===wg.ASCENDING?this.state.set(i,r):this.state.set(r,i):this.state.remove(i|r)}}},i.prototype.toClickPosition=function(n){var i=this.Cl||new t.Point;return this.Cl=i,n.data.getLocalPosition(this,i).x},i.prototype.isCheckClicked=function(t){if(this.Nl.isEnabled){if(!this.isSortable)return!0;var n=this.ne[1];if(n&&null!=n.image){var i=this.toClickPosition(t),r=n.bound,e=n.margin.horizontal;return r.left-e<=i&&i<=r.right+e}}return!1},i.prototype.onClick=function(t){this.state.isActionable&&(this.isCheckClicked(t)?(this.onToggleStart(),this.onToggleEnd()):this.onActivate(t))},i.prototype.onActivate=function(t){this.doSort(t),this.emit("active",this)},i.prototype.doSort=function(t){if(this.isSortable){var n=this.comparator;if(n){var i=this.sorter;i&&(i.get()===n?i.order===wg.ASCENDING?(i.order=wg.DESCENDING,i.apply()):(i.set(null),i.apply()):(i.set(n),i.order=wg.ASCENDING,i.apply()))}}},Object.defineProperty(i.prototype,"isSortable",{get:function(){var t=this.jl;return!!t&&t.sorting.enable},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isButton",{get:function(){return this.check.isEnabled||this.isSortable},enumerable:!1,configurable:!0}),Object.defineProperty(i.prototype,"isToggle",{get:function(){return this.check.isEnabled},enumerable:!1,configurable:!0}),i.prototype.toggle=function(){this.state.isActionable&&this.isToggle&&(this.onToggleStart(),this.onToggleEnd())},i.prototype.onToggleStart=function(){this.state.isActive=!this.state.isActive},i.prototype.onToggleEnd=function(){this.state.isActive?(this.Nl.execute(!0),this.emit("active",this)):(this.Nl.execute(!1),this.emit("inactive",this))},i.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this.isToggle?this.onToggleStart():this.state.isPressed=!0)},i.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this.isToggle?this.onToggleEnd():(this.state.isPressed&&this.onActivate(t),this.state.isPressed=!1))},i.prototype.onKeyDown=function(t){return pt.isActivateKey(t)&&this.onActivateKeyDown(t),n.prototype.onKeyDown.call(this,t)},i.prototype.onKeyUp=function(t){return pt.isActivateKey(t)&&this.onActivateKeyUp(t),n.prototype.onKeyUp.call(this,t)},i.prototype.onStateChange=function(t,i){n.prototype.onStateChange.call(this,t,i),this.isButton&&(this.buttonMode=t.isActionable)},i.prototype.getType=function(){return"DTableHeaderCell"},i.prototype.destroy=function(){var t=this.ol,i=this.Il;t&&i&&t.off("change",i),this.ol=void 0,this.Il=void 0,n.prototype.destroy.call(this)},i}(Xo),yg=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){var i;this.Al=n.table||null,this.Lt=this.transform.position.y=n.offset||0,this.$f=null!==(i=n.frozen)&&void 0!==i?i:0,t.prototype.init.call(this,n)},Object.defineProperty(n.prototype,"table",{get:function(){return this.Al},enumerable:!1,configurable:!0}),n.prototype.onParentMove=function(n,i,r,e){t.prototype.onParentMove.call(this,n,i,r,e),this.transform.position.y=-i+this.Lt,this.updateFrozenCellPosition(n)},n.prototype.getContentPositionX=function(){var t=this.parent;return t?t.position.x:0},n.prototype.newCell=function(t,n,i,r){return new Rg(this.toCellOptions(t,n,r))},n.prototype.toCellOptions=function(t,n,i){var r=n.header||i.cell;return null!=r?(void 0===r.weight&&(r.weight=n.weight),void 0===r.width&&(r.width=n.width),void 0===r.text?r.text={value:n.label}:void 0===r.text.value&&(r.text.value=n.label),void 0===r.header&&(r.header=this),void 0===r.column&&(r.column=n),void 0===r.columnIndex&&(r.columnIndex=t),r):{weight:n.weight,width:n.width,text:{value:n.label},header:this,column:n,columnIndex:t}},n.prototype.getType=function(){return"DTableHeader"},n}(vg),kg=function(t,n){return t[n]},xg=function(t,n,i){t[n]=i},Lg=function(){return""},Bg=function(){},_g=function(t){return t},Pg=function(t){if(null!=t){if(t.length<=1){var n=t[0];return function(t){return n in t}}return function(n){for(var i=0,r=t.length;i<r;++i){var e=t[i];if(!(e in n))return!1;n=n[e]}return!0}}return function(t,n){return n<t.length}},Fg=function(t,n){return mt(t)?Pg(n):null!=t&&t},Ug=function(t,n){var i=t.editing;return i?{enable:Fg(null!=i.enable?i.enable:t.editable,n),formatter:i.formatter||Nc,unformatter:i.unformatter||_g,validator:i.validator}:{enable:Fg(t.editable,n),formatter:Nc,unformatter:_g}},zg=function(t,n){return function(i,r){var e=t(i,n),u=t(r,n);return e<u?-1:u<e?1:0}},Gg=function(t,n,i){var r=i.sorting;if(r){var e=!0===r.enable||!0===i.sortable;return e?{enable:e,comparator:r.comparator||zg(t,n)}:{enable:e}}return!0===i.sortable?{enable:!0,comparator:zg(t,n)}:{enable:!1}},Hg=function(t){return null==t?void 0:t instanceof Zv?t:new Zv(t)},Vg=function(t){return null==t?void 0:"open"in t?t:new ol(t)},Wg=function(t){return t.value},Xg=function(){},Yg=function(t){return t?{getter:t.getter||Wg,setter:t.setter||Xg,menu:Hg(t.menu),multiple:Hg(t.multiple),dialog:Vg(t.dialog),promise:t.promise}:{getter:Wg,setter:Xg}},Kg=function(t,n){var i=t.renderable;return mt(i)?Pg(n):null==i||i},Jg=function(t,n){var i=null!=n.weight?n.weight:null!=n.width?void 0:1,r=null!=i?void 0:null!=n.width?n.width:100,e=null!=n.type?mt(n.type)?vb[n.type]:n.type:vb.TEXT,u=function(t,n){if(null!=t.align)return mt(t.align)?Ji[t.align]:t.align;switch(n){case vb.TEXT:return Ji.LEFT;case vb.REAL:case vb.INTEGER:return Ji.RIGHT;case vb.BUTTON:case vb.INDEX:case vb.SELECT:case vb.ACTION:case vb.LINK:return Ji.CENTER;default:return Ji.LEFT}}(n,e),s=n.label||"",h=function(t){return null!=t.path?t.path.split("."):null}(n),o=function(t,n,i){var r=t.getter;if(r)return r;switch(n){case vb.ACTION:case vb.LINK:return Lg;default:return null==i?kg:function(t,n){if(t.length<=1){var i=t[0];return void 0===n?function(t){return t[i]}:function(t){return i in t?t[i]:n}}return void 0===n?function(n){for(var i=0,r=t.length-1;i<r;++i)n=n[t[i]];return n[t[t.length-1]]}:function(i){for(var r=0,e=t.length-1;r<e;++r)i=i[t[r]];var u=t[t.length-1];return u in i?i[u]:n}}(i,t.default)}}(n,e,h);return{weight:i,width:r,type:e,label:s,getter:o,setter:function(t,n,i){var r=t.setter;if(r)return r;switch(n){case vb.BUTTON:case vb.ACTION:case vb.LINK:return Bg;default:return null==i?xg:function(t){if(t.length<=1){var n=t[0];return function(t,i,r){t[n]=r}}return function(n,i,r){for(var e=0,u=t.length-1;e<u;++e)n=n[t[e]]||{};n[t[t.length-1]]=r}}(i)}}(n,e,h),formatter:n.formatter,renderable:Kg(n,h),align:u,editing:Ug(n,h),sorting:Gg(o,t,n),header:n.header,body:n.body,selecting:Yg(n.selecting),category:n.category,frozen:n.frozen,offset:0,link:n.link}},Zg=function(t){function n(n){return t.call(this,n)||this}return y(n,t),n.prototype.init=function(n){var i=function(t){for(var n=[],i=0,r=t.length;i<r;++i)n.push(Jg(i,t[i]));return n}(n.columns),r=function(t){for(var n=t.length-1;0<=n;--n)if(!0===t[n].frozen)return n+1;return 0}(i),e=this.newCategories(n,i,r);this.Rl=e;for(var u=0,s=0,h=e.length;s<h;++s)u+=e[s].height;var o=this.newHeader(n,i,r,u);this.bs=o;var a=u+(o&&o.height||0),c=this.newBody(n,i,r,a);this.gs=c,t.prototype.init.call(this,n);var f=this.Jo;for(f.setWidth(this.toContentWidth(n)),f.addChild(c),o&&f.addChild(o),s=e.length-1;0<=s;--s)f.addChild(e[s]);f.on("move",(function(){c.update()})),f.on("resize",(function(){c.update()})),c.data.selection.type!==Vb.NONE&&ai.onClick(this,(function(t){c.onRowClicked(t)})),f.state.isFocusReverse=!0,c.update()},n.prototype.onResize=function(n,i,r,e){var u=this.gs;u.lock(),t.prototype.onResize.call(this,n,i,r,e),u.update(),u.unlock(!0)},n.prototype.getCategoryCount=function(t){for(var n=0,i=0,r=t.length;i<r;++i){var e=t[i].category;if(null!=e){var u=mt(e)?1:e.length;n=Math.max(n,u)}}return n},n.prototype.toCategoryLabel=function(t,n){if(n)if(mt(n)){if(0===t)return n}else if(t<n.length)return n[t]},n.prototype.isSameCategory=function(t,n,i){if(null!=n){if(null!=i){if(mt(n))return mt(i)?0<t||n===i:0<t?i.length<=t:1===i.length&&n===i[0];if(mt(i))return 0<t?n.length<=t:1===n.length&&n[0]===i;if(n.length<=t&&i.length<=t)return!0;if(i.length===n.length){for(var r=t,e=n.length;r<e;++r)if(n[r]!==i[r])return!1;return!0}return!1}return mt(n)?0<t:n.length<=t}return null==i||(mt(i)?0<t:i.length<=t)},n.prototype.toCategoryColumns=function(t,n,i){for(var r=[],e=null,u=null,s=0,h=n.length;s<h;++s){var o=n[s];s!==i&&u&&e&&this.isSameCategory(t,e.category,o.category)?null!=u.weight&&null!=o.weight?u.weight+=o.weight:null!=u.width&&null!=o.width?u.width+=o.width:(e=o,u={label:this.toCategoryLabel(t,o.category),weight:o.weight,width:o.width,offset:0},r.push(u)):(e=o,u={label:this.toCategoryLabel(t,o.category),weight:o.weight,width:o.width,offset:0},r.push(u))}return r},n.prototype.toCategoryOptions=function(t,n,i,r,e){return n?(void 0===n.columns&&(n.columns=this.toCategoryColumns(t,i,r)),null==n.frozen&&(n.frozen=r),null==n.offset&&(n.offset=e),n):{columns:this.toCategoryColumns(t,i,r),frozen:r,offset:e}},n.prototype.newCategories=function(t,n,i){for(var r=[],e=0,u=this.getCategoryCount(n)-1;0<=u;--u){var s=new jg(this.toCategoryOptions(u,t.category,n,i,e));r.push(s),e+=s.height}return r},n.prototype.onDblClick=function(n,i){var r=this.gs.onDblClick(n,i);return t.prototype.onDblClick.call(this,n,i)||r},n.prototype.getScrollBarOffsetVerticalStart=function(t){return.5*t+this.gs.position.y},n.prototype.toContentWidth=function(t){var n=0,i=t.columns;if(i)for(var r=0,e=i.length;r<e;++r){var u=i[r].width;null!=u&&(n+=u)}return 0<n?function(t){return Math.max(t,n)}:"100%"},n.prototype.hasHeader=function(t){for(var n=t.columns,i=0,r=n.length;i<r;++i)if(null!=n[i].label)return!0;return!1},n.prototype.newHeader=function(t,n,i,r){return this.hasHeader(t)?new yg(this.toHeaderOptions(t.header,n,i,r)):null},n.prototype.toHeaderOptions=function(t,n,i,r){return t?(void 0===t.columns&&(t.columns=n),null==t.frozen&&(t.frozen=i),void 0===t.offset&&(t.offset=r),void 0===t.table&&(t.table=this),t):{columns:n,frozen:i,offset:r,table:this}},n.prototype.newBody=function(t,n,i,r){return new Sg(this.toBodyOptions(t.body,n,i,r,t.data))},n.prototype.toBodyOptions=function(t,n,i,r,e){return null!=t?(void 0===t.columns&&(t.columns=n),null==t.frozen&&(t.frozen=i),void 0===t.offset&&(t.offset=r),void 0===t.data&&void 0!==e&&(wt(e)?t.data={rows:e}:t.data=e),void 0===t.height&&void 0===t.weight&&(t.weight=1),t):wt(e)?{columns:n,frozen:i,offset:r,data:{rows:e},weight:1}:{columns:n,frozen:i,offset:r,data:e,weight:1}},n.prototype.getFocusedChildClippingRect=function(n,i,r,e,u,s,h,o){t.prototype.getFocusedChildClippingRect.call(this,n,i,r,e,u,s,h,o);var a=n.parent;if(a instanceof vg){var c=i+a.getFocusedChildClippingPositionX(n)-o.x;0<c&&(o.x+=c,o.width-=c)}return o},n.prototype.getType=function(){return"DTable"},Object.defineProperty(n.prototype,"categories",{get:function(){return this.Rl},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"header",{get:function(){return this.bs},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"body",{get:function(){return this.gs},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this.gs.data},enumerable:!1,configurable:!0}),n}(nl),qg={EXPANDED:x.CUSTOM,COLLAPSED:2*x.CUSTOM,SELECTED:4*x.CUSTOM},$g=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DTreeItemTextAndImage"},n}(Xo),Qg=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.getType=function(){return"DTreeItemToggleIcon"},n}(Xo),td=function(t){return t?t.text:""},nd=function(t){return!(!t||!t.isParent)},id=function(t){return!(!t||!t.expanded)},rd=function(t){return t&&t.image?t.image:null},ed=function(t){return t?t.rawData:{text:"",children:[]}},ud=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.yl=nd(n),this.kl=id(n),this.xl=ed(n),this.Ll=new Qg,this.Bl=function(t){return new $g({text:{value:td(t)},image:{source:rd(t)}})}(n),this.addChild(this.Ll),this.addChild(this.Bl),this.Ll.on(ai.down,(function(){i.onToggle()})),this.Bl.on(ai.down,(function(t){i.onSelect(t)})),this.updateStates(!1)},n.prototype.onSelect=function(t){this.emit("select",t)},n.prototype.onToggle=function(){this.emit("toggle")},n.prototype.isExpanded=function(){return this.kl},n.prototype.isParent=function(){return this.yl},n.prototype.getRawData=function(){return this.xl},n.prototype.update=function(t,n){return this.Bl.text=td(t),this.Bl.image=rd(t),this.xl=ed(t),this.Mn.left=function(t,n){var i=n?n.level:0;return t.getPaddingByLevel(i)}(this.theme,t),this.position.y=function(t){return t?t.y:0}(t),this.yl=nd(t),this.kl=id(t),this.updateStates(n),this},n.prototype.updateActiveState=function(t){this.state.isActive=t,this.Ll.state.set(qg.SELECTED,t),this.Bl.state.set(qg.SELECTED,t)},n.prototype.updateStates=function(t){this.updateActiveState(t);var n=this.Ll;this.yl?this.kl?n.state.set(qg.EXPANDED,qg.COLLAPSED):n.state.set(qg.COLLAPSED,qg.EXPANDED):n.state.remove(qg.COLLAPSED|qg.EXPANDED)},n.prototype.getType=function(){return"DTreeItem"},n}(Sr),sd=function(){function t(){this.ia=[]}return t.prototype.add=function(t){-1===this.ia.indexOf(t)&&this.ia.push(t)},t.prototype.remove=function(t){var n=this.ia.indexOf(t);-1!==n&&this.ia.splice(n,1)},t.prototype.toggle=function(t){var n=this.ia.indexOf(t);-1!==n?this.ia.splice(n,1):this.ia.push(t)},t.prototype.clear=function(){this.ia.length=0},t.prototype.get=function(t){var n=this.ia;return 0<=t&&t<n.length?n[t]:null},t.prototype.contains=function(t){return-1!==this.ia.indexOf(t)},t.prototype.size=function(){return this.ia.length},t.prototype.each=function(t){for(var n=0,i=this.ia;n<i.length;n++)if(!t(i[n]))return},t}();!function(t){t[t.BEFORE=0]="BEFORE",t[t.AFTER=1]="AFTER"}(Dg||(Dg={}));var hd=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return y(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this._l=new WeakMap,this.ia=new sd,this.Pl=[],this.Fl=0,this.Ul=0,this.zl=0;var r=Z.getInstance().get("DTreeItem");this.Gl=Number(r.getHeight()),this.gt=n&&n.value?n.value:[],this.updateData(null,this.gt,0),this.Jo.on("move",(function(){i.update()})),this.Jo.on("resize",(function(){i.Jo.removeChildren(),i.update()})),this.update()},n.prototype.update=function(){var t=this,n=this.Jo,i=n.children;n.height=this.Pl.length*this.Gl;var r=n.position.y,e=this.height,u=(0-r)/this.Gl-2<0?0:Math.floor((0-r)/this.Gl)-2,s=(e-r)/this.Gl+2<this.Pl.length-1?Math.floor((e-r)/this.Gl)+2:this.Pl.length,h=this.Pl.slice(u,s);if(i.length<h.length)for(var o=function(i){var r=h[i],e=new ud(r);n.addChild(e),e.on("select",(function(n){t.state.inEnabled&&t.onSelect(e.getRawData(),n)})),e.on("toggle",(function(){e.isParent()&&t.state.inEnabled&&t.toggle(e.getRawData())}))},a=i.length;a<h.length;a++)o(a);else if(i.length>h.length)for(a=h.length;a<i.length;a++)i[a].hide();for(a=0;a<h.length;a++)i[a]=i[a].update(h[a],this.ia.contains(h[a].rawData)),i[a].isHidden()&&i[a].show()},n.prototype.reload=function(t){this.Pl.length=0,this.zl=0,this.updateData(null,this.gt,0,t),this.update()},Object.defineProperty(n.prototype,"value",{get:function(){return this.gt},enumerable:!1,configurable:!0}),n.prototype.toggle=function(t){var n=this._l.get(t);n&&(n.expanded=!n.expanded,this.reload())},n.prototype.expand=function(t){var n=this._l.get(t);n&&(n.expanded=!0,this.reload())},n.prototype.collapse=function(t){var n=this._l.get(t);n&&(n.expanded=!1,this.reload())},n.prototype.expandAll=function(){this.reload(!0)},n.prototype.collapseAll=function(){this.reload(!1)},n.prototype.isCollapsed=function(t){var n=this._l.get(t);return n&&!n.expanded},n.prototype.isExpanded=function(t){var n=this._l.get(t);return n&&n.expanded},n.prototype.clear=function(){this.gt=[],this.reload()},n.prototype.remove=function(t){this.Hl=t,this.reload()},n.prototype.add=function(t,n){n?n.children?n.children.push(t):n.children=[t]:this.gt.push(t),this.reload()},n.prototype.addBefore=function(t,n){this.Vl={item:t,sibling:n,positon:Dg.BEFORE},this.reload()},n.prototype.addAfter=function(t,n){this.Vl={item:t,sibling:n,positon:Dg.AFTER},this.reload()},n.prototype.each=function(t){this.inOrder(this.gt,t)},n.prototype.inOrder=function(t,n){for(var i=0,r=t;i<r.length;i++){var e=r[i];if(!n(e))return;e.children&&this.inOrder(e.children,n)}},Object.defineProperty(n.prototype,"selection",{get:function(){return this.ia},enumerable:!1,configurable:!0}),n.prototype.updateData=function(t,n,i,r){for(var e=0;e<n.length;e++){var u=n[e];if(u!==this.Hl){if(this.Vl&&u===this.Vl.sibling)if(this.Vl.positon===Dg.AFTER)n.splice(e+1,0,this.Vl.item),this.Vl=null;else if(this.Vl.positon===Dg.BEFORE){n.splice(e,0,this.Vl.item),e--,this.Vl=null;continue}var s=u.children&&u.children.length>0,h=u.text?u.text:"",o=u.image?u.image:null,a=!1,c=this._l.get(u),f=!1;null!=r?f=r:c&&(f=c.expanded),null!=c?(c.rawData=u,c.text=h,c.y=this.zl,c.isParent=s,c.expanded=f,c.image=o,a=!0):c={rawData:u,text:h,level:i,y:this.zl,isParent:s,expanded:f,image:o},null==t||t&&t.expanded&&t.showable?(c.showable=!0,this.Pl.push(c),this.zl+=this.Gl):c.showable=!1,a||this._l.set(u,c),u&&u.children&&this.updateData(c,u.children,i+1,r)}else n.splice(e,1),this.Hl=null,e--,t&&0===n.length&&(t.isParent=!1)}},n.prototype.onSelect=function(t,n){var i,r,e=this;if(n.data.originalEvent.ctrlKey)this.ia.toggle(t);else if(n.data.originalEvent.shiftKey){var u=this.ia.get(this.ia.size()-1);if(u){this.ia.clear();var s=Number(null===(i=this._l.get(t))||void 0===i?void 0:i.y),h=Number(null===(r=this._l.get(u))||void 0===r?void 0:r.y),o=s<h?h-this.Gl:s,a=s<h?s:h+this.Gl;this.Pl.every((function(t){return t.y>=a&&t.y<=o&&t.showable&&e.ia.add(t.rawData),t.y<o})),this.ia.add(u)}}else this.ia.clear(),this.ia.add(t);this.updateActiveState()},n.prototype.updateActiveState=function(){var t=this;this.Jo.children.forEach((function(n){n.updateActiveState(t.ia.contains(n.getRawData()))}))},n.prototype.getType=function(){return"DTree"},n}(nl),od={__proto__:null,loadAll:Ha,loadMenuItemAll:Ga,loadMenuItemExpandable:Ma,loadMenuItem:va,loadMenuSidedItemExpandable:za,loadMenuSidedItem:Ra,EShapeActionBases:Et,EShapeActionExpressions:Mt,EShapeActionRuntimeBlinkBrighten:Nt,EShapeActionRuntimeBlinkColorFill:It,EShapeActionRuntimeBlinkColorStroke:Ct,EShapeActionRuntimeBlinkDarken:At,EShapeActionRuntimeBlinkOpacity:Rt,EShapeActionRuntimeBlinkVisibility:yt,EShapeActionRuntimeBlink:jt,EShapeActionRuntimeChangeColorBrightness:Yt,EShapeActionRuntimeChangeColorCode:Jt,EShapeActionRuntimeChangeColor:Ht,EShapeActionRuntimeChangeCursor:qt,EShapeActionRuntimeChangeTextNumber:kn,EShapeActionRuntimeChangeTextText:xn,EShapeActionRuntimeConditional:Tt,EShapeActionRuntimeEmitEvent:Ni,EShapeActionRuntimeMiscEmitEvent:Ci,EShapeActionRuntimeMiscInputDataBase:Pi,EShapeActionRuntimeMiscInputDataInteger:Fi,EShapeActionRuntimeMiscInputDataReal:zi,EShapeActionRuntimeMiscInputDataText:Hi,EShapeActionRuntimeMiscInputInteger:Ui,EShapeActionRuntimeMiscInputReal:Gi,EShapeActionRuntimeMiscInputText:Vi,EShapeActionRuntimeMiscInput:yi,EShapeActionRuntimeMiscWriteBoth:Xi,EShapeActionRuntimeMiscWriteLocal:Yi,EShapeActionRuntimeMiscWriteRemote:Ki,EShapeActionRuntimeMiscWrite:Wi,EShapeActionRuntimeOpenDiagram:Zr,EShapeActionRuntimeOpenDialogBoolean:Br,EShapeActionRuntimeOpenDialogInteger:Hr,EShapeActionRuntimeOpenDialogReal:Xr,EShapeActionRuntimeOpenDialogText:Jr,EShapeActionRuntimeOpenDialog:Lr,EShapeActionRuntimeOpenPageInplace:$r,EShapeActionRuntimeOpenPage:qr,EShapeActionRuntimeOpen:xr,EShapeActionRuntimeShowHide:Ie,EShapeActionRuntimeTransformMoveAbsoluteX:Re,EShapeActionRuntimeTransformMoveAbsoluteY:ye,EShapeActionRuntimeTransformMoveForwardOrBackward:ke,EShapeActionRuntimeTransformMoveLeftOrRight:xe,EShapeActionRuntimeTransformMoveRelativeX:Le,EShapeActionRuntimeTransformMoveRelativeY:Be,EShapeActionRuntimeTransformMove:Ae,EShapeActionRuntimeTransformResizeHeightAbsolute:He,EShapeActionRuntimeTransformResizeHeightRelative:Ve,EShapeActionRuntimeTransformResizeSizeAbsolute:We,EShapeActionRuntimeTransformResizeSizeRelative:Xe,EShapeActionRuntimeTransformResizeWidthAbsolute:Ye,EShapeActionRuntimeTransformResizeWidthRelative:Ke,EShapeActionRuntimeTransformResize:Ge,EShapeActionRuntimeTransformRotateAbsolute:qe,EShapeActionRuntimeTransformRotateRelative:$e,EShapeActionRuntimeTransformRotate:Ze,EShapeActionRuntime:St,EShapeActionRuntimes:ji,EShapeActionValueBase:xt,get EShapeActionValueBlinkType(){return Ot},EShapeActionValueBlink:Pt,EShapeActionValueChangeColorBrightness:Kt,EShapeActionValueChangeColorCode:Zt,get EShapeActionValueChangeColorTarget(){return Bt},get EShapeActionValueChangeColorTypeLegacy(){return Gt},get EShapeActionValueChangeColorType(){return zt},EShapeActionValueChangeColorTypes:Wt,EShapeActionValueChangeColor:Xt,EShapeActionValueChangeCursor:$t,get EShapeActionValueChangeTextType(){return Vt},EShapeActionValueChangeText:Bn,EShapeActionValueDeserializer:nu,EShapeActionValueEmitEvent:Ii,get EShapeActionValueMiscType(){return Ai},EShapeActionValueMisc:$i,get EShapeActionValueOnInputAction(){return di},EShapeActionValueOnInputActions:Ri,get EShapeActionValueOpenType(){return _r},EShapeActionValueOpen:Te,EShapeActionValueOpetyped:_e,get EShapeActionValueShowHideType(){return he},EShapeActionValueShowHide:Ce,EShapeActionValueSubtyped:Lt,get EShapeActionValueTransformMoveType(){return je},EShapeActionValueTransformMove:Fe,get EShapeActionValueTransformResizeType(){return Pe},EShapeActionValueTransformResize:Je,get EShapeActionValueTransformRotateType(){return ze},EShapeActionValueTransformRotate:tu,get EShapeActionValueTransformType(){return Ne},get EShapeActionValueType(){return kt},EShapeActionValues:_t,EShapeAction:_,loadShapeAll:Wo,loadShapeBar:uu,loadShapeCircle:Ou,loadShapeEmbedded:ns,loadShapeGroupShadowed:fs,loadShapeGroup:hs,loadShapeImage:As,loadShapeLabel:Ys,loadShapeLineOfCircles:Rh,loadShapeLineOfRectangleRoundeds:Wh,loadShapeLineOfRectangles:Zh,loadShapeLineOfTriangleRoundeds:lo,loadShapeLineOfTriangles:To,loadShapeLine:sh,loadShapeNull:Ao,loadShapeRectangleRounded:Bo,loadShapeRectangle:yo,loadShapeTriangleRounded:Vo,loadShapeTriangle:Uo,CIRCLE_VERTEX_COUNT:9,CIRCLE_INDEX_COUNT:8,CIRCLE_WORLD_SIZE:au,buildCircleClipping:fu,buildCircleIndex:lu,buildCircleVertex:vu,buildCircleStep:bu,buildCircleUv:gu,buildColor:lt,IMAGE_SDF_VERTEX_COUNT:9,IMAGE_SDF_INDEX_COUNT:8,IMAGE_SDF_WORLD_SIZE:Rs,buildImageSdfClipping:xs,buildImageSdfIndex:Ls,buildImageSdfStep:Bs,buildImageSdfVertex:_s,buildImageSdfUv:Ps,toLineOfAnyPointCount:hh,buildLineOfAnyColor:oh,toLineVertexCount:Zs,buildLineClipping:qs,buildLineIndex:$s,buildLineUv:Qs,buildLineVertexStepAndColorFill:th,buildNullClipping:ch,buildNullIndex:function(t,n,i,r){for(var e=3*i,u=3*(i+r);e<u;e+=3)t[e+0]=n,t[e+1]=n,t[e+2]=n},buildNullVertex:fh,buildNullStep:lh,buildNullUv:vh,RECTANGLE_ROUNDED_VERTEX_COUNT:yh,RECTANGLE_ROUNDED_INDEX_COUNT:24,RECTANGLE_ROUNDED_WORLD_SIZE:kh,buildRectangleRoundedIndex:Lh,buildRectangleRoundedVertex:Bh,buildRectangleRoundedClipping:_h,buildRectangleRoundedStep:Ph,buildRectangleRoundedUv:Fh,RECTANGLE_VERTEX_COUNT:ls,RECTANGLE_INDEX_COUNT:12,RECTANGLE_WORLD_SIZE:vs,buildRectangleClipping:gs,buildRectangleClippingVertical:ds,buildRectangleIndex:ms,buildRectangleVertex:ws,buildRectangleVertexVertical:ps,buildRectangleStep:Os,buildRectangleStepVertical:Ds,buildRectangleStepHorizontal:Es,buildRectangleUv:Ms,buildRectangleUvVertical:Ss,buildStep:su,TEXT_VERTEX_COUNT:4,TEXT_INDEX_COUNT:2,toTextBufferCount:w,buildTextClipping:p,buildTextIndex:O,buildTextStep:D,buildTextVertex:S,TRIANGLE_ROUNDED_VERTEX_COUNT:qh,TRIANGLE_ROUNDED_INDEX_COUNT:15,TRIANGLE_ROUNDED_WORLD_SIZE:$h,buildTriangleRoundedIndex:to,buildTriangleRoundedVertex:no,buildTriangleRoundedClipping:io,buildTriangleRoundedStep:ro,buildTriangleRoundedUv:eo,TRIANGLE_VERTEX_COUNT:7,TRIANGLE_INDEX_COUNT:3,TRIANGLE_WORLD_SIZE:vo,buildTriangleClipping:go,buildTriangleIndex:mo,buildTriangleVertex:wo,buildTriangleStep:po,buildTriangleUv:Oo,copyClipping:bh,copyIndex:gh,copyStep:dh,copyUvs:mh,copyVertex:wh,createBarUploaded:dt,createCircle:mu,createGroupUploaded:Su,createImageSdfUploaded:Us,createImageSdf:Va,createImage:function(t){return iu.toImageElement(t).then((function(t){return new Is(t)}))},createLabelUploaded:Vs,createLineOfAnyUploaded:ah,createLineOfCirclesUploaded:Nh,createLineOfRectangleRoundedsUploaded:zh,createLineOfRectanglesUploaded:Yh,createLineOfTriangleRoundedsUploaded:so,createLineOfTrianglesUploaded:Eo,createLineUploaded:ih,createLine:function(t,n,i,r){return new eh(t,n,i,r)},toLineStrokeWidth:function(t,n){if(0<=t&&t<n.length)try{return JSON.parse(n[t])[3]}catch(t){}return 8},createNullUploaded:No,createRectangleRoundedUploaded:xo,createRectangleUploaded:js,createTriangleRoundedUploaded:Go,createTriangleUploaded:Po,deserializeBar:eu,deserializeCircle:pu,deserializeEmbedded:ts,deserializeGroupShadowed:cs,deserializeGroup:ss,deserializeImageSdf:Gs,deserializeImage:Cs,deserializeLabel:Xs,deserializeLineOfCircles:Ah,deserializeLineOfRectangleRoundeds:Vh,deserializeLineOfRectangles:Jh,deserializeLineOfTriangleRoundeds:fo,deserializeLineOfTriangles:So,deserializeLine:uh,deserializeNull:Co,deserializeRectangleRounded:Lo,deserializeRectangle:Ro,deserializeTriangleRounded:Ho,deserializeTriangle:Fo,EShapeBarPoints:L,get EShapeBarPosition(){return b},EShapeBarUploaded:gt,EShapeBar:ft,EShapeBase:Y,EShapeCircleUploaded:du,EShapeCircle:wu,EShapeEmbeddedDatum:ju,EShapeEmbeddedLayerContainer:Vu,EShapeEmbeddedLayer:Hu,EShapeEmbedded:$u,EShapeEmbeddeds:Qu,EShapeFillImpl:$,EShapeGradients:X,EShapeGroupFillEditor:is,EShapeGroupFillViewer:Nu,EShapeGroupPoints:rs,EShapeGroupShadowed:as,EShapeGroupSizeEditor:Ru,EShapeGroupSizeLayout:Au,EShapeGroupSizeShadowed:os,EShapeGroupSizeViewer:yu,EShapeGroupStrokeEditor:es,EShapeGroupStrokeViewer:Lu,EShapeGroupTextAlignEditor:Xu,EShapeGroupTextAlignViewer:Bu,EShapeGroupTextEditor:qu,EShapeGroupTextOffsetEditor:Yu,EShapeGroupTextOffsetViewer:_u,EShapeGroupTextOutlineEditor:Ku,EShapeGroupTextOutlineViewer:Pu,EShapeGroupTextPaddingEditor:Ju,EShapeGroupTextPaddingViewer:Fu,EShapeGroupTextSpacingEditor:Zu,EShapeGroupTextSpacingViewer:Uu,EShapeGroupTextViewer:zu,EShapeGroupUploaded:Mu,EShapeGroupViewer:Gu,EShapeGroup:us,EShapeImageSdfUploaded:Fs,EShapeImageSdf:zs,EShapeImage:Is,EShapeLabelUploaded:Hs,EShapeLabel:Ws,EShapeLineBase:ct,EShapeLineOfAnyPointsFillImpl:Dh,EShapeLineOfAnyPointsImpl:Sh,EShapeLineOfAnyPointsPointImpl:Eh,EShapeLineOfAnyPointsStrokeImpl:Mh,EShapeLineOfAnyUploaded:Th,EShapeLineOfCirclesUploaded:jh,EShapeLineOfCircles:Ch,EShapeLineOfRectangleRoundedsUploaded:Uh,EShapeLineOfRectangleRoundeds:Hh,EShapeLineOfRectanglesUploaded:Xh,EShapeLineOfRectangles:Kh,EShapeLineOfTriangleRoundedsUploaded:uo,EShapeLineOfTriangleRoundeds:co,EShapeLineOfTrianglesUploaded:Do,EShapeLineOfTriangles:Mo,EShapeLinePoints:rh,EShapeLineUploaded:nh,EShapeLine:eh,EShapeNullUploaded:jo,EShapeNull:Io,EShapePrimitive:at,EShapeRectangleRoundedUploaded:ko,EShapeRectangleRounded:Gh,EShapeRectangleUploaded:Ts,EShapeRectangle:Ns,EShapeStrokeImpl:Q,EShapeTagImpl:et,EShapeTagValueImpl:rt,EShapeTagValueRangeImpl:nt,EShapeTextAlignImpl:ut,EShapeTextImpl:ot,EShapeTextOffsetImpl:st,EShapeTextOutlineImpl:ht,EShapeTextUploaded:bt,EShapeTriangleRoundedUploaded:zo,EShapeTriangleRounded:ao,EShapeTriangleUploaded:_o,EShapeTriangle:ho,isStatic:ph,toComputed:Oh,toHitThreshold:Ih,toLength:g,STEP_VALUES:hu,toStep:ou,EShapeBufferUnitBuilder:Xa,EShapeBufferUnit:Wa,EShapeBuffer:Ya,EShapeCapabilities:Eu,get EShapeCapability(){return Qe},EShapeContainer:uc,get EShapeCorner(){return P},EShapeDeleter:hc,EShapeDefaults:q,EShapeDeserializer:ru,EShapeDeserializers:i,EShapeEditor:Iu,EShapeImageElements:iu,get EShapePointsStyle(){return r},EShapeRendererIteratorDatum:ic,EShapeRendererIterator:rc,EShapeRenderer:ec,EShapeResourceManagerDeserialization:Tu,EShapeResourceManagerSerialization:oc,get EShapeRuntimeReset(){return tt},EShapeRuntime:Dt,EShapeRuntimes:ac,EShapeSearch:sc,EShapeSizes:Ue,get EShapeStrokeSide(){return Du},get EShapeTagValueRangeType(){return J},get EShapeTagValueOrder(){return K},get EShapeTextAlignHorizontal(){return h},get EShapeTextAlignVertical(){return o},get EShapeTextDirection(){return a},get EShapeTextWeight(){return u},get EShapeTextStyle(){return s},EShapeTransformImpl:H,EShapeTransforms:Cu,get EShapeType(){return n},EShapeUploadedBase:vt,EShapeUploadeds:e,get EShapeCopyPart(){return k},ESnapperGrid:cc,ESnapperResultScale:function(){this.distance=NaN,this.scale=new t.Point},ESnapperResult:fc,get ESnapperTargetValueType(){return ua},ESnapperTargetValue:vc,ESnapperTarget:bc,get ESnapperModifierAnchor(){return lc},ESnapper:dc,DThemes:Z,DynamicAtlasItemEmpty:Ja,DynamicAtlasItemFontAtlas:$a,DynamicAtlasItemImage:tc,DynamicAtlasItemText:mc,DynamicAtlasItemWhite:Za,DynamicAtlasItem:Ka,DynamicAtlas:qa,DynamicFontAtlasCharacterOrigin:xi,DynamicFontAtlasCharacter:Li,DynamicFontAtlasFont:wc,DynamicFontAtlas:pc,DynamicFontAtlases:Sc,DynamicSDFFontAtlas:_i,DynamicSDFFontAtlases:Qa,DynamicSDFFontGenerator:Bi,isArray:wt,isFunction:_n,isNaN:Oe,isNumber:F,isString:mt,Lazy:Tc,NumberFormatterImpl:Rn,NumberFormatters:yn,toCeilingIndex:jc,toIndexOf:Ks,toLabel:function(t){if(null!=t){if(mt(t))return t;if(F(t))return String(t);if("name"in t)return t.name;if("label"in t)return t.label;if("id"in t)return t.id}return""},toPadded:V,toString:Nc,toSvgTexture:function(n,i){return t.Texture.from(Ic(n),{resolution:i})},toSvgUrl:Ic,UtilAlpha:Ft,UtilSvgAtlasBuilder:Rc,get UtilAttachAlign(){return qo},UtilAttach:sa,UtilClickOutside:mr,UtilClipboard:na,UtilDragEasingHistory:pi,UtilDragEasing:Oi,UtilDrag:Di,UtilExtract:xc,UtilExtractor:yc,UtilFileDownloader:kc,get UtilFileAs(){return Ac},UtilFileOpener:Bc,UtilHsv:_c,UtilKeyboardEvent:pt,UtilName:Pc,UtilOverlay:wr,UtilPointerEvent:ai,UtilPromise:Fc,UtilRgb:W,UtilRgba:Uc,UtilStateBlinker:zc,UtilTexturePlane:Gc,UtilTexture:Hc,UtilTransition:Vc,UtilWheelEvent:Wc,get DAlignHorizontal(){return Ji},get DAlignVertical(){return Zi},get DAlignWith(){return qi},DAnimationBase:wi,DAnimationEmpty:Xc,DAnimationFadeIn:gr,DAnimationTimings:mi,DApplicationLayerOptions:Kc,DApplicationLayer:uf,DApplicationPadding:Yc,DApplication:sf,DApplications:B,DBaseAutoSet:fi,DBaseAuto:ci,DBaseBackground:Pn,DBaseBorder:Un,DBaseCorner:Gn,get DBaseInteractive(){return zn},DBaseOutline:Wn,DBasePadding:Xn,DBasePoint:Yn,DBaseReflowable:Qn,get DBaseState(){return x},DBaseStateSetImpl:U,DBase:li,DBoard:hf,get DBorderMask(){return Ln},DButtonAmbient:te,DButtonBase:lr,DButtonCheckRight:af,DButtonCheck:of,DButtonColorGradient:Tf,DButtonColor:Nf,DButtonDanger:If,DButtonDate:Af,DButtonDatetime:Lf,DButtonFileAs:Bf,DButtonFile:_f,DButtonGroup:Cr,DButtonLink:Pf,DButtonPrimary:br,DButtonRadioRight:Uf,DButtonRadio:Ff,DButtonRedo:zf,DButtonSecondary:Gf,DButtonSelect:fl,DButtonTime:vl,DButtonUndo:bl,DButton:vr,DCanvasContainer:Ti,DCanvas:gl,DChartAxisBaseOptionParser:wl,DChartAxisBase:pl,DChartAxisContainerImpl:Ol,get DChartAxisPosition(){return Hf},get DChartAxisTickPosition(){return Vf},DChartAxisXDatetime:El,DChartAxisX:Dl,DChartAxisY:Ml,DChartColorSet1:function(t){return Sl[t%Sl.length]},DChartColorSet2:jl,DChartCoordinateContainerImpl:Cl,DChartCoordinateContainerSubImpl:Il,DChartCoordinateLinearTick:Al,DChartCoordinateLinear:xl,DChartCoordinateLogTick:Ll,DChartCoordinateLog:Bl,DChartCoordinateTransformImpl:Rl,get DChartCoordinateDirection(){return dl},DChartLegendItem:_l,DChartLegend:Pl,DChartOverview:Fl,DChartPlotArea:$l,DChartRegionImplObservable:Ql,DChartRegionImpl:kl,DChartSeriesBar:rv,DChartSeriesBaseCoordinateContainer:tv,DChartSeriesBase:nv,DChartSeriesContainerImpl:ql,DChartSeriesFillComputedImpl:Gl,DChartSeriesFillImpl:Vl,DChartSeriesLineOfAny:iv,DChartSeriesLineOfCircles:ev,DChartSeriesLineOfRectangleRoundeds:uv,DChartSeriesLineOfRectangles:sv,DChartSeriesLineOfTriangleRoundeds:ov,DChartSeriesLineOfTriangles:hv,DChartSeriesLine:av,DChartSeriesExpressionParametersImpl:cv,DChartSeriesLinear:fv,DChartSeriesPaddingComputedImpl:Wl,DChartSeriesPaddingImpl:Xl,DChartSeriesPointComputedImpl:Yl,DChartSeriesPointImpl:Kl,DChartSeriesScalars:Hl,DChartSelectionGridlineContainerImpl:gv,DChartSelectionGridlineX:vv,DChartSelectionGridlineY:bv,DChartSelectionMarker:dv,DChartSelectionShapeBase:lv,DChartSelectionSimple:wv,DChartSelectionSubImpl:mv,get DChartSelectionPoint(){return Nl},DChartSeriesStrokeImpl:Zl,DChartSeriesHitResult:zl,DChart:pv,DColorGradientObservable:lf,DColorGradientPointObservable:cf,DCommandClear:qc,DCommandCreate:Ov,DCommandDelete:Dv,get DCommandFlag(){return Lc},DCommandRedo:$c,DCommandSaveAs:Ev,DCommandSave:Mv,DCommandUndo:Qc,DContent:Xf,DControllerDefaultCommand:nf,DControllerDefaultFocus:Jc,DControllerKeyboard:rf,DControllers:ef,get DCornerMask(){return Fn},DDiagramCanvasBase:Av,DDiagramCanvasEditor:Rv,DDiagramCanvasTileMappingImpl:jv,DDiagramCanvasTileMappingPointImpl:Tv,DDiagramCanvasTile:Nv,DDiagramCanvas:yv,DDiagramEditor:Bv,DDiagramLayerContainer:Cv,DDiagramLayer:Iv,DDiagramSerializedVersion:1,DDiagramShape:_v,DDiagramTag:Fv,DDiagram:Uv,DDiagrams:Wu,get DDialogCloseOn(){return Qi},DDialogColorGradient:Sf,DDialogColor:jf,DDialogCommand:jr,DDialogConfirmDelete:Hv,DDialogConfirmDiscard:Vv,DDialogConfirmMessage:zv,DDialogConfirm:Gv,DDialogDate:Me,DDialogDates:Cf,DDialogDatetime:me,DDialogDatetimes:Rf,DDialogInput:Ir,DDialogInputBoolean:kr,DDialogInputInteger:Gr,DDialogInputReal:Wr,DDialogInputText:Kr,DDialogMessage:Wv,DDialogProcessingMessage:Xv,DDialogProcessing:Yv,DDialogSaveAs:Kv,DDialogSelectListItem:el,DDialogSelectList:rl,DDialogSelect:ol,DDialogTime:pe,DDialogTimes:ll,DDialog:pr,DDropdown:Qv,get DDragMode(){return bi},DDynamicTextGeometry:rr,DDynamicTextStyle:er,DDynamicTextMeasureResultCharacter:tr,DDynamicTextMeasureResult:nr,DDynamicTextMeasure:ir,DDynamicText:ur,DExpandableHeader:tb,DExpandable:nb,get DHtmlElementWhen(){return Or},DHtmlElement:Pr,DImageBase:fr,DImage:Xo,DInputAndLabel:bf,DInputBooleanButtonOff:Ar,DInputBooleanButtonOn:Rr,DInputBoolean:yr,DInputIntegerAndLabel:ib,DInputInteger:zr,DInputLabel:vf,DInputNumber:Ur,DInputRealAndLabel:gf,DInputReal:Vr,DInputTextAndLabel:df,DInputText:Yr,DInput:Fr,get DLayoutClearType(){return Hn},get DLayoutDirection(){return dr},DLayoutHorizontal:Sr,DLayoutSpace:Dr,DLayoutVertical:Tr,DLayout:Mr,get DLinkMenuItemId(){return ku},get DLinkTarget(){return xu},DLink:ia,DListItemSeparatorReflowable:aa,DListItemSeparator:ca,DListItem:Yo,get DListSelectionMode(){return Zc},DListSelection:Wf,DList:il,DMapCoordinateEPSG3857:rb,DMapCoordinates:eb,DMapTilePlane:sb,DMapTilePyramidImpl:hb,DMapTileUrlBuilderKokudo:function(t,n,i){return 5<=t?"https://cyberjapandata.gsi.go.jp/xyz/pale/"+t+"/"+n+"/"+i+".png":2<=t?"https://cyberjapandata.gsi.go.jp/xyz/std/"+t+"/"+n+"/"+i+".png":"https://cyberjapandata.gsi.go.jp/xyz/earthhillshade/"+t+"/"+n+"/"+i+".png"},DMapTileUrlBuilderOsm:function(t,n,i){return"https://"+"abc"[(n+i)%3]+".tile.openstreetmap.org/"+t+"/"+n+"/"+i+".png"},DMapTileUrlBuilderOsmfj:ob,DMapTilePyramids:ab,DMapTile:ub,DMenuAlign:ha,DMenuBarItem:cb,DMenuBar:fb,DMenuContext:Jv,DMenuItemCheck:Zo,DMenuItemExpandableBody:ba,DMenuItemExpandableHeader:ga,DMenuItemExpandableItemCheck:wa,DMenuItemExpandableItemLink:pa,DMenuItemExpandableItemMenu:Ba,DMenuItemExpandableItemSeparator:Oa,DMenuItemExpandableItemSpace:Da,DMenuItemExpandableItemText:Ea,DMenuItemExpandable:ma,DMenuItemExpandables:da,DMenuItemLinkState:ra,DMenuItemLink:ea,DMenuItemMenu:oa,DMenuItemSeparator:fa,DMenuItemSpace:la,DMenuItemText:Jo,DMenuItem:Ko,DMenuSidedItemCheck:Sa,DMenuSidedItemExpandableItemCheck:xa,DMenuSidedItemExpandableItemLink:La,DMenuSidedItemExpandableItemMenu:_a,DMenuSidedItemExpandableItemSeparator:Pa,DMenuSidedItemExpandableItemSpace:Fa,DMenuSidedItemExpandableItemText:Ua,DMenuSidedItemExpandable:ka,DMenuSidedItemExpandables:ya,DMenuSidedItemLink:Ta,DMenuSidedItemMenu:ja,DMenuSidedItemSeparator:Na,DMenuSidedItemSpace:Ia,DMenuSidedItemText:Ca,DMenuSided:db,DMenuSideds:Aa,DMenu:Zv,DMenus:$o,get DMouseModifier(){return ti},DMouseModifiers:gi,DNote:sl,DNotification:mb,DPagination:Db,DPaginationNavigationButton:Ob,DPaginationDynamicButtons:pb,DPaginationDotsButton:wb,DPane:nl,DPickerColorAndAlpha:mf,DPickerColorGradientRecent:Df,DPickerColorGradientView:Ef,DPickerColorGradient:Mf,DPickerColorRecent:wf,DPickerColor:pf,DPickerDate:Ee,DPickerDates:yf,DPickerDatetimeButtonBack:ne,DPickerDatetimeButtonDate:ie,DPickerDatetimeButtonNext:re,DPickerDatetimeLabelDate:ue,DPickerDatetimeLabel:ee,get DPickerDatetimeMask(){return Qr},DPickerDatetimeSpace:se,DPickerDatetime:de,DPickerDatetimes:xf,DPickerDatetimeRange:Eb,DPickerTimeRange:Mb,DPickerTimeBoundHours:ce,DPickerTimeBoundMinutes:fe,DPickerTimeBoundSeconds:le,DPickerTimeBounds:ve,DPickerTime:ge,DPickerTimes:kf,DScalarExpression:ri,DScalarFunctions:oi,DScrollBarHorizontal:qf,DScrollBarThumbHorizontal:Zf,DScrollBarThumbReflowableHorizontal:Jf,DScrollBarThumbReflowableVertical:$f,DScrollBarThumbVertocal:Qf,DScrollBarThumb:Kf,DScrollBarVertical:tl,DScrollBar:Yf,DSelectMultiple:Sb,DSelect:Tb,DShadowImpl:jb,DSliderHorizontal:kb,DSliderVertical:Lb,DTableBodyCellActionDialog:Pb,DTableBodyCellActionMenu:Fb,DTableBodyCellActionPromise:zb,DTableBodyCellButton:Hb,DTableBodyCellCheck:Wb,DTableBodyCellColor:Yb,DTableBodyCellDate:Kb,DTableBodyCellDatetime:Jb,DTableBodyCellIndex:Zb,DTableBodyCellInputInteger:qb,DTableBodyCellInputReal:$b,DTableBodyCellInputText:Qb,DTableBodyCellInputTreeInput:tg,DTableBodyCellInputTreeMarker:ng,DTableBodyCellInputTree:rg,toLinkOptions:eg,toUrl:ug,toChecker:sg,DTableBodyCellLink:hg,DTableBodyCellSelectDialog:_b,DTableBodyCellSelectMenu:og,DTableBodyCellSelectMultiple:ag,DTableBodyCellSelectPromise:Ub,DTableBodyCellText:Gb,DTableBodyCellTree:fg,DTableBodyRow:gg,DTableBody:Sg,DTableCategoryCell:Tg,DTableCategory:jg,DTableCellState:ig,get DTableColumnType(){return vb},DTableDataFilterImpl:dg,DTableDataListMapped:mg,DTableDataList:Mg,DTableDataSelectionImpl:Og,get DTableDataSelectionType(){return Vb},DTableDataSorterImpl:Eg,get DTableDataOrder(){return wg},DTableDataTree:Cg,DTableHeaderCell:Rg,DTableHeader:yg,DTableRow:vg,DTable:Zg,DTextBase:cr,DText:Nr,get DTreeAddedItemPosition(){return Dg},DTree:hd,DTreeItem:ud,DTreeItemTextAndImage:$g,DTreeItemState:qg,DViewDragImpl:Ei,DViewImpl:Si,DViewTransformImpl:Mi};Ha();var ad=window;ad.wcardinal=ad.wcardinal||{},ad.wcardinal.ui=od}(PIXI);
//# sourceMappingURL=wcardinal-ui.min.js.map
