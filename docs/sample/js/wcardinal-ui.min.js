/*
 Winter Cardinal UI v0.5.0
 Copyright (C) 2019 Toshiba Corporation
 SPDX-License-Identifier: Apache-2.0

 Material Design icons by Google
 Apache license version 2.0.
*/
!function(t){"use strict";
/*! *****************************************************************************
    Copyright (c) Microsoft Corporation. All rights reserved.
    Licensed under the Apache License, Version 2.0 (the "License"); you may not use
    this file except in compliance with the License. You may obtain a copy of the
    License at http://www.apache.org/licenses/LICENSE-2.0

    THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
    KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
    WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
    MERCHANTABLITY OR NON-INFRINGEMENT.

    See the Apache Version 2.0 License for specific language governing permissions
    and limitations under the License.
    ***************************************************************************** */var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var i in n)n.hasOwnProperty(i)&&(t[i]=n[i])})(t,i)};function i(t,i){function r(){this.constructor=t}n(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}var r,e=function(){function t(){}return t.add=function(n){t.INSTANCES.push(n)},t.first=function(){var n=t.INSTANCES;if(0<n.length)return n[0];throw new Error("No application found.")},t.last=function(){var n=t.INSTANCES;if(0<n.length)return n[n.length-1];throw new Error("No application found.")},t.get=function(n){var i=t.INSTANCES;return 0<=n&&n<i.length?i[n]:null},t.indexOf=function(n){return t.INSTANCES.indexOf(n)},t.size=function(){return t.INSTANCES.length},t.toStage=function(t){for(var n=t;n.parent;)n=n.parent;return"application"in n&&"layer"in n?n:null},t.find=function(t){var n=this.toStage(t);return n?n.layer.application:null},t.getLayerBase=function(t){var n=this.toStage(t);return n?n.layer.application.getLayerBase():null},t.getLayerOverlay=function(t){var n=this.toStage(t);return n?n.layer.application.getLayerOverlay():null},t.getLayer=function(t){var n=this.toStage(t);return n?n.layer:null},t.update=function(n){if(n){var i=this.toStage(n);i&&i.layer.update()}else for(var r=t.INSTANCES,e=0,u=r.length;e<u;++e)r[e].update()},t.render=function(n){if(n){var i=this.toStage(n);i&&i.layer.render()}else for(var r=t.INSTANCES,e=0,u=r.length;e<u;++e)r[e].render()},t.INSTANCES=[],t}(),u=function(t){return"function"==typeof t},s=function(){function t(t,n,i){if(this.i=t,this.u=i,null!=n&&null!=n.background){var r=n.background;this.h=r.color,this.o=r.alpha}}return t.prototype.getTheme=function(){return this.i},t.prototype.setTheme=function(t){this.i=t},t.prototype.getColor=function(t){var n=this.h;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getBackgroundColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.h!==t&&(this.h=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.getAlpha=function(t){var n=this.o;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getBackgroundAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.onChange=function(){var t=this.u;null!=t&&t()},t}();!function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=4]="BOTTOM",t[t.LEFT=8]="LEFT",t[t.TOP_RIGHT=3]="TOP_RIGHT",t[t.TOP_BOTTOM=5]="TOP_BOTTOM",t[t.TOP_LEFT=9]="TOP_LEFT",t[t.RIGHT_BOTTOM=6]="RIGHT_BOTTOM",t[t.RIGHT_LEFT=10]="RIGHT_LEFT",t[t.BOTTOM_LEFT=12]="BOTTOM_LEFT",t[t.NOT_TOP=14]="NOT_TOP",t[t.NOT_RIGHT=13]="NOT_RIGHT",t[t.NOT_BOTTOM=11]="NOT_BOTTOM",t[t.NOT_LEFT=7]="NOT_LEFT",t[t.ALL=15]="ALL"}(r||(r={}));var h,o=function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},a=function(){function t(t,n,i){if(this.i=t,this.u=i,null!=n&&null!=n.border){var e=n.border;this.h=e.color,this.o=e.alpha,this.l=e.width,this.v=e.align,this.g=o(e.mask)?r[e.mask]:e.mask}}return t.prototype.getTheme=function(){return this.i},t.prototype.setTheme=function(t){this.i=t},t.prototype.getColor=function(t){var n=this.h;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getBorderColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.h!==t&&(this.h=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.getAlpha=function(t){var n=this.o;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getBorderAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.getWidth=function(t){var n=this.l;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getBorderWidth(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this.l},set:function(t){this.l!==t&&(this.l=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.getAlign=function(t){var n=this.v;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getBorderAlign(t)},Object.defineProperty(t.prototype,"align",{get:function(){return this.v},set:function(t){this.v!==t&&(this.v=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.getMask=function(t){var n=this.g;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getBorderMask(t)},Object.defineProperty(t.prototype,"mask",{get:function(){return this.g},set:function(t){this.g!==t&&(this.g=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.onChange=function(){var t=this.u;null!=t&&t()},t}();!function(t){t[t.NONE=0]="NONE",t[t.TOP_LEFT=1]="TOP_LEFT",t[t.TOP_RIGHT=2]="TOP_RIGHT",t[t.BOTTOM_LEFT=4]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT",t[t.TOP=3]="TOP",t[t.BOTTOM=12]="BOTTOM",t[t.LEFT=5]="LEFT",t[t.RIGHT=10]="RIGHT",t[t.ALL=15]="ALL"}(h||(h={}));var f,c=function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},l=function(){function t(t,n,i){if(this.i=t,this.u=i,null!=n&&null!=n.corner){var r=n.corner;c(r)?(this.O=r,this.g=void 0):(this.O=r.radius,this.g=o(r.mask)?h[r.mask]:r.mask)}}return t.prototype.getTheme=function(){return this.i},t.prototype.setTheme=function(t){this.i=t},t.prototype.getRadius=function(){var t=this.O;return void 0!==t?t:this.i.getCornerRadius()},Object.defineProperty(t.prototype,"radius",{get:function(){return this.O},set:function(t){if(this.O!==t){this.O=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t.prototype.getMask=function(){var t=this.g;return void 0!==t?t:this.i.getCornerMask()},Object.defineProperty(t.prototype,"mask",{get:function(){return this.g},set:function(t){if(this.g!==t){this.g=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n){var i=!1;this.O!==t&&(this.O=t,i=!0),this.g!==n&&(this.g=n,i=!0);var r=this.u;i&&null!=r&&r()},t}();!function(t){t[t.NONE=0]="NONE",t[t.SELF=1]="SELF",t[t.CHILDREN=2]="CHILDREN",t[t.BOTH=3]="BOTH"}(f||(f={}));var v,b=function(){function t(t,n,i){if(this.i=t,this.u=i,null!=n&&null!=n.outline){var e=n.outline;this.h=e.color,this.o=e.alpha,this.l=e.width,this.S=e.offset,this.v=e.align,this.g=o(e.mask)?r[e.mask]:e.mask}}return t.prototype.getTheme=function(){return this.i},t.prototype.setTheme=function(t){this.i=t},t.prototype.getColor=function(t){var n=this.h;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getOutlineColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){if(this.h!==t){this.h=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t.prototype.getAlpha=function(t){var n=this.o;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getOutlineAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){if(this.o!==t){this.o=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t.prototype.getWidth=function(t){var n=this.l;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getOutlineWidth(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this.l},set:function(t){if(this.l!==t){this.l=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t.prototype.getOffset=function(t){var n=this.S;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getOutlineOffset(t)},Object.defineProperty(t.prototype,"offset",{get:function(){return this.S},set:function(t){if(this.S!==t){this.S=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t.prototype.getAlign=function(t){var n=this.v;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getOutlineAlign(t)},Object.defineProperty(t.prototype,"align",{get:function(){return this.v},set:function(t){if(this.v!==t){this.v=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t.prototype.getMask=function(t){var n=this.g;if(void 0!==n){if(!u(n))return n;var i=n(t);if(void 0!==i)return i}return this.i.getOutlineMask(t)},Object.defineProperty(t.prototype,"mask",{get:function(){return this.g},set:function(t){if(this.g!==t){this.g=t;var n=this.u;null!=n&&n()}},enumerable:!0,configurable:!0}),t}(),g=function(){function t(t,n,i){if(this.i=t,this.u=i,null!=n&&null!=n.padding){var r=n.padding;c(r)?(this.N=r,this.T=r,this.j=r,this.C=r):(this.N=r.left,this.T=r.top,this.j=r.right,this.C=r.bottom)}}return t.prototype.getTheme=function(){return this.i},t.prototype.setTheme=function(t){this.i=t},t.prototype.getLeft=function(){var t=this.N;return void 0!==t?t:this.i.getPaddingLeft()},Object.defineProperty(t.prototype,"left",{get:function(){return this.N},set:function(t){this.N!==t&&(this.N=t,null!=this.u&&this.u())},enumerable:!0,configurable:!0}),t.prototype.getTop=function(){var t=this.T;return void 0!==t?t:this.i.getPaddingTop()},Object.defineProperty(t.prototype,"top",{get:function(){return this.T},set:function(t){this.T!==t&&(this.T=t,null!=this.u&&this.u())},enumerable:!0,configurable:!0}),t.prototype.getRight=function(){var t=this.j;return void 0!==t?t:this.i.getPaddingRight()},Object.defineProperty(t.prototype,"right",{get:function(){return this.j},set:function(t){this.j!==t&&(this.j=t,null!=this.u&&this.u())},enumerable:!0,configurable:!0}),t.prototype.getBottom=function(){var t=this.C;return void 0!==t?t:this.i.getPaddingBottom()},Object.defineProperty(t.prototype,"bottom",{get:function(){return this.C},set:function(t){this.C!==t&&(this.C=t,null!=this.u&&this.u())},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n,i,r){null==n?(this.top=t,this.right=t,this.bottom=t,this.left=t):null==i?(this.top=t,this.right=n,this.bottom=t,this.left=n):null==r?(this.top=t,this.right=n,this.bottom=i,this.left=n):(this.top=t,this.right=n,this.bottom=i,this.left=r),null!=this.u&&this.u()},t}(),d=function(){function t(t,n,i){this.k=t,this.cb=n}return Object.defineProperty(t.prototype,"x",{get:function(){return this.k.x},set:function(t){var n=this.k;n.x!==t&&(n.x=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this.k.y},set:function(t){var n=this.k;n.y!==t&&(n.y=t,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n){var i=this.k;i.x===t&&i.y===n||(i.set(t,n),this.cb.call(this.scope))},t.prototype.copyFrom=function(t){var n=this.k;return n.x===t.x&&n.y===t.y||(n.copyFrom(t),this.cb.call(this.scope)),this},t.prototype.copyTo=function(t){return t.copyFrom(this.k)},t.prototype.copy=function(){return this.copyFrom(arguments[0])},t.prototype.clone=function(n,i){return n=n||this.cb,i=i||this.scope,new t(this.k,n,i)},t.prototype.equals=function(t){return this.k.equals(t)},t}(),m=function(t){function n(n,i,r,e,u){var s=t.call(this,new Float32Array(56),new Float32Array(56),new Uint16Array(42))||this;return s.l=i,s.I=r,s.A=n,s.R=e,s.L=u,s.B=!0,s.P=NaN,s.F=s.getBuffer("aVertexPosition"),s._=s.F.data,s.U=s.getBuffer("aTextureCoord"),s._uvs=s.U.data,s.G=s.getIndex(),s.V=s.G.data,s}return i(n,t),Object.defineProperty(n.prototype,"borderSize",{get:function(){return this.R},set:function(t){this.R!==t&&(this.R=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cornerMask",{get:function(){return this.L},set:function(t){this.L!==t&&(this.L=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.l},set:function(t){this.l!==t&&(this.l=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.I},set:function(t){this.I!==t&&(this.I=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this.A},set:function(t){this.A!==t&&(this.A=t,this.B=!0,this.P=NaN)},enumerable:!0,configurable:!0}),n.prototype.getTextureId=function(){return this.A._updateID},n.prototype.fillVertices=function(t,n,i,r,e,u){n[t+0]=i,n[t+1]=e,n[t+2]=r,n[t+3]=e,n[t+4]=i,n[t+5]=u,n[t+6]=r,n[t+7]=u},n.prototype.fillIndices=function(t,n,i){n[t+0]=i+0,n[t+1]=i+1,n[t+2]=i+2,n[t+3]=i+1,n[t+4]=i+3,n[t+5]=i+2},n.prototype.fillUvsCorner=function(t,n,i,r,e,u,s,h,o,a,f){i?this.fillVertices(t,n,r,e,h,o):this.fillVertices(t,n,s,u,h,o)},n.prototype.fillUvs=function(t,n,i,r,e,u){this.fillVertices(t,n,i,r,e,u)},n.prototype.update=function(){var t=this.texture;if(t.valid){var n=this.getTextureId();if(this.B||this.P!==n){this.B=!1,this.P=n;var i=this._,r=this._uvs,e=this.V,u=this.l,s=this.I,o=this.R,a=Math.min(.5*u,o),f=Math.max(.5*u,u-o),c=u,l=Math.min(.5*s,o),v=Math.max(.5*s,s-o),b=s,g=t._uvs,d=g.x0,m=g.x1,w=g.y0,p=g.y3,D=(m-d)*(o/t.width),O=(p-w)*(o/t.height),S=d,M=d+D,E=m-D,N=m,T=w,j=w+O,C=p-O,k=p,y=this.L,I=!(y&h.TOP_LEFT),A=!(y&h.TOP_RIGHT),x=!(y&h.BOTTOM_LEFT),R=!(y&h.BOTTOM_RIGHT),L=0,B=0,P=0;this.fillVertices(L,i,0,a,0,l),this.fillUvsCorner(L,r,I,S,M,E,N,T,j,C,k),this.fillIndices(P,e,B),L+=8,B+=4,P+=6,this.fillVertices(L,i,a,f,0,l),this.fillUvs(L,r,M,E,T,j),this.fillIndices(P,e,B),L+=8,B+=4,P+=6,this.fillVertices(L,i,c,f,0,l),this.fillUvsCorner(L,r,A,S,M,E,N,T,j,C,k),this.fillIndices(P,e,B),L+=8,B+=4,P+=6,this.fillVertices(L,i,0,c,l,v),this.fillUvs(L,r,S,N,j,C),this.fillIndices(P,e,B),L+=8,B+=4,P+=6,this.fillVertices(L,i,0,a,b,v),this.fillUvsCorner(L,r,x,S,M,E,N,T,j,C,k),this.fillIndices(P,e,B),L+=8,B+=4,P+=6,this.fillVertices(L,i,a,f,v,b),this.fillUvs(L,r,M,E,C,k),this.fillIndices(P,e,B),L+=8,B+=4,P+=6,this.fillVertices(L,i,c,f,b,v),this.fillUvsCorner(L,r,R,N,E,M,S,k,C,j,T),this.fillIndices(P,e,B),this.F.update(),this.U.update(),this.G.update()}}},n}(t.MeshGeometry),w=function(n){function r(i,r,e){return n.call(this,new m(i,100,100,r,e),new t.MeshMaterial(i))||this}return i(r,n),Object.defineProperty(r.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this.geometry.texture=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.geometry.width},set:function(t){this.geometry.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.geometry.height},set:function(t){this.geometry.height=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderSize",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.borderSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cornerMask",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.cornerMask=t},enumerable:!0,configurable:!0}),r.prototype._render=function(t){this.geometry.update(),n.prototype._render.call(this,t)},r.prototype.update=function(){this.geometry.update()},r}(t.Mesh),p=function(t){function n(n,i,r,e,u,s){var h=t.call(this,new Float32Array(64),new Float32Array(64),new Uint16Array(48))||this;return h.l=i,h.I=r,h.A=n,h.R=e,h.W=u,h.L=s,h.B=!0,h.P=NaN,h.F=h.getBuffer("aVertexPosition"),h._=h.F.data,h.U=h.getBuffer("aTextureCoord"),h._uvs=h.U.data,h.G=h.getIndex(),h.V=h.G.data,h}return i(n,t),Object.defineProperty(n.prototype,"borderMask",{get:function(){return this.W},set:function(t){this.W!==t&&(this.W=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cornerMask",{get:function(){return this.L},set:function(t){this.L!==t&&(this.L=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"borderSize",{get:function(){return this.R},set:function(t){this.R!==t&&(this.R=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.l},set:function(t){this.l!==t&&(this.l=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.I},set:function(t){this.I!==t&&(this.I=t,this.B=!0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this.A},set:function(t){this.A!==t&&(this.A=t,this.B=!0,this.P=NaN)},enumerable:!0,configurable:!0}),n.prototype.fillVertices=function(t,n,i,r,e,u){n[t+0]=i,n[t+1]=e,n[t+2]=r,n[t+3]=e,n[t+4]=i,n[t+5]=u,n[t+6]=r,n[t+7]=u},n.prototype.fillIndices=function(t,n,i){n[t+0]=i+0,n[t+1]=i+1,n[t+2]=i+2,n[t+3]=i+1,n[t+4]=i+3,n[t+5]=i+2},n.prototype.fillUvsCorner=function(t,n,i,r,e,u,s,h,o,a,f,c,l){i||r?e?this.fillVertices(t,n,u,s,a,f):i&&r?this.fillVertices(t,n,o,h,a,f):i?this.fillVertices(t,n,s,h,a,f):this.fillVertices(t,n,u,s,f,c):this.fillVertices(t,n,s,s,f,f)},n.prototype.fillUvs=function(t,n,i,r,e,u,s,h,o){i?this.fillVertices(t,n,r,e,u,s):this.fillVertices(t,n,h,h,o,o)},n.prototype.update=function(){var t=this.A;if(t.valid){var n=t._updateID;if(this.B||this.P!==n){this.B=!1,this.P=n;var i=this._,e=this._uvs,u=this.V,s=this.l,o=this.I,a=this.R,f=Math.min(.5*s,a),c=Math.max(.5*s,s-a),l=s,v=Math.min(.5*o,a),b=Math.max(.5*o,o-a),g=o,d=t._uvs,m=d.x0,w=d.x1,p=d.y0,D=d.y3,O=(w-m)*(a/t.width),S=(D-p)*(a/t.height),M=m,E=m+O,N=w-O,T=w,j=p,C=p+S,k=D-S,y=D,I=this.W,A=!(I&r.TOP),x=!(I&r.BOTTOM),R=!(I&r.LEFT),L=!(I&r.RIGHT),B=this.L,P=!(B&h.TOP_LEFT),F=!(B&h.TOP_RIGHT),_=!(B&h.BOTTOM_LEFT),U=!(B&h.BOTTOM_RIGHT),z=0,G=0,H=0;this.fillVertices(z,i,0,f,0,v),this.fillUvsCorner(z,e,A,R,P,M,E,N,T,j,C,k,y),this.fillIndices(H,u,G),z+=8,G+=4,H+=6,this.fillVertices(z,i,f,c,0,v),this.fillUvs(z,e,A,E,N,j,C,E,C),this.fillIndices(H,u,G),z+=8,G+=4,H+=6,this.fillVertices(z,i,l,c,0,v),this.fillUvsCorner(z,e,A,L,F,M,E,N,T,j,C,k,y),this.fillIndices(H,u,G),z+=8,G+=4,H+=6,this.fillVertices(z,i,0,f,v,b),this.fillUvs(z,e,R,M,E,C,k,E,C),this.fillIndices(H,u,G),z+=8,G+=4,H+=6,this.fillVertices(z,i,c,l,v,b),this.fillUvs(z,e,L,N,T,C,k,N,k),this.fillIndices(H,u,G),z+=8,G+=4,H+=6,this.fillVertices(z,i,0,f,g,b),this.fillUvsCorner(z,e,x,R,_,M,E,N,T,j,C,k,y),this.fillIndices(H,u,G),z+=8,G+=4,H+=6,this.fillVertices(z,i,f,c,b,g),this.fillUvs(z,e,x,E,N,k,y,N,k),this.fillIndices(H,u,G),z+=8,G+=4,H+=6,this.fillVertices(z,i,l,c,g,b),this.fillUvsCorner(z,e,x,L,U,T,N,E,M,y,k,C,j),this.fillIndices(H,u,G),this.F.update(),this.U.update(),this.G.update()}}},n}(t.MeshGeometry),D=function(n){function r(i,r,e,u){return n.call(this,new p(i,100,100,r,e,u),new t.MeshMaterial(i))||this}return i(r,n),Object.defineProperty(r.prototype,"texture",{get:function(){return this.shader.texture},set:function(t){this.shader.texture!==t&&(this.shader.texture=t,this.geometry.texture=t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.geometry.width},set:function(t){this.geometry.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.geometry.height},set:function(t){this.geometry.height=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderSize",{get:function(){return this.geometry.borderSize},set:function(t){this.geometry.borderSize=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"borderMask",{get:function(){return this.geometry.borderMask},set:function(t){this.geometry.borderMask=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"cornerMask",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.cornerMask=t},enumerable:!0,configurable:!0}),r.prototype._render=function(t){this.geometry.update(),n.prototype._render.call(this,t)},r.prototype.update=function(){this.geometry.update()},r}(t.Mesh),O=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(D),S=function(){function t(t){var n=t.theme,i=t.corner,r=i.getRadius(),e=r+1,u=i.getMask(),s=this.K=new w(n.getBackgroundTexture(r),e,u);t.appendRenderable(s,!0);var h=t.state,o=t.border,a=o.getWidth(h),f=o.getMask(h),c=this.J=new D(n.getBorderTexture(r,a),e,f,u);t.appendRenderable(c,!1);var l=t.outline,v=l.getWidth(h),b=l.getMask(h),g=this.Z=new O(n.getBorderTexture(r,v),e,b,u);t.appendRenderable(g,!1),this.q=r,this.$=r,this.tt=a,this.nt=r,this.it=v,t.addReflowable(this)}return t.prototype.onReflow=function(t,n,i){var r=t.theme,e=t.state,u=t.corner,s=u.getRadius(),h=s+1,o=u.getMask(),a=t.background,f=this.K,c=a.getColor(e);if(null!=c){var l=a.getAlpha(e);0<l?(this.q!==s&&(this.q=s,f.texture=r.getBackgroundTexture(s),f.borderSize=h),f.tint=c,f.alpha=l,f.width=n,f.height=i,f.cornerMask=o,f.visible=!0):f.visible=!1}else f.visible=!1;var v=t.border,b=this.J,g=v.getColor(e);if(null!=g){var d=v.getAlpha(e);if(0<d){var m=v.getWidth(e);this.$===s&&this.tt===m||(this.$=s,this.tt=m,b.texture=r.getBorderTexture(s,m),b.borderSize=h);var w=v.getAlign(e),p=v.getMask(e);b.tint=g,b.alpha=d;var D=w*m;b.x=-D,b.y=-D,b.width=n+2*D,b.height=i+2*D,b.borderMask=p,b.cornerMask=o,b.visible=!0}else b.visible=!1}else b.visible=!1;var O=t.outline,S=this.Z,M=O.getColor(e);if(null!=M){var E=O.getAlpha(e);if(0<E){var N=O.getWidth(e);this.nt===s&&this.it===N||(this.nt=s,this.it=N,S.texture=r.getBorderTexture(s,N),S.borderSize=h);var T=O.getMask(e),j=O.getOffset(e),C=O.getAlign(e);S.tint=M,S.alpha=E;var k=j+C*N;S.x=-k,S.y=-k,S.width=n+2*k,S.height=i+2*k,S.borderMask=T,S.cornerMask=o,S.visible=!0}else S.visible=!1}else S.visible=!1},t}();!function(t){t[t.NONE=0]="NONE",t[t.HOVERED=1]="HOVERED",t[t.ACTIVE=2]="ACTIVE",t[t.ACTIVE_IN=4]="ACTIVE_IN",t[t.FOCUSED=8]="FOCUSED",t[t.FOCUSED_IN=16]="FOCUSED_IN",t[t.UNFOCUSABLE=32]="UNFOCUSABLE",t[t.FOCUS_ROOT=64]="FOCUS_ROOT",t[t.READ_ONLY=128]="READ_ONLY",t[t.DISABLED=256]="DISABLED",t[t.DRAGGING=512]="DRAGGING",t[t.PRESSED=1024]="PRESSED",t[t.INVALID=2048]="INVALID",t[t.SUCCEEDED=4096]="SUCCEEDED",t[t.FAILED=8192]="FAILED",t[t.CUSTOM=1048576]="CUSTOM"}(v||(v={}));var M,E,N=function(){function t(){}return t.is=function(t,n){return!!(t&n)},t.isHovered=function(t){return!!(t&v.HOVERED)},t.isDragging=function(t){return!!(t&v.DRAGGING)},t.isFocused=function(t){return!!(t&v.FOCUSED)},t.isFocusedIn=function(t){return!!(t&(v.FOCUSED|v.FOCUSED_IN))},t.isActive=function(t){return!!(t&v.ACTIVE)},t.isActiveIn=function(t){return!!(t&(v.ACTIVE|v.ACTIVE_IN))},t.isNotActive=function(t){return!(!(t&v.DISABLED)&&t&v.ACTIVE)},t.isPressed=function(t){return!!(t&v.PRESSED)},t.isDisabled=function(t){return!!(t&v.DISABLED)},t.isReadOnly=function(t){return!!(t&v.READ_ONLY)},t.isActionable=function(t){return!(t&(v.DISABLED|v.READ_ONLY))},t.isInvalid=function(t){return!!(t&v.INVALID)},t.isSucceeded=function(t){return!!(t&v.SUCCEEDED)},t.isFailed=function(t){return!!(t&v.FAILED)},t.bind=function(t,n,i,r){t.setState(n,r(i.state)),i.on("statechange",(function(i){t.setState(n,r(i))}))},t.disable=function(n,i,r){void 0===r&&(r=t.isNotActive),t.bind(n,v.DISABLED,i,r)},t}();!function(t){t[t.NONE=0]="NONE",t[t.BEFORE=1]="BEFORE",t[t.AFTER=2]="AFTER",t[t.BOTH=3]="BOTH"}(M||(M={})),function(t){t[t.OPEN=0]="OPEN",t[t.CLOSE=1]="CLOSE",t[t.PARENSESIS=2]="PARENSESIS",t[t.ADD_OR_PLUS=3]="ADD_OR_PLUS",t[t.SUB_OR_MINUS=4]="SUB_OR_MINUS",t[t.PLUS=5]="PLUS",t[t.MINUS=6]="MINUS",t[t.ADD=7]="ADD",t[t.SUB=8]="SUB",t[t.MUL=9]="MUL",t[t.DIV=10]="DIV",t[t.MIN=11]="MIN",t[t.MAX=12]="MAX",t[t.COMMA=13]="COMMA",t[t.PARENT=14]="PARENT",t[t.SELF=15]="SELF",t[t.PADDING=16]="PADDING",t[t.CURRENT=17]="CURRENT",t[t.NUMBER=18]="NUMBER"}(E||(E={}));var T,j={"+":3,"-":4,"*":9,"/":10,"(":0,")":1,",":13,min:11,max:12},C={"%":14,s:15,p:16,c:17},k=function(){function t(t){var n=this.toToken(t),i=0;do{i=this.toParensesis(n,i)}while(i<n.length);if(this.toUnary(n),this.toArithmetic(n,9,10),this.toArithmetic(n,7,8),1===n.length){var r=n[0];if(!c(r))return void(this.rt=r)}throw new Error("Failed to parse '"+t+"'")}return t.prototype.toParensesis=function(t,n){for(var i=t.length,r=n;r<i;++r)if(0===t[r]){var e=r,u=2;if(0<r){var s=t[r-1];11!==s&&12!==s||(e-=1,u=s)}for(var h=r+1;h<i;++h){var o=t[h];if(1===o)return t[e]=[u,this.toComma(t,r+1,h)],t.splice(e+1,h-e),e+1;0===o&&(h=this.toParensesis(t,h)-1,i=t.length)}throw new Error("Malformed parensesis")}return i},t.prototype.toCommaOf=function(t,n,i){var r=i-n;if(r<=0)return[18,0];if(r<=1)return t[n];for(var e=[],u=n;u<i;++u)e.push(t[u]);return[2,e]},t.prototype.toComma=function(t,n,i){for(var r=null,e=n,u=n;u<i;++u)13===t[u]&&((r=r||[]).push(this.toCommaOf(t,e,u)),e=u+1);if(e<i){if(null==r){var s=[];for(u=e;u<i;++u)s.push(t[u]);return s}r.push(this.toCommaOf(t,e,i))}return r||[]},t.prototype.toUnaryNode=function(t){c(t)||2!==t[0]&&11!==t[0]&&12!==t[0]||this.toUnary(t[1])},t.prototype.toUnary=function(t){for(var n=0,i=t.length;n<i;++n){var r=t[n];if(3===r||4===r)if(n<=0||c(t[n-1])){if(!(n+1<i)||c(t[n+1]))throw new Error("Malformed unary operator");var e=t.splice(n+1,1)[0],u=3===r?5:6;t[n]=[u,e],i=t.length,this.toUnaryNode(e)}else u=3===r?7:8,t[n]=u;else this.toUnaryNode(r),i=t.length}},t.prototype.toArithmeticNode=function(t,n,i){c(t)||(2===t[0]||11===t[0]||12===t[0]?this.toArithmetic(t[1],n,i):5===t[0]||6===t[0]?this.toArithmeticNode(t[1],n,i):7!==t[0]&&8!==t[0]&&9!==t[0]&&10!==t[0]||(this.toArithmeticNode(t[1],n,i),this.toArithmeticNode(t[2],n,i)))},t.prototype.toArithmetic=function(t,n,i){for(var r=0,e=t.length;r<e;++r){var u=t[r];if(u===n||u===i){if(0<r&&r+1<e){var s=t[r-1],h=t[r+1];if(!c(s)&&!c(h)){t.splice(r,2),t[r-1]=[u,s,h],r-=1,e=t.length,this.toArithmeticNode(s,n,i),this.toArithmeticNode(h,n,i);continue}}throw new Error("Malformed operands for the operator "+u)}this.toArithmeticNode(u,n,i),e=t.length}},t.prototype.toToken=function(n){for(var i=[];;){var r=t.TOKEN_REGEX.exec(n);if(null==r)break;var e=r[0],u=j[e];if(null!=u)i.push(u);else{var s=parseFloat(e);if(s!=s)throw new Error("Unexpected token '"+e+"' at "+r.index+" in '"+n+"'");var h=C[e[e.length-1]];null!=h?i.push([h,.01*s]):i.push([18,s])}}return i},t.prototype.evaluate=function(t,n,i,r,e){switch(t[0]){case 2:var u=t[1];return this.evaluate(u[u.length-1],n,i,r,e);case 5:return+this.evaluate(t[1],n,i,r,e);case 6:return-this.evaluate(t[1],n,i,r,e);case 7:return this.evaluate(t[1],n,i,r,e)+this.evaluate(t[2],n,i,r,e);case 8:return this.evaluate(t[1],n,i,r,e)-this.evaluate(t[2],n,i,r,e);case 9:return this.evaluate(t[1],n,i,r,e)*this.evaluate(t[2],n,i,r,e);case 10:return this.evaluate(t[1],n,i,r,e)/this.evaluate(t[2],n,i,r,e);case 11:if(0<t[1].length){for(var s=t[1],h=this.evaluate(s[0],n,i,r,e),o=1,a=s.length;o<a;++o)h=Math.min(h,this.evaluate(s[o],n,i,r,e));return h}return 0;case 12:if(0<t[1].length){for(s=t[1],h=this.evaluate(s[0],n,i,r,e),o=1,a=s.length;o<a;++o)h=Math.max(h,this.evaluate(s[o],n,i,r,e));return h}return 0;case 14:return t[1]*n;case 15:return t[1]*i;case 16:return t[1]*r;case 17:return t[1]*e;case 18:return t[1]}return 0},t.prototype.calculate=function(t,n,i,r){return this.evaluate(this.rt,t,n,i,r)},t.TOKEN_REGEX=/(?:\+|-|\*|\/|\(|\)|min|max|,|(?:\d+(?:\.\d*)?[%psc]?))/g,t}(),y=function(t,n){return.5*(t-n)},I=function(t,n,i){return i},A=function(t){return t},x=function(t,n,i){return t-i},R=function(){function t(){}return t.position=function(t){if(null==t||c(t))return null;if(o(t)){switch(t){case"center":case"CENTER":return y;case"padding":case"PADDING":return I}var n=new k(t);return function(t,i,r,e){return n.calculate(t,i,r,e)}}if(u(t))return t;var i=t;return function(t,n,r,e){return i.calculate(t,n,r,e)}},t.size=function(t){if(null==t||c(t))return null;if(o(t)){switch(t){case"100%":case"maximized":case"MAXIMIZED":return A;case"padding":case"PADDING":return x}var n=new k(t);return function(t,i,r,e){return n.calculate(t,i,r,e)}}if(u(t))return t;var i=t;return function(t,n,r,e){return i.calculate(t,n,r,e)}},t}(),L=function(){function t(){}return t.setDefaultThemeClass=function(t){this.DEFAULT_THEME_CLASS=t},t.getDefaultThemeClass=function(){return this.DEFAULT_THEME_CLASS},t.getInstance=function(){if(null==this.INSTANCE){var t=this.getDefaultThemeClass();if(null==t)throw new Error("No default theme class found");this.INSTANCE=new t}return this.INSTANCE},t.setInstance=function(t){var n=this.INSTANCE;return this.INSTANCE=t,n},t.DEFAULT_THEME_CLASS=null,t.INSTANCE=null,t}(),B=function(){function t(){}return t.isActivateKey=function(t){return"Space"===t.key||"Enter"===t.key||32===t.which||13===t.which},t.isArrowUpKey=function(t){return"ArrowUp"===t.key||38===t.which},t.isArrowDownKey=function(t){return"ArrowDown"===t.key||40===t.which},t.isArrowLeftKey=function(t){return"ArrowLeft"===t.key||37===t.which},t.isArrowRightKey=function(t){return"ArrowRight"===t.key||39===t.which},t.isCancelKey=function(t){return"Esc"===t.key||27===t.which},t.isFocusKey=function(t){return"Tab"===t.key||9===t.which},t.isUndoKey=function(t){return t.ctrlKey&&("z"===t.key||90===t.which)},t.isRedoKey=function(t){return t.ctrlKey&&("y"===t.key||89===t.which)},t.isSaveKey=function(t){return t.ctrlKey&&!t.shiftKey&&("s"===t.key||83===t.which)},t.isSaveAsKey=function(t){return t.ctrlKey&&t.shiftKey&&("S"===t.key||83===t.which)},t.isDeleteKey=function(t){return"Delete"===t.key||46===t.which},t.isSelectAllKey=function(t){return t.ctrlKey&&!t.shiftKey&&("a"===t.key||65===t.which)},t.isOkKey=function(t){return"Enter"===t.key||13===t.which},t.getFocusDirection=function(t){return!0!==t.shiftKey},t.toShortcut=function(t){if(o(t)){var n,i=t,r=i.indexOf("->"),e=void 0;0<=r?(e=i.substring(0,r).trim(),n=i.substring(r+2).trim()):e=i.trim();var u=e.toLowerCase().split("+");return function(t){var n=t.key;if(n.length<=1){t.shift&&(t.key=n.toUpperCase());var i=n.charCodeAt(0);t.which=97<=i&&i<=122?i-32:i}else switch(n){case"Enter":t.which=13;break;case"Space":t.key=" ",t.which=32;break;case"Escape":t.which=27;break;case"F1":t.which=112;break;case"F2":t.which=113;break;case"F3":t.which=114;break;case"F4":t.which=115;break;case"F5":t.which=116;break;case"F6":t.which=117;break;case"F7":t.which=118;break;case"F8":t.which=119;break;case"F9":t.which=120;break;case"F10":t.which=121;break;case"F11":t.which=122;break;case"F12":t.which=123;break;case"CapsLock":t.shift?t.which=20:t.which=240;break;case"ArrowUp":t.which=38;break;case"ArrowDown":t.which=40;break;case"ArrowLeft":t.which=37;break;case"ArrowRight":t.which=39;break;case"Insert":t.which=45;break;case"Delete":t.which=46;break;case"PageUp":t.which=33;break;case"PageDown":t.which=34;break;case"Backspace":t.which=8;break;case";":t.which=187;break;case"Pause":t.which=19;break;case"ScrollLock":t.which=145;break;case"Tab":t.which=9}return t}({alt:0<=u.indexOf("alt"),ctrl:0<=u.indexOf("ctrl"),shift:0<=u.indexOf("shift"),key:u[u.length-1],which:0,event:n})}return t},t.toString=function(t){var n=[];return t.ctrl&&n.push("Ctrl"),t.shift&&n.push("Shift"),t.alt&&n.push("Alt"),n.push(t.key.toUpperCase()),n.join("+")},t.on=function(t,n,i){var r=this.toShortcut(n);document.body.addEventListener("keydown",(function(n){n.altKey!==r.alt||n.ctrlKey!==r.ctrl||n.shiftKey!==r.shift||n.key!==r.key&&n.which!==r.which||(t.isActionable()&&(null!=r.event?t.emit(r.event):null!=i&&i(n)),n.preventDefault())}))},t}(),P=function(){function t(){}return Object.defineProperty(t,"touchable",{get:function(){return"ontouchstart"in document},enumerable:!0,configurable:!0}),Object.defineProperty(t,"tap",{get:function(){return"pointertap"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"down",{get:function(){return"pointerdown"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"enter",{get:function(){return"pointerenter"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"leave",{get:function(){return"pointerleave"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"move",{get:function(){return"pointermove"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"out",{get:function(){return"pointerout"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"over",{get:function(){return"pointerover"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"up",{get:function(){return"pointerup"},enumerable:!0,configurable:!0}),Object.defineProperty(t,"cancel",{get:function(){return"pointercancel"},enumerable:!0,configurable:!0}),t.toGlobal=function(t,n,i){if("touches"in t){var r=t.changedTouches,e=r[r.length-1];null!=e?n.mapPositionToPoint(i,e.clientX,e.clientY):n.mapPositionToPoint(i,0,0)}else n.mapPositionToPoint(i,t.clientX,t.clientY);return i},t.onClick=function(t,n){var i=this;if(this.touchable){var r=!1,u=0,s=0,h=null,o=function(){r=!1,h&&(h.off(a,f),h=null)};t.on("click",(function(t){r&&o(),n(t)}));var a=this.up,f=function(e){r&&(o(),i.contains(t,e.target)&&function(t){var n=t.data.global,r=Math.abs(u-n.x),e=Math.abs(s-n.y),h=i.CLICK_DISTANCE_THRESHOLD;return r<=h&&e<=h}(e)&&n(e))};t.on(this.down,(function(n){if(r){var i=n.data.global;u=i.x,s=i.y}else{r=!0;var o=n.data.global;u=o.x,s=o.y,h&&(h.off(a,f),h=null);var c=e.getLayer(t);c&&(h=c.renderer.plugins.interaction).once(a,f)}}))}else t.on("click",n)},t.onLongClick=function(t,n,i){var r=this;if(this.touchable){var u=!1,s=0,h=0,o=null,a=null,f=function(){null!=o&&(clearTimeout(o),o=null)},c=function(){u=!1,a&&(a.off(v,g),a.off(b,d),a=null),f()},l=function(t){var n=t.data.global,i=Math.abs(s-n.x),e=Math.abs(h-n.y),u=r.CLICK_DISTANCE_THRESHOLD;return i<u&&e<u};t.on("click",(function(t){u&&c(),n(t)}));var v=this.up,b=this.move,g=function(i){u&&(c(),r.contains(t,i.target)&&l(i)&&n(i))},d=function(n){u&&r.contains(t,n.target)&&(l(n)||c())};t.on(this.down,(function(n){if(!u){u=!0;var l=n.data.global;s=l.x,h=l.y,f(),"touches"in n.data.originalEvent&&(o=window.setTimeout((function(){u&&(c(),i(n))}),r.LONG_CLICK_THRESHOLD)),a&&(a.off(v,g),a.off(b,d),a=null);var m=e.getLayer(t);m&&((a=m.renderer.plugins.interaction).once(v,g),a.on(b,d))}}))}else t.on("click",n)},t.onDblClick=function(t,n){var i=this;if(this.touchable){var r=0,e=0,u=0,s=0;t.addEventListener("dblclick",n),t.addEventListener("touchend",(function(t){if(1===r||3===r){var h=t.changedTouches,o=h[h.length-1];if(null!=o){var a=e-o.clientX,f=u-o.clientY;if(Math.abs(a)+Math.abs(f)<i.CLICK_DISTANCE_THRESHOLD)return void(4===(r+=1)?(r=0,t.timeStamp-s<i.DBLCLICK_INTERVAL_THRESHOLD?n(t):(s=t.timeStamp,r=2)):s=t.timeStamp)}}r=0})),t.addEventListener("touchstart",(function(t){if(0===r){if(null!=(n=t.touches.item(t.touches.length-1)))return r=1,e=n.clientX,void(u=n.clientY)}else if(2===r){var n;if(null!=(n=t.touches.item(t.touches.length-1)))return r=3,e=n.clientX,void(u=n.clientY)}r=0}))}else t.addEventListener("dblclick",n)},t.contains=function(t,n){for(var i=n;null!=i&&i!==t;)i=i.parent;return i===t},t.CLICK_DISTANCE_THRESHOLD=10,t.DBLCLICK_INTERVAL_THRESHOLD=333,t.LONG_CLICK_THRESHOLD=750,t}();!function(t){t[t.NONE=0]="NONE",t[t.WIDTH=1]="WIDTH",t[t.HEIGHT=2]="HEIGHT"}(T||(T={}));var F,_,U,z=function(n){function r(t){var i=n.call(this)||this,r=i.transform;i.et=new d(r.position,(function(){i.onPositionChanged()})),i.ut=new d(r.scale,(function(){i.onScaleChanged()})),i.st=new d(r.skew,(function(){i.onSkewChanged()})),i.ht=t;var u=i.ot={};i.at=0,i.B=!0,i.ft=!1,i.ct=!1,i.lt=null,i.vt=t&&t.name||"";var h=i.i=function(t){if(null!=t&&null!=t.theme){var n=t.theme;return o(n)?L.getInstance().get(n):n}return null}(t)||i.getThemeDefault();i.bt=[],i.gt=[],i.wt=[],i.pt=t&&null!=t.clear?o(t.clear)?M[t.clear]:t.clear:h.getClearType(),i.Dt=new g(h,t,(function(){i.layout(),i.toChildrenDirty(),e.update(i)}));var m=function(){i.toDirty(),e.update(i)};i.Ot=new s(h,t,m),i.St=new a(h,t,m),i.Mt=new b(h,t,m),i.Et=new l(h,t,m),i.initReflowable();var w=r.position,p=t&&null!=t.x?t.x:h.getX();c(p)?w.x=p:(w.x=0,u.x=R.position(p));var D=t&&null!=t.y?t.y:h.getY();c(D)?w.y=D:(w.y=0,u.y=R.position(D));var O=t&&null!=t.width?t.width:h.getWidth();c(O)?i.l=O:"auto"===O||"AUTO"===O?(i.l=100,i.toWidthAuto()):(i.l=100,u.width=R.size(O));var S=t&&null!=t.height?t.height:h.getHeight();c(S)?i.I=S:"auto"===S||"AUTO"===S?(i.I=100,i.toHeightAuto()):(i.I=100,u.height=R.size(S)),t&&null!=t.visible&&(i.visible=t.visible),i.Nt=v.NONE,i.Tt=v.NONE;var E=t&&null!=t.interactive?o(t.interactive)?f[t.interactive]:t.interactive:h.getInteractive();if(i.interactive=0!=(E&f.SELF),i.interactiveChildren=0!=(E&f.CHILDREN),t){var N=t.on;if(N)for(var T in N)i.on(T,N[T])}i.jt=t&&null!=t.title?t.title:h.getTitle(),i.Ct=t&&null!=t.weight?t.weight:h.getWeight(),i.kt=function(){e.update(i)};var j=t&&t.shadow||h.getShadow();j&&(i.shadow=j),i.on(P.over,(function(t){i.onOver(t)})),i.on(P.out,(function(t){i.onOut(t)})),i.on(P.down,(function(t){i.onDown(t)})),i.on("added",(function(){i.layout(),(i.isDirty()||i.hasDirty())&&i.toParentHasDirty(),i.ct&&i.toParentChildrenDirty(),i.updateState(),e.update(i)})),i.on("removed",(function(){i.blur(!0),i.updateState(),e.update(i)}));var C=i.yt=function(t){if(null!=t&&(null!=t.shortcuts||null!=t.shortcut)){var n=[];if(null!=t.shortcut&&n.push(B.toShortcut(t.shortcut)),null!=t.shortcuts)for(var i=t.shortcuts,r=0,e=i.length;r<e;++r)B.toShortcut(i[r]);return n}}(t);if(null!=C)for(var k=function(t){i.onShortcut(t)},y=0,I=C.length;y<I;++y)B.on(i,C[y],k);var A=t&&t.cursor;if(null==A&&(A=h.getCursor()),null!=A&&(i.cursor=A),i.init(t),t&&null!=t.state)if(o(t.state))i.setState(v[t.state],!0);else if(c(t.state))i.setState(t.state,!0);else{var x=t.state;for(y=0,I=x.length;y<I;++y)i.setState(v[x[y]],!0)}if(t&&null!=t.parent&&t.parent.addChild(i),t&&null!=t.children){var F=t.children;for(y=0,I=F.length;y<I;++y){var _=F[y];null!=_&&i.addChild(_)}}return i.emit("init",i),i}return i(r,n),r.prototype.prependRenderable=function(t,n){t.parent=this,(n?this.bt:this.gt).unshift(t)},r.prototype.appendRenderable=function(t,n){t.parent=this,(n?this.bt:this.gt).push(t)},r.prototype.removeRenderable=function(t,n){t.parent=null;var i=n?this.bt:this.gt,r=i.indexOf(t);0<=r&&i.splice(r,1)},r.prototype.addReflowable=function(t){this.wt.push(t)},r.prototype.removeReflowable=function(t){var n=this.wt,i=n.indexOf(t);0<=i&&n.splice(i,1)},r.prototype.initReflowable=function(){new S(this)},r.prototype.onChildrenChange=function(){this.toChildrenDirty(),n.prototype.onChildrenChange.call(this)},r.prototype.onShortcut=function(t){},r.prototype.init=function(t){},Object.defineProperty(r.prototype,"weight",{get:function(){return this.Ct},enumerable:!0,configurable:!0}),r.prototype.onPositionChanged=function(){this.moveChildren(),e.update(this),this.emit("move",this)},r.prototype.resize=function(t,n){var i=this.l,r=this.I,e=i!==t,u=r!==n;e&&(this.l=t),u&&(this.I=n);var s,h=e||u;if(h&&this.onResize(t,n,i,r),e&&null!=(s=this.ot).x){var o=this.transform.position,a=this.getParentOfSize();a&&(this.x=s.x(a.width,t,a.padding.getLeft(),o.x))}if(u&&null!=(s=this.ot).y){o=this.transform.position;var f=this.getParentOfSize();f&&(this.y=s.y(f.height,n,f.padding.getTop(),o.y))}return h},r.prototype.getClearType=function(){return this.pt},r.prototype.onResize=function(t,n,i,r){this.toDirty(),this.toChildrenDirty(),this.resizeChildren(),e.update(this),this.emit("resize",t,n,i,r,this)},r.prototype.onScaleChanged=function(){e.update(this),this.emit("scale",this)},r.prototype.onSkewChanged=function(){e.update(this),this.emit("skew",this)},Object.defineProperty(r.prototype,"type",{get:function(){return this.getType()},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"name",{get:function(){return this.vt},set:function(t){this.vt=t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"x",{get:function(){return this.et.x},set:function(t){this.et.x=t},enumerable:!0,configurable:!0}),r.prototype.getX=function(){var t=this.ot;return null!=t.x?t.x:this.x},r.prototype.setX=function(t){if(c(t))this.x=t;else{var n=this.ot,i=R.position(t);n.x!==i&&(n.x=i,this.layout())}},Object.defineProperty(r.prototype,"y",{get:function(){return this.et.y},set:function(t){this.et.y=t},enumerable:!0,configurable:!0}),r.prototype.getY=function(){var t=this.ot;return null!=t.y?t.y:this.y},r.prototype.setY=function(t){if(c(t))this.y=t;else{var n=this.ot,i=R.position(t);n.y!==i&&(n.y=i,this.layout())}},Object.defineProperty(r.prototype,"width",{get:function(){return this.l},set:function(t){var n=this.l;if(n!==t){this.l=t;var i=this.I;this.onResize(t,i,n,i);var r=this.ot;if(null!=r.x){var e=this.transform.position,u=this.getParentOfSize();u&&(this.x=r.x(u.width,t,u.padding.getLeft(),e.x))}}},enumerable:!0,configurable:!0}),r.prototype.toWidthAuto=function(){this.at|=1},r.prototype.isWidthAuto=function(){return 0!=(1&this.at)},r.prototype.getWidth=function(){var t=this.ot;return this.isWidthAuto()?"auto":null!=t.width?t.width:this.width},r.prototype.setWidth=function(t){if(c(t))this.width=t;else if("auto"===t||"AUTO"===t)this.isWidthAuto()||(this.toWidthAuto(),this.toChildrenDirty(),e.update(this));else{var n=this.ot,i=R.size(t);n.width!==i&&(n.width=i,this.layout())}},Object.defineProperty(r.prototype,"height",{get:function(){return this.I},set:function(t){var n=this.I;if(n!==t){this.I=t;var i=this.l;this.onResize(i,t,i,n);var r=this.ot;if(null!=r.y){var e=this.transform.position,u=this.getParentOfSize();u&&(this.y=r.y(u.height,t,u.padding.getTop(),e.y))}}},enumerable:!0,configurable:!0}),r.prototype.toHeightAuto=function(){this.at|=2},r.prototype.isHeightAuto=function(){return 0!=(2&this.at)},r.prototype.getHeight=function(){var t=this.ot;return this.isHeightAuto()?"auto":null!=t.height?t.height:this.height},r.prototype.setHeight=function(t){if(c(t))this.height=t;else if("auto"===t||"AUTO"===t)this.isHeightAuto()||(this.toHeightAuto(),this.toChildrenDirty(),e.update(this));else{var n=this.ot,i=R.size(t);n.height!==i&&(n.height=i,this.layout())}},Object.defineProperty(r.prototype,"position",{get:function(){return this.et},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale",{get:function(){return this.ut},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"skew",{get:function(){return this.st},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"padding",{get:function(){return this.Dt},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"corner",{get:function(){return this.Et},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"background",{get:function(){return this.Ot},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"border",{get:function(){return this.St},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"outline",{get:function(){return this.Mt},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"unsafe",{get:function(){return this.transform},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"title",{get:function(){return this.jt},set:function(t){this.jt!==t&&(this.jt=t,this.isHovered()&&this.applyTitle())},enumerable:!0,configurable:!0}),r.prototype.applyTitle=function(){var t=e.getLayer(this);t&&(t.view.title=this.jt)},r.prototype.show=function(){return this.visible||(this.visible=!0,this.toParentChildrenDirty(),e.update(this)),this},r.prototype.isShown=function(){return this.visible},r.prototype.hide=function(){return this.visible&&(this.visible=!1,this.toParentChildrenDirty(),e.update(this)),this},r.prototype.isHidden=function(){return!this.visible},r.prototype.toDirty=function(){return!this.B&&(this.B=!0,this.toParentHasDirty(),!0)},r.prototype.toHasDirty=function(){return!this.ft&&(this.ft=!0,this.toParentHasDirty(),!0)},r.prototype.toParentHasDirty=function(){var t=this.parent;t instanceof r&&t.toHasDirty()},r.prototype.toChildrenDirty=function(){return!this.ct&&(this.ct=!0,this.onChildrenDirty(),this.toParentChildrenDirty(),!0)},r.prototype.toParentChildrenDirty=function(){var t=this.parent;t instanceof r&&t.toChildrenDirty()},r.prototype.isChildrenDirty=function(){return this.ct},r.prototype.onChildrenDirty=function(){},r.prototype.isDirty=function(){return this.B},r.prototype.hasDirty=function(){return this.ft},r.prototype.setHovered=function(t){return this.setState(v.HOVERED,t)},r.prototype.setActive=function(t){return this.setState(v.ACTIVE,t)},r.prototype.setPressed=function(t){return this.setState(v.PRESSED,t)},r.prototype.setReadOnly=function(t){return this.setState(v.READ_ONLY,t)},r.prototype.setDisabled=function(t){return this.setState(v.DISABLED,t)},r.prototype.setDragging=function(t){return this.setState(v.DRAGGING,t)},r.prototype.setInvalid=function(t){return this.setState(v.INVALID,t)},r.prototype.setSucceeded=function(t){return this.setState(v.SUCCEEDED,t)},r.prototype.setFailed=function(t){return this.setState(v.FAILED,t)},r.prototype.setFocused=function(t){if(this.isFocused()!==t){var n=e.getLayer(this);n&&n.getFocusController().setFocused(this,t,!1)}return this},r.prototype.focus=function(){return this.setFocused(!0)},r.prototype.blur=function(t){if(t){var n=e.getLayer(this);if(n){var i=n.getFocusController().getFocused();if(i instanceof r)for(var u=i;u;){if(u===this){i.setFocused(!1);break}u=u.parent}}}else this.setFocused(!1);return this},r.prototype.isHovered=function(){return this.hasState(v.HOVERED)},r.prototype.isActive=function(){return this.hasState(v.ACTIVE)},r.prototype.isActiveIn=function(){return this.hasState(v.ACTIVE|v.ACTIVE_IN)},r.prototype.isPressed=function(){return this.hasState(v.PRESSED)},r.prototype.isReadOnly=function(){return this.hasState(v.READ_ONLY)},r.prototype.isDisabled=function(){return this.hasState(v.DISABLED)},r.prototype.isActionable=function(){return!this.hasState(v.DISABLED|v.READ_ONLY)},r.prototype.isDragging=function(){return this.hasState(v.DRAGGING)},r.prototype.isFocused=function(){return this.hasState(v.FOCUSED)},r.prototype.isFocusedIn=function(){return this.hasState(v.FOCUSED|v.FOCUSED_IN)},r.prototype.isUnfocusable=function(){return this.hasState(v.UNFOCUSABLE)},r.prototype.isInvalid=function(){return this.hasState(v.INVALID)},r.prototype.isSucceeded=function(){return this.hasState(v.SUCCEEDED)},r.prototype.isFailed=function(){return this.hasState(v.FAILED)},r.prototype.setState=function(t,n){var i=this.Tt,r=n?i|t:i&~t;return i!==r&&(this.Tt=r,this.updateState()),this},r.prototype.setStates=function(t,n){var i=this.Tt,r=(i|t)&~n;return i!==r&&(this.Tt=r,this.updateState()),this},r.prototype.updateState=function(){var t=this.parent,n=this.Tt,i=t instanceof r?this.mergeState(n,t.state):n,e=this.Nt;e!==i&&(this.Nt=i,this.onStateChange(i,e))},r.prototype.mergeState=function(t,n){return t|n&v.DISABLED|(n&(v.FOCUSED|v.FOCUSED_IN)?v.FOCUSED_IN:v.NONE)|(n&(v.ACTIVE|v.ACTIVE_IN)?v.ACTIVE_IN:v.NONE)},r.prototype.onStateChange=function(t,n){this.toDirty(),e.update(this),this.emit("statechange",t,n,this);for(var i=this.children,u=0,s=i.length;u<s;++u){var h=i[u];h instanceof r&&h.onParentStateChange(t,n)}N.isFocused(t)?N.isFocused(n)||this.onFocused():N.isFocused(n)&&this.onBlured()},r.prototype.onChildFocused=function(t){var n=this.parent;n instanceof r&&n.onChildFocused(t)},r.prototype.onFocused=function(){var t=this.parent;t instanceof r&&t.onChildFocused(this)},r.prototype.onBlured=function(){},r.prototype.onParentStateChange=function(t,n){var i=this.mergeState(this.Tt,t),r=this.Nt;r!==i&&(this.Nt=i,this.onStateChange(i,r))},Object.defineProperty(r.prototype,"state",{get:function(){return this.Nt},enumerable:!0,configurable:!0}),r.prototype.getState=function(){return this.Nt},r.prototype.hasState=function(t){return!!(this.Nt&t)},Object.defineProperty(r.prototype,"theme",{get:function(){return this.i},set:function(t){this.i!==t&&(this.i=t,this.Dt.setTheme(t),this.Ot.setTheme(t),this.St.setTheme(t),this.Mt.setTheme(t),this.Et.setTheme(t),this.toDirty(),e.update(this))},enumerable:!0,configurable:!0}),r.prototype.refit=function(){if(this.ct){this.ct=!1;for(var t=this.children,n=0,i=t.length;n<i;++n){var e=t[n];e instanceof r&&e.refit()}this.onRefit()}},r.prototype.onRefit=function(){var t=this.isWidthAuto(),n=this.isHeightAuto();if(t&&n){for(var i=0,r=0,e=0,u=(h=this.children).length;e<u;++e)(o=h[e]).visible&&(this.hasRefitableWidth(o)&&(i=Math.max(i,o.x+o.width)),this.hasRefitableHeight(o)&&(r=Math.max(r,o.y+o.height)));var s=this.padding;this.resize(i+s.getRight(),r+s.getBottom())}else if(t){for(i=0,e=0,u=(h=this.children).length;e<u;++e)(o=h[e]).visible&&this.hasRefitableWidth(o)&&(i=Math.max(i,o.x+o.width));s=this.padding,this.width=i+s.getRight()}else if(n){var h;for(r=0,e=0,u=(h=this.children).length;e<u;++e){var o;(o=h[e]).visible&&this.hasRefitableHeight(o)&&(r=Math.max(r,o.y+o.height))}s=this.padding,this.height=r+s.getBottom()}},r.prototype.isRefitable=function(t){return t instanceof r},r.prototype.hasRefitableHeight=function(t){return this.isRefitable(t)&&!(t instanceof r&&u(t.getHeight()))},r.prototype.hasRefitableWidth=function(t){return this.isRefitable(t)&&!(t instanceof r&&u(t.getWidth()))},r.prototype.reflow=function(){if(this.B&&(this.onReflow(),this.B=!1),this.ft){for(var t=this.children,n=0,i=t.length;n<i;++n){var e=t[n];e instanceof r&&e.reflow()}this.ft=!1}},r.prototype.onReflow=function(){for(var t=this.l,n=this.I,i=this.wt,r=0,e=i.length;r<e;++r)i[r].onReflow(this,t,n)},Object.defineProperty(r.prototype,"shadow",{get:function(){return this.lt},set:function(t){var n=this.lt;n!==t&&(null!=n&&(n.off("update",this.kt),this.removeReflowable(n),this.removeRenderable(n,!0)),this.lt=t,null!=t&&(t.on("update",this.kt),this.addReflowable(t),this.prependRenderable(t,!0)),e.update(this))},enumerable:!0,configurable:!0}),r.prototype.layout=function(){var t=this.getParentOfSize();t&&this.onParentResize(t.width,t.height,t.padding)},r.prototype.getParentOfSize=function(){var t=this.parent;return t instanceof r?t:e.getLayer(this)},r.prototype.onParentResize=function(t,n,i){var r=this.ot,e=this.transform.position,u=e.x,s=e.y,h=this.l,o=this.I,a=i.getLeft()+i.getRight(),f=i.getTop()+i.getBottom(),c=null!=r.width?r.width(t,h,a,h):h,l=null!=r.height?r.height(n,o,f,o):o;this.resize(c,l);var v=null!=r.x?r.x(t,this.l,i.getLeft(),u):u,b=null!=r.y?r.y(n,this.I,i.getTop(),s):s;this.position.set(v,b)},r.prototype.resizeChildren=function(){for(var t=this.l,n=this.I,i=this.Dt,e=this.children,u=0,s=e.length;u<s;++u){var h=e[u];h instanceof r&&h.onParentResize(t,n,i)}},r.prototype.onParentMove=function(t,n){},r.prototype.moveChildren=function(){for(var t=this.x,n=this.y,i=this.children,e=0,u=i.length;e<u;++e){var s=i[e];s instanceof r&&s.onParentMove(t,n)}},r.prototype.onWheel=function(t,n,i){return this.emit("wheel",t,n,i,this),!1},r.prototype.onKeyDown=function(t){return this.emit("keydown",t,this),!1},r.prototype.onKeyUp=function(t){return this.emit("keyup",t,this),!1},r.prototype.onDown=function(t){var n=t.target;if(n===this)this.onDownThis(t);else if(!(n instanceof r)){for(var i=n.parent;null!=i&&!(i instanceof r);)i=i.parent;i===this&&this.onDownThis(t)}},r.prototype.onDownThis=function(t){var n=e.getLayer(this);if(n){var i=n.getFocusController();i.setFocused(i.findFocusableParent(this),!0,!0)}},r.prototype.onOver=function(t){this.setHovered(!0),t.target===this&&this.applyTitle()},r.prototype.onOut=function(t){this.setHovered(!1)},r.prototype.onDblClick=function(t,n){return this.emit("dblclick",t,n,this),!1},r.prototype.render=function(t){this.visible&&0<this.worldAlpha&&this.renderable&&(this.renderBefore(t),n.prototype.render.call(this,t),this.renderAfter(t))},r.prototype.renderBefore=function(t){for(var n=this.bt,i=0,r=n.length;i<r;++i){var e=n[i];e.updateTransform(),e.render(t)}},r.prototype.renderAfter=function(t){for(var n=this.gt,i=0,r=n.length;i<r;++i){var e=n[i];e.updateTransform(),e.render(t)}},r.prototype.getThemeDefault=function(){return L.getInstance().get(this.getType())},r.prototype.getType=function(){return"DBase"},r.prototype._calculateBounds=function(){var t=this.transform.worldTransform,i=this._bounds,e=r.WORK_CONTAINS_POINT;e.set(0,0),t.apply(e,e),i.addPoint(e),e.set(this.l,this.I),t.apply(e,e),i.addPoint(e),n.prototype._calculateBounds.call(this)},r.prototype.containsPoint=function(t){return this.containsGlobalPoint(t)||this.containsLocalPoint(this.worldTransform.applyInverse(t,r.WORK_CONTAINS_POINT))},r.prototype.containsGlobalPoint=function(t){return!1},r.prototype.containsLocalPoint=function(t){return 0<=t.x&&t.x<=this.l&&0<=t.y&&t.y<=this.I},r.prototype.getClippingRect=function(t,n){n.x=0,n.y=0,n.width=this.l,n.height=this.I},r.prototype.destroy=function(){var t=this.ot;t.x=null,t.y=null,t.width=null,t.height=null;var i=this.lt;i&&(this.lt=null,i.destroy());for(var r=this.children,e=r.length-1;0<=e;--e)r[e].destroy();r.length=0,n.prototype.destroy.call(this)},r.WORK_CONTAINS_POINT=new t.Point,r}(t.Container),G=function(){function t(t,n,i){this.x=t,this.y=n,this.character=i}return t.prototype.set=function(t,n,i){this.x=t,this.y=n,this.character=i},t}(),H=function(){function t(){this.count=0,this.width=0,this.height=0,this.characters=[],this.clipped=!1,this.x=0,this.y=0}return t.prototype.start=function(){this.count=0,this.width=0,this.height=0,this.clipped=!1,this.x=0,this.y=0},t.prototype.push=function(t){var n=this.x;this.x+=t.advance;var i=this.y,r=this.count,e=this.characters;r<e.length?e[r].set(n,i,t):e.push(new G(n,i,t)),this.count+=1},t.prototype.newLine=function(t){this.width=Math.max(this.width,this.x),this.x=0,this.y+=t},t.prototype.pop=function(){if(0<this.x){var t=this.count,n=this.characters;if(0<t){var i=n[t-1];return this.x-=i.character.advance,this.count-=1,!0}}return!1},t.prototype.end=function(t){this.newLine(t),this.height=this.y},t}(),V=function(){function t(){this.It="",this.et=0}return Object.defineProperty(t.prototype,"position",{get:function(){return this.et},set:function(t){this.et=t},enumerable:!0,configurable:!0}),t.prototype.init=function(t){this.It=t,this.et=0},t.prototype.hasNext=function(){return this.et<this.It.length},t.prototype.findNextBreak=function(t,n){for(var i=t.length,r=n;r<i;++r){var e=t.charCodeAt(r);if(!this.isLowSurrogate(e)&&!this.isVariationSelector(e))return r}return i},t.prototype.isHighSurrogate=function(t){return 55296<=t&&t<=56319},t.prototype.isLowSurrogate=function(t){return 56320<=t&&t<=57343},t.prototype.isVariationSelector=function(t){return 65024<=t&&t<=65039},t.prototype.next=function(){var t=this.It,n=this.et,i=this.findNextBreak(t,n+1),r=t.substring(n,i);return this.et=i,r},t.prototype.advance=function(t){var n=this.It,i=this.et,r=this.findNextBreak(n,i+1);return n.substring(i,r)!==t&&(this.et=r,!0)},t.from=function(n){null==t.At&&(t.At=new t);var i=t.At;return i.init(n),i},t.At=null,t}(),W=function(){function t(){}return t.measure=function(n,i,r){var e=t.RESULT=t.RESULT||new H;if(e.start(),null!=i){for(var u=V.from(n),s=i.font.height;u.hasNext();){var h=u.next();if("\n"===h)e.newLine(s);else{var o=i.get(h);if(null!=o){var a=e.x;if(null!=r&&r<a+o.advance){e.clipped=!0;var f=i.get("...");for(null!=f&&(r<a+f.advance?e.pop()&&e.push(f):e.push(f));u.hasNext();)if("\n"===u.next()){e.newLine(s);break}}else e.push(o)}}}e.end(s)}return e},t.RESULT=null,t}(),Y=function(t){function n(){var n=t.call(this,new Float32Array(64),new Float32Array(64),new Uint16Array(48))||this;return n.width=0,n.height=0,n.clipped=!1,n}return i(n,t),n.prototype.update=function(t,n,i){var r=this.getBuffer("aVertexPosition"),e=this.getBuffer("aTextureCoord"),u=this.getIndex(),s=W.measure(t,n,i),h=Math.ceil(s.count/8)<<3,o=h<<3;r.data.length<o&&(r.data=new Float32Array(o),e.data=new Float32Array(o));var a=6*h;u.data.length<a&&(u.data=new Uint16Array(a));var f=r.data,c=e.data,l=u.data;if(null!=n){for(var v=s.count,b=s.characters,g=0;g<v;++g){var d=b[g];this.writeCharacter(f,c,l,g,d.x,d.y,d.character,n.width,n.height)}g=v;for(var m=f.length>>3;g<m;++g)this.writeCharacterEmpty(f,c,l,g);this.width=s.width,this.height=s.height,this.clipped=s.clipped}else{for(g=0,m=f.length>>3;g<m;++g)this.writeCharacterEmpty(f,c,l,g);this.width=0,this.height=0,this.clipped=!1}r.update(),e.update(),u.update()},n.prototype.writeCharacter=function(t,n,i,r,e,u,s,h,o){var a=s.x-s.origin.x,f=r<<3;t[f+0]=e+a,t[f+1]=u+0,t[f+2]=e+a+s.width,t[f+3]=u+0,t[f+4]=e+a+s.width,t[f+5]=u+0+s.height,t[f+6]=e+a,t[f+7]=u+0+s.height;var c=s.x/h,l=s.y/o,v=(s.x+s.width)/h,b=(s.y+s.height)/o;n[f+0]=c,n[f+1]=l,n[f+2]=v,n[f+3]=l,n[f+4]=v,n[f+5]=b,n[f+6]=c,n[f+7]=b;var g=6*r,d=r<<2;i[g+0]=d+0,i[g+1]=d+1,i[g+2]=d+3,i[g+3]=d+1,i[g+4]=d+2,i[g+5]=d+3},n.prototype.writeCharacterEmpty=function(t,n,i,r){var e=r<<3;t[e+0]=0,t[e+1]=0,t[e+2]=0,t[e+3]=0,t[e+4]=0,t[e+5]=0,t[e+6]=0,t[e+7]=0,n[e+0]=0,n[e+1]=0,n[e+2]=0,n[e+3]=0,n[e+4]=0,n[e+5]=0,n[e+6]=0,n[e+7]=0;var u=6*r,s=r<<2;i[u+0]=s+0,i[u+1]=s+1,i[u+2]=s+3,i[u+3]=s+1,i[u+4]=s+2,i[u+5]=s+3},n}(t.MeshGeometry),X=function(){function t(n,i){this.xt=0,this.Rt=-1;var r=t.FONT=t.FONT||L.getInstance().get("DBase");this.v=n&&n.align||"left",this.Lt=n&&n.fontFamily||r.getFontFamilly(),this.Bt=n&&n.fontSize||r.getFontSize(),this.Pt=n&&n.fontStyle||"normal",this.Ft=n&&n.fontVariant||"normal",this._t=n&&n.fontWeight||"normal",this.Ut=-1,this.zt="",this.Gt="",this.Ht=n&&n.fill||r.getColor(0),this.Vt=0,this.Wt=!n||null==n.clipping||n.clipping,this.Yt=i}return Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"idApproved",{get:function(){return this.Rt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontId",{get:function(){return this.update(),this.zt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontIdApproved",{get:function(){return this.Gt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this.Ht},set:function(t){this.Ht!==t&&(this.Ht=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.onChange=function(){this.xt+=1,this.Yt()},Object.defineProperty(t.prototype,"fillApproved",{get:function(){return this.Vt},enumerable:!0,configurable:!0}),t.prototype.approve=function(){this.update(),this.Rt=this.xt,this.Gt=this.zt,this.Vt=this.Ht},Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this.Lt},set:function(t){this.Lt!==t&&(this.Lt=t,this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this.Bt},set:function(t){this.Bt!==t&&(this.Bt=t,this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this.Pt},set:function(t){this.Pt!==t&&(this.Pt=t,this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this.Ft},set:function(t){this.Ft!==t&&(this.Ft=t,this.onChange())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._t},set:function(t){this._t!==t&&(this._t=t,this.onChange())},enumerable:!0,configurable:!0}),t.prototype.update=function(){this.Ut!==this.xt&&(this.Ut=this.xt,this.zt=this.newFontId())},t.prototype.newFontId=function(){return this.Pt+" "+this.Ft+" "+this._t+" "+this.Bt+"px "+this.Lt},Object.defineProperty(t.prototype,"clipping",{get:function(){return this.Wt},set:function(t){this.Wt!==t&&(this.Wt=t,this.onChange())},enumerable:!0,configurable:!0}),t.FONT=null,t}(),K=function(n){function r(i,r){var e=n.call(this,new Y,new t.MeshMaterial(t.Texture.EMPTY))||this;return e.Xt=new X(r,(function(){e.B=!0,e.Kt=!0,e.Jt=null,e.Zt()})),e.qt=i,e.Qt="",e.B=!0,e.Kt=!0,e.Jt=null,e.$t=0,e.l=0,e.I=0,e.tn=0,e.Zt(),e}return i(r,n),r.prototype.Zt=function(){var t=e.getLayer(this);if(t){var n=this.Xt;if(this.B){this.B=!1;var i=this.qt,r=this.Qt;this.Qt=i;var u=n.fontId,s=n.fontIdApproved,h=n.fontSize,o=n.fill,a=n.fillApproved;n.approve();var f=t.getDynamicFontAtlases();i===r&&u===s&&o===a||(f.add(u,h,o,i),f.remove(s,a,r))}}},Object.defineProperty(r.prototype,"text",{get:function(){return this.qt},set:function(t){this.qt!==t&&(this.qt=t,this.B=!0,this.Kt=!0,this.Zt())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"width",{get:function(){return this.update(),Math.abs(this.scale.x)*this.geometry.width},set:function(t){this.update();var n=this.geometry.width;if(1e-4<n){var i=t/n;this.scale.x=0<=this.scale.x?+i:-i}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.update(),Math.abs(this.scale.y)*this.geometry.height},set:function(t){this.update();var n=this.geometry.height;if(1e-4<n){var i=t/n;this.scale.y=0<=this.scale.y?+i:-i}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"clipped",{get:function(){return this.geometry.clipped},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"style",{get:function(){return this.Xt},enumerable:!0,configurable:!0}),r.prototype.update=function(){this.Zt();var t=this.Jt;if(null==t){var n=e.getLayer(this);if(n){var i=this.Xt;null!=(t=n.getDynamicFontAtlases().get(i.fontId,i.fill))&&(this.$t=t.getRevisionUpdate(),this.Jt=t,this.texture=t.texture,this.Kt=!0)}}else{var r=t.getRevisionUpdate();r!==this.$t&&(this.$t=r,this.Kt=!0)}var u=this.nn,s=this.getClippingWidth();u!==s&&(this.nn=s,this.Kt=!0),this.Kt&&(this.Kt=!1,this.geometry.update(this.qt,t,s))},r.prototype.getClippingWidth=function(){if(this.Xt.clipping){var t=this.parent;if(t instanceof z)return t.width-t.padding.getLeft()-t.padding.getRight()-this.tn}},r.prototype.setClippingWidthDelta=function(t){this.tn=t},r.prototype._calculateBounds=function(){this.update(),n.prototype._calculateBounds.call(this)},r.prototype._render=function(t){this.update(),n.prototype._render.call(this,t)},r}(t.Mesh);!function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT"}(F||(F={})),function(t){t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM"}(_||(_={})),function(t){t[t.TEXT=0]="TEXT",t[t.PADDING=1]="PADDING",t[t.BORDER=2]="BORDER"}(U||(U={}));var J,Z=function(t){function n(n){var i=t.call(this)||this;return i.parent=n,i}return i(n,t),n.prototype.render=function(n){this.updateTransform(),t.prototype.render.call(this,n)},n.prototype.onReflow=function(t,n,i){this.clear(),this.beginFill(16777215,1),this.drawRect(0,0,n,i),this.endFill()},n}(t.Graphics),q=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(t){n.prototype.init.call(this,t),this.qt=null;var i=this.theme;this.in=function(t,n){return n&&n.text&&void 0!==n.text.value?n.text.value:t.newTextValue()}(i,t),this.rn=this.computeTextValue(),this.en=t&&t.text&&t.text.color,this.un=t&&t.text&&t.text.alpha,this.sn=function(t,n,i){if(n&&n.text&&null!=n.text.style){var r=n.text.style;return{fill:null!=r.fill?r.fill:t.getColor(i),fontSize:null!=r.fontSize?r.fontSize:t.getFontSize(),fontFamily:null!=r.fontFamily?r.fontFamily:t.getFontFamilly(),fontWeight:null!=r.fontWeight?r.fontWeight:t.getFontWeight(),fontStyle:null!=r.fontStyle?r.fontStyle:t.getFontStyle(),fontVariant:null!=r.fontVariant?r.fontVariant:t.getFontVariant(),clipping:null!=r.clipping?r.clipping:t.getTextStyleClipping()}}return{fill:t.getColor(i),fontSize:t.getFontSize(),fontFamily:t.getFontFamilly(),fontWeight:t.getFontWeight(),fontStyle:t.getFontStyle(),fontVariant:t.getFontVariant(),clipping:t.getTextStyleClipping()}}(i,t,this.state),this.hn=function(t,n){if(n&&n.text&&n.text.align){var i=n.text.align;return{vertical:null!=i.vertical?o(i.vertical)?_[i.vertical]:i.vertical:t.getTextAlignVertical(),horizontal:null!=i.horizontal?o(i.horizontal)?F[i.horizontal]:i.horizontal:t.getTextAlignHorizontal()}}return{vertical:t.getTextAlignVertical(),horizontal:t.getTextAlignHorizontal()}}(i,t),this.an=function(t,n){return n&&n.text&&n.text.formatter?n.text.formatter:t.getTextFormatter()}(i,t),this.fn=function(t,n){return n&&n.text&&null!=n.text.dynamic?n.text.dynamic:t.isTextDynamic()}(i,t),this.cn=function(t,n){return n&&null!=n.mask?n.mask:t.isOverflowMaskEnabled()}(i,t),this.ln=null,this.onTextChange(),this.createOrUpdateText()},Object.defineProperty(r.prototype,"text",{get:function(){return this.in},set:function(t){this.in!==t&&(this.in=t,this.updateTextValue())},enumerable:!0,configurable:!0}),r.prototype.onTextChange=function(){},r.prototype.computeTextValue=function(){var t=this.in;if(void 0!==t){if(!u(t))return t;var n=t(this.state);if(void 0!==n)return n}return this.theme.getTextValue(this.state)},r.prototype.createOrUpdateText=function(){var t=this.an(this.rn,this);if(null==this.qt){if(0<t.length){var n=this.createText(t);this.qt=n,this.addChild(n),this.updateTextPosition(n),this.cn&&(n.mask=this.getOrCreateOverflowMask()),this.toDirty(),e.update(this)}}else this.qt.text=t,this.toDirty(),e.update(this)},r.prototype.createText=function(n){return this.fn?new K(n,this.sn):new t.Text(n,this.sn)},r.prototype.getOrCreateOverflowMask=function(){return null==this.ln&&(this.ln=new Z(this),this.addReflowable(this.ln),this.toDirty()),this.ln},r.prototype.updateTextPosition=function(t){var n=this.hn,i=this.Dt;switch(n.horizontal){case F.LEFT:t.x=this.toRounded(i.getLeft());break;case F.CENTER:t.x=this.toRounded(.5*(this.width-t.width));break;case F.RIGHT:t.x=this.toRounded(this.width-t.width-i.getRight())}switch(n.vertical){case _.TOP:t.y=this.toRounded(i.getTop());break;case _.MIDDLE:t.y=this.toRounded(.5*(this.height-t.height));break;case _.BOTTOM:t.y=this.toRounded(this.height-t.height-i.getBottom())}},r.prototype.toRounded=function(t){return Math.round(t)},r.prototype.getTextColor=function(t,n){var i=this.en;if(void 0!==i){if(!u(i))return i;var r=i(n);if(void 0!==r)return r}return t.getColor(n)},r.prototype.getTextAlpha=function(t,n){var i=this.un;if(void 0!==i){if(!u(i))return i;var r=i(n);if(void 0!==r)return r}return t.getAlpha(n)},r.prototype.updateTextColor=function(t){var n=this.theme,i=this.state;t.style.fill=this.getTextColor(n,i),t.alpha=this.getTextAlpha(n,i)},r.prototype.updateTextValue=function(){var t=this.computeTextValue();this.rn!==t&&(this.rn=t,this.onTextChange(),this.createOrUpdateText())},r.prototype.updateText=function(){var t=this.qt;null!=t&&(this.updateTextValue(),this.updateTextPosition(t),this.updateTextColor(t))},r.prototype.onReflow=function(){n.prototype.onReflow.call(this),this.updateText()},r.prototype.isRefitable=function(t){return n.prototype.isRefitable.call(this,t)||null!=t&&t===this.qt},r.prototype.applyTitle=function(){var t=this.qt;if(this.jt.length<=0&&t&&"clipped"in t&&t.clipped){var i=e.getLayer(this);i&&(i.view.title=t.text)}else n.prototype.applyTitle.call(this)},r.prototype.getType=function(){return"DTextBase"},r.prototype.destroy=function(){var t=this.qt;null!=t&&(this.qt=null,t.destroy());var i=this.ln;null!=i&&(this.ln=null,i.destroy()),n.prototype.destroy.call(this)},r}(z),Q=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(i){var r=this;n.prototype.init.call(this,i),this.vn=null;var e=this.theme;this.bn=function(t,n){if(null!=n&&null!=n.image&&null!=n.image.align){var i=n.image.align;return{with:null!=i.with?o(i.with)?U[i.with]:i.with:t.getImageAlignWith(),vertical:null!=i.vertical?o(i.vertical)?_[i.vertical]:i.vertical:t.getImageAlignVertical(),horizontal:null!=i.horizontal?o(i.horizontal)?F[i.horizontal]:i.horizontal:t.getImageAlignHorizontal()}}return{with:t.getImageAlignWith(),vertical:t.getImageAlignVertical(),horizontal:t.getImageAlignHorizontal()}}(e,i),this.gn=function(t,n){if(null!=n&&null!=n.image&&null!=n.image.margin){var i=n.image.margin;return{vertical:null!=i.vertical?i.vertical:t.getImageMarginVertial(),horizontal:null!=i.horizontal?i.horizontal:t.getImageMarginHorizontal()}}return{vertical:t.getImageMarginVertial(),horizontal:t.getImageMarginHorizontal()}}(e,i),this.dn=function(t,n){if(null!=n&&null!=n.image&&null!=n.image.tint)return n.image.tint}(0,i),this.mn=new t.Rectangle,this.wn=new t.Point,this.pn=i&&i.image&&i.image.source,this.Dn=null,this.On=function(){r.onImageChange()}},Object.defineProperty(r.prototype,"image",{get:function(){return this.pn},set:function(t){this.pn!==t&&(this.pn=t,this.toDirty(),e.update(this))},enumerable:!0,configurable:!0}),r.prototype.computeImageSource=function(){var t=this.pn;if(void 0!==t){if(!u(t))return t;var n=t(this.state);if(void 0!==n)return n}return this.theme.getImageSource(this.state)},r.prototype.onImageChange=function(){this.toDirty(),e.update(this)},r.prototype.onStateChange=function(t,i){n.prototype.onStateChange.call(this,t,i);var r=this.vn;null!=r&&this.updateImageTint(r)},r.prototype.getImageRect=function(t){t.updateTransform();var n=t.getLocalBounds(this.mn),i=this.wn;i.set(n.left,n.top),t.localTransform.apply(i,i);var r=i.x,e=i.y;i.set(n.right,n.top),t.localTransform.apply(i,i);var u=i.x,s=i.y;i.set(n.right,n.bottom),t.localTransform.apply(i,i);var h=i.x,o=i.y;i.set(n.left,n.bottom),t.localTransform.apply(i,i);var a=i.x,f=i.y;return n.x=Math.min(r,u,h,a),n.y=Math.min(e,s,o,f),n.width=Math.max(r,u,h,a)-n.x,n.height=Math.max(e,s,o,f)-n.y,n},r.prototype.updateTextAndImagePosition=function(t,n){var i=this.getImageRect(n),r=i.width,e=i.height,u=this.hn,s=this.bn,h=this.gn,o=this.Dt,a=h.horizontal,f=r+a;switch(s.horizontal){case F.LEFT:switch(u.horizontal){case F.LEFT:t instanceof K&&t.setClippingWidthDelta(f),n.x=this.toRounded(o.getLeft());break;case F.CENTER:t instanceof K&&t.setClippingWidthDelta(f),n.x=this.toRounded(.5*(this.width-t.width-f));break;case F.RIGHT:t instanceof K&&t.setClippingWidthDelta(0),n.x=this.toRounded(this.width-t.width-o.getRight()-f)}t.x=this.toRounded(n.x+f);break;case F.CENTER:switch(t instanceof K&&t.setClippingWidthDelta(0),u.horizontal){case F.LEFT:t.x=this.toRounded(o.getLeft());break;case F.CENTER:t.x=this.toRounded(.5*(this.width-t.width));break;case F.RIGHT:t.x=this.toRounded(this.width-t.width-o.getRight())}n.x=this.toRounded(t.x+.5*(t.width-r));break;case F.RIGHT:switch(u.horizontal){case F.LEFT:t instanceof K&&t.setClippingWidthDelta(0),t.x=this.toRounded(o.getLeft());break;case F.CENTER:t instanceof K&&t.setClippingWidthDelta(f),t.x=this.toRounded(.5*(this.width-t.width-f));break;case F.RIGHT:t instanceof K&&t.setClippingWidthDelta(f),t.x=this.toRounded(this.width-t.width-o.getRight()-f)}n.x=this.toRounded(t.x+t.width+a)}var c=h.vertical,l=r+a;switch(s.vertical){case _.TOP:switch(u.vertical){case _.TOP:n.y=this.toRounded(o.getTop());break;case _.MIDDLE:n.y=this.toRounded(.5*(this.height-t.height-l));break;case _.BOTTOM:n.y=this.toRounded(this.height-t.height-o.getBottom()-l)}t.y=this.toRounded(n.y+l);break;case _.MIDDLE:switch(u.vertical){case _.TOP:t.y=this.toRounded(o.getTop());break;case _.MIDDLE:t.y=this.toRounded(.5*(this.height-t.height));break;case _.BOTTOM:t.y=this.toRounded(this.height-t.height-o.getBottom())}n.y=this.toRounded(t.y+.5*(t.height-e));break;case _.BOTTOM:switch(u.vertical){case _.TOP:t.y=this.toRounded(o.getTop());break;case _.MIDDLE:t.y=this.toRounded(.5*(this.height-t.height-l));break;case _.BOTTOM:t.y=this.toRounded(this.height-t.height-o.getBottom()-l)}n.y=this.toRounded(t.y+t.height+c)}},r.prototype.updateImagePositionText=function(t){var n=this.getImageRect(t);t.x=this.toRounded(.5*(this.width-n.width)),t.y=this.toRounded(.5*(this.height-n.height))},r.prototype.updateImagePositionPadding=function(t){var n=this.gn,i=this.bn,r=this.Dt,e=this.getImageRect(t),u=e.width,s=e.height,h=n.horizontal;switch(i.horizontal){case F.LEFT:t.x=this.toRounded(r.getLeft()+h);break;case F.CENTER:t.x=this.toRounded(.5*(this.width-u));break;case F.RIGHT:t.x=this.toRounded(this.width-r.getRight()-h-u)}var o=n.vertical;switch(i.vertical){case _.TOP:t.y=this.toRounded(r.getTop()+o);break;case _.MIDDLE:t.y=this.toRounded(.5*(this.height-s));break;case _.BOTTOM:t.y=this.toRounded(this.height-r.getBottom()-o)}},r.prototype.updateImagePositionBorder=function(t){var n=this.gn,i=this.bn,r=this.getImageRect(t),e=r.width,u=r.height,s=n.horizontal;switch(i.horizontal){case F.LEFT:t.x=this.toRounded(s);break;case F.CENTER:t.x=this.toRounded(.5*(this.width-e));break;case F.RIGHT:t.x=this.toRounded(this.width-s-e)}var h=n.vertical;switch(i.vertical){case _.TOP:t.y=this.toRounded(h);break;case _.MIDDLE:t.y=this.toRounded(.5*(this.height-u));break;case _.BOTTOM:t.y=this.toRounded(this.height-h)}},r.prototype.getImageTintColor=function(t,n){var i=this.dn;if(null!=i){var r=i.color;if(void 0!==r){if(!u(r))return r;var e=r(n);if(void 0!==e)return e}}return t.getImageTintColor(n)},r.prototype.getImageTintAlpha=function(t,n){var i=this.dn;if(null!=i){var r=i.alpha;if(void 0!==r){if(!u(r))return r;var e=r(n);if(void 0!==e)return e}}return t.getImageTintAlpha(n)},r.prototype.updateImageTint=function(t){if(this.isTintAware(t)){var n=this.theme,i=this.state,r=this.getImageTintColor(n,i);if(null!=r){t.tint!==r&&(t.tint=r);var e=this.getImageTintAlpha(n,i);t.alpha!==e&&(t.alpha=e)}}},r.prototype.isTintAware=function(t){return null!=t&&"tint"in t},r.prototype.updateImageSource=function(){var n=this.computeImageSource(),i=this.Dn;if(n!==i){this.Dn=n;var r=this.vn;if(n instanceof t.Texture)if(i instanceof t.Texture)i.off("update",this.On),r instanceof t.Sprite&&(r.texture=n,n.on("update",this.On));else{null!=r&&this.removeChild(r);var e=new t.Sprite(n);this.cn&&(e.mask=this.getOrCreateOverflowMask()),n.on("update",this.On),this.addChild(e),this.vn=e}else i instanceof t.Texture?(i.off("update",this.On),null!=r&&(this.removeChild(r),r.destroy())):null!=r&&this.removeChild(r),null!=n&&(this.cn&&(n.mask=this.getOrCreateOverflowMask()),this.addChild(n)),this.vn=n}},r.prototype.updateText=function(){this.updateTextValue(),this.updateImageSource();var t=this.qt,n=this.vn;if(null!=t)if(null!=n){switch(this.bn.with){case U.TEXT:this.updateTextAndImagePosition(t,n);break;case U.PADDING:t instanceof K&&t.setClippingWidthDelta(0),this.updateTextPosition(t),this.updateImagePositionPadding(n);break;case U.BORDER:t instanceof K&&t.setClippingWidthDelta(0),this.updateTextPosition(t),this.updateImagePositionBorder(n)}this.updateTextColor(t),this.updateImageTint(n)}else t instanceof K&&t.setClippingWidthDelta(0),this.updateTextPosition(t),this.updateTextColor(t);else if(null!=n){switch(this.bn.with){case U.TEXT:this.updateImagePositionText(n);break;case U.PADDING:this.updateImagePositionPadding(n);break;case U.BORDER:this.updateImagePositionBorder(n)}this.updateImageTint(n)}},r.prototype.isRefitable=function(t){return n.prototype.isRefitable.call(this,t)||null!=t&&t===this.vn},r.prototype.getType=function(){return"DImageBase"},r.prototype.destroy=function(){var i=this.vn;if(null!=i){this.vn=null;var r=this.Dn;r instanceof t.Texture&&(r.off("update",this.On,this),i.destroy())}n.prototype.destroy.call(this)},r}(q),$=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DImage"},n}(Q),tt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.buttonMode=!0,this.Sn=function(t){return null!=t&&null!=t.value?t.value:null}(n)},Object.defineProperty(n.prototype,"value",{get:function(){return this.Sn},set:function(t){this.Sn=t},enumerable:!0,configurable:!0}),n.prototype.hasSelection=function(t){return t&&t.selection&&t.selection.add},n.prototype.getSelection=function(){for(var t=this.parent;t;){if(this.hasSelection(t))return t.selection;t=t.parent}return null},n.prototype.onSelect=function(t){var n=this.getSelection();n&&n.add(this)},n.prototype.onKeyDown=function(n){return this.isActionable()&&this.isFocused()&&B.isActivateKey(n)&&this.onSelect(n),t.prototype.onKeyDown.call(this,n)},n.prototype.onStateChange=function(n,i){t.prototype.onStateChange.call(this,n,i),this.buttonMode=N.isActionable(n)},n.prototype.getType=function(){return"DListItem"},n}($),nt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getContext=function(){for(var t=this.parent;t;){if(t.getContext)return t.getContext();t=t.parent}return null},n.prototype.getCloseable=function(){for(var t=this.parent;t;){if(t.getCloseable)return t.getCloseable();t=t.parent}return null},n.prototype.getType=function(){return"DMenuItem"},n}(tt),it=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(t){n.prototype.init.call(this,t),this.initOnClick(t),this.initOnOver(t),this.initShortcuts(t)},r.prototype.initOnClick=function(t){var n=this;P.onClick(this,(function(t){n.isActionable()&&n.onSelect(t)}))},r.prototype.initOnOver=function(t){var n=this;this.on(P.over,(function(){var t=n.getContext();null!=t&&n.parent instanceof z&&t.trim(n.getCloseable())}))},r.prototype.initShortcuts=function(n){var i=this.yt;if(this.Mn=this.theme.getShortcutTextMargin(),null!=i&&0<i.length){var r=i[0],e=B.toString(r);this.En=this.fn?new K(e,this.sn):new t.Text(e,this.sn),this.appendRenderable(this.En,!0)}else this.En=null},r.prototype.updateShortcutText=function(){var t=this.En;null!=t&&t.position.set(this.toRounded(this.width-this.Mn-t.width),this.toRounded(.5*(this.height-t.height)))},r.prototype.updateTextColor=function(t){n.prototype.updateTextColor.call(this,t);var i=this.En;if(null!=i){var r=this.theme,e=this.state;i.style.fill=r.getColor(e),i.alpha=r.getAlpha(e)}},r.prototype.updateText=function(){n.prototype.updateText.call(this),this.updateShortcutText()},r.prototype.getType=function(){return"DMenuItemText"},r.prototype.onSelect=function(t){var i=this.getCloseable();null!=i&&i.emit("select",this.value,this,i),n.prototype.onSelect.call(this,t)},r.prototype.onShortcut=function(t){n.prototype.onShortcut.call(this,t),this.onSelect(t)},r}(nt),rt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),n&&n.check&&this.setActive(!0)},n.prototype.getType=function(){return"DMenuItemCheck"},n.prototype.onSelect=function(n){this.setActive(!this.isActive()),t.prototype.onSelect.call(this,n)},n.isCompatible=function(t){return"check"in t},n}(it);!function(t){t[t.OPEN_LINK_IN_NEW_WINDOW=0]="OPEN_LINK_IN_NEW_WINDOW",t[t.COPY_LINK_ADDRESS=1]="COPY_LINK_ADDRESS"}(J||(J={}));var et,ut={NEW_WINDOW:v.CUSTOM};!function(t){t[t.AUTO=0]="AUTO",t[t.THIS_WINDOW=1]="THIS_WINDOW",t[t.NEW_WINDOW=2]="NEW_WINDOW"}(et||(et={}));var st,ht=function(){function n(){}return n.addItemCreator=function(t){this.CREATORS.push(t)},n.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},n.setMenuCreator=function(t){this.MENU_CREATOR=t},n.newItemOf=function(t,n,i,r){for(var e=0,u=t.length;e<u;++e){var s=t[e](i,r);if(null!=s)return s}return n?n(i,r):null},n.newItem=function(t,n){return this.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)},n.newItemsOf=function(n,i,r,e){for(var u=0,s=r.length;u<s;++u){var h=r[u];if(h instanceof t.DisplayObject)i.addChild(h);else{var o=n.newItem(h,e);if(null==o)throw new Error("No matching menu item creator found: "+JSON.stringify(h));i.addChild(o)}}},n.newItems=function(t,n,i){this.newItemsOf(this,t,n,i)},n.newMenu=function(t){if(null!=this.MENU_CREATOR)return this.MENU_CREATOR(t);throw new Error("Missing DMenu creator.")},n.CREATORS=[],n.CREATOR_DEFAULT=null,n}(),ot=function(t){var n=document.getSelection();if(n){var i=document.createRange();i.selectNodeContents(t),n.removeAllRanges(),n.addRange(i)}return n},at=function(t){return t.clipboardData||window.clipboardData},ft=function(t){function n(){var n=t.call(this)||this,i=document.body;return i.addEventListener("copy",(function(t){t.target===i&&(t.preventDefault(),t.stopPropagation(),n.emit("copy",at(t)))})),i.addEventListener("cut",(function(t){t.target===i&&(t.preventDefault(),t.stopPropagation(),n.emit("cut",at(t)))})),i.addEventListener("paste",(function(t){t.target===i&&(t.preventDefault(),t.stopPropagation(),n.emit("paste",at(t)))})),n}return i(n,t),n.copy=function(t){var n=navigator.clipboard;n&&n.writeText?n.writeText(t):function(t,n){if("undefined"==typeof ClipboardEvent){var i=t.clipboardData;if(void 0!==i&&void 0!==i.setData)return i.setData("Text",n),!0}return!1}(window,t)||function(t){var n=document.createElement("div");n.setAttribute("style","-webkit-user-select: text !important"),n.textContent="Dummy",document.body.appendChild(n);var i=ot(n),r=!1;if(i){var e=function(i){if(i.target===n){var e=at(i);e.setData("text/plain",t),r=e.getData("text/plain")===t,i.preventDefault()}};document.addEventListener("copy",e);try{document.execCommand("copy")}finally{document.removeEventListener("copy",e)}i.removeAllRanges()}return document.body.removeChild(n),r}(t)||navigator.userAgent.indexOf("Edge")<0&&function(t){var n=document.createElement("div");n.setAttribute("style","-webkit-user-select: text !important");var i=document.createElement("span");i.innerText=t,(n.attachShadow?n.attachShadow({mode:"open"}):n).appendChild(i),document.body.appendChild(n);var r=ot(n);r&&(document.execCommand("copy"),r.removeAllRanges()),document.body.removeChild(n)}(t)},n}(t.utils.EventEmitter),ct=function(n){function r(t){var i=n.call(this,t)||this;return i.Nn=t.link,i.It=t.target,i.Tn=t.checker,i.jn=t.menu,i}return i(r,n),r.prototype.init=function(t){t.target===et.NEW_WINDOW&&(t.state=t.state||v.NONE||ut.NEW_WINDOW),n.prototype.init.call(this,t)},Object.defineProperty(r.prototype,"link",{get:function(){var t=this.Nn;return o(t)||null==t?t:t(this)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"menu",{get:function(){var t=this,n=this.Cn;if(null==n){var i=this.theme,r=this.jn||i.getMenuOptions();n=this.toMenu(r),this.Cn=n,n.on("select",(function(n,i,r){t.onMenuSelect(n,i,r)}))}return n},enumerable:!0,configurable:!0}),r.prototype.toMenu=function(n){return n instanceof t.DisplayObject?n:this.newMenu(n)},r.prototype.newMenu=function(t){return ht.newMenu(t)},r.prototype.onMenuSelect=function(t,n,i){var r=this;switch(t){case J.OPEN_LINK_IN_NEW_WINDOW:this.open(!0);break;case J.COPY_LINK_ADDRESS:var e=this.link;null!=e&&(o(e)?this.copy(e):e.then((function(t){null!=t&&r.copy(t)})))}},r.prototype.copy=function(t){var n=document.createElement("a");n.href=t,ft.copy(n.href)},r.prototype.initOnClick=function(t){var n=this,i=function(t){n.isActionable()&&n.onSelect(t)};(t&&t.target)===et.NEW_WINDOW?P.onClick(this,i):P.onLongClick(this,i,(function(t){if(n.isActionable()){var i=n.menu;i.isHidden()&&i.open(n)}}))},r.prototype.getType=function(){return"DMenuItemLink"},r.prototype.onSelect=function(t){n.prototype.onSelect.call(this,t),this.open(this.inNewWindow(t))},r.prototype.open=function(t){var n=this,i=this.link;null!=i&&(o(i)?this.check(i,t):i.then((function(i){i&&n.check(i,t)})))},r.prototype.check=function(t,n){var i=this,r=this.Tn;if(r){var e=r(this);!0===e?this.exec(t,n):!1===e||e.then((function(r){r&&i.exec(t,n)}))}else this.exec(t,n)},r.prototype.exec=function(t,n){if(n){var i=document.createElement("a");i.href=t,i.target="_blank",i.style.display="none",i.rel="noopener noreferrer",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i)}),100)}else window.location.href=t},r.prototype.inNewWindow=function(n){if(this.It===et.NEW_WINDOW)return!0;var i=n instanceof t.interaction.InteractionEvent?n.data.originalEvent:n;return i.ctrlKey||i.shiftKey||i.altKey||i.metaKey||"button"in i&&0!==i.button},r.prototype.onShortcut=function(t){n.prototype.onShortcut.call(this,t),this.onSelect(t)},r.isCompatible=function(t){return"link"in t},r}(it);!function(t){t[t.TOP=0]="TOP",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=3]="BOTTOM"}(st||(st={}));var lt,vt=function(){function t(){}return t.attach=function(t,n,i,r,e,u,s){var h=t.width,o=t.height,a=0,f=0;switch(s){case st.LEFT:(a=n.left-h-i)<0&&e<(a=n.right+i)+h&&(a=0),f=this.adjust(n.top,o,u);break;case st.TOP:a=this.adjust(n.left,h,e),(f=n.top-o-r)<0&&u<(f=n.bottom+r)+o&&(f=0);break;case st.RIGHT:e<(a=n.right+i)+h&&(a=n.left-h-i)<0&&(a=e-h),f=this.adjust(n.top,o,u);break;case st.BOTTOM:a=this.adjust(n.left,h,e),u<(f=n.bottom+r)+o&&(f=n.top-o-r)<0&&(f=u-o)}t.position.set(a,f)},t.adjust=function(t,n,i){return t<0?i<t+n?.5*(i-n):0:i<t+n?i<n?.5*(i-n):i-n:t},t}(),bt=st,gt=function(n){function r(t){return n.call(this,t)||this}return i(r,n),r.prototype.init=function(t){var i=this;n.prototype.init.call(this,t),P.onClick(this,(function(){i.isActionable()&&i.toggle()})),this.initHover(t);var r=this.toMenu(t);this.Cn=r,r.on("select",(function(t,n,r){i.onMenuSelect(t,n,r)}))},r.prototype.initHover=function(t){var n=this;this.on(P.over,(function(){n.isActionable()&&n.open()}))},r.prototype.toMenu=function(n){var i=n.menu;return i instanceof t.DisplayObject?i:this.newMenu(i)},r.prototype.newMenu=function(t){return ht.newMenu(t)},Object.defineProperty(r.prototype,"menu",{get:function(){return this.Cn},enumerable:!0,configurable:!0}),r.prototype.getType=function(){return"DMenuItemMenu"},r.prototype.open=function(){var t=this.Cn;t.isHidden()&&this.onOpen(t)},r.prototype.onOpen=function(t){var n=this.getContext();null!=n&&t.open(this,this.getCloseable(),n)},r.prototype.close=function(){this.Cn.close()},r.prototype.toggle=function(){var t=this.Cn;t.isHidden()?this.onOpen(t):t.close()},r.prototype.onSelect=function(t){this.open(),n.prototype.onSelect.call(this,t)},r.prototype.onMenuSelect=function(t,n,i){var r=this.getCloseable();null!=r&&r.emit("select",t,n,i)},r.isCompatible=function(t){return"menu"in t},r.toSubMenuOptions=function(n,i){var r=n.menu;return r instanceof t.DisplayObject||(null==r.sticky&&(r.sticky=i),null==r.align&&(r.align=bt.RIGHT)),n},r}(nt),dt=function(t){function n(n){var i=t.call(this)||this;return n.appendRenderable(i,!0),n.addReflowable(i),i}return i(n,t),n.prototype.onReflow=function(t,n,i){var r=t.state,e=t.border,u=e.getWidth(r),s=e.getColor(r);if(null!=s){var h=e.getAlpha(r),o=e.getAlign(r),a=t.padding,f=.5*i;this.clear(),this.lineStyle(u,s,h,o),this.moveTo(a.getLeft(),f),this.lineTo(n-a.getRight(),f),this.visible=!0}else this.clear(),this.visible=!1},n}(t.Graphics),mt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.interactive=!1,this.buttonMode=!1,this.setState(v.UNFOCUSABLE,!0)},n.prototype.initReflowable=function(){new dt(this)},n.prototype.getType=function(){return"DListItemSeparator"},n}(tt),wt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemSeparator"},n.isCompatible=function(t){return"separator"in t},n}(mt),pt=function(t){function n(n){var i=t.call(this,n)||this;return i.visible=!1,i.setState(v.UNFOCUSABLE,!0),i}return i(n,t),n.prototype.getType=function(){return"DLayoutSpace"},n}(z),Dt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemSpace"},n.isCompatible=function(t){return"space"in t},n}(pt),Ot=function(){ht.addItemCreator((function(t){return rt.isCompatible(t)?new rt(t):null})),ht.addItemCreator((function(t){return ct.isCompatible(t)?new ct(t):null})),ht.addItemCreator((function(t,n){return gt.isCompatible(t)?new gt(gt.toSubMenuOptions(t,n)):null})),ht.addItemCreator((function(t){return wt.isCompatible(t)?new wt(t):null})),ht.addItemCreator((function(t){return Dt.isCompatible(t)?new Dt(t):null})),ht.setItemCreatorDefault((function(t){return new it(t)}))};!function(t){t[t.VERTICAL=0]="VERTICAL",t[t.HORIZONTAL=1]="HORIZONTAL"}(lt||(lt={}));var St,Mt=function(t){return t instanceof z&&(t.visible||t instanceof pt)},Et=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.setState(v.UNFOCUSABLE,!0);var i=this.theme;this.kn=function(t,n){if(n&&null!=n.margin){var i=n.margin;if(c(i))return{horizontal:i,vertical:i};var r=t.getMargin();return{horizontal:null!=i.horizontal?i.horizontal:r,vertical:null!=i.vertical?i.vertical:r}}return{horizontal:r=t.getMargin(),vertical:r}}(i,n),this.yn=function(t,n){if(n&&null!=n.direction){var i=n.direction;return o(i)?lt[i]:i}return t.getDirection()}(i,n),this.In=function(t,n){return n&&null!=n.corner&&!c(n.corner)&&null!=n.corner.adjust?n.corner.adjust:t.getCornerAdjust()}(i,n),this.An=function(t,n){if(n){if(null!=n.row)return n.row;if(null!=n.column)return n.column}return t.getMultiplicity()}(i,n),this.xn=function(t,n){return n&&null!=n.reverse?n.reverse:t.getReverse()}(i,n)},n.prototype.getWeightTotal=function(){for(var t=this.children,n=0,i=this.An,r=this.xn,e=0,u=t.length;e<u;){for(var s=-1,h=0;h<i&&e+h<u;++h){var o=t[r?u-1-(e+h):e+h];if(Mt(o)){var a=o.getClearType();if(0!==h&&a&M.BEFORE)break;if(s=Math.max(s,o.weight),a&&M.AFTER){h+=1;break}}else e+=1,h-=1}e+=h,0<=s&&(n+=s)}return n},n.prototype.getSpaceLeft=function(t,n){var i=this.children,r=this.An,e=this.xn;if(this.yn===lt.VERTICAL){for(var u=t,s=0,h=0,o=i.length;h<o;){for(var a=0,f=-1,c=0;c<r&&h+c<o;++c){var l=i[e?o-1-(h+c):h+c];if(Mt(l)){var v=l.getClearType();if(0!==c&&v&M.BEFORE)break;if(a=(f=Math.max(f,l.weight))<0?Math.max(a,l.height+s):s,v&M.AFTER){c+=1;break}}else h+=1,c-=1}h+=c,u-=a,s=n}return Math.max(0,u)}for(u=t,s=0,h=0,o=i.length;h<o;){var b=0;for(f=-1,c=0;c<r&&h+c<o;++c)if(l=i[e?o-1-(h+c):h+c],Mt(l)){if(v=l.getClearType(),0!==c&&v&M.BEFORE)break;if(b=(f=Math.max(f,l.weight))<0?Math.max(b,l.width+s):s,v&M.AFTER){c+=1;break}}else h+=1,c-=1;h+=c,u-=b,s=n}return Math.max(0,u)},n.prototype.onRefit=function(){var i=this.children,r=this.Dt,e=r.getTop(),u=r.getBottom(),s=r.getLeft(),h=r.getRight(),o=this.kn,a=o.vertical,f=o.horizontal,c=this.getWeightTotal(),l=this.An,v=this.xn,b=null;if(this.In){var g=4+(i.length<<1);(null==n.CORNER_ADJUST_WORK||n.CORNER_ADJUST_WORK.length<g)&&(n.CORNER_ADJUST_WORK=new Float32Array(g)),(b=n.CORNER_ADJUST_WORK)[0]=-2,b[1]=-2,b[g-2]=-3,b[g-1]=-3}if(this.yn===lt.VERTICAL){var d=0,m=e-a;if(0<c){for(var w=1/c,p=this.height-e-u,D=this.getSpaceLeft(p,a),O=0,S=i.length;O<S;){for(var E=s-f,N=0,T=0;T<l&&O+T<S;++T){var j=i[v?S-1-(O+T):O+T];if(Mt(j)){var C=j.getClearType();if(0!==T&&C&M.BEFORE)break;if(j.position.set(f+E,a+m),0<=(z=j.weight)&&(j.height=D*(z*w)),E+=f+j.width,N=Math.max(N,j.height),C&M.AFTER){null!=b&&(b[0+(G=O+T+1<<1)]=T,b[G+1]=d),T+=1;break}null!=b&&(b[0+(G=O+T+1<<1)]=T,b[G+1]=d)}else null!=b&&(b[0+(G=O+T+1<<1)]=T-1,b[G+1]=d),O+=1,T-=1}m+=a+N,O+=T,d+=1}if(null!=b)for(O=0,S=i.length;O<S;++O)if(j=i[v?S-1-O:O],Mt(j)){var k=b[0+(H=2+(O<<1))],y=b[H+1],I=-2;if(!((C=j.getClearType())&M.BEFORE)){var A=this.findRowIndexPrevious(H,y,b);this.hasClearTypeAfter(i,A)||(I=b[A])}var x=-2;if(!(C&M.AFTER)){var R=this.findRowIndexNext(H,y,b);this.hasClearTypeBefore(i,R)||(x=b[R])}var L=this.countColumn(H,y,b);j.corner.mask=this.toCornerMaskColumn(I,k,x,L)}}else{for(O=0,S=i.length;O<S;){for(E=s-f,N=0,T=0;T<l&&O+T<S;++T)if(j=i[v?S-1-(O+T):O+T],Mt(j)){if(C=j.getClearType(),0!==T&&C&M.BEFORE)break;if(j.position.set(f+E,a+m),0<=(z=j.weight)&&(j.height=0),E+=f+j.width,N=Math.max(N,j.height),C&M.AFTER){null!=b&&(b[0+(G=O+T+1<<1)]=T,b[G+1]=d),T+=1;break}null!=b&&(b[0+(G=O+T+1<<1)]=T,b[G+1]=d)}else null!=b&&(b[0+(G=O+T+1<<1)]=T-1,b[G+1]=d),O+=1,T-=1;m+=a+N,O+=T,d+=1}if(null!=b)for(O=0,S=i.length;O<S;++O)j=i[v?S-1-O:O],Mt(j)&&(k=b[0+(H=2+(O<<1))],y=b[H+1],I=-2,(C=j.getClearType())&M.BEFORE||(A=this.findRowIndexPrevious(H,y,b),this.hasClearTypeAfter(i,A)||(I=b[A])),x=-2,C&M.AFTER||(R=this.findRowIndexNext(H,y,b),this.hasClearTypeBefore(i,R)||(x=b[R])),L=this.countColumn(H,y,b),j.corner.mask=this.toCornerMaskColumn(I,k,x,L))}}else{var B=0;if(E=s-f,0<c){for(w=1/c,p=this.width-s-h,D=this.getSpaceLeft(p,f),O=0,S=i.length;O<S;){m=e-a;var P=0;for(T=0;T<l&&O+T<S;++T)if(j=i[v?S-1-(O+T):O+T],Mt(j)){if(C=j.getClearType(),0!==T&&C&M.BEFORE)break;if(j.position.set(f+E,a+m),0<=(z=j.weight)&&(j.width=D*(z*w)),P=Math.max(P,j.width),m+=a+j.height,C&M.AFTER){null!=b&&(b[0+(G=O+T+1<<1)]=B,b[G+1]=T),T+=1;break}null!=b&&(b[0+(G=O+T+1<<1)]=B,b[G+1]=T)}else null!=b&&(b[0+(G=O+T+1<<1)]=B,b[G+1]=T-1),O+=1,T-=1;E+=f+P,O+=T,B+=1}if(null!=b)for(O=0,S=i.length;O<S;++O)if(j=i[v?S-1-O:O],Mt(j)){k=b[0+(H=2+(O<<1))],y=b[H+1];var F=-2;(C=j.getClearType())&M.BEFORE||(A=this.findColumnIndexPrevious(H,k,b),this.hasClearTypeAfter(i,A)||(F=b[A+1]));var _=-2;C&M.AFTER||(R=this.findColumnIndexNext(H,k,b),this.hasClearTypeBefore(i,R)||(_=b[R+1]));var U=this.countRow(H,k,b);j.corner.mask=this.toCornerMaskRow(F,y,_,U)}}else{for(O=0,S=i.length;O<S;){for(m=e-a,P=0,T=0;T<l&&O+T<S;++T)if(j=i[v?S-1-(O+T):O+T],Mt(j)){var z;if(C=j.getClearType(),0!==T&&C&M.BEFORE)break;if(j.position.set(f+E,a+m),0<=(z=j.weight)&&(j.width=0),P=Math.max(P,j.width),m+=a+j.height,C&M.AFTER){null!=b&&(b[0+(G=O+T+1<<1)]=B,b[G+1]=T),T+=1;break}null!=b&&(b[0+(G=O+T+1<<1)]=B,b[G+1]=T)}else{var G;null!=b&&(b[0+(G=O+T+1<<1)]=B,b[G+1]=T-1),O+=1,T-=1}E+=f+P,O+=T,B+=1}if(null!=b)for(O=0,S=i.length;O<S;++O){var H;j=i[v?S-1-O:O],Mt(j)&&(k=b[0+(H=2+(O<<1))],y=b[H+1],F=-2,(C=j.getClearType())&M.BEFORE||(A=this.findColumnIndexPrevious(H,k,b),this.hasClearTypeAfter(i,A)||(F=b[A+1])),_=-2,C&M.AFTER||(R=this.findColumnIndexNext(H,k,b),this.hasClearTypeBefore(i,R)||(_=b[R+1])),U=this.countRow(H,k,b),j.corner.mask=this.toCornerMaskRow(F,y,_,U))}}}t.prototype.onRefit.call(this)},n.prototype.hasClearTypeBefore=function(t,n){return this.hasClearType(t,n,M.BEFORE)},n.prototype.hasClearTypeAfter=function(t,n){return this.hasClearType(t,n,M.AFTER)},n.prototype.hasClearType=function(t,n,i){if(2<=n){var r=n-2>>1;if(0<=r&&r<t.length){var e=t[r];if(e instanceof z)return!!(e.getClearType()&i)}}return!1},n.prototype.findColumnIndexPrevious=function(t,n,i){for(var r=t-2;0<=r;r-=2)if(i[r]!==n)return r;return 0},n.prototype.findColumnIndexNext=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2){var u=i[r];if(u!==n){for(var s=r+2;s<e;s+=2)if(i[s]!==u)return s-2;return r}}return i.length-2},n.prototype.countRow=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2)if(i[r]!==n)return i[r-2+1]+1;return 0},n.prototype.findRowIndexPrevious=function(t,n,i){for(var r=t-2;0<=r;r-=2)if(i[r+1]!==n)return r;return 0},n.prototype.findRowIndexNext=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2){var u=i[r+1];if(u!==n){for(var s=r+2;s<e;s+=2)if(i[s+1]!==u)return s-2;return r}}return i.length-2},n.prototype.countColumn=function(t,n,i){for(var r=t+2,e=i.length;r<e;r+=2)if(i[r+1]!==n)return i[r-2+0]+1;return 0},n.prototype.toCornerMaskColumn=function(t,n,i,r){var e=h.NONE;return t+1<n&&0===n&&(e|=h.TOP_LEFT),i+1<n&&0===n&&(e|=h.BOTTOM_LEFT),t<n&&n+1===r&&(e|=h.TOP_RIGHT),i<n&&n+1===r&&(e|=h.BOTTOM_RIGHT),h.ALL&~e},n.prototype.toCornerMaskRow=function(t,n,i,r){var e=h.NONE;return t+1<n&&0===n&&(e|=h.TOP_LEFT),i+1<n&&0===n&&(e|=h.TOP_RIGHT),t<n&&n+1===r&&(e|=h.BOTTOM_LEFT),i<n&&n+1===r&&(e|=h.BOTTOM_RIGHT),h.ALL&~e},n.prototype.addSpace=function(t){return this.addChild(new pt(t))},n.prototype.getType=function(){return"DLayout"},n.CORNER_ADJUST_WORK=null,n}(z),Nt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DLayoutVertical"},n}(Et),Tt=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemExpandableBody"},n}(Nt),jt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on(P.down,(function(t){i.isActionable()&&i.onSelect(t)}))},n.prototype.getSelection=function(){return null},n.prototype.getType=function(){return"DMenuItemExpandableHeader"},n.prototype.onSelect=function(n){this.emit("select",this),t.prototype.onSelect.call(this,n)},n}(tt),Ct=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,n){return ht.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)||ht.newItem(t,n)},t.newItems=function(t,n,i){ht.newItemsOf(this,t,n,i)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),kt=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(t){var i=this;n.prototype.init.call(this,t);var r=this.theme,e=this.toHeader(r,t);this.Rn=e,e.on("select",(function(){i.toggle()})),this.addChild(e);var u=this.toBody(r,t);this.Ln=u;var s=!(!t||null==t.sticky)&&t.sticky;this.newItems(u,s,r,t),this.addChild(u),this.isActive()?this.onActivated():this.onDeactivated()},r.prototype.newItems=function(t,n,i,r){null!=r&&null!=r.items&&Ct.newItems(t,r.items,n)},r.prototype.toHeader=function(n,i){return i?i.header instanceof t.DisplayObject?i.header:this.newHeader(n,i.header):this.newHeader(n)},r.prototype.newHeader=function(t,n){return new jt(n)},r.prototype.toBody=function(n,i){return i&&i.body?i.body instanceof t.DisplayObject?i.body:this.newBody(n,i.body):this.newBody(n)},r.prototype.newBody=function(t,n){return new Tt(n)},r.prototype.open=function(){this.setActive(!0)},r.prototype.close=function(){this.setActive(!1)},r.prototype.toggle=function(){this.setActive(!this.isActive())},r.prototype.onActivated=function(){var t=this.Ln;t instanceof z?t.show():t.visible=!0},r.prototype.onDeactivated=function(){var t=this.Ln;t instanceof z?t.hide():t.visible=!1},r.prototype.onStateChange=function(t,i){n.prototype.onStateChange.call(this,t,i),N.isActive(t)?N.isActive(i)||this.onActivated():N.isActive(i)&&this.onDeactivated()},r.prototype.getType=function(){return"DMenuItemExpandable"},r.isCompatible=function(t){return"header"in t},r}(Nt),yt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemCheck"},n}(rt),It=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemLink"},n}(ct),At=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemSeparator"},n}(wt),xt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemSpace"},n}(Dt),Rt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemText"},n}(it),Lt=function(){ht.addItemCreator((function(t){return kt.isCompatible(t)?new kt(t):null})),Ct.addItemCreator((function(t){return rt.isCompatible(t)?new yt(t):null})),Ct.addItemCreator((function(t){return ct.isCompatible(t)?new It(t):null})),Ct.addItemCreator((function(t){return wt.isCompatible(t)?new At(t):null})),Ct.addItemCreator((function(t){return Dt.isCompatible(t)?new xt(t):null})),Ct.setItemCreatorDefault((function(t){return new Rt(t)}))},Bt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemCheck"},n}(rt),Pt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getSelection=function(){return null},n.prototype.getType=function(){return"DMenuSidedItemLink"},n}(ct),Ft=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.initHover=function(t){},n.prototype.onMenuSelect=function(n,i,r){t.prototype.onMenuSelect.call(this,n,i,r);var e=this.getSelection();e&&e.add(i)},n.prototype.onOpen=function(t){t.open(this,this)},n.prototype.getType=function(){return"DMenuSidedItemMenu"},n}(gt),_t=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemSeparator"},n}(wt),Ut=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemSpace"},n}(Dt),zt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemText"},n}(it),Gt=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,n){return ht.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)||ht.newItem(t,n)},t.newItems=function(t,n,i){ht.newItemsOf(this,t,n,i)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),Ht=function(){Gt.setItemCreatorDefault((function(t){return new zt(t)})),Gt.addItemCreator((function(t){return Dt.isCompatible(t)?new Ut(t):null})),Gt.addItemCreator((function(t){return wt.isCompatible(t)?new _t(t):null})),Gt.addItemCreator((function(t,n){return gt.isCompatible(t)?new Ft(gt.toSubMenuOptions(t,n)):null})),Gt.addItemCreator((function(t){return ct.isCompatible(t)?new Pt(t):null})),Gt.addItemCreator((function(t){return rt.isCompatible(t)?new Bt(t):null}))},Vt=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,n){return ht.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,n)||Gt.newItem(t,n)},t.newItems=function(t,n,i){ht.newItemsOf(this,t,n,i)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),Wt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.newItems=function(t,n,i,r){null!=r&&null!=r.items&&Vt.newItems(t,r.items,n)},n.prototype.getType=function(){return"DMenuSidedItemExpandable"},n}(kt),Yt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemCheck"},n}(yt),Xt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemLink"},n}(ct),Kt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuItemExpandableItemMenu"},n}(gt),Jt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onOpen=function(t){t.open(this,this)},n.prototype.getType=function(){return"DMenuSidedItemExpandableItemMenu"},n}(Kt),Zt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemSeparator"},n}(At),qt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemSpace"},n}(xt),Qt=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DMenuSidedItemExpandableItemText"},n}(Rt),$t=function(){Gt.addItemCreator((function(t){return kt.isCompatible(t)?new Wt(t):null})),Vt.addItemCreator((function(t){return rt.isCompatible(t)?new Yt(t):null})),Vt.addItemCreator((function(t){return ct.isCompatible(t)?new Xt(t):null})),Vt.addItemCreator((function(t,n){return gt.isCompatible(t)?new Jt(gt.toSubMenuOptions(t,n)):null})),Vt.addItemCreator((function(t){return wt.isCompatible(t)?new Zt(t):null})),Vt.addItemCreator((function(t){return Dt.isCompatible(t)?new qt(t):null})),Vt.setItemCreatorDefault((function(t){return new Qt(t)}))},tn=function(){Ot(),Lt(),Ht(),$t()},nn={};!function(t){t[t.CIRCLE=0]="CIRCLE",t[t.RECTANGLE=1]="RECTANGLE",t[t.RECTANGLE_ROUNDED=2]="RECTANGLE_ROUNDED",t[t.TRIANGLE=3]="TRIANGLE",t[t.TRIANGLE_ROUNDED=4]="TRIANGLE_ROUNDED",t[t.LINE=5]="LINE",t[t.IMAGE=6]="IMAGE",t[t.GROUP=7]="GROUP",t[t.BAR=8]="BAR",t[t.LABEL=9]="LABEL",t[t.NULL=10]="NULL",t[t.GROUP_SHADOWED=11]="GROUP_SHADOWED",t[t.LINE_OF_CIRCLES=12]="LINE_OF_CIRCLES",t[t.LINE_OF_RECTANGLES=13]="LINE_OF_RECTANGLES",t[t.LINE_OF_RECTANGLE_ROUNDEDS=14]="LINE_OF_RECTANGLE_ROUNDEDS",t[t.LINE_OF_TRIANGLES=15]="LINE_OF_TRIANGLES",t[t.LINE_OF_TRIANGLE_ROUNDEDS=16]="LINE_OF_TRIANGLE_ROUNDEDS",t[t.EXTENSION=1e3]="EXTENSION"}(St||(St={}));var rn,en={};!function(t){t[t.NONE=0]="NONE",t[t.CLOSED=1]="CLOSED",t[t.NON_EXPANDING_WIDTH=2]="NON_EXPANDING_WIDTH",t[t.NON_SHRINKING_WIDTH=4]="NON_SHRINKING_WIDTH",t[t.NON_SCALING_DOT_AND_DASH=8]="NON_SCALING_DOT_AND_DASH",t[t.DOTTED=16]="DOTTED",t[t.DOTTED_DENSELY=32]="DOTTED_DENSELY",t[t.DOTTED_LOOSELY=64]="DOTTED_LOOSELY",t[t.DASHED=128]="DASHED",t[t.DASHED_DENSELY=256]="DASHED_DENSELY",t[t.DASHED_LOOSELY=512]="DASHED_LOOSELY",t[t.DOTTED_MASK=112]="DOTTED_MASK",t[t.DASHED_MASK=896]="DASHED_MASK",t[t.NON_SOLID_MASK=1008]="NON_SOLID_MASK"}(rn||(rn={}));var un,sn=function(){function t(){}return t.toScaleInvariant=function(t){var n=t&rn.NON_EXPANDING_WIDTH?1:0,i=t&rn.NON_SHRINKING_WIDTH?2:0,r=t&rn.NON_SCALING_DOT_AND_DASH?4:0;return t&rn.NON_SOLID_MASK?n|i|r:n|i},t.toDash=function(t,n,i,r){return r.set(2*t,0),i&rn.NON_SOLID_MASK&&(i&rn.DOTTED?r.set(n,n):i&rn.DOTTED_DENSELY?r.set(n,.5*n):i&rn.DOTTED_LOOSELY?r.set(n,2*n):i&rn.DASHED?r.set(2*n,n):i&rn.DASHED_DENSELY?r.set(2*n,.5*n):i&rn.DASHED_LOOSELY&&r.set(2*n,2*n)),r},t}();!function(t){t[t.TOP=0]="TOP",t[t.LEFT=1]="LEFT",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=3]="BOTTOM"}(un||(un={}));var hn,on,an,fn=function(){function n(t,n,i,r){this.Bn=t,this.xt=0,this.Pn=[0,0,0,0],this.Fn=[],this.Xt=r,this._n=i,this.et=n,this.Un=NaN,this.zn=NaN,this.Gn=NaN,this.Hn=NaN}return n.prototype.getComputedSize=function(t,n,i,r){if(0<=t)return t;switch(n){case un.TOP:case un.BOTTOM:return Math.abs(r);case un.RIGHT:case un.LEFT:return Math.abs(i)}return 0},n.prototype.update=function(){var t=this.Bn.size,n=t.x,i=t.y,r=this.et,e=this._n;if(this.Un!==e||this.zn!==n||this.Gn!==i||this.Hn!==r){this.xt+=1,this.Un=e,this.zn=n,this.Gn=i,this.Hn=r;var u=.5*n,s=.5*i,h=this.getComputedSize(e,r,n,i),o=this.Pn;switch(r){case un.TOP:o[0]=0,o[1]=-s,o[2]=0,o[3]=-s+h;break;case un.RIGHT:o[0]=u,o[1]=0,o[2]=u-h,o[3]=0;break;case un.BOTTOM:o[0]=0,o[1]=s,o[2]=0,o[3]=s-h;break;case un.LEFT:o[0]=-u,o[1]=0,o[2]=-u+h,o[3]=0}}},Object.defineProperty(n.prototype,"length",{get:function(){return 2},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.update(),this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){return this.update(),this.Pn},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"segments",{get:function(){return this.Fn},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this._n},set:function(t){this.moveTo(void 0,t,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this.et},set:function(t){this.moveTo(t,void 0,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.Xt},set:function(t){this.moveTo(void 0,void 0,t)},enumerable:!0,configurable:!0}),n.prototype.copy=function(t){return t instanceof n?this.moveTo(t.position,t.size,t.style):this.moveTo(void 0,void 0,t.style)},n.prototype.set=function(t,n,i){var r,e;if(null!=t){var u=t[0];if(0===u){var s=t[1];r=s<=0?un.TOP:un.BOTTOM,e=Math.abs(t[3]-s)}else r=u<=0?un.LEFT:un.RIGHT,e=Math.abs(t[2]-u)}return this.moveTo(r,e,i)},n.prototype.moveTo=function(t,n,i){var r=!1;return null!=i&&this.Xt!==i&&(this.Xt=i,r=!0),null!=t&&this.et!==t&&(this.et=t,r=!0),null!=n&&this._n!==n&&(this._n=n,r=!0),r&&this.Bn.updateUploaded(),this},n.prototype.clone=function(t){return new n(t,this.et,this._n,this.Xt)},n.prototype.toPoints=function(n){for(var i=[],r=this.values,e=0,u=r.length;e<u;e+=2){var s=new t.Point(r[e+0],r[e+1]);i.push(n.apply(s,s))}return i},n.prototype.serialize=function(t){return t.add("["+this.et+","+this._n+","+this.Xt+"]")},n.prototype.deserialize=function(t,n){if(0<=t&&t<n.resources.length){var i=n.resources[t],r=JSON.parse(i);this.moveTo(r[0],r[1],r[2])}},n.prototype.calcHitPointAbs=function(t,n,i,r,e,u,s,h){if(2<=this.length){var o=this.Pn;if(s(t,n,o[0],o[1],o[2],o[3],0,e,h))return!0}return!1},n}(),cn=function(){function t(){this.values=[]}return t.prototype.add=function(t,n){var i=this.values;null!=n?i.splice(n,0,t):i.push(t)},t.prototype.addAll=function(t){for(var n=t,i=this.values,r=0,e=n.length;r<e;++r)i.push(n[r])},t.prototype.indexOf=function(t){for(var n=this.values,i=0,r=n.length;i<r;++i)if(n[i]===t)return i;for(i=0,r=n.length;i<r;++i)if(n[i].isEquals(t))return i;return-1},t.prototype.get=function(t){var n=this.values[t];return null!=n?n:null},t.prototype.set=function(t,n){this.values[t]=n},t.prototype.remove=function(t){this.values.splice(t,1)},t.prototype.clear=function(){this.values.length=0},t.prototype.size=function(){return this.values.length},t.prototype.swap=function(t,n){var i=this.values,r=i[n];i[n]=i[t],i[t]=r},t.prototype.serialize=function(t){for(var n=[],i=this.values,r=0,e=i.length;r<e;++r)n.push(i[r].serialize(t));return n},t}();!function(t){t[t.NONE=0]="NONE",t[t.TRANSFORM=1]="TRANSFORM",t[t.SIZE=2]="SIZE",t[t.STYLE=4]="STYLE",t[t.ACTION=8]="ACTION",t[t.POINTS=16]="POINTS",t[t.STATE=32]="STATE",t[t.ALL=63]="ALL"}(hn||(hn={})),function(t){t[t.NONE=0]="NONE",t[t.POSITION_X=1]="POSITION_X",t[t.POSITION_Y=2]="POSITION_Y",t[t.POSITION=3]="POSITION",t[t.ROTATION=4]="ROTATION",t[t.COLOR_FILL=8]="COLOR_FILL",t[t.COLOR_STROKE=16]="COLOR_STROKE",t[t.COLOR_FILL_AND_STROKE=24]="COLOR_FILL_AND_STROKE",t[t.COLOR_TEXT=32]="COLOR_TEXT",t[t.COLOR_TEXT_OUTLINE=64]="COLOR_TEXT_OUTLINE",t[t.COLOR=120]="COLOR",t[t.VISIBILITY=128]="VISIBILITY",t[t.HEIGHT=256]="HEIGHT",t[t.WIDTH=512]="WIDTH",t[t.SIZE=768]="SIZE",t[t.TEXT=1024]="TEXT",t[t.CURSOR=2048]="CURSOR"}(on||(on={})),function(t){t[t.NONE=0]="NONE",t[t.CHANGED=1]="CHANGED",t[t.CLICKED=2]="CLICKED",t[t.DOWN=4]="DOWN",t[t.UP=8]="UP",t[t.PRESSED=16]="PRESSED",t[t.PERSISTENT=16]="PERSISTENT"}(an||(an={}));var ln,vn,bn=function(){function n(n){var i=n.transform,r=i.position;this.x=r.x,this.y=r.y,this.size=new t.Point(n.size.x,n.size.y),this.rotation=i.rotation,this.actions=[],this.fill=n.fill.toObject(),this.stroke=n.stroke.toObject(),this.text=n.text.toObject(),this.cursor=n.cursor,this.reset=on.NONE,this.written=on.NONE,this.effect=NaN,this.state=an.NONE,this.interactive=!1}return n.prototype.onPointerClick=function(t,n){t.disabled||this.state&an.CLICKED||(this.state|=an.CHANGED|an.CLICKED,e.update(t))},n.prototype.onPointerDblClick=function(t,n){return!1},n.prototype.onPointerOver=function(t,n){t.hovered=!0},n.prototype.onPointerOut=function(t,n){t.hovered=!1},n.prototype.onPointerDown=function(t,n){var i=e.getLayer(t);if(this.state&an.DOWN||(this.state|=an.CHANGED|an.DOWN|an.PRESSED,i&&i.update()),i){var r=i.getFocusController();r.setFocused(r.findFocusableParent(t),!0,!0)}},n.prototype.onPointerUp=function(t,n){this.state&an.UP||(this.state|=an.CHANGED|an.UP,this.state&=~an.PRESSED,e.update(t))},n.prototype.onPointerMove=function(t,n){},n.prototype.onKeyDown=function(t,n){return B.isActivateKey(n)&&this.onPointerDown(t),!1},n.prototype.onKeyUp=function(t,n){return B.isActivateKey(n)&&(this.onPointerUp(t),this.onPointerClick(t)),!1},n.prototype.onStateChange=function(t,n,i){this.state|=an.CHANGED,e.update(t)},n.prototype.update=function(t,n){var i=t.tag,r=this.effect<=n;(i.isChanged||this.state&an.CHANGED||r)&&(r&&(this.effect=NaN),t.disallowUploadedUpdate(),this.onUpdate(t,n),t.allowUploadedUpdate(),this.state&=an.PERSISTENT,i.isChanged=!1)},n.prototype.onUpdate=function(t,n){0<this.actions.length&&(this.executeActions(t,n),this.resetUnwrittenProperties(t))},n.prototype.executeActions=function(t,n){this.written=on.NONE;for(var i=this.actions,r=0,e=i.length;r<e;++r)i[r].execute(t,this,n)},n.prototype.resetUnwrittenProperties=function(t){var n=~this.written&this.reset;if(n!==on.NONE){if(n&on.POSITION_X&&(t.transform.position.x=this.x),n&on.POSITION_Y&&(t.transform.position.y=this.y),n&on.VISIBILITY&&(t.visible=!0),n&on.COLOR_FILL){var i=this.fill;t.fill.set(void 0,i.color,i.alpha)}if(n&on.COLOR_STROKE){var r=this.stroke;t.stroke.set(void 0,r.color,r.alpha)}if(n&on.COLOR_TEXT){var e=this.text;t.text.set(void 0,e.color,e.alpha)}if(n&on.COLOR_TEXT_OUTLINE){var u=this.text.outline;t.text.outline.set(void 0,u.color,u.alpha)}n&on.HEIGHT&&(t.size.y=this.size.y),n&on.WIDTH&&(t.size.x=this.size.x),n&on.ROTATION&&(t.transform.rotation=this.rotation),n&on.TEXT&&(t.text.value=this.text.value),n&on.CURSOR&&(t.cursor=this.cursor)}},n}(),gn=function(n){function r(i){var r=n.call(this)||this;return r.internalTransform=new t.Matrix,r.Bn=i,r}return i(r,n),r.prototype.onChange=function(){t.Transform.prototype.onChange.call(this),this.Bn.onTransformChange()},r.prototype.updateSkew=function(){t.Transform.prototype.updateSkew.call(this),this.Bn.onTransformChange()},r.prototype.getLocalIdCurrent=function(){return this._currentLocalID},r.prototype.getLocalId=function(){return this._localID},r.prototype.getParentId=function(){return this._parentID},r.prototype.getWorldId=function(){return this._worldID},r.prototype.updateTransform=function(t){var i=this._currentLocalID,e=this._worldID;n.prototype.updateTransform.call(this,t);var u=this._currentLocalID,s=this._worldID;if(i!==u){var h=this.localTransform,o=this.internalTransform;h.copyTo(o),t instanceof r&&o.prepend(t.internalTransform)}else e!==s&&(h=this.localTransform,o=this.internalTransform,t instanceof r&&(h.copyTo(o).prepend(t.internalTransform),this._currentLocalID+=1,this._localID=this._currentLocalID))},r}(t.Transform),dn=function(t,n,i){var r=t.length;if(n<r)return t;for(var e="",u=0,s=n-r;u<s;++u)e+=i;return e+t},mn=function(){function t(){}return t.toCode=function(t){return dn(t.toString(16).toUpperCase(),6,"0")},t.fromCode=function(t){var n=t.trim().toLowerCase();if(6===n.length){var i=Number("0x"+n);if(i==i)return i}return null},t.fromRgb=function(t,n,i){return(255*t<<16)+(255*n<<8)+(255*i|0)},t.blend=function(t,n,i){var r=t>>16&255,e=t>>8&255,u=255&(0|t),s=n>>16&255,h=n>>8&255,o=255&(0|n),a=Math.max(0,Math.min(1,i)),f=1-a;return(Math.max(0,Math.min(255,r*f+s*a))<<16)+(Math.max(0,Math.min(255,e*f+h*a))<<8)+(0|Math.max(0,Math.min(255,u*f+o*a)))},t.brighten=function(t,n){return this.blend(t,16777215,n)},t.darken=function(t,n){return this.blend(t,0,n)},t}(),wn=function(){function t(){}return t.serializeGradient=function(t){for(var n=t.points,i="["+t.direction,r=0,e=n.length,u=1;r<e;r+=1,u+=3){var s=n[r];i+=","+s.color+","+s.alpha+","+s.position}return i+"]"},t.parseGradient=function(t){try{return JSON.parse(t)}catch(t){return null}},t.deserializeGradient=function(t){var n=this.parseGradient(t);if(!(null==n||n.length<7)){for(var i=n[0],r=[],e=1,u=n.length;e<u;e+=3)r.push({color:n[e+0],alpha:n[e+1],position:n[e+2]});return{points:r,direction:i}}},t.toGradientId=function(t,n){return null!=t?(null==t.serialized&&(t.serialized=this.serializeGradient(t)),n.add(t.serialized)):-1},t.toGradientImageUrl=function(t){for(var n=t.direction,i=t.points,r="",e=0,u=i.length;e<u;++e){var s=i[e],h=mn.toCode(s.color),o=s.alpha;r+='<stop offset="'+100*s.position+'%" stop-color="#'+h+'" stop-opacity="'+o+'" />'}var a=n*Math.PI/180,f=.5*Math.cos(a),c=-.5*Math.sin(a);return"data:image/svg+xml;base64,"+btoa('<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs><linearGradient id="o2glkm3aeu2oio" x1="'+(.5-f)+'" x2="'+(.5+f)+'" y1="'+(.5-c)+'" y2="'+(.5+c)+'">'+r+'</linearGradient></defs><rect x="0" y="0" width="32" height="32" stroke="none" fill="url(#o2glkm3aeu2oio)" /></svg>')},t}(),pn=function(n){function r(t){var i=n.call(this)||this;return i.id="",i.type=t,i.transform=i.newTransform(),i.Vn=0,i.Wn=!1,i.action=new cn,i.Yn=!0,i.Xn=0,i.Kn=!1,i.Jn=!1,i.Zn=NaN,i.qn=NaN,i.Qn=NaN,i.Nt=i.Tt=v.UNFOCUSABLE,i.interactive=!1,i.parent=null,i.children=[],i.selected=!1,i.index=0,i.reference=0,i}return i(r,n),r.prototype.newTransform=function(){return new gn(this)},r.prototype.onSizeChange=function(){this.Zn=NaN,this.qn=NaN,this.Qn=NaN,this.$n(),this.updateUploaded()},r.prototype.onTransformChange=function(){this.$n(),this.updateUploadedRecursively()},r.prototype.$n=function(){if(0===this.Vn){var t=this.parent;null!=t&&t.onChildTransformChange()}else this.Wn=!0},r.prototype.disallowOnTransformChange=function(){this.Vn+=1,1===this.Vn&&(this.Wn=!1)},r.prototype.allowOnTransformChange=function(t){this.Vn-=1,0===this.Vn&&this.Wn&&(this.Wn=!1,t&&this.onTransformChange())},r.prototype.onChildTransformChange=function(){},r.prototype.disallowUploadedUpdate=function(){this.Xn+=1,1===this.Xn&&(this.Kn=!1,this.Jn=!1)},r.prototype.allowUploadedUpdate=function(){this.Xn-=1,0===this.Xn&&(this.Jn?(this.Jn=!1,this.Kn=!1,this.updateUploadedRecursively()):this.Kn&&(this.Kn=!1,this.updateUploaded()))},r.prototype.updateUploadedRecursively=function(){if(0===this.Xn){this.updateUploaded();for(var t=this.children,n=0,i=t.length;n<i;++n)t[n].updateUploadedRecursively()}else this.Jn=!0},r.prototype.updateUploaded=function(){if(0===this.Xn){var t=this.uploaded;null!=t&&t.update(this)}else this.Kn=!0},Object.defineProperty(r.prototype,"root",{get:function(){for(var t=this;t.parent instanceof r;)t=t.parent;return t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"visible",{get:function(){var t=this.parent;return t instanceof r?t.visible&&this.Yn:this.Yn},set:function(t){this.Yn!==t&&(this.Yn=t,this.updateUploadedRecursively())},enumerable:!0,configurable:!0}),r.prototype.toDirty=function(){var t=this.parent;null!=t&&t.toDirty()},r.prototype.attach=function(t,n){this.detach(),this.parent=t;var i=t.children;return null!=n&&0<=n&&n<i.length?i.splice(n,0,this):i.push(this),this.uploaded=void 0,t.onChildTransformChange(),t.toDirty(),this},r.prototype.detach=function(){var t=this.parent;if(null!=t){this.parent=null,this.uploaded=void 0;var n=t.children,i=n.indexOf(this);0<=i&&(n.splice(i,1),t.onChildTransformChange(),t.toDirty())}return this},r.prototype.updateTransform=function(){var n=this.parent;n?(n.parent&&n.updateTransform(),this.transform.updateTransform(n.transform)):this.transform.updateTransform(t.Transform.IDENTITY)},r.prototype.serializeChildren=function(t){for(var n=this.children,i=[],r=0,e=n.length;r<e;++r){var u=n[r];i.push(u.serialize(t))}return i},r.prototype.serializeImage=function(t){var n=this.image;return null!=n?t.add(n.src):-1},r.prototype.serializeGradient=function(t){return wn.toGradientId(this.gradient,t)},r.prototype.serialize=function(t){var n=this.transform,i=n.position,r=n.pivot,e=this.size,u=this.shortcut,s=null!=u?t.add(u):-1,h=this.title,o=null!=h?t.add(h):-1;return[this.type,t.add(this.id),i.x,i.y,e.x,e.y,n.rotation,n.skew.x,this.fill.serialize(t),this.stroke.serialize(t),t.add(this.cursor.trim()),this.text.serialize(t),this.tag.serialize(t),this.radius,this.corner,-1,-1,this.action.serialize(t),this.serializeImage(t),this.serializeGradient(t),this.serializeChildren(t),r.x,r.y,(this.interactive?1:0)|(this.unfocusable?2:0),s,o]},r.prototype.toLocalRect=function(t,n){var i=t.x,r=t.y,e=this.size,u=.5*e.x,s=.5*e.y,h=this.transform.pivot,o=i-h.x,a=r-h.y,f=this.stroke,c=f.width*f.align;return 0<=u?0<=s?(n.x=+o,n.y=+a,n.width=+u+c,n.height=+s+c):(n.x=+o,n.y=-a,n.width=+u+c,n.height=-s+c):0<=s?(n.x=-o,n.y=+a,n.width=-u+c,n.height=+s+c):(n.x=-o,n.y=-a,n.width=-u+c,n.height=-s+c),n},r.prototype.contains=function(t){var n=this.toLocalRect(t,r.WORK_RECT);if(this.containsAbs(n.x,n.y,n.width,n.height))return this;var i=t.x,e=t.y;return this.containsText(i,e,t)||this.containsChildren(i,e,t)},r.prototype.containsText=function(t,n,i){var r=this.text;if(null!=r.atlas){var e=r.world;if(null!=e){i.set(t,n),this.transform.internalTransform.apply(i,i);var u=i.x-e[0],s=i.y-e[1],h=e[2]*u+e[3]*s,o=e[4]*u+e[5]*s;if(0<=h&&h<=e[6]&&0<=o&&o<=e[7])return this}}return null},r.prototype.containsChildren=function(t,n,i){for(var r=this.children,e=r.length-1;0<=e;--e){var u=r[e];i.set(t,n),u.updateTransform(),u.transform.localTransform.applyInverse(i,i);var s=u.contains(i);if(null!=s)return this.shadowed?this:s}return null},r.prototype.containsBBox=function(t){var n=this.toLocalRect(t,r.WORK_RECT);return this.containsAbsBBox(n.x,n.y,n.width,n.height)},r.prototype.containsAbs=function(t,n,i,r){return this.containsAbsBBox(t,n,i,r)},r.prototype.containsAbsBBox=function(t,n,i,r){return-i<=t&&t<=+i&&-r<=n&&n<=+r},r.prototype.select=function(t){return!1},r.prototype.toGlobal=function(t,n,i){return!0!==i&&this.updateTransform(),n.copyFrom(t),this.transform.worldTransform.apply(n,n),n},r.prototype.toLocal=function(n,i,r,e){return!0!==e&&this.updateTransform(),void 0===r&&(r=new t.Point),r.copyFrom(n),this.transform.worldTransform.applyInverse(r,r),r},r.prototype.getBounds=function(n,i,r){!0!==i&&this.updateTransform();var e=this._bounds=this._bounds||new t.Rectangle,u=this.transform.getWorldId();return u!==this.Zn&&(this.Zn=u,this.ti(this.transform.worldTransform,n,e)),r.copyFrom(e),r},r.prototype.getBoundsInternal=function(n,i,r){!0!==i&&this.updateTransform();var e=this.ni=this.ni||new t.Rectangle,u=this.transform.getLocalIdCurrent();return u!==this.qn&&(this.qn=u,this.ti(this.transform.internalTransform,n,e)),r.copyFrom(e),r},r.prototype.getBoundsLocal=function(n,i,r){!0!==i&&this.updateTransform();var e=this.ii=this.ii||new t.Rectangle,u=this.transform.getLocalIdCurrent();return u!==this.Qn&&(this.Qn=u,this.ti(this.transform.localTransform,n,e)),r.copyFrom(e),r},r.prototype.getBoundsSize=function(){return this.size},r.prototype.ti=function(t,n,i){var r=this.transform.pivot,e=r.x,u=r.y,s=this.getBoundsSize(),h=.5*s.x,o=.5*s.y,a=t.a,f=t.b,c=t.c,l=t.d,v=-h+e,b=-o+u,g=a*v+c*b,d=f*v+l*b,m=a*(v=+h+e)+c*(b=-o+u),w=f*v+l*b,p=a*(v=-h+e)+c*(b=+o+u),D=f*v+l*b,O=a*(v=+h+e)+c*(b=+o+u),S=f*v+l*b,M=Math.min(g,m,p,O),E=Math.min(d,w,D,S),N=Math.max(g,m,p,O),T=Math.max(d,w,D,S);return i.x=M+t.tx,i.y=E+t.ty,i.width=N-M,i.height=T-E,i},r.prototype.destroy=function(){for(var t=this.children,n=t.length-1;0<=n;--n)t[n].destroy();t.length=0},r.prototype.updateState=function(){var t=this.parent,n=this.Tt,i=t instanceof r?this.mergeState(n,t.getState()):n,e=this.Nt;e!==i&&(this.Nt=i,this.onStateChange(i,e))},r.prototype.mergeState=function(t,n){return t|n&v.DISABLED|(n&(v.FOCUSED|v.FOCUSED_IN)?v.FOCUSED_IN:v.NONE)},r.prototype.onStateChange=function(t,n){var i=this.runtime;null!=i&&i.onStateChange(this,t,n);for(var e=this.children,u=0,s=e.length;u<s;++u){var h=e[u];h instanceof r&&h.onParentStateChange(t,n)}},r.prototype.onParentStateChange=function(t,n){var i=this.mergeState(this.Tt,t),r=this.Nt;r!==i&&(this.Nt=i,this.onStateChange(i,r))},r.prototype.getState=function(){return this.Nt},r.prototype.setState=function(t,n){return!!(this.Tt&t)!==n&&(n?this.Tt|=t:this.Tt&=~t,this.updateState()),this},r.prototype.hasState=function(t){return!!(this.Nt&t)},r.prototype.focus=function(){return this.focused=!0,this},r.prototype.blur=function(){return this.focused=!1,this},Object.defineProperty(r.prototype,"hovered",{get:function(){return this.hasState(v.HOVERED)},set:function(t){this.setState(v.HOVERED,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"active",{get:function(){return this.hasState(v.ACTIVE)},set:function(t){this.setState(v.ACTIVE,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"readonly",{get:function(){return this.hasState(v.READ_ONLY)},set:function(t){this.setState(v.READ_ONLY,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"enabled",{get:function(){return!this.hasState(v.DISABLED)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"disabled",{get:function(){return this.hasState(v.DISABLED)},set:function(t){this.setState(v.DISABLED,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"dragging",{get:function(){return this.hasState(v.DRAGGING)},set:function(t){this.setState(v.DRAGGING,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"focused",{get:function(){return this.hasState(v.FOCUSED)},set:function(t){if(this.focused!==t){var n=e.getLayer(this);n&&n.getFocusController().setFocused(this,t,!1)}},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"focusedin",{get:function(){return this.hasState(v.FOCUSED|v.FOCUSED_IN)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"unfocusable",{get:function(){return this.hasState(v.UNFOCUSABLE)},set:function(t){this.setState(v.UNFOCUSABLE,t)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"clicked",{get:function(){var t=this.runtime;return!!(t&&t.state&an.CLICKED)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"pressed",{get:function(){var t=this.runtime;return!!(t&&t.state&an.PRESSED)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"down",{get:function(){var t=this.runtime;return!!(t&&t.state&an.DOWN)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"up",{get:function(){var t=this.runtime;return!!(t&&t.state&an.UP)},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"shadowed",{get:function(){return!1},enumerable:!0,configurable:!0}),r.prototype.onDblClick=function(t){var n=this.runtime;return null!=n&&n.onPointerDblClick(this)},r.prototype.onShortcut=function(t){var n=this.runtime;if(null!=n)return n.onPointerClick(this)},r.prototype.onKeyDown=function(t){var n=this.runtime;return null!=n&&n.onKeyDown(this,t)},r.prototype.onKeyUp=function(t){var n=this.runtime;return null!=n&&n.onKeyUp(this,t)},r.prototype.update=function(t){var n=this.runtime;null!=n&&n.update(this,t)},r.prototype.updateRecursively=function(t){this.update(t);for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].update(t)},r.prototype.copy=function(t,n){if(void 0===n&&(n=hn.ALL),this.id=t.id,0!=(n&hn.TRANSFORM)){var i=this.transform,r=t.transform;i.position.copyFrom(r.position),i.rotation=r.rotation,i.skew.copyFrom(r.skew),i.pivot.copyFrom(r.pivot),i.scale.copyFrom(r.scale)}if(0!=(n&hn.SIZE)&&this.size.copyFrom(t.size),0!=(n&hn.STYLE)&&(this.fill.copy(t.fill),this.stroke.copy(t.stroke),this.tag.copy(t.tag),this.text.copy(t.text),this.radius=t.radius,this.corner=t.corner,null==this.image&&(this.image=t.image)),0!=(n&hn.ACTION)&&(this.action.addAll(t.action.values),this.interactive=t.interactive,this.cursor=t.cursor,this.shortcut=t.shortcut),0!=(n&hn.POINTS)){var e=t.points;if(null!=e){var u=this.points;null!=u?u.copy(e):this.points=e.clone(this)}}return 0!=(n&hn.STATE)&&this.setState(t.getState(),!0),this},r.WORK_RECT=new t.Rectangle,r}(t.utils.EventEmitter);!function(t){t[t.NONE=0]="NONE",t[t.TOP_LEFT=1]="TOP_LEFT",t[t.TOP_RIGHT=2]="TOP_RIGHT",t[t.BOTTOM_LEFT=4]="BOTTOM_LEFT",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT",t[t.TOP=3]="TOP",t[t.BOTTOM=12]="BOTTOM",t[t.LEFT=5]="LEFT",t[t.RIGHT=10]="RIGHT",t[t.ALL=15]="ALL"}(ln||(ln={})),function(t){t[t.NONE=0]="NONE",t[t.TOP=1]="TOP",t[t.RIGHT=2]="RIGHT",t[t.BOTTOM=4]="BOTTOM",t[t.LEFT=8]="LEFT",t[t.TOP_OR_LEFT=9]="TOP_OR_LEFT",t[t.TOP_OR_RIGHT=3]="TOP_OR_RIGHT",t[t.BOTTOM_OR_LEFT=12]="BOTTOM_OR_LEFT",t[t.BOTTOM_OR_RIGHT=6]="BOTTOM_OR_RIGHT",t[t.ALL=15]="ALL"}(vn||(vn={}));var Dn,On,Sn=function(){function t(){}return t.IS_EDIT_MODE=!1,t.FILL_COLOR=16777215,t.FILL_ALPHA=.5,t.STROKE_COLOR=5197647,t.STROKE_COLOR_DARK=5197647,t.STROKE_COLOR_LIGHT=13684944,t.STROKE_ALPHA=1,t.STROKE_WIDTH=2,t.STROKE_ALIGN=0,t.STROKE_SIDE=vn.ALL,t.TEXT_VALUE="",t.TEXT_FAMILY="auto",t.TEXT_SIZE=14,t.CURSOR="",t.RADIUS=.25,t.SIZE_X=100,t.SIZE_Y=100,t.HIGHLIGHT_COLOR=2000880,t}(),Mn=function(){function t(t,n,i,r){this.Bn=t,this.ri=n,this.h=i,this.o=r}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ri},set:function(t){this.ri!==t&&(this.ri=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.h!==t&&(this.h=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha)},t.prototype.set=function(t,n,i){var r=!1;void 0!==t&&this.ri!==t&&(this.ri=t,r=!0),void 0!==n&&this.h!==n&&(this.h=n,r=!0),void 0!==i&&this.o!==i&&(this.o=i,r=!0),r&&this.Bn.updateUploaded()},t.prototype.clone=function(){return new t(this.Bn,this.ri,this.h,this.o)},t.prototype.toObject=function(){return{enable:this.ri,color:this.h,alpha:this.o}},t.prototype.serialize=function(t){var n="["+(this.ri?1:0)+","+this.h+","+this.o+"]";return t.add(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.fills.get(t);if(null!=r)this.set(0!==r[0],r[1],r[2]);else{var e=JSON.parse(i[t]);n.fills.set(t,e),this.set(0!==e[0],e[1],e[2])}}},t}(),En=function(){function t(t,n,i,r,e,u,s){this.Bn=t,this.ri=n,this.h=i,this.o=r,this.l=e,this.v=u,this.ei=s}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ri},set:function(t){this.ri!==t&&(this.ri=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.h!==t&&(this.h=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.l},set:function(t){this.l!==t&&(this.l=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this.v},set:function(t){this.v!==t&&(this.v=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){return this.ei},set:function(t){this.ei!==t&&(this.ei=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha,t.width,t.align,t.side)},t.prototype.set=function(t,n,i,r,e,u){var s=!1;void 0!==t&&this.ri!==t&&(this.ri=t,s=!0),void 0!==n&&this.h!==n&&(this.h=n,s=!0),void 0!==i&&this.o!==i&&(this.o=i,s=!0),void 0!==r&&this.l!==r&&(this.l=r,s=!0),void 0!==e&&this.v!==e&&(this.v=e,s=!0),void 0!==u&&this.ei!==u&&(this.ei=u,s=!0),s&&this.Bn.updateUploaded()},t.prototype.clone=function(){return new t(this.Bn,this.ri,this.h,this.o,this.l,this.v,this.ei)},t.prototype.toObject=function(){return{enable:this.ri,color:this.h,alpha:this.o,width:this.l,align:this.v,side:this.ei}},t.prototype.serialize=function(t){var n="["+(this.ri?1:0)+","+this.h+","+this.o+","+this.l+","+this.v+","+this.ei+"]";return t.add(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.strokes.get(t);if(null!=r)this.set(0!==r[0],r[1],r[2],r[3],r[4],r[5]);else{var e=JSON.parse(i[t]);n.strokes.set(t,e),this.set(0!==e[0],e[1],e[2],e[3],e[4],e[5])}}},t}();!function(t){t[t.ASCENDING=0]="ASCENDING",t[t.DESCENDING=1]="DESCENDING"}(Dn||(Dn={})),function(t){t[t.NONE=0]="NONE",t[t.FROM=1]="FROM",t[t.TO=2]="TO",t[t.FROM_TO=3]="FROM_TO"}(On||(On={}));var Nn,Tn,jn,Cn,kn,yn=function(){function t(){this.si=On.NONE,this.hi=0,this.oi=1}return Object.defineProperty(t.prototype,"type",{get:function(){return this.si},set:function(t){if(this.si!==t){this.si=t;var n=this.parent;null!=n&&(n.isChanged=!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"from",{get:function(){return this.hi},set:function(t){if(this.hi!==t){this.hi=t;var n=this.parent;null!=n&&(n.isChanged=!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.oi},set:function(t){if(this.oi!==t){this.oi=t;var n=this.parent;null!=n&&(n.isChanged=!0)}},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n){var i=!1;if(void 0!==t&&void 0!==n)if(null!==t&&null!==n){var r=this.si|On.FROM|On.TO;this.si===r&&this.hi===t&&this.oi===n||(this.si=r,this.hi=t,this.oi=n,i=!0)}else null!==t?(r=(this.si|On.FROM)&~On.TO,this.si===r&&this.hi===t||(this.si=r,this.hi=t,i=!0)):null!==n?(r=(this.si|On.TO)&~On.FROM,this.si===r&&this.hi===t||(this.si=r,this.oi=n,i=!0)):(r=this.si&~(On.TO|On.FROM),this.si!==r&&(this.si=r,i=!0));else void 0!==t?null!==t?(r=this.si|On.FROM,this.si===r&&this.hi===t||(this.si=r,this.hi=t,i=!0)):(r=this.si&~On.FROM,this.si!==r&&(this.si=r,i=!0)):void 0!==n&&(null!==n?(r=this.si|On.TO,this.si===r&&this.oi===n||(this.si=r,this.oi=n,i=!0)):(r=this.si&~On.TO,this.si!==r&&(this.si=r,i=!0)));if(i){var e=this.parent;null!=e&&(e.isChanged=!0)}return i},t.prototype.normalize=function(t){var n=this.si,i=this.hi,r=this.oi;switch(n){case On.FROM_TO:return(t-i)/(r-i);case On.FROM:return t-i;case On.TO:return r-t;case On.NONE:default:return t}},t.prototype.isEquals=function(t){return this.si===t.type&&this.hi===t.from&&this.oi===t.to},t.prototype.copy=function(t){return this.ai(t.type,t.from,t.to)},t.prototype.ai=function(t,n,i){var r=!1;if(this.si!==t&&(this.si=t,r=!0),this.hi!==n&&(this.hi=n,r=!0),this.oi!==i&&(this.oi=i,r=!0),r){var e=this.parent;null!=e&&(e.isChanged=!0)}return this},t.prototype.toObject=function(){return{type:this.type,from:this.from,to:this.to}},t.prototype.serialize=function(t){var n="["+this.si+","+this.hi+","+this.oi+"]";return t.add(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.ranges.get(t);if(null!=r)this.ai(r[0],r[1],r[2]);else{var e=JSON.parse(i[t]);n.ranges.set(t,e),this.ai(e[0],e[1],e[2])}}},t}(),In=function(t,n){return t-n},An=function(){function t(){this.id="",this.initial="",this.format="",this.range=new yn,this.Sn=0,this.fi=0,this.ci=0,this.li=Dn.ASCENDING}return Object.defineProperty(t.prototype,"parent",{get:function(){return this.Bn},set:function(t){this.Bn!==t&&(this.Bn=t,this.range.parent=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.Sn},set:function(t){var n=this.formatter;null!=n&&(t=n(t));var i=this.ci;if(i<=0){if(this.Sn!==t){this.Sn=t;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var e=this.Pn;null==e&&(e=[],this.Pn=e),this.Sn=t;var u=this.li;u===Dn.ASCENDING?e.push(t):e.unshift(t);var s=e.length-i;if(0<s)if(u===Dn.ASCENDING)for(var h=0;h<s;++h)e.shift();else e.length=i;var o=this.parent;null!=o&&(o.isChanged=!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nvalue",{get:function(){return this.range.normalize(this.Sn)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var t=this.Pn;return null==t&&(t=[],this.Pn=t),t},set:function(t){if(0<t.length){var n=this.ci;if(n<=0){var i=t[t.length-1];if(null!=(u=this.formatter)&&(i=u(i)),this.Sn!==i){this.Sn=i;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var e=this.Pn;null==e&&(e=[],this.Pn=e);var u,s=this.li;if(null!=(u=this.formatter))if(this.Sn=u(t[t.length-1]),s===Dn.ASCENDING)for(var h=0,o=t.length;h<o;++h)e.push(u(t[h]));else for(h=0,o=t.length;h<o;++h)e.unshift(u(t[h]));else if(this.Sn=t[t.length-1],s===Dn.ASCENDING)for(h=0,o=t.length;h<o;++h)e.push(t[h]);else for(h=0,o=t.length;h<o;++h)e.unshift(t[h]);var a=e.length-n;if(0<a)if(s===Dn.ASCENDING)for(h=0;h<a;++h)e.shift();else e.length=n;var f=this.parent;null!=f&&(f.isChanged=!0)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this.fi},set:function(t){var n=this.ci;if(n<=0){if(this.fi!==t){this.fi=t;var i=this.parent;null!=i&&(i.isChanged=!0)}}else{var r=this.vi;null==r&&(r=[],this.vi=r),this.fi=t;var e=this.li;e===Dn.ASCENDING?r.push(t):r.unshift(t);var u=r.length-n;if(0<u)if(e===Dn.ASCENDING)for(var s=0;s<u;++s)r.shift();else r.length=n;var h=this.parent;null!=h&&(h.isChanged=!0)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"times",{get:function(){var t=this.vi;return null==t&&(t=[],this.vi=t),t},set:function(t){if(0<t.length){var n=this.ci;if(n<=0){var i=t[t.length-1];if(this.fi!==i){this.fi=i;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var e=this.vi;null==e&&(e=[],this.vi=e),this.fi=t[t.length-1];var u=this.li;if(u===Dn.ASCENDING)for(var s=0,h=t.length;s<h;++s)e.push(t[s]);else for(s=0,h=t.length;s<h;++s)e.unshift(t[s]);var o=e.length-n;if(0<o)if(u===Dn.ASCENDING)for(s=0;s<o;++s)e.shift();else e.length=n;var a=this.parent;null!=a&&(a.isChanged=!0)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){return this.ci},set:function(t){if(this.ci<t)this.ci=t;else if(t<this.ci){this.ci=t;var n=!1,i=this.li,r=this.Pn;if(null!=r&&0<(u=r.length-t)){if(i===Dn.ASCENDING)for(var e=0;e<u;++e)r.shift();else r.length=t;n=!0}var u,s=this.vi;if(null!=s&&0<(u=s.length-t)){if(i===Dn.ASCENDING)for(e=0;e<u;++e)s.shift();else s.length=t;n=!0}if(n){var h=this.parent;null!=h&&(h.isChanged=!0)}}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this.li},set:function(t){this.li=t},enumerable:!0,configurable:!0}),t.prototype.remove=function(t){var n=!1,i=this.Pn;null!=i&&0<=t&&t<i.length&&(i.splice(t,1),n=!0);var r=this.vi;if(null!=r&&0<=t&&t<r.length&&(r.splice(t,1),n=!0),n){var e=this.parent;null!=e&&(e.isChanged=!0)}},t.prototype.removeAll=function(t){var n=!1,i=this.Pn,r=this.vi,e=t.slice(0).sort(In);if(null!=i)if(null!=r)for(var u=e.length-1;0<=u;--u)0<=(s=e[u])&&(s<i.length&&(i.splice(s,1),n=!0),s<r.length&&(r.splice(s,1),n=!0));else for(u=e.length-1;0<=u;--u)0<=(s=e[u])&&s<i.length&&(i.splice(s,1),n=!0);else if(null!=r)for(u=e.length-1;0<=u;--u){var s;0<=(s=e[u])&&s<r.length&&(r.splice(s,1),n=!0)}if(n){var h=this.parent;null!=h&&(h.isChanged=!0)}},t.prototype.clear=function(){var t=!1,n=this.Pn;null!=n&&(n.length=0,t=!0);var i=this.vi;if(null!=i&&(i.length=0,t=!0),t){var r=this.parent;null!=r&&(r.isChanged=!0)}},t.prototype.copy=function(t){return this.id=t.id,this.initial=t.initial,this.format=t.format,this.formatter=t.formatter,this.range.copy(t.range),this.Sn=t.value,this.fi=t.time,this.ci=t.capacity,this},t.prototype.serialize=function(t){var n=t.add(this.id),i=t.add(this.initial),r=t.add(this.format.trim()),e=this.range.serialize(t);return t.add("["+n+","+i+","+r+","+e+","+this.ci+","+this.li+"]")},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.tagValues.get(t);null==r&&(r=JSON.parse(i[t]),n.tagValues.set(t,r)),this.id=i[r[0]]||"",this.initial=i[r[1]]||"",this.format=i[r[2]]||"",this.range.deserialize(r[3],n),this.ci=r[4],this.li=r[5]}return this},t}(),xn=function(){function t(){this.Pn=[],this.isChanged=!0}return Object.defineProperty(t.prototype,"id",{get:function(){var t=this.Pn;if(0<t.length)return t[0].id;var n=this.inherited;return null!=n?n.id:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){var t=this.Pn;if(0<t.length)return t[0].initial;var n=this.inherited;return null!=n?n.initial:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){var t=this.Pn;if(0<t.length)return t[0].format;var n=this.inherited;return null!=n?n.format:""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){var n=this.Pn;if(0<n.length)return n[0].range;var i=this.inherited;return null!=i?i.range:t.RANGE_DUMMY},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var t=this.Pn;if(0<t.length)return t[0].value;var n=this.inherited;return null!=n?n.value:0},set:function(t){var n=this.Pn;if(0<n.length)n[0].value=t;else{var i=this.inherited;null!=i&&(i.value=t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"nvalue",{get:function(){var t=this.Pn;if(0<t.length)return t[0].nvalue;var n=this.inherited;return null!=n?n.nvalue:0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var t=this.Pn;if(0<t.length)return t[0].time;var n=this.inherited;return null!=n?n.time:0},set:function(t){var n=this.Pn;if(0<n.length)n[0].time=t;else{var i=this.inherited;null!=i&&(i.time=t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var n=this.Pn;if(0<n.length)return n[0].values;var i=this.inherited;return null!=i?i.values:t.EMPTY_ARRAY},set:function(t){var n=this.Pn;if(0<n.length)n[0].values=t;else{var i=this.inherited;null!=i&&(i.values=t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"times",{get:function(){var n=this.Pn;if(0<n.length)return n[0].times;var i=this.inherited;return null!=i?i.times:t.EMPTY_ARRAY},set:function(t){var n=this.Pn;if(0<n.length)n[0].times=t;else{var i=this.inherited;null!=i&&(i.times=t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){var t=this.Pn;if(0<t.length)return t[0].capacity;var n=this.inherited;return null!=n?n.capacity:0},set:function(t){var n=this.Pn;if(0<n.length)n[0].capacity=t;else{var i=this.inherited;null!=i&&(i.capacity=t)}},enumerable:!0,configurable:!0}),t.prototype.add=function(t,n){var i=this.Pn;t.parent=this,void 0===n?i.push(t):i.splice(n,0,t)},t.prototype.set=function(t,n){var i=this.Pn;if(0<=t&&t<i.length){var r=i[t];return n.parent=this,i[t]=n,r.parent=void 0,r}return null},t.prototype.remove=function(t){var n=this.Pn;0<=t&&t<n.length&&(n.splice(t,1)[0].parent=void 0)},t.prototype.indexOf=function(t){for(var n=this.Pn,i=0,r=n.length;i<r;++i)if((e=n[i])===t)return i;for(i=0,r=n.length;i<r;++i)if((e=n[i]).id===t.id&&e.initial===t.initial&&e.formatter===t.formatter&&e.range.isEquals(t.range))return i;for(i=0,r=n.length;i<r;++i){var e;if((e=n[i]).id===t.id)return i}return-1},t.prototype.get=function(t){var n=this.Pn;return 0<=t&&t<n.length?n[t]:null},t.prototype.size=function(){return this.Pn.length},t.prototype.swap=function(t,n){var i=this.Pn,r=i[n];i[n]=i[t],i[t]=r},t.prototype.copy=function(t){var n=this.Pn;n.length=0;for(var i=0,r=t.size();i<r;++i){var e=t.get(i);if(null!=e){var u=(new An).copy(e);u.parent=this,n.push(u)}}return this},t.prototype.serialize=function(t){var n=this.Pn;if(n.length<=0)return t.add("[]");for(var i="["+n[0].serialize(t),r=1,e=n.length;r<e;++r)i+=","+n[r].serialize(t);return i+="]",t.add(i)},t.prototype.deserialize=function(t,n){if(0<=t&&t<n.resources.length){var i=n.tags.get(t);null==i&&(i=JSON.parse(n.resources[t]),n.tags.set(t,i));var r=this.Pn;r.length=0;for(var e=0,u=i.length;e<u;++e){var s=i[e],h=new An;h.parent=this,h.deserialize(s,n),r.push(h)}}},t.RANGE_DUMMY=new yn,t.EMPTY_ARRAY=[],t}();!function(t){t[t.NORMAL=0]="NORMAL",t[t.BOLD=1]="BOLD"}(Nn||(Nn={})),function(t){t[t.NORMAL=0]="NORMAL",t[t.ITALIC=1]="ITALIC"}(Tn||(Tn={})),function(t){t[t.LEFT=0]="LEFT",t[t.CENTER=1]="CENTER",t[t.RIGHT=2]="RIGHT",t[t.OUTSIDE_LEFT=3]="OUTSIDE_LEFT",t[t.OUTSIDE_RIGHT=4]="OUTSIDE_RIGHT"}(jn||(jn={})),function(t){t[t.TOP=0]="TOP",t[t.MIDDLE=1]="MIDDLE",t[t.BOTTOM=2]="BOTTOM",t[t.OUTSIDE_TOP=3]="OUTSIDE_TOP",t[t.OUTSIDE_BOTTOM=4]="OUTSIDE_BOTTOM"}(Cn||(Cn={})),function(t){t[t.LEFT_TO_RIGHT=0]="LEFT_TO_RIGHT",t[t.TOP_TO_BOTTOM=1]="TOP_TO_BOTTOM",t[t.BOTTOM_TO_TOP=2]="BOTTOM_TO_TOP"}(kn||(kn={}));var Rn,Ln=function(){function t(t,n,i){this.Bn=t,this.bi=n,this.gi=i}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return this.bi},set:function(t){this.bi!==t&&(this.bi=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this.gi},set:function(t){this.gi!==t&&(this.gi=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.horizontal,t.vertical)},t.prototype.set=function(t,n){var i=!1;null!=t&&this.bi!==t&&(this.bi=t,i=!0),null!=n&&this.gi!==n&&(this.gi=n,i=!0),i&&this.Bn.updateUploaded()},t.prototype.toObject=function(){return{horizontal:this.bi,vertical:this.gi}},t.prototype.serialize=function(t){return t.add("["+this.bi+","+this.gi+"]")},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.aligns.get(t);if(null!=r)this.set(r[0],r[1]);else{var e=JSON.parse(i[t]);n.aligns.set(t,e),this.set(e[0],e[1])}}},t}(),Bn=function(){function t(t,n,i){this.Bn=t,this.bi=n,this.gi=i}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return this.bi},set:function(t){this.bi!==t&&(this.bi=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this.gi},set:function(t){this.gi!==t&&(this.gi=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.horizontal,t.vertical)},t.prototype.set=function(t,n){var i=!1;null!=t&&this.bi!==t&&(this.bi=t,i=!0),null!=n&&this.gi!==n&&(this.gi=n,i=!0),i&&this.Bn.updateUploaded()},t.prototype.toObject=function(){return{horizontal:this.bi,vertical:this.gi}},t.prototype.serialize=function(t){return t.add("["+this.bi+","+this.gi+"]")},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.margins.get(t);if(null!=r)this.set(r[0],r[1]);else{var e=JSON.parse(i[t]);n.margins.set(t,e),this.set(e[0],e[1])}}},t}(),Pn=function(){function t(t,n,i,r,e){this.Bn=t,this.ri=n,this.h=i,this.o=r,this.l=e}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ri},set:function(t){this.ri!==t&&(this.ri=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.h!==t&&(this.h=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.l},set:function(t){this.l!==t&&(this.l=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha,t.width)},t.prototype.set=function(t,n,i,r){var e=!1;void 0!==t&&this.ri!==t&&(this.ri=t,e=!0),void 0!==n&&this.h!==n&&(this.h=n,e=!0),void 0!==i&&this.o!==i&&(this.o=i,e=!0),void 0!==r&&this.l!==r&&(this.l=r,e=!0),e&&this.Bn.updateUploaded()},t.prototype.clone=function(){return new t(this.Bn,this.ri,this.h,this.o,this.l)},t.prototype.toObject=function(){return{enable:this.ri,color:this.h,alpha:this.o,width:this.l}},t.prototype.serialize=function(t){var n="["+(this.ri?1:0)+","+this.h+","+this.o+","+this.l+"]";return t.add(n)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.textOutlines.get(t);if(null!=r)this.set(0!==r[0],r[1],r[2],r[3]);else{var e=JSON.parse(i[t]);n.textOutlines.set(t,e),this.set(0!==e[0],e[1],e[2],e[3])}}},t}(),Fn=function(){function t(t,n,i,r,e,u){this.Bn=t,this.ri=!0,this.Sn=n,this.h=i,this.o=r,this.di=e,this._n=u,this.Ct=Nn.NORMAL,this.align=new Ln(t,jn.CENTER,Cn.MIDDLE),this.offset=new Bn(t,0,0),this.Xt=Tn.NORMAL,this.spacing=new Bn(t,0,0),this.outline=new Pn(t,!1,16777215,1,.5),this.yn=kn.LEFT_TO_RIGHT,this.padding=new Bn(t,10,10),this.Wt=!1}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ri},set:function(t){this.ri!==t&&(this.ri=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this.Sn},set:function(t){if(this.Sn!==t){this.Sn=t;var n=this.Bn,i=n.uploaded;if(null==i||!i.isCompatible(n))return this.atlas=void 0,void n.toDirty();var r=this.atlas,e=r&&r.characters;if(null==e)return this.atlas=void 0,void n.toDirty();for(var u=0,s=t.length;u<s;++u)if(!(t[u]in e))return this.atlas=void 0,void n.toDirty();n.updateUploaded()}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this.di},set:function(t){this.di!==t&&(this.di=t,this.Bn.toDirty())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.h!==t&&(this.h=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._n},set:function(t){this._n!==t&&(this._n=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this.Ct},set:function(t){this.Ct!==t&&(this.Ct=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this.Xt},set:function(t){this.Xt!==t&&(this.Xt=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this.yn},set:function(t){this.yn!==t&&(this.yn=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){return this.Wt},set:function(t){this.Wt!==t&&(this.Wt=t,this.Bn.updateUploaded())},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){return t&&(this.set(t.value,t.color,t.alpha,t.family,t.size,t.weight,t.style,t.direction,t.clipping),this.align.copy(t.align),this.offset.copy(t.offset),this.outline.copy(t.outline),this.spacing.copy(t.spacing),this.padding.copy(t.padding)),this},t.prototype.set=function(t,n,i,r,e,u,s,h,o){var a=!1,f=!1;return null!=t&&this.Sn!==t&&(this.Sn=t,a=!0),null!=n&&this.h!==n&&(this.h=n,f=!0),null!=i&&this.o!==i&&(this.o=i,f=!0),null!=r&&this.di!==r&&(this.di=r,a=!0),null!=e&&this._n!==e&&(this._n=e,f=!0),null!=u&&this.Ct!==u&&(this.Ct=u,f=!0),null!=s&&this.Xt!==s&&(this.Xt=s,f=!0),null!=h&&this.yn!==h&&(this.yn=h,f=!0),null!=o&&this.Wt!==o&&(this.Wt=o,f=!0),a?this.Bn.toDirty():f&&this.Bn.updateUploaded(),this},t.prototype.toObject=function(){return{value:this.Sn,color:this.h,alpha:this.o,family:this.di,size:this._n,weight:this.Ct,align:this.align.toObject(),offset:this.offset.toObject(),style:this.Xt,outline:this.outline.toObject(),direction:this.yn,spacing:this.spacing.toObject(),padding:this.padding.toObject(),clipping:this.Wt}},t.prototype.serialize=function(t){var n=this.align.serialize(t),i=this.offset.serialize(t),r=this.outline.serialize(t),e=this.spacing.serialize(t),u=this.padding.serialize(t),s="["+t.add(this.Sn)+","+this.h+","+this.o+","+t.add(this.di)+","+this._n+","+this.Ct+","+n+","+i+","+this.Xt+","+r+","+e+","+this.yn+","+u+","+(this.Wt?1:0)+"]";return t.add(s)},t.prototype.deserialize=function(t,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.texts.get(t);null==r&&(r=JSON.parse(i[t]),n.texts.set(t,r)),this.set(i[r[0]]||"",r[1],r[2],i[r[3]]||"auto",r[4],r[5],r[8],r[11],0!==r[13]),this.align.deserialize(r[6],n),this.offset.deserialize(r[7],n),this.outline.deserialize(r[9],n),this.spacing.deserialize(r[10],n),this.padding.deserialize(r[12],n)}},t}(),_n=function(n){function r(t){var i=n.call(this,t)||this;return i.size=i.newSize(),i.fill=i.newFill(),i.stroke=i.newStroke(),i.O=Sn.RADIUS,i.Et=ln.ALL,i.tag=new xn,i.text=i.newText(),i.cursor=Sn.CURSOR,i}return i(r,n),r.prototype.newSize=function(){var n=this;return new t.ObservablePoint((function(){n.onSizeChange()}),void 0,Sn.SIZE_X,Sn.SIZE_Y)},r.prototype.newFill=function(){return new Mn(this,!0,Sn.FILL_COLOR,Sn.FILL_ALPHA)},r.prototype.newStroke=function(){return new En(this,!0,Sn.STROKE_COLOR,Sn.STROKE_ALPHA,Sn.STROKE_WIDTH,Sn.STROKE_ALIGN,Sn.STROKE_SIDE)},r.prototype.newText=function(){return new Fn(this,Sn.TEXT_VALUE,Sn.STROKE_COLOR,Sn.STROKE_ALPHA,Sn.TEXT_FAMILY,Sn.TEXT_SIZE)},Object.defineProperty(r.prototype,"corner",{get:function(){return this.Et},set:function(t){this.Et!==t&&(this.Et=t,this.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"radius",{get:function(){return this.O},set:function(t){this.O!==t&&(this.O=t,this.updateUploaded())},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"image",{get:function(){return this.vn},set:function(t){if(this.vn!==t){null!=t?(this.vn=t,this.imageSrc=t.src):(this.vn=void 0,this.imageSrc=void 0);var n=this.parent;null!=n&&n.toDirty()}},enumerable:!0,configurable:!0}),r}(pn),Un=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.serialize=function(n){var i=t.prototype.serialize.call(this,n);return i[15]=this.points.serialize(n),i},n.prototype.getPixelScale=function(){var t=this.root.parent;return null!=t&&null!=t.getPixelScale?t.getPixelScale():1},n.prototype.getStrokeWidthScale=function(t){var n=t.style;return n&rn.NON_EXPANDING_WIDTH?n&rn.NON_SHRINKING_WIDTH?this.getPixelScale():Math.min(1,this.getPixelScale()):n&rn.NON_SHRINKING_WIDTH?Math.max(1,this.getPixelScale()):1},n.prototype.toHitThreshold=function(t){var n=this.stroke,i=n.enable?n.width:0,r=this.getStrokeWidthScale(this.points);return t?t(i,r):i*r*.5},n.prototype.containsAbs=function(t,n,i,r){var e=this.points,u=this.toHitThreshold(null);return!!this.containsAbsBBox(t,n,i+u,r+u)&&e.calcHitPointAbs(t,n,i,r,u,null,this.calcHitPointAbsHitTester,null)},n.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.points,s=this.toHitThreshold(n),h=this.toLocalRect(t,pn.WORK_RECT);return!!this.containsAbsBBox(h.x,h.y,h.width+s,h.height+s)&&u.calcHitPointAbs(h.x,h.y,h.width,h.height,s,i,r,e)},n.prototype.calcHitPointAbsHitTester=function(t,n,i,r,e,u,s,h,o){var a=e-i,f=u-r,c=t-i,l=n-r,v=a*a+f*f,b=a*c+f*l,g=c*c+l*l;if(1e-4<v){var d=Math.max(0,Math.min(1,b/v));if(v*d*d-2*b*d+g<h*h)return!0}return!1},n.WORK_RANGE=[0,0],n}(_n),zn=function(t){function n(n,i,r,e){var u=t.call(this,St.BAR)||this;return u.fill.enable=!1,u.stroke.set(!0,void 0,void 0,r),u.points=new fn(u,n,i,e),u}return i(n,t),n.prototype.clone=function(){var t=this.points;return new n(t.position,t.size,this.stroke.width,t.style).copy(this)},n.prototype.containsAbsBBox=function(n,i,r,e){var u=Math.max(0,this.points.size);return t.prototype.containsAbsBBox.call(this,n,i,r+u,e+u)},n}(Un),Gn=new Float32Array(4),Hn=function(n,i,r,e,u){for(var s=t.utils.premultiplyTintToRgba(n,i,Gn),h=s[0],o=s[1],a=s[2],f=s[3],c=r<<2,l=r+e<<2;c<l;c+=4)u[c+0]=h,u[c+1]=o,u[c+2]=a,u[c+3]=f},Vn=function(){function n(t,n,i,r,e,u){this.buffer=t,this.transformLocalId=-1,this.vertexOffset=n,this.vertexCount=r,this.indexOffset=i,this.indexCount=e,this.colorFill=NaN,this.alphaFill=-1,this.colorStroke=NaN,this.alphaStroke=-1,this.sizeX=NaN,this.sizeY=NaN,this.strokeWidth=NaN,this.strokeAlign=NaN,this.strokeSide=NaN,this.radius=NaN,this.corner=NaN,this.texture=null,this.textureTransformId=NaN,this.antialiasWeight=u}return n.prototype.init=function(t){return t.uploaded=this,this},n.prototype.isCompatible=function(t){return!0},n.prototype.getBuffer=function(){return this.buffer},n.prototype.getVertexOffset=function(){return this.vertexOffset},n.prototype.getVertexCount=function(){return this.vertexCount},n.prototype.getIndexOffset=function(){return this.indexOffset},n.prototype.getIndexCount=function(){return this.indexCount},n.prototype.toTransformLocalId=function(t){return t.updateTransform(),t.transform.getLocalId()},n.prototype.toTexture=function(n){return n.texture||t.Texture.WHITE},n.prototype.toTextureTransformId=function(t){var n=t;return null==n._uvs&&t.updateUvs(),n._updateID},n.prototype.toTextureUvs=function(t){return t._uvs},n.prototype.updateColorFill=function(t,n,i){var r=n.fill,e=n.visible&&r.enable,u=r.color,s=e?r.alpha:0;u===this.colorFill&&s===this.alphaFill||(this.colorFill=u,this.alphaFill=s,t.colorFillBuffer.update(),Hn(u,s,this.vertexOffset,i,t.colorFills))},n.prototype.updateColorStroke=function(t,n,i){var r=n.stroke,e=n.visible&&r.enable&&0<r.width,u=r.color,s=e?r.alpha:0;u===this.colorStroke&&s===this.alphaStroke||(this.colorStroke=u,this.alphaStroke=s,t.colorStrokeBuffer.update(),Hn(u,s,this.vertexOffset,i,t.colorStrokes))},n.prototype.updateColorFillAndStroke=function(t,n,i){this.updateColorFill(t,n,i),this.updateColorStroke(t,n,i)},n.prototype.buildUnit=function(n){var i=this.texture||t.Texture.WHITE,r=i.baseTexture;if(r!==n.baseTexture){n.baseTexture=r;var e=this.indexOffset;n.push(i,e)}},n}(),Wn=function(){function t(){}return t.getTextCount=function(t,n){var i=t.text.value.length,r=12*Math.ceil(i/12);return n.vertexCount=r<<2,n.indexCount=r<<1,n},t}(),Yn=function(t,n,i,r){var e=i-t,u=r-n;return Math.sqrt(e*e+u*u)},Xn=function(n){function r(t,i,r,e,u,s,h,o){var a=n.call(this,t,i,r,s,h,o)||this;return a.textSize=NaN,a.textFamily="auto",a.textValue="",a.textTexture=null,a.textTextureTransformId=NaN,a.textColor=NaN,a.textAlpha=NaN,a.textWeight=NaN,a.textStyle=NaN,a.textAlignHorizontal=NaN,a.textAlignVertical=NaN,a.textOffsetHorizontal=NaN,a.textOffsetVertical=NaN,a.textOutlineWidth=NaN,a.textOutlineColor=NaN,a.textOutlineAlpha=NaN,a.textSpacingHorizontal=NaN,a.textSpacingVertical=NaN,a.textDirection=NaN,a.textPaddingHorizontal=NaN,a.textPaddingVertical=NaN,a.textClipping=!1,a.textVertexCount=e,a.textIndexCount=u,a}return i(r,n),r.prototype.isCompatible=function(t){return!!n.prototype.isCompatible.call(this,t)&&Wn.getTextCount(t,this.buffer.workCount).vertexCount===this.textVertexCount},r.prototype.updateColor=function(t,n){var i=this.vertexCount-this.textVertexCount;this.updateColorFillAndStroke(t,n,i)},r.prototype.getTextBBox=function(t,n,i,r,e,u,s,h,o,a,f,c,l,v,b,g,d,m,w,p,D){switch(t){case jn.LEFT:switch(n){case Cn.TOP:D.x=o+d*(i+e)+w*(r+u),D.y=a+m*(i+e)+p*(r+u);break;case Cn.MIDDLE:D.x=.5*(o+b)+d*(i+e)+w*(r-.5*h),D.y=.5*(a+g)+m*(i+e)+p*(r-.5*h);break;case Cn.BOTTOM:D.x=b+d*(i+e)+w*(r-u-h),D.y=g+m*(i+e)+p*(r-u-h);break;case Cn.OUTSIDE_TOP:D.x=o+d*(i+e)+w*(r-u-h),D.y=a+m*(i+e)+p*(r-u-h);break;case Cn.OUTSIDE_BOTTOM:D.x=b+d*(i+e)+w*(r+u),D.y=g+m*(i+e)+p*(r+u)}break;case jn.CENTER:switch(n){case Cn.TOP:D.x=.5*(o+f)+d*(i-.5*s)+w*(r+u),D.y=.5*(a+c)+m*(i-.5*s)+p*(r+u);break;case Cn.MIDDLE:D.x=.5*(o+l)+d*(i-.5*s)+w*(r-.5*h),D.y=.5*(a+v)+m*(i-.5*s)+p*(r-.5*h);break;case Cn.BOTTOM:D.x=.5*(b+l)+d*(i-.5*s)+w*(r-u-h),D.y=.5*(g+v)+m*(i-.5*s)+p*(r-u-h);break;case Cn.OUTSIDE_TOP:D.x=.5*(o+f)+d*(i-.5*s)+w*(r-u-h),D.y=.5*(a+c)+m*(i-.5*s)+p*(r-u-h);break;case Cn.OUTSIDE_BOTTOM:D.x=.5*(b+l)+d*(i-.5*s)+w*(r+u),D.y=.5*(g+v)+m*(i-.5*s)+p*(r+u)}break;case jn.RIGHT:switch(n){case Cn.TOP:D.x=f+d*(i-e-s)+w*(r+u),D.y=c+m*(i-e-s)+p*(r+u);break;case Cn.MIDDLE:D.x=.5*(f+l)+d*(i-e-s)+w*(r-.5*h),D.y=.5*(c+v)+m*(i-e-s)+p*(r-.5*h);break;case Cn.BOTTOM:D.x=l+d*(i-e-s)+w*(r-u-h),D.y=v+m*(i-e-s)+p*(r-u-h);break;case Cn.OUTSIDE_TOP:D.x=f+d*(i-e-s)+w*(r-u-h),D.y=c+m*(i-e-s)+p*(r-u-h);break;case Cn.OUTSIDE_BOTTOM:D.x=l+d*(i-e-s)+w*(r+u),D.y=v+m*(i-e-s)+p*(r+u)}break;case jn.OUTSIDE_LEFT:switch(n){case Cn.TOP:D.x=o+d*(i-e-s)+w*(r+u),D.y=a+m*(i-e-s)+p*(r+u);break;case Cn.MIDDLE:D.x=.5*(o+b)+d*(i-e-s)+w*(r-.5*h),D.y=.5*(a+g)+m*(i-e-s)+p*(r-.5*h);break;case Cn.BOTTOM:D.x=b+d*(i-e-s)+w*(r-u-h),D.y=g+m*(i-e-s)+p*(r-u-h);break;case Cn.OUTSIDE_TOP:D.x=o+d*(i-e-s)+w*(r-u-h),D.y=a+m*(i-e-s)+p*(r-u-h);break;case Cn.OUTSIDE_BOTTOM:D.x=b+d*(i-e-s)+w*(r+u),D.y=g+m*(i-e-s)+p*(r+u)}break;case jn.OUTSIDE_RIGHT:switch(n){case Cn.TOP:D.x=f+d*(i+e)+w*(r+u),D.y=c+m*(i+e)+p*(r+u);break;case Cn.MIDDLE:D.x=.5*(f+l)+d*(i+e)+w*(r-.5*h),D.y=.5*(c+v)+m*(i+e)+p*(r-.5*h);break;case Cn.BOTTOM:D.x=l+d*(i+e)+w*(r-u-h),D.y=v+m*(i+e)+p*(r-u-h);break;case Cn.OUTSIDE_TOP:D.x=f+d*(i+e)+w*(r-u-h),D.y=c+m*(i+e)+p*(r-u-h);break;case Cn.OUTSIDE_BOTTOM:D.x=l+d*(i+e)+w*(r+u),D.y=v+m*(i+e)+p*(r+u)}}},r.prototype.normalize=function(t,n,i,r,e){var u=t*t+n*n;if(1e-5<u){var s=Math.sqrt(u),h=1/s;return e.set(t*h,n*h),s}return e.set(i,r),0},r.prototype.rotateAlignHorizontalRight=function(t){switch(t){case jn.LEFT:return Cn.BOTTOM;case jn.CENTER:return Cn.MIDDLE;case jn.RIGHT:return Cn.TOP;case jn.OUTSIDE_LEFT:return Cn.OUTSIDE_BOTTOM;case jn.OUTSIDE_RIGHT:return Cn.OUTSIDE_TOP}},r.prototype.rotateAlignVerticalRight=function(t){switch(t){case Cn.TOP:return jn.LEFT;case Cn.MIDDLE:return jn.CENTER;case Cn.BOTTOM:return jn.RIGHT;case Cn.OUTSIDE_TOP:return jn.OUTSIDE_LEFT;case Cn.OUTSIDE_BOTTOM:return jn.OUTSIDE_RIGHT}},r.prototype.rotateAlignHorizontalLeft=function(t){switch(t){case jn.LEFT:return Cn.TOP;case jn.CENTER:return Cn.MIDDLE;case jn.RIGHT:return Cn.BOTTOM;case jn.OUTSIDE_LEFT:return Cn.OUTSIDE_TOP;case jn.OUTSIDE_RIGHT:return Cn.OUTSIDE_BOTTOM}},r.prototype.rotateAlignVerticalLeft=function(t){switch(t){case Cn.TOP:return jn.RIGHT;case Cn.MIDDLE:return jn.CENTER;case Cn.BOTTOM:return jn.LEFT;case Cn.OUTSIDE_TOP:return jn.OUTSIDE_RIGHT;case Cn.OUTSIDE_BOTTOM:return jn.OUTSIDE_LEFT}},r.prototype.updateTextVertex=function(n,i,r){var e=i.text,u=e.size,s=e.family,h=e.value,o=e.style,a=e.align.horizontal,f=e.align.vertical,c=e.offset.horizontal,l=e.offset.vertical,v=e.spacing.horizontal,b=e.spacing.vertical,g=e.direction,d=e.padding.horizontal,m=e.padding.vertical,w=e.clipping,p=e.texture||t.Texture.WHITE,D=this.toTextureTransformId(p),O=h!==this.textValue||s!==this.textFamily,S=u!==this.textSize,M=o!==this.textStyle,E=a!==this.textAlignHorizontal||f!==this.textAlignVertical,N=c!==this.textOffsetHorizontal||l!==this.textOffsetVertical,T=v!==this.textSpacingHorizontal||b!==this.textSpacingVertical||d!==this.textPaddingHorizontal||m!==this.textPaddingVertical,j=g!==this.textDirection,C=this.textClipping!==w,k=p!==this.textTexture||D!==this.textTextureTransformId;if(O||S||M||E||N||T||j||C||k){this.textSize=u,this.textFamily=s,this.textValue=h,this.textStyle=o,this.textAlignHorizontal=a,this.textAlignVertical=f,this.textOffsetHorizontal=c,this.textOffsetVertical=l,this.textSpacingHorizontal=v,this.textSpacingVertical=b,this.textDirection=g,this.textPaddingHorizontal=d,this.textPaddingVertical=m,this.textClipping=w,this.textTexture=p,this.textTextureTransformId=D,S&&(this.textWeight=NaN);var y=i.size,I=.5*y.x,A=.5*y.y;i.updateTransform();var x=i.transform.internalTransform,R=n.work;R.set(-I,-A),x.apply(R,R);var L=R.x,B=R.y;R.set(+I,-A),x.apply(R,R);var P=R.x,F=R.y;R.set(+I,+A),x.apply(R,R);var _=R.x,U=R.y,z=L+(_-P),G=B+(U-F),H=Yn(L,B,P,F);this.normalize(x.a,x.b,1,0,R);var W=R.x,Y=R.y,X=Yn(L,B,z,G);this.normalize(x.c,x.d,0,1,R);for(var K=R.x,J=R.y,Z=0,q=0,Q=0,$=Math.max(0,u+b),tt=0,nt=r.characters,it=V.from(h),rt=0;it.hasNext();)"\n"!==(Ht=it.next())?(0<rt&&(tt+=Math.max(0,rt+v)),(Vt=nt[Ht])?(rt=Vt.advance,Q=Vt.height):rt=0):(tt+=rt,rt=0,Z=Math.max(Z,tt),tt=0,q+=$);var et=u/r.font.size;tt+=rt,Z=Math.max(Z,tt)*et,tt=0,Q*=et,q+=u;var ut=0,st=0,ht=NaN;switch(g){case kn.LEFT_TO_RIGHT:if(this.getTextBBox(a,f,c,l,d,m,Z,q,L,B,P,F,_,U,z,G,W,Y,K,J,R),ut=R.x,st=R.y,w)switch(a){case jn.LEFT:case jn.CENTER:case jn.RIGHT:switch(f){case Cn.TOP:case Cn.MIDDLE:case Cn.BOTTOM:ht=H-2*d}}break;case kn.TOP_TO_BOTTOM:if(R.set(K,J),K=-W,J=-Y,W=R.x,Y=R.y,this.getTextBBox(this.rotateAlignVerticalRight(f),this.rotateAlignHorizontalRight(a),l,c,m,d,Z,q,P,F,_,U,z,G,L,B,W,Y,K,J,R),ut=R.x,st=R.y,w)switch(f){case Cn.TOP:case Cn.MIDDLE:case Cn.BOTTOM:switch(a){case jn.LEFT:case jn.CENTER:case jn.RIGHT:ht=X-2*m}}break;case kn.BOTTOM_TO_TOP:if(R.set(K,J),K=W,J=Y,W=-R.x,Y=-R.y,this.getTextBBox(this.rotateAlignVerticalLeft(f),this.rotateAlignHorizontalLeft(a),l,c,m,d,Z,q,z,G,L,B,P,F,_,U,W,Y,K,J,R),ut=R.x,st=R.y,w)switch(f){case Cn.TOP:case Cn.MIDDLE:case Cn.BOTTOM:switch(a){case jn.LEFT:case jn.CENTER:case jn.RIGHT:ht=X-2*m}}}var ot=e.world=e.world||new Float32Array(8);if(ht<Z){var at=.5*(Z-ht);ot[0]=ut+W*at,ot[1]=st+Y*at,ot[2]=W,ot[3]=Y,ot[4]=K,ot[5]=J,ot[6]=ht,ot[7]=q}else ot[0]=ut,ot[1]=st,ot[2]=W,ot[3]=Y,ot[4]=K,ot[5]=J,ot[6]=Z,ot[7]=q;var ft=this.toTextureUvs(p),ct=ft.x0,lt=ft.x1,vt=ft.x3,bt=ft.y0,gt=ft.y1,dt=ft.y3,mt=lt-ct,wt=gt-bt,pt=vt-ct,Dt=dt-bt,Ot=this.textVertexCount,St=this.vertexOffset+this.vertexCount-Ot,Mt=n.vertices,Et=n.uvs;n.vertexBuffer.update(),n.uvBuffer.update();var Nt=$*K,Tt=$*J,jt=et*W,Ct=et*Y,kt=.5*(Q-u),yt=kt*K,It=kt*J,At=o===Tn.NORMAL?0:.25*e.size,xt=ut-yt+At*jt,Rt=st-It+At*Ct,Lt=ut+yt+u*K,Bt=st+It+u*J,Pt=xt,Ft=Rt,_t=Lt,Ut=Bt;tt=0,rt=0,it.position=0;for(var zt=0,Gt=2*St;it.hasNext();Gt+=8){var Ht,Vt;if("\n"!==(Ht=it.next()))if(0<rt&&(tt+=Math.max(0,rt+v)),zt+=1,Vt=nt[Ht]){var Wt=Vt.advance;if(ht<tt){var Yt=nt["..."];if(Yt){this.writeCharacter(Mt,Et,Gt,Yt,r,jt,Ct,Pt,Ft,_t,Ut,mt,wt,pt,Dt,ct,bt);var Xt=Yt.advance;for(Pt+=Kt=Xt*jt,Ft+=Jt=Xt*Ct,_t+=Kt,Ut+=Jt,rt=Xt,Gt+=8;it.hasNext();Gt+=8){if(!it.advance("\n")){Gt-=8;break}this.writeCharacterEmpty(Mt,Et,Gt,Pt,Ft,_t,Ut,ct,bt,vt,dt),zt+=1}}else rt=Wt,this.writeCharacterEmpty(Mt,Et,Gt,Pt,Ft,_t,Ut,ct,bt,vt,dt)}else{var Kt,Jt;rt=Wt,this.writeCharacter(Mt,Et,Gt,Vt,r,jt,Ct,Pt,Ft,_t,Ut,mt,wt,pt,Dt,ct,bt),Pt+=Kt=Wt*jt,Ft+=Jt=Wt*Ct,_t+=Kt,Ut+=Jt}}else rt=0,this.writeCharacterEmpty(Mt,Et,Gt,Pt,Ft,_t,Ut,ct,bt,vt,dt);else tt+=rt,rt=0,this.writeCharacterEmpty(Mt,Et,Gt,Pt,Ft,_t,Ut,ct,bt,vt,dt),Pt=xt+=Nt,Ft=Rt+=Tt,_t=Lt+=Nt,Ut=Bt+=Tt,this.adjustTextAlignment(Mt,W,Y,zt,Gt,Z-tt*et,g,a,f),tt=0,zt=0}tt+=rt,this.adjustTextAlignment(Mt,W,Y,zt,Gt,Z-tt*et,g,a,f);for(var Zt=2*(St+Ot);Gt<Zt;Gt+=2)Mt[Gt+0]=ut,Mt[Gt+1]=st,Et[Gt+0]=ct,Et[Gt+1]=bt}},r.prototype.writeCharacterEmpty=function(t,n,i,r,e,u,s,h,o,a,f){t[i+0]=r,t[i+1]=e,t[i+2]=r,t[i+3]=e,t[i+4]=u,t[i+5]=s,t[i+6]=u,t[i+7]=s,n[i+0]=h,n[i+1]=o,n[i+2]=h,n[i+3]=o,n[i+4]=a,n[i+5]=f,n[i+6]=a,n[i+7]=f},r.prototype.writeCharacter=function(t,n,i,r,e,u,s,h,o,a,f,c,l,v,b,g,d){var m=r.x-r.origin.x,w=r.width,p=m*u,D=m*s,O=(m+w)*u,S=(m+w)*s;t[i+0]=h+p,t[i+1]=o+D,t[i+2]=h+O,t[i+3]=o+S,t[i+4]=a+O,t[i+5]=f+S,t[i+6]=a+p,t[i+7]=f+D;var M=r.x/e.width,E=r.y/e.height,N=(r.x+r.width)/e.width,T=(r.y+r.height)/e.height,j=c*M,C=l*M,k=c*N,y=l*N,I=v*E,A=b*E,x=v*T,R=b*T;n[i+0]=g+j+I,n[i+1]=d+C+A,n[i+2]=g+k+I,n[i+3]=d+y+A,n[i+4]=g+k+x,n[i+5]=d+y+R,n[i+6]=g+j+x,n[i+7]=d+C+R},r.prototype.moveText=function(t,n,i,r,e){for(var u=0,s=n-8*i;u<i;u+=1,s+=8)t[s+0]+=r,t[s+1]+=e,t[s+2]+=r,t[s+3]+=e,t[s+4]+=r,t[s+5]+=e,t[s+6]+=r,t[s+7]+=e},r.prototype.moveTextHalf=function(t,n,i,r,e,u){r*=.5,this.moveText(t,n,i,r*e,r*u)},r.prototype.moveTextFull=function(t,n,i,r,e,u){this.moveText(t,n,i,r*e,r*u)},r.prototype.adjustTextAlignment=function(t,n,i,r,e,u,s,h,o){if(1e-5<u)switch(s){case kn.LEFT_TO_RIGHT:switch(h){case jn.OUTSIDE_RIGHT:case jn.LEFT:break;case jn.CENTER:this.moveTextHalf(t,e,r,u,n,i);break;case jn.OUTSIDE_LEFT:case jn.RIGHT:this.moveTextFull(t,e,r,u,n,i)}break;case kn.TOP_TO_BOTTOM:switch(o){case Cn.OUTSIDE_BOTTOM:case Cn.TOP:break;case Cn.MIDDLE:this.moveTextHalf(t,e,r,u,n,i);break;case Cn.OUTSIDE_TOP:case Cn.BOTTOM:this.moveTextFull(t,e,r,u,n,i)}break;case kn.BOTTOM_TO_TOP:switch(o){case Cn.OUTSIDE_BOTTOM:case Cn.TOP:this.moveTextFull(t,e,r,u,n,i);break;case Cn.MIDDLE:this.moveTextHalf(t,e,r,u,n,i);break;case Cn.OUTSIDE_TOP:case Cn.BOTTOM:}}},r.prototype.updateTextColorFill=function(t,n){var i=n.text,r=i.color,e=n.visible&&i.enable?i.alpha:0;r===this.textColor&&e===this.textAlpha||(this.textColor=r,this.textAlpha=e,t.colorFillBuffer.update(),Hn(r,e,this.vertexOffset+this.vertexCount-this.textVertexCount,this.textVertexCount,t.colorFills))},r.prototype.updateTextColorStroke=function(t,n){var i=n.text,r=i.outline,e=r.color,u=n.visible&&i.enable?r.alpha:0;e===this.textOutlineColor&&u===this.textOutlineAlpha||(this.textOutlineColor=e,this.textOutlineAlpha=u,t.colorStrokeBuffer.update(),Hn(e,u,this.vertexOffset+this.vertexCount-this.textVertexCount,this.textVertexCount,t.colorStrokes))},r.prototype.updateTextStep=function(t,n){var i=n.text,r=i.outline,e=r.enable?r.width:0,u=i.weight;if(u!==this.textWeight||e!==this.textOutlineWidth){this.textWeight=u,this.textOutlineWidth=e,t.stepBuffer.update(),t.antialiasBuffer.update();var s=t.steps,h=t.antialiases,o=this.textVertexCount,a=this.vertexOffset+this.vertexCount-o,f=i.atlas;if(null!=f){for(var c=.05/(i.size/f.font.size),l=.4*e,v=(u===Nn.NORMAL?0:.05)-.025,b=(g=2*a)+2*o;g<b;g+=2)s[g+0]=c,s[g+1]=l;for(b=(g=4*a)+4*o;g<b;g+=4)h[g+0]=v,h[g+1]=1e-5,h[g+2]=1e-5,h[g+3]=1e-5}else{for(b=(g=2*a)+2*o;g<b;g+=2)s[g+0]=0,s[g+1]=0;var g;for(b=(g=4*a)+4*o;g<b;g+=4)h[g+0]=1e-5,h[g+1]=1e-5,h[g+2]=1e-5,h[g+3]=1e-5}}},r.prototype.updateText=function(t,n){if(0<this.textVertexCount){var i=n.text.atlas;null!=i&&(this.updateTextVertex(t,n,i),this.updateTextColorFill(t,n),this.updateTextColorStroke(t,n),this.updateTextStep(t,n))}},r.prototype.initText=function(){var t=this.textVertexCount;if(0<t){var n=this.textIndexCount,i=this.vertexOffset+this.vertexCount-t,r=this.indexOffset+this.indexCount-n,e=this.buffer;e.clippingBuffer.update();for(var u=e.clippings,s=(o=3*i)+3*t;o<s;o+=3)u[o+0]=0,u[o+1]=0,u[o+2]=2;e.indexBuffer.update();var h=e.indices,o=0,a=3*r;for(s=n>>1;o<s;o+=1,a+=6){var f=i+(o<<2);h[a+0]=f+0,h[a+1]=f+1,h[a+2]=f+3,h[a+3]=f+1,h[a+4]=f+2,h[a+5]=f+3}}},r.prototype.buildUnit=function(i){if(n.prototype.buildUnit.call(this,i),0<this.textVertexCount){var r=this.textTexture||t.Texture.WHITE,e=r.baseTexture;if(e!==i.baseTexture){i.baseTexture=e;var u=this.indexOffset+this.indexCount-this.textIndexCount;i.push(r,u)}}},r}(Vn),Kn=function(t){function n(n,i,r,e,u,s,h,o){var a=t.call(this,n,i,r,e,u,s,h,o)||this;return a.pointsId=NaN,a.pointsStyle=rn.NONE,a}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer,r=this.vertexOffset,e=this.indexOffset;i.clippingBuffer.update();var u=i.clippings;i.indexBuffer.update();var s=i.indices,h=3*r;u[h+0]=1,u[h+1]=0,u[h+2]=3,u[h+3]=0,u[h+4]=1,u[h+5]=5,u[h+6]=1,u[h+7]=0,u[h+8]=3,u[h+9]=0,u[h+10]=1,u[h+11]=5;var o=3*e;return s[o+0]=r+0,s[o+1]=r+2,s[o+2]=r+1,s[o+3]=r+1,s[o+4]=r+2,s[o+5]=r+3,this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;if(t instanceof zn){var i=t.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=t.stroke,h=s.enable?s.width:0,o=h!==this.strokeWidth,a=this.toTransformLocalId(t),f=this.transformLocalId!==a,c=t.points.id,l=c!==this.pointsId,v=t.points.style,b=v!==this.pointsStyle;if(u||f||o||l||b){this.sizeX=r,this.sizeY=e,this.strokeWidth=h,this.transformLocalId=a,this.pointsId=c,this.pointsStyle=v,n.vertexBuffer.update(),n.stepBuffer.update(),n.antialiasBuffer.update(),n.colorFillBuffer.update(),(u||f)&&(this.textSpacingHorizontal=NaN),l&&(this.textureTransformId=NaN);var g=this.vertexOffset,d=this.vertexCount-this.textVertexCount;this.updateLineVertexStepAndColorFill(n,t.points,h,t.transform.internalTransform,g,d)}}this.updateColor(n,t),this.updateBarUv(n,t),this.updateText(n,t)},n.prototype.updateColorFillAndStroke=function(t,n,i){this.updateColorStroke(t,n,i)},n.prototype.updateLineVertexStepAndColorFill=function(t,n,i,r,e,u){var s=2*e,h=4*e,o=t.vertices,a=t.steps,f=t.antialiases,c=t.colorFills,l=n.length,v=n.values,b=n.style,g=n.size,d=sn.toScaleInvariant(b),m=t.work;m.set(v[0],v[1]),r.apply(m,m);var w=m.x,p=m.y,D=l-1<<1;m.set(v[D+0],v[D+1]),r.apply(m,m);var O=m.x,S=m.y,M=O-w,E=S-p,N=Math.sqrt(M*M+E*E),T=N;if(0<=g&&1e-5<N){var j=g/N;O=w+(M*=j),S=p+(E*=j),T=g}var C=w-M,k=p-E,y=O+M,I=S+E;o[s+0]=w,o[s+1]=p,o[s+2]=w,o[s+3]=p,a[s+0]=i,a[s+1]=d,a[s+2]=i,a[s+3]=d,f[h+0]=C,f[h+1]=k,f[h+2]=O,f[h+3]=S,f[h+4]=C,f[h+5]=k,f[h+6]=O,f[h+7]=S,c[h+0]=0,c[h+4]=0,o[s+4]=O,o[s+5]=S,o[s+6]=O,o[s+7]=S,a[s+4]=i,a[s+5]=d,a[s+6]=i,a[s+7]=d,f[h+8]=w,f[h+9]=p,f[h+10]=y,f[h+11]=I,f[h+12]=w,f[h+13]=p,f[h+14]=y,f[h+15]=I,c[h+8]=T,c[h+12]=T,sn.toDash(T,i,b,m);for(var A=m.x,x=m.y,R=4*e,L=R+4*u;R<L;R+=4)c[R+1]=A,c[R+2]=x,c[R+3]=T},n.prototype.updateBarUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r;var e=this.toTextureUvs(i);t.uvBuffer.update();var u=t.uvs,s=2*this.vertexOffset;u[s+0]=e.x0,u[s+1]=e.y0,u[s+2]=e.x3,u[s+3]=e.y3,u[s+4]=e.x1,u[s+5]=e.y1,u[s+6]=e.x2,u[s+7]=e.y2}},n}(Xn),Jn=function(){function t(){}return t.create=function(t,n,i,r,e){var u=Wn.getTextCount(n,t.workCount),s=u.vertexCount,h=u.indexCount,o=4+s,a=2+h;return i+o<t.vertexCapacity&&r+a<t.indexCapacity?new Kn(t,i,r,s,h,o,a,e).init(n):null},t}(),Zn=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},qn=function(){function t(){}return t.toBaseFill=function(t,n){return(n.written&on.COLOR_FILL?t:n).fill},t.toBaseStroke=function(t,n){return(n.written&on.COLOR_STROKE?t:n).stroke},t.toBaseText=function(t,n){return(n.written&on.COLOR_TEXT?t:n).text},t.toBaseTextOutline=function(t,n){return(n.written&on.COLOR_TEXT_OUTLINE?t:n).text.outline},t}(),Qn=function(){function t(t){this.reset=t||on.NONE}return t.prototype.toExpression=function(t,n,i){if(t.trim().length<=0)return n;try{return Function("shape","time","try{ with( shape ) { return ("+t+"); } } catch( e ) { return "+i+"; }")}catch(t){return n}},t.prototype.emit=function(t,n,i,r){void 0===i?n.emit(t,n):void 0===r?n.emit(t,n,i):n.emit(t,n,i,r);var u=e.getLayer(n);if(u){var s=u.application;"shape"in s&&(void 0===i?s.shape.emit(t,n):void 0===r?s.shape.emit(t,n,i):s.shape.emit(t,n,i,r))}},t.prototype.execute=function(t,n,i){},t}(),$n=function(){return!0},ti=function(t){function n(n,i){var r=t.call(this,i)||this;return r.condition=r.toExpression(n.condition,$n,"true"),r}return i(n,t),n}(Qn),ni=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.interval=n.interval,r}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.interval,e=r<<1,u=i%e;u<r?(this.toOff(t,n),n.effect=i+(r-u)):(this.toOn(t,n),n.effect=i+(e-u))}},n.prototype.toOn=function(t,n){},n.prototype.toOff=function(t,n){},n}(ti),ii=function(t){function n(n){return t.call(this,n,on.COLOR)||this}return i(n,t),n.prototype.toOn=function(t,n){var i=qn.toBaseFill(t,n);t.fill.set(void 0,mn.brighten(i.color,.5),i.alpha);var r=qn.toBaseStroke(t,n);t.stroke.set(void 0,mn.brighten(r.color,.5),r.alpha);var e=qn.toBaseText(t,n);t.text.set(void 0,mn.brighten(e.color,.5),e.alpha);var u=qn.toBaseTextOutline(t,n);t.text.outline.set(void 0,mn.brighten(u.color,.5),u.alpha),n.written|=this.reset},n}(ni),ri=function(t){function n(n){var i=t.call(this,n,on.COLOR_FILL)||this;return i.color=n.color,i.alpha=n.alpha,i}return i(n,t),n.prototype.toOn=function(t,n){t.fill.set(void 0,this.color,this.alpha),n.written|=this.reset},n}(ni),ei=function(t){function n(n){var i=t.call(this,n,on.COLOR_STROKE)||this;return i.color=n.color,i.alpha=n.alpha,i}return i(n,t),n.prototype.toOn=function(t,n){t.stroke.set(void 0,this.color,this.alpha),n.written|=this.reset},n}(ni),ui=function(t){function n(n){return t.call(this,n,on.COLOR)||this}return i(n,t),n.prototype.toOn=function(t,n){var i=qn.toBaseFill(t,n);t.fill.set(void 0,mn.darken(i.color,.5),i.alpha);var r=qn.toBaseStroke(t,n);t.stroke.set(void 0,mn.darken(r.color,.5),r.alpha);var e=qn.toBaseText(t,n);t.text.set(void 0,mn.darken(e.color,.5),e.alpha);var u=qn.toBaseTextOutline(t,n);t.text.outline.set(void 0,mn.darken(u.color,.5),u.alpha),n.written|=this.reset},n}(ni),si=function(t){function n(n){return t.call(this,n,on.COLOR_FILL_AND_STROKE)||this}return i(n,t),n.prototype.toOn=function(t,n){var i=qn.toBaseFill(t,n);t.fill.set(void 0,i.color,.5*i.alpha);var r=qn.toBaseStroke(t,n);t.stroke.set(void 0,r.color,.5*r.alpha),n.written|=this.reset},n}(ni),hi=function(t){function n(n){return t.call(this,n,on.VISIBILITY)||this}return i(n,t),n.prototype.toOn=function(t,n){t.visible=!0,n.written|=this.reset},n.prototype.toOff=function(t,n){t.visible=!1,n.written|=this.reset},n}(ni);!function(t){t[t.VISIBILITY=0]="VISIBILITY",t[t.BRIGHTEN=1]="BRIGHTEN",t[t.DARKEN=2]="DARKEN",t[t.OPACITY=3]="OPACITY",t[t.COLOR_FILL=4]="COLOR_FILL",t[t.COLOR_STROKE=5]="COLOR_STROKE"}(Rn||(Rn={}));var oi,ai=function(){function t(t,n){this.type=t,this.condition=n}return t.prototype.isEquals=function(t){return this.type===t.type&&this.condition===t.condition},t.prototype.toLabel=function(){return L.getInstance().get("EShapeActionValue").toLabel(this)},t}(),fi=function(t){function n(n,i,r){var e=t.call(this,n,i)||this;return e.subtype=r,e}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.subtype===i.subtype},n}(ai);!function(t){t[t.SHOW_HIDE=0]="SHOW_HIDE",t[t.BLINK=1]="BLINK",t[t.TRANSFORM=2]="TRANSFORM",t[t.OPEN=3]="OPEN",t[t.EMIT_EVENT=4]="EMIT_EVENT",t[t.CHANGE_COLOR=5]="CHANGE_COLOR",t[t.CHANGE_TEXT=6]="CHANGE_TEXT",t[t.CHANGE_CURSOR=7]="CHANGE_CURSOR",t[t.MISC=8]="MISC"}(oi||(oi={}));var ci,li=function(){function t(){}return t.toResource=function(t,n,i){if(0<=t&&t<n.length){var r=n[t];if(c(r)&&0<=r&&r<i.length)return i[r]}return""},t}(),vi=function(t){function n(n,i,r,e,u){var s=t.call(this,oi.BLINK,i,n)||this;return s.interval=r,s.color=e,s.alpha=u,s}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.interval===i.interval&&this.color===i.color&&this.alpha===i.alpha},n.prototype.toRuntime=function(){switch(this.subtype){case Rn.BRIGHTEN:return new ii(this);case Rn.COLOR_FILL:return new ri(this);case Rn.COLOR_STROKE:return new ei(this);case Rn.DARKEN:return new ui(this);case Rn.OPACITY:return new si(this);case Rn.VISIBILITY:return new hi(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition);return t.add("["+this.type+","+n+","+this.subtype+","+this.interval+","+this.color+","+this.alpha+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources);return new n(t[2],r,t[3],t[4],t[5])},n}(fi),bi=function(){function t(){}return t.blend=function(t,n,i){var r=Math.max(0,Math.min(1,i));return Math.max(0,Math.min(1,t*(1-r)+n*r))},t}();!function(t){t[t.COLOR_AND_ALPHA=0]="COLOR_AND_ALPHA",t[t.COLOR=1]="COLOR",t[t.ALPHA=2]="ALPHA",t[t.CODE=3]="CODE",t[t.BRIGHTNESS=4]="BRIGHTNESS"}(ci||(ci={}));var gi,di=function(){return null},mi=function(t){function n(n,i){var r=t.call(this,n,i)||this;switch(n.target){case ci.COLOR:r.color=n.color,r.alpha=void 0;break;case ci.ALPHA:r.color=void 0,r.alpha=n.alpha;break;default:r.color=n.color,r.alpha=n.alpha}return r.blend=r.toExpression(n.blend,di,"null"),r}return i(n,t),n.prototype.set=function(t,n,i,r,e){var u=this.color,s=this.alpha;if(null!=u)null!=s?null!=(h=this.blend(t,i))?r.set(void 0,mn.blend(e.color,u,h),bi.blend(e.alpha,s,h)):r.set(void 0,u,s):null!=(h=this.blend(t,i))?r.set(void 0,mn.blend(e.color,u,h),e.alpha):r.set(void 0,u,e.alpha),n.written|=this.reset;else if(null!=s){var h;null!=(h=this.blend(t,i))?r.set(void 0,e.color,bi.blend(e.alpha,s,h)):r.set(void 0,e.color,s),n.written|=this.reset}},n.prototype.sets=function(t,n,i,r,e,u,s){var h=this.color,o=this.alpha;if(null!=h)null!=o?null!=(a=this.blend(t,i))?(r.set(void 0,mn.blend(u.color,h,a),bi.blend(u.alpha,o,a)),e.set(void 0,mn.blend(s.color,h,a),bi.blend(s.alpha,o,a))):(r.set(void 0,h,o),e.set(void 0,h,o)):null!=(a=this.blend(t,i))?(r.set(void 0,mn.blend(u.color,h,a),u.alpha),e.set(void 0,mn.blend(s.color,h,a),s.alpha)):(r.set(void 0,h,u.alpha),e.set(void 0,h,s.alpha)),n.written|=this.reset;else if(null!=o){var a;null!=(a=this.blend(t,i))?(r.set(void 0,u.color,bi.blend(u.alpha,o,a)),e.set(void 0,s.color,bi.blend(s.alpha,o,a))):(r.set(void 0,u.color,o),e.set(void 0,s.color,o)),n.written|=this.reset}},n.prototype.setAll=function(t,n,i,r,e,u,s,h,o,a,f){var c=this.color,l=this.alpha;if(null!=c)null!=l?null!=(v=this.blend(t,i))?(r.set(void 0,mn.blend(h.color,c,v),bi.blend(h.alpha,l,v)),e.set(void 0,mn.blend(o.color,c,v),bi.blend(o.alpha,l,v)),u.set(void 0,mn.blend(a.color,c,v),bi.blend(a.alpha,l,v)),s.set(void 0,mn.blend(f.color,c,v),bi.blend(f.alpha,l,v))):(r.set(void 0,c,l),e.set(void 0,c,l),u.set(void 0,c,l),s.set(void 0,c,l)):null!=(v=this.blend(t,i))?(r.set(void 0,mn.blend(h.color,c,v),h.alpha),e.set(void 0,mn.blend(o.color,c,v),o.alpha),u.set(void 0,mn.blend(a.color,c,v),a.alpha),s.set(void 0,mn.blend(f.color,c,v),f.alpha)):(r.set(void 0,c,h.alpha),e.set(void 0,c,o.alpha),u.set(void 0,c,a.alpha),s.set(void 0,c,f.alpha)),n.written|=this.reset;else if(null!=l){var v;null!=(v=this.blend(t,i))?(r.set(void 0,h.color,bi.blend(h.alpha,l,v)),e.set(void 0,o.color,bi.blend(o.alpha,l,v)),u.set(void 0,h.color,bi.blend(a.alpha,l,v)),s.set(void 0,o.color,bi.blend(f.alpha,l,v))):(r.set(void 0,h.color,l),e.set(void 0,o.color,l),u.set(void 0,a.color,l),s.set(void 0,f.color,l)),n.written|=this.reset}},n}(ti),wi=function(t){function n(n){return t.call(this,n,on.COLOR)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.setAll(t,n,i,t.fill,t.stroke,t.text,t.text.outline,qn.toBaseFill(t,n),qn.toBaseStroke(t,n),qn.toBaseText(t,n),qn.toBaseTextOutline(t,n))},n}(mi),pi=function(t){function n(n){return t.call(this,n,on.COLOR_FILL)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.fill,qn.toBaseFill(t,n))},n}(mi),Di=function(t){function n(n){return t.call(this,n,on.COLOR_FILL_AND_STROKE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.sets(t,n,i,t.fill,t.stroke,qn.toBaseFill(t,n),qn.toBaseStroke(t,n))},n}(mi),Oi=function(t){function n(n){return t.call(this,n,on.COLOR_STROKE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.stroke,qn.toBaseStroke(t,n))},n}(mi),Si=function(t){function n(n){return t.call(this,n,on.COLOR_TEXT)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.text,qn.toBaseText(t,n))},n}(mi),Mi=function(t){function n(n){return t.call(this,n,on.COLOR_TEXT_OUTLINE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.text.outline,qn.toBaseTextOutline(t,n))},n}(mi);!function(t){t[t.FILL=0]="FILL",t[t.STROKE=1]="STROKE",t[t.FILL_AND_STROKE=2]="FILL_AND_STROKE",t[t.TEXT=3]="TEXT",t[t.TEXT_OUTLINE=4]="TEXT_OUTLINE",t[t.ALL=5]="ALL"}(gi||(gi={}));var Ei,Ni=function(t){function n(n,i,r,e,u,s){var h=t.call(this,oi.CHANGE_COLOR,i,n)||this;return h.target=r,h.color=e,h.alpha=u,h.blend=s,h}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.target===i.target&&this.color===i.color&&this.alpha===i.alpha&&this.blend===i.blend},n.prototype.toRuntime=function(){switch(this.subtype){case gi.FILL:return new pi(this);case gi.STROKE:return new Oi(this);case gi.FILL_AND_STROKE:return new Di(this);case gi.TEXT:return new Si(this);case gi.TEXT_OUTLINE:return new Mi(this);case gi.ALL:return new wi(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.blend);return t.add("["+this.type+","+n+","+this.subtype+","+this.target+","+this.color+","+this.alpha+","+i+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(6,t,i.resources);return new n(t[2],r,t[3],t[4],t[5],e)},n}(fi),Ti=function(){return null},ji=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.brightness=r.toExpression(n.brightness,Ti,"null"),r}return i(n,t),n.prototype.set=function(t,n,i,r,e){var u=this.brightness(t,i);null!=u&&(r.set(void 0,this.toColorAdjusted(e.color,u),e.alpha),n.written|=this.reset)},n.prototype.sets=function(t,n,i,r,e,u,s){var h=this.brightness(t,i);null!=h&&(r.set(void 0,this.toColorAdjusted(u.color,h),u.alpha),e.set(void 0,this.toColorAdjusted(s.color,h),s.alpha),n.written|=this.reset)},n.prototype.setAll=function(t,n,i,r,e,u,s,h,o,a,f){var c=this.brightness(t,i);null!=c&&(r.set(void 0,this.toColorAdjusted(h.color,c),h.alpha),e.set(void 0,this.toColorAdjusted(o.color,c),o.alpha),u.set(void 0,this.toColorAdjusted(a.color,c),a.alpha),s.set(void 0,this.toColorAdjusted(f.color,c),f.alpha),n.written|=this.reset)},n.prototype.toColorAdjusted=function(t,n){return 0<=n?mn.brighten(t,+n):mn.darken(t,-n)},n}(ti),Ci=function(t){function n(n){return t.call(this,n,on.COLOR)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.setAll(t,n,i,t.fill,t.stroke,t.text,t.text.outline,qn.toBaseFill(t,n),qn.toBaseStroke(t,n),qn.toBaseText(t,n),qn.toBaseTextOutline(t,n))},n}(ji),ki=function(t){function n(n){return t.call(this,n,on.COLOR_FILL)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.fill,qn.toBaseFill(t,n))},n}(ji),yi=function(t){function n(n){return t.call(this,n,on.COLOR_FILL_AND_STROKE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.sets(t,n,i,t.fill,t.stroke,qn.toBaseFill(t,n),qn.toBaseStroke(t,n))},n}(ji),Ii=function(t){function n(n){return t.call(this,n,on.COLOR_STROKE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.stroke,qn.toBaseStroke(t,n))},n}(ji),Ai=function(t){function n(n){return t.call(this,n,on.COLOR_TEXT)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.text,qn.toBaseText(t,n))},n}(ji),xi=function(t){function n(n){return t.call(this,n,on.COLOR_TEXT_OUTLINE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.text.outline,qn.toBaseTextOutline(t,n))},n}(ji),Ri=function(t){function n(n,i,r){var e=t.call(this,oi.CHANGE_COLOR,i,n)||this;return e.brightness=r,e}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.brightness===i.brightness},n.prototype.toRuntime=function(){switch(this.subtype){case gi.FILL:return new ki(this);case gi.STROKE:return new Ii(this);case gi.FILL_AND_STROKE:return new yi(this);case gi.TEXT:return new Ai(this);case gi.TEXT_OUTLINE:return new xi(this);case gi.ALL:return new Ci(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=ci.BRIGHTNESS,r=t.add(this.brightness);return t.add("["+this.type+","+n+","+this.subtype+","+i+","+r+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(4,t,i.resources);return new n(t[2],r,e)},n}(fi),Li=function(){return null},Bi=function(){return null},Pi=function(){return null},Fi=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.color=r.toExpression(n.color,Li,"null"),r.alpha=r.toExpression(n.alpha,Bi,"null"),r.blend=r.toExpression(n.blend,Pi,"null"),r}return i(n,t),n.prototype.set=function(t,n,i,r,e){var u=this.color(t,i),s=this.alpha(t,i);if(null!=u)null!=s?null!=(h=this.blend(t,i))?r.set(void 0,mn.blend(e.color,u,h),bi.blend(e.alpha,s,h)):r.set(void 0,u,s):null!=(h=this.blend(t,i))?r.set(void 0,mn.blend(e.color,u,h),e.alpha):r.set(void 0,u,e.alpha),n.written|=this.reset;else if(null!=s){var h;null!=(h=this.blend(t,i))?r.set(void 0,e.color,bi.blend(e.alpha,s,h)):r.set(void 0,e.color,s),n.written|=this.reset}},n.prototype.sets=function(t,n,i,r,e,u,s){var h=this.color(t,i),o=this.alpha(t,i);if(null!=h)null!=o?null!=(a=this.blend(t,i))?(r.set(void 0,mn.blend(u.color,h,a),bi.blend(u.alpha,o,a)),e.set(void 0,mn.blend(s.color,h,a),bi.blend(s.alpha,o,a))):(r.set(void 0,h,o),e.set(void 0,h,o)):null!=(a=this.blend(t,i))?(r.set(void 0,mn.blend(u.color,h,a),u.alpha),e.set(void 0,mn.blend(s.color,h,a),s.alpha)):(r.set(void 0,h,u.alpha),e.set(void 0,h,s.alpha)),n.written|=this.reset;else if(null!=o){var a;null!=(a=this.blend(t,i))?(r.set(void 0,u.color,bi.blend(u.alpha,o,a)),e.set(void 0,s.color,bi.blend(s.alpha,o,a))):(r.set(void 0,u.color,o),e.set(void 0,s.color,o)),n.written|=this.reset}},n.prototype.setAll=function(t,n,i,r,e,u,s,h,o,a,f){var c=this.color(t,i),l=this.alpha(t,i);if(null!=c)null!=l?null!=(v=this.blend(t,i))?(r.set(void 0,mn.blend(h.color,c,v),bi.blend(h.alpha,l,v)),e.set(void 0,mn.blend(o.color,c,v),bi.blend(o.alpha,l,v)),u.set(void 0,mn.blend(a.color,c,v),bi.blend(a.alpha,l,v)),s.set(void 0,mn.blend(f.color,c,v),bi.blend(f.alpha,l,v))):(r.set(void 0,c,l),e.set(void 0,c,l),u.set(void 0,c,l),s.set(void 0,c,l)):null!=(v=this.blend(t,i))?(r.set(void 0,mn.blend(h.color,c,v),h.alpha),e.set(void 0,mn.blend(o.color,c,v),o.alpha),u.set(void 0,mn.blend(a.color,c,v),a.alpha),s.set(void 0,mn.blend(f.color,c,v),f.alpha)):(r.set(void 0,c,h.alpha),e.set(void 0,c,o.alpha),u.set(void 0,c,a.alpha),s.set(void 0,c,f.alpha)),n.written|=this.reset;else if(null!=l){var v;null!=(v=this.blend(t,i))?(r.set(void 0,h.color,bi.blend(h.alpha,l,v)),e.set(void 0,o.color,bi.blend(o.alpha,l,v)),u.set(void 0,h.color,bi.blend(a.alpha,l,v)),s.set(void 0,o.color,bi.blend(f.alpha,l,v))):(r.set(void 0,h.color,l),e.set(void 0,o.color,l),u.set(void 0,a.color,l),s.set(void 0,f.color,l)),n.written|=this.reset}},n}(ti),_i=function(t){function n(n){return t.call(this,n,on.COLOR)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.setAll(t,n,i,t.fill,t.stroke,t.text,t.text.outline,qn.toBaseFill(t,n),qn.toBaseStroke(t,n),qn.toBaseText(t,n),qn.toBaseTextOutline(t,n))},n}(Fi),Ui=function(t){function n(n){return t.call(this,n,on.COLOR_FILL)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.fill,qn.toBaseFill(t,n))},n}(Fi),zi=function(t){function n(n){return t.call(this,n,on.COLOR_FILL_AND_STROKE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.sets(t,n,i,t.fill,t.stroke,qn.toBaseFill(t,n),qn.toBaseStroke(t,n))},n}(Fi),Gi=function(t){function n(n){return t.call(this,n,on.COLOR_STROKE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.stroke,qn.toBaseStroke(t,n))},n}(Fi),Hi=function(t){function n(n){return t.call(this,n,on.COLOR_TEXT)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.text,qn.toBaseText(t,n))},n}(Fi),Vi=function(t){function n(n){return t.call(this,n,on.COLOR_TEXT_OUTLINE)||this}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&this.set(t,n,i,t.text.outline,qn.toBaseTextOutline(t,n))},n}(Fi),Wi=function(t){function n(n,i,r,e,u){var s=t.call(this,oi.CHANGE_COLOR,i,n)||this;return s.color=r,s.alpha=e,s.blend=u,s}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.color===i.color&&this.alpha===i.alpha&&this.blend===i.blend},n.prototype.toRuntime=function(){switch(this.subtype){case gi.FILL:return new Ui(this);case gi.STROKE:return new Gi(this);case gi.FILL_AND_STROKE:return new zi(this);case gi.TEXT:return new Hi(this);case gi.TEXT_OUTLINE:return new Vi(this);case gi.ALL:return new _i(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=ci.CODE,r=t.add(this.color),e=t.add(this.alpha),u=t.add(this.blend);return t.add("["+this.type+","+n+","+this.subtype+","+i+","+r+","+e+","+u+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(4,t,i.resources),u=li.toResource(5,t,i.resources),s=li.toResource(6,t,i.resources);return new n(t[2],r,e,u,s)},n}(fi),Yi=function(){return null},Xi=function(t){function n(n){var i=t.call(this,n,on.CURSOR)||this;return i.name=i.toExpression(n.name,Yi,"null"),i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.name(t,i);null!=r&&(t.cursor=r,n.written|=this.reset)}},n}(ti),Ki=function(t){function n(n,i){var r=t.call(this,oi.CHANGE_CURSOR,n)||this;return r.name=i,r}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.name===i.name},n.prototype.toRuntime=function(){return new Xi(this)},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.name);return t.add("["+this.type+","+n+","+i+"]")},n.deserialize=function(t,i){return new n(li.toResource(1,t,i.resources),li.toResource(2,t,i.resources))},n}(ai),Ji=function(){function t(){}return t.prototype.format=function(t,n,i){return i.getHours()<12?"AM":"PM"},t}(),Zi=function(){function t(){}return t.prototype.format=function(t,n,i){return i.getHours()<12?"am":"pm"},t}(),qi=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getDate())},t}(),Qi=function(){function t(){}return t.prototype.format=function(t,n,i){return""+(0|t)},t}(),$i=function(t){this.precision=null!=t?+t.substring(1,t.length):void 0},tr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.format=function(t,n,i){return t.toExponential(this.precision)},n}($i),nr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.format=function(t,n,i){return t.toFixed(this.precision)},n}($i),ir=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.format=function(t,n,i){var r=this.toAbs(t,n,i);return r<1e-24?this.wi(t,1,""):r<1e-21?this.wi(t,1e24,"y"):r<1e-18?this.wi(t,1e21,"z"):r<1e-15?this.wi(t,1e18,"a"):r<1e-12?this.wi(t,1e15,"f"):r<1e-9?this.wi(t,1e12,"p"):r<1e-6?this.wi(t,1e9,"n"):r<.001?this.wi(t,1e6,""):r<1?this.wi(t,1e3,"m"):r<1e3?this.wi(t,1,""):r<1e6?this.wi(t,.001,"k"):r<1e9?this.wi(t,1e-6,"M"):r<1e12?this.wi(t,1e-9,"G"):r<1e15?this.wi(t,1e-12,"T"):r<1e18?this.wi(t,1e-15,"P"):r<1e21?this.wi(t,1e-18,"E"):r<1e24?this.wi(t,1e-21,"Z"):this.wi(t,1e-24,"Y")},n.prototype.toAbs=function(t,n,i){return Math.abs(t)},n.prototype.wi=function(t,n,i){return""+(t*n).toFixed(this.precision)+i},n}($i),rr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.format=function(t,n,i){return t.toPrecision(this.precision)},n}($i),er=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getHours())},t}(),ur=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getHours()%12)},t}(),sr=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getMonth()+1)},t}(),hr=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getMinutes())},t}(),or=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getMilliseconds())},t}(),ar=function(){function t(){}return t.prototype.format=function(t,n,i){return(100*t|0)+"%"},t}(),fr=function(){function t(){}return t.prototype.format=function(t,n,i){return(0|t)+"%"},t}(),cr=function(){function t(t,n,i){this.length=t,this.character=n,this.node=i}return t.prototype.format=function(t,n,i){return dn(this.node.format(t,n,i),this.length,this.character)},t}(),lr=function(){function t(t){this.node=t}return t.prototype.format=function(t,n,i){var r=this.node.format(t,n,i);return 0<r.length&&"-"===r[0]?"("+r.substring(1,r.length)+")":r},t}(),vr=function(){function t(t){this.node=t}return t.prototype.format=function(t,n,i){var r=this.node.format(t,n,i);return 0<r.length&&"-"!==r[0]?"+"+r:r},t}(),br=function(){function t(){}return t.prototype.format=function(t,n,i){return Math.round(100*t)+"%"},t}(),gr=function(){function t(){}return t.prototype.format=function(t,n,i){return Math.round(t)+"%"},t}(),dr=function(){function t(t,n,i,r,e,u,s){this.Y=t,this.M=n,this.D=i,this.H=r,this.m=e,this.s=u,this.mi=s}return t.prototype.format=function(t,n,i){return n<1e3?this.s.format(t,n,i)+"."+this.mi.format(t,n,i):n<6e4?this.m.format(t,n,i)+":"+this.s.format(t,n,i):n<36e5?this.H.format(t,n,i)+":"+this.m.format(t,n,i):n<864e5?this.M.format(t,n,i)+"/"+this.D.format(t,n,i)+" "+this.H.format(t,n,i):n<2592e6?this.M.format(t,n,i)+"/"+this.D.format(t,n,i):this.Y.format(t,n,i)+"/"+this.M.format(t,n,i)},t}(),mr=function(){function t(t){this.node=t}return t.prototype.format=function(t,n,i){var r=this.node.format(t,n,i);return 0<r.length&&"-"!==r[0]?" "+r:r},t}(),wr=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.toAbs=function(t,n,i){return Math.abs(n)},n}(ir),pr=function(){function t(t){this.str=t}return t.prototype.format=function(t,n,i){return this.str},t}(),Dr=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getFullYear())},t}(),Or=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getFullYear()%100)},t}(),Sr=function(){function t(){}return t.prototype.format=function(t,n,i){var r=i.getTimezoneOffset();return(r<=0?"+":"-")+dn(String(Math.floor(Math.abs(r)/60)),2,"0")+":"+dn(String(Math.floor(Math.abs(r)%60)),2,"0")},t}(),Mr=function(){function t(){}return t.prototype.format=function(t,n,i){return""+Math.round(t)},t}(),Er=function(){function t(){}return t.prototype.format=function(t,n,i){return String(i.getSeconds())},t}(),Nr=/%(0|_|-|\+|\()?(\.\d+)?(Y(?:MD?)?|y(?:MD?)?|MD?|D|H(?:ms?)?|h(?:ms?)?|m(?:i|s)?|a|A|s(?:s?i|dt)?|z|%|f(?:si)?|e|g|d|r(?:d|p)|p|P|RP)/g,Tr=function(){function t(t){var n=0,i=!1,r=[];for(Nr.lastIndex=0;;){var e=Nr.exec(t);if(null==e){n<t.length&&r.push(new pr(t.substring(n,t.length)));break}var u=e.index;n<u&&r.push(new pr(t.substring(n,u))),n=u+e[0].length;var s=e[0],h=e[1],o=e[2];switch(e[3]){case"Y":i=!0,r.push(new Dr);break;case"YM":i=!0,r.push(new Dr,new pr("/"),this.toModifiedNodeDatetime2(h,new sr));break;case"YMD":i=!0,r.push(new Dr,new pr("/"),this.toModifiedNodeDatetime2(h,new sr),new pr("/"),this.toModifiedNodeDatetime2(h,new qi));break;case"y":i=!0,r.push(this.toModifiedNodeDatetime2(h,new Or));break;case"yM":i=!0,r.push(this.toModifiedNodeDatetime2(h,new Or),new pr("/"),this.toModifiedNodeDatetime2(h,new sr));break;case"yMD":r.push(this.toModifiedNodeDatetime2(h,new Or),new pr("/"),this.toModifiedNodeDatetime2(h,new sr),new pr("/"),this.toModifiedNodeDatetime2(h,new qi));break;case"M":i=!0,r.push(this.toModifiedNodeDatetime2(h,new sr));break;case"MD":i=!0,r.push(this.toModifiedNodeDatetime2(h,new sr),new pr("/"),this.toModifiedNodeDatetime2(h,new qi));break;case"D":i=!0,r.push(this.toModifiedNodeDatetime2(h,new qi));break;case"H":i=!0,r.push(this.toModifiedNodeDatetime2(h,new er));break;case"Hm":i=!0,r.push(this.toModifiedNodeDatetime2(h,new er),new pr(":"),this.toModifiedNodeDatetime2(h,new hr));break;case"Hms":i=!0,r.push(this.toModifiedNodeDatetime2(h,new er),new pr(":"),this.toModifiedNodeDatetime2(h,new hr),new pr(":"),this.toModifiedNodeDatetime2(h,new Er));break;case"h":i=!0,r.push(this.toModifiedNodeDatetime2(h,new ur));break;case"hm":i=!0,r.push(this.toModifiedNodeDatetime2(h,new ur),new pr(":"),this.toModifiedNodeDatetime2(h,new hr));break;case"hms":i=!0,r.push(this.toModifiedNodeDatetime2(h,new ur),new pr(":"),this.toModifiedNodeDatetime2(h,new hr),new pr(":"),this.toModifiedNodeDatetime2(h,new Er));break;case"m":i=!0,r.push(this.toModifiedNodeDatetime2(h,new hr));break;case"ms":i=!0,r.push(this.toModifiedNodeDatetime2(h,new hr),new pr(":"),this.toModifiedNodeDatetime2(h,new Er));break;case"mi":i=!0,r.push(this.toModifiedNodeDatetime3(h,new or));break;case"a":i=!0,r.push(new Zi);break;case"A":i=!0,r.push(new Ji);break;case"s":i=!0,r.push(this.toModifiedNodeDatetime2(h,new Er));break;case"sdt":i=!0,r.push(new dr(new Dr,this.toModifiedNodeDatetime2(h,new sr),this.toModifiedNodeDatetime2(h,new qi),this.toModifiedNodeDatetime2(h,new er),this.toModifiedNodeDatetime2(h,new hr),this.toModifiedNodeDatetime2(h,new Er),this.toModifiedNodeDatetime3(h,new or)));break;case"z":i=!0,r.push(new Sr);break;case"%":r.push(new pr("%"));break;case"f":r.push(this.toModifiedNodeNumber(h,new nr(o)));break;case"e":r.push(this.toModifiedNodeNumber(h,new tr(o)));break;case"g":r.push(this.toModifiedNodeNumber(h,new rr(o)));break;case"rd":r.push(this.toModifiedNodeNumber(h,new Mr));break;case"d":r.push(this.toModifiedNodeNumber(h,new Qi));break;case"P":r.push(this.toModifiedNodeNumber(h,new ar));break;case"p":r.push(this.toModifiedNodeNumber(h,new fr));break;case"RP":r.push(this.toModifiedNodeNumber(h,new br));break;case"rp":r.push(this.toModifiedNodeNumber(h,new gr));break;case"fsi":r.push(this.toModifiedNodeNumber(h,new ir(o)));break;case"ssi":r.push(this.toModifiedNodeNumber(h,new wr(o)));break;default:r.push(new pr(s))}}this.isDateRequired=i,this.nodes=r,this.date=new Date}return t.prototype.toModifiedNodeDatetime2=function(t,n){switch(t){case"_":return new cr(2," ",n);case"-":return n;default:return new cr(2,"0",n)}},t.prototype.toModifiedNodeDatetime3=function(t,n){switch(t){case"_":return new cr(3," ",n);case"-":return n;default:return new cr(3,"0",n)}},t.prototype.toModifiedNodeNumber=function(t,n){switch(t){case"_":return new mr(n);case"+":return new vr(n);case"(":return new lr(n);default:return n}},t.prototype.format=function(t,n){var i=this.nodes,r=this.date;this.isDateRequired&&r.setTime(t);for(var e="",u=0,s=i.length;u<s;++u)e+=i[u].format(t,n,r);return e},t}(),jr=function(){function t(){}return t.create=function(t){return new Tr(t)},t}(),Cr=function(){return 0},kr=function(t){function n(n,i){var r=t.call(this,n,on.TEXT)||this;return r.number=r.toExpression(n.value,Cr,"0"),i=i.trim(),r.formatter=0<i.length?jr.create(i):null,r}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.number(t,i);t.text.value=null!=this.formatter?this.formatter.format(r,0):String(r),n.written|=this.reset}},n}(ti),yr=function(){return""},Ir=function(t){function n(n){var i=t.call(this,n,on.TEXT)||this;return i.text=i.toExpression(n.value,yr,'""'),i}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&(t.text.value=String(this.text(t,i)),n.written|=this.reset)},n}(ti);!function(t){t[t.TEXT=0]="TEXT",t[t.NUMBER=1]="NUMBER"}(Ei||(Ei={}));var Ar,xr=function(t){function n(n,i,r){var e=t.call(this,oi.CHANGE_TEXT,i,n)||this;return e.value=r,e}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.value===i.value},n.prototype.toRuntime=function(t){switch(this.subtype){case Ei.TEXT:return new Ir(this);case Ei.NUMBER:return new kr(this,t.text.value)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.value);return t.add("["+this.type+","+n+","+this.subtype+","+i+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(3,t,i.resources);return new n(t[2],r,e)},n}(fi),Rr=function(){return null},Lr=function(t){function n(n){var i=t.call(this,n,on.NONE)||this;return i.name=i.toExpression(n.name,Rr,"null"),i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.name(t,i);null!=r&&this.emit(r,t)}},n}(ti),Br=function(t){function n(n,i){var r=t.call(this,oi.EMIT_EVENT,n)||this;return r.name=i,r}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.name===i.name},n.prototype.toRuntime=function(){return new Lr(this)},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.name);return t.add("["+this.type+","+n+","+i+"]")},n.deserialize=function(t,i){return new n(li.toResource(1,t,i.resources),li.toResource(2,t,i.resources))},n}(ai),Pr=" !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_`abcdefghijklmnopqrstuvwxyz{|}~",Fr=function(t,n){this.x=t,this.y=n},_r=function(t,n,i,r){this.ref=1,this.life=10,this.x=0,this.y=0,this.width=n,this.height=i,this.advance=t,this.origin=new Fr(0,0),this.reserved=r},Ur=function(){function t(){var t=this;this.pi=null,this.A=null,this.Di=null,this.Oi=NaN,this.Si=NaN,this.Mi=NaN,this.Ei=NaN,this.Ni=null,this.Ti=null;var n=this.ji=document.createElement("canvas");n.width=64,n.height=64,this.Ci=function(t){t.preventDefault()},this.ki=function(){t.restore()},this.yi=function(){t.destroy()},n.addEventListener("webglcontextlost",this.Ci,!1),n.addEventListener("webglcontextrestored",this.ki,!1),window.addEventListener("unload",this.yi,!1)}return t.prototype.init=function(){var t=this.ji;if(null!=t&&(null==this.pi||this.pi.isContextLost())){var n={alpha:!0,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1},i=this.pi=t.getContext("webgl",n)||t.getContext("experimental-webgl",n);null!=i&&(i.clearColor(1,1,1,0),this.makeVertexBuffer(),this.makeUvBuffer(),this.makeShaders(),this.A=null)}return this},t.prototype.restore=function(){this.init()},t.prototype.getCanvas=function(){return this.ji},t.prototype.getShader=function(t,n,i){var r=i?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);return null==r||(t.shaderSource(r,n),t.compileShader(r),t.getShaderParameter(r,t.COMPILE_STATUS))?r:(console&&console.error("Failed to compile the shader: "+t.getShaderInfoLog(r)),null)},t.prototype.makeShaders=function(){var t=this.pi;if(null!=t&&!0!==t.isContextLost()){var n=this.getShader(t,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nvarying mediump vec2 vTextureCoord;\nvoid main(void) {\n\tgl_Position = vec4(aVertexPosition, 0.0, 1.0);\n\tvTextureCoord = aTextureCoord;\n}\n",!1);if(null!=n){var i=this.getShader(t,"\nprecision mediump float;\n\nvarying mediump vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uSize;\n\nfloat calcDistance( float x, float y, float dx, float dy ) {\n\tfloat xd = x + dx;\n\tfloat yd = y + dy;\n\tfloat u = xd / uSize.x;\n\tfloat v = yd / uSize.y;\n\tfloat ul = (xd - 1.0) / uSize.x;\n\tfloat vt = (yd - 1.0) / uSize.y;\n\n\tfloat m = texture2D(uSampler, vec2(u , v )).a;\n\tfloat l = texture2D(uSampler, vec2(ul, v )).a;\n\tfloat t = texture2D(uSampler, vec2(u , vt)).a;\n\n\tfloat xl = mix( xd - 1.0, xd, (0.5 - l) / (m - l) );\n\tfloat yt = mix( yd - 1.0, yd, (0.5 - t) / (m - t) );\n\n\tbool bl = ( min(l, m) < 0.5 && 0.5 <= max(l, m) );\n\tbool bt = ( min(t, m) < 0.5 && 0.5 <= max(t, m) );\n\n\tfloat ll = (bl ? length( vec2( xl - x, yd - y ) ) : 100.0);\n\tfloat lt = (bt ? length( vec2( xd - x, yt - y ) ) : 100.0);\n\n\treturn min( ll, lt );\n}\n\nfloat calcDistancesY( float x, float y, float dx ) {\n\tfloat d = 100.0;\n\tfor( float dy=-6.0; dy<6.5; dy++ ) {\n\t\td = min( d, calcDistance( x, y, dx, dy ) );\n\t}\n\treturn d;\n}\n\nfloat calcDistances( float x, float y ) {\n\tfloat d = 100.0;\n\tfor( float dx=-6.0; dx<6.5; dx++ ) {\n\t\td = min( d, calcDistancesY( x, y, dx ) );\n\t}\n\treturn d;\n}\n\nvoid main(void) {\n\tfloat t = texture2D(uSampler, vTextureCoord).a;\n\tfloat x = vTextureCoord.x * uSize.x;\n\tfloat y = vTextureCoord.y * uSize.y;\n\tfloat d = min( 6.0, calcDistances( x, y ) ) / 12.0;\n\td = clamp( mix( 0.5 - d, 0.5 + d, step( 0.5, t ) ), 0.0, 1.0 );\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, d);\n}\n",!0);if(null!=i){var r=this.Di=t.createProgram();if(null!=r)return t.attachShader(r,n),t.attachShader(r,i),t.linkProgram(r),t.getProgramParameter(r,t.LINK_STATUS)?(t.deleteShader(n),t.deleteShader(i),t.useProgram(r),this.Oi=t.getAttribLocation(r,"aVertexPosition"),this.Si=t.getAttribLocation(r,"aTextureCoord"),this.Mi=t.getUniformLocation(r,"uSampler"),this.Ei=t.getUniformLocation(r,"uSize"),t.useProgram(null),r):(console&&console.error("Failed to link the program: "+t.getError()),t.deleteShader(n),t.deleteShader(i),null);t.deleteShader(n),t.deleteShader(i)}else t.deleteShader(n)}}return null},t.prototype.destroyShaders=function(){var t=this.pi;if(null!=t&&!0!==t.isContextLost()){var n=this.Di;null!=n&&(this.Di=null,t.useProgram(null),t.deleteProgram(n))}},t.prototype.updateTexture=function(t){var n=this.pi,i=this.ji;if(null!=n&&!0!==n.isContextLost()&&null!=i){var r=t.width,e=t.height;i.width===r&&i.height===e||(i.width=r,i.height=e,n.viewport(0,0,r,e));var u=this.A;return null==u?(u=this.A=n.createTexture(),n.bindTexture(n.TEXTURE_2D,u),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MAG_FILTER,n.NEAREST),n.texParameteri(n.TEXTURE_2D,n.TEXTURE_MIN_FILTER,n.NEAREST),n.bindTexture(n.TEXTURE_2D,null)):(n.bindTexture(n.TEXTURE_2D,u),n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t),n.bindTexture(n.TEXTURE_2D,null)),u}return null},t.prototype.destroyTexture=function(){var t=this.pi,n=this.A;null!=t&&!0!==t.isContextLost()&&null!=n&&(this.A=null,t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(n))},t.prototype.makeVertexBuffer=function(){var t=this.pi;if(null!=t&&!0!==t.isContextLost()){var n=this.Ni=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,1,1,1,-1,-1,1,-1]),t.STATIC_DRAW),n}return null},t.prototype.destroyVertexBuffer=function(){var t=this.pi,n=this.Ni;null!=t&&!0!==t.isContextLost()&&null!=n&&(this.Ni=null,t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(n))},t.prototype.makeUvBuffer=function(){var t=this.pi;if(null!=t&&!0!==t.isContextLost()){var n=this.Ti=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,n),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW),n}return null},t.prototype.destroyUvBuffer=function(){var t=this.pi,n=this.Ti;null!=t&&!0!==t.isContextLost()&&null!=n&&(this.Ti=null,t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(n))},t.prototype.render=function(){var t=this.pi,n=this.ji,i=this.Di,r=this.Ni,e=this.Ti,u=this.A;if(null!=t&&!0!==t.isContextLost()&&null!=n&&null!=i&&null!=r&&null!=e&&null!=u){t.clear(t.COLOR_BUFFER_BIT),t.useProgram(i),t.bindBuffer(t.ARRAY_BUFFER,r);var s=this.Oi;t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,e);var h=this.Si;t.enableVertexAttribArray(h),t.vertexAttribPointer(h,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,u),t.uniform1i(this.Mi,0),t.uniform2f(this.Ei,n.width,n.height),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.bindTexture(t.TEXTURE_2D,null),t.bindBuffer(t.ARRAY_BUFFER,null),t.useProgram(null)}},t.prototype.read=function(t){var n=this.pi,i=this.ji;if(null!=n&&!0!==n.isContextLost()&&null!=i){var r=i.width,e=i.height;t.width=r,t.height=e;var u=t.getContext("2d");null!=u&&u.drawImage(i,0,0)}},t.prototype.destroy=function(){this.destroyVertexBuffer(),this.destroyUvBuffer(),this.destroyShaders();var t=this.ji;null!=t&&(this.ji=null,t.removeEventListener("webglcontextlost",this.Ci,!1),t.removeEventListener("webglcontextrestored",this.ki,!1),window.removeEventListener("unload",this.yi,!1));var n=this.pi;if(null!=n){this.pi=null;var i=n.getExtension("WEBGL_lose_context");null!=i&&i.loseContext()}},t}(),zr=function(){function t(n){this.xt="font-atlas:"+n,this.Ii=t.getGenerator().init(),this.ji=document.createElement("canvas"),this.Ai={family:t.toFontFamily(n),size:32,italic:!1},this.xi={},this.Ri=0,this.l=1,this.I=1,this.B=!0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this.Ai},set:function(t){this.Ai.family=t.family,this.Ai.size=t.size,this.Ai.italic=t.italic},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this.l},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this.I},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this.ji},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"generator",{get:function(){return this.Ii},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"characters",{get:function(){return this.xi},enumerable:!0,configurable:!0}),t.prototype.begin=function(){this.Ri=0;var t=this.xi;for(var n in t)t[n].ref=0},t.prototype.end=function(){var t=this.xi;for(var n in t){var i=t[n];i.ref<=0&&(i.life-=1,i.life<=0&&(delete t[n],this.B=!0))}},t.prototype.addAscii=function(){this.add(Pr),this.addChar("...")},t.prototype.addChar=function(t){var n=this.xi;if("\n"!==t){var i=n[t];null!=i?(i.ref<=0&&(this.Ri+=1),i.ref+=1):(n[t]=new _r(0,1,1,!1),this.Ri+=1,this.B=!0)}},t.prototype.add=function(t){for(var n=V.from(t);n.hasNext();)this.addChar(n.next())},t.prototype.get=function(t){return this.xi[t]},t.prototype.update=function(){if(this.B){var n=this.ji,i=this.Ii;if(null!=n&&null!=i){var r=n.getContext("2d");if(null!=r){this.B=!1;var e=this.Ai,u=this.xi,s=e.size+14,h=t.toPowerOf2(Math.ceil(Math.sqrt(this.Ri))*s);this.l=h;var o=(e.italic?"italic ":"")+e.size+"px "+e.family;r.font=o,r.textAlign="left",r.textBaseline="middle",r.lineWidth=0,r.lineCap="round",r.lineJoin="miter",r.miterLimit=0,r.fillStyle="#FFFFFF";var a=s>>1,f=0,c=0;for(var l in u){var v=u[l],b=r.measureText(l).width,g=Math.ceil(7+b+7),d=s;h<=f+g&&(f=0,c+=s),v.x=f,v.y=c,v.width=g,v.height=d,v.advance=b,v.origin.x=f+7,v.origin.y=c+a,f+=g}var m=this.I=c+s;for(var l in n.width=h,n.height=m,r.font=o,r.textAlign="left",r.textBaseline="middle",r.lineWidth=0,r.lineCap="round",r.lineJoin="miter",r.miterLimit=4,r.fillStyle="#FFFFFF",r.clearRect(0,0,h,m),u)v=u[l],r.fillText(l,v.origin.x,v.origin.y);return i.updateTexture(n),i.render(),i.read(n),!0}}}return!1},Object.defineProperty(t.prototype,"length",{get:function(){return this.Ri},enumerable:!0,configurable:!0}),t.prototype.toJson=function(){return{width:this.l,height:this.I,font:this.Ai,characters:this.xi}},t.prototype.toString=function(){return JSON.stringify(this.toJson())},t.prototype.destroy=function(){null!=this.Ii&&(this.Ii=null),null!=this.ji&&(this.ji=null);var t=this.xi;for(var n in t)delete t[n]},t.toFontFamily=function(n){return"auto"===n?t.getAutoFontFamily():n},t.toPowerOf2=function(t){for(var n=32;n<t;)n<<=1;return n},t.getGenerator=function(){return null==t.GENERATOR&&(t.GENERATOR=new Ur),t.GENERATOR},t.getAutoFontFamily=function(){return null==t.FONT_FAMILY_AUTO&&(t.FONT_FAMILY_AUTO=L.getInstance().get("DBase").getFontFamilly()),t.FONT_FAMILY_AUTO},t.GENERATOR=null,t.FONT_FAMILY_AUTO=null,t}(),Gr=function(){function n(){var n=this;this.input=null,this.shape=null,this.value="",this.point=new t.Point,this.rect=new t.Rectangle,this.Li=function(t){n.onInputKeyDown(t)},this.Bi=function(t){n.onInputBlur(t)},this.Pi=function(){n.updateInput()},this.Fi=function(){n.onInputChange()},this._i=function(t){n.onInputInput(t)},this.Ui=null}return n.prototype.getInput=function(t){return null==this.input&&t.application.getRootElement().appendChild(this.input=this.createInput()),this.input},n.prototype.createInput=function(){var t=document.createElement("input");return t.setAttribute("spellcheck","false"),t},n.prototype.getInputType=function(){return"text"},n.prototype.initInput=function(t,n,i){n.type=this.getInputType(),n.value=i,n.addEventListener("keydown",this.Li),n.addEventListener("blur",this.Bi),n.addEventListener("change",this.Fi),n.addEventListener("input",this._i),n.setAttribute("style",this.getInputStyle(t)),t.readonly?n.setAttribute("readonly","readonly"):n.removeAttribute("readonly"),t.disabled?n.setAttribute("disabled","disabled"):n.removeAttribute("disabled")},n.prototype.getInputStyleBackground=function(){return"background-color: transparent;"},n.prototype.getInputStyleBorder=function(){return"border: none; box-sizing: border-box;"},n.prototype.getInputStylePadding=function(t,n){var i=t.text.padding.horizontal*n;return"padding: 0px "+i+"px 0px "+i+"px;"},n.prototype.getInputStyleOutline=function(){return"outline: none;"},n.prototype.getInputStylePosition=function(t,n){return"position: absolute;left: "+t.x+"px;top: "+t.y+"px;width: "+t.width+"px;height: "+t.height+"px;line-height: "+t.height+"px;transform: matrix("+n.a+","+n.b+","+n.c+","+n.d+","+n.tx+","+n.ty+");"},n.prototype.getInputStyleText=function(t,n,i){var r=t.text;return"font-family: "+zr.toFontFamily(r.family)+";font-size: "+r.size*i+"px;font-weight: "+(r.weight===Nn.NORMAL?"normal":"bold")+";color: #"+r.color.toString(16)+";"},n.prototype.getInputStyleMargin=function(t,n,i){return"margin: 0;"},n.prototype.getInputStyle=function(t){var n=t.transform.pivot,i=t.size,r=i.x,e=i.y,u=this.rect;u.x=-.5*r+n.x,u.y=-.5*e+n.y,u.width=r,u.height=e,t.updateTransform();var s=t.transform.worldTransform;return this.getInputStylePosition(u,s)+this.getInputStyleMargin(t,u,1)+this.getInputStyleText(t,u,1)+this.getInputStyleBackground()+this.getInputStyleBorder()+this.getInputStylePadding(t,1)+this.getInputStyleOutline()},n.prototype.onInputKeyDown=function(t){if(B.isFocusKey(t)){var n=this.shape;if(null!=n){this.onInputChange(),this.hide();var i=e.getLayer(n);if(i){var r=i.getFocusController(),u=B.getFocusDirection(t),s=r.findFocusable(n,!1,!1,u);null!=s&&(i.view.focus(),t.preventDefault(),r.setFocused(s,!0,!0))}}}else B.isOkKey(t)&&(this.onInputChange(),this.hide())},n.prototype.onInputBlur=function(t){this.onInputChange(),this.hide()},n.prototype.onInputInput=function(t){if(t.target instanceof HTMLInputElement){var n=this.shape,i=this.onInput;null!=n&&null!=i&&i(n,t.target.value)}},n.prototype.updateInput=function(){var t=this.shape;if(null!=t)if(t.visible){var n=this.input;null!=n&&n.setAttribute("style",this.getInputStyle(t))}else this.hide()},n.prototype.isShown=function(t){return this.shape===t},n.prototype.show=function(t,n,i,r){var u=this.shape;if(null!=u&&u!==t&&this.hide(),null==this.shape){this.shape=t,this.value=n,this.onChange=i,this.onInput=r;var s=t.text;null!=s&&(s.enable=!1);var h=e.getLayer(t);if(h){var o=this.getInput(h);if(o){this.initInput(t,o,n);var a=this.Pi,f=this.Ui;null!=f&&f.off("postrender",a),this.Ui=h.renderer,h.renderer.on("postrender",a),o.style.display="",o.focus(),o.select()}h.update()}}},n.prototype.hide=function(){var t=this.shape;if(null!=t){this.shape=null,this.value="";var n=t.text;null!=n&&(n.enable=!0);var i=this.input;null!=i&&(i.removeEventListener("keydown",this.Li),i.removeEventListener("blur",this.Bi),i.removeEventListener("change",this.Fi),i.removeEventListener("input",this._i),i.style.display="none");var r=this.Ui;null!=r&&(this.Ui=null,r.off("postrender",this.Pi)),e.update(t)}},n.prototype.onInputChange=function(){var t=this.shape,n=this.input,i=this.onChange;if(null!=t&&null!=n&&null!=i){var r=n.value;this.value!==r&&i(t,r)}},n}(),Hr=function(t){function n(){return t.call(this)||this}return i(n,t),n.prototype.execute=function(t,i,r){var e=this;if(!t.disabled){var u=n.getData();t.focused?u.isShown(t)||setTimeout((function(){u.show(t,t.text.value,(function(n,i){t.text.value=i,e.emit("change",t,i)}))}),0):u.isShown(t)&&(u.onInputChange(),u.hide())}},n.getData=function(){return null==n.data&&(n.data=new Gr),n.data},n.data=null,n}(Qn);!function(t){t[t.INPUT=0]="INPUT"}(Ar||(Ar={}));var Vr,Wr=function(t){function n(n,i){return t.call(this,oi.MISC,i,n)||this}return i(n,t),n.prototype.toRuntime=function(t){switch(this.subtype){case Ar.INPUT:return new Hr}},n.prototype.serialize=function(t){var n=t.add(this.condition);return t.add("["+this.type+","+n+","+this.subtype+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources);return new n(t[2],r)},n}(fi),Yr=function(){return null},Xr=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.target=r.toExpression(n.target,Yr,"null"),r}return i(n,t),n}(ti),Kr=function(t){function n(n){return t.call(this,n,on.NONE)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);if(null!=r){var u=e.getLayer(t);if(u){var s=u.application;"opener"in s&&s.opener(r)}}}},n}(Xr),Jr=function(t){function n(n){return t.call(this,n,on.NONE)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);null!=r&&window.open(r)}},n}(Xr),Zr=function(t){function n(n){return t.call(this,n,on.NONE)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.target(t,i);null!=r&&(window.location.href=r)}},n}(Xr);!function(t){t[t.FLOW=0]="FLOW",t[t.PAGE=1]="PAGE",t[t.PAGE_INPLACE=2]="PAGE_INPLACE"}(Vr||(Vr={}));var qr,Qr=function(t){function n(n,i,r){var e=t.call(this,oi.OPEN,i,n)||this;return e.target=r,e}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.target===i.target},n.prototype.toRuntime=function(){switch(this.subtype){case Vr.FLOW:return new Kr(this);case Vr.PAGE:return new Jr(this);case Vr.PAGE_INPLACE:return new Zr(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.target);return t.add("["+this.type+","+n+","+this.subtype+","+i+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(3,t,i.resources);return new n(t[2],r,e)},n}(fi);!function(t){t[t.SHOW=0]="SHOW",t[t.HIDE=1]="HIDE"}(qr||(qr={}));var $r,te,ne=function(t){function n(n){var i=t.call(this,n,on.VISIBILITY)||this;return i.visibility=n.subtype===qr.SHOW,i}return i(n,t),n.prototype.execute=function(t,n,i){this.condition(t,i)&&(t.visible=this.visibility,n.written|=this.reset)},n}(ti),ie=function(t){function n(n,i){return t.call(this,oi.SHOW_HIDE,i,n)||this}return i(n,t),n.prototype.toRuntime=function(){return new ne(this)},n.prototype.serialize=function(t){var n=t.add(this.condition);return t.add("["+this.type+","+n+","+this.subtype+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources);return new n(t[2],r)},n}(fi),re=function(){return 0},ee=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.amount=r.toExpression(n.amount,re,"0"),r}return i(n,t),n}(ti),ue=function(t){function n(n){return t.call(this,n,on.POSITION_X)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i);t.transform.position.x=r,n.written|=this.reset}},n}(ee),se=function(t){function n(n){return t.call(this,n,on.POSITION_Y)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i);t.transform.position.y=r,n.written|=this.reset}},n}(ee),he=function(t){function n(n){return t.call(this,n,on.POSITION)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform.position,u=0!=(n.written&on.POSITION_X),s=0!=(n.written&on.POSITION_Y),h=u?e.x:n.x,o=s?e.y:n.y;t.updateTransform();var a=t.transform.localTransform;e.set(h-a.c*r,o-a.d*r),n.written|=this.reset}},n}(ee),oe=function(t){function n(n){return t.call(this,n,on.POSITION)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform.position,u=0!=(n.written&on.POSITION_X),s=0!=(n.written&on.POSITION_Y),h=u?e.x:n.x,o=s?e.y:n.y;t.updateTransform();var a=t.transform.localTransform;e.set(h+a.a*r,o+a.b*r),n.written|=this.reset}},n}(ee),ae=function(t){function n(n){return t.call(this,n,on.POSITION_X)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=0!=(n.written&on.POSITION_X),u=t.transform.position,s=e?u.x:n.x;u.x=s+r,n.written|=this.reset}},n}(ee),fe=function(t){function n(n){return t.call(this,n,on.POSITION_Y)||this}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=0!=(n.written&on.POSITION_Y),u=t.transform.position,s=e?u.y:n.y;u.y=s+r,n.written|=this.reset}},n}(ee),ce=function(t){function n(n,i,r,e){var u=t.call(this,n,i,r)||this;return u.opetype=e,u}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.opetype===i.opetype},n}(fi);!function(t){t[t.RELATIVE_X=0]="RELATIVE_X",t[t.RELATIVE_Y=1]="RELATIVE_Y",t[t.ABSOLUTE_X=2]="ABSOLUTE_X",t[t.ABSOLUTE_Y=3]="ABSOLUTE_Y",t[t.FORWARD_OR_BACKWARD=4]="FORWARD_OR_BACKWARD",t[t.LEFT_OR_RIGHT=5]="LEFT_OR_RIGHT"}($r||($r={})),function(t){t[t.RESIZE=0]="RESIZE",t[t.MOVE=1]="MOVE",t[t.ROTATE=2]="ROTATE"}(te||(te={}));var le,ve=function(t){function n(n,i,r){var e=t.call(this,oi.TRANSFORM,i,te.MOVE,n)||this;return e.amount=r,e}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.amount===i.amount},n.prototype.toRuntime=function(){switch(this.opetype){case $r.ABSOLUTE_X:return new ue(this);case $r.ABSOLUTE_Y:return new se(this);case $r.FORWARD_OR_BACKWARD:return new he(this);case $r.LEFT_OR_RIGHT:return new oe(this);case $r.RELATIVE_X:return new ae(this);case $r.RELATIVE_Y:return new fe(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.amount);return t.add("["+this.type+","+n+","+this.subtype+","+this.opetype+","+i+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(4,t,i.resources);return new n(t[3],r,e)},n}(ce),be=function(){function t(){}return t.toRounded=function(t){return Math.round(100*t)/100},t.toNormalized=function(n){return Math.abs(n)<.001?n<0?-.001:.001:t.toRounded(n)},t.resize=function(n,i,r,e,u){n.disallowUploadedUpdate();var s=n.transform.position;if(e){var h=Math.abs(r.x-i.x),o=Math.abs(r.y-i.y);if(u){var a=(l=Math.max(h,o))+l;n.size.set(t.toNormalized(a),t.toNormalized(a)),s.set(t.toRounded(i.x),t.toRounded(i.y))}else n.size.set(t.toNormalized(h+h),t.toNormalized(o+o)),s.set(t.toRounded(i.x),t.toRounded(i.y))}else if(u){h=r.x-i.x,o=r.y-i.y,a=Math.max(Math.abs(h),Math.abs(o));var f=i.x+(h<0?-a:+a),c=i.y+(o<0?-a:+a),l=.5*a,v=Math.min(i.x,f)+l,b=Math.min(i.y,c)+l;n.size.set(t.toNormalized(a),t.toNormalized(a)),s.set(t.toRounded(v),t.toRounded(b))}else{var g=Math.min(i.x,r.x),d=Math.min(i.y,r.y),m=Math.max(i.x,r.x)-g,w=Math.max(i.y,r.y)-d,p=.5*m,D=.5*w;n.size.set(t.toNormalized(m),t.toNormalized(w)),s.set(t.toRounded(g+p),t.toRounded(d+D))}n.allowUploadedUpdate()},t}();!function(t){t[t.RELATIVE_SIZE=0]="RELATIVE_SIZE",t[t.RELATIVE_HEIGHT=1]="RELATIVE_HEIGHT",t[t.RELATIVE_WIDTH=2]="RELATIVE_WIDTH",t[t.ABSOLUTE_SIZE=3]="ABSOLUTE_SIZE",t[t.ABSOLUTE_HEIGHT=4]="ABSOLUTE_HEIGHT",t[t.ABSOLUTE_WIDTH=5]="ABSOLUTE_WIDTH"}(le||(le={}));var ge,de=function(){return 1},me=function(){return 100},we=function(t){function n(n,i){var r=t.call(this,n,i)||this;switch(n.opetype){case le.RELATIVE_SIZE:r.size=r.toExpression(n.amount,de,"1");break;case le.ABSOLUTE_SIZE:r.size=r.toExpression(n.amount,me,"100");break;case le.RELATIVE_HEIGHT:r.size=r.toExpression(n.amount,de,"1");break;case le.ABSOLUTE_HEIGHT:r.size=r.toExpression(n.amount,me,"100");break;case le.RELATIVE_WIDTH:r.size=r.toExpression(n.amount,de,"1");break;case le.ABSOLUTE_WIDTH:r.size=r.toExpression(n.amount,me,"100");break;default:r.size=de}return r}return i(n,t),n.prototype.adjustPosition=function(t,n,i,r,e,u){var s=(-.5+e)*i,h=(-.5+u)*r;t.updateTransform();var o=t.transform,a=o.position,f=o.localTransform,c=0!=(n.written&on.POSITION_X),l=0!=(n.written&on.POSITION_Y),v=c?a.x:n.x,b=l?a.y:n.y;n.written|=on.POSITION,a.set(v+s*f.a+h*f.c,b+s*f.b+h*f.d)},n}(ti),pe=function(t){function n(n){var i=t.call(this,n,on.HEIGHT)||this;return i.origin=n.originY,i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&on.HEIGHT)?e.y:n.size.y;e.y=be.toNormalized(r),n.written|=on.HEIGHT,this.adjustPosition(t,n,0,u-e.y,.5,this.origin)}},n}(we),De=function(t){function n(n){var i=t.call(this,n,on.HEIGHT)||this;return i.origin=n.originY,i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&on.HEIGHT)?e.y:n.size.y;e.y=be.toNormalized(u*r),n.written|=on.HEIGHT,this.adjustPosition(t,n,0,u-e.y,.5,this.origin)}},n}(we),Oe=function(t){function n(n){var i=t.call(this,n,on.SIZE)||this;return i.originX=n.originX,i.originY=n.originY,i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=be.toNormalized(this.size(t,i)),e=t.size,u=0!=(n.written&on.WIDTH),s=0!=(n.written&on.HEIGHT),h=u?e.x:n.size.x,o=s?e.y:n.size.y;e.set(r,r),n.written|=on.SIZE,this.adjustPosition(t,n,h-e.x,o-e.y,this.originX,this.originY)}},n}(we),Se=function(t){function n(n){var i=t.call(this,n,on.SIZE)||this;return i.originX=n.originX,i.originY=n.originY,i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&on.WIDTH),s=0!=(n.written&on.HEIGHT),h=u?e.x:n.size.x,o=s?e.y:n.size.y;e.set(be.toNormalized(h*r),be.toNormalized(o*r)),n.written|=on.SIZE,this.adjustPosition(t,n,h-e.x,o-e.y,this.originX,this.originY)}},n}(we),Me=function(t){function n(n){var i=t.call(this,n,on.WIDTH)||this;return i.origin=n.originX,i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&on.WIDTH)?e.x:n.size.x;e.x=be.toNormalized(r),n.written|=on.WIDTH,this.adjustPosition(t,n,u-e.x,0,this.origin,.5)}},n}(we),Ee=function(t){function n(n){var i=t.call(this,n,on.WIDTH)||this;return i.origin=n.originX,i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.size(t,i),e=t.size,u=0!=(n.written&on.WIDTH)?e.x:n.size.x;e.x=be.toNormalized(u*r),n.written|=on.WIDTH,this.adjustPosition(t,n,u-e.x,0,this.origin,.5)}},n}(we),Ne=function(t){function n(n,i,r,e,u){var s=t.call(this,oi.TRANSFORM,i,te.RESIZE,n)||this;return s.originX=r,s.originY=e,s.amount=u,s}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.originX===i.originX&&this.originY===i.originY&&this.amount===i.amount},n.prototype.toRuntime=function(){switch(this.opetype){case le.ABSOLUTE_HEIGHT:return new pe(this);case le.ABSOLUTE_WIDTH:return new Me(this);case le.ABSOLUTE_SIZE:return new Oe(this);case le.RELATIVE_HEIGHT:return new De(this);case le.RELATIVE_WIDTH:return new Ee(this);case le.RELATIVE_SIZE:return new Se(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.amount);return t.add("["+this.type+","+n+","+this.subtype+","+this.opetype+","+this.originX+","+this.originY+","+i+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(6,t,i.resources);return new n(t[3],r,t[4],t[5],e)},n}(ce),Te=function(){return 0},je=function(t){function n(n,i){var r=t.call(this,n,i)||this;return r.originX=n.originX,r.originY=n.originY,r.amount=r.toExpression("("+n.amount+") * (Math.PI / 180)",Te,"0"),r}return i(n,t),n.prototype.adjustPosition=function(t,n,i,r,e,u){var s=0!=(n.written&on.WIDTH),h=0!=(n.written&on.HEIGHT),o=(-.5+e)*(s?t.size.x:n.size.x),a=(-.5+u)*(h?t.size.y:n.size.y),f=Math.sin(i)-Math.sin(r),c=Math.cos(i)-Math.cos(r),l=t.transform.position,v=0!=(n.written&on.POSITION_X),b=0!=(n.written&on.POSITION_Y),g=v?l.x:n.x,d=b?l.y:n.y;n.written|=on.POSITION,l.set(g+o*c-a*f,d+o*f+a*c)},n}(ti),Ce=function(t){function n(n){var i=t.call(this,n,on.ROTATION)||this;return i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform,u=0!=(n.written&on.ROTATION)?e.rotation:n.rotation;e.rotation=r,n.written|=on.ROTATION,this.adjustPosition(t,n,u,r,this.originX,this.originY)}},n}(je),ke=function(t){function n(n){var i=t.call(this,n,on.ROTATION)||this;return i.reset|=on.POSITION,i}return i(n,t),n.prototype.execute=function(t,n,i){if(this.condition(t,i)){var r=this.amount(t,i),e=t.transform,u=0!=(n.written&on.ROTATION)?e.rotation:n.rotation;e.rotation=u+r,n.written|=on.ROTATION,this.adjustPosition(t,n,u,e.rotation,this.originX,this.originY)}},n}(je);!function(t){t[t.RELATIVE=0]="RELATIVE",t[t.ABSOLUTE=1]="ABSOLUTE"}(ge||(ge={}));var ye=function(t){function n(n,i,r,e,u){var s=t.call(this,oi.TRANSFORM,i,te.ROTATE,n)||this;return s.originX=r,s.originY=e,s.amount=u,s}return i(n,t),n.prototype.isEquals=function(i){return t.prototype.isEquals.call(this,i)&&i instanceof n&&this.originX===i.originX&&this.originY===i.originY&&this.amount===i.amount},n.prototype.toRuntime=function(){switch(this.opetype){case ge.ABSOLUTE:return new Ce(this);case ge.RELATIVE:return new ke(this)}},n.prototype.serialize=function(t){var n=t.add(this.condition),i=t.add(this.amount);return t.add("["+this.type+","+n+","+this.subtype+","+this.opetype+","+this.originX+","+this.originY+","+i+"]")},n.deserialize=function(t,i){var r=li.toResource(1,t,i.resources),e=li.toResource(6,t,i.resources);return new n(t[3],r,t[4],t[5],e)},n}(ce),Ie=function(){function t(){}return t.toSerialized=function(t){try{var n=JSON.parse(t);if(Zn(n)){for(var i=0,r=n.length;i<r;++i)if(!c(n[i]))return null;if(2<=n.length)return n}return null}catch(t){return null}},t.deserialize=function(t,n){var i=n.actions.get(t);if(null!=i)return i;var r=n.resources[t];if(null!=r){var e=this.toSerialized(r);if(null!=e)switch(e[0]){case oi.SHOW_HIDE:return ie.deserialize(e,n);case oi.BLINK:return vi.deserialize(e,n);case oi.CHANGE_COLOR:switch(e[3]){case ci.COLOR_AND_ALPHA:case ci.COLOR:case ci.ALPHA:return Ni.deserialize(e,n);case ci.CODE:return Wi.deserialize(e,n);case ci.BRIGHTNESS:return Ri.deserialize(e,n)}case oi.CHANGE_TEXT:return xr.deserialize(e,n);case oi.CHANGE_CURSOR:return Ki.deserialize(e,n);case oi.EMIT_EVENT:return Br.deserialize(e,n);case oi.OPEN:return Qr.deserialize(e,n);case oi.TRANSFORM:switch(e[2]){case te.MOVE:return ve.deserialize(e,n);case te.RESIZE:return Ne.deserialize(e,n);case te.ROTATE:return ye.deserialize(e,n)}break;case oi.MISC:return Wr.deserialize(e,n)}}return new ie(qr.SHOW,"")},t}(),Ae=function(){function t(){}return t.toImageElement=function(n){var i=t.imageElements,r=i[n];if(null!=r)return r instanceof HTMLImageElement?Promise.resolve(r):r;var e=new Promise((function(t,r){var e=document.createElement("img");e.onload=function(){i[n]=e,t(e)},e.onabort=e.onerror=function(){r()},e.src=n}));return i[n]=e,e},t.imageElements={},t}(),xe=function(t){this.resources=t,this.actions=new Map,this.fills=new Map,this.strokes=new Map,this.tags=new Map,this.tagValues=new Map,this.ranges=new Map,this.aligns=new Map,this.margins=new Map,this.texts=new Map,this.textOutlines=new Map,this.extensions=new Map},Re=function(){function t(){}return t.toShape=function(t,n){var i=nn[t[0]];return null!=i?i(t,n):null},t.deserialize=function(n,i,r){r.id=i.resources[n[1]]||"",r.transform.position.set(n[2],n[3]),r.transform.rotation=n[6],r.transform.skew.set(n[7],n[7]),r.transform.pivot.set(n[21],n[22]),r.size.set(be.toNormalized(n[4]),be.toNormalized(n[5])),r.fill.deserialize(n[8],i),r.stroke.deserialize(n[9],i),r.cursor=i.resources[n[10]]||"",r.text.deserialize(n[11],i),r.tag.deserialize(n[12],i),r.radius=n[13],r.corner=n[14],r.interactive=!!(1&n[23]),r.unfocusable=!!(2&n[23]),r.shortcut=0<=n[24]?i.resources[n[24]]:void 0,r.title=0<=n[25]?i.resources[n[25]]:void 0;var e=null,u=n[20];if(0<u.length){for(var s=[],h=0,a=u.length;h<a;++h){var f=u[h],c=t.toShape(f,i);null!=c&&s.push(c)}e=Promise.all(s).then((function(t){r.children=t;for(var n=0,i=t.length;n<i;++n)t[n].parent=r;return r.onChildTransformChange(),r.toDirty(),r}))}var l=n[17];for(h=0,a=l.length;h<a;++h)r.action.add(Ie.deserialize(l[h],i));var v=n[19];if(0<=v&&v<i.resources.length){var b=i.resources[v];o(b)&&(r.gradient=wn.deserializeGradient(b))}var g=null,d=n[18];if(0<=d&&d<i.resources.length){var m=i.resources[d];o(m)&&(g=Ae.toImageElement(m).then((function(t){return r.image=t,r})))}return null!=e?null!=g?Promise.all([e,g]).then((function(){return r})):e:null!=g?g:r},t.deserializeAll=function(n,i){for(var r=new xe(i),e=[],u=0,s=n.length;u<s;++u){var h=n[u],o=t.toShape(h,r);if(null==o)return 0<e.length&&Promise.all(e).then((function(t){for(var n=0,i=t.length;n<i;++n)t[n].destroy()})),null;e.push(o)}return 0<e.length?Promise.all(e):null},t}(),Le=function(){function t(){}return t.deserialize=function(t,n){var i=new zn(un.RIGHT,10,3,rn.NONE),r=Re.deserialize(t,n,i);return i.points.deserialize(t[15],n),r},t}(),Be=function(){en[St.BAR]=Jn.create,nn[St.BAR]=Le.deserialize},Pe=function(t,n,i,r,e,u,s,h,o,a,f){for(var c=2*r,l=c+2*e,v=c,b=3*r,g=4*r;v<l;v+=2,b+=3,g+=4){var d=i[b+0],m=i[b+1];t[v+0]=u*d,t[v+1]=s*m,n[g+0]=h,n[g+1]=o,n[g+2]=a,n[g+3]=f}},Fe=function(t,n,i,r){if(1e-5<n){var e=t-n;if(1e-5<e){var u=i/e,s=i/Math.max(1e-5,t),h=1/Math.max(1e-5,1-n/t);r[0]=h,r[1]=u,r[2]=s}else u=i/1e-5,s=i/Math.max(1e-5,t),h=1/1e-5,r[0]=h,r[1]=u,r[2]=s}else{var o=i/Math.max(1e-5,t);r[0]=1,r[1]=o,r[2]=o}return r},_e=function(t,n){var i=3*n;t[i+0]=1,t[i+1]=1,t[i+2]=1,t[i+3]=0,t[i+4]=1,t[i+5]=1,t[i+6]=1,t[i+7]=1,t[i+8]=1,t[i+9]=1,t[i+10]=0,t[i+11]=1,t[i+12]=0,t[i+13]=0,t[i+14]=1,t[i+15]=1,t[i+16]=0,t[i+17]=1,t[i+18]=1,t[i+19]=1,t[i+20]=1,t[i+21]=0,t[i+22]=1,t[i+23]=1,t[i+24]=1,t[i+25]=1,t[i+26]=1},Ue=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+3,t[r+3]=n+1,t[r+4]=n+4,t[r+5]=n+3,t[r+6]=n+1,t[r+7]=n+2,t[r+8]=n+4,t[r+9]=n+2,t[r+10]=n+5,t[r+11]=n+4,t[r+12]=n+3,t[r+13]=n+4,t[r+14]=n+6,t[r+15]=n+4,t[r+16]=n+7,t[r+17]=n+6,t[r+18]=n+4,t[r+19]=n+5,t[r+20]=n+7,t[r+21]=n+5,t[r+22]=n+8,t[r+23]=n+7},ze=function(t,n,i,r,e,u,s,h,o,a,f,c,l,v,b,g,d){var m=f*c,w=.5*o+(0<=o?+m:-m),p=.5*a+(0<=a?+m:-m);g.set(-w+s,-p+h),v.apply(g,g);var D=g.x,O=g.y;g.set(0+s,-p+h),v.apply(g,g);var S=g.x,M=g.y,E=S-D,N=M-O;g.set(s,h),v.apply(g,g);var T=g.x,j=g.y,C=T+(T-S),k=j+(j-M),y=T-E,I=j-N,A=2*n;if(t[A+0]=D,t[A+1]=O,t[A+2]=S,t[A+3]=M,t[A+4]=S+E,t[A+5]=M+N,t[A+6]=y,t[A+7]=I,t[A+8]=T,t[A+9]=j,t[A+10]=T+E,t[A+11]=j+N,t[A+12]=C-E,t[A+13]=k-N,t[A+14]=C,t[A+15]=k,t[A+16]=C+E,t[A+17]=k+N,l){var x=Yn(D,O,S,M);Fe(x,c,b,d);var R=d[0],L=d[1],B=d[2],P=Yn(D,O,y,I);Fe(P,c,b,d);var F=d[0],_=d[1],U=d[2];Pe(r,e,u,n,i,R,F,L,_,B,U)}},Ge=function(t,n,i){var r=n.x0,e=n.x1,u=n.x2,s=n.x3,h=n.y0,o=n.y1,a=n.y2,f=n.y3,c=2*t;i[c+0]=r,i[c+1]=h,i[c+2]=.5*(r+e),i[c+3]=.5*(h+o),i[c+4]=e,i[c+5]=o,i[c+6]=.5*(r+s),i[c+7]=.5*(h+f),i[c+8]=.5*(r+u),i[c+9]=.5*(h+a),i[c+10]=.5*(e+u),i[c+11]=.5*(o+a),i[c+12]=s,i[c+13]=f,i[c+14]=.5*(s+u),i[c+15]=.5*(f+a),i[c+16]=u,i[c+17]=a},He=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.clippingBuffer.update(),i.indexBuffer.update();var r=this.vertexOffset;return _e(i.clippings,r),Ue(i.indices,r,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateCircleVertexAndStep(n,t),this.updateColor(n,t),this.updateCircleUv(n,t),this.updateText(n,t)},n.prototype.updateCircleVertexAndStep=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s,o=n.stroke,a=o.enable?o.width:0,f=o.align,c=this.strokeAlign!==f||this.strokeWidth!==a;(u||h||c)&&(this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.strokeWidth=a,this.strokeAlign=f,this.textSpacingHorizontal=NaN,t.vertexBuffer.update(),t.stepBuffer.update(),t.antialiasBuffer.update(),ze(t.vertices,this.vertexOffset,9,t.steps,t.antialiases,t.clippings,0,0,r,e,f,a,!0,n.transform.internalTransform,this.antialiasWeight,t.work,t.workStep))},n.prototype.updateCircleUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r,t.uvBuffer.update();var e=this.toTextureUvs(i);Ge(this.vertexOffset,e,t.uvs)}},n}(Xn),Ve=function(){function t(){}return t.create=function(t,n,i,r,e){var u=Wn.getTextCount(n,t.workCount),s=u.vertexCount,h=u.indexCount,o=9+s,a=8+h;return i+o<t.vertexCapacity&&r+a<t.indexCapacity?new He(t,i,r,s,h,o,a,e).init(n):null},t}(),We=function(t){function n(n){return void 0===n&&(n=St.CIRCLE),t.call(this,n)||this}return i(n,t),n.prototype.clone=function(){return(new n).copy(this)},n.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=this.fill,s=this.stroke;if(u.enable){if((f=n*n)*(a=e*e)+(c=i*i)*(o=r*r)<=o*a)return!0}else{var h=s.width;if(s.enable&&0<h){var o,a,f=n*n,c=i*i,l=Math.max(0,r-h),v=Math.max(0,e-h),b=l*l,g=v*v;if(b*g<=f*g+c*b&&f*(a=e*e)+c*(o=r*r)<=o*a)return!0}}}return!1},n}(_n),Ye=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new We)},t}(),Xe=function(){en[St.CIRCLE]=Ve.create,nn[St.CIRCLE]=Ye.deserialize},Ke=function(n){function r(t,i,r){return n.call(this,t,i,r,0,0,1)||this}return i(r,n),r.prototype.init=function(i){return n.prototype.init.call(this,i),this.texture=i.texture||t.Texture.WHITE,this},r.prototype.update=function(t){},r}(Vn),Je=function(){function t(){}return t.create=function(t,n,i,r){return new Ke(t,i,r).init(n)},t}(),Ze=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.Bn.children;return!(0<t.length)||t[t.length-1].fill.enable},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].fill.enable=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].fill.color:16777215},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].fill.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].fill.alpha:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].fill.alpha=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].fill.copy(t)},t.prototype.set=function(t,n,i){for(var r=this.Bn.children,e=0,u=r.length;e<u;++e)r[e].fill.set(t,n,i)},t.prototype.clone=function(){return new t(this.Bn)},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].fill.toObject():{enable:!0,color:16777215,alpha:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),qe=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"length",{get:function(){var t=this.Bn.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.length}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var t=this.Bn.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.id}return 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var t=this.Bn.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.values}return[]},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&(e.values=t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"segments",{get:function(){var t=this.Bn.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.segments}return[]},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&(e.segments=t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){var t=this.Bn.children;if(0<t.length){var n=t[t.length-1].points;if(null!=n)return n.style}return rn.NONE},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&(e.style=t)}},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i){var e=n[i].points;null!=e&&e.copy(t)}return this},t.prototype.set=function(t,n,i){for(var r=this.Bn.children,e=0,u=r.length;e<u;++e){var s=r[e].points;null!=s&&s.set(t,n,i)}return this},t.prototype.clone=function(n){return new t(n)},t.prototype.toPoints=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i){var e=n[i].points;if(null!=e)return e.toPoints(t)}return[]},t.prototype.serialize=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i){var e=n[i].points;if(null!=e)return e.serialize(t)}return-1},t}(),Qe=function(){this.localTransform=new t.Matrix,this.internalTransform=new t.Matrix,this.internalTransformParentInverse=new t.Matrix,this.rotation=0,this.size=new t.Point},$e=function(){function t(){}return t.prepare=function(t){var n=t.editor=t.editor||new Qe;t.updateTransform();var i=t.parent;i instanceof pn?i.transform.internalTransform.copyTo(n.internalTransformParentInverse).invert():n.internalTransformParentInverse.identity(),t.transform.internalTransform.copyTo(n.internalTransform),n.rotation=t.transform.rotation,n.size.copyFrom(t.size),t.disallowOnTransformChange()},t.finalize=function(t){t.allowOnTransformChange(!0)},t.apply=function(t,n,i){var r=t.editor;if(null!=r){var e=r.localTransform;if(r.internalTransformParentInverse.copyTo(e).append(n).append(r.internalTransform),i)this.applyLocal(t,e);else{var u=r.size;this.applyLocal(t,e,u.x,u.y)}}},t.applyLocal=function(t,n,i,r){t.disallowUploadedUpdate();var e=n.a,u=n.b,s=n.c,h=n.d,o=n.tx,a=n.ty,f=t.transform,c=Math.atan2(-s,h),l=Math.atan2(+u,e);f.rotation=.5*(c+l);var v=.5*(l-c);f.skew.set(v,v);var b=f.pivot,g=b.x,d=b.y;if(f.position.set(o+(e*g+s*d),a+(u*g+h*d)),null!=i&&null!=r){var m=Math.sqrt(e*e+u*u),w=Math.sqrt(s*s+h*h);t.size.set(be.toNormalized(i*m),be.toNormalized(r*w))}t.allowUploadedUpdate()},t}(),tu=function(){function n(n,i,r){this.shape=n,this.base=new t.Point(i,r);var e=n.size;this.shapeBase=new t.Point(e.x,e.y),this.transform=new t.Matrix,n.updateTransform(),n.transform.localTransform.copyTo(this.transform)}return n.prototype.isCompatible=function(t){return this.shape===t},n.prototype.reset=function(t,n,i){this.base.set(n,i);var r=t.size;this.shapeBase.copyFrom(r),t.updateTransform(),t.transform.localTransform.copyTo(this.transform)},n.prototype.update=function(t,i,r,e,u){var s=i/this.base.x,h=r/this.base.y,o=this.shapeBase,a=n.WORK_TRANSFORM;a.identity().append(this.transform).translate(-e,-u).scale(s,h).translate(+e,+u),t.disallowOnTransformChange(),$e.applyLocal(t,a,o.x,o.y),t.allowOnTransformChange(!1)},n.WORK_TRANSFORM=new t.Matrix,n}(),nu=function(){function n(n,i,r){this.zi=new t.Point,this.Gi=new t.Rectangle,this.Hi=new t.Rectangle,this.Bn=n,this.Vi=[],this._n=new t.Point(i,r)}return n.prototype.init=function(){},Object.defineProperty(n.prototype,"x",{get:function(){return this._n.x},set:function(t){var n=this._n;if(n.x!==t){var i=n.x;n.x=t,this.onChange(i,n.y)}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._n.y},set:function(t){var n=this._n;if(n.y!==t){var i=n.y;n.y=t,this.onChange(n.x,i)}},enumerable:!0,configurable:!0}),n.prototype.set=function(t,n){var i=!1,r=this._n,e=r.x,u=r.y;null!=t&&e!==t&&(i=!0,r.x=t),null!=n&&u!==n&&(i=!0,r.y=n),i&&this.onChange(e,u)},n.prototype.clone=function(){var t=this._n;return new n(this.Bn,t.x,t.y)},n.prototype.copy=function(){},n.prototype.copyFrom=function(t){var n=t.x,i=t.y,r=this._n,e=r.x,u=r.y;return e===n&&u===i||(r.x=n,r.y=i,this.onChange(e,u)),this},n.prototype.copyTo=function(t){return this._n.copyTo(t)},n.prototype.equals=function(t){return this._n.equals(t)},n.prototype.fit=function(){var t=this.Bn;t.disallowOnTransformChange();var n=this.calcRect(this.Hi),i=this._n;i.set(n.width,n.height),t.updateTransform();var r=t.transform,e=n.x+.5*n.width,u=n.y+.5*n.height,s=r.position,h=r.localTransform,o=h.a,a=h.b,f=h.c,c=h.d,l=r.pivot;s.set(s.x+(o*e+f*u)-(o*l.x+f*l.y),s.y+(a*e+c*u)-(a*l.x+c*l.y)),l.set(e,u),this.reset(t.children,this.Vi,i),t.allowOnTransformChange(!0)},n.prototype.reset=function(t,n,i){for(var r=0,e=Math.min(n.length,t.length);r<e;++r){var u=t[r],s=n[r];if(!s.isCompatible(u)){n.length=r;break}s.reset(u,i.x,i.y)}t.length<n.length&&(n.length=t.length)},n.prototype.calcRect=function(t){var n=this.Bn.children;if(n.length<=0)t.x=0,t.y=0,t.width=0,t.height=0;else{var i=this.zi,r=this.Gi;n[0].getBoundsLocal(i,!1,t);for(var e=1,u=n.length;e<u;++e)n[e].getBoundsLocal(i,!1,r),t.enlarge(r)}return t},n.prototype.onChange=function(t,n){var i=this.Bn,r=this._n,e=i.transform.pivot;this.Wi(i.children,this.Vi,r.x,r.y,e.x,e.y,t,n),i.onSizeChange()},n.prototype.Wi=function(t,n,i,r,e,u,s,h){for(var o=0,a=Math.min(n.length,t.length);o<a;++o){var f=t[o];if(!(c=n[o]).isCompatible(f)){n.length=o;break}c.update(f,i,r,e,u)}for(o=n.length,a=t.length;o<a;++o){var c;f=t[o],(c=this.newLayout(f,s,h)).update(f,i,r,e,u),n.push(c)}n.length!==t.length&&(n.length=t.length)},n.prototype.newLayout=function(t,n,i){return t.layout||new tu(t,n,i)},n}(),iu=function(n){function r(i,r,e){var u=n.call(this,i,void 0,r,e)||this;return u.base=new t.Point(r,e),u}return i(r,n),r.prototype.init=function(){this.base.copyFrom(this),this.cb()},r.prototype.fit=function(){},r}(t.ObservablePoint),ru=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.Bn.children;return 0<t.length&&t[t.length-1].stroke.enable},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].stroke.enable=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].stroke.color:16777215},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].stroke.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].stroke.alpha:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].stroke.alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].stroke.width:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].stroke.width=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].stroke.align:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].stroke.align=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].stroke.side:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].stroke.side=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].stroke.copy(t)},t.prototype.set=function(t,n,i,r,e){for(var u=this.Bn.children,s=0,h=u.length;s<h;++s)u[s].stroke.set(t,n,i,r,e)},t.prototype.clone=function(){return new t(this.Bn)},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].stroke.toObject():{enable:!1,color:16777215,alpha:1,width:1,align:0,side:vn.NONE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),eu=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.align.horizontal:jn.CENTER},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.align.horizontal=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.align.vertical:Cn.MIDDLE},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.align.vertical=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.align.copy(t)},t.prototype.set=function(t,n){for(var i=this.Bn.children,r=0,e=i.length;r<e;++r)i[r].text.align.set(t,n)},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.align.toObject():{horizontal:jn.CENTER,vertical:Cn.MIDDLE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),uu=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.offset.horizontal:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.offset.horizontal=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.offset.vertical:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.offset.vertical=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.offset.copy(t)},t.prototype.set=function(t,n){for(var i=this.Bn.children,r=0,e=i.length;r<e;++r)i[r].text.offset.set(t,n)},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.offset.toObject():{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),su=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.Bn.children;return 0<t.length&&t[t.length-1].text.outline.enable},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.outline.enable=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.outline.color:16777215},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.outline.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.outline.alpha:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.outline.alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.outline.width:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.outline.width=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.outline.copy(t)},t.prototype.set=function(t,n,i,r){for(var e=this.Bn.children,u=0,s=e.length;u<s;++u)e[u].text.outline.set(t,n,i,r)},t.prototype.clone=function(){return new t(this.Bn)},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.outline.toObject():{enable:!1,color:16777215,alpha:1,width:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),hu=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.padding.horizontal:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.padding.horizontal=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.padding.vertical:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.padding.vertical=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.padding.copy(t)},t.prototype.set=function(t,n){for(var i=this.Bn.children,r=0,e=i.length;r<e;++r)i[r].text.padding.set(t,n)},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.padding.toObject():{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),ou=function(){function t(t){this.Bn=t}return Object.defineProperty(t.prototype,"horizontal",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.spacing.horizontal:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.spacing.horizontal=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.spacing.vertical:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.spacing.vertical=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.spacing.copy(t)},t.prototype.set=function(t,n){for(var i=this.Bn.children,r=0,e=i.length;r<e;++r)i[r].text.spacing.set(t,n)},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.spacing.toObject():{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),au=function(){function t(t){this.Bn=t,this.align=new eu(t),this.offset=new uu(t),this.outline=new su(t),this.spacing=new ou(t),this.padding=new hu(t)}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this.Bn.children;return!(0<t.length)||t[t.length-1].text.enable},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.enable=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.value:""},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.value=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.color:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.color=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.alpha:1},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.alpha=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.family:"auto"},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.family=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.size:24},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.size=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.weight:Nn.NORMAL},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.weight=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.style:Tn.NORMAL},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.style=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.direction:0},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.direction=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){var t=this.Bn.children;return 0<t.length&&t[t.length-1].text.clipping},set:function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.clipping=t},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){for(var n=this.Bn.children,i=0,r=n.length;i<r;++i)n[i].text.copy(t);return this},t.prototype.set=function(t,n,i,r,e,u,s,h){for(var o=this.Bn.children,a=0,f=o.length;a<f;++a)o[a].text.set(t,n,i,r,e,u,s,h);return this},t.prototype.toObject=function(){var t=this.Bn.children;return 0<t.length?t[t.length-1].text.toObject():{value:"",color:0,alpha:1,family:"auto",size:24,weight:Nn.NORMAL,align:this.align.toObject(),offset:this.offset.toObject(),style:Tn.NORMAL,outline:this.outline.toObject(),spacing:this.spacing.toObject(),direction:kn.LEFT_TO_RIGHT,padding:this.padding.toObject(),clipping:!1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),fu=function(t){function n(n){void 0===n&&(n=St.GROUP);var i=t.call(this,n)||this;return i.tag=new xn,i.size=i.newGroupSize(),i.fill=i.newGroupFill(),i.stroke=i.newGroupStroke(),i.text=i.newGroupText(),i.points=i.newGroupPoints(),i}return i(n,t),n.prototype.newGroupSize=function(){var t=this;if(Sn.IS_EDIT_MODE)return new nu(this,Sn.SIZE_X,Sn.SIZE_Y);var n=new iu((function(){var i=n.base;t.transform.scale.set(n.x/i.x,n.y/i.y)}),Sn.SIZE_X,Sn.SIZE_Y);return n},n.prototype.newGroupFill=function(){return new Ze(this)},n.prototype.newGroupStroke=function(){return new ru(this)},n.prototype.newGroupText=function(){return new au(this)},n.prototype.newGroupPoints=function(){return new qe(this)},n.prototype.getBoundsSize=function(){var t=this.size;return t instanceof iu?t.base:t},n.prototype.onChildTransformChange=function(){t.prototype.onChildTransformChange.call(this),this.size.fit()},Object.defineProperty(n.prototype,"corner",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].corner:ln.ALL},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].corner=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"cursor",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].cursor:""},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].cursor=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"gradient",{get:function(){for(var t=this.children,n=t.length-1;0<=n;--n){var i=t[n].gradient;if(null!=i)return i}},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].gradient=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"radius",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].radius:.5},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].radius=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"image",{get:function(){for(var t=this.children,n=t.length-1;0<=n;--n){var i=t[n].image;if(null!=i)return i}},set:function(t){for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].image=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"points",{get:function(){for(var t=this.children,n=t.length-1;0<=n;--n)if(null!=t[n].points)return this.Yi},set:function(t){},enumerable:!0,configurable:!0}),n.prototype.clone=function(){for(var t=(new(0,this.constructor)).copy(this),n=this.children,i=0,r=n.length;i<r;++i){var e=n[i].clone();e.parent=t,t.children.push(e)}return t.onChildTransformChange(),t.toDirty(),t},n.prototype.containsAbs=function(t,n,i,r){return!1},n}(pn),cu=function(){function t(){}return t.deserialize=function(t,n){var i=new fu,r=Re.deserialize(t,n,i);return i.size.init(),r},t}(),lu=function(){en[St.GROUP]=Je.create,nn[St.GROUP]=cu.deserialize},vu=function(){function n(n,i,r){this.Bn=n,this._n=new t.Point(i,r)}return n.prototype.init=function(){},Object.defineProperty(n.prototype,"x",{get:function(){return this._n.x},set:function(t){var n=this._n;if(n.x!==t){var i=n.x;n.x=t,this.onChange(i,n.y)}},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"y",{get:function(){return this._n.y},set:function(t){var n=this._n;if(n.y!==t){var i=n.y;n.y=t,this.onChange(n.x,i)}},enumerable:!0,configurable:!0}),n.prototype.set=function(t,n){var i=!1,r=this._n,e=r.x,u=r.y;null!=t&&e!==t&&(i=!0,r.x=t),null!=n&&u!==n&&(i=!0,r.y=n),i&&this.onChange(e,u)},n.prototype.clone=function(){var t=this._n;return new n(this.Bn,t.x,t.y)},n.prototype.copy=function(){},n.prototype.copyFrom=function(t){var n=t.x,i=t.y,r=this._n,e=r.x,u=r.y;return e===n&&u===i||(r.x=n,r.y=i,this.onChange(e,u)),this},n.prototype.copyTo=function(t){return this._n.copyTo(t)},n.prototype.equals=function(t){return this._n.equals(t)},n.prototype.fit=function(){},n.prototype.onChange=function(t,n){this.Bn.onSizeChange()},n}(),bu=function(t){function n(n){return void 0===n&&(n=St.GROUP_SHADOWED),t.call(this,n)||this}return i(n,t),n.prototype.newGroupSize=function(){return Sn.IS_EDIT_MODE?new vu(this,Sn.SIZE_X,Sn.SIZE_Y):t.prototype.newGroupSize.call(this)},n}(fu),gu=function(){function t(){}return t.deserialize=function(t,n){var i=new bu,r=Re.deserialize(t,n,i);return i.size.init(),r},t}(),du=function(){en[St.GROUP_SHADOWED]=Je.create,nn[St.GROUP_SHADOWED]=gu.deserialize},mu=function(t){function n(n){return void 0===n&&(n=St.RECTANGLE),t.call(this,n)||this}return i(n,t),n.prototype.clone=function(){return(new n).copy(this)},n.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=this.fill,s=this.stroke;if(u.enable)return!0;var h=s.width,o=s.side;if(s.enable&&0<h&&o!==vn.NONE){var a=Math.max(0,r-h),f=Math.max(0,e-h);if(!this.containsAbsBBox(n,i,a,f))return o===vn.ALL||(n<=-a?i<=-f?0!=(o&vn.TOP_OR_LEFT):+f<=i?0!=(o&vn.BOTTOM_OR_LEFT):0!=(o&vn.LEFT):+a<=n?i<=-f?0!=(o&vn.TOP_OR_RIGHT):+f<=i?0!=(o&vn.BOTTOM_OR_RIGHT):0!=(o&vn.RIGHT):i<=-f?0!=(o&vn.TOP):+f<=i&&0!=(o&vn.BOTTOM))}}return!1},n}(_n),wu=function(t){function n(n,i){void 0===i&&(i=St.IMAGE);var r=t.call(this,i)||this;return null!=n&&(r.image=n,r.size.set(n.width,n.height)),r.fill.alpha=1,r}return i(n,t),n.prototype.clone=function(){return new n(this.image).copy(this)},n}(mu),pu=function(){function t(){}return t.from=function(t){return Ae.toImageElement(t).then((function(t){return new wu(t)}))},t.deserialize=function(t,n){return Re.deserialize(t,n,new wu)},t}(),Du=function(t,n){var i=3*n;t[i+0]=1,t[i+1]=1,t[i+2]=0,t[i+3]=0,t[i+4]=1,t[i+5]=0,t[i+6]=1,t[i+7]=1,t[i+8]=0,t[(i+=9)+0]=0,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0,t[i+3]=0,t[i+4]=0,t[i+5]=0,t[i+6]=0,t[i+7]=0,t[i+8]=0,t[i+9]=1,t[i+10]=0,t[i+11]=0,t[(i+=12)+0]=0,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=1,t[i+2]=0,t[i+3]=0,t[i+4]=1,t[i+5]=0,t[i+6]=1,t[i+7]=1,t[i+8]=0},Ou=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+3,t[r+3]=n+1,t[r+4]=n+2,t[r+5]=n+3,t[r+6]=n+0,t[r+7]=n+5,t[r+8]=n+4,t[r+9]=n+6,t[r+10]=n+2,t[r+11]=n+7,t[r+12]=n+4,t[r+13]=n+5,t[r+14]=n+9,t[r+15]=n+9,t[r+16]=n+8,t[r+17]=n+10,t[r+18]=n+8,t[r+19]=n+11,t[r+20]=n+10,t[r+21]=n+6,t[r+22]=n+7,t[r+23]=n+11},Su=function(t,n,i,r,e,u,s,h,o,a,f,c,l,v,b,g){var d=o*a,m=.5*s+(0<=s?+d:-d),w=.5*h+(0<=h?+d:-d);b.set(e-m,u-w),l.apply(b,b);var p=b.x,D=b.y;b.set(e,u-w),l.apply(b,b);var O=b.x,S=b.y,M=O-p,E=S-D;b.set(e,u),l.apply(b,b);var N=b.x,T=b.y,j=N+(N-O),C=T+(T-S),k=N-M,y=T-E,I=2*n;if(t[I+0]=p,t[I+1]=D,t[I+2]=O,t[I+3]=S,t[I+4]=O+M,t[I+5]=S+E,t[(I+=6)+0]=N,t[I+1]=T,t[(I+=2)+0]=k,t[I+1]=y,t[I+2]=N,t[I+3]=T,t[I+4]=N,t[I+5]=T,t[I+6]=N+M,t[I+7]=T+E,t[(I+=8)+0]=N,t[I+1]=T,t[(I+=2)+0]=j-M,t[I+1]=C-E,t[I+2]=j,t[I+3]=C,t[I+4]=j+M,t[I+5]=C+E,c){var A=Yn(p,D,O,S);Fe(A,a,v,g);var x=g[0],R=g[1],L=g[2],B=Yn(p,D,k,y);Fe(B,a,v,g);var P=g[0],F=g[1],_=g[2],U=P,z=F;f&vn.TOP||(U=1,z=_);var G=x,H=R;f&vn.RIGHT||(G=1,H=L);var V=P,W=F;f&vn.BOTTOM||(V=1,W=_);var Y=x,X=R;f&vn.LEFT||(Y=1,X=L);var K=.5*(X+H),J=.5*(z+W),Z=2*n,q=4*n;i[Z+0]=Y,i[Z+1]=U,r[q+0]=X,r[q+1]=z,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=0,i[Z+1]=U,r[q+0]=K,r[q+1]=z,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=G,i[Z+1]=U,r[q+0]=H,r[q+1]=z,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=0,i[Z+1]=0,r[q+0]=K,r[q+1]=z,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=Y,i[Z+1]=0,r[q+0]=X,r[q+1]=J,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=0,i[Z+1]=0,r[q+0]=X,r[q+1]=J,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=0,i[Z+1]=0,r[q+0]=H,r[q+1]=J,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=G,i[Z+1]=0,r[q+0]=H,r[q+1]=J,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=0,i[Z+1]=0,r[q+0]=K,r[q+1]=W,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=Y,i[Z+1]=V,r[q+0]=X,r[q+1]=W,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=0,i[Z+1]=V,r[q+0]=K,r[q+1]=W,r[q+2]=L,r[q+3]=_,q+=4,i[(Z+=2)+0]=G,i[Z+1]=V,r[q+0]=H,r[q+1]=W,r[q+2]=L,r[q+3]=_,Z+=2,q+=4}},Mu=function(t,n,i){var r=i.x0,e=i.x1,u=i.x2,s=i.x3,h=i.y0,o=i.y1,a=i.y2,f=i.y3,c=.5*(r+u),l=.5*(h+a),v=2*n;t[v+0]=r,t[v+1]=h,t[v+2]=.5*(r+e),t[v+3]=.5*(h+o),t[v+4]=e,t[v+5]=o,t[(v+=6)+0]=c,t[v+1]=l,t[(v+=2)+0]=.5*(r+s),t[v+1]=.5*(h+f),t[v+2]=c,t[v+3]=l,t[v+4]=c,t[v+5]=l,t[v+6]=.5*(e+u),t[v+7]=.5*(o+a),t[(v+=8)+0]=c,t[v+1]=l,t[(v+=2)+0]=s,t[v+1]=f,t[v+2]=.5*(s+u),t[v+3]=.5*(f+a),t[v+4]=u,t[v+5]=a},Eu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.clippingBuffer.update(),i.indexBuffer.update();var r=this.vertexOffset;return Du(i.clippings,r),Ou(i.indices,r,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexAndStep(n,t),this.updateColor(n,t),this.updateUv(n,t),this.updateText(n,t)},n.prototype.updateVertexAndStep=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s,o=n.stroke,a=o.enable?o.width:0,f=o.align,c=o.side,l=this.strokeAlign!==f||this.strokeWidth!==a||this.strokeSide!==c;(u||h||l)&&(this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.strokeWidth=a,this.strokeAlign=f,this.strokeSide=c,this.textSpacingHorizontal=NaN,t.vertexBuffer.update(),t.stepBuffer.update(),t.antialiasBuffer.update(),Su(t.vertices,this.vertexOffset,t.steps,t.antialiases,0,0,r,e,f,a,c,!0,n.transform.internalTransform,this.antialiasWeight,t.work,t.workStep))},n.prototype.updateUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r,t.uvBuffer.update();var e=this.toTextureUvs(i);Mu(t.uvs,this.vertexOffset,e)}},n}(Xn),Nu=function(){function t(){}return t.create=function(t,n,i,r,e){var u=Wn.getTextCount(n,t.workCount),s=u.vertexCount,h=u.indexCount,o=12+s,a=8+h;return i+o<t.vertexCapacity&&r+a<t.indexCapacity?new Eu(t,i,r,s,h,o,a,e).init(n):null},t}(),Tu=function(){en[St.IMAGE]=Nu.create,nn[St.IMAGE]=pu.deserialize},ju=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){return t.prototype.init.call(this,n),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateLabelVertex(n,t),this.updateLabelUv(n,t),this.updateText(n,t)},n.prototype.updateLabelVertex=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s;(u||h)&&(this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.textSpacingHorizontal=NaN)},n.prototype.updateLabelUv=function(t,n){this.texture=this.toTexture(n)},n}(Xn),Cu=function(){function t(){}return t.create=function(t,n,i,r,e){var u=Wn.getTextCount(n,t.workCount),s=u.vertexCount,h=u.indexCount,o=s,a=h;return i+o<t.vertexCapacity&&r+a<t.indexCapacity?new ju(t,i,r,s,h,o,a,e).init(n):null},t}(),ku=function(t){function n(n){return void 0===n&&(n=St.LABEL),t.call(this,n)||this}return i(n,t),n.prototype.clone=function(){return(new n).copy(this)},n}(_n),yu=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new ku)},t}(),Iu=function(){en[St.LABEL]=Cu.create,nn[St.LABEL]=yu.deserialize},Au=function(t,n){for(var i=0,r=t.length-1;i<=r;){var e=i+(r-i>>1),u=t[e];if(n<u)r=e-1;else{if(!(u<n))return e;i=e+1}}return-1},xu=function(t){function n(n,i,r,e,u,s,h,o,a,f){var c=t.call(this,n,i,r,e,u,s,h,o)||this;return c.pointId=NaN,c.pointCount=a,c.pointsClosed=f,c.length=1,c}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer,r=this.vertexOffset,e=this.indexOffset,u=this.pointCount,s=this.pointsClosed;if(2<=u){i.clippingBuffer.update();var h=i.clippings;i.indexBuffer.update();var o=i.indices,a=3*r,f=3*e,c=r;s||(h[a+0]=1,h[a+1]=0,h[a+2]=3,h[a+3]=0,h[a+4]=1,h[a+5]=5,a+=6,o[f+0]=c+0,o[f+1]=c+2,o[f+2]=c+1,o[f+3]=c+1,o[f+4]=c+2,o[f+5]=c+3,c+=2,f+=6);for(var l=s?0:1,v=u-l;l<v;++l)h[a+0]=1,h[a+1]=0,h[a+2]=3,h[a+3]=0,h[a+4]=1,h[a+5]=5,h[a+6]=1,h[a+7]=0,h[a+8]=4,h[a+9]=0,h[a+10]=1,h[a+11]=6,a+=12,o[f+0]=c+0,o[f+1]=c+2,o[f+2]=c+1,o[f+3]=c+1,o[f+4]=c+2,o[f+5]=c+3,o[f+6]=c+2,o[f+7]=c+4,o[f+8]=c+3,o[f+9]=c+3,o[f+10]=c+4,o[f+11]=c+5,c+=4,f+=12;h[a+0]=1,h[a+1]=0,h[a+2]=3,h[a+3]=0,h[a+4]=1,h[a+5]=5}return this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;if(null!=i&&2<=i.length){var r=i.id,e=r!==this.pointId,u=t.stroke,s=u.enable?u.width:0,h=s!==this.strokeWidth,o=this.toTransformLocalId(t),a=this.transformLocalId!==o;if(e||a||h){this.pointId=r,this.strokeWidth=s,this.transformLocalId=o,n.vertexBuffer.update(),n.stepBuffer.update(),n.antialiasBuffer.update(),n.colorFillBuffer.update(),(e||a)&&(this.textSpacingHorizontal=NaN),e&&(this.textureTransformId=NaN);var f=this.vertexOffset,c=this.vertexCount-this.textVertexCount;this.updateLineVertexStepAndColorFill(n,i,s,t.transform.internalTransform,f,c)}}this.updateColor(n,t),this.updateLineUv(n,t),this.updateText(n,t)},n.prototype.updateColorFillAndStroke=function(t,n,i){this.updateColorStroke(t,n,i)},n.prototype.isCompatible=function(n){if(t.prototype.isCompatible.call(this,n)){var i=n.points;return i?this.pointCount===i.length&&this.pointsClosed===!!(i.style&rn.CLOSED):0===this.pointCount&&!1===this.pointsClosed}return!1},n.prototype.updateLineVertexStepAndColorFill=function(t,n,i,r,e,u){var s=2*e,h=4*e,o=t.vertices,a=t.steps,f=t.antialiases,c=t.colorFills,l=n.length,v=n.values,b=n.segments,g=n.style,d=0!=(g&rn.CLOSED),m=sn.toScaleInvariant(g),w=0,p=0,D=0,O=0,S=0,M=0,E=0,N=0,T=0,j=0,C=0,k=0,y=!1,I=!1,A=4*e,x=0,R=t.work;R.set(v[0],v[1]),r.apply(R,R);var L=R.x,B=R.y,P=0<=Au(b,0),F=l-1<<1;R.set(v[F+0],v[F+1]),r.apply(R,R);var _=R.x,U=R.y,z=0<=Au(b,l-1),G=_,H=U,V=z;2<l&&(R.set(v[2],v[3]),r.apply(R,R),G=R.x,H=R.y,V=0<=Au(b,1)),d?(T=_,j=U,C=L,k=B,y=z,I=P):(E=L-(G-L),N=B-(H-B),y=P,I=V,D+=Yn(T=L,j=B,C=G,k=H),o[s+0]=T,o[s+1]=j,o[s+2]=T,o[s+3]=j,a[s+0]=i,a[s+1]=m,a[s+2]=i,a[s+3]=m,f[h+0]=E,f[h+1]=N,f[h+2]=C,f[h+3]=k,f[h+4]=E,f[h+5]=N,f[h+6]=C,f[h+7]=k,c[h+0]=S,c[h+4]=S,s+=4,h+=8);for(var W=l-($=d?0:1);$<W;++$){if(E=T,N=j,T=C,j=k,y=I,$===l-2)C=_,k=U,I=z;else if(0===$)C=G,k=H,I=V;else if($<l-1){var Y=$+1<<1;R.set(v[Y+0],v[Y+1]),r.apply(R,R),C=R.x,k=R.y,I=0<=Au(b,$+1)}else C=L,k=B,I=P;p=w,w=D,D+=Yn(T,j,C,k);var X=C,K=k,J=x;if(y){E=T-(C-T),N=j-(k-j),M=Math.max(M,S),O=p-x,sn.toDash(O,i,g,R);for(var Z=R.x,q=R.y,Q=A;Q<h+8;Q+=4)c[Q+1]=Z,c[Q+2]=q,c[Q+3]=O;A=h+8,J=x,x=w}else I&&(X=T+(T-E),K=j+(j-N));o[s+0]=T,o[s+1]=j,o[s+2]=T,o[s+3]=j,a[s+0]=i,a[s+1]=m,a[s+2]=i,a[s+3]=m,f[h+0]=E,f[h+1]=N,f[h+2]=X,f[h+3]=K,f[h+4]=E,f[h+5]=N,f[h+6]=X,f[h+7]=K,O=w-J,c[h+0]=O,c[h+4]=O,h+=8,o[(s+=4)+0]=T,o[s+1]=j,o[s+2]=T,o[s+3]=j,a[s+0]=i,a[s+1]=m,a[s+2]=i,a[s+3]=m,f[h+0]=E,f[h+1]=N,f[h+2]=X,f[h+3]=K,f[h+4]=E,f[h+5]=N,f[h+6]=X,f[h+7]=K,S=w-x,c[h+0]=S,c[h+4]=S,s+=4,h+=8}if(E=T,N=j,T=C,j=k,y=I,d?(C=G,k=H,I=V):(C=T+(T-E),k=j+(j-N),I=!1),p=w,w=D,X=C,K=k,J=x,y){for(E=T-(C-T),N=j-(k-j),M=Math.max(M,S),O=p-x,sn.toDash(O,i,g,R),Z=R.x,q=R.y,Q=A;Q<h+8;Q+=4)c[Q+1]=Z,c[Q+2]=q,c[Q+3]=O;A=h+8,J=x,x=w}else I&&(X=T+(T-E),K=j+(j-N));if(o[s+0]=T,o[s+1]=j,o[s+2]=T,o[s+3]=j,a[s+0]=i,a[s+1]=m,a[s+2]=i,a[s+3]=m,f[h+0]=E,f[h+1]=N,f[h+2]=X,f[h+3]=K,f[h+4]=E,f[h+5]=N,f[h+6]=X,f[h+7]=K,O=w-J,M=Math.max(M,O),c[h+0]=O,c[h+4]=O,s+=4,h+=8,this.length=M,A<h)if(sn.toDash(O,i,g,R),Z=R.x,q=R.y,d)for(var $=A;$<h;$+=4)c[$+1]=Z,c[$+2]=q,c[$+3]=-1;else for($=A;$<h;$+=4)c[$+1]=Z,c[$+2]=q,c[$+3]=O},n.prototype.updateLineUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r;var e=this.pointCount;if(2<=e){var u=this.toTextureUvs(i),s=u.x0,h=u.x1,o=u.x2,a=u.x3,f=u.y0,c=u.y1,l=u.y2,v=u.y3,b=h-s,g=c-f,d=o-a,m=l-v;t.uvBuffer.update();var w=t.uvs,p=t.colorFills,D=this.pointsClosed,O=this.vertexOffset,S=2*O,M=4*O,E=1/Math.max(1e-5,this.length),N=0;D||(N=p[M]*E,w[S+0]=s+N*b,w[S+1]=f+N*g,w[S+2]=a+N*d,w[S+3]=v+N*m,S+=4,M+=8);for(var T=D?0:1,j=e-T;T<j;++T)N=p[M]*E,w[S+0]=s+N*b,w[S+1]=f+N*g,w[S+2]=a+N*d,w[S+3]=v+N*m,S+=4,N=p[M+=8]*E,w[S+0]=s+N*b,w[S+1]=f+N*g,w[S+2]=a+N*d,w[S+3]=v+N*m,S+=4,M+=8;N=p[M]*E,w[S+0]=s+N*b,w[S+1]=f+N*g,w[S+2]=a+N*d,w[S+3]=v+N*m}}},n}(Xn),Ru=function(){function t(){}return t.create=function(t,n,i,r,e){var u=n.points,s=!!u&&0!=(u.style&rn.CLOSED),h=u?u.length:0,o=Wn.getTextCount(n,t.workCount),a=o.vertexCount,f=o.indexCount,c=a,l=f;return 2<=h&&(s?(c+=4*h+2,l+=4*h):(c+=4*(h-2)+2+2,l+=4*(h-2)+2)),i+c<t.vertexCapacity&&r+l<t.indexCapacity?new xu(t,i,r,a,f,c,l,e,h,s).init(n):null},t}(),Lu=function(){function n(n,i,r,e){var u=[],s=0,h=0,o=0,a=0,f=i.length;if(2<=f){s=h=i[0],o=a=i[1];for(var c=2;c<f;c+=2){var l=i[c],v=i[c+1];s=Math.min(s,l),h=Math.max(h,l),o=Math.min(o,v),a=Math.max(a,v)}}var b=.5*(h+s),g=.5*(a+o);for(c=0;c<f;c+=2)l=i[c+0]-b,v=i[c+1]-g,u.push(l,v);var d=h-s,m=a-o;this.Bn=n,this.Xi=void 0,this.Ki=u.length,this.Pn=u,this.Fn=r.slice(0),this.Ji=new t.Point(d,m),this.size=new t.Point(d,m),this.position=new t.Point(b,g),this.xt=0,this.Xt=e}return Object.defineProperty(n.prototype,"length",{get:function(){return this.Pn.length>>1},enumerable:!0,configurable:!0}),n.prototype.fitToParentSize=function(){var t=this.size,n=this.Bn.size,i=n.x,r=n.y;if(1e-5<Math.abs(i-t.x)||1e-5<Math.abs(r-t.y)){t.set(i,r);var e=this.Ji,u=1e-5<Math.abs(e.x),s=1e-5<Math.abs(e.y);if(u||s){var h=u?i/e.x:1,o=s?r/e.y:1,a=this.Pn,f=this.Xi;if(null==f){f=[],this.Xi=f;for(var c=0,l=this.length<<1;c<l;c+=2){var v=a[c],b=a[c+1];a[c]=v*h,a[c+1]=b*o,f.push(v,b)}}else for(c=0,l=this.length<<1;c<l;c+=2)a[c]=f[c]*h,a[c+1]=f[c+1]*o;this.xt+=1}}},Object.defineProperty(n.prototype,"id",{get:function(){return this.fitToParentSize(),this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){return this.fitToParentSize(),this.Pn},set:function(t){this.set(t,void 0,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"segments",{get:function(){return this.Fn},set:function(t){this.set(void 0,t,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this.Xt},set:function(t){this.set(void 0,void 0,t)},enumerable:!0,configurable:!0}),n.prototype.copy=function(t){return this.set(t.values,t.segments,t.style)},n.prototype.set=function(t,n,i){var r=!1,e=!1;if(null!=t){var u=this.Pn,s=this.Ki,h=t.length,o=Math.min(h,s);if(this.Xi=void 0,u!==t){for(var a=0;a<o;++a)u[a]=t[a];for(a=o;a<h;++a)u.push(t[a]);s!==h?(u.length=h,this.Ki=h,r=!0):e=!0}else s!==h?(this.Ki=h,r=!0):e=!0}if(null!=n){var f=this.Fn;if(f!==n){var c=n.length;for(o=Math.min(f.length,c),a=0;a<o;++a)f[a]=n[a];for(a=o;a<c;++a)f.push(n[a]);f.length!==c&&(f.length=c)}e=!0}if(null!=i){var l=this.Xt;l!==i&&(this.Xt=i,(l&rn.CLOSED)!=(i&rn.CLOSED)?r=!0:e=!0)}if(r){this.xt+=1;var v=this.Bn;v.uploaded=void 0,v.toDirty()}else e&&(this.xt+=1,this.Bn.updateUploaded());return this},n.prototype.clone=function(t){return new n(t,this.Pn,this.Fn,this.Xt)},n.prototype.toPoints=function(n){for(var i=[],r=this.values,e=0,u=r.length;e<u;e+=2){var s=new t.Point(r[e+0],r[e+1]);i.push(n.apply(s,s))}return i},n.prototype.serialize=function(t){return t.add("["+JSON.stringify(this.Pn)+","+JSON.stringify(this.Fn)+","+this.Xt+"]")},n.prototype.calcHitPointAbs=function(t,i,r,e,u,s,h,o){var a=this.length;if(2<=a){var f=this.Pn,c=this.Fn,l=0,v=a;if(s){var b=s(t,i,u,f,n.WORK_RANGE);l=b[0],v=b[1]}for(var g=l,d=Math.min(v,a-1),m=2*l;g<d;g+=1,m+=2)if(Au(c,g+1)<0&&h(t,i,f[m+0],f[m+1],f[m+2],f[m+3],g,u,o))return!0;if(2<a&&a<=v&&this.style&rn.CLOSED&&Au(c,0)<0&&h(t,i,f[0+(m=(g=a-1)<<1)],f[m+1],f[0],f[1],g,u,o))return!0}return!1},n.WORK_RANGE=[0,0],n}(),Bu=function(t){function n(i,r,e,u){var s=t.call(this,St.LINE)||this;return i instanceof n?s.copy(i):(s.fill.enable=!1,s.stroke.set(!0,void 0,void 0,e),s.points=new Lu(s,i,r,u),s.transform.position.copyFrom(s.points.position),s.size.copyFrom(s.points.size)),s}return i(n,t),n.prototype.clone=function(){return new n(this)},n}(Un),Pu=function(){function t(){}return t.toStrokeWidth=function(t,n){if(0<=t&&t<n.length)try{return JSON.parse(n[t])[3]}catch(t){}return 8},t.deserialize=function(n,i){var r=i.resources,e=n[15];if(0<=e&&e<r.length){var u=i.extensions.get(e);null==u&&(u=JSON.parse(r[e]),i.extensions.set(e,u));var s=t.create(u[0],u[1],Sn.STROKE_WIDTH,u[2]);return Re.deserialize(n,i,s)}return null},t.create=function(t,n,i,r){return new Bu(t,n,i,r)},t}(),Fu=function(){en[St.LINE]=Ru.create,nn[St.LINE]=Pu.deserialize},_u=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.isCompatible=function(n){if(t.prototype.isCompatible.call(this,n)){var i=n.points;return null==i||0===i.length}return!1},n}(ju),Uu=function(){function t(){}return t.create=function(t,n,i,r,e,u,s,h){var o=Wn.getTextCount(n,t.workCount),a=o.vertexCount,f=o.indexCount,c=n.points,l=c?c.length:0,v=l*r+a,b=l*u+f;return i+v<t.vertexCapacity&&e+b<t.indexCapacity?0<l?new h(t,i,e,a,f,v,b,s,l).init(n):new _u(t,i,e,a,f,a,f,s).init(n):null},t}(),zu=function(t,n,i,r){for(var e=n+i,u=1;u<r;++u){for(var s=3*e,h=3*n,o=0;o<i;++o)t[s+0]=t[h+0],t[s+1]=t[h+1],t[s+2]=t[h+2],s+=3,h+=3;e+=i}},Gu=function(t,n,i,r,e){for(var u=n,s=i+r,h=1;h<e;++h){for(var o=3*s,a=3*i,f=0;f<r;++f)t[o+0]=t[a+0]+u,t[o+1]=t[a+1]+u,t[o+2]=t[a+2]+u,o+=3,a+=3;u+=n,s+=r}},Hu=function(t,n,i,r,e){for(var u=i+r,s=1;s<e;++s){for(var h=u<<1,o=i<<1,a=u<<2,f=i<<2,c=0;c<r;++c)t[h]=t[o],t[h+1]=t[o+1],n[a]=n[f],n[a+1]=n[f+1],n[a+2]=n[f+2],n[a+3]=n[f+3],h+=2,o+=2,a+=4,f+=4;u+=r}},Vu=function(t,n,i,r){for(var e=n+i,u=1;u<r;++u){for(var s=e<<1,h=n<<1,o=0;o<i;++o)t[s]=t[h],t[s+1]=t[h+1],s+=2,h+=2;e+=i}},Wu=function(t,n,i,r,e,u){for(var s=n.a,h=n.b,o=n.c,a=n.d,f=e-1,c=i+f*r;0<=f;--f){for(var l=f<<1,v=u[l],b=u[l+1],g=s*v+o*b,d=h*v+a*b,m=c<<1,w=i<<1,p=0;p<r;++p)t[m]=t[w]+g,t[m+1]=t[w+1]+d,m+=2,w+=2;c-=r}},Yu=function(t){return c(t)||null==t},Xu=function(t,n,i){return c(n)?n:u(n)?n(t):n?n[t%n.length]:i},Ku=function(){function t(t){this.Bn=t,this.xt=0,this.h=null,this.o=null}return Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.set(t,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.set(void 0,t)},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n){var i=!1;void 0!==t&&this.h!==t&&(i=!0,this.h=t),void 0!==n&&this.o!==n&&(i=!0,this.o=n),i&&(this.xt+=1,this.Bn.updateUploaded())},t.prototype.getColor=function(t,n){return Xu(t,this.h,n)},t.prototype.getAlpha=function(t,n){return Xu(t,this.o,n)},t.prototype.isStaticColor=function(){return Yu(this.h)},t.prototype.isStaticAlpha=function(){return Yu(this.o)},t.prototype.toDirty=function(){this.xt+=1},t}(),Ju=function(){function n(n,i,r,e,u){this.id=n,this.ref=0;var s=u.resolution;this.frame=new t.Rectangle(0,0,i*s,r*s),this.texture=new t.Texture(u,new t.Rectangle(0,0,1,1)),this.width=i,this.height=r,this.strokeWidth=e}return n.prototype.applyFrame=function(){var t=1/this.texture.baseTexture.resolution;this.texture.frame.x=this.frame.x*t,this.texture.frame.y=this.frame.y*t,this.texture.frame.width=this.width,this.texture.frame.height=this.height,this.texture.updateUvs(),this.texture.emit("update",this)},n.prototype.destroy=function(){this.texture.destroy()},n}(),Zu=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(t){},n}(Ju),qu=function(t){function n(n,i){var r=t.call(this,n.id,n.width/i.resolution,n.height/i.resolution,0,i)||this;return r.canvas=n.canvas,r}return i(n,t),n.prototype.render=function(t){var n=this.canvas;if(null!=n){var i=this.frame;t.drawImage(n,i.x,i.y,i.width,i.height)}},n}(Ju),Qu=function(t){function n(n,i){var r=t.call(this,n.src,n.width/i.resolution,n.height/i.resolution,0,i)||this;return r.image=n,r}return i(n,t),n.prototype.render=function(t){var n=this.frame,i=n.x,r=n.y,e=n.width,u=n.height,s=this.image;t.drawImage(s,i,r,e,u),t.drawImage(s,0,0,1,u,i-1,r-1,1,u+2),t.drawImage(s,0,0,e,1,i,r-1,e,1),t.drawImage(s,e-1,0,1,u,i+e,r-1,1,u+2),t.drawImage(s,0,u-1,e,1,i,r+u,e,1)},n}(Ju),$u=function(t){function n(n,i,r){var e=t.call(this,n,i.width,i.height,0,r)||this;return e.qt=i,e}return i(n,t),n.prototype.render=function(t){var n=this.frame;t.drawImage(this.qt.canvas,n.x,n.y,n.width,n.height)},n}(Ju),ts=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.render=function(t){var n=this.frame;t.save(),t.fillStyle="#ffffff",t.fillRect(n.x-1,n.y-1,n.width+2,n.height+2),t.restore()},n}(Ju),ns=function(){function n(n){var i=this.ji=document.createElement("canvas");i.width=i.height=256;var r=this.Zi=t.BaseTexture.from(i,{mipmap:t.MIPMAP_MODES.OFF,resolution:n});this.qi={},this.Qi=[],this.$i={empty:new Zu("empty",10,10,0,r),white:new ts("white",10,10,0,r)},this.B=!0}return n.prototype.updateFrames=function(t,n){for(var i=4,r=4,e=0,u=0,s=n.length;u<s;++u){var h=n[u];t<i+h.frame.width+4&&(i=4,r+=e+4,e=0),h.frame.x=0|i,h.frame.y=0|r,i+=h.frame.width+4,e=Math.max(e,h.frame.height)}for(var o=r+e+4,a=256;a<o;)a<<=1;return Math.min(4096,a)},n.prototype.renderFrames=function(t,n,i){var r=this.ji;r.width=t,r.height=n;var e=r.getContext("2d");if(null!=e)for(var u=0,s=i.length;u<s;++u)i[u].render(e)},n.prototype.applyFrames=function(t){for(var n=0,i=t.length;n<i;++n)t[n].applyFrame()},n.prototype.calcCanvasWidth=function(t){for(var n=128,i=t.length-1;0<=i;--i)for(var r=t[i],e=Math.max(r.frame.width,r.frame.height);n<e;)n<<=1;return Math.min(4096,n<<1)},n.prototype.cleanup=function(t){t.sort(n.ITEM_COMPARATOR);for(var i=t.length-1;0<=i;--i)if(0<t[i].ref)return void(t.length=i+1);t.length=0},n.prototype.begin=function(){for(var t=this.Qi,n=0,i=t.length;n<i;++n)t[n].ref=0;this.B=!1},n.prototype.end=function(){for(var t=this.qi,n=this.Qi,i=0,r=n.length;i<r;++i){var e=n[i];e.ref<=0&&(e.id in this.$i||e.destroy(),delete t[e.id],this.B=!0)}},n.prototype.repack=function(t){if(!0===t||this.B){this.B=!1;var n=this.Qi;this.cleanup(n);var i=this.calcCanvasWidth(n),r=this.updateFrames(i,n);this.renderFrames(i,r,n),this.Zi.setRealSize(i,r),this.applyFrames(n)}},n.prototype.get=function(t){var n=this.qi[t];if(null!=n)return n.ref+=1,n;var i=this.$i[t];return null!=i?(this.set(t,i),i):null},n.prototype.set=function(t,n){var i=this.qi[t];return n.ref+=1,this.qi[t]=n,this.Qi.push(n),this.B=!0,i},n.prototype.toDirty=function(){this.B=!0},n.prototype.getDefaultTexture=function(){return this.get("white").texture},n.prototype.getBaseTexture=function(){return this.Zi},n.prototype.release=function(t){var n=this.qi,i=n[t];null!=i&&(i.ref-=1,i.ref<=0&&(i.id in this.$i||i.destroy(),delete n[t],this.B=!0))},n.ITEM_COMPARATOR=function(t,n){return t.ref<=0?n.ref<=0?0:1:n.ref<=0?-1:t.frame.height<n.frame.height?-1:n.frame.height<t.frame.height?1:t.frame.width-n.frame.width},n}(),is=function(n,i,r,e){this.id=n,this.size=i,this.color=t.utils.hex2string(r),this.height=i+2*e;var u=t.TextMetrics.measureFont(n);this.ascent=u.ascent,this.descent=u.descent},rs=function(){function n(n,i,r,e){this.xt=n,this.ji=document.createElement("canvas"),this.tr=null,this.Ai=new is(n,i,r,3),this.xi={},this.Ri=0,this.nr=0,this.l=1,this.I=1,this.ir=0,this.rr=0,this.A=t.Texture.from(this.ji,{mipmap:t.MIPMAP_MODES.OFF,resolution:e,scaleMode:t.SCALE_MODES.NEAREST}),this.add(Pr,!0),this.er("...",this.xi,!0)}return Object.defineProperty(n.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"font",{get:function(){return this.Ai},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.l},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.I},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"canvas",{get:function(){return this.ji},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"characters",{get:function(){return this.xi},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"texture",{get:function(){return this.A},enumerable:!0,configurable:!0}),n.prototype.er=function(t,n,i){if("\n"!==t){var r=n[t];if(null!=r)r.reserved||(0===r.ref&&(this.nr-=1),r.ref+=1);else{var e=this.getAdvance(t),u=Math.ceil(3+e+3),s=this.font.height;n[t]=new _r(e,u,s,!!i),this.Ri+=1,this.ir+=1}}},n.prototype.ur=function(t,n){if("\n"!==t){var i=n[t];null!=i&&!i.reserved&&0<i.ref&&(i.ref-=1,0===i.ref&&(this.nr+=1))}},n.prototype.sr=function(){if(this.Ri>>1<=this.nr){var t=this.xi;for(var n in t)t[n].ref<=0&&delete t[n];this.Ri-=this.nr,this.ir+=1,this.nr=0}},n.prototype.add=function(t,n){for(var i=this.xi,r=V.from(t);r.hasNext();)this.er(r.next(),i,n)},n.prototype.remove=function(t){for(var n=this.xi,i=V.from(t);i.hasNext();)this.ur(i.next(),n)},n.prototype.get=function(t){return this.xi[t]},n.prototype.getAdvance=function(t){var n=this.getContext();return null!=n?n.measureText(t).width:0},n.prototype.getContext=function(){var t=this.tr;if(null==t){var n=this.ji;if(null==n)return null;if(null==(t=this.tr=n.getContext("2d",{alpha:!0})))return null}var i=this.Ai;return t.font!==i.id&&(t.font=i.id,i.id=t.font,t.textAlign="left",t.textBaseline="alphabetic",t.lineWidth=0,t.lineCap="round",t.lineJoin="miter",t.miterLimit=0,t.fillStyle=i.color,t.strokeStyle="#0000ff"),t},n.prototype.update=function(){if(this.sr(),this.rr<this.ir){this.rr=this.ir;var t=this.ji;if(null!=t){var n=this.Ai,i=n.height,r=this.xi,e=this.l=this.toPowerOf2(Math.ceil(Math.sqrt(this.Ri))*i),u=Math.round(.5*(i-(n.ascent+n.descent))+n.ascent),s=0,h=0;for(var o in r)e<=s+(g=r[o]).width&&(s=0,h+=i),g.x=s,g.y=h,g.origin.x=s+3,g.origin.y=h+u,s+=g.width;var a=this.I=h+i,f=this.A.baseTexture,c=f.resolution,l=Math.ceil(e*c),v=Math.ceil(a*c);t.width=l,t.height=v;var b=this.getContext();if(null!=b){for(var o in b.save(),b.scale(c,c),b.clearRect(0,0,e,a),r){var g=r[o];b.fillText(o,g.origin.x,g.origin.y)}b.restore()}return f.setRealSize(l,v),!0}}return!1},n.prototype.getRevision=function(){return this.ir},n.prototype.getRevisionUpdate=function(){return this.rr},Object.defineProperty(n.prototype,"length",{get:function(){return this.Ri},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){null!=this.ji&&(this.ji=null);var t=this.xi;for(var n in t)delete t[n]},n.prototype.toPowerOf2=function(t){for(var n=32;n<t;)n<<=1;return n},n}(),es=function(t){t.update()},us=function(t){t.forEach(es)},ss=function(t){t.update()},hs=function(t){t.forEach(ss)},os=function(){function t(t){var n=this;this.hr=new Map,this.or=t.renderer.resolution,t.renderer.on("prerender",(function(){n.update()}))}return t.prototype.add=function(t,n,i,r){var e=this.hr,u=e.get(t);null==u&&(u=new Map,e.set(t,u));var s=u.get(i);null==s&&(s=new rs(t,n,i,this.or),u.set(i,s)),s.add(r)},t.prototype.remove=function(t,n,i){var r=this.hr.get(t);if(null!=r){var e=r.get(n);null!=e&&e.remove(i)}},t.prototype.get=function(t,n){var i=this.hr.get(t);if(null==i)return null;var r=i.get(n);return null==r?null:r},t.prototype.update=function(){this.hr.forEach(us)},t.prototype.destroy=function(){var t=this.hr;t.forEach(hs),t.clear()},t}(),as=function(){function t(){this.hr={}}return t.prototype.begin=function(){var t=this.hr;for(var n in t)t[n].begin()},t.prototype.end=function(){var t=this.hr;for(var n in t){var i=t[n];0<i.length&&i.addAscii(),i.end(),i.length<=0&&(i.destroy(),delete t[n])}},t.prototype.add=function(t,n){var i=this.hr[t];if(null!=i)i.add(n);else{var r=new zr(t);r.add(n),this.hr[t]=r}},t.prototype.get=function(t){var n=this.hr[t];return null!=n?n:null},t.prototype.update=function(t){var n=this.hr,i=t.getBaseTexture();for(var r in n){var e=n[r];if(e.update()){var u=e.id,s=t.get(u);if(null!=s){var h=e.width,o=e.height,a=i.resolution;s.frame.width=h,s.frame.height=o,s.width=h/a,s.height=o/a,t.toDirty()}else t.set(u,new qu(e,i))}}},t.prototype.destroy=function(){var t=this.hr;for(var n in t)t[n].destroy();this.hr={}},t}(),fs=function(t){return t!=t},cs=function(){function t(t,n,i){var r=this;this.instance=null,this.newInstance=t,this.options=n,null!=i&&(i.isActive()&&setTimeout((function(){r.get()}),0),i.on("active",(function(){r.get()})))}return t.prototype.get=function(){var t=this.instance;return null==t&&(t=this.instance=new this.newInstance(this.options)),t},t}(),ls=function(t,n,i,r){for(var e=0,u=Math.floor(t.length/i)-1;e<=u;){var s=e+(u-e>>1),h=t[s*i+r];if(n<h)u=s-1;else{if(!(h<n))return s;e=s+1}}return Math.max(e,u)},vs=function(t){return null!=t?String(t):""},bs=function(t){return"data:image/svg+xml;base64,"+btoa(t)},gs=function(n){function r(i,r){var e=n.call(this,new Image)||this;return e.ar=null,e.l=0,e.I=0,e.svg=i,t.resources.BaseImageResource.crossOrigin(e.source,e.svg,r&&r.crossorigin),r&&!1===r.autoLoad||e.load(),e}return i(r,n),r.prototype.load=function(){var t=this;return this.ar?this.ar:(this.ar=new Promise((function(n){var i=t.source;i.onerror=function(n){i.onerror=null,t.onError.run(n)},i.onload=function(){t.resize(i.width,i.height),n()},i.src=t.svg})),this.ar)},r.test=function(t,n){return"svg"===n||"string"==typeof t&&0===t.indexOf("data:image/svg+xml;base64")||"string"==typeof t&&0===t.indexOf("<svg")},r}(t.resources.BaseImageResource);t.resources.INSTALLED.push(gs);var ds,ms=function(){function n(t,n,i){this.l=t,this.cr=n,this.kn=i,this.lr={},this.vr="",this.br=0,this.gr=0,this.I=0}return Object.defineProperty(n.prototype,"width",{get:function(){return this.l},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"ratio",{get:function(){return this.cr},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"margin",{get:function(){return this.kn},enumerable:!0,configurable:!0}),n.prototype.add=function(n,i,r,e){var u=this.lr;if(!(n in u)){var s=this.kn,h=this.br,o=this.gr;this.l<=h+i?(h=0,o=this.gr+this.I+s,this.I=r,this.gr=o):this.I=Math.max(this.I,r),this.br=h+i+s,u[n]=new t.Rectangle(h,o,i,r);var a=this.cr;return this.vr+='<g transform="translate('+h*a+","+o*a+')">'+e+"</g>",!0}return!1},Object.defineProperty(n.prototype,"mappings",{get:function(){return this.build()},enumerable:!0,configurable:!0}),n.prototype.build=function(n){var i=this.dr;if(null==i||n&&n.force){var r=n&&null!=n.resolution?n.resolution:window.devicePixelRatio||1,e=this.l,u=Math.pow(2,Math.ceil(Math.log(this.gr+this.I)/Math.LN2)),s=e*r,h=u*r,o=this.cr,a=bs('<svg width="'+s+'" height="'+h+'" viewBox="0 0 '+e*o+" "+u*o+'" xmlns="http://www.w3.org/2000/svg">'+this.vr+"</svg>"),f=n&&null!=n.scaling?n.scaling:t.SCALE_MODES.NEAREST,c=t.BaseTexture.from(a,{resolution:r,scaleMode:f}),l=this.lr;for(var v in i=this.dr={},l)i[v]=new t.Texture(c,l[v])}return i},n}(),ws=function(){function n(){}return n.apply=function(t,n){var i=this;t.on(P.down,(function(r){if(r.target===t){var e=i.point;e.copyFrom(r.data.global),t.toLocal(e,void 0,e,!0);var u=e.x,s=e.y;(u<0||s<0||t.width<u||t.height<s)&&n(r)}}))},n.point=new t.Point,n}(),ps=function(){function t(t,n,i,r){this.dx=t,this.dy=n,this.ds=i,this.dt=r}return t.prototype.set=function(t,n,i,r){this.dx=t,this.dy=n,this.ds=i,this.dt=r},t}(),Ds=function(){function t(){}return t.LINEAR=function(t){return t},t.ELASTIC=function(t){return t*(3*(1-t)*(1-t)+t*(3*(1-t)+t))},t.QUAD_IN_OUT=function(t){return t<.5?2*t*t:(4-2*t)*t-1},t}(),Os=function(t){function n(n){var i=t.call(this)||this;return i.xt=null,i.It=null,i.mr=0,i.wr=null!=n&&null!=n.duration?n.duration:200,i.pr=1/Math.max(1,i.wr),i.xn=!1,i.Dr=null!=n?n.onTime:void 0,i.Or=function(){i.onTimeBase()},i.Sr=null!=n?n.onStart:void 0,i.Mr=null!=n?n.onEnd:void 0,i.Er=null!=n&&null!=n.timing?n.timing:Ds.ELASTIC,i}return i(n,t),Object.defineProperty(n.prototype,"target",{get:function(){return this.It},set:function(t){this.It=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return this.wr},set:function(t){this.wr=t,this.pr=1/Math.max(1,t)},enumerable:!0,configurable:!0}),n.prototype.start=function(t){void 0===t&&(t=!1),this.stop(),this.mr=Date.now(),this.xn=t,this.xt=window.setTimeout(this.Or,0),this.onStart(t);var n=this.wr,i=this.toTime(t?n:0);this.onTime(i,t,0)},n.prototype.onStart=function(t){var n=this.Sr;null!=n&&n(t,this),this.emit("start",t,this)},n.prototype.onTime=function(t,n,i){var r=this.Dr;null!=r&&r(t,n,i,this),this.emit("time",t,n,i,this)},n.prototype.onEnd=function(t){var n=this.Mr;null!=n&&n(t,this),this.emit("end",t,this)},n.prototype.isStarted=function(){return null!=this.xt},n.prototype.isReverse=function(){return this.xn},n.prototype.onTimeBase=function(){if(null!=this.xt){this.xt=null;var t=Date.now()-this.mr,n=this.wr,i=this.xn;if(t<n){this.xt=window.setTimeout(this.Or,0);var r=this.toTime(i?n-t:t);this.onTime(r,i,t)}else r=this.toTime(i?0:n),this.onTime(r,i,t),this.onEnd(i)}},n.prototype.toTime=function(t){return this.Er(t*this.pr,this)},n.prototype.stop=function(){var t=this.xt;null!=t&&(this.xt=null,window.clearTimeout(t))},n.prototype.end=function(){var t=this.xt;if(null!=t){this.xt=null,window.clearTimeout(t);var n=this.xn,i=Date.now()-this.mr,r=this.wr,e=this.toTime(n?0:r);this.onTime(e,n,i),this.onEnd(n)}},n}(t.utils.EventEmitter),Ss=function(){function t(t,n){var i=this;this.Nr=[],this.Tr=[],this.jr=0,this.Cr=-1,this.kr=0,this.yr=0,this.Ir=0,this.Ar=0,this.xr=new Os({onTime:function(t){i.onEase(t)},timing:Ds.LINEAR,duration:1e3});var r=n&&n.duration;r?c(r)?(this.Rr=r,this.Lr=r):(this.Rr=null!=r.position?r.position:1,this.Lr=null!=r.scale?r.scale:1):(this.Rr=1,this.Lr=1),this.Br=t}return t.prototype.onStart=function(){for(var n=this.Nr,i=n.length,r=t.HISTORY_CAPACITY;i<r;++i)n.push(new ps(0,0,1,0));this.jr=0,this.Cr=-1,this.xr.stop()},t.prototype.onMove=function(n,i,r,e){var u=t.HISTORY_CAPACITY,s=this.Cr,h=(s+1)%u;this.Cr=h;var o=this.jr;(h<s||0<=s&&s<o)&&(this.jr=(o+1)%u),this.Nr[h].set(n,i,r,e)},t.prototype.updateHistoriesSorted=function(t){var n=this.Nr,i=this.Tr,r=this.jr,e=this.Cr,u=n.length;if(e<0)return i.length=0,t;if(e<r){var s=t;i.length=0;for(var h=e;0<=h;--h){var o=n[h];if(!(s+o.dt<160))return s;s+=o.dt,i.push(o)}for(h=u-1;r<=h;--h){var a=n[h];if(!(s+a.dt<160))return s;s+=a.dt,i.push(a)}return s}for(s=t,i.length=0,h=e;r<=h;--h){var f=n[h];if(!(s+f.dt<160))return s;s+=f.dt,i.push(f)}return s},t.prototype.onEnd=function(t){var n=this.updateHistoriesSorted(t),i=this.Tr,r=i.length;if(0<r){for(var e=0,u=0,s=0,h=0,o=0;o<r;++o){var a=i[o];e+=a.dx,u+=a.dy,s+=a.ds,h+=a.dt}var f=(1-t/n)/r;e*=f,u*=f,s=1+(s-r)*f,h*=f,this.kr=e,this.yr=u,this.Ir=s,this.Ar=h;var c=40*this.Rr*Math.sqrt(e*e+u*u),l=1e4*this.Lr*Math.abs(s-1),v=this.xr;v.duration=Math.max(c,l),v.start()}},t.prototype.onEase=function(t){var n=1-t;this.Br(this.kr*n,this.yr*n,1+(this.Ir-1)*n,t)},t.prototype.stop=function(){this.xr.stop()},t.HISTORY_CAPACITY=5,t}();!function(t){t[t.NONE=0]="NONE",t[t.CTRL=1]="CTRL",t[t.SHIFT=2]="SHIFT",t[t.ALT=4]="ALT",t[t.AND=8]="AND",t[t.OR=16]="OR",t[t.NOT_NONE=23]="NOT_NONE"}(ds||(ds={}));var Ms,Es=function(){function t(){}return t.from=function(t){var n="data"in t?t.data.originalEvent:t;return(n.ctrlKey?ds.CTRL:ds.NONE)|(n.altKey?ds.ALT:ds.NONE)|(n.shiftKey?ds.SHIFT:ds.NONE)},t.match=function(n,i){return i&ds.OR?!!(t.from(n)&i):t.from(n)===i},t}(),Ns=function(){function n(n){var i=this,r=this.It=n.target,e=n.on;e&&(this.Sr=e.start,this.Br=e.move,this.Mr=e.end),this.Pr=n&&n.modifier||ds.NONE,this.Tn=function(t){var n=t&&t.checker,i=Es.match;return n?{start:n.start||i,move:n.move||i}:{start:i,move:i}}(n),this.Fr=null,this._r=new t.Point,this.ut=1,this.Ur=new t.Point,this.fi=0;var u=n.easing;null!=u&&!1===u||(this.zr=new Ss((function(t,n,r,e){i.onEasingMove(t,n,r,e)}),function(t){return null==t||!0===t?void 0:t}(u))),this.Gr=function(t){i.onDown(t)},this.Hr=function(t){i.onMove(t)},this.Vr=function(t){i.onEnd(t)},n.touch?(this.Wr="touchstart",this.Yr="touchmove",this.Xr="touchend"):(this.Wr=P.down,this.Yr=P.move,this.Xr=P.up),!1!==n.bind&&r.on(this.Wr,this.Gr)}return n.prototype.calcCenterAndScale=function(t,n,i){var r=t.data.originalEvent,e=t.data.global;if("touches"in r){var u=r.touches,s=u.length;if(0<s){for(var h=u[0],o=h.clientX,a=h.clientY,f=1,c=u.length;f<c;++f)o+=(v=u[f]).clientX,a+=v.clientY;if(o/=s,a/=s,i.mapPositionToPoint(n,o,a),1<s){var l=0;for(f=1,c=u.length;f<c;++f){var v,b=(v=u[f]).clientX-o,g=v.clientY-a;l=Math.max(l,b*b+g*g)}return Math.sqrt(l)}return 0}}return n.copyFrom(e),0},n.prototype.onDown=function(t){var n=this.It;if(this.Tn.start(t,this.Pr,n)){var i=e.getLayer(n);if(i)if(t.stopPropagation(),n.isDragging()){if(u=this.Fr){var r=this._r;this.ut=this.calcCenterAndScale(t,r,u)}}else{n.setDragging(!0);var u=i.renderer.plugins.interaction;this.Fr=u,r=this._r,this.ut=this.calcCenterAndScale(t,r,u),this.fi=t.data.originalEvent.timeStamp;var s=this.zr;s&&s.onStart();var h=this.Sr;null!=h&&h(),u.on(this.Yr,this.Hr),u.on(this.Xr,this.Vr)}}},n.prototype.onMove=function(t){var i=this.It;if(i.isDragging()&&this.Tn.move(t,this.Pr,i)){var r=this.Fr;if(r){var e=this._r,u=e.x,s=e.y,h=this.calcCenterAndScale(t,e,r),o=this.ut;this.ut=h;var a=this.fi,f=t.data.originalEvent.timeStamp;this.fi=f;var c=e.x-u,l=e.y-s,v=f-a,b=n.EPSILON<o?h/o:1,g=this.zr;g&&g.onMove(c,l,b,v);var d=this.Br;null!=d&&(0===c&&0===l&&1===b||d(c,l,e.x,e.y,b))}}},n.prototype.onEnd=function(t){var n=this.It;if(n.isDragging()){var i=this.Fr;if(i){var r=this._r;this.Ur.copyFrom(r),this.ut=this.calcCenterAndScale(t,r,i);var e=t.data.originalEvent;if(!("touches"in e)||e.touches.length<=0){n.setDragging(!1),this.Fr=null,i.off(this.Yr,this.Hr),i.off(this.Xr,this.Vr);var u=this.Mr;null!=u&&u();var s=this.zr;s&&s.onEnd(t.data.originalEvent.timeStamp-this.fi)}}}},n.prototype.onEasingMove=function(t,n,i,r){var e=this.Br;if(null!=e&&(0!==t||0!==n||1!==i)){var u=this.Ur;u.set(u.x+t,u.y+n),e(t,n,u.x,u.y,i)}},n.prototype.stop=function(){var t=this.zr;t&&t.stop()},n.EPSILON=1e-5,n}(),Ts=function(){function n(){}return n.toTexture=function(n,i,r,u){var s=t.RenderTexture.create({width:n.width,height:n.height,scaleMode:t.SCALE_MODES.LINEAR,resolution:i}),h=new t.Matrix(void 0,void 0,void 0,void 0,-n.position.x,-n.position.y),o=e.getLayer(n);return o&&o.renderer.render(n,s,r,h,u),s},n.toPixels=function(t,n){var i=t.resolution,r=t.frame,e=Math.floor(r.width*i),u=Math.floor(r.height*i),s=new Uint8Array(4*e*u);n.renderTexture.bind(t);var h=n.gl;return h.readPixels(r.x*i,r.y*i,e,u,h.RGBA,h.UNSIGNED_BYTE,s),{width:e,height:u,array:s}},n.toCanvas=function(n,i,r){var e=n.width,u=n.height,s=n.array,h=new t.utils.CanvasRenderTarget(e,u,1),o=h.context.getImageData(0,0,e,u);if(r?o.data.set(s):t.extract.Extract.arrayPostDivide(s,o.data),h.context.putImageData(o,0,0),null!=i&&1!==i){h.context.scale(i,i),h.context.drawImage(h.canvas,0,0);var a=Math.floor(e*i),f=Math.floor(u*i),c=h.context.getImageData(0,0,a,f);h.resize(a,f),h.context.putImageData(c,0,0)}return h.canvas},n.toBase64=function(t,n,i){return t.toDataURL(n,i)},n}(),js=function(){function t(){}return t.downloadUrl=function(t,n){var i=document.createElement("a");"download"in i?(i.href=n,i.setAttribute("download",t),i.style.display="none",document.body.appendChild(i),i.click(),setTimeout((function(){document.body.removeChild(i)}),66)):window.open(n)||(location.href=n)},t.download=function(t,n){var i=new Blob([n],{type:"text/plain"});window.navigator.msSaveBlob?window.navigator.msSaveBlob(i,t):this.downloadUrl(t,URL.createObjectURL(i))},t}(),Cs=function(){function t(){}return t.texture=function(t){var n=t.target,i=function(t){var n=t.target;return null!=t.resolution?c(t.resolution)?t.resolution:Math.min(1,t.resolution.size/Math.max(n.width,n.height)):window.devicePixelRatio||1}(t),r=function(t){return t.transform&&t.transform.update}(t);return Ts.toTexture(n,i,t.clear,r)},t.pixels=function(t){var n=function(t){if(t.renderer)return t.renderer;if(t.application)return t.application.getLayerBase().renderer;if(t.layer)return t.layer.renderer;var n=e.getLayer(t.target);if(n)return n.renderer;throw new Error("No renderer / application / layer found.")}(t);return Ts.toPixels(this.texture(t),n)},t.canvas=function(t){var n=this.pixels(t),i=function(t){return t.alpha&&t.alpha.premultiplied&&t.alpha.premultiplied.ignore}(t),r=function(t,n){if(null!=n.scale){if(c(n.scale))return n.scale;var i=n.scale.size;return Math.min(1,i/t.width,i/t.height)}}(n,t);return Ts.toCanvas(n,r,i)},t.base64=function(t){return Ts.toBase64(this.canvas(t),t.format,t.quality)},t.file=function(t){js.downloadUrl(t.filename,this.base64(t))},t}();!function(t){t[t.TEXT=0]="TEXT",t[t.DATA_URL=1]="DATA_URL",t[t.BINARY_STRING=2]="BINARY_STRING",t[t.ARRAY_BUTTER=3]="ARRAY_BUTTER"}(Ms||(Ms={}));var ks,ys=function(){function t(t,n){this.Kr=null,this.Jr=t,this.Zr=n}return t.prototype.open=function(){var t=this.getOrCreateInput();null!=t?t.click():this.onCancel()},t.prototype.getOrCreateInput=function(){var t=this;if("FileReader"in window&&null==this.Kr){var n=this.Kr=document.createElement("input");n.setAttribute("type","file"),n.setAttribute("style","display:none"),n.addEventListener("change",(function(i){t.onInputChange(n),n.value="",i.stopImmediatePropagation(),i.preventDefault()})),document.body.appendChild(n)}return this.Kr},t.prototype.onInputChange=function(t){var n=this,i=t.files;if(null!=i&&0<i.length){var r=i[0],e=new FileReader;switch(e.onload=function(t){if(null!=t.target){var i=t.target;n.onOpen(i.result)}},e.onabort=function(t){n.onAboart(t)},this.Jr){case Ms.TEXT:e.readAsText(r);break;case Ms.DATA_URL:e.readAsDataURL(r);break;case Ms.BINARY_STRING:e.readAsBinaryString(r);break;case Ms.ARRAY_BUTTER:e.readAsArrayBuffer(r);break;default:e.readAsText(r)}}else this.onCancel()},t.prototype.onOpen=function(t){var n=this.Zr;n.emit("open",t,n)},t.prototype.onAboart=function(t){var n=this.Zr;n.emit("abort",t,n)},t.prototype.onCancel=function(){var t=this.Zr;t.emit("cancel",t)},t}(),Is=function(){function t(){}return t.fromRgb=function(t){var n=(16711680&t)>>16,i=(65280&t)>>8,r=255&t|0,e=Math.max(n,i,r),u=e-Math.min(n,i,r),s=0;return 0<u&&(n===e?s=60*(i-r)/u:i===e?s=60*(r-n)/u+120:r===e&&(s=60*(n-i)/u+240),s<0&&(s+=360)),[s,u/e*255,e]},t.toRgb=function(t,n,i){var r=i-n/255*i,e=i-r,u=0,s=0,h=0;return t<=60?(u=i,s=t/60*e+r,h=r):t<=120?(u=(120-t)/60*e+r,s=i,h=r):t<=180?(u=r,s=i,h=(t-120)/60*e+r):t<=240?(u=r,s=(240-t)/60*e+r,h=i):t<=300?(u=(t-240)/60*e+r,s=r,h=i):(u=i,s=r,h=(360-t)/60*e+r),(u=Math.max(0,Math.min(255,u)))<<16|(s=Math.max(0,Math.min(255,s)))<<8|Math.max(0,Math.min(255,h))},t}(),As=function(){function t(){}return t.create=function(t){var n=this.qr;return t in n?t+" "+ ++n[t]:(n[t]=1,t+" 1")},t.qr={},t}(),xs=function(){function t(t){this.Qr=null,this.$r=null==t||null==t.parent?e.last():null}return Object.defineProperty(t.prototype,"picked",{get:function(){return this.Qr},enumerable:!0,configurable:!0}),t.prototype.pick=function(t){var n=this.Qr;if(null==n){if(!(n=e.getLayerOverlay(t))){var i=this.$r;n=i?i.getLayerOverlay():e.last().getLayerOverlay()}this.Qr=n}return n},t}(),Rs=function(){function t(){}return t.IDENTITY=function(){},t}(),Ls=function(){function t(){}return t.toCode=function(t,n){return"rgba("+(t>>16&255)+","+(t>>8&255)+","+(255&t)+","+n+")"},t}(),Bs=function(){function n(){this.te=new Map,this.ne='fill="#fff" stroke="none"',this.ie=new Map,this.re=function(t){return'fill="none" stroke="#fff" stroke-width="'+t+'"'},this.ee=function(){e.update()}}return n.prototype.toCornerTl=function(t,n,i){return 0<i?"A"+i+" "+i+" 0 0 1 "+(t+i)+" "+t:""},n.prototype.toCornerBr=function(t,n,i){return 0<i?"A"+i+" "+i+" 0 0 1 "+(t+n-i)+" "+(t+n):""},n.prototype.make=function(t,n,i){var r=Math.max(0,t-n),e=2*r+4,u=e+2*n,s="M"+(n+r)+" "+n+"L"+(n+e)+" "+n+"L"+(n+e)+" "+(n+e-r)+this.toCornerBr(n,e,r)+"L"+n+" "+(n+e)+"L"+n+" "+(n+r)+this.toCornerTl(n,e,r)+"Z";return this.toSvg(u,i,s)},n.prototype.toSvg=function(n,i,r){var e=window.devicePixelRatio||1,u='<svg width="'+n*e+'" height="'+n*e+'" viewBox="0 0 '+n+" "+n+'" xmlns="http://www.w3.org/2000/svg"><path '+i+' d="'+r+'"></path></svg>';return t.Texture.from(bs(u),{resolution:e})},n.prototype.newBackground=function(t){var n=this.make(t,0,this.ne);return n.on("update",this.ee),n},n.prototype.newBorder=function(t,n){var i=this.make(t,.5*n,this.re(n));return i.on("update",this.ee),i},n.prototype.getBackground=function(t){var n=this.te,i=n.get(t);return null==i&&(i=this.newBackground(t),n.set(t,i)),i},n.prototype.getBorder=function(t,n){var i=this.ie,r=i.get(t);null==r&&(r=new Map,i.set(t,r));var e=r.get(n);return null==e&&(e=this.newBorder(t,n),r.set(n,e)),e},n.getInstance=function(){return null==n.INSTANCE&&(n.INSTANCE=new n),n.INSTANCE},n.INSTANCE=null,n}(),Ps=function(){function n(){}return n.fromImage=function(n,i,r){var e=t.Texture.from(n,{resolution:i});e.baseTexture.valid?r(e):e.once("update",r)},n}(),Fs=function(){function t(t){this.wr=null!=t&&null!=t.duration?t.duration:300,this.ue=null,this.se=0,this.he=null}return t.prototype.show=function(t,n){var i=this,r=this.he;null!=r&&clearTimeout(r);var e=this.ue;if(t!==e){var u=this.wr,s=this.se,h=Date.now(),o=s+u-h;!0===n||o<=0?this.update(h,t):this.he=window.setTimeout((function(){i.update(Date.now(),t)}),o)}},t.prototype.update=function(t,n){var i=this.ue;i!==n&&(this.se=t,null!==i&&i.hide(),this.ue=n,null!=n&&n.show())},t.prototype.hide=function(){this.show(null)},t}(),_s=function(){function t(){this.oe=null,this.ae=0,this.fe=null,this.ce=null,this.le="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DOMMouseScroll","MozMousePixelScroll"]}return t.prototype.on=function(t,n,i){void 0===i&&(i=!1);for(var r=this.le,e=r.length-1;0<=e;--e){var u=r[e];t.addEventListener(u,n,i)}},t.prototype.off=function(t,n,i){void 0===i&&(i=!1);for(var r=this.le,e=r.length-1;0<=e;--e){var u=r[e];t.removeEventListener(u,n,i)}},t.prototype.getLineHeight=function(){if(null==this.fe){var t=L.getInstance().get("DBase");this.fe=t.getLineHeight()}return this.fe},t.prototype.getPageHeight=function(){return null==this.ce&&(this.ce=12*this.getLineHeight()),this.ce},t.prototype.normalize=function(t){var n=0,i=0;if("detail"in t&&(i=-1*t.detail),"wheelDelta"in t&&(i=t.wheelDelta),"wheelDeltaY"in t&&(i=t.wheelDeltaY),"wheelDeltaX"in t&&(n=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(n=-1*i,i=0),"deltaY"in t&&(i=-1*t.deltaY),"deltaX"in t&&(n=t.deltaX),0===i&&0===n)return null;var r=Math.max(Math.abs(i),Math.abs(n)),e=Date.now();this.ae+200<=e&&(this.oe=null),this.ae=e;var u="mousewheel"===t.type&&r%120==0;(!this.oe||r<this.oe)&&(this.oe=r,u&&(this.oe/=40)),u&&(r/=40,n/=40,i/=40);var s=this.oe;r=Math.floor(r/s),n=Math[1<=n?"floor":"ceil"](n/s),i=Math[1<=i?"floor":"ceil"](i/s);var h=t.deltaMode||0;if(0!==h){var o=1===h?this.getLineHeight():this.getPageHeight();r*=o,n*=o,i*=o}return{mode:h,delta:r,deltaX:n,deltaY:i,lowest:s}},t.getInstance=function(){return null==this.INSTANCE&&(this.INSTANCE=new t),this.INSTANCE},t}(),Us=function(){function t(t){this.Bn=t,this.xt=0,this._x=null,this._y=null,this.ve=null,this.be=0,this.ge=-1,this.de=0}return Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this.set(t,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this.set(void 0,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"limit",{get:function(){return this.ve},set:function(t){this.ve=t},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n){var i=!1;void 0!==t&&this._x!==t&&(i=!0,this._x=t),void 0!==n&&this._y!==n&&(i=!0,this._y=n),i&&(this.xt+=1,this.Bn.updateUploaded())},t.prototype.getX=function(t){return Xu(t,this._x,Sn.SIZE_X)},t.prototype.getY=function(t){return Xu(t,this._y,Sn.SIZE_Y)},t.prototype.getLimit=function(){var t=this.ve;return null!=t?t:(this.updateLimitComputed(),this.be)},t.prototype.updateLimitComputed=function(){var t=this.xt,n=this.Bn.length;this.ge===t&&this.de===n||(this.ge=t,this.de=n,this.be=Math.max(this.calcLimit(this._x,n,Sn.SIZE_X),this.calcLimit(this._y,n,Sn.SIZE_Y)))},t.prototype.calcLimit=function(t,n,i){if(c(t))return t;if(u(t)){if(0<n){for(var r=t(0),e=1;e<n;++e)r=Math.max(r,t(e));return r}return 0}if(null!=t){var s=t.length;if(0<s){for(r=t[0],e=1;e<s;++e)r=Math.max(r,t[e]);return r}return 0}return i},t.prototype.isStaticX=function(){return Yu(this._x)},t.prototype.isStaticY=function(){return Yu(this._y)},t.prototype.toDirty=function(){this.xt+=1},t}(),zs=function(){function t(t){this.Bn=t,this.xt=0,this.h=null,this.o=null}return Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.set(t,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.set(void 0,t)},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n){var i=!1;void 0!==t&&this.h!==t&&(i=!0,this.h=t),void 0!==n&&this.o!==n&&(i=!0,this.o=n),i&&(this.xt+=1,this.Bn.updateUploaded())},t.prototype.getColor=function(t,n){return Xu(t,this.h,n)},t.prototype.getAlpha=function(t,n){return Xu(t,this.o,n)},t.prototype.isStaticColor=function(){return Yu(this.h)},t.prototype.isStaticAlpha=function(){return Yu(this.o)},t.prototype.toDirty=function(){this.xt+=1},t}(),Gs=function(){function n(t){this.Bn=t,this.Pn=[],this.me=0,this.Fn=[],this._n=new Us(this),this.Ht=new Ku(t),this.we=new zs(t),this.xt=0}return Object.defineProperty(n.prototype,"length",{get:function(){return this.Pn.length>>1},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"values",{get:function(){return this.Pn},set:function(t){this.set(t,void 0,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"segments",{get:function(){return this.Fn},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return rn.NONE},set:function(t){this.set(void 0,void 0,t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"size",{get:function(){return this._n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"fill",{get:function(){return this.Ht},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"stroke",{get:function(){return this.we},enumerable:!0,configurable:!0}),n.prototype.copy=function(t){return this.set(t.values,t.segments,t.style)},n.prototype.set=function(t,n,i){var r=!1,e=!1;if(null!=t){var u=this.Pn,s=this.me,h=t.length;if(u!==t){for(var o=Math.min(s,h),a=0;a<o;++a)u[a]=t[a];for(a=o;a<h;++a)u.push(t[a]);s!==h?(u.length=h,this.me=h,r=!0):e=!0}else s!==h?(this.me=h,r=!0):e=!0}if(r){this.xt+=1;var f=this.Bn;f.uploaded=void 0,f.toDirty()}else e&&(this.xt+=1,this.Bn.updateUploaded());return this},n.prototype.updateUploaded=function(){this.Bn.updateUploaded()},n.prototype.clone=function(t){return new n(t)},n.prototype.toPoints=function(n){for(var i=[],r=this.values,e=0,u=r.length;e<u;e+=2){var s=new t.Point(r[e+0],r[e+1]);i.push(n.apply(s,s))}return i},n.prototype.serialize=function(t){return t.add("[]")},n.prototype.calcHitPointAbs=function(t,i,r,e,u,s){var h=this.length,o=this.Pn,a=this._n,f=0,c=h;if(e){var l=.5*a.getLimit(),v=e(t,i,l,l,r,o,n.WORK_RANGE);f=v[0],c=v[1]}u=u;for(var b=f,g=Math.min(c,h),d=f<<1;b<g;b+=1,d+=2){var m=o[d],w=o[d+1];if(u(t,i,.5*a.getX(b),.5*a.getY(b),m,w,b,r,s))return!0}return!1},n.WORK_RANGE=[0,0],n}(),Hs=function(t,n,i,r,e,u,s,h){if(u)if(i.isStaticColor()){var o=i.getColor(0,s);if(i.isStaticAlpha()){var a=i.getAlpha(0,h);Hn(o,a,t,n*r,e)}else for(var f=0,c=t;f<r;f+=1,c+=n)a=i.getAlpha(f,h),Hn(o,a,c,n,e)}else if(i.isStaticAlpha())for(a=i.getAlpha(0,h),f=0,c=t;f<r;f+=1,c+=n)o=i.getColor(f,s),Hn(o,a,c,n,e);else for(f=0,c=t;f<r;f+=1,c+=n)o=i.getColor(f,s),a=i.getAlpha(f,h),Hn(o,a,c,n,e);else if(i.isStaticColor())o=i.getColor(0,s),Hn(o,0,t,n*r,e);else for(f=0,c=t;f<r;f+=1,c+=n)o=i.getColor(f,s),Hn(o,0,c,n,e)},Vs=function(t){function n(n,i,r,e,u,s,h,o,a){var f=t.call(this,n,i,r,e,u,s,h,o)||this;return f.pointId=-1,f.pointCount=a,f.pointSizeId=-1,f.pointFillId=-1,f.pointStrokeId=-1,f}return i(n,t),n.prototype.isCompatible=function(n){if(t.prototype.isCompatible.call(this,n)){var i=n.points;return this.pointCount===(i?i.length:0)}return!1},n.prototype.updateLineOfAnyColorFill=function(t,n,i,r){var e=i.fill,u=e.id,s=u!==this.pointFillId,h=n.fill,o=n.visible&&h.enable,a=h.color,f=o?h.alpha:0,c=a!==this.colorFill||f!==this.alphaFill;(s||c)&&(this.colorFill=a,this.alphaFill=f,this.pointFillId=u,t.colorFillBuffer.update(),Hs(this.vertexOffset,r,e,this.pointCount,t.colorFills,o,a,f))},n.prototype.updateLineOfAnyColorStroke=function(t,n,i,r){var e=i.stroke,u=e.id,s=u!==this.pointStrokeId,h=n.stroke,o=n.visible&&h.enable,a=h.color,f=o?h.alpha:0,c=a!==this.colorStroke||f!==this.alphaStroke;(s||c)&&(this.colorStroke=a,this.alphaStroke=f,this.pointStrokeId=u,t.colorStrokeBuffer.update(),Hs(this.vertexOffset,r,e,this.pointCount,t.colorStrokes,o,a,f))},n}(Xn),Ws=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.clippingBuffer.update(),i.indexBuffer.update();var r=i.clippings,e=i.indices,u=this.vertexOffset,s=this.indexOffset,h=this.pointCount;return _e(r,u),Ue(e,u,s),zu(r,u,9,h),Gu(e,9,s,8,h),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Gs&&(this.updateVertexAndStep(n,t,i),this.updateLineOfAnyColorFill(n,t,i,9),this.updateLineOfAnyColorStroke(n,t,i,9),this.updateUv(n,t),this.updateText(n,t))},n.prototype.updateVertexAndStep=function(t,n,i){var r=i.id,e=r!==this.pointId,u=i.size,s=u.id,h=s!==this.pointSizeId,o=n.size,a=o.x,f=o.y,c=a!==this.sizeX||f!==this.sizeY,l=this.toTransformLocalId(n),v=this.transformLocalId!==l,b=n.stroke,g=b.enable?b.width:0,d=b.align,m=this.strokeAlign!==d||this.strokeWidth!==g;if(e||h||c||v||m){this.pointId=r,this.pointSizeId=s,this.sizeX=a,this.sizeY=f,this.transformLocalId=l,this.strokeWidth=g,this.strokeAlign=d,(c||v||m)&&(this.textSpacingHorizontal=NaN),t.vertexBuffer.update(),t.stepBuffer.update(),t.antialiasBuffer.update();var w=this.pointCount,p=i.values,D=this.vertexOffset,O=t.vertices,S=t.steps,M=t.antialiases,E=t.clippings,N=n.transform.internalTransform,T=this.antialiasWeight,j=t.work,C=t.workStep;if(u.isStaticX()&&u.isStaticY()){var k=u.getX(0),y=u.getY(0);ze(O,D,9,S,M,E,0,0,k,y,d,g,!0,N,T,j,C),Wu(O,N,D,9,w,p),Hu(S,M,D,9,w)}else for(var I=0;I<w;++I){var A=I<<1,x=p[A],R=p[A+1];k=u.getX(I),y=u.getY(I),ze(O,D+9*I,9,S,M,E,x,R,k,y,d,g,!0,N,T,j,C)}}},n.prototype.updateUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r,t.uvBuffer.update();var e=t.uvs,u=this.vertexOffset,s=this.toTextureUvs(i);Ge(u,s,e),Vu(e,u,9,this.pointCount)}},n}(Vs),Ys=function(){function t(){}return t.create=function(t,n,i,r,e){return Uu.create(t,n,i,9,r,8,e,Ws)},t}(),Xs=function(t,n){var i=t.stroke,r=t.points.size.getLimit()+(i.enable?i.width*i.align:0);return n?n(r,1):.5*r},Ks=function(t){function n(n){var i=t.call(this,St.LINE_OF_CIRCLES)||this;return n?i.copy(n):i.points=new Gs(i),i.pe=function(t,n,r,e,u,s){return i.containsPointAbs(t,n,r,e,u,s)},i.De=function(t,n,r,e,u,s){return i.containsPointAbsBBox(t,n,r,e,u,s)},i}return i(n,t),n.prototype.clone=function(){return new n(this)},n.prototype.containsAbs=function(t,n,i,r){var e=Xs(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.points.calcHitPointAbs(t,n,e,null,this.pe,null)},n.prototype.containsPointAbs=function(n,i,r,e,u,s){return t.prototype.containsAbs.call(this,n-u,i-s,r,e)},n.prototype.containsPointAbsBBox=function(n,i,r,e,u,s){return t.prototype.containsAbsBBox.call(this,n-u,i-s,r,e)},n.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,pn.WORK_RECT),s=Xs(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.points.calcHitPointAbs(u.x,u.y,s,i,r||this.pe,e)},n}(We),Js=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new Ks)},t}(),Zs=function(){en[St.LINE_OF_CIRCLES]=Ys.create,nn[St.LINE_OF_CIRCLES]=Js.deserialize};!function(t){t[t.NONE=0]="NONE",t[t.ID=1]="ID",t[t.POSITION=2]="POSITION",t[t.WIDTH=4]="WIDTH",t[t.HEIGHT=8]="HEIGHT",t[t.ROTATION=16]="ROTATION",t[t.SKEW=32]="SKEW",t[t.ALIGN=64]="ALIGN",t[t.REPLACING=128]="REPLACING",t[t.GROUPING=256]="GROUPING",t[t.FILL=512]="FILL",t[t.STROKE=1024]="STROKE",t[t.STROKE_SIDE=2048]="STROKE_SIDE",t[t.BORDER_RADIUS=4096]="BORDER_RADIUS",t[t.TEXT=8192]="TEXT",t[t.TEXTURE=16384]="TEXTURE",t[t.TAG=32768]="TAG",t[t.ACTION=65536]="ACTION",t[t.CURSOR=131072]="CURSOR",t[t.ORDER_IN_LAYER=262144]="ORDER_IN_LAYER",t[t.COORDINATE=127]="COORDINATE",t[t.SHAPE=1920]="SHAPE",t[t.SHAPE_ROUNDED=6016]="SHAPE_ROUNDED",t[t.SHAPE_SIDED=3968]="SHAPE_SIDED",t[t.SHAPE_SIDED_AND_ROUNDED=8064]="SHAPE_SIDED_AND_ROUNDED",t[t.LAYER=262144]="LAYER",t[t.PRIMITIVE=518143]="PRIMITIVE",t[t.SHADOW=0]="SHADOW",t[t.ALL=524287]="ALL"}(ks||(ks={}));var qs,Qs=function(){function t(){}return t.get=function(t){return this.mappings[t]||ks.PRIMITIVE},t.contains=function(t,n){if(null!=t){if(this.get(t.type)&n)return!0;for(var i=t.children,r=0,e=i.length;r<e;++r)if(this.contains(i[r],n))return!0}return!1},t.set=function(t,n){this.mappings[t]=n},t.mappings={},t}(),$s=[0,0,0],th=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+2,t[r+3]=n+1,t[r+4]=n+3,t[r+5]=n+2,t[(r+=6)+0]=n+4,t[r+1]=n+5,t[r+2]=n+6,t[r+3]=n+5,t[r+4]=n+7,t[r+5]=n+6,t[(r+=6)+0]=n+8,t[r+1]=n+9,t[r+2]=n+10,t[r+3]=n+9,t[r+4]=n+11,t[r+5]=n+10,t[(r+=6)+0]=n+12,t[r+1]=n+13,t[r+2]=n+14,t[r+3]=n+13,t[r+4]=n+15,t[r+5]=n+14,t[(r+=6)+0]=n+16,t[r+1]=n+17,t[r+2]=n+20,t[r+3]=n+17,t[r+4]=n+21,t[r+5]=n+20,t[(r+=6)+0]=n+17,t[r+1]=n+18,t[r+2]=n+21,t[r+3]=n+18,t[r+4]=n+22,t[r+5]=n+21,t[(r+=6)+0]=n+19,t[r+1]=n+21,t[r+2]=n+24,t[r+3]=n+21,t[r+4]=n+25,t[r+5]=n+24,t[(r+=6)+0]=n+21,t[r+1]=n+23,t[r+2]=n+26,t[r+3]=n+23,t[r+4]=n+27,t[r+5]=n+26,t[(r+=6)+0]=n+24,t[r+1]=n+25,t[r+2]=n+28,t[r+3]=n+25,t[r+4]=n+30,t[r+5]=n+28,t[(r+=6)+0]=n+26,t[r+1]=n+27,t[r+2]=n+30,t[r+3]=n+27,t[r+4]=n+32,t[r+5]=n+30,t[(r+=6)+0]=n+29,t[r+1]=n+30,t[r+2]=n+33,t[r+3]=n+30,t[r+4]=n+34,t[r+5]=n+33,t[(r+=6)+0]=n+30,t[r+1]=n+31,t[r+2]=n+34,t[r+3]=n+31,t[r+4]=n+35,t[r+5]=n+34},nh=function(t,n,i,r,e,u,s,h,o,a,f,c){var l=s*h,v=.5*e+(0<=e?+l:-l),b=.5*u+(0<=u?+l:-l),g=Math.abs(v),d=Math.abs(b),m=o*Math.min(g,d),w=m/g,p=m/d;c.set(i-v,r-b),a.apply(c,c);var D=c.x,O=c.y;c.set(i,r-b),a.apply(c,c);var S=c.x,M=c.y,E=S-D,N=M-O,T=w*E,j=w*N,C=D+T,k=O+j,y=S+E,I=M+N,A=y-T,x=I-j;c.set(i,r),a.apply(c,c);var R=c.x,L=c.y,B=R-S,P=L-M,F=p*B,_=p*P,U=S+F,z=M+_,G=U-E,H=z-N,V=G+T,W=H+j,Y=U+E,X=z+N,K=Y-T,J=X-j,Z=R-E,q=L-N,Q=R+E,$=L+N,tt=R+B,nt=L+P,it=tt-F,rt=nt-_,et=it-E,ut=rt-N,st=et+T,ht=ut+j,ot=it+E,at=rt+N,ft=ot-T,ct=at-j,lt=tt-E,vt=nt-N,bt=lt+T,gt=vt+j,dt=tt+E,mt=nt+N,wt=dt-T,pt=mt-j;f[0]=Yn(D,O,C,k),f[1]=Yn(D,O,S,M),f[2]=Yn(D,O,Z,q);var Dt=2*n;t[Dt+0]=D,t[Dt+1]=O,t[Dt+2]=C,t[Dt+3]=k,t[Dt+4]=G,t[Dt+5]=H,t[Dt+6]=V,t[Dt+7]=W,t[(Dt+=8)+0]=A,t[Dt+1]=x,t[Dt+2]=y,t[Dt+3]=I,t[Dt+4]=K,t[Dt+5]=J,t[Dt+6]=Y,t[Dt+7]=X,t[(Dt+=8)+0]=et,t[Dt+1]=ut,t[Dt+2]=st,t[Dt+3]=ht,t[Dt+4]=lt,t[Dt+5]=vt,t[Dt+6]=bt,t[Dt+7]=gt,t[(Dt+=8)+0]=ft,t[Dt+1]=ct,t[Dt+2]=ot,t[Dt+3]=at,t[Dt+4]=wt,t[Dt+5]=pt,t[Dt+6]=dt,t[Dt+7]=mt,t[(Dt+=8)+0]=C,t[Dt+1]=k,t[Dt+2]=S,t[Dt+3]=M,t[Dt+4]=A,t[Dt+5]=x,t[(Dt+=6)+0]=G,t[Dt+1]=H,t[Dt+2]=V,t[Dt+3]=W,t[Dt+4]=U,t[Dt+5]=z,t[Dt+6]=K,t[Dt+7]=J,t[Dt+8]=Y,t[Dt+9]=X,t[(Dt+=10)+0]=Z,t[Dt+1]=q,t[Dt+2]=R,t[Dt+3]=L,t[Dt+4]=R,t[Dt+5]=L,t[Dt+6]=Q,t[Dt+7]=$,t[(Dt+=8)+0]=et,t[Dt+1]=ut,t[Dt+2]=st,t[Dt+3]=ht,t[Dt+4]=it,t[Dt+5]=rt,t[Dt+6]=ft,t[Dt+7]=ct,t[Dt+8]=ot,t[Dt+9]=at,t[(Dt+=10)+0]=bt,t[Dt+1]=gt,t[Dt+2]=tt,t[Dt+3]=nt,t[Dt+4]=wt,t[Dt+5]=pt},ih=function(t,n,i,r){var e=3*n,u=1-r[0]/r[1],s=1-r[0]/r[2];i&ln.TOP_LEFT?(t[e+0]=1,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=1,e+=3):(t[e+0]=1,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,e+=3),i&ln.TOP_RIGHT?(t[e+0]=0,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=1,e+=3):(t[e+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,e+=3),i&ln.BOTTOM_LEFT?(t[e+0]=1,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=1,e+=3):(t[e+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,e+=3),i&ln.BOTTOM_RIGHT?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=1,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=1,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=1,e+=3):(t[e+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=1,t[e+2]=0,e+=3),t[e+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=s,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=0,t[e+1]=1,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=1,t[e+2]=0,e+=3},rh=function(t,n,i,r,e,u,s,h,o){Fe(h[0],r,s,o);var a=o[0],f=o[1],c=o[2];Fe(h[1],r,s,o);var l=o[0],v=o[1],b=o[2];Fe(h[2],r,s,o);var g=o[0],d=o[1],m=o[2],w=2*i,p=4*i,D=1-h[0]/h[1],O=1-h[0]/h[2],S=g,M=d,E=a,N=f;e&vn.TOP||(S=1,M=m,E=1,N=c);var T=l,j=v,C=a,k=f;e&vn.RIGHT||(T=1,j=b,C=1,k=c);var y=g,I=d,A=a,x=f;e&vn.BOTTOM||(y=1,I=m,A=1,x=c);var R=l,L=v,B=a,P=f;e&vn.LEFT||(R=1,L=b,B=1,P=c);var F=.5*(L+j),_=.5*(M+I);u&ln.TOP_LEFT?(t[w+0]=B,t[w+1]=E,n[p+0]=P,n[p+1]=N,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=0,t[w+1]=E,n[p+0]=P,n[p+1]=N,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=B,t[w+1]=0,n[p+0]=P,n[p+1]=N,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=0,t[w+1]=0,n[p+0]=P,n[p+1]=N,n[p+2]=c,n[p+3]=c,w+=2,p+=4):(t[w+0]=R,t[w+1]=S,n[p+0]=L,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R*D,t[w+1]=S,n[p+0]=L,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R,t[w+1]=S*O,n[p+0]=L,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R*D,t[w+1]=S*O,n[p+0]=L,n[p+1]=M,n[p+2]=b,n[p+3]=m,w+=2,p+=4),u&ln.TOP_RIGHT?(t[w+0]=0,t[w+1]=E,n[p+0]=k,n[p+1]=N,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=C,t[w+1]=E,n[p+0]=k,n[p+1]=N,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=0,t[w+1]=0,n[p+0]=k,n[p+1]=N,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=C,t[w+1]=0,n[p+0]=k,n[p+1]=N,n[p+2]=c,n[p+3]=c,w+=2,p+=4):(t[w+0]=T*D,t[w+1]=S,n[p+0]=j,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T,t[w+1]=S,n[p+0]=j,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T*D,t[w+1]=S*O,n[p+0]=j,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T,t[w+1]=S*O,n[p+0]=j,n[p+1]=M,n[p+2]=b,n[p+3]=m,w+=2,p+=4),u&ln.BOTTOM_LEFT?(t[w+0]=B,t[w+1]=0,n[p+0]=P,n[p+1]=x,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=0,t[w+1]=0,n[p+0]=P,n[p+1]=x,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=B,t[w+1]=A,n[p+0]=P,n[p+1]=x,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=0,t[w+1]=A,n[p+0]=P,n[p+1]=x,n[p+2]=c,n[p+3]=c,w+=2,p+=4):(t[w+0]=R,t[w+1]=y*O,n[p+0]=L,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R*D,t[w+1]=y*O,n[p+0]=L,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R,t[w+1]=y,n[p+0]=L,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R*D,t[w+1]=y,n[p+0]=L,n[p+1]=I,n[p+2]=b,n[p+3]=m,w+=2,p+=4),u&ln.BOTTOM_RIGHT?(t[w+0]=0,t[w+1]=0,n[p+0]=k,n[p+1]=x,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=C,t[w+1]=0,n[p+0]=k,n[p+1]=x,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=0,t[w+1]=A,n[p+0]=k,n[p+1]=x,n[p+2]=c,n[p+3]=c,p+=4,t[(w+=2)+0]=C,t[w+1]=A,n[p+0]=k,n[p+1]=x,n[p+2]=c,n[p+3]=c,w+=2,p+=4):(t[w+0]=T*D,t[w+1]=y*O,n[p+0]=j,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T,t[w+1]=y*O,n[p+0]=j,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T*D,t[w+1]=y,n[p+0]=j,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T,t[w+1]=y,n[p+0]=j,n[p+1]=I,n[p+2]=b,n[p+3]=m,w+=2,p+=4),t[w+0]=R*D,t[w+1]=S,n[p+0]=L,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=0,t[w+1]=S,n[p+0]=F,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T*D,t[w+1]=S,n[p+0]=F,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R,t[w+1]=S*O,n[p+0]=L,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R*D,t[w+1]=S*O,n[p+0]=L,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=0,t[w+1]=S*O,n[p+0]=F,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T*D,t[w+1]=S*O,n[p+0]=j,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T,t[w+1]=S*O,n[p+0]=j,n[p+1]=M,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R,t[w+1]=0,n[p+0]=L,n[p+1]=_,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=0,t[w+1]=0,n[p+0]=L,n[p+1]=_,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=0,t[w+1]=0,n[p+0]=j,n[p+1]=_,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T,t[w+1]=0,n[p+0]=j,n[p+1]=_,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R,t[w+1]=y*O,n[p+0]=L,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R*D,t[w+1]=y*O,n[p+0]=L,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=0,t[w+1]=y*O,n[p+0]=F,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T*D,t[w+1]=y*O,n[p+0]=j,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T,t[w+1]=y*O,n[p+0]=j,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=R*D,t[w+1]=y,n[p+0]=L,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=0,t[w+1]=y,n[p+0]=F,n[p+1]=I,n[p+2]=b,n[p+3]=m,p+=4,t[(w+=2)+0]=T*D,t[w+1]=y,n[p+0]=j,n[p+1]=I,n[p+2]=b,n[p+3]=m,w+=2,p+=4},eh=function(t,n,i,r){var e=i.x0,u=i.x1,s=i.x2,h=i.x3,o=i.y0,a=i.y1,f=i.y2,c=i.y3,l=.5*(e+u),v=.5*(o+a),b=.5*(h+s),g=.5*(c+f),d=.5*r[0]/r[1],m=.5*r[0]/r[2],w=d*(u-e),p=d*(a-o),D=m*(h-e),O=m*(c-o),S=2*n;t[S+0]=e,t[S+1]=o,t[S+2]=e+w,t[S+3]=o+p,t[S+4]=e+D,t[S+5]=o+O,t[S+6]=e+w+D,t[S+7]=o+p+O,t[(S+=8)+0]=u-w,t[S+1]=a-p,t[S+2]=u,t[S+3]=a,t[S+4]=u-w+D,t[S+5]=a-p+O,t[S+6]=u+D,t[S+7]=a+O,t[(S+=8)+0]=h-D,t[S+1]=c-O,t[S+2]=h+w-D,t[S+3]=c+p-O,t[S+4]=h,t[S+5]=c,t[S+6]=h+w,t[S+7]=c+p,t[(S+=8)+0]=s-w-D,t[S+1]=f-p-O,t[S+2]=s-D,t[S+3]=f-O,t[S+4]=s-w,t[S+5]=f-p,t[S+6]=s,t[S+7]=f,t[(S+=8)+0]=e+w,t[S+1]=o+p,t[S+2]=l,t[S+3]=v,t[S+4]=u-w,t[S+5]=a-p,t[(S+=6)+0]=e+D,t[S+1]=o+O,t[S+2]=e+D+w,t[S+3]=o+O+p,t[S+4]=l+D,t[S+5]=v+O,t[S+6]=u+D-w,t[S+7]=a+O-p,t[S+8]=u+D,t[S+9]=a+O;var M=.5*(e+s),E=.5*(o+f);t[(S+=10)+0]=.5*(e+h),t[S+1]=.5*(o+c),t[S+2]=M,t[S+3]=E,t[S+4]=M,t[S+5]=E,t[S+6]=.5*(u+s),t[S+7]=.5*(a+f),t[(S+=8)+0]=h-D,t[S+1]=c-O,t[S+2]=h-D+w,t[S+3]=c-O+p,t[S+4]=b-D,t[S+5]=g-O,t[S+6]=s-D-w,t[S+7]=f-O-p,t[S+8]=s-D,t[S+9]=f-O,t[(S+=10)+0]=h+w,t[S+1]=c+p,t[S+2]=b,t[S+3]=g,t[S+4]=s-w,t[S+5]=f-p},uh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.indexBuffer.update();var r=i.indices,e=this.vertexOffset,u=this.indexOffset,s=this.pointCount;return th(r,e,u),Gu(r,36,u,24,s),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Gs&&(this.updateVertexClippingStepAndUv(n,t,i),this.updateLineOfAnyColorFill(n,t,i,36),this.updateLineOfAnyColorStroke(n,t,i,36),this.updateText(n,t))},n.prototype.updateVertexClippingStepAndUv=function(t,n,i){var r=i.id,e=r!==this.pointId,u=i.size,s=u.id,h=s!==this.pointSizeId,o=n.size,a=o.x,f=o.y,c=n.radius,l=a!==this.sizeX||f!==this.sizeY||c!==this.radius,v=this.toTransformLocalId(n),b=this.transformLocalId!==v,g=n.stroke,d=g.enable?g.width:0,m=g.align,w=g.side,p=this.strokeAlign!==m||this.strokeWidth!==d||this.strokeSide!==w,D=n.corner,O=D!==this.corner,S=this.toTexture(n),M=this.toTextureTransformId(S),E=S!==this.texture||M!==this.textureTransformId,N=e||h||l||p;if(N||b||O||E){this.pointId=r,this.pointSizeId=s,this.sizeX=a,this.sizeY=f,this.radius=c,this.transformLocalId=v,this.strokeWidth=d,this.strokeAlign=m,this.strokeSide=w,this.corner=D,this.texture=S,this.textureTransformId=M,(l||b||p)&&(this.textSpacingHorizontal=NaN),t.vertexBuffer.update(),(N||b)&&(t.stepBuffer.update(),t.antialiasBuffer.update()),(N||O)&&t.clippingBuffer.update(),(N||E)&&t.uvBuffer.update();var T=this.pointCount,j=i.values,C=this.vertexOffset,k=t.vertices,y=t.clippings,I=t.steps,A=t.antialiases,x=t.uvs,R=n.transform.internalTransform,L=this.toTextureUvs(S),B=this.antialiasWeight,P=t.work,F=t.workStep;if(u.isStaticX()&&u.isStaticY()){var _=u.getX(0),U=u.getY(0);nh(k,C,0,0,_,U,m,d,c,R,$s,P),Wu(k,R,C,36,T,j),(N||b)&&(rh(I,A,C,d,w,D,B,$s,F),Hu(I,A,C,36,T)),(N||O)&&(ih(y,C,D,$s),zu(y,C,36,T)),(N||E)&&(eh(x,C,L,$s),Vu(x,C,36,T))}else for(var z=0;z<T;++z){var G=z<<1,H=j[G],V=j[G+1],W=(_=u.getX(z),U=u.getY(z),C+36*z);nh(k,W,H,V,_,U,m,d,c,R,$s,P),(N||b)&&rh(I,A,W,d,w,D,B,$s,F),(N||O)&&ih(y,W,D,$s),(N||E)&&eh(x,W,L,$s)}}},n}(Vs),sh=function(){function t(){}return t.create=function(t,n,i,r,e){return Uu.create(t,n,i,36,r,24,e,uh)},t}(),hh=function(t){function n(n){return void 0===n&&(n=St.RECTANGLE_ROUNDED),t.call(this,n)||this}return i(n,t),n.prototype.clone=function(){return(new n).copy(this)},n.prototype.Oe=function(t,n,i,r,e,u){var s=-i+e;if(t<=s)return n<=(h=-r+e)&&u&ln.TOP_LEFT?(a=t-s)*a+(f=n-h)*f<=e*e:(o=+r-e)<=n&&u&ln.BOTTOM_LEFT?(a=t-s)*a+(f=n-o)*f<=e*e:-i<=t;var h,o,a,f,c=+i-e;return c<=t?n<=(h=-r+e)&&u&ln.TOP_RIGHT?(a=t-c)*a+(f=n-h)*f<=e*e:(o=+r-e)<=n&&u&ln.BOTTOM_RIGHT?(a=t-c)*a+(f=n-o)*f<=e*e:t<=+i:-r<=n&&n<=+r},n.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=this.fill,s=this.stroke,h=s.enable?s.width:0;if(u.enable||0<h){var o=this.radius*Math.min(r,e),a=this.corner,f=s.side;if(this.Oe(n,i,r,e,o,a)){if(u.enable)return!0;var c=Math.max(0,r-h),l=Math.max(0,e-h),v=Math.max(0,o-h);if(!this.Oe(n,i,c,l,v,a)){if(f===vn.ALL)return!0;if(n<=-c+v){var b=0!=(f&vn.LEFT);return i<=-l+v?!(!(g=f&vn.TOP)||!b)||(g?-c<=i:!!b&&n<=-c):+l-v<=i?!(!(d=f&vn.BOTTOM)||!b)||(d?+c<=i:!!b&&n<=-c):b}if(+c-v<=n){var g,d,m=0!=(f&vn.RIGHT);return i<=-l+v?!(!(g=f&vn.TOP)||!m)||(g?-c<=i:!!m&&+c<=n):+l-v<=i?!(!(d=f&vn.BOTTOM)||!m)||(d?+c<=i:!!m&&+c<=n):m}return i<=-l+v?0!=(f&vn.TOP):+l-v<=i&&0!=(f&vn.BOTTOM)}}}}return!1},n}(_n),oh=function(t){function n(n){var i=t.call(this,St.LINE_OF_RECTANGLE_ROUNDEDS)||this;return n?i.copy(n):i.points=new Gs(i),i.pe=function(t,n,r,e,u,s){return i.containsPointAbs(t,n,r,e,u,s)},i.De=function(t,n,r,e,u,s){return i.containsPointAbsBBox(t,n,r,e,u,s)},i}return i(n,t),n.prototype.clone=function(){return new n(this)},n.prototype.containsAbs=function(t,n,i,r){var e=Xs(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.points.calcHitPointAbs(t,n,e,null,this.pe,null)},n.prototype.containsPointAbs=function(n,i,r,e,u,s){return t.prototype.containsAbs.call(this,n-u,i-s,r,e)},n.prototype.containsPointAbsBBox=function(n,i,r,e,u,s){return t.prototype.containsAbsBBox.call(this,n-u,i-s,r,e)},n.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,pn.WORK_RECT),s=Xs(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.points.calcHitPointAbs(u.x,u.y,s,i,r||this.pe,e)},n}(hh),ah=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new oh)},t}(),fh=function(){en[St.LINE_OF_RECTANGLE_ROUNDEDS]=sh.create,nn[St.LINE_OF_RECTANGLE_ROUNDEDS]=ah.deserialize,Qs.set(St.LINE_OF_RECTANGLE_ROUNDEDS,ks.PRIMITIVE|ks.STROKE_SIDE|ks.BORDER_RADIUS)},ch=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.clippingBuffer.update(),i.indexBuffer.update();var r=i.clippings,e=i.indices,u=this.vertexOffset,s=this.indexOffset,h=this.pointCount;return Du(r,u),Ou(e,u,s),zu(r,u,12,h),Gu(e,12,s,8,h),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Gs&&(this.updateVertexAndStep(n,t,i),this.updateLineOfAnyColorFill(n,t,i,12),this.updateLineOfAnyColorStroke(n,t,i,12),this.updateUv(n,t),this.updateText(n,t))},n.prototype.updateVertexAndStep=function(t,n,i){var r=i.id,e=r!==this.pointId,u=i.size,s=u.id,h=s!==this.pointSizeId,o=n.size,a=o.x,f=o.y,c=a!==this.sizeX||f!==this.sizeY,l=this.toTransformLocalId(n),v=this.transformLocalId!==l,b=n.stroke,g=b.enable?b.width:0,d=b.align,m=b.side,w=this.strokeAlign!==d||this.strokeWidth!==g||this.strokeSide!==m;if(e||h||c||v||w){this.pointId=r,this.pointSizeId=s,this.transformLocalId=l,this.strokeWidth=g,this.strokeAlign=d,this.strokeSide=m,(c||v||w)&&(this.textSpacingHorizontal=NaN),t.vertexBuffer.update(),t.stepBuffer.update(),t.antialiasBuffer.update();var p=this.pointCount,D=i.values,O=this.vertexOffset,S=t.vertices,M=t.steps,E=t.antialiases,N=n.transform.internalTransform,T=this.antialiasWeight,j=t.work,C=t.workStep;if(u.isStaticX()&&u.isStaticY()){var k=u.getX(0),y=u.getY(0);Su(S,O,M,E,0,0,k,y,d,g,m,!0,N,T,j,C),Wu(S,N,O,12,p,D),Hu(M,E,O,12,p)}else for(var I=0;I<p;++I){var A=I<<1,x=D[A],R=D[A+1];k=u.getX(I),y=u.getY(I),Su(S,O+12*I,M,E,x,R,k,y,d,g,m,!0,N,T,j,C)}}},n.prototype.updateUv=function(t,n){var i=this.toTexture(n),r=this.toTextureTransformId(i);if(i!==this.texture||r!==this.textureTransformId){this.texture=i,this.textureTransformId=r,t.uvBuffer.update();var e=t.uvs,u=this.vertexOffset,s=this.toTextureUvs(i);Mu(e,u,s),Vu(e,u,12,this.pointCount)}},n}(Vs),lh=function(){function t(){}return t.create=function(t,n,i,r,e){return Uu.create(t,n,i,12,r,8,e,ch)},t}(),vh=function(t){function n(n){var i=t.call(this,St.LINE_OF_RECTANGLES)||this;return n?i.copy(n):i.points=new Gs(i),i.pe=function(t,n,r,e,u,s){return i.containsPointAbs(t,n,r,e,u,s)},i.De=function(t,n,r,e,u,s){return i.containsPointAbsBBox(t,n,r,e,u,s)},i}return i(n,t),n.prototype.clone=function(){return new n(this)},n.prototype.containsAbs=function(t,n,i,r){var e=Xs(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.points.calcHitPointAbs(t,n,e,null,this.pe,null)},n.prototype.containsPointAbs=function(n,i,r,e,u,s){return t.prototype.containsAbs.call(this,n-u,i-s,r,e)},n.prototype.containsPointAbsBBox=function(n,i,r,e,u,s){return t.prototype.containsAbsBBox.call(this,n-u,i-s,r,e)},n.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,pn.WORK_RECT),s=Xs(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.points.calcHitPointAbs(u.x,u.y,s,i,r||this.pe,e)},n}(mu),bh=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new vh)},t}(),gh=function(){en[St.LINE_OF_RECTANGLES]=lh.create,nn[St.LINE_OF_RECTANGLES]=bh.deserialize,Qs.set(St.LINE_OF_RECTANGLES,ks.PRIMITIVE|ks.STROKE_SIDE)},dh=[0,0,0,0,0],mh=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+3,t[r+3]=n+1,t[r+4]=n+2,t[r+5]=n+3,t[r+6]=n+4,t[r+7]=n+5,t[r+8]=n+7,t[r+9]=n+5,t[r+10]=n+6,t[r+11]=n+7,t[r+12]=n+8,t[r+13]=n+9,t[r+14]=n+11,t[r+15]=n+9,t[r+16]=n+10,t[r+17]=n+11,t[r+18]=n+12,t[r+19]=n+13,t[r+20]=n+16,t[r+21]=n+13,t[r+22]=n+14,t[r+23]=n+16,t[r+24]=n+14,t[r+25]=n+15,t[r+26]=n+16,t[r+27]=n+12,t[r+28]=n+16,t[r+29]=n+19,t[r+30]=n+16,t[r+31]=n+17,t[r+32]=n+19,t[r+33]=n+17,t[r+34]=n+18,t[r+35]=n+19,t[r+36]=n+12,t[r+37]=n+19,t[r+38]=n+13,t[r+39]=n+19,t[r+40]=n+20,t[r+41]=n+13,t[r+42]=n+20,t[r+43]=n+21,t[r+44]=n+13},wh=function(t,n,i,r,e,u,s,h,o,a,f,c){var l=s*h,v=.5*e+(0<=e?+l:-l),b=.5*u+(0<=u?+l:-l),g=Math.sqrt(v*v+4*b*b),d=2*v*b/(v+g),m=d*o/(2*b),w=.5*(g-d)*o/g,p=m*g/(2*v);c.set(i,r-b),a.apply(c,c);var D=c.x,O=c.y;c.set(i,r),a.apply(c,c);var S=c.x,M=c.y;c.set(i+v,r),a.apply(c,c);var E=S-D,N=M-O,T=c.x+E,j=c.y+N,C=S+(S-c.x)+E,k=M+(M-c.y)+N,y=T-D,I=j-O,A=D+w*y,x=O+w*I,R=T-m*y,L=j-m*I,B=p*(C-T),P=p*(k-j),F=T+B,_=j+P,U=C-B,z=k-P,G=D-C,H=O-k,V=C+m*G,W=k+m*H,Y=D-w*G,X=O-w*H;c.set(i,r+b-d),a.apply(c,c);var K=c.x,J=c.y,Z=D+o*(K-D),q=O+o*(J-O),Q=T+o*(K-T),$=j+o*(J-j),tt=C+o*(K-C),nt=k+o*(J-k),it=S+E,rt=M+N;f[0]=Yn(it,rt,K,J),f[1]=p,f[2]=m,f[3]=w,f[4]=1-.5*d/b;var et=2*n;t[et+0]=Z,t[et+1]=q,t[et+2]=Y,t[et+3]=X,t[et+4]=D,t[et+5]=O,t[et+6]=A,t[et+7]=x,t[et+8]=Q,t[et+9]=$,t[et+10]=R,t[et+11]=L,t[et+12]=T,t[et+13]=j,t[et+14]=F,t[et+15]=_,t[et+16]=tt,t[et+17]=nt,t[et+18]=U,t[et+19]=z,t[et+20]=C,t[et+21]=k,t[et+22]=V,t[et+23]=W,t[et+24]=K,t[et+25]=J,t[et+26]=Z,t[et+27]=q,t[et+28]=A,t[et+29]=x,t[et+30]=R,t[et+31]=L,t[et+32]=Q,t[et+33]=$,t[et+34]=F,t[et+35]=_,t[et+36]=U,t[et+37]=z,t[et+38]=tt,t[et+39]=nt,t[et+40]=V,t[et+41]=W,t[et+42]=Y,t[et+43]=X},ph=function(t,n,i,r){var e=3*n,u=1-r;i&ln.TOP?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[e+3]=1,t[e+4]=0,t[e+5]=1,t[e+6]=1,t[e+7]=1,t[e+8]=1,t[e+9]=0,t[e+10]=1,t[e+11]=1):(t[e+0]=u,t[e+1]=u,t[e+2]=0,t[e+3]=1,t[e+4]=u,t[e+5]=0,t[e+6]=1,t[e+7]=1,t[e+8]=0,t[e+9]=u,t[e+10]=1,t[e+11]=0),e+=12,i&ln.BOTTOM_RIGHT?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[e+3]=1,t[e+4]=0,t[e+5]=1,t[e+6]=1,t[e+7]=1,t[e+8]=1,t[e+9]=0,t[e+10]=1,t[e+11]=1):(t[e+0]=u,t[e+1]=u,t[e+2]=0,t[e+3]=1,t[e+4]=u,t[e+5]=0,t[e+6]=1,t[e+7]=1,t[e+8]=0,t[e+9]=u,t[e+10]=1,t[e+11]=0),e+=12,i&ln.BOTTOM_LEFT?(t[e+0]=0,t[e+1]=0,t[e+2]=1,t[e+3]=1,t[e+4]=0,t[e+5]=1,t[e+6]=1,t[e+7]=1,t[e+8]=1,t[e+9]=0,t[e+10]=1,t[e+11]=1):(t[e+0]=u,t[e+1]=u,t[e+2]=0,t[e+3]=1,t[e+4]=u,t[e+5]=0,t[e+6]=1,t[e+7]=1,t[e+8]=0,t[e+9]=u,t[e+10]=1,t[e+11]=0),t[(e+=12)+0]=0,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=u,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[e+3]=1,t[e+4]=0,t[e+5]=0,t[(e+=6)+0]=u,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[e+3]=1,t[e+4]=0,t[e+5]=0,t[(e+=6)+0]=u,t[e+1]=0,t[e+2]=0,t[(e+=3)+0]=1,t[e+1]=0,t[e+2]=0,t[e+3]=1,t[e+4]=0,t[e+5]=0},Dh=function(t,n,i,r,e,u,s,h,o){var a=h[0];Fe(a,e,s,o);var f=o[0],c=o[1],l=o[2];Fe(u*a,e,s,o);for(var v=o[0],b=o[1],g=o[2],d=r+22<<1,m=r<<1,w=3*r,p=4*r;m<d;m+=2,w+=3,p+=4){var D=i[w+0],O=i[w+1],S=f,M=c,E=l;.5<i[w+2]&&(S=v,M=b,E=g),t[m+0]=S*D,t[m+1]=S*O,n[p+0]=M,n[p+1]=M,n[p+2]=E,n[p+3]=E}},Oh=function(t,n,i,r,e){var u=i.x0,s=i.x1,h=i.x2,o=i.x3,a=i.y0,f=i.y1,c=i.y2,l=i.y3,v=.5*(u+s),b=.5*(a+f),g=e[4],d=v+g*(o-u),m=b+g*(l-a),w=e[1],p=e[2],D=e[3],O=v+D*(o-v),S=b+D*(l-b),M=v+r*(d-v),E=b+r*(m-b),N=v+D*(h-v),T=b+D*(c-b),j=h+p*(v-h),C=c+p*(b-c),k=h+r*(d-h),y=c+r*(m-c),I=h+w*(o-h),A=c+w*(l-c),x=o+w*(h-o),R=l+w*(c-l),L=o+r*(d-o),B=l+r*(m-l),P=o+p*(v-o),F=l+p*(b-l),_=2*n;t[_+0]=M,t[_+1]=E,t[_+2]=O,t[_+3]=S,t[_+4]=v,t[_+5]=b,t[_+6]=N,t[_+7]=T,t[(_+=8)+0]=k,t[_+1]=y,t[_+2]=j,t[_+3]=C,t[_+4]=h,t[_+5]=c,t[_+6]=I,t[_+7]=A,t[(_+=8)+0]=L,t[_+1]=B,t[_+2]=x,t[_+3]=R,t[_+4]=o,t[_+5]=l,t[_+6]=P,t[_+7]=F,t[(_+=8)+0]=d,t[_+1]=m,t[_+2]=M,t[_+3]=E,t[_+4]=N,t[_+5]=T,t[_+6]=j,t[_+7]=C,t[_+8]=k,t[_+9]=y,t[_+10]=I,t[_+11]=A,t[_+12]=x,t[_+13]=R,t[_+14]=L,t[_+15]=B,t[_+16]=P,t[_+17]=F,t[_+18]=O,t[_+19]=S},Sh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.indexBuffer.update(),mh(i.indices,this.vertexOffset,this.indexOffset),Gu(i.indices,22,this.indexOffset,15,this.pointCount),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Gs&&(this.updateVertexClippingStepAndUv(n,t,i),this.updateLineOfAnyColorFill(n,t,i,22),this.updateLineOfAnyColorStroke(n,t,i,22),this.updateText(n,t))},n.prototype.updateVertexClippingStepAndUv=function(t,n,i){var r=i.id,e=r!==this.pointId,u=i.size,s=u.id,h=s!==this.pointSizeId,o=n.size,a=o.x,f=o.y,c=a!==this.sizeX||f!==this.sizeY,l=n.radius,v=l!==this.radius,b=this.toTransformLocalId(n),g=this.transformLocalId!==b,d=n.stroke,m=d.enable?d.width:0,w=d.align,p=this.strokeAlign!==w||this.strokeWidth!==m,D=n.corner,O=this.corner!==D,S=this.toTexture(n),M=this.toTextureTransformId(S),E=S!==this.texture||M!==this.textureTransformId,N=e||h||c||v||p;if(N||g||O||E){this.pointId=r,this.pointSizeId=s,this.sizeX=a,this.sizeY=f,this.radius=l,this.transformLocalId=b,this.strokeWidth=m,this.strokeAlign=w,this.corner=D,this.texture=S,this.textureTransformId=M,(c||g||p)&&(this.textSpacingHorizontal=NaN),t.vertexBuffer.update(),(N||O)&&t.clippingBuffer.update(),(N||g||O)&&(t.stepBuffer.update(),t.antialiasBuffer.update()),(N||E)&&t.uvBuffer.update();var T=this.pointCount,j=i.values,C=this.vertexOffset,k=t.vertices,y=t.clippings,I=t.steps,A=t.antialiases,x=t.uvs,R=n.transform.internalTransform,L=this.toTextureUvs(S),B=this.antialiasWeight,P=t.work,F=t.workStep;if(u.isStaticX()&&u.isStaticY()){var _=u.getX(0),U=u.getY(0);wh(k,C,0,0,_,U,w,m,l,R,dh,P),Wu(k,R,C,22,T,j),(N||O)&&(ph(y,C,D,l),zu(y,C,22,T)),(N||g||O)&&(Dh(I,A,y,C,m,l,B,dh,F),Hu(I,A,C,22,T)),(N||E)&&(Oh(x,C,L,l,dh),Vu(x,C,22,T))}else for(var z=0;z<T;++z){var G=z<<1,H=j[G],V=j[G+1],W=(_=u.getX(z),U=u.getY(z),C+22*z);wh(k,W,H,V,_,U,w,m,l,R,dh,P),(N||O)&&ph(y,W,D,l),(N||g||O)&&Dh(I,A,y,W,m,l,B,dh,F),(N||E)&&Oh(x,W,L,l,dh)}}},n}(Vs),Mh=function(){function t(){}return t.create=function(t,n,i,r,e){return Uu.create(t,n,i,22,r,15,e,Sh)},t}(),Eh=function(t){function n(n){return void 0===n&&(n=St.TRIANGLE),t.call(this,n)||this}return i(n,t),n.prototype.clone=function(){return(new n).copy(this)},n.prototype.Oe=function(t,n,i,r,e){return+i*t+r-n<=0&&-i*t+r-n<=0&&n<=e},n.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=2*e/r;if(this.fill.enable){if(this.Oe(n,i,u,-e,+e))return!0}else{var s=this.stroke,h=s.width;if(s.enable&&0<h&&this.Oe(n,i,u,-e,+e)){var o=2*r*e/(r+Math.sqrt(r*r+4*e*e)),a=e-o,f=a+(-e-a)*Math.max(0,o-h)/o,c=e-h;if(!this.Oe(n,i,u,f,c))return!0}}}return!1},n}(_n),Nh=function(t){function n(n){return void 0===n&&(n=St.TRIANGLE_ROUNDED),t.call(this,n)||this}return i(n,t),n.prototype.clone=function(){return(new n).copy(this)},n.prototype.Se=function(t,n,i,r){if(this.fill.enable){if(t*t+n*n<=i*i)return!0}else{var e=this.stroke,u=e.width;if(e.enable&&0<u){var s=t*t+n*n;if(s<=i*i){var h=Math.max(0,i*(1-u/r));if(h*h<=s)return!0}}}},n.prototype.containsCorner=function(t,n,i,r,e,u,s,h,o,a,f,c,l,v){var b=e+f*(s-e)-i,g=u+f*(h-u)-r,d=Math.sqrt(b*b+g*g);if(1e-5<d){var m=1/d,w=b*m,p=g*m,D=(e+c*(o-e)-i)*m,O=(u+c*(a-u)-r)*m,S=w*O-D*p;if(1e-5<Math.abs(S)){var M=1/S,E=t-i,N=n-r,T=(+O*E-D*N)*M,j=(-p*E+w*N)*M;if(this.Se(T,j,d,l*v))return!0}}},n.prototype.containsAbs=function(n,i,r,e){if(t.prototype.containsAbsBBox.call(this,n,i,r,e)){var u=2*e/r;if(this.Oe(n,i,u,-e,+e)){var s=Math.sqrt(r*r+4*e*e),h=2*r*e/(r+s),o=this.radius,a=e-h,f=-e,c=+r,l=+e,v=-c,b=+l,g=0+0*o,d=f+o*(a-f),m=c+o*(0-c),w=l+o*(a-l),p=+w,D=-m,O=-u*n+d-i<=0,S=+u*n+d-i<=0,M=i<=w,E=this.corner;if(!O&&!S&&E&ln.TOP){var N=.5*(s-h)*o/s;if(this.containsCorner(n,i,g,d,0,f,v,b,c,l,N,N,h,o))return!0}else if(!O&&!M&&E&ln.BOTTOM_LEFT){var T=(j=h*o/(2*e))*s/(2*r);if(this.containsCorner(n,i,D,p,v,b,c,l,0,f,T,j,h,o))return!0}else if(!S&&!M&&E&ln.BOTTOM_RIGHT){var j;if(T=(j=h*o/(2*e))*s/(2*r),this.containsCorner(n,i,m,w,c,l,0,f,v,b,j,T,h,o))return!0}else{if(this.fill.enable)return!0;var C=this.stroke,k=C.width;if(C.enable&&0<k){var y=e-h,I=y+(-e-y)*Math.max(0,h-k)/h,A=e-k;if(!this.Oe(n,i,u,I,A))return!0}}}}return!1},n}(Eh),Th=function(t){function n(n){var i=t.call(this,St.LINE_OF_TRIANGLE_ROUNDEDS)||this;return n?i.copy(n):i.points=new Gs(i),i.pe=function(t,n,r,e,u,s){return i.containsPointAbs(t,n,r,e,u,s)},i.De=function(t,n,r,e,u,s){return i.containsPointAbsBBox(t,n,r,e,u,s)},i}return i(n,t),n.prototype.clone=function(){return new n(this)},n.prototype.containsAbs=function(t,n,i,r){var e=Xs(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.points.calcHitPointAbs(t,n,e,null,this.pe,null)},n.prototype.containsPointAbs=function(n,i,r,e,u,s){return t.prototype.containsAbs.call(this,n-u,i-s,r,e)},n.prototype.containsPointAbsBBox=function(n,i,r,e,u,s){return t.prototype.containsAbsBBox.call(this,n-u,i-s,r,e)},n.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,pn.WORK_RECT),s=Xs(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.points.calcHitPointAbs(u.x,u.y,s,i,r||this.pe,e)},n}(Nh),jh=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new Th)},t}(),Ch=function(){en[St.LINE_OF_TRIANGLE_ROUNDEDS]=Mh.create,nn[St.LINE_OF_TRIANGLE_ROUNDEDS]=jh.deserialize,Qs.set(St.LINE_OF_TRIANGLE_ROUNDEDS,ks.PRIMITIVE|ks.BORDER_RADIUS)},kh=[0,0,0],yh=function(t,n){var i=3*n;t[i+0]=0,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=0,t[i+1]=1,t[i+2]=0,t[(i+=3)+0]=0,t[i+1]=1,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0,t[(i+=3)+0]=1,t[i+1]=0,t[i+2]=0},Ih=function(t,n,i){var r=3*i;t[r+0]=n+0,t[r+1]=n+1,t[r+2]=n+2,t[r+3]=n+0,t[r+4]=n+3,t[r+5]=n+4,t[r+6]=n+0,t[r+7]=n+5,t[r+8]=n+6},Ah=function(t,n,i,r,e,u,s,h,o,a,f){var c=s*h,l=.5*e+(0<=e?+c:-c),v=.5*u+(0<=u?+c:-c),b=2*l*v/(l+Math.sqrt(l*l+4*v*v));f.set(i,r-v),o.apply(f,f);var g=f.x,d=f.y;f.set(i,r),o.apply(f,f);var m=f.x,w=f.y;f.set(i+l,r),o.apply(f,f);var p=m-g,D=w-d,O=f.x+p,S=f.y+D,M=m+(m-f.x)+p,E=w+(w-f.y)+D;f.set(i,r+v-b),o.apply(f,f);var N=f.x,T=f.y,j=m+p,C=w+D;a[0]=Yn(j,C,N,T),a[1]=Yn(O,S,j,C),a[2]=Yn(g,d,m,w);var k=n<<1;t[k+0]=N,t[k+1]=T,t[k+2]=g,t[k+3]=d,t[k+4]=O,t[k+5]=S,t[k+6]=O,t[k+7]=S,t[k+8]=M,t[k+9]=E,t[k+10]=M,t[k+11]=E,t[k+12]=g,t[k+13]=d},xh=function(t,n,i,r,e,u,s,h,o){Fe(h[0],u,s,o);var a=o[0],f=o[1],c=o[2];Pe(t,n,i,r,e,a,a,f,f,c,c)},Rh=function(t,n,i,r){var e=n.x0,u=n.x1,s=n.x2,h=n.x3,o=n.y0,a=n.y1,f=n.y2,c=n.y3,l=.5*(e+u),v=.5*(o+a),b=1-.5*r[0]/r[2],g=l+b*(h-e),d=v+b*(c-o),m=i<<1;t[m+0]=g,t[m+1]=d,t[m+2]=l,t[m+3]=v,t[m+4]=s,t[m+5]=f,t[m+6]=s,t[m+7]=f,t[m+8]=h,t[m+9]=c,t[m+10]=h,t[m+11]=c,t[m+12]=l,t[m+13]=v},Lh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;i.clippingBuffer.update(),i.indexBuffer.update();var r=i.clippings,e=i.indices,u=this.vertexOffset,s=this.indexOffset,h=this.pointCount;return yh(r,u),Ih(e,u,s),zu(r,u,7,h),Gu(e,7,s,3,h),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer,i=t.points;i instanceof Gs&&(this.updateVertexStepAndUvs(n,t,i),this.updateLineOfAnyColorFill(n,t,i,7),this.updateLineOfAnyColorStroke(n,t,i,7),this.updateText(n,t))},n.prototype.updateVertexStepAndUvs=function(t,n,i){var r=i.id,e=r!==this.pointId,u=i.size,s=u.id,h=s!==this.pointSizeId,o=n.size,a=o.x,f=o.y,c=a!==this.sizeX||f!==this.sizeY,l=this.toTransformLocalId(n),v=this.transformLocalId!==l,b=n.stroke,g=b.enable?b.width:0,d=b.align,m=this.strokeAlign!==d||this.strokeWidth!==g,w=this.toTexture(n),p=this.toTextureTransformId(w),D=w!==this.texture||p!==this.textureTransformId,O=e||h||c||m;if(O||v||D){this.pointId=r,this.pointSizeId=s,this.sizeX=a,this.sizeY=f,this.transformLocalId=l,this.strokeWidth=g,this.strokeAlign=d,(c||v||m)&&(this.textSpacingHorizontal=NaN),t.vertexBuffer.update(),(O||v)&&(t.stepBuffer.update(),t.antialiasBuffer.update()),(O||D)&&t.uvBuffer.update();var S=this.pointCount,M=i.values,E=this.vertexOffset,N=t.vertices,T=t.steps,j=t.antialiases,C=t.clippings,k=t.uvs,y=this.toTextureUvs(w),I=n.transform.internalTransform,A=this.antialiasWeight,x=t.work,R=t.workStep;if(u.isStaticX()&&u.isStaticY()){var L=u.getX(0),B=u.getY(0);Ah(N,E,0,0,L,B,d,g,I,kh,x),Wu(N,I,E,7,S,M),(O||v)&&(xh(T,j,C,E,7,g,A,kh,R),Hu(T,j,E,7,S)),(O||D)&&(Rh(k,y,E,kh),Vu(k,E,7,S))}else for(var P=0;P<S;++P){var F=P<<1,_=M[F],U=M[F+1],z=(L=u.getX(P),B=u.getY(P),E+7*P);Ah(N,z,_,U,L,B,d,g,I,kh,x),(O||v)&&xh(T,j,C,z,7,g,A,kh,R),(O||D)&&Rh(k,y,z,kh)}}},n}(Vs),Bh=function(){function t(){}return t.create=function(t,n,i,r,e){return Uu.create(t,n,i,7,r,3,e,Lh)},t}(),Ph=function(t){function n(n){var i=t.call(this,St.LINE_OF_TRIANGLES)||this;return n?i.copy(n):i.points=new Gs(i),i.pe=function(t,n,r,e,u,s){return i.containsPointAbs(t,n,r,e,u,s)},i.De=function(t,n,r,e,u,s){return i.containsPointAbsBBox(t,n,r,e,u,s)},i}return i(n,t),n.prototype.clone=function(){return new n(this)},n.prototype.containsAbs=function(t,n,i,r){var e=Xs(this,null);return!!this.containsAbsBBox(t,n,i+e,r+e)&&this.points.calcHitPointAbs(t,n,e,null,this.pe,null)},n.prototype.containsPointAbs=function(n,i,r,e,u,s){return t.prototype.containsAbs.call(this,n-u,i-s,r,e)},n.prototype.containsPointAbsBBox=function(n,i,r,e,u,s){return t.prototype.containsAbsBBox.call(this,n-u,i-s,r,e)},n.prototype.calcHitPoint=function(t,n,i,r,e){var u=this.toLocalRect(t,pn.WORK_RECT),s=Xs(this,n);return!!this.containsAbsBBox(u.x,u.y,u.width+s,u.height+s)&&this.points.calcHitPointAbs(u.x,u.y,s,i,r||this.pe,e)},n}(Eh),Fh=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new Ph)},t}(),_h=function(){en[St.LINE_OF_TRIANGLES]=Bh.create,nn[St.LINE_OF_TRIANGLES]=Fh.deserialize},Uh=function(n){function r(t,i,r){return n.call(this,t,i,r,0,0,1)||this}return i(r,n),r.prototype.init=function(i){return n.prototype.init.call(this,i),this.texture=i.texture||t.Texture.WHITE,this},r.prototype.update=function(t){},r}(Vn),zh=function(){function t(){}return t.create=function(t,n,i,r){return new Uh(t,i,r).init(n)},t}(),Gh=function(t){function n(n){return void 0===n&&(n=St.NULL),t.call(this,n)||this}return i(n,t),n.prototype.clone=function(){return(new n).copy(this)},n}(_n),Hh=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new Gh)},t}(),Vh=function(){en[St.NULL]=zh.create,nn[St.NULL]=Hh.deserialize},Wh=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new mu)},t}(),Yh=function(){en[St.RECTANGLE]=Nu.create,nn[St.RECTANGLE]=Wh.deserialize,Qs.set(St.RECTANGLE,ks.PRIMITIVE|ks.STROKE_SIDE)},Xh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.indexBuffer.update(),th(i.indices,this.vertexOffset,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexClippingStepAndUv(n,t),this.updateColor(n,t),this.updateText(n,t)},n.prototype.updateVertexClippingStepAndUv=function(t,n){var i=n.size,r=i.x,e=i.y,u=n.radius,s=r!==this.sizeX||e!==this.sizeY||u!==this.radius,h=this.toTransformLocalId(n),o=this.transformLocalId!==h,a=n.stroke,f=a.enable?a.width:0,c=a.align,l=a.side,v=this.strokeAlign!==c||this.strokeWidth!==f||this.strokeSide!==l,b=n.corner,g=b!==this.corner,d=this.toTexture(n),m=this.toTextureTransformId(d),w=d!==this.texture||m!==this.textureTransformId,p=s||v;if(p||o||g||w){this.sizeX=r,this.sizeY=e,this.radius=u,this.transformLocalId=h,this.strokeAlign=c,this.strokeWidth=f,this.strokeSide=l,this.corner=b,this.texture=d,this.textureTransformId=m,(p||o)&&(this.textSpacingHorizontal=NaN);var D=this.vertexOffset;t.vertexBuffer.update(),nh(t.vertices,D,0,0,r,e,c,f,u,n.transform.internalTransform,$s,t.work),(p||o)&&(t.stepBuffer.update(),t.antialiasBuffer.update(),rh(t.steps,t.antialiases,D,f,l,b,this.antialiasWeight,$s,t.workStep)),(p||g)&&(t.clippingBuffer.update(),ih(t.clippings,D,b,$s)),(p||w)&&(t.uvBuffer.update(),eh(t.uvs,D,this.toTextureUvs(d),$s))}},n}(Xn),Kh=function(){function t(){}return t.create=function(t,n,i,r,e){var u=Wn.getTextCount(n,t.workCount),s=u.vertexCount,h=u.indexCount,o=36+s,a=24+h;return i+o<t.vertexCapacity&&r+a<t.indexCapacity?new Xh(t,i,r,s,h,o,a,e).init(n):null},t}(),Jh=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new hh)},t}(),Zh=function(){en[St.RECTANGLE_ROUNDED]=Kh.create,nn[St.RECTANGLE_ROUNDED]=Jh.deserialize,Qs.set(St.RECTANGLE_ROUNDED,ks.PRIMITIVE|ks.STROKE_SIDE|ks.BORDER_RADIUS)},qh=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.clippingBuffer.update(),i.indexBuffer.update(),yh(i.clippings,this.vertexOffset),Ih(i.indices,this.vertexOffset,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexStepAndUv(n,t),this.updateColor(n,t),this.updateText(n,t)},n.prototype.updateVertexStepAndUv=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=this.toTransformLocalId(n),h=this.transformLocalId!==s,o=n.stroke,a=o.enable?o.width:0,f=o.align,c=this.strokeAlign!==f||this.strokeWidth!==a,l=this.toTexture(n),v=this.toTextureTransformId(l),b=l!==this.texture||v!==this.textureTransformId,g=u||c;if(g||h||b){this.sizeX=r,this.sizeY=e,this.transformLocalId=s,this.strokeWidth=a,this.strokeAlign=f,this.texture=l,this.textureTransformId=v,(g||h)&&(this.textSpacingHorizontal=NaN);var d=this.vertexOffset;t.vertexBuffer.update(),Ah(t.vertices,d,0,0,r,e,f,a,n.transform.internalTransform,kh,t.work),(g||h)&&(t.stepBuffer.update(),t.antialiasBuffer.update(),xh(t.steps,t.antialiases,t.clippings,d,7,a,this.antialiasWeight,kh,t.workStep)),(g||b)&&(t.uvBuffer.update(),Rh(t.uvs,this.toTextureUvs(l),d,kh))}},n}(Xn),Qh=function(){function t(){}return t.create=function(t,n,i,r,e){var u=Wn.getTextCount(n,t.workCount),s=u.vertexCount,h=u.indexCount,o=7+s,a=3+h;return i+o<t.vertexCapacity&&r+a<t.indexCapacity?new qh(t,i,r,s,h,o,a,e).init(n):null},t}(),$h=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new Eh)},t}(),to=function(){en[St.TRIANGLE]=Qh.create,nn[St.TRIANGLE]=$h.deserialize},no=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.buffer;return i.indexBuffer.update(),mh(i.indices,this.vertexOffset,this.indexOffset),this.initText(),this.update(n),this},n.prototype.update=function(t){var n=this.buffer;this.updateVertexClippingStepAndUv(n,t),this.updateColor(n,t),this.updateText(n,t)},n.prototype.updateVertexClippingStepAndUv=function(t,n){var i=n.size,r=i.x,e=i.y,u=r!==this.sizeX||e!==this.sizeY,s=n.radius,h=s!==this.radius,o=this.toTransformLocalId(n),a=this.transformLocalId!==o,f=n.stroke,c=f.enable?f.width:0,l=f.align,v=this.strokeAlign!==l||this.strokeWidth!==c,b=n.corner,g=b!==this.corner,d=this.toTexture(n),m=this.toTextureTransformId(d),w=d!==this.texture||m!==this.textureTransformId,p=u||h||v;if(p||a||g||w){this.sizeX=r,this.sizeY=e,this.radius=s,this.transformLocalId=o,this.strokeWidth=c,this.strokeAlign=l,this.corner=b,this.texture=d,this.textureTransformId=m,(u||a||v)&&(this.textSpacingHorizontal=NaN);var D=this.vertexOffset,O=t.work;t.vertexBuffer.update(),wh(t.vertices,D,0,0,r,e,l,c,s,n.transform.internalTransform,dh,O),(h||g)&&(t.clippingBuffer.update(),ph(t.clippings,D,b,s)),(p||a||g)&&(t.stepBuffer.update(),t.antialiasBuffer.update(),Dh(t.steps,t.antialiases,t.clippings,D,c,n.radius,this.antialiasWeight,dh,t.workStep)),(p||w)&&(t.uvBuffer.update(),Oh(t.uvs,D,this.toTextureUvs(d),s,dh))}},n}(Xn),io=function(){function t(){}return t.create=function(t,n,i,r,e){var u=Wn.getTextCount(n,t.workCount),s=u.vertexCount,h=u.indexCount,o=22+s,a=15+h;return i+o<t.vertexCapacity&&r+a<t.indexCapacity?new no(t,i,r,s,h,o,a,e).init(n):null},t}(),ro=function(){function t(){}return t.deserialize=function(t,n){return Re.deserialize(t,n,new Nh)},t}(),eo=function(){en[St.TRIANGLE_ROUNDED]=io.create,nn[St.TRIANGLE_ROUNDED]=ro.deserialize,Qs.set(St.TRIANGLE_ROUNDED,ks.PRIMITIVE|ks.BORDER_RADIUS)},uo=function(){Be(),Xe(),du(),lu(),Tu(),Iu(),Fu(),Vh(),Zh(),Yh(),eo(),to(),Zs(),fh(),gh(),Ch(),_h()},so=function(){tn(),uo()},ho=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n,i){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!0,color:16777215,alpha:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),oo=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){return vn.NONE},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n,i,r,e){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!1,color:16777215,alpha:1,width:1,align:0,side:vn.NONE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),ao=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return jn.CENTER},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return Cn.MIDDLE},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:jn.CENTER,vertical:Cn.MIDDLE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),fo=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),co=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 1},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n,i,r){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!1,color:16777215,alpha:1,width:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),lo=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),vo=function(){function t(){}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,n){},t.prototype.toObject=function(){return{horizontal:0,vertical:0}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),bo=function(){function t(){this.align=new ao,this.offset=new fo,this.outline=new co,this.spacing=new vo,this.padding=new lo}return Object.defineProperty(t.prototype,"enable",{get:function(){return!0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return""},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return"auto"},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return 24},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return Nn.NORMAL},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return Tn.NORMAL},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return kn.LEFT_TO_RIGHT},set:function(t){},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){return!1},set:function(t){},enumerable:!0,configurable:!0}),t.prototype.copy=function(t){return this},t.prototype.set=function(t,n,i,r,e,u,s,h,o){return this},t.prototype.toObject=function(){return{value:"",color:0,alpha:1,family:"auto",size:24,weight:Nn.NORMAL,align:this.align.toObject(),offset:this.offset.toObject(),style:Tn.NORMAL,outline:this.outline.toObject(),spacing:this.spacing.toObject(),direction:kn.LEFT_TO_RIGHT,padding:this.padding.toObject(),clipping:!1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,n){},t}(),go=function(){this.vertexCount=0,this.indexCount=0},mo=function(t,n){this.texture=t,this.indexOffset=n},wo=function(){function t(){this.index=0,this.baseTexture=null,this.units=[]}return t.prototype.begin=function(){this.index=0,this.baseTexture=null},t.prototype.push=function(t,n){if(this.index<this.units.length){var i=this.units[this.index];i.texture=t,i.indexOffset=n}else this.units.push(new mo(t,n));this.index+=1},t.prototype.end=function(){this.units.length!==this.index&&(this.units.length=this.index)},t.prototype.destroy=function(){this.units.length=0},t}(),po=function(){function n(n,i,r){var e=3*n,u=e;this.vertices=new Float32Array(2*u),this.vertexCapacity=u,this.vertexCount=0,this.vertexBuffer=new t.Buffer(this.vertices,!1,!1),this.clippings=new Float32Array(3*u),this.clippingBuffer=new t.Buffer(this.clippings,!1,!1),this.steps=new Float32Array(2*u),this.stepBuffer=new t.Buffer(this.steps,!1,!1),this.antialiases=new Float32Array(4*u),this.antialiasBuffer=new t.Buffer(this.antialiases,!1,!1),this.colorFills=new Float32Array(4*u),this.colorFillBuffer=new t.Buffer(this.colorFills,!1,!1),this.colorStrokes=new Float32Array(4*u),this.colorStrokeBuffer=new t.Buffer(this.colorStrokes,!1,!1),this.uvs=new Float32Array(2*u),this.uvBuffer=new t.Buffer(this.uvs,!1,!1);var s=u<=65535;this.indices=s?new Uint16Array(e):new Uint32Array(e),this.indexCapacity=n,this.indexCount=0,this.indexBuffer=new t.Buffer(this.indices,!1,!0),this.renderer=i,this.builder=new wo,this.work=new t.Point,this.workStep=new Float32Array(3),this.workCount=new go,this.geometry=(new t.Geometry).addIndex(this.indexBuffer).addAttribute("aPosition",this.vertexBuffer,2).addAttribute("aClipping",this.clippingBuffer,3).addAttribute("aStep",this.stepBuffer,2).addAttribute("aAntialias",this.antialiasBuffer,4).addAttribute("aColorFill",this.colorFillBuffer,4).addAttribute("aColorStroke",this.colorStrokeBuffer,4).addAttribute("aUv",this.uvBuffer,2)}return n.prototype.render=function(n){var i=this.renderer;i.geometry.bind(this.geometry);var r=this.builder.units,e=r.length;if(0<e){for(var u=t.DRAW_MODES.TRIANGLES,s=null,h=r[0],o=0,a=3*h.indexOffset,f=0,c=t.Texture.WHITE,l=0,v=e-1;l<v;++l)s=h,o=a,f=(a=3*(h=r[l+1]).indexOffset)-o,c=s.texture||t.Texture.WHITE,0<f&&c.valid&&(n.uniforms.sampler=i.texture.bind(c),i.geometry.draw(u,f,o));f=3*this.indexCount-a,c=h.texture||t.Texture.WHITE,0<f&&c.valid&&(n.uniforms.sampler=i.texture.bind(c),i.geometry.draw(u,f,a))}},n.prototype.isCompatible=function(t,n,i,r){return n.getBuffer()===this&&n.getVertexOffset()===i&&n.getIndexOffset()===r&&n.isCompatible(t)},n.prototype.update=function(t,n){var i=this.builder;i.begin();for(var r=0,e=0,u=t.get();null!=u&&null!=(s=u.uploaded)&&this.isCompatible(u,s,r,e);u=t.next())s.update(u),s.buildUnit(i),r+=s.getVertexCount(),e+=s.getIndexCount();for(;null!=u;u=t.next()){var s,h=en[u.type]||en[St.GROUP];if(null==h)break;if(null==(s=h(this,u,r,e,n)))break;s.buildUnit(i),r+=s.getVertexCount(),e+=s.getIndexCount()}return i.end(),this.vertexCount=r,this.indexCount=e,0<i.units.length},n.prototype.destroy=function(){this.geometry.destroy(),this.builder.destroy()},n}(),Do=[],Oo=function(){function t(){this.index=0,this.shapes=Do}return t.prototype.reset=function(t){this.index=-1,this.shapes=t},t.prototype.next=function(){var t=this.index=this.index+1,n=this.shapes;return t<n.length?n[t]:null},t}(),So=function(){function t(){this.Me=-1,this.Ee=new Oo,this.Ne=[this.Ee],this.ue=null}return t.prototype.reset=function(t){return this.Me=0,(this.Ee=this.Ne[0]).reset(t),this.ue=null,this.next()},t.prototype.get=function(){return this.ue},t.prototype.next=function(){var t=this.Ee.next();if(null!=t){this.ue=t;var n=t.children;if(0<n.length)if((r=this.Me=this.Me+1)<(e=this.Ne).length)(i=e[r]).reset(n),this.Ee=i;else{var i=new Oo;e.push(i),i.reset(n),this.Ee=i}return t}var r=this.Me=this.Me-1,e=this.Ne;return 0<=r?(this.Ee=e[r],this.ue=null,this.next()):(this.ue=null,null)},t}(),Mo=function(n){function r(i){var r=n.call(this,i)||this;return r.Te=t.Shader.from("\nattribute vec2 aPosition;\nattribute vec3 aClipping;\nattribute vec2 aStep;\nattribute vec4 aAntialias;\nattribute vec4 aColorFill;\nattribute vec4 aColorStroke;\nattribute vec2 aUv;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mediump float pixelScale;\nuniform mediump float antialiasWeight;\n\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nvec2 toInverse( in vec2 v ) {\n\treturn vec2( -v.y, v.x );\n}\n\nvec2 toTransformedPosition( in vec2 v ) {\n\treturn (projectionMatrix * translationMatrix * vec3(v, 1.0)).xy;\n}\n\nvec4 toAntialias01( in vec4 antialias, in float scale ) {\n\t// Taylor series of 1 / ( 1 - a ) = 1 + a + a^2 + ....\n\treturn 1.0 + min( vec4( 1.0 ), antialias * scale );\n}\n\nvec4 toAntialias2( in vec2 step, in vec4 antialias, in float scale ) {\n\tfloat x = min( 0.4, step.x * scale );\n\tfloat y = 0.5 - antialias.x;\n\tfloat z = 0.5 - antialias.x - step.y;\n\treturn vec4( y, z, y - max( 0.01, y - x ), z - max( 0.01, z - x ) );\n}\n\nvec2 toPosition3456( in float type, in vec2 p, in vec2 pprev, in vec2 pnext, in float strokeWidth, out float shift ) {\n\tvec2 d0 = p - pprev;\n\tvec2 d1 = pnext - p;\n\tfloat l0 = dot( d0, d0 );\n\tfloat l1 = dot( d1, d1 );\n\tvec2 nd0 = normalize( toInverse( d0 ) );\n\tvec2 nd1 = normalize( toInverse( d1 ) );\n\tvec2 n0 = 0.00001 < l0 ? nd0 : nd1;\n\tvec2 n1 = 0.00001 < l1 ? nd1 : nd0;\n\tvec2 n0i = toInverse( n0 );\n\tvec2 n1i = toInverse( n1 );\n\tfloat direction = sign( 4.5 - type );\n\n\t// Offset\n\tfloat cross = dot( n0i, n1 );\n\tfloat crossInverse = ( 0.00001 < abs( cross ) ? 1.0 / cross : 0.0 );\n\tfloat b = dot(n1 - n0, n0) * crossInverse;\n\tfloat offsetSize = direction * strokeWidth * 0.5;\n\tvec2 offset = n1 + n1i * b;\n\n\t// Miter\n\tvec2 pmiter = p + offsetSize * offset;\n\tfloat miterAngle0 = dot( n0i, pmiter - pprev );\n\tfloat miterAngle1 = dot( n1i, pmiter - pnext );\n\tfloat miterLength = dot( offset, offset );\n\tfloat miterSide = direction * cross;\n\n\t// Bevel\n\tvec2 n = ( type == 4.0 || type == 6.0 ? n1 : n0 );\n\tvec2 pbevel = p + offsetSize * n;\n\n\t//\n\tvec2 presult = (\n\t\t0.0 <= miterAngle0 || miterAngle1 < 0.0 || miterSide < 0.0 ?\n\t\tpbevel : pmiter\n\t);\n\t/*\n\tvec2 presult = (\n\t\tmiterAngle0 < 0.0 && 0.0 <= miterAngle1 && miterLength < 50.0 ?\n\t\tpmiter : pbevel\n\t);\n\t*/\n\tvec2 ni = ( type == 4.0 || type == 6.0 ? n1i : n0i );\n\tshift = dot( ni, p - presult );\n\treturn toTransformedPosition( presult );\n}\n\nvec2 toStep3456( in float type ) {\n\treturn ( type < 4.5 ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 ) );\n}\n\nvec4 toAntialias3456( in float strokeWidth, in float scale ) {\n\tfloat a = antialiasWeight / max( 0.0001, strokeWidth );\n\treturn toAntialias01( vec4( a, a, a, a ), scale );\n}\n\nfloat toDotAndDashScale( in float scale, in float strokeWidthScale ) {\n\treturn (\n\t\tscale == 4.0 || scale == 5.0 || scale == 6.0 || scale == 7.0 ?\n\t\tstrokeWidthScale : 1.0\n\t);\n}\n\nvec4 toColorStroke3456( in float shift, in float scale ) {\n\tfloat x = aColorFill.x + shift;\n\tfloat y = scale * aColorFill.y;\n\tfloat z = scale * aColorFill.z;\n\tfloat w = aColorFill.w;\n\treturn vec4( x, y, z, w );\n}\n\nfloat toStrokeWidthScale( in float scale ) {\n\treturn (\n\t\tscale == 3.0 || scale == 7.0 ?\n\t\tpixelScale : (\n\t\t\tscale == 1.0 || scale == 5.0 ?\n\t\t\tmin( 1.0, pixelScale ) : (\n\t\t\t\tscale == 2.0 || scale == 6.0 ?\n\t\t\t\tmax( 1.0, pixelScale ) : 1.0\n\t\t\t)\n\t\t)\n\t);\n}\n\nvoid main(void) {\n\tvec2 p012 = toTransformedPosition( aPosition );\n\n\tfloat type = aClipping.z;\n\n\t// type === 0 or 1\n\tvec4 a01 = toAntialias01( aAntialias, pixelScale );\n\n\t// type === 2\n\tvec4 a2 = toAntialias2( aStep, aAntialias, pixelScale );\n\n\t// type === 3, 4, 5 or 6\n\tfloat shift3456 = 0.0;\n\tfloat strokeWidthScale = toStrokeWidthScale( aStep.y );\n\tfloat strokeWidth = strokeWidthScale * aStep.x;\n\tvec2 p3456 = toPosition3456( type, aPosition, aAntialias.xy, aAntialias.zw, strokeWidth, shift3456 );\n\tvec2 step3456 = toStep3456( type );\n\tvec4 a3456 = toAntialias3456( strokeWidth, pixelScale );\n\tvec4 colorStroke3456 = toColorStroke3456( shift3456, toDotAndDashScale( aStep.y, strokeWidthScale ) );\n\n\t//\n\tgl_Position = vec4( ( 2.5 < type ? p3456 : p012 ), 0.0, 1.0 );\n\tvAntialias = ( 1.5 < type ? ( 2.5 < type ? a3456 : a2 ) : a01 );\n\tvClipping = aClipping;\n\tvStep = ( 2.5 < type ? step3456 : aStep );\n\tvColorFill = ( 2.5 < type ? aColorStroke : aColorFill );\n\tvColorStroke = ( 2.5 < type ? colorStroke3456 : aColorStroke );\n\tvUv = aUv;\n}","\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec2 d01 = ( v0.x < v0.y ? vec2( v0.y, v2.y ) : vec2( v0.x, v2.x ) );\n\tvec2 d02 = ( v1.x < v1.y ? vec2( v1.y, v3.y ) : vec2( v1.x, v3.x ) );\n\tvec4 d0 = vec4( d01.x, d02.x, d01.y, d02.y );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = smoothstep( 1.0 - (d.zw - d.xy), vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat ld = 0.5 * pixelScale;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = smoothstep( 0.0, 0.0 + ld, lm );\n\tfloat ls1 = smoothstep( lp0, lp0 + ld, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - smoothstep( lt - ld, lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}"),r.je=new So,r.Ce=5e3,r.ke=r.getBufferSizeMax(i),r}return i(r,n),r.prototype.getBufferSizeMax=function(t){var n=t.context,i=n.extensions;return 1<n.webGLVersion||i.uint32ElementIndex?1431655765:21845},r.prototype.updateAtlas=function(t,n,i,r,e){var u=t.imageSrc;if(null!=u){var s=n.get(u);if(null!=s)t.texture=s.texture;else{var h=new Qu(t.image,e);t.texture=h.texture,n.set(h.id,h)}}else t.texture=r;var o=t.text,a=o.value;0<a.length&&i.add(o.family,a)},r.prototype.updateAtlases=function(t,n,i,r,e){for(var u=0,s=t.length;u<s;++u){var h=t[u];this.updateAtlas(h,n,i,r,e);for(var o=h.children,a=0,f=o.length;a<f;++a){var c=o[a];this.updateAtlas(c,n,i,r,e),this.updateAtlases(c.children,n,i,r,e)}}},r.prototype.updateFontAtlas=function(t,n,i,r){var e=t.text,u=i.get(e.family);if(null!=u){var s=n.get(u.id);null!=s?(e.atlas=u,e.texture=s.texture):(e.atlas=void 0,e.texture=r)}else e.atlas=void 0,e.texture=r},r.prototype.updateFontAtlases=function(t,n,i,r){for(var e=0,u=t.length;e<u;++e){var s=t[e];this.updateFontAtlas(s,n,i,r);for(var h=s.children,o=0,a=h.length;o<a;++o){var f=h[o];this.updateFontAtlas(f,n,i,r),this.updateFontAtlases(f.children,n,i,r)}}},r.prototype.ye=function(n,i,r){var e=this.renderer,u=this.Te;if(null!=u&&0<i.length){var s=e.resolution,h=n.getBuffers(),o=n.getAntialiasWeight(s);if(r){var a=n.getAtlas(s),f=n.getFontAtlases();a.begin(),f.begin();var c=a.getDefaultTexture(),l=a.getBaseTexture();this.updateAtlases(i,a,f,c,l),f.end(),f.update(a),this.updateFontAtlases(i,a,f,c),a.end(),a.repack(),this.updateBuffers(i,h,e,u,o)}u.uniforms.pixelScale=n.toPixelScale(s),u.uniforms.antialiasWeight=o,u.uniforms.translationMatrix=n.worldTransform.toArray(!0),e.shader.bind(u,!1),e.state.setBlendMode(t.utils.correctBlendMode(t.BLEND_MODES.NORMAL,!0));for(var v=0,b=h.length;v<b;++v)h[v].render(u)}},r.prototype.increaseBufferSize=function(){var t=this.Ce,n=this.ke;return t<n&&(this.Ce=Math.min(n,t<<1),!0)},r.prototype.getBufferSize=function(){return this.Ce},r.prototype.updateBuffers=function(t,n,i,r,e){var u=this.je;u.reset(t);for(var s=0,h=n.length;null!=u.get()&&s<h;++s)if(!n[s].update(u,e)){this.increaseBufferSize();break}if(s<h){for(var o=s;o<h;++o)n[o].destroy();n.length=s}for(;null!=u.get();){var a=new po(this.getBufferSize(),i,r);if(a.update(u,e))n.push(a);else if(a.destroy(),!this.increaseBufferSize())return}},r}(t.ObjectRenderer),Eo=function(n){function r(){var i=n.call(this)||this;return i.children=[],i.Ie=0,i.Ae=-1,i.Jt=null,i.xe=new as,i.Re=1,i.Le=NaN,i.Be=new t.Point,i.Pe=[],i}return i(r,n),r.prototype.calculateBounds=function(){this._bounds.clear()},r.prototype.onChildTransformChange=function(){},r.prototype.toDirty=function(){return this.Ie+=1},r.prototype.isDirty=function(){return this.Ae<this.Ie},r.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var n=this.Ie,i=this.Ae;this.Ae=n;var e=i<n,u=this.children,s=r.SHAPE_RENDERER;null==s&&(s=r.SHAPE_RENDERER=new Mo(t)),t.batch.setObjectRenderer(s);var h=this.g;h?(t.mask.push(this,h),s.ye(this,u,e),t.mask.pop(this,h)):s.ye(this,u,e)}},r.prototype.containsPoint=function(t){return!1},r.prototype.getFontAtlases=function(){return this.xe},r.prototype.getAtlas=function(t){var n=this.Jt;return null==n&&(n=new ns(t),this.Jt=n),n},r.prototype.getBuffers=function(){return this.Pe},r.prototype.toPixelScale=function(t){this.updateTransform();var n=this.transform,i=n._worldID;if(i!==this.Le){this.Le=i;var r=n.worldTransform,e=r.a,u=r.b,s=Math.sqrt(e*e+u*u);this.Re=1/(t*s)}return this.Re},r.prototype.getPixelScale=function(){return this.Re},r.prototype.getAntialiasWeight=function(t){return 1.25/t},r.prototype.hitTest=function(t,n){for(var i=this.Be,r=this.children,e=r.length-1;0<=e;--e){var u=r[e];if(u.visible){var s=u.toLocal(t,void 0,i),h=u.contains(s);if(null!=h&&(null==n||n(h)))return h}}return null},r.prototype.hitTestBBox=function(t,n){for(var i=this.Be,r=this.children,e=r.length-1;0<=e;--e){var u=r[e];if(u.visible){var s=u.toLocal(t,void 0,i);if(u.containsBBox(s)&&(null==n||n(u)))return u}}return null},r.prototype.destroy=function(){var t=this.Pe;if(null!=t)for(var i=0,r=t.length;i<r;++i)t[i].destroy();this.Pe.length=0;var e=this.children;for(i=e.length-1;0<=i;--i)e[i].destroy();e.length=0,n.prototype.destroy.call(this)},r.SHAPE_RENDERER=null,r}(t.DisplayObject),No=function(){function t(){}return t.toIndices=function(t){for(var n=[],i=0,r=t.length;i<r;++i)n.push(t[i].index);return n},t.toDepth=function(t){for(var n=0,i=t.parent;i instanceof pn;)n+=1,i=i.parent;return n},t.toSharedParent=function(t,n){if(this.toDepth(t)<this.toDepth(n)){for(var i=t.parent;i instanceof pn;){if(this.isParent(n,i))return i;i=i.parent}return i}for(var r=n.parent;r instanceof pn;){if(this.isParent(t,r))return r;r=r.parent}return r},t.toOfParent=function(t,n){for(var i=t.parent;i!==n&&i instanceof pn;)t=i,i=i.parent;return t},t.isParent=function(t,n){for(var i=t.parent;i instanceof pn;){if(i===n)return!0;i=i.parent}return!1},t.toSelected=function(t){for(var n=t;n instanceof pn;){if(n.selected)return n;n=n.parent}return null},t.findChildById=function(n,i,r){for(var e=n.children,u=0,s=e.length;u<s;++u){var h=e[u];if(h.id===i)return h;if(!0===r){var o=t.findChildById(h,i,r);if(null!=o)return o}}return null},t.findChildByType=function(n,i,r){for(var e=n.children,u=0,s=e.length;u<s;++u){var h=e[u];if(h.type===i)return h;if(!0===r){var o=t.findChildByType(h,i,r);if(null!=o)return o}}return null},t.findChild=function(n,i,r){for(var e=n.children,u=0,s=e.length;u<s;++u){var h=e[u];if(i(h))return h;if(!0===r){var o=t.findChild(h,i,r);if(null!=o)return o}}return null},t.findChildrenByType=function(n,i,r,e){e=e||[];for(var u=n.children,s=0,h=u.length;s<h;++s){var o=u[s];o.type===i&&e.push(o),!0===r&&t.findChildrenByType(o,i,r,e)}return e},t.findChildren=function(n,i,r,e){e=e||[];for(var u=n.children,s=0,h=u.length;s<h;++s){var o=u[s];i(o)&&e.push(o),!0===r&&t.findChildren(o,i,r,e)}return e},t.COMPARATOR_INDEX=function(t,n){return t.index-n.index},t}(),To=function(){function t(){}return t.delete=function(t,n,i){for(var r=t.children,e=r.length,u=0;u<e;++u)(o=r[u]).selected?o.index=e+u:o.index=u;if(r.sort(No.COMPARATOR_INDEX),!0===i){for(u=e-1;0<=u;--u){if(!(o=r[u]).selected){var s=r.length-(u+1);if(0<s){var h=r.splice(u+1,s);return null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty(),h}return null!=n&&(n.length=0),null}o.index-=e,o.parent=null,o.selected=!1,o.uploaded=void 0}return 0<r.length?(h=r.splice(0,r.length),null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty(),h):(null!=n&&(n.length=0),null)}for(u=e-1;0<=u;--u){var o;if(!(o=r[u]).selected)return r.length=u+1,null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty(),null;o.parent=null,o.selected=!1,o.uploaded=void 0}return 0<r.length?(r.length=0,null!=n&&(n.length=0),t.onChildTransformChange(),t.toDirty()):null!=n&&(n.length=0),null},t}(),jo=function(){function t(){this.resources=[],this.resourceToIndex=new Map}return t.prototype.add=function(t){var n=this.resources,i=this.resourceToIndex,r=i.get(t);if(null!=r)return r;var e=n.length;return n.push(t),i.set(t,e),e},t.prototype.serialize=function(){return this.resources},t}(),Co={},ko=function(t){function n(){var n=t.call(this)||this;return n.Fe=!0,n._n=10,n}return i(n,t),n.prototype.toggle=function(){return this.Fe=!this.Fe,this.emit("change",this),this.Fe},n.prototype.enable=function(){!0!==this.Fe&&(this.Fe=!0,this.emit("change",this))},n.prototype.disable=function(){!1!==this.Fe&&(this.Fe=!1,this.emit("change",this))},n.prototype.isEnabled=function(){return this.Fe},Object.defineProperty(n.prototype,"size",{get:function(){return this._n},set:function(t){this._n!==t&&(this._n=t,this.emit("change",t,this))},enumerable:!0,configurable:!0}),n.prototype.snap=function(t,n){if(this.Fe){var i=this._n;n.set(t,Math.round(t/i)*i)}},n.prototype.reset=function(){this.Fe=!0,this._n=10,this.emit("change",this)},n.prototype.serialize=function(){return[this.Fe?1:0,this._n]},n.prototype.deserialize=function(t){0!==t[0]?this.enable():this.disable(),this.size=t[1]},n}(t.utils.EventEmitter),yo=function(){function t(){this.distance=NaN,this.result=0,this.threshold=10}return t.prototype.reset=function(t,n){this.distance=NaN,this.result=t,this.threshold=1e-4<n?10/n:10},t.prototype.set=function(t,n){var i=Math.abs(n-t);if(i<=this.threshold){var r=this.distance;(r!=r||i<r)&&(this.distance=i,this.result=n)}},t}();!function(t){t[t.HORIZONTAL=0]="HORIZONTAL",t[t.VERTICAL=1]="VERTICAL"}(qs||(qs={}));var Io,Ao=function(){function t(t,n){this.type=t,this.position=n}return t.prototype.serialize=function(){return[this.type,this.position]},t}(),xo=function(t){function n(){var n=t.call(this)||this;return n.values=[],n._e=!0,n.Fe=!0,n}return i(n,t),n.prototype.isEnabled=function(){return this.Fe},n.prototype.toggle=function(){return this.Fe=!this.Fe,this.emit("change",this),this.Fe},n.prototype.enable=function(){!0!==this.Fe&&(this.Fe=!0,this.emit("change",this))},n.prototype.disable=function(){!1!==this.Fe&&(this.Fe=!1,this.emit("change",this))},n.prototype.add=function(t,n){null!=n?this.values.splice(n,0,t):this.values.push(t),this.emit("change",this)},n.prototype.remove=function(t){var n=this.values;0<=t&&t<n.length&&(n.splice(t,1),this.emit("change",this))},n.prototype.size=function(){return this.values.length},n.prototype.replace=function(t,n){var i=this.values;if(0<=t&&t<i.length){var r=i[t];return i[t]=n,this.emit("change",this),r}return null},n.prototype.swap=function(t,n){if(t!==n){var i=this.values,r=i[t];i[t]=i[n],i[n]=r}},Object.defineProperty(n.prototype,"visible",{get:function(){return this._e},set:function(t){this._e!==t&&(this._e=t,this.emit("change",this))},enumerable:!0,configurable:!0}),n.prototype.snap=function(t,n,i,r){if(this.Fe)for(var e=this.values,u=0,s=e.length;u<s;++u){var h=e[u];h.type===qs.VERTICAL?i.set(t,h.position):r.set(n,h.position)}},n.prototype.reset=function(){this.Fe=!0,this._e=!0,this.values.length=0,this.emit("change",this)},n.prototype.serialize=function(){for(var t=[],n=this.values,i=0,r=n.length;i<r;++i)t.push(n[i].serialize());return[this.Fe?1:0,this._e?1:0,t]},n.prototype.deserialize=function(t){this.Fe=0!==t[0],this._e=0!==t[1];var n=t[2],i=this.values;i.length=0;for(var r=0,e=n.length;r<e;++r){var u=n[r];i.push(new Ao(u[0],u[1]))}this.emit("change",this)},n}(t.utils.EventEmitter);!function(t){t[t.NONE=0]="NONE",t[t.TOP_LEFT=1]="TOP_LEFT",t[t.TOP_CENTER=2]="TOP_CENTER",t[t.TOP_RIGHT=3]="TOP_RIGHT",t[t.MIDDLE_LEFT=4]="MIDDLE_LEFT",t[t.MIDDLE_RIGHT=5]="MIDDLE_RIGHT",t[t.BOTTOM_LEFT=6]="BOTTOM_LEFT",t[t.BOTTOM_CENTER=7]="BOTTOM_CENTER",t[t.BOTTOM_RIGHT=8]="BOTTOM_RIGHT",t[t.ROTATION=9]="ROTATION"}(Io||(Io={}));var Ro,Lo=function(n){function r(i){var r=n.call(this)||this;return r.Yi=[new t.Point,new t.Point,new t.Point,new t.Point,new t.Point],r.Ue=[new t.Point,new t.Point],r.ze=[1,1],r.Ge=new t.Point,r.He=new yo,r.Ve=new yo,r.We={distance:0,scale:new t.Point},r.Ye=new t.Point,r.Xe=new t.Rectangle,r.Ke=new t.Point,r.grid=new ko,r.target=new xo,r.Bn=i,r.Fe=!0,r}return i(r,n),r.prototype.isEnabled=function(){return this.Fe},r.prototype.toggle=function(){return this.Fe=!this.Fe,this.emit("change",this),this.Fe},r.prototype.enable=function(){!0!==this.Fe&&(this.Fe=!0,this.emit("change",this))},r.prototype.disable=function(){!1!==this.Fe&&(this.Fe=!1,this.emit("change",this))},r.prototype.prepare=function(t){t.updateTransform();var n=t.transform.localTransform,i=t.width,r=t.height,e=this.Yi;e[0].set(0,0),e[1].set(i,0),e[2].set(i,r),e[3].set(0,r),e[4].set(.5*i,.5*r),n.apply(e[0],e[0]),n.apply(e[1],e[1]),n.apply(e[2],e[2]),n.apply(e[3],e[3]),n.apply(e[4],e[4])},r.prototype.prepareForTranslate=function(t){this.Fe&&this.prepare(t)},r.prototype.snap=function(t,n){var i=t.x,r=t.y,e=this.Bn.canvas,u=this.He,s=this.Ve;if(null!=e){var h=Math.max(e.scale.x,e.scale.y);u.reset(i,h),s.reset(r,h),u.set(i,0),u.set(i,e.width),s.set(r,0),s.set(r,e.height)}else u.reset(i,1),s.reset(r,1);return this.target.snap(i,r,u,s),this.grid.snap(i,u),this.grid.snap(r,s),n.x=fs(u.distance)?NaN:u.result,n.y=fs(s.distance)?NaN:s.result,n},r.prototype.toSnapped=function(t,n){var i=t.x,r=t.y;if(this.Fe){this.snap(t,n);var e=n.x,u=n.y;n.set(fs(e)?i:e,fs(u)?r:u)}else n.set(i,r);return n},r.prototype.toTranslationSnapped=function(t,n){var i=t.x,r=t.y,e=NaN,u=NaN;if(this.Fe)for(var s=this.Ye,h=this.Yi,o=0,a=h.length;o<a;++o){var f=h[o];if(s.set(f.x+i,f.y+r),this.snap(s,s),!fs(s.x)){var c=s.x-f.x;(fs(e)||Math.abs(c-i)<Math.abs(e-i))&&(e=c)}if(!fs(s.y)){var l=s.y-f.y;(fs(u)||Math.abs(l-r)<Math.abs(u-r))&&(u=l)}}return n.x=fs(e)?i:e,n.y=fs(u)?r:u,n},r.prototype.prepareForRotate=function(t){},r.prototype.getGridSizeRotation=function(){return 5},r.prototype.toRadian=function(t){return t/180*Math.PI},r.prototype.toDegree=function(t){return t/Math.PI*180},r.prototype.toRotationSnapped=function(t,n){if(this.Fe){var i=this.getGridSizeRotation(),r=t+n,e=Math.round(this.toDegree(r)),u=e%90;return Math.abs(u)<=i?this.toRadian(e-u)-t:90-i<=u?this.toRadian(e+(90-u))-t:u<=-90+i?this.toRadian(e-(90+u))-t:n}return n},r.prototype.calcNormalizedVector=function(t,n,i){var r=n.x-t.x,e=n.y-t.y,u=Math.sqrt(r*r+e*e);if(1e-5<u){var s=1/u;i.x=r*s,i.y=e*s}else i.x=1,i.y=0;return u},r.prototype.prepareForScale=function(t,n){if(this.Fe){this.prepare(t);var i=this.Yi,r=this.Ue,e=this.ze;switch(n){case Io.TOP_LEFT:e[0]=this.calcNormalizedVector(i[1],i[0],r[0]),e[1]=this.calcNormalizedVector(i[3],i[0],r[1]);break;case Io.TOP_CENTER:e[0]=this.calcNormalizedVector(i[3],i[0],r[0]);break;case Io.TOP_RIGHT:e[0]=this.calcNormalizedVector(i[0],i[1],r[0]),e[1]=this.calcNormalizedVector(i[2],i[1],r[1]);break;case Io.MIDDLE_LEFT:e[0]=this.calcNormalizedVector(i[1],i[0],r[0]);break;case Io.NONE:break;case Io.MIDDLE_RIGHT:e[0]=this.calcNormalizedVector(i[0],i[1],r[0]);break;case Io.BOTTOM_LEFT:e[0]=this.calcNormalizedVector(i[2],i[3],r[0]),e[1]=this.calcNormalizedVector(i[0],i[3],r[1]);break;case Io.BOTTOM_CENTER:e[0]=this.calcNormalizedVector(i[0],i[3],r[0]);break;case Io.BOTTOM_RIGHT:e[0]=this.calcNormalizedVector(i[3],i[2],r[0]),e[1]=this.calcNormalizedVector(i[1],i[2],r[1])}}},r.prototype.setScaleSnappedResult=function(t,n,i,r,e){if(1e-5<n&&(fs(e.distance)||t<e.distance)){e.distance=t;var u=1+i/n;r?e.scale.x=u:e.scale.y=u}},r.prototype.calcScaleSnapped1D=function(t,n,i,r,e,u){var s=this.Ge;t.apply(n,s);var h=s.x,o=s.y;this.snap(s,s);var a=s.x,f=s.y;if(!fs(a)&&1e-5<Math.abs(i.x)){var c=(a-h)/i.x,l=Math.abs(c),v=(a-n.x)/i.x;this.setScaleSnappedResult(l,r,v,e,u)}if(!fs(f)&&1e-5<Math.abs(i.y)){var b=(f-o)/i.y,g=(l=Math.abs(b),(f-n.y)/i.y);this.setScaleSnappedResult(l,r,g,e,u)}},r.prototype.calcScaleSnappedX=function(t,n,i,r,e){this.calcScaleSnapped1D(t,n,i,r,!0,e)},r.prototype.calcScaleSnappedY=function(t,n,i,r,e){this.calcScaleSnapped1D(t,n,i,r,!1,e)},r.prototype.calcScaleSnapped2D=function(t,n,i,r,e){var u=this.Ge;t.apply(n,u);var s=u.x,h=u.y;this.snap(u,u);var o=u.x,a=u.y;if(fs(o)){if(fs(a))return;o=s}else fs(a)&&(a=h);var f=i[0].x*i[1].y-i[1].x*i[0].y;if(1e-5<Math.abs(f)){var c=o-s,l=a-h,v=Math.abs(c*c+l*l);if(fs(e.distance)||v<e.distance){e.distance=v;var b=o-n.x,g=a-n.y,d=(+i[1].y*b-i[1].x*g)/f,m=(-i[0].y*b+i[0].x*g)/f;e.scale.set(1+d/r[0],1+m/r[1])}}},r.prototype.calcScaleSnappedXY=function(t,n,i,r,e,u,s){this.calcScaleSnapped2D(t,n,e,u,s),this.calcScaleSnappedX(t,r,e[0],u[0],s),this.calcScaleSnappedY(t,i,e[1],u[1],s)},r.prototype.toScaleSnapped=function(t,n,i,r){if(this.Fe){var e=this.Yi,u=this.Ue,s=this.ze,h=this.We;switch(h.distance=NaN,h.scale.set(r.x,r.y),n){case Io.TOP_LEFT:this.calcScaleSnappedXY(t,e[0],e[1],e[3],u,s,h);break;case Io.TOP_CENTER:this.calcScaleSnappedY(t,e[0],u[0],s[0],h),this.calcScaleSnappedY(t,e[1],u[0],s[0],h);break;case Io.TOP_RIGHT:this.calcScaleSnappedXY(t,e[1],e[0],e[2],u,s,h);break;case Io.MIDDLE_LEFT:this.calcScaleSnappedX(t,e[0],u[0],s[0],h),this.calcScaleSnappedX(t,e[3],u[0],s[0],h);break;case Io.NONE:break;case Io.MIDDLE_RIGHT:this.calcScaleSnappedX(t,e[1],u[0],s[0],h),this.calcScaleSnappedX(t,e[2],u[0],s[0],h);break;case Io.BOTTOM_LEFT:this.calcScaleSnappedXY(t,e[3],e[2],e[0],u,s,h);break;case Io.BOTTOM_CENTER:this.calcScaleSnappedY(t,e[2],u[0],s[0],h),this.calcScaleSnappedY(t,e[3],u[0],s[0],h);break;case Io.BOTTOM_RIGHT:this.calcScaleSnappedXY(t,e[2],e[3],e[1],u,s,h)}if(!fs(h.distance)){if(r.copyFrom(h.scale),i)switch(n){case Io.TOP_LEFT:case Io.TOP_RIGHT:case Io.BOTTOM_LEFT:case Io.BOTTOM_RIGHT:r.x=r.y=Math.max(r.x,r.y);break;case Io.TOP_CENTER:case Io.BOTTOM_CENTER:r.x=r.y;break;case Io.MIDDLE_LEFT:case Io.MIDDLE_RIGHT:r.y=r.x;break;case Io.NONE:}return!0}}return!1},r.prototype.reset=function(){this.enable(),this.target.reset(),this.grid.reset()},r.prototype.serialize=function(){return[this.Fe?1:0,this.target.serialize(),this.grid.serialize()]},r.prototype.deserialize=function(t){0!==t[0]?this.enable():this.disable(),this.target.deserialize(t[1]),this.grid.deserialize(t[2])},r}(t.utils.EventEmitter),Bo=function(t){function n(n){var i=t.call(this)||this;return i.It=null,i.xn=!1,i.Je=!1,i.Dr=null!=n?n.onTime:void 0,i.Sr=null!=n?n.onStart:void 0,i.Mr=null!=n?n.onEnd:void 0,i}return i(n,t),Object.defineProperty(n.prototype,"target",{get:function(){return this.It},set:function(t){this.It=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"duration",{get:function(){return 0},set:function(t){},enumerable:!0,configurable:!0}),n.prototype.start=function(t){void 0===t&&(t=!1),this.stop(),this.Je=!0,this.xn=t,this.onStart(t),this.Je&&(this.onTime(t?1:0,t,0),this.Je&&(this.onTime(t?0:1,t,0),this.Je||this.onEnd(t)))},n.prototype.onStart=function(t){var n=this.Sr;null!=n&&n(t,this),this.emit("start",t,this)},n.prototype.onTime=function(t,n,i){var r=this.Dr;null!=r&&r(t,n,i,this),this.emit("time",t,n,i,this)},n.prototype.onEnd=function(t){var n=this.Mr;null!=n&&n(t,this),this.emit("end",t,this)},n.prototype.isStarted=function(){return this.Je},n.prototype.isReverse=function(){return this.xn},n.prototype.stop=function(){this.Je=!1},n.prototype.end=function(){if(this.Je){this.Je=!1;var t=this.xn,n=t?0:1;this.onTime(n,t,0),this.onEnd(t)}},n}(t.utils.EventEmitter),Po=function(t){function n(n){var i=t.call(this,n)||this;if(i.Ze=0,i.qe=0,i.Qe=0,i.$e=0,i.tu=null,i.Qr=null,null!=n&&null!=n.shift){var r=n.shift;i.nu=null!=r.x?r.x:0,i.iu=null!=r.y?r.y:15}else i.nu=0,i.iu=15;return i.ru=function(){i.onPrerender()},i.eu=function(){i.onPostrender()},i}return i(n,t),n.prototype.stop=function(){this.$e=0,this.removeEventListeners(),t.prototype.stop.call(this)},n.prototype.addEventListeners=function(t){var n=e.getLayer(t);if(n){this.Qr=n;var i=n.renderer;i.on("prerender",this.ru),i.on("postrender",this.eu)}},n.prototype.removeEventListeners=function(){var t=this.Qr;if(t){this.Qr=null;var n=t.renderer;n.off("prerender",this.ru),n.off("postrender",this.eu)}},n.prototype.onStart=function(n){var i=this.tu=this.It;null!=i&&(this.$e=0,this.removeEventListeners(),this.addEventListeners(i),n||(i.visible=!0),t.prototype.onStart.call(this,n))},n.prototype.onTime=function(n,i,r){if(null!=this.tu){var e=this.Qr;e?(e.disallowUpdate(),this.$e=n,t.prototype.onTime.call(this,n,i,r),e.allowUpdate(),e.render()):(this.$e=n,t.prototype.onTime.call(this,n,i,r))}},n.prototype.onEnd=function(n){var i=this.tu;null!=i&&(this.removeEventListeners(),n&&(i.visible=!1),t.prototype.onEnd.call(this,n))},n.prototype.onPrerender=function(){var t=this.tu;if(null!=t){var n=this.$e,i=t.unsafe.position;this.Ze=i.x,this.qe=i.y,i.set(i.x-this.nu*(1-n),i.y-this.iu*(1-n)),this.Qe=t.alpha,t.alpha=n}},n.prototype.onPostrender=function(){var t=this.tu;null!=t&&(t.unsafe.position.set(this.Ze,this.qe),t.alpha=this.Qe)},n}(Os),Fo=function(){function t(t,n,i,r){this.left=r,this.top=t,this.right=n,this.bottom=i}return t.prototype.getTheme=function(){throw new Error("Not supported")},t.prototype.setTheme=function(t){throw new Error("Not supported")},t.prototype.getTop=function(){return this.left},t.prototype.getRight=function(){return this.right},t.prototype.getBottom=function(){return this.bottom},t.prototype.getLeft=function(){return this.left},t.prototype.set=function(t,n,i,r){null==n?(this.top=t,this.right=t,this.bottom=t,this.left=t):null==i?(this.top=t,this.right=n,this.bottom=t,this.left=n):null==r?(this.top=t,this.right=n,this.bottom=i,this.left=n):(this.top=t,this.right=n,this.bottom=i,this.left=r)},t}(),_o=function(){function t(t){var n=this.uu=t.root;this.su=t.overlay;var i=t&&t.padding;c(i)?this.Dt=new Fo(i,i,i,i):this.Dt=null!=i?new Fo(i.top||0,i.right||0,i.bottom||0,i.left||0):new Fo(6,6,6,6);var r=100,e=100;if(t)if(null!=t.width)r=t.width,e=null!=t.height?t.height:n.getBoundingClientRect().height;else if(null!=t.height)r=n.getBoundingClientRect().width,e=t.height;else{var u;r=(u=n.getBoundingClientRect()).width,e=u.height}else r=(u=n.getBoundingClientRect()).width,e=u.height;var s=t&&t.background,h=0,o=!0;if(null!=s){var a=s.color;null!=a&&(h=a,o=!1)}var f=t.resolution,l=!(!t||null==t.antialias)&&t.antialias;this.hu={width:r,height:e,autoStart:!1,backgroundColor:h,transparent:o,resolution:f,antialias:l}}return t.prototype.getRootElement=function(){return this.uu},t.prototype.setRootElement=function(t,n){if(this.uu!==t&&(this.uu=t,!1!==n)){var i=t.getBoundingClientRect(),r=this.hu;r.width=i.width,r.height=i.height}return this},t.prototype.getWidth=function(){return this.hu.width},t.prototype.setWidth=function(t){return this.hu.width=t,this},t.prototype.getHeight=function(){return this.hu.height},t.prototype.setHeight=function(t){return this.hu.height=t,this},t.prototype.getPadding=function(){return this.Dt},t.prototype.setPadding=function(t,n,i,r){var e=this.Dt;return e.left=t,e.top=n,e.right=i,e.bottom=r,this},t.prototype.getBackgroundColor=function(){return this.hu.backgroundColor},t.prototype.setBackgroundColor=function(t){return this.hu.backgroundColor=t,this},t.prototype.getAntialias=function(){return this.hu.antialias},t.prototype.setAntialias=function(t){return this.hu.antialias=t,this},t.prototype.isOverlay=function(){return this.su},t.prototype.getPixiApplicationOptions=function(){return this.hu},t}(),Uo=function(t){return null!=t&&"setState"in t},zo=function(t){return null!=t&&"children"in t},Go=function(t){return null!=t&&"select"in t},Ho=function(){function t(){this.ou=null}return t.prototype.setFocused=function(t,n,i){if(n){var r=this.ou;return r!==t?(null!=r&&r.setState(v.FOCUSED,!1),this.ou=t,null!=t&&this.isFocusable(t)&&(t.setState(v.FOCUSED,!0),i&&Go(t)&&t.select()),r):null}return null!=t&&this.ou===t?(this.ou=null,t.setState(v.FOCUSED,!1),i&&Go(t)&&t.select(),t):null},t.prototype.getFocused=function(){return this.ou},t.prototype.findFocusableParent=function(t){for(var n=t;null!=n;){if(this.isFocusable(n))return n;n=n.parent}return null},t.prototype.isFocusable=function(t){return Uo(t)&&!t.hasState(v.DISABLED|v.UNFOCUSABLE)&&t.visible},t.prototype.isFocusRoot=function(t){return Uo(t)&&t.hasState(v.FOCUS_ROOT)&&t.visible},t.prototype.findFocusable=function(t,n,i,r){if(r){if(null!=(h=this.findFocusableNext(t,n,i)))return h;var e=t.parent;if(null!=e&&0<=(a=(o=e.children).indexOf(t))){for(var u=a+1,s=o.length;u<s;++u)if(null!=(c=this.findFocusableNext(o[u],!0,!0)))return c;if(this.isFocusRoot(e))for(u=0,s=a+1;u<s;++u)if(null!=(c=this.findFocusableNext(o[u],!0,!0)))return c;return this.findFocusable(e,!1,!1,!0)}}else{var h;if(null!=(h=this.findFocusablePrevious(t,n,i)))return h;var o,a,f=t.parent;if(null!=f&&0<=(a=(o=f.children).indexOf(t))){for(u=a-1;0<=u;--u)if(null!=(c=this.findFocusablePrevious(o[u],!0,!0)))return c;if(this.isFocusRoot(f)){for(u=o.length-1;a<=u;--u){var c;if(null!=(c=this.findFocusablePrevious(o[u],!0,!0)))return c}return f}return this.findFocusable(f,!0,!1,!1)}}return null},t.prototype.findFocusableNext=function(t,n,i){if(n&&this.isFocusable(t))return t;if(i&&zo(t)&&t.visible)for(var r=t.children,e=0,u=r.length;e<u;++e){var s=this.findFocusableNext(r[e],!0,!0);if(null!=s)return s}return this.isFocusRoot(t)?t:null},t.prototype.findFocusablePrevious=function(t,n,i){if(i&&zo(t)&&t.visible)for(var r=t.children,e=r.length-1;0<=e;--e){var u=this.findFocusablePrevious(r[e],!0,!0);if(null!=u)return u}return n&&this.isFocusable(t)?t:this.isFocusRoot(t)?t:null},t}();!function(t){t[t.NONE=0]="NONE",t[t.UNSTORABLE=1]="UNSTORABLE",t[t.CLEAR=2]="CLEAR"}(Ro||(Ro={}));var Vo,Wo=function(){function t(){}return t.prototype.execute=function(){return!0},t.prototype.redo=function(){throw new Error("Method not implemented.")},t.prototype.undo=function(){throw new Error("Method not implemented.")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Ro.UNSTORABLE|Ro.CLEAR},t}(),Yo=function(){function t(){}return t.prototype.execute=function(){throw new Error("Not supported")},t.prototype.redo=function(){throw new Error("Not supported")},t.prototype.undo=function(){throw new Error("Not supported")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Ro.UNSTORABLE},t}(),Xo=function(){function t(){}return t.prototype.execute=function(){throw new Error("Not supported")},t.prototype.redo=function(){throw new Error("Not supported")},t.prototype.undo=function(){throw new Error("Not supported")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Ro.UNSTORABLE},t}(),Ko=function(t){return 0==(t.getFlag()&Ro.UNSTORABLE)},Jo=function(t){function n(){var n=t.call(this)||this;return n.et=0,n.au=[],n.fu=[],n.cu=null,n}return i(n,t),n.prototype.last=function(){var t=this.au,n=this.fu;return n.length<=0?0<t.length?t[t.length-1]:null:n[n.length-1]},n.prototype.push=function(t){this.fu.push(t),this.next()},n.prototype.next=function(){var t=this;if(null==this.cu){var n=this.fu;if(0<n.length){var i=n.shift();if(null!=i)if(i instanceof Xo){var r=this.au;if(this.et<r.length){var e=r[r.length-1-this.et];this.et+=1,this.emit("change",this),!0===(u=e.undo())?this.onSuccess(i):!1===u?this.onFail(i):this.cu=u.then((function(){t.onSuccess(i)}),(function(){t.onFail(i)}))}}else if(i instanceof Yo)r=this.au,0<this.et&&(e=r[r.length-this.et],this.et-=1,this.emit("change",this),!0===(u=e.redo())?this.onSuccess(i):!1===u?this.onFail(i):this.cu=u.then((function(){t.onSuccess(i)}),(function(){t.onFail(i)})));else{var u,s=0!=(i.getFlag()&Ro.CLEAR),h=Ko(i);if(s||h){var o=s?this.au.length:this.et;0<o&&(this.remove(o),this.et=0,this.emit("change",this)),this.cleanup()}!0===(u=i.execute())?this.onSuccess(i):!1===u?this.onFail(i):this.cu=u.then((function(){t.onSuccess(i)}),(function(){t.onFail(i)}))}}}},n.prototype.cleanup=function(){var t=this.au,n=t.length-100;if(0<n)for(var i=0;i<n;++i)t[i].destroy(),t.shift()},n.prototype.remove=function(t){var n=this.au;if(0<t){var i=Math.max(0,n.length-t);if(0<(t=n.length-i)){for(var r=i,e=n.length;r<e;++r)n[r].destroy();return n.splice(i,n.length-i),!0}}return!1},n.prototype.onSuccess=function(t){this.cu=null,Ko(t)?(this.au.push(t),this.emit("dirty",this)):(t instanceof Xo||t instanceof Yo)&&this.emit("dirty",this),this.emit("change",this),this.next()},n.prototype.onFail=function(t){this.cu=null;var n=this.fu;t.destroy();for(var i=0,r=n.length;i<r;++i)n[i].destroy();n.length=0,this.emit("change",this)},n.prototype.size=function(){return this.au.length},n.prototype.clear=function(){this.push(new Wo)},n.prototype.redo=function(){this.isRedoable()&&(this.fu.push(new Yo),this.next())},n.prototype.undo=function(){this.isUndoable()&&(this.fu.push(new Xo),this.next())},n.prototype.isRedoable=function(){return 0<this.et&&null==this.cu},n.prototype.isUndoable=function(){return this.et<this.au.length&&null==this.cu},n}(t.utils.EventEmitter),Zo=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(t,n,i){var r=this;t.addEventListener("keydown",(function(t){r.emit("keydown",t);var e=i.getFocused();if(null!=e)for(var u=e;null!=u;){if(r.hasOnKeyDown(u)&&u.onKeyDown(t))return;u=u.parent}if(B.isFocusKey(t)){var s=B.getFocusDirection(t),h=null!=e?i.findFocusable(e,!1,e.hasState(v.FOCUS_ROOT)||s,s):i.findFocusable(n,!1,!0,s);null!=h&&(i.setFocused(h,!0,!0),t.preventDefault(),t.stopImmediatePropagation())}})),t.addEventListener("keyup",(function(t){r.emit("keyup",t);var n=i.getFocused();if(null!=n)for(var e=n;null!=e;){if(r.hasOnKeyUp(e)&&e.onKeyUp(t))return;e=e.parent}}))},n.prototype.hasOnKeyDown=function(t){return"onKeyDown"in t},n.prototype.hasOnKeyUp=function(t){return"onKeyUp"in t},n}(t.utils.EventEmitter),qo=function(){function t(){}return t.getKeyboardController=function(){return null==this.KEYBOARD&&(this.KEYBOARD=new Zo),this.KEYBOARD},t.setKeyboardController=function(t){var n=this.KEYBOARD;return this.KEYBOARD=t,n},t.getCommandController=function(){return null==this.COMMAND&&(this.COMMAND=new Jo),this.COMMAND},t.setCommandController=function(t){var n=this.COMMAND;return this.COMMAND=t,n},t.getDocumentController=function(){if(null==this.DOCUMENT)throw new Error("Not supported");return this.DOCUMENT},t.setDocumentController=function(t){var n=this.DOCUMENT;return this.DOCUMENT=t,n},t}(),Qo=function(n){function r(i,r){var e=n.call(this,r.getPixiApplicationOptions())||this;e.lu=null,e.vu=null,e.application=i;var u=e.stage;u.layer=e,u.application=i,e.ht=r,e.bu=!0,e.gu=5,e.du=5,e._e=!0,e.mu=function(){null!=e.lu&&e.render()};var s=r.getRootElement(),h=document.createElement("div");h.setAttribute("style","position: absolute; top: 0; left: 0; width: 0; height: 0;margin: 0; padding: 0; outline: none;"),e.wu=h;var o=s.children;if(r.isOverlay()){if(3<=o.length){var a=o[2];s.insertBefore(e.view,a),s.insertBefore(h,a)}else s.appendChild(e.view),s.appendChild(h);var f=u.onChildrenChange;u.onChildrenChange=function(){e.updateVisibility(),f.call(u)}}else if(0<o.length){var c=o[0];s.insertBefore(e.view,c),s.insertBefore(h,c)}else s.appendChild(e.view),s.appendChild(h);var l=s.style;s!==document.body&&"static"===window.getComputedStyle(s).position&&(l.position="relative"),l.margin="0",l.padding="0",l.overflow="hidden";var v=e.view.style;v.position="absolute",v.top="0",v.left="0",v.width="100%",v.height="100%",v.display="block",v.outline="none";var b=!1,g=e.getFocusController(),d=function(){b||g.setFocused(null,!0,!1)};s.addEventListener("focus",(function(t){b=!0}),!0),s.addEventListener("blur",(function(t){b=!1,setTimeout(d,0)}),!0),e.view.setAttribute("tabindex","0"),qo.getKeyboardController().init(e.view,e.stage,g);var m=e.renderer.plugins.interaction;m.on(P.down,(function(t){null==t.target&&g.setFocused(null,!0,!1)}));var w=function(){var t=r.getRootElement().getBoundingClientRect();e.renderer.resize(t.width,t.height),e.resizeChildren(t.width,t.height,r.getPadding()),e.update()};window.addEventListener("resize",w),window.addEventListener("orientationchange",w);var p=new t.Point,D=_s.getInstance();return D.on(e.view,(function(t){var n=t;P.toGlobal(n,m,p);var i,r=m.hitTest(p),e=D.normalize(t);if(null!=e)for(;null!=r;){if(null!=(i=r)&&null!=i.onWheel&&r.onWheel(n,e,p)){n.preventDefault();break}r=r.parent}})),P.onDblClick(e.view,(function(t){var n,i=g.getFocused();if(null!=i)for(var r=i;null!=r&&(null==(n=r)||null==n.onDblClick||!r.onDblClick(t,m));)r=r.parent})),e.stage.interactive=!0,e}return i(r,n),r.prototype.disallowUpdate=function(){this.bu=!1},r.prototype.allowUpdate=function(){this.bu=!0},r.prototype.update=function(){this.bu&&null==this.lu&&(this.lu=requestAnimationFrame(this.mu))},r.prototype.updateVisibility=function(){this.ht.isOverlay()&&(0<this.stage.children.length?this._e||(this._e=!0,this.view.style.display="block"):this._e&&(this._e=!1,this.view.style.display="none"))},r.prototype.render=function(){this.refit(),this.reflow(),this.lu=null,n.prototype.render.call(this)},Object.defineProperty(r.prototype,"width",{get:function(){return this.screen.width},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"height",{get:function(){return this.screen.height},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"padding",{get:function(){return this.ht.getPadding()},enumerable:!0,configurable:!0}),r.prototype.resizeChildren=function(t,n,i){for(var r=this.stage.children,e=0,u=r.length;e<u;++e){var s=r[e];s instanceof z&&s.onParentResize(t,n,i)}},r.prototype.refit=function(){for(var t=this.stage.children,n=0,i=this.gu;n<i;++n){for(var r=!1,e=0,u=t.length;e<u;++e){var s=t[e];s instanceof z&&(s.refit(),r=r||s.isChildrenDirty())}if(!r)break}},r.prototype.reflow=function(){for(var t=this.stage.children,n=0,i=this.gu;n<i;++n){for(var r=!1,e=0,u=t.length;e<u;++e){var s=t[e];s instanceof z&&(s.reflow(),r=r||s.isDirty()||s.hasDirty())}if(!r)break}},r.prototype.getFocusController=function(){return null==this.pu&&(this.pu=new Ho),this.pu},r.prototype.getElementContainer=function(){return this.wu},r.prototype.getDynamicFontAtlases=function(){return null==this.vu&&(this.vu=new os(this)),this.vu},r}(t.Application),$o=function(){function n(n){e.add(this),this.uu=this.toRootElement(n);var i=n&&null!=n.resolution?n.resolution:window.devicePixelRatio||1;this.or=i,delete t.Renderer.__plugins.accessibility,this.ht=n;var r=this.Du=this.newLayerBase(n);this.Ou=!(!n||!n.overlay),this.Ou||(this.su=r)}return Object.defineProperty(n.prototype,"stage",{get:function(){return this.Du.stage},enumerable:!0,configurable:!0}),n.prototype.getRootElement=function(){return this.uu},n.prototype.getResolution=function(){return this.or},n.prototype.toRootElement=function(t){var n=t&&t.root;if(null!=n){if(!o(n))return n;var i=document.querySelector(n);if(i)return i}return document.body},n.prototype.toLayerBaseOptions=function(t){var n=this.uu,i=this.or;return new _o(t?{root:n,padding:t.padding,width:t.width,height:t.height,background:t.background,resolution:i,antialias:t.antialias,overlay:!1}:{root:n,resolution:i,overlay:!1})},n.prototype.newLayerBase=function(t){return new Qo(this,this.toLayerBaseOptions(t))},n.prototype.getLayerBase=function(){return this.Du},n.prototype.toLayerOverlayOptions=function(t){var n=this.uu,i=this.or;return new _o(t?{root:n,padding:t.padding,width:t.width,height:t.height,background:{color:null},resolution:i,antialias:t.antialias,overlay:!0}:{root:n,resolution:i,overlay:!0})},n.prototype.newLayerOverlay=function(t){return new Qo(this,this.toLayerOverlayOptions(t))},n.prototype.getLayerOverlay=function(){return this.Ou?(null==this.su&&(this.su=this.newLayerOverlay(this.ht)),this.su):this.Du},n.prototype.update=function(){if(!this.Ou)return this.Du.update();this.Du.update();var t=this.su;t&&t.update()},n.prototype.render=function(){if(!this.Ou)return this.Du.render();this.Du.render();var t=this.su;t&&t.render()},n}(),ta=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DBoard"},n}(z),na=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.buttonMode=!0,this.Su=function(t,n){return null!=n&&null!=n.toggle?n.toggle:t.isToggle()}(this.theme,n),this.Mu=function(){i.setPressed(!1);var t=i.Eu;null!=t&&t.off(P.up,i.Mu)},this.Eu=null,this.setActiveHandlers(),null!=n&&null!=n.group&&n.group.add(this)},n.prototype.onShortcut=function(n){t.prototype.onShortcut.call(this,n),this.onClick()},n.prototype.isToggle=function(){return this.Su},n.prototype.setActiveHandlers=function(){var t=this;P.onClick(this,(function(){t.onClick()})),this.isToggle()||this.on(P.down,(function(){t.setPressed(!0);var n=e.getLayer(t);n&&(t.Eu=n.stage).on(P.up,t.Mu)}))},n.prototype.onStateChange=function(n,i){t.prototype.onStateChange.call(this,n,i),this.buttonMode=N.isActionable(n)},n.prototype.getType=function(){return"DButton"},n.prototype.onClick=function(){this.isActionable()&&(this.isToggle()?(this.onToggleStart(),this.onToggleEnd()):this.emit("active",this))},n.prototype.onToggleStart=function(){this.setActive(!this.isActive())},n.prototype.onToggleEnd=function(){this.emit(this.isActive()?"active":"inactive",this)},n.prototype.onActivateKeyDown=function(){this.isActionable()&&(this.isToggle()?this.onToggleStart():this.setPressed(!0))},n.prototype.onActivateKeyUp=function(){this.isActionable()&&(this.isToggle()?this.onToggleEnd():(this.isPressed()&&this.emit("active",this),this.setPressed(!1)))},n.prototype.onKeyDown=function(n){return B.isActivateKey(n)&&this.onActivateKeyDown(),t.prototype.onKeyDown.call(this,n)},n.prototype.onKeyUp=function(n){return B.isActivateKey(n)&&this.onActivateKeyUp(),t.prototype.onKeyUp.call(this,n)},n.prototype.destroy=function(){var n=this.ht;null!=n&&null!=n.group&&n.group.remove(this),t.prototype.destroy.call(this)},n}(Q),ia=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButton"},n}(na),ra=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonAmbient"},n}(ia),ea=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonCheck"},n}(na),ua=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonCheckRight"},n}(ea),sa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonPrimary"},n}(ia);!function(t){t[t.NONE=0]="NONE",t[t.ESC=1]="ESC",t[t.CLICK_OUTSIDE=2]="CLICK_OUTSIDE"}(Vo||(Vo={}));var ha,oa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.visible=!1,this.setState(v.FOCUS_ROOT,!0),this.Nu=null,this.Tu=!1;var r=this.xr=n&&n.animation?n.animation:new Po;r.target=this,r.on("end",(function(t){i.onAnimationEnd(t)})),(this.ju=n&&null!=n.closeOn?n.closeOn:this.theme.closeOn())&Vo.CLICK_OUTSIDE&&ws.apply(this,(function(){i.onCloseOn()})),this.su=new xs},n.prototype.onAnimationEnd=function(t){if(t){var n=this.parent;n&&n.removeChild(this)}else{var i=e.getLayer(this);if(i){var r=i.getFocusController();this.Nu=r.getFocused();var u=r.findFocusable(this,!1,!0,!0);r.setFocused(u||this,!0,!0)}}},n.prototype.open=function(){if(!this.Tu){var t=this.su.pick(this);this.Tu=!0,t.stage.addChild(this),this.onOpen()}},n.prototype.onOpen=function(){this.emit("open",this),this.xr.start()},n.prototype.isOpened=function(){return this.Tu},n.prototype.close=function(){this.Tu&&(this.Tu=!1,this.onClose())},n.prototype.onClose=function(){var t=this.Nu;if(null!=t){this.Nu=null;var n=e.getLayer(this);n&&n.getFocusController().setFocused(t,!0,!1)}this.xr.start(!0),this.emit("close",this)},n.prototype.getType=function(){return"DDialog"},n.prototype.onKeyDown=function(n){return this.ju&Vo.ESC&&B.isCancelKey(n)&&this.onCloseOn(),t.prototype.onKeyDown.call(this,n)},n.prototype.onCloseOn=function(){this.close()},n.prototype.containsGlobalPoint=function(t){return!0},n}(z),aa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DLayoutHorizontal"},n}(Et),fa=function(t){function n(){var n=null!==t&&t.apply(this,arguments)||this;return n.Cu=null,n.ku=null,n.yu=null,n}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=this.theme,e=new Nt({parent:this,x:r.getLayoutX(),y:r.getLayoutY(),width:r.getLayoutWidth(),height:r.getLayoutHeight()});this.onInit(e,n);var u=n&&n.ok||r.getOk(),s=n&&n.cancel||r.getCancel();if(null!=u||null!=s){var h=new aa({parent:e,width:"padding",height:"auto",padding:{top:this.padding.getTop()}});this.Iu=h,new pt({parent:h,weight:1}),null!=u&&null!=s?(this.Au=new sa({parent:h,text:{value:s},on:{active:function(){i.onCancel()}}}),this.xu=new ia({parent:h,text:{value:u},on:{active:function(){i.onOk()}}})):null!=u?this.xu=new sa({parent:h,text:{value:u},on:{active:function(){i.onOk()}}}):null!=s&&(this.Au=new sa({parent:h,text:{value:s},on:{active:function(){i.onCancel()}}})),new pt({parent:h,weight:1})}},n.prototype.onInit=function(t,n){},n.prototype.open=function(){return t.prototype.open.call(this),this.Cu},n.prototype.onOpen=function(){var n=this;t.prototype.onOpen.call(this),null==this.Cu&&(this.Cu=new Promise((function(t,i){n.ku=t,n.yu=i})))},n.prototype.onClose=function(){t.prototype.onClose.call(this);var n=this.yu;this.Cu=null,this.ku=null,this.yu=null,null!=n&&n()},n.prototype.onOk=function(){var t=this.ku;this.Cu=null,this.ku=null,this.yu=null,this.close(),null!=t&&t(),this.emit("ok",this)},n.prototype.onCancel=function(){var t=this.yu;this.Cu=null,this.ku=null,this.yu=null,this.close(),null!=t&&t(),this.emit("cancel",this)},n.prototype.getType=function(){return"DDialogCommand"},n}(oa);!function(t){t[t.FOCUSED=0]="FOCUSED",t[t.ALWAYS=1]="ALWAYS"}(ha||(ha={}));var ca,la=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(t){var i=this;n.prototype.init.call(this,t),this.zi=null;var r=this.theme,e=t&&t.clipper,u=e&&e.creator||r.getClipperCreator();this.Ru=null,this.Lu=u,this.Bu=null;var s=t&&t.element,h=s&&s.creator||r.getElementCreator();this.Pu=null,this.Fu=h,this._u=s&&s.style,this.Uu=null,this.zu=!1,this.Gu=!1,this.Hu=function(t){i.onElementFocused(t)};var a=t&&t.before;this.Vu=null,this.Wu=a&&a.creator||r.getBeforeCreator(),this.Yu=a&&a.style,this.Xu=function(t){i.onBeforeFocused(t)};var f=t&&t.after;this.Ku=null,this.Ju=f&&f.creator||r.getAfterCreator(),this.Zu=f&&f.style,this.qu=function(t){i.onAfterFocused(t)},this.Je=!1,this.Qu=t&&null!=t.select?t.select:r.getSelect(),this.$u=function(){i.doSelect()};var c=t&&null!=t.when?o(t.when)?ha[t.when]:t.when:r.getWhen();this.ts=c,c===ha.ALWAYS&&this.start()},Object.defineProperty(r.prototype,"element",{get:function(){return this.Pu},enumerable:!0,configurable:!0}),r.prototype.onFocused=function(){if(n.prototype.onFocused.call(this),this.ts===ha.FOCUSED)this.start();else{var t=this.Pu;t&&t.focus()}},r.prototype.onBlured=function(){n.prototype.onBlured.call(this),this.ts===ha.FOCUSED&&(this.onEndByBlured(),this.cancel())},r.prototype.isStartable=function(){return this.ts!==ha.FOCUSED||!this.isDisabled()},r.prototype.start=function(){!this.Je&&this.isStartable()&&(this.Je=!0,e.update(this))},r.prototype.render=function(t){this.Je&&(this.Je=!1,this.doStart(t)),n.prototype.render.call(this,t),this.zu&&this.updateElement(t)},r.prototype.doStart=function(t){if(!this.zu){this.zu=!0,this.onStart();var n=this.getClipper();if(n){var i=this.getBefore(n),r=this.getElement(n),e=this.getAfter(n);if(r){var u=t.resolution,s=this.getElementRect(u),h=this.getClipperRect(s,u),o=this.theme,a=this.state;this.setClipperStyle(n,a,o,s,h),this.setElementStyle(r,a,o,s,h),i&&this.setBeforeStyle(i,o),e&&this.setAfterStyle(e,o),this.onElementAttached(r,i,e),n.style.display="",this.isFocused()&&r.focus(),n.scrollTop=0,n.scrollLeft=0,this.Gu&&this.Qu&&"select"in r&&setTimeout(this.$u,0)}}}},r.prototype.doSelect=function(){if(this.zu){var t=this.Pu;t&&this.Gu&&this.Qu&&"select"in t&&(this.Gu=!1,t.select())}},r.prototype.createText=function(t){var i=n.prototype.createText.call(this,t);return this.zu&&this.onStart(),i},r.prototype.getClipperRect=function(n,i){for(var r=this.zi=this.zi||new t.Point(0,0),e=this.Bu=this.Bu||new t.Rectangle,u=n.x,s=n.y,h=u+n.width,o=s+n.height,a=this.parent;a instanceof z;){a.getClippingRect(this,e),r.set(e.x,e.y),a.toGlobal(r,r,!1);var f=(r.x*i|0)/i,c=(r.y*i|0)/i;r.set(e.x+e.width,e.y+e.height),a.toGlobal(r,r,!0);var l=r.x-f,v=r.y-c;u=Math.min(Math.max(u,f),f+l),s=Math.min(Math.max(s,c),c+v),h=Math.min(Math.max(h,f),f+l),o=Math.min(Math.max(o,c),c+v),a=a.parent}return e.x=u,e.y=s,e.width=h-u,e.height=o-s,e},r.prototype.getElementRect=function(n){var i=this.zi=this.zi||new t.Point(0,0),r=this.Uu=null!=this.Uu?this.Uu:new t.Rectangle;return i.set(0,0),this.toGlobal(i,i,!1),r.x=i.x,r.y=i.y,i.set(this.width,this.height),this.toGlobal(i,i,!0),r.width=i.x-r.x,r.height=i.y-r.y,r.x=(r.x*n|0)/n,r.y=(r.y*n|0)/n,r},r.prototype.cancel=function(){if(this.zu){this.zu=!1,this.onCancel();var t=this.Ru;null!=t&&(t.style.display="none");var n=this.Pu;null!=n&&this.onElementDetached(n,this.Vu,this.Ku),this.Gu=!1;var i=e.getLayer(this);if(i){var r=i.view;this.ts===ha.FOCUSED&&r.focus();var u=i.renderer.plugins.interaction;this.containsPoint(u.mouse.global)&&!this.isHovered()&&(this.setHovered(!0),r.style.cursor=this.cursor),i.update()}}},r.prototype.onStart=function(){},r.prototype.onCancel=function(){},r.prototype.onElementAttached=function(t,n,i){n&&n.addEventListener("focus",this.Xu),i&&i.addEventListener("focus",this.qu),t.addEventListener("focus",this.Hu,!0)},r.prototype.onElementDetached=function(t,n,i){n&&n.removeEventListener("focus",this.Xu),i&&i.removeEventListener("focus",this.qu),t.removeEventListener("focus",this.Hu,!0)},r.prototype.getElement=function(t){var n=this.Pu;if(null==n){var i=this.Fu;i&&(n=i(t),this.Pu=n)}return n},r.prototype.getClipper=function(){var t=this.Ru;if(null==t){var n=this.Lu,i=e.getLayer(this);n&&i&&(t=n(i.getElementContainer()),this.Ru=t)}return t},r.prototype.getBefore=function(t){var n=this.Vu;if(null==n){var i=this.Wu;i&&(n=i(t),this.Vu=n)}return n},r.prototype.getAfter=function(t){var n=this.Ku;if(null==n){var i=this.Ju;i&&(n=i(t),this.Ku=n)}return n},r.prototype.setElementStyle=function(t,n,i,r,e){var u=this._u;return u?u(t,n,i,r,e):this.theme.setElementStyle(t,n,r,e)},r.prototype.setClipperStyle=function(t,n,i,r,e){var u=this.ns;return u?u(t,n,i,r,e):this.theme.setClipperStyle(t,n,r,e)},r.prototype.setBeforeStyle=function(t,n){var i=this.Yu;return i?i(t,n):this.theme.setBeforeStyle(t)},r.prototype.setAfterStyle=function(t,n){var i=this.Zu;return i?i(t,n):this.theme.setAfterStyle(t)},r.prototype.onBeforeFocused=function(t){var n=e.getLayer(this);if(n){var i=n.getFocusController(),r=i.findFocusable(this,!1,!1,!1);n.view.focus(),i.setFocused(r,!0,!0),t.preventDefault(),t.stopImmediatePropagation()}},r.prototype.onAfterFocused=function(t){var n=e.getLayer(this);if(n){var i=n.getFocusController(),r=i.findFocusable(this,!1,!1,!0);n.view.focus(),i.setFocused(r,!0,!0),t.preventDefault(),t.stopImmediatePropagation()}},r.prototype.onElementFocused=function(t){this.ts===ha.ALWAYS&&(this.isFocused()||this.focus())},r.prototype.onEndByBlured=function(){this.onEnd()},r.prototype.onEnd=function(){},r.prototype.end=function(){this.onEnd(),this.cancel()},r.prototype.select=function(){var t=this.Pu;return null!=t&&this.zu&&this.Qu&&"select"in t?t.select():this.Gu=!0,this},r.prototype.updateElement=function(t){if(this.zu)if(this.worldVisible){var n=this.Pu,i=this.Ru;if(n&&i){var r=t.resolution,e=this.getElementRect(r),u=this.getClipperRect(e,r),s=this.theme,h=this.state;this.setClipperStyle(i,h,s,e,u),this.setElementStyle(n,h,s,e,u)}}else this.cancel()},r.prototype.getType=function(){return"DHtmlElement"},r}(Q),va=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;this.rs=null,this.es=n&&n.editing&&n.editing.validator||this.theme.getEditingValidator(),t.prototype.init.call(this,n),this.us=n&&n.description||"",this.ss=n&&n.editing&&n.editing.formatter||n&&n.text&&n.text.formatter||this.theme.getEditingFormatter(),this.hs=n&&n.editing&&n.editing.unformatter||this.theme.getEditingUnformatter(),this.Li=function(t){i.onInputKeyDown(t)},this.Fi=function(){i.onInputChange()},this._i=function(t){i.onInputInput(t)}},Object.defineProperty(n.prototype,"value",{get:function(){return this.rn},set:function(t){this.text=t},enumerable:!0,configurable:!0}),n.prototype.onTextChange=function(){t.prototype.onTextChange.call(this),this.validate()},n.prototype.validate=function(){var t=this.es(this.rn,this);return this.rs!==t&&(this.rs=t,this.setInvalid(null!=t),this.isHovered()&&this.applyTitle()),t},n.prototype.applyTitle=function(){var n=this.rs;if(o(n)){var i=e.getLayer(this);i&&(i.view.title=n)}else t.prototype.applyTitle.call(this)},n.prototype.onStart=function(){t.prototype.onStart.call(this);var n=this.qt;null!=n&&(n.visible=!1)},n.prototype.onCancel=function(){t.prototype.onCancel.call(this);var n=this.qt;null!=n&&(n.visible=!0)},n.prototype.onEnd=function(){t.prototype.onEnd.call(this),this.onInputChange()},n.prototype.onElementAttached=function(n,i,r){t.prototype.onElementAttached.call(this,n,i,r),n.type=this.getInputType(),n.value=this.ss(this.rn,this),n.addEventListener("keydown",this.Li),n.addEventListener("change",this.Fi),n.addEventListener("input",this._i)},n.prototype.onElementDetached=function(n,i,r){t.prototype.onElementDetached.call(this,n,i,r),n.removeEventListener("keydown",this.Li),n.removeEventListener("change",this.Fi),n.removeEventListener("input",this._i)},n.prototype.onInputKeyDown=function(t){B.isOkKey(t)?(this.end(),this.emit("enter",this)):B.isCancelKey(t)&&this.cancel()},n.prototype.onInputChange=function(){if(this.zu){var t=this.Pu;if(null!=t){var n=this.toValue(t.value),i=this.rn;i!==n&&(this.text=n,this.emit("change",n,i,this))}}},n.prototype.onInputInput=function(t){t.target instanceof HTMLInputElement&&this.emit("input",this.toValue(t.target.value),this)},n.prototype.onDownThis=function(n){this.isFocused()&&this.start(),t.prototype.onDownThis.call(this,n)},n.prototype.getType=function(){return"DInput"},n}(la),ba=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=this.theme;this.os=function(t,n){return null!=n?null!=n.step?n.step:t.getStep():null}(i,n),this.fs=function(t,n){return null!=n?null!=n.min?n.min:t.getMin():null}(i,n),this.cs=function(t,n){return null!=n?null!=n.max?n.max:t.getMax():null}(i,n)},Object.defineProperty(n.prototype,"step",{get:function(){return this.os},set:function(t){this.os!==t&&(this.os=t,this.updateInputStep())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"min",{get:function(){return this.fs},set:function(t){this.fs!==t&&(this.fs=t,this.updateInputMin())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"max",{get:function(){return this.cs},set:function(t){this.cs!==t&&(this.cs=t,this.updateInputMax())},enumerable:!0,configurable:!0}),n.prototype.toValue=function(t){var n=this.hs(t,this);return n==n?null!=this.fs&&n<this.fs?this.fs:null!=this.cs&&this.cs<n?this.cs:n:this.value},n.prototype.updateInputStep=function(){if(this.zu){var t=this.Pu;t&&this.initInputStep(t)}},n.prototype.updateInputMin=function(){if(this.zu){var t=this.Pu;t&&this.initInputMin(t)}},n.prototype.updateInputMax=function(){if(this.zu){var t=this.Pu;t&&this.initInputMax(t)}},n.prototype.initInputStep=function(t){null!=this.os?t.step=String(this.os):t.removeAttribute("step")},n.prototype.initInputMin=function(t){null!=this.fs?t.min=""+this.fs:t.removeAttribute("min")},n.prototype.initInputMax=function(t){null!=this.cs?t.max=""+this.cs:t.removeAttribute("max")},n.prototype.onElementAttached=function(n,i,r){t.prototype.onElementAttached.call(this,n,i,r),this.initInputStep(n),this.initInputMin(n),this.initInputMax(n)},n.prototype.getInputType=function(){return"number"},n}(va),ga=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DInputReal"},n}(ba),da=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.setState(v.UNFOCUSABLE,!0)},n.prototype.getType=function(){return"DText"},n}(q),ma=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DInputLabel"},n}(da),wa=function(t){function n(n){var i=t.call(this,n)||this;return i.addChild(i.ls=new ma(null!=n?n.label:void 0)),i.addChild(i.Kr=i.createInput(null!=n?n.input:void 0)),null!=n&&null!=n.space&&i.addChild(new pt(n.space)),i}return i(n,t),Object.defineProperty(n.prototype,"input",{get:function(){return this.Kr},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"label",{get:function(){return this.ls},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DInputAndLabel"},n}(aa),pa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.createInput=function(t){return new ga(t)},n}(wa),Da=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.toValue=function(t){return this.hs(t,this)},n.prototype.getInputType=function(){return"text"},n.prototype.getType=function(){return"DInputText"},n}(va),Oa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.createInput=function(t){return new Da(t)},n}(wa),Sa=function(){function t(t,n,i){this.vs=t,this.bs=n,this.gs=i}return Object.defineProperty(t.prototype,"color",{get:function(){return this.vs.color},set:function(t){if(this.vs.color!==t){var n=this.bs;null!=n&&n(t)}},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.vs.alpha},set:function(t){if(this.vs.alpha!==t){var n=this.gs;null!=n&&n(t)}},enumerable:!0,configurable:!0}),t}(),Ma=function(t){function n(n,i){var r=t.call(this)||this;return r.ms=n,r.ci=i,r}return i(n,t),n.prototype.get=function(t){var n=this.ms;return 0<=t&&t<n.length?n[n.length-1-t]:null},n.prototype.set=function(t,n){var i=this.ms;if(0<=t&&t<i.length){var r=i[i.length-1-t];return i[i.length-1-t]={color:n.color,alpha:n.alpha},this.emit("change",this),r}return null},n.prototype.contains=function(t){for(var n=this.ms,i=0,r=n.length;i<r;++i){var e=n[i];if(e.color===t.color&&e.alpha===t.alpha)return!0}return!1},n.prototype.add=function(t){var n=this.ms;return n.push({color:t.color,alpha:t.alpha}),this.ci<n.length&&n.shift(),this.emit("change",this),this},n.prototype.pop=function(){var t=this.ms.shift();return null!=t?(this.emit("change",this),t):null},n.prototype.size=function(){return this.ms.length},n}(t.utils.EventEmitter),Ea=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),Object.defineProperty(r.prototype,"current",{get:function(){return this.ws},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"new",{get:function(){return this.ps},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"recent",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),r.prototype.init=function(i){var e=this;n.prototype.init.call(this,i),this.setState(v.UNFOCUSABLE,!0),this.Du=16711680,this.Os={color:16777215,alpha:1},this.ps=new Sa(this.Os,(function(t){e.setColorNew(t)}),(function(t){e.setAlphaNew(t)})),this.ue={color:16777215,alpha:1},this.ws=new Sa(this.ue,(function(t){e.setColorCurrent(t)}),(function(t){e.setAlphaCurrent(t)}));var u=this.theme,s=this.Dt,h=s.getTop(),o=s.getRight(),a=s.getBottom(),f=s.getLeft();this.Ss=new t.Point;var c=u.getMainWidth(),l=u.getMainHeight(),b=this.Ms=new t.Sprite(t.Texture.WHITE);b.x=f,b.y=h,b.width=c,b.height=l,b.interactive=!0,this.addChild(b);var g=this.Es=new t.Sprite(u.getMainTexture());g.x=f,g.y=h,g.tint=this.Du,g.interactive=!1,this.addChild(g),this.Ns=function(t){e.onMainMove(t)},this.Ts=function(t){e.onMainUp(t)},b.on(P.down,(function(t){e.onMainDown(t)}));var d=this.js=new t.Sprite(u.getBaseTexture());d.x=f,d.y=b.y+b.height+u.getBaseMargin(),d.interactive=!0,this.addChild(d),this.Cs=function(t){e.onBaseMove(t)},this.ks=function(t){e.onBaseUp(t)},d.on(P.down,(function(t){e.onBaseDown(t)}));var m=this.ys=new t.Sprite(u.getAlphaCheckerboardTexture());m.x=s.getLeft(),m.y=d.y+u.getBaseHeight()+u.getBaseMargin(),m.interactive=!1,this.addChild(m);var w=new t.Sprite(u.getAlphaTexture());w.tint=this.Os.color,w.interactive=!0,m.addChild(w),this.Is=function(t){e.onAlphaMove(t)},this.As=function(t){e.onAlphaUp(t)},w.on(P.down,(function(t){e.onAlphaDown(t)}));var p=this.xs=new t.Sprite(u.getMainPointerTexture());p.x=f,p.y=h,p.anchor.x=.5,p.anchor.y=.5,p.tint=u.getMainPointerColor(),p.alpha=u.getMainPointerAlpha(),p.interactive=!1,this.addChild(p);var D=this.Rs=new t.Sprite(u.getAlphaPointerTexture());D.x=c,D.y=.5*m.height,D.tint=u.getAlphaPointerColor(),D.alpha=u.getAlphaPointerAlpha(),D.anchor.set(.5,.5),D.interactive=!1,m.addChild(D);var O=this.Ls=new t.Sprite(u.getBasePointerTexture());O.x=0,O.y=.5*d.height,O.tint=u.getBasePointerColor(),O.alpha=u.getBasePointerAlpha(),O.anchor.set(.5,.5),O.interactive=!1,d.addChild(O),this.Bs=[];var S=this.Bs,M=u.getRecentColorCount(),E=u.getRecentColorWidth(),N=u.getRecentColorHeight(),T=.5*E,j=.5*N,C=u.getRecentColorMargin(),k=m.y+u.getAlphaHeight()+u.getRecentMargin(),y=u.getRecentCheckerboardTexture();null==r.RECENT_COLORS&&(r.RECENT_COLORS=new Ma(u.getRecents().slice(0),M));var I=this.Ds=r.RECENT_COLORS;I.on("change",(function(){e.onRecentChange()}));for(var A=function(n){var i=n.currentTarget;if(i instanceof t.Container){var r=i.children[0];r instanceof t.Sprite&&(e.setColorNew(r.tint),e.setAlphaNew(r.alpha))}},x=0;x<M;++x){var R=f+x*(E+C),L=new t.Sprite(y);L.x=R+T,L.y=k+j,L.anchor.x=.5,L.anchor.y=.5,L.buttonMode=!0,L.interactive=!0,P.onClick(L,A),this.addChild(L);var B=new t.Sprite(t.Texture.WHITE),F=I.get(x);null!=F?(B.tint=F.color,B.alpha=F.alpha):(B.tint=16777215,B.alpha=0),B.width=E,B.height=N,B.anchor.x=.5,B.anchor.y=.5,B.interactive=!1,L.addChild(B),S.push(B)}var _=u.getInputMargin(),U=k+N+_,z=.5*c,G=this.Ps=new Oa({parent:this,x:f,y:U,width:z,label:{width:u.getInputLabelWidth(),text:{value:"#"}},input:{weight:1,text:{value:"FFFFFF"},on:{input:function(t){var n=mn.fromCode(t);null!=n&&e.setColorNew(n)}}}}),H=this.Fs=new pa({parent:this,x:f,y:U+G.height+_,width:z,label:{width:u.getInputLabelWidth(),text:{value:"A"}},input:{weight:1,text:{value:1},min:0,max:1,on:{input:function(t){e.setAlphaNew(t)}}}}),V=u.getSampleWidth(),W=u.getSampleHeight(),Y=f+.75*c-V,X=U+.5*(G.height+_+H.height-W),K=this._s=new t.Sprite(u.getSampleCheckerboardTexture());K.x=Y,K.y=X,K.width=V,K.height=W,K.interactive=!1,this.addChild(K);var J=this.ue,Z=this.Us=new t.Sprite(t.Texture.WHITE);Z.x=Y,Z.y=X,Z.tint=J.color,Z.alpha=J.alpha,Z.width=V,Z.height=W,Z.interactive=!0,Z.buttonMode=!0,P.onClick(Z,(function(){e.setColorNew(J.color),e.setAlphaNew(J.alpha)})),this.addChild(Z);var q=this.zs=new t.Sprite(u.getSampleCheckerboardTexture());q.x=Y+V,q.y=X,q.width=V,q.height=W,q.interactive=!1,this.addChild(q);var Q=this.Gs=new t.Sprite(t.Texture.WHITE);Q.x=Y+V,Q.y=X,Q.tint=this.Os.color,Q.alpha=this.Os.alpha,Q.width=V,Q.height=W,Q.interactive=!1,this.addChild(Q),null!=i&&null!=i.width||(this.width=f+c+o),null!=i&&null!=i.height||(this.height=U+G.height+_+H.height+a)},r.prototype.onMainDown=function(t){this.onMainPick(t.data.global);var n=e.getLayer(this);if(n){var i=n.stage;i.on(P.move,this.Ns),i.on(P.up,this.Ts)}},r.prototype.onMainMove=function(t){this.onMainPick(t.data.global)},r.prototype.onMainUp=function(t){var n=e.getLayer(this);if(n){var i=n.stage;i.off(P.move,this.Ns),i.off(P.up,this.Ts)}},r.prototype.toMainHex=function(t,n,i,r){return Math.max(0,Math.min(255,255*n+i*(t>>r&255)))<<r},r.prototype.toMainColor=function(t,n,i,r,e){var u=.5*r,s=Math.max(0,Math.min(1,((n-u)*(1-i/e)+u)/r)),h=Math.max(0,Math.min(1,i/e)),o=Math.abs(.5*h-s),a=1-o-h;return this.toMainHex(t,a,o,16)|this.toMainHex(t,a,o,8)|this.toMainHex(t,a,o,0)},r.prototype.onMainPick=function(t){var n=this.Ss,i=this.Dt,r=i.getLeft(),e=i.getTop(),u=this.theme,s=u.getMainWidth(),h=u.getMainHeight();this.toLocal(t,void 0,n);var o=Math.max(0,Math.min(s,n.x-r)),a=Math.max(0,Math.min(h,n.y-e));this.xs.position.set(r+o,e+a),this.onColorNew(this.toMainColor(this.Du,o,a,s,h))},r.prototype.setColorCurrent=function(t){this.Us.tint=this.ue.color=t},r.prototype.setAlphaCurrent=function(t){this.Us.alpha=this.ue.alpha=t},r.prototype.setColorNew=function(t){var n=this.theme,i=n.getMainWidth(),r=n.getMainHeight(),e=this.Dt,u=Is.fromRgb(t);this.Es.tint=this.Du=Is.toRgb(u[0],255,255),this.Ls.x=Math.max(0,Math.min(1,u[0]/360))*i;var s=Math.max(0,Math.min(1,u[1]/255)),h=Math.max(0,Math.min(1,1-u[2]/255)),o=this.xs;o.tint=h<.45?n.getMainPointerColor():16777215,o.position.set(e.getLeft()+s*i,e.getTop()+h*r),this.onColorNew(t)},r.prototype.onColorNew=function(t){var n=e.getLayer(this);n&&n.disallowUpdate(),this.Gs.tint=this.Os.color=t,this.Ps.input.value=mn.toCode(t),this.emit("newcolorchange",t,this),n&&(n.allowUpdate(),n.update())},r.prototype.onBaseDown=function(t){this.onBasePick(t.data.global);var n=e.getLayer(this);if(n){var i=n.stage;i.on(P.move,this.Cs),i.on(P.up,this.ks)}},r.prototype.onBaseMove=function(t){this.onBasePick(t.data.global)},r.prototype.onBaseUp=function(t){var n=e.getLayer(this);if(n){var i=n.stage;i.off(P.move,this.Cs),i.off(P.up,this.ks)}},r.prototype.toBaseHex=function(t,n){return Math.max(0,Math.min(255,6*t*255))<<n},r.prototype.toBaseColor=function(t){return t<=.167?16711680+this.toBaseHex(t,8):t<=.333?(t=.333-t,65280+this.toBaseHex(t,16)):t<=.5?(t-=.333,65280+this.toBaseHex(t,0)):t<.667?(t=.667-t,255+this.toBaseHex(t,8)):t<.883?(t-=.667,255+this.toBaseHex(t,16)):(t=.883-t,16711680+this.toBaseHex(t,0))},r.prototype.onBasePick=function(t){var n=this.Ss,i=this.Dt,r=this.theme.getMainWidth();this.toLocal(t,void 0,n);var e=Math.max(0,Math.min(r,n.x-i.getLeft()));this.Ls.x=e,this.onColorBase(this.toBaseColor(e/r))},r.prototype.setColorBase=function(t){var n=this.theme.getMainWidth();this.Ls.x=Math.max(0,Math.min(1,t/360))*n,this.onColorBase(Is.toRgb(t,255,255))},r.prototype.onColorBase=function(t){this.Es.tint=this.Du=t;var n=this.xs,i=this.theme,r=i.getMainWidth(),e=i.getMainHeight(),u=this.Dt;this.onColorNew(this.toMainColor(this.Du,n.x-u.getLeft(),n.y-u.getTop(),r,e))},r.prototype.onAlphaDown=function(t){this.onAlphaPick(t.data.global);var n=e.getLayer(this);if(n){var i=n.stage;i.on(P.move,this.Is),i.on(P.up,this.As)}},r.prototype.onAlphaMove=function(t){this.onAlphaPick(t.data.global)},r.prototype.onAlphaUp=function(t){var n=e.getLayer(this);if(n){var i=n.stage;i.off(P.move,this.Is),i.off(P.up,this.As)}},r.prototype.onAlphaPick=function(t){var n=this.Ss,i=this.Dt,r=this.theme.getMainWidth();this.toLocal(t,void 0,n);var e=Math.max(0,Math.min(r,n.x-i.getLeft()));this.Rs.x=e,this.onAlphaNew(e/r)},r.prototype.setAlphaNew=function(t){var n=this.theme.getMainWidth();this.Rs.x=Math.max(0,Math.min(1,t))*n,this.onAlphaNew(t)},r.prototype.onAlphaNew=function(t){var n=e.getLayer(this);n&&n.disallowUpdate(),this.Gs.alpha=this.Os.alpha=t,this.Fs.input.value=Number(t.toFixed(2)),this.emit("newalphachange",t,this),n&&(n.allowUpdate(),n.update())},r.prototype.onRecentChange=function(){for(var t=this.Bs,n=this.Ds,i=0,r=t.length;i<r;++i){var e=t[i],u=n.get(i);null!=u?(e.tint=u.color,e.alpha=u.alpha):(e.tint=16777215,e.alpha=0)}},r.prototype.getType=function(){return"DPickerColor"},r.RECENT_COLORS=null,r}(z),Na=function(){function t(t,n,i,r,e){this.h=t,this.o=n,this.et=i,this.u=e,this.Hs=r}return t.prototype.set=function(t,n,i,r){this.h===t&&this.o===n&&this.et===i&&this.Hs===r||(this.h=t,this.o=n,this.et=i,this.Hs=r,this.u(this))},Object.defineProperty(t.prototype,"color",{get:function(){return this.h},set:function(t){this.h!==t&&(this.h=t,this.u(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this.o},set:function(t){this.o!==t&&(this.o=t,this.u(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.et},set:function(t){this.et!==t&&(this.et=t,this.u(this))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this.Hs},set:function(t){this.Hs!==t&&(this.Hs=t,this.u(this))},enumerable:!0,configurable:!0}),t.prototype.toObject=function(){return{color:this.h,alpha:this.o,position:this.et}},t}(),Ta=function(t,n){return t.position-n.position},ja=function(n){function r(){var t=n.call(this)||this;t.Vs=function(n){t.onChange(n)};var i=new Na(16777215,1,0,!1,t.Vs),r=new Na(8421504,1,1,!0,t.Vs);return t.Yi=[i,r],t.yn=-90,t.Hs=r,t.Ws=[0,0,0],t}return i(r,n),r.prototype.onChange=function(t){var n=t.selected&&this.Hs!==t;if(n){var i=this.Hs;null!=i&&(i.Hs=!1),this.Hs=t}this.Yi.sort(Ta),n&&this.emit("selectionchange",this.Hs,this),this.emit("change",this)},Object.defineProperty(r.prototype,"points",{get:function(){return this.Yi},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"direction",{get:function(){return this.yn},set:function(t){this.yn!==t&&(this.yn=t,this.emit("directionchange",t,this),this.emit("change",this))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"selected",{get:function(){return this.Hs},enumerable:!0,configurable:!0}),r.prototype.size=function(){return this.Yi.length},r.prototype.get=function(t){var n=this.Yi;return 0<=t&&t<n.length?n[t]:null},r.prototype.addAt=function(n){for(var i=this.Yi,r=null,e=0,u=i.length;e<u;++e){var s=i[e];if(n<=s.position){if(null==r)return this.add(s.color,s.alpha,n,!0);var h=s.position-r.position;if(.001<h){var o=t.utils.hex2rgb(s.color,this.Ws),a=o[0],f=o[1],c=o[2],l=t.utils.hex2rgb(r.color,this.Ws),v=l[0],b=l[1],g=l[2],d=(n-r.position)/h,m=a*d+v*(1-d),w=f*d+b*(1-d),p=c*d+g*(1-d),D=this.Ws;D[0]=m,D[1]=w,D[2]=p;var O=t.utils.rgb2hex(D),S=s.alpha*d+r.alpha*(1-d);return this.add(O,S,n,!0)}}r=s}return null!=r?this.add(r.color,r.alpha,n,!0):this.add(16777215,1,n,!0)},r.prototype.add=function(t,n,i,r){var e=new Na(t,n,i,r,this.Vs);return this.Yi.push(e),this.Vs(e),e},r.prototype.remove=function(t){var n=this.Yi;if(2<n.length)for(var i=0,r=n.length;i<r;++i)if(n[i]===t){n.splice(i,1);var e=this.Hs===t;return e&&(this.Hs=i+1<r?n[i]:n[i-1]),e&&this.emit("selectionchange",this.Hs,this),this.emit("change",this),!0}return!1},r.prototype.reset=function(){var t=this.yn;this.yn=-90;var n=this.Yi,i=this.Hs,r=i?n.indexOf(i):-1;if(n.length=0,n.push(new Na(16777215,0,0,!1,this.Vs)),n.push(new Na(16777215,0,1,!1,this.Vs)),0<=r&&r<n.length)(e=n[r]).Hs=!0,this.Hs=e;else if(0<n.length){var e;(e=n[n.length-1]).Hs=!0,this.Hs=e}else this.Hs=null;i!==this.Hs&&this.emit("selectionchange",this.Hs,this),t!==this.yn&&this.emit("directionchange",this.yn,this),this.emit("change",this)},r.prototype.toObject=function(){for(var t=[],n=this.Yi,i=0,r=n.length;i<r;++i)t.push(n[i].toObject());return{points:t,direction:this.yn}},r.prototype.fromObject=function(t){var n=this.yn;this.yn=t.direction;var i=this.Yi,r=this.Hs,e=r?i.indexOf(r):-1;i.length=0;for(var u=0,s=t.points.length;u<s;++u){var h=t.points[u],o=new Na(h.color,h.alpha,h.position,!1,this.Vs);i.push(o)}i.sort(Ta),0<=e&&e<i.length?((o=i[e]).Hs=!0,this.Hs=o):0<i.length?((o=i[i.length-1]).Hs=!0,this.Hs=o):this.Hs=null,r!==this.Hs&&this.emit("selectionchange",this.Hs,this),n!==this.yn&&this.emit("directionchange",this.yn,this),this.emit("change",this)},r}(t.utils.EventEmitter),Ca=function(n){function r(i,r,u,s,h,o,a,f){var c=n.call(this,a,f)||this;return c.interactive=!0,c.interactiveChildren=!1,c.cursor="pointer",c.Ys=i,c._=r,c._uvs=u,c.Xs=s,c.V=h,c.Ks=-1,c.Ws=[0,0,0],c.zi=new t.Point,c.Js=o,f.uniforms.uSampler.on("update",(function(){c.update(),e.update(c)})),c.update(),c}return i(r,n),r.prototype.getRectangle=function(t){var n=this.Js;return 0<=t&&t<n.length?n[t].rect:null},r.prototype.setRectangle=function(t,n,i,r,e){var u=this.Js;if(0<=t&&t<u.length){var s=u[t].rect;s.x=n,s.y=i,s.width=r,s.height=e}},r.prototype.getData=function(t){var n=this.Js;return 0<=t&&t<n.length?n[t].data:null},r.prototype.setData=function(t,n){var i=this.Js;0<=t&&t<i.length&&(i[t].data=n)},r.prototype.getLastHitIndex=function(){return this.Ks},r.prototype.setColors=function(t,n,i,r){n[t+0]=i[0],n[t+1]=i[1],n[t+2]=i[2],n[t+3]=r,n[t+4]=i[0],n[t+5]=i[1],n[t+6]=i[2],n[t+7]=r},r.prototype.setColorsHex=function(n,i,r,e){var u=t.utils.hex2rgb(r,this.Ws);this.setColors(n,i,u,e)},r.prototype.setColorsWhite=function(t,n){var i=this.Ws;i[0]=1,i[1]=1,i[2]=1,this.setColors(t,n,i,0)},r.prototype.setColorsPoint=function(t,n,i,r){var e=n.points[i];null!=e?this.setColorsHex(t,r,e.color,e.alpha):this.setColorsWhite(t,r)},r.prototype.setVertices=function(t,n,i,r){var e=r.y+r.height*i;n[t+0]=r.x,n[t+1]=e,n[t+2]=r.x+r.width,n[t+3]=e},r.prototype.setUvs=function(t,n,i,r){var e=r.x0+(r.x3-r.x0)*i,u=r.y0+(r.y3-r.y0)*i,s=r.x1+(r.x2-r.x1)*i,h=r.y1+(r.y2-r.y1)*i;n[t+0]=e,n[t+1]=u,n[t+2]=s,n[t+3]=h},r.prototype.newIndices=function(t,n,i,r){for(var e=0;e<i;++e)r[t+0]=n+0,r[t+1]=n+1,r[t+2]=n+2,r[t+3]=n+2,r[t+4]=n+1,r[t+5]=n+3,t+=6,n+=2;return r},r.prototype._calculateBounds=function(){var t=this.Js[0].rect,n=this._bounds,i=this.zi;i.set(t.x,t.y),n.addPoint(i),i.set(t.x+t.width,t.y+t.height),n.addPoint(i)},r.prototype.update=function(){var t=this._,n=this._uvs,i=this.Xs,r=this.V,e=this.shader.uniforms.uSampler;null==e._uvs&&e.updateUvs();for(var u=e._uvs,s=0,h=0,o=0,a=0,f=this.Js,c=0,l=f.length;c<l;++c){var v=f[c].data,b=f[c].rect;if(null==v)this.setVertices(s,t,0,b),this.setUvs(s,n,0,u),this.setColorsWhite(o,i),this.setVertices(s+4,t,1,b),this.setUvs(s,n,1,u),this.setColorsWhite(o+8,i),this.newIndices(a,h,1,r),s+=8,o+=16,h+=4,a+=6;else{this.setVertices(s,t,0,b),this.setUvs(s,n,0,u),this.setColorsPoint(o,v,0,i),s+=4,o+=8;for(var g=v.points.length,d=0,m=Math.min(g,this.Ys);d<m;++d){var w=v.points[d];this.setVertices(s,t,w.position,b),this.setUvs(s,n,w.position,u),this.setColorsHex(o,i,w.color,w.alpha),s+=4,o+=8}this.setVertices(s,t,1,b),this.setUvs(s,n,1,u),this.setColorsPoint(o,v,g-1,i),s+=4,o+=8,this.newIndices(a,h,g+1,r),a+=6*(g+1),h+=2*(g+2)}}this.size=a;var p=this.geometry;p.getBuffer("aPosition").update(),p.getBuffer("aUv").update(),p.getBuffer("aColor").update(),p.getIndex().update()},r.prototype.containsPoint=function(t){for(var n=this.toLocal(t,void 0,this.zi),i=this.Js,r=0,e=i.length;r<e;++r)if(i[r].rect.contains(n.x,n.y))return this.Ks=r,!0;return!1},r.from=function(n,i,e){void 0===e&&(e=t.Texture.WHITE);for(var u=new Float32Array(n*(i+2)*2*2),s=new Float32Array(n*(i+2)*2*2),h=new Float32Array(n*(i+2)*2*4),o=new Uint16Array(n*(i+1)*6),a=[],f=0;f<n;++f)a.push({data:null,rect:new t.Rectangle});return new r(i,u,s,h,o,a,(new t.Geometry).addIndex(new t.Buffer(o,!1,!0)).addAttribute("aPosition",new t.Buffer(u,!1,!1),2).addAttribute("aUv",new t.Buffer(s,!1,!1),2).addAttribute("aColor",new t.Buffer(h,!1,!1),4),t.Shader.from("\nattribute vec2 aPosition;\nattribute vec2 aUv;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main(void) {\n\tvec3 position = vec3(aPosition.x, aPosition.y, 1.0);\n\tgl_Position = vec4((projectionMatrix * translationMatrix * position).xy, 0.0, 1.0);\n\tvUv = aUv;\n\tvColor = aColor;\n}\n","\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void) {\n\tvec4 texture = texture2D(uSampler, vUv);\n\tfloat cy = step( 1.0, mod( gl_FragCoord.y / 10.0, 2.0 ) );\n\tfloat cx = step( 1.0, mod( gl_FragCoord.x / 10.0 + cy, 2.0 ) );\n\tfloat c = mix( 0.75, 0.65, cx );\n\tgl_FragColor = texture * vec4( mix( vec3( c ), vColor.xyz, vColor.a ), 1.0 );\n}",{uSampler:e}))},r}(t.Mesh),ka=function(t,n){if(t.direction!==n.direction)return!1;var i=t.points,r=n.points;if(i.length!==r.length)return!1;for(var e=0,u=i.length;e<u;++e){var s=i[e],h=r[e];if(s.color!==h.color||s.alpha!==h.alpha||s.position!==h.position)return!1}return!0},ya=function(t){function n(n,i){var r=t.call(this)||this;return r.ms=n,r.ci=i,r}return i(n,t),n.prototype.getCapacity=function(){return this.ci},n.prototype.get=function(t){var n=this.ms;return 0<=t&&t<n.length?n[n.length-1-t]:null},n.prototype.set=function(t,n){var i=this.ms;if(0<=t&&t<i.length){var r=i[i.length-1-t];return i[i.length-1-t]=n,this.emit("change",this),r}return null},n.prototype.contains=function(t){for(var n=this.ms,i=0,r=n.length;i<r;++i)if(ka(n[i],t))return!0;return!1},n.prototype.add=function(t){var n=this.ms;return n.push(t),this.ci<n.length&&n.shift(),this.emit("change",this),this},n.prototype.pop=function(){var t=this.ms.shift();return null!=t?(this.emit("change",this),t):null},n.prototype.size=function(){return this.ms.length},n}(t.utils.EventEmitter),Ia=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(i){var e=this;n.prototype.init.call(this,i),this.setState(v.UNFOCUSABLE,!0);var u=this.theme,s=this.Dt,h=s.getTop(),o=s.getRight(),a=s.getBottom(),f=s.getLeft();this.Be=new t.Point;var c=u.getGradientPointsWidth(),l=u.getGradientPointsMargin(),b=this.Zs=new Ea({x:f+c+l,y:h});b.on("newcolorchange",(function(t){e.onAnchorColorChange(t)})),b.on("newalphachange",(function(t){e.onAnchorAlphaChange(t)})),this.addChild(b);var g=this.qs=Ca.from(17,10);g.setRectangle(0,f,h,c,b.height),this.addChild(g),g.on(P.down,(function(t){0===g.getLastHitIndex()&&e.onViewDown(t)})),this.Qs=function(t){e.onAnchorDown(t)},this.$s=function(t){e.onAnchorMove(t)},this.th=function(t){e.onAnchorUp(t)},this.nh=[];var d=b.theme.getInputLabelWidth(),m=.5*b.theme.getMainWidth(),w=u.getGradientDirectionMargin(),p=u.getGradientDirectionTexture(),D=b.x+b.width+w,O=new ga({parent:this,x:D+d+5,y:h,width:m-d-5,step:1,image:{source:p,align:{with:U.BORDER},margin:{horizontal:-p.width-5}},on:{change:function(t){e.Ne.yn=t}}}),S=u.getGradientRecentColumn(),M=u.getGradientRecentWidth(),E=u.getGradientRecentMargin(),N=M+E,T=D,j=O.y+O.height+w;null==r.RECENT_COLOR_GRADIENT&&(r.RECENT_COLOR_GRADIENT=new ya(u.getGradientRecents(),u.getGradientRecentCount())),this.Ds=r.RECENT_COLOR_GRADIENT;for(var C=this.Ds,k=0,y=C.getCapacity();k<y;++k){var I=T+k%S*N,A=j+(k/S|0)*N;g.setRectangle(1+k,I,A,M,M)}C.on("change",(function(){e.onRecentUpdate()})),P.onClick(g,(function(t){var n=g.getLastHitIndex();1<=n&&e.onRecentClick(g.getData(n))}));var x=this.Ne=new ja;x.on("change",(function(){e.updateAnchors(),g.update()})),x.on("selectionchange",(function(t){e.onAnchorSelect(t)})),x.on("directionchange",(function(t){O.value=t})),g.setData(0,x),g.update(),O.value=x.direction,this.updateAnchors();var R=x.selected;null!=R&&this.onAnchorSelect(R),null!=i&&null!=i.width||(this.width=f+c+l+b.width+w+(S-1)*E+S*M+o),null!=i&&null!=i.height||(this.height=h+b.height+a)},Object.defineProperty(r.prototype,"data",{get:function(){return this.Ne},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"recent",{get:function(){return this.Ds},enumerable:!0,configurable:!0}),r.prototype.onRecentClick=function(t){var n=this.Ne;null!=t?n.fromObject(t):n.reset()},r.prototype.onRecentUpdate=function(){for(var t=this.Ds,n=this.qs,i=0,r=t.size();i<r;++i)n.setData(1+i,t.get(i));n.update(),e.update(this)},r.prototype.toAnchorPosition=function(t){var n=this.toLocal(t.data.global,void 0,this.Be);return Math.max(0,Math.min(1,(n.y-this.padding.getTop())/this.Zs.height))},r.prototype.onViewDown=function(t){this.Ne.addAt(this.toAnchorPosition(t)),this.onAnchorDragStart()},r.prototype.onAnchorDown=function(n){var i=n.target;if(i instanceof t.Sprite){var r=this.Ne,e=this.nh.indexOf(i);0<=e&&e<r.points.length&&(r.points[e].selected=!0,this.onAnchorDragStart())}},r.prototype.onAnchorSelect=function(t){var n=this.Zs;n.current.color=t.color,n.current.alpha=t.alpha,n.new.color=t.color,n.new.alpha=t.alpha},r.prototype.onAnchorColorChange=function(t){var n=this.Ne;if(null!=n){var i=n.selected;null!=i&&(i.color=t)}},r.prototype.onAnchorAlphaChange=function(t){var n=this.Ne;if(null!=n){var i=n.selected;null!=i&&(i.alpha=t)}},r.prototype.onAnchorDragStart=function(){var t=e.getLayer(this);if(t){var n=t.stage;n.on(P.move,this.$s),n.on(P.up,this.th)}},r.prototype.onAnchorMove=function(t){var n=this.Ne;if(null!=n){var i=n.selected;null!=i&&(i.position=this.toAnchorPosition(t))}},r.prototype.onAnchorUp=function(t){var n=e.getLayer(this);if(n){var i=n.stage;i.off(P.move,this.$s),i.off(P.up,this.th)}},r.prototype.updateAnchors=function(){for(var n=this.theme,i=n.getGradientAnchorTexture(),r=n.getGradientAnchorOutlinedTexture(),u=n.getGradientPointsWidth(),s=this.Ne,h=s.points.length,o=this.nh,a=o.length,f=a;f<h;++f){var c=new t.Sprite(i);c.anchor.set(.5,.5),c.cursor="pointer",c.interactive=!0,c.on(P.down,this.Qs),o.push(c),this.addChild(c)}for(f=a-1;h<=f;--f){var l=o[f];l.off(P.down,this.Qs),l.destroy()}o.length=h;var v=this.padding.getTop(),b=this.padding.getLeft()+u,g=this.Zs.height;for(f=0;f<h;++f){var d=s.points[f],m=o[f];m.tint=d.color,m.position.set(b,v+g*d.position),m.texture=d.selected?r:i}e.update(this)},r.prototype.onKeyDown=function(t){if(B.isDeleteKey(t)){var i=this.Ne;if(null!=i){var r=i.selected;if(null!=r)return i.remove(r),n.prototype.onKeyDown.call(this,t),!0}}return n.prototype.onKeyDown.call(this,t)},r.prototype.getType=function(){return"DPickerColorGradient"},r.RECENT_COLOR_GRADIENT=null,r}(z),Aa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new Ia(i&&i.picker);this.Zs=r,n.addChild(r),this.on("ok",(function(){var t=r.data,n=r.recent;n.contains(t)||n.add(t.toObject())}))},Object.defineProperty(n.prototype,"data",{get:function(){return this.Zs.data},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recent",{get:function(){return this.Zs.recent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Zs},enumerable:!0,configurable:!0}),n.prototype.onKeyDown=function(n){return this.Zs.onKeyDown(n),t.prototype.onKeyDown.call(this,n)},n.prototype.getType=function(){return"DDialogColorGradient"},n}(fa),xa=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(i){var r=this;n.prototype.init.call(this,i);var u=this.rn;if(this.ih=i&&i.dialog,null==i||null==i.image||void 0===i.image.source){var s=this.theme.getViewBaseTexture();if(s instanceof t.Texture){var h=this.qs=Ca.from(1,10,s);h.setRectangle(0,0,0,s.width,s.height),h.setData(0,u),h.update(),this.image=h}}this.on("active",(function(){var t=r.dialog;t.data.fromObject(u),t.open().then((function(){u.fromObject(t.data);var n=r.qs;null!=n&&n.update(),r.onTextChange(),r.createOrUpdateText(),e.update(r),r.emit("change",r)}))}))},Object.defineProperty(r.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(null!=this.ih?t=new Aa(this.ih):(null==r.DIALOG&&(r.DIALOG=new Aa),t=r.DIALOG),this.rh=t),t},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"value",{get:function(){return this.rn},enumerable:!0,configurable:!0}),r.prototype.getType=function(){return"DButtonColorGradient"},r}(ia),Ra=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new Ea(i&&i.picker);this.Zs=r,n.addChild(r),this.on("ok",(function(){var t=r.recent;t.contains(r.new)||t.add(r.new)}))},Object.defineProperty(n.prototype,"current",{get:function(){return this.Zs.current},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Zs.new},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"recent",{get:function(){return this.Zs.recent},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Zs},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDialogColor"},n}(fa),La=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=this.rn;this.ih=n&&n.dialog,this.Sn=new Sa(r,(function(t){r.color=t,i.onColorChange()}),(function(t){r.alpha=t,i.updateTextForcibly()})),this.on("active",(function(){var t=i.dialog;t.current.color=r.color,t.current.alpha=r.alpha,t.new.color=r.color,t.new.alpha=r.alpha,t.open().then((function(){var n=t.new,e=t.current;i.emit("select",n,e,i),r.color=n.color,r.alpha=n.alpha,i.onColorChange(),i.emit("change",i)}))}))},n.prototype.getImageTintColor=function(t,n){return this.rn.color},n.prototype.onColorChange=function(){var t=this.vn;this.isTintAware(t)&&(t.tint=this.rn.color,e.update(this)),this.updateTextForcibly()},n.prototype.updateTextForcibly=function(){this.onTextChange(),this.createOrUpdateText()},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(null!=this.ih?t=new Ra(this.ih):(null==n.DIALOG&&(n.DIALOG=new Ra),t=n.DIALOG),this.rh=t),t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.Sn},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DButtonColor"},n}(ia),Ba=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonDanger"},n}(ia),Pa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DPickerDatetimeButtonBack"},n}(ra),Fa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onToggleStart=function(){this.isActive()||this.setActive(!0)},n.prototype.onToggleEnd=function(){this.emit(this.isActive()?"active":"inactive",this)},n.prototype.getType=function(){return"DPickerDatetimeButtonDate"},n}(ra),_a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DPickerDatetimeButtonNext"},n}(ra),Ua=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DPickerDatetimeLabel"},n}(da),za=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DPickerDatetimeLabelDate"},n}(da),Ga=function(t){function n(n){var i=t.call(this,n)||this;return i.setState(v.UNFOCUSABLE,!0),i.renderable=!1,i}return i(n,t),n.prototype.getType=function(){return"DPickerDatetimeSpace"},n}(z),Ha=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DInputInteger"},n}(ba);!function(t){t[t.NONE=0]="NONE",t[t.DATE=1]="DATE",t[t.HOURS=2]="HOURS",t[t.MINUTES=4]="MINUTES",t[t.SECONDS=8]="SECONDS",t[t.ALL=15]="ALL"}(ca||(ca={}));var Va,Wa=function(){function t(t,n){this.eh=t&&void 0!==t.date?t.date:null,this.uh=!(!t||void 0===t.inclusive)&&t.inclusive,this.Yt=n}return Object.defineProperty(t.prototype,"date",{get:function(){return this.eh},set:function(t){this.eh!==t&&(this.eh=t,this.Yt())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"inclusive",{get:function(){return this.uh},set:function(t){this.uh!==t&&(this.uh=t,this.Yt())},enumerable:!0,configurable:!0}),t}(),Ya=function(){function t(t){this.Bn=t}return t.prototype.min=function(t){var n=this.Bn,i=n.lower,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&ca.DATE){if(r.getFullYear()<t.getFullYear())return e.hour.min;if(r.getMonth()<t.getMonth())return e.hour.min;if(r.getDate()<t.getDate())return e.hour.min}var s=r.getHours();return i.inclusive?s:u&ca.SECONDS&&r.getSeconds()<e.second.max?s:u&ca.MINUTES&&r.getMinutes()<e.minute.max?s:s+1}return e.hour.min},t.prototype.max=function(t){var n=this.Bn,i=n.upper,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&ca.DATE){if(t.getFullYear()<r.getFullYear())return e.hour.max;if(t.getMonth()<r.getMonth())return e.hour.max;if(t.getDate()<r.getDate())return e.hour.max}var s=r.getHours();return i.inclusive?s:u&ca.SECONDS&&e.second.min<r.getSeconds()?s:u&ca.MINUTES&&e.minute.min<r.getMinutes()?s:s-1}return e.hour.max},t}(),Xa=function(){function t(t){this.Bn=t}return t.prototype.min=function(t){var n=this.Bn,i=n.lower,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&ca.DATE){if(r.getFullYear()<t.getFullYear())return e.minute.min;if(r.getMonth()<t.getMonth())return e.minute.min;if(r.getDate()<t.getDate())return e.minute.min}if(u&ca.HOURS&&r.getHours()<t.getHours())return e.minute.min;var s=r.getMinutes();return i.inclusive?s:u&ca.SECONDS&&r.getSeconds()<e.second.max?s:s+1}return e.minute.min},t.prototype.max=function(t){var n=this.Bn,i=n.upper,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&ca.DATE){if(t.getFullYear()<r.getFullYear())return e.minute.max;if(t.getMonth()<r.getMonth())return e.minute.max;if(t.getDate()<r.getDate())return e.minute.max}if(u&ca.HOURS&&t.getHours()<r.getHours())return e.minute.max;var s=r.getMinutes();return i.inclusive?s:u&ca.SECONDS&&e.second.min<r.getSeconds()?s:s-1}return e.minute.max},t}(),Ka=function(){function t(t){this.Bn=t}return t.prototype.min=function(t){var n=this.Bn,i=n.lower,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&ca.DATE){if(r.getFullYear()<t.getFullYear())return e.second.min;if(r.getMonth()<t.getMonth())return e.second.min;if(r.getDate()<t.getDate())return e.second.min}return u&ca.HOURS&&r.getHours()<t.getHours()?e.second.min:u&ca.MINUTES&&r.getMinutes()<t.getMinutes()?e.second.min:r.getSeconds()+(i.inclusive?0:1)}return e.second.min},t.prototype.max=function(t){var n=this.Bn,i=n.upper,r=i.date,e=n.constant;if(null!=r){var u=n.mask;if(u&ca.DATE){if(t.getFullYear()<r.getFullYear())return e.second.max;if(t.getMonth()<r.getMonth())return e.second.max;if(t.getDate()<r.getDate())return e.second.max}return u&ca.HOURS&&t.getHours()<r.getHours()?e.second.max:u&ca.MINUTES&&t.getMinutes()<r.getMinutes()?e.second.max:r.getSeconds()-(i.inclusive?0:1)}return e.second.max},t}(),Ja=function(){function t(t,n){this.constant=this.newConstant(),this.lower=new Wa(t&&t.lower,n),this.upper=new Wa(t&&t.upper,n),this.mask=ca.ALL,this.hours=new Ya(this),this.minutes=new Xa(this),this.seconds=new Ka(this)}return t.prototype.newConstant=function(){return{second:{min:0,max:59},minute:{min:0,max:59},hour:{min:0,max:23}}},t.prototype.adjust=function(t){var n=this.test(t);if(n<0){var i=this.lower,r=i.date;if(r)return t.setTime(r.getTime()),i.inclusive||((e=this.mask)&ca.SECONDS?t.setSeconds(r.getSeconds()+1):e&ca.MINUTES?t.setMinutes(r.getMinutes()+1):e&ca.HOURS?t.setHours(r.getHours()+1):e&ca.DATE&&t.setDate(r.getDate()+1)),!0}else if(0<n){var e,u=this.upper,s=u.date;if(s)return t.setTime(s.getTime()),u.inclusive||((e=this.mask)&ca.SECONDS?t.setSeconds(s.getSeconds()-1):e&ca.MINUTES?t.setMinutes(s.getMinutes()-1):e&ca.HOURS?t.setHours(s.getHours()-1):e&ca.DATE&&t.setDate(s.getDate()-1)),!0}return!1},t.prototype.compare=function(t,n){var i=this.mask;if(i&ca.DATE){var r,e,u,s,h=t.getFullYear(),o=n.getFullYear();if(h!==o)return h<o?-1:1;if((r=t.getMonth())!==(e=n.getMonth()))return r<e?-1:1;if((u=t.getDate())!==(s=n.getDate()))return u<s?-1:1}if(i&ca.HOURS){var a=t.getHours(),f=n.getHours();if(a!==f)return a<f?-1:1}return i&ca.MINUTES&&(r=t.getMinutes())!==(e=n.getMinutes())?r<e?-1:1:i&ca.SECONDS&&(u=t.getSeconds())!==(s=n.getSeconds())?u<s?-1:1:0},t.prototype.test=function(t){var n=this.lower,i=n.date;if(null!=i){var r=this.compare(i,t);return n.inclusive?r<=0?0:-1:r<0?0:-1}var e=this.upper,u=e.date;return null!=u?(r=this.compare(t,u),e.inclusive?r<=0?0:1:r<0?0:1):0},t.prototype.contains=function(t){return 0===this.test(t)},t}(),Za=function(t,n,i){return t?{date:void 0!==t.date?t.date:n,inclusive:void 0!==t.inclusive?t.inclusive:i}:{date:n,inclusive:i}},qa=function(t){function n(n){var i=t.call(this,n)||this;return i.onNewChanged(),i}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.setState(v.UNFOCUSABLE,!0);var r=this.theme;this.sh=new Date;var e=this.sh.getTime();this.hh=new Date(e),this.oh=new Ja(function(t,n){return n?{lower:Za(n.lower,t.getLowerBound(),t.isLowerBoundInclusive()),upper:Za(n.upper,t.getUpperBound(),t.isUpperBoundInclusive())}:{lower:{date:t.getLowerBound(),inclusive:t.isLowerBoundInclusive()},upper:{date:t.getUpperBound(),inclusive:t.isUpperBoundInclusive()}}}(r,n&&n.bounds),(function(){i.onNewChanged()}));var u=n&&null!=n.margin?n.margin:r.getMargin();new Nt({parent:this,x:"padding",y:"padding",width:"auto",height:"auto",margin:u,children:this.newChildren(r,n,u)})},Object.defineProperty(n.prototype,"current",{get:function(){return this.sh},set:function(t){this.sh.getTime()!==t.getTime()&&(this.sh=t)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.hh},set:function(t){this.hh.getTime()!==t.getTime()&&(this.hh=t,this.onNewChanged())},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"bounds",{get:function(){return this.oh},enumerable:!0,configurable:!0}),n.prototype.hasHours=function(){return null!=this.ah},n.prototype.hasMinutes=function(){return null!=this.fh},n.prototype.hasSeconds=function(){return null!=this.lh},n.prototype.reset=function(){var t=this.sh.getTime();this.hh.setTime(t),this.onReset()},n.prototype.onReset=function(){this.onNewChanged()},n.prototype.onNewChanged=function(){var t=this.hh,n=this.oh;n.adjust(this.hh);var i=this.ah;if(i){var r=n.hours;i.value=t.getHours(),i.min=r.min(t),i.max=r.max(t)}var e=this.fh;if(e){var u=n.minutes;e.value=t.getMinutes(),e.min=u.min(t),e.max=u.max(t)}var s=this.lh;if(s){var h=n.seconds;s.value=t.getSeconds(),s.min=h.min(t),s.max=h.max(t)}},n.prototype.newChildren=function(t,n,i){var r=n&&null!=n.mask?n.mask:t.getMask();return this.oh.mask=r,this.ah=r&ca.HOURS?this.newInputHours(t,n):null,this.fh=r&ca.MINUTES?this.newInputMinutes(t,n):null,this.lh=r&ca.SECONDS?this.newInputSeconds(t,n):null,[this.newTimeLayout(this.ah,this.fh,this.lh,i)]},n.prototype.newTimeLayout=function(t,n,i,r){var e=this.newTimeLayoutChildren(t,n,i);return 0<e.length?new aa({width:this.getTimeLayoutWidth(),height:this.getTimeLayoutHeight(),margin:r,children:e}):null},n.prototype.getTimeLayoutWidth=function(){return"auto"},n.prototype.getTimeLayoutHeight=function(){return"auto"},n.prototype.newTimeLayoutChildren=function(t,n,i){var r=[];return null!=t&&r.push(t),null!=n&&(0<r.length&&r.push(this.newMinuteSeparator()),r.push(n)),null!=i&&(0<r.length&&r.push(this.newSecondSeparator()),r.push(i)),r},n.prototype.newMinuteSeparator=function(){return new da({width:"auto",text:{value:this.getMinuteSeparator()}})},n.prototype.getMinuteSeparator=function(){return":"},n.prototype.newSecondSeparator=function(){return new da({width:"auto",text:{value:this.getSecondSeparator()}})},n.prototype.getSecondSeparator=function(){return":"},n.prototype.adjustInputOptions=function(t,n,i){return null==n.step&&(n.step=1),null==n.min&&(n.min=0),null==n.max&&(n.max=i),n},n.prototype.newInputHours=function(t,n){var i=this,r=n&&n.hours||t.getHoursOptions(),e=this.oh.constant.hour.max,u=new Ha(this.adjustInputOptions(t,r,e));return u.on("change",(function(t){i.onHoursChanged(t)})),u},n.prototype.onHoursChanged=function(t){this.hh.setHours(t),this.onNewChanged()},n.prototype.newInputMinutes=function(t,n){var i=this,r=n&&n.minutes||t.getMinutesOptions(),e=this.oh.constant.minute.max,u=new Ha(this.adjustInputOptions(t,r,e));return u.on("change",(function(t){i.onMinutesChanged(t)})),u},n.prototype.onMinutesChanged=function(t){this.hh.setMinutes(t),this.onNewChanged()},n.prototype.newInputSeconds=function(t,n){var i=this,r=n&&n.seconds||t.getSecondsOptions(),e=this.oh.constant.second.max,u=new Ha(this.adjustInputOptions(t,r,e));return u.on("change",(function(t){i.onSecondsChanged(t)})),u},n.prototype.onSecondsChanged=function(t){this.hh.setSeconds(t)},n.prototype.getType=function(){return"DPickerTime"},n}(z),Qa=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.vh=new Date(this.sh.getTime())},n.prototype.newChildren=function(n,i,r){this.bh=this.newDateButtons(n,i),this.gh=i&&i.date&&i.date.decorator||n.getDateDecorator(),this.ls=this.newLabel(n,i);var e=t.prototype.newChildren.call(this,n,i,r);return e.unshift(new aa({width:"100%",height:"auto",children:[this.newBackButton(n,i),this.ls,this.newNextButton(n,i)]}),new aa({width:"auto",height:"auto",margin:r,children:this.newDateLabels(n,i)}),new Nt({width:"auto",height:"auto",margin:r,column:7,children:this.bh})),e},Object.defineProperty(n.prototype,"page",{get:function(){return this.vh},set:function(t){this.vh.getTime()!==t.getTime()&&(this.vh=t,this.onPageChanged())},enumerable:!0,configurable:!0}),n.prototype.onReset=function(){this.vh.setTime(this.sh.getTime()),t.prototype.onReset.call(this)},n.prototype.next=function(){var t=this.vh;t.setFullYear(t.getFullYear(),t.getMonth()+1,1),t.setHours(0,0,0,0),this.onPageChanged()},n.prototype.back=function(){var t=this.vh;t.setFullYear(t.getFullYear(),t.getMonth()-1,1),t.setHours(0,0,0,0),this.onPageChanged()},n.prototype.onNewChanged=function(){this.oh.adjust(this.vh),t.prototype.onNewChanged.call(this),this.onPageChanged()},n.prototype.onPageChanged=function(){var t=this.bh,n=this.oh,i=this.vh,r=this.hh,e=new Date(i.getTime());e.setDate(1),e.setHours(0,0,0,0);for(var u=this.theme,s=(e.getDay()-u.getDayStart()+7)%7,h=0;h<s;++h)t[h].show();for(h=s;h<7;++h)t[h].hide();var o=this.gh;e.setFullYear(e.getFullYear(),e.getMonth()+1,0);var a=e.getDate(),f=r.getFullYear()===e.getFullYear()&&r.getMonth()===e.getMonth()?r.getDate():0;for(h=0;h<a;++h)e.setDate(h+1),(c=t[h+7]).setActive(f===h+1),c.setDisabled(!n.contains(e)),c.show(),o(e,c);for(h=a;h<31;++h){var c;(c=t[h+7]).setActive(!1),c.hide()}e.setTime(i.getTime()),this.ls.text=e},n.prototype.adjustInputOptions=function(n,i,r){return null==i.weight&&(i.weight=1),t.prototype.adjustInputOptions.call(this,n,i,r)},n.prototype.getTimeLayoutWidth=function(){return"100%"},n.prototype.toLabelOptions=function(t,n){var i=n&&n.label||{};void 0===i.weight&&(i.weight=1),void 0===i.padding&&(i.padding=0);var r=i.text=i.text||{},e=r.align=r.align||{};return void 0===e.horizontal&&(e.horizontal="CENTER"),void 0===r.formatter&&(r.formatter=t.getLabelFormatter()),i},n.prototype.newLabel=function(t,n){return new Ua(this.toLabelOptions(t,n))},n.prototype.newBackButton=function(t,n){var i=this,r=n&&void 0!==n.back?n.back:t.getBackButtonOptions();if(null!=r){var e=new Pa(r);return e.on("active",(function(){i.back()})),e}return null},n.prototype.newNextButton=function(t,n){var i=this,r=n&&void 0!==n.next?n.next:t.getNextButtonOptions();if(null!=r){var e=new _a(r);return e.on("active",(function(){i.next()})),e}return null},n.prototype.newDateLabels=function(t,n){for(var i=t.getDayLabels(),r=t.getDayStart(),e=[],u=0;u<7;++u){var s=i[(r+u)%7];e.push(this.newDateLabel(t,n,s))}return e},n.prototype.newDateLabel=function(t,n,i){return new za({text:{value:i}})},n.prototype.newDateButtons=function(t,n){for(var i=[],r=0;r<7;++r)i.push(this.newSpace(t,n));for(r=1;r<=31;++r)i.push(this.newDateButton(t,n,r));return i},n.prototype.newSpace=function(t,n){return new Ga},n.prototype.newDateButton=function(t,n,i){var r=this;return new Fa({text:{value:String(i)},on:{active:function(){r.onDateButtonClicked(i)}}})},n.prototype.onDateButtonClicked=function(t){var n=this.hh;if(n.getDate()!==t){var i=this.vh;n.setFullYear(i.getFullYear()),n.setMonth(i.getMonth()),n.setDate(t),this.onNewChanged()}},n.prototype.getType=function(){return"DPickerDatetime"},n}(qa),$a=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DPickerDate"},n}(Qa),tf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new $a(i&&i.picker);this.Zs=r,n.addChild(r)},Object.defineProperty(n.prototype,"current",{get:function(){return this.Zs.current},set:function(t){this.Zs.current=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Zs.new},set:function(t){this.Zs.new=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"page",{get:function(){return this.Zs.new},set:function(t){this.Zs.page=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Zs},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDialogDate"},n}(fa),nf=function(){function t(){}return t.getInstance=function(){return null==t.INSTANCE&&(t.INSTANCE=new tf),t.INSTANCE},t}(),rf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.ih=n&&n.dialog,this.on("active",(function(){var t=i.rn.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.page=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.emit("select",t,r,i),i.text=new Date(t.getTime()),i.emit("change",i)}))}))},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(t=null!=this.ih?new tf(this.ih):nf.getInstance(),this.rh=t),t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.rn},set:function(t){this.rn.getTime()!==t.getTime()&&(this.text=t)},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DButtonDate"},n}(ia),ef=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new Qa(i&&i.picker);this.Zs=r,n.addChild(r)},Object.defineProperty(n.prototype,"current",{get:function(){return this.Zs.current},set:function(t){this.Zs.current=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Zs.new},set:function(t){this.Zs.new=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"page",{get:function(){return this.Zs.new},set:function(t){this.Zs.page=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Zs},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDialogDatetime"},n}(fa),uf=function(){function t(){}return t.getInstance=function(){return null==t.INSTANCE&&(t.INSTANCE=new ef),t.INSTANCE},t}(),sf=function(){function t(){}return t.format=function(t){return dn(String(t.getFullYear()),4,"0")+"/"+dn(String(t.getMonth()+1),2,"0")+"/"+dn(String(t.getDate()),2,"0")},t}(),hf=function(){function t(){}return t.format=function(t,n){var i="";return n&ca.HOURS&&(i+=dn(String(t.getHours()),2,"0")),n&ca.MINUTES&&(0<i.length&&(i+=":"),i+=dn(String(t.getMinutes()),2,"0")),n&ca.SECONDS&&(0<i.length&&(i+=":"),i+=dn(String(t.getSeconds()),2,"0")),i},t.toMask=function(t){return t&&null!=t.mask?t.mask:L.getInstance().get("DPickerTime").getMask()},t}(),of=function(){function t(){}return t.format=function(t,n){var i=hf.format(t,n);return 0<i.length?sf.format(t)+" "+i:""+sf.format(t)},t.toMask=function(t){return t&&null!=t.mask?t.mask:L.getInstance().get("DPickerDatetime").getMask()},t}(),af=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;this.ih=n&&n.dialog,this.dh=of.toMask(n&&n.dialog&&n.dialog.picker),t.prototype.init.call(this,n),this.on("active",(function(){var t=i.rn.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.page=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.emit("select",t,r,i),i.text=new Date(t.getTime()),i.emit("change",i)}))}))},n.prototype.getDatetimeMask=function(){return this.dh},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(t=null!=this.ih?new ef(this.ih):uf.getInstance(),this.rh=t),t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.rn},set:function(t){this.rn.getTime()!==t.getTime()&&(this.text=t)},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DButtonDatetime"},n}(ia),ff=Ms,cf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Tn=null!=n&&null!=n.checker?n.checker:void 0;var r=null!=n&&null!=n.as?o(n.as)?ff[n.as]:n.as:ff.TEXT,e=new ys(r,this);this.mh=e,this.on("active",(function(){var t=i.onOpening();!0===t?e.open():!1===t||t.then((function(){e.open()}))}))},n.prototype.onOpening=function(){var t=this.Tn;return null==t||t()},n.prototype.open=function(){this.mh.open()},n.prototype.getType=function(){return"DButtonFile"},n}(ia),lf=function(t){function n(n){var i=t.call(this)||this;if(i.wh=[],i.ph=null,i.Dh=v.NONE,i.Oh=v.NONE,i.Sh=function(t){i.onActive(t)},null!=n){var r=n.on;if(null!=r)for(var e in r)i.on(e,r[e])}return i.emit("init",i),i}return i(n,t),n.prototype.add=function(t){this.wh.indexOf(t)<0&&(this.wh.push(t),t.setState(this.Dh,!0),t.setState(this.Oh,!1),t.on("active",this.Sh),t.isActive()&&this.onActive(t))},Object.defineProperty(n.prototype,"active",{get:function(){return this.ph},enumerable:!0,configurable:!0}),n.prototype.onActive=function(t){if(t.isToggle()){this.ph=t;for(var n=this.wh,i=0,r=n.length;i<r;++i){var e=n[i];e!==t&&e.isToggle()&&e.isActive()&&e.onClick()}}},n.prototype.remove=function(t){var n=this.wh,i=n.indexOf(t);0<=i&&(n.splice(i,1),t.off("active",this.Sh))},n.prototype.contains=function(t){return 0<=this.wh.indexOf(t)},n.prototype.setHovered=function(t){return this.setState(v.HOVERED,t)},n.prototype.setActive=function(t){return this.setState(v.ACTIVE,t)},n.prototype.setReadOnly=function(t){return this.setState(v.READ_ONLY,t)},n.prototype.setDisabled=function(t){return this.setState(v.DISABLED,t)},n.prototype.setDragging=function(t){return this.setState(v.DRAGGING,t)},n.prototype.isHovered=function(){return this.hasState(v.HOVERED)},n.prototype.isActive=function(){return this.hasState(v.ACTIVE)},n.prototype.isReadOnly=function(){return this.hasState(v.READ_ONLY)},n.prototype.isDisabled=function(){return this.hasState(v.DISABLED)},n.prototype.isDragging=function(){return this.hasState(v.DRAGGING)},n.prototype.isFocused=function(){return this.hasState(v.FOCUSED)},n.prototype.isUnfocusable=function(){return this.hasState(v.UNFOCUSABLE)},n.prototype.setState=function(t,n){n?(this.Dh|=t,this.Oh&=~t):(this.Oh|=t,this.Dh&=~t);for(var i=this.wh,r=0,e=i.length;r<e;++r)i[r].setState(t,n);return this},n.prototype.hasState=function(t){for(var n=this.wh,i=0,r=n.length;i<r;++i)if(n[i].hasState(t))return!0;return!1},n.prototype.clear=function(){this.wh.length=0},n.prototype.destroy=function(){this.clear()},n}(t.utils.EventEmitter),vf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonRadio"},n}(na),bf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonRadioRight"},n}(vf),gf=function(t){function n(n){var i=t.call(this,n)||this,r=qo.getCommandController();return i.setState(v.DISABLED,!r.isRedoable()),r.on("change",(function(){i.setState(v.DISABLED,!r.isRedoable())})),i.on("active",(function(){r.redo()})),i}return i(n,t),n}(ia),df=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DButtonSecondary"},n}(ia),mf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=new qa(i&&i.picker);this.Zs=r,n.addChild(r)},Object.defineProperty(n.prototype,"current",{get:function(){return this.Zs.current},set:function(t){this.Zs.current=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this.Zs.new},set:function(t){this.Zs.new=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"picker",{get:function(){return this.Zs},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDialogTime"},n}(fa),wf=function(){function t(){}return t.getInstance=function(){return null==t.INSTANCE&&(t.INSTANCE=new mf),t.INSTANCE},t}(),pf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;this.ih=n&&n.dialog,this.dh=hf.toMask(n&&n.dialog&&n.dialog.picker),t.prototype.init.call(this,n),this.on("active",(function(){var t=i.rn.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.emit("select",t,r,i),i.text=new Date(t.getTime()),i.emit("change",i)}))}))},n.prototype.getDatetimeMask=function(){return this.dh},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(t=null!=this.ih?new mf(this.ih):wf.getInstance(),this.rh=t),t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"value",{get:function(){return this.rn},set:function(t){this.rn.getTime()!==t.getTime()&&(this.text=t)},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DButtonTime"},n}(ia),Df=function(t){function n(n){var i=t.call(this,n)||this,r=qo.getCommandController();return i.setState(v.DISABLED,!r.isUndoable()),r.on("change",(function(){i.setState(v.DISABLED,!r.isUndoable())})),i.on("active",(function(){r.undo()})),i}return i(n,t),n}(ia),Of=function(t){function n(n){var i=t.call(this)||this;return i.parent=n,i}return i(n,t),n.prototype.render=function(n){this.updateTransform(),t.prototype.render.call(this,n)},n.prototype.onReflow=function(t,n,i){var r=t.corner,e=Math.max(0,r.getRadius()-.5),u=r.getMask(),s=u&h.TOP_LEFT?0:e,o=u&h.TOP_RIGHT?0:e,a=u&h.BOTTOM_LEFT?0:e,f=u&h.BOTTOM_RIGHT?0:e;this.clear(),this.beginFill(16777215,1),this.lineStyle(0,0,0,0,!1),s<=0&&o<=0&&a<=0&&f<=0?(this.moveTo(0,0),this.lineTo(0+n,0),this.lineTo(0+n,0+i),this.lineTo(0,0+i),this.lineTo(0,0)):(this.moveTo(0+s,0),0<o?this.arcTo(0+n,0,0+n,0+i,o):this.lineTo(0+n,0),0<f?this.arcTo(0+n,0+i,0,0+i,f):this.lineTo(0+n,0+i),0<a?this.arcTo(0,0+i,0,0,a):this.lineTo(0,0+i),0<s?this.arcTo(0,0,0+n,0,s):this.lineTo(0,0)),this.endFill()},n}(t.Graphics);!function(t){t[t.OFF=0]="OFF",t[t.ON=1]="ON",t[t.TOUCH=2]="TOUCH"}(Va||(Va={}));var Sf,Mf,Ef=function(){function t(t,n,i,r,e){var u=this;this.Bn=t,this.Mh=n,this.Eh=i;var s=e&&null!=e.mode?o(e.mode)?Va[e.mode]:e.mode:r.getDragMode(),h=e&&null!=e.modifier?o(e.modifier)?ds[e.modifier]:e.modifier:r.getDragModifier(),a=e&&null!=e.duration?e.duration:{position:r.getDragDurationPosition(),scale:r.getDragDurationScale()},f=s===Va.TOUCH;this.Nh=f,s!==Va.ON&&s!==Va.TOUCH||(this.Th=new Ns({target:t,touch:f,modifier:h,checker:e&&e.checker,easing:{duration:a},bind:f,on:{start:function(){u.Eh.stop()},move:function(r,e,u,s,h){var o=n(t);if(null!=o){var a=o.scale.y,f=i.toNormalizedScale(a*h),c=f/a,l=u-r,v=s-e,b=o.position,g=(b.x-l)*c+u,d=(b.y-v)*c+s;o.scale.set(f,f),o.position.set(g,d)}}}}))}return t.prototype.stop=function(){var t=this.Th;null!=t&&t.stop()},t.prototype.onDown=function(t){if(!this.Nh){var n=this.Th;n&&n.onDown(t)}},t}(),Nf=function(){function t(t,n,i,r){var e=this;this.Bn=t,this.Mh=n,this.jh=1,this.Ch=1,this.kh=0,this.yh=0,this.Ih=1,this.Ah=1,this.xh=0,this.Rh=0,this.xr=new Os({onTime:function(t){e.onTime(t)},duration:r}),this.Eh=i,this.wr=r}return t.prototype.onTime=function(t){var n=1-t,i=t,r=this.Ih*n+this.jh*i,e=this.Ah*n+this.Ch*i,u=this.xh*n+this.kh*i,s=this.Rh*n+this.yh*i,h=this.Mh(this.Bn);null!=h&&(h.scale.set(r,e),h.position.set(u,s))},t.prototype.start=function(t,n,i,r,e,u,s){if(!1!==s&&this.Eh.stop(),null==u&&(u=this.wr),u<=0)t.scale.set(r,e),t.position.set(n,i);else{var h=t.position,o=t.scale;this.xh=h.x,this.Rh=h.y,this.Ih=o.x,this.Ah=o.y,this.kh=n,this.yh=i,this.jh=r,this.Ch=e,this.xr.duration=u,this.xr.start()}},t.prototype.stop=function(){this.xr.stop()},t}(),Tf=function(){function n(n,i,r){this.Bn=n,this.Mh=i,this.Lh=new t.Rectangle;var e=this.toTheme(r)||this.getThemeDefault(),u=r&&r.zoom;this.Bh=new t.Point,this.Ph=u&&null!=u.min?u.min:e.getZoomMin(),this.Fh=u&&null!=u.max?u.max:e.getZoomMax(),this._h=u&&null!=u.keepRatio?u.keepRatio:e.getZoomKeepRatio();var s=u&&u.wheel;this.Uh=s&&null!=s.enable?s.enable:e.isWheelZoomEnabled(),this.zh=s&&null!=s.speed?s.speed:e.getWheelZoomSpeed(),this.Gh=s&&null!=s.modifier?o(s.modifier)?ds[s.modifier]:s.modifier:e.getWheelZoomModifier(),this.Hh=s&&s.checker||Es.match;var h=u&&u.dblclick;this.Vh=h&&null!=h.enable?h.enable:e.isDblClickZoomEnabled(),this.Wh=h&&null!=h.amount?h.amount:e.getDblClickZoomSpeed(),this.Yh=h&&null!=h.modifier?o(h.modifier)?ds[h.modifier]:h.modifier:e.getDblClickZoomModifier(),this.Xh=h&&h.checker||Es.match,this.Kh=h&&null!=h.duration?h.duration:e.getDblClickZoomDuration();var a=r&&r.translation&&r.translation.wheel;this.Jh=a&&null!=a.enable?a.enable:e.isWheelTranslationEnabled(),this.Zh=a&&null!=a.speed?a.speed:e.getWheelTranslationSpeed(),this.qh=a&&null!=a.modifier?o(a.modifier)?ds[a.modifier]:a.modifier:e.getWheelTranslationModifier(),this.Qh=a&&a.checker||Es.match,this.$h=new Ef(n,i,this,e,r&&r.drag),this.no=new Nf(n,i,this,this.Kh)}return Object.defineProperty(n.prototype,"drag",{get:function(){return this.$h},enumerable:!0,configurable:!0}),n.prototype.stop=function(){this.$h.stop(),this.no.stop()},n.prototype.reset=function(t,n){var i=this.Bn,r=this.Mh(i);if(r){var e=r.getLocalBounds(this.Lh),u=.5*(i.width-e.width)-e.x,s=.5*(i.height-e.height)-e.y;this.no.start(r,u,s,1,1,t,n)}},n.prototype.fit=function(t,n){var i=this.Bn,r=this.Mh(i);if(r){var e=i.padding,u=i.width,s=i.height,h=r.getLocalBounds(this.Lh),o=h.x,a=h.y,f=h.width,c=h.height,l=(u-e.getLeft()-e.getRight())/f,v=(s-e.getTop()-e.getBottom())/c;if(this._h){var b=this.toNormalizedScale(Math.min(l,v));l=b,v=b}else l=this.toNormalizedScale(l),v=this.toNormalizedScale(v);var g=.5*(u-f*l)-o*l,d=.5*(s-c*v)-a*v;this.no.start(r,g,d,l,v,t,n)}},n.prototype.zoomIn=function(t,n){var i=this.Mh(this.Bn);if(i){var r=this.Wh,e=i.scale;this.zoom(e.x*r,e.y*r,t,n)}},n.prototype.zoomOut=function(t,n){var i=this.Mh(this.Bn);if(i){var r=1/this.Wh,e=i.scale;this.zoom(e.x*r,e.y*r,t,n)}},n.prototype.zoomAt=function(t,n,i,r,e,u){var s=this.Mh(this.Bn);if(s){var h=s.scale.x,o=s.scale.y,a=this.toNormalizedScale(i),f=this.toNormalizedScale(r),c=a/h,l=f/o,v=(s.position.x-t)*c+t,b=(s.position.y-n)*l+n;this.no.start(s,v,b,a,f,e,u)}},n.prototype.zoomAtGlobal=function(t,n,i,r,e,u){var s=this.Bh;s.set(t,n),this.toLocal(s,s),this.zoomAt(s.x,s.y,i,r,e,u)},n.prototype.zoom=function(t,n,i,r){var e=this.Bn;this.zoomAt(.5*e.width,.5*e.height,t,n,i,r)},Object.defineProperty(n.prototype,"scale",{get:function(){var n=this.Mh(this.Bn);return n?n.scale:new t.Point(1,1)},set:function(t){var n=this.Mh(this.Bn);if(n){var i=this.toNormalizedScale(t.x),r=this.toNormalizedScale(t.y);n.scale.set(i,r)}},enumerable:!0,configurable:!0}),n.prototype.moveTo=function(t,n,i,r){var e=this.Mh(this.Bn);if(e){var u=e.scale;this.no.start(e,t,n,u.x,u.y,i,r)}},Object.defineProperty(n.prototype,"position",{get:function(){var n=this.Mh(this.Bn);return n?n.position:new t.Point(0,0)},set:function(t){var n=this.Mh(this.Bn);n&&n.position.set(t.x,t.y)},enumerable:!0,configurable:!0}),n.prototype.transform=function(t,n,i,r,e,u){var s=this.Mh(this.Bn);s&&this.no.start(s,t,n,i,r,e,u)},n.prototype.toLocal=function(t,n,i){return this.Bn.toLocal(t,void 0,n,i)},n.prototype.toGlobal=function(t,n,i){return this.Bn.toGlobal(t,n,i)},n.prototype.toNormalizedScale=function(t){return Math.min(this.Fh,Math.max(this.Ph,t))},n.prototype.onWheel=function(t,n,i){var r;if(this.Uh&&this.Hh(t,this.Gh,this.Bn)&&0!==n.deltaY&&(r=this.Mh(this.Bn))){var e=n.lowest*this.zh,u=1+n.deltaY*e,s=r.scale;return this.zoomAtGlobal(i.x,i.y,s.x*u,s.y*u,0),!0}return!!(this.Jh&&this.Qh(t,this.qh,this.Bn)&&(r=this.Mh(this.Bn)))&&(this.stop(),e=n.lowest*this.Zh,r.position.set(r.position.x-n.deltaX*e,r.position.y+n.deltaY*e),!0)},n.prototype.onDown=function(t){this.$h.onDown(t)},n.prototype.onDblClick=function(t,n){if(this.Vh&&this.Xh(t,this.Yh,this.Bn)){var i=this.Mh(this.Bn);if(i){var r=this.Bh;P.toGlobal(t,n,r);var e=this.Wh,u=i.scale;return this.zoomAtGlobal(r.x,r.y,u.x*e,u.y*e,this.Kh),!0}}return!1},n.prototype.toTheme=function(t){if(t&&t.theme){var n=t.theme;return o(n)?L.getInstance().get(n):n}return null},n.prototype.getThemeDefault=function(){return L.getInstance().get(this.getType())},n.prototype.getType=function(){return"DView"},n}(),jf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.ji=null;var r=this.theme;this.qs=new Tf(this,(function(){return i.ji}),n&&n.view),this.canvas=n&&n.canvas?n.canvas:null,this.ln=null,function(t,n){return n&&null!=n.mask?n.mask:t.isOverflowMaskEnabled()}(r,n)&&(this.mask=this.getOrCreateOverflowMask())},n.prototype.getType=function(){return"DCanvasContainer"},n.prototype.onResize=function(n,i,r,e){t.prototype.onResize.call(this,n,i,r,e),this.updateContentSize(n,i,r,e)},Object.defineProperty(n.prototype,"canvas",{get:function(){return this.ji},set:function(t){var n=this.ji;null!=n&&(this.ji=null,this.removeChild(n),this.emit("unset",n,this),n.destroy()),this.ji=t,null!=t?(this.addChild(t),this.qs.reset(0),this.emit("set",t,this)):e.update(this)},enumerable:!0,configurable:!0}),n.prototype.getOrCreateOverflowMask=function(){return null==this.ln&&(this.ln=new Of(this),this.addReflowable(this.ln),this.toDirty()),this.ln},n.prototype.updateContentSize=function(t,n,i,r){var e=this.ji;if(null!=e){var u=e.x+.5*(t-i),s=e.y+.5*(n-r);e.position.set(u,s)}},Object.defineProperty(n.prototype,"view",{get:function(){return this.qs},enumerable:!0,configurable:!0}),n.prototype.onWheel=function(n,i,r){var e=this.qs.onWheel(n,i,r),u=t.prototype.onWheel.call(this,n,i,r);return e||u},n.prototype.onDblClick=function(n,i){var r=this.qs.onDblClick(n,i),e=t.prototype.onDblClick.call(this,n,i);return r||e},n.prototype.onDown=function(n){this.qs.onDown(n),t.prototype.onDown.call(this,n)},n.prototype.destroy=function(){var n=this.ln;null!=n&&(this.ln=null,n.destroy()),this.mask=null,t.prototype.destroy.call(this)},n}(z),Cf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DCanvas"},n}(z);!function(t){t[t.TOP=0]="TOP",t[t.BOTTOM=1]="BOTTOM",t[t.LEFT=2]="LEFT",t[t.RIGHT=3]="RIGHT"}(Sf||(Sf={})),function(t){t[t.INSIDE=0]="INSIDE",t[t.OUTSIDE=1]="OUTSIDE"}(Mf||(Mf={}));var kf,yf=function(){function t(){}return t.from=function(t){if(o(t))return rn[t];if(c(t))return t;for(var n=rn.NONE,i=0,r=t.length;i<r;++i)n|=rn[t[i]];return n},t}(),If=function(){function t(t,n){this.io=n&&null!=n.coordinate?n.coordinate:0,this.et=this.toPosition(t,n),this.ro=this.toTickContainer(t,n),this.ls=this.toLabel(t,n),this.Dt=n&&null!=n.padding?n.padding:t.getPadding(),this.eo=this.toBar(t,n)}return Object.defineProperty(t.prototype,"coordinateIndex",{get:function(){return this.io},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this.Dt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this.et},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bar",{get:function(){return this.eo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"tick",{get:function(){return this.ro},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"label",{get:function(){return this.ls},enumerable:!0,configurable:!0}),t.prototype.toPosition=function(t,n){var i=n&&n.position;return o(i)?Sf[i]:null!=i?i:t.getPosition()},t.prototype.toBar=function(t,n){return{style:n&&null!=n.style?n.style:t.getStyle(),stroke:this.toBarStroke(t,n&&n.stroke),shape:void 0}},t.prototype.toTickContainer=function(t,n){var i=n&&n.tick;return{enable:i&&null!=i.enable?i.enable:t.getTickEnable(),major:this.toTickMajor(t,i),minor:this.toMinorTick(t,i)}},t.prototype.toTickMajor=function(t,n){var i=n&&n.major,r=i&&null!=i.position?i.position:n&&null!=n.position?n.position:t.getMajorTickPosition(),e=n&&n.style,u=yf.from(i&&null!=i.style?i.style:null!=e?e:t.getMajorTickStyle()),s=n&&n.stroke,h=this.toTickMajorStroke(t,i&&i.stroke,s);return{count:i&&null!=i.count?i.count:t.getMajorTickCount(),size:i&&null!=i.size?i.size:t.getMajorTickSize(),position:this.toTickPosition(r),style:u,stroke:h,text:this.toMajorTickText(t,i&&i.text),formatter:this.toMajorTickFormatter(t,i),shapes:void 0,gridline:this.toTickMajorGridline(t,i&&i.gridline,e,s)}},t.prototype.toTickMajorGridline=function(t,n,i,r){var e=yf.from(n&&null!=n.style?n.style:null!=i?i:t.getMajorTickGridlineStyle());return{enable:n&&null!=n.enable?n.enable:t.getMajorTickGridlineEnable(),style:e,stroke:this.toTickMajorGridlineStroke(t,n&&n.stroke,r),shapes:void 0}},t.prototype.toTickPosition=function(t){var n=this.et;if(t===Mf.OUTSIDE||"OUTSIDE"===t)switch(n){case Sf.TOP:return un.BOTTOM;case Sf.BOTTOM:return un.TOP;case Sf.LEFT:return un.RIGHT;case Sf.RIGHT:return un.LEFT;default:return un.TOP}else switch(n){case Sf.TOP:return un.TOP;case Sf.BOTTOM:return un.BOTTOM;case Sf.LEFT:return un.LEFT;case Sf.RIGHT:return un.RIGHT;default:return un.TOP}},t.prototype.toMinorTick=function(t,n){var i=n&&n.major,r=i&&null!=i.position?i.position:n&&null!=n.position?n.position:t.getMinorTickPosition(),e=yf.from(i&&null!=i.style?i.style:n&&null!=n.style?n.style:t.getMinorTickStyle());return{count:i&&null!=i.count?i.count:t.getMinorTickCount(),size:i&&null!=i.size?i.size:t.getMinorTickSize(),position:this.toTickPosition(r),style:e,stroke:this.toTickMinorStroke(t,i&&i.stroke,n&&n.stroke),shapes:void 0}},t.prototype.toBarStroke=function(t,n){return this.toStroke(n,void 0,t.getStrokeEnable(),t.getStrokeColor(),t.getStrokeAlpha(),t.getStrokeWidth(),t.getStrokeAlign(),t.getStrokeSide())},t.prototype.toTickMajorStroke=function(t,n,i){return this.toStroke(n,i,t.getMajorTickStrokeEnable(),t.getMajorTickStrokeColor(),t.getMajorTickStrokeAlpha(),t.getMajorTickStrokeWidth(),t.getMajorTickStrokeAlign(),t.getMajorTickStrokeSide())},t.prototype.toTickMajorGridlineStroke=function(t,n,i){return this.toStroke(n,i,t.getMajorTickGridlineStrokeEnable(),t.getMajorTickGridlineStrokeColor(),t.getMajorTickGridlineStrokeAlpha(),t.getMajorTickGridlineStrokeWidth(),t.getMajorTickGridlineStrokeAlign(),t.getMajorTickGridlineStrokeSide())},t.prototype.toTickMinorStroke=function(t,n,i){return this.toStroke(n,i,t.getMinorTickStrokeEnable(),t.getMinorTickStrokeColor(),t.getMinorTickStrokeAlpha(),t.getMinorTickStrokeWidth(),t.getMinorTickStrokeAlign(),t.getMinorTickStrokeSide())},t.prototype.toStroke=function(t,n,i,r,e,u,s,h){return t?n?{enable:null!=t.enable?t.enable:null!=n.enable?n.enable:i,color:null!=t.color?t.color:null!=n.color?n.color:r,alpha:null!=t.alpha?t.alpha:null!=n.alpha?n.alpha:e,width:null!=t.width?t.width:null!=n.width?n.width:u,align:null!=t.align?t.align:null!=n.align?n.align:s,side:null!=t.side?t.side:null!=n.side?n.side:h}:{enable:null!=t.enable?t.enable:i,color:null!=t.color?t.color:r,alpha:null!=t.alpha?t.alpha:e,width:null!=t.width?t.width:u,align:null!=t.align?t.align:s,side:null!=t.side?t.side:h}:n?{enable:null!=n.enable?n.enable:i,color:null!=n.color?n.color:r,alpha:null!=n.alpha?n.alpha:e,width:null!=n.width?n.width:u,align:null!=n.align?n.align:s,side:null!=n.side?n.side:h}:{enable:i,color:r,alpha:e,width:u,align:s,side:h}},t.prototype.toMajorTickFormatter=function(t,n){var i=n&&n.text;if(i){var r=i.format;if(null!=r)return jr.create(r);var e=i.formatter;if(e)return{format:e}}return jr.create(t.getMajorTickTextFormat())},t.prototype.toMajorTickText=function(t,n){return{format:(n=n||{}).format,color:n.color,alpha:n.alpha,family:n.family,size:n.size,weight:n.weight,align:this.toMajorTickTextAlign(t,n.align),offset:this.toMajorTickTextOffset(t,n.offset),style:n.style,outline:this.toMajorTickTextOutline(t,n.outline),spacing:this.toMajorTickTextSpacing(t,n.spacing),direction:this.toTickMajorTextDirection(t,n.direction),padding:this.toMajorTickTextPadding(t,n.padding),clipping:n.clipping}},t.prototype.toMajorTickTextOutline=function(t,n){if(n)return{enable:n.enable,color:n.color,alpha:n.alpha,width:n.width}},t.prototype.toMajorTickTextAlign=function(t,n){var i=this.et;return n?{horizontal:null!=n.horizontal?n.horizontal:t.getMajorTickTextAlignHorizontal(i),vertical:null!=n.vertical?n.vertical:t.getMajorTickTextAlignVertical(i)}:{horizontal:t.getMajorTickTextAlignHorizontal(i),vertical:t.getMajorTickTextAlignVertical(i)}},t.prototype.toMajorTickTextOffset=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toMajorTickTextSpacing=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toMajorTickTextPadding=function(t,n){return{horizontal:n&&null!=n.horizontal?n.horizontal:t.getMajorTickTextPaddingHorizontal(),vertical:n&&null!=n.vertical?n.vertical:t.getMajorTickTextPaddingVertical()}},t.prototype.toTickMajorTextDirection=function(t,n){return null!=n?n:t.getMajorTickTextDirection()},t.prototype.toLabel=function(t,n){var i=n&&n.label;if(i)return{value:i.value,color:i.color,alpha:i.alpha,family:i.family,size:i.size,weight:i.weight,align:this.toLabelAlign(t,i.align),offset:this.toLabelOffset(t,i.offset),style:i.style,outline:this.toLabelOutline(t,i.outline),spacing:this.toLabelSpacing(t,i.spacing),direction:this.toLabelDirection(t,i.direction),padding:this.toLabelPadding(t,i.padding),clipping:i.clipping}},t.prototype.toLabelOutline=function(t,n){if(n)return{enable:n.enable,color:n.color,alpha:n.alpha,width:n.width}},t.prototype.toLabelAlign=function(t,n){var i=this.et;return n?{horizontal:null!=n.horizontal?n.horizontal:t.getLabelAlignHorizontal(i),vertical:null!=n.vertical?n.vertical:t.getLabelAlignVertical(i)}:{horizontal:t.getLabelAlignHorizontal(i),vertical:t.getLabelAlignVertical(i)}},t.prototype.toLabelOffset=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toLabelSpacing=function(t,n){if(n)return{horizontal:n.horizontal,vertical:n.vertical}},t.prototype.toLabelPadding=function(t,n){return{horizontal:n&&null!=n.horizontal?n.horizontal:t.getLabelPaddingHorizontal(),vertical:n&&null!=n.vertical?n.vertical:t.getLabelPaddingVertical()}},t.prototype.toLabelDirection=function(t,n){return null!=n?n:t.getLabelDirection()},t}(),Af=function(){function t(t){var n=this.toTheme(t);this.i=n,this.Me=0;var i=new If(n,t);this.io=i.coordinateIndex,this.Dt=i.padding,this.et=i.position;var r=i.tick;this.ro=r,this.ls=i.label,this.eo=i.bar,this.uo=new Float64Array(3*r.major.count),this.so=new Float64Array((r.major.count+1)*r.minor.count*3)}return Object.defineProperty(t.prototype,"position",{get:function(){return this.et},enumerable:!0,configurable:!0}),t.prototype.updateBar=function(t){var n=this.eo.shape;if(n){var i=t.plotArea,r=i.width,e=i.height,u=this.Dt*this.Me;switch(n.disallowUploadedUpdate(),this.et){case Sf.TOP:n.transform.position.set(.5*r,0-u),n.size.set(r,0);break;case Sf.BOTTOM:n.transform.position.set(.5*r,e+u),n.size.set(r,0);break;case Sf.LEFT:n.transform.position.set(0-u,.5*e),n.size.set(0,e);break;case Sf.RIGHT:n.transform.position.set(r+u,.5*e),n.size.set(0,e)}n.allowUploadedUpdate()}},t.prototype.updateTicksX=function(t,n,i,r,e,u,s,h,o){var a=this.ro,f=a.major.count,c=a.major.formatter,l=a.minor.count,v=(f+1)*l,b=this.uo,g=this.so;i.ticks(t,n,f,l,v,b,g);for(var d=h.a,m=h.tx,w=0;w<f;++w){var p=r[w],D=3*w,O=b[D+0];if(fs(O))p.visible=!1,u&&(u[w].visible=!1);else{var S=d*b[D+1]+m,M=b[D+2];if(p.disallowUploadedUpdate(),p.visible=!0,p.transform.position.set(S,s),p.text.value=c.format(O,M),p.allowUploadedUpdate(),u){var E=u[w];E.disallowUploadedUpdate(),E.visible=!0,E.transform.position.set(S,.5*o),E.size.set(0,o),E.allowUploadedUpdate()}}}for(w=0;w<v;++w){var N=e[w],T=3*w,j=g[T+0],C=g[T+1];fs(j)?N.visible=!1:(N.disallowUploadedUpdate(),N.visible=!0,N.transform.position.set(d*C+m,s),N.allowUploadedUpdate())}},t.prototype.updateTicksY=function(t,n,i,r,e,u,s,h,o){var a=this.ro,f=a.major.count,c=a.major.formatter,l=a.minor.count,v=(f+1)*l,b=this.uo,g=this.so;i.ticks(t,n,f,l,v,b,g);for(var d=h.d,m=h.ty,w=0;w<f;++w){var p=r[w],D=3*w,O=b[D+0];if(fs(O))p.visible=!1,u&&(u[w].visible=!1);else{var S=d*b[D+1]+m,M=b[D+2];if(p.disallowUploadedUpdate(),p.visible=!0,p.transform.position.set(s,S),p.text.value=c.format(O,M),p.allowUploadedUpdate(),u){var E=u[w];E.disallowUploadedUpdate(),E.visible=!0,E.transform.position.set(.5*o,S),E.size.set(o,0),E.allowUploadedUpdate()}}}for(w=0;w<v;++w){var N=e[w],T=3*w,j=g[T+0],C=g[T+1];fs(j)?N.visible=!1:(N.disallowUploadedUpdate(),N.visible=!0,N.transform.position.set(s,d*C+m),N.allowUploadedUpdate())}},t.prototype.updateTicks=function(t){var n=this.ro,i=n.major.shapes,r=n.minor.shapes;if(i&&r){var e=t.plotArea,u=e.getBoundsInContainer(),s=e.container.transform.localTransform,h=n.major.gridline.shapes,o=this.io,a=this.Dt*this.Me,f=void 0;switch(this.et){case Sf.TOP:if(f=e.coordinate.x.get(o)){var c=f.unmap(f.transform.unmap(u.x)),l=f.unmap(f.transform.unmap(u.x+u.width)),v=e.height;this.updateTicksX(c,l,f,i,r,h,0-a,s,v)}break;case Sf.BOTTOM:(f=e.coordinate.x.get(o))&&(c=f.unmap(f.transform.unmap(u.x)),l=f.unmap(f.transform.unmap(u.x+u.width)),v=e.height,this.updateTicksX(c,l,f,i,r,h,v+a,s,v));break;case Sf.LEFT:if(f=e.coordinate.y.get(o)){c=f.unmap(f.transform.unmap(u.y)),l=f.unmap(f.transform.unmap(u.y+u.height));var b=e.width;this.updateTicksY(c,l,f,i,r,h,0-a,s,b)}break;case Sf.RIGHT:(f=e.coordinate.y.get(o))&&(c=f.unmap(f.transform.unmap(u.y)),l=f.unmap(f.transform.unmap(u.y+u.height)),b=e.width,this.updateTicksY(c,l,f,i,r,h,b+a,s,b))}}},t.prototype.bind=function(t,n){this.ho=t,this.Me=n;var i=t.container,r=this.eo,e=r.shape;if(!e){var u=(f=this.et)===Sf.LEFT||f===Sf.RIGHT?un.TOP:un.LEFT;(e=new zn(u,-1,Sn.STROKE_WIDTH,r.style)).stroke.copy(r.stroke),e.text.copy(this.ls),this.eo.shape=e}e.attach(t.container);var s=this.ro,h=s.major,o=h.gridline,a=o.shapes;if(!a&&s.enable&&o.enable){a=[],o.shapes=a;for(var f,c=(f=this.et)===Sf.LEFT||f===Sf.RIGHT?un.LEFT:un.TOP,l=h.count,v=o.style,b=0;b<l;++b){var g=new zn(c,-1,Sn.STROKE_WIDTH,v);g.stroke.copy(o.stroke),a.push(g)}}if(a){b=0;for(var d=a.length;b<d;++b)a[b].attach(i)}var m=h.shapes;if(!m&&s.enable){m=[],h.shapes=m;var w=h.count,p=h.size,D=h.position,O=h.style;for(b=0;b<w;++b){var S=new zn(D,p,Sn.STROKE_WIDTH,O);S.stroke.copy(h.stroke),S.text.copy(h.text),S.size.set(0,0),m.push(S)}}if(m)for(b=0,d=m.length;b<d;++b)m[b].attach(i);var M=s.minor,E=M.shapes;if(!E&&s.enable){E=[],M.shapes=E;var N=M.count,T=M.size,j=M.position,C=M.style;for(b=0,d=(h.count+1)*N;b<d;++b){var k=new zn(j,T,Sn.STROKE_WIDTH,C);k.stroke.copy(M.stroke),k.size.set(0,0),E.push(k)}}if(E)for(b=0,d=E.length;b<d;++b)E[b].attach(i)},t.prototype.unbind=function(){var t=this.eo.shape;t&&t.detach();var n=this.ro,i=n.major.shapes;if(i)for(var r=0,e=i.length;r<e;++r)i[r].detach();var u=n.major.gridline.shapes;if(u)for(r=0,e=u.length;r<e;++r)u[r].detach();var s=n.minor.shapes;if(s)for(r=0,e=s.length;r<e;++r)s[r].detach();this.ho=void 0},t.prototype.update=function(){var t=this.ho;t&&(this.updateBar(t),this.updateTicks(t))},t.prototype.destroy=function(){var t=this.eo.shape;t&&t.destroy();var n=this.ro,i=n.major.shapes;if(i)for(var r=0,e=i.length;r<e;++r)i[r].destroy();var u=n.major.gridline.shapes;if(u)for(r=0,e=u.length;r<e;++r)u[r].destroy();var s=n.minor.shapes;if(s)for(r=0,e=s.length;r<e;++r)s[r].destroy();this.ho=void 0},t.prototype.toTheme=function(t){return t&&t.theme||this.getThemeDefault()},t.prototype.getThemeDefault=function(){return L.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartAxisBase"},t}(),xf=function(){function t(t,n){this.oo=t,this.ho=new Eo,this.ao=new Map;var i=n&&n.list;if(i)for(var r=0,e=i.length;r<e;++r)this.add(i[r])}return Object.defineProperty(t.prototype,"container",{get:function(){return this.ho},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this.oo},enumerable:!0,configurable:!0}),t.prototype.add=function(t){var n=this.ao,i=n.get(t.position);null==i&&(i=[],n.set(t.position,i)),i.push(t),t.bind(this,i.length-1)},t.prototype.get=function(t,n){var i=this.ao.get(t);return i&&0<=n&&n<i.length?i[n]:null},t.prototype.indexOf=function(t){var n=this.ao.get(t.position);return n?n.indexOf(t):-1},t.prototype.remove=function(t,n){var i=this.ao;if(c(t)){var r=t,e=n;if((s=i.get(r))&&0<=e&&e<s.length){var u=s.splice(e,1)[0];return u.unbind(),u.destroy(),u}}else{var s,h=t;if(r=h.position,(s=i.get(r))&&0<=(e=s.indexOf(t)))return s.splice(e,1),h.unbind(),h.destroy(),h}return null},t.prototype.clear=function(t){var n=this.ao.get(t);if(n){for(var i=0,r=n.length;i<r;++i)n[i].destroy();n.length=0}return this},t.prototype.size=function(t){var n=this.ao.get(t);return n?n.length:0},t.prototype.update=function(){this.ao.forEach((function(t){for(var n=0,i=t.length;n<i;++n)t[n].update()}))},t.prototype.destroy=function(){this.ao.forEach((function(t){for(var n=0,i=t.length;n<i;++n)t[n].destroy();t.length=0}))},t}(),Rf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DChartAxisX"},n}(Af),Lf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DChartAxisXDatetime"},n}(Rf),Bf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DChartAxisY"},n}(Af),Pf=[1095651,16667680,15778578,1858929],Ff=[Pf[0],mn.brighten(Pf[0],.4),Pf[1],mn.brighten(Pf[1],.4),Pf[2],mn.brighten(Pf[2],.4),Pf[3],mn.brighten(Pf[3],.4)],_f=function(t){return Ff[t%Ff.length]};!function(t){t[t.X=0]="X",t[t.Y=1]="Y"}(kf||(kf={}));var Uf,zf=function(){function t(t,n){this.ho=t,this.yn=n,this.ao=[]}return Object.defineProperty(t.prototype,"container",{get:function(){return this.ho},enumerable:!0,configurable:!0}),t.prototype.add=function(t,n){var i=this.ao;return null==n?i.push(t):0<=n&&n<i.length?i.splice(n,0,t):i.push(t),t.bind(this,this.yn),this},t.prototype.get=function(t){var n=this.ao;return 0<=t&&t<n.length?n[t]:null},t.prototype.indexOf=function(t){return this.ao.indexOf(t)},t.prototype.remove=function(t){var n=this.ao;if(c(t)){if(0<=(r=t)&&r<n.length){var i=n.splice(r,1)[0];return i.unbind(),i}}else{var r,e=t;if(0<=(r=n.indexOf(e)))return n.splice(r,1),e.unbind(),e}return null},t.prototype.clear=function(){for(var t=this.ao,n=0,i=t.length;n<i;++n)t[n].unbind();return t.length=0,this},t.prototype.destroy=function(){return this.clear()},t.prototype.size=function(){return this.ao.length},t.prototype.fit=function(){for(var t=this.ao,n=0,i=t.length;n<i;++n)t[n].fit();return this},t}(),Gf=function(){function t(t,n){this.oo=t;var i=this._x=new zf(this,kf.X),r=this._y=new zf(this,kf.Y);if(n){var e=n.x;if(e)if(Zn(e))for(var u=0,s=e.length;u<s;++u)i.add(e[u]);else i.add(e);var h=n.y;if(h)if(Zn(h))for(u=0,s=h.length;u<s;++u)r.add(h[u]);else r.add(h)}}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this.oo},enumerable:!0,configurable:!0}),t.prototype.fit=function(){return this._x.fit(),this._y.fit(),this},t}(),Hf=function(){function t(t){this.i=t}return t.prototype.calcStepMajor=function(t,n,i){if(0<i){var r=Math.abs(n-t)/i,e=Math.floor(Math.log(r)/Math.LN10),u=Math.pow(10,e);return this.i.toStepScale(r/u)*u}return-1},t.prototype.calcStepMinor=function(t,n){return 0<=t?t/(n+1):-1},t.prototype.calcTickMinorPositions=function(t,n,i,r,e,u,s){for(var h=0;h<n;h+=1){var o=i+(h+1)*t;r<=o&&o<=e&&(s[u++]=o)}},t.prototype.calculate=function(t,n,i,r,e,u,s,h){if(!(i<=0)){var o=h.transform,a=Math.min(t,n),f=Math.max(t,n),c=this.calcStepMajor(a,f,i);if(c<=0){u[0]=a,u[1]=o.map(h.map(a)),u[2]=0;for(var l=1;l<i;++l)u[0+(M=3*l)]=NaN,u[M+1]=NaN,u[M+2]=NaN;for(l=0;l<e;++l)s[0+(E=3*l)]=NaN,s[E+1]=NaN,s[E+2]=NaN}else{var v=Math.floor(a/c)-1,b=Math.ceil(f/c)+1,g=this.calcStepMinor(c,r),d=0,m=0;for(l=v;l<=b;++l){var w=l*c;if(d<i&&a<=w&&w<=f){var p=o.map(h.map(w));u[0+(M=3*d)]=w,u[M+1]=p,u[M+2]=c,d+=1}for(var D=0;D<r;D+=1)if(m<e){var O=w+(D+1)*g;if(a<=O&&O<=f){var S=o.map(h.map(O));s[0+(E=3*m)]=O,s[E+1]=S,s[E+2]=g,m+=1}}}for(l=d;l<i;++l){var M;u[0+(M=3*l)]=NaN,u[M+1]=NaN,u[M+2]=NaN}for(l=m;l<e;++l){var E;s[0+(E=3*l)]=NaN,s[E+1]=NaN,s[E+2]=NaN}}}},t}(),Vf=function(){function t(t){this.i=t,this.xt=0,this.fo=0,this.ut=1,this.co=0,this.lo=1}return Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"translate",{get:function(){return this.fo},set:function(t){this.set(t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this.ut},set:function(t){this.set(void 0,t)},enumerable:!0,configurable:!0}),t.prototype.bind=function(t,n){this.set(0,n===kf.X?1:-1)},t.prototype.unbind=function(){},t.prototype.set=function(t,n){var i=!1;null!=t&&this.fo!==t&&(i=!0,this.fo=t),null!=n&&this.ut!==n&&(i=!0,this.ut=n),i&&(this.xt+=1,this.lo=this.i.isZero(this.ut)?0:1/this.ut,this.co=-this.fo*this.lo)},t.prototype.map=function(t){return this.fo+this.ut*t},t.prototype.mapAll=function(t,n,i,r,e){for(var u=this.fo,s=this.ut,h=n+e;h<i;h+=r)t[h]=u+s*t[h]},t.prototype.unmap=function(t){return this.co+this.lo*t},t.prototype.unmapAll=function(t,n,i,r,e){for(var u=this.co,s=this.lo,h=n+e;h<i;h+=r)t[h]=u+s*t[h]},t}(),Wf=function(){function t(t,n){this.from=t,this.to=n}return t.prototype.set=function(t,n){return null!=t&&(this.from=t),null!=n&&(this.to=n),this},t.prototype.add=function(t,n){return fs(t)||(this.from=fs(this.from)?t:Math.min(this.from,t)),fs(n)||(this.to=fs(this.to)?n:Math.max(this.to,n)),this},t.prototype.clear=function(){return this.from=NaN,this.to=NaN,this},t}(),Yf=function(){function t(t){this.xt=0,this.yn=kf.X;var n=this.toTheme(t);this.i=n,this.no=new Vf(n),this.ro=new Hf(n),this.Be=new Wf(NaN,NaN)}return t.prototype.bind=function(t,n){this.ho=t,this.yn=n,this.no.bind(t,n)},t.prototype.unbind=function(){this.ho=void 0,this.no.unbind()},t.prototype.fit=function(){var t=this.ho;if(t){var n=t.container.plotArea,i=n.padding,r=this.Be;switch(this.yn){case kf.X:this.vo(i.getLeft(),n.width-i.getRight(),n.series.getDomain(this,r));break;case kf.Y:this.vo(n.height-i.getBottom(),i.getTop(),n.series.getRange(this,r))}}},t.prototype.vo=function(t,n,i){var r=i.from,e=i.to;if(!fs(r)&&!fs(e)){var u,s=e-r,h=t-r*(u=this.i.isZero(s)?n<t?-1:1:(n-t)/s);this.no.set(h,u)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return this.no},enumerable:!0,configurable:!0}),t.prototype.map=function(t){return t},t.prototype.mapAll=function(t,n,i,r,e){},t.prototype.unmap=function(t){return t},t.prototype.unmapAll=function(t,n,i,r,e){},t.prototype.ticks=function(t,n,i,r,e,u,s){this.ro.calculate(t,n,i,r,e,u,s,this)},t.prototype.toTheme=function(t){return t&&t.theme||this.getThemeDefault()},t.prototype.getThemeDefault=function(){return L.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinateLinear"},t}(),Xf=function(){function t(t){this.i=t}return t.prototype.calcStepMajor=function(t,n,i){if(0<i){var r=Math.abs(n-t)/i,e=Math.floor(Math.log(r)/Math.LN10),u=Math.pow(10,e);return this.i.toStepScale(r/u)*u}return-1},t.prototype.calcStepMinor=function(t,n){return 0<=t?t/(n+1):-1},t.prototype.calcTickMinorPositions=function(t,n,i,r,e,u,s){for(var h=0;h<n;h+=1){var o=i+(h+1)*t;r<=o&&o<=e&&(s[u++]=o)}},t.prototype.calculate=function(t,n,i,r,e,u,s,h){if(!(i<=0)){var o=h.transform,a=h.map(t),f=h.map(n),c=Math.min(a,f),l=Math.max(a,f),v=this.calcStepMajor(c,l,i);if(v<=0){var b=Math.min(t,n);u[0]=b,u[1]=o.map(h.map(b)),u[2]=0;for(var g=1;g<i;++g)u[0+(y=3*g)]=NaN,u[y+1]=NaN,u[y+2]=NaN;for(g=0;g<e;++g)s[0+(I=3*g)]=NaN,s[I+1]=NaN,s[I+2]=NaN}else{var d=Math.floor(c/v)-1,m=Math.ceil(l/v)+1,w=this.calcStepMinor(v,r),p=0,D=0;for(g=d;g<=m;++g){var O=g*v;if(p<i&&c<=O&&O<=l){var S=h.unmap(O),M=o.map(O),E=h.unmap(O-1);u[0+(y=3*p)]=S,u[y+1]=M,u[y+2]=E,p+=1}for(var N=0;N<r;N+=1)if(D<e){var T=O+(N+1)*w;if(c<=T&&T<=l){var j=h.unmap(T),C=o.map(T),k=h.unmap(T-1);s[0+(I=3*D)]=j,s[I+1]=C,s[I+2]=k,D+=1}}}for(g=p;g<i;++g){var y;u[0+(y=3*g)]=NaN,u[y+1]=NaN,u[y+2]=NaN}for(g=D;g<e;++g){var I;s[0+(I=3*g)]=NaN,s[I+1]=NaN,s[I+2]=NaN}}}},t}(),Kf=function(){function t(t){this.xt=0,this.yn=kf.X;var n=this.toTheme(t);this.i=n,this.no=new Vf(n),this.ro=new Xf(n),this.Be=new Wf(NaN,NaN)}return t.prototype.bind=function(t,n){this.ho=t,this.yn=n},t.prototype.unbind=function(){this.ho=void 0},t.prototype.fit=function(){var t=this.ho;if(t){var n=t.container.plotArea,i=n.padding,r=this.Be;switch(this.yn){case kf.X:this.vo(i.getLeft(),n.width-i.getRight(),n.series.getDomain(this,r));break;case kf.Y:this.vo(n.height-i.getBottom(),i.getTop(),n.series.getRange(this,r))}}},t.prototype.vo=function(t,n,i){var r=i.from,e=i.to;if(!fs(r)&&!fs(e)){var u,s=this.map(r),h=this.map(e)-s,o=t-s*(u=this.i.isZero(h)?n<t?-1:1:(n-t)/h);this.no.set(o,u)}},Object.defineProperty(t.prototype,"id",{get:function(){return this.xt},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return this.no},enumerable:!0,configurable:!0}),t.prototype.map=function(t){return Math.log(Math.max(0,t))/Math.LN10},t.prototype.mapAll=function(t,n,i,r,e){for(var u=1/Math.LN10,s=n+e;s<i;s+=r){var h=t[s];t[s]=Math.log(Math.max(0,h))*u}},t.prototype.unmap=function(t){return Math.pow(10,t)},t.prototype.unmapAll=function(t,n,i,r,e){for(var u=n+e;u<i;u+=r)t[u]=Math.pow(10,t[u])},t.prototype.ticks=function(t,n,i,r,e,u,s){this.ro.calculate(t,n,i,r,e,u,s,this)},t.prototype.toTheme=function(t){return t&&t.theme||this.getThemeDefault()},t.prototype.getThemeDefault=function(){return L.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinateLog"},t}(),Jf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DChartLegendItem"},n}(z),Zf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DChartLegend"},n}(z),qf=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DChartOverview"},n}(z),Qf=function(n){function r(i){var r=n.call(this)||this,e=r.transform;return r.et=new d(e.position,i),r.ut=new d(e.scale,i),r.Lh=new t.Rectangle,r}return i(r,n),Object.defineProperty(r.prototype,"position",{get:function(){return this.et},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"scale",{get:function(){return this.ut},enumerable:!0,configurable:!0}),r.prototype.getBounds=function(t,i){return this.bo=-1,n.prototype.getBounds.call(this,t,i)},r.prototype.calculateBounds=function(){var t=this._bounds,n=this.Be,i=this.Lh,r=this.transform.worldTransform,e=0,u=0,s=0,h=0,o=this.children;if(0<o.length)for(var a=!0,f=0,c=o.length;f<c;++f){var l=o[f];l.visible&&(l.getBoundsInternal(n,!1,i),a?(a=!1,e=i.x,s=i.y,u=i.x+i.width,h=i.y+i.height):(e=Math.min(e,i.x),s=Math.min(s,i.y),u=Math.max(u,i.x+i.width),h=Math.max(h,i.y+i.height)))}t.clear(),n.set(e,s),r.apply(n,n),t.addPoint(n),n.set(u,h),r.apply(n,n),t.addPoint(n)},r}(Eo),$f=function(){function t(){this.shape=null,this.x=0,this.y=0,this.p0x=0,this.p0y=0,this.p1x=0,this.p1y=0,this.index=0,this.t=0,this.distance=0}return t.prototype.copyFrom=function(t){return this.shape=t.shape,this.x=t.x,this.y=t.y,this.p0x=t.p0x,this.p0y=t.p0y,this.p1x=t.p1x,this.p1y=t.p1y,this.index=t.index,this.t=t.t,this.distance=t.distance,this},t}(),tc=function(){function t(){}return t.from=function(t,n){return Zn(t)?function(n){return t[n%t.length]}:u(t)?t:null!=t?function(){return t}:Zn(n)?function(t){return n[t%n.length]}:u(n)?n:function(){return n}},t}(),nc=function(t){this.enable=tc.from(t&&t.enable,!0),this.color=tc.from(t&&t.color,_f),this.alpha=tc.from(t&&t.alpha,Sn.FILL_ALPHA)},ic=function(t){this.enable=tc.from(t&&t.enable,!0),this.color=tc.from(t&&t.color,_f),this.alpha=tc.from(t&&t.alpha,Sn.STROKE_ALPHA),this.width=tc.from(t&&t.width,Sn.STROKE_WIDTH),this.align=tc.from(t&&t.width,Sn.STROKE_ALIGN),this.side=tc.from(t&&t.side,vn.ALL),this.style=tc.from(t&&t.style,rn.NON_EXPANDING_WIDTH|rn.NON_SHRINKING_WIDTH|rn.NON_SCALING_DOT_AND_DASH)},rc=function(){function t(t,n){this.oo=t,this.do=new Wf(NaN,NaN),this.mo=new Wf(NaN,NaN),this.Ht=new nc(n&&n.fill),this.we=new ic(n&&n.stroke),this.wo=n&&n.selection||null,this.ao=[];var i=n&&n.list;if(i){var r=i.length;if(0<r){for(var e=0;e<r;++e)this.add(i[e]);this.update()}}}return Object.defineProperty(t.prototype,"plotArea",{get:function(){return this.oo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fill",{get:function(){return this.Ht},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"stroke",{get:function(){return this.we},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this.wo},enumerable:!0,configurable:!0}),t.prototype.update=function(){for(var t=this.ao,n=0,i=t.length;n<i;++n)t[n].update();var r=this.wo;r&&r.update()},t.prototype.add=function(t){var n=this.ao;t.bind(this,n.length),n.push(t)},t.prototype.get=function(t){var n=this.ao;return 0<=t&&t<n.length?n[t]:null},t.prototype.indexOf=function(t){return this.ao.indexOf(t)},t.prototype.remove=function(t){var n=this.ao;if(c(t)){if(0<=(r=t)&&r<n.length){var i=n.splice(r,1)[0];return i.unbind(),i.destroy(),i}}else{var r,e=t;if(0<=(r=n.indexOf(e)))return n.splice(r,1),e.unbind(),e.destroy(),e}return null},t.prototype.clear=function(){for(var t=this.ao,n=0,i=t.length;n<i;++n)t[n].destroy();return t.length=0,this},t.prototype.size=function(){return this.ao.length},t.prototype.destroy=function(){this.clear();var t=this.wo;t&&t.unbind()},t.prototype.getDomain=function(t,n){n.clear();for(var i=this.ao,r=0,e=i.length;r<e;++r){var u=i[r];if(u.coordinate.x===t){var s=u.domain;n.add(s.from,s.to)}}return n},t.prototype.getRange=function(t,n){n.clear();for(var i=this.ao,r=0,e=i.length;r<e;++r){var u=i[r];if(u.coordinate.y===t){var s=u.range;n.add(s.from,s.to)}}return n},Object.defineProperty(t.prototype,"domain",{get:function(){var t=this.do;t.clear();for(var n=this.ao,i=0,r=n.length;i<r;++i){var e=n[i].domain;t.add(e.from,e.to)}return t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){var t=this.mo;t.clear();for(var n=this.ao,i=0,r=n.length;i<r;++i){var e=n[i].range;t.add(e.from,e.to)}return t},enumerable:!0,configurable:!0}),t.prototype.hitTest=function(t){for(var n=this.ao,i=n.length-1;0<=i;--i){var r=n[i];if(r.hitTest(t))return r}return null},t.prototype.calcHitPoint=function(n,i){var r=i,e=t.WORK_CALCHITPOINT,u=this.ao,s=null;e.distance=1/0;for(var h=u.length-1;0<=h;--h){var o=u[h];if(o.calcHitPoint(n,r)&&r.distance<e.distance){s=o;var a=r;r=e,e=a}}return s&&e!==i&&i.copyFrom(e),s},t.WORK_CALCHITPOINT=new $f,t}();!function(t){t[t.NONE=0]="NONE",t[t.DOMAIN=1]="DOMAIN",t[t.RANGE=2]="RANGE",t[t.BOTH=3]="BOTH"}(Uf||(Uf={}));var ec,uc=function(n){function r(t,i){var r=n.call(this,i)||this;return r.po=t,r}return i(r,n),r.prototype.init=function(i){var r=this;n.prototype.init.call(this,i);var u=new Qf((function(){r.Do=!0,r.Oo=!0,e.update(r)}));this.ho=u,this.So=new Gf(this,i&&i.coordinate);var s=new rc(this,i&&i.series);this.Mo=s;var h=new xf(this,i&&i.axis);this.Eo=h,this.Do=!0,this.Oo=!0,this.No=new t.Rectangle,this.zi=new t.Point,this.addChild(u),this.addChild(h.container),this.qs=new Tf(this,(function(){return u}),i&&i.view);var o=s.selection;o&&o.bind(s),this.ln=null,(i&&null!=i.mask?i.mask:this.theme.isOverflowMaskEnabled())&&(this.ho.mask=this.getOrCreateOverflowMask())},r.prototype.getOrCreateOverflowMask=function(){return null==this.ln&&(this.ln=new Of(this),this.addReflowable(this.ln),this.toDirty()),this.ln},Object.defineProperty(r.prototype,"coordinate",{get:function(){return this.So},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"chart",{get:function(){return this.po},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"series",{get:function(){return this.Mo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"container",{get:function(){return this.ho},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"axis",{get:function(){return this.Eo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"view",{get:function(){return this.qs},enumerable:!0,configurable:!0}),r.prototype.onWheel=function(t,i,r){var e=this.qs.onWheel(t,i,r),u=n.prototype.onWheel.call(this,t,i,r);return e||u},r.prototype.onDblClick=function(t,i){var r=this.qs.onDblClick(t,i),e=n.prototype.onDblClick.call(this,t,i);return r||e},r.prototype.onDown=function(t){this.qs.onDown(t),n.prototype.onDown.call(this,t)},r.prototype.render=function(t){if(this.Do){this.Do=!1,this.Eo.update();var i=this.Mo.selection;i&&i.update()}n.prototype.render.call(this,t)},r.prototype.destroy=function(){this.ho.destroy(),this.Mo.destroy(),this.Eo.destroy()},r.prototype.getType=function(){return"DChartPlotArea"},r.prototype.getBoundsInContainer=function(){var t=this.No;if(this.Oo){this.Oo=!1;var n=this.container;n.updateTransform();var i=n.transform.localTransform,r=this.zi;r.set(0,0),i.applyInverse(r,r),t.x=r.x,t.y=r.y,r.set(this.width,this.height),i.applyInverse(r,r),t.width=r.x-t.x,t.height=r.y-t.y}return t},r}(z),sc=function(){function t(t,n,i){this.hi=t,this.oi=n,this.Yt=i}return Object.defineProperty(t.prototype,"from",{get:function(){return this.hi},set:function(t){this.set(t,void 0)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.oi},set:function(t){this.set(void 0,t)},enumerable:!0,configurable:!0}),t.prototype.set=function(t,n){var i=!1;return null!=t&&this.hi!==t&&(fs(this.hi)&&fs(t)||(this.hi=t,i=!0)),null!=n&&this.oi!==n&&(fs(this.oi)&&fs(n)||(this.oi=n,i=!0)),i&&this.Yt(),this},t.prototype.add=function(t,n){var i,r;return fs(t)||(i=fs(this.from)?t:Math.min(this.from,t)),fs(n)||(r=fs(this.to)?n:Math.max(this.to,n)),this.set(i,r)},t.prototype.clear=function(){return this.set(NaN,NaN)},t}(),hc=function(){function t(t,n){this.Bn=t,this.To=n&&null!=n.x?n.x:0,this.jo=n&&null!=n.y?n.y:0,this.Co=NaN,this.ko=NaN,this.yo=NaN,this.Io=NaN}return Object.defineProperty(t.prototype,"x",{get:function(){var t=this.Bn.container;return t?t.plotArea.coordinate.x.get(this.To):null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){var t=this.Bn.container;return t?t.plotArea.coordinate.y.get(this.jo):null},enumerable:!0,configurable:!0}),t.prototype.isDirty=function(t,n){var i=t.id,r=n.id,e=i!==this.Co,u=r!==this.ko;this.Co=i,this.ko=r;var s=t.transform.id,h=n.transform.id,o=s!==this.yo,a=h!==this.Io;return this.yo=s,this.Io=h,e||u||o||a},t.prototype.reset=function(){this.Co=NaN,this.ko=NaN},t.prototype.destroy=function(){this.reset()},t}(),oc=function(t){function n(n){var i=t.call(this)||this;if(i.So=new hc(i,n&&n.coordinate),i.Me=0,i.do=new Wf(NaN,NaN),i.mo=new Wf(NaN,NaN),i.Ao=NaN,i.Nt=v.NONE,i.Tt=v.NONE,n){var r=n.on;if(null!=r)for(var e in r)i.on(e,r[e])}return i}return i(n,t),n.prototype.bind=function(t,n){this.ho=t,this.So.reset(),this.Me=n},n.prototype.unbind=function(){this.ho=void 0},Object.defineProperty(n.prototype,"domain",{get:function(){return this.updateRegion(),this.do},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"range",{get:function(){return this.updateRegion(),this.mo},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"container",{get:function(){return this.ho||null},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"index",{get:function(){return this.Me},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"coordinate",{get:function(){return this.So},enumerable:!0,configurable:!0}),n.prototype.destroy=function(){this.ho=void 0,this.So.destroy()},n.prototype.hitTest=function(t){return!1},n.prototype.calcHitPoint=function(t,n){return!1},n.prototype.setState=function(t,n){var i=this.Tt,r=n?i|t:i&~t;i!==r&&(this.Tt=r,this.updateState())},n.prototype.updateState=function(){var t=this.ho,n=t&&t.plotArea.chart,i=this.Tt,r=n?this.mergeState(i,n.state):i,e=this.Nt;e!==r&&(this.Nt=r,this.onStateChange(r,e))},n.prototype.mergeState=function(t,n){return t|n&v.DISABLED|(n&(v.FOCUSED|v.FOCUSED_IN)?v.FOCUSED_IN:v.NONE)|(n&(v.ACTIVE|v.ACTIVE_IN)?v.ACTIVE_IN:v.NONE)},n.prototype.onStateChange=function(t,n){this.toDirty();var i=this.ho,r=i&&i.plotArea.chart;e.update(r),this.emit("statechange",t,n,this)},n}(t.utils.EventEmitter),ac=function(){function t(t,n,i){this.enable=t,this.color=n,this.alpha=i}return t.from=function(n,i,r){var e=n.fill;return r?new t(null!=r.enable?r.enable:e.enable(i),null!=r.color?r.color:e.color(i),null!=r.alpha?r.alpha:e.alpha(i)):new t(e.enable(i),e.color(i),e.alpha(i))},t}(),fc=function(){function t(t,n,i,r,e,u,s){this.enable=t,this.color=n,this.alpha=i,this.width=r,this.align=e,this.side=u,this.style=s}return t.from=function(n,i,r){var e=n.stroke;return r?new t(null!=r.enable?r.enable:e.enable(i),null!=r.color?r.color:e.color(i),null!=r.alpha?r.alpha:e.alpha(i),null!=r.width?r.width:e.width(i),null!=r.align?r.align:e.align(i),null!=r.side?r.side:e.side(i),yf.from(null!=r.style?r.style:e.style(i))):new t(e.enable(i),e.color(i),e.alpha(i),e.width(i),e.align(i),e.side(i),yf.from(e.style(i)))},t}(),cc=function(n){function r(t){var i=n.call(this,t)||this;return i.xo=null,i.ht=t,i.Yi=t&&t.points||[],i.Ro=0,i.Lo=NaN,i._n=i.toSize(t),i}return i(r,n),r.prototype.toSize=function(t){var n={x:10,y:10},i=t&&t.size;return c(i)?n.x=n.y=i:null!=i&&(null!=i.x&&(n.x=i.x),null!=i.y&&(n.y=i.y)),n},r.prototype.bind=function(t,i){var r=this.xo;if(!r){r=this.xo=this.newLineOfAny();var e=this.ht,u=ac.from(t,i,e&&e.fill);r.fill.copy(u),this.Ht=u;var s=fc.from(t,i,e&&e.stroke);r.stroke.copy(s),this.we=s;var h=this._n;r.points.size.set(h.x,h.y)}r.attach(t.plotArea.container,i),this.Lo=NaN,n.prototype.bind.call(this,t,i)},r.prototype.unbind=function(){var t=this.xo;t&&t.detach(),n.prototype.unbind.call(this)},Object.defineProperty(r.prototype,"shape",{get:function(){return this.xo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"points",{get:function(){return this.Yi},set:function(t){this.Yi=t,this.Ro+=1},enumerable:!0,configurable:!0}),r.prototype.toDirty=function(){this.Ro+=1},r.prototype.update=function(){var t=this.xo;if(t){var n=this.So,i=n.x,r=n.y;if(i&&r){var e=this.Ro,u=e!==this.Lo,s=n.isDirty(i,r);(u||s)&&(this.Lo=e,this.updateLine(t,i,r))}}},r.prototype.updateLine=function(t,n,i){for(var r=t.points.values,u=r.length,s=0,h=this.Yi,o=NaN,a=NaN,f=NaN,c=NaN,l=0,v=h.length;l<v;l+=2){var b=h[l],g=h[l+1];null!=b&&null!=g&&(s<u?(r[s]=b,r[s+1]=g):r.push(b,g),s+=2,o!=o?(o=b,a=b,f=g,c=g):(o=Math.min(o,b),a=Math.max(a,b),f=Math.min(f,g),c=Math.max(c,g)))}r.length!==s&&(r.length=s),n.mapAll(r,0,s,2,0),i.mapAll(r,0,s,2,1),n.transform.mapAll(r,0,s,2,0),i.transform.mapAll(r,0,s,2,1),o!=o&&(o=0,a=0,f=0,c=0),o=n.transform.map(n.map(o)),a=n.transform.map(n.map(a)),f=i.transform.map(i.map(f)),c=i.transform.map(i.map(c));var d=Math.abs(a-o),m=Math.abs(c-f),w=.5*(o+a),p=.5*(f+c);for(l=0,v=r.length;l<v;l+=2)r[l+0]-=w,r[l+1]-=p;t.points.set(r),t.size.set(d,m),t.transform.position.set(w,p),e.update(t)},r.prototype.updateRegion=function(){var t=this.Ro;if(this.Ao!==t){this.Ao=t;var n=this.Yi,i=this.do,r=this.mo;if(i.clear(),r.clear(),null!=n)for(var e=0,u=n.length;e<u;e+=2){var s=n[e];null!=s&&i.add(s,s);var h=n[e+1];null!=h&&r.add(h,h)}}},r.prototype.destroy=function(){var t=this.xo;t&&(this.xo=null,t.detach(),t.destroy()),this.Yi.length=0,this.Ro=0,this.Lo=NaN,n.prototype.destroy.call(this)},r.prototype.hitTest=function(t){var n=this.xo;if(n){var i=r.WORK,e=n.toLocal(t,void 0,i);return null!=n.contains(e)}return!1},r.prototype.calcHitPoint=function(t,n){var i=this.xo;if(i){var e=r.WORK,u=i.toLocal(t,void 0,e);return n.shape=i,i.calcHitPoint(u,null,this.calcHitPointTestRange,this.calcHitPointHitTester,n)}return!1},r.prototype.calcHitPointTestRange=function(t,n,i,r,e,u,s){for(var h=ls(u,t+i,2,0),o=0,a=h-1,f=a<<1;0<=a;a-=1,f-=2)if(u[f]<=t-i){o=a;break}return s[0]=o,s[1]=o!==h?h:Math.min(u.length<<1,h+1),s},r.prototype.calcHitPointHitTester=function(t,n,i,r,e,u,s,h,o){var a=o.shape;if(a.containsPointAbs(t,n,i,r,e,u)){var f=a.transform.position;o.x=o.p0x=o.p1x=f.x+e,o.y=o.p0y=o.p1y=f.y+u,o.t=h,o.index=s;var c=t-e,l=n-u;return o.distance=Math.sqrt(c*c+l*l),!0}return!1},r.WORK=new t.Point,r}(oc),lc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.newLineOfAny=function(){return new Ks},n}(cc),vc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.newLineOfAny=function(){return new oh},n}(cc),bc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.newLineOfAny=function(){return new vh},n}(cc),gc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.newLineOfAny=function(){return new Th},n}(cc),dc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.newLineOfAny=function(){return new Ph},n}(cc),mc=function(n){function r(t){var i=n.call(this,t)||this;return i.xo=null,i.Bo=t&&t.stroke,i.Yi=t&&t.points||[],i.Ro=0,i.Lo=NaN,i}return i(r,n),r.prototype.bind=function(t,i){var r=this.xo;if(!r){var e=this.we=fc.from(t,i,this.Bo);(r=this.xo=new Bu([],[],e.width,e.style)).stroke.copy(e)}r.attach(t.plotArea.container,i),this.Lo=NaN,n.prototype.bind.call(this,t,i)},r.prototype.unbind=function(){var t=this.xo;t&&t.detach(),n.prototype.unbind.call(this)},Object.defineProperty(r.prototype,"shape",{get:function(){return this.xo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"points",{get:function(){return this.Yi},set:function(t){this.Yi=t,this.Ro+=1},enumerable:!0,configurable:!0}),r.prototype.toDirty=function(){this.Ro+=1},r.prototype.update=function(){var t=this.xo;if(t){var n=this.So,i=n.x,r=n.y;if(i&&r){var e=this.Ro,u=e!==this.Lo,s=n.isDirty(i,r);(u||s)&&(this.Lo=e,this.updateLine(t,i,r))}}},r.prototype.updateLine=function(t,n,i){for(var r=t.points.values,u=t.points.segments,s=r.length,h=u.length,o=0,a=0,f=this.Yi,c=NaN,l=NaN,v=NaN,b=NaN,g=0,d=f.length;g<d;g+=2){var m=f[g],w=f[g+1];if(null!=m&&null!=w)o<s?(r[o]=m,r[o+1]=w):r.push(m,w),o+=2,c!=c?(c=m,l=m,v=w,b=w):(c=Math.min(c,m),l=Math.max(l,m),v=Math.min(v,w),b=Math.max(b,w));else{var p=(g>>1)-a;a<h?u[a]=p:u.push(p),a+=1}}r.length!==o&&(r.length=o),u.length!==a&&(u.length=a),n.mapAll(r,0,o,2,0),i.mapAll(r,0,o,2,1),n.transform.mapAll(r,0,o,2,0),i.transform.mapAll(r,0,o,2,1),c!=c&&(c=0,l=0,v=0,b=0),c=n.transform.map(n.map(c)),l=n.transform.map(n.map(l)),v=i.transform.map(i.map(v)),b=i.transform.map(i.map(b));var D=Math.abs(l-c),O=Math.abs(b-v),S=.5*(c+l),M=.5*(v+b);for(g=0,d=r.length;g<d;g+=2)r[g+0]-=S,r[g+1]-=M;t.points.set(r,u),t.size.set(D,O),t.transform.position.set(S,M),e.update(t)},r.prototype.updateRegion=function(){var t=this.Ro;if(this.Ao!==t){this.Ao=t;var n=this.Yi,i=this.do,r=this.mo;if(i.clear(),r.clear(),null!=n)for(var e=0,u=n.length;e<u;e+=2){var s=n[e];null!=s&&i.add(s,s);var h=n[e+1];null!=h&&r.add(h,h)}}},r.prototype.destroy=function(){var t=this.xo;t&&(this.xo=null,t.detach(),t.destroy()),this.Yi.length=0,this.Ro=0,this.Lo=NaN,n.prototype.destroy.call(this)},r.prototype.hitTest=function(t){var n=this.xo;if(n){var i=r.WORK,e=n.toLocal(t,void 0,i);return null!=n.contains(e)}return!1},r.prototype.calcHitPoint=function(t,n){var i=this.xo;if(i){var e=r.WORK,u=i.toLocal(t,void 0,e);return n.shape=i,i.calcHitPoint(u,this.toThreshold,this.calcHitPointTestRange,this.calcHitPointHitTester,n)}return!1},r.prototype.toThreshold=function(t,n){return 1/0},r.prototype.calcHitPointTestRange=function(t,n,i,r,e){var u=ls(r,t,2,0);return e[0]=Math.max(0,u-1),e[1]=u,e},r.prototype.calcHitPointHitTester=function(t,n,i,r,e,u,s,h,o){if(i<=t&&t<e){var a=e-i;if(1e-4<Math.abs(a)){var f=(t-i)/a,c=t,l=r+f*(u-r),v=Math.abs(l-n);if(v<h){var b=o.shape.transform.position,g=b.x,d=b.y;return o.x=g+c,o.y=d+l,o.p0x=g+i,o.p0y=d+r,o.p1x=g+e,o.p1y=d+u,o.t=f,o.index=s,o.distance=v,!0}}}return!1},r.WORK=new t.Point,r}(oc),wc=function(){function t(t,n,i,r){this.xt=0,this.Po=NaN,this._a=t,this._b=n,this._x0=i,this._y0=r}return Object.defineProperty(t.prototype,"a",{get:function(){return this._a},set:function(t){this._a!==t&&(this.xt+=1,this._a=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this._b},set:function(t){this._b!==t&&(this.xt+=1,this._b=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"x0",{get:function(){return this._x0},set:function(t){this._x0!==t&&(this.xt+=1,this._x0=t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y0",{get:function(){return this._y0},set:function(t){this._y0!==t&&(this.xt+=1,this._y0=t)},enumerable:!0,configurable:!0}),t.prototype.toDirty=function(){this.xt+=1},t.prototype.isDirty=function(){return this.xt!==this.Po},t.prototype.toClean=function(){this.Po=this.xt},t.from=function(n){return n?new t(null!=n.a?n.a:1,null!=n.b?n.b:1,null!=n.x0?n.x0:0,null!=n.y0?n.y0:0):new t(1,1,0,0)},t}(),pc=function(n){function r(t){var i=n.call(this,t)||this;return i.xo=null,i.Bo=t&&t.stroke,i.Fo=NaN,i._o=NaN,i.Uo=wc.from(t),i}return i(r,n),r.prototype.bind=function(t,i){var r=this.xo;if(!r){var e=this.we=fc.from(t,i,this.Bo);(r=this.xo=new Bu([],[],e.width,e.style)).stroke.color=e.color,r.stroke.alpha=e.alpha}r.attach(t.plotArea.container,i),this.Uo.toDirty(),this.Fo=NaN,this._o=NaN,n.prototype.bind.call(this,t,i)},r.prototype.unbind=function(){var t=this.xo;t&&t.detach(),n.prototype.unbind.call(this)},Object.defineProperty(r.prototype,"shape",{get:function(){return this.xo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"parameters",{get:function(){return this.Uo},enumerable:!0,configurable:!0}),r.prototype.toDirty=function(){this.Uo.toDirty()},r.prototype.update=function(){var t=this.xo,n=this.ho;if(t&&n){var i=n.plotArea,r=this.So,e=r.x,u=r.y;if(e&&u){var s=i.width,h=i.height,o=this.Uo,a=o.isDirty(),f=r.isDirty(e,u),c=s!==this.Fo||h!==this._o;(a||f||c)&&(o.toClean(),this.Fo=s,this._o=h,this.updateLine(t,e,u,s,h))}}},r.prototype.updateLine=function(t,n,i,r,u){var s=t.points.values,h=t.points.segments,o=this.Uo,a=o.a,f=o.b,c=o.x0,l=o.y0,v=Math.abs(a),b=Math.abs(f),g=NaN,d=NaN,m=NaN,w=NaN;if(b<=v){var p=n.unmap(n.transform.unmap(0)),D=n.unmap(n.transform.unmap(r));if(g=Math.min(p,D),m=Math.max(p,D),1e-5<v){var O=f*(i.unmap(i.transform.unmap(0))-l)/a+c,S=f*(i.unmap(i.transform.unmap(u))-l)/a+c,M=Math.min(O,S),E=Math.max(O,S);g<M&&(g=M),E<m&&(m=E)}d=a*(g-c)+f*l,w=a*(m-c)+f*l}else{var N=i.unmap(i.transform.unmap(0)),T=i.unmap(i.transform.unmap(u));if(d=Math.min(N,T),w=Math.max(N,T),1e-5<b){var j=a*(n.unmap(n.transform.unmap(0))-c)/f+l,C=a*(n.unmap(n.transform.unmap(r))-c)/f+l,k=Math.min(j,C),y=Math.max(j,C);d<k&&(d=k),y<w&&(w=y)}g=f*(d-l)+a*c,m=f*(w-l)+a*c}g=n.transform.map(n.map(g)),d=i.transform.map(i.map(d));var I=.5*(g+(m=n.transform.map(n.map(m)))),A=.5*(d+(w=i.transform.map(i.map(w)))),x=Math.abs(m-g),R=Math.abs(w-d);g-=I,d-=A,m-=I,w-=A,4!==s.length?(s.length=0,s.push(g,d,m,w)):(s[0]=g,s[1]=d,s[2]=m,s[3]=w),0!==h.length&&(h.length=0),t.points.set(s,h),t.size.set(x,R),t.transform.position.set(I,A),e.update(t)},r.prototype.updateRegion=function(){},r.prototype.destroy=function(){var t=this.xo;t&&(this.xo=null,t.detach(),t.destroy()),n.prototype.destroy.call(this)},r.prototype.hitTest=function(t){var n=this.xo;if(n){var i=r.WORK,e=n.toLocal(t,void 0,i);return null!=n.contains(e)}return!1},r.prototype.calcHitPoint=function(t,n){var i=this.xo;if(i){var e=r.WORK,u=i.toLocal(t,void 0,e);return n.shape=i,i.calcHitPoint(u,this.toThreshold,null,this.calcHitPointHitTester,n)}return!1},r.prototype.toThreshold=function(t,n){return 1/0},r.prototype.calcHitPointHitTester=function(t,n,i,r,e,u,s,h,o){if(i<=t&&t<e){var a=e-i;if(1e-4<Math.abs(a)){var f=(t-i)/a,c=t,l=r+f*(u-r),v=Math.abs(l-n);if(v<h){var b=o.shape.transform.position,g=b.x,d=b.y;return o.x=o.p0x=o.p1x=g+c,o.y=o.p0y=o.p1y=d+l,o.t=f,o.index=s,o.distance=v,!0}}}return!1},r.prototype.onStateChange=function(t,i){var r=N.isActive(t);if(r!==N.isActive(i)){var e=this.xo,u=this.we;e&&u&&(e.stroke.width=u.width*(r?2:1))}n.prototype.onStateChange.call(this,t,i)},r.WORK=new t.Point,r}(oc),Dc=function(){function t(t){var n=this.toTheme(t);this.i=n;var i=t&&null!=t.state?t.state:v.HOVERED;this.Nt=i,this.Fe=t&&null!=t.enable?t.enable:n.isEnabled(i),this.zo=t&&t.shape,this.Xt=t&&t.style||this.setStyle}return t.prototype.bind=function(t){if(this.Fe){var n=this.zo=this.zo||this.newShape(this.i);n.attach(t.plotArea.axis.container),n.visible=!1}},t.prototype.unbind=function(){var t=this.zo;t&&t.detach()},t.prototype.newShape=function(t){return t.newShape(this.Nt)},t.prototype.set=function(t,n,i){this.update(t,n);var r=this.zo;r&&this.Xt(r,i)},t.prototype.setStyle=function(t,n){var i=n.shape;i&&(t.stroke.color=i.stroke.color)},t.prototype.unset=function(){var t=this.zo;t&&(t.visible=!1)},t.prototype.toTheme=function(t){var n=t&&t.theme;return o(n)?this.getTheme(n):null!=n?n:this.getTheme(this.getType())},t.prototype.getTheme=function(t){return L.getInstance().get(t)},t}(),Oc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.update=function(t,n){var i=this.zo;if(i){var r=n.x,e=t.plotArea.height;i.transform.position.set(r,.5*e),i.size.set(0,e),i.visible=this.isVisible(t,r)}},n.prototype.isVisible=function(t,n){return 0<=n&&n<=t.plotArea.width},n.prototype.getType=function(){return"DChartSelectionGridlineX"},n}(Dc),Sc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.update=function(t,n){var i=this.zo;if(i){var r=n.y,e=t.plotArea.width;i.transform.position.set(.5*e,r),i.size.set(e,0),i.visible=this.isVisible(t,r)}},n.prototype.isVisible=function(t,n){return 0<=n&&n<=t.plotArea.height},n.prototype.getType=function(){return"DChartSelectionGridlineY"},n}(Dc),Mc=function(){function t(t){this._x=new Oc(t&&t.x),this._y=new Sc(t&&t.y)}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!0,configurable:!0}),t.prototype.bind=function(t){this._x.bind(t),this._y.bind(t)},t.prototype.unbind=function(){this._x.unbind(),this._y.unbind()},t.prototype.set=function(t,n,i){this._x.set(t,n,i),this._y.set(t,n,i)},t.prototype.unset=function(){this._x.unset(),this._y.unset()},t.prototype.update=function(t,n){this._x.update(t,n),this._y.update(t,n)},t}(),Ec=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.update=function(t,n){var i=this.zo;i&&(i.transform.position.copyFrom(n),i.visible=this.isVisible(t,n))},n.prototype.isVisible=function(t,n){var i=n.x,r=n.y,e=t.plotArea;return 0<=i&&i<=e.width&&0<=r&&r<=e.height},n.prototype.getType=function(){return"DChartSelectionMarker"},n}(Dc);!function(t){t[t.PREVIOUS=0]="PREVIOUS",t[t.NEXT=1]="NEXT",t[t.CLOSER=2]="CLOSER",t[t.INTERSECTION=3]="INTERSECTION"}(ec||(ec={}));var Nc,Tc=function(n){function r(i){var r=n.call(this)||this;r.ho=null,r.Mo=null,r.Fe=null==i.enable||i.enable,r.Go=new Mc(i.gridline),r.Ho=new Ec(i.marker),r.Nt=null!=i.state?i.state:v.HOVERED,r.Vo=null,r.Wo=null,r.et=new t.Point,r.k=null!=i.point?i.point:ec.CLOSER,r.Be=new t.Point;var e=i.on;if(e)for(var u in e)r.on(u,e[u]);return r}return i(r,n),r.prototype.bind=function(t){this.Fe&&(this.ho=t,this.Go.bind(t),this.Ho.bind(t))},r.prototype.unbind=function(){this.Ho.unbind(),this.Go.unbind(),this.ho=null,this.Vo=null,this.Wo=null},Object.defineProperty(r.prototype,"series",{get:function(){return this.Mo},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"position",{get:function(){return this.et},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"gridline",{get:function(){return this.Go},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"marker",{get:function(){return this.Ho},enumerable:!0,configurable:!0}),r.prototype.set=function(t,n){var i=this.ho,r=this.Vo=t.coordinate.x,u=this.Wo=t.coordinate.y;if(i&&r&&u){var s=i.plotArea.container.localTransform,h=this.et,o=this.Be;if(n instanceof $f){var a=n.x,f=n.y;switch(this.k){case ec.PREVIOUS:a=n.p0x,f=n.p0y;break;case ec.NEXT:a=n.p1x,f=n.p1y;break;case ec.CLOSER:Math.abs(n.p0x-n.x)<Math.abs(n.p1x-n.x)?(a=n.p0x,f=n.p0y):(a=n.p1x,f=n.p1y)}o.set(a,f),s.apply(o,o),h.set(r.unmap(r.transform.unmap(a)),u.unmap(u.transform.unmap(f)))}else h.copyFrom(n.position),o.set(r.transform.map(r.map(h.x)),u.transform.map(u.map(h.y))),s.apply(o,o);this.Go.set(i,o,t),this.Ho.set(i,o,t),e.update(i.plotArea)}var c=this.Mo;if(c!==t){var l=this.Nt;c&&c.setState(l,!1),this.Mo=t,t.setState(l,!0)}this.emit("change",this)},r.prototype.setStyle=function(t,n){var i=n.shape;i&&(t.stroke.color=i.stroke.color)},r.prototype.unset=function(){var t=this.Mo;t&&(this.Mo=null,this.Vo=null,this.Wo=null,t.setState(this.Nt,!1),this.Go.unset(),this.Ho.unset(),this.emit("change",this))},r.prototype.update=function(){var t=this.ho,n=this.Vo,i=this.Wo;if(t&&n&&i){var r=this.et,e=this.Be;e.set(n.transform.map(n.map(r.x)),i.transform.map(i.map(r.y))),t.plotArea.container.localTransform.apply(e,e),this.Go.update(t,e),this.Ho.update(t,e)}},r}(t.utils.EventEmitter),jc=function(t){function n(n){var i=t.call(this)||this;i.ho=null;var r=n&&null!=n.point?o(n.point)?ec[n.point]:n.point:ec.CLOSER;if(i.Hs=i.newSelected(r,n&&n.selected),i.Yo=i.newHovered(r,n&&n.hovered),n){var e=n.on;if(null!=e)for(var u in e)i.on(u,e[u])}return i.Hr=function(t){i.onMove(t)},i.Xo=function(t){i.onClick(t)},i}return i(n,t),n.prototype.newSelected=function(t,n){return new Tc(this.toSubOptions(t,n,v.ACTIVE))},n.prototype.newHovered=function(t,n){return new Tc(this.toSubOptions(t,n,v.HOVERED))},n.prototype.toSubOptions=function(t,n,i){null==(n=n||{}).point&&(n.point=t),null==n.state&&(n.state=i);var r=n.gridline||{},e=r.x||{};null==e.state&&(e.state=i);var u=r.y||{};null==u.state&&(u.state=i);var s=n.marker||{};return null==s.state&&(s.state=i),n},n.prototype.onClick=function(t){var n=this.ho;if(n&&t.target===n.plotArea){var i=this.Yo,r=i.series,e=this.Hs;r?e.set(r,i):e.unset()}},n.prototype.onMove=function(t){var i=this.ho;if(i){var r=this.Yo;if(t.target===i.plotArea){var e=n.WORK_SELECT,u=i.calcHitPoint(t.data.global,e);u?r.set(u,e):r.unset()}else r.unset()}},n.prototype.bind=function(t){this.ho=t,this.Hs.bind(t),this.Yo.bind(t);var n=t.plotArea;n.on(P.move,this.Hr),P.onClick(n,this.Xo)},n.prototype.unbind=function(){var t=this.ho;this.ho=null,t&&t.plotArea.off(P.move,this.Hr),this.Hs.unbind(),this.Yo.unbind()},Object.defineProperty(n.prototype,"selected",{get:function(){return this.Hs},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"hovered",{get:function(){return this.Yo},enumerable:!0,configurable:!0}),n.prototype.update=function(){this.Hs.update(),this.Yo.update()},n.WORK_SELECT=new $f,n}(t.utils.EventEmitter),Cc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=new uc(this,n&&n.plotArea);this.oo=i,this.addChild(i)},Object.defineProperty(n.prototype,"plotArea",{get:function(){return this.oo},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DChart"},n.prototype.destroy=function(){this._destroyed||(this.oo.destroy(),t.prototype.destroy.call(this))},n}(z),kc=function(){function t(){}return t.prototype.redo=function(){throw new Error("Method not implemented.")},t.prototype.undo=function(){throw new Error("Method not implemented.")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Ro.UNSTORABLE|Ro.CLEAR},t}(),yc=function(){function t(){}return t.prototype.execute=function(){return qo.getDocumentController().delete()},t.prototype.redo=function(){throw new Error("Method not implemented.")},t.prototype.undo=function(){throw new Error("Method not implemented.")},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Ro.UNSTORABLE|Ro.CLEAR},t}(),Ic=function(){function t(t){this.vt=t}return t.prototype.execute=function(){return qo.getDocumentController().saveAs(this.vt)},t.prototype.redo=function(){return!0},t.prototype.undo=function(){return!0},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Ro.UNSTORABLE},t}(),Ac=function(){function t(){}return t.prototype.execute=function(){return qo.getDocumentController().save()},t.prototype.redo=function(){return!0},t.prototype.undo=function(){return!0},t.prototype.destroy=function(){},t.prototype.getFlag=function(){return Ro.UNSTORABLE},t}(),xc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.setState(v.UNFOCUSABLE,!0)},n.prototype.initReflowable=function(){},n.prototype.getType=function(){return"DContent"},n}(z),Rc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),Object.defineProperty(n.prototype,"lon",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"lat",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!0,configurable:!0}),n.prototype.toObject=function(){return{lon:this.x,lat:this.y}},n}(t.ObservablePoint),Lc=function(){function t(t,n,i,r,e,u){this.Ko=t,!0===n||!1===n?(this.ri=n,this.hi=new Rc(t,null,i,r),this.oi=new Rc(t,null,e,u)):null!=n?(this.ri=n.enable,this.hi=new Rc(t,null,n.from.lon,n.from.lat),this.oi=new Rc(t,null,n.to.lon,n.to.lat)):(this.ri=!1,this.hi=new Rc(t,null,-180,85.05112877980659),this.oi=new Rc(t,null,180,-85.05112877980659))}return Object.defineProperty(t.prototype,"enable",{get:function(){return this.ri},set:function(t){this.ri!==t&&(this.ri=t,this.Ko())},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"from",{get:function(){return this.hi},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this.oi},enumerable:!0,configurable:!0}),t.prototype.serialize=function(){return{enable:this.ri,from:this.hi.toObject(),to:this.oi.toObject()}},t}(),Bc=function(){function t(t,n){var i=this;this.ji=t,this.Jo=n&&n.factory,this.qr=new Lc((function(){i.onMappingChange()}),n&&n.mapping)}return t.prototype.init=function(){this.onMappingChange()},t.prototype.onMappingChange=function(){var t=this.Jo;if(t){var n,i=this.qr;i.enable?(n=this.Zo)?n.mapping=i:this.Zo=t(this.ji).fit():(n=this.Zo)&&(this.Zo=void 0,n.destroy())}},Object.defineProperty(t.prototype,"pyramid",{get:function(){return this.Zo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"factory",{get:function(){return this.Jo},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mapping",{get:function(){return this.qr},enumerable:!0,configurable:!0}),t.prototype.serialize=function(){return{mapping:this.qr.serialize()}},t.prototype.destroy=function(){var t=this.Zo;null!=t&&(this.Zo=void 0,t.destroy())},t}(),Pc=function(t){function n(n){var i=t.call(this)||this;return i.name=n,i.interactive=!1,i.reference=0,i}return i(n,t),n.prototype.destroy=function(){if(!this._destroyed){for(var n=this.children,i=n.length-1;0<=i;--i)n[i].destroy();n.length=0,t.prototype.destroy.call(this)}},n.prototype.serialize=function(t,n,i){for(var r=this.children,e=0,u=r.length;e<u;++e){var s=r[e].serialize(n);s[16]=t,i.push(s)}return[this.name||""]},n}(Eo),Fc=function(t){function n(){var n=t.call(this)||this;return n.ph=null,n.interactive=!1,n.interactiveChildren=!1,n}return i(n,t),Object.defineProperty(n.prototype,"active",{get:function(){return this.ph},set:function(t){this.ph!==t&&(null==t||0<=this.children.indexOf(t))&&(this.ph=t,this.emit("change",this))},enumerable:!0,configurable:!0}),n.prototype.create=function(t,n){var i=new Pc(t);return this.attach(i,n),i},n.prototype.attach=function(t,n){this.addChild(t),!0===n&&(this.ph=t),this.emit("change",this),e.update(this)},n.prototype.attachAt=function(t,n,i){this.addChildAt(t,n),!0===i&&(this.ph=t),this.emit("change",this),e.update(this)},n.prototype.detach=function(t,n){var i=this.children,r=i.indexOf(t);0<=r&&(this.ph=n,i.splice(r,1),t.parent=void 0,this.emit("change",this),e.update(this))},n.prototype.delete=function(t,n){var i=this.children,r=i.indexOf(t);return 0<=r&&(i.splice(r,1),t.parent=void 0,this.ph===t&&(!0===n?r<i.length?this.ph=i[r]:0<i.length?this.ph=i[r-1]:this.ph=null:this.ph=null),this.emit("change",this),e.update(this)),r},n.prototype.get=function(t){var n=this.children[t];return null!=n?n:null},n.prototype.clear=function(){var t=this.children;if(0<t.length){for(var n=t.length-1;0<=n;--n){var i=t[n];i.parent=null,i.destroy()}t.length=0,this.emit("change",this),e.update(this)}},n.prototype.destroy=function(){this._destroyed||(this.clear(),t.prototype.destroy.call(this))},n.prototype.size=function(){return this.children.length},n.prototype.serialize=function(t,n){for(var i=[],r=this.children,e=0,u=r.length;e<u;++e){var s=r[e];i.push(s.serialize(e,t,n))}return i},n}(t.Container),_c=function(t){function n(n){var i=t.call(this,n)||this,r=new Fc;return i.Qr=r,i.addChild(r),(i.qo=new Bc(i,n&&n.tile)).init(),i}return i(n,t),Object.defineProperty(n.prototype,"tile",{get:function(){return this.qo},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"layer",{get:function(){return this.Qr},enumerable:!0,configurable:!0}),n.prototype.initialize=function(t){},n.prototype.destroy=function(){this._destroyed||(this.qo.destroy(),this.Qr.destroy(),t.prototype.destroy.call(this))},n.prototype.hitTest=function(t,n){for(var i=this.Qr.children,r=i.length-1;0<=r;--r){var e=i[r].hitTest(t,n);if(null!=e)return e}return null},n.prototype.getType=function(){return"DDiagramCanvasBase"},n}(Cf),Uc=function(n){function r(i){var r=n.call(this,i)||this;r.shadow=r.theme.newShadowWeak();var u=new t.Graphics;u.visible=!1,r.addChildAt(u,r.children.length-1),r.Qo=u;var s=i.snapper;return s.target.on("change",(function(){r.toDirty(),e.update(r)})),r.$o=s,r}return i(r,n),r.prototype.serialize=function(t){var n=new jo,i=[],r=this.background;return{version:1,id:t,name:this.name,width:this.width,height:this.height,background:{color:r.getColor(0),alpha:r.getAlpha(0)},tile:this.qo.serialize(),resources:n.serialize(),layers:this.Qr.serialize(n,i),items:i,snap:this.$o.serialize()}},r.prototype.onReflow=function(){n.prototype.onReflow.call(this);var t=this.Qo,i=this.$o.target;if(i.visible){var r=this.width+.5,e=this.height+.5,u=i.values;t.clear(),t.lineStyle(0,0,0,0),t.beginFill(2000880,.5);for(var s=0,h=u.length;s<h;++s){var o=u[s];o.type===qs.VERTICAL?t.drawRect(o.position,0,1,e):t.drawRect(0,o.position,r,1)}t.endFill(),t.visible=!0}else t.visible=!1},r.prototype.getType=function(){return"DDiagramCanvasEditor"},r}(_c),zc=function(n){function r(i){var r=n.call(this,i)||this;return r.tags={},r.interactives=[],r.actionables=[],r.ids={},r.ta=new t.Point,r.na=new t.Point,r.ia=null,r}return i(r,n),r.prototype.initialize=function(){for(var t=Date.now(),n=this.tags,i=this.interactives,r=this.actionables,e=this.ids,u=this.Qr.children,s=0,h=u.length;s<h;++s)this.initializeShapes(u[s].children,n,i,r,e);for(s=0,h=u.length;s<h;++s)this.updateShapes(u[s].children,t);this.initializeFocus()},r.prototype.initializeFocus=function(){var t=e.getLayer(this);if(t){var n=t.getFocusController(),i=n.findFocusable(this,!1,!0,!0);i&&n.setFocused(i,!0,!0)}},r.prototype.initializeShapes=function(t,n,i,r,e){for(var u=function(u,h){for(var o=t[u],a=o.tag,f=0,c=a.size();f<c;++f){var l=a.get(f);if(l){var v=l.id;if(0<v.length){var b=n[v];null==b&&(b=[],n[v]=b),b.push(l)}}}var g=o.id;if(0<g.length){var d=e[g];null==d?e[g]=[o]:d.push(o)}var m=o.runtime;(o.interactive||0<o.cursor.length||m&&m.interactive)&&i.push(o),m&&0<m.actions.length&&r.push(o);var w=o.shortcut;null!=w&&B.on(s,w,(function(t){o.onShortcut(t)}));var p=o.children;0<p.length&&s.initializeShapes(p,n,i,r,e)},s=this,h=0,o=t.length;h<o;++h)u(h)},r.prototype.updateShapes=function(t,n){for(var i=0,r=t.length;i<r;++i)t[i].update(n)},r.prototype.onShapeMove=function(t){for(var n=t.data.global,i=this.ta,r=this.interactives,u=null,s=r.length-1;0<=s;--s){var h=r[s];if(h.visible&&(h.toLocal(n,void 0,i),h.contains(i))){u=h;break}}var o=e.getLayer(this);if(u){if(0<u.cursor.length&&o&&o.view.style.cursor!==u.cursor&&(o.view.style.cursor=u.cursor),u===(v=this.ia))(l=v.runtime)&&l.onPointerMove(v,t);else{if(this.ia=u,v){var a=v.runtime;a&&a.onPointerOut(v,t);for(var f=v.parent;f instanceof pn&&f!==u;)(b=v.runtime)&&b.onPointerOut(f,t),f=f.parent}(l=u.runtime)&&l.onPointerOver(u,t),o&&(o.view.title=u.title||"");for(var c=u.parent;c instanceof pn;)(b=c.runtime)&&b.onPointerOver(c,t),c=c.parent}return!0}o&&"auto"!==o.view.style.cursor&&(o.view.style.cursor="auto");var l,v=this.ia;if(this.ia=null,v)for((l=v.runtime)&&l.onPointerOut(v,t),f=v.parent;f instanceof pn;){var b;(b=f.runtime)&&b.onPointerOut(f,t),f=f.parent}return o&&(o.view.title=""),!1},r.prototype.onShapeDown=function(t){for(var n=this.interactives,i=t.data.global,r=this.ta,e=n.length-1;0<=e;--e){var u=n[e];if(u.visible&&(u.toLocal(i,void 0,r),u.contains(r))){var s=u.runtime;return s&&s.onPointerDown(u,t),!0}}return!1},r.prototype.onShapeUp=function(t){for(var n=this.interactives,i=t.data.global,r=this.ta,e=n.length-1;0<=e;--e){var u=n[e];if(u.visible&&(u.toLocal(i,void 0,r),u.contains(r))){var s=u.runtime;return s&&s.onPointerUp(u,t),!0}}return!1},r.prototype.onShapeClick=function(t){for(var n=this.interactives,i=t.data.global,r=this.ta,e=n.length-1;0<=e;--e){var u=n[e];if(u.visible&&(u.toLocal(i,void 0,r),u.contains(r))){for(var s=u;;){var h=s.runtime;h&&h.onPointerClick(s,t);var o=s.parent;if(!(o instanceof pn))break;s=o}return!0}}return!1},r.prototype.onShapeDblClick=function(t,n){for(var i=this.interactives,r=P.toGlobal(t,n,this.na),e=this.ta,u=i.length-1;0<=u;--u){var s=i[u];if(s.visible&&(s.toLocal(r,void 0,e),s.contains(e))){for(var h=s;;){var o=h.runtime;o&&o.onPointerDblClick(h,t);var a=h.parent;if(!(a instanceof pn))break;h=a}return!0}}return!1},r.prototype.getType=function(){return"DDiagramCanvas"},r}(_c),Gc=function(){function t(){}return t.toSerialized=function(t){if("data"in t){var n=JSON.parse(t.data);return n.id=t.id,n}return t},t.newLayer=function(t,n){for(var i=t.layers,r=0,e=i.length;r<e;++r)n.create(i[r][0]||"");0<n.size()&&(n.active=n.children[0]);var u=t.resources,s=t.items,h=Re.deserializeAll(s,u);return null!=h?h.then((function(t){for(var i=n.children,r=0,e=t.length;r<e;++r){var u=s[r],h=t[r],o=i[u[16]];null!=o&&h.attach(o)}return t})):Promise.resolve([])},t.applyBackground=function(t,n,i){var r=t.background,u=r&&null!=r.color?r.color:16777215,s=r&&null!=r.alpha?r.alpha:1;if(Sn.IS_EDIT_MODE)n.background.color=u,n.background.alpha=s;else{i.background.color=u;var h=e.getLayer(i);h&&(h.renderer.backgroundColor=u),i.background.alpha=s}},t}(),Hc=function(t){function n(n){var i=t.call(this,n)||this;return i.ra=null,i.ea=n&&n.tile,i}return i(n,t),n.prototype.set=function(t){var n=this.ra;n!==t&&(n&&(this.ra=null,this.onUnset()),this.ra=t,t&&this.onSet(t))},n.prototype.onSet=function(t){var n=this,i=this.newCanvas(t);Gc.newLayer(t,i.layer).then((function(t){n.initialize(t),i.initialize(t),e.update(n)})),Gc.applyBackground(t,i,this),this.canvas=i},n.prototype.initialize=function(t){},n.prototype.onUnset=function(){null!=this.canvas&&(this.canvas=null)},n.prototype.get=function(){return this.ra},Object.defineProperty(n.prototype,"layer",{get:function(){var t=this.canvas;return null!=t?t.layer.active:null},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDiagramBase"},n}(jf),Vc=function(t){function n(n){var i=t.call(this,n)||this;return i.ua=!1,i.sa=n.controller,i.ua=!1,qo.getCommandController().on("dirty",(function(){!0!==i.ua&&(i.ua=!0,i.emit("change",i))})),i.snapper=new Lo(i),i}return i(n,t),n.prototype.newCanvas=function(t){return new Uc({name:t.name,width:t.width,height:t.height,snapper:this.snapper,tile:{factory:this.ea,mapping:t.tile&&t.tile.mapping}})},n.prototype.serialize=function(){var t=this.canvas,n=this.ra;return null!=t&&null!=n?t.serialize(n.id):null},n.prototype.save=function(){var t=this,n=this.serialize();return null==n||this.controller.save({version:n.version,id:n.id,name:n.name,data:JSON.stringify(n)}).then((function(i){t.ua=!1,n.id=i,t.ra=n,t.emit("change",t),t.emit("success","save",t)}),(function(n){t.emit("fail","save",t)}))},n.prototype.saveAs=function(t){var n=this,i=this.serialize();return null==i||(i.id=void 0,i.name=t,this.controller.save({version:i.version,id:i.id,name:i.name,data:JSON.stringify(i)}).then((function(r){n.ua=!1,i.id=r,n.ra=i;var e=n.canvas;null!=e&&(e.name=t),n.emit("change",n),n.emit("success","save-as",n)}),(function(t){n.emit("fail","save-as",n)})))},n.prototype.delete=function(){var t=this,n=this.ra;return null!=n&&(null!=n.id?this.controller.delete(n.id).then((function(){t.set(null),t.emit("success","delete",t)}),(function(n){t.emit("fail","delete",t)})):(this.set(null),this.emit("success","delete",this),!0))},n.prototype.create=function(t,n,i){return this.set({version:1,id:void 0,name:t,width:n,height:i,resources:[],layers:[["Default layer"]],items:[],snap:void 0}),!0},n.prototype.onSet=function(n){t.prototype.onSet.call(this,n);var i=n.snap,r=this.snapper;null!=i?r.deserialize(i):r.reset(),this.ua=!1,this.emit("change",this)},n.prototype.onUnset=function(){t.prototype.onUnset.call(this),this.ua=!1,this.emit("change",this)},n.prototype.open=function(t){var n=this;return this.sa.get(t).then((function(t){n.set(Gc.toSerialized(t)),n.emit("success","open",n)}),(function(t){n.emit("fail","open",n)}))},n.prototype.close=function(){this.set(null)},n.prototype.isChanged=function(){return this.ua||this.isNew()},n.prototype.isNew=function(){var t=this.ra;return null!=t&&null==t.id},n.prototype.getName=function(){var t=this.ra;return null!=t?t.name:null},Object.defineProperty(n.prototype,"controller",{get:function(){return this.sa},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDiagramEditor"},n}(Hc),Wc=function(t){function n(n){var i=t.call(this)||this;return i.ha=n,i.oa=function(){e.update(n)},i}return i(n,t),n.prototype.update=function(){var t=this.ha.canvas;if(t){var n=t.actionables;if(0<n.length){for(var i=-1,r=Date.now(),e=0,u=n.length;e<u;++e){var s=n[e];s.update(r);var h=s.runtime;if(h&&r<h.effect){var o=h.effect;r<o&&(i=i<0?o:Math.min(i,o))}}0<=i&&setTimeout(this.oa,i-Date.now())}}},n.prototype.get=function(t){var n=this.ha.canvas,i=n&&n.ids[t];return i&&0<i.length?i[0]:null},n.prototype.getAll=function(t){var n=this.ha.canvas;return n&&n.ids[t]||[]},n.prototype.each=function(t,n){void 0===n&&(n=!1);var i=this.ha.canvas;if(null!=i){var r=i.layer.children;if(n){for(e=r.length-1;0<=e;--e)for(h=(s=r[e].children).length-1;0<=h;--h)if(!1===t(a=s[h]))return a}else for(var e=0,u=r.length;e<u;++e)for(var s,h=0,o=(s=r[e].children).length;h<o;++h){var a;if(!1===t(a=s[h]))return a}}return null},n}(t.utils.EventEmitter),Yc=function(){function t(t){this.ha=t}return t.prototype.update=function(){},t.prototype.getIds=function(){var t=this.ha.canvas;return null!=t?Object.keys(t.tags):[]},t.prototype.each=function(t){var n=this.ha.canvas;if(null!=n){var i=n.tags;for(var r in i)if(!1===t(r))return r}return null},t.prototype.set=function(t,n,i,r,e){var u=this.ha.canvas;if(null!=u){var s=u.tags[t];if(null!=s)for(var h=0,o=s.length;h<o;++h){var a=s[h];a.range.set(r,e),void 0!==i&&(a.time=i),a.value=n}}},t.prototype.clear=function(t){var n=this.ha.canvas;if(null!=n){var i=n.tags[t];if(null!=i)for(var r=0,e=i.length;r<e;++r)i[r].clear()}},t.prototype.setAll=function(t,n,i,r,e){var u=this.ha.canvas;if(null!=u){var s=u.tags[t];if(null!=s)for(var h=0,o=s.length;h<o;++h){var a=s[h];a.range.set(r,e),void 0!==i&&(a.times=i),a.values=n}}},t.prototype.setValue=function(t,n,i){var r=this.ha.canvas;if(null!=r){var e=r.tags[t];if(null!=e)for(var u=0,s=e.length;u<s;++u){var h=e[u];void 0!==i&&(h.time=i),h.value=n}}},t.prototype.setValues=function(t,n,i){var r=this.ha.canvas;if(null!=r){var e=r.tags[t];if(null!=e)for(var u=0,s=e.length;u<s;++u){var h=e[u];void 0!==i&&(h.times=i),h.values=n}}},t.prototype.setTime=function(t,n){var i=this.ha.canvas;if(null!=i){var r=i.tags[t];if(null!=r)for(var e=0,u=r.length;e<u;++e)r[e].time=n}},t.prototype.setTimes=function(t,n){var i=this.ha.canvas;if(null!=i){var r=i.tags[t];if(null!=r)for(var e=0,u=r.length;e<u;++e)r[e].times=n}},t.prototype.setRange=function(t,n,i){var r=this.ha.canvas;if(null!=r){var e=r.tags[t];if(null!=e)for(var u=0,s=e.length;u<s;++u){var h=e[u].range;void 0!==n&&(null!==n?(h.type|=On.FROM,h.from=n):h.type&=~On.FROM),void 0!==i&&(null!==i?(h.type|=On.TO,h.to=i):h.type&=~On.TO)}}},t}(),Xc=function(t){function n(n){var i=t.call(this,n)||this;return i.on(P.move,(function(t){if(P.contains(i,t.target)){var n=i.canvas;n&&n.onShapeMove(t)}})),i.on(P.up,(function(t){if(P.contains(i,t.target)){var n=i.canvas;n&&n.onShapeUp(t)}})),i.on("click",(function(t){if(P.contains(i,t.target)){var n=i.canvas;n&&n.onShapeClick(t)}})),i.tag=new Yc(i),i.shape=new Wc(i),i}return i(n,t),n.prototype.initialize=function(t){for(var n={},i={},r=new Map,e=0,u=t.length;e<u;++e){for(var s=t[e],h=Co[s.type]||bn,o=s.runtime=new h(s),a=s.tag,f=0,c=a.size();f<c;++f)if(m=a.get(f)){var l=m.format,v=m.initial;if(l in n)m.formatter=n[l];else if(0<l.length)try{var b=Function("value","try {return ("+l+");} catch( e1 ) {try {return ("+(0<v.length?v:0)+");} catch( e2 ) {return 0;}}");n[l]=b,m.formatter=b}catch(t){}if(v in i)m.value=i[v];else if(0<v.length)try{m.value=i[v]=Function("try {return ("+v+");} catch( e ) {return 0;}")()}catch(t){}}var g=s.action.values,d=o.actions;for(f=0,c=g.length;f<c;++f){var m=g[f],w=r.get(m);null==w?null!=(w=m.toRuntime(s))&&(w instanceof Xr&&s.cursor.length<=0&&(s.cursor="pointer"),r.set(m,w),d.push(w),o.reset|=w.reset):(d.push(w),o.reset|=w.reset)}var p=s.children;0<p.length&&this.initialize(p)}},n.prototype.newCanvas=function(t){return new zc({name:t.name,width:t.width,height:t.height,background:{color:null},border:{color:null},tile:{factory:this.ea,mapping:t.tile&&t.tile.mapping}})},n.prototype.onDown=function(n){var i=this.canvas;i&&i.onShapeDown(n)||t.prototype.onDown.call(this,n)},n.prototype.onDblClick=function(n,i){var r=this.canvas;return!(!r||!r.onShapeDblClick(n,i))||t.prototype.onDblClick.call(this,n,i)},n.prototype.render=function(n){this.shape.update(),t.prototype.render.call(this,n)},n.prototype.getType=function(){return"DDiagram"},n}(Hc),Kc=function(t){function n(n){var i=t.call(this,n)||this;return i.setState(v.UNFOCUSABLE,!0),i}return i(n,t),n.prototype.getType=function(){return"DDialogConfirmMessage"},n}($),Jc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onInit=function(n,i){t.prototype.onInit.call(this,n,i);var r=this.toMessage(this.theme,i);this.aa=r,n.addChild(r)},n.prototype.toMessage=function(t,n){if(n&&null!=n.message){var i=n.message;return o(i)||u(i)?this.newMessage(this.toMessageOptions(i)):i instanceof z?i:this.newMessage(this.toMessageOptionsMerged(i,t.getMessage()))}return this.newMessage(this.toMessageOptions(t.getMessage()))},n.prototype.toMessageOptionsMerged=function(t,n){return null==t.text&&(t.text={}),void 0===t.text.value&&(t.text.value=n),t},n.prototype.toMessageOptions=function(t){return{text:{value:t}}},n.prototype.newMessage=function(t){return new Kc(t)},Object.defineProperty(n.prototype,"message",{get:function(){return this.aa},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDialogConfirm"},n}(fa),Zc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DDialogConfirmDelete"},n}(Jc),qc=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DDialogConfirmDiscard"},n}(Jc),Qc=function(t){function n(n){var i=t.call(this,n)||this,r=i.theme,e=new Nt({parent:i,x:"padding",y:"padding",width:"padding",height:"auto"});return i.Kr=new Oa({parent:e,width:"padding",height:"auto",input:{weight:1,on:{enter:function(){i.close(),i.onOk()}}},label:{width:r.getLabelWidth(),text:{value:null!=n&&null!=n.label?n.label:r.getLabel()}},space:{width:r.getLabelWidth()}}),new aa({parent:e,width:"padding",height:"auto",padding:{top:i.padding.getBottom()},children:[new pt({weight:1}),new sa({text:{value:null!=n&&null!=n.ok?n.ok:r.getOk()},on:{active:function(){i.close(),i.onOk()}}}),new ia({text:{value:null!=n&&null!=n.cancel?n.cancel:r.getCancel()},on:{active:function(){i.close(),i.onCancel()}}}),new pt({weight:1})]}),i}return i(n,t),Object.defineProperty(n.prototype,"input",{get:function(){return this.Kr.input},enumerable:!0,configurable:!0}),n.prototype.onOk=function(){this.emit("ok",this.Kr.input.value,this)},n.prototype.onCancel=function(){this.emit("cancel",this)},n.prototype.getType=function(){return"DDialogInputText"},n}(oa),$c=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DDialogMessage"},n}(Jc),tl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DDialogProcessingMessage"},n}(Kc),nl=function(t){function n(n){var i=t.call(this,n)||this;return i.fa=!0,i.mr=0,i.ca=n&&null!=n.interval?n.interval:i.theme.getInterval(),i}return i(n,t),n.prototype.newMessage=function(t){return new tl(t)},n.prototype.onOpen=function(){this.fa=!1,this.mr=Date.now();var n=this.la;null!=n&&clearTimeout(n),this.aa.setStates(v.NONE,v.SUCCEEDED|v.FAILED);var i=this.Iu;null!=i&&i.setDisabled(!0),t.prototype.onOpen.call(this)},n.prototype.onDone=function(){var t=this.Iu;null!=t?t.setDisabled(!1):this.close()},n.prototype.onResolved=function(t){null!=t&&(this.aa.text=t),this.aa.setStates(v.SUCCEEDED,v.FAILED),this.onDone()},n.prototype.onRejected=function(t){null!=t&&(this.aa.text=t),this.aa.setStates(v.FAILED,v.SUCCEEDED),this.onDone()},n.prototype.resolve=function(t){var n=this;if(!this.fa){this.fa=!0;var i=Date.now()-this.mr,r=this.ca-i;0<r?this.la=window.setTimeout((function(){n.la=void 0,n.onResolved(t)}),r):this.onResolved(t)}},n.prototype.reject=function(t){var n=this;if(!this.fa){this.fa=!0;var i=Date.now()-this.mr,r=this.ca-i;0<r?this.la=window.setTimeout((function(){n.la=void 0,n.onRejected(t)}),r):this.onRejected(t)}},n.prototype.onCloseOn=function(){this.fa&&t.prototype.onCloseOn.call(this)},n.prototype.getType=function(){return"DDialogProcessing"},n}(Jc),il=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onOpen=function(){var n=qo.getDocumentController().getName();null!=n&&(this.Kr.input.value=n),t.prototype.onOpen.call(this)},n.prototype.onOk=function(){t.prototype.onOk.call(this);var n=this.Kr.input.value;qo.getCommandController().push(new Ic(n))},n.prototype.getType=function(){return"DDialogSaveAs"},n}(Qc),rl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.getType=function(){return"DDialogSelectListItem"},n}(tt);!function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULTIPLE=2]="MULTIPLE"}(Nc||(Nc={}));var el=function(t){function n(n,i){var r=t.call(this)||this;r.va=n,r.B=!1,r.V=[],r.ba=i&&null!=i.mode?i.mode:Nc.SINGLE;var e=i&&i.on;if(e)for(var u in e)r.on(u,e[u]);return r}return i(n,t),n.prototype.toDirty=function(){this.B=!0},n.prototype.update=function(){if(this.B){this.B=!1;var t=this.V;t.length=0;for(var n=this.va.children,i=0,r=n.length;i<r;++i){var e=n[i];e instanceof z&&e.isActive()&&t.push(i)}}},n.prototype.size=function(){return this.update(),this.V.length},n.prototype.isEmpty=function(){return this.size()<=0},n.prototype.first=function(){return this.get(0)},n.prototype.get=function(t){this.update();var n=this.V;if(0<=t&&t<n.length){var i=this.va.children[n[t]];if(null!=i)return i}return null},n.prototype.getIndex=function(t){this.update();var n=this.V;return 0<=t&&t<n.length?n[t]:null},n.prototype.clear=function(){this.update();var t=this.V;if(0<t.length){for(var n=this.va.children,i=0,r=t.length;i<r;++i){var e=n[t[i]];e instanceof z&&e.setActive(!1)}t.length=0,this.emit("change",this)}},n.prototype.add=function(t){var n=this.ba,i=this.va;if(n===Nc.SINGLE){if(!t.isActive()){this.update();for(var r=this.V,e=i.children,u=0,s=r.length;u<s;++u){var h=e[r[u]];h instanceof z&&h.setActive(!1)}r.length=0,r.push(i.getChildIndex(t)),t.setActive(!0),this.emit("change",this)}}else if(n===Nc.MULTIPLE&&!t.isActive())if(this.B)t.setActive(!0),this.emit("change",this);else{r=this.V;var o=i.getChildIndex(t);for(u=0,s=r.length;u<s;++u){var a=r[u];if(o===a)return void t.setActive(!0);if(o<a)return r.splice(u,0,o),t.setActive(!0),void this.emit("change",this)}r.push(o),t.setActive(!0),this.emit("change",this)}},n.prototype.remove=function(t){if(!t.isActive())if(this.B)t.setActive(!1),this.emit("change",this);else for(var n=this.V,i=this.va.getChildIndex(t),r=0,e=n.length;r<e;++r)if(i===n[r])return n.splice(r,1),t.setActive(!1),void this.emit("change",this)},n}(t.utils.EventEmitter),ul=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.ga=0,this.da=1;var i=this.ma=this.createThumb(null!=n?n.thumb:void 0);this.addChild(i),this.setState(v.UNFOCUSABLE,!0)},Object.defineProperty(n.prototype,"thumb",{get:function(){return this.ma},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DScrollBar"},n.prototype.setRegion=function(t,n,i){i<1?(t=0,n=1):(t=Math.max(0,Math.min(1,t/i)),n=Math.max(t,Math.min(1,n/i))),this.ga===t&&this.da===n||(this.ga=t,this.da=n,this.onRegionChange())},n.prototype.isRegionVisible=function(){return 0<this.ga||this.da<1},n.prototype.onResize=function(n,i,r,e){t.prototype.onResize.call(this,n,i,r,e),this.onRegionChange()},n.prototype.onRegionChange=function(){},n.prototype.getRegionStart=function(){return this.ga},n.prototype.getRegionEnd=function(){return this.da},n}(z),sl=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(i){var r=this;n.prototype.init.call(this,i),this.setState(v.UNFOCUSABLE,!0);var e=new t.Point;this.Th=new Ns({target:this,easing:!1,on:{start:function(){e.copyFrom(r.position)},move:function(t,n){e.set(e.x+t,e.y+n),r.onDragMove(e.x,e.y)}}})},r.prototype.getMinimumSize=function(){return this.theme.getMinimumSize()},r.prototype.getType=function(){return"DScrollBarThumb"},r}(z),hl=function(t){function n(n){var i=t.call(this)||this;return n.appendRenderable(i,!0),n.addReflowable(i),i}return i(n,t),n.prototype.onReflow=function(t,n,i){var r=t.state;this.clear();var e=t.background,u=e.getColor(r),s=e.getAlpha(r);null!=u?(this.beginFill(u,s),this.lineStyle(0,0,0,0),this.drawRect(0,.5*i-1,n,2),this.endFill(),this.visible=!0):this.visible=!1},n}(t.Graphics),ol=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onDragMove=function(t,n){this.emit("regionmove",t,this)},n.prototype.initReflowable=function(){new hl(this)},n}(sl),al=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on(P.down,(function(t){if(t.target===i){var n=i.width;if(0<n){var r=i.da-i.ga,e=t.data.getLocalPosition(i),u=Math.min(1-r,Math.max(0,e.x/n-.5*r));i.ga!==u&&i.emit("regionmove",u,i)}}})),this.ma.on("regionmove",(function(t){var n=i.width;if(0<n){var r=i.da-i.ga,e=Math.min(1-r,Math.max(0,t/n));i.ga!==e&&i.emit("regionmove",e,i)}}))},n.prototype.createThumb=function(t){return new ol(t)},n.prototype.onRegionChange=function(){var n=this.ma,i=this.width,r=this.height,e=Math.min(.5*i,n.getMinimumSize()),u=i-e,s=u*this.ga,h=u*this.da+e-s;n.position.set(s,0),n.resize(h,r),t.prototype.onRegionChange.call(this)},n}(ul),fl=function(t){function n(n){var i=t.call(this)||this;return n.appendRenderable(i,!0),n.addReflowable(i),i}return i(n,t),n.prototype.onReflow=function(t,n,i){var r=t.state;this.clear();var e=t.background,u=e.getColor(r),s=e.getAlpha(r);null!=u?(this.beginFill(u,s),this.lineStyle(0,0,0,0),this.drawRect(.5*n-1,0,2,i),this.endFill(),this.visible=!0):this.visible=!1},n}(t.Graphics),cl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.onDragMove=function(t,n){this.emit("regionmove",n,this)},n.prototype.initReflowable=function(){new fl(this)},n}(sl),ll=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.on(P.down,(function(t){if(t.target===i){var n=i.height;if(0<n){var r=i.da-i.ga,e=t.data.getLocalPosition(i),u=Math.min(1-r,Math.max(0,e.y/n-.5*r));i.ga!==u&&i.emit("regionmove",u,i)}t.stopPropagation()}})),this.ma.on("regionmove",(function(t){var n=i.height;if(0<n){var r=i.da-i.ga,e=Math.min(1-r,Math.max(0,t/n));i.ga!==e&&i.emit("regionmove",e,i)}}))},n.prototype.createThumb=function(t){return new cl(t)},n.prototype.onRegionChange=function(){var n=this.ma,i=this.width,r=this.height,e=Math.min(.5*r,n.getMinimumSize()),u=r-e,s=u*this.ga,h=u*this.da+e-s;n.position.set(0,s),n.resize(i,h),t.prototype.onRegionChange.call(this)},n}(ul),vl=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(t){n.prototype.init.call(this,t),this.ln=null;var i=this.theme,r=this.va=this.toContent(t);(function(t,n){return n&&null!=n.mask?n.mask:t.isOverflowMaskEnabled()})(i,t)&&(this.mask=this.getOrCreateOverflowMask()),this.addChild(r),this.initScrollBar(r,i,t),this.initDrag(r,i,t)},r.prototype.initDrag=function(n,i,r){var e=this,u=r&&r.drag&&null!=r.drag.mode?o(r.drag.mode)?Va[r.drag.mode]:r.drag.mode:i.getDragMode();if(u===Va.ON||u===Va.TOUCH){var s=new t.Point;this.Th=new Ns({target:this,touch:u===Va.TOUCH,on:{start:function(){s.copyFrom(n.position)},move:function(t,i){s.set(s.x+t,s.y+i),n.position.set(e.toContentX(n,s.x),e.toContentY(n,s.y))}}})}},r.prototype.onRegionMoveX=function(t,n){var i=this.Th;null!=i&&i.stop(),t.x=-t.width*n},r.prototype.onRegionMoveY=function(t,n){var i=this.Th;null!=i&&i.stop(),t.y=-t.height*n},r.prototype.initScrollBar=function(t,n,i){var r=this,e=this.wa=new ll(function(t){return t&&t.bar&&t.bar.vertical}(i));e.on("regionmove",(function(n){r.onRegionMoveY(t,n)})),this.addChild(e);var u=this.pa=new al(function(t){return t&&t.bar&&t.bar.horizontal}(i));u.on("regionmove",(function(n){r.onRegionMoveX(t,n)})),this.addChild(u),t.on("move",(function(){r.onContentChanged()})),t.on("resize",(function(){r.onContentChanged()})),this.updateScrollBar()},r.prototype.getType=function(){return"DPane"},Object.defineProperty(r.prototype,"content",{get:function(){return this.va},enumerable:!0,configurable:!0}),r.prototype.toContent=function(t){if(t&&t.content){var n=t.content;return n instanceof z?n:this.newContent(n)}return this.newContent()},r.prototype.newContent=function(t){return new xc(t)},r.prototype.getOrCreateOverflowMask=function(){return null==this.ln&&(this.ln=new Of(this),this.addReflowable(this.ln),this.toDirty()),this.ln},r.prototype.onWheel=function(t,n,i){var r=this.va,e=this.getWheelContentX(r,n.deltaX*n.lowest),u=this.getWheelContentY(r,n.deltaY*n.lowest);if(r.x!==e||r.y!==u){var s=this.Th;return null!=s&&s.stop(),r.position.set(e,u),!0}return!1},r.prototype.getWheelContentX=function(t,n){if(0<n||n<0){var i=this.theme.getWheelSpeed();return this.toContentX(t,t.x-n*i)}return t.x},r.prototype.getWheelContentY=function(t,n){if(0<n||n<0){var i=this.theme.getWheelSpeed();return this.toContentY(t,t.y+n*i)}return t.y},r.prototype.toContentX=function(t,n){return Math.min(0,Math.max(this.width-t.width,n))},r.prototype.toContentY=function(t,n){return Math.min(0,Math.max(this.height-t.height,n))},r.prototype.isRefitable=function(t){return n.prototype.isRefitable.call(this,t)&&!(t instanceof ul)},r.prototype.onResize=function(t,i,r,e){n.prototype.onResize.call(this,t,i,r,e),this.updateScrollBar()},r.prototype.onContentChanged=function(){this.updateScrollBar()},r.prototype.updateScrollBar=function(){var t=this.wa,n=this.pa;null!=t&&null!=n&&(this.updateScrollBarRegions(t,n),this.updateScrollBarVisibilities(t,n),this.updateScrollBarPositions(t,n))},r.prototype.getScrollBarOffsetHorizontalStart=function(t){return.5*t},r.prototype.getScrollBarOffsetHorizontalEnd=function(t){return.5*t},r.prototype.getScrollBarOffsetVerticalStart=function(t){return.5*t},r.prototype.getScrollBarOffsetVerticalEnd=function(t){return.5*t},r.prototype.updateScrollBarPositions=function(t,n){var i=this.width,r=this.height,e=t.width,u=this.getScrollBarOffsetVerticalStart(e),s=this.getScrollBarOffsetVerticalEnd(e);t.position.set(i-e,u),t.height=r-u-s;var h=n.height,o=this.getScrollBarOffsetHorizontalStart(h),a=this.getScrollBarOffsetHorizontalEnd(h);n.position.set(o,r-h),n.width=i-o-a},r.prototype.updateScrollBarRegions=function(t,n){var i=this.va,r=-i.x,e=-i.y;n.setRegion(r,r+this.width,i.width),t.setRegion(e,e+this.height,i.height)},r.prototype.updateScrollBarVisibilities=function(t,n){var i=this.updateScrollBarVisibility(n),r=this.updateScrollBarVisibility(t);if(i||r){var u,s=this.ln;null!=s&&(n.visible||t.visible?(u=this.va).mask!==s&&(u.mask=s):(u=this.va).mask&&(u.mask=null)),e.update(this)}},r.prototype.updateScrollBarVisibility=function(t){var n=t.isRegionVisible();return t.visible!==n&&(t.visible=n,!0)},r.prototype.onChildFocused=function(t){var i=r.WORK_ON_FOCUSED,e=this.content,u=e.x,s=e.y,h=e.width,o=e.height;i.set(0,0),t.toGlobal(i,i,!1),e.toLocal(i,void 0,i,!1);var a=u+Math.min(h,Math.max(0,i.x)),f=s+Math.min(o,Math.max(0,i.y));i.set(t.width,t.height),t.toGlobal(i,i,!0),e.toLocal(i,void 0,i,!0);var c=u+Math.min(h,Math.max(0,i.x)),l=s+Math.min(o,Math.max(0,i.y)),v=this.width,b=null;a<0?c<=v&&(b=u-Math.max(a,c-v),b=Math.max(v-h,Math.min(0,b))):v<c&&(b=u-Math.min(a,c-v),b=Math.max(v-h,Math.min(0,b)));var g=this.height,d=null;f<0?l<=g&&(d=s-Math.max(f,l-g),d=Math.max(g-o,Math.min(0,d))):g<l&&(d=s-Math.min(f,l-g),d=Math.max(g-o,Math.min(0,d))),null!=b?null!=d?e.position.set(b,d):e.position.x=b:null!=d&&(e.position.y=d),n.prototype.onChildFocused.call(this,t)},r.prototype.destroy=function(){var t=this.ln;null!=t&&(this.ln=null,t.destroy()),this.mask=null,n.prototype.destroy.call(this)},r.WORK_ON_FOCUSED=new t.Point,r}(z),bl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=n&&n.selection;this.wo=r instanceof el?r:this.newSelection(r),P.onClick(this,(function(t){var n=i.findItem(t.target);n instanceof z&&n.isActionable()&&i.selection.add(n)}))},n.prototype.newSelection=function(t){return new el(this.va,t)},n.prototype.onChildrenDirty=function(){var n=this.wo;null!=n&&n.toDirty(),t.prototype.onChildrenDirty.call(this)},Object.defineProperty(n.prototype,"selection",{get:function(){return this.wo},enumerable:!0,configurable:!0}),n.prototype.findItem=function(t){for(var n=this.content,i=t;null!=i;){if(i.parent===n)return i;i=i.parent}return null},n.prototype.onRefit=function(){t.prototype.onRefit.call(this),this.updateChildPosition(),this.updateChildVisibility()},n.prototype.updateChildPosition=function(){for(var t=this.content,n=t.children,i=0,r=0,e=n.length;r<e;++r){var u=n[r];u instanceof z&&(u.y=i,i+=u.height)}var s=Math.min(0,-i+this.height);t.y<s&&(t.y=s),t.height=i},n.prototype.updateChildVisibility=function(){for(var t=this.content,n=t.children,i=-t.y,r=i+this.height,e=0,u=n.length;e<u;++e){var s=n[e];if(s instanceof z){var h=s.y;s.visible=i<=h+s.height&&h<=r}}},n.prototype.onContentChanged=function(){t.prototype.onContentChanged.call(this),this.updateChildVisibility()},n.prototype.getType=function(){return"DList"},n}(vl),gl=function(t){function n(n){var i=t.call(this,n)||this;return i.setState(v.UNFOCUSABLE,!0),i}return i(n,t),n.prototype.getType=function(){return"DDialogSelectList"},n}(bl),dl=function(t){function n(n){var i=t.call(this)||this;return i.Da=n,i.xt=0,i.Oa=0,i.Sa=null,i}return i(n,t),n.prototype.create=function(t){var n=this,i=++this.xt;this.Da(t[0]).then((function(t){n.xt===i&&(n.Oa=i,n.Sa=t,n.emit("success",n,t),n.emit("change",n))}),(function(){n.xt===i&&(n.Oa=i,n.Sa=null,n.emit("fail",n),n.emit("change",n))})),this.emit("change",this)},n.prototype.isDone=function(){return this.xt===this.Oa},n.prototype.getResult=function(){return this.Sa},n}(t.utils.EventEmitter),ml=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.visible=!1},n.prototype.getType=function(){return"DNote"},n}(da),wl={toLabel:function(t){return o(t)?t:c(t)?String(t):"name"in t?t.name:"label"in t?t.label:"id"in t?t.id:""}},pl=function(t,n,i){return null!=t?(null==t.parent&&(t.parent=n),null==t.text?t.text={value:i}:null==t.text.value&&(t.text.value=i),t):{parent:n,text:{value:i}}},Dl=function(t){function n(n){var i=t.call(this,n)||this;i.Sn=null;var r=i.theme;i.Ma=function(t){return(null!=t.converter?t.converter.toLabel:null)||wl.toLabel}(n);var e=new Nt({parent:i,x:"padding",y:"padding",width:"padding",height:"auto"});i.Kr=new Da({parent:e,width:"padding"});var u=i.ao=new gl({parent:e,width:"padding",selection:{on:{change:function(t){var n=t.first();if(null!=n){var r=i.Sn=n.value;i.emit("select",r,i),i.close()}}}}}),s=new ml(function(t,n,i){return pl(n.note&&n.note.noItems,i,t.getNoteNoItemsText())}(r,n,u));i.Ea=s;var h=new ml(function(t,n,i){return pl(n.note&&n.note.searching,i,t.getNoteSearchingText())}(r,n,u));i.Na=h;var o=n.controller,a="create"in o.search?o.search:new dl(o.search);i.Da=a,i.Kr.on("input",(function(t){a.create([t])})),a.on("success",(function(t,n){i.onSearched(n)}));var f=new Fs;return a.on("change",(function(){if(a.isDone()){var t=a.getResult();null!=t&&0<t.length?f.hide():f.show(s)}else f.show(h)})),i}return i(n,t),n.prototype.onSearched=function(t){for(var n=this.ao,i=this.Ma,r=n.content,e=r.children,u=e.length,s=t.length,h=Math.min(u,s),o=0,a=h;o<a;++o){var f=e[o],c=t[o];if(f instanceof tt)f.text=i(c),f.value=c;else{r.removeChildAt(o),f.destroy();var l=this.newItem(c,i(c));r.addChildAt(l,o)}}for(o=h,a=s;o<a;++o)c=t[o],l=this.newItem(c,i(c)),r.addChild(l);for(o=u-1;h<=o;--o)e[o].destroy()},n.prototype.newItem=function(t,n){return new rl({value:t,text:{value:n}})},Object.defineProperty(n.prototype,"value",{get:function(){return this.Sn},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDialogSelect"},n.prototype.onOpen=function(){t.prototype.onOpen.call(this),this.ao.selection.clear(),this.Da.create([this.Kr.value])},n.prototype.onClose=function(){t.prototype.onClose.call(this)},n.prototype.destroy=function(){this.Kr.destroy(),this.Ea.destroy(),this.Na.destroy(),this.ao.destroy(),t.prototype.destroy.call(this)},n}(oa),Ol=function(){function t(t){this.Ta=t,this.ja=[]}return t.prototype.indexOf=function(t){return this.ja.indexOf(t)},t.prototype.close=function(t){for(var n=this.ja,i=Math.max(0,t),r=n.length-1;i<=r;--r)n[r].close()},t.prototype.add=function(t){this.ja.push(t)},t.prototype.trim=function(t){this.close(this.indexOf(t)+1)},t.prototype.remove=function(t){var n=this.indexOf(t);0<=n&&(this.close(n+1),this.ja.splice(n,1),0===n&&this.Ta.focus())},t}(),Sl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.ru=function(){i.onPrerender()},null!=n?(this.v=null!=n.align?o(n.align)?bt[n.align]:n.align:bt.BOTTOM,this.Ca=null!=n.fit&&n.fit,this.ka=null!=n.sticky&&n.sticky):(this.v=bt.BOTTOM,this.Ca=!1,this.ka=!1),this.ya=!1,this.Ta=null,this.visible=!1,this.tr=null,this.setState(v.FOCUS_ROOT,!0),ws.apply(this,(function(){i.close()})),this.on("select",(function(){i.close()})),n&&n.items&&ht.newItems(this,n.items,this.ka),this.su=new xs(n)},n.prototype.findItem=function(t){for(var n=this.children,i=0,r=n.length;i<r;++i){var e=n[i];if(e instanceof nt&&e.value===t)return e}return null},n.prototype.getType=function(){return"DMenu"},n.prototype.getContext=function(){return this.tr},n.prototype.getCloseable=function(){return this},n.prototype.open=function(n,i,r){if(this.isHidden()){var e=this.su.pick(this);this.Ta=n;for(var u=this.children,s=0,h=u.length;s<h;++s){var o=u[s];o instanceof z&&o.setState(v.FOCUSED|v.HOVERED,!1)}var a=e.renderer,f=this.ru;if(this.ka?a.on("prerender",f):a.once("prerender",f),this.Ca){var c=n.getBounds();null!=c&&(this.width=c.width)}this.ya=null!=r,r=r||new Ol(n),null!=i&&r.trim(i),r.add(this),this.tr=r,e.stage.addChild(this),this.focus(),t.prototype.show.call(this),this.emit("open",this)}return this},n.prototype.onPrerender=function(){var t=this.Ta;if(t){var n=t.getBounds();if(n){this.Ca&&(this.width=n.width);var i=this.su.picked;if(i){var r=this.theme;vt.attach(this,n,r.getOffsetX(),r.getOffsetY(),i.width,i.height,this.v)}}}},n.prototype.close=function(){if(this.isShown()){var n=this.tr;n&&n.remove(this);var i=this.su.picked;i&&i.renderer.off("prerender",this.ru),this.Ta=null,t.prototype.hide.call(this);var r=this.parent;r&&r.removeChild(this),this.emit("close",this)}return this},n.prototype.onKeyDown=function(n){if(B.isArrowUpKey(n)||B.isArrowDownKey(n)){var i=this.su.picked;if(i){var r=i.getFocusController(),e=r.getFocused();if(null!=e){var u=B.isArrowDownKey(n),s=r.findFocusable(e,!1,e.hasState(v.FOCUS_ROOT)||u,u);null!=s&&r.setFocused(s,!0,!0)}}}return t.prototype.onKeyDown.call(this,n)},n.prototype.containsGlobalPoint=function(t){return!this.ya},n}(Nt);ht.setMenuCreator((function(t){return new Sl(t)}));var Ml,El=function(t){function n(n){var i=t.call(this,n)||this;return i.on("active",(function(){i.start()})),i}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.Cn=this.toMenu(this.theme,n)},n.prototype.toMenu=function(t,n){var i=n&&n.menu;return i instanceof Sl?i:new Sl(this.toMenuOptions(t,i))},n.prototype.toMenuOptions=function(t,n){return null==(n=n||{}).fit&&(n.fit=!0),n},Object.defineProperty(n.prototype,"menu",{get:function(){return this.Cn},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DDropdown"},n.prototype.start=function(){this.Cn.open(this)},n.prototype.close=function(){this.Cn.close()},n}(na),Nl=function(t){function n(n){var i=t.call(this,n)||this;return i.on(P.down,(function(){i.isActionable()&&i.onSelect()})),i}return i(n,t),n.prototype.onSelect=function(){this.emit("select",this)},n.prototype.onKeyDown=function(n){return this.isActionable()&&this.isFocused()&&B.isActivateKey(n)&&this.onSelect(),t.prototype.onKeyDown.call(this,n)},n.prototype.getType=function(){return"DExpandableHeader"},n}($),Tl=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(t){var i=this;n.prototype.init.call(this,t);var r=this.theme,e=this.toHeader(r,t);this.Rn=e,e.on("select",(function(){i.toggle()})),this.addChild(e);var u=this.toBody(r,t);this.Ln=u,this.addChild(u),this.isActive()?this.onActivated():this.onDeactivated()},r.prototype.toHeader=function(n,i){return i&&i.header?i.header instanceof t.DisplayObject?i.header:this.newHeader(n,i.header):this.newHeader(n)},r.prototype.newHeader=function(t,n){return new Nl(n)},r.prototype.toBody=function(t,n){return n.body},r.prototype.open=function(){this.setActive(!0)},r.prototype.close=function(){this.setActive(!1)},r.prototype.toggle=function(){this.setActive(!this.isActive())},r.prototype.onActivated=function(){var t=this.Ln;t instanceof z?t.show():t.visible=!0},r.prototype.onDeactivated=function(){var t=this.Ln;t instanceof z?t.hide():t.visible=!1},r.prototype.onStateChange=function(t,i){n.prototype.onStateChange.call(this,t,i),N.isActive(t)?N.isActive(i)||this.onActivated():N.isActive(i)&&this.onDeactivated()},r.prototype.getType=function(){return"DExpandable"},r}(Nt),jl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.createInput=function(t){return new Ha(t)},n}(wa),Cl=function(){function t(t){void 0===t&&(t=256),this.Ia=t}return t.prototype.getTileSize=function(){return this.Ia},t.prototype.lonLatToMeters=function(n,i){var r=t.CIRCUMFERENCE_HALF;return i.x=n.x*r/180,i.y=Math.log(Math.tan((90+n.y)*Math.PI/360))*r/Math.PI,i},t.prototype.metersToLonLat=function(n,i){var r=t.CIRCUMFERENCE_HALF;return i.x=n.x/r*180,i.y=360*Math.atan(Math.exp(n.y*Math.PI/r))/Math.PI-90,i},t.prototype.pixelsToMeters=function(n,i,r,e){var u=this.toResolution(i,r),s=t.CIRCUMFERENCE_HALF;return e.x=n.x*u-s,e.y=s-n.y*u,e},t.prototype.metersToPixels=function(n,i,r,e){var u=this.toResolution(i,r),s=t.CIRCUMFERENCE_HALF;return e.x=(n.x+s)/u,e.y=(s-n.y)/u,e},t.prototype.pixelsToTile=function(t,n,i){return i.x=Math.ceil(t.x/n)-1,i.y=Math.ceil(t.y/n)-1,i},t.prototype.metersToTile=function(n,i,r){var e=t.CIRCUMFERENCE_HALF,u=1<<i;return r.x=Math.ceil(.5*(n.x/e+1)*u)-1,r.y=Math.ceil(.5*(1-n.y/e)*u)-1,r},t.prototype.lonLatToTile=function(t,n,i){return this.metersToTile(this.lonLatToMeters(t,i),n,i)},t.prototype.lonLatToPixels=function(t,n,i,r){return this.metersToPixels(this.lonLatToMeters(t,r),n,i,r)},t.prototype.pixelsToLonLat=function(t,n,i,r){return this.metersToLonLat(this.pixelsToMeters(t,n,i,r),r)},t.prototype.tileToPixels=function(t,n,i){return i.x=t.x*n,i.y=t.y*n,i},t.prototype.tileToMeters=function(n,i,r){var e=this.toResolutionMeter(i),u=t.CIRCUMFERENCE_HALF;return r.x=n.x*e+u,r.y=u-n.y*e,r},t.prototype.toResolutionMeter=function(n){return 2*t.CIRCUMFERENCE_HALF/(1<<n)},t.prototype.toResolution=function(n,i){return 2*t.CIRCUMFERENCE_HALF/(i<<n)},t.prototype.toTileCount=function(t){return 1<<t},t.prototype.toTileCode=function(t,n,i){return(n<<t)+i},t.CIRCUMFERENCE_HALF=6378137*Math.PI,t}(),kl=function(){function t(){}return Object.defineProperty(t,"DEFAULT",{get:function(){return null==this.Aa&&(this.Aa=new Cl),this.Aa},enumerable:!0,configurable:!0}),t}(),yl=function(){function n(n,i,r,e,u,s){this.tx=i,this.ty=r;var h=new t.Sprite(t.Texture.EMPTY);h.parent=n,h.position.set(e,u),h.scale.set(s,s),this.xa=h}return n.prototype.load=function(n,i){var r=t.Texture.from(n,{resolution:1});this.xa.texture=r,r.valid?i():r.on("update",i)},n.prototype.transform=function(t,n,i){var r=this.xa;r.position.set(t,n),r.scale.set(i,i)},Object.defineProperty(n.prototype,"loaded",{get:function(){return this.xa.texture.valid},enumerable:!0,configurable:!0}),n.prototype.render=function(t){var n=this.xa;n.updateTransform(),n.render(t)},n.prototype.destroy=function(){var n=this.xa,i=n.texture,r=i.baseTexture.resource,e=null;r instanceof t.resources.BaseImageResource&&r.source instanceof HTMLImageElement&&(e=r.source),i.destroy(!0),n.destroy(),e&&(e.src="")},n}(),Il=function(){function n(t,n,i,r,e,u){var s=this;this.Bn=t,this.Ra=n,this.La=u,this.Ba=!1,this.Pa=!0,this.Fa=function(){s.onLoaded()},this.Ua=i,this._lon0=NaN,this._lat0=NaN,this._lon1=NaN,this._lat1=NaN,this.za=new Map,this.Ga=function(t){s.renderTile(t)},this.Ha=NaN,this.Va=NaN,this.Wa=NaN,this.Ya=NaN,this.Xa=function(t,n,i){s.deleteTile(t,n,i)},this.Ka=function(t){s.destroyTile(t)},this.Ja=function(t){t.loaded||(s.Za=!1)},this.qa=e.toTileCount(i),this.Qa=1/this.qa,this.$a=r.scale*this.Qa,this.Ia=e.getTileSize()*r.scale,this.qr=r,this.So=e,this.Za=!0}return n.prototype.newTile=function(t,n,i,r,e){return new yl(this.Bn,t,n,i,r,e)},n.prototype.renderTile=function(t){t.render(this.tf)},Object.defineProperty(n.prototype,"tz",{get:function(){return this.Ua},enumerable:!0,configurable:!0}),n.prototype.render=function(t){this.tf=t,this.za.forEach(this.Ga)},n.prototype.move=function(t,i,r,e){var u=this._lon0,s=this._lat0,h=this._lon1,o=this._lat1;if(u!==t||s!==i||h!==r||o!==e){this._lon0=t,this._lat0=i,this._lon1=r,this._lat1=e;var a=this.Ua,f=this.So,c=n.WORK;c.set(t,i),f.lonLatToTile(c,a,c);var l=c.x,v=c.y;c.set(r,e),f.lonLatToTile(c,a,c);var b=c.x,g=c.y,d=this.qa,m=Math.max(0,l),w=Math.min(d-1,b),p=Math.max(0,v),D=Math.min(d-1,g),O=m-this.Ha,S=w-this.Va,M=p-this.Wa,E=D-this.Ya,N=O!=O||O<0||1<O,T=S!=S||0<S||S<-1,j=M!=M||M<0||1<M,C=E!=E||0<E||E<-1;if(N||T||j||C){N?this.Ha=m:m=this.Ha,T?this.Va=w:w=this.Va,j?this.Wa=p:p=this.Wa,C?this.Ya=D:D=this.Ya,this.za.forEach(this.Xa);var k=m+w>>1,y=p+D>>1,I=Math.max(k-m,w-k),A=Math.max(y-p,D-y),x=Math.max(I,A);this.toOffset(c);var R=c.x,L=c.y;this.Ba=!1,this.Pa=!1,this.loadTile(a,k,y,R,L,c);for(var B=1;B<=x;++B){var P=k-B;m<=P&&this.loadTilesY(a,P,y,B,p,D,R,L,c);var F=k+B;F<=w&&this.loadTilesY(a,F,y,B,p,D,R,L,c);var _=y-B;p<=_&&this.loadTilesX(a,k,B-1,m,w,_,R,L,c);var U=y+B;U<=D&&this.loadTilesX(a,k,B-1,m,w,U,R,L,c)}this.Pa=!0,this.Ba&&this.onLoaded()}}},n.prototype.loadTilesX=function(t,n,i,r,e,u,s,h,o){this.loadTile(t,n,u,s,h,o);for(var a=1;a<=i;++a){var f=n-a;r<=f&&this.loadTile(t,f,u,s,h,o);var c=n+a;c<=e&&this.loadTile(t,c,u,s,h,o)}},n.prototype.loadTilesY=function(t,n,i,r,e,u,s,h,o){this.loadTile(t,n,i,s,h,o);for(var a=1;a<=r;++a){var f=i-a;e<=f&&this.loadTile(t,n,f,s,h,o);var c=i+a;c<=u&&this.loadTile(t,n,c,s,h,o)}},n.prototype.loadTile=function(t,n,i,r,e,u){var s=this.So.toTileCode(t,n,i),h=this.za,o=h.get(s);null==o&&(this.toTilePosition(n,i,r,e,u),o=this.newTile(n,i,u.x,u.y,this.$a),h.set(s,o),o.load(this.Ra(t,n,i),this.Fa),this.Za=!1)},n.prototype.toTilePosition=function(t,n,i,r,e){var u=this.Ia,s=this.Qa;return e.set(t,n),this.So.tileToPixels(e,u,e),e.set(e.x*s+i,e.y*s+r),e},n.prototype.toOffset=function(t){var n=this.Bn,i=this.qr,r=this.Ia;return t.set(-i.x*r+.5*n.width,-i.y*r+.5*n.height),t},n.prototype.deleteTile=function(t,n,i){var r=t.tx,e=t.ty;(r<this.Ha||this.Va<r||e<this.Wa||this.Ya<e)&&(i.delete(n),t.destroy())},n.prototype.destroy=function(){var t=this.za;t.forEach(this.Ka),t.clear()},n.prototype.destroyTile=function(t){t.destroy()},n.prototype.updateLoadingState=function(){this.Za=!0,this.za.forEach(this.Ja)},n.prototype.onLoaded=function(){this.Pa?this.La():this.Ba=!0},Object.defineProperty(n.prototype,"loaded",{get:function(){return this.Za||this.updateLoadingState(),this.Za},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mapping",{get:function(){return this.qr},set:function(t){var i=this,r=this.So,e=t.scale*this.Qa,u=r.getTileSize()*t.scale;this.$a=e,this.Ia=u,this.qr=t;var s=n.WORK;this.toOffset(s);var h=s.x,o=s.y;this.za.forEach((function(t){i.toTilePosition(t.tx,t.ty,h,o,s),t.transform(s.x,s.y,e)}))},enumerable:!0,configurable:!0}),n.WORK=new t.Point,n}(),Al=function(n){function r(t){var i=n.call(this)||this,r=i.ji=t.canvas;i.Ra=t.builder;var e=i.qr=t.mapping,u=i.So=t.coordinate;i.nf=i.toMapping(r,e,u),i._z=NaN,i.Ua=NaN,i.if=t.plane.min,i.rf=t.plane.max,i.ef=[],i.Fa=function(){i.onLoaded()},i.uf=function(){i.sf=void 0,i.fit()},i.hf=t.plane.throttle;var s=i.af=function(){i.fitThrottled()};return r.on("scale",s),r.on("move",s),r.appendRenderable(i,!0),i}return i(r,n),Object.defineProperty(r.prototype,"coordinate",{get:function(){return this.So},enumerable:!0,configurable:!0}),r.prototype.fitThrottled=function(){null==this.sf&&(this.sf=window.setTimeout(this.uf,this.hf))},r.prototype.toMapping=function(t,n,i){var e=r.WORK_LONLAT,u=i.getTileSize();e.set(n.from.lon,n.from.lat),i.lonLatToPixels(e,0,u,e);var s=e.x,h=e.y;e.set(n.to.lon,n.to.lat),i.lonLatToPixels(e,0,u,e);var o=e.x,a=e.y,f=Math.abs(o-s),c=Math.abs(a-h),l=1;return 1e-7<f?l=1e-7<c?Math.max(t.width/f,t.height/c):t.width/f:1e-7<c&&(l=t.height/c),{scale:l,x:.5*(o+s)/u,y:.5*(a+h)/u}},Object.defineProperty(r.prototype,"mapping",{get:function(){return this.qr},set:function(t){var n=this.nf,i=this.toMapping(this.ji,t,this.So);if(1e-7<Math.abs(n.scale-i.scale)||1e-7<Math.abs(n.x-i.x)||1e-7<Math.abs(n.y-i.y)){this.nf=i;for(var r=this.ef,u=0,s=r.length;u<s;++u){var h=r[u];h&&(h.mapping=i)}e.update(this.ji),this.af()}},enumerable:!0,configurable:!0}),r.prototype.newPlane=function(t){return new Il(this.ji,this.Ra,t,this.nf,this.So,this.Fa)},r.prototype.render=function(t){for(var n=this.Ua,i=this.ef,r=0;r<n;++r)null!=(e=i[r])&&e.render(t);for(r=i.length-1;n<r;--r){var e;null!=(e=i[r])&&e.render(t)}var u=i[n];null!=u&&u.render(t)},r.prototype.toTileZ=function(t){return Math.min(this.rf,Math.max(this.if,Math.floor(t)))},r.prototype.updateTransform=function(){},r.prototype.toZ=function(t){return Math.log(this.nf.scale*t)/Math.log(2)},r.prototype.move=function(t,n,i,r,e){var u=this.ef,s=this.toZ(t);if(this._z!==s){this._z=s;var h=this.toTileZ(s);if(this.Ua!==h){this.Ua=h;var o=u[h];null==o&&(o=this.newPlane(h),u[h]=o)}}var a=u[this.Ua];return null!=a&&a.move(n,i,r,e),this},r.prototype.fit=function(){var t=this.ji;if(null!=t){var n=t.parent;if(null!=n){var i=t.scale,e=i.x,u=i.y,s=t.x,h=t.y,o=this.So,a=this.nf,f=o.getTileSize()*a.scale,c=a.x*f-(s/e+.5*t.width),l=c+n.width/e,v=a.y*f-(h/u+.5*t.height),b=v+n.height/u,g=r.WORK_LONLAT;g.set(c,v),o.pixelsToLonLat(g,0,f,g);var d=g.x,m=g.y;g.set(l,b),o.pixelsToLonLat(g,0,f,g);var w=g.x,p=g.y;this.move(e,d,m,w,p)}}return this},r.prototype.destroyPlanesBefore=function(t,n){for(var i=0;i<t;++i){var r=n[i];r&&(r.destroy(),n[i]=void 0)}},r.prototype.destroyPlanesAfter=function(t,n){for(var i=t+1,r=n.length;i<r;++i){var e=n[i];e&&(e.destroy(),n[i]=void 0)}},r.prototype.cleanup=function(){var t=this.Ua,n=this.ef,i=n[t];if(i&&i.loaded)return this.destroyPlanesBefore(t,n),void this.destroyPlanesAfter(t,n);for(var r=t+1,e=n.length;r<e;++r)if((u=n[r])&&u.loaded)return this.destroyPlanesBefore(t,n),void this.destroyPlanesAfter(r,n);for(r=t-1;0<=r;--r){var u;if((u=n[r])&&u.loaded)return void this.destroyPlanesBefore(r,n)}},r.prototype.onLoaded=function(){this.cleanup(),e.update(this.ji)},r.prototype.destroy=function(){for(var t=this.ef,n=0,i=t.length;n<i;++n){var r=t[n];r&&(r.destroy(),t[n]=void 0)}var e=this.ji,u=this.af;return e.off("scale",u),e.off("move",u),e.removeRenderable(this,!0),this},r.WORK_LONLAT=new t.Point,r}(t.utils.EventEmitter),xl=function(t,n,i){return"https://j.tile.openstreetmap.jp/"+t+"/"+n+"/"+i+".png"},Rl=function(){function t(){}return t.toPlaneOptions=function(t){var n=t.plane;return n?{min:null!=n.min?n.min:this.MIN,max:null!=n.max?n.max:this.MAX,throttle:null!=n.throttle?n.throttle:this.THROTTLE}:{min:this.MIN,max:this.MAX,throttle:this.THROTTLE}},t.from=function(t){return new Al({canvas:t.canvas,builder:t.builder||xl,mapping:t.canvas.tile.mapping,coordinate:t.coordinate||kl.DEFAULT,plane:this.toPlaneOptions(t)})},t.MIN=0,t.MAX=18,t.THROTTLE=333,t}(),Ll=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Cn=this.toMenu(this.theme,n),this.Cn.on("select",(function(t,n,r){i.onSelect(t,n,r)}))},n.prototype.toMenu=function(t,n){var i=n&&n.menu;return i instanceof Sl?i:new Sl(this.toMenuOptions(t,i))},n.prototype.newMenu=function(t,n){return new Sl(this.toMenuOptions(t,n))},n.prototype.toMenuOptions=function(t,n){return null==(n=n||{}).fit&&(n.fit=!1),n},n.prototype.close=function(){this.Cn.close()},Object.defineProperty(n.prototype,"menu",{get:function(){return this.Cn},enumerable:!0,configurable:!0}),n.prototype.onSelect=function(t,n,i){var r=this.parent;null!=r&&r.emit("select",t,n,i)},n.prototype.getType=function(){return"DMenuBarItem"},n}(ia),Bl=function(t){function n(n){var i=t.call(this)||this;return i.renderable=!1,i.interactive=!0,i.on(P.down,(function(t){t.target===i&&n.close()})),i.on(P.move,(function(t){if(t.target===i)for(var r=n.children,e=0,u=r.length;e<u;++e){var s=r[e];s instanceof Ll&&s.setHovered(s.containsPoint(t.data.global))}})),i}return i(n,t),n.prototype.containsPoint=function(t){return!0},n}(t.Container),Pl=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return i(r,n),r.prototype.init=function(i){var r=this;if(n.prototype.init.call(this,i),this.setState(v.FOCUS_ROOT,!0),null!=i&&null!=i.items){var e=i.items;ws.apply(this,(function(){r.close()}));for(var u=function(t,n,i){r.onItemStateChange(t,n,i)},s=0,h=e.length;s<h;++s){var o=e[s],a=o instanceof t.DisplayObject?o:new Ll(o);a instanceof Ll&&a.on("statechange",u),this.addChild(a)}}this.on("select",(function(){r.close()})),this.tr=null,this.ff=new Bl(this),this.su=new xs(i)},r.prototype.onItemStateChange=function(t,n,i){var r=this.tr;if(null==r)N.isDisabled(t)||N.isPressed(t)&&i.menu.isHidden()&&(i.setPressed(!1),this.open(i));else if(!N.isDisabled(t)&&N.isHovered(t)&&!N.isHovered(n)){var e=i.menu;e.isHidden()&&e.open(i,this,r)}},r.prototype.getContext=function(){return this.tr},r.prototype.getCloseable=function(){return this},r.prototype.open=function(t){var n=this.tr;null==n&&(this.su.pick(this).stage.addChild(this.ff),(n=this.tr=new Ol(this)).trim(t),n.add(this),t.menu.open(t,this,n))},r.prototype.close=function(){var t=this.tr;if(null!=t){this.tr=null,t.remove(this);var n=this.ff,i=n.parent;i&&i.removeChild(n)}},r.prototype.getType=function(){return"DMenuBar"},r}(aa),Fl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.setState(v.UNFOCUSABLE,!0)},n.prototype.initReflowable=function(){},n.prototype.getType=function(){return"DMenuSidedContent"},n}(aa);!function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.SINGLE_ONCE=2]="SINGLE_ONCE",t[t.DEFAULT=2]="DEFAULT"}(Ml||(Ml={}));var _l,Ul=function(){return!0},zl=function(n){function r(t,i){var r=n.call(this)||this;r.va=t,r.cf=null,r.B=!0,r.ba=i&&null!=i.mode?o(i.mode)?Ml[i.mode]:i.mode:Ml.DEFAULT,r.lf=i&&i.filter||r.getFilterDefault();var e=i&&i.on;if(e)for(var u in e)r.on(u,e[u]);return r}return i(r,n),r.prototype.toDirty=function(){this.B=!0},r.prototype.update=function(){this.B&&(this.B=!1,this.Zt(this.va))},r.prototype.hasMenu=function(t){return t&&t.menu instanceof Sl},r.prototype.Zt=function(n){for(var i=n.children,r=0,e=i.length;r<e;++r){var u=i[r];u instanceof tt&&u.isActive()&&this.vf(u,!1),u instanceof t.Container&&this.Zt(u),this.hasMenu(u)&&this.Zt(u.menu)}},r.prototype.add=function(t){this.update(),this.vf(t,!0)},r.prototype.set=function(t){this.update(),this.vf(t,!0)},r.prototype.get=function(){return this.update(),this.cf},r.prototype.size=function(){return this.cf?1:0},r.prototype.isEmpty=function(){return null==this.cf},r.prototype.remove=function(t){this.update(),this.cf===t&&this.vf(null,!0)},r.prototype.clear=function(){this.update(),this.vf(null,!0)},r.prototype.getFilterDefault=function(){return Ul},r.prototype.vf=function(t,n){var i=this.cf,r=this.ba;r!==Ml.NONE&&this.lf(t)&&i!==t&&(this.setState(i,r,!1),this.cf=t,this.setState(t,r,!0),n&&this.emit("change",this))},r.prototype.setState=function(t,n,i){t&&(n===Ml.SINGLE?t.setState(v.ACTIVE,i):t.setState(v.ACTIVE|v.READ_ONLY,i))},r}(t.utils.EventEmitter),Gl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=new Ol(this);this.tr=i,i.add(this);var r=n&&n.items;if(null!=r){var e=!(!n||null==n.sticky)&&n.sticky;this.newItems(r,e)}var u=n&&n.selection;this.wo=u instanceof zl?u:this.newSelection(u)},n.prototype.newSelection=function(t){return new zl(this.va,t)},n.prototype.onChildrenDirty=function(){var n=this.wo;null!=n&&n.toDirty(),t.prototype.onChildrenDirty.call(this)},n.prototype.newItems=function(t,n){Gt.newItems(this.content,t,n)},n.prototype.newContent=function(t){return new Fl(t)},Object.defineProperty(n.prototype,"selection",{get:function(){return this.wo},enumerable:!0,configurable:!0}),n.prototype.getContext=function(){return this.tr},n.prototype.getCloseable=function(){return this},n.prototype.open=function(){},n.prototype.close=function(){},n.prototype.getType=function(){return"DMenuSided"},n}(vl),Hl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(z),Vl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(z),Wl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(z),Yl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(z),Xl=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.Sn=null,this.bf=function(t,n){i.onSelected(t,n,!0)},this.gf=function(){i.onClosed()},null!=n&&void 0!==n.value&&(this.value=n.value)},n.prototype.onSelected=function(t,n,i){if(this.Sn!==t){var r=this.Sn;if(this.Sn=t,null!=n)this.text=n.text||"";else{var e=this.ht;this.text=e&&e.text&&e.text.value||this.theme.newTextValue()}i&&this.emit("change",t,r,n,this)}},n.prototype.onClosed=function(){var t=this.Cn;t.off("select",this.bf),t.off("close",this.gf)},n.prototype.start=function(){var n=this.Cn;n.on("select",this.bf),n.on("close",this.gf),t.prototype.start.call(this)},n.prototype.findMenuItem=function(t,n){for(var i=this.Cn.children,r=0,e=i.length;r<e;++r){var u=i[r];if(u instanceof gt){var s=this.findMenuItem(u.menu,n);if(null!=s)return s}else if(u instanceof nt&&u.value===n)return u}return null},Object.defineProperty(n.prototype,"value",{get:function(){return this.Sn},set:function(t){var n=this.findMenuItem(this.Cn,t);null!=n?this.onSelected(t,n,!1):this.onSelected(null,null,!1)},enumerable:!0,configurable:!0}),n.prototype.getType=function(){return"DSelect"},n}(El),Kl=function(t){function n(n,i,r,e,u){var s=t.call(this,n,i,r,i,r)||this;return s.df=e,s.mf=u,s.interactive=!1,s.interactiveChildren=!1,n.on("update",(function(){s.onTextureUpdate()})),s}return i(n,t),n.prototype.onTextureUpdate=function(){this.emit("update",this)},n.prototype.onReflow=function(t,n,i){this.x=-this.leftWidth+this.df,this.y=-this.topHeight+this.mf,this.width=this.leftWidth+n+this.rightWidth,this.height=this.topHeight+i+this.bottomHeight},n}(t.NineSlicePlane),Jl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(z),Zl=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(z),ql=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.wf=n.column.index,this.pf=n.column.data,this.on("active",(function(){i.emit("cellchange",!0,!1,i.wf,i.pf)})),this.on("inactive",(function(){i.emit("cellchange",!1,!0,i.wf,i.pf)}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t){this.setActive(!!t)},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellCheck"},n}(ea),Ql=function(t){return{color:t.color,alpha:t.alpha}},$l=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.wf=n.column.index,this.pf=n.column.data,this.on("select",(function(t,n){i.emit("cellchange",Ql(t),Ql(n),i.wf,i.pf)}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t){var n=this.Sn;if(c(t))n.color=t,n.alpha=1;else if(o(t)){var i=Number(t);n.color=i==i?i:16777215,n.alpha=1}else null!=t?(function(t){return"color"in t}(t)?n.color=Number(t.color):n.color=16777215,function(t){return"alpha"in t}(t)?n.alpha=Number(t.alpha):n.alpha=1):(n.color=16777215,n.alpha=1)},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellColor"},n}(La),tv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.wf=n.column.index,this.pf=n.column.data},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t,n){this.text=n},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellIndex"},n}(Q),nv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.wf=n.column.index,this.pf=n.column.data,this.on("change",(function(t,n){i.emit("cellchange",t,n,i.wf,i.pf)}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t){this.text=Number(t)},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellInputInteger"},n}(Ha),iv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.wf=n.column.index,this.pf=n.column.data,this.on("change",(function(t,n){i.emit("cellchange",t,n,i.wf,i.pf)}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t){this.text=Number(t)},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellInputReal"},n}(ga),rv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.wf=n.column.index,this.pf=n.column.data,this.on("change",(function(t,n){i.emit("cellchange",t,n,i.wf,i.pf)}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t){this.text=String(t)},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellInputText"},n}(Da),ev=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=n.column;this.wf=r.index,this.pf=r.data;var e=r.data.selecting,u=e.dialog;if(null!=u){var s=e.getter,h=function(t){var n=s(t),r=i.text;n!==r&&(i.text=n,i.emit("cellchange",n,r,i.wf,i.pf))},o=function(){u.off("select",h),u.off("close",o)};this.on("active",(function(){u.on("select",h),u.on("close",o),u.open()}))}},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},Object.defineProperty(n.prototype,"value",{get:function(){return this.text},set:function(t){this.text=t},enumerable:!0,configurable:!0}),n.prototype.set=function(t,n,i,r){r?(this.in=t,this.rn=t,this.onTextChange(),this.createOrUpdateText()):this.text=t},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellSelectDialog"},n}(ia),uv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=n.column;this.wf=r.index,this.pf=r.data;var e=r.data.selecting,u=e.fetcher;if(null!=u){var s=e.getter,h=function(t){var n=s(t),r=i.text;n!==r&&(i.text=n,i.emit("cellchange",n,r,i.wf,i.pf))};this.on("active",(function(){u().then(h)}))}},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},Object.defineProperty(n.prototype,"value",{get:function(){return this.rn},set:function(t){this.text=t},enumerable:!0,configurable:!0}),n.prototype.set=function(t,n,i,r){r?(this.in=t,this.rn=t,this.onTextChange(),this.createOrUpdateText()):this.text=t},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellSelectFetcher"},n}(ia),sv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n);var r=n.column;this.wf=r.index,this.pf=r.data;var e=r.data.selecting.getter;this.on("change",(function(t,n){var r=e(t),u=e(n);i.emit("cellchange",r,u,i.wf,i.pf)}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t){this.value=t},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellSelectMenu"},n}(Xl),hv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n),this.wf=n.column.index,this.pf=n.column.data},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.set=function(t){this.text=t},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellText"},n}(Q),ov=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;t.prototype.init.call(this,n),this.ih=n.dialog,this.wf=n.column.index,this.pf=n.column.data,this.on("active",(function(){var t=i.rn.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.page=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.text=new Date(t.getTime()),i.emit("cellchange",t,r,i.wf,i.pf)}))}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(t=null!=this.ih?new tf(this.ih):nf.getInstance(),this.rh=t),t},enumerable:!0,configurable:!0}),n.prototype.set=function(t,n,i,r){if(t instanceof Date)r?(this.in=t,this.rn=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;else if(c(t)){var e=this.rn;e.getTime()!==t&&(e.setTime(t),this.onTextChange(),this.createOrUpdateText())}},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellDate"},n}(ia),av=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;this.ih=n.dialog,this.dh=of.toMask(n&&n.dialog&&n.dialog.picker),this.wf=n.column.index,this.pf=n.column.data,t.prototype.init.call(this,n),this.on("active",(function(){var t=i.rn.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.page=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.text=new Date(t.getTime()),i.emit("cellchange",t,r,i.wf,i.pf)}))}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.getDatetimeMask=function(){return this.dh},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(t=null!=this.ih?new ef(this.ih):uf.getInstance(),this.rh=t),t},enumerable:!0,configurable:!0}),n.prototype.set=function(t,n,i,r){if(t instanceof Date)r?(this.in=t,this.rn=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;else if(c(t)){var e=this.rn;e.getTime()!==t&&(e.setTime(t),this.onTextChange(),this.createOrUpdateText())}},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellDatetime"},n}(ia),fv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=this;this.ih=n.dialog,this.dh=hf.toMask(n.dialog&&n.dialog.picker),this.wf=n.column.index,this.pf=n.column.data,t.prototype.init.call(this,n),this.on("active",(function(){var t=i.rn.getTime(),n=i.dialog;n.current=new Date(t),n.new=new Date(t),n.open().then((function(){var t=n.new,r=n.current;i.text=new Date(t.getTime()),i.emit("cellchange",t,r,i.wf,i.pf)}))}))},n.prototype.mergeState=function(n,i){return t.prototype.mergeState.call(this,n,i)|(i&v.HOVERED?v.HOVERED:v.NONE)},n.prototype.getDatetimeMask=function(){return this.dh},Object.defineProperty(n.prototype,"dialog",{get:function(){var t=this.rh;return null==t&&(null!=this.ih?t=new mf(this.ih):(null==n.DIALOG&&(n.DIALOG=new mf),t=n.DIALOG),this.rh=t),t},enumerable:!0,configurable:!0}),n.prototype.set=function(t,n,i,r){if(t instanceof Date)r?(this.in=t,this.rn=t,this.onTextChange(),this.createOrUpdateText()):this.text=t;else if(c(t)){var e=this.rn;e.getTime()!==t&&(e.setTime(t),this.onTextChange(),this.createOrUpdateText())}},n.prototype.unset=function(){},n.prototype.getType=function(){return"DTableBodyCellTime"},n}(ia);!function(t){t[t.INDEX=0]="INDEX",t[t.TEXT=1]="TEXT",t[t.INTEGER=2]="INTEGER",t[t.REAL=3]="REAL",t[t.CHECK=4]="CHECK",t[t.COLOR=5]="COLOR",t[t.BUTTON=6]="BUTTON",t[t.SELECT=7]="SELECT",t[t.DATE=8]="DATE",t[t.DATETIME=9]="DATETIME",t[t.TIME=10]="TIME"}(_l||(_l={}));var cv,lv={EVEN:v.CUSTOM<<0,START:v.CUSTOM<<1,END:v.CUSTOM<<2,FROZEN:v.CUSTOM<<3,FROZEN_END:v.CUSTOM<<4},vv={EVEN:v.CUSTOM<<0},bv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n);var i=!!n.even;i&&this.setState(vv.EVEN,!0);for(var r=this.Df=n.frozen,e=this.Of=n.columns||[],u=this.toIndexEnd(e),s=e.length-1;0<=s;--s){var h=this.newCell(e[s],s,e,n),o=this.toCellState(i,s,u,r);o&&h.setState(o,!0),this.addChild(h)}},n.prototype.toCellState=function(t,n,i,r){return(t?lv.EVEN:v.NONE)|(0===n?lv.START:v.NONE)|(n===i?lv.END:v.NONE)|(n<r?lv.FROZEN:v.NONE)|(n===r-1?lv.FROZEN_END:v.NONE)},n.prototype.toIndexEnd=function(t){for(var n=t.length,i=0;i<n;++i)if(void 0!==t[i].weight)return n-1;return n},n.prototype.onRefit=function(){t.prototype.onRefit.call(this),this.resetFrozenCellPosition()},n.prototype.updateFrozenCellPosition=function(t){for(var n=this.Of,i=this.children,r=this.Df,e=0;e<r;++e){var u=n[e];i[i.length-1-e].position.x=-t+u.offset}},n.prototype.resetFrozenCellPosition=function(){for(var t=this.Of,n=this.children,i=this.Df,r=this.getContentPositionX(),e=0;e<i;++e){var u=t[e],s=n[n.length-1-e];u.offset=s.position.x,s.position.x=-r+u.offset}},n.prototype.getClippingRect=function(n,i){t.prototype.getClippingRect.call(this,n,i);var r=this.Df;if(0<r&&n.parent===this){var e=this.children,u=e.indexOf(n);if(0<=u&&r<=e.length-1-u){var s=e[u+1],h=s.position.x+s.width;i.x+=h,i.width-=h}}},n.prototype.getType=function(){return"DTableRow"},n}(aa),gv=function(t){return null!=t&&"set"in t},dv=function(t){function n(n){var i=t.call(this,n)||this;return i.Sf=void 0,i}return i(n,t),n.prototype.init=function(n){var i=this;this.Mf=function(t,n,r,e){var u=i.Sf;null!=u&&(e.setter(u,r,t),i.emit("change",t,n,r,i))},t.prototype.init.call(this,n)},n.prototype.newCell=function(t,n,i,r){var e,u=this.toCellOptions(t,n,r);return t.editing.enable?((e=this.newCellEditable(t,n,u)).on("cellchange",this.Mf),e):((e=this.newCellUnediable(t,n,u)).setReadOnly(!0),e)},n.prototype.newCellEditable=function(t,n,i){switch(t.type){case _l.INDEX:return new tv(i);case _l.TEXT:return new rv(i);case _l.INTEGER:return new nv(i);case _l.REAL:return new iv(i);case _l.CHECK:return new ql(i);case _l.COLOR:return new $l(i);case _l.BUTTON:return new hv(i);case _l.SELECT:var r=t.selecting;return null!=r.menu?new sv(i):null!=r.dialog?new ev(i):null!=r.fetcher?new uv(i):new hv(i);case _l.DATE:return new ov(i);case _l.DATETIME:return new av(i);case _l.TIME:return new fv(i);default:return new hv(i)}},n.prototype.newCellUnediable=function(t,n,i){switch(t.type){case _l.INDEX:return new tv(i);case _l.TEXT:case _l.INTEGER:case _l.REAL:return new hv(i);case _l.CHECK:return new ql(i);case _l.COLOR:return new $l(i);case _l.BUTTON:return new hv(i);case _l.SELECT:var r=t.selecting;return null!=r.menu?new sv(i):null!=r.dialog?new ev(i):null!=r.fetcher?new uv(i):new hv(i);case _l.DATE:return new ov(i);case _l.DATETIME:return new av(i);case _l.TIME:return new fv(i);default:return new hv(i)}},n.prototype.toCellOptions=function(t,n,i){var r=t.body||i.cell;if(null!=r){r.weight=t.weight,r.width=t.width;var e=r.text=r.text||{};(e.align=e.align||{}).horizontal=t.align,e.formatter=t.formatter,r.column={index:n,data:t},t.selecting.menu&&(r.menu=t.selecting.menu)}else r={weight:t.weight,width:t.width,text:{formatter:t.formatter,align:{horizontal:t.align}},column:{index:n,data:t},menu:t.selecting.menu};if(t.editing.enable){var u=r.editing=r.editing||{};u.formatter=u.formatter||t.editing.formatter,u.unformatter=u.unformatter||t.editing.unformatter,u.validator=u.validator||t.editing.validator}return r},n.prototype.getType=function(){return"DTableBodyRow"},n.prototype.set=function(t,n,i){if(i||this.Sf!==t){this.Sf=t;for(var r=this.children,e=r.length,u=this.Of,s=u.length,h=0,o=Math.min(s,e);h<o;++h){var a=r[h],f=s-h-1,c=u[f];gv(a)&&a.set(c.getter(t,f),n,f,i)}this.emit("set",t,n,this)}},n.prototype.unset=function(){if(void 0!==this.Sf){this.Sf=void 0;for(var t=this.children,n=0,i=t.length;n<i;++n){var r=t[n];gv(r)&&r.unset()}this.emit("unset",this)}},n.prototype.getContentPositionX=function(){var t=this.parent;if(t){var n=t.parent;if(n)return n.position.x}return 0},n}(bv),mv=function(t){function n(n){var i=t.call(this)||this;return i.Bn=n,i.lf=null,i.Ef=null,i.B=!1,i}return i(n,t),n.prototype.apply=function(){this.B=!0,this.Bn.update()},n.prototype.unapply=function(){null!=this.Ef&&(this.B=!1,this.Ef=null,this.emit("change",this),this.Bn.update())},n.prototype.isApplied=function(){return null!=this.Ef},n.prototype.newFiltered=function(){var t=this.lf;if(null!=t){var n=[],i=this.Bn;return u(t)?i.each((function(i,r){t(i,r)&&n.push(r)})):i.each((function(i,r){t.test(i,r)&&n.push(r)})),n}return null},n.prototype.get=function(){return this.lf},n.prototype.set=function(t){this.lf!==t&&(this.lf=t)},n.prototype.toDirty=function(){this.B=!0},n.prototype.update=function(){this.B&&(this.B=!1,this.Ef=this.newFiltered(),this.emit("change",this))},n.prototype.clear=function(){var t=this.Ef;null!=t&&0<t.length&&(t.length=0,this.Bn.update())},Object.defineProperty(n.prototype,"indices",{get:function(){return this.update(),this.Ef},enumerable:!0,configurable:!0}),n}(t.utils.EventEmitter),wv=function(){function t(t){this.Bn=t}return t.prototype.unmap=function(t){var n=t,i=this.Bn,r=i.sorter.indices;r&&(n=r[n]);var e=i.filter.indices;return e&&(n=e[n]),n},t.prototype.size=function(){var t=this.Bn,n=t.filter.indices;return null!=n?n.length:t.size()},t.prototype.get=function(t){return this.Bn.get(this.unmap(t))},t.prototype.each=function(t,n,i){var r=this.Bn,e=r.rows,u=r.filter.indices,s=r.sorter.indices;if(n=null!=n?Math.max(0,n):0,u){var h=u.length;if(i=null!=i?Math.min(h,i):h,s)for(var o=n;o<i&&!1!==t(e[a=u[s[o]]],o,a);++o);else for(o=n;o<i&&!1!==t(e[a=u[o]],o,a);++o);}else if(h=e.length,i=null!=i?Math.min(h,i):h,s)for(o=n;o<i;++o){var a;if(!1===t(e[a=s[o]],o,a))break}else for(o=n;o<i&&!1!==t(e[o],o,o);++o);},t}();!function(t){t[t.NONE=0]="NONE",t[t.SINGLE=1]="SINGLE",t[t.MULTIPLE=2]="MULTIPLE"}(cv||(cv={}));var pv,Dv=function(t,n){return t[0]-n[0]},Ov=function(t){function n(n,i){var r=t.call(this)||this;return r.Bn=n,r.si=r.toType(i),r.V=new Set,r}return i(n,t),n.prototype.toType=function(t){return t&&null!=t.type?o(t.type)?cv[t.type]:t.type:cv.NONE},Object.defineProperty(n.prototype,"type",{get:function(){return this.si},enumerable:!0,configurable:!0}),n.prototype.onChange=function(){this.Bn.update(),this.emit("change",this)},n.prototype.toggle=function(t){var n=this.V;n.has(t)?n.delete(t):n.add(t),this.onChange()},n.prototype.add=function(t){var n=this.V,i=n.size;n.add(t),i!==n.size&&this.onChange()},n.prototype.getFirstIndex=function(){var t=this.V;if(0<t.size){var n=NaN;return t.forEach((function(t){n!=n&&(n=t)})),n}return null},n.prototype.getLastIndex=function(){var t=this.V;if(0<t.size){var n=0;return t.forEach((function(t){n=t})),n}return null},n.prototype.addTo=function(t){var n=this.getLastIndex();null!=n&&this.addRange(n,!1,t,!0)},n.prototype.addRange=function(t,n,i,r){var e=this.V,u=e.size;if(t<i)for(var s=t+(n?0:1),h=i+(r?1:0);s<h;++s)e.add(s);else for(s=i+(r?0:1),h=t+(n?1:0);s<h;++s)e.add(s);u!==e.size&&this.onChange()},n.prototype.addAll=function(t){for(var n=this.V,i=n.size,r=0,e=t.length;r<e;++r)n.add(t[r]);i!==n.size&&this.onChange()},n.prototype.contains=function(t){return this.V.has(t)},n.prototype.remove=function(t){this.V.delete(t)&&this.onChange()},n.prototype.clear=function(){var t=this.V;0<t.size&&(t.clear(),this.onChange())},n.prototype.clearAndAdd=function(t){var n=this.V;n.has(t)&&1===n.size||(n.clear(),n.add(t),this.onChange())},n.prototype.clearAndAddAll=function(t){var n=this.V;if(0<n.size||0<t.length){n.clear();for(var i=0,r=t.length;i<r;++i)n.add(t[i]);this.onChange()}},n.prototype.shift=function(t,n){var i=[],r=this.V;if(r.forEach((function(n){t<=n&&i.push(n)})),0<i.length){for(var e=0,u=i.length;e<u;++e)r.delete(i[e]);for(e=0,u=i.length;e<u;++e)r.add(i[e]+n);this.onChange()}},n.prototype.size=function(){return this.V.size},n.prototype.isEmpty=function(){return 0===this.V.size},Object.defineProperty(n.prototype,"indices",{get:function(){var t=[];return this.V.forEach((function(n){t.push(n)})),t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){var t=[],n=this.Bn;return this.V.forEach((function(i){t.push(n.get(i))})),t},enumerable:!0,configurable:!0}),n.prototype.toArray=function(){var t=[],n=this.Bn;return this.V.forEach((function(i){t.push([i,n.get(i)])})),t},n.prototype.toSortedArray=function(){return this.toArray().sort(Dv)},n.prototype.toObject=function(){var t={},n=this.Bn;return this.V.forEach((function(i){t[i]=n.get(i)})),t},n.prototype.toMap=function(){var t=new Map,n=this.Bn;return this.V.forEach((function(i){t.set(i,n.get(i))})),t},n}(t.utils.EventEmitter);!function(t){t[t.ASCENDING=0]="ASCENDING",t[t.DESCENDING=1]="DESCENDING"}(pv||(pv={}));var Sv=function(t){function n(n){var i=t.call(this)||this;return i.Bn=n,i.Nf=null,i.Tf=null,i.B=!1,i.li=pv.ASCENDING,i}return i(n,t),Object.defineProperty(n.prototype,"order",{get:function(){return this.li},set:function(t){this.li=t},enumerable:!0,configurable:!0}),n.prototype.apply=function(){this.B=!0,this.Bn.update()},n.prototype.unapply=function(){null!=this.Tf&&(this.B=!1,this.Tf=null,this.emit("change",this),this.Bn.update())},n.prototype.isApplied=function(){return null!=this.Tf},n.prototype.newSorted=function(){var t=this.Nf;if(null!=t){var n=this.Bn,i=[],r=[];return n.each((function(t,n){i[n]=n,r[n]=t})),i.sort(this.toComparator(r,t)),i}return null},n.prototype.toComparator=function(t,n){var i=this.li;return u(n)?i===pv.ASCENDING?function(i,r){return n(t[i],t[r],i,r)}:function(i,r){return n(t[r],t[i],r,i)}:i===pv.ASCENDING?function(i,r){return n.compare(t[i],t[r],i,r)}:function(i,r){return n.compare(t[r],t[i],r,i)}},n.prototype.get=function(){return this.Nf},n.prototype.set=function(t){this.Nf!==t&&(this.Nf=t)},n.prototype.clear=function(){var t=this.Tf;null!=t&&0<t.length&&(t.length=0,this.Bn.update())},n.prototype.toDirty=function(){null!=this.Tf&&(this.B=!0)},n.prototype.update=function(){this.B&&(this.B=!1,this.Tf=this.newSorted(),this.emit("change",this))},Object.defineProperty(n.prototype,"indices",{get:function(){return this.update(),this.Tf},enumerable:!0,configurable:!0}),n}(t.utils.EventEmitter),Mv=function(t){function n(n){var i=t.call(this)||this;if(i.Bn=null,i.jf=new wv(i),i.Cf=i.toRows(n&&n.rows),i.wo=new Ov(i,n&&n.selection),i.lf=new mv(i),i.kf=new Sv(i),n){var r=n.filter;r&&i.lf.set(r);var e=n.comparator;e&&i.kf.set(e);var u=n.on;if(u)for(var s in u)i.on(s,u[s])}return i}return i(n,t),n.prototype.bind=function(t){this.Bn=t},n.prototype.toRows=function(t){var n=[];if(null!=t)for(var i=0,r=t.length;i<r;++i)n.push(t[i]);return n},Object.defineProperty(n.prototype,"rows",{get:function(){return this.Cf},enumerable:!0,configurable:!0}),n.prototype.update=function(){var t=this.Bn;t&&t.update()},n.prototype.lock=function(){var t=this.Bn;t&&t.lock()},n.prototype.unlock=function(){var t=this.Bn;t&&(t.unlock(!1),t.update())},n.prototype.size=function(){return this.Cf.length},n.prototype.clear=function(){var t=this.Cf;0<t.length&&(t.length=0,this.lock(),this.wo.clear(),this.kf.clear(),this.lf.clear(),this.unlock())},n.prototype.clearAndAdd=function(t){var n=this.Cf;n.length=0,n.push(t),this.lock(),this.wo.clear(),this.kf.toDirty(),this.lf.toDirty(),this.unlock()},n.prototype.clearAndAddAll=function(t){var n=this.Cf;n.length=0;for(var i=0,r=t.length;i<r;++i)n.push(t[i]);this.lock(),this.wo.clear(),this.kf.toDirty(),this.lf.toDirty(),this.unlock()},n.prototype.add=function(t,n){var i=this.Cf,r=this.wo,e=this.kf,u=this.lf;null==n?(i.push(t),this.lock(),e.toDirty(),u.toDirty(),this.unlock()):0<=n&&n<i.length&&(i.splice(n,0,t),this.lock(),r.shift(n,1),e.toDirty(),u.toDirty(),this.unlock())},n.prototype.addAll=function(t,n){var i=this.Cf,r=i.length,e=this.wo,u=this.kf,s=this.lf;if(null==n){for(var h=0,o=a=t.length;h<o;++h)i.push(t[h]);this.lock(),u.toDirty(),s.toDirty(),this.unlock()}else if(0<=n&&n<r){var a=t.length;for(h=0;h<a;++h)i.splice(n+h,0,t[h]);this.lock(),e.shift(n,a),u.toDirty(),s.toDirty(),this.unlock()}},n.prototype.get=function(t){var n=this.Cf;return 0<=t&&t<n.length?n[t]:null},n.prototype.set=function(t,n){var i=this.Cf;if(0<=t&&t<i.length){var r=i[t];return i[t]=n,this.kf.toDirty(),this.lf.toDirty(),this.update(),r}return null},n.prototype.remove=function(t){var n=this.Cf;if(0<=t&&t<n.length){var i=n.splice(t,1)[0];return this.lock(),this.wo.remove(t),this.kf.toDirty(),this.lf.toDirty(),this.unlock(),i}return null},n.prototype.each=function(t,n,i){var r=this.Cf;n=null!=n?Math.max(0,n):0,i=null!=i?Math.min(r.length,i):r.length;for(var e=n;e<i&&!1!==t(r[e],e);++e);},Object.defineProperty(n.prototype,"selection",{get:function(){return this.wo},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"filter",{get:function(){return this.lf},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"sorter",{get:function(){return this.kf},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"mapped",{get:function(){return this.jf},enumerable:!0,configurable:!0}),n}(t.utils.EventEmitter),Ev=function(n){function r(t){var i=n.call(this,t)||this;return i.setState(v.UNFOCUSABLE,!0),i.Ne.emit("init",i.Ne),i}return i(r,n),r.prototype.init=function(t){this.transform.position.y=t.offset||0,n.prototype.init.call(this,t);var i,r=null!=(i=t.data)&&"mapped"in i?t.data:new Mv(t.data);this.Ne=r,r.bind(this);var e=this.theme,u=function(t,n,i){var r=n.columns||[],e=n.row;return null!=e?(null==e.height&&(e.height=t.getRowHeight()),void 0===e.columns&&(e.columns=r),null==e.interactive&&i!==cv.NONE&&(e.interactive="SELF"),null==e.frozen&&(e.frozen=n.frozen)):e={columns:r,height:t.getRowHeight(),interactive:i!==cv.NONE?"SELF":void 0,frozen:n.frozen},e}(e,t,r.selection.type);this.yf=u,this.If=null!=u.height?u.height:e.getRowHeight(),this.Of=u.columns||[],this.Af=0,this.xf=0,this.Rf=0,this.Lf=!1,this.Bf=!1,this.Pf=[]},r.prototype.onResize=function(t,i,r,e){n.prototype.onResize.call(this,t,i,r,e),this.update()},Object.defineProperty(r.prototype,"selection",{get:function(){return this.Ne.selection},enumerable:!0,configurable:!0}),r.prototype.lock=function(){this.Rf+=1,1===this.Rf&&(this.Lf=!1,this.Bf=!1)},r.prototype.unlock=function(t){this.Rf-=1,0===this.Rf&&(t&&this.Lf&&this.update(this.Bf),this.Lf=!1,this.Bf=!1)},r.prototype.update=function(t){if(0<this.Rf)return this.Lf=!0,void(t&&(this.Bf=!0));var n=this.parent,i=this.children,r=n.parent.height,e=this.If,u=this.Ne,s=u.mapped.size(),h=this.Af,o=this.xf,a=o-h,f=s*e;this.height=f;var c=Math.max(r,f),l=Math.max(r-c,n.position.y);n.position.y=l,n.height=c;var b=Math.floor((0-l)/e),g=Math.floor((r-l)/e),d=b-(b%2==0?2:1),m=g+((g-d+1)%2==0?3:2),w=m-d;if(w<a&&a-2<=w&&(m=d+(w=a)),a<w){for(var p=a;p<w;++p){var D=h+p,O=this.newRow(D%2==0);this.addChild(O)}o=h+(a=w)}else if(w<a){for(p=a-1;w<=p;--p)this.removeChild(i[p]);o=h+(a=w)}this.Af=d,this.xf=m;var S=d-h,M=Math.abs(S),E=i.length;if(0<M&&M<E){var N=this.Pf;if(0<S){for(p=0;p<M;++p)N.push(this.resetRow(i[p]));for(p=M;p<E;++p)i[p-M]=i[p];for(p=0;p<M;++p)i[E-M+p]=N[p]}else{for(p=0;p<M;++p)N.push(this.resetRow(i[E-M+p]));for(p=E-M-1;0<=p;--p)i[p+M]=i[p];for(p=0;p<M;++p)i[p]=N[p]}N.length=0}var T=u.selection;for(u.mapped.each((function(n,r,u){var s=i[r-d];s.position.y=r*e,T.contains(u)?s.setStates(v.ACTIVE,v.DISABLED):s.setStates(v.NONE,v.ACTIVE|v.DISABLED),s.set(n,u,t)}),d,d+E),p=0;d+p<0&&p<E;++p)(j=i[p]).position.y=(d+p)*e,j.setStates(v.DISABLED,v.ACTIVE),j.unset();for(p=E-1;s<=d+p&&0<=p;--p){var j;(j=i[p]).position.y=(d+p)*e,j.setStates(v.DISABLED,v.ACTIVE),j.unset()}},r.prototype.resetRow=function(t){t.blur(!0);for(var n=t.children,i=0,r=n.length;i<r;++i){var e=n[i];e instanceof z&&e.setPressed(!1)}return t},r.prototype.newRow=function(t){var n=this,i=this.yf;i.even=t;var r=new dv(i);return r.on("change",(function(t,i,e){var u=n.getChildIndex(r);if(0<=u){var s=n.Af+u,h=n.Ne;h.emit("change",t,i,s,e,h)}})),r},r.prototype.onParentMove=function(t,i){n.prototype.onParentMove.call(this,t,i),this.updateFrozenCellPosition(t)},r.prototype.updateFrozenCellPosition=function(t){if(0<this.yf.frozen)for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].updateFrozenCellPosition(t)},r.prototype.getClippingRect=function(t,i){n.prototype.getClippingRect.call(this,t,i);var r=this.parent;if(r){var e=-r.transform.position.y;i.y+=e,i.height-=e}},r.prototype.onRowClicked=function(t){if(this.isActionable()){var n=r.WORK_ON_CLICK;if(n.copyFrom(t.data.global),this.toLocal(n,void 0,n,!1),0<=this.parent.position.y+n.y){var i=Math.floor(n.y/this.If),e=this.Ne;if(0<=i&&i<e.mapped.size()){var u=e.selection.type===cv.SINGLE,s=!u,h=t.data.originalEvent,o=h.ctrlKey,a=h.shiftKey,f=e.mapped.unmap(i);u||e.selection.isEmpty()||!s||!o&&!a?e.selection.clearAndAdd(f):o?e.selection.toggle(f):a&&e.selection.addTo(f)}}}},r.prototype.onDblClick=function(t,i){var e=!1,u=this.Ne;if(this.isActionable()&&u.selection.type!==cv.NONE){var s=P.toGlobal(t,i,r.WORK_ON_CLICK);this.toLocal(s,void 0,s,!1);var h=s.x,o=s.y;if(0<=this.parent.position.y+o){var a=Math.floor(o/this.If);if(0<=a&&a<u.mapped.size()){var f=a-this.Af,c=this.children;if(0<=f&&f<c.length)for(var l=c[f].children,v=l.length,b=this.Of,g=b.length,d=0,m=Math.min(v,g);d<m;++d)if(b[g-d-1].editing.enable){var w=l[v-d-1],p=h-w.position.x;0<=p&&p<=w.width&&(w.focus(),w instanceof na&&w.onClick(),e=!0)}}}}return n.prototype.onDblClick.call(this,t,i)||e},r.prototype.getType=function(){return"DTableBody"},Object.defineProperty(r.prototype,"data",{get:function(){return this.Ne},enumerable:!0,configurable:!0}),r.WORK_ON_CLICK=new t.Point,r}(z),Nv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DTableCategoryCell"},n}($),Tv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.onParentMove=function(n,i){t.prototype.onParentMove.call(this,n,i),this.transform.position.y=-i,this.updateFrozenCellPosition(n)},n.prototype.getContentPositionX=function(){var t=this.parent;return t?t.position.x:0},n.prototype.newCell=function(t,n,i,r){return new Nv(this.toCellOptions(t,r))},n.prototype.toCellOptions=function(t,n){var i=n.cell;if(i){i.weight=t.weight,i.width=t.width;var r=i.text=i.text||{};return r.value=r.value||t.label,i}return{weight:t.weight,width:t.width,text:{value:t.label}}},n.prototype.getType=function(){return"DTableCategory"},n}(bv),jv={SORTED_ASCENDING:v.CUSTOM<<5,SORTED_DESCENDING:v.CUSTOM<<6},Cv=function(t){function n(n){var i=t.call(this,n)||this;return i.Rn=n.header,i.Ff=n.column,i.Nf=n.column.sorting.comparator,n.column.sorting.enable&&P.onClick(i,(function(t){i.onClick()})),i}return i(n,t),Object.defineProperty(n.prototype,"sorter",{get:function(){var t=this,n=this.kf||null;if(null==n){var i=this.Rn.table;i&&(n=i.data.sorter,this.kf=n,this._f=this._f||function(){t.onSorterChange()},n.on("change",this._f))}return n},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"comparator",{get:function(){return this.Nf||null},enumerable:!0,configurable:!0}),n.prototype.onClick=function(){var t=this.Nf;if(t){var n=this.sorter;n&&(n.get()===t?n.order===pv.ASCENDING?(n.order=pv.DESCENDING,n.apply()):(n.set(null),n.apply()):(n.set(t),n.order=pv.ASCENDING,n.apply()))}},n.prototype.onSorterChange=function(){var t=this.kf,n=this.Nf;if(t&&n){var i=jv.SORTED_ASCENDING,r=jv.SORTED_DESCENDING;t.isApplied()&&t.get()===n?t.order===pv.ASCENDING?this.setStates(i,r):this.setStates(r,i):this.setState(i|r,!1)}},n.prototype.init=function(n){t.prototype.init.call(this,n)},n.prototype.getType=function(){return"DTableHeaderCell"},n.prototype.destroy=function(){var n=this.kf,i=this._f;n&&i&&n.off("change",i),this.kf=void 0,this._f=void 0,this.Nf=void 0,t.prototype.destroy.call(this)},n}($),kv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){this.Uf=n.table||null,this.S=this.transform.position.y=n.offset||0,this.Df=n.frozen,t.prototype.init.call(this,n)},Object.defineProperty(n.prototype,"table",{get:function(){return this.Uf},enumerable:!0,configurable:!0}),n.prototype.onParentMove=function(n,i){t.prototype.onParentMove.call(this,n,i),this.transform.position.y=-i+this.S,this.updateFrozenCellPosition(n)},n.prototype.getContentPositionX=function(){var t=this.parent;return t?t.position.x:0},n.prototype.newCell=function(t,n,i,r){return new Cv(this.toCellOptions(t,r))},n.prototype.toCellOptions=function(t,n){var i=t.header||n.cell;return null!=i?(void 0===i.weight&&(i.weight=t.weight),void 0===i.width&&(i.width=t.width),void 0===i.text?i.text={value:t.label}:void 0===i.text.value&&(i.text.value=t.label),void 0===i.header&&(i.header=this),void 0===i.column&&(i.column=t),i):{weight:t.weight,width:t.width,text:{value:t.label},header:this,column:t}},n.prototype.getType=function(){return"DTableHeader"},n}(bv),yv=function(t,n){return t[n]},Iv=function(t,n,i){t[n]=i},Av=function(t){return t},xv=function(t){var n=t.editing;return n?{enable:!0===n.enable||!0===t.editable,formatter:n.formatter||vs,unformatter:n.unformatter||Av,validator:n.validator}:{enable:!0===t.editable,formatter:vs,unformatter:Av}},Rv=function(t,n){return function(i,r){var e=t(i,n),u=t(r,n);return e<u?-1:u<e?1:0}},Lv=function(t,n,i){var r=i.sorting;if(r){var e=!0===r.enable||!0===i.sortable;return e?{enable:e,comparator:r.comparator||Rv(t,n)}:{enable:e}}return!0===i.sortable?{enable:!0,comparator:Rv(t,n)}:{enable:!1}},Bv=function(t){return null==t?void 0:t instanceof Sl?t:new Sl(t)},Pv=function(t){return null==t?void 0:t instanceof Dl?t:new Dl(t)},Fv=function(t){return t},_v=function(t){return t?{getter:t.getter||Fv,menu:Bv(t.menu),dialog:Pv(t.dialog),fetcher:t.fetcher}:{getter:Fv}},Uv=function(t,n){var i=null!=n.weight?n.weight:null!=n.width?void 0:1,r=null!=i?void 0:null!=n.width?n.width:100,e=null!=n.type?o(n.type)?_l[n.type]:n.type:_l.TEXT,u=function(t,n){if(null!=t.align)return o(t.align)?F[t.align]:t.align;switch(n){case _l.TEXT:return F.LEFT;case _l.REAL:case _l.INTEGER:return F.RIGHT;case _l.INDEX:case _l.SELECT:return F.CENTER;default:return F.LEFT}}(n,e),s=n.label||"",h=n.getter||yv;return{weight:i,width:r,type:e,label:s,getter:h,setter:n.setter||Iv,formatter:n.formatter,align:u,editing:xv(n),sorting:Lv(h,t,n),header:n.header,body:n.body,selecting:_v(n.selecting),category:n.category,frozen:n.frozen,offset:0}},zv=function(t){function n(n){return t.call(this,n)||this}return i(n,t),n.prototype.init=function(n){var i=function(t){for(var n=[],i=0,r=t.length;i<r;++i)n.push(Uv(i,t[i]));return n}(n.columns),r=function(t){for(var n=t.length-1;0<=n;--n)if(!0===t[n].frozen)return n+1;return 0}(i),e=this.newCategory(n,i,r);this.zf=e;var u=e&&e.height||0,s=this.newHeader(n,i,r,u);this.Rn=s;var h=u+s.height,o=this.newBody(n,i,r,h);this.Ln=o,t.prototype.init.call(this,n);var a=this.va;a.setWidth(this.toContentWidth(n)),a.addChild(o),a.addChild(s),e&&a.addChild(e),a.on("move",(function(){o.update()})),a.on("resize",(function(){o.update()})),o.data.selection.type!==cv.NONE&&P.onClick(this,(function(t){o.onRowClicked(t)})),o.update()},n.prototype.hasCategories=function(t){for(var n=0,i=t.length;n<i;++n)if(null!=t[n].category)return!0;return!1},n.prototype.toCategoryColumns=function(t,n){for(var i=[],r=null,e=0,u=t.length;e<u;++e){var s=t[e];e!==n&&r&&r.label===s.category?null!=r.weight&&null!=s.weight?r.weight+=s.weight:null!=r.width&&null!=s.width?r.width+=s.width:(r={label:s.category,weight:s.weight,width:s.width,offset:0},i.push(r)):(r={label:s.category,weight:s.weight,width:s.width,offset:0},i.push(r))}return i},n.prototype.newCategory=function(t,n,i){return this.hasCategories(n)?new Tv(this.toCategoryOptions(t.category,n,i)):null},n.prototype.toCategoryOptions=function(t,n,i){return t?(void 0===t.columns&&(t.columns=this.toCategoryColumns(n,i)),null==t.frozen&&(t.frozen=i),t):{columns:this.toCategoryColumns(n,i),frozen:i}},n.prototype.onDblClick=function(n,i){var r=this.Ln.onDblClick(n,i);return t.prototype.onDblClick.call(this,n,i)||r},n.prototype.getScrollBarOffsetVerticalStart=function(t){return.5*t+this.Ln.position.y},n.prototype.toContentWidth=function(t){var n=0,i=t.columns;if(i)for(var r=0,e=i.length;r<e;++r){var u=i[r].width;null!=u&&(n+=u)}return 0<n?function(t){return Math.max(t,n)}:"100%"},n.prototype.newHeader=function(t,n,i,r){return new kv(this.toHeaderOptions(t.header,n,i,r))},n.prototype.toHeaderOptions=function(t,n,i,r){return t?(void 0===t.columns&&(t.columns=n),null==t.frozen&&(t.frozen=i),void 0===t.offset&&(t.offset=r),void 0===t.table&&(t.table=this),t):{columns:n,frozen:i,offset:r,table:this}},n.prototype.newBody=function(t,n,i,r){return new Ev(this.toBodyOptions(t.body,n,i,r,t.data))},n.prototype.toBodyOptions=function(t,n,i,r,e){return null!=t?(void 0===t.columns&&(t.columns=n),null==t.frozen&&(t.frozen=i),void 0===t.offset&&(t.offset=r),void 0===t.data&&void 0!==e&&(Zn(e)?t.data={rows:e}:t.data=e),void 0===t.height&&void 0===t.weight&&(t.weight=1),t):Zn(e)?{columns:n,frozen:i,offset:r,data:{rows:e},weight:1}:{columns:n,frozen:i,offset:r,data:e,weight:1}},n.prototype.getType=function(){return"DTable"},Object.defineProperty(n.prototype,"category",{get:function(){return this.zf},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"header",{get:function(){return this.Rn},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"body",{get:function(){return this.Ln},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"data",{get:function(){return this.Ln.data},enumerable:!0,configurable:!0}),n}(vl),Gv=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return i(n,t),n}(z),Hv={__proto__:null,DExpandableHeader:Nl,loadShapeLabel:Iu,loadAll:so,loadMenuItemExpandable:Lt,loadMenuItem:Ot,loadMenuSidedItemExpandable:$t,loadMenuSidedItem:Ht,loadShapeAll:uo,loadShapeBar:Be,loadShapeCircle:Xe,loadShapeGroupShadowed:du,loadShapeGroup:lu,loadShapeImage:Tu,loadMenuItemAll:tn,loadShapeLineOfCircles:Zs,loadShapeLineOfRectangleRoundeds:fh,loadShapeLineOfRectangles:gh,loadShapeLineOfTriangleRoundeds:Ch,loadShapeLineOfTriangles:_h,loadShapeLine:Fu,loadShapeNull:Vh,loadShapeRectangleRounded:Zh,loadShapeRectangle:Yh,loadShapeTriangleRounded:eo,loadShapeTriangle:to,ESnapperGrid:ko,ESnapperResultScale:function(){this.distance=NaN,this.scale=new t.Point},ESnapperResult:yo,get ESnapperTargetValueType(){return qs},ESnapperTargetValue:Ao,ESnapperTarget:xo,get ESnapperModifierAnchor(){return Io},ESnapper:Lo,DThemes:L,toString:vs,DynamicAtlasItemEmpty:Zu,DynamicAtlasItemImage:Qu,DynamicAtlasItemText:$u,DynamicAtlasItemWhite:ts,DynamicAtlasItem:Ju,DynamicAtlas:ns,DynamicFontAtlasCharacterOrigin:Fr,DynamicFontAtlasCharacter:_r,DynamicFontAtlasFont:is,DynamicFontAtlas:rs,DynamicFontAtlases:os,DynamicSDFFontAtlas:zr,DynamicSDFFontAtlases:as,DynamicSDFFontGenerator:Ur,isArray:Zn,isFunction:u,isNaN:fs,isNumber:c,isString:o,Lazy:cs,NumberFormatterImpl:Tr,NumberFormatters:jr,toCeilingIndex:ls,toIndexOf:Au,toPadded:dn,DynamicAtlasItemFontAtlas:qu,toSvgTexture:function(n,i){return t.Texture.from(bs(n),{resolution:i})},toSvgUrl:bs,UtilAlpha:bi,UtilSvgAtlasBuilder:ms,get UtilAttachAlign(){return st},UtilAttach:vt,UtilClickOutside:ws,UtilClipboard:ft,UtilDragEasingHistory:ps,UtilDragEasing:Ss,UtilDrag:Ns,UtilExtract:Cs,UtilExtractor:Ts,UtilFileDownloader:js,get UtilFileAs(){return Ms},UtilFileOpener:ys,UtilHsv:Is,UtilKeyboardEvent:B,UtilName:As,UtilOverlay:xs,UtilPointerEvent:P,UtilPromise:Rs,UtilRgb:mn,UtilRgba:Ls,UtilTexturePlane:Bs,UtilTexture:Ps,UtilTransition:Fs,UtilWheelEvent:_s,get DAlignHorizontal(){return F},get DAlignVertical(){return _},get DAlignWith(){return U},DAnimationBase:Os,DAnimationEmpty:Bo,DAnimationFadeIn:Po,DAnimationTimings:Ds,DApplicationLayerOptions:_o,DApplicationLayer:Qo,DApplicationPadding:Fo,DApplication:$o,DApplications:e,DBaseBackground:s,DBaseBorder:a,DBaseCorner:l,get DBaseInteractive(){return f},DBaseOutline:b,DBasePadding:g,DBasePoint:d,DBaseReflowable:S,get DBaseState(){return v},DBaseStates:N,DBase:z,DBoard:ta,get DBorderMask(){return r},DButtonAmbient:ra,DButtonBase:na,DButtonCheckRight:ua,DButtonCheck:ea,DButtonColorGradient:xa,DButtonColor:La,DButtonDanger:Ba,DButtonDate:rf,DButtonDatetime:af,DButtonFileAs:ff,DButtonFile:cf,DButtonGroup:lf,DButtonPrimary:sa,DButtonRadioRight:bf,DButtonRadio:vf,DButtonRedo:gf,DButtonSecondary:df,DButtonTime:pf,DButtonUndo:Df,DButton:ia,DCanvasContainer:jf,DCanvas:Cf,DChartAxisBase:Af,DChartAxisContainerImpl:xf,get DChartAxisPosition(){return Sf},get DChartAxisTickPosition(){return Mf},DChartAxisXDatetime:Lf,DChartAxisX:Rf,DChartAxisY:Bf,DChartColorSet1:function(t){return Pf[t%Pf.length]},DChartColorSet2:_f,DChartCoordinateContainerImpl:Gf,DChartCoordinateContainerSubImpl:zf,DChartCoordinateLinearTick:Hf,DChartCoordinateLinear:Yf,DChartCoordinateLogTick:Xf,DChartCoordinateLog:Kf,DChartCoordinateTransformImpl:Vf,get DChartCoordinateDirection(){return kf},DChartLegendItem:Jf,DChartLegend:Zf,DChartOverview:qf,get DChartPlotAreaFitTarget(){return Uf},DChartPlotArea:uc,DChartRegionImplObservable:sc,DChartRegionImpl:Wf,DChartSeriesBaseCoordinateContainer:hc,DChartSeriesBase:oc,DChartSeriesContainerImpl:rc,DChartSeriesFillComputedImpl:ac,DChartSeriesFillImpl:nc,DChartSeriesLineOfCircles:lc,DChartSeriesLineOfRectangleRoundeds:vc,DChartSeriesLineOfRectangles:bc,DChartSeriesLineOfTriangleRoundeds:gc,DChartSeriesLineOfTriangles:dc,DChartSeriesLine:mc,DChartSeriesExpressionParametersImpl:wc,DChartSeriesLinear:pc,DChartSeriesScalars:tc,DChartSelectionGridlineContainerImpl:Mc,DChartSelectionGridlineX:Oc,DChartSelectionGridlineY:Sc,DChartSelectionMarker:Ec,DChartSelectionShapeBase:Dc,DChartSelectionSimple:jc,DChartSelectionSubImpl:Tc,get DChartSelectionPoint(){return ec},DChartSeriesStrokeImpl:ic,DChartSeriesHitResult:$f,DChart:Cc,DCommandClear:Wo,DCommandCreate:kc,DCommandDelete:yc,get DCommandFlag(){return Ro},DCommandRedo:Yo,DCommandSaveAs:Ic,DCommandSave:Ac,DCommandUndo:Xo,DContent:xc,DControllerDefaultCommand:Jo,DControllerDefaultFocus:Ho,DControllerKeyboard:Zo,DControllers:qo,get DCornerMask(){return h},DDiagramCanvasBase:_c,DDiagramCanvasEditor:Uc,DDiagramCanvasTileMappingImpl:Lc,DDiagramCanvasTileMappingPointImpl:Rc,DDiagramCanvasTile:Bc,DDiagramCanvas:zc,DDiagramEditor:Vc,DDiagramLayerContainer:Fc,DDiagramLayer:Pc,DDiagramSerializedVersion:1,DDiagramShape:Wc,DDiagramTag:Yc,DDiagram:Xc,DDiagrams:Gc,get DDialogCloseOn(){return Vo},DDialogColorGradient:Aa,DDialogColor:Ra,DDialogCommand:fa,DDialogConfirmDelete:Zc,DDialogConfirmDiscard:qc,DDialogConfirmMessage:Kc,DDialogConfirm:Jc,DDialogDate:tf,DDialogDates:nf,DDialogDatetime:ef,DDialogDatetimes:uf,DDialogInputText:Qc,DDialogMessage:$c,DDialogProcessingMessage:tl,DDialogProcessing:nl,DDialogSaveAs:il,DDialogSelectListItem:rl,DDialogSelectList:gl,DDialogSelect:Dl,DDialogTime:mf,DDialogTimes:wf,DDialog:oa,get DDragMode(){return Va},DDropdown:El,DDynamicTextGeometry:Y,DDynamicTextStyle:X,DDynamicTextMeasureResultCharacter:G,DDynamicTextMeasureResult:H,DDynamicTextMeasure:W,DDynamicText:K,EShapeRenderer:Mo,EShapeActionRuntimeTransformMoveRelativeX:ae,EShapeActionBases:qn,EShapeActionRuntimeBlinkColorFill:ri,EShapeActionRuntimeBlinkColorStroke:ei,EShapeActionRuntimeBlinkDarken:ui,EShapeActionRuntimeBlinkOpacity:si,EShapeActionRuntimeBlinkVisibility:hi,EShapeActionRuntimeBlink:ni,EShapeActionRuntimeChangeColorAll:wi,EShapeActionRuntimeChangeColorBrightnessAll:Ci,EShapeActionRuntimeChangeColorBrightnessFillAndStroke:yi,EShapeActionRuntimeChangeColorBrightnessFill:ki,EShapeActionRuntimeChangeColorBrightnessStroke:Ii,EShapeActionRuntimeChangeColorBrightnessTextOutline:xi,EShapeActionRuntimeChangeColorBrightnessText:Ai,EShapeActionRuntimeChangeColorBrightness:ji,EShapeActionRuntimeChangeColorCodeAll:_i,EShapeActionRuntimeChangeColorCodeFillAndStroke:zi,EShapeActionRuntimeChangeColorCodeFill:Ui,EShapeActionRuntimeChangeColorCodeStroke:Gi,EShapeActionRuntimeChangeColorCodeTextOutline:Vi,EShapeActionRuntimeChangeColorCodeText:Hi,EShapeActionRuntimeChangeColorCode:Fi,EShapeActionRuntimeChangeColorFillAndStroke:Di,EShapeActionRuntimeChangeColorFill:pi,EShapeActionRuntimeChangeColorStroke:Oi,EShapeActionRuntimeChangeColorTextOutline:Mi,EShapeActionRuntimeChangeColorText:Si,EShapeActionRuntimeChangeColor:mi,EShapeActionRuntimeChangeCursor:Xi,EShapeActionRuntimeChangeTextNumber:kr,EShapeActionRuntimeChangeTextText:Ir,EShapeActionRuntimeConditional:ti,EShapeActionRuntimeEmitEvent:Lr,EShapeActionRuntimeMiscInputData:Gr,EShapeActionRuntimeMiscInput:Hr,EShapeActionRuntimeOpenFlow:Kr,EShapeActionRuntimeOpenPageInplace:Zr,EShapeActionRuntimeOpenPage:Jr,EShapeActionRuntimeOpen:Xr,EShapeActionRuntimeShowHide:ne,EShapeActionRuntimeTransformMoveAbsoluteX:ue,EShapeActionRuntimeTransformMoveAbsoluteY:se,EShapeActionRuntimeTransformMoveForwardOrBackward:he,EShapeActionRuntimeTransformMoveLeftOrRight:oe,EShapeActionRuntimeBlinkBrighten:ii,EShapeActionRuntimeTransformMoveRelativeY:fe,EShapeActionRuntimeTransformMove:ee,EShapeActionRuntimeTransformResizeHeightAbsolute:pe,EShapeActionRuntimeTransformResizeHeightRelative:De,EShapeActionRuntimeTransformResizeSizeAbsolute:Oe,EShapeActionRuntimeTransformResizeSizeRelative:Se,EShapeActionRuntimeTransformResizeWidthAbsolute:Me,EShapeActionRuntimeTransformResizeWidthRelative:Ee,EShapeActionRuntimeTransformResize:we,EShapeActionRuntimeTransformRotateAbsolute:Ce,EShapeActionRuntimeTransformRotateRelative:ke,EShapeActionRuntimeTransformRotate:je,EShapeActionRuntime:Qn,EShapeActionValueBase:ai,get EShapeActionValueBlinkType(){return Rn},EShapeActionValueBlink:vi,EShapeActionValueChangeColorBrightness:Ri,EShapeActionValueChangeColorCode:Wi,get EShapeActionValueChangeColorTarget(){return ci},get EShapeActionValueChangeColorType(){return gi},EShapeActionValueChangeColor:Ni,EShapeActionValueChangeCursor:Ki,get EShapeActionValueChangeTextType(){return Ei},EShapeActionValueChangeText:xr,EShapeActionValueDeserializer:Ie,EShapeActionValueEmitEvent:Br,get EShapeActionValueMiscType(){return Ar},EShapeActionValueMisc:Wr,get EShapeActionValueOpenType(){return Vr},EShapeActionValueOpen:Qr,EShapeActionValueOpetyped:ce,get EShapeActionValueShowHideType(){return qr},EShapeActionValueShowHide:ie,EShapeActionValueSubtyped:fi,get EShapeActionValueTransformMoveType(){return $r},EShapeActionValueTransformMove:ve,get EShapeActionValueTransformResizeType(){return le},EShapeActionValueTransformResize:Ne,get EShapeActionValueTransformRotateType(){return ge},EShapeActionValueTransformRotate:ye,get EShapeActionValueTransformType(){return te},get EShapeActionValueType(){return oi},EShapeActionValues:li,EShapeAction:cn,EShapeBufferCount:go,EShapeBufferUnitBuilder:wo,EShapeBufferUnit:mo,EShapeBuffer:po,EShapeCapabilities:Qs,get EShapeCapability(){return ks},EShapeContainer:Eo,get EShapeCorner(){return ln},EShapeDeleter:To,EShapeDefaults:Sn,EShapeDeserializer:Re,EShapeDeserializers:nn,EShapeEditor:Qe,EShapeImageElements:Ae,EShapePointsStyleUploadeds:sn,get EShapePointsStyle(){return rn},EShapeRendererIteratorDatum:Oo,EShapeRendererIterator:So,EShapeLineOfRectangleRoundedsUploadeds:sh,EShapeBarPoints:fn,EShapeBarUploaded:Kn,EShapeBarUploadeds:Jn,EShapeBar:zn,EShapeBars:Le,EShapeBase:pn,EShapeCircleUploaded:He,EShapeCircleUploadeds:Ve,EShapeCircle:We,EShapeCircles:Ye,EShapeFillImpl:Mn,EShapeGradients:wn,EShapeGroupFillEditor:Ze,EShapeGroupFillViewer:ho,EShapeGroupPoints:qe,EShapeGroupShadowed:bu,EShapeGroupShadoweds:gu,EShapeGroupSizeEditor:nu,EShapeGroupSizeLayout:tu,EShapeGroupSizeShadowed:vu,EShapeGroupSizeViewer:iu,EShapeGroupStrokeEditor:ru,EShapeGroupStrokeViewer:oo,EShapeGroupTextAlignEditor:eu,EShapeGroupTextAlignViewer:ao,EShapeGroupTextEditor:au,EShapeGroupTextOffsetEditor:uu,EShapeGroupTextOffsetViewer:fo,EShapeGroupTextOutlineEditor:su,EShapeGroupTextOutlineViewer:co,EShapeGroupTextPaddingEditor:hu,EShapeGroupTextPaddingViewer:lo,EShapeGroupTextSpacingEditor:ou,EShapeGroupTextSpacingViewer:vo,EShapeGroupTextViewer:bo,EShapeGroupUploaded:Ke,EShapeGroupUploadeds:Je,EShapeGroup:fu,EShapeGroups:cu,EShapeImage:wu,EShapeImages:pu,EShapeLabelUploaded:ju,EShapeLabelUploadeds:Cu,EShapeLabel:ku,EShapeLabels:yu,EShapeLineBase:Un,EShapeLineOfAnyPointsFillImpl:Ku,EShapeLineOfAnyPointsSizeImpl:Us,EShapeLineOfAnyPointsStrokeImpl:zs,EShapeLineOfAnyPoints:Gs,EShapeLineOfAnyUploadeds:Uu,EShapeLineOfCirclesUploaded:Ws,EShapeLineOfCirclesUploadeds:Ys,EShapeLineOfCircles:Ks,EShapeLineOfNullsUploaded:_u,EShapeLineOfRectangleRoundedsUploaded:uh,get EShapeBarPosition(){return un},EShapeLineOfRectangleRoundeds:oh,EShapeLineOfRectanglesUploaded:ch,EShapeLineOfRectanglesUploadeds:lh,EShapeLineOfRectangles:vh,EShapeLineOfTriangleRoundedsUploaded:Sh,EShapeLineOfTriangleRoundedsUploadeds:Mh,EShapeLineOfTriangleRoundeds:Th,EShapeLineOfTrianglesUploaded:Lh,EShapeLineOfTrianglesUploadeds:Bh,EShapeLineOfTriangles:Ph,EShapeLinePoints:Lu,EShapeLineUploaded:xu,EShapeLineUploadeds:Ru,EShapeLine:Bu,EShapeLinesOfCircles:Js,EShapeLinesOfRectangleRoundeds:ah,EShapeLinesOfRectangles:bh,EShapeLinesOfTriangleRoundeds:jh,EShapeLinesOfTriangles:Fh,EShapeLines:Pu,EShapeNullUploaded:Uh,EShapeNullUploadeds:zh,EShapeNull:Gh,EShapeNulls:Hh,EShapePrimitive:_n,EShapeRectangleRoundedUploaded:Xh,EShapeRectangleRoundedUploadeds:Kh,EShapeRectangleRounded:hh,EShapeRectangleRoundeds:Jh,EShapeRectangleUploaded:Eu,EShapeRectangleUploadeds:Nu,EShapeRectangle:mu,EShapeRectangles:Wh,EShapeStrokeImpl:En,EShapeTagImpl:xn,EShapeTagValueImpl:An,EShapeTagValueRangeImpl:yn,EShapeTextAlignImpl:Ln,EShapeTextImpl:Fn,EShapeTextOffsetImpl:Bn,EShapeTextOutlineImpl:Pn,EShapeTextUploaded:Xn,EShapeTextUploadeds:Wn,EShapeTriangleRoundedUploaded:no,EShapeTriangleRoundedUploadeds:io,EShapeTriangleRounded:Nh,EShapeTriangleRoundeds:ro,EShapeTriangleUploaded:qh,EShapeTriangleUploadeds:Qh,EShapeTriangle:Eh,EShapeTriangles:$h,isStatic:Yu,toComputed:Xu,toHitThreshold:Xs,toLength:Yn,toStep:Fe,EShapeResourceManagerDeserialization:xe,EShapeResourceManagerSerialization:jo,get EShapeRuntimeReset(){return on},get EShapeRuntimeState(){return an},EShapeRuntime:bn,EShapeRuntimes:Co,EShapeSearch:No,EShapeSizes:be,get EShapeStrokeSide(){return vn},get EShapeTagValueRangeType(){return On},get EShapeTagValueOrder(){return Dn},get EShapeTextAlignHorizontal(){return jn},get EShapeTextAlignVertical(){return Cn},get EShapeTextDirection(){return kn},get EShapeTextWeight(){return Nn},get EShapeTextStyle(){return Tn},EShapeTransformImpl:gn,EShapeTransforms:$e,get EShapeType(){return St},EShapeUploadedBase:Vn,EShapeUploadeds:en,get EShapeCopyPart(){return hn},DExpandable:Tl,get DHtmlElementWhen(){return ha},DHtmlElement:la,DImageBase:Q,DImage:$,DInputAndLabel:wa,DInputIntegerAndLabel:jl,DInputInteger:Ha,DInputLabel:ma,DInputNumber:ba,DInputRealAndLabel:pa,DInputReal:ga,DInputTextAndLabel:Oa,DInputText:Da,DInput:va,get DLayoutClearType(){return M},get DLayoutDirection(){return lt},DLayoutHorizontal:aa,DLayoutSpace:pt,DLayoutVertical:Nt,DLayout:Et,DListItemSeparatorReflowable:dt,DListItemSeparator:mt,DListItem:tt,get DListSelectionMode(){return Nc},DListSelection:el,DList:bl,DMapCoordinateEPSG3857:Cl,DMapCoordinates:kl,DMapTilePlane:Il,DMapTilePyramidImpl:Al,DMapTileUrlBuilderKokudo:function(t,n,i){return 5<=t?"https://cyberjapandata.gsi.go.jp/xyz/pale/"+t+"/"+n+"/"+i+".png":2<=t?"https://cyberjapandata.gsi.go.jp/xyz/std/"+t+"/"+n+"/"+i+".png":"https://cyberjapandata.gsi.go.jp/xyz/earthhillshade/"+t+"/"+n+"/"+i+".png"},DMapTileUrlBuilderOsm:function(t,n,i){return"https://"+"abc"[(n+i)%3]+".tile.openstreetmap.org/"+t+"/"+n+"/"+i+".png"},DMapTileUrlBuilderOsmfj:xl,DMapTilePyramids:Rl,DMapTile:yl,DMenuAlign:bt,DMenuBarBlocker:Bl,DMenuBarItem:Ll,DMenuBar:Pl,DMenuContext:Ol,DMenuItemCheck:rt,DMenuItemExpandableBody:Tt,DMenuItemExpandableHeader:jt,DMenuItemExpandableItemCheck:yt,DMenuItemExpandableItemLink:It,DMenuItemExpandableItemMenu:Kt,DMenuItemExpandableItemSeparator:At,DMenuItemExpandableItemSpace:xt,DMenuItemExpandableItemText:Rt,DMenuItemExpandable:kt,DMenuItemExpandables:Ct,get DMenuItemLinkMenuItemId(){return J},DMenuItemLinkState:ut,get DMenuItemLinkTarget(){return et},DMenuItemLink:ct,DMenuItemMenu:gt,DMenuItemSeparator:wt,DMenuItemSpace:Dt,DMenuItemText:it,DMenuItem:nt,DMenuSidedItemCheck:Bt,DMenuSidedItemExpandableItemCheck:Yt,DMenuSidedItemExpandableItemLink:Xt,DMenuSidedItemExpandableItemMenu:Jt,DMenuSidedItemExpandableItemSeparator:Zt,DMenuSidedItemExpandableItemSpace:qt,DMenuSidedItemExpandableItemText:Qt,DMenuSidedItemExpandable:Wt,DMenuSidedItemExpandables:Vt,DMenuSidedItemLink:Pt,DMenuSidedItemMenu:Ft,DMenuSidedItemSeparator:_t,DMenuSidedItemSpace:Ut,DMenuSidedItemText:zt,DMenuSided:Gl,DMenuSideds:Gt,DMenu:Sl,DMenus:ht,get DMouseModifier(){return ds},DMouseModifiers:Es,DNote:ml,DNotification:Hl,DPagination:Vl,DPane:vl,DPickerColorAndAlpha:Sa,DPickerColorGradientDataView:Ca,DPickerColorGradientData:ja,DPickerColorGradientPoint:Na,DPickerColorGradientRecent:ya,DPickerColorGradient:Ia,DPickerColorRecent:Ma,DPickerColor:Ea,DPickerDate:$a,DPickerDates:sf,DPickerDatetimeButtonBack:Pa,DPickerDatetimeButtonDate:Fa,DPickerDatetimeButtonNext:_a,DPickerDatetimeLabelDate:za,DPickerDatetimeLabel:Ua,get DPickerDatetimeMask(){return ca},DPickerDatetimeSpace:Ga,DPickerDatetime:Qa,DPickerDatetimes:of,DPickerDatetimeRange:Wl,DPickerTimeRange:Yl,DPickerTimeBoundHours:Ya,DPickerTimeBoundMinutes:Xa,DPickerTimeBoundSeconds:Ka,DPickerTimeBounds:Ja,DPickerTime:qa,DPickerTimes:hf,DScalarExpression:k,DScalarFunctions:R,DScrollBarHorizontal:al,DScrollBarThumbHorizontal:ol,DScrollBarThumbReflowableHorizontal:hl,DScrollBarThumbReflowableVertical:fl,DScrollBarThumbVertocal:cl,DScrollBarThumb:sl,DScrollBarVertical:ll,DScrollBar:ul,DSelect:Xl,DShadowImpl:Kl,DSliderRange:Jl,DSlider:Zl,DTableBodyCellCheck:ql,DTableBodyCellColor:$l,DTableBodyCellIndex:tv,DTableBodyCellInputInteger:nv,DTableBodyCellInputReal:iv,DTableBodyCellInputText:rv,DTableBodyCellSelectDialog:ev,DTableBodyCellSelectFetcher:uv,DTableBodyCellSelectMenu:sv,DTableBodyCellText:hv,DTableBodyRow:dv,DTableBody:Ev,DTableCategoryCell:Nv,DTableCategory:Tv,DTableCellState:lv,get DTableColumnType(){return _l},DTableDataFilterImpl:mv,DTableDataList:Mv,DTableDataMappedList:wv,DTableDataSelectionImpl:Ov,get DTableDataSelectionType(){return cv},DTableBodySorterImpl:Sv,get DTableDataOrder(){return pv},DTableHeaderCellState:jv,DTableHeaderCell:Cv,DTableHeader:kv,DTableRowState:vv,DTableRow:bv,DTable:zv,DTextBase:q,DText:da,DTree:Gv,DViewDragImpl:Ef,DViewImpl:Tf,DViewTransformImpl:Nf};so();var Vv=window;Vv.wcardinal=Vv.wcardinal||{},Vv.wcardinal.ui=Hv}(PIXI);
//# sourceMappingURL=wcardinal-ui.min.js.map
