{"version":3,"file":"wcardinal-ui.min.js","sources":["../../../node_modules/tslib/tslib.es6.js","wcardinal/ui/d-applications.ts","wcardinal/ui/d-border.ts","wcardinal/ui/util/util-is-function.ts","wcardinal/ui/d-base-background.ts","wcardinal/ui/util/util-is-string.ts","wcardinal/ui/d-corner.ts","wcardinal/ui/d-base-border.ts","wcardinal/ui/util/util-is-number.ts","wcardinal/ui/d-base-interactive.ts","wcardinal/ui/d-base-corner.ts","wcardinal/ui/d-base-outline.ts","wcardinal/ui/d-base-state.ts","wcardinal/ui/d-base-padding.ts","wcardinal/ui/d-base-point.ts","wcardinal/ui/d-base-background-mesh-geometry.ts","wcardinal/ui/d-base-background-mesh.ts","wcardinal/ui/d-base-border-mesh-geometry.ts","wcardinal/ui/d-base-border-mesh.ts","wcardinal/ui/d-base-outline-mesh.ts","wcardinal/ui/util/util-to-svg-url.ts","wcardinal/ui/util/util-texture-plane.ts","wcardinal/ui/d-base-reflowable.ts","wcardinal/ui/d-base-states.ts","wcardinal/ui/d-command-flag.ts","wcardinal/ui/d-command-clear.ts","wcardinal/ui/d-scalar-expression.ts","wcardinal/ui/d-command-redo.ts","wcardinal/ui/d-command-undo.ts","wcardinal/ui/d-controller-default-command.ts","wcardinal/ui/d-controller-default-focus.ts","wcardinal/ui/util/util-keyboard-event.ts","wcardinal/ui/d-controller-keyboard.ts","wcardinal/ui/d-controllers.ts","wcardinal/ui/d-coordinates.ts","wcardinal/ui/d-scalar-functions.ts","wcardinal/ui/d-layout-clear-type.ts","wcardinal/ui/theme/d-themes.ts","wcardinal/ui/d-align-horizontal.ts","wcardinal/ui/d-align-vertical.ts","wcardinal/ui/d-align-with.ts","wcardinal/ui/util/util-name.ts","wcardinal/ui/util/util-pointer-event.ts","wcardinal/ui/d-base.ts","wcardinal/ui/d-dynamic-text-geometry.ts","wcardinal/ui/d-dynamic-text-style.ts","wcardinal/ui/util/ascii.ts","wcardinal/ui/util/dynamic-font-atlas-chaaracter-origin.ts","wcardinal/ui/util/dynamic-font-atlas-character.ts","wcardinal/ui/util/dynamic-font-atlas-font.ts","wcardinal/ui/util/dynamic-font-atlas.ts","wcardinal/ui/util/dynamic-font-atlases.ts","wcardinal/ui/d-dynamic-text.ts","wcardinal/ui/d-base-overflow-mask-simple.ts","wcardinal/ui/d-text-base.ts","wcardinal/ui/d-image-base.ts","wcardinal/ui/d-image.ts","wcardinal/ui/d-list-item.ts","wcardinal/ui/d-menu-item.ts","wcardinal/ui/d-menu-item-text.ts","wcardinal/ui/d-menu-item-check.ts","wcardinal/ui/d-menus.ts","wcardinal/ui/util/dynamic-atlas-item.ts","wcardinal/ui/util/dynamic-atlas-item-empty.ts","wcardinal/ui/util/dynamic-atlas-item-font-atlas.ts","wcardinal/ui/util/dynamic-atlas-item-image.ts","wcardinal/ui/util/dynamic-atlas-item-text.ts","wcardinal/ui/util/dynamic-atlas-item-white.ts","wcardinal/ui/util/dynamic-atlas.ts","wcardinal/ui/util/dynamic-sdf-font-generator.ts","wcardinal/ui/util/dynamic-sdf-font-atlas.ts","wcardinal/ui/util/dynamic-sdf-font-atlases.ts","wcardinal/ui/util/lazy.ts","wcardinal/ui/util/format-node/format-node-a-large.ts","wcardinal/ui/util/format-node/format-node-a-small.ts","wcardinal/ui/util/format-node/format-node-d-large.ts","wcardinal/ui/util/format-node/format-node-d-small.ts","wcardinal/ui/util/format-node/format-node-precision.ts","wcardinal/ui/util/format-node/format-node-e.ts","wcardinal/ui/util/format-node/format-node-f.ts","wcardinal/ui/util/format-node/format-node-fsi.ts","wcardinal/ui/util/format-node/format-node-g.ts","wcardinal/ui/util/format-node/format-node-h-large.ts","wcardinal/ui/util/format-node/format-node-h-small.ts","wcardinal/ui/util/format-node/format-node-m-large.ts","wcardinal/ui/util/format-node/format-node-m-small.ts","wcardinal/ui/util/format-node/format-node-mi.ts","wcardinal/ui/util/format-node/format-node-p-large.ts","wcardinal/ui/util/format-node/format-node-p-small.ts","wcardinal/ui/util/util-pad.ts","wcardinal/ui/util/format-node/format-node-padding.ts","wcardinal/ui/util/format-node/format-node-parenthesis.ts","wcardinal/ui/util/format-node/format-node-plus.ts","wcardinal/ui/util/format-node/format-node-rp-large.ts","wcardinal/ui/util/format-node/format-node-rp-small.ts","wcardinal/ui/util/format-node/format-node-sdt.ts","wcardinal/ui/util/format-node/format-node-space.ts","wcardinal/ui/util/format-node/format-node-ssi.ts","wcardinal/ui/util/format-node/format-node-string.ts","wcardinal/ui/util/format-node/format-node-y-large.ts","wcardinal/ui/util/format-node/format-node-y-small.ts","wcardinal/ui/util/format-node/format-node-z.ts","wcardinal/ui/util/format-node/format-noder-d.ts","wcardinal/ui/util/format-node/format-nodes.ts","wcardinal/ui/util/number-formatter-impl.ts","wcardinal/ui/util/number-formatters.ts","wcardinal/ui/util/util-alpha.ts","wcardinal/ui/resource/svg-resource.ts","wcardinal/ui/util/util-atlas-builder.ts","wcardinal/ui/util/util-attach.ts","wcardinal/ui/d-mouse-modifier.ts","wcardinal/ui/util/util-click-outside.ts","wcardinal/ui/util/util-clipboard.ts","wcardinal/ui/util/util-drag-easing-history.ts","wcardinal/ui/d-animation-timings.ts","wcardinal/ui/d-animation-base.ts","wcardinal/ui/util/util-drag-easing.ts","wcardinal/ui/d-mouse-modifiers.ts","wcardinal/ui/util/util-file-opener.ts","wcardinal/ui/util/util-drag.ts","wcardinal/ui/util/util-extractor.ts","wcardinal/ui/util/util-file-downloader.ts","wcardinal/ui/util/util-extract.ts","wcardinal/ui/d-menu-item-link.ts","wcardinal/ui/util/util-hsv.ts","wcardinal/ui/util/util-index-of.ts","wcardinal/ui/util/util-is-array.ts","wcardinal/ui/util/util-is-nan.ts","wcardinal/ui/util/util-promise.ts","wcardinal/ui/util/util-rgb.ts","wcardinal/ui/util/util-rgba.ts","wcardinal/ui/util/util-texture.ts","wcardinal/ui/util/util-to-string.ts","wcardinal/ui/util/util-transition.ts","wcardinal/ui/util/util-wheel-event.ts","wcardinal/ui/d-layout.ts","wcardinal/ui/d-menu-align.ts","wcardinal/ui/d-menu-item-menu.ts","wcardinal/ui/d-list-item-separator-reflowable.ts","wcardinal/ui/d-list-item-separator.ts","wcardinal/ui/d-menu-item-separator.ts","wcardinal/ui/d-layout-space.ts","wcardinal/ui/d-menu-item-space.ts","wcardinal/ui/load/load-menu-item.ts","wcardinal/ui/shape/e-shape-type.ts","wcardinal/ui/d-layout-vertical.ts","wcardinal/ui/d-menu-item-expandable-body.ts","wcardinal/ui/d-menu-item-expandable-header.ts","wcardinal/ui/d-menu-item-expandables.ts","wcardinal/ui/d-menu-item-expandable.ts","wcardinal/ui/d-menu-item-expandable-item-check.ts","wcardinal/ui/d-menu-item-expandable-item-link.ts","wcardinal/ui/d-menu-item-expandable-item-separator.ts","wcardinal/ui/d-menu-item-expandable-item-space.ts","wcardinal/ui/d-menu-item-expandable-item-text.ts","wcardinal/ui/load/load-menu-item-expandable.ts","wcardinal/ui/d-menu-sided-item-check.ts","wcardinal/ui/d-menu-sided-item-link.ts","wcardinal/ui/d-menu-sided-item-menu.ts","wcardinal/ui/d-menu-sided-item-separator.ts","wcardinal/ui/d-menu-sided-item-space.ts","wcardinal/ui/d-menu-sided-item-text.ts","wcardinal/ui/d-menu-sideds.ts","wcardinal/ui/load/load-menu-sided-item.ts","wcardinal/ui/d-menu-sided-item-expandables.ts","wcardinal/ui/d-menu-sided-item-expandable.ts","wcardinal/ui/d-menu-sided-item-expandable-item-check.ts","wcardinal/ui/d-menu-sided-item-expandable-item-link.ts","wcardinal/ui/d-menu-item-expandable-item-menu.ts","wcardinal/ui/d-menu-sided-item-expandable-item-menu.ts","wcardinal/ui/d-menu-sided-item-expandable-item-separator.ts","wcardinal/ui/d-menu-sided-item-expandable-item-space.ts","wcardinal/ui/d-menu-sided-item-expandable-item-text.ts","wcardinal/ui/load/load-menu-sided-item-expandable.ts","wcardinal/ui/load/load-menu-item-all.ts","wcardinal/ui/shape/e-shape-deserializers.ts","wcardinal/ui/shape/e-shape-uploadeds.ts","wcardinal/ui/shape/e-shape-points.ts","wcardinal/ui/shape/e-shape-points-style-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-bar-position.ts","wcardinal/ui/shape/variant/e-shape-bar-points.ts","wcardinal/ui/shape/e-shape-corner.ts","wcardinal/ui/shape/e-shape-stroke.ts","wcardinal/ui/shape/e-shape-defaults.ts","wcardinal/ui/shape/e-shape.ts","wcardinal/ui/shape/e-shape-runtime.ts","wcardinal/ui/shape/action/e-shape-action.ts","wcardinal/ui/shape/e-shape-tag-value.ts","wcardinal/ui/shape/e-shape-tag-value-range.ts","wcardinal/ui/shape/e-shape-transform.ts","wcardinal/ui/shape/variant/e-shape-gradients.ts","wcardinal/ui/shape/variant/e-shape-base.ts","wcardinal/ui/shape/variant/e-shape-fill-impl.ts","wcardinal/ui/shape/variant/e-shape-stroke-impl.ts","wcardinal/ui/shape/variant/e-shape-tag-value-range-impl.ts","wcardinal/ui/shape/e-shape-text.ts","wcardinal/ui/shape/e-shape-text-align-horizontal.ts","wcardinal/ui/shape/e-shape-text-align-vertical.ts","wcardinal/ui/shape/e-shape-text-direction.ts","wcardinal/ui/shape/variant/e-shape-tag-value-impl.ts","wcardinal/ui/shape/variant/e-shape-tag-impl.ts","wcardinal/ui/shape/variant/e-shape-text-align-impl.ts","wcardinal/ui/shape/action/e-shape-action-value-blink-type.ts","wcardinal/ui/shape/variant/e-shape-text-offset-impl.ts","wcardinal/ui/shape/variant/e-shape-text-outline-impl.ts","wcardinal/ui/shape/variant/e-shape-text-impl.ts","wcardinal/ui/shape/variant/e-shape-primitive.ts","wcardinal/ui/shape/variant/e-shape-line-base.ts","wcardinal/ui/shape/variant/e-shape-bar.ts","wcardinal/ui/shape/e-shape-uploaded.ts","wcardinal/ui/shape/variant/e-shape-text-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-text-uploaded.ts","wcardinal/ui/shape/variant/e-shape-bar-uploaded.ts","wcardinal/ui/shape/variant/e-shape-bar-uploadeds.ts","wcardinal/ui/shape/action/e-shape-action-bases.ts","wcardinal/ui/shape/action/e-shape-action-runtime.ts","wcardinal/ui/shape/action/e-shape-action-runtime-conditional.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-brighten.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-color-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-color-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-darken.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-opacity.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-visibility.ts","wcardinal/ui/shape/action/e-shape-action-value-base.ts","wcardinal/ui/shape/action/e-shape-action-value-type.ts","wcardinal/ui/shape/action/e-shape-action-value-subtyped.ts","wcardinal/ui/shape/action/e-shape-action-values.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-type.ts","wcardinal/ui/shape/action/e-shape-action-value-blink.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color.ts","wcardinal/ui/shape/action/e-shape-action-value-change-text-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-all.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-fill-and-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-text-outline.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-all.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-fill-and-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness-text-outline.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-brightness.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-all.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-fill-and-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code-text-outline.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-code.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-cursor.ts","wcardinal/ui/shape/action/e-shape-action-value-change-cursor.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-text-number.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-text-text.ts","wcardinal/ui/shape/action/e-shape-action-value-change-text.ts","wcardinal/ui/shape/action/e-shape-action-value-misc-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-emit-event.ts","wcardinal/ui/shape/action/e-shape-action-value-emit-event.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input-data.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input.ts","wcardinal/ui/shape/action/e-shape-action-value-misc.ts","wcardinal/ui/shape/action/e-shape-action-value-open-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-flow.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-page.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-page-inplace.ts","wcardinal/ui/shape/action/e-shape-action-value-open.ts","wcardinal/ui/shape/action/e-shape-action-value-show-hide-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-show-hide.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-move-type.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-type.ts","wcardinal/ui/shape/action/e-shape-action-value-show-hide.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-absolute-x.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-absolute-y.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-forward-or-backward.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-left-or-right.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-relative-x.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-relative-y.ts","wcardinal/ui/shape/action/e-shape-action-value-opetyped.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-move.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-resize-type.ts","wcardinal/ui/shape/e-shape-sizes.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-rotate-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-height-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-height-relative.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-size-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-size-relative.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-width-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-width-relative.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-resize.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate-relative.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-rotate.ts","wcardinal/ui/shape/e-shape-capability.ts","wcardinal/ui/shape/action/e-shape-action-value-deserializer.ts","wcardinal/ui/shape/e-shape-image-elements.ts","wcardinal/ui/shape/e-shape-resource-manager-deserialization.ts","wcardinal/ui/shape/e-shape-deserializer.ts","wcardinal/ui/shape/variant/e-shape-bars.ts","wcardinal/ui/load/load-shape-bar.ts","wcardinal/ui/shape/variant/e-shape-circle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-circle-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-circle.ts","wcardinal/ui/shape/variant/e-shape-circles.ts","wcardinal/ui/load/load-shape-circle.ts","wcardinal/ui/shape/variant/e-shape-group-uploaded.ts","wcardinal/ui/shape/variant/e-shape-group-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-group-fill-editor.ts","wcardinal/ui/shape/variant/e-shape-group-points.ts","wcardinal/ui/shape/e-shape-editor.ts","wcardinal/ui/shape/e-shape-transforms.ts","wcardinal/ui/shape/variant/e-shape-group-size-layout.ts","wcardinal/ui/shape/variant/e-shape-group-size-editor.ts","wcardinal/ui/shape/variant/e-shape-group-size-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-stroke-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-align-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-offset-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-outline-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-padding-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-spacing-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-editor.ts","wcardinal/ui/shape/variant/e-shape-group.ts","wcardinal/ui/shape/variant/e-shape-groups.ts","wcardinal/ui/load/load-shape-group.ts","wcardinal/ui/shape/variant/e-shape-group-size-shadowed.ts","wcardinal/ui/shape/variant/e-shape-group-shadowed.ts","wcardinal/ui/shape/variant/e-shape-group-shadoweds.ts","wcardinal/ui/load/load-shape-group-shadowed.ts","wcardinal/ui/shape/variant/e-shape-rectangle.ts","wcardinal/ui/shape/variant/e-shape-image.ts","wcardinal/ui/shape/variant/e-shape-images.ts","wcardinal/ui/shape/variant/e-shape-rectangle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-rectangle-uploadeds.ts","wcardinal/ui/load/load-shape-image.ts","wcardinal/ui/shape/variant/e-shape-label-uploaded.ts","wcardinal/ui/shape/variant/e-shape-label-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-label.ts","wcardinal/ui/shape/variant/e-shape-labels.ts","wcardinal/ui/load/load-shape-label.ts","wcardinal/ui/shape/variant/e-shape-line-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-line-points.ts","wcardinal/ui/shape/variant/e-shape-line.ts","wcardinal/ui/shape/variant/e-shape-lines.ts","wcardinal/ui/load/load-shape-line.ts","wcardinal/ui/shape/variant/e-shape-null-uploaded.ts","wcardinal/ui/shape/variant/e-shape-null-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-null.ts","wcardinal/ui/shape/variant/e-shape-nulls.ts","wcardinal/ui/load/load-shape-null.ts","wcardinal/ui/shape/e-shape-capabilities.ts","wcardinal/ui/shape/variant/e-shape-rectangles.ts","wcardinal/ui/load/load-shape-rectangle.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-rectangle-roundeds.ts","wcardinal/ui/load/load-shape-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-triangle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-triangle-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-triangle.ts","wcardinal/ui/shape/variant/e-shape-triangles.ts","wcardinal/ui/load/load-shape-triangle.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded-uploadeds.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-triangle-roundeds.ts","wcardinal/ui/load/load-shape-triangle-rounded.ts","wcardinal/ui/load/load-shape-all.ts","wcardinal/ui/theme/white/d-theme-white-atlas.ts","wcardinal/ui/theme/white/d-theme-white.ts","wcardinal/ui/load/load-theme-white.ts","wcardinal/ui/d-shadow-impl.ts","wcardinal/ui/theme/white/d-theme-white-constants.ts","wcardinal/ui/theme/white/d-theme-white-font.ts","wcardinal/ui/theme/white/d-theme-white-base.ts","wcardinal/ui/load/load-theme-white-base.ts","wcardinal/ui/theme/white/d-theme-white-board.ts","wcardinal/ui/load/load-theme-white-board.ts","wcardinal/ui/theme/white/d-theme-white-text-base.ts","wcardinal/ui/theme/white/d-theme-white-image-base.ts","wcardinal/ui/theme/white/d-theme-white-button-base.ts","wcardinal/ui/theme/white/d-theme-white-button.ts","wcardinal/ui/load/load-theme-white-button.ts","wcardinal/ui/theme/white/d-theme-white-button-ambient.ts","wcardinal/ui/load/load-theme-white-button-ambient.ts","wcardinal/ui/theme/white/d-theme-white-button-check.ts","wcardinal/ui/load/load-theme-white-button-check.ts","wcardinal/ui/theme/white/d-theme-white-button-check-right.ts","wcardinal/ui/load/load-theme-white-button-check-right.ts","wcardinal/ui/theme/white/d-theme-white-button-color.ts","wcardinal/ui/d-dialog.ts","wcardinal/ui/d-animation-fade-in.ts","wcardinal/ui/theme/white/d-theme-white-dialog.ts","wcardinal/ui/theme/white/d-theme-white-dialog-command.ts","wcardinal/ui/theme/white/d-theme-white-dialog-color.ts","wcardinal/ui/theme/white/d-theme-white-picker-color.ts","wcardinal/ui/load/load-theme-white-picker-color.ts","wcardinal/ui/load/load-theme-white-dialog-color.ts","wcardinal/ui/load/load-theme-white-button-color.ts","wcardinal/ui/d-picker-color-gradient-point.ts","wcardinal/ui/d-picker-color-gradient-data.ts","wcardinal/ui/theme/white/d-theme-white-button-color-gradient.ts","wcardinal/ui/d-picker-datetime-mask.ts","wcardinal/ui/theme/white/d-theme-white-dialog-color-gradient.ts","wcardinal/ui/theme/white/d-theme-white-picker-color-gradient.ts","wcardinal/ui/load/load-theme-white-picker-color-gradient.ts","wcardinal/ui/load/load-theme-white-dialog-color-gradient.ts","wcardinal/ui/load/load-theme-white-button-color-gradient.ts","wcardinal/ui/theme/white/d-theme-white-button-danger.ts","wcardinal/ui/load/load-theme-white-button-danger.ts","wcardinal/ui/d-picker-dates.ts","wcardinal/ui/theme/white/d-theme-white-button-date.ts","wcardinal/ui/theme/white/d-theme-white-dialog-date.ts","wcardinal/ui/theme/white/d-theme-white-picker-time.ts","wcardinal/ui/theme/white/d-theme-white-picker-datetime.ts","wcardinal/ui/theme/white/d-theme-white-picker-date.ts","wcardinal/ui/theme/white/d-theme-white-picker-datetime-button-back.ts","wcardinal/ui/theme/white/d-theme-white-picker-datetime-button-date.ts","wcardinal/ui/theme/white/d-theme-white-picker-datetime-button-next.ts","wcardinal/ui/theme/white/d-theme-white-text.ts","wcardinal/ui/theme/white/d-theme-white-picker-datetime-label.ts","wcardinal/ui/theme/white/d-theme-white-picker-datetime-label-date.ts","wcardinal/ui/theme/white/d-theme-white-picker-datetime-space.ts","wcardinal/ui/load/load-theme-white-picker-time.ts","wcardinal/ui/load/load-theme-white-picker-datetime.ts","wcardinal/ui/load/load-theme-white-picker-date.ts","wcardinal/ui/load/load-theme-white-dialog-date.ts","wcardinal/ui/load/load-theme-white-button-date.ts","wcardinal/ui/d-picker-times.ts","wcardinal/ui/d-picker-datetimes.ts","wcardinal/ui/theme/white/d-theme-white-button-datetime.ts","wcardinal/ui/theme/white/d-theme-white-dialog-datetime.ts","wcardinal/ui/load/load-theme-white-dialog-datetime.ts","wcardinal/ui/load/load-theme-white-button-datetime.ts","wcardinal/ui/theme/white/d-theme-white-button-file.ts","wcardinal/ui/load/load-theme-white-button-file.ts","wcardinal/ui/theme/white/d-theme-white-button-primary.ts","wcardinal/ui/load/load-theme-white-button-primary.ts","wcardinal/ui/theme/white/d-theme-white-button-radio.ts","wcardinal/ui/d-drag-mode.ts","wcardinal/ui/load/load-theme-white-button-radio.ts","wcardinal/ui/theme/white/d-theme-white-button-radio-right.ts","wcardinal/ui/load/load-theme-white-button-radio-right.ts","wcardinal/ui/theme/white/d-theme-white-button-secondary.ts","wcardinal/ui/load/load-theme-white-button-secondary.ts","wcardinal/ui/theme/white/d-theme-white-button-time.ts","wcardinal/ui/theme/white/d-theme-white-dialog-time.ts","wcardinal/ui/load/load-theme-white-dialog-time.ts","wcardinal/ui/load/load-theme-white-button-time.ts","wcardinal/ui/load/load-theme-white-button-all.ts","wcardinal/ui/theme/white/d-theme-white-canvas.ts","wcardinal/ui/theme/white/d-theme-white-canvas-container.ts","wcardinal/ui/d-chart-axis.ts","wcardinal/ui/load/load-theme-white-canvas-container.ts","wcardinal/ui/theme/white/d-theme-white-chart.ts","wcardinal/ui/shape/variant/e-shape-group-fill-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-stroke-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-align-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-offset-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-outline-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-padding-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-spacing-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-viewer.ts","wcardinal/ui/shape/e-shape-buffer-count.ts","wcardinal/ui/shape/e-shape-buffer-unit.ts","wcardinal/ui/shape/e-shape-buffer-unit-builder.ts","wcardinal/ui/shape/e-shape-buffer.ts","wcardinal/ui/shape/e-shape-renderer-iterator-datum.ts","wcardinal/ui/shape/e-shape-renderer-iterator.ts","wcardinal/ui/shape/e-shape-renderer.ts","wcardinal/ui/shape/e-shape-container.ts","wcardinal/ui/shape/e-shape-search.ts","wcardinal/ui/shape/e-shape-deleter.ts","wcardinal/ui/shape/e-shape-resource-manager-serialization.ts","wcardinal/ui/shape/e-shape-runtimes.ts","wcardinal/ui/theme/white/d-theme-white-chart-axis-base.ts","wcardinal/ui/theme/white/d-theme-white-chart-axis-x.ts","wcardinal/ui/theme/white/d-theme-white-chart-axis-y.ts","wcardinal/ui/theme/white/d-theme-white-chart-coordinate-linear.ts","wcardinal/ui/theme/white/d-theme-white-diagram-base.ts","wcardinal/ui/theme/white/d-theme-white-diagram.ts","wcardinal/ui/theme/white/d-theme-white-diagram-canvas-base.ts","wcardinal/ui/theme/white/d-theme-white-diagram-canvas.ts","wcardinal/ui/load/load-theme-white-diagram.ts","wcardinal/ui/theme/white/d-theme-white-diagram-canvas-editor.ts","wcardinal/ui/theme/white/d-theme-white-diagram-editor.ts","wcardinal/ui/theme/white/e-theme-white-shape-action-value.ts","wcardinal/ui/load/load-theme-white-shape-action-value.ts","wcardinal/ui/load/load-theme-white-diagram-editor.ts","wcardinal/ui/load/load-theme-white-dialog.ts","wcardinal/ui/load/load-theme-white-dialog-command.ts","wcardinal/ui/theme/white/d-theme-white-dialog-confirm.ts","wcardinal/ui/theme/white/d-theme-white-image.ts","wcardinal/ui/theme/white/d-theme-white-dialog-confirm-message.ts","wcardinal/ui/load/load-theme-white-dialog-confirm.ts","wcardinal/ui/theme/white/d-theme-white-dialog-confirm-delete.ts","wcardinal/ui/load/load-theme-white-dialog-confirm-delete.ts","wcardinal/ui/theme/white/d-theme-white-dialog-confirm-discard.ts","wcardinal/ui/load/load-theme-white-dialog-confirm-discard.ts","wcardinal/ui/theme/white/d-theme-white-dialog-input-text.ts","wcardinal/ui/load/load-theme-white-dialog-input-text.ts","wcardinal/ui/theme/white/d-theme-white-dialog-message.ts","wcardinal/ui/load/load-theme-white-dialog-message.ts","wcardinal/ui/theme/white/d-theme-white-dialog-processing.ts","wcardinal/ui/theme/white/d-theme-white-dialog-processing-message.ts","wcardinal/ui/load/load-theme-white-dialog-processing.ts","wcardinal/ui/theme/white/d-theme-white-dialog-save-as.ts","wcardinal/ui/load/load-theme-white-dialog-save-as.ts","wcardinal/ui/theme/white/d-theme-white-dialog-select.ts","wcardinal/ui/theme/white/d-theme-white-pane.ts","wcardinal/ui/theme/white/d-theme-white-list.ts","wcardinal/ui/theme/white/d-theme-white-dialog-select-list.ts","wcardinal/ui/theme/white/d-theme-white-list-item.ts","wcardinal/ui/theme/white/d-theme-white-dialog-select-list-item.ts","wcardinal/ui/load/load-theme-white-dialog-select.ts","wcardinal/ui/load/load-theme-white-dialog-all.ts","wcardinal/ui/theme/white/d-theme-white-dropdown.ts","wcardinal/ui/theme/white/d-theme-white-layout.ts","wcardinal/ui/theme/white/d-theme-white-layout-vertical.ts","wcardinal/ui/theme/white/d-theme-white-menu.ts","wcardinal/ui/theme/white/d-theme-white-menu-item.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-text.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-check.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-body.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-header.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-item-check.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-link.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-item-link.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-menu.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-item-menu.ts","wcardinal/ui/theme/white/d-theme-white-list-item-separator.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-separator.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-item-separator.ts","wcardinal/ui/theme/white/d-theme-white-layout-space.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-space.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-item-space.ts","wcardinal/ui/theme/white/d-theme-white-menu-item-expandable-item-text.ts","wcardinal/ui/load/load-theme-white-menu.ts","wcardinal/ui/load/load-theme-white-dropdown.ts","wcardinal/ui/theme/white/d-theme-white-expandable.ts","wcardinal/ui/theme/white/d-theme-white-expandable-header.ts","wcardinal/ui/snapper/e-snapper-target-value.ts","wcardinal/ui/load/load-theme-white-expandable.ts","wcardinal/ui/load/load-theme-white-image.ts","wcardinal/ui/theme/white/d-theme-white-layout-horizontal.ts","wcardinal/ui/theme/white/d-theme-white-input-and-label.ts","wcardinal/ui/load/load-theme-white-input-and-label.ts","wcardinal/ui/theme/white/d-theme-white-input.ts","wcardinal/ui/theme/white/d-theme-white-input-number.ts","wcardinal/ui/theme/white/d-theme-white-input-integer.ts","wcardinal/ui/load/load-theme-white-input-integer.ts","wcardinal/ui/theme/white/d-theme-white-input-label.ts","wcardinal/ui/load/load-theme-white-input-label.ts","wcardinal/ui/theme/white/d-theme-white-input-real.ts","wcardinal/ui/load/load-theme-white-input-real.ts","wcardinal/ui/theme/white/d-theme-white-input-text.ts","wcardinal/ui/load/load-theme-white-input-text.ts","wcardinal/ui/load/load-theme-white-input-all.ts","wcardinal/ui/load/load-theme-white-layout.ts","wcardinal/ui/load/load-theme-white-list.ts","wcardinal/ui/theme/white/d-theme-white-menu-bar.ts","wcardinal/ui/theme/white/d-theme-white-menu-bar-item.ts","wcardinal/ui/load/load-theme-white-menu-bar.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-content.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-check.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-expandable.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-expandable-item-check.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-expandable-item-link.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-expandable-item-menu.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-expandable-item-separator.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-expandable-item-space.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-expandable-item-text.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-link.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-menu.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-separator.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-space.ts","wcardinal/ui/theme/white/d-theme-white-menu-sided-item-text.ts","wcardinal/ui/load/load-theme-white-menu-sided.ts","wcardinal/ui/theme/white/d-theme-white-note.ts","wcardinal/ui/load/load-theme-white-note.ts","wcardinal/ui/theme/white/d-theme-white-content.ts","wcardinal/ui/theme/white/d-theme-white-scroll-bar.ts","wcardinal/ui/theme/white/d-theme-white-scroll-bar-thumb.ts","wcardinal/ui/load/load-theme-white-scroll-bar.ts","wcardinal/ui/load/load-theme-white-pane.ts","wcardinal/ui/theme/white/d-theme-white-select.ts","wcardinal/ui/load/load-theme-white-select.ts","wcardinal/ui/theme/white/d-theme-white-table.ts","wcardinal/ui/theme/white/d-theme-white-table-body.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cells.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-check.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-color.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-date.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-datetime.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-index.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-input-integer.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-input-real.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-input-text.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-select-dialog.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-select-fetcher.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-select-menu.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-text.ts","wcardinal/ui/theme/white/d-theme-white-table-body-cell-time.ts","wcardinal/ui/theme/white/d-theme-white-table-row.ts","wcardinal/ui/theme/white/d-theme-white-table-body-row.ts","wcardinal/ui/theme/white/d-theme-white-table-body-row-even.ts","wcardinal/ui/theme/white/d-theme-white-table-body-row-odd.ts","wcardinal/ui/theme/white/d-theme-white-table-header.ts","wcardinal/ui/theme/white/d-theme-white-table-header-cell.ts","wcardinal/ui/load/load-theme-white-table.ts","wcardinal/ui/load/load-theme-white-text.ts","wcardinal/ui/load/load-theme-white-all.ts","wcardinal/ui/load/load-theme-white-chart.ts","wcardinal/ui/load/load-all.ts","wcardinal/ui/snapper/e-snapper-grid.ts","wcardinal/ui/snapper/e-snapper-result.ts","wcardinal/ui/snapper/e-snapper.ts","wcardinal/ui/snapper/e-snapper-target.ts","wcardinal/ui/d-animation-empty.ts","wcardinal/ui/d-application-padding.ts","wcardinal/ui/d-application-options.ts","wcardinal/ui/d-application.ts","wcardinal/ui/d-chart-coordinate.ts","wcardinal/ui/d-board.ts","wcardinal/ui/d-button-base.ts","wcardinal/ui/d-button.ts","wcardinal/ui/d-button-ambient.ts","wcardinal/ui/d-button-check.ts","wcardinal/ui/d-button-check-right.ts","wcardinal/ui/d-button-primary.ts","wcardinal/ui/d-layout-horizontal.ts","wcardinal/ui/d-dialog-command.ts","wcardinal/ui/d-input.ts","wcardinal/ui/d-input-number.ts","wcardinal/ui/d-input-real.ts","wcardinal/ui/d-text.ts","wcardinal/ui/d-input-label.ts","wcardinal/ui/d-input-and-label.ts","wcardinal/ui/d-input-real-and-label.ts","wcardinal/ui/d-input-text.ts","wcardinal/ui/d-input-text-and-label.ts","wcardinal/ui/d-picker-color-and-alpha.ts","wcardinal/ui/d-picker-color-recent.ts","wcardinal/ui/d-picker-color.ts","wcardinal/ui/d-picker-color-gradient-data-view.ts","wcardinal/ui/d-picker-color-gradient-recent.ts","wcardinal/ui/d-picker-color-gradient.ts","wcardinal/ui/d-dialog-color-gradient.ts","wcardinal/ui/d-button-color-gradient.ts","wcardinal/ui/d-dialog-color.ts","wcardinal/ui/d-button-color.ts","wcardinal/ui/d-button-danger.ts","wcardinal/ui/d-picker-datetime-button-back.ts","wcardinal/ui/d-picker-datetime-button-date.ts","wcardinal/ui/d-picker-datetime-button-next.ts","wcardinal/ui/d-picker-datetime-label.ts","wcardinal/ui/d-picker-datetime-label-date.ts","wcardinal/ui/d-picker-datetime-space.ts","wcardinal/ui/d-input-integer.ts","wcardinal/ui/d-picker-time-bound.ts","wcardinal/ui/d-picker-time-bound-hours.ts","wcardinal/ui/d-picker-time-bound-minutes.ts","wcardinal/ui/d-picker-time-bound-seconds.ts","wcardinal/ui/d-picker-time-bounds.ts","wcardinal/ui/d-picker-time.ts","wcardinal/ui/d-picker-datetime.ts","wcardinal/ui/d-picker-date.ts","wcardinal/ui/d-dialog-date.ts","wcardinal/ui/d-dialog-dates.ts","wcardinal/ui/d-button-date.ts","wcardinal/ui/d-dialog-datetime.ts","wcardinal/ui/d-dialog-datetimes.ts","wcardinal/ui/d-button-datetime.ts","wcardinal/ui/d-button-file.ts","wcardinal/ui/d-button-group.ts","wcardinal/ui/d-button-radio.ts","wcardinal/ui/d-button-radio-right.ts","wcardinal/ui/d-button-redo.ts","wcardinal/ui/d-button-secondary.ts","wcardinal/ui/d-dialog-time.ts","wcardinal/ui/d-dialog-times.ts","wcardinal/ui/d-button-time.ts","wcardinal/ui/d-button-undo.ts","wcardinal/ui/d-base-overflow-mask.ts","wcardinal/ui/d-canvas-container-view-drag.ts","wcardinal/ui/d-canvas-container-view-transform.ts","wcardinal/ui/d-canvas-container-view.ts","wcardinal/ui/d-canvas-container.ts","wcardinal/ui/d-canvas.ts","wcardinal/ui/d-chart-axis-base-options.ts","wcardinal/ui/d-chart-axis-base.ts","wcardinal/ui/d-chart-axis-container-impl.ts","wcardinal/ui/d-chart-axis-x.ts","wcardinal/ui/d-chart-axis-y.ts","wcardinal/ui/d-chart-color-set.ts","wcardinal/ui/d-chart-coordinate-container-sub-impl.ts","wcardinal/ui/d-chart-plot-area.ts","wcardinal/ui/d-chart-coordinate-container-impl.ts","wcardinal/ui/d-chart-region-impl-observable.ts","wcardinal/ui/d-chart-coordinate-linear.ts","wcardinal/ui/d-chart-region-impl.ts","wcardinal/ui/d-chart-series-stroke-impl.ts","wcardinal/ui/d-chart-series-container-impl.ts","wcardinal/ui/d-chart-plot-area-impl.ts","wcardinal/ui/d-chart-series-line.ts","wcardinal/ui/d-list-selection.ts","wcardinal/ui/d-chart.ts","wcardinal/ui/d-command-create.ts","wcardinal/ui/d-command-delete.ts","wcardinal/ui/d-command-save-as.ts","wcardinal/ui/d-command-save.ts","wcardinal/ui/d-content.ts","wcardinal/ui/d-diagram-canvas-mapping-point-impl.ts","wcardinal/ui/d-diagram-canvas-mapping-impl.ts","wcardinal/ui/d-diagram-canvas-tile.ts","wcardinal/ui/d-diagram-layer.ts","wcardinal/ui/d-diagram-layer-container.ts","wcardinal/ui/d-diagram-canvas-base.ts","wcardinal/ui/d-diagram-canvas-editor.ts","wcardinal/ui/d-diagram-serialized.ts","wcardinal/ui/d-diagram-canvas.ts","wcardinal/ui/d-diagrams.ts","wcardinal/ui/d-diagram-base.ts","wcardinal/ui/d-diagram-editor.ts","wcardinal/ui/d-diagram.ts","wcardinal/ui/d-dialog-confirm-message.ts","wcardinal/ui/d-dialog-confirm.ts","wcardinal/ui/d-dialog-confirm-delete.ts","wcardinal/ui/d-dialog-confirm-discard.ts","wcardinal/ui/d-dialog-input-text.ts","wcardinal/ui/d-dialog-message.ts","wcardinal/ui/d-dialog-processing-message.ts","wcardinal/ui/d-dialog-processing.ts","wcardinal/ui/d-dialog-save-as.ts","wcardinal/ui/d-dialog-select-list-item.ts","wcardinal/ui/d-scroll-bar.ts","wcardinal/ui/d-scroll-bar-thumb.ts","wcardinal/ui/d-scroll-bar-thumb-reflowable-horizontal.ts","wcardinal/ui/d-scroll-bar-thumb-horizontal.ts","wcardinal/ui/d-scroll-bar-horizontal.ts","wcardinal/ui/d-scroll-bar-thumb-reflowable-vertical.ts","wcardinal/ui/d-scroll-bar-thumb-vertical.ts","wcardinal/ui/d-scroll-bar-vertical.ts","wcardinal/ui/d-pane.ts","wcardinal/ui/d-list.ts","wcardinal/ui/d-dialog-select-list.ts","wcardinal/ui/d-note.ts","wcardinal/ui/d-dialog-select.ts","wcardinal/ui/d-menu-context.ts","wcardinal/ui/d-menu.ts","wcardinal/ui/d-dropdown.ts","wcardinal/ui/d-menu-sided-selection.ts","wcardinal/ui/d-expandable-header.ts","wcardinal/ui/d-expandable.ts","wcardinal/ui/d-input-integer-and-label.ts","wcardinal/ui/d-map-coordinate-epsg3857.ts","wcardinal/ui/d-map-coordinates.ts","wcardinal/ui/d-map-tile.ts","wcardinal/ui/d-map-tile-plane.ts","wcardinal/ui/d-map-tile-pyramid-impl.ts","wcardinal/ui/d-map-tiles.ts","wcardinal/ui/d-menu-bar-item.ts","wcardinal/ui/d-menu-bar-blocker.ts","wcardinal/ui/d-menu-bar.ts","wcardinal/ui/d-menu-sided-content.ts","wcardinal/ui/d-table-column.ts","wcardinal/ui/d-menu-sided.ts","wcardinal/ui/d-notification.ts","wcardinal/ui/d-pagination.ts","wcardinal/ui/d-picker-datetime-range.ts","wcardinal/ui/d-picker-time-range.ts","wcardinal/ui/d-select.ts","wcardinal/ui/d-slider-range.ts","wcardinal/ui/d-slider.ts","wcardinal/ui/d-table-body-cell-check.ts","wcardinal/ui/d-table-body-cell-color.ts","wcardinal/ui/d-table-body-cell-index.ts","wcardinal/ui/d-table-body-cell-input-integer.ts","wcardinal/ui/d-table-body-cell-input-real.ts","wcardinal/ui/d-table-body-cell-input-text.ts","wcardinal/ui/d-table-body-cell-select-dialog.ts","wcardinal/ui/d-table-body-cell-select-fetcher.ts","wcardinal/ui/d-table-body-cell-select-menu.ts","wcardinal/ui/d-table-body-cell-text.ts","wcardinal/ui/d-table-body-filter.ts","wcardinal/ui/d-table-body-cell-date.ts","wcardinal/ui/d-table-body-cell-datetime.ts","wcardinal/ui/d-table-body-cell-time.ts","wcardinal/ui/d-table-row.ts","wcardinal/ui/d-table-selection.ts","wcardinal/ui/d-table-body-row.ts","wcardinal/ui/d-table-body-row-even.ts","wcardinal/ui/d-table-body-row-odd.ts","wcardinal/ui/d-table-body.ts","wcardinal/ui/d-table-header-cell.ts","wcardinal/ui/d-table-header.ts","wcardinal/ui/d-table.ts","wcardinal/ui/d-tree.ts","wcardinal/ui/snapper/e-snapper-result-scale.ts","wcardinal/ui/util/util-ceiling-index.ts","wcardinal/ui/util/util-to-svg-texture.ts","wcardinal-ui.browser.ts"],"sourcesContent":["/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport function __exportStar(m, exports) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\n\r\nexport function __values(o) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator], i = 0;\r\n    if (m) return m.call(o);\r\n    return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (Object.hasOwnProperty.call(mod, k)) result[k] = mod[k];\r\n    result.default = mod;\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplication } from \"./d-application\";\n\nexport class DApplications {\n\tprotected static INSTANCE: DApplication | null = null;\n\n\tstatic setInstace( instance: DApplication ): DApplication | null {\n\t\tconst result = DApplications.INSTANCE;\n\t\tDApplications.INSTANCE = instance;\n\t\treturn result;\n\t}\n\n\tstatic getInstance(): DApplication {\n\t\tif( DApplications.INSTANCE == null ) {\n\t\t\tthrow new Error( \"Must create a DApplication instance at first\" );\n\t\t}\n\t\treturn DApplications.INSTANCE;\n\t}\n\n\tstatic update(): void {\n\t\tthis.getInstance().update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport enum DBorderMask {\n\tNONE = 0,\n\n\tTOP = 1,\n\tRIGHT = 2,\n\tBOTTOM = 4,\n\tLEFT = 8,\n\n\tTOP_RIGHT = TOP | RIGHT,\n\tTOP_BOTTOM = TOP | BOTTOM,\n\tTOP_LEFT = TOP | LEFT,\n\n\tRIGHT_BOTTOM = RIGHT | BOTTOM,\n\tRIGHT_LEFT = RIGHT | LEFT,\n\n\tBOTTOM_LEFT = BOTTOM | LEFT,\n\n\tNOT_TOP = RIGHT | BOTTOM | LEFT,\n\tNOT_RIGHT = TOP | BOTTOM | LEFT,\n\tNOT_BOTTOM = TOP | RIGHT | LEFT,\n\tNOT_LEFT = TOP | RIGHT | BOTTOM,\n\n\tALL = TOP | RIGHT | BOTTOM | LEFT\n}\n\nexport interface DBorder {\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\talpha?: DStateAwareOrValueMightBe<number>;\n\twidth?: DStateAwareOrValueMightBe<number>;\n\talign?: DStateAwareOrValueMightBe<number>;\n\tmask?: DStateAwareOrValueMightBe<DBorderMask>;\n}\n\nexport interface DBorderStateAware extends DBorder {\n\tgetTheme(): DThemeBase;\n\tsetTheme( theme: DThemeBase ): void;\n\tgetColor( state: DBaseState ): number | null;\n\tgetAlpha( state: DBaseState ): number;\n\tgetWidth( state: DBaseState ): number;\n\tgetAlign( state: DBaseState ): number;\n\tgetMask( state: DBaseState ): DBorderMask;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilIsFunction = ( target: unknown ): target is Function => {\n\treturn (typeof target) === \"function\";\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBackgroundStateAware } from \"./d-background\";\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { utilIsFunction } from \"./util/util-is-function\";\n\ntype Callback = () => void;\n\nexport class DBaseBackground implements DBackgroundStateAware {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.background != null ) {\n\t\t\tconst background = options.background;\n\t\t\tthis._color = background.color;\n\t\t\tthis._alpha = background.alpha;\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseState ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( utilIsFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBackgroundColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( utilIsFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBackgroundAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tconst callback = this._callback;\n\t\tif( callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilIsString = ( target: unknown ): target is string => {\n\treturn ( typeof target === \"string\" ) ||\n\t\t( Object.prototype.toString.call( target ) === \"[object String]\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeBase } from \"./d-base\";\n\nexport enum DCornerMask {\n\tNONE = 0,\n\tTOP_LEFT = 1,\n\tTOP_RIGHT = 2,\n\tBOTTOM_LEFT = 4,\n\tBOTTOM_RIGHT = 8,\n\tTOP = TOP_LEFT | TOP_RIGHT,\n\tBOTTOM = BOTTOM_LEFT | BOTTOM_RIGHT,\n\tLEFT = TOP_LEFT | BOTTOM_LEFT,\n\tRIGHT = TOP_RIGHT | BOTTOM_RIGHT,\n\tALL = TOP_LEFT | TOP_RIGHT | BOTTOM_LEFT | BOTTOM_RIGHT\n}\n\nexport interface DCornerLike {\n\tradius?: number;\n\tmask?: DCornerMask;\n}\n\nexport interface DCorner extends DCornerLike {\n\tset( radius: number, mask: DCornerMask ): void;\n\tgetTheme(): DThemeBase;\n\tsetTheme( theme: DThemeBase ): void;\n\tgetRadius(): number;\n\tgetMask(): DCornerMask;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBorderMask, DBorderStateAware } from \"./d-border\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { utilIsFunction } from \"./util/util-is-function\";\nimport { utilIsString } from \"./util/util-is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseBorder implements DBorderStateAware {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _width?: DStateAwareOrValueMightBe<number>;\n\tprotected _align?: DStateAwareOrValueMightBe<number>;\n\tprotected _mask?: DStateAwareOrValueMightBe<DBorderMask>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.border != null ) {\n\t\t\tconst border = options.border;\n\t\t\tthis._color = border.color;\n\t\t\tthis._alpha = border.alpha;\n\t\t\tthis._width = border.width;\n\t\t\tthis._align = border.align;\n\t\t\tthis._mask = ( utilIsString( border.mask ) ? DBorderMask[ border.mask ] : border.mask );\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseState ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( utilIsFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( utilIsFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetWidth( state: DBaseState ): number {\n\t\tconst width = this._width;\n\t\tif( width !== undefined ) {\n\t\t\tif( utilIsFunction( width ) ) {\n\t\t\t\tconst result = width( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderWidth( state );\n\t}\n\n\tget width(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._width;\n\t}\n\n\tset width( width: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlign( state: DBaseState ): number {\n\t\tconst align = this._align;\n\t\tif( align !== undefined ) {\n\t\t\tif( utilIsFunction( align ) ) {\n\t\t\t\tconst result = align( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn align;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderAlign( state );\n\t}\n\n\tget align(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._align;\n\t}\n\n\tset align( align: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetMask( state: DBaseState ): number {\n\t\tconst mask = this._mask;\n\t\tif( mask !== undefined ) {\n\t\t\tif( utilIsFunction( mask ) ) {\n\t\t\t\tconst result = mask( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn mask;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderMask( state );\n\t}\n\n\tget mask(): DStateAwareOrValueMightBe<DBorderMask> {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DStateAwareOrValueMightBe<DBorderMask> ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tconst callback = this._callback;\n\t\tif( callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilIsNumber = ( target: unknown ): target is number => {\n\treturn ( typeof target === \"number\" ) ||\n\t\t( Object.prototype.toString.call( target ) === \"[object Number]\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DBaseInteractive {\n\tNONE = 0,\n\tSELF = 1,\n\tCHILDREN = 2,\n\tBOTH = 3\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DCorner, DCornerMask } from \"./d-corner\";\nimport { utilIsNumber } from \"./util/util-is-number\";\nimport { utilIsString } from \"./util/util-is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseCorner implements DCorner {\n\tprotected _theme: DThemeBase;\n\tprotected _radius?: number;\n\tprotected _mask?: DCornerMask;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: () => void ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.corner != null ) {\n\t\t\tconst corner = options.corner;\n\t\t\tif( utilIsNumber( corner ) ) {\n\t\t\t\tthis._radius = corner;\n\t\t\t\tthis._mask = undefined;\n\t\t\t} else {\n\t\t\t\tthis._radius = corner.radius;\n\t\t\t\tthis._mask = ( utilIsString( corner.mask ) ? DCornerMask[ corner.mask ] : corner.mask );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetRadius(): number {\n\t\tconst radius = this._radius;\n\t\treturn ( radius !== undefined ? radius : this._theme.getCornerRadius() );\n\t}\n\n\tget radius(): number | undefined {\n\t\treturn this._radius;\n\t}\n\n\tset radius( radius: number | undefined ) {\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMask(): DCornerMask {\n\t\tconst mask = this._mask;\n\t\treturn ( mask !== undefined ? mask : this._theme.getCornerMask() );\n\t}\n\n\tget mask(): DCornerMask | undefined {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DCornerMask | undefined ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tset( radius?: number, mask?: DCornerMask ): void {\n\t\tlet isChanged = false;\n\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tconst callback = this._callback;\n\t\tif( isChanged && callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBorderMask } from \"./d-border\";\nimport { DOutline } from \"./d-outline\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { utilIsFunction } from \"./util/util-is-function\";\nimport { utilIsString } from \"./util/util-is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseOutline implements DOutline {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _width?: DStateAwareOrValueMightBe<number>;\n\tprotected _offset?: DStateAwareOrValueMightBe<number>;\n\tprotected _align?: DStateAwareOrValueMightBe<number>;\n\tprotected _mask?: DStateAwareOrValueMightBe<DBorderMask>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.outline != null ) {\n\t\t\tconst outline = options.outline;\n\t\t\tthis._color = outline.color;\n\t\t\tthis._alpha = outline.alpha;\n\t\t\tthis._width = outline.width;\n\t\t\tthis._offset = outline.offset;\n\t\t\tthis._align = outline.align;\n\t\t\tthis._mask = ( utilIsString( outline.mask ) ? DBorderMask[ outline.mask ] : outline.mask );\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseState ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( utilIsFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( utilIsFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWidth( state: DBaseState ): number {\n\t\tconst width = this._width;\n\t\tif( width !== undefined ) {\n\t\t\tif( utilIsFunction( width ) ) {\n\t\t\t\tconst result = width( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineWidth( state );\n\t}\n\n\tget width(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._width;\n\t}\n\n\tset width( width: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset( state: DBaseState ): number {\n\t\tconst offset = this._offset;\n\t\tif( offset !== undefined ) {\n\t\t\tif( utilIsFunction( offset ) ) {\n\t\t\t\tconst result = offset( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn offset;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineOffset( state );\n\t}\n\n\tget offset(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._offset;\n\t}\n\n\tset offset( offset: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._offset !== offset ) {\n\t\t\tthis._offset = offset;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAlign( state: DBaseState ): number {\n\t\tconst align = this._align;\n\t\tif( align !== undefined ) {\n\t\t\tif( utilIsFunction( align ) ) {\n\t\t\t\tconst result = align( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn align;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineAlign( state );\n\t}\n\n\tget align(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._align;\n\t}\n\n\tset align( align: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMask( state: DBaseState ): number {\n\t\tconst mask = this._mask;\n\t\tif( mask !== undefined ) {\n\t\t\tif( utilIsFunction( mask ) ) {\n\t\t\t\tconst result = mask( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn mask;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineMask( state );\n\t}\n\n\tget mask(): DStateAwareOrValueMightBe<DBorderMask> {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DStateAwareOrValueMightBe<DBorderMask> ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DBaseState {\n\tNONE\t\t= 0,\n\tHOVERED\t\t= 1 << 0,\n\tACTIVE\t\t= 1 << 1,\n\tACTIVE_IN\t= 1 << 2,\n\tFOCUSED\t\t= 1 << 3,\n\tFOCUSED_IN\t= 1 << 4,\n\tUNFOCUSABLE\t= 1 << 5,\n\tFOCUS_ROOT\t= 1 << 6,\n\tREAD_ONLY\t= 1 << 7,\n\tDISABLED\t= 1 << 8,\n\tDRAGGING\t= 1 << 9,\n\tPRESSED\t\t= 1 << 10,\n\tINVALID\t\t= 1 << 11,\n\tSUCCEEDED\t= 1 << 12,\n\tFAILED\t\t= 1 << 13,\n\n\tEXTENSION_0\t= 1 << 20,\n\tEXTENSION_1\t= 1 << 21,\n\tEXTENSION_2\t= 1 << 22,\n\tEXTENSION_3\t= 1 << 23,\n\n\tCUSTOM\t\t= 1 << 24\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DPadding } from \"./d-padding\";\nimport { utilIsNumber } from \"./util/util-is-number\";\n\ntype Callback = () => void;\n\nexport class DBasePadding implements DPadding {\n\tprotected _theme: DThemeBase;\n\tprotected _left?: number;\n\tprotected _top?: number;\n\tprotected _right?: number;\n\tprotected _bottom?: number;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: () => void ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\n\t\tif( options != null && options.padding != null ) {\n\t\t\tconst padding = options.padding;\n\t\t\tif( utilIsNumber( padding ) ) {\n\t\t\t\tthis._left = padding;\n\t\t\t\tthis._top = padding;\n\t\t\t\tthis._right = padding;\n\t\t\t\tthis._bottom = padding;\n\t\t\t} else {\n\t\t\t\tthis._left = padding.left;\n\t\t\t\tthis._top = padding.top;\n\t\t\t\tthis._right = padding.right;\n\t\t\t\tthis._bottom = padding.bottom;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetLeft(): number {\n\t\tconst left = this._left;\n\t\treturn left !== undefined ? left : this._theme.getPaddingLeft();\n\t}\n\n\tget left(): number | undefined {\n\t\treturn this._left;\n\t}\n\n\tset left( left: number | undefined ) {\n\t\tif( this._left !== left ) {\n\t\t\tthis._left = left;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTop(): number {\n\t\tconst top = this._top;\n\t\treturn top !== undefined ? top : this._theme.getPaddingTop();\n\t}\n\n\tget top(): number | undefined {\n\t\treturn this._top;\n\t}\n\n\tset top( top: number | undefined ) {\n\t\tif( this._top !== top ) {\n\t\t\tthis._top = top;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRight(): number {\n\t\tconst right = this._right;\n\t\treturn right !== undefined ? right : this._theme.getPaddingRight();\n\t}\n\n\tget right(): number | undefined {\n\t\treturn this._right;\n\t}\n\n\tset right( right: number | undefined ) {\n\t\tif( this._right !== right ) {\n\t\t\tthis._right = right;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBottom(): number {\n\t\tconst bottom = this._bottom;\n\t\treturn bottom !== undefined ? bottom : this._theme.getPaddingBottom();\n\t}\n\n\tget bottom(): number | undefined {\n\t\treturn this._bottom;\n\t}\n\n\tset bottom( bottom: number | undefined ) {\n\t\tif( this._bottom !== bottom ) {\n\t\t\tthis._bottom = bottom;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tset( padding: number ): void;\n\tset( topAndBottom: number, leftAndRight: number ): void;\n\tset( top: number, leftAndRight: number, bottom: number ): void;\n\tset( top: number, right?: number, bottom?: number, left?: number ) {\n\t\tif( right == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = top;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = top;\n\t\t} else if( bottom == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = right;\n\t\t} else if( left == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = right;\n\t\t} else {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = left;\n\t\t}\n\t\tif( this._callback != null ) {\n\t\t\tthis._callback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\n\ntype Callback = () => any;\n\nexport class DBasePoint {\n\tprotected _point: IPoint;\n\tcb: Callback;\n\tscope: any;\n\n\tconstructor( point: IPoint, cb: Callback, scope?: any ) {\n\t\tthis._point = point;\n\t\tthis.cb = cb;\n\t}\n\n\tget x() {\n\t\treturn this._point.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst point = this._point;\n\t\tif( point.x !== x ) {\n\t\t\tpoint.x = x;\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t}\n\n\tget y() {\n\t\treturn this._point.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst point = this._point;\n\t\tif( point.y !== y ) {\n\t\t\tpoint.y = y;\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t}\n\n\tset( x: number, y: number ) {\n\t\tconst point = this._point;\n\t\tif( point.x !== x || point.y !== y ) {\n\t\t\tpoint.set( x, y );\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t}\n\n\tcopyFrom( target: IPoint ): this {\n\t\tconst point = this._point;\n\t\tif( point.x !== target.x || point.y !== target.y ) {\n\t\t\tpoint.copyFrom( target );\n\t\t\tthis.cb.call( this.scope );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( target: IPoint ): IPoint {\n\t\treturn target.copyFrom( this._point );\n\t}\n\n\tcopy(): this {\n\t\treturn this.copyFrom( arguments[ 0 ] );\n\t}\n\n\tclone( cb?: Function, scope?: any ): IPoint {\n\t\tcb = cb || this.cb;\n\t\tscope = scope || this.scope;\n\t\treturn new DBasePoint( this._point, cb as Callback, scope );\n\t}\n\n\tequals( p: IPoint ): boolean {\n\t\treturn this._point.equals( p );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, MeshGeometry, Texture, TextureUvs } from \"pixi.js\";\nimport { DCornerMask } from \"./d-corner\";\n\nexport class DBaseBackgroundMeshGeometry extends MeshGeometry {\n\tprotected _texture: Texture;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _borderSize: number;\n\tprotected _cornerMask: DCornerMask;\n\tprotected _isDirty: boolean;\n\tprotected _textureId: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _vertexBuffer: Buffer;\n\tprotected _uvBuffer: Buffer;\n\tprotected _indexBuffer: Buffer;\n\n\tconstructor( texture: Texture, width: number, height: number, borderSize: number, cornerMask: DCornerMask ) {\n\t\tsuper( new Float32Array( 56 ), new Float32Array( 56 ), new Uint16Array( 42 ) );\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._texture = texture;\n\t\tthis._borderSize = borderSize;\n\t\tthis._cornerMask = cornerMask;\n\t\tthis._isDirty = true;\n\t\tthis._textureId = NaN;\n\n\t\tthis._vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tthis._vertices = this._vertexBuffer.data as Float32Array;\n\t\tthis._uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tthis._uvs = this._uvBuffer.data as Float32Array;\n\t\tthis._indexBuffer = this.getIndex();\n\t\tthis._indices = this._indexBuffer.data as Uint16Array;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this._borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tif( this._borderSize !== borderSize ) {\n\t\t\tthis._borderSize = borderSize;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this._cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tif( this._cornerMask !== cornerMask ) {\n\t\t\tthis._cornerMask = cornerMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tif( this._height !== height ) {\n\t\t\tthis._height = height;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this._texture !== texture ) {\n\t\t\tthis._texture = texture;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._textureId = NaN;\n\t\t}\n\t}\n\n\tprotected getTextureId(): number {\n\t\treturn (this._texture as any)._updateID;\n\t}\n\n\tprotected fillVertices( iv: number, array: Float32Array, x0: number, x1: number, y0: number, y1: number ): void {\n\t\tarray[ iv + 0 ] = x0;\n\t\tarray[ iv + 1 ] = y0;\n\t\tarray[ iv + 2 ] = x1;\n\t\tarray[ iv + 3 ] = y0;\n\t\tarray[ iv + 4 ] = x0;\n\t\tarray[ iv + 5 ] = y1;\n\t\tarray[ iv + 6 ] = x1;\n\t\tarray[ iv + 7 ] = y1;\n\t}\n\n\tprotected fillIndices( ii: number, indices: Uint16Array, iv: number ): void {\n\t\tindices[ ii + 0 ] = iv + 0;\n\t\tindices[ ii + 1 ] = iv + 1;\n\t\tindices[ ii + 2 ] = iv + 2;\n\t\tindices[ ii + 3 ] = iv + 1;\n\t\tindices[ ii + 4 ] = iv + 3;\n\t\tindices[ ii + 5 ] = iv + 2;\n\t}\n\n\tprotected fillUvsCorner(\n\t\tiv: number, uvs: Float32Array, c: boolean,\n\t\tu0: number, u1: number, u2: number, u3: number,\n\t\tv0: number, v1: number, v2: number, v3: number\n\t): void {\n\t\tif( c ) {\n\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, u3, u2, v0, v1 );\n\t\t}\n\t}\n\n\tprotected fillUvs( iv: number, uvs: Float32Array, u0: number, u1: number, v0: number, v1: number ): void {\n\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t}\n\n\tupdate(): void {\n\t\tconst texture = this.texture as any;\n\t\tif( ! texture.valid ) {\n\t\t\treturn;\n\t\t}\n\t\tconst textureId = this.getTextureId();\n\t\tif( this._isDirty || this._textureId !== textureId ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._textureId = textureId;\n\t\t\tconst vertices = this._vertices;\n\t\t\tconst uvs = this._uvs;\n\t\t\tconst indices = this._indices;\n\n\t\t\tconst width = this._width;\n\t\t\tconst height = this._height;\n\t\t\tconst borderSize = this._borderSize;\n\n\t\t\tconst x0 = 0;\n\t\t\tconst x1 = borderSize;\n\t\t\tconst x2 = width - borderSize;\n\t\t\tconst x3 = width;\n\n\t\t\tconst y0 = 0;\n\t\t\tconst y1 = borderSize;\n\t\t\tconst y2 = height - borderSize;\n\t\t\tconst y3 = height;\n\n\t\t\tconst textureUvs: TextureUvs = texture._uvs;\n\n\t\t\tconst l = textureUvs.x0;\n\t\t\tconst r = textureUvs.x1;\n\t\t\tconst t = textureUvs.y0;\n\t\t\tconst b = textureUvs.y3;\n\t\t\tconst w = (r - l) * (borderSize / texture.width);\n\t\t\tconst h = (b - t) * (borderSize / texture.height);\n\n\t\t\tconst u0 = l;\n\t\t\tconst u1 = l + w;\n\t\t\tconst u2 = r - w;\n\t\t\tconst u3 = r;\n\n\t\t\tconst v0 = t;\n\t\t\tconst v1 = t + h;\n\t\t\tconst v2 = b - h;\n\t\t\tconst v3 = b;\n\n\t\t\tconst cornerMask = this._cornerMask;\n\t\t\tconst ctl = ! (cornerMask & DCornerMask.TOP_LEFT);\n\t\t\tconst ctr = ! (cornerMask & DCornerMask.TOP_RIGHT);\n\t\t\tconst cbl = ! (cornerMask & DCornerMask.BOTTOM_LEFT);\n\t\t\tconst cbr = ! (cornerMask & DCornerMask.BOTTOM_RIGHT);\n\n\t\t\t// Vertices & UVs\n\t\t\tlet iv = 0;\n\t\t\tlet ia = 0;\n\t\t\tlet ii = 0;\n\n\t\t\t// Top left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, ctl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y0, y1 );\n\t\t\tthis.fillUvs( iv, uvs, u1, u2, v0, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, ctr, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle\n\t\t\tthis.fillVertices( iv, vertices, x0, x3, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, u0, u3, v1, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, cbl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y2, y3 );\n\t\t\tthis.fillUvs( iv, uvs, u1, u2, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, cbr, u3, u2, u1, u0, v3, v2, v1, v0 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\n\t\t\tthis._vertexBuffer.update();\n\t\t\tthis._uvBuffer.update();\n\t\t\tthis._indexBuffer.update();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Texture } from \"pixi.js\";\nimport { DBaseBackgroundMeshGeometry } from \"./d-base-background-mesh-geometry\";\nimport { DCornerMask } from \"./d-corner\";\n\nexport class DBaseBackgroundMesh extends Mesh {\n\tgeometry!: DBaseBackgroundMeshGeometry;\n\tshader!: MeshMaterial;\n\n\tconstructor( texture: Texture, borderSize: number, cornerMask: DCornerMask ) {\n\t\tsuper(\n\t\t\tnew DBaseBackgroundMeshGeometry( texture, 100, 100, borderSize, cornerMask ),\n\t\t\tnew MeshMaterial( texture )\n\t\t);\n\t}\n\n\tget texture() {\n\t\treturn this.shader.texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this.shader.texture !== texture ) {\n\t\t\tthis.shader.texture = texture;\n\t\t\tthis.geometry.texture = texture;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.geometry.width = width;\n\t}\n\n\tget height(): number {\n\t\treturn this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.geometry.height = height;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tthis.geometry.borderSize = borderSize;\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tthis.geometry.cornerMask = cornerMask;\n\t}\n\n\tprotected _render( renderer: PIXI.Renderer ): void {\n\t\tthis.geometry.update();\n\t\tsuper._render( renderer );\n\t}\n\n\tupdate(): void {\n\t\tthis.geometry.update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, MeshGeometry, Texture, TextureUvs } from \"pixi.js\";\nimport { DBorderMask } from \"./d-border\";\nimport { DCornerMask } from \"./d-corner\";\n\nexport class DBaseBorderMeshGeometry extends MeshGeometry {\n\tprotected _texture: Texture;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _borderSize: number;\n\tprotected _borderMask: DBorderMask;\n\tprotected _cornerMask: DCornerMask;\n\tprotected _isDirty: boolean;\n\tprotected _textureId: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _vertexBuffer: Buffer;\n\tprotected _uvBuffer: Buffer;\n\tprotected _indexBuffer: Buffer;\n\n\tconstructor(\n\t\ttexture: Texture, width: number, height: number,\n\t\tborderSize: number, borderMask: DBorderMask, cornerMask: DCornerMask\n\t) {\n\t\tsuper( new Float32Array( 64 ), new Float32Array( 64 ), new Uint16Array( 48 ) );\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._texture = texture;\n\t\tthis._borderSize = borderSize;\n\t\tthis._borderMask = borderMask;\n\t\tthis._cornerMask = cornerMask;\n\t\tthis._isDirty = true;\n\t\tthis._textureId = NaN;\n\n\t\tthis._vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tthis._vertices = this._vertexBuffer.data as Float32Array;\n\t\tthis._uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tthis._uvs = this._uvBuffer.data as Float32Array;\n\t\tthis._indexBuffer = this.getIndex();\n\t\tthis._indices = this._indexBuffer.data as Uint16Array;\n\t}\n\n\tget borderMask(): DBorderMask {\n\t\treturn this._borderMask;\n\t}\n\n\tset borderMask( borderMask: DBorderMask ) {\n\t\tif( this._borderMask !== borderMask ) {\n\t\t\tthis._borderMask = borderMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this._cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tif( this._cornerMask !== cornerMask ) {\n\t\t\tthis._cornerMask = cornerMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget borderSize(): number {\n\t\treturn this._borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tif( this._borderSize !== borderSize ) {\n\t\t\tthis._borderSize = borderSize;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tif( this._height !== height ) {\n\t\t\tthis._height = height;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this._texture !== texture ) {\n\t\t\tthis._texture = texture;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._textureId = NaN;\n\t\t}\n\t}\n\n\tprotected fillVertices( iv: number, array: Float32Array, x0: number, x1: number, y0: number, y1: number ): void {\n\t\tarray[ iv + 0 ] = x0;\n\t\tarray[ iv + 1 ] = y0;\n\t\tarray[ iv + 2 ] = x1;\n\t\tarray[ iv + 3 ] = y0;\n\t\tarray[ iv + 4 ] = x0;\n\t\tarray[ iv + 5 ] = y1;\n\t\tarray[ iv + 6 ] = x1;\n\t\tarray[ iv + 7 ] = y1;\n\t}\n\n\tprotected fillIndices( ii: number, indices: Uint16Array, iv: number ): void {\n\t\tindices[ ii + 0 ] = iv + 0;\n\t\tindices[ ii + 1 ] = iv + 1;\n\t\tindices[ ii + 2 ] = iv + 2;\n\t\tindices[ ii + 3 ] = iv + 1;\n\t\tindices[ ii + 4 ] = iv + 3;\n\t\tindices[ ii + 5 ] = iv + 2;\n\t}\n\n\tprotected fillUvsCorner(\n\t\tiv: number, uvs: Float32Array, b1: boolean, b2: boolean, c: boolean,\n\t\tu0: number, u1: number, u2: number, u3: number,\n\t\tv0: number, v1: number, v2: number, v3: number\n\t): void {\n\t\tif( b1 || b2 ) {\n\t\t\tif( c ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t\t} else if( b1 && b2 ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u3, u2, v0, v1 );\n\t\t\t} else if( b1 ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u1, u2, v0, v1 );\n\t\t\t} else {\n\t\t\t\tthis.fillVertices( iv, uvs, u0, u1, v1, v2 );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, u1, u1, v1, v1 );\n\t\t}\n\t}\n\n\tprotected fillUvs(\n\t\tiv: number, uvs: Float32Array, b: boolean,\n\t\tu0: number, u1: number, v0: number, v1: number,\n\t\tuz: number, vz: number\n\t): void {\n\t\tif( b ) {\n\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, uz, uz, vz, vz );\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tconst texture = this._texture as any;\n\t\tif( ! texture.valid ) {\n\t\t\treturn;\n\t\t}\n\t\tconst textureId = texture._updateID;\n\t\tif( this._isDirty || this._textureId !== textureId ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._textureId = textureId;\n\t\t\tconst vertices = this._vertices;\n\t\t\tconst uvs = this._uvs;\n\t\t\tconst indices = this._indices;\n\n\t\t\tconst width = this._width;\n\t\t\tconst height = this._height;\n\t\t\tconst borderSize = this._borderSize;\n\n\t\t\tconst x0 = 0;\n\t\t\tconst x1 = borderSize;\n\t\t\tconst x2 = width - borderSize;\n\t\t\tconst x3 = width;\n\n\t\t\tconst y0 = 0;\n\t\t\tconst y1 = borderSize;\n\t\t\tconst y2 = height - borderSize;\n\t\t\tconst y3 = height;\n\n\t\t\tconst textureUvs: TextureUvs = texture._uvs;\n\n\t\t\tconst l = textureUvs.x0;\n\t\t\tconst r = textureUvs.x1;\n\t\t\tconst t = textureUvs.y0;\n\t\t\tconst b = textureUvs.y3;\n\t\t\tconst w = (r - l) * (borderSize / texture.width);\n\t\t\tconst h = (b - t) * (borderSize / texture.height);\n\n\t\t\tconst u0 = l;\n\t\t\tconst u1 = l + w;\n\t\t\tconst u2 = r - w;\n\t\t\tconst u3 = r;\n\n\t\t\tconst v0 = t;\n\t\t\tconst v1 = t + h;\n\t\t\tconst v2 = b - h;\n\t\t\tconst v3 = b;\n\n\t\t\tconst borderMask = this._borderMask;\n\t\t\tconst bt = ! (borderMask & DBorderMask.TOP);\n\t\t\tconst bb = ! (borderMask & DBorderMask.BOTTOM);\n\t\t\tconst bl = ! (borderMask & DBorderMask.LEFT);\n\t\t\tconst br = ! (borderMask & DBorderMask.RIGHT);\n\n\t\t\tconst cornerMask = this._cornerMask;\n\t\t\tconst ctl = ! (cornerMask & DCornerMask.TOP_LEFT);\n\t\t\tconst ctr = ! (cornerMask & DCornerMask.TOP_RIGHT);\n\t\t\tconst cbl = ! (cornerMask & DCornerMask.BOTTOM_LEFT);\n\t\t\tconst cbr = ! (cornerMask & DCornerMask.BOTTOM_RIGHT);\n\n\t\t\t// Vertices & UVs\n\t\t\tlet iv = 0;\n\t\t\tlet ia = 0;\n\t\t\tlet ii = 0;\n\n\t\t\t// Top left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bt, bl, ctl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y0, y1 );\n\t\t\tthis.fillUvs( iv, uvs, bt, u1, u2, v0, v1, u1, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bt, br, ctr, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, bl, u0, u1, v1, v2, u1, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle right\n\t\t\tthis.fillVertices( iv, vertices, x2, x3, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, br, u2, u3, v1, v2, u2, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bb, bl, cbl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y2, y3 );\n\t\t\tthis.fillUvs( iv, uvs, bb, u1, u2, v2, v3, u2, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bb, br, cbr, u3, u2, u1, u0, v3, v2, v1, v0 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\n\t\t\tthis._vertexBuffer.update();\n\t\t\tthis._uvBuffer.update();\n\t\t\tthis._indexBuffer.update();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Texture } from \"pixi.js\";\nimport { DBaseBorderMeshGeometry } from \"./d-base-border-mesh-geometry\";\nimport { DBorderMask } from \"./d-border\";\nimport { DCornerMask } from \"./d-corner\";\n\nexport class DBaseBorderMesh extends Mesh {\n\tgeometry!: DBaseBorderMeshGeometry;\n\tshader!: MeshMaterial;\n\n\tconstructor( texture: Texture, borderSize: number, borderMask: DBorderMask, cornerMask: DCornerMask ) {\n\t\tsuper(\n\t\t\tnew DBaseBorderMeshGeometry( texture, 100, 100, borderSize, borderMask, cornerMask ),\n\t\t\tnew MeshMaterial( texture )\n\t\t);\n\t}\n\n\tget texture() {\n\t\treturn this.shader.texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this.shader.texture !== texture ) {\n\t\t\tthis.shader.texture = texture;\n\t\t\tthis.geometry.texture = texture;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.geometry.width = width;\n\t}\n\n\tget height(): number {\n\t\treturn this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.geometry.height = height;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this.geometry.borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tthis.geometry.borderSize = borderSize;\n\t}\n\n\tget borderMask(): DBorderMask {\n\t\treturn this.geometry.borderMask;\n\t}\n\n\tset borderMask( borderMask: DBorderMask ) {\n\t\tthis.geometry.borderMask = borderMask;\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tthis.geometry.cornerMask = cornerMask;\n\t}\n\n\tprotected _render( renderer: PIXI.Renderer ): void {\n\t\tthis.geometry.update();\n\t\tsuper._render( renderer );\n\t}\n\n\tupdate(): void {\n\t\tthis.geometry.update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseBorderMesh } from \"./d-base-border-mesh\";\n\nexport class DBaseOutlineMesh extends DBaseBorderMesh {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilToSvgUrl = ( svg: string ): string => {\n\treturn `data:image/svg+xml;base64,${btoa(svg)}`;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { settings, Texture } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DCornerMask } from \"../d-corner\";\nimport { utilToSvgUrl } from \"./util-to-svg-url\";\n\nconst toCornerTl = ( offset: number, size: number, tl: number ): string => {\n\treturn ( 0 < tl ? `A${tl} ${tl} 0 0 1 ${offset + tl} ${offset}` : \"\" );\n};\n\nconst toCornerBr = ( offset: number, size: number, br: number ): string => {\n\treturn ( 0 < br ? `A${br} ${br} 0 0 1 ${offset + size - br} ${offset + size}` : \"\" );\n};\n\nexport class UtilTexturePlane {\n\tprotected static BACKGROUND_CACHE: Map<number, Texture> = new Map<number, Texture>();\n\tprotected static BACKGROUND_ATTRIBUTE: string = `fill=\"#fff\" stroke=\"none\"`;\n\tprotected static BORDER_CACHE: Map<number, Map<number, Texture>> = new Map<number, Map<number, Texture>>();\n\tprotected static BORDER_ATTRIBUTE = ( width: number ): string => `fill=\"none\" stroke=\"#fff\" stroke-width=\"${width}\"`;\n\n\tprotected static make( radius: number, offset: number, attr: string ): Texture {\n\t\tconst realRadius = Math.max( 0, radius - offset );\n\t\tconst size: number = realRadius * 2 + 4;\n\t\tconst realSize: number = size + offset * 2;\n\t\tconst d =\n\t\t\t`M${offset + realRadius} ${offset}` +\n\t\t\t`L${offset + size} ${offset}` +\n\t\t\t`L${offset + size} ${offset + size - realRadius}` +\n\t\t\ttoCornerBr( offset, size, realRadius ) +\n\t\t\t`L${offset} ${offset + size}` +\n\t\t\t`L${offset} ${offset + realRadius}` +\n\t\t\ttoCornerTl( offset, size, realRadius ) +\n\t\t\t`Z`;\n\t\treturn this.toSvg( realSize, attr, d );\n\t}\n\n\tprotected static toSvg( realSize: number, attr: string, d: string ): Texture {\n\t\tconst resolution = settings.RESOLUTION;\n\t\tconst widthAttr = `width=\"${realSize * resolution}\"`;\n\t\tconst heightAttr = `height=\"${realSize * resolution}\"`;\n\t\tconst viewBoxAttr = `viewBox=\"0 0 ${realSize} ${realSize}\"`;\n\t\tconst svg = `<svg ${widthAttr} ${heightAttr} ${viewBoxAttr} xmlns=\"http://www.w3.org/2000/svg\">` +\n\t\t\t`<path ${attr} d=\"${d}\"></path>` +\n\t\t`</svg>`;\n\t\treturn Texture.from( utilToSvgUrl( svg ), {\n\t\t\tresolution\n\t\t});\n\t}\n\n\tprotected static onUpdate(): void {\n\t\tDApplications.update();\n\t}\n\n\tstatic newBackground( radius: number ): Texture {\n\t\tconst cache = this.BACKGROUND_CACHE;\n\n\t\tlet texture = cache.get( radius );\n\t\tif( texture == null ) {\n\t\t\ttexture = this.make( radius, 0, this.BACKGROUND_ATTRIBUTE );\n\t\t\ttexture.on( \"update\", this.onUpdate );\n\t\t\tcache.set( radius, texture );\n\t\t}\n\n\t\treturn texture;\n\t}\n\n\tstatic newBorder( radius: number, width: number ): Texture {\n\t\tconst cache = this.BORDER_CACHE;\n\n\t\tlet maskToTexture = cache.get( radius );\n\t\tif( maskToTexture == null ) {\n\t\t\tmaskToTexture = new Map<DCornerMask, Texture>();\n\t\t\tcache.set( radius, maskToTexture );\n\t\t}\n\n\t\tlet texture = maskToTexture.get( width );\n\t\tif( texture == null ) {\n\t\t\ttexture = this.make( radius, 0.5 * width, this.BORDER_ATTRIBUTE( width ) );\n\t\t\ttexture.on( \"update\", this.onUpdate );\n\t\t\tmaskToTexture.set( width, texture );\n\t\t}\n\n\t\treturn texture;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DBaseBackgroundMesh } from \"./d-base-background-mesh\";\nimport { DBaseBorderMesh } from \"./d-base-border-mesh\";\nimport { DBaseOutlineMesh } from \"./d-base-outline-mesh\";\nimport { UtilTexturePlane } from \"./util/util-texture-plane\";\n\nexport class DBaseReflowable implements DReflowable {\n\tprotected _lastBackgroundCornerRadius: number;\n\tprotected _lastBorderCornerRadius: number;\n\tprotected _lastBorderWidth: number;\n\tprotected _lastOutlineCornerRadius: number;\n\tprotected _lastOutlineWidth: number;\n\tprotected _backgroundPlane: DBaseBackgroundMesh;\n\tprotected _borderPlane: DBaseBorderMesh;\n\tprotected _outlinePlane: DBaseOutlineMesh;\n\n\tconstructor( base: DBase ) {\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = corner.getRadius();\n\t\tconst cornerHeight = cornerRadius + 1;\n\t\tconst cornerMask = corner.getMask();\n\t\tconst backgroundPlane = this._backgroundPlane = new DBaseBackgroundMesh(\n\t\t\tUtilTexturePlane.newBackground( cornerRadius ),\n\t\t\tcornerHeight, cornerMask\n\t\t);\n\t\tbase.appendRenderable( backgroundPlane, true );\n\n\t\tconst state = base.state;\n\n\t\tconst border = base.border;\n\t\tconst borderWidth = border.getWidth( state );\n\t\tconst borderMask = border.getMask( state );\n\t\tconst borderPlane = this._borderPlane = new DBaseBorderMesh(\n\t\t\tUtilTexturePlane.newBorder( cornerRadius, borderWidth ),\n\t\t\tcornerHeight,\n\t\t\tborderMask,\n\t\t\tcornerMask\n\t\t);\n\t\tbase.appendRenderable( borderPlane, false );\n\n\t\tconst outline = base.outline;\n\t\tconst outlineWidth = outline.getWidth( state );\n\t\tconst outlineMask = outline.getMask( state );\n\t\tconst outlinePlane = this._outlinePlane = new DBaseOutlineMesh(\n\t\t\tUtilTexturePlane.newBorder( cornerRadius, outlineWidth ),\n\t\t\tcornerHeight,\n\t\t\toutlineMask,\n\t\t\tcornerMask\n\t\t);\n\t\tbase.appendRenderable( outlinePlane, false );\n\n\t\tthis._lastBackgroundCornerRadius = cornerRadius;\n\t\tthis._lastBorderCornerRadius = cornerRadius;\n\t\tthis._lastBorderWidth = borderWidth;\n\t\tthis._lastOutlineCornerRadius = cornerRadius;\n\t\tthis._lastOutlineWidth = outlineWidth;\n\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = corner.getRadius();\n\t\tconst cornerHeight = cornerRadius + 1;\n\t\tconst cornerMask = corner.getMask();\n\n\t\t// Background\n\t\tconst background = base.background;\n\t\tconst backgroundPlane = this._backgroundPlane;\n\t\tconst backgroundColor = background.getColor( state );\n\t\tif( backgroundColor != null ) {\n\t\t\tconst backgroundAlpha = background.getAlpha( state );\n\t\t\tif( 0 < backgroundAlpha ) {\n\t\t\t\tif( this._lastBackgroundCornerRadius !== cornerRadius ) {\n\t\t\t\t\tthis._lastBackgroundCornerRadius = cornerRadius;\n\t\t\t\t\tbackgroundPlane.texture = UtilTexturePlane.newBackground( cornerRadius);\n\t\t\t\t\tbackgroundPlane.borderSize = cornerHeight;\n\t\t\t\t}\n\t\t\t\tbackgroundPlane.tint = backgroundColor;\n\t\t\t\tbackgroundPlane.alpha = backgroundAlpha;\n\t\t\t\tbackgroundPlane.width = width;\n\t\t\t\tbackgroundPlane.height = height;\n\t\t\t\tbackgroundPlane.cornerMask = cornerMask;\n\t\t\t\tbackgroundPlane.visible = true;\n\t\t\t} else {\n\t\t\t\tbackgroundPlane.visible = false;\n\t\t\t}\n\t\t} else {\n\t\t\tbackgroundPlane.visible = false;\n\t\t}\n\n\t\t// Border\n\t\tconst border = base.border;\n\t\tconst borderPlane = this._borderPlane;\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tif( 0 < borderAlpha ) {\n\t\t\t\tconst borderWidth = border.getWidth( state );\n\t\t\t\tif( this._lastBorderCornerRadius !== cornerRadius || this._lastBorderWidth !== borderWidth ) {\n\t\t\t\t\tthis._lastBorderCornerRadius = cornerRadius;\n\t\t\t\t\tthis._lastBorderWidth = borderWidth;\n\t\t\t\t\tborderPlane.texture = UtilTexturePlane.newBorder( cornerRadius, borderWidth );\n\t\t\t\t\tborderPlane.borderSize = cornerHeight;\n\t\t\t\t}\n\t\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\t\tconst borderMask = border.getMask( state );\n\t\t\t\tborderPlane.tint = borderColor;\n\t\t\t\tborderPlane.alpha = borderAlpha;\n\t\t\t\tconst borderOffset = borderAlign * borderWidth;\n\t\t\t\tborderPlane.x = -borderOffset;\n\t\t\t\tborderPlane.y = -borderOffset;\n\t\t\t\tborderPlane.width = width + borderOffset * 2;\n\t\t\t\tborderPlane.height = height + borderOffset * 2;\n\t\t\t\tborderPlane.borderMask = borderMask;\n\t\t\t\tborderPlane.cornerMask = cornerMask;\n\t\t\t\tborderPlane.visible = true;\n\t\t\t} else {\n\t\t\t\tborderPlane.visible = false;\n\t\t\t}\n\t\t} else {\n\t\t\tborderPlane.visible = false;\n\t\t}\n\n\t\t// Outline\n\t\tconst outline = base.outline;\n\t\tconst outlinePlane = this._outlinePlane;\n\t\tconst outlineColor = outline.getColor( state );\n\t\tif( outlineColor != null ) {\n\t\t\tconst outlineAlpha = outline.getAlpha( state );\n\t\t\tif( 0 < outlineAlpha ) {\n\t\t\t\tconst outlineWidth = outline.getWidth( state );\n\t\t\t\tif( this._lastOutlineCornerRadius !== cornerRadius || this._lastOutlineWidth !== outlineWidth ) {\n\t\t\t\t\tthis._lastOutlineCornerRadius = cornerRadius;\n\t\t\t\t\tthis._lastOutlineWidth = outlineWidth;\n\t\t\t\t\toutlinePlane.texture = UtilTexturePlane.newBorder( cornerRadius, outlineWidth );\n\t\t\t\t\toutlinePlane.borderSize = cornerHeight;\n\t\t\t\t}\n\t\t\t\tconst outlineMask = outline.getMask( state );\n\t\t\t\tconst outlineOffset = outline.getOffset( state );\n\t\t\t\tconst outlineAlign = outline.getAlign( state );\n\t\t\t\toutlinePlane.tint = outlineColor;\n\t\t\t\toutlinePlane.alpha = outlineAlpha;\n\t\t\t\tconst outlineOffsetAccumulative = outlineOffset + outlineAlign * outlineWidth;\n\t\t\t\toutlinePlane.x = -outlineOffsetAccumulative;\n\t\t\t\toutlinePlane.y = -outlineOffsetAccumulative;\n\t\t\t\toutlinePlane.width = width + outlineOffsetAccumulative * 2;\n\t\t\t\toutlinePlane.height = height + outlineOffsetAccumulative * 2;\n\t\t\t\toutlinePlane.borderMask = outlineMask;\n\t\t\t\toutlinePlane.cornerMask = cornerMask;\n\t\t\t\toutlinePlane.visible = true;\n\t\t\t} else {\n\t\t\t\toutlinePlane.visible = false;\n\t\t\t}\n\t\t} else {\n\t\t\toutlinePlane.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport class DBaseStates {\n\tstatic is( target: DBaseState, state: DBaseState ): boolean {\n\t\treturn ( (target & state) !== 0 );\n\t}\n\n\tstatic isHovered( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.HOVERED );\n\t}\n\n\tstatic isDragging( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.DRAGGING );\n\t}\n\n\tstatic isFocused( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.FOCUSED );\n\t}\n\n\tstatic isFocusedIn( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.FOCUSED | DBaseState.FOCUSED_IN );\n\t}\n\n\tstatic isActive( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.ACTIVE );\n\t}\n\n\tstatic isActiveIn( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.ACTIVE | DBaseState.ACTIVE_IN );\n\t}\n\n\tstatic isNotActive( state: DBaseState ): boolean {\n\t\treturn DBaseStates.is( state, DBaseState.DISABLED ) || ! DBaseStates.is( state, DBaseState.ACTIVE );\n\t}\n\n\tstatic isPressed( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.PRESSED );\n\t}\n\n\tstatic isDisabled( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.DISABLED );\n\t}\n\n\tstatic isReadOnly( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.READ_ONLY );\n\t}\n\n\tstatic isActionable( target: DBaseState ) {\n\t\treturn ! DBaseStates.is( target, DBaseState.DISABLED | DBaseState.READ_ONLY );\n\t}\n\n\tstatic isInvalid( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.INVALID );\n\t}\n\n\tstatic isSucceeded( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.SUCCEEDED );\n\t}\n\n\tstatic isFailed( target: DBaseState ) {\n\t\treturn DBaseStates.is( target, DBaseState.FAILED );\n\t}\n\n\tstatic bind(\n\t\tdestination: DBase<any, any>, destinationState: DBaseState,\n\t\tsource: DBase<any, any>, when: ( sourceState: DBaseState ) => boolean\n\t) {\n\t\tdestination.setState( destinationState, when( source.state ) );\n\t\tsource.on( \"statechange\", ( newSourceState: DBaseState ) => {\n\t\t\tdestination.setState( destinationState, when( newSourceState ) );\n\t\t});\n\t}\n\n\tstatic disable(\n\t\tdestination: DBase<any, any>, source: DBase<any, any>,\n\t\twhen: ( sourceState: DBaseState ) => boolean = DBaseStates.isNotActive\n\t) {\n\t\tDBaseStates.bind( destination, DBaseState.DISABLED, source, when );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DCommandFlag {\n\tNONE = 0,\n\n\t/**\n\t * Commands with a `UNSTORABLE` flag will not be queued to the `done` queue.\n\t */\n\tUNSTORABLE = 1,\n\n\t/**\n\t * Commands with a `CLEAR` flag clears the command queue.\n\t */\n\tCLEAR = 2\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandClear implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScalar } from \"./d-scalar\";\nimport { utilIsNumber } from \"./util/util-is-number\";\n\nconst enum NodeType {\n\t// Parensesis\n\tOPEN,\n\tCLOSE,\n\tPARENSESIS,\n\n\t// Operations\n\tADD_OR_PLUS,\n\tSUB_OR_MINUS,\n\n\tPLUS,\n\tMINUS,\n\n\tADD,\n\tSUB,\n\tMUL,\n\tDIV,\n\n\t// Literals\n\tPARENT,\n\tSELF,\n\tPADDING,\n\tCURRENT,\n\tNUMBER\n}\n\ntype NodeTypeOperator = NodeType.SUB_OR_MINUS | NodeType.ADD_OR_PLUS |\n\tNodeType.SUB | NodeType.ADD | NodeType.MUL | NodeType.DIV |\n\tNodeType.OPEN | NodeType.CLOSE;\ntype NodeTypeLiteral = NodeType.NUMBER | NodeType.PARENT | NodeType.SELF | NodeType.PADDING | NodeType.CURRENT;\ntype Token = NodeTypeOperator | [ NodeTypeLiteral, number ];\n\ninterface NodeOrTokenParensesis {\n\t[ 0 ]: NodeType.PARENSESIS;\n\t[ 1 ]: NodeOrToken[];\n}\n\ninterface NodeOrTokenUnary {\n\t[ 0 ]: NodeType.PLUS | NodeType.MINUS;\n\t[ 1 ]: NodeOrToken;\n}\n\ntype NodeArithmeticOperator = NodeType.SUB | NodeType.ADD | NodeType.MUL | NodeType.DIV;\n\ninterface NodeOrTokenArithmetic {\n\t[ 0 ]: NodeArithmeticOperator;\n\t[ 1 ]: NodeOrToken;\n\t[ 2 ]: NodeOrToken;\n}\n\ninterface NodeLiteral {\n\t[ 0 ]: NodeTypeLiteral;\n\t[ 1 ]: number;\n}\n\ntype NodeOrToken = Token | NodeOrTokenParensesis | NodeOrTokenUnary | NodeOrTokenArithmetic;\n\ninterface NodeParensesis {\n\t[ 0 ]: NodeType.PARENSESIS;\n\t[ 1 ]: Node[];\n}\n\ninterface NodeUnary {\n\t[ 0 ]: NodeType.PLUS | NodeType.MINUS;\n\t[ 1 ]: Node;\n}\n\ninterface NodeArithmetic {\n\t[ 0 ]: NodeArithmeticOperator;\n\t[ 1 ]: Node;\n\t[ 2 ]: Node;\n}\n\ntype Node = NodeParensesis | NodeUnary | NodeArithmetic | NodeLiteral;\n\nconst TOKEN_MAPPING_OPERATOR: { [ token: string ]: NodeTypeOperator | undefined } = {\n\t\"+\": NodeType.ADD_OR_PLUS,\n\t\"-\": NodeType.SUB_OR_MINUS,\n\t\"*\": NodeType.MUL,\n\t\"/\": NodeType.DIV,\n\t\"(\": NodeType.OPEN,\n\t\")\": NodeType.CLOSE\n};\n\nconst TOKEN_MAPPING_LITERAL: { [ token: string ]: NodeTypeLiteral | undefined } = {\n\t\"%\": NodeType.PARENT,\n\t\"s\": NodeType.SELF,\n\t\"p\": NodeType.PADDING,\n\t\"c\": NodeType.CURRENT\n};\n\n/**\n * Parser and evaluator of the scalar expressions like `100% - 50s`.\n *\n * Literals\n *\n * * x%: 0.01 * x * parent value\n * * xs: 0.01 * x * self value\n * * xp: 0.01 * x * padding\n * * xc: 0.01 * x * current\n *\n * Operators\n *\n * * `+`\n * * `-`\n * * `*`\n * * `/`\n * * `(` and `)`\n *\n * Examples\n *\n * * `90%`: 0.9 * parent value\n * * `50s`: 0.5 * self value\n * * `90% - 50s`: 0.9 * parent value - 0.5 * self value\n * * `90% - (50s + 100) * 2`: 0.9 * parent value - ( 0.5 * self value + 100 ) * 2\n */\nexport class DScalarExpression implements DScalar {\n\tprotected _node: Node;\n\n\tconstructor( expression: string ) {\n\t\tconst nodes: NodeOrToken[] = this.toToken( expression );\n\t\tthis.toParensesis( nodes, 0 );\n\t\tthis.toUnary( nodes );\n\t\tthis.toArithmetic( nodes, NodeType.MUL, NodeType.DIV );\n\t\tthis.toArithmetic( nodes, NodeType.ADD, NodeType.SUB );\n\t\tif( nodes.length === 1 ) {\n\t\t\tconst node = nodes[ 0 ];\n\t\t\tif( ! utilIsNumber( node ) ) {\n\t\t\t\tthis._node = node as any;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthrow new Error( `Failed to parse '${expression}'` );\n\t}\n\n\ttoParensesis( nodes: NodeOrToken[], from: number ): void {\n\t\tfor( let i = from, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst inode = nodes[ i ];\n\t\t\tif( inode === NodeType.OPEN ) {\n\t\t\t\tfor( let j = i + 1, jmax = nodes.length; j < jmax; ++j ) {\n\t\t\t\t\tconst jnode = nodes[ j ];\n\t\t\t\t\tswitch( jnode ) {\n\t\t\t\t\tcase NodeType.CLOSE:\n\t\t\t\t\t\tconst operand = nodes.splice( i + 1, j - i );\n\t\t\t\t\t\toperand.length -= 1;\n\t\t\t\t\t\tnodes[ i ] = [ NodeType.PARENSESIS, operand ];\n\t\t\t\t\t\treturn;\n\t\t\t\t\tcase NodeType.OPEN:\n\t\t\t\t\t\tthis.toParensesis( nodes, j );\n\t\t\t\t\t\tjmax = nodes.length;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\tthrow new Error( `Malformed parensesis` );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoUnaryNode( node: NodeOrToken ): void {\n\t\tif( ! utilIsNumber( node ) && node[ 0 ] === NodeType.PARENSESIS ) {\n\t\t\tthis.toUnary( node[ 1 ] );\n\t\t}\n\t}\n\n\ttoUnary( nodes: NodeOrToken[] ): void {\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === NodeType.ADD_OR_PLUS || node === NodeType.SUB_OR_MINUS ) {\n\t\t\t\tif( i <= 0 || utilIsNumber( nodes[ i - 1 ] ) ) {\n\t\t\t\t\tif( i + 1 < imax && ! utilIsNumber( nodes[ i + 1 ] ) ) {\n\t\t\t\t\t\tconst operand = nodes.splice( i + 1, 1 )[ 0 ];\n\t\t\t\t\t\tconst type = ( node === NodeType.ADD_OR_PLUS ? NodeType.PLUS : NodeType.MINUS );\n\t\t\t\t\t\tnodes[ i ] = [ type, operand ];\n\t\t\t\t\t\timax = nodes.length;\n\t\t\t\t\t\tthis.toUnaryNode( operand );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error( \"Malformed unary operator\" );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst type = ( node === NodeType.ADD_OR_PLUS ? NodeType.ADD : NodeType.SUB );\n\t\t\t\t\tnodes[ i ] = type;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toUnaryNode( node );\n\t\t\t\timax = nodes.length;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoArithmeticNode( node: NodeOrToken, operatorA: NodeArithmeticOperator, operatorB: NodeArithmeticOperator ): void {\n\t\tif( ! utilIsNumber( node ) ) {\n\t\t\tif( node[ 0 ] === NodeType.PARENSESIS ) {\n\t\t\t\tthis.toArithmetic( node[ 1 ], operatorA, operatorB );\n\t\t\t} else if( node[ 0 ] === NodeType.PLUS || node[ 0 ] === NodeType.MINUS ) {\n\t\t\t\tthis.toArithmeticNode( node[ 1 ], operatorA, operatorB );\n\t\t\t} else if( node[ 0 ] === NodeType.ADD || node[ 0 ] === NodeType.SUB ||\n\t\t\t\tnode[ 0 ] === NodeType.MUL || node[ 0 ] === NodeType.DIV ) {\n\t\t\t\tthis.toArithmeticNode( node[ 1 ], operatorA, operatorB );\n\t\t\t\tthis.toArithmeticNode( node[ 2 ], operatorA, operatorB );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoArithmetic( nodes: NodeOrToken[], operatorA: NodeArithmeticOperator, operatorB: NodeArithmeticOperator ): void {\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === operatorA || node === operatorB ) {\n\t\t\t\tif( 0 < i && i + 1 < imax ) {\n\t\t\t\t\tconst left = nodes[ i - 1 ];\n\t\t\t\t\tconst right = nodes[ i + 1 ];\n\t\t\t\t\tif( ! utilIsNumber( left ) && ! utilIsNumber( right ) ) {\n\t\t\t\t\t\tnodes.splice( i, 2 );\n\t\t\t\t\t\tnodes[ i - 1 ] = [ node, left, right ];\n\t\t\t\t\t\ti -= 1;\n\t\t\t\t\t\timax = nodes.length;\n\t\t\t\t\t\tthis.toArithmeticNode( left, operatorA, operatorB );\n\t\t\t\t\t\tthis.toArithmeticNode( right, operatorA, operatorB );\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error( `Malformed operands for the operator ${node}` );\n\t\t\t} else {\n\t\t\t\tthis.toArithmeticNode( node, operatorA, operatorB );\n\t\t\t\timax = nodes.length;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoToken( expression: string ): Token[] {\n\t\tconst tokenRegEx = /(?:\\+|-|\\*|\\/|\\(|\\)|(?:\\d+(?:\\.\\d*)?[%psc]?))/g;\n\t\tconst tokens: Token[] = [];\n\t\twhile( true ) {\n\t\t\tconst matched = tokenRegEx.exec( expression );\n\t\t\tif( matched != null ) {\n\t\t\t\tconst token = matched[ 0 ];\n\t\t\t\tconst tokenTypeOperator = TOKEN_MAPPING_OPERATOR[ token ];\n\t\t\t\tif( tokenTypeOperator != null ) {\n\t\t\t\t\ttokens.push( tokenTypeOperator );\n\t\t\t\t} else {\n\t\t\t\t\tconst parsedToken = parseFloat( token );\n\t\t\t\t\tif( parsedToken !== parsedToken ) {\n\t\t\t\t\t\tthrow new Error( `Unexpected token '${token}' at ${matched.index} in '${expression}'` );\n\t\t\t\t\t}\n\n\t\t\t\t\tconst tokenTypeLiteral = TOKEN_MAPPING_LITERAL[ token[ token.length - 1 ] ];\n\t\t\t\t\tif( tokenTypeLiteral != null ) {\n\t\t\t\t\t\ttokens.push([ tokenTypeLiteral, parsedToken * 0.01 ]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttokens.push([ NodeType.NUMBER, parsedToken ]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn tokens;\n\t}\n\n\tprotected evaluate( node: Node, parent: number, self: number, padding: number, current: number ): number {\n\t\tswitch( node[ 0 ] ) {\n\t\tcase NodeType.PARENSESIS:\n\t\t\treturn this.evaluate( node[ 1 ][ 0 ], parent, self, padding, current );\n\n\t\t// Unary operators\n\t\tcase NodeType.PLUS:\n\t\t\treturn + this.evaluate( node[ 1 ], parent, self, padding, current );\n\n\t\tcase NodeType.MINUS:\n\t\t\treturn - this.evaluate( node[ 1 ], parent, self, padding, current );\n\n\t\t// Four arithmetic operators\n\t\tcase NodeType.ADD:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) +\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.SUB:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) -\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.MUL:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) *\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.DIV:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) /\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\n\t\t// Literals\n\t\tcase NodeType.PARENT:\n\t\t\treturn node[ 1 ] * parent;\n\t\tcase NodeType.SELF:\n\t\t\treturn node[ 1 ] * self;\n\t\tcase NodeType.PADDING:\n\t\t\treturn node[ 1 ] * padding;\n\t\tcase NodeType.CURRENT:\n\t\t\treturn node[ 1 ] * current;\n\t\tcase NodeType.NUMBER:\n\t\t\treturn node[ 1 ];\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tcalculate( parent: number, self: number, padding: number, current: number ): number {\n\t\treturn this.evaluate( this._node, parent, self, padding, current );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandRedo implements DCommand {\n\texecute(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tredo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tundo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandUndo implements DCommand {\n\texecute(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tredo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tundo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DCommand } from \"./d-command\";\nimport { DCommandClear } from \"./d-command-clear\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DCommandRedo } from \"./d-command-redo\";\nimport { DCommandUndo } from \"./d-command-undo\";\nimport { DControllerCommand } from \"./d-controller-command\";\n\nconst isCommandStorable = ( command: DCommand ): boolean => {\n\treturn ( command.getFlag() & DCommandFlag.UNSTORABLE ) === 0;\n};\n\nconst isCommandClear = ( command: DCommand ): boolean => {\n\treturn ( command.getFlag() & DCommandFlag.CLEAR ) !== 0;\n};\n\nexport class DControllerDefaultCommand extends utils.EventEmitter implements DControllerCommand {\n\tprotected _position: number;\n\tprotected _done: DCommand[];\n\tprotected _waiting: DCommand[];\n\tprotected _executing: Promise<void> | null;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._position = 0;\n\t\tthis._done = [];\n\t\tthis._waiting = [];\n\t\tthis._executing = null;\n\t}\n\n\tlast(): DCommand | null {\n\t\tconst done = this._done;\n\t\tconst waiting = this._waiting;\n\n\t\tif( waiting.length <= 0 ) {\n\t\t\tif( 0 < done.length ) {\n\t\t\t\treturn done[ done.length - 1 ];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn waiting[ waiting.length - 1 ];\n\t\t}\n\t}\n\n\tpush( command: DCommand ): void {\n\t\tconst waiting = this._waiting;\n\t\twaiting.push( command );\n\t\tthis.next();\n\t}\n\n\tnext() {\n\t\tif( this._executing == null ) {\n\t\t\tconst waiting = this._waiting;\n\t\t\tif( 0 < waiting.length ) {\n\t\t\t\tconst command = waiting.shift();\n\t\t\t\tif( command != null ) {\n\t\t\t\t\tif( command instanceof DCommandUndo ) {\n\t\t\t\t\t\tconst done = this._done;\n\t\t\t\t\t\tif( this._position < done.length ) {\n\t\t\t\t\t\t\tconst current = done[ done.length - 1 - this._position ];\n\t\t\t\t\t\t\tthis._position += 1;\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\tconst result = current.undo();\n\t\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if( command instanceof DCommandRedo ) {\n\t\t\t\t\t\tconst done = this._done;\n\t\t\t\t\t\tif( 0 < this._position ) {\n\t\t\t\t\t\t\tconst current = done[ done.length - this._position ];\n\t\t\t\t\t\t\tthis._position -= 1;\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\tconst result = current.redo();\n\t\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst isClear = isCommandClear( command );\n\t\t\t\t\t\tconst isStorable = isCommandStorable( command );\n\t\t\t\t\t\tif( isClear || isStorable ) {\n\t\t\t\t\t\t\tconst size = ( isClear ? this._done.length : this._position );\n\t\t\t\t\t\t\tif( 0 < size ) {\n\t\t\t\t\t\t\t\tthis.remove( size );\n\t\t\t\t\t\t\t\tthis._position = 0;\n\t\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cleanup();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst result = command.execute();\n\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup(): void {\n\t\tconst done = this._done;\n\t\tconst size = done.length - 100;\n\t\tif( 0 < size ) {\n\t\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\t\tdone[ i ].destroy();\n\t\t\t\tdone.shift();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected remove( size: number ): boolean {\n\t\tconst done = this._done;\n\t\tif( 0 < size ) {\n\t\t\tconst ifrom = Math.max( 0, done.length - size );\n\t\t\tsize = done.length - ifrom;\n\t\t\tif( 0 < size ) {\n\t\t\t\tfor( let i = ifrom, imax = done.length; i < imax; ++i ) {\n\t\t\t\t\tdone[ i ].destroy();\n\t\t\t\t}\n\n\t\t\t\tdone.splice( ifrom, done.length - ifrom );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onSuccess( command: DCommand ) {\n\t\tthis._executing = null;\n\t\tif( isCommandStorable( command ) ) {\n\t\t\tthis._done.push( command );\n\t\t\tthis.emit( \"dirty\", this );\n\t\t} else if( command instanceof DCommandUndo || command instanceof DCommandRedo ) {\n\t\t\tthis.emit( \"dirty\", this );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tthis.next();\n\t}\n\n\tprotected onFail( command: DCommand ) {\n\t\tthis._executing = null;\n\t\tconst waiting = this._waiting;\n\t\tcommand.destroy();\n\t\tfor( let i = 0, imax = waiting.length; i < imax; ++i ) {\n\t\t\twaiting[ i ].destroy();\n\t\t}\n\t\twaiting.length = 0;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tsize(): number {\n\t\treturn this._done.length;\n\t}\n\n\tclear(): void {\n\t\tthis.push( new DCommandClear() );\n\t}\n\n\tredo(): void {\n\t\tif( this.isRedoable() ) {\n\t\t\tthis._waiting.push( new DCommandRedo() );\n\t\t\tthis.next();\n\t\t}\n\t}\n\n\tundo(): void {\n\t\tif( this.isUndoable() ) {\n\t\t\tthis._waiting.push( new DCommandUndo() );\n\t\t\tthis.next();\n\t\t}\n\t}\n\n\tisRedoable(): boolean {\n\t\treturn ( 0 < this._position && this._executing == null );\n\t}\n\n\tisUndoable(): boolean {\n\t\treturn ( this._position < this._done.length && this._executing == null );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport {\n\tDControllerFocus, DFocusable, DFocusableContainer, DFocusableMightBe\n} from \"./d-controller-focus\";\n\nconst isFocusable = ( target: any ): target is DFocusable => {\n\treturn ( target != null && (\"setState\" in target) );\n};\n\nconst isFocusableContainer = ( target: any ): target is DFocusableContainer => {\n\treturn ( target != null && \"children\" in target );\n};\n\ninterface Selectable {\n\tselect(): void;\n}\n\nconst isSelectable = ( target: any ): target is Selectable => {\n\treturn ( target != null && \"select\" in target );\n};\n\nexport class DControllerDefaultFocus implements DControllerFocus {\n\tprivate _focused: DFocusable | null = null;\n\n\tsetFocused( focusable: DFocusable | null, isFocused: boolean, select: boolean ): DFocusable | null {\n\t\tif( isFocused ) {\n\t\t\tconst previous = this._focused;\n\t\t\tif( previous !== focusable ) {\n\t\t\t\tif( previous != null ) {\n\t\t\t\t\tprevious.setState( DBaseState.FOCUSED, false );\n\t\t\t\t}\n\n\t\t\t\tthis._focused = focusable;\n\t\t\t\tif( focusable != null && this.isFocusable( focusable ) ) {\n\t\t\t\t\tfocusable.setState( DBaseState.FOCUSED, true );\n\t\t\t\t\tif( select && isSelectable( focusable ) ) {\n\t\t\t\t\t\tfocusable.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn previous;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\tif( focusable != null && this._focused === focusable ) {\n\t\t\t\tfocusable.setState( DBaseState.FOCUSED, false );\n\t\t\t\tif( select && isSelectable( focusable ) ) {\n\t\t\t\t\tfocusable.select();\n\t\t\t\t}\n\t\t\t\treturn focusable;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFocused(): DFocusable | null {\n\t\treturn this._focused;\n\t}\n\n\tfindFocusableParent( mightBeFocusable: DFocusableMightBe | null ): DFocusable | null {\n\t\tlet current: DFocusableMightBe | DFocusableContainer | null = mightBeFocusable;\n\t\twhile( current != null ) {\n\t\t\tif( this.isFocusable( current ) ) {\n\t\t\t\treturn current;\n\t\t\t} else {\n\t\t\t\tcurrent = current.parent;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected isFocusable( target: unknown ): target is DFocusable {\n\t\treturn (\n\t\t\tisFocusable( target ) &&\n\t\t\t! target.hasState( DBaseState.DISABLED | DBaseState.UNFOCUSABLE ) &&\n\t\t\ttarget.visible\n\t\t);\n\t}\n\n\tprotected isFocusRoot( target: unknown ): target is DFocusable {\n\t\treturn (\n\t\t\tisFocusable( target ) &&\n\t\t\ttarget.hasState( DBaseState.FOCUS_ROOT ) &&\n\t\t\ttarget.visible\n\t\t);\n\t}\n\n\tfindFocusable(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean, direction: boolean\n\t): DFocusable | null {\n\t\tif( direction ) {\n\t\t\tconst result = this.findFocusableNext( target, includesTarget, includesTargetChildren );\n\t\t\tif( result != null ) {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tconst parent = target.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tconst children = parent.children;\n\t\t\t\tconst index = children.indexOf( target );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\t// Siblings\n\t\t\t\t\tfor( let i = index + 1, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst found = this.findFocusableNext( children[ i ], true, true );\n\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( this.isFocusRoot( parent ) ) {\n\t\t\t\t\t\tfor( let i = 0, imax = index + 1; i < imax; ++i ) {\n\t\t\t\t\t\t\tconst found = this.findFocusableNext( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Parent\n\t\t\t\t\treturn this.findFocusable( parent, false, false, true );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst result = this.findFocusablePrevious( target, includesTarget, includesTargetChildren );\n\t\t\tif( result != null ) {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tconst parent = target.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tconst children = parent.children;\n\t\t\t\tconst index = children.indexOf( target );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\t// Siblings\n\t\t\t\t\tfor( let i = index - 1; 0 <= i; --i ) {\n\t\t\t\t\t\tconst found = this.findFocusablePrevious( children[ i ], true, true );\n\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( this.isFocusRoot( parent ) ) {\n\t\t\t\t\t\tfor( let i = children.length - 1; index <= i; --i ) {\n\t\t\t\t\t\t\tconst found = this.findFocusablePrevious( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn parent;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Parent\n\t\t\t\t\treturn this.findFocusable( parent, true, false, false );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected findFocusableNext(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean\n\t): DFocusable | null {\n\t\t// Target itself\n\t\tif( includesTarget ) {\n\t\t\tif( this.isFocusable( target ) ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\n\t\t// Target children\n\t\tif( includesTargetChildren && isFocusableContainer( target ) && target.visible ) {\n\t\t\tconst children = target.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst found = this.findFocusableNext( children[ i ], true, true );\n\t\t\t\tif( found != null ) {\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Siblings\n\t\tif( this.isFocusRoot( target ) ) {\n\t\t\treturn target;\n\t\t}\n\n\t\t// Found nothing\n\t\treturn null;\n\t}\n\n\tprotected findFocusablePrevious(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean\n\t): DFocusable | null {\n\t\t// Target children\n\t\tif( includesTargetChildren && isFocusableContainer( target ) && target.visible ) {\n\t\t\tconst children = target.children;\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tconst found = this.findFocusablePrevious( children[ i ], true, true );\n\t\t\t\tif( found != null ) {\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Target itself\n\t\tif( includesTarget ) {\n\t\t\tif( this.isFocusable( target ) ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\n\t\t// Siblings\n\t\tif( this.isFocusRoot( target ) ) {\n\t\t\treturn target;\n\t\t}\n\n\t\t// Found nothing\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\nimport { utilIsString } from \"./util-is-string\";\n\nexport interface UtilKeyboardEventShortcut {\n\talt: boolean;\n\tctrl: boolean;\n\tshift: boolean;\n\tkey: string;\n\twhich: number;\n\tevent?: string;\n}\n\nconst setShortcutKeyAndWhich = ( shortcut: UtilKeyboardEventShortcut ): UtilKeyboardEventShortcut => {\n\tconst key = shortcut.key;\n\tif( key.length <= 1 ) {\n\t\tif( shortcut.shift ) {\n\t\t\tshortcut.key = key.toUpperCase();\n\t\t}\n\t\tconst code = key.charCodeAt( 0 );\n\t\tif( 97 <= code && code <= 122 ) {\n\t\t\t// a ... z\n\t\t\tshortcut.which = code - 32;\n\t\t} else {\n\t\t\tshortcut.which = code;\n\t\t}\n\t} else {\n\t\tswitch( key ) {\n\t\tcase \"Enter\":\n\t\t\tshortcut.which = 13;\n\t\t\tbreak;\n\t\tcase \"Space\":\n\t\t\tshortcut.key = \" \";\n\t\t\tshortcut.which = 32;\n\t\t\tbreak;\n\t\tcase \"Escape\":\n\t\t\tshortcut.which = 27;\n\t\t\tbreak;\n\t\tcase \"F1\":\n\t\t\tshortcut.which = 112;\n\t\t\tbreak;\n\t\tcase \"F2\":\n\t\t\tshortcut.which = 113;\n\t\t\tbreak;\n\t\tcase \"F3\":\n\t\t\tshortcut.which = 114;\n\t\t\tbreak;\n\t\tcase \"F4\":\n\t\t\tshortcut.which = 115;\n\t\t\tbreak;\n\t\tcase \"F5\":\n\t\t\tshortcut.which = 116;\n\t\t\tbreak;\n\t\tcase \"F6\":\n\t\t\tshortcut.which = 117;\n\t\t\tbreak;\n\t\tcase \"F7\":\n\t\t\tshortcut.which = 118;\n\t\t\tbreak;\n\t\tcase \"F8\":\n\t\t\tshortcut.which = 119;\n\t\t\tbreak;\n\t\tcase \"F9\":\n\t\t\tshortcut.which = 120;\n\t\t\tbreak;\n\t\tcase \"F10\":\n\t\t\tshortcut.which = 121;\n\t\t\tbreak;\n\t\tcase \"F11\":\n\t\t\tshortcut.which = 122;\n\t\t\tbreak;\n\t\tcase \"F12\":\n\t\t\tshortcut.which = 123;\n\t\t\tbreak;\n\t\tcase \"CapsLock\":\n\t\t\tif( shortcut.shift ) {\n\t\t\t\tshortcut.which = 20;\n\t\t\t} else {\n\t\t\t\tshortcut.which = 240;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"ArrowUp\":\n\t\t\tshortcut.which = 38;\n\t\t\tbreak;\n\t\tcase \"ArrowDown\":\n\t\t\tshortcut.which = 40;\n\t\t\tbreak;\n\t\tcase \"ArrowLeft\":\n\t\t\tshortcut.which = 37;\n\t\t\tbreak;\n\t\tcase \"ArrowRight\":\n\t\t\tshortcut.which = 39;\n\t\t\tbreak;\n\t\tcase \"Insert\":\n\t\t\tshortcut.which = 45;\n\t\t\tbreak;\n\t\tcase \"Delete\":\n\t\t\tshortcut.which = 46;\n\t\t\tbreak;\n\t\tcase \"PageUp\":\n\t\t\tshortcut.which = 33;\n\t\t\tbreak;\n\t\tcase \"PageDown\":\n\t\t\tshortcut.which = 34;\n\t\t\tbreak;\n\t\tcase \"Backspace\":\n\t\t\tshortcut.which = 8;\n\t\t\tbreak;\n\t\tcase \";\":\n\t\t\tshortcut.which = 187;\n\t\t\tbreak;\n\t\tcase \"Pause\":\n\t\t\tshortcut.which = 19;\n\t\t\tbreak;\n\t\tcase \"ScrollLock\":\n\t\t\tshortcut.which = 145;\n\t\t\tbreak;\n\t\tcase \"Tab\":\n\t\t\tshortcut.which = 9;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn shortcut;\n};\n\nexport class UtilKeyboardEvent {\n\tstatic isActivateKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Space\" || e.key === \"Enter\" || e.which === 32 || e.which === 13 );\n\t}\n\n\tstatic isArrowUpKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowUp\" || e.which === 38 );\n\t}\n\n\tstatic isArrowDownKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowDown\" || e.which === 40 );\n\t}\n\n\tstatic isArrowLeftKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowLeft\" || e.which === 37 );\n\t}\n\n\tstatic isArrowRightKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowRight\" || e.which === 39 );\n\t}\n\n\tstatic isCancelKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Esc\" || e.which === 27 );\n\t}\n\n\tstatic isFocusKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Tab\" || e.which === 9 );\n\t}\n\n\tstatic isUndoKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ( e.key === \"z\" || e.which === 90 ) );\n\t}\n\n\tstatic isRedoKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ( e.key === \"y\" || e.which === 89 ) );\n\t}\n\n\tstatic isSaveKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ! e.shiftKey && ( e.key === \"s\" || e.which === 83 ) );\n\t}\n\n\tstatic isSaveAsKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && e.shiftKey && ( e.key === \"S\" || e.which === 83 ) );\n\t}\n\n\tstatic isDeleteKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Delete\" || e.which === 46 );\n\t}\n\n\tstatic isSelectAllKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ! e.shiftKey && ( e.key === \"a\" || e.which === 65 ) );\n\t}\n\n\tstatic isOkKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Enter\" || e.which === 13 );\n\t}\n\n\tstatic getFocusDirection( e: KeyboardEvent ): boolean {\n\t\treturn ( e.shiftKey !== true );\n\t}\n\n\tstatic toShortcut( expressionOrShortcut: string | UtilKeyboardEventShortcut ): UtilKeyboardEventShortcut {\n\t\tif( ! utilIsString( expressionOrShortcut ) ) {\n\t\t\treturn expressionOrShortcut;\n\t\t} else {\n\t\t\tconst expression = expressionOrShortcut;\n\t\t\tconst arrowIndex = expression.indexOf(\"->\");\n\t\t\tlet keyExpression: string;\n\t\t\tlet event: string | undefined;\n\t\t\tif( 0 <= arrowIndex ) {\n\t\t\t\tkeyExpression = expression.substring( 0, arrowIndex ).trim();\n\t\t\t\tevent = expression.substring( arrowIndex + 2 ).trim();\n\t\t\t} else {\n\t\t\t\tkeyExpression = expression.trim();\n\t\t\t}\n\t\t\tconst keys = keyExpression.toLowerCase().split( \"+\" );\n\t\t\tconst alt: boolean = 0 <= keys.indexOf( \"alt\" );\n\t\t\tconst ctrl: boolean = 0 <= keys.indexOf( \"ctrl\" );\n\t\t\tconst shift: boolean = 0 <= keys.indexOf( \"shift\" );\n\t\t\tconst key: string = keys[ keys.length - 1 ];\n\t\t\treturn setShortcutKeyAndWhich({\n\t\t\t\talt,\n\t\t\t\tctrl,\n\t\t\t\tshift,\n\t\t\t\tkey,\n\t\t\t\twhich: 0,\n\t\t\t\tevent\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic toString( shortcut: UtilKeyboardEventShortcut ): string {\n\t\tconst parts = [];\n\t\tif( shortcut.ctrl ) {\n\t\t\tparts.push( \"Ctrl\" );\n\t\t}\n\t\tif( shortcut.shift ) {\n\t\t\tparts.push( \"Shift\" );\n\t\t}\n\t\tif( shortcut.alt ) {\n\t\t\tparts.push( \"Alt\" );\n\t\t}\n\t\tparts.push( shortcut.key.toUpperCase() );\n\t\treturn parts.join( \"+\" );\n\t}\n\n\tstatic on(\n\t\ttarget: DBase<any, any>,\n\t\texpressionOrShortcut: string | UtilKeyboardEventShortcut,\n\t\thandler?: ( e: KeyboardEvent ) => void\n\t): void {\n\t\tconst shortcut = this.toShortcut( expressionOrShortcut );\n\t\tdocument.body.addEventListener( \"keydown\", ( e: KeyboardEvent ): void => {\n\t\t\tif(\n\t\t\t\te.altKey === shortcut.alt && e.ctrlKey === shortcut.ctrl &&\n\t\t\t\te.shiftKey === shortcut.shift &&\n\t\t\t\t( e.key === shortcut.key || e.which === shortcut.which )\n\t\t\t) {\n\t\t\t\tif( target.isActionable() ) {\n\t\t\t\t\tif( shortcut.event != null ) {\n\t\t\t\t\t\ttarget.emit( shortcut.event );\n\t\t\t\t\t} else if( handler != null ) {\n\t\t\t\t\t\thandler( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DControllerFocus, DFocusable, DFocusableContainer } from \"./d-controller-focus\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport class DControllerKeyboard extends utils.EventEmitter {\n\tinit( element: HTMLElement, stage: Container, focusController: DControllerFocus ) {\n\t\telement.addEventListener( \"keydown\", ( e: KeyboardEvent ): void => {\n\t\t\tthis.emit( \"keydown\", e );\n\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( this.hasOnKeyDown( current ) ) {\n\t\t\t\t\t\tif( current.onKeyDown( e ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( UtilKeyboardEvent.isFocusKey( e ) ) {\n\t\t\t\tconst direction = UtilKeyboardEvent.getFocusDirection( e );\n\t\t\t\tconst next = ( focused != null ?\n\t\t\t\t\tfocusController.findFocusable(\n\t\t\t\t\t\tfocused, false, focused.hasState( DBaseState.FOCUS_ROOT ) || direction, direction\n\t\t\t\t\t) :\n\t\t\t\t\tfocusController.findFocusable( stage, false, true, direction )\n\t\t\t\t);\n\t\t\t\tif( next != null ) {\n\t\t\t\t\tfocusController.setFocused( next, true, true );\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"keyup\", ( e: KeyboardEvent ): void => {\n\t\t\tthis.emit( \"keyup\", e );\n\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( this.hasOnKeyUp( current ) ) {\n\t\t\t\t\t\tif( current.onKeyUp( e ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected hasOnKeyDown( target: any ): target is { onKeyDown( e: KeyboardEvent ): boolean; } {\n\t\treturn \"onKeyDown\" in target;\n\t}\n\n\tprotected hasOnKeyUp( target: any ): target is { onKeyUp( e: KeyboardEvent ): boolean; } {\n\t\treturn \"onKeyUp\" in target;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DControllerCommand } from \"./d-controller-command\";\nimport { DControllerDefaultCommand } from \"./d-controller-default-command\";\nimport { DControllerDefaultFocus } from \"./d-controller-default-focus\";\nimport { DControllerDocument } from \"./d-controller-document\";\nimport { DControllerFocus } from \"./d-controller-focus\";\nimport { DControllerKeyboard } from \"./d-controller-keyboard\";\nimport { DDocument } from \"./d-document\";\n\nexport class DControllers {\n\tprotected static FOCUS: DControllerFocus | null;\n\tprotected static KEYBOARD: DControllerKeyboard | null;\n\tprotected static COMMAND: DControllerCommand | null;\n\tprotected static DOCUMENT: DControllerDocument<any> | null;\n\n\t// Focus\n\tstatic getFocusController(): DControllerFocus {\n\t\tif( this.FOCUS == null ) {\n\t\t\tthis.FOCUS = new DControllerDefaultFocus();\n\t\t}\n\t\treturn this.FOCUS;\n\t}\n\n\tstatic setFocusController( instance: DControllerFocus ): DControllerFocus | null {\n\t\tconst result = this.FOCUS;\n\t\tthis.FOCUS = instance;\n\t\treturn result;\n\t}\n\n\t// Keyboard\n\tstatic getKeyboardController(): DControllerKeyboard {\n\t\tif( this.KEYBOARD == null ) {\n\t\t\tthis.KEYBOARD = new DControllerKeyboard();\n\t\t}\n\t\treturn this.KEYBOARD;\n\t}\n\n\tstatic setKeyboardController( instance: DControllerKeyboard ): DControllerKeyboard | null {\n\t\tconst result = this.KEYBOARD;\n\t\tthis.KEYBOARD = instance;\n\t\treturn result;\n\t}\n\n\t// Command\n\tstatic getCommandController(): DControllerCommand {\n\t\tif( this.COMMAND == null ) {\n\t\t\tthis.COMMAND = new DControllerDefaultCommand();\n\t\t}\n\t\treturn this.COMMAND;\n\t}\n\n\tstatic setCommandController( instance: DControllerCommand ): DControllerCommand | null {\n\t\tconst result = this.COMMAND;\n\t\tthis.COMMAND = instance;\n\t\treturn result;\n\t}\n\n\t// Document\n\tstatic getDocumentController<DOCUMENT extends DDocument>(): DControllerDocument<DOCUMENT> {\n\t\tif( this.DOCUMENT == null ) {\n\t\t\tthrow new Error( \"Not supported\" );\n\t\t}\n\t\treturn this.DOCUMENT;\n\t}\n\n\tstatic setDocumentController<DOCUMENT extends DDocument>(\n\t\tinstance: DControllerDocument<DOCUMENT>\n\t): DControllerDocument<DOCUMENT> | null {\n\t\tconst result = this.DOCUMENT;\n\t\tthis.DOCUMENT = instance;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DCoordinate } from \"./d-coordinate\";\nimport { DScalarFunctions } from \"./d-scalar-functions\";\nimport { DScalarSet } from \"./d-scalar-set\";\nimport { utilIsNumber } from \"./util/util-is-number\";\n\nconst enum AutoFlag {\n\tNONE = 0,\n\tWIDTH = 1,\n\tHEIGHT = 2\n}\n\nexport class DCoordinateSet {\n\tprotected _base: DBase<any, any>;\n\tprotected _scalarSet: DScalarSet;\n\tprotected _autoFlags: AutoFlag;\n\n\tconstructor( base: DBase<any, any>, scalarSet: DScalarSet ) {\n\t\tthis._base = base;\n\t\tthis._scalarSet = scalarSet;\n\t\tthis._autoFlags = AutoFlag.NONE;\n\t}\n\n\tget x(): DCoordinate {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( scalarSet.x != null ) {\n\t\t\treturn scalarSet.x;\n\t\t} else {\n\t\t\treturn this._base.x;\n\t\t}\n\t}\n\n\tset x( x: DCoordinate ) {\n\t\tconst base = this._base;\n\t\tif( utilIsNumber( x ) ) {\n\t\t\tbase.x = x;\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.position( x );\n\t\t\tif( scalarSet.x !== scalar ) {\n\t\t\t\tscalarSet.x = scalar;\n\t\t\t\tbase.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\tget y(): DCoordinate {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( scalarSet.y != null ) {\n\t\t\treturn scalarSet.y;\n\t\t} else {\n\t\t\treturn this._base.y;\n\t\t}\n\t}\n\n\tset y( y: DCoordinate ) {\n\t\tconst base = this._base;\n\t\tif( utilIsNumber( y ) ) {\n\t\t\tbase.y = y;\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.position( y );\n\t\t\tif( scalarSet.y !== scalar ) {\n\t\t\t\tscalarSet.y = scalar;\n\t\t\t\tbase.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\ttoAutoWidth() {\n\t\tthis._autoFlags |= AutoFlag.WIDTH;\n\t}\n\n\tisWidthAuto(): boolean {\n\t\treturn ( this._autoFlags & AutoFlag.WIDTH ) !== 0;\n\t}\n\n\tget width(): DCoordinate {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( this.isWidthAuto() ) {\n\t\t\treturn \"auto\";\n\t\t} else if( scalarSet.width != null ) {\n\t\t\treturn scalarSet.width;\n\t\t} else {\n\t\t\treturn this._base.width;\n\t\t}\n\t}\n\n\tset width( width: DCoordinate ) {\n\t\tif( utilIsNumber( width ) ) {\n\t\t\tthis._base.width = width;\n\t\t} else if( width === \"auto\" ) {\n\t\t\tif( ! this.isWidthAuto() ) {\n\t\t\t\tthis.toAutoWidth();\n\t\t\t\tconst base = this._base;\n\t\t\t\tbase.toChildrenDirty();\n\t\t\t\tDApplications.update();\n\t\t\t}\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.size( width );\n\t\t\tif( scalarSet.width !== scalar ) {\n\t\t\t\tscalarSet.width = scalar;\n\t\t\t\tthis._base.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\ttoAutoHeight() {\n\t\tthis._autoFlags |= AutoFlag.HEIGHT;\n\t}\n\n\tisHeightAuto(): boolean {\n\t\treturn ( this._autoFlags & AutoFlag.HEIGHT ) !== 0;\n\t}\n\n\tget height(): DCoordinate {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( this.isHeightAuto() ) {\n\t\t\treturn \"auto\";\n\t\t} else if( scalarSet.height != null ) {\n\t\t\treturn scalarSet.height;\n\t\t} else {\n\t\t\treturn this._base.height;\n\t\t}\n\t}\n\n\tset height( height: DCoordinate ) {\n\t\tif( utilIsNumber( height ) ) {\n\t\t\tthis._base.height = height;\n\t\t} else if( height === \"auto\" ) {\n\t\t\tif( ! this.isHeightAuto() ) {\n\t\t\t\tthis.toAutoHeight();\n\t\t\t\tconst base = this._base;\n\t\t\t\tbase.toChildrenDirty();\n\t\t\t\tDApplications.update();\n\t\t\t}\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.size( height );\n\t\t\tif( scalarSet.height !== scalar ) {\n\t\t\t\tscalarSet.height = scalar;\n\t\t\t\tthis._base.layout();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"./d-coordinate\";\nimport { DScalarExpression } from \"./d-scalar-expression\";\nimport { DScalarFunction } from \"./d-scalar-function\";\nimport { utilIsFunction } from \"./util/util-is-function\";\nimport { utilIsNumber } from \"./util/util-is-number\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport class DScalarFunctions {\n\tstatic POSITION = {\n\t\tPADDING: ( p: number, s: number, d: number ) => d,\n\t\tCENTER: ( p: number, s: number ) => ( p - s ) * 0.5\n\t};\n\n\tstatic SIZE = {\n\t\tMAXIMIZED: ( p: number ) => p,\n\t\tPADDING: ( p: number, s: number, d: number ) => p - d\n\t};\n\n\tstatic position( coordinate: DCoordinate | undefined ): DScalarFunction | null {\n\t\treturn this.from( coordinate, true );\n\t}\n\n\tstatic size( coordinate: DCoordinate | undefined ): DScalarFunction | null {\n\t\treturn this.from( coordinate, false );\n\t}\n\n\tprotected static from( coordinate: DCoordinate | undefined, isPosition: boolean ): DScalarFunction | null {\n\t\tif( coordinate == null || utilIsNumber( coordinate ) ) {\n\t\t\treturn null;\n\t\t} else if( utilIsString( coordinate ) ) {\n\t\t\tif( isPosition ) {\n\t\t\t\tswitch( coordinate ) {\n\t\t\t\tcase \"center\":\n\t\t\t\t\treturn DScalarFunctions.POSITION.CENTER;\n\t\t\t\tcase \"padding\":\n\t\t\t\t\treturn DScalarFunctions.POSITION.PADDING;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch( coordinate ) {\n\t\t\t\tcase \"100%\":\n\t\t\t\tcase \"maximized\":\n\t\t\t\t\treturn DScalarFunctions.SIZE.MAXIMIZED;\n\t\t\t\tcase \"padding\":\n\t\t\t\t\treturn DScalarFunctions.SIZE.PADDING;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst scalarExpression = new DScalarExpression( coordinate );\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalarExpression.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t} else if( utilIsFunction( coordinate ) ) {\n\t\t\treturn coordinate;\n\t\t} else {\n\t\t\tconst scalar = coordinate;\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalar.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DLayoutClearType {\n\tNONE = 0,\n\tBEFORE = 1,\n\tAFTER = 2,\n\tBOTH = BEFORE | AFTER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTheme } from \"./d-theme\";\n\nexport class DThemes {\n\tprivate static DEFAULT_THEME_CLASS: (new () => DTheme) | null = null;\n\tprivate static INSTANCE: DTheme | null = null;\n\n\tpublic static setDefaultThemeClass( theme: new () => DTheme ): void {\n\t\tthis.DEFAULT_THEME_CLASS = theme;\n\t}\n\n\tpublic static getDefaultThemeClass(): (new () => DTheme) | null {\n\t\treturn this.DEFAULT_THEME_CLASS;\n\t}\n\n\tpublic static getInstance(): DTheme {\n\t\tif( this.INSTANCE == null ) {\n\t\t\tconst defaultThemeClass = this.getDefaultThemeClass();\n\t\t\tif( defaultThemeClass == null ) {\n\t\t\t\tthrow new Error( \"No default theme class found\" );\n\t\t\t}\n\t\t\tthis.INSTANCE = new defaultThemeClass();\n\t\t}\n\t\treturn this.INSTANCE;\n\t}\n\n\tpublic static setInstance( instance: DTheme ): DTheme | null {\n\t\tconst result = this.INSTANCE;\n\t\tthis.INSTANCE = instance;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignHorizontal {\n\tLEFT,\n\tCENTER,\n\tRIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignVertical {\n\tTOP,\n\tMIDDLE,\n\tBOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignWith {\n\tTEXT,\n\tPADDING,\n\tBORDER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilName {\n\tprotected static _mapping: { [ key: string]: number } = {};\n\n\tstatic create( type: string ) {\n\t\tconst mapping = this._mapping;\n\t\tif( type in mapping ) {\n\t\t\treturn `${type} ${++mapping[ type ]}`;\n\t\t} else {\n\t\t\tmapping[ type ] = 1;\n\t\t\treturn `${type} 1`;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction, IPoint } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"../d-applications\";\n\nexport type UtilPointerEventClickHandler = ( e: InteractionEvent ) => void;\n\nexport interface UtilPointerEventClickTarget {\n\ton( name: string, handler: UtilPointerEventClickHandler ): void;\n}\n\nexport class UtilPointerEvent {\n\tstatic CLICK_DISTANCE_THRESHOLD: number = 5;\n\tstatic DBLCLICK_INTERVAL_THRESHOLD: number = 333;\n\tstatic LONG_CLICK_THRESHOLD: number = 750;\n\n\tstatic get touchable(): boolean {\n\t\treturn ( \"ontouchstart\" in document );\n\t}\n\n\tstatic get tap(): string {\n\t\treturn \"pointertap\";\n\t}\n\n\tstatic get down(): string {\n\t\treturn \"pointerdown\";\n\t}\n\n\tstatic get enter(): string {\n\t\treturn \"pointerenter\";\n\t}\n\n\tstatic get leave(): string {\n\t\treturn \"pointerleave\";\n\t}\n\n\tstatic get move(): string {\n\t\treturn \"pointermove\";\n\t}\n\n\tstatic get out(): string {\n\t\treturn \"pointerout\";\n\t}\n\n\tstatic get over(): string {\n\t\treturn \"pointerover\";\n\t}\n\n\tstatic get up(): string {\n\t\treturn \"pointerup\";\n\t}\n\n\tstatic get cancel(): string {\n\t\treturn \"pointercancel\";\n\t}\n\n\tstatic toGlobal( e: MouseEvent | TouchEvent, result: IPoint ): IPoint {\n\t\tconst interactionManager = DApplications.getInstance().renderer.plugins.interaction;\n\t\tif( \"touches\" in e ) {\n\t\t\tconst touches = e.changedTouches;\n\t\t\tconst touch = touches[ touches.length - 1 ];\n\t\t\tif( touch != null ) {\n\t\t\t\tinteractionManager.mapPositionToPoint( result, touch.clientX, touch.clientY );\n\t\t\t} else {\n\t\t\t\tinteractionManager.mapPositionToPoint( result, 0, 0 );\n\t\t\t}\n\t\t} else {\n\t\t\tinteractionManager.mapPositionToPoint( result, e.clientX, e.clientY );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic onClick( target: UtilPointerEventClickTarget, handler: UtilPointerEventClickHandler ): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.on( \"click\", handler );\n\t\t} else {\n\t\t\tlet isDowned = false;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tconst cleanup = (): void => {\n\t\t\t\tisDowned = false;\n\t\t\t\tinteractionManager.off( up, onUp );\n\t\t\t};\n\t\t\tconst isValidDistance = ( e: InteractionEvent ): boolean => {\n\t\t\t\tconst global = e.data.global;\n\t\t\t\tconst dx = Math.abs( downX - global.x );\n\t\t\t\tconst dy = Math.abs( downY - global.y );\n\t\t\t\tconst threshold = this.CLICK_DISTANCE_THRESHOLD;\n\t\t\t\treturn ( dx < threshold && dy < threshold );\n\t\t\t};\n\t\t\ttarget.on( \"click\", ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t\thandler( e );\n\t\t\t});\n\t\t\tconst up = this.up;\n\t\t\tconst onUp = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( isValidDistance( e ) ) {\n\t\t\t\t\t\t\thandler( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst interactionManager = DApplications.getInstance().renderer.plugins.interaction;\n\t\t\ttarget.on( this.down, ( e: InteractionEvent ): void => {\n\t\t\t\tif( ! isDowned ) {\n\t\t\t\t\tisDowned = true;\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t\tinteractionManager.off( up, onUp );\n\t\t\t\t\tinteractionManager.once( up, onUp );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic onLongClick(\n\t\ttarget: UtilPointerEventClickTarget,\n\t\tonClick: UtilPointerEventClickHandler,\n\t\tonLongClick: UtilPointerEventClickHandler\n\t): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.on( \"click\", onClick );\n\t\t} else {\n\t\t\tlet isDowned = false;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet timeoutId: number | null = null;\n\t\t\tconst cleanupTimeout = (): void => {\n\t\t\t\tif( timeoutId != null ) {\n\t\t\t\t\tclearTimeout( timeoutId );\n\t\t\t\t\ttimeoutId = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst cleanup = (): void => {\n\t\t\t\tisDowned = false;\n\t\t\t\tinteractionManager.off( up, onUp );\n\t\t\t\tinteractionManager.off( move, onMove );\n\t\t\t\tcleanupTimeout();\n\t\t\t};\n\t\t\tconst isValidDistance = ( e: InteractionEvent ): boolean => {\n\t\t\t\tconst global = e.data.global;\n\t\t\t\tconst dx = Math.abs( downX - global.x );\n\t\t\t\tconst dy = Math.abs( downY - global.y );\n\t\t\t\tconst threshold = this.CLICK_DISTANCE_THRESHOLD;\n\t\t\t\treturn ( dx < threshold && dy < threshold );\n\t\t\t};\n\t\t\ttarget.on( \"click\", ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t\tonClick( e );\n\t\t\t});\n\t\t\tconst up = this.up;\n\t\t\tconst move = this.move;\n\t\t\tconst onUp = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( isValidDistance( e ) ) {\n\t\t\t\t\t\t\tonClick( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst onMove = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( ! isValidDistance( e ) ) {\n\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst interactionManager = DApplications.getInstance().renderer.plugins.interaction;\n\t\t\ttarget.on( this.down, ( e: InteractionEvent ): void => {\n\t\t\t\tif( ! isDowned ) {\n\t\t\t\t\tisDowned = true;\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t\tcleanupTimeout();\n\t\t\t\t\tconst oe = e.data.originalEvent;\n\t\t\t\t\tif( \"touches\" in oe ) {\n\t\t\t\t\t\ttimeoutId = window.setTimeout((): void => {\n\t\t\t\t\t\t\tif( isDowned ) {\n\t\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t\t\tonLongClick( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this.LONG_CLICK_THRESHOLD );\n\t\t\t\t\t}\n\t\t\t\t\tinteractionManager.off( up, onUp );\n\t\t\t\t\tinteractionManager.off( move, onMove );\n\t\t\t\t\tinteractionManager.once( up, onUp );\n\t\t\t\t\tinteractionManager.on( move, onMove );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic onDblClick( target: HTMLElement, handler: ( e: MouseEvent | TouchEvent ) => void ): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.addEventListener( \"dblclick\", handler );\n\t\t} else {\n\t\t\tlet isDowned = 0;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet clickTime = 0;\n\n\t\t\ttarget.addEventListener( \"dblclick\", handler );\n\n\t\t\ttarget.addEventListener( \"touchend\", ( e: TouchEvent ): void => {\n\t\t\t\tif( isDowned === 1 || isDowned === 3 ) {\n\t\t\t\t\tconst touches = e.changedTouches;\n\t\t\t\t\tconst touch: Touch | null = touches[ touches.length - 1 ];\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tconst dx = downX - touch.clientX;\n\t\t\t\t\t\tconst dy = downY - touch.clientY;\n\t\t\t\t\t\tif( Math.abs( dx ) + Math.abs( dy ) < this.CLICK_DISTANCE_THRESHOLD ) {\n\t\t\t\t\t\t\tisDowned += 1;\n\t\t\t\t\t\t\tif( isDowned === 4 ) {\n\t\t\t\t\t\t\t\tisDowned = 0;\n\t\t\t\t\t\t\t\tconst elapsedTime = e.timeStamp - clickTime;\n\t\t\t\t\t\t\t\tif( elapsedTime < this.DBLCLICK_INTERVAL_THRESHOLD ) {\n\t\t\t\t\t\t\t\t\thandler( e );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tclickTime = e.timeStamp;\n\t\t\t\t\t\t\t\t\tisDowned = 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tclickTime = e.timeStamp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tisDowned = 0;\n\t\t\t});\n\n\t\t\ttarget.addEventListener( \"touchstart\", ( e: TouchEvent ): void => {\n\t\t\t\tif( isDowned === 0 ) {\n\t\t\t\t\tconst touch: Touch | null = e.touches.item( e.touches.length - 1 );\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tisDowned = 1;\n\t\t\t\t\t\tdownX = touch.clientX;\n\t\t\t\t\t\tdownY = touch.clientY;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if( isDowned === 2 ) {\n\t\t\t\t\tconst touch: Touch | null = e.touches.item( e.touches.length - 1 );\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tisDowned = 3;\n\t\t\t\t\t\tdownX = touch.clientX;\n\t\t\t\t\t\tdownY = touch.clientY;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tisDowned = 0;\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic contains( target: unknown, targetOrChild: DisplayObject | null ): boolean {\n\t\tlet current = targetOrChild;\n\t\twhile( current != null && current !== target ) {\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\treturn current === target;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject, interaction, Point, Renderer, Transform } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"./d-applications\";\nimport { DBackgroundStateAware } from \"./d-background\";\nimport { DBaseBackground } from \"./d-base-background\";\nimport { DBaseBorder } from \"./d-base-border\";\nimport { DBaseCorner } from \"./d-base-corner\";\nimport { DBaseInteractive } from \"./d-base-interactive\";\nimport { DBaseOutline } from \"./d-base-outline\";\nimport { DBasePadding } from \"./d-base-padding\";\nimport { DBasePoint } from \"./d-base-point\";\nimport { DBaseReflowable } from \"./d-base-reflowable\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DBorderMask, DBorderStateAware } from \"./d-border\";\nimport { DControllers } from \"./d-controllers\";\nimport { DCoordinate } from \"./d-coordinate\";\nimport { DCoordinateSet } from \"./d-coordinates\";\nimport { DCorner, DCornerMask } from \"./d-corner\";\nimport { DThemeFont } from \"./d-font\";\nimport { DLayoutClearType } from \"./d-layout-clear-type\";\nimport { DOutline } from \"./d-outline\";\nimport { DPadding } from \"./d-padding\";\nimport { DScalarFunctions } from \"./d-scalar-functions\";\nimport { DScalarSet } from \"./d-scalar-set\";\nimport { DShadow } from \"./d-shadow\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { utilIsFunction } from \"./util/util-is-function\";\nimport { utilIsNumber } from \"./util/util-is-number\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilKeyboardEvent, UtilKeyboardEventShortcut } from \"./util/util-keyboard-event\";\nimport { UtilName } from \"./util/util-name\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport interface DBaseOptions<THEME extends DThemeBase = DThemeBase> {\n\tparent?: Container;\n\tchildren?: Array<DisplayObject | null>;\n\tname?: string;\n\tx?: DCoordinate;\n\ty?: DCoordinate;\n\twidth?: DCoordinate;\n\theight?: DCoordinate;\n\tvisible?: boolean;\n\tstate?: (keyof typeof DBaseState) | Array<keyof typeof DBaseState> | DBaseState;\n\tinteractive?: (keyof typeof DBaseInteractive) | DBaseInteractive;\n\tpadding?: number | {\n\t\ttop?: number,\n\t\tright?: number,\n\t\tbottom?: number,\n\t\tleft?: number\n\t};\n\tcorner?: number | {\n\t\tradius?: number,\n\t\tmask?: (keyof typeof DCornerMask) | DCornerMask\n\t};\n\ttheme?: THEME | string;\n\ton?: {\n\t\t[name: string]: Function;\n\t};\n\tweight?: number;\n\ttitle?: string;\n\tshortcut?: string | UtilKeyboardEventShortcut;\n\tshortcuts?: Array<string | UtilKeyboardEventShortcut>;\n\tbackground?: {\n\t\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\t\talpha?: DStateAwareOrValueMightBe<number>;\n\t};\n\tborder?: {\n\t\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\t\talpha?: DStateAwareOrValueMightBe<number>;\n\t\twidth?: DStateAwareOrValueMightBe<number>;\n\t\talign?: DStateAwareOrValueMightBe<number>;\n\t\tmask?: DStateAwareOrValueMightBe<DBorderMask> | (keyof typeof DBorderMask);\n\t};\n\toutline?: {\n\t\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\t\talpha?: DStateAwareOrValueMightBe<number>;\n\t\twidth?: DStateAwareOrValueMightBe<number>;\n\t\toffset?: DStateAwareOrValueMightBe<number>;\n\t\talign?: DStateAwareOrValueMightBe<number>;\n\t\tmask?: DStateAwareOrValueMightBe<DBorderMask> | (keyof typeof DBorderMask);\n\t};\n\tshadow?: DShadow;\n\tclear?: (keyof typeof DLayoutClearType) | DLayoutClearType;\n}\n\nexport interface DThemeBase extends DThemeFont {\n\tgetX(): DCoordinate;\n\tgetY(): DCoordinate;\n\tgetHeight(): DCoordinate;\n\tgetWidth(): DCoordinate;\n\n\tgetBackgroundColor( state: DBaseState ): number | null;\n\tgetBackgroundAlpha( state: DBaseState ): number;\n\n\tgetBorderColor( state: DBaseState ): number | null;\n\tgetBorderAlpha( state: DBaseState ): number;\n\tgetBorderWidth( state: DBaseState ): number;\n\tgetBorderAlign( state: DBaseState ): number;\n\tgetBorderMask( state: DBaseState ): DBorderMask;\n\n\tgetPaddingLeft(): number;\n\tgetPaddingRight(): number;\n\tgetPaddingTop(): number;\n\tgetPaddingBottom(): number;\n\n\tgetCornerRadius(): number;\n\tgetCornerMask(): DCornerMask;\n\n\tgetOutlineColor( state: DBaseState ): number | null;\n\tgetOutlineAlpha( state: DBaseState ): number;\n\tgetOutlineWidth( state: DBaseState ): number;\n\tgetOutlineOffset( state: DBaseState ): number;\n\tgetOutlineAlign( state: DBaseState ): number;\n\tgetOutlineMask( state: DBaseState ): DBorderMask;\n\n\tgetClearType(): DLayoutClearType;\n\tgetShadow(): DShadow | null;\n\tgetInteractive(): DBaseInteractive;\n\tgetTitle(): string;\n\tgetWeight(): number;\n\n\tnewShadow(): DShadow | null;\n\tnewShadowWeak(): DShadow | null;\n}\n\nconst toTheme = <THEME extends DThemeBase>( options?: DBaseOptions<THEME> ): THEME | null => {\n\tif( options != null && options.theme != null ) {\n\t\tconst theme = options.theme;\n\t\tif( utilIsString( theme ) ) {\n\t\t\treturn DThemes.getInstance().get( theme );\n\t\t} else {\n\t\t\treturn theme;\n\t\t}\n\t}\n\treturn null;\n};\n\nexport interface DRefitable {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nconst toShortcuts = <THEME extends DThemeBase>(\n\toptions?: DBaseOptions<THEME>\n): UtilKeyboardEventShortcut[] | undefined => {\n\tif( options != null && ( options.shortcuts != null || options.shortcut != null ) ) {\n\t\tconst result: UtilKeyboardEventShortcut[] = [];\n\t\tif( options.shortcut != null ) {\n\t\t\tresult.push( UtilKeyboardEvent.toShortcut( options.shortcut ) );\n\t\t}\n\n\t\tif( options.shortcuts != null ) {\n\t\t\tconst shortcuts = options.shortcuts;\n\t\t\tfor( let i = 0, imax = shortcuts.length; i < imax; ++i ) {\n\t\t\t\tUtilKeyboardEvent.toShortcut( shortcuts[ i ] );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\treturn undefined;\n};\n\nexport interface DRenderable {\n\trender( renderer: Renderer ): void;\n\tupdateTransform(): void;\n}\n\nexport interface DReflowable {\n\tonReflow( base: DBase, width: number, height: number ): void;\n}\n\nexport class DBase<\n\tTHEME extends DThemeBase = DThemeBase,\n\tOPTIONS extends DBaseOptions<THEME> = DBaseOptions<THEME>\n> extends Container {\n\tprotected static WORK_CONTAINS_POINT: Point = new Point();\n\n\tprivate _name: string;\n\tprivate _state: DBaseState;\n\tprivate _stateLocal: DBaseState;\n\tprivate _theme: THEME;\n\tprotected _options: OPTIONS | undefined;\n\tprivate _width: number;\n\tprivate _height: number;\n\tprotected _padding: DPadding;\n\tprotected _corner: DCorner;\n\tprivate _scalarSet: DScalarSet;\n\tprotected _coordinateSet: DCoordinateSet;\n\tprivate _isDirty: boolean;\n\tprivate _hasDirty: boolean;\n\tprotected _isChildrenDirty: boolean;\n\tprivate _shadow: DShadow | null;\n\tprivate _onShadowUpdateBound: () => void;\n\tprivate _transform: Transform;\n\tprivate _weight: number;\n\tprivate _position: DBasePoint;\n\tprivate _scale: DBasePoint;\n\tprivate _skew: DBasePoint;\n\tprotected _title: string;\n\tprotected _background: DBackgroundStateAware;\n\tprotected _border: DBorderStateAware;\n\tprotected _outline: DOutline;\n\tprotected _clearType: DLayoutClearType;\n\tprotected _shortcuts?: UtilKeyboardEventShortcut[];\n\tprotected _befores: DRenderable[];\n\tprotected _afters: DRenderable[];\n\tprotected _reflowables: DReflowable[];\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper();\n\n\t\t// Transform\n\t\tconst transform: Transform = this._transform = this.transform;\n\t\tthis._position = new DBasePoint( transform.position, (): void => {\n\t\t\tthis.onMove();\n\t\t});\n\t\tthis._scale = new DBasePoint( transform.scale, (): void => {\n\t\t\tthis.onScale();\n\t\t});\n\t\tthis._skew = new DBasePoint( transform.skew, (): void => {\n\t\t\tthis.onSkew();\n\t\t});\n\n\t\t//\n\t\tthis._options = options;\n\t\tconst scalarSet: DScalarSet = this._scalarSet = {};\n\t\tthis._coordinateSet = new DCoordinateSet( this, scalarSet );\n\t\tthis._isDirty = true;\n\t\tthis._hasDirty = false;\n\t\tthis._isChildrenDirty = false;\n\t\tthis._shadow = null;\n\t\tthis._name = ( options && options.name != null ? options.name : UtilName.create( this.getType() ) );\n\t\tconst theme = this._theme = toTheme( options ) || this.getThemeDefault();\n\t\tthis._befores = [];\n\t\tthis._afters = [];\n\t\tthis._reflowables = [];\n\t\tthis._clearType = ( options && options.clear != null ?\n\t\t\t( utilIsString( options.clear ) ? DLayoutClearType[ options.clear ] : options.clear ) :\n\t\t\ttheme.getClearType()\n\t\t);\n\t\tthis._padding = new DBasePadding( theme, options, (): void => {\n\t\t\tthis.layout();\n\t\t\tthis.toChildrenDirty();\n\t\t\tDApplications.update();\n\t\t});\n\t\tconst toDirtyAndUpdate = (): void => {\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update();\n\t\t};\n\t\tthis._background = new DBaseBackground( theme, options, toDirtyAndUpdate );\n\t\tthis._border = new DBaseBorder( theme, options, toDirtyAndUpdate );\n\t\tthis._outline = new DBaseOutline( theme, options, toDirtyAndUpdate );\n\t\tthis._corner = new DBaseCorner( theme, options, toDirtyAndUpdate );\n\t\tthis.initReflowable();\n\n\t\t// X\n\t\tconst position = transform.position;\n\t\tconst x = ( options && options.x != null ? options.x : theme.getX() );\n\t\tif( utilIsNumber( x ) ) {\n\t\t\tposition.x = x;\n\t\t} else {\n\t\t\tposition.x = 0;\n\t\t\tscalarSet.x = DScalarFunctions.position( x );\n\t\t}\n\n\t\t// Y\n\t\tconst y = ( options && options.y != null ? options.y : theme.getY() );\n\t\tif( utilIsNumber( y ) ) {\n\t\t\tposition.y = y;\n\t\t} else {\n\t\t\tposition.y = 0;\n\t\t\tscalarSet.y = DScalarFunctions.position( y );\n\t\t}\n\n\t\t// Width\n\t\tconst width = ( options && options.width != null ? options.width : theme.getWidth() );\n\t\tif( utilIsNumber( width ) ) {\n\t\t\tthis._width = width;\n\t\t} else if( width === \"auto\" ) {\n\t\t\tthis._width = 100;\n\t\t\tthis._coordinateSet.toAutoWidth();\n\t\t} else {\n\t\t\tthis._width = 100;\n\t\t\tscalarSet.width = DScalarFunctions.size( width );\n\t\t}\n\n\t\t// Height\n\t\tconst height = ( options && options.height != null ? options.height : theme.getHeight() );\n\t\tif( utilIsNumber( height ) ) {\n\t\t\tthis._height = height;\n\t\t} else if( height === \"auto\" ) {\n\t\t\tthis._height = 100;\n\t\t\tthis._coordinateSet.toAutoHeight();\n\t\t} else {\n\t\t\tthis._height = 100;\n\t\t\tscalarSet.height = DScalarFunctions.size( height );\n\t\t}\n\n\t\t// Visibility\n\t\tif( options && options.visible != null ) {\n\t\t\tthis.visible = options.visible;\n\t\t}\n\n\t\t// State\n\t\tthis._state = DBaseState.NONE;\n\t\tthis._stateLocal = DBaseState.NONE;\n\n\t\t// Interactive\n\t\tconst interactive = ( options && options.interactive != null ?\n\t\t\t( utilIsString( options.interactive ) ? DBaseInteractive[ options.interactive ] : options.interactive ) :\n\t\t\ttheme.getInteractive()\n\t\t);\n\t\tthis.interactive = ( ( interactive & DBaseInteractive.SELF ) !== 0 );\n\t\tthis.interactiveChildren = ( ( interactive & DBaseInteractive.CHILDREN ) !== 0 );\n\n\t\t// Events\n\t\tif( options != null ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Title\n\t\tthis._title = ( options && options.title != null ? options.title : theme.getTitle() );\n\n\t\t// Weight\n\t\tthis._weight = ( options && options.weight != null ? options.weight : theme.getWeight() );\n\n\t\t// Shadow\n\t\tthis._onShadowUpdateBound = (): void => {\n\t\t\tDApplications.update();\n\t\t};\n\t\tconst shadow = (options && options.shadow) || theme.getShadow();\n\t\tif( shadow ) {\n\t\t\tthis.shadow = shadow;\n\t\t}\n\n\t\t// Event handlers\n\t\tthis.on( UtilPointerEvent.over, ( e: InteractionEvent ): void => {\n\t\t\t// Hover\n\t\t\tthis.setHovered( true );\n\n\t\t\t// Title\n\t\t\tif( e.target === this ) {\n\t\t\t\tthis.applyTitle();\n\t\t\t}\n\t\t});\n\n\t\tthis.on( UtilPointerEvent.out, (): void => {\n\t\t\tthis.setHovered( false );\n\t\t});\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tthis.onDown( e );\n\t\t});\n\n\t\t// Children change detection\n\t\tthis.on( \"added\", (): void => {\n\t\t\tthis.layout();\n\t\t\tif( this.isDirty() || this.hasDirty() ) {\n\t\t\t\tthis.toParentHasDirty();\n\t\t\t}\n\t\t\tif( this._isChildrenDirty ) {\n\t\t\t\tthis.toParentChildrenDirty();\n\t\t\t}\n\t\t\tthis.updateState();\n\t\t\tDApplications.update();\n\t\t});\n\n\t\tthis.on( \"removed\", (): void => {\n\t\t\tthis.blur( true );\n\t\t\tthis.updateState();\n\t\t\tDApplications.update();\n\t\t});\n\n\t\t// Shortcut\n\t\tconst shortcuts = this._shortcuts = toShortcuts( options );\n\t\tif( shortcuts != null ) {\n\t\t\tconst onShortcutBound = ( e: KeyboardEvent ): void => {\n\t\t\t\tthis.onShortcut( e );\n\t\t\t};\n\t\t\tfor( let i = 0, imax = shortcuts.length; i < imax; ++i ) {\n\t\t\t\tUtilKeyboardEvent.on( this, shortcuts[ i ], onShortcutBound );\n\t\t\t}\n\t\t}\n\n\t\t// Other initialization\n\t\tthis.init( options );\n\n\t\t// State Override\n\t\tif( options && options.state != null ) {\n\t\t\tif( utilIsString( options.state ) ) {\n\t\t\t\tthis.setState( DBaseState[ options.state ], true );\n\t\t\t} else if( utilIsNumber( options.state ) ) {\n\t\t\t\tthis.setState( options.state, true );\n\t\t\t} else {\n\t\t\t\tconst states = options.state;\n\t\t\t\tfor( let i = 0, imax = states.length; i < imax; ++i ) {\n\t\t\t\t\tthis.setState( DBaseState[ states[ i ] ], true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Parent\n\t\tif( options && options.parent != null ) {\n\t\t\toptions.parent.addChild( this );\n\t\t}\n\n\t\t// Children\n\t\tif( options && options.children != null ) {\n\t\t\tconst children = options.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child != null ) {\n\t\t\t\t\tthis.addChild( child );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Done\n\t\tthis.emit( \"init\", this );\n\t}\n\n\tprependRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\t(renderable as any).parent = this;\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tlist.unshift( renderable );\n\t}\n\n\tappendRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\t(renderable as any).parent = this;\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tlist.push( renderable );\n\t}\n\n\tremoveRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\t(renderable as any).parent = null;\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tconst index = list.indexOf( renderable );\n\t\tif( 0 <= index ) {\n\t\t\tlist.splice( index, 1 );\n\t\t}\n\t}\n\n\taddReflowable( reflowable: DReflowable ): void {\n\t\tthis._reflowables.push( reflowable );\n\t}\n\n\tremoveReflowable( reflowable: DReflowable ): void {\n\t\tconst reflowables = this._reflowables;\n\t\tconst index = reflowables.indexOf( reflowable );\n\t\tif( 0 <= index ) {\n\t\t\treflowables.splice( index, 1 );\n\t\t}\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DBaseReflowable( this );\n\t}\n\n\tprotected onChildrenChange(): void {\n\t\tthis.toChildrenDirty();\n\t\tsuper.onChildrenChange();\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ): void {\n\t\t// DO NOTHING\n\t}\n\n\tget coordinate(): DCoordinateSet {\n\t\treturn this._coordinateSet;\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\t// OTHER INITIALIZATIONS BEFORE `parent.addChild( this )`\n\t}\n\n\tget weight(): number {\n\t\treturn this._weight;\n\t}\n\n\tonMove(): void {\n\t\tthis.moveChildren();\n\t\tDApplications.update();\n\t\tthis.emit( \"move\", this );\n\t}\n\n\tresize( width: number, height: number ): boolean {\n\t\tconst oldWidth = this._width;\n\t\tconst oldHeight = this._height;\n\t\tconst widthResized = oldWidth !== width;\n\t\tconst heightResized = oldHeight !== height;\n\n\t\tif( widthResized ) {\n\t\t\tthis._width = width;\n\t\t}\n\n\t\tif( heightResized ) {\n\t\t\tthis._height = height;\n\t\t}\n\n\t\tconst resized = widthResized || heightResized;\n\t\tif( resized ) {\n\t\t\tthis.onResize( width, height, oldWidth, oldHeight );\n\t\t}\n\n\t\tif( widthResized ) {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.x != null ) {\n\t\t\t\tconst position = this._transform.position;\n\t\t\t\tconst parentSize = this.getParentSize();\n\t\t\t\tthis.x = scalarSet.x( parentSize.width, width, parentSize.padding.getLeft(), position.x );\n\t\t\t}\n\t\t}\n\n\t\tif( heightResized ) {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.y != null ) {\n\t\t\t\tconst position = this._transform.position;\n\t\t\t\tconst parentSize = this.getParentSize();\n\t\t\t\tthis.y = scalarSet.y( parentSize.height, height, parentSize.padding.getTop(), position.y );\n\t\t\t}\n\t\t}\n\n\t\treturn resized;\n\t}\n\n\tgetClearType(): DLayoutClearType {\n\t\treturn this._clearType;\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tthis.toDirty();\n\t\tthis.toChildrenDirty();\n\t\tthis.resizeChildren();\n\t\tDApplications.update();\n\t\tthis.emit( \"resize\", newWidth, newHeight, oldWidth, oldHeight, this );\n\t}\n\n\tonScale(): void {\n\t\tDApplications.update();\n\t\tthis.emit( \"scale\", this );\n\t}\n\n\tonSkew(): void {\n\t\tDApplications.update();\n\t\tthis.emit( \"skew\", this );\n\t}\n\n\tget type(): string {\n\t\treturn this.getType();\n\t}\n\n\tget name(): string {\n\t\treturn this._name;\n\t}\n\n\tset name( name: string ) {\n\t\tthis._name = name;\n\t}\n\n\tget x(): number {\n\t\treturn this._position.x;\n\t}\n\n\tset x( x: number ) {\n\t\tthis._position.x = x;\n\t}\n\n\tget y(): number {\n\t\treturn this._position.y;\n\t}\n\n\tset y( y: number ) {\n\t\tthis._position.y = y;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tconst oldWidth = this._width;\n\t\tif( oldWidth !== width ) {\n\t\t\tthis._width = width;\n\t\t\tconst height = this._height;\n\t\t\tthis.onResize( width, height, oldWidth, height );\n\n\t\t\t// Layout\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.x != null ) {\n\t\t\t\tconst position = this._transform.position;\n\t\t\t\tconst parentSize = this.getParentSize();\n\t\t\t\tthis.x = scalarSet.x( parentSize.width, width, parentSize.padding.getLeft(), position.x );\n\t\t\t}\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tconst oldHeight = this._height;\n\t\tif( oldHeight !== height ) {\n\t\t\tthis._height = height;\n\t\t\tconst width = this._width;\n\t\t\tthis.onResize( width, height, width, oldHeight );\n\n\t\t\t// Layout\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.y != null ) {\n\t\t\t\tconst position = this._transform.position;\n\t\t\t\tconst parentSize = this.getParentSize();\n\t\t\t\tthis.y = scalarSet.y( parentSize.height, height, parentSize.padding.getTop(), position.y );\n\t\t\t}\n\t\t}\n\t}\n\n\tget position() {\n\t\treturn this._position;\n\t}\n\n\tget scale() {\n\t\treturn this._scale;\n\t}\n\n\tget skew() {\n\t\treturn this._skew;\n\t}\n\n\tget padding(): DPadding {\n\t\treturn this._padding;\n\t}\n\n\tget corner(): DCorner {\n\t\treturn this._corner;\n\t}\n\n\tget background(): DBackgroundStateAware {\n\t\treturn this._background;\n\t}\n\n\tget border(): DBorderStateAware {\n\t\treturn this._border;\n\t}\n\n\tget outline(): DOutline {\n\t\treturn this._outline;\n\t}\n\n\tget unsafe(): Transform {\n\t\treturn this._transform;\n\t}\n\n\tget title(): string {\n\t\treturn this._title;\n\t}\n\n\tset title( title: string ) {\n\t\tif( this._title !== title ) {\n\t\t\tthis._title = title;\n\t\t\tif( this.isHovered() ) {\n\t\t\t\tthis.applyTitle();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected applyTitle(): void {\n\t\tDApplications.getInstance().view.title = this._title;\n\t}\n\n\tshow(): this {\n\t\tif( ! this.visible ) {\n\t\t\tthis.visible = true;\n\t\t\tthis.toParentChildrenDirty();\n\t\t\tDApplications.update();\n\t\t}\n\t\treturn this;\n\t}\n\n\tisShown(): boolean {\n\t\treturn this.visible;\n\t}\n\n\thide(): this {\n\t\tif( this.visible ) {\n\t\t\tthis.visible = false;\n\t\t\tthis.toParentChildrenDirty();\n\t\t\tDApplications.update();\n\t\t}\n\t\treturn this;\n\t}\n\n\tisHidden(): boolean {\n\t\treturn ! this.visible;\n\t}\n\n\ttoDirty(): boolean {\n\t\tif( ! this._isDirty ) {\n\t\t\tthis._isDirty = true;\n\t\t\tthis.toParentHasDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoHasDirty(): boolean {\n\t\tif( ! this._hasDirty ) {\n\t\t\tthis._hasDirty = true;\n\t\t\tthis.toParentHasDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoParentHasDirty(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.toHasDirty();\n\t\t}\n\t}\n\n\ttoChildrenDirty(): boolean {\n\t\tif( ! this._isChildrenDirty ) {\n\t\t\tthis._isChildrenDirty = true;\n\t\t\tthis.onChildrenDirty();\n\t\t\tthis.toParentChildrenDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoParentChildrenDirty(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.toChildrenDirty();\n\t\t}\n\t}\n\n\tisChildrenDirty(): boolean {\n\t\treturn this._isChildrenDirty;\n\t}\n\n\tprotected onChildrenDirty() {\n\t\t// DO NOTHING\n\t}\n\n\tisDirty() {\n\t\treturn this._isDirty;\n\t}\n\n\thasDirty() {\n\t\treturn this._hasDirty;\n\t}\n\n\tsetHovered( isHovered: boolean ) {\n\t\treturn this.setState( DBaseState.HOVERED, isHovered );\n\t}\n\n\tsetActive( isActive: boolean ) {\n\t\treturn this.setState( DBaseState.ACTIVE, isActive );\n\t}\n\n\tsetPressed( isPressed: boolean ) {\n\t\treturn this.setState( DBaseState.PRESSED, isPressed );\n\t}\n\n\tsetReadOnly( isReadOnly: boolean ) {\n\t\treturn this.setState( DBaseState.READ_ONLY, isReadOnly );\n\t}\n\n\tsetDisabled( isDisabled: boolean ) {\n\t\treturn this.setState( DBaseState.DISABLED, isDisabled );\n\t}\n\n\tsetDragging( isDragging: boolean ) {\n\t\treturn this.setState( DBaseState.DRAGGING, isDragging );\n\t}\n\n\tsetInvalid( isInvalid: boolean ) {\n\t\treturn this.setState( DBaseState.INVALID, isInvalid );\n\t}\n\n\tsetSucceeded( isSucceeded: boolean ) {\n\t\treturn this.setState( DBaseState.SUCCEEDED, isSucceeded );\n\t}\n\n\tsetFailed( isFailed: boolean ) {\n\t\treturn this.setState( DBaseState.FAILED, isFailed );\n\t}\n\n\tsetFocused( isFocused: boolean ) {\n\t\tif( this.isFocused() !== isFocused ) {\n\t\t\tDControllers.getFocusController().setFocused( this, isFocused, false );\n\t\t}\n\t\treturn this;\n\t}\n\n\tfocus(): this {\n\t\treturn this.setFocused( true );\n\t}\n\n\tblur( recursively?: boolean ): this {\n\t\tif( recursively ) {\n\t\t\tconst focusController = DControllers.getFocusController();\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused instanceof DBase ) {\n\t\t\t\tlet current: Container = focused;\n\t\t\t\twhile( current ) {\n\t\t\t\t\tif( current === this ) {\n\t\t\t\t\t\tfocused.setFocused( false );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setFocused( false );\n\t\t}\n\t\treturn this;\n\t}\n\n\tisHovered(): boolean {\n\t\treturn this.hasState( DBaseState.HOVERED );\n\t}\n\n\tisActive(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE );\n\t}\n\n\tisActiveIn(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE | DBaseState.ACTIVE_IN );\n\t}\n\n\tisPressed(): boolean {\n\t\treturn this.hasState( DBaseState.PRESSED );\n\t}\n\n\tisReadOnly(): boolean {\n\t\treturn this.hasState( DBaseState.READ_ONLY );\n\t}\n\n\tisDisabled(): boolean {\n\t\treturn this.hasState( DBaseState.DISABLED );\n\t}\n\n\tisActionable(): boolean {\n\t\treturn ! this.hasState( DBaseState.DISABLED | DBaseState.READ_ONLY );\n\t}\n\n\tisDragging(): boolean {\n\t\treturn this.hasState( DBaseState.DRAGGING );\n\t}\n\n\tisFocused(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED );\n\t}\n\n\tisFocusedIn(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED | DBaseState.FOCUSED_IN );\n\t}\n\n\tisUnfocusable(): boolean {\n\t\treturn this.hasState( DBaseState.UNFOCUSABLE );\n\t}\n\n\tisInvalid(): boolean {\n\t\treturn this.hasState( DBaseState.INVALID );\n\t}\n\n\tisSucceeded(): boolean {\n\t\treturn this.hasState( DBaseState.SUCCEEDED );\n\t}\n\n\tisFailed(): boolean {\n\t\treturn this.hasState( DBaseState.FAILED );\n\t}\n\n\tsetState( state: DBaseState, isOn: boolean ) {\n\t\tconst oldStateLocal = this._stateLocal;\n\t\tconst newStateLocal = ( isOn ? (oldStateLocal | state) : (oldStateLocal & ~state) );\n\t\tif( oldStateLocal !== newStateLocal ) {\n\t\t\tthis._stateLocal = newStateLocal;\n\t\t\tthis.updateState();\n\t\t}\n\t\treturn this;\n\t}\n\n\tsetStates( statesOn: DBaseState, statesOff: DBaseState ) {\n\t\tconst oldStateLocal = this._stateLocal;\n\t\tconst newStateLocal = ( (oldStateLocal | statesOn) & ~statesOff );\n\t\tif( oldStateLocal !== newStateLocal ) {\n\t\t\tthis._stateLocal = newStateLocal;\n\t\t\tthis.updateState();\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected updateState(): void {\n\t\tconst parent = this.parent;\n\t\tconst stateLocal = this._stateLocal;\n\t\tconst newState = ( parent instanceof DBase ?\n\t\t\tthis.mergeState( stateLocal, parent.state ) :\n\t\t\tstateLocal\n\t\t);\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn stateLocal | ( stateParent & DBaseState.DISABLED ) |\n\t\t\t( stateParent & (DBaseState.FOCUSED | DBaseState.FOCUSED_IN) ? DBaseState.FOCUSED_IN : DBaseState.NONE ) |\n\t\t\t( stateParent & (DBaseState.ACTIVE | DBaseState.ACTIVE_IN) ? DBaseState.ACTIVE_IN : DBaseState.NONE );\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tthis.toDirty();\n\t\tDApplications.update();\n\t\tthis.emit( \"statechange\", newState, oldState, this );\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentStateChange( newState, oldState );\n\t\t\t}\n\t\t}\n\n\t\tif( DBaseStates.isFocused( newState ) ) {\n\t\t\tif( ! DBaseStates.isFocused( oldState ) ) {\n\t\t\t\tthis.onFocused();\n\t\t\t}\n\t\t} else {\n\t\t\tif( DBaseStates.isFocused( oldState ) ) {\n\t\t\t\tthis.onBlured();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onChildFocused( focused: DBase ): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildFocused( focused );\n\t\t}\n\t}\n\n\tprotected onFocused(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildFocused( this );\n\t\t}\n\t}\n\n\tprotected onBlured(): void {\n\t\t//\n\t}\n\n\tprotected onParentStateChange( newStateParent: number, oldStateParent: number ) {\n\t\tconst newState = this.mergeState( this._stateLocal, newStateParent );\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tget state(): DBaseState {\n\t\treturn this._state;\n\t}\n\n\tgetState(): DBaseState {\n\t\treturn this._state;\n\t}\n\n\thasState( state: DBaseState ): boolean {\n\t\treturn DBaseStates.is( this._state, state );\n\t}\n\n\tget theme(): THEME {\n\t\treturn this._theme;\n\t}\n\n\tset theme( theme: THEME ) {\n\t\tconst result = this._theme;\n\t\tif( result !== theme ) {\n\t\t\tthis._theme = theme;\n\t\t\tthis._padding.setTheme( theme );\n\t\t\tthis._background.setTheme( theme );\n\t\t\tthis._border.setTheme( theme );\n\t\t\tthis._outline.setTheme( theme );\n\t\t\tthis._corner.setTheme( theme );\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\trefit(): void {\n\t\tif( this._isChildrenDirty ) {\n\t\t\tthis._isChildrenDirty = false;\n\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.refit();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onRefit();\n\t\t}\n\t}\n\n\tprotected onRefit(): void {\n\t\tconst coordinateSet = this._coordinateSet;\n\t\tconst isWidthAuto = coordinateSet.isWidthAuto();\n\t\tconst isHeightAuto = coordinateSet.isHeightAuto();\n\t\tif( isWidthAuto && isHeightAuto ) {\n\t\t\tlet width = 0;\n\t\t\tlet height = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible ) {\n\t\t\t\t\tif( this.hasRefitableWidth( child ) ) {\n\t\t\t\t\t\twidth = Math.max( width, child.x + child.width );\n\t\t\t\t\t}\n\t\t\t\t\tif( this.hasRefitableHeight( child ) ) {\n\t\t\t\t\t\theight = Math.max( height, child.y + child.height );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst padding = this.padding;\n\t\t\tthis.resize( width + padding.getRight(), height + padding.getBottom() );\n\t\t} else if( isWidthAuto ) {\n\t\t\tlet width = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible && this.hasRefitableWidth( child ) ) {\n\t\t\t\t\twidth = Math.max( width, child.x + child.width );\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst padding = this.padding;\n\t\t\tthis.width = width + padding.getRight();\n\t\t} else if( isHeightAuto ) {\n\t\t\tlet height = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible && this.hasRefitableHeight( child ) ) {\n\t\t\t\t\theight = Math.max( height, child.y + child.height );\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst padding = this.padding;\n\t\t\tthis.height = height + padding.getBottom();\n\t\t}\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn target instanceof DBase;\n\t}\n\n\tprotected hasRefitableHeight( target: any ): target is DRefitable {\n\t\treturn this.isRefitable( target ) &&\n\t\t\t! ( target instanceof DBase && utilIsFunction( target.coordinate.height ) );\n\t}\n\n\tprotected hasRefitableWidth( target: any ): target is DBase<any, any> {\n\t\treturn this.isRefitable( target ) &&\n\t\t\t! ( target instanceof DBase && utilIsFunction( target.coordinate.width ) );\n\t}\n\n\treflow(): void {\n\t\tif( this._isDirty ) {\n\t\t\tthis.onReflow();\n\t\t\tthis._isDirty = false;\n\t\t}\n\n\t\tif( this._hasDirty ) {\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.reflow();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._hasDirty = false;\n\t\t}\n\t}\n\n\tprotected onReflow(): void {\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst reflowables = this._reflowables;\n\t\tfor( let i = 0, imax = reflowables.length; i < imax; ++i ) {\n\t\t\treflowables[ i ].onReflow( this, width, height );\n\t\t}\n\t}\n\n\tget shadow(): DShadow | null {\n\t\treturn this._shadow;\n\t}\n\n\tset shadow( shadow: DShadow | null ) {\n\t\tconst previous = this._shadow;\n\t\tif( previous !== shadow ) {\n\t\t\tif( previous != null ) {\n\t\t\t\tprevious.off( \"update\", this._onShadowUpdateBound );\n\t\t\t\tthis.removeReflowable( previous );\n\t\t\t\tthis.removeRenderable( previous, true );\n\t\t\t}\n\n\t\t\tthis._shadow = shadow;\n\t\t\tif( shadow != null ) {\n\t\t\t\tshadow.on( \"update\", this._onShadowUpdateBound );\n\t\t\t\tthis.addReflowable( shadow );\n\t\t\t\tthis.prependRenderable( shadow, true );\n\t\t\t}\n\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tlayout(): void {\n\t\tconst size = this.getParentSize();\n\t\tthis.onParentResize( size.width, size.height, size.padding );\n\t}\n\n\tprotected getParentSize(): { width: number, height: number, padding: DPadding } {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\treturn parent;\n\t\t} else {\n\t\t\treturn DApplications.getInstance();\n\t\t}\n\t}\n\n\t/**\n\t * Called when a parent resized.\n\t *\n\t * @param parentWidth a parent's local width\n\t * @param parentHeight a parent's local height\n\t */\n\tonParentResize( parentWidth: number, parentHeight: number, parentPadding: DPadding ): void {\n\t\tconst scalarSet = this._scalarSet;\n\t\tconst position = this._transform.position;\n\t\tconst x = position.x;\n\t\tconst y = position.y;\n\t\tconst width = this._width;\n\t\tconst height = this._height;\n\n\t\t// Width & height\n\t\tconst paddingWidth = parentPadding.getLeft() + parentPadding.getRight();\n\t\tconst paddingHeight = parentPadding.getTop() + parentPadding.getBottom();\n\t\tconst newWidth = ( scalarSet.width != null ?\n\t\t\tscalarSet.width( parentWidth, width, paddingWidth, width ) : width );\n\t\tconst newHeight = ( scalarSet.height != null ?\n\t\t\tscalarSet.height( parentHeight, height, paddingHeight, height ) : height );\n\t\tthis.resize( newWidth, newHeight );\n\n\t\t// X & Y\n\t\tconst newX = ( scalarSet.x != null ? scalarSet.x( parentWidth, this.width, parentPadding.getLeft(), x ) : x );\n\t\tconst newY = ( scalarSet.y != null ? scalarSet.y( parentHeight, this.height, parentPadding.getTop(), y ) : y );\n\t\tthis.position.set( newX, newY );\n\t}\n\n\tresizeChildren(): void {\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst padding = this._padding;\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentResize( width, height, padding );\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Called when a parent moved.\n\t *\n\t * @param x a parent's local x position\n\t * @param y a parent's local y position\n\t */\n\tonParentMove( x: number, y: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected moveChildren() {\n\t\tconst x = this.x;\n\t\tconst y = this.y;\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentMove( x, y );\n\t\t\t}\n\t\t}\n\t}\n\n\t// Wheel\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tthis.emit( \"wheel\", e, deltas, global, this );\n\t\treturn false;\n\t}\n\n\t// Keydown\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tthis.emit( \"keydown\", e, this );\n\t\treturn false;\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tthis.emit( \"keyup\", e, this );\n\t\treturn false;\n\t}\n\n\t// Down\n\tprotected onDown( e: InteractionEvent ): void {\n\t\tconst target = e.target;\n\t\tif( target === this ) {\n\t\t\tthis.onDownThis( e );\n\t\t} else if( !( target instanceof DBase ) ) {\n\t\t\tlet parent = target.parent;\n\t\t\twhile( parent != null && ! ( parent instanceof DBase ) ) {\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\tif( parent === this ) {\n\t\t\t\tthis.onDownThis( e );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onDownThis( e: InteractionEvent ): void {\n\t\tconst focusController = DControllers.getFocusController();\n\t\tfocusController.setFocused( focusController.findFocusableParent( this ), true, true );\n\t}\n\n\t// Double click\n\tonDblClick( e: MouseEvent | TouchEvent ): boolean {\n\t\tthis.emit( \"dblclick\", e, this );\n\t\treturn false;\n\t}\n\n\t//\n\trender( renderer: Renderer ): void {\n\t\tif( this.visible && 0 < this.worldAlpha && this.renderable ) {\n\t\t\tthis.renderBefore( renderer );\n\t\t\tsuper.render( renderer );\n\t\t\tthis.renderAfter( renderer );\n\t\t}\n\t}\n\n\tprotected renderBefore( renderer: Renderer ): void {\n\t\tconst befores = this._befores;\n\t\tfor( let i = 0, imax = befores.length; i < imax; ++i ) {\n\t\t\tconst before = befores[ i ];\n\t\t\tbefore.updateTransform();\n\t\t\tbefore.render( renderer );\n\t\t}\n\t}\n\n\tprotected renderAfter( renderer: Renderer ): void {\n\t\tconst afters = this._afters;\n\t\tfor( let i = 0, imax = afters.length; i < imax; ++i ) {\n\t\t\tconst after = afters[ i ];\n\t\t\tafter.updateTransform();\n\t\t\tafter.render( renderer );\n\t\t}\n\t}\n\n\t//\n\tprotected getThemeDefault(): THEME {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DBase\";\n\t}\n\n\t//\n\tprotected _calculateBounds(): void {\n\t\tconst worldTransform = this._transform.worldTransform;\n\t\tconst bounds = this._bounds;\n\n\t\tconst work = DBase.WORK_CONTAINS_POINT;\n\t\twork.set( 0, 0 );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\twork.set( this._width, this._height );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\tsuper._calculateBounds();\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\treturn this.containsGlobalPoint( point ) || this.containsLocalPoint(\n\t\t\tthis.worldTransform.applyInverse( point, DBase.WORK_CONTAINS_POINT )\n\t\t);\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\tprotected containsLocalPoint( point: Point ): boolean {\n\t\treturn (\n\t\t\t0 <= point.x && point.x <= this.width &&\n\t\t\t0 <= point.y && point.y <= this.height\n\t\t);\n\t}\n\n\tdestroy(): void {\n\t\t// Layout\n\t\tconst scalarSet = this._scalarSet;\n\t\tscalarSet.x = null;\n\t\tscalarSet.y = null;\n\t\tscalarSet.width = null;\n\t\tscalarSet.height = null;\n\n\t\t// Shadow\n\t\tconst shadow = this._shadow;\n\t\tif( shadow ) {\n\t\t\tthis._shadow = null;\n\t\t\tshadow.destroy();\n\t\t}\n\n\t\t// Children\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { MeshGeometry } from \"pixi.js\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\nimport { DynamicFontAtlasCharacter } from \"./util/dynamic-font-atlas-character\";\n\nexport class DDynamicTextGeometry extends MeshGeometry {\n\tprotected static WORK: Uint32Array | null = null;\n\twidth: number;\n\theight: number;\n\n\tconstructor() {\n\t\tsuper( new Float32Array( 64 ), new Float32Array( 64 ), new Uint16Array( 48 ) );\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t}\n\n\tupdate( text: string, atlas: DynamicFontAtlas | null, clippingWidth: number | undefined ): void {\n\t\tconst vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tconst uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tconst indexBuffer = this.getIndex();\n\n\t\tconst result = this.measureText( text, atlas, clippingWidth );\n\t\tconst requiredTextSize = Math.ceil( result[ 1 ] / 8 ) << 3;\n\t\tconst requiredVertexSize = requiredTextSize << 3;\n\t\tif( (vertexBuffer.data as Float32Array).length < requiredVertexSize ) {\n\t\t\tvertexBuffer.data = new Float32Array( requiredVertexSize );\n\t\t\tuvBuffer.data = new Float32Array( requiredVertexSize );\n\t\t}\n\t\tconst requiredIndexSize = requiredTextSize * 6;\n\t\tif( (indexBuffer.data as Uint16Array).length < requiredIndexSize ) {\n\t\t\tindexBuffer.data = new Uint16Array( requiredIndexSize );\n\t\t}\n\n\t\tconst vertices = vertexBuffer.data as Float32Array;\n\t\tconst uvs = uvBuffer.data as Float32Array;\n\t\tconst indices = indexBuffer.data as Uint16Array;\n\n\t\tif( atlas != null ) {\n\t\t\tlet x = 0;\n\t\t\tlet y = 0;\n\t\t\tlet ichar = 0;\n\t\t\tfor( let i = 0, imax = result[ 0 ]; i < imax; ++i ) {\n\t\t\t\tconst k = (1 + i) * 3;\n\t\t\t\tfor( let j = result[ k + 0 ], jmax = result[ k + 1 ]; j < jmax; j += 1, ichar += 1 ) {\n\t\t\t\t\tconst a = atlas.get( text[ j ] );\n\t\t\t\t\tif( a != null ) {\n\t\t\t\t\t\tthis.writeCharacter(\n\t\t\t\t\t\t\tvertices, uvs, indices,\n\t\t\t\t\t\t\tichar, x, y,\n\t\t\t\t\t\t\ta, atlas.width, atlas.height\n\t\t\t\t\t\t);\n\t\t\t\t\t\tx += a.advance;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, ichar );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( result[ k + 2 ] ) {\n\t\t\t\t\tconst a = atlas.get( \"...\" );\n\t\t\t\t\tif( a != null ) {\n\t\t\t\t\t\tthis.writeCharacter(\n\t\t\t\t\t\t\tvertices, uvs, indices,\n\t\t\t\t\t\t\tichar, x, y,\n\t\t\t\t\t\t\ta, atlas.width, atlas.height\n\t\t\t\t\t\t);\n\t\t\t\t\t\tx += a.advance;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, ichar );\n\t\t\t\t\t}\n\t\t\t\t\tichar += 1;\n\t\t\t\t}\n\t\t\t\tx = 0;\n\t\t\t\ty += atlas.font.height;\n\t\t\t}\n\t\t\tfor( let i = ichar, imax = vertices.length >> 3; i < imax; ++i ) {\n\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, i );\n\t\t\t}\n\t\t\tthis.width = result[ 2 ];\n\t\t\tthis.height = y;\n\t\t} else {\n\t\t\tfor( let i = 0, imax = vertices.length >> 3; i < imax; ++i ) {\n\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, i );\n\t\t\t}\n\t\t\tthis.width = 0;\n\t\t\tthis.height = 0;\n\t\t}\n\n\t\tvertexBuffer.update();\n\t\tuvBuffer.update();\n\t\tindexBuffer.update();\n\t}\n\n\tprotected writeCharacter(\n\t\tvertices: Float32Array, uvs: Float32Array, indices: Uint16Array,\n\t\tindex: number, x: number, y: number,\n\t\tcharacter: DynamicFontAtlasCharacter,\n\t\twidth: number, height: number\n\t): void {\n\t\tconst offsetX = character.x - character.origin.x;\n\t\tconst offsetY = 0;\n\n\t\tconst iv = index << 3;\n\t\tvertices[ iv + 0 ] = x + offsetX;\n\t\tvertices[ iv + 1 ] = y + offsetY;\n\t\tvertices[ iv + 2 ] = x + offsetX + character.width;\n\t\tvertices[ iv + 3 ] = y + offsetY;\n\t\tvertices[ iv + 4 ] = x + offsetX + character.width;\n\t\tvertices[ iv + 5 ] = y + offsetY + character.height;\n\t\tvertices[ iv + 6 ] = x + offsetX;\n\t\tvertices[ iv + 7 ] = y + offsetY + character.height;\n\n\t\tconst x0 = character.x / width;\n\t\tconst y0 = character.y / height;\n\t\tconst x1 = ( character.x + character.width ) / width;\n\t\tconst y1 = ( character.y + character.height ) / height;\n\t\tuvs[ iv + 0 ] = x0;\n\t\tuvs[ iv + 1 ] = y0;\n\t\tuvs[ iv + 2 ] = x1;\n\t\tuvs[ iv + 3 ] = y0;\n\t\tuvs[ iv + 4 ] = x1;\n\t\tuvs[ iv + 5 ] = y1;\n\t\tuvs[ iv + 6 ] = x0;\n\t\tuvs[ iv + 7 ] = y1;\n\n\t\tconst ii = index * 6;\n\t\tconst vo = index << 2;\n\t\tindices[ ii + 0 ] = vo + 0;\n\t\tindices[ ii + 1 ] = vo + 1;\n\t\tindices[ ii + 2 ] = vo + 3;\n\t\tindices[ ii + 3 ] = vo + 1;\n\t\tindices[ ii + 4 ] = vo + 2;\n\t\tindices[ ii + 5 ] = vo + 3;\n\t}\n\n\tprotected writeCharacterEmpty(\n\t\tvertices: Float32Array, uvs: Float32Array, indices: Uint16Array,\n\t\tindex: number\n\t): void {\n\t\tconst iv = index << 3;\n\t\tvertices[ iv + 0 ] = 0;\n\t\tvertices[ iv + 1 ] = 0;\n\t\tvertices[ iv + 2 ] = 0;\n\t\tvertices[ iv + 3 ] = 0;\n\t\tvertices[ iv + 4 ] = 0;\n\t\tvertices[ iv + 5 ] = 0;\n\t\tvertices[ iv + 6 ] = 0;\n\t\tvertices[ iv + 7 ] = 0;\n\n\t\tuvs[ iv + 0 ] = 0;\n\t\tuvs[ iv + 1 ] = 0;\n\t\tuvs[ iv + 2 ] = 0;\n\t\tuvs[ iv + 3 ] = 0;\n\t\tuvs[ iv + 4 ] = 0;\n\t\tuvs[ iv + 5 ] = 0;\n\t\tuvs[ iv + 6 ] = 0;\n\t\tuvs[ iv + 7 ] = 0;\n\n\t\tconst ii = index * 6;\n\t\tconst vo = index << 2;\n\t\tindices[ ii + 0 ] = vo + 0;\n\t\tindices[ ii + 1 ] = vo + 1;\n\t\tindices[ ii + 2 ] = vo + 3;\n\t\tindices[ ii + 3 ] = vo + 1;\n\t\tindices[ ii + 4 ] = vo + 2;\n\t\tindices[ ii + 5 ] = vo + 3;\n\t}\n\n\tprotected measureText(\n\t\ttext: string, atlas: DynamicFontAtlas | null, clippingWidth: number | undefined\n\t): Uint32Array {\n\t\tlet result = DDynamicTextGeometry.WORK = DDynamicTextGeometry.WORK || new Uint32Array( 3 * 16 );\n\t\tresult[ 0 ] = 0;\n\t\tresult[ 1 ] = 0;\n\t\tresult[ 2 ] = 0;\n\t\tresult[ 3 ] = 0;\n\t\tif( atlas != null ) {\n\t\t\tlet x = 0;\n\t\t\tconst l = text.length;\n\t\t\tfor( let i = 0; i < l; ++i ) {\n\t\t\t\tconst char = text[ i ];\n\t\t\t\tif( char === \"\\n\" ) {\n\t\t\t\t\tresult = this.setResult( result, i, false, x, i + 1 );\n\t\t\t\t\tx = 0;\n\t\t\t\t} else {\n\t\t\t\t\tconst a = atlas.get( char );\n\t\t\t\t\tif( a != null ) {\n\t\t\t\t\t\tif( clippingWidth != null && clippingWidth < x + a.advance ) {\n\t\t\t\t\t\t\tconst dots = atlas.get( \"...\" );\n\t\t\t\t\t\t\tconst iend = ( (dots != null && clippingWidth < x + dots.advance) ? i - 1 : i );\n\t\t\t\t\t\t\tlet inext = i + 1;\n\t\t\t\t\t\t\tfor( ; inext < l; ++inext ) {\n\t\t\t\t\t\t\t\tif( text[ inext ] === \"\\n\" ) {\n\t\t\t\t\t\t\t\t\tinext += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tresult = this.setResult( result, iend, true, x, inext );\n\t\t\t\t\t\t\ti = inext - 1;\n\t\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tx += a.advance;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tresult = this.setResult( result, l, false, x, l );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected setResult( result: Uint32Array, iend: number, hasDots: boolean, x: number, inext: number ): Uint32Array {\n\t\tconst iresult = ( 1 + result[ 0 ] ) * 3;\n\t\tlet istart = result[ iresult + 0 ];\n\t\tif( istart < iend || hasDots ) {\n\t\t\tistart = Math.min( istart, iend );\n\t\t\tresult[ iresult + 0 ] = istart;\n\t\t\tresult[ iresult + 1 ] = iend;\n\t\t\tresult[ iresult + 2 ] = ( hasDots ? 1 : 0 );\n\t\t\tif( result.length <= iresult + 3 ) {\n\t\t\t\tconst newResult = new Uint32Array( result.length + 3 * 16 );\n\t\t\t\tnewResult.set( result );\n\t\t\t\tresult = newResult;\n\t\t\t\tDDynamicTextGeometry.WORK = newResult;\n\t\t\t}\n\t\t\tresult[ 0 ] += 1;\n\t\t\tresult[ 1 ] += iend - istart;\n\t\t\tresult[ 2 ] = Math.max( result[ 2 ], Math.ceil( x ) );\n\t\t\tresult[ iresult + 3 ] = inext;\n\t\t} else {\n\t\t\tresult[ iresult + 0 ] = inext;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DFontStyle, DFontVariant, DFontWeight, DThemeFont } from \"./d-font\";\nimport { DThemes } from \"./theme/d-themes\";\n\nexport type DDynamicTextAlign = \"left\" | \"center\" | \"right\";\n\nexport interface DDynamicTextStyleOptions {\n\talign?: DDynamicTextAlign;\n\tfontFamily?: string;\n\tfontSize?: number;\n\tfontStyle?: DFontStyle;\n\tfontVariant?: DFontVariant;\n\tfontWeight?: DFontWeight;\n\tfill?: number;\n\tclipping?: boolean;\n}\n\nexport class DDynamicTextStyle {\n\tprotected static FONT: DThemeFont | null = null;\n\n\tprotected _id: number;\n\tprotected _idApproved: number;\n\tprotected _fontIdId: number;\n\tprotected _fontId: string;\n\tprotected _fontIdApproved: string;\n\tprotected _align: DDynamicTextAlign;\n\tprotected _fontFamily: string;\n\tprotected _fontSize: number;\n\tprotected _fontStyle: DFontStyle;\n\tprotected _fontVariant: DFontVariant;\n\tprotected _fontWeight: DFontWeight;\n\tprotected _fill: number;\n\tprotected _fillApproved: number;\n\tprotected _clipping: boolean;\n\tprotected _onChange: () => void;\n\n\tconstructor( options: DDynamicTextStyleOptions | undefined, onChange: () => void ) {\n\t\tthis._id = 0;\n\t\tthis._idApproved = -1;\n\n\t\tconst font = DDynamicTextStyle.FONT = (\n\t\t\tDDynamicTextStyle.FONT || DThemes.getInstance().get( \"DBase\" ) as DThemeFont\n\t\t);\n\t\tthis._align = (options && options.align) || \"left\";\n\t\tthis._fontFamily = (options && options.fontFamily) || font.getFontFamilly();\n\t\tthis._fontSize = (options && options.fontSize) || font.getFontSize();\n\t\tthis._fontStyle = (options && options.fontStyle) || \"normal\";\n\t\tthis._fontVariant = (options && options.fontVariant) || \"normal\";\n\t\tthis._fontWeight = (options && options.fontWeight) || \"normal\";\n\n\t\tthis._fontIdId = -1;\n\t\tthis._fontId = \"\";\n\t\tthis._fontIdApproved = \"\";\n\n\t\tthis._fill = (options && options.fill) || font.getColor( 0 );\n\t\tthis._fillApproved = 0x000000;\n\n\t\tthis._clipping = ((options && options.clipping != null) ? options.clipping : true);\n\n\t\tthis._onChange = onChange;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget idApproved(): number {\n\t\treturn this._idApproved;\n\t}\n\n\tget fontId(): string {\n\t\tthis.update();\n\t\treturn this._fontId;\n\t}\n\n\tget fontIdApproved(): string {\n\t\treturn this._fontIdApproved;\n\t}\n\n\tget fill(): number {\n\t\treturn this._fill;\n\t}\n\n\tset fill( fill: number ) {\n\t\tif( this._fill !== fill ) {\n\t\t\tthis._fill = fill;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tthis._id += 1;\n\t\tthis._onChange();\n\t}\n\n\tget fillApproved(): number {\n\t\treturn this._fillApproved;\n\t}\n\n\tapprove(): void {\n\t\tthis.update();\n\t\tthis._idApproved = this._id;\n\t\tthis._fontIdApproved = this._fontId;\n\t\tthis._fillApproved = this._fill;\n\t}\n\n\tget fontFamily(): string {\n\t\treturn this._fontFamily;\n\t}\n\n\tset fontFamily( fontFamily: string ) {\n\t\tif( this._fontFamily !== fontFamily ) {\n\t\t\tthis._fontFamily = fontFamily;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontSize(): number {\n\t\treturn this._fontSize;\n\t}\n\n\tset fontSize( fontSize: number ) {\n\t\tif( this._fontSize !== fontSize ) {\n\t\t\tthis._fontSize = fontSize;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontStyle(): DFontStyle {\n\t\treturn this._fontStyle;\n\t}\n\n\tset fontStyle( fontStyle: DFontStyle ) {\n\t\tif( this._fontStyle !== fontStyle ) {\n\t\t\tthis._fontStyle = fontStyle;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontVariant(): DFontVariant {\n\t\treturn this._fontVariant;\n\t}\n\n\tset fontVariant( fontVariant: DFontVariant ) {\n\t\tif( this._fontVariant !== fontVariant ) {\n\t\t\tthis._fontVariant = fontVariant;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontWeight(): DFontWeight {\n\t\treturn this._fontWeight;\n\t}\n\n\tset fontWeight( fontWeight: DFontWeight ) {\n\t\tif( this._fontWeight !== fontWeight ) {\n\t\t\tthis._fontWeight = fontWeight;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected update(): void {\n\t\tif( this._fontIdId !== this._id ) {\n\t\t\tthis._fontIdId = this._id;\n\t\t\tthis._fontId = this.newFontId();\n\t\t}\n\t}\n\n\tprotected newFontId(): string {\n\t\treturn `${this._fontStyle} ${this._fontVariant} ${this._fontWeight} ${this._fontSize}px ${this._fontFamily}`;\n\t}\n\n\tget clipping(): boolean {\n\t\treturn this._clipping;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tif( this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const ASCII_CHARACTERS =\n\t\" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\";\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DynamicFontAtlasCharacterOrigin {\n\tx: number;\n\ty: number;\n\n\tconstructor( x: number, y: number ) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicFontAtlasCharacterOrigin } from \"./dynamic-font-atlas-chaaracter-origin\";\n\nexport class DynamicFontAtlasCharacter {\n\tref: number;\n\tlife: number;\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tadvance: number;\n\torigin: DynamicFontAtlasCharacterOrigin;\n\treserved: boolean;\n\n\tconstructor( advance: number, width: number, height: number, reserved: boolean ) {\n\t\tthis.ref = 1;\n\t\tthis.life = 10;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.advance = advance;\n\t\tthis.origin = new DynamicFontAtlasCharacterOrigin( 0, 0 );\n\t\tthis.reserved = reserved;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { TextMetrics, utils } from \"pixi.js\";\n\nexport class DynamicFontAtlasFont {\n\tid: string;\n\tsize: number;\n\tcolor: string;\n\theight: number;\n\n\tascent: number;\n\tdescent: number;\n\n\tconstructor( fontId: string, size: number, color: number, padding: number ) {\n\t\tthis.id = fontId;\n\t\tthis.size = size;\n\t\tthis.color = utils.hex2string( color );\n\t\tthis.height = this.size + padding * 2;\n\t\tconst metrics = TextMetrics.measureFont( fontId );\n\t\tthis.ascent = metrics.ascent;\n\t\tthis.descent = metrics.descent;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { MIPMAP_MODES, SCALE_MODES, settings, Texture } from \"pixi.js\";\nimport { ASCII_CHARACTERS } from \"./ascii\";\nimport { DynamicFontAtlasCharacter } from \"./dynamic-font-atlas-character\";\nimport { DynamicFontAtlasCharacters } from \"./dynamic-font-atlas-characters\";\nimport { DynamicFontAtlasFont } from \"./dynamic-font-atlas-font\";\n\nconst PADDING = 3;\n\nexport class DynamicFontAtlas {\n\tprotected _id: string;\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _context: CanvasRenderingContext2D | null;\n\tprotected _font: DynamicFontAtlasFont;\n\tprotected _characters: DynamicFontAtlasCharacters;\n\tprotected _length: number;\n\tprotected _unrefCount: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _revision: number;\n\tprotected _revisionUpdated: number;\n\tprotected _texture: Texture;\n\n\tconstructor( fontId: string, fontSize: number, fontColor: number ) {\n\t\tthis._id = fontId;\n\t\tthis._canvas = document.createElement( \"canvas\" );\n\t\tthis._context = null;\n\t\tthis._font = new DynamicFontAtlasFont( fontId, fontSize, fontColor, PADDING );\n\t\tthis._characters = {};\n\t\tthis._length = 0;\n\t\tthis._unrefCount = 0;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\t\tthis._revision = 0;\n\t\tthis._revisionUpdated = 0;\n\t\tthis._texture = Texture.from( this._canvas, {\n\t\t\tmipmap: MIPMAP_MODES.OFF,\n\t\t\tresolution: settings.RESOLUTION,\n\t\t\tscaleMode: SCALE_MODES.NEAREST\n\t\t});\n\n\t\tthis.add( ASCII_CHARACTERS, true );\n\t\tthis.add_( \"...\", this._characters, true );\n\t}\n\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget font(): DynamicFontAtlasFont {\n\t\treturn this._font;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tget canvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tget characters(): DynamicFontAtlasCharacters {\n\t\treturn this._characters;\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tprotected add_( character: string, characters: DynamicFontAtlasCharacters, reserved?: boolean ): void {\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( ! data.reserved ) {\n\t\t\t\t\tif( data.ref === 0 ) {\n\t\t\t\t\t\tthis._unrefCount -= 1;\n\t\t\t\t\t}\n\t\t\t\t\tdata.ref += 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst advance = this.getAdvance( character );\n\t\t\t\tconst width = Math.ceil( PADDING + advance + PADDING );\n\t\t\t\tconst height = this.font.height;\n\t\t\t\tcharacters[ character ] = new DynamicFontAtlasCharacter( advance, width, height, !! reserved );\n\t\t\t\tthis._length += 1;\n\t\t\t\tthis._revision += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected remove_( character: string, characters: DynamicFontAtlasCharacters ): void {\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( ! data.reserved && 0 < data.ref ) {\n\t\t\t\t\tdata.ref -= 1;\n\t\t\t\t\tif( data.ref === 0 ) {\n\t\t\t\t\t\tthis._unrefCount += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup_(): void {\n\t\tif( (this._length >> 1) <= this._unrefCount ) {\n\t\t\tconst characters = this._characters;\n\t\t\tfor( const character in characters ) {\n\t\t\t\tif( characters[ character ].ref <= 0 ) {\n\t\t\t\t\tdelete characters[ character ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._length -= this._unrefCount;\n\t\t\tthis._revision += 1;\n\t\t\tthis._unrefCount = 0;\n\t\t}\n\t}\n\n\tadd( targets: string, reserved?: boolean ): void {\n\t\tconst characters = this._characters;\n\t\tfor( let i = 0, imax = targets.length; i < imax; ++i ) {\n\t\t\tthis.add_( targets[ i ], characters, reserved );\n\t\t}\n\t}\n\n\tremove( targets: string ): void {\n\t\tconst characters = this._characters;\n\t\tfor( let i = 0, imax = targets.length; i < imax; ++i ) {\n\t\t\tthis.remove_( targets[ i ], characters );\n\t\t}\n\t}\n\n\tget( character: string ): DynamicFontAtlasCharacter | undefined {\n\t\treturn this._characters[ character ];\n\t}\n\n\tgetAdvance( target: string ): number {\n\t\tconst context = this.getContext();\n\t\tif( context != null ) {\n\t\t\treturn context.measureText( target ).width;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetContext(): CanvasRenderingContext2D | null {\n\t\tlet context = this._context;\n\t\tif( context == null ) {\n\t\t\tconst canvas = this._canvas;\n\t\t\tif( canvas != null ) {\n\t\t\t\tcontext = this._context = canvas.getContext( \"2d\", { alpha: true } );\n\t\t\t\tif( context == null ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tconst font = this._font;\n\t\tif( context.font !== font.id ) {\n\t\t\tcontext.font = font.id;\n\t\t\tfont.id = context.font;\n\t\t\tcontext.textAlign = \"left\";\n\t\t\tcontext.textBaseline = \"alphabetic\";\n\t\t\tcontext.lineWidth = 0;\n\t\t\tcontext.lineCap = \"round\";\n\t\t\tcontext.lineJoin = \"miter\";\n\t\t\tcontext.miterLimit = 0;\n\t\t\tcontext.fillStyle = font.color;\n\t\t\tcontext.strokeStyle = \"#0000ff\";\n\t\t}\n\t\treturn context;\n\t}\n\n\tupdate(): boolean {\n\t\tthis.cleanup_();\n\n\t\tif( this._revisionUpdated < this._revision ) {\n\t\t\tthis._revisionUpdated = this._revision;\n\n\t\t\tconst canvas = this._canvas;\n\t\t\tif( canvas != null ) {\n\t\t\t\tconst font = this._font;\n\t\t\t\tconst fontHeight = font.height;\n\t\t\t\tconst characters = this._characters;\n\t\t\t\tconst width = this._width = this.toPowerOf2( Math.ceil( Math.sqrt( this._length ) ) * fontHeight );\n\n\t\t\t\tconst offsetX = PADDING;\n\t\t\t\tconst offsetY = Math.round( (fontHeight - (font.ascent + font.descent)) * 0.5 + font.ascent );\n\t\t\t\tlet x = 0;\n\t\t\t\tlet y = 0;\n\t\t\t\tfor( const key in characters ) {\n\t\t\t\t\tconst character = characters[ key ];\n\t\t\t\t\tif( width <= x + character.width ) {\n\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\ty += fontHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tcharacter.x = x;\n\t\t\t\t\tcharacter.y = y;\n\t\t\t\t\tcharacter.origin.x = x + offsetX;\n\t\t\t\t\tcharacter.origin.y = y + offsetY;\n\n\t\t\t\t\tx += character.width;\n\t\t\t\t}\n\t\t\t\tconst height = this._height = y + fontHeight;\n\n\t\t\t\t// Make a input canvas\n\t\t\t\t// Here, we need to reset the context because\n\t\t\t\t// context settings will be lost when we set the width/height.\n\t\t\t\tconst baseTexture = this._texture.baseTexture;\n\t\t\t\tconst resolution = baseTexture.resolution;\n\t\t\t\tconst realWidth = Math.ceil( width * resolution );\n\t\t\t\tconst realHeight = Math.ceil( height * resolution );\n\t\t\t\tcanvas.width = realWidth;\n\t\t\t\tcanvas.height = realHeight;\n\t\t\t\tconst context = this.getContext();\n\t\t\t\tif( context != null ) {\n\t\t\t\t\tcontext.save();\n\t\t\t\t\tcontext.scale( resolution, resolution );\n\t\t\t\t\tcontext.clearRect( 0, 0, width, height );\n\t\t\t\t\tfor( const key in characters ) {\n\t\t\t\t\t\tconst character = characters[ key ];\n\t\t\t\t\t\tcontext.fillText( key, character.origin.x, character.origin.y );\n\t\t\t\t\t}\n\t\t\t\t\tcontext.restore();\n\t\t\t\t}\n\t\t\t\tbaseTexture.setRealSize( realWidth, realHeight );\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetRevision(): number {\n\t\treturn this._revision;\n\t}\n\n\tgetRevisionUpdate(): number {\n\t\treturn this._revisionUpdated;\n\t}\n\n\tget length(): number {\n\t\treturn this._length;\n\t}\n\n\tdestroy() {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t}\n\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tdelete characters[ character ];\n\t\t}\n\t}\n\n\ttoPowerOf2( size: number ): number {\n\t\tlet result = 32;\n\t\twhile( result < size ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../d-applications\";\nimport { DynamicFontAtlas } from \"./dynamic-font-atlas\";\n\nconst update = ( atlas: DynamicFontAtlas ): void => {\n\tatlas.update();\n};\n\nconst updateAll = ( colorToAltas: Map<number, DynamicFontAtlas> ): void => {\n\tcolorToAltas.forEach( update );\n};\n\nconst destroy = ( atlas: DynamicFontAtlas ): void => {\n\tatlas.update();\n};\n\nconst destroyAll = ( colorToAltas: Map<number, DynamicFontAtlas> ): void => {\n\tcolorToAltas.forEach( destroy );\n};\n\nexport class DynamicFontAtlases {\n\tprotected static INSTANCE: DynamicFontAtlases | null = null;\n\tprotected _atlases: Map<string, Map<number, DynamicFontAtlas>>;\n\n\tconstructor() {\n\t\tthis._atlases = new Map<string, Map<number, DynamicFontAtlas>>();\n\n\t\tDApplications.getInstance().renderer.on( \"prerender\", (): void => {\n\t\t\tthis.update();\n\t\t});\n\t}\n\n\tadd( fontId: string, fontSize: number, fontColor: number, targets: string ): void {\n\t\tconst atlases = this._atlases;\n\t\tlet colorToAtlas = atlases.get( fontId );\n\t\tif( colorToAtlas == null ) {\n\t\t\tcolorToAtlas = new Map<number, DynamicFontAtlas>();\n\t\t\tatlases.set( fontId, colorToAtlas );\n\t\t}\n\t\tlet atlas = colorToAtlas.get( fontColor );\n\t\tif( atlas == null ) {\n\t\t\tatlas = new DynamicFontAtlas( fontId, fontSize, fontColor );\n\t\t\tcolorToAtlas.set( fontColor, atlas );\n\t\t}\n\t\tatlas.add( targets );\n\t}\n\n\tremove( fontId: string, fontColor: number, targets: string ): void {\n\t\tconst colorToAtlas = this._atlases.get( fontId );\n\t\tif( colorToAtlas != null ) {\n\t\t\tconst atlas = colorToAtlas.get( fontColor );\n\t\t\tif( atlas != null ) {\n\t\t\t\tatlas.remove( targets );\n\t\t\t}\n\t\t}\n\t}\n\n\tget( fontId: string, fontColor: number ): DynamicFontAtlas | null {\n\t\tconst atlases = this._atlases;\n\t\tconst colorToAtlas = atlases.get( fontId );\n\t\tif( colorToAtlas == null ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst atlas = colorToAtlas.get( fontColor );\n\t\tif( atlas == null ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn atlas;\n\t}\n\n\tupdate(): void {\n\t\tthis._atlases.forEach( updateAll );\n\t}\n\n\tdestroy() {\n\t\tconst atlases = this._atlases;\n\t\tatlases.forEach( destroyAll );\n\t\tatlases.clear();\n\t}\n\n\tstatic getInstance(): DynamicFontAtlases {\n\t\tif( DynamicFontAtlases.INSTANCE == null ) {\n\t\t\tDynamicFontAtlases.INSTANCE = new DynamicFontAtlases();\n\t\t}\n\t\treturn DynamicFontAtlases.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Renderer, Texture } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DDynamicTextGeometry } from \"./d-dynamic-text-geometry\";\nimport { DDynamicTextStyle, DDynamicTextStyleOptions } from \"./d-dynamic-text-style\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\nimport { DynamicFontAtlases } from \"./util/dynamic-font-atlases\";\n\nexport class DDynamicText extends Mesh {\n\tprotected _style: DDynamicTextStyle;\n\tprotected _text: string;\n\tprotected _textApproved: string;\n\tprotected _isDirty: boolean;\n\tprotected _isGeometryDirty: boolean;\n\tprotected _atlas: DynamicFontAtlas | null;\n\tprotected _atlasRevisionUpdated: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _clippingWidth: number | undefined;\n\tprotected _clippingWidthDelta: number;\n\n\treadonly geometry!: DDynamicTextGeometry;\n\n\tconstructor( text: string, options?: DDynamicTextStyleOptions ) {\n\t\tsuper( new DDynamicTextGeometry(), new MeshMaterial( Texture.EMPTY ) );\n\n\t\tthis._style = new DDynamicTextStyle( options, (): void => {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._isGeometryDirty = true;\n\t\t\tthis._atlas = null;\n\t\t\tthis.update_();\n\t\t});\n\t\tthis._text = text;\n\t\tthis._textApproved = \"\";\n\t\tthis._isDirty = true;\n\t\tthis._isGeometryDirty = true;\n\t\tthis._atlas = null;\n\t\tthis._atlasRevisionUpdated = 0;\n\t\tthis._width = 0;\n\t\tthis._height = 0;\n\t\tthis._clippingWidthDelta = 0;\n\t\tthis.update_();\n\t}\n\n\tprotected update_(): void {\n\t\tconst style = this._style;\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\n\t\t\tconst text = this._text;\n\t\t\tconst textApproved = this._textApproved;\n\t\t\tthis._textApproved = text;\n\t\t\tconst fontId = style.fontId;\n\t\t\tconst fontIdApproved = style.fontIdApproved;\n\t\t\tconst fontSize = style.fontSize;\n\t\t\tconst fill = style.fill;\n\t\t\tconst fillApproved = style.fillApproved;\n\t\t\tstyle.approve();\n\n\t\t\tconst atlases = DynamicFontAtlases.getInstance();\n\t\t\tif( text !== textApproved || fontId !== fontIdApproved || fill !== fillApproved ) {\n\t\t\t\tatlases.add( fontId, fontSize, fill, text );\n\t\t\t\tatlases.remove( fontIdApproved, fillApproved, textApproved );\n\t\t\t}\n\t\t}\n\t}\n\n\tget text(): string {\n\t\treturn this._text;\n\t}\n\n\tset text( text: string ) {\n\t\tif( this._text !== text ) {\n\t\t\tthis._text = text;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._isGeometryDirty = true;\n\t\t\tthis.update_();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tthis.update();\n\t\treturn Math.abs( this.scale.x ) * this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.update();\n\t\tconst geometryWidth = this.geometry.width;\n\t\tif( +1e-4 < geometryWidth ) {\n\t\t\tconst newScale = width / geometryWidth;\n\t\t\tthis.scale.x = ( 0 <= this.scale.x ? +newScale : -newScale );\n\t\t}\n\t}\n\n\tget height(): number {\n\t\tthis.update();\n\t\treturn Math.abs( this.scale.y ) * this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.update();\n\t\tconst geometryHeight = this.geometry.height;\n\t\tif( +1e-4 < geometryHeight ) {\n\t\t\tconst newScale = height / geometryHeight;\n\t\t\tthis.scale.y = ( 0 <= this.scale.y ? +newScale : -newScale );\n\t\t}\n\t}\n\n\tget style(): DDynamicTextStyle {\n\t\treturn this._style;\n\t}\n\n\tupdate(): void {\n\t\tthis.update_();\n\n\t\tlet atlas = this._atlas;\n\t\tif( atlas == null ) {\n\t\t\tconst style = this._style;\n\t\t\tatlas = DynamicFontAtlases.getInstance().get( style.fontId, style.fill );\n\t\t\tif( atlas != null ) {\n\t\t\t\tthis._atlasRevisionUpdated = atlas.getRevisionUpdate();\n\t\t\t\tthis._atlas = atlas;\n\t\t\t\tthis.texture = atlas.texture;\n\t\t\t\tthis._isGeometryDirty = true;\n\t\t\t}\n\t\t} else {\n\t\t\tconst revisionUpdate = atlas.getRevisionUpdate();\n\t\t\tif( revisionUpdate !== this._atlasRevisionUpdated ) {\n\t\t\t\tthis._atlasRevisionUpdated = revisionUpdate;\n\t\t\t\tthis._isGeometryDirty = true;\n\t\t\t}\n\t\t}\n\n\t\tconst clippingWidth = this._clippingWidth;\n\t\tconst newClippingWidth = this.getClippingWidth();\n\t\tif( clippingWidth !== newClippingWidth ) {\n\t\t\tthis._clippingWidth = newClippingWidth;\n\t\t\tthis._isGeometryDirty = true;\n\t\t}\n\n\t\tif( this._isGeometryDirty ) {\n\t\t\tthis._isGeometryDirty = false;\n\t\t\tthis.geometry.update( this._text, atlas, newClippingWidth );\n\t\t}\n\t}\n\n\tprotected getClippingWidth(): number | undefined {\n\t\tif( this._style.clipping ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent instanceof DBase ) {\n\t\t\t\treturn parent.width - parent.padding.getLeft() - parent.padding.getRight() - this._clippingWidthDelta;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tsetClippingWidthDelta( width: number ): void {\n\t\tthis._clippingWidthDelta = width;\n\t}\n\n\t_calculateBounds(): void {\n\t\tthis.update();\n\t\tsuper._calculateBounds();\n\t}\n\n\t_render( renderer?: Renderer ): void {\n\t\tthis.update();\n\t\t(super._render as any)( renderer );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Renderer } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DBaseOverflowMaskSimple extends Graphics implements DReflowable {\n\tconstructor( parent: DBase ) {\n\t\tsuper();\n\t\t(this as any).parent = parent;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.updateTransform();\n\t\tsuper.render( renderer );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number): void {\n\t\tthis.clear();\n\t\tthis.beginFill( 0xFFFFFF, 1 );\n\t\tthis.drawRect( 0, 0, width, height );\n\t\tthis.endFill();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Text } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DRefitable, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMaskSimple } from \"./d-base-overflow-mask-simple\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DDynamicTextStyleOptions } from \"./d-dynamic-text-style\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { utilIsFunction } from \"./util/util-is-function\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport interface DTextBaseOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeTextBase = DThemeTextBase\n> extends DBaseOptions<THEME> {\n\ttext?: {\n\t\tvalue?: DStateAwareOrValueMightBe<VALUE>,\n\t\tcolor?: DStateAwareOrValueMightBe<number>,\n\t\talpha?: DStateAwareOrValueMightBe<number>,\n\t\tstyle?: DDynamicTextStyleOptions,\n\t\talign?: {\n\t\t\tvertical?: (keyof typeof DAlignVertical) | DAlignVertical,\n\t\t\thorizontal?: (keyof typeof DAlignHorizontal) | DAlignHorizontal\n\t\t},\n\t\tformatter?: ( value: VALUE, caller: any ) => string;\n\t\tdynamic?: boolean;\n\t};\n\tmask?: boolean;\n}\n\nexport interface DThemeTextBase extends DThemeBase {\n\tgetTextFormatter(): ( value: any, caller: any ) => string;\n\tnewTextValue(): any;\n\tgetTextValue( state: DBaseState ): any;\n\tgetTextAlignVertical(): DAlignVertical;\n\tgetTextAlignHorizontal(): DAlignHorizontal;\n\tgetTextStyleClipping(): boolean;\n\tisOverflowMaskEnabled(): boolean;\n\tisTextDynamic(): boolean;\n}\n\n// Option parser\nconst isOverflowMaskEnabled = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options?: DTextBaseOptions<VALUE, THEME>\n) => {\n\tif( options && options.mask != null ) {\n\t\treturn options.mask;\n\t}\n\treturn theme.isOverflowMaskEnabled();\n};\n\nconst toTextValue = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase,\n\toptions: DTextBaseOptions<VALUE, THEME> | undefined\n): DStateAwareOrValueMightBe<VALUE> => {\n\tif( options && options.text && options.text.value !== undefined ) {\n\t\treturn options.text.value;\n\t}\n\treturn theme.newTextValue();\n};\n\nconst toTextStyle = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options: DTextBaseOptions<VALUE, THEME> | undefined, state: DBaseState\n): DDynamicTextStyleOptions => {\n\tif( options && options.text && options.text.style != null ) {\n\t\tconst style = options.text.style;\n\t\tconst fill = style.fill != null ? style.fill : theme.getColor( state );\n\t\tconst fontSize = style.fontSize != null ? style.fontSize : theme.getFontSize();\n\t\tconst fontFamily = style.fontFamily != null ? style.fontFamily : theme.getFontFamilly();\n\t\tconst fontWeight = style.fontWeight != null ? style.fontWeight : theme.getFontWeight();\n\t\tconst fontStyle = style.fontStyle != null ? style.fontStyle : theme.getFontStyle();\n\t\tconst fontVariant = style.fontVariant != null ? style.fontVariant : theme.getFontVariant();\n\t\tconst clipping = style.clipping != null ? style.clipping : theme.getTextStyleClipping();\n\t\treturn {\n\t\t\tfill,\n\t\t\tfontSize,\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontStyle,\n\t\t\tfontVariant,\n\t\t\tclipping\n\t\t};\n\t}\n\n\treturn {\n\t\tfill: theme.getColor( state ),\n\t\tfontSize: theme.getFontSize(),\n\t\tfontFamily: theme.getFontFamilly(),\n\t\tfontWeight: theme.getFontWeight(),\n\t\tfontStyle: theme.getFontStyle(),\n\t\tfontVariant: theme.getFontVariant(),\n\t\tclipping: theme.getTextStyleClipping()\n\t};\n};\n\nconst toTextAlign = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options?: DTextBaseOptions<VALUE, THEME>\n): { vertical: DAlignVertical, horizontal: DAlignHorizontal } => {\n\tif( options && options.text && options.text.align ) {\n\t\tconst align = options.text.align;\n\t\tconst vertical = ( align.vertical != null ?\n\t\t\t( utilIsString( align.vertical ) ? DAlignVertical[ align.vertical ] : align.vertical ) :\n\t\t\ttheme.getTextAlignVertical()\n\t\t);\n\t\tconst horizontal = ( align.horizontal != null ?\n\t\t\t( utilIsString( align.horizontal ) ? DAlignHorizontal[ align.horizontal ] : align.horizontal ) :\n\t\t\ttheme.getTextAlignHorizontal()\n\t\t);\n\t\treturn {\n\t\t\tvertical,\n\t\t\thorizontal\n\t\t};\n\t}\n\treturn {\n\t\tvertical: theme.getTextAlignVertical(),\n\t\thorizontal: theme.getTextAlignHorizontal()\n\t};\n};\n\nconst toTextFormatter = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase,\n\toptions: DTextBaseOptions<VALUE, THEME> | undefined\n): ( value: VALUE, caller: any ) => string => {\n\tif( options && options.text && options.text.formatter ) {\n\t\treturn options.text.formatter;\n\t}\n\treturn theme.getTextFormatter();\n};\n\nconst toTextDynamic = <VALUE, THEME extends DThemeTextBase>(\n\ttheme: DThemeTextBase, options?: DTextBaseOptions<VALUE, THEME>\n): boolean => {\n\tif( options && options.text && options.text.dynamic != null ) {\n\t\treturn options.text.dynamic;\n\t}\n\treturn theme.isTextDynamic();\n};\n\nexport class DTextBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeTextBase = DThemeTextBase,\n\tOPTIONS extends DTextBaseOptions<VALUE, THEME> = DTextBaseOptions<VALUE, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _text!: DDynamicText | Text | null;\n\tprotected _textValue!: DStateAwareOrValueMightBe<VALUE>;\n\tprotected _textValueComputed!: VALUE;\n\tprotected _textColor!: DStateAwareOrValueMightBe<number>;\n\tprotected _textAlpha!: DStateAwareOrValueMightBe<number>;\n\tprotected _textStyle!: DDynamicTextStyleOptions;\n\tprotected _textAlign!: {\n\t\tvertical: DAlignVertical,\n\t\thorizontal: DAlignHorizontal\n\t};\n\tprotected _textFormatter!: ( value: VALUE, caller: any ) => string;\n\tprotected _isOverflowMaskEnabled!: boolean;\n\tprotected _overflowMask!: DBaseOverflowMaskSimple | null;\n\tprotected _textDynamic!: boolean;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tthis._text = null;\n\t\tconst theme = this.theme;\n\t\tthis._textValue = toTextValue( theme, options );\n\t\tthis._textValueComputed = this.computeTextValue();\n\t\tthis._textColor = ( options && options.text && options.text.color );\n\t\tthis._textAlpha = ( options && options.text && options.text.alpha );\n\t\tthis._textStyle = toTextStyle( theme, options, this.state );\n\t\tthis._textAlign = toTextAlign( theme, options );\n\t\tthis._textFormatter = toTextFormatter( theme, options );\n\t\tthis._textDynamic = toTextDynamic( theme, options );\n\t\tthis._isOverflowMaskEnabled = isOverflowMaskEnabled( theme, options );\n\t\tthis._overflowMask = null;\n\t\tthis.onTextChange();\n\t\tthis.createOrUpdateText();\n\t}\n\n\tset text( text: DStateAwareOrValueMightBe<VALUE> ) {\n\t\tif( this._textValue !== text ) {\n\t\t\tthis._textValue = text;\n\t\t\tthis.updateTextValue();\n\t\t}\n\t}\n\n\tget text(): DStateAwareOrValueMightBe<VALUE> {\n\t\treturn this._textValue;\n\t}\n\n\tprotected onTextChange() {\n\t\t// DO NOTHING\n\t}\n\n\tprotected computeTextValue(): VALUE {\n\t\tconst textValue = this._textValue;\n\t\tif( textValue !== undefined ) {\n\t\t\tif( utilIsFunction( textValue ) ) {\n\t\t\t\tconst result = textValue( this.state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn textValue;\n\t\t\t}\n\t\t}\n\t\treturn this.theme.getTextValue( this.state ) as VALUE;\n\t}\n\n\tprotected createOrUpdateText(): void {\n\t\tconst formatted = this._textFormatter( this._textValueComputed, this );\n\t\tif( this._text == null ) {\n\t\t\tif( 0 < formatted.length ) {\n\t\t\t\tconst text = this.createText( formatted );\n\t\t\t\tthis._text = text;\n\t\t\t\tthis.addChild( text );\n\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\tif( this._isOverflowMaskEnabled ) {\n\t\t\t\t\ttext.mask = this.getOrCreateOverflowMask();\n\t\t\t\t}\n\t\t\t\tthis.toDirty();\n\t\t\t\tDApplications.update();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._text.text = formatted;\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tprotected createText( formatted: string ): Text | DDynamicText {\n\t\treturn ( this._textDynamic ?\n\t\t\tnew DDynamicText( formatted, this._textStyle ) :\n\t\t\tnew Text( formatted, this._textStyle )\n\t\t);\n\t}\n\n\tprotected getOrCreateOverflowMask(): Graphics {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMaskSimple( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tprotected updateTextPosition( text: DDynamicText | Text ): void {\n\t\tconst align = this._textAlign;\n\t\tconst padding = this._padding;\n\n\t\tswitch( align.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\ttext.x = this.toRounded( padding.getLeft() );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\ttext.x = this.toRounded( ( this.width - text.width ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\ttext.x = this.toRounded( this.width - text.width - padding.getRight() );\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch( align.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\ttext.y = this.toRounded( padding.getTop() );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\ttext.y = this.toRounded( ( this.height - text.height ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\ttext.y = this.toRounded( this.height - text.height - padding.getBottom() );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected toRounded( value: number ): number {\n\t\treturn Math.round( value );\n\t}\n\n\tprotected getTextColor( theme: THEME, state: DBaseState ): number {\n\t\tconst color = this._textColor;\n\t\tif( color !== undefined ) {\n\t\t\tif( utilIsFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn theme.getColor( state );\n\t}\n\n\tprotected getTextAlpha( theme: THEME, state: DBaseState ): number {\n\t\tconst alpha = this._textAlpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( utilIsFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn theme.getAlpha( state );\n\t}\n\n\tprotected updateTextColor( text: DDynamicText | Text ): void {\n\t\tconst theme = this.theme;\n\t\tconst state = this.state;\n\t\ttext.style.fill = this.getTextColor( theme, state );\n\t\ttext.alpha = this.getTextAlpha( theme, state );\n\t}\n\n\tprotected updateTextValue(): void {\n\t\tconst newTextValueComputed = this.computeTextValue();\n\t\tif( this._textValueComputed !== newTextValueComputed ) {\n\t\t\tthis._textValueComputed = newTextValueComputed;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\tthis.updateTextValue();\n\t\t\tthis.updateTextPosition( text );\n\t\t\tthis.updateTextColor( text );\n\t\t}\n\t}\n\n\tprotected onReflow(): void {\n\t\tsuper.onReflow();\n\t\tthis.updateText();\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn super.isRefitable( target ) ||\n\t\t\t(target != null && target === this._text);\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTextBase\";\n\t}\n\n\tdestroy(): void {\n\t\t// Text\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\tthis._text = null;\n\t\t\ttext.destroy();\n\t\t}\n\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Point, Rectangle, Sprite, Text, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DAlignWith } from \"./d-align-with\";\nimport { DApplications } from \"./d-applications\";\nimport { DRefitable } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\nimport { utilIsFunction } from \"./util/util-is-function\";\nimport { utilIsString } from \"./util/util-is-string\";\n\ninterface DImageBaseTintOptions {\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\talpha?: DStateAwareOrValueMightBe<number>;\n}\n\nexport interface DImageBaseOptions<\n\tVALUE,\n\tTHEME extends DThemeImageBase = DThemeImageBase\n> extends DTextBaseOptions<VALUE, THEME> {\n\timage?: {\n\t\tsource?: DStateAwareOrValueMightBe<Texture | DisplayObject | null>;\n\t\ttint?: DImageBaseTintOptions,\n\t\talign?: {\n\t\t\twith?: (keyof typeof DAlignWith) | DAlignWith,\n\t\t\tvertical?: (keyof typeof DAlignVertical) | DAlignVertical,\n\t\t\thorizontal?: (keyof typeof DAlignHorizontal) | DAlignHorizontal\n\t\t};\n\t\tmargin?: {\n\t\t\tvertical?: number,\n\t\t\thorizontal?: number\n\t\t};\n\t};\n}\n\nexport interface DThemeImageBase extends DThemeTextBase {\n\tgetImageAlignHorizontal(): DAlignHorizontal;\n\tgetImageAlignVertical(): DAlignVertical;\n\tgetImageAlignWith(): DAlignWith;\n\tgetImageMarginHorizontal(): number;\n\tgetImageMarginVertial(): number;\n\tgetImageTintColor( state: DBaseState ): number | null;\n\tgetImageTintAlpha( state: DBaseState ): number;\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null;\n}\n\n// Option parser\nconst toImageAlign = <VALUE, THEME extends DThemeImageBase>(\n\ttheme: DThemeImageBase, options?: DImageBaseOptions<VALUE, THEME>\n) => {\n\tif( options != null && options.image != null && options.image.align != null ) {\n\t\tconst align = options.image.align;\n\t\tconst alignWith: DAlignWith = ( align.with != null ?\n\t\t\t( utilIsString( align.with ) ? DAlignWith[ align.with ] : align.with ) :\n\t\t\ttheme.getImageAlignWith()\n\t\t);\n\t\tconst alignVertical: DAlignVertical = ( align.vertical != null ?\n\t\t\t( utilIsString( align.vertical ) ? DAlignVertical[ align.vertical ] : align.vertical ) :\n\t\t\ttheme.getImageAlignVertical()\n\t\t);\n\t\tconst alignHorizontal: DAlignHorizontal = ( align.horizontal != null ?\n\t\t\t( utilIsString( align.horizontal ) ? DAlignHorizontal[ align.horizontal ] : align.horizontal ) :\n\t\t\ttheme.getImageAlignHorizontal()\n\t\t);\n\t\treturn {\n\t\t\twith: alignWith,\n\t\t\tvertical: alignVertical,\n\t\t\thorizontal: alignHorizontal\n\t\t};\n\t}\n\treturn {\n\t\twith: theme.getImageAlignWith(),\n\t\tvertical: theme.getImageAlignVertical(),\n\t\thorizontal: theme.getImageAlignHorizontal()\n\t};\n};\n\nconst toImageMargin = <VALUE, THEME extends DThemeImageBase>(\n\ttheme: DThemeImageBase, options?: DImageBaseOptions<VALUE, THEME>\n) => {\n\tif( options != null && options.image != null && options.image.margin != null ) {\n\t\tconst margin = options.image.margin;\n\t\tconst vertical = ( margin.vertical != null ? margin.vertical : theme.getImageMarginVertial() );\n\t\tconst horizontal = ( margin.horizontal != null ? margin.horizontal : theme.getImageMarginHorizontal() );\n\t\treturn {\n\t\t\tvertical,\n\t\t\thorizontal\n\t\t};\n\t}\n\treturn {\n\t\tvertical: theme.getImageMarginVertial(),\n\t\thorizontal: theme.getImageMarginHorizontal()\n\t};\n};\n\nconst toImageTint = <VALUE, THEME extends DThemeImageBase>(\n\ttheme: DThemeImageBase, options?: DImageBaseOptions<VALUE, THEME>\n): DImageBaseTintOptions | undefined => {\n\tif( options != null && options.image != null && options.image.tint != null ) {\n\t\treturn options.image.tint;\n\t}\n\treturn undefined;\n};\n\nexport class DImageBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeImageBase = DThemeImageBase,\n\tOPTIONS extends DImageBaseOptions<VALUE, THEME> = DImageBaseOptions<VALUE, THEME>\n> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected _image!: DisplayObject | null;\n\tprotected _imageSourceComputed!: Texture | DisplayObject | null;\n\tprotected _imageSource!: DStateAwareOrValueMightBe<Texture | DisplayObject | null>;\n\tprotected _imageAlign!: {\n\t\twith: DAlignWith,\n\t\tvertical: DAlignVertical,\n\t\thorizontal: DAlignHorizontal\n\t};\n\tprotected _imageMargin!: {\n\t\tvertical: number,\n\t\thorizontal: number\n\t};\n\tprotected _imageTint!: DImageBaseTintOptions | undefined;\n\tprotected _imageBound!: Rectangle;\n\tprotected _imageBoundPoint!: Point;\n\tprotected _onImageChangeBound!: () => void;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._image = null;\n\t\tconst theme = this.theme;\n\t\tthis._imageAlign = toImageAlign( theme, options );\n\t\tthis._imageMargin = toImageMargin( theme, options );\n\t\tthis._imageTint = toImageTint( theme, options );\n\t\tthis._imageBound = new Rectangle();\n\t\tthis._imageBoundPoint = new Point();\n\t\tthis._imageSource = ( options && options.image && options.image.source );\n\t\tthis._imageSourceComputed = null;\n\t\tthis._onImageChangeBound = () => {\n\t\t\tthis.onImageChange();\n\t\t};\n\t}\n\n\tget image(): DStateAwareOrValueMightBe<Texture | DisplayObject | null> {\n\t\treturn this._imageSource;\n\t}\n\n\tset image( imageSource: DStateAwareOrValueMightBe<Texture | DisplayObject | null> ) {\n\t\tif( this._imageSource !== imageSource ) {\n\t\t\tthis._imageSource = imageSource;\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tprotected computeImageSource(): Texture | DisplayObject | null {\n\t\tconst imageSource = this._imageSource;\n\t\tif( imageSource !== undefined ) {\n\t\t\tif( utilIsFunction( imageSource ) ) {\n\t\t\t\tconst result = imageSource( this.state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn imageSource;\n\t\t\t}\n\t\t}\n\t\treturn this.theme.getImageSource( this.state );\n\t}\n\n\tprotected onImageChange(): void {\n\t\tthis.toDirty();\n\t\tDApplications.update();\n\t}\n\n\tprotected onStateChange( newState: DBaseState, oldState: DBaseState ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tconst image = this._image;\n\t\tif( image != null ) {\n\t\t\tthis.updateImageTint( image );\n\t\t}\n\t}\n\n\tprotected getImageRect( image: DisplayObject ): Rectangle {\n\t\timage.updateTransform();\n\t\tconst bounds = image.getLocalBounds( this._imageBound );\n\t\tconst point = this._imageBoundPoint;\n\t\tpoint.set( bounds.left, bounds.top );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x0 = point.x;\n\t\tconst y0 = point.y;\n\t\tpoint.set( bounds.right, bounds.top );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x1 = point.x;\n\t\tconst y1 = point.y;\n\t\tpoint.set( bounds.right, bounds.bottom );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x2 = point.x;\n\t\tconst y2 = point.y;\n\t\tpoint.set( bounds.left, bounds.bottom );\n\t\timage.localTransform.apply( point, point );\n\t\tconst x3 = point.x;\n\t\tconst y3 = point.y;\n\t\tbounds.x = Math.min( x0, x1, x2, x3 );\n\t\tbounds.y = Math.min( y0, y1, y2, y3 );\n\t\tbounds.width = Math.max( x0, x1, x2, x3 ) - bounds.x;\n\t\tbounds.height = Math.max( y0, y1, y2, y3 ) - bounds.y;\n\t\treturn bounds;\n\t}\n\n\tprotected updateTextAndImagePosition( text: DDynamicText | Text, image: DisplayObject ): void {\n\t\tconst bounds = this.getImageRect( image );\n\t\tconst imageWidth = bounds.width;\n\t\tconst imageHeight = bounds.height;\n\n\t\tconst textAlign = this._textAlign;\n\t\tconst imageAlign = this._imageAlign;\n\t\tconst margin = this._imageMargin;\n\t\tconst padding = this._padding;\n\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tconst imageWaMH = imageWidth + marginHorizontal;\n\t\tswitch( imageAlign.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\tswitch( textAlign.horizontal ) {\n\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\timage.x = this.toRounded( padding.getLeft() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\timage.x = this.toRounded( ( this.width - text.width - imageWaMH ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t}\n\t\t\t\timage.x = this.toRounded( this.width - text.width - padding.getRight() - imageWaMH );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\ttext.x = this.toRounded( image.x + imageWaMH );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t}\n\t\t\tswitch( textAlign.horizontal ) {\n\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\ttext.x = this.toRounded( padding.getLeft() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\ttext.x = this.toRounded( ( this.width - text.width ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\ttext.x = this.toRounded( this.width - text.width - padding.getRight() );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.x = this.toRounded( text.x + ( text.width - imageWidth ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\tswitch( textAlign.horizontal ) {\n\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t}\n\t\t\t\ttext.x = this.toRounded( padding.getLeft() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\ttext.x = this.toRounded( ( this.width - text.width - imageWaMH ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( imageWaMH );\n\t\t\t\t}\n\t\t\t\ttext.x = this.toRounded( this.width - text.width - padding.getRight() - imageWaMH );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.x = this.toRounded( text.x + text.width + marginHorizontal );\n\t\t\tbreak;\n\t\t}\n\n\t\tconst marginVertical = margin.vertical;\n\t\tconst imageHaMV = imageWidth + marginHorizontal;\n\t\tswitch( imageAlign.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\tswitch( textAlign.vertical ) {\n\t\t\tcase DAlignVertical.TOP:\n\t\t\t\timage.y = this.toRounded( padding.getTop() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\timage.y = this.toRounded( ( this.height - text.height - imageHaMV ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\timage.y = this.toRounded( this.height - text.height - padding.getBottom() - imageHaMV );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\ttext.y = this.toRounded( image.y + imageHaMV );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\tswitch( textAlign.vertical ) {\n\t\t\tcase DAlignVertical.TOP:\n\t\t\t\ttext.y = this.toRounded( padding.getTop() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\ttext.y = this.toRounded( ( this.height - text.height ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\ttext.y = this.toRounded( this.height - text.height - padding.getBottom() );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.y = this.toRounded( text.y + ( text.height - imageHeight ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\tswitch( textAlign.vertical ) {\n\t\t\tcase DAlignVertical.TOP:\n\t\t\t\ttext.y = this.toRounded( padding.getTop() );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\ttext.y = this.toRounded( ( this.height - text.height - imageHaMV ) * 0.5 );\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\ttext.y = this.toRounded( this.height - text.height - padding.getBottom() - imageHaMV );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\timage.y = this.toRounded( text.y + text.height + marginVertical );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected updateImagePositionText( image: DisplayObject ): void {\n\t\tconst bounds = this.getImageRect( image );\n\t\timage.x = this.toRounded( ( this.width - bounds.width ) * 0.5 );\n\t\timage.y = this.toRounded( ( this.height - bounds.height ) * 0.5 );\n\t}\n\n\tprotected updateImagePositionPadding( image: DisplayObject ): void {\n\t\tconst margin = this._imageMargin;\n\t\tconst align = this._imageAlign;\n\t\tconst padding = this._padding;\n\t\tconst bounds = this.getImageRect( image );\n\t\tconst imageWidth = bounds.width;\n\t\tconst imageHeight = bounds.height;\n\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tswitch( align.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\timage.x = this.toRounded( padding.getLeft() + marginHorizontal );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\timage.x = this.toRounded( ( this.width - imageWidth ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\timage.x = this.toRounded( this.width - padding.getRight() - marginHorizontal - imageWidth );\n\t\t\tbreak;\n\t\t}\n\n\t\tconst marginVertical = margin.vertical;\n\t\tswitch( align.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\timage.y = this.toRounded( padding.getTop() + marginVertical );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\timage.y = this.toRounded( ( this.height - imageHeight ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\timage.y = this.toRounded( this.height - padding.getBottom() - marginVertical );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected updateImagePositionBorder( image: DisplayObject ): void {\n\t\tconst margin = this._imageMargin;\n\t\tconst align = this._imageAlign;\n\t\tconst bounds = this.getImageRect( image );\n\t\tconst imageWidth = bounds.width;\n\t\tconst imageHeight = bounds.height;\n\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tswitch( align.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\timage.x = this.toRounded( marginHorizontal );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\timage.x = this.toRounded( ( this.width - imageWidth ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\timage.x = this.toRounded( this.width - marginHorizontal - imageWidth );\n\t\t\tbreak;\n\t\t}\n\n\t\tconst marginVertical = margin.vertical;\n\t\tswitch( align.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\timage.y = this.toRounded( marginVertical );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\timage.y = this.toRounded( ( this.height - imageHeight ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\timage.y = this.toRounded( this.height - marginVertical );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected getImageTintColor( theme: THEME, state: DBaseState ): number | null {\n\t\tconst imageTint = this._imageTint;\n\t\tif( imageTint != null ) {\n\t\t\tconst color = imageTint.color;\n\t\t\tif( color !== undefined ) {\n\t\t\t\tif( utilIsFunction( color ) ) {\n\t\t\t\t\tconst result = color( state );\n\t\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn theme.getImageTintColor( state );\n\t}\n\n\tprotected getImageTintAlpha( theme: THEME, state: DBaseState ): number {\n\t\tconst imageTint = this._imageTint;\n\t\tif( imageTint != null ) {\n\t\t\tconst alpha = imageTint.alpha;\n\t\t\tif( alpha !== undefined ) {\n\t\t\t\tif( utilIsFunction( alpha ) ) {\n\t\t\t\t\tconst result = alpha( state );\n\t\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn alpha;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn theme.getImageTintAlpha( state );\n\t}\n\n\tprotected updateImageTint( image: DisplayObject ): void {\n\t\tif( this.isTintAware( image ) ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst state = this.state;\n\t\t\tconst color = this.getImageTintColor( theme, state );\n\t\t\tif( color != null ) {\n\t\t\t\tif( image.tint !== color ) {\n\t\t\t\t\timage.tint = color;\n\t\t\t\t}\n\t\t\t\tconst alpha = this.getImageTintAlpha( theme, state );\n\t\t\t\tif( image.alpha !== alpha ) {\n\t\t\t\t\timage.alpha = alpha;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected isTintAware( target: DisplayObject | null ): target is DisplayObject & { tint: number } {\n\t\treturn ( target != null && \"tint\" in target );\n\t}\n\n\tprotected updateImageSource(): void {\n\t\tconst newImageSourceComputed = this.computeImageSource();\n\t\tconst oldImageSourceComputed = this._imageSourceComputed;\n\t\tif( newImageSourceComputed !== oldImageSourceComputed ) {\n\t\t\tthis._imageSourceComputed = newImageSourceComputed;\n\n\t\t\tconst oldImage = this._image;\n\t\t\tif( newImageSourceComputed instanceof Texture ) {\n\t\t\t\tif( oldImageSourceComputed instanceof Texture ) {\n\t\t\t\t\toldImageSourceComputed.off( \"update\", this._onImageChangeBound );\n\t\t\t\t\tif( oldImage instanceof Sprite ) {\n\t\t\t\t\t\toldImage.texture = newImageSourceComputed;\n\t\t\t\t\t\tnewImageSourceComputed.on( \"update\", this._onImageChangeBound );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( oldImage != null ) {\n\t\t\t\t\t\tthis.removeChild( oldImage );\n\t\t\t\t\t}\n\n\t\t\t\t\tconst newImage = new Sprite( newImageSourceComputed );\n\t\t\t\t\tif( this._isOverflowMaskEnabled ) {\n\t\t\t\t\t\tnewImage.mask = this.getOrCreateOverflowMask();\n\t\t\t\t\t}\n\t\t\t\t\tnewImageSourceComputed.on( \"update\", this._onImageChangeBound );\n\t\t\t\t\tthis.addChild( newImage );\n\t\t\t\t\tthis._image = newImage;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( oldImageSourceComputed instanceof Texture ) {\n\t\t\t\t\toldImageSourceComputed.off( \"update\", this._onImageChangeBound );\n\t\t\t\t\tif( oldImage != null ) {\n\t\t\t\t\t\tthis.removeChild( oldImage );\n\t\t\t\t\t\toldImage.destroy();\n\t\t\t\t\t}\n\t\t\t\t} else if( oldImage != null ) {\n\t\t\t\t\tthis.removeChild( oldImage );\n\t\t\t\t}\n\n\t\t\t\tif( newImageSourceComputed != null ) {\n\t\t\t\t\tif( this._isOverflowMaskEnabled ) {\n\t\t\t\t\t\tnewImageSourceComputed.mask = this.getOrCreateOverflowMask();\n\t\t\t\t\t}\n\t\t\t\t\tthis.addChild( newImageSourceComputed );\n\t\t\t\t}\n\t\t\t\tthis._image = newImageSourceComputed;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tthis.updateTextValue();\n\t\tthis.updateImageSource();\n\n\t\tconst text = this._text;\n\t\tconst image = this._image;\n\t\tif( text != null ) {\n\t\t\tif( image != null ) {\n\t\t\t\tconst align = this._imageAlign;\n\t\t\t\tswitch( align.with ) {\n\t\t\t\tcase DAlignWith.TEXT:\n\t\t\t\t\tthis.updateTextAndImagePosition( text, image );\n\t\t\t\t\tbreak;\n\t\t\t\tcase DAlignWith.PADDING:\n\t\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\t\tthis.updateImagePositionPadding( image );\n\t\t\t\t\tbreak;\n\t\t\t\tcase DAlignWith.BORDER:\n\t\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t\t}\n\t\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\t\tthis.updateImagePositionBorder( image );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tthis.updateTextColor( text );\n\t\t\t\tthis.updateImageTint( image );\n\t\t\t} else {\n\t\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\t\ttext.setClippingWidthDelta( 0 );\n\t\t\t\t}\n\t\t\t\tthis.updateTextPosition( text );\n\t\t\t\tthis.updateTextColor( text );\n\t\t\t}\n\t\t} else if( image != null ) {\n\t\t\tconst align = this._imageAlign;\n\t\t\tswitch( align.with ) {\n\t\t\tcase DAlignWith.TEXT:\n\t\t\t\tthis.updateImagePositionText( image );\n\t\t\t\tbreak;\n\t\t\tcase DAlignWith.PADDING:\n\t\t\t\tthis.updateImagePositionPadding( image );\n\t\t\t\tbreak;\n\t\t\tcase DAlignWith.BORDER:\n\t\t\t\tthis.updateImagePositionBorder( image );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.updateImageTint( image );\n\t\t}\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn super.isRefitable( target ) ||\n\t\t\t(target != null && target === this._image);\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DImageBase\";\n\t}\n\n\tdestroy(): void {\n\t\t// Image\n\t\tconst image = this._image;\n\t\tif( image != null ) {\n\t\t\tthis._image = null;\n\t\t\tconst imageSourceComputed = this._imageSourceComputed;\n\t\t\tif( imageSourceComputed instanceof Texture ) {\n\t\t\t\timageSourceComputed.off( \"update\", this._onImageChangeBound, this );\n\t\t\t\timage.destroy();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\n\nexport interface DImageOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeImage = DThemeImage\n> extends DImageBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeImage extends DThemeImageBase {\n\n}\n\nexport class DImage<\n\tVALUE = unknown,\n\tTHEME extends DThemeImage = DThemeImage,\n\tOPTIONS extends DImageOptions<VALUE, THEME> = DImageOptions<VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DImage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DListItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeListItem = DThemeListItem\n> extends DImageOptions<string, THEME> {\n\tvalue?: VALUE;\n}\n\nexport interface DThemeListItem extends DThemeImage {\n\tgetTextValue( state: DBaseState ): string;\n\tnewTextValue(): DStateAwareOrValueMightBe<string>;\n}\n\n// Option parser\nconst toValue = <VALUE, THEME extends DThemeListItem>( options?: DListItemOptions<VALUE, THEME> ): VALUE | null => {\n\treturn ( options != null && options.value != null ?\n\t\toptions.value : null );\n};\n\nexport interface DListItemSelection {\n\tadd( item: DBase ): void;\n}\n\nexport class DListItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeListItem = DThemeListItem,\n\tOPTIONS extends DListItemOptions<VALUE, THEME> = DListItemOptions<VALUE, THEME>\n> extends DImage<string, THEME, OPTIONS> {\n\tprotected _value!: VALUE | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.buttonMode = true;\n\t\tthis._value = toValue( options );\n\t}\n\n\tget value(): VALUE | null {\n\t\treturn this._value;\n\t}\n\n\tset value( value: VALUE | null ) {\n\t\tthis._value = value;\n\t}\n\n\tprotected hasSelection( target: any ): target is { selection: DListItemSelection } {\n\t\treturn ( target && target.selection && target.selection.add );\n\t}\n\n\tprotected getSelection(): DListItemSelection | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( this.hasSelection( parent ) ) {\n\t\t\t\treturn parent.selection;\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tconst selection = this.getSelection();\n\t\tif( selection ) {\n\t\t\tselection.add( this );\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( this.isActionable() && this.isFocused() && UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onSelect( e );\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tsuper.onStateChange( newState, oldState );\n\t\tthis.buttonMode = DBaseStates.isActionable( newState );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DListItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\n\nexport interface DMenuItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItem = DThemeMenuItem\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItem extends DThemeListItem {\n\n}\n\nexport class DMenuItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItem = DThemeMenuItem,\n\tOPTIONS extends DMenuItemOptions<VALUE, THEME> = DMenuItemOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tgetContext(): DMenuContext | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( parent.getContext ) {\n\t\t\t\treturn parent.getContext();\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( parent.getCloseable ) {\n\t\t\t\treturn parent.getCloseable();\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Text } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DMenuItem, DMenuItemOptions, DThemeMenuItem } from \"./d-menu-item\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemTextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText\n> extends DMenuItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemText extends DThemeMenuItem {\n\tgetShortcutTextMargin(): number;\n}\n\nexport class DMenuItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItem<VALUE, THEME, OPTIONS> {\n\tprotected _shortcutText!: Text | DDynamicText | null;\n\tprotected _shortcutMargin!: number;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.initOnClick( options );\n\t\tthis.initOnOver( options );\n\t\tthis.initShortcuts( options );\n\t}\n\n\tprotected initOnClick( options?: OPTIONS ): void {\n\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected initOnOver( options?: OPTIONS ): void {\n\t\tthis.on( UtilPointerEvent.over, (): void => {\n\t\t\tconst context = this.getContext();\n\t\t\tif( context != null ) {\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent instanceof DBase ) {\n\t\t\t\t\tcontext.trim( this.getCloseable() );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected initShortcuts( options?: OPTIONS ): void {\n\t\tconst shortcuts = this._shortcuts;\n\t\tthis._shortcutMargin = this.theme.getShortcutTextMargin();\n\t\tif( shortcuts != null && 0 < shortcuts.length ) {\n\t\t\tconst shortcut = shortcuts[ 0 ];\n\t\t\tconst shortcutTextValue = UtilKeyboardEvent.toString( shortcut );\n\t\t\tthis._shortcutText = ( this._textDynamic ?\n\t\t\t\tnew DDynamicText( shortcutTextValue, this._textStyle ) :\n\t\t\t\tnew Text( shortcutTextValue, this._textStyle )\n\t\t\t);\n\t\t\tthis.appendRenderable( this._shortcutText, true );\n\t\t} else {\n\t\t\tthis._shortcutText = null;\n\t\t}\n\t}\n\n\tprotected updateShortcutText(): void {\n\t\tconst text = this._shortcutText;\n\t\tif( text != null ) {\n\t\t\ttext.position.set(\n\t\t\t\tthis.toRounded( this.width - this._shortcutMargin - text.width ),\n\t\t\t\tthis.toRounded( ( this.height - text.height ) * 0.5 )\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextColor( text: DDynamicText | Text ): void {\n\t\tsuper.updateTextColor( text );\n\n\t\tconst shortcutText = this._shortcutText;\n\t\tif( shortcutText != null ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst state = this.state;\n\t\t\tshortcutText.style.fill = theme.getColor( state );\n\t\t\tshortcutText.alpha = theme.getAlpha( state );\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tsuper.updateText();\n\t\tthis.updateShortcutText();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemText\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tconst closeable = this.getCloseable();\n\t\tif( closeable != null ) {\n\t\t\tcloseable.emit( \"select\", this.value, this, closeable );\n\t\t}\n\n\t\tsuper.onSelect( e );\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ) {\n\t\tsuper.onShortcut( e );\n\t\tthis.onSelect( e );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport interface DMenuItemCheckOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck\n> extends DMenuItemTextOptions<VALUE, THEME> {\n\tcheck: boolean;\n}\n\nexport interface DThemeMenuItemCheck extends DThemeMenuItemText {\n\n}\n\nexport class DMenuItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tif( options && options.check ) {\n\t\t\tthis.setActive( true );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemCheck\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tthis.setActive( ! this.isActive() );\n\t\tsuper.onSelect( e );\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemCheckOptions<VALUE> {\n\t\treturn \"check\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport type DMenuItemCreator = ( options: DMenuItemOptionsUnion<any>, sticky: boolean ) => DisplayObject | null;\n\nexport type DMenuMenuCreator = ( options?: DMenuOptions ) => DMenu<any>;\n\nexport class DMenus {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\tprotected static MENU_CREATOR?: DMenuMenuCreator;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic setMenuCreator( creator: DMenuMenuCreator ): void {\n\t\tthis.MENU_CREATOR = creator;\n\t}\n\n\tstatic newItemOf<VALUE>(\n\t\tcreators: DMenuItemCreator[],\n\t\tcreatorDefault: DMenuItemCreator | null,\n\t\toptions: DMenuItemOptionsUnion<VALUE>,\n\t\tsticky: boolean\n\t): DisplayObject | null {\n\t\tfor( let i = 0, imax = creators.length; i < imax; ++i ) {\n\t\t\tconst created = creators[ i ]( options, sticky );\n\t\t\tif( created != null ) {\n\t\t\t\treturn created;\n\t\t\t}\n\t\t}\n\t\tif( creatorDefault ) {\n\t\t\treturn creatorDefault( options, sticky );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn this.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky );\n\t}\n\n\tstatic newItemsOf<VALUE>(\n\t\tcreator: { newItem( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null },\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DisplayObject ) {\n\t\t\t\tparent.addChild( item );\n\t\t\t} else {\n\t\t\t\tconst created = creator.newItem( item, sticky );\n\t\t\t\tif( created != null ) {\n\t\t\t\t\tparent.addChild( created );\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error( `No matching menu item creator found: ${JSON.stringify( item )}` );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tthis.newItemsOf( this, parent, items, sticky );\n\t}\n\n\tstatic newMenu<VALUE>( options?: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\tif( this.MENU_CREATOR != null ) {\n\t\t\treturn this.MENU_CREATOR( options );\n\t\t} else {\n\t\t\tthrow new Error( \"Missing DMenu creator.\" );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Rectangle, Texture } from \"pixi.js\";\n\nexport abstract class DynamicAtlasItem {\n\tid: string;\n\tref: number;\n\tframe: Rectangle;\n\ttexture: Texture;\n\n\twidth: number;\n\theight: number;\n\tstrokeWidth: number;\n\n\tconstructor(\n\t\tid: string,\n\t\twidth: number, height: number, strokeWidth: number,\n\t\tbaseTexture: BaseTexture\n\t) {\n\t\tthis.id = id;\n\t\tthis.ref = 0;\n\t\tconst resolution = baseTexture.resolution;\n\t\tthis.frame = new Rectangle( 0, 0, width * resolution, height * resolution );\n\t\tthis.texture = new Texture( baseTexture, new Rectangle( 0, 0, 1, 1 ) );\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.strokeWidth = strokeWidth;\n\t}\n\n\tabstract render( context: CanvasRenderingContext2D ): void;\n\n\tapplyFrame(): void {\n\t\tconst resolutionInverse = 1 / this.texture.baseTexture.resolution;\n\t\tthis.texture.frame.x = this.frame.x * resolutionInverse;\n\t\tthis.texture.frame.y = this.frame.y * resolutionInverse;\n\t\tthis.texture.frame.width = this.width;\n\t\tthis.texture.frame.height = this.height;\n\t\tthis.texture.updateUvs();\n\t\tthis.texture.emit( \"update\", this );\n\t}\n\n\tdestroy(): void {\n\t\tthis.texture.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemEmpty extends DynamicAtlasItem {\n\trender( context: CanvasRenderingContext2D ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\nimport { DynamicSDFFontAtlas } from \"./dynamic-sdf-font-atlas\";\n\nexport class DynamicAtlasItemFontAtlas extends DynamicAtlasItem {\n\tcanvas: HTMLCanvasElement | null;\n\n\tconstructor( atlas: DynamicSDFFontAtlas, baseTexture: BaseTexture ) {\n\t\tsuper( atlas.id, atlas.width / baseTexture.resolution, atlas.height / baseTexture.resolution, 0, baseTexture );\n\t\tthis.canvas = atlas.canvas;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst frame = this.frame;\n\t\t\tcontext.drawImage( canvas, frame.x, frame.y, frame.width, frame.height );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemImage extends DynamicAtlasItem {\n\timage: HTMLImageElement;\n\n\tconstructor( image: HTMLImageElement, baseTexture: BaseTexture ) {\n\t\tsuper( image.src, image.width / baseTexture.resolution, image.height / baseTexture.resolution, 0, baseTexture );\n\t\tthis.image = image;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\t\tconst x = frame.x;\n\t\tconst y = frame.y;\n\t\tconst w = frame.width;\n\t\tconst h = frame.height;\n\t\tconst image = this.image;\n\n\t\tcontext.drawImage( image, x, y, w, h );\n\n\t\tcontext.drawImage( image, 0, 0, 1, h, x - 1, y - 1, 1, h + 2 );\n\t\tcontext.drawImage( image, 0, 0, w, 1, x, y - 1, w, 1 );\n\t\tcontext.drawImage( image, w - 1, 0, 1, h, x + w, y - 1, 1, h + 2 );\n\t\tcontext.drawImage( image, 0, h - 1, w, 1, x, y + h, w, 1 );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Text } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemText extends DynamicAtlasItem {\n\tprotected _text: Text;\n\n\tconstructor( id: string, text: Text, baseTexture: BaseTexture ) {\n\t\tsuper( id, text.width, text.height, 0, baseTexture );\n\t\tthis._text = text;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\t\tcontext.drawImage( this._text.canvas, frame.x, frame.y, frame.width, frame.height );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemWhite extends DynamicAtlasItem {\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\n\t\tcontext.save();\n\t\tcontext.fillStyle = \"#ffffff\";\n\t\tcontext.fillRect( frame.x - 1, frame.y - 1, frame.width + 2, frame.height + 2 );\n\t\tcontext.restore();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, MIPMAP_MODES, settings, Texture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\nimport { DynamicAtlasItemEmpty } from \"./dynamic-atlas-item-empty\";\nimport { DynamicAtlasItemWhite } from \"./dynamic-atlas-item-white\";\n\nconst MAXIMUM_TEXTURE_SIZE = 4096;\n\nexport class DynamicAtlas {\n\tprotected static INSTANCE: DynamicAtlas | null;\n\n\tprotected _canvas: HTMLCanvasElement;\n\tprotected _sortedData: DynamicAtlasItem[];\n\tprotected _idToDatum: { [ id: string ]: DynamicAtlasItem };\n\tprotected _baseTexture: BaseTexture;\n\tprotected _isDirty: boolean;\n\tprotected _predefined: { [ id: string ]: DynamicAtlasItem };\n\n\tconstructor() {\n\t\tconst canvas = this._canvas = document.createElement( \"canvas\" );\n\t\tcanvas.width = canvas.height = 256;\n\n\t\tconst baseTexture = this._baseTexture = BaseTexture.from( canvas, {\n\t\t\tmipmap: MIPMAP_MODES.OFF,\n\t\t\tresolution: settings.RESOLUTION\n\t\t});\n\n\t\tthis._idToDatum = {};\n\t\tthis._sortedData = [];\n\t\tthis._predefined = {\n\t\t\tempty: new DynamicAtlasItemEmpty(\n\t\t\t\t\"empty\", 10, 10, 0, baseTexture\n\t\t\t),\n\t\t\twhite: new DynamicAtlasItemWhite(\n\t\t\t\t\"white\", 10, 10, 0, baseTexture\n\t\t\t)\n\t\t};\n\n\t\tthis._isDirty = true;\n\t}\n\n\tupdateFrames( width: number, data: DynamicAtlasItem[] ): number {\n\t\tconst padding = 4;\n\t\tlet x = padding;\n\t\tlet y = padding;\n\t\tlet maxRowHeight = 0;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( width < x + datum.frame.width + padding ) {\n\t\t\t\tx = padding;\n\t\t\t\ty += maxRowHeight + padding;\n\t\t\t\tmaxRowHeight = 0;\n\t\t\t}\n\t\t\tdatum.frame.x = x | 0;\n\t\t\tdatum.frame.y = y | 0;\n\t\t\tx += datum.frame.width + padding;\n\t\t\tmaxRowHeight = Math.max( maxRowHeight, datum.frame.height );\n\t\t}\n\n\t\tconst minHeight = y + maxRowHeight + padding;\n\t\tlet result = 256;\n\t\twhile( result < minHeight ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn Math.min( MAXIMUM_TEXTURE_SIZE, result );\n\t}\n\n\trenderFrames( width: number, height: number, data: DynamicAtlasItem[] ): void {\n\t\tconst canvas = this._canvas;\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\t\tconst context = canvas.getContext( \"2d\" );\n\t\tif( context != null ) {\n\t\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\t\tconst datum = data[ i ];\n\t\t\t\tdatum.render( context );\n\t\t\t}\n\t\t}\n\t}\n\n\tapplyFrames( data: DynamicAtlasItem[] ): void {\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tdatum.applyFrame();\n\t\t}\n\t}\n\n\tcalcCanvasWidth( data: DynamicAtlasItem[] ): number {\n\t\tlet result = 128;\n\t\tfor( let i = data.length - 1; 0 <= i; --i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tconst size = Math.max( datum.frame.width, datum.frame.height );\n\t\t\twhile( result < size ) {\n\t\t\t\tresult <<= 1;\n\t\t\t}\n\t\t}\n\t\treturn Math.min( MAXIMUM_TEXTURE_SIZE, result << 1 );\n\t}\n\n\tcleanup( data: DynamicAtlasItem[] ): void {\n\t\tdata.sort( DynamicAtlas.ITEM_COMPARATOR );\n\t\tfor( let i = data.length - 1; 0 <= i; --i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( 0 < datum.ref ) {\n\t\t\t\tdata.length = i + 1;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tdata.length = 0;\n\t}\n\n\tbegin(): void {\n\t\tconst data = this._sortedData;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tdatum.ref = 0;\n\t\t}\n\n\t\tthis._isDirty = false;\n\t}\n\n\tend(): void {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst data = this._sortedData;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( datum.ref <= 0 ) {\n\t\t\t\tif( !( datum.id in this._predefined ) ) {\n\t\t\t\t\tdatum.destroy();\n\t\t\t\t}\n\t\t\t\tdelete idToDatum[ datum.id ];\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\trepack( forcibly?: boolean ): void {\n\t\tif( forcibly === true || this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tconst data = this._sortedData;\n\t\t\tthis.cleanup( data );\n\t\t\tconst canvasWidth = this.calcCanvasWidth( data );\n\t\t\tconst canvasHeight = this.updateFrames( canvasWidth, data );\n\t\t\tthis.renderFrames( canvasWidth, canvasHeight, data );\n\t\t\tthis._baseTexture.setRealSize( canvasWidth, canvasHeight );\n\t\t\tthis.applyFrames( data );\n\t\t}\n\t}\n\n\tget( id: string ): DynamicAtlasItem | null {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst datum =  idToDatum[ id ];\n\t\tif( datum != null ) {\n\t\t\tdatum.ref += 1;\n\t\t\treturn datum;\n\t\t} else {\n\t\t\tconst predefined = this._predefined[ id ];\n\t\t\tif( predefined != null ) {\n\t\t\t\tthis.set( id, predefined );\n\t\t\t\treturn predefined;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( id: string, item: DynamicAtlasItem ): DynamicAtlasItem | undefined {\n\t\tconst result = this._idToDatum[ id ];\n\t\titem.ref += 1;\n\t\tthis._idToDatum[ id ] = item;\n\t\tthis._sortedData.push( item );\n\t\tthis._isDirty = true;\n\t\treturn result;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._isDirty = true;\n\t}\n\n\tgetDefaultTexture(): Texture {\n\t\treturn this.get( \"white\" )!.texture;\n\t}\n\n\tgetBaseTexture(): BaseTexture {\n\t\treturn this._baseTexture;\n\t}\n\n\trelease( id: string ): void {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst datum = idToDatum[ id ];\n\t\tif( datum != null ) {\n\t\t\tdatum.ref -= 1;\n\t\t\tif( datum.ref <= 0 ) {\n\t\t\t\tif( !( datum.id in this._predefined ) ) {\n\t\t\t\t\tdatum.destroy();\n\t\t\t\t}\n\t\t\t\tdelete idToDatum[ id ];\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic ITEM_COMPARATOR = ( a: DynamicAtlasItem, b: DynamicAtlasItem ): number => {\n\t\tif( a.ref <= 0 ) {\n\t\t\tif( b.ref <= 0 ) {\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\treturn +1;\n\t\t\t}\n\t\t} else {\n\t\t\tif( b.ref <= 0 ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tif( a.frame.height < b.frame.height ) {\n\t\t\treturn -1;\n\t\t} else if( b.frame.height < a.frame.height ) {\n\t\t\treturn +1;\n\t\t} else {\n\t\t\treturn a.frame.width - b.frame.width;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nconst VERTEX_SHADER = `\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nvarying mediump vec2 vTextureCoord;\nvoid main(void) {\n\tgl_Position = vec4(aVertexPosition, 0.0, 1.0);\n\tvTextureCoord = aTextureCoord;\n}\n`;\n\nconst FRAGMENT_SHADER = `\nprecision mediump float;\n\nvarying mediump vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uSize;\n\nfloat calcDistance( float x, float y, float dx, float dy ) {\n\tfloat xd = x + dx;\n\tfloat yd = y + dy;\n\tfloat u = xd / uSize.x;\n\tfloat v = yd / uSize.y;\n\tfloat ul = (xd - 1.0) / uSize.x;\n\tfloat vt = (yd - 1.0) / uSize.y;\n\n\tfloat m = texture2D(uSampler, vec2(u , v )).a;\n\tfloat l = texture2D(uSampler, vec2(ul, v )).a;\n\tfloat t = texture2D(uSampler, vec2(u , vt)).a;\n\n\tfloat xl = mix( xd - 1.0, xd, (0.5 - l) / (m - l) );\n\tfloat yt = mix( yd - 1.0, yd, (0.5 - t) / (m - t) );\n\n\tbool bl = ( min(l, m) < 0.5 && 0.5 <= max(l, m) );\n\tbool bt = ( min(t, m) < 0.5 && 0.5 <= max(t, m) );\n\n\tfloat ll = (bl ? length( vec2( xl - x, yd - y ) ) : 100.0);\n\tfloat lt = (bt ? length( vec2( xd - x, yt - y ) ) : 100.0);\n\n\treturn min( ll, lt );\n}\n\nfloat calcDistancesY( float x, float y, float dx ) {\n\tfloat d = 100.0;\n\tfor( float dy=-6.0; dy<6.5; dy++ ) {\n\t\td = min( d, calcDistance( x, y, dx, dy ) );\n\t}\n\treturn d;\n}\n\nfloat calcDistances( float x, float y ) {\n\tfloat d = 100.0;\n\tfor( float dx=-6.0; dx<6.5; dx++ ) {\n\t\td = min( d, calcDistancesY( x, y, dx ) );\n\t}\n\treturn d;\n}\n\nvoid main(void) {\n\tfloat t = texture2D(uSampler, vTextureCoord).a;\n\tfloat x = vTextureCoord.x * uSize.x;\n\tfloat y = vTextureCoord.y * uSize.y;\n\tfloat d = min( 6.0, calcDistances( x, y ) ) / 12.0;\n\td = clamp( mix( 0.5 - d, 0.5 + d, step( 0.5, t ) ), 0.0, 1.0 );\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, d);\n}\n`;\n\nexport class DynamicSDFFontGenerator {\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _onLostBound: EventListener;\n\tprotected _onRestoreBound: EventListener;\n\tprotected _onUnloadBound: EventListener;\n\tprotected _gl: WebGLRenderingContext | null;\n\tprotected _texture: WebGLTexture | null;\n\tprotected _shaderProgram: WebGLProgram | null;\n\tprotected _vertexPositionAttribute: number;\n\tprotected _textureCoordAttribute: number;\n\tprotected _samplerUniform: WebGLUniformLocation | null;\n\tprotected _sizeUniform: WebGLUniformLocation | null;\n\tprotected _vb: WebGLBuffer | null;\n\tprotected _uvb: WebGLBuffer | null;\n\n\tconstructor() {\n\t\tthis._gl = null;\n\t\tthis._texture = null;\n\t\tthis._shaderProgram = null;\n\t\tthis._vertexPositionAttribute = NaN;\n\t\tthis._textureCoordAttribute = NaN;\n\t\tthis._samplerUniform = NaN;\n\t\tthis._sizeUniform = NaN;\n\t\tthis._vb = null;\n\t\tthis._uvb = null;\n\n\t\tconst canvas = this._canvas = document.createElement( \"canvas\" );\n\t\tcanvas.width = 64;\n\t\tcanvas.height = 64;\n\t\tthis._onLostBound = ( e: Event ): void => {\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis._onRestoreBound = (): void => {\n\t\t\tthis.restore();\n\t\t};\n\t\tthis._onUnloadBound = (): void => {\n\t\t\tthis.destroy();\n\t\t};\n\t\tcanvas.addEventListener( \"webglcontextlost\", this._onLostBound, false);\n\t\tcanvas.addEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\n\t\twindow.addEventListener( \"unload\", this._onUnloadBound, false );\n\t}\n\n\tinit() {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null && (this._gl == null || this._gl.isContextLost()) ) {\n\t\t\tconst config: WebGLContextAttributes = {\n\t\t\t\talpha: true,\n\t\t\t\tantialias: false,\n\t\t\t\tdepth: false,\n\t\t\t\tstencil: false,\n\t\t\t\tpremultipliedAlpha: false\n\t\t\t};\n\t\t\tconst gl = this._gl = (\n\t\t\t\tcanvas.getContext( \"webgl\", config ) ||\n\t\t\t\tcanvas.getContext( \"experimental-webgl\", config ) as WebGLRenderingContext | null\n\t\t\t);\n\t\t\tif( gl != null ) {\n\t\t\t\tgl.clearColor(1.0, 1.0, 1.0, 0.0);\n\t\t\t\tthis.makeVertexBuffer();\n\t\t\t\tthis.makeUvBuffer();\n\t\t\t\tthis.makeShaders();\n\t\t\t\tthis._texture = null;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\trestore() {\n\t\tthis.init();\n\t}\n\n\tgetCanvas() {\n\t\treturn this._canvas;\n\t}\n\n\tgetShader( gl: WebGLRenderingContext, code: string, type: boolean ) {\n\t\tconst shader = ( type ?\n\t\t\tgl.createShader( gl.FRAGMENT_SHADER ) :\n\t\t\tgl.createShader( gl.VERTEX_SHADER )\n\t\t);\n\t\tif( shader != null ) {\n\t\t\tgl.shaderSource( shader, code );\n\t\t\tgl.compileShader( shader );\n\t\t\tif( ! gl.getShaderParameter( shader, gl.COMPILE_STATUS ) ) {\n\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\n\t\t\t\tconsole && console.error( `Failed to compile the shader: ${gl.getShaderInfoLog(shader)}` );\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\treturn shader;\n\t}\n\n\tmakeShaders() {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst vertexShader = this.getShader( gl, VERTEX_SHADER, false );\n\t\t\tif( vertexShader != null ) {\n\t\t\t\tconst fragmentShader = this.getShader( gl, FRAGMENT_SHADER, true );\n\t\t\t\tif( fragmentShader != null ) {\n\t\t\t\t\tconst shaderProgram = this._shaderProgram = gl.createProgram();\n\t\t\t\t\tif( shaderProgram != null ) {\n\t\t\t\t\t\tgl.attachShader( shaderProgram, vertexShader );\n\t\t\t\t\t\tgl.attachShader( shaderProgram, fragmentShader );\n\t\t\t\t\t\tgl.linkProgram( shaderProgram );\n\t\t\t\t\t\tif( ! gl.getProgramParameter(shaderProgram, gl.LINK_STATUS) ) {\n\t\t\t\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\n\t\t\t\t\t\t\tconsole && console.error( `Failed to link the program: ${gl.getError()}` );\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\n\t\t\t\t\t\t\tgl.useProgram( shaderProgram );\n\t\t\t\t\t\t\tthis._vertexPositionAttribute = gl.getAttribLocation( shaderProgram, \"aVertexPosition\" );\n\t\t\t\t\t\t\tthis._textureCoordAttribute = gl.getAttribLocation( shaderProgram, \"aTextureCoord\" );\n\t\t\t\t\t\t\tthis._samplerUniform = gl.getUniformLocation( shaderProgram, \"uSampler\" );\n\t\t\t\t\t\t\tthis._sizeUniform = gl.getUniformLocation( shaderProgram, \"uSize\" );\n\t\t\t\t\t\t\tgl.useProgram( null );\n\t\t\t\t\t\t\treturn shaderProgram;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyShaders() {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst shaderProgram = this._shaderProgram;\n\t\t\tif( shaderProgram != null ) {\n\t\t\t\tthis._shaderProgram = null;\n\t\t\t\tgl.useProgram( null );\n\t\t\t\tgl.deleteProgram( shaderProgram );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTexture( textureCanvas: HTMLCanvasElement ) {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\n\t\t\tconst width = textureCanvas.width;\n\t\t\tconst height = textureCanvas.height;\n\t\t\tif( canvas.width !== width || canvas.height !== height ) {\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\t\t\t\tgl.viewport( 0, 0, width, height );\n\t\t\t}\n\n\t\t\tlet texture = this._texture;\n\t\t\tif( texture == null ) {\n\t\t\t\ttexture = this._texture = gl.createTexture();\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t} else {\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, textureCanvas );\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t}\n\t\t\treturn texture;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyTexture() {\n\t\tconst gl = this._gl;\n\t\tconst texture = this._texture;\n\t\tif( gl != null && gl.isContextLost() !== true && texture != null ) {\n\t\t\tthis._texture = null;\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\tgl.deleteTexture( texture );\n\t\t}\n\t}\n\n\tmakeVertexBuffer() {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst vb = this._vb = gl.createBuffer();\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\n\n\t\t\tconst vertices = [\n\t\t\t\t-1.0, +1.0,\n\t\t\t\t+1.0, +1.0,\n\t\t\t\t-1.0, -1.0,\n\t\t\t\t+1.0, -1.0\n\t\t\t];\n\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW );\n\t\t\treturn vb;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyVertexBuffer() {\n\t\tconst gl = this._gl;\n\t\tconst vb = this._vb;\n\t\tif( gl != null && gl.isContextLost() !== true && vb != null ) {\n\t\t\tthis._vb = null;\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.deleteBuffer( vb );\n\t\t}\n\t}\n\n\tmakeUvBuffer() {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst uvb = this._uvb = gl.createBuffer();\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\n\n\t\t\tconst uvs = [\n\t\t\t\t0.0,  0.0,\n\t\t\t\t1.0,  0.0,\n\t\t\t\t0.0,  1.0,\n\t\t\t\t1.0,  1.0\n\t\t\t];\n\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(uvs), gl.STATIC_DRAW );\n\t\t\treturn uvb;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyUvBuffer() {\n\t\tconst gl = this._gl;\n\t\tconst uvb = this._uvb;\n\t\tif( gl != null && gl.isContextLost() !== true && uvb != null ) {\n\t\t\tthis._uvb = null;\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.deleteBuffer( uvb );\n\t\t}\n\t}\n\n\trender() {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tconst shaderProgram = this._shaderProgram;\n\t\tconst vb = this._vb;\n\t\tconst uvb = this._uvb;\n\t\tconst texture = this._texture;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null &&\n\t\t\tshaderProgram != null && vb != null && uvb != null && texture != null ) {\n\t\t\tgl.clear( gl.COLOR_BUFFER_BIT );\n\n\t\t\tgl.useProgram( shaderProgram );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\n\t\t\tconst vertexPositionAttribute = this._vertexPositionAttribute;\n\t\t\tgl.enableVertexAttribArray( vertexPositionAttribute );\n\t\t\tgl.vertexAttribPointer( vertexPositionAttribute, 2, gl.FLOAT, false, 0, 0 );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\n\t\t\tconst textureCoordAttribute = this._textureCoordAttribute;\n\t\t\tgl.enableVertexAttribArray( textureCoordAttribute );\n\t\t\tgl.vertexAttribPointer( textureCoordAttribute, 2, gl.FLOAT, false, 0, 0 );\n\n\t\t\tgl.activeTexture( gl.TEXTURE0 );\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\tgl.uniform1i( this._samplerUniform, 0 );\n\t\t\tgl.uniform2f( this._sizeUniform, canvas.width, canvas.height );\n\n\t\t\tgl.drawArrays( gl.TRIANGLE_STRIP, 0, 4 );\n\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.useProgram( null );\n\t\t}\n\t}\n\n\tread( copyCanvas: HTMLCanvasElement ) {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\n\t\t\tconst width = canvas.width;\n\t\t\tconst height = canvas.height;\n\t\t\tcopyCanvas.width = width;\n\t\t\tcopyCanvas.height = height;\n\t\t\tconst copyContext = copyCanvas.getContext( \"2d\" );\n\t\t\tif( copyContext != null ) {\n\t\t\t\tcopyContext.drawImage( canvas, 0, 0 );\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tthis.destroyVertexBuffer();\n\t\tthis.destroyUvBuffer();\n\t\tthis.destroyShaders();\n\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t\tcanvas.removeEventListener( \"webglcontextlost\", this._onLostBound, false);\n\t\t\tcanvas.removeEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\n\t\t\twindow.removeEventListener( \"unload\", this._onUnloadBound, false );\n\t\t}\n\n\t\tconst gl = this._gl;\n\t\tif( gl != null ) {\n\t\t\tthis._gl = null;\n\t\t\tconst WebGLLoseContext = gl.getExtension( \"WEBGL_lose_context\" );\n\t\t\tif( WebGLLoseContext != null ) {\n\t\t\t\tWebGLLoseContext.loseContext();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemes } from \"../theme/d-themes\";\nimport { ASCII_CHARACTERS } from \"./ascii\";\nimport { DynamicFontAtlasCharacter } from \"./dynamic-font-atlas-character\";\nimport { DynamicFontAtlasCharacters } from \"./dynamic-font-atlas-characters\";\nimport { DynamicSDFFontGenerator } from \"./dynamic-sdf-font-generator\";\n\nexport interface DynamicSDFFontAtlasFont {\n\tfamily: string;\n\tsize: number;\n\titalic: boolean;\n}\n\nexport interface DynamicSDFFontAtlasJson {\n\twidth: number;\n\theight: number;\n\tfont: DynamicSDFFontAtlasFont;\n\tcharacters: DynamicFontAtlasCharacters;\n}\n\nexport class DynamicSDFFontAtlas {\n\tprotected static GENERATOR: DynamicSDFFontGenerator | null = null;\n\tprotected static FONT_FAMILY_AUTO: string | null = null;\n\n\tprotected _id: string;\n\tprotected _generator: DynamicSDFFontGenerator | null;\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _font: DynamicSDFFontAtlasFont;\n\tprotected _characters: DynamicFontAtlasCharacters;\n\tprotected _length: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _isDirty: boolean;\n\n\tconstructor( fontFamily: string ) {\n\t\tthis._id = `font-atlas:${fontFamily}`;\n\t\tthis._generator = DynamicSDFFontAtlas.getGenerator().init();\n\t\tthis._canvas = document.createElement( \"canvas\" );\n\t\tthis._font = {\n\t\t\tfamily: DynamicSDFFontAtlas.toFontFamily( fontFamily ),\n\t\t\tsize: 32,\n\t\t\titalic: false\n\t\t};\n\t\tthis._characters = {};\n\t\tthis._length = 0;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\t\tthis._isDirty = true;\n\t}\n\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget font(): DynamicSDFFontAtlasFont {\n\t\treturn this._font;\n\t}\n\n\tset font( font: DynamicSDFFontAtlasFont ) {\n\t\tthis._font.family = font.family;\n\t\tthis._font.size = font.size;\n\t\tthis._font.italic = font.italic;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tget canvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tget generator(): DynamicSDFFontGenerator | null {\n\t\treturn this._generator;\n\t}\n\n\tget characters(): DynamicFontAtlasCharacters {\n\t\treturn this._characters;\n\t}\n\n\tbegin(): void {\n\t\tthis._length = 0;\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tcharacters[ character ].ref = 0;\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data.ref <= 0 ) {\n\t\t\t\tdata.life -= 1;\n\t\t\t\tif( data.life <= 0 ) {\n\t\t\t\t\tdelete characters[ character ];\n\t\t\t\t\tthis._isDirty =  true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddAscii(): void {\n\t\tthis.add( ASCII_CHARACTERS );\n\t\tthis.addChar( \"...\" );\n\t}\n\n\taddChar( character: string ): void {\n\t\tconst characters = this._characters;\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( data.ref <= 0 ) {\n\t\t\t\t\tthis._length += 1;\n\t\t\t\t}\n\t\t\t\tdata.ref += 1;\n\t\t\t} else {\n\t\t\t\tcharacters[ character ] = new DynamicFontAtlasCharacter( 0, 1, 1, false );\n\t\t\t\tthis._length += 1;\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( characters: string ): void {\n\t\tfor( let i = 0, imax = characters.length; i < imax; ++i ) {\n\t\t\tthis.addChar( characters[ i ] );\n\t\t}\n\t}\n\n\tget( character: string ): DynamicFontAtlasCharacter | undefined {\n\t\treturn this._characters[ character ];\n\t}\n\n\tupdate(): boolean {\n\t\tif( this._isDirty ) {\n\t\t\tconst canvas = this._canvas;\n\t\t\tconst generator = this._generator;\n\t\t\tif( canvas != null && generator != null ) {\n\t\t\t\tconst context = canvas.getContext( \"2d\" );\n\t\t\t\tif( context != null ) {\n\t\t\t\t\tthis._isDirty = false;\n\n\t\t\t\t\tconst font = this._font;\n\t\t\t\t\tconst characters = this._characters;\n\t\t\t\t\tconst characterSize = font.size + 14;\n\t\t\t\t\tconst width = DynamicSDFFontAtlas.toPowerOf2( Math.ceil( Math.sqrt( this._length ) ) * characterSize );\n\t\t\t\t\tthis._width = width;\n\t\t\t\t\tconst fontStyle = (font.italic ? \"italic \" : \"\") + (font.size + \"px \") + font.family;\n\n\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\tcontext.textAlign = \"left\";\n\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\tcontext.lineWidth = 0;\n\t\t\t\t\tcontext.lineCap = \"round\";\n\t\t\t\t\tcontext.lineJoin = \"miter\";\n\t\t\t\t\tcontext.miterLimit = 0;\n\t\t\t\t\tcontext.fillStyle = \"#FFFFFF\";\n\n\t\t\t\t\tconst offsetX = 7;\n\t\t\t\t\tconst offsetY = ( characterSize >> 1 );\n\t\t\t\t\tlet x = 0;\n\t\t\t\t\tlet y = 0;\n\t\t\t\t\tfor( const character in characters ) {\n\t\t\t\t\t\tconst data = characters[ character ];\n\t\t\t\t\t\tconst advance = context.measureText( character ).width;\n\t\t\t\t\t\tconst characterWidth = Math.ceil( offsetX + advance + offsetX );\n\t\t\t\t\t\tconst characterHeight = characterSize;\n\t\t\t\t\t\tif( width <= x + characterWidth ) {\n\t\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\t\ty += characterSize;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdata.x = x;\n\t\t\t\t\t\tdata.y = y;\n\t\t\t\t\t\tdata.width = characterWidth;\n\t\t\t\t\t\tdata.height = characterHeight;\n\t\t\t\t\t\tdata.advance = advance;\n\t\t\t\t\t\tdata.origin.x = x + offsetX;\n\t\t\t\t\t\tdata.origin.y = y + offsetY;\n\n\t\t\t\t\t\tx += characterWidth;\n\t\t\t\t\t}\n\t\t\t\t\tconst height = this._height = y + characterSize;\n\n\t\t\t\t\t// Make a input canvas\n\t\t\t\t\t// Here, we need to reset the context because\n\t\t\t\t\t// context settings will be lost when we set the width/height.\n\t\t\t\t\tcanvas.width = width;\n\t\t\t\t\tcanvas.height = height;\n\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\tcontext.textAlign = \"left\";\n\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\tcontext.lineWidth = 0;\n\t\t\t\t\tcontext.lineCap = \"round\";\n\t\t\t\t\tcontext.lineJoin = \"miter\";\n\t\t\t\t\tcontext.miterLimit = 4;\n\t\t\t\t\tcontext.fillStyle = \"#FFFFFF\";\n\t\t\t\t\tcontext.clearRect( 0, 0, width, height );\n\t\t\t\t\tfor( const character in characters ) {\n\t\t\t\t\t\tconst data = characters[ character ];\n\t\t\t\t\t\tcontext.fillText( character, data.origin.x, data.origin.y );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Convert to SDF font texture\n\t\t\t\t\tgenerator.updateTexture( canvas );\n\t\t\t\t\tgenerator.render();\n\t\t\t\t\tgenerator.read( canvas );\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tget length(): number {\n\t\treturn this._length;\n\t}\n\n\ttoJson(): DynamicSDFFontAtlasJson {\n\t\treturn {\n\t\t\twidth: this._width,\n\t\t\theight: this._height,\n\t\t\tfont: this._font,\n\t\t\tcharacters: this._characters\n\t\t};\n\t}\n\n\ttoString(): string {\n\t\treturn JSON.stringify( this.toJson() );\n\t}\n\n\tdestroy() {\n\t\tconst generator = this._generator;\n\t\tif( generator != null ) {\n\t\t\tthis._generator = null;\n\t\t}\n\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t}\n\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tdelete characters[ character ];\n\t\t}\n\t}\n\n\tstatic toFontFamily( fontFamily: string ) {\n\t\treturn ( fontFamily === \"auto\" ?\n\t\t\tDynamicSDFFontAtlas.getAutoFontFamily() :\n\t\t\tfontFamily\n\t\t);\n\t}\n\n\tstatic toPowerOf2( size: number ): number {\n\t\tlet result = 32;\n\t\twhile( result < size ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic getGenerator(): DynamicSDFFontGenerator {\n\t\tif( DynamicSDFFontAtlas.GENERATOR == null ) {\n\t\t\tDynamicSDFFontAtlas.GENERATOR = new DynamicSDFFontGenerator();\n\t\t}\n\t\treturn DynamicSDFFontAtlas.GENERATOR;\n\t}\n\n\tstatic getAutoFontFamily(): string {\n\t\tif( DynamicSDFFontAtlas.FONT_FAMILY_AUTO == null ) {\n\t\t\tDynamicSDFFontAtlas.FONT_FAMILY_AUTO = (DThemes.getInstance().get( \"DBase\" ) as any).getFontFamilly() as string;\n\t\t}\n\t\treturn DynamicSDFFontAtlas.FONT_FAMILY_AUTO;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlas } from \"./dynamic-atlas\";\nimport { DynamicAtlasItemFontAtlas } from \"./dynamic-atlas-item-font-atlas\";\nimport { DynamicSDFFontAtlas } from \"./dynamic-sdf-font-atlas\";\n\nexport class DynamicSDFFontAtlases {\n\tprotected _atlases: { [ family: string ]: DynamicSDFFontAtlas };\n\n\tconstructor() {\n\t\tthis._atlases = {};\n\t}\n\n\tbegin(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tatlas.begin();\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tif( 0 < atlas.length ) {\n\t\t\t\tatlas.addAscii();\n\t\t\t}\n\t\t\tatlas.end();\n\t\t\tif( atlas.length <= 0 ) {\n\t\t\t\tatlas.destroy();\n\t\t\t\tdelete atlases[ family ];\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( family: string, targets: string ) {\n\t\tconst atlas = this._atlases[ family ];\n\t\tif( atlas != null ) {\n\t\t\tatlas.add( targets );\n\t\t} else {\n\t\t\tconst newAtlas = new DynamicSDFFontAtlas( family );\n\t\t\tnewAtlas.add( targets );\n\t\t\tthis._atlases[ family ] = newAtlas;\n\t\t}\n\t}\n\n\tget( family: string ): DynamicSDFFontAtlas | null {\n\t\tconst atlas = this._atlases[ family ];\n\t\tif( atlas != null ) {\n\t\t\treturn atlas;\n\t\t}\n\t\treturn null;\n\t}\n\n\tupdate( baseAtlas: DynamicAtlas ): void {\n\t\tconst atlases = this._atlases;\n\t\tconst baseTexture = baseAtlas.getBaseTexture();\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tif( atlas.update() ) {\n\t\t\t\tconst atlasId = atlas.id;\n\t\t\t\tconst item = baseAtlas.get( atlasId );\n\t\t\t\tif( item != null ) {\n\t\t\t\t\tconst width = atlas.width;\n\t\t\t\t\tconst height = atlas.height;\n\t\t\t\t\tconst resolution = baseTexture.resolution;\n\t\t\t\t\titem.frame.width = width;\n\t\t\t\t\titem.frame.height = height;\n\t\t\t\t\titem.width = width / resolution;\n\t\t\t\t\titem.height = height / resolution;\n\t\t\t\t\tbaseAtlas.toDirty();\n\t\t\t\t} else {\n\t\t\t\t\tbaseAtlas.set(\n\t\t\t\t\t\tatlasId,\n\t\t\t\t\t\tnew DynamicAtlasItemFontAtlas( atlas, baseTexture )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tatlas.destroy();\n\t\t}\n\t\tthis._atlases = {};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\n\nexport class Lazy<INSTANCE, OPTIONS> {\n\tinstance: INSTANCE | null;\n\tnewInstance: new ( options: OPTIONS ) => INSTANCE;\n\toptions: OPTIONS;\n\n\tconstructor( newInstance: new ( options: OPTIONS ) => INSTANCE, options: OPTIONS, base?: DBase ) {\n\t\tthis.instance = null;\n\t\tthis.newInstance = newInstance;\n\t\tthis.options = options;\n\n\t\tif( base != null ) {\n\t\t\tif( base.isActive() ) {\n\t\t\t\tsetTimeout((): void => {\n\t\t\t\t\tthis.get();\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t\tbase.on( \"active\", (): void => {\n\t\t\t\tthis.get();\n\t\t\t});\n\t\t}\n\t}\n\n\tget(): INSTANCE {\n\t\tlet instance = this.instance;\n\t\tif( instance == null ) {\n\t\t\tinstance = this.instance = new (this.newInstance)( this.options );\n\t\t}\n\t\treturn instance;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeA implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn (date.getHours() < 12 ? \"AM\" : \"PM\");\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodea implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn (date.getHours() < 12 ? \"am\" : \"pm\");\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeD implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getDate());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoded implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${target | 0}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport abstract class FormatNodePrecision implements FormatNode {\n\tprotected precision: number;\n\n\tconstructor( precision?: string ) {\n\t\tif (precision != null) {\n\t\t\tthis.precision = +precision.substring(1, precision.length);\n\t\t} else {\n\t\t\tthis.precision = 0;\n\t\t}\n\t}\n\n\tabstract format( target: number, step: number, date: Date ): string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodee extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toExponential(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodef extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toFixed(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodefsi extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst abs = this.toAbs( target, step, date );\n\t\tif( abs < 1e-24 ) {\n\t\t\treturn this.format_( target, 1e+00, \"\"  );\n\t\t} else if( abs < 1e-21 ) {\n\t\t\treturn this.format_( target, 1e+24, \"y\" );\n\t\t} else if( abs < 1e-18 ) {\n\t\t\treturn this.format_( target, 1e+21, \"z\" );\n\t\t} else if( abs < 1e-15 ) {\n\t\t\treturn this.format_( target, 1e+18, \"a\" );\n\t\t} else if( abs < 1e-12 ) {\n\t\t\treturn this.format_( target, 1e+15, \"f\" );\n\t\t} else if( abs < 1e-09 ) {\n\t\t\treturn this.format_( target, 1e+12, \"p\" );\n\t\t} else if( abs < 1e-06 ) {\n\t\t\treturn this.format_( target, 1e+09, \"n\" );\n\t\t} else if( abs < 1e-03 ) {\n\t\t\treturn this.format_( target, 1e+06, \"\" );\n\t\t} else if( abs < 1e+00 ) {\n\t\t\treturn this.format_( target, 1e+03, \"m\" );\n\t\t} else if( abs < 1e+03 ) {\n\t\t\treturn this.format_( target, 1e+00, \"\"  );\n\t\t} else if( abs < 1e+06 ) {\n\t\t\treturn this.format_( target, 1e-03, \"k\" );\n\t\t} else if( abs < 1e+09 ) {\n\t\t\treturn this.format_( target, 1e-06, \"M\" );\n\t\t} else if( abs < 1e+12 ) {\n\t\t\treturn this.format_( target, 1e-09, \"G\" );\n\t\t} else if( abs < 1e+15 ) {\n\t\t\treturn this.format_( target, 1e-12, \"T\" );\n\t\t} else if( abs < 1e+18 ) {\n\t\t\treturn this.format_( target, 1e-15, \"P\" );\n\t\t} else if( abs < 1e+21 ) {\n\t\t\treturn this.format_( target, 1e-18, \"E\" );\n\t\t} else if( abs < 1e+24 ) {\n\t\t\treturn this.format_( target, 1e-21, \"Z\" );\n\t\t} else {\n\t\t\treturn this.format_( target, 1e-24, \"Y\" );\n\t\t}\n\t}\n\n\tprotected toAbs(target: number, step: number, date: Date): number {\n\t\treturn Math.abs(target);\n\t}\n\n\tprotected format_(target: number, unitInverse: number, postfix: string): string {\n\t\tconst value = target * unitInverse;\n\t\treturn `${value.toFixed(this.precision)}${postfix}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodeg extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toPrecision(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeH implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getHours());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeh implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getHours() % 12);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeM implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMonth() + 1);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodem implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMinutes());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodemi implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMilliseconds());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeP implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${(target * 100) | 0}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodep implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${target | 0}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilPad = ( str: string, length: number, c: string ): string => {\n\tconst strLength = str.length;\n\tif( length < strLength ) {\n\t\treturn str;\n\t}\n\tlet padding = \"\";\n\tfor( let i = 0, imax = length - strLength; i < imax; ++i ) {\n\t\tpadding += c;\n\t}\n\treturn padding + str;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utilPad } from \"../util-pad\";\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodePadding implements FormatNode {\n\tprotected length: number;\n\tprotected character: string;\n\tprotected node: FormatNode;\n\n\tconstructor( length: number, character: string, node: FormatNode ) {\n\t\tthis.length = length;\n\t\tthis.character = character;\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn utilPad(this.node.format(target, step, date), this.length, this.character);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeParenthesis {\n\tprotected node: FormatNode;\n\n\tconstructor( node: FormatNode ) {\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif (0 < result.length && result[0] === \"-\") {\n\t\t\treturn `(${result.substring(1, result.length)})`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodePlus implements FormatNode {\n\tprotected node: FormatNode;\n\n\tconstructor(node: FormatNode) {\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif (0 < result.length && result[0] !== \"-\") {\n\t\t\treturn `+${result}`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeRP implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${Math.round(target * 100)}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoderp implements FormatNode {\n\tformat(target: number, step: number, date: Date): string {\n\t\treturn `${Math.round(target)}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodesdt implements FormatNode {\n\tprotected Y: FormatNode;\n\tprotected M: FormatNode;\n\tprotected D: FormatNode;\n\tprotected H: FormatNode;\n\tprotected m: FormatNode;\n\tprotected s: FormatNode;\n\tprotected mi: FormatNode;\n\n\tconstructor(\n\t\tY: FormatNode, M: FormatNode, D: FormatNode,\n\t\tH: FormatNode, m: FormatNode, s: FormatNode, mi: FormatNode\n\t) {\n\t\tthis.Y = Y;\n\t\tthis.M = M;\n\t\tthis.D = D;\n\t\tthis.H = H;\n\t\tthis.m = m;\n\t\tthis.s = s;\n\t\tthis.mi = mi;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tif (step < 1000) {\n\t\t\treturn `${this.s.format(target, step, date)}.${this.mi.format(target, step, date)}`;\n\t\t} else if (step < 60000) {\n\t\t\treturn `${this.m.format(target, step, date)}:${this.s.format(target, step, date)}`;\n\t\t} else if (step < 3600000) {\n\t\t\treturn `${this.H.format(target, step, date)}:${this.m.format(target, step, date)}`;\n\t\t} else if (step < 86400000) {\n\t\t\tconst M = this.M.format(target, step, date);\n\t\t\tconst D = this.D.format(target, step, date);\n\t\t\treturn `${M}/${D} ${this.H.format(target, step, date)}`;\n\t\t} else if (step < 2592000000) {\n\t\t\treturn `${this.M.format(target, step, date)}/${this.D.format(target, step, date)}`;\n\t\t} else {\n\t\t\treturn `${this.Y.format(target, step, date)}/${this.M.format(target, step, date)}`;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeSpace {\n\tprotected node: FormatNode;\n\tconstructor(node: FormatNode) {\n\t\tthis.node = node;\n\t}\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif( 0 < result.length && result[0] !== \"-\" ) {\n\t\t\treturn ` ${result}`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodefsi } from \"./format-node-fsi\";\n\nexport class FormatNodessi extends FormatNodefsi {\n\tprotected toAbs( target: number, step: number, date: Date ): number {\n\t\treturn Math.abs(step);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeString implements FormatNode {\n\tprotected str: string;\n\n\tconstructor(str: string) {\n\t\tthis.str = str;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn this.str;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeY implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getFullYear());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodey implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getFullYear() % 100);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utilPad } from \"../util-pad\";\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodez implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst z = date.getTimezoneOffset();\n\t\tconst tzs = (z <= 0 ? \"+\" : \"-\");\n\t\tconst tzh = utilPad(String(Math.floor(Math.abs(z) / 60)), 2, \"0\");\n\t\tconst tzm = utilPad(String(Math.floor(Math.abs(z) % 60)), 2, \"0\");\n\t\treturn `${tzs}${tzh}:${tzm}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoderd implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${Math.round(target)}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodes implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getSeconds());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node/format-node\";\nimport { FormatNodeA } from \"./format-node/format-node-a-large\";\nimport { FormatNodea } from \"./format-node/format-node-a-small\";\nimport { FormatNodeD } from \"./format-node/format-node-d-large\";\nimport { FormatNoded } from \"./format-node/format-node-d-small\";\nimport { FormatNodee } from \"./format-node/format-node-e\";\nimport { FormatNodef } from \"./format-node/format-node-f\";\nimport { FormatNodefsi } from \"./format-node/format-node-fsi\";\nimport { FormatNodeg } from \"./format-node/format-node-g\";\nimport { FormatNodeH } from \"./format-node/format-node-h-large\";\nimport { FormatNodeh } from \"./format-node/format-node-h-small\";\nimport { FormatNodeM } from \"./format-node/format-node-m-large\";\nimport { FormatNodem } from \"./format-node/format-node-m-small\";\nimport { FormatNodemi } from \"./format-node/format-node-mi\";\nimport { FormatNodeP } from \"./format-node/format-node-p-large\";\nimport { FormatNodep } from \"./format-node/format-node-p-small\";\nimport { FormatNodePadding } from \"./format-node/format-node-padding\";\nimport { FormatNodeParenthesis } from \"./format-node/format-node-parenthesis\";\nimport { FormatNodePlus } from \"./format-node/format-node-plus\";\nimport { FormatNodeRP } from \"./format-node/format-node-rp-large\";\nimport { FormatNoderp } from \"./format-node/format-node-rp-small\";\nimport { FormatNodesdt } from \"./format-node/format-node-sdt\";\nimport { FormatNodeSpace } from \"./format-node/format-node-space\";\nimport { FormatNodessi } from \"./format-node/format-node-ssi\";\nimport { FormatNodeString } from \"./format-node/format-node-string\";\nimport { FormatNodeY } from \"./format-node/format-node-y-large\";\nimport { FormatNodey } from \"./format-node/format-node-y-small\";\nimport { FormatNodez } from \"./format-node/format-node-z\";\nimport { FormatNoderd } from \"./format-node/format-noder-d\";\nimport { FormatNodes } from \"./format-node/format-nodes\";\nimport { NumberFormatter, NumberFormatterFunction } from \"./number-formatter\";\n\n// tslint:disable-next-line: max-line-length\nconst REGEXP = /%(0|_|-|\\+|\\()?(\\.\\d+)?(Y(?:MD?)?|y(?:MD?)?|MD?|D|H(?:ms?)?|h(?:ms?)?|m(?:i|s)?|a|A|s(?:s?i|dt)?|z|%|f(?:si)?|e|g|d|r(?:d|p)|p|P|RP)/g;\n\nexport class NumberFormatterImpl implements NumberFormatter {\n\tprotected isDateRequired: boolean;\n\tprotected nodes: FormatNode[];\n\tprotected date: Date;\n\n\tconstructor( format: string ) {\n\t\tlet previousIndex = 0;\n\t\tlet isDateRequired = false;\n\t\tconst nodes: FormatNode[] = [];\n\t\tREGEXP.lastIndex = 0;\n\t\twhile( true ) {\n\t\t\tconst matched = REGEXP.exec( format );\n\t\t\tif( matched != null ) {\n\t\t\t\tconst index = matched.index;\n\t\t\t\tif( previousIndex < index ) {\n\t\t\t\t\tnodes.push( new FormatNodeString( format.substring( previousIndex, index ) ) );\n\t\t\t\t}\n\t\t\t\tpreviousIndex = index + matched[ 0 ].length;\n\n\t\t\t\tconst all = matched[ 0 ];\n\t\t\t\tconst modifier = matched[ 1 ];\n\t\t\t\tconst precision = matched[ 2 ];\n\t\t\t\tconst specifier = matched[ 3 ];\n\n\t\t\t\tswitch( specifier ) {\n\t\t\t\tcase \"Y\": // full year\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodeY() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"YM\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"YMD\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"y\": // short year: [0, 99]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodey() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"yM\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodey() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"yMD\":\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodey() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"M\": // month: [1, 12]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeM() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"MD\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"D\": // day of the month: [1, 31]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeD() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"H\": // 24-hour clock: [0, 23]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeH() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Hm\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Hms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"h\": // 12-hour clock: [1, 12]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeh() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hm\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeh() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeh() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"m\": // minute [0, 59]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodem() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"ms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"mi\": // milliseconds [0, 999]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime3( modifier, new FormatNodemi() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"a\": // am or pm\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodea() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"A\": // AM or PM\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodeA() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\": // seconds: [0, 61]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodes() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"sdt\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(new FormatNodesdt(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime3( modifier, new FormatNodemi() )\n\t\t\t\t\t));\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"z\": // time zone\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodez() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%\": // a % literal\n\t\t\t\t\tnodes.push( new FormatNodeString( \"%\" ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"f\": // fixed point notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodef( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"e\": // exponent notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodee( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"g\": // %f or %e\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeg( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"rd\": // rounded decimal notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoderd() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"d\": // decimal notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoded() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"P\": // percent notation (Multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeP() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"p\": // percent notation (Not multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodep() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"RP\": // percent notation (Multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeRP() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"rp\": // percent notation (Not multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoderp() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"fsi\": // fixed point notation with a SI prefix\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodefsi( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"ssi\": // Step-based fixed point notation with a SI prefix\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodessi( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnodes.push( new FormatNodeString( all ) );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( previousIndex < format.length ) {\n\t\t\t\t\tnodes.push( new FormatNodeString( format.substring( previousIndex, format.length ) ) );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.isDateRequired = isDateRequired;\n\t\tthis.nodes = nodes;\n\t\tthis.date = new Date();\n\t}\n\n\tprotected toModifiedNodeDatetime2( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\":\n\t\t\treturn new FormatNodePadding( 2, \" \", node );\n\t\tcase \"-\":\n\t\t\treturn node;\n\t\tdefault:\n\t\t\treturn new FormatNodePadding( 2, \"0\", node );\n\t\t}\n\t}\n\n\tprotected toModifiedNodeDatetime3( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\":\n\t\t\treturn new FormatNodePadding( 3, \" \", node );\n\t\tcase \"-\":\n\t\t\treturn node;\n\t\tdefault:\n\t\t\treturn new FormatNodePadding( 3, \"0\", node );\n\t\t}\n\t}\n\n\tprotected toModifiedNodeNumber( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\": // space for non-negative numbers\n\t\t\treturn new FormatNodeSpace( node );\n\t\tcase \"+\": // plus sign for non-negative numbers\n\t\t\treturn new FormatNodePlus( node );\n\t\tcase \"(\": // parenthesis for the negative numbers\n\t\t\treturn new FormatNodeParenthesis( node );\n\t\tdefault:\n\t\t\treturn node;\n\t\t}\n\t}\n\n\tformat( target: number, step: number ): string {\n\t\tconst nodes = this.nodes;\n\t\tconst date = this.date;\n\t\tif( this.isDateRequired ) {\n\t\t\tdate.setTime( target );\n\t\t}\n\t\tlet result = \"\";\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tresult += nodes[ i ].format( target, step, date );\n\t\t}\n\t\treturn result;\n\t}\n\n\ttoFunction(): NumberFormatterFunction {\n\t\treturn ( target: number, step: number ): string => {\n\t\t\treturn this.format( target, step );\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NumberFormatter } from \"./number-formatter\";\nimport { NumberFormatterImpl } from \"./number-formatter-impl\";\n\nexport class NumberFormatters {\n\tstatic create( format: string ): NumberFormatter {\n\t\treturn new NumberFormatterImpl( format );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilAlpha {\n\tstatic blend( alphaA: number, alphaB: number, t: number ): number {\n\t\tconst w = Math.max( 0, Math.min( 1, t ) );\n\t\treturn Math.max( 0, Math.min( 1, alphaA * (1 - w) + alphaB * w ) );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { resources } from \"pixi.js\";\n\nexport class SVGResource extends resources.BaseImageResource {\n\treadonly source!: HTMLImageElement;\n\treadonly svg: string;\n\n\tprotected _load: Promise<void> | null = null;\n\n\tconstructor( source: string, options: any ) {\n\t\tsuper( new Image() );\n\t\tthis._width = 0;\n\t\tthis._height = 0;\n\t\tthis.svg = source;\n\n\t\tresources.BaseImageResource.crossOrigin( this.source, this.svg, options && options.crossorigin );\n\n\t\tif( ! options || options.autoLoad !== false ) {\n\t\t\tthis.load();\n\t\t}\n\t}\n\n\tload(): Promise<void> {\n\t\tif( this._load ) {\n\t\t\treturn this._load;\n\t\t}\n\n\t\tthis._load = new Promise(( resolve ): void => {\n\t\t\tconst image: HTMLImageElement = this.source;\n\n\t\t\timage.onerror = ( event ): void => {\n\t\t\t\timage.onerror = null;\n\t\t\t\t(this as any).onError.run( event ); // TODO: Fix PixiJS\n\t\t\t};\n\n\t\t\timage.onload = (): void => {\n\t\t\t\t(this.resize as any)( image.width, image.height ); // TODO: Fix PixiJS\n\t\t\t\tresolve();\n\t\t\t};\n\n\t\t\timage.src = this.svg;\n\t\t});\n\n\t\treturn this._load;\n\t}\n\n\tstatic test( source: unknown, extension: string ) {\n\t\t// url file extension is SVG\n\t\treturn extension === \"svg\"\n\t\t\t// source is SVG data-uri\n\t\t\t|| (typeof source === \"string\" && source.indexOf(\"data:image/svg+xml;base64\") === 0)\n\t\t\t// source is SVG inline\n\t\t\t|| (typeof source === \"string\" && source.indexOf(\"<svg\") === 0);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Rectangle, resources, SCALE_MODES, settings, Texture } from \"pixi.js\";\nimport { SVGResource } from \"../resource/svg-resource\";\nimport { utilToSvgUrl } from \"./util-to-svg-url\";\n\n// PixiJS's SVGResource has a issue on Microsoft Edge.\n// Edge may invoke the HTMLImageElement#onload on an unexpected timing.\n// Thus, PixiJS may lost the `load` event in some situations.\nresources.INSTALLED.push( SVGResource );\n\nexport interface UtilSvgAtlasBuilderBuildOptions {\n\tforce?: boolean;\n\tscaling?: SCALE_MODES;\n}\n\nexport class UtilSvgAtlasBuilder {\n\tprotected _width: number;\n\tprotected _ratio: number;\n\tprotected _margin: number;\n\n\tprotected _frames: { [ name: string ]: Rectangle };\n\tprotected _svg: string;\n\tprotected _nextX: number;\n\tprotected _nextY: number;\n\tprotected _height: number;\n\n\tprotected _built?: { [ name: string ]: Texture };\n\n\tconstructor( width: number, ratio: number, margin: number ) {\n\t\tthis._width = width;\n\t\tthis._ratio = ratio;\n\t\tthis._margin = margin;\n\n\t\tthis._frames = {};\n\t\tthis._svg = \"\";\n\t\tthis._nextX = 0;\n\t\tthis._nextY = 0;\n\t\tthis._height = 0;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget ratio(): number {\n\t\treturn this._ratio;\n\t}\n\n\tget margin(): number {\n\t\treturn this._margin;\n\t}\n\n\tadd( name: string, width: number, height: number, path: string ): boolean {\n\t\tconst frames = this._frames;\n\t\tif( ! ( name in frames ) ) {\n\t\t\t// Position\n\t\t\tconst margin = this._margin;\n\t\t\tlet x = this._nextX;\n\t\t\tlet y = this._nextY;\n\t\t\tif( this._width <= x + width ) {\n\t\t\t\tx = 0;\n\t\t\t\ty = this._nextY + this._height + margin;\n\t\t\t\tthis._height = height;\n\t\t\t\tthis._nextY = y;\n\t\t\t} else {\n\t\t\t\tthis._height = Math.max( this._height, height );\n\t\t\t}\n\t\t\tthis._nextX = x + width + margin;\n\n\t\t\t// Frame\n\t\t\tframes[ name ] = new Rectangle( x, y, width, height );\n\n\t\t\t// Svg\n\t\t\tconst ratio = this._ratio;\n\t\t\tthis._svg += `<g transform=\"translate(${x * ratio},${y * ratio})\">${path}</g>`;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tget mappings(): { [ name: string ]: Texture } {\n\t\treturn this.build();\n\t}\n\n\tbuild( options?: UtilSvgAtlasBuilderBuildOptions ): { [ name: string ]: Texture } {\n\t\tlet built = this._built;\n\t\tif( built == null || (options && options.force) ) {\n\t\t\tconst resolution = settings.RESOLUTION;\n\t\t\tconst width = this._width;\n\t\t\tconst height = Math.pow( 2, Math.ceil( Math.log( this._nextY + this._height ) / Math.LN2 ) );\n\t\t\tconst realWidth = width * resolution;\n\t\t\tconst realHeight = height * resolution;\n\t\t\tconst ratio = this._ratio;\n\t\t\tconst attrWidth = `width=\"${realWidth}\"`;\n\t\t\tconst attrHeight = `height=\"${realHeight}\"`;\n\t\t\tconst attrViewBox = `viewBox=\"0 0 ${width * ratio} ${height * ratio}\"`;\n\t\t\tconst attrXmlns = `xmlns=\"http://www.w3.org/2000/svg\"`;\n\t\t\tconst url = utilToSvgUrl( `<svg ${attrWidth} ${attrHeight} ${attrViewBox} ${attrXmlns}>${this._svg}</svg>` );\n\t\t\tconst scaleMode = (options && options.scaling != null ? options.scaling : SCALE_MODES.NEAREST);\n\t\t\tconst baseTexture = BaseTexture.from( url, {\n\t\t\t\tresolution,\n\t\t\t\tscaleMode\n\t\t\t});\n\t\t\tconst frames = this._frames;\n\t\t\tbuilt = this._built = {};\n\t\t\tfor( const name in frames ) {\n\t\t\t\tbuilt[ name ] = new Texture( baseTexture, frames[ name ] );\n\t\t\t}\n\t\t}\n\t\treturn built;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Rectangle } from \"pixi.js\";\n\nexport interface UtilAttachTarget {\n\treadonly width: number;\n\treadonly height: number;\n\treadonly position: IPoint;\n}\n\nexport enum UtilAttachAlign {\n\tTOP,\n\tLEFT,\n\tRIGHT,\n\tBOTTOM\n}\n\nexport class UtilAttach {\n\tstatic attach(\n\t\ttarget: UtilAttachTarget,\n\t\tbounds: Rectangle,\n\t\toffsetX: number, offsetY: number,\n\t\tclippingWidth: number, clippingHeight: number,\n\t\talign: UtilAttachAlign\n\t): void {\n\t\tconst width = target.width;\n\t\tconst height = target.height;\n\t\tlet x = 0;\n\t\tlet y = 0;\n\t\tswitch( align ) {\n\t\tcase UtilAttachAlign.LEFT:\n\t\t\tx = bounds.left - width - offsetX;\n\t\t\tif( x < 0 ) {\n\t\t\t\tx = bounds.right + offsetX;\n\t\t\t\tif( clippingWidth < x + width ) {\n\t\t\t\t\tx = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\ty = this.adjust( bounds.top, height, clippingHeight );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.TOP:\n\t\t\tx = this.adjust( bounds.left, width, clippingWidth );\n\t\t\ty = bounds.top - height - offsetY;\n\t\t\tif( y < 0 ) {\n\t\t\t\ty = bounds.bottom + offsetY;\n\t\t\t\tif( clippingHeight < y + height ) {\n\t\t\t\t\ty = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.RIGHT:\n\t\t\tx = bounds.right + offsetX;\n\t\t\tif( clippingWidth < x + width ) {\n\t\t\t\tx = bounds.left - width - offsetX;\n\t\t\t\tif( x < 0 ) {\n\t\t\t\t\tx = clippingWidth - width;\n\t\t\t\t}\n\t\t\t}\n\t\t\ty = this.adjust( bounds.top, height, clippingHeight );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.BOTTOM:\n\t\t\tx = this.adjust( bounds.left, width, clippingWidth );\n\t\t\ty = bounds.bottom + offsetY;\n\t\t\tif( clippingHeight < y + height ) {\n\t\t\t\ty = bounds.top - height - offsetY;\n\t\t\t\tif( y < 0 ) {\n\t\t\t\t\ty = clippingHeight - height;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t\ttarget.position.set( x, y );\n\t}\n\n\tstatic adjust( position: number, size: number, clippingSize: number ): number {\n\t\tif( position < 0 ) {\n\t\t\tif( clippingSize < position + size ) {\n\t\t\t\treturn (clippingSize - size) * 0.5;\n\t\t\t} else {\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t} else if( clippingSize < position + size ) {\n\t\t\tif( clippingSize < size ) {\n\t\t\t\treturn (clippingSize - size) * 0.5;\n\t\t\t} else {\n\t\t\t\treturn clippingSize - size;\n\t\t\t}\n\t\t}\n\t\treturn position;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DMouseModifier {\n\tNONE\t\t= 0,\n\tCTRL\t\t= 1,\n\tSHIFT\t\t= 2,\n\tALT\t\t\t= 4,\n\n\tAND\t\t\t= 8,\n\tOR\t\t\t= 16,\n\n\tNOT_NONE\t= CTRL | SHIFT | ALT | OR\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase } from \"../d-base\";\nimport { UtilPointerEvent } from \"./util-pointer-event\";\n\nexport type UtilClickOutsideOnClick = ( e: InteractionEvent ) => void;\n\nexport class UtilClickOutside {\n\tprotected static point = new Point();\n\n\tstatic apply( target: DBase<any, any>, onClick: UtilClickOutsideOnClick ) {\n\t\ttarget.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( e.target === target ) {\n\t\t\t\tconst point = this.point;\n\t\t\t\tpoint.copyFrom( e.data.global );\n\t\t\t\ttarget.toLocal( point, undefined, point, true );\n\t\t\t\tconst x = point.x;\n\t\t\t\tconst y = point.y;\n\t\t\t\tif( x < 0 || y < 0 || target.width < x || target.height < y ) {\n\t\t\t\t\tonClick( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\n\nexport class UtilClipboard extends utils.EventEmitter {\n\tconstructor() {\n\t\tsuper();\n\n\t\tconst element = document.body;\n\t\telement.addEventListener( \"copy\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"copy\", this.toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"cut\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"cut\", this.toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"paste\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"paste\", this.toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\t}\n\n\ttoClipboardData( e: ClipboardEvent ): DataTransfer {\n\t\treturn e.clipboardData || (window as any).clipboardData;\n\t}\n\n\tstatic copy( text: string ): void {\n\t\tif( navigator.clipboard ) {\n\t\t\tnavigator.clipboard.writeText( text );\n\t\t} else {\n\t\t\tconst textArea = document.createElement( \"textarea\" );\n\t\t\ttextArea.value = text;\n\t\t\tdocument.body.appendChild( textArea );\n\t\t\ttextArea.focus();\n\t\t\ttextArea.select();\n\n\t\t\ttry {\n\t\t\t\tdocument.execCommand( \"copy\" );\n\t\t\t} catch ( e ) {\n\t\t\t\t// DO NOTHING\n\t\t\t}\n\n\t\t\tdocument.body.removeChild( textArea );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilDragEasingHistory {\n\tdx: number;\n\tdy: number;\n\tds: number;\n\tdt: number;\n\n\tconstructor( dx: number, dy: number, ds: number, dt: number ) {\n\t\tthis.dx = dx;\n\t\tthis.dy = dy;\n\t\tthis.ds = ds;\n\t\tthis.dt = dt;\n\t}\n\n\tset( dx: number, dy: number, ds: number, dt: number ) {\n\t\tthis.dx = dx;\n\t\tthis.dy = dy;\n\t\tthis.ds = ds;\n\t\tthis.dt = dt;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DAnimationTimings {\n\tstatic LINEAR( t: number ): number {\n\t\treturn t;\n\t}\n\n\tstatic ELASTIC( t: number ): number {\n\t\treturn t * ( 3 * (1 - t) * (1 - t) + t * ( 3 * (1 - t) + t ) );\n\t}\n\n\tstatic QUAD_IN_OUT( t: number ): number {\n\t\treturn t < 0.5 ? 2 * t * t : -1 + ( 4 - 2 * t ) * t;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DAnimation, DAnimationOnEnd, DAnimationOnTime, DAnimationOptions, DAnimationTiming } from \"./d-animation\";\nimport { DAnimationTimings } from \"./d-animation-timings\";\nimport { DBase } from \"./d-base\";\n\nexport class DAnimationBase extends utils.EventEmitter implements DAnimation {\n\tprotected _id: number | null;\n\tprotected _startTime: number;\n\tprotected _duration: number;\n\tprotected _durationInverse: number;\n\tprotected _reverse: boolean;\n\tprotected _onTime: DAnimationOnTime | undefined;\n\tprotected _onTimeBaseBound: () => void;\n\tprotected _onStart: DAnimationOnEnd | undefined;\n\tprotected _onEnd: DAnimationOnEnd | undefined;\n\tprotected _timing: DAnimationTiming;\n\tprotected _target: DBase<any, any> | null;\n\n\tconstructor( options?: DAnimationOptions ) {\n\t\tsuper();\n\n\t\tthis._id = null;\n\t\tthis._target = null;\n\t\tthis._startTime = 0;\n\t\tthis._duration = ( options != null && options.duration != null ? options.duration : 200 );\n\t\tthis._durationInverse = 1 / Math.max( 1, this._duration );\n\t\tthis._reverse = false;\n\t\tthis._onTime = ( options != null ? options.onTime : undefined );\n\t\tthis._onTimeBaseBound = () => {\n\t\t\tthis.onTimeBase();\n\t\t};\n\t\tthis._onStart = ( options != null ? options.onStart : undefined );\n\t\tthis._onEnd = ( options != null ? options.onEnd : undefined );\n\t\tthis._timing = ( options != null && options.timing != null ? options.timing : DAnimationTimings.ELASTIC );\n\t}\n\n\tget target(): DBase<any, any> | null {\n\t\treturn this._target;\n\t}\n\n\tset target( target: DBase<any, any> | null ) {\n\t\tthis._target = target;\n\t}\n\n\tget duration(): number {\n\t\treturn this._duration;\n\t}\n\n\tset duration( duration: number ) {\n\t\tthis._duration = duration;\n\t\tthis._durationInverse = 1 / Math.max( 1, duration );\n\t}\n\n\tstart( reverse: boolean = false ): void {\n\t\tthis.stop();\n\t\tthis._startTime = Date.now();\n\t\tthis._reverse = reverse;\n\t\tthis._id = window.setTimeout( this._onTimeBaseBound, 0 );\n\n\t\t// onStart\n\t\tthis.onStart( reverse );\n\n\t\t// onTime\n\t\tconst duration = this._duration;\n\t\tconst time = this.toTime( reverse ? duration : 0 );\n\t\tthis.onTime( time, reverse, 0 );\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst onStart = this._onStart;\n\t\tif( onStart != null ) {\n\t\t\tonStart( isReverse, this );\n\t\t}\n\t\tthis.emit( \"start\", isReverse, this );\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst onTime = this._onTime;\n\t\tif( onTime != null ) {\n\t\t\tonTime( time, isReverse, elapsedTime, this );\n\t\t}\n\t\tthis.emit( \"time\", time, isReverse, elapsedTime, this );\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst onEnd = this._onEnd;\n\t\tif( onEnd != null ) {\n\t\t\tonEnd( isReverse, this );\n\t\t}\n\t\tthis.emit( \"end\", isReverse, this );\n\t}\n\n\tisStarted(): boolean {\n\t\treturn (this._id != null);\n\t}\n\n\tisReverse(): boolean {\n\t\treturn this._reverse;\n\t}\n\n\tprotected onTimeBase(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst duration = this._duration;\n\t\t\tconst reverse = this._reverse;\n\t\t\tif( elapsedTime < duration ) {\n\t\t\t\tthis._id = window.setTimeout( this._onTimeBaseBound, 0 );\n\n\t\t\t\t// OnTime\n\t\t\t\tconst time = this.toTime( reverse ? duration - elapsedTime : elapsedTime );\n\t\t\t\tthis.onTime( time, reverse, elapsedTime );\n\t\t\t} else {\n\t\t\t\t// OnTime\n\t\t\t\tconst time = this.toTime( reverse ? 0 : duration );\n\t\t\t\tthis.onTime( time, reverse, elapsedTime );\n\n\t\t\t\t// OnEnd\n\t\t\t\tthis.onEnd( reverse );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toTime( elapsedTime: number ): number {\n\t\treturn this._timing( elapsedTime * this._durationInverse, this );\n\t}\n\n\tstop(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\twindow.clearTimeout( id );\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\twindow.clearTimeout( id );\n\n\t\t\t// OnTime\n\t\t\tconst reverse = this._reverse;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst duration = this._duration;\n\t\t\tconst time = this.toTime( reverse ? 0 : duration );\n\t\t\tthis.onTime( time, reverse, elapsedTime );\n\n\t\t\t// OnEnd\n\t\t\tthis.onEnd( reverse );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimation } from \"../d-animation\";\nimport { DAnimationBase } from \"../d-animation-base\";\nimport { DAnimationTimings } from \"../d-animation-timings\";\nimport { UtilDragEasingHistory } from \"./util-drag-easing-history\";\n\nexport interface UtilDragEasingOptions {\n\tduration?: {\n\t\tposition?: number;\n\t\tscale?: number;\n\t};\n\ton: {\n\t\tmove: ( dx: number, dy: number, ds: number, time: number ) => void;\n\t};\n}\n\nexport class UtilDragEasing {\n\tprotected static HISTORY_CAPACITY = 5;\n\tprotected _histories: UtilDragEasingHistory[];\n\tprotected _historiesSorted: UtilDragEasingHistory[];\n\tprotected _historyBegin: number;\n\tprotected _historyEnd: number;\n\tprotected _animation: DAnimation;\n\tprotected _dx: number;\n\tprotected _dy: number;\n\tprotected _dt: number;\n\tprotected _ds: number;\n\tprotected _durationPosition: number;\n\tprotected _durationScale: number;\n\tprotected _onMove: ( dx: number, dy: number, ds: number, time: number ) => void;\n\n\tconstructor( options: UtilDragEasingOptions ) {\n\t\tthis._histories = [];\n\t\tthis._historiesSorted = [];\n\t\tthis._historyBegin = 0;\n\t\tthis._historyEnd = -1;\n\t\tthis._dx = 0;\n\t\tthis._dy = 0;\n\t\tthis._ds = 0;\n\t\tthis._dt = 0;\n\t\tthis._animation = new DAnimationBase({\n\t\t\tonTime: ( t: number ): void => {\n\t\t\t\tthis.onEase( t );\n\t\t\t},\n\t\t\ttiming: DAnimationTimings.LINEAR,\n\t\t\tduration: 1000\n\t\t});\n\t\tconst duration = options && options.duration;\n\t\tif( duration ) {\n\t\t\tthis._durationPosition = ( duration.position != null ? duration.position : 1 );\n\t\t\tthis._durationScale = ( duration.scale != null ? duration.scale : 1 );\n\t\t} else {\n\t\t\tthis._durationPosition = 1;\n\t\t\tthis._durationScale = 1;\n\t\t}\n\t\tthis._onMove = options.on.move;\n\t}\n\n\tonStart(): void {\n\t\t// History\n\t\tconst histories = this._histories;\n\t\tfor( let i = histories.length, imax = UtilDragEasing.HISTORY_CAPACITY; i < imax; ++i ) {\n\t\t\thistories.push( new UtilDragEasingHistory( 0, 0, 1, 0 ) );\n\t\t}\n\t\tthis._historyBegin = 0;\n\t\tthis._historyEnd = -1;\n\n\t\t// Stop animation\n\t\tthis._animation.stop();\n\t}\n\n\tonMove( dx: number, dy: number, ds: number, dt: number ): void {\n\t\tconst capacity = UtilDragEasing.HISTORY_CAPACITY;\n\n\t\tconst oldHistoryEnd = this._historyEnd;\n\t\tconst newHistoryEnd = (oldHistoryEnd + 1) % capacity;\n\t\tthis._historyEnd = newHistoryEnd;\n\n\t\tconst oldHistoryBegin = this._historyBegin;\n\t\tif( newHistoryEnd < oldHistoryEnd || (0 <= oldHistoryEnd && oldHistoryEnd < oldHistoryBegin) ) {\n\t\t\tthis._historyBegin = (oldHistoryBegin + 1) % capacity;\n\t\t}\n\n\t\tthis._histories[ newHistoryEnd ].set( dx, dy, ds, dt );\n\t}\n\n\tprotected updateHistoriesSorted( dt: number ): number {\n\t\tconst unsorted = this._histories;\n\t\tconst sorted = this._historiesSorted;\n\t\tconst begin = this._historyBegin;\n\t\tconst end = this._historyEnd;\n\t\tconst length = unsorted.length;\n\t\tconst threshold = 160;\n\t\tif( end < 0 ) {\n\t\t\tsorted.length = 0;\n\t\t\treturn dt;\n\t\t} else if( end < begin ) {\n\t\t\tlet total = dt;\n\t\t\tsorted.length = 0;\n\t\t\tfor( let i = end; 0 <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let i = length - 1; begin <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn total;\n\t\t} else {\n\t\t\tlet total = dt;\n\t\t\tsorted.length = 0;\n\t\t\tfor( let i = end; begin <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn total;\n\t\t}\n\t}\n\n\tonEnd( ldt: number ): void {\n\t\tconst adt = this.updateHistoriesSorted( ldt );\n\t\tconst sorted = this._historiesSorted;\n\t\tconst sortedLength = sorted.length;\n\t\tif( 0 < sortedLength ) {\n\t\t\tlet dx = 0;\n\t\t\tlet dy = 0;\n\t\t\tlet ds = 0;\n\t\t\tlet dt = 0;\n\t\t\tfor( let i = 0; i < sortedLength; ++i ) {\n\t\t\t\tconst history = sorted[ i ];\n\t\t\t\tdx += history.dx;\n\t\t\t\tdy += history.dy;\n\t\t\t\tds += history.ds;\n\t\t\t\tdt += history.dt;\n\t\t\t}\n\t\t\tconst w = (1 - ldt / adt) / sortedLength;\n\t\t\tdx *= w;\n\t\t\tdy *= w;\n\t\t\tds = 1 + (ds - sortedLength) * w;\n\t\t\tdt *= w;\n\t\t\tthis._dx = dx;\n\t\t\tthis._dy = dy;\n\t\t\tthis._ds = ds;\n\t\t\tthis._dt = dt;\n\n\t\t\t// Start animation\n\t\t\tconst d0 = this._durationPosition * 40 * Math.sqrt( dx * dx + dy * dy );\n\t\t\tconst d1 = this._durationScale * 10000 * Math.abs( ds - 1 );\n\t\t\tconst animation = this._animation;\n\t\t\tanimation.duration = Math.max( d0, d1 );\n\t\t\tanimation.start();\n\t\t}\n\t}\n\n\tprotected onEase( time: number ): void {\n\t\tconst w = 1 - time;\n\t\tthis._onMove(\n\t\t\tthis._dx * w,\n\t\t\tthis._dy * w,\n\t\t\t1 + ( this._ds - 1 ) * w,\n\t\t\ttime\n\t\t);\n\t}\n\n\tstop(): void {\n\t\tthis._animation.stop();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\n\nexport type DMouseModifierEvent = WheelEvent | MouseEvent | TouchEvent | interaction.InteractionEvent;\n\nexport class DMouseModifiers {\n\tstatic from( e: DMouseModifierEvent ): DMouseModifier {\n\t\tconst oe = ( \"data\" in e ? e.data.originalEvent : e );\n\t\treturn ( oe.ctrlKey ? DMouseModifier.CTRL : DMouseModifier.NONE ) |\n\t\t\t( oe.altKey ? DMouseModifier.ALT : DMouseModifier.NONE ) |\n\t\t\t( oe.shiftKey ? DMouseModifier.SHIFT : DMouseModifier.NONE );\n\t}\n\n\tstatic match( e: DMouseModifierEvent, modifier: DMouseModifier ): boolean {\n\t\tif( modifier & DMouseModifier.OR ) {\n\t\t\treturn !! (this.from( e ) & modifier);\n\t\t} else {\n\t\t\treturn this.from( e ) === modifier;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../d-applications\";\n\nexport enum UtilFileAs {\n\tTEXT,\n\tDATA_URL,\n\tBINARY_STRING,\n\tARRAY_BUTTER\n}\n\nexport interface UtilFileFacade {\n\temit( name: string, ...args: any[] ): void;\n}\n\nexport class UtilFileOpener {\n\tprotected _input: HTMLInputElement | null;\n\tprotected _as: UtilFileAs;\n\tprotected _facade: UtilFileFacade;\n\n\tconstructor( as: UtilFileAs, facade: UtilFileFacade ) {\n\t\tthis._input = null;\n\t\tthis._as = as;\n\t\tthis._facade = facade;\n\t}\n\n\topen() {\n\t\tconst input = this.getOrCreateInput();\n\t\tif( input != null ) {\n\t\t\tinput.click();\n\t\t} else {\n\t\t\tthis.onCancel();\n\t\t}\n\t}\n\n\tprotected getOrCreateInput(): HTMLInputElement | null {\n\t\tif( \"FileReader\" in window && this._input == null ) {\n\t\t\tconst input = this._input = document.createElement( \"input\" );\n\t\t\tinput.setAttribute( \"type\", \"file\" );\n\t\t\tinput.setAttribute( \"style\", \"display:none\" );\n\t\t\tinput.addEventListener( \"change\", ( e: Event ): void => {\n\t\t\t\tthis.onInputChange( input );\n\t\t\t\tinput.value = \"\";\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t\tDApplications.getInstance().view.appendChild( input );\n\t\t}\n\t\treturn this._input;\n\t}\n\n\tprotected onInputChange( input: HTMLInputElement ) {\n\t\tconst files = input.files;\n\t\tif( files != null && 0 < files.length ) {\n\t\t\tconst file = files[ 0 ];\n\t\t\tconst fileReader = new FileReader();\n\t\t\tfileReader.onload = ( e: ProgressEvent ) => {\n\t\t\t\tif( e.target != null ) {\n\t\t\t\t\tconst target = e.target as any;\n\t\t\t\t\tthis.onOpen( target.result );\n\t\t\t\t}\n\t\t\t};\n\t\t\tfileReader.onabort = ( e: ProgressEvent ) => {\n\t\t\t\tthis.onAboart( e );\n\t\t\t};\n\t\t\tswitch( this._as ) {\n\t\t\tcase UtilFileAs.TEXT:\n\t\t\t\tfileReader.readAsText( file );\n\t\t\t\tbreak;\n\t\t\tcase UtilFileAs.DATA_URL:\n\t\t\t\tfileReader.readAsDataURL( file );\n\t\t\t\tbreak;\n\t\t\tcase UtilFileAs.BINARY_STRING:\n\t\t\t\tfileReader.readAsBinaryString( file );\n\t\t\t\tbreak;\n\t\t\tcase UtilFileAs.ARRAY_BUTTER:\n\t\t\t\tfileReader.readAsArrayBuffer( file );\n\t\t\t\tbreak;\n\t\t\tdefault:\n\t\t\t\tfileReader.readAsText( file );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t} else {\n\t\t\tthis.onCancel();\n\t\t}\n\t}\n\n\tprotected onOpen( result: unknown ): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"open\", result, facade );\n\t}\n\n\tprotected onAboart( e: ProgressEvent ): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"abort\", e, facade );\n\t}\n\n\tprotected onCancel(): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"cancel\", facade );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { DMouseModifier } from \"../d-mouse-modifier\";\nimport { DMouseModifiers } from \"../d-mouse-modifiers\";\nimport { UtilDragEasing, UtilDragEasingOptions } from \"./util-drag-easing\";\nimport { utilIsNumber } from \"./util-is-number\";\nimport { UtilPointerEvent } from \"./util-pointer-event\";\n\nexport type UtilDragOnMove = ( dx: number, dy: number, x: number, y: number, ds: number ) => void;\nexport type UtilDragOnStart = () => void;\nexport type UtilDragOnEnd = () => void;\n\ninterface UtilDragOptionsEasingDuration {\n\tduration?: number | {\n\t\tposition?: number,\n\t\tscale?: number\n\t};\n}\n\nexport interface UtilDragOptions {\n\ttarget: DBase;\n\ttouch?: boolean;\n\tmodifier?: DMouseModifier;\n\teasing?: boolean | UtilDragOptionsEasingDuration;\n\ton?: {\n\t\tstart?: UtilDragOnStart;\n\t\tmove?: UtilDragOnMove;\n\t\tend?: UtilDragOnEnd;\n\t};\n}\n\nconst toEasingOptions = (\n\toptions: true | UtilDragOptionsEasingDuration | undefined,\n\tonMove: ( dx: number, dy: number, ds: number, time: number ) => void\n): UtilDragEasingOptions => {\n\tif( options == null || options === true ) {\n\t\treturn {\n\t\t\ton: {\n\t\t\t\tmove: onMove\n\t\t\t}\n\t\t};\n\t} else {\n\t\tconst duration = options.duration;\n\t\tif( utilIsNumber( duration ) ) {\n\t\t\treturn {\n\t\t\t\tduration: {\n\t\t\t\t\tposition: duration,\n\t\t\t\t\tscale: duration\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tmove: onMove\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tduration,\n\t\t\t\ton: {\n\t\t\t\t\tmove: onMove\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n};\n\nexport class UtilDrag {\n\tprotected static EPSILON = 0.00001;\n\tprotected _target: DBase<any, any>;\n\tprotected _onDownBound: ( e: InteractionEvent ) => void;\n\tprotected _onMoveBound: ( e: InteractionEvent ) => void;\n\tprotected _onEndBound: ( e: InteractionEvent ) => void;\n\tprotected _onStart?: UtilDragOnStart;\n\tprotected _onMove?: UtilDragOnMove;\n\tprotected _onEnd?: UtilDragOnEnd;\n\tprotected _down: string;\n\tprotected _move: string;\n\tprotected _up: string;\n\tprotected _easing?: UtilDragEasing;\n\tprotected _modifier: DMouseModifier;\n\tprotected _interactionManager: interaction.InteractionManager;\n\tprotected _center: Point;\n\tprotected _scale: number;\n\tprotected _scalingCenter: Point;\n\tprotected _time: number;\n\n\tconstructor( options: UtilDragOptions ) {\n\t\tconst target = this._target = options.target;\n\t\tconst on = options.on;\n\t\tif( on ) {\n\t\t\tthis._onStart = on.start;\n\t\t\tthis._onMove = on.move;\n\t\t\tthis._onEnd = on.end;\n\t\t}\n\t\tthis._modifier = options && options.modifier || DMouseModifier.NONE;\n\t\tthis._interactionManager = DApplications.getInstance().renderer.plugins.interaction;\n\t\tthis._center = new Point();\n\t\tthis._scale = 1;\n\t\tthis._scalingCenter = new Point();\n\t\tthis._time = 0;\n\n\t\tconst easing = options.easing;\n\t\tif( easing == null || easing !== false ) {\n\t\t\tconst onEasingMoveBound = ( dx: number, dy: number, ds: number, time: number ): void => {\n\t\t\t\tthis.onEasingMove( dx, dy, ds, time );\n\t\t\t};\n\t\t\tthis._easing = new UtilDragEasing( toEasingOptions( easing, onEasingMoveBound ) );\n\t\t}\n\n\t\tthis._onDownBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onDown( e );\n\t\t};\n\n\t\tthis._onMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMove( e );\n\t\t};\n\n\t\tthis._onEndBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onEnd( e );\n\t\t};\n\n\t\tif( options.touch ) {\n\t\t\tthis._down = \"touchstart\";\n\t\t\tthis._move = \"touchmove\";\n\t\t\tthis._up = \"touchend\";\n\t\t} else {\n\t\t\tthis._down = UtilPointerEvent.down;\n\t\t\tthis._move = UtilPointerEvent.move;\n\t\t\tthis._up = UtilPointerEvent.up;\n\t\t}\n\n\t\ttarget.on( this._down, this._onDownBound );\n\t}\n\n\tprotected calcCenterAndScale( e: InteractionEvent, center: Point ): number {\n\t\tconst oe = e.data.originalEvent;\n\t\tconst global = e.data.global;\n\t\tif( \"touches\" in oe ) {\n\t\t\tconst touches = oe.touches;\n\t\t\tconst touchesLength = touches.length;\n\t\t\tif( 0 < touchesLength ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst first = touches[ 0 ];\n\t\t\t\tlet centerX = first.clientX;\n\t\t\t\tlet centerY = first.clientY;\n\t\t\t\tfor( let i = 1, imax = touches.length; i < imax; ++i ) {\n\t\t\t\t\tconst touch = touches[ i ];\n\t\t\t\t\tcenterX += touch.clientX;\n\t\t\t\t\tcenterY += touch.clientY;\n\t\t\t\t}\n\t\t\t\tcenterX /= touchesLength;\n\t\t\t\tcenterY /= touchesLength;\n\t\t\t\tthis._interactionManager.mapPositionToPoint( center, centerX, centerY );\n\n\t\t\t\tif( 1 < touchesLength ) {\n\t\t\t\t\t// Calculate the maximum distance from the center\n\t\t\t\t\tlet squareDistance = 0;\n\t\t\t\t\tfor( let i = 1, imax = touches.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst touch = touches[ i ];\n\t\t\t\t\t\tconst dx = touch.clientX - centerX;\n\t\t\t\t\t\tconst dy = touch.clientY - centerY;\n\t\t\t\t\t\tsquareDistance = Math.max( squareDistance, dx * dx + dy * dy );\n\t\t\t\t\t}\n\t\t\t\t\treturn Math.sqrt( squareDistance );\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcenter.copyFrom( global );\n\t\treturn 0;\n\t}\n\n\tprotected onDown( e: InteractionEvent ): void {\n\t\tif( DMouseModifiers.match( e, this._modifier ) ) {\n\t\t\te.stopPropagation();\n\n\t\t\t// Update the center\n\t\t\tconst center = this._center;\n\t\t\tthis._scale = this.calcCenterAndScale( e, center );\n\n\t\t\t//\n\t\t\tconst target = this._target;\n\t\t\tif( ! target.isDragging() ) {\n\t\t\t\ttarget.setDragging( true );\n\n\t\t\t\t//\n\t\t\t\tthis._time = e.data.originalEvent.timeStamp;\n\n\t\t\t\t// Easing util\n\t\t\t\tconst easing = this._easing;\n\t\t\t\tif( easing ) {\n\t\t\t\t\teasing.onStart();\n\t\t\t\t}\n\n\t\t\t\t// User-defined handler\n\t\t\t\tconst onStart = this._onStart;\n\t\t\t\tif( onStart != null ) {\n\t\t\t\t\tonStart();\n\t\t\t\t}\n\n\t\t\t\t// Event handler\n\t\t\t\tconst interactionManager = this._interactionManager;\n\t\t\t\tinteractionManager.on( this._move, this._onMoveBound );\n\t\t\t\tinteractionManager.on( this._up, this._onEndBound );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onMove( e: InteractionEvent ): void {\n\t\tif( DMouseModifiers.match( e, this._modifier ) ) {\n\t\t\tconst target = this._target;\n\t\t\tif( target.isDragging() ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst center = this._center;\n\t\t\t\tconst centerX = center.x;\n\t\t\t\tconst centerY = center.y;\n\t\t\t\tconst newScale = this.calcCenterAndScale( e, center );\n\t\t\t\tconst oldScale = this._scale;\n\t\t\t\tthis._scale = newScale;\n\t\t\t\tconst oldTime = this._time;\n\t\t\t\tconst newTime = e.data.originalEvent.timeStamp;\n\t\t\t\tthis._time = newTime;\n\n\t\t\t\t// Calculate the position\n\t\t\t\tconst dx = center.x - centerX;\n\t\t\t\tconst dy = center.y - centerY;\n\t\t\t\tconst dt = newTime - oldTime;\n\t\t\t\tconst ds = ( UtilDrag.EPSILON < oldScale ? newScale / oldScale : 1 );\n\n\t\t\t\t// Easing util\n\t\t\t\tconst easing = this._easing;\n\t\t\t\tif( easing ) {\n\t\t\t\t\teasing.onMove( dx, dy, ds, dt );\n\t\t\t\t}\n\n\t\t\t\t// User-defined handler\n\t\t\t\tconst onMove = this._onMove;\n\t\t\t\tif( onMove != null ) {\n\t\t\t\t\tif( dx !== 0 || dy !== 0 || ds !== 1 ) {\n\t\t\t\t\t\tonMove( dx, dy, center.x, center.y, ds );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEnd( e: InteractionEvent ): void {\n\t\tconst target = this._target;\n\t\tif( target.isDragging() ) {\n\t\t\t// Update the center\n\t\t\tconst center = this._center;\n\t\t\tthis._scalingCenter.copyFrom( center );\n\t\t\tthis._scale = this.calcCenterAndScale( e, center );\n\n\t\t\t// Finalize\n\t\t\tconst oe = e.data.originalEvent;\n\t\t\tif( \"touches\" in oe ? oe.touches.length <= 0 : true ) {\n\t\t\t\ttarget.setDragging( false );\n\n\t\t\t\t// Event handler\n\t\t\t\tconst interactionManager = this._interactionManager;\n\t\t\t\tinteractionManager.off( this._move, this._onMoveBound );\n\t\t\t\tinteractionManager.off( this._up, this._onEndBound );\n\n\t\t\t\t// User-defined handler\n\t\t\t\tconst onEnd = this._onEnd;\n\t\t\t\tif( onEnd != null ) {\n\t\t\t\t\tonEnd();\n\t\t\t\t}\n\n\t\t\t\t// Easing util\n\t\t\t\tconst easing = this._easing;\n\t\t\t\tif( easing ) {\n\t\t\t\t\teasing.onEnd( e.data.originalEvent.timeStamp - this._time );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEasingMove( dx: number, dy: number, ds: number, time: number ): void {\n\t\tconst onMove = this._onMove;\n\t\tif( onMove != null ) {\n\t\t\tif( dx !== 0 || dy !== 0 || ds !== 1 ) {\n\t\t\t\tconst scalingCenter = this._scalingCenter;\n\t\t\t\tscalingCenter.set(\n\t\t\t\t\tscalingCenter.x + dx,\n\t\t\t\t\tscalingCenter.y + dy\n\t\t\t\t);\n\t\t\t\tonMove( dx, dy, scalingCenter.x, scalingCenter.y, ds );\n\t\t\t}\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tconst easing = this._easing;\n\t\tif( easing ) {\n\t\t\teasing.stop();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { UtilExtractorPixels } from \"./util-extractor-pixels\";\n\nexport class UtilExtractor {\n\tstatic toTexture(\n\t\ttarget: DBase, resolution?: number,\n\t\tclear?: boolean, skipUpdateTransform?: boolean\n\t): PIXI.RenderTexture {\n\t\tconst result = PIXI.RenderTexture.create({\n\t\t\twidth: target.width,\n\t\t\theight: target.height,\n\t\t\tscaleMode: PIXI.SCALE_MODES.LINEAR,\n\t\t\tresolution\n\t\t});\n\t\tconst matrix = new PIXI.Matrix(\n\t\t\tundefined, undefined, undefined, undefined,\n\t\t\t-target.position.x, -target.position.y\n\t\t);\n\t\tDApplications.getInstance().renderer.render( target, result, clear, matrix, skipUpdateTransform );\n\t\treturn result;\n\t}\n\n\tstatic toPixels( renderTexture: PIXI.RenderTexture ): UtilExtractorPixels {\n\t\tconst resolution = renderTexture.resolution;\n\t\tconst frame = renderTexture.frame;\n\t\tconst width = Math.floor( frame.width * resolution );\n\t\tconst height = Math.floor( frame.height * resolution );\n\t\tconst pixels = new Uint8Array( 4 * width * height );\n\n\t\tconst renderer = DApplications.getInstance().renderer;\n\t\trenderer.renderTexture.bind( renderTexture );\n\t\tconst gl = (renderer as any).gl;\n\t\tgl.readPixels(\n\t\t\tframe.x * resolution,\n\t\t\tframe.y * resolution,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tgl.RGBA,\n\t\t\tgl.UNSIGNED_BYTE,\n\t\t\tpixels\n\t\t);\n\n\t\treturn {\n\t\t\twidth,\n\t\t\theight,\n\t\t\tarray: pixels\n\t\t};\n\t}\n\n\tstatic toCanvas( pixels: UtilExtractorPixels, scale?: number, ignorePremutipliedAlpha?: boolean ): HTMLCanvasElement {\n\t\tconst width = pixels.width;\n\t\tconst height = pixels.height;\n\t\tconst array = pixels.array;\n\t\tconst canvasRenderTarget = new PIXI.utils.CanvasRenderTarget( width, height, 1 );\n\n\t\tconst imageData = canvasRenderTarget.context.getImageData( 0, 0, width, height );\n\t\tif( ignorePremutipliedAlpha ) {\n\t\t\timageData.data.set( array );\n\t\t} else {\n\t\t\t(PIXI.extract.Extract as any).arrayPostDivide( array, imageData.data );\n\t\t}\n\t\tcanvasRenderTarget.context.putImageData( imageData, 0, 0 );\n\n\t\t// Scale down\n\t\tif( scale != null && scale !== 1 ) {\n\t\t\tcanvasRenderTarget.context.scale( scale, scale );\n\t\t\tcanvasRenderTarget.context.drawImage( canvasRenderTarget.canvas, 0, 0 );\n\t\t\tconst scaledWidth = Math.floor( width * scale );\n\t\t\tconst scaledHeight = Math.floor( height * scale );\n\t\t\tconst scaledImageData = canvasRenderTarget.context.getImageData( 0, 0, scaledWidth, scaledHeight );\n\t\t\tcanvasRenderTarget.resize( scaledWidth, scaledHeight );\n\t\t\tcanvasRenderTarget.context.putImageData( scaledImageData, 0, 0 );\n\t\t}\n\n\t\treturn canvasRenderTarget.canvas;\n\t}\n\n\tstatic toBase64( canvas: HTMLCanvasElement, format?: string, quality?: number ): string {\n\t\treturn canvas.toDataURL( format, quality );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilFileDownloader {\n\tstatic downloadUrl( filename: string, url: string ): void {\n\t\tconst a = document.createElement( \"a\" );\n\t\ta.href = url;\n\t\ta.download = filename;\n\t\ta.style.display = \"none\";\n\t\tdocument.body.appendChild( a );\n\t\ta.click();\n\t\tsetTimeout((): void => {\n\t\t\tdocument.body.removeChild( a );\n\t\t}, 100);\n\t}\n\n\tstatic download( filename: string, contents: string ): void {\n\t\tconst blob = new Blob(\n\t\t\t[ contents ],\n\t\t\t{ type: \"text/plain\" }\n\t\t);\n\t\tif( window.navigator.msSaveBlob ) {\n\t\t\twindow.navigator.msSaveBlob( blob, filename );\n\t\t} else {\n\t\t\tthis.downloadUrl( filename, URL.createObjectURL( blob ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\nimport { UtilExtractor } from \"./util-extractor\";\nimport { UtilExtractorPixels } from \"./util-extractor-pixels\";\nimport { UtilFileDownloader } from \"./util-file-downloader\";\nimport { utilIsNumber } from \"./util-is-number\";\n\nexport interface UtilExtractTextureOptions {\n\ttarget: DBase;\n\tresolution?: number | {\n\t\tsize: number;\n\t};\n\ttransform?: {\n\t\tupdate?: boolean;\n\t};\n\tclear?: boolean;\n}\n\nexport interface UtilExtractPixelsOptions extends UtilExtractTextureOptions {\n\n}\n\nexport interface UtilExtractCanvasOptions extends UtilExtractPixelsOptions {\n\tscale?: number | {\n\t\tsize: number;\n\t};\n\talpha?: {\n\t\tpremultiplied?: {\n\t\t\tignore?: boolean;\n\t\t}\n\t};\n}\n\nexport interface UtilExtractBase64Options extends UtilExtractCanvasOptions {\n\tformat?: string;\n\tquality?: number;\n}\n\nexport interface UtilExtractFileOptions extends UtilExtractBase64Options {\n\tfilename: string;\n}\n\nconst toSkipUpdateTransform = ( options: UtilExtractTextureOptions ): boolean | undefined => {\n\treturn options.transform && options.transform.update;\n};\n\nconst toResolution = ( options: UtilExtractTextureOptions ): number => {\n\tconst target = options.target;\n\treturn ( options.resolution != null ?\n\t\t( utilIsNumber( options.resolution ) ?\n\t\t\toptions.resolution :\n\t\t\tMath.min( 1, options.resolution.size / Math.max( target.width, target.height ) )\n\t\t) : PIXI.settings.RESOLUTION\n\t);\n};\n\nconst toIgnorePremultipliedAlpha = ( options: UtilExtractCanvasOptions ): boolean | undefined => {\n\treturn ( options.alpha && options.alpha.premultiplied && options.alpha.premultiplied.ignore );\n};\n\nconst toScale = ( pixels: UtilExtractorPixels, options: UtilExtractCanvasOptions ): number | undefined => {\n\tif( options.scale != null ) {\n\t\tif( utilIsNumber( options.scale ) ) {\n\t\t\treturn options.scale;\n\t\t} else {\n\t\t\tconst size = options.scale.size;\n\t\t\treturn Math.min( 1, size / pixels.width, size / pixels.height );\n\t\t}\n\t}\n};\n\nexport class UtilExtract {\n\tstatic texture( options: UtilExtractTextureOptions ): PIXI.RenderTexture {\n\t\tconst target = options.target;\n\t\tconst resolution = toResolution( options );\n\t\tconst skipUpdateTransform = toSkipUpdateTransform( options );\n\t\treturn UtilExtractor.toTexture( target, resolution, options.clear, skipUpdateTransform );\n\t}\n\n\tstatic pixels( options: UtilExtractPixelsOptions ): UtilExtractorPixels {\n\t\treturn UtilExtractor.toPixels( this.texture( options ) );\n\t}\n\n\tstatic canvas( options: UtilExtractCanvasOptions ): HTMLCanvasElement {\n\t\tconst pixels = this.pixels( options );\n\t\tconst ignorePremutipliedAlpha = toIgnorePremultipliedAlpha( options );\n\t\tconst scale = toScale( pixels, options );\n\t\treturn UtilExtractor.toCanvas( pixels, scale, ignorePremutipliedAlpha );\n\t}\n\n\tstatic base64( options: UtilExtractBase64Options ): string {\n\t\treturn UtilExtractor.toBase64( this.canvas( options ), options.format, options.quality );\n\t}\n\n\tstatic file( options: UtilExtractFileOptions ): void {\n\t\tUtilFileDownloader.downloadUrl( options.filename, this.base64( options ) );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { Closeable } from \"./d-menu-context\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\nimport { DMenus } from \"./d-menus\";\nimport { UtilClipboard } from \"./util\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport type DMenuItemLinkLinkMaker = ( item: DMenuItemLink ) => string | null | Promise<string | null>;\nexport type DMenuItemLinkChecker = ( item: DMenuItemLink ) => boolean | Promise<boolean>;\n\nexport enum DMenuItemLinkMenuItemId {\n\tOPEN_LINK_IN_NEW_WINDOW,\n\tCOPY_LINK_ADDRESS\n}\n\nexport enum DMenuItemLinkTarget {\n\tAUTO,\n\tTHIS_WINDOW,\n\tNEW_WINDOW\n}\n\nexport interface DMenuItemLinkOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink\n> extends DMenuItemTextOptions<VALUE, THEME> {\n\tlink: string | DMenuItemLinkLinkMaker;\n\ttarget?: DMenuItemLinkTarget;\n\tchecker?: DMenuItemLinkChecker;\n\tmenu?: DMenuOptions<DMenuItemLinkMenuItemId> | DMenu<DMenuItemLinkMenuItemId>;\n}\n\nexport interface DThemeMenuItemLink extends DThemeMenuItemText {\n\tgetMenuOptions(): DMenuOptions<DMenuItemLinkMenuItemId>;\n}\n\nexport class DMenuItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected _link: string | DMenuItemLinkLinkMaker;\n\tprotected _target?: DMenuItemLinkTarget;\n\tprotected _checker?: DMenuItemLinkChecker;\n\tprotected _menu?: DMenu<DMenuItemLinkMenuItemId>;\n\tprotected _menuOptions?: DMenuOptions<DMenuItemLinkMenuItemId> | DMenu<DMenuItemLinkMenuItemId>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._link = options.link;\n\t\tthis._target = options.target;\n\t\tthis._checker = options.checker;\n\t\tthis._menuOptions = options.menu;\n\t}\n\n\tprotected init( options: OPTIONS ): void {\n\t\tif( options.target === DMenuItemLinkTarget.NEW_WINDOW ) {\n\t\t\toptions.state = ( options.state || DBaseState.NONE ) || DBaseState.EXTENSION_0;\n\t\t}\n\t\tsuper.init( options );\n\t}\n\n\tget link(): string | null | Promise<string | null> {\n\t\tconst link = this._link;\n\t\tif( utilIsString( link ) || link == null ) {\n\t\t\treturn link;\n\t\t} else {\n\t\t\treturn link( this );\n\t\t}\n\t}\n\n\tget menu(): DMenu<DMenuItemLinkMenuItemId> {\n\t\tlet menu = this._menu;\n\t\tif( menu == null ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst options = this._menuOptions || theme.getMenuOptions();\n\t\t\tmenu = this.toMenu( options );\n\t\t\tthis._menu = menu;\n\t\t\tmenu.on( \"select\", (\n\t\t\t\tvalue: DMenuItemLinkMenuItemId,\n\t\t\t\titem: DMenuItem<DMenuItemLinkMenuItemId>,\n\t\t\t\tcloseable: Closeable\n\t\t\t): void => {\n\t\t\t\tthis.onMenuSelect( value, item, closeable );\n\t\t\t});\n\t\t}\n\t\treturn menu;\n\t}\n\n\tprotected toMenu(\n\t\toptions: DMenuOptions<DMenuItemLinkMenuItemId> | DMenu<DMenuItemLinkMenuItemId>\n\t): DMenu<DMenuItemLinkMenuItemId> {\n\t\tif( options instanceof DisplayObject ) {\n\t\t\treturn options;\n\t\t}\n\t\treturn this.newMenu( options );\n\t}\n\n\tprotected newMenu( options: DMenuOptions<DMenuItemLinkMenuItemId> ): DMenu<DMenuItemLinkMenuItemId> {\n\t\treturn DMenus.newMenu( options );\n\t}\n\n\tprotected onMenuSelect(\n\t\tvalue: DMenuItemLinkMenuItemId,\n\t\titem: DMenuItem<DMenuItemLinkMenuItemId>,\n\t\tcloseable: Closeable\n\t): void {\n\t\tswitch( value ) {\n\t\tcase DMenuItemLinkMenuItemId.OPEN_LINK_IN_NEW_WINDOW:\n\t\t\tthis.open( true );\n\t\t\tbreak;\n\t\tcase DMenuItemLinkMenuItemId.COPY_LINK_ADDRESS:\n\t\t\tconst link = this.link;\n\t\t\tif( link != null ) {\n\t\t\t\tif( utilIsString( link ) ) {\n\t\t\t\t\tthis.copy( link );\n\t\t\t\t} else {\n\t\t\t\t\tlink.then(( resolved: string | null ): void => {\n\t\t\t\t\t\tif( resolved != null ) {\n\t\t\t\t\t\t\tthis.copy( resolved );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected copy( link: string ): void {\n\t\tconst a = document.createElement( \"a\" );\n\t\ta.href = link;\n\t\tUtilClipboard.copy( a.href );\n\t}\n\n\tprotected initOnClick( options?: OPTIONS ): void {\n\t\tconst onClick = ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t};\n\t\tconst onLongClick = ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tconst menu = this.menu;\n\t\t\t\tif( menu.isHidden() ) {\n\t\t\t\t\tmenu.open( this );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tconst target = options && options.target;\n\t\tif( target === DMenuItemLinkTarget.NEW_WINDOW ) {\n\t\t\tUtilPointerEvent.onClick( this, onClick );\n\t\t} else {\n\t\t\tUtilPointerEvent.onLongClick( this, onClick, onLongClick );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemLink\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tsuper.onSelect( e );\n\t\tthis.open( this.inNewWindow( e ) );\n\t}\n\n\topen( inNewWindow: boolean ): void {\n\t\tconst link = this.link;\n\t\tif( link != null ) {\n\t\t\tif( utilIsString( link )  ) {\n\t\t\t\tthis.check( link, inNewWindow );\n\t\t\t} else {\n\t\t\t\tlink.then(( resolved: string | null ): void => {\n\t\t\t\t\tif( resolved ) {\n\t\t\t\t\t\tthis.check( resolved, inNewWindow );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected check( link: string, inNewWindow: boolean ): void {\n\t\tconst checker = this._checker;\n\t\tif( checker ) {\n\t\t\tconst checked = checker( this );\n\t\t\tif( checked === true ) {\n\t\t\t\tthis.exec( link, inNewWindow );\n\t\t\t} else if( checked === false ) {\n\t\t\t\t// DO NOTHING\n\t\t\t} else {\n\t\t\t\tchecked.then(( resolved: boolean ): void => {\n\t\t\t\t\tif( resolved ) {\n\t\t\t\t\t\tthis.exec( link, inNewWindow );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tthis.exec( link, inNewWindow );\n\t\t}\n\t}\n\n\tprotected exec( link: string, inNewWindow: boolean ): void {\n\t\tif( inNewWindow ) {\n\t\t\tconst a = document.createElement( \"a\" );\n\t\t\ta.href = link;\n\t\t\ta.target = \"_blank\";\n\t\t\ta.style.display = \"none\";\n\t\t\ta.rel = \"noopener noreferrer\";\n\t\t\tdocument.body.appendChild( a );\n\t\t\ta.click();\n\t\t\tsetTimeout((): void => {\n\t\t\t\tdocument.body.removeChild( a );\n\t\t\t}, 100);\n\t\t} else {\n\t\t\twindow.location.href = link;\n\t\t}\n\t}\n\n\tprotected inNewWindow( e: KeyboardEvent | interaction.InteractionEvent ): boolean {\n\t\tif( this._target === DMenuItemLinkTarget.NEW_WINDOW ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\tconst oe = ( e instanceof interaction.InteractionEvent ? e.data.originalEvent : e );\n\t\t\treturn (\n\t\t\t\t( oe.ctrlKey || oe.shiftKey || oe.altKey || oe.metaKey ) ||\n\t\t\t\t( \"button\" in oe && oe.button !== 0 )\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ) {\n\t\tsuper.onShortcut( e );\n\t\tthis.onSelect( e );\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemLinkOptions<VALUE> {\n\t\treturn \"link\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilHsv {\n\tstatic fromRgb( color: number ): [ number, number, number ] {\n\t\tconst r = (color & 0xff0000) >> 16;\n\t\tconst g = (color & 0x00ff00) >> 8;\n\t\tconst b = (color & 0x0000ff) | 0;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\t\tconst length = max - min;\n\t\tlet h = 0;\n\t\tif( 0 < length ) {\n\t\t\tif( r === max ) {\n\t\t\t\th = 60 * ( g - b ) / length;\n\t\t\t} else if( g === max ) {\n\t\t\t\th = 60 * ( b - r ) / length + 120;\n\t\t\t} else if( b === max ) {\n\t\t\t\th = 60 * ( r - g ) / length + 240;\n\t\t\t}\n\t\t\tif( h < 0 ) {\n\t\t\t\th += 360;\n\t\t\t}\n\t\t}\n\n\t\tconst s = ( length / max ) * 255;\n\t\tconst v = max;\n\t\treturn [ h, s, v ];\n\t}\n\n\tstatic toRgb( h: number, s: number, v: number ): number {\n\t\tconst max = v;\n\t\tconst min = v - (s / 255) * v;\n\t\tconst length = max - min;\n\n\t\tlet r = 0;\n\t\tlet g = 0;\n\t\tlet b = 0;\n\t\tif( h <= 60 ) {\n\t\t\tr = max;\n\t\t\tg = (h / 60) * length + min;\n\t\t\tb = min;\n\t\t} else if( h <= 120 ) {\n\t\t\tr = ((120 - h) / 60) * length + min;\n\t\t\tg = max;\n\t\t\tb = min;\n\t\t} else if( h <= 180 ) {\n\t\t\tr = min;\n\t\t\tg = max;\n\t\t\tb = ((h - 120) / 60) * length + min;\n\t\t} else if( h <= 240 ) {\n\t\t\tr = min;\n\t\t\tg = ((240 - h) / 60) * length + min;\n\t\t\tb = max;\n\t\t} else if( h <= 300 ) {\n\t\t\tr = ((h - 240) / 60) * length + min;\n\t\t\tg = min;\n\t\t\tb = max;\n\t\t} else {\n\t\t\tr = max;\n\t\t\tg = min;\n\t\t\tb = ((360 - h) / 60) * length + min;\n\t\t}\n\n\t\tr = Math.max( 0, Math.min( 255, r ) );\n\t\tg = Math.max( 0, Math.min( 255, g ) );\n\t\tb = Math.max( 0, Math.min( 255, b ) );\n\n\t\treturn (r << 16) | (g << 8) | b;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilIndexOf = <V>( array: V[], value: V ): number => {\n\tlet i0 = 0;\n\tlet i1 = array.length - 1;\n\n\twhile( i0 <= i1 ) {\n\t\tconst i2 = i0 + ((i1 - i0) >> 1);\n\t\tconst v2 = array[ i2 ];\n\t\tif( value < v2 ) {\n\t\t\ti1 = i2 - 1;\n\t\t} else if( v2 < value ) {\n\t\t\ti0 = i2 + 1;\n\t\t} else {\n\t\t\treturn i2;\n\t\t}\n\t}\n\n\treturn -1;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilIsArray = Array.isArray || (( target: any ): target is unknown[] => {\n\treturn Object.prototype.toString.call( target ) === \"[object Array]\";\n});\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilIsNaN = ( target: number ): boolean => {\n\treturn target !== target;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilPromise {\n\tstatic IDENTITY = () => { /* DO NOTHING*/ };\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utilPad } from \"./util-pad\";\n\nexport class UtilRgb {\n\tstatic toCode( color: number ): string {\n\t\treturn utilPad( color.toString( 16 ).toUpperCase(), 6, \"0\" );\n\t}\n\n\tstatic fromCode( code: string ): number | null {\n\t\tconst trimmed = code.trim().toLowerCase();\n\t\tif( trimmed.length === 6 ) {\n\t\t\tconst color = Number( `0x${trimmed}` );\n\t\t\tif( color === color ) {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic fromRgb( r: number, g: number, b: number ): number {\n\t\treturn ((r * 0xff) << 16) + ((g * 0xff) << 8) + ((b * 0xff) | 0);\n\t}\n\n\tstatic blend( colorA: number, colorB: number, t: number ): number {\n\t\tconst ar = ((colorA >> 16) & 0xff);\n\t\tconst ag = ((colorA >> 8) & 0xff);\n\t\tconst ab = ((colorA | 0) & 0xff);\n\n\t\tconst br = ((colorB >> 16) & 0xff);\n\t\tconst bg = ((colorB >> 8) & 0xff);\n\t\tconst bb = ((colorB | 0) & 0xff);\n\n\t\tconst w1 = Math.max( 0, Math.min( 1, t ) );\n\t\tconst w0 = 1 - w1;\n\t\tconst cr = Math.max( 0, Math.min( 0xff, ar * w0 + br * w1 ) );\n\t\tconst cg = Math.max( 0, Math.min( 0xff, ag * w0 + bg * w1 ) );\n\t\tconst cb = Math.max( 0, Math.min( 0xff, ab * w0 + bb * w1 ) );\n\n\t\treturn (cr << 16) + (cg << 8) + (cb | 0);\n\t}\n\n\tstatic brighten( color: number, amount: number ): number {\n\t\treturn this.blend( color, 0xffffff, amount );\n\t}\n\n\tstatic darken( color: number, amount: number ): number {\n\t\treturn this.blend( color, 0x000000, amount );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilRgba {\n\tstatic toCode( color: number, alpha: number ): string {\n\t\tconst r = ( color >> 16 ) & 0xff;\n\t\tconst g = ( color >> 8 ) & 0xff;\n\t\tconst b = ( color & 0xff );\n\t\treturn `rgba(${r},${g},${b},${alpha})`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\n\nexport class UtilTexture {\n\tstatic fromImage( url: string, resolution: number, onLoad: ( texture: Texture ) => void ) {\n\t\tconst texture = Texture.from( url, {\n\t\t\tresolution\n\t\t});\n\t\tif( ! texture.baseTexture.valid ) {\n\t\t\ttexture.once( \"update\", onLoad );\n\t\t} else {\n\t\t\tonLoad( texture );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilToString = ( value: unknown ): string => {\n\treturn ( value != null ? String( value ) : \"\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\n\nexport interface UtilTransitionOptions {\n\tduration?: number;\n}\n\nexport class UtilTransition {\n\tprotected _duration: number;\n\tprotected _current: DBase<any, any> | null;\n\tprotected _lastUpdate: number;\n\tprotected _updateId: number | null;\n\n\tconstructor( options?: UtilTransitionOptions ) {\n\t\tthis._duration = ( options != null && options.duration != null ? options.duration : 300 );\n\t\tthis._current = null;\n\t\tthis._lastUpdate = 0;\n\t\tthis._updateId = null;\n\t}\n\n\tshow( next: DBase<any, any> | null, forcibly?: boolean ): void {\n\t\tconst updateId = this._updateId;\n\t\tif( updateId != null ) {\n\t\t\tclearTimeout( updateId );\n\t\t}\n\n\t\tconst current = this._current;\n\t\tif( next !== current ) {\n\t\t\tconst duration = this._duration;\n\t\t\tconst lastUpdate = this._lastUpdate;\n\t\t\tconst now = Date.now();\n\t\t\tconst remaining = (lastUpdate + duration) - now;\n\t\t\tif( forcibly === true || remaining <= 0 ) {\n\t\t\t\tthis.update( now, next );\n\t\t\t} else {\n\t\t\t\tthis._updateId = window.setTimeout(() => {\n\t\t\t\t\tthis.update( Date.now(), next );\n\t\t\t\t}, remaining );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected update( now: number, next: DBase<any, any> | null ) {\n\t\tconst current = this._current;\n\t\tif( current !== next ) {\n\t\t\tthis._lastUpdate = now;\n\n\t\t\tif( current !== null ) {\n\t\t\t\tcurrent.hide();\n\t\t\t}\n\n\t\t\tthis._current = next;\n\t\t\tif( next != null ) {\n\t\t\t\tnext.show();\n\t\t\t}\n\t\t}\n\t}\n\n\thide(): void {\n\t\tthis.show( null );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeFont } from \"../d-font\";\nimport { DThemes } from \"../theme/d-themes\";\n\nexport interface UtilWheelEventDeltas {\n\tmode: number;\n\tdelta: number;\n\tdeltaX: number;\n\tdeltaY: number;\n\tlowest: number;\n}\n\n/*!\n* jQuery Mousewheel 3.1.13\n*\n* Copyright jQuery Foundation and other contributors\n* Released under the MIT license\n* http://jquery.org/license\n*\n* See also https://github.com/mapbox/mapbox-gl-js/blob/001c7b9/js/ui/handler/scroll_zoom.js\n* and https://github.com/openlayers/openlayers/blob/v5.2.0/src/ol/interaction/MouseWheelZoom.js#L51\n*/\nexport class UtilWheelEvent {\n\tprivate static INSTANCE: UtilWheelEvent | null;\n\tprivate _names: Array<\"wheel\" | \"mousewheel\" | \"DOMMouseScroll\" | \"MozMousePixelScroll\">;\n\tprivate _lowest: number | null = null;\n\tprivate _timestamp: number = 0;\n\tprivate _lineHeight: number | null = null;\n\tprivate _pageHeight: number | null = null;\n\n\tconstructor() {\n\t\tthis._names = ( \"onwheel\" in document || 9 <= (document as any).documentMode ?\n\t\t\t[ \"wheel\" ] : [ \"mousewheel\", \"DOMMouseScroll\", \"MozMousePixelScroll\" ]\n\t\t);\n\t}\n\n\ton( target: HTMLElement, handler: ( e: WheelEvent | Event ) => void, useCapture: boolean = false ) {\n\t\tconst names = this._names;\n\t\tfor( let i = names.length - 1; 0 <= i; --i ) {\n\t\t\tconst name = names[ i ];\n\t\t\ttarget.addEventListener( name, handler, useCapture );\n\t\t}\n\t}\n\n\toff( target: HTMLElement, handler: ( e: WheelEvent | Event ) => void, useCapture: boolean = false ) {\n\t\tconst names = this._names;\n\t\tfor( let i = names.length - 1; 0 <= i; --i ) {\n\t\t\tconst name = names[ i ];\n\t\t\ttarget.removeEventListener( name, handler, useCapture );\n\t\t}\n\t}\n\n\tgetLineHeight(): number {\n\t\tif( this._lineHeight == null ) {\n\t\t\tconst theme = DThemes.getInstance().get( \"DBase\" ) as DThemeFont;\n\t\t\tthis._lineHeight = theme.getLineHeight();\n\t\t}\n\t\treturn this._lineHeight;\n\t}\n\n\tgetPageHeight(): number {\n\t\tif( this._pageHeight == null ) {\n\t\t\tthis._pageHeight = this.getLineHeight() * 12;\n\t\t}\n\t\treturn this._pageHeight;\n\t}\n\n\tnormalize( e: any ): UtilWheelEventDeltas | null {\n\t\tlet deltaX = 0;\n\t\tlet deltaY = 0;\n\n\t\t// Old school scrollwheel delta\n\t\tif ( \"detail\" in e ) {\n\t\t\tdeltaY = e.detail * -1;\n\t\t}\n\t\tif ( \"wheelDelta\" in e ) {\n\t\t\tdeltaY = e.wheelDelta;\n\t\t}\n\t\tif ( \"wheelDeltaY\" in e ) {\n\t\t\tdeltaY = e.wheelDeltaY;\n\t\t}\n\t\tif ( \"wheelDeltaX\" in e ) {\n\t\t\tdeltaX = e.wheelDeltaX * -1;\n\t\t}\n\n\t\t// Firefox < 17 horizontal scrolling related to DOMMouseScroll event\n\t\tif ( \"axis\" in e && e.axis === e.HORIZONTAL_AXIS ) {\n\t\t\tdeltaX = deltaY * -1;\n\t\t\tdeltaY = 0;\n\t\t}\n\n\t\t// New school wheel delta (wheel event)\n\t\tif ( \"deltaY\" in e ) {\n\t\t\tdeltaY = e.deltaY * -1;\n\t\t}\n\t\tif ( \"deltaX\" in e ) {\n\t\t\tdeltaX = e.deltaX;\n\t\t}\n\n\t\t// No change actually happened, no reason to go any further\n\t\tif ( deltaY === 0 && deltaX === 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Store lowest absolute delta to normalize the delta values\n\t\tlet delta = Math.max( Math.abs(deltaY), Math.abs(deltaX) );\n\n\t\t// Reset the this._lowest to better handle multiple device types\n\t\t// that give different a different lowestDelta\n\t\t// Ex: trackpad = 3 and mouse wheel = 120\n\t\tconst now = Date.now();\n\t\tif( this._timestamp + 200 <= now ) {\n\t\t\tthis._lowest = null;\n\t\t}\n\t\tthis._timestamp = now;\n\n\t\t//\n\t\tconst shouldAdjust = (e.type === \"mousewheel\" && delta % 120 === 0);\n\t\tif ( ! this._lowest || delta < this._lowest ) {\n\t\t\tthis._lowest = delta;\n\n\t\t\t// Adjust older deltas if necessary\n\t\t\tif ( shouldAdjust ) {\n\t\t\t\tthis._lowest /= 40;\n\t\t\t}\n\t\t}\n\n\t\t// Adjust older deltas if necessary\n\t\tif ( shouldAdjust ) {\n\t\t\t// Divide all the things by 40!\n\t\t\tdelta  /= 40;\n\t\t\tdeltaX /= 40;\n\t\t\tdeltaY /= 40;\n\t\t}\n\n\t\t// Get a whole, normalized value for the deltas\n\t\tconst lowest = this._lowest;\n\t\tdelta  = Math.floor( delta  / lowest );\n\t\tdeltaX = Math[ 1 <= deltaX ? \"floor\" : \"ceil\" ](deltaX / lowest);\n\t\tdeltaY = Math[ 1 <= deltaY ? \"floor\" : \"ceil\" ](deltaY / lowest);\n\n\t\t// Mode\n\t\tconst mode = e.deltaMode || 0;\n\t\tif( mode !== 0 ) {\n\t\t\tconst scale = ( mode === 1 ? this.getLineHeight() : this.getPageHeight() );\n\t\t\tdelta *= scale;\n\t\t\tdeltaX *= scale;\n\t\t\tdeltaY *= scale;\n\t\t}\n\n\t\treturn {\n\t\t\tmode,\n\t\t\tdelta,\n\t\t\tdeltaX,\n\t\t\tdeltaY,\n\t\t\tlowest\n\t\t};\n\t}\n\n\tstatic getInstance(): UtilWheelEvent {\n\t\tif( this.INSTANCE == null ) {\n\t\t\tthis.INSTANCE = new UtilWheelEvent();\n\t\t}\n\t\treturn this.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DCornerMask } from \"./d-corner\";\nimport { DLayoutClearType } from \"./d-layout-clear-type\";\nimport { DLayoutSpace, DLayoutSpaceOptions } from \"./d-layout-space\";\nimport { utilIsNumber } from \"./util/util-is-number\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport enum DLayoutDirection {\n\tVERTICAL,\n\tHORIZONTAL\n}\n\nexport interface DLayoutMargin {\n\thorizontal: number;\n\tvertical: number;\n}\n\nexport interface DLayoutOptions<THEME extends DThemeLayout> extends DBaseOptions<THEME> {\n\tmargin?: number | { horizontal?: number, vertical?: number };\n\tcorner?: number | {\n\t\tradius?: number;\n\t\tmask?: DCornerMask;\n\t\tadjust?: boolean\n\t};\n\trow?: number;\n\tcolumn?: number;\n\tdirection?: (keyof typeof DLayoutDirection) | DLayoutDirection;\n}\n\nexport interface DThemeLayout extends DThemeBase {\n\tgetMargin(): number;\n\tgetDirection(): DLayoutDirection;\n\tgetCornerAdjust(): boolean;\n\tgetMultiplicity(): number;\n}\n\nconst isDBaseVisible = ( child: DisplayObject ): child is DBase => {\n\treturn child instanceof DBase && (child.visible || child instanceof DLayoutSpace);\n};\n\nconst toMultiplicity = <THEME extends DThemeLayout>( theme: THEME, options?: DLayoutOptions<THEME> ): number => {\n\tif( options ) {\n\t\tif( options.row != null ) {\n\t\t\treturn options.row;\n\t\t}\n\t\tif( options.column != null ) {\n\t\t\treturn options.column;\n\t\t}\n\t}\n\treturn theme.getMultiplicity();\n};\n\nconst toMargin = <THEME extends DThemeLayout>( theme: THEME, options?: DLayoutOptions<THEME> ): DLayoutMargin => {\n\tif( options && options.margin != null ) {\n\t\tconst margin = options.margin;\n\t\tif( utilIsNumber( margin ) ) {\n\t\t\treturn {\n\t\t\t\thorizontal: margin,\n\t\t\t\tvertical: margin\n\t\t\t};\n\t\t} else {\n\t\t\tconst themeMargin = theme.getMargin();\n\t\t\treturn {\n\t\t\t\thorizontal: ( margin.horizontal != null ? margin.horizontal : themeMargin ),\n\t\t\t\tvertical: ( margin.vertical != null ? margin.vertical : themeMargin )\n\t\t\t};\n\t\t}\n\t} else {\n\t\tconst themeMargin = theme.getMargin();\n\t\treturn {\n\t\t\thorizontal: themeMargin,\n\t\t\tvertical: themeMargin\n\t\t};\n\t}\n};\n\nconst toDirection = <THEME extends DThemeLayout>( theme: THEME, options?: DLayoutOptions<THEME> ): DLayoutDirection => {\n\tif( options && options.direction != null ) {\n\t\tconst direction = options.direction;\n\t\tif( utilIsString( direction ) ) {\n\t\t\treturn DLayoutDirection[ direction ];\n\t\t} else {\n\t\t\treturn direction;\n\t\t}\n\t}\n\treturn theme.getDirection();\n};\n\nconst toCornerAdjust = <THEME extends DThemeLayout>( theme: THEME, options?: DLayoutOptions<THEME> ): boolean => {\n\tif( options && options.corner != null && ! utilIsNumber( options.corner ) && options.corner.adjust != null ) {\n\t\treturn options.corner.adjust;\n\t}\n\treturn theme.getCornerAdjust();\n};\n\nexport abstract class DLayout<\n\tTHEME extends DThemeLayout,\n\tOPTIONS extends DLayoutOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tstatic CORNER_ADJUST_WORK: Float32Array | null = null;\n\n\tprotected _margin: DLayoutMargin;\n\tprotected _cornerAdjust: boolean;\n\tprotected _multiplicity: number;\n\tprotected _direction: DLayoutDirection;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tconst theme = this.theme;\n\t\tthis._margin = toMargin( theme, options );\n\t\tthis._direction = toDirection( theme, options );\n\t\tthis._cornerAdjust = toCornerAdjust( theme, options );\n\t\tthis._multiplicity = toMultiplicity( theme, options );\n\t}\n\n\tprotected getWeightTotal() {\n\t\tconst children = this.children;\n\t\tlet result = 0;\n\t\tconst multiplicity = this._multiplicity;\n\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\tlet weight = -1;\n\t\t\tlet j = 0;\n\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\tconst child = children[ i + j ];\n\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\tif( clearType && DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ti += 1;\n\t\t\t\t\tj -= 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\ti += j;\n\t\t\tif( 0 <= weight ) {\n\t\t\t\tresult += weight;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getSpaceLeft( baseSize: number, margin: number ) {\n\t\tconst children = this.children;\n\t\tconst multiplicity = this._multiplicity;\n\t\tif( this._direction === DLayoutDirection.VERTICAL ) {\n\t\t\tlet result = baseSize;\n\t\t\tlet marginNext = 0;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\tlet height = 0;\n\t\t\t\tlet weight = -1;\n\t\t\t\tlet j = 0;\n\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\tconst child = children[ i + j ];\n\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\t\tif( weight < 0 ) {\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height + marginNext );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\theight = marginNext;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti += j;\n\t\t\t\tresult -= height;\n\t\t\t\tmarginNext = margin;\n\t\t\t}\n\t\t\treturn Math.max( 0, result );\n\t\t} else {\n\t\t\tlet result = baseSize;\n\t\t\tlet marginNext = 0;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\tlet width = 0;\n\t\t\t\tlet weight = -1;\n\t\t\t\tlet j = 0;\n\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\tconst child = children[ i + j ];\n\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\t\tif( weight < 0 ) {\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width + marginNext );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidth = marginNext;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti += j;\n\t\t\t\tresult -= width;\n\t\t\t\tmarginNext = margin;\n\t\t\t}\n\t\t\treturn Math.max( 0, result );\n\t\t}\n\t}\n\n\tprotected onRefit(): void {\n\t\tconst children = this.children;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst margin = this._margin;\n\t\tconst marginVertical = margin.vertical;\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tconst weightTotal = this.getWeightTotal();\n\t\tconst multiplicity = this._multiplicity;\n\n\t\tlet cornerAdjustWork = null;\n\t\tif( this._cornerAdjust ) {\n\t\t\tconst requiredSize = 4 + ( children.length << 1 );\n\t\t\tif( DLayout.CORNER_ADJUST_WORK == null || DLayout.CORNER_ADJUST_WORK.length < requiredSize ) {\n\t\t\t\tDLayout.CORNER_ADJUST_WORK = new Float32Array( requiredSize );\n\t\t\t}\n\t\t\tcornerAdjustWork = DLayout.CORNER_ADJUST_WORK;\n\t\t\tcornerAdjustWork[ 0 ] = -2;\n\t\t\tcornerAdjustWork[ 1 ] = -2;\n\t\t\tcornerAdjustWork[ requiredSize - 2 ] = -3;\n\t\t\tcornerAdjustWork[ requiredSize - 1 ] = -3;\n\t\t}\n\n\t\tif( this._direction === DLayoutDirection.VERTICAL ) {\n\t\t\tlet irow = 0;\n\t\t\tlet y = paddingTop - marginVertical;\n\t\t\tif( 0 < weightTotal ) {\n\t\t\t\tconst weightTotalInverse = 1 / weightTotal;\n\t\t\t\tconst baseSize = this.height - paddingTop - paddingBottom;\n\t\t\t\tconst spaceLeft = this.getSpaceLeft( baseSize, marginVertical );\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\t\t\tlet height = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ i + j ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.height = spaceLeft * ( weight * weightTotalInverse );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tx += marginHorizontal + child.width;\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height );\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j - 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ty += marginVertical + height;\n\t\t\t\t\ti += j;\n\t\t\t\t\tirow += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ i ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet icolumn0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findRowIndexPrevious( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn0 = cornerAdjustWork[ i0 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet icolumn2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findRowIndexNext( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn2 = cornerAdjustWork[ i2 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst ncolumn = this.countColumn( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskColumn( icolumn0, icolumn1, icolumn2, ncolumn );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\t\t\tlet height = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ i + j ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.height = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tx += marginHorizontal + child.width;\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height );\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j - 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ty += marginVertical + height;\n\t\t\t\t\ti += j;\n\t\t\t\t\tirow += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ i ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet icolumn0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findRowIndexPrevious( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn0 = cornerAdjustWork[ i0 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet icolumn2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findRowIndexNext( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn2 = cornerAdjustWork[ i2 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst ncolumn = this.countColumn( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskColumn( icolumn0, icolumn1, icolumn2, ncolumn );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tlet icolumn = 0;\n\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\tif( 0 < weightTotal ) {\n\t\t\t\tconst weightTotalInverse = 1 / weightTotal;\n\t\t\t\tconst baseSize = this.width - paddingLeft - paddingRight;\n\t\t\t\tconst spaceLeft = this.getSpaceLeft( baseSize, marginHorizontal );\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet y = paddingTop - marginVertical;\n\t\t\t\t\tlet width = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ i + j ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.width = spaceLeft * ( weight * weightTotalInverse );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width );\n\t\t\t\t\t\t\t\ty += marginVertical + child.height;\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tx += marginHorizontal + width;\n\t\t\t\t\ti += j;\n\t\t\t\t\ticolumn += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ i ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet irow0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findColumnIndexPrevious( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\tirow0 = cornerAdjustWork[ i0 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet irow2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findColumnIndexNext( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\tirow2 = cornerAdjustWork[ i2 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst nrow = this.countRow( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskRow( irow0, irow1, irow2, nrow );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet y = paddingTop - marginVertical;\n\t\t\t\t\tlet width = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ i + j ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.width = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width );\n\t\t\t\t\t\t\t\ty += marginVertical + child.height;\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tx += marginHorizontal + width;\n\t\t\t\t\ti += j;\n\t\t\t\t\ticolumn += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ i ];\n\t\t\t\t\t\tif( isDBaseVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet irow0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findColumnIndexPrevious( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\tirow0 = cornerAdjustWork[ i0 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet irow2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findColumnIndexNext( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\tirow2 = cornerAdjustWork[ i2 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst nrow = this.countRow( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskRow( irow0, irow1, irow2, nrow );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper.onRefit();\n\t}\n\n\tprotected hasClearTypeBefore( children: DisplayObject[], index: number ): boolean {\n\t\treturn this.hasClearType( children, index, DLayoutClearType.BEFORE );\n\t}\n\n\tprotected hasClearTypeAfter( children: DisplayObject[], index: number ): boolean {\n\t\treturn this.hasClearType( children, index, DLayoutClearType.AFTER );\n\t}\n\n\tprotected hasClearType( children: DisplayObject[], index: number, clearType: DLayoutClearType ): boolean {\n\t\tif( 2 <= index ) {\n\t\t\tconst i = (index - 2) >> 1;\n\t\t\tif( 0 <= i && i < children.length ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\treturn !!( child.getClearType() & clearType );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected findColumnIndexPrevious( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart - 2; 0 <= i; i -= 2 ) {\n\t\t\tif( cornerAdjustWork[ i ] !== icolumn ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findColumnIndexNext( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst icolumn2 = cornerAdjustWork[ i ];\n\t\t\tif( icolumn2 !== icolumn ) {\n\t\t\t\tfor( let j = i + 2; j < imax; j += 2 ) {\n\t\t\t\t\tif( cornerAdjustWork[ j ] !== icolumn2 ) {\n\t\t\t\t\t\treturn j - 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn cornerAdjustWork.length - 2;\n\t}\n\n\tprotected countRow( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst icolumn2 = cornerAdjustWork[ i ];\n\t\t\tif( icolumn2 !== icolumn ) {\n\t\t\t\treturn cornerAdjustWork[ i - 2 + 1 ] + 1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findRowIndexPrevious( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart - 2; 0 <= i; i -= 2 ) {\n\t\t\tif( cornerAdjustWork[ i + 1 ] !== irow ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findRowIndexNext( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst irow2 = cornerAdjustWork[ i + 1 ];\n\t\t\tif( irow2 !== irow ) {\n\t\t\t\tfor( let j = i + 2; j < imax; j += 2 ) {\n\t\t\t\t\tif( cornerAdjustWork[ j + 1 ] !== irow2 ) {\n\t\t\t\t\t\treturn j - 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn cornerAdjustWork.length - 2;\n\t}\n\n\tprotected countColumn( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst irow2 = cornerAdjustWork[ i + 1 ];\n\t\t\tif( irow2 !== irow ) {\n\t\t\t\treturn cornerAdjustWork[ i - 2 + 0 ] + 1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected toCornerMaskColumn( i0: number, i1: number, i2: number, n: number ): DCornerMask {\n\t\tlet result = DCornerMask.NONE;\n\t\tif( i0 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_LEFT;\n\t\t}\n\t\tif( i2 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.BOTTOM_LEFT;\n\t\t}\n\t\tif( i0 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.TOP_RIGHT;\n\t\t}\n\t\tif( i2 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_RIGHT;\n\t\t}\n\t\treturn DCornerMask.ALL & (~result);\n\t}\n\n\tprotected toCornerMaskRow( i0: number, i1: number, i2: number, n: number ): DCornerMask {\n\t\tlet result = DCornerMask.NONE;\n\t\tif( i0 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_LEFT;\n\t\t}\n\t\tif( i2 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_RIGHT;\n\t\t}\n\t\tif( i0 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_LEFT;\n\t\t}\n\t\tif( i2 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_RIGHT;\n\t\t}\n\t\treturn DCornerMask.ALL & (~result);\n\t}\n\n\taddSpace( options?: DLayoutSpaceOptions ) {\n\t\treturn this.addChild( new DLayoutSpace( options ) );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DLayout\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilAttachAlign } from \"./util/util-attach\";\n\nexport import DMenuAlign = UtilAttachAlign;\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction } from \"pixi.js\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuAlign } from \"./d-menu-align\";\nimport { Closeable } from \"./d-menu-context\";\nimport { DMenuItem, DMenuItemOptions, DThemeMenuItem } from \"./d-menu-item\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenus } from \"./d-menus\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemMenuOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu\n> extends DMenuItemOptions<VALUE, THEME> {\n\tmenu: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\nexport interface DThemeMenuItemMenu extends DThemeMenuItem {\n\n}\n\nexport class DMenuItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItem<VALUE, THEME, OPTIONS> {\n\tprotected _menu!: DMenu<VALUE>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tUtilPointerEvent.onClick( this, (): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.toggle();\n\t\t\t}\n\t\t});\n\n\t\tthis.initHover( options );\n\n\t\tconst menu = this.toMenu( options );\n\t\tthis._menu = menu;\n\t\tmenu.on( \"select\", ( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void => {\n\t\t\tthis.onMenuSelect( value, item, closeable );\n\t\t});\n\t}\n\n\tprotected initHover( options: OPTIONS ): void {\n\t\tthis.on( UtilPointerEvent.over, (): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected toMenu( options: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options.menu;\n\t\tif( menu instanceof DisplayObject ) {\n\t\t\treturn menu;\n\t\t}\n\t\treturn this.newMenu( menu );\n\t}\n\n\tprotected newMenu( options: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\treturn DMenus.newMenu( options );\n\t}\n\n\tget menu(): DMenu<VALUE> {\n\t\treturn this._menu;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemMenu\";\n\t}\n\n\topen(): void {\n\t\tconst menu = this._menu;\n\t\tif( menu.isHidden() ) {\n\t\t\tthis.onOpen( menu );\n\t\t}\n\t}\n\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tconst context = this.getContext();\n\t\tif( context != null ) {\n\t\t\tmenu.open( this, this.getCloseable(), context );\n\t\t}\n\t}\n\n\tclose(): void {\n\t\tthis._menu.close();\n\t}\n\n\ttoggle(): void {\n\t\tconst menu = this._menu;\n\t\tif( menu.isHidden() ) {\n\t\t\tthis.onOpen( menu );\n\t\t} else {\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tthis.open();\n\t\tsuper.onSelect( e );\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void {\n\t\tconst next = this.getCloseable();\n\t\tif( next != null ) {\n\t\t\tnext.emit( \"select\", value, item, closeable );\n\t\t}\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemMenuOptions<VALUE> {\n\t\treturn \"menu\" in options;\n\t}\n\n\tstatic toSubMenuOptions<VALUE>( options: DMenuItemMenuOptions<VALUE>, sticky: boolean ): DMenuItemMenuOptions<VALUE> {\n\t\tconst menu = options.menu;\n\t\tif( ! (menu instanceof DisplayObject) ) {\n\t\t\tif( menu.sticky == null ) {\n\t\t\t\tmenu.sticky = sticky;\n\t\t\t}\n\t\t\tif( menu.align == null ) {\n\t\t\t\tmenu.align = DMenuAlign.RIGHT;\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DListItemSeparatorReflowable extends Graphics implements DReflowable {\n\tconstructor( base: DBase ) {\n\t\tsuper();\n\t\tbase.appendRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\t\tconst border = base.border;\n\t\tconst borderWidth = border.getWidth( state );\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\tconst padding = base.padding;\n\t\t\tconst middle = height * 0.5;\n\t\t\tthis.clear();\n\t\t\tthis.lineStyle( borderWidth, borderColor, borderAlpha, borderAlign );\n\t\t\tthis.moveTo( padding.getLeft(), middle );\n\t\t\tthis.lineTo( width - padding.getRight(), middle );\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.clear();\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\nimport { DListItemSeparatorReflowable } from \"./d-list-item-separator-reflowable\";\n\nexport interface DListItemSeparatorOptions<VALUE, THEME extends DThemeListItemSeparator>\n\textends DListItemOptions<VALUE, THEME> {\n\tseparator?: true;\n}\n\nexport interface DThemeListItemSeparator extends DThemeListItem {\n\n}\n\nexport class DListItemSeparator<\n\tVALUE,\n\tTHEME extends DThemeListItemSeparator = DThemeListItemSeparator,\n\tOPTIONS extends DListItemSeparatorOptions<VALUE, THEME> = DListItemSeparatorOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.interactive = false;\n\t\tthis.buttonMode = false;\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DListItemSeparatorReflowable( this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DListItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItemSeparator, DListItemSeparatorOptions, DThemeListItemSeparator } from \"./d-list-item-separator\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemSeparatorOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator\n> extends DListItemSeparatorOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemSeparator extends DThemeListItemSeparator {\n\n}\n\nexport class DMenuItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DListItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemSeparator\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemSeparatorOptions<VALUE> {\n\t\treturn \"separator\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport interface DLayoutSpaceOptions<THEME extends DThemeLayoutSpace = DThemeLayoutSpace> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutSpace extends DThemeBase {\n\n}\n\nexport class DLayoutSpace<\n\tTHEME extends DThemeLayoutSpace = DThemeLayoutSpace,\n\tOPTIONS extends DLayoutSpaceOptions<THEME> = DLayoutSpaceOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.visible = false;\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DLayoutSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayoutSpace, DLayoutSpaceOptions, DThemeLayoutSpace } from \"./d-layout-space\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemSpaceOptions<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace\n> extends DLayoutSpaceOptions<THEME> {\n\tspace: true;\n}\n\nexport interface DThemeMenuItemSpace extends DThemeLayoutSpace {\n\n}\n\nexport class DMenuItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DLayoutSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemSpace\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemSpaceOptions {\n\t\treturn \"space\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuItemText } from \"../d-menu-item-text\";\nimport { DMenus } from \"../d-menus\";\n\nexport const loadMenuItem = () => {\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any>, sticky: boolean ): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeType {\n\tCIRCLE,\n\tRECTANGLE,\n\tRECTANGLE_ROUNDED,\n\tTRIANGLE,\n\tTRIANGLE_ROUNDED,\n\tLINE,\n\tIMAGE,\n\tGROUP,\n\tBAR,\n\tLABEL,\n\tNULL,\n\tGROUP_SHADOWED,\n\tEXTENSION = 1000\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayout, DLayoutOptions, DThemeLayout } from \"./d-layout\";\n\nexport interface DLayoutVerticalOptions<THEME extends DThemeLayout> extends DLayoutOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutVertical extends DThemeLayout {\n\n}\n\nexport class DLayoutVertical<\n\tTHEME extends DThemeLayoutVertical = DThemeLayoutVertical,\n\tOPTIONS extends DLayoutVerticalOptions<THEME> = DLayoutVerticalOptions<THEME>\n> extends DLayout<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DLayoutVertical\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DMenuItemExpandableBodyOptions<\n\tTHEME extends DThemeMenuItemExpandableBody = DThemeMenuItemExpandableBody\n> extends DLayoutVerticalOptions<THEME> {\n\n}\n\nexport interface DThemeMenuItemExpandableBody extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuItemExpandableBody<\n\tTHEME extends DThemeMenuItemExpandableBody = DThemeMenuItemExpandableBody,\n\tOPTIONS extends DMenuItemExpandableBodyOptions<THEME> = DMenuItemExpandableBodyOptions<THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableBody\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DListItem, DListItemOptions, DListItemSelection, DThemeListItem } from \"./d-list-item\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemExpandableHeaderOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandableHeader = DThemeMenuItemExpandableHeader\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemExpandableHeader extends DThemeListItem {\n\n}\n\nexport class DMenuItemExpandableHeader<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandableHeader = DThemeMenuItemExpandableHeader,\n\tOPTIONS extends DMenuItemExpandableHeaderOptions<VALUE, THEME> = DMenuItemExpandableHeaderOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected getSelection(): DListItemSelection | null {\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableHeader\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ) {\n\t\tthis.emit( \"select\", this );\n\t\tsuper.onSelect( e );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuItemExpandables {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenus.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\nimport { DMenuItemExpandableBody, DMenuItemExpandableBodyOptions } from \"./d-menu-item-expandable-body\";\nimport { DMenuItemExpandableHeader, DMenuItemExpandableHeaderOptions } from \"./d-menu-item-expandable-header\";\nimport { DMenuItemExpandables } from \"./d-menu-item-expandables\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemExpandableOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n> extends DLayoutVerticalOptions<THEME> {\n\theader: DisplayObject | DMenuItemExpandableHeaderOptions<VALUE>;\n\tbody?: Container | DMenuItemExpandableBodyOptions;\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n\tsticky?: boolean;\n}\n\nexport interface DThemeMenuItemExpandable extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuItemExpandable<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n\tOPTIONS extends DMenuItemExpandableOptions<VALUE, THEME> = DMenuItemExpandableOptions<VALUE, THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _header!: DisplayObject;\n\tprotected _body!: DisplayObject;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Header\n\t\tconst theme = this.theme;\n\t\tconst header = this.toHeader( theme, options );\n\t\tthis._header = header;\n\t\theader.on( \"select\", (): void => {\n\t\t\tthis.toggle();\n\t\t});\n\t\tthis.addChild( header );\n\n\t\t// Body\n\t\tconst body = this.toBody( theme, options );\n\t\tthis._body = body;\n\t\tconst sticky = ( options && options.sticky != null ? options.sticky : false );\n\t\tthis.newItems( body, sticky, theme, options );\n\t\tthis.addChild( body );\n\n\t\t//\n\t\tif( this.isActive() ) {\n\t\t\tthis.onActivated();\n\t\t} else {\n\t\t\tthis.onDeactivated();\n\t\t}\n\t}\n\n\tprotected newItems( body: Container, sticky: boolean, theme: THEME, options: OPTIONS | undefined ): void {\n\t\tif( options != null && options.items != null ) {\n\t\t\tDMenuItemExpandables.newItems( body, options.items, sticky );\n\t\t}\n\t}\n\n\tprotected toHeader( theme: THEME, options?: OPTIONS ): DisplayObject {\n\t\tif( options ) {\n\t\t\tif( options.header instanceof DisplayObject ) {\n\t\t\t\treturn options.header;\n\t\t\t} else {\n\t\t\t\treturn this.newHeader( theme, options.header );\n\t\t\t}\n\t\t}\n\t\treturn this.newHeader( theme );\n\t}\n\n\tprotected newHeader( theme: THEME, options?: DMenuItemExpandableHeaderOptions<VALUE> ): DisplayObject {\n\t\treturn new DMenuItemExpandableHeader<VALUE>( options );\n\t}\n\n\tprotected toBody( theme: THEME,  options?: OPTIONS ): Container {\n\t\tif( options && options.body ) {\n\t\t\tif( options.body instanceof DisplayObject ) {\n\t\t\t\treturn options.body;\n\t\t\t} else {\n\t\t\t\treturn this.newBody( theme, options.body );\n\t\t\t}\n\t\t}\n\t\treturn this.newBody( theme );\n\t}\n\n\tprotected newBody( theme: THEME, options?: DMenuItemExpandableBodyOptions ): Container {\n\t\treturn new DMenuItemExpandableBody( options );\n\t}\n\n\topen(): void {\n\t\tthis.setActive( true );\n\t}\n\n\tclose(): void {\n\t\tthis.setActive( false );\n\t}\n\n\ttoggle(): void {\n\t\tthis.setActive( ! this.isActive() );\n\t}\n\n\tprotected onActivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.show();\n\t\t} else {\n\t\t\tbody.visible = true;\n\t\t}\n\t}\n\n\tprotected onDeactivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.hide();\n\t\t} else {\n\t\t\tbody.visible = false;\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: DBaseState, oldState: DBaseState ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tif( DBaseStates.isActive( newState ) ) {\n\t\t\tif( ! DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onActivated();\n\t\t\t}\n\t\t} else {\n\t\t\tif( DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onDeactivated();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandable\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemExpandableOptions<VALUE> {\n\t\treturn \"header\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheck, DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\n\nexport class DMenuItemExpandableItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuItemExpandableItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSeparator, DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuItemExpandableItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSpace, DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuItemExpandableItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuItemExpandableItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemExpandable } from \"../d-menu-item-expandable\";\nimport { DMenuItemExpandableItemCheck } from \"../d-menu-item-expandable-item-check\";\nimport { DMenuItemExpandableItemLink } from \"../d-menu-item-expandable-item-link\";\nimport { DMenuItemExpandableItemSeparator } from \"../d-menu-item-expandable-item-separator\";\nimport { DMenuItemExpandableItemSpace } from \"../d-menu-item-expandable-item-space\";\nimport { DMenuItemExpandableItemText } from \"../d-menu-item-expandable-item-text\";\nimport { DMenuItemExpandables } from \"../d-menu-item-expandables\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenus } from \"../d-menus\";\n\nexport const loadMenuItemExpandable = () => {\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemExpandable.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandable( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuItemExpandableItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheck, DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\n\nexport class DMenuSidedItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItemSelection } from \"./d-list-item\";\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuSidedItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getSelection(): DListItemSelection | null {\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenu } from \"./d-menu\";\nimport { Closeable } from \"./d-menu-context\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemMenu, DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuSidedItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected initHover( options: OPTIONS ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, closeable: Closeable ): void {\n\t\tsuper.onMenuSelect( value, item, closeable );\n\t\tconst selection = this.getSelection();\n\t\tif( selection ) {\n\t\t\tselection.add( item );\n\t\t}\n\t}\n\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tmenu.open( this, this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSeparator, DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuSidedItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSpace, DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuSidedItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuSidedItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuSideds {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenus.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuSidedItemCheck } from \"../d-menu-sided-item-check\";\nimport { DMenuSidedItemLink } from \"../d-menu-sided-item-link\";\nimport { DMenuSidedItemMenu } from \"../d-menu-sided-item-menu\";\nimport { DMenuSidedItemSeparator } from \"../d-menu-sided-item-separator\";\nimport { DMenuSidedItemSpace } from \"../d-menu-sided-item-space\";\nimport { DMenuSidedItemText } from \"../d-menu-sided-item-text\";\nimport { DMenuSideds } from \"../d-menu-sideds\";\n\nexport const loadMenuSidedItem = () => {\n\tDMenuSideds.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuSidedItemText( options );\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any>, sticky: boolean ): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuSideds } from \"./d-menu-sideds\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuSidedItemExpandables {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenuSideds.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DMenuItemExpandable, DMenuItemExpandableOptions, DThemeMenuItemExpandable } from \"./d-menu-item-expandable\";\nimport { DMenuSidedItemExpandables } from \"./d-menu-sided-item-expandables\";\n\nexport class DMenuSidedItemExpandable<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n\tOPTIONS extends DMenuItemExpandableOptions<VALUE, THEME> = DMenuItemExpandableOptions<VALUE, THEME>\n> extends DMenuItemExpandable<VALUE, THEME, OPTIONS> {\n\tprotected newItems( body: Container, sticky: boolean, theme: THEME, options: OPTIONS | undefined ): void {\n\t\tif( options != null && options.items != null ) {\n\t\t\tDMenuSidedItemExpandables.newItems( body, options.items, sticky );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandable\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\nimport { DMenuItemExpandableItemCheck } from \"./d-menu-item-expandable-item-check\";\n\nexport class DMenuSidedItemExpandableItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuSidedItemExpandableItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemMenu, DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuItemExpandableItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItemExpandableItemMenu } from \"./d-menu-item-expandable-item-menu\";\nimport { DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuSidedItemExpandableItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tmenu.open( this, this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemSeparator } from \"./d-menu-item-expandable-item-separator\";\nimport { DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuSidedItemExpandableItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemSpace } from \"./d-menu-item-expandable-item-space\";\nimport { DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuSidedItemExpandableItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemExpandableItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemText } from \"./d-menu-item-expandable-item-text\";\nimport { DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuSidedItemExpandableItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemExpandable } from \"../d-menu-item-expandable\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuSidedItemExpandable } from \"../d-menu-sided-item-expandable\";\nimport { DMenuSidedItemExpandableItemCheck } from \"../d-menu-sided-item-expandable-item-check\";\nimport { DMenuSidedItemExpandableItemLink } from \"../d-menu-sided-item-expandable-item-link\";\nimport { DMenuSidedItemExpandableItemMenu } from \"../d-menu-sided-item-expandable-item-menu\";\nimport { DMenuSidedItemExpandableItemSeparator } from \"../d-menu-sided-item-expandable-item-separator\";\nimport { DMenuSidedItemExpandableItemSpace } from \"../d-menu-sided-item-expandable-item-space\";\nimport { DMenuSidedItemExpandableItemText } from \"../d-menu-sided-item-expandable-item-text\";\nimport { DMenuSidedItemExpandables } from \"../d-menu-sided-item-expandables\";\nimport { DMenuSideds } from \"../d-menu-sideds\";\n\nexport const loadMenuSidedItemExpandable = () => {\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemExpandable.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandable( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator((\n\t\toptions: DMenuItemOptionsUnion<any>, sticky: boolean\n\t): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuSidedItemExpandableItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadMenuItem } from \"./load-menu-item\";\nimport { loadMenuItemExpandable } from \"./load-menu-item-expandable\";\nimport { loadMenuSidedItem } from \"./load-menu-sided-item\";\nimport { loadMenuSidedItemExpandable } from \"./load-menu-sided-item-expandable\";\n\nexport const loadMenuItemAll = () => {\n\tloadMenuItem();\n\tloadMenuItemExpandable();\n\tloadMenuSidedItem();\n\tloadMenuSidedItemExpandable();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\n\ntype Deserializer = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n) => Promise<EShape> | EShape | null;\n\nexport const EShapeDeserializers: { [ type: number ]: Deserializer | undefined } = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\n\nexport type EShapeUploadedCreator = (\n\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n) => EShapeUploaded | null;\n\nexport const EShapeUploadeds: {\n\t[ type: number ]: EShapeUploadedCreator | undefined\n} = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShapePointsParent } from \"./e-shape-points-parent\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\n\nexport enum EShapePointsStyle {\n\tNONE = 0,\n\tCLOSED = 1,\n\tNON_EXPANDING_WIDTH = 2,\n\tNON_SHRINKING_WIDTH = 4,\n\tNON_SCALING_DOT_AND_DASH = 8,\n\tDOTTED = 16,\n\tDOTTED_DENSELY = 32,\n\tDOTTED_LOOSELY = 64,\n\tDASHED = 128,\n\tDASHED_DENSELY = 256,\n\tDASHED_LOOSELY = 512,\n\tDOTTED_MASK = DOTTED | DOTTED_DENSELY | DOTTED_LOOSELY,\n\tDASHED_MASK = DASHED | DASHED_DENSELY | DASHED_LOOSELY,\n\tNON_SOLID_MASK = DOTTED_MASK | DASHED_MASK\n}\n\nexport interface EShapePoints {\n\treadonly length: number;\n\treadonly id: number;\n\tvalues: number[];\n\tsegments: number[];\n\tstyle: EShapePointsStyle;\n\n\tset( values?: number[], segments?: number[], style?: EShapePointsStyle ): this;\n\tcopy( source: EShapePoints ): this;\n\tclone( parent: EShapePointsParent ): EShapePoints;\n\ttoPoints( transform: Matrix ): Point[];\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapePointsStyle } from \"./e-shape-points\";\n\nexport class EShapePointsStyleUploadeds {\n\tstatic toScaleInvariant( style: EShapePointsStyle ): number {\n\t\tconst nonExpandingWidth = ( style & EShapePointsStyle.NON_EXPANDING_WIDTH ? 1 : 0 );\n\t\tconst nonShrinkingWidth = ( style & EShapePointsStyle.NON_SHRINKING_WIDTH ? 2 : 0 );\n\t\tconst nonScalingDotAndDash = ( style & EShapePointsStyle.NON_SCALING_DOT_AND_DASH ? 4 : 0 );\n\t\tif( style & EShapePointsStyle.NON_SOLID_MASK ) {\n\t\t\treturn nonExpandingWidth | nonShrinkingWidth | nonScalingDotAndDash;\n\t\t} else {\n\t\t\treturn nonExpandingWidth | nonShrinkingWidth;\n\t\t}\n\t}\n\n\tstatic toDash(\n\t\tlength: number, strokeWidth: number, style: EShapePointsStyle, result: IPoint\n\t): IPoint {\n\t\tresult.set( 2 * length, 0 );\n\t\tif( style & EShapePointsStyle.NON_SOLID_MASK ) {\n\t\t\tif( style & EShapePointsStyle.DOTTED ) {\n\t\t\t\tresult.set( strokeWidth, strokeWidth );\n\t\t\t} else if( style & EShapePointsStyle.DOTTED_DENSELY ) {\n\t\t\t\tresult.set( strokeWidth, strokeWidth * 0.5 );\n\t\t\t} else if( style & EShapePointsStyle.DOTTED_LOOSELY ) {\n\t\t\t\tresult.set( strokeWidth, strokeWidth * 2 );\n\t\t\t} else if( style & EShapePointsStyle.DASHED ) {\n\t\t\t\tresult.set( strokeWidth * 2, strokeWidth );\n\t\t\t} else if( style & EShapePointsStyle.DASHED_DENSELY ) {\n\t\t\t\tresult.set( strokeWidth * 2, strokeWidth * 0.5 );\n\t\t\t} else if( style & EShapePointsStyle.DASHED_LOOSELY ) {\n\t\t\t\tresult.set( strokeWidth * 2, strokeWidth * 2 );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeBarPosition {\n\tTOP,\n\tLEFT,\n\tRIGHT,\n\tBOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShapePoints, EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapePointsParent } from \"../e-shape-points-parent\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\n\nexport class EShapeBarPoints implements EShapePoints {\n\tprotected _parent: EShapePointsParent;\n\tprotected _id: number;\n\tprotected _style: EShapePointsStyle;\n\tprotected _values: [ number, number, number, number ];\n\tprotected _segments: number[];\n\tprotected _size: number;\n\tprotected _position: EShapeBarPosition;\n\n\tprotected _updatedSize: number;\n\tprotected _updatedParentSizeX: number;\n\tprotected _updatedParentSizeY: number;\n\tprotected _updatedPosition: EShapeBarPosition;\n\n\tconstructor( parent: EShapePointsParent, position: EShapeBarPosition, size: number, style: EShapePointsStyle ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._values = [ 0, 0, 0, 0 ];\n\t\tthis._segments = [];\n\t\tthis._style = style;\n\t\tthis._size = size;\n\t\tthis._position = position;\n\n\t\tthis._updatedSize = NaN;\n\t\tthis._updatedParentSizeX = NaN;\n\t\tthis._updatedParentSizeY = NaN;\n\t\tthis._updatedPosition = NaN;\n\t}\n\n\tprotected getComputedSize( size: number, position: EShapeBarPosition, sizeX: number, sizeY: number ): number {\n\t\tif( 0 <= size ) {\n\t\t\treturn size;\n\t\t} else {\n\t\t\tswitch( position ) {\n\t\t\tcase EShapeBarPosition.TOP:\n\t\t\tcase EShapeBarPosition.BOTTOM:\n\t\t\t\treturn Math.abs( sizeY );\n\t\t\tcase EShapeBarPosition.RIGHT:\n\t\t\tcase EShapeBarPosition.LEFT:\n\t\t\t\treturn Math.abs( sizeX );\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprotected update(): void {\n\t\tconst parentSize = this._parent.size;\n\t\tconst parentSizeX = parentSize.x;\n\t\tconst parentSizeY = parentSize.y;\n\t\tconst position = this._position;\n\t\tconst size = this._size;\n\t\tif( this._updatedSize !== size || this._updatedParentSizeX !== parentSizeX ||\n\t\t\tthis._updatedParentSizeY !== parentSizeY || this._updatedPosition !== position ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._updatedSize = size;\n\t\t\tthis._updatedParentSizeX = parentSizeX;\n\t\t\tthis._updatedParentSizeY = parentSizeY;\n\t\t\tthis._updatedPosition = position;\n\t\t\tconst psxh = parentSizeX * 0.5;\n\t\t\tconst psyh = parentSizeY * 0.5;\n\t\t\tconst computedSize = this.getComputedSize( size, position, parentSizeX, parentSizeY );\n\t\t\tconst values = this._values;\n\t\t\tswitch( position ) {\n\t\t\tcase EShapeBarPosition.TOP:\n\t\t\t\tvalues[ 0 ] = 0;\n\t\t\t\tvalues[ 1 ] = -psyh;\n\t\t\t\tvalues[ 2 ] = 0;\n\t\t\t\tvalues[ 3 ] = -psyh + computedSize;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.RIGHT:\n\t\t\t\tvalues[ 0 ] = psxh;\n\t\t\t\tvalues[ 1 ] = 0;\n\t\t\t\tvalues[ 2 ] = psxh - computedSize;\n\t\t\t\tvalues[ 3 ] = 0;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.BOTTOM:\n\t\t\t\tvalues[ 0 ] = 0;\n\t\t\t\tvalues[ 1 ] = psyh;\n\t\t\t\tvalues[ 2 ] = 0;\n\t\t\t\tvalues[ 3 ] = psyh - computedSize;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.LEFT:\n\t\t\t\tvalues[ 0 ] = -psxh;\n\t\t\t\tvalues[ 1 ] = 0;\n\t\t\t\tvalues[ 2 ] = -psxh + computedSize;\n\t\t\t\tvalues[ 3 ] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tget length(): number {\n\t\treturn 2;\n\t}\n\n\tget id(): number {\n\t\tthis.update();\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\tthis.update();\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\t// SUPPOSED NOT TO BE CALLED\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\tset segments( segments: number[] ) {\n\t\t// SUPPOSED NOT TO BE CALLED\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tthis.moveTo( undefined, size, undefined );\n\t}\n\n\tget position(): EShapeBarPosition {\n\t\treturn this._position;\n\t}\n\n\tset position( position: EShapeBarPosition ) {\n\t\tthis.moveTo( position, undefined, undefined );\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.moveTo( undefined, undefined, style );\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\tif( source instanceof EShapeBarPoints ) {\n\t\t\treturn this.moveTo( source.position, source.size, source.style );\n\t\t} else {\n\t\t\treturn this.moveTo( undefined, undefined, source.style );\n\t\t}\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet newPosition: EShapeBarPosition | undefined;\n\t\tlet newSize: number | undefined;\n\t\tif( newValues != null ) {\n\t\t\tconst x0 = newValues[ 0 ];\n\t\t\tif( x0 === 0 ) {\n\t\t\t\tconst y0 = newValues[ 1 ];\n\t\t\t\tnewPosition = ( y0 <= 0 ? EShapeBarPosition.TOP : EShapeBarPosition.BOTTOM );\n\t\t\t\tnewSize = Math.abs( newValues[ 3 ] - y0 );\n\t\t\t} else {\n\t\t\t\tnewPosition = ( x0 <= 0 ? EShapeBarPosition.LEFT : EShapeBarPosition.RIGHT );\n\t\t\t\tnewSize = Math.abs( newValues[ 2 ] - x0 );\n\t\t\t}\n\t\t}\n\t\treturn this.moveTo( newPosition, newSize, newStyle );\n\t}\n\n\tprotected moveTo( position?: EShapeBarPosition, size?: number, style?: EShapePointsStyle ): this {\n\t\tlet isChanged = false;\n\n\t\tif( style != null && this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( position != null && this._position !== position ) {\n\t\t\tthis._position = position;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( size != null && this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclone( parent: EShapePointsParent ): EShapeBarPoints {\n\t\treturn new EShapeBarPoints( parent, this._position, this._size, this._style );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${this._position},${this._size},${this._style}]` );\n\t}\n\n\tdeserialize( resourceId: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tif( 0 <= resourceId && resourceId < manager.resources.length ) {\n\t\t\tconst resource = manager.resources[ resourceId ];\n\t\t\tconst parsed = JSON.parse( resource ) as [ number, number, number ];\n\t\t\tthis.moveTo( parsed[ 0 ], parsed[ 1 ], parsed[ 2 ] );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeCorner {\n\tNONE = 0,\n\tTOP_LEFT = 1,\n\tTOP_RIGHT = 2,\n\tBOTTOM_LEFT = 4,\n\tBOTTOM_RIGHT = 8,\n\tTOP = TOP_LEFT | TOP_RIGHT,\n\tBOTTOM = BOTTOM_LEFT | BOTTOM_RIGHT,\n\tLEFT = TOP_LEFT | BOTTOM_LEFT,\n\tRIGHT = TOP_RIGHT | BOTTOM_RIGHT,\n\tALL = TOP | BOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\n\nexport enum EShapeStrokeSide {\n\tNONE = 0,\n\tTOP = 1,\n\tRIGHT = 2,\n\tBOTTOM = 4,\n\tLEFT = 8,\n\tTOP_OR_LEFT = TOP | LEFT,\n\tTOP_OR_RIGHT = TOP | RIGHT,\n\tBOTTOM_OR_LEFT = BOTTOM | LEFT,\n\tBOTTOM_OR_RIGHT = BOTTOM | RIGHT,\n\tALL = TOP | RIGHT | BOTTOM | LEFT\n}\n\nexport interface EShapeStrokeLike {\n\tenable: boolean;\n\tcolor: number;\n\talpha: number;\n\twidth: number;\n\talign: number;\n\tside: EShapeStrokeSide;\n}\n\nexport interface EShapeStroke extends EShapeStrokeLike {\n\tcopy( target?: Partial<EShapeStrokeLike> ): void;\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number, align?: number, side?: EShapeStrokeSide ): void;\n\tclone(): EShapeStroke;\n\ttoObject(): EShapeStrokeLike;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeStrokeSide } from \"./e-shape-stroke\";\n\nexport class EShapeDefaults {\n\tstatic IS_EDIT_MODE: boolean = false;\n\n\tstatic FILL_COLOR: number = 0xffffff;\n\tstatic FILL_ALPHA: number = 0.5;\n\tstatic STROKE_COLOR: number = 0x4f4f4f;\n\tstatic STROKE_COLOR_DARK: number = 0x4f4f4f;\n\tstatic STROKE_COLOR_LIGHT: number = 0xd0d0d0;\n\tstatic STROKE_ALPHA: number = 1;\n\tstatic STROKE_WIDTH: number = 2;\n\tstatic STROKE_ALIGN: number = 0;\n\tstatic STROKE_SIDE: number = EShapeStrokeSide.ALL;\n\tstatic TEXT_VALUE: string = \"\";\n\tstatic TEXT_FAMILY: string = \"auto\";\n\tstatic TEXT_SIZE: number = 14;\n\tstatic CURSOR: string = \"\";\n\tstatic RADIUS: number = 0.25;\n\tstatic SIZE_X: number = 100;\n\tstatic SIZE_Y: number = 100;\n\tstatic ANTIALIAS_WEIGHT: number = 0.75 * (window.devicePixelRatio || 1);\n\tstatic HIGHLIGHT_COLOR: number = 0x1e87f0;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Point, Rectangle, Texture, utils } from \"pixi.js\";\nimport { DBaseState } from \"../d-base-state\";\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { EShapeAction } from \"./action/e-shape-action\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeCorner } from \"./e-shape-corner\";\nimport { EShapeEditor } from \"./e-shape-editor\";\nimport { EShapeFill } from \"./e-shape-fill\";\nimport { EShapeGradientLike } from \"./e-shape-gradient\";\nimport { EShapeLayout } from \"./e-shape-layout\";\nimport { EShapePoints } from \"./e-shape-points\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeRuntime } from \"./e-shape-runtime\";\nimport { EShapeStroke } from \"./e-shape-stroke\";\nimport { EShapeTag } from \"./e-shape-tag\";\nimport { EShapeText } from \"./e-shape-text\";\nimport { EShapeTransform } from \"./e-shape-transform\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\n\nexport enum EShapeCopyPart {\n\tNONE = 0,\n\tTRANSFORM = 1,\n\tSIZE = 2,\n\tSTYLE = 4,\n\tACTION = 8,\n\tPOINTS = 16,\n\tSTATE = 32,\n\tALL = TRANSFORM | SIZE | STYLE | ACTION | POINTS | STATE\n}\n\nexport interface EShape extends utils.EventEmitter {\n\tid: string;\n\treadonly type: EShapeType;\n\treadonly size: IPoint;\n\treadonly fill: EShapeFill;\n\treadonly stroke: EShapeStroke;\n\treadonly transform: EShapeTransform;\n\tradius: number;\n\tcorner: EShapeCorner;\n\treadonly points?: EShapePoints;\n\timage?: HTMLImageElement;\n\timageSrc?: string;\n\ttexture?: Texture;\n\tgradient?: EShapeGradientLike;\n\treadonly text: EShapeText;\n\treadonly tag: EShapeTag;\n\treadonly action: EShapeAction;\n\tcursor: string;\n\tvisible: boolean;\n\tinteractive: boolean;\n\tshortcut?: string;\n\ttitle?: string;\n\n\t// Hierarchy\n\tparent: EShapeContainer | EShape | null;\n\troot: EShape;\n\tchildren: EShape[];\n\tlayout?: EShapeLayout;\n\n\t// Working space\n\tindex: number;\t\t// A work space for sorting.\n\tselected: boolean;\n\treference: number;\t// Count of references from commands\n\n\t// Working space for the viewer\n\truntime?: EShapeRuntime;\n\n\t// Working space for the editor\n\teditor?: EShapeEditor;\n\n\t// Working space for the renderer\n\tuploaded?: EShapeUploaded;\n\n\t//\n\thovered: boolean;\n\tactive: boolean;\n\treadonly: boolean;\n\treadonly enabled: boolean;\n\tdisabled: boolean;\n\tdragging: boolean;\n\tfocused: boolean;\n\treadonly focusedin: boolean;\n\tunfocusable: boolean;\n\treadonly clicked: boolean;\n\treadonly pressed: boolean;\n\treadonly down: boolean;\n\treadonly up: boolean;\n\treadonly shadowed: boolean;\n\n\t//\n\ttoDirty(): void;\n\tattach( parent: EShapeContainer | EShape, at?: number ): this;\n\tdetach(): this;\n\tcopy( source: EShape ): this;\n\tcopy( source: EShape, part: EShapeCopyPart ): this;\n\tclone(): EShape;\n\tdestroy(): void;\n\n\t//\n\tgetState(): DBaseState;\n\tsetState( state: DBaseState, isOn: boolean ): this;\n\thasState( state: DBaseState ): boolean;\n\tfocus(): this;\n\tblur(): this;\n\n\t//\n\tonDblClick( e: MouseEvent ): void;\n\tonShortcut( e: KeyboardEvent ): void;\n\tonSizeChange(): void;\n\n\t// Action\n\tupdate( time: number ): void;\n\n\t// Transform\n\tupdateTransform(): void;\n\tdisallowOnTransformChange(): void;\n\tallowOnTransformChange( invokeOnTransformChange: boolean ): void;\n\tonTransformChange(): void;\n\tonChildTransformChange(): void;\n\n\t// Uploaded\n\tdisallowUploadedUpdate(): void;\n\tallowUploadedUpdate(): void;\n\tupdateUploaded(): void;\n\tupdateUploadedRecursively(): void;\n\n\t// Serialization\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem;\n\n\t// Hit test\n\tcontains( point: Point ): EShape | null;\n\tcontainsBBox( point: Point ): boolean;\n\n\t// Coordinate\n\ttoGlobal( position: IPoint, point: Point, skipUpdate?: boolean ): Point;\n\ttoLocal<T extends IPoint>(\n\t\tposition: IPoint,\n\t\tfrom?: DisplayObject,\n\t\tpoint?: T,\n\t\tskipUpdate?: boolean\n\t): T;\n\tgetBounds( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n\tgetBoundsInternal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n\tgetBoundsLocal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBaseState } from \"../d-base-state\";\nimport { DControllers } from \"../d-controllers\";\nimport { UtilKeyboardEvent } from \"../util/util-keyboard-event\";\nimport { EShapeActionRuntime } from \"./action/e-shape-action-runtime\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeFillLike } from \"./e-shape-fill\";\nimport { EShapeStrokeLike } from \"./e-shape-stroke\";\nimport { EShapeTextLike } from \"./e-shape-text\";\n\nexport enum EShapeRuntimeReset {\n\tNONE = 0,\n\tPOSITION_X = 1,\n\tPOSITION_Y = 2,\n\tPOSITION = POSITION_X | POSITION_Y,\n\tROTATION = 4,\n\tCOLOR_FILL = 8,\n\tCOLOR_STROKE = 16,\n\tCOLOR_FILL_AND_STROKE = COLOR_FILL | COLOR_STROKE,\n\tCOLOR_TEXT = 32,\n\tCOLOR_TEXT_OUTLINE = 64,\n\tCOLOR = COLOR_FILL | COLOR_STROKE | COLOR_TEXT | COLOR_TEXT_OUTLINE,\n\tVISIBILITY = 128,\n\tHEIGHT = 256,\n\tWIDTH = 512,\n\tSIZE = HEIGHT | WIDTH,\n\tTEXT = 1024,\n\tCURSOR = 2048\n}\n\nexport enum EShapeRuntimeState {\n\tNONE = 0,\n\tCHANGED = 1,\n\tCLICKED = 2,\n\tDOWN = 4,\n\tUP = 8,\n\tPRESSED = 16,\n\tPERSISTENT = PRESSED\n}\n\nexport class EShapeRuntime {\n\tx: number;\n\ty: number;\n\tsize: Point;\n\trotation: number;\n\tactions: EShapeActionRuntime[];\n\tfill: EShapeFillLike;\n\tstroke: EShapeStrokeLike;\n\ttext: EShapeTextLike;\n\tcursor: string;\n\n\treset: EShapeRuntimeReset;\n\twritten: EShapeRuntimeReset;\n\n\teffect: number;\n\n\tstate: EShapeRuntimeState;\n\n\tinteractive: boolean;\n\n\tconstructor( shape: EShape ) {\n\t\tconst transform = shape.transform;\n\t\tconst position = transform.position;\n\t\tthis.x = position.x;\n\t\tthis.y = position.y;\n\t\tthis.size = new Point( shape.size.x, shape.size.y );\n\t\tthis.rotation = transform.rotation;\n\t\tthis.actions = [];\n\t\tthis.fill = shape.fill.toObject();\n\t\tthis.stroke = shape.stroke.toObject();\n\t\tthis.text = shape.text.toObject();\n\t\tthis.cursor = shape.cursor;\n\t\tthis.reset = EShapeRuntimeReset.NONE;\n\t\tthis.written = EShapeRuntimeReset.NONE;\n\t\tthis.effect = NaN;\n\t\tthis.state = EShapeRuntimeState.NONE;\n\t\tthis.interactive = false;\n\t}\n\n\tonPointerClick( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tif( ! shape.disabled ) {\n\t\t\tif( ! (this.state & EShapeRuntimeState.CLICKED) ) {\n\t\t\t\tthis.state |= EShapeRuntimeState.CHANGED | EShapeRuntimeState.CLICKED;\n\t\t\t\tDApplications.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tonPointerDblClick( shape: EShape, e?: MouseEvent ): boolean {\n\t\treturn false;\n\t}\n\n\tonPointerOver( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tshape.hovered = true;\n\t}\n\n\tonPointerOut( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tshape.hovered = false;\n\t}\n\n\tonPointerDown( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tif( ! (this.state & EShapeRuntimeState.DOWN) ) {\n\t\t\tthis.state |= EShapeRuntimeState.CHANGED | EShapeRuntimeState.DOWN | EShapeRuntimeState.PRESSED;\n\t\t\tDApplications.update();\n\t\t}\n\t\tconst focusController = DControllers.getFocusController();\n\t\tfocusController.setFocused( focusController.findFocusableParent( shape ), true, true );\n\t}\n\n\tonPointerUp( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\tif( ! (this.state & EShapeRuntimeState.UP) ) {\n\t\t\tthis.state |= EShapeRuntimeState.CHANGED | EShapeRuntimeState.UP;\n\t\t\tthis.state &= ~EShapeRuntimeState.PRESSED;\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tonPointerMove( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\t//\n\t}\n\n\tonKeyDown( shape: EShape, e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onPointerDown( shape );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonKeyUp( shape: EShape, e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onPointerUp( shape );\n\t\t\tthis.onPointerClick( shape );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonStateChange( shape: EShape, newState: DBaseState, oldState: DBaseState ): void {\n\t\tthis.state |= EShapeRuntimeState.CHANGED;\n\t\tDApplications.update();\n\t}\n\n\tupdate( shape: EShape, time: number ): void {\n\t\tconst tag = shape.tag;\n\t\tconst isEffectTimeUp = ( this.effect <= time );\n\t\tif( tag.isChanged || (this.state & EShapeRuntimeState.CHANGED) || isEffectTimeUp ) {\n\t\t\tif( isEffectTimeUp ) {\n\t\t\t\tthis.effect = NaN;\n\t\t\t}\n\t\t\tshape.disallowUploadedUpdate();\n\t\t\tthis.onUpdate( shape, time );\n\t\t\tshape.allowUploadedUpdate();\n\t\t\tthis.state &= EShapeRuntimeState.PERSISTENT;\n\t\t\ttag.isChanged = false;\n\t\t}\n\t}\n\n\tprotected onUpdate( shape: EShape, time: number ): void {\n\t\tif( 0 < this.actions.length ) {\n\t\t\tthis.executeActions( shape, time );\n\t\t\tthis.resetUnwrittenProperties( shape );\n\t\t}\n\t}\n\n\tprotected executeActions( shape: EShape, time: number ): void {\n\t\tthis.written = EShapeRuntimeReset.NONE;\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].execute( shape, this, time );\n\t\t}\n\t}\n\n\tprotected resetUnwrittenProperties( shape: EShape ): void {\n\t\tconst target = (~this.written) & this.reset;\n\t\tif( target !== EShapeRuntimeReset.NONE ) {\n\t\t\tif( target & EShapeRuntimeReset.POSITION_X ) {\n\t\t\t\tshape.transform.position.x = this.x;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.POSITION_Y ) {\n\t\t\t\tshape.transform.position.y = this.y;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.VISIBILITY ) {\n\t\t\t\tshape.visible = true;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\tconst fill = this.fill;\n\t\t\t\tshape.fill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tfill.color,\n\t\t\t\t\tfill.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\tconst stroke = this.stroke;\n\t\t\t\tshape.stroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tstroke.color,\n\t\t\t\t\tstroke.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\tconst text = this.text;\n\t\t\t\tshape.text.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\ttext.color,\n\t\t\t\t\ttext.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\tconst outline = this.text.outline;\n\t\t\t\tshape.text.outline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\toutline.color,\n\t\t\t\t\toutline.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.HEIGHT ) {\n\t\t\t\tshape.size.y = this.size.y;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.WIDTH ) {\n\t\t\t\tshape.size.x = this.size.x;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.ROTATION ) {\n\t\t\t\tshape.transform.rotation = this.rotation;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.TEXT ) {\n\t\t\t\tshape.text.value = this.text.value;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.CURSOR ) {\n\t\t\t\tshape.cursor = this.cursor;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\n\nexport class EShapeAction {\n\tvalues: EShapeActionValue[];\n\n\tconstructor() {\n\t\tthis.values = [];\n\t}\n\n\tadd( value: EShapeActionValue, index?: number ): void {\n\t\tconst values = this.values;\n\t\tif( index != null ) {\n\t\t\tvalues.splice( index, 0, value );\n\t\t} else {\n\t\t\tvalues.push( value );\n\t\t}\n\t}\n\n\taddAll( values: EShapeActionValue[] ): void {\n\t\tconst sources = values;\n\t\tconst destinations = this.values;\n\t\tfor( let i = 0, imax = sources.length; i < imax; ++i) {\n\t\t\tdestinations.push( sources[i] );\n\t\t}\n\t}\n\n\tindexOf( target: EShapeActionValue ): number {\n\t\tconst values = this.values;\n\n\t\t// Instance-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value === target ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// Data-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value.isEquals( target ) ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tget( index: number ): EShapeActionValue | null {\n\t\tconst result = this.values[ index ];\n\t\tif( result != null ) {\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, value: EShapeActionValue ): void {\n\t\tthis.values[ index ] = value;\n\t}\n\n\tremove( index: number ): void {\n\t\tthis.values.splice( index, 1 );\n\t}\n\n\tclear(): void {\n\t\tthis.values.length = 0;\n\t}\n\n\tsize(): number {\n\t\treturn this.values.length;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tconst values = this.values;\n\t\tconst tmp = values[ indexB ];\n\t\tvalues[ indexB ] = values[ indexA ];\n\t\tvalues[ indexA ] = tmp;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number[] {\n\t\tconst result: number[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tresult.push( values[ i ].serialize( manager ) );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeTagValueRange, EShapeTagValueRangeLike } from \"./e-shape-tag-value-range\";\n\nexport enum EShapeTagValueOrder {\n\tASCENDING,\n\tDESCENDING\n}\n\nexport interface EShapeTagValueLike {\n\tid: string;\n\tinitial: string;\n\tformat: string;\n\trange: EShapeTagValueRangeLike;\n\tcapacity: number;\n\torder: EShapeTagValueOrder;\n}\n\nexport interface EShapeTagValueParent {\n\tisChanged: boolean;\n}\n\nexport interface EShapeTagValue extends EShapeTagValueLike {\n\tvalue: unknown;\n\treadonly nvalue: number;\n\ttime: number;\n\n\tvalues: unknown[];\n\ttimes: number[];\n\n\trange: EShapeTagValueRange;\n\tparent?: EShapeTagValueParent;\n\n\tformatter?: ( value: unknown ) => unknown;\n\n\tclear(): void;\n\tremove( index: number ): void;\n\tremoveAll( indices: number[] ): void;\n\tcopy( target: EShapeTagValue ): void;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\n\nexport enum EShapeTagValueRangeType {\n\tNONE = 0,\n\tFROM = 1,\n\tTO = 2,\n\tFROM_TO = 3\n}\n\nexport interface EShapeTagValueRangeLike {\n\ttype: EShapeTagValueRangeType;\n\tfrom: number;\n\tto: number;\n}\n\nexport interface EShapeTagValueRangeParent {\n\tisChanged: boolean;\n}\n\nexport interface EShapeTagValueRange extends EShapeTagValueRangeLike {\n\tparent?: EShapeTagValueRangeParent;\n\n\tset( from?: number | null, to?: number | null ): boolean;\n\tnormalize( value: number ): number;\n\tisEquals( target: EShapeTagValueRangeLike ): boolean;\n\tcopy( target: EShapeTagValueRangeLike ): void;\n\ttoObject(): EShapeTagValueRangeLike;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Matrix, Transform } from \"pixi.js\";\nimport { EShapeTransformParent } from \"./e-shape-transform-parent\";\n\nexport interface EShapeTransform extends Transform {\n\tinternalTransform: Matrix;\n\n\tposition: IPoint;\n\tpivot: IPoint;\n\trotation: number;\n\tskew: IPoint;\n\tscale: IPoint;\n\n\tgetLocalIdCurrent(): number;\n\tgetLocalId(): number;\n\tgetParentId(): number;\n\tgetWorldId(): number;\n}\n\nexport class EShapeTransformImpl extends Transform implements EShapeTransform {\n\tprotected _parent: EShapeTransformParent;\n\tinternalTransform: Matrix;\n\n\tconstructor( parent: EShapeTransformParent ) {\n\t\tsuper();\n\t\tthis.internalTransform = new Matrix();\n\t\tthis._parent = parent;\n\t}\n\n\tprotected onChange(): void {\n\t\t(Transform.prototype as any).onChange.call( this );\n\t\tthis._parent.onTransformChange();\n\t}\n\n\tprotected updateSkew(): void {\n\t\t(Transform.prototype as any).updateSkew.call( this );\n\t\tthis._parent.onTransformChange();\n\t}\n\n\tgetLocalIdCurrent(): number {\n\t\treturn (this as any)._currentLocalID;\n\t}\n\n\tgetLocalId(): number {\n\t\treturn (this as any)._localID;\n\t}\n\n\tgetParentId(): number {\n\t\treturn (this as any)._parentID;\n\t}\n\n\tgetWorldId(): number {\n\t\treturn (this as any)._worldID;\n\t}\n\n\tupdateTransform( parentTransform: Transform ): void {\n\t\tconst oldLocalId = (this as any)._currentLocalID;\n\t\tconst oldWorldId = (this as any)._worldID;\n\t\tsuper.updateTransform( parentTransform );\n\t\tconst newLocalId = (this as any)._currentLocalID;\n\t\tconst newWorldId = (this as any)._worldID;\n\t\tif( oldLocalId !== newLocalId ) {\n\t\t\tconst localTransform = this.localTransform;\n\t\t\tconst internalTransform = this.internalTransform;\n\t\t\tlocalTransform.copyTo( internalTransform );\n\t\t\tif( parentTransform instanceof EShapeTransformImpl ) {\n\t\t\t\tinternalTransform.prepend( parentTransform.internalTransform );\n\t\t\t}\n\t\t} else if( oldWorldId !== newWorldId ) {\n\t\t\tconst localTransform = this.localTransform;\n\t\t\tconst internalTransform = this.internalTransform;\n\t\t\tif( parentTransform instanceof EShapeTransformImpl ) {\n\t\t\t\tlocalTransform.copyTo( internalTransform ).prepend( parentTransform.internalTransform );\n\t\t\t\t(this as any)._currentLocalID += 1;\n\t\t\t\t(this as any)._localID = (this as any)._currentLocalID;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShapeGradientLike, EShapeGradientPointLike } from \"../e-shape-gradient\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\n\nexport class EShapeGradients {\n\tstatic serializeGradient( gradient: EShapeGradientLike ): string {\n\t\tconst points = gradient.points;\n\t\tlet result = `[${gradient.direction}`;\n\t\tfor( let i = 0, imax = points.length, j = 1; i < imax; i += 1, j += 3 ) {\n\t\t\tconst point = points[ i ];\n\t\t\tresult += `,${point.color},${point.alpha},${point.position}`;\n\t\t}\n\t\tresult += \"]\";\n\t\treturn result;\n\t}\n\n\tstatic parseGradient( target: string ): number[] | null {\n\t\ttry {\n\t\t\treturn JSON.parse( target ) as number[];\n\t\t} catch( e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic deserializeGradient( target: string ): EShapeGradientLike | undefined {\n\t\tconst parsed = this.parseGradient( target );\n\t\tif( parsed == null || parsed.length < 7 ) {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\tconst direction = parsed[ 0 ];\n\t\t\tconst points: EShapeGradientPointLike[] = [];\n\t\t\tfor( let i = 1, imax = parsed.length; i < imax; i += 3 ) {\n\t\t\t\tpoints.push({\n\t\t\t\t\tcolor: parsed[ i + 0 ],\n\t\t\t\t\talpha: parsed[ i + 1 ],\n\t\t\t\t\tposition: parsed[ i + 2 ]\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tpoints,\n\t\t\t\tdirection\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic toGradientId( gradient: EShapeGradientLike | undefined, manager: EShapeResourceManagerSerialization ): number {\n\t\tif( gradient != null ) {\n\t\t\tif( gradient.serialized == null ) {\n\t\t\t\tgradient.serialized = this.serializeGradient( gradient );\n\t\t\t}\n\t\t\treturn manager.add( gradient.serialized );\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic toGradientImageUrl( gradient: EShapeGradientLike ): string {\n\t\tconst direction = gradient.direction;\n\t\tconst points = gradient.points;\n\n\t\tlet stops = \"\";\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tconst point = points[ i ];\n\t\t\tconst color = UtilRgb.toCode( point.color );\n\t\t\tconst alpha = point.alpha;\n\t\t\tconst offset = point.position * 100;\n\t\t\tstops += `<stop offset=\"${offset}%\" stop-color=\"#${color}\" stop-opacity=\"${alpha}\" />`;\n\t\t}\n\n\t\tconst radian = direction * Math.PI / 180;\n\t\tconst dx = 0.5 * Math.cos( radian );\n\t\tconst dy = -0.5 * Math.sin( radian );\n\n\t\tconst url = \"data:image/svg+xml;base64,\" + btoa(\n\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">` +\n\t\t\t\t`<defs>` +\n\t\t\t\t\t`<linearGradient id=\"o2glkm3aeu2oio\" x1=\"${0.5 - dx}\" x2=\"${0.5 + dx}\" y1=\"${0.5 - dy}\" y2=\"${0.5 + dy}\">` +\n\t\t\t\t\t\tstops +\n\t\t\t\t\t`</linearGradient>` +\n\t\t\t\t`</defs>` +\n\t\t\t\t`<rect x=\"0\" y=\"0\" width=\"32\" height=\"32\" stroke=\"none\" fill=\"url(#o2glkm3aeu2oio)\" />` +\n\t\t\t`</svg>`\n\t\t);\n\n\t\treturn url;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Matrix, Point, Rectangle, Texture, Transform, utils } from \"pixi.js\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DControllers } from \"../../d-controllers\";\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeAction } from \"../action/e-shape-action\";\nimport { EShape, EShapeCopyPart } from \"../e-shape\";\nimport { EShapeContainer } from \"../e-shape-container\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeEditor } from \"../e-shape-editor\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeRuntime, EShapeRuntimeState } from \"../e-shape-runtime\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeTransform, EShapeTransformImpl } from \"../e-shape-transform\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploaded } from \"../e-shape-uploaded\";\nimport { EShapeGradients } from \"./e-shape-gradients\";\n\nexport abstract class EShapeBase extends utils.EventEmitter implements EShape {\n\tid: string;\n\treadonly type: EShapeType;\n\tabstract readonly size: IPoint;\n\tabstract readonly fill: EShapeFill;\n\tabstract readonly stroke: EShapeStroke;\n\treadonly transform: EShapeTransform;\n\tabstract radius: number;\n\tabstract corner: EShapeCorner;\n\tpoints?: EShapePoints;\n\timage?: HTMLImageElement;\n\timageSrc?: string;\n\ttexture?: Texture;\n\tabstract gradient?: EShapeGradientLike;\n\tabstract readonly text: EShapeText;\n\tabstract readonly tag: EShapeTag;\n\treadonly action: EShapeAction;\n\tabstract cursor: string;\n\tinteractive: boolean;\n\tshortcut?: string;\n\ttitle?: string;\n\tprotected _visible: boolean;\n\tprotected _onTransformChangeLock: number;\n\tprotected _isOnTransformChanged: boolean;\n\tprotected _uploadedUpdateLock: number;\n\tprotected _isUploadedUpdated: boolean;\n\tprotected _isUploadedUpdatedRecursively: boolean;\n\n\tprotected _bounds?: Rectangle;\n\tprotected _boundsTransformId: number;\n\tprotected _boundsInternal?: Rectangle;\n\tprotected _boundsInternalTransformId: number;\n\tprotected _boundsLocal?: Rectangle;\n\tprotected _boundsLocalTransformId: number;\n\n\tprotected _state: DBaseState;\n\tprotected _stateLocal: DBaseState;\n\n\t// Hierarchy\n\tparent: EShapeContainer | EShape | null;\n\tchildren: EShape[];\n\tlayout?: EShapeLayout;\n\n\t// Working space\n\tindex: number; // A work space for sorting.\n\tselected: boolean;\n\treference: number; // Count of references from commands\n\n\t// Working space for the viewer\n\truntime?: EShapeRuntime;\n\n\t// Working space for the editor\n\teditor?: EShapeEditor;\n\n\t// Working space for the renderer\n\tuploaded?: EShapeUploaded;\n\n\tconstructor( type: EShapeType ) {\n\t\tsuper();\n\t\tthis.id = \"\";\n\t\tthis.type = type;\n\t\tthis.transform = this.newTransform();\n\t\tthis._onTransformChangeLock = 0;\n\t\tthis._isOnTransformChanged = false;\n\t\tthis.action = new EShapeAction();\n\t\tthis._visible = true;\n\t\tthis._uploadedUpdateLock = 0;\n\t\tthis._isUploadedUpdated = false;\n\t\tthis._isUploadedUpdatedRecursively = false;\n\n\t\tthis._boundsTransformId = NaN;\n\t\tthis._boundsInternalTransformId = NaN;\n\t\tthis._boundsLocalTransformId = NaN;\n\n\t\tthis._state = this._stateLocal = DBaseState.UNFOCUSABLE;\n\t\tthis.interactive = false;\n\n\t\t//\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\t//\n\t\tthis.selected = false;\n\t\tthis.index = 0;\n\t\tthis.reference = 0;\n\t}\n\n\tprotected newTransform(): EShapeTransform {\n\t\treturn new EShapeTransformImpl( this );\n\t}\n\n\tonSizeChange(): void {\n\t\tthis._boundsTransformId = NaN;\n\t\tthis._boundsInternalTransformId = NaN;\n\t\tthis._boundsLocalTransformId = NaN;\n\n\t\tthis.onTransformChange_();\n\t\tthis.updateUploaded();\n\t}\n\n\tonTransformChange(): void {\n\t\tthis.onTransformChange_();\n\t\tthis.updateUploadedRecursively();\n\t}\n\n\tprotected onTransformChange_(): void {\n\t\tif( this._onTransformChangeLock === 0 ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isOnTransformChanged = true;\n\t\t}\n\t}\n\n\tdisallowOnTransformChange(): void {\n\t\tthis._onTransformChangeLock += 1;\n\t\tif( this._onTransformChangeLock === 1 ) {\n\t\t\tthis._isOnTransformChanged = false;\n\t\t}\n\t}\n\n\tallowOnTransformChange( invokeOnTransformChange: boolean ): void {\n\t\tthis._onTransformChangeLock -= 1;\n\t\tif( this._onTransformChangeLock === 0 ) {\n\t\t\tif( this._isOnTransformChanged ) {\n\t\t\t\tthis._isOnTransformChanged = false;\n\t\t\t\tif( invokeOnTransformChange ) {\n\t\t\t\t\tthis.onTransformChange();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonChildTransformChange(): void {\n\t\t//\n\t}\n\n\tdisallowUploadedUpdate(): void {\n\t\tthis._uploadedUpdateLock += 1;\n\t\tif( this._uploadedUpdateLock === 1 ) {\n\t\t\tthis._isUploadedUpdated = false;\n\t\t\tthis._isUploadedUpdatedRecursively = false;\n\t\t}\n\t}\n\n\tallowUploadedUpdate(): void {\n\t\tthis._uploadedUpdateLock -= 1;\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tif( this._isUploadedUpdatedRecursively ) {\n\t\t\t\tthis._isUploadedUpdatedRecursively = false;\n\t\t\t\tthis._isUploadedUpdated = false;\n\t\t\t\tthis.updateUploadedRecursively();\n\t\t\t} else if( this._isUploadedUpdated ) {\n\t\t\t\tthis._isUploadedUpdated = false;\n\t\t\t\tthis.updateUploaded();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateUploadedRecursively(): void {\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tthis.updateUploaded();\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tchildren[ i ].updateUploadedRecursively();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isUploadedUpdatedRecursively = true;\n\t\t}\n\t}\n\n\tupdateUploaded(): void {\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tconst uploaded = this.uploaded;\n\t\t\tif( uploaded != null ) {\n\t\t\t\tuploaded.update( this );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isUploadedUpdated = true;\n\t\t}\n\t}\n\n\t//\n\tget root(): EShape {\n\t\tlet root: EShape = this;\n\t\twhile( root.parent instanceof EShapeBase ) {\n\t\t\troot = root.parent;\n\t\t}\n\t\treturn root;\n\t}\n\n\t//\n\tget visible(): boolean {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof EShapeBase ) {\n\t\t\treturn parent.visible && this._visible;\n\t\t} else {\n\t\t\treturn this._visible;\n\t\t}\n\t}\n\n\tset visible( visible: boolean ) {\n\t\tif( this._visible !== visible ) {\n\t\t\tthis._visible = visible;\n\t\t\tthis.updateUploadedRecursively();\n\t\t}\n\t}\n\n\t//\n\tabstract clone(): EShape;\n\n\t//\n\ttoDirty() {\n\t\tconst parent = this.parent;\n\t\tif( parent != null ) {\n\t\t\tparent.toDirty();\n\t\t}\n\t}\n\n\t// Hierarchy\n\tattach( parent: EShapeContainer | EShape, at?: number ): this {\n\t\tthis.detach();\n\t\tthis.parent = parent;\n\t\tconst children = parent.children;\n\t\tif( at != null && 0 <= at && at < children.length ) {\n\t\t\tchildren.splice( at, 0, this );\n\t\t} else {\n\t\t\tchildren.push( this );\n\t\t}\n\t\tthis.uploaded = undefined;\n\t\tparent.onChildTransformChange();\n\t\tparent.toDirty();\n\t\treturn this;\n\t}\n\n\tdetach(): this {\n\t\tconst parent = this.parent;\n\t\tif( parent != null ) {\n\t\t\tthis.parent = null;\n\t\t\tthis.uploaded = undefined;\n\t\t\tconst children = parent.children;\n\t\t\tconst index = children.indexOf( this );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tchildren.splice( index, 1 );\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t// Transform\n\tupdateTransform() {\n\t\tconst parent = this.parent;\n\t\tif (parent != null) {\n\t\t\tparent.updateTransform();\n\t\t\tthis.transform.updateTransform(parent.transform);\n\t\t} else {\n\t\t\tthis.transform.updateTransform((Transform as any).IDENTITY);\n\t\t}\n\t}\n\n\t// Serialization\n\tserializeChildren( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem[] {\n\t\tconst children = this.children;\n\t\tconst childrenSerialized = [];\n\t\tfor (let i = 0, imax = children.length; i < imax; ++i) {\n\t\t\tconst child = children[i];\n\t\t\tchildrenSerialized.push(child.serialize(manager));\n\t\t}\n\t\treturn childrenSerialized;\n\t}\n\n\tserializeImage( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst image = this.image;\n\t\treturn (image != null ? manager.add( image.src ) : -1);\n\t}\n\n\tserializeGradient( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn EShapeGradients.toGradientId( this.gradient, manager );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem {\n\t\tconst transform = this.transform;\n\t\tconst position = transform.position;\n\t\tconst pivot = transform.pivot;\n\t\tconst size = this.size;\n\t\tconst shortcut = this.shortcut;\n\t\tconst shortcutId = ( shortcut != null ? manager.add( shortcut ) : -1 );\n\t\tconst title = this.title;\n\t\tconst titleId = ( title != null ? manager.add( title ) : -1 );\n\t\treturn [\n\t\t\tthis.type,\n\t\t\tmanager.add(this.id),\n\t\t\tposition.x,\n\t\t\tposition.y,\n\t\t\tsize.x,\n\t\t\tsize.y,\n\t\t\ttransform.rotation,\n\t\t\ttransform.skew.x,\n\t\t\tthis.fill.serialize( manager ),\n\t\t\tthis.stroke.serialize( manager ),\n\t\t\tmanager.add( this.cursor.trim() ),\n\t\t\tthis.text.serialize( manager ),\n\t\t\tthis.tag.serialize( manager ),\n\t\t\tthis.radius,\n\t\t\tthis.corner,\n\t\t\t-1,\n\t\t\t-1,\n\t\t\tthis.action.serialize( manager ),\n\t\t\tthis.serializeImage( manager ),\n\t\t\tthis.serializeGradient( manager ),\n\t\t\tthis.serializeChildren( manager ),\n\t\t\tpivot.x,\n\t\t\tpivot.y,\n\t\t\t( this.interactive ? 1 : 0 ) | ( this.unfocusable ? 2 : 0 ),\n\t\t\tshortcutId,\n\t\t\ttitleId\n\t\t];\n\t}\n\n\t// Hit test\n\tcontains( point: Point ): EShape | null {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this.size;\n\t\tconst sx = 0.5 * size.x;\n\t\tconst sy = 0.5 * size.y;\n\t\tconst pivot = this.transform.pivot;\n\t\tconst dx = x - pivot.x;\n\t\tconst dy = y - pivot.y;\n\t\tconst stroke = this.stroke;\n\t\tconst s = stroke.width * stroke.align;\n\t\tif( 0 <= sx ) {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\tif( this.containsAbs(+dx, +dy, +sx + s, +sy + s) ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( this.containsAbs(+dx, -dy, +sx + s, -sy + s) ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\tif( this.containsAbs(-dx, +dy, -sx + s, +sy + s) ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( this.containsAbs(-dx, -dy, -sx + s, -sy + s) ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn this.containsText( x, y, point ) ||\n\t\t\tthis.containsChildren( x, y, point );\n\t}\n\n\tprotected containsText( x: number, y: number, work: Point ): EShape | null {\n\t\tconst text = this.text;\n\t\tconst textAtlas = text.atlas;\n\t\tif( textAtlas != null ) {\n\t\t\tconst textWorld = text.world;\n\t\t\tif( textWorld != null ) {\n\t\t\t\twork.set( x, y );\n\t\t\t\tthis.transform.internalTransform.apply( work, work );\n\t\t\t\tconst tx = work.x - textWorld[ 0 ];\n\t\t\t\tconst ty = work.y - textWorld[ 1 ];\n\t\t\t\tconst th = textWorld[ 2 ] * tx + textWorld[ 3 ] * ty;\n\t\t\t\tconst tv = textWorld[ 4 ] * tx + textWorld[ 5 ] * ty;\n\t\t\t\tif( 0 <= th && th <= textWorld[ 6 ] && 0 <= tv && tv <= textWorld[ 7 ] ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected containsChildren( x: number, y: number, work: Point ): EShape | null {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\twork.set( x, y );\n\t\t\tchild.updateTransform();\n\t\t\tchild.transform.localTransform.applyInverse( work, work );\n\t\t\tconst childResult = child.contains( work );\n\t\t\tif( childResult != null ) {\n\t\t\t\tif( this.shadowed ) {\n\t\t\t\t\treturn this;\n\t\t\t\t} else {\n\t\t\t\t\treturn childResult;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontainsBBox( point: Point ): boolean {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this.size;\n\t\tconst sx = 0.5 * size.x;\n\t\tconst sy = 0.5 * size.y;\n\t\tconst pivot = this.transform.pivot;\n\t\tconst dx = x - pivot.x;\n\t\tconst dy = y - pivot.y;\n\t\tconst stroke = this.stroke;\n\t\tconst s = stroke.width * stroke.align;\n\t\tif( 0 <= sx ) {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\treturn this.containsAbsBBox(+dx, +dy, +sx + s, +sy + s);\n\t\t\t} else {\n\t\t\t\treturn this.containsAbsBBox(+dx, -dy, +sx + s, -sy + s);\n\t\t\t}\n\t\t} else {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\treturn this.containsAbsBBox(-dx, +dy, -sx + s, +sy + s);\n\t\t\t} else {\n\t\t\t\treturn this.containsAbsBBox(-dx, -dy, -sx + s, -sy + s);\n\t\t\t}\n\t\t}\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn this.containsAbsBBox( x, y, ax, ay );\n\t}\n\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn (-ax <= x && x <= +ax && -ay <= y && y <= +ay);\n\t}\n\n\tselect( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\t//\n\ttoGlobal( position: IPoint, point: Point, skipUpdate?: boolean ): Point {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tpoint.copyFrom( position );\n\t\tthis.transform.worldTransform.apply( point, point );\n\t\treturn point;\n\t}\n\n\ttoLocal<T extends IPoint>(\n\t\tposition: IPoint,\n\t\tfrom?: DisplayObject,\n\t\tpoint?: T,\n\t\tskipUpdate?: boolean\n\t): T {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tif( point === undefined ) {\n\t\t\tpoint = new Point() as any as T;\n\t\t}\n\t\tpoint.copyFrom( position );\n\t\tthis.transform.worldTransform.applyInverse( point as any, point as any );\n\t\treturn point;\n\t}\n\n\tgetBounds( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst bounds = this._bounds = ( this._bounds || new Rectangle() );\n\t\tconst worldId = this.transform.getWorldId();\n\t\tif( worldId !== this._boundsTransformId ) {\n\t\t\tthis._boundsTransformId = worldId;\n\t\t\tthis.getBounds_( this.transform.worldTransform, work, bounds );\n\t\t}\n\t\tresult.copyFrom( bounds );\n\t\treturn result;\n\t}\n\n\tgetBoundsInternal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst boundsInternal = this._boundsInternal = ( this._boundsInternal || new Rectangle() );\n\t\tconst currentLocalId = this.transform.getLocalIdCurrent();\n\t\tif( currentLocalId !== this._boundsInternalTransformId ) {\n\t\t\tthis._boundsInternalTransformId = currentLocalId;\n\t\t\tthis.getBounds_( this.transform.internalTransform, work, boundsInternal );\n\t\t}\n\t\tresult.copyFrom( boundsInternal );\n\t\treturn result;\n\t}\n\n\tgetBoundsLocal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst boundsLocal = this._boundsLocal = ( this._boundsLocal || new Rectangle() );\n\t\tconst currentLocalId = this.transform.getLocalIdCurrent();\n\t\tif( currentLocalId !== this._boundsLocalTransformId ) {\n\t\t\tthis._boundsLocalTransformId = currentLocalId;\n\t\t\tthis.getBounds_( this.transform.localTransform, work, boundsLocal );\n\t\t}\n\t\tresult.copyFrom( boundsLocal );\n\t\treturn result;\n\t}\n\n\tprotected getBoundsSize(): IPoint {\n\t\treturn this.size;\n\t}\n\n\tprotected getBounds_( transform: Matrix, work: Point, result: Rectangle ): Rectangle {\n\t\tconst pivot = this.transform.pivot;\n\t\tconst px = pivot.x;\n\t\tconst py = pivot.y;\n\t\tconst size = this.getBoundsSize();\n\t\tconst sx = 0.5 * size.x;\n\t\tconst sy = 0.5 * size.y;\n\n\t\tconst a = transform.a;\n\t\tconst b = transform.b;\n\t\tconst c = transform.c;\n\t\tconst d = transform.d;\n\n\t\tlet x = -sx + px;\n\t\tlet y = -sy + py;\n\t\tconst x0 = a * x + c * y;\n\t\tconst y0 = b * x + d * y;\n\n\t\tx = +sx + px;\n\t\ty = -sy + py;\n\t\tconst x1 = a * x + c * y;\n\t\tconst y1 = b * x + d * y;\n\n\t\tx = -sx + px;\n\t\ty = +sy + py;\n\t\tconst x2 = a * x + c * y;\n\t\tconst y2 = b * x + d * y;\n\n\t\tx = +sx + px;\n\t\ty = +sy + py;\n\t\tconst x3 = a * x + c * y;\n\t\tconst y3 = b * x + d * y;\n\n\t\tconst xmin = Math.min( x0, x1, x2, x3 );\n\t\tconst ymin = Math.min( y0, y1, y2, y3 );\n\t\tconst xmax = Math.max( x0, x1, x2, x3 );\n\t\tconst ymax = Math.max( y0, y1, y2, y3 );\n\t\tresult.x = xmin + transform.tx;\n\t\tresult.y = ymin + transform.ty;\n\t\tresult.width = xmax - xmin;\n\t\tresult.height = ymax - ymin;\n\t\treturn result;\n\t}\n\n\t//\n\tdestroy(): void {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\t}\n\n\t//\n\tprotected updateState(): void {\n\t\tconst parent = this.parent;\n\t\tconst stateLocal = this._stateLocal;\n\t\tconst newState = ( parent instanceof EShapeBase ?\n\t\t\tthis.mergeState( stateLocal, parent.getState() ) :\n\t\t\tstateLocal\n\t\t);\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tprotected mergeState( stateLocal: DBaseState, stateParent: DBaseState ): DBaseState {\n\t\treturn stateLocal | (stateParent & DBaseState.DISABLED) |\n\t\t\t(stateParent & (DBaseState.FOCUSED | DBaseState.FOCUSED_IN) ? DBaseState.FOCUSED_IN : DBaseState.NONE);\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ) {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\truntime.onStateChange( this, newState, oldState );\n\t\t}\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof EShapeBase ) {\n\t\t\t\tchild.onParentStateChange( newState, oldState );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onParentStateChange( newStateParent: number, oldStateParent: number ) {\n\t\tconst newState = this.mergeState( this._stateLocal, newStateParent );\n\t\tconst oldState = this._state;\n\t\tif( oldState !== newState ) {\n\t\t\tthis._state = newState;\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tgetState(): DBaseState {\n\t\treturn this._state;\n\t}\n\n\tsetState( state: DBaseState, isOn: boolean ): this {\n\t\tif( DBaseStates.is( this._stateLocal, state ) !== isOn ) {\n\t\t\tif( isOn ) {\n\t\t\t\tthis._stateLocal |= state;\n\t\t\t} else {\n\t\t\t\tthis._stateLocal &= ~state;\n\t\t\t}\n\t\t\tthis.updateState();\n\t\t}\n\t\treturn this;\n\t}\n\n\thasState( state: DBaseState ): boolean {\n\t\treturn DBaseStates.is( this._state, state );\n\t}\n\n\tfocus(): this {\n\t\tthis.focused = true;\n\t\treturn this;\n\t}\n\n\tblur(): this {\n\t\tthis.focused = false;\n\t\treturn this;\n\t}\n\n\tget hovered(): boolean {\n\t\treturn this.hasState( DBaseState.HOVERED );\n\t}\n\n\tset hovered( isHovered: boolean ) {\n\t\tthis.setState( DBaseState.HOVERED, isHovered );\n\t}\n\n\tget active(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE );\n\t}\n\n\tset active( isActive: boolean ) {\n\t\tthis.setState( DBaseState.ACTIVE, isActive );\n\t}\n\n\tget readonly(): boolean {\n\t\treturn this.hasState( DBaseState.READ_ONLY );\n\t}\n\n\tset readonly( isReadOnly: boolean ) {\n\t\tthis.setState( DBaseState.READ_ONLY, isReadOnly );\n\t}\n\n\tget enabled(): boolean {\n\t\treturn ! this.hasState( DBaseState.DISABLED );\n\t}\n\n\tget disabled(): boolean {\n\t\treturn this.hasState( DBaseState.DISABLED );\n\t}\n\n\tset disabled( isDisabled: boolean ) {\n\t\tthis.setState( DBaseState.DISABLED, isDisabled );\n\t}\n\n\tget dragging(): boolean {\n\t\treturn this.hasState( DBaseState.DRAGGING );\n\t}\n\n\tset dragging( isDragging: boolean ) {\n\t\tthis.setState( DBaseState.DRAGGING, isDragging );\n\t}\n\n\tget focused(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED );\n\t}\n\n\tset focused( focused: boolean ) {\n\t\tif( this.focused !== focused ) {\n\t\t\tDControllers.getFocusController().setFocused( this, focused, false );\n\t\t}\n\t}\n\n\tget focusedin(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED | DBaseState.FOCUSED_IN );\n\t}\n\n\tget unfocusable(): boolean {\n\t\treturn this.hasState( DBaseState.UNFOCUSABLE );\n\t}\n\n\tset unfocusable( unforcusable: boolean ) {\n\t\tthis.setState( DBaseState.UNFOCUSABLE, unforcusable );\n\t}\n\n\tget clicked(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.CLICKED) );\n\t}\n\n\tget pressed(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.PRESSED) );\n\t}\n\n\tget down(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.DOWN) );\n\t}\n\n\tget up(): boolean {\n\t\tconst runtime = this.runtime;\n\t\treturn !! ( runtime && (runtime.state & EShapeRuntimeState.UP) );\n\t}\n\n\tget shadowed(): boolean {\n\t\treturn false;\n\t}\n\n\tonDblClick( e: MouseEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onPointerDblClick( this );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShortcut( e: KeyboardEvent ): void {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onPointerClick( this );\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onKeyDown( this, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\treturn runtime.onKeyUp( this, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\t//\n\tupdate( time: number ): void {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime != null ) {\n\t\t\truntime.update( this, time );\n\t\t}\n\t}\n\n\tupdateRecursively( time: number ): void {\n\t\tthis.update( time );\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].update( time );\n\t\t}\n\t}\n\n\tcopy( source: EShape, part: EShapeCopyPart = EShapeCopyPart.ALL ): this {\n\t\tthis.id = source.id;\n\t\tif( (part & EShapeCopyPart.TRANSFORM) !== 0 ) {\n\t\t\tconst transform = this.transform;\n\t\t\tconst sourceTransform = source.transform;\n\t\t\ttransform.position.copyFrom( sourceTransform.position );\n\t\t\ttransform.rotation = sourceTransform.rotation;\n\t\t\ttransform.skew.copyFrom( sourceTransform.skew );\n\t\t\ttransform.pivot.copyFrom( sourceTransform.pivot );\n\t\t\ttransform.scale.copyFrom( sourceTransform.scale );\n\t\t}\n\t\tif( (part & EShapeCopyPart.SIZE) !== 0 ) {\n\t\t\tthis.size.copyFrom( source.size );\n\t\t}\n\t\tif( (part & EShapeCopyPart.STYLE) !== 0 ) {\n\t\t\tthis.fill.copy( source.fill );\n\t\t\tthis.stroke.copy( source.stroke );\n\t\t\tthis.tag.copy( source.tag );\n\t\t\tthis.text.copy( source.text );\n\t\t\tthis.radius = source.radius;\n\t\t\tthis.corner = source.corner;\n\t\t\tif (this.image == null) {\n\t\t\t\tthis.image = source.image;\n\t\t\t}\n\t\t}\n\t\tif( (part & EShapeCopyPart.ACTION) !== 0 ) {\n\t\t\tthis.action.addAll( source.action.values );\n\t\t\tthis.interactive = source.interactive;\n\t\t\tthis.cursor = source.cursor;\n\t\t\tthis.shortcut = source.shortcut;\n\t\t}\n\t\tif( (part & EShapeCopyPart.POINTS) !== 0 ) {\n\t\t\tconst sourcePoints = source.points;\n\t\t\tif( sourcePoints != null ) {\n\t\t\t\tconst points = this.points;\n\t\t\t\tif( points != null ) {\n\t\t\t\t\tpoints.copy( sourcePoints );\n\t\t\t\t} else {\n\t\t\t\t\tthis.points = sourcePoints.clone( this );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( (part & EShapeCopyPart.STATE) !== 0 ) {\n\t\t\tthis.setState( source.getState(), true );\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeFillImplParent } from \"./e-shape-fill-impl-parent\";\n\nexport class EShapeFillImpl implements EShapeFill {\n\tprotected _parent: EShapeFillImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\n\tconstructor( parent: EShapeFillImplParent, enable: boolean, color: number, alpha: number ) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target: EShapeFillLike ): void {\n\t\tthis.set( target.enable, target.color, target.alpha );\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeFill {\n\t\treturn new EShapeFillImpl( this._parent, this._enable, this._color, this._alpha );\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst stringified = `[${this._enable ? 1 : 0},${this._color},${this._alpha}]`;\n\t\treturn manager.add( stringified );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.fills.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.fills.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike, EShapeStrokeSide } from \"../e-shape-stroke\";\nimport { EShapeStrokeImplParent } from \"./e-shape-stroke-impl-parent\";\n\nexport class EShapeStrokeImpl implements EShapeStroke {\n\tprotected _parent: EShapeStrokeImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _width: number;\n\tprotected _align: number;\n\tprotected _side: EShapeStrokeSide;\n\n\tconstructor(\n\t\tparent: EShapeStrokeImplParent,\n\t\tenable: boolean, color: number, alpha: number,\n\t\twidth: number, align: number, side: EShapeStrokeSide\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._width = width;\n\t\tthis._align = align;\n\t\tthis._side = side;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget align(): number {\n\t\treturn this._align;\n\t}\n\n\tset align( align: number ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\treturn this._side;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\tif( this._side !== side ) {\n\t\t\tthis._side = side;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha, target.width, target.align, target.side );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number, align?: number, side?: EShapeStrokeSide ) {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( width !== undefined && this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( align !== undefined && this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( side !== undefined && this._side !== side ) {\n\t\t\tthis._side = side;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeStroke {\n\t\treturn new EShapeStrokeImpl(\n\t\t\tthis._parent,\n\t\t\tthis._enable, this._color, this._alpha,\n\t\t\tthis._width, this._align, this._side\n\t\t);\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\twidth: this._width,\n\t\t\talign: this._align,\n\t\t\tside: this._side\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst enable = this._enable ? 1 : 0;\n\t\tconst serialized = `[${enable},${this._color},${this._alpha},${this._width},${this._align},${this._side}]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.strokes.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ],\n\t\t\t\t\tparsed[ 3 ],\n\t\t\t\t\tparsed[ 4 ],\n\t\t\t\t\tparsed[ 5 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.strokes.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ],\n\t\t\t\t\tdeserialized[ 3 ],\n\t\t\t\t\tdeserialized[ 4 ],\n\t\t\t\t\tdeserialized[ 5 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport {\n\tEShapeTagValueRange, EShapeTagValueRangeLike, EShapeTagValueRangeParent, EShapeTagValueRangeType\n} from \"../e-shape-tag-value-range\";\n\nexport class EShapeTagValueRangeImpl implements EShapeTagValueRange {\n\tprotected _type: EShapeTagValueRangeType;\n\tprotected _from: number;\n\tprotected _to: number;\n\tparent?: EShapeTagValueRangeParent;\n\n\tconstructor() {\n\t\tthis._type = EShapeTagValueRangeType.NONE;\n\t\tthis._from = 0;\n\t\tthis._to = 1;\n\t}\n\n\tget type(): EShapeTagValueRangeType {\n\t\treturn this._type;\n\t}\n\n\tset type( type: EShapeTagValueRangeType ) {\n\t\tif( this._type !== type ) {\n\t\t\tthis._type = type;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget from(): number {\n\t\treturn this._from;\n\t}\n\n\tset from( from: number ) {\n\t\tif( this._from !== from ) {\n\t\t\tthis._from = from;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget to(): number {\n\t\treturn this._to;\n\t}\n\n\tset to( to: number ) {\n\t\tif( this._to !== to ) {\n\t\t\tthis._to = to;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tset( from?: number | null, to?: number | null ): boolean {\n\t\tlet result = false;\n\t\tif( from !== undefined && to !== undefined ) {\n\t\t\tif( from !== null && to !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) | EShapeTagValueRangeType.TO;\n\t\t\t\tif( this._type !== type || this._from !== from || this._to !== to ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else if( from !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) & (~EShapeTagValueRangeType.TO);\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else if( to !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.TO) & (~EShapeTagValueRangeType.FROM);\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~(EShapeTagValueRangeType.TO | EShapeTagValueRangeType.FROM));\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( from !== undefined ) {\n\t\t\tif( from !== null ) {\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.FROM;\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.FROM);\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( to !== undefined ) {\n\t\t\tif( to !== null ) {\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.TO;\n\t\t\t\tif( this._type !== type || this._to !== to ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.TO);\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( result ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tnormalize( value: number ): number {\n\t\tconst type = this._type;\n\t\tconst from = this._from;\n\t\tconst to = this._to;\n\t\tswitch( type ) {\n\t\tcase EShapeTagValueRangeType.FROM_TO:\n\t\t\treturn (value - from) / (to - from);\n\t\tcase EShapeTagValueRangeType.FROM:\n\t\t\treturn value - from;\n\t\tcase EShapeTagValueRangeType.TO:\n\t\t\treturn to - value;\n\t\tcase EShapeTagValueRangeType.NONE:\n\t\tdefault:\n\t\t\treturn value;\n\t\t}\n\t}\n\n\tisEquals( target: EShapeTagValueRangeLike ): boolean {\n\t\treturn (\n\t\t\tthis._type === target.type &&\n\t\t\tthis._from === target.from &&\n\t\t\tthis._to === target.to\n\t\t);\n\t}\n\n\tcopy( target: EShapeTagValueRangeLike ): this {\n\t\treturn this.copy_( target.type, target.from, target.to );\n\t}\n\n\tprotected copy_( type: EShapeTagValueRangeType, from: number, to: number ): this {\n\t\tlet isChanged = false;\n\n\t\tif( this._type !== type ) {\n\t\t\tthis._type = type;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._from !== from ) {\n\t\t\tthis._from = from;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._to !== to ) {\n\t\t\tthis._to = to;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTagValueRangeLike {\n\t\treturn {\n\t\t\ttype: this.type,\n\t\t\tfrom: this.from,\n\t\t\tto: this.to\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst serialized = `[${this._type},${this._from},${this._to}]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.ranges.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.copy_(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.ranges.set( target, deserialized );\n\t\t\t\tthis.copy_(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DeepPartial } from \"../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"./e-shape-text-align\";\nimport { EShapeTextDirection } from \"./e-shape-text-direction\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"./e-shape-text-offset\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"./e-shape-text-outline\";\n\nexport enum EShapeTextWeight {\n\tNORMAL,\n\tBOLD\n}\n\nexport enum EShapeTextStyle {\n\tNORMAL,\n\tITALIC\n}\n\nexport interface EShapeTextLike {\n\tvalue: string;\n\tcolor: number;\n\talpha: number;\n\tfamily: string;\n\tsize: number;\n\tweight: EShapeTextWeight;\n\talign: EShapeTextAlignLike;\n\toffset: EShapeTextOffsetLike;\n\tstyle: EShapeTextStyle;\n\toutline: EShapeTextOutlineLike;\n\tspacing: EShapeTextOffsetLike;\n\tdirection: EShapeTextDirection;\n\tpadding: EShapeTextOffsetLike;\n\tclipping: boolean;\n}\n\nexport interface EShapeTextAtlasCharacter {\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tadvance: number;\n\torigin: {\n\t\tx: number,\n\t\ty: number\n\t};\n}\n\nexport interface EShapeTextAtlasCharacters {\n\t[ character: string ]: EShapeTextAtlasCharacter;\n}\n\nexport interface EShapeTextAtlas {\n\twidth: number;\n\theight: number;\n\tfont: {\n\t\tsize: number;\n\t};\n\tcharacters: EShapeTextAtlasCharacters;\n}\n\nexport interface EShapeText extends EShapeTextLike {\n\tenable: boolean;\n\n\talign: EShapeTextAlign;\n\toffset: EShapeTextOffset;\n\toutline: EShapeTextOutline;\n\tspacing: EShapeTextOffset;\n\tpadding: EShapeTextOffset;\n\n\ttexture?: Texture;\t\t// Used for rendering and updated when rendered\n\tatlas?: EShapeTextAtlas;\t// Used for rendering and updated when rendered\n\tworld?: Float32Array;\t\t// Updated when rendered\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this;\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this;\n\ttoObject(): EShapeTextLike;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextAlignHorizontal {\n\tLEFT,\n\tCENTER,\n\tRIGHT,\n\tOUTSIDE_LEFT,\n\tOUTSIDE_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextAlignVertical {\n\tTOP,\n\tMIDDLE,\n\tBOTTOM,\n\tOUTSIDE_TOP,\n\tOUTSIDE_BOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextDirection {\n\tLEFT_TO_RIGHT,\n\tTOP_TO_BOTTOM,\n\tBOTTOM_TO_TOP\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedTagValue } from \"../../d-diagram-serialized\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTagValue, EShapeTagValueOrder, EShapeTagValueParent } from \"../e-shape-tag-value\";\nimport { EShapeTagValueRange } from \"../e-shape-tag-value-range\";\nimport { EShapeTagValueRangeImpl } from \"./e-shape-tag-value-range-impl\";\n\nconst INDEX_COMPARATOR = ( a: number, b: number ): number => {\n\treturn a - b;\n};\n\nexport class EShapeTagValueImpl implements EShapeTagValue {\n\tid: string;\n\tinitial: string;\n\tformat: string;\n\trange: EShapeTagValueRange;\n\tprotected _value: unknown;\n\tprotected _time: number;\n\n\tprotected _values: unknown[] | undefined;\n\tprotected _times: number[] | undefined;\n\tprotected _capacity: number;\n\tprotected _order: EShapeTagValueOrder;\n\n\tprotected _parent?: EShapeTagValueParent;\n\n\tformatter?: ( value: unknown ) => unknown;\n\n\tconstructor() {\n\t\tthis.id = \"\";\n\t\tthis.initial = \"\";\n\t\tthis.format = \"\";\n\t\tthis.range = new EShapeTagValueRangeImpl();\n\t\tthis._value = 0;\n\t\tthis._time = 0;\n\t\tthis._capacity = 0;\n\t\tthis._order = EShapeTagValueOrder.ASCENDING;\n\t}\n\n\tget parent(): EShapeTagValueParent | undefined {\n\t\treturn this._parent;\n\t}\n\n\tset parent( parent: EShapeTagValueParent | undefined ) {\n\t\tif( this._parent !== parent ) {\n\t\t\tthis._parent = parent;\n\t\t\tthis.range.parent = parent;\n\t\t}\n\t}\n\n\tget value(): unknown {\n\t\treturn this._value;\n\t}\n\n\tset value( newValue: unknown ) {\n\t\tconst formatter = this.formatter;\n\t\tif( formatter != null ) {\n\t\t\tnewValue = formatter( newValue );\n\t\t}\n\n\t\tconst capacity = this._capacity;\n\t\tif( capacity <= 0 ) {\n\t\t\tif( this._value !== newValue ) {\n\t\t\t\tthis._value = newValue;\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tlet values = this._values;\n\t\t\tif( values == null ) {\n\t\t\t\tvalues = [];\n\t\t\t\tthis._values = values;\n\t\t\t}\n\n\t\t\t// Update the value\n\t\t\tthis._value = newValue;\n\n\t\t\t// Update the values\n\t\t\tconst order = this._order;\n\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\tvalues.push( newValue );\n\t\t\t} else {\n\t\t\t\tvalues.unshift( newValue );\n\t\t\t}\n\n\t\t\t// Remove the unnecessary values\n\t\t\tconst count = values.length - capacity;\n\t\t\tif( 0 < count ) {\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Tell the parent it's changed\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget nvalue(): number {\n\t\treturn this.range.normalize( this._value as number );\n\t}\n\n\tget values(): unknown[] {\n\t\tlet result = this._values;\n\t\tif( result == null ) {\n\t\t\tresult = [];\n\t\t\tthis._values = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tset values( newValues: unknown[] ) {\n\t\tif( 0 < newValues.length ) {\n\t\t\tconst capacity = this._capacity;\n\t\t\tif( capacity <= 0 ) {\n\t\t\t\tlet newValue = newValues[ newValues.length - 1 ];\n\t\t\t\tconst formatter = this.formatter;\n\t\t\t\tif( formatter != null ) {\n\t\t\t\t\tnewValue = formatter( newValue );\n\t\t\t\t}\n\t\t\t\tif( this._value !== newValue ) {\n\t\t\t\t\tthis._value = newValue;\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif( parent != null ) {\n\t\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet values = this._values;\n\t\t\t\tif( values == null ) {\n\t\t\t\t\tvalues = [];\n\t\t\t\t\tthis._values = values;\n\t\t\t\t}\n\n\t\t\t\tconst order = this._order;\n\t\t\t\tconst formatter = this.formatter;\n\t\t\t\tif( formatter != null ) {\n\t\t\t\t\t// Update the value\n\t\t\t\t\tthis._value = formatter( newValues[ newValues.length - 1 ] );\n\n\t\t\t\t\t// Update the values\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.push( formatter( newValues[ i ] ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.unshift( formatter( newValues[ i ] ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Update the value\n\t\t\t\t\tthis._value = newValues[ newValues.length - 1 ];\n\n\t\t\t\t\t// Update the values\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.unshift( newValues[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Remove the unnecessary values\n\t\t\t\tconst count = values.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Tell the parent it's changed\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget time(): number {\n\t\treturn this._time;\n\t}\n\n\tset time( newTime: number ) {\n\t\tconst capacity = this._capacity;\n\t\tif( capacity <= 0 ) {\n\t\t\tif( this._time !== newTime ) {\n\t\t\t\tthis._time = newTime;\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Update the times\n\t\t\tlet times = this._times;\n\t\t\tif( times == null ) {\n\t\t\t\ttimes = [];\n\t\t\t\tthis._times = times;\n\t\t\t}\n\n\t\t\t// Update the time\n\t\t\tthis._time = newTime;\n\n\t\t\t// Update the times\n\t\t\tconst order = this._order;\n\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\ttimes.push( newTime );\n\t\t\t} else {\n\t\t\t\ttimes.unshift( newTime );\n\t\t\t}\n\n\t\t\t// Remove the unnecessary times\n\t\t\tconst count = times.length - capacity;\n\t\t\tif( 0 < count ) {\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Tell the parent it's changed\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget times(): number[] {\n\t\tlet result = this._times;\n\t\tif( result == null ) {\n\t\t\tresult = [];\n\t\t\tthis._times = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tset times( newTimes: number[] ) {\n\t\tif( 0 < newTimes.length ) {\n\t\t\tconst capacity = this._capacity;\n\t\t\tif( capacity <= 0 ) {\n\t\t\t\tconst newTime = newTimes[ newTimes.length - 1 ];\n\t\t\t\tif( this._time !== newTime ) {\n\t\t\t\t\tthis._time = newTime;\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif( parent != null ) {\n\t\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Update the times\n\t\t\t\tlet times = this._times;\n\t\t\t\tif( times == null ) {\n\t\t\t\t\ttimes = [];\n\t\t\t\t\tthis._times = times;\n\t\t\t\t}\n\n\t\t\t\t// Update the value\n\t\t\t\tthis._time = newTimes[ newTimes.length - 1 ];\n\n\t\t\t\t//\n\t\t\t\tconst order = this._order;\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0, imax = newTimes.length; i < imax; ++i ) {\n\t\t\t\t\t\ttimes.push( newTimes[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = newTimes.length; i < imax; ++i ) {\n\t\t\t\t\t\ttimes.unshift( newTimes[ i ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//\n\t\t\t\tconst count = times.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Tell the parent it's changed\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget capacity(): number {\n\t\treturn this._capacity;\n\t}\n\n\tset capacity( capacity: number ) {\n\t\tif( this._capacity < capacity ) {\n\t\t\tthis._capacity = capacity;\n\t\t} else if( capacity < this._capacity ) {\n\t\t\tthis._capacity = capacity;\n\n\t\t\tlet isChanged = false;\n\n\t\t\t// Values\n\t\t\tconst order = this._order;\n\t\t\tconst values = this._values;\n\t\t\tif( values != null ) {\n\t\t\t\tconst count = values.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t\tisChanged = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Times\n\t\t\tconst times = this._times;\n\t\t\tif( times != null ) {\n\t\t\t\tconst count = times.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t\tisChanged = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( isChanged ) {\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget order(): EShapeTagValueOrder {\n\t\treturn this._order;\n\t}\n\n\tset order( order: EShapeTagValueOrder ) {\n\t\tthis._order = order;\n\t}\n\n\tremove( index: number ): void {\n\t\tlet isChanged = false;\n\n\t\t// Values\n\t\tconst values = this._values;\n\t\tif( values != null ) {\n\t\t\tif( 0 <= index && index < values.length ) {\n\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\t// Times\n\t\tconst times = this._times;\n\t\tif( times != null ) {\n\t\t\tif( 0 <= index && index < times.length ) {\n\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveAll( indices: number[] ): void {\n\t\tlet isChanged = false;\n\n\t\tconst values = this._values;\n\t\tconst times = this._times;\n\t\tconst sorted = indices.slice(0).sort( INDEX_COMPARATOR );\n\t\tif( values != null ) {\n\t\t\tif( times != null ) {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\t\tif( index < values.length ) {\n\t\t\t\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( index < times.length ) {\n\t\t\t\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index && index < values.length ) {\n\t\t\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( times != null ) {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index && index < times.length ) {\n\t\t\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tlet isChanged = false;\n\n\t\t// Values\n\t\tconst values = this._values;\n\t\tif( values != null ) {\n\t\t\tvalues.length = 0;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\t// Times\n\t\tconst times = this._times;\n\t\tif( times != null ) {\n\t\t\ttimes.length = 0;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\t// Change flag\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * This method does not copy the `#values` and `#times` for the performance.\n\t *\n\t * @param target a copy target\n\t */\n\tcopy( target: EShapeTagValue ): this {\n\t\tthis.id = target.id;\n\t\tthis.initial = target.initial;\n\t\tthis.format = target.format;\n\t\tthis.formatter = target.formatter;\n\t\tthis.range.copy( target.range );\n\t\tthis._value = target.value;\n\t\tthis._time = target.time;\n\t\tthis._capacity = target.capacity;\n\t\treturn this;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst idSerialized = manager.add( this.id );\n\t\tconst initialSerialized = manager.add( this.initial );\n\t\tconst formatSerialized = manager.add( this.format.trim() );\n\t\tconst rangeSerialized = this.range.serialize( manager );\n\t\treturn manager.add(\n\t\t\t`[${idSerialized},${initialSerialized},${formatSerialized},${rangeSerialized},${this._capacity},${this._order}]`\n\t\t);\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): this {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tlet parsed = manager.tagValues.get( target );\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ target ] ) as DDiagramSerializedTagValue;\n\t\t\t\tmanager.tagValues.set( target, parsed );\n\t\t\t}\n\t\t\tthis.id = resources[ parsed[ 0 ] ] || \"\";\n\t\t\tthis.initial = resources[ parsed[ 1 ] ] || \"\";\n\t\t\tthis.format = resources[ parsed[ 2 ] ] || \"\";\n\t\t\tthis.range.deserialize( parsed[ 3 ], manager );\n\t\t\tthis._capacity = parsed[ 4 ];\n\t\t\tthis._order = parsed[ 5 ];\n\t\t}\n\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeTagValue } from \"../e-shape-tag-value\";\nimport { EShapeTagValueRange } from \"../e-shape-tag-value-range\";\nimport { EShapeTagValueImpl } from \"./e-shape-tag-value-impl\";\nimport { EShapeTagValueRangeImpl } from \"./e-shape-tag-value-range-impl\";\n\nexport class EShapeTagImpl implements EShapeTag {\n\tstatic RANGE_DUMMY = new EShapeTagValueRangeImpl();\n\tstatic EMPTY_ARRAY = [];\n\n\tprotected _values: EShapeTagValue[];\n\tisChanged: boolean;\n\tinherited?: EShapeTagValue;\n\n\tconstructor() {\n\t\tthis._values = [];\n\t\tthis.isChanged = true;\n\t}\n\n\tget id(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].id;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.id;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget initial(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].initial;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.initial;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget format(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].format;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.format;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget range(): EShapeTagValueRange {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].range;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.range;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.RANGE_DUMMY;\n\t}\n\n\tget value(): unknown {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].value;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.value;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset value( value: unknown ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].value = value;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.value = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tget nvalue(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].nvalue;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.nvalue;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget time(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].time;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.time;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset time( time: number ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].time = time;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.time = time;\n\t\t\t}\n\t\t}\n\t}\n\n\tget values(): unknown[] {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].values;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.values;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.EMPTY_ARRAY;\n\t}\n\n\tset values( newValues: unknown[] ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].values = newValues;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.values = newValues;\n\t\t\t}\n\t\t}\n\t}\n\n\tget times(): number[] {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].times;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.times;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.EMPTY_ARRAY;\n\t}\n\n\tset times( newTimes: number[] ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].times = newTimes;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.times = newTimes;\n\t\t\t}\n\t\t}\n\t}\n\n\tget capacity(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].capacity;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.capacity;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset capacity( capacity: number ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].capacity = capacity;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.capacity = capacity;\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( value: EShapeTagValue, index?: number ): void {\n\t\tconst values = this._values;\n\t\tvalue.parent = this;\n\t\tif( index === undefined ) {\n\t\t\tvalues.push( value );\n\t\t} else {\n\t\t\tvalues.splice( index, 0, value );\n\t\t}\n\t}\n\n\tset( index: number, value: EShapeTagValue ): EShapeTagValue | null {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tconst result = values[ index ];\n\t\t\tvalue.parent = this;\n\t\t\tvalues[ index ] = value;\n\t\t\tresult.parent = undefined;\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tremove( index: number ): void {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tvalues.splice( index, 1 )[ 0 ].parent = undefined;\n\t\t}\n\t}\n\n\tindexOf( target: EShapeTagValue ): number {\n\t\tconst values = this._values;\n\n\t\t// Instance-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value === target ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// Data-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif(\n\t\t\t\tvalue.id === target.id &&\n\t\t\t\tvalue.initial === target.initial &&\n\t\t\t\tvalue.formatter === target.formatter &&\n\t\t\t\tvalue.range.isEquals( target.range )\n\t\t\t) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// ID-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value.id === target.id ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tget( index: number ): EShapeTagValue | null {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\treturn values[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._values.length;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tconst values = this._values;\n\t\tconst tmp = values[ indexB ];\n\t\tvalues[ indexB ] = values[ indexA ];\n\t\tvalues[ indexA ] = tmp;\n\t}\n\n\tcopy( target: EShapeTag ): this {\n\t\tconst values = this._values;\n\t\tvalues.length = 0;\n\n\t\tfor( let i = 0, imax = target.size(); i < imax; ++i ) {\n\t\t\tconst value = target.get( i );\n\t\t\tif( value != null ) {\n\t\t\t\tconst newValue = new EShapeTagValueImpl().copy( value );\n\t\t\t\tnewValue.parent = this;\n\t\t\t\tvalues.push( newValue );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst values = this._values;\n\t\tif( values.length <= 0 ) {\n\t\t\treturn manager.add( \"[]\" );\n\t\t} else {\n\t\t\tlet serialized = `[${values[ 0 ].serialize( manager )}`;\n\t\t\tfor( let i = 1, imax = values.length; i < imax; ++i ) {\n\t\t\t\tserialized += `,${values[ i ].serialize( manager )}`;\n\t\t\t}\n\t\t\tserialized += \"]\";\n\t\t\treturn manager.add( serialized );\n\t\t}\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tif( 0 <= target && target < manager.resources.length ) {\n\t\t\tlet deserialized: number[] | undefined = manager.tags.get( target );\n\t\t\tif( deserialized == null ) {\n\t\t\t\tdeserialized = JSON.parse( manager.resources[ target ] ) as number[];\n\t\t\t\tmanager.tags.set( target, deserialized );\n\t\t\t}\n\n\t\t\tconst values = this._values;\n\t\t\tvalues.length = 0;\n\t\t\tfor( let i = 0, imax = deserialized.length; i < imax; ++i ) {\n\t\t\t\tconst index = deserialized[ i ];\n\t\t\t\tconst value = new EShapeTagValueImpl();\n\t\t\t\tvalue.parent = this;\n\t\t\t\tvalue.deserialize( index, manager );\n\t\t\t\tvalues.push( value );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextAlignImplParent } from \"./e-shape-text-align-impl-parent\";\n\nexport class EShapeTextAlignImpl implements EShapeTextAlign {\n\tprotected _parent: EShapeTextAlignImplParent;\n\tprotected _horizontal: EShapeTextAlignHorizontal;\n\tprotected _vertical: EShapeTextAlignVertical;\n\n\tconstructor(\n\t\tparent: EShapeTextAlignImplParent,\n\t\thorizontal: EShapeTextAlignHorizontal, vertical: EShapeTextAlignVertical\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._horizontal = horizontal;\n\t\tthis._vertical = vertical;\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\treturn this._horizontal;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\tif( this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\treturn this._vertical;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\tif( this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.horizontal, target.vertical );\n\t\t}\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\tlet isChanged = false;\n\n\t\tif( horizontal != null && this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( vertical != null && this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\treturn {\n\t\t\thorizontal: this._horizontal,\n\t\t\tvertical: this._vertical\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${this._horizontal},${this._vertical}]` );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.aligns.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.aligns.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueBlinkType {\n\tVISIBILITY,\n\tBRIGHTEN,\n\tDARKEN,\n\tOPACITY,\n\tCOLOR_FILL,\n\tCOLOR_STROKE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeTextOffsetImplParent } from \"./e-shape-text-offset-impl-parent\";\n\nexport class EShapeTextOffsetImpl implements EShapeTextOffset {\n\tprotected _parent: EShapeTextOffsetImplParent;\n\tprotected _horizontal: number;\n\tprotected _vertical: number;\n\n\tconstructor( parent: EShapeTextOffsetImplParent, horizontal: number, vertical: number ) {\n\t\tthis._parent = parent;\n\t\tthis._horizontal = horizontal;\n\t\tthis._vertical = vertical;\n\t}\n\n\tget horizontal(): number {\n\t\treturn this._horizontal;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tif( this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\treturn this._vertical;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tif( this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.horizontal, target.vertical );\n\t\t}\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( horizontal != null && this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( vertical != null && this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: this._horizontal,\n\t\t\tvertical: this._vertical\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${this._horizontal},${this._vertical}]` );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.margins.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.margins.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeTextOutlineImplParent } from \"./e-shape-text-outline-impl-parent\";\n\nexport class EShapeTextOutlineImpl implements EShapeTextOutline {\n\tprotected _parent: EShapeTextOutlineImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _width: number;\n\n\tconstructor( parent: EShapeTextOutlineImplParent, enable: boolean, color: number, alpha: number, width: number ) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._width = width;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha, target.width );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( width !== undefined && this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeTextOutline {\n\t\treturn new EShapeTextOutlineImpl( this._parent, this._enable, this._color, this._alpha, this._width );\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\twidth: this._width\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst serialized = `[${this._enable ? 1 : 0},${this._color},${this._alpha},${this._width}]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.textOutlines.get( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ],\n\t\t\t\t\tparsed[ 3 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.textOutlines.set( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ],\n\t\t\t\t\tdeserialized[ 3 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DDiagramSerializedText } from \"../../d-diagram-serialized\";\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextAtlas, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextAlign } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeTextOffset } from \"../e-shape-text-offset\";\nimport { EShapeTextOutline } from \"../e-shape-text-outline\";\nimport { EShapeTextAlignImpl } from \"./e-shape-text-align-impl\";\nimport { EShapeTextImplParent } from \"./e-shape-text-impl-parent\";\nimport { EShapeTextOffsetImpl } from \"./e-shape-text-offset-impl\";\nimport { EShapeTextOutlineImpl } from \"./e-shape-text-outline-impl\";\n\nexport class EShapeTextImpl implements EShapeText {\n\tprotected _parent: EShapeTextImplParent;\n\tprotected _enable: boolean;\n\tprotected _value: string;\n\tprotected _family: string;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _size: number;\n\tprotected _weight: EShapeTextWeight;\n\treadonly align: EShapeTextAlign;\n\treadonly offset: EShapeTextOffset;\n\tprotected _style: EShapeTextStyle;\n\treadonly outline: EShapeTextOutline;\n\treadonly spacing: EShapeTextOffset;\n\tprotected _direction: EShapeTextDirection;\n\treadonly padding: EShapeTextOffset;\n\tprotected _clipping: boolean;\n\n\ttexture?: Texture;\t\t// Used for rendering and updated when rendered\n\tatlas?: EShapeTextAtlas;\t// Used for rendering and updated when rendered\n\tworld?: Float32Array;\t\t// Updated when rendered\n\n\tconstructor(\n\t\tparent: EShapeTextImplParent,\n\t\tvalue: string, color: number, alpha: number, family: string, size: number\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._enable = true;\n\t\tthis._value = value;\n\t\tthis._color = color!;\n\t\tthis._alpha = alpha!;\n\t\tthis._family = family!;\n\t\tthis._size = size!;\n\t\tthis._weight = EShapeTextWeight.NORMAL;\n\t\tthis.align = new EShapeTextAlignImpl( parent, EShapeTextAlignHorizontal.CENTER, EShapeTextAlignVertical.MIDDLE );\n\t\tthis.offset = new EShapeTextOffsetImpl( parent, 0, 0 );\n\t\tthis._style = EShapeTextStyle.NORMAL;\n\t\tthis.spacing = new EShapeTextOffsetImpl( parent, 0, 0 );\n\t\tthis.outline = new EShapeTextOutlineImpl( parent, false, 0xffffff, 1.0, 0.5 );\n\t\tthis._direction = EShapeTextDirection.LEFT_TO_RIGHT;\n\t\tthis.padding = new EShapeTextOffsetImpl( parent, 10, 10 );\n\t\tthis._clipping = false;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget value(): string {\n\t\treturn this._value;\n\t}\n\n\tset value( value: string ) {\n\t\tif( this._value !== value ) {\n\t\t\tthis._value = value;\n\n\t\t\t// Compatibility check\n\t\t\tconst parent = this._parent;\n\t\t\tconst uploaded = parent.uploaded;\n\t\t\tif( uploaded == null || ! uploaded.isCompatible( parent ) ) {\n\t\t\t\tthis.atlas = undefined;\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Character code check\n\t\t\tconst atlas = this.atlas;\n\t\t\tconst characters = atlas && atlas.characters;\n\t\t\tif( characters != null ) {\n\t\t\t\tfor( let i = 0, imax = value.length; i < imax; ++i ) {\n\t\t\t\t\tconst char = value[ i ];\n\t\t\t\t\tif( ! (char in characters) ) {\n\t\t\t\t\t\tthis.atlas = undefined;\n\t\t\t\t\t\tparent.toDirty();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.atlas = undefined;\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Update uploaded\n\t\t\tparent.updateUploaded();\n\t\t}\n\t}\n\n\tget family(): string {\n\t\treturn this._family;\n\t}\n\n\tset family( family: string ) {\n\t\tif( this._family !== family ) {\n\t\t\tthis._family = family;\n\t\t\tthis._parent.toDirty();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tif( this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\treturn this._weight;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\tif( this._weight !== weight ) {\n\t\t\tthis._weight = weight;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\tif( this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget direction(): EShapeTextDirection {\n\t\treturn this._direction;\n\t}\n\n\tset direction( direction: EShapeTextDirection ) {\n\t\tif( this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget clipping(): boolean {\n\t\treturn this._clipping;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tif( this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\tif( target ) {\n\t\t\tthis.set(\n\t\t\t\ttarget.value,\n\t\t\t\ttarget.color,\n\t\t\t\ttarget.alpha,\n\t\t\t\ttarget.family,\n\t\t\t\ttarget.size,\n\t\t\t\ttarget.weight,\n\t\t\t\ttarget.style,\n\t\t\t\ttarget.direction,\n\t\t\t\ttarget.clipping\n\t\t\t);\n\t\t\tthis.align.copy( target.align );\n\t\t\tthis.offset.copy( target.offset );\n\t\t\tthis.outline.copy( target.outline );\n\t\t\tthis.spacing.copy( target.spacing );\n\t\t\tthis.padding.copy( target.padding );\n\t\t}\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this {\n\t\tlet isChangedDirty = false;\n\t\tlet isChangedUploaded = false;\n\n\t\tif( value != null && this._value !== value ) {\n\t\t\tthis._value = value;\n\t\t\tisChangedDirty = true;\n\t\t}\n\n\t\tif( color != null && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( alpha != null && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( family != null && this._family !== family ) {\n\t\t\tthis._family = family;\n\t\t\tisChangedDirty = true;\n\t\t}\n\n\t\tif( size != null && this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( weight != null && this._weight !== weight ) {\n\t\t\tthis._weight = weight;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( style != null && this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( direction != null && this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( clipping != null && this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( isChangedDirty ) {\n\t\t\tthis._parent.toDirty();\n\t\t} else if( isChangedUploaded ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\treturn {\n\t\t\tvalue: this._value,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\tfamily: this._family,\n\t\t\tsize: this._size,\n\t\t\tweight: this._weight,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: this._style,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tdirection: this._direction,\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: this._clipping\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst alignSerialized = this.align.serialize( manager );\n\t\tconst offsetSerialized = this.offset.serialize( manager );\n\t\tconst outlineSerialized = this.outline.serialize( manager );\n\t\tconst spacingSerialized = this.spacing.serialize( manager );\n\t\tconst paddingSerialized = this.padding.serialize( manager );\n\t\tconst serialized = `[${manager.add( this._value )},${this._color},${this._alpha},` +\n\t\t\t`${manager.add( this._family )},${this._size},${this._weight},${alignSerialized},` +\n\t\t\t`${offsetSerialized},${this._style},${outlineSerialized},${spacingSerialized},` +\n\t\t\t`${this._direction},${paddingSerialized},${this._clipping ? 1 : 0 }]`;\n\t\treturn manager.add( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tlet parsed = manager.texts.get( target );\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ target ] ) as DDiagramSerializedText;\n\t\t\t\tmanager.texts.set( target, parsed );\n\t\t\t}\n\t\t\tthis.set(\n\t\t\t\tresources[ parsed[ 0 ] ] || \"\",\n\t\t\t\tparsed[ 1 ],\n\t\t\t\tparsed[ 2 ],\n\t\t\t\tresources[ parsed[ 3 ] ] || \"auto\",\n\t\t\t\tparsed[ 4 ],\n\t\t\t\tparsed[ 5 ],\n\t\t\t\tparsed[ 8 ],\n\t\t\t\tparsed[ 11 ],\n\t\t\t\t( parsed[ 13 ] !== 0 )\n\t\t\t);\n\t\t\tthis.align.deserialize( parsed[ 6 ], manager );\n\t\t\tthis.offset.deserialize( parsed[ 7 ], manager );\n\t\t\tthis.outline.deserialize( parsed[ 9 ], manager );\n\t\t\tthis.spacing.deserialize( parsed[ 10 ], manager );\n\t\t\tthis.padding.deserialize( parsed[ 12 ], manager );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, ObservablePoint } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeFillImpl } from \"./e-shape-fill-impl\";\nimport { EShapeStrokeImpl } from \"./e-shape-stroke-impl\";\nimport { EShapeTagImpl } from \"./e-shape-tag-impl\";\nimport { EShapeTextImpl } from \"./e-shape-text-impl\";\n\nexport abstract class EShapePrimitive extends EShapeBase {\n\treadonly size: IPoint;\n\treadonly fill: EShapeFill;\n\treadonly stroke: EShapeStroke;\n\tprotected _radius: number;\n\tprotected _corner: EShapeCorner;\n\tpoints?: EShapePoints;\n\tprotected _image?: HTMLImageElement;\n\tgradient?: EShapeGradientLike;\n\treadonly text: EShapeText;\n\treadonly tag: EShapeTag;\n\tcursor: string;\n\n\tconstructor( type: EShapeType ) {\n\t\tsuper( type );\n\t\tthis.size = this.newSize();\n\t\tthis.fill = this.newFill();\n\t\tthis.stroke = this.newStroke();\n\t\tthis._radius = EShapeDefaults.RADIUS;\n\t\tthis._corner = EShapeCorner.ALL;\n\t\tthis.tag = new EShapeTagImpl();\n\t\tthis.text = this.newText();\n\t\tthis.cursor = EShapeDefaults.CURSOR;\n\t}\n\n\tprotected newSize(): IPoint {\n\t\treturn new ObservablePoint(\n\t\t\t() => { this.onSizeChange(); },\n\t\t\tundefined,\n\t\t\tEShapeDefaults.SIZE_X,\n\t\t\tEShapeDefaults.SIZE_Y\n\t\t);\n\t}\n\n\tprotected newFill(): EShapeFill {\n\t\treturn new EShapeFillImpl(\n\t\t\tthis, true,\n\t\t\tEShapeDefaults.FILL_COLOR,\n\t\t\tEShapeDefaults.FILL_ALPHA\n\t\t);\n\t}\n\n\tprotected newStroke(): EShapeStroke {\n\t\treturn new EShapeStrokeImpl(\n\t\t\tthis, true,\n\t\t\tEShapeDefaults.STROKE_COLOR,\n\t\t\tEShapeDefaults.STROKE_ALPHA,\n\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\tEShapeDefaults.STROKE_ALIGN,\n\t\t\tEShapeDefaults.STROKE_SIDE\n\t\t);\n\t}\n\n\tprotected newText(): EShapeText {\n\t\treturn new EShapeTextImpl(\n\t\t\tthis,\n\t\t\tEShapeDefaults.TEXT_VALUE,\n\t\t\tEShapeDefaults.STROKE_COLOR,\n\t\t\tEShapeDefaults.STROKE_ALPHA,\n\t\t\tEShapeDefaults.TEXT_FAMILY,\n\t\t\tEShapeDefaults.TEXT_SIZE\n\t\t);\n\t}\n\n\tabstract clone(): EShape;\n\n\tget corner(): number {\n\t\treturn this._corner;\n\t}\n\n\tset corner( corner: number ) {\n\t\tif( this._corner !== corner ) {\n\t\t\tthis._corner = corner;\n\t\t\tthis.updateUploaded();\n\t\t}\n\t}\n\n\tget radius(): number {\n\t\treturn this._radius;\n\t}\n\n\tset radius( radius: number ) {\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tthis.updateUploaded();\n\t\t}\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\treturn this._image;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\tif( this._image !== image ) {\n\t\t\tif( image != null ) {\n\t\t\t\tthis._image = image;\n\t\t\t\tthis.imageSrc = image.src;\n\t\t\t} else {\n\t\t\t\tthis._image = undefined;\n\t\t\t\tthis.imageSrc = undefined;\n\t\t\t}\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.toDirty();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { utilIndexOf } from \"../../util/util-index-of\";\nimport { EShapePoints, EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport abstract class EShapeLineBase extends EShapePrimitive {\n\tabstract points: EShapePoints;\n\tabstract clone(): EShapeLineBase;\n\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem {\n\t\tconst result = super.serialize( manager );\n\t\tresult[ 15 ] = this.points.serialize( manager );\n\t\treturn result;\n\t}\n\n\tprotected getPixelScale(): number {\n\t\tconst container = this.root.parent as any;\n\t\tif( container != null && container.getPixelScale != null ) {\n\t\t\treturn container.getPixelScale();\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tprotected getStrokeWidthScale( points: EShapePoints ): number {\n\t\tconst style = points.style;\n\t\tif( style & EShapePointsStyle.NON_EXPANDING_WIDTH ) {\n\t\t\tif( style & EShapePointsStyle.NON_SHRINKING_WIDTH ) {\n\t\t\t\treturn this.getPixelScale();\n\t\t\t} else {\n\t\t\t\treturn Math.min( 1.0, this.getPixelScale() );\n\t\t\t}\n\t\t} else {\n\t\t\tif( style & EShapePointsStyle.NON_SHRINKING_WIDTH ) {\n\t\t\t\treturn Math.max( 1.0, this.getPixelScale() );\n\t\t\t} else {\n\t\t\t\treturn 1.0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getStrokeWidthScaled( points: EShapePoints ): number {\n\t\tconst stroke = this.stroke;\n\t\treturn ( stroke.enable ? stroke.width * this.getStrokeWidthScale( points ) : 0 );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst points = this.points;\n\t\tconst swh = this.getStrokeWidthScaled( points ) * 0.5;\n\t\tif( this.containsAbsBBox( x, y, ax + swh, ay + swh ) ) {\n\t\t\tconst threshold = swh * swh;\n\t\t\tconst pointCount = points.length;\n\t\t\tif( 2 <= pointCount ) {\n\t\t\t\tconst pointValues = points.values;\n\t\t\t\tconst pointSegments = points.segments;\n\t\t\t\tfor( let i = 0, imax = pointCount - 1, iv = 0; i < imax; i += 1, iv += 2 ) {\n\t\t\t\t\tif( utilIndexOf( pointSegments, i + 1 ) < 0 ) {\n\t\t\t\t\t\tconst p0x = pointValues[ iv + 0 ];\n\t\t\t\t\t\tconst p0y = pointValues[ iv + 1 ];\n\t\t\t\t\t\tconst p1x = pointValues[ iv + 2 ];\n\t\t\t\t\t\tconst p1y = pointValues[ iv + 3 ];\n\t\t\t\t\t\tif( 0 <= EShapeLineBase.calcHitPosition( x, y, p0x, p0y, p1x, p1y, threshold ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( 2 < pointCount && (points.style & EShapePointsStyle.CLOSED) ) {\n\t\t\t\t\tif( utilIndexOf( pointSegments, 0 ) < 0 ) {\n\t\t\t\t\t\tconst iv = (pointCount - 1) << 1;\n\t\t\t\t\t\tconst p0x = pointValues[ iv + 0 ];\n\t\t\t\t\t\tconst p0y = pointValues[ iv + 1 ];\n\t\t\t\t\t\tconst p1x = pointValues[ 0 ];\n\t\t\t\t\t\tconst p1y = pointValues[ 1 ];\n\t\t\t\t\t\tif( 0 <= EShapeLineBase.calcHitPosition( x, y, p0x, p0y, p1x, p1y, threshold ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic calcHitPosition(\n\t\tx: number, y: number,\n\t\tp0x: number, p0y: number,\n\t\tp1x: number, p1y: number,\n\t\tsquaredDistance: number\n\t): number {\n\t\t// (x, y) = p0 + (p1 - p0) * t where 0 <= t <= 1\n\t\t// d0 := p1 - p0\n\t\t// d1 := v - p0\n\t\t// (p0.x + d0.x * t - x)^2 + (p0.y + d0.y * t - y)^2\n\t\t// (d0.x t - d1.x)^2 + (d0.y t - d1.y)^2\n\t\t// (d0.x^2 + d0.y^2) t^2 - 2 (d0.x * d1.x + d0.y * d1.y) t + (d1.x^2 + d1.y^2)\n\t\t// a := dot( d0, d0 )\n\t\t// b := dot( d0, d1 )\n\t\t// c := dot( d1, d1 )\n\t\t// a t^2 - 2 b t + c = a (t - b / a)^2 + c - b * b / a\n\t\t// t0 = b / a  min = c - b * b / a\n\t\tconst d0x = p1x - p0x;\n\t\tconst d0y = p1y - p0y;\n\t\tconst d1x = x - p0x;\n\t\tconst d1y = y - p0y;\n\t\tconst a = d0x * d0x + d0y * d0y;\n\t\tconst b = d0x * d1x + d0y * d1y;\n\t\tconst c = d1x * d1x + d1y * d1y;\n\t\tif( 0.0001 < a ) {\n\t\t\tconst t0 = Math.max( 0, Math.min( 1, b / a ) );\n\t\t\tconst d = a * t0 * t0 - 2 * b * t0 + c;\n\t\t\tif( d < squaredDistance ) {\n\t\t\t\treturn t0;\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBarPoints } from \"./e-shape-bar-points\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\nimport { EShapeLineBase } from \"./e-shape-line-base\";\n\nexport class EShapeBar extends EShapeLineBase {\n\tpoints: EShapeBarPoints;\n\n\tconstructor( position: EShapeBarPosition, size: number, width: number, style: EShapePointsStyle ) {\n\t\tsuper( EShapeType.BAR );\n\t\tthis.fill.enable = false;\n\t\tthis.stroke.set( true, undefined, undefined, width );\n\t\tthis.points = new EShapeBarPoints( this, position, size, style );\n\t}\n\n\tclone(): EShapeBar {\n\t\tconst points = this.points;\n\t\treturn new EShapeBar( points.position, points.size, this.stroke.width, points.style ).copy( this );\n\t}\n\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst size = Math.max( 0, this.points.size );\n\t\treturn super.containsAbsBBox( x, y, ax + size, ay + size );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture, TextureUvs, utils } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeBufferUnitBuilder } from \"./e-shape-buffer-unit-builder\";\nimport { EShapeCorner } from \"./e-shape-corner\";\nimport { EShapeDefaults } from \"./e-shape-defaults\";\n\nconst FMIN: number = 0.00001;\n\nexport interface EShapeUploaded {\n\tupdate( shape: EShape ): void;\n\tisCompatible( shape: EShape ): boolean;\n\tgetBuffer(): EShapeBuffer;\n\tgetVertexOffset(): number;\n\tgetVertexCount(): number;\n\tgetIndexOffset(): number;\n\tgetIndexCount(): number;\n\tbuildUnit( builder: EShapeBufferUnitBuilder ): void;\n}\n\nexport abstract class EShapeUploadedBase implements EShapeUploaded {\n\tprotected buffer: EShapeBuffer;\n\n\tprotected transformLocalId: number;\n\n\tprotected vertexOffset: number;\n\tprotected vertexCount: number;\n\tprotected indexOffset: number;\n\tprotected indexCount: number;\n\n\tprotected colorFill: number;\n\tprotected alphaFill: number;\n\tprotected colorStroke: number;\n\tprotected alphaStroke: number;\n\n\tprotected sizeX: number;\n\tprotected sizeY: number;\n\tprotected worldSizeXHalf: number;\n\tprotected worldSizeYHalf: number;\n\tprotected worldSizeZHalf: number;\n\tprotected worldSizeWHalf: number;\n\tprotected worldSizeR: number;\n\tprotected strokeWidth: number;\n\tprotected strokeAlign: number;\n\tprotected strokeSide: number;\n\tprotected radius: number;\n\tprotected corner: EShapeCorner;\n\n\tprotected texture: Texture | null;\n\tprotected textureTransformId: number;\n\n\tconstructor( buffer: EShapeBuffer, voffset: number, ioffset: number, vcount: number, icount: number ) {\n\t\tthis.buffer = buffer;\n\n\t\tthis.transformLocalId = -1;\n\n\t\tthis.vertexOffset = voffset;\n\t\tthis.vertexCount = vcount;\n\t\tthis.indexOffset = ioffset;\n\t\tthis.indexCount = icount;\n\n\t\tthis.colorFill = NaN;\n\t\tthis.alphaFill = -1;\n\t\tthis.colorStroke = NaN;\n\t\tthis.alphaStroke = -1;\n\n\t\tthis.sizeX = NaN;\n\t\tthis.sizeY = NaN;\n\t\tthis.worldSizeXHalf = NaN;\n\t\tthis.worldSizeYHalf = NaN;\n\t\tthis.worldSizeZHalf = NaN;\n\t\tthis.worldSizeWHalf = NaN;\n\t\tthis.worldSizeR = NaN;\n\t\tthis.strokeWidth = NaN;\n\t\tthis.strokeAlign = NaN;\n\t\tthis.strokeSide = NaN;\n\t\tthis.radius = NaN;\n\t\tthis.corner = NaN;\n\n\t\tthis.texture = null;\n\t\tthis.textureTransformId = NaN;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tshape.uploaded = this;\n\t\treturn this;\n\t}\n\n\tabstract update( shape: EShape ): void;\n\n\tisCompatible( shape: EShape ): boolean {\n\t\treturn true;\n\t}\n\n\tgetBuffer(): EShapeBuffer {\n\t\treturn this.buffer;\n\t}\n\n\tgetVertexOffset(): number {\n\t\treturn this.vertexOffset;\n\t}\n\n\tgetVertexCount(): number {\n\t\treturn this.vertexCount;\n\t}\n\n\tgetIndexOffset(): number {\n\t\treturn this.indexOffset;\n\t}\n\n\tgetIndexCount(): number {\n\t\treturn this.indexCount;\n\t}\n\n\tprotected toTransformLocalId( shape: EShape ) {\n\t\tshape.updateTransform();\n\t\treturn shape.transform.getLocalId();\n\t}\n\n\tprotected toTexture( shape: EShape ) {\n\t\treturn shape.texture || Texture.WHITE;\n\t}\n\n\tprotected toTextureTransformId( texture: Texture ): number {\n\t\tconst textureAny = texture as any;\n\t\tif( textureAny._uvs == null ) {\n\t\t\ttexture.updateUvs();\n\t\t}\n\t\treturn textureAny._updateID;\n\t}\n\n\tprotected toTextureUvs( texture: Texture ): TextureUvs {\n\t\treturn (texture as any)._uvs;\n\t}\n\n\tprotected fillColor( color: number, alpha: number, voffset: number, count: number, colors: Float32Array ) {\n\t\tconst rgba = utils.premultiplyTintToRgba( color, alpha, this.buffer.workColor );\n\t\tconst r = rgba[ 0 ];\n\t\tconst g = rgba[ 1 ];\n\t\tconst b = rgba[ 2 ];\n\t\tconst a = rgba[ 3 ];\n\n\t\tfor( let i = voffset * 4, imax = i + count * 4; i < imax; i += 4 ) {\n\t\t\tcolors[ i + 0 ] = r;\n\t\t\tcolors[ i + 1 ] = g;\n\t\t\tcolors[ i + 2 ] = b;\n\t\t\tcolors[ i + 3 ] = a;\n\t\t}\n\t}\n\n\tprotected updateColorFill( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tconst fill = shape.fill;\n\t\tconst isEnabled = shape.visible && fill.enable;\n\t\tconst color = fill.color;\n\t\tconst alpha = (isEnabled ? fill.alpha : 0);\n\t\tif( color !== this.colorFill || alpha !== this.alphaFill ) {\n\t\t\tthis.colorFill = color;\n\t\t\tthis.alphaFill = alpha;\n\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\tthis.fillColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvertexCount,\n\t\t\t\tbuffer.colorFills\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateColorStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tconst stroke = shape.stroke;\n\t\tconst isEnabled = shape.visible && stroke.enable && 0 < stroke.width;\n\t\tconst color = stroke.color;\n\t\tconst alpha = (isEnabled ? stroke.alpha : 0);\n\t\tif( color !== this.colorStroke || alpha !== this.alphaStroke ) {\n\t\t\tthis.colorStroke = color;\n\t\t\tthis.alphaStroke = alpha;\n\t\t\tbuffer.colorStrokeBuffer.update();\n\n\t\t\tthis.fillColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvertexCount,\n\t\t\t\tbuffer.colorStrokes\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tthis.updateColorFill( buffer, shape, vertexCount );\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tprotected calcStep( size: number, strokeWidth: number, result: Float32Array ): Float32Array {\n\t\tconst antialiasWeight = EShapeDefaults.ANTIALIAS_WEIGHT;\n\t\tif( FMIN < strokeWidth ) {\n\t\t\tconst dpc0 = size - strokeWidth;\n\t\t\tif( FMIN < dpc0 ) {\n\t\t\t\tconst pc0 = antialiasWeight / dpc0;\n\t\t\t\tconst pc1 = antialiasWeight / Math.max( FMIN, size );\n\t\t\t\tconst swc = 1 / Math.max( FMIN, 1 - strokeWidth / size );\n\t\t\t\tresult[ 0 ] = swc;\n\t\t\t\tresult[ 1 ] = pc0;\n\t\t\t\tresult[ 2 ] = pc1;\n\t\t\t} else {\n\t\t\t\tconst pc0 = antialiasWeight / FMIN;\n\t\t\t\tconst pc1 = antialiasWeight / Math.max( FMIN, size );\n\t\t\t\tconst swc = 1 / FMIN;\n\t\t\t\tresult[ 0 ] = swc;\n\t\t\t\tresult[ 1 ] = pc0;\n\t\t\t\tresult[ 2 ] = pc1;\n\t\t\t}\n\t\t} else {\n\t\t\t// Assumes strokeWidth === 0\n\t\t\tconst pc = antialiasWeight / Math.max( FMIN, size );\n\t\t\tresult[ 0 ] = 1;\n\t\t\tresult[ 1 ] = pc;\n\t\t\tresult[ 2 ] = pc;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected updateStep(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, vcount: number,\n\t\tswx: number, swy: number, px0: number, py0: number, px1: number, py1: number\n\t) {\n\t\tconst steps = buffer.steps;\n\t\tconst antialiases = buffer.antialiases;\n\t\tconst clippings = buffer.clippings;\n\t\tconst istart = voffset * 2;\n\t\tconst imax = istart + vcount * 2;\n\t\tconst jstart = voffset * 3;\n\t\tconst kstart = voffset * 4;\n\t\tfor( let i = istart, j = jstart, k = kstart; i < imax; i += 2, j += 3, k += 4 ) {\n\t\t\tconst cx = clippings[ j + 0 ];\n\t\t\tconst cy = clippings[ j + 1 ];\n\t\t\tsteps[ i + 0 ] = swx * cx;\n\t\t\tsteps[ i + 1 ] = swy * cy;\n\t\t\tantialiases[ k + 0 ] = px0;\n\t\t\tantialiases[ k + 1 ] = py0;\n\t\t\tantialiases[ k + 2 ] = px1;\n\t\t\tantialiases[ k + 3 ] = py1;\n\t\t}\n\t}\n\n\tprotected updateStepIf(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, vcount: number,\n\t\tswc: number, pc0: number, pc1: number,\n\t\tswx: number, swy: number, px0: number, py0: number, px1: number, py1: number\n\t) {\n\t\tconst steps = buffer.steps;\n\t\tconst antialiases = buffer.antialiases;\n\t\tconst clippings = buffer.clippings;\n\t\tconst istart = voffset * 2;\n\t\tconst imax = istart + vcount * 2;\n\t\tconst jstart = voffset * 3;\n\t\tconst kstart = voffset * 4;\n\t\tfor( let i = istart, j = jstart, k = kstart; i < imax; i += 2, j += 3, k += 4 ) {\n\t\t\tconst cx = clippings[ j + 0 ];\n\t\t\tconst cy = clippings[ j + 1 ];\n\t\t\tconst cz = clippings[ j + 2 ];\n\t\t\tif( 0.5 < cz ) {\n\t\t\t\tsteps[ i + 0 ] = swc * cx;\n\t\t\t\tsteps[ i + 1 ] = swc * cy;\n\t\t\t\tantialiases[ k + 0 ] = pc0;\n\t\t\t\tantialiases[ k + 1 ] = pc0;\n\t\t\t\tantialiases[ k + 2 ] = pc1;\n\t\t\t\tantialiases[ k + 3 ] = pc1;\n\t\t\t} else {\n\t\t\t\tsteps[ i + 0 ] = swx * cx;\n\t\t\t\tsteps[ i + 1 ] = swy * cy;\n\t\t\t\tantialiases[ k + 0 ] = px0;\n\t\t\t\tantialiases[ k + 1 ] = py0;\n\t\t\t\tantialiases[ k + 2 ] = px1;\n\t\t\t\tantialiases[ k + 3 ] = py1;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcLength( p0x: number, p0y: number, p1x: number, p1y: number ) {\n\t\tconst dx01 = p1x - p0x;\n\t\tconst dy01 = p1y - p0y;\n\t\treturn Math.sqrt( dx01 * dx01 + dy01 * dy01 );\n\t}\n\n\tbuildUnit( builder: EShapeBufferUnitBuilder ) {\n\t\tconst texture = this.texture || Texture.WHITE;\n\t\tconst baseTexture = texture.baseTexture;\n\t\tif( baseTexture !== builder.baseTexture ) {\n\t\t\tbuilder.baseTexture = baseTexture;\n\t\t\tconst indexOffset = this.indexOffset;\n\t\t\tbuilder.push( texture, indexOffset );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBufferCount } from \"../e-shape-buffer-count\";\n\nexport class EShapeTextUploadeds {\n\tstatic getTextCount( shape: EShape, result: EShapeBufferCount ): EShapeBufferCount {\n\t\tconst length = shape.text.value.length;\n\t\tconst count = Math.ceil( length / 12 ) * 12;\n\t\tresult.vertexCount = count << 2;\n\t\tresult.indexCount = count << 1;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeBufferUnitBuilder } from \"../e-shape-buffer-unit-builder\";\nimport { EShapeTextAtlas, EShapeTextAtlasCharacter, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nconst FMIN: number = 0.00001;\n\nexport abstract class EShapeTextUploaded extends EShapeUploadedBase {\n\tprotected textTexture: Texture | null;\n\tprotected textTextureTransformId: number;\n\tprotected textValue: string;\n\tprotected textFamily: string;\n\tprotected textSize: number;\n\tprotected textColor: number;\n\tprotected textAlpha: number;\n\tprotected textWeight: number;\n\tprotected textStyle: number;\n\tprotected textAlignHorizontal: number;\n\tprotected textAlignVertical: number;\n\tprotected textOffsetHorizontal: number;\n\tprotected textOffsetVertical: number;\n\tprotected textOutlineWidth: number;\n\tprotected textOutlineColor: number;\n\tprotected textOutlineAlpha: number;\n\tprotected textSpacingHorizontal: number;\n\tprotected textSpacingVertical: number;\n\tprotected textDirection: number;\n\tprotected textPaddingHorizontal: number;\n\tprotected textPaddingVertical: number;\n\tprotected textClipping: boolean;\n\tprotected textVertexCount: number;\n\tprotected textIndexCount: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, vcount, icount );\n\n\t\tthis.textSize = NaN;\n\t\tthis.textFamily = \"auto\";\n\t\tthis.textValue = \"\";\n\t\tthis.textTexture = null;\n\t\tthis.textTextureTransformId = NaN;\n\t\tthis.textColor = NaN;\n\t\tthis.textAlpha = NaN;\n\t\tthis.textWeight = NaN;\n\t\tthis.textStyle = NaN;\n\t\tthis.textAlignHorizontal = NaN;\n\t\tthis.textAlignVertical = NaN;\n\t\tthis.textOffsetHorizontal = NaN;\n\t\tthis.textOffsetVertical = NaN;\n\t\tthis.textOutlineWidth = NaN;\n\t\tthis.textOutlineColor = NaN;\n\t\tthis.textOutlineAlpha = NaN;\n\t\tthis.textSpacingHorizontal = NaN;\n\t\tthis.textSpacingVertical = NaN;\n\t\tthis.textDirection = NaN;\n\t\tthis.textPaddingHorizontal = NaN;\n\t\tthis.textPaddingVertical = NaN;\n\t\tthis.textClipping = false;\n\t\tthis.textVertexCount = tvcount;\n\t\tthis.textIndexCount = ticount;\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst textCount = EShapeTextUploadeds.getTextCount( shape, this.buffer.workCount );\n\t\t\treturn ( textCount.vertexCount === this.textVertexCount );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateColor( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst vertexCount = this.vertexCount - this.textVertexCount;\n\t\tthis.updateColorFillAndStroke( buffer, shape, vertexCount );\n\t}\n\n\tprotected getTextBBox(\n\t\thalign: EShapeTextAlignHorizontal,\n\t\tvalign: EShapeTextAlignVertical,\n\t\thoffset: number,\n\t\tvoffset: number,\n\t\thpadding: number,\n\t\tvpadding: number,\n\t\twidth: number, height: number,\n\t\tx0: number, y0: number,\n\t\tx1: number, y1: number,\n\t\tx2: number, y2: number,\n\t\tx3: number, y3: number,\n\t\thnx: number, hny: number,\n\t\tvnx: number, vny: number,\n\t\tresult: Point\n\t): void {\n\t\tswitch( halign ) {\n\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x0 + x3 )\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y3 )\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = 0.5 * ( x0 + x1 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = 0.5 * ( y0 + y1 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x0 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = 0.5 * ( x3 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = 0.5 * ( y3 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = 0.5 * ( x0 + x1 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y1 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = 0.5 * ( x3 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = 0.5 * ( y3 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x1 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y1 + y2 )\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x0 + x3 )\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y0 + y3 )\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x0\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y0\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x3\n\t\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y3\n\t\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\tswitch( valign ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tresult.x = 0.5 * ( x1 + x2 )\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\t\tresult.y = 0.5 * ( y1 + y2 )\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tresult.x = x1\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\t\tresult.y = y1\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tresult.x = x2\n\t\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\t\tresult.y = y2\n\t\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected normalize( dx: number, dy: number, defx: number, defy: number, result: Point ): number {\n\t\tconst d = dx * dx + dy * dy;\n\t\tif( FMIN < d ) {\n\t\t\tconst l = Math.sqrt( d );\n\t\t\tconst li = 1 / l;\n\t\t\tresult.set( dx * li, dy * li );\n\t\t\treturn l;\n\t\t} else {\n\t\t\tresult.set( defx, defy );\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprotected rotateAlignHorizontalRight( align: EShapeTextAlignHorizontal ): EShapeTextAlignVertical {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\treturn EShapeTextAlignVertical.BOTTOM;\n\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\treturn EShapeTextAlignVertical.TOP;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\t\t}\n\t}\n\n\tprotected rotateAlignVerticalRight( align: EShapeTextAlignVertical ): EShapeTextAlignHorizontal {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\treturn EShapeTextAlignHorizontal.LEFT;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.RIGHT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\t\t}\n\t}\n\n\tprotected rotateAlignHorizontalLeft( align: EShapeTextAlignHorizontal ): EShapeTextAlignVertical {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\treturn EShapeTextAlignVertical.TOP;\n\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\treturn EShapeTextAlignVertical.BOTTOM;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\t\t}\n\t}\n\n\tprotected rotateAlignVerticalLeft( align: EShapeTextAlignVertical ): EShapeTextAlignHorizontal {\n\t\tswitch( align ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\treturn EShapeTextAlignHorizontal.RIGHT;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.LEFT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\t\t}\n\t}\n\n\tprotected updateTextVertex( buffer: EShapeBuffer, shape: EShape, textAtlas: EShapeTextAtlas ) {\n\t\tconst text = shape.text;\n\t\tconst textSize = text.size;\n\t\tconst textFamily = text.family;\n\t\tconst textValue = text.value;\n\t\tconst textStyle = text.style;\n\t\tconst textAlignHorizontal = text.align.horizontal;\n\t\tconst textAlignVertical = text.align.vertical;\n\t\tconst textOffsetHorizontal = text.offset.horizontal;\n\t\tconst textOffsetVertical = text.offset.vertical;\n\t\tconst textSpacingHorizontal = text.spacing.horizontal;\n\t\tconst textSpacingVertical = text.spacing.vertical;\n\t\tconst textDirection = text.direction;\n\t\tconst textPaddingHorizontal = text.padding.horizontal;\n\t\tconst textPaddingVertical = text.padding.vertical;\n\t\tconst textClipping = text.clipping;\n\t\tconst textTexture = text.texture || Texture.WHITE;\n\t\tconst textTextureTransformId = this.toTextureTransformId( textTexture );\n\n\t\tconst isCharChanged = (textValue !== this.textValue || textFamily !== this.textFamily);\n\t\tconst isCharSizeChanged = (textSize !== this.textSize);\n\t\tconst isCharStyleChanged = (textStyle !== this.textStyle);\n\t\tconst isCharAlignChanged = (textAlignHorizontal !== this.textAlignHorizontal ||\n\t\t\ttextAlignVertical !== this.textAlignVertical);\n\t\tconst isCharOffsetChanged = (textOffsetHorizontal !== this.textOffsetHorizontal ||\n\t\t\ttextOffsetVertical !== this.textOffsetVertical);\n\t\tconst isCharSpacingChanged = (textSpacingHorizontal !== this.textSpacingHorizontal ||\n\t\t\ttextSpacingVertical !== this.textSpacingVertical ||\n\t\t\ttextPaddingHorizontal !== this.textPaddingHorizontal ||\n\t\t\ttextPaddingVertical !== this.textPaddingVertical);\n\t\tconst isCharDirectionChanged = (textDirection !== this.textDirection);\n\t\tconst isClippingChanged = ( this.textClipping !== textClipping );\n\t\tconst isTextureChanged = ( textTexture !== this.textTexture ||\n\t\t\ttextTextureTransformId !== this.textTextureTransformId );\n\n\t\tif( isCharChanged || isCharSizeChanged || isCharStyleChanged ||\n\t\t\tisCharAlignChanged || isCharOffsetChanged || isCharSpacingChanged ||\n\t\t\tisCharDirectionChanged || isClippingChanged || isTextureChanged ) {\n\t\t\tthis.textSize = textSize;\n\t\t\tthis.textFamily = textFamily;\n\t\t\tthis.textValue = textValue;\n\t\t\tthis.textStyle = textStyle;\n\t\t\tthis.textAlignHorizontal = textAlignHorizontal;\n\t\t\tthis.textAlignVertical = textAlignVertical;\n\t\t\tthis.textOffsetHorizontal = textOffsetHorizontal;\n\t\t\tthis.textOffsetVertical = textOffsetVertical;\n\t\t\tthis.textSpacingHorizontal = textSpacingHorizontal;\n\t\t\tthis.textSpacingVertical = textSpacingVertical;\n\t\t\tthis.textDirection = textDirection;\n\t\t\tthis.textPaddingHorizontal = textPaddingHorizontal;\n\t\t\tthis.textPaddingVertical = textPaddingVertical;\n\t\t\tthis.textClipping = textClipping;\n\t\t\tthis.textTexture = textTexture;\n\t\t\tthis.textTextureTransformId = textTextureTransformId;\n\n\t\t\tif( isCharSizeChanged ) {\n\t\t\t\t// Invalidate the text weight to update the text steps.\n\t\t\t\tthis.textWeight = NaN;\n\t\t\t}\n\n\t\t\t// Calculate the transformed positions\n\t\t\t//\n\t\t\t//  0               1\n\t\t\t// |---------------|\n\t\t\t// |               |\n\t\t\t// |3              |2\n\t\t\t// |---------------|\n\t\t\t//\n\t\t\tconst size = shape.size;\n\t\t\tconst sx = size.x * 0.5;\n\t\t\tconst sy = size.y * 0.5;\n\t\t\tshape.updateTransform();\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst work = buffer.work;\n\t\t\twork.set( -sx, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x0 = work.x;\n\t\t\tconst y0 = work.y;\n\t\t\twork.set( +sx, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x1 = work.x;\n\t\t\tconst y1 = work.y;\n\t\t\twork.set( +sx, +sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x2 = work.x;\n\t\t\tconst y2 = work.y;\n\t\t\tconst x3 = x0 + (x2 - x1);\n\t\t\tconst y3 = y0 + (y2 - y1);\n\n\t\t\t// Horizontal normal\n\t\t\tconst hl = this.calcLength( x0, y0, x1, y1 );\n\t\t\tthis.normalize( internalTransform.a, internalTransform.b, 1, 0, work );\n\t\t\tlet hnx = work.x;\n\t\t\tlet hny = work.y;\n\n\t\t\t// Vertical normal\n\t\t\tconst vl = this.calcLength( x0, y0, x3, y3 );\n\t\t\tthis.normalize( internalTransform.c, internalTransform.d, 0, 1, work );\n\t\t\tlet vnx = work.x;\n\t\t\tlet vny = work.y;\n\n\t\t\t// Calculate the width / height\n\t\t\tlet width = 0;\n\t\t\tlet height = 0;\n\t\t\tlet heightChar = 0;\n\t\t\tconst lineHeight = Math.max( 0, textSize + textSpacingVertical );\n\t\t\tlet lineWidth = 0;\n\t\t\tconst textAtlasCharacters = textAtlas.characters;\n\t\t\tfor( let i = 0, imax = textValue.length; i < imax; ++i ) {\n\t\t\t\tconst character = textValue[ i ];\n\t\t\t\tif( character !== \"\\n\" ) {\n\t\t\t\t\tconst data = textAtlasCharacters[ character ];\n\t\t\t\t\tif( data != null ) {\n\t\t\t\t\t\tlineWidth += this.toAdvance( i, imax, textValue, data.advance, textSpacingHorizontal );\n\t\t\t\t\t\theightChar = data.height;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\twidth = Math.max( width, lineWidth );\n\t\t\t\t\tlineWidth = 0;\n\t\t\t\t\theight += lineHeight;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst scale = textSize / textAtlas.font.size;\n\t\t\twidth = Math.max( width, lineWidth ) * scale;\n\t\t\theightChar *= scale;\n\t\t\theight += textSize;\n\n\t\t\t//\n\t\t\tlet tx0 = 0;\n\t\t\tlet ty0 = 0;\n\t\t\tlet lineWidthMaximum = NaN;\n\t\t\tswitch( textDirection ) {\n\t\t\tcase EShapeTextDirection.LEFT_TO_RIGHT:\n\t\t\t\tthis.getTextBBox(\n\t\t\t\t\ttextAlignHorizontal,\n\t\t\t\t\ttextAlignVertical,\n\t\t\t\t\ttextOffsetHorizontal,\n\t\t\t\t\ttextOffsetVertical,\n\t\t\t\t\ttextPaddingHorizontal,\n\t\t\t\t\ttextPaddingVertical,\n\t\t\t\t\twidth, height,\n\t\t\t\t\tx0, y0,\n\t\t\t\t\tx1, y1,\n\t\t\t\t\tx2, y2,\n\t\t\t\t\tx3, y3,\n\t\t\t\t\thnx, hny,\n\t\t\t\t\tvnx, vny,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\ttx0 = work.x;\n\t\t\t\tty0 = work.y;\n\t\t\t\tif( textClipping ) {\n\t\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t\t\tlineWidthMaximum = hl - textPaddingHorizontal * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.TOP_TO_BOTTOM:\n\t\t\t\t// Swap normals\n\t\t\t\twork.set( vnx, vny );\n\t\t\t\tvnx = -hnx;\n\t\t\t\tvny = -hny;\n\t\t\t\thnx = work.x;\n\t\t\t\thny = work.y;\n\n\t\t\t\t// Get text bbox\n\t\t\t\tthis.getTextBBox(\n\t\t\t\t\tthis.rotateAlignVerticalRight( textAlignVertical ),\n\t\t\t\t\tthis.rotateAlignHorizontalRight( textAlignHorizontal ),\n\t\t\t\t\ttextOffsetVertical,\n\t\t\t\t\ttextOffsetHorizontal,\n\t\t\t\t\ttextPaddingVertical,\n\t\t\t\t\ttextPaddingHorizontal,\n\t\t\t\t\twidth, height,\n\t\t\t\t\tx1, y1,\n\t\t\t\t\tx2, y2,\n\t\t\t\t\tx3, y3,\n\t\t\t\t\tx0, y0,\n\t\t\t\t\thnx, hny,\n\t\t\t\t\tvnx, vny,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\ttx0 = work.x;\n\t\t\t\tty0 = work.y;\n\t\t\t\tif( textClipping ) {\n\t\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\t\t\tlineWidthMaximum = vl - textPaddingVertical * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.BOTTOM_TO_TOP:\n\t\t\t\t// Swap normals\n\t\t\t\twork.set( vnx, vny );\n\t\t\t\tvnx = hnx;\n\t\t\t\tvny = hny;\n\t\t\t\thnx = -work.x;\n\t\t\t\thny = -work.y;\n\n\t\t\t\t// Get text bbox\n\t\t\t\tthis.getTextBBox(\n\t\t\t\t\tthis.rotateAlignVerticalLeft( textAlignVertical ),\n\t\t\t\t\tthis.rotateAlignHorizontalLeft( textAlignHorizontal ),\n\t\t\t\t\ttextOffsetVertical,\n\t\t\t\t\ttextOffsetHorizontal,\n\t\t\t\t\ttextPaddingVertical,\n\t\t\t\t\ttextPaddingHorizontal,\n\t\t\t\t\twidth, height,\n\t\t\t\t\tx3, y3,\n\t\t\t\t\tx0, y0,\n\t\t\t\t\tx1, y1,\n\t\t\t\t\tx2, y2,\n\t\t\t\t\thnx, hny,\n\t\t\t\t\tvnx, vny,\n\t\t\t\t\twork\n\t\t\t\t);\n\t\t\t\ttx0 = work.x;\n\t\t\t\tty0 = work.y;\n\t\t\t\tif( textClipping ) {\n\t\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\t\t\tlineWidthMaximum = vl - textPaddingVertical * 2;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\t//\n\t\t\tconst textWorld = text.world = text.world || new Float32Array( 8 );\n\t\t\tif( lineWidthMaximum < width ) {\n\t\t\t\tconst dwidth = ( width - lineWidthMaximum ) * 0.5;\n\t\t\t\ttextWorld[ 0 ] = tx0 + hnx * dwidth;\n\t\t\t\ttextWorld[ 1 ] = ty0 + hny * dwidth;\n\t\t\t\ttextWorld[ 2 ] = hnx;\n\t\t\t\ttextWorld[ 3 ] = hny;\n\t\t\t\ttextWorld[ 4 ] = vnx;\n\t\t\t\ttextWorld[ 5 ] = vny;\n\t\t\t\ttextWorld[ 6 ] = lineWidthMaximum;\n\t\t\t\ttextWorld[ 7 ] = height;\n\t\t\t} else {\n\t\t\t\ttextWorld[ 0 ] = tx0;\n\t\t\t\ttextWorld[ 1 ] = ty0;\n\t\t\t\ttextWorld[ 2 ] = hnx;\n\t\t\t\ttextWorld[ 3 ] = hny;\n\t\t\t\ttextWorld[ 4 ] = vnx;\n\t\t\t\ttextWorld[ 5 ] = vny;\n\t\t\t\ttextWorld[ 6 ] = width;\n\t\t\t\ttextWorld[ 7 ] = height;\n\t\t\t}\n\n\t\t\t// Texture\n\t\t\tconst textureUvs = this.toTextureUvs( textTexture ) as any;\n\t\t\tconst uvx0 = textureUvs.x0;\n\t\t\tconst uvx1 = textureUvs.x1;\n\t\t\tconst uvx3 = textureUvs.x3;\n\t\t\tconst uvy0 = textureUvs.y0;\n\t\t\tconst uvy1 = textureUvs.y1;\n\t\t\tconst uvy3 = textureUvs.y3;\n\n\t\t\tconst duvx01 = ( uvx1 - uvx0 );\n\t\t\tconst duvy01 = ( uvy1 - uvy0 );\n\t\t\tconst duvx03 = ( uvx3 - uvx0 );\n\t\t\tconst duvy03 = ( uvy3 - uvy0 );\n\n\t\t\t// Vertices & UVs\n\t\t\tconst vcount = this.textVertexCount;\n\t\t\tconst voffset = this.vertexOffset + this.vertexCount - vcount;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tbuffer.vertexBuffer.update();\n\t\t\tbuffer.uvBuffer.update();\n\n\t\t\tconst lhx = lineHeight * vnx;\n\t\t\tconst lhy = lineHeight * vny;\n\n\t\t\tconst snx = scale * hnx;\n\t\t\tconst sny = scale * hny;\n\n\t\t\tconst offsetY = (heightChar - textSize) * 0.5;\n\t\t\tconst oyx = offsetY * vnx;\n\t\t\tconst oyy = offsetY * vny;\n\n\t\t\tconst offsetItalic = ( textStyle === EShapeTextStyle.NORMAL ? 0 : text.size * 0.25 );\n\t\t\tlet bx0 = tx0 - oyx + offsetItalic * snx;\n\t\t\tlet by0 = ty0 - oyy + offsetItalic * sny;\n\t\t\tlet bx3 = tx0 + oyx + textSize * vnx;\n\t\t\tlet by3 = ty0 + oyy + textSize * vny;\n\t\t\tlet cx0 = bx0;\n\t\t\tlet cy0 = by0;\n\t\t\tlet cx3 = bx3;\n\t\t\tlet cy3 = by3;\n\n\t\t\tlineWidth = 0;\n\t\t\tlet lineCount = 0;\n\t\t\tconst textValueLength = textValue.length;\n\t\t\tfor( let i = 0, iv = voffset * 2; i < textValueLength; i += 1, iv += 8 ) {\n\t\t\t\tconst character = textValue[ i ];\n\t\t\t\tif( character !== \"\\n\" ) {\n\t\t\t\t\tconst data = textAtlasCharacters[ character ];\n\t\t\t\t\tlineCount += 1;\n\t\t\t\t\tif( data != null ) {\n\t\t\t\t\t\tconst advance = this.toAdvance( i, textValueLength, textValue, data.advance, textSpacingHorizontal );\n\t\t\t\t\t\tlineWidth += advance * scale;\n\t\t\t\t\t\tif( lineWidthMaximum < lineWidth ) {\n\t\t\t\t\t\t\tconst dots = textAtlasCharacters[ \"...\" ];\n\t\t\t\t\t\t\tif( dots != null ) {\n\t\t\t\t\t\t\t\tthis.writeCharacter(\n\t\t\t\t\t\t\t\t\tvertices, uvs, iv, dots, textAtlas,\n\t\t\t\t\t\t\t\t\tsnx, sny,\n\t\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\t\tduvx01, duvy01, duvx03, duvy03,\n\t\t\t\t\t\t\t\t\tuvx0, uvy0\n\t\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\t\tconst dotsAdvance = this.toAdvance( i, textValueLength, textValue, dots.advance, textSpacingHorizontal );\n\t\t\t\t\t\t\t\tconst ax = dotsAdvance * snx;\n\t\t\t\t\t\t\t\tconst ay = dotsAdvance * sny;\n\t\t\t\t\t\t\t\tlineWidth += (dotsAdvance - advance) * scale;\n\t\t\t\t\t\t\t\tcx0 = cx0 + ax;\n\t\t\t\t\t\t\t\tcy0 = cy0 + ay;\n\t\t\t\t\t\t\t\tcx3 = cx3 + ax;\n\t\t\t\t\t\t\t\tcy3 = cy3 + ay;\n\n\t\t\t\t\t\t\t\tfor( i += 1, iv += 8; i < textValueLength; i += 1, iv += 8 ) {\n\t\t\t\t\t\t\t\t\tif( textValue[ i ] !== \"\\n\" ) {\n\t\t\t\t\t\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\tlineCount += 1;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\ti -= 1;\n\t\t\t\t\t\t\t\t\t\tiv -= 8;\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis.writeCharacter(\n\t\t\t\t\t\t\t\tvertices, uvs, iv, data, textAtlas,\n\t\t\t\t\t\t\t\tsnx, sny,\n\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\tduvx01, duvy01, duvx03, duvy03,\n\t\t\t\t\t\t\t\tuvx0, uvy0\n\t\t\t\t\t\t\t);\n\n\t\t\t\t\t\t\tconst ax = advance * snx;\n\t\t\t\t\t\t\tconst ay = advance * sny;\n\t\t\t\t\t\t\tcx0 = cx0 + ax;\n\t\t\t\t\t\t\tcy0 = cy0 + ay;\n\t\t\t\t\t\t\tcx3 = cx3 + ax;\n\t\t\t\t\t\t\tcy3 = cy3 + ay;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.writeCharacterEmpty(\n\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t);\n\n\t\t\t\t\tbx0 += lhx;\n\t\t\t\t\tby0 += lhy;\n\t\t\t\t\tbx3 += lhx;\n\t\t\t\t\tby3 += lhy;\n\t\t\t\t\tcx0 = bx0;\n\t\t\t\t\tcy0 = by0;\n\t\t\t\t\tcx3 = bx3;\n\t\t\t\t\tcy3 = by3;\n\n\t\t\t\t\tthis.adjustTextAlignment(\n\t\t\t\t\t\tvertices,\n\t\t\t\t\t\thnx, hny,\n\t\t\t\t\t\tlineCount,\n\t\t\t\t\t\tiv,\n\t\t\t\t\t\twidth - lineWidth,\n\t\t\t\t\t\ttextDirection,\n\t\t\t\t\t\ttextAlignHorizontal,\n\t\t\t\t\t\ttextAlignVertical\n\t\t\t\t\t);\n\t\t\t\t\tlineWidth = 0;\n\t\t\t\t\tlineCount = 0;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.adjustTextAlignment(\n\t\t\t\tvertices,\n\t\t\t\thnx, hny,\n\t\t\t\tlineCount,\n\t\t\t\tvoffset * 2 + textValueLength * 8,\n\t\t\t\twidth - lineWidth,\n\t\t\t\ttextDirection,\n\t\t\t\ttextAlignHorizontal,\n\t\t\t\ttextAlignVertical\n\t\t\t);\n\n\t\t\tfor( let i = voffset * 2 + textValue.length * 8, imax = (voffset + vcount) * 2; i < imax; i += 2 ) {\n\t\t\t\tvertices[ i + 0 ] = tx0;\n\t\t\t\tvertices[ i + 1 ] = ty0;\n\t\t\t\tuvs[ i + 0 ] = uvx0;\n\t\t\t\tuvs[ i + 1 ] = uvy0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toAdvance( index: number, size: number, text: string, advance: number, spacing: number ): number {\n\t\treturn (\n\t\t\tindex + 1 < size && text[ index + 1 ] !== \"\\n\" ?\n\t\t\tMath.max( 0, advance + spacing ) : advance\n\t\t);\n\t}\n\n\tprotected writeCharacterEmpty(\n\t\tvertices: Float32Array, uvs: Float32Array, iv: number,\n\t\tcx0: number, cy0: number,\n\t\tcx3: number, cy3: number,\n\t\tuvx0: number, uvy0: number,\n\t\tuvx3: number, uvy3: number\n\t): void {\n\t\tvertices[ iv + 0 ] = cx0;\n\t\tvertices[ iv + 1 ] = cy0;\n\t\tvertices[ iv + 2 ] = cx0;\n\t\tvertices[ iv + 3 ] = cy0;\n\t\tvertices[ iv + 4 ] = cx3;\n\t\tvertices[ iv + 5 ] = cy3;\n\t\tvertices[ iv + 6 ] = cx3;\n\t\tvertices[ iv + 7 ] = cy3;\n\n\t\tuvs[ iv + 0 ] = uvx0;\n\t\tuvs[ iv + 1 ] = uvy0;\n\t\tuvs[ iv + 2 ] = uvx0;\n\t\tuvs[ iv + 3 ] = uvy0;\n\t\tuvs[ iv + 4 ] = uvx3;\n\t\tuvs[ iv + 5 ] = uvy3;\n\t\tuvs[ iv + 6 ] = uvx3;\n\t\tuvs[ iv + 7 ] = uvy3;\n\t}\n\n\tprotected writeCharacter(\n\t\tvertices: Float32Array, uvs: Float32Array, iv: number,\n\t\tdata: EShapeTextAtlasCharacter, atlas: EShapeTextAtlas,\n\t\tsnx: number, sny: number,\n\t\tcx0: number, cy0: number,\n\t\tcx3: number, cy3: number,\n\t\tduvx01: number, duvy01: number,\n\t\tduvx03: number, duvy03: number,\n\t\tuvx0: number, uvy0: number\n\t): void {\n\t\t// Vertices\n\t\tconst dataOffsetX = data.x - data.origin.x;\n\t\tconst dataWidth = data.width;\n\t\tconst dx0 = dataOffsetX * snx;\n\t\tconst dy0 = dataOffsetX * sny;\n\t\tconst dx1 = (dataOffsetX + dataWidth) * snx;\n\t\tconst dy1 = (dataOffsetX + dataWidth) * sny;\n\t\tvertices[ iv + 0 ] = cx0 + dx0;\n\t\tvertices[ iv + 1 ] = cy0 + dy0;\n\t\tvertices[ iv + 2 ] = cx0 + dx1;\n\t\tvertices[ iv + 3 ] = cy0 + dy1;\n\t\tvertices[ iv + 4 ] = cx3 + dx1;\n\t\tvertices[ iv + 5 ] = cy3 + dy1;\n\t\tvertices[ iv + 6 ] = cx3 + dx0;\n\t\tvertices[ iv + 7 ] = cy3 + dy0;\n\n\t\t// UVs\n\t\tconst px0 = data.x / atlas.width;\n\t\tconst py0 = data.y / atlas.height;\n\t\tconst px1 = (data.x + data.width) / atlas.width;\n\t\tconst py1 = (data.y + data.height) / atlas.height;\n\n\t\tconst dux0 = duvx01 * px0;\n\t\tconst duy0 = duvy01 * px0;\n\t\tconst dux1 = duvx01 * px1;\n\t\tconst duy1 = duvy01 * px1;\n\n\t\tconst dvx0 = duvx03 * py0;\n\t\tconst dvy0 = duvy03 * py0;\n\t\tconst dvx1 = duvx03 * py1;\n\t\tconst dvy1 = duvy03 * py1;\n\t\tuvs[ iv + 0 ] = uvx0 + dux0 + dvx0;\n\t\tuvs[ iv + 1 ] = uvy0 + duy0 + dvy0;\n\t\tuvs[ iv + 2 ] = uvx0 + dux1 + dvx0;\n\t\tuvs[ iv + 3 ] = uvy0 + duy1 + dvy0;\n\t\tuvs[ iv + 4 ] = uvx0 + dux1 + dvx1;\n\t\tuvs[ iv + 5 ] = uvy0 + duy1 + dvy1;\n\t\tuvs[ iv + 6 ] = uvx0 + dux0 + dvx1;\n\t\tuvs[ iv + 7 ] = uvy0 + duy0 + dvy1;\n\t}\n\n\tprotected moveText( vertices: Float32Array, vertexIndex: number, textCount: number, dx: number, dy: number ): void {\n\t\tfor( let i = 0, iv = vertexIndex - 8 * textCount; i < textCount; i += 1, iv += 8 ) {\n\t\t\tvertices[ iv + 0 ] += dx;\n\t\t\tvertices[ iv + 1 ] += dy;\n\t\t\tvertices[ iv + 2 ] += dx;\n\t\t\tvertices[ iv + 3 ] += dy;\n\t\t\tvertices[ iv + 4 ] += dx;\n\t\t\tvertices[ iv + 5 ] += dy;\n\t\t\tvertices[ iv + 6 ] += dx;\n\t\t\tvertices[ iv + 7 ] += dy;\n\t\t}\n\t}\n\n\tprotected moveTextHalf(\n\t\tvertices: Float32Array, vertexIndex: number, textCount: number,\n\t\toffset: number, nx: number, ny: number\n\t): void {\n\t\toffset *= 0.5;\n\t\tthis.moveText( vertices, vertexIndex, textCount, offset * nx, offset * ny );\n\t}\n\n\tprotected moveTextFull(\n\t\tvertices: Float32Array, vertexIndex: number, textCount: number,\n\t\toffset: number, nx: number, ny: number\n\t): void {\n\t\tthis.moveText( vertices, vertexIndex, textCount, offset * nx, offset * ny );\n\t}\n\n\tprotected adjustTextAlignment(\n\t\tvertices: Float32Array,\n\t\tnx: number, ny: number,\n\t\tlineCount: number, vertexIndex: number,\n\t\toffset: number,\n\t\ttextDirection: EShapeTextDirection,\n\t\ttextAlignHorizontal: EShapeTextAlignHorizontal,\n\t\ttextAlignVertical: EShapeTextAlignVertical\n\t): void {\n\t\tif( FMIN < offset ) {\n\t\t\tswitch( textDirection ) {\n\t\t\tcase EShapeTextDirection.LEFT_TO_RIGHT:\n\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t\t// DO NOTHING\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\t\tthis.moveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\tthis.moveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.TOP_TO_BOTTOM:\n\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\t// DO NOTHING\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tthis.moveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\tthis.moveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextDirection.BOTTOM_TO_TOP:\n\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t\tthis.moveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\t\tthis.moveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\t// DO NOTHING\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateTextColorFill( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst color = text.color;\n\t\tconst alpha = ( shape.visible && text.enable ? text.alpha : 0 );\n\t\tif( color !== this.textColor || alpha !== this.textAlpha ) {\n\t\t\tthis.textColor = color;\n\t\t\tthis.textAlpha = alpha;\n\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\tthis.fillColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset + this.vertexCount - this.textVertexCount,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\tbuffer.colorFills\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextColorStroke( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst outline = text.outline;\n\t\tconst color = outline.color;\n\t\tconst alpha = ( shape.visible && text.enable ? outline.alpha : 0 );\n\t\tif( color !== this.textOutlineColor || alpha !== this.textOutlineAlpha ) {\n\t\t\tthis.textOutlineColor = color;\n\t\t\tthis.textOutlineAlpha = alpha;\n\t\t\tbuffer.colorStrokeBuffer.update();\n\n\t\t\tthis.fillColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset + this.vertexCount - this.textVertexCount,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\tbuffer.colorStrokes\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextStep( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst textOutline = text.outline;\n\t\tconst textOutlineWidth = (textOutline.enable ? textOutline.width : 0);\n\t\tconst textWeight = text.weight;\n\t\tif( textWeight !== this.textWeight || textOutlineWidth !== this.textOutlineWidth ) {\n\t\t\tthis.textWeight = textWeight;\n\t\t\tthis.textOutlineWidth = textOutlineWidth;\n\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst vcount = this.textVertexCount;\n\t\t\tconst voffset = this.vertexOffset + this.vertexCount - vcount;\n\n\t\t\tconst textAtlas = text.atlas;\n\t\t\tif( textAtlas != null ) {\n\t\t\t\tconst scale = 0.05 / (text.size / textAtlas.font.size);\n\t\t\t\tconst outlineWidth = textOutlineWidth * 0.4;\n\t\t\t\tconst weight =  -0.025 + ( textWeight === EShapeTextWeight.NORMAL ? 0.0 : 0.05 );\n\t\t\t\tfor( let i = voffset * 2, imax = i + vcount * 2; i < imax; i += 2 ) {\n\t\t\t\t\tsteps[ i + 0 ] = scale;\n\t\t\t\t\tsteps[ i + 1 ] = outlineWidth;\n\t\t\t\t}\n\t\t\t\tfor( let i = voffset * 4, imax = i + vcount * 4; i < imax; i += 4 ) {\n\t\t\t\t\tantialiases[ i +  0 ] = weight;\n\t\t\t\t\tantialiases[ i +  1 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  2 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  3 ] = FMIN;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = voffset * 2, imax = i + vcount * 2; i < imax; i += 2 ) {\n\t\t\t\t\tsteps[ i + 0 ] = 0;\n\t\t\t\t\tsteps[ i + 1 ] = 0;\n\t\t\t\t}\n\t\t\t\tfor( let i = voffset * 4, imax = i + vcount * 4; i < imax; i += 4 ) {\n\t\t\t\t\tantialiases[ i +  0 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  1 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  2 ] = FMIN;\n\t\t\t\t\tantialiases[ i +  3 ] = FMIN;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateText( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst vcount = this.textVertexCount;\n\t\tif( 0 < vcount ) {\n\t\t\tconst textAtlas = shape.text.atlas;\n\t\t\tif( textAtlas != null ) {\n\t\t\t\tthis.updateTextVertex( buffer, shape, textAtlas );\n\t\t\t\tthis.updateTextColorFill( buffer, shape );\n\t\t\t\tthis.updateTextColorStroke( buffer, shape );\n\t\t\t\tthis.updateTextStep( buffer, shape );\n\t\t\t}\n\t\t}\n\t}\n\n\tinitText() {\n\t\tconst vcount = this.textVertexCount;\n\t\tif( 0 < vcount ) {\n\t\t\tconst icount = this.textIndexCount;\n\t\t\tconst voffset = this.vertexOffset + this.vertexCount - vcount;\n\t\t\tconst ioffset = this.indexOffset + this.indexCount - icount;\n\t\t\tconst buffer = this.buffer;\n\n\t\t\t// Clippings\n\t\t\tbuffer.clippingBuffer.update();\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tfor( let i = voffset * 3, imax = i + vcount * 3; i < imax; i += 3 ) {\n\t\t\t\tclippings[ i + 0 ] = 0;\n\t\t\t\tclippings[ i + 1 ] = 0;\n\t\t\t\tclippings[ i + 2 ] = 2;\n\t\t\t}\n\n\t\t\t// Indices\n\t\t\tbuffer.indexBuffer.update();\n\t\t\tconst indices = buffer.indices;\n\t\t\tfor( let i = 0, ii = ioffset * 3, imax = (icount >> 1); i < imax; i += 1, ii += 6 ) {\n\t\t\t\tconst j = voffset + ( i << 2 );\n\t\t\t\tindices[ ii + 0 ] = j + 0;\n\t\t\t\tindices[ ii + 1 ] = j + 1;\n\t\t\t\tindices[ ii + 2 ] = j + 3;\n\n\t\t\t\tindices[ ii + 3 ] = j + 1;\n\t\t\t\tindices[ ii + 4 ] = j + 2;\n\t\t\t\tindices[ ii + 5 ] = j + 3;\n\t\t\t}\n\t\t}\n\t}\n\n\tbuildUnit( builder: EShapeBufferUnitBuilder ) {\n\t\tsuper.buildUnit( builder );\n\n\t\tif( 0 < this.textVertexCount ) {\n\t\t\tconst textTexture = this.textTexture || Texture.WHITE;\n\t\t\tconst textBaseTexture = textTexture.baseTexture;\n\t\t\tif( textBaseTexture !== builder.baseTexture ) {\n\t\t\t\tbuilder.baseTexture = textBaseTexture;\n\t\t\t\tconst indexOffset = this.indexOffset + this.indexCount - this.textIndexCount;\n\t\t\t\tbuilder.push( textTexture, indexOffset );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapePointsStyleUploadeds } from \"../e-shape-points-style-uploadeds\";\nimport { EShapeBar } from \"./e-shape-bar\";\nimport { EShapeBarPoints } from \"./e-shape-bar-points\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nconst FMIN: number = 0.00001;\n\nexport class EShapeBarUploaded extends EShapeTextUploaded {\n\tprotected pointsId: number;\n\tprotected pointsStyle: EShapePointsStyle;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount );\n\t\tthis.pointsId = NaN;\n\t\tthis.pointsStyle = EShapePointsStyle.NONE;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\n\t\t// Clipping & indices\n\t\tbuffer.clippingBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\n\t\t// Clippings\n\t\tconst ic = voffset * 3;\n\t\tclippings[ ic +  0 ] = 1;\n\t\tclippings[ ic +  1 ] = 0;\n\t\tclippings[ ic +  2 ] = 3;\n\n\t\tclippings[ ic +  3 ] = 0;\n\t\tclippings[ ic +  4 ] = 1;\n\t\tclippings[ ic +  5 ] = 5;\n\n\t\tclippings[ ic +  6 ] = 1;\n\t\tclippings[ ic +  7 ] = 0;\n\t\tclippings[ ic +  8 ] = 3;\n\n\t\tclippings[ ic +  9 ] = 0;\n\t\tclippings[ ic + 10 ] = 1;\n\t\tclippings[ ic + 11 ] = 5;\n\n\t\t// Indices\n\t\tconst ii = ioffset * 3;\n\t\tindices[ ii + 0 ] = voffset + 0;\n\t\tindices[ ii + 1 ] = voffset + 2;\n\t\tindices[ ii + 2 ] = voffset + 1;\n\n\t\tindices[ ii + 3 ] = voffset + 1;\n\t\tindices[ ii + 4 ] = voffset + 2;\n\t\tindices[ ii + 5 ] = voffset + 3;\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\t//\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tif( shape instanceof EShapeBar ) {\n\t\t\tconst size = shape.size;\n\t\t\tconst sizeX = size.x;\n\t\t\tconst sizeY = size.y;\n\t\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\t\tconst stroke = shape.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tconst isStrokeWidthChanged = ( strokeWidth !== this.strokeWidth );\n\t\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\t\tconst pointsId = shape.points.id;\n\t\t\tconst isPointsIdChanged = ( pointsId !== this.pointsId );\n\t\t\tconst pointsStyle = shape.points.style;\n\t\t\tconst isPointsStyleChanged = ( pointsStyle !== this.pointsStyle );\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeWidthChanged || isPointsIdChanged || isPointsStyleChanged ) {\n\t\t\t\tthis.sizeX = sizeX;\n\t\t\t\tthis.sizeY = sizeY;\n\t\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\t\tthis.pointsId = pointsId;\n\t\t\t\tthis.pointsStyle = pointsStyle;\n\t\t\t\tbuffer.vertexBuffer.update();\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\t\tif( isSizeChanged || isTransformChanged ) {\n\t\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t\t}\n\t\t\t\tif( isPointsIdChanged ) {\n\t\t\t\t\t// Invalidate the texture transform ID to update the UVs\n\t\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t\t}\n\n\t\t\t\tconst voffset = this.vertexOffset;\n\t\t\t\tconst vcount = this.vertexCount - this.textVertexCount;\n\t\t\t\tthis.updateLineVertexStepAndColorFill(\n\t\t\t\t\tbuffer,\n\t\t\t\t\tshape.points,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.transform.internalTransform,\n\t\t\t\t\tvoffset, vcount\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateBarUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ): void {\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tprotected updateLineVertexStepAndColorFill(\n\t\tbuffer: EShapeBuffer,\n\t\tpoints: EShapeBarPoints,\n\t\tstrokeWidth: number,\n\t\tinternalTransform: Matrix,\n\t\tvoffset: number,\n\t\tvcount: number\n\t): void {\n\t\tconst iv = voffset * 2;\n\t\tconst ia = voffset * 4;\n\t\tconst vertices = buffer.vertices;\n\t\tconst steps = buffer.steps;\n\t\tconst antialiases = buffer.antialiases;\n\t\tconst colorFills = buffer.colorFills;\n\t\tconst pointCount = points.length;\n\t\tconst pointValues = points.values;\n\t\tconst pointsStyle = points.style;\n\t\tconst pointsSize = points.size;\n\t\tconst scaleInvariant = EShapePointsStyleUploadeds.toScaleInvariant( pointsStyle );\n\n\t\t// First point\n\t\tconst work = buffer.work;\n\t\twork.set( pointValues[ 0 ], pointValues[ 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tconst p1x = work.x;\n\t\tconst p1y = work.y;\n\n\t\t// Last point\n\t\tconst lastIndex = (pointCount - 1) << 1;\n\t\twork.set( pointValues[ lastIndex + 0 ], pointValues[ lastIndex + 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tlet p2x = work.x;\n\t\tlet p2y = work.y;\n\n\t\t// Normal\n\t\tlet dx = p2x - p1x;\n\t\tlet dy = p2y - p1y;\n\t\tconst d = Math.sqrt( dx * dx + dy * dy );\n\t\tlet l = d;\n\t\tif( 0 <= pointsSize && FMIN < d ) {\n\t\t\tconst ratio = pointsSize / d;\n\t\t\tdx *= ratio;\n\t\t\tdy *= ratio;\n\t\t\tp2x = p1x + dx;\n\t\t\tp2y = p1y + dy;\n\t\t\tl = pointsSize;\n\t\t}\n\n\t\t// Other points\n\t\tconst p0x = p1x - dx;\n\t\tconst p0y = p1y - dy;\n\t\tconst p3x = p2x + dx;\n\t\tconst p3y = p2y + dy;\n\n\t\t//\n\t\tvertices[ iv + 0 ] = p1x;\n\t\tvertices[ iv + 1 ] = p1y;\n\t\tvertices[ iv + 2 ] = p1x;\n\t\tvertices[ iv + 3 ] = p1y;\n\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\tantialiases[ ia + 0 ] = p0x;\n\t\tantialiases[ ia + 1 ] = p0y;\n\t\tantialiases[ ia + 2 ] = p2x;\n\t\tantialiases[ ia + 3 ] = p2y;\n\t\tantialiases[ ia + 4 ] = p0x;\n\t\tantialiases[ ia + 5 ] = p0y;\n\t\tantialiases[ ia + 6 ] = p2x;\n\t\tantialiases[ ia + 7 ] = p2y;\n\t\tcolorFills[ ia + 0 ] = 0.0;\n\t\tcolorFills[ ia + 4 ] = 0.0;\n\n\t\tvertices[ iv + 4 ] = p2x;\n\t\tvertices[ iv + 5 ] = p2y;\n\t\tvertices[ iv + 6 ] = p2x;\n\t\tvertices[ iv + 7 ] = p2y;\n\t\tsteps[ iv + 4 ] = strokeWidth;\n\t\tsteps[ iv + 5 ] = scaleInvariant;\n\t\tsteps[ iv + 6 ] = strokeWidth;\n\t\tsteps[ iv + 7 ] = scaleInvariant;\n\t\tantialiases[ ia +  8 ] = p1x;\n\t\tantialiases[ ia +  9 ] = p1y;\n\t\tantialiases[ ia + 10 ] = p3x;\n\t\tantialiases[ ia + 11 ] = p3y;\n\t\tantialiases[ ia + 12 ] = p1x;\n\t\tantialiases[ ia + 13 ] = p1y;\n\t\tantialiases[ ia + 14 ] = p3x;\n\t\tantialiases[ ia + 15 ] = p3y;\n\t\tcolorFills[ ia +  8 ] = l;\n\t\tcolorFills[ ia + 12 ] = l;\n\n\t\t// Total length\n\t\tEShapePointsStyleUploadeds.toDash( l, strokeWidth, pointsStyle, work );\n\t\tconst dash0 = work.x;\n\t\tconst dash1 = work.y;\n\t\tfor( let i = voffset * 4, imax = i + vcount * 4; i < imax; i += 4 ) {\n\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\tcolorFills[ i + 3 ] = l;\n\t\t}\n\t}\n\n\tupdateBarUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\n\t\t\t// Uvs\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst iuv = voffset * 2;\n\n\t\t\tuvs[ iuv + 0 ] = textureUvs.x0;\n\t\t\tuvs[ iuv + 1 ] = textureUvs.y0;\n\t\t\tuvs[ iuv + 2 ] = textureUvs.x3;\n\t\t\tuvs[ iuv + 3 ] = textureUvs.y3;\n\n\t\t\tuvs[ iuv + 4 ] = textureUvs.x1;\n\t\t\tuvs[ iuv + 5 ] = textureUvs.y1;\n\t\t\tuvs[ iuv + 6 ] = textureUvs.x2;\n\t\t\tuvs[ iuv + 7 ] = textureUvs.y2;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeBarUploaded } from \"./e-shape-bar-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeBarUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n\t): EShapeBarUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = 4 + tvcount;\n\t\tconst icount = 2 + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeBarUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutlineLike } from \"../e-shape-text-outline\";\n\nexport class EShapeActionBases {\n\tstatic toBaseFill( shape: EShape, runtime: EShapeRuntime ): EShapeFillLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_FILL ? shape : runtime ).fill;\n\t}\n\n\tstatic toBaseStroke( shape: EShape, runtime: EShapeRuntime ): EShapeStrokeLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_STROKE ? shape : runtime ).stroke;\n\t}\n\n\tstatic toBaseText( shape: EShape, runtime: EShapeRuntime ): EShapeTextLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_TEXT ? shape : runtime ).text;\n\t}\n\n\tstatic toBaseTextOutline( shape: EShape, runtime: EShapeRuntime ): EShapeTextOutlineLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ? shape : runtime ).text.outline;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../../d-applications\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\n\nexport type EShapeActionExpression<T> = ( shape: EShape, time: number ) => T;\n\nexport class EShapeActionRuntime {\n\treset: EShapeRuntimeReset;\n\n\tconstructor( reset?: EShapeRuntimeReset ) {\n\t\tthis.reset = reset || EShapeRuntimeReset.NONE;\n\t}\n\n\ttoExpression<T>(\n\t\texpression: string, def: EShapeActionExpression<T>, defLiteral: string\n\t): EShapeActionExpression<T> {\n\t\tif( expression.trim().length <= 0 ) {\n\t\t\treturn def;\n\t\t}\n\n\t\ttry {\n\t\t\treturn Function(\n\t\t\t\t\"shape\", \"time\",\n\t\t\t\t`try{ with( shape ) { return (${expression}); } } catch( e ) { return ${defLiteral}; }`\n\t\t\t) as EShapeActionExpression<T>;\n\t\t} catch( e ) {\n\t\t\treturn def;\n\t\t}\n\t}\n\n\temit( name: string, shape: EShape, parameter1?: unknown, parameter2?: unknown ): void {\n\t\tif( parameter1 === undefined ) {\n\t\t\tshape.emit( name, shape );\n\t\t} else if( parameter2 === undefined ) {\n\t\t\tshape.emit( name, shape, parameter1 );\n\t\t} else {\n\t\t\tshape.emit( name, shape, parameter1, parameter2 );\n\t\t}\n\n\t\tconst application = DApplications.getInstance() as any;\n\t\tif( \"shape\" in application ) {\n\t\t\tif( parameter1 === undefined ) {\n\t\t\t\tapplication.shape.emit( name, shape );\n\t\t\t} else if( parameter2 === undefined ) {\n\t\t\t\tapplication.shape.emit( name, shape, parameter1 );\n\t\t\t} else {\n\t\t\t\tapplication.shape.emit( name, shape, parameter1, parameter2 );\n\t\t\t}\n\t\t}\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\t// OVERRIDE THIS\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression, EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\n\nconst conditionDefault = (): boolean => true;\n\nexport class EShapeActionRuntimeConditional extends EShapeActionRuntime {\n\tprotected readonly condition: EShapeActionExpression<boolean>;\n\n\tconstructor( value: EShapeActionValue, reset: EShapeRuntimeReset ) {\n\t\tsuper( reset );\n\t\tthis.condition = this.toExpression( value.condition, conditionDefault, \"true\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlink extends EShapeActionRuntimeConditional {\n\tprotected interval: number;\n\n\tconstructor( value: EShapeActionValueBlink, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.interval = value.interval;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst interval = this.interval;\n\t\t\tconst dinterval = ( interval << 1 );\n\t\t\tconst elapsed = ( time % dinterval );\n\t\t\tif( elapsed < interval ) {\n\t\t\t\tthis.toOff( shape, runtime );\n\t\t\t\truntime.effect = time + ( interval - elapsed );\n\t\t\t} else {\n\t\t\t\tthis.toOn( shape, runtime );\n\t\t\t\truntime.effect = time + ( dinterval - elapsed );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t//\n\t}\n\n\tprotected toOff( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkBrighten extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( fill.color, 0.5 ),\n\t\t\tfill.alpha\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( stroke.color, 0.5 ),\n\t\t\tstroke.alpha\n\t\t);\n\n\t\tconst text = EShapeActionBases.toBaseText( shape, runtime );\n\t\tshape.text.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( text.color, 0.5 ),\n\t\t\ttext.alpha\n\t\t);\n\n\t\tconst outline = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\tshape.text.outline.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( outline.color, 0.5 ),\n\t\t\toutline.alpha\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkColorFill extends EShapeActionRuntimeBlink {\n\tprotected color: number;\n\tprotected alpha: number;\n\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t\tthis.color = value.color;\n\t\tthis.alpha = value.alpha;\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.fill.set( undefined, this.color, this.alpha );\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkColorStroke extends EShapeActionRuntimeBlink {\n\tprotected color: number;\n\tprotected alpha: number;\n\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t\tthis.color = value.color;\n\t\tthis.alpha = value.alpha;\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.stroke.set( undefined, this.color, this.alpha );\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkDarken extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( fill.color, 0.5 ),\n\t\t\tfill.alpha\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( stroke.color, 0.5 ),\n\t\t\tstroke.alpha\n\t\t);\n\n\t\tconst text = EShapeActionBases.toBaseText( shape, runtime );\n\t\tshape.text.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( text.color, 0.5 ),\n\t\t\ttext.alpha\n\t\t);\n\n\t\tconst outline = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\tshape.text.outline.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( outline.color, 0.5 ),\n\t\t\toutline.alpha\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkOpacity extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tfill.color,\n\t\t\tfill.alpha * 0.5\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tstroke.color,\n\t\t\tstroke.alpha * 0.5\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkVisibility extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.VISIBILITY );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.visible = true;\n\t\truntime.written |= this.reset;\n\t}\n\n\tprotected toOff( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.visible = false;\n\t\truntime.written |= this.reset;\n\t}\n}\n","import { DThemes } from \"../../theme/d-themes\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionValue, EThemeShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueBase implements EShapeActionValue {\n\treadonly type: EShapeActionValueType;\n\treadonly condition: string;\n\n\tconstructor( type: EShapeActionValueType, condition: string ) {\n\t\tthis.type = type;\n\t\tthis.condition = condition;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tthis.type === value.type &&\n\t\t\tthis.condition === value.condition\n\t\t);\n\t}\n\n\ttoLabel(): string {\n\t\treturn DThemes.getInstance().get<EThemeShapeActionValue>( \"EShapeActionValue\" ).toLabel( this );\n\t}\n\n\tabstract toRuntime( shape: EShape ): EShapeActionRuntime;\n\tabstract serialize( manager: EShapeResourceManagerSerialization ): number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueType {\n\tSHOW_HIDE,\n\tBLINK,\n\tTRANSFORM,\n\tOPEN,\n\tEMIT_EVENT,\n\tCHANGE_COLOR,\n\tCHANGE_TEXT,\n\tCHANGE_CURSOR,\n\tMISC\n}\n","import { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueSubtyped<SUBTYPE extends number> extends EShapeActionValueBase {\n\treadonly subtype: SUBTYPE;\n\n\tconstructor( type: EShapeActionValueType, condition: string, subtype: SUBTYPE ) {\n\t\tsuper( type, condition );\n\t\tthis.subtype = subtype;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueSubtyped) &&\n\t\t\tthis.subtype === value.subtype\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utilIsNumber } from \"../../util/util-is-number\";\n\nexport class EShapeActionValues {\n\tstatic toResource( index: number, parsed: number[], resources: string[] ): string {\n\t\tif( 0 <= index && index < parsed.length ) {\n\t\t\tconst id = parsed[ index ];\n\t\t\tif( utilIsNumber( id ) && 0 <= id && id < resources.length ) {\n\t\t\t\treturn resources[ id ];\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeColorType {\n\tFILL,\n\tSTROKE,\n\tFILL_AND_STROKE,\n\tTEXT,\n\tTEXT_OUTLINE,\n\tALL\n}\n\nexport enum EShapeActionValueChangeColorTarget {\n\tCOLOR_AND_ALPHA,\n\tCOLOR,\n\tALPHA,\n\tCODE,\n\tBRIGHTNESS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionRuntimeBlinkBrighten } from \"./e-shape-action-runtime-blink-brighten\";\nimport { EShapeActionRuntimeBlinkColorFill } from \"./e-shape-action-runtime-blink-color-fill\";\nimport { EShapeActionRuntimeBlinkColorStroke } from \"./e-shape-action-runtime-blink-color-stroke\";\nimport { EShapeActionRuntimeBlinkDarken } from \"./e-shape-action-runtime-blink-darken\";\nimport { EShapeActionRuntimeBlinkOpacity } from \"./e-shape-action-runtime-blink-opacity\";\nimport { EShapeActionRuntimeBlinkVisibility } from \"./e-shape-action-runtime-blink-visibility\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBlinkType } from \"./e-shape-action-value-blink-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueBlinkSerialized = [\n\tEShapeActionValueType.BLINK, number,\n\tEShapeActionValueBlinkType.COLOR_FILL | EShapeActionValueBlinkType.COLOR_STROKE,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueBlink extends EShapeActionValueSubtyped<EShapeActionValueBlinkType> {\n\treadonly interval: number;\n\treadonly color: number;\n\treadonly alpha: number;\n\n\tconstructor( subtype: EShapeActionValueBlinkType, condition: string, interval: number, color: number, alpha: number ) {\n\t\tsuper( EShapeActionValueType.BLINK, condition, subtype );\n\t\tthis.interval = interval;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueBlink) &&\n\t\t\tthis.interval === value.interval &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeBlink {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueBlinkType.BRIGHTEN:\n\t\t\treturn new EShapeActionRuntimeBlinkBrighten( this );\n\t\tcase EShapeActionValueBlinkType.COLOR_FILL:\n\t\t\treturn new EShapeActionRuntimeBlinkColorFill( this );\n\t\tcase EShapeActionValueBlinkType.COLOR_STROKE:\n\t\t\treturn new EShapeActionRuntimeBlinkColorStroke( this );\n\t\tcase EShapeActionValueBlinkType.DARKEN:\n\t\t\treturn new EShapeActionRuntimeBlinkDarken( this );\n\t\tcase EShapeActionValueBlinkType.OPACITY:\n\t\t\treturn new EShapeActionRuntimeBlinkOpacity( this );\n\t\tcase EShapeActionValueBlinkType.VISIBILITY:\n\t\t\treturn new EShapeActionRuntimeBlinkVisibility( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.interval},${this.color},${this.alpha}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueBlinkSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueBlink {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueBlink(\n\t\t\tserialized[ 2 ], condition, serialized[ 3 ],\n\t\t\tserialized[ 4 ], serialized[ 5 ]\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilAlpha } from \"../../util/util-alpha\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeText, EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-type\";\n\nconst blendDefault = (): number | null => null;\n\nexport class EShapeActionRuntimeChangeColor extends EShapeActionRuntimeConditional {\n\tprotected readonly color: number | undefined;\n\tprotected readonly alpha: number | undefined;\n\tprotected readonly blend: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColor, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\n\t\tswitch( value.target ) {\n\t\tcase EShapeActionValueChangeColorTarget.COLOR:\n\t\t\tthis.color = value.color;\n\t\t\tthis.alpha = undefined;\n\t\t\tbreak;\n\t\tcase EShapeActionValueChangeColorTarget.ALPHA:\n\t\t\tthis.color = undefined;\n\t\t\tthis.alpha = value.alpha;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.color = value.color;\n\t\t\tthis.alpha = value.alpha;\n\t\t\tbreak;\n\t\t}\n\n\t\tthis.blend = this.toExpression( value.blend, blendDefault, \"null\" );\n\t}\n\n\tprotected set(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\ttarget: EShapeStroke | EShapeFill | EShapeText | EShapeTextOutline,\n\t\tbase: EShapeStrokeLike | EShapeFillLike | EShapeTextLike | EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color;\n\t\tconst alpha = this.alpha;\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, base.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\ttarget.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbase.color,\n\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttarget.set( undefined, base.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected sets(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike\n\t): void {\n\t\tconst color = this.color;\n\t\tconst alpha = this.alpha;\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected setAll(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke, text: EShapeText, outline: EShapeTextOutline,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike, baseText: EShapeTextLike, baseOutline: EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color;\n\t\tconst alpha = this.alpha;\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t\ttext.set( undefined, color, alpha );\n\t\t\t\t\toutline.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tbaseText.alpha\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tbaseOutline.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t\ttext.set( undefined, color, baseText.alpha );\n\t\t\t\t\toutline.set( undefined, color, baseOutline.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\ttext.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\toutline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t\ttext.set( undefined, baseText.color, alpha );\n\t\t\t\toutline.set( undefined, baseOutline.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeTextType {\n\tTEXT,\n\tNUMBER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorAll extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.setAll(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tshape.text,\n\t\t\t\tshape.text.outline,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseText( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseTextOutline( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorFill extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.fill, EShapeActionBases.toBaseFill( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorFillAndStroke extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.sets(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorStroke extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.stroke, EShapeActionBases.toBaseStroke( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorText extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text, EShapeActionBases.toBaseText( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\n\nexport class EShapeActionRuntimeChangeColorTextOutline extends EShapeActionRuntimeChangeColor {\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT_OUTLINE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text.outline, EShapeActionBases.toBaseTextOutline( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionRuntimeChangeColorAll } from \"./e-shape-action-runtime-change-color-all\";\nimport { EShapeActionRuntimeChangeColorFill } from \"./e-shape-action-runtime-change-color-fill\";\nimport { EShapeActionRuntimeChangeColorFillAndStroke } from \"./e-shape-action-runtime-change-color-fill-and-stroke\";\nimport { EShapeActionRuntimeChangeColorStroke } from \"./e-shape-action-runtime-change-color-stroke\";\nimport { EShapeActionRuntimeChangeColorText } from \"./e-shape-action-runtime-change-color-text\";\nimport { EShapeActionRuntimeChangeColorTextOutline } from \"./e-shape-action-runtime-change-color-text-outline\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport {\n\tEShapeActionValueChangeColorTarget, EShapeActionValueChangeColorType\n} from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\ntype Target = EShapeActionValueChangeColorTarget.COLOR_AND_ALPHA | EShapeActionValueChangeColorTarget.COLOR |\n\tEShapeActionValueChangeColorTarget.ALPHA;\nexport type EShapeActionValueChangeColorSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tTarget, number, number, number\n];\n\nexport class EShapeActionValueChangeColor extends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly target: Target;\n\treadonly color: number;\n\treadonly alpha: number;\n\treadonly blend: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string,\n\t\ttarget: Target, color: number, alpha: number, blend: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.target = target;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.blend = blend;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColor) &&\n\t\t\tthis.target === value.target &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha &&\n\t\t\tthis.blend === value.blend\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColor {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeColorType.FILL:\n\t\t\treturn new EShapeActionRuntimeChangeColorFill( this );\n\t\tcase EShapeActionValueChangeColorType.STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorStroke( this );\n\t\tcase EShapeActionValueChangeColorType.FILL_AND_STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorFillAndStroke( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeColorText( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT_OUTLINE:\n\t\t\treturn new EShapeActionRuntimeChangeColorTextOutline( this );\n\t\tcase EShapeActionValueChangeColorType.ALL:\n\t\t\treturn new EShapeActionRuntimeChangeColorAll( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst blendId = manager.add(this.blend);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.target},${this.color},${this.alpha},${blendId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColor {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst blend = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColor(\n\t\t\tserialized[ 2 ], condition, serialized[ 3 ], serialized[ 4 ], serialized[ 5 ], blend\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeText, EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nconst brightnessDefault = (): number | null => null;\n\nexport class EShapeActionRuntimeChangeColorBrightness extends EShapeActionRuntimeConditional {\n\tprotected readonly brightness: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColorBrightness, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.brightness = this.toExpression( value.brightness, brightnessDefault, \"null\" );\n\t}\n\n\tprotected set(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\ttarget: EShapeStroke | EShapeFill | EShapeText | EShapeTextOutline,\n\t\tbase: EShapeStrokeLike | EShapeFillLike | EShapeTextLike | EShapeTextOutlineLike\n\t): void {\n\t\tconst brightness = this.brightness( shape, time );\n\t\tif( brightness != null ) {\n\t\t\ttarget.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( base.color, brightness ),\n\t\t\t\tbase.alpha\n\t\t\t);\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected sets(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike\n\t): void {\n\t\tconst brightness = this.brightness( shape, time );\n\t\tif( brightness != null ) {\n\t\t\tfill.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseFill.color, brightness ),\n\t\t\t\tbaseFill.alpha\n\t\t\t);\n\n\t\t\tstroke.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseStroke.color, brightness ),\n\t\t\t\tbaseStroke.alpha\n\t\t\t);\n\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected setAll(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke, text: EShapeText, outline: EShapeTextOutline,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike, baseText: EShapeTextLike, baseOutline: EShapeTextOutlineLike\n\t): void {\n\t\tconst brightness = this.brightness( shape, time );\n\t\tif( brightness != null ) {\n\t\t\tfill.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseFill.color, brightness ),\n\t\t\t\tbaseFill.alpha\n\t\t\t);\n\n\t\t\tstroke.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseStroke.color, brightness ),\n\t\t\t\tbaseStroke.alpha\n\t\t\t);\n\n\t\t\ttext.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseText.color, brightness ),\n\t\t\t\tbaseText.alpha\n\t\t\t);\n\n\t\t\toutline.set(\n\t\t\t\tundefined,\n\t\t\t\tthis.toColorAdjusted( baseOutline.color, brightness ),\n\t\t\t\tbaseOutline.alpha\n\t\t\t);\n\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected toColorAdjusted( color: number, brightness: number ): number {\n\t\tif( 0 <= brightness ) {\n\t\t\treturn UtilRgb.brighten( color, +brightness );\n\t\t} else {\n\t\t\treturn UtilRgb.darken( color, -brightness );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessAll extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.setAll(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tshape.text,\n\t\t\t\tshape.text.outline,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseText( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseTextOutline( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessFill extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.fill, EShapeActionBases.toBaseFill( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessFillAndStroke extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.sets(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessStroke extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.stroke, EShapeActionBases.toBaseStroke( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessText extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text, EShapeActionBases.toBaseText( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases} from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightnessTextOutline extends EShapeActionRuntimeChangeColorBrightness {\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT_OUTLINE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text.outline, EShapeActionBases.toBaseTextOutline( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionRuntimeChangeColorBrightnessAll } from \"./e-shape-action-runtime-change-color-brightness-all\";\nimport { EShapeActionRuntimeChangeColorBrightnessFill } from \"./e-shape-action-runtime-change-color-brightness-fill\";\nimport {\n\tEShapeActionRuntimeChangeColorBrightnessFillAndStroke\n} from \"./e-shape-action-runtime-change-color-brightness-fill-and-stroke\";\nimport {\n\tEShapeActionRuntimeChangeColorBrightnessStroke\n} from \"./e-shape-action-runtime-change-color-brightness-stroke\";\nimport { EShapeActionRuntimeChangeColorBrightnessText } from \"./e-shape-action-runtime-change-color-brightness-text\";\nimport {\n\tEShapeActionRuntimeChangeColorBrightnessTextOutline\n} from \"./e-shape-action-runtime-change-color-brightness-text-outline\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport {\n\tEShapeActionValueChangeColorTarget, EShapeActionValueChangeColorType\n} from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeColorBrightnessSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tEShapeActionValueChangeColorTarget.BRIGHTNESS, number\n];\n\nexport class EShapeActionValueChangeColorBrightness\n\textends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly brightness: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string, brightness: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.brightness = brightness;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColorBrightness) &&\n\t\t\tthis.brightness === value.brightness\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColorBrightness {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeColorType.FILL:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessFill( this );\n\t\tcase EShapeActionValueChangeColorType.STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessStroke( this );\n\t\tcase EShapeActionValueChangeColorType.FILL_AND_STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessFillAndStroke( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessText( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT_OUTLINE:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessTextOutline( this );\n\t\tcase EShapeActionValueChangeColorType.ALL:\n\t\t\treturn new EShapeActionRuntimeChangeColorBrightnessAll( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst target = EShapeActionValueChangeColorTarget.BRIGHTNESS;\n\t\tconst brightnessId = manager.add(this.brightness);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${target},${brightnessId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorBrightnessSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColorBrightness {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst brightness = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColorBrightness(\n\t\t\tserialized[ 2 ], condition, brightness\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilAlpha } from \"../../util/util-alpha\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeText, EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nconst colorDefault = (): number | null => null;\nconst alphaDefault = (): number | null => null;\nconst blendDefault = (): number | null => null;\n\nexport class EShapeActionRuntimeChangeColorCode extends EShapeActionRuntimeConditional {\n\tprotected readonly color: EShapeActionExpression<number | null>;\n\tprotected readonly alpha: EShapeActionExpression<number | null>;\n\tprotected readonly blend: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColorCode, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.color = this.toExpression( value.color, colorDefault, \"null\" );\n\t\tthis.alpha = this.toExpression( value.alpha, alphaDefault, \"null\" );\n\t\tthis.blend = this.toExpression( value.blend, blendDefault, \"null\" );\n\t}\n\n\tprotected set(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\ttarget: EShapeStroke | EShapeFill | EShapeText | EShapeTextOutline,\n\t\tbase: EShapeStrokeLike | EShapeFillLike | EShapeTextLike | EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color( shape, time );\n\t\tconst alpha = this.alpha( shape, time );\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\ttarget.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\ttarget.set( undefined, color, base.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\ttarget.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbase.color,\n\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\ttarget.set( undefined, base.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected sets(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike\n\t): void {\n\t\tconst color = this.color( shape, time );\n\t\tconst alpha = this.alpha( shape, time );\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n\n\tprotected setAll(\n\t\tshape: EShape, runtime: EShapeRuntime, time: number,\n\t\tfill: EShapeFill, stroke: EShapeStroke, text: EShapeText, outline: EShapeTextOutline,\n\t\tbaseFill: EShapeFillLike, baseStroke: EShapeStrokeLike, baseText: EShapeTextLike, baseOutline: EShapeTextOutlineLike\n\t): void {\n\t\tconst color = this.color( shape, time );\n\t\tconst alpha = this.alpha( shape, time );\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, alpha );\n\t\t\t\t\tstroke.set( undefined, color, alpha );\n\t\t\t\t\ttext.set( undefined, color, alpha );\n\t\t\t\t\toutline.set( undefined, color, alpha );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst blend = this.blend( shape, time );\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tfill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseFill.color, color, blend ),\n\t\t\t\t\t\tbaseFill.alpha\n\t\t\t\t\t);\n\t\t\t\t\tstroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseStroke.color, color, blend ),\n\t\t\t\t\t\tbaseStroke.alpha\n\t\t\t\t\t);\n\t\t\t\t\ttext.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseText.color, color, blend ),\n\t\t\t\t\t\tbaseText.alpha\n\t\t\t\t\t);\n\t\t\t\t\toutline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tUtilRgb.blend( baseOutline.color, color, blend ),\n\t\t\t\t\t\tbaseOutline.alpha\n\t\t\t\t\t);\n\t\t\t\t} else {\n\t\t\t\t\tfill.set( undefined, color, baseFill.alpha );\n\t\t\t\t\tstroke.set( undefined, color, baseStroke.alpha );\n\t\t\t\t\ttext.set( undefined, color, baseText.alpha );\n\t\t\t\t\toutline.set( undefined, color, baseOutline.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t} else if( alpha != null ) {\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tif( blend != null ) {\n\t\t\t\tfill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseFill.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\tstroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseStroke.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\ttext.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseFill.color,\n\t\t\t\t\tUtilAlpha.blend( baseText.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t\toutline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tbaseStroke.color,\n\t\t\t\t\tUtilAlpha.blend( baseOutline.alpha, alpha, blend )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfill.set( undefined, baseFill.color, alpha );\n\t\t\t\tstroke.set( undefined, baseStroke.color, alpha );\n\t\t\t\ttext.set( undefined, baseText.color, alpha );\n\t\t\t\toutline.set( undefined, baseOutline.color, alpha );\n\t\t\t}\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeAll extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.setAll(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tshape.text,\n\t\t\t\tshape.text.outline,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseText( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseTextOutline( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeFill extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.fill, EShapeActionBases.toBaseFill( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeFillAndStroke extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.sets(\n\t\t\t\tshape, runtime, time,\n\t\t\t\tshape.fill,\n\t\t\t\tshape.stroke,\n\t\t\t\tEShapeActionBases.toBaseFill( shape, runtime ),\n\t\t\t\tEShapeActionBases.toBaseStroke( shape, runtime )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeStroke extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.stroke, EShapeActionBases.toBaseStroke( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeText extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text, EShapeActionBases.toBaseText( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCodeTextOutline extends EShapeActionRuntimeChangeColorCode {\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_TEXT_OUTLINE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tthis.set( shape, runtime, time, shape.text.outline, EShapeActionBases.toBaseTextOutline( shape, runtime ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionRuntimeChangeColorCodeAll } from \"./e-shape-action-runtime-change-color-code-all\";\nimport { EShapeActionRuntimeChangeColorCodeFill } from \"./e-shape-action-runtime-change-color-code-fill\";\nimport {\n\tEShapeActionRuntimeChangeColorCodeFillAndStroke\n} from \"./e-shape-action-runtime-change-color-code-fill-and-stroke\";\nimport { EShapeActionRuntimeChangeColorCodeStroke } from \"./e-shape-action-runtime-change-color-code-stroke\";\nimport { EShapeActionRuntimeChangeColorCodeText } from \"./e-shape-action-runtime-change-color-code-text\";\nimport { EShapeActionRuntimeChangeColorCodeTextOutline } from \"./e-shape-action-runtime-change-color-code-text-outline\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport {\n\tEShapeActionValueChangeColorTarget, EShapeActionValueChangeColorType\n} from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeColorCodeSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tEShapeActionValueChangeColorTarget.CODE, number, number, number\n];\n\nexport class EShapeActionValueChangeColorCode extends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly color: string;\n\treadonly alpha: string;\n\treadonly blend: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string,\n\t\tcolor: string, alpha: string, blend: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.blend = blend;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColorCode) &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha &&\n\t\t\tthis.blend === value.blend\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColorCode {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeColorType.FILL:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeFill( this );\n\t\tcase EShapeActionValueChangeColorType.STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeStroke( this );\n\t\tcase EShapeActionValueChangeColorType.FILL_AND_STROKE:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeFillAndStroke( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeText( this );\n\t\tcase EShapeActionValueChangeColorType.TEXT_OUTLINE:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeTextOutline( this );\n\t\tcase EShapeActionValueChangeColorType.ALL:\n\t\t\treturn new EShapeActionRuntimeChangeColorCodeAll( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst target = EShapeActionValueChangeColorTarget.CODE;\n\t\tconst colorId = manager.add(this.color);\n\t\tconst alphaId = manager.add(this.alpha);\n\t\tconst blendId = manager.add(this.blend);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${target},${colorId},${alphaId},${blendId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorCodeSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColorCode {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst color = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\tconst alpha = EShapeActionValues.toResource( 5, serialized, manager.resources );\n\t\tconst blend = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColorCode(\n\t\t\tserialized[ 2 ], condition, color, alpha, blend\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeCursor } from \"./e-shape-action-value-change-cursor\";\n\nconst nameDefault = (): string | null => null;\n\nexport class EShapeActionRuntimeChangeCursor extends EShapeActionRuntimeConditional {\n\tprotected name: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueChangeCursor ) {\n\t\tsuper( value, EShapeRuntimeReset.CURSOR );\n\t\tthis.name = this.toExpression( value.name, nameDefault, \"null\" );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst name = this.name( shape, time );\n\t\t\tif( name != null ) {\n\t\t\t\tshape.cursor = name;\n\t\t\t\truntime.written |= this.reset;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeCursor } from \"./e-shape-action-runtime-change-cursor\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeCursorSerialized = [\n\tEShapeActionValueType.CHANGE_CURSOR, number, number\n];\n\nexport class EShapeActionValueChangeCursor extends EShapeActionValueBase {\n\treadonly name: string;\n\n\tconstructor( condition: string, name: string ) {\n\t\tsuper( EShapeActionValueType.CHANGE_CURSOR, condition );\n\t\tthis.name = name;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeCursor) &&\n\t\t\tthis.name === value.name\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeCursor {\n\t\treturn new EShapeActionRuntimeChangeCursor( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst nameId = manager.add(this.name);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${nameId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeCursorSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeCursor {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst name = EShapeActionValues.toResource( 2, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeCursor( condition, name );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NumberFormatter } from \"../../util/number-formatter\";\nimport { NumberFormatters } from \"../../util/number-formatters\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeText } from \"./e-shape-action-value-change-text\";\n\nconst numberDefault = (): number => 0;\n\nexport class EShapeActionRuntimeChangeTextNumber extends EShapeActionRuntimeConditional {\n\tprotected number: EShapeActionExpression<number>;\n\tprotected formatter: NumberFormatter | null;\n\n\tconstructor( value: EShapeActionValueChangeText, format: string ) {\n\t\tsuper( value, EShapeRuntimeReset.TEXT );\n\n\t\tthis.number = this.toExpression( value.value, numberDefault, `0` );\n\n\t\tformat = format.trim();\n\t\tthis.formatter = ( 0 < format.length ? NumberFormatters.create( format ) : null );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst value = this.number( shape, time );\n\t\t\tshape.text.value = ( this.formatter != null ? this.formatter.format( value, 0 ) : String(value) );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeText } from \"./e-shape-action-value-change-text\";\n\nconst textDefault = () => \"\";\n\nexport class EShapeActionRuntimeChangeTextText extends EShapeActionRuntimeConditional {\n\tprotected text: EShapeActionExpression<string>;\n\n\tconstructor( value: EShapeActionValueChangeText ) {\n\t\tsuper( value, EShapeRuntimeReset.TEXT );\n\t\tthis.text = this.toExpression( value.value, textDefault, `\"\"` );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tshape.text.value = String(this.text( shape, time ));\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeTextNumber } from \"./e-shape-action-runtime-change-text-number\";\nimport { EShapeActionRuntimeChangeTextText } from \"./e-shape-action-runtime-change-text-text\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeTextType } from \"./e-shape-action-value-change-text-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeTextSerialized = [\n\tEShapeActionValueType.CHANGE_TEXT, number, EShapeActionValueChangeTextType, number\n];\n\nexport class EShapeActionValueChangeText extends EShapeActionValueSubtyped<EShapeActionValueChangeTextType> {\n\treadonly value: string;\n\n\tconstructor( subtype: EShapeActionValueChangeTextType, condition: string, value: string ) {\n\t\tsuper( EShapeActionValueType.CHANGE_TEXT, condition, subtype );\n\t\tthis.value = value;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeText) &&\n\t\t\tthis.value === value.value\n\t\t);\n\t}\n\n\ttoRuntime( shape: EShape ): EShapeActionRuntimeChangeTextText | EShapeActionRuntimeChangeTextNumber {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeTextType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeTextText( this );\n\t\tcase EShapeActionValueChangeTextType.NUMBER:\n\t\t\treturn new EShapeActionRuntimeChangeTextNumber( this, shape.text.value );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst valueId = manager.add(this.value);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${valueId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeTextSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeText {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst value = EShapeActionValues.toResource( 3, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeText( serialized[ 2 ], condition, value );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueMiscType {\n\tINPUT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueEmitEvent } from \"./e-shape-action-value-emit-event\";\n\nconst nameDefault = (): string | null => null;\n\nexport class EShapeActionRuntimeEmitEvent extends EShapeActionRuntimeConditional {\n\tprotected name: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueEmitEvent ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t\tthis.name = this.toExpression( value.name, nameDefault, \"null\" );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst name = this.name( shape, time );\n\t\t\tif( name != null ) {\n\t\t\t\tthis.emit( name, shape );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeEmitEvent } from \"./e-shape-action-runtime-emit-event\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueEmitEventSerialized = [\n\tEShapeActionValueType.EMIT_EVENT, number, number\n];\n\nexport class EShapeActionValueEmitEvent extends EShapeActionValueBase {\n\treadonly name: string;\n\n\tconstructor( condition: string, name: string ) {\n\t\tsuper( EShapeActionValueType.EMIT_EVENT, condition );\n\t\tthis.name = name;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueEmitEvent) &&\n\t\t\tthis.name === value.name\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeEmitEvent {\n\t\treturn new EShapeActionRuntimeEmitEvent( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst nameId = manager.add(this.name);\n\t\treturn manager.add( `[${this.type},${conditionId},${nameId}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueEmitEventSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueEmitEvent {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst name = EShapeActionValues.toResource( 2, serialized, manager.resources );\n\t\treturn new EShapeActionValueEmitEvent( condition, name );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point, Rectangle, Renderer } from \"pixi.js\";\nimport { DApplications } from \"../../d-applications\";\nimport { DControllers } from \"../../d-controllers\";\nimport { DynamicSDFFontAtlas } from \"../../util/dynamic-sdf-font-atlas\";\nimport { UtilKeyboardEvent } from \"../../util/util-keyboard-event\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeTextWeight } from \"../e-shape-text\";\n\ntype OnChange = ( shape: EShape, value: string ) => void;\ntype OnInput = ( shape: EShape, value: string ) => void;\n\nexport class EShapeActionRuntimeMiscInputData {\n\tprotected input: HTMLInputElement | null;\n\tprotected shape: EShape | null;\n\tprotected value: string;\n\tprotected onChange?: OnChange;\n\tprotected onInput?: OnInput;\n\n\tprotected point: Point;\n\tprotected rect: Rectangle;\n\n\tprotected _onInputKeyDownBound!: ( e: KeyboardEvent ) => void;\n\tprotected _onInputBlurBound!: ( e: FocusEvent ) => void;\n\tprotected _updateInputBound!: () => void;\n\tprotected _onInputChangeBound!: ( e: Event ) => void;\n\tprotected _onInputInputBound!: ( e: Event ) => void;\n\tprotected _updateInputBoundRenderer!: Renderer | null;\n\n\tconstructor() {\n\t\tthis.input = null;\n\t\tthis.shape = null;\n\t\tthis.value = \"\";\n\n\t\tthis.point = new Point();\n\t\tthis.rect = new Rectangle();\n\n\t\tthis._onInputKeyDownBound = ( e: KeyboardEvent ) => {\n\t\t\tthis.onInputKeyDown( e );\n\t\t};\n\n\t\tthis._onInputBlurBound = ( e: FocusEvent ) => {\n\t\t\tthis.onInputBlur( e );\n\t\t};\n\n\t\tthis._updateInputBound = () => {\n\t\t\tthis.updateInput();\n\t\t};\n\n\t\tthis._onInputChangeBound = () => {\n\t\t\tthis.onInputChange();\n\t\t};\n\n\t\tthis._onInputInputBound = ( e ) => {\n\t\t\tthis.onInputInput( e );\n\t\t};\n\n\t\tthis._updateInputBoundRenderer = null;\n\t}\n\n\tprotected getInput(): HTMLInputElement | null {\n\t\tif( this.input == null ) {\n\t\t\tDApplications.getInstance().getRootElement().appendChild(\n\t\t\t\tthis.input = this.createInput()\n\t\t\t);\n\t\t}\n\t\treturn this.input;\n\t}\n\n\tprotected createInput(): HTMLInputElement {\n\t\tconst result = document.createElement( \"input\" );\n\t\tresult.setAttribute( \"spellcheck\", \"false\" );\n\t\treturn result;\n\t}\n\n\tprotected getInputType(): string {\n\t\treturn \"text\";\n\t}\n\n\tprotected initInput( shape: EShape, input: HTMLInputElement, value: string ): void {\n\t\tinput.type = this.getInputType();\n\t\tinput.value = value;\n\t\tinput.addEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\tinput.addEventListener( \"blur\", this._onInputBlurBound );\n\t\tinput.addEventListener( \"change\", this._onInputChangeBound );\n\t\tinput.addEventListener( \"input\", this._onInputInputBound );\n\n\t\t// Style\n\t\tinput.setAttribute( \"style\", this.getInputStyle( shape ) );\n\n\t\t// ReadOnly\n\t\tif( shape.readonly ) {\n\t\t\tinput.setAttribute( \"readonly\", \"readonly\" );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"readonly\" );\n\t\t}\n\n\t\t// Disabled\n\t\tif( shape.disabled ) {\n\t\t\tinput.setAttribute( \"disabled\", \"disabled\" );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"disabled\" );\n\t\t}\n\t}\n\n\tprotected getInputStyleBackground(): string {\n\t\treturn `background-color: transparent;`;\n\t}\n\n\tprotected getInputStyleBorder(): string {\n\t\treturn `border: none; box-sizing: border-box;`;\n\t}\n\n\tprotected getInputStylePadding( shape: EShape, scale: number ): string {\n\t\tconst padding = shape.text.padding;\n\t\tconst paddingVertical = 0;\n\t\tconst paddingHorizontal = padding.horizontal * scale;\n\t\treturn `padding: ${paddingVertical}px ${paddingHorizontal}px ${paddingVertical}px ${paddingHorizontal}px;`;\n\t}\n\n\tprotected getInputStyleOutline(): string {\n\t\treturn `outline: none;`;\n\t}\n\n\tprotected getInputStylePosition( rect: Rectangle, matrix: Matrix ): string {\n\t\treturn `position: absolute;` +\n\t\t\t`left: ${rect.x}px;` +\n\t\t\t`top: ${rect.y}px;` +\n\t\t\t`width: ${rect.width}px;` +\n\t\t\t`height: ${rect.height}px;` +\n\t\t\t`line-height: ${rect.height}px;` +\n\t\t\t`transform: matrix(${matrix.a},${matrix.b},${matrix.c},${matrix.d},${matrix.tx},${matrix.ty});`;\n\t}\n\n\tprotected getInputStyleText( shape: EShape, rect: Rectangle, scale: number ): string {\n\t\tconst text = shape.text;\n\t\treturn `font-family: ${DynamicSDFFontAtlas.toFontFamily( text.family )};` +\n\t\t\t`font-size: ${text.size * scale}px;` +\n\t\t\t`font-weight: ${text.weight === EShapeTextWeight.NORMAL ? \"normal\" : \"bold\" };` +\n\t\t\t`color: #${text.color.toString( 16 )};`;\n\t}\n\n\tprotected getInputStyleMargin( shape: EShape, rect: Rectangle, scale: number ): string {\n\t\treturn `margin: 0;`;\n\t}\n\n\tprotected getInputStyle( shape: EShape ): string {\n\t\tconst pivot = shape.transform.pivot;\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst rect = this.rect;\n\t\trect.x = -0.5 * sizeX + pivot.x;\n\t\trect.y = -0.5 * sizeY + pivot.y;\n\t\trect.width = sizeX;\n\t\trect.height = sizeY;\n\n\t\tshape.updateTransform();\n\t\tconst scale = 1.0;\n\t\tconst worldTransform = shape.transform.worldTransform;\n\n\t\treturn this.getInputStylePosition( rect, worldTransform ) +\n\t\t\tthis.getInputStyleMargin( shape, rect, scale ) +\n\t\t\tthis.getInputStyleText( shape, rect, scale ) +\n\t\t\tthis.getInputStyleBackground() +\n\t\t\tthis.getInputStyleBorder() +\n\t\t\tthis.getInputStylePadding( shape, scale ) +\n\t\t\tthis.getInputStyleOutline();\n\t}\n\n\tprotected onInputKeyDown( e: KeyboardEvent ): void {\n\t\tif( UtilKeyboardEvent.isFocusKey( e ) ) {\n\t\t\tconst shape = this.shape;\n\t\t\tif( shape != null ) {\n\t\t\t\tthis.onInputChange();\n\t\t\t\tthis.hide();\n\n\t\t\t\tconst focusController = DControllers.getFocusController();\n\t\t\t\tconst direction = UtilKeyboardEvent.getFocusDirection( e );\n\t\t\t\tconst focusable = focusController.findFocusable( shape, false, false, direction );\n\t\t\t\tif( focusable != null ) {\n\t\t\t\t\tDApplications.getInstance().view.focus();\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tfocusController.setFocused( focusable, true, true );\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( UtilKeyboardEvent.isOkKey( e ) ) {\n\t\t\tthis.onInputChange();\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\tprotected onInputBlur( e: FocusEvent ): void {\n\t\tthis.onInputChange();\n\t\tthis.hide();\n\t}\n\n\tprotected onInputInput( e: Event ): void {\n\t\tif( e.target instanceof HTMLInputElement ) {\n\t\t\tconst shape = this.shape;\n\t\t\tconst onInput = this.onInput;\n\t\t\tif( shape != null && onInput != null ) {\n\t\t\t\tonInput( shape, e.target.value );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateInput(): void {\n\t\tconst shape = this.shape;\n\t\tif( shape != null ) {\n\t\t\tif( shape.visible ) {\n\t\t\t\tconst input = this.input;\n\t\t\t\tif( input != null ) {\n\t\t\t\t\tinput.setAttribute( \"style\", this.getInputStyle( shape ) );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t}\n\t}\n\n\tisShown( shape: EShape ): boolean {\n\t\treturn ( this.shape === shape );\n\t}\n\n\tshow(\n\t\tnewShape: EShape, value: string,\n\t\tonChange?: OnChange, onInput?: OnInput\n\t): void {\n\t\tconst oldShape = this.shape;\n\t\tif( oldShape != null && oldShape !== newShape ) {\n\t\t\tthis.hide();\n\t\t}\n\t\tif( this.shape == null ) {\n\t\t\tthis.shape = newShape;\n\t\t\tthis.value = value;\n\t\t\tthis.onChange = onChange;\n\t\t\tthis.onInput = onInput;\n\n\t\t\tconst text = newShape.text;\n\t\t\tif( text != null ) {\n\t\t\t\ttext.enable = false;\n\t\t\t}\n\n\t\t\tconst app = DApplications.getInstance();\n\t\t\tconst input = this.getInput();\n\t\t\tif( input != null ) {\n\t\t\t\tthis.initInput( newShape, input, value );\n\n\t\t\t\tconst updateInputBound = this._updateInputBound;\n\t\t\t\tconst renderer = this._updateInputBoundRenderer;\n\t\t\t\tif( renderer != null ) {\n\t\t\t\t\trenderer.off( \"postrender\", updateInputBound );\n\t\t\t\t}\n\t\t\t\tthis._updateInputBoundRenderer = app.renderer;\n\t\t\t\tapp.renderer.on( \"postrender\", updateInputBound );\n\n\t\t\t\tinput.style.display = \"\";\n\t\t\t\tinput.focus();\n\t\t\t\tinput.select();\n\t\t\t}\n\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\thide(): void {\n\t\tconst shape = this.shape;\n\t\tif( shape != null ) {\n\t\t\tthis.shape = null;\n\t\t\tthis.value = \"\";\n\n\t\t\tconst text = shape.text;\n\t\t\tif( text != null ) {\n\t\t\t\ttext.enable = true;\n\t\t\t}\n\n\t\t\tconst input = this.input;\n\t\t\tif( input != null ) {\n\t\t\t\tinput.removeEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\t\t\tinput.removeEventListener( \"blur\", this._onInputBlurBound );\n\t\t\t\tinput.removeEventListener( \"change\", this._onInputChangeBound );\n\t\t\t\tinput.removeEventListener( \"input\", this._onInputInputBound );\n\t\t\t\tinput.style.display = \"none\";\n\t\t\t}\n\n\t\t\tconst renderer = this._updateInputBoundRenderer;\n\t\t\tif( renderer != null ) {\n\t\t\t\tthis._updateInputBoundRenderer = null;\n\t\t\t\trenderer.off( \"postrender\", this._updateInputBound );\n\t\t\t}\n\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tonInputChange(): void {\n\t\tconst shape = this.shape;\n\t\tconst input = this.input;\n\t\tconst onChange = this.onChange;\n\t\tif( shape != null && input != null && onChange != null ) {\n\t\t\tconst newValue = input.value;\n\t\t\tif( this.value !== newValue ) {\n\t\t\t\tonChange( shape, newValue );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeMiscInputData } from \"./e-shape-action-runtime-misc-input-data\";\n\nexport class EShapeActionRuntimeMiscInput extends EShapeActionRuntime {\n\tstatic data: EShapeActionRuntimeMiscInputData | null = null;\n\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( ! shape.disabled ) {\n\t\t\tconst data = EShapeActionRuntimeMiscInput.getData();\n\t\t\tif( shape.focused ) {\n\t\t\t\tif( ! data.isShown( shape ) ) {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tdata.show( shape, shape.text.value, ( _: EShape, value: string ): void => {\n\t\t\t\t\t\t\tshape.text.value = value;\n\t\t\t\t\t\t\tthis.emit( \"change\", shape, value );\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( data.isShown( shape ) ) {\n\t\t\t\t\tdata.onInputChange();\n\t\t\t\t\tdata.hide();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getData(): EShapeActionRuntimeMiscInputData {\n\t\tif( EShapeActionRuntimeMiscInput.data == null ) {\n\t\t\tEShapeActionRuntimeMiscInput.data = new EShapeActionRuntimeMiscInputData();\n\t\t}\n\t\treturn EShapeActionRuntimeMiscInput.data;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeMiscInput } from \"./e-shape-action-runtime-misc-input\";\nimport { EShapeActionValueMiscType } from \"./e-shape-action-value-misc-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueMiscSerialized = [\n\tEShapeActionValueType.MISC, number, EShapeActionValueMiscType\n];\n\nexport class EShapeActionValueMisc extends EShapeActionValueSubtyped<EShapeActionValueMiscType> {\n\tconstructor( subtype: EShapeActionValueMiscType, condition: string ) {\n\t\tsuper( EShapeActionValueType.MISC, condition, subtype );\n\t}\n\n\ttoRuntime( shape: EShape ): EShapeActionRuntime {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueMiscType.INPUT:\n\t\t\treturn new EShapeActionRuntimeMiscInput();\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\treturn manager.add( `[${this.type},${conditionId},${this.subtype}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueMiscSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueMisc {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueMisc( serialized[ 2 ], condition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueOpenType {\n\tFLOW,\n\tPAGE,\n\tPAGE_INPLACE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nconst targetDefault = (): string | null => null;\n\nexport class EShapeActionRuntimeOpen extends EShapeActionRuntimeConditional {\n\tprotected readonly target: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueOpen, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.target = this.toExpression( value.target, targetDefault, \"null\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../../d-applications\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenFlow extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\tconst application = DApplications.getInstance() as any;\n\t\t\t\tif( \"opener\" in application ) {\n\t\t\t\t\tapplication.opener( target );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenPage extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\twindow.open( target );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenPageInplace extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\twindow.location.href = target;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionRuntimeOpenFlow } from \"./e-shape-action-runtime-open-flow\";\nimport { EShapeActionRuntimeOpenPage } from \"./e-shape-action-runtime-open-page\";\nimport { EShapeActionRuntimeOpenPageInplace } from \"./e-shape-action-runtime-open-page-inplace\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpenType } from \"./e-shape-action-value-open-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueOpenSerialized = [\n\tEShapeActionValueType.OPEN, number, EShapeActionValueOpenType, number\n];\n\nexport class EShapeActionValueOpen extends EShapeActionValueSubtyped<EShapeActionValueOpenType> {\n\treadonly target: string;\n\n\tconstructor( subtype: EShapeActionValueOpenType, condition: string, target: string ) {\n\t\tsuper( EShapeActionValueType.OPEN, condition, subtype );\n\t\tthis.target = target;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueOpen) &&\n\t\t\tthis.target === value.target\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeOpen {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueOpenType.FLOW:\n\t\t\treturn new EShapeActionRuntimeOpenFlow( this );\n\t\tcase EShapeActionValueOpenType.PAGE:\n\t\t\treturn new EShapeActionRuntimeOpenPage( this );\n\t\tcase EShapeActionValueOpenType.PAGE_INPLACE:\n\t\t\treturn new EShapeActionRuntimeOpenPageInplace( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst targetId = manager.add(this.target);\n\t\treturn manager.add( `[${this.type},${conditionId},${this.subtype},${targetId}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueOpenSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueOpen {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst target = EShapeActionValues.toResource( 3, serialized, manager.resources );\n\t\treturn new EShapeActionValueOpen( serialized[ 2 ], condition, target );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueShowHideType {\n\tSHOW,\n\tHIDE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueShowHide } from \"./e-shape-action-value-show-hide\";\nimport { EShapeActionValueShowHideType } from \"./e-shape-action-value-show-hide-type\";\n\nexport class EShapeActionRuntimeShowHide extends EShapeActionRuntimeConditional {\n\tvisibility: boolean;\n\n\tconstructor( value: EShapeActionValueShowHide ) {\n\t\tsuper( value, EShapeRuntimeReset.VISIBILITY );\n\t\tthis.visibility = ( value.subtype === EShapeActionValueShowHideType.SHOW );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tshape.visible = this.visibility;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformMoveType {\n\tRELATIVE_X,\n\tRELATIVE_Y,\n\tABSOLUTE_X,\n\tABSOLUTE_Y,\n\tFORWARD_OR_BACKWARD,\n\tLEFT_OR_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformType {\n\tRESIZE,\n\tMOVE,\n\tROTATE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeShowHide } from \"./e-shape-action-runtime-show-hide\";\nimport { EShapeActionValueShowHideType } from \"./e-shape-action-value-show-hide-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueShowHideSerialized = [\n\tEShapeActionValueType.SHOW_HIDE, number, EShapeActionValueShowHideType\n];\n\nexport class EShapeActionValueShowHide extends EShapeActionValueSubtyped<EShapeActionValueShowHideType> {\n\tconstructor( subtype: EShapeActionValueShowHideType, condition: string ) {\n\t\tsuper( EShapeActionValueType.SHOW_HIDE, condition, subtype );\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeShowHide {\n\t\treturn new EShapeActionRuntimeShowHide( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\treturn manager.add( `[${this.type},${conditionId},${this.subtype}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueShowHideSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueShowHide {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueShowHide( serialized[ 2 ], condition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nconst amountDefault = (): number => 0;\n\nexport class EShapeActionRuntimeTransformMove extends EShapeActionRuntimeConditional {\n\tprotected readonly amount: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformMove, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.amount = this.toExpression( value.amount, amountDefault, \"0\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveAbsoluteX extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_X );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tshape.transform.position.x = amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveAbsoluteY extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_Y );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tshape.transform.position.y = amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveForwardOrBackward extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst position = transform.position;\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tshape.updateTransform();\n\t\t\tconst localTransform = shape.transform.localTransform;\n\t\t\tposition.set( oldPositionX - localTransform.c * amount, oldPositionY - localTransform.d * amount );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveLeftOrRight extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst position = transform.position;\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tshape.updateTransform();\n\t\t\tconst localTransform = shape.transform.localTransform;\n\t\t\tposition.set( oldPositionX + localTransform.a * amount, oldPositionY + localTransform.b * amount );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveRelativeX extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_X );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst position = shape.transform.position;\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tposition.x = oldPositionX + amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveRelativeY extends EShapeActionRuntimeTransformMove {\n\tconstructor( action: EShapeActionValueTransformMove ) {\n\t\tsuper( action, EShapeRuntimeReset.POSITION_Y );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst position = shape.transform.position;\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tposition.y = oldPositionY + amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","import { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueOpetyped<\n\tSUBTYPE extends number,\n\tOPETYPE extends number\n> extends EShapeActionValueSubtyped<SUBTYPE> {\n\treadonly opetype: OPETYPE;\n\n\tconstructor( type: EShapeActionValueType, condition: string, subtype: SUBTYPE, opetype: OPETYPE ) {\n\t\tsuper( type, condition, subtype );\n\t\tthis.opetype = opetype;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueOpetyped) &&\n\t\t\tthis.opetype === value.opetype\n\t\t);\n\t}\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionRuntimeTransformMoveAbsoluteX } from \"./e-shape-action-runtime-transform-move-absolute-x\";\nimport { EShapeActionRuntimeTransformMoveAbsoluteY } from \"./e-shape-action-runtime-transform-move-absolute-y\";\nimport {\n\tEShapeActionRuntimeTransformMoveForwardOrBackward\n} from \"./e-shape-action-runtime-transform-move-forward-or-backward\";\nimport { EShapeActionRuntimeTransformMoveLeftOrRight } from \"./e-shape-action-runtime-transform-move-left-or-right\";\nimport { EShapeActionRuntimeTransformMoveRelativeX } from \"./e-shape-action-runtime-transform-move-relative-x\";\nimport { EShapeActionRuntimeTransformMoveRelativeY } from \"./e-shape-action-runtime-transform-move-relative-y\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformMoveType } from \"./e-shape-action-value-transform-move-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformMoveSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.MOVE,\n\tEShapeActionValueTransformMoveType, number\n];\n\nexport class EShapeActionValueTransformMove\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformMoveType> {\n\treadonly amount: string;\n\n\tconstructor( opetype: EShapeActionValueTransformMoveType, condition: string, amount: string ) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.MOVE, opetype );\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformMove) &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformMove {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_X:\n\t\t\treturn new EShapeActionRuntimeTransformMoveAbsoluteX( this );\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_Y:\n\t\t\treturn new EShapeActionRuntimeTransformMoveAbsoluteY( this );\n\t\tcase EShapeActionValueTransformMoveType.FORWARD_OR_BACKWARD:\n\t\t\treturn new EShapeActionRuntimeTransformMoveForwardOrBackward( this );\n\t\tcase EShapeActionValueTransformMoveType.LEFT_OR_RIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformMoveLeftOrRight( this );\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_X:\n\t\t\treturn new EShapeActionRuntimeTransformMoveRelativeX( this );\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_Y:\n\t\t\treturn new EShapeActionRuntimeTransformMoveRelativeY( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add(this.condition);\n\t\tconst amountId = manager.add(this.amount);\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformMoveSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformMove {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformMove( serialized[ 3 ], condition, amount );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformResizeType {\n\tRELATIVE_SIZE,\n\tRELATIVE_HEIGHT,\n\tRELATIVE_WIDTH,\n\tABSOLUTE_SIZE,\n\tABSOLUTE_HEIGHT,\n\tABSOLUTE_WIDTH\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\n\nexport class EShapeSizes {\n\tstatic toRounded( value: number ): number {\n\t\treturn Math.round( value * 100 ) / 100;\n\t}\n\n\tstatic toNormalized( size: number ): number {\n\t\tconst THRESHOLD = 0.001;\n\t\tif( Math.abs( size ) < THRESHOLD ) {\n\t\t\treturn ( size < 0 ? -THRESHOLD : +THRESHOLD );\n\t\t}\n\t\treturn EShapeSizes.toRounded( size );\n\t}\n\n\tstatic resize( shape: EShape, from: Point, to: Point, centerMode: boolean, isPerfect: boolean ): void {\n\t\tshape.disallowUploadedUpdate();\n\t\tconst position = shape.transform.position;\n\t\tif( centerMode ) {\n\t\t\tconst dx = Math.abs(to.x - from.x);\n\t\t\tconst dy = Math.abs(to.y - from.y);\n\t\t\tif (isPerfect) {\n\t\t\t\tconst hsize = Math.max(dx, dy);\n\t\t\t\tconst size = hsize + hsize;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( size ),\n\t\t\t\t\tEShapeSizes.toNormalized( size )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( from.x ),\n\t\t\t\t\tEShapeSizes.toRounded( from.y )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( dx + dx ),\n\t\t\t\t\tEShapeSizes.toNormalized( dy + dy )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( from.x ),\n\t\t\t\t\tEShapeSizes.toRounded( from.y )\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tif( isPerfect ) {\n\t\t\t\tconst dx = to.x - from.x;\n\t\t\t\tconst dy = to.y - from.y;\n\t\t\t\tconst size = Math.max(Math.abs(dx), Math.abs(dy));\n\t\t\t\tconst x2 = from.x + (dx < 0 ? -size : +size);\n\t\t\t\tconst y2 = from.y + (dy < 0 ? -size : +size);\n\t\t\t\tconst hsize = size * 0.5;\n\t\t\t\tconst x = Math.min(from.x, x2) + hsize;\n\t\t\t\tconst y = Math.min(from.y, y2) + hsize;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( size ),\n\t\t\t\t\tEShapeSizes.toNormalized( size )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( x ),\n\t\t\t\t\tEShapeSizes.toRounded( y )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst x0 = Math.min(from.x, to.x);\n\t\t\t\tconst y0 = Math.min(from.y, to.y);\n\t\t\t\tconst x1 = Math.max(from.x, to.x);\n\t\t\t\tconst y1 = Math.max(from.y, to.y);\n\t\t\t\tconst width = x1 - x0;\n\t\t\t\tconst height = y1 - y0;\n\t\t\t\tconst px = width * 0.5;\n\t\t\t\tconst py = height * 0.5;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( width ),\n\t\t\t\t\tEShapeSizes.toNormalized( height )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( x0 + px ),\n\t\t\t\t\tEShapeSizes.toRounded( y0 + py )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tshape.allowUploadedUpdate();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\nimport { EShapeActionValueTransformResizeType } from \"./e-shape-action-value-transform-resize-type\";\n\nconst sizeRelativeDefault = (): number => 1;\nconst sizeAbsoluteDefault = (): number => 100;\n\nexport class EShapeActionRuntimeTransformResize extends EShapeActionRuntimeConditional {\n\tprotected readonly size: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformResize, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tswitch( value.opetype ) {\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_SIZE:\n\t\t\tthis.size = this.toExpression( value.amount, sizeRelativeDefault, \"1\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_SIZE:\n\t\t\tthis.size = this.toExpression( value.amount, sizeAbsoluteDefault, \"100\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_HEIGHT:\n\t\t\tthis.size = this.toExpression( value.amount, sizeRelativeDefault, \"1\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_HEIGHT:\n\t\t\tthis.size = this.toExpression( value.amount, sizeAbsoluteDefault, \"100\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_WIDTH:\n\t\t\tthis.size = this.toExpression( value.amount, sizeRelativeDefault, \"1\" );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_WIDTH:\n\t\t\tthis.size = this.toExpression( value.amount, sizeAbsoluteDefault, \"100\" );\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.size = sizeRelativeDefault;\n\t\t}\n\t}\n\n\tprotected adjustPosition(\n\t\tshape: EShape, runtime: EShapeRuntime,\n\t\tdsx: number, dsy: number,\n\t\toriginX: number, originY: number\n\t): void {\n\t\tconst dx = ( -0.5 + originX ) * dsx;\n\t\tconst dy = ( -0.5 + originY ) * dsy;\n\t\tshape.updateTransform();\n\t\tconst transform = shape.transform;\n\t\tconst position = transform.position;\n\t\tconst localTransform = transform.localTransform;\n\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\truntime.written |= EShapeRuntimeReset.POSITION;\n\t\tposition.set(\n\t\t\toldPositionX + dx * localTransform.a + dy * localTransform.c,\n\t\t\toldPositionY + dx * localTransform.b + dy * localTransform.d\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformRotateType {\n\tRELATIVE,\n\tABSOLUTE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeHeightAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.HEIGHT );\n\t\tthis.origin = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.y = EShapeSizes.toNormalized( sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.HEIGHT;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\t0, oldSizeY - size.y,\n\t\t\t\t0.5, this.origin\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeHeightRelative extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.HEIGHT );\n\t\tthis.origin = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.y = EShapeSizes.toNormalized( oldSizeY * sizeRelative );\n\t\t\truntime.written |= EShapeRuntimeReset.HEIGHT;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\t0, oldSizeY - size.y,\n\t\t\t\t0.5, this.origin\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeSizeAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected originX: number;\n\tprotected originY: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.SIZE );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = EShapeSizes.toNormalized( this.size( shape, time ) );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.set( sizeAbsolute, sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.SIZE;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, oldSizeY - size.y,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeSizeRelative extends EShapeActionRuntimeTransformResize {\n\tprotected originX: number;\n\tprotected originY: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.SIZE );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.set(\n\t\t\t\tEShapeSizes.toNormalized( oldSizeX * sizeRelative ),\n\t\t\t\tEShapeSizes.toNormalized( oldSizeY * sizeRelative )\n\t\t\t);\n\t\t\truntime.written |= EShapeRuntimeReset.SIZE;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, oldSizeY - size.y,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeWidthAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.WIDTH );\n\t\tthis.origin = value.originX;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tsize.x = EShapeSizes.toNormalized( sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.WIDTH;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, 0,\n\t\t\t\tthis.origin, 0.5\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeWidthRelative extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.WIDTH );\n\t\tthis.origin = value.originX;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst oldSizeX = ( writtenWidth ? size.x : runtime.size.x );\n\t\t\tsize.x = EShapeSizes.toNormalized( oldSizeX * sizeRelative );\n\t\t\truntime.written |= EShapeRuntimeReset.WIDTH;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, 0,\n\t\t\t\tthis.origin, 0.5\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport {\n\tEShapeActionRuntimeTransformResizeHeightAbsolute\n} from \"./e-shape-action-runtime-transform-resize-height-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeHeightRelative\n} from \"./e-shape-action-runtime-transform-resize-height-relative\";\nimport {\n\tEShapeActionRuntimeTransformResizeSizeAbsolute\n} from \"./e-shape-action-runtime-transform-resize-size-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeSizeRelative\n} from \"./e-shape-action-runtime-transform-resize-size-relative\";\nimport {\n\tEShapeActionRuntimeTransformResizeWidthAbsolute\n} from \"./e-shape-action-runtime-transform-resize-width-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeWidthRelative\n} from \"./e-shape-action-runtime-transform-resize-width-relative\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformResizeType } from \"./e-shape-action-value-transform-resize-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformResizeSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.RESIZE,\n\tEShapeActionValueTransformResizeType,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueTransformResize\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformResizeType> {\n\treadonly originX: number;\n\treadonly originY: number;\n\treadonly amount: string;\n\n\tconstructor(\n\t\topetype: EShapeActionValueTransformResizeType,\n\t\tcondition: string,\n\t\toriginX: number, originY: number,\n\t\tamount: string\n\t) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.RESIZE, opetype );\n\t\tthis.originX = originX;\n\t\tthis.originY = originY;\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformResize) &&\n\t\t\tthis.originX === value.originX &&\n\t\t\tthis.originY === value.originY &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformResize {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_HEIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformResizeHeightAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_WIDTH:\n\t\t\treturn new EShapeActionRuntimeTransformResizeWidthAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_SIZE:\n\t\t\treturn new EShapeActionRuntimeTransformResizeSizeAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_HEIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformResizeHeightRelative( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_WIDTH:\n\t\t\treturn new EShapeActionRuntimeTransformResizeWidthRelative( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_SIZE:\n\t\t\treturn new EShapeActionRuntimeTransformResizeSizeRelative( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add( this.condition );\n\t\tconst amountId = manager.add( this.amount );\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${this.originX},${this.originY},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformResizeSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformResize {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformResize(\n\t\t\tserialized[ 3 ], condition,\n\t\t\tserialized[ 4 ], serialized[ 5 ], amount\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nconst amountDefault = (): number => 0;\n\nexport class EShapeActionRuntimeTransformRotate extends EShapeActionRuntimeConditional {\n\tprotected originY: number;\n\tprotected originX: number;\n\tprotected readonly amount: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformRotate, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.amount = this.toExpression( `(${value.amount}) * (Math.PI / 180)`, amountDefault, \"0\" );\n\t}\n\n\tprotected adjustPosition(\n\t\tshape: EShape, runtime: EShapeRuntime,\n\t\toldRotation: number, newRotation: number,\n\t\toriginX: number, originY: number\n\t): void {\n\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\tconst dx = (-0.5 + originX) * (writtenWidth ? shape.size.x : runtime.size.x);\n\t\tconst dy = (-0.5 + originY) * (writtenHeight ? shape.size.y : runtime.size.y);\n\t\tconst s = Math.sin( oldRotation ) - Math.sin( newRotation );\n\t\tconst c = Math.cos( oldRotation ) - Math.cos( newRotation );\n\t\tconst position = shape.transform.position;\n\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\truntime.written |= EShapeRuntimeReset.POSITION;\n\t\tposition.set(\n\t\t\toldPositionX + dx * c - dy * s,\n\t\t\toldPositionY + dx * s + dy * c\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nexport class EShapeActionRuntimeTransformRotateAbsolute extends EShapeActionRuntimeTransformRotate {\n\tconstructor( value: EShapeActionValueTransformRotate ) {\n\t\tsuper( value, EShapeRuntimeReset.ROTATION );\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst writtenRotation = ( (runtime.written & EShapeRuntimeReset.ROTATION) !== 0 );\n\t\t\tconst oldRotation = (writtenRotation ? transform.rotation : runtime.rotation);\n\t\t\ttransform.rotation = amount;\n\t\t\truntime.written |= EShapeRuntimeReset.ROTATION;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldRotation, amount,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nexport class EShapeActionRuntimeTransformRotateRelative extends EShapeActionRuntimeTransformRotate {\n\tconstructor( value: EShapeActionValueTransformRotate ) {\n\t\tsuper( value, EShapeRuntimeReset.ROTATION );\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( !! this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst writtenRotation = ( (runtime.written & EShapeRuntimeReset.ROTATION) !== 0 );\n\t\t\tconst oldRotation = (writtenRotation ? transform.rotation : runtime.rotation);\n\t\t\ttransform.rotation = oldRotation + amount;\n\t\t\truntime.written |= EShapeRuntimeReset.ROTATION;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldRotation, transform.rotation,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionRuntimeTransformRotateAbsolute } from \"./e-shape-action-runtime-transform-rotate-absolute\";\nimport { EShapeActionRuntimeTransformRotateRelative } from \"./e-shape-action-runtime-transform-rotate-relative\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformRotateType } from \"./e-shape-action-value-transform-rotate-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformRotateSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.ROTATE,\n\tEShapeActionValueTransformRotateType,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueTransformRotate\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformRotateType> {\n\treadonly originX: number;\n\treadonly originY: number;\n\treadonly amount: string;\n\n\tconstructor(\n\t\topetype: EShapeActionValueTransformRotateType, condition: string,\n\t\toriginX: number, originY: number, amount: string\n\t) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.ROTATE, opetype );\n\t\tthis.originX = originX;\n\t\tthis.originY = originY;\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformRotate) &&\n\t\t\tthis.originX === value.originX &&\n\t\t\tthis.originY === value.originY &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformRotate {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformRotateType.ABSOLUTE:\n\t\t\treturn new EShapeActionRuntimeTransformRotateAbsolute( this );\n\t\tcase EShapeActionValueTransformRotateType.RELATIVE:\n\t\t\treturn new EShapeActionRuntimeTransformRotateRelative( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.add( this.condition );\n\t\tconst amountId = manager.add( this.amount );\n\t\treturn manager.add(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${this.originX},${this.originY},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformRotateSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformRotate {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformRotate(\n\t\t\tserialized[ 3 ], condition,\n\t\t\tserialized[ 4 ], serialized[ 5 ], amount\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeCapability {\n\tNONE\t\t\t= 0,\n\n\tID\t\t\t\t= 1 << 0,\n\tPOSITION\t\t= 1 << 1,\n\tWIDTH\t\t\t= 1 << 2,\n\tHEIGHT\t\t\t= 1 << 3,\n\tROTATION\t\t= 1 << 4,\n\tSKEW\t\t\t= 1 << 5,\n\tALIGN\t\t\t= 1 << 6,\n\n\tREPLACING\t\t= 1 << 7,\n\tGROUPING\t\t= 1 << 8,\n\tFILL\t\t\t= 1 << 9,\n\tSTROKE\t\t\t= 1 << 10,\n\tSTROKE_SIDE\t\t= 1 << 11,\n\tBORDER_RADIUS\t= 1 << 12,\n\n\tTEXT\t\t\t= 1 << 13,\n\tTEXTURE\t\t\t= 1 << 14,\n\tTAG\t\t\t\t= 1 << 15,\n\tACTION\t\t\t= 1 << 16,\n\tCURSOR\t\t\t= 1 << 17,\n\tORDER_IN_LAYER\t= 1 << 18,\n\n\tCOORDINATE\t\t= ID | POSITION | WIDTH | HEIGHT | ROTATION | SKEW | ALIGN,\n\tSHAPE\t\t\t= REPLACING | GROUPING | FILL | STROKE,\n\tSHAPE_ROUNDED\t= SHAPE | BORDER_RADIUS,\n\tSHAPE_SIDED\t\t= SHAPE | STROKE_SIDE,\n\tSHAPE_SIDED_AND_ROUNDED = SHAPE | STROKE_SIDE | BORDER_RADIUS,\n\tLAYER\t\t\t= ORDER_IN_LAYER,\n\tPRIMITIVE\t\t= COORDINATE | SHAPE | TEXT | TEXTURE | TAG | ACTION | CURSOR | LAYER,\n\tSHADOW\t\t\t= NONE,\n\tALL\t\t\t\t= PRIMITIVE | STROKE_SIDE | BORDER_RADIUS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utilIsArray } from \"../../util/util-is-array\";\nimport { utilIsNumber } from \"../../util/util-is-number\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBlink, EShapeActionValueBlinkSerialized } from \"./e-shape-action-value-blink\";\nimport {\n\tEShapeActionValueChangeColor, EShapeActionValueChangeColorSerialized } from \"./e-shape-action-value-change-color\";\nimport {\n\tEShapeActionValueChangeColorBrightness, EShapeActionValueChangeColorBrightnessSerialized\n} from \"./e-shape-action-value-change-color-brightness\";\nimport {\n\tEShapeActionValueChangeColorCode, EShapeActionValueChangeColorCodeSerialized\n} from \"./e-shape-action-value-change-color-code\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-type\";\nimport {\n\tEShapeActionValueChangeCursor, EShapeActionValueChangeCursorSerialized } from \"./e-shape-action-value-change-cursor\";\nimport { EShapeActionValueChangeText, EShapeActionValueChangeTextSerialized } from \"./e-shape-action-value-change-text\";\nimport { EShapeActionValueEmitEvent, EShapeActionValueEmitEventSerialized } from \"./e-shape-action-value-emit-event\";\nimport { EShapeActionValueMisc, EShapeActionValueMiscSerialized } from \"./e-shape-action-value-misc\";\nimport { EShapeActionValueOpen, EShapeActionValueOpenSerialized } from \"./e-shape-action-value-open\";\nimport { EShapeActionValueShowHide, EShapeActionValueShowHideSerialized } from \"./e-shape-action-value-show-hide\";\nimport {\n\tEShapeActionValueShowHideType\n} from \"./e-shape-action-value-show-hide-type\";\nimport {\n\tEShapeActionValueTransformMove, EShapeActionValueTransformMoveSerialized\n} from \"./e-shape-action-value-transform-move\";\nimport {\n\tEShapeActionValueTransformResize, EShapeActionValueTransformResizeSerialized\n} from \"./e-shape-action-value-transform-resize\";\nimport {\n\tEShapeActionValueTransformRotate, EShapeActionValueTransformRotateSerialized\n} from \"./e-shape-action-value-transform-rotate\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport type EShapeActionValueSerialized = EShapeActionValueShowHideSerialized |\n\tEShapeActionValueBlinkSerialized | EShapeActionValueBlinkSerialized |\n\tEShapeActionValueChangeColorSerialized | EShapeActionValueChangeColorCodeSerialized |\n\tEShapeActionValueChangeColorBrightnessSerialized | EShapeActionValueChangeTextSerialized |\n\tEShapeActionValueChangeCursorSerialized | EShapeActionValueEmitEventSerialized |\n\tEShapeActionValueOpenSerialized | EShapeActionValueTransformMoveSerialized |\n\tEShapeActionValueTransformResizeSerialized | EShapeActionValueTransformRotateSerialized |\n\tEShapeActionValueMiscSerialized;\n\nexport class EShapeActionValueDeserializer {\n\tstatic toSerialized( resource: string ): EShapeActionValueSerialized | null {\n\t\ttry {\n\t\t\tconst parsed = JSON.parse( resource );\n\t\t\tif( utilIsArray( parsed ) ) {\n\t\t\t\tfor( let i = 0, imax = parsed.length; i < imax; ++i ) {\n\t\t\t\t\tif( ! utilIsNumber( parsed[ i ] ) ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( 2 <= parsed.length ) {\n\t\t\t\t\treturn parsed as EShapeActionValueSerialized;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t} catch( e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic deserialize( id: number, manager: EShapeResourceManagerDeserialization ): EShapeActionValue {\n\t\tconst actions = manager.actions;\n\t\tconst action = actions.get( id );\n\t\tif( action != null ) {\n\t\t\treturn action;\n\t\t}\n\n\t\tconst resources = manager.resources;\n\t\tconst resource = resources[ id ];\n\t\tif( resource != null ) {\n\t\t\tconst serialized = this.toSerialized( resource );\n\t\t\tif( serialized != null ) {\n\t\t\t\tswitch( serialized[ 0 ] ) {\n\t\t\t\tcase EShapeActionValueType.SHOW_HIDE:\n\t\t\t\t\treturn EShapeActionValueShowHide.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.BLINK:\n\t\t\t\t\treturn EShapeActionValueBlink.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.CHANGE_COLOR:\n\t\t\t\t\tswitch( serialized[ 3 ] ) {\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.COLOR_AND_ALPHA:\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.COLOR:\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.ALPHA:\n\t\t\t\t\t\t\treturn EShapeActionValueChangeColor.deserialize( serialized, manager );\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.CODE:\n\t\t\t\t\t\t\treturn EShapeActionValueChangeColorCode.deserialize( serialized, manager );\n\t\t\t\t\t\tcase EShapeActionValueChangeColorTarget.BRIGHTNESS:\n\t\t\t\t\t\t\treturn EShapeActionValueChangeColorBrightness.deserialize( serialized, manager );\n\t\t\t\t\t}\n\t\t\t\tcase EShapeActionValueType.CHANGE_TEXT:\n\t\t\t\t\treturn EShapeActionValueChangeText.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.CHANGE_CURSOR:\n\t\t\t\t\treturn EShapeActionValueChangeCursor.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.EMIT_EVENT:\n\t\t\t\t\treturn EShapeActionValueEmitEvent.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.OPEN:\n\t\t\t\t\treturn EShapeActionValueOpen.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.TRANSFORM:\n\t\t\t\t\tswitch( serialized[ 2 ] ) {\n\t\t\t\t\tcase EShapeActionValueTransformType.MOVE:\n\t\t\t\t\t\treturn EShapeActionValueTransformMove.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueTransformType.RESIZE:\n\t\t\t\t\t\treturn EShapeActionValueTransformResize.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueTransformType.ROTATE:\n\t\t\t\t\t\treturn EShapeActionValueTransformRotate.deserialize( serialized, manager );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeActionValueType.MISC:\n\t\t\t\t\treturn EShapeActionValueMisc.deserialize( serialized, manager );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn new EShapeActionValueShowHide( EShapeActionValueShowHideType.SHOW, \"\" );\n\t}\n}\n","\nexport class EShapeImageElements {\n\tstatic imageElements: { [ src: string ]: Promise<HTMLImageElement> | HTMLImageElement | undefined } = {};\n\n\tstatic toImageElement( dataUrl: string ): Promise<HTMLImageElement> {\n\t\tconst imageElements = EShapeImageElements.imageElements;\n\t\tconst cachedImageElement = imageElements[ dataUrl ];\n\t\tif( cachedImageElement != null ) {\n\t\t\tif( cachedImageElement instanceof HTMLImageElement ) {\n\t\t\t\treturn Promise.resolve( cachedImageElement );\n\t\t\t} else {\n\t\t\t\treturn cachedImageElement;\n\t\t\t}\n\t\t} else {\n\t\t\tconst result = new Promise<HTMLImageElement>(( resolve, reject ): void => {\n\t\t\t\tconst imageElement = document.createElement( \"img\" );\n\t\t\t\timageElement.onload = () => {\n\t\t\t\t\timageElements[ dataUrl ] = imageElement;\n\t\t\t\t\tresolve( imageElement );\n\t\t\t\t};\n\t\t\t\timageElement.onabort = imageElement.onerror = () => {\n\t\t\t\t\treject();\n\t\t\t\t};\n\t\t\t\timageElement.src = dataUrl;\n\t\t\t});\n\t\t\timageElements[ dataUrl ] = result;\n\t\t\treturn result;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDDiagramSerializedFill, DDiagramSerializedStroke, DDiagramSerializedTagRange, DDiagramSerializedTagValue,\n\tDDiagramSerializedText, DDiagramSerializedTextOutline\n} from \"../d-diagram-serialized\";\nimport { EShapeActionValue } from \"./action/e-shape-action-value\";\n\nexport class EShapeResourceManagerDeserialization {\n\tresources: string[];\n\tactions: Map<number, EShapeActionValue>;\n\tfills: Map<number, DDiagramSerializedFill>;\n\tstrokes: Map<number, DDiagramSerializedStroke>;\n\ttagValues: Map<number, DDiagramSerializedTagValue>;\n\ttags: Map<number, number[]>;\n\tranges: Map<number, DDiagramSerializedTagRange>;\n\taligns: Map<number, [ number, number ]>;\n\tmargins: Map<number, [ number, number ]>;\n\ttexts: Map<number, DDiagramSerializedText>;\n\ttextOutlines: Map<number, DDiagramSerializedTextOutline>;\n\textensions: Map<number, unknown>;\n\n\tconstructor( resources: string[] ) {\n\t\tthis.resources = resources;\n\t\tthis.actions = new Map<number, EShapeActionValue>();\n\t\tthis.fills = new Map<number, DDiagramSerializedFill>();\n\t\tthis.strokes = new Map<number, DDiagramSerializedStroke>();\n\t\tthis.tags = new Map<number, number[]>();\n\t\tthis.tagValues = new Map<number, DDiagramSerializedTagValue>();\n\t\tthis.ranges = new Map<number, DDiagramSerializedTagRange>();\n\t\tthis.aligns = new Map<number, [ number, number ]>();\n\t\tthis.margins = new Map<number, [ number, number ]>();\n\t\tthis.texts = new Map<number, DDiagramSerializedText>();\n\t\tthis.textOutlines = new Map<number, DDiagramSerializedTextOutline>();\n\t\tthis.extensions = new Map<number, unknown>();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { utilIsString } from \"../util/util-is-string\";\nimport { EShapeActionValueDeserializer } from \"./action/e-shape-action-value-deserializer\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeDeserializers } from \"./e-shape-deserializers\";\nimport { EShapeImageElements } from \"./e-shape-image-elements\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeSizes } from \"./e-shape-sizes\";\nimport { EShapeGradients } from \"./variant/e-shape-gradients\";\n\nexport class EShapeDeserializer {\n\tstatic toShape(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShape> | EShape | null {\n\t\tconst shapeDeserializer = EShapeDeserializers[ item[ 0 ] ];\n\t\tif( shapeDeserializer != null ) {\n\t\t\treturn shapeDeserializer( item, manager );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic deserialize<SHAPE extends EShape>(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization, result: SHAPE\n\t): Promise<SHAPE> | SHAPE {\n\t\tresult.id = manager.resources[ item[ 1 ] ] || \"\";\n\t\tresult.transform.position.set( item[ 2 ], item[ 3 ] );\n\t\tresult.transform.rotation = item[ 6 ];\n\t\tresult.transform.skew.set( item[ 7 ], item[ 7 ] );\n\t\tresult.transform.pivot.set( item[ 21 ], item[ 22 ] );\n\t\tresult.size.set( EShapeSizes.toNormalized( item[ 4 ] ), EShapeSizes.toNormalized( item[ 5 ] ) );\n\t\tresult.fill.deserialize( item[ 8 ], manager );\n\t\tresult.stroke.deserialize( item[ 9 ], manager );\n\t\tresult.cursor = manager.resources[ item[ 10 ] ] || \"\";\n\t\tresult.text.deserialize( item[ 11 ], manager );\n\t\tresult.tag.deserialize( item[ 12 ], manager );\n\t\tresult.radius = item[ 13 ];\n\t\tresult.corner = item[ 14 ];\n\t\tresult.interactive = !! ( item[ 23 ] & 1 );\n\t\tresult.unfocusable = !! ( item[ 23 ] & 2 );\n\t\tresult.shortcut = ( 0 <= item[ 24 ] ? manager.resources[ item[ 24 ] ] : undefined );\n\t\tresult.title = ( 0 <= item[ 25 ] ? manager.resources[ item[ 25 ] ] : undefined );\n\n\t\t// Children\n\t\tlet childrenPromise: Promise<SHAPE> | null = null;\n\t\tconst childrenSerialized = item[ 20 ];\n\t\tif( 0 < childrenSerialized.length ) {\n\t\t\tconst childrenOrPromises = [];\n\t\t\tfor( let i = 0, imax = childrenSerialized.length; i < imax; ++i ) {\n\t\t\t\tconst childSerialized = childrenSerialized[ i ];\n\t\t\t\tconst childOrPromise = EShapeDeserializer.toShape( childSerialized, manager );\n\t\t\t\tif( childOrPromise != null ) {\n\t\t\t\t\tchildrenOrPromises.push( childOrPromise );\n\t\t\t\t}\n\t\t\t}\n\t\t\tchildrenPromise = Promise.all( childrenOrPromises ).then(( children: EShape[] ) => {\n\t\t\t\tresult.children = children;\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\tchildren[ i ].parent = result;\n\t\t\t\t}\n\t\t\t\tresult.onChildTransformChange();\n\t\t\t\tresult.toDirty();\n\t\t\t\treturn result;\n\t\t\t});\n\t\t}\n\n\t\t// Action\n\t\tconst serializedActions = item[ 17 ];\n\t\tfor( let i = 0, imax = serializedActions.length; i < imax; ++i ) {\n\t\t\tresult.action.add( EShapeActionValueDeserializer.deserialize( serializedActions[ i ], manager ) );\n\t\t}\n\n\t\t// Gradient\n\t\tconst gradientId = item[ 19 ];\n\t\tif( 0 <= gradientId && gradientId < manager.resources.length ) {\n\t\t\tconst gradient = manager.resources[ gradientId ];\n\t\t\tif( utilIsString( gradient ) ) {\n\t\t\t\tresult.gradient = EShapeGradients.deserializeGradient( gradient );\n\t\t\t}\n\t\t}\n\n\t\t// Image\n\t\tlet imagePromise: Promise<SHAPE> | null = null;\n\t\tconst imageId = item[ 18 ];\n\t\tif( 0 <= imageId && imageId < manager.resources.length ) {\n\t\t\tconst imageSrc = manager.resources[ imageId ];\n\t\t\tif( utilIsString( imageSrc ) ) {\n\t\t\t\timagePromise = EShapeImageElements.toImageElement( imageSrc ).then(( imageElement ) => {\n\t\t\t\t\tresult.image = imageElement;\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( childrenPromise != null ) {\n\t\t\tif( imagePromise != null ) {\n\t\t\t\treturn Promise.all([ childrenPromise, imagePromise ]).then(() => {\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn childrenPromise;\n\t\t\t}\n\t\t} else {\n\t\t\tif( imagePromise != null ) {\n\t\t\t\treturn imagePromise;\n\t\t\t} else {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic deserializeAll( serializeds: DDiagramSerializedItem[], resources: string[] ): Promise<EShape[]> | null {\n\t\tconst manager = new EShapeResourceManagerDeserialization( resources );\n\t\tconst shapes: Array<Promise<EShape> | EShape> = [];\n\t\tfor( let i = 0, imax = serializeds.length; i < imax; ++i ) {\n\t\t\tconst serialized = serializeds[ i ];\n\t\t\tconst shape = EShapeDeserializer.toShape( serialized, manager );\n\t\t\tif( shape == null ) {\n\t\t\t\tif( 0 < shapes.length ) {\n\t\t\t\t\tPromise.all( shapes ).then( ( resolved: EShape[] ): void => {\n\t\t\t\t\t\tfor( let j = 0, jmax = resolved.length; j < jmax; ++j ) {\n\t\t\t\t\t\t\tresolved[ j ].destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tshapes.push( shape );\n\t\t}\n\t\tif( 0 < shapes.length ) {\n\t\t\treturn Promise.all( shapes );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeBar } from \"./e-shape-bar\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\n\nexport class EShapeBars {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeBar> | EShapeBar {\n\t\tconst shape = new EShapeBar( EShapeBarPosition.RIGHT, 10, 3, EShapePointsStyle.NONE );\n\t\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\t\tshape.points.deserialize( item[ 15 ], manager );\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeBarUploadeds } from \"../shape/variant/e-shape-bar-uploadeds\";\nimport { EShapeBars } from \"../shape/variant/e-shape-bars\";\n\nexport const loadShapeBar = () => {\n\tEShapeUploadeds[ EShapeType.BAR ] = EShapeBarUploadeds.create;\n\tEShapeDeserializers[ EShapeType.BAR ] = EShapeBars.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeCircleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\n\t\t// Clippings\n\t\tbuffer.clippingBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tconst ic = voffset * 3;\n\t\tclippings[ ic +  0 ] = 1;\n\t\tclippings[ ic +  1 ] = 1;\n\t\tclippings[ ic +  2 ] = 1;\n\n\t\tclippings[ ic +  3 ] = 0;\n\t\tclippings[ ic +  4 ] = 1;\n\t\tclippings[ ic +  5 ] = 1;\n\n\t\tclippings[ ic +  6 ] = 1;\n\t\tclippings[ ic +  7 ] = 1;\n\t\tclippings[ ic +  8 ] = 1;\n\n\t\tclippings[ ic +  9 ] = 1;\n\t\tclippings[ ic + 10 ] = 0;\n\t\tclippings[ ic + 11 ] = 1;\n\n\t\tclippings[ ic + 12 ] = 0;\n\t\tclippings[ ic + 13 ] = 0;\n\t\tclippings[ ic + 14 ] = 1;\n\n\t\tclippings[ ic + 15 ] = 1;\n\t\tclippings[ ic + 16 ] = 0;\n\t\tclippings[ ic + 17 ] = 1;\n\n\t\tclippings[ ic + 18 ] = 1;\n\t\tclippings[ ic + 19 ] = 1;\n\t\tclippings[ ic + 20 ] = 1;\n\n\t\tclippings[ ic + 21 ] = 0;\n\t\tclippings[ ic + 22 ] = 1;\n\t\tclippings[ ic + 23 ] = 1;\n\n\t\tclippings[ ic + 24 ] = 1;\n\t\tclippings[ ic + 25 ] = 1;\n\t\tclippings[ ic + 26 ] = 1;\n\n\t\t// Indices\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\t\tconst ii = ioffset * 3;\n\t\tindices[ ii +  0 ] = voffset + 0;\n\t\tindices[ ii +  1 ] = voffset + 1;\n\t\tindices[ ii +  2 ] = voffset + 3;\n\n\t\tindices[ ii +  3 ] = voffset + 1;\n\t\tindices[ ii +  4 ] = voffset + 4;\n\t\tindices[ ii +  5 ] = voffset + 3;\n\n\t\tindices[ ii +  6 ] = voffset + 1;\n\t\tindices[ ii +  7 ] = voffset + 2;\n\t\tindices[ ii +  8 ] = voffset + 4;\n\n\t\tindices[ ii +  9 ] = voffset + 2;\n\t\tindices[ ii + 10 ] = voffset + 5;\n\t\tindices[ ii + 11 ] = voffset + 4;\n\n\t\tindices[ ii + 12 ] = voffset + 3;\n\t\tindices[ ii + 13 ] = voffset + 4;\n\t\tindices[ ii + 14 ] = voffset + 6;\n\n\t\tindices[ ii + 15 ] = voffset + 4;\n\t\tindices[ ii + 16 ] = voffset + 7;\n\t\tindices[ ii + 17 ] = voffset + 6;\n\n\t\tindices[ ii + 18 ] = voffset + 4;\n\t\tindices[ ii + 19 ] = voffset + 5;\n\t\tindices[ ii + 20 ] = voffset + 7;\n\n\t\tindices[ ii + 21 ] = voffset + 5;\n\t\tindices[ ii + 22 ] = voffset + 8;\n\t\tindices[ ii + 23 ] = voffset + 7;\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateType0Vertex( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateType0Step( buffer, shape );\n\t\tthis.updateType0Uv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateType0Vertex( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\n\t\t\t// Invalidate the stroke width to update the steps / antialiases.\n\t\t\tthis.strokeWidth = NaN;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\n\t\t\tbuffer.vertexBuffer.update();\n\n\t\t\t// Calculate the transformed positions\n\t\t\t//\n\t\t\t//  0       1       2\n\t\t\t// |-------|-------|\n\t\t\t// |3      |4      |5\n\t\t\t// |-------|-------|\n\t\t\t// |6      |7      |8\n\t\t\t// |-------|-------|\n\t\t\t//\n\t\t\tconst s = strokeAlign * strokeWidth;\n\t\t\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\t\t\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst work = this.buffer.work;\n\t\t\twork.set( -sx, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x0 = work.x;\n\t\t\tconst y0 = work.y;\n\t\t\twork.set( 0, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x1 = work.x;\n\t\t\tconst y1 = work.y;\n\t\t\tconst dx = x1 - x0;\n\t\t\tconst dy = y1 - y0;\n\t\t\tconst x4 = internalTransform.tx;\n\t\t\tconst y4 = internalTransform.ty;\n\t\t\tconst x7 = x4 + (x4 - x1);\n\t\t\tconst y7 = y4 + (y4 - y1);\n\t\t\tconst x3 = x4 - dx;\n\t\t\tconst y3 = y4 - dy;\n\n\t\t\t// World size\n\t\t\tthis.worldSizeXHalf = this.calcLength( x0, y0, x1, y1 );\n\t\t\tthis.worldSizeYHalf = this.calcLength( x0, y0, x3, y3 );\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst iv = voffset * 2;\n\t\t\tvertices[ iv +  0 ] = x0;\n\t\t\tvertices[ iv +  1 ] = y0;\n\t\t\tvertices[ iv +  2 ] = x1;\n\t\t\tvertices[ iv +  3 ] = y1;\n\t\t\tvertices[ iv +  4 ] = x1 + dx;\n\t\t\tvertices[ iv +  5 ] = y1 + dy;\n\n\t\t\tvertices[ iv +  6 ] = x3;\n\t\t\tvertices[ iv +  7 ] = y3;\n\t\t\tvertices[ iv +  8 ] = x4;\n\t\t\tvertices[ iv +  9 ] = y4;\n\t\t\tvertices[ iv + 10 ] = x4 + dx;\n\t\t\tvertices[ iv + 11 ] = y4 + dy;\n\n\t\t\tvertices[ iv + 12 ] = x7 - dx;\n\t\t\tvertices[ iv + 13 ] = y7 - dy;\n\t\t\tvertices[ iv + 14 ] = x7;\n\t\t\tvertices[ iv + 15 ] = y7;\n\t\t\tvertices[ iv + 16 ] = x7 + dx;\n\t\t\tvertices[ iv + 17 ] = y7 + dy;\n\t\t}\n\t}\n\n\tprotected updateType0Step( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tif( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth ) {\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\n\t\t\tconst work = buffer.workStep;\n\t\t\tthis.calcStep( this.worldSizeXHalf, strokeWidth, work );\n\t\t\tconst swx = work[ 0 ];\n\t\t\tconst px0 = work[ 1 ];\n\t\t\tconst px1 = work[ 2 ];\n\n\t\t\tthis.calcStep( this.worldSizeYHalf, strokeWidth, work );\n\t\t\tconst swy = work[ 0 ];\n\t\t\tconst py0 = work[ 1 ];\n\t\t\tconst py1 = work[ 2 ];\n\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vcount = this.vertexCount - this.textVertexCount;\n\t\t\tthis.updateStep( buffer, voffset, vcount, swx, swy, px0, py0, px1, py1 );\n\t\t}\n\t}\n\n\tprotected updateType0Uv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst textureUvs = this.toTextureUvs( texture ) as any;\n\t\t\tconst x0 = textureUvs.x0;\n\t\t\tconst x1 = textureUvs.x1;\n\t\t\tconst x2 = textureUvs.x2;\n\t\t\tconst x3 = textureUvs.x3;\n\t\t\tconst y0 = textureUvs.y0;\n\t\t\tconst y1 = textureUvs.y1;\n\t\t\tconst y2 = textureUvs.y2;\n\t\t\tconst y3 = textureUvs.y3;\n\n\t\t\t// UVs\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst iuv = voffset * 2;\n\t\t\tuvs[ iuv +  0 ] = x0;\n\t\t\tuvs[ iuv +  1 ] = y0;\n\t\t\tuvs[ iuv +  2 ] = 0.5 * ( x0 + x1 );\n\t\t\tuvs[ iuv +  3 ] = 0.5 * ( y0 + y1 );\n\t\t\tuvs[ iuv +  4 ] = x1;\n\t\t\tuvs[ iuv +  5 ] = y1;\n\n\t\t\tuvs[ iuv +  6 ] = 0.5 * ( x0 + x3 );\n\t\t\tuvs[ iuv +  7 ] = 0.5 * ( y0 + y3 );\n\t\t\tuvs[ iuv +  8 ] = 0.5 * ( x0 + x2 );\n\t\t\tuvs[ iuv +  9 ] = 0.5 * ( y0 + y2 );\n\t\t\tuvs[ iuv + 10 ] = 0.5 * ( x1 + x2 );\n\t\t\tuvs[ iuv + 11 ] = 0.5 * ( y1 + y2 );\n\n\t\t\tuvs[ iuv + 12 ] = x3;\n\t\t\tuvs[ iuv + 13 ] = y3;\n\t\t\tuvs[ iuv + 14 ] = 0.5 * ( x3 + x2 );\n\t\t\tuvs[ iuv + 15 ] = 0.5 * ( y3 + y2 );\n\t\t\tuvs[ iuv + 16 ] = x2;\n\t\t\tuvs[ iuv + 17 ] = y2;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeCircleUploaded } from \"./e-shape-circle-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeCircleUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number\n\t): EShapeCircleUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = 9 + tvcount;\n\t\tconst icount = 8 + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeCircleUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeCircle extends EShapePrimitive {\n\tconstructor( type = EShapeType.CIRCLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeCircle {\n\t\treturn new EShapeCircle().copy( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tif( fill.enable ) {\n\t\t\t\tconst x2 = x * x;\n\t\t\t\tconst y2 = y * y;\n\t\t\t\tconst ax2 = ax * ax;\n\t\t\t\tconst ay2 = ay * ay;\n\t\t\t\tif( x2 * ay2 + y2 * ax2 <= ax2 * ay2 ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\tconst x2 = x * x;\n\t\t\t\t\tconst y2 = y * y;\n\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\tconst wx2 = wx * wx;\n\t\t\t\t\tconst wy2 = wy * wy;\n\t\t\t\t\tif( wx2 * wy2 <= x2 * wy2 + y2 * wx2 ) {\n\t\t\t\t\t\tconst ax2 = ax * ax;\n\t\t\t\t\t\tconst ay2 = ay * ay;\n\t\t\t\t\t\tif( x2 * ay2 + y2 * ax2 <= ax2 * ay2 ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeCircle } from \"./e-shape-circle\";\n\nexport class EShapeCircles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeCircle> | EShapeCircle {\n\t\treturn EShapeDeserializer.deserialize( item, manager, EShapeCircles.create() );\n\t}\n\n\tstatic create(): EShapeCircle {\n\t\treturn new EShapeCircle();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeCircleUploadeds } from \"../shape/variant/e-shape-circle-uploadeds\";\nimport { EShapeCircles } from \"../shape/variant/e-shape-circles\";\n\nexport const loadShapeCircle = () => {\n\tEShapeUploadeds[ EShapeType.CIRCLE ] = EShapeCircleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.CIRCLE ] = EShapeCircles.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\n\nexport class EShapeGroupUploaded extends EShapeUploadedBase {\n\tconstructor( buffer: EShapeBuffer, voffset: number, ioffset: number ) {\n\t\tsuper( buffer, voffset, ioffset, 0, 0 );\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.texture = shape.texture || Texture.WHITE;\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeGroupUploaded } from \"./e-shape-group-uploaded\";\n\nexport class EShapeGroupUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n\t): EShapeGroupUploaded | null {\n\t\treturn new EShapeGroupUploaded( buffer, voffset, ioffset ).init( shape );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupFillEditor implements EShapeFill {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.enable;\n\t\t}\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.alpha = alpha;\n\t\t}\n\t}\n\n\tcopy( target: EShapeFillLike ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.copy( target );\n\t\t}\n\t}\n\n\tset( enable: boolean, color: number, alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.set( enable, color, alpha );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupFillEditor {\n\t\treturn new EShapeGroupFillEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShapePoints, EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapePointsParent } from \"../e-shape-points-parent\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupPoints implements EShapePoints {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget length(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.length;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget id(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.id;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget values(): number[] {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.values;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tset values( values: number[] ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.values = values;\n\t\t\t}\n\t\t}\n\t}\n\n\tget segments(): number[] {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.segments;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tset segments( segments: number[] ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.segments = segments;\n\t\t\t}\n\t\t}\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.style;\n\t\t\t}\n\t\t}\n\t\treturn EShapePointsStyle.NONE;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.style = style;\n\t\t\t}\n\t\t}\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.copy( source );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tset( values?: number[], segments?: number[], style?: EShapePointsStyle ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.set( values, segments, style );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tclone( parent: EShapePointsParent ): EShapeGroupPoints {\n\t\treturn new EShapeGroupPoints( parent );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.toPoints( transform );\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.serialize( manager );\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\n\nexport class EShapeEditor {\n\tlocalTransform: Matrix;\n\tinternalTransform: Matrix;\n\tinternalTransformParentInverse: Matrix;\n\trotation: number;\n\tsize: Point;\n\n\tconstructor() {\n\t\tthis.localTransform = new Matrix();\n\t\tthis.internalTransform = new Matrix();\n\t\tthis.internalTransformParentInverse = new Matrix();\n\t\tthis.rotation = 0;\n\t\tthis.size = new Point();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeEditor } from \"./e-shape-editor\";\nimport { EShapeSizes } from \"./e-shape-sizes\";\nimport { EShapeBase } from \"./variant/e-shape-base\";\n\nexport class EShapeTransforms {\n\tstatic prepare( shape: EShape ): void {\n\t\tconst editor = shape.editor = (shape.editor || new EShapeEditor());\n\n\t\t// Ttransform\n\t\tshape.updateTransform();\n\t\tconst parent = shape.parent;\n\t\tif( parent instanceof EShapeBase ) {\n\t\t\tparent.transform.internalTransform.copyTo(editor.internalTransformParentInverse).invert();\n\t\t} else {\n\t\t\teditor.internalTransformParentInverse.identity();\n\t\t}\n\t\tshape.transform.internalTransform.copyTo(editor.internalTransform);\n\n\t\t// Rotation\n\t\teditor.rotation = shape.transform.rotation;\n\n\t\t// Size\n\t\teditor.size.copyFrom( shape.size );\n\n\t\t//\n\t\tshape.disallowOnTransformChange();\n\t}\n\n\tstatic finalize( shape: EShape ): void {\n\t\tshape.allowOnTransformChange( true );\n\t}\n\n\tstatic apply( shape: EShape, transform: Matrix, keepSize: boolean ): void {\n\t\tconst editor = shape.editor;\n\t\tif( editor != null ) {\n\t\t\tconst newLocalTransform = editor.localTransform;\n\t\t\teditor.internalTransformParentInverse.copyTo(newLocalTransform)\n\t\t\t\t.append(transform).append(editor.internalTransform);\n\t\t\tif( keepSize ) {\n\t\t\t\tthis.applyLocal( shape, newLocalTransform );\n\t\t\t} else {\n\t\t\t\tconst size = editor.size;\n\t\t\t\tthis.applyLocal( shape, newLocalTransform, size.x, size.y );\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic applyLocal( shape: EShape, localTransform: Matrix, bx?: number, by?: number ): void {\n\t\tshape.disallowUploadedUpdate();\n\n\t\t// Reconstruct the position, the rotation and the size\n\t\tconst a = localTransform.a;\n\t\tconst b = localTransform.b;\n\t\tconst c = localTransform.c;\n\t\tconst d = localTransform.d;\n\t\tconst tx = localTransform.tx;\n\t\tconst ty = localTransform.ty;\n\n\t\t// Rotation\n\t\tconst transform = shape.transform;\n\t\tconst rx = Math.atan2(-c, d); // rotation - skewX\n\t\tconst ry = Math.atan2(+b, a); // rotation + skewY\n\t\ttransform.rotation = (rx + ry) * 0.5; // Here, assumes `skewX` === `skewY`\n\n\t\t// Skew\n\t\tconst skew = (ry - rx) * 0.5;\n\t\ttransform.skew.set(skew, skew);\n\n\t\t// Position: Assumes the pivot is invariant.\n\t\t// tx = position.x - (a * px + c * py)\n\t\t// ty = position.y - (b * px + d * py)\n\t\t//\n\t\t// Thus,\n\t\t// position.x = tx + (a * px + c * py)\n\t\t// position.y = ty + (b * px + d * py)\n\t\tconst pivot = transform.pivot;\n\t\tconst px = pivot.x;\n\t\tconst py = pivot.y;\n\t\ttransform.position.set(\n\t\t\ttx + (a * px + c * py),\n\t\t\tty + (b * px + d * py)\n\t\t);\n\n\t\t// Scale\n\t\tif( bx != null && by != null ) {\n\t\t\tconst sx = Math.sqrt( a * a + b * b );\n\t\t\tconst sy = Math.sqrt( c * c + d * d );\n\t\t\tshape.size.set(\n\t\t\t\tEShapeSizes.toNormalized( bx * sx ),\n\t\t\t\tEShapeSizes.toNormalized( by * sy )\n\t\t\t);\n\t\t}\n\n\t\t//\n\t\tshape.allowUploadedUpdate();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapeTransforms } from \"../e-shape-transforms\";\n\nexport class EShapeGroupSizeLayout implements EShapeLayout {\n\tprotected static WORK_TRANSFORM: Matrix = new Matrix();\n\n\tprotected shape: EShape;\n\tprotected base: Point;\n\tprotected shapeBase: Point;\n\tprotected transform: Matrix;\n\n\tconstructor( shape: EShape, bx: number, by: number ) {\n\t\tthis.shape = shape;\n\n\t\t// Base group size\n\t\tthis.base = new Point( bx, by );\n\n\t\t// Base shape size\n\t\tconst size = shape.size;\n\t\tthis.shapeBase = new Point( size.x, size.y );\n\n\t\t// Transform\n\t\tthis.transform = new Matrix();\n\t\tshape.updateTransform();\n\t\tshape.transform.localTransform.copyTo( this.transform );\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\treturn this.shape === shape;\n\t}\n\n\treset( shape: EShape, baseX: number, baseY: number ): void {\n\t\tthis.base.set( baseX, baseY );\n\n\t\t// Base shape size\n\t\tconst size = shape.size;\n\t\tthis.shapeBase.copyFrom( size );\n\n\t\t// Transform\n\t\tshape.updateTransform();\n\t\tshape.transform.localTransform.copyTo( this.transform );\n\t}\n\n\tupdate(\n\t\tshape: EShape, baseX: number, baseY: number,\n\t\tpivotX: number, pivotY: number\n\t) {\n\t\tconst sx = baseX / this.base.x;\n\t\tconst sy = baseY / this.base.y;\n\t\tconst childBase = this.shapeBase;\n\t\tconst transform = EShapeGroupSizeLayout.WORK_TRANSFORM;\n\t\ttransform.identity()\n\t\t\t.append( this.transform )\n\t\t\t.translate( -pivotX, -pivotY )\n\t\t\t.scale( sx, sy )\n\t\t\t.translate( +pivotX, +pivotY );\n\t\tshape.disallowOnTransformChange();\n\t\tEShapeTransforms.applyLocal( shape, transform, childBase.x, childBase.y );\n\t\tshape.allowOnTransformChange( false );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point, Rectangle } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeLayout } from \"./e-shape-group-size-layout\";\nimport { EShapeGroupSizeParent } from \"./e-shape-group-size-parent\";\n\nexport class EShapeGroupSizeEditor implements EShapeGroupSize {\n\tprotected _parent: EShapeGroupSizeParent;\n\tprotected _size: Point;\n\tprotected _layouts: EShapeLayout[];\n\tprotected _workPoint: Point = new Point();\n\tprotected _workRectForCalcRect: Rectangle = new Rectangle();\n\tprotected _workRectForFit: Rectangle = new Rectangle();\n\n\tconstructor( parent: EShapeGroupSizeParent, x: number, y: number ) {\n\t\tthis._parent = parent;\n\t\tthis._layouts = [];\n\t\tthis._size = new Point( x, y );\n\t}\n\n\tinit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget x(): number {\n\t\treturn this._size.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst size = this._size;\n\t\tif( size.x !== x ) {\n\t\t\tconst ox = size.x;\n\t\t\tsize.x = x;\n\t\t\tthis.onChange( ox, size.y );\n\t\t}\n\t}\n\n\tget y(): number {\n\t\treturn this._size.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst size = this._size;\n\t\tif( size.y !== y ) {\n\t\t\tconst oy = size.y;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( size.x, oy );\n\t\t}\n\t}\n\n\tset( x?: number | undefined, y?: number | undefined ): void {\n\t\tlet isChanged = false;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( x != null && ox !== x ) {\n\t\t\tisChanged = true;\n\t\t\tsize.x = x;\n\t\t}\n\t\tif( y != null && oy !== y ) {\n\t\t\tisChanged = true;\n\t\t\tsize.y = y;\n\t\t}\n\t\tif( isChanged ) {\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupSizeEditor {\n\t\tconst size = this._size;\n\t\treturn new EShapeGroupSizeEditor( this._parent, size.x, size.y );\n\t}\n\n\tcopy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tcopyFrom( point: IPoint ): this {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( ox !== x || oy !== y ) {\n\t\t\tsize.x = x;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( point: IPoint ): IPoint {\n\t\treturn this._size.copyTo( point );\n\t}\n\n\tequals( point: IPoint ): boolean {\n\t\treturn this._size.equals( point );\n\t}\n\n\tfit(): void {\n\t\tconst parent = this._parent;\n\t\tparent.disallowOnTransformChange();\n\n\t\t// Calculate the rect\n\t\tconst rect = this.calcRect( this._workRectForFit );\n\n\t\t// Set size\n\t\tconst size = this._size;\n\t\tsize.set( rect.width, rect.height );\n\n\t\t// Position & Pivot\n\t\t// rx := rect.x\n\t\t// ry := rect.y\n\t\t//\n\t\t// | a c tx | | 1 0 +rx | | 1 0 -rx |   | a c tx + (a * rx + c * ry) | | 1 0 -rx |\n\t\t// | b d ty | | 0 1 +ry | | 0 1 -ry | = | b d ty + (b * rx + d * ry) | | 0 1 -ry |\n\t\t// | 0 0 1  | | 0 0  1  | | 0 0  1  |   | 0 0 1                      | | 0 0  1  |\n\t\t//\n\t\t// tx -> tx + (a * rx + c * ry) = poxition.x - (a * pivot.x + c * pivot.y)\n\t\t// ty -> ty + (b * rx + d * ry) = poxition.y - (b * pivot.x + d * pivot.y)\n\t\t// position.x -> position.x + (a * rx + c * ry) - (a * pivot.x + c * pivot.y)\n\t\t// position.y -> position.y + (b * rx + d * ry) - (b * pivot.x + d * pivot.y)\n\t\t// pivot.x -> 0\n\t\t// pivot.y -> 0\n\t\t//\n\t\t// a -> a', b -> b', c -> c', tx -> tx', ty -> ty'\n\t\t//\n\t\t// | a' c' tx' | | 1 0 -rx |   | a' c' tx' - (a' * rx + c' * ry) |\n\t\t// | b' d' ty' | | 0 1 -ry | = | b' d' ty' - (b' * rx + d' * ry) |\n\t\t// | 0  0  1   | | 0 0  1  |   | 0  0  1                         |\n\t\t//\n\t\t// tx' -> tx' - (a' * rx + c' * ry) = poxition.x - (a' * pivot.x + c' * pivot.y)\n\t\t// ty' -> ty' - (b' * rx + d' * ry) = poxition.y - (b' * pivot.x + d' * pivot.y)\n\t\t// pivot.x -> pivot.x + rx\n\t\t// pivot.y -> pivot.y + ry\n\t\tparent.updateTransform();\n\t\tconst transform = parent.transform;\n\t\tconst x = rect.x + rect.width * 0.5;\n\t\tconst y = rect.y + rect.height * 0.5;\n\t\tconst position = transform.position;\n\t\tconst localTransform = transform.localTransform;\n\t\tconst a = localTransform.a;\n\t\tconst b = localTransform.b;\n\t\tconst c = localTransform.c;\n\t\tconst d = localTransform.d;\n\t\tconst pivot = transform.pivot;\n\t\tposition.set(\n\t\t\tposition.x + (a * x + c * y) - (a * pivot.x + c * pivot.y),\n\t\t\tposition.y + (b * x + d * y) - (b * pivot.x + d * pivot.y)\n\t\t);\n\t\tpivot.set( x, y );\n\n\t\t// Reset the data\n\t\tthis.reset( parent.children, this._layouts, size );\n\n\t\t//\n\t\tparent.allowOnTransformChange( true );\n\t}\n\n\tprotected reset( children: EShape[], layouts: EShapeLayout[], size: IPoint ): void {\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = layouts[ i ];\n\t\t\tif( layout.isCompatible( child ) ) {\n\t\t\t\tlayout.reset( child, size.x, size.y );\n\t\t\t} else {\n\t\t\t\tlayouts.length = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif( children.length < layouts.length ) {\n\t\t\tlayouts.length = children.length;\n\t\t}\n\t}\n\n\tcalcRect( result: Rectangle ): Rectangle {\n\t\tconst parent = this._parent;\n\t\tconst children = parent.children;\n\t\tif( children.length <= 0 ) {\n\t\t\tresult.x = 0;\n\t\t\tresult.y = 0;\n\t\t\tresult.width = 0;\n\t\t\tresult.height = 0;\n\t\t} else {\n\t\t\tconst workPoint = this._workPoint;\n\t\t\tconst workRect = this._workRectForCalcRect;\n\t\t\tchildren[ 0 ].getBoundsLocal( workPoint, false, result );\n\t\t\tfor( let i = 1, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tchild.getBoundsLocal( workPoint, false, workRect );\n\t\t\t\tresult.enlarge( workRect );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onChange( ox: number, oy: number ): void {\n\t\tconst parent = this._parent;\n\t\tconst size = this._size;\n\t\tconst pivot = parent.transform.pivot;\n\t\tthis.onChange_( parent.children, this._layouts, size.x, size.y, pivot.x, pivot.y, ox, oy );\n\t\tparent.onSizeChange();\n\t}\n\n\tprotected onChange_(\n\t\tchildren: EShape[],\n\t\tlayouts: EShapeLayout[],\n\t\tsx: number, sy: number,\n\t\tpx: number, py: number,\n\t\tox: number, oy: number\n\t): void {\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = layouts[ i ];\n\t\t\tif( layout.isCompatible( child ) ) {\n\t\t\t\tlayout.update( child, sx, sy, px, py );\n\t\t\t} else {\n\t\t\t\tlayouts.length = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor( let i = layouts.length, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = this.newLayout( child, ox, oy );\n\t\t\tlayout.update( child, sx, sy, px, py );\n\t\t\tlayouts.push( layout );\n\t\t}\n\t\tif( layouts.length !== children.length ) {\n\t\t\tlayouts.length = children.length;\n\t\t}\n\t}\n\n\tprotected newLayout( shape: EShape, ox: number, oy: number ): EShapeLayout {\n\t\treturn shape.layout || new EShapeGroupSizeLayout( shape, ox, oy );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { ObservablePoint, Point } from \"pixi.js\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\n\nexport class EShapeGroupSizeViewer extends ObservablePoint implements EShapeGroupSize {\n\tbase: Point;\n\n\tconstructor( cb: () => void, x: number, y: number ) {\n\t\tsuper( cb, undefined, x, y );\n\t\tthis.base = new Point( x, y );\n\t}\n\n\tinit(): void {\n\t\tthis.base.copyFrom( this );\n\t\t(this as any).cb();\n\t}\n\n\tfit(): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike, EShapeStrokeSide } from \"../e-shape-stroke\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupStrokeEditor implements EShapeStroke {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.enable;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.alpha = alpha;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.width;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.width = width;\n\t\t}\n\t}\n\n\tget align(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.align;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset align( align: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.align = align;\n\t\t}\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.side;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.side = side;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.copy( target );\n\t\t}\n\t}\n\n\tset( enable: boolean, color: number, alpha: number, width: number, side: EShapeStrokeSide ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.set( enable, color, alpha, width, side );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupStrokeEditor {\n\t\treturn new EShapeGroupStrokeEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0,\n\t\t\talign: 0.0,\n\t\t\tside: EShapeStrokeSide.NONE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextAlignEditor implements EShapeTextAlign {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.horizontal;\n\t\t}\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.vertical;\n\t\t}\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: EShapeTextAlignHorizontal.CENTER,\n\t\t\tvertical: EShapeTextAlignVertical.MIDDLE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextOffsetEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextOutlineEditor implements EShapeTextOutline {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.enable;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.alpha = alpha;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.width;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.width = width;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.copy( target );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.set( enable, color, alpha, width );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupTextOutlineEditor {\n\t\treturn new EShapeGroupTextOutlineEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextPaddingEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextSpacingEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeTextOutline } from \"../e-shape-text-outline\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\nimport { EShapeGroupTextAlignEditor } from \"./e-shape-group-text-align-editor\";\nimport { EShapeGroupTextOffsetEditor } from \"./e-shape-group-text-offset-editor\";\nimport { EShapeGroupTextOutlineEditor } from \"./e-shape-group-text-outline-editor\";\nimport { EShapeGroupTextPaddingEditor } from \"./e-shape-group-text-padding-editor\";\nimport { EShapeGroupTextSpacingEditor } from \"./e-shape-group-text-spacing-editor\";\n\nexport class EShapeGroupTextEditor implements EShapeText {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\talign: EShapeGroupTextAlignEditor;\n\toffset: EShapeGroupTextOffsetEditor;\n\toutline: EShapeTextOutline;\n\tspacing: EShapeGroupTextSpacingEditor;\n\tpadding: EShapeGroupTextPaddingEditor;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\n\t\tthis.align = new EShapeGroupTextAlignEditor( parent );\n\t\tthis.offset = new EShapeGroupTextOffsetEditor( parent );\n\t\tthis.outline = new EShapeGroupTextOutlineEditor( parent );\n\t\tthis.spacing = new EShapeGroupTextSpacingEditor( parent );\n\t\tthis.padding = new EShapeGroupTextPaddingEditor( parent );\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.enable;\n\t\t}\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.enable = enable;\n\t\t}\n\t}\n\n\tget value(): string {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.value;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tset value( value: string ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.value = value;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.color;\n\t\t}\n\t\treturn 0x000000;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.alpha = alpha;\n\t\t}\n\t}\n\n\tget family(): string {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.family;\n\t\t}\n\t\treturn \"auto\";\n\t}\n\n\tset family( family: string ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.family = family;\n\t\t}\n\t}\n\n\tget size(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.size;\n\t\t}\n\t\treturn 24;\n\t}\n\n\tset size( size: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.size = size;\n\t\t}\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.weight;\n\t\t}\n\t\treturn EShapeTextWeight.NORMAL;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.weight = weight;\n\t\t}\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.style;\n\t\t}\n\t\treturn EShapeTextStyle.NORMAL;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.style = style;\n\t\t}\n\t}\n\n\tget direction(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.direction;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset direction( direction: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.direction = direction;\n\t\t}\n\t}\n\n\tget clipping(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.clipping;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.clipping = clipping;\n\t\t}\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.copy( target );\n\t\t}\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection\n\t): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.set( value, color, alpha, family, size, weight, style, direction );\n\t\t}\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.toObject();\n\t\t}\n\t\treturn {\n\t\t\tvalue: \"\",\n\t\t\tcolor: 0x000000,\n\t\t\talpha: 1.0,\n\t\t\tfamily: \"auto\",\n\t\t\tsize: 24,\n\t\t\tweight: EShapeTextWeight.NORMAL,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: EShapeTextStyle.NORMAL,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tdirection: EShapeTextDirection.LEFT_TO_RIGHT,\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: false\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeGroupFillEditor } from \"./e-shape-group-fill-editor\";\nimport { EShapeGroupPoints } from \"./e-shape-group-points\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeEditor } from \"./e-shape-group-size-editor\";\nimport { EShapeGroupSizeViewer } from \"./e-shape-group-size-viewer\";\nimport { EShapeGroupStrokeEditor } from \"./e-shape-group-stroke-editor\";\nimport { EShapeGroupTextEditor } from \"./e-shape-group-text-editor\";\nimport { EShapeTagImpl } from \"./e-shape-tag-impl\";\n\nexport class EShapeGroup extends EShapeBase implements EShapeGroupPropertyParent {\n\tsize: EShapeGroupSize;\n\tfill: EShapeFill;\n\tstroke: EShapeStroke;\n\ttag: EShapeTag;\n\ttext: EShapeText;\n\n\tprotected _points?: EShapeGroupPoints;\n\n\tconstructor( type = EShapeType.GROUP ) {\n\t\tsuper( type );\n\t\tthis.tag = new EShapeTagImpl();\n\t\tthis.size = this.newGroupSize();\n\t\tthis.fill = this.newGroupFill();\n\t\tthis.stroke = this.newGroupStroke();\n\t\tthis.text = this.newGroupText();\n\t\tthis.points = this.newGroupPoints();\n\t}\n\n\tprotected newGroupSize(): EShapeGroupSize {\n\t\tif( EShapeDefaults.IS_EDIT_MODE ) {\n\t\t\treturn new EShapeGroupSizeEditor(\n\t\t\t\tthis,\n\t\t\t\tEShapeDefaults.SIZE_X,\n\t\t\t\tEShapeDefaults.SIZE_Y\n\t\t\t);\n\t\t} else {\n\t\t\tconst result = new EShapeGroupSizeViewer(\n\t\t\t\t() => {\n\t\t\t\t\tconst base = result.base;\n\t\t\t\t\tthis.transform.scale.set(\n\t\t\t\t\t\tresult.x / base.x,\n\t\t\t\t\t\tresult.y / base.y\n\t\t\t\t\t);\n\t\t\t\t},\n\t\t\t\tEShapeDefaults.SIZE_X,\n\t\t\t\tEShapeDefaults.SIZE_Y\n\t\t\t);\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tprotected newGroupFill(): EShapeFill {\n\t\treturn new EShapeGroupFillEditor( this );\n\t}\n\n\tprotected newGroupStroke(): EShapeStroke {\n\t\treturn new EShapeGroupStrokeEditor( this );\n\t}\n\n\tprotected newGroupText(): EShapeText {\n\t\treturn new EShapeGroupTextEditor( this );\n\t}\n\n\tprotected newGroupPoints(): EShapePoints | undefined {\n\t\treturn new EShapeGroupPoints( this );\n\t}\n\n\tprotected getBoundsSize(): IPoint {\n\t\tconst size = this.size;\n\t\tif( size instanceof EShapeGroupSizeViewer ) {\n\t\t\treturn size.base;\n\t\t} else {\n\t\t\treturn size;\n\t\t}\n\t}\n\n\tonChildTransformChange(): void {\n\t\tsuper.onChildTransformChange();\n\t\tthis.size.fit();\n\t}\n\n\tget corner(): EShapeCorner {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].corner;\n\t\t}\n\t\treturn EShapeCorner.ALL;\n\t}\n\n\tset corner( corner: EShapeCorner ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].corner = corner;\n\t\t}\n\t}\n\n\tget cursor(): string {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].cursor;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tset cursor( cursor: string ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].cursor = cursor;\n\t\t}\n\t}\n\n\tget gradient(): EShapeGradientLike | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst gradient = children[ i ].gradient;\n\t\t\tif( gradient != null ) {\n\t\t\t\treturn gradient;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset gradient( gradient: EShapeGradientLike | undefined ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].gradient = gradient;\n\t\t}\n\t}\n\n\tget radius(): number {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].radius;\n\t\t}\n\t\treturn 0.5;\n\t}\n\n\tset radius( radius: number ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].radius = radius;\n\t\t}\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst image = children[ i ].image;\n\t\t\tif( image != null ) {\n\t\t\t\treturn image;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].image = image;\n\t\t}\n\t}\n\n\tget points(): EShapePoints | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn this._points;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset points( points: EShapePoints | undefined ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroup {\n\t\tconst constructor = this.constructor as new () => EShapeGroup;\n\t\tconst result = new constructor().copy( this );\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst clone = children[ i ].clone();\n\t\t\tclone.parent = result;\n\t\t\tresult.children.push( clone );\n\t\t}\n\t\tresult.onChildTransformChange();\n\t\tresult.toDirty();\n\t\treturn result;\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeGroup } from \"./e-shape-group\";\n\nexport class EShapeGroups {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeGroup> | EShapeGroup {\n\t\tconst shape = EShapeGroups.create();\n\t\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\t\tshape.size.init();\n\t\treturn result;\n\t}\n\n\tstatic create(): EShapeGroup {\n\t\treturn new EShapeGroup();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeGroupUploadeds } from \"../shape/variant/e-shape-group-uploadeds\";\nimport { EShapeGroups } from \"../shape/variant/e-shape-groups\";\n\nexport const loadShapeGroup = () => {\n\tEShapeUploadeds[ EShapeType.GROUP ] = EShapeGroupUploadeds.create;\n\tEShapeDeserializers[ EShapeType.GROUP ] = EShapeGroups.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeParent } from \"./e-shape-group-size-parent\";\n\nexport class EShapeGroupSizeShadowed implements EShapeGroupSize {\n\tprotected _parent: EShapeGroupSizeParent;\n\tprotected _size: Point;\n\n\tconstructor( parent: EShapeGroupSizeParent, x: number, y: number ) {\n\t\tthis._parent = parent;\n\t\tthis._size = new Point( x, y );\n\t}\n\n\tinit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget x(): number {\n\t\treturn this._size.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst size = this._size;\n\t\tif( size.x !== x ) {\n\t\t\tconst ox = size.x;\n\t\t\tsize.x = x;\n\t\t\tthis.onChange( ox, size.y );\n\t\t}\n\t}\n\n\tget y(): number {\n\t\treturn this._size.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst size = this._size;\n\t\tif( size.y !== y ) {\n\t\t\tconst oy = size.y;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( size.x, oy );\n\t\t}\n\t}\n\n\tset( x?: number | undefined, y?: number | undefined ): void {\n\t\tlet isChanged = false;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( x != null && ox !== x ) {\n\t\t\tisChanged = true;\n\t\t\tsize.x = x;\n\t\t}\n\t\tif( y != null && oy !== y ) {\n\t\t\tisChanged = true;\n\t\t\tsize.y = y;\n\t\t}\n\t\tif( isChanged ) {\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupSizeShadowed {\n\t\tconst size = this._size;\n\t\treturn new EShapeGroupSizeShadowed( this._parent, size.x, size.y );\n\t}\n\n\tcopy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tcopyFrom( point: IPoint ): this {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( ox !== x || oy !== y ) {\n\t\t\tsize.x = x;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( point: IPoint ): IPoint {\n\t\treturn this._size.copyTo( point );\n\t}\n\n\tequals( point: IPoint ): boolean {\n\t\treturn this._size.equals( point );\n\t}\n\n\tfit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onChange( ox: number, oy: number ): void {\n\t\tthis._parent.onSizeChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeGroup } from \"./e-shape-group\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeShadowed } from \"./e-shape-group-size-shadowed\";\n\nexport class EShapeGroupShadowed extends EShapeGroup {\n\tconstructor( type: EShapeType = EShapeType.GROUP_SHADOWED ) {\n\t\tsuper( type );\n\t}\n\n\tprotected newGroupSize(): EShapeGroupSize {\n\t\tif( EShapeDefaults.IS_EDIT_MODE ) {\n\t\t\treturn new EShapeGroupSizeShadowed(\n\t\t\t\tthis,\n\t\t\t\tEShapeDefaults.SIZE_X,\n\t\t\t\tEShapeDefaults.SIZE_Y\n\t\t\t);\n\t\t} else {\n\t\t\treturn super.newGroupSize();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeGroupShadowed } from \"./e-shape-group-shadowed\";\n\nexport class EShapeGroupShadoweds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeGroupShadowed> | EShapeGroupShadowed {\n\t\tconst shape = EShapeGroupShadoweds.create();\n\t\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\t\tshape.size.init();\n\t\treturn result;\n\t}\n\n\tstatic create(): EShapeGroupShadowed {\n\t\treturn new EShapeGroupShadowed();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeGroupShadoweds } from \"../shape/variant/e-shape-group-shadoweds\";\nimport { EShapeGroupUploadeds } from \"../shape/variant/e-shape-group-uploadeds\";\n\nexport const loadShapeGroupShadowed = () => {\n\tEShapeUploadeds[ EShapeType.GROUP_SHADOWED ] = EShapeGroupUploadeds.create;\n\tEShapeDeserializers[ EShapeType.GROUP_SHADOWED ] = EShapeGroupShadoweds.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeStrokeSide } from \"../e-shape-stroke\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeRectangle extends EShapePrimitive {\n\tconstructor( type = EShapeType.RECTANGLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeRectangle {\n\t\treturn new EShapeRectangle().copy( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tif( fill.enable ) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tconst strokeSide = stroke.side;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth && strokeSide !== EShapeStrokeSide.NONE ) {\n\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\tif( ! this.containsAbsBBox( x, y, wx, wy ) ) {\n\t\t\t\t\t\tif( strokeSide === EShapeStrokeSide.ALL ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( x <= -wx ) {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP_OR_LEFT ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM_OR_LEFT ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.LEFT ) !== 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if( +wx <= x ) {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP_OR_RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM_OR_RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\n\nexport class EShapeImage extends EShapeRectangle {\n\tconstructor( image?: HTMLImageElement, type = EShapeType.IMAGE ) {\n\t\tsuper( type );\n\t\tif( image != null ) {\n\t\t\tthis.image = image;\n\t\t\tthis.size.set( image.width, image.height );\n\t\t}\n\t\tthis.fill.alpha = 1.0;\n\t}\n\n\tclone(): EShapeImage {\n\t\treturn new EShapeImage( this.image ).copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeImageElements } from \"../e-shape-image-elements\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeImage } from \"./e-shape-image\";\n\nexport class EShapeImages {\n\tstatic from( dataUrl: string ): Promise<EShapeImage> {\n\t\treturn EShapeImageElements.toImageElement( dataUrl ).then(( imageElement: HTMLImageElement ) => {\n\t\t\treturn new EShapeImage( imageElement );\n\t\t});\n\t}\n\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeImage> | EShapeImage {\n\t\treturn EShapeDeserializer.deserialize( item, manager, EShapeImages.create() );\n\t}\n\n\tstatic create(): EShapeImage {\n\t\treturn new EShapeImage();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeRectangleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\n\t\t// Clippings\n\t\tbuffer.clippingBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tlet ic = voffset * 3;\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\n\t\tclippings[ ic + 3 ] = 0;\n\t\tclippings[ ic + 4 ] = 1;\n\t\tclippings[ ic + 5 ] = 0;\n\n\t\tclippings[ ic + 6 ] = 1;\n\t\tclippings[ ic + 7 ] = 1;\n\t\tclippings[ ic + 8 ] = 0;\n\t\tic += 9;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic +  0 ] = 1;\n\t\tclippings[ ic +  1 ] = 0;\n\t\tclippings[ ic +  2 ] = 0;\n\n\t\tclippings[ ic +  3 ] = 0;\n\t\tclippings[ ic +  4 ] = 0;\n\t\tclippings[ ic +  5 ] = 0;\n\n\t\tclippings[ ic +  6 ] = 0;\n\t\tclippings[ ic +  7 ] = 0;\n\t\tclippings[ ic +  8 ] = 0;\n\n\t\tclippings[ ic +  9 ] = 1;\n\t\tclippings[ ic + 10 ] = 0;\n\t\tclippings[ ic + 11 ] = 0;\n\t\tic += 12;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\n\t\tclippings[ ic + 3 ] = 0;\n\t\tclippings[ ic + 4 ] = 1;\n\t\tclippings[ ic + 5 ] = 0;\n\n\t\tclippings[ ic + 6 ] = 1;\n\t\tclippings[ ic + 7 ] = 1;\n\t\tclippings[ ic + 8 ] = 0;\n\n\t\t// Indices\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\t\tconst ii = ioffset * 3;\n\t\tindices[ ii +  0 ] = voffset + 0;\n\t\tindices[ ii +  1 ] = voffset + 1;\n\t\tindices[ ii +  2 ] = voffset + 3;\n\n\t\tindices[ ii +  3 ] = voffset + 1;\n\t\tindices[ ii +  4 ] = voffset + 2;\n\t\tindices[ ii +  5 ] = voffset + 3;\n\n\t\tindices[ ii +  6 ] = voffset + 0;\n\t\tindices[ ii +  7 ] = voffset + 5;\n\t\tindices[ ii +  8 ] = voffset + 4;\n\n\t\tindices[ ii +  9 ] = voffset + 6;\n\t\tindices[ ii + 10 ] = voffset + 2;\n\t\tindices[ ii + 11 ] = voffset + 7;\n\n\t\tindices[ ii + 12 ] = voffset + 4;\n\t\tindices[ ii + 13 ] = voffset + 5;\n\t\tindices[ ii + 14 ] = voffset + 9;\n\n\t\tindices[ ii + 15 ] = voffset + 9;\n\t\tindices[ ii + 16 ] = voffset + 8;\n\t\tindices[ ii + 17 ] = voffset + 10;\n\n\t\tindices[ ii + 18 ] = voffset + 8;\n\t\tindices[ ii + 19 ] = voffset + 11;\n\t\tindices[ ii + 20 ] = voffset + 10;\n\n\t\tindices[ ii + 21 ] = voffset + 6;\n\t\tindices[ ii + 22 ] = voffset + 7;\n\t\tindices[ ii + 23 ] = voffset + 11;\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateType0Vertex( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateType0Step( buffer, shape );\n\t\tthis.updateType0Uv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateType0Vertex( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\n\t\t\t// Invalidate the stroke width to update the steps / antialiases.\n\t\t\tthis.strokeWidth = NaN;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\n\t\t\tbuffer.vertexBuffer.update();\n\n\t\t\t// Calculate the transformed positions\n\t\t\t//\n\t\t\t//  0       1       2\n\t\t\t// |-------|-------|\n\t\t\t// |4      |3,5,6  |7\n\t\t\t// |-------|-------|\n\t\t\t// |       |8      |\n\t\t\t// |-------|-------|\n\t\t\t//  9       10      11\n\t\t\t//\n\t\t\tconst s = strokeAlign * strokeWidth;\n\t\t\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\t\t\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst work = this.buffer.work;\n\t\t\twork.set( -sx, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x0 = work.x;\n\t\t\tconst y0 = work.y;\n\t\t\twork.set( 0, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x1 = work.x;\n\t\t\tconst y1 = work.y;\n\t\t\tconst dx = x1 - x0;\n\t\t\tconst dy = y1 - y0;\n\t\t\tconst x3 = internalTransform.tx;\n\t\t\tconst y3 = internalTransform.ty;\n\t\t\tconst x10 = x3 + (x3 - x1);\n\t\t\tconst y10 = y3 + (y3 - y1);\n\t\t\tconst x4 = x3 - dx;\n\t\t\tconst y4 = y3 - dy;\n\n\t\t\t// World size\n\t\t\tthis.worldSizeXHalf = this.calcLength( x0, y0, x1, y1 );\n\t\t\tthis.worldSizeYHalf = this.calcLength( x0, y0, x4, y4 );\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tlet iv = voffset * 2;\n\t\t\tvertices[ iv + 0 ] = x0;\n\t\t\tvertices[ iv + 1 ] = y0;\n\t\t\tvertices[ iv + 2 ] = x1;\n\t\t\tvertices[ iv + 3 ] = y1;\n\t\t\tvertices[ iv + 4 ] = x1 + dx;\n\t\t\tvertices[ iv + 5 ] = y1 + dy;\n\t\t\tiv += 6;\n\n\t\t\tvertices[ iv + 0 ] = x3;\n\t\t\tvertices[ iv + 1 ] = y3;\n\t\t\tiv += 2;\n\n\t\t\tvertices[ iv + 0 ] = x4;\n\t\t\tvertices[ iv + 1 ] = y4;\n\t\t\tvertices[ iv + 2 ] = x3;\n\t\t\tvertices[ iv + 3 ] = y3;\n\t\t\tvertices[ iv + 4 ] = x3;\n\t\t\tvertices[ iv + 5 ] = y3;\n\t\t\tvertices[ iv + 6 ] = x3 + dx;\n\t\t\tvertices[ iv + 7 ] = y3 + dy;\n\t\t\tiv += 8;\n\n\t\t\tvertices[ iv + 0 ] = x3;\n\t\t\tvertices[ iv + 1 ] = y3;\n\t\t\tiv += 2;\n\n\t\t\tvertices[ iv + 0 ] = x10 - dx;\n\t\t\tvertices[ iv + 1 ] = y10 - dy;\n\t\t\tvertices[ iv + 2 ] = x10;\n\t\t\tvertices[ iv + 3 ] = y10;\n\t\t\tvertices[ iv + 4 ] = x10 + dx;\n\t\t\tvertices[ iv + 5 ] = y10 + dy;\n\t\t}\n\t}\n\n\tprotected updateType0Step( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tif( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide ) {\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\n\t\t\tconst work = buffer.workStep;\n\t\t\tthis.calcStep( this.worldSizeXHalf, strokeWidth, work );\n\t\t\tconst swx = work[ 0 ];\n\t\t\tconst px0 = work[ 1 ];\n\t\t\tconst px1 = work[ 2 ];\n\n\t\t\tthis.calcStep( this.worldSizeYHalf, strokeWidth, work );\n\t\t\tconst swy = work[ 0 ];\n\t\t\tconst py0 = work[ 1 ];\n\t\t\tconst py1 = work[ 2 ];\n\n\t\t\tlet swt = swy;\n\t\t\tlet pt0 = py0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.TOP) ) {\n\t\t\t\tswt = 1;\n\t\t\t\tpt0 = py1;\n\t\t\t}\n\t\t\tlet swr = swx;\n\t\t\tlet pr0 = px0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.RIGHT) ) {\n\t\t\t\tswr = 1;\n\t\t\t\tpr0 = px1;\n\t\t\t}\n\t\t\tlet swb = swy;\n\t\t\tlet pb0 = py0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.BOTTOM) ) {\n\t\t\t\tswb = 1;\n\t\t\t\tpb0 = py1;\n\t\t\t}\n\t\t\tlet swl = swx;\n\t\t\tlet pl0 = px0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.LEFT) ) {\n\t\t\t\tswl = 1;\n\t\t\t\tpl0 = px1;\n\t\t\t}\n\t\t\tconst pc0 = 0.5 * (pl0 + pr0);\n\t\t\tconst pm0 = 0.5 * (pt0 + pb0);\n\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tlet is = voffset * 2;\n\t\t\tlet ia = voffset * 4;\n\n\t\t\t// 0\n\t\t\tsteps[ is + 0 ] = swl;\n\t\t\tsteps[ is + 1 ] = swt;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 1\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = swt;\n\t\t\tantialiases[ ia + 0 ] = pc0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 2\n\t\t\tsteps[ is + 0 ] = swr;\n\t\t\tsteps[ is + 1 ] = swt;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 3\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pc0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 4\n\t\t\tsteps[ is + 0 ] = swl;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pm0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 5\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pm0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 6\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pm0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 7\n\t\t\tsteps[ is + 0 ] = swr;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pm0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 8\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pc0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 9\n\t\t\tsteps[ is + 0 ] = swl;\n\t\t\tsteps[ is + 1 ] = swb;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 10\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = swb;\n\t\t\tantialiases[ ia + 0 ] = pc0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// 11\n\t\t\tsteps[ is + 0 ] = swr;\n\t\t\tsteps[ is + 1 ] = swb;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\t\t}\n\t}\n\n\tprotected updateType0Uv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst textureUvs = this.toTextureUvs( texture ) as any;\n\t\t\tconst x0 = textureUvs.x0;\n\t\t\tconst x1 = textureUvs.x1;\n\t\t\tconst x2 = textureUvs.x2;\n\t\t\tconst x3 = textureUvs.x3;\n\t\t\tconst y0 = textureUvs.y0;\n\t\t\tconst y1 = textureUvs.y1;\n\t\t\tconst y2 = textureUvs.y2;\n\t\t\tconst y3 = textureUvs.y3;\n\n\t\t\tconst x02 = 0.5 * ( x0 + x2 );\n\t\t\tconst y02 = 0.5 * ( y0 + y2 );\n\n\t\t\t// UVs\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tlet iuv = voffset * 2;\n\t\t\tuvs[ iuv + 0 ] = x0;\n\t\t\tuvs[ iuv + 1 ] = y0;\n\t\t\tuvs[ iuv + 2 ] = 0.5 * ( x0 + x1 );\n\t\t\tuvs[ iuv + 3 ] = 0.5 * ( y0 + y1 );\n\t\t\tuvs[ iuv + 4 ] = x1;\n\t\t\tuvs[ iuv + 5 ] = y1;\n\t\t\tiuv += 6;\n\n\t\t\tuvs[ iuv + 0 ] = x02;\n\t\t\tuvs[ iuv + 1 ] = y02;\n\t\t\tiuv += 2;\n\n\t\t\tuvs[ iuv + 0 ] = 0.5 * ( x0 + x3 );\n\t\t\tuvs[ iuv + 1 ] = 0.5 * ( y0 + y3 );\n\t\t\tuvs[ iuv + 2 ] = x02;\n\t\t\tuvs[ iuv + 3 ] = y02;\n\t\t\tuvs[ iuv + 4 ] = x02;\n\t\t\tuvs[ iuv + 5 ] = y02;\n\t\t\tuvs[ iuv + 6 ] = 0.5 * ( x1 + x2 );\n\t\t\tuvs[ iuv + 7 ] = 0.5 * ( y1 + y2 );\n\t\t\tiuv += 8;\n\n\t\t\tuvs[ iuv + 0 ] = x02;\n\t\t\tuvs[ iuv + 1 ] = y02;\n\t\t\tiuv += 2;\n\n\t\t\tuvs[ iuv + 0 ] = x3;\n\t\t\tuvs[ iuv + 1 ] = y3;\n\t\t\tuvs[ iuv + 2 ] = 0.5 * ( x3 + x2 );\n\t\t\tuvs[ iuv + 3 ] = 0.5 * ( y3 + y2 );\n\t\t\tuvs[ iuv + 4 ] = x2;\n\t\t\tuvs[ iuv + 5 ] = y2;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeRectangleUploaded } from \"./e-shape-rectangle-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeRectangleUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number\n\t): EShapeRectangleUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = 12 + tvcount;\n\t\tconst icount = 8 + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeRectangleUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeImages } from \"../shape/variant/e-shape-images\";\nimport { EShapeRectangleUploadeds } from \"../shape/variant/e-shape-rectangle-uploadeds\";\n\nexport const loadShapeImage = () => {\n\tEShapeUploadeds[ EShapeType.IMAGE ] = EShapeRectangleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.IMAGE ] = EShapeImages.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeLabelUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.initText();\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateLabelVertex( buffer, shape );\n\t\tthis.updateLabelUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tupdateLabelVertex( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tif( isSizeChanged || isTransformChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t}\n\t}\n\n\tupdateLabelUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tthis.texture = this.toTexture( shape );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeLabelUploaded } from \"./e-shape-label-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeLabelUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n\t): EShapeLabelUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = tvcount;\n\t\tconst icount = ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeLabelUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeLabel extends EShapePrimitive {\n\tconstructor( type: EShapeType = EShapeType.LABEL ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeLabel {\n\t\treturn new EShapeLabel().copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLabel } from \"./e-shape-label\";\n\nexport class EShapeLabels {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLabel> | EShapeLabel {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLabel() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLabelUploadeds } from \"../shape/variant/e-shape-label-uploadeds\";\nimport { EShapeLabels } from \"../shape/variant/e-shape-labels\";\n\nexport const loadShapeLabel = () => {\n\tEShapeUploadeds[ EShapeType.LABEL ] = EShapeLabelUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LABEL ] = EShapeLabels.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { utilIndexOf } from \"../../util/util-index-of\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePoints, EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapePointsStyleUploadeds } from \"../e-shape-points-style-uploadeds\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nconst FMIN: number = 0.00001;\n\nexport class EShapeLineUploaded extends EShapeTextUploaded {\n\tprotected pointCount: number;\n\tprotected pointId: number;\n\tprotected pointsClosed: boolean;\n\tprotected pointsStyle: EShapePointsStyle;\n\tprotected length: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tpointCount: number, pointsClosed: boolean\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount );\n\t\tthis.pointId = NaN;\n\t\tthis.pointCount = pointCount;\n\t\tthis.pointsClosed = pointsClosed;\n\t\tthis.pointsStyle = EShapePointsStyle.NONE;\n\t\tthis.length = 1;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCount = this.pointCount;\n\t\tconst pointsClosed = this.pointsClosed;\n\n\t\t// Clipping & indices\n\t\tif( 2 <= pointCount ) {\n\t\t\tbuffer.clippingBuffer.update();\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tbuffer.indexBuffer.update();\n\t\t\tconst indices = buffer.indices;\n\n\t\t\tlet ic = voffset * 3;\n\t\t\tlet ii = ioffset * 3;\n\t\t\tlet io = voffset;\n\n\t\t\t// First\n\t\t\tif( ! pointsClosed ) {\n\t\t\t\tclippings[ ic +  0 ] = 1;\n\t\t\t\tclippings[ ic +  1 ] = 0;\n\t\t\t\tclippings[ ic +  2 ] = 3;\n\n\t\t\t\tclippings[ ic +  3 ] = 0;\n\t\t\t\tclippings[ ic +  4 ] = 1;\n\t\t\t\tclippings[ ic +  5 ] = 5;\n\t\t\t\tic += 6;\n\n\t\t\t\tindices[ ii + 0 ] = io + 0;\n\t\t\t\tindices[ ii + 1 ] = io + 2;\n\t\t\t\tindices[ ii + 2 ] = io + 1;\n\n\t\t\t\tindices[ ii + 3 ] = io + 1;\n\t\t\t\tindices[ ii + 4 ] = io + 2;\n\t\t\t\tindices[ ii + 5 ] = io + 3;\n\t\t\t\tio += 2;\n\t\t\t\tii += 6;\n\t\t\t}\n\n\t\t\t// Middle\n\t\t\tfor( let i = (pointsClosed ? 0 : 1), imax = pointCount - i; i < imax; ++i ) {\n\t\t\t\tclippings[ ic +  0 ] = 1;\n\t\t\t\tclippings[ ic +  1 ] = 0;\n\t\t\t\tclippings[ ic +  2 ] = 3;\n\n\t\t\t\tclippings[ ic +  3 ] = 0;\n\t\t\t\tclippings[ ic +  4 ] = 1;\n\t\t\t\tclippings[ ic +  5 ] = 5;\n\n\t\t\t\tclippings[ ic +  6 ] = 1;\n\t\t\t\tclippings[ ic +  7 ] = 0;\n\t\t\t\tclippings[ ic +  8 ] = 4;\n\n\t\t\t\tclippings[ ic +  9 ] = 0;\n\t\t\t\tclippings[ ic + 10 ] = 1;\n\t\t\t\tclippings[ ic + 11 ] = 6;\n\t\t\t\tic += 12;\n\n\t\t\t\tindices[ ii +  0 ] = io + 0;\n\t\t\t\tindices[ ii +  1 ] = io + 2;\n\t\t\t\tindices[ ii +  2 ] = io + 1;\n\n\t\t\t\tindices[ ii +  3 ] = io + 1;\n\t\t\t\tindices[ ii +  4 ] = io + 2;\n\t\t\t\tindices[ ii +  5 ] = io + 3;\n\n\t\t\t\tindices[ ii +  6 ] = io + 2;\n\t\t\t\tindices[ ii +  7 ] = io + 4;\n\t\t\t\tindices[ ii +  8 ] = io + 3;\n\n\t\t\t\tindices[ ii +  9 ] = io + 3;\n\t\t\t\tindices[ ii + 10 ] = io + 4;\n\t\t\t\tindices[ ii + 11 ] = io + 5;\n\t\t\t\tio += 4;\n\t\t\t\tii += 12;\n\t\t\t}\n\n\t\t\t// Last\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\tclippings[ ic + 2 ] = 3;\n\n\t\t\tclippings[ ic + 3 ] = 0;\n\t\t\tclippings[ ic + 4 ] = 1;\n\t\t\tclippings[ ic + 5 ] = 5;\n\t\t}\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\t//\n\t\tthis.update( shape );\n\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points != null && 2 <= points.length ) {\n\t\t\tconst pointId = points.id;\n\t\t\tconst isPointChanged = ( pointId !== this.pointId );\n\t\t\tconst stroke = shape.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tconst isStrokeWidthChanged = ( strokeWidth !== this.strokeWidth );\n\t\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\t\tconst pointsStyle = points.style;\n\t\t\tconst isPointsStyleChanged = ( pointsStyle !== this.pointsStyle );\n\t\t\tif( isPointChanged || isTransformChanged || isStrokeWidthChanged || isPointsStyleChanged ) {\n\t\t\t\tthis.pointId = pointId;\n\t\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\t\tthis.pointsStyle = pointsStyle;\n\t\t\t\tbuffer.vertexBuffer.update();\n\t\t\t\tbuffer.stepBuffer.update();\n\t\t\t\tbuffer.antialiasBuffer.update();\n\t\t\t\tbuffer.colorFillBuffer.update();\n\n\t\t\t\tif( isPointChanged || isTransformChanged ) {\n\t\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t\t}\n\t\t\t\tif( isPointChanged ) {\n\t\t\t\t\t// Invalidate the texture transform ID to update the UVs\n\t\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t\t}\n\n\t\t\t\tconst voffset = this.vertexOffset;\n\t\t\t\tconst vcount = this.vertexCount - this.textVertexCount;\n\t\t\t\tthis.updateLineVertexStepAndColorFill(\n\t\t\t\t\tbuffer,\n\t\t\t\t\tpoints, strokeWidth, shape.transform.internalTransform,\n\t\t\t\t\tvoffset, vcount\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateLineUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst points = shape.points;\n\t\t\tif( points ) {\n\t\t\t\treturn (\n\t\t\t\t\tthis.pointCount === points.length &&\n\t\t\t\t\tthis.pointsClosed === (!!( points.style & EShapePointsStyle.CLOSED ))\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\treturn (\n\t\t\t\t\tthis.pointCount === 0 &&\n\t\t\t\t\tthis.pointsClosed === false\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateLineVertexStepAndColorFill(\n\t\tbuffer: EShapeBuffer,\n\t\tpoints: EShapePoints,\n\t\tstrokeWidth: number,\n\t\tinternalTransform: Matrix,\n\t\tvoffset: number,\n\t\tvcount: number\n\t): void {\n\t\tlet iv = voffset * 2;\n\t\tlet ia = voffset * 4;\n\t\tconst vertices = buffer.vertices;\n\t\tconst steps = buffer.steps;\n\t\tconst antialiases = buffer.antialiases;\n\t\tconst colorFills = buffer.colorFills;\n\t\tconst pointCount = points.length;\n\t\tconst pointValues = points.values;\n\t\tconst pointSegments = points.segments;\n\t\tconst pointsStyle = points.style;\n\t\tconst closed = ( (pointsStyle & EShapePointsStyle.CLOSED) !== 0 );\n\t\tconst scaleInvariant = EShapePointsStyleUploadeds.toScaleInvariant( pointsStyle );\n\n\t\t//\n\t\tlet l = 0;\n\t\tlet lprev = 0;\n\t\tlet lnext = 0;\n\t\tlet llop = 0;\n\t\tlet llo = 0;\n\t\tlet lmax = 0;\n\t\tlet pprevx = 0;\n\t\tlet pprevy = 0;\n\t\tlet px = 0;\n\t\tlet py = 0;\n\t\tlet pnextx = 0;\n\t\tlet pnexty = 0;\n\t\tlet pseg = false;\n\t\tlet psegnext = false;\n\t\tlet icfprev = voffset * 4;\n\t\tlet loffset = 0;\n\n\t\t// First point\n\t\tconst work = buffer.work;\n\t\twork.set( pointValues[ 0 ], pointValues[ 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tconst pfirstx = work.x;\n\t\tconst pfirsty = work.y;\n\t\tconst psegfirst = ( 0 <= utilIndexOf( pointSegments, 0 ) );\n\n\t\t// Last point\n\t\tconst lastIndex = (pointCount - 1) << 1;\n\t\twork.set( pointValues[ lastIndex + 0 ], pointValues[ lastIndex + 1 ] );\n\t\tinternalTransform.apply( work, work );\n\t\tconst plastx = work.x;\n\t\tconst plasty = work.y;\n\t\tconst pseglast = ( 0 <= utilIndexOf( pointSegments, pointCount - 1 ) );\n\n\t\t// Second point\n\t\tlet psecondx = plastx;\n\t\tlet psecondy = plasty;\n\t\tlet psegsecond = pseglast;\n\t\tif( 2 < pointCount ) {\n\t\t\twork.set( pointValues[ 2 ], pointValues[ 3 ] );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tpsecondx = work.x;\n\t\t\tpsecondy = work.y;\n\t\t\tpsegsecond = ( 0 <= utilIndexOf( pointSegments, 1 ) );\n\t\t}\n\n\t\t// First segment\n\t\tif( closed ) {\n\t\t\tpx = plastx;\n\t\t\tpy = plasty;\n\t\t\tpnextx = pfirstx;\n\t\t\tpnexty = pfirsty;\n\t\t\tpseg = pseglast;\n\t\t\tpsegnext = psegfirst;\n\t\t} else {\n\t\t\tpprevx = pfirstx - (psecondx - pfirstx);\n\t\t\tpprevy = pfirsty - (psecondy - pfirsty);\n\t\t\tpx = pfirstx;\n\t\t\tpy = pfirsty;\n\t\t\tpnextx = psecondx;\n\t\t\tpnexty = psecondy;\n\t\t\tpseg = psegfirst;\n\t\t\tpsegnext = psegsecond;\n\t\t\tlnext += this.calcLength( px, py, pnextx, pnexty );\n\n\t\t\t//\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextx;\n\t\t\tantialiases[ ia + 3 ] = pnexty;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextx;\n\t\t\tantialiases[ ia + 7 ] = pnexty;\n\t\t\tcolorFills[ ia + 0 ] = llo;\n\t\t\tcolorFills[ ia + 4 ] = llo;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\t\t}\n\n\t\t// Middle segments\n\t\tfor( let i = ( closed ? 0 : 1 ), imax = pointCount - i; i < imax; ++i ) {\n\t\t\tpprevx = px;\n\t\t\tpprevy = py;\n\t\t\tpx = pnextx;\n\t\t\tpy = pnexty;\n\t\t\tpseg = psegnext;\n\t\t\tif( i === pointCount - 2 ) {\n\t\t\t\tpnextx = plastx;\n\t\t\t\tpnexty = plasty;\n\t\t\t\tpsegnext = pseglast;\n\t\t\t} else if( i === 0 ) {\n\t\t\t\tpnextx = psecondx;\n\t\t\t\tpnexty = psecondy;\n\t\t\t\tpsegnext = psegsecond;\n\t\t\t} else if( i < pointCount - 1 ) {\n\t\t\t\tconst nextIndex = (i + 1) << 1;\n\t\t\t\twork.set( pointValues[ nextIndex + 0 ], pointValues[ nextIndex + 1 ] );\n\t\t\t\tinternalTransform.apply( work, work );\n\t\t\t\tpnextx = work.x;\n\t\t\t\tpnexty = work.y;\n\t\t\t\tpsegnext = ( 0 <= utilIndexOf( pointSegments, i + 1 ) );\n\t\t\t} else {\n\t\t\t\tpnextx = pfirstx;\n\t\t\t\tpnexty = pfirsty;\n\t\t\t\tpsegnext = psegfirst;\n\t\t\t}\n\t\t\tlprev = l;\n\t\t\tl = lnext;\n\t\t\tlnext += this.calcLength( px, py, pnextx, pnexty );\n\n\t\t\tlet pnextxn = pnextx;\n\t\t\tlet pnextyn = pnexty;\n\t\t\tlet loffsetprev = loffset;\n\t\t\tif( pseg ) {\n\t\t\t\tpprevx = px - (pnextx - px);\n\t\t\t\tpprevy = py - (pnexty - py);\n\n\t\t\t\tlmax = Math.max( lmax, llo );\n\n\t\t\t\tllop = lprev - loffset;\n\t\t\t\tEShapePointsStyleUploadeds.toDash( llop, strokeWidth, pointsStyle, work );\n\t\t\t\tconst dash0 = work.x;\n\t\t\t\tconst dash1 = work.y;\n\t\t\t\tfor( let j = icfprev; j < ia + 8; j += 4 ) {\n\t\t\t\t\tcolorFills[ j + 1 ] = dash0;\n\t\t\t\t\tcolorFills[ j + 2 ] = dash1;\n\t\t\t\t\tcolorFills[ j + 3 ] = llop;\n\t\t\t\t}\n\t\t\t\ticfprev = ia + 8;\n\t\t\t\tloffsetprev = loffset;\n\t\t\t\tloffset = l;\n\t\t\t} else if( psegnext ) {\n\t\t\t\tpnextxn = px + (px - pprevx);\n\t\t\t\tpnextyn = py + (py - pprevy);\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextxn;\n\t\t\tantialiases[ ia + 3 ] = pnextyn;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextxn;\n\t\t\tantialiases[ ia + 7 ] = pnextyn;\n\t\t\tllop = l - loffsetprev;\n\t\t\tcolorFills[ ia + 0 ] = llop;\n\t\t\tcolorFills[ ia + 4 ] = llop;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextxn;\n\t\t\tantialiases[ ia + 3 ] = pnextyn;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextxn;\n\t\t\tantialiases[ ia + 7 ] = pnextyn;\n\t\t\tllo = l - loffset;\n\t\t\tcolorFills[ ia + 0 ] = llo;\n\t\t\tcolorFills[ ia + 4 ] = llo;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\t\t}\n\n\t\t// Last segment\n\t\t{\n\t\t\tpprevx = px;\n\t\t\tpprevy = py;\n\t\t\tpx = pnextx;\n\t\t\tpy = pnexty;\n\t\t\tpseg = psegnext;\n\t\t\tif( closed ) {\n\t\t\t\tpnextx = psecondx;\n\t\t\t\tpnexty = psecondy;\n\t\t\t\tpsegnext = psegsecond;\n\t\t\t} else {\n\t\t\t\tpnextx = px + (px - pprevx);\n\t\t\t\tpnexty = py + (py - pprevy);\n\t\t\t\tpsegnext = false;\n\t\t\t}\n\t\t\tlprev = l;\n\t\t\tl = lnext;\n\n\t\t\tlet pnextxn = pnextx;\n\t\t\tlet pnextyn = pnexty;\n\t\t\tlet loffsetprev = loffset;\n\t\t\tif( pseg ) {\n\t\t\t\tpprevx = px - (pnextx - px);\n\t\t\t\tpprevy = py - (pnexty - py);\n\n\t\t\t\tlmax = Math.max( lmax, llo );\n\n\t\t\t\tllop = lprev - loffset;\n\t\t\t\tEShapePointsStyleUploadeds.toDash( llop, strokeWidth, pointsStyle, work );\n\t\t\t\tconst dash0 = work.x;\n\t\t\t\tconst dash1 = work.y;\n\t\t\t\tfor( let j = icfprev; j < ia + 8; j += 4 ) {\n\t\t\t\t\tcolorFills[ j + 1 ] = dash0;\n\t\t\t\t\tcolorFills[ j + 2 ] = dash1;\n\t\t\t\t\tcolorFills[ j + 3 ] = llop;\n\t\t\t\t}\n\t\t\t\ticfprev = ia + 8;\n\t\t\t\tloffsetprev = loffset;\n\t\t\t\tloffset = l;\n\t\t\t} else if( psegnext ) {\n\t\t\t\tpnextxn = px + (px - pprevx);\n\t\t\t\tpnextyn = py + (py - pprevy);\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ iv + 0 ] = strokeWidth;\n\t\t\tsteps[ iv + 1 ] = scaleInvariant;\n\t\t\tsteps[ iv + 2 ] = strokeWidth;\n\t\t\tsteps[ iv + 3 ] = scaleInvariant;\n\t\t\tantialiases[ ia + 0 ] = pprevx;\n\t\t\tantialiases[ ia + 1 ] = pprevy;\n\t\t\tantialiases[ ia + 2 ] = pnextxn;\n\t\t\tantialiases[ ia + 3 ] = pnextyn;\n\t\t\tantialiases[ ia + 4 ] = pprevx;\n\t\t\tantialiases[ ia + 5 ] = pprevy;\n\t\t\tantialiases[ ia + 6 ] = pnextxn;\n\t\t\tantialiases[ ia + 7 ] = pnextyn;\n\t\t\tllop = l - loffsetprev;\n\t\t\tlmax = Math.max( lmax, llop );\n\t\t\tcolorFills[ ia + 0 ] = llop;\n\t\t\tcolorFills[ ia + 4 ] = llop;\n\t\t\tiv += 4;\n\t\t\tia += 8;\n\n\t\t\t// Total length\n\t\t\tthis.length = lmax;\n\t\t\tif( icfprev < ia ) {\n\t\t\t\tEShapePointsStyleUploadeds.toDash( llop, strokeWidth, pointsStyle, work );\n\t\t\t\tconst dash0 = work.x;\n\t\t\t\tconst dash1 = work.y;\n\t\t\t\tif( closed ) {\n\t\t\t\t\tfor( let i = icfprev; i < ia; i += 4 ) {\n\t\t\t\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\t\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\t\t\t\tcolorFills[ i + 3 ] = -1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = icfprev; i < ia; i += 4 ) {\n\t\t\t\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\t\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\t\t\t\tcolorFills[ i + 3 ] = llop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateLineUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tif( 2 <= pointCount ) {\n\t\t\t\tconst textureUvs = this.toTextureUvs( texture ) as any;\n\t\t\t\tconst x0 = textureUvs.x0;\n\t\t\t\tconst x1 = textureUvs.x1;\n\t\t\t\tconst x2 = textureUvs.x2;\n\t\t\t\tconst x3 = textureUvs.x3;\n\t\t\t\tconst y0 = textureUvs.y0;\n\t\t\t\tconst y1 = textureUvs.y1;\n\t\t\t\tconst y2 = textureUvs.y2;\n\t\t\t\tconst y3 = textureUvs.y3;\n\n\t\t\t\tconst dx01 = x1 - x0;\n\t\t\t\tconst dy01 = y1 - y0;\n\t\t\t\tconst dx32 = x2 - x3;\n\t\t\t\tconst dy32 = y2 - y3;\n\n\t\t\t\t// Uvs\n\t\t\t\tbuffer.uvBuffer.update();\n\t\t\t\tconst uvs = buffer.uvs;\n\t\t\t\tconst colorFills = buffer.colorFills;\n\t\t\t\tconst closed = this.pointsClosed;\n\t\t\t\tconst voffset = this.vertexOffset;\n\n\t\t\t\tlet iuv = voffset * 2;\n\t\t\t\tlet icf = voffset * 4;\n\t\t\t\tconst lengthInverse = 1 / Math.max( FMIN, this.length );\n\t\t\t\tlet r = 0;\n\n\t\t\t\t// UV: First\n\t\t\t\tif( ! closed ) {\n\t\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t\t\tiuv += 4;\n\t\t\t\t\ticf += 8;\n\t\t\t\t}\n\n\t\t\t\t// UV: Middle\n\t\t\t\tfor( let i = (closed ? 0 : 1), imax = pointCount - i; i < imax; ++i ) {\n\t\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t\t\tiuv += 4;\n\t\t\t\t\ticf += 8;\n\n\t\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t\t\tiuv += 4;\n\t\t\t\t\ticf += 8;\n\t\t\t\t}\n\n\t\t\t\t// UV: Last\n\t\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapeLineUploaded } from \"./e-shape-line-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeLineUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n\t): EShapeLineUploaded | null {\n\t\tconst points = shape.points;\n\t\tconst pointsClosed = ( points ? (points.style & EShapePointsStyle.CLOSED) !== 0 : false );\n\t\tconst pointCount = ( points ? points.length : 0 );\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tlet vcount = tvcount;\n\t\tlet icount = ticount;\n\t\tif( 2 <= pointCount ) {\n\t\t\tif( pointsClosed ) {\n\t\t\t\tvcount += pointCount * 4 + 2;\n\t\t\t\ticount += pointCount * 4;\n\t\t\t} else {\n\t\t\t\tvcount += (pointCount - 2) * 4 + 2 + 2;\n\t\t\t\ticount += (pointCount - 2) * 4 + 2;\n\t\t\t}\n\t\t}\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeLineUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount, pointCount, pointsClosed\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShapePoints, EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapePointsParent } from \"../e-shape-points-parent\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\n\nexport class EShapeLinePoints implements EShapePoints {\n\tprotected _parent: EShapePointsParent;\n\tprotected _valuesBase?: number[];\n\tprotected _valuesBaseLength: number;\n\tprotected _values: number[];\n\tprotected _segments: number[];\n\treadonly position: Point;\n\tprotected _sizeBase: Point;\n\treadonly size: Point;\n\tprotected _id: number;\n\tprotected _style: EShapePointsStyle;\n\n\tconstructor(\n\t\tparent: EShapePointsParent,\n\t\tpoints: number[],\n\t\tsegments: number[],\n\t\tstyle: EShapePointsStyle\n\t) {\n\t\t// Calculate the center\n\t\tconst values: number[] = [];\n\t\tlet minX = 0;\n\t\tlet maxX = 0;\n\t\tlet minY = 0;\n\t\tlet maxY = 0;\n\t\tconst pointsLength = points.length;\n\t\tif( 2 <= pointsLength ) {\n\t\t\tminX = maxX = points[ 0 ];\n\t\t\tminY = maxY = points[ 1 ];\n\t\t\tfor( let i = 2; i < pointsLength; i += 2 ) {\n\t\t\t\tconst x = points[ i ];\n\t\t\t\tconst y = points[ i + 1 ];\n\t\t\t\tminX = Math.min( minX, x );\n\t\t\t\tmaxX = Math.max( maxX, x );\n\t\t\t\tminY = Math.min( minY, y );\n\t\t\t\tmaxY = Math.max( maxY, y );\n\t\t\t}\n\t\t}\n\t\tconst cx = (maxX + minX) * 0.5;\n\t\tconst cy = (maxY + minY) * 0.5;\n\t\tfor( let i = 0; i < pointsLength; i += 2 ) {\n\t\t\tconst x = points[ i + 0 ] - cx;\n\t\t\tconst y = points[ i + 1 ] - cy;\n\t\t\tvalues.push( x, y );\n\t\t}\n\t\tconst sx = maxX - minX;\n\t\tconst sy = maxY - minY;\n\n\t\t//\n\t\tthis._parent = parent;\n\t\tthis._valuesBase = undefined;\n\t\tthis._valuesBaseLength = values.length;\n\t\tthis._values = values;\n\t\tthis._segments = segments.slice( 0 );\n\t\tthis._sizeBase = new Point( sx, sy );\n\t\tthis.size = new Point( sx, sy );\n\t\tthis.position = new Point( cx, cy );\n\t\tthis._id = 0;\n\t\tthis._style = style!;\n\t}\n\n\tget length(): number {\n\t\treturn this._values.length >> 1;\n\t}\n\n\tprivate fitToParentSize() {\n\t\tconst size = this.size;\n\t\tconst parentSize = this._parent.size;\n\t\tconst ssx = parentSize.x;\n\t\tconst ssy = parentSize.y;\n\t\tconst threshold = 0.00001;\n\t\tif( threshold < Math.abs( ssx - size.x ) || threshold < Math.abs( ssy - size.y ) ) {\n\t\t\tsize.set( ssx, ssy );\n\n\t\t\tconst sizeBase = this._sizeBase;\n\t\t\tconst hasSizeBaseX = threshold < Math.abs( sizeBase.x );\n\t\t\tconst hasSizeBaseY = threshold < Math.abs( sizeBase.y );\n\t\t\tif( hasSizeBaseX || hasSizeBaseY ) {\n\t\t\t\tconst scaleX = ( hasSizeBaseX ? ssx / sizeBase.x : 1 );\n\t\t\t\tconst scaleY = ( hasSizeBaseY ? ssy / sizeBase.y : 1 );\n\n\t\t\t\tconst values = this._values;\n\t\t\t\tlet valuesBase = this._valuesBase;\n\t\t\t\tif( valuesBase == null ) {\n\t\t\t\t\tvaluesBase = [];\n\t\t\t\t\tthis._valuesBase = valuesBase;\n\n\t\t\t\t\tfor( let i = 0, imax = this.length << 1; i < imax; i += 2 ) {\n\t\t\t\t\t\tconst x = values[ i ];\n\t\t\t\t\t\tconst y = values[ i + 1 ];\n\t\t\t\t\t\tvalues[ i ] = x * scaleX;\n\t\t\t\t\t\tvalues[ i + 1 ] = y * scaleY;\n\t\t\t\t\t\tvaluesBase.push( x, y );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = this.length << 1; i < imax; i += 2 ) {\n\t\t\t\t\t\tvalues[ i ] = valuesBase[ i ] * scaleX;\n\t\t\t\t\t\tvalues[ i + 1 ] = valuesBase[ i + 1 ] * scaleY;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._id += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tget id(): number {\n\t\tthis.fitToParentSize();\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\tthis.fitToParentSize();\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\tthis.set( values, undefined, undefined );\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\t/**\n\t * Must be sorted in ascending order.\n\t */\n\tset segments( segments: number[] ) {\n\t\tthis.set( undefined, segments, undefined );\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.set( undefined, undefined, style );\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\treturn this.set( source.values, source.segments, source.style );\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet isDirty = false;\n\t\tlet isUpdated = false;\n\n\t\t// Values\n\t\tif( newValues != null ) {\n\t\t\tconst values = this._values;\n\t\t\tconst valuesBaseLength = this._valuesBaseLength;\n\t\t\tconst newValuesLength = newValues.length;\n\t\t\tconst iupdate = Math.min( newValuesLength, valuesBaseLength );\n\t\t\tthis._valuesBase = undefined;\n\t\t\tthis._id += 1;\n\t\t\tif( values !== newValues ) {\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tvalues[ i ] = newValues[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newValuesLength; ++i ) {\n\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( valuesBaseLength !== newValuesLength ) {\n\t\t\t\t\tvalues.length = newValuesLength;\n\t\t\t\t\tthis._valuesBaseLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( valuesBaseLength !== newValuesLength ) {\n\t\t\t\t\tthis._valuesBaseLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Segments\n\t\tif( newSegments != null ) {\n\t\t\tconst segments = this._segments;\n\t\t\tthis._id += 1;\n\t\t\tif( segments !== newSegments ) {\n\t\t\t\tconst newSegmentsLength = newSegments.length;\n\t\t\t\tconst iupdate = Math.min( segments.length, newSegmentsLength );\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tsegments[ i ] = newSegments[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newSegmentsLength; ++i ) {\n\t\t\t\t\tsegments.push( newSegments[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( segments.length !== newSegmentsLength ) {\n\t\t\t\t\tsegments.length = newSegmentsLength;\n\t\t\t\t}\n\t\t\t}\n\t\t\tisUpdated = true;\n\t\t}\n\n\t\t// Style\n\t\tif( newStyle != null ) {\n\t\t\tconst oldStyle = this._style;\n\t\t\tif( oldStyle !== newStyle ) {\n\t\t\t\tthis._style = newStyle;\n\t\t\t\tif( (oldStyle & EShapePointsStyle.CLOSED) !== (newStyle & EShapePointsStyle.CLOSED) ) {\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( isDirty ) {\n\t\t\tconst parent = this._parent;\n\t\t\tparent.uploaded = undefined;\n\t\t\tparent.toDirty();\n\t\t} else if( isUpdated ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclone( parent: EShapePointsParent ): EShapeLinePoints {\n\t\treturn new EShapeLinePoints( parent, this._values, this._segments, this._style );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.add( `[${JSON.stringify(this._values)},${JSON.stringify(this._segments)},${this._style}]` );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeLineBase } from \"./e-shape-line-base\";\nimport { EShapeLinePoints } from \"./e-shape-line-points\";\n\nexport class EShapeLine extends EShapeLineBase {\n\tpoints!: EShapeLinePoints;\n\n\tconstructor( line: EShapeLine );\n\tconstructor( points: number[], segments: number[], width: number, style: EShapePointsStyle );\n\tconstructor(\n\t\tlineOrPoints: EShapeLine | number[],\n\t\tsegments?: number[],\n\t\twidth?: number,\n\t\tstyle?: EShapePointsStyle\n\t) {\n\t\tsuper( EShapeType.LINE );\n\t\tif( lineOrPoints instanceof EShapeLine ) {\n\t\t\tthis.copy( lineOrPoints );\n\t\t} else {\n\t\t\tthis.fill.enable = false;\n\t\t\tthis.stroke.set( true, undefined, undefined, width! );\n\t\t\tthis.points = new EShapeLinePoints( this, lineOrPoints, segments!, style! );\n\t\t\tthis.transform.position.copyFrom( this.points.position );\n\t\t\tthis.size.copyFrom( this.points.size );\n\t\t}\n\t}\n\n\tclone(): EShapeLine {\n\t\treturn new EShapeLine( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapePointsStyle } from \"../e-shape-points\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLine } from \"./e-shape-line\";\n\nexport class EShapeLines {\n\tstatic toStrokeWidth( index: number, resources: string[] ): number {\n\t\tif( 0 <= index && index < resources.length  ) {\n\t\t\ttry {\n\t\t\t\treturn JSON.parse( resources[ index ] )[ 3 ];\n\t\t\t} catch( e ) {\n\t\t\t\t//\n\t\t\t}\n\t\t}\n\t\treturn 8;\n\t}\n\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeLine> | EShapeLine | null {\n\t\tconst resources = manager.resources;\n\t\tconst resourceId = item[ 15 ];\n\t\tif( 0 <= resourceId && resourceId < resources.length ) {\n\t\t\tlet parsed = manager.extensions.get( resourceId ) as [ number[], number[], number ] | undefined;\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ resourceId ] ) as [ number[], number[], number ];\n\t\t\t\tmanager.extensions.set( resourceId, parsed );\n\t\t\t}\n\t\t\tconst shape = EShapeLines.create(\n\t\t\t\tparsed[ 0 ],\n\t\t\t\tparsed[ 1 ],\n\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\tparsed[ 2 ]\n\t\t\t);\n\t\t\treturn EShapeDeserializer.deserialize( item, manager, shape );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic create(\n\t\tpoints: number[],\n\t\tsegments: number[],\n\t\tstrokeWidth: number,\n\t\tstyle: EShapePointsStyle\n\t): EShapeLine {\n\t\treturn new EShapeLine( points, segments, strokeWidth, style );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeLineUploadeds } from \"../shape/variant/e-shape-line-uploadeds\";\nimport { EShapeLines } from \"../shape/variant/e-shape-lines\";\n\nexport const loadShapeLine = () => {\n\tEShapeUploadeds[ EShapeType.LINE ] = EShapeLineUploadeds.create;\n\tEShapeDeserializers[ EShapeType.LINE ] = EShapeLines.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\n\nexport class EShapeNullUploaded extends EShapeUploadedBase {\n\tconstructor( buffer: EShapeBuffer, voffset: number, ioffset: number ) {\n\t\tsuper( buffer, voffset, ioffset, 0, 0 );\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.texture = shape.texture || Texture.WHITE;\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeNullUploaded } from \"./e-shape-null-uploaded\";\n\nexport class EShapeNullUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n\t): EShapeNullUploaded | null {\n\t\treturn new EShapeNullUploaded( buffer, voffset, ioffset ).init( shape );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeNull extends EShapePrimitive {\n\tconstructor( type: EShapeType = EShapeType.NULL ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeNull {\n\t\treturn new EShapeNull().copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeNull } from \"./e-shape-null\";\n\nexport class EShapeNulls {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeNull> | EShapeNull {\n\t\treturn EShapeDeserializer.deserialize( item, manager, new EShapeNull() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeNullUploadeds } from \"../shape/variant/e-shape-null-uploadeds\";\nimport { EShapeNulls } from \"../shape/variant/e-shape-nulls\";\n\nexport const loadShapeNull = () => {\n\tEShapeUploadeds[ EShapeType.NULL ] = EShapeNullUploadeds.create;\n\tEShapeDeserializers[ EShapeType.NULL ] = EShapeNulls.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeCapability } from \"./e-shape-capability\";\nimport { EShapeType } from \"./e-shape-type\";\n\nexport class EShapeCapabilities {\n\tstatic mappings: { [ type: number ]: EShapeCapability } = {};\n\n\tstatic get( type: EShapeType ): EShapeCapability {\n\t\treturn this.mappings[ type ] || EShapeCapability.PRIMITIVE;\n\t}\n\n\tstatic contains( shape: EShape | null | undefined, capability: EShapeCapability ): shape is EShape {\n\t\tif( shape != null ) {\n\t\t\tif( this.get( shape.type ) & capability ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tconst children = shape.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tif( this.contains( children[ i ], capability ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic set( type: EShapeType, capability: EShapeCapability ): void {\n\t\tthis.mappings[ type ] = capability;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\n\nexport class EShapeRectangles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeRectangle> | EShapeRectangle {\n\t\treturn EShapeDeserializer.deserialize( item, manager, EShapeRectangles.create() );\n\t}\n\n\tstatic create() {\n\t\treturn new EShapeRectangle();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeRectangleUploadeds } from \"../shape/variant/e-shape-rectangle-uploadeds\";\nimport { EShapeRectangles } from \"../shape/variant/e-shape-rectangles\";\n\nexport const loadShapeRectangle = () => {\n\tEShapeUploadeds[ EShapeType.RECTANGLE ] = EShapeRectangleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.RECTANGLE ] = EShapeRectangles.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.RECTANGLE,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeRectangleRoundedUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\n\t\t// Indices\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\t\tlet ii = ioffset * 3;\n\n\t\t// Top-left corner\n\t\tindices[ ii + 0 ] = voffset + 0;\n\t\tindices[ ii + 1 ] = voffset + 1;\n\t\tindices[ ii + 2 ] = voffset + 2;\n\t\tindices[ ii + 3 ] = voffset + 1;\n\t\tindices[ ii + 4 ] = voffset + 3;\n\t\tindices[ ii + 5 ] = voffset + 2;\n\t\tii += 6;\n\n\t\t// Top-right corner\n\t\tindices[ ii + 0 ] = voffset + 4;\n\t\tindices[ ii + 1 ] = voffset + 5;\n\t\tindices[ ii + 2 ] = voffset + 6;\n\t\tindices[ ii + 3 ] = voffset + 5;\n\t\tindices[ ii + 4 ] = voffset + 7;\n\t\tindices[ ii + 5 ] = voffset + 6;\n\t\tii += 6;\n\n\t\t// Bottom-left corner\n\t\tindices[ ii + 0 ] = voffset + 8;\n\t\tindices[ ii + 1 ] = voffset + 9;\n\t\tindices[ ii + 2 ] = voffset + 10;\n\t\tindices[ ii + 3 ] = voffset + 9;\n\t\tindices[ ii + 4 ] = voffset + 11;\n\t\tindices[ ii + 5 ] = voffset + 10;\n\t\tii += 6;\n\n\t\t// Bottom-right corner\n\t\tindices[ ii + 0 ] = voffset + 12;\n\t\tindices[ ii + 1 ] = voffset + 13;\n\t\tindices[ ii + 2 ] = voffset + 14;\n\t\tindices[ ii + 3 ] = voffset + 13;\n\t\tindices[ ii + 4 ] = voffset + 15;\n\t\tindices[ ii + 5 ] = voffset + 14;\n\t\tii += 6;\n\n\t\t// Top edge\n\t\tindices[ ii + 0 ] = voffset + 16;\n\t\tindices[ ii + 1 ] = voffset + 17;\n\t\tindices[ ii + 2 ] = voffset + 20;\n\t\tindices[ ii + 3 ] = voffset + 17;\n\t\tindices[ ii + 4 ] = voffset + 21;\n\t\tindices[ ii + 5 ] = voffset + 20;\n\t\tii += 6;\n\n\t\tindices[ ii + 0 ] = voffset + 17;\n\t\tindices[ ii + 1 ] = voffset + 18;\n\t\tindices[ ii + 2 ] = voffset + 21;\n\t\tindices[ ii + 3 ] = voffset + 18;\n\t\tindices[ ii + 4 ] = voffset + 22;\n\t\tindices[ ii + 5 ] = voffset + 21;\n\t\tii += 6;\n\n\t\t// Upper middle\n\t\tindices[ ii + 0 ] = voffset + 19;\n\t\tindices[ ii + 1 ] = voffset + 21;\n\t\tindices[ ii + 2 ] = voffset + 24;\n\t\tindices[ ii + 3 ] = voffset + 21;\n\t\tindices[ ii + 4 ] = voffset + 25;\n\t\tindices[ ii + 5 ] = voffset + 24;\n\t\tii += 6;\n\n\t\tindices[ ii + 0 ] = voffset + 21;\n\t\tindices[ ii + 1 ] = voffset + 23;\n\t\tindices[ ii + 2 ] = voffset + 26;\n\t\tindices[ ii + 3 ] = voffset + 23;\n\t\tindices[ ii + 4 ] = voffset + 27;\n\t\tindices[ ii + 5 ] = voffset + 26;\n\t\tii += 6;\n\n\t\t// Lower middle\n\t\tindices[ ii + 0 ] = voffset + 24;\n\t\tindices[ ii + 1 ] = voffset + 25;\n\t\tindices[ ii + 2 ] = voffset + 28;\n\t\tindices[ ii + 3 ] = voffset + 25;\n\t\tindices[ ii + 4 ] = voffset + 30;\n\t\tindices[ ii + 5 ] = voffset + 28;\n\t\tii += 6;\n\n\t\tindices[ ii + 0 ] = voffset + 26;\n\t\tindices[ ii + 1 ] = voffset + 27;\n\t\tindices[ ii + 2 ] = voffset + 30;\n\t\tindices[ ii + 3 ] = voffset + 27;\n\t\tindices[ ii + 4 ] = voffset + 32;\n\t\tindices[ ii + 5 ] = voffset + 30;\n\t\tii += 6;\n\n\t\t// Bottom edge\n\t\tindices[ ii + 0 ] = voffset + 29;\n\t\tindices[ ii + 1 ] = voffset + 30;\n\t\tindices[ ii + 2 ] = voffset + 33;\n\t\tindices[ ii + 3 ] = voffset + 30;\n\t\tindices[ ii + 4 ] = voffset + 34;\n\t\tindices[ ii + 5 ] = voffset + 33;\n\t\tii += 6;\n\n\t\tindices[ ii + 0 ] = voffset + 30;\n\t\tindices[ ii + 1 ] = voffset + 31;\n\t\tindices[ ii + 2 ] = voffset + 34;\n\t\tindices[ ii + 3 ] = voffset + 31;\n\t\tindices[ ii + 4 ] = voffset + 35;\n\t\tindices[ ii + 5 ] = voffset + 34;\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateType1Vertex( buffer, shape );\n\t\tthis.updateType1Clipping( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateType1Step( buffer, shape );\n\t\tthis.updateType1Uv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\t/**\n\t * Please note that this method must be executed before updateClippingType1(...).\n\t */\n\tprotected updateType1Vertex( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst radius = shape.radius;\n\t\tconst isSizeChanged = (\n\t\t\tsizeX !== this.sizeX ||\n\t\t\tsizeY !== this.sizeY ||\n\t\t\tradius !== this.radius\n\t\t);\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.radius = radius;\n\t\t\tif( isSizeChanged ) {\n\t\t\t\t// Invalidate the corner to update the clippings\n\t\t\t\tthis.corner = NaN;\n\n\t\t\t\t// Invalidate the textureTransformId to updateh UVs.\n\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t}\n\t\t\t// Invalidate the stroke width to update the steps / antialiases\n\t\t\tthis.strokeWidth = NaN;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\tbuffer.vertexBuffer.update();\n\n\t\t\t// Calculate the transformed positions\n\t\t\t//\n\t\t\t//  0   1       4   5\n\t\t\t// |---|       |---|\n\t\t\t// |2  |3      |6  |7\n\t\t\t// |---|       |---|\n\t\t\t//\n\t\t\t//\n\t\t\t//\n\t\t\t//\n\t\t\t//\n\t\t\t// |---|       |---|\n\t\t\t// |8  |9      |12 |13\n\t\t\t// |---|       |---|\n\t\t\t//  10  11      14  15\n\t\t\t//\n\t\t\t//\n\t\t\t//      16  17  18       <-- Top edge\n\t\t\t//     |---|---|\n\t\t\t//  19 |20 |21 |22  23   <-- Top\n\t\t\t// |---|---|---|---|\n\t\t\t// |       |       |\n\t\t\t// |24   25|26     |27   <-- Middle\n\t\t\t// |-------|-------|\n\t\t\t// |       |       |\n\t\t\t// |       |       |\n\t\t\t// |---|---|---|---|\n\t\t\t//  28 |29 |30 |31  32   <-- Bottom\n\t\t\t//     |---|---|\n\t\t\t//      33  34  35       <-- Bottom edge\n\t\t\t//\n\t\t\tconst s = strokeAlign * strokeWidth;\n\t\t\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\t\t\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\t\t\tconst ax = Math.abs( sx );\n\t\t\tconst ay = Math.abs( sy );\n\t\t\tconst a = radius * Math.min( ax, ay );\n\t\t\tconst rx = a / ax;\n\t\t\tconst ry = a / ay;\n\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst work = buffer.work;\n\t\t\twork.set( -sx, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x0 = work.x;\n\t\t\tconst y0 = work.y;\n\t\t\twork.set( 0, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x2 = work.x;\n\t\t\tconst y2 = work.y;\n\t\t\tconst dxh = x2 - x0;\n\t\t\tconst dyh = y2 - y0;\n\t\t\tconst dxhr = rx * dxh;\n\t\t\tconst dyhr = rx * dyh;\n\t\t\tconst x1 = x0 + dxhr;\n\t\t\tconst y1 = y0 + dyhr;\n\t\t\tconst x4 = x2 + dxh;\n\t\t\tconst y4 = y2 + dyh;\n\t\t\tconst x3 = x4 - dxhr;\n\t\t\tconst y3 = y4 - dyhr;\n\t\t\tconst x11 = internalTransform.tx;\n\t\t\tconst y11 = internalTransform.ty;\n\t\t\tconst dxv = x11 - x2;\n\t\t\tconst dyv = y11 - y2;\n\t\t\tconst dxvr = ry * dxv;\n\t\t\tconst dyvr = ry * dyv;\n\t\t\tconst x7 = x2 + dxvr;\n\t\t\tconst y7 = y2 + dyvr;\n\t\t\tconst x5 = x7 - dxh;\n\t\t\tconst y5 = y7 - dyh;\n\t\t\tconst x6 = x5 + dxhr;\n\t\t\tconst y6 = y5 + dyhr;\n\t\t\tconst x9 = x7 + dxh;\n\t\t\tconst y9 = y7 + dyh;\n\t\t\tconst x8 = x9 - dxhr;\n\t\t\tconst y8 = y9 - dyhr;\n\t\t\tconst x10 = x11 - dxh;\n\t\t\tconst y10 = y11 - dyh;\n\t\t\tconst x12 = x11 + dxh;\n\t\t\tconst y12 = y11 + dyh;\n\t\t\tconst x20 = x11 + dxv;\n\t\t\tconst y20 = y11 + dyv;\n\t\t\tconst x15 = x20 - dxvr;\n\t\t\tconst y15 = y20 - dyvr;\n\t\t\tconst x13 = x15 - dxh;\n\t\t\tconst y13 = y15 - dyh;\n\t\t\tconst x14 = x13 + dxhr;\n\t\t\tconst y14 = y13 + dyhr;\n\t\t\tconst x17 = x15 + dxh;\n\t\t\tconst y17 = y15 + dyh;\n\t\t\tconst x16 = x17 - dxhr;\n\t\t\tconst y16 = y17 - dyhr;\n\t\t\tconst x18 = x20 - dxh;\n\t\t\tconst y18 = y20 - dyh;\n\t\t\tconst x19 = x18 + dxhr;\n\t\t\tconst y19 = y18 + dyhr;\n\t\t\tconst x22 = x20 + dxh;\n\t\t\tconst y22 = y20 + dyh;\n\t\t\tconst x21 = x22 - dxhr;\n\t\t\tconst y21 = y22 - dyhr;\n\n\t\t\t// World size\n\t\t\tthis.worldSizeXHalf = this.calcLength( x0, y0, x2, y2 );\n\t\t\tthis.worldSizeYHalf = this.calcLength( x0, y0, x10, y10 );\n\t\t\tthis.worldSizeR = this.calcLength( x0, y0, x1, y1 );\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tlet iv = voffset * 2;\n\n\t\t\t// Top-left corner\n\t\t\tvertices[ iv + 0 ] = x0;\n\t\t\tvertices[ iv + 1 ] = y0;\n\t\t\tvertices[ iv + 2 ] = x1;\n\t\t\tvertices[ iv + 3 ] = y1;\n\t\t\tvertices[ iv + 4 ] = x5;\n\t\t\tvertices[ iv + 5 ] = y5;\n\t\t\tvertices[ iv + 6 ] = x6;\n\t\t\tvertices[ iv + 7 ] = y6;\n\t\t\tiv += 8;\n\n\t\t\t// Top-right corner\n\t\t\tvertices[ iv + 0 ] = x3;\n\t\t\tvertices[ iv + 1 ] = y3;\n\t\t\tvertices[ iv + 2 ] = x4;\n\t\t\tvertices[ iv + 3 ] = y4;\n\t\t\tvertices[ iv + 4 ] = x8;\n\t\t\tvertices[ iv + 5 ] = y8;\n\t\t\tvertices[ iv + 6 ] = x9;\n\t\t\tvertices[ iv + 7 ] = y9;\n\t\t\tiv += 8;\n\n\t\t\t// Bottom-left corner\n\t\t\tvertices[ iv + 0 ] = x13;\n\t\t\tvertices[ iv + 1 ] = y13;\n\t\t\tvertices[ iv + 2 ] = x14;\n\t\t\tvertices[ iv + 3 ] = y14;\n\t\t\tvertices[ iv + 4 ] = x18;\n\t\t\tvertices[ iv + 5 ] = y18;\n\t\t\tvertices[ iv + 6 ] = x19;\n\t\t\tvertices[ iv + 7 ] = y19;\n\t\t\tiv += 8;\n\n\t\t\t// Bottom-right corner\n\t\t\tvertices[ iv + 0 ] = x16;\n\t\t\tvertices[ iv + 1 ] = y16;\n\t\t\tvertices[ iv + 2 ] = x17;\n\t\t\tvertices[ iv + 3 ] = y17;\n\t\t\tvertices[ iv + 4 ] = x21;\n\t\t\tvertices[ iv + 5 ] = y21;\n\t\t\tvertices[ iv + 6 ] = x22;\n\t\t\tvertices[ iv + 7 ] = y22;\n\t\t\tiv += 8;\n\n\t\t\t// Top edge\n\t\t\tvertices[ iv + 0 ] = x1;\n\t\t\tvertices[ iv + 1 ] = y1;\n\t\t\tvertices[ iv + 2 ] = x2;\n\t\t\tvertices[ iv + 3 ] = y2;\n\t\t\tvertices[ iv + 4 ] = x3;\n\t\t\tvertices[ iv + 5 ] = y3;\n\t\t\tiv += 6;\n\n\t\t\t// Top\n\t\t\tvertices[ iv + 0 ] = x5;\n\t\t\tvertices[ iv + 1 ] = y5;\n\t\t\tvertices[ iv + 2 ] = x6;\n\t\t\tvertices[ iv + 3 ] = y6;\n\t\t\tvertices[ iv + 4 ] = x7;\n\t\t\tvertices[ iv + 5 ] = y7;\n\t\t\tvertices[ iv + 6 ] = x8;\n\t\t\tvertices[ iv + 7 ] = y8;\n\t\t\tvertices[ iv + 8 ] = x9;\n\t\t\tvertices[ iv + 9 ] = y9;\n\t\t\tiv += 10;\n\n\t\t\t// Middle\n\t\t\tvertices[ iv + 0 ] = x10;\n\t\t\tvertices[ iv + 1 ] = y10;\n\t\t\tvertices[ iv + 2 ] = x11;\n\t\t\tvertices[ iv + 3 ] = y11;\n\t\t\tvertices[ iv + 4 ] = x11;\n\t\t\tvertices[ iv + 5 ] = y11;\n\t\t\tvertices[ iv + 6 ] = x12;\n\t\t\tvertices[ iv + 7 ] = y12;\n\t\t\tiv += 8;\n\n\t\t\t// Bottom\n\t\t\tvertices[ iv + 0 ] = x13;\n\t\t\tvertices[ iv + 1 ] = y13;\n\t\t\tvertices[ iv + 2 ] = x14;\n\t\t\tvertices[ iv + 3 ] = y14;\n\t\t\tvertices[ iv + 4 ] = x15;\n\t\t\tvertices[ iv + 5 ] = y15;\n\t\t\tvertices[ iv + 6 ] = x16;\n\t\t\tvertices[ iv + 7 ] = y16;\n\t\t\tvertices[ iv + 8 ] = x17;\n\t\t\tvertices[ iv + 9 ] = y17;\n\t\t\tiv += 10;\n\n\t\t\t// Bottom edge\n\t\t\tvertices[ iv + 0 ] = x19;\n\t\t\tvertices[ iv + 1 ] = y19;\n\t\t\tvertices[ iv + 2 ] = x20;\n\t\t\tvertices[ iv + 3 ] = y20;\n\t\t\tvertices[ iv + 4 ] = x21;\n\t\t\tvertices[ iv + 5 ] = y21;\n\t\t}\n\t}\n\n\t/**\n\t * Please note that this method must be executed after the updateVertexType1(...).\n\t */\n\tprotected updateType1Clipping( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst corner = shape.corner;\n\t\tif( corner !== this.corner ) {\n\t\t\tthis.corner = corner;\n\n\t\t\t// Invalidate the strokeWidth to update steps / antialiases.\n\t\t\tthis.strokeWidth = NaN;\n\n\t\t\t// Clippings\n\t\t\tbuffer.clippingBuffer.update();\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tlet ic = voffset * 3;\n\t\t\tconst rxc = 1 - this.worldSizeR / this.worldSizeXHalf;\n\t\t\tconst ryc = 1 - this.worldSizeR / this.worldSizeYHalf;\n\n\t\t\t// Top-left corner\n\t\t\tif( corner & EShapeCorner.TOP_LEFT ) {\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\t\t\t} else {\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\t\t\t}\n\n\t\t\t// Top-right corner\n\t\t\tif( corner & EShapeCorner.TOP_RIGHT ) {\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\t\t\t} else {\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\t\t\t}\n\n\t\t\t// Bottom-left corner\n\t\t\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\t\t\t} else {\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\t\t\t}\n\n\t\t\t// Bottom-right corner\n\t\t\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 1;\n\t\t\t\tic += 3;\n\t\t\t} else {\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\n\t\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\t\tic += 3;\n\t\t\t}\n\n\t\t\t// Top edge\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\t// Top\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\t// Middle\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = 0;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\t// Bottom\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 1;\n\t\t\tclippings[ ic + 1 ] = ryc;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\t// Bottom edge\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = 0;\n\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\n\t\t\tclippings[ ic + 0 ] = rxc;\n\t\t\tclippings[ ic + 1 ] = 1;\n\t\t\tclippings[ ic + 2 ] = 0;\n\t\t\tic += 3;\n\t\t}\n\t}\n\n\tprotected updateType1Step( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = shape.stroke.side;\n\t\tif( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth || strokeSide !== this.strokeSide ) {\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\n\t\t\tconst work = buffer.workStep;\n\t\t\tthis.calcStep( this.worldSizeR, strokeWidth, work );\n\t\t\tconst swc = work[ 0 ];\n\t\t\tconst pc0 = work[ 1 ];\n\t\t\tconst pc1 = work[ 2 ];\n\n\t\t\tthis.calcStep( this.worldSizeXHalf, strokeWidth, work );\n\t\t\tconst swx = work[ 0 ];\n\t\t\tconst px0 = work[ 1 ];\n\t\t\tconst px1 = work[ 2 ];\n\n\t\t\tthis.calcStep( this.worldSizeYHalf, strokeWidth, work );\n\t\t\tconst swy = work[ 0 ];\n\t\t\tconst py0 = work[ 1 ];\n\t\t\tconst py1 = work[ 2 ];\n\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst antialiases = buffer.antialiases;\n\t\t\tlet is = voffset * 2;\n\t\t\tlet ia = voffset * 4;\n\t\t\tconst rxc = 1 - this.worldSizeR / this.worldSizeXHalf;\n\t\t\tconst ryc = 1 - this.worldSizeR / this.worldSizeYHalf;\n\n\t\t\tlet swt = swy;\n\t\t\tlet pt0 = py0;\n\t\t\tlet swtc = swc;\n\t\t\tlet ptc0 = pc0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.TOP) ) {\n\t\t\t\tswt = 1;\n\t\t\t\tpt0 = py1;\n\t\t\t\tswtc = 1;\n\t\t\t\tptc0 = pc1;\n\t\t\t}\n\t\t\tlet swr = swx;\n\t\t\tlet pr0 = px0;\n\t\t\tlet swrc = swc;\n\t\t\tlet prc0 = pc0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.RIGHT) ) {\n\t\t\t\tswr = 1;\n\t\t\t\tpr0 = px1;\n\t\t\t\tswrc = 1;\n\t\t\t\tprc0 = pc1;\n\t\t\t}\n\t\t\tlet swb = swy;\n\t\t\tlet pb0 = py0;\n\t\t\tlet swbc = swc;\n\t\t\tlet pbc0 = pc0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.BOTTOM) ) {\n\t\t\t\tswb = 1;\n\t\t\t\tpb0 = py1;\n\t\t\t\tswbc = 1;\n\t\t\t\tpbc0 = pc1;\n\t\t\t}\n\t\t\tlet swl = swx;\n\t\t\tlet pl0 = px0;\n\t\t\tlet swlc = swc;\n\t\t\tlet plc0 = pc0;\n\t\t\tif( ! (strokeSide & EShapeStrokeSide.LEFT) ) {\n\t\t\t\tswl = 1;\n\t\t\t\tpl0 = px1;\n\t\t\t\tswlc = 1;\n\t\t\t\tplc0 = pc1;\n\t\t\t}\n\t\t\tconst plr0 = 0.5 * (pl0 + pr0);\n\t\t\tconst ptb0 = 0.5 * (pt0 + pb0);\n\n\t\t\t// Top-left corner\n\t\t\tconst corner = this.corner;\n\t\t\tif( corner & EShapeCorner.TOP_LEFT ) {\n\t\t\t\tsteps[ is + 0 ] = swlc;\n\t\t\t\tsteps[ is + 1 ] = swtc;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = swtc;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swlc;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t} else {\n\t\t\t\tsteps[ is + 0 ] = swl;\n\t\t\t\tsteps[ is + 1 ] = swt;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\t\tsteps[ is + 1 ] = swt;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swl;\n\t\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t}\n\n\t\t\t// Top-right corner\n\t\t\tif( corner & EShapeCorner.TOP_RIGHT ) {\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = swtc;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swrc;\n\t\t\t\tsteps[ is + 1 ] = swtc;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swrc;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = ptc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t} else {\n\t\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\t\tsteps[ is + 1 ] = swt;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swr;\n\t\t\t\tsteps[ is + 1 ] = swt;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swr;\n\t\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t}\n\n\t\t\t// Bottom-left corner\n\t\t\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\t\t\tsteps[ is + 0 ] = swlc;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swlc;\n\t\t\t\tsteps[ is + 1 ] = swbc;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = swbc;\n\t\t\t\tantialiases[ ia + 0 ] = plc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t} else {\n\t\t\t\tsteps[ is + 0 ] = swl;\n\t\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swl;\n\t\t\t\tsteps[ is + 1 ] = swb;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\t\tsteps[ is + 1 ] = swb;\n\t\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t}\n\n\t\t\t// Bottom-right corner\n\t\t\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swrc;\n\t\t\t\tsteps[ is + 1 ] = 0;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = 0;\n\t\t\t\tsteps[ is + 1 ] = swbc;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swrc;\n\t\t\t\tsteps[ is + 1 ] = swbc;\n\t\t\t\tantialiases[ ia + 0 ] = prc0;\n\t\t\t\tantialiases[ ia + 1 ] = pbc0;\n\t\t\t\tantialiases[ ia + 2 ] = pc1;\n\t\t\t\tantialiases[ ia + 3 ] = pc1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t} else {\n\t\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swr;\n\t\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\t\tsteps[ is + 1 ] = swb;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\n\t\t\t\tsteps[ is + 0 ] = swr;\n\t\t\t\tsteps[ is + 1 ] = swb;\n\t\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\t\tis += 2;\n\t\t\t\tia += 4;\n\t\t\t}\n\n\t\t\t// Top edge\n\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\tsteps[ is + 1 ] = swt;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = swt;\n\t\t\tantialiases[ ia + 0 ] = plr0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\tsteps[ is + 1 ] = swt;\n\t\t\tantialiases[ ia + 0 ] = plr0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// Top\n\t\t\tsteps[ is + 0 ] = swl;\n\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\tantialiases[ ia + 0 ] = plr0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swr;\n\t\t\tsteps[ is + 1 ] = swt * ryc;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pt0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// Middle\n\t\t\tsteps[ is + 0 ] = swl;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = ptb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = ptb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = ptb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swr;\n\t\t\tsteps[ is + 1 ] = 0;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = ptb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// Bottom\n\t\t\tsteps[ is + 0 ] = swl;\n\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\tantialiases[ ia + 0 ] = plr0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swr;\n\t\t\tsteps[ is + 1 ] = swb * ryc;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\t// Bottom edge\n\t\t\tsteps[ is + 0 ] = swl * rxc;\n\t\t\tsteps[ is + 1 ] = swb;\n\t\t\tantialiases[ ia + 0 ] = pl0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = 0;\n\t\t\tsteps[ is + 1 ] = swb;\n\t\t\tantialiases[ ia + 0 ] = plr0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\n\t\t\tsteps[ is + 0 ] = swr * rxc;\n\t\t\tsteps[ is + 1 ] = swb;\n\t\t\tantialiases[ ia + 0 ] = pr0;\n\t\t\tantialiases[ ia + 1 ] = pb0;\n\t\t\tantialiases[ ia + 2 ] = px1;\n\t\t\tantialiases[ ia + 3 ] = py1;\n\t\t\tis += 2;\n\t\t\tia += 4;\n\t\t}\n\t}\n\n\tprotected updateType1Uv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst textureUvs = this.toTextureUvs( texture ) as any;\n\t\t\tconst x0 = textureUvs.x0;\n\t\t\tconst x1 = textureUvs.x1;\n\t\t\tconst x2 = textureUvs.x2;\n\t\t\tconst x3 = textureUvs.x3;\n\t\t\tconst y0 = textureUvs.y0;\n\t\t\tconst y1 = textureUvs.y1;\n\t\t\tconst y2 = textureUvs.y2;\n\t\t\tconst y3 = textureUvs.y3;\n\n\t\t\tconst x4 = 0.5 * (x0 + x1);\n\t\t\tconst y4 = 0.5 * (y0 + y1);\n\t\t\tconst x5 = 0.5 * (x3 + x2);\n\t\t\tconst y5 = 0.5 * (y3 + y2);\n\n\t\t\tconst ruvx = 0.5 * this.worldSizeR / this.worldSizeXHalf;\n\t\t\tconst ruvy = 0.5 * this.worldSizeR / this.worldSizeYHalf;\n\t\t\tconst d0x = ruvx * (x1 - x0);\n\t\t\tconst d0y = ruvx * (y1 - y0);\n\t\t\tconst d1x = ruvy * (x3 - x0);\n\t\t\tconst d1y = ruvy * (y3 - y0);\n\n\t\t\t// UVs\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tlet iuv = voffset * 2;\n\n\t\t\t// Top-left corner\n\t\t\tuvs[ iuv + 0 ] = x0;\n\t\t\tuvs[ iuv + 1 ] = y0;\n\t\t\tuvs[ iuv + 2 ] = x0 + d0x;\n\t\t\tuvs[ iuv + 3 ] = y0 + d0y;\n\t\t\tuvs[ iuv + 4 ] = x0 + d1x;\n\t\t\tuvs[ iuv + 5 ] = y0 + d1y;\n\t\t\tuvs[ iuv + 6 ] = x0 + d0x + d1x;\n\t\t\tuvs[ iuv + 7 ] = y0 + d0y + d1y;\n\t\t\tiuv += 8;\n\n\t\t\t// Top-right corner\n\t\t\tuvs[ iuv + 0 ] = x1 - d0x;\n\t\t\tuvs[ iuv + 1 ] = y1 - d0y;\n\t\t\tuvs[ iuv + 2 ] = x1;\n\t\t\tuvs[ iuv + 3 ] = y1;\n\t\t\tuvs[ iuv + 4 ] = x1 - d0x + d1x;\n\t\t\tuvs[ iuv + 5 ] = y1 - d0y + d1y;\n\t\t\tuvs[ iuv + 6 ] = x1 + d1x;\n\t\t\tuvs[ iuv + 7 ] = y1 + d1y;\n\t\t\tiuv += 8;\n\n\t\t\t// Bottom-left corner\n\t\t\tuvs[ iuv + 0 ] = x3 - d1x;\n\t\t\tuvs[ iuv + 1 ] = y3 - d1y;\n\t\t\tuvs[ iuv + 2 ] = x3 + d0x - d1x;\n\t\t\tuvs[ iuv + 3 ] = y3 + d0y - d1y;\n\t\t\tuvs[ iuv + 4 ] = x3;\n\t\t\tuvs[ iuv + 5 ] = y3;\n\t\t\tuvs[ iuv + 6 ] = x3 + d0x;\n\t\t\tuvs[ iuv + 7 ] = y3 + d0y;\n\t\t\tiuv += 8;\n\n\t\t\t// Bottom-right corner\n\t\t\tuvs[ iuv + 0 ] = x2 - d0x - d1x;\n\t\t\tuvs[ iuv + 1 ] = y2 - d0y - d1y;\n\t\t\tuvs[ iuv + 2 ] = x2 - d1x;\n\t\t\tuvs[ iuv + 3 ] = y2 - d1y;\n\t\t\tuvs[ iuv + 4 ] = x2 - d0x;\n\t\t\tuvs[ iuv + 5 ] = y2 - d0y;\n\t\t\tuvs[ iuv + 6 ] = x2;\n\t\t\tuvs[ iuv + 7 ] = y2;\n\t\t\tiuv += 8;\n\n\t\t\t// Top edge\n\t\t\tuvs[ iuv + 0 ] = x0 + d0x;\n\t\t\tuvs[ iuv + 1 ] = y0 + d0y;\n\t\t\tuvs[ iuv + 2 ] = x4;\n\t\t\tuvs[ iuv + 3 ] = y4;\n\t\t\tuvs[ iuv + 4 ] = x1 - d0x;\n\t\t\tuvs[ iuv + 5 ] = y1 - d0y;\n\t\t\tiuv += 6;\n\n\t\t\t// Top\n\t\t\tuvs[ iuv + 0 ] = x0 + d1x;\n\t\t\tuvs[ iuv + 1 ] = y0 + d1y;\n\t\t\tuvs[ iuv + 2 ] = x0 + d1x + d0x;\n\t\t\tuvs[ iuv + 3 ] = y0 + d1y + d0y;\n\t\t\tuvs[ iuv + 4 ] = x4 + d1x;\n\t\t\tuvs[ iuv + 5 ] = y4 + d1y;\n\t\t\tuvs[ iuv + 6 ] = x1 + d1x - d0x;\n\t\t\tuvs[ iuv + 7 ] = y1 + d1y - d0y;\n\t\t\tuvs[ iuv + 8 ] = x1 + d1x;\n\t\t\tuvs[ iuv + 9 ] = y1 + d1y;\n\t\t\tiuv += 10;\n\n\t\t\t// Middle\n\t\t\tconst x02 = 0.5 * (x0 + x2);\n\t\t\tconst y02 = 0.5 * (y0 + y2);\n\t\t\tuvs[ iuv + 0 ] = 0.5 * (x0 + x3);\n\t\t\tuvs[ iuv + 1 ] = 0.5 * (y0 + y3);\n\t\t\tuvs[ iuv + 2 ] = x02;\n\t\t\tuvs[ iuv + 3 ] = y02;\n\t\t\tuvs[ iuv + 4 ] = x02;\n\t\t\tuvs[ iuv + 5 ] = y02;\n\t\t\tuvs[ iuv + 6 ] = 0.5 * (x1 + x2);\n\t\t\tuvs[ iuv + 7 ] = 0.5 * (y1 + y2);\n\t\t\tiuv += 8;\n\n\t\t\t// Bottom\n\t\t\tuvs[ iuv + 0 ] = x3 - d1x;\n\t\t\tuvs[ iuv + 1 ] = y3 - d1y;\n\t\t\tuvs[ iuv + 2 ] = x3 - d1x + d0x;\n\t\t\tuvs[ iuv + 3 ] = y3 - d1y + d0y;\n\t\t\tuvs[ iuv + 4 ] = x5 - d1x;\n\t\t\tuvs[ iuv + 5 ] = y5 - d1y;\n\t\t\tuvs[ iuv + 6 ] = x2 - d1x - d0x;\n\t\t\tuvs[ iuv + 7 ] = y2 - d1y - d0y;\n\t\t\tuvs[ iuv + 8 ] = x2 - d1x;\n\t\t\tuvs[ iuv + 9 ] = y2 - d1y;\n\t\t\tiuv += 10;\n\n\t\t\t// Bottom edge\n\t\t\tuvs[ iuv + 0 ] = x3 + d0x;\n\t\t\tuvs[ iuv + 1 ] = y3 + d0y;\n\t\t\tuvs[ iuv + 2 ] = x5;\n\t\t\tuvs[ iuv + 3 ] = y5;\n\t\t\tuvs[ iuv + 4 ] = x2 - d0x;\n\t\t\tuvs[ iuv + 5 ] = y2 - d0y;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeRectangleRoundedUploaded } from \"./e-shape-rectangle-rounded-uploaded\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\n\nexport class EShapeRectangleRoundedUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tvoffset: number, ioffset: number\n\t): EShapeRectangleRoundedUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = 36 + tvcount;\n\t\tconst icount = 24 + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeRectangleRoundedUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeRectangleRounded extends EShapePrimitive {\n\tconstructor( type = EShapeType.RECTANGLE_ROUNDED ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeRectangleRounded {\n\t\treturn new EShapeRectangleRounded().copy( this );\n\t}\n\n\tprivate containsAbs_( x: number, y: number, ax: number, ay: number, r: number, corner: EShapeCorner ): boolean {\n\t\tconst bx0 = -ax + r;\n\t\tif( x <= bx0 ) {\n\t\t\tconst by0 = -ay + r;\n\t\t\tif( y <= by0 && (corner & EShapeCorner.TOP_LEFT) ) {\n\t\t\t\t// Top-left corner\n\t\t\t\tconst dx = x - bx0;\n\t\t\t\tconst dy = y - by0;\n\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t} else {\n\t\t\t\tconst by1 = +ay - r;\n\t\t\t\tif( by1 <= y && (corner & EShapeCorner.BOTTOM_LEFT) ) {\n\t\t\t\t\t// Bottom-left corner\n\t\t\t\t\tconst dx = x - bx0;\n\t\t\t\t\tconst dy = y - by1;\n\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t} else {\n\t\t\t\t\t// Middle-left box\n\t\t\t\t\treturn -ax <= x;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst bx1 = +ax - r;\n\t\t\tif( bx1 <= x ) {\n\t\t\t\tconst by0 = -ay + r;\n\t\t\t\tif( y <= by0 && (corner & EShapeCorner.TOP_RIGHT) ) {\n\t\t\t\t\t// Top-right corner\n\t\t\t\t\tconst dx = x - bx1;\n\t\t\t\t\tconst dy = y - by0;\n\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t} else {\n\t\t\t\t\tconst by1 = +ay - r;\n\t\t\t\t\tif( by1 <= y && (corner & EShapeCorner.BOTTOM_RIGHT) ) {\n\t\t\t\t\t\t// Bottom-right corner\n\t\t\t\t\t\tconst dx = x - bx1;\n\t\t\t\t\t\tconst dy = y - by1;\n\t\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Middle-right box\n\t\t\t\t\t\treturn x <= +ax;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn -ay <= y && y <= +ay;\n\t\t\t}\n\t\t}\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tif( fill.enable || 0 < strokeWidth ) {\n\t\t\t\tconst r = this.radius * Math.min( ax, ay );\n\t\t\t\tconst corner = this.corner;\n\t\t\t\tconst strokeSide = stroke.side;\n\t\t\t\tif( this.containsAbs_( x, y, ax, ay, r, corner ) ) {\n\t\t\t\t\tif( fill.enable ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\t\tconst wr = Math.max( 0.0, r - strokeWidth );\n\t\t\t\t\t\tif( ! this.containsAbs_( x, y, wx, wy, wr, corner ) ) {\n\t\t\t\t\t\t\tif( strokeSide === EShapeStrokeSide.ALL ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif( x <= -wx + wr ) {\n\t\t\t\t\t\t\t\t\tconst hasLeftSide = ( strokeSide & EShapeStrokeSide.LEFT ) !== 0;\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\tconst hasTopSide = ( strokeSide & EShapeStrokeSide.TOP );\n\t\t\t\t\t\t\t\t\t\tif( hasTopSide && hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasTopSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn -wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn x <= -wx;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\tconst hasBottomSide = ( strokeSide & EShapeStrokeSide.BOTTOM );\n\t\t\t\t\t\t\t\t\t\tif( hasBottomSide && hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasBottomSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn x <= -wx;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn hasLeftSide;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if( +wx - wr <= x ) {\n\t\t\t\t\t\t\t\t\tconst hasRightSide = ( strokeSide & EShapeStrokeSide.RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\tconst hasTopSide = ( strokeSide & EShapeStrokeSide.TOP );\n\t\t\t\t\t\t\t\t\t\tif( hasTopSide && hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasTopSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn -wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= x;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\tconst hasBottomSide = ( strokeSide & EShapeStrokeSide.BOTTOM );\n\t\t\t\t\t\t\t\t\t\tif( hasBottomSide && hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasBottomSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= x;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn hasRightSide;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP ) !== 0;\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM ) !== 0;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeRectangleRounded } from \"./e-shape-rectangle-rounded\";\n\nexport class EShapeRectangleRoundeds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeRectangleRounded> | EShapeRectangleRounded {\n\t\treturn EShapeDeserializer.deserialize( item, manager, EShapeRectangleRoundeds.create() );\n\t}\n\n\tstatic create(): EShapeRectangleRounded {\n\t\treturn new EShapeRectangleRounded();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeRectangleRoundedUploadeds } from \"../shape/variant/e-shape-rectangle-rounded-uploadeds\";\nimport { EShapeRectangleRoundeds } from \"../shape/variant/e-shape-rectangle-roundeds\";\n\nexport const loadShapeRectangleRounded = () => {\n\tEShapeUploadeds[ EShapeType.RECTANGLE_ROUNDED ] = EShapeRectangleRoundedUploadeds.create;\n\tEShapeDeserializers[ EShapeType.RECTANGLE_ROUNDED ] = EShapeRectangleRoundeds.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.RECTANGLE_ROUNDED,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeTriangleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\n\t\t// Clippings\n\t\tbuffer.clippingBuffer.update();\n\t\tconst clippings = buffer.clippings;\n\t\tconst iv = voffset * 3;\n\t\tclippings[ iv +  0 ] = 0;\n\t\tclippings[ iv +  1 ] = 0;\n\t\tclippings[ iv +  2 ] = 0;\n\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = 0;\n\t\tclippings[ iv +  5 ] = 0;\n\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 0;\n\t\tclippings[ iv +  8 ] = 0;\n\n\t\tclippings[ iv +  9 ] = 0;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 0;\n\n\t\tclippings[ iv + 12 ] = 0;\n\t\tclippings[ iv + 13 ] = 1;\n\t\tclippings[ iv + 14 ] = 0;\n\n\t\tclippings[ iv + 15 ] = 1;\n\t\tclippings[ iv + 16 ] = 0;\n\t\tclippings[ iv + 17 ] = 0;\n\n\t\tclippings[ iv + 18 ] = 1;\n\t\tclippings[ iv + 19 ] = 0;\n\t\tclippings[ iv + 20 ] = 0;\n\n\t\t// Indices\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\t\tconst ii = ioffset * 3;\n\t\tindices[ ii + 0 ] = voffset + 0;\n\t\tindices[ ii + 1 ] = voffset + 1;\n\t\tindices[ ii + 2 ] = voffset + 2;\n\n\t\tindices[ ii + 3 ] = voffset + 0;\n\t\tindices[ ii + 4 ] = voffset + 3;\n\t\tindices[ ii + 5 ] = voffset + 4;\n\n\t\tindices[ ii + 6 ] = voffset + 0;\n\t\tindices[ ii + 7 ] = voffset + 5;\n\t\tindices[ ii + 8 ] = voffset + 6;\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateTriangleVertex( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateTriangleStep( buffer, shape );\n\t\tthis.updateTriangleUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateTriangleVertex( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tif( isSizeChanged ) {\n\t\t\t\t// Invalidate the texture transform ID to update the UVs.\n\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t}\n\t\t\t// Invalidate the stroke width to update the steps / antialiases.\n\t\t\tthis.strokeWidth = NaN;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\tbuffer.vertexBuffer.update();\n\n\t\t\t// Calculate the transformed positions\n\t\t\tconst s = strokeAlign * strokeWidth;\n\t\t\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\t\t\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\t\t\tconst sz = Math.sqrt( sx * sx + 4 * sy * sy );\n\t\t\tconst sw = 2 * sx * sy / (sx + sz);\n\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst work = buffer.work;\n\t\t\twork.set( 0, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x0 = work.x;\n\t\t\tconst y0 = work.y;\n\t\t\twork.set( +sx, 0 );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst tx = internalTransform.tx;\n\t\t\tconst ty = internalTransform.ty;\n\t\t\tconst dx = tx - x0;\n\t\t\tconst dy = ty - y0;\n\t\t\tconst x1 = work.x + dx;\n\t\t\tconst y1 = work.y + dy;\n\t\t\tconst x2 = tx + (tx - work.x) + dx;\n\t\t\tconst y2 = ty + (ty - work.y) + dy;\n\t\t\twork.set( 0, sy - sw ); // Incenter of a triangle\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x3 = work.x;\n\t\t\tconst y3 = work.y;\n\n\t\t\t// World size\n\t\t\tconst xb = tx + dx;\n\t\t\tconst yb = ty + dy;\n\t\t\tthis.worldSizeXHalf = this.calcLength( x1, y1, xb, yb );\n\t\t\tthis.worldSizeYHalf = this.calcLength( x0, y0, tx, ty );\n\t\t\tthis.worldSizeR = this.calcLength( xb, yb, x3, y3 );\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst iv = voffset * 2;\n\t\t\tvertices[ iv +  0 ] = x3;\n\t\t\tvertices[ iv +  1 ] = y3;\n\n\t\t\tvertices[ iv +  2 ] = x0;\n\t\t\tvertices[ iv +  3 ] = y0;\n\t\t\tvertices[ iv +  4 ] = x1;\n\t\t\tvertices[ iv +  5 ] = y1;\n\n\t\t\tvertices[ iv +  6 ] = x1;\n\t\t\tvertices[ iv +  7 ] = y1;\n\t\t\tvertices[ iv +  8 ] = x2;\n\t\t\tvertices[ iv +  9 ] = y2;\n\n\t\t\tvertices[ iv + 10 ] = x2;\n\t\t\tvertices[ iv + 11 ] = y2;\n\t\t\tvertices[ iv + 12 ] = x0;\n\t\t\tvertices[ iv + 13 ] = y0;\n\t\t}\n\t}\n\n\tprotected updateTriangleStep( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tif( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth ) {\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\n\t\t\tconst work = buffer.workStep;\n\t\t\tthis.calcStep( this.worldSizeR, strokeWidth, work );\n\t\t\tconst swc = work[ 0 ];\n\t\t\tconst pc0 = work[ 1 ];\n\t\t\tconst pc1 = work[ 2 ];\n\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vcount = this.vertexCount - this.textVertexCount;\n\t\t\tthis.updateStep( buffer, voffset, vcount, swc, swc, pc0, pc0, pc1, pc1 );\n\t\t}\n\t}\n\n\tprotected updateTriangleUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst textureUvs = this.toTextureUvs( texture ) as any;\n\t\t\tconst x0 = textureUvs.x0;\n\t\t\tconst x1 = textureUvs.x1;\n\t\t\tconst x2 = textureUvs.x2;\n\t\t\tconst x3 = textureUvs.x3;\n\t\t\tconst y0 = textureUvs.y0;\n\t\t\tconst y1 = textureUvs.y1;\n\t\t\tconst y2 = textureUvs.y2;\n\t\t\tconst y3 = textureUvs.y3;\n\n\t\t\tconst x4 = 0.5 * ( x0 + x1 );\n\t\t\tconst y4 = 0.5 * ( y0 + y1 );\n\n\t\t\tconst c = 1 - 0.5 * this.worldSizeR / this.worldSizeYHalf;\n\t\t\tconst x5 = x4 + c * ( x3 - x0 );\n\t\t\tconst y5 = y4 + c * ( y3 - y0 );\n\n\t\t\t// UVs\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst iuv = voffset * 2;\n\t\t\tuvs[ iuv +  0 ] = x5;\n\t\t\tuvs[ iuv +  1 ] = y5;\n\n\t\t\tuvs[ iuv +  2 ] = x4;\n\t\t\tuvs[ iuv +  3 ] = y4;\n\t\t\tuvs[ iuv +  4 ] = x2;\n\t\t\tuvs[ iuv +  5 ] = y2;\n\n\t\t\tuvs[ iuv +  6 ] = x2;\n\t\t\tuvs[ iuv +  7 ] = y2;\n\t\t\tuvs[ iuv +  8 ] = x3;\n\t\t\tuvs[ iuv +  9 ] = y3;\n\n\t\t\tuvs[ iuv + 10 ] = x3;\n\t\t\tuvs[ iuv + 11 ] = y3;\n\t\t\tuvs[ iuv + 12 ] = x4;\n\t\t\tuvs[ iuv + 13 ] = y4;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\nimport { EShapeTriangleUploaded } from \"./e-shape-triangle-uploaded\";\n\nexport class EShapeTriangleUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n\t): EShapeTriangleUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = 7 + tvcount;\n\t\tconst icount = 3 + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeTriangleUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeTriangle extends EShapePrimitive {\n\tconstructor( type = EShapeType.TRIANGLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeTriangle {\n\t\treturn new EShapeTriangle().copy( this );\n\t}\n\n\tprotected containsAbs_( x: number, y: number, a: number, ay1: number, ay2: number ): boolean {\n\t\t// a = 2 * ay / ax\n\t\t// y = + a * x + ay1\n\t\t// y = - a * x + ay1\n\t\t// y = ay2;\n\t\treturn ( +a * x + ay1 - y <= 0 && -a * x + ay1 - y <= 0 && y <= ay2 );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst a = 2 * ay / ax;\n\t\t\tconst fill = this.fill;\n\t\t\tif( fill.enable ) {\n\t\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst stroke = this.stroke;\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\t\t\tconst az = Math.sqrt( ax * ax + 4 * ay * ay );\n\t\t\t\t\t\tconst aw = 2 * ax * ay / (ax + az);\n\n\t\t\t\t\t\tconst cy = ay - aw;\n\t\t\t\t\t\tconst ay1 = cy + (-ay - cy) * Math.max( 0.0, aw - strokeWidth ) / aw;\n\t\t\t\t\t\tconst ay2 = ay - strokeWidth;\n\t\t\t\t\t\tif( ! this.containsAbs_( x, y, a, ay1, ay2 ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\n\nexport class EShapeTriangles {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeTriangle> | EShapeTriangle {\n\t\treturn EShapeDeserializer.deserialize( item, manager, EShapeTriangles.create() );\n\t}\n\n\tstatic create(): EShapeTriangle {\n\t\treturn new EShapeTriangle();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeTriangleUploadeds } from \"../shape/variant/e-shape-triangle-uploadeds\";\nimport { EShapeTriangles } from \"../shape/variant/e-shape-triangles\";\n\nexport const loadShapeTriangle = () => {\n\tEShapeUploadeds[ EShapeType.TRIANGLE ] = EShapeTriangleUploadeds.create;\n\tEShapeDeserializers[ EShapeType.TRIANGLE ] = EShapeTriangles.deserialize;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeTriangleRoundedUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\n\t\t// Indices\n\t\tbuffer.indexBuffer.update();\n\t\tconst indices = buffer.indices;\n\t\tconst ii = ioffset * 3;\n\n\t\t// Top corner\n\t\tindices[ ii +  0 ] = voffset + 0;\n\t\tindices[ ii +  1 ] = voffset + 1;\n\t\tindices[ ii +  2 ] = voffset + 3;\n\n\t\tindices[ ii +  3 ] = voffset + 1;\n\t\tindices[ ii +  4 ] = voffset + 2;\n\t\tindices[ ii +  5 ] = voffset + 3;\n\n\t\t// Bottom-right corner\n\t\tindices[ ii +  6 ] = voffset + 4;\n\t\tindices[ ii +  7 ] = voffset + 5;\n\t\tindices[ ii +  8 ] = voffset + 7;\n\n\t\tindices[ ii +  9 ] = voffset + 5;\n\t\tindices[ ii + 10 ] = voffset + 6;\n\t\tindices[ ii + 11 ] = voffset + 7;\n\n\t\t// Bottom-left corner\n\t\tindices[ ii + 12 ] = voffset + 8;\n\t\tindices[ ii + 13 ] = voffset + 9;\n\t\tindices[ ii + 14 ] = voffset + 11;\n\n\t\tindices[ ii + 15 ] = voffset + 9;\n\t\tindices[ ii + 16 ] = voffset + 10;\n\t\tindices[ ii + 17 ] = voffset + 11;\n\n\t\t// Others\n\t\tindices[ ii + 18 ] = voffset + 12;\n\t\tindices[ ii + 19 ] = voffset + 13;\n\t\tindices[ ii + 20 ] = voffset + 16;\n\n\t\tindices[ ii + 21 ] = voffset + 13;\n\t\tindices[ ii + 22 ] = voffset + 14;\n\t\tindices[ ii + 23 ] = voffset + 16;\n\n\t\tindices[ ii + 24 ] = voffset + 14;\n\t\tindices[ ii + 25 ] = voffset + 15;\n\t\tindices[ ii + 26 ] = voffset + 16;\n\n\t\t//\n\t\tindices[ ii + 27 ] = voffset + 12;\n\t\tindices[ ii + 28 ] = voffset + 16;\n\t\tindices[ ii + 29 ] = voffset + 19;\n\n\t\tindices[ ii + 30 ] = voffset + 16;\n\t\tindices[ ii + 31 ] = voffset + 17;\n\t\tindices[ ii + 32 ] = voffset + 19;\n\n\t\tindices[ ii + 33 ] = voffset + 17;\n\t\tindices[ ii + 34 ] = voffset + 18;\n\t\tindices[ ii + 35 ] = voffset + 19;\n\n\t\t//\n\t\tindices[ ii + 36 ] = voffset + 12;\n\t\tindices[ ii + 37 ] = voffset + 19;\n\t\tindices[ ii + 38 ] = voffset + 13;\n\n\t\tindices[ ii + 39 ] = voffset + 19;\n\t\tindices[ ii + 40 ] = voffset + 20;\n\t\tindices[ ii + 41 ] = voffset + 13;\n\n\t\tindices[ ii + 42 ] = voffset + 20;\n\t\tindices[ ii + 43 ] = voffset + 21;\n\t\tindices[ ii + 44 ] = voffset + 13;\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateTriangleRoundedVertex( buffer, shape );\n\t\tthis.updateTriangleRoundedClipping( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateTriangleRoundedStep( buffer, shape );\n\t\tthis.updateTriangleRoundedUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateTriangleRoundedVertex( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst radius = shape.radius;\n\t\tconst isRadiusChanged = ( radius !== this.radius );\n\t\tconst isSizeChanged = (\n\t\t\tsizeX !== this.sizeX ||\n\t\t\tsizeY !== this.sizeY\n\t\t);\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\t\tif( isSizeChanged || isTransformChanged || isRadiusChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.radius = radius;\n\t\t\tif( isRadiusChanged ) {\n\t\t\t\t// Invalidate the corner to update the clippings\n\t\t\t\tthis.corner = NaN;\n\t\t\t}\n\t\t\tif( isSizeChanged || isRadiusChanged ) {\n\t\t\t\t// Invalidate the texture transform ID to update the UVs.\n\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t}\n\t\t\t// Invalidate the stroke width to update the steps / antialiases\n\t\t\tthis.strokeWidth = NaN;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\tbuffer.vertexBuffer.update();\n\n\t\t\t// Calculate the transformed positions\n\t\t\tconst s = strokeAlign * strokeWidth;\n\t\t\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\t\t\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\t\t\tconst sz = Math.sqrt( sx * sx + 4 * sy * sy );\n\t\t\tconst sw = 2 * sx * sy / (sx + sz);\n\t\t\tconst ry = ( sw * radius ) / ( 2 * sy );\n\t\t\tconst rz = ( 0.5 * ( sz - sw ) * radius ) / ( sz );\n\t\t\tconst rx = ( ry * sz ) / ( 2 * sx );\n\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst work = buffer.work;\n\t\t\twork.set( 0, -sy );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x1 = work.x;\n\t\t\tconst y1 = work.y;\n\t\t\twork.set( +sx, 0 );\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst tx = internalTransform.tx;\n\t\t\tconst ty = internalTransform.ty;\n\t\t\tconst dx = tx - x1;\n\t\t\tconst dy = ty - y1;\n\t\t\tconst x4 = work.x + dx;\n\t\t\tconst y4 = work.y + dy;\n\t\t\tconst x7 = tx + (tx - work.x) + dx;\n\t\t\tconst y7 = ty + (ty - work.y) + dy;\n\t\t\tconst dx14 = x4 - x1;\n\t\t\tconst dy14 = y4 - y1;\n\t\t\tconst x2 = x1 + rz * dx14;\n\t\t\tconst y2 = y1 + rz * dy14;\n\t\t\tconst x3 = x4 - ry * dx14;\n\t\t\tconst y3 = y4 - ry * dy14;\n\t\t\tconst dx47r = rx * (x7 - x4);\n\t\t\tconst dy47r = rx * (y7 - y4);\n\t\t\tconst x5 = x4 + dx47r;\n\t\t\tconst y5 = y4 + dy47r;\n\t\t\tconst x6 = x7 - dx47r;\n\t\t\tconst y6 = y7 - dy47r;\n\t\t\tconst dx71 = x1 - x7;\n\t\t\tconst dy71 = y1 - y7;\n\t\t\tconst x8 = x7 + ry * dx71;\n\t\t\tconst y8 = y7 + ry * dy71;\n\t\t\tconst x9 = x1 - rz * dx71;\n\t\t\tconst y9 = y1 - rz * dy71;\n\t\t\twork.set( 0, sy - sw ); // Incenter of a triangle\n\t\t\tinternalTransform.apply( work, work );\n\t\t\tconst x0 = work.x;\n\t\t\tconst y0 = work.y;\n\n\t\t\tconst x10 = x1 + radius * ( x0 - x1 );\n\t\t\tconst y10 = y1 + radius * ( y0 - y1 );\n\t\t\tconst x11 = x4 + radius * ( x0 - x4 );\n\t\t\tconst y11 = y4 + radius * ( y0 - y4 );\n\t\t\tconst x12 = x7 + radius * ( x0 - x7 );\n\t\t\tconst y12 = y7 + radius * ( y0 - y7 );\n\n\t\t\t// World size\n\t\t\tconst xb = tx + dx;\n\t\t\tconst yb = ty + dy;\n\t\t\tthis.worldSizeXHalf = rx;\n\t\t\tthis.worldSizeYHalf = ry;\n\t\t\tthis.worldSizeZHalf = rz;\n\t\t\tthis.worldSizeWHalf = 1 - 0.5 * sw / sy;\n\t\t\tthis.worldSizeR = this.calcLength( xb, yb, x0, y0 );\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst iv = voffset * 2;\n\n\t\t\t// Top corner\n\t\t\tvertices[ iv +  0 ] = x10;\n\t\t\tvertices[ iv +  1 ] = y10;\n\t\t\tvertices[ iv +  2 ] = x9;\n\t\t\tvertices[ iv +  3 ] = y9;\n\t\t\tvertices[ iv +  4 ] = x1;\n\t\t\tvertices[ iv +  5 ] = y1;\n\t\t\tvertices[ iv +  6 ] = x2;\n\t\t\tvertices[ iv +  7 ] = y2;\n\n\t\t\t// Bottom-right corner\n\t\t\tvertices[ iv +  8 ] = x11;\n\t\t\tvertices[ iv +  9 ] = y11;\n\t\t\tvertices[ iv + 10 ] = x3;\n\t\t\tvertices[ iv + 11 ] = y3;\n\t\t\tvertices[ iv + 12 ] = x4;\n\t\t\tvertices[ iv + 13 ] = y4;\n\t\t\tvertices[ iv + 14 ] = x5;\n\t\t\tvertices[ iv + 15 ] = y5;\n\n\t\t\t// Bottom-left corner\n\t\t\tvertices[ iv + 16 ] = x12;\n\t\t\tvertices[ iv + 17 ] = y12;\n\t\t\tvertices[ iv + 18 ] = x6;\n\t\t\tvertices[ iv + 19 ] = y6;\n\t\t\tvertices[ iv + 20 ] = x7;\n\t\t\tvertices[ iv + 21 ] = y7;\n\t\t\tvertices[ iv + 22 ] = x8;\n\t\t\tvertices[ iv + 23 ] = y8;\n\n\t\t\t// Others\n\t\t\tvertices[ iv + 24 ] = x0;\n\t\t\tvertices[ iv + 25 ] = y0;\n\n\t\t\tvertices[ iv + 26 ] = x10;\n\t\t\tvertices[ iv + 27 ] = y10;\n\n\t\t\tvertices[ iv + 28 ] = x2;\n\t\t\tvertices[ iv + 29 ] = y2;\n\t\t\tvertices[ iv + 30 ] = x3;\n\t\t\tvertices[ iv + 31 ] = y3;\n\n\t\t\tvertices[ iv + 32 ] = x11;\n\t\t\tvertices[ iv + 33 ] = y11;\n\n\t\t\tvertices[ iv + 34 ] = x5;\n\t\t\tvertices[ iv + 35 ] = y5;\n\t\t\tvertices[ iv + 36 ] = x6;\n\t\t\tvertices[ iv + 37 ] = y6;\n\n\t\t\tvertices[ iv + 38 ] = x12;\n\t\t\tvertices[ iv + 39 ] = y12;\n\n\t\t\tvertices[ iv + 40 ] = x8;\n\t\t\tvertices[ iv + 41 ] = y8;\n\t\t\tvertices[ iv + 42 ] = x9;\n\t\t\tvertices[ iv + 43 ] = y9;\n\t\t}\n\t}\n\n\tprotected updateTriangleRoundedClipping( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst corner = shape.corner;\n\t\tif( corner !== this.corner ) {\n\t\t\tthis.corner = corner;\n\n\t\t\t// Invalidate the strokeWidth to update steps / antialiases\n\t\t\tthis.strokeWidth = NaN;\n\n\t\t\tbuffer.clippingBuffer.update();\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst iv = voffset * 3;\n\t\t\tconst w = 1 - shape.radius;\n\n\t\t\t// Top corner\n\t\t\tif( corner & EShapeCorner.TOP ) {\n\t\t\t\tclippings[ iv +  0 ] = 0;\n\t\t\t\tclippings[ iv +  1 ] = 0;\n\t\t\t\tclippings[ iv +  2 ] = 1;\n\t\t\t\tclippings[ iv +  3 ] = 1;\n\t\t\t\tclippings[ iv +  4 ] = 0;\n\t\t\t\tclippings[ iv +  5 ] = 1;\n\t\t\t\tclippings[ iv +  6 ] = 1;\n\t\t\t\tclippings[ iv +  7 ] = 1;\n\t\t\t\tclippings[ iv +  8 ] = 1;\n\t\t\t\tclippings[ iv +  9 ] = 0;\n\t\t\t\tclippings[ iv + 10 ] = 1;\n\t\t\t\tclippings[ iv + 11 ] = 1;\n\t\t\t} else {\n\t\t\t\tclippings[ iv +  0 ] = w;\n\t\t\t\tclippings[ iv +  1 ] = w;\n\t\t\t\tclippings[ iv +  2 ] = 0;\n\t\t\t\tclippings[ iv +  3 ] = 1;\n\t\t\t\tclippings[ iv +  4 ] = w;\n\t\t\t\tclippings[ iv +  5 ] = 0;\n\t\t\t\tclippings[ iv +  6 ] = 1;\n\t\t\t\tclippings[ iv +  7 ] = 1;\n\t\t\t\tclippings[ iv +  8 ] = 0;\n\t\t\t\tclippings[ iv +  9 ] = w;\n\t\t\t\tclippings[ iv + 10 ] = 1;\n\t\t\t\tclippings[ iv + 11 ] = 0;\n\t\t\t}\n\n\t\t\t// Bottom-right corner\n\t\t\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\t\t\tclippings[ iv + 12 ] = 0;\n\t\t\t\tclippings[ iv + 13 ] = 0;\n\t\t\t\tclippings[ iv + 14 ] = 1;\n\t\t\t\tclippings[ iv + 15 ] = 1;\n\t\t\t\tclippings[ iv + 16 ] = 0;\n\t\t\t\tclippings[ iv + 17 ] = 1;\n\t\t\t\tclippings[ iv + 18 ] = 1;\n\t\t\t\tclippings[ iv + 19 ] = 1;\n\t\t\t\tclippings[ iv + 20 ] = 1;\n\t\t\t\tclippings[ iv + 21 ] = 0;\n\t\t\t\tclippings[ iv + 22 ] = 1;\n\t\t\t\tclippings[ iv + 23 ] = 1;\n\t\t\t} else {\n\t\t\t\tclippings[ iv + 12 ] = w;\n\t\t\t\tclippings[ iv + 13 ] = w;\n\t\t\t\tclippings[ iv + 14 ] = 0;\n\t\t\t\tclippings[ iv + 15 ] = 1;\n\t\t\t\tclippings[ iv + 16 ] = w;\n\t\t\t\tclippings[ iv + 17 ] = 0;\n\t\t\t\tclippings[ iv + 18 ] = 1;\n\t\t\t\tclippings[ iv + 19 ] = 1;\n\t\t\t\tclippings[ iv + 20 ] = 0;\n\t\t\t\tclippings[ iv + 21 ] = w;\n\t\t\t\tclippings[ iv + 22 ] = 1;\n\t\t\t\tclippings[ iv + 23 ] = 0;\n\t\t\t}\n\n\t\t\t// Bottom-left corner\n\t\t\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\t\t\tclippings[ iv + 24 ] = 0;\n\t\t\t\tclippings[ iv + 25 ] = 0;\n\t\t\t\tclippings[ iv + 26 ] = 1;\n\t\t\t\tclippings[ iv + 27 ] = 1;\n\t\t\t\tclippings[ iv + 28 ] = 0;\n\t\t\t\tclippings[ iv + 29 ] = 1;\n\t\t\t\tclippings[ iv + 30 ] = 1;\n\t\t\t\tclippings[ iv + 31 ] = 1;\n\t\t\t\tclippings[ iv + 32 ] = 1;\n\t\t\t\tclippings[ iv + 33 ] = 0;\n\t\t\t\tclippings[ iv + 34 ] = 1;\n\t\t\t\tclippings[ iv + 35 ] = 1;\n\t\t\t} else {\n\t\t\t\tclippings[ iv + 24 ] = w;\n\t\t\t\tclippings[ iv + 25 ] = w;\n\t\t\t\tclippings[ iv + 26 ] = 0;\n\t\t\t\tclippings[ iv + 27 ] = 1;\n\t\t\t\tclippings[ iv + 28 ] = w;\n\t\t\t\tclippings[ iv + 29 ] = 0;\n\t\t\t\tclippings[ iv + 30 ] = 1;\n\t\t\t\tclippings[ iv + 31 ] = 1;\n\t\t\t\tclippings[ iv + 32 ] = 0;\n\t\t\t\tclippings[ iv + 33 ] = w;\n\t\t\t\tclippings[ iv + 34 ] = 1;\n\t\t\t\tclippings[ iv + 35 ] = 0;\n\t\t\t}\n\n\t\t\t// Others\n\t\t\tclippings[ iv + 36 ] = 0;\n\t\t\tclippings[ iv + 37 ] = 0;\n\t\t\tclippings[ iv + 38 ] = 0;\n\n\t\t\tclippings[ iv + 39 ] = w;\n\t\t\tclippings[ iv + 40 ] = 0;\n\t\t\tclippings[ iv + 41 ] = 0;\n\n\t\t\tclippings[ iv + 42 ] = 1;\n\t\t\tclippings[ iv + 43 ] = 0;\n\t\t\tclippings[ iv + 44 ] = 0;\n\t\t\tclippings[ iv + 45 ] = 1;\n\t\t\tclippings[ iv + 46 ] = 0;\n\t\t\tclippings[ iv + 47 ] = 0;\n\n\t\t\tclippings[ iv + 48 ] = w;\n\t\t\tclippings[ iv + 49 ] = 0;\n\t\t\tclippings[ iv + 50 ] = 0;\n\n\t\t\tclippings[ iv + 51 ] = 1;\n\t\t\tclippings[ iv + 52 ] = 0;\n\t\t\tclippings[ iv + 53 ] = 0;\n\t\t\tclippings[ iv + 54 ] = 1;\n\t\t\tclippings[ iv + 55 ] = 0;\n\t\t\tclippings[ iv + 56 ] = 0;\n\n\t\t\tclippings[ iv + 57 ] = w;\n\t\t\tclippings[ iv + 58 ] = 0;\n\t\t\tclippings[ iv + 59 ] = 0;\n\n\t\t\tclippings[ iv + 60 ] = 1;\n\t\t\tclippings[ iv + 61 ] = 0;\n\t\t\tclippings[ iv + 62 ] = 0;\n\t\t\tclippings[ iv + 63 ] = 1;\n\t\t\tclippings[ iv + 64 ] = 0;\n\t\t\tclippings[ iv + 65 ] = 0;\n\t\t}\n\t}\n\n\tprotected updateTriangleRoundedStep( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tif( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth ) {\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tbuffer.stepBuffer.update();\n\t\t\tbuffer.antialiasBuffer.update();\n\n\t\t\tconst work = buffer.workStep;\n\t\t\tconst wsr = this.worldSizeR;\n\t\t\tthis.calcStep( wsr, strokeWidth, work );\n\t\t\tconst swc = work[ 0 ];\n\t\t\tconst pc0 = work[ 1 ];\n\t\t\tconst pc1 = work[ 2 ];\n\n\t\t\tthis.calcStep( shape.radius * wsr, strokeWidth, work );\n\t\t\tconst swr = work[ 0 ];\n\t\t\tconst pr0 = work[ 1 ];\n\t\t\tconst pr1 = work[ 2 ];\n\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vcount = this.vertexCount - this.textVertexCount;\n\t\t\tthis.updateStepIf(\n\t\t\t\tbuffer,\n\t\t\t\tvoffset, vcount,\n\t\t\t\tswr, pr0, pr1,\n\t\t\t\tswc, swc, pc0, pc0, pc1, pc1\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTriangleRoundedUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst textureUvs = this.toTextureUvs( texture ) as any;\n\t\t\tconst x0 = textureUvs.x0;\n\t\t\tconst x1 = textureUvs.x1;\n\t\t\tconst x2 = textureUvs.x2;\n\t\t\tconst x3 = textureUvs.x3;\n\t\t\tconst y0 = textureUvs.y0;\n\t\t\tconst y1 = textureUvs.y1;\n\t\t\tconst y2 = textureUvs.y2;\n\t\t\tconst y3 = textureUvs.y3;\n\n\t\t\tconst x4 = 0.5 * ( x0 + x1 );\n\t\t\tconst y4 = 0.5 * ( y0 + y1 );\n\n\t\t\tconst c = this.worldSizeWHalf;\n\t\t\tconst x5 = x4 + c * ( x3 - x0 );\n\t\t\tconst y5 = y4 + c * ( y3 - y0 );\n\n\t\t\tconst radius = shape.radius;\n\t\t\tconst rx = this.worldSizeXHalf;\n\t\t\tconst ry = this.worldSizeYHalf;\n\t\t\tconst rz = this.worldSizeZHalf;\n\t\t\tconst x6 = x4 + rz * (x3 - x4);\n\t\t\tconst y6 = y4 + rz * (y3 - y4);\n\t\t\tconst x7 = x4 + radius * (x5 - x4);\n\t\t\tconst y7 = y4 + radius * (y5 - y4);\n\t\t\tconst x8 = x4 + rz * (x2 - x4);\n\t\t\tconst y8 = y4 + rz * (y2 - y4);\n\n\t\t\tconst x9 = x2 + ry * (x4 - x2);\n\t\t\tconst y9 = y2 + ry * (y4 - y2);\n\t\t\tconst x10 = x2 + radius * (x5 - x2);\n\t\t\tconst y10 = y2 + radius * (y5 - y2);\n\t\t\tconst x11 = x2 + rx * (x3 - x2);\n\t\t\tconst y11 = y2 + rx * (y3 - y2);\n\n\t\t\tconst x12 = x3 + rx * (x2 - x3);\n\t\t\tconst y12 = y3 + rx * (y2 - y3);\n\t\t\tconst x13 = x3 + radius * (x5 - x3);\n\t\t\tconst y13 = y3 + radius * (y5 - y3);\n\t\t\tconst x14 = x3 + ry * (x4 - x3);\n\t\t\tconst y14 = y3 + ry * (y4 - y3);\n\n\t\t\t// Uvs\n\t\t\tbuffer.uvBuffer.update();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tlet iuv = voffset * 2;\n\n\t\t\t// Top corner\n\t\t\tuvs[ iuv + 0 ] = x7;\n\t\t\tuvs[ iuv + 1 ] = y7;\n\t\t\tuvs[ iuv + 2 ] = x6;\n\t\t\tuvs[ iuv + 3 ] = y6;\n\t\t\tuvs[ iuv + 4 ] = x4;\n\t\t\tuvs[ iuv + 5 ] = y4;\n\t\t\tuvs[ iuv + 6 ] = x8;\n\t\t\tuvs[ iuv + 7 ] = y8;\n\t\t\tiuv += 8;\n\n\t\t\t// Bottom-right corner\n\t\t\tuvs[ iuv + 0 ] = x10;\n\t\t\tuvs[ iuv + 1 ] = y10;\n\t\t\tuvs[ iuv + 2 ] = x9;\n\t\t\tuvs[ iuv + 3 ] = y9;\n\t\t\tuvs[ iuv + 4 ] = x2;\n\t\t\tuvs[ iuv + 5 ] = y2;\n\t\t\tuvs[ iuv + 6 ] = x11;\n\t\t\tuvs[ iuv + 7 ] = y11;\n\t\t\tiuv += 8;\n\n\t\t\t// Bottom-left corner\n\t\t\tuvs[ iuv + 0 ] = x13;\n\t\t\tuvs[ iuv + 1 ] = y13;\n\t\t\tuvs[ iuv + 2 ] = x12;\n\t\t\tuvs[ iuv + 3 ] = y12;\n\t\t\tuvs[ iuv + 4 ] = x3;\n\t\t\tuvs[ iuv + 5 ] = y3;\n\t\t\tuvs[ iuv + 6 ] = x14;\n\t\t\tuvs[ iuv + 7 ] = y14;\n\t\t\tiuv += 8;\n\n\t\t\t// Others\n\t\t\tuvs[ iuv +  0 ] = x5;\n\t\t\tuvs[ iuv +  1 ] = y5;\n\n\t\t\tuvs[ iuv +  2 ] = x7;\n\t\t\tuvs[ iuv +  3 ] = y7;\n\n\t\t\tuvs[ iuv +  4 ] = x8;\n\t\t\tuvs[ iuv +  5 ] = y8;\n\t\t\tuvs[ iuv +  6 ] = x9;\n\t\t\tuvs[ iuv +  7 ] = y9;\n\n\t\t\tuvs[ iuv +  8 ] = x10;\n\t\t\tuvs[ iuv +  9 ] = y10;\n\n\t\t\tuvs[ iuv + 10 ] = x11;\n\t\t\tuvs[ iuv + 11 ] = y11;\n\t\t\tuvs[ iuv + 12 ] = x12;\n\t\t\tuvs[ iuv + 13 ] = y12;\n\n\t\t\tuvs[ iuv + 14 ] = x13;\n\t\t\tuvs[ iuv + 15 ] = y13;\n\n\t\t\tuvs[ iuv + 16 ] = x14;\n\t\t\tuvs[ iuv + 17 ] = y14;\n\t\t\tuvs[ iuv + 18 ] = x6;\n\t\t\tuvs[ iuv + 19 ] = y6;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeTextUploadeds } from \"./e-shape-text-uploadeds\";\nimport { EShapeTriangleRoundedUploaded } from \"./e-shape-triangle-rounded-uploaded\";\n\nexport class EShapeTriangleRoundedUploadeds {\n\tstatic create(\n\t\tbuffer: EShapeBuffer, shape: EShape, voffset: number, ioffset: number\n\t): EShapeTriangleRoundedUploaded | null {\n\t\tconst tcount = EShapeTextUploadeds.getTextCount( shape, buffer.workCount );\n\t\tconst tvcount = tcount.vertexCount;\n\t\tconst ticount = tcount.indexCount;\n\t\tconst vcount = 22 + tvcount;\n\t\tconst icount = 15 + ticount;\n\t\tif( voffset + vcount < buffer.vertexCapacity && ioffset + icount < buffer.indexCapacity ) {\n\t\t\treturn new EShapeTriangleRoundedUploaded(\n\t\t\t\tbuffer, voffset, ioffset, tvcount, ticount, vcount, icount\n\t\t\t).init( shape );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\n\nconst FMIN = 0.00001;\n\nexport class EShapeTriangleRounded extends EShapeTriangle {\n\tconstructor( type = EShapeType.TRIANGLE_ROUNDED ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeTriangleRounded {\n\t\treturn new EShapeTriangleRounded().copy( this );\n\t}\n\n\tprotected containsCorner_( x: number, y: number, r: number, aw: number ) {\n\t\tconst fill = this.fill;\n\t\tif( fill.enable ) {\n\t\t\tif( x * x + y * y <= r * r ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tconst stroke = this.stroke;\n\t\t\tconst strokeWidth = stroke.width;\n\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\tconst d = x * x + y * y;\n\t\t\t\tif( d <= r * r ) {\n\t\t\t\t\tconst w = Math.max( 0.0, r * ( 1 - strokeWidth / aw ) );\n\t\t\t\t\tif( w * w <= d ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected containsCorner(\n\t\tx: number, y: number,\n\t\tx0: number, y0: number,\n\t\tx1: number, y1: number,\n\t\tx2: number, y2: number,\n\t\tx3: number, y3: number,\n\t\tr12: number, r13: number,\n\t\taw: number,\n\t\tradius: number\n\t) {\n\t\tconst xl = x1 + r12 * ( x2 - x1 ) - x0;\n\t\tconst yl = y1 + r12 * ( y2 - y1 ) - y0;\n\t\tconst n = Math.sqrt( xl * xl + yl * yl );\n\t\tif( FMIN < n ) {\n\t\t\tconst ni = 1 / n;\n\t\t\tconst nlx = xl * ni;\n\t\t\tconst nly = yl * ni;\n\n\t\t\tconst xr = x1 + r13 * ( x3 - x1 ) - x0;\n\t\t\tconst yr = y1 + r13 * ( y3 - y1 ) - y0;\n\t\t\tconst nrx = xr * ni;\n\t\t\tconst nry = yr * ni;\n\n\t\t\tconst det = nlx * nry - nrx * nly;\n\t\t\tif( FMIN < Math.abs( det ) ) {\n\t\t\t\tconst deti = 1 / det;\n\t\t\t\tconst xc = x - x0;\n\t\t\t\tconst yc = y - y0;\n\t\t\t\tconst dx = ( +nry * xc - nrx * yc ) * deti;\n\t\t\t\tconst dy = ( -nly * xc + nlx * yc ) * deti;\n\t\t\t\tif( this.containsCorner_( dx, dy, n, aw * radius ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ) {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst a = 2 * ay / ax;\n\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\tconst az = Math.sqrt( ax * ax + 4 * ay * ay );\n\t\t\t\tconst aw = 2 * ax * ay / (ax + az);\n\t\t\t\tconst radius = this.radius;\n\n\t\t\t\tconst x0 = 0;\n\t\t\t\tconst y0 = ay - aw;\n\t\t\t\tconst x1 = 0;\n\t\t\t\tconst y1 = -ay;\n\t\t\t\tconst x4 = +ax;\n\t\t\t\tconst y4 = +ay;\n\t\t\t\tconst x7 = -x4;\n\t\t\t\tconst y7 = +y4;\n\t\t\t\tconst x10 = x1 + radius * ( x0 - x1 );\n\t\t\t\tconst y10 = y1 + radius * ( y0 - y1 );\n\t\t\t\tconst x11 = x4 + radius * ( x0 - x4 );\n\t\t\t\tconst y11 = y4 + radius * ( y0 - y4 );\n\t\t\t\tconst y12 = +y11;\n\t\t\t\tconst x12 = -x11;\n\n\t\t\t\tconst c0 = -a * x + y10 - y <= 0;\n\t\t\t\tconst c1 = +a * x + y10 - y <= 0;\n\t\t\t\tconst c2 = y <= y11;\n\t\t\t\tconst corner = this.corner;\n\t\t\t\tif( ! c0 && ! c1 && (corner & EShapeCorner.TOP) ) {\n\t\t\t\t\t// Top corner\n\t\t\t\t\tconst rz = ( 0.5 * ( az - aw ) * radius ) / ( az );\n\t\t\t\t\tif( this.containsCorner( x, y, x10, y10, x1, y1, x7, y7, x4, y4, rz, rz, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if( ! c0 && ! c2 && (corner & EShapeCorner.BOTTOM_LEFT) ) {\n\t\t\t\t\t// Bottom-left corner\n\t\t\t\t\tconst ry = ( aw * radius ) / ( 2 * ay );\n\t\t\t\t\tconst rx = ( ry * az ) / ( 2 * ax );\n\t\t\t\t\tif( this.containsCorner( x, y, x12, y12, x7, y7, x4, y4, x1, y1, rx, ry, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if( ! c1 && ! c2 && (corner & EShapeCorner.BOTTOM_RIGHT) ) {\n\t\t\t\t\t// Bottom-right corner\n\t\t\t\t\tconst ry = ( aw * radius ) / ( 2 * ay );\n\t\t\t\t\tconst rx = ( ry * az ) / ( 2 * ax );\n\t\t\t\t\tif( this.containsCorner( x, y, x11, y11, x4, y4, x1, y1, x7, y7, ry, rx, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Others\n\t\t\t\t\tconst fill = this.fill;\n\t\t\t\t\tif( fill.enable ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst stroke = this.stroke;\n\t\t\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\t\t\tconst cy = ay - aw;\n\t\t\t\t\t\t\tconst ay1 = cy + (-ay - cy) * Math.max( 0.0, aw - strokeWidth ) / aw;\n\t\t\t\t\t\t\tconst ay2 = ay - strokeWidth;\n\t\t\t\t\t\t\tif( ! this.containsAbs_( x, y, a, ay1, ay2 ) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeTriangleRounded } from \"./e-shape-triangle-rounded\";\n\nexport class EShapeTriangleRoundeds {\n\tstatic deserialize(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShapeTriangleRounded> | EShapeTriangleRounded {\n\t\treturn EShapeDeserializer.deserialize( item, manager, EShapeTriangleRoundeds.create() );\n\t}\n\n\tstatic create(): EShapeTriangleRounded {\n\t\treturn new EShapeTriangleRounded();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../shape/e-shape-capabilities\";\nimport { EShapeCapability } from \"../shape/e-shape-capability\";\nimport { EShapeDeserializers } from \"../shape/e-shape-deserializers\";\nimport { EShapeType } from \"../shape/e-shape-type\";\nimport { EShapeUploadeds } from \"../shape/e-shape-uploadeds\";\nimport { EShapeTriangleRoundedUploadeds } from \"../shape/variant/e-shape-triangle-rounded-uploadeds\";\nimport { EShapeTriangleRoundeds } from \"../shape/variant/e-shape-triangle-roundeds\";\n\nexport const loadShapeTriangleRounded = () => {\n\tEShapeUploadeds[ EShapeType.TRIANGLE_ROUNDED ] = EShapeTriangleRoundedUploadeds.create;\n\tEShapeDeserializers[ EShapeType.TRIANGLE_ROUNDED ] = EShapeTriangleRoundeds.deserialize;\n\tEShapeCapabilities.set(\n\t\tEShapeType.TRIANGLE_ROUNDED,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadShapeBar } from \"./load-shape-bar\";\nimport { loadShapeCircle } from \"./load-shape-circle\";\nimport { loadShapeGroup } from \"./load-shape-group\";\nimport { loadShapeGroupShadowed } from \"./load-shape-group-shadowed\";\nimport { loadShapeImage } from \"./load-shape-image\";\nimport { loadShapeLabel } from \"./load-shape-label\";\nimport { loadShapeLine } from \"./load-shape-line\";\nimport { loadShapeNull } from \"./load-shape-null\";\nimport { loadShapeRectangle } from \"./load-shape-rectangle\";\nimport { loadShapeRectangleRounded } from \"./load-shape-rectangle-rounded\";\nimport { loadShapeTriangle } from \"./load-shape-triangle\";\nimport { loadShapeTriangleRounded } from \"./load-shape-triangle-rounded\";\n\nexport const loadShapeAll = () => {\n\tloadShapeBar();\n\tloadShapeCircle();\n\tloadShapeGroupShadowed();\n\tloadShapeGroup();\n\tloadShapeImage();\n\tloadShapeLabel();\n\tloadShapeLine();\n\tloadShapeNull();\n\tloadShapeRectangleRounded();\n\tloadShapeRectangle();\n\tloadShapeTriangleRounded();\n\tloadShapeTriangle();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilSvgAtlasBuilder } from \"../../util/util-atlas-builder\";\n\nexport const DThemeWhiteAtlas = new UtilSvgAtlasBuilder( 256, 1, 3 );\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilSvgAtlasBuilder } from \"../../util/util-atlas-builder\";\nimport { DTheme } from \"../d-theme\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\n\ninterface CLASSES {\n\t[ type: string ]: new () => any;\n}\n\ninterface INSTANCES {\n\t[ type: string ]: DTheme;\n}\n\nexport class DThemeWhite implements DTheme {\n\tprotected static _classes: CLASSES = {};\n\tprotected _instances: INSTANCES;\n\n\tconstructor() {\n\t\tthis._instances = {};\n\t}\n\n\tget<THEME>( type: string ): THEME {\n\t\tlet instance = this._instances[ type ] as any;\n\t\tif( instance != null ) {\n\t\t\treturn instance;\n\t\t} else {\n\t\t\tconst klass = DThemeWhite._classes[ type ];\n\t\t\tif( klass != null ) {\n\t\t\t\tinstance = this._instances[ type ] = new klass();\n\t\t\t\treturn instance;\n\t\t\t} else {\n\t\t\t\tthrow new Error( `No theme for the type '${type}'` );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAtlas(): UtilSvgAtlasBuilder {\n\t\treturn DThemeWhiteAtlas;\n\t}\n\n\tstatic set<THEME>( type: string, themeClass: new () => THEME ): void {\n\t\tthis._classes[ type ] = themeClass;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemes } from \"../theme/d-themes\";\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\n\nexport const loadThemeWhite = () => {\n\tDThemes.setDefaultThemeClass( DThemeWhite );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NineSlicePlane, Texture } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DShadow } from \"./d-shadow\";\n\nexport class DShadowImpl extends NineSlicePlane implements DShadow {\n\tprotected _offsetX: number;\n\tprotected _offsetY: number;\n\n\tconstructor( texture: Texture, width: number, height: number, offsetX: number, offsetY: number ) {\n\t\tsuper( texture, width, height, width, height );\n\n\t\tthis._offsetX = offsetX;\n\t\tthis._offsetY = offsetY;\n\n\t\tthis.interactive = false;\n\t\tthis.interactiveChildren = false;\n\n\t\ttexture.on( \"update\", (): void => {\n\t\t\tthis.onTextureUpdate();\n\t\t});\n\t}\n\n\tprotected onTextureUpdate(): void {\n\t\tthis.emit( \"update\", this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tthis.x = -this.leftWidth + this._offsetX;\n\t\tthis.y = -this.topHeight + this._offsetY;\n\t\tthis.width = this.leftWidth + width + this.rightWidth;\n\t\tthis.height = this.topHeight + height + this.bottomHeight;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DThemeWhiteConstants {\n\tstatic HIGHLIGHT_COLOR = 0x3399ff;\n\tstatic HIGHLIGHT_ALPHA = 0.2;\n\tstatic HIGHLIGHT_BLENDED = 0xddeeff; // UtilRgb.brighten( HIGHLIGHT_COLOR, 1 / (1 + HIGHLIGHT_ALPHA) )\n\n\tstatic WEAK_HIGHLIGHT_COLOR = 0xcccccc;\n\tstatic WEAK_HIGHLIGHT_ALPHA = 0.2;\n\tstatic WEAK_HIGHLIGHT_BLENDED = 0xf6f6f6; // UtilRgb.brighten( WEAK_HIGHLIGHT_COLOR, 1 / (1 + WEAK_HIGHLIGHT_ALPHA) );\n\n\tstatic INVALID_COLOR = 0xffaaaa;\n\tstatic INVALID_ALPHA = 0.2;\n\tstatic INVALID_BLENDED = 0xfff0f0;\n\n\tstatic BACKGROUND_COLOR = 0xf2f2f2;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DFontStyle, DFontVariant, DFontWeight, DThemeFont } from \"../../d-font\";\n\nexport class DThemeWhiteFont implements DThemeFont {\n\tgetFontFamilly() {\n\t\treturn `ProximaNova,-apple-system,BlinkMacSystemFont,\"Segoe UI\",Roboto,\"Helvetica Neue\",Arial,sans-serif`;\n\t}\n\n\tgetFontSize(): number {\n\t\treturn 14;\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteFont.getColor( state );\n\t}\n\n\tgetFontWeight(): DFontWeight {\n\t\treturn \"normal\";\n\t}\n\n\tgetFontStyle(): DFontStyle {\n\t\treturn \"normal\";\n\t}\n\n\tgetFontVariant(): DFontVariant {\n\t\treturn \"normal\";\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteFont.getAlpha( state );\n\t}\n\n\tgetLineHeight(): number {\n\t\treturn 30;\n\t}\n\n\tstatic getColor( state: DBaseState ): number {\n\t\treturn 0x5f5f5f;\n\t}\n\n\tstatic getAlpha( state: DBaseState ): number {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn 0.5;\n\t\t} else {\n\t\t\treturn 1.0;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeBase } from \"../../d-base\";\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DLayoutClearType } from \"../../d-layout-clear-type\";\nimport { DShadow } from \"../../d-shadow\";\nimport { DShadowImpl } from \"../../d-shadow-impl\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteFont } from \"./d-theme-white-font\";\n\nconst newShadow = (\n\tid: string,\n\tradius: number = 8, opacity: number = 0.1,\n\tsize: number = radius * 0.125, stdDeviation: number = radius * 0.375\n): void => {\n\tconst d = radius * 2;\n\tDThemeWhiteAtlas.add( id, d, d,\n\t\t`<g>` +\n\t\t\t`<defs>` +\n\t\t\t\t`<filter id=\"${id}_filter\" x=\"0\" y=\"0\" width=\"${d}\" height=\"${d}\" filterUnits=\"userSpaceOnUse\">` +\n\t\t\t\t\t`<feGaussianBlur in=\"SourceAlpha\" stdDeviation=\"${stdDeviation}\"></feGaussianBlur>` +\n\t\t\t\t`</filter>` +\n\t\t\t`</defs>` +\n\t\t\t`<circle cx=\"${radius}\" cy=\"${radius}\" r=\"${size}\" stroke=\"none\" ` +\n\t\t\t\t`fill=\"rgba(0,0,0,${opacity})\" filter=\"url(#${id}_filter)\" />` +\n\t\t`</g>`\n\t);\n};\nnewShadow( \"shadow_weak\", 8, 1 );\nnewShadow( \"shadow\", 12, 1 );\n\nexport class DThemeWhiteBase extends DThemeWhiteFont implements DThemeBase {\n\tgetX(): DCoordinate {\n\t\treturn 0;\n\t}\n\n\tgetY(): DCoordinate {\n\t\treturn 0;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 100;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 100;\n\t}\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isFocused( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetBorderAlpha( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetBorderWidth( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn 0.5;\n\t}\n\n\tgetBorderMask( state: DBaseState ): number {\n\t\treturn DBorderMask.NONE;\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 0;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 0;\n\t}\n\n\tgetPaddingTop(): number {\n\t\treturn 0;\n\t}\n\n\tgetPaddingBottom(): number {\n\t\treturn 0;\n\t}\n\n\tgetCornerRadius(): number {\n\t\treturn 4;\n\t}\n\n\tgetCornerMask(): number {\n\t\treturn DCornerMask.NONE;\n\t}\n\n\tgetOutlineColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetOutlineAlpha( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetOutlineWidth( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetOutlineOffset( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetOutlineAlign( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetOutlineMask( state: DBaseState ): DBorderMask {\n\t\treturn DBorderMask.NONE;\n\t}\n\n\tgetClearType(): DLayoutClearType {\n\t\treturn DLayoutClearType.NONE;\n\t}\n\n\tgetShadow(): DShadow | null {\n\t\treturn null;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.SELF;\n\t}\n\n\tgetTitle(): string {\n\t\treturn \"\";\n\t}\n\n\tgetWeight(): number {\n\t\treturn -1;\n\t}\n\n\tnewShadow(): DShadow | null {\n\t\treturn new DShadowImpl( DThemeWhiteAtlas.mappings.shadow, 12, 12, 0, 6 );\n\t}\n\n\tnewShadowWeak(): DShadow | null {\n\t\treturn new DShadowImpl( DThemeWhiteAtlas.mappings.shadow_weak, 8, 8, 0, 4 );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteBase } from \"../theme/white/d-theme-white-base\";\n\nexport const loadThemeWhiteBase = () => {\n\tDThemeWhite.set( \"DBase\", DThemeWhiteBase );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeBoard } from \"../../d-board\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\n\nexport class DThemeWhiteBoard extends DThemeWhiteBase implements DThemeBoard {\n\tgetBackgroundColor() {\n\t\treturn DThemeWhiteConstants.BACKGROUND_COLOR;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetCornerMask(): number {\n\t\treturn DCornerMask.ALL;\n\t}\n\n\tgetPaddingLeft() {\n\t\treturn 16;\n\t}\n\n\tgetPaddingTop() {\n\t\treturn 16;\n\t}\n\n\tgetPaddingRight() {\n\t\treturn 16;\n\t}\n\n\tgetPaddingBottom() {\n\t\treturn 16;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteBoard } from \"../theme/white/d-theme-white-board\";\n\nexport const loadThemeWhiteBoard = () => {\n\tDThemeWhite.set( \"DBoard\", DThemeWhiteBoard );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignVertical } from \"../../d-align-vertical\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeTextBase } from \"../../d-text-base\";\nimport { utilToString } from \"../../util/util-to-string\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteTextBase extends DThemeWhiteBase implements DThemeTextBase {\n\tgetTextAlignVertical(): DAlignVertical {\n\t\treturn DAlignVertical.MIDDLE;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n\n\tisOverflowMaskEnabled(): boolean {\n\t\treturn false;\n\t}\n\n\tisTextDynamic(): boolean {\n\t\treturn true;\n\t}\n\n\tgetTextStyleClipping(): boolean {\n\t\treturn true;\n\t}\n\n\tnewTextValue(): any {\n\t\treturn \"\";\n\t}\n\n\tgetTextValue( state: DBaseState ): any {\n\t\treturn \"\";\n\t}\n\n\tgetTextFormatter(): ( value: any, caller: any ) => string {\n\t\treturn utilToString;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignVertical } from \"../../d-align-vertical\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeImageBase } from \"../../d-image-base\";\nimport { DThemeWhiteTextBase } from \"./d-theme-white-text-base\";\n\nexport class DThemeWhiteImageBase extends DThemeWhiteTextBase implements DThemeImageBase {\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n\n\tgetImageAlignVertical(): DAlignVertical {\n\t\treturn DAlignVertical.MIDDLE;\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.TEXT;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 5;\n\t}\n\n\tgetImageMarginVertial(): number {\n\t\treturn 5;\n\t}\n\n\tgetImageTintColor( state: DBaseState ): number | null {\n\t\treturn this.getColor( state );\n\t}\n\n\tgetImageTintAlpha( state: DBaseState ): number {\n\t\treturn this.getAlpha( state );\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeButtonBase } from \"../../d-button-base\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteImageBase } from \"./d-theme-white-image-base\";\n\nexport class DThemeWhiteButtonBase extends DThemeWhiteImageBase implements DThemeButtonBase {\n\tCOLOR = 0xffffff;\n\tCOLOR_HOVERED = UtilRgb.darken( this.COLOR, 0.017 );\n\tCOLOR_PRESSED = UtilRgb.darken( this.COLOR, 0.034 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else if( DBaseStates.isPressed( state ) ) {\n\t\t\treturn this.COLOR_PRESSED;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn this.COLOR_HOVERED;\n\t\t} else {\n\t\t\treturn this.COLOR;\n\t\t}\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\tif( DBaseStates.isDisabled( state ) || ! DBaseStates.isActive( state ) ) {\n\t\t\treturn super.getColor( state );\n\t\t} else {\n\t\t\treturn 0xffffff;\n\t\t}\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) || ! DBaseStates.isActive( state ) ) {\n\t\t\treturn 0xe5e5e5;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 100;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n\n\tisToggle(): boolean {\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteButtonBase } from \"./d-theme-white-button-base\";\n\nexport class DThemeWhiteButton extends DThemeWhiteButtonBase implements DThemeWhiteButton {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButton } from \"../theme/white/d-theme-white-button\";\n\nexport const loadThemeWhiteButton = () => {\n\tDThemeWhite.set( \"DButton\", DThemeWhiteButton );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeButtonAmbient } from \"../../d-button-ambient\";\nimport { DThemeWhiteButtonBase } from \"./d-theme-white-button-base\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\n\nexport class DThemeWhiteButtonAmbient extends DThemeWhiteButtonBase implements DThemeButtonAmbient {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else {\n\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t\t}\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\tif( ! DBaseStates.isDisabled( state ) ) {\n\t\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\t\treturn 1.0;\n\t\t\t} else if( DBaseStates.isPressed( state ) ) {\n\t\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_ALPHA * 2;\n\t\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_ALPHA;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonAmbient } from \"../theme/white/d-theme-white-button-ambient\";\n\nexport const loadThemeWhiteButtonAmbient = () => {\n\tDThemeWhite.set( \"DButtonAmbient\", DThemeWhiteButtonAmbient );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeButtonCheck } from \"../../d-button-check\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteButtonAmbient } from \"./d-theme-white-button-ambient\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteFont } from \"./d-theme-white-font\";\n\n// Material Design icons by Google.\n// Apache license version 2.0.\nDThemeWhiteAtlas.add( \"button_check_mark_on\", 21, 21,\n\t`<g transform=\"scale(0.875,0.875)\">` +\n\t\t`<path d=\"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89` +\n\t\t\t`-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z\" fill=\"#fff\" />` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"button_check_mark_off\", 21, 21,\n\t`<g transform=\"scale(0.875,0.875)\">` +\n\t\t`<path d=\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" ` +\n\t\t\t`fill=\"#fff\" />` +\n\t`</g>`\n);\n\nexport class DThemeWhiteButtonCheck extends DThemeWhiteButtonAmbient implements DThemeButtonCheck {\n\treadonly IMAGE_TINT_COLOR_FOCUSED = UtilRgb.darken( DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR, 0.1 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteFont.getColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\tif( ! DBaseStates.isDisabled( state ) ) {\n\t\t\tif( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_ALPHA;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetImageTintColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) || DBaseStates.isReadOnly( state ) || ! DBaseStates.isActive( state ) ) {\n\t\t\tif( DBaseStates.isFocused( state ) ) {\n\t\t\t\treturn this.IMAGE_TINT_COLOR_FOCUSED;\n\t\t\t} else {\n\t\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t\t\t}\n\t\t} else {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t}\n\t}\n\n\tisToggle(): boolean {\n\t\treturn true;\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteAtlas.mappings.button_check_mark_on;\n\t\t} else {\n\t\t\treturn DThemeWhiteAtlas.mappings.button_check_mark_off;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonCheck } from \"../theme/white/d-theme-white-button-check\";\n\nexport const loadThemeWhiteButtonCheck = () => {\n\tDThemeWhite.set( \"DButtonCheck\", DThemeWhiteButtonCheck );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DThemeButtonCheckRight } from \"../../d-button-check-right\";\nimport { DThemeWhiteButtonCheck } from \"./d-theme-white-button-check\";\n\nexport class DThemeWhiteButtonCheckRight extends DThemeWhiteButtonCheck implements DThemeButtonCheckRight {\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.PADDING;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 0;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonCheckRight } from \"../theme/white/d-theme-white-button-check-right\";\n\nexport const loadThemeWhiteButtonCheckRight = () => {\n\tDThemeWhite.set( \"DButtonCheckRight\", DThemeWhiteButtonCheckRight );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DButtonColor, DThemeButtonColor } from \"../../d-button-color\";\nimport { DColorAndAlpha } from \"../../d-color\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\n\n// Material Design icons by Google.\n// Apache license version 2.0.\nDThemeWhiteAtlas.add( \"button_color_sample\", 21, 21,\n\t`<g transform=\"scale(0.875,0.875)\">` +\n\t\t`<path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" fill=\"#fff\"/>` +\n\t\t`<path d=\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" ` +\n\t\t\t`fill=\"#eee\" />` +\n\t`</g>`\n);\n\nconst formatter = ( colorAndAlpha: DColorAndAlpha ): string => {\n\treturn `#${UtilRgb.toCode( colorAndAlpha.color )} A${ colorAndAlpha.alpha.toFixed(2) }`;\n};\n\nexport class DThemeWhiteButtonColor extends DThemeWhiteButton implements DThemeButtonColor {\n\tgetImageTintColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.button_color_sample;\n\t}\n\n\tgetTextFormatter(): ( value: DColorAndAlpha, caller: DButtonColor ) => string {\n\t\treturn formatter;\n\t}\n\n\tnewTextValue(): DColorAndAlpha {\n\t\treturn {\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DAnimation } from \"./d-animation\";\nimport { DAnimationFadeIn } from \"./d-animation-fade-in\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DFocusable } from \"./d-controller-focus\";\nimport { DControllers } from \"./d-controllers\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport enum DDialogCloseOn {\n\tNONE = 0,\n\tESC = 1,\n\tCLICK_OUTSIDE = 2\n}\n\nexport interface DDialogOptions<THEME extends DThemeDialog = DThemeDialog> extends DBaseOptions<THEME> {\n\tcloseOn?: DDialogCloseOn;\n\tanimation?: DAnimation;\n}\n\nexport interface DThemeDialog extends DThemeBase {\n\tcloseOn(): DDialogCloseOn;\n}\n\nexport class DDialog<\n\tTHEME extends DThemeDialog = DThemeDialog,\n\tOPTIONS extends DDialogOptions<THEME> = DDialogOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _animation!: DAnimation;\n\tprotected _closeOn!: DDialogCloseOn;\n\tprotected _focusable!: DFocusable | null;\n\tprotected _isOpened!: boolean;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.visible = false;\n\t\tthis.setState( DBaseState.FOCUS_ROOT, true );\n\t\tthis._focusable = null;\n\t\tthis._isOpened = false;\n\n\t\t// Animation\n\t\tconst animation = this._animation = ( options && options.animation ?\n\t\t\toptions.animation : new DAnimationFadeIn() );\n\t\tanimation.target = this;\n\t\tanimation.on( \"end\", ( isReverse: boolean ): void => {\n\t\t\tthis.onAnimationEnd( isReverse );\n\t\t});\n\n\t\t// Close-on\n\t\tconst closeOn = this._closeOn = ( options && options.closeOn != null ?\n\t\t\toptions.closeOn : this.theme.closeOn()\n\t\t);\n\t\tif( closeOn & DDialogCloseOn.CLICK_OUTSIDE ) {\n\t\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\t\tthis.onCloseOn();\n\t\t\t});\n\t\t}\n\n\t\t// Parent\n\t\tif( options == null || options.parent == null ) {\n\t\t\tDApplications.getInstance().stage.addChild( this );\n\t\t}\n\t}\n\n\tprotected onAnimationEnd( isReverse: boolean ) {\n\t\tif( ! isReverse ) {\n\t\t\tconst focusController = DControllers.getFocusController();\n\t\t\tthis._focusable = focusController.getFocused();\n\t\t\tconst firstFocusable = focusController.findFocusable( this, false, true, true );\n\t\t\tfocusController.setFocused( firstFocusable || this, true, true );\n\t\t}\n\t}\n\n\topen() {\n\t\tif( ! this._isOpened ) {\n\t\t\tthis._isOpened = true;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.addChild( this );\n\t\t\t}\n\t\t\tthis.onOpen();\n\t\t}\n\t}\n\n\tprotected onOpen() {\n\t\tthis.emit( \"open\", this );\n\n\t\t// Animation\n\t\tthis._animation.start();\n\t}\n\n\tisOpened(): boolean {\n\t\treturn this._isOpened;\n\t}\n\n\tclose() {\n\t\tif( this._isOpened ) {\n\t\t\tthis._isOpened = false;\n\t\t\tthis.onClose();\n\t\t}\n\t}\n\n\tprotected onClose() {\n\t\t// Focus\n\t\tconst focusable = this._focusable;\n\t\tif( focusable != null ) {\n\t\t\tthis._focusable = null;\n\t\t\tDControllers.getFocusController().setFocused( focusable, true, false );\n\t\t}\n\n\t\t// Animation\n\t\tthis._animation.start( true );\n\n\t\tthis.emit( \"close\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialog\";\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tconst closeOn = this._closeOn;\n\t\tif( closeOn & DDialogCloseOn.ESC ) {\n\t\t\tif( UtilKeyboardEvent.isCancelKey( e ) ) {\n\t\t\t\tthis.onCloseOn();\n\t\t\t}\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onCloseOn(): void {\n\t\tthis.close();\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn true;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimationOptions } from \"./d-animation\";\nimport { DAnimationBase } from \"./d-animation-base\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\n\nexport interface DAnimationFadeInOptions extends DAnimationOptions {\n\tshift?: {\n\t\tx?: number | null,\n\t\ty?: number | null\n\t};\n}\n\nexport class DAnimationFadeIn extends DAnimationBase {\n\tprotected _shiftX: number;\n\tprotected _shiftY: number;\n\n\tprotected _storedX: number = 0;\n\tprotected _storedY: number = 0;\n\tprotected _storedAlpha: number = 0;\n\tprotected _storedTime: number = 0;\n\tprotected _storedTarget: DBase<any, any> | null = null;\n\n\tprotected _onPrerenderBound: () => void;\n\tprotected _onPostrenderBound: () => void;\n\n\tconstructor( options?: DAnimationFadeInOptions ) {\n\t\tsuper( options );\n\n\t\t// Shifts\n\t\tif( options != null && options.shift != null ) {\n\t\t\tconst shift = options.shift;\n\t\t\tthis._shiftX = (shift.x != null ? shift.x : 0);\n\t\t\tthis._shiftY = (shift.y != null ? shift.y : 15);\n\t\t} else {\n\t\t\tthis._shiftX = 0;\n\t\t\tthis._shiftY = 15;\n\t\t}\n\n\t\tthis._onPrerenderBound = () => {\n\t\t\tthis.onPrerender();\n\t\t};\n\n\t\tthis._onPostrenderBound = () => {\n\t\t\tthis.onPostrender();\n\t\t};\n\t}\n\n\tstop(): void {\n\t\tthis._storedTime = 0;\n\t\tDApplications.getInstance().renderer\n\t\t.off( \"prerender\", this._onPrerenderBound )\n\t\t.off( \"postrender\", this._onPostrenderBound );\n\n\t\tsuper.stop();\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst target = this._storedTarget = this._target;\n\t\tif( target != null ) {\n\t\t\tthis._storedTime = 0;\n\n\t\t\tDApplications.getInstance().renderer\n\t\t\t.on( \"prerender\", this._onPrerenderBound )\n\t\t\t.on( \"postrender\", this._onPostrenderBound );\n\n\t\t\tif( ! isReverse ) {\n\t\t\t\ttarget.visible = true;\n\t\t\t}\n\n\t\t\tsuper.onStart( isReverse );\n\t\t}\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tconst application = DApplications.getInstance();\n\t\t\tapplication.disallowUpdate();\n\t\t\tthis._storedTime = time;\n\t\t\tsuper.onTime( time, isReverse, elapsedTime );\n\t\t\tapplication.allowUpdate();\n\t\t\tapplication.render();\n\t\t}\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tDApplications.getInstance().renderer\n\t\t\t.off( \"prerender\", this._onPrerenderBound )\n\t\t\t.off( \"postrender\", this._onPostrenderBound );\n\n\t\t\tif( isReverse ) {\n\t\t\t\ttarget.visible = false;\n\t\t\t}\n\n\t\t\tsuper.onEnd( isReverse );\n\t\t}\n\t}\n\n\tprotected onPrerender(): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tconst storedTime = this._storedTime;\n\n\t\t\t// Position\n\t\t\tconst position = target.unsafe.position;\n\t\t\tthis._storedX = position.x;\n\t\t\tthis._storedY = position.y;\n\t\t\tposition.set(\n\t\t\t\tposition.x - this._shiftX * ( 1 - storedTime ),\n\t\t\t\tposition.y - this._shiftY * ( 1 - storedTime )\n\t\t\t);\n\n\t\t\t// Alpha\n\t\t\tthis._storedAlpha = target.alpha;\n\t\t\ttarget.alpha = storedTime;\n\t\t}\n\t}\n\n\tprotected onPostrender(): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\t// Position\n\t\t\tconst position = target.unsafe.position;\n\t\t\tposition.set(\n\t\t\t\tthis._storedX,\n\t\t\t\tthis._storedY\n\t\t\t);\n\n\t\t\t// Alpha\n\t\t\ttarget.alpha = this._storedAlpha;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DDialogCloseOn, DThemeDialog } from \"../../d-dialog\";\nimport { DShadow } from \"../../d-shadow\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\n\nexport class DThemeWhiteDialog extends DThemeWhiteBase implements DThemeDialog {\n\tcloseOn(): DDialogCloseOn {\n\t\treturn DDialogCloseOn.ESC | DDialogCloseOn.CLICK_OUTSIDE;\n\t}\n\n\tgetBackgroundColor() {\n\t\treturn DThemeWhiteConstants.BACKGROUND_COLOR;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t}\n\n\tgetPaddingLeft() {\n\t\treturn 16;\n\t}\n\n\tgetPaddingTop() {\n\t\treturn 16;\n\t}\n\n\tgetPaddingRight() {\n\t\treturn 16;\n\t}\n\n\tgetPaddingBottom() {\n\t\treturn 16;\n\t}\n\n\tgetX(): DCoordinate {\n\t\treturn \"center\";\n\t}\n\n\tgetY(): DCoordinate {\n\t\treturn \"center\";\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 400;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetShadow(): DShadow | null {\n\t\treturn this.newShadow();\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogCommand } from \"../../d-dialog-command\";\nimport { DThemeWhiteDialog } from \"./d-theme-white-dialog\";\n\nexport class DThemeWhiteDialogCommand extends DThemeWhiteDialog implements DThemeDialogCommand {\n\tgetOk(): string | null {\n\t\treturn \"OK\";\n\t}\n\n\tgetCancel(): string | null {\n\t\treturn \"Cacnel\";\n\t}\n\n\tgetLayoutX(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetLayoutY(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetLayoutWidth(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetLayoutHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogColor } from \"../../d-dialog-color\";\nimport { DThemeWhiteDialogCommand } from \"./d-theme-white-dialog-command\";\n\nexport class DThemeWhiteDialogColor extends DThemeWhiteDialogCommand implements DThemeDialogColor {\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DColorAndAlpha } from \"../../d-color\";\nimport { DThemePickerColor } from \"../../d-picker-color\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nDThemeWhiteAtlas.add( \"picker_color_main\", 234, 156,\n\t`<g>` +\n\t\t`<linearGradient id=\"fs7w3iusfdnb\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">` +\n\t\t\t`<stop stop-color=\"#FFFFFF\" stop-opacity=\"0\" offset=\"0\"/>` +\n\t\t\t`<stop stop-color=\"#FFFFFF\" stop-opacity=\"1\" offset=\"1\"/>` +\n\t\t`</linearGradient>` +\n\t\t`<linearGradient id=\"2rfcfe9874bw\" x1=\"0%\" y1=\"0%\" x2=\"0%\" y2=\"100%\">` +\n\t\t\t`<stop stop-color=\"#000000\" stop-opacity=\"0\" offset=\"0\"/>` +\n\t\t\t`<stop stop-color=\"#000000\" stop-opacity=\"1\" offset=\"1\"/>` +\n\t\t`</linearGradient>` +\n\t\t`<rect x=\"0\" y=\"0\" width=\"234\" height=\"156\" fill=\"url(#fs7w3iusfdnb)\" />` +\n\t\t`<rect x=\"0\" y=\"0\" width=\"234\" height=\"156\" fill=\"url(#2rfcfe9874bw)\" />` +\n\t`</g>`\n);\n\nconst makeCheckerboard = ( width: number, height: number ): string => {\n\twidth = width + width;\n\n\tconst LIGHT = \"#bfbfbf\";\n\tconst DARK = \"#a5a5a5\";\n\tlet result = \"<g>\";\n\tfor( let iheight = 0; iheight < height; ++iheight ) {\n\t\tfor( let i = 0; i < width; ++i ) {\n\t\t\tconst color = (i % 2 === 0 ? LIGHT : DARK);\n\t\t\tresult += `<rect x=\"${9 * i}\" y=\"${18 * iheight + 0}\" width=\"9\" height=\"9\" fill=\"${color}\" />`;\n\t\t}\n\t\tfor( let i = 0; i < width; ++i ) {\n\t\t\tconst color = (i % 2 === 1 ? LIGHT : DARK);\n\t\t\tresult += `<rect x=\"${9 * i}\" y=\"${18 * iheight + 9}\" width=\"9\" height=\"9\" fill=\"${color}\" />`;\n\t\t}\n\t}\n\tresult += \"</g>\";\n\treturn result;\n};\n\nDThemeWhiteAtlas.add( \"picker_color_alpha_checkerboard\", 234, 18, makeCheckerboard( 13, 1 ) );\n\nDThemeWhiteAtlas.add( \"picker_color_alpha\", 234, 18,\n\t`<g>` +\n\t\t`<linearGradient id=\"s48afbuh44\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">` +\n\t\t\t`<stop stop-color=\"#FFFFFF\" stop-opacity=\"0\" offset=\"0\"/>` +\n\t\t\t`<stop stop-color=\"#FFFFFF\" stop-opacity=\"1\" offset=\"1\"/>` +\n\t\t`</linearGradient>` +\n\t\t`<rect x=\"0\" y=\"0\" width=\"234\" height=\"18\" fill=\"url(#s48afbuh44)\" />` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_base\", 234, 18,\n\t`<g>` +\n\t\t`<linearGradient id=\"ni2rbisdf3\" x1=\"0%\" y1=\"0%\" x2=\"100%\" y2=\"0%\">` +\n\t\t\t`<stop stop-color=\"#FF0000\" offset=\"0\"/>` +\n\t\t\t`<stop stop-color=\"#FFFF00\" offset=\"0.167\"/>` +\n\t\t\t`<stop stop-color=\"#00FF00\" offset=\"0.333\"/>` +\n\t\t\t`<stop stop-color=\"#00FFFF\" offset=\"0.5\"/>` +\n\t\t\t`<stop stop-color=\"#0000FF\" offset=\"0.667\"/>` +\n\t\t\t`<stop stop-color=\"#FF00FF\" offset=\"0.833\"/>` +\n\t\t\t`<stop stop-color=\"#FF0000\" offset=\"1\"/>` +\n\t\t`</linearGradient>` +\n\t\t`<rect x=\"0\" y=\"0\" width=\"234\" height=\"18\" fill=\"url(#ni2rbisdf3)\" />` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_base_pointer\", 16.2, 31.8,\n\t`<rect x=\"4.5\" y=\"4.5\" width=\"7.2\" height=\"22.8\" stroke=\"#5f5f5f\" stroke-width=\"2.4\" fill=\"none\" />`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_pointer\", 25.8, 25.8,\n\t`<circle cx=\"12.9\" cy=\"12.9\" r=\"4.8\" stroke=\"#5f5f5f\" stroke-width=\"2.4\" fill=\"none\" />` +\n\t`<circle cx=\"12.9\" cy=\"12.9\" r=\"7.2\" stroke=\"#ffffff\" stroke-width=\"2.4\" fill=\"none\" />`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_recent_checkerboard\", 18, 18, makeCheckerboard( 1, 1 ) );\n\nDThemeWhiteAtlas.add( \"picker_color_recent_null\", 18, 18,\n\t`<g>` +\n\t\t`<rect x=\"1.2\" y=\"1.2\" width=\"15.6\" height=\"15.6\" stroke=\"#fff\" stroke-width=\"0.8\" fill=\"none\" />` +\n\t\t`<line x1=\"16.8\" y1=\"1.2\" x2=\"1.2\" y2=\"16.8\" stroke=\"#fff\" stroke-width=\"0.8\" stroke-linecap=\"round\" />` +\n\t\t`<line x1=\"1.2\" y1=\"1.2\" x2=\"16.8\" y2=\"16.8\" stroke=\"#fff\" stroke-width=\"0.8\" stroke-linecap=\"round\" />` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_sample_checkerboard\", 54, 54, makeCheckerboard( 3, 3 ) );\n\nDThemeWhiteAtlas.add( \"picker_color_sample_null\", 54, 54,\n\t`<g>` +\n\t\t`<rect x=\"3.6\" y=\"3.6\" width=\"46.8\" height=\"46.8\" stroke=\"#fff\" stroke-width=\"2.4\" fill=\"none\" />` +\n\t\t`<line x1=\"50.4\" y1=\"3.6\" x2=\"3.6\" y2=\"50.4\" stroke=\"#fff\" stroke-width=\"2.4\" stroke-linecap=\"round\" />` +\n\t\t`<line x1=\"3.6\" y1=\"3.6\" x2=\"50.4\" y2=\"50.4\" stroke=\"#fff\" stroke-width=\"2.4\" stroke-linecap=\"round\" />` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_anchor_outlined\", 25.8, 25.8,\n\t`<circle cx=\"12.9\" cy=\"12.9\" r=\"8.4\" stroke=\"none\" fill=\"#ffffff\" />` +\n\t`<circle cx=\"12.9\" cy=\"12.9\" r=\"9.6\" stroke=\"#5f5f5f\" stroke-width=\"2.4\" fill=\"none\" />`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_anchor\", 28.2, 28.2,\n\t`<circle cx=\"14.1\" cy=\"14.1\" r=\"6\" stroke=\"none\" fill=\"#ffffff\" />` +\n\t`<circle cx=\"14.1\" cy=\"14.1\" r=\"7.2\" stroke=\"#5f5f5f\" stroke-width=\"2.4\" fill=\"none\" />`\n);\n\nDThemeWhiteAtlas.add( \"picker_color_direction\", 12, 30,\n\t`<path d=\"M0.6 25.8 L 12.0375 5.9895\" stroke=\"#5f5f5f\" stroke-width=\"1.2\" fill=\"none\" />` +\n\t`<path d=\"M8.5125 25.8 A 8.475 8.475 0 0 0 4.275 18.4605\" stroke=\"#5f5f5f\" stroke-width=\"1.2\" fill=\"none\" />` +\n\t`<rect x=\"0.6\" y=\"24.6\" width=\"11.4375\" height=\"1.2\" rx=\"0.6\" ry=\"0.6\" stroke=\"none\" fill=\"#5f5f5f\" />`\n);\n\nexport class DThemeWhitePickerColor extends DThemeWhiteBase implements DThemePickerColor {\n\tgetMainWidth(): number {\n\t\treturn 234;\n\t}\n\n\tgetMainHeight(): number {\n\t\treturn 156;\n\t}\n\n\tgetMainTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_main;\n\t}\n\n\tgetMainPointerTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_pointer;\n\t}\n\n\tgetMainPointerColor(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tgetMainPointerAlpha(): number {\n\t\treturn 1;\n\t}\n\n\tgetBaseHeight(): number {\n\t\treturn 18;\n\t}\n\n\tgetBaseMargin(): number {\n\t\treturn 6;\n\t}\n\n\tgetBaseTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_base;\n\t}\n\n\tgetBasePointerTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_base_pointer;\n\t}\n\n\tgetBasePointerColor(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tgetBasePointerAlpha(): number {\n\t\treturn this.getMainPointerAlpha();\n\t}\n\n\tgetAlphaHeight(): number {\n\t\treturn this.getBaseHeight();\n\t}\n\n\tgetAlphaMargin(): number {\n\t\treturn this.getBaseMargin();\n\t}\n\n\tgetAlphaTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_alpha;\n\t}\n\n\tgetAlphaCheckerboardTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_alpha_checkerboard;\n\t}\n\n\tgetAlphaPointerTexture(): Texture {\n\t\treturn this.getBasePointerTexture();\n\t}\n\n\tgetAlphaPointerColor(): number {\n\t\treturn this.getBasePointerColor();\n\t}\n\n\tgetAlphaPointerAlpha(): number {\n\t\treturn this.getMainPointerAlpha();\n\t}\n\n\tgetRecentMargin(): number {\n\t\treturn this.getBaseMargin();\n\t}\n\n\tgetRecentColorWidth(): number {\n\t\treturn this.getBaseHeight();\n\t}\n\n\tgetRecentColorHeight(): number {\n\t\treturn this.getRecentColorWidth();\n\t}\n\n\tgetRecentColorMargin(): number {\n\t\treturn this.getRecentMargin();\n\t}\n\n\tgetRecentColorCount(): number {\n\t\treturn 10;\n\t}\n\n\tgetRecentCheckerboardTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_recent_checkerboard;\n\t}\n\n\tgetRecentNullTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_recent_null;\n\t}\n\n\tgetRecents(): DColorAndAlpha[] {\n\t\treturn [];\n\t}\n\n\tgetInputMargin(): number {\n\t\treturn this.getBaseMargin();\n\t}\n\n\tgetInputLabelWidth(): number {\n\t\treturn 20;\n\t}\n\n\tgetSampleWidth(): number {\n\t\treturn 54;\n\t}\n\n\tgetSampleHeight(): number {\n\t\treturn this.getSampleWidth();\n\t}\n\n\tgetSampleCheckerboardTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_sample_checkerboard;\n\t}\n\n\tgetSampleNullTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_sample_null;\n\t}\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhitePickerColor } from \"../theme/white/d-theme-white-picker-color\";\n\nexport const loadThemeWhitePickerColor = () => {\n\tDThemeWhite.set( \"DPickerColor\", DThemeWhitePickerColor );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogColor } from \"../theme/white/d-theme-white-dialog-color\";\nimport { loadThemeWhitePickerColor } from \"./load-theme-white-picker-color\";\n\nexport const loadThemeWhiteDialogColor = () => {\n\tDThemeWhite.set( \"DDialogColor\", DThemeWhiteDialogColor );\n\tloadThemeWhitePickerColor();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonColor } from \"../theme/white/d-theme-white-button-color\";\nimport { loadThemeWhiteDialogColor } from \"./load-theme-white-dialog-color\";\n\nexport const loadThemeWhiteButtonColor = () => {\n\tDThemeWhite.set( \"DButtonColor\", DThemeWhiteButtonColor );\n\tloadThemeWhiteDialogColor();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\ntype Callback = ( target: DPickerColorGradientPoint ) => void;\n\nexport interface DPickerColorGradientPointLike {\n\tcolor: number;\n\talpha: number;\n\tposition: number;\n}\n\nexport class DPickerColorGradientPoint implements DPickerColorGradientPointLike {\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _position: number;\n\tprotected _callback: Callback;\n\tprotected _selected: boolean;\n\n\tconstructor( color: number, alpha: number, position: number, selected: boolean, callback: Callback ) {\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._position = position;\n\t\tthis._callback = callback;\n\t\tthis._selected = selected;\n\t}\n\n\tset( color: number, alpha: number, position: number, selected: boolean ) {\n\t\tif( this._color !== color || this._alpha !== alpha || this._position !== position || this._selected !== selected ) {\n\t\t\tthis._color = color;\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._position = position;\n\t\t\tthis._selected = selected;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget color() {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget alpha() {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget position() {\n\t\treturn this._position;\n\t}\n\n\tset position( position: number ) {\n\t\tif( this._position !== position ) {\n\t\t\tthis._position = position;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget selected() {\n\t\treturn this._selected;\n\t}\n\n\tset selected( selected: boolean ) {\n\t\tif( this._selected !== selected ) {\n\t\t\tthis._selected = selected;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\ttoObject(): DPickerColorGradientPointLike {\n\t\treturn {\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\tposition: this._position\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DPickerColorGradientPoint, DPickerColorGradientPointLike } from \"./d-picker-color-gradient-point\";\n\nconst POINT_SORTER = ( a: DPickerColorGradientPoint, b: DPickerColorGradientPoint ): number => {\n\treturn a.position - b.position;\n};\n\nexport interface DPickerColorGradientDataLike {\n\tpoints: DPickerColorGradientPointLike[];\n\tdirection: number;\n}\n\nexport class DPickerColorGradientData extends utils.EventEmitter {\n\tprotected _points: DPickerColorGradientPoint[];\n\tprotected _direction: number;\n\tprotected _selected: DPickerColorGradientPoint | null;\n\n\tprotected _onChangeBound: ( target: DPickerColorGradientPoint ) => void;\n\tprotected _workColor: number[];\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._onChangeBound = ( target: DPickerColorGradientPoint ): void => {\n\t\t\tthis.onChange( target );\n\t\t};\n\n\t\tconst first = new DPickerColorGradientPoint( 0xffffff, 1, 0, false, this._onChangeBound );\n\t\tconst second = new DPickerColorGradientPoint( 0x808080, 1, 1, true, this._onChangeBound );\n\t\tthis._points = [ first, second ];\n\t\tthis._direction = -90;\n\t\tthis._selected = second;\n\t\tthis._workColor = [ 0, 0, 0 ];\n\t}\n\n\tprotected onChange( target: DPickerColorGradientPoint ): void {\n\t\tconst isSelectionChanged = ( target.selected && this._selected !== target );\n\t\tif( isSelectionChanged ) {\n\t\t\tconst selected = this._selected;\n\t\t\tif( selected != null ) {\n\t\t\t\t(selected as any)._selected = false;\n\t\t\t}\n\t\t\tthis._selected = target;\n\t\t}\n\t\tthis._points.sort( POINT_SORTER );\n\t\tif( isSelectionChanged ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tget points(): DPickerColorGradientPoint[] {\n\t\treturn this._points;\n\t}\n\n\tget direction(): number {\n\t\treturn this._direction;\n\t}\n\n\tset direction( direction: number ) {\n\t\tif( this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tthis.emit( \"directionchange\", direction, this );\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tget selected(): DPickerColorGradientPoint | null {\n\t\treturn this._selected;\n\t}\n\n\tsize(): number {\n\t\treturn this._points.length;\n\t}\n\n\tget( index: number ): DPickerColorGradientPoint | null {\n\t\tconst points = this._points;\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\treturn points[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\taddAt( position: number ): DPickerColorGradientPoint {\n\t\tconst points = this._points;\n\t\tlet previous: DPickerColorGradientPoint | null = null;\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tconst point = points[ i ];\n\t\t\tif( position <= point.position ) {\n\t\t\t\tif( previous != null ) {\n\t\t\t\t\tconst span = point.position - previous.position;\n\t\t\t\t\tif( 0.001 < span ) {\n\t\t\t\t\t\tconst rgb0 = utils.hex2rgb( point.color, this._workColor );\n\t\t\t\t\t\tconst r0 = rgb0[ 0 ];\n\t\t\t\t\t\tconst g0 = rgb0[ 1 ];\n\t\t\t\t\t\tconst b0 = rgb0[ 2 ];\n\n\t\t\t\t\t\tconst rgb1 = utils.hex2rgb( previous.color, this._workColor );\n\t\t\t\t\t\tconst r1 = rgb1[ 0 ];\n\t\t\t\t\t\tconst g1 = rgb1[ 1 ];\n\t\t\t\t\t\tconst b1 = rgb1[ 2 ];\n\n\t\t\t\t\t\tconst ratio = (position - previous.position) / span;\n\t\t\t\t\t\tconst r = r0 * ratio + r1 * (1 - ratio);\n\t\t\t\t\t\tconst g = g0 * ratio + g1 * (1 - ratio);\n\t\t\t\t\t\tconst b = b0 * ratio + b1 * (1 - ratio);\n\n\t\t\t\t\t\tconst rgb = this._workColor;\n\t\t\t\t\t\trgb[ 0 ] = r;\n\t\t\t\t\t\trgb[ 1 ] = g;\n\t\t\t\t\t\trgb[ 2 ] = b;\n\n\t\t\t\t\t\tconst color = utils.rgb2hex( rgb );\n\t\t\t\t\t\tconst alpha = point.alpha * ratio + previous.alpha * (1 - ratio);\n\t\t\t\t\t\treturn this.add( color, alpha, position, true );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn this.add( point.color, point.alpha, position, true );\n\t\t\t\t}\n\t\t\t}\n\t\t\tprevious = point;\n\t\t}\n\t\tif( previous != null ) {\n\t\t\treturn this.add( previous.color, previous.alpha, position, true );\n\t\t} else {\n\t\t\treturn this.add( 0xffffff, 1.0, position, true );\n\t\t}\n\t}\n\n\tadd( color: number, alpha: number, position: number, selected: boolean ): DPickerColorGradientPoint {\n\t\tconst result = new DPickerColorGradientPoint( color, alpha, position, selected, this._onChangeBound );\n\t\tthis._points.push( result );\n\t\tthis._onChangeBound( result );\n\t\treturn result;\n\t}\n\n\tremove( point: DPickerColorGradientPoint ): boolean {\n\t\tconst points = this._points;\n\t\tif( 2 < points.length ) {\n\t\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\t\tif( points[ i ] === point ) {\n\t\t\t\t\tpoints.splice( i, 1 );\n\t\t\t\t\tconst isSelectionChanged = ( this._selected === point );\n\t\t\t\t\tif( isSelectionChanged ) {\n\t\t\t\t\t\tif( i + 1 < imax ) {\n\t\t\t\t\t\t\tthis._selected = points[ i ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._selected = points[ i - 1 ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( isSelectionChanged ) {\n\t\t\t\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\treset(): void {\n\t\tconst oldDirection = this._direction;\n\t\tthis._direction = -90;\n\n\t\tconst points = this._points;\n\t\tconst oldSelected = this._selected;\n\t\tconst index = ( oldSelected ? points.indexOf( oldSelected ) : -1 );\n\t\tpoints.length = 0;\n\t\tpoints.push( new DPickerColorGradientPoint( 0xffffff, 0, 0, false, this._onChangeBound ) );\n\t\tpoints.push( new DPickerColorGradientPoint( 0xffffff, 0, 1, false, this._onChangeBound ) );\n\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\tconst point = points[ index ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else if( 0 < points.length ) {\n\t\t\tconst point = points[ points.length - 1 ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else {\n\t\t\tthis._selected = null;\n\t\t}\n\t\tif( oldSelected !== this._selected ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\n\t\tif( oldDirection !== this._direction ) {\n\t\t\tthis.emit( \"directionchange\", this._direction, this );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t}\n\n\ttoObject(): DPickerColorGradientDataLike {\n\t\tconst pointsCopy = [];\n\t\tconst points = this._points;\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tpointsCopy.push( points[ i ].toObject() );\n\t\t}\n\t\treturn {\n\t\t\tpoints: pointsCopy,\n\t\t\tdirection: this._direction\n\t\t};\n\t}\n\n\tfromObject( data: DPickerColorGradientDataLike ): void {\n\t\tconst oldDirection = this._direction;\n\t\tthis._direction = data.direction;\n\n\t\tconst points = this._points;\n\t\tconst oldSelected = this._selected;\n\t\tconst index = ( oldSelected ? points.indexOf( oldSelected ) : -1 );\n\t\tpoints.length = 0;\n\t\tfor( let i = 0, imax = data.points.length; i < imax; ++i ) {\n\t\t\tconst pointLike = data.points[ i ];\n\t\t\tconst point = new DPickerColorGradientPoint(\n\t\t\t\tpointLike.color, pointLike.alpha, pointLike.position,\n\t\t\t\tfalse, this._onChangeBound\n\t\t\t);\n\t\t\tpoints.push( point );\n\t\t}\n\t\tpoints.sort( POINT_SORTER );\n\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\tconst point = points[ index ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else if( 0 < points.length ) {\n\t\t\tconst point = points[ points.length - 1 ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else {\n\t\t\tthis._selected = null;\n\t\t}\n\t\tif( oldSelected !== this._selected ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\n\t\tif( oldDirection !== this._direction ) {\n\t\t\tthis.emit( \"directionchange\", this._direction, this );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DButtonColorGradient, DThemeButtonColorGradient } from \"../../d-button-color-gradient\";\nimport { DPickerColorGradientData } from \"../../d-picker-color-gradient-data\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\n\n// Material Design icons by Google.\n// Apache license version 2.0.\nDThemeWhiteAtlas.add( \"button_color_gradient_sample\", 21, 21,\n\t`<g transform=\"scale(0.875,0.875)\">` +\n\t\t`<path d=\"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" fill=\"#fff\"/>` +\n\t\t`<path d=\"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z\" ` +\n\t\t\t`fill=\"#eee\" />` +\n\t`</g>`\n);\n\nconst formatter = (): string => {\n\treturn \"\";\n};\n\nexport class DThemeWhiteButtonColorGradient extends DThemeWhiteButton implements DThemeButtonColorGradient {\n\tgetViewBaseTexture(): Texture | null {\n\t\treturn DThemeWhiteAtlas.mappings.button_color_gradient_sample;\n\t}\n\n\tgetTextFormatter(): ( value: DPickerColorGradientData, caller: DButtonColorGradient ) => string {\n\t\treturn formatter;\n\t}\n\n\tnewTextValue(): DPickerColorGradientData {\n\t\treturn new DPickerColorGradientData();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DPickerDatetimeMask {\n\tNONE = 0,\n\tDATE = 1,\n\tHOURS = 2,\n\tMINUTES = 4,\n\tSECONDS = 8,\n\tALL = DATE | HOURS | MINUTES | SECONDS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogColorGradient } from \"../../d-dialog-color-gradient\";\nimport { DThemeWhiteDialogCommand } from \"./d-theme-white-dialog-command\";\n\nexport class DThemeWhiteDialogColorGradient extends DThemeWhiteDialogCommand implements DThemeDialogColorGradient {\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemePickerColorGradient } from \"../../d-picker-color-gradient\";\nimport { DPickerColorGradientDataLike } from \"../../d-picker-color-gradient-data\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhitePickerColorGradient extends DThemeWhiteBase implements DThemePickerColorGradient {\n\tgetGradientPointsWidth(): number {\n\t\treturn 30;\n\t}\n\n\tgetGradientPointsMargin(): number {\n\t\treturn 24;\n\t}\n\n\tgetGradientAnchorTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_anchor;\n\t}\n\n\tgetGradientAnchorOutlinedTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_anchor_outlined;\n\t}\n\n\tgetGradientAnchorOutlineTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_anchor_outline;\n\t}\n\n\tgetGradientDirectionMargin(): number {\n\t\treturn 5;\n\t}\n\n\tgetGradientDirectionTexture(): Texture {\n\t\treturn DThemeWhiteAtlas.mappings.picker_color_direction;\n\t}\n\n\tgetGradientRecentColumn(): number {\n\t\treturn 4;\n\t}\n\n\tgetGradientRecentWidth(): number {\n\t\treturn 30;\n\t}\n\n\tgetGradientRecentMargin(): number {\n\t\treturn 5;\n\t}\n\n\tgetGradientRecentCount(): number {\n\t\treturn 16;\n\t}\n\n\tgetGradientRecents(): DPickerColorGradientDataLike[] {\n\t\treturn [];\n\t}\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhitePickerColorGradient } from \"../theme/white/d-theme-white-picker-color-gradient\";\nimport { loadThemeWhitePickerColor } from \"./load-theme-white-picker-color\";\n\nexport const loadThemeWhitePickerColorGradient = () => {\n\tDThemeWhite.set( \"DPickerColorGradient\", DThemeWhitePickerColorGradient );\n\tloadThemeWhitePickerColor();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogColorGradient } from \"../theme/white/d-theme-white-dialog-color-gradient\";\nimport { loadThemeWhitePickerColorGradient } from \"./load-theme-white-picker-color-gradient\";\n\nexport const loadThemeWhiteDialogColorGradient = () => {\n\tDThemeWhite.set( \"DDialogColorGradient\", DThemeWhiteDialogColorGradient );\n\tloadThemeWhitePickerColorGradient();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonColorGradient } from \"../theme/white/d-theme-white-button-color-gradient\";\nimport { loadThemeWhiteDialogColorGradient } from \"./load-theme-white-dialog-color-gradient\";\n\nexport const loadThemeWhiteButtonColorGradient = () => {\n\tDThemeWhite.set( \"DButtonColorGradient\", DThemeWhiteButtonColorGradient );\n\tloadThemeWhiteDialogColorGradient();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteButtonBase } from \"./d-theme-white-button-base\";\n\nexport class DThemeWhiteButtonDanger extends DThemeWhiteButtonBase {\n\tCOLOR = 0xff5566;\n\tCOLOR_HOVERED = UtilRgb.darken( this.COLOR, 0.1 );\n\tCOLOR_PRESSED = UtilRgb.darken( this.COLOR, 0.2 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isPressed( state ) || DBaseStates.isActive( state ) ) {\n\t\t\treturn this.COLOR_PRESSED;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn this.COLOR_HOVERED;\n\t\t} else {\n\t\t\treturn this.COLOR;\n\t\t}\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn 0xe5e5e5;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn super.getColor( state );\n\t\t} else {\n\t\t\treturn 0xffffff;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonDanger } from \"../theme/white/d-theme-white-button-danger\";\n\nexport const loadThemeWhiteButtonDanger = () => {\n\tDThemeWhite.set( \"DButtonDanger\", DThemeWhiteButtonDanger );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utilPad } from \"./util/util-pad\";\n\nexport class DPickerDates {\n\tstatic format( date: Date ): string {\n\t\tconst y = utilPad( String( date.getFullYear() ), 4, \"0\" );\n\t\tconst M = utilPad( String( date.getMonth() + 1 ), 2, \"0\");\n\t\tconst S = utilPad( String( date.getDate() ), 2, \"0\" );\n\t\treturn `${y}/${M}/${S}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonDate, DThemeButtonDate } from \"../../d-button-date\";\nimport { DPickerDates } from \"../../d-picker-dates\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\n\nconst formatter = ( value: Date ): string => {\n\treturn DPickerDates.format( value );\n};\n\nexport class DThemeWhiteButtonDate extends DThemeWhiteButton implements DThemeButtonDate {\n\tgetTextFormatter(): ( value: Date, caller: DButtonDate ) => string {\n\t\treturn formatter;\n\t}\n\n\tnewTextValue(): Date {\n\t\treturn new Date();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogDate } from \"../../d-dialog-date\";\nimport { DThemeWhiteDialogCommand } from \"./d-theme-white-dialog-command\";\n\nexport class DThemeWhiteDialogDate extends DThemeWhiteDialogCommand implements DThemeDialogDate {\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DInputIntegerOptions } from \"../../d-input-integer\";\nimport { DPickerDatetimeMask } from \"../../d-picker-datetime-mask\";\nimport { DThemePickerTime } from \"../../d-picker-time\";\nimport { DPickerTimeBoundDate } from \"../../d-picker-time-bound\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhitePickerTime extends DThemeWhiteBase implements DThemePickerTime {\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 8;\n\t}\n\n\tgetHoursOptions(): DInputIntegerOptions {\n\t\treturn {\n\t\t\twidth: 100,\n\t\t\ttitle: \"Hours\"\n\t\t};\n\t}\n\n\tgetMinutesOptions(): DInputIntegerOptions {\n\t\treturn {\n\t\t\twidth: 100,\n\t\t\ttitle: \"Minutes\"\n\t\t};\n\t}\n\n\tgetSecondsOptions(): DInputIntegerOptions {\n\t\treturn {\n\t\t\twidth: 100,\n\t\t\ttitle: \"Seconds\"\n\t\t};\n\t}\n\n\tgetMask(): DPickerDatetimeMask {\n\t\treturn DPickerDatetimeMask.HOURS | DPickerDatetimeMask.MINUTES;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLowerBound(): DPickerTimeBoundDate {\n\t\treturn null;\n\t}\n\n\tisLowerBoundInclusive(): boolean {\n\t\treturn false;\n\t}\n\n\tgetUpperBound(): DPickerTimeBoundDate {\n\t\treturn null;\n\t}\n\n\tisUpperBoundInclusive(): boolean {\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDPickerDatetimeDateDecorator, DPickerDatetimeDayLabels,\n\tDPickerDatetimeLabelFormatter, DThemePickerDatetime\n} from \"../../d-picker-datetime\";\nimport { DPickerDatetimeButtonBackOptions } from \"../../d-picker-datetime-button-back\";\nimport { DPickerDatetimeButtonNextOptions } from \"../../d-picker-datetime-button-next\";\nimport { DPickerDatetimeMask } from \"../../d-picker-datetime-mask\";\nimport { DThemeWhitePickerTime } from \"./d-theme-white-picker-time\";\n\nconst MONTH_LABELS = [\n\t\"January\",\n\t\"February\",\n\t\"March\",\n\t\"April\",\n\t\"May\",\n\t\"June\",\n\t\"July\",\n\t\"August\",\n\t\"September\",\n\t\"October\",\n\t\"November\",\n\t\"December\"\n];\n\nconst DAY_LABELS: DPickerDatetimeDayLabels = [\n\t\"Su\",\n\t\"Mo\",\n\t\"Tu\",\n\t\"We\",\n\t\"Th\",\n\t\"Fr\",\n\t\"Sa\"\n];\n\nconst defaultLabelFormatter = ( date: Date ): string => {\n\treturn `${MONTH_LABELS[ date.getMonth() ]} ${date.getFullYear()}`;\n};\n\nconst defaultDateDecorator = (): void => { /* DO NOTHING*/ };\n\nexport class DThemeWhitePickerDatetime extends DThemeWhitePickerTime implements DThemePickerDatetime {\n\tgetDayLabels(): DPickerDatetimeDayLabels {\n\t\treturn DAY_LABELS;\n\t}\n\n\tgetDayStart(): number {\n\t\treturn 0;\n\t}\n\n\tgetLabelFormatter(): DPickerDatetimeLabelFormatter {\n\t\treturn defaultLabelFormatter;\n\t}\n\n\tgetDateDecorator(): DPickerDatetimeDateDecorator {\n\t\treturn defaultDateDecorator;\n\t}\n\n\tgetBackButtonOptions(): DPickerDatetimeButtonBackOptions | null {\n\t\treturn {\n\t\t\ttitle: \"Previous\"\n\t\t};\n\t}\n\n\tgetNextButtonOptions(): DPickerDatetimeButtonNextOptions | null {\n\t\treturn {\n\t\t\ttitle: \"Next\"\n\t\t};\n\t}\n\n\tgetMask(): DPickerDatetimeMask {\n\t\treturn DPickerDatetimeMask.DATE | super.getMask();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemePickerDate } from \"../../d-picker-date\";\nimport { DPickerDatetimeMask } from \"../../d-picker-datetime-mask\";\nimport { DThemeWhitePickerDatetime } from \"./d-theme-white-picker-datetime\";\n\nexport class DThemeWhitePickerDate extends DThemeWhitePickerDatetime implements DThemePickerDate {\n\tgetMask(): DPickerDatetimeMask {\n\t\treturn DPickerDatetimeMask.DATE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemePickerDatetimeButtonBack } from \"../../d-picker-datetime-button-back\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteButtonAmbient } from \"./d-theme-white-button-ambient\";\n\nDThemeWhiteAtlas.add( \"picker_date_back\", 24, 24,\n\t`<g>` +\n\t\t`<path d=\"M15.41 7.41L14 6l-6 6 6 6 1.41-1.41L10.83 12z\" fill=\"#fff\" />` +\n\t`</g>`\n);\n\nexport class DThemeWhitePickerDatetimeButtonBack\n\textends DThemeWhiteButtonAmbient implements DThemePickerDatetimeButtonBack {\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.PADDING;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 0;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\treturn DThemeWhiteAtlas.mappings.picker_date_back;\n\t}\n\n\tgetColor(): number {\n\t\treturn 0x6f6f6f;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemePickerDatetimeButtonDate } from \"../../d-picker-datetime-button-date\";\nimport { DThemeWhiteButtonAmbient } from \"./d-theme-white-button-ambient\";\n\nexport class DThemeWhitePickerDatetimeButtonDate extends DThemeWhiteButtonAmbient\n\timplements DThemePickerDatetimeButtonDate {\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n\n\tgetTextStyleClipping(): boolean {\n\t\treturn false;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tisToggle(): boolean {\n\t\treturn true;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemePickerDatetimeButtonNext } from \"../../d-picker-datetime-button-next\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteButtonAmbient } from \"./d-theme-white-button-ambient\";\n\nDThemeWhiteAtlas.add( \"picker_date_next\", 24, 24,\n\t`<g>` +\n\t\t`<path d=\"M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z\" fill=\"#fff\" />` +\n\t`</g>`\n);\n\nexport class DThemeWhitePickerDatetimeButtonNext\n\textends DThemeWhiteButtonAmbient implements DThemePickerDatetimeButtonNext {\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.PADDING;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 0;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\treturn DThemeWhiteAtlas.mappings.picker_date_next;\n\t}\n\n\tgetColor(): number {\n\t\treturn 0x6f6f6f;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeWhiteTextBase } from \"./d-theme-white-text-base\";\n\nexport class DThemeWhiteText extends DThemeWhiteTextBase {\n\tgetHeight(): DCoordinate {\n\t\treturn this.getLineHeight();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DFontWeight } from \"../../d-font\";\nimport { DThemePickerDatetimeLabel } from \"../../d-picker-datetime-label\";\nimport { DThemeWhiteText } from \"./d-theme-white-text\";\n\nexport class DThemeWhitePickerDatetimeLabel extends DThemeWhiteText implements DThemePickerDatetimeLabel {\n\tgetWidth(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetTextStyleClipping(): boolean {\n\t\treturn false;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n\n\tgetColor(): number {\n\t\treturn 0x6f6f6f;\n\t}\n\n\tgetFontWeight(): DFontWeight {\n\t\treturn \"bold\";\n\t}\n\n\tgetFontSize(): number {\n\t\treturn Math.round( super.getFontSize() * 1.25 );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DFontWeight } from \"../../d-font\";\nimport { DThemePickerDatetimeLabelDate } from \"../../d-picker-datetime-label-date\";\nimport { DThemeWhiteText } from \"./d-theme-white-text\";\n\nexport class DThemeWhitePickerDatetimeLabelDate extends DThemeWhiteText implements DThemePickerDatetimeLabelDate {\n\tgetWidth(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetTextStyleClipping(): boolean {\n\t\treturn false;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n\n\tgetColor(): number {\n\t\treturn 0x6f6f6f;\n\t}\n\n\tgetFontWeight(): DFontWeight {\n\t\treturn \"bold\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemePickerDatetimeSpace } from \"../../d-picker-datetime-space\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhitePickerDatetimeSpace extends DThemeWhiteBase implements DThemePickerDatetimeSpace {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhitePickerTime } from \"../theme/white/d-theme-white-picker-time\";\n\nexport const loadThemeWhitePickerTime = () => {\n\tDThemeWhite.set( \"DPickerTime\", DThemeWhitePickerTime );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhitePickerDatetime } from \"../theme/white/d-theme-white-picker-datetime\";\nimport { DThemeWhitePickerDatetimeButtonBack } from \"../theme/white/d-theme-white-picker-datetime-button-back\";\nimport { DThemeWhitePickerDatetimeButtonDate } from \"../theme/white/d-theme-white-picker-datetime-button-date\";\nimport { DThemeWhitePickerDatetimeButtonNext } from \"../theme/white/d-theme-white-picker-datetime-button-next\";\nimport { DThemeWhitePickerDatetimeLabel } from \"../theme/white/d-theme-white-picker-datetime-label\";\nimport { DThemeWhitePickerDatetimeLabelDate } from \"../theme/white/d-theme-white-picker-datetime-label-date\";\nimport { DThemeWhitePickerDatetimeSpace } from \"../theme/white/d-theme-white-picker-datetime-space\";\nimport { loadThemeWhitePickerTime } from \"./load-theme-white-picker-time\";\n\nexport const loadThemeWhitePickerDatetime = () => {\n\tDThemeWhite.set( \"DPickerDatetimeButtonBack\", DThemeWhitePickerDatetimeButtonBack );\n\tDThemeWhite.set( \"DPickerDatetimeButtonDate\", DThemeWhitePickerDatetimeButtonDate );\n\tDThemeWhite.set( \"DPickerDatetimeButtonNext\", DThemeWhitePickerDatetimeButtonNext );\n\tDThemeWhite.set( \"DPickerDatetimeLabelDate\", DThemeWhitePickerDatetimeLabelDate );\n\tDThemeWhite.set( \"DPickerDatetimeLabel\", DThemeWhitePickerDatetimeLabel );\n\tDThemeWhite.set( \"DPickerDatetimeSpace\", DThemeWhitePickerDatetimeSpace );\n\tDThemeWhite.set( \"DPickerDatetime\", DThemeWhitePickerDatetime );\n\tloadThemeWhitePickerTime();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhitePickerDate } from \"../theme/white/d-theme-white-picker-date\";\nimport { loadThemeWhitePickerDatetime } from \"./load-theme-white-picker-datetime\";\n\nexport const loadThemeWhitePickerDate = () => {\n\tDThemeWhite.set( \"DPickerDate\", DThemeWhitePickerDate );\n\tloadThemeWhitePickerDatetime();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogDate } from \"../theme/white/d-theme-white-dialog-date\";\nimport { loadThemeWhitePickerDate } from \"./load-theme-white-picker-date\";\n\nexport const loadThemeWhiteDialogDate = () => {\n\tDThemeWhite.set( \"DDialogDate\", DThemeWhiteDialogDate );\n\tloadThemeWhitePickerDate();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonDate } from \"../theme/white/d-theme-white-button-date\";\nimport { loadThemeWhiteDialogDate } from \"./load-theme-white-dialog-date\";\n\nexport const loadThemeWhiteButtonDate = () => {\n\tDThemeWhite.set( \"DButtonDate\", DThemeWhiteButtonDate );\n\tloadThemeWhiteDialogDate();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DThemePickerTime } from \"./d-picker-time\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { utilPad } from \"./util/util-pad\";\n\nexport class DPickerTimes {\n\tstatic format( date: Date, mask: DPickerDatetimeMask ): string {\n\t\tlet result = \"\";\n\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\tresult += utilPad( String( date.getHours() ), 2, \"0\" );\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult += \":\";\n\t\t\t}\n\t\t\tresult += utilPad( String( date.getMinutes() ), 2, \"0\" );\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult += \":\";\n\t\t\t}\n\t\t\tresult += utilPad( String( date.getSeconds() ), 2, \"0\" );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toMask( options?: { mask?: DPickerDatetimeMask } ): DPickerDatetimeMask {\n\t\treturn ( options && options.mask != null ? options.mask :\n\t\t\t(DThemes.getInstance().get( \"DPickerTime\" ) as DThemePickerTime).getMask() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDates } from \"./d-picker-dates\";\nimport { DThemePickerDatetime } from \"./d-picker-datetime\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\nimport { DThemes } from \"./theme/d-themes\";\n\nexport class DPickerDatetimes {\n\tstatic format( date: Date, mask: DPickerDatetimeMask ): string {\n\t\tconst hms = DPickerTimes.format( date, mask );\n\t\tif( 0 < hms.length ) {\n\t\t\treturn `${DPickerDates.format( date )} ${hms}`;\n\t\t} else {\n\t\t\treturn `${DPickerDates.format( date )}`;\n\t\t}\n\t}\n\n\tstatic toMask( options?: { mask?: DPickerDatetimeMask } ): DPickerDatetimeMask {\n\t\treturn ( options && options.mask != null ? options.mask :\n\t\t\t(DThemes.getInstance().get( \"DPickerDatetime\" ) as DThemePickerDatetime).getMask() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonDatetime, DThemeButtonDatetime } from \"../../d-button-datetime\";\nimport { DPickerDatetimes } from \"../../d-picker-datetimes\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\n\nconst formatter = ( value: Date, caller: DButtonDatetime ): string => {\n\treturn DPickerDatetimes.format( value, caller.getDatetimeMask() );\n};\n\nexport class DThemeWhiteButtonDatetime extends DThemeWhiteButton implements DThemeButtonDatetime {\n\tgetTextFormatter(): ( value: Date, caller: DButtonDatetime ) => string {\n\t\treturn formatter;\n\t}\n\n\tnewTextValue(): Date {\n\t\treturn new Date();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogDatetime } from \"../../d-dialog-datetime\";\nimport { DThemeWhiteDialogCommand } from \"./d-theme-white-dialog-command\";\n\nexport class DThemeWhiteDialogDatetime extends DThemeWhiteDialogCommand implements DThemeDialogDatetime {\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogDatetime } from \"../theme/white/d-theme-white-dialog-datetime\";\nimport { loadThemeWhitePickerDatetime } from \"./load-theme-white-picker-datetime\";\n\nexport const loadThemeWhiteDialogDatetime = () => {\n\tDThemeWhite.set( \"DDialogDatetime\", DThemeWhiteDialogDatetime );\n\tloadThemeWhitePickerDatetime();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonDatetime } from \"../theme/white/d-theme-white-button-datetime\";\nimport { loadThemeWhiteDialogDatetime } from \"./load-theme-white-dialog-datetime\";\n\nexport const loadThemeWhiteButtonDatetime = () => {\n\tDThemeWhite.set( \"DButtonDatetime\", DThemeWhiteButtonDatetime );\n\tloadThemeWhiteDialogDatetime();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeButtonFile } from \"../../d-button-file\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\n\nexport class DThemeWhiteButtonFile extends DThemeWhiteButton implements DThemeButtonFile {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonFile } from \"../theme/white/d-theme-white-button-file\";\n\nexport const loadThemeWhiteButtonFile = () => {\n\tDThemeWhite.set( \"DButtonFile\", DThemeWhiteButtonFile );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteButtonBase } from \"./d-theme-white-button-base\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\n\nexport class DThemeWhiteButtonPrimary extends DThemeWhiteButtonBase {\n\tCOLOR = DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\tCOLOR_HOVERED = UtilRgb.darken( this.COLOR, 0.1 );\n\tCOLOR_PRESSED = UtilRgb.darken( this.COLOR, 0.2 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isPressed( state ) || DBaseStates.isActive( state ) ) {\n\t\t\treturn this.COLOR_PRESSED;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn this.COLOR_HOVERED;\n\t\t} else {\n\t\t\treturn this.COLOR;\n\t\t}\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn 0xe5e5e5;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn super.getColor( state );\n\t\t} else {\n\t\t\treturn 0xffffff;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonPrimary } from \"../theme/white/d-theme-white-button-primary\";\n\nexport const loadThemeWhiteButtonPrimary = () => {\n\tDThemeWhite.set( \"DButtonPrimary\", DThemeWhiteButtonPrimary );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeButtonRadio } from \"../../d-button-radio\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteButtonAmbient } from \"./d-theme-white-button-ambient\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteFont } from \"./d-theme-white-font\";\n\n// Material Design icons by Google.\n// Apache license version 2.0.\nDThemeWhiteAtlas.add( \"button_radio_mark_on\", 21, 21,\n\t`<g transform=\"scale(0.875,0.875)\">` +\n\t\t`<path d=\"M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zm0-5C6.48 2 2 6.48` +\n\t\t\t` 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42 0-8-3.58-8-8s3.58-8 8-8` +\n\t\t\t` 8 3.58 8 8-3.58 8-8 8z\" fill=\"#fff\" />` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"button_radio_mark_off\", 21, 21,\n\t`<g transform=\"scale(0.875,0.875)\">` +\n\t\t`<path d=\"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.42` +\n\t\t\t` 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z\" fill=\"#fff\" />` +\n\t`</g>`\n);\n\nexport class DThemeWhiteButtonRadio extends DThemeWhiteButtonAmbient implements DThemeButtonRadio {\n\treadonly IMAGE_TINT_COLOR_FOCUSED = UtilRgb.darken( DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR, 0.1 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteFont.getColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\tif( ! DBaseStates.isDisabled( state ) ) {\n\t\t\tif( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_ALPHA;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetImageTintColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) || ! DBaseStates.isActive( state ) ) {\n\t\t\tif( DBaseStates.isFocused( state ) ) {\n\t\t\t\treturn this.IMAGE_TINT_COLOR_FOCUSED;\n\t\t\t} else {\n\t\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t\t\t}\n\t\t} else {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t}\n\t}\n\n\tisToggle(): boolean {\n\t\treturn true;\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteAtlas.mappings.button_radio_mark_on;\n\t\t} else {\n\t\t\treturn DThemeWhiteAtlas.mappings.button_radio_mark_off;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DDragMode {\n\tOFF,\n\tON,\n\tTOUCH\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonRadio } from \"../theme/white/d-theme-white-button-radio\";\n\nexport const loadThemeWhiteButtonRadio = () => {\n\tDThemeWhite.set( \"DButtonRadio\", DThemeWhiteButtonRadio );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DThemeButtonRadioRight } from \"../../d-button-radio-right\";\nimport { DThemeWhiteButtonRadio } from \"./d-theme-white-button-radio\";\n\nexport class DThemeWhiteButtonRadioRight extends DThemeWhiteButtonRadio implements DThemeButtonRadioRight {\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.PADDING;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 0;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonRadioRight } from \"../theme/white/d-theme-white-button-radio-right\";\n\nexport const loadThemeWhiteButtonRadioRight = () => {\n\tDThemeWhite.set( \"DButtonRadioRight\", DThemeWhiteButtonRadioRight );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteButtonBase } from \"./d-theme-white-button-base\";\n\nexport class DThemeWhiteButtonSecondary extends DThemeWhiteButtonBase {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonSecondary } from \"../theme/white/d-theme-white-button-secondary\";\n\nexport const loadThemeWhiteButtonSecondary = () => {\n\tDThemeWhite.set( \"DButtonSecondary\", DThemeWhiteButtonSecondary );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonTime, DThemeButtonTime } from \"../../d-button-time\";\nimport { DPickerTimes } from \"../../d-picker-times\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\n\nconst formatter = ( value: Date, caller: DButtonTime ): string => {\n\treturn DPickerTimes.format( value, caller.getDatetimeMask() );\n};\n\nexport class DThemeWhiteButtonTime extends DThemeWhiteButton implements DThemeButtonTime {\n\tgetTextFormatter(): ( value: Date, caller: DButtonTime ) => string {\n\t\treturn formatter;\n\t}\n\n\tnewTextValue(): Date {\n\t\treturn new Date();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogTime } from \"../../d-dialog-time\";\nimport { DThemeWhiteDialogCommand } from \"./d-theme-white-dialog-command\";\n\nexport class DThemeWhiteDialogTime extends DThemeWhiteDialogCommand implements DThemeDialogTime {\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetLayoutHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogTime } from \"../theme/white/d-theme-white-dialog-time\";\nimport { loadThemeWhitePickerTime } from \"./load-theme-white-picker-time\";\n\nexport const loadThemeWhiteDialogTime = () => {\n\tDThemeWhite.set( \"DDialogTime\", DThemeWhiteDialogTime );\n\tloadThemeWhitePickerTime();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteButtonTime } from \"../theme/white/d-theme-white-button-time\";\nimport { loadThemeWhiteDialogTime } from \"./load-theme-white-dialog-time\";\n\nexport const loadThemeWhiteButtonTime = () => {\n\tDThemeWhite.set( \"DButtonTime\", DThemeWhiteButtonTime );\n\tloadThemeWhiteDialogTime();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadThemeWhiteButton } from \"./load-theme-white-button\";\nimport { loadThemeWhiteButtonAmbient } from \"./load-theme-white-button-ambient\";\nimport { loadThemeWhiteButtonCheck } from \"./load-theme-white-button-check\";\nimport { loadThemeWhiteButtonCheckRight } from \"./load-theme-white-button-check-right\";\nimport { loadThemeWhiteButtonColor } from \"./load-theme-white-button-color\";\nimport { loadThemeWhiteButtonColorGradient } from \"./load-theme-white-button-color-gradient\";\nimport { loadThemeWhiteButtonDanger } from \"./load-theme-white-button-danger\";\nimport { loadThemeWhiteButtonDate } from \"./load-theme-white-button-date\";\nimport { loadThemeWhiteButtonDatetime } from \"./load-theme-white-button-datetime\";\nimport { loadThemeWhiteButtonFile } from \"./load-theme-white-button-file\";\nimport { loadThemeWhiteButtonPrimary } from \"./load-theme-white-button-primary\";\nimport { loadThemeWhiteButtonRadio } from \"./load-theme-white-button-radio\";\nimport { loadThemeWhiteButtonRadioRight } from \"./load-theme-white-button-radio-right\";\nimport { loadThemeWhiteButtonSecondary } from \"./load-theme-white-button-secondary\";\nimport { loadThemeWhiteButtonTime } from \"./load-theme-white-button-time\";\n\nexport const loadThemeWhiteButtonAll = () => {\n\tloadThemeWhiteButtonAmbient();\n\tloadThemeWhiteButtonCheckRight();\n\tloadThemeWhiteButtonCheck();\n\tloadThemeWhiteButtonColorGradient();\n\tloadThemeWhiteButtonColor();\n\tloadThemeWhiteButtonDanger();\n\tloadThemeWhiteButtonDate();\n\tloadThemeWhiteButtonDatetime();\n\tloadThemeWhiteButtonFile();\n\tloadThemeWhiteButtonPrimary();\n\tloadThemeWhiteButtonRadioRight();\n\tloadThemeWhiteButtonRadio();\n\tloadThemeWhiteButtonSecondary();\n\tloadThemeWhiteButtonTime();\n\tloadThemeWhiteButton();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeCanvas } from \"../../d-canvas\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteCanvas extends DThemeWhiteBase implements DThemeCanvas {\n\tgetBackgroundColor() {\n\t\treturn 0xffffff;\n\t}\n\n\tgetBorderColor( state: DBaseState ) {\n\t\treturn null;\n\t}\n\n\tgetCornerMask(): number {\n\t\treturn DCornerMask.ALL;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeCanvasContainer } from \"../../d-canvas-container\";\nimport { DDragMode } from \"../../d-drag-mode\";\nimport { DMouseModifier } from \"../../d-mouse-modifier\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteCanvasContainer extends DThemeWhiteBase implements DThemeCanvasContainer {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetPaddingLeft() {\n\t\treturn 50;\n\t}\n\n\tgetPaddingTop() {\n\t\treturn 50;\n\t}\n\n\tgetPaddingRight() {\n\t\treturn 50;\n\t}\n\n\tgetPaddingBottom() {\n\t\treturn 50;\n\t}\n\n\tisWheelZoomEnabled(): boolean {\n\t\treturn true;\n\t}\n\n\tgetWheelZoomSpeed(): number {\n\t\treturn 0.004;\n\t}\n\n\tgetWheelZoomModifier(): DMouseModifier {\n\t\treturn DMouseModifier.NOT_NONE;\n\t}\n\n\tisWheelTranslationEnabled(): boolean {\n\t\treturn true;\n\t}\n\n\tgetWheelTranslationSpeed(): number {\n\t\treturn this.getFontSize() * 0.16;\n\t}\n\n\tgetWheelTranslationModifier(): DMouseModifier {\n\t\treturn DMouseModifier.NONE;\n\t}\n\n\tisDblClickZoomEnabled(): boolean {\n\t\treturn true;\n\t}\n\n\tgetDblClickZoomSpeed(): number {\n\t\treturn 2;\n\t}\n\n\tgetDblClickZoomModifier(): DMouseModifier {\n\t\treturn DMouseModifier.NONE;\n\t}\n\n\tgetDblClickZoomDuration(): number {\n\t\treturn 333;\n\t}\n\n\tgetZoomMin(): number {\n\t\treturn 0.1;\n\t}\n\n\tgetZoomMax(): number {\n\t\treturn 20;\n\t}\n\n\tgetDragMode(): DDragMode {\n\t\treturn DDragMode.ON;\n\t}\n\n\tgetDragModifier(): DMouseModifier {\n\t\treturn DMouseModifier.NONE;\n\t}\n\n\tgetDragDurationPosition(): number {\n\t\treturn 1;\n\t}\n\n\tgetDragDurationScale(): number {\n\t\treturn 1;\n\t}\n\n\tisOverflowMaskEnabled(): boolean {\n\t\treturn false;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisContainer } from \"./d-chart-axis-container\";\n\nexport enum DChartAxisPosition {\n\tTOP,\n\tBOTTOM,\n\tLEFT,\n\tRIGHT\n}\n\nexport enum DChartAxisTickPosition {\n\tINSIDE,\n\tOUTSIDE\n}\n\nexport interface DChartAxisOptions {\n\tposition?: DChartAxisPosition | keyof typeof DChartAxisPosition;\n}\n\nexport interface DChartAxis {\n\treadonly position: DChartAxisPosition;\n\tbind( container: DChartAxisContainer, index: number ): void;\n\tunbind(): void;\n\tupdate(): void;\n\tdestroy(): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteCanvas } from \"../theme/white/d-theme-white-canvas\";\nimport { DThemeWhiteCanvasContainer } from \"../theme/white/d-theme-white-canvas-container\";\n\nexport const loadThemeWhiteCanvasContainer = () => {\n\tDThemeWhite.set( \"DCanvasContainer\", DThemeWhiteCanvasContainer );\n\tDThemeWhite.set( \"DCanvas\", DThemeWhiteCanvas );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeChart } from \"../../d-chart\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteChart extends DThemeWhiteBase implements DThemeChart {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\n\nexport class EShapeGroupFillViewer implements EShapeFill {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target: EShapeFillLike ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable: boolean, color: number, alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupFillViewer {\n\t\treturn new EShapeGroupFillViewer();\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike, EShapeStrokeSide } from \"../e-shape-stroke\";\n\nexport class EShapeGroupStrokeViewer implements EShapeStroke {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget width(): number {\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget align(): number {\n\t\treturn 0.0;\n\t}\n\n\tset align( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\treturn EShapeStrokeSide.NONE;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number, side?: EShapeStrokeSide ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupStrokeViewer {\n\t\treturn new EShapeGroupStrokeViewer();\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0,\n\t\t\talign: 0.0,\n\t\t\tside: EShapeStrokeSide.NONE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\n\nexport class EShapeGroupTextAlignViewer implements EShapeTextAlign {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\treturn {\n\t\t\thorizontal: EShapeTextAlignHorizontal.CENTER,\n\t\t\tvertical: EShapeTextAlignVertical.MIDDLE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextOffsetViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\n\nexport class EShapeGroupTextOutlineViewer implements EShapeTextOutline {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget width(): number {\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupTextOutlineViewer {\n\t\treturn new EShapeGroupTextOutlineViewer();\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextPaddingViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextSpacingViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeGroupTextAlignViewer } from \"./e-shape-group-text-align-viewer\";\nimport { EShapeGroupTextOffsetViewer } from \"./e-shape-group-text-offset-viewer\";\nimport { EShapeGroupTextOutlineViewer } from \"./e-shape-group-text-outline-viewer\";\nimport { EShapeGroupTextPaddingViewer } from \"./e-shape-group-text-padding-viewer\";\nimport { EShapeGroupTextSpacingViewer } from \"./e-shape-group-text-spacing-viewer\";\n\nexport class EShapeGroupTextViewer implements EShapeText {\n\talign: EShapeGroupTextAlignViewer;\n\toffset: EShapeGroupTextOffsetViewer;\n\toutline: EShapeGroupTextOutlineViewer;\n\tspacing: EShapeGroupTextSpacingViewer;\n\tpadding: EShapeGroupTextPaddingViewer;\n\n\tconstructor() {\n\t\tthis.align = new EShapeGroupTextAlignViewer();\n\t\tthis.offset = new EShapeGroupTextOffsetViewer();\n\t\tthis.outline = new EShapeGroupTextOutlineViewer();\n\t\tthis.spacing = new EShapeGroupTextSpacingViewer();\n\t\tthis.padding = new EShapeGroupTextPaddingViewer();\n\t}\n\n\tget enable(): boolean {\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget value(): string {\n\t\treturn \"\";\n\t}\n\n\tset value( value: string ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0x000000;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget family(): string {\n\t\treturn \"auto\";\n\t}\n\n\tset family( family: string ) {\n\t\t// DO NOTHING\n\t}\n\n\tget size(): number {\n\t\treturn 24;\n\t}\n\n\tset size( size: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\treturn EShapeTextWeight.NORMAL;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\t// DO NOTHING\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\treturn EShapeTextStyle.NORMAL;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\t// DO NOTHING\n\t}\n\n\tget direction(): number {\n\t\treturn EShapeTextDirection.LEFT_TO_RIGHT;\n\t}\n\n\tset direction( direction: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget clipping(): boolean {\n\t\treturn false;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this {\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\treturn {\n\t\t\tvalue: \"\",\n\t\t\tcolor: 0x000000,\n\t\t\talpha: 1.0,\n\t\t\tfamily: \"auto\",\n\t\t\tsize: 24,\n\t\t\tweight: EShapeTextWeight.NORMAL,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: EShapeTextStyle.NORMAL,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tdirection: EShapeTextDirection.LEFT_TO_RIGHT,\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: false\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class EShapeBufferCount {\n\tvertexCount: number;\n\tindexCount: number;\n\n\tconstructor() {\n\t\tthis.vertexCount = 0;\n\t\tthis.indexCount = 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\n\nexport class EShapeBufferUnit {\n\ttexture: Texture;\n\tindexOffset: number;\n\n\tconstructor( texture: Texture, indexOffset: number ) {\n\t\tthis.texture = texture;\n\t\tthis.indexOffset = indexOffset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Texture } from \"pixi.js\";\nimport { EShapeBufferUnit } from \"./e-shape-buffer-unit\";\n\nexport class EShapeBufferUnitBuilder {\n\tindex: number;\n\tbaseTexture: BaseTexture | null;\n\tunits: EShapeBufferUnit[];\n\n\tconstructor() {\n\t\tthis.index = 0;\n\t\tthis.baseTexture = null;\n\t\tthis.units = [];\n\t}\n\n\tbegin(): void {\n\t\tthis.index = 0;\n\t\tthis.baseTexture = null;\n\t}\n\n\tpush( texture: Texture, indexOffset: number ): void {\n\t\tif( this.index < this.units.length ) {\n\t\t\tconst unit = this.units[ this.index ];\n\t\t\tunit.texture = texture;\n\t\t\tunit.indexOffset = indexOffset;\n\t\t} else {\n\t\t\tthis.units.push( new EShapeBufferUnit( texture, indexOffset ) );\n\t\t}\n\t\tthis.index += 1;\n\t}\n\n\tend(): void {\n\t\tif( this.units.length !== this.index ) {\n\t\t\tthis.units.length = this.index;\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tthis.units.length = 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, DRAW_MODES, Geometry, Point, Renderer, Shader, Texture } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBufferCount } from \"./e-shape-buffer-count\";\nimport { EShapeBufferUnitBuilder } from \"./e-shape-buffer-unit-builder\";\nimport { EShapeRendererIterator } from \"./e-shape-renderer-iterator\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\nimport { EShapeUploadeds } from \"./e-shape-uploadeds\";\n\nexport class EShapeBuffer {\n\tvertices: Float32Array;\n\tvertexCapacity: number;\n\tprotected vertexCount: number;\n\tvertexBuffer: Buffer;\n\n\tclippings: Float32Array;\n\tclippingBuffer: Buffer;\n\n\tsteps: Float32Array;\n\tstepBuffer: Buffer;\n\n\tantialiases: Float32Array;\n\tantialiasBuffer: Buffer;\n\n\tcolorFills: Float32Array;\n\tcolorFillBuffer: Buffer;\n\n\tcolorStrokes: Float32Array;\n\tcolorStrokeBuffer: Buffer;\n\n\tuvs: Float32Array;\n\tuvBuffer: Buffer;\n\n\tindices: Uint16Array | Uint32Array;\n\tindexCapacity: number;\n\tprotected indexCount: number;\n\tindexBuffer: Buffer;\n\n\tprotected renderer: Renderer;\n\tprotected geometry: Geometry;\n\n\tprotected builder: EShapeBufferUnitBuilder;\n\n\twork: Point;\n\tworkColor: Float32Array;\n\tworkStep: Float32Array;\n\tworkCount: EShapeBufferCount;\n\n\tconstructor( ntriangles: number, renderer: Renderer, shader: Shader ) {\n\t\tconst nindices = ntriangles * 3;\n\t\tconst nvertices = nindices;\n\n\t\tthis.vertices = new Float32Array( nvertices * 2 );\n\t\tthis.vertexCapacity = nvertices;\n\t\tthis.vertexCount = 0;\n\t\tthis.vertexBuffer = new Buffer( this.vertices, false, false );\n\n\t\tthis.clippings = new Float32Array( nvertices * 3 );\n\t\tthis.clippingBuffer = new Buffer( this.clippings, false, false );\n\n\t\tthis.steps = new Float32Array( nvertices * 2 );\n\t\tthis.stepBuffer = new Buffer( this.steps, false, false );\n\n\t\tthis.antialiases = new Float32Array( nvertices * 4 );\n\t\tthis.antialiasBuffer = new Buffer( this.antialiases, false, false );\n\n\t\tthis.colorFills = new Float32Array( nvertices * 4 );\n\t\tthis.colorFillBuffer = new Buffer( this.colorFills, false, false );\n\n\t\tthis.colorStrokes = new Float32Array( nvertices * 4 );\n\t\tthis.colorStrokeBuffer = new Buffer( this.colorStrokes, false, false );\n\n\t\tthis.uvs = new Float32Array( nvertices * 2 );\n\t\tthis.uvBuffer = new Buffer( this.uvs, false, false );\n\n\t\tconst isIndicesShort = ( nvertices <= 65535 );\n\t\tthis.indices = ( isIndicesShort ? new Uint16Array( nindices ) : new Uint32Array( nindices ) );\n\t\tthis.indexCapacity = ntriangles;\n\t\tthis.indexCount = 0;\n\t\tthis.indexBuffer = new Buffer( this.indices, false, true );\n\n\t\tthis.renderer = renderer;\n\n\t\tthis.builder = new EShapeBufferUnitBuilder();\n\n\t\tthis.work = new Point();\n\t\tthis.workColor = new Float32Array( 4 );\n\t\tthis.workStep = new Float32Array( 3 );\n\t\tthis.workCount = new EShapeBufferCount();\n\n\t\tthis.geometry = new Geometry()\n\t\t\t.addIndex( this.indexBuffer )\n\t\t\t.addAttribute( \"aPosition\", this.vertexBuffer, 2 )\n\t\t\t.addAttribute( \"aClipping\", this.clippingBuffer, 3 )\n\t\t\t.addAttribute( \"aStep\", this.stepBuffer, 2 )\n\t\t\t.addAttribute( \"aAntialias\", this.antialiasBuffer, 4 )\n\t\t\t.addAttribute( \"aColorFill\", this.colorFillBuffer, 4 )\n\t\t\t.addAttribute( \"aColorStroke\", this.colorStrokeBuffer, 4 )\n\t\t\t.addAttribute( \"aUv\", this.uvBuffer, 2 );\n\t}\n\n\trender( shader: Shader ): void {\n\t\tconst renderer = this.renderer;\n\t\t(renderer.geometry as any).bind( this.geometry );\n\n\t\tconst units = this.builder.units;\n\t\tconst unitCount = units.length;\n\t\tif( 0 < unitCount ) {\n\t\t\tconst type = DRAW_MODES.TRIANGLES;\n\n\t\t\tlet unit0 = null;\n\t\t\tlet unit1 = units[ 0 ];\n\t\t\tlet ioffset0 = 0;\n\t\t\tlet ioffset1 = unit1.indexOffset * 3;\n\t\t\tlet vcount = 0;\n\t\t\tlet texture = Texture.WHITE;\n\t\t\tfor( let i = 0, imax = unitCount - 1; i < imax; ++i ) {\n\t\t\t\tunit0 = unit1;\n\t\t\t\tunit1 = units[ i + 1 ];\n\t\t\t\tioffset0 = ioffset1;\n\t\t\t\tioffset1 = unit1.indexOffset * 3;\n\t\t\t\tvcount = ioffset1 - ioffset0;\n\t\t\t\ttexture = unit0.texture || Texture.WHITE;\n\t\t\t\tif( 0 < vcount && texture.valid ) {\n\t\t\t\t\tshader.uniforms.sampler = renderer.texture.bind( texture );\n\t\t\t\t\trenderer.geometry.draw( type, vcount, ioffset0 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvcount = this.indexCount * 3 - ioffset1;\n\t\t\ttexture = unit1.texture || Texture.WHITE;\n\t\t\tif( 0 < vcount && texture.valid ) {\n\t\t\t\tshader.uniforms.sampler = renderer.texture.bind( texture );\n\t\t\t\trenderer.geometry.draw( type, vcount, ioffset1 );\n\t\t\t}\n\t\t}\n\t}\n\n\tisCompatible( shape: EShape, uploaded: EShapeUploaded, vindex: number, iindex: number ): boolean {\n\t\treturn (\n\t\t\tuploaded.getBuffer() === this &&\n\t\t\tuploaded.getVertexOffset() === vindex &&\n\t\t\tuploaded.getIndexOffset() === iindex &&\n\t\t\tuploaded.isCompatible( shape )\n\t\t);\n\t}\n\n\tupdate( iterator: EShapeRendererIterator ): boolean {\n\t\tconst builder = this.builder;\n\t\tbuilder.begin();\n\n\t\tlet vindex = 0;\n\t\tlet iindex = 0;\n\t\tlet shape = iterator.get();\n\t\tfor( ; shape != null; shape = iterator.next() ) {\n\t\t\tconst uploaded = shape.uploaded;\n\t\t\tif( uploaded == null || ! this.isCompatible( shape, uploaded, vindex, iindex ) ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tuploaded.update( shape );\n\t\t\tuploaded.buildUnit( builder );\n\n\t\t\tvindex += uploaded.getVertexCount();\n\t\t\tiindex += uploaded.getIndexCount();\n\t\t}\n\n\t\tfor( ; shape != null; shape = iterator.next() ) {\n\t\t\tconst creater = EShapeUploadeds[ shape.type ] || EShapeUploadeds[ EShapeType.GROUP ];\n\t\t\tif( creater == null ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst uploaded = creater( this, shape, vindex, iindex );\n\t\t\tif( uploaded == null ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tuploaded.buildUnit( builder );\n\t\t\tvindex += uploaded.getVertexCount();\n\t\t\tiindex += uploaded.getIndexCount();\n\t\t}\n\n\t\tbuilder.end();\n\t\tthis.vertexCount = vindex;\n\t\tthis.indexCount = iindex;\n\n\t\treturn 0 < builder.units.length;\n\t}\n\n\tdestroy(): void {\n\t\tthis.geometry.destroy();\n\t\tthis.builder.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\n\nconst DUMMY_SHAPES: EShape[] = [];\n\nexport class EShapeRendererIteratorDatum {\n\tprotected index: number;\n\tprotected shapes: EShape[];\n\n\tconstructor() {\n\t\tthis.index = 0;\n\t\tthis.shapes = DUMMY_SHAPES;\n\t}\n\n\treset( shapes: EShape[] ) {\n\t\tthis.index = -1;\n\t\tthis.shapes = shapes;\n\t}\n\n\tnext(): EShape | null {\n\t\tconst index = this.index = this.index + 1;\n\t\tconst shapes = this.shapes;\n\t\tif( index < shapes.length ) {\n\t\t\treturn shapes[ index ];\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeRendererIteratorDatum } from \"./e-shape-renderer-iterator-datum\";\n\nexport class EShapeRendererIterator {\n\tprotected _index: number;\n\tprotected _data: EShapeRendererIteratorDatum[];\n\tprotected _datum: EShapeRendererIteratorDatum;\n\tprotected _current: EShape | null;\n\n\tconstructor() {\n\t\tthis._index = -1;\n\t\tthis._datum = new EShapeRendererIteratorDatum();\n\t\tthis._data = [ this._datum ];\n\t\tthis._current = null;\n\t}\n\n\treset( shapes: EShape[] ): EShape | null {\n\t\tthis._index = 0;\n\t\tconst current = this._datum = this._data[ 0 ];\n\t\tcurrent.reset( shapes );\n\t\tthis._current = null;\n\t\treturn this.next();\n\t}\n\n\tget(): EShape | null {\n\t\treturn this._current;\n\t}\n\n\tnext(): EShape | null {\n\t\tconst datum = this._datum;\n\t\tconst shape = datum.next();\n\t\tif( shape != null ) {\n\t\t\tthis._current = shape;\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tconst datumIndex = this._index = this._index + 1;\n\t\t\t\tconst data = this._data;\n\t\t\t\tif( datumIndex < data.length ) {\n\t\t\t\t\tconst newDatum = data[ datumIndex ];\n\t\t\t\t\tnewDatum.reset( children );\n\t\t\t\t\tthis._datum = newDatum;\n\t\t\t\t} else {\n\t\t\t\t\tconst newDatum = new EShapeRendererIteratorDatum();\n\t\t\t\t\tdata.push( newDatum );\n\t\t\t\t\tnewDatum.reset( children );\n\t\t\t\t\tthis._datum = newDatum;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn shape;\n\t\t} else {\n\t\t\tconst datumIndex = this._index = this._index - 1;\n\t\t\tconst data = this._data;\n\t\t\tif( 0 <= datumIndex ) {\n\t\t\t\tthis._datum = data[ datumIndex ];\n\t\t\t\tthis._current = null;\n\t\t\t\treturn this.next();\n\t\t\t} else {\n\t\t\t\tthis._current = null;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, BLEND_MODES, ObjectRenderer, Renderer, Shader, Texture, utils } from \"pixi.js\";\nimport { DynamicAtlas } from \"../util/dynamic-atlas\";\nimport { DynamicAtlasItemImage } from \"../util/dynamic-atlas-item-image\";\nimport { DynamicSDFFontAtlases } from \"../util/dynamic-sdf-font-atlases\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeDefaults } from \"./e-shape-defaults\";\nimport { EShapeRendererIterator } from \"./e-shape-renderer-iterator\";\n\nconst VERTEX_SHADER = `\nattribute vec2 aPosition;\nattribute vec3 aClipping;\nattribute vec2 aStep;\nattribute vec4 aAntialias;\nattribute vec4 aColorFill;\nattribute vec4 aColorStroke;\nattribute vec2 aUv;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mediump float pixelScale;\nuniform mediump float antialiasWeight;\n\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nvec2 toInverse( in vec2 v ) {\n\treturn vec2( -v.y, v.x );\n}\n\nvec2 toTransformedPosition( in vec2 v ) {\n\treturn (projectionMatrix * translationMatrix * vec3(v, 1.0)).xy;\n}\n\nvec4 toAntialias01( in vec4 antialias, in float scale ) {\n\t// Taylor series of 1 / ( 1 - a ) = 1 + a + a^2 + ....\n\treturn 1.0 + min( vec4( 1.0 ), antialias * scale );\n}\n\nvec4 toAntialias2( in vec2 step, in vec4 antialias, in float scale ) {\n\tfloat x = min( 0.4, step.x * scale );\n\tfloat y = 0.5 - antialias.x;\n\tfloat z = 0.5 - antialias.x - step.y;\n\treturn vec4( y, z, y - max( 0.01, y - x ), z - max( 0.01, z - x ) );\n}\n\nvec2 toPosition3456( in float type, in vec2 p, in vec2 pprev, in vec2 pnext, in float strokeWidth, out float shift ) {\n\tvec2 d0 = p - pprev;\n\tvec2 d1 = pnext - p;\n\tfloat l0 = dot( d0, d0 );\n\tfloat l1 = dot( d1, d1 );\n\tvec2 nd0 = normalize( toInverse( d0 ) );\n\tvec2 nd1 = normalize( toInverse( d1 ) );\n\tvec2 n0 = 0.00001 < l0 ? nd0 : nd1;\n\tvec2 n1 = 0.00001 < l1 ? nd1 : nd0;\n\tvec2 n0i = toInverse( n0 );\n\tvec2 n1i = toInverse( n1 );\n\tfloat direction = sign( 4.5 - type );\n\n\t// Offset\n\tfloat cross = dot( n0i, n1 );\n\tfloat crossInverse = ( 0.00001 < abs( cross ) ? 1.0 / cross : 0.0 );\n\tfloat b = dot(n1 - n0, n0) * crossInverse;\n\tfloat offsetSize = direction * strokeWidth * 0.5;\n\tvec2 offset = n1 + n1i * b;\n\n\t// Miter\n\tvec2 pmiter = p + offsetSize * offset;\n\tfloat miterAngle0 = dot( n0i, pmiter - pprev );\n\tfloat miterAngle1 = dot( n1i, pmiter - pnext );\n\tfloat miterLength = dot( offset, offset );\n\tfloat miterSide = direction * cross;\n\n\t// Bevel\n\tvec2 n = ( type == 4.0 || type == 6.0 ? n1 : n0 );\n\tvec2 pbevel = p + offsetSize * n;\n\n\t//\n\tvec2 presult = (\n\t\t0.0 <= miterAngle0 || miterAngle1 < 0.0 || miterSide < 0.0 ?\n\t\tpbevel : pmiter\n\t);\n\t/*\n\tvec2 presult = (\n\t\tmiterAngle0 < 0.0 && 0.0 <= miterAngle1 && miterLength < 50.0 ?\n\t\tpmiter : pbevel\n\t);\n\t*/\n\tvec2 ni = ( type == 4.0 || type == 6.0 ? n1i : n0i );\n\tshift = dot( ni, p - presult );\n\treturn toTransformedPosition( presult );\n}\n\nvec2 toStep3456( in float type ) {\n\treturn ( type < 4.5 ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 ) );\n}\n\nvec4 toAntialias3456( in float strokeWidth, in float scale ) {\n\tfloat a = antialiasWeight / max( 0.0001, strokeWidth );\n\treturn toAntialias01( vec4( a, a, a, a ), scale );\n}\n\nfloat toDotAndDashScale( in float scale, in float strokeWidthScale ) {\n\treturn (\n\t\tscale == 4.0 || scale == 5.0 || scale == 6.0 || scale == 7.0 ?\n\t\tstrokeWidthScale : 1.0\n\t);\n}\n\nvec4 toColorStroke3456( in float shift, in float scale ) {\n\tfloat x = aColorFill.x + shift;\n\tfloat y = scale * aColorFill.y;\n\tfloat z = scale * aColorFill.z;\n\tfloat w = aColorFill.w;\n\treturn vec4( x, y, z, w );\n}\n\nfloat toStrokeWidthScale( in float scale ) {\n\treturn (\n\t\tscale == 3.0 || scale == 7.0 ?\n\t\tpixelScale : (\n\t\t\tscale == 1.0 || scale == 5.0 ?\n\t\t\tmin( 1.0, pixelScale ) : (\n\t\t\t\tscale == 2.0 || scale == 6.0 ?\n\t\t\t\tmax( 1.0, pixelScale ) : 1.0\n\t\t\t)\n\t\t)\n\t);\n}\n\nvoid main(void) {\n\tvec2 p012 = toTransformedPosition( aPosition );\n\n\tfloat type = aClipping.z;\n\n\t// type === 0 or 1\n\tvec4 a01 = toAntialias01( aAntialias, pixelScale );\n\n\t// type === 2\n\tvec4 a2 = toAntialias2( aStep, aAntialias, pixelScale );\n\n\t// type === 3, 4, 5 or 6\n\tfloat shift3456 = 0.0;\n\tfloat strokeWidthScale = toStrokeWidthScale( aStep.y );\n\tfloat strokeWidth = strokeWidthScale * aStep.x;\n\tvec2 p3456 = toPosition3456( type, aPosition, aAntialias.xy, aAntialias.zw, strokeWidth, shift3456 );\n\tvec2 step3456 = toStep3456( type );\n\tvec4 a3456 = toAntialias3456( strokeWidth, pixelScale );\n\tvec4 colorStroke3456 = toColorStroke3456( shift3456, toDotAndDashScale( aStep.y, strokeWidthScale ) );\n\n\t//\n\tgl_Position = vec4( ( 2.5 < type ? p3456 : p012 ), 0.0, 1.0 );\n\tvAntialias = ( 1.5 < type ? ( 2.5 < type ? a3456 : a2 ) : a01 );\n\tvClipping = aClipping;\n\tvStep = ( 2.5 < type ? step3456 : aStep );\n\tvColorFill = ( 2.5 < type ? aColorStroke : aColorFill );\n\tvColorStroke = ( 2.5 < type ? colorStroke3456 : aColorStroke );\n\tvUv = aUv;\n}`;\n\nconst FRAGMENT_SHADER_NO_AA = `\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec4 d0 = vec4( max( v0.x, v0.y ), max( v1.x, v1.y ), max( v2.x, v2.y ), max( v3.x, v3.y ) );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = step( vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = step( 0.0, lm );\n\tfloat ls1 = step( lp0, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - step( lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}`;\n\nconst FRAGMENT_SHADER = `\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec4 d0 = vec4( max( v0.x, v0.y ), max( v1.x, v1.y ), max( v2.x, v2.y ), max( v3.x, v3.y ) );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = smoothstep( 1.0 - (d.zw - d.xy), vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat ld = 0.5 * pixelScale;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = smoothstep( 0.0, 0.0 + ld, lm );\n\tfloat ls1 = smoothstep( lp0, lp0 + ld, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - smoothstep( lt - ld, lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}`;\n\nexport class EShapeRenderer extends ObjectRenderer {\n\tprotected _shader: Shader | null;\n\tprotected _iterator: EShapeRendererIterator;\n\tprotected _bufferSize: number;\n\tprotected _bufferSizeMax: number;\n\n\tconstructor( renderer: Renderer ) {\n\t\tsuper( renderer );\n\t\tthis._shader = Shader.from( VERTEX_SHADER, FRAGMENT_SHADER );\n\t\tthis._iterator = new EShapeRendererIterator();\n\t\tthis._bufferSize = 5000;\n\t\tthis._bufferSizeMax = this.getBufferSizeMax( renderer );\n\t}\n\n\tprotected getBufferSizeMax( renderer: Renderer ): number {\n\t\tconst context = renderer.context;\n\t\tconst extensions = context.extensions as any;\n\t\tif( 1 < context.webGLVersion || !! extensions.uint32ElementIndex ) {\n\t\t\treturn 1431655765; // 2^32 / 3\n\t\t}\n\t\treturn 21845; // 2^16 / 3\n\t}\n\n\tupdateAtlas(\n\t\tshape: EShape,\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture, baseTexture: BaseTexture\n\t): void {\n\t\t// Texture\n\t\t// Do not access the shape.image.src here.\n\t\t// It slows down the rendering speed significantly.\n\t\tconst imageSrc = shape.imageSrc;\n\t\tif( imageSrc != null ) {\n\t\t\tconst textureItem = atlas.get( imageSrc );\n\t\t\tif( textureItem != null ) {\n\t\t\t\tshape.texture = textureItem.texture;\n\t\t\t} else {\n\t\t\t\tconst newTextureItem = new DynamicAtlasItemImage( shape.image!, baseTexture );\n\t\t\t\tshape.texture = newTextureItem.texture;\n\t\t\t\tatlas.set( newTextureItem.id, newTextureItem );\n\t\t\t}\n\t\t} else {\n\t\t\tshape.texture = defaultTexture;\n\t\t}\n\n\t\t// Font texture atlas\n\t\tconst text = shape.text;\n\t\tconst textValue = text.value;\n\t\tif( 0 < textValue.length ) {\n\t\t\tfontAtlases.add( text.family, textValue );\n\t\t}\n\t}\n\n\tupdateAtlases(\n\t\tshapes: EShape[],\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture, baseTexture: BaseTexture\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tthis.updateAtlas( shape, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\tconst children = shape.children;\n\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\tconst child = children[ j ];\n\t\t\t\tthis.updateAtlas( child, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t\tthis.updateAtlases( child.children, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateFontAtlas(\n\t\tshape: EShape,\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture\n\t): void {\n\t\tconst text = shape.text;\n\t\tconst fontAtlas = fontAtlases.get( text.family );\n\t\tif( fontAtlas != null ) {\n\t\t\tconst textureItem = atlas.get( fontAtlas.id );\n\t\t\tif( textureItem != null ) {\n\t\t\t\ttext.atlas = fontAtlas;\n\t\t\t\ttext.texture = textureItem.texture;\n\t\t\t} else {\n\t\t\t\ttext.atlas = undefined;\n\t\t\t\ttext.texture = defaultTexture;\n\t\t\t}\n\t\t} else {\n\t\t\ttext.atlas = undefined;\n\t\t\ttext.texture = defaultTexture;\n\t\t}\n\t}\n\n\tupdateFontAtlases(\n\t\tshapes: EShape[],\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tthis.updateFontAtlas( shape, atlas, fontAtlases, defaultTexture );\n\t\t\tconst children = shape.children;\n\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\tconst child = children[ j ];\n\t\t\t\tthis.updateFontAtlas( child, atlas, fontAtlases, defaultTexture );\n\t\t\t\tthis.updateFontAtlases( child.children, atlas, fontAtlases, defaultTexture );\n\t\t\t}\n\t\t}\n\t}\n\n\trender_(\n\t\tcontainer: EShapeContainer, shapes: EShape[], atlas: DynamicAtlas,\n\t\tfontAtlases: DynamicSDFFontAtlases, isDirty: boolean,\n\t\tbuffers: EShapeBuffer[]\n\t): void {\n\t\tconst renderer = this.renderer;\n\t\tconst shader = this._shader;\n\n\t\tif( shader != null && 0 < shapes.length ) {\n\t\t\t// Update textures\n\t\t\tif( isDirty ) {\n\t\t\t\t// Atlases\n\t\t\t\tatlas.begin();\n\t\t\t\tfontAtlases.begin();\n\t\t\t\tconst defaultTexture = atlas.getDefaultTexture();\n\t\t\t\tconst baseTexture: BaseTexture = atlas.getBaseTexture();\n\t\t\t\tthis.updateAtlases( shapes, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t\tfontAtlases.end();\n\t\t\t\tfontAtlases.update( atlas );\n\t\t\t\tthis.updateFontAtlases( shapes, atlas, fontAtlases, defaultTexture );\n\t\t\t\tatlas.end();\n\t\t\t\tatlas.repack();\n\n\t\t\t\t// Update buffers\n\t\t\t\tthis.updateBuffers( shapes, buffers, renderer, shader );\n\t\t\t}\n\n\t\t\t// Render buffers\n\t\t\tshader.uniforms.pixelScale = container.getPixelScale();\n\t\t\tshader.uniforms.antialiasWeight = EShapeDefaults.ANTIALIAS_WEIGHT;\n\t\t\tshader.uniforms.translationMatrix = container.worldTransform.toArray( true );\n\t\t\trenderer.shader.bind( shader, false );\n\t\t\trenderer.state!.setBlendMode(utils.correctBlendMode(BLEND_MODES.NORMAL, true));\n\t\t\tfor( let i = 0, imax = buffers.length; i < imax; ++i ) {\n\t\t\t\tbuffers[ i ].render( shader );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected increaseBufferSize(): boolean {\n\t\tconst bufferSize = this._bufferSize;\n\t\tconst bufferSizeMax = this._bufferSizeMax;\n\t\tif( bufferSize < bufferSizeMax ) {\n\t\t\tthis._bufferSize = Math.min( bufferSizeMax, bufferSize << 1 );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getBufferSize(): number {\n\t\treturn this._bufferSize;\n\t}\n\n\tupdateBuffers(\n\t\tshapes: EShape[], buffers: EShapeBuffer[], renderer: Renderer, shader: Shader\n\t): void {\n\t\tconst iterator = this._iterator;\n\t\titerator.reset( shapes );\n\t\tlet ib = 0;\n\t\tconst ibmax = buffers.length;\n\t\tfor( ; iterator.get() != null && ib < ibmax; ++ib ) {\n\t\t\tif( ! buffers[ ib ].update( iterator ) ) {\n\t\t\t\t// Failed to update the shapes.\n\t\t\t\t// This is most likely caused by small buffers.\n\t\t\t\t// So increase the buffer size.\n\t\t\t\tthis.increaseBufferSize();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tif( ib < ibmax ) {\n\t\t\tfor( let jb = ib; jb < ibmax; ++jb ) {\n\t\t\t\tbuffers[ jb ].destroy();\n\t\t\t}\n\t\t\tbuffers.length = ib;\n\t\t}\n\n\t\twhile( iterator.get() != null ) {\n\t\t\tconst buffer = new EShapeBuffer( this.getBufferSize(), renderer, shader );\n\t\t\tif( buffer.update( iterator ) ) {\n\t\t\t\tbuffers.push( buffer );\n\t\t\t} else {\n\t\t\t\tbuffer.destroy();\n\n\t\t\t\t// Again, increase the buffer size;\n\t\t\t\tif( ! this.increaseBufferSize() ) {\n\t\t\t\t\t// No way to render\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Point, Renderer } from \"pixi.js\";\nimport { DynamicAtlas } from \"../util/dynamic-atlas\";\nimport { DynamicSDFFontAtlases } from \"../util/dynamic-sdf-font-atlases\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport \"./e-shape-renderer\";\nimport { EShapeRenderer } from \"./e-shape-renderer\";\n\nexport class EShapeContainer extends DisplayObject {\n\tstatic SHAPE_RENDERER: EShapeRenderer | null = null;\n\n\treadonly children: EShape[];\n\tprotected _childrenId: number;\n\tprotected _childrenIdRendered: number;\n\n\tprotected _atlas: DynamicAtlas;\n\tprotected _fontAtlases: DynamicSDFFontAtlases;\n\n\tprotected _pixelScale: number;\n\tprotected _pixelScaleId: number;\n\n\tprotected _work: Point;\n\n\tprotected _buffers: EShapeBuffer[];\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.children = [];\n\n\t\tthis._childrenId = 0;\n\t\tthis._childrenIdRendered = -1;\n\n\t\tthis._atlas = new DynamicAtlas();\n\t\tthis._fontAtlases = new DynamicSDFFontAtlases();\n\n\t\tthis._pixelScale = 1;\n\t\tthis._pixelScaleId = NaN;\n\n\t\tthis._work = new Point();\n\n\t\tthis._buffers = [];\n\t}\n\n\tcalculateBounds(): void {\n\t\tthis._bounds.clear();\n\t}\n\n\tonChildTransformChange(): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoDirty(): number {\n\t\treturn this._childrenId += 1;\n\t}\n\n\tisDirty(): boolean {\n\t\treturn this._childrenIdRendered < this._childrenId;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tif( !this.visible || this.worldAlpha <= 0 || !this.renderable ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst childrenId = this._childrenId;\n\t\tconst childrenIdRendered = this._childrenIdRendered;\n\t\tthis._childrenIdRendered = childrenId;\n\n\t\tlet shapeRenderer: EShapeRenderer | null = EShapeContainer.SHAPE_RENDERER;\n\t\tif( shapeRenderer == null ) {\n\t\t\tshapeRenderer = EShapeContainer.SHAPE_RENDERER = new EShapeRenderer( renderer );\n\t\t}\n\t\trenderer.batch.setObjectRenderer( shapeRenderer );\n\t\tshapeRenderer.render_(\n\t\t\tthis, this.children, this._atlas, this._fontAtlases,\n\t\t\tchildrenIdRendered < childrenId, this._buffers\n\t\t);\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\tgetPixelScale(): number {\n\t\tthis.updateTransform();\n\t\tconst transform = this.transform;\n\t\tconst worldID = (transform as any)._worldID;\n\t\tif( worldID !== this._pixelScaleId ) {\n\t\t\tthis._pixelScaleId = worldID;\n\t\t\tconst worldTransform = transform.worldTransform;\n\t\t\tthis._pixelScale = 1 / Math.sqrt( worldTransform.a * worldTransform.a + worldTransform.b * worldTransform.b );\n\t\t}\n\t\treturn this._pixelScale;\n\t}\n\n\thitTest( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst work = this._work;\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.visible ) {\n\t\t\t\tconst childLocal = child.toLocal( global, undefined, work );\n\t\t\t\tconst childResult = child.contains( childLocal );\n\t\t\t\tif( childResult != null ) {\n\t\t\t\t\tif( handler == null || handler( childResult ) ) {\n\t\t\t\t\t\treturn childResult;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thitTestBBox( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst work = this._work;\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.visible ) {\n\t\t\t\tconst childLocal = child.toLocal( global, undefined, work );\n\t\t\t\tif( child.containsBBox( childLocal ) ) {\n\t\t\t\t\tif( handler == null || handler( child ) ) {\n\t\t\t\t\t\treturn child;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tdestroy(): void {\n\t\t// Buffer\n\t\tconst buffers = this._buffers;\n\t\tif( buffers != null ) {\n\t\t\tfor( let i = 0, imax = buffers.length; i < imax; ++i ) {\n\t\t\t\tbuffers[ i ].destroy();\n\t\t\t}\n\t\t}\n\t\tthis._buffers.length = 0;\n\n\t\t// Shapes\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeBase } from \"./variant/e-shape-base\";\n\nexport class EShapeSearch {\n\tstatic COMPARATOR_INDEX = ( a: EShape, b: EShape ): number => {\n\t\treturn a.index - b.index;\n\t}\n\n\tstatic toIndices( shapes: EShape[] ): number[] {\n\t\tconst result = [];\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tresult.push( shapes[ i ].index );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toDepth( shape: EShape ): number {\n\t\tlet result = 0;\n\t\tlet parent = shape.parent;\n\t\twhile( parent instanceof EShapeBase ) {\n\t\t\tresult += 1;\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toSharedParent( first: EShape, shape: EShape ): EShape | EShapeContainer {\n\t\tconst depthA = this.toDepth( first );\n\t\tconst depthB = this.toDepth( shape );\n\t\tif( depthA < depthB ) {\n\t\t\tlet parent = first.parent;\n\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\tif( this.isParent( shape, parent ) ) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\treturn parent!;\n\t\t} else {\n\t\t\tlet parent = shape.parent;\n\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\tif( this.isParent( first, parent ) ) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\treturn parent!;\n\t\t}\n\t}\n\n\tstatic toOfParent( shape: EShape, parent: EShape | EShapeContainer ) {\n\t\tlet shapeParent = shape.parent;\n\t\twhile( shapeParent !== parent && shapeParent instanceof EShapeBase ) {\n\t\t\tshape = shapeParent;\n\t\t\tshapeParent = shapeParent.parent;\n\t\t}\n\t\treturn shape;\n\t}\n\n\tstatic isParent( shape: EShape, target: EShape | null ): boolean {\n\t\tlet parent = shape.parent;\n\t\twhile( parent instanceof EShapeBase ) {\n\t\t\tif( parent === target ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic toSelected( shape: EShape ): EShape | null {\n\t\tlet target: EShape | EShapeContainer | null = shape;\n\t\twhile( target instanceof EShapeBase ) {\n\t\t\tif( target.selected ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t\ttarget = target.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildById( shape: { children: EShape[] }, id: string, recursively?: boolean ): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.id === id ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChildById( child, id, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildByType( shape: { children: EShape[] }, type: EShapeType, recursively?: boolean ): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.type === type ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChildByType( child, type, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChild(\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean\n\t): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( matcher( child ) ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChild( child, matcher, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildrenByType(\n\t\tshape: { children: EShape[] }, type: EShapeType, recursively?: boolean, result?: EShape[]\n\t): EShape[] {\n\t\tresult = result || [];\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.type === type ) {\n\t\t\t\tresult.push( child );\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tEShapeSearch.findChildrenByType( child, type, recursively, result );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic findChildren(\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean, result?: EShape[]\n\t): EShape[] {\n\t\tresult = result || [];\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( matcher( child ) ) {\n\t\t\t\tresult.push( child );\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tEShapeSearch.findChildren( child, matcher, recursively, result );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeSearch } from \"./e-shape-search\";\n\nexport class EShapeDeleter {\n\tstatic delete(\n\t\tparent: EShape | EShapeContainer, shapes?: EShape[], generateListOfDetachedShapes?: boolean\n\t): EShape[] | null {\n\t\tconst children = parent.children;\n\t\tconst length = children.length;\n\n\t\t// Update indices\n\t\tfor( let i = 0; i < length; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.selected ) {\n\t\t\t\tchild.index = length + i;\n\t\t\t} else {\n\t\t\t\tchild.index = i;\n\t\t\t}\n\t\t}\n\n\t\t// Sort\n\t\tchildren.sort( EShapeSearch.COMPARATOR_INDEX );\n\n\t\t// Detach\n\t\tif( generateListOfDetachedShapes === true ) {\n\t\t\tfor( let i = length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.selected ) {\n\t\t\t\t\tchild.index -= length;\n\t\t\t\t\tchild.parent = null;\n\t\t\t\t\tchild.selected = false;\n\t\t\t\t\tchild.uploaded = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tconst size = children.length - (i + 1);\n\t\t\t\t\tif( 0 < size ) {\n\t\t\t\t\t\tconst result = children.splice( i + 1, size );\n\t\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.onChildTransformChange();\n\t\t\t\t\t\tparent.toDirty();\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tconst result = children.splice( 0, children.length );\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\tfor( let i = length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.selected ) {\n\t\t\t\t\tchild.parent = null;\n\t\t\t\t\tchild.selected = false;\n\t\t\t\t\tchild.uploaded = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tchildren.length = i + 1;\n\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t}\n\t\t\t\t\tparent.onChildTransformChange();\n\t\t\t\t\tparent.toDirty();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tchildren.length = 0;\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t} else {\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class EShapeResourceManagerSerialization {\n\tprotected resources: string[];\n\tprotected resourceToIndex: Map<string, number>;\n\n\tconstructor() {\n\t\tthis.resources = [];\n\t\tthis.resourceToIndex = new Map<string, number>();\n\t}\n\n\tadd( resource: string ): number {\n\t\tconst resources = this.resources;\n\t\tconst resourceToIndex = this.resourceToIndex;\n\t\tconst result = resourceToIndex.get( resource );\n\t\tif( result != null ) {\n\t\t\treturn result;\n\t\t}\n\t\tconst index = resources.length;\n\t\tresources.push( resource );\n\t\tresourceToIndex.set( resource, index );\n\t\treturn index;\n\t}\n\n\tserialize(): string[] {\n\t\treturn this.resources;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeRuntime } from \"./e-shape-runtime\";\n\nexport const EShapeRuntimes: {\n\t[ type: number ]: (new ( shape: EShape ) => EShapeRuntime) | undefined\n} = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisPosition, DChartAxisTickPosition } from \"../../d-chart-axis\";\nimport { DThemeChartAxisBase } from \"../../d-chart-axis-base-options\";\nimport { EShapePointsStyle } from \"../../shape\";\nimport { EShapeTextAlignHorizontal } from \"../../shape/e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../../shape/e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"../../shape/e-shape-text-direction\";\n\nexport class DThemeWhiteChartAxisBase implements DThemeChartAxisBase {\n\tgetPosition(): DChartAxisPosition {\n\t\treturn DChartAxisPosition.BOTTOM;\n\t}\n\n\tgetPadding(): number {\n\t\treturn 75;\n\t}\n\n\tgetLabelAlignHorizontal( position: DChartAxisPosition ): EShapeTextAlignHorizontal {\n\t\tswitch( position ) {\n\t\tcase DChartAxisPosition.TOP:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase DChartAxisPosition.LEFT:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\t\tcase DChartAxisPosition.RIGHT:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\t\t}\n\t}\n\n\tgetLabelAlignVertical( position: DChartAxisPosition ): EShapeTextAlignVertical {\n\t\tswitch( position ) {\n\t\tcase DChartAxisPosition.TOP:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\t\tcase DChartAxisPosition.LEFT:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\tcase DChartAxisPosition.RIGHT:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\t}\n\t}\n\n\tgetLabelPaddingHorizontal(): number {\n\t\treturn 50;\n\t}\n\n\tgetLabelPaddingVertical(): number {\n\t\treturn 50;\n\t}\n\n\tgetLabelDirection(): EShapeTextDirection {\n\t\treturn EShapeTextDirection.LEFT_TO_RIGHT;\n\t}\n\n\tgetTickEnable(): boolean {\n\t\treturn true;\n\t}\n\n\tgetMajorTickCount(): number {\n\t\treturn 3;\n\t}\n\n\tgetMajorTickSize(): number {\n\t\treturn 10;\n\t}\n\n\tgetMajorTickPosition(): DChartAxisTickPosition {\n\t\treturn DChartAxisTickPosition.OUTSIDE;\n\t}\n\n\tgetMajorTickStyle(): EShapePointsStyle {\n\t\treturn EShapePointsStyle.NONE;\n\t}\n\n\tgetMajorTickTextAlignHorizontal( position: DChartAxisPosition ): EShapeTextAlignHorizontal {\n\t\tswitch( position ) {\n\t\tcase DChartAxisPosition.TOP:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t\tcase DChartAxisPosition.LEFT:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\t\tcase DChartAxisPosition.RIGHT:\n\t\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\t\t}\n\t}\n\n\tgetMajorTickTextAlignVertical( position: DChartAxisPosition ): EShapeTextAlignVertical {\n\t\tswitch( position ) {\n\t\tcase DChartAxisPosition.TOP:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\t\tcase DChartAxisPosition.LEFT:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\tcase DChartAxisPosition.RIGHT:\n\t\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t\t}\n\t}\n\n\tgetMajorTickTextDirection(): EShapeTextDirection {\n\t\treturn EShapeTextDirection.LEFT_TO_RIGHT;\n\t}\n\n\tgetMajorTickTextFormat(): string {\n\t\treturn \"%YMD\\n%Hms.%mi\";\n\t}\n\n\tgetMajorTickTextPaddingHorizontal(): number {\n\t\treturn 15;\n\t}\n\n\tgetMajorTickTextPaddingVertical(): number {\n\t\treturn 15;\n\t}\n\n\tgetMinorTickCount(): number {\n\t\treturn 3;\n\t}\n\n\tgetMinorTickSize(): number {\n\t\treturn 5;\n\t}\n\n\tgetMinorTickPosition(): DChartAxisTickPosition {\n\t\treturn DChartAxisTickPosition.OUTSIDE;\n\t}\n\n\tgetMinorTickStyle(): EShapePointsStyle {\n\t\treturn EShapePointsStyle.NONE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteChartAxisBase } from \"./d-theme-white-chart-axis-base\";\n\nexport class DThemeWhiteChartAxisX extends DThemeWhiteChartAxisBase {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisPosition } from \"../../d-chart-axis\";\nimport { EShapeTextDirection } from \"../../shape/e-shape-text-direction\";\nimport { DThemeWhiteChartAxisBase } from \"./d-theme-white-chart-axis-base\";\n\nexport class DThemeWhiteChartAxisY extends DThemeWhiteChartAxisBase {\n\tgetPosition(): DChartAxisPosition {\n\t\treturn DChartAxisPosition.LEFT;\n\t}\n\n\tgetMajorTickTextFormat(): string {\n\t\treturn \"%ssi\";\n\t}\n\n\tgetLabelDirection(): EShapeTextDirection {\n\t\treturn EShapeTextDirection.BOTTOM_TO_TOP;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeChartCoordinateLinear } from \"../../d-chart-coordinate-linear\";\n\nexport class DThemeWhiteChartCoordinateLinear implements DThemeChartCoordinateLinear {\n\tgetPadding(): number {\n\t\treturn 10;\n\t}\n\n\tisZero( value: number ): boolean {\n\t\treturn Math.abs( value ) < 0.00001;\n\t}\n\n\ttoStepScale( scale: number ): number {\n\t\tif( 5.5 <= scale ) {\n\t\t\treturn 10;\n\t\t} else if( 2.2 <= scale ) {\n\t\t\treturn 5;\n\t\t} else if( 1.1 <= scale ) {\n\t\t\treturn 2;\n\t\t}\n\t\treturn 1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDiagramBase } from \"../../d-diagram-base\";\nimport { DThemeWhiteCanvasContainer } from \"./d-theme-white-canvas-container\";\n\nexport class DThemeWhiteDiagramBase extends DThemeWhiteCanvasContainer implements DThemeDiagramBase {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDiagram } from \"../../d-diagram\";\nimport { DThemeWhiteDiagramBase } from \"./d-theme-white-diagram-base\";\n\nexport class DThemeWhiteDiagram extends DThemeWhiteDiagramBase implements DThemeDiagram {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDiagramCanvasBase } from \"../../d-diagram-canvas-base\";\nimport { DThemeWhiteCanvas } from \"./d-theme-white-canvas\";\n\nexport class DThemeWhiteDiagramCanvasBase extends DThemeWhiteCanvas implements DThemeDiagramCanvasBase {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDiagramCanvas } from \"../../d-diagram-canvas\";\nimport { DThemeWhiteDiagramCanvasBase } from \"./d-theme-white-diagram-canvas-base\";\n\nexport class DThemeWhiteDiagramCanvas extends DThemeWhiteDiagramCanvasBase implements DThemeDiagramCanvas {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDiagram } from \"../theme/white/d-theme-white-diagram\";\nimport { DThemeWhiteDiagramCanvas } from \"../theme/white/d-theme-white-diagram-canvas\";\n\nexport const loadThemeWhiteDiagram = () => {\n\tDThemeWhite.set( \"DDiagram\", DThemeWhiteDiagram );\n\tDThemeWhite.set( \"DDiagramCanvas\", DThemeWhiteDiagramCanvas );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDiagramCanvasEditor } from \"../../d-diagram-canvas-editor\";\nimport { DThemeWhiteDiagramCanvasBase } from \"./d-theme-white-diagram-canvas-base\";\n\nexport class DThemeWhiteDiagramCanvasEditor extends DThemeWhiteDiagramCanvasBase implements DThemeDiagramCanvasEditor {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDiagramEditor } from \"../../d-diagram-editor\";\nimport { DMouseModifier } from \"../../d-mouse-modifier\";\nimport { DThemeWhiteDiagramBase } from \"./d-theme-white-diagram-base\";\n\nexport class DThemeWhiteDiagramEditor extends DThemeWhiteDiagramBase implements DThemeDiagramEditor {\n\tisDblClickZoomEnabled(): boolean {\n\t\treturn false;\n\t}\n\n\tgetDragModifier(): DMouseModifier {\n\t\treturn DMouseModifier.ALT;\n\t}\n}\n","import { EShapeActionValue, EThemeShapeActionValue } from \"../../shape/action/e-shape-action-value\";\nimport { EShapeActionValueBase } from \"../../shape/action/e-shape-action-value-base\";\nimport { EShapeActionValueBlinkType } from \"../../shape/action/e-shape-action-value-blink-type\";\nimport {\n\tEShapeActionValueChangeColorTarget, EShapeActionValueChangeColorType\n} from \"../../shape/action/e-shape-action-value-change-color-type\";\nimport { EShapeActionValueChangeTextType } from \"../../shape/action/e-shape-action-value-change-text-type\";\nimport { EShapeActionValueMiscType } from \"../../shape/action/e-shape-action-value-misc-type\";\nimport { EShapeActionValueOpenType } from \"../../shape/action/e-shape-action-value-open-type\";\nimport { EShapeActionValueOpetyped } from \"../../shape/action/e-shape-action-value-opetyped\";\nimport { EShapeActionValueShowHideType } from \"../../shape/action/e-shape-action-value-show-hide-type\";\nimport { EShapeActionValueSubtyped } from \"../../shape/action/e-shape-action-value-subtyped\";\nimport { EShapeActionValueTransformMoveType } from \"../../shape/action/e-shape-action-value-transform-move-type\";\nimport { EShapeActionValueTransformResizeType } from \"../../shape/action/e-shape-action-value-transform-resize-type\";\nimport { EShapeActionValueTransformRotateType } from \"../../shape/action/e-shape-action-value-transform-rotate-type\";\nimport { EShapeActionValueTransformType } from \"../../shape/action/e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"../../shape/action/e-shape-action-value-type\";\n\nexport class EThemeWhiteShapeActionValue implements EThemeShapeActionValue {\n\ttoLabel( value: EShapeActionValue ): string {\n\t\tconst type = value.type;\n\t\tif( value instanceof EShapeActionValueSubtyped ) {\n\t\t\tconst subtype = value.subtype;\n\t\t\tif( value instanceof EShapeActionValueOpetyped ) {\n\t\t\t\tconst result = this.toOpetypedLabel( type, subtype, value.opetype, value );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst result = this.toSubtypedLabel( type, subtype, value );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn this.toTypedLabel( type, value );\n\t}\n\n\tprotected toTypedLabel( type: EShapeActionValueType, value: EShapeActionValueBase ): string {\n\t\treturn `${this.toTypeLabel( type )}: ${this.toConditionLabel( value.condition )}`;\n\t}\n\n\tprotected toSubtypedLabel(\n\t\ttype: EShapeActionValueType, subtype: number, value: EShapeActionValueSubtyped<any>\n\t): string | null {\n\t\tconst typeLabel = this.toTypeLabel( type );\n\t\tswitch( type ) {\n\t\tcase EShapeActionValueType.SHOW_HIDE:\n\t\t\treturn `${this.toShowHideTypeLabel( subtype )}`;\n\t\tcase EShapeActionValueType.BLINK:\n\t\t\treturn `${typeLabel}: ${this.toBlinkTypeLabel( subtype )}`;\n\t\tcase EShapeActionValueType.CHANGE_COLOR:\n\t\t\treturn `${typeLabel}: ${this.toChangeColorTypeLabel( subtype )}`;\n\t\tcase EShapeActionValueType.MISC:\n\t\t\treturn `${typeLabel}: ${this.toMiscTypeLabel( subtype )}`;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected toOpetypedLabel(\n\t\ttype: EShapeActionValueType, subtype: number, opetype: number, value: EShapeActionValueOpetyped<any, any>\n\t): string | null {\n\t\tswitch( type ) {\n\t\tcase EShapeActionValueType.TRANSFORM:\n\t\t\tconst subtypeLabel = this.toTransformTypeLabel( subtype );\n\t\t\tswitch( subtype ) {\n\t\t\tcase EShapeActionValueTransformType.ROTATE:\n\t\t\t\treturn `${subtypeLabel}: ${this.toTransformRotateTypeLabel( opetype )}`;\n\t\t\tcase EShapeActionValueTransformType.MOVE:\n\t\t\t\treturn `${subtypeLabel}: ${this.toTransformMoveTypeLabel( opetype )}`;\n\t\t\tcase EShapeActionValueTransformType.RESIZE:\n\t\t\t\treturn `${subtypeLabel}: ${this.toTransformResizeTypeLabel( opetype )}`;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\ttoTypeLabel( type: EShapeActionValueType ): string {\n\t\tswitch( type ) {\n\t\tcase EShapeActionValueType.SHOW_HIDE:\n\t\t\treturn \"Show / hide\";\n\t\tcase EShapeActionValueType.BLINK:\n\t\t\treturn \"Blink\";\n\t\tcase EShapeActionValueType.TRANSFORM:\n\t\t\treturn \"Transform\";\n\t\tcase EShapeActionValueType.OPEN:\n\t\t\treturn \"Open\";\n\t\tcase EShapeActionValueType.CHANGE_COLOR:\n\t\t\treturn \"Change color\";\n\t\tcase EShapeActionValueType.CHANGE_TEXT:\n\t\t\treturn \"Change text\";\n\t\tcase EShapeActionValueType.CHANGE_CURSOR:\n\t\t\treturn \"Change cursor\";\n\t\tcase EShapeActionValueType.EMIT_EVENT:\n\t\t\treturn \"Emit an event\";\n\t\tcase EShapeActionValueType.MISC:\n\t\t\treturn \"Misc.\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoConditionLabel( condition: string ): string {\n\t\tconst l = 20;\n\t\tif( l < condition.length ) {\n\t\t\treturn condition.substring( 0, l ) + \"...\";\n\t\t} else {\n\t\t\treturn condition;\n\t\t}\n\t}\n\n\ttoBlinkTypeLabel( type: EShapeActionValueBlinkType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueBlinkType.VISIBILITY:\n\t\t\treturn \"Visibility\";\n\t\tcase EShapeActionValueBlinkType.BRIGHTEN:\n\t\t\treturn \"Brighten\";\n\t\tcase EShapeActionValueBlinkType.DARKEN:\n\t\t\treturn \"Darken\";\n\t\tcase EShapeActionValueBlinkType.OPACITY:\n\t\t\treturn \"Opacity\";\n\t\tcase EShapeActionValueBlinkType.COLOR_FILL:\n\t\t\treturn \"Fill\";\n\t\tcase EShapeActionValueBlinkType.COLOR_STROKE:\n\t\t\treturn \"Stroke\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoShowHideTypeLabel( type: EShapeActionValueShowHideType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueShowHideType.SHOW:\n\t\t\treturn \"Show\";\n\t\tcase EShapeActionValueShowHideType.HIDE:\n\t\t\treturn \"Hide\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoTransformTypeLabel( type: EShapeActionValueTransformType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueTransformType.RESIZE:\n\t\t\treturn \"Resize\";\n\t\tcase EShapeActionValueTransformType.MOVE:\n\t\t\treturn \"Move\";\n\t\tcase EShapeActionValueTransformType.ROTATE:\n\t\t\treturn \"Rotate\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoTransformRotateTypeLabel( type: EShapeActionValueTransformRotateType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueTransformRotateType.RELATIVE:\n\t\t\treturn \"Relative\";\n\t\tcase EShapeActionValueTransformRotateType.ABSOLUTE:\n\t\t\treturn \"Absolute\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoTransformMoveTypeLabel( type: EShapeActionValueTransformMoveType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_X:\n\t\t\treturn \"Relative X\";\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_Y:\n\t\t\treturn \"Relative Y\";\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_X:\n\t\t\treturn \"Absolute X\";\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_Y:\n\t\t\treturn \"Absolute Y\";\n\t\tcase EShapeActionValueTransformMoveType.FORWARD_OR_BACKWARD:\n\t\t\treturn \"Forward / backward\";\n\t\tcase EShapeActionValueTransformMoveType.LEFT_OR_RIGHT:\n\t\t\treturn \"Left / right\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoTransformResizeTypeLabel( type: EShapeActionValueTransformResizeType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_SIZE:\n\t\t\treturn \"Height & width\";\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_SIZE:\n\t\t\treturn \"Height & width (%)\";\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_HEIGHT:\n\t\t\treturn \"Height\";\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_HEIGHT:\n\t\t\treturn \"Height (%)\";\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_WIDTH:\n\t\t\treturn \"Width\";\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_WIDTH:\n\t\t\treturn \"Width (%)\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoChangeColorTypeLabel( type: EShapeActionValueChangeColorType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueChangeColorType.FILL:\n\t\t\treturn \"Fill\";\n\t\tcase EShapeActionValueChangeColorType.STROKE:\n\t\t\treturn \"Stroke\";\n\t\tcase EShapeActionValueChangeColorType.FILL_AND_STROKE:\n\t\t\treturn \"Fill and stroke\";\n\t\tcase EShapeActionValueChangeColorType.TEXT:\n\t\t\treturn \"Text\";\n\t\tcase EShapeActionValueChangeColorType.TEXT_OUTLINE:\n\t\t\treturn \"Text outline\";\n\t\tcase EShapeActionValueChangeColorType.ALL:\n\t\t\treturn \"ALL\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoChangeColorTargetLabel( type: EShapeActionValueChangeColorTarget ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueChangeColorTarget.COLOR_AND_ALPHA:\n\t\t\treturn \"Color\";\n\t\tcase EShapeActionValueChangeColorTarget.COLOR:\n\t\t\treturn \"RGB\";\n\t\tcase EShapeActionValueChangeColorTarget.ALPHA:\n\t\t\treturn \"Alpha\";\n\t\tcase EShapeActionValueChangeColorTarget.CODE:\n\t\t\treturn \"Dynamic color\";\n\t\tcase EShapeActionValueChangeColorTarget.BRIGHTNESS:\n\t\t\treturn \"Brightness\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoChangeTextTypeLabel( type: EShapeActionValueChangeTextType ): string {\n\t\tswitch( type ) {\n\t\tcase EShapeActionValueChangeTextType.TEXT:\n\t\t\treturn \"Text\";\n\t\tcase EShapeActionValueChangeTextType.NUMBER:\n\t\t\treturn \"Number\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoOpenTypeLabel( type: EShapeActionValueOpenType ): string {\n\t\tswitch (type) {\n\t\tcase EShapeActionValueOpenType.FLOW:\n\t\t\treturn \"Flow\";\n\t\tcase EShapeActionValueOpenType.PAGE:\n\t\t\treturn \"Page (New window)\";\n\t\tcase EShapeActionValueOpenType.PAGE_INPLACE:\n\t\t\treturn \"Page (In-place)\";\n\t\t}\n\t\treturn \"Unknown\";\n\t}\n\n\ttoMiscTypeLabel( type: EShapeActionValueMiscType ): string {\n\t\tswitch( type ) {\n\t\tcase EShapeActionValueMiscType.INPUT:\n\t\t\treturn \"Input\";\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { EThemeWhiteShapeActionValue } from \"../theme/white/e-theme-white-shape-action-value\";\n\nexport const loadThemeWhiteShapeActionValue = () => {\n\tDThemeWhite.set( \"EShapeActionValue\", EThemeWhiteShapeActionValue );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDiagramCanvasEditor } from \"../theme/white/d-theme-white-diagram-canvas-editor\";\nimport { DThemeWhiteDiagramEditor } from \"../theme/white/d-theme-white-diagram-editor\";\nimport { loadThemeWhiteShapeActionValue } from \"./load-theme-white-shape-action-value\";\n\nexport const loadThemeWhiteDiagramEditor = () => {\n\tDThemeWhite.set( \"DDiagramEditor\", DThemeWhiteDiagramEditor );\n\tDThemeWhite.set( \"DDiagramCanvasEditor\", DThemeWhiteDiagramCanvasEditor );\n\tloadThemeWhiteShapeActionValue();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialog } from \"../theme/white/d-theme-white-dialog\";\n\nexport const loadThemeWhiteDialog = () => {\n\tDThemeWhite.set( \"DDialog\", DThemeWhiteDialog );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogCommand } from \"../theme/white/d-theme-white-dialog-command\";\n\nexport const loadThemeWhiteDialogCommand = () => {\n\tDThemeWhite.set( \"DDialogCommand\", DThemeWhiteDialogCommand );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDialogConfirm } from \"../../d-dialog-confirm\";\nimport { DStateAwareOrValue } from \"../../d-state-aware\";\nimport { DThemeWhiteDialogCommand } from \"./d-theme-white-dialog-command\";\n\nexport class DThemeWhiteDialogConfirm extends DThemeWhiteDialogCommand implements DThemeDialogConfirm {\n\tgetOk(): string | null {\n\t\treturn \"Yes\";\n\t}\n\n\tgetCancel(): string | null {\n\t\treturn \"No\";\n\t}\n\n\tgetMessage(): DStateAwareOrValue<string> {\n\t\treturn \"\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeImage } from \"../../d-image\";\nimport { DThemeWhiteImageBase } from \"./d-theme-white-image-base\";\n\nexport class DThemeWhiteImage extends DThemeWhiteImageBase implements DThemeImage {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogConfirmMessage } from \"../../d-dialog-confirm-message\";\nimport { DThemeWhiteImage } from \"./d-theme-white-image\";\n\nexport class DThemeWhiteDialogConfirmMessage extends DThemeWhiteImage implements DThemeDialogConfirmMessage {\n\tgetWidth(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetHeight(): number {\n\t\treturn 200;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogConfirm } from \"../theme/white/d-theme-white-dialog-confirm\";\nimport { DThemeWhiteDialogConfirmMessage } from \"../theme/white/d-theme-white-dialog-confirm-message\";\n\nexport const loadThemeWhiteDialogConfirm = () => {\n\tDThemeWhite.set( \"DDialogConfirm\", DThemeWhiteDialogConfirm );\n\tDThemeWhite.set( \"DDialogConfirmMessage\", DThemeWhiteDialogConfirmMessage );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DStateAwareOrValue } from \"../../d-state-aware\";\nimport { DThemeWhiteDialogConfirm } from \"./d-theme-white-dialog-confirm\";\n\nexport class DThemeWhiteDialogConfirmDelete extends DThemeWhiteDialogConfirm {\n\tgetMessage(): DStateAwareOrValue<string> {\n\t\treturn \"Are you sure you want to delete this data?\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogConfirmDelete } from \"../theme/white/d-theme-white-dialog-confirm-delete\";\n\nexport const loadThemeWhiteDialogConfirmDelete = () => {\n\tDThemeWhite.set( \"DDialogConfirmDelete\", DThemeWhiteDialogConfirmDelete );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DStateAwareOrValue } from \"../../d-state-aware\";\nimport { DThemeWhiteDialogConfirm } from \"./d-theme-white-dialog-confirm\";\n\nexport class DThemeWhiteDialogConfirmDiscard extends DThemeWhiteDialogConfirm {\n\tgetMessage(): DStateAwareOrValue<string> {\n\t\treturn \"Your changes have not been saved.\\n\" +\n\t\t\t\"Do you want to discard the changes and continue?\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogConfirmDiscard } from \"../theme/white/d-theme-white-dialog-confirm-discard\";\n\nexport const loadThemeWhiteDialogConfirmDiscard = () => {\n\tDThemeWhite.set( \"DDialogConfirmDiscard\", DThemeWhiteDialogConfirmDiscard );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeDialogInputText } from \"../../d-dialog-input-text\";\nimport { DThemeWhiteDialog } from \"./d-theme-white-dialog\";\n\nexport class DThemeWhiteDialogInputText extends DThemeWhiteDialog implements DThemeDialogInputText {\n\tgetOk(): string {\n\t\treturn \"OK\";\n\t}\n\n\tgetCancel(): string {\n\t\treturn \"Cancel\";\n\t}\n\n\tgetLabel(): string {\n\t\treturn \"\";\n\t}\n\n\tgetLabelWidth(): number {\n\t\treturn 60;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogInputText } from \"../theme/white/d-theme-white-dialog-input-text\";\n\nexport const loadThemeWhiteDialogInputText = () => {\n\tDThemeWhite.set( \"DDialogInputText\", DThemeWhiteDialogInputText );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDialogMessage } from \"../../d-dialog-message\";\nimport { DThemeWhiteDialogConfirm } from \"./d-theme-white-dialog-confirm\";\n\nexport class DThemeWhiteDialogMessage extends DThemeWhiteDialogConfirm implements DThemeDialogMessage {\n\tgetOk(): string | null {\n\t\treturn \"OK\";\n\t}\n\n\tgetCancel(): string | null {\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogMessage } from \"../theme/white/d-theme-white-dialog-message\";\n\nexport const loadThemeWhiteDialogMessage = () => {\n\tDThemeWhite.set( \"DDialogMessage\", DThemeWhiteDialogMessage );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeDialogProcessing } from \"../../d-dialog-processing\";\nimport { DStateAwareOrValue } from \"../../d-state-aware\";\nimport { DThemeWhiteDialogConfirm } from \"./d-theme-white-dialog-confirm\";\n\nconst message = ( state: DBaseState ): string => {\n\tif( DBaseStates.isSucceeded( state ) ) {\n\t\treturn \"Processed successfully\";\n\t} else if( DBaseStates.isFailed( state ) ) {\n\t\treturn \"Failed to process the request\";\n\t} else {\n\t\treturn \"Processing...\";\n\t}\n};\n\nexport class DThemeWhiteDialogProcessing extends DThemeWhiteDialogConfirm implements DThemeDialogProcessing {\n\tgetOk(): string | null {\n\t\treturn \"OK\";\n\t}\n\n\tgetCancel(): string | null {\n\t\treturn null;\n\t}\n\n\tgetMessage(): DStateAwareOrValue<string> {\n\t\treturn message;\n\t}\n\n\tgetInterval(): number {\n\t\treturn 400;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteDialogConfirmMessage } from \"./d-theme-white-dialog-confirm-message\";\n\nexport class DThemeWhiteDialogProcessingMessage extends DThemeWhiteDialogConfirmMessage {\n\tgetHeight(): number {\n\t\treturn 90;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogProcessing } from \"../theme/white/d-theme-white-dialog-processing\";\nimport { DThemeWhiteDialogProcessingMessage } from \"../theme/white/d-theme-white-dialog-processing-message\";\n\nexport const loadThemeWhiteDialogProcessing = () => {\n\tDThemeWhite.set( \"DDialogProcessing\", DThemeWhiteDialogProcessing );\n\tDThemeWhite.set( \"DDialogProcessingMessage\", DThemeWhiteDialogProcessingMessage );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDialogSaveAs } from \"../../d-dialog-save-as\";\nimport { DThemeWhiteDialogInputText } from \"./d-theme-white-dialog-input-text\";\n\nexport class DThemeWhiteDialogSaveAs extends DThemeWhiteDialogInputText implements DThemeDialogSaveAs {\n\tgetOk(): string {\n\t\treturn \"Save\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogSaveAs } from \"../theme/white/d-theme-white-dialog-save-as\";\n\nexport const loadThemeWhiteDialogSaveAs = () => {\n\tDThemeWhite.set( \"DDialogSaveAs\", DThemeWhiteDialogSaveAs );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeDialogSelect } from \"../../d-dialog-select\";\nimport { DThemeWhiteDialog } from \"./d-theme-white-dialog\";\n\nexport class DThemeWhiteDialogSelect extends DThemeWhiteDialog implements DThemeDialogSelect {\n\tgetNoteNoItemsText(): string {\n\t\treturn \"No Items\";\n\t}\n\n\tgetNoteSearchingText(): string {\n\t\treturn \"Searching...\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DDragMode } from \"../../d-drag-mode\";\nimport { DThemePane } from \"../../d-pane\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\n\nexport class DThemeWhitePane extends DThemeWhiteBase implements DThemePane {\n\tisOverflowMaskEnabled() {\n\t\treturn true;\n\t}\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteConstants.BACKGROUND_COLOR;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n\n\tgetWheelSpeed(): number {\n\t\treturn 2.24;\n\t}\n\n\tgetDragMode(): DDragMode {\n\t\treturn DDragMode.TOUCH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeWhitePane } from \"./d-theme-white-pane\";\n\nexport class DThemeWhiteList extends DThemeWhitePane {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn 0xffffff;\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeDialogSelecList } from \"../../d-dialog-select-list\";\nimport { DThemeWhiteList } from \"./d-theme-white-list\";\n\nexport class DThemeWhiteDialogSelectList extends DThemeWhiteList implements DThemeDialogSelecList {\n\tgetBackgroundColor(): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderColor(): number | null {\n\t\treturn null;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 250;\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DCornerMask.ALL;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeListItem } from \"../../d-list-item\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteImage } from \"./d-theme-white-image\";\n\nexport class DThemeWhiteListItem extends DThemeWhiteImage implements DThemeListItem {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteConstants.HIGHLIGHT_ALPHA;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n\n\tgetCornerMask(): number {\n\t\treturn DCornerMask.ALL;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeDialogSelecListItem } from \"../../d-dialog-select-list-item\";\nimport { DThemeWhiteFont } from \"./d-theme-white-font\";\nimport { DThemeWhiteListItem } from \"./d-theme-white-list-item\";\n\nexport class DThemeWhiteDialogSelectListItem extends DThemeWhiteListItem implements DThemeDialogSelecListItem {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn super.getBackgroundColor( state & ~DBaseState.ACTIVE );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn super.getBackgroundAlpha( state & ~DBaseState.ACTIVE );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteFont.getColor( state );\n\t}\n\n\tgetCornerMask(): number {\n\t\treturn DCornerMask.NONE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDialogSelect } from \"../theme/white/d-theme-white-dialog-select\";\nimport { DThemeWhiteDialogSelectList } from \"../theme/white/d-theme-white-dialog-select-list\";\nimport { DThemeWhiteDialogSelectListItem } from \"../theme/white/d-theme-white-dialog-select-list-item\";\n\nexport const loadThemeWhiteDialogSelect = () => {\n\tDThemeWhite.set( \"DDialogSelect\", DThemeWhiteDialogSelect );\n\tDThemeWhite.set( \"DDialogSelectList\", DThemeWhiteDialogSelectList );\n\tDThemeWhite.set( \"DDialogSelectListItem\", DThemeWhiteDialogSelectListItem );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadThemeWhiteDialog } from \"./load-theme-white-dialog\";\nimport { loadThemeWhiteDialogColor } from \"./load-theme-white-dialog-color\";\nimport { loadThemeWhiteDialogColorGradient } from \"./load-theme-white-dialog-color-gradient\";\nimport { loadThemeWhiteDialogCommand } from \"./load-theme-white-dialog-command\";\nimport { loadThemeWhiteDialogConfirm } from \"./load-theme-white-dialog-confirm\";\nimport { loadThemeWhiteDialogConfirmDelete } from \"./load-theme-white-dialog-confirm-delete\";\nimport { loadThemeWhiteDialogConfirmDiscard } from \"./load-theme-white-dialog-confirm-discard\";\nimport { loadThemeWhiteDialogDate } from \"./load-theme-white-dialog-date\";\nimport { loadThemeWhiteDialogDatetime } from \"./load-theme-white-dialog-datetime\";\nimport { loadThemeWhiteDialogInputText } from \"./load-theme-white-dialog-input-text\";\nimport { loadThemeWhiteDialogMessage } from \"./load-theme-white-dialog-message\";\nimport { loadThemeWhiteDialogProcessing } from \"./load-theme-white-dialog-processing\";\nimport { loadThemeWhiteDialogSaveAs } from \"./load-theme-white-dialog-save-as\";\nimport { loadThemeWhiteDialogSelect } from \"./load-theme-white-dialog-select\";\nimport { loadThemeWhiteDialogTime } from \"./load-theme-white-dialog-time\";\n\nexport const loadThemeWhiteDialogAll = () => {\n\tloadThemeWhiteDialogColorGradient();\n\tloadThemeWhiteDialogColor();\n\tloadThemeWhiteDialogCommand();\n\tloadThemeWhiteDialogConfirmDelete();\n\tloadThemeWhiteDialogConfirmDiscard();\n\tloadThemeWhiteDialogConfirm();\n\tloadThemeWhiteDialogDate();\n\tloadThemeWhiteDialogDatetime();\n\tloadThemeWhiteDialogInputText();\n\tloadThemeWhiteDialogMessage();\n\tloadThemeWhiteDialogProcessing();\n\tloadThemeWhiteDialogSaveAs();\n\tloadThemeWhiteDialogSelect();\n\tloadThemeWhiteDialogTime();\n\tloadThemeWhiteDialog();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeDropdown } from \"../../d-dropdown\";\nimport { DStateAwareOrValueMightBe } from \"../../d-state-aware\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteButtonBase } from \"./d-theme-white-button-base\";\n\nDThemeWhiteAtlas.add( \"dropdown_mark\", 20, 14,\n\t`<g>` +\n\t\t`<polyline fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" points=\"16 5 10 11 4 5\"></polyline>` +\n\t`</g>`\n);\n\nexport class DThemeWhiteDropdown extends DThemeWhiteButtonBase implements DThemeDropdown {\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.PADDING;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn - this.getPaddingRight() * 0.5;\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\treturn DThemeWhiteAtlas.mappings.dropdown_mark;\n\t}\n\n\tnewTextValue(): DStateAwareOrValueMightBe<string> {\n\t\treturn \"\";\n\t}\n\n\tgetTextValue( state: DBaseState ): string {\n\t\treturn \"\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DLayoutDirection, DThemeLayout } from \"../../d-layout\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteLayout extends DThemeWhiteBase implements DThemeLayout {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 5;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.CHILDREN;\n\t}\n\n\tgetDirection(): DLayoutDirection {\n\t\treturn DLayoutDirection.VERTICAL;\n\t}\n\n\tgetCornerAdjust(): boolean {\n\t\treturn false;\n\t}\n\n\tgetMultiplicity(): number {\n\t\treturn 1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DLayoutDirection } from \"../../d-layout\";\nimport { DThemeLayoutVertical } from \"../../d-layout-vertical\";\nimport { DThemeWhiteLayout } from \"./d-theme-white-layout\";\n\nexport class DThemeWhiteLayoutVertical extends DThemeWhiteLayout implements DThemeLayoutVertical {\n\tgetDirection(): DLayoutDirection {\n\t\treturn DLayoutDirection.VERTICAL;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeMenu } from \"../../d-menu\";\nimport { DShadow } from \"../../d-shadow\";\nimport { DThemeWhiteLayoutVertical } from \"./d-theme-white-layout-vertical\";\n\nexport class DThemeWhiteMenu extends DThemeWhiteLayoutVertical implements DThemeMenu {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn 0xffffff;\n\t}\n\n\tgetOffsetX(): number {\n\t\treturn 5;\n\t}\n\n\tgetOffsetY(): number {\n\t\treturn 5;\n\t}\n\n\tgetPaddingTop(): number {\n\t\treturn 5;\n\t}\n\n\tgetPaddingBottom(): number {\n\t\treturn 5;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 200;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 0;\n\t}\n\n\tgetShadow(): DShadow | null {\n\t\treturn this.newShadowWeak();\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeMenuItem } from \"../../d-menu-item\";\nimport { DThemeWhiteListItem } from \"./d-theme-white-list-item\";\n\nexport class DThemeWhiteMenuItem extends DThemeWhiteListItem implements DThemeMenuItem {\n\tgetPaddingLeft(): number {\n\t\treturn this.getPaddingRight();\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 26;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeMenuItemText } from \"../../d-menu-item-text\";\nimport { DThemeWhiteMenuItem } from \"./d-theme-white-menu-item\";\n\nexport class DThemeWhiteMenuItemText extends DThemeWhiteMenuItem implements DThemeMenuItemText {\n\tgetShortcutTextMargin(): number {\n\t\treturn this.getPaddingRight();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeMenuItemCheck } from \"../../d-menu-item-check\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteMenuItemText } from \"./d-theme-white-menu-item-text\";\n\nDThemeWhiteAtlas.add( \"menu_item_mark_check_active\", 14, 14,\n\t`<g>` +\n\t\t`<polyline fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" points=\"1 6.5 5 11 13 2.5\"></polyline>` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"menu_item_mark_check_inactive\", 14, 14,\n\t`<g></g>`\n);\n\nexport class DThemeWhiteMenuItemCheck extends DThemeWhiteMenuItemText implements DThemeMenuItemCheck {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn super.getBackgroundColor( state & ~DBaseState.ACTIVE );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn super.getColor( state & ~DBaseState.ACTIVE );\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteAtlas.mappings.menu_item_mark_check_active;\n\t\t} else {\n\t\t\treturn DThemeWhiteAtlas.mappings.menu_item_mark_check_inactive;\n\t\t}\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.BORDER;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 7;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeMenuItemExpandable } from \"../../d-menu-item-expandable\";\nimport { DThemeWhiteLayoutVertical } from \"./d-theme-white-layout-vertical\";\n\nexport class DThemeWhiteMenuItemExpandable extends DThemeWhiteLayoutVertical implements DThemeMenuItemExpandable {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn 0xf0f8ff;\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn 0.1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 0;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DCornerMask.ALL;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeMenuItemExpandableBody } from \"../../d-menu-item-expandable-body\";\nimport { DThemeWhiteLayoutVertical } from \"./d-theme-white-layout-vertical\";\n\nexport class DThemeWhiteMenuItemExpandableBody extends DThemeWhiteLayoutVertical\n\timplements DThemeMenuItemExpandableBody {\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DCornerMask.ALL;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeMenuItemExpandableHeader } from \"../../d-menu-item-expandable-header\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteListItem } from \"./d-theme-white-list-item\";\n\nDThemeWhiteAtlas.add( \"menu_item_expandable_header_closed\", 14, 14,\n\t`<g transform=\"scale(1, 0.7)\">` +\n\t\t`<polyline fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" points=\"6 16 10 10 6 4\"></polyline>` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"menu_item_expandable_header_opened\", 14, 14,\n\t`<g transform=\"scale(0.7, 1)\">` +\n\t\t`<polyline fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" points=\"16 6 10 10 4 6\"></polyline>` +\n\t`</g>`\n);\n\nexport class DThemeWhiteMenuItemExpandableHeader extends DThemeWhiteListItem implements DThemeMenuItemExpandableHeader {\n\tgetPaddingLeft(): number {\n\t\treturn this.getPaddingRight();\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 26;\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\tif( DBaseStates.isActiveIn( state ) ) {\n\t\t\treturn DThemeWhiteAtlas.mappings.menu_item_expandable_header_opened;\n\t\t} else {\n\t\t\treturn DThemeWhiteAtlas.mappings.menu_item_expandable_header_closed;\n\t\t}\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.BORDER;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 7;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemCheck } from \"./d-theme-white-menu-item-check\";\n\nexport class DThemeWhiteMenuItemExpandableItemCheck extends DThemeWhiteMenuItemCheck {\n\tgetPaddingLeft(): number {\n\t\treturn super.getPaddingLeft() + 16;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn super.getImageMarginHorizontal() + 16;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DMenuOptions } from \"../../d-menu\";\nimport { DMenuItemLinkMenuItemId, DThemeMenuItemLink } from \"../../d-menu-item-link\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteMenuItemText } from \"./d-theme-white-menu-item-text\";\n\nDThemeWhiteAtlas.add( \"menu_item_mark_link\", 24, 24,\n\t`<g>` +\n\t\t`<path fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" ` +\n\t\t\t`d=\"M10 6H7c-1.11 0-2 .9-2 2v8c0 1.1.89 2 2 2h8c1.1 0 2-.9 2-2v-3 M19 11V4h-7 M18.75 4.5l-8 8\" />` +\n\t`</g>`\n);\n\nexport class DThemeWhiteMenuItemLink extends DThemeWhiteMenuItemText implements DThemeMenuItemLink {\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\tif( state & DBaseState.EXTENSION_0 ) {\n\t\t\treturn DThemeWhiteAtlas.mappings.menu_item_mark_link;\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetImageTintAlpha( state: DBaseState ): number {\n\t\tif( state & DBaseState.HOVERED ) {\n\t\t\treturn super.getImageTintAlpha( state );\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.BORDER;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetMenuOptions(): DMenuOptions<DMenuItemLinkMenuItemId> {\n\t\treturn {\n\t\t\tsticky: true,\n\t\t\tfit: true,\n\t\t\titems: [{\n\t\t\t\tvalue: DMenuItemLinkMenuItemId.OPEN_LINK_IN_NEW_WINDOW,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: this.getOpenLinkInNewWindow()\n\t\t\t\t}\n\t\t\t}, {\n\t\t\t\tvalue: DMenuItemLinkMenuItemId.COPY_LINK_ADDRESS,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: this.getCopyLinkAddress()\n\t\t\t\t}\n\t\t\t}]\n\t\t};\n\t}\n\n\tgetOpenLinkInNewWindow(): string {\n\t\treturn \"Open link in new window\";\n\t}\n\n\tgetCopyLinkAddress(): string {\n\t\treturn \"Copy link address\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemLink } from \"./d-theme-white-menu-item-link\";\n\nexport class DThemeWhiteMenuItemExpandableItemLink extends DThemeWhiteMenuItemLink {\n\tgetPaddingLeft(): number {\n\t\treturn super.getPaddingLeft() + 16;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DAlignWith } from \"../../d-align-with\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeMenuItemMenu } from \"../../d-menu-item-menu\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteMenuItem } from \"./d-theme-white-menu-item\";\n\nDThemeWhiteAtlas.add( \"menu_item_mark_next\", 14, 20,\n\t`<g>` +\n\t\t`<polyline fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" points=\"5 16 11 10 5 4\"></polyline>` +\n\t`</g>`\n);\n\nexport class DThemeWhiteMenuItemMenu extends DThemeWhiteMenuItem implements DThemeMenuItemMenu {\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\treturn DThemeWhiteAtlas.mappings.menu_item_mark_next;\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn DAlignWith.BORDER;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn 12;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemMenu } from \"./d-theme-white-menu-item-menu\";\n\nexport class DThemeWhiteMenuItemExpandableItemMenu extends DThemeWhiteMenuItemMenu {\n\tgetPaddingLeft(): number {\n\t\treturn super.getPaddingLeft() + 16;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeListItemSeparator } from \"../../d-list-item-separator\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteImage } from \"./d-theme-white-image\";\n\nexport class DThemeWhiteListItemSeparator extends DThemeWhiteImage implements DThemeListItemSeparator {\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t}\n\n\tgetBorderAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_ALPHA;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 15;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeMenuItemSeparator } from \"../../d-menu-item-separator\";\nimport { DThemeWhiteListItemSeparator } from \"./d-theme-white-list-item-separator\";\n\nexport class DThemeWhiteMenuItemSeparator extends DThemeWhiteListItemSeparator implements DThemeMenuItemSeparator {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemSeparator } from \"./d-theme-white-menu-item-separator\";\n\nexport class DThemeWhiteMenuItemExpandableItemSeparator extends DThemeWhiteMenuItemSeparator {\n\tgetPaddingLeft(): number {\n\t\treturn super.getPaddingLeft() + 16;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DLayoutClearType } from \"../../d-layout-clear-type\";\nimport { DThemeLayoutSpace } from \"../../d-layout-space\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteLayoutSpace extends DThemeWhiteBase implements DThemeLayoutSpace {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 0;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 0;\n\t}\n\n\tgetClearType(): DLayoutClearType {\n\t\treturn DLayoutClearType.BOTH;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.CHILDREN;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeMenuItemSpace } from \"../../d-menu-item-space\";\nimport { DThemeWhiteLayoutSpace } from \"./d-theme-white-layout-space\";\n\nexport class DThemeWhiteMenuItemSpace extends DThemeWhiteLayoutSpace implements DThemeMenuItemSpace {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemSpace } from \"./d-theme-white-menu-item-space\";\n\nexport class DThemeWhiteMenuItemExpandableItemSpace extends DThemeWhiteMenuItemSpace {\n\tgetPaddingLeft(): number {\n\t\treturn super.getPaddingLeft() + 16;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemText } from \"./d-theme-white-menu-item-text\";\n\nexport class DThemeWhiteMenuItemExpandableItemText extends DThemeWhiteMenuItemText {\n\tgetPaddingLeft(): number {\n\t\treturn super.getPaddingLeft() + 16;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteMenu } from \"../theme/white/d-theme-white-menu\";\nimport { DThemeWhiteMenuItem } from \"../theme/white/d-theme-white-menu-item\";\nimport { DThemeWhiteMenuItemCheck } from \"../theme/white/d-theme-white-menu-item-check\";\nimport { DThemeWhiteMenuItemExpandable } from \"../theme/white/d-theme-white-menu-item-expandable\";\nimport { DThemeWhiteMenuItemExpandableBody } from \"../theme/white/d-theme-white-menu-item-expandable-body\";\nimport { DThemeWhiteMenuItemExpandableHeader } from \"../theme/white/d-theme-white-menu-item-expandable-header\";\nimport { DThemeWhiteMenuItemExpandableItemCheck } from \"../theme/white/d-theme-white-menu-item-expandable-item-check\";\nimport { DThemeWhiteMenuItemExpandableItemLink } from \"../theme/white/d-theme-white-menu-item-expandable-item-link\";\nimport { DThemeWhiteMenuItemExpandableItemMenu } from \"../theme/white/d-theme-white-menu-item-expandable-item-menu\";\nimport {\n\tDThemeWhiteMenuItemExpandableItemSeparator\n} from \"../theme/white/d-theme-white-menu-item-expandable-item-separator\";\nimport { DThemeWhiteMenuItemExpandableItemSpace } from \"../theme/white/d-theme-white-menu-item-expandable-item-space\";\nimport { DThemeWhiteMenuItemExpandableItemText } from \"../theme/white/d-theme-white-menu-item-expandable-item-text\";\nimport { DThemeWhiteMenuItemLink } from \"../theme/white/d-theme-white-menu-item-link\";\nimport { DThemeWhiteMenuItemMenu } from \"../theme/white/d-theme-white-menu-item-menu\";\nimport { DThemeWhiteMenuItemSeparator } from \"../theme/white/d-theme-white-menu-item-separator\";\nimport { DThemeWhiteMenuItemSpace } from \"../theme/white/d-theme-white-menu-item-space\";\nimport { DThemeWhiteMenuItemText } from \"../theme/white/d-theme-white-menu-item-text\";\n\nexport const loadThemeWhiteMenu = () => {\n\tDThemeWhite.set( \"DMenu\", DThemeWhiteMenu );\n\n\tDThemeWhite.set( \"DMenuItem\", DThemeWhiteMenuItem );\n\tDThemeWhite.set( \"DMenuItemCheck\", DThemeWhiteMenuItemCheck );\n\tDThemeWhite.set( \"DMenuItemLink\", DThemeWhiteMenuItemLink );\n\tDThemeWhite.set( \"DMenuItemMenu\", DThemeWhiteMenuItemMenu );\n\tDThemeWhite.set( \"DMenuItemSeparator\", DThemeWhiteMenuItemSeparator );\n\tDThemeWhite.set( \"DMenuItemSpace\", DThemeWhiteMenuItemSpace );\n\tDThemeWhite.set( \"DMenuItemText\", DThemeWhiteMenuItemText );\n\n\tDThemeWhite.set( \"DMenuItemExpandableBody\", DThemeWhiteMenuItemExpandableBody );\n\tDThemeWhite.set( \"DMenuItemExpandableHeader\", DThemeWhiteMenuItemExpandableHeader );\n\tDThemeWhite.set( \"DMenuItemExpandableItemCheck\", DThemeWhiteMenuItemExpandableItemCheck );\n\tDThemeWhite.set( \"DMenuItemExpandableItemLink\", DThemeWhiteMenuItemExpandableItemLink );\n\tDThemeWhite.set( \"DMenuItemExpandableItemMenu\", DThemeWhiteMenuItemExpandableItemMenu );\n\tDThemeWhite.set( \"DMenuItemExpandableItemSeparator\", DThemeWhiteMenuItemExpandableItemSeparator );\n\tDThemeWhite.set( \"DMenuItemExpandableItemSpace\", DThemeWhiteMenuItemExpandableItemSpace );\n\tDThemeWhite.set( \"DMenuItemExpandableItemText\", DThemeWhiteMenuItemExpandableItemText );\n\tDThemeWhite.set( \"DMenuItemExpandable\", DThemeWhiteMenuItemExpandable );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteDropdown } from \"../theme/white/d-theme-white-dropdown\";\nimport { loadThemeWhiteMenu } from \"./load-theme-white-menu\";\n\nexport const loadThemeWhiteDropdown = () => {\n\tDThemeWhite.set( \"DDropdown\", DThemeWhiteDropdown );\n\tloadThemeWhiteMenu();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeExpandable } from \"../../d-expandable\";\nimport { DThemeWhiteLayoutVertical } from \"./d-theme-white-layout-vertical\";\n\nexport class DThemeWhiteExpandable extends DThemeWhiteLayoutVertical implements DThemeExpandable {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn 0xf0f8ff;\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\tif( DBaseStates.isActive( state ) ) {\n\t\t\treturn 0.1;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 0;\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DCornerMask.ALL;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeExpandableHeader } from \"../../d-expandable-header\";\nimport { DThemeWhiteAtlas } from \"./d-theme-white-atlas\";\nimport { DThemeWhiteImage } from \"./d-theme-white-image\";\n\nDThemeWhiteAtlas.add( \"menu_item_expandable_header_closed\", 14, 14,\n\t`<g transform=\"scale(1, 0.7)\">` +\n\t\t`<polyline fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" points=\"6 16 10 10 6 4\"></polyline>` +\n\t`</g>`\n);\n\nDThemeWhiteAtlas.add( \"menu_item_expandable_header_opened\", 14, 14,\n\t`<g transform=\"scale(0.7, 1)\">` +\n\t\t`<polyline fill=\"none\" stroke=\"#fff\" stroke-width=\"1\" points=\"16 6 10 10 4 6\"></polyline>` +\n\t`</g>`\n);\n\nexport class DThemeWhiteExpandableHeader extends DThemeWhiteImage implements DThemeExpandableHeader {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn 0xf8f8f8;\n\t\t} else if( DBaseStates.isActiveIn( state ) ) {\n\t\t\treturn 0xf8f8f8;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 16;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 16;\n\t}\n\n\tgetCornerMask(): number {\n\t\treturn DCornerMask.ALL;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedSnapTargetValue } from \"../d-diagram-serialized\";\n\nexport enum ESnapperTargetValueType {\n\tHORIZONTAL = 0,\n\tVERTICAL = 1\n}\n\nexport class ESnapperTargetValue {\n\ttype: ESnapperTargetValueType;\n\tposition: number;\n\n\tconstructor( type: ESnapperTargetValueType, position: number ) {\n\t\tthis.type = type;\n\t\tthis.position = position;\n\t}\n\n\tserialize(): DDiagramSerializedSnapTargetValue {\n\t\treturn [ this.type, this.position ];\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteExpandable } from \"../theme/white/d-theme-white-expandable\";\nimport { DThemeWhiteExpandableHeader } from \"../theme/white/d-theme-white-expandable-header\";\n\nexport const loadThemeWhiteExpandable = () => {\n\tDThemeWhite.set( \"DExpandableHeader\", DThemeWhiteExpandableHeader );\n\tDThemeWhite.set( \"DExpandable\", DThemeWhiteExpandable );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteImage } from \"../theme/white/d-theme-white-image\";\n\nexport const loadThemeWhiteImage = () => {\n\tDThemeWhite.set( \"DImage\", DThemeWhiteImage );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DLayoutDirection } from \"../../d-layout\";\nimport { DThemeLayoutHorizontal } from \"../../d-layout-horizontal\";\nimport { DThemeWhiteLayout } from \"./d-theme-white-layout\";\n\nexport class DThemeWhiteLayoutHorizontal extends DThemeWhiteLayout implements DThemeLayoutHorizontal {\n\tgetDirection(): DLayoutDirection {\n\t\treturn DLayoutDirection.HORIZONTAL;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeInputAndLabel } from \"../../d-input-and-label\";\nimport { DThemeWhiteLayoutHorizontal } from \"./d-theme-white-layout-horizontal\";\n\nexport class DThemeWhiteInputAndLabel extends DThemeWhiteLayoutHorizontal implements DThemeInputAndLabel {\n\tgetHeight(): DCoordinate {\n\t\treturn this.getLineHeight();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteInputAndLabel } from \"../theme/white/d-theme-white-input-and-label\";\n\nexport const loadThemeWhiteInputAndLabel = () => {\n\tDThemeWhite.set( \"DInputAndLabel\", DThemeWhiteInputAndLabel );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeInput } from \"../../d-input\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteImageBase } from \"./d-theme-white-image-base\";\n\nconst editingValidator = (): unknown => {\n\treturn null;\n};\n\nconst editingUnformatter = ( text: string ): string => {\n\treturn text;\n};\n\nexport class DThemeWhiteInput extends DThemeWhiteImageBase implements DThemeInput {\n\tCOLOR = 0xffffff;\n\tCOLOR_HOVERED = UtilRgb.darken( this.COLOR, 0.017 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) || DBaseStates.isReadOnly( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn this.COLOR_HOVERED;\n\t\t} else {\n\t\t\treturn this.COLOR;\n\t\t}\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn 0xe5e5e5;\n\t}\n\n\tgetOutlineColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isInvalid( state ) ) {\n\t\t\treturn DThemeWhiteConstants.INVALID_COLOR;\n\t\t}\n\t\treturn super.getOutlineColor( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn this.getLineHeight();\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 100;\n\t}\n\n\tgetPlaceholder(): string {\n\t\treturn \"\";\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n\n\tgetEditingFormatter(): ( value: any, caller: any ) => string {\n\t\treturn this.getTextFormatter();\n\t}\n\n\tgetEditingUnformatter(): ( text: string, caller: any ) => any {\n\t\treturn editingUnformatter;\n\t}\n\n\tgetEditingValidator(): ( value: any, caller: any ) => unknown {\n\t\treturn editingValidator;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeInputNumber } from \"../../d-input-number\";\nimport { DStateAwareOrValueMightBe } from \"../../d-state-aware\";\nimport { DThemeWhiteInput } from \"./d-theme-white-input\";\n\nexport class DThemeWhiteInputNumber extends DThemeWhiteInput implements DThemeInputNumber {\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n\n\tgetStep(): number | null {\n\t\treturn 1;\n\t}\n\n\tgetMin(): number | null {\n\t\treturn null;\n\t}\n\n\tgetMax(): number | null {\n\t\treturn null;\n\t}\n\n\tnewTextValue(): DStateAwareOrValueMightBe<number> {\n\t\treturn 0;\n\t}\n\n\tgetTextValue( state: DBaseState ): number {\n\t\treturn 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeInputInteger } from \"../../d-input-integer\";\nimport { DInputNumber } from \"../../d-input-number\";\nimport { DThemeWhiteInputNumber } from \"./d-theme-white-input-number\";\n\nconst editingUnformatter = ( text: string ): number => {\n\treturn parseInt( text, 10 );\n};\n\nexport class DThemeWhiteInputInteger extends DThemeWhiteInputNumber implements DThemeInputInteger {\n\tgetEditingUnformatter(): ( text: string, caller: DInputNumber ) => number {\n\t\treturn editingUnformatter;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteInputInteger } from \"../theme/white/d-theme-white-input-integer\";\n\nexport const loadThemeWhiteInputInteger = () => {\n\tDThemeWhite.set( \"DInputInteger\", DThemeWhiteInputInteger );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeInputLabel } from \"../../d-input-label\";\nimport { DThemeWhiteText } from \"./d-theme-white-text\";\n\nexport class DThemeWhiteInputLabel extends DThemeWhiteText implements DThemeInputLabel {\n\tgetTextAlignHorizontal() {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 60;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn this.getLineHeight();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteInputLabel } from \"../theme/white/d-theme-white-input-label\";\n\nexport const loadThemeWhiteInputLabel = () => {\n\tDThemeWhite.set( \"DInputLabel\", DThemeWhiteInputLabel );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputNumber } from \"../../d-input-number\";\nimport { DThemeInputReal } from \"../../d-input-real\";\nimport { DThemeWhiteInputNumber } from \"./d-theme-white-input-number\";\n\nconst editingUnformatter = ( text: string ): number => {\n\treturn parseFloat( text );\n};\n\nexport class DThemeWhiteInputReal extends DThemeWhiteInputNumber implements DThemeInputReal {\n\tgetStep(): number | null {\n\t\treturn 0.1;\n\t}\n\n\tgetEditingUnformatter(): ( text: string, caller: DInputNumber ) => number {\n\t\treturn editingUnformatter;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteInputReal } from \"../theme/white/d-theme-white-input-real\";\n\nexport const loadThemeWhiteInputReal = () => {\n\tDThemeWhite.set( \"DInputReal\", DThemeWhiteInputReal );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeInputText } from \"../../d-input-text\";\nimport { DStateAwareOrValueMightBe } from \"../../d-state-aware\";\nimport { DThemeWhiteInput } from \"./d-theme-white-input\";\n\nexport class DThemeWhiteInputText extends DThemeWhiteInput implements DThemeInputText {\n\tnewTextValue(): DStateAwareOrValueMightBe<string> {\n\t\treturn \"\";\n\t}\n\n\tgetTextValue( state: DBaseState ): string {\n\t\treturn \"\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteInputText } from \"../theme/white/d-theme-white-input-text\";\n\nexport const loadThemeWhiteInputText = () => {\n\tDThemeWhite.set( \"DInputText\", DThemeWhiteInputText );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadThemeWhiteInputAndLabel } from \"./load-theme-white-input-and-label\";\nimport { loadThemeWhiteInputInteger } from \"./load-theme-white-input-integer\";\nimport { loadThemeWhiteInputLabel } from \"./load-theme-white-input-label\";\nimport { loadThemeWhiteInputReal } from \"./load-theme-white-input-real\";\nimport { loadThemeWhiteInputText } from \"./load-theme-white-input-text\";\n\nexport const loadThemeWhiteInputAll = () => {\n\tloadThemeWhiteInputAndLabel();\n\tloadThemeWhiteInputInteger();\n\tloadThemeWhiteInputLabel();\n\tloadThemeWhiteInputReal();\n\tloadThemeWhiteInputText();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteLayout } from \"../theme/white/d-theme-white-layout\";\nimport { DThemeWhiteLayoutHorizontal } from \"../theme/white/d-theme-white-layout-horizontal\";\nimport { DThemeWhiteLayoutSpace } from \"../theme/white/d-theme-white-layout-space\";\nimport { DThemeWhiteLayoutVertical } from \"../theme/white/d-theme-white-layout-vertical\";\n\nexport const loadThemeWhiteLayout = () => {\n\tDThemeWhite.set( \"DLayout\", DThemeWhiteLayout );\n\tDThemeWhite.set( \"DLayoutHorizontal\", DThemeWhiteLayoutHorizontal );\n\tDThemeWhite.set( \"DLayoutSpace\", DThemeWhiteLayoutSpace );\n\tDThemeWhite.set( \"DLayoutVertical\", DThemeWhiteLayoutVertical );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteList } from \"../theme/white/d-theme-white-list\";\nimport { DThemeWhiteListItem } from \"../theme/white/d-theme-white-list-item\";\nimport { DThemeWhiteListItemSeparator } from \"../theme/white/d-theme-white-list-item-separator\";\n\nexport const loadThemeWhiteList = () => {\n\tDThemeWhite.set( \"DListItemSeparator\", DThemeWhiteListItemSeparator );\n\tDThemeWhite.set( \"DListItem\", DThemeWhiteListItem );\n\tDThemeWhite.set( \"DList\", DThemeWhiteList );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeMenuBar } from \"../../d-menu-bar\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteLayoutHorizontal } from \"./d-theme-white-layout-horizontal\";\n\nexport class DThemeWhiteMenuBar extends DThemeWhiteLayoutHorizontal implements DThemeMenuBar {\n\tgetBackgroundColor() {\n\t\treturn DThemeWhiteConstants.BACKGROUND_COLOR;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 0;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeMenuBarItem } from \"../../d-menu-bar-item\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\n\nexport class DThemeWhiteMenuBarItem extends DThemeWhiteButton implements DThemeMenuBarItem {\n\tCOLOR = 0xffffff;\n\tCOLOR_HOVERED = UtilRgb.darken( this.COLOR, 0.017 );\n\tCOLOR_PRESSED = UtilRgb.darken( this.COLOR, 0.034 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else if( DBaseStates.isPressed( state ) ) {\n\t\t\treturn this.COLOR_PRESSED;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn this.COLOR_HOVERED;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tgetBorderColor(): number | null {\n\t\treturn null;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DCornerMask.ALL;\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteMenuBar } from \"../theme/white/d-theme-white-menu-bar\";\nimport { DThemeWhiteMenuBarItem } from \"../theme/white/d-theme-white-menu-bar-item\";\nimport { loadThemeWhiteMenu } from \"./load-theme-white-menu\";\n\nexport const loadThemeWhiteMenuBar = () => {\n\tDThemeWhite.set( \"DMenuBarItem\", DThemeWhiteMenuBarItem );\n\tDThemeWhite.set( \"DMenuBar\", DThemeWhiteMenuBar );\n\tloadThemeWhiteMenu();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeMenuSided } from \"../../d-menu-sided\";\nimport { DThemeWhitePane } from \"./d-theme-white-pane\";\n\nexport class DThemeWhiteMenuSided extends DThemeWhitePane implements DThemeMenuSided {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn 0xffffff;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeMenuSidedContent } from \"../../d-menu-sided-content\";\nimport { DThemeWhiteLayoutVertical } from \"./d-theme-white-layout-vertical\";\n\nexport class DThemeWhiteMenuSidedContent extends DThemeWhiteLayoutVertical implements DThemeMenuSidedContent {\n\tgetWidth(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tgetPaddingTop(): number {\n\t\treturn 16;\n\t}\n\n\tgetPaddingBottom(): number {\n\t\treturn 16;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemCheck } from \"./d-theme-white-menu-item-check\";\n\nexport class DThemeWhiteMenuSidedItemCheck extends DThemeWhiteMenuItemCheck {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemExpandable } from \"./d-theme-white-menu-item-expandable\";\n\nexport class DThemeWhiteMenuSidedItemExpandable extends DThemeWhiteMenuItemExpandable {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemExpandableItemCheck } from \"./d-theme-white-menu-item-expandable-item-check\";\n\nexport class DThemeWhiteMenuSidedItemExpandableItemCheck extends DThemeWhiteMenuItemExpandableItemCheck {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemExpandableItemLink } from \"./d-theme-white-menu-item-expandable-item-link\";\n\nexport class DThemeWhiteMenuSidedItemExpandableItemLink extends DThemeWhiteMenuItemExpandableItemLink {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemExpandableItemMenu } from \"./d-theme-white-menu-item-expandable-item-menu\";\n\nexport class DThemeWhiteMenuSidedItemExpandableItemMenu extends DThemeWhiteMenuItemExpandableItemMenu {\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemExpandableItemSeparator } from \"./d-theme-white-menu-item-expandable-item-separator\";\n\nexport class DThemeWhiteMenuSidedItemExpandableItemSeparator extends DThemeWhiteMenuItemExpandableItemSeparator {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemExpandableItemSpace } from \"./d-theme-white-menu-item-expandable-item-space\";\n\nexport class DThemeWhiteMenuSidedItemExpandableItemSpace extends DThemeWhiteMenuItemExpandableItemSpace {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemExpandableItemText } from \"./d-theme-white-menu-item-expandable-item-text\";\n\nexport class DThemeWhiteMenuSidedItemExpandableItemText extends DThemeWhiteMenuItemExpandableItemText {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemLink } from \"./d-theme-white-menu-item-link\";\n\nexport class DThemeWhiteMenuSidedItemLink extends DThemeWhiteMenuItemLink {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemMenu } from \"./d-theme-white-menu-item-menu\";\n\nexport class DThemeWhiteMenuSidedItemMenu extends DThemeWhiteMenuItemMenu {\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemSeparator } from \"./d-theme-white-menu-item-separator\";\n\nexport class DThemeWhiteMenuSidedItemSeparator extends DThemeWhiteMenuItemSeparator {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemSpace } from \"./d-theme-white-menu-item-space\";\n\nexport class DThemeWhiteMenuSidedItemSpace extends DThemeWhiteMenuItemSpace {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhiteMenuItemText } from \"./d-theme-white-menu-item-text\";\n\nexport class DThemeWhiteMenuSidedItemText extends DThemeWhiteMenuItemText {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteMenuSided } from \"../theme/white/d-theme-white-menu-sided\";\nimport { DThemeWhiteMenuSidedContent } from \"../theme/white/d-theme-white-menu-sided-content\";\nimport { DThemeWhiteMenuSidedItemCheck } from \"../theme/white/d-theme-white-menu-sided-item-check\";\nimport { DThemeWhiteMenuSidedItemExpandable } from \"../theme/white/d-theme-white-menu-sided-item-expandable\";\nimport {\n\tDThemeWhiteMenuSidedItemExpandableItemCheck\n} from \"../theme/white/d-theme-white-menu-sided-item-expandable-item-check\";\nimport {\n\tDThemeWhiteMenuSidedItemExpandableItemLink\n} from \"../theme/white/d-theme-white-menu-sided-item-expandable-item-link\";\nimport {\n\tDThemeWhiteMenuSidedItemExpandableItemMenu\n} from \"../theme/white/d-theme-white-menu-sided-item-expandable-item-menu\";\nimport {\n\tDThemeWhiteMenuSidedItemExpandableItemSeparator\n} from \"../theme/white/d-theme-white-menu-sided-item-expandable-item-separator\";\nimport {\n\tDThemeWhiteMenuSidedItemExpandableItemSpace\n} from \"../theme/white/d-theme-white-menu-sided-item-expandable-item-space\";\nimport {\n\tDThemeWhiteMenuSidedItemExpandableItemText\n} from \"../theme/white/d-theme-white-menu-sided-item-expandable-item-text\";\nimport { DThemeWhiteMenuSidedItemLink } from \"../theme/white/d-theme-white-menu-sided-item-link\";\nimport { DThemeWhiteMenuSidedItemMenu } from \"../theme/white/d-theme-white-menu-sided-item-menu\";\nimport { DThemeWhiteMenuSidedItemSeparator } from \"../theme/white/d-theme-white-menu-sided-item-separator\";\nimport { DThemeWhiteMenuSidedItemSpace } from \"../theme/white/d-theme-white-menu-sided-item-space\";\nimport { DThemeWhiteMenuSidedItemText } from \"../theme/white/d-theme-white-menu-sided-item-text\";\n\nexport const loadThemeWhiteMenuSided = () => {\n\tDThemeWhite.set( \"DMenuSided\", DThemeWhiteMenuSided );\n\tDThemeWhite.set( \"DMenuSidedContent\", DThemeWhiteMenuSidedContent );\n\n\tDThemeWhite.set( \"DMenuSidedItemCheck\", DThemeWhiteMenuSidedItemCheck );\n\tDThemeWhite.set( \"DMenuSidedItemLink\", DThemeWhiteMenuSidedItemLink );\n\tDThemeWhite.set( \"DMenuSidedItemMenu\", DThemeWhiteMenuSidedItemMenu );\n\tDThemeWhite.set( \"DMenuSidedItemSeparator\", DThemeWhiteMenuSidedItemSeparator );\n\tDThemeWhite.set( \"DMenuSidedItemSpace\", DThemeWhiteMenuSidedItemSpace );\n\tDThemeWhite.set( \"DMenuSidedItemText\", DThemeWhiteMenuSidedItemText );\n\n\tDThemeWhite.set( \"DMenuSidedItemExpandable\", DThemeWhiteMenuSidedItemExpandable );\n\tDThemeWhite.set( \"DMenuSidedItemExpandableItemCheck\", DThemeWhiteMenuSidedItemExpandableItemCheck );\n\tDThemeWhite.set( \"DMenuSidedItemExpandableItemLink\", DThemeWhiteMenuSidedItemExpandableItemLink );\n\tDThemeWhite.set( \"DMenuSidedItemExpandableItemMenu\", DThemeWhiteMenuSidedItemExpandableItemMenu );\n\tDThemeWhite.set( \"DMenuSidedItemExpandableItemSeparator\", DThemeWhiteMenuSidedItemExpandableItemSeparator );\n\tDThemeWhite.set( \"DMenuSidedItemExpandableItemSpace\", DThemeWhiteMenuSidedItemExpandableItemSpace );\n\tDThemeWhite.set( \"DMenuSidedItemExpandableItemText\", DThemeWhiteMenuSidedItemExpandableItemText );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeNote } from \"../../d-note\";\nimport { DThemeWhiteText } from \"./d-theme-white-text\";\n\nexport class DThemeWhiteNote extends DThemeWhiteText implements DThemeNote {\n\tgetWidth(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.NONE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteNote } from \"../theme/white/d-theme-white-note\";\n\nexport const loadThemeWhiteNote = () => {\n\tDThemeWhite.set( \"DNote\", DThemeWhiteNote );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteContent extends DThemeWhiteBase {\n\tgetWidth(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeScrollBar } from \"../../d-scroll-bar\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\n\nexport class DThemeWhiteScrollBar extends DThemeWhiteBase implements DThemeScrollBar {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn 0x000000;\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn 0;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 13;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 13;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeScrollBarThumb } from \"../../d-scroll-bar-thumb\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteBase } from \"./d-theme-white-base\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\n\nexport class DThemeWhiteScrollBarThumb extends DThemeWhiteBase implements DThemeScrollBarThumb {\n\tCOLOR = UtilRgb.darken( DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR, 0.25 );\n\n\tgetBackgroundColor( state: DBaseState ): number {\n\t\tif( DBaseStates.isHovered( state ) || DBaseStates.isDragging( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else {\n\t\t\treturn this.COLOR;\n\t\t}\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\tif( DBaseStates.isHovered( state ) || DBaseStates.isDragging( state ) ) {\n\t\t\treturn 1.0;\n\t\t} else {\n\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_ALPHA;\n\t\t}\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetBorderAlpha( state: DBaseState ): number {\n\t\treturn 0;\n\t}\n\n\tgetBorderWidth( state: DBaseState ): number {\n\t\treturn 1;\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn 13;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 13;\n\t}\n\n\tgetMinimumSize(): number {\n\t\treturn 16;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteScrollBar } from \"../theme/white/d-theme-white-scroll-bar\";\nimport { DThemeWhiteScrollBarThumb } from \"../theme/white/d-theme-white-scroll-bar-thumb\";\n\nexport const loadThemeWhiteScrollBar = () => {\n\tDThemeWhite.set( \"DScrollBar\", DThemeWhiteScrollBar );\n\tDThemeWhite.set( \"DScrollBarThumb\", DThemeWhiteScrollBarThumb );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteContent } from \"../theme/white/d-theme-white-content\";\nimport { DThemeWhitePane } from \"../theme/white/d-theme-white-pane\";\nimport { loadThemeWhiteScrollBar } from \"./load-theme-white-scroll-bar\";\n\nexport const loadThemeWhitePane = () => {\n\tDThemeWhite.set( \"DPane\", DThemeWhitePane );\n\tDThemeWhite.set( \"DContent\", DThemeWhiteContent );\n\tloadThemeWhiteScrollBar();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeSelect } from \"../../d-select\";\nimport { DThemeWhiteDropdown } from \"./d-theme-white-dropdown\";\n\nexport class DThemeWhiteSelect extends DThemeWhiteDropdown implements DThemeSelect {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteSelect } from \"../theme/white/d-theme-white-select\";\nimport { loadThemeWhiteDropdown } from \"./load-theme-white-dropdown\";\n\nexport const loadThemeWhiteSelect = () => {\n\tDThemeWhite.set( \"DSelect\", DThemeWhiteSelect );\n\tloadThemeWhiteDropdown();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DThemeTable } from \"../../d-table\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteLayoutVertical } from \"./d-theme-white-layout-vertical\";\n\nexport class DThemeWhiteTable extends DThemeWhiteLayoutVertical implements DThemeTable {\n\tgetBackgroundColor() {\n\t\treturn DThemeWhiteConstants.BACKGROUND_COLOR;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn 0xdddddd;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 0;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBody } from \"../../d-table-body\";\nimport { DThemeWhitePane } from \"./d-theme-white-pane\";\n\nexport class DThemeWhiteTableBody extends DThemeWhitePane implements DThemeTableBody {\n\tgetWidth(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DCornerMask.TOP;\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetRowHeight(): number {\n\t\treturn 30;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteFont } from \"./d-theme-white-font\";\n\nexport class DThemeWhiteTableBodyCells {\n\tstatic readonly IMAGE_TINT_COLOR_FOCUSED = UtilRgb.darken( DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR, 0.1 );\n\n\tstatic getBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isInvalid( state ) ) {\n\t\t\treturn DThemeWhiteConstants.INVALID_COLOR;\n\t\t} else if( state & DBaseState.ACTIVE_IN ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else {\n\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t\t}\n\t}\n\n\tstatic getBackgroundAlpha( state: DBaseState ): number {\n\t\tif( ! DBaseStates.isDisabled( state ) ) {\n\t\t\tif( DBaseStates.isPressed( state ) || DBaseStates.isFocused( state ) ) {\n\t\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_ALPHA;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tstatic getBorderColor( state: DBaseState ): number | null {\n\t\treturn 0xf6f6f6;\n\t}\n\n\tstatic getBorderAlign( state: DBaseState ): number {\n\t\treturn 0.5;\n\t}\n\n\tstatic getBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DBorderMask.TOP_BOTTOM;\n\t}\n\n\tstatic getColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteFont.getColor( state );\n\t}\n\n\tstatic getAlpha( state: DBaseState ): number {\n\t\tif( ! DBaseStates.isDisabled( state ) ) {\n\t\t\treturn DThemeWhiteFont.getAlpha( state );\n\t\t}\n\t\treturn 0;\n\t}\n\n\tstatic getImageTintColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) || DBaseStates.isReadOnly( state ) || ! DBaseStates.isActive( state ) ) {\n\t\t\tif( DBaseStates.isFocused( state ) ) {\n\t\t\t\treturn this.IMAGE_TINT_COLOR_FOCUSED;\n\t\t\t} else {\n\t\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_COLOR;\n\t\t\t}\n\t\t} else {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t}\n\t}\n\n\tstatic getOutlineAlign( state: DBaseState ): number {\n\t\treturn -2;\n\t}\n\n\tstatic getHeight(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tstatic getCornerMask(): DCornerMask {\n\t\treturn DCornerMask.ALL;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellCheck } from \"../../d-table-body-cell-check\";\nimport { DThemeWhiteButtonCheck } from \"./d-theme-white-button-check\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellCheck extends DThemeWhiteButtonCheck implements DThemeTableBodyCellCheck {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetImageTintColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getImageTintColor( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellColor } from \"../../d-table-body-cell-color\";\nimport { DThemeWhiteButtonColor } from \"./d-theme-white-button-color\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellColor extends DThemeWhiteButtonColor implements DThemeTableBodyCellColor {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DPickerDates } from \"../../d-picker-dates\";\nimport { DTableBodyCellDate, DThemeTableBodyCellDate } from \"../../d-table-body-cell-date\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nconst formatter = ( value: Date ): string => {\n\treturn DPickerDates.format( value );\n};\n\nexport class DThemeWhiteTableBodyCellDate extends DThemeWhiteButton implements DThemeTableBodyCellDate {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state);\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellDate ) => string {\n\t\treturn formatter;\n\t}\n\n\tgetTextValue( state: DBaseState ): Date {\n\t\treturn new Date();\n\t}\n\n\tnewTextValue(): Date {\n\t\treturn new Date();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DPickerDatetimes } from \"../../d-picker-datetimes\";\nimport { DTableBodyCellDatetime, DThemeTableBodyCellDatetime } from \"../../d-table-body-cell-datetime\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nconst formatter = ( value: Date, caller: DTableBodyCellDatetime ): string => {\n\treturn DPickerDatetimes.format( value, caller.getDatetimeMask() );\n};\n\nexport class DThemeWhiteTableBodyCellDatetime extends DThemeWhiteButton implements DThemeTableBodyCellDatetime {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellDatetime ) => string {\n\t\treturn formatter;\n\t}\n\n\tgetTextValue( state: DBaseState ): Date {\n\t\treturn new Date();\n\t}\n\n\tnewTextValue(): Date {\n\t\treturn new Date();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DTableBodyCellIndex, DThemeTableBodyCellIndex } from \"../../d-table-body-cell-index\";\nimport { DThemeWhiteImageBase } from \"./d-theme-white-image-base\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nconst formatter = ( index: unknown ): string => {\n\treturn String( Number( index ) + 1 );\n};\n\nexport class DThemeWhiteTableBodyCellIndex extends DThemeWhiteImageBase implements DThemeTableBodyCellIndex {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n\n\tgetTextFormatter(): ( value: number, caller: DTableBodyCellIndex ) => string {\n\t\treturn formatter;\n\t}\n\n\tgetTextValue( state: DBaseState ): number {\n\t\treturn 0;\n\t}\n\n\tnewTextValue(): number {\n\t\treturn 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellInputInteger } from \"../../d-table-body-cell-input-integer\";\nimport { DThemeWhiteInputInteger } from \"./d-theme-white-input-integer\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellInputInteger extends DThemeWhiteInputInteger\n\timplements DThemeTableBodyCellInputInteger {\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetOutlineColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn super.getOutlineColor( state );\n\t}\n\n\tgetOutlineAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getOutlineAlign( state );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellInputReal } from \"../../d-table-body-cell-input-real\";\nimport { DThemeWhiteInputReal } from \"./d-theme-white-input-real\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellInputReal extends DThemeWhiteInputReal\n\timplements DThemeTableBodyCellInputReal {\n\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.RIGHT;\n\t}\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetOutlineColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn super.getOutlineColor( state );\n\t}\n\n\tgetOutlineAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getOutlineAlign( state );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellInputText } from \"../../d-table-body-cell-input-text\";\nimport { DThemeWhiteInputText } from \"./d-theme-white-input-text\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellInputText extends DThemeWhiteInputText\n\timplements DThemeTableBodyCellInputText {\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetOutlineColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn super.getOutlineColor( state );\n\t}\n\n\tgetOutlineAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getOutlineAlign( state );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellSelectDialog } from \"../../d-table-body-cell-select-dialog\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellSelectDialog extends DThemeWhiteButton\n\timplements DThemeTableBodyCellSelectDialog {\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellSelectFetcher } from \"../../d-table-body-cell-select-fetcher\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellSelectFetcher extends DThemeWhiteButton\n\timplements DThemeTableBodyCellSelectFetcher {\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellSelectMenu } from \"../../d-table-body-cell-select-menu\";\nimport { DThemeWhiteSelect } from \"./d-theme-white-select\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellSelectMenu extends DThemeWhiteSelect\n\timplements DThemeTableBodyCellSelectMenu {\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetImageSource( state: DBaseState ): Texture | DisplayObject | null {\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableBodyCellText } from \"../../d-table-body-cell-text\";\nimport { DThemeWhiteImageBase } from \"./d-theme-white-image-base\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nexport class DThemeWhiteTableBodyCellText extends DThemeWhiteImageBase implements DThemeTableBodyCellText {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBorderMask } from \"../../d-border\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DPickerTimes } from \"../../d-picker-times\";\nimport { DTableBodyCellTime, DThemeTableBodyCellTime } from \"../../d-table-body-cell-time\";\nimport { DThemeWhiteButton } from \"./d-theme-white-button\";\nimport { DThemeWhiteTableBodyCells } from \"./d-theme-white-table-body-cells\";\n\nconst formatter = ( value: Date, caller: DTableBodyCellTime ): string => {\n\treturn DPickerTimes.format( value, caller.getDatetimeMask() );\n};\n\nexport class DThemeWhiteTableBodyCellTime extends DThemeWhiteButton\n\timplements DThemeTableBodyCellTime {\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundColor( state );\n\t}\n\n\tgetBackgroundAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBackgroundAlpha( state );\n\t}\n\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn DThemeWhiteTableBodyCells.getBorderColor( state );\n\t}\n\n\tgetBorderAlign( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getBorderAlign( state );\n\t}\n\n\tgetBorderMask( state: DBaseState ): DBorderMask {\n\t\treturn DThemeWhiteTableBodyCells.getBorderMask( state );\n\t}\n\n\tgetColor( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getColor( state );\n\t}\n\n\tgetAlpha( state: DBaseState ): number {\n\t\treturn DThemeWhiteTableBodyCells.getAlpha( state );\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn DThemeWhiteTableBodyCells.getHeight();\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DThemeWhiteTableBodyCells.getCornerMask();\n\t}\n\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellTime ) => string {\n\t\treturn formatter;\n\t}\n\n\tgetTextValue( state: DBaseState ): Date {\n\t\treturn new Date();\n\t}\n\n\tnewTextValue(): Date {\n\t\treturn new Date();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseInteractive } from \"../../d-base-interactive\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DThemeTableRow } from \"../../d-table-row\";\nimport { DThemeWhiteLayoutHorizontal } from \"./d-theme-white-layout-horizontal\";\n\nexport class DThemeWhiteTableRow extends DThemeWhiteLayoutHorizontal implements DThemeTableRow {\n\tgetBorderColor( state: DBaseState ): number | null {\n\t\treturn null;\n\t}\n\n\tgetCornerMask(): number {\n\t\treturn DCornerMask.ALL;\n\t}\n\n\tgetMargin(): number {\n\t\treturn 0;\n\t}\n\n\tgetInteractive(): DBaseInteractive {\n\t\treturn DBaseInteractive.BOTH;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeTableBodyRow } from \"../../d-table-body-row\";\nimport { DThemeWhiteTableRow } from \"./d-theme-white-table-row\";\n\nexport class DThemeWhiteTableBodyRow extends DThemeWhiteTableRow implements DThemeTableBodyRow {\n\tgetWidth(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeTableBodyRow } from \"../../d-table-body-row\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteTableBodyRow } from \"./d-theme-white-table-body-row\";\n\nexport class DThemeWhiteTableBodyRowEven extends DThemeWhiteTableBodyRow implements DThemeTableBodyRow {\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn 0xffffff;\n\t\t} else if( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_BLENDED;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_BLENDED;\n\t\t} else {\n\t\t\treturn 0xffffff;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DThemeTableBodyRow } from \"../../d-table-body-row\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteTableBodyRow } from \"./d-theme-white-table-body-row\";\n\nexport class DThemeWhiteTableBodyRowOdd extends DThemeWhiteTableBodyRow implements DThemeTableBodyRow {\n\tCOLOR = UtilRgb.darken( 0xffffff, 0.017 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn this.COLOR;\n\t\t} else if( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_BLENDED;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn DThemeWhiteConstants.WEAK_HIGHLIGHT_BLENDED;\n\t\t} else {\n\t\t\treturn this.COLOR;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"../../d-base-state\";\nimport { DBaseStates } from \"../../d-base-states\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DThemeTableHeader } from \"../../d-table-header\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { DThemeWhiteConstants } from \"./d-theme-white-constants\";\nimport { DThemeWhiteTableRow } from \"./d-theme-white-table-row\";\n\nexport class DThemeWhiteTableHeader extends DThemeWhiteTableRow implements DThemeTableHeader {\n\tCOLOR = 0xf9f9f9;\n\tCOLOR_HOVERED = UtilRgb.darken( this.COLOR, 0.017 );\n\tCOLOR_PRESSED = UtilRgb.darken( this.COLOR, 0.034 );\n\n\tgetBackgroundColor( state: DBaseState ): number | null {\n\t\tif( DBaseStates.isDisabled( state ) ) {\n\t\t\treturn null;\n\t\t} else if( DBaseStates.isActive( state ) ) {\n\t\t\treturn DThemeWhiteConstants.HIGHLIGHT_COLOR;\n\t\t} else if( DBaseStates.isPressed( state ) ) {\n\t\t\treturn this.COLOR_PRESSED;\n\t\t} else if( DBaseStates.isFocused( state ) || DBaseStates.isHovered( state ) ) {\n\t\t\treturn this.COLOR_HOVERED;\n\t\t} else {\n\t\t\treturn this.COLOR;\n\t\t}\n\t}\n\n\tgetWidth(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn 30;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"../../d-align-horizontal\";\nimport { DBaseState } from \"../../d-base-state\";\nimport { DCoordinate } from \"../../d-coordinate\";\nimport { DCornerMask } from \"../../d-corner\";\nimport { DStateAwareOrValueMightBe } from \"../../d-state-aware\";\nimport { DThemeTableHeaderCell } from \"../../d-table-header-cell\";\nimport { DThemeWhiteTextBase } from \"./d-theme-white-text-base\";\n\nexport class DThemeWhiteTableHeaderCell extends DThemeWhiteTextBase implements DThemeTableHeaderCell {\n\tgetTextAlignHorizontal(): DAlignHorizontal {\n\t\treturn DAlignHorizontal.CENTER;\n\t}\n\n\tgetCornerMask(): DCornerMask {\n\t\treturn DCornerMask.ALL;\n\t}\n\n\tgetHeight(): DCoordinate {\n\t\treturn \"padding\";\n\t}\n\n\tgetPaddingLeft(): number {\n\t\treturn 10;\n\t}\n\n\tgetPaddingRight(): number {\n\t\treturn 10;\n\t}\n\n\tgetTextValue( state: DBaseState ): string | null {\n\t\treturn null;\n\t}\n\n\tnewTextValue(): DStateAwareOrValueMightBe<string | null> {\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteTable } from \"../theme/white/d-theme-white-table\";\nimport { DThemeWhiteTableBody } from \"../theme/white/d-theme-white-table-body\";\nimport { DThemeWhiteTableBodyCellCheck } from \"../theme/white/d-theme-white-table-body-cell-check\";\nimport { DThemeWhiteTableBodyCellColor } from \"../theme/white/d-theme-white-table-body-cell-color\";\nimport { DThemeWhiteTableBodyCellDate } from \"../theme/white/d-theme-white-table-body-cell-date\";\nimport { DThemeWhiteTableBodyCellDatetime } from \"../theme/white/d-theme-white-table-body-cell-datetime\";\nimport { DThemeWhiteTableBodyCellIndex } from \"../theme/white/d-theme-white-table-body-cell-index\";\nimport { DThemeWhiteTableBodyCellInputInteger } from \"../theme/white/d-theme-white-table-body-cell-input-integer\";\nimport { DThemeWhiteTableBodyCellInputReal } from \"../theme/white/d-theme-white-table-body-cell-input-real\";\nimport { DThemeWhiteTableBodyCellInputText } from \"../theme/white/d-theme-white-table-body-cell-input-text\";\nimport { DThemeWhiteTableBodyCellSelectDialog } from \"../theme/white/d-theme-white-table-body-cell-select-dialog\";\nimport { DThemeWhiteTableBodyCellSelectFetcher } from \"../theme/white/d-theme-white-table-body-cell-select-fetcher\";\nimport { DThemeWhiteTableBodyCellSelectMenu } from \"../theme/white/d-theme-white-table-body-cell-select-menu\";\nimport { DThemeWhiteTableBodyCellText } from \"../theme/white/d-theme-white-table-body-cell-text\";\nimport { DThemeWhiteTableBodyCellTime } from \"../theme/white/d-theme-white-table-body-cell-time\";\nimport { DThemeWhiteTableBodyRow } from \"../theme/white/d-theme-white-table-body-row\";\nimport { DThemeWhiteTableBodyRowEven } from \"../theme/white/d-theme-white-table-body-row-even\";\nimport { DThemeWhiteTableBodyRowOdd } from \"../theme/white/d-theme-white-table-body-row-odd\";\nimport { DThemeWhiteTableHeader } from \"../theme/white/d-theme-white-table-header\";\nimport { DThemeWhiteTableHeaderCell } from \"../theme/white/d-theme-white-table-header-cell\";\nimport { DThemeWhiteTableRow } from \"../theme/white/d-theme-white-table-row\";\nimport { loadThemeWhiteButtonCheck } from \"./load-theme-white-button-check\";\nimport { loadThemeWhiteButtonColor } from \"./load-theme-white-button-color\";\nimport { loadThemeWhiteButtonDate } from \"./load-theme-white-button-date\";\nimport { loadThemeWhiteButtonDatetime } from \"./load-theme-white-button-datetime\";\nimport { loadThemeWhiteDialogSelect } from \"./load-theme-white-dialog-select\";\nimport { loadThemeWhiteInputInteger } from \"./load-theme-white-input-integer\";\nimport { loadThemeWhiteInputReal } from \"./load-theme-white-input-real\";\nimport { loadThemeWhiteInputText } from \"./load-theme-white-input-text\";\nimport { loadThemeWhiteMenu } from \"./load-theme-white-menu\";\n\nexport const loadThemeWhiteTable = () => {\n\tDThemeWhite.set( \"DTableBodyCellCheck\", DThemeWhiteTableBodyCellCheck );\n\tDThemeWhite.set( \"DTableBodyCellColor\", DThemeWhiteTableBodyCellColor );\n\tDThemeWhite.set( \"DTableBodyCellDate\", DThemeWhiteTableBodyCellDate );\n\tDThemeWhite.set( \"DTableBodyCellDatetime\", DThemeWhiteTableBodyCellDatetime );\n\tDThemeWhite.set( \"DTableBodyCellIndex\", DThemeWhiteTableBodyCellIndex );\n\tDThemeWhite.set( \"DTableBodyCellInputInteger\", DThemeWhiteTableBodyCellInputInteger );\n\tDThemeWhite.set( \"DTableBodyCellInputReal\", DThemeWhiteTableBodyCellInputReal );\n\tDThemeWhite.set( \"DTableBodyCellInputText\", DThemeWhiteTableBodyCellInputText );\n\tDThemeWhite.set( \"DTableBodyCellSelectDialog\", DThemeWhiteTableBodyCellSelectDialog );\n\tDThemeWhite.set( \"DTableBodyCellSelectFetcher\", DThemeWhiteTableBodyCellSelectFetcher );\n\tDThemeWhite.set( \"DTableBodyCellSelectMenu\", DThemeWhiteTableBodyCellSelectMenu );\n\tDThemeWhite.set( \"DTableBodyCellText\", DThemeWhiteTableBodyCellText );\n\tDThemeWhite.set( \"DTableBodyCellTime\", DThemeWhiteTableBodyCellTime );\n\tDThemeWhite.set( \"DTableBodyRowEven\", DThemeWhiteTableBodyRowEven );\n\tDThemeWhite.set( \"DTableBodyRowOdd\", DThemeWhiteTableBodyRowOdd );\n\tDThemeWhite.set( \"DTableBodyRow\", DThemeWhiteTableBodyRow );\n\tDThemeWhite.set( \"DTableBody\", DThemeWhiteTableBody );\n\tDThemeWhite.set( \"DTableHeaderCell\", DThemeWhiteTableHeaderCell );\n\tDThemeWhite.set( \"DTableHeader\", DThemeWhiteTableHeader );\n\tDThemeWhite.set( \"DTableRow\", DThemeWhiteTableRow );\n\tDThemeWhite.set( \"DTable\", DThemeWhiteTable );\n\tloadThemeWhiteButtonCheck();\n\tloadThemeWhiteButtonColor();\n\tloadThemeWhiteButtonDate();\n\tloadThemeWhiteButtonDatetime();\n\tloadThemeWhiteInputInteger();\n\tloadThemeWhiteInputReal();\n\tloadThemeWhiteInputText();\n\tloadThemeWhiteDialogSelect();\n\tloadThemeWhiteMenu();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteText } from \"../theme/white/d-theme-white-text\";\n\nexport const loadThemeWhiteText = () => {\n\tDThemeWhite.set( \"DText\", DThemeWhiteText );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadThemeWhite } from \"./load-theme-white\";\nimport { loadThemeWhiteBase } from \"./load-theme-white-base\";\nimport { loadThemeWhiteBoard } from \"./load-theme-white-board\";\nimport { loadThemeWhiteButtonAll } from \"./load-theme-white-button-all\";\nimport { loadThemeWhiteCanvasContainer } from \"./load-theme-white-canvas-container\";\nimport { loadThemeWhiteChart } from \"./load-theme-white-chart\";\nimport { loadThemeWhiteDiagram } from \"./load-theme-white-diagram\";\nimport { loadThemeWhiteDiagramEditor } from \"./load-theme-white-diagram-editor\";\nimport { loadThemeWhiteDialogAll } from \"./load-theme-white-dialog-all\";\nimport { loadThemeWhiteDropdown } from \"./load-theme-white-dropdown\";\nimport { loadThemeWhiteExpandable } from \"./load-theme-white-expandable\";\nimport { loadThemeWhiteImage } from \"./load-theme-white-image\";\nimport { loadThemeWhiteInputAll } from \"./load-theme-white-input-all\";\nimport { loadThemeWhiteLayout } from \"./load-theme-white-layout\";\nimport { loadThemeWhiteList } from \"./load-theme-white-list\";\nimport { loadThemeWhiteMenu } from \"./load-theme-white-menu\";\nimport { loadThemeWhiteMenuBar } from \"./load-theme-white-menu-bar\";\nimport { loadThemeWhiteMenuSided } from \"./load-theme-white-menu-sided\";\nimport { loadThemeWhiteNote } from \"./load-theme-white-note\";\nimport { loadThemeWhitePane } from \"./load-theme-white-pane\";\nimport { loadThemeWhitePickerColor } from \"./load-theme-white-picker-color\";\nimport { loadThemeWhitePickerColorGradient } from \"./load-theme-white-picker-color-gradient\";\nimport { loadThemeWhitePickerDate } from \"./load-theme-white-picker-date\";\nimport { loadThemeWhitePickerDatetime } from \"./load-theme-white-picker-datetime\";\nimport { loadThemeWhitePickerTime } from \"./load-theme-white-picker-time\";\nimport { loadThemeWhiteSelect } from \"./load-theme-white-select\";\nimport { loadThemeWhiteTable } from \"./load-theme-white-table\";\nimport { loadThemeWhiteText } from \"./load-theme-white-text\";\n\nexport const loadThemeWhiteAll = () => {\n\tloadThemeWhite();\n\tloadThemeWhiteBase();\n\tloadThemeWhiteBoard();\n\tloadThemeWhiteButtonAll();\n\tloadThemeWhiteCanvasContainer();\n\tloadThemeWhiteChart();\n\tloadThemeWhiteDiagramEditor();\n\tloadThemeWhiteDiagram();\n\tloadThemeWhiteDialogAll();\n\tloadThemeWhiteDropdown();\n\tloadThemeWhiteExpandable();\n\tloadThemeWhiteImage();\n\tloadThemeWhiteInputAll();\n\tloadThemeWhiteLayout();\n\tloadThemeWhiteList();\n\tloadThemeWhiteMenuBar();\n\tloadThemeWhiteMenuSided();\n\tloadThemeWhiteMenu();\n\tloadThemeWhiteNote();\n\tloadThemeWhitePane();\n\tloadThemeWhitePickerColorGradient();\n\tloadThemeWhitePickerColor();\n\tloadThemeWhitePickerDate();\n\tloadThemeWhitePickerDatetime();\n\tloadThemeWhitePickerTime();\n\tloadThemeWhiteSelect();\n\tloadThemeWhiteTable();\n\tloadThemeWhiteText();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeWhite } from \"../theme/white/d-theme-white\";\nimport { DThemeWhiteChart } from \"../theme/white/d-theme-white-chart\";\nimport { DThemeWhiteChartAxisX } from \"../theme/white/d-theme-white-chart-axis-x\";\nimport { DThemeWhiteChartAxisY } from \"../theme/white/d-theme-white-chart-axis-y\";\nimport { DThemeWhiteChartCoordinateLinear } from \"../theme/white/d-theme-white-chart-coordinate-linear\";\n\nexport const loadThemeWhiteChart = () => {\n\tDThemeWhite.set( \"DChart\", DThemeWhiteChart );\n\tDThemeWhite.set( \"DChartAxisX\", DThemeWhiteChartAxisX );\n\tDThemeWhite.set( \"DChartAxisY\", DThemeWhiteChartAxisY );\n\tDThemeWhite.set( \"DChartCoordinateLinear\", DThemeWhiteChartCoordinateLinear );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadMenuItemAll } from \"./load-menu-item-all\";\nimport { loadShapeAll } from \"./load-shape-all\";\nimport { loadThemeWhiteAll } from \"./load-theme-white-all\";\n\nexport const loadAll = () => {\n\tloadMenuItemAll();\n\tloadThemeWhiteAll();\n\tloadShapeAll();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DDiagramSerializedSnapGrid } from \"../d-diagram-serialized\";\nimport { ESnapperResult } from \"./e-snapper-result\";\n\nexport class ESnapperGrid extends utils.EventEmitter {\n\tprotected _isEnabled: boolean;\n\tprotected _size: number;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._isEnabled = true;\n\t\tthis._size = 10;\n\t}\n\n\ttoggle(): boolean {\n\t\tthis._isEnabled = ! this._isEnabled;\n\t\tthis.emit( \"change\", this );\n\t\treturn this._isEnabled;\n\t}\n\n\tenable(): void {\n\t\tif( this._isEnabled !== true ) {\n\t\t\tthis._isEnabled = true;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tdisable(): void {\n\t\tif( this._isEnabled !== false ) {\n\t\t\tthis._isEnabled = false;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tif( this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tthis.emit( \"change\", size, this );\n\t\t}\n\t}\n\n\tsnap( value: number, result: ESnapperResult ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst size = this._size;\n\t\t\tresult.set( value, Math.round( value / size ) * size );\n\t\t}\n\t}\n\n\treset(): void {\n\t\tthis._isEnabled = true;\n\t\tthis._size = 10;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tserialize(): DDiagramSerializedSnapGrid {\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\tthis._size\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnapGrid ): void {\n\t\tif( serialized[ 0 ] !== 0 ) {\n\t\t\tthis.enable();\n\t\t} else {\n\t\t\tthis.disable();\n\t\t}\n\n\t\tthis.size = serialized[ 1 ];\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class ESnapperResult {\n\tdistance: number;\n\tresult: number;\n\tthreshold: number;\n\n\tconstructor() {\n\t\tthis.distance = NaN;\n\t\tthis.result = 0;\n\t\tthis.threshold = 10;\n\t}\n\n\treset( value: number, scale: number ): void {\n\t\tthis.distance = NaN;\n\t\tthis.result = value;\n\t\tthis.threshold = ( 0.0001 < scale ? 10 / scale : 10 );\n\t}\n\n\tset( value: number, snapped: number ): void {\n\t\tconst newDistance = Math.abs( snapped - value );\n\t\tif( newDistance <= this.threshold ) {\n\t\t\tconst oldDistance = this.distance;\n\t\t\tif( oldDistance !== oldDistance || newDistance < oldDistance ) {\n\t\t\t\tthis.distance = newDistance;\n\t\t\t\tthis.result = snapped;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Matrix, Point, Rectangle, utils } from \"pixi.js\";\nimport { DDiagramSerializedSnap } from \"../d-diagram-serialized\";\nimport { utilIsNaN } from \"../util/util-is-nan\";\nimport { ESnapperGrid } from \"./e-snapper-grid\";\nimport { ESnapperResult } from \"./e-snapper-result\";\nimport { ESnapperResultScale } from \"./e-snapper-result-scale\";\nimport { ESnapperTarget } from \"./e-snapper-target\";\n\nconst EPSILON = 0.00001;\n\nexport interface ESnapperModifier extends DisplayObject {\n\twidth: number;\n\theight: number;\n}\n\nexport enum ESnapperModifierAnchor {\n\tNONE,\n\tTOP_LEFT,\n\tTOP_CENTER,\n\tTOP_RIGHT,\n\tMIDDLE_LEFT,\n\tMIDDLE_RIGHT,\n\tBOTTOM_LEFT,\n\tBOTTOM_CENTER,\n\tBOTTOM_RIGHT,\n\tROTATION\n}\n\nexport interface ESnapperParentCanvas {\n\tscale: {\n\t\tx: number,\n\t\ty: number\n\t};\n\twidth: number;\n\theight: number;\n}\n\nexport interface ESnapperParent {\n\tcanvas: ESnapperParentCanvas | null;\n}\n\nexport class ESnapper extends utils.EventEmitter {\n\tprotected _points: Point[];\n\tprotected _normals: Point[];\n\tprotected _lengths: number[];\n\n\tprotected _workScale: Point;\n\tprotected _workScaleResult: ESnapperResultScale;\n\n\tprotected _workTranslate: Point;\n\n\tprotected _workSnap: Point;\n\tprotected _workSnapRectangle: Rectangle;\n\tprotected _workSnapResultX: ESnapperResult;\n\tprotected _workSnapResultY: ESnapperResult;\n\n\tprotected _parent: ESnapperParent;\n\n\tprotected _isEnabled: boolean;\n\n\tgrid: ESnapperGrid;\n\n\ttarget: ESnapperTarget;\n\n\tconstructor( parent: ESnapperParent ) {\n\t\tsuper();\n\n\t\tthis._points = [\n\t\t\tnew Point(), // Top left\n\t\t\tnew Point(), // Top right\n\t\t\tnew Point(), // Bottom left\n\t\t\tnew Point(), // Bottom right\n\t\t\tnew Point()  // Center\n\t\t];\n\n\t\tthis._normals = [\n\t\t\tnew Point(),\n\t\t\tnew Point()\n\t\t];\n\n\t\tthis._lengths = [\n\t\t\t1,\n\t\t\t1\n\t\t];\n\n\t\tthis._workScale = new Point();\n\t\tthis._workSnapResultX = new ESnapperResult();\n\t\tthis._workSnapResultY = new ESnapperResult();\n\t\tthis._workScaleResult = {\n\t\t\tdistance: 0,\n\t\t\tscale: new Point()\n\t\t};\n\n\t\tthis._workTranslate = new Point();\n\n\t\tthis._workSnapRectangle = new Rectangle();\n\t\tthis._workSnap = new Point();\n\n\t\t// Grid\n\t\tthis.grid = new ESnapperGrid();\n\n\t\t// Target\n\t\tthis.target = new ESnapperTarget();\n\n\t\t//\n\t\tthis._parent = parent;\n\t\tthis._isEnabled = true;\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\ttoggle(): boolean {\n\t\tthis._isEnabled = ! this._isEnabled;\n\t\tthis.emit( \"change\", this );\n\t\treturn this._isEnabled;\n\t}\n\n\tenable(): void {\n\t\tif( this._isEnabled !== true ) {\n\t\t\tthis._isEnabled = true;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tdisable(): void {\n\t\tif( this._isEnabled !== false ) {\n\t\t\tthis._isEnabled = false;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tprotected prepare( modifier: ESnapperModifier ): void {\n\t\tmodifier.updateTransform();\n\t\tconst localTransform = modifier.transform.localTransform;\n\t\tconst sx = modifier.width;\n\t\tconst sy = modifier.height;\n\n\t\tconst points = this._points;\n\t\tpoints[ 0 ].set( 0, 0 );\n\t\tpoints[ 1 ].set( sx, 0 );\n\t\tpoints[ 2 ].set( sx, sy );\n\t\tpoints[ 3 ].set( 0, sy );\n\t\tpoints[ 4 ].set( sx * 0.5, sy * 0.5 );\n\n\t\tlocalTransform.apply( points[ 0 ], points[ 0 ] );\n\t\tlocalTransform.apply( points[ 1 ], points[ 1 ] );\n\t\tlocalTransform.apply( points[ 2 ], points[ 2 ] );\n\t\tlocalTransform.apply( points[ 3 ], points[ 3 ] );\n\t\tlocalTransform.apply( points[ 4 ], points[ 4 ] );\n\t}\n\n\tprepareForTranslate( modifier: ESnapperModifier ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis.prepare( modifier );\n\t\t}\n\t}\n\n\tprotected snap( point: IPoint, result: IPoint ): IPoint {\n\t\tconst px = point.x;\n\t\tconst py = point.y;\n\t\tconst canvas = this._parent.canvas;\n\t\tconst x = this._workSnapResultX;\n\t\tconst y = this._workSnapResultY;\n\n\t\t// Canvas\n\t\tif( canvas != null ) {\n\t\t\tconst scale = Math.max( canvas.scale.x, canvas.scale.y );\n\t\t\tx.reset( px, scale );\n\t\t\ty.reset( py, scale );\n\t\t\tx.set( px, 0 );\n\t\t\tx.set( px, canvas.width );\n\t\t\ty.set( py, 0 );\n\t\t\ty.set( py, canvas.height );\n\t\t} else {\n\t\t\tx.reset( px, 1 );\n\t\t\ty.reset( py, 1 );\n\t\t}\n\n\t\t// Target\n\t\tthis.target.snap( px, py, x, y );\n\n\t\t// Grid\n\t\tthis.grid.snap( px, x );\n\t\tthis.grid.snap( py, y );\n\n\t\t//\n\t\tresult.x = ( utilIsNaN( x.distance ) ? NaN : x.result );\n\t\tresult.y = ( utilIsNaN( y.distance ) ? NaN : y.result );\n\t\treturn result;\n\t}\n\n\ttoSnapped( point: IPoint, result: IPoint ): IPoint {\n\t\tconst px = point.x;\n\t\tconst py = point.y;\n\t\tif( this._isEnabled ) {\n\t\t\tthis.snap( point, result );\n\t\t\tconst x = result.x;\n\t\t\tconst y = result.y;\n\t\t\tresult.set(\n\t\t\t\tutilIsNaN( x ) ? px : x,\n\t\t\t\tutilIsNaN( y ) ? py : y\n\t\t\t);\n\t\t} else {\n\t\t\tresult.set( px, py );\n\t\t}\n\t\treturn result;\n\t}\n\n\ttoTranslationSnapped( delta: IPoint, result: IPoint ): IPoint {\n\t\tconst dx = delta.x;\n\t\tconst dy = delta.y;\n\t\tlet x = NaN;\n\t\tlet y = NaN;\n\t\tif( this._isEnabled ) {\n\t\t\tconst workTranslate = this._workTranslate;\n\t\t\tconst points = this._points;\n\t\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\t\tconst point = points[ i ];\n\t\t\t\tworkTranslate.set( point.x + dx, point.y + dy );\n\t\t\t\tthis.snap( workTranslate, workTranslate );\n\n\t\t\t\t// X\n\t\t\t\tif( ! utilIsNaN( workTranslate.x ) ) {\n\t\t\t\t\tconst newDx = workTranslate.x - point.x;\n\t\t\t\t\tif( utilIsNaN( x ) || Math.abs( newDx - dx ) < Math.abs( x - dx ) ) {\n\t\t\t\t\t\tx = newDx;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Y\n\t\t\t\tif( ! utilIsNaN( workTranslate.y ) ) {\n\t\t\t\t\tconst newDy = workTranslate.y - point.y;\n\t\t\t\t\tif( utilIsNaN( y ) || Math.abs( newDy - dy ) < Math.abs( y - dy ) ) {\n\t\t\t\t\t\ty = newDy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tresult.x = ( utilIsNaN( x ) ? dx : x );\n\t\tresult.y = ( utilIsNaN( y ) ? dy : y );\n\t\treturn result;\n\t}\n\n\tprepareForRotate( modifier: ESnapperModifier ): void {\n\t\t//\n\t}\n\n\tprotected getGridSizeRotation(): number {\n\t\treturn 5;\n\t}\n\n\tprotected toRadian( value: number ): number {\n\t\treturn value / 180 * Math.PI;\n\t}\n\n\tprotected toDegree( value: number ): number {\n\t\treturn value / Math.PI * 180;\n\t}\n\n\ttoRotationSnapped( baseRotation: number, deltaRotation: number ): number {\n\t\tif( this._isEnabled ) {\n\t\t\tconst gridSize = this.getGridSizeRotation();\n\t\t\tconst newRotation = baseRotation + deltaRotation;\n\t\t\tconst newRotationDegree = Math.round( this.toDegree( newRotation ) );\n\t\t\tconst newRotationDegreeResidual = newRotationDegree % 90;\n\t\t\tif( Math.abs( newRotationDegreeResidual ) <= gridSize ) {\n\t\t\t\treturn this.toRadian( newRotationDegree - newRotationDegreeResidual ) - baseRotation;\n\t\t\t} else {\n\t\t\t\tif( 90 - gridSize <= newRotationDegreeResidual ) {\n\t\t\t\t\treturn this.toRadian( newRotationDegree + (90 - newRotationDegreeResidual) ) - baseRotation;\n\t\t\t\t} else if( newRotationDegreeResidual <= -90 + gridSize ) {\n\t\t\t\t\treturn this.toRadian( newRotationDegree - (90 + newRotationDegreeResidual) ) - baseRotation;\n\t\t\t\t} else {\n\t\t\t\t\treturn deltaRotation;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn deltaRotation;\n\t}\n\n\tprotected calcNormalizedVector( p0: IPoint, p1: IPoint, result: Point ): number {\n\t\tconst dx = p1.x - p0.x;\n\t\tconst dy = p1.y - p0.y;\n\t\tconst l = Math.sqrt( dx * dx + dy * dy );\n\t\tif( EPSILON < l ) {\n\t\t\tconst d = 1 / l;\n\t\t\tresult.x = dx * d;\n\t\t\tresult.y = dy * d;\n\t\t} else {\n\t\t\tresult.x = 1;\n\t\t\tresult.y = 0;\n\t\t}\n\t\treturn l;\n\t}\n\n\tprepareForScale( modifier: ESnapperModifier, anchor: ESnapperModifierAnchor ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis.prepare( modifier );\n\n\t\t\tconst points = this._points;\n\t\t\tconst normals = this._normals;\n\t\t\tconst lengths = this._lengths;\n\t\t\tswitch( anchor ) {\n\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 1 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 3 ], points[ 0 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 3 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 1 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 2 ], points[ 1 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 1 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 1 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 2 ], points[ 3 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 0 ], points[ 3 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 3 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 3 ], points[ 2 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 1 ], points[ 2 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected setScaleSnappedResult(\n\t\tdistance: number,\n\t\tlength: number,\n\t\tmove: number,\n\t\taxis: boolean, // true => x axis, false y axis\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tif( EPSILON < length ) {\n\t\t\tif( utilIsNaN( result.distance ) || distance < result.distance ) {\n\t\t\t\tresult.distance = distance;\n\t\t\t\tconst newScale = 1 + move / length;\n\t\t\t\tif( axis ) {\n\t\t\t\t\tresult.scale.x = newScale;\n\t\t\t\t} else {\n\t\t\t\t\tresult.scale.y = newScale;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnapped1D(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\taxis: boolean,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tconst work = this._workScale;\n\t\ttransform.apply( point, work );\n\t\tconst tx = work.x;\n\t\tconst ty = work.y;\n\t\tthis.snap( work, work );\n\t\tconst x = work.x;\n\t\tconst y = work.y;\n\n\t\t// X coordinate\n\t\tif( ! utilIsNaN( x ) ) {\n\t\t\tconst nx = Math.abs( normal.x );\n\t\t\tif( EPSILON < nx ) {\n\t\t\t\tconst dx = (x - tx) / normal.x;\n\t\t\t\tconst distance = Math.abs( dx );\n\t\t\t\tconst mx = (x - point.x) / normal.x;\n\t\t\t\tthis.setScaleSnappedResult( distance, length, mx, axis, result );\n\t\t\t}\n\t\t}\n\n\t\t// Y coordinate\n\t\tif( ! utilIsNaN( y ) ) {\n\t\t\tconst ny = Math.abs( normal.y );\n\t\t\tif( EPSILON < ny ) {\n\t\t\t\tconst dy = (y - ty) / normal.y;\n\t\t\t\tconst distance = Math.abs( dy );\n\t\t\t\tconst my = (y - point.y) / normal.y;\n\t\t\t\tthis.setScaleSnappedResult( distance, length, my, axis, result );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnappedX(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped1D( transform, point, normal, length, true, result );\n\t}\n\n\tprotected calcScaleSnappedY(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped1D( transform, point, normal, length, false, result );\n\t}\n\n\tcalcScaleSnapped2D(\n\t\ttransform: Matrix, point: Point, normals: IPoint[],\n\t\tlengths: number[], result: ESnapperResultScale\n\t): void {\n\t\tconst work = this._workScale;\n\t\ttransform.apply( point, work );\n\t\tconst tx = work.x;\n\t\tconst ty = work.y;\n\n\t\tthis.snap( work, work );\n\t\tlet x = work.x;\n\t\tlet y = work.y;\n\t\tif( utilIsNaN( x ) ) {\n\t\t\tif( utilIsNaN( y ) ) {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tx = tx;\n\t\t\t}\n\t\t} else {\n\t\t\tif( utilIsNaN( y ) ) {\n\t\t\t\ty = ty;\n\t\t\t}\n\t\t}\n\n\t\t// (x, y) = (tx, ty) + normalA * a + normalB * b\n\t\t// dx = x - tx\n\t\t// dy = y - ty\n\t\t// V = ( a, b )^T\n\t\t// D = ( dx, dy )^T\n\t\t// A = | normalA.x normalB.x |\n\t\t//     | normalA.y normalB.y |\n\t\t// A V = D\n\t\t// det A = normalA.x * normalB.y - normalB.x * normalA.y\n\t\t// A^-1 = |  normalB.y -normalB.x | / det A\n\t\t//        | -normalA.y  normalA.x |\n\t\tconst detA = normals[ 0 ].x * normals[ 1 ].y - normals[ 1 ].x * normals[ 0 ].y;\n\t\tif( EPSILON < Math.abs( detA ) ) {\n\t\t\tconst dx = x - tx;\n\t\t\tconst dy = y - ty;\n\t\t\tconst distance = Math.abs( dx * dx + dy * dy );\n\t\t\tif( utilIsNaN( result.distance ) || distance < result.distance ) {\n\t\t\t\tresult.distance = distance;\n\t\t\t\tconst mdx = x - point.x;\n\t\t\t\tconst mdy = y - point.y;\n\t\t\t\tconst mx = ( +normals[ 1 ].y * mdx - normals[ 1 ].x * mdy ) / detA;\n\t\t\t\tconst my = ( -normals[ 0 ].y * mdx + normals[ 0 ].x * mdy ) / detA;\n\t\t\t\tresult.scale.set(\n\t\t\t\t\t1 + mx / lengths[ 0 ],\n\t\t\t\t\t1 + my / lengths[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnappedXY(\n\t\ttransform: Matrix,\n\t\tpointO: Point,\n\t\tpointX: Point,\n\t\tpointY: Point,\n\t\tnormals: IPoint[],\n\t\tlengths: number[],\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped2D( transform, pointO, normals, lengths, result );\n\t\tthis.calcScaleSnappedX( transform, pointY, normals[ 0 ], lengths[ 0 ], result );\n\t\tthis.calcScaleSnappedY( transform, pointX, normals[ 1 ], lengths[ 1 ], result );\n\t}\n\n\ttoScaleSnapped(\n\t\ttransform: Matrix, anchor: ESnapperModifierAnchor, keepRatio: boolean, scale: IPoint\n\t): boolean {\n\t\tif( this._isEnabled ) {\n\t\t\tconst points = this._points;\n\t\t\tconst normals = this._normals;\n\t\t\tconst lengths = this._lengths;\n\t\t\tconst work = this._workScaleResult;\n\t\t\twork.distance = NaN;\n\t\t\twork.scale.set( scale.x, scale.y );\n\n\t\t\tswitch( anchor ) {\n\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 0 ], points[ 1 ], points[ 3 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 0 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 1 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 1 ], points[ 0 ], points[ 2 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 0 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 3 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 1 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 2 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 3 ], points[ 2 ], points[ 0 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 2 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 3 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 2 ], points[ 3 ], points[ 1 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif( ! utilIsNaN( work.distance ) ) {\n\t\t\t\tscale.copyFrom( work.scale );\n\t\t\t\tif( keepRatio ) {\n\t\t\t\t\tswitch( anchor ) {\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\t\t\tscale.x = scale.y = Math.max( scale.x, scale.y );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\t\t\tscale.x = scale.y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\t\t\tscale.y = scale.x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\treset(): void {\n\t\tthis.enable();\n\t\tthis.target.reset();\n\t\tthis.grid.reset();\n\t}\n\n\tserialize(): DDiagramSerializedSnap {\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\tthis.target.serialize(),\n\t\t\tthis.grid.serialize()\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnap ): void {\n\t\tif( serialized[ 0 ] !== 0 ) {\n\t\t\tthis.enable();\n\t\t} else {\n\t\t\tthis.disable();\n\t\t}\n\t\tthis.target.deserialize( serialized[ 1 ] );\n\t\tthis.grid.deserialize( serialized[ 2 ] );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DDiagramSerializedSnapTarget, DDiagramSerializedSnapTargetValue } from \"../d-diagram-serialized\";\nimport { ESnapperResult } from \"./e-snapper-result\";\nimport { ESnapperTargetValue, ESnapperTargetValueType } from \"./e-snapper-target-value\";\n\nexport class ESnapperTarget extends utils.EventEmitter {\n\tvalues: ESnapperTargetValue[];\n\tprotected _isVisible: boolean;\n\tprotected _isEnabled: boolean;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.values = [];\n\t\tthis._isVisible = true;\n\t\tthis._isEnabled = true;\n\t}\n\n\tisEnabled(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\ttoggle(): boolean {\n\t\tthis._isEnabled = ! this._isEnabled;\n\t\tthis.emit( \"change\", this );\n\t\treturn this._isEnabled;\n\t}\n\n\tenable(): void {\n\t\tif( this._isEnabled !== true ) {\n\t\t\tthis._isEnabled = true;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tdisable(): void {\n\t\tif( this._isEnabled !== false ) {\n\t\t\tthis._isEnabled = false;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tadd( target: ESnapperTargetValue, index?: number ): void {\n\t\tif( index != null ) {\n\t\t\tthis.values.splice( index, 0, target );\n\t\t} else {\n\t\t\tthis.values.push( target );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tremove( index: number ): void {\n\t\tconst values = this.values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tvalues.splice( index, 1 );\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this.values.length;\n\t}\n\n\treplace( index: number, value: ESnapperTargetValue ): ESnapperTargetValue | null {\n\t\tconst values = this.values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tconst result = values[ index ];\n\t\t\tvalues[ index ] = value;\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tif( indexA !== indexB ) {\n\t\t\tconst values = this.values;\n\t\t\tconst valueA = values[ indexA ];\n\t\t\tvalues[ indexA ] = values[ indexB ];\n\t\t\tvalues[ indexB ] = valueA;\n\t\t}\n\t}\n\n\tget visible(): boolean {\n\t\treturn this._isVisible;\n\t}\n\n\tset visible( visible: boolean ) {\n\t\tif( this._isVisible !== visible ) {\n\t\t\tthis._isVisible = visible;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tsnap( px: number, py: number, x: ESnapperResult, y: ESnapperResult ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst values = this.values;\n\t\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\t\tconst value = values[ i ];\n\t\t\t\tif( value.type === ESnapperTargetValueType.VERTICAL ) {\n\t\t\t\t\tx.set( px, value.position );\n\t\t\t\t} else {\n\t\t\t\t\ty.set( py, value.position );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treset(): void {\n\t\tthis._isEnabled = true;\n\t\tthis._isVisible = true;\n\t\tthis.values.length = 0;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tserialize(): DDiagramSerializedSnapTarget {\n\t\tconst targets: DDiagramSerializedSnapTargetValue[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\ttargets.push( values[ i ].serialize() );\n\t\t}\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\t(this._isVisible ? 1 : 0),\n\t\t\ttargets\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnapTarget ): void {\n\t\t// Availability\n\t\tthis._isEnabled = ( serialized[ 0 ] !== 0 );\n\n\t\t// Visibility\n\t\tthis._isVisible = ( serialized[ 1 ] !== 0 );\n\n\t\t// Values\n\t\tconst sources = serialized[ 2 ];\n\t\tconst values = this.values;\n\t\tvalues.length = 0;\n\t\tfor( let i = 0, imax = sources.length; i < imax; ++i ) {\n\t\t\tconst source = sources[ i ];\n\t\t\tvalues.push( new ESnapperTargetValue( source[ 0 ], source[ 1 ] ) );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DAnimation, DAnimationOnEnd, DAnimationOnTime, DAnimationOptions } from \"./d-animation\";\nimport { DBase } from \"./d-base\";\n\nexport class DAnimationEmpty extends utils.EventEmitter implements DAnimation {\n\tprotected _reverse: boolean;\n\tprotected _onTime: DAnimationOnTime | undefined;\n\tprotected _onStart: DAnimationOnEnd | undefined;\n\tprotected _onEnd: DAnimationOnEnd | undefined;\n\tprotected _target: DBase<any, any> | null;\n\tprotected _isStarted: boolean;\n\n\tconstructor( options?: DAnimationOptions ) {\n\t\tsuper();\n\n\t\tthis._target = null;\n\t\tthis._reverse = false;\n\t\tthis._isStarted = false;\n\t\tthis._onTime = ( options != null ? options.onTime : undefined );\n\t\tthis._onStart = ( options != null ? options.onStart : undefined );\n\t\tthis._onEnd = ( options != null ? options.onEnd : undefined );\n\t}\n\n\tget target(): DBase<any, any> | null {\n\t\treturn this._target;\n\t}\n\n\tset target( target: DBase<any, any> | null ) {\n\t\tthis._target = target;\n\t}\n\n\tget duration(): number {\n\t\treturn 0;\n\t}\n\n\tset duration( duration: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tstart( reverse: boolean = false ): void {\n\t\tthis.stop();\n\t\tthis._isStarted = true;\n\t\tthis._reverse = reverse;\n\n\t\t// onStart\n\t\tthis.onStart( reverse );\n\t\tif( ! this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// onTime\n\t\tthis.onTime( reverse ? 1 : 0, reverse, 0 );\n\t\tif( ! this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onTime( reverse ? 0 : 1, reverse, 0 );\n\t\tif( this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// OnEnd\n\t\tthis.onEnd( reverse );\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst onStart = this._onStart;\n\t\tif( onStart != null ) {\n\t\t\tonStart( isReverse, this );\n\t\t}\n\t\tthis.emit( \"start\", isReverse, this );\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst onTime = this._onTime;\n\t\tif( onTime != null ) {\n\t\t\tonTime( time, isReverse, elapsedTime, this );\n\t\t}\n\t\tthis.emit( \"time\", time, isReverse, elapsedTime, this );\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst onEnd = this._onEnd;\n\t\tif( onEnd != null ) {\n\t\t\tonEnd( isReverse, this );\n\t\t}\n\t\tthis.emit( \"end\", isReverse, this );\n\t}\n\n\tisStarted(): boolean {\n\t\treturn this._isStarted;\n\t}\n\n\tisReverse(): boolean {\n\t\treturn this._reverse;\n\t}\n\n\tstop(): void {\n\t\tthis._isStarted = false;\n\t}\n\n\tend(): void {\n\t\tconst isStarted = this._isStarted;\n\t\tif( isStarted ) {\n\t\t\tthis._isStarted = false;\n\n\t\t\t// OnTime\n\t\t\tconst reverse = this._reverse;\n\t\t\tconst time = ( reverse ? 0 : 1 );\n\t\t\tthis.onTime( time, reverse, 0 );\n\n\t\t\t// OnEnd\n\t\t\tthis.onEnd( reverse );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeBase } from \"./d-base\";\nimport { DPadding } from \"./d-padding\";\n\nexport class DApplicationPadding implements DPadding {\n\tleft: number;\n\ttop: number;\n\tright: number;\n\tbottom: number;\n\n\tconstructor( top: number, right: number, bottom: number, left: number ) {\n\t\tthis.left = left;\n\t\tthis.top = top;\n\t\tthis.right = right;\n\t\tthis.bottom = bottom;\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tgetTop(): number {\n\t\treturn this.left;\n\t}\n\n\tgetRight(): number {\n\t\treturn this.right;\n\t}\n\n\tgetBottom(): number {\n\t\treturn this.bottom;\n\t}\n\n\tgetLeft(): number {\n\t\treturn this.left;\n\t}\n\n\tset( padding: number ): void;\n\tset( topAndBottom: number, leftAndRight: number ): void;\n\tset( top: number, leftAndRight: number, bottom: number ): void;\n\tset( top: number, right?: number, bottom?: number, left?: number ): void {\n\t\tif( right == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = top;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = top;\n\t\t} else if( bottom == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = right;\n\t\t} else if( left == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = right;\n\t\t} else {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = left;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationPadding } from \"./d-application-padding\";\nimport { DPadding } from \"./d-padding\";\n\n/**\n * PixiJS options\n */\ninterface PixiApplicationOptions {\n\twidth: number;\n\theight: number;\n\tautoStart: boolean;\n\tbackgroundColor: number;\n\tantialias: boolean;\n}\n\n/**\n * DApplication options\n */\nexport class DApplicationOptions {\n\tprivate _root: HTMLElement;\n\tprivate _pixi: PixiApplicationOptions;\n\tprivate _padding: DPadding;\n\n\tconstructor() {\n\t\tconst body = this._root = document.body;\n\t\tconst bbox = body.getBoundingClientRect();\n\t\tthis._padding = new DApplicationPadding( 6, 6, 6, 6 );\n\t\tthis._pixi = {\n\t\t\twidth: bbox.width,\n\t\t\theight: bbox.height,\n\t\t\tautoStart: false,\n\t\t\tbackgroundColor: 0xeeeeee,\n\t\t\tantialias: false\n\t\t};\n\t}\n\n\t/**\n\t * Returns a root element.\n\t * `HTMLCanvasElement` and other DOM elements are created in this element.\n\t * The default root element is `document.body`.\n\t */\n\tgetRootElement(): HTMLElement {\n\t\treturn this._root;\n\t}\n\n\t/**\n\t * Sets a root element and updates the canvas width and height\n\t * if `updateWidthAndHeight` is not false.\n\t *\n\t * @param root new root element\n\t * @param updateWidthAndHeight false to preserve the canvas width / height\n\t */\n\tsetRootElement( root: HTMLElement, updateWidthAndHeight?: boolean ): this {\n\t\tif( this._root !== root ) {\n\t\t\tthis._root = root;\n\t\t\tif( updateWidthAndHeight !== false ) {\n\t\t\t\tconst bbox = root.getBoundingClientRect();\n\t\t\t\tconst pixi = this._pixi;\n\t\t\t\tpixi.width = bbox.width;\n\t\t\t\tpixi.height = bbox.height;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a canvas width.\n\t */\n\tgetWidth() {\n\t\treturn this._pixi.width;\n\t}\n\n\t/**\n\t * Sets a canvas width.\n\t *\n\t * @param width new canvas width\n\t */\n\tsetWidth( width: number ): this {\n\t\tthis._pixi.width = width;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a canvas height.\n\t */\n\tgetHeight() {\n\t\treturn this._pixi.height;\n\t}\n\n\t/**\n\t * Sets a canvas height.\n\t *\n\t * @param height new canvas height\n\t */\n\tsetHeight( height: number ): this {\n\t\tthis._pixi.height = height;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns padding sizes.\n\t * The default padding size is 6.\n\t */\n\tgetPadding(): DPadding {\n\t\treturn this._padding;\n\t}\n\n\t/**\n\t * Sets padding sizes.\n\t *\n\t * @param left new left padding\n\t * @param top new top padding\n\t * @param right new right padding\n\t * @param bottom new bottom padding\n\t * @asse getPadding\n\t */\n\tsetPadding( left: number, top: number, right: number, bottom: number ): this {\n\t\tconst padding = this._padding;\n\t\tpadding.left = left;\n\t\tpadding.top = top;\n\t\tpadding.right = right;\n\t\tpadding.bottom = bottom;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a background color.\n\t */\n\tgetBackgroundColor(): number {\n\t\treturn this._pixi.backgroundColor;\n\t}\n\n\t/**\n\t * Sets a background color.\n\t *\n\t * @param color new background color\n\t */\n\tsetBackgroundColor( color: number ): this {\n\t\tthis._pixi.backgroundColor = color;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an antialias setting.\n\t * The default antialias setting is false.\n\t */\n\tgetAntialias(): boolean {\n\t\treturn this._pixi.antialias;\n\t}\n\n\t/**\n\t * Sets an antialias setting.\n\t *\n\t * @param antialias new antialias setting\n\t */\n\tsetAntialias( antialias: boolean ): this {\n\t\tthis._pixi.antialias = antialias;\n\t\treturn this;\n\t}\n\n\tgetPixiApplicationOptions(): PixiApplicationOptions {\n\t\treturn this._pixi;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Application, interaction, Point, Renderer, settings } from \"pixi.js\";\nimport { DApplicationOptions } from \"./d-application-options\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DFocusable, DFocusableContainer } from \"./d-controller-focus\";\nimport { DControllers } from \"./d-controllers\";\nimport { DPadding } from \"./d-padding\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEvent, UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\n// Global Settings\nsettings.RESOLUTION = window.devicePixelRatio || 1;\nsettings.ROUND_PIXELS = false;\ndelete (Renderer as any).__plugins.accessibility;\n\n//\ninterface DblClickable {\n\tonDblClick( e: MouseEvent | TouchEvent ): boolean;\n}\n\nconst isDblClickable = ( target: any ): target is DblClickable => {\n\treturn target != null && target.onDblClick != null;\n};\n\ninterface Wheelable {\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean;\n}\n\nconst isWheelable = ( target: any ): target is Wheelable => {\n\treturn target != null && target.onWheel != null;\n};\n\n//\nexport class DApplication extends Application {\n\tprotected _options: DApplicationOptions;\n\tprotected _renderId: number | null = null;\n\tprotected _renderBound: () => void;\n\tprotected _isUpdateAllowed: boolean;\n\tprotected _refitLimit: number;\n\tprotected _reflowLimit: number;\n\n\tconstructor( options: DApplicationOptions = new DApplicationOptions() ) {\n\t\tsuper( options.getPixiApplicationOptions() );\n\n\t\tDApplications.setInstace( this );\n\n\t\tthis._options = options;\n\t\tthis._isUpdateAllowed = true;\n\t\tthis._refitLimit = 5;\n\t\tthis._reflowLimit = 5;\n\n\t\tthis._renderBound = (): void => {\n\t\t\tif( this._renderId != null ) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\t// Canvas initialization\n\t\tconst rootElement = options.getRootElement();\n\t\tconst children = rootElement.children;\n\t\tif( 0 < children.length ) {\n\t\t\trootElement.insertBefore( this.view, children[ 0 ] );\n\t\t} else {\n\t\t\trootElement.appendChild( this.view );\n\t\t}\n\t\trootElement.style.margin = \"0px\";\n\t\trootElement.style.padding = \"0px\";\n\t\trootElement.style.overflow = \"hidden\";\n\t\tthis.view.style.width = \"100%\";\n\t\tthis.view.style.height = \"100%\";\n\t\tthis.view.style.display = \"block\";\n\n\t\t// Focus handling\n\t\tlet hasFocus = false;\n\t\tconst focusController = DControllers.getFocusController();\n\t\tconst onBlurBound = (): void => {\n\t\t\tif( ! hasFocus ) {\n\t\t\t\tfocusController.setFocused( null, true, false );\n\t\t\t}\n\t\t};\n\t\trootElement.addEventListener( \"focus\", ( e ): void => {\n\t\t\thasFocus = true;\n\t\t}, true );\n\t\trootElement.addEventListener( \"blur\", ( e ): void => {\n\t\t\thasFocus = false;\n\t\t\tsetTimeout( onBlurBound, 0 );\n\t\t}, true );\n\t\tthis.view.setAttribute( \"tabindex\", \"0\" );\n\n\t\tDControllers.getKeyboardController().init( this.view, this.stage, focusController );\n\n\t\tconst interactionManager: interaction.InteractionManager = this.renderer.plugins.interaction;\n\t\tinteractionManager.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( e.target == null ) {\n\t\t\t\tfocusController.setFocused( null, true, false );\n\t\t\t}\n\t\t});\n\n\t\t// Resize handling\n\t\tconst onResize = (): void => {\n\t\t\tconst bbox = options.getRootElement().getBoundingClientRect();\n\t\t\tthis.renderer.resize( bbox.width, bbox.height );\n\t\t\tthis.resizeChildren( bbox.width, bbox.height, options.getPadding() );\n\t\t\tthis.update();\n\t\t};\n\t\twindow.addEventListener( \"resize\", onResize );\n\t\twindow.addEventListener( \"orientationchange\", onResize );\n\n\t\t// Mouse wheel handling\n\t\tconst wheelGlobal = new Point();\n\t\tconst wheelEventUtil = UtilWheelEvent.getInstance();\n\t\twheelEventUtil.on( this.view, ( e: WheelEvent | Event ): void => {\n\t\t\tconst wheelEvent = e as WheelEvent;\n\t\t\tUtilPointerEvent.toGlobal( wheelEvent, wheelGlobal );\n\t\t\tlet current = interactionManager.hitTest( wheelGlobal );\n\t\t\tconst deltas = wheelEventUtil.normalize( e );\n\t\t\tif( deltas != null ) {\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( isWheelable( current ) ) {\n\t\t\t\t\t\tif( current.onWheel( wheelEvent, deltas, wheelGlobal ) ) {\n\t\t\t\t\t\t\twheelEvent.preventDefault();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Double click handling\n\t\tUtilPointerEvent.onDblClick( this.view, ( e: MouseEvent | TouchEvent ) => {\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( isDblClickable( current ) ) {\n\t\t\t\t\t\tif( current.onDblClick( e ) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//\n\t\tthis.stage.interactive = true;\n\t}\n\n\tdisallowUpdate(): void {\n\t\tthis._isUpdateAllowed = false;\n\t}\n\n\tallowUpdate(): void {\n\t\tthis._isUpdateAllowed = true;\n\t}\n\n\tupdate(): void {\n\t\tif( this._isUpdateAllowed && this._renderId == null ) {\n\t\t\tthis._renderId = requestAnimationFrame( this._renderBound );\n\t\t}\n\t}\n\n\trender(): void {\n\t\tconst oldRenderId = this._renderId;\n\t\tthis._renderId = null;\n\t\tthis.onRendering();\n\t\tconst newRenderId = this._renderId;\n\t\tthis._renderId = oldRenderId;\n\t\tthis.refit();\n\t\tthis.reflow();\n\t\tsuper.render();\n\t\tthis._renderId = newRenderId;\n\t}\n\n\tprotected onRendering(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget width(): number {\n\t\treturn this.screen.width;\n\t}\n\n\tget height(): number {\n\t\treturn this.screen.height;\n\t}\n\n\tget padding(): DPadding {\n\t\treturn this._options.getPadding();\n\t}\n\n\tprotected resizeChildren( width: number, height: number, padding: DPadding ): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentResize( width, height, padding );\n\t\t\t}\n\t\t}\n\t}\n\n\trefit(): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let ilimit = 0, limit = this._refitLimit; ilimit < limit; ++ilimit ) {\n\t\t\tlet isChildrenDirty = false;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.refit();\n\t\t\t\t\tisChildrenDirty = isChildrenDirty || child.isChildrenDirty();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If DBases are changed during the `refit` process, need to refit again.\n\t\t\tif( ! isChildrenDirty ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treflow(): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let ilimit = 0, limit = this._refitLimit; ilimit < limit; ++ilimit ) {\n\t\t\tlet isDirty = false;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.reflow();\n\t\t\t\t\tisDirty = isDirty || child.isDirty() || child.hasDirty();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If DBases are changed during the `reflow` process, need to reflow again.\n\t\t\tif( ! isDirty ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRootElement(): HTMLElement {\n\t\treturn this._options.getRootElement();\n\t}\n\n\tgetOptions(): DApplicationOptions {\n\t\treturn this._options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\n\nexport enum DChartCoordinateDirection {\n\tX,\n\tY\n}\n\nexport interface DChartCoordinate {\n\treadonly id: number;\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void;\n\tunbind(): void;\n\n\tfit(): void;\n\n\tmap( value: number ): number;\n\tunmap( value: number ): number;\n\n\t/**\n\t *\n\t * @param majorCount Expected major tick count\n\t * @param minorCountPerMajor Expected minor tick count per major ticks\n\t * @param minorCount Expected total minor tick count\n\t * @param majorResult `majorResult.length` must be larger than `majorCount * 3`.\n\t * @param minorResult `minorResult.length` must be larger than `minorCount * 3`.\n\t */\n\tticks(\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DBoardOptions<THEME extends DThemeBoard = DThemeBoard> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeBoard extends DThemeBase {\n\n}\n\nexport class DBoard<\n\tTHEME extends DThemeBoard = DThemeBoard,\n\tOPTIONS extends DBoardOptions<THEME> = DBoardOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DBoard\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DButtonGroup } from \"./d-button-group\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DButtonBaseOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonBase = DThemeButtonBase\n> extends DImageBaseOptions<VALUE, THEME> {\n\ttoggle?: boolean;\n\tgroup?: DButtonGroup;\n}\n\nexport interface DThemeButtonBase extends DThemeImageBase {\n\tisToggle(): boolean;\n}\n\n// Option parser\nconst isToggle = <VALUE, THEME extends DThemeButtonBase>(\n\ttheme: DThemeButtonBase, options: DButtonBaseOptions<VALUE, THEME> | undefined\n): boolean => {\n\tif( options != null && options.toggle != null ) {\n\t\treturn options.toggle;\n\t}\n\treturn theme.isToggle();\n};\n\nexport class DButtonBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonBase = DThemeButtonBase,\n\tOPTIONS extends DButtonBaseOptions<VALUE, THEME> = DButtonBaseOptions<VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected _isToggle!: boolean;\n\tprotected _onActiveUpBound!: () => void;\n\tprotected _onActiveUpBoundTarget!: Container | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.buttonMode = true;\n\t\tthis._isToggle = isToggle( this.theme, options );\n\t\tthis._onActiveUpBound = (): void => {\n\t\t\tthis.setPressed( false );\n\t\t\tconst target = this._onActiveUpBoundTarget;\n\t\t\tif( target != null ) {\n\t\t\t\ttarget.off( UtilPointerEvent.up, this._onActiveUpBound );\n\t\t\t}\n\t\t};\n\t\tthis._onActiveUpBoundTarget = null;\n\t\tthis.setActiveHandlers();\n\n\t\t// Group\n\t\tif( options != null && options.group != null ) {\n\t\t\toptions.group.add( this );\n\t\t}\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ): void {\n\t\tsuper.onShortcut( e );\n\t\tthis.onClick();\n\t}\n\n\tisToggle(): boolean {\n\t\treturn this._isToggle;\n\t}\n\n\tprotected setActiveHandlers(): void {\n\t\tUtilPointerEvent.onClick( this, (): void => {\n\t\t\tthis.onClick();\n\t\t});\n\n\t\tif( ! this.isToggle() ) {\n\t\t\tthis.on( UtilPointerEvent.down, (): void => {\n\t\t\t\tthis.setPressed( true );\n\t\t\t\tconst target = this._onActiveUpBoundTarget = DApplications.getInstance().stage;\n\t\t\t\ttarget.on( UtilPointerEvent.up, this._onActiveUpBound );\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: number, oldState: number ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\t\tthis.buttonMode = DBaseStates.isActionable( newState );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButton\";\n\t}\n\n\tonClick(): void {\n\t\tif( this.isActionable() ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t\tthis.onToggleEnd();\n\t\t\t} else {\n\t\t\t\tthis.emit( \"active\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onToggleStart(): void {\n\t\tthis.setActive( ! this.isActive() );\n\t}\n\n\tprotected onToggleEnd(): void {\n\t\tthis.emit( this.isActive() ? \"active\" : \"inactive\", this );\n\t}\n\n\tprotected onActivateKeyDown(): void {\n\t\tif( this.isActionable() ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t} else {\n\t\t\t\tthis.setPressed( true );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onActivateKeyUp(): void {\n\t\tif( this.isActionable() ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleEnd();\n\t\t\t} else {\n\t\t\t\tif( this.isPressed() ) {\n\t\t\t\t\tthis.emit( \"active\", this );\n\t\t\t\t}\n\t\t\t\tthis.setPressed( false );\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyDown();\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyUp();\n\t\t}\n\n\t\treturn super.onKeyUp( e );\n\t}\n\n\tdestroy(): void {\n\t\t// Group\n\t\tconst options = this._options;\n\t\tif( options != null && options.group != null ) {\n\t\t\toptions.group.remove( this );\n\t\t}\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButton extends DThemeButtonBase {\n\n}\n\nexport class DButton<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButton\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\n\nexport interface DButtonAmbientOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonAmbient = DThemeButtonAmbient\n> extends DButtonOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonAmbient extends DThemeButton {\n\n}\n\nexport class DButtonAmbient<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonAmbient = DThemeButtonAmbient,\n\tOPTIONS extends DButtonAmbientOptions<VALUE, THEME> = DButtonAmbientOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonAmbient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonCheckOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck = DThemeButtonCheck\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonCheck extends DThemeButtonBase {\n\n}\n\nexport class DButtonCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck = DThemeButtonCheck,\n\tOPTIONS extends DButtonCheckOptions<VALUE, THEME> = DButtonCheckOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonCheck, DButtonCheckOptions, DThemeButtonCheck } from \"./d-button-check\";\n\nexport interface DButtonCheckRightOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheckRight = DThemeButtonCheckRight\n> extends DButtonCheckOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonCheckRight extends DThemeButtonCheck {\n\n}\n\nexport class DButtonCheckRight<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck = DThemeButtonCheck,\n\tOPTIONS extends DButtonCheckOptions<VALUE, THEME> = DButtonCheckOptions<VALUE, THEME>\n> extends DButtonCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonCheckRight\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonPrimary extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonPrimary\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayout, DLayoutOptions, DThemeLayout } from \"./d-layout\";\n\nexport interface DLayoutHorizontalOptions<THEME extends DThemeLayout> extends DLayoutOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutHorizontal extends DThemeLayout {\n\n}\n\nexport class DLayoutHorizontal<\n\tTHEME extends DThemeLayoutHorizontal = DThemeLayoutHorizontal,\n\tOPTIONS extends DLayoutHorizontalOptions<THEME> = DLayoutHorizontalOptions<THEME>\n> extends DLayout<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DLayoutHorizontal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\nimport { DButtonPrimary } from \"./d-button-primary\";\nimport { DCoordinate } from \"./d-coordinate\";\nimport { DDialog, DDialogOptions, DThemeDialog } from \"./d-dialog\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace } from \"./d-layout-space\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DDialogCommandOptions<\n\tTHEME extends DThemeDialogCommand = DThemeDialogCommand\n> extends DDialogOptions<THEME> {\n\tok?: string;\n\tcancel?: string;\n}\n\nexport interface DThemeDialogCommand extends DThemeDialog {\n\tgetOk(): string | null;\n\tgetCancel(): string | null;\n\tgetLayoutX(): DCoordinate;\n\tgetLayoutY(): DCoordinate;\n\tgetLayoutWidth(): DCoordinate;\n\tgetLayoutHeight(): DCoordinate;\n}\n\nexport class DDialogCommand<\n\tTHEME extends DThemeDialogCommand = DThemeDialogCommand,\n\tOPTIONS extends DDialogCommandOptions<THEME> = DDialogCommandOptions<THEME>\n> extends DDialog<THEME, OPTIONS> {\n\tprotected _promise: Promise<void> | null = null;\n\tprotected _resolve: (() => void) | null = null;\n\tprotected _reject: (() => void) | null = null;\n\tprotected _buttonLayout?: DLayoutHorizontal;\n\tprotected _buttonOk?: DButton;\n\tprotected _buttonCancel?: DButton;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst theme = this.theme;\n\t\tconst layout = new DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: theme.getLayoutX(),\n\t\t\ty: theme.getLayoutY(),\n\t\t\twidth: theme.getLayoutWidth(),\n\t\t\theight: theme.getLayoutHeight()\n\t\t});\n\n\t\tthis.onInit( layout, options );\n\n\t\t// Buttons\n\t\tconst ok = ( options && options.ok || theme.getOk() );\n\t\tconst cancel = ( options && options.cancel || theme.getCancel() );\n\t\tif( ok != null || cancel != null ) {\n\t\t\tconst buttonLayout = new DLayoutHorizontal({\n\t\t\t\tparent: layout,\n\t\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: this.padding.getTop()\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._buttonLayout = buttonLayout;\n\t\t\tnew DLayoutSpace({\n\t\t\t\tparent: buttonLayout,\n\t\t\t\tweight: 1\n\t\t\t});\n\t\t\tif( ok != null && cancel != null ) {\n\t\t\t\tthis._buttonCancel = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: cancel\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onCancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._buttonOk = new DButton({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ok\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if( ok != null ) {\n\t\t\t\tthis._buttonOk = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ok\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if( cancel != null ) {\n\t\t\t\tthis._buttonCancel = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: cancel\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.onCancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tnew DLayoutSpace({\n\t\t\t\tparent: buttonLayout,\n\t\t\t\tweight: 1\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\t// OVERRIDE THIS\n\t}\n\n\topen(): Promise<void> {\n\t\tsuper.open();\n\t\treturn this._promise!;\n\t}\n\n\tprotected onOpen() {\n\t\tsuper.onOpen();\n\n\t\tif( this._promise == null ) {\n\t\t\tthis._promise = new Promise(( resolve, reject ): void => {\n\t\t\t\tthis._resolve = resolve;\n\t\t\t\tthis._reject = reject;\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onClose() {\n\t\tsuper.onClose();\n\n\t\tconst reject = this._reject;\n\t\tthis._promise = null;\n\t\tthis._resolve = null;\n\t\tthis._reject = null;\n\n\t\tif( reject != null ) {\n\t\t\treject();\n\t\t}\n\t}\n\n\tprotected onOk() {\n\t\tconst resolve = this._resolve;\n\t\tthis._promise = null;\n\t\tthis._resolve = null;\n\t\tthis._reject = null;\n\n\t\tthis.close();\n\n\t\tif( resolve != null ) {\n\t\t\tresolve();\n\t\t}\n\n\t\tthis.emit( \"ok\", this );\n\t}\n\n\tprotected onCancel() {\n\t\tconst reject = this._reject;\n\t\tthis._promise = null;\n\t\tthis._resolve = null;\n\t\tthis._reject = null;\n\n\t\tthis.close();\n\n\t\tif( reject != null ) {\n\t\t\treject();\n\t\t}\n\n\t\tthis.emit( \"cancel\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogCommand\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Rectangle, Renderer, Text } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DControllers } from \"./d-controllers\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DInputOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeInput = DThemeInput\n> extends DImageBaseOptions<VALUE, THEME> {\n\tdescription?: string;\n\tediting?: {\n\t\tformatter?: ( value: VALUE ) => string;\n\t\tunformatter?: ( text: string ) => VALUE;\n\t\tvalidator?: ( value: VALUE ) => string | null;\n\t};\n}\n\nexport interface DThemeInput extends DThemeImageBase {\n\tgetEditingFormatter(): ( value: any, caller: any ) => string;\n\tgetEditingUnformatter(): ( text: string, caller: any ) => any;\n\tgetEditingValidator(): ( value: any, caller: any ) => unknown;\n}\n\nexport abstract class DInput<\n\tVALUE = unknown,\n\tTHEME extends DThemeInput = DThemeInput,\n\tOPTIONS extends DInputOptions<VALUE, THEME> = DInputOptions<VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected static _input: HTMLInputElement | null = null;\n\tprotected static _clipper: HTMLDivElement | null = null;\n\tprotected _isInputShown!: boolean;\n\tprotected _inputRect!: Rectangle | null;\n\tprotected _isInputSelected!: boolean;\n\tprotected _isStarted!: boolean;\n\tprotected _clipperRect!: Rectangle | null;\n\tprotected _onInputKeyDownBound!: ( e: KeyboardEvent ) => void;\n\tprotected _onInputBlurBound!: ( e: FocusEvent ) => void;\n\tprotected _updateInputBound!: () => void;\n\tprotected _onInputChangeBound!: ( e: Event ) => void;\n\tprotected _onInputInputBound!: ( e: Event ) => void;\n\tprotected _onPreRenderBound!: () => void;\n\tprotected _updateInputBoundRenderer!: Renderer | null;\n\tprotected _description!: string;\n\tprotected _editingFormatter!: ( value: VALUE, caller: DInput<VALUE> ) => string;\n\tprotected _editingUnformatter!: ( text: string, caller: DInput<VALUE> ) => VALUE;\n\tprotected _editingValidator!: ( value: VALUE, caller: DInput<VALUE> ) => unknown;\n\tprotected _editingValidationResult!: unknown;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tthis._editingValidationResult = null;\n\t\tthis._editingValidator = ( options && options.editing && options.editing.validator ) ||\n\t\t\tthis.theme.getEditingValidator();\n\n\t\tsuper.init( options );\n\n\t\tthis._isInputShown = false;\n\t\tthis._inputRect = null;\n\t\tthis._isInputSelected = false;\n\t\tthis._isStarted = false;\n\t\tthis._clipperRect = null;\n\n\t\tthis.cursor = \"text\";\n\n\t\tthis._description = ( options && options.description ) || \"\";\n\t\tthis._editingFormatter = ( options && options.editing && options.editing.formatter ) ||\n\t\t\tthis.theme.getEditingFormatter();\n\t\tthis._editingUnformatter = ( options && options.editing && options.editing.unformatter ) ||\n\t\t\tthis.theme.getEditingUnformatter();\n\n\t\tthis._onInputKeyDownBound = ( e: KeyboardEvent ): void => {\n\t\t\tthis.onInputKeyDown( e );\n\t\t};\n\n\t\tthis._onInputBlurBound = ( e: FocusEvent ): void => {\n\t\t\tthis.onInputBlur( e );\n\t\t};\n\n\t\tthis._updateInputBound = (): void => {\n\t\t\tthis.updateInput();\n\t\t};\n\n\t\tthis._onInputChangeBound = (): void => {\n\t\t\tthis.onInputChange();\n\t\t};\n\n\t\tthis._onInputInputBound = ( e: Event ): void => {\n\t\t\tthis.onInputInput( e );\n\t\t};\n\n\t\tthis._onPreRenderBound = (): void => {\n\t\t\tthis.onPreRender();\n\t\t};\n\n\t\tthis._updateInputBoundRenderer = null;\n\t}\n\n\tget value(): VALUE {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.text = value;\n\t}\n\n\tprotected onTextChange(): void {\n\t\tsuper.onTextChange();\n\t\tthis.validate();\n\t}\n\n\tvalidate(): unknown {\n\t\tconst result = this._editingValidator( this._textValueComputed, this );\n\t\tif( this._editingValidationResult !== result ) {\n\t\t\tthis._editingValidationResult = result;\n\t\t\tthis.setInvalid( result != null );\n\t\t\tif( this.isHovered() ) {\n\t\t\t\tthis.applyTitle();\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected applyTitle(): void {\n\t\tconst editingValidationResult = this._editingValidationResult;\n\t\tif( utilIsString( editingValidationResult ) ) {\n\t\t\tDApplications.getInstance().view.title = editingValidationResult;\n\t\t} else {\n\t\t\tsuper.applyTitle();\n\t\t}\n\t}\n\n\tprotected onFocused(): void {\n\t\tsuper.onFocused();\n\t\tthis.start();\n\t}\n\n\tprotected onBlured(): void {\n\t\tsuper.onBlured();\n\t\tif( this._isInputShown ) {\n\t\t\tthis.onInputChange();\n\t\t}\n\t\tthis.cancel();\n\t}\n\n\tprotected onPreRender(): void {\n\t\tif( this._isStarted ) {\n\t\t\tthis._isStarted = false;\n\t\t\tthis.start_( false );\n\t\t}\n\t}\n\n\tstart(): void {\n\t\tif( ! this.isDisabled() && this._isStarted !== true ) {\n\t\t\t// This method might be invoked in the `pointerown` event handler.\n\t\t\t// Because of this, focusing on an input element in this method invokes\n\t\t\t// the `onInputBlur` immediately. Thus, must not call the `start` here.\n\t\t\tthis._isStarted = true;\n\t\t\tDApplications.getInstance().renderer.once(\n\t\t\t\t\"prerender\", this._onPreRenderBound\n\t\t\t);\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tprotected start_( update?: boolean ): void {\n\t\tif( ! this._isInputShown ) {\n\t\t\tthis._isInputShown = true;\n\n\t\t\tconst text = this._text;\n\t\t\tif( text != null ) {\n\t\t\t\ttext.visible = false;\n\t\t\t}\n\n\t\t\tconst app = DApplications.getInstance();\n\t\t\tconst clipper = this.getClipper();\n\t\t\tif( clipper != null ) {\n\t\t\t\tconst input = this.getInput( clipper );\n\t\t\t\tif( input != null ) {\n\t\t\t\t\tconst resolution = app.renderer.resolution;\n\t\t\t\t\tconst inputRect = this.getInputRect( resolution );\n\t\t\t\t\tconst clipperRect = this.getClipperRect( inputRect, resolution );\n\t\t\t\t\tthis.initInput( input, clipper, inputRect, clipperRect );\n\n\t\t\t\t\tconst updateInputBound = this._updateInputBound;\n\t\t\t\t\tconst renderer = this._updateInputBoundRenderer;\n\t\t\t\t\tif( renderer != null ) {\n\t\t\t\t\t\trenderer.off( \"postrender\", updateInputBound );\n\t\t\t\t\t}\n\t\t\t\t\tthis._updateInputBoundRenderer = app.renderer;\n\t\t\t\t\tapp.renderer.on( \"postrender\", updateInputBound );\n\n\t\t\t\t\tclipper.style.display = \"\";\n\t\t\t\t\tinput.focus();\n\t\t\t\t\tclipper.scrollTop = 0;\n\t\t\t\t\tclipper.scrollLeft = 0;\n\n\t\t\t\t\tif( this._isInputSelected ) {\n\t\t\t\t\t\tthis._isInputSelected = false;\n\t\t\t\t\t\tinput.select();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( update !== false ) {\n\t\t\t\tDApplications.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected createText( formatted: string ): Text | DDynamicText {\n\t\tconst result = super.createText( formatted );\n\t\tif( this._isInputShown ) {\n\t\t\tresult.visible = false;\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * Please note that this method does not update transforms.\n\t *\n\t * @param inputRect\n\t */\n\tprotected getClipperRect( inputRect: Rectangle, resolution: number ) {\n\t\tconst rect = this._clipperRect = ( this._clipperRect != null ? this._clipperRect : new Rectangle() );\n\t\trect.copyFrom( inputRect );\n\n\t\tconst p = new Point( 0, 0 );\n\t\tlet current = this.parent;\n\t\twhile( current instanceof DBase ) {\n\t\t\tp.set( 0, 0 );\n\t\t\tcurrent.toGlobal( p, p, false );\n\t\t\tlet x = p.x;\n\t\t\tlet y = p.y;\n\n\t\t\tp.set( current.width, current.height );\n\t\t\tcurrent.toGlobal( p, p, true );\n\t\t\tconst w = p.x - x;\n\t\t\tconst h = p.y - y;\n\n\t\t\tx = ( (x * resolution) | 0 ) / resolution;\n\t\t\ty = ( (y * resolution) | 0 ) / resolution;\n\n\t\t\tconst x0 = rect.x;\n\t\t\tconst y0 = rect.y;\n\t\t\tconst x1 = rect.x + rect.width;\n\t\t\tconst y1 = rect.y + rect.height;\n\n\t\t\trect.x = Math.min( Math.max( x0, x ), x + w );\n\t\t\trect.y = Math.min( Math.max( y0, y ), y + h );\n\n\t\t\trect.width = Math.min( Math.max( x1, x ), x + w ) - rect.x;\n\t\t\trect.height = Math.min( Math.max( y1, y ), y + h ) - rect.y;\n\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\treturn rect;\n\t}\n\n\t/**\n\t * Please note that this method does not update transforms.\n\t */\n\tprotected getInputRect( resolution: number ) {\n\t\tconst rect = this._inputRect = ( this._inputRect != null ? this._inputRect : new Rectangle() );\n\n\t\tconst p = new Point( 0, 0 );\n\t\tthis.toGlobal( p, p, false );\n\t\trect.x = p.x;\n\t\trect.y = p.y;\n\n\t\tp.set( this.width, this.height );\n\t\tthis.toGlobal( p, p, true );\n\t\trect.width = p.x - rect.x;\n\t\trect.height = p.y - rect.y;\n\n\t\t// Rounds pixels as Pixi.js does\n\t\trect.x = ( (rect.x * resolution) | 0 ) / resolution;\n\t\trect.y = ( (rect.y * resolution) | 0 ) / resolution;\n\n\t\treturn rect;\n\t}\n\n\tprotected initInput(\n\t\tinput: HTMLInputElement, clipper: HTMLDivElement,\n\t\tinputRect: Rectangle, clipperRect: Rectangle\n\t) {\n\t\tinput.type = this.getInputType();\n\t\tinput.value = this._editingFormatter( this._textValueComputed, this );\n\t\tinput.addEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\tinput.addEventListener( \"blur\", this._onInputBlurBound );\n\t\tinput.addEventListener( \"change\", this._onInputChangeBound );\n\t\tinput.addEventListener( \"input\", this._onInputInputBound );\n\n\t\t// Style\n\t\tconst theme = this.theme;\n\t\tconst state = this.state;\n\t\tclipper.setAttribute( \"style\", this.getClipperStyle( state, theme, inputRect, clipperRect ) );\n\t\tinput.setAttribute( \"style\", this.getInputStyle( state, theme, inputRect, clipperRect ) );\n\n\t\t// ReadOnly\n\t\tif( this.isReadOnly() ) {\n\t\t\tinput.setAttribute( \"readonly\", \"readonly\" );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"readonly\" );\n\t\t}\n\n\t\t// Disabled\n\t\tif( this.isDisabled() ) {\n\t\t\tinput.setAttribute( \"disabled\", \"disabled\" );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"disabled\" );\n\t\t}\n\t}\n\n\tcancel(): void {\n\t\tif( this._isInputShown ) {\n\t\t\tthis._isInputShown = false;\n\n\t\t\tconst text = this._text;\n\t\t\tif( text != null ) {\n\t\t\t\ttext.visible = true;\n\t\t\t}\n\n\t\t\tconst input = DInput._input;\n\t\t\tif( input != null ) {\n\t\t\t\tinput.removeEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\t\t\tinput.removeEventListener( \"blur\", this._onInputBlurBound );\n\t\t\t\tinput.removeEventListener( \"change\", this._onInputChangeBound );\n\t\t\t\tinput.removeEventListener( \"input\", this._onInputInputBound );\n\t\t\t\tinput.type = \"text\";\n\t\t\t\tthis.resetSelection( input );\n\t\t\t}\n\n\t\t\tconst clipper = DInput._clipper;\n\t\t\tif( clipper != null ) {\n\t\t\t\tclipper.style.display = \"none\";\n\t\t\t}\n\n\t\t\tconst renderer = this._updateInputBoundRenderer;\n\t\t\tif( renderer != null ) {\n\t\t\t\tthis._updateInputBoundRenderer = null;\n\t\t\t\trenderer.off( \"postrender\", this._updateInputBound );\n\t\t\t}\n\n\t\t\tthis._isInputSelected = false;\n\n\t\t\tconst application = DApplications.getInstance();\n\t\t\tconst view = application.view;\n\t\t\tview.focus();\n\n\t\t\tconst interactionManager = application.renderer.plugins.interaction;\n\t\t\tif( this.containsPoint( interactionManager.mouse.global ) && ! this.isHovered() ) {\n\t\t\t\tthis.setHovered( true );\n\t\t\t\tview.style.cursor = this.cursor;\n\t\t\t}\n\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tprotected resetSelection( input: HTMLInputElement ) {\n\t\tinput.setSelectionRange( input.value.length, input.value.length, \"backward\" );\n\t}\n\n\tprotected getInput( clipper: HTMLDivElement ): HTMLInputElement | null {\n\t\tif( DInput._input == null ) {\n\t\t\tclipper.appendChild( DInput._input = this.createInput() );\n\t\t}\n\t\treturn DInput._input;\n\t}\n\n\tprotected createInput(): HTMLInputElement {\n\t\tconst result = document.createElement( \"input\" );\n\t\tresult.setAttribute( \"spellcheck\", \"false\" );\n\t\treturn result;\n\t}\n\n\tprotected getClipper(): HTMLDivElement | null {\n\t\tif( DInput._clipper == null ) {\n\t\t\tconst clipper = DInput._clipper = this.createClipper();\n\t\t\tDApplications.getInstance().getRootElement().appendChild( clipper );\n\t\t}\n\t\treturn DInput._clipper;\n\t}\n\n\tprotected createClipper(): HTMLDivElement {\n\t\treturn document.createElement( \"div\" );\n\t}\n\n\tprotected getInputStyleBackground( state: DBaseState, theme: DThemeInput ): string {\n\t\treturn `background-color: transparent;`;\n\t}\n\n\tprotected getInputStyleBorder( state: DBaseState, theme: DThemeInput ): string {\n\t\treturn `border: none; box-sizing: border-box;`;\n\t}\n\n\tprotected getInputStylePadding( state: DBaseState, theme: DThemeInput, inputRect: Rectangle ): string {\n\t\tconst paddingTop = theme.getPaddingTop();\n\t\tconst paddingRight = theme.getPaddingRight();\n\t\tconst paddingBottom = theme.getPaddingBottom();\n\t\tconst paddingLeft = theme.getPaddingLeft();\n\t\treturn `padding: ${paddingTop}px ${paddingRight}px ${paddingBottom}px ${paddingLeft}px;`;\n\t}\n\n\tprotected getInputStyleOutline( state: DBaseState, theme: DThemeInput ): string {\n\t\treturn `outline: none;`;\n\t}\n\n\tprotected getInputStylePosition(\n\t\tstate: DBaseState, theme: DThemeInput,\n\t\tinputRect: Rectangle, clipperRect: Rectangle\n\t): string {\n\t\treturn `position: absolute;` +\n\t\t\t`left: ${inputRect.x - clipperRect.x}px;` +\n\t\t\t`top: ${inputRect.y - clipperRect.y}px;` +\n\t\t\t`width: ${inputRect.width}px;` +\n\t\t\t`height: ${inputRect.height}px;` +\n\t\t\t`line-height: ${inputRect.height}px;`;\n\t}\n\n\tprotected getInputStyleText( state: DBaseState, theme: DThemeInput ): string {\n\t\treturn `font-family: ${theme.getFontFamilly()};` +\n\t\t\t`font-size: ${theme.getFontSize()}px;` +\n\t\t\t`color: #${theme.getColor( state ).toString( 16 )};`;\n\t}\n\n\tprotected getInputStyleMargin( state: DBaseState, theme: DThemeInput ): string {\n\t\treturn \"margin: 0;\";\n\t}\n\n\tprotected getInputStyle(\n\t\tstate: DBaseState, theme: DThemeInput,\n\t\tinputRect: Rectangle, clipperRect: Rectangle\n\t): string {\n\t\treturn this.getInputStylePosition( state, theme, inputRect, clipperRect ) +\n\t\t\tthis.getInputStyleMargin( state, theme ) +\n\t\t\tthis.getInputStyleText( state, theme ) +\n\t\t\tthis.getInputStyleBackground( state, theme ) +\n\t\t\tthis.getInputStyleBorder( state, theme ) +\n\t\t\tthis.getInputStylePadding( state, theme, inputRect ) +\n\t\t\tthis.getInputStyleOutline( state, theme );\n\t}\n\n\tprotected getClipperStylePosition(\n\t\tstate: DBaseState, theme: DThemeInput,\n\t\tinputRect: Rectangle, clipperRect: Rectangle\n\t): string {\n\t\treturn `position: absolute;` +\n\t\t\t`left: ${clipperRect.x}px;` +\n\t\t\t`top: ${clipperRect.y}px;` +\n\t\t\t`width: ${clipperRect.width}px;` +\n\t\t\t`height: ${clipperRect.height}px;` +\n\t\t\t`line-height: ${inputRect.height}px;`;\n\t}\n\n\tprotected getClipperStyle(\n\t\tstate: DBaseState, theme: DThemeInput,\n\t\tinputRect: Rectangle, clipperRect: Rectangle\n\t) {\n\t\treturn `overflow: hidden; outline: none;` +\n\t\t\t`padding: 0; margin: 0; border: none; background-color: transparent;` +\n\t\t\tthis.getClipperStylePosition( state, theme, inputRect, clipperRect );\n\t}\n\n\tprotected onInputKeyDown( e: KeyboardEvent ) {\n\t\tif( UtilKeyboardEvent.isFocusKey( e ) ) {\n\t\t\tthis.end();\n\n\t\t\tconst focusController = DControllers.getFocusController();\n\t\t\tconst direction = UtilKeyboardEvent.getFocusDirection( e );\n\t\t\tconst focusable = focusController.findFocusable( this, false, false, direction );\n\t\t\tif( focusable != null ) {\n\t\t\t\tDApplications.getInstance().view.focus();\n\t\t\t\tfocusController.setFocused( focusable, true, true );\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t}\n\t\t} else if( UtilKeyboardEvent.isOkKey( e ) ) {\n\t\t\tthis.end();\n\t\t\tthis.emit( \"enter\", this );\n\t\t} else if( UtilKeyboardEvent.isCancelKey( e ) ) {\n\t\t\tthis.cancel();\n\t\t}\n\t}\n\n\tprotected onInputBlur( e: FocusEvent ) {\n\t\tthis.end();\n\t}\n\n\tend(): void {\n\t\tthis.onInputChange();\n\t\tthis.cancel();\n\t}\n\n\tprotected onInputInput( e: Event ) {\n\t\tif( e.target instanceof HTMLInputElement ) {\n\t\t\tthis.emit( \"input\", this.toValue( e.target.value ), this );\n\t\t}\n\t}\n\n\tprotected onInputChange() {\n\t\tif( this._isInputShown ) {\n\t\t\tconst input = DInput._input;\n\t\t\tif( input != null ) {\n\t\t\t\tconst newValue = this.toValue( input.value );\n\t\t\t\tconst oldValue = this._textValueComputed;\n\t\t\t\tif( oldValue !== newValue ) {\n\t\t\t\t\tthis.text = newValue;\n\t\t\t\t\tthis.onTextValueChange( newValue, oldValue );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onTextValueChange( newValue: VALUE, oldValue: VALUE ): void {\n\t\tthis.validate();\n\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t}\n\n\tselect(): this {\n\t\tconst input = DInput._input;\n\t\tif( input != null && this._isInputShown ) {\n\t\t\tinput.select();\n\t\t} else {\n\t\t\tthis._isInputSelected = true;\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected updateInput() {\n\t\tif( this._isInputShown ) {\n\t\t\tif( this.worldVisible ) {\n\t\t\t\tconst input = DInput._input;\n\t\t\t\tconst clipper = DInput._clipper;\n\t\t\t\tif( input != null && clipper != null ) {\n\t\t\t\t\tconst resolution = DApplications.getInstance().renderer.resolution;\n\t\t\t\t\tconst inputRect = this.getInputRect( resolution );\n\t\t\t\t\tconst clipperRect = this.getClipperRect( inputRect, resolution );\n\t\t\t\t\tconst theme = this.theme;\n\t\t\t\t\tconst state = this.state;\n\t\t\t\t\tinput.setAttribute( \"style\", this.getInputStyle( state, theme, inputRect, clipperRect ) );\n\t\t\t\t\tclipper.setAttribute( \"style\", this.getClipperStyle( state, theme, inputRect, clipperRect ) );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.cancel();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onDownThis( e: InteractionEvent ): void {\n\t\tif( this.isFocused() ) {\n\t\t\tthis.start();\n\t\t}\n\t\tsuper.onDownThis( e );\n\t}\n\n\tprotected abstract toValue( valueAsString: string ): VALUE;\n\tprotected abstract getInputType(): string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Rectangle } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DInput, DInputOptions, DThemeInput } from \"./d-input\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport interface DInputNumberOptions<\n\tTHEME extends DThemeInputNumber = DThemeInputNumber\n> extends DInputOptions<number, THEME> {\n\tstep?: number | null;\n\tmin?: number | null;\n\tmax?: number | null;\n}\n\nexport interface DThemeInputNumber extends DThemeInput {\n\tgetEditingFormatter(): ( value: number, caller: DInputNumber ) => string;\n\tgetEditingUnformatter(): ( text: string, caller: DInputNumber ) => number;\n\tgetEditingValidator(): ( value: number, caller: DInputNumber ) => unknown;\n\tgetTextValue( state: DBaseState ): number;\n\tnewTextValue(): DStateAwareOrValueMightBe<number>;\n\tgetStep(): number | null;\n\tgetMin(): number | null;\n\tgetMax(): number | null;\n}\n\n// Option parser\nconst toStep = <THEME extends DThemeInputNumber>(\n\ttheme: THEME, options?: DInputNumberOptions<THEME>\n): number | null => {\n\tif( options != null ) {\n\t\treturn ( options.step != null ? options.step : theme.getStep() );\n\t}\n\treturn null;\n};\n\nconst toMin = <THEME extends DThemeInputNumber>(\n\ttheme: THEME, options?: DInputNumberOptions<THEME>\n): number | null => {\n\tif( options != null ) {\n\t\treturn ( options.min != null ? options.min : theme.getMin() );\n\t}\n\treturn null;\n};\n\nconst toMax = <THEME extends DThemeInputNumber>(\n\ttheme: THEME, options?: DInputNumberOptions<THEME>\n): number | null => {\n\tif( options != null ) {\n\t\treturn ( options.max != null ? options.max : theme.getMax() );\n\t}\n\treturn null;\n};\n\nexport abstract class DInputNumber<\n\tTHEME extends DThemeInputNumber = DThemeInputNumber,\n\tOPTIONS extends DInputNumberOptions<THEME> = DInputNumberOptions<THEME>\n> extends DInput<number, THEME, OPTIONS> {\n\tprotected _step!: number | null;\n\tprotected _min!: number | null;\n\tprotected _max!: number | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst theme = this.theme;\n\t\tthis._step = toStep( theme, options );\n\t\tthis._min = toMin( theme, options );\n\t\tthis._max = toMax( theme, options );\n\t}\n\n\tget step(): number | null {\n\t\treturn this._step;\n\t}\n\n\tset step( step: number | null ) {\n\t\tif( this._step !== step ) {\n\t\t\tthis._step = step;\n\t\t\tthis.updateInputStep();\n\t\t}\n\t}\n\n\tget min(): number | null {\n\t\treturn this._min;\n\t}\n\n\tset min( min: number | null ) {\n\t\tif( this._min !== min ) {\n\t\t\tthis._min = min;\n\t\t\tthis.updateInputMin();\n\t\t}\n\t}\n\n\tget max(): number | null {\n\t\treturn this._max;\n\t}\n\n\tset max( max: number | null ) {\n\t\tif( this._max !== max ) {\n\t\t\tthis._max = max;\n\t\t\tthis.updateInputMax();\n\t\t}\n\t}\n\n\tprotected toValue( valueAsString: string ): number {\n\t\tconst result = this._editingUnformatter( valueAsString, this );\n\t\tif( result === result /* NaN Check */ ) {\n\t\t\tif( this._min != null && result < this._min ) {\n\t\t\t\treturn this._min;\n\t\t\t}\n\t\t\tif( this._max != null && this._max < result ) {\n\t\t\t\treturn this._max;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn this.value;\n\t}\n\n\tprotected updateInputStep(): void {\n\t\tif( this._isInputShown ) {\n\t\t\tconst input = DInput._input;\n\t\t\tif( input != null ) {\n\t\t\t\tthis.initInputStep( input );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateInputMin(): void {\n\t\tif( this._isInputShown ) {\n\t\t\tconst input = DInput._input;\n\t\t\tif( input != null ) {\n\t\t\t\tthis.initInputMin( input );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateInputMax(): void {\n\t\tif( this._isInputShown ) {\n\t\t\tconst input = DInput._input;\n\t\t\tif( input != null ) {\n\t\t\t\tthis.initInputMax( input );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected initInputStep( input: HTMLInputElement ): void {\n\t\tif( this._step != null ) {\n\t\t\tinput.step = String( this._step );\n\t\t} else {\n\t\t\tinput.removeAttribute( \"step\" );\n\t\t}\n\t}\n\n\tprotected initInputMin( input: HTMLInputElement ): void {\n\t\tif( this._min != null ) {\n\t\t\tinput.min = `${this._min}`;\n\t\t} else {\n\t\t\tinput.removeAttribute( \"min\" );\n\t\t}\n\t}\n\n\tprotected initInputMax( input: HTMLInputElement ): void {\n\t\tif( this._max != null ) {\n\t\t\tinput.max = `${this._max}`;\n\t\t} else {\n\t\t\tinput.removeAttribute( \"max\" );\n\t\t}\n\t}\n\n\tprotected initInput(\n\t\tinput: HTMLInputElement, clipper: HTMLDivElement,\n\t\tinputRect: Rectangle, clipperRect: Rectangle\n\t): void {\n\t\tsuper.initInput( input, clipper, inputRect, clipperRect );\n\t\tthis.initInputStep( input );\n\t\tthis.initInputMin( input );\n\t\tthis.initInputMax( input );\n\t}\n\n\tprotected resetSelection( input: HTMLInputElement ) {\n\t\tinput.type = \"text\";\n\t\tsuper.resetSelection( input );\n\t\tinput.type = \"number\";\n\t}\n\n\tprotected getInputType(): string {\n\t\treturn \"number\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputNumber, DInputNumberOptions, DThemeInputNumber } from \"./d-input-number\";\n\nexport interface DInputRealOptions<\n\tTHEME extends DThemeInputReal = DThemeInputReal\n> extends DInputNumberOptions<THEME> {\n\n}\n\nexport interface DThemeInputReal extends DThemeInputNumber {\n\n}\n\nexport class DInputReal<\n\tTHEME extends DThemeInputReal = DThemeInputReal,\n\tOPTIONS extends DInputRealOptions<THEME> = DInputRealOptions<THEME>\n> extends DInputNumber<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputReal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\n\nexport interface DTextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeText = DThemeText\n> extends DTextBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeText extends DThemeTextBase {\n\n}\n\nexport class DText<\n\tVALUE = unknown,\n\tTHEME extends DThemeText = DThemeText,\n\tOPTIONS extends DTextOptions<VALUE, THEME> = DTextOptions<VALUE, THEME>\n> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DInputLabelOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeText = DThemeText\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeInputLabel extends DThemeText {\n\n}\n\nexport class DInputLabel<\n\tVALUE = unknown,\n\tTHEME extends DThemeInputLabel = DThemeInputLabel,\n\tOPTIONS extends DInputLabelOptions<VALUE, THEME> = DInputLabelOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DInputLabel, DInputLabelOptions } from \"./d-input-label\";\nimport { DLayoutOptions } from \"./d-layout\";\nimport { DLayoutHorizontal, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace, DLayoutSpaceOptions } from \"./d-layout-space\";\n\ninterface InputOptions {\n\tweight?: number;\n}\n\ninterface Input extends DisplayObject {\n\treadonly height: number;\n}\n\nexport interface DInputAndLabelOptions<\n\tINPUT_OPTIONS extends InputOptions = InputOptions,\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DLayoutOptions<THEME> {\n\tinput?: INPUT_OPTIONS;\n\tlabel?: DInputLabelOptions;\n\tspace?: DLayoutSpaceOptions;\n}\n\nexport interface DThemeInputAndLabel extends DThemeLayoutHorizontal {\n\n}\n\nexport abstract class DInputAndLabel<\n\tINPUT extends Input,\n\tINPUT_OPTIONS extends InputOptions,\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputAndLabelOptions<INPUT_OPTIONS, THEME> = DInputAndLabelOptions<INPUT_OPTIONS, THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _input: INPUT;\n\tprotected _label: DInputLabel;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.addChild( this._label = new DInputLabel( options != null ? options.label : undefined ) );\n\t\tthis.addChild( this._input = this.createInput( options != null ? options.input : undefined ) );\n\t\tif( options != null && options.space != null ) {\n\t\t\tthis.addChild( new DLayoutSpace( options.space ) );\n\t\t}\n\t}\n\n\tget input() {\n\t\treturn this._input;\n\t}\n\n\tget label() {\n\t\treturn this._label;\n\t}\n\n\tprotected abstract createInput( options?: INPUT_OPTIONS | { weight: number } ): INPUT;\n\n\tprotected getType(): string {\n\t\treturn \"DInputAndLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputReal, DInputRealOptions, DThemeInputReal } from \"./d-input-real\";\n\nexport interface DInputRealAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputRealOptions, THEME> {}\n\nexport class DInputRealAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputRealAndLabelOptions<THEME> = DInputRealAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputReal, DInputRealOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputRealOptions<DThemeInputReal> ): DInputReal {\n\t\treturn new DInputReal( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DInput, DInputOptions, DThemeInput } from \"./d-input\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport interface DInputTextOptions<\n\tTHEME extends DThemeInputText = DThemeInputText\n> extends DInputOptions<string, THEME> {\n\n}\n\nexport interface DThemeInputText extends DThemeInput {\n\tgetEditingFormatter(): ( value: string, caller: DInputText ) => string;\n\tgetEditingUnformatter(): ( text: string, caller: DInputText ) => string;\n\tgetEditingValidator(): ( value: string, caller: DInputText ) => unknown;\n\tgetTextFormatter(): ( value: string, caller: DInputText ) => string;\n\tgetTextValue( state: DBaseState ): string;\n\tnewTextValue(): DStateAwareOrValueMightBe<string>;\n}\n\nexport class DInputText<\n\tTHEME extends DThemeInputText = DThemeInputText,\n\tOPTIONS extends DInputTextOptions<THEME> = DInputTextOptions<THEME>\n> extends DInput<string, THEME, OPTIONS> {\n\tprotected toValue( valueAsString: string ): string {\n\t\treturn this._editingUnformatter( valueAsString, this );\n\t}\n\n\tprotected getInputType(): string {\n\t\treturn \"text\";\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputText, DInputTextOptions, DThemeInputText } from \"./d-input-text\";\n\nexport interface DInputTextAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputTextOptions, THEME> {}\n\nexport class DInputTextAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputTextAndLabelOptions<THEME> = DInputTextAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputText, DInputTextOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputTextOptions<DThemeInputText> ): DInputText {\n\t\treturn new DInputText( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorAndAlpha } from \"./d-color\";\n\nexport class DPickerColorAndAlpha implements DColorAndAlpha {\n\tprotected _colorAndAlpha: DColorAndAlpha;\n\tprotected _onColorChange: ( color: number ) => void;\n\tprotected _onAlphaChange: ( alpha: number ) => void;\n\n\tconstructor(\n\t\tcolorAndAlpha: DColorAndAlpha,\n\t\tonColorChange: ( color: number ) => void,\n\t\tonAlphaChange: ( alpha: number ) => void\n\t) {\n\t\tthis._colorAndAlpha = colorAndAlpha;\n\t\tthis._onColorChange = onColorChange;\n\t\tthis._onAlphaChange = onAlphaChange;\n\t}\n\n\tget color() {\n\t\treturn this._colorAndAlpha.color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._colorAndAlpha.color !== color ) {\n\t\t\tconst callback = this._onColorChange;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback( color );\n\t\t\t}\n\t\t}\n\t}\n\n\tget alpha() {\n\t\treturn this._colorAndAlpha.alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._colorAndAlpha.alpha !== alpha ) {\n\t\t\tconst callback = this._onAlphaChange;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback( alpha );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DColorAndAlpha } from \"./d-color\";\n\nexport class DPickerColorRecent extends utils.EventEmitter {\n\tprotected _recents: DColorAndAlpha[];\n\tprotected _capacity: number;\n\n\tconstructor( recents: DColorAndAlpha[], capacity: number ) {\n\t\tsuper();\n\n\t\tthis._recents = recents;\n\t\tthis._capacity = capacity;\n\t}\n\n\tget( index: number ): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\treturn recents[ recents.length - 1 - index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, colorAndAlpha: DColorAndAlpha ): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\tconst result = recents[ recents.length - 1 - index ];\n\t\t\trecents[ recents.length - 1 - index ] = {\n\t\t\t\tcolor: colorAndAlpha.color,\n\t\t\t\talpha: colorAndAlpha.alpha\n\t\t\t};\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontains( colorAndAlpha: DColorAndAlpha ): boolean {\n\t\tconst recents = this._recents;\n\t\tfor( let i = 0, imax = recents.length; i < imax; ++i ) {\n\t\t\tconst recent = recents[ i ];\n\t\t\tif( recent.color === colorAndAlpha.color && recent.alpha === colorAndAlpha.alpha ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tadd( colorAndAlpha: DColorAndAlpha ): this {\n\t\tconst recents = this._recents;\n\t\trecents.push({\n\t\t\tcolor: colorAndAlpha.color,\n\t\t\talpha: colorAndAlpha.alpha\n\t\t});\n\t\tif( this._capacity < recents.length ) {\n\t\t\trecents.shift();\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n\n\tpop(): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tconst result = recents.shift();\n\t\tif( result != null ) {\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._recents.length;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, interaction, Point, Sprite, Texture } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DInputRealAndLabel } from \"./d-input-real-and-label\";\nimport { DInputTextAndLabel } from \"./d-input-text-and-label\";\nimport { DPickerColorAndAlpha } from \"./d-picker-color-and-alpha\";\nimport { DPickerColorRecent } from \"./d-picker-color-recent\";\nimport { UtilHsv } from \"./util/util-hsv\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilRgb } from \"./util/util-rgb\";\n\nexport interface DPickerColorOptions<THEME extends DThemePickerColor = DThemePickerColor> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerColor extends DThemeBase {\n\tgetMainWidth(): number;\n\tgetMainHeight(): number;\n\tgetMainTexture(): Texture;\n\tgetMainPointerTexture(): Texture;\n\tgetMainPointerColor(): number;\n\tgetMainPointerAlpha(): number;\n\n\tgetBaseHeight(): number;\n\tgetBaseMargin(): number;\n\tgetBaseTexture(): Texture;\n\tgetBasePointerTexture(): Texture;\n\tgetBasePointerColor(): number;\n\tgetBasePointerAlpha(): number;\n\n\tgetAlphaHeight(): number;\n\tgetAlphaMargin(): number;\n\tgetAlphaTexture(): Texture;\n\tgetAlphaCheckerboardTexture(): Texture;\n\tgetAlphaPointerTexture(): Texture;\n\tgetAlphaPointerColor(): number;\n\tgetAlphaPointerAlpha(): number;\n\n\tgetRecentMargin(): number;\n\tgetRecentColorMargin(): number;\n\tgetRecentColorWidth(): number;\n\tgetRecentColorHeight(): number;\n\tgetRecentColorCount(): number;\n\tgetRecentCheckerboardTexture(): Texture;\n\tgetRecents(): DColorAndAlpha[];\n\n\tgetInputMargin(): number;\n\tgetInputLabelWidth(): number;\n\n\tgetSampleWidth(): number;\n\tgetSampleHeight(): number;\n\tgetSampleCheckerboardTexture(): Texture;\n}\n\nexport class DPickerColor<\n\tTHEME extends DThemePickerColor = DThemePickerColor,\n\tOPTIONS extends DPickerColorOptions<THEME> = DPickerColorOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static RECENT_COLORS: DPickerColorRecent | null = null;\n\n\tprotected _mainBaseSprite!: Sprite;\n\tprotected _mainSprite!: Sprite;\n\tprotected _mainPointerSprite!: Sprite;\n\tprotected _pointerPoint!: Point;\n\tprotected _onMainMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onMainUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _baseSprite!: Sprite;\n\tprotected _basePointerSprite!: Sprite;\n\tprotected _onBaseMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onBaseUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _alphaCheckerboardSprite!: Sprite;\n\tprotected _alphaSprite!: Sprite;\n\tprotected _alphaPointerSprite!: Sprite;\n\tprotected _onAlphaMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAlphaUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _recentColorSprites!: Sprite[];\n\tprotected _recent!: DPickerColorRecent;\n\n\tprotected _inputAndLabelColor!: DInputTextAndLabel;\n\tprotected _inputAndLabelAlpha!: DInputRealAndLabel;\n\n\tprotected _sampleCurrentCheckerboardSprite!: Sprite;\n\tprotected _sampleCurrentSprite!: Sprite;\n\tprotected _sampleNewCheckerboardSprite!: Sprite;\n\tprotected _sampleNewSprite!: Sprite;\n\n\tprotected _current!: DColorAndAlpha;\n\tprotected _currentPicker!: DPickerColorAndAlpha;\n\tprotected _base!: number;\n\tprotected _new!: DColorAndAlpha;\n\tprotected _newPicker!: DPickerColorAndAlpha;\n\n\tget current(): DColorAndAlpha {\n\t\treturn this._currentPicker;\n\t}\n\n\tget new(): DColorAndAlpha {\n\t\treturn this._newPicker;\n\t}\n\n\tget recent(): DPickerColorRecent {\n\t\treturn this._recent;\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tthis._base = 0xff0000;\n\t\tthis._new = { color: 0xffffff, alpha: 1 };\n\t\tthis._newPicker = new DPickerColorAndAlpha( this._new, ( color ) => {\n\t\t\tthis.setColorNew( color );\n\t\t}, ( alpha: number ) => {\n\t\t\tthis.setAlphaNew( alpha );\n\t\t});\n\t\tthis._current = { color: 0xffffff, alpha: 1 };\n\t\tthis._currentPicker = new DPickerColorAndAlpha( this._current, ( color ) => {\n\t\t\tthis.setColorCurrent( color );\n\t\t}, ( alpha: number ) => {\n\t\t\tthis.setAlphaCurrent( alpha );\n\t\t});\n\n\t\tconst theme = this.theme;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tthis._pointerPoint = new Point();\n\n\t\t// Main\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst mainBaseSprite = this._mainBaseSprite = new Sprite( Texture.WHITE );\n\t\tmainBaseSprite.x = paddingLeft;\n\t\tmainBaseSprite.y = paddingTop;\n\t\tmainBaseSprite.width = mainWidth;\n\t\tmainBaseSprite.height = mainHeight;\n\t\tmainBaseSprite.interactive = true;\n\t\tthis.addChild( mainBaseSprite );\n\n\t\tconst mainSprite = this._mainSprite = new Sprite( theme.getMainTexture() );\n\t\tmainSprite.x = paddingLeft;\n\t\tmainSprite.y = paddingTop;\n\t\tmainSprite.tint = this._base;\n\t\tmainSprite.interactive = false;\n\t\tthis.addChild( mainSprite );\n\n\t\t// Main event handling\n\t\tthis._onMainMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMainMove( e );\n\t\t};\n\t\tthis._onMainUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMainUp( e );\n\t\t};\n\t\tmainBaseSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onMainDown( e );\n\t\t});\n\n\t\t// Base color picker\n\t\tconst baseSprite = this._baseSprite = new Sprite( theme.getBaseTexture() );\n\t\tbaseSprite.x = paddingLeft;\n\t\tbaseSprite.y = mainBaseSprite.y + mainBaseSprite.height + theme.getBaseMargin();\n\t\tbaseSprite.interactive = true;\n\t\tthis.addChild( baseSprite );\n\n\t\t// Base event\n\t\tthis._onBaseMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onBaseMove( e );\n\t\t};\n\t\tthis._onBaseUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onBaseUp( e );\n\t\t};\n\t\tbaseSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onBaseDown( e );\n\t\t});\n\n\t\t// Alpha picker\n\t\tconst alphaCheckerboardSprite = this._alphaCheckerboardSprite =\n\t\t\tnew Sprite( theme.getAlphaCheckerboardTexture() );\n\t\talphaCheckerboardSprite.x = padding.getLeft();\n\t\talphaCheckerboardSprite.y = baseSprite.y + theme.getBaseHeight() + theme.getBaseMargin();\n\t\talphaCheckerboardSprite.interactive = false;\n\t\tthis.addChild( alphaCheckerboardSprite );\n\n\t\tconst alphaSprite = new Sprite( theme.getAlphaTexture() );\n\t\talphaSprite.tint = this._new.color;\n\t\talphaSprite.interactive = true;\n\t\talphaCheckerboardSprite.addChild( alphaSprite );\n\n\t\t// Alpha event\n\t\tthis._onAlphaMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAlphaMove( e );\n\t\t};\n\t\tthis._onAlphaUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAlphaUp( e );\n\t\t};\n\t\talphaSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onAlphaDown( e );\n\t\t});\n\n\t\t// Pointers\n\t\tconst mainPointerSprite = this._mainPointerSprite = new Sprite( theme.getMainPointerTexture() );\n\t\tmainPointerSprite.x = paddingLeft;\n\t\tmainPointerSprite.y = paddingTop;\n\t\tmainPointerSprite.anchor.x = 0.5;\n\t\tmainPointerSprite.anchor.y = 0.5;\n\t\tmainPointerSprite.tint = theme.getMainPointerColor();\n\t\tmainPointerSprite.alpha = theme.getMainPointerAlpha();\n\t\tmainPointerSprite.interactive = false;\n\t\tthis.addChild( mainPointerSprite );\n\n\t\tconst alphaPointerSprite = this._alphaPointerSprite = new Sprite( theme.getAlphaPointerTexture() );\n\t\talphaPointerSprite.x = mainWidth;\n\t\talphaPointerSprite.y = alphaCheckerboardSprite.height * 0.5;\n\t\talphaPointerSprite.tint = theme.getAlphaPointerColor();\n\t\talphaPointerSprite.alpha = theme.getAlphaPointerAlpha();\n\t\talphaPointerSprite.anchor.set( 0.5, 0.5 );\n\t\talphaPointerSprite.interactive = false;\n\t\talphaCheckerboardSprite.addChild( alphaPointerSprite );\n\n\t\tconst basePointerSprite = this._basePointerSprite = new Sprite( theme.getBasePointerTexture() );\n\t\tbasePointerSprite.x = 0;\n\t\tbasePointerSprite.y = baseSprite.height * 0.5;\n\t\tbasePointerSprite.tint = theme.getBasePointerColor();\n\t\tbasePointerSprite.alpha = theme.getBasePointerAlpha();\n\t\tbasePointerSprite.anchor.set( 0.5, 0.5 );\n\t\tbasePointerSprite.interactive = false;\n\t\tbaseSprite.addChild( basePointerSprite );\n\n\t\t// Recently used\n\t\tthis._recentColorSprites = [];\n\t\tconst recentColorSprites = this._recentColorSprites;\n\t\tconst recentColorCount = theme.getRecentColorCount();\n\t\tconst recentColorWidth = theme.getRecentColorWidth();\n\t\tconst recentColorHeight = theme.getRecentColorHeight();\n\t\tconst recentColorWidthHalf = recentColorWidth * 0.5;\n\t\tconst recentColorHeightHalf = recentColorHeight * 0.5;\n\t\tconst recentColorMargin = theme.getRecentColorMargin();\n\t\tconst recentColorY = alphaCheckerboardSprite.y + theme.getAlphaHeight() + theme.getRecentMargin();\n\t\tconst recentCheckerboardTexture = theme.getRecentCheckerboardTexture();\n\t\tif( DPickerColor.RECENT_COLORS == null ) {\n\t\t\tDPickerColor.RECENT_COLORS = new DPickerColorRecent(\n\t\t\t\ttheme.getRecents().slice( 0 ),\n\t\t\t\trecentColorCount\n\t\t\t);\n\t\t}\n\t\tconst recent = this._recent = DPickerColor.RECENT_COLORS;\n\t\trecent.on( \"change\", () => {\n\t\t\tthis.onRecentChange();\n\t\t});\n\t\tconst onRecentClick = ( e: InteractionEvent ) => {\n\t\t\tconst checkerboardSprite = e.currentTarget;\n\t\t\tif( checkerboardSprite instanceof Container ) {\n\t\t\t\tconst sprite = checkerboardSprite.children[ 0 ];\n\t\t\t\tif( sprite instanceof Sprite ) {\n\t\t\t\t\tthis.setColorNew( sprite.tint );\n\t\t\t\t\tthis.setAlphaNew( sprite.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tfor( let i = 0; i < recentColorCount; ++i ) {\n\t\t\tconst x = paddingLeft + i * (recentColorWidth + recentColorMargin);\n\n\t\t\tconst checkerboardSprite = new Sprite( recentCheckerboardTexture );\n\t\t\tcheckerboardSprite.x = x + recentColorWidthHalf;\n\t\t\tcheckerboardSprite.y = recentColorY + recentColorHeightHalf;\n\t\t\tcheckerboardSprite.anchor.x = 0.5;\n\t\t\tcheckerboardSprite.anchor.y = 0.5;\n\t\t\tcheckerboardSprite.buttonMode = true;\n\t\t\tcheckerboardSprite.interactive = true;\n\t\t\tUtilPointerEvent.onClick( checkerboardSprite, onRecentClick );\n\t\t\tthis.addChild( checkerboardSprite );\n\n\t\t\tconst sprite = new Sprite( Texture.WHITE );\n\t\t\tconst recentColorAndAlpha = recent.get( i );\n\t\t\tif( recentColorAndAlpha != null ) {\n\t\t\t\tsprite.tint = recentColorAndAlpha.color;\n\t\t\t\tsprite.alpha = recentColorAndAlpha.alpha;\n\t\t\t} else {\n\t\t\t\tsprite.tint = 0xffffff;\n\t\t\t\tsprite.alpha = 0;\n\t\t\t}\n\t\t\tsprite.width = recentColorWidth;\n\t\t\tsprite.height = recentColorHeight;\n\t\t\tsprite.anchor.x = 0.5;\n\t\t\tsprite.anchor.y = 0.5;\n\t\t\tsprite.interactive = false;\n\t\t\tcheckerboardSprite.addChild( sprite );\n\t\t\trecentColorSprites.push( sprite );\n\t\t}\n\n\t\t// Input color\n\t\tconst inputMargin = theme.getInputMargin();\n\t\tconst inputY = recentColorY + recentColorHeight + inputMargin;\n\t\tconst inputWidth = mainWidth * 0.5;\n\t\tconst inputAndLabelColor = this._inputAndLabelColor = new DInputTextAndLabel({\n\t\t\tparent: this,\n\t\t\tx: paddingLeft,\n\t\t\ty: inputY,\n\t\t\twidth: inputWidth,\n\t\t\tlabel: {\n\t\t\t\twidth: theme.getInputLabelWidth(),\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"#\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"FFFFFF\"\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tinput: ( code: string ): void => {\n\t\t\t\t\t\tconst color = UtilRgb.fromCode( code );\n\t\t\t\t\t\tif( color != null ) {\n\t\t\t\t\t\t\tthis.setColorNew( color );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tconst inputAndLabelAlpha = this._inputAndLabelAlpha = new DInputRealAndLabel({\n\t\t\tparent: this,\n\t\t\tx: paddingLeft,\n\t\t\ty: inputY + inputAndLabelColor.height + inputMargin,\n\t\t\twidth: inputWidth,\n\t\t\tlabel: {\n\t\t\t\twidth: theme.getInputLabelWidth(),\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"A\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: 1\n\t\t\t\t},\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 1,\n\t\t\t\ton: {\n\t\t\t\t\tinput: ( value: number ) => {\n\t\t\t\t\t\tthis.setAlphaNew( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Samples\n\t\tconst sampleWidth = theme.getSampleWidth();\n\t\tconst sampleHeight = theme.getSampleHeight();\n\t\tconst sampleX = paddingLeft + mainWidth * 0.75 - sampleWidth;\n\t\tconst sampleY = inputY + (inputAndLabelColor.height + inputMargin + inputAndLabelAlpha.height - sampleHeight) * 0.5;\n\n\t\tconst sampleCurrentCheckerboardSprite = this._sampleCurrentCheckerboardSprite =\n\t\t\tnew Sprite( theme.getSampleCheckerboardTexture() );\n\t\tsampleCurrentCheckerboardSprite.x = sampleX;\n\t\tsampleCurrentCheckerboardSprite.y = sampleY;\n\t\tsampleCurrentCheckerboardSprite.width = sampleWidth;\n\t\tsampleCurrentCheckerboardSprite.height = sampleHeight;\n\t\tsampleCurrentCheckerboardSprite.interactive = false;\n\t\tthis.addChild( sampleCurrentCheckerboardSprite );\n\n\t\tconst current = this._current;\n\t\tconst sampleCurrentSprite = this._sampleCurrentSprite = new Sprite( Texture.WHITE );\n\t\tsampleCurrentSprite.x = sampleX;\n\t\tsampleCurrentSprite.y = sampleY;\n\t\tsampleCurrentSprite.tint = current.color;\n\t\tsampleCurrentSprite.alpha = current.alpha;\n\t\tsampleCurrentSprite.width = sampleWidth;\n\t\tsampleCurrentSprite.height = sampleHeight;\n\t\tsampleCurrentSprite.interactive = true;\n\t\tsampleCurrentSprite.buttonMode = true;\n\t\tUtilPointerEvent.onClick( sampleCurrentSprite, (): void => {\n\t\t\tthis.setColorNew( current.color );\n\t\t\tthis.setAlphaNew( current.alpha );\n\t\t});\n\t\tthis.addChild( sampleCurrentSprite );\n\n\t\tconst sampleNewCheckerboardSprite = this._sampleNewCheckerboardSprite =\n\t\t\tnew Sprite( theme.getSampleCheckerboardTexture() );\n\t\tsampleNewCheckerboardSprite.x = sampleX + sampleWidth;\n\t\tsampleNewCheckerboardSprite.y = sampleY;\n\t\tsampleNewCheckerboardSprite.width = sampleWidth;\n\t\tsampleNewCheckerboardSprite.height = sampleHeight;\n\t\tsampleNewCheckerboardSprite.interactive = false;\n\t\tthis.addChild( sampleNewCheckerboardSprite );\n\n\t\tconst sampleNewSprite = this._sampleNewSprite = new Sprite( Texture.WHITE );\n\t\tsampleNewSprite.x = sampleX + sampleWidth;\n\t\tsampleNewSprite.y = sampleY;\n\t\tsampleNewSprite.tint = this._new.color;\n\t\tsampleNewSprite.alpha = this._new.alpha;\n\t\tsampleNewSprite.width = sampleWidth;\n\t\tsampleNewSprite.height = sampleHeight;\n\t\tsampleNewSprite.interactive = false;\n\t\tthis.addChild( sampleNewSprite );\n\n\t\t// Width\n\t\tif( options == null || options.width == null ) {\n\t\t\tthis.width = paddingLeft + mainWidth + paddingRight;\n\t\t}\n\n\t\t// Height\n\t\tif( options == null || options.height == null ) {\n\t\t\tthis.height = inputY + inputAndLabelColor.height + inputMargin + inputAndLabelAlpha.height + paddingBottom;\n\t\t}\n\t}\n\n\tprotected onMainDown( e: InteractionEvent ): void {\n\t\tthis.onMainPick( e.data.global );\n\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.on( UtilPointerEvent.move, this._onMainMoveBound );\n\t\tstage.on( UtilPointerEvent.up, this._onMainUpBound );\n\t}\n\n\tprotected onMainMove( e: InteractionEvent ): void {\n\t\tthis.onMainPick( e.data.global );\n\t}\n\n\tprotected onMainUp( e: InteractionEvent ): void {\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.off( UtilPointerEvent.move, this._onMainMoveBound );\n\t\tstage.off( UtilPointerEvent.up, this._onMainUpBound );\n\t}\n\n\tprotected toMainHex( b: number, w0: number, w1: number, shift: number ) {\n\t\treturn Math.max( 0, Math.min( 255, w0 * 255 + w1 * (( b >> shift ) & 0xff) ) ) << shift;\n\t}\n\n\tprotected toMainColor( base: number, tx: number, ty: number, width: number, height: number ): number {\n\t\tconst hw = width * 0.5;\n\t\tconst ux = Math.max( 0, Math.min( 1, ((tx - hw) * ( 1 - ty / height ) + hw) / width ) );\n\t\tconst uy = Math.max( 0, Math.min( 1, ty / height ) );\n\t\tconst w1 = Math.abs( 0.5 * uy  - ux );\n\t\tconst w0 = 1 - w1 - uy;\n\t\tconst r = this.toMainHex( base, w0, w1, 16 );\n\t\tconst g = this.toMainHex( base, w0, w1, 8 );\n\t\tconst b = this.toMainHex( base, w0, w1, 0 );\n\t\treturn r | g | b;\n\t}\n\n\tprotected onMainPick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst paddingLeft = padding.getLeft();\n\t\tconst paddingTop = padding.getTop();\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - paddingLeft ) );\n\t\tconst y = Math.max( 0, Math.min( mainHeight, point.y - paddingTop ) );\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tmainPointerSprite.position.set( paddingLeft + x, paddingTop + y );\n\t\tthis.onColorNew( this.toMainColor(\n\t\t\tthis._base, x, y, mainWidth, mainHeight ) );\n\t}\n\n\tprotected setColorCurrent( color: number ) {\n\t\tthis._sampleCurrentSprite.tint = this._current.color = color;\n\t}\n\n\tprotected setAlphaCurrent( alpha: number ) {\n\t\tthis._sampleCurrentSprite.alpha = this._current.alpha = alpha;\n\t}\n\n\tprotected setColorNew( color: number ) {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst padding = this._padding;\n\n\t\t// Base color\n\t\tconst hsv = UtilHsv.fromRgb( color );\n\t\tthis._mainSprite.tint = this._base = UtilHsv.toRgb( hsv[ 0 ], 255, 255 );\n\n\t\t// Move the base pointer\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = Math.max( 0, Math.min( 1, hsv[ 0 ] / 360 ) ) * mainWidth;\n\n\t\t// Move the main pointer\n\t\tconst ns = Math.max( 0, Math.min( 1, hsv[ 1 ] / 255 ) );\n\t\tconst nv = Math.max( 0, Math.min( 1, 1 - hsv[ 2 ] / 255 ) );\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tmainPointerSprite.tint = (nv < 0.45 ? theme.getMainPointerColor() : 0xffffff);\n\t\tmainPointerSprite.position.set(\n\t\t\tpadding.getLeft() + ns * mainWidth,\n\t\t\tpadding.getTop() + nv * mainHeight\n\t\t);\n\n\t\t// New color\n\t\tthis.onColorNew( color );\n\t}\n\n\tprotected onColorNew( color: number ) {\n\t\tconst application = DApplications.getInstance();\n\t\tapplication.disallowUpdate();\n\t\tthis._sampleNewSprite.tint = this._new.color = color;\n\t\tthis._inputAndLabelColor.input.value = UtilRgb.toCode( color );\n\t\tthis.emit( \"newcolorchange\", color, this );\n\t\tapplication.allowUpdate();\n\t\tapplication.update();\n\t}\n\n\tprotected onBaseDown( e: InteractionEvent ): void {\n\t\tthis.onBasePick( e.data.global );\n\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.on( UtilPointerEvent.move, this._onBaseMoveBound );\n\t\tstage.on( UtilPointerEvent.up, this._onBaseUpBound );\n\t}\n\n\tprotected onBaseMove( e: InteractionEvent ): void {\n\t\tthis.onBasePick( e.data.global );\n\t}\n\n\tprotected onBaseUp( e: InteractionEvent ): void {\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.off( UtilPointerEvent.move, this._onBaseMoveBound );\n\t\tstage.off( UtilPointerEvent.up, this._onBaseUpBound );\n\t}\n\n\tprotected toBaseHex( t: number, shift: number ) {\n\t\treturn Math.max( 0, Math.min( 255, t * 6 * 255 ) ) << shift;\n\t}\n\n\tprotected toBaseColor( t: number ): number {\n\t\tif( t <= 0.167 ) {\n\t\t\treturn 0xff0000 + this.toBaseHex( t, 8 );\n\t\t} else if( t <= 0.333 ) {\n\t\t\tt = 0.333 - t;\n\t\t\treturn 0x00ff00 + this.toBaseHex( t, 16 );\n\t\t} else if( t <= 0.5 ) {\n\t\t\tt -= 0.333;\n\t\t\treturn 0x00ff00 + this.toBaseHex( t, 0 );\n\t\t} else if( t < 0.667 ) {\n\t\t\tt = 0.667 - t;\n\t\t\treturn 0x0000ff + this.toBaseHex( t, 8 );\n\t\t} else if( t < 0.883 ) {\n\t\t\tt -= 0.667;\n\t\t\treturn 0x0000ff + this.toBaseHex( t, 16 );\n\t\t} else {\n\t\t\tt = 0.883 - t;\n\t\t\treturn 0xff0000 + this.toBaseHex( t, 0 );\n\t\t}\n\t}\n\n\tprotected onBasePick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - padding.getLeft() ) );\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = x;\n\t\tthis.onColorBase( this.toBaseColor( x / mainWidth ) );\n\t}\n\n\tprotected setColorBase( h: number ) {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = Math.max( 0, Math.min( 1, h / 360 ) ) * mainWidth;\n\t\tthis.onColorBase( UtilHsv.toRgb( h, 255, 255 ) );\n\t}\n\n\tprotected onColorBase( color: number ) {\n\t\tthis._mainSprite.tint = this._base = color;\n\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst padding = this._padding;\n\t\tthis.onColorNew( this.toMainColor(\n\t\t\tthis._base,\n\t\t\tmainPointerSprite.x - padding.getLeft(),\n\t\t\tmainPointerSprite.y - padding.getTop(),\n\t\t\tmainWidth,\n\t\t\tmainHeight\n\t\t));\n\t}\n\n\tprotected onAlphaDown( e: InteractionEvent ): void {\n\t\tthis.onAlphaPick( e.data.global );\n\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.on( UtilPointerEvent.move, this._onAlphaMoveBound );\n\t\tstage.on( UtilPointerEvent.up, this._onAlphaUpBound );\n\t}\n\n\tprotected onAlphaMove( e: InteractionEvent ): void {\n\t\tthis.onAlphaPick( e.data.global );\n\t}\n\n\tprotected onAlphaUp( e: InteractionEvent ): void {\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.off( UtilPointerEvent.move, this._onAlphaMoveBound );\n\t\tstage.off( UtilPointerEvent.up, this._onAlphaUpBound );\n\t}\n\n\tprotected onAlphaPick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - padding.getLeft() ) );\n\t\tthis._alphaPointerSprite.x = x;\n\t\tthis.onAlphaNew( x / mainWidth );\n\t}\n\n\tprotected setAlphaNew( alpha: number ): void {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis._alphaPointerSprite.x = Math.max( 0, Math.min( 1, alpha ) ) * mainWidth;\n\t\tthis.onAlphaNew( alpha );\n\t}\n\n\tprotected onAlphaNew( alpha: number ): void {\n\t\tconst application = DApplications.getInstance();\n\t\tapplication.disallowUpdate();\n\t\tthis._sampleNewSprite.alpha = this._new.alpha = alpha;\n\t\tthis._inputAndLabelAlpha.input.value = Number( alpha.toFixed( 2 ) );\n\t\tthis.emit( \"newalphachange\", alpha, this );\n\t\tapplication.allowUpdate();\n\t\tapplication.update();\n\t}\n\n\tprotected onRecentChange(): void {\n\t\tconst sprites = this._recentColorSprites;\n\t\tconst recent = this._recent;\n\t\tfor( let i = 0, imax = sprites.length; i < imax; ++i ) {\n\t\t\tconst sprite = sprites[ i ];\n\t\t\tconst colorAndAlpha = recent.get( i );\n\t\t\tif( colorAndAlpha != null ) {\n\t\t\t\tsprite.tint = colorAndAlpha.color;\n\t\t\t\tsprite.alpha = colorAndAlpha.alpha;\n\t\t\t} else {\n\t\t\t\tsprite.tint = 0xffffff;\n\t\t\t\tsprite.alpha = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, Geometry, Mesh, Point, Rectangle, Shader, Texture, TextureUvs, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DPickerColorGradientDataLike } from \"./d-picker-color-gradient-data\";\n\nconst VERTEX_SHADER = `\nattribute vec2 aPosition;\nattribute vec2 aUv;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main(void) {\n\tvec3 position = vec3(aPosition.x, aPosition.y, 1.0);\n\tgl_Position = vec4((projectionMatrix * translationMatrix * position).xy, 0.0, 1.0);\n\tvUv = aUv;\n\tvColor = aColor;\n}\n`;\n\nconst FRAGMENT_SHADER = `\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\n\nvoid main(void) {\n\tvec4 texture = texture2D(uSampler, vUv);\n\tfloat cy = step( 1.0, mod( gl_FragCoord.y / 10.0, 2.0 ) );\n\tfloat cx = step( 1.0, mod( gl_FragCoord.x / 10.0 + cy, 2.0 ) );\n\tfloat c = mix( 0.75, 0.65, cx );\n\tgl_FragColor = texture * vec4( mix( vec3( c ), vColor.xyz, vColor.a ), 1.0 );\n}`;\n\ntype Parts = Array<{ data: DPickerColorGradientDataLike | null, rect: Rectangle }>;\n\nexport class DPickerColorGradientDataView extends Mesh {\n\tprotected _nPointsPerData: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _colors: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _lastHitIndex: number;\n\n\tprotected _workColor: number[];\n\tprotected _workPoint: Point;\n\n\tprotected _parts: Parts;\n\n\tprotected constructor(\n\t\tnPointsPerData: number,\n\t\tvertices: Float32Array, uvs: Float32Array, colors: Float32Array, indices: Uint16Array,\n\t\tparts: Parts, geometry: Geometry, shader: Shader\n\t) {\n\t\tsuper( geometry, shader );\n\n\t\tthis.interactive = true;\n\t\tthis.interactiveChildren = false;\n\t\tthis.cursor = \"pointer\";\n\n\t\tthis._nPointsPerData = nPointsPerData;\n\t\tthis._vertices = vertices;\n\t\tthis._uvs = uvs;\n\t\tthis._colors = colors;\n\t\tthis._indices = indices;\n\t\tthis._lastHitIndex = -1;\n\t\tthis._workColor = [ 0, 0, 0 ];\n\t\tthis._workPoint = new Point();\n\t\tthis._parts = parts;\n\n\t\tshader.uniforms.uSampler.on( \"update\", (): void => {\n\t\t\tthis.update();\n\t\t\tDApplications.update();\n\t\t});\n\t\tthis.update();\n\t}\n\n\tgetRectangle( index: number ): Rectangle | null {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\treturn parts[ index ].rect;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetRectangle( index: number, x: number, y: number, width: number, height: number ): void {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\tconst rect = parts[ index ].rect;\n\t\t\trect.x = x;\n\t\t\trect.y = y;\n\t\t\trect.width = width;\n\t\t\trect.height = height;\n\t\t}\n\t}\n\n\tgetData( index: number ): DPickerColorGradientDataLike | null {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\treturn parts[ index ].data;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetData( index: number, data: DPickerColorGradientDataLike | null ): void {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\tparts[ index ].data = data;\n\t\t}\n\t}\n\n\tgetLastHitIndex(): number {\n\t\treturn this._lastHitIndex;\n\t}\n\n\tprivate setColors( ic: number, colors: Float32Array, rgb: number[], alpha: number ) {\n\t\tcolors[ ic + 0 ] = rgb[ 0 ];\n\t\tcolors[ ic + 1 ] = rgb[ 1 ];\n\t\tcolors[ ic + 2 ] = rgb[ 2 ];\n\t\tcolors[ ic + 3 ] = alpha;\n\t\tcolors[ ic + 4 ] = rgb[ 0 ];\n\t\tcolors[ ic + 5 ] = rgb[ 1 ];\n\t\tcolors[ ic + 6 ] = rgb[ 2 ];\n\t\tcolors[ ic + 7 ] = alpha;\n\t}\n\n\tprivate setColorsHex( ic: number, colors: Float32Array, color: number, alpha: number ) {\n\t\tconst rgb = utils.hex2rgb( color, this._workColor );\n\t\tthis.setColors( ic, colors, rgb, alpha );\n\t}\n\n\tprivate setColorsWhite( ic: number, colors: Float32Array ) {\n\t\tconst rgb = this._workColor;\n\t\trgb[ 0 ] = 1;\n\t\trgb[ 1 ] = 1;\n\t\trgb[ 2 ] = 1;\n\t\tthis.setColors( ic, colors, rgb, 0 );\n\t}\n\n\tprivate setColorsPoint( ic: number, data: DPickerColorGradientDataLike, index: number, colors: Float32Array ) {\n\t\tconst point = data.points[ index ];\n\t\tif( point != null ) {\n\t\t\tthis.setColorsHex( ic, colors, point.color, point.alpha );\n\t\t} else {\n\t\t\tthis.setColorsWhite( ic, colors );\n\t\t}\n\t}\n\n\tprotected setVertices( iv: number, vertices: Float32Array, position: number, rect: Rectangle ) {\n\t\tconst y = rect.y + rect.height * position;\n\t\tvertices[ iv + 0 ] = rect.x;\n\t\tvertices[ iv + 1 ] = y;\n\t\tvertices[ iv + 2 ] = rect.x + rect.width;\n\t\tvertices[ iv + 3 ] = y;\n\t}\n\n\tprotected setUvs( iv: number, uvs: Float32Array, position: number, textureUvs: TextureUvs ) {\n\t\tconst x0 = textureUvs.x0 + (textureUvs.x3 - textureUvs.x0) * position;\n\t\tconst y0 = textureUvs.y0 + (textureUvs.y3 - textureUvs.y0) * position;\n\t\tconst x1 = textureUvs.x1 + (textureUvs.x2 - textureUvs.x1) * position;\n\t\tconst y1 = textureUvs.y1 + (textureUvs.y2 - textureUvs.y1) * position;\n\t\tuvs[ iv + 0 ] = x0;\n\t\tuvs[ iv + 1 ] = y0;\n\t\tuvs[ iv + 2 ] = x1;\n\t\tuvs[ iv + 3 ] = y1;\n\t}\n\n\tprivate newIndices( ii: number, iv: number, size: number, indices: Uint16Array ): Uint16Array {\n\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\tindices[ ii + 0 ] = iv + 0;\n\t\t\tindices[ ii + 1 ] = iv + 1;\n\t\t\tindices[ ii + 2 ] = iv + 2;\n\n\t\t\tindices[ ii + 3 ] = iv + 2;\n\t\t\tindices[ ii + 4 ] = iv + 1;\n\t\t\tindices[ ii + 5 ] = iv + 3;\n\n\t\t\tii += 6;\n\t\t\tiv += 2;\n\t\t}\n\t\treturn indices;\n\t}\n\n\tprotected _calculateBounds() {\n\t\tconst rect = this._parts[ 0 ].rect;\n\t\tconst bounds = this._bounds;\n\t\tconst work = this._workPoint;\n\t\twork.set( rect.x, rect.y );\n\t\tbounds.addPoint( work );\n\t\twork.set( rect.x + rect.width, rect.y + rect.height );\n\t\tbounds.addPoint( work );\n\t}\n\n\tupdate(): void {\n\t\tconst vertices = this._vertices;\n\t\tconst uvs = this._uvs;\n\t\tconst colors = this._colors;\n\t\tconst indices = this._indices;\n\n\t\tconst texture = this.shader.uniforms.uSampler;\n\t\tif( texture._uvs == null ) {\n\t\t\ttexture.updateUvs();\n\t\t}\n\t\tconst textureUvs: TextureUvs = texture._uvs;\n\n\t\tlet iv = 0;\n\t\tlet nv = 0;\n\t\tlet ic = 0;\n\t\tlet ii = 0;\n\n\t\tconst parts = this._parts;\n\t\tfor( let i = 0, imax = parts.length; i < imax; ++i ) {\n\t\t\tconst data = parts[ i ].data;\n\t\t\tconst rect = parts[ i ].rect;\n\t\t\tif( data == null ) {\n\t\t\t\tthis.setVertices( iv, vertices, 0, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 0, textureUvs );\n\t\t\t\tthis.setColorsWhite( ic, colors );\n\t\t\t\tthis.setVertices( iv + 4, vertices, 1, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 1, textureUvs );\n\t\t\t\tthis.setColorsWhite( ic + 8, colors );\n\t\t\t\tthis.newIndices( ii, nv, 1, indices );\n\t\t\t\tiv += 4 * 2;\n\t\t\t\tic += 4 * 4;\n\t\t\t\tnv += 4;\n\t\t\t\tii += 6;\n\t\t\t} else {\n\t\t\t\tthis.setVertices( iv, vertices, 0, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 0, textureUvs );\n\t\t\t\tthis.setColorsPoint( ic, data, 0, colors );\n\t\t\t\tiv += 2 * 2;\n\t\t\t\tic += 2 * 4;\n\t\t\t\tconst pointSize = data.points.length;\n\t\t\t\tfor( let j = 0, jmax = Math.min( pointSize, this._nPointsPerData ); j < jmax; ++j ) {\n\t\t\t\t\tconst point = data.points[ j ];\n\t\t\t\t\tthis.setVertices( iv, vertices, point.position, rect );\n\t\t\t\t\tthis.setUvs( iv, uvs, point.position, textureUvs );\n\t\t\t\t\tthis.setColorsHex( ic, colors, point.color, point.alpha );\n\t\t\t\t\tiv += 2 * 2;\n\t\t\t\t\tic += 2 * 4;\n\t\t\t\t}\n\t\t\t\tthis.setVertices( iv, vertices, 1, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 1, textureUvs );\n\t\t\t\tthis.setColorsPoint( ic, data, pointSize - 1, colors );\n\t\t\t\tiv += 2 * 2;\n\t\t\t\tic += 2 * 4;\n\n\t\t\t\tthis.newIndices( ii, nv, pointSize + 1, indices );\n\t\t\t\tii += (pointSize + 1) * 6;\n\t\t\t\tnv += (pointSize + 2) * 2;\n\t\t\t}\n\t\t}\n\n\t\tthis.size = ii;\n\n\t\tconst geometry = this.geometry;\n\t\tgeometry.getBuffer( \"aPosition\" ).update();\n\t\tgeometry.getBuffer( \"aUv\" ).update();\n\t\tgeometry.getBuffer( \"aColor\" ).update();\n\t\tgeometry.getIndex().update();\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\tconst local = this.toLocal( point, undefined, this._workPoint );\n\t\tconst parts = this._parts;\n\t\tfor( let i = 0, imax = parts.length; i < imax; ++i ) {\n\t\t\tconst rect = parts[ i ].rect;\n\t\t\tif( rect.contains( local.x, local.y ) ) {\n\t\t\t\tthis._lastHitIndex = i;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic from( size: number, nPointsPerData: number, texture: Texture = Texture.WHITE ) {\n\t\tconst vertices = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 2 );\n\t\tconst uvs = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 2 );\n\t\tconst colors = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 4 );\n\t\tconst indices = new Uint16Array( size * ( nPointsPerData + 1 ) * 6 );\n\n\t\tconst parts: Parts = [];\n\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\tparts.push({\n\t\t\t\tdata: null,\n\t\t\t\trect: new Rectangle()\n\t\t\t});\n\t\t}\n\n\t\tconst geometry = new Geometry()\n\t\t\t.addIndex( new Buffer( indices, false, true ) )\n\t\t\t.addAttribute( \"aPosition\", new Buffer( vertices, false, false ), 2 )\n\t\t\t.addAttribute( \"aUv\", new Buffer( uvs, false, false ), 2 )\n\t\t\t.addAttribute( \"aColor\", new Buffer( colors, false, false ), 4 );\n\t\tconst shader = Shader.from( VERTEX_SHADER, FRAGMENT_SHADER, { uSampler: texture } );\n\n\t\treturn new DPickerColorGradientDataView(\n\t\t\tnPointsPerData,\n\t\t\tvertices, uvs, colors, indices,\n\t\t\tparts, geometry, shader\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DPickerColorGradientDataLike } from \"./d-picker-color-gradient-data\";\n\nconst isEqual = ( a: DPickerColorGradientDataLike, b: DPickerColorGradientDataLike ) => {\n\tif( a.direction !== b.direction ) {\n\t\treturn false;\n\t}\n\n\tconst ap = a.points;\n\tconst bp = b.points;\n\tif( ap.length !== bp.length ) {\n\t\treturn false;\n\t}\n\n\tfor( let j = 0, jmax = ap.length; j < jmax; ++j ) {\n\t\tconst apj = ap[ j ];\n\t\tconst bpj = bp[ j ];\n\t\tif( apj.color !== bpj.color || apj.alpha !== bpj.alpha || apj.position !== bpj.position ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n};\n\nexport class DPickerColorGradientRecent extends utils.EventEmitter {\n\tprotected _recents: DPickerColorGradientDataLike[];\n\tprotected _capacity: number;\n\n\tconstructor( recents: DPickerColorGradientDataLike[], capacity: number ) {\n\t\tsuper();\n\n\t\tthis._recents = recents;\n\t\tthis._capacity = capacity;\n\t}\n\n\tgetCapacity(): number {\n\t\treturn this._capacity;\n\t}\n\n\tget( index: number ): DPickerColorGradientDataLike | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\treturn recents[ recents.length - 1 - index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, points: DPickerColorGradientDataLike ): DPickerColorGradientDataLike | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\tconst result = recents[ recents.length - 1 - index ];\n\t\t\trecents[ recents.length - 1 - index ] = points;\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontains( points: DPickerColorGradientDataLike ): boolean {\n\t\tconst recents = this._recents;\n\t\tfor( let i = 0, imax = recents.length; i < imax; ++i ) {\n\t\t\tif( isEqual( recents[ i ], points ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tadd( points: DPickerColorGradientDataLike ): this {\n\t\tconst recents = this._recents;\n\t\trecents.push( points );\n\t\tif( this._capacity < recents.length ) {\n\t\t\trecents.shift();\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n\n\tpop(): DPickerColorGradientDataLike | null {\n\t\tconst recents = this._recents;\n\t\tconst result = recents.shift();\n\t\tif( result != null ) {\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._recents.length;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Sprite, Texture } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DAlignWith } from \"./d-align-with\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DInputReal } from \"./d-input-real\";\nimport { DPickerColor } from \"./d-picker-color\";\nimport { DPickerColorGradientData, DPickerColorGradientDataLike } from \"./d-picker-color-gradient-data\";\nimport { DPickerColorGradientDataView } from \"./d-picker-color-gradient-data-view\";\nimport { DPickerColorGradientPoint } from \"./d-picker-color-gradient-point\";\nimport { DPickerColorGradientRecent } from \"./d-picker-color-gradient-recent\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DPickerColorGradientOptions<\n\tTHEME extends DThemePickerColorGradient = DThemePickerColorGradient\n> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerColorGradient extends DThemeBase {\n\tgetGradientPointsWidth(): number;\n\tgetGradientPointsMargin(): number;\n\n\tgetGradientAnchorTexture(): Texture;\n\tgetGradientAnchorOutlinedTexture(): Texture;\n\tgetGradientAnchorOutlineTexture(): Texture;\n\n\tgetGradientDirectionMargin(): number;\n\tgetGradientDirectionTexture(): Texture;\n\n\tgetGradientRecentColumn(): number;\n\tgetGradientRecentWidth(): number;\n\tgetGradientRecentMargin(): number;\n\tgetGradientRecentCount(): number;\n\tgetGradientRecents(): DPickerColorGradientDataLike[];\n}\n\nexport class DPickerColorGradient<\n\tTHEME extends DThemePickerColorGradient = DThemePickerColorGradient,\n\tOPTIONS extends DPickerColorGradientOptions<THEME> = DPickerColorGradientOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static RECENT_COLOR_GRADIENT: DPickerColorGradientRecent | null = null;\n\n\tprotected _picker!: DPickerColor;\n\tprotected _view!: DPickerColorGradientDataView;\n\tprotected _anchors!: Sprite[];\n\tprotected _recent!: DPickerColorGradientRecent;\n\n\tprotected _onAnchorDownBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAnchorMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAnchorUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _data!: DPickerColorGradientData;\n\tprotected _work!: Point;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tconst theme = this.theme;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tthis._work = new Point();\n\n\t\t// Picker\n\t\tconst gradientPointsWidth = theme.getGradientPointsWidth();\n\t\tconst gradientPointsMargin = theme.getGradientPointsMargin();\n\t\tconst picker = this._picker = new DPickerColor({\n\t\t\tx: paddingLeft + gradientPointsWidth + gradientPointsMargin,\n\t\t\ty: paddingTop\n\t\t});\n\t\tpicker.on( \"newcolorchange\", ( color: number ): void => {\n\t\t\tthis.onAnchorColorChange( color );\n\t\t});\n\t\tpicker.on( \"newalphachange\", ( alpha: number ): void => {\n\t\t\tthis.onAnchorAlphaChange( alpha );\n\t\t});\n\t\tthis.addChild( picker );\n\n\t\t// Points view\n\t\tconst view = this._view = DPickerColorGradientDataView.from( 17, 10 );\n\t\tview.setRectangle( 0, paddingLeft, paddingTop, gradientPointsWidth, picker.height );\n\t\tthis.addChild( view );\n\t\tview.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( view.getLastHitIndex() === 0 ) {\n\t\t\t\tthis.onViewDown( e );\n\t\t\t}\n\t\t});\n\n\t\t// Anchor\n\t\tthis._onAnchorDownBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorDown( e );\n\t\t};\n\t\tthis._onAnchorMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorMove( e );\n\t\t};\n\t\tthis._onAnchorUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorUp( e );\n\t\t};\n\t\tthis._anchors = [];\n\n\t\t//\n\t\tconst inputLabelWidth = picker.theme.getInputLabelWidth();\n\t\tconst inputWidth = picker.theme.getMainWidth() * 0.5;\n\t\tconst inputMargin = 5;\n\t\tconst inputDirectionMargin = theme.getGradientDirectionMargin();\n\t\tconst inputDirectionTexture = theme.getGradientDirectionTexture();\n\t\tconst inputLeft = picker.x + picker.width + inputDirectionMargin;\n\t\tconst inputDirection = new DInputReal({\n\t\t\tparent: this,\n\t\t\tx: inputLeft + inputLabelWidth + inputMargin,\n\t\t\ty: paddingTop,\n\t\t\twidth: inputWidth - inputLabelWidth - inputMargin,\n\t\t\tstep: 1,\n\t\t\timage: {\n\t\t\t\tsource: inputDirectionTexture,\n\t\t\t\talign: {\n\t\t\t\t\twith: DAlignWith.BORDER\n\t\t\t\t},\n\t\t\t\tmargin: {\n\t\t\t\t\thorizontal: -inputDirectionTexture.width - inputMargin\n\t\t\t\t}\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tchange: ( value: number ) => {\n\t\t\t\t\t(this._data as any)._direction = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Recent gradients\n\t\tconst recentColumn = theme.getGradientRecentColumn();\n\t\tconst recentWidth = theme.getGradientRecentWidth();\n\t\tconst recentMargin = theme.getGradientRecentMargin();\n\t\tconst recentWidthAndMargin = recentWidth + recentMargin;\n\t\tconst x0 = inputLeft;\n\t\tconst y0 = inputDirection.y + inputDirection.height + inputDirectionMargin;\n\t\tif( DPickerColorGradient.RECENT_COLOR_GRADIENT == null ) {\n\t\t\tDPickerColorGradient.RECENT_COLOR_GRADIENT = new DPickerColorGradientRecent(\n\t\t\t\ttheme.getGradientRecents(),\n\t\t\t\ttheme.getGradientRecentCount()\n\t\t\t);\n\t\t}\n\t\tthis._recent = DPickerColorGradient.RECENT_COLOR_GRADIENT;\n\t\tconst recent = this._recent;\n\t\tfor( let i = 0, imax = recent.getCapacity(); i < imax; ++i ) {\n\t\t\tconst ix = i % recentColumn;\n\t\t\tconst x = x0 + ix * recentWidthAndMargin;\n\t\t\tconst iy = (i / recentColumn) | 0;\n\t\t\tconst y = y0 + iy * recentWidthAndMargin;\n\t\t\tview.setRectangle( 1 + i, x, y, recentWidth, recentWidth );\n\t\t}\n\t\trecent.on( \"change\", (): void => {\n\t\t\tthis.onRecentUpdate();\n\t\t});\n\t\tUtilPointerEvent.onClick( view, ( e: InteractionEvent ): void => {\n\t\t\tconst lastHitIndex = view.getLastHitIndex();\n\t\t\tif( 1 <= lastHitIndex ) {\n\t\t\t\tthis.onRecentClick( view.getData( lastHitIndex ) );\n\t\t\t}\n\t\t});\n\n\t\t// Points\n\t\tconst data = this._data = new DPickerColorGradientData();\n\t\tdata.on( \"change\", (): void => {\n\t\t\tthis.updateAnchors();\n\t\t\tview.update();\n\t\t});\n\t\tdata.on( \"selectionchange\", ( point: DPickerColorGradientPoint ): void => {\n\t\t\tthis.onAnchorSelect( point );\n\t\t});\n\t\tdata.on( \"directionchange\", ( value: number ): void => {\n\t\t\tinputDirection.value = value;\n\t\t});\n\t\tview.setData( 0, data );\n\t\tview.update();\n\t\tinputDirection.value = data.direction;\n\t\tthis.updateAnchors();\n\t\tconst selected = data.selected;\n\t\tif( selected != null ) {\n\t\t\tthis.onAnchorSelect( selected );\n\t\t}\n\n\t\t// Width\n\t\tif( options == null || options.width == null ) {\n\t\t\tthis.width = paddingLeft + gradientPointsWidth + gradientPointsMargin +\n\t\t\t\tpicker.width + inputDirectionMargin + (recentColumn - 1) * recentMargin +\n\t\t\t\trecentColumn * recentWidth + paddingRight;\n\t\t}\n\n\t\t// Height\n\t\tif( options == null || options.height == null ) {\n\t\t\tthis.height = paddingTop + picker.height + paddingBottom;\n\t\t}\n\t}\n\n\tget data(): DPickerColorGradientData {\n\t\treturn this._data;\n\t}\n\n\tget recent() {\n\t\treturn this._recent;\n\t}\n\n\tprotected onRecentClick( recentData: DPickerColorGradientDataLike | null ) {\n\t\tconst data = this._data;\n\t\tif( recentData != null ) {\n\t\t\tdata.fromObject( recentData );\n\t\t} else {\n\t\t\tdata.reset();\n\t\t}\n\t}\n\n\tprotected onRecentUpdate() {\n\t\tconst recent = this._recent;\n\t\tconst view = this._view;\n\t\tfor( let i = 0, imax = recent.size(); i < imax; ++i ) {\n\t\t\tview.setData( 1 + i, recent.get( i ) );\n\t\t}\n\t\tview.update();\n\t\tDApplications.update();\n\t}\n\n\tprotected toAnchorPosition( e: InteractionEvent ) {\n\t\tconst local = this.toLocal( e.data.global, undefined, this._work );\n\t\treturn Math.max( 0, Math.min( 1, (local.y - this.padding.getTop()) / this._picker.height ) );\n\t}\n\n\tprotected onViewDown( e: InteractionEvent ) {\n\t\tthis._data.addAt( this.toAnchorPosition( e ) );\n\t\tthis.onAnchorDragStart();\n\t}\n\n\tprotected onAnchorDown( e: InteractionEvent ) {\n\t\tconst target = e.target;\n\t\tif( target instanceof Sprite ) {\n\t\t\tconst data = this._data;\n\t\t\tconst index = this._anchors.indexOf( target );\n\t\t\tif( 0 <= index && index < data.points.length ) {\n\t\t\t\tdata.points[ index ].selected = true;\n\t\t\t\tthis.onAnchorDragStart();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorSelect( point: DPickerColorGradientPoint ) {\n\t\tconst picker = this._picker;\n\t\tpicker.current.color = point.color;\n\t\tpicker.current.alpha = point.alpha;\n\t\tpicker.new.color = point.color;\n\t\tpicker.new.alpha = point.alpha;\n\t}\n\n\tprotected onAnchorColorChange( color: number ) {\n\t\tconst points = this._data;\n\t\tif( points != null ) {\n\t\t\tconst selected = points.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.color = color;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorAlphaChange( alpha: number ) {\n\t\tconst points = this._data;\n\t\tif( points != null ) {\n\t\t\tconst selected = points.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.alpha = alpha;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorDragStart() {\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.on( UtilPointerEvent.move, this._onAnchorMoveBound );\n\t\tstage.on( UtilPointerEvent.up, this._onAnchorUpBound );\n\t}\n\n\tprotected onAnchorMove( e: InteractionEvent ): void {\n\t\tconst points = this._data;\n\t\tif( points != null ) {\n\t\t\tconst selected = points.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.position = this.toAnchorPosition( e );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorUp( e: InteractionEvent ): void {\n\t\tconst stage = DApplications.getInstance().stage;\n\t\tstage.off( UtilPointerEvent.move, this._onAnchorMoveBound );\n\t\tstage.off( UtilPointerEvent.up, this._onAnchorUpBound );\n\t}\n\n\tprotected updateAnchors() {\n\t\tconst theme = this.theme;\n\t\tconst anchorTexture = theme.getGradientAnchorTexture();\n\t\tconst anchorOutlinedTexture = theme.getGradientAnchorOutlinedTexture();\n\t\tconst gradientPointsWidth = theme.getGradientPointsWidth();\n\n\t\tconst data = this._data;\n\t\tconst pointSize = data.points.length;\n\n\t\tconst anchors = this._anchors;\n\t\tconst anchorSize = anchors.length;\n\t\tfor( let i = anchorSize; i < pointSize; ++i ) {\n\t\t\tconst newAnchor = new Sprite( anchorTexture );\n\t\t\tnewAnchor.anchor.set( 0.5, 0.5 );\n\t\t\tnewAnchor.cursor = \"pointer\";\n\t\t\tnewAnchor.interactive = true;\n\t\t\tnewAnchor.on( UtilPointerEvent.down, this._onAnchorDownBound );\n\t\t\tanchors.push( newAnchor );\n\t\t\tthis.addChild( newAnchor );\n\t\t}\n\n\t\tfor( let i = anchorSize - 1; pointSize <= i; --i ) {\n\t\t\tconst oldAnchor = anchors[ i ];\n\t\t\toldAnchor.off( UtilPointerEvent.down, this._onAnchorDownBound );\n\t\t\toldAnchor.destroy();\n\t\t}\n\t\tanchors.length = pointSize;\n\n\t\tconst y = this.padding.getTop();\n\t\tconst right = this.padding.getLeft() + gradientPointsWidth;\n\t\tconst height = this._picker.height;\n\t\tfor( let i = 0; i < pointSize; ++i ) {\n\t\t\tconst point = data.points[ i ];\n\t\t\tconst anchor = anchors[ i ];\n\t\t\tanchor.tint = point.color;\n\t\t\tanchor.position.set(\n\t\t\t\tright,\n\t\t\t\ty + height * point.position\n\t\t\t);\n\t\t\tanchor.texture = (point.selected ? anchorOutlinedTexture : anchorTexture);\n\t\t}\n\n\t\tDApplications.update();\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isDeleteKey( e ) ) {\n\t\t\tconst points = this._data;\n\t\t\tif( points != null ) {\n\t\t\t\tconst selected = points.selected;\n\t\t\t\tif( selected != null ) {\n\t\t\t\t\tpoints.remove( selected );\n\t\t\t\t\tsuper.onKeyDown( e );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerColorGradient, DPickerColorGradientOptions } from \"./d-picker-color-gradient\";\nimport { DPickerColorGradientData } from \"./d-picker-color-gradient-data\";\nimport { DPickerColorGradientRecent } from \"./d-picker-color-gradient-recent\";\n\nexport interface DDialogColorGradientOptions<\n\tTHEME extends DThemeDialogColorGradient = DThemeDialogColorGradient\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerColorGradientOptions;\n}\n\nexport interface DThemeDialogColorGradient extends DThemeDialogCommand {\n\n}\n\nexport class DDialogColorGradient<\n\tTHEME extends DThemeDialogColorGradient = DThemeDialogColorGradient,\n\tOPTIONS extends DDialogColorGradientOptions<THEME> = DDialogColorGradientOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerColorGradient;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerColorGradient( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\n\t\tthis.on( \"ok\", (): void => {\n\t\t\tconst data = picker.data;\n\t\t\tconst recent = picker.recent;\n\t\t\tif( ! recent.contains( data ) ) {\n\t\t\t\trecent.add( data.toObject() );\n\t\t\t}\n\t\t});\n\t}\n\n\tget data(): DPickerColorGradientData {\n\t\treturn this._picker.data;\n\t}\n\n\tget recent(): DPickerColorGradientRecent {\n\t\treturn this._picker.recent;\n\t}\n\n\tget picker(): DPickerColorGradient {\n\t\treturn this._picker;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tthis._picker.onKeyDown( e );\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogColorGradient, DDialogColorGradientOptions } from \"./d-dialog-color-gradient\";\nimport { DPickerColorGradientData } from \"./d-picker-color-gradient-data\";\nimport { DPickerColorGradientDataView } from \"./d-picker-color-gradient-data-view\";\n\nexport interface DButtonColorGradientOptions<\n\tTHEME extends DThemeButtonColorGradient = DThemeButtonColorGradient\n> extends DButtonOptions<DPickerColorGradientData, THEME> {\n\tdialog?: DDialogColorGradientOptions;\n}\n\nexport interface DThemeButtonColorGradient extends DThemeButton {\n\tgetViewBaseTexture(): Texture | null;\n\tgetTextFormatter(): ( value: DPickerColorGradientData, caller: DButtonColorGradient ) => string;\n\tgetTextValue( state: DBaseState ): DPickerColorGradientData;\n\tnewTextValue(): DPickerColorGradientData;\n}\n\nexport class DButtonColorGradient<\n\tTHEME extends DThemeButtonColorGradient = DThemeButtonColorGradient,\n\tOPTIONS extends DButtonColorGradientOptions<THEME> = DButtonColorGradientOptions<THEME>\n> extends DButton<DPickerColorGradientData, THEME, OPTIONS> {\n\tprotected static DIALOG?: DDialogColorGradient;\n\tprotected _dialog?: DDialogColorGradient;\n\tprotected _dialogOptions?: DDialogColorGradientOptions;\n\tprotected _view?: DPickerColorGradientDataView;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst data = this._textValueComputed;\n\t\tthis._dialogOptions = options && options.dialog;\n\n\t\tif( options == null || options.image == null || options.image.source === undefined ) {\n\t\t\tconst texture = this.theme.getViewBaseTexture();\n\t\t\tif( texture instanceof Texture ) {\n\t\t\t\tconst view = this._view = DPickerColorGradientDataView.from( 1, 10, texture );\n\t\t\t\tview.setRectangle( 0, 0, 0, texture.width, texture.height );\n\t\t\t\tview.setData( 0, data );\n\t\t\t\tview.update();\n\t\t\t\tthis.image = view;\n\t\t\t}\n\t\t}\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.data.fromObject( data );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tdata.fromObject( dialog.data );\n\t\t\t\tconst view = this._view;\n\t\t\t\tif( view != null ) {\n\t\t\t\t\tview.update();\n\t\t\t\t}\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tget dialog(): DDialogColorGradient {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogColorGradient( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tif( DButtonColorGradient.DIALOG == null ) {\n\t\t\t\t\tDButtonColorGradient.DIALOG = new DDialogColorGradient();\n\t\t\t\t}\n\t\t\t\tdialog = DButtonColorGradient.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): DPickerColorGradientData {\n\t\treturn this._textValueComputed;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerColor, DPickerColorOptions } from \"./d-picker-color\";\nimport { DPickerColorRecent } from \"./d-picker-color-recent\";\n\nexport interface DDialogColorOptions<\n\tTHEME extends DThemeDialogColor = DThemeDialogColor\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerColorOptions;\n}\n\nexport interface DThemeDialogColor extends DThemeDialogCommand {\n\n}\n\nexport class DDialogColor<\n\tTHEME extends DThemeDialogColor = DThemeDialogColor,\n\tOPTIONS extends DDialogColorOptions<THEME> = DDialogColorOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerColor;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerColor( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\n\t\tthis.on( \"ok\", (): void => {\n\t\t\tconst recent = picker.recent;\n\t\t\tif( ! recent.contains( picker.new ) ) {\n\t\t\t\trecent.add( picker.new );\n\t\t\t}\n\t\t});\n\t}\n\n\tget current(): DColorAndAlpha {\n\t\treturn this._picker.current;\n\t}\n\n\tget new(): DColorAndAlpha {\n\t\treturn this._picker.new;\n\t}\n\n\tget recent(): DPickerColorRecent {\n\t\treturn this._picker.recent;\n\t}\n\n\tget picker(): DPickerColor {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DDialogColor, DDialogColorOptions } from \"./d-dialog-color\";\nimport { DPickerColorAndAlpha } from \"./d-picker-color-and-alpha\";\n\nexport interface DButtonColorOptions<\n\tTHEME extends DThemeButtonColor = DThemeButtonColor\n> extends DButtonOptions<DColorAndAlpha, THEME> {\n\tdialog?: DDialogColorOptions;\n}\n\nexport interface DThemeButtonColor extends DThemeButton {\n\tgetTextFormatter(): ( value: DColorAndAlpha, caller: DButtonColor ) => string;\n\tgetTextValue( state: DBaseState ): DColorAndAlpha;\n\tnewTextValue(): DColorAndAlpha;\n}\n\nexport class DButtonColor<\n\tTHEME extends DThemeButtonColor = DThemeButtonColor,\n\tOPTIONS extends DButtonColorOptions<THEME> = DButtonColorOptions<THEME>\n> extends DButton<DColorAndAlpha, THEME, OPTIONS> {\n\tprotected static DIALOG?: DDialogColor;\n\tprotected _dialog?: DDialogColor;\n\tprotected _dialogOptions!: DDialogColorOptions | undefined;\n\tprotected _value!: DPickerColorAndAlpha;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst colorAndAlpha = this._textValueComputed;\n\t\tthis._dialogOptions = options && options.dialog;\n\t\tthis._value = new DPickerColorAndAlpha( colorAndAlpha, ( color: number ): void => {\n\t\t\tcolorAndAlpha.color = color;\n\t\t\tthis.onColorChange();\n\t\t}, ( alpha: number ): void => {\n\t\t\tcolorAndAlpha.alpha = alpha;\n\t\t\tthis.updateTextForcibly();\n\t\t});\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current.color = colorAndAlpha.color;\n\t\t\tdialog.current.alpha = colorAndAlpha.alpha;\n\t\t\tdialog.new.color = colorAndAlpha.color;\n\t\t\tdialog.new.alpha = colorAndAlpha.alpha;\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dialogNew, dialogCurrent, this );\n\t\t\t\tcolorAndAlpha.color = dialogNew.color;\n\t\t\t\tcolorAndAlpha.alpha = dialogNew.alpha;\n\t\t\t\tthis.onColorChange();\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tprotected getImageTintColor( theme: THEME, state: DBaseState ): number | null {\n\t\treturn this._textValueComputed.color;\n\t}\n\n\tprotected onColorChange(): void {\n\t\tconst image = this._image;\n\t\tif( this.isTintAware( image ) ) {\n\t\t\timage.tint = this._textValueComputed.color;\n\t\t}\n\t\tthis.updateTextForcibly();\n\t}\n\n\tprotected updateTextForcibly(): void {\n\t\tthis.onTextChange();\n\t\tthis.createOrUpdateText();\n\t}\n\n\tget dialog(): DDialogColor {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogColor( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tif( DButtonColor.DIALOG == null ) {\n\t\t\t\t\tDButtonColor.DIALOG = new DDialogColor();\n\t\t\t\t}\n\t\t\t\tdialog = DButtonColor.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): DColorAndAlpha {\n\t\treturn this._value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonDanger extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonDanger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonBackOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonBack = DThemePickerDatetimeButtonBack\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonBack extends DThemeButtonAmbient {\n\n}\n\nexport class DPickerDatetimeButtonBack<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonBack = DThemePickerDatetimeButtonBack,\n\tOPTIONS extends DPickerDatetimeButtonBackOptions<VALUE, THEME> = DPickerDatetimeButtonBackOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonBack\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonDateOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonDate = DThemePickerDatetimeButtonDate\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonDate extends DThemeButtonAmbient {\n\n}\n\nexport class DPickerDatetimeButtonDate<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonDate = DThemePickerDatetimeButtonDate,\n\tOPTIONS extends DPickerDatetimeButtonDateOptions<VALUE, THEME> = DPickerDatetimeButtonDateOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected onToggleStart(): void {\n\t\tif( ! this.isActive() ) {\n\t\t\tthis.setActive( true );\n\t\t}\n\t}\n\n\tprotected onToggleEnd(): void {\n\t\tthis.emit( this.isActive() ? \"active\" : \"inactive\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonNextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonNext = DThemePickerDatetimeButtonNext\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonNext extends DThemeButtonAmbient {\n\n}\n\nexport class DPickerDatetimeButtonNext<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonNext = DThemePickerDatetimeButtonNext,\n\tOPTIONS extends DPickerDatetimeButtonNextOptions<VALUE, THEME> = DPickerDatetimeButtonNextOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonNext\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DPickerDatetimeLabelOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabel = DThemePickerDatetimeLabel\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeLabel extends DThemeText {\n\n}\n\nexport class DPickerDatetimeLabel<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabel = DThemePickerDatetimeLabel,\n\tOPTIONS extends DPickerDatetimeLabelOptions<VALUE, THEME> = DPickerDatetimeLabelOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DPickerDatetimeLabelDateOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabelDate = DThemePickerDatetimeLabelDate\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeLabelDate extends DThemeText {\n\n}\n\nexport class DPickerDatetimeLabelDate<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabelDate = DThemePickerDatetimeLabelDate,\n\tOPTIONS extends DPickerDatetimeLabelDateOptions<VALUE, THEME> = DPickerDatetimeLabelDateOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeLabelDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport interface DPickerDatetimeSpaceOptions<\n\tTHEME extends DThemePickerDatetimeSpace = DThemePickerDatetimeSpace\n> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerDatetimeSpace extends DThemeBase {\n\n}\n\nexport class DPickerDatetimeSpace<\n\tTHEME extends DThemePickerDatetimeSpace = DThemePickerDatetimeSpace,\n\tOPTIONS extends DPickerDatetimeSpaceOptions<THEME> = DPickerDatetimeSpaceOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t\tthis.renderable = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputNumber, DInputNumberOptions, DThemeInputNumber } from \"./d-input-number\";\n\nexport interface DInputIntegerOptions<\n\tTHEME extends DThemeInputInteger = DThemeInputInteger\n> extends DInputNumberOptions<THEME> {\n\n}\n\nexport interface DThemeInputInteger extends DThemeInputNumber {\n}\n\nexport class DInputInteger<\n\tTHEME extends DThemeInputInteger = DThemeInputInteger,\n\tOPTIONS extends DInputIntegerOptions<THEME> = DInputIntegerOptions<THEME>\n> extends DInputNumber<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputInteger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport type DPickerTimeBoundDate = Date | null;\n\nexport interface DPickerTimeBoundOptions {\n\tdate?: DPickerTimeBoundDate;\n\tinclusive?: boolean;\n}\n\nexport class DPickerTimeBound {\n\tprotected _date: DPickerTimeBoundDate;\n\tprotected _inclusive: boolean;\n\tprotected _onChange: () => void;\n\n\tconstructor( options: DPickerTimeBoundOptions | undefined, onChange: () => void ) {\n\t\tthis._date = ( options && options.date !== undefined ? options.date : null );\n\t\tthis._inclusive = ( options && options.inclusive !== undefined ? options.inclusive : false );\n\t\tthis._onChange = onChange;\n\t}\n\n\tget date(): DPickerTimeBoundDate {\n\t\treturn this._date;\n\t}\n\n\tset date( date: DPickerTimeBoundDate ) {\n\t\tif( this._date !== date ) {\n\t\t\tthis._date = date;\n\t\t\tthis._onChange();\n\t\t}\n\t}\n\n\tget inclusive(): boolean {\n\t\treturn this._inclusive;\n\t}\n\n\tset inclusive( inclusive: boolean ) {\n\t\tif( this._inclusive !== inclusive ) {\n\t\t\tthis._inclusive = inclusive;\n\t\t\tthis._onChange();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundHoursParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundHours {\n\tprotected _parent: DPickerTimeBoundHoursParent;\n\n\tconstructor( parent: DPickerTimeBoundHoursParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst lowerDateHours = lowerDate.getHours();\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn lowerDateHours;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( lowerDate.getSeconds() < constant.second.max ) {\n\t\t\t\t\t\treturn lowerDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\tif( lowerDate.getMinutes() < constant.minute.max ) {\n\t\t\t\t\t\treturn lowerDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn lowerDateHours + 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.hour.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst upperDateHours = upperDate.getHours();\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn upperDateHours;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( constant.second.min < upperDate.getSeconds() ) {\n\t\t\t\t\t\treturn upperDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\tif( constant.minute.min < upperDate.getMinutes() ) {\n\t\t\t\t\t\treturn upperDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn upperDateHours - 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.hour.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundMinutesParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundMinutes {\n\tprotected _parent: DPickerTimeBoundMinutesParent;\n\n\tconstructor( parent: DPickerTimeBoundMinutesParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( lowerDate.getHours() < date.getHours() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst lowerDateMinutes = lowerDate.getMinutes();\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn lowerDateMinutes;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( lowerDate.getSeconds() < constant.second.max ) {\n\t\t\t\t\t\treturn lowerDateMinutes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn lowerDateMinutes + 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.minute.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( date.getHours() < upperDate.getHours() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst upperDateMinutes = upperDate.getMinutes();\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn upperDateMinutes;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( constant.second.min < upperDate.getSeconds() ) {\n\t\t\t\t\t\treturn upperDateMinutes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn upperDateMinutes - 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.minute.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundSecondsParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundSeconds {\n\tprotected _parent: DPickerTimeBoundSecondsParent;\n\n\tconstructor( parent: DPickerTimeBoundSecondsParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( lowerDate.getHours() < date.getHours() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\tif( lowerDate.getMinutes() < date.getMinutes() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn lowerDate.getSeconds() + ( lower.inclusive ? 0 : 1 );\n\t\t}\n\t\treturn constant.second.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( date.getHours() < upperDate.getHours() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\tif( date.getMinutes() < upperDate.getMinutes() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn upperDate.getSeconds() - ( upper.inclusive ? 0 : 1 );\n\t\t}\n\t\treturn constant.second.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound, DPickerTimeBoundOptions } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\nimport { DPickerTimeBoundHours } from \"./d-picker-time-bound-hours\";\nimport { DPickerTimeBoundMinutes } from \"./d-picker-time-bound-minutes\";\nimport { DPickerTimeBoundSeconds } from \"./d-picker-time-bound-seconds\";\n\nexport interface DPickerTimeBoundsOptions {\n\tlower?: DPickerTimeBoundOptions;\n\tupper?: DPickerTimeBoundOptions;\n}\n\nexport class DPickerTimeBounds {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\thours: DPickerTimeBoundHours;\n\tminutes: DPickerTimeBoundMinutes;\n\tseconds: DPickerTimeBoundSeconds;\n\tconstant: DPickerTimeBoundConstant;\n\n\tconstructor( options: DPickerTimeBoundsOptions | undefined, onChange: () => void ) {\n\t\tthis.constant = this.newConstant();\n\t\tthis.lower = new DPickerTimeBound( options && options.lower, onChange );\n\t\tthis.upper = new DPickerTimeBound( options && options.upper, onChange );\n\t\tthis.mask = DPickerDatetimeMask.ALL;\n\t\tthis.hours = new DPickerTimeBoundHours( this );\n\t\tthis.minutes = new DPickerTimeBoundMinutes( this );\n\t\tthis.seconds = new DPickerTimeBoundSeconds( this );\n\t}\n\n\tnewConstant(): DPickerTimeBoundConstant {\n\t\treturn {\n\t\t\tsecond: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 59\n\t\t\t},\n\n\t\t\tminute: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 59\n\t\t\t},\n\n\t\t\thour: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 23\n\t\t\t}\n\t\t};\n\t}\n\n\tadjust( date: Date ): boolean {\n\t\tconst result = this.test( date );\n\t\tif( result < 0 ) {\n\t\t\tconst lower = this.lower;\n\t\t\tconst lowerDate = lower.date;\n\t\t\tif( lowerDate ) {\n\t\t\t\tdate.setTime( lowerDate.getTime() );\n\t\t\t\tif( ! lower.inclusive ) {\n\t\t\t\t\tconst mask = this.mask;\n\t\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\t\tdate.setSeconds( lowerDate.getSeconds() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\t\tdate.setMinutes( lowerDate.getMinutes() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\t\t\tdate.setHours( lowerDate.getHours() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\t\t\tdate.setDate( lowerDate.getDate() + 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else if( 0 < result ) {\n\t\t\tconst upper = this.upper;\n\t\t\tconst upperDate = upper.date;\n\t\t\tif( upperDate ) {\n\t\t\t\tdate.setTime( upperDate.getTime() );\n\t\t\t\tif( ! upper.inclusive ) {\n\t\t\t\t\tconst mask = this.mask;\n\t\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\t\tdate.setSeconds( upperDate.getSeconds() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\t\tdate.setMinutes( upperDate.getMinutes() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\t\t\tdate.setHours( upperDate.getHours() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\t\t\tdate.setDate( upperDate.getDate() - 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tcompare( a: Date, b: Date ): number {\n\t\tconst mask = this.mask;\n\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\tconst ay = a.getFullYear();\n\t\t\tconst by = b.getFullYear();\n\t\t\tif( ay !== by ) {\n\t\t\t\treturn ( ay < by ? -1 : +1 );\n\t\t\t}\n\n\t\t\tconst am = a.getMonth();\n\t\t\tconst bm = b.getMonth();\n\t\t\tif( am !== bm ) {\n\t\t\t\treturn ( am < bm ? -1 : +1 );\n\t\t\t}\n\n\t\t\tconst ad = a.getDate();\n\t\t\tconst bd = b.getDate();\n\t\t\tif( ad !== bd ) {\n\t\t\t\treturn ( ad < bd ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\tconst ah = a.getHours();\n\t\t\tconst bh = b.getHours();\n\t\t\tif( ah !== bh ) {\n\t\t\t\treturn ( ah < bh ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\tconst am = a.getMinutes();\n\t\t\tconst bm = b.getMinutes();\n\t\t\tif( am !== bm ) {\n\t\t\t\treturn ( am < bm ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\tconst ad = a.getSeconds();\n\t\t\tconst bd = b.getSeconds();\n\t\t\tif( ad !== bd ) {\n\t\t\t\treturn ( ad < bd ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\ttest( date: Date ): number {\n\t\t// Lower bound\n\t\tconst lower = this.lower;\n\t\tconst lowerDate = lower.date;\n\t\tif( lowerDate != null ) {\n\t\t\tconst result = this.compare( lowerDate, date );\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn ( result <= 0 ? 0 : -1 );\n\t\t\t} else {\n\t\t\t\treturn ( result < 0 ? 0 : -1 );\n\t\t\t}\n\t\t}\n\n\t\t// Upper bound\n\t\tconst upper = this.upper;\n\t\tconst upperDate = upper.date;\n\t\tif( upperDate != null ) {\n\t\t\tconst result = this.compare( date, upperDate );\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn ( result <= 0 ? 0 : +1 );\n\t\t\t} else {\n\t\t\t\treturn ( result < 0 ? 0 : +1 );\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tcontains( date: Date ): boolean {\n\t\treturn this.test( date ) === 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DCoordinate } from \"./d-coordinate\";\nimport { DInputInteger, DInputIntegerOptions } from \"./d-input-integer\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBoundDate, DPickerTimeBoundOptions } from \"./d-picker-time-bound\";\nimport { DPickerTimeBounds, DPickerTimeBoundsOptions } from \"./d-picker-time-bounds\";\nimport { DText } from \"./d-text\";\n\nexport interface DPickerTimeOptions<THEME extends DThemePickerTime = DThemePickerTime> extends DBaseOptions<THEME> {\n\tmargin?: number;\n\thours?: DInputIntegerOptions;\n\tminutes?: DInputIntegerOptions;\n\tseconds?: DInputIntegerOptions;\n\tmask?: DPickerDatetimeMask;\n\tbounds?: DPickerTimeBoundsOptions;\n}\n\nexport interface DThemePickerTime extends DThemeBase {\n\tgetMargin(): number;\n\tgetHoursOptions(): DInputIntegerOptions;\n\tgetMinutesOptions(): DInputIntegerOptions;\n\tgetSecondsOptions(): DInputIntegerOptions;\n\tgetMask(): DPickerDatetimeMask;\n\tgetLowerBound(): DPickerTimeBoundDate;\n\tisLowerBoundInclusive(): boolean;\n\tgetUpperBound(): DPickerTimeBoundDate;\n\tisUpperBoundInclusive(): boolean;\n}\n\nconst toBoundOptions = (\n\toptions: DPickerTimeBoundOptions | undefined,\n\tdate: DPickerTimeBoundDate,\n\tinclusive: boolean\n): DPickerTimeBoundOptions => {\n\tif( options ) {\n\t\treturn {\n\t\t\tdate: ( options.date !== undefined ? options.date : date ),\n\t\t\tinclusive: ( options.inclusive !== undefined ? options.inclusive : inclusive )\n\t\t};\n\t}\n\treturn {\n\t\tdate,\n\t\tinclusive\n\t};\n};\n\nconst toBoundsOptions = (\n\ttheme: DThemePickerTime,\n\toptions: DPickerTimeBoundsOptions | undefined\n): DPickerTimeBoundsOptions => {\n\tif( options ) {\n\t\treturn {\n\t\t\tlower: toBoundOptions(\n\t\t\t\toptions.lower,\n\t\t\t\ttheme.getLowerBound(),\n\t\t\t\ttheme.isLowerBoundInclusive()\n\t\t\t),\n\t\t\tupper: toBoundOptions(\n\t\t\t\toptions.upper,\n\t\t\t\ttheme.getUpperBound(),\n\t\t\t\ttheme.isUpperBoundInclusive()\n\t\t\t)\n\t\t};\n\t}\n\treturn {\n\t\tlower: {\n\t\t\tdate: theme.getLowerBound(),\n\t\t\tinclusive: theme.isLowerBoundInclusive()\n\t\t},\n\t\tupper: {\n\t\t\tdate: theme.getUpperBound(),\n\t\t\tinclusive: theme.isUpperBoundInclusive()\n\t\t}\n\t};\n};\n\nexport class DPickerTime<\n\tTHEME extends DThemePickerTime = DThemePickerTime,\n\tOPTIONS extends DPickerTimeOptions<THEME> = DPickerTimeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _dateBounds!: DPickerTimeBounds;\n\tprotected _dateCurrent!: Date;\n\tprotected _dateNew!: Date;\n\tprotected _inputHours!: DInputInteger | null;\n\tprotected _inputMinutes!: DInputInteger | null;\n\tprotected _inputSeconds!: DInputInteger | null;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tconst theme = this.theme;\n\t\tthis._dateCurrent = new Date();\n\t\tconst dateCurrentTime = this._dateCurrent.getTime();\n\t\tthis._dateNew = new Date( dateCurrentTime );\n\t\tthis._dateBounds = new DPickerTimeBounds(\n\t\t\ttoBoundsOptions( theme, options && options.bounds ),\n\t\t\t(): void => { this.onNewChanged(); }\n\t\t);\n\t\tconst margin = ( options && options.margin != null ?\n\t\t\toptions.margin : theme.getMargin() );\n\t\tnew DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: \"padding\", y: \"padding\",\n\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\tmargin,\n\t\t\tchildren: this.newChildren( theme, options, margin )\n\t\t});\n\t}\n\n\tget current(): Date {\n\t\treturn this._dateCurrent;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tif( this._dateCurrent.getTime() !== dateCurrent.getTime() ) {\n\t\t\tthis._dateCurrent = dateCurrent;\n\t\t}\n\t}\n\n\tget new(): Date {\n\t\treturn this._dateNew;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tif( this._dateNew.getTime() !== dateNew.getTime() ) {\n\t\t\tthis._dateNew = dateNew;\n\t\t\tthis.onNewChanged();\n\t\t}\n\t}\n\n\tget bounds(): DPickerTimeBounds {\n\t\treturn this._dateBounds;\n\t}\n\n\thasHours(): boolean {\n\t\treturn this._inputHours != null;\n\t}\n\n\thasMinutes(): boolean {\n\t\treturn this._inputMinutes != null;\n\t}\n\n\thasSeconds(): boolean {\n\t\treturn this._inputSeconds != null;\n\t}\n\n\treset(): void {\n\t\tconst currentTime = this._dateCurrent.getTime();\n\t\tthis._dateNew.setTime( currentTime );\n\t\tthis.onReset();\n\t}\n\n\tprotected onReset(): void {\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected onNewChanged(): void {\n\t\tconst dateNew = this._dateNew;\n\t\tconst dateBounds = this._dateBounds;\n\t\tdateBounds.adjust( this._dateNew );\n\n\t\tconst inputHours = this._inputHours;\n\t\tif( inputHours ) {\n\t\t\tconst hours = dateBounds.hours;\n\t\t\tinputHours.value = dateNew.getHours();\n\t\t\tinputHours.min = hours.min( dateNew );\n\t\t\tinputHours.max = hours.max( dateNew );\n\t\t}\n\n\t\tconst inputMinutes = this._inputMinutes;\n\t\tif( inputMinutes ) {\n\t\t\tconst minutes = dateBounds.minutes;\n\t\t\tinputMinutes.value = dateNew.getMinutes();\n\t\t\tinputMinutes.min = minutes.min( dateNew );\n\t\t\tinputMinutes.max = minutes.max( dateNew );\n\t\t}\n\n\t\tconst inputSeconds = this._inputSeconds;\n\t\tif( inputSeconds ) {\n\t\t\tconst seconds = dateBounds.seconds;\n\t\t\tinputSeconds.value = dateNew.getSeconds();\n\t\t\tinputSeconds.min = seconds.min( dateNew );\n\t\t\tinputSeconds.max = seconds.max( dateNew );\n\t\t}\n\t}\n\n\tprotected newChildren( theme: THEME, options: OPTIONS | undefined, margin: number ): Array<DisplayObject | null> {\n\t\tconst mask = ( (options && options.mask != null) ? options.mask : theme.getMask() );\n\t\tthis._dateBounds.mask = mask;\n\t\tthis._inputHours = ( (mask & DPickerDatetimeMask.HOURS) ? this.newInputHours( theme, options ) : null );\n\t\tthis._inputMinutes = ( (mask & DPickerDatetimeMask.MINUTES) ? this.newInputMinutes( theme, options ) : null );\n\t\tthis._inputSeconds = ( (mask & DPickerDatetimeMask.SECONDS) ? this.newInputSeconds( theme, options ) : null );\n\t\treturn [\n\t\t\tthis.newTimeLayout(\n\t\t\t\tthis._inputHours,\n\t\t\t\tthis._inputMinutes,\n\t\t\t\tthis._inputSeconds,\n\t\t\t\tmargin\n\t\t\t)\n\t\t];\n\t}\n\n\tprotected newTimeLayout(\n\t\thours: DInputInteger | null,\n\t\tminutes: DInputInteger | null,\n\t\tseconds: DInputInteger | null,\n\t\tmargin: number\n\t): DLayoutHorizontal | null {\n\t\tconst children = this.newTimeLayoutChildren( hours, minutes, seconds );\n\t\tif( 0 < children.length ) {\n\t\t\treturn new DLayoutHorizontal({\n\t\t\t\twidth: this.getTimeLayoutWidth(),\n\t\t\t\theight: this.getTimeLayoutHeight(),\n\t\t\t\tmargin,\n\t\t\t\tchildren\n\t\t\t});\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getTimeLayoutWidth(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tprotected getTimeLayoutHeight(): DCoordinate {\n\t\treturn \"auto\";\n\t}\n\n\tprotected newTimeLayoutChildren(\n\t\thours: DInputInteger | null,\n\t\tminutes: DInputInteger | null,\n\t\tseconds: DInputInteger | null\n\t): Array<DisplayObject | null> {\n\t\tconst result = [];\n\t\tif( hours != null ) {\n\t\t\tresult.push( hours );\n\t\t}\n\t\tif( minutes != null ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult.push( this.newMinuteSeparator() );\n\t\t\t}\n\t\t\tresult.push( minutes );\n\t\t}\n\t\tif( seconds != null ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult.push( this.newSecondSeparator() );\n\t\t\t}\n\t\t\tresult.push( seconds );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newMinuteSeparator(): DText | null {\n\t\treturn new DText({\n\t\t\twidth: \"auto\",\n\t\t\ttext: {\n\t\t\t\tvalue: this.getMinuteSeparator()\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMinuteSeparator(): string {\n\t\treturn \":\";\n\t}\n\n\tprotected newSecondSeparator(): DText | null {\n\t\treturn new DText({\n\t\t\twidth: \"auto\",\n\t\t\ttext: {\n\t\t\t\tvalue: this.getSecondSeparator()\n\t\t\t}\n\t\t});\n\t}\n\n\tgetSecondSeparator(): string {\n\t\treturn \":\";\n\t}\n\n\tprotected adjustInputOptions( theme: THEME, options: DInputIntegerOptions, max: number ): DInputIntegerOptions {\n\t\tif( options.step == null ) {\n\t\t\toptions.step = 1;\n\t\t}\n\t\tif( options.min == null ) {\n\t\t\toptions.min = 0;\n\t\t}\n\t\tif( options.max == null ) {\n\t\t\toptions.max = max;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected newInputHours( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.hours ) || theme.getHoursOptions();\n\t\tconst max = this._dateBounds.constant.hour.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onHoursChanged( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onHoursChanged( value: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tdateNew.setHours( value );\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected newInputMinutes( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.minutes ) || theme.getMinutesOptions();\n\t\tconst max = this._dateBounds.constant.minute.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onMinutesChanged( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onMinutesChanged( value: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tdateNew.setMinutes( value );\n\t\tthis.onNewChanged();\n\t}\n\n\tprotected newInputSeconds( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.seconds ) || theme.getSecondsOptions();\n\t\tconst max = this._dateBounds.constant.second.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onSecondsChanged( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onSecondsChanged( value: number ): void {\n\t\tthis._dateNew.setSeconds( value );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DCoordinate } from \"./d-coordinate\";\nimport { DInputIntegerOptions } from \"./d-input-integer\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetimeButtonBack, DPickerDatetimeButtonBackOptions } from \"./d-picker-datetime-button-back\";\nimport { DPickerDatetimeButtonDate } from \"./d-picker-datetime-button-date\";\nimport { DPickerDatetimeButtonNext, DPickerDatetimeButtonNextOptions } from \"./d-picker-datetime-button-next\";\nimport { DPickerDatetimeLabel } from \"./d-picker-datetime-label\";\nimport { DPickerDatetimeLabelDate } from \"./d-picker-datetime-label-date\";\nimport { DPickerDatetimeSpace } from \"./d-picker-datetime-space\";\nimport { DPickerTime, DPickerTimeOptions, DThemePickerTime } from \"./d-picker-time\";\nimport { DText } from \"./d-text\";\n\nexport type DPickerDatetimeLabelFormatter = ( date: Date ) => string;\nexport type DPickerDatetimeDateDecorator = ( date: Date, button: DPickerDatetimeButtonDate ) => void;\nexport type DPickerDatetimeDayLabels = [ string, string, string, string, string, string, string ];\n\nexport interface DPickerDatetimeOptions<\n\tTHEME extends DThemePickerDatetime = DThemePickerDatetime\n> extends DPickerTimeOptions<THEME> {\n\tback?: DPickerDatetimeButtonBackOptions | null;\n\tnext?: DPickerDatetimeButtonNextOptions | null;\n\tday?: {\n\t\tstart?: number;\n\t\tlabels?: DPickerDatetimeDayLabels;\n\t};\n\tlabel?: {\n\t\tformatter?: DPickerDatetimeLabelFormatter;\n\t};\n\tdate?: {\n\t\tdecorator?: DPickerDatetimeDateDecorator;\n\t};\n}\n\nexport interface DThemePickerDatetime extends DThemePickerTime {\n\tgetDayLabels(): DPickerDatetimeDayLabels;\n\tgetDayStart(): number;\n\tgetLabelFormatter(): DPickerDatetimeLabelFormatter;\n\tgetDateDecorator(): DPickerDatetimeDateDecorator;\n\tgetBackButtonOptions(): DPickerDatetimeButtonBackOptions | null;\n\tgetNextButtonOptions(): DPickerDatetimeButtonNextOptions | null;\n}\n\nexport class DPickerDatetime<\n\tTHEME extends DThemePickerDatetime = DThemePickerDatetime,\n\tOPTIONS extends DPickerDatetimeOptions<THEME> = DPickerDatetimeOptions<THEME>\n> extends DPickerTime<THEME, OPTIONS> {\n\tprotected _datePage!: Date;\n\tprotected _dateButtons!: Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate>;\n\tprotected _dateDecorator!: DPickerDatetimeDateDecorator;\n\tprotected _label!: DText;\n\tprotected _labelFormatter!: DPickerDatetimeLabelFormatter;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._datePage = new Date( this._dateCurrent.getTime() );\n\t}\n\n\tprotected newChildren( theme: THEME, options: OPTIONS | undefined, margin: number ): Array<DisplayObject | null> {\n\t\tthis._dateButtons = this.newDateButtons( theme, options );\n\t\tthis._dateDecorator = ( options && options.date && options.date.decorator ) ||\n\t\t\ttheme.getDateDecorator();\n\t\tthis._label = this.newLabel();\n\t\tthis._labelFormatter = ( options && options.label && options.label.formatter ) ||\n\t\t\ttheme.getLabelFormatter();\n\t\tconst result = super.newChildren( theme, options, margin );\n\t\tresult.unshift(\n\t\t\tnew DLayoutHorizontal({\n\t\t\t\twidth: \"100%\", height: \"auto\",\n\t\t\t\tchildren: [\n\t\t\t\t\tthis.newBackButton( theme, options ),\n\t\t\t\t\tthis._label,\n\t\t\t\t\tthis.newNextButton( theme, options )\n\t\t\t\t]\n\t\t\t}),\n\t\t\tnew DLayoutHorizontal({\n\t\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\t\tmargin,\n\t\t\t\tchildren: this.newDateLabels( theme, options )\n\t\t\t}),\n\t\t\tnew DLayoutVertical({\n\t\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\t\tmargin,\n\t\t\t\tcolumn: 7,\n\t\t\t\tchildren: this._dateButtons\n\t\t\t})\n\t\t);\n\t\treturn result;\n\t}\n\n\tget page(): Date {\n\t\treturn this._datePage;\n\t}\n\n\tset page( datePage: Date ) {\n\t\tif( this._datePage.getTime() !== datePage.getTime() ) {\n\t\t\tthis._datePage = datePage;\n\t\t\tthis.onPageChanged();\n\t\t}\n\t}\n\n\tprotected onReset(): void {\n\t\tthis._datePage.setTime( this._dateCurrent.getTime() );\n\t\tsuper.onReset();\n\t}\n\n\tnext(): void {\n\t\tconst work = this._datePage;\n\t\twork.setFullYear( work.getFullYear(), work.getMonth() + 1, 1 );\n\t\twork.setHours( 0, 0, 0, 0 );\n\t\tthis.onPageChanged();\n\t}\n\n\tback(): void {\n\t\tconst work = this._datePage;\n\t\twork.setFullYear( work.getFullYear(), work.getMonth() - 1, 1 );\n\t\twork.setHours( 0, 0, 0, 0 );\n\t\tthis.onPageChanged();\n\t}\n\n\tonNewChanged(): void {\n\t\tthis._dateBounds.adjust( this._datePage );\n\t\tsuper.onNewChanged();\n\t\tthis.onPageChanged();\n\t}\n\n\tprotected onPageChanged(): void {\n\t\tconst buttons = this._dateButtons;\n\t\tconst bounds = this._dateBounds;\n\t\tconst datePage = this._datePage;\n\t\tconst dateNew = this._dateNew;\n\n\t\tconst tmp = new Date( datePage.getTime() );\n\t\ttmp.setDate( 1 );\n\t\ttmp.setHours( 0, 0, 0, 0 );\n\n\t\t// Spaces\n\t\tconst theme = this.theme;\n\t\tconst spaceCount = ( tmp.getDay() - theme.getDayStart() + 7 ) % 7;\n\t\tfor( let i = 0; i < spaceCount; ++i ) {\n\t\t\tbuttons[ i ].show();\n\t\t}\n\t\tfor( let i = spaceCount; i < 7; ++i ) {\n\t\t\tbuttons[ i ].hide();\n\t\t}\n\n\t\t// Date buttons\n\t\tconst dateDecorator = this._dateDecorator;\n\t\ttmp.setFullYear( tmp.getFullYear(), tmp.getMonth() + 1, 0 );\n\t\tconst dateCount = tmp.getDate();\n\t\tconst dateNewDate = ( dateNew.getFullYear() === tmp.getFullYear() &&\n\t\t\tdateNew.getMonth() === tmp.getMonth() ? dateNew.getDate() : 0 );\n\t\tfor( let i = 0; i < dateCount; ++i ) {\n\t\t\ttmp.setDate( i + 1 );\n\n\t\t\tconst button = buttons[ i + 7 ];\n\t\t\tbutton.setActive( dateNewDate === i + 1 );\n\t\t\tbutton.setDisabled( ! bounds.contains( tmp ) );\n\t\t\tbutton.show();\n\n\t\t\tdateDecorator( tmp, button as DPickerDatetimeButtonDate );\n\t\t}\n\t\tfor( let i = dateCount; i < 31; ++i ) {\n\t\t\tconst button = buttons[ i + 7 ];\n\t\t\tbutton.setActive( false );\n\t\t\tbutton.hide();\n\t\t}\n\n\t\t// Label\n\t\tthis._label.text = this._labelFormatter( datePage );\n\t}\n\n\tprotected adjustInputOptions( theme: THEME, options: DInputIntegerOptions, max: number ): DInputIntegerOptions {\n\t\tif( options.weight == null ) {\n\t\t\toptions.weight = 1;\n\t\t}\n\t\treturn super.adjustInputOptions( theme, options, max );\n\t}\n\n\tprotected getTimeLayoutWidth(): DCoordinate {\n\t\treturn \"100%\";\n\t}\n\n\tprotected newLabel(): DPickerDatetimeLabel {\n\t\treturn new DPickerDatetimeLabel({\n\t\t\tweight: 1,\n\t\t\tpadding: 0,\n\t\t\ttext: {\n\t\t\t\talign: {\n\t\t\t\t\thorizontal: \"CENTER\"\n\t\t\t\t},\n\t\t\t\tvalue: \"\"\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newBackButton( theme: THEME, options?: OPTIONS ): DPickerDatetimeButtonBack | null {\n\t\tconst buttonOptions = ( options && options.back !== undefined ?\n\t\t\toptions.back : theme.getBackButtonOptions() );\n\t\tif( buttonOptions != null ) {\n\t\t\tconst button = new DPickerDatetimeButtonBack( buttonOptions );\n\t\t\tbutton.on( \"active\", (): void => {\n\t\t\t\tthis.back();\n\t\t\t});\n\t\t\treturn button;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected newNextButton( theme: THEME, options?: OPTIONS ): DPickerDatetimeButtonNext | null {\n\t\tconst buttonOptions = ( options && options.next !== undefined ?\n\t\t\toptions.next : theme.getNextButtonOptions() );\n\t\tif( buttonOptions != null ) {\n\t\t\tconst button = new DPickerDatetimeButtonNext( buttonOptions );\n\t\t\tbutton.on( \"active\", (): void => {\n\t\t\t\tthis.next();\n\t\t\t});\n\t\t\treturn button;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected newDateLabels( theme: THEME, options: OPTIONS | undefined ): DPickerDatetimeLabelDate[] {\n\t\tconst dateLabels = theme.getDayLabels();\n\t\tconst dayStart = theme.getDayStart();\n\t\tconst result: DPickerDatetimeLabelDate[] = [];\n\t\tfor( let i = 0; i < 7; ++i ) {\n\t\t\tconst label = dateLabels[ (dayStart + i) % 7 ];\n\t\t\tresult.push(\n\t\t\t\tthis.newDateLabel( theme, options, label )\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newDateLabel( theme: THEME, options: OPTIONS | undefined, label: string ): DPickerDatetimeLabelDate {\n\t\treturn new DPickerDatetimeLabelDate({\n\t\t\ttext: {\n\t\t\t\tvalue: label\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newDateButtons(\n\t\ttheme: THEME, options: OPTIONS | undefined\n\t): Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate> {\n\t\tconst result: Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate> = [];\n\t\tfor( let i = 0; i < 7; ++i ) {\n\t\t\tresult.push(\n\t\t\t\tthis.newSpace( theme, options )\n\t\t\t);\n\t\t}\n\t\tfor( let i = 1; i <= 31; ++i ) {\n\t\t\tresult.push(\n\t\t\t\tthis.newDateButton( theme, options, i )\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newSpace( theme: THEME, options: OPTIONS | undefined ): DPickerDatetimeSpace {\n\t\treturn new DPickerDatetimeSpace();\n\t}\n\n\tprotected newDateButton( theme: THEME, options: OPTIONS | undefined, date: number ): DPickerDatetimeButtonDate {\n\t\treturn new DPickerDatetimeButtonDate({\n\t\t\ttext: {\n\t\t\t\tvalue: String( date )\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tactive: (): void => {\n\t\t\t\t\tthis.onDateButtonClicked( date );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onDateButtonClicked( date: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tif( dateNew.getDate() !== date ) {\n\t\t\tconst datePage = this._datePage;\n\t\t\tdateNew.setFullYear( datePage.getFullYear() );\n\t\t\tdateNew.setMonth( datePage.getMonth() );\n\t\t\tdateNew.setDate( date );\n\t\t\tthis.onNewChanged();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetime, DPickerDatetimeOptions, DThemePickerDatetime } from \"./d-picker-datetime\";\n\nexport interface DPickerDateOptions<\n\tTHEME extends DThemePickerDate = DThemePickerDate\n> extends DPickerDatetimeOptions<THEME> {\n\n}\n\nexport interface DThemePickerDate extends DThemePickerDatetime {\n\n}\n\nexport class DPickerDate<\n\tTHEME extends DThemePickerDate = DThemePickerDate,\n\tOPTIONS extends DPickerDateOptions<THEME> = DPickerDateOptions<THEME>\n> extends DPickerDatetime<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDate, DPickerDateOptions } from \"./d-picker-date\";\n\nexport interface DDialogDateOptions<\n\tTHEME extends DThemeDialogDate = DThemeDialogDate\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerDateOptions;\n}\n\nexport interface DThemeDialogDate extends DThemeDialogCommand {\n\n}\n\nexport class DDialogDate<\n\tTHEME extends DThemeDialogDate = DThemeDialogDate,\n\tOPTIONS extends DDialogDateOptions<THEME> = DDialogDateOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerDate;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerDate( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this._picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis._picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tthis._picker.new = dateNew;\n\t}\n\n\tget page(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset page( datePage: Date ) {\n\t\tthis._picker.page = datePage;\n\t}\n\n\tget picker(): DPickerDate {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDate } from \"./d-dialog-date\";\n\nexport class DDialogDates {\n\tprotected static INSTANCE?: DDialogDate;\n\tstatic getInstance(): DDialogDate {\n\t\tif( DDialogDates.INSTANCE == null ) {\n\t\t\tDDialogDates.INSTANCE = new DDialogDate();\n\t\t}\n\t\treturn DDialogDates.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDate, DDialogDateOptions } from \"./d-dialog-date\";\nimport { DDialogDates } from \"./d-dialog-dates\";\n\nexport interface DButtonDateOptions<\n\tTHEME extends DThemeButtonDate = DThemeButtonDate\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogDateOptions;\n}\n\nexport interface DThemeButtonDate extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DButtonDate ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DButtonDate<\n\tTHEME extends DThemeButtonDate = DThemeButtonDate,\n\tOPTIONS extends DButtonDateOptions<THEME> = DButtonDateOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogDate;\n\tprotected _dialogOptions?: DDialogDateOptions;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._dialogOptions = options && options.dialog;\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dateNew = dialog.new;\n\t\t\t\tconst dateCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dateNew, dateCurrent, this );\n\t\t\t\tthis.text = new Date( dateNew.getTime() );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tget dialog(): DDialogDate {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDate( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDates.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: Date ) {\n\t\tif( this._textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetime, DPickerDatetimeOptions } from \"./d-picker-datetime\";\n\nexport interface DDialogDatetimeOptions<\n\tTHEME extends DThemeDialogDatetime = DThemeDialogDatetime\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerDatetimeOptions;\n}\n\nexport interface DThemeDialogDatetime extends DThemeDialogCommand {\n\n}\n\nexport class DDialogDatetime<\n\tTHEME extends DThemeDialogDatetime = DThemeDialogDatetime,\n\tOPTIONS extends DDialogDatetimeOptions<THEME> = DDialogDatetimeOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerDatetime;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerDatetime( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this._picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis._picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tthis._picker.new = dateNew;\n\t}\n\n\tget page(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset page( datePage: Date ) {\n\t\tthis._picker.page = datePage;\n\t}\n\n\tget picker(): DPickerDatetime {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDatetime } from \"./d-dialog-datetime\";\n\nexport class DDialogDatetimes {\n\tprotected static INSTANCE?: DDialogDatetime;\n\tstatic getInstance(): DDialogDatetime {\n\t\tif( DDialogDatetimes.INSTANCE == null ) {\n\t\t\tDDialogDatetimes.INSTANCE = new DDialogDatetime();\n\t\t}\n\t\treturn DDialogDatetimes.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDatetime, DDialogDatetimeOptions } from \"./d-dialog-datetime\";\nimport { DDialogDatetimes } from \"./d-dialog-datetimes\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimes } from \"./d-picker-datetimes\";\n\nexport interface DButtonDatetimeOptions<\n\tTHEME extends DThemeButtonDatetime = DThemeButtonDatetime\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogDatetimeOptions;\n}\n\nexport interface DThemeButtonDatetime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DButtonDatetime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DButtonDatetime<\n\tTHEME extends DThemeButtonDatetime = DThemeButtonDatetime,\n\tOPTIONS extends DButtonDatetimeOptions<THEME> = DButtonDatetimeOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogDatetime;\n\tprotected _dialogOptions?: DDialogDatetimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tthis._dialogOptions = options && options.dialog;\n\t\tthis._datetimeMask = DPickerDatetimes.toMask( options && options.dialog && options.dialog.picker );\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dateNew = dialog.new;\n\t\t\t\tconst dateCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dateNew, dateCurrent, this );\n\t\t\t\tthis.text = new Date( dateNew.getTime() );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogDatetime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDatetime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDatetimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: Date ) {\n\t\tif( this._textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { UtilFileAs, UtilFileOpener } from \"./util/util-file-opener\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport import DButtonFileAs = UtilFileAs;\n\nexport interface DButtonFileOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonFile = DThemeButtonFile\n> extends DButtonOptions<VALUE, THEME> {\n\tas?: (keyof typeof UtilFileAs) | UtilFileAs;\n\tchecker?: () => Promise<unknown> | boolean;\n}\n\nexport interface DThemeButtonFile extends DThemeButton {\n\n}\n\nexport class DButtonFile<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonFile = DThemeButtonFile,\n\tOPTIONS extends DButtonFileOptions<VALUE, THEME> = DButtonFileOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected _checker!: (() => Promise<unknown> | boolean) | undefined;\n\tprotected _opener!: UtilFileOpener;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tthis._checker = ( options != null && options.checker != null ? options.checker : undefined );\n\t\tconst as: DButtonFileAs = ( options != null && options.as != null ?\n\t\t\t( utilIsString( options.as ) ? DButtonFileAs[ options.as ] : options.as ) :\n\t\t\tDButtonFileAs.TEXT\n\t\t);\n\t\tconst opener = new UtilFileOpener( as, this );\n\t\tthis._opener = opener;\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst result = this.onOpening();\n\t\t\tif( result === true ) {\n\t\t\t\topener.open();\n\t\t\t} else if( result === false ) {\n\t\t\t\t// DO NOTHING\n\t\t\t} else {\n\t\t\t\tresult.then((): void => {\n\t\t\t\t\topener.open();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t}\n\n\tonOpening(): boolean | Promise<unknown> {\n\t\tconst checker = this._checker;\n\t\tif( checker != null ) {\n\t\t\treturn checker();\n\t\t}\n\t\treturn true;\n\t}\n\n\topen(): void {\n\t\tthis._opener.open();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonFile\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonBase } from \"./d-button-base\";\n\ntype BUTTON = DButtonBase<any, any, any>;\n\nexport interface DButtonGroupOptions {\n\ton?: { [name: string]: Function };\n}\n\nexport class DButtonGroup extends utils.EventEmitter {\n\tprotected _buttons: BUTTON[];\n\tprotected _active: BUTTON | null;\n\tprotected _stateOn: DBaseState;\n\tprotected _stateOff: DBaseState;\n\tprotected _onActiveBound: ( button: BUTTON ) => void;\n\n\tconstructor( options?: DButtonGroupOptions ) {\n\t\tsuper();\n\n\t\tthis._buttons = [];\n\t\tthis._active = null;\n\t\tthis._stateOn = DBaseState.NONE;\n\t\tthis._stateOff = DBaseState.NONE;\n\t\tthis._onActiveBound = ( button: BUTTON ): void => {\n\t\t\tthis.onActive( button );\n\t\t};\n\n\t\t// Events\n\t\tif( options != null ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Done\n\t\tthis.emit( \"init\", this );\n\t}\n\n\tadd( button: BUTTON ): void {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\tif( index < 0 ) {\n\t\t\tthis._buttons.push( button );\n\t\t\tbutton.setState( this._stateOn, true );\n\t\t\tbutton.setState( this._stateOff, false );\n\t\t\tbutton.on( \"active\", this._onActiveBound );\n\t\t\tif( button.isActive() ) {\n\t\t\t\tthis.onActive( button );\n\t\t\t}\n\t\t}\n\t}\n\n\tget active() {\n\t\treturn this._active;\n\t}\n\n\tprotected onActive( active: BUTTON ): void {\n\t\tif( active.isToggle() ) {\n\t\t\tthis._active = active;\n\t\t\tconst buttons = this._buttons;\n\t\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\t\tconst button = buttons[ i ];\n\t\t\t\tif( button !== active && button.isToggle() && button.isActive() ) {\n\t\t\t\t\tbutton.onClick();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tremove( button: BUTTON ): void {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\tif( 0 <= index ) {\n\t\t\tbuttons.splice( index, 1 );\n\t\t\tbutton.off( \"active\", this._onActiveBound );\n\t\t}\n\t}\n\n\tcontains( button: BUTTON ): boolean {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\treturn ( 0 <= index );\n\t}\n\n\tsetHovered( isHovered: boolean ) {\n\t\treturn this.setState( DBaseState.HOVERED, isHovered );\n\t}\n\n\tsetActive( isActive: boolean ) {\n\t\treturn this.setState( DBaseState.ACTIVE, isActive );\n\t}\n\n\tsetReadOnly( isReadOnly: boolean ) {\n\t\treturn this.setState( DBaseState.READ_ONLY, isReadOnly );\n\t}\n\n\tsetDisabled( isDisabled: boolean ) {\n\t\treturn this.setState( DBaseState.DISABLED, isDisabled );\n\t}\n\n\tsetDragging( isDragging: boolean ) {\n\t\treturn this.setState( DBaseState.DRAGGING, isDragging );\n\t}\n\n\tisHovered(): boolean {\n\t\treturn this.hasState( DBaseState.HOVERED );\n\t}\n\n\tisActive(): boolean {\n\t\treturn this.hasState( DBaseState.ACTIVE );\n\t}\n\n\tisReadOnly(): boolean {\n\t\treturn this.hasState( DBaseState.READ_ONLY );\n\t}\n\n\tisDisabled(): boolean {\n\t\treturn this.hasState( DBaseState.DISABLED );\n\t}\n\n\tisDragging(): boolean {\n\t\treturn this.hasState( DBaseState.DRAGGING );\n\t}\n\n\tisFocused(): boolean {\n\t\treturn this.hasState( DBaseState.FOCUSED );\n\t}\n\n\tisUnfocusable(): boolean {\n\t\treturn this.hasState( DBaseState.UNFOCUSABLE );\n\t}\n\n\tsetState( state: DBaseState, isOn: boolean ) {\n\t\tif( isOn ) {\n\t\t\tthis._stateOn |= state;\n\t\t\tthis._stateOff &= ~state;\n\t\t} else {\n\t\t\tthis._stateOff |= state;\n\t\t\tthis._stateOn &= ~state;\n\t\t}\n\n\t\tconst buttons = this._buttons;\n\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\tconst button = buttons[ i ];\n\t\t\tbutton.setState( state, isOn );\n\t\t}\n\t\treturn this;\n\t}\n\n\thasState( state: DBaseState ): boolean {\n\t\tconst buttons = this._buttons;\n\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\tif( buttons[ i ].hasState( state ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tclear(): void {\n\t\tthis._buttons.length = 0;\n\t}\n\n\tdestroy(): void {\n\t\tthis.clear();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonRadioOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadio = DThemeButtonRadio\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonRadio extends DThemeButtonBase {\n\n}\n\nexport class DButtonRadio<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadio = DThemeButtonRadio,\n\tOPTIONS extends DButtonRadioOptions<VALUE, THEME> = DButtonRadioOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonRadio\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonRadio, DButtonRadioOptions, DThemeButtonRadio } from \"./d-button-radio\";\n\nexport interface DButtonRadioRightOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadioRight = DThemeButtonRadioRight\n> extends DButtonRadioOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonRadioRight extends DThemeButtonRadio {\n\n}\n\nexport class DButtonRadioRight<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadioRight = DThemeButtonRadioRight,\n\tOPTIONS extends DButtonRadioRightOptions<VALUE, THEME> = DButtonRadioRightOptions<VALUE, THEME>\n> extends DButtonRadio<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonRadioRight\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DButtonRedo<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst commandController = DControllers.getCommandController();\n\t\tthis.setState( DBaseState.DISABLED, ! commandController.isRedoable() );\n\t\tcommandController.on( \"change\", () => {\n\t\t\tthis.setState( DBaseState.DISABLED, ! commandController.isRedoable() );\n\t\t});\n\n\t\tthis.on( \"active\", () => {\n\t\t\tcommandController.redo();\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonSecondary extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonSecondary\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerTime, DPickerTimeOptions } from \"./d-picker-time\";\n\nexport interface DDialogTimeOptions<\n\tTHEME extends DThemeDialogTime = DThemeDialogTime\n> extends DDialogCommandOptions<THEME> {\n\tpicker?: DPickerTimeOptions;\n}\n\nexport interface DThemeDialogTime extends DThemeDialogCommand {\n\n}\n\nexport class DDialogTime<\n\tTHEME extends DThemeDialogTime = DThemeDialogTime,\n\tOPTIONS extends DDialogTimeOptions<THEME> = DDialogTimeOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _picker!: DPickerTime;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst picker = new DPickerTime( options && options.picker );\n\t\tthis._picker = picker;\n\t\tlayout.addChild( picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this._picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis._picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this._picker.new;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tthis._picker.new = dateNew;\n\t}\n\n\tget picker(): DPickerTime {\n\t\treturn this._picker;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogTime } from \"./d-dialog-time\";\n\nexport class DDialogTimes {\n\tprotected static INSTANCE?: DDialogTime;\n\tstatic getInstance(): DDialogTime {\n\t\tif( DDialogTimes.INSTANCE == null ) {\n\t\t\tDDialogTimes.INSTANCE = new DDialogTime();\n\t\t}\n\t\treturn DDialogTimes.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogTime, DDialogTimeOptions } from \"./d-dialog-time\";\nimport { DDialogTimes } from \"./d-dialog-times\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\n\nexport interface DButtonTimeOptions<\n\tTHEME extends DThemeButtonTime = DThemeButtonTime\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogTimeOptions;\n}\n\nexport interface DThemeButtonTime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DButtonTime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DButtonTime<\n\tTHEME extends DThemeButtonTime = DThemeButtonTime,\n\tOPTIONS extends DButtonTimeOptions<THEME> = DButtonTimeOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogTime;\n\tprotected _dialogOptions?: DDialogTimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tthis._dialogOptions = options && options.dialog;\n\t\tthis._datetimeMask = DPickerTimes.toMask( options && options.dialog && options.dialog.picker );\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dateNew = dialog.new;\n\t\t\t\tconst dateCurrent = dialog.current;\n\t\t\t\tthis.emit( \"select\", dateNew, dateCurrent, this );\n\t\t\t\tthis.text = new Date( dateNew.getTime() );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogTime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogTime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogTimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: Date ) {\n\t\tif( this._textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DButtonUndo<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton = DThemeButton,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst commandController = DControllers.getCommandController();\n\t\tthis.setState( DBaseState.DISABLED, ! commandController.isUndoable() );\n\t\tcommandController.on( \"change\", () => {\n\t\t\tthis.setState( DBaseState.DISABLED, ! commandController.isUndoable() );\n\t\t});\n\n\t\tthis.on( \"active\", () => {\n\t\t\tcommandController.undo();\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Renderer } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DCornerMask } from \"./d-corner\";\n\nexport class DBaseOverflowMask extends Graphics implements DReflowable {\n\tconstructor( parent: DBase ) {\n\t\tsuper();\n\t\t(this as any).parent = parent;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.updateTransform();\n\t\tsuper.render( renderer );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number): void {\n\t\tconst x = 0;\n\t\tconst y = 0;\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = Math.max( 0, corner.getRadius() - 0.5 );\n\t\tconst cornerMask = corner.getMask();\n\t\tconst tl = ( cornerMask & DCornerMask.TOP_LEFT ? 0 : cornerRadius );\n\t\tconst tr = ( cornerMask & DCornerMask.TOP_RIGHT ? 0 : cornerRadius );\n\t\tconst bl = ( cornerMask & DCornerMask.BOTTOM_LEFT ? 0 : cornerRadius );\n\t\tconst br = ( cornerMask & DCornerMask.BOTTOM_RIGHT ? 0 : cornerRadius );\n\t\tthis.clear();\n\t\tthis.beginFill( 0xFFFFFF, 1 );\n\t\tthis.lineStyle( 0, 0, 0, 0, false );\n\t\tif( tl <= 0 && tr <= 0 && bl <= 0 && br <= 0 ) {\n\t\t\tthis.moveTo( x, y );\n\t\t\tthis.lineTo( x + width, y );\n\t\t\tthis.lineTo( x + width, y + height );\n\t\t\tthis.lineTo( x, y + height );\n\t\t\tthis.lineTo( x, y );\n\t\t} else {\n\t\t\tthis.moveTo( x + tl, y );\n\t\t\tif( 0 < tr ) {\n\t\t\t\tthis.arcTo( x + width, y, x + width, y + height, tr );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x + width, y );\n\t\t\t}\n\t\t\tif( 0 < br ) {\n\t\t\t\tthis.arcTo( x + width, y + height, x, y + height, br );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x + width, y + height );\n\t\t\t}\n\t\t\tif( 0 < bl ) {\n\t\t\t\tthis.arcTo( x, y + height, x, y, bl );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x, y + height );\n\t\t\t}\n\t\t\tif( 0 < tl ) {\n\t\t\t\tthis.arcTo( x, y, x + width, y, tl );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x, y );\n\t\t\t}\n\t\t}\n\t\tthis.endFill();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DCanvas } from \"./d-canvas\";\nimport { DCanvasContainerOptions, DThemeCanvasContainer } from \"./d-canvas-container\";\nimport { DCanvasContainerViewParent } from \"./d-canvas-container-view\";\nimport { DCanvasContainerViewStopper } from \"./d-canvas-container-view-stopper\";\nimport { DDragMode } from \"./d-drag-mode\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\nimport { UtilDrag } from \"./util/util-drag\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport class DCanvasContainerViewDrag<\n\tCANVAS extends DBase = DCanvas,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer,\n\tOPTIONS extends DCanvasContainerOptions<CANVAS, THEME> = DCanvasContainerOptions<CANVAS, THEME>\n> {\n\tprotected _parent: DCanvasContainerViewParent<CANVAS>;\n\tprotected _stopper: DCanvasContainerViewStopper;\n\tprotected _dragUtil?: UtilDrag;\n\n\tconstructor(\n\t\tparent: DCanvasContainerViewParent<CANVAS>,\n\t\tstopper: DCanvasContainerViewStopper,\n\t\ttheme: THEME,\n\t\toptions: OPTIONS | undefined\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._stopper = stopper;\n\n\t\tconst drag = options && options.drag;\n\t\tconst mode = ( drag && drag.mode != null ?\n\t\t\t( utilIsString( drag.mode ) ? DDragMode[ drag.mode ] : drag.mode ) :\n\t\t\ttheme.getDragMode()\n\t\t);\n\t\tconst modifier = ( drag && drag.modifier != null ?\n\t\t\t( utilIsString( drag.modifier ) ? DMouseModifier[ drag.modifier ] : drag.modifier ) :\n\t\t\ttheme.getDragModifier()\n\t\t);\n\t\tconst duration = ( drag && drag.duration != null ?\n\t\t\tdrag.duration : {\n\t\t\t\tposition: theme.getDragDurationPosition(),\n\t\t\t\tscale: theme.getDragDurationScale()\n\t\t\t}\n\t\t);\n\t\tif( mode === DDragMode.ON || mode === DDragMode.TOUCH ) {\n\t\t\tthis._dragUtil = new UtilDrag({\n\t\t\t\ttarget: parent,\n\t\t\t\ttouch: mode === DDragMode.TOUCH,\n\t\t\t\tmodifier,\n\t\t\t\teasing: {\n\t\t\t\t\tduration\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tstart: (): void => {\n\t\t\t\t\t\tthis._stopper.stop();\n\t\t\t\t\t},\n\t\t\t\t\tmove: ( dx: number, dy: number, x: number, y: number, ds: number ): void => {\n\t\t\t\t\t\tconst canvas = parent.canvas;\n\t\t\t\t\t\tif( canvas != null ) {\n\t\t\t\t\t\t\t// Scale\n\t\t\t\t\t\t\tconst oldScale = canvas.scale.y;\n\t\t\t\t\t\t\tconst newScale = stopper.toNormalizedScale( oldScale * ds );\n\t\t\t\t\t\t\tconst scaleRatio = newScale / oldScale;\n\n\t\t\t\t\t\t\t// Position\n\t\t\t\t\t\t\tconst cx = x - dx;\n\t\t\t\t\t\t\tconst cy = y - dy;\n\t\t\t\t\t\t\tconst position = canvas.position;\n\t\t\t\t\t\t\tconst newX = (position.x - cx) * scaleRatio + x;\n\t\t\t\t\t\t\tconst newY = (position.y - cy) * scaleRatio + y;\n\n\t\t\t\t\t\t\t// Update\n\t\t\t\t\t\t\tcanvas.scale.set( newScale, newScale );\n\t\t\t\t\t\t\tcanvas.position.set( newX, newY );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimationBase } from \"./d-animation-base\";\nimport { DBase } from \"./d-base\";\nimport { DCanvas } from \"./d-canvas\";\nimport { DCanvasContainerViewParent } from \"./d-canvas-container-view\";\nimport { DCanvasContainerViewStopper } from \"./d-canvas-container-view-stopper\";\n\nexport class DCanvasContainerViewTransform<CANVAS extends DBase = DCanvas> {\n\tprotected _parent: DCanvasContainerViewParent<CANVAS>;\n\tprotected _newX: number;\n\tprotected _newY: number;\n\tprotected _newScale: number;\n\tprotected _oldX: number;\n\tprotected _oldY: number;\n\tprotected _oldScale: number;\n\tprotected _animation: DAnimationBase;\n\tprotected _stopper: DCanvasContainerViewStopper;\n\tprotected _duration: number;\n\n\tconstructor( parent: DCanvasContainerViewParent<CANVAS>, stopper: DCanvasContainerViewStopper, duration: number ) {\n\t\tthis._parent = parent;\n\t\tthis._newScale = 1;\n\t\tthis._newX =  0;\n\t\tthis._newY = 0;\n\t\tthis._oldScale = 1;\n\t\tthis._oldX = 0;\n\t\tthis._oldY = 0;\n\t\tthis._animation = new DAnimationBase({\n\t\t\tonTime: ( time: number ): void => {\n\t\t\t\tthis.onTime( time );\n\t\t\t},\n\t\t\tduration\n\t\t});\n\t\tthis._stopper = stopper;\n\t\tthis._duration = duration;\n\t}\n\n\tprotected onTime( time: number ): void {\n\t\tconst w0 = 1 - time;\n\t\tconst w1 = time;\n\n\t\tconst scale = this._oldScale * w0 + this._newScale * w1;\n\t\tconst x = this._oldX * w0 + this._newX * w1;\n\t\tconst y = this._oldY * w0 + this._newY * w1;\n\n\t\tconst canvas = this._parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\tcanvas.scale.set( scale, scale );\n\t\t\tcanvas.position.set( x, y );\n\t\t}\n\t}\n\n\tstart( canvas: CANVAS, newX: number, newY: number, newScale: number, duration?: number, stop?: boolean ): void {\n\t\tif( stop !== false ) {\n\t\t\tthis._stopper.stop();\n\t\t}\n\t\tif( duration == null ) {\n\t\t\tduration = this._duration;\n\t\t}\n\t\tif( duration <= 0 ) {\n\t\t\tcanvas.scale.set( newScale, newScale );\n\t\t\tcanvas.position.set( newX, newY );\n\t\t} else {\n\t\t\tconst position = canvas.position;\n\t\t\tconst scale = canvas.scale;\n\t\t\tthis._oldX = position.x;\n\t\t\tthis._oldY = position.y;\n\t\t\tthis._oldScale = scale.y;\n\n\t\t\tthis._newX = newX;\n\t\t\tthis._newY = newY;\n\t\t\tthis._newScale = newScale;\n\n\t\t\tthis._animation.duration = duration;\n\t\t\tthis._animation.start();\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tthis._animation.stop();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DCanvas } from \"./d-canvas\";\nimport { DCanvasContainerOptions, DThemeCanvasContainer } from \"./d-canvas-container\";\nimport { DCanvasContainerViewDrag } from \"./d-canvas-container-view-drag\";\nimport { DCanvasContainerViewTransform } from \"./d-canvas-container-view-transform\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\nimport { DMouseModifiers } from \"./d-mouse-modifiers\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport interface DCanvasContainerViewParent<CANVAS extends DBase = DCanvas> extends DBase {\n\tcanvas: CANVAS | null;\n}\n\nexport class DCanvasContainerView<\n\tCANVAS extends DBase = DCanvas,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer,\n\tOPTIONS extends DCanvasContainerOptions<CANVAS, THEME> = DCanvasContainerOptions<CANVAS, THEME>\n> {\n\tprotected _parent: DCanvasContainerViewParent<CANVAS>;\n\n\tprotected _zoomPoint: Point;\n\tprotected _zoomMin: number;\n\tprotected _zoomMax: number;\n\n\tprotected _isWheelZoomEnabled: boolean;\n\tprotected _wheelZoomSpeed: number;\n\tprotected _wheelZoomModifier: DMouseModifier;\n\n\tprotected _isDblClickZoomEnabled: boolean;\n\tprotected _dblClickZoomSpeed: number;\n\tprotected _dblClickZoomModifier: DMouseModifier;\n\tprotected _dblclickZoomDuration: number;\n\n\tprotected _isWheelTranslationEnabled: boolean;\n\tprotected _wheelTranslationSpeed: number;\n\tprotected _wheelTranslationModifier: DMouseModifier;\n\n\tprotected _transform: DCanvasContainerViewTransform<CANVAS>;\n\tprotected _drag: DCanvasContainerViewDrag<CANVAS, THEME, OPTIONS>;\n\n\tconstructor( parent: DCanvasContainerViewParent<CANVAS>, theme: THEME, options: OPTIONS | undefined ) {\n\t\tthis._parent = parent;\n\n\t\t// Zoom\n\t\tconst zoom = options && options.zoom;\n\t\tthis._zoomPoint = new Point();\n\t\tthis._zoomMin = zoom && zoom.min != null ? zoom.min : theme.getZoomMin();\n\t\tthis._zoomMax = zoom && zoom.max != null ? zoom.max : theme.getZoomMax();\n\n\t\t// Zoom: Wheel\n\t\tconst wheelZoom = zoom && zoom.wheel;\n\t\tthis._isWheelZoomEnabled = ( wheelZoom && wheelZoom.enable != null ?\n\t\t\twheelZoom.enable : theme.isWheelZoomEnabled()\n\t\t);\n\t\tthis._wheelZoomSpeed = ( wheelZoom && wheelZoom.speed != null ?\n\t\t\twheelZoom.speed : theme.getWheelZoomSpeed()\n\t\t);\n\t\tthis._wheelZoomModifier = ( wheelZoom && wheelZoom.modifier != null ?\n\t\t\t( utilIsString( wheelZoom.modifier ) ?\n\t\t\t\tDMouseModifier[ wheelZoom.modifier ] : wheelZoom.modifier\n\t\t\t) :\n\t\t\ttheme.getWheelZoomModifier()\n\t\t);\n\n\t\t// Zoom: Dbl click\n\t\tconst dblClickZoom = zoom && zoom.dblclick;\n\t\tthis._isDblClickZoomEnabled = ( dblClickZoom && dblClickZoom.enable != null ?\n\t\t\tdblClickZoom.enable : theme.isDblClickZoomEnabled()\n\t\t);\n\t\tthis._dblClickZoomSpeed = ( dblClickZoom && dblClickZoom.amount != null ?\n\t\t\tdblClickZoom.amount : theme.getDblClickZoomSpeed()\n\t\t);\n\t\tthis._dblClickZoomModifier = ( dblClickZoom && dblClickZoom.modifier != null ?\n\t\t\t( utilIsString( dblClickZoom.modifier ) ?\n\t\t\t\tDMouseModifier[ dblClickZoom.modifier ] : dblClickZoom.modifier\n\t\t\t) :\n\t\t\ttheme.getDblClickZoomModifier()\n\t\t);\n\t\tthis._dblclickZoomDuration = ( dblClickZoom && dblClickZoom.duration != null ?\n\t\t\tdblClickZoom.duration : theme.getDblClickZoomDuration()\n\t\t);\n\n\t\t// Translation: Wheel\n\t\tconst wheelTranslation = options && options.translation && options.translation.wheel;\n\t\tthis._isWheelTranslationEnabled = ( wheelTranslation && wheelTranslation.enable != null ?\n\t\t\twheelTranslation.enable : theme.isWheelTranslationEnabled()\n\t\t);\n\t\tthis._wheelTranslationSpeed = ( wheelTranslation && wheelTranslation.speed != null ?\n\t\t\twheelTranslation.speed : theme.getWheelTranslationSpeed()\n\t\t);\n\t\tthis._wheelTranslationModifier = ( wheelTranslation && wheelTranslation.modifier != null ?\n\t\t\t( utilIsString( wheelTranslation.modifier ) ?\n\t\t\t\tDMouseModifier[ wheelTranslation.modifier ] : wheelTranslation.modifier\n\t\t\t) :\n\t\t\ttheme.getWheelTranslationModifier()\n\t\t);\n\n\t\t// Drag\n\t\tthis._drag = new DCanvasContainerViewDrag<CANVAS, THEME, OPTIONS>( parent, this, theme, options );\n\n\t\t// Transform\n\t\tthis._transform = new DCanvasContainerViewTransform( parent, this, this._dblclickZoomDuration );\n\t}\n\n\tget drag(): DCanvasContainerViewDrag<CANVAS, THEME, OPTIONS> {\n\t\treturn this._drag;\n\t}\n\n\tstop(): void {\n\t\tthis._drag.stop();\n\t\tthis._transform.stop();\n\t}\n\n\treset( duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst newCanvasX = (parent.width - canvas.width) * 0.5;\n\t\t\tconst newCanvasY = (parent.height - canvas.height) * 0.5;\n\t\t\tthis._transform.start( canvas, newCanvasX, newCanvasY, 1, duration, stop );\n\t\t}\n\t}\n\n\tfit( duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst padding = parent.padding;\n\t\t\tconst width = parent.width;\n\t\t\tconst height = parent.height;\n\t\t\tconst canvasWidth = canvas.width;\n\t\t\tconst canvasHeight = canvas.height;\n\t\t\tconst canvasScaleX = (width - padding.getLeft() - padding.getRight()) / canvasWidth;\n\t\t\tconst canvasScaleY = (height - padding.getTop() - padding.getBottom()) / canvasHeight;\n\t\t\tconst newCanvasScale = this.toNormalizedScale( Math.min( canvasScaleX, canvasScaleY ) );\n\t\t\tconst newCanvasWidth = canvasWidth * newCanvasScale;\n\t\t\tconst newCanvasHeight = canvasHeight * newCanvasScale;\n\t\t\tconst newCanvasX = (width - newCanvasWidth) * 0.5;\n\t\t\tconst newCanvasY = (height - newCanvasHeight) * 0.5;\n\t\t\tthis._transform.start( canvas, newCanvasX, newCanvasY, newCanvasScale, duration, stop );\n\t\t}\n\t}\n\n\tzoomIn( duration?: number, stop?: boolean ): void {\n\t\tthis.zoom( this.scale * this._dblClickZoomSpeed, duration, stop );\n\t}\n\n\tzoomOut( duration?: number, stop?: boolean ): void {\n\t\tthis.zoom( this.scale / this._dblClickZoomSpeed, duration, stop );\n\t}\n\n\t/**\n\t *\n\t * @param x local x coordinate\n\t * @param y local y coordinate\n\t * @param scale scale\n\t */\n\tzoomAt( x: number, y: number, scale: number, duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\t// Canvas Scale\n\t\t\tconst oldCanvasScale = canvas.scale.y;\n\t\t\tconst newCanvasScale = this.toNormalizedScale( scale );\n\t\t\tconst canvasScaleRatio = newCanvasScale / oldCanvasScale;\n\n\t\t\t// Canvas Position\n\t\t\tconst newCanvasX = (canvas.x - x) * canvasScaleRatio + x;\n\t\t\tconst newCanvasY = (canvas.y - y) * canvasScaleRatio + y;\n\n\t\t\t// Canvas\n\t\t\tthis._transform.start( canvas, newCanvasX, newCanvasY, newCanvasScale, duration, stop );\n\t\t}\n\t}\n\n\tzoomAtGlobal( x: number, y: number, scale: number, duration?: number, stop?: boolean ): void {\n\t\tconst local = this._zoomPoint;\n\t\tlocal.set( x, y );\n\t\tthis.toLocal( local, local );\n\t\tthis.zoomAt( local.x, local.y, scale, duration, stop );\n\t}\n\n\tzoom( scale: number, duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tthis.zoomAt( parent.width * 0.5, parent.height * 0.5, scale, duration, stop );\n\t}\n\n\tget scale(): number {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\treturn canvas.scale.y;\n\t\t} else {\n\t\t\treturn 1;\n\t\t}\n\t}\n\n\tset scale( scale: number ) {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst newScale = this.toNormalizedScale( scale );\n\t\t\tcanvas.scale.set( newScale, newScale );\n\t\t}\n\t}\n\n\tmoveTo( x: number, y: number, duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._transform.start( canvas, x, y, canvas.scale.y, duration, stop );\n\t\t}\n\t}\n\n\tget position(): PIXI.IPoint {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\treturn canvas.position;\n\t\t}\n\t\treturn new PIXI.Point( 0, 0 );\n\t}\n\n\tset position( position: PIXI.IPoint ) {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\tcanvas.position.set( position.x, position.y );\n\t\t}\n\t}\n\n\ttransform( newX: number, newY: number, newScale: number, duration?: number, stop?: boolean ): void {\n\t\tconst canvas = this._parent.canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._transform.start( canvas, newX, newY, newScale, duration, stop );\n\t\t}\n\t}\n\n\ttoLocal( global: PIXI.IPoint, local: PIXI.IPoint, skipUpdate?: boolean ): PIXI.IPoint {\n\t\treturn this._parent.toLocal( global, undefined, local, skipUpdate );\n\t}\n\n\ttoGlobal( local: PIXI.IPoint, global: PIXI.IPoint, skipUpdate?: boolean ): PIXI.IPoint {\n\t\treturn this._parent.toGlobal( local, global, skipUpdate );\n\t}\n\n\ttoNormalizedScale( scale: number ): number {\n\t\treturn Math.min( this._zoomMax, Math.max( this._zoomMin, scale ) );\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tif( this._isWheelZoomEnabled && DMouseModifiers.match( e, this._wheelZoomModifier ) ) {\n\t\t\tif( deltas.deltaY !== 0 ) {\n\t\t\t\tconst speed = deltas.lowest * this._wheelZoomSpeed;\n\t\t\t\tconst scale = this.scale * ( 1 + deltas.deltaY * speed );\n\t\t\t\tthis.zoomAtGlobal( global.x, global.y, scale, 0 );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\tif( this._isWheelTranslationEnabled && DMouseModifiers.match( e, this._wheelTranslationModifier ) ) {\n\t\t\tconst parent = this._parent;\n\t\t\tconst canvas = parent.canvas;\n\t\t\tif( canvas != null ) {\n\t\t\t\tthis.stop();\n\t\t\t\tconst speed = deltas.lowest * this._wheelTranslationSpeed;\n\t\t\t\tcanvas.position.set(\n\t\t\t\t\tcanvas.x - deltas.deltaX * speed,\n\t\t\t\t\tcanvas.y + deltas.deltaY * speed\n\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent ): boolean {\n\t\tif( this._isDblClickZoomEnabled && DMouseModifiers.match( e, this._dblClickZoomModifier ) ) {\n\t\t\tconst global = this._zoomPoint;\n\t\t\tUtilPointerEvent.toGlobal( e, global );\n\t\t\tconst scale = this.scale * this._dblClickZoomSpeed;\n\t\t\tthis.zoomAtGlobal( global.x, global.y, scale, this._dblclickZoomDuration );\n\t\t\treturn true;\n\t\t}\n\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DCanvas } from \"./d-canvas\";\nimport { DCanvasContainerView } from \"./d-canvas-container-view\";\nimport { DDragMode } from \"./d-drag-mode\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport interface DCanvasContainerOptions<\n\tCANVAS extends DBase = DCanvas,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer\n> extends DBaseOptions<THEME> {\n\tmask?: boolean;\n\tcanvas?: CANVAS;\n\tdrag?: {\n\t\tmode?: (keyof typeof DDragMode) | DDragMode;\n\t\tmodifier?: (keyof typeof DMouseModifier) | DMouseModifier;\n\t\tduration?: number | {\n\t\t\tposition?: number,\n\t\t\tscale?: number\n\t\t};\n\t};\n\tzoom?: {\n\t\tmin?: number;\n\t\tmax?: number;\n\t\twheel?: {\n\t\t\tenable?: boolean;\n\t\t\tspeed?: number;\n\t\t\tmodifier?: (keyof typeof DMouseModifier) | DMouseModifier;\n\t\t},\n\t\tdblclick?: {\n\t\t\tenable?: boolean;\n\t\t\tamount?: number;\n\t\t\tmodifier?: (keyof typeof DMouseModifier) | DMouseModifier;\n\t\t\tduration?: number;\n\t\t}\n\t};\n\ttranslation?: {\n\t\twheel?: {\n\t\t\tenable?: boolean;\n\t\t\tspeed?: number;\n\t\t\tmodifier?: (keyof typeof DMouseModifier) | DMouseModifier;\n\t\t}\n\t};\n}\n\nexport interface DThemeCanvasContainer extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n\tisWheelZoomEnabled(): boolean;\n\tisDblClickZoomEnabled(): boolean;\n\tisWheelTranslationEnabled(): boolean;\n\tgetWheelZoomSpeed(): number;\n\tgetWheelZoomModifier(): DMouseModifier;\n\tgetDblClickZoomSpeed(): number;\n\tgetDblClickZoomModifier(): DMouseModifier;\n\tgetDblClickZoomDuration(): number;\n\tgetWheelTranslationSpeed(): number;\n\tgetWheelTranslationModifier(): DMouseModifier;\n\tgetDragMode(): DDragMode;\n\tgetDragModifier(): DMouseModifier;\n\tgetDragDurationPosition(): number;\n\tgetDragDurationScale(): number;\n\tgetZoomMin(): number;\n\tgetZoomMax(): number;\n}\n\nconst isOverflowMaskEnabled = <\n\tCANVAS extends DBase,\n\tTHEME extends DThemeCanvasContainer\n>( theme: THEME, options?: DCanvasContainerOptions<CANVAS, THEME> ): boolean => {\n\tif( options && options.mask != null ) {\n\t\treturn options.mask;\n\t}\n\treturn theme.isOverflowMaskEnabled();\n};\n\nexport class DCanvasContainer<\n\tCANVAS extends DBase = DCanvas,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer,\n\tOPTIONS extends DCanvasContainerOptions<CANVAS, THEME> = DCanvasContainerOptions<CANVAS, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _canvas!: CANVAS | null;\n\tprotected _overflowMask!: DBaseOverflowMask | null;\n\tprotected _view!: DCanvasContainerView<CANVAS, THEME, OPTIONS>;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._canvas = null;\n\t\tconst theme = this.theme;\n\t\tthis._view = new DCanvasContainerView( this, theme, options );\n\n\t\t// Canvas\n\t\tthis.canvas = ( options && options.canvas ? options.canvas : null );\n\n\t\t// Overflow mask\n\t\tif( isOverflowMaskEnabled( theme, options ) ) {\n\t\t\tthis.mask = this.getOrCreateOverflowMask();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DCanvasContainer\";\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.updateContentSize( newWidth, newHeight, oldWidth, oldHeight );\n\t}\n\n\tget canvas(): CANVAS | null {\n\t\treturn this._canvas;\n\t}\n\n\tset canvas( canvas: CANVAS | null ) {\n\t\tconst previous = this._canvas;\n\t\tif( previous != null ) {\n\t\t\tthis._canvas = null;\n\t\t\tthis.removeChild( previous );\n\t\t\tthis.emit( \"unset\", previous, this );\n\t\t\tprevious.destroy();\n\t\t}\n\n\t\tthis._canvas = canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis.addChild( canvas );\n\t\t\tthis.emit( \"set\", canvas, this );\n\t\t\tthis._view.reset( 0 );\n\t\t} else {\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tprotected getOrCreateOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tprotected updateContentSize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst canvasX = canvas.x + (newWidth - oldWidth) * 0.5;\n\t\t\tconst canvasY = canvas.y + (newHeight - oldHeight) * 0.5;\n\t\t\tcanvas.position.set( canvasX, canvasY );\n\t\t}\n\t}\n\n\tget view(): DCanvasContainerView<CANVAS, THEME, OPTIONS> {\n\t\treturn this._view;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst vresult = this._view.onWheel( e, deltas, global );\n\t\tconst sresult = super.onWheel( e, deltas, global );\n\t\treturn vresult || sresult;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent ): boolean {\n\t\tconst vresult = this._view.onDblClick( e );\n\t\tconst sresult = super.onDblClick( e );\n\t\treturn vresult || sresult;\n\t}\n\n\tdestroy(): void {\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\t\tthis.mask = null;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase,  DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DCanvasOptions<THEME extends DThemeCanvas = DThemeCanvas> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeCanvas extends DThemeBase {\n\n}\n\nexport class DCanvas<\n\tTHEME extends DThemeCanvas = DThemeCanvas,\n\tOPTIONS extends DCanvasOptions<THEME> = DCanvasOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DCanvas\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisOptions, DChartAxisPosition, DChartAxisTickPosition } from \"./d-chart-axis\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points\";\nimport { EShapeStrokeLike } from \"./shape/e-shape-stroke\";\nimport { EShapeTextLike } from \"./shape/e-shape-text\";\nimport { EShapeTextAlignLike } from \"./shape/e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"./shape/e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"./shape/e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"./shape/e-shape-text-direction\";\nimport { EShapeTextOffsetLike } from \"./shape/e-shape-text-offset\";\nimport { EShapeTextOutlineLike } from \"./shape/e-shape-text-outline\";\nimport { EShapeBar } from \"./shape/variant/e-shape-bar\";\nimport { EShapeBarPosition } from \"./shape/variant/e-shape-bar-position\";\nimport { DeepPartial } from \"./util/deep-partial\";\nimport { NumberFormatter } from \"./util/number-formatter\";\nimport { NumberFormatters } from \"./util/number-formatters\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport interface DThemeChartAxisBase {\n\tgetPosition(): DChartAxisPosition;\n\tgetPadding(): number;\n\n\tgetLabelAlignHorizontal( position: DChartAxisPosition ): EShapeTextAlignHorizontal;\n\tgetLabelAlignVertical( position: DChartAxisPosition ): EShapeTextAlignVertical;\n\tgetLabelPaddingHorizontal(): number;\n\tgetLabelPaddingVertical(): number;\n\tgetLabelDirection(): EShapeTextDirection;\n\n\tgetTickEnable(): boolean;\n\n\tgetMajorTickCount(): number;\n\tgetMajorTickSize(): number;\n\tgetMajorTickPosition(): DChartAxisTickPosition;\n\tgetMajorTickStyle(): EShapePointsStyle;\n\tgetMajorTickTextAlignHorizontal( position: DChartAxisPosition ): EShapeTextAlignHorizontal;\n\tgetMajorTickTextAlignVertical( position: DChartAxisPosition ): EShapeTextAlignVertical;\n\tgetMajorTickTextDirection(): EShapeTextDirection;\n\tgetMajorTickTextFormat(): string;\n\tgetMajorTickTextPaddingHorizontal(): number;\n\tgetMajorTickTextPaddingVertical(): number;\n\n\tgetMinorTickCount(): number;\n\tgetMinorTickSize(): number;\n\tgetMinorTickPosition(): DChartAxisTickPosition;\n\tgetMinorTickStyle(): EShapePointsStyle;\n}\n\nexport interface DChartAxisBaseTickMajorOptions {\n\tcount?: number;\n\tsize?: number;\n\tposition?: DChartAxisTickPosition | keyof typeof DChartAxisTickPosition;\n\tstyle?: EShapePointsStyle | keyof typeof EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\ttext?: DeepPartial<EShapeTextLike>;\n}\n\nexport interface DChartAxisBaseTickMinorOptions {\n\tcount?: number;\n\tsize?: number;\n\tposition?: DChartAxisTickPosition | keyof typeof DChartAxisTickPosition;\n\tstyle?: EShapePointsStyle | keyof typeof EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n}\n\nexport interface DChartAxisBaseTickContainerOptions {\n\tenable?: boolean;\n\tposition?: DChartAxisTickPosition | keyof typeof DChartAxisTickPosition;\n\tstyle?: EShapePointsStyle | keyof typeof EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tmajor?: DChartAxisBaseTickMajorOptions;\n\tminor?: DChartAxisBaseTickMinorOptions;\n}\n\nexport interface DChartAxisBaseOptions extends DChartAxisOptions {\n\ttick?: DChartAxisBaseTickContainerOptions;\n\tlabel?: DeepPartial<EShapeTextLike>;\n\ttheme?: DThemeChartAxisBase;\n\tcoordinate?: number;\n\tpadding?: number;\n}\n\nexport interface DChartAxisBaseTickMajor {\n\tcount: number;\n\tsize: number;\n\tposition: EShapeBarPosition;\n\tstyle: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\ttext?: DeepPartial<EShapeTextLike>;\n\tformatter: NumberFormatter;\n\tshapes?: EShapeBar[];\n}\n\nexport interface DChartAxisBaseTickMinor {\n\tcount: number;\n\tsize: number;\n\tposition: EShapeBarPosition;\n\tstyle: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tshapes?: EShapeBar[];\n}\n\nexport interface DChartAxisBaseTickContainer {\n\tenable: boolean;\n\tmajor: DChartAxisBaseTickMajor;\n\tminor: DChartAxisBaseTickMinor;\n}\n\nexport class DChartAxisBaseOptionParser {\n\tprotected _coordinateIndex: number;\n\tprotected _position: DChartAxisPosition;\n\tprotected _tick: DChartAxisBaseTickContainer;\n\tprotected _label: DeepPartial<EShapeTextLike> | undefined;\n\tprotected _padding: number;\n\n\tconstructor( theme: DThemeChartAxisBase, options?: DChartAxisBaseOptions ) {\n\t\tthis._coordinateIndex = ( options && options.coordinate != null ? options.coordinate : 0 );\n\t\tthis._position = this.toPosition( theme, options );\n\t\tthis._tick = this.toTickContainer( theme, options );\n\t\tthis._label = this.toLabel( theme, options );\n\t\tthis._padding = ( options && options.padding != null ? options.padding : theme.getPadding() );\n\t}\n\n\tget coordinateIndex(): number {\n\t\treturn this._coordinateIndex;\n\t}\n\n\tget padding(): number {\n\t\treturn this._padding;\n\t}\n\n\tget position(): DChartAxisPosition {\n\t\treturn this._position;\n\t}\n\n\tget tick(): DChartAxisBaseTickContainer {\n\t\treturn this._tick;\n\t}\n\n\tget label(): DeepPartial<EShapeTextLike> | undefined {\n\t\treturn this._label;\n\t}\n\n\tprotected toPosition(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisPosition {\n\t\tconst position = options && options.position;\n\t\tif( utilIsString( position ) ) {\n\t\t\treturn DChartAxisPosition[ position ];\n\t\t} else if( position != null ) {\n\t\t\treturn position;\n\t\t}\n\t\treturn theme.getPosition();\n\t}\n\n\tprotected toTickContainer(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisBaseTickContainer {\n\t\tconst tick = options && options.tick;\n\t\treturn {\n\t\t\tenable: ( tick && tick.enable != null ? tick.enable : theme.getTickEnable() ),\n\t\t\tmajor: this.toTickMajor( theme, tick ),\n\t\t\tminor: this.toMinorTick( theme, tick )\n\t\t};\n\t}\n\n\tprotected toTickMajor(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickContainerOptions\n\t): DChartAxisBaseTickMajor {\n\t\tconst major: DChartAxisBaseTickMajorOptions | undefined = options && options.major;\n\t\tconst position = ( major && major.position != null ? major.position :\n\t\t\t( options && options.position != null ? options.position : theme.getMajorTickPosition() )\n\t\t);\n\t\tconst style = ( major && major.style != null ? major.style :\n\t\t\t( options && options.style != null ? options.style : theme.getMajorTickStyle() )\n\t\t);\n\t\treturn {\n\t\t\tcount: ( major && major.count != null ? major.count : theme.getMajorTickCount() ),\n\t\t\tsize: ( major && major.size != null ? major.size : theme.getMajorTickSize() ),\n\t\t\tposition: this.toTickPosition( position ),\n\t\t\tstyle: ( utilIsString( style ) ? EShapePointsStyle[ style ] : style ),\n\t\t\tstroke: this.toTickStroke( theme, major && major.stroke, options && options.stroke ),\n\t\t\ttext: this.toMajorTickText( theme, major && major.text ),\n\t\t\tformatter: this.toMajorTickFormatter( theme, major ),\n\t\t\tshapes: undefined\n\t\t};\n\t}\n\n\tprotected toTickPosition(\n\t\ttickPosition: DChartAxisTickPosition | keyof typeof DChartAxisTickPosition\n\t): EShapeBarPosition {\n\t\tconst position = this._position;\n\t\tif( tickPosition === DChartAxisTickPosition.OUTSIDE || tickPosition === \"OUTSIDE\" ) {\n\t\t\tswitch( position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\treturn EShapeBarPosition.BOTTOM;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\treturn EShapeBarPosition.RIGHT;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\treturn EShapeBarPosition.LEFT;\n\t\t\tdefault:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\t}\n\t\t} else {\n\t\t\tswitch( position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\treturn EShapeBarPosition.BOTTOM;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\treturn EShapeBarPosition.LEFT;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\treturn EShapeBarPosition.RIGHT;\n\t\t\tdefault:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toMinorTick(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickContainerOptions\n\t): DChartAxisBaseTickMinor {\n\t\tconst minor: DChartAxisBaseTickMajorOptions | undefined = options && options.major;\n\t\tconst position = ( minor && minor.position != null ? minor.position :\n\t\t\t( options && options.position != null ? options.position : theme.getMinorTickPosition() )\n\t\t);\n\t\tconst style = ( minor && minor.style != null ? minor.style :\n\t\t\t( options && options.style != null ? options.style : theme.getMinorTickStyle() )\n\t\t);\n\t\treturn {\n\t\t\tcount: ( minor && minor.count != null ? minor.count : theme.getMinorTickCount() ),\n\t\t\tsize: ( minor && minor.size != null ? minor.size : theme.getMinorTickSize() ),\n\t\t\tposition: this.toTickPosition( position ),\n\t\t\tstyle: ( utilIsString( style ) ? EShapePointsStyle[ style ] : style ),\n\t\t\tstroke: this.toTickStroke( theme, minor && minor.stroke, options && options.stroke ),\n\t\t\tshapes: undefined\n\t\t};\n\t}\n\n\tprotected toTickStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptionsA?: Partial<EShapeStrokeLike>,\n\t\toptionsB?: Partial<EShapeStrokeLike>\n\t): Partial<EShapeStrokeLike> | undefined {\n\t\tif( optionsA ) {\n\t\t\tif( optionsB ) {\n\t\t\t\treturn {\n\t\t\t\t\tenable: ( optionsA.enable != null ? optionsA.enable : optionsB.enable ),\n\t\t\t\t\tcolor: ( optionsA.color != null ? optionsA.color : optionsB.color ),\n\t\t\t\t\talpha: ( optionsA.alpha != null ? optionsA.alpha : optionsB.alpha ),\n\t\t\t\t\twidth: ( optionsA.width != null ? optionsA.width : optionsB.width ),\n\t\t\t\t\talign: ( optionsA.align != null ? optionsA.align : optionsB.align ),\n\t\t\t\t\tside: ( optionsA.side != null ? optionsA.side : optionsB.side )\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tenable: optionsA.enable,\n\t\t\t\t\tcolor: optionsA.color,\n\t\t\t\t\talpha: optionsA.alpha,\n\t\t\t\t\twidth: optionsA.width,\n\t\t\t\t\talign: optionsA.align,\n\t\t\t\t\tside: optionsA.side\n\t\t\t\t};\n\t\t\t}\n\t\t} else if( optionsB ) {\n\t\t\treturn {\n\t\t\t\tenable: optionsB.enable,\n\t\t\t\tcolor: optionsB.color,\n\t\t\t\talpha: optionsB.alpha,\n\t\t\t\twidth: optionsB.width,\n\t\t\t\talign: optionsB.align,\n\t\t\t\tside: optionsB.side\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickFormatter(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickMajorOptions\n\t): NumberFormatter {\n\t\tconst format = ( options && options.text && options.text.value );\n\t\treturn NumberFormatters.create( format != null ?\n\t\t\tformat : theme.getMajorTickTextFormat()\n\t\t);\n\t}\n\n\tprotected toMajorTickText(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DeepPartial<EShapeTextLike>\n\t): DeepPartial<EShapeTextLike> | undefined {\n\t\toptions = options || {};\n\t\treturn {\n\t\t\tvalue: options.value,\n\t\t\tcolor: options.color,\n\t\t\talpha: options.alpha,\n\t\t\tfamily: options.family,\n\t\t\tsize: options.size,\n\t\t\tweight: options.weight,\n\t\t\talign: this.toMajorTickTextAlign( theme, options.align ),\n\t\t\toffset: this.toMajorTickTextOffset( theme, options.offset ),\n\t\t\tstyle: options.style,\n\t\t\toutline: this.toMajorTickTextOutline( theme, options.outline ),\n\t\t\tspacing: this.toMajorTickTextSpacing( theme, options.spacing ),\n\t\t\tdirection: this.toTickMajorTextDirection( theme, options.direction ),\n\t\t\tpadding: this.toMajorTickTextPadding( theme, options.padding ),\n\t\t\tclipping: options.clipping\n\t\t};\n\t}\n\n\tprotected toMajorTickTextOutline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOutlineLike>\n\t): Partial<EShapeTextOutlineLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\tenable: options.enable,\n\t\t\t\tcolor: options.color,\n\t\t\t\talpha: options.alpha,\n\t\t\t\twidth: options.width\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextAlign(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextAlignLike>\n\t): Partial<EShapeTextAlignLike> | undefined {\n\t\tconst position = this._position;\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: ( options.horizontal != null ? options.horizontal : theme.getMajorTickTextAlignHorizontal( position ) ),\n\t\t\t\tvertical: ( options.vertical != null ? options.vertical : theme.getMajorTickTextAlignVertical( position ) )\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\thorizontal: theme.getMajorTickTextAlignHorizontal( position ),\n\t\t\tvertical: theme.getMajorTickTextAlignVertical( position )\n\t\t};\n\t}\n\n\tprotected toMajorTickTextOffset(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextSpacing(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextPadding(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> {\n\t\treturn {\n\t\t\thorizontal: ( options && options.horizontal != null ?\n\t\t\t\toptions.horizontal : theme.getMajorTickTextPaddingHorizontal()\n\t\t\t),\n\t\t\tvertical: ( options && options.vertical != null ?\n\t\t\t\toptions.vertical : theme.getMajorTickTextPaddingVertical()\n\t\t\t)\n\t\t};\n\t}\n\n\tprotected toTickMajorTextDirection(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: EShapeTextDirection\n\t): EShapeTextDirection {\n\t\treturn ( options != null ? options : theme.getMajorTickTextDirection() );\n\t}\n\n\tprotected toLabel(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DeepPartial<EShapeTextLike> | undefined {\n\t\tconst label = options && options.label;\n\t\tif( label ) {\n\t\t\treturn {\n\t\t\t\tvalue: label.value,\n\t\t\t\tcolor: label.color,\n\t\t\t\talpha: label.alpha,\n\t\t\t\tfamily: label.family,\n\t\t\t\tsize: label.size,\n\t\t\t\tweight: label.weight,\n\t\t\t\talign: this.toLabelAlign( theme, label.align ),\n\t\t\t\toffset: this.toLabelOffset( theme, label.offset ),\n\t\t\t\tstyle: label.style,\n\t\t\t\toutline: this.toLabelOutline( theme, label.outline ),\n\t\t\t\tspacing: this.toLabelSpacing( theme, label.spacing ),\n\t\t\t\tdirection: this.toLabelDirection( theme, label.direction ),\n\t\t\t\tpadding: this.toLabelPadding( theme, label.padding ),\n\t\t\t\tclipping: label.clipping\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelOutline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOutlineLike>\n\t): Partial<EShapeTextOutlineLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\tenable: options.enable,\n\t\t\t\tcolor: options.color,\n\t\t\t\talpha: options.alpha,\n\t\t\t\twidth: options.width\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelAlign(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextAlignLike>\n\t): Partial<EShapeTextAlignLike> | undefined {\n\t\tconst position = this._position;\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: ( options.horizontal != null ?\n\t\t\t\t\toptions.horizontal : theme.getLabelAlignHorizontal( position )\n\t\t\t\t),\n\t\t\t\tvertical: ( options.vertical != null ?\n\t\t\t\t\toptions.vertical : theme.getLabelAlignVertical( position )\n\t\t\t\t)\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\thorizontal: theme.getLabelAlignHorizontal( position ),\n\t\t\tvertical: theme.getLabelAlignVertical( position )\n\t\t};\n\t}\n\n\tprotected toLabelOffset(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelSpacing(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelPadding(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> {\n\t\treturn {\n\t\t\thorizontal: ( options && options.horizontal != null ?\n\t\t\t\toptions.horizontal : theme.getLabelPaddingHorizontal()\n\t\t\t),\n\t\t\tvertical: ( options && options.vertical != null ?\n\t\t\t\toptions.vertical : theme.getLabelPaddingVertical()\n\t\t\t)\n\t\t};\n\t}\n\n\tprotected toLabelDirection(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: EShapeTextDirection\n\t): EShapeTextDirection {\n\t\treturn ( options != null ? options : theme.getLabelDirection() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxis, DChartAxisPosition } from \"./d-chart-axis\";\nimport {\n\tDChartAxisBaseOptionParser, DChartAxisBaseOptions, DChartAxisBaseTickContainer, DThemeChartAxisBase\n} from \"./d-chart-axis-base-options\";\nimport { DChartAxisContainer } from \"./d-chart-axis-container\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points\";\nimport { EShapeTextLike } from \"./shape/e-shape-text\";\nimport { EShapeBar } from \"./shape/variant/e-shape-bar\";\nimport { EShapeBarPosition } from \"./shape/variant/e-shape-bar-position\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { DeepPartial } from \"./util/deep-partial\";\nimport { utilIsNaN } from \"./util/util-is-nan\";\n\nexport class DChartAxisBase implements DChartAxis {\n\tprotected _coordinateIndex: number;\n\tprotected _padding: number;\n\tprotected _position: DChartAxisPosition;\n\tprotected _container?: DChartAxisContainer;\n\tprotected _bar?: EShapeBar;\n\tprotected _index: number;\n\tprotected _tick: DChartAxisBaseTickContainer;\n\tprotected _majorTicks: Float64Array;\n\tprotected _minorTicks: Float64Array;\n\tprotected _label?: DeepPartial<EShapeTextLike>;\n\tprotected _theme: DThemeChartAxisBase;\n\n\tconstructor( options?: DChartAxisBaseOptions ) {\n\t\tconst theme = ( options && options.theme ) || this.getThemeDefault();\n\t\tthis._theme = theme;\n\t\tthis._index = 0;\n\n\t\tconst parser = new DChartAxisBaseOptionParser( theme, options );\n\t\tthis._coordinateIndex = parser.coordinateIndex;\n\t\tthis._padding = parser.padding;\n\t\tthis._position = parser.position;\n\t\tconst tick = parser.tick;\n\t\tthis._tick = tick;\n\t\tthis._label = parser.label;\n\t\tthis._majorTicks = new Float64Array( tick.major.count * 3 );\n\t\tthis._minorTicks = new Float64Array( (tick.major.count + 1) * tick.minor.count * 3 );\n\t}\n\n\tget position(): DChartAxisPosition {\n\t\treturn this._position;\n\t}\n\n\tprotected updateBar(): void {\n\t\tconst position = this._position;\n\t\tconst container = this._container;\n\t\tconst bar = this._bar;\n\t\tif( container && bar ) {\n\t\t\tconst plotAreaSize = container.plotArea.size;\n\t\t\tconst plotAreaSizeX = plotAreaSize.x;\n\t\t\tconst plotAreaSizeY = plotAreaSize.y;\n\t\t\tconst padding = this._padding * this._index;\n\t\t\tbar.disallowUploadedUpdate();\n\t\t\tswitch( position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\tbar.transform.position.set( plotAreaSizeX * 0.5, 0 - padding );\n\t\t\t\tbar.size.set( plotAreaSizeX, 0 );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\tbar.transform.position.set( plotAreaSizeX * 0.5, plotAreaSizeY + padding );\n\t\t\t\tbar.size.set( plotAreaSizeX, 0 );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\tbar.transform.position.set( 0 - padding, plotAreaSizeY * 0.5 );\n\t\t\t\tbar.size.set( 0, plotAreaSizeY );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\tbar.transform.position.set( plotAreaSizeX + padding, plotAreaSizeY * 0.5 );\n\t\t\t\tbar.size.set( 0, plotAreaSizeY );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbar.allowUploadedUpdate();\n\t\t}\n\t}\n\n\tupdateTicksX(\n\t\tcoordinate: DChartCoordinate,\n\t\tmajorShapes: EShapeBar[], minorShapes: EShapeBar[],\n\t\tshapePositionY: number\n\t): void {\n\t\tconst tick = this._tick;\n\t\tconst majorCount = tick.major.count;\n\t\tconst majorFormatter = tick.major.formatter;\n\t\tconst minorCountPerMajor = tick.minor.count;\n\t\tconst minorCount = (majorCount + 1) * minorCountPerMajor;\n\t\tconst majorTicks = this._majorTicks;\n\t\tconst minorTicks = this._minorTicks;\n\t\tcoordinate.ticks( majorCount, minorCountPerMajor, minorCount, majorTicks, minorTicks );\n\n\t\tfor( let i = 0; i < majorCount; ++i ) {\n\t\t\tconst majorShape = majorShapes[ i ];\n\t\t\tconst imajorTick = i * 3;\n\t\t\tconst majorTickPosition = majorTicks[ imajorTick + 0 ];\n\t\t\tconst majorTickProjectedPosition = majorTicks[ imajorTick + 1 ];\n\t\t\tconst majorTickStep = majorTicks[ imajorTick + 2 ];\n\t\t\tif( ! utilIsNaN( majorTickPosition ) ) {\n\t\t\t\tmajorShape.disallowUploadedUpdate();\n\t\t\t\tmajorShape.visible = true;\n\t\t\t\tmajorShape.transform.position.set( majorTickProjectedPosition, shapePositionY );\n\t\t\t\tmajorShape.text.value = majorFormatter.format( majorTickPosition, majorTickStep );\n\t\t\t\tmajorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tmajorShape.visible = false;\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\tconst minorShape = minorShapes[ i ];\n\t\t\tconst iminorTick = i * 3;\n\t\t\tconst minorTickPosition = minorTicks[ iminorTick + 0 ];\n\t\t\tconst minorTickProjectedPosition = minorTicks[ iminorTick + 1 ];\n\t\t\tif( ! utilIsNaN( minorTickPosition ) ) {\n\t\t\t\tminorShape.disallowUploadedUpdate();\n\t\t\t\tminorShape.visible = true;\n\t\t\t\tminorShape.transform.position.set( minorTickProjectedPosition, shapePositionY );\n\t\t\t\tminorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tminorShape.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTicksY(\n\t\tcoordinate: DChartCoordinate,\n\t\tmajorShapes: EShapeBar[], minorShapes: EShapeBar[],\n\t\tshapePositionX: number\n\t): void {\n\t\tconst tick = this._tick;\n\t\tconst majorCount = tick.major.count;\n\t\tconst majorFormatter = tick.major.formatter;\n\t\tconst minorCountPerMajor = tick.minor.count;\n\t\tconst minorCount = (majorCount + 1) * minorCountPerMajor;\n\t\tconst majorTicks = this._majorTicks;\n\t\tconst minorTicks = this._minorTicks;\n\t\tcoordinate.ticks( majorCount, minorCountPerMajor, minorCount, majorTicks, minorTicks );\n\n\t\tfor( let i = 0; i < majorCount; ++i ) {\n\t\t\tconst majorShape = majorShapes[ i ];\n\t\t\tconst imajorTick = i * 3;\n\t\t\tconst majorTickPosition = majorTicks[ imajorTick + 0 ];\n\t\t\tconst majorTickProjectedPosition = majorTicks[ imajorTick + 1 ];\n\t\t\tconst majorTickStep = majorTicks[ imajorTick + 2 ];\n\t\t\tif( ! utilIsNaN( majorTickPosition ) ) {\n\t\t\t\tmajorShape.disallowUploadedUpdate();\n\t\t\t\tmajorShape.visible = true;\n\t\t\t\tmajorShape.transform.position.set( shapePositionX, majorTickProjectedPosition );\n\t\t\t\tmajorShape.text.value = majorFormatter.format( majorTickPosition, majorTickStep );\n\t\t\t\tmajorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tmajorShape.visible = false;\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\tconst minorShape = minorShapes[ i ];\n\t\t\tconst iminorTick = i * 3;\n\t\t\tconst minorTickPosition = minorTicks[ iminorTick + 0 ];\n\t\t\tconst minorTickProjectedPosition = minorTicks[ iminorTick + 1 ];\n\t\t\tif( ! utilIsNaN( minorTickPosition ) ) {\n\t\t\t\tminorShape.disallowUploadedUpdate();\n\t\t\t\tminorShape.visible = true;\n\t\t\t\tminorShape.transform.position.set( shapePositionX, minorTickProjectedPosition );\n\t\t\t\tminorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tminorShape.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateTicks(): void {\n\t\tconst tick = this._tick;\n\t\tconst majorShapes = tick.major.shapes;\n\t\tconst minorShapes = tick.minor.shapes;\n\t\tconst container = this._container;\n\t\tif( majorShapes && minorShapes && container ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst coordinateIndex = this._coordinateIndex;\n\t\t\tlet coordinate: DChartCoordinate | null;\n\t\t\tconst padding = this._padding * this._index;\n\t\t\tswitch( this._position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\tcoordinate = plotArea.coordinate.x.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tthis.updateTicksX(\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes,\n\t\t\t\t\t\t0 - padding\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\tcoordinate = plotArea.coordinate.x.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tthis.updateTicksX(\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes,\n\t\t\t\t\t\tplotArea.size.y + padding\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\tcoordinate = plotArea.coordinate.y.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tthis.updateTicksY(\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes,\n\t\t\t\t\t\t0 - padding\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\tcoordinate = plotArea.coordinate.y.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tthis.updateTicksY(\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes,\n\t\t\t\t\t\tplotArea.size.x + padding\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartAxisContainer, index: number ): void {\n\t\tthis._container = container;\n\t\tthis._index = index;\n\t\tconst tickShapeContainer = container.container;\n\n\t\t// Bar\n\t\tlet bar = this._bar;\n\t\tif( ! bar ) {\n\t\t\tconst position = this._position;\n\t\t\tconst barPosition = ( position === DChartAxisPosition.LEFT || position === DChartAxisPosition.RIGHT ?\n\t\t\t\tEShapeBarPosition.TOP : EShapeBarPosition.LEFT\n\t\t\t);\n\t\t\tbar = new EShapeBar( barPosition, -1, EShapeDefaults.STROKE_WIDTH, EShapePointsStyle.NONE );\n\t\t\tbar.text.copy( this._label );\n\t\t\tthis._bar = bar;\n\t\t}\n\t\tbar.attach( container.container );\n\n\t\t// Major ticks\n\t\tconst tick = this._tick;\n\t\tconst tickMajor = tick.major;\n\t\tlet tickMajorShapes = tickMajor.shapes;\n\t\tif( ! tickMajorShapes && tick.enable ) {\n\t\t\ttickMajorShapes = [];\n\t\t\ttickMajor.shapes = tickMajorShapes;\n\t\t\tconst tickMajorCount = tickMajor.count;\n\t\t\tconst tickMajorSize = tickMajor.size;\n\t\t\tconst tickMajorPosition = tickMajor.position;\n\t\t\tconst tickMajorStyle = tickMajor.style;\n\t\t\tfor( let i = 0; i < tickMajorCount; ++i ) {\n\t\t\t\tconst tickMajorShape = new EShapeBar(\n\t\t\t\t\ttickMajorPosition,\n\t\t\t\t\ttickMajorSize,\n\t\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\t\ttickMajorStyle\n\t\t\t\t);\n\t\t\t\ttickMajorShape.stroke.copy( tickMajor.stroke );\n\t\t\t\ttickMajorShape.text.copy( tickMajor.text );\n\t\t\t\ttickMajorShape.size.set( 0, 0 );\n\t\t\t\ttickMajorShapes.push( tickMajorShape );\n\t\t\t}\n\t\t}\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinor = tick.minor;\n\t\tlet tickMinorShapes = tickMinor.shapes;\n\t\tif( ! tickMinorShapes && tick.enable ) {\n\t\t\ttickMinorShapes = [];\n\t\t\ttickMinor.shapes = tickMinorShapes;\n\t\t\tconst tickMinorCount = tickMinor.count;\n\t\t\tconst tickMinorSize = tickMinor.size;\n\t\t\tconst tickMinorPosition = tickMinor.position;\n\t\t\tconst tickMinorStyle = tickMinor.style;\n\t\t\tfor( let i = 0, imax = ( tickMajor.count + 1 ) * tickMinorCount; i < imax; ++i ) {\n\t\t\t\tconst tickMinorShape = new EShapeBar(\n\t\t\t\t\ttickMinorPosition,\n\t\t\t\t\ttickMinorSize,\n\t\t\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\t\t\ttickMinorStyle\n\t\t\t\t);\n\t\t\t\ttickMinorShape.stroke.copy( tickMinor.stroke );\n\t\t\t\ttickMinorShape.size.set( 0, 0 );\n\t\t\t\ttickMinorShapes.push( tickMinorShape );\n\t\t\t}\n\t\t}\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\t// Bar\n\t\tconst bar = this._bar;\n\t\tif( bar ) {\n\t\t\tbar.detach();\n\t\t}\n\n\t\t// Major ticks\n\t\tconst tick = this._tick;\n\t\tconst tickMajorShapes = tick.major.shapes;\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinorShapes = tick.minor.shapes;\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._container = undefined;\n\t}\n\n\tupdate(): void {\n\t\tthis.updateBar();\n\t\tthis.updateTicks();\n\t}\n\n\tdestroy(): void {\n\t\t// Bar\n\t\tconst bar = this._bar;\n\t\tif( bar ) {\n\t\t\tbar.destroy();\n\t\t}\n\n\t\t// Major ticks\n\t\tconst tick = this._tick;\n\t\tconst tickMajorShapes = tick.major.shapes;\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinorShapes = tick.minor.shapes;\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._container = undefined;\n\t}\n\n\tprotected getThemeDefault(): DThemeChartAxisBase {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartAxisBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxis, DChartAxisPosition } from \"./d-chart-axis\";\nimport { DChartAxisContainer, DChartAxisContainerOptions } from \"./d-chart-axis-container\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\nimport { utilIsNumber } from \"./util/util-is-number\";\n\nexport class DChartAxisContainerImpl implements DChartAxisContainer {\n\tprotected _plotArea: DChartPlotArea;\n\tprotected _container: EShapeContainer;\n\tprotected _list: Map<DChartAxisPosition, DChartAxis[]>;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartAxisContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tthis._container = new EShapeContainer();\n\n\t\tthis._list = new Map<DChartAxisPosition, DChartAxis[]>();\n\t\tconst list = options && options.list;\n\t\tif( list ) {\n\t\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\t\tthis.add( list[ i ] );\n\t\t\t}\n\t\t}\n\t}\n\n\tget container(): EShapeContainer {\n\t\treturn this._container;\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tadd( axis: DChartAxis ): void {\n\t\tconst list = this._list;\n\t\tlet axes = list.get( axis.position );\n\t\tif( axes == null ) {\n\t\t\taxes = [];\n\t\t\tlist.set( axis.position, axes );\n\t\t}\n\t\taxes.push( axis );\n\t\taxis.bind( this, axes.length - 1 );\n\t}\n\n\tget( position: DChartAxisPosition, index: number ): DChartAxis | null {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\tif( 0 <= index && index < axes.length ) {\n\t\t\t\treturn axes[ index ];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( axis: DChartAxis ): number {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( axis.position );\n\t\tif( axes ) {\n\t\t\treturn axes.indexOf( axis );\n\t\t}\n\t\treturn -1;\n\t}\n\n\tremove( axis: DChartAxis ): DChartAxis | null;\n\tremove( position: DChartAxisPosition, index: number ): DChartAxis | null;\n\tremove( axisOrPosition: DChartAxis | DChartAxisPosition, indexOrUndefined?: number ): DChartAxis | null {\n\t\tconst list = this._list;\n\t\tif( utilIsNumber( axisOrPosition ) ) {\n\t\t\tconst position: DChartAxisPosition = axisOrPosition;\n\t\t\tconst index = indexOrUndefined!;\n\t\t\tconst axes = list.get( position );\n\t\t\tif( axes ) {\n\t\t\t\tif( 0 <= index && index < axes.length ) {\n\t\t\t\t\tconst removed = axes.splice( index, 1 )[ 0 ];\n\t\t\t\t\tremoved.unbind();\n\t\t\t\t\tremoved.destroy();\n\t\t\t\t\treturn removed;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst axis = axisOrPosition;\n\t\t\tconst position: DChartAxisPosition = axis.position;\n\t\t\tconst axes = list.get( position );\n\t\t\tif( axes ) {\n\t\t\t\tconst index = axes.indexOf( axisOrPosition );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\taxes.splice( index, 1 );\n\t\t\t\t\taxis.unbind();\n\t\t\t\t\taxis.destroy();\n\t\t\t\t\treturn axis;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear( position: DChartAxisPosition ): this {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].destroy();\n\t\t\t}\n\t\t\taxes.length = 0;\n\t\t}\n\t\treturn this;\n\t}\n\n\tsize( position: DChartAxisPosition ): number {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\treturn axes.length;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tupdate(): void {\n\t\tthis._list.forEach(( axes: DChartAxis[] ): void => {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].update();\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy(): void {\n\t\tthis._list.forEach(( axes: DChartAxis[] ): void => {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].destroy();\n\t\t\t}\n\t\t\taxes.length = 0;\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisBase } from \"./d-chart-axis-base\";\n\nexport class DChartAxisX extends DChartAxisBase {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisX\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisBase } from \"./d-chart-axis-base\";\n\nexport class DChartAxisY extends DChartAxisBase {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisY\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"./util/util-rgb\";\n\nconst DCHART_COLOR_SET_1 = [\n\t0x10b7e3,\n\t0xfe5420,\n\t0xf0c312,\n\t0x1c5d71\n];\n\nconst DCHART_COLOR_SET_2 = [\n\tDCHART_COLOR_SET_1[ 0 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 0 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 1 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 1 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 2 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 2 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 3 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 3 ], 0.4 )\n];\n\nexport const DChartColorSet1 = ( index: number ): number => {\n\treturn DCHART_COLOR_SET_1[ index % DCHART_COLOR_SET_1.length ];\n};\n\nexport const DChartColorSet2 = ( index: number ): number => {\n\treturn DCHART_COLOR_SET_2[ index % DCHART_COLOR_SET_2.length ];\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainer } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { utilIsNumber } from \"./util\";\n\nexport class DChartCoordinateContainerSubImpl implements DChartCoordinateContainerSub {\n\tprotected _list: DChartCoordinate[];\n\tprotected _direction: DChartCoordinateDirection;\n\tprotected _container: DChartCoordinateContainer;\n\n\tconstructor( container: DChartCoordinateContainer, direction: DChartCoordinateDirection ) {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t\tthis._list = [];\n\t}\n\n\tget container(): DChartCoordinateContainer {\n\t\treturn this._container;\n\t}\n\n\tadd( coordinate: DChartCoordinate, index?: number ): this {\n\t\tconst list = this._list;\n\t\tif( index == null ) {\n\t\t\tlist.push( coordinate );\n\t\t} else if( 0 <= index && index < list.length ) {\n\t\t\tlist.splice( index, 0, coordinate );\n\t\t} else {\n\t\t\tlist.push( coordinate );\n\t\t}\n\t\tcoordinate.bind( this, this._direction );\n\t\treturn this;\n\t}\n\n\tget( index: number ): DChartCoordinate | null {\n\t\tconst list = this._list;\n\t\tif( 0 <= index && index < list.length ) {\n\t\t\treturn list[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( coordinate: DChartCoordinate ): number {\n\t\treturn this._list.indexOf( coordinate );\n\t}\n\n\tremove( coordinate: DChartCoordinate ): DChartCoordinate | null;\n\tremove( index: number ): DChartCoordinate | null;\n\tremove( coordinateOrIndex: DChartCoordinate | number ): DChartCoordinate | null {\n\t\tconst list = this._list;\n\t\tif( utilIsNumber( coordinateOrIndex ) ) {\n\t\t\tconst index = coordinateOrIndex;\n\t\t\tif( 0 <= index && index < list.length ) {\n\t\t\t\tconst removed = list.splice( index, 1 )[ 0 ];\n\t\t\t\tremoved.unbind();\n\t\t\t\treturn removed;\n\t\t\t}\n\t\t} else {\n\t\t\tconst coordinate = coordinateOrIndex;\n\t\t\tconst index = list.indexOf( coordinate );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tlist.splice( index, 1 );\n\t\t\t\tcoordinate.unbind();\n\t\t\t\treturn coordinate;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].unbind();\n\t\t}\n\t\tlist.length = 0;\n\t\treturn this;\n\t}\n\n\tdestroy(): this {\n\t\treturn this.clear();\n\t}\n\n\tsize(): number {\n\t\treturn this._list.length;\n\t}\n\n\tfit(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].fit();\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartAxisContainer, DChartAxisContainerOptions } from \"./d-chart-axis-container\";\nimport { DChartCoordinateContainer, DChartCoordinateContainerOptions } from \"./d-chart-coordinate-container\";\nimport { DChartSeriesContainer, DChartSeriesContainerOptions } from \"./d-chart-series-container\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\n\nexport enum DChartPlotAreaFitTarget {\n\tNONE\t= 0,\n\tDOMAIN\t= 1,\n\tRANGE\t= 2,\n\tBOTH\t= DOMAIN | RANGE\n}\n\nexport interface DChartPlotAreaOptions {\n\twidth?: number;\n\theight?: number;\n\tcoordinate?: DChartCoordinateContainerOptions;\n\tseries?: DChartSeriesContainerOptions;\n\taxis?: DChartAxisContainerOptions;\n}\n\nexport interface DChartPlotArea {\n\treadonly series: DChartSeriesContainer;\n\treadonly coordinate: DChartCoordinateContainer;\n\treadonly container: EShapeContainer;\n\treadonly size: IPoint;\n\treadonly axis: DChartAxisContainer;\n\n\tdestroy(): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainer, DChartCoordinateContainerOptions } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateContainerSubImpl } from \"./d-chart-coordinate-container-sub-impl\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { utilIsArray } from \"./util/util-is-array\";\n\nexport class DChartCoordinateContainerImpl implements DChartCoordinateContainer {\n\tprotected _x: DChartCoordinateContainerSub;\n\tprotected _y: DChartCoordinateContainerSub;\n\tprotected _plotArea: DChartPlotArea;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartCoordinateContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tconst x = this._x = new DChartCoordinateContainerSubImpl( this, DChartCoordinateDirection.X );\n\t\tconst y = this._y = new DChartCoordinateContainerSubImpl( this, DChartCoordinateDirection.Y );\n\t\tif( options ) {\n\t\t\tconst cxs = options.x;\n\t\t\tif( cxs ) {\n\t\t\t\tif( utilIsArray( cxs ) ) {\n\t\t\t\t\tfor( let i = 0, imax = cxs.length; i < imax; ++i ) {\n\t\t\t\t\t\tx.add( cxs[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tx.add( cxs );\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst cys = options.y;\n\t\t\tif( cys ) {\n\t\t\t\tif( utilIsArray( cys ) ) {\n\t\t\t\t\tfor( let i = 0, imax = cys.length; i < imax; ++i ) {\n\t\t\t\t\t\ty.add( cys[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ty.add( cys );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget x(): DChartCoordinateContainerSub {\n\t\treturn this._x;\n\t}\n\n\tget y(): DChartCoordinateContainerSub {\n\t\treturn this._y;\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tfit(): this {\n\t\tthis._x.fit();\n\t\tthis._y.fit();\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartRegion } from \"./d-chart-region\";\n\nexport class DChartRegionImplObservable implements DChartRegion {\n\tprotected _from: number;\n\tprotected _to: number;\n\tprotected _onChange: () => void;\n\n\tconstructor( from: number, to: number, onChange: () => void ) {\n\t\tthis._from = from;\n\t\tthis._to = to;\n\t\tthis._onChange = onChange;\n\t}\n\n\tget from(): number {\n\t\treturn this._from;\n\t}\n\n\tset from( from: number ) {\n\t\tthis.set( from, undefined );\n\t}\n\n\tget to(): number {\n\t\treturn this._to;\n\t}\n\n\tset to( to: number ) {\n\t\tthis.set( undefined, to );\n\t}\n\n\tset( from?: number, to?: number ): this {\n\t\tlet isChanged = false;\n\n\t\tif( from != null && this._from !== from ) {\n\t\t\tthis._from = from;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( to != null && this._to !== to ) {\n\t\t\tthis._to = to;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._onChange();\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImplObservable } from \"./d-chart-region-impl-observable\";\nimport { DThemes } from \"./theme\";\nimport { utilIsNaN } from \"./util/util-is-nan\";\n\nexport interface DThemeChartCoordinateLinear {\n\tgetPadding(): number;\n\tisZero( value: number ): boolean;\n\ttoStepScale( scale: number ): number;\n}\n\nexport interface DChartCoordinateLinearOptions {\n\tpadding?: number;\n\tdomain?: {\n\t\tfrom?: number;\n\t\tto?: number;\n\t};\n\trange?: {\n\t\tfrom?: number;\n\t\tto?: number;\n\t};\n\ttheme?: DThemeChartCoordinateLinear;\n}\n\nexport class DChartCoordinateLinear implements DChartCoordinate {\n\tprotected _id: number;\n\tprotected _padding: number;\n\tprotected _domain: DChartRegionImplObservable;\n\tprotected _range: DChartRegionImplObservable;\n\n\tprotected _container?: DChartCoordinateContainerSub;\n\tprotected _direction: DChartCoordinateDirection;\n\n\tprotected _ratio!: number;\n\tprotected _offset!: number;\n\tprotected _iratio!: number;\n\tprotected _ioffset!: number;\n\n\tprotected _theme: DThemeChartCoordinateLinear;\n\n\tconstructor( options?: DChartCoordinateLinearOptions ) {\n\t\tconst theme = ( options && options.theme ) || this.getThemeDefault();\n\t\tthis._theme = theme;\n\t\tthis._id = 0;\n\t\tthis._padding = ( options && options.padding != null ? options.padding : theme.getPadding() );\n\t\tthis._direction = DChartCoordinateDirection.X;\n\t\tconst domainFrom = ( options && options.domain && options.domain.from != null ? options.domain.from : 0 );\n\t\tconst domainTo = ( options && options.domain && options.domain.to != null ? options.domain.to : 1 );\n\t\tthis._domain = new DChartRegionImplObservable( domainFrom, domainTo, (): void => {\n\t\t\tthis.onRegionChange();\n\t\t});\n\t\tconst rangeFrom = ( options && options.range && options.range.from != null ? options.range.from : 0 );\n\t\tconst rangeTo = ( options && options.range && options.range.to != null ? options.range.to : 1 );\n\t\tthis._range = new DChartRegionImplObservable( rangeFrom, rangeTo, (): void => {\n\t\t\tthis.onRegionChange();\n\t\t});\n\t\tthis.onRegionChange();\n\t}\n\n\tprotected getThemeDefault(): DThemeChartCoordinateLinear {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartCoordinateLinear\";\n\t}\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t}\n\n\tunbind(): void {\n\t\tthis._container = undefined;\n\t}\n\n\tfit(): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst plotArea = container.container.plotArea;\n\t\t\tconst padding = this._padding;\n\t\t\tswitch( this._direction ) {\n\t\t\tcase DChartCoordinateDirection.X:\n\t\t\t\tconst domain = plotArea.series.domain;\n\t\t\t\tconst domainFrom = domain.from;\n\t\t\t\tconst domainTo = domain.to;\n\t\t\t\tif( ! (utilIsNaN( domainFrom ) || utilIsNaN( domainTo )) ) {\n\t\t\t\t\tthis._domain.set( domainFrom, domainTo );\n\t\t\t\t\tlet pixelFrom = padding;\n\t\t\t\t\tlet pixelTo = plotArea.size.x - padding;\n\t\t\t\t\tif( pixelTo < pixelFrom ) {\n\t\t\t\t\t\tpixelFrom = plotArea.size.x * 0.5;\n\t\t\t\t\t\tpixelTo = pixelFrom;\n\t\t\t\t\t}\n\t\t\t\t\tthis._range.set( pixelFrom, pixelTo );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartCoordinateDirection.Y:\n\t\t\t\tconst range = plotArea.series.range;\n\t\t\t\tconst rangeFrom = range.from;\n\t\t\t\tconst rangeTo = range.to;\n\t\t\t\tif( ! (utilIsNaN( rangeFrom ) || utilIsNaN( rangeTo )) ) {\n\t\t\t\t\tthis._domain.set( rangeFrom, rangeTo );\n\t\t\t\t\tlet pixelFrom = plotArea.size.y - padding;\n\t\t\t\t\tlet pixelTo = padding;\n\t\t\t\t\tif( pixelFrom < pixelTo ) {\n\t\t\t\t\t\tpixelFrom = plotArea.size.y * 0.5;\n\t\t\t\t\t\tpixelTo = pixelFrom;\n\t\t\t\t\t}\n\t\t\t\t\tthis._range.set( pixelFrom, pixelTo );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onRegionChange(): void {\n\t\tthis._id += 1;\n\t\tconst domain = this._domain;\n\t\tconst range = this._range;\n\t\tconst domainSpan = domain.to - domain.from;\n\t\tconst rangeSpan = range.to - range.from;\n\t\tconst theme = this._theme;\n\t\tthis._ratio = ( theme.isZero( domainSpan ) ? 0 : rangeSpan / domainSpan );\n\t\tthis._offset = range.from - this._ratio * domain.from;\n\t\tthis._iratio = ( theme.isZero( rangeSpan ) ? 0 : domainSpan / rangeSpan );\n\t\tthis._ioffset = domain.from - this._iratio * range.from;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget domain(): DChartRegion {\n\t\treturn this._domain;\n\t}\n\n\tget range(): DChartRegion {\n\t\treturn this._range;\n\t}\n\n\tmap( value: number ): number {\n\t\treturn this._offset + this._ratio * value;\n\t}\n\n\tunmap( value: number ): number {\n\t\treturn this._ioffset + this._iratio * value;\n\t}\n\n\tprotected calcStepMajor( count: number ): number {\n\t\tif( 0 < count ) {\n\t\t\tconst domain = this._domain;\n\t\t\tconst span = Math.abs( domain.to - domain.from ) / count;\n\t\t\tconst power = Math.floor( Math.log( span ) / Math.LN10 );\n\t\t\tconst base = Math.pow( 10, power );\n\t\t\treturn this._theme.toStepScale( span / base ) * base;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected calcStepMinor( step: number, minorCount: number ): number {\n\t\tif( 0 <= step ) {\n\t\t\treturn step / ( minorCount + 1 );\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tprotected calcTickMinorPositions(\n\t\tstep: number, count: number, majorPosition: number,\n\t\trangeMin: number, rangeMax: number,\n\t\tiresult: number, result: Float64Array\n\t): void {\n\t\tfor( let i = 0; i < count; i += 1 ) {\n\t\t\tconst minorPosition = majorPosition + (i + 1) * step;\n\t\t\tif( rangeMin <= minorPosition && minorPosition <= rangeMax ) {\n\t\t\t\tresult[ iresult++ ] = minorPosition;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getRangeMax(): number {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst plotAreaSize = container.container.plotArea.size;\n\t\t\tswitch( this._direction ) {\n\t\t\tcase DChartCoordinateDirection.X:\n\t\t\t\treturn plotAreaSize.x;\n\t\t\tcase DChartCoordinateDirection.Y:\n\t\t\t\treturn plotAreaSize.y;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tticks(\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void {\n\t\tif( majorCount <= 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst domain = this._domain;\n\t\tconst domainMin = Math.min( domain.from, domain.to );\n\t\tconst domainMax = Math.max( domain.from, domain.to );\n\n\t\tconst majorStep = this.calcStepMajor( majorCount );\n\t\tif( majorStep <= 0 ) {\n\t\t\tmajorResult[ 0 ] = domainMin;\n\t\t\tmajorResult[ 1 ] = this.map( domainMin );\n\t\t\tmajorResult[ 2 ] = 0;\n\t\t\tfor( let i = 1; i < majorCount; ++i ) {\n\t\t\t\tconst imajorResult = i * 3;\n\t\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\t\tconst iminorResult = i * 3;\n\t\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Range\n\t\tconst rangeMin = 0;\n\t\tconst rangeMax = this.getRangeMax();\n\n\t\t// Major tick start position\n\t\tconst idomainStart = Math.floor( domainMin / majorStep ) - 1;\n\t\tconst idomainEnd = Math.ceil( domainMax / majorStep ) + 1;\n\n\t\t// Major / minor tick positions\n\t\tconst minorStep = this.calcStepMinor( majorStep, minorCountPerMajor );\n\t\tlet imajor = 0;\n\t\tlet iminor = 0;\n\t\tfor( let i = idomainStart; i <= idomainEnd; ++i ) {\n\t\t\tconst majorPosition = i * majorStep;\n\t\t\tif( imajor < majorCount ) {\n\t\t\t\tconst majorProjectedPosition = this.map( majorPosition );\n\t\t\t\tif( rangeMin <= majorProjectedPosition && majorProjectedPosition <= rangeMax ) {\n\t\t\t\t\tconst imajorResult = imajor * 3;\n\t\t\t\t\tmajorResult[ imajorResult + 0 ] = majorPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 1 ] = majorProjectedPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 2 ] = majorStep;\n\t\t\t\t\timajor += 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let j = 0; j < minorCountPerMajor; j += 1 ) {\n\t\t\t\tif( iminor < minorCount ) {\n\t\t\t\t\tconst minorPosition = majorPosition + (j + 1) * minorStep;\n\t\t\t\t\tconst minorProjectedPosition = this.map( minorPosition );\n\t\t\t\t\tif( rangeMin <= minorProjectedPosition && minorProjectedPosition <= rangeMax ) {\n\t\t\t\t\t\tconst iminorResult = iminor * 3;\n\t\t\t\t\t\tminorResult[ iminorResult + 0 ] = minorPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 1 ] = minorProjectedPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 2 ] = minorStep;\n\t\t\t\t\t\timinor += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor( let i = imajor; i < majorCount; ++i ) {\n\t\t\tconst imajorResult = i * 3;\n\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t}\n\t\tfor( let i = iminor; i < minorCount; ++i ) {\n\t\t\tconst iminorResult = i * 3;\n\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartRegion } from \"./d-chart-region\";\nimport { utilIsNaN } from \"./util/util-is-nan\";\n\nexport class DChartRegionImpl implements DChartRegion {\n\tfrom: number;\n\tto: number;\n\n\tconstructor( from: number, to: number ) {\n\t\tthis.from = from;\n\t\tthis.to = to;\n\t}\n\n\tset( from?: number, to?: number ): this {\n\t\tif( from != null ) {\n\t\t\tthis.from = from;\n\t\t}\n\t\tif( to != null ) {\n\t\t\tthis.to = to;\n\t\t}\n\t\treturn this;\n\t}\n\n\tclear(): this {\n\t\tthis.from = NaN;\n\t\tthis.to = NaN;\n\t\treturn this;\n\t}\n\n\tadd( from: number, to: number ): this {\n\t\tif( ! utilIsNaN( from ) ) {\n\t\t\tthis.from = ( utilIsNaN( this.from ) ?\n\t\t\t\tfrom : Math.min( this.from, from )\n\t\t\t);\n\t\t}\n\n\t\tif( ! utilIsNaN( to ) ) {\n\t\t\tthis.to = ( utilIsNaN( this.to ) ?\n\t\t\t\tto : Math.max( this.to, to )\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartColorSet2 } from \"./d-chart-color-set\";\nimport { DChartSeriesScalar } from \"./d-chart-series-scalar\";\nimport { DChartSeriesStroke, DChartSeriesStrokeOptions, DChartSeriesStrokeStyleOption } from \"./d-chart-series-stroke\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points\";\nimport { utilIsArray } from \"./util/util-is-array\";\nimport { utilIsFunction } from \"./util/util-is-function\";\n\nexport class DChartSeriesStrokeImpl implements DChartSeriesStroke {\n\twidth: DChartSeriesScalar<number>;\n\tcolor: DChartSeriesScalar<number>;\n\talpha: DChartSeriesScalar<number>;\n\tstyle: DChartSeriesScalar<DChartSeriesStrokeStyleOption>;\n\n\tconstructor( options?: DChartSeriesStrokeOptions ) {\n\t\tthis.width = this.toScalar( options && options.width, EShapeDefaults.STROKE_WIDTH );\n\t\tthis.color = this.toScalar( options && options.color, DChartColorSet2 );\n\t\tthis.alpha = this.toScalar( options && options.alpha, EShapeDefaults.STROKE_ALPHA );\n\t\tthis.style = this.toScalar( options && options.style, EShapePointsStyle.NONE );\n\t}\n\n\tprotected toScalar<T>(\n\t\tvalue: T | T[] | DChartSeriesScalar<T> | undefined,\n\t\tdef: T | T[] | DChartSeriesScalar<T>\n\t): DChartSeriesScalar<T> {\n\t\tif( utilIsArray( value ) ) {\n\t\t\treturn ( index: number ) => value[ index % value.length ];\n\t\t} else if( utilIsFunction( value ) ) {\n\t\t\treturn value;\n\t\t} else if( value != null ) {\n\t\t\treturn () => value;\n\t\t} else if( utilIsArray( def ) ) {\n\t\t\treturn ( index: number ) => def[ index % def.length ];\n\t\t} else if( utilIsFunction( def ) ) {\n\t\t\treturn def;\n\t\t} else {\n\t\t\treturn () => def;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer, DChartSeriesContainerOptions } from \"./d-chart-series-container\";\nimport { DChartSeriesStroke } from \"./d-chart-series-stroke\";\nimport { DChartSeriesStrokeImpl } from \"./d-chart-series-stroke-impl\";\nimport { utilIsNumber } from \"./util\";\n\nexport class DChartSeriesContainerImpl implements DChartSeriesContainer {\n\tprotected _plotArea: DChartPlotArea;\n\tprotected _list: DChartSeries[];\n\tprotected _domain: DChartRegionImpl;\n\tprotected _range: DChartRegionImpl;\n\tprotected _stroke: DChartSeriesStrokeImpl;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartSeriesContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tthis._domain = new DChartRegionImpl( NaN, NaN );\n\t\tthis._range = new DChartRegionImpl( NaN, NaN );\n\t\tthis._stroke = new DChartSeriesStrokeImpl( options && options.stroke );\n\n\t\tthis._list = [];\n\t\tconst list = options && options.list;\n\t\tif( list ) {\n\t\t\tconst listLength = list.length;\n\t\t\tif( 0 < listLength ) {\n\t\t\t\tfor( let i = 0; i < listLength; ++i ) {\n\t\t\t\t\tthis.add( list[ i ] );\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tget stroke(): DChartSeriesStroke {\n\t\treturn this._stroke;\n\t}\n\n\tupdate(): void {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].update();\n\t\t}\n\t}\n\n\tadd( series: DChartSeries ): void {\n\t\tconst list = this._list;\n\t\tseries.bind( this, list.length );\n\t\tlist.push( series );\n\t}\n\n\tget( index: number ): DChartSeries | null {\n\t\tconst list = this._list;\n\t\tif( 0 <= index && index < list.length ) {\n\t\t\treturn list[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( series: DChartSeries ): number {\n\t\treturn this._list.indexOf( series );\n\t}\n\n\tremove( series: DChartSeries ): DChartSeries | null;\n\tremove( index: number ): DChartSeries | null;\n\tremove( seriesOrIndex: DChartSeries | number ): DChartSeries | null {\n\t\tconst list = this._list;\n\t\tif( utilIsNumber( seriesOrIndex ) ) {\n\t\t\tconst index = seriesOrIndex;\n\t\t\tif( 0 <= index && index < list.length ) {\n\t\t\t\tconst removed = list.splice( index, 1 )[ 0 ];\n\t\t\t\tremoved.unbind();\n\t\t\t\tremoved.destroy();\n\t\t\t\treturn removed;\n\t\t\t}\n\t\t} else {\n\t\t\tconst series = seriesOrIndex;\n\t\t\tconst index = list.indexOf( series );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tlist.splice( index, 1 );\n\t\t\t\tseries.unbind();\n\t\t\t\tseries.destroy();\n\t\t\t\treturn series;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].destroy();\n\t\t}\n\t\tlist.length = 0;\n\t\treturn this;\n\t}\n\n\tsize(): number {\n\t\treturn this._list.length;\n\t}\n\n\tdestroy(): void {\n\t\tthis.clear();\n\t}\n\n\tget domain(): DChartRegion {\n\t\tconst result = this._domain;\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst domain = list[ i ].domain;\n\t\t\tresult.add( domain.from, domain.to );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tget range(): DChartRegion {\n\t\tconst result = this._range;\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst range = list[ i ].range;\n\t\t\tresult.add( range.from, range.to );\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { DChartAxisContainer } from \"./d-chart-axis-container\";\nimport { DChartAxisContainerImpl } from \"./d-chart-axis-container-impl\";\nimport { DChartCoordinateContainer } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerImpl } from \"./d-chart-coordinate-container-impl\";\nimport { DChartPlotArea, DChartPlotAreaOptions } from \"./d-chart-plot-area\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesContainerImpl } from \"./d-chart-series-container-impl\";\nimport { EShapeContainer } from \"./shape\";\n\nexport class DChartPlotAreaImpl implements DChartPlotArea {\n\tprotected _container: EShapeContainer;\n\tprotected _series: DChartSeriesContainerImpl;\n\tprotected _coordinate: DChartCoordinateContainer;\n\tprotected _size: Point;\n\tprotected _axis: DChartAxisContainerImpl;\n\n\tconstructor( options?: DChartPlotAreaOptions ) {\n\t\tthis._size = new Point(\n\t\t\toptions && options.width != null ? options.width : 100,\n\t\t\toptions && options.height != null ? options.height : 100\n\t\t);\n\t\tthis._container = new EShapeContainer();\n\t\tthis._coordinate = new DChartCoordinateContainerImpl( this, options && options.coordinate );\n\t\tthis._series = new DChartSeriesContainerImpl( this, options && options.series );\n\t\tthis._axis = new DChartAxisContainerImpl( this, options && options.axis );\n\t}\n\n\tget coordinate(): DChartCoordinateContainer {\n\t\treturn this._coordinate;\n\t}\n\n\tget series(): DChartSeriesContainer {\n\t\treturn this._series;\n\t}\n\n\tget container(): EShapeContainer {\n\t\treturn this._container;\n\t}\n\n\tget size(): IPoint {\n\t\treturn this._size;\n\t}\n\n\tget axis(): DChartAxisContainer {\n\t\treturn this._axis;\n\t}\n\n\tdestroy(): void {\n\t\tthis._container.destroy();\n\t\tthis._series.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartRegionImmutable } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke\";\nimport { EShapePointsStyle } from \"./shape\";\nimport { EShapeLine } from \"./shape/variant/e-shape-line\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport interface DChartSeriesLineOptions {\n\tpoints?: Array<number | null>;\n\tstroke?: DChartSeriesStrokeComputedOptions;\n\tcoordinate?: {\n\t\tx?: number;\n\t\ty?: number;\n\t};\n}\n\nexport class DChartSeriesLine implements DChartSeries {\n\tprotected _line?: EShapeLine;\n\tprotected _coordinateIndexX: number;\n\tprotected _coordinateIndexY: number;\n\n\tprotected _points: Array<number | null>;\n\tprotected _pointId: number;\n\tprotected _pointIdUpdated: number;\n\n\tprotected _coordinateIdUpdatedX: number;\n\tprotected _coordinateIdUpdatedY: number;\n\n\tprotected _container?: DChartSeriesContainer;\n\n\tprotected _domain: DChartRegionImpl;\n\tprotected _range: DChartRegionImpl;\n\tprotected _regionPointId: number;\n\n\tprotected _options?: DChartSeriesLineOptions;\n\n\tconstructor( options?: DChartSeriesLineOptions ) {\n\t\tconst coordinate = options && options.coordinate;\n\t\tthis._coordinateIndexX = ( coordinate && coordinate.x != null ? coordinate.x : 0 );\n\t\tthis._coordinateIndexY = ( coordinate && coordinate.y != null ? coordinate.y : 0 );\n\n\t\tthis._points = (options && options.points) || [];\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\n\t\tthis._coordinateIdUpdatedX = NaN;\n\t\tthis._coordinateIdUpdatedY = NaN;\n\n\t\tthis._domain = new DChartRegionImpl( NaN, NaN );\n\t\tthis._range = new DChartRegionImpl( NaN, NaN );\n\t\tthis._regionPointId = NaN;\n\n\t\tthis._options = options;\n\t}\n\n\tprotected toStroke( container: DChartSeriesContainer, index: number ): DChartSeriesStrokeComputed {\n\t\tconst options = this._options;\n\t\tconst stroke = options && options.stroke;\n\t\tconst containerStroke = container.stroke;\n\t\tif( stroke ) {\n\t\t\tconst style = ( stroke.style != null ? stroke.style : containerStroke.style( index ) );\n\t\t\treturn {\n\t\t\t\twidth: ( stroke.width != null ? stroke.width : containerStroke.width( index ) ),\n\t\t\t\tcolor: ( stroke.color != null ? stroke.color : containerStroke.color( index ) ),\n\t\t\t\talpha: ( stroke.alpha != null ? stroke.alpha : containerStroke.alpha( index ) ),\n\t\t\t\tstyle: ( utilIsString( style ) ? EShapePointsStyle[ style ] : style )\n\t\t\t};\n\t\t} else {\n\t\t\tconst style = containerStroke.style( index );\n\t\t\treturn {\n\t\t\t\twidth: containerStroke.width( index ),\n\t\t\t\tcolor: containerStroke.color( index ),\n\t\t\t\talpha: containerStroke.alpha( index ),\n\t\t\t\tstyle: ( utilIsString( style ) ? EShapePointsStyle[ style ] : style )\n\t\t\t};\n\t\t}\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tlet line = this._line;\n\t\tif( ! line ) {\n\t\t\tconst stroke = this.toStroke( container, index );\n\t\t\tline = this._line = new EShapeLine([], [], stroke.width, stroke.style);\n\t\t\tline.stroke.color = stroke.color;\n\t\t\tline.stroke.alpha = stroke.alpha;\n\t\t}\n\t\tthis._container = container;\n\t\tline.attach( container.plotArea.container, index );\n\t\tthis._pointIdUpdated = NaN;\n\t\tthis._coordinateIdUpdatedX = NaN;\n\t\tthis._coordinateIdUpdatedY = NaN;\n\t}\n\n\tunbind(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tline.detach();\n\t\t}\n\t\tthis._container = undefined;\n\t}\n\n\tget points(): Array<number | null> {\n\t\treturn this._points;\n\t}\n\n\tset points( points: Array<number | null> ) {\n\t\tthis._points = points;\n\t\tthis._pointId += 1;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._pointId += 1;\n\t}\n\n\tupdate(): void {\n\t\tconst line = this._line;\n\t\tconst container = this._container;\n\t\tif( line && container ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst coordinate = plotArea.coordinate;\n\t\t\tconst coordinateX = coordinate.x.get( this._coordinateIndexX );\n\t\t\tconst coordinateY = coordinate.y.get( this._coordinateIndexY );\n\t\t\tif( coordinateX && coordinateY ) {\n\t\t\t\tconst coordinateIdX = coordinateX.id;\n\t\t\t\tconst coordinateIdY = coordinateY.id;\n\n\t\t\t\tconst pointId = this._pointId;\n\t\t\t\tconst isPointChanged = ( pointId !== this._pointIdUpdated );\n\t\t\t\tconst isCoordinateXChanged = ( coordinateIdX !== this._coordinateIdUpdatedX );\n\t\t\t\tconst isCoordinateYChanged = ( coordinateIdY !== this._coordinateIdUpdatedY );\n\t\t\t\tif( isPointChanged || isCoordinateXChanged || isCoordinateYChanged ) {\n\t\t\t\t\tthis._pointIdUpdated = pointId;\n\t\t\t\t\tthis._coordinateIdUpdatedX = coordinateIdX;\n\t\t\t\t\tthis._coordinateIdUpdatedY = coordinateIdY;\n\t\t\t\t\tthis.updateLine( line, coordinateX, coordinateY );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLine(\n\t\tline: EShapeLine,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate\n\t): void {\n\t\tconst values = line.points.values;\n\t\tconst segments = line.points.segments;\n\t\tconst valuesLength = values.length;\n\t\tconst segmentsLength = segments.length;\n\t\tlet ivalues = 0;\n\t\tlet isegments = 0;\n\t\tconst points = this._points;\n\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\tconst xraw = points[ i ];\n\t\t\tconst yraw = points[ i + 1 ];\n\t\t\tif( xraw != null && yraw != null ) {\n\t\t\t\tconst x = xcoordinate.map( xraw );\n\t\t\t\tconst y = ycoordinate.map( yraw );\n\t\t\t\tif( ivalues < valuesLength ) {\n\t\t\t\t\tvalues[ ivalues ] = x;\n\t\t\t\t\tvalues[ ivalues + 1 ] = y;\n\t\t\t\t} else {\n\t\t\t\t\tvalues.push( x, y );\n\t\t\t\t}\n\t\t\t\tivalues += 2;\n\t\t\t} else {\n\t\t\t\tconst segment = (i >> 1) - isegments;\n\t\t\t\tif( isegments < segmentsLength ) {\n\t\t\t\t\tsegments[ isegments ] = segment;\n\t\t\t\t} else {\n\t\t\t\t\tsegments.push( segment );\n\t\t\t\t}\n\t\t\t\tisegments += 1;\n\t\t\t}\n\t\t}\n\t\tif( values.length !== ivalues ) {\n\t\t\tvalues.length = ivalues;\n\t\t}\n\t\tif( segments.length !== isegments ) {\n\t\t\tsegments.length = isegments;\n\t\t}\n\t\tline.points.set( values, segments );\n\t\tDApplications.update();\n\t}\n\n\tget domain(): DChartRegionImmutable {\n\t\tthis.updateRegion();\n\t\treturn this._domain;\n\t}\n\n\tget range(): DChartRegionImmutable {\n\t\tthis.updateRegion();\n\t\treturn this._range;\n\t}\n\n\tprotected updateRegion(): void {\n\t\tconst pointId = this._pointId;\n\t\tif( this._regionPointId !== pointId ) {\n\t\t\tthis._regionPointId = pointId;\n\n\t\t\tconst points = this._points;\n\t\t\tconst domain = this._domain;\n\t\t\tconst range = this._range;\n\t\t\tdomain.clear();\n\t\t\trange.clear();\n\t\t\tif( points != null ) {\n\t\t\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\t\t\tconst xraw = points[ i ];\n\t\t\t\t\tif( xraw != null ) {\n\t\t\t\t\t\tdomain.add( xraw, xraw );\n\t\t\t\t\t}\n\t\t\t\t\tconst yraw = points[ i + 1 ];\n\t\t\t\t\tif( yraw != null ) {\n\t\t\t\t\t\trange.add( yraw, yraw );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tthis._line = undefined;\n\t\t\tline.detach();\n\t\t\tline.destroy();\n\t\t}\n\n\t\tthis._container = undefined;\n\t\tthis._points.length = 0;\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t\tthis._coordinateIdUpdatedX = NaN;\n\t\tthis._coordinateIdUpdatedY = NaN;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\n\nexport enum DListSelectionMode {\n\tNONE,\n\tSINGLE,\n\tMULTIPLE\n}\n\nexport interface DListSelectionOptions {\n\tmode?: DListSelectionMode;\n\ton?: { [ name: string ]: Function };\n}\n\nexport class DListSelection extends utils.EventEmitter {\n\tprotected _content: Container;\n\tprotected _isDirty: boolean;\n\tprotected _indices: number[];\n\tprotected _mode: DListSelectionMode;\n\n\tconstructor( content: Container, options?: DListSelectionOptions ) {\n\t\tsuper();\n\n\t\tthis._content = content;\n\t\tthis._isDirty = false;\n\t\tthis._indices = [];\n\t\tthis._mode = ( options && options.mode != null ? options.mode : DListSelectionMode.SINGLE );\n\n\t\t// Events\n\t\tconst on = options && options.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tupdate() {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tconst indices = this._indices;\n\t\t\tindices.length = 0;\n\t\t\tconst content = this._content;\n\t\t\tconst children = content.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tif( child.isActive() ) {\n\t\t\t\t\t\tindices.push( i );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsize() {\n\t\tthis.update();\n\t\treturn this._indices.length;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this.size() <= 0;\n\t}\n\n\tfirst<T>(): T | null {\n\t\treturn this.get( 0 );\n\t}\n\n\tget<T>( index: number ): T | null {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 <= index && index < indices.length ) {\n\t\t\tconst content = this._content;\n\t\t\tconst child = content.children[ indices[ index ] ];\n\t\t\tif( child != null ) {\n\t\t\t\treturn child as any;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetIndex( index: number ): number | null {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 <= index && index < indices.length ) {\n\t\t\treturn indices[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): void {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.length ) {\n\t\t\tconst content = this._content;\n\t\t\tconst children = content.children;\n\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ indices[ i ] ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.setActive( false );\n\t\t\t\t}\n\t\t\t}\n\t\t\tindices.length = 0;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tadd<T extends DBase<any, any>>( target: T ) {\n\t\tconst mode = this._mode;\n\t\tconst content = this._content;\n\t\tif( mode === DListSelectionMode.SINGLE ) {\n\t\t\tif( ! target.isActive() ) {\n\t\t\t\tthis.update();\n\n\t\t\t\t// Remove the existing\n\t\t\t\tconst indices = this._indices;\n\t\t\t\tconst children = content.children;\n\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\tconst child = children[ indices[ i ] ];\n\t\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\t\tchild.setActive( false );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tindices.length = 0;\n\n\t\t\t\t// Add a new child\n\t\t\t\tindices.push( content.getChildIndex( target ) );\n\t\t\t\ttarget.setActive( true );\n\n\t\t\t\t// Event\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t} else if( mode === DListSelectionMode.MULTIPLE ) {\n\t\t\tif( ! target.isActive() ) {\n\t\t\t\tif( this._isDirty ) {\n\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t} else {\n\t\t\t\t\t// Find an insertion position\n\t\t\t\t\tconst indices = this._indices;\n\t\t\t\t\tconst targetIndex = content.getChildIndex( target );\n\t\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst index = indices[ i ];\n\t\t\t\t\t\tif( targetIndex === index ) {\n\t\t\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else if( targetIndex < index ) {\n\t\t\t\t\t\t\tindices.splice( i, 0, targetIndex );\n\t\t\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Push\n\t\t\t\t\tindices.push( targetIndex );\n\t\t\t\t\ttarget.setActive( true );\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tremove<T extends DBase<any, any>>( target: T ) {\n\t\tif( ! target.isActive() ) {\n\t\t\tif( this._isDirty ) {\n\t\t\t\ttarget.setActive( false );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t} else {\n\t\t\t\tconst indices = this._indices;\n\t\t\t\tconst content = this._content;\n\t\t\t\tconst targetIndex = content.getChildIndex( target );\n\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\tconst index = indices[ i ];\n\t\t\t\t\tif( targetIndex === index ) {\n\t\t\t\t\t\tindices.splice( i, 1 );\n\t\t\t\t\t\ttarget.setActive( false );\n\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DChartPlotArea, DChartPlotAreaOptions} from \"./d-chart-plot-area\";\nimport { DChartPlotAreaImpl } from \"./d-chart-plot-area-impl\";\n\nexport interface DChartOptions<THEME extends DThemeChart> extends DBaseOptions<THEME> {\n\tplotArea: DChartPlotAreaOptions;\n}\n\nexport interface DThemeChart extends DThemeBase {\n}\n\nexport class DChart<\n\tTHEME extends DThemeChart = DThemeChart,\n\tOPTIONS extends DChartOptions<THEME> = DChartOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _plotArea!: DChartPlotArea;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tconst plotArea = new DChartPlotAreaImpl( options && options.plotArea );\n\t\tthis._plotArea = plotArea;\n\t\tthis.addChild( plotArea.container );\n\t\tthis.addChild( plotArea.axis.container );\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChart\";\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis._plotArea.destroy();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport abstract class DCommandCreate implements DCommand {\n\tabstract execute(): Promise<unknown> | boolean;\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandDelete implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().delete();\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandSaveAs implements DCommand {\n\tprotected _name: string;\n\n\tconstructor( name: string ) {\n\t\tthis._name = name;\n\t}\n\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().saveAs( this._name );\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandSave implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().save();\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\n\nexport interface DContentOptions extends DBaseOptions<DThemeContent> {\n\n}\n\nexport interface DThemeContent extends DThemeBase {\n\n}\n\nexport class DContent extends DBase<DThemeContent, DContentOptions> {\n\tprotected init( options?: DContentOptions ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected initReflowable(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DContent\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { ObservablePoint } from \"pixi.js\";\nimport { DMapTileMappingPoint } from \"./d-map-tile-mapping\";\n\nexport class DDiagramCanvasTileMappingPointImpl extends ObservablePoint implements DMapTileMappingPoint {\n\tget lon(): number {\n\t\treturn this.x;\n\t}\n\n\tset lon( lon: number ) {\n\t\tthis.x = lon;\n\t}\n\n\tget lat(): number {\n\t\treturn this.y;\n\t}\n\n\tset lat( lat: number ) {\n\t\tthis.y = lat;\n\t}\n\n\ttoObject(): { lon: number, lat: number } {\n\t\treturn {\n\t\t\tlon: this.x,\n\t\t\tlat: this.y\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\nimport { DDiagramCanvasTileMappingPointImpl } from \"./d-diagram-canvas-mapping-point-impl\";\nimport { DMapTileMappingPoint } from \"./d-map-tile-mapping\";\n\nexport class DDiagramCanvasTileMappingImpl implements DDiagramCanvasTileMapping {\n\tprotected _enable: boolean;\n\tprotected _from: DDiagramCanvasTileMappingPointImpl;\n\tprotected _to: DDiagramCanvasTileMappingPointImpl;\n\tprotected _cb: () => void;\n\n\tconstructor( cb: () => void, mapping?: DDiagramCanvasTileMapping );\n\tconstructor( cb: () => void, enable: boolean, lon0: number, lat0: number, lon1: number, lat1: number );\n\tconstructor(\n\t\tcb: () => void,\n\t\tmappingOrEnable?: DDiagramCanvasTileMapping | boolean,\n\t\tlon0?: number,\n\t\tlat0?: number,\n\t\tlon1?: number,\n\t\tlat1?: number\n\t) {\n\t\tthis._cb = cb;\n\t\tif( mappingOrEnable === true || mappingOrEnable === false ) {\n\t\t\tthis._enable = mappingOrEnable;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, lon0, lat0 );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, lon1, lat1 );\n\t\t} else if( mappingOrEnable != null ) {\n\t\t\tthis._enable = mappingOrEnable.enable;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, mappingOrEnable.from.lon, mappingOrEnable.from.lat );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, mappingOrEnable.to.lon, mappingOrEnable.to.lat );\n\t\t} else {\n\t\t\tthis._enable = false;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, -180, +85.05112877980659 );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, +180, -85.05112877980659 );\n\t\t}\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._cb();\n\t\t}\n\t}\n\n\tget from(): DMapTileMappingPoint {\n\t\treturn this._from;\n\t}\n\n\tget to(): DMapTileMappingPoint {\n\t\treturn this._to;\n\t}\n\n\tserialize(): DDiagramCanvasTileMapping {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tfrom: this._from.toObject(),\n\t\t\tto: this._to.toObject()\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\nimport { DDiagramCanvasTileMappingImpl } from \"./d-diagram-canvas-mapping-impl\";\nimport { DMapTilePyramid } from \"./d-map-tile-pyramid\";\n\nexport type DDiagramCanvasTilePyramidFactory = ( canvas: DDiagramCanvasBase<any, any> ) => DMapTilePyramid;\n\nexport interface DDiagramCanvasTileOptions {\n\tfactory?: DDiagramCanvasTilePyramidFactory;\n\tmapping?: DDiagramCanvasTileMapping;\n}\n\nexport class DDiagramCanvasTile {\n\tprotected _canvas: DDiagramCanvasBase<any, any>;\n\tprotected _pyramid?: DMapTilePyramid;\n\tprotected _factory?: DDiagramCanvasTilePyramidFactory;\n\tprotected _mapping: DDiagramCanvasTileMappingImpl;\n\n\tconstructor( canvas: DDiagramCanvasBase<any, any>, options?: DDiagramCanvasTileOptions ) {\n\t\tthis._canvas = canvas;\n\t\tthis._factory = options && options.factory;\n\t\tthis._mapping = new DDiagramCanvasTileMappingImpl((): void => {\n\t\t\tthis.onMappingChange();\n\t\t}, options && options.mapping );\n\t}\n\n\tinit(): void {\n\t\tthis.onMappingChange();\n\t}\n\n\tprotected onMappingChange(): void {\n\t\tconst factory = this._factory;\n\t\tif( factory ) {\n\t\t\tconst mapping = this._mapping;\n\t\t\tif( mapping.enable ) {\n\t\t\t\tconst pyramid = this._pyramid;\n\t\t\t\tif( pyramid ) {\n\t\t\t\t\tpyramid.mapping = mapping;\n\t\t\t\t} else {\n\t\t\t\t\tthis._pyramid = factory( this._canvas ).fit();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst pyramid = this._pyramid;\n\t\t\t\tif( pyramid ) {\n\t\t\t\t\tthis._pyramid = undefined;\n\t\t\t\t\tpyramid.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget pyramid(): DMapTilePyramid | undefined {\n\t\treturn this._pyramid;\n\t}\n\n\tget factory(): DDiagramCanvasTilePyramidFactory | undefined {\n\t\treturn this._factory;\n\t}\n\n\tget mapping(): DDiagramCanvasTileMapping {\n\t\treturn this._mapping;\n\t}\n\n\tserialize(): { mapping: DDiagramCanvasTileMapping } {\n\t\treturn {\n\t\t\tmapping: this._mapping.serialize()\n\t\t};\n\t}\n\n\tdestroy(): void {\n\t\tconst pyramid = this._pyramid;\n\t\tif( pyramid != null ) {\n\t\t\tthis._pyramid = undefined;\n\t\t\tpyramid.destroy();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem, DDiagramSerializedLayer } from \"./d-diagram-serialized\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\n\nexport class DDiagramLayer extends EShapeContainer {\n\treference: number;\n\n\tconstructor( name: string ) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.interactive = false;\n\t\tthis.reference = 0;\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tchildren[ i ].destroy();\n\t\t\t}\n\t\t\tchildren.length = 0;\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\tserialize(\n\t\tlayer: number, manager: EShapeResourceManagerSerialization, items: DDiagramSerializedItem[]\n\t): DDiagramSerializedLayer {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst shape = children[ i ];\n\t\t\tconst item = shape.serialize( manager );\n\t\t\titem[ 16 ] = layer;\n\t\t\titems.push( item );\n\t\t}\n\n\t\treturn [\n\t\t\tthis.name || \"\"\n\t\t];\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramLayer } from \"./d-diagram-layer\";\nimport { DDiagramSerializedItem, DDiagramSerializedLayer } from \"./d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\n\nexport class DDiagramLayerContainer extends Container {\n\tpublic children!: DDiagramLayer[];\n\tprotected _active: DDiagramLayer | null;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._active = null;\n\t\tthis.interactive = false;\n\t\tthis.interactiveChildren = false;\n\t}\n\n\tget active(): DDiagramLayer | null {\n\t\treturn this._active;\n\t}\n\n\tset active( layer: DDiagramLayer | null ) {\n\t\tif( this._active !== layer && (layer == null || 0 <= this.children.indexOf( layer )) ) {\n\t\t\tthis._active = layer;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tcreate( name: string, activate?: boolean ): DDiagramLayer {\n\t\tconst result = new DDiagramLayer( name );\n\t\tthis.attach( result, activate );\n\t\treturn result;\n\t}\n\n\t/**\n\t * Adds the specified layer and activates it if the `activate` is true.\n\t *\n\t * @param layer\n\t * @param activate\n\t */\n\tattach( layer: DDiagramLayer, activate?: boolean ): void {\n\t\tthis.addChild( layer );\n\t\tif( activate === true ) {\n\t\t\tthis._active = layer;\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tDApplications.update();\n\t}\n\n\tattachAt( layer: DDiagramLayer, index: number, activate?: boolean ): void {\n\t\tthis.addChildAt( layer, index );\n\t\tif( activate === true ) {\n\t\t\tthis._active = layer;\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tDApplications.update();\n\t}\n\n\t/**\n\t * Removes the specified layer from this container and activates the specified layer.\n\t * This method does not destroy the secified layer.\n\t *\n\t * @param layer\n\t */\n\tdetach( layer: DDiagramLayer, active: DDiagramLayer | null ): void {\n\t\tconst children = this.children;\n\t\tconst index = children.indexOf( layer );\n\t\tif( 0 <= index ) {\n\t\t\tthis._active = active;\n\n\t\t\tchildren.splice( index, 1 );\n\t\t\t(layer as any).parent = undefined;\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\t/**\n\t * Removes the specified layer and activate the next layer.\n\t * This method does not destroy the specified layer.\n\t *\n\t * @param layer\n\t * @param activateNext\n\t */\n\tdelete( layer: DDiagramLayer, activateNext?: boolean ): number {\n\t\tconst children = this.children;\n\t\tconst index = children.indexOf( layer );\n\t\tif( 0 <= index ) {\n\t\t\tchildren.splice( index, 1 );\n\t\t\t(layer as any).parent = undefined;\n\n\t\t\tif( this._active === layer ) {\n\t\t\t\tif( activateNext === true ) {\n\t\t\t\t\tif( index < children.length ) {\n\t\t\t\t\t\tthis._active = children[ index ];\n\t\t\t\t\t} else if( 0 < children.length ) {\n\t\t\t\t\t\tthis._active = children[ index - 1 ];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._active = null;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._active = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update();\n\t\t}\n\t\treturn index;\n\t}\n\n\tget( index: number ): DDiagramLayer | null {\n\t\tconst child = this.children[ index ];\n\t\tif( child != null ) {\n\t\t\treturn child;\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): void {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\t(child as any).parent = null;\n\t\t\t\tchild.destroy();\n\t\t\t}\n\t\t\tchildren.length = 0;\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis.clear();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this.children.length;\n\t}\n\n\tserialize(\n\t\tmanager: EShapeResourceManagerSerialization, items: DDiagramSerializedItem[]\n\t): DDiagramSerializedLayer[] {\n\t\tconst result: DDiagramSerializedLayer[] = [];\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tresult.push( child.serialize( i, manager, items ) );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DCanvas, DCanvasOptions, DThemeCanvas } from \"./d-canvas\";\nimport { DDiagramCanvasTile, DDiagramCanvasTileOptions } from \"./d-diagram-canvas-tile\";\nimport { DDiagramLayerContainer } from \"./d-diagram-layer-container\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport interface DDiagramCanvasBaseOptions<\n\tTHEME extends DThemeDiagramCanvasBase = DThemeDiagramCanvasBase\n> extends DCanvasOptions<THEME> {\n\ttile?: DDiagramCanvasTileOptions;\n}\n\nexport interface DThemeDiagramCanvasBase extends DThemeCanvas {\n\n}\n\nexport class DDiagramCanvasBase<\n\tTHEME extends DThemeDiagramCanvasBase = DThemeDiagramCanvasBase,\n\tOPTIONS extends DDiagramCanvasBaseOptions<THEME> = DDiagramCanvasBaseOptions<THEME>\n> extends DCanvas<THEME, OPTIONS> {\n\tprotected _layer: DDiagramLayerContainer;\n\tprotected _tile: DDiagramCanvasTile;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst layer = new DDiagramLayerContainer();\n\t\tthis._layer = layer;\n\t\tthis.addChild( layer );\n\n\t\tconst tile = this._tile = new DDiagramCanvasTile( this, options && options.tile );\n\t\ttile.init();\n\t}\n\n\tget tile(): DDiagramCanvasTile {\n\t\treturn this._tile;\n\t}\n\n\tget layer(): DDiagramLayerContainer {\n\t\treturn this._layer;\n\t}\n\n\tinitialize( shapes: EShape[] ): void {\n\t\t// DO NOTHING\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis._tile.destroy();\n\t\t\tthis._layer.destroy();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\thitTest( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst layers = this._layer.children;\n\t\tfor( let i = layers.length - 1; 0 <= i; --i ) {\n\t\t\tconst layer = layers[ i ];\n\t\t\tconst shape = layer.hitTest( global, handler );\n\t\t\tif( shape != null ) {\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvasBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramCanvasBase, DDiagramCanvasBaseOptions, DThemeDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramSerialized, DDiagramSerializedItem, DDiagramSerializedVersion } from \"./d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\nimport { ESnapper } from \"./snapper/e-snapper\";\nimport { ESnapperTargetValueType } from \"./snapper/e-snapper-target-value\";\n\nexport interface DDiagramCanvasEditorOptions<\n\tTHEME extends DThemeDiagramCanvasEditor = DThemeDiagramCanvasEditor\n> extends DDiagramCanvasBaseOptions<THEME> {\n\tsnapper: ESnapper;\n}\n\nexport interface DThemeDiagramCanvasEditor extends DThemeDiagramCanvasBase {\n\n}\n\nexport class DDiagramCanvasEditor<\n\tTHEME extends DThemeDiagramCanvasEditor = DThemeDiagramCanvasEditor,\n\tOPTIONS extends DDiagramCanvasEditorOptions<THEME> = DDiagramCanvasEditorOptions<THEME>\n> extends DDiagramCanvasBase<THEME, OPTIONS> {\n\tprotected _snapper: ESnapper;\n\tprotected _snapperGraphics: Graphics;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.shadow = this.theme.newShadowWeak();\n\n\t\tconst snapperGraphics = new Graphics();\n\t\tsnapperGraphics.visible = false;\n\t\tthis.addChildAt( snapperGraphics, this.children.length - 1 );\n\t\tthis._snapperGraphics = snapperGraphics;\n\n\t\tconst snapper = options.snapper;\n\t\tsnapper.target.on( \"change\", (): void => {\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update();\n\t\t});\n\t\tthis._snapper = snapper;\n\t}\n\n\tserialize( id: number | undefined ): DDiagramSerialized {\n\t\tconst manager = new EShapeResourceManagerSerialization();\n\t\tconst items: DDiagramSerializedItem[] = [];\n\t\tconst background = this.background;\n\t\treturn {\n\t\t\tversion: DDiagramSerializedVersion,\n\t\t\tid,\n\t\t\tname: this.name,\n\t\t\twidth: this.width,\n\t\t\theight: this.height,\n\t\t\tbackground: {\n\t\t\t\tcolor: background.getColor( 0 ),\n\t\t\t\talpha: background.getAlpha( 0 )\n\t\t\t},\n\t\t\ttile: this._tile.serialize(),\n\t\t\tresources: manager.serialize(),\n\t\t\tlayers: this._layer.serialize( manager, items ),\n\t\t\titems,\n\t\t\tsnap: this._snapper.serialize()\n\t\t};\n\t}\n\n\tonReflow(): void {\n\t\tsuper.onReflow();\n\n\t\tconst snapperGraphics = this._snapperGraphics;\n\t\tconst target = this._snapper.target;\n\t\tif( target.visible ) {\n\t\t\tconst borderColor = 0x1e87f0;\n\t\t\tconst borderWidth = 1;\n\t\t\tconst borderAlpha = 0.5;\n\t\t\tconst width = this.width + 0.5;\n\t\t\tconst height = this.height + 0.5;\n\t\t\tconst values = target.values;\n\t\t\tsnapperGraphics.clear();\n\t\t\tsnapperGraphics.lineStyle( 0, 0, 0, 0 );\n\t\t\tsnapperGraphics.beginFill( borderColor, borderAlpha );\n\t\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\t\tconst value = values[ i ];\n\t\t\t\tif( value.type === ESnapperTargetValueType.VERTICAL ) {\n\t\t\t\t\tsnapperGraphics.drawRect( value.position, 0, borderWidth, height );\n\t\t\t\t} else {\n\t\t\t\t\tsnapperGraphics.drawRect( 0, value.position, width, borderWidth );\n\t\t\t\t}\n\t\t\t}\n\t\t\tsnapperGraphics.endFill();\n\t\t\tsnapperGraphics.visible = true;\n\t\t} else {\n\t\t\tsnapperGraphics.visible = false;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvasEditor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\n\nexport const DDiagramSerializedVersion = 1;\n\nexport interface DDiagramSerializedTagRange {\n\t[ 0 ]: number; // type\n\t[ 1 ]: number; // from\n\t[ 2 ]: number; // to\n}\n\nexport interface DDiagramSerializedTagValue {\n\t[ 0 ]: number; // id (Stored as a resouce)\n\t[ 1 ]: number; // initial value (Stored as a resource)\n\t[ 2 ]: number; // format (Stored as a resouce)\n\t[ 3 ]: number; // Range (Stored as a resource)\n\t[ 4 ]: number; // Capacity\n\t[ 5 ]: number; // Order\n}\n\nexport interface DDiagramSerializedFill {\n\t[ 0 ]: number; // enable (0: false, 1: true)\n\t[ 1 ]: number; // color\n\t[ 2 ]: number; // alpha\n}\n\nexport interface DDiagramSerializedStroke {\n\t[ 0 ]: number; // enable (0: false, 1: true)\n\t[ 1 ]: number; // color\n\t[ 2 ]: number; // alpha\n\t[ 3 ]: number; // width\n\t[ 4 ]: number; // align\n\t[ 5 ]: number; // side\n}\n\nexport interface DDiagramSerializedTextOutline {\n\t[ 0 ]: number; // enable (0: false, 1: true)\n\t[ 1 ]: number; // color\n\t[ 2 ]: number; // alpha\n\t[ 3 ]: number; // width\n}\n\nexport interface DDiagramSerializedText {\n\t[  0 ]: number; // value (Stored as a resouce)\n\t[  1 ]: number; // color\n\t[  2 ]: number; // alpha\n\t[  3 ]: number; // family (Stored as a resouce)\n\t[  4 ]: number; // size\n\t[  5 ]: number; // weight (0: normal, 1: bold)\n\t[  6 ]: number; // align (Stored as a resource)\n\t[  7 ]: number; // margin (Stored as a resource)\n\t[  8 ]: number; // style (0: normal, 1: italic)\n\t[  9 ]: number; // outline (Stored as a resource)\n\t[ 10 ]: number; // spacing (Stored as a resource)\n\t[ 11 ]: number; // direction\n\t[ 12 ]: number; // padding\n\t[ 13 ]: number; // clipping (0: false, 1: true)\n}\n\nexport interface DDiagramSerializedItem {\n\t[  0 ]: number; // type\n\t[  1 ]: number; // id (Stored as resource)\n\t[  2 ]: number; // x\n\t[  3 ]: number; // y\n\t[  4 ]: number; // width\n\t[  5 ]: number; // height\n\t[  6 ]: number; // rotation\n\t[  7 ]: number; // skew\n\t[  8 ]: number; // fill (Stored as a resource)\n\t[  9 ]: number; // stroke (Stored as a resource)\n\t[ 10 ]: number; // cursor (Stored as a resource)\n\t[ 11 ]: number; // text (Stored as a resource)\n\t[ 12 ]: number; // tag (Stored as a resource)\n\t[ 13 ]: number; // radius\n\t[ 14 ]: number; // Corner\n\t[ 15 ]: number; // resource (Stored as a resouce)\n\t[ 16 ]: number; // layer\n\t[ 17 ]: number[]; // actions\n\t[ 18 ]: number; // Image (Stored as a resource)\n\t[ 19 ]: number; // Gradient\n\t[ 20 ]: DDiagramSerializedItem[];\n\t[ 21 ]: number; // pivot x\n\t[ 22 ]: number; // pivot y\n\t[ 23 ]: number; // (interactive ? 1 : 0) | (unfocusable ? 2 : 0)\n\t[ 24 ]: number; // shortcut\n\t[ 25 ]: number; // title\n}\n\nexport interface DDiagramSerializedLayer {\n\t[ 0 ]: string;\n}\n\nexport interface DDiagramSerializedSnapTargetValue {\n\t[ 0 ]: number; // 0: Horizontal, 1: Vertical\n\t[ 1 ]: number; // Position\n}\n\nexport interface DDiagramSerializedSnapTarget {\n\t[ 0 ]: number; // Snap on guide (0: Off, 1: On)\n\t[ 1 ]: number; // Visibility (0: Invisible, 1: Visible)\n\t[ 2 ]: DDiagramSerializedSnapTargetValue[]; // Snap targets\n}\n\nexport interface DDiagramSerializedSnapGrid {\n\t[ 0 ]: number; // Snap on grid (0: Off, 1: On)\n\t[ 1 ]: number; // Grid size\n}\n\nexport interface DDiagramSerializedSnap {\n\t[ 0 ]: number; // Snap (0: Off, 1: On)\n\t[ 1 ]: DDiagramSerializedSnapTarget;\n\t[ 2 ]: DDiagramSerializedSnapGrid;\n}\n\nexport interface DDiagramSerialized {\n\tversion: number;\n\tid?: number;\n\tname: string;\n\twidth: number;\n\theight: number;\n\tbackground?: {\n\t\tcolor?: number | null,\n\t\talpha?: number\n\t};\n\ttile?: {\n\t\tmapping?: DDiagramCanvasTileMapping;\n\t};\n\tresources: string[];\n\tlayers: DDiagramSerializedLayer[];\n\titems: DDiagramSerializedItem[];\n\tsnap?: DDiagramSerializedSnap;\n}\n\nexport interface DDiagramSerializedSimple {\n\tversion: number;\n\tid: number | undefined;\n\tname: string;\n\tdata: string;\n}\n\nexport interface DDiagramSerializedName {\n\tid: number;\n\tname: string;\n}\n\nexport interface DDiagramSerializedTag {\n\tgid: number;\n\tid: string;\n\tsource: string;\n\tdevice: string;\n\tsensor: string;\n\ttype: string;\n\tinterval: number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DControllers } from \"./d-controllers\";\nimport { DDiagramCanvasBase, DDiagramCanvasBaseOptions, DThemeDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeTagValue } from \"./shape/e-shape-tag-value\";\nimport { EShapeBase } from \"./shape/variant/e-shape-base\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\ninterface Tags { [ id: string ]: EShapeTagValue[]; }\ninterface Ids { [ id: string ]: EShape[] | undefined; }\n\nexport interface DDiagramCanvasOptions<\n\tTHEME extends DThemeDiagramCanvas = DThemeDiagramCanvas\n> extends DDiagramCanvasBaseOptions<THEME> {\n\n}\n\nexport interface DThemeDiagramCanvas extends DThemeDiagramCanvasBase {\n\n}\n\nexport class DDiagramCanvas<\n\tTHEME extends DThemeDiagramCanvas = DThemeDiagramCanvas,\n\tOPTIONS extends DDiagramCanvasOptions<THEME> = DDiagramCanvasOptions<THEME>\n> extends DDiagramCanvasBase<THEME, OPTIONS> {\n\ttags: Tags;\n\tinteractives: EShape[];\n\tactionables: EShape[];\n\tids: Ids;\n\n\tprotected _work: Point;\n\tprotected _lastOverShape: EShape | null;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.tags = {};\n\t\tthis.interactives = [];\n\t\tthis.actionables = [];\n\t\tthis.ids = {};\n\t\tthis._work = new Point();\n\t\tthis._lastOverShape = null;\n\t}\n\n\tinitialize(): void {\n\t\tconst time = Date.now();\n\t\tconst tags = this.tags;\n\t\tconst interactives = this.interactives;\n\t\tconst actionables = this.actionables;\n\t\tconst ids = this.ids;\n\t\tconst layers = this._layer.children;\n\n\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\tthis.initializeShapes( layers[ i ].children, tags, interactives, actionables, ids );\n\t\t}\n\n\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\tthis.updateShapes( layers[ i ].children, time );\n\t\t}\n\n\t\tthis.initializeFocus();\n\t}\n\n\tprotected initializeFocus(): void {\n\t\tconst focusController = DControllers.getFocusController();\n\t\tconst focusable = focusController.findFocusable( this, false, true, true );\n\t\tif( focusable != null ) {\n\t\t\tfocusController.setFocused( focusable, true, true );\n\t\t}\n\t}\n\n\tprotected initializeShapes(\n\t\tshapes: EShape[], tags: Tags, interactives: EShape[], actionables: EShape[], ids: Ids\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\t// Tag mappings\n\t\t\tconst tag = shape.tag;\n\t\t\tfor( let j = 0, jmax = tag.size(); j < jmax; ++j ) {\n\t\t\t\tconst value = tag.get( j );\n\t\t\t\tif( value != null ) {\n\t\t\t\t\tconst valueId = value.id;\n\t\t\t\t\tif( 0 < valueId.length ) {\n\t\t\t\t\t\tlet values = tags[ valueId ];\n\t\t\t\t\t\tif( values == null ) {\n\t\t\t\t\t\t\tvalues = [];\n\t\t\t\t\t\t\ttags[ valueId ] = values;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalues.push( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Id mappings\n\t\t\tconst shapeId = shape.id;\n\t\t\tif( 0 < shapeId.length ) {\n\t\t\t\tconst mapping: EShape[] | undefined = ids[ shapeId ];\n\t\t\t\tif( mapping == null ) {\n\t\t\t\t\tids[ shapeId ] = [ shape ];\n\t\t\t\t} else {\n\t\t\t\t\tmapping.push( shape );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Interactives\n\t\t\tif( shape.interactive || (0 < shape.cursor.length) || (shape.runtime != null && shape.runtime.interactive) ) {\n\t\t\t\tinteractives.push( shape );\n\t\t\t}\n\n\t\t\t// Actionables\n\t\t\tconst runtime = shape.runtime;\n\t\t\tif( runtime != null && 0 < runtime.actions.length ) {\n\t\t\t\tactionables.push( shape );\n\t\t\t}\n\n\t\t\t// Shortcuts\n\t\t\tconst shortcut = shape.shortcut;\n\t\t\tif( shortcut != null ) {\n\t\t\t\tUtilKeyboardEvent.on( this, shortcut, ( e: KeyboardEvent ): void => {\n\t\t\t\t\tshape.onShortcut( e );\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Children\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tthis.initializeShapes( children, tags, interactives, actionables, ids );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateShapes( shapes: EShape[], time: number ): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tshapes[ i ].update( time );\n\t\t}\n\t}\n\n\tonShapeMove( e: interaction.InteractionEvent ): boolean {\n\t\tconst global = e.data.global;\n\t\tconst work = this._work;\n\n\t\tconst interactives = this.interactives;\n\t\tlet found: EShape | null = null;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tconst interactiveLocal = interactive.toLocal( global, undefined, work );\n\t\t\t\tif( interactive.contains( interactiveLocal ) != null ) {\n\t\t\t\t\tfound = interactive;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst application = DApplications.getInstance();\n\t\tif( found != null ) {\n\t\t\tif( 0 < found.cursor.length ) {\n\t\t\t\tif( application.view.style.cursor !== found.cursor ) {\n\t\t\t\t\tapplication.view.style.cursor = found.cursor;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst lastOverShape = this._lastOverShape;\n\t\t\tif( found === lastOverShape ) {\n\t\t\t\tconst runtime = lastOverShape.runtime;\n\t\t\t\tif( runtime != null ) {\n\t\t\t\t\truntime.onPointerMove( lastOverShape, e );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._lastOverShape = found;\n\n\t\t\t\t// Previous\n\t\t\t\tif( lastOverShape != null ) {\n\t\t\t\t\tconst previousRuntime = lastOverShape.runtime;\n\t\t\t\t\tif( previousRuntime != null ) {\n\t\t\t\t\t\tpreviousRuntime.onPointerOut( lastOverShape, e );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Parents\n\t\t\t\t\tlet lastOverParent = lastOverShape.parent;\n\t\t\t\t\twhile( (lastOverParent instanceof EShapeBase) && lastOverParent !== found ) {\n\t\t\t\t\t\tconst parentRuntime = lastOverShape.runtime;\n\t\t\t\t\t\tif( parentRuntime != null ) {\n\t\t\t\t\t\t\tparentRuntime.onPointerOut( lastOverParent, e );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlastOverParent = lastOverParent.parent;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Next\n\t\t\t\tconst runtime = found.runtime;\n\t\t\t\tif( runtime != null ) {\n\t\t\t\t\truntime.onPointerOver( found, e );\n\t\t\t\t}\n\t\t\t\tDApplications.getInstance().view.title = ( found.title || \"\" );\n\n\t\t\t\t// Parents\n\t\t\t\tlet parent = found.parent;\n\t\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\t\tconst parentRuntime = parent.runtime;\n\t\t\t\t\tif( parentRuntime != null ) {\n\t\t\t\t\t\tparentRuntime.onPointerOver( parent, e );\n\t\t\t\t\t}\n\t\t\t\t\tparent = parent.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( application.view.style.cursor !== \"auto\" ) {\n\t\t\t\tapplication.view.style.cursor = \"auto\";\n\t\t\t}\n\n\t\t\t// Previous\n\t\t\tconst lastOverShape = this._lastOverShape;\n\t\t\tthis._lastOverShape = null;\n\t\t\tif( lastOverShape != null ) {\n\t\t\t\tconst runtime = lastOverShape.runtime;\n\t\t\t\tif( runtime != null ) {\n\t\t\t\t\truntime.onPointerOut( lastOverShape, e );\n\t\t\t\t}\n\n\t\t\t\t// Parents\n\t\t\t\tlet lastOverParent = lastOverShape.parent;\n\t\t\t\twhile( lastOverParent instanceof EShapeBase ) {\n\t\t\t\t\tconst parentRuntime = lastOverParent.runtime;\n\t\t\t\t\tif( parentRuntime != null ) {\n\t\t\t\t\t\tparentRuntime.onPointerOut( lastOverParent, e );\n\t\t\t\t\t}\n\t\t\t\t\tlastOverParent = lastOverParent.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//\n\t\t\tDApplications.getInstance().view.title = \"\";\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tonShapeDown( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst work = this._work;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tconst local = interactive.toLocal( global, undefined, work );\n\t\t\t\tif( interactive.contains( local ) != null ) {\n\t\t\t\t\tconst runtime = interactive.runtime;\n\t\t\t\t\tif( runtime != null ) {\n\t\t\t\t\t\truntime.onPointerDown( interactive, e );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeUp( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst work = this._work;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tconst local = interactive.toLocal( global, undefined, work );\n\t\t\t\tif( interactive.contains( local ) != null ) {\n\t\t\t\t\tconst runtime = interactive.runtime;\n\t\t\t\t\tif( runtime != null ) {\n\t\t\t\t\t\truntime.onPointerUp( interactive, e );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeClick( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst work = this._work;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst clickable = interactives[ i ];\n\t\t\tif( clickable.visible ) {\n\t\t\t\tconst clickableLocal = clickable.toLocal( global, undefined, work );\n\t\t\t\tif( clickable.contains( clickableLocal ) != null ) {\n\t\t\t\t\tlet target: EShape = clickable;\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tconst runtime = target.runtime;\n\t\t\t\t\t\tif( runtime != null ) {\n\t\t\t\t\t\t\truntime.onPointerClick( target, e );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst parent = target.parent;\n\t\t\t\t\t\tif( parent instanceof EShapeBase ) {\n\t\t\t\t\t\t\ttarget = parent;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvas\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DDiagramLayerContainer } from \"./d-diagram-layer-container\";\nimport { DDiagramSerialized, DDiagramSerializedSimple } from \"./d-diagram-serialized\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\nimport { EShapeDeserializer } from \"./shape/e-shape-deserializer\";\n\nexport class DDiagrams {\n\tstatic toSerialized( simple: DDiagramSerializedSimple ): DDiagramSerialized {\n\t\tconst result: DDiagramSerialized = JSON.parse( simple.data );\n\t\tresult.id = simple.id;\n\t\treturn result;\n\t}\n\n\tstatic newLayer(\n\t\tserialized: DDiagramSerialized,\n\t\tcontainer: DDiagramLayerContainer\n\t): Promise<EShape[]> {\n\t\t// Layers\n\t\tconst pflayers = serialized.layers;\n\t\tfor( let i = 0, imax = pflayers.length; i < imax; ++i ) {\n\t\t\tcontainer.create( pflayers[ i ][ 0 ] || \"\" );\n\t\t}\n\n\t\t// Activate the first later if it exists\n\t\tif( 0 < container.size() ) {\n\t\t\tcontainer.active = container.children[ 0 ];\n\t\t}\n\n\t\t// Items\n\t\tconst pfresources = serialized.resources;\n\t\tconst pfitems = serialized.items;\n\t\tconst shapePromises = EShapeDeserializer.deserializeAll( pfitems, pfresources );\n\t\tif( shapePromises != null ) {\n\t\t\treturn shapePromises.then(( shapes: EShape[] ): EShape[] => {\n\t\t\t\tconst layers = container.children;\n\t\t\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\t\t\tconst pfitem = pfitems[ i ];\n\t\t\t\t\tconst shape = shapes[ i ];\n\t\t\t\t\tconst layer = layers[ pfitem[ 16 ] ];\n\t\t\t\t\tif( layer != null ) {\n\t\t\t\t\t\tshape.attach( layer );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn shapes;\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\t}\n\n\tstatic applyBackground(\n\t\tserialized: DDiagramSerialized,\n\t\tcanvas: DBase,\n\t\tcanvasContainer: DBase\n\t): void {\n\t\tconst background = serialized.background;\n\t\tconst renderer = DApplications.getInstance().renderer;\n\t\tconst backgroundColor = ( background && background.color != null ? background.color : 0xffffff );\n\t\tconst backgroundAlpha = ( background && background.alpha != null ? background.alpha : 1.0 );\n\t\tif( EShapeDefaults.IS_EDIT_MODE ) {\n\t\t\tcanvas.background.color = backgroundColor;\n\t\t\tcanvas.background.alpha = backgroundAlpha;\n\t\t} else {\n\t\t\tcanvasContainer.background.color = backgroundColor;\n\t\t\trenderer.backgroundColor = backgroundColor;\n\t\t\tcanvasContainer.background.alpha = backgroundAlpha;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DCanvasContainer, DCanvasContainerOptions, DThemeCanvasContainer } from \"./d-canvas-container\";\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasTilePyramidFactory } from \"./d-diagram-canvas-tile\";\nimport { DDiagramLayer } from \"./d-diagram-layer\";\nimport { DDiagramSerialized } from \"./d-diagram-serialized\";\nimport { DDiagrams } from \"./d-diagrams\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport interface DDiagramBaseOptions<\n\tCANVAS extends DDiagramCanvasBase = DDiagramCanvasBase,\n\tTHEME extends DThemeDiagramBase = DThemeDiagramBase\n> extends DCanvasContainerOptions<CANVAS, THEME> {\n\ttile?: DDiagramCanvasTilePyramidFactory;\n}\n\nexport interface DThemeDiagramBase extends DThemeCanvasContainer {\n\n}\n\nexport abstract class DDiagramBase<\n\tCANVAS extends DDiagramCanvasBase = DDiagramCanvasBase,\n\tTHEME extends DThemeDiagramBase = DThemeDiagramBase,\n\tOPTIONS extends DDiagramBaseOptions<CANVAS, THEME> = DDiagramBaseOptions<CANVAS, THEME>\n> extends DCanvasContainer<CANVAS, THEME, OPTIONS> {\n\tprotected _serialized: DDiagramSerialized | null;\n\tprotected _tileFactory?: DDiagramCanvasTilePyramidFactory;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._serialized = null;\n\t\tthis._tileFactory = options && options.tile;\n\t}\n\n\tset( serialized: DDiagramSerialized | null ) {\n\t\tconst oldSerialized = this._serialized;\n\t\tif( oldSerialized !== serialized ) {\n\t\t\tif( oldSerialized ) {\n\t\t\t\tthis._serialized = null;\n\t\t\t\tthis.onUnset();\n\t\t\t}\n\n\t\t\tthis._serialized = serialized;\n\t\t\tif( serialized ) {\n\t\t\t\tthis.onSet( serialized );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onSet( serialized: DDiagramSerialized ): void {\n\t\tconst canvas = this.newCanvas( serialized );\n\t\tDDiagrams.newLayer( serialized, canvas.layer ).then(( shapes: EShape[] ): void => {\n\t\t\tthis.initialize( shapes );\n\t\t\tcanvas.initialize( shapes );\n\t\t\tDApplications.update();\n\t\t});\n\t\tDDiagrams.applyBackground( serialized, canvas, this );\n\t\tthis.canvas = canvas;\n\t}\n\n\tprotected initialize( shapes: EShape[] ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected abstract newCanvas( serialized: DDiagramSerialized ): CANVAS;\n\n\tprotected onUnset(): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis.canvas = null;\n\t\t}\n\t}\n\n\tget(): DDiagramSerialized | null {\n\t\treturn this._serialized;\n\t}\n\n\tget layer(): DDiagramLayer | null {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\treturn canvas.layer.active;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DControllerDocument } from \"./d-controller-document\";\nimport { DControllers } from \"./d-controllers\";\nimport { DDiagramBase, DDiagramBaseOptions, DThemeDiagramBase } from \"./d-diagram-base\";\nimport { DDiagramCanvasEditor } from \"./d-diagram-canvas-editor\";\nimport { DDiagramSerialized, DDiagramSerializedSimple, DDiagramSerializedVersion } from \"./d-diagram-serialized\";\nimport { DDiagrams } from \"./d-diagrams\";\nimport { ESnapper } from \"./snapper/e-snapper\";\n\nexport interface DDiagramEditorController {\n\tget( id: number ): Promise<DDiagramSerializedSimple>;\n\tsave( simple: DDiagramSerializedSimple ): Promise<number>;\n\tdelete( id: number ): Promise<void>;\n}\n\nexport interface DDiagramEditorOptions<\n\tTHEME extends DThemeDiagramEditor = DThemeDiagramEditor\n> extends DDiagramBaseOptions<DDiagramCanvasEditor, THEME> {\n\tcontroller: DDiagramEditorController;\n}\n\nexport interface DThemeDiagramEditor extends DThemeDiagramBase {\n\n}\n\nexport class DDiagramEditor<\n\tTHEME extends DThemeDiagramEditor = DThemeDiagramEditor,\n\tOPTIONS extends DDiagramEditorOptions<THEME> = DDiagramEditorOptions<THEME>\n> extends DDiagramBase<DDiagramCanvasEditor, THEME, OPTIONS> implements DControllerDocument<DDiagramSerialized> {\n\tprotected _isChanged: boolean = false;\n\tprotected _controller: DDiagramEditorController;\n\tsnapper: ESnapper;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._controller = options.controller;\n\t\tthis._isChanged = false;\n\n\t\tconst commands = DControllers.getCommandController();\n\t\tcommands.on( \"dirty\", (): void => {\n\t\t\tif( this._isChanged !== true ) {\n\t\t\t\tthis._isChanged = true;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t});\n\n\t\tthis.snapper = new ESnapper( this );\n\t}\n\n\tprotected newCanvas( serialized: DDiagramSerialized ): DDiagramCanvasEditor {\n\t\treturn new DDiagramCanvasEditor({\n\t\t\tname: serialized.name,\n\t\t\twidth: serialized.width,\n\t\t\theight: serialized.height,\n\t\t\tsnapper: this.snapper,\n\t\t\ttile: {\n\t\t\t\tfactory: this._tileFactory,\n\t\t\t\tmapping: serialized.tile && serialized.tile.mapping\n\t\t\t}\n\t\t});\n\t}\n\n\tserialize(): DDiagramSerialized | null {\n\t\tconst canvas = this.canvas;\n\t\tconst serialized = this._serialized;\n\t\tif( canvas != null && serialized != null ) {\n\t\t\treturn canvas.serialize( serialized.id );\n\t\t}\n\t\treturn null;\n\t}\n\n\tsave(): Promise<unknown> | boolean {\n\t\tconst serialized = this.serialize();\n\t\tif( serialized != null ) {\n\t\t\treturn this.controller.save({\n\t\t\t\tversion: serialized.version,\n\t\t\t\tid: serialized.id,\n\t\t\t\tname: serialized.name,\n\t\t\t\tdata: JSON.stringify( serialized )\n\t\t\t})\n\t\t\t.then(( newId: number ): void => {\n\t\t\t\tthis._isChanged = false;\n\t\t\t\tserialized.id = newId;\n\t\t\t\tthis._serialized = serialized;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\tthis.emit( \"success\", \"save\", this );\n\t\t\t}, ( reason: any ): void => {\n\t\t\t\tthis.emit( \"fail\", \"save\", this );\n\t\t\t});\n\t\t}\n\t\treturn true;\n\t}\n\n\tsaveAs( name: string ): Promise<unknown> | boolean {\n\t\tconst serialized = this.serialize();\n\t\tif( serialized != null ) {\n\t\t\tserialized.id = undefined;\n\t\t\tserialized.name = name;\n\t\t\treturn this.controller.save({\n\t\t\t\tversion: serialized.version,\n\t\t\t\tid: serialized.id,\n\t\t\t\tname: serialized.name,\n\t\t\t\tdata: JSON.stringify( serialized )\n\t\t\t})\n\t\t\t.then(( newId: number ): void => {\n\t\t\t\tthis._isChanged = false;\n\t\t\t\tserialized.id = newId;\n\t\t\t\tthis._serialized = serialized;\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas != null ) {\n\t\t\t\t\tcanvas.name = name;\n\t\t\t\t}\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\tthis.emit( \"success\", \"save-as\", this );\n\t\t\t}, ( reason: any ): void => {\n\t\t\t\tthis.emit( \"fail\", \"save-as\", this );\n\t\t\t});\n\t\t}\n\t\treturn true;\n\t}\n\n\tdelete(): Promise<unknown> | boolean {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\tif( serialized.id != null ) {\n\t\t\t\treturn this.controller.delete( serialized.id )\n\t\t\t\t.then((): void => {\n\t\t\t\t\tthis.set( null );\n\t\t\t\t\tthis.emit( \"success\", \"delete\", this );\n\t\t\t\t}, ( reason: any ): void => {\n\t\t\t\t\tthis.emit( \"fail\", \"delete\", this );\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.set( null );\n\t\t\t\tthis.emit( \"success\", \"delete\", this );\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcreate( name: string, width: number, height: number ): Promise<unknown> | boolean {\n\t\tthis.set({\n\t\t\tversion: DDiagramSerializedVersion,\n\t\t\tid: undefined,\n\t\t\tname,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tresources: [],\n\t\t\tlayers: [[ \"Default layer\" ]],\n\t\t\titems: [],\n\t\t\tsnap: undefined\n\t\t});\n\t\treturn true;\n\t}\n\n\tprotected onSet( serialized: DDiagramSerialized ): void {\n\t\tsuper.onSet( serialized );\n\t\tconst snap = serialized.snap;\n\t\tconst snapper = this.snapper;\n\t\tif( snap != null ) {\n\t\t\tsnapper.deserialize( snap );\n\t\t} else {\n\t\t\tsnapper.reset();\n\t\t}\n\t\tthis._isChanged = false;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tprotected onUnset(): void {\n\t\tsuper.onUnset();\n\t\tthis._isChanged = false;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\topen( id: number ): Promise<unknown> | boolean {\n\t\treturn this._controller.get( id ).then(( simple: DDiagramSerializedSimple ): void => {\n\t\t\tthis.set( DDiagrams.toSerialized( simple ) );\n\t\t\tthis.emit( \"success\", \"open\", this );\n\t\t}, ( reason: any ): void => {\n\t\t\tthis.emit( \"fail\", \"open\", this );\n\t\t});\n\t}\n\n\tclose(): void {\n\t\tthis.set( null );\n\t}\n\n\tisChanged(): boolean {\n\t\treturn this._isChanged || this.isNew();\n\t}\n\n\tisNew(): boolean {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\treturn serialized.id == null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetName(): string | null {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\treturn serialized.name;\n\t\t}\n\t\treturn null;\n\t}\n\n\tget controller(): DDiagramEditorController {\n\t\treturn this._controller;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramEditor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DDiagramBase, DDiagramBaseOptions, DThemeDiagramBase } from \"./d-diagram-base\";\nimport { DDiagramCanvas } from \"./d-diagram-canvas\";\nimport { DDiagramSerialized } from \"./d-diagram-serialized\";\nimport { EShapeActionRuntime } from \"./shape/action/e-shape-action-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./shape/action/e-shape-action-runtime-open\";\nimport { EShapeActionValue } from \"./shape/action/e-shape-action-value\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeRuntime } from \"./shape/e-shape-runtime\";\nimport { EShapeRuntimes } from \"./shape/e-shape-runtimes\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DDiagramOptions<\n\tTHEME extends DThemeDiagram = DThemeDiagram\n> extends DDiagramBaseOptions<DDiagramCanvas, THEME> {\n\n}\n\nexport interface DThemeDiagram extends DThemeDiagramBase {\n\n}\n\nexport class DDiagram<\n\tTHEME extends DThemeDiagram = DThemeDiagram,\n\tOPTIONS extends DDiagramOptions<THEME> = DDiagramOptions<THEME>\n> extends DDiagramBase<DDiagramCanvas, THEME, OPTIONS> {\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\t// Hover handling\n\t\tthis.on( UtilPointerEvent.move, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas != null ) {\n\t\t\t\t\tcanvas.onShapeMove( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Pointer down / up handling\n\t\tthis.on( UtilPointerEvent.up, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas != null ) {\n\t\t\t\t\tcanvas.onShapeUp( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Click handling\n\t\tthis.on( \"click\", ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas != null ) {\n\t\t\t\t\tcanvas.onShapeClick( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected initialize( shapes: EShape[] ): void {\n\t\tconst formatterMap: { [format: string]: ( value: unknown ) => unknown } = {};\n\t\tconst initialMap: { [initial: string]: unknown | undefined } = {};\n\t\tconst actionMap: Map<EShapeActionValue, EShapeActionRuntime> = new Map<EShapeActionValue, EShapeActionRuntime>();\n\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tconst runtimeConstructor = EShapeRuntimes[ shape.type ] || EShapeRuntime;\n\t\t\tconst runtime = shape.runtime = new (runtimeConstructor)( shape );\n\n\t\t\t// Tag\n\t\t\tconst tag = shape.tag;\n\t\t\tfor( let j = 0, jmax = tag.size(); j < jmax; ++j ) {\n\t\t\t\tconst value = tag.get( j );\n\t\t\t\tif( value != null ) {\n\t\t\t\t\t// Format\n\t\t\t\t\tconst tagFormat = value.format;\n\t\t\t\t\tconst tagInitial = value.initial;\n\t\t\t\t\tif( tagFormat in formatterMap ) {\n\t\t\t\t\t\tvalue.formatter = formatterMap[ tagFormat ];\n\t\t\t\t\t} else if( 0 < tagFormat.length ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst formatter = Function(\n\t\t\t\t\t\t\t\t\"value\",\n\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t`return (${tagFormat});` +\n\t\t\t\t\t\t\t\t`} catch( e1 ) {` +\n\t\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t\t`return (${0 < tagInitial.length ? tagInitial : 0});` +\n\t\t\t\t\t\t\t\t\t`} catch( e2 ) {` +\n\t\t\t\t\t\t\t\t\t\t`return 0;` +\n\t\t\t\t\t\t\t\t\t`}` +\n\t\t\t\t\t\t\t\t`}`\n\t\t\t\t\t\t\t) as any;\n\t\t\t\t\t\t\tformatterMap[ tagFormat ] = formatter;\n\t\t\t\t\t\t\tvalue.formatter = formatter;\n\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Initial\n\t\t\t\t\tif( tagInitial in initialMap ) {\n\t\t\t\t\t\tvalue.value = initialMap[ tagInitial ];\n\t\t\t\t\t} else if( 0 < tagInitial.length ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvalue.value = initialMap[ tagInitial ] = (Function(\n\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t`return (${tagInitial});` +\n\t\t\t\t\t\t\t\t`} catch( e ) {` +\n\t\t\t\t\t\t\t\t\t`return 0;` +\n\t\t\t\t\t\t\t\t`}`\n\t\t\t\t\t\t\t)());\n\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Initialize runtime actions\n\t\t\tconst values = shape.action.values;\n\t\t\tconst actions = runtime.actions;\n\t\t\tfor( let j = 0, jmax = values.length; j < jmax; ++j ) {\n\t\t\t\tconst value = values[ j ];\n\t\t\t\tlet action: EShapeActionRuntime | undefined | null = actionMap.get( value );\n\t\t\t\tif( action == null ) {\n\t\t\t\t\taction = value.toRuntime( shape );\n\t\t\t\t\tif( action != null ) {\n\t\t\t\t\t\tif( action instanceof EShapeActionRuntimeOpen ) {\n\t\t\t\t\t\t\tif( shape.cursor.length <= 0 ) {\n\t\t\t\t\t\t\t\tshape.cursor = \"pointer\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tactionMap.set( value, action );\n\t\t\t\t\t\tactions.push( action );\n\t\t\t\t\t\truntime.reset |= action.reset;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tactions.push( action );\n\t\t\t\t\truntime.reset |= action.reset;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Children\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tthis.initialize( children );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected newCanvas( serialized: DDiagramSerialized ): DDiagramCanvas {\n\t\treturn new DDiagramCanvas({\n\t\t\tname: serialized.name,\n\t\t\twidth: serialized.width,\n\t\t\theight: serialized.height,\n\t\t\tbackground: {\n\t\t\t\tcolor: null\n\t\t\t},\n\t\t\tborder: {\n\t\t\t\tcolor: null\n\t\t\t},\n\t\t\ttile: {\n\t\t\t\tfactory: this._tileFactory,\n\t\t\t\tmapping: serialized.tile && serialized.tile.mapping\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onDown( e: interaction.InteractionEvent ): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\tif( canvas.onShapeDown( e ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tsuper.onDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagram\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\n\nexport interface DDialogConfirmMessageOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage\n> extends DImageOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeDialogConfirmMessage extends DThemeImage {\n\n}\n\nexport class DDialogConfirmMessage<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage,\n\tOPTIONS extends DDialogConfirmMessageOptions<VALUE, THEME> = DDialogConfirmMessageOptions<VALUE, THEME>\n> extends DImage<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DDialogConfirmMessage, DDialogConfirmMessageOptions } from \"./d-dialog-confirm-message\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DStateAwareOrValue } from \"./d-state-aware\";\nimport { utilIsFunction } from \"./util/util-is-function\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport interface DDialogConfirmOptions<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm\n> extends DDialogCommandOptions<THEME> {\n\tmessage?: DStateAwareOrValue<string> | DDialogConfirmMessageOptions | DDialogConfirmMessage;\n}\n\nexport interface DThemeDialogConfirm extends DThemeDialogCommand {\n\tgetMessage(): DStateAwareOrValue<string>;\n}\n\nexport class DDialogConfirm<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmOptions<THEME> = DDialogConfirmOptions<THEME>\n> extends DDialogCommand<THEME, OPTIONS> {\n\tprotected _message!: DDialogConfirmMessage;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tconst message = this.toMessage( this.theme, options );\n\t\tthis._message = message;\n\t\tlayout.addChild( message );\n\t}\n\n\tprotected toMessage( theme: DThemeDialogConfirm, options?: DDialogConfirmOptions ): DDialogConfirmMessage {\n\t\tif( options && options.message != null ) {\n\t\t\tconst message = options.message;\n\t\t\tif( utilIsString( message ) || utilIsFunction( message ) ) {\n\t\t\t\treturn this.newMessage(\n\t\t\t\t\tthis.toMessageOptions( message )\n\t\t\t\t);\n\t\t\t} else if( message instanceof DBase ) {\n\t\t\t\treturn message;\n\t\t\t} else {\n\t\t\t\treturn this.newMessage(\n\t\t\t\t\tthis.toMessageOptionsMerged( message, theme.getMessage() )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn this.newMessage(\n\t\t\tthis.toMessageOptions( theme.getMessage() )\n\t\t);\n\t}\n\n\tprotected toMessageOptionsMerged(\n\t\toptions: DDialogConfirmMessageOptions,\n\t\tmessage: DStateAwareOrValue<string>\n\t): DDialogConfirmMessageOptions {\n\t\tif( options.text == null ) {\n\t\t\toptions.text ={};\n\t\t}\n\t\tif( options.text.value === undefined ) {\n\t\t\toptions.text.value = message;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected toMessageOptions( message: DStateAwareOrValue<string> ): DDialogConfirmMessageOptions {\n\t\treturn {\n\t\t\ttext: {\n\t\t\t\tvalue: message\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected newMessage( options: DDialogConfirmMessageOptions ): DDialogConfirmMessage {\n\t\treturn new DDialogConfirmMessage( options );\n\t}\n\n\tget message(): DDialogConfirmMessage {\n\t\treturn this._message;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirm\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogConfirmDeleteOptions<\n\tTHEME extends DThemeDialogConfirm\n> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogConfirmDelete extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogConfirmDelete<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmDeleteOptions<THEME> = DDialogConfirmDeleteOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmDelete\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogConfirmDiscardOptions<\n\tTHEME extends DThemeDialogConfirm\n> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogConfirmDiscard extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogConfirmDiscard<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmDiscardOptions<THEME> = DDialogConfirmDiscardOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmDiscard\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\nimport { DButtonPrimary } from \"./d-button-primary\";\nimport { DDialog, DDialogOptions, DThemeDialog } from \"./d-dialog\";\nimport { DInputTextAndLabel } from \"./d-input-text-and-label\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace } from \"./d-layout-space\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DDialogInputTextOptions<THEME extends DThemeDialog> extends DDialogOptions<THEME> {\n\tok?: string;\n\tcancel?: string;\n\tlabel?: string;\n}\n\nexport interface DThemeDialogInputText extends DThemeDialog {\n\tgetOk(): string;\n\tgetCancel(): string;\n\tgetLabel(): string;\n\tgetLabelWidth(): number;\n}\n\nexport class DDialogInputText<\n\tTHEME extends DThemeDialogInputText = DThemeDialogInputText,\n\tOPTIONS extends DDialogInputTextOptions<THEME> = DDialogInputTextOptions<THEME>\n> extends DDialog<THEME, OPTIONS> {\n\tprotected _input: DInputTextAndLabel;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst theme = this.theme;\n\n\t\tconst layout = new DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: \"padding\", y: \"padding\",\n\t\t\twidth: \"padding\", height: \"auto\"\n\t\t});\n\n\t\t// Input\n\t\tthis._input = new DInputTextAndLabel({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ton: {\n\t\t\t\t\tenter: () => {\n\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tlabel: {\n\t\t\t\twidth: theme.getLabelWidth(),\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: ( options != null && options.label != null ?\n\t\t\t\t\t\toptions.label : theme.getLabel()\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t},\n\t\t\tspace: {\n\t\t\t\twidth: theme.getLabelWidth()\n\t\t\t}\n\t\t});\n\n\t\t// Buttons\n\t\tnew DLayoutHorizontal({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\tpadding: {\n\t\t\t\ttop: this.padding.getBottom()\n\t\t\t},\n\t\t\tchildren: [\n\t\t\t\tnew DLayoutSpace({\n\t\t\t\t\tweight: 1\n\t\t\t\t}),\n\t\t\t\tnew DButtonPrimary({\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ( options != null && options.ok != null ?\n\t\t\t\t\t\t\toptions.ok : theme.getOk()\n\t\t\t\t\t\t)\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: () => {\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\tthis.onOk();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew DButton({\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ( options != null && options.cancel != null ?\n\t\t\t\t\t\t\toptions.cancel : theme.getCancel()\n\t\t\t\t\t\t)\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: () => {\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t\tthis.onCancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}),\n\t\t\t\tnew DLayoutSpace({\n\t\t\t\t\tweight: 1\n\t\t\t\t})\n\t\t\t]\n\t\t});\n\t}\n\n\tget input() {\n\t\treturn this._input.input;\n\t}\n\n\tprotected onOk() {\n\t\tthis.emit( \"ok\", this._input.input.value, this );\n\t}\n\n\tprotected onCancel() {\n\t\tthis.emit( \"cancel\", this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogMessageOptions<THEME extends DThemeDialogMessage> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogMessage extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogMessage<\n\tTHEME extends DThemeDialogMessage = DThemeDialogMessage,\n\tOPTIONS extends DDialogMessageOptions<THEME> = DDialogMessageOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDDialogConfirmMessage, DDialogConfirmMessageOptions, DThemeDialogConfirmMessage\n} from \"./d-dialog-confirm-message\";\n\nexport class DDialogProcessingMessage<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage,\n\tOPTIONS extends DDialogConfirmMessageOptions<VALUE, THEME> = DDialogConfirmMessageOptions<VALUE, THEME>\n> extends DDialogConfirmMessage<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogProcessingMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\nimport { DDialogConfirmMessage, DDialogConfirmMessageOptions } from \"./d-dialog-confirm-message\";\nimport { DDialogProcessingMessage } from \"./d-dialog-processing-message\";\n\nexport interface DDialogProcessingOptions<THEME extends DThemeDialogProcessing> extends DDialogConfirmOptions<THEME> {\n\tinterval?: number;\n}\n\nexport interface DThemeDialogProcessing extends DThemeDialogConfirm {\n\tgetInterval(): number;\n}\n\nexport class DDialogProcessing<\n\tTHEME extends DThemeDialogProcessing = DThemeDialogProcessing,\n\tOPTIONS extends DDialogProcessingOptions<THEME> = DDialogProcessingOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected _isDone: boolean;\n\tprotected _startTime: number;\n\tprotected _interval: number;\n\tprotected _timeoutId?: number;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._isDone = true;\n\t\tthis._startTime =  0;\n\t\tthis._interval = ( options && options.interval != null ? options.interval : this.theme.getInterval() );\n\t}\n\n\tprotected newMessage( options: DDialogConfirmMessageOptions ): DDialogConfirmMessage {\n\t\treturn new DDialogProcessingMessage( options );\n\t}\n\n\tprotected onOpen() {\n\t\tthis._isDone = false;\n\t\tthis._startTime = Date.now();\n\t\tconst timeoutId = this._timeoutId;\n\t\tif( timeoutId != null ) {\n\t\t\tclearTimeout( timeoutId );\n\t\t}\n\t\tthis._message.setStates( DBaseState.NONE, DBaseState.SUCCEEDED | DBaseState.FAILED );\n\t\tconst buttonLayout = this._buttonLayout;\n\t\tif( buttonLayout != null ) {\n\t\t\tbuttonLayout.setDisabled( true );\n\t\t}\n\t\tsuper.onOpen();\n\t}\n\n\tprotected onDone(): void {\n\t\tconst buttonLayout = this._buttonLayout;\n\t\tif( buttonLayout != null ) {\n\t\t\tbuttonLayout.setDisabled( false );\n\t\t} else {\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tprotected onResolved( message?: string ): void {\n\t\tif( message != null ) {\n\t\t\tthis._message.text = message;\n\t\t}\n\t\tthis._message.setStates( DBaseState.SUCCEEDED, DBaseState.FAILED );\n\t\tthis.onDone();\n\t}\n\n\tprotected onRejected( message?: string ): void {\n\t\tif( message != null ) {\n\t\t\tthis._message.text = message;\n\t\t}\n\t\tthis._message.setStates( DBaseState.FAILED, DBaseState.SUCCEEDED );\n\t\tthis.onDone();\n\t}\n\n\tresolve( message?: string ): void {\n\t\tif( ! this._isDone ) {\n\t\t\tthis._isDone = true;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst delay = this._interval - elapsedTime;\n\t\t\tif( 0 < delay ) {\n\t\t\t\tthis._timeoutId = window.setTimeout((): void => {\n\t\t\t\t\tthis._timeoutId = undefined;\n\t\t\t\t\tthis.onResolved( message );\n\t\t\t\t}, delay );\n\t\t\t} else {\n\t\t\t\tthis.onResolved( message );\n\t\t\t}\n\t\t}\n\t}\n\n\treject( message?: string ): void {\n\t\tif( ! this._isDone ) {\n\t\t\tthis._isDone = true;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst delay = this._interval - elapsedTime;\n\t\t\tif( 0 < delay ) {\n\t\t\t\tthis._timeoutId = window.setTimeout((): void => {\n\t\t\t\t\tthis._timeoutId = undefined;\n\t\t\t\t\tthis.onRejected( message );\n\t\t\t\t}, delay );\n\t\t\t} else {\n\t\t\t\tthis.onRejected( message );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onCloseOn(): void {\n\t\tif( this._isDone ) {\n\t\t\tsuper.onCloseOn();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogProcessing\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommandSaveAs } from \"./d-command-save-as\";\nimport { DControllers } from \"./d-controllers\";\nimport { DDialogInputText, DDialogInputTextOptions, DThemeDialogInputText } from \"./d-dialog-input-text\";\n\nexport interface DDialogSaveAsOptions<THEME extends DThemeDialogSaveAs> extends DDialogInputTextOptions<THEME> {\n\n}\n\nexport interface DThemeDialogSaveAs extends DThemeDialogInputText {\n\n}\n\nexport class DDialogSaveAs<\n\tTHEME extends DThemeDialogSaveAs = DThemeDialogSaveAs,\n\tOPTIONS extends DDialogSaveAsOptions<THEME> = DDialogSaveAsOptions<THEME>\n> extends DDialogInputText<THEME, OPTIONS> {\n\tprotected onOpen() {\n\t\tconst name = DControllers.getDocumentController().getName();\n\t\tif( name != null ) {\n\t\t\tthis._input.input.value = name;\n\t\t}\n\t\tsuper.onOpen();\n\t}\n\n\tprotected onOk() {\n\t\tsuper.onOk();\n\n\t\tconst name = this._input.input.value;\n\t\tDControllers.getCommandController().push( new DCommandSaveAs( name ) );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSaveAs\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\n\nexport interface DDialogSelectListItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecListItem = DThemeDialogSelecListItem\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeDialogSelecListItem extends DThemeListItem {\n\n}\n\nexport class DDialogSelectListItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecListItem = DThemeDialogSelecListItem,\n\tOPTIONS extends DDialogSelectListItemOptions<VALUE, THEME> = DDialogSelectListItemOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogSelectListItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\n\nexport interface DScrollBarOptions extends DBaseOptions<DThemeScrollBar> {\n\tthumb?: DScrollBarThumbOptions;\n}\n\nexport interface DThemeScrollBar extends DThemeBase {\n\n}\n\nexport abstract class DScrollBar extends DBase<DThemeScrollBar, DScrollBarOptions> {\n\tprotected _start!: number;\n\tprotected _end!: number;\n\tprotected _thumb!: DScrollBarThumb;\n\n\tprotected init( options?: DScrollBarOptions ): void {\n\t\tsuper.init( options );\n\n\t\tthis._start = 0;\n\t\tthis._end = 1;\n\t\tconst thumb = this._thumb = this.createThumb( options != null ? options.thumb : undefined );\n\t\tthis.addChild( thumb );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tget thumb(): DScrollBarThumb {\n\t\treturn this._thumb;\n\t}\n\n\tprotected abstract createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb;\n\n\tprotected getType(): string {\n\t\treturn \"DScrollBar\";\n\t}\n\n\tsetRegion( start: number, end: number, size: number ): void {\n\t\tif( size < 1 ) {\n\t\t\tstart = 0;\n\t\t\tend = 1;\n\t\t} else {\n\t\t\tstart = Math.max( 0, Math.min( 1, start / size ) );\n\t\t\tend = Math.max( start, Math.min( 1, end / size ) );\n\t\t}\n\t\tif( this._start !== start || this._end !== end ) {\n\t\t\tthis._start = start;\n\t\t\tthis._end = end;\n\t\t\tthis.onRegionChange();\n\t\t}\n\t}\n\n\tisRegionVisible(): boolean {\n\t\treturn 0 < this._start || this._end < 1;\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.onRegionChange();\n\t}\n\n\tonRegionChange(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetRegionStart(): number {\n\t\treturn this._start;\n\t}\n\n\tgetRegionEnd(): number {\n\t\treturn this._end;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { UtilDrag } from \"./util/util-drag\";\n\nexport interface DScrollBarThumbOptions extends DBaseOptions<DThemeScrollBarThumb> {\n\n}\n\nexport interface DThemeScrollBarThumb extends DThemeBase {\n\tgetMinimumSize(): number;\n}\n\nexport abstract class DScrollBarThumb extends DBase<DThemeScrollBarThumb, DScrollBarThumbOptions> {\n\tprotected _dragUtil!: UtilDrag;\n\n\tprotected init( options?: DScrollBarThumbOptions ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\n\t\tconst position = new Point();\n\t\tthis._dragUtil = new UtilDrag({\n\t\t\ttarget: this,\n\t\t\teasing: false,\n\t\t\ton: {\n\t\t\t\tstart: (): void => {\n\t\t\t\t\tposition.copyFrom( this.position );\n\t\t\t\t},\n\t\t\t\tmove: ( dx: number, dy: number ): void => {\n\t\t\t\t\tposition.set( position.x + dx, position.y + dy );\n\t\t\t\t\tthis.onDragMove( position.x, position.y );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMinimumSize(): number {\n\t\treturn this.theme.getMinimumSize();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DScrollBarThumb\";\n\t}\n\n\tprotected abstract onDragMove( dx: number, dy: number ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\n\nexport class DScrollBarThumbReflowableHorizontal extends Graphics implements DReflowable {\n\tconstructor( base: DScrollBarThumb ) {\n\t\tsuper();\n\t\tbase.appendRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\n\t\tthis.clear();\n\n\t\tconst background = base.background;\n\t\tconst backgroundColor = background.getColor( state );\n\t\tconst backgroundAlpha = background.getAlpha( state );\n\t\tif( backgroundColor != null ) {\n\t\t\tconst size = 1;\n\t\t\tthis.beginFill( backgroundColor, backgroundAlpha );\n\t\t\tthis.lineStyle( 0, 0, 0, 0 );\n\t\t\tthis.drawRect( 0, height * 0.5 - size, width, size * 2 );\n\t\t\tthis.endFill();\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbReflowableHorizontal } from \"./d-scroll-bar-thumb-reflowable-horizontal\";\n\nexport class DScrollBarThumbHorizontal extends DScrollBarThumb {\n\tprotected onDragMove( dx: number, dy: number ) {\n\t\tthis.emit( \"regionmove\", dx, this );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DScrollBarThumbReflowableHorizontal( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbHorizontal } from \"./d-scroll-bar-thumb-horizontal\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DScrollBarHorizontal extends DScrollBar {\n\tprotected init( options?: DScrollBarOptions ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst width = this.width;\n\t\t\t\tif( 0 < width ) {\n\t\t\t\t\tconst size = this._end - this._start;\n\t\t\t\t\tconst position = e.data.getLocalPosition( this );\n\t\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, position.x / width - size * 0.5 ) );\n\t\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._thumb.on( \"regionmove\", ( x: number ) => {\n\t\t\tconst width = this.width;\n\t\t\tif( 0 < width ) {\n\t\t\t\tconst size = this._end - this._start;\n\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, x / width ) );\n\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb {\n\t\treturn new DScrollBarThumbHorizontal( options );\n\t}\n\n\tonRegionChange(): void {\n\t\tconst thumb = this._thumb;\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst thumbMinimumSize = Math.min( width * 0.5, thumb.getMinimumSize() );\n\t\tconst space = width - thumbMinimumSize;\n\t\tconst barStart = space * this._start;\n\t\tconst barSize = space * this._end + thumbMinimumSize - barStart;\n\n\t\tthumb.position.set( barStart, 0 );\n\t\tthumb.resize( barSize, height );\n\n\t\tsuper.onRegionChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DScrollBarThumbReflowableVertical extends Graphics implements DReflowable {\n\tconstructor( base: DBase ) {\n\t\tsuper();\n\t\tbase.appendRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\n\t\tthis.clear();\n\n\t\tconst background = base.background;\n\t\tconst backgroundColor = background.getColor( state );\n\t\tconst backgroundAlpha = background.getAlpha( state );\n\t\tif( backgroundColor != null ) {\n\t\t\tconst size = 1;\n\t\t\tthis.beginFill( backgroundColor, backgroundAlpha );\n\t\t\tthis.lineStyle( 0, 0, 0, 0 );\n\t\t\tthis.drawRect( width * 0.5 - size, 0, size * 2, height );\n\t\t\tthis.endFill();\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbReflowableVertical } from \"./d-scroll-bar-thumb-reflowable-vertical\";\n\nexport class DScrollBarThumbVertocal extends DScrollBarThumb {\n\tprotected onDragMove( dx: number, dy: number ) {\n\t\tthis.emit( \"regionmove\", dy, this );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DScrollBarThumbReflowableVertical( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbVertocal } from \"./d-scroll-bar-thumb-vertical\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DScrollBarVertical extends DScrollBar {\n\tprotected init( options?: DScrollBarOptions ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst height = this.height;\n\t\t\t\tif( 0 < height ) {\n\t\t\t\t\tconst size = this._end - this._start;\n\t\t\t\t\tconst position = e.data.getLocalPosition( this );\n\t\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, position.y / height - size * 0.5 ) );\n\t\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t});\n\n\t\tthis._thumb.on( \"regionmove\", ( y: number ): void => {\n\t\t\tconst height = this.height;\n\t\t\tif( 0 < height ) {\n\t\t\t\tconst size = this._end - this._start;\n\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, y / height ) );\n\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb {\n\t\treturn new DScrollBarThumbVertocal( options );\n\t}\n\n\tonRegionChange(): void {\n\t\tconst thumb = this._thumb;\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst thumbMinimumSize = Math.min( height * 0.5, thumb.getMinimumSize() );\n\t\tconst space = height - thumbMinimumSize;\n\t\tconst barStart = space * this._start;\n\t\tconst barSize = space * this._end + thumbMinimumSize - barStart;\n\n\t\tthumb.position.set( 0, barStart );\n\t\tthumb.resize( width, barSize );\n\n\t\tsuper.onRegionChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DContent, DContentOptions } from \"./d-content\";\nimport { DDragMode } from \"./d-drag-mode\";\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarHorizontal } from \"./d-scroll-bar-horizontal\";\nimport { DScrollBarVertical } from \"./d-scroll-bar-vertical\";\nimport { UtilDrag } from \"./util/util-drag\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport interface DPaneOptions<\n\tTHEME extends DThemePane = DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DBaseOptions<THEME> {\n\tmask?: boolean;\n\tcontent?: CONTENT_OPTIONS | DBase;\n\tbar?: {\n\t\tvertical?: DScrollBarOptions,\n\t\thorizontal?: DScrollBarOptions\n\t};\n\tdrag?: {\n\t\tmode?: (keyof typeof DDragMode) | DDragMode;\n\t};\n}\n\nexport interface DThemePane extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n\tgetWheelSpeed(): number;\n\tgetDragMode(): DDragMode;\n}\n\n// Option parsers\nconst isOverflowMaskEnabled = <\n\tTHEME extends DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions\n>( theme: THEME, options?: DPaneOptions<THEME, CONTENT_OPTIONS> ): boolean => {\n\tif( options && options.mask != null ) {\n\t\treturn options.mask;\n\t}\n\treturn theme.isOverflowMaskEnabled();\n};\n\nconst toBarOptionsVertical = ( options?: DPaneOptions ): DScrollBarOptions | undefined => {\n\treturn options && options.bar && options.bar.vertical;\n};\n\nconst toBarOptionsHorizontal = ( options?: DPaneOptions ): DScrollBarOptions | undefined => {\n\treturn options && options.bar && options.bar.horizontal;\n};\n\n// Class\nexport class DPane<\n\tTHEME extends DThemePane = DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DPaneOptions<THEME, CONTENT_OPTIONS> = DPaneOptions<THEME, CONTENT_OPTIONS>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static WORK_ON_FOCUSED = new Point();\n\tprotected _content!: DBase;\n\tprotected _overflowMask!: DBaseOverflowMask | null;\n\tprotected _verticalBar?: DScrollBarVertical;\n\tprotected _horizontalBar?: DScrollBarHorizontal;\n\tprotected _dragUtil?: UtilDrag;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._overflowMask = null;\n\n\t\t// Content\n\t\tconst theme = this.theme;\n\t\tconst content = this._content = this.toContent( options );\n\t\tif( isOverflowMaskEnabled( theme, options ) ) {\n\t\t\tthis.mask = this.getOrCreateOverflowMask();\n\t\t}\n\t\tthis.addChild( content );\n\n\t\t// Scroll bar\n\t\tthis.initScrollBar( content, theme, options );\n\n\t\t// Drag\n\t\tthis.initDrag( content, theme, options );\n\t}\n\n\tprotected initDrag( content: DBase, theme: THEME, options?: OPTIONS ): void {\n\t\tconst dragMode = ( options && options.drag && options.drag.mode != null ?\n\t\t\t( utilIsString( options.drag.mode ) ? DDragMode[ options.drag.mode ] : options.drag.mode ) :\n\t\t\ttheme.getDragMode()\n\t\t);\n\t\t// Edge does not fire the wheel event when scrolling using the 2-fingure scroll gesture on a touchpad.\n\t\t// Instead, it fires touch events. This is why the dragging is enabled regardless of the `UtilPointerEvent.touchable`.\n\t\t// https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7134034/\n\t\tif( dragMode === DDragMode.ON || dragMode === DDragMode.TOUCH ) {\n\t\t\tconst position = new Point();\n\t\t\tthis._dragUtil = new UtilDrag({\n\t\t\t\ttarget: this,\n\t\t\t\ttouch: dragMode === DDragMode.TOUCH,\n\t\t\t\ton: {\n\t\t\t\t\tstart: (): void => {\n\t\t\t\t\t\tposition.copyFrom( content.position );\n\t\t\t\t\t},\n\t\t\t\t\tmove: ( dx: number, dy: number ): void => {\n\t\t\t\t\t\tposition.set( position.x + dx, position.y + dy );\n\t\t\t\t\t\tcontent.position.set(\n\t\t\t\t\t\t\tthis.toContentX( content, position.x ),\n\t\t\t\t\t\t\tthis.toContentY( content, position.y )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onRegionMoveX( content: DBase, start: number ) {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t\tcontent.x = - content.width * start;\n\t}\n\n\tprotected onRegionMoveY( content: DBase, start: number ) {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t\tcontent.y = - content.height * start;\n\t}\n\n\tprotected initScrollBar( content: DBase, theme: THEME, options?: OPTIONS ): void {\n\t\t// Vertical bar\n\t\tconst verticalBar = this._verticalBar = new DScrollBarVertical( toBarOptionsVertical( options ) );\n\t\tverticalBar.on( \"regionmove\", ( start: number ): void => {\n\t\t\tthis.onRegionMoveY( content, start );\n\t\t});\n\t\tthis.addChild( verticalBar );\n\n\t\t// Horizontal bar\n\t\tconst horizontalBar = this._horizontalBar = new DScrollBarHorizontal( toBarOptionsHorizontal( options ) );\n\t\thorizontalBar.on( \"regionmove\", ( start: number ): void => {\n\t\t\tthis.onRegionMoveX( content, start );\n\t\t});\n\t\tthis.addChild( horizontalBar );\n\n\t\t//\n\t\tcontent.on( \"move\", (): void => {\n\t\t\tthis.onContentChanged();\n\t\t});\n\t\tcontent.on( \"resize\", (): void => {\n\t\t\tthis.onContentChanged();\n\t\t});\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPane\";\n\t}\n\n\tget content(): DBase {\n\t\treturn this._content;\n\t}\n\n\tprotected toContent( options?: OPTIONS ): DBase {\n\t\tif( options && options.content ) {\n\t\t\tconst content = options.content;\n\t\t\tif( content instanceof DBase ) {\n\t\t\t\treturn content;\n\t\t\t} else {\n\t\t\t\treturn this.newContent( content );\n\t\t\t}\n\t\t}\n\t\treturn this.newContent();\n\t}\n\n\tprotected newContent( options?: CONTENT_OPTIONS ): DBase {\n\t\treturn new DContent( options );\n\t}\n\n\tprotected getOrCreateOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst content = this._content;\n\t\tconst x = this.getWheelContentX( content, deltas.deltaX * deltas.lowest );\n\t\tconst y = this.getWheelContentY( content, deltas.deltaY * deltas.lowest );\n\t\tif( content.x !== x || content.y !== y ) {\n\t\t\tconst dragUtil = this._dragUtil;\n\t\t\tif( dragUtil != null ) {\n\t\t\t\tdragUtil.stop();\n\t\t\t}\n\t\t\tcontent.position.set( x, y );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getWheelContentX( content: DBase, delta: number ): number {\n\t\tif( 0 < delta || delta < 0 ) {\n\t\t\tconst speed = this.theme.getWheelSpeed();\n\t\t\treturn this.toContentX( content, content.x - delta * speed );\n\t\t}\n\t\treturn content.x;\n\t}\n\n\tprotected getWheelContentY( content: DBase, delta: number ): number {\n\t\tif( 0 < delta || delta < 0 ) {\n\t\t\tconst speed = this.theme.getWheelSpeed();\n\t\t\treturn this.toContentY( content, content.y + delta * speed );\n\t\t}\n\t\treturn content.y;\n\t}\n\n\tprotected toContentX( content: DBase, x: number ): number {\n\t\treturn Math.min( 0, Math.max( this.width - content.width, x ) );\n\t}\n\n\tprotected toContentY( content: DBase, y: number ): number {\n\t\treturn Math.min( 0, Math.max( this.height - content.height, y ) );\n\t}\n\n\tprotected isRefitable( target: any ): target is DBase<any, any> {\n\t\treturn super.isRefitable( target ) && ! ( target instanceof DScrollBar );\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected onContentChanged(): void {\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected updateScrollBar(): void {\n\t\tconst verticalBar = this._verticalBar;\n\t\tconst horizontalBar = this._horizontalBar;\n\t\tif( verticalBar != null && horizontalBar != null ) {\n\t\t\tthis.updateScrollBarRegions( verticalBar, horizontalBar );\n\t\t\tthis.updateScrollBarVisibilities( verticalBar, horizontalBar );\n\t\t\tthis.updateScrollBarPositions( verticalBar, horizontalBar );\n\t\t}\n\t}\n\n\tprotected updateScrollBarPositions( verticalBar: DScrollBarVertical, horizontalBar: DScrollBarHorizontal ): void {\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\n\t\tconst verticalBarWidth = verticalBar.width;\n\t\tverticalBar.position.set( width - verticalBarWidth, verticalBarWidth * 0.5 );\n\t\tverticalBar.height = height - verticalBarWidth;\n\n\t\tconst horizontalBarHeight = horizontalBar.height;\n\t\thorizontalBar.position.set( horizontalBarHeight * 0.5, height - horizontalBarHeight );\n\t\thorizontalBar.width = width - horizontalBarHeight;\n\t}\n\n\tprotected updateScrollBarRegions( verticalBar: DScrollBarVertical, horizontalBar: DScrollBarHorizontal ): void {\n\t\tconst content = this._content;\n\t\tconst x = -content.x;\n\t\tconst y = -content.y;\n\t\thorizontalBar.setRegion( x, x + this.width, content.width );\n\t\tverticalBar.setRegion( y, y + this.height, content.height );\n\t}\n\n\tprotected updateScrollBarVisibilities( verticalBar: DScrollBarVertical, horizontalBar: DScrollBarHorizontal ): void {\n\t\tconst isChangedHorizontal = this.updateScrollBarVisibility( horizontalBar );\n\t\tconst isChangedVertical = this.updateScrollBarVisibility( verticalBar );\n\t\tif( isChangedHorizontal || isChangedVertical ) {\n\t\t\t// Update the overflow mask\n\t\t\tconst overflowMask = this._overflowMask;\n\t\t\tif( overflowMask != null ) {\n\t\t\t\tif( horizontalBar.visible || verticalBar.visible ) {\n\t\t\t\t\tconst content = this._content;\n\t\t\t\t\tif( content.mask !== overflowMask ) {\n\t\t\t\t\t\tcontent.mask = overflowMask;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst content = this._content;\n\t\t\t\t\tif( content.mask ) {\n\t\t\t\t\t\tcontent.mask = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Rerender\n\t\t\tDApplications.update();\n\t\t}\n\t}\n\n\tprotected updateScrollBarVisibility( bar: DScrollBar ): boolean {\n\t\tconst isRegionVisible = bar.isRegionVisible();\n\t\tif( bar.visible !== isRegionVisible ) {\n\t\t\tbar.visible = isRegionVisible;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onChildFocused( focused: DBase ): void {\n\t\tconst work = DPane.WORK_ON_FOCUSED;\n\t\tconst content = this.content;\n\t\tconst contentX = content.x;\n\t\tconst contentY = content.y;\n\t\tconst contentWidth = content.width;\n\t\tconst contentHeight = content.height;\n\n\t\twork.set( 0, 0 );\n\t\tfocused.toGlobal( work, work, false );\n\t\tcontent.toLocal( work, undefined, work, false );\n\t\tconst x0 = contentX + Math.min( contentWidth, Math.max( 0, work.x ) );\n\t\tconst y0 = contentY + Math.min( contentHeight, Math.max( 0, work.y ) );\n\n\t\twork.set( focused.width, focused.height );\n\t\tfocused.toGlobal( work, work, true );\n\t\tcontent.toLocal( work, undefined, work, true );\n\t\tconst x1 = contentX + Math.min( contentWidth, Math.max( 0, work.x ) );\n\t\tconst y1 = contentY + Math.min( contentHeight, Math.max( 0, work.y ) );\n\n\t\tconst width = this.width;\n\t\tlet newX: number | null = null;\n\t\tif( x0 < 0 ) {\n\t\t\tif( x1 <= width ) {\n\t\t\t\tnewX = Math.max( width - contentWidth, Math.min( 0, contentX + (0 - x0) ) );\n\t\t\t}\n\t\t} else {\n\t\t\tif( width < x1 ) {\n\t\t\t\tnewX = Math.max( width - contentWidth, Math.min( 0, contentX - (x1 - width) ) );\n\t\t\t}\n\t\t}\n\n\t\tconst height = this.height;\n\t\tlet newY: number | null = null;\n\t\tif( y0 < 0 ) {\n\t\t\tif( y1 <= height ) {\n\t\t\t\tnewY = Math.max( height - contentHeight, Math.min( 0, contentY + (0 - y0) ) );\n\t\t\t}\n\t\t} else {\n\t\t\tif( height < y1 ) {\n\t\t\t\tnewY = Math.max( height - contentHeight, Math.min( 0, contentY - (y1 - height) ) );\n\t\t\t}\n\t\t}\n\n\t\tif( newX != null ) {\n\t\t\tif( newY != null ) {\n\t\t\t\tcontent.position.set( newX, newY );\n\t\t\t} else {\n\t\t\t\tcontent.position.x = newX;\n\t\t\t}\n\t\t} else {\n\t\t\tif( newY != null ) {\n\t\t\t\tcontent.position.y = newY;\n\t\t\t}\n\t\t}\n\n\t\tsuper.onChildFocused( focused );\n\t}\n\n\tdestroy(): void {\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\t\tthis.mask = null;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DListSelection, DListSelectionOptions } from \"./d-list-selection\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DListOptions<\n\tTHEME extends DThemeList = DThemeList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\tselection?: DListSelectionOptions | DListSelection;\n}\n\nexport interface DThemeList extends DThemePane {\n\n}\n\nexport class DList<\n\tTHEME extends DThemeList = DThemeList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DListOptions<THEME, CONTENT_OPTIONS> = DListOptions<THEME, CONTENT_OPTIONS>\n> extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _selection!: DListSelection;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst selection = options && options.selection;\n\t\tthis._selection = ( selection instanceof DListSelection ?\n\t\t\tselection : this.newSelection( selection )\n\t\t);\n\n\t\tUtilPointerEvent.onClick( this, ( e: InteractionEvent ): void => {\n\t\t\tconst child: DisplayObject | null = this.findItem( e.target );\n\t\t\tif( child instanceof DBase && child.isActionable() ) {\n\t\t\t\tthis.selection.add( child );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newSelection( options?: DListSelectionOptions ): DListSelection {\n\t\treturn new DListSelection( this._content, options );\n\t}\n\n\tprotected onChildrenDirty(): void {\n\t\tconst selection = this._selection;\n\t\tif( selection != null ) {\n\t\t\tselection.toDirty();\n\t\t}\n\t\tsuper.onChildrenDirty();\n\t}\n\n\tget selection(): DListSelection {\n\t\treturn this._selection;\n\t}\n\n\tprotected findItem( target: DisplayObject | null ): DisplayObject | null {\n\t\tconst content = this.content;\n\t\tlet current = target;\n\t\twhile( current != null ) {\n\t\t\tif( current.parent === content ) {\n\t\t\t\treturn current;\n\t\t\t}\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tonRefit(): void {\n\t\tsuper.onRefit();\n\t\tthis.updateChildPosition();\n\t\tthis.updateChildVisibility();\n\t}\n\n\tprotected updateChildPosition(): void {\n\t\tconst content = this.content;\n\t\tconst items = content.children;\n\t\tlet y = 0;\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DBase ) {\n\t\t\t\titem.y = y;\n\t\t\t\ty += item.height;\n\t\t\t}\n\t\t}\n\t\tconst scrollLimit = Math.min( 0, -y + this.height );\n\t\tif( content.y < scrollLimit ) {\n\t\t\tcontent.y = scrollLimit;\n\t\t}\n\t\tcontent.height = y;\n\t}\n\n\tprotected updateChildVisibility(): void {\n\t\tconst content = this.content;\n\t\tconst items = content.children;\n\t\tconst from = -content.y;\n\t\tconst to = from + this.height;\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DBase ) {\n\t\t\t\tconst itemY = item.y;\n\t\t\t\titem.visible = ( from <= itemY + item.height && itemY <= to );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onContentChanged(): void {\n\t\tsuper.onContentChanged();\n\t\tthis.updateChildVisibility();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DList\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DContentOptions } from \"./d-content\";\nimport { DList, DListOptions, DThemeList } from \"./d-list\";\n\nexport interface DDialogSelectListOptions<\n\tTHEME extends DThemeDialogSelecList = DThemeDialogSelecList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DListOptions<THEME, CONTENT_OPTIONS> {\n\n}\n\nexport interface DThemeDialogSelecList extends DThemeList {\n\n}\n\nexport class DDialogSelectList<\n\tTHEME extends DThemeDialogSelecList = DThemeDialogSelecList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DDialogSelectListOptions<THEME, CONTENT_OPTIONS> = DDialogSelectListOptions<THEME, CONTENT_OPTIONS>\n> extends DList<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSelectList\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DNoteOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeNote = DThemeNote\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeNote extends DThemeText {\n\n}\n\nexport class DNote<\n\tVALUE = unknown,\n\tTHEME extends DThemeNote = DThemeNote,\n\tOPTIONS extends DNoteOptions<VALUE, THEME> = DNoteOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.visible = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DNote\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DDialog, DDialogOptions, DThemeDialog } from \"./d-dialog\";\nimport { DDialogSelectList } from \"./d-dialog-select-list\";\nimport { DDialogSelectListItem } from \"./d-dialog-select-list-item\";\nimport { DInputText } from \"./d-input-text\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DListItem } from \"./d-list-item\";\nimport { DListSelection } from \"./d-list-selection\";\nimport { DNote, DNoteOptions } from \"./d-note\";\nimport { utilIsNumber } from \"./util/util-is-number\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilTransition } from \"./util/util-transition\";\n\nexport interface Search<SEARCH_RESULT> {\n\tcreate( args: [ string ] ): void;\n\ton( event: \"success\", handler: ( e: unknown, searchResults: SEARCH_RESULT[] ) => void ): void;\n\ton( event: \"change\", handler: () => void ): void;\n\tisDone(): boolean;\n\tgetResult(): SEARCH_RESULT[] | null;\n}\n\nexport interface Controller<SEARCH_RESULT> {\n\tsearch: Search<SEARCH_RESULT>;\n}\n\nexport interface DDialogSelectOptions<\n\tSEARCH_RESULT,\n\tTHEME extends DThemeDialogSelect = DThemeDialogSelect\n> extends DDialogOptions<THEME> {\n\tcontroller: Controller<SEARCH_RESULT>;\n\tconverter?: {\n\t\ttoLabel?: ( searchResult: SEARCH_RESULT ) => string;\n\t};\n\tnote?: {\n\t\tnoItems?: DNoteOptions;\n\t\tsearching?: DNoteOptions;\n\t};\n}\n\nexport interface DThemeDialogSelect extends DThemeDialog {\n\tgetNoteNoItemsText(): string;\n\tgetNoteSearchingText(): string;\n}\n\n// Helper\nconst defaultConverter = {\n\ttoLabel: ( target: any ): string => {\n\t\tif( utilIsString( target ) ) {\n\t\t\treturn target;\n\t\t} else if( utilIsNumber( target ) ) {\n\t\t\treturn String( target );\n\t\t} else if( \"name\" in target ) {\n\t\t\treturn target.name;\n\t\t} else if( \"label\" in target ) {\n\t\t\treturn target.label;\n\t\t} else if( \"id\" in target ) {\n\t\t\treturn target.id;\n\t\t} else {\n\t\t\treturn \"\";\n\t\t}\n\t}\n};\n\nconst toToLabel = <SEARCH_RESULT>( options: DDialogSelectOptions<SEARCH_RESULT, any> ) => {\n\treturn ( options.converter != null ? options.converter.toLabel : null ) || defaultConverter.toLabel;\n};\n\nconst toNoteOptions = ( options: DNoteOptions | undefined, parent: DBase, text: string ): DNoteOptions => {\n\tif( options != null ) {\n\t\tif( options.parent == null ) {\n\t\t\toptions.parent = parent;\n\t\t}\n\t\tif( options.text == null ) {\n\t\t\toptions.text = {\n\t\t\t\tvalue: text\n\t\t\t};\n\t\t} else if( options.text.value == null ) {\n\t\t\toptions.text.value = text;\n\t\t}\n\t\treturn options;\n\t}\n\treturn {\n\t\tparent,\n\t\ttext: {\n\t\t\tvalue: text\n\t\t}\n\t};\n};\n\nconst toNoteNoItemsOptions = (\n\ttheme: DThemeDialogSelect, options: DDialogSelectOptions<any>, parent: DBase\n): DNoteOptions => {\n\treturn toNoteOptions(\n\t\toptions.note && options.note.noItems,\n\t\tparent,\n\t\ttheme.getNoteNoItemsText()\n\t);\n};\n\nconst toNoteSearchingOptions = (\n\ttheme: DThemeDialogSelect, options: DDialogSelectOptions<any>, parent: DBase\n): DNoteOptions => {\n\treturn toNoteOptions(\n\t\toptions.note && options.note.searching,\n\t\tparent,\n\t\ttheme.getNoteSearchingText()\n\t);\n};\n\nexport class DDialogSelect<\n\tSEARCH_RESULT,\n\tTHEME extends DThemeDialogSelect = DThemeDialogSelect,\n\tOPTIONS extends DDialogSelectOptions<SEARCH_RESULT, THEME> = DDialogSelectOptions<SEARCH_RESULT, THEME>\n> extends DDialog<THEME, OPTIONS> {\n\tprotected _value: SEARCH_RESULT | null;\n\tprotected _input: DInputText;\n\tprotected _list: DDialogSelectList;\n\tprotected _noteNoItems: DNote;\n\tprotected _noteSearching: DNote;\n\tprotected _controller: Controller<SEARCH_RESULT>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._value = null;\n\t\tconst theme = this.theme;\n\t\tconst controller = this._controller = options.controller;\n\t\tconst toLabel = toToLabel( options );\n\n\t\tconst layout = new DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: \"padding\", y: \"padding\",\n\t\t\twidth: \"padding\", height: \"auto\"\n\t\t});\n\n\t\t// Search box\n\t\tthis._input = new DInputText({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\"\n\t\t});\n\n\t\t// List\n\t\tconst list = this._list = new DDialogSelectList({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\",\n\t\t\tselection: {\n\t\t\t\ton: {\n\t\t\t\t\tchange: ( selection: DListSelection ): void => {\n\t\t\t\t\t\tconst item: DListItem<SEARCH_RESULT> | null = selection.first();\n\t\t\t\t\t\tif( item != null ) {\n\t\t\t\t\t\t\tconst value = this._value = item.value;\n\t\t\t\t\t\t\tthis.emit( \"select\", value, this );\n\t\t\t\t\t\t\tthis.close();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Text No Items\n\t\tconst noteNoItems = new DNote( toNoteNoItemsOptions( theme, options, list ) );\n\t\tthis._noteNoItems = noteNoItems;\n\n\t\t// Text Searching\n\t\tconst noteSearching = new DNote( toNoteSearchingOptions( theme, options, list ) );\n\t\tthis._noteSearching = noteSearching;\n\n\t\t// Controller binding\n\t\tthis._input.on( \"input\", ( value: string ): void => {\n\t\t\tcontroller.search.create([ value ]);\n\t\t});\n\n\t\tcontroller.search.on( \"success\", ( e: unknown, searchResults: SEARCH_RESULT[] ): void => {\n\t\t\tconst content = list.content;\n\t\t\tconst children = content.children;\n\n\t\t\t// Update the existing children\n\t\t\tconst childrenLength = children.length;\n\t\t\tconst searchResultsLength = searchResults.length;\n\t\t\tconst minLength = Math.min( childrenLength, searchResultsLength );\n\t\t\tfor( let i = 0, imax = minLength; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tconst searchResult = searchResults[ i ];\n\t\t\t\tif( child instanceof DListItem ) {\n\t\t\t\t\tchild.text = toLabel( searchResult );\n\t\t\t\t\tchild.value = searchResult;\n\t\t\t\t} else {\n\t\t\t\t\tcontent.removeChildAt( i );\n\t\t\t\t\tchild.destroy();\n\t\t\t\t\tconst newChild = this.newItem( searchResult, toLabel( searchResult ) );\n\t\t\t\t\tcontent.addChildAt( newChild, i );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Insert new children\n\t\t\tfor( let i = minLength, imax = searchResultsLength; i < imax; ++i ) {\n\t\t\t\tconst searchResult = searchResults[ i ];\n\t\t\t\tconst newChild = this.newItem( searchResult, toLabel( searchResult ) );\n\t\t\t\tcontent.addChild( newChild );\n\t\t\t}\n\n\t\t\t// Remove unused children\n\t\t\tfor( let i = childrenLength - 1; minLength <= i; --i ) {\n\t\t\t\tchildren[ i ].destroy();\n\t\t\t}\n\t\t});\n\n\t\t// Visibility\n\t\tconst transition = new UtilTransition();\n\t\tcontroller.search.on( \"change\", (): void => {\n\t\t\tif( controller.search.isDone() ) {\n\t\t\t\tconst result = controller.search.getResult();\n\t\t\t\tif( result != null && 0 < result.length ) {\n\t\t\t\t\ttransition.hide();\n\t\t\t\t} else {\n\t\t\t\t\ttransition.show( noteNoItems );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttransition.show( noteSearching );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newItem( searchResult: SEARCH_RESULT, label: string ): DDialogSelectListItem<SEARCH_RESULT> {\n\t\treturn new DDialogSelectListItem<SEARCH_RESULT>({\n\t\t\tvalue: searchResult,\n\t\t\ttext: {\n\t\t\t\tvalue: label\n\t\t\t}\n\t\t});\n\t}\n\n\tget value() {\n\t\treturn this._value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSelect\";\n\t}\n\n\tprotected onOpen() {\n\t\tsuper.onOpen();\n\t\tthis._list.selection.clear();\n\t\tthis._controller.search.create([ this._input.value ]);\n\t}\n\n\tprotected onClose() {\n\t\tsuper.onClose();\n\t}\n\n\tdestroy() {\n\t\tthis._input.destroy();\n\t\tthis._noteNoItems.destroy();\n\t\tthis._noteSearching.destroy();\n\t\tthis._list.destroy();\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\n\nexport interface Owner {\n\tfocus(): void;\n}\n\nexport interface Parent {\n\tparent: unknown;\n}\n\nexport interface Closeable extends DisplayObject {\n\tclose(): void;\n}\n\nexport class DMenuContext {\n\tprotected _owner: Owner;\n\tprotected _closeables: Closeable[];\n\n\tconstructor( owner: Owner ) {\n\t\tthis._owner = owner;\n\t\tthis._closeables = [];\n\t}\n\n\tprotected indexOf( target: unknown ): number {\n\t\treturn this._closeables.indexOf( target as any );\n\t}\n\n\tprotected close( index: number ): void {\n\t\tconst closeables = this._closeables;\n\t\tconst imin = Math.max( 0, index );\n\t\tfor( let i = closeables.length - 1; imin <= i; --i ) {\n\t\t\tcloseables[ i ].close();\n\t\t}\n\t}\n\n\tadd( closeable: Closeable ): void {\n\t\tthis._closeables.push( closeable );\n\t}\n\n\ttrim( closeable: Closeable | null ): void {\n\t\tthis.close( this.indexOf( closeable ) + 1 );\n\t}\n\n\tremove( closeable: Closeable ): void {\n\t\tconst index = this.indexOf( closeable );\n\t\tif( 0 <= index ) {\n\t\t\tthis.close( index + 1 );\n\t\t\tthis._closeables.splice( index, 1 );\n\t\t\tif( index === 0 ) {\n\t\t\t\tthis._owner.focus();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DControllers } from \"./d-controllers\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\nimport { DMenuAlign } from \"./d-menu-align\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenus } from \"./d-menus\";\nimport { UtilAttach } from \"./util/util-attach\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DMenuOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenu = DThemeMenu\n> extends DLayoutVerticalOptions<THEME> {\n\talign?: (keyof typeof DMenuAlign) | DMenuAlign;\n\tfit?: boolean;\n\tsticky?: boolean;\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n}\n\nexport interface DThemeMenu extends DThemeLayoutVertical {\n\tgetOffsetX(): number;\n\tgetOffsetY(): number;\n}\n\nexport class DMenu<\n\tVALUE,\n\tTHEME extends DThemeMenu = DThemeMenu,\n\tOPTIONS extends DMenuOptions<VALUE, THEME> = DMenuOptions<VALUE, THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _align!: DMenuAlign;\n\tprotected _fit!: boolean;\n\tprotected _sticky!: boolean;\n\tprotected _sub!: boolean;\n\tprotected _owner!: DBase<any, any> | null;\n\tprotected _context!: DMenuContext | null;\n\tprotected _onPrerenderBound!: () => void;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._onPrerenderBound = (): void => {\n\t\t\tthis.onPrerender();\n\t\t};\n\n\t\tif( options != null ) {\n\t\t\tthis._align = ( options.align != null ?\n\t\t\t\t( utilIsString( options.align ) ? DMenuAlign[ options.align ] : options.align ) :\n\t\t\t\tDMenuAlign.BOTTOM\n\t\t\t);\n\t\t\tthis._fit = ( options.fit != null ? options.fit : false );\n\t\t\tthis._sticky = ( options.sticky != null ? options.sticky : false );\n\t\t} else {\n\t\t\tthis._align = DMenuAlign.BOTTOM;\n\t\t\tthis._fit = false;\n\t\t\tthis._sticky = false;\n\t\t}\n\t\tthis._sub = false;\n\t\tthis._owner = null;\n\t\tthis.visible = false;\n\t\tthis._context = null;\n\t\tthis.setState( DBaseState.FOCUS_ROOT, true );\n\n\t\t// Event handlers\n\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\tthis.on( \"select\", (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\t// Items\n\t\tif( options != null && options.items != null ) {\n\t\t\tDMenus.newItems( this, options.items, this._sticky );\n\t\t}\n\t}\n\n\tfindItem( value: VALUE ): DMenuItem<VALUE> | null {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DMenuItem && child.value === value ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenu\";\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen( owner: DBase<any, any>, closeable?: Closeable | null, context?: DMenuContext | null ): this {\n\t\tif( this.isHidden() ) {\n\t\t\tthis._owner = owner;\n\n\t\t\t// States\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.setState( DBaseState.FOCUSED | DBaseState.HOVERED, false );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Position & size\n\t\t\tconst application = DApplications.getInstance();\n\t\t\tconst renderer = application.renderer;\n\t\t\tconst onPrerenderBound = this._onPrerenderBound;\n\t\t\tif( this._sticky ) {\n\t\t\t\trenderer.on( \"prerender\", onPrerenderBound );\n\t\t\t} else {\n\t\t\t\trenderer.once( \"prerender\", onPrerenderBound );\n\t\t\t}\n\t\t\tif( this._fit ) {\n\t\t\t\tconst bounds = owner.getBounds();\n\t\t\t\tif( bounds != null ) {\n\t\t\t\t\tthis.width = bounds.width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Target\n\t\t\tthis._sub = (context != null);\n\t\t\tcontext = context || new DMenuContext( owner );\n\t\t\tif( closeable != null ) {\n\t\t\t\tcontext.trim( closeable );\n\t\t\t}\n\t\t\tcontext.add( this );\n\t\t\tthis._context = context;\n\n\t\t\t// Stage\n\t\t\tapplication.stage.addChild( this );\n\n\t\t\t// Focus\n\t\t\tthis.focus();\n\n\t\t\t// Show\n\t\t\tsuper.show();\n\n\t\t\t// Event\n\t\t\tthis.emit( \"open\", this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected onPrerender(): void {\n\t\tconst owner = this._owner;\n\t\tif( owner != null ) {\n\t\t\tconst bounds = owner.getBounds();\n\t\t\tif( bounds != null ) {\n\t\t\t\tif( this._fit ) {\n\t\t\t\t\tthis.width = bounds.width;\n\t\t\t\t}\n\t\t\t\tconst theme = this.theme;\n\t\t\t\tconst application = DApplications.getInstance();\n\t\t\t\tUtilAttach.attach(\n\t\t\t\t\tthis,\n\t\t\t\t\tbounds,\n\t\t\t\t\ttheme.getOffsetX(), theme.getOffsetY(),\n\t\t\t\t\tapplication.width, application.height,\n\t\t\t\t\tthis._align\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tclose(): this {\n\t\tif( this.isShown() ) {\n\t\t\tconst context = this._context;\n\t\t\tif( context != null ) {\n\t\t\t\tcontext.remove( this );\n\t\t\t}\n\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.removeChild( this );\n\t\t\t}\n\n\t\t\tDApplications.getInstance().renderer.off( \"prerender\", this._onPrerenderBound );\n\n\t\t\tthis._owner = null;\n\n\t\t\tsuper.hide();\n\n\t\t\tthis.emit( \"close\", this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isArrowUpKey( e ) || UtilKeyboardEvent.isArrowDownKey( e ) ) {\n\t\t\tconst focusController = DControllers.getFocusController();\n\t\t\tconst focused = focusController.getFocused();\n\t\t\tif( focused != null ) {\n\t\t\t\tconst direction = UtilKeyboardEvent.isArrowDownKey( e );\n\t\t\t\tconst next = focusController.findFocusable(\n\t\t\t\t\tfocused, false, focused.hasState( DBaseState.FOCUS_ROOT ) || direction, direction\n\t\t\t\t);\n\t\t\t\tif( next != null ) {\n\t\t\t\t\tfocusController.setFocused( next, true, true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn ! this._sub;\n\t}\n}\n\nDMenus.setMenuCreator( ( options?: DMenuOptions<any> ) => new DMenu<any>( options ) );\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\nimport { DMenu, DMenuOptions, DThemeMenu } from \"./d-menu\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport interface DDropdownOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDropdown = DThemeDropdown\n> extends DButtonBaseOptions<string, THEME> {\n\tmenu?: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\nexport interface DThemeDropdown extends DThemeButtonBase {\n\tgetTextFormatter(): ( value: string, caller: DDropdown ) => string;\n\tgetTextValue( state: DBaseState ): string;\n\tnewTextValue(): DStateAwareOrValueMightBe<string>;\n}\n\nexport class DDropdown<\n\tVALUE = unknown,\n\tTHEME extends DThemeDropdown = DThemeDropdown,\n\tOPTIONS extends DDropdownOptions<VALUE, THEME> = DDropdownOptions<VALUE, THEME>\n> extends DButtonBase<string, THEME, OPTIONS> {\n\tprotected _menu!: DMenu<VALUE>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tthis.start();\n\t\t});\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._menu = this.toMenu( this.theme, options );\n\t}\n\n\tprotected toMenu( theme: THEME, options?: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options && options.menu;\n\t\treturn ( menu instanceof DMenu ? menu :\n\t\t\tnew DMenu<VALUE>( this.toMenuOptions( theme, menu ) )\n\t\t);\n\t}\n\n\tprotected toMenuOptions( theme: THEME, options?: DMenuOptions<VALUE> ): DMenuOptions<VALUE, DThemeMenu> {\n\t\toptions = options || {};\n\t\tif( options.fit == null ) {\n\t\t\toptions.fit = true;\n\t\t}\n\t\treturn options;\n\t}\n\n\tget menu(): DMenu<VALUE> {\n\t\treturn this._menu;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDropdown\";\n\t}\n\n\tstart(): void {\n\t\tthis._menu.open( this );\n\t}\n\n\tclose(): void {\n\t\tthis._menu.close();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DListItem, DListItemSelection } from \"./d-list-item\";\nimport { DMenu } from \"./d-menu\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport enum DMenuSidedSelectionMode {\n\tNONE,\n\tSINGLE,\n\tSINGLE_ONCE,\n\tDEFAULT = SINGLE_ONCE\n}\n\nexport interface DMenuSidedSelectionOptions {\n\tmode?: (keyof typeof DMenuSidedSelectionMode) | DMenuSidedSelectionMode;\n\ton?: { [ name: string ]: Function };\n\tfilter?: ( item: DBase | null ) => boolean;\n}\n\nconst defaultFilter = () => true;\n\nexport class DMenuSidedSelection extends utils.EventEmitter implements DListItemSelection {\n\tprotected _content: Container;\n\tprotected _item: DBase | null;\n\tprotected _isDirty: boolean;\n\tprotected _mode: DMenuSidedSelectionMode;\n\tprotected _filter: ( item: DBase | null ) => boolean;\n\n\tconstructor( content: Container, options?: DMenuSidedSelectionOptions ) {\n\t\tsuper();\n\n\t\tthis._content = content;\n\t\tthis._item = null;\n\t\tthis._isDirty = true;\n\t\tthis._mode = ( options && options.mode != null ?\n\t\t\t(utilIsString( options.mode ) ? DMenuSidedSelectionMode[ options.mode ] : options.mode) :\n\t\t\tDMenuSidedSelectionMode.DEFAULT\n\t\t);\n\t\tthis._filter = ( options && options.filter ) || this.getFilterDefault();\n\n\t\t// Events\n\t\tconst on = options && options.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tthis.on( name, on[ name ] );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tupdate() {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis.update_( this._content );\n\t\t}\n\t}\n\n\tprotected hasMenu( child: any ): child is { menu: DMenu<any> } {\n\t\treturn child && child.menu instanceof DMenu;\n\t}\n\n\tprotected update_( root: Container ): void {\n\t\tconst children = root.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DListItem ) {\n\t\t\t\tif( child.isActive() ) {\n\t\t\t\t\tthis.set_( child, false );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( child instanceof Container ) {\n\t\t\t\tthis.update_( child );\n\t\t\t}\n\n\t\t\tif( this.hasMenu( child ) ) {\n\t\t\t\tthis.update_( child.menu );\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( item: DBase ): void {\n\t\tthis.update();\n\t\tthis.set_( item, true );\n\t}\n\n\tset( item: DBase ): void {\n\t\tthis.update();\n\t\tthis.set_( item, true );\n\t}\n\n\tget(): DBase | null {\n\t\tthis.update();\n\t\treturn this._item;\n\t}\n\n\tsize(): number {\n\t\treturn ( this._item ? 1 : 0 );\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._item == null;\n\t}\n\n\tremove( item: DBase ): void {\n\t\tthis.update();\n\t\tif( this._item === item ) {\n\t\t\tthis.set_( null, true );\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tthis.update();\n\t\tthis.set_( null, true );\n\t}\n\n\tprotected getFilterDefault(): ( item: DBase | null ) => boolean {\n\t\treturn defaultFilter;\n\t}\n\n\tprotected set_( item: DBase | null, emit: boolean ): void {\n\t\tconst oldItem = this._item;\n\t\tconst mode = this._mode;\n\t\tif( mode !== DMenuSidedSelectionMode.NONE && this._filter( item ) && oldItem !== item ) {\n\t\t\tthis.setState( oldItem, mode, false );\n\t\t\tthis._item = item;\n\t\t\tthis.setState( item, mode, true );\n\t\t\tif( emit ) {\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected setState( item: DBase | null, mode: DMenuSidedSelectionMode, isOn: boolean ): void {\n\t\tif( item ) {\n\t\t\tif( mode === DMenuSidedSelectionMode.SINGLE ) {\n\t\t\t\titem.setState( DBaseState.ACTIVE, isOn );\n\t\t\t} else {\n\t\t\t\titem.setState( DBaseState.ACTIVE | DBaseState.READ_ONLY, isOn );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DExpandableHeaderOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeExpandableHeader = DThemeExpandableHeader\n> extends DImageOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeExpandableHeader extends DThemeImage {\n\n}\n\nexport class DExpandableHeader<\n\tVALUE = unknown,\n\tTHEME extends DThemeExpandableHeader = DThemeExpandableHeader,\n\tOPTIONS extends DExpandableHeaderOptions<VALUE, THEME> = DExpandableHeaderOptions<VALUE, THEME>\n> extends DImage<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.on( UtilPointerEvent.down, (): void => {\n\t\t\tif( this.isActionable() ) {\n\t\t\t\tthis.onSelect();\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onSelect() {\n\t\tthis.emit( \"select\", this );\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( this.isActionable() && this.isFocused() && UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onSelect();\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DExpandableHeader\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DExpandableHeader, DExpandableHeaderOptions } from \"./d-expandable-header\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DExpandableOptions<\n\tTHEME extends DThemeExpandable = DThemeExpandable\n> extends DLayoutVerticalOptions<THEME> {\n\theader?: DisplayObject | DExpandableHeaderOptions;\n\tbody: Container;\n}\n\nexport interface DThemeExpandable extends DThemeLayoutVertical {\n\n}\n\nexport class DExpandable<\n\tTHEME extends DThemeExpandable = DThemeExpandable,\n\tOPTIONS extends DExpandableOptions<THEME> = DExpandableOptions<THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _header!: DisplayObject;\n\tprotected _body!: Container;\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Header\n\t\tconst theme = this.theme;\n\t\tconst header = this.toHeader( theme, options );\n\t\tthis._header = header;\n\t\theader.on( \"select\", (): void => {\n\t\t\tthis.toggle();\n\t\t});\n\t\tthis.addChild( header );\n\n\t\t// Body\n\t\tconst body = this.toBody( theme, options );\n\t\tthis._body = body;\n\t\tthis.addChild( body );\n\n\t\t//\n\t\tif( this.isActive() ) {\n\t\t\tthis.onActivated();\n\t\t} else {\n\t\t\tthis.onDeactivated();\n\t\t}\n\t}\n\n\tprotected toHeader( theme: THEME, options?: OPTIONS ): DisplayObject {\n\t\tif( options && options.header ) {\n\t\t\tif( options.header instanceof DisplayObject ) {\n\t\t\t\treturn options.header;\n\t\t\t} else {\n\t\t\t\treturn this.newHeader( theme, options.header );\n\t\t\t}\n\t\t}\n\t\treturn this.newHeader( theme );\n\t}\n\n\tprotected newHeader( theme: THEME, options?: DExpandableHeaderOptions ): DisplayObject {\n\t\treturn new DExpandableHeader( options );\n\t}\n\n\tprotected toBody( theme: THEME,  options: OPTIONS ): Container {\n\t\treturn options.body;\n\t}\n\n\topen(): void {\n\t\tthis.setActive( true );\n\t}\n\n\tclose(): void {\n\t\tthis.setActive( false );\n\t}\n\n\ttoggle(): void {\n\t\tthis.setActive( ! this.isActive() );\n\t}\n\n\tprotected onActivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.show();\n\t\t} else {\n\t\t\tbody.visible = true;\n\t\t}\n\t}\n\n\tprotected onDeactivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.hide();\n\t\t} else {\n\t\t\tbody.visible = false;\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: DBaseState, oldState: DBaseState ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tif( DBaseStates.isActive( newState ) ) {\n\t\t\tif( ! DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onActivated();\n\t\t\t}\n\t\t} else {\n\t\t\tif( DBaseStates.isActive( oldState ) ) {\n\t\t\t\tthis.onDeactivated();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DExpandable\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputInteger, DInputIntegerOptions, DThemeInputInteger } from \"./d-input-integer\";\n\nexport interface DInputIntegerAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputIntegerOptions, THEME> {}\n\nexport class DInputIntegerAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputIntegerAndLabelOptions<THEME> = DInputIntegerAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputInteger, DInputIntegerOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputIntegerOptions<DThemeInputInteger> ): DInputInteger {\n\t\treturn new DInputInteger( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMapCoordinate, DMapPoint } from \"./d-map-coordinate\";\n\nexport class DMapCoordinateEPSG3857 implements DMapCoordinate {\n\tprotected static CIRCUMFERENCE_HALF: number = Math.PI * 6378137 /* Approximate earth radius in meter */;\n\tprotected _tileSize: number;\n\n\tconstructor( tileSize: number = 256 ) {\n\t\tthis._tileSize = tileSize;\n\t}\n\n\tgetTileSize(): number {\n\t\treturn this._tileSize;\n\t}\n\n\t/**\n\t * Converts the given (lon, lat) point in WGS84 to (x, y) in EPSG:900913.\n\t * The origin of the converted point (x, y) is at the middle-left corner.\n\t * The `meters` can be the same instance that is passed in as the `lonlat`.\n\t *\n\t * @param lonlat (lon, lat) point\n\t * @param meters (x, y) point in meters converted from the given lonlat.\n\t * @return (x, y) point in meters\n\t * @see https://www.maptiler.com/google-maps-coordinates-tile-bounds-projection/\n\t * @see https://qiita.com/MALORGIS/items/1a9114dd090e5b891bf7\n\t */\n\tlonLatToMeters( lonlat: DMapPoint, meters: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = lonlat.x * C / 180;\n\t\tmeters.y = Math.log( Math.tan( ( 90 + lonlat.y ) * Math.PI / 360 ) ) * C / Math.PI;\n\t\treturn meters;\n\t}\n\n\t/**\n\t * The `lonlat` can be the same instance that is passed in as the `meters`.\n\t *\n\t * @param meters\n\t * @param lonlat\n\t */\n\tmetersToLonLat( meters: DMapPoint, lonlat: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tlonlat.x = meters.x / C * 180;\n\t\tlonlat.y = Math.atan( Math.exp( meters.y * Math.PI / C ) ) * 360 / Math.PI - 90;\n\t\treturn lonlat;\n\t}\n\n\t/**\n\t * Converts pixel coordinates in given zoom level of pyramid to EPSG:900913.\n\t * The origin of the `pixels` is the top-left corner.\n\t * The `meters` can be the same instance that is passed in as the `pixels`.\n\t */\n\tpixelsToMeters( pixels: DMapPoint, tz: number, tileSize: number, meters: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolution( tz, tileSize );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = pixels.x * R - C;\n\t\tmeters.y = C - pixels.y * R;\n\t\treturn meters;\n\t}\n\n\t/**\n\t * Converts EPSG:900913 to pyramid pixel coordinates in given zoom level.\n\t * The origin of the pixels is the top-left corner.\n\t * The `pixels` can be the same instance that is passed in as the `meters`.\n\t */\n\tmetersToPixels( meters: DMapPoint, tz: number, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolution( tz, tileSize );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tpixels.x = ( meters.x + C ) / R;\n\t\tpixels.y = ( C - meters.y ) / R;\n\t\treturn pixels;\n\t}\n\n\t/**\n\t * Returns a tile covering region in given pixel coordinates.\n\t * The origin of the tile is the top-left corner.\n\t * The `tile` can be the same instance that is passed in as the `pixels`.\n\t */\n\tpixelsToTile( pixels: DMapPoint, tileSize: number, tile: DMapPoint ): DMapPoint {\n\t\ttile.x = Math.ceil( pixels.x / tileSize ) - 1;\n\t\ttile.y = Math.ceil( pixels.y / tileSize ) - 1;\n\t\treturn tile;\n\t}\n\n\t/**\n\t * The origin of the tile is the top-left corner.\n\t * The `tile` can be the same instance that is passed in as the `meters`.\n\t */\n\tmetersToTile( meters: DMapPoint, tz: number, tile: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tconst Z = 1 << tz;\n\t\ttile.x = Math.ceil( 0.5 * ( meters.x / C + 1 ) * Z ) - 1;\n\t\ttile.y = Math.ceil( 0.5 * ( 1 - meters.y / C ) * Z ) - 1;\n\t\treturn tile;\n\t}\n\n\tlonLatToTile( lonlat: DMapPoint, tz: number, tile: DMapPoint ): DMapPoint {\n\t\treturn this.metersToTile( this.lonLatToMeters( lonlat, tile ), tz, tile );\n\t}\n\n\tlonLatToPixels( lonlat: DMapPoint, tz: number, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\treturn this.metersToPixels( this.lonLatToMeters( lonlat, pixels ), tz, tileSize, pixels );\n\t}\n\n\tpixelsToLonLat( pixels: DMapPoint, tz: number, tileSize: number, lonlat: DMapPoint ): DMapPoint {\n\t\treturn this.metersToLonLat( this.pixelsToMeters( pixels, tz, tileSize, lonlat ), lonlat );\n\t}\n\n\t/**\n\t * The `pixels` can be the same instance that is passed in as the `tile`.\n\t */\n\ttileToPixels( tile: DMapPoint, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\tpixels.x = tile.x * tileSize;\n\t\tpixels.y = tile.y * tileSize;\n\t\treturn pixels;\n\t}\n\n\t/**\n\t * Returns bounds of the given tile in EPSG:900913 coordinates\n\t * The `meters` can be the same instance that is passed in as the `tile`.\n\t */\n\ttileToMeters( tile: DMapPoint, tz: number, meters: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolutionMeter( tz );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = tile.x * R + C;\n\t\tmeters.y = C - tile.y * R;\n\t\treturn meters;\n\t}\n\n\tprotected toResolutionMeter( tz: number ): number {\n\t\treturn ( 2 * DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF ) / ( 1 << tz );\n\t}\n\n\tprotected toResolution( tz: number, tileSize: number ): number {\n\t\treturn ( 2 * DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF ) / ( tileSize << tz );\n\t}\n\n\ttoTileCount( tz: number ): number {\n\t\treturn (1 << tz);\n\t}\n\n\ttoTileCode( tz: number, tx: number, ty: number ): number {\n\t\treturn (tx << tz) + ty;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapCoordinateEPSG3857 } from \"./d-map-coordinate-epsg3857\";\n\nexport class DMapCoordinates {\n\tprotected static _default?: DMapCoordinate;\n\n\tstatic get DEFAULT(): DMapCoordinate {\n\t\tif( this._default == null ) {\n\t\t\tthis._default = new DMapCoordinateEPSG3857();\n\t\t}\n\t\treturn this._default;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, Renderer, resources, Sprite, Texture } from \"pixi.js\";\n\nexport class DMapTile {\n\ttx: number;\n\tty: number;\n\n\tprotected _sprite: Sprite;\n\n\tconstructor(\n\t\tparent: Container,\n\t\ttx: number, ty: number,\n\t\tpx: number, py: number,\n\t\tscale: number\n\t) {\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t\tconst sprite = new Sprite( Texture.EMPTY );\n\t\t(sprite as any).parent = parent;\n\t\tsprite.position.set( px, py );\n\t\tsprite.scale.set( scale, scale );\n\t\tthis._sprite = sprite;\n\t}\n\n\tload( url: string, onLoaded: () => void ): void {\n\t\tconst texture = Texture.from( url, { resolution: 1 } );\n\t\tthis._sprite.texture = texture;\n\t\tif( texture.valid ) {\n\t\t\tonLoaded();\n\t\t} else {\n\t\t\ttexture.on( \"update\", onLoaded );\n\t\t}\n\t}\n\n\ttransform( px: number, py: number, scale: number ): void {\n\t\tconst sprite = this._sprite;\n\t\tsprite.position.set( px, py );\n\t\tsprite.scale.set( scale, scale );\n\t}\n\n\tget loaded(): boolean {\n\t\treturn this._sprite.texture.valid;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tconst sprite = this._sprite;\n\t\tsprite.updateTransform();\n\t\tsprite.render( renderer );\n\t}\n\n\tdestroy(): void {\n\t\tconst sprite = this._sprite;\n\t\tconst texture = sprite.texture;\n\t\tconst resource = texture.baseTexture.resource;\n\t\tlet image: HTMLImageElement | null = null;\n\t\tif( resource instanceof resources.BaseImageResource ) {\n\t\t\tif( resource.source instanceof HTMLImageElement ) {\n\t\t\t\timage = resource.source;\n\t\t\t}\n\t\t}\n\t\ttexture.destroy( true );\n\t\tsprite.destroy();\n\t\tif( image ) {\n\t\t\timage.src = \"\";\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Renderer } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapTile } from \"./d-map-tile\";\nimport { DMapTileMappingInternal } from \"./d-map-tile-mapping-internal\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport class DMapTilePlane {\n\tprotected static WORK: Point = new Point();\n\n\tprotected readonly _parent: DBase;\n\tprotected readonly _builder: DMapTileUrlBuilder;\n\tprotected readonly _tz: number;\n\tprotected _lon0: number;\n\tprotected _lat0: number;\n\tprotected _lon1: number;\n\tprotected _lat1: number;\n\tprotected readonly _tiles: Map<number, DMapTile>;\n\tprotected _renderer?: Renderer;\n\tprotected readonly _renderTileBound: ( tile: DMapTile ) => void;\n\tprotected _txmin: number;\n\tprotected _txmax: number;\n\tprotected _tymin: number;\n\tprotected _tymax: number;\n\tprotected readonly _deleteTileBound: ( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ) => void;\n\tprotected readonly _destroyTileBound: ( tile: DMapTile ) => void;\n\tprotected _tileCount: number;\n\tprotected _tileScale: number;\n\tprotected _tileScaleRelative: number;\n\tprotected _tileSize: number;\n\tprotected _mapping: DMapTileMappingInternal;\n\tprotected _coordinate: DMapCoordinate;\n\tprotected _isLoaded: boolean;\n\tprotected readonly _updateLoadingStateForEach: ( tile: DMapTile ) => void;\n\tprotected readonly _onLoaded: () => void;\n\tprotected readonly _onLoadedBound: () => void;\n\tprotected _isOnLoadedCalled: boolean;\n\tprotected _isOnLoadedAllowed: boolean;\n\n\tconstructor(\n\t\tparent: DBase,\n\t\tbuilder: DMapTileUrlBuilder,\n\t\ttz: number,\n\t\tmapping: DMapTileMappingInternal,\n\t\tcoordinate: DMapCoordinate,\n\t\tonLoaded: () => void\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._builder = builder;\n\t\tthis._onLoaded = onLoaded;\n\t\tthis._isOnLoadedCalled = false;\n\t\tthis._isOnLoadedAllowed = true;\n\t\tthis._onLoadedBound = (): void => {\n\t\t\tthis.onLoaded();\n\t\t};\n\t\tthis._tz = tz;\n\t\tthis._lon0 = NaN;\n\t\tthis._lat0 = NaN;\n\t\tthis._lon1 = NaN;\n\t\tthis._lat1 = NaN;\n\t\tthis._tiles = new Map<number, DMapTile>();\n\t\tthis._renderTileBound = ( tile: DMapTile ): void => {\n\t\t\tthis.renderTile( tile );\n\t\t};\n\t\tthis._txmin = NaN;\n\t\tthis._txmax = NaN;\n\t\tthis._tymin = NaN;\n\t\tthis._tymax = NaN;\n\t\tthis._deleteTileBound = ( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ): void => {\n\t\t\tthis.deleteTile( tile, tileCode, tiles );\n\t\t};\n\t\tthis._destroyTileBound = ( tile: DMapTile ): void => {\n\t\t\tthis.destroyTile( tile );\n\t\t};\n\t\tthis._updateLoadingStateForEach = ( tile: DMapTile ): void => {\n\t\t\tif( ! tile.loaded ) {\n\t\t\t\tthis._isLoaded = false;\n\t\t\t}\n\t\t};\n\t\tthis._tileCount = coordinate.toTileCount( tz );\n\t\tthis._tileScaleRelative = 1 / this._tileCount;\n\t\tthis._tileScale = mapping.scale * this._tileScaleRelative;\n\t\tthis._tileSize = coordinate.getTileSize() * mapping.scale;\n\t\tthis._mapping = mapping;\n\t\tthis._coordinate = coordinate;\n\t\tthis._isLoaded = true;\n\t}\n\n\tprotected newTile( tx: number, ty: number, px: number, py: number, scale: number ): DMapTile {\n\t\treturn new DMapTile( this._parent, tx, ty, px, py, scale );\n\t}\n\n\tprotected renderTile( tile: DMapTile ): void {\n\t\ttile.render( this._renderer! );\n\t}\n\n\tget tz(): number {\n\t\treturn this._tz;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis._renderer = renderer;\n\t\tthis._tiles.forEach( this._renderTileBound );\n\t}\n\n\tmove( lon0: number, lat0: number, lon1: number, lat1: number ): void {\n\t\tconst oldLon0 = this._lon0;\n\t\tconst oldLat0 = this._lat0;\n\t\tconst oldLon1 = this._lon1;\n\t\tconst oldLat1 = this._lat1;\n\t\tif( oldLon0 !== lon0 || oldLat0 !== lat0 || oldLon1 !== lon1 || oldLat1 !== lat1 ) {\n\t\t\tthis._lon0 = lon0;\n\t\t\tthis._lat0 = lat0;\n\t\t\tthis._lon1 = lon1;\n\t\t\tthis._lat1 = lat1;\n\n\t\t\tconst tz = this._tz;\n\t\t\tconst coordinate = this._coordinate;\n\n\t\t\tconst work = DMapTilePlane.WORK;\n\t\t\twork.set( lon0, lat0 );\n\t\t\tcoordinate.lonLatToTile( work, tz, work );\n\t\t\tconst tx0 = work.x;\n\t\t\tconst ty0 = work.y;\n\n\t\t\twork.set( lon1, lat1 );\n\t\t\tcoordinate.lonLatToTile( work, tz, work );\n\t\t\tconst tx1 = work.x;\n\t\t\tconst ty1 = work.y;\n\n\t\t\tconst tileCount = this._tileCount;\n\t\t\tlet txmin = Math.max( 0, tx0 );\n\t\t\tlet txmax = Math.min( tileCount - 1, tx1 );\n\t\t\tlet tymin = Math.max( 0, ty0 );\n\t\t\tlet tymax = Math.min( tileCount - 1, ty1 );\n\t\t\tconst dtxmin = txmin - this._txmin;\n\t\t\tconst dtxmax = txmax - this._txmax;\n\t\t\tconst dtymin = tymin - this._tymin;\n\t\t\tconst dtymax = tymax - this._tymax;\n\n\t\t\tconst isTxMinChanged = dtxmin !== dtxmin || dtxmin < 0 || 1 < dtxmin;\n\t\t\tconst isTxMaxChanged = dtxmax !== dtxmax || 0 < dtxmax || dtxmax < -1;\n\t\t\tconst isTyMinChanged = dtymin !== dtymin || dtymin < 0 || 1 < dtymin;\n\t\t\tconst isTyMaxChanged = dtymax !== dtymax || 0 < dtymax || dtymax < -1;\n\t\t\tif( isTxMinChanged || isTxMaxChanged || isTyMinChanged || isTyMaxChanged ) {\n\t\t\t\tif( isTxMinChanged ) {\n\t\t\t\t\tthis._txmin = txmin;\n\t\t\t\t} else {\n\t\t\t\t\ttxmin = this._txmin;\n\t\t\t\t}\n\t\t\t\tif( isTxMaxChanged ) {\n\t\t\t\t\tthis._txmax = txmax;\n\t\t\t\t} else {\n\t\t\t\t\ttxmax = this._txmax;\n\t\t\t\t}\n\t\t\t\tif( isTyMinChanged ) {\n\t\t\t\t\tthis._tymin = tymin;\n\t\t\t\t} else {\n\t\t\t\t\ttymin = this._tymin;\n\t\t\t\t}\n\t\t\t\tif( isTyMaxChanged ) {\n\t\t\t\t\tthis._tymax = tymax;\n\t\t\t\t} else {\n\t\t\t\t\ttymax = this._tymax;\n\t\t\t\t}\n\n\t\t\t\tconst tiles = this._tiles;\n\t\t\t\ttiles.forEach( this._deleteTileBound );\n\n\t\t\t\tconst ctx = (txmin + txmax) >> 1;\n\t\t\t\tconst cty = (tymin + tymax) >> 1;\n\t\t\t\tconst ltx = Math.max( ctx - txmin, txmax - ctx );\n\t\t\t\tconst lty = Math.max( cty - tymin, tymax - cty );\n\t\t\t\tconst lt = Math.max( ltx, lty );\n\n\t\t\t\tthis.toOffset( work );\n\t\t\t\tconst offsetX = work.x;\n\t\t\t\tconst offsetY = work.y;\n\n\t\t\t\tthis._isOnLoadedCalled = false;\n\t\t\t\tthis._isOnLoadedAllowed = false;\n\t\t\t\tthis.loadTile( tz, ctx, cty, offsetX, offsetY, work );\n\t\t\t\tfor( let it = 1; it <= lt; ++it ) {\n\t\t\t\t\tconst txa = ctx - it;\n\t\t\t\t\tif( txmin <= txa ) {\n\t\t\t\t\t\tthis.loadTilesY( tz, txa, cty, it, tymin, tymax, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst txb = ctx + it;\n\t\t\t\t\tif( txb <= txmax ) {\n\t\t\t\t\t\tthis.loadTilesY( tz, txb, cty, it, tymin, tymax, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst tya = cty - it;\n\t\t\t\t\tif( tymin <= tya ) {\n\t\t\t\t\t\tthis.loadTilesX( tz, ctx, it - 1, txmin, txmax, tya, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst tyb = cty + it;\n\t\t\t\t\tif( tyb <= tymax ) {\n\t\t\t\t\t\tthis.loadTilesX( tz, ctx, it - 1, txmin, txmax, tyb, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._isOnLoadedAllowed = true;\n\t\t\t\tif( this._isOnLoadedCalled ) {\n\t\t\t\t\tthis.onLoaded();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTilesX(\n\t\ttz: number,\n\t\tctx: number, ltx: number, txmin: number, txmax: number,\n\t\tty: number,\n\t\tox: number, oy: number,\n\t\twork: Point\n\t): void {\n\t\tthis.loadTile( tz, ctx, ty, ox, oy, work );\n\t\tfor( let i = 1; i <= ltx; ++i ) {\n\t\t\tconst txa = ctx - i;\n\t\t\tif( txmin <= txa ) {\n\t\t\t\tthis.loadTile( tz, txa, ty, ox, oy, work );\n\t\t\t}\n\t\t\tconst txb = ctx + i;\n\t\t\tif( txb <= txmax ) {\n\t\t\t\tthis.loadTile( tz, txb, ty, ox, oy, work );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTilesY(\n\t\ttz: number, tx: number,\n\t\tcty: number, lty: number, tymin: number, tymax: number,\n\t\tox: number, oy: number,\n\t\twork: Point\n\t): void {\n\t\tthis.loadTile( tz, tx, cty, ox, oy, work );\n\t\tfor( let i = 1; i <= lty; ++i ) {\n\t\t\tconst tya = cty - i;\n\t\t\tif( tymin <= tya ) {\n\t\t\t\tthis.loadTile( tz, tx, tya, ox, oy, work );\n\t\t\t}\n\t\t\tconst tyb = cty + i;\n\t\t\tif( tyb <= tymax ) {\n\t\t\t\tthis.loadTile( tz, tx, tyb, ox, oy, work );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTile( tz: number, tx: number, ty: number, ox: number, oy: number, work: Point ): void {\n\t\tconst coordinate = this._coordinate;\n\t\tconst tileCode = coordinate.toTileCode( tz, tx, ty );\n\t\tconst tiles = this._tiles;\n\t\tlet tile = tiles.get( tileCode );\n\t\tif( tile == null ) {\n\t\t\tthis.toTilePosition( tx, ty, ox, oy, work );\n\t\t\ttile = this.newTile( tx, ty, work.x, work.y, this._tileScale );\n\t\t\ttiles.set( tileCode, tile );\n\t\t\ttile.load( this._builder( tz, tx, ty ), this._onLoadedBound );\n\t\t\tthis._isLoaded = false;\n\t\t}\n\t}\n\n\tprotected toTilePosition( tx: number, ty: number, ox: number, oy: number, result: Point ): Point {\n\t\tconst tileSize = this._tileSize;\n\t\tconst tileScaleRelative = this._tileScaleRelative;\n\t\tresult.set( tx, ty );\n\t\tthis._coordinate.tileToPixels( result, tileSize, result );\n\t\tresult.set( result.x * tileScaleRelative + ox, result.y * tileScaleRelative + oy );\n\t\treturn result;\n\t}\n\n\tprotected toOffset( result: Point ): Point {\n\t\tconst parent = this._parent;\n\t\tconst mapping = this._mapping;\n\t\tconst tileSize = this._tileSize;\n\t\tresult.set(\n\t\t\t-mapping.x * tileSize + parent.width * 0.5,\n\t\t\t-mapping.y * tileSize + parent.height * 0.5\n\t\t);\n\t\treturn result;\n\t}\n\n\tprotected deleteTile( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ): void {\n\t\tconst tx = tile.tx;\n\t\tconst ty = tile.ty;\n\t\tif( tx < this._txmin || this._txmax < tx || ty < this._tymin || this._tymax < ty ) {\n\t\t\ttiles.delete( tileCode );\n\t\t\ttile.destroy();\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst tiles = this._tiles;\n\t\ttiles.forEach( this._destroyTileBound );\n\t\ttiles.clear();\n\t}\n\n\tprotected destroyTile( tile: DMapTile ): void {\n\t\ttile.destroy();\n\t}\n\n\tprotected updateLoadingState(): void {\n\t\tthis._isLoaded = true;\n\t\tthis._tiles.forEach( this._updateLoadingStateForEach );\n\t}\n\n\tprotected onLoaded(): void {\n\t\tif( this._isOnLoadedAllowed ) {\n\t\t\tthis._onLoaded();\n\t\t} else {\n\t\t\tthis._isOnLoadedCalled = true;\n\t\t}\n\t}\n\n\tget loaded(): boolean {\n\t\tif( ! this._isLoaded ) {\n\t\t\tthis.updateLoadingState();\n\t\t}\n\t\treturn this._isLoaded;\n\t}\n\n\tget mapping(): DMapTileMappingInternal {\n\t\treturn this._mapping;\n\t}\n\n\tset mapping( mapping: DMapTileMappingInternal ) {\n\t\tconst coordinate = this._coordinate;\n\t\tconst tileScale = mapping.scale * this._tileScaleRelative;\n\t\tconst tileSize = coordinate.getTileSize() * mapping.scale;\n\t\tthis._tileScale = tileScale;\n\t\tthis._tileSize = tileSize;\n\t\tthis._mapping = mapping;\n\n\t\tconst work = DMapTilePlane.WORK;\n\t\tthis.toOffset( work );\n\t\tconst offsetX = work.x;\n\t\tconst offsetY = work.y;\n\n\t\tthis._tiles.forEach(( tile: DMapTile ): void => {\n\t\t\tthis.toTilePosition( tile.tx, tile.ty, offsetX, offsetY, work );\n\t\t\ttile.transform( work.x, work.y, tileScale );\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Renderer, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapTileMapping } from \"./d-map-tile-mapping\";\nimport { DMapTileMappingInternal } from \"./d-map-tile-mapping-internal\";\nimport { DMapTilePlane } from \"./d-map-tile-plane\";\nimport { DMapTilePyramid, DMapTilePyramidOptions } from \"./d-map-tile-pyramid\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport class DMapTilePyramidImpl extends utils.EventEmitter implements DMapTilePyramid {\n\tprotected static WORK_LONLAT: Point = new Point();\n\n\tprotected readonly _canvas: DBase;\n\tprotected readonly _builder: DMapTileUrlBuilder;\n\tprotected readonly _planes: Array<DMapTilePlane | undefined>;\n\tprotected _z: number;\n\tprotected _tz: number;\n\tprotected _minZ: number;\n\tprotected _maxZ: number;\n\tprotected _mapping: DMapTileMapping;\n\tprotected _mappingInternal: DMapTileMappingInternal;\n\tprotected _coordinate: DMapCoordinate;\n\tprotected _onLoadedBound: () => void;\n\tprotected _fitBound: () => void;\n\tprotected _fitBoundTimeout: number | undefined;\n\tprotected _fitThrottledBound: () => void;\n\tprotected _fitThrottle: number;\n\n\tconstructor( options: DMapTilePyramidOptions ) {\n\t\tsuper();\n\t\tconst canvas = this._canvas = options.canvas;\n\t\tthis._builder = options.builder;\n\t\tconst mappingLonLat = this._mapping = options.mapping;\n\t\tconst coordinate = this._coordinate = options.coordinate;\n\t\tthis._mappingInternal = this.toMapping( canvas, mappingLonLat, coordinate );\n\t\tthis._z = NaN;\n\t\tthis._tz = NaN;\n\t\tthis._minZ = options.plane.min;\n\t\tthis._maxZ = options.plane.max;\n\t\tthis._planes = [];\n\t\tthis._onLoadedBound = (): void => {\n\t\t\tthis.onLoaded();\n\t\t};\n\t\tthis._fitBound = (): void => {\n\t\t\tthis._fitBoundTimeout = undefined;\n\t\t\tthis.fit();\n\t\t};\n\t\tthis._fitThrottle = options.plane.throttle;\n\t\tconst fitThrottledBound = this._fitThrottledBound = (): void => {\n\t\t\tthis.fitThrottled();\n\t\t};\n\t\tcanvas.on( \"scale\", fitThrottledBound );\n\t\tcanvas.on( \"move\", fitThrottledBound );\n\t\tcanvas.appendRenderable( this, true );\n\t}\n\n\tget coordinate(): DMapCoordinate {\n\t\treturn this._coordinate;\n\t}\n\n\tprotected fitThrottled(): void {\n\t\tif( this._fitBoundTimeout == null ) {\n\t\t\tthis._fitBoundTimeout = window.setTimeout( this._fitBound, this._fitThrottle );\n\t\t}\n\t}\n\n\tprotected toMapping( canvas: DBase, mapping: DMapTileMapping, coordinate: DMapCoordinate ): DMapTileMappingInternal {\n\t\tconst work = DMapTilePyramidImpl.WORK_LONLAT;\n\t\tconst tileSize = coordinate.getTileSize();\n\n\t\twork.set( mapping.from.lon, mapping.from.lat );\n\t\tcoordinate.lonLatToPixels( work, 0, tileSize, work );\n\t\tconst x0 = work.x;\n\t\tconst y0 = work.y;\n\n\t\twork.set( mapping.to.lon, mapping.to.lat );\n\t\tcoordinate.lonLatToPixels( work, 0, tileSize, work );\n\t\tconst x1 = work.x;\n\t\tconst y1 = work.y;\n\n\t\tconst dx = Math.abs(x1 - x0);\n\t\tconst dy = Math.abs(y1 - y0);\n\t\tconst dmin = 0.0000001;\n\t\tlet scale = 1;\n\t\tif( dmin < dx ) {\n\t\t\tif( dmin < dy ) {\n\t\t\t\tscale = Math.max( canvas.width / dx, canvas.height / dy );\n\t\t\t} else {\n\t\t\t\tscale = canvas.width / dx;\n\t\t\t}\n\t\t} else {\n\t\t\tif( dmin < dy ) {\n\t\t\t\tscale = canvas.height / dy;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tscale,\n\t\t\tx: 0.5 * (x1 + x0) / tileSize,\n\t\t\ty: 0.5 * (y1 + y0) / tileSize\n\t\t};\n\t}\n\n\tget mapping(): DMapTileMapping {\n\t\treturn this._mapping;\n\t}\n\n\tset mapping( mapping: DMapTileMapping ) {\n\t\tconst oldMapping = this._mappingInternal;\n\t\tconst newMapping = this.toMapping( this._canvas, mapping, this._coordinate );\n\t\tconst threshold = 0.0000001;\n\t\tif(\n\t\t\tthreshold < Math.abs(oldMapping.scale - newMapping.scale) ||\n\t\t\tthreshold < Math.abs(oldMapping.x - newMapping.x) ||\n\t\t\tthreshold < Math.abs(oldMapping.y - newMapping.y)\n\t\t) {\n\t\t\tthis._mappingInternal = newMapping;\n\n\t\t\tconst planes = this._planes;\n\t\t\tfor( let i = 0, imax = planes.length; i < imax; ++i ) {\n\t\t\t\tconst plane = planes[ i ];\n\t\t\t\tif( plane ) {\n\t\t\t\t\tplane.mapping = newMapping;\n\t\t\t\t}\n\t\t\t}\n\t\t\tDApplications.update();\n\n\t\t\tthis._fitThrottledBound();\n\t\t}\n\t}\n\n\tprotected newPlane( tz: number ): DMapTilePlane {\n\t\treturn new DMapTilePlane(\n\t\t\tthis._canvas,\n\t\t\tthis._builder,\n\t\t\ttz,\n\t\t\tthis._mappingInternal,\n\t\t\tthis._coordinate,\n\t\t\tthis._onLoadedBound\n\t\t);\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tconst tz = this._tz;\n\t\tconst planes = this._planes;\n\t\tfor( let i = 0; i < tz; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane != null ) {\n\t\t\t\tplane.render( renderer );\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = planes.length - 1; tz < i; --i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane != null ) {\n\t\t\t\tplane.render( renderer );\n\t\t\t}\n\t\t}\n\n\t\tconst planeTz = planes[ tz ];\n\t\tif( planeTz != null ) {\n\t\t\tplaneTz.render( renderer );\n\t\t}\n\t}\n\n\tprotected toTileZ( tz: number ): number {\n\t\treturn Math.min( this._maxZ, Math.max( this._minZ, Math.floor( tz ) ) );\n\t}\n\n\tupdateTransform(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected toZ( scale: number ): number {\n\t\treturn Math.log( this._mappingInternal.scale * scale ) / Math.log( 2 );\n\t}\n\n\tmove( scale: number, lon0: number, lat0: number, lon1: number, lat1: number ): this {\n\t\tconst planes = this._planes;\n\t\tconst z = this.toZ( scale );\n\t\tif( this._z !== z ) {\n\t\t\tthis._z = z;\n\n\t\t\tconst tz = this.toTileZ( z );\n\t\t\tif( this._tz !== tz ) {\n\t\t\t\tthis._tz = tz;\n\n\t\t\t\tlet newPlane = planes[ tz ];\n\t\t\t\tif( newPlane == null ) {\n\t\t\t\t\tnewPlane = this.newPlane( tz );\n\t\t\t\t\tplanes[ tz ] = newPlane;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst plane = planes[ this._tz ];\n\t\tif( plane != null ) {\n\t\t\tplane.move( lon0, lat0, lon1, lat1 );\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tfit(): this {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst container = canvas.parent;\n\t\t\tif( container != null ) {\n\t\t\t\tconst scale = canvas.scale;\n\t\t\t\tconst scaleX = scale.x;\n\t\t\t\tconst scaleY = scale.y;\n\t\t\t\tconst x = canvas.x;\n\t\t\t\tconst y = canvas.y;\n\t\t\t\tconst coordinate = this._coordinate;\n\t\t\t\tconst mapping = this._mappingInternal;\n\t\t\t\tconst tileSize = coordinate.getTileSize() * mapping.scale;\n\t\t\t\tconst x0 = mapping.x * tileSize - (x / scaleX + 0.5 * canvas.width);\n\t\t\t\tconst x1 = x0 + container.width / scaleX;\n\t\t\t\tconst y0 = mapping.y * tileSize - (y / scaleY + 0.5 * canvas.height);\n\t\t\t\tconst y1 = y0 + container.height / scaleY;\n\n\t\t\t\tconst work = DMapTilePyramidImpl.WORK_LONLAT;\n\t\t\t\twork.set( x0, y0 );\n\t\t\t\tcoordinate.pixelsToLonLat( work, 0, tileSize, work );\n\t\t\t\tconst lon0 = work.x;\n\t\t\t\tconst lat0 = work.y;\n\n\t\t\t\twork.set( x1, y1 );\n\t\t\t\tcoordinate.pixelsToLonLat( work, 0, tileSize, work );\n\t\t\t\tconst lon1 = work.x;\n\t\t\t\tconst lat1 = work.y;\n\n\t\t\t\tthis.move( scaleX, lon0, lat0, lon1, lat1 );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tprotected destroyPlanesBefore( tz: number, planes: Array<DMapTilePlane | undefined> ): void {\n\t\tfor( let i = 0; i < tz; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected destroyPlanesAfter( tz: number, planes: Array<DMapTilePlane | undefined> ): void {\n\t\tfor( let i = tz + 1, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup(): void {\n\t\tconst tz = this._tz;\n\t\tconst planes = this._planes;\n\t\tconst planeTz = planes[ tz ];\n\t\tif( planeTz && planeTz.loaded ) {\n\t\t\tthis.destroyPlanesBefore( tz, planes );\n\t\t\tthis.destroyPlanesAfter( tz, planes );\n\t\t\treturn;\n\t\t}\n\n\t\tfor( let i = tz + 1, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane && plane.loaded ) {\n\t\t\t\tthis.destroyPlanesBefore( tz, planes );\n\t\t\t\tthis.destroyPlanesAfter( i, planes );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = tz - 1; 0 <= i; --i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane && plane.loaded ) {\n\t\t\t\tthis.destroyPlanesBefore( i, planes );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onLoaded(): void {\n\t\tthis.cleanup();\n\t\tDApplications.update();\n\t}\n\n\tdestroy(): this {\n\t\tconst planes = this._planes;\n\t\tfor( let i = 0, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\n\t\tconst canvas = this._canvas;\n\t\tconst fitThrottledBound = this._fitThrottledBound;\n\t\tcanvas.off( \"scale\", fitThrottledBound );\n\t\tcanvas.off( \"move\", fitThrottledBound );\n\t\tcanvas.removeRenderable( this, true );\n\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapCoordinates } from \"./d-map-coordinates\";\nimport { DMapTilePyramid } from \"./d-map-tile-pyramid\";\nimport { DMapTilePyramidImpl } from \"./d-map-tile-pyramid-impl\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport const DMapTileUrlBuilderKokudo: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\tif( 5 <= tz ) {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/pale/${tz}/${tx}/${ty}.png`;\n\t} else if( 2 <= tz ) {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/std/${tz}/${tx}/${ty}.png`;\n\t} else {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/earthhillshade/${tz}/${tx}/${ty}.png`;\n\t}\n};\n\nexport const DMapTileUrlBuilderOsm: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\treturn `https://${\"abc\"[( tx + ty ) % 3]}.tile.openstreetmap.org/${tz}/${tx}/${ty}.png`;\n};\n\nexport const DMapTileUrlBuilderOsmfj: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\treturn `https://j.tile.openstreetmap.jp/${tz}/${tx}/${ty}.png`;\n};\n\nexport interface DMapTilePyramidsFromOptions {\n\tcanvas: DDiagramCanvasBase<any, any>;\n\tbuilder?: DMapTileUrlBuilder;\n\tcoordinate?: DMapCoordinate;\n\tplane?: {\n\t\tmin?: number;\n\t\tmax?: number;\n\t\tthrottle?: number;\n\t};\n}\n\nexport class DMapTilePyramids {\n\tstatic MIN: number = 0;\n\tstatic MAX: number = 18;\n\tstatic THROTTLE: number = 333;\n\n\tstatic toPlaneOptions( options: DMapTilePyramidsFromOptions ) {\n\t\tconst plane = options.plane;\n\t\tif( plane ) {\n\t\t\treturn {\n\t\t\t\tmin: ( plane.min != null ? plane.min : this.MIN ),\n\t\t\t\tmax: ( plane.max != null ? plane.max : this.MAX ),\n\t\t\t\tthrottle: ( plane.throttle != null ? plane.throttle : this.THROTTLE )\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tmin: this.MIN,\n\t\t\t\tmax: this.MAX,\n\t\t\t\tthrottle: this.THROTTLE\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic from( options: DMapTilePyramidsFromOptions ): DMapTilePyramid {\n\t\treturn new DMapTilePyramidImpl({\n\t\t\tcanvas: options.canvas,\n\t\t\tbuilder: options.builder || DMapTileUrlBuilderOsmfj,\n\t\t\tmapping: options.canvas.tile.mapping,\n\t\t\tcoordinate: options.coordinate || DMapCoordinates.DEFAULT,\n\t\t\tplane: this.toPlaneOptions( options )\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\n\nexport interface DMenuBarItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBarItem = DThemeMenuBarItem\n> extends DButtonOptions<VALUE, THEME> {\n\tmenu?: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\nexport interface DThemeMenuBarItem extends DThemeButton {\n\n}\n\nexport class DMenuBarItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBarItem = DThemeMenuBarItem,\n\tOPTIONS extends DMenuBarItemOptions<VALUE, THEME> = DMenuBarItemOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected _menu!: DMenu<VALUE>;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._menu = this.toMenu( this.theme, options );\n\t\tthis._menu.on( \"select\", ( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void => {\n\t\t\tthis.onSelect( value, item, menu );\n\t\t});\n\t}\n\n\tprotected toMenu( theme: THEME, options?: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options && options.menu;\n\t\tif( menu instanceof DMenu ) {\n\t\t\treturn menu;\n\t\t} else {\n\t\t\treturn new DMenu( this.toMenuOptions( theme, menu ) );\n\t\t}\n\t}\n\n\tprotected newMenu( theme: THEME, options?: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\treturn new DMenu<VALUE>( this.toMenuOptions( theme, options ) );\n\t}\n\n\tprotected toMenuOptions( theme: THEME, options?: DMenuOptions<VALUE> ): DMenuOptions<VALUE> | undefined {\n\t\toptions = options || {};\n\t\tif( options.fit == null ) {\n\t\t\toptions.fit = false;\n\t\t}\n\t\treturn options;\n\t}\n\n\tclose(): void {\n\t\tthis._menu.close();\n\t}\n\n\tget menu() {\n\t\treturn this._menu;\n\t}\n\n\tprotected onSelect( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tconst parent = this.parent;\n\t\tif( parent != null ) {\n\t\t\tparent.emit( \"select\", value, item, menu );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuBarItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, interaction, Point } from \"pixi.js\";\nimport { DMenuBarItem } from \"./d-menu-bar-item\";\nimport { Closeable } from \"./d-menu-context\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DMenuBarBlocker extends Container {\n\tconstructor( target: Closeable & Container ) {\n\t\tsuper();\n\t\tthis.renderable = false;\n\t\tthis.interactive = true;\n\n\t\tthis.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( e.target === this ) {\n\t\t\t\ttarget.close();\n\t\t\t}\n\t\t});\n\t\tthis.on( UtilPointerEvent.move, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst children = target.children;\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\tconst child = children[ i ];\n\t\t\t\t\tif( child instanceof DMenuBarItem ) {\n\t\t\t\t\t\tchild.setHovered( child.containsPoint( e.data.global ) );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tcontainsPoint( global: Point ): boolean {\n\t\treturn true;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStates } from \"./d-base-states\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DMenuBarBlocker } from \"./d-menu-bar-blocker\";\nimport { DMenuBarItem, DMenuBarItemOptions, DThemeMenuBarItem } from \"./d-menu-bar-item\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\n\nexport interface DMenuBarOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBar = DThemeMenuBar\n> extends DLayoutHorizontalOptions<THEME> {\n\titems?: Array<DMenuBarItemOptions<VALUE, DThemeMenuBarItem> | DisplayObject>;\n}\n\nexport interface DThemeMenuBar extends DThemeLayoutHorizontal {\n\n}\n\nexport class DMenuBar<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBar = DThemeMenuBar,\n\tOPTIONS extends DMenuBarOptions<VALUE, THEME> = DMenuBarOptions<VALUE, THEME>\n>extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _context!: DMenuContext | null;\n\tprotected _blocker!: DMenuBarBlocker;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.setState( DBaseState.FOCUS_ROOT, true );\n\n\t\tif( options != null && options.items != null ) {\n\t\t\tconst items = options.items;\n\t\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\t\tthis.close();\n\t\t\t});\n\t\t\tconst onStateChange = ( newState: DBaseState, oldState: DBaseState, item: DMenuBarItem<VALUE> ): void => {\n\t\t\t\tconst context = this._context;\n\t\t\t\tif( context == null ) {\n\t\t\t\t\tif( ! DBaseStates.isDisabled( newState ) ) {\n\t\t\t\t\t\tif( DBaseStates.isPressed( newState ) && ! DBaseStates.isPressed( oldState ) ) {\n\t\t\t\t\t\t\tthis.open( item );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( ! DBaseStates.isDisabled( newState ) ) {\n\t\t\t\t\t\tif( DBaseStates.isHovered( newState ) && ! DBaseStates.isHovered( oldState ) ) {\n\t\t\t\t\t\t\tconst menu = item.menu;\n\t\t\t\t\t\t\tif( menu.isHidden() ) {\n\t\t\t\t\t\t\t\tmenu.open( item, this, context );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\t\tconst itemOrItemOptions = items[ i ];\n\t\t\t\tconst item = ( itemOrItemOptions instanceof DisplayObject ?\n\t\t\t\t\titemOrItemOptions : new DMenuBarItem<VALUE>( itemOrItemOptions )\n\t\t\t\t);\n\t\t\t\tif( item instanceof DMenuBarItem ) {\n\t\t\t\t\titem.on( \"statechange\", onStateChange );\n\t\t\t\t}\n\t\t\t\tthis.addChild( item );\n\t\t\t}\n\t\t}\n\n\t\tthis.on( \"select\", (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\tthis._context = null;\n\t\tthis._blocker = new DMenuBarBlocker( this );\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen( item: DMenuBarItem<VALUE> ): void {\n\t\tlet context = this._context;\n\t\tif( context == null ) {\n\t\t\tDApplications.getInstance().stage.addChild( this._blocker );\n\t\t\tcontext = this._context = new DMenuContext( this );\n\t\t\tcontext.trim( item );\n\t\t\tcontext.add( this );\n\t\t\titem.menu.open( item, this, context );\n\t\t}\n\t}\n\n\tclose(): void {\n\t\tconst context = this._context;\n\t\tif( context != null ) {\n\t\t\tthis._context = null;\n\t\t\tcontext.remove( this );\n\t\t\tDApplications.getInstance().stage.removeChild( this._blocker );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuBar\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DMenuSidedContentOptions<\n\tTHEME extends DThemeMenuSidedContent = DThemeMenuSidedContent\n> extends DLayoutVerticalOptions<THEME> {\n\n}\n\nexport interface DThemeMenuSidedContent extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuSidedContent<\n\tTHEME extends DThemeMenuSidedContent = DThemeMenuSidedContent,\n\tOPTIONS extends DMenuSidedContentOptions<THEME> = DMenuSidedContentOptions<THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected initReflowable(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedContent\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DDialogSelect, DDialogSelectOptions } from \"./d-dialog-select\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DTableBodyCellCheckOptions } from \"./d-table-body-cell-check\";\nimport { DTableBodyCellColorOptions } from \"./d-table-body-cell-color\";\nimport { DTableBodyCellDateOptions } from \"./d-table-body-cell-date\";\nimport { DTableBodyCellDatetimeOptions } from \"./d-table-body-cell-datetime\";\nimport { DTableBodyCellIndexOptions } from \"./d-table-body-cell-index\";\nimport { DTableBodyCellInputIntegerOptions } from \"./d-table-body-cell-input-integer\";\nimport { DTableBodyCellInputRealOptions } from \"./d-table-body-cell-input-real\";\nimport { DTableBodyCellInputTextOptions } from \"./d-table-body-cell-input-text\";\nimport { DTableBodyCellSelectDialogOptions } from \"./d-table-body-cell-select-dialog\";\nimport { DTableBodyCellSelectFetcherOptions } from \"./d-table-body-cell-select-fetcher\";\nimport { DTableBodyCellSelectMenuOptions } from \"./d-table-body-cell-select-menu\";\nimport { DTableBodyCellTextOptions } from \"./d-table-body-cell-text\";\nimport { DTableBodyCellTimeOptions } from \"./d-table-body-cell-time\";\nimport { DTableHeaderCellOptions } from \"./d-table-header-cell\";\n\nexport enum DTableColumnType {\n\tINDEX,\n\tTEXT,\n\tINTEGER,\n\tREAL,\n\tCHECK,\n\tCOLOR,\n\tBUTTON,\n\tSELECT,\n\tDATE,\n\tDATETIME,\n\tTIME\n}\n\nexport type DTableGetter<ROW> = ( row: ROW, index: number ) => unknown;\nexport type DTableSetter<ROW> = ( row: ROW, index: number, cell: unknown ) => void;\nexport type DTableFormatter = ( cell: unknown ) => string;\nexport type DTableEditingFormatter = ( cell: unknown ) => string;\nexport type DTableEditingUnformatter = ( cell: string ) => unknown;\nexport type DTableEditingValidator = ( cell: unknown ) => unknown;\nexport type DTableSelectingGetter = ( selected: unknown ) => unknown;\n\nexport type DTableBodyCellOptionsUnion<ROW> = DTableBodyCellTextOptions<ROW> | DTableBodyCellInputTextOptions<ROW> |\n\tDTableBodyCellInputIntegerOptions<ROW> | DTableBodyCellInputRealOptions<ROW> | DTableBodyCellIndexOptions<ROW> |\n\tDTableBodyCellColorOptions<ROW> | DTableBodyCellCheckOptions<ROW> | DTableBodyCellSelectDialogOptions<ROW> |\n\tDTableBodyCellSelectFetcherOptions<ROW> | DTableBodyCellSelectMenuOptions<ROW> | DTableBodyCellDateOptions<ROW> |\n\tDTableBodyCellDatetimeOptions<ROW> | DTableBodyCellTimeOptions<ROW>;\n\nexport type DTableBodyCellOptionsMerged<ROW> = DTableBodyCellTextOptions<ROW> & DTableBodyCellInputTextOptions<ROW> &\n\tDTableBodyCellInputIntegerOptions<ROW> & DTableBodyCellInputRealOptions<ROW> & DTableBodyCellIndexOptions<ROW> &\n\tDTableBodyCellColorOptions<ROW> & DTableBodyCellCheckOptions<ROW> & DTableBodyCellSelectDialogOptions<ROW> &\n\tDTableBodyCellSelectFetcherOptions<ROW> & DTableBodyCellSelectMenuOptions<ROW> & DTableBodyCellDateOptions<ROW> &\n\tDTableBodyCellDatetimeOptions<ROW> & DTableBodyCellTimeOptions<ROW>;\n\nexport interface DTableColumnEditingOptions {\n\tformatter?: DTableEditingFormatter;\n\tunformatter?: DTableEditingUnformatter;\n\tvalidator?: DTableEditingValidator;\n}\n\nexport interface DTableColumnEditing {\n\tformatter?: DTableEditingFormatter;\n\tunformatter?: DTableEditingUnformatter;\n\tvalidator?: DTableEditingValidator;\n}\n\nexport interface DTableColumnSelectingOptions {\n\tgetter?: DTableSelectingGetter;\n\n\tmenu?: DMenuOptions<unknown> | DMenu<unknown>;\n\tdialog?: DDialogSelectOptions<unknown> | DDialogSelect<unknown>;\n\tfetcher?: () => Promise<unknown>;\n}\n\nexport interface DTableColumnSelecting {\n\tgetter: DTableSelectingGetter;\n\n\tmenu?: DMenu<unknown>;\n\tdialog?: DDialogSelect<unknown>;\n\tfetcher?: () => Promise<unknown>;\n}\n\nexport interface DTableColumnOptions<ROW> {\n\tweight?: number;\n\twidth?: number;\n\n\ttype?: (keyof typeof DTableColumnType) | DTableColumnType;\n\tlabel?: string;\n\tgetter?: DTableGetter<ROW>;\n\tsetter?: DTableSetter<ROW>;\n\tformatter?: DTableFormatter;\n\talign?: (keyof typeof DAlignHorizontal) | DAlignHorizontal;\n\n\teditable?: boolean;\n\tediting?: DTableColumnEditingOptions;\n\n\theader?: DTableHeaderCellOptions;\n\tbody?: DTableBodyCellOptionsUnion<ROW>;\n\n\tselecting?: DTableColumnSelectingOptions;\n}\n\nexport interface DTableColumn<ROW> {\n\tweight: number | undefined;\n\twidth: number | undefined;\n\n\ttype: DTableColumnType;\n\tlabel: string;\n\tgetter: DTableGetter<ROW>;\n\tsetter: DTableSetter<ROW>;\n\tformatter?: DTableFormatter;\n\talign: DAlignHorizontal;\n\n\teditable: boolean;\n\tediting: DTableColumnEditing;\n\n\theader?: DTableHeaderCellOptions;\n\tbody?: DTableBodyCellOptionsUnion<ROW>;\n\n\tselecting: DTableColumnSelecting;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuSidedContent, DMenuSidedContentOptions } from \"./d-menu-sided-content\";\nimport { DMenuSidedSelection, DMenuSidedSelectionOptions } from \"./d-menu-sided-selection\";\nimport { DMenuSideds } from \"./d-menu-sideds\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\n\nexport interface DMenuSidedOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuSided = DThemeMenuSided,\n\tCONTENT_OPTIONS extends DBaseOptions = DMenuSidedContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n\tsticky?: boolean;\n\tselection?: DMenuSidedSelectionOptions | DMenuSidedSelection;\n}\n\nexport interface DThemeMenuSided extends DThemePane {\n\n}\n\nexport class DMenuSided<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuSided = DThemeMenuSided,\n\tCONTENT_OPTIONS extends DMenuSidedContentOptions = DMenuSidedContentOptions,\n\tOPTIONS extends DMenuSidedOptions<VALUE, THEME, CONTENT_OPTIONS> = DMenuSidedOptions<VALUE, THEME, CONTENT_OPTIONS>\n> extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _context!: DMenuContext | null;\n\tprotected _selection!: DMenuSidedSelection;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst context = new DMenuContext( this );\n\t\tthis._context = context;\n\t\tcontext.add( this );\n\n\t\tconst items = options && options.items;\n\t\tif( items != null ) {\n\t\t\tconst sticky = ( options && options.sticky != null ? options.sticky : false );\n\t\t\tthis.newItems( items, sticky );\n\t\t}\n\n\t\tconst selection = options && options.selection;\n\t\tthis._selection = ( selection instanceof DMenuSidedSelection ?\n\t\t\tselection : this.newSelection( selection ) );\n\t}\n\n\tprotected newSelection( options?: DMenuSidedSelectionOptions ): DMenuSidedSelection {\n\t\treturn new DMenuSidedSelection( this._content, options );\n\t}\n\n\tprotected onChildrenDirty(): void {\n\t\tconst selection = this._selection;\n\t\tif( selection != null ) {\n\t\t\tselection.toDirty();\n\t\t}\n\t\tsuper.onChildrenDirty();\n\t}\n\n\tprotected newItems( items: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>, sticky: boolean ): void {\n\t\tDMenuSideds.newItems( this.content, items, sticky );\n\t}\n\n\tprotected newContent( options?: CONTENT_OPTIONS ): DBase {\n\t\treturn new DMenuSidedContent( options );\n\t}\n\n\tget selection(): DMenuSidedSelection {\n\t\treturn this._selection;\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen(): void {\n\t\t// DO NOTHING\n\t}\n\n\tclose(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSided\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DNotificationOptions<THEME extends DThemeNotification> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeNotification extends DThemeBase {\n\n}\n\nexport class DNotification<\n\tTHEME extends DThemeNotification = DThemeNotification,\n\tOPTIONS extends DNotificationOptions<THEME> = DNotificationOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPaginationOptions<THEME extends DThemePagination> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePagination extends DThemeBase {\n\n}\n\nexport class DPagination<\n\tTHEME extends DThemePagination = DThemePagination,\n\tOPTIONS extends DPaginationOptions<THEME> = DPaginationOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPickerDatetimeRangeOptions<THEME extends DThemePickerDatetimeRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerDatetimeRange extends DThemeBase {\n\n}\n\nexport class DPickerDatetimeRange<\n\tTHEME extends DThemePickerDatetimeRange = DThemePickerDatetimeRange,\n\tOPTIONS extends DPickerDatetimeRangeOptions<THEME> = DPickerDatetimeRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPickerTimeRangeOptions<THEME extends DThemePickerTimeRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerTimeRange extends DThemeBase {\n\n}\n\nexport class DPickerTimeRange<\n\tTHEME extends DThemePickerTimeRange = DThemePickerTimeRange,\n\tOPTIONS extends DPickerTimeRangeOptions<THEME> = DPickerTimeRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDropdown, DDropdownOptions, DThemeDropdown } from \"./d-dropdown\";\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport interface DSelectOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelect = DThemeSelect\n> extends DDropdownOptions<VALUE, THEME> {\n\tvalue?: VALUE;\n}\n\nexport interface DThemeSelect extends DThemeDropdown {\n\n}\n\nexport class DSelect<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelect = DThemeSelect,\n\tOPTIONS extends DSelectOptions<VALUE, THEME> = DSelectOptions<VALUE, THEME>\n> extends DDropdown<VALUE, THEME, OPTIONS> {\n\tprotected _value!: VALUE | null;\n\tprotected _onSelectedBound!: ( value: VALUE, child: DMenuItem<VALUE> ) => void;\n\tprotected _onClosedBound!: () => void;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._value = null;\n\n\t\tthis._onSelectedBound = ( value: VALUE, child: DMenuItem<VALUE> ): void => {\n\t\t\tthis.onSelected( value, child, true );\n\t\t};\n\t\tthis._onClosedBound = (): void => {\n\t\t\tthis.onClosed();\n\t\t};\n\n\t\t// Default value\n\t\tif( options != null && options.value !== undefined ) {\n\t\t\tthis.value = options.value;\n\t\t}\n\t}\n\n\tprotected onSelected( newValue: VALUE | null, item: DMenuItem<VALUE> | null, emit: boolean ): void {\n\t\tif( this._value !== newValue ) {\n\t\t\t// Value\n\t\t\tconst oldValue = this._value;\n\t\t\tthis._value = newValue;\n\n\t\t\t// Text\n\t\t\tif( item != null ) {\n\t\t\t\tthis.text = item.text || \"\";\n\t\t\t} else {\n\t\t\t\tconst options = this._options;\n\t\t\t\tthis.text = ( options && options.text && options.text.value ) || this.theme.newTextValue();\n\t\t\t}\n\n\t\t\t// Event\n\t\t\tif( emit ) {\n\t\t\t\tthis.emit( \"change\", newValue, oldValue, item, this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onClosed(): void {\n\t\tconst menu = this._menu;\n\t\tmenu.off( \"select\", this._onSelectedBound );\n\t\tmenu.off( \"close\", this._onClosedBound );\n\t}\n\n\tstart(): void {\n\t\tconst menu = this._menu;\n\t\tmenu.on( \"select\", this._onSelectedBound );\n\t\tmenu.on( \"close\", this._onClosedBound );\n\t\tsuper.start();\n\t}\n\n\tprotected findMenuItem( menu: DMenu<VALUE>, value: VALUE | null ): DMenuItem<VALUE> | null {\n\t\tconst children = this._menu.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DMenuItemMenu ) {\n\t\t\t\tconst result = this.findMenuItem( child.menu, value );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else if( child instanceof DMenuItem ) {\n\t\t\t\tif( child.value === value ) {\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tget value(): VALUE | null {\n\t\treturn this._value;\n\t}\n\n\tset value( value: VALUE | null ) {\n\t\tconst item = this.findMenuItem( this._menu, value );\n\t\tif( item != null ) {\n\t\t\tthis.onSelected( value, item, false );\n\t\t} else {\n\t\t\tthis.onSelected( null, null, false );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSelect\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DSliderRangeOptions<THEME extends DThemeSliderRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeSliderRange extends DThemeBase {\n\n}\n\nexport class DSliderRange<\n\tTHEME extends DThemeSliderRange = DThemeSliderRange,\n\tOPTIONS extends DSliderRangeOptions<THEME> = DSliderRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DSliderOptions<THEME extends DThemeSlider> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeSlider extends DThemeBase {\n\n}\n\nexport class DSlider<\n\tTHEME extends DThemeSlider = DThemeSlider,\n\tOPTIONS extends DSliderOptions<THEME> = DSliderOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonCheck, DButtonCheckOptions, DThemeButtonCheck } from \"./d-button-check\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellCheckOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellCheck = DThemeTableBodyCellCheck\n> extends DButtonCheckOptions<unknown, THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellCheck extends DThemeButtonCheck {\n\n}\n\nexport class DTableBodyCellCheck<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellCheck = DThemeTableBodyCellCheck,\n\tOPTIONS extends DTableBodyCellCheckOptions<ROW, THEME> = DTableBodyCellCheckOptions<ROW, THEME>\n> extends DButtonCheck<unknown, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tthis.emit( \"cellchange\", true, false, this._columnIndex, this._columnData );\n\t\t});\n\n\t\tthis.on( \"inactive\", (): void => {\n\t\t\tthis.emit( \"cellchange\", false, true, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.setActive( !! value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonColor, DButtonColorOptions, DThemeButtonColor } from \"./d-button-color\";\nimport { DColorAndAlpha } from \"./d-color\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { utilIsNumber } from \"./util/util-is-number\";\nimport { utilIsString } from \"./util/util-is-string\";\n\nexport interface DTableBodyCellColorOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellColor = DThemeTableBodyCellColor\n> extends DButtonColorOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellColor extends DThemeButtonColor {\n\n}\n\nconst clone = ( value: DColorAndAlpha ): DColorAndAlpha => {\n\treturn {\n\t\tcolor: value.color,\n\t\talpha: value.alpha\n\t};\n};\n\nconst hasColor = ( value: any ): value is { color: unknown } => {\n\treturn ( \"color\" in value );\n};\n\nconst hasAlpha = ( value: any ): value is { alpha: unknown } => {\n\treturn ( \"alpha\" in value );\n};\n\nexport class DTableBodyCellColor<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellColor = DThemeTableBodyCellColor,\n\tOPTIONS extends DTableBodyCellColorOptions<ROW, THEME> = DTableBodyCellColorOptions<ROW, THEME>\n> extends DButtonColor<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tthis.on( \"select\", ( newValue: DColorAndAlpha, oldValue: DColorAndAlpha ): void => {\n\t\t\tthis.emit( \"cellchange\", clone( newValue ), clone( oldValue ), this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tset( newValue: unknown ): void {\n\t\tconst value = this._value;\n\t\tif( utilIsNumber( newValue ) ) {\n\t\t\tvalue.color = newValue;\n\t\t\tvalue.alpha = 1;\n\t\t} else if( utilIsString( newValue ) ) {\n\t\t\tconst parsed = Number( newValue );\n\t\t\tif( parsed === parsed ) {\n\t\t\t\tvalue.color = parsed;\n\t\t\t} else {\n\t\t\t\tvalue.color = 0xffffff;\n\t\t\t}\n\t\t\tvalue.alpha = 1;\n\t\t} else if( newValue != null ) {\n\t\t\tif( hasColor( newValue ) ) {\n\t\t\t\tvalue.color = Number( newValue.color );\n\t\t\t} else {\n\t\t\t\tvalue.color = 0xffffff;\n\t\t\t}\n\t\t\tif( hasAlpha( newValue ) ) {\n\t\t\t\tvalue.alpha = Number( newValue.alpha );\n\t\t\t} else {\n\t\t\t\tvalue.alpha = 1;\n\t\t\t}\n\t\t} else {\n\t\t\tvalue.color = 0xffffff;\n\t\t\tvalue.alpha = 1;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellIndexOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellIndex = DThemeTableBodyCellIndex\n> extends DImageBaseOptions<number, THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellIndex extends DThemeImageBase {\n\tgetTextFormatter(): ( value: number, caller: DTableBodyCellIndex ) => string;\n\tgetTextValue( state: DBaseState ): number;\n\tnewTextValue(): number;\n}\n\nexport class DTableBodyCellIndex<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellIndex = DThemeTableBodyCellIndex,\n\tOPTIONS extends DTableBodyCellIndexOptions<ROW, THEME> = DTableBodyCellIndexOptions<ROW, THEME>\n> extends DImageBase<number, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tset( value: unknown, rowIndex: number): void {\n\t\tthis.text = rowIndex;\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellIndex\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputInteger, DInputIntegerOptions, DThemeInputInteger } from \"./d-input-integer\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputIntegerOptions<\n\tROW = unknown,\n\tTHEME extends DThemeInputInteger = DThemeInputInteger\n> extends DInputIntegerOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellInputInteger extends DThemeInputInteger {\n\n}\n\nexport class DTableBodyCellInputInteger<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputInteger = DThemeTableBodyCellInputInteger,\n\tOPTIONS extends DTableBodyCellInputIntegerOptions<ROW, THEME> = DTableBodyCellInputIntegerOptions<ROW, THEME>\n> extends DInputInteger<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown ): void => {\n\t\t\tthis.emit( \"cellchange\", newCellValue, oldCellValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = Number( value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputInteger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputReal, DInputRealOptions, DThemeInputReal } from \"./d-input-real\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputRealOptions<\n\tROW = unknown,\n\tTHEME extends DThemeInputReal = DThemeInputReal\n> extends DInputRealOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellInputReal extends DThemeInputReal {\n\n}\n\nexport class DTableBodyCellInputReal<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputReal = DThemeTableBodyCellInputReal,\n\tOPTIONS extends DTableBodyCellInputRealOptions<ROW, THEME> = DTableBodyCellInputRealOptions<ROW, THEME>\n> extends DInputReal<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown ): void => {\n\t\t\tthis.emit( \"cellchange\", newCellValue, oldCellValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = Number( value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputReal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputText, DInputTextOptions, DThemeInputText } from \"./d-input-text\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputTextOptions<\n\tROW = unknown,\n\tTHEME extends DThemeInputText = DThemeInputText\n> extends DInputTextOptions<THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellInputText extends DThemeInputText {\n\n}\n\nexport class DTableBodyCellInputText<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputText = DThemeTableBodyCellInputText,\n\tOPTIONS extends DTableBodyCellInputTextOptions<ROW, THEME> = DTableBodyCellInputTextOptions<ROW, THEME>\n> extends DInputText<THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown ): void => {\n\t\t\tthis.emit( \"cellchange\", newCellValue, oldCellValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = String( value );\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectDialogOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectDialog = DThemeTableBodyCellSelectDialog\n> extends DButtonOptions<VALUE, THEME>, DTableBodyCellOptions<ROW> {\n\n}\n\nexport interface DThemeTableBodyCellSelectDialog extends DThemeButton {\n\n}\n\nexport class DTableBodyCellSelectDialog<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectDialog = DThemeTableBodyCellSelectDialog,\n\tOPTIONS extends DTableBodyCellSelectDialogOptions<ROW, VALUE, THEME> =\n\t\tDTableBodyCellSelectDialogOptions<ROW, VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst column = options.column;\n\t\tthis._columnIndex = column.index;\n\t\tthis._columnData = column.data;\n\t\tconst selecting = column.data.selecting;\n\t\tconst dialog = selecting.dialog;\n\t\tif( dialog != null ) {\n\t\t\tconst getter = selecting.getter;\n\t\t\tconst onSelectBound = ( selected: VALUE | null ): void => {\n\t\t\t\tconst newValue = getter( selected );\n\t\t\t\tconst oldValue = this.text;\n\t\t\t\tif( newValue !== oldValue ) {\n\t\t\t\t\tthis.text = newValue as VALUE;\n\t\t\t\t\tthis.emit( \"cellchange\", newValue, oldValue, this._columnIndex, this._columnData );\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst onCloseBound = (): void => {\n\t\t\t\tdialog.off( \"select\", onSelectBound );\n\t\t\t\tdialog.off( \"close\", onCloseBound );\n\t\t\t};\n\t\t\tthis.on( \"active\", (): void => {\n\t\t\t\tdialog.on( \"select\", onSelectBound );\n\t\t\t\tdialog.on( \"close\", onCloseBound );\n\t\t\t\tdialog.open();\n\t\t\t});\n\t\t}\n\t}\n\n\tget value(): VALUE {\n\t\treturn this.text as VALUE;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.text = value;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( forcibly ) {\n\t\t\tthis._textValue = value as VALUE;\n\t\t\tthis._textValueComputed = value as VALUE;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t} else {\n\t\t\tthis.text = value as VALUE;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectDialog\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectFetcherOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectFetcher = DThemeTableBodyCellSelectFetcher\n> extends DButtonOptions<VALUE, THEME>, DTableBodyCellOptions<ROW> {\n\n}\n\nexport interface DThemeTableBodyCellSelectFetcher extends DThemeButton {\n\n}\n\nexport class DTableBodyCellSelectFetcher<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectFetcher = DThemeTableBodyCellSelectFetcher,\n\tOPTIONS extends DTableBodyCellSelectFetcherOptions<ROW, VALUE, THEME> =\n\t\tDTableBodyCellSelectFetcherOptions<ROW, VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst column = options.column;\n\t\tthis._columnIndex = column.index;\n\t\tthis._columnData = column.data;\n\t\tconst selecting = column.data.selecting;\n\t\tconst fetcher = selecting.fetcher;\n\t\tif( fetcher != null ) {\n\t\t\tconst getter = selecting.getter;\n\t\t\tconst onSelectBound = ( selected: unknown ): void => {\n\t\t\t\tconst newValue = getter( selected );\n\t\t\t\tconst oldValue = this.text;\n\t\t\t\tif( newValue !== oldValue ) {\n\t\t\t\t\tthis.text = newValue as VALUE;\n\t\t\t\t\tthis.emit( \"cellchange\", newValue, oldValue, this._columnIndex, this._columnData );\n\t\t\t\t}\n\t\t\t};\n\t\t\tthis.on( \"active\", (): void => {\n\t\t\t\tfetcher().then( onSelectBound );\n\t\t\t});\n\t\t}\n\t}\n\n\tget value(): VALUE {\n\t\treturn this._textValueComputed;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.text = value;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( forcibly ) {\n\t\t\tthis._textValue = value as VALUE;\n\t\t\tthis._textValueComputed = value as VALUE;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t} else {\n\t\t\tthis.text = value as VALUE;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectFetcher\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DSelect, DSelectOptions, DThemeSelect } from \"./d-select\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectMenuOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMenu = DThemeTableBodyCellSelectMenu\n> extends DSelectOptions<VALUE, THEME>, DTableBodyCellOptions<ROW> {\n\n}\n\nexport interface DThemeTableBodyCellSelectMenu extends DThemeSelect {\n\n}\n\nexport class DTableBodyCellSelectMenu<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMenu = DThemeTableBodyCellSelectMenu,\n\tOPTIONS extends DTableBodyCellSelectMenuOptions<ROW, VALUE, THEME> = DTableBodyCellSelectMenuOptions<ROW, VALUE, THEME>\n> extends DSelect<VALUE, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tconst column = options.column;\n\t\tthis._columnIndex = column.index;\n\t\tthis._columnData = column.data;\n\t\tconst selecting = column.data.selecting;\n\t\tconst getter = selecting.getter;\n\t\tthis.on( \"change\", ( newSelected: VALUE | null, oldSelected: VALUE | null ): void => {\n\t\t\tconst newValue = getter( newSelected );\n\t\t\tconst oldValue = getter( oldSelected );\n\t\t\tthis.emit( \"cellchange\", newValue, oldValue, this._columnIndex, this._columnData );\n\t\t});\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.value = value as VALUE;\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellTextOptions<ROW, THEME extends DThemeTableBodyCellText = DThemeTableBodyCellText>\n\textends DImageBaseOptions<unknown, THEME>, DTableBodyCellOptions<ROW> {\n}\n\nexport interface DThemeTableBodyCellText extends DThemeImageBase {\n\tgetTextValue( state: DBaseState ): unknown;\n\tnewTextValue(): unknown;\n}\n\nexport class DTableBodyCellText<\n\tROW,\n\tTHEME extends DThemeTableBodyCellText = DThemeTableBodyCellText,\n\tOPTIONS extends DTableBodyCellTextOptions<ROW, THEME> = DTableBodyCellTextOptions<ROW, THEME>\n> extends DImageBase<unknown, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ): void {\n\t\tsuper.init( options );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tset( value: unknown ): void {\n\t\tthis.text = value;\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utilIndexOf } from \"./util/util-index-of\";\nimport { utilIsFunction } from \"./util/util-is-function\";\n\nexport type DTableBodyFilterFunction<ROW> = ( row: ROW, index: number, rows: ROW[] ) => boolean;\nexport interface DTableBodyFilterObject<ROW> {\n\ttest( row: ROW, index: number, rows: ROW[] ): boolean;\n}\n\ninterface DTableBodyFilterParent<ROW> {\n\trows: ROW[];\n}\n\nexport interface DTableBodyFilter<ROW> {\n\treadonly indices: number[] | undefined;\n\n\tapply(): void;\n\tunapply(): void;\n\tisApplied(): boolean;\n\tget(): DTableBodyFilterFunction<ROW> | DTableBodyFilterObject<ROW> | undefined;\n\tset( filter: DTableBodyFilterFunction<ROW> | DTableBodyFilterObject<ROW> | undefined ): void;\n}\n\nconst FILTERED_COMPARATOR = ( a: number, b: number ): number => {\n\treturn a - b;\n};\n\nexport class DTableBodyFilterImpl<ROW> implements DTableBodyFilter<ROW> {\n\tprotected _parent: DTableBodyFilterParent<ROW>;\n\tprotected _filter?: DTableBodyFilterFunction<ROW> | DTableBodyFilterObject<ROW>;\n\tprotected _filtered?: number[];\n\tprotected _onChange: () => void;\n\n\tconstructor( parent: DTableBodyFilterParent<ROW>, onChange: () => void ) {\n\t\tthis._parent = parent;\n\t\tthis._onChange = onChange;\n\t}\n\n\tapply(): void {\n\t\tconst newFiltered = this.newFiltered();\n\t\tconst oldFiltered = this._filtered;\n\t\tif( newFiltered != null ) {\n\t\t\tif( oldFiltered != null ) {\n\t\t\t\tif( newFiltered.length !== oldFiltered.length ) {\n\t\t\t\t\tthis.setFiltered( newFiltered );\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = newFiltered.length; i < imax; ++i ) {\n\t\t\t\t\t\tif( newFiltered[ i ] !== oldFiltered[ i ] ) {\n\t\t\t\t\t\t\tthis.setFiltered( newFiltered );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.setFiltered( newFiltered );\n\t\t\t}\n\t\t} else if( oldFiltered != null ) {\n\t\t\tthis.setFiltered();\n\t\t}\n\t}\n\n\tprotected setFiltered( filtered?: number[] ): void {\n\t\tthis._filtered = filtered;\n\t\tthis._onChange();\n\t}\n\n\tunapply(): void {\n\t\tif( this._filtered != null ) {\n\t\t\tthis.setFiltered();\n\t\t}\n\t}\n\n\tisApplied(): boolean {\n\t\treturn this._filtered != null;\n\t}\n\n\tprotected newFiltered(): number[] | undefined {\n\t\tconst filter = this._filter;\n\t\tif( filter != null ) {\n\t\t\tconst rows = this._parent.rows;\n\t\t\tconst rowsLength = rows.length;\n\t\t\tconst filtered: number[] = [];\n\t\t\tif( utilIsFunction( filter ) ) {\n\t\t\t\tfor( let i = 0; i < rowsLength; ++i ) {\n\t\t\t\t\tconst row = rows[ i ];\n\t\t\t\t\tif( filter( row, i, rows ) ) {\n\t\t\t\t\t\tfiltered.push( i );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < rowsLength; ++i ) {\n\t\t\t\t\tconst row = rows[ i ];\n\t\t\t\t\tif( filter.test( row, i, rows ) ) {\n\t\t\t\t\t\tfiltered.push( i );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn filtered;\n\t\t} else {\n\t\t\treturn undefined;\n\t\t}\n\t}\n\n\tget(): DTableBodyFilterFunction<ROW> | DTableBodyFilterObject<ROW> | undefined {\n\t\treturn this._filter;\n\t}\n\n\tset( filter: DTableBodyFilterFunction<ROW> | DTableBodyFilterObject<ROW> | undefined ): void {\n\t\tif( this._filter !== filter ) {\n\t\t\tthis._filter = filter;\n\t\t}\n\t}\n\n\tadd( rowIndex: number, count: number ): void {\n\t\tconst filtered = this._filtered;\n\t\tif( filtered != null ) {\n\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\tfiltered.push( rowIndex + i );\n\t\t\t}\n\t\t\tfiltered.sort( FILTERED_COMPARATOR );\n\t\t\tthis._onChange();\n\t\t}\n\t}\n\n\tshift( rowIndex: number, amount: number, add: boolean ): void {\n\t\tconst filtered = this._filtered;\n\t\tif( filtered != null ) {\n\t\t\tfor( let i = filtered.length - 1; 0 <= i; --i ) {\n\t\t\t\tconst filteredRowIndex = filtered[ i ];\n\t\t\t\tif( rowIndex <= filteredRowIndex ) {\n\t\t\t\t\tfiltered[ i ] = filteredRowIndex + amount;\n\t\t\t\t} else {\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( add ) {\n\t\t\t\tthis.add( rowIndex, amount );\n\t\t\t}\n\t\t\tthis._onChange();\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst filtered = this._filtered;\n\t\tif( filtered != null && 0 < filtered.length ) {\n\t\t\tfiltered.length = 0;\n\t\t\tthis._onChange();\n\t\t}\n\t}\n\n\tremove( rowIndex: number ): boolean {\n\t\tconst filtered = this._filtered;\n\t\tif( filtered != null ) {\n\t\t\tconst index = utilIndexOf( filtered, rowIndex );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tfiltered.splice( index, 1 );\n\t\t\t\tthis._onChange();\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tget indices(): number[] | undefined {\n\t\treturn this._filtered;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDate, DDialogDateOptions } from \"./d-dialog-date\";\nimport { DDialogDates } from \"./d-dialog-dates\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { utilIsNumber } from \"./util/util-is-number\";\n\nexport interface DTableBodyCellDateOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDate = DThemeTableBodyCellDate\n> extends DButtonOptions<Date, THEME>, DTableBodyCellOptions<ROW> {\n\tdialog?: DDialogDateOptions;\n}\n\nexport interface DThemeTableBodyCellDate extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellDate ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DTableBodyCellDate<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDate = DThemeTableBodyCellDate,\n\tOPTIONS extends DTableBodyCellDateOptions<ROW, THEME> = DTableBodyCellDateOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected _dialog?: DDialogDate;\n\tprotected _dialogOptions?: DDialogDateOptions;\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._dialogOptions = options.dialog;\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.text = new Date( dialogNew.getTime() );\n\t\t\t\tthis.emit( \"cellchange\", dialogNew, dialogCurrent, this._columnIndex, this._columnData );\n\t\t\t});\n\t\t});\n\t}\n\n\tget dialog(): DDialogDate {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDate( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDates.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( utilIsNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDatetime, DDialogDatetimeOptions } from \"./d-dialog-datetime\";\nimport { DDialogDatetimes } from \"./d-dialog-datetimes\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimes } from \"./d-picker-datetimes\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { utilIsNumber } from \"./util/util-is-number\";\n\nexport interface DTableBodyCellDatetimeOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDatetime = DThemeTableBodyCellDatetime\n> extends DButtonOptions<Date, THEME>, DTableBodyCellOptions<ROW> {\n\tdialog?: DDialogDatetimeOptions;\n}\n\nexport interface DThemeTableBodyCellDatetime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellDatetime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DTableBodyCellDatetime<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDatetime = DThemeTableBodyCellDatetime,\n\tOPTIONS extends DTableBodyCellDatetimeOptions<ROW, THEME> = DTableBodyCellDatetimeOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected static DIALOG?: DDialogDatetime;\n\tprotected _dialog?: DDialogDatetime;\n\tprotected _dialogOptions?: DDialogDatetimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis._dialogOptions = options.dialog;\n\t\tthis._datetimeMask = DPickerDatetimes.toMask( options && options.dialog && options.dialog.picker );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.page = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.text = new Date( dialogNew.getTime() );\n\t\t\t\tthis.emit( \"cellchange\", dialogNew, dialogCurrent, this._columnIndex, this._columnData );\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogDatetime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogDatetime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDatetimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( utilIsNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogTime, DDialogTimeOptions } from \"./d-dialog-time\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\nimport { DTableBodyCell, DTableBodyCellOptions } from \"./d-table-body-cell\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { utilIsNumber } from \"./util/util-is-number\";\n\nexport interface DTableBodyCellTimeOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellTime = DThemeTableBodyCellTime\n> extends DButtonOptions<Date, THEME>, DTableBodyCellOptions<ROW> {\n\tdialog?: DDialogTimeOptions;\n}\n\nexport interface DThemeTableBodyCellTime extends DThemeButton {\n\tgetTextFormatter(): ( value: Date, caller: DTableBodyCellTime ) => string;\n\tgetTextValue( state: DBaseState ): Date;\n\tnewTextValue(): Date;\n}\n\nexport class DTableBodyCellTime<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellTime = DThemeTableBodyCellTime,\n\tOPTIONS extends DTableBodyCellTimeOptions<ROW, THEME> = DTableBodyCellTimeOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell {\n\tprotected static DIALOG?: DDialogTime;\n\tprotected _dialog?: DDialogTime;\n\tprotected _dialogOptions?: DDialogTimeOptions;\n\tprotected _datetimeMask!: DPickerDatetimeMask;\n\tprotected _columnIndex!: number;\n\tprotected _columnData!: DTableColumn<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis._dialogOptions = options.dialog;\n\t\tthis._datetimeMask = DPickerTimes.toMask( options.dialog && options.dialog.picker );\n\t\tthis._columnIndex = options.column.index;\n\t\tthis._columnData = options.column.data;\n\n\t\tsuper.init( options );\n\n\t\tthis.on( \"active\", (): void => {\n\t\t\tconst currentTime = this._textValueComputed.getTime();\n\t\t\tconst dialog = this.dialog;\n\t\t\tdialog.current = new Date( currentTime );\n\t\t\tdialog.new = new Date( currentTime );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst dialogNew = dialog.new;\n\t\t\t\tconst dialogCurrent = dialog.current;\n\t\t\t\tthis.text = new Date( dialogNew.getTime() );\n\t\t\t\tthis.emit( \"cellchange\", dialogNew, dialogCurrent, this._columnIndex, this._columnData );\n\t\t\t});\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\treturn this._datetimeMask;\n\t}\n\n\tget dialog(): DDialogTime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst dialogOptions = this._dialogOptions;\n\t\t\tif( dialogOptions != null ) {\n\t\t\t\tdialog = new DDialogTime( this._dialogOptions );\n\t\t\t} else {\n\t\t\t\tif( DTableBodyCellTime.DIALOG == null ) {\n\t\t\t\t\tDTableBodyCellTime.DIALOG = new DDialogTime();\n\t\t\t\t}\n\t\t\t\tdialog = DTableBodyCellTime.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tset( value: unknown, rowIndex: number, columnIndex: number, forcibly?: boolean ): void {\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( utilIsNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\t}\n\n\tunset(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableRowOptions<ROW, THEME extends DThemeTableRow = DThemeTableRow>\n\textends DLayoutHorizontalOptions<THEME> {\n\tcolumns?: Array<DTableColumn<ROW>>;\n}\n\nexport interface DThemeTableRow extends DThemeLayoutHorizontal {\n\n}\n\nexport abstract class DTableRow<\n\tROW,\n\tTHEME extends DThemeTableRow = DThemeTableRow,\n\tOPTIONS extends DTableRowOptions<ROW, THEME> = DTableRowOptions<ROW, THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _columns!: Array<DTableColumn<ROW>>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Cells\n\t\tconst columns = this._columns = options.columns || [];\n\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\tthis.addChild( this.newCell( columns[ i ], i, columns, options ) );\n\t\t}\n\t}\n\n\tprotected abstract newCell(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\toptions: OPTIONS\n\t): DBase;\n\n\tprotected getType(): string {\n\t\treturn \"DTableRow\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\n\nexport enum DTableSelectionType {\n\tNONE,\n\tSINGLE,\n\tMULTIPLE\n}\n\nconst COMPARATOR = ( a: [number, unknown], b: [number, unknown] ): number => {\n\treturn a[ 0 ] - b[ 0 ];\n};\n\nexport class DTableSelection<ROW> extends utils.EventEmitter {\n\tprotected _type: DTableSelectionType;\n\tprotected _indices: Set<number>;\n\tprotected _data: ROW[];\n\tprotected _onChange: () => void;\n\n\tconstructor( type: DTableSelectionType, data: ROW[], onChange: () => void ) {\n\t\tsuper();\n\n\t\tthis._type = type;\n\t\tthis._indices = new Set<number>();\n\t\tthis._data = data;\n\t\tthis._onChange = onChange;\n\t}\n\n\tget type(): DTableSelectionType {\n\t\treturn this._type;\n\t}\n\n\tprotected onChange(): void {\n\t\tthis._onChange();\n\t\tthis.emit( \"change\", this );\n\t}\n\n\ttoggle( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tif( indices.has( rowIndex ) ) {\n\t\t\tindices.delete( rowIndex );\n\t\t} else {\n\t\t\tindices.add( rowIndex );\n\t\t}\n\t\tthis.onChange();\n\t}\n\n\tadd( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tindices.add( rowIndex );\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected getFirstIndex(): number | null {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tlet result: number = NaN;\n\t\t\tindices.forEach(( index: number ): void => {\n\t\t\t\tif( result !== result ) {\n\t\t\t\t\tresult = index;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getLastIndex(): number | null {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tlet result: number = 0;\n\t\t\tindices.forEach(( index: number ): void => {\n\t\t\t\tresult = index;\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\taddTo( rowIndex: number ): void {\n\t\tconst lastRowIndex = this.getLastIndex();\n\t\tif( lastRowIndex != null ) {\n\t\t\tthis.addRange( lastRowIndex, false, rowIndex, true );\n\t\t}\n\t}\n\n\taddRange( from: number, includeFrom: boolean, to: number, includeTo: boolean ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tif( from < to ) {\n\t\t\tfor( let i = from + (includeFrom ? 0 : 1), imax = to + (includeTo ? 1 : 0); i < imax; ++i ) {\n\t\t\t\tindices.add( i );\n\t\t\t}\n\t\t} else {\n\t\t\tfor( let i = to + (includeTo ? 0 : 1), imax = from + (includeFrom ? 1 : 0); i < imax; ++i ) {\n\t\t\t\tindices.add( i );\n\t\t\t}\n\t\t}\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\taddAll( rowIndices: number[] ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\tindices.add( rowIndices[ i ] );\n\t\t}\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tcontains( rowIndex: number ): boolean {\n\t\treturn this._indices.has( rowIndex );\n\t}\n\n\tremove( rowIndex: number ): void {\n\t\tif( this._indices.delete( rowIndex ) ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tindices.clear();\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclearAndAdd( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tif( ! indices.has( rowIndex ) || indices.size !== 1 ) {\n\t\t\tindices.clear();\n\t\t\tindices.add( rowIndex );\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclearAndAddAll( rowIndices: number[] ): void {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size || 0 < rowIndices.length ) {\n\t\t\tindices.clear();\n\t\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\t\tindices.add( rowIndices[ i ] );\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tshift( rowIndex: number, amount: number ): void {\n\t\tconst shifted: number[] = [];\n\t\tconst indices = this._indices;\n\t\tindices.forEach(( index: number ): void => {\n\t\t\tif( rowIndex <= index ) {\n\t\t\t\tshifted.push( index );\n\t\t\t}\n\t\t});\n\t\tconst shiftedLength = shifted.length;\n\t\tif( 0 < shiftedLength ) {\n\t\t\tfor( let i = 0, imax = shifted.length; i < imax; ++i ) {\n\t\t\t\tindices.delete( shifted[ i ] );\n\t\t\t}\n\t\t\tfor( let i = 0, imax = shifted.length; i < imax; ++i ) {\n\t\t\t\tindices.add( shifted[ i ] + amount );\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this._indices.size;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._indices.size === 0;\n\t}\n\n\t/**\n\t * Returns a copy of an index array of selected rows.\n\t * The order of indices is an insertion order.\n\t */\n\tget indices(): number[] {\n\t\tconst result: number[] = [];\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push( index );\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns a copy of an array of selected row value.\n\t * The order is an insertion order.\n\t */\n\tget rows(): unknown[] {\n\t\tconst result: unknown[] = [];\n\t\tconst data = this._data;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push( data[ index ] );\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns an array of the (index, row value) pairs of selected rows.\n\t * The order of pairs is an insertion order.\n\t */\n\ttoArray(): Array<[ number, unknown ]> {\n\t\tconst result: Array<[ number, unknown ]> = [];\n\t\tconst data = this._data;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push([ index, data[ index ]]);\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns an sorted array of the (index, row value) pairs of selected rows.\n\t */\n\ttoSortedArray(): Array<[ number, unknown ]> {\n\t\treturn this.toArray().sort( COMPARATOR );\n\t}\n\n\ttoObject(): {[index: number]: unknown} {\n\t\tconst result: {[index: number]: unknown} = {};\n\t\tconst data = this._data;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult[ index ] = data[ index ];\n\t\t});\n\t\treturn result;\n\t}\n\n\ttoMap(): Map<number, unknown> {\n\t\tconst result: Map<number, unknown> = new Map<number, unknown>();\n\t\tconst data = this._data;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.set( index, data[ index ] );\n\t\t});\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DTableBodyCell } from \"./d-table-body-cell\";\nimport { DTableBodyCellCheck } from \"./d-table-body-cell-check\";\nimport { DTableBodyCellColor } from \"./d-table-body-cell-color\";\nimport { DTableBodyCellDate } from \"./d-table-body-cell-date\";\nimport { DTableBodyCellDatetime } from \"./d-table-body-cell-datetime\";\nimport { DTableBodyCellIndex } from \"./d-table-body-cell-index\";\nimport { DTableBodyCellInputInteger } from \"./d-table-body-cell-input-integer\";\nimport { DTableBodyCellInputReal } from \"./d-table-body-cell-input-real\";\nimport { DTableBodyCellInputText } from \"./d-table-body-cell-input-text\";\nimport { DTableBodyCellSelectDialog } from \"./d-table-body-cell-select-dialog\";\nimport { DTableBodyCellSelectFetcher } from \"./d-table-body-cell-select-fetcher\";\nimport { DTableBodyCellSelectMenu } from \"./d-table-body-cell-select-menu\";\nimport { DTableBodyCellText } from \"./d-table-body-cell-text\";\nimport { DTableBodyCellTime } from \"./d-table-body-cell-time\";\nimport {\n\tDTableBodyCellOptionsMerged, DTableBodyCellOptionsUnion,\n\tDTableColumn, DTableColumnType\n} from \"./d-table-column\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\n\nexport interface DTableBodyRowOptions<ROW, THEME extends DThemeTableBodyRow = DThemeTableBodyRow>\n\textends DTableRowOptions<ROW, THEME> {\n\theight?: number;\n\tcell?: DTableBodyCellOptionsUnion<ROW>;\n}\n\nexport interface DThemeTableBodyRow extends DThemeTableRow {\n\n}\n\nconst isBodyCell = ( target: any ): target is DTableBodyCell => {\n\treturn (target != null && \"set\" in target);\n};\n\ntype OnCellChange = (\n\tnewCellValue: unknown, oldCellValue: unknown,\n\tcolumnIndex: number, column: DTableColumn<unknown>\n) => void;\n\nexport class DTableBodyRow<\n\tROW,\n\tTHEME extends DThemeTableBodyRow = DThemeTableBodyRow,\n\tOPTIONS extends DTableBodyRowOptions<ROW, THEME> = DTableBodyRowOptions<ROW, THEME>\n> extends DTableRow<ROW, THEME, OPTIONS> {\n\tprotected _row: ROW | undefined = undefined;\n\tprotected _onCellChangeBound!: OnCellChange;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tthis._onCellChangeBound = (\n\t\t\tnewCellValue: unknown, oldCellValue: unknown,\n\t\t\tcolumnIndex: number, column: DTableColumn<unknown>\n\t\t): void => {\n\t\t\tconst row = this._row;\n\t\t\tif( row != null ) {\n\t\t\t\tcolumn.setter( row, columnIndex, newCellValue );\n\t\t\t\tthis.emit( \"change\", newCellValue, oldCellValue, columnIndex, this );\n\t\t\t}\n\t\t};\n\t\tsuper.init( options );\n\t}\n\n\tprotected newCell(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\toptions: OPTIONS\n\t): DBase {\n\t\tconst cellOptions = this.toCellOptions( column, columnIndex, options ) as any;\n\t\tif( column.editable ) {\n\t\t\tconst cell = this.newCellEditable( column, columnIndex, cellOptions );\n\t\t\tcell.on( \"cellchange\", this._onCellChangeBound );\n\t\t\treturn cell;\n\t\t} else {\n\t\t\tconst cell = this.newCellUnediable( column, columnIndex, cellOptions );\n\t\t\tcell.setReadOnly( true );\n\t\t\treturn cell;\n\t\t}\n\t}\n\n\tprotected newCellEditable(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\toptions: any\n\t): DBase {\n\t\tswitch( column.type ) {\n\t\tcase DTableColumnType.INDEX:\n\t\t\treturn new DTableBodyCellIndex( options );\n\t\tcase DTableColumnType.TEXT:\n\t\t\treturn new DTableBodyCellInputText( options );\n\t\tcase DTableColumnType.INTEGER:\n\t\t\treturn new DTableBodyCellInputInteger( options );\n\t\tcase DTableColumnType.REAL:\n\t\t\treturn new DTableBodyCellInputReal( options );\n\t\tcase DTableColumnType.CHECK:\n\t\t\treturn new DTableBodyCellCheck( options );\n\t\tcase DTableColumnType.COLOR:\n\t\t\treturn new DTableBodyCellColor( options );\n\t\tcase DTableColumnType.BUTTON:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.SELECT:\n\t\t\tconst selecting = column.selecting;\n\t\t\tif( selecting.menu != null ) {\n\t\t\t\treturn new DTableBodyCellSelectMenu( options );\n\t\t\t} else if( selecting.dialog != null ) {\n\t\t\t\treturn new DTableBodyCellSelectDialog( options );\n\t\t\t} else if( selecting.fetcher != null ) {\n\t\t\t\treturn new DTableBodyCellSelectFetcher( options );\n\t\t\t} else {\n\t\t\t\treturn new DTableBodyCellText( options );\n\t\t\t}\n\t\tcase DTableColumnType.DATE:\n\t\t\treturn new DTableBodyCellDate( options );\n\t\tcase DTableColumnType.DATETIME:\n\t\t\treturn new DTableBodyCellDatetime( options );\n\t\tcase DTableColumnType.TIME:\n\t\t\treturn new DTableBodyCellTime( options );\n\t\tdefault:\n\t\t\treturn new DTableBodyCellText( options );\n\t\t}\n\t}\n\tprotected newCellUnediable(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\toptions: any\n\t): DBase {\n\t\tswitch( column.type ) {\n\t\tcase DTableColumnType.INDEX:\n\t\t\treturn new DTableBodyCellIndex( options );\n\t\tcase DTableColumnType.TEXT:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.INTEGER:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.REAL:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.CHECK:\n\t\t\treturn new DTableBodyCellCheck( options );\n\t\tcase DTableColumnType.COLOR:\n\t\t\treturn new DTableBodyCellColor( options );\n\t\tcase DTableColumnType.BUTTON:\n\t\t\treturn new DTableBodyCellText( options );\n\t\tcase DTableColumnType.SELECT:\n\t\t\tconst selecting = column.selecting;\n\t\t\tif( selecting.menu != null ) {\n\t\t\t\treturn new DTableBodyCellSelectMenu( options );\n\t\t\t} else if( selecting.dialog != null ) {\n\t\t\t\treturn new DTableBodyCellSelectDialog( options );\n\t\t\t} else if( selecting.fetcher != null ) {\n\t\t\t\treturn new DTableBodyCellSelectFetcher( options );\n\t\t\t} else {\n\t\t\t\treturn new DTableBodyCellText( options );\n\t\t\t}\n\t\tcase DTableColumnType.DATE:\n\t\t\treturn new DTableBodyCellDate( options );\n\t\tcase DTableColumnType.DATETIME:\n\t\t\treturn new DTableBodyCellDatetime( options );\n\t\tcase DTableColumnType.TIME:\n\t\t\treturn new DTableBodyCellTime( options );\n\t\tdefault:\n\t\t\treturn new DTableBodyCellText( options );\n\t\t}\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\toptions: OPTIONS\n\t): DTableBodyCellOptionsUnion<ROW> {\n\t\tlet result = (column.body || options.cell) as DTableBodyCellOptionsMerged<ROW> | undefined;\n\t\tif( result != null ) {\n\t\t\tresult.weight = column.weight;\n\t\t\tresult.width = column.width;\n\t\t\tconst text = result.text = result.text || {};\n\t\t\tconst align = text.align = text.align || {};\n\t\t\talign.horizontal = column.align;\n\t\t\ttext.formatter = column.formatter;\n\t\t\tresult.column = {\n\t\t\t\tindex: columnIndex,\n\t\t\t\tdata: column\n\t\t\t};\n\t\t\tif( column.selecting.menu ) {\n\t\t\t\tresult.menu = column.selecting.menu;\n\t\t\t}\n\t\t} else {\n\t\t\tresult = {\n\t\t\t\tweight: column.weight,\n\t\t\t\twidth: column.width,\n\t\t\t\ttext: {\n\t\t\t\t\tformatter: column.formatter,\n\t\t\t\t\talign: {\n\t\t\t\t\t\thorizontal: column.align\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcolumn: {\n\t\t\t\t\tindex: columnIndex,\n\t\t\t\t\tdata: column\n\t\t\t\t},\n\t\t\t\tmenu: column.selecting.menu\n\t\t\t};\n\t\t}\n\n\t\tif( column.editable ) {\n\t\t\tconst editing = result!.editing = result!.editing || {};\n\t\t\tediting.formatter = editing.formatter || column.editing.formatter;\n\t\t\tediting.unformatter = editing.unformatter || column.editing.unformatter as any;\n\t\t\tediting.validator = editing.validator || column.editing.validator as any;\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyRow\";\n\t}\n\n\tset( row: ROW, rowIndex: number, forcibly?: boolean ): void {\n\t\tif( forcibly || this._row !== row ) {\n\t\t\tthis._row = row;\n\n\t\t\tconst cells = this.children;\n\t\t\tconst cellsLength = cells.length;\n\t\t\tconst columns = this._columns;\n\t\t\tconst columnsLength = columns.length;\n\t\t\tfor( let i = 0, imax = Math.min( columnsLength, cellsLength ); i < imax; ++i ) {\n\t\t\t\tconst cell = cells[ cellsLength - i - 1 ];\n\t\t\t\tconst columnIndex = columnsLength - i - 1;\n\t\t\t\tconst column = columns[ columnIndex ];\n\t\t\t\tif( isBodyCell( cell ) ) {\n\t\t\t\t\tcell.set( column.getter( row, columnIndex ), rowIndex, columnIndex, forcibly );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit( \"set\", row, rowIndex, this );\n\t\t}\n\t}\n\n\tunset(): void {\n\t\tif( this._row !== undefined ) {\n\t\t\tthis._row = undefined;\n\n\t\t\tconst cells = this.children;\n\t\t\tfor( let i = 0, imax = cells.length; i < imax; ++i ) {\n\t\t\t\tconst cell = cells[ i ];\n\t\t\t\tif( isBodyCell( cell ) ) {\n\t\t\t\t\tcell.unset();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit( \"unset\", this );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTableBodyRow, DTableBodyRowOptions, DThemeTableBodyRow } from \"./d-table-body-row\";\n\nexport interface DTableBodyRowEvenOptions<ROW, THEME extends DThemeTableBodyRowEven = DThemeTableBodyRowEven>\n\textends DTableBodyRowOptions<ROW, THEME> {\n\n}\n\nexport interface DThemeTableBodyRowEven extends DThemeTableBodyRow {\n\n}\n\nexport class DTableBodyRowEven<\n\tROW,\n\tTHEME extends DThemeTableBodyRowEven = DThemeTableBodyRowEven,\n\tOPTIONS extends DTableBodyRowEvenOptions<ROW, THEME> = DTableBodyRowEvenOptions<ROW, THEME>\n> extends DTableBodyRow<ROW, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DTableBodyRowEven\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTableBodyRow, DTableBodyRowOptions, DThemeTableBodyRow } from \"./d-table-body-row\";\n\nexport interface DTableBodyRowOddOptions<ROW, THEME extends DThemeTableBodyRowOdd = DThemeTableBodyRowOdd>\n\textends DTableBodyRowOptions<ROW, THEME> {\n\n}\n\nexport interface DThemeTableBodyRowOdd extends DThemeTableBodyRow {\n\n}\n\nexport class DTableBodyRowOdd<\n\tROW,\n\tTHEME extends DThemeTableBodyRowOdd = DThemeTableBodyRowOdd,\n\tOPTIONS extends DTableBodyRowOddOptions<ROW, THEME> = DTableBodyRowOddOptions<ROW, THEME>\n> extends DTableBodyRow<ROW, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DTableBodyRowOdd\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { DButtonBase } from \"./d-button-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport {\n\tDTableBodyFilter, DTableBodyFilterFunction, DTableBodyFilterImpl, DTableBodyFilterObject\n} from \"./d-table-body-filter\";\nimport { DTableBodyRow, DTableBodyRowOptions } from \"./d-table-body-row\";\nimport { DTableBodyRowEven } from \"./d-table-body-row-even\";\nimport { DTableBodyRowOdd } from \"./d-table-body-row-odd\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { DTableSelection, DTableSelectionType } from \"./d-table-selection\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTableBodyOptions<\n\tROW,\n\tTHEME extends DThemeTableBody = DThemeTableBody,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\tcolumns?: Array<DTableColumn<ROW>>;\n\tdata?: ROW[];\n\tselection?: {\n\t\ttype?: (keyof typeof DTableSelectionType) | DTableSelectionType;\n\t};\n\trow?: DTableBodyRowOptions<ROW>;\n\tfilter?: DTableBodyFilterFunction<ROW> | DTableBodyFilterObject<ROW>;\n}\n\nexport interface DThemeTableBody extends DThemePane {\n\tgetRowHeight(): number;\n}\n\nconst toData = <ROW>( data: ROW[] | undefined ): ROW[] => {\n\tconst result: ROW[] = [];\n\tif( data != null ) {\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tresult.push( data[ i ] );\n\t\t}\n\t}\n\treturn result;\n};\n\nconst toSelectionType = ( options: DTableBodyOptions<any> ): DTableSelectionType => {\n\treturn ( options.selection && options.selection.type != null ?\n\t\t( utilIsString( options.selection.type ) ? DTableSelectionType[ options.selection.type ] : options.selection.type ) :\n\t\tDTableSelectionType.NONE\n\t);\n};\n\nconst toRowOptions = <ROW>(\n\ttheme: DThemeTableBody,\n\toptions: DTableBodyOptions<ROW>,\n\tselectionType: DTableSelectionType\n): DTableBodyRowOptions<ROW> => {\n\tconst columns = options.columns || [];\n\tlet result = options.row;\n\tif( result != null ) {\n\t\tif( result.height == null ) {\n\t\t\tresult.height = theme.getRowHeight();\n\t\t}\n\t\tif( result.columns === undefined ) {\n\t\t\tresult.columns = columns;\n\t\t}\n\t\tif( selectionType !== DTableSelectionType.NONE && result.interactive == null ) {\n\t\t\tresult.interactive = \"SELF\";\n\t\t}\n\t} else {\n\t\tresult = {\n\t\t\tcolumns,\n\t\t\theight: theme.getRowHeight(),\n\t\t\tinteractive: ( selectionType !== DTableSelectionType.NONE ? \"SELF\" : undefined )\n\t\t};\n\t}\n\treturn result as DTableBodyRowOptions<ROW>;\n};\n\nexport class DTableBody<\n\tROW,\n\tTHEME extends DThemeTableBody = DThemeTableBody,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DTableBodyOptions<ROW, THEME, CONTENT_OPTIONS> = DTableBodyOptions<ROW, THEME, CONTENT_OPTIONS>\n> extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected static WORK_ON_CLICK = new Point();\n\tprotected _columns!: Array<DTableColumn<ROW>>;\n\tprotected _rowHeight!: number;\n\tprotected _rowIndexStart!: number;\n\tprotected _rowIndexEnd!: number;\n\tprotected _data!: ROW[];\n\tprotected _rowOptions!: DTableBodyRowOptions<ROW>;\n\tprotected _selection!: DTableSelection<ROW>;\n\tprotected _updateRowsCount!: number;\n\tprotected _isUpdateRowsCalled!: boolean;\n\tprotected _isUpdateRowsCalledForcibly!: boolean;\n\tprotected _filter!: DTableBodyFilterImpl<ROW>;\n\tprotected _workRows!: Array<DTableBodyRow<ROW>>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst theme = this.theme;\n\t\tconst selectionType = toSelectionType( options );\n\t\tconst rowOptions = toRowOptions( theme, options, selectionType );\n\t\tthis._rowOptions = rowOptions;\n\t\tthis._rowHeight = ( rowOptions.height != null ? rowOptions.height : theme.getRowHeight() );\n\t\tthis._columns = rowOptions.columns || [];\n\t\tthis._rowIndexStart = 0;\n\t\tthis._rowIndexEnd = 0;\n\t\tthis._data = toData( options.data );\n\t\tthis._updateRowsCount = 0;\n\t\tthis._isUpdateRowsCalled = false;\n\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\tthis._workRows = [];\n\t\tconst selection = this._selection = new DTableSelection( selectionType, this._data, (): void => {\n\t\t\tthis.onSelectionChange();\n\t\t});\n\n\t\tthis._filter = new DTableBodyFilterImpl<ROW>( this, (): void => {\n\t\t\tthis.onFilterChange();\n\t\t});\n\t\tif( options && options.filter ) {\n\t\t\tthis._filter.set( options.filter );\n\t\t}\n\n\t\tconst content = this.content;\n\t\tcontent.on( \"move\", (): void => {\n\t\t\tthis.update();\n\t\t});\n\t\tcontent.on( \"resize\", (): void => {\n\t\t\tthis.update();\n\t\t});\n\t\tthis.update();\n\n\t\tif( selection.type !== DTableSelectionType.NONE ) {\n\t\t\tUtilPointerEvent.onClick( this, ( e: InteractionEvent ): void => {\n\t\t\t\tif( this.isActionable() ) {\n\t\t\t\t\tconst local = DTableBody.WORK_ON_CLICK;\n\t\t\t\t\tlocal.copyFrom( e.data.global );\n\t\t\t\t\tcontent.toLocal( local, undefined, local, false );\n\t\t\t\t\tconst rowIndex = Math.floor( local.y / this._rowHeight );\n\t\t\t\t\tconst indices = this._filter.indices;\n\t\t\t\t\tconst data = this._data;\n\t\t\t\t\tconst dataLength = ( indices != null ? indices.length : data.length );\n\t\t\t\t\tif( 0 <= rowIndex && rowIndex < dataLength ) {\n\t\t\t\t\t\tconst isSingle = ( selection.type === DTableSelectionType.SINGLE );\n\t\t\t\t\t\tconst isNotSingle = ! isSingle;\n\t\t\t\t\t\tconst originalEvent = e.data.originalEvent;\n\t\t\t\t\t\tconst ctrlKey = originalEvent.ctrlKey;\n\t\t\t\t\t\tconst shiftKey = originalEvent.shiftKey;\n\t\t\t\t\t\tconst realRowIndex = ( indices ? indices[ rowIndex ] : rowIndex );\n\t\t\t\t\t\tif( isSingle || selection.isEmpty() || ! ( isNotSingle && ( ctrlKey || shiftKey ) ) ) {\n\t\t\t\t\t\t\tselection.clearAndAdd( realRowIndex );\n\t\t\t\t\t\t} else if( ctrlKey ) {\n\t\t\t\t\t\t\tselection.toggle( realRowIndex );\n\t\t\t\t\t\t} else if( shiftKey ) {\n\t\t\t\t\t\t\tselection.addTo( realRowIndex );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.update();\n\t}\n\n\tget selection(): DTableSelection<ROW> {\n\t\treturn this._selection;\n\t}\n\n\tlock(): void {\n\t\tthis._updateRowsCount += 1;\n\t\tif( this._updateRowsCount === 1 ) {\n\t\t\tthis._isUpdateRowsCalled = false;\n\t\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\t}\n\t}\n\n\tunlock( callIfNeeded: boolean ): void {\n\t\tthis._updateRowsCount -= 1;\n\t\tif( this._updateRowsCount === 0 ) {\n\t\t\tif( callIfNeeded && this._isUpdateRowsCalled ) {\n\t\t\t\tthis.update( this._isUpdateRowsCalledForcibly );\n\t\t\t}\n\t\t\tthis._isUpdateRowsCalled = false;\n\t\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\t}\n\t}\n\n\tprotected onSelectionChange(): void {\n\t\tthis.update();\n\t}\n\n\tprotected onFilterChange(): void {\n\t\tthis.update();\n\t}\n\n\t/**\n\t * Updates rows. If the `forcibly` is true, some dirty checkings for\n\t * avoiding unnecessary state changes are skipped.\n\t *\n\t * @param forcibly true to update forcibly\n\t */\n\tupdate( forcibly?: boolean ): void {\n\t\tif( 0 < this._updateRowsCount ) {\n\t\t\tthis._isUpdateRowsCalled = true;\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._isUpdateRowsCalledForcibly = true;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst content = this.content;\n\t\tconst rows = content.children as Array<DTableBodyRow<ROW>>;\n\t\tconst height = this.height;\n\t\tconst rowHeight = this._rowHeight;\n\n\t\tconst indices = this._filter.indices;\n\t\tconst data = this._data;\n\t\tconst dataLength = ( indices != null ? indices.length : data.length );\n\n\t\tconst oldRowIndexStart = this._rowIndexStart;\n\t\tlet oldRowIndexEnd = this._rowIndexEnd;\n\t\tlet oldRowCount = oldRowIndexEnd - oldRowIndexStart;\n\n\t\tconst newContentHeight = Math.max( height, dataLength * rowHeight );\n\t\tconst newContentY = Math.max( height - newContentHeight, content.position.y );\n\t\tcontent.position.y = newContentY;\n\t\tcontent.height = newContentHeight;\n\n\t\tconst newRowIndexLowerBound = Math.floor( (0 - newContentY) / rowHeight );\n\t\tconst newRowIndexUpperBound = Math.floor( (height - newContentY) / rowHeight );\n\t\tconst newRowIndexStart = newRowIndexLowerBound - ( newRowIndexLowerBound % 2 === 0 ? 2 : 1 );\n\t\tlet newRowIndexEnd = newRowIndexUpperBound + ((newRowIndexUpperBound - newRowIndexStart + 1) % 2 === 0 ? 3 : 2);\n\t\tlet newRowCount = newRowIndexEnd - newRowIndexStart;\n\t\tif( newRowCount < oldRowCount && oldRowCount - 2 <= newRowCount ) {\n\t\t\tnewRowCount = oldRowCount;\n\t\t\tnewRowIndexEnd = newRowIndexStart + newRowCount;\n\t\t}\n\n\t\tif( oldRowCount < newRowCount ) {\n\t\t\tfor( let i = oldRowCount; i < newRowCount; ++i ) {\n\t\t\t\tconst oldRowIndex = oldRowIndexStart + i;\n\t\t\t\tconst newRow = this.newRow( (oldRowIndex % 2) === 0 );\n\t\t\t\tcontent.addChild( newRow );\n\t\t\t}\n\t\t\toldRowCount = newRowCount;\n\t\t\toldRowIndexEnd = oldRowIndexStart + oldRowCount;\n\t\t} else if( newRowCount < oldRowCount ) {\n\t\t\tfor( let i = oldRowCount - 1; newRowCount <= i; --i ) {\n\t\t\t\tcontent.removeChild( rows[ i ] );\n\t\t\t}\n\t\t\toldRowCount = newRowCount;\n\t\t\toldRowIndexEnd = oldRowIndexStart + oldRowCount;\n\t\t}\n\n\t\tthis._rowIndexStart = newRowIndexStart;\n\t\tthis._rowIndexEnd = newRowIndexEnd;\n\n\t\tconst rowIndexStartDelta = newRowIndexStart - oldRowIndexStart;\n\t\tconst absRowIndexStartDelta = Math.abs(rowIndexStartDelta);\n\t\tconst rowsLength = rows.length;\n\t\tif( 0 < absRowIndexStartDelta && absRowIndexStartDelta < rowsLength ) {\n\t\t\tconst work = this._workRows;\n\t\t\tif( 0 < rowIndexStartDelta ) {\n\t\t\t\tfor( let i = 0; i < absRowIndexStartDelta; ++i ) {\n\t\t\t\t\twork.push( this.resetRow( rows[ i ] ) );\n\t\t\t\t}\n\t\t\t\tfor( let i = absRowIndexStartDelta; i < rowsLength; ++i ) {\n\t\t\t\t\trows[ i - absRowIndexStartDelta ] = rows[ i ];\n\t\t\t\t}\n\t\t\t\tfor( let i = 0; i < absRowIndexStartDelta; ++i ) {\n\t\t\t\t\trows[ rowsLength - absRowIndexStartDelta + i ] = work[ i ];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < absRowIndexStartDelta; ++i ) {\n\t\t\t\t\twork.push( this.resetRow( rows[ rowsLength - absRowIndexStartDelta + i ] ) );\n\t\t\t\t}\n\t\t\t\tfor( let i = rowsLength - absRowIndexStartDelta - 1; 0 <= i; --i ) {\n\t\t\t\t\trows[ i + absRowIndexStartDelta ] = rows[ i ];\n\t\t\t\t}\n\t\t\t\tfor( let i = 0; i < absRowIndexStartDelta; ++i ) {\n\t\t\t\t\trows[ i ] = work[ i ];\n\t\t\t\t}\n\t\t\t}\n\t\t\twork.length = 0;\n\t\t}\n\n\t\tconst selection = this._selection;\n\t\tif( indices != null ) {\n\t\t\tfor( let i = 0; i < rowsLength; ++i ) {\n\t\t\t\tconst row = rows[ i ];\n\t\t\t\tconst rowIndex = newRowIndexStart + i;\n\t\t\t\tconst realRowIndex = indices[ rowIndex ];\n\t\t\t\trow.position.y = rowIndex * rowHeight;\n\t\t\t\trow.setDisabled( rowIndex < 0 || dataLength <= rowIndex );\n\t\t\t\trow.setActive( selection.contains( realRowIndex ) );\n\t\t\t\tif( 0 <= rowIndex && rowIndex < dataLength ) {\n\t\t\t\t\trow.set( data[ realRowIndex ], realRowIndex, forcibly );\n\t\t\t\t} else {\n\t\t\t\t\trow.unset();\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tfor( let i = 0; i < rowsLength; ++i ) {\n\t\t\t\tconst row = rows[ i ];\n\t\t\t\tconst rowIndex = newRowIndexStart + i;\n\t\t\t\trow.position.y = rowIndex * rowHeight;\n\t\t\t\trow.setDisabled( rowIndex < 0 || dataLength <= rowIndex );\n\t\t\t\trow.setActive( selection.contains( rowIndex ) );\n\t\t\t\tif( 0 <= rowIndex && rowIndex < dataLength ) {\n\t\t\t\t\trow.set( data[ rowIndex ], rowIndex, forcibly );\n\t\t\t\t} else {\n\t\t\t\t\trow.unset();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected resetRow( row: DTableBodyRow<ROW> ): DTableBodyRow<ROW> {\n\t\trow.blur( true );\n\t\tconst cells = row.children;\n\t\tfor( let i = 0, imax = cells.length; i < imax; ++i ) {\n\t\t\tconst cell = cells[ i ];\n\t\t\tif( cell instanceof DBase ) {\n\t\t\t\tcell.setPressed( false );\n\t\t\t}\n\t\t}\n\t\treturn row;\n\t}\n\n\tprotected newRow( isEven: boolean ): DTableBodyRow<ROW> {\n\t\tconst options = this._rowOptions;\n\t\tconst result = ( isEven ?\n\t\t\tnew DTableBodyRowEven<ROW>( options ) : new DTableBodyRowOdd<ROW>( options )\n\t\t);\n\t\tresult.on( \"change\", ( newCellValue: unknown, oldCellValue: unknown, columnIndex: number ): void => {\n\t\t\tconst index = this.content.getChildIndex( result );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tconst rowIndex = this._rowIndexStart + index;\n\t\t\t\tthis.emit( \"change\", newCellValue, oldCellValue, rowIndex, columnIndex, this );\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent ): boolean {\n\t\tlet result = false;\n\t\tif( this.isActionable() && this._selection.type !== DTableSelectionType.NONE ) {\n\t\t\tconst local = UtilPointerEvent.toGlobal( e, DTableBody.WORK_ON_CLICK );\n\t\t\tconst content = this.content;\n\t\t\tcontent.toLocal( local, undefined, local, false );\n\t\t\tconst x = local.x;\n\t\t\tconst y = local.y;\n\t\t\tconst rowIndex = Math.floor( y / this._rowHeight );\n\t\t\tconst indices = this._filter.indices;\n\t\t\tconst data = this._data;\n\t\t\tconst dataLength = ( indices != null ? indices.length : data.length );\n\t\t\tif( 0 <= rowIndex && rowIndex < dataLength ) {\n\t\t\t\tconst index = rowIndex - this._rowIndexStart;\n\t\t\t\tconst rows = content.children as Array<DTableBodyRow<ROW>>;\n\t\t\t\tif( 0 <= index && index < rows.length ) {\n\t\t\t\t\tconst row = rows[ index ];\n\t\t\t\t\tconst cells = row.children as DBase[];\n\t\t\t\t\tconst cellsLength = cells.length;\n\t\t\t\t\tconst columns = this._columns;\n\t\t\t\t\tconst columnsLength = columns.length;\n\t\t\t\t\tfor( let i = 0, imax = Math.min( cellsLength, columnsLength ); i < imax; ++i ) {\n\t\t\t\t\t\tconst column = columns[ columnsLength - i - 1 ];\n\t\t\t\t\t\tif( column.editable ) {\n\t\t\t\t\t\t\tconst cell = cells[ cellsLength - i - 1 ];\n\t\t\t\t\t\t\tconst dx = x - cell.position.x;\n\t\t\t\t\t\t\tif( 0 <= dx && dx <= cell.width ) {\n\t\t\t\t\t\t\t\tcell.focus();\n\t\t\t\t\t\t\t\tif( cell instanceof DButtonBase ) {\n\t\t\t\t\t\t\t\t\tcell.onClick();\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tresult = super.onDblClick( e ) || result;\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBody\";\n\t}\n\n\t/**\n\t * Returns an array of row data.\n\t * If you need to modify the returned array,\n\t * call the `#update(boolean)` to apply your changes.\n\t */\n\tget rows(): ROW[] {\n\t\treturn this._data;\n\t}\n\n\tset rows( rows: ROW[] ) {\n\t\tif( this._data !== rows ) {\n\t\t\tthis._data = rows;\n\t\t\tthis.lock();\n\t\t\tthis._selection.clear();\n\t\t\tthis._filter.clear();\n\t\t\tthis.unlock( false );\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst data = this._data;\n\t\tif( 0 < data.length ) {\n\t\t\tdata.length = 0;\n\t\t\tthis.lock();\n\t\t\tthis._selection.clear();\n\t\t\tthis._filter.clear();\n\t\t\tthis.unlock( false );\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\tclearAndAdd( row: ROW ): void {\n\t\tconst data = this._data;\n\t\tdata.length = 0;\n\t\tdata.push( row );\n\t\tthis.lock();\n\t\tthis._selection.clear();\n\t\tthis._filter.clear();\n\t\tthis.unlock( false );\n\t\tthis.update();\n\t}\n\n\tclearAndAddAll( rows: ROW[] ): void {\n\t\tconst data = this._data;\n\t\tdata.length = 0;\n\t\tfor( let i = 0, imax = rows.length; i < imax; ++i ) {\n\t\t\tdata.push( rows[ i ] );\n\t\t}\n\t\tthis.lock();\n\t\tthis._selection.clear();\n\t\tthis._filter.clear();\n\t\tthis.unlock( false );\n\t\tthis.update();\n\t}\n\n\tadd( row: ROW, index?: number ): void {\n\t\tconst data = this._data;\n\t\tconst filter = this._filter;\n\t\tconst selection = this._selection;\n\t\tif( index == null ) {\n\t\t\tdata.push( row );\n\t\t\tthis.lock();\n\t\t\tfilter.add( data.length - 1, 1 );\n\t\t\tthis.unlock( false );\n\t\t\tthis.update();\n\t\t} else if( 0 <= index && index < data.length ) {\n\t\t\tdata.splice( index, 0, row );\n\t\t\tthis.lock();\n\t\t\tselection.shift( index, 1 );\n\t\t\tfilter.shift( index, 1, true );\n\t\t\tthis.unlock( false );\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\taddAll( rows: ROW[], index?: number ): void {\n\t\tconst data = this._data;\n\t\tconst dataLength = data.length;\n\t\tconst filter = this._filter;\n\t\tconst selection = this._selection;\n\t\tif( index == null ) {\n\t\t\tconst rowsLength = rows.length;\n\t\t\tfor( let i = 0, imax = rowsLength; i < imax; ++i ) {\n\t\t\t\tdata.push( rows[ i ] );\n\t\t\t}\n\t\t\tthis.lock();\n\t\t\tfilter.add( dataLength - 1, rowsLength );\n\t\t\tthis.unlock( false );\n\t\t\tthis.update();\n\t\t} else if( 0 <= index && index < dataLength ) {\n\t\t\tconst rowsLength = rows.length;\n\t\t\tfor( let i = 0; i < rowsLength; ++i ) {\n\t\t\t\tdata.splice( index + i, 0, rows[ i ] );\n\t\t\t}\n\t\t\tthis.lock();\n\t\t\tselection.shift( index, rowsLength );\n\t\t\tfilter.shift( index, rowsLength, true );\n\t\t\tthis.unlock( false );\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\tget( index: number ): ROW | null {\n\t\tconst data = this._data;\n\t\tif( 0 <= index && index < data.length ) {\n\t\t\treturn data[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, row: ROW ): ROW | null {\n\t\tconst data = this._data;\n\t\tif( 0 <= index && index < data.length ) {\n\t\t\tconst result = data[ index ];\n\t\t\tdata[ index ] = row;\n\t\t\tthis.update();\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tremove( index: number ): ROW | null {\n\t\tconst data = this._data;\n\t\tif( 0 <= index && index < data.length ) {\n\t\t\tconst result = data.splice( index, 1 )[ 0 ];\n\t\t\tthis.lock();\n\t\t\tthis._selection.remove( index );\n\t\t\tthis._filter.remove( index );\n\t\t\tthis.unlock( false );\n\t\t\tthis.update();\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._data.length;\n\t}\n\n\tget filter(): DTableBodyFilter<ROW> {\n\t\treturn this._filter;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DThemeText } from \"./d-text\";\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\n\nexport interface DTableHeaderCellOptions<THEME extends DThemeText = DThemeText>\n\textends DTextBaseOptions<string | null, THEME> {\n}\n\nexport interface DThemeTableHeaderCell extends DThemeTextBase {\n\tgetTextFormatter(): ( value: string | null, caller: DTableHeaderCell ) => string;\n\tgetTextValue( state: DBaseState ): string | null;\n\tnewTextValue(): DStateAwareOrValueMightBe<string | null>;\n}\n\nexport class DTableHeaderCell<\n\tTHEME extends DThemeTableHeaderCell = DThemeTableHeaderCell,\n\tOPTIONS extends DTableHeaderCellOptions<THEME> = DTableHeaderCellOptions<THEME>\n> extends DTextBase<string | null, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.setState( DBaseState.UNFOCUSABLE, true );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableHeaderCell\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { DTableHeaderCell, DTableHeaderCellOptions } from \"./d-table-header-cell\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\n\nexport interface DTableHeaderOptions<ROW, THEME extends DThemeTableHeader = DThemeTableHeader>\n\textends DTableRowOptions<ROW, THEME> {\n\tcell?: DTableHeaderCellOptions;\n}\n\nexport interface DThemeTableHeader extends DThemeTableRow {\n\n}\n\nexport class DTableHeader<\n\tROW,\n\tTHEME extends DThemeTableHeader = DThemeTableHeader,\n\tOPTIONS extends DTableHeaderOptions<ROW, THEME> = DTableHeaderOptions<ROW, THEME>\n> extends DTableRow<ROW, THEME, OPTIONS> {\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tprotected newCell(\n\t\tcolumn: DTableColumn<ROW>,\n\t\tcolumnIndex: number,\n\t\tcolumns: Array<DTableColumn<ROW>>,\n\t\toptions: OPTIONS\n\t): DBase {\n\t\treturn new DTableHeaderCell( this.toCellOptions( column, options ) );\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumn: DTableColumn<ROW>,\n\t\toptions: OPTIONS\n\t): DTableHeaderCellOptions {\n\t\tconst header = column.header || options.cell;\n\t\tif( header != null ) {\n\t\t\theader.weight = column.weight;\n\t\t\theader.width = column.width;\n\t\t\tconst text = header.text = header.text || {};\n\t\t\ttext.value = text.value || column.label;\n\t\t\treturn header;\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tweight: column.weight,\n\t\t\t\twidth: column.width,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: column.label\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableHeader\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogSelectOptions } from \"../ui/d-dialog-select\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DDialogSelect } from \"./d-dialog-select\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DTableBody, DTableBodyOptions, DThemeTableBody } from \"./d-table-body\";\nimport {\n\tDTableColumn, DTableColumnEditing, DTableColumnEditingOptions, DTableColumnOptions,\n\tDTableColumnSelecting, DTableColumnSelectingOptions, DTableColumnType, DTableEditingUnformatter,\n\tDTableGetter, DTableSelectingGetter, DTableSetter\n} from \"./d-table-column\";\nimport { DTableHeader, DTableHeaderOptions, DThemeTableHeader } from \"./d-table-header\";\nimport { utilIsString } from \"./util/util-is-string\";\nimport { utilToString } from \"./util/util-to-string\";\n\nexport interface DTableOptions<ROW, THEME extends DThemeTable = DThemeTable> extends DLayoutVerticalOptions<THEME> {\n\tcolumns: Array<DTableColumnOptions<ROW>>;\n\theader?: DTableHeaderOptions<ROW>;\n\tbody?: DTableBodyOptions<ROW>;\n\tdata?: ROW[];\n}\n\nexport interface DThemeTable extends DThemeLayoutVertical {\n\n}\n\nconst defaultGetter: DTableGetter<any> = ( row: any, index: number ): unknown => {\n\treturn row[ index ];\n};\n\nconst defaultSetter: DTableSetter<any> = ( row: any, index: number, cell: unknown ): void => {\n\trow[ index ] = cell;\n};\n\nconst defaultEditingUnformatter: DTableEditingUnformatter = ( cell: string ): unknown => {\n\treturn cell;\n};\n\nconst toColumnAlign = <ROW>( options: DTableColumnOptions<ROW>, type: DTableColumnType ): DAlignHorizontal => {\n\tif( options.align != null ) {\n\t\tif( utilIsString( options.align ) ) {\n\t\t\treturn DAlignHorizontal[ options.align ];\n\t\t} else {\n\t\t\treturn options.align;\n\t\t}\n\t}\n\tswitch( type ) {\n\tcase DTableColumnType.TEXT:\n\t\treturn DAlignHorizontal.LEFT;\n\tcase DTableColumnType.REAL:\n\tcase DTableColumnType.INTEGER:\n\t\treturn DAlignHorizontal.RIGHT;\n\tcase DTableColumnType.INDEX:\n\tcase DTableColumnType.SELECT:\n\t\treturn DAlignHorizontal.CENTER;\n\tdefault:\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n};\n\nconst toColumnEditing = ( options: DTableColumnEditingOptions | undefined ): DTableColumnEditing => {\n\tif( options ) {\n\t\treturn {\n\t\t\tformatter: options.formatter || utilToString,\n\t\t\tunformatter: options.unformatter || defaultEditingUnformatter,\n\t\t\tvalidator: options.validator\n\t\t};\n\t}\n\treturn {\n\t\tformatter: utilToString,\n\t\tunformatter: defaultEditingUnformatter\n\t};\n};\n\nconst toColumnMenu = ( options?: DMenuOptions<unknown> | DMenu<unknown> ): DMenu<unknown> | undefined => {\n\tif( options == null ) {\n\t\treturn undefined;\n\t} else if( options instanceof DMenu ) {\n\t\treturn options;\n\t} else {\n\t\treturn new DMenu( options );\n\t}\n};\n\nconst toColumnDialog = (\n\toptions?: DDialogSelectOptions<unknown> | DDialogSelect<unknown>\n): DDialogSelect<unknown> | undefined => {\n\tif( options == null ) {\n\t\treturn undefined;\n\t} else if( options instanceof DDialogSelect ) {\n\t\treturn options;\n\t} else {\n\t\treturn new DDialogSelect( options );\n\t}\n};\n\nconst defaultSelectingGetter: DTableSelectingGetter = ( selected: unknown ): unknown => {\n\treturn selected;\n};\n\nconst toColumnSelecting = ( options: DTableColumnSelectingOptions | undefined ): DTableColumnSelecting => {\n\tif( options ) {\n\t\treturn {\n\t\t\tgetter: options.getter || defaultSelectingGetter,\n\t\t\tmenu: toColumnMenu( options.menu ),\n\t\t\tdialog: toColumnDialog( options.dialog ),\n\t\t\tfetcher: options.fetcher\n\t\t};\n\t}\n\treturn {\n\t\tgetter: defaultSelectingGetter\n\t};\n};\n\nconst toColumn = <ROW>( options: DTableColumnOptions<ROW> ): DTableColumn<ROW> => {\n\tconst weight = ( options.weight != null ? options.weight :\n\t\t( options.width != null ? undefined : +1 )\n\t);\n\tconst width = ( weight != null ? undefined :\n\t\t( options.width != null ? options.width : 100 )\n\t);\n\tconst type = ( options.type != null ?\n\t\t( utilIsString( options.type ) ? DTableColumnType[ options.type ] : options.type ) :\n\t\tDTableColumnType.TEXT\n\t);\n\tconst align = toColumnAlign( options, type );\n\tconst editable = ( options.editable === true );\n\treturn {\n\t\tweight,\n\t\twidth,\n\t\ttype,\n\t\tlabel: options.label || \"\",\n\t\tgetter: options.getter || defaultGetter,\n\t\tsetter: options.setter || defaultSetter,\n\t\tformatter: options.formatter,\n\t\talign,\n\n\t\teditable,\n\t\tediting: toColumnEditing( options.editing ),\n\n\t\theader: options.header,\n\t\tbody: options.body,\n\n\t\tselecting: toColumnSelecting( options.selecting )\n\t};\n};\n\nconst toColumns = <ROW>( options: Array<DTableColumnOptions<ROW>> ): Array<DTableColumn<ROW>> => {\n\tconst result = [];\n\tfor( let i = 0, imax = options.length; i < imax; ++i ) {\n\t\tresult.push( toColumn( options[ i ] ) );\n\t}\n\treturn result;\n};\n\nconst toHeaderOptions = <ROW, THEME extends DThemeTableHeader>(\n\toptions: DTableHeaderOptions<ROW, THEME> | undefined,\n\tcolumns: Array<DTableColumn<ROW>>\n): DTableHeaderOptions<ROW, THEME> => {\n\tif( options != null ) {\n\t\tif( options.columns === undefined ) {\n\t\t\toptions.columns = columns;\n\t\t}\n\t\treturn options as DTableHeaderOptions<ROW, THEME>;\n\t}\n\treturn {\n\t\tcolumns\n\t};\n};\n\nconst toBodyOptions = <ROW, THEME extends DThemeTableBody>(\n\toptions: DTableBodyOptions<ROW, THEME> | undefined,\n\tcolumns: Array<DTableColumn<ROW>>,\n\tdata: ROW[] | undefined\n): DTableBodyOptions<ROW, THEME> => {\n\tif( options != null ) {\n\t\tif( options.data === undefined && data !== undefined ) {\n\t\t\toptions.data = data;\n\t\t}\n\t\tif( options.columns === undefined ) {\n\t\t\toptions.columns = columns;\n\t\t}\n\t\tif( options.height === undefined && options.weight === undefined ) {\n\t\t\toptions.weight = 1;\n\t\t}\n\t\treturn options as DTableBodyOptions<ROW, THEME>;\n\t}\n\treturn {\n\t\tcolumns,\n\t\tdata,\n\t\tweight: 1\n\t};\n};\n\nexport class DTable<\n\tROW,\n\tTHEME extends DThemeTable = DThemeTable,\n\tOPTIONS extends DTableOptions<ROW, THEME> = DTableOptions<ROW, THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _header!: DTableHeader<ROW>;\n\tprotected _body!: DTableBody<ROW>;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst columns = toColumns( options.columns );\n\n\t\tconst header = this.newHeader( options, columns );\n\t\tthis._header = header;\n\t\tthis.addChild( header );\n\n\t\tconst body = this.newBody( options, columns );\n\t\tthis._body = body;\n\t\tthis.addChild( body );\n\t}\n\n\tprotected newHeader( options: OPTIONS, columns: Array<DTableColumn<ROW>> ): DTableHeader<ROW> {\n\t\treturn new DTableHeader( toHeaderOptions( options.header, columns ) );\n\t}\n\n\tprotected newBody( options: OPTIONS, columns: Array<DTableColumn<ROW>> ): DTableBody<ROW> {\n\t\treturn new DTableBody( toBodyOptions( options.body, columns, options.data ) );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTable\";\n\t}\n\n\tget header(): DTableHeader<ROW> {\n\t\treturn this._header;\n\t}\n\n\tget body(): DTableBody<ROW> {\n\t\treturn this._body;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DTreeOptions<THEME extends DThemeTree> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeTree extends DThemeBase {\n\n}\n\nexport class DTree<\n\tTHEME extends DThemeTree = DThemeTree,\n\tOPTIONS extends DTreeOptions<THEME> = DTreeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\n\nexport class ESnapperResultScale {\n\tdistance: number;\n\tscale: Point;\n\n\tconstructor() {\n\t\tthis.distance = NaN;\n\t\tthis.scale = new Point();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const utilCeilingIndex = <V>( array: V[], value: V ): number => {\n\tlet i0 = 0;\n\tlet i1 = array.length - 1;\n\n\twhile( i0 <= i1 ) {\n\t\tconst i2 = i0 + ((i1 - i0) >> 1);\n\t\tconst v2 = array[ i2 ];\n\t\tif( value < v2 ) {\n\t\t\ti1 = i2 - 1;\n\t\t} else if( v2 < value ) {\n\t\t\ti0 = i2 + 1;\n\t\t} else {\n\t\t\treturn i2;\n\t\t}\n\t}\n\n\treturn Math.max( i0, i1 );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { utilToSvgUrl } from \"./util-to-svg-url\";\n\nexport const utilToSvgTexture = ( svg: string, resolution: number ): Texture => {\n\treturn Texture.from( utilToSvgUrl( svg ), {\n\t\tresolution\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as ui from \"./wcardinal/ui\";\n\nui.loadAll();\n\nconst global = window as any;\nglobal.wcardinal = global.wcardinal || {};\nglobal.wcardinal.ui = ui;\n"],"names":["extendStatics","d","b","Object","setPrototypeOf","__proto__","Array","p","hasOwnProperty","__extends","__","this","constructor","prototype","create","DBorderMask","DApplications","instance","result","INSTANCE","Error","getInstance","update","utilIsFunction","target","theme","options","callback","_theme","_callback","background","_color","color","_alpha","alpha","DBaseBackground","state","undefined","getBackgroundColor","onChange","getBackgroundAlpha","DCornerMask","utilIsString","toString","call","border","_width","width","_align","align","_mask","mask","DBaseBorder","getBorderColor","getBorderAlpha","getBorderWidth","getBorderAlign","getBorderMask","DBaseInteractive","utilIsNumber","corner","_radius","radius","DBaseCorner","getCornerRadius","getCornerMask","isChanged","DBaseState","outline","_offset","offset","DBaseOutline","getOutlineColor","getOutlineAlpha","getOutlineWidth","getOutlineOffset","getOutlineAlign","getOutlineMask","padding","_left","_top","_right","_bottom","left","top","right","bottom","DBasePadding","getPaddingLeft","getPaddingTop","getPaddingRight","getPaddingBottom","point","cb","scope","_point","DBasePoint","x","y","set","copyFrom","arguments","equals","texture","height","borderSize","cornerMask","_super","Float32Array","Uint16Array","_this","_height","_texture","_borderSize","_cornerMask","_isDirty","_textureId","NaN","_vertexBuffer","getBuffer","_vertices","data","_uvBuffer","_uvs","_indexBuffer","getIndex","_indices","DBaseBackgroundMeshGeometry","_updateID","iv","array","x0","x1","y0","y1","ii","indices","uvs","c","u0","u1","u2","u3","v0","v1","v2","v3","fillVertices","valid","textureId","getTextureId","vertices","x2","x3","y2","y3","textureUvs","l","r","t","w","h","ctl","TOP_LEFT","ctr","TOP_RIGHT","cbl","BOTTOM_LEFT","cbr","BOTTOM_RIGHT","ia","fillUvsCorner","fillIndices","fillUvs","MeshGeometry","MeshMaterial","DBaseBackgroundMesh","shader","geometry","renderer","_render","Mesh","borderMask","_borderMask","DBaseBorderMeshGeometry","b1","b2","uz","vz","bt","TOP","bb","BOTTOM","bl","LEFT","br","RIGHT","DBaseBorderMesh","utilToSvgUrl","svg","btoa","UtilTexturePlane","attr","realRadius","Math","max","size","realSize","toCornerBr","tl","toCornerTl","toSvg","resolution","settings","RESOLUTION","Texture","from","cache","BACKGROUND_CACHE","get","make","BACKGROUND_ATTRIBUTE","on","onUpdate","BORDER_CACHE","maskToTexture","Map","BORDER_ATTRIBUTE","base","cornerRadius","getRadius","cornerHeight","getMask","backgroundPlane","_backgroundPlane","newBackground","appendRenderable","borderWidth","getWidth","borderPlane","_borderPlane","newBorder","outlineWidth","outlineMask","outlinePlane","_outlinePlane","DBaseOutlineMesh","_lastBackgroundCornerRadius","_lastBorderCornerRadius","_lastBorderWidth","_lastOutlineCornerRadius","_lastOutlineWidth","addReflowable","DBaseReflowable","backgroundColor","getColor","backgroundAlpha","getAlpha","tint","visible","borderColor","borderAlpha","borderAlign","getAlign","borderOffset","outlineColor","outlineAlpha","outlineOffset","getOffset","outlineAlign","outlineOffsetAccumulative","DCommandFlag","DBaseStates","is","HOVERED","DRAGGING","FOCUSED","FOCUSED_IN","ACTIVE","ACTIVE_IN","DISABLED","PRESSED","READ_ONLY","INVALID","SUCCEEDED","FAILED","destination","destinationState","source","when","setState","newSourceState","isNotActive","bind","NodeType","DCommandClear","UNSTORABLE","CLEAR","DCommandRedo","DCommandUndo","isCommandStorable","command","getFlag","_position","_done","_waiting","_executing","DControllerDefaultCommand","done","waiting","length","push","next","command_1","shift","current","emit","undo","onSuccess","onFail","then","redo","isClear","isStorable","remove","cleanup","execute","i","destroy","ifrom","imax","splice","isRedoable","isUndoable","utils","EventEmitter","isFocusable","isFocusableContainer","isSelectable","DControllerDefaultFocus","focusable","isFocused","select","previous","_focused","mightBeFocusable","parent","hasState","UNFOCUSABLE","FOCUS_ROOT","includesTarget","includesTargetChildren","direction","findFocusableNext","parent_1","index","children","indexOf","found","isFocusRoot","findFocusable","findFocusablePrevious","parent_2","UtilKeyboardEvent","e","key","which","ctrlKey","shiftKey","expressionOrShortcut","event_1","expression","arrowIndex","keyExpression","substring","trim","keys","toLowerCase","split","shortcut","toUpperCase","code","charCodeAt","setShortcutKeyAndWhich","alt","ctrl","event","parts","join","handler","toShortcut","document","body","addEventListener","altKey","isActionable","preventDefault","DControllerKeyboard","element","stage","focusController","focused","getFocused","hasOnKeyDown","onKeyDown","isFocusKey","getFocusDirection","setFocused","stopImmediatePropagation","hasOnKeyUp","onKeyUp","DControllers","FOCUS","KEYBOARD","COMMAND","DOCUMENT","AutoFlag","TOKEN_MAPPING_OPERATOR","+","-","*","/","(",")","TOKEN_MAPPING_LITERAL","%","s","nodes","toToken","toParensesis","toUnary","toArithmetic","node","_node","DScalarExpression","j","jmax","operand","type","toUnaryNode","operatorA","operatorB","toArithmeticNode","tokenRegEx","tokens","matched","exec","token","tokenTypeOperator","parsedToken","parseFloat","tokenTypeLiteral","self","evaluate","DScalarFunctions","coordinate","isPosition","POSITION","CENTER","PADDING","SIZE","MAXIMIZED","scalarExpression_1","calculate","scalar_1","DLayoutClearType","scalarSet","_base","_scalarSet","_autoFlags","DCoordinateSet","scalar","position","layout","isWidthAuto","toAutoWidth","toChildrenDirty","isHeightAuto","toAutoHeight","DAlignHorizontal","DAlignVertical","DAlignWith","DThemes","DEFAULT_THEME_CLASS","defaultThemeClass","getDefaultThemeClass","UtilName","mapping","_mapping","UtilPointerEvent","interactionManager","plugins","interaction","touches","changedTouches","touch","mapPositionToPoint","clientX","clientY","touchable","isDowned_1","downX_1","downY_1","cleanup_1","interactionManager_1","off","up_1","onUp_1","up","contains","global","dx","abs","dy","threshold","CLICK_DISTANCE_THRESHOLD","isValidDistance_1","down","global_1","once","onClick","onLongClick","isDowned_2","downX_2","downY_2","timeoutId_1","cleanupTimeout_1","clearTimeout","cleanup_2","interactionManager_2","up_2","onUp_2","move_1","onMove_1","isValidDistance_2","move","global_2","originalEvent","window","setTimeout","LONG_CLICK_THRESHOLD","isDowned_3","downX_3","downY_3","clickTime_1","timeStamp","DBLCLICK_INTERVAL_THRESHOLD","item","targetOrChild","toTheme","toShortcuts","shortcuts","transform","_transform","onMove","_scale","scale","onScale","_skew","skew","onSkew","_options","_coordinateSet","_hasDirty","_isChildrenDirty","_shadow","_name","name","getType","getThemeDefault","_befores","_afters","_reflowables","_clearType","clear","getClearType","_padding","toDirtyAndUpdate","toDirty","_background","_border","_outline","_corner","initReflowable","getX","getY","getHeight","_state","NONE","_stateLocal","interactive","getInteractive","SELF","interactiveChildren","CHILDREN","name_1","_title","title","getTitle","_weight","weight","getWeight","_onShadowUpdateBound","shadow","getShadow","over","setHovered","applyTitle","out","onDown","isDirty","hasDirty","toParentHasDirty","toParentChildrenDirty","updateState","blur","_shortcuts","onShortcutBound","onShortcut","init","states","addChild","child","DBase","renderable","phase","unshift","list","reflowable","reflowables","onChildrenChange","moveChildren","oldWidth","oldHeight","widthResized","heightResized","resized","onResize","parentSize","getParentSize","getLeft","getTop","newWidth","newHeight","resizeChildren","isHovered","view","toHasDirty","onChildrenDirty","isActive","isPressed","isReadOnly","isDisabled","isDragging","isInvalid","isSucceeded","isFailed","getFocusController","recursively","isOn","oldStateLocal","newStateLocal","statesOn","statesOff","stateLocal","newState","mergeState","oldState","onStateChange","stateParent","onParentStateChange","onFocused","onBlured","onChildFocused","newStateParent","oldStateParent","setTheme","refit","onRefit","coordinateSet","hasRefitableWidth","hasRefitableHeight","resize","getRight","getBottom","isRefitable","onReflow","reflow","removeReflowable","removeRenderable","prependRenderable","onParentResize","parentWidth","parentHeight","parentPadding","paddingWidth","paddingHeight","newX","newY","onParentMove","deltas","onDownThis","findFocusableParent","worldAlpha","renderBefore","render","renderAfter","befores","before","updateTransform","afters","after","worldTransform","bounds","_bounds","work","WORK_CONTAINS_POINT","apply","addPoint","_calculateBounds","containsGlobalPoint","containsLocalPoint","applyInverse","Point","Container","DDynamicTextGeometry","text","atlas","clippingWidth","vertexBuffer","uvBuffer","indexBuffer","measureText","requiredTextSize","ceil","requiredVertexSize","requiredIndexSize","ichar","k","a","writeCharacter","advance","writeCharacterEmpty","font","character","offsetX","origin","vo","WORK","Uint32Array","char","setResult","dots","iend","inext","hasDots","iresult","istart","min","newResult","_id","_idApproved","DDynamicTextStyle","FONT","_fontFamily","fontFamily","getFontFamilly","_fontSize","fontSize","getFontSize","_fontStyle","fontStyle","_fontVariant","fontVariant","_fontWeight","fontWeight","_fontIdId","_fontId","_fontIdApproved","_fill","fill","_fillApproved","_clipping","clipping","_onChange","newFontId","ASCII_CHARACTERS","reserved","ref","life","DynamicFontAtlasCharacterOrigin","fontId","id","hex2string","metrics","TextMetrics","measureFont","ascent","descent","fontColor","_canvas","createElement","_context","_font","DynamicFontAtlasFont","_characters","_length","_unrefCount","_revision","_revisionUpdated","mipmap","MIPMAP_MODES","OFF","scaleMode","SCALE_MODES","NEAREST","add","add_","DynamicFontAtlas","characters","getAdvance","DynamicFontAtlasCharacter","targets","remove_","context","getContext","canvas","textAlign","textBaseline","lineWidth","lineCap","lineJoin","miterLimit","fillStyle","strokeStyle","cleanup_","fontHeight","toPowerOf2","sqrt","offsetY","round","baseTexture","realWidth","realHeight","save","clearRect","fillText","restore","setRealSize","updateAll","colorToAltas","forEach","destroyAll","_atlases","DynamicFontAtlases","atlases","colorToAtlas","EMPTY","_style","_isGeometryDirty","_atlas","update_","_text","_textApproved","_atlasRevisionUpdated","_clippingWidthDelta","DDynamicText","style","textApproved","fontIdApproved","fillApproved","approve","geometryWidth","newScale","geometryHeight","getRevisionUpdate","revisionUpdate","_clippingWidth","newClippingWidth","getClippingWidth","DBaseOverflowMaskSimple","beginFill","drawRect","endFill","Graphics","DTextBase","_textValue","value","newTextValue","toTextValue","_textValueComputed","computeTextValue","_textColor","_textAlpha","_textStyle","getFontWeight","getFontStyle","getFontVariant","getTextStyleClipping","toTextStyle","_textAlign","vertical","getTextAlignVertical","horizontal","getTextAlignHorizontal","toTextAlign","_textFormatter","formatter","getTextFormatter","toTextFormatter","_textDynamic","dynamic","isTextDynamic","toTextDynamic","_isOverflowMaskEnabled","isOverflowMaskEnabled","_overflowMask","onTextChange","createOrUpdateText","updateTextValue","textValue","getTextValue","formatted","createText","updateTextPosition","getOrCreateOverflowMask","Text","toRounded","MIDDLE","getTextColor","getTextAlpha","newTextValueComputed","updateTextColor","updateText","overflowMask","DImageBase","_image","_imageAlign","image","with","getImageAlignWith","getImageAlignVertical","getImageAlignHorizontal","toImageAlign","_imageMargin","margin","getImageMarginVertial","getImageMarginHorizontal","toImageMargin","_imageTint","toImageTint","_imageBound","Rectangle","_imageBoundPoint","_imageSource","_imageSourceComputed","_onImageChangeBound","onImageChange","imageSource","getImageSource","updateImageTint","getLocalBounds","localTransform","getImageRect","imageWidth","imageHeight","imageAlign","marginHorizontal","imageWaMH","setClippingWidthDelta","marginVertical","imageHaMV","imageTint","getImageTintColor","getImageTintAlpha","isTintAware","newImageSourceComputed","computeImageSource","oldImageSourceComputed","oldImage","Sprite","removeChild","newImage","updateImageSource","TEXT","updateTextAndImagePosition","updateImagePositionPadding","BORDER","updateImagePositionBorder","updateImagePositionText","imageSourceComputed","DImage","DListItem","buttonMode","_value","toValue","selection","hasSelection","getSelection","isActivateKey","onSelect","DMenuItem","getCloseable","DMenuItemText","initOnClick","initOnOver","initShortcuts","_shortcutMargin","getShortcutTextMargin","shortcutTextValue","_shortcutText","shortcutText","updateShortcutText","closeable","DMenuItemCheck","check","setActive","DMenus","creator","CREATORS","CREATOR_DEFAULT","MENU_CREATOR","creators","creatorDefault","sticky","created","newItemOf","items","DisplayObject","newItem","JSON","stringify","newItemsOf","strokeWidth","frame","DynamicAtlasItem","resolutionInverse","updateUvs","DynamicAtlasItemEmpty","DynamicAtlasItemFontAtlas","drawImage","src","DynamicAtlasItemImage","DynamicAtlasItemText","DynamicAtlasItemWhite","fillRect","_baseTexture","BaseTexture","_idToDatum","_sortedData","_predefined","empty","white","DynamicAtlas","maxRowHeight","datum","minHeight","applyFrame","sort","ITEM_COMPARATOR","idToDatum","forcibly","canvasWidth","calcCanvasWidth","canvasHeight","updateFrames","renderFrames","applyFrames","predefined","_gl","_shaderProgram","_vertexPositionAttribute","_textureCoordAttribute","_samplerUniform","_sizeUniform","_vb","_uvb","_onLostBound","_onRestoreBound","_onUnloadBound","DynamicSDFFontGenerator","isContextLost","config","antialias","depth","stencil","premultipliedAlpha","gl","clearColor","makeVertexBuffer","makeUvBuffer","makeShaders","createShader","FRAGMENT_SHADER","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","error","getShaderInfoLog","vertexShader","getShader","fragmentShader","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","deleteShader","useProgram","getAttribLocation","getUniformLocation","getError","deleteProgram","textureCanvas","viewport","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","deleteTexture","vb","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","deleteBuffer","uvb","COLOR_BUFFER_BIT","vertexPositionAttribute","enableVertexAttribArray","vertexAttribPointer","FLOAT","textureCoordAttribute","activeTexture","TEXTURE0","uniform1i","uniform2f","drawArrays","TRIANGLE_STRIP","copyCanvas","copyContext","destroyVertexBuffer","destroyUvBuffer","destroyShaders","removeEventListener","WebGLLoseContext","getExtension","loseContext","_generator","DynamicSDFFontAtlas","getGenerator","family","toFontFamily","italic","addChar","generator","characterSize","characterWidth","characterHeight","updateTexture","read","toJson","getAutoFontFamily","GENERATOR","FONT_FAMILY_AUTO","DynamicSDFFontAtlases","begin","addAscii","end","newAtlas","baseAtlas","getBaseTexture","atlasId","newInstance","Lazy","FormatNodeA","step","date","getHours","FormatNodea","FormatNodeD","String","getDate","FormatNoded","precision","FormatNodee","toExponential","FormatNodePrecision","FormatNodef","toFixed","FormatNodefsi","toAbs","format_","unitInverse","postfix","FormatNodeg","toPrecision","FormatNodeH","FormatNodeh","FormatNodeM","getMonth","FormatNodem","getMinutes","FormatNodemi","getMilliseconds","FormatNodeP","FormatNodep","utilPad","str","strLength","FormatNodePadding","format","FormatNodeParenthesis","FormatNodePlus","FormatNodeRP","FormatNoderp","Y","M","D","H","m","mi","FormatNodesdt","FormatNodeSpace","FormatNodessi","FormatNodeString","FormatNodeY","getFullYear","FormatNodey","FormatNodez","z","getTimezoneOffset","floor","FormatNoderd","FormatNodes","getSeconds","REGEXP","previousIndex","isDateRequired","lastIndex","all","modifier","toModifiedNodeDatetime2","toModifiedNodeDatetime3","toModifiedNodeNumber","Date","NumberFormatterImpl","setTime","NumberFormatters","UtilAlpha","alphaA","alphaB","Image","resources","BaseImageResource","crossOrigin","crossorigin","autoLoad","load","SVGResource","_load","Promise","resolve","onerror","onError","run","onload","extension","INSTALLED","UtilAttachAlign","ratio","_ratio","_margin","_frames","_svg","_nextX","_nextY","UtilSvgAtlasBuilder","path","frames","build","built","_built","force","pow","log","LN2","url","scaling","frames_1","DMouseModifier","UtilAttach","clippingHeight","adjust","clippingSize","UtilClickOutside","toLocal","stopPropagation","toClipboardData","UtilClipboard","clipboardData","navigator","clipboard","writeText","textArea","appendChild","focus","execCommand","ds","dt","UtilDragEasingHistory","DAnimationTimings","_target","_startTime","_duration","duration","_durationInverse","_reverse","_onTime","onTime","_onTimeBaseBound","onTimeBase","_onStart","onStart","_onEnd","onEnd","_timing","timing","ELASTIC","DAnimationBase","reverse","stop","now","time","toTime","isReverse","elapsedTime","_histories","_historiesSorted","_historyBegin","_historyEnd","_dx","_dy","_ds","_dt","_animation","onEase","LINEAR","_durationPosition","_durationScale","_onMove","UtilDragEasing","histories","HISTORY_CAPACITY","capacity","oldHistoryEnd","newHistoryEnd","oldHistoryBegin","unsorted","sorted","total","history_1","history_2","history_3","ldt","adt","updateHistoriesSorted","sortedLength","history_4","d0","d1","animation","start","UtilFileAs","DMouseModifiers","oe","CTRL","ALT","SHIFT","OR","toEasingOptions","_modifier","_interactionManager","_center","_scalingCenter","_time","easing","_easing","onEasingMove","_onDownBound","_onMoveBound","_onEndBound","_down","_move","_up","UtilDrag","center","touchesLength","first","centerX","centerY","squareDistance","match","calcCenterAndScale","setDragging","oldScale","oldTime","newTime","EPSILON","scalingCenter","UtilExtractor","skipUpdateTransform","PIXI","RenderTexture","matrix","Matrix","renderTexture","pixels","Uint8Array","readPixels","ignorePremutipliedAlpha","canvasRenderTarget","CanvasRenderTarget","imageData","getImageData","extract","Extract","arrayPostDivide","putImageData","scaledWidth","scaledHeight","scaledImageData","quality","toDataURL","UtilFileDownloader","filename","href","download","display","click","contents","blob","Blob","msSaveBlob","downloadUrl","URL","createObjectURL","UtilExtract","toResolution","toSkipUpdateTransform","toTexture","toPixels","premultiplied","ignore","toIgnorePremultipliedAlpha","toScale","toCanvas","toBase64","base64","DMenuItemLinkMenuItemId","DMenuItemLinkTarget","as","facade","_input","_as","_facade","UtilFileOpener","input","getOrCreateInput","onCancel","input_1","setAttribute","onInputChange","files","file","fileReader","FileReader","onOpen","onabort","onAboart","readAsText","DATA_URL","readAsDataURL","BINARY_STRING","readAsBinaryString","ARRAY_BUTTER","readAsArrayBuffer","UtilHsv","g","v","utilIndexOf","i0","i1","i2","utilIsArray","isArray","utilIsNaN","UtilPromise","UtilRgb","trimmed","Number","colorA","colorB","ar","ag","ab","bg","w1","w0","amount","blend","UtilRgba","UtilTexture","onLoad","utilToString","_current","_lastUpdate","_updateId","UtilTransition","updateId","lastUpdate","remaining","hide","show","_names","documentMode","UtilWheelEvent","useCapture","names","name_2","_lineHeight","getLineHeight","_pageHeight","deltaX","deltaY","detail","wheelDelta","wheelDeltaY","wheelDeltaX","axis","HORIZONTAL_AXIS","delta","_timestamp","_lowest","shouldAdjust","lowest","mode","deltaMode","getPageHeight","DLayoutDirection","_link","link","_checker","checker","_menuOptions","menu","DMenuItemLink","NEW_WINDOW","EXTENSION_0","_menu","getMenuOptions","toMenu","onMenuSelect","newMenu","OPEN_LINK_IN_NEW_WINDOW","open","COPY_LINK_ADDRESS","copy","resolved","isHidden","inNewWindow","checked","a_1","rel","location","InteractionEvent","metaKey","button","DMenuAlign","DMenuItemMenu","toggle","initHover","close","DListItemSeparatorReflowable","middle","lineStyle","moveTo","lineTo","DListItemSeparator","DMenuItemSeparator","DLayoutSpace","DMenuItemSpace","loadMenuItem","addItemCreator","isCompatible","toSubMenuOptions","setItemCreatorDefault","EShapeType","isDBaseVisible","toMultiplicity","row","column","getMultiplicity","toMargin","themeMargin","getMargin","toDirection","getDirection","toCornerAdjust","getCornerAdjust","_direction","_cornerAdjust","_multiplicity","DLayout","multiplicity","clearType","BEFORE","AFTER","baseSize","VERTICAL","marginNext","paddingTop","paddingBottom","paddingLeft","paddingRight","weightTotal","getWeightTotal","cornerAdjustWork","requiredSize","CORNER_ADJUST_WORK","irow","weightTotalInverse","spaceLeft","getSpaceLeft","icolumn1","irow1","icolumn0","findRowIndexPrevious","hasClearTypeAfter","icolumn2","findRowIndexNext","hasClearTypeBefore","ncolumn","countColumn","toCornerMaskColumn","icolumn","irow0","findColumnIndexPrevious","irow2","findColumnIndexNext","nrow","countRow","toCornerMaskRow","hasClearType","n","ALL","DLayoutVertical","DMenuItemExpandableBody","DMenuItemExpandableHeader","DMenuItemExpandables","DMenuItemExpandable","header","toHeader","_header","toBody","_body","newItems","onActivated","onDeactivated","newHeader","newBody","DMenuItemExpandableItemCheck","DMenuItemExpandableItemLink","DMenuItemExpandableItemSeparator","DMenuItemExpandableItemSpace","DMenuItemExpandableItemText","loadMenuItemExpandable","DMenuSidedItemCheck","DMenuSidedItemLink","DMenuSidedItemMenu","DMenuSidedItemSeparator","DMenuSidedItemSpace","DMenuSidedItemText","DMenuSideds","loadMenuSidedItem","DMenuSidedItemExpandables","DMenuSidedItemExpandable","DMenuSidedItemExpandableItemCheck","DMenuSidedItemExpandableItemLink","DMenuItemExpandableItemMenu","DMenuSidedItemExpandableItemMenu","DMenuSidedItemExpandableItemSeparator","DMenuSidedItemExpandableItemSpace","DMenuSidedItemExpandableItemText","loadMenuSidedItemExpandable","loadMenuItemAll","EShapeDeserializers","EShapePointsStyle","EShapeUploadeds","EShapeBarPosition","EShapePointsStyleUploadeds","nonExpandingWidth","NON_EXPANDING_WIDTH","nonShrinkingWidth","NON_SHRINKING_WIDTH","nonScalingDotAndDash","NON_SCALING_DOT_AND_DASH","NON_SOLID_MASK","DOTTED","DOTTED_DENSELY","DOTTED_LOOSELY","DASHED","DASHED_DENSELY","DASHED_LOOSELY","EShapeCorner","EShapeStrokeSide","_parent","_values","_segments","_size","_updatedSize","_updatedParentSizeX","_updatedParentSizeY","_updatedPosition","EShapeBarPoints","sizeX","sizeY","parentSizeX","parentSizeY","psxh","psyh","computedSize","getComputedSize","values","segments","newValues","newSegments","newStyle","newPosition","newSize","updateUploaded","manager","resourceId","resource","parsed","parse","EShapeCopyPart","EShapeRuntimeReset","EShapeRuntimeState","EShapeDefaults","devicePixelRatio","EShapeAction","sources","destinations","isEquals","indexA","indexB","tmp","serialize","EShapeTagValueOrder","EShapeTagValueRangeType","shape","rotation","actions","toObject","stroke","cursor","reset","written","effect","EShapeRuntime","disabled","CLICKED","CHANGED","hovered","DOWN","UP","onPointerDown","onPointerUp","onPointerClick","tag","isEffectTimeUp","disallowUploadedUpdate","allowUploadedUpdate","PERSISTENT","executeActions","resetUnwrittenProperties","POSITION_X","POSITION_Y","VISIBILITY","COLOR_FILL","COLOR_STROKE","COLOR_TEXT","COLOR_TEXT_OUTLINE","HEIGHT","WIDTH","ROTATION","CURSOR","internalTransform","EShapeTransformImpl","Transform","onTransformChange","updateSkew","_currentLocalID","_localID","_parentID","_worldID","parentTransform","oldLocalId","oldWorldId","newLocalId","newWorldId","copyTo","prepend","EShapeGradients","gradient","points","parseGradient","serialized","serializeGradient","stops","toCode","radian","PI","cos","sin","newTransform","_onTransformChangeLock","_isOnTransformChanged","action","_visible","_uploadedUpdateLock","_isUploadedUpdated","_isUploadedUpdatedRecursively","_boundsTransformId","_boundsInternalTransformId","_boundsLocalTransformId","selected","reference","EShapeBase","onTransformChange_","updateUploadedRecursively","onChildTransformChange","invokeOnTransformChange","uploaded","root","at","detach","IDENTITY","childrenSerialized","toGradientId","pivot","shortcutId","titleId","serializeImage","serializeChildren","unfocusable","sx","sy","containsAbs","containsText","containsChildren","textWorld","world","tx","ty","th","tv","childResult","shadowed","containsAbsBBox","ax","ay","skipUpdate","worldId","getWorldId","getBounds_","boundsInternal","_boundsInternal","currentLocalId","getLocalIdCurrent","boundsLocal","_boundsLocal","px","py","getBoundsSize","xmin","ymin","xmax","ymax","getState","runtime","unforcusable","onPointerDblClick","part","TRANSFORM","sourceTransform","STYLE","ACTION","addAll","POINTS","sourcePoints","clone","STATE","enable","_enable","EShapeFillImpl","stringified","fills","deserialized","side","_side","EShapeStrokeImpl","strokes","EShapeTextWeight","EShapeTextStyle","EShapeTextAlignHorizontal","EShapeTextAlignVertical","EShapeTextDirection","_type","_from","_to","EShapeTagValueRangeImpl","to","parent_3","FROM","TO","parent_4","FROM_TO","copy_","parent_5","ranges","INDEX_COMPARATOR","initial","range","_capacity","_order","ASCENDING","EShapeTagValueImpl","newValue","order","count","normalize","times","_times","parent_6","newTimes","parent_7","parent_8","parent_9","parent_10","slice","parent_11","parent_12","idSerialized","initialSerialized","formatSerialized","rangeSerialized","tagValues","deserialize","EShapeTagImpl","inherited","RANGE_DUMMY","nvalue","EMPTY_ARRAY","tags","EShapeActionValueBlinkType","_horizontal","_vertical","EShapeTextAlignImpl","aligns","EShapeTextOffsetImpl","margins","EShapeTextOutlineImpl","textOutlines","_family","NORMAL","spacing","LEFT_TO_RIGHT","EShapeTextImpl","isChangedDirty","isChangedUploaded","alignSerialized","offsetSerialized","outlineSerialized","spacingSerialized","paddingSerialized","texts","newFill","newStroke","RADIUS","newText","EShapePrimitive","ObservablePoint","onSizeChange","SIZE_X","SIZE_Y","FILL_COLOR","FILL_ALPHA","STROKE_COLOR","STROKE_ALPHA","STROKE_WIDTH","STROKE_ALIGN","STROKE_SIDE","TEXT_VALUE","TEXT_FAMILY","TEXT_SIZE","imageSrc","EShapeLineBase","container","getPixelScale","getStrokeWidthScale","swh","getStrokeWidthScaled","pointCount","pointValues","pointSegments","p0x","p0y","p1x","p1y","calcHitPosition","CLOSED","squaredDistance","d0x","d0y","d1x","d1y","t0","BAR","EShapeBar","buffer","voffset","ioffset","vcount","icount","transformLocalId","vertexOffset","vertexCount","indexOffset","indexCount","colorFill","alphaFill","colorStroke","alphaStroke","worldSizeXHalf","worldSizeYHalf","worldSizeZHalf","worldSizeWHalf","worldSizeR","strokeAlign","strokeSide","textureTransformId","EShapeUploadedBase","getLocalId","WHITE","textureAny","colors","rgba","premultiplyTintToRgba","workColor","isEnabled","colorFillBuffer","fillColor","colorFills","colorStrokeBuffer","colorStrokes","updateColorFill","updateColorStroke","antialiasWeight","ANTIALIAS_WEIGHT","dpc0","pc0","pc1","swc","pc","swx","swy","px0","py0","px1","py1","steps","antialiases","clippings","cx","cy","dx01","dy01","builder","EShapeTextUploadeds","tvcount","ticount","textSize","textFamily","textTexture","textTextureTransformId","textColor","textAlpha","textWeight","textStyle","textAlignHorizontal","textAlignVertical","textOffsetHorizontal","textOffsetVertical","textOutlineWidth","textOutlineColor","textOutlineAlpha","textSpacingHorizontal","textSpacingVertical","textDirection","textPaddingHorizontal","textPaddingVertical","textClipping","textVertexCount","textIndexCount","EShapeTextUploaded","getTextCount","workCount","updateColorFillAndStroke","halign","valign","hoffset","hpadding","vpadding","hnx","hny","vnx","vny","OUTSIDE_TOP","OUTSIDE_BOTTOM","OUTSIDE_LEFT","OUTSIDE_RIGHT","defx","defy","li","textAtlas","toTextureTransformId","isCharChanged","isCharSizeChanged","isCharStyleChanged","isCharAlignChanged","isCharOffsetChanged","isCharSpacingChanged","isCharDirectionChanged","isClippingChanged","isTextureChanged","hl","calcLength","vl","heightChar","lineHeight","textAtlasCharacters","toAdvance","tx0","ty0","lineWidthMaximum","getTextBBox","TOP_TO_BOTTOM","rotateAlignVerticalRight","rotateAlignHorizontalRight","BOTTOM_TO_TOP","rotateAlignVerticalLeft","rotateAlignHorizontalLeft","dwidth","toTextureUvs","uvx0","uvx1","uvx3","uvy0","uvy1","uvy3","duvx01","duvy01","duvx03","duvy03","lhx","lhy","snx","sny","oyx","oyy","offsetItalic","bx0","by0","bx3","by3","cx0","cy0","cx3","cy3","lineCount","textValueLength","dotsAdvance","adjustTextAlignment","dataOffsetX","dataWidth","dx0","dy0","dx1","dy1","dux0","duy0","dux1","duy1","dvx0","dvy0","dvx1","dvy1","vertexIndex","textCount","nx","ny","moveText","moveTextHalf","moveTextFull","textOutline","stepBuffer","antialiasBuffer","updateTextVertex","updateTextColorFill","updateTextColorStroke","updateTextStep","clippingBuffer","buildUnit","textBaseTexture","pointsId","pointsStyle","EShapeBarUploaded","ic","initText","isSizeChanged","isStrokeWidthChanged","toTransformLocalId","isTransformChanged","isPointsIdChanged","isPointsStyleChanged","updateLineVertexStepAndColorFill","updateColor","updateBarUv","pointsSize","scaleInvariant","toScaleInvariant","p2x","p2y","p3x","p3y","toDash","dash0","dash1","iuv","EShapeBarUploadeds","tcount","vertexCapacity","indexCapacity","EShapeActionBases","EShapeActionRuntime","def","defLiteral","Function","parameter1","parameter2","application","conditionDefault","condition","toExpression","interval","EShapeActionRuntimeBlink","dinterval","elapsed","toOff","toOn","EShapeActionRuntimeConditional","COLOR","EShapeActionRuntimeBlinkBrighten","toBaseFill","brighten","toBaseStroke","toBaseText","toBaseTextOutline","EShapeActionRuntimeBlinkColorFill","EShapeActionRuntimeBlinkColorStroke","EShapeActionRuntimeBlinkDarken","darken","COLOR_FILL_AND_STROKE","EShapeActionRuntimeBlinkOpacity","EShapeActionRuntimeBlinkVisibility","EShapeActionValueType","EShapeActionValueBase","toLabel","subtype","EShapeActionValueSubtyped","EShapeActionValueChangeColorType","EShapeActionValueChangeColorTarget","EShapeActionValues","BLINK","EShapeActionValueBlink","BRIGHTEN","DARKEN","OPACITY","conditionId","toResource","EShapeActionValueChangeTextType","blendDefault","ALPHA","EShapeActionRuntimeChangeColor","baseFill","baseStroke","baseText","baseOutline","EShapeActionRuntimeChangeColorAll","setAll","EShapeActionRuntimeChangeColorFill","EShapeActionRuntimeChangeColorFillAndStroke","sets","EShapeActionRuntimeChangeColorStroke","EShapeActionRuntimeChangeColorText","EShapeActionRuntimeChangeColorTextOutline","CHANGE_COLOR","EShapeActionValueChangeColor","FILL","STROKE","FILL_AND_STROKE","TEXT_OUTLINE","blendId","brightnessDefault","brightness","EShapeActionRuntimeChangeColorBrightness","toColorAdjusted","EShapeActionRuntimeChangeColorBrightnessAll","EShapeActionRuntimeChangeColorBrightnessFill","EShapeActionRuntimeChangeColorBrightnessFillAndStroke","EShapeActionRuntimeChangeColorBrightnessStroke","EShapeActionRuntimeChangeColorBrightnessText","EShapeActionRuntimeChangeColorBrightnessTextOutline","EShapeActionValueChangeColorBrightness","BRIGHTNESS","brightnessId","colorDefault","alphaDefault","EShapeActionRuntimeChangeColorCode","EShapeActionRuntimeChangeColorCodeAll","EShapeActionRuntimeChangeColorCodeFill","EShapeActionRuntimeChangeColorCodeFillAndStroke","EShapeActionRuntimeChangeColorCodeStroke","EShapeActionRuntimeChangeColorCodeText","EShapeActionRuntimeChangeColorCodeTextOutline","EShapeActionValueChangeColorCode","CODE","colorId","alphaId","nameDefault","EShapeActionRuntimeChangeCursor","CHANGE_CURSOR","EShapeActionValueChangeCursor","nameId","numberDefault","number","EShapeActionRuntimeChangeTextNumber","textDefault","EShapeActionRuntimeChangeTextText","EShapeActionValueMiscType","CHANGE_TEXT","EShapeActionValueChangeText","NUMBER","valueId","EShapeActionRuntimeEmitEvent","EMIT_EVENT","EShapeActionValueEmitEvent","rect","_onInputKeyDownBound","onInputKeyDown","_onInputBlurBound","onInputBlur","_updateInputBound","updateInput","_onInputChangeBound","_onInputInputBound","onInputInput","_updateInputBoundRenderer","EShapeActionRuntimeMiscInputData","getRootElement","createInput","getInputType","getInputStyle","readonly","removeAttribute","paddingHorizontal","getInputStylePosition","getInputStyleMargin","getInputStyleText","getInputStyleBackground","getInputStyleBorder","getInputStylePadding","getInputStyleOutline","isOkKey","HTMLInputElement","onInput","newShape","oldShape","app","getInput","initInput","updateInputBound","EShapeActionRuntimeMiscInput","data_1","getData","isShown","_","EShapeActionValueOpenType","MISC","EShapeActionValueMisc","INPUT","targetDefault","EShapeActionRuntimeOpenFlow","opener","EShapeActionRuntimeOpen","EShapeActionRuntimeOpenPage","EShapeActionRuntimeOpenPageInplace","EShapeActionValueShowHideType","OPEN","EShapeActionValueOpen","FLOW","PAGE","PAGE_INPLACE","targetId","EShapeActionValueTransformMoveType","EShapeActionValueTransformType","visibility","SHOW","EShapeActionRuntimeShowHide","SHOW_HIDE","EShapeActionValueShowHide","amountDefault","EShapeActionRuntimeTransformMoveAbsoluteX","EShapeActionRuntimeTransformMove","EShapeActionRuntimeTransformMoveAbsoluteY","EShapeActionRuntimeTransformMoveForwardOrBackward","writtenPositionX","writtenPositionY","oldPositionX","oldPositionY","EShapeActionRuntimeTransformMoveLeftOrRight","EShapeActionRuntimeTransformMoveRelativeX","EShapeActionRuntimeTransformMoveRelativeY","opetype","EShapeActionValueOpetyped","EShapeActionValueTransformResizeType","MOVE","EShapeActionValueTransformMove","ABSOLUTE_X","ABSOLUTE_Y","FORWARD_OR_BACKWARD","LEFT_OR_RIGHT","RELATIVE_X","RELATIVE_Y","amountId","EShapeSizes","centerMode","isPerfect","hsize","toNormalized","EShapeActionValueTransformRotateType","sizeRelativeDefault","sizeAbsoluteDefault","RELATIVE_SIZE","ABSOLUTE_SIZE","RELATIVE_HEIGHT","ABSOLUTE_HEIGHT","RELATIVE_WIDTH","ABSOLUTE_WIDTH","EShapeActionRuntimeTransformResize","dsx","dsy","originX","originY","EShapeActionRuntimeTransformResizeHeightAbsolute","sizeAbsolute","oldSizeY","adjustPosition","EShapeActionRuntimeTransformResizeHeightRelative","sizeRelative","EShapeActionRuntimeTransformResizeSizeAbsolute","writtenWidth","writtenHeight","oldSizeX","EShapeActionRuntimeTransformResizeSizeRelative","EShapeActionRuntimeTransformResizeWidthAbsolute","EShapeActionRuntimeTransformResizeWidthRelative","RESIZE","EShapeActionValueTransformResize","EShapeActionRuntimeTransformRotate","oldRotation","newRotation","EShapeActionRuntimeTransformRotateAbsolute","EShapeActionRuntimeTransformRotateRelative","EShapeCapability","ROTATE","EShapeActionValueTransformRotate","ABSOLUTE","RELATIVE","EShapeActionValueDeserializer","toSerialized","COLOR_AND_ALPHA","EShapeImageElements","dataUrl","imageElements","cachedImageElement","HTMLImageElement","reject","imageElement","extensions","EShapeDeserializer","shapeDeserializer","childrenPromise","childrenOrPromises","childSerialized","childOrPromise","toShape","serializedActions","gradientId","deserializeGradient","imagePromise","imageId","toImageElement","serializeds","EShapeResourceManagerDeserialization","shapes","EShapeBars","loadShapeBar","EShapeCircleUploaded","updateType0Vertex","updateType0Step","updateType0Uv","isStrokeChanged","x4","y4","x7","y7","workStep","calcStep","updateStep","EShapeCircleUploadeds","CIRCLE","EShapeCircle","ay2","ax2","wx","wy","wx2","wy2","EShapeCircles","loadShapeCircle","EShapeGroupUploaded","EShapeGroupUploadeds","EShapeGroupFillEditor","EShapeGroupPoints","toPoints","internalTransformParentInverse","EShapeTransforms","editor","EShapeEditor","invert","identity","disallowOnTransformChange","allowOnTransformChange","keepSize","newLocalTransform","append","applyLocal","bx","by","rx","atan2","ry","shapeBase","EShapeGroupSizeLayout","baseX","baseY","pivotX","pivotY","childBase","WORK_TRANSFORM","translate","_layouts","EShapeGroupSizeEditor","ox","oy","calcRect","_workRectForFit","layouts","workPoint","_workPoint","workRect","_workRectForCalcRect","getBoundsLocal","enlarge","onChange_","newLayout","EShapeGroupSizeViewer","EShapeGroupStrokeEditor","EShapeGroupTextAlignEditor","EShapeGroupTextOffsetEditor","EShapeGroupTextOutlineEditor","EShapeGroupTextPaddingEditor","EShapeGroupTextSpacingEditor","EShapeGroupTextEditor","GROUP","newGroupSize","newGroupFill","newGroupStroke","newGroupText","newGroupPoints","EShapeGroup","IS_EDIT_MODE","result_1","fit","_points","EShapeGroups","loadShapeGroup","EShapeGroupSizeShadowed","GROUP_SHADOWED","EShapeGroupShadowed","EShapeGroupShadoweds","loadShapeGroupShadowed","RECTANGLE","EShapeRectangle","TOP_OR_LEFT","BOTTOM_OR_LEFT","TOP_OR_RIGHT","BOTTOM_OR_RIGHT","IMAGE","EShapeImage","EShapeImages","EShapeRectangleUploaded","x10","y10","swt","pt0","swr","pr0","swb","pb0","swl","pl0","pm0","x02","y02","EShapeRectangleUploadeds","loadShapeImage","EShapeLabelUploaded","updateLabelVertex","updateLabelUv","EShapeLabelUploadeds","LABEL","EShapeLabel","EShapeLabels","loadShapeLabel","pointsClosed","pointId","EShapeLineUploaded","io","isPointChanged","updateLineUv","closed","lprev","lnext","llop","llo","lmax","pprevx","pprevy","pnextx","pnexty","pseg","psegnext","icfprev","loffset","pfirstx","pfirsty","psegfirst","plastx","plasty","pseglast","psecondx","psecondy","psegsecond","nextIndex","pnextxn","pnextyn","loffsetprev","dx32","dy32","closed_1","icf","lengthInverse","EShapeLineUploadeds","minX","maxX","minY","maxY","pointsLength","_valuesBase","_valuesBaseLength","_sizeBase","EShapeLinePoints","ssx","ssy","sizeBase","hasSizeBaseX","hasSizeBaseY","scaleX","scaleY","valuesBase","fitToParentSize","isUpdated","valuesBaseLength","newValuesLength","iupdate","newSegmentsLength","oldStyle","lineOrPoints","LINE","EShapeLine","EShapeLines","loadShapeLine","EShapeNullUploaded","EShapeNullUploadeds","NULL","EShapeNull","EShapeNulls","loadShapeNull","EShapeCapabilities","mappings","PRIMITIVE","capability","EShapeRectangles","loadShapeRectangle","EShapeRectangleRoundedUploaded","updateType1Vertex","updateType1Clipping","updateType1Step","updateType1Uv","dxh","dyh","dxhr","dyhr","x11","y11","dxv","dyv","dxvr","dyvr","x5","y5","x6","y6","x9","y9","x8","y8","x12","y12","x20","y20","x15","y15","x13","y13","x14","y14","x17","y17","x16","y16","x18","y18","x19","y19","x22","y22","x21","y21","rxc","ryc","swtc","ptc0","swrc","prc0","swbc","pbc0","swlc","plc0","plr0","ptb0","ruvx","ruvy","EShapeRectangleRoundedUploadeds","RECTANGLE_ROUNDED","EShapeRectangleRounded","by1","bx1","containsAbs_","wr","hasLeftSide","hasTopSide","hasBottomSide","hasRightSide","EShapeRectangleRoundeds","loadShapeRectangleRounded","BORDER_RADIUS","EShapeTriangleUploaded","updateTriangleVertex","updateTriangleStep","updateTriangleUv","sw","xb","yb","EShapeTriangleUploadeds","TRIANGLE","EShapeTriangle","ay1","aw","EShapeTriangles","loadShapeTriangle","EShapeTriangleRoundedUploaded","updateTriangleRoundedVertex","updateTriangleRoundedClipping","updateTriangleRoundedStep","updateTriangleRoundedUv","isRadiusChanged","sz","rz","dx14","dy14","dx47r","dy47r","dx71","dy71","wsr","pr1","updateStepIf","EShapeTriangleRoundedUploadeds","TRIANGLE_ROUNDED","EShapeTriangleRounded","r12","r13","xl","yl","ni","nlx","nly","nrx","nry","det","deti","xc","yc","containsCorner_","az","c0","c1","c2","containsCorner","EShapeTriangleRoundeds","loadShapeTriangleRounded","loadShapeAll","DThemeWhiteAtlas","_instances","DThemeWhite","klass","_classes","themeClass","loadThemeWhite","setDefaultThemeClass","_offsetX","_offsetY","onTextureUpdate","DShadowImpl","leftWidth","topHeight","rightWidth","bottomHeight","NineSlicePlane","DThemeWhiteConstants","DThemeWhiteFont","newShadow","opacity","stdDeviation","DThemeWhiteBase","HIGHLIGHT_COLOR","shadow_weak","loadThemeWhiteBase","DThemeWhiteBoard","BACKGROUND_COLOR","BOTH","loadThemeWhiteBoard","DThemeWhiteTextBase","DThemeWhiteImageBase","DThemeWhiteButtonBase","COLOR_PRESSED","COLOR_HOVERED","loadThemeWhiteButton","DThemeWhiteButton","DThemeWhiteButtonAmbient","WEAK_HIGHLIGHT_COLOR","WEAK_HIGHLIGHT_ALPHA","loadThemeWhiteButtonAmbient","DThemeWhiteButtonCheck","IMAGE_TINT_COLOR_FOCUSED","button_check_mark_on","button_check_mark_off","loadThemeWhiteButtonCheck","DThemeWhiteButtonCheckRight","loadThemeWhiteButtonCheckRight","DDialogCloseOn","colorAndAlpha","DThemeWhiteButtonColor","button_color_sample","_shiftX","_shiftY","_onPrerenderBound","onPrerender","_onPostrenderBound","onPostrender","DAnimationFadeIn","_storedTime","_storedTarget","disallowUpdate","allowUpdate","storedTime","unsafe","_storedX","_storedY","_storedAlpha","DDialog","_focusable","_isOpened","onAnimationEnd","_closeOn","closeOn","CLICK_OUTSIDE","onCloseOn","firstFocusable","onClose","ESC","isCancelKey","DThemeWhiteDialog","DThemeWhiteDialogCommand","DThemeWhiteDialogColor","makeCheckerboard","iheight","DThemeWhitePickerColor","picker_color_main","picker_color_pointer","picker_color_base","picker_color_base_pointer","getMainPointerAlpha","getBaseHeight","getBaseMargin","picker_color_alpha","picker_color_alpha_checkerboard","getBasePointerTexture","getBasePointerColor","getRecentColorWidth","getRecentMargin","picker_color_recent_checkerboard","picker_color_recent_null","getSampleWidth","picker_color_sample_checkerboard","picker_color_sample_null","loadThemeWhitePickerColor","loadThemeWhiteDialogColor","loadThemeWhiteButtonColor","_selected","DPickerColorGradientPoint","POINT_SORTER","_onChangeBound","second","_workColor","DPickerColorGradientData","isSelectionChanged","span","rgb0","hex2rgb","r0","g0","b0","rgb1","r1","g1","rgb","rgb2hex","oldDirection","oldSelected","pointsCopy","pointLike","DPickerDatetimeMask","DThemeWhiteButtonColorGradient","button_color_gradient_sample","DThemeWhiteDialogColorGradient","DThemeWhitePickerColorGradient","picker_color_anchor","picker_color_anchor_outlined","picker_color_anchor_outline","picker_color_direction","loadThemeWhitePickerColorGradient","loadThemeWhiteDialogColorGradient","loadThemeWhiteButtonColorGradient","DThemeWhiteButtonDanger","loadThemeWhiteButtonDanger","DPickerDates","DThemeWhiteButtonDate","DThemeWhiteDialogDate","DThemeWhitePickerTime","HOURS","MINUTES","MONTH_LABELS","DAY_LABELS","defaultLabelFormatter","defaultDateDecorator","DThemeWhitePickerDatetime","DATE","DThemeWhitePickerDate","DThemeWhitePickerDatetimeButtonBack","picker_date_back","DThemeWhitePickerDatetimeButtonDate","DThemeWhitePickerDatetimeButtonNext","picker_date_next","DThemeWhiteText","DThemeWhitePickerDatetimeLabel","DThemeWhitePickerDatetimeLabelDate","DThemeWhitePickerDatetimeSpace","loadThemeWhitePickerTime","loadThemeWhitePickerDatetime","loadThemeWhitePickerDate","loadThemeWhiteDialogDate","loadThemeWhiteButtonDate","DPickerTimes","SECONDS","DPickerDatetimes","hms","caller","getDatetimeMask","DThemeWhiteButtonDatetime","DThemeWhiteDialogDatetime","loadThemeWhiteDialogDatetime","loadThemeWhiteButtonDatetime","loadThemeWhiteButtonFile","DThemeWhiteButtonFile","DThemeWhiteButtonPrimary","loadThemeWhiteButtonPrimary","DDragMode","DThemeWhiteButtonRadio","button_radio_mark_on","button_radio_mark_off","loadThemeWhiteButtonRadio","DThemeWhiteButtonRadioRight","loadThemeWhiteButtonRadioRight","loadThemeWhiteButtonSecondary","DThemeWhiteButtonSecondary","DThemeWhiteButtonTime","DThemeWhiteDialogTime","loadThemeWhiteDialogTime","loadThemeWhiteButtonTime","loadThemeWhiteButtonAll","DThemeWhiteCanvas","DChartAxisPosition","DChartAxisTickPosition","DThemeWhiteCanvasContainer","NOT_NONE","ON","loadThemeWhiteCanvasContainer","EShapeGroupFillViewer","EShapeGroupStrokeViewer","EShapeGroupTextAlignViewer","EShapeGroupTextOffsetViewer","EShapeGroupTextOutlineViewer","EShapeGroupTextPaddingViewer","EShapeGroupTextSpacingViewer","EShapeGroupTextViewer","units","EShapeBufferUnitBuilder","unit","EShapeBufferUnit","ntriangles","nindices","nvertices","Buffer","isIndicesShort","EShapeBufferCount","Geometry","addIndex","addAttribute","EShapeBuffer","unitCount","DRAW_MODES","TRIANGLES","unit0","unit1","ioffset0","ioffset1","uniforms","sampler","draw","vindex","iindex","getVertexOffset","getIndexOffset","iterator","getVertexCount","getIndexCount","creater","DUMMY_SHAPES","EShapeRendererIteratorDatum","_index","_datum","_data","EShapeRendererIterator","datumIndex","newDatum","_shader","Shader","_iterator","_bufferSize","_bufferSizeMax","getBufferSizeMax","EShapeRenderer","webGLVersion","uint32ElementIndex","fontAtlases","defaultTexture","textureItem","newTextureItem","updateAtlas","updateAtlases","fontAtlas","updateFontAtlas","updateFontAtlases","buffers","getDefaultTexture","repack","updateBuffers","pixelScale","translationMatrix","toArray","setBlendMode","correctBlendMode","BLEND_MODES","bufferSize","bufferSizeMax","ib","ibmax","increaseBufferSize","jb","getBufferSize","ObjectRenderer","_childrenId","_childrenIdRendered","_fontAtlases","_pixelScale","_pixelScaleId","_work","_buffers","EShapeContainer","childrenId","childrenIdRendered","shapeRenderer","SHAPE_RENDERER","batch","setObjectRenderer","render_","worldID","childLocal","containsBBox","EShapeSearch","toDepth","isParent","shapeParent","findChildById","findChildByType","matcher","findChild","findChildrenByType","findChildren","EShapeDeleter","generateListOfDetachedShapes","COMPARATOR_INDEX","resourceToIndex","EShapeResourceManagerSerialization","EShapeRuntimes","DThemeWhiteChartAxisBase","OUTSIDE","DThemeWhiteChartAxisY","DThemeWhiteChartCoordinateLinear","DThemeWhiteDiagramBase","DThemeWhiteDiagramCanvasBase","loadThemeWhiteDiagram","DThemeWhiteDiagram","DThemeWhiteDiagramCanvas","DThemeWhiteDiagramEditor","EThemeWhiteShapeActionValue","toOpetypedLabel","toSubtypedLabel","toTypedLabel","toTypeLabel","toConditionLabel","typeLabel","toShowHideTypeLabel","toBlinkTypeLabel","toChangeColorTypeLabel","toMiscTypeLabel","subtypeLabel","toTransformTypeLabel","toTransformRotateTypeLabel","toTransformMoveTypeLabel","toTransformResizeTypeLabel","HIDE","loadThemeWhiteShapeActionValue","loadThemeWhiteDiagramEditor","DThemeWhiteDiagramCanvasEditor","loadThemeWhiteDialog","loadThemeWhiteDialogCommand","DThemeWhiteDialogConfirm","DThemeWhiteDialogConfirmMessage","DThemeWhiteImage","loadThemeWhiteDialogConfirm","DThemeWhiteDialogConfirmDelete","loadThemeWhiteDialogConfirmDelete","DThemeWhiteDialogConfirmDiscard","loadThemeWhiteDialogConfirmDiscard","DThemeWhiteDialogInputText","loadThemeWhiteDialogInputText","DThemeWhiteDialogMessage","loadThemeWhiteDialogMessage","message","DThemeWhiteDialogProcessing","DThemeWhiteDialogProcessingMessage","loadThemeWhiteDialogProcessing","DThemeWhiteDialogSaveAs","loadThemeWhiteDialogSaveAs","DThemeWhiteDialogSelect","DThemeWhitePane","TOUCH","DThemeWhiteList","DThemeWhiteDialogSelectList","DThemeWhiteListItem","HIGHLIGHT_ALPHA","DThemeWhiteDialogSelectListItem","loadThemeWhiteDialogSelect","loadThemeWhiteDialogAll","DThemeWhiteDropdown","dropdown_mark","DThemeWhiteLayout","DThemeWhiteLayoutVertical","DThemeWhiteMenu","newShadowWeak","DThemeWhiteMenuItem","DThemeWhiteMenuItemText","DThemeWhiteMenuItemCheck","menu_item_mark_check_active","menu_item_mark_check_inactive","DThemeWhiteMenuItemExpandable","DThemeWhiteMenuItemExpandableBody","DThemeWhiteMenuItemExpandableHeader","isActiveIn","menu_item_expandable_header_opened","menu_item_expandable_header_closed","DThemeWhiteMenuItemExpandableItemCheck","DThemeWhiteMenuItemLink","menu_item_mark_link","getOpenLinkInNewWindow","getCopyLinkAddress","DThemeWhiteMenuItemExpandableItemLink","DThemeWhiteMenuItemMenu","menu_item_mark_next","DThemeWhiteMenuItemExpandableItemMenu","DThemeWhiteListItemSeparator","DThemeWhiteMenuItemExpandableItemSeparator","DThemeWhiteMenuItemSeparator","DThemeWhiteLayoutSpace","DThemeWhiteMenuItemExpandableItemSpace","DThemeWhiteMenuItemSpace","DThemeWhiteMenuItemExpandableItemText","loadThemeWhiteMenu","loadThemeWhiteDropdown","DThemeWhiteExpandable","ESnapperTargetValueType","DThemeWhiteExpandableHeader","loadThemeWhiteExpandable","loadThemeWhiteImage","DThemeWhiteLayoutHorizontal","HORIZONTAL","DThemeWhiteInputAndLabel","loadThemeWhiteInputAndLabel","editingValidator","editingUnformatter","DThemeWhiteInput","INVALID_COLOR","DThemeWhiteInputNumber","parseInt","DThemeWhiteInputInteger","loadThemeWhiteInputInteger","DThemeWhiteInputLabel","loadThemeWhiteInputLabel","DThemeWhiteInputReal","loadThemeWhiteInputReal","DThemeWhiteInputText","loadThemeWhiteInputText","loadThemeWhiteInputAll","loadThemeWhiteLayout","loadThemeWhiteList","DThemeWhiteMenuBar","DThemeWhiteMenuBarItem","loadThemeWhiteMenuBar","DThemeWhiteMenuSided","DThemeWhiteMenuSidedContent","loadThemeWhiteMenuSided","DThemeWhiteMenuSidedItemCheck","DThemeWhiteMenuSidedItemLink","DThemeWhiteMenuSidedItemMenu","DThemeWhiteMenuSidedItemSeparator","DThemeWhiteMenuSidedItemSpace","DThemeWhiteMenuSidedItemText","DThemeWhiteMenuSidedItemExpandable","DThemeWhiteMenuSidedItemExpandableItemCheck","DThemeWhiteMenuSidedItemExpandableItemLink","DThemeWhiteMenuSidedItemExpandableItemMenu","DThemeWhiteMenuSidedItemExpandableItemSeparator","DThemeWhiteMenuSidedItemExpandableItemSpace","DThemeWhiteMenuSidedItemExpandableItemText","DThemeWhiteNote","loadThemeWhiteNote","DThemeWhiteContent","DThemeWhiteScrollBar","DThemeWhiteScrollBarThumb","loadThemeWhiteScrollBar","loadThemeWhitePane","loadThemeWhiteSelect","DThemeWhiteSelect","DThemeWhiteTable","DThemeWhiteTableBody","DThemeWhiteTableBodyCells","TOP_BOTTOM","DThemeWhiteTableBodyCellCheck","DThemeWhiteTableBodyCellColor","DThemeWhiteTableBodyCellDate","DThemeWhiteTableBodyCellDatetime","DThemeWhiteTableBodyCellIndex","DThemeWhiteTableBodyCellInputInteger","DThemeWhiteTableBodyCellInputReal","DThemeWhiteTableBodyCellInputText","DThemeWhiteTableBodyCellSelectDialog","DThemeWhiteTableBodyCellSelectFetcher","DThemeWhiteTableBodyCellSelectMenu","DThemeWhiteTableBodyCellText","DThemeWhiteTableBodyCellTime","DThemeWhiteTableRow","DThemeWhiteTableBodyRow","DThemeWhiteTableBodyRowEven","HIGHLIGHT_BLENDED","WEAK_HIGHLIGHT_BLENDED","DThemeWhiteTableBodyRowOdd","DThemeWhiteTableHeader","DThemeWhiteTableHeaderCell","loadThemeWhiteTable","loadThemeWhiteText","loadThemeWhiteAll","DThemeWhiteChart","DThemeWhiteChartAxisX","loadAll","_isEnabled","ESnapperGrid","disable","distance","ESnapperResult","snapped","newDistance","oldDistance","ESnapperModifierAnchor","ESnapperTargetValue","_isVisible","ESnapperTarget","valueA","_normals","_lengths","_workScale","_workSnapResultX","_workSnapResultY","_workScaleResult","_workTranslate","_workSnapRectangle","_workSnap","grid","ESnapper","prepare","snap","workTranslate","newDx","newDy","baseRotation","deltaRotation","gridSize","getGridSizeRotation","newRotationDegree","toDegree","newRotationDegreeResidual","toRadian","p0","p1","anchor","normals","lengths","calcNormalizedVector","TOP_CENTER","MIDDLE_LEFT","MIDDLE_RIGHT","BOTTOM_CENTER","normal","mx","setScaleSnappedResult","my","calcScaleSnapped1D","detA","mdx","mdy","pointO","pointX","pointY","calcScaleSnapped2D","calcScaleSnappedX","calcScaleSnappedY","keepRatio","calcScaleSnappedXY","_isStarted","DAnimationEmpty","DApplicationPadding","bbox","_root","getBoundingClientRect","_pixi","autoStart","DApplicationOptions","updateWidthAndHeight","pixi","ROUND_PIXELS","Renderer","__plugins","accessibility","DChartCoordinateDirection","isDblClickable","onDblClick","isWheelable","onWheel","getPixiApplicationOptions","setInstace","_isUpdateAllowed","_refitLimit","_reflowLimit","_renderBound","_renderId","rootElement","insertBefore","overflow","hasFocus","onBlurBound","getKeyboardController","getPadding","wheelGlobal","wheelEventUtil","wheelEvent","toGlobal","hitTest","DApplication","requestAnimationFrame","oldRenderId","onRendering","newRenderId","screen","ilimit","limit","isChildrenDirty","Application","DBoard","DButtonBase","_isToggle","isToggle","_onActiveUpBound","setPressed","_onActiveUpBoundTarget","setActiveHandlers","group","onToggleStart","onToggleEnd","onActivateKeyDown","onActivateKeyUp","DButton","DButtonAmbient","DButtonCheck","DButtonCheckRight","DButtonPrimary","DLayoutHorizontal","DDialogCommand","getLayoutX","getLayoutY","getLayoutWidth","getLayoutHeight","onInit","ok","getOk","cancel","getCancel","buttonLayout","_buttonLayout","_buttonCancel","active","_buttonOk","onOk","_promise","_resolve","_reject","DInput","_editingValidationResult","_editingValidator","editing","validator","getEditingValidator","_isInputShown","_inputRect","_isInputSelected","_clipperRect","_description","description","_editingFormatter","getEditingFormatter","_editingUnformatter","unformatter","getEditingUnformatter","_onPreRenderBound","onPreRender","validate","setInvalid","editingValidationResult","start_","clipper","getClipper","inputRect","getInputRect","clipperRect","getClipperRect","scrollTop","scrollLeft","getClipperStyle","resetSelection","_clipper","containsPoint","mouse","setSelectionRange","createClipper","getClipperStylePosition","oldValue","onTextValueChange","worldVisible","DInputNumber","_step","getStep","toStep","_min","getMin","toMin","_max","getMax","toMax","updateInputStep","updateInputMin","updateInputMax","valueAsString","initInputStep","initInputMin","initInputMax","DInputReal","DText","DInputLabel","_label","label","space","DInputAndLabel","DInputRealAndLabel","DInputText","DInputTextAndLabel","onColorChange","onAlphaChange","_colorAndAlpha","_onColorChange","_onAlphaChange","DPickerColorAndAlpha","recents","_recents","DPickerColorRecent","recent","DPickerColor","_currentPicker","_newPicker","_recent","_new","setColorNew","setAlphaNew","setColorCurrent","setAlphaCurrent","_pointerPoint","mainWidth","getMainWidth","mainHeight","getMainHeight","mainBaseSprite","_mainBaseSprite","mainSprite","_mainSprite","getMainTexture","_onMainMoveBound","onMainMove","_onMainUpBound","onMainUp","onMainDown","baseSprite","_baseSprite","_onBaseMoveBound","onBaseMove","_onBaseUpBound","onBaseUp","onBaseDown","alphaCheckerboardSprite","_alphaCheckerboardSprite","getAlphaCheckerboardTexture","alphaSprite","getAlphaTexture","_onAlphaMoveBound","onAlphaMove","_onAlphaUpBound","onAlphaUp","onAlphaDown","mainPointerSprite","_mainPointerSprite","getMainPointerTexture","getMainPointerColor","alphaPointerSprite","_alphaPointerSprite","getAlphaPointerTexture","getAlphaPointerColor","getAlphaPointerAlpha","basePointerSprite","_basePointerSprite","getBasePointerAlpha","_recentColorSprites","recentColorSprites","recentColorCount","getRecentColorCount","recentColorWidth","recentColorHeight","getRecentColorHeight","recentColorWidthHalf","recentColorHeightHalf","recentColorMargin","getRecentColorMargin","recentColorY","getAlphaHeight","recentCheckerboardTexture","getRecentCheckerboardTexture","RECENT_COLORS","getRecents","onRecentChange","onRecentClick","checkerboardSprite","currentTarget","sprite","recentColorAndAlpha","inputMargin","getInputMargin","inputY","inputWidth","inputAndLabelColor","_inputAndLabelColor","getInputLabelWidth","fromCode","inputAndLabelAlpha","_inputAndLabelAlpha","sampleWidth","sampleHeight","getSampleHeight","sampleX","sampleY","sampleCurrentCheckerboardSprite","_sampleCurrentCheckerboardSprite","getSampleCheckerboardTexture","sampleCurrentSprite","_sampleCurrentSprite","sampleNewCheckerboardSprite","_sampleNewCheckerboardSprite","sampleNewSprite","_sampleNewSprite","onMainPick","hw","ux","uy","toMainHex","onColorNew","toMainColor","hsv","fromRgb","toRgb","ns","nv","onBasePick","toBaseHex","onColorBase","toBaseColor","onAlphaPick","onAlphaNew","sprites","nPointsPerData","_nPointsPerData","_colors","_lastHitIndex","_parts","uSampler","DPickerColorGradientDataView","setColors","setColorsHex","setColorsWhite","setVertices","setUvs","newIndices","setColorsPoint","pointSize","local","isEqual","ap","bp","apj","bpj","DPickerColorGradientRecent","DPickerColorGradient","gradientPointsWidth","getGradientPointsWidth","gradientPointsMargin","getGradientPointsMargin","picker","_picker","onAnchorColorChange","onAnchorAlphaChange","_view","setRectangle","getLastHitIndex","onViewDown","_onAnchorDownBound","onAnchorDown","_onAnchorMoveBound","onAnchorMove","_onAnchorUpBound","onAnchorUp","_anchors","inputLabelWidth","inputDirectionMargin","getGradientDirectionMargin","inputDirectionTexture","getGradientDirectionTexture","inputLeft","inputDirection","change","recentColumn","getGradientRecentColumn","recentWidth","getGradientRecentWidth","recentMargin","getGradientRecentMargin","recentWidthAndMargin","RECENT_COLOR_GRADIENT","getGradientRecents","getGradientRecentCount","getCapacity","onRecentUpdate","lastHitIndex","updateAnchors","onAnchorSelect","setData","recentData","fromObject","addAt","toAnchorPosition","onAnchorDragStart","new","anchorTexture","getGradientAnchorTexture","anchorOutlinedTexture","getGradientAnchorOutlinedTexture","anchors","anchorSize","newAnchor","oldAnchor","isDeleteKey","DDialogColorGradient","DButtonColorGradient","_dialogOptions","dialog","getViewBaseTexture","_dialog","DIALOG","DDialogColor","DButtonColor","updateTextForcibly","dialogNew","dialogCurrent","DButtonDanger","DPickerDatetimeButtonBack","DPickerDatetimeButtonDate","DPickerDatetimeButtonNext","DPickerDatetimeLabel","DPickerDatetimeLabelDate","DPickerDatetimeSpace","DInputInteger","_date","_inclusive","inclusive","DPickerTimeBound","DPickerTimeBoundHours","lower","lowerDate","constant","hour","lowerDateHours","minute","upper","upperDate","upperDateHours","DPickerTimeBoundMinutes","lowerDateMinutes","upperDateMinutes","DPickerTimeBoundSeconds","newConstant","hours","minutes","seconds","DPickerTimeBounds","test","getTime","setSeconds","setMinutes","setHours","setDate","am","bm","ad","bd","ah","bh","compare","toBoundOptions","onNewChanged","DPickerTime","_dateCurrent","dateCurrentTime","_dateNew","_dateBounds","getLowerBound","isLowerBoundInclusive","getUpperBound","isUpperBoundInclusive","toBoundsOptions","newChildren","dateCurrent","dateNew","_inputHours","_inputMinutes","_inputSeconds","currentTime","onReset","dateBounds","inputHours","inputMinutes","inputSeconds","newInputHours","newInputMinutes","newInputSeconds","newTimeLayout","newTimeLayoutChildren","getTimeLayoutWidth","getTimeLayoutHeight","newMinuteSeparator","newSecondSeparator","getMinuteSeparator","getSecondSeparator","inputOptions","getHoursOptions","adjustInputOptions","onHoursChanged","getMinutesOptions","onMinutesChanged","getSecondsOptions","onSecondsChanged","DPickerDatetime","_datePage","_dateButtons","newDateButtons","_dateDecorator","decorator","getDateDecorator","newLabel","_labelFormatter","getLabelFormatter","newBackButton","newNextButton","newDateLabels","datePage","onPageChanged","setFullYear","buttons","spaceCount","getDay","getDayStart","dateDecorator","dateCount","dateNewDate","setDisabled","buttonOptions","back","getBackButtonOptions","getNextButtonOptions","dateLabels","getDayLabels","dayStart","newDateLabel","newSpace","newDateButton","onDateButtonClicked","setMonth","DPickerDate","DDialogDate","page","DDialogDates","DButtonDate","DDialogDatetime","DDialogDatetimes","DButtonDatetime","_datetimeMask","toMask","DButtonFileAs","DButtonFile","_opener","onOpening","_buttons","_active","_stateOn","_stateOff","_onActiveBound","onActive","DButtonGroup","DButtonRadio","DButtonRadioRight","commandController","getCommandController","DButtonSecondary","DDialogTime","DDialogTimes","DButtonTime","DBaseOverflowMask","tr","arcTo","stopper","_stopper","drag","getDragMode","getDragModifier","getDragDurationPosition","getDragDurationScale","_dragUtil","toNormalizedScale","scaleRatio","DCanvasContainerViewDrag","dragUtil","_newScale","_newX","_newY","_oldScale","_oldX","_oldY","DCanvasContainerViewTransform","zoom","_zoomPoint","_zoomMin","getZoomMin","_zoomMax","getZoomMax","wheelZoom","wheel","_isWheelZoomEnabled","isWheelZoomEnabled","_wheelZoomSpeed","speed","getWheelZoomSpeed","_wheelZoomModifier","getWheelZoomModifier","dblClickZoom","dblclick","_isDblClickZoomEnabled","isDblClickZoomEnabled","_dblClickZoomSpeed","getDblClickZoomSpeed","_dblClickZoomModifier","getDblClickZoomModifier","_dblclickZoomDuration","getDblClickZoomDuration","wheelTranslation","translation","_isWheelTranslationEnabled","isWheelTranslationEnabled","_wheelTranslationSpeed","getWheelTranslationSpeed","_wheelTranslationModifier","getWheelTranslationModifier","_drag","DCanvasContainerView","newCanvasX","newCanvasY","canvasScaleX","canvasScaleY","newCanvasScale","oldCanvasScale","canvasScaleRatio","zoomAt","zoomAtGlobal","DCanvasContainer","updateContentSize","canvasX","canvasY","vresult","sresult","DCanvas","_coordinateIndex","toPosition","_tick","toTickContainer","DChartAxisBaseOptionParser","getPosition","tick","getTickEnable","major","toTickMajor","minor","toMinorTick","getMajorTickPosition","getMajorTickStyle","getMajorTickCount","getMajorTickSize","toTickPosition","toTickStroke","toMajorTickText","toMajorTickFormatter","tickPosition","getMinorTickPosition","getMinorTickStyle","getMinorTickCount","getMinorTickSize","optionsA","optionsB","getMajorTickTextFormat","toMajorTickTextAlign","toMajorTickTextOffset","toMajorTickTextOutline","toMajorTickTextSpacing","toTickMajorTextDirection","toMajorTickTextPadding","getMajorTickTextAlignHorizontal","getMajorTickTextAlignVertical","getMajorTickTextPaddingHorizontal","getMajorTickTextPaddingVertical","getMajorTickTextDirection","toLabelAlign","toLabelOffset","toLabelOutline","toLabelSpacing","toLabelDirection","toLabelPadding","getLabelAlignHorizontal","getLabelAlignVertical","getLabelPaddingHorizontal","getLabelPaddingVertical","getLabelDirection","parser","coordinateIndex","_majorTicks","Float64Array","_minorTicks","DChartAxisBase","_container","bar","_bar","plotAreaSize","plotArea","plotAreaSizeX","plotAreaSizeY","majorShapes","minorShapes","shapePositionY","majorCount","majorFormatter","minorCountPerMajor","minorCount","majorTicks","minorTicks","ticks","majorShape","imajorTick","majorTickPosition","majorTickProjectedPosition","majorTickStep","minorShape","iminorTick","minorTickPosition","minorTickProjectedPosition","shapePositionX","updateTicksX","updateTicksY","tickShapeContainer","barPosition","attach","tickMajor","tickMajorShapes","tickMajorCount","tickMajorSize","tickMajorPosition","tickMajorStyle","tickMajorShape","tickMinor","tickMinorShapes","tickMinorCount","tickMinorSize","tickMinorPosition","tickMinorStyle","tickMinorShape","updateBar","updateTicks","_plotArea","_list","DChartAxisContainerImpl","axes","axisOrPosition","indexOrUndefined","removed","unbind","DChartAxisX","DChartAxisY","DCHART_COLOR_SET_1","DCHART_COLOR_SET_2","DChartColorSet2","DChartPlotAreaFitTarget","DChartCoordinateContainerSubImpl","coordinateOrIndex","_x","X","_y","cxs","cys","DChartCoordinateContainerImpl","DChartRegionImplObservable","domainFrom","domain","domainTo","_domain","onRegionChange","rangeFrom","rangeTo","_range","DChartCoordinateLinear","series","pixelFrom","pixelTo","domainSpan","rangeSpan","isZero","_iratio","_ioffset","power","LN10","toStepScale","majorPosition","rangeMin","rangeMax","minorPosition","majorResult","minorResult","domainMin","domainMax","majorStep","calcStepMajor","map","imajorResult","iminorResult","getRangeMax","idomainStart","idomainEnd","minorStep","calcStepMinor","imajor","iminor","majorProjectedPosition","minorProjectedPosition","DChartRegionImpl","toScalar","DChartSeriesStrokeImpl","_stroke","listLength","DChartSeriesContainerImpl","seriesOrIndex","_coordinate","_series","_axis","DChartPlotAreaImpl","DListSelectionMode","_coordinateIndexX","_coordinateIndexY","_pointId","_pointIdUpdated","_coordinateIdUpdatedX","_coordinateIdUpdatedY","_regionPointId","DChartSeriesLine","containerStroke","line","_line","toStroke","coordinateX","coordinateY","coordinateIdX","coordinateIdY","isCoordinateXChanged","isCoordinateYChanged","updateLine","xcoordinate","ycoordinate","valuesLength","segmentsLength","ivalues","isegments","xraw","yraw","segment","updateRegion","DChart","_destroyed","DCommandCreate","DCommandDelete","getDocumentController","delete","DCommandSaveAs","saveAs","DCommandSave","DContent","DDiagramCanvasTileMappingPointImpl","lon","lat","mappingOrEnable","lon0","lat0","lon1","lat1","_cb","DDiagramCanvasTileMappingImpl","_factory","factory","onMappingChange","DDiagramCanvasTile","pyramid","_pyramid","DDiagramLayer","layer","DDiagramLayerContainer","activate","addChildAt","activateNext","_layer","_tile","tile","DDiagramCanvasBase","layers","snapperGraphics","_snapperGraphics","snapper","_snapper","DDiagramCanvasEditor","version","interactives","actionables","ids","_lastOverShape","DDiagramCanvas","initializeShapes","updateShapes","initializeFocus","shapeId","this_1","interactiveLocal","lastOverShape","onPointerMove","previousRuntime","onPointerOut","lastOverParent","parentRuntime","onPointerOver","clickable","clickableLocal","DDiagrams","simple","pflayers","pfresources","pfitems","shapePromises","deserializeAll","pfitem","canvasContainer","_serialized","_tileFactory","DDiagramBase","oldSerialized","onUnset","onSet","newCanvas","newLayer","initialize","applyBackground","_controller","controller","_isChanged","DDiagramEditor","newId","reason","isNew","onShapeMove","onShapeUp","onShapeClick","DDiagram","formatterMap","initialMap","actionMap","runtimeConstructor","tagFormat","tagInitial","toRuntime","onShapeDown","DDialogConfirmMessage","DDialogConfirm","toMessage","_message","newMessage","toMessageOptions","toMessageOptionsMerged","getMessage","DDialogConfirmDelete","DDialogConfirmDiscard","enter","getLabelWidth","getLabel","DDialogInputText","DDialogMessage","DDialogProcessingMessage","_isDone","_interval","getInterval","DDialogProcessing","timeoutId","_timeoutId","setStates","onDone","delay","onResolved","onRejected","DDialogSaveAs","getName","DDialogSelectListItem","content","_content","_mode","SINGLE","DListSelection","getChildIndex","MULTIPLE","targetIndex","DScrollBar","_start","_end","thumb","_thumb","createThumb","DScrollBarThumb","onDragMove","getMinimumSize","DScrollBarThumbReflowableHorizontal","DScrollBarThumbHorizontal","DScrollBarHorizontal","getLocalPosition","newStart","thumbMinimumSize","barStart","barSize","DScrollBarThumbReflowableVertical","DScrollBarThumbVertocal","DScrollBarVertical","DPane","toContent","initScrollBar","initDrag","dragMode","position_1","toContentX","toContentY","verticalBar","_verticalBar","toBarOptionsVertical","onRegionMoveY","horizontalBar","_horizontalBar","toBarOptionsHorizontal","onRegionMoveX","onContentChanged","updateScrollBar","newContent","getWheelContentX","getWheelContentY","getWheelSpeed","updateScrollBarRegions","updateScrollBarVisibilities","updateScrollBarPositions","verticalBarWidth","horizontalBarHeight","setRegion","isChangedHorizontal","updateScrollBarVisibility","isChangedVertical","isRegionVisible","WORK_ON_FOCUSED","contentX","contentY","contentWidth","contentHeight","DList","_selection","newSelection","findItem","updateChildPosition","updateChildVisibility","scrollLimit","itemY","DDialogSelectList","DNote","defaultConverter","toToLabel","converter","toNoteOptions","toNoteNoItemsOptions","note","noItems","getNoteNoItemsText","toNoteSearchingOptions","searching","getNoteSearchingText","noteNoItems","_noteNoItems","noteSearching","_noteSearching","search","searchResults","childrenLength","searchResultsLength","minLength","searchResult","removeChildAt","newChild","transition","isDone","getResult","DDialogSelect","owner","_owner","_closeables","DMenuContext","closeables","imin","DMenu","_fit","_sticky","_sub","onPrerenderBound","getBounds","getOffsetX","getOffsetY","isArrowUpKey","isArrowDownKey","setMenuCreator","DMenuSidedSelectionMode","DDropdown","toMenuOptions","DExpandableHeader","DExpandable","DInputIntegerAndLabel","tileSize","_tileSize","DMapCoordinateEPSG3857","lonlat","meters","C","CIRCUMFERENCE_HALF","tan","atan","exp","tz","R","Z","metersToTile","lonLatToMeters","metersToPixels","metersToLonLat","pixelsToMeters","toResolutionMeter","DMapCoordinates","_default","_sprite","DMapTile","onLoaded","_builder","_onLoaded","_isOnLoadedCalled","_isOnLoadedAllowed","_onLoadedBound","_tz","_lon0","_lat0","_lon1","_lat1","_tiles","_renderTileBound","renderTile","_txmin","_txmax","_tymin","_tymax","_deleteTileBound","tileCode","tiles","deleteTile","_destroyTileBound","destroyTile","_updateLoadingStateForEach","loaded","_isLoaded","_tileCount","toTileCount","_tileScaleRelative","_tileScale","getTileSize","DMapTilePlane","_renderer","oldLon0","oldLat0","oldLon1","oldLat1","lonLatToTile","tx1","ty1","tileCount","txmin","txmax","tymin","tymax","dtxmin","dtxmax","dtymin","dtymax","isTxMinChanged","isTxMaxChanged","isTyMinChanged","isTyMaxChanged","ctx","cty","ltx","lty","lt","toOffset","loadTile","it","txa","loadTilesY","txb","tya","loadTilesX","tyb","toTileCode","toTilePosition","newTile","tileScaleRelative","tileToPixels","updateLoadingState","tileScale","mappingLonLat","_mappingInternal","toMapping","_z","_minZ","plane","_maxZ","_planes","_fitBound","_fitBoundTimeout","_fitThrottle","throttle","fitThrottledBound","_fitThrottledBound","fitThrottled","DMapTilePyramidImpl","WORK_LONLAT","lonLatToPixels","oldMapping","newMapping","planes","planeTz","toZ","toTileZ","newPlane","pixelsToLonLat","destroyPlanesBefore","destroyPlanesAfter","DMapTileUrlBuilderOsmfj","DMapTilePyramids","MIN","MAX","THROTTLE","DEFAULT","toPlaneOptions","DMenuBarItem","DMenuBarBlocker","DMenuBar","itemOrItemOptions","_blocker","DMenuSidedContent","DTableColumnType","defaultFilter","_item","_filter","filter","getFilterDefault","DMenuSidedSelection","set_","hasMenu","oldItem","DMenuSided","DSelect","_onSelectedBound","onSelected","_onClosedBound","onClosed","findMenuItem","DTableBodyCellCheck","_columnIndex","_columnData","DTableBodyCellColor","hasColor","hasAlpha","DTableBodyCellIndex","rowIndex","DTableBodyCellInputInteger","newCellValue","oldCellValue","DTableBodyCellInputReal","DTableBodyCellInputText","DTableBodyCellSelectDialog","selecting","getter_1","getter","onSelectBound_1","onCloseBound_1","columnIndex","DTableBodyCellSelectFetcher","fetcher","DTableBodyCellSelectMenu","newSelected","DTableBodyCellText","FILTERED_COMPARATOR","DTableBodyFilterImpl","newFiltered","oldFiltered","_filtered","setFiltered","filtered","rows","rowsLength","filteredRowIndex","DTableBodyCellDate","textValueComputed","DTableBodyCellDatetime","DTableBodyCellTime","DTableSelectionType","DTableRow","columns","_columns","newCell","isBodyCell","DTableBodyRow","_onCellChangeBound","_row","setter","cell","cellOptions","toCellOptions","editable","newCellEditable","newCellUnediable","setReadOnly","INDEX","INTEGER","REAL","CHECK","BUTTON","SELECT","DATETIME","TIME","cells","cellsLength","columnsLength","unset","DTableBodyRowEven","DTableBodyRowOdd","COMPARATOR","Set","DTableSelection","has","oldSize","result_2","lastRowIndex","getLastIndex","addRange","includeFrom","includeTo","rowIndices","shifted","DTableBody","selectionType","toSelectionType","rowOptions","getRowHeight","toRowOptions","_rowOptions","_rowHeight","_rowIndexStart","_rowIndexEnd","toData","_updateRowsCount","_isUpdateRowsCalled","_isUpdateRowsCalledForcibly","_workRows","onSelectionChange","onFilterChange","WORK_ON_CLICK","dataLength","isSingle","isNotSingle","realRowIndex","isEmpty","clearAndAdd","addTo","callIfNeeded","rowHeight","oldRowIndexStart","oldRowIndexEnd","oldRowCount","newContentHeight","newContentY","newRowIndexLowerBound","newRowIndexUpperBound","newRowIndexStart","newRowIndexEnd","newRowCount","oldRowIndex","newRow","rowIndexStartDelta","absRowIndexStartDelta","resetRow","isEven","lock","unlock","DTableHeaderCell","DTableHeader","defaultGetter","defaultSetter","defaultEditingUnformatter","toColumnEditing","toColumnMenu","toColumnDialog","defaultSelectingGetter","toColumnSelecting","toColumn","toColumnAlign","DTable","toColumns","toHeaderOptions","toBodyOptions","wcardinal","ui"],"mappings":";;;;;;;;;;;;;;;;;;;;;;oFAgBA,IAAIA,EAAgB,SAASC,EAAGC,GAI5B,OAHAF,EAAgBG,OAAOC,gBAClB,CAAEC,UAAW,cAAgBC,OAAS,SAAUL,EAAGC,GAAKD,EAAEI,UAAYH,IACvE,SAAUD,EAAGC,GAAK,IAAK,IAAIK,KAAKL,EAAOA,EAAEM,eAAeD,KAAIN,EAAEM,GAAKL,EAAEK,MACpDN,EAAGC,IAGrB,SAASO,EAAUR,EAAGC,GAEzB,SAASQ,IAAOC,KAAKC,YAAcX,EADnCD,EAAcC,EAAGC,GAEjBD,EAAEY,UAAkB,OAANX,EAAaC,OAAOW,OAAOZ,IAAMQ,EAAGG,UAAYX,EAAEW,UAAW,IAAIH,GCnBnF,ICEYK,eDFZ,cAmBA,OAhBQC,aAAP,SAAmBC,GAClB,IAAMC,EAASF,EAAcG,SAE7B,OADAH,EAAcG,SAAWF,EAClBC,GAGDF,cAAP,WACC,GAA8B,MAA1BA,EAAcG,SACjB,MAAM,IAAIC,MAAO,gDAElB,OAAOJ,EAAcG,UAGfH,SAAP,WACCL,KAAKU,cAAcC,UAhBHN,WAAgC,UEHrCO,EAAiB,SAAEC,GAC/B,MAA2B,mBAAZA,gBCaf,WAAaC,EAAmBC,EAA6BC,GAG5D,GAFAhB,KAAKiB,EAASH,EACdd,KAAKkB,EAAYF,EACF,MAAXD,GAAyC,MAAtBA,EAAQI,WAAqB,CACnD,IAAMA,EAAaJ,EAAQI,WAC3BnB,KAAKoB,EAASD,EAAWE,MACzBrB,KAAKsB,EAASH,EAAWI,OAsE5B,OAlECC,qBAAA,WACC,OAAOxB,KAAKiB,GAGbO,qBAAA,SAAUV,GACTd,KAAKiB,EAASH,GAGfU,qBAAA,SAAUC,GACT,IAAMJ,EAAQrB,KAAKoB,EACnB,QAAcM,IAAVL,EAAsB,CACzB,IAAIT,EAAgBS,GAMnB,OAAOA,EALP,IAAMd,EAASc,EAAOI,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAOU,mBAAoBF,IAGxCjC,sBAAIgC,yBAAJ,WACC,OAAOxB,KAAKoB,OAGb,SAAWC,GACNrB,KAAKoB,IAAWC,IACnBrB,KAAKoB,EAASC,EACdrB,KAAK4B,6CAIPJ,qBAAA,SAAUC,GACT,IAAMF,EAAQvB,KAAKsB,EACnB,QAAcI,IAAVH,EAAsB,CACzB,IAAIX,EAAgBW,GAMnB,OAAOA,EALP,IAAMhB,EAASgB,EAAOE,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAOY,mBAAoBJ,IAGxCjC,sBAAIgC,yBAAJ,WACC,OAAOxB,KAAKsB,OAGb,SAAWC,GACNvB,KAAKsB,IAAWC,IACnBvB,KAAKsB,EAASC,EACdvB,KAAK4B,6CAIGJ,qBAAV,WACC,IAAMR,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,WFnFH,SAAYZ,GACXA,mBAEAA,iBACAA,qBACAA,uBACAA,mBAEAA,6BACAA,+BACAA,2BAEAA,mCACAA,gCAEAA,kCAEAA,0BACAA,8BACAA,gCACAA,2BAEAA,kBAtBD,CAAYA,IAAAA,OGJL,ICEK0B,EDFCC,EAAe,SAAElB,GAC7B,MAA2B,iBAAXA,GACgC,oBAA7CrB,OAAOU,UAAU8B,SAASC,KAAMpB,iBEgBnC,WAAaC,EAAmBC,EAA6BC,GAG5D,GAFAhB,KAAKiB,EAASH,EACdd,KAAKkB,EAAYF,EACF,MAAXD,GAAqC,MAAlBA,EAAQmB,OAAiB,CAC/C,IAAMA,EAASnB,EAAQmB,OACvBlC,KAAKoB,EAASc,EAAOb,MACrBrB,KAAKsB,EAASY,EAAOX,MACrBvB,KAAKmC,EAASD,EAAOE,MACrBpC,KAAKqC,EAASH,EAAOI,MACrBtC,KAAKuC,EAAUR,EAAcG,EAAOM,MAASpC,EAAa8B,EAAOM,MAASN,EAAOM,MAoJpF,OAhJCC,qBAAA,WACC,OAAOzC,KAAKiB,GAGbwB,qBAAA,SAAU3B,GACTd,KAAKiB,EAASH,GAGf2B,qBAAA,SAAUhB,GACT,IAAMJ,EAAQrB,KAAKoB,EACnB,QAAcM,IAAVL,EAAsB,CACzB,IAAIT,EAAgBS,GAMnB,OAAOA,EALP,IAAMd,EAASc,EAAOI,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAOyB,eAAgBjB,IAGpCjC,sBAAIiD,yBAAJ,WACC,OAAOzC,KAAKoB,OAGb,SAAWC,GACNrB,KAAKoB,IAAWC,IACnBrB,KAAKoB,EAASC,EACdrB,KAAK4B,6CAIPa,qBAAA,SAAUhB,GACT,IAAMF,EAAQvB,KAAKsB,EACnB,QAAcI,IAAVH,EAAsB,CACzB,IAAIX,EAAgBW,GAMnB,OAAOA,EALP,IAAMhB,EAASgB,EAAOE,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO0B,eAAgBlB,IAGpCjC,sBAAIiD,yBAAJ,WACC,OAAOzC,KAAKsB,OAGb,SAAWC,GACNvB,KAAKsB,IAAWC,IACnBvB,KAAKsB,EAASC,EACdvB,KAAK4B,6CAIPa,qBAAA,SAAUhB,GACT,IAAMW,EAAQpC,KAAKmC,EACnB,QAAcT,IAAVU,EAAsB,CACzB,IAAIxB,EAAgBwB,GAMnB,OAAOA,EALP,IAAM7B,EAAS6B,EAAOX,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO2B,eAAgBnB,IAGpCjC,sBAAIiD,yBAAJ,WACC,OAAOzC,KAAKmC,OAGb,SAAWC,GACNpC,KAAKmC,IAAWC,IACnBpC,KAAKmC,EAASC,EACdpC,KAAK4B,6CAIPa,qBAAA,SAAUhB,GACT,IAAMa,EAAQtC,KAAKqC,EACnB,QAAcX,IAAVY,EAAsB,CACzB,IAAI1B,EAAgB0B,GAMnB,OAAOA,EALP,IAAM/B,EAAS+B,EAAOb,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO4B,eAAgBpB,IAGpCjC,sBAAIiD,yBAAJ,WACC,OAAOzC,KAAKqC,OAGb,SAAWC,GACNtC,KAAKqC,IAAWC,IACnBtC,KAAKqC,EAASC,EACdtC,KAAK4B,6CAIPa,oBAAA,SAAShB,GACR,IAAMe,EAAOxC,KAAKuC,EAClB,QAAab,IAATc,EAAqB,CACxB,IAAI5B,EAAgB4B,GAMnB,OAAOA,EALP,IAAMjC,EAASiC,EAAMf,GACrB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO6B,cAAerB,IAGnCjC,sBAAIiD,wBAAJ,WACC,OAAOzC,KAAKuC,OAGb,SAAUC,GACLxC,KAAKuC,IAAUC,IAClBxC,KAAKuC,EAAQC,EACbxC,KAAK4B,6CAIGa,qBAAV,WACC,IAAMzB,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,WD1KH,SAAYc,GACXA,mBACAA,2BACAA,6BACAA,iCACAA,mCACAA,iBACAA,wBACAA,mBACAA,sBACAA,kBAVD,CAAYA,IAAAA,OEFL,ICAKiB,EDACC,EAAe,SAAEnC,GAC7B,MAA2B,iBAAXA,GACgC,oBAA7CrB,OAAOU,UAAU8B,SAASC,KAAMpB,iBEWnC,WAAaC,EAAmBC,EAA6BC,GAG5D,GAFAhB,KAAKiB,EAASH,EACdd,KAAKkB,EAAYF,EACF,MAAXD,GAAqC,MAAlBA,EAAQkC,OAAiB,CAC/C,IAAMA,EAASlC,EAAQkC,OACnBD,EAAcC,IACjBjD,KAAKkD,EAAUD,EACfjD,KAAKuC,OAAQb,IAEb1B,KAAKkD,EAAUD,EAAOE,OACtBnD,KAAKuC,EAAUR,EAAckB,EAAOT,MAASV,EAAamB,EAAOT,MAASS,EAAOT,OAqErF,OAhECY,qBAAA,WACC,OAAOpD,KAAKiB,GAGbmC,qBAAA,SAAUtC,GACTd,KAAKiB,EAASH,GAGfsC,sBAAA,WACC,IAAMD,EAASnD,KAAKkD,EACpB,YAAoBxB,IAAXyB,EAAuBA,EAASnD,KAAKiB,EAAOoC,mBAGtD7D,sBAAI4D,0BAAJ,WACC,OAAOpD,KAAKkD,OAGb,SAAYC,GACX,GAAInD,KAAKkD,IAAYC,EAAS,CAC7BnD,KAAKkD,EAAUC,EACf,IAAMnC,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,sCAKHoC,oBAAA,WACC,IAAMZ,EAAOxC,KAAKuC,EAClB,YAAkBb,IAATc,EAAqBA,EAAOxC,KAAKiB,EAAOqC,iBAGlD9D,sBAAI4D,wBAAJ,WACC,OAAOpD,KAAKuC,OAGb,SAAUC,GACT,GAAIxC,KAAKuC,IAAUC,EAAO,CACzBxC,KAAKuC,EAAQC,EACb,IAAMxB,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,sCAKHoC,gBAAA,SAAKD,EAAiBX,GACrB,IAAIe,GAAY,EAEZvD,KAAKkD,IAAYC,IACpBnD,KAAKkD,EAAUC,EACfI,GAAY,GAGTvD,KAAKuC,IAAUC,IAClBxC,KAAKuC,EAAQC,EACbe,GAAY,GAGb,IAAMvC,EAAWhB,KAAKkB,EAClBqC,GAAyB,MAAZvC,GAChBA,WDzFH,SAAY+B,GACXA,mBACAA,mBACAA,2BACAA,mBAJD,CAAYA,IAAAA,OEUZ,ICVYS,eDoBX,WAAa1C,EAAmBC,EAA6BC,GAG5D,GAFAhB,KAAKiB,EAASH,EACdd,KAAKkB,EAAYF,EACF,MAAXD,GAAsC,MAAnBA,EAAQ0C,QAAkB,CAChD,IAAMA,EAAU1C,EAAQ0C,QACxBzD,KAAKoB,EAASqC,EAAQpC,MACtBrB,KAAKsB,EAASmC,EAAQlC,MACtBvB,KAAKmC,EAASsB,EAAQrB,MACtBpC,KAAK0D,EAAUD,EAAQE,OACvB3D,KAAKqC,EAASoB,EAAQnB,MACtBtC,KAAKuC,EAAUR,EAAc0B,EAAQjB,MAASpC,EAAaqD,EAAQjB,MAASiB,EAAQjB,MAyLvF,OArLCoB,qBAAA,WACC,OAAO5D,KAAKiB,GAGb2C,qBAAA,SAAU9C,GACTd,KAAKiB,EAASH,GAGf8C,qBAAA,SAAUnC,GACT,IAAMJ,EAAQrB,KAAKoB,EACnB,QAAcM,IAAVL,EAAsB,CACzB,IAAIT,EAAgBS,GAMnB,OAAOA,EALP,IAAMd,EAASc,EAAOI,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO4C,gBAAiBpC,IAGrCjC,sBAAIoE,yBAAJ,WACC,OAAO5D,KAAKoB,OAGb,SAAWC,GACV,GAAIrB,KAAKoB,IAAWC,EAAQ,CAC3BrB,KAAKoB,EAASC,EACd,IAAML,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,sCAKH4C,qBAAA,SAAUnC,GACT,IAAMF,EAAQvB,KAAKsB,EACnB,QAAcI,IAAVH,EAAsB,CACzB,IAAIX,EAAgBW,GAMnB,OAAOA,EALP,IAAMhB,EAASgB,EAAOE,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO6C,gBAAiBrC,IAGrCjC,sBAAIoE,yBAAJ,WACC,OAAO5D,KAAKsB,OAGb,SAAWC,GACV,GAAIvB,KAAKsB,IAAWC,EAAQ,CAC3BvB,KAAKsB,EAASC,EACd,IAAMP,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,sCAKH4C,qBAAA,SAAUnC,GACT,IAAMW,EAAQpC,KAAKmC,EACnB,QAAcT,IAAVU,EAAsB,CACzB,IAAIxB,EAAgBwB,GAMnB,OAAOA,EALP,IAAM7B,EAAS6B,EAAOX,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO8C,gBAAiBtC,IAGrCjC,sBAAIoE,yBAAJ,WACC,OAAO5D,KAAKmC,OAGb,SAAWC,GACV,GAAIpC,KAAKmC,IAAWC,EAAQ,CAC3BpC,KAAKmC,EAASC,EACd,IAAMpB,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,sCAKH4C,sBAAA,SAAWnC,GACV,IAAMkC,EAAS3D,KAAK0D,EACpB,QAAehC,IAAXiC,EAAuB,CAC1B,IAAI/C,EAAgB+C,GAMnB,OAAOA,EALP,IAAMpD,EAASoD,EAAQlC,GACvB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAO+C,iBAAkBvC,IAGtCjC,sBAAIoE,0BAAJ,WACC,OAAO5D,KAAK0D,OAGb,SAAYC,GACX,GAAI3D,KAAK0D,IAAYC,EAAS,CAC7B3D,KAAK0D,EAAUC,EACf,IAAM3C,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,sCAKH4C,qBAAA,SAAUnC,GACT,IAAMa,EAAQtC,KAAKqC,EACnB,QAAcX,IAAVY,EAAsB,CACzB,IAAI1B,EAAgB0B,GAMnB,OAAOA,EALP,IAAM/B,EAAS+B,EAAOb,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAOgD,gBAAiBxC,IAGrCjC,sBAAIoE,yBAAJ,WACC,OAAO5D,KAAKqC,OAGb,SAAWC,GACV,GAAItC,KAAKqC,IAAWC,EAAQ,CAC3BtC,KAAKqC,EAASC,EACd,IAAMtB,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,sCAKH4C,oBAAA,SAASnC,GACR,IAAMe,EAAOxC,KAAKuC,EAClB,QAAab,IAATc,EAAqB,CACxB,IAAI5B,EAAgB4B,GAMnB,OAAOA,EALP,IAAMjC,EAASiC,EAAMf,GACrB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKiB,EAAOiD,eAAgBzC,IAGpCjC,sBAAIoE,wBAAJ,WACC,OAAO5D,KAAKuC,OAGb,SAAUC,GACT,GAAIxC,KAAKuC,IAAUC,EAAO,CACzBxC,KAAKuC,EAAQC,EACb,IAAMxB,EAAWhB,KAAKkB,EACN,MAAZF,GACHA,wDErMH,WAAaF,EAAmBC,EAA6BC,GAI5D,GAHAhB,KAAKiB,EAASH,EACdd,KAAKkB,EAAYF,EAEF,MAAXD,GAAsC,MAAnBA,EAAQoD,QAAkB,CAChD,IAAMA,EAAUpD,EAAQoD,QACpBnB,EAAcmB,IACjBnE,KAAKoE,EAAQD,EACbnE,KAAKqE,EAAOF,EACZnE,KAAKsE,EAASH,EACdnE,KAAKuE,EAAUJ,IAEfnE,KAAKoE,EAAQD,EAAQK,KACrBxE,KAAKqE,EAAOF,EAAQM,IACpBzE,KAAKsE,EAASH,EAAQO,MACtB1E,KAAKuE,EAAUJ,EAAQQ,SAkH3B,OA7GCC,qBAAA,WACC,OAAO5E,KAAKiB,GAGb2D,qBAAA,SAAU9D,GACTd,KAAKiB,EAASH,GAGf8D,oBAAA,WACC,IAAMJ,EAAOxE,KAAKoE,EAClB,YAAgB1C,IAAT8C,EAAqBA,EAAOxE,KAAKiB,EAAO4D,kBAGhDrF,sBAAIoF,wBAAJ,WACC,OAAO5E,KAAKoE,OAGb,SAAUI,GACLxE,KAAKoE,IAAUI,IAClBxE,KAAKoE,EAAQI,EACS,MAAlBxE,KAAKkB,GACRlB,KAAKkB,sCAKR0D,mBAAA,WACC,IAAMH,EAAMzE,KAAKqE,EACjB,YAAe3C,IAAR+C,EAAoBA,EAAMzE,KAAKiB,EAAO6D,iBAG9CtF,sBAAIoF,uBAAJ,WACC,OAAO5E,KAAKqE,OAGb,SAASI,GACJzE,KAAKqE,IAASI,IACjBzE,KAAKqE,EAAOI,EACU,MAAlBzE,KAAKkB,GACRlB,KAAKkB,sCAKR0D,qBAAA,WACC,IAAMF,EAAQ1E,KAAKsE,EACnB,YAAiB5C,IAAVgD,EAAsBA,EAAQ1E,KAAKiB,EAAO8D,mBAGlDvF,sBAAIoF,yBAAJ,WACC,OAAO5E,KAAKsE,OAGb,SAAWI,GACN1E,KAAKsE,IAAWI,IACnB1E,KAAKsE,EAASI,EACQ,MAAlB1E,KAAKkB,GACRlB,KAAKkB,sCAKR0D,sBAAA,WACC,IAAMD,EAAS3E,KAAKuE,EACpB,YAAkB7C,IAAXiD,EAAuBA,EAAS3E,KAAKiB,EAAO+D,oBAGpDxF,sBAAIoF,0BAAJ,WACC,OAAO5E,KAAKuE,OAGb,SAAYI,GACP3E,KAAKuE,IAAYI,IACpB3E,KAAKuE,EAAUI,EACO,MAAlB3E,KAAKkB,GACRlB,KAAKkB,sCAQR0D,gBAAA,SAAKH,EAAaC,EAAgBC,EAAiBH,GACrC,MAATE,GACH1E,KAAKyE,IAAMA,EACXzE,KAAK0E,MAAQD,EACbzE,KAAK2E,OAASF,EACdzE,KAAKwE,KAAOC,GACQ,MAAVE,GACV3E,KAAKyE,IAAMA,EACXzE,KAAK0E,MAAQA,EACb1E,KAAK2E,OAASF,EACdzE,KAAKwE,KAAOE,GACM,MAARF,GACVxE,KAAKyE,IAAMA,EACXzE,KAAK0E,MAAQA,EACb1E,KAAK2E,OAASA,EACd3E,KAAKwE,KAAOE,IAEZ1E,KAAKyE,IAAMA,EACXzE,KAAK0E,MAAQA,EACb1E,KAAK2E,OAASA,EACd3E,KAAKwE,KAAOA,GAES,MAAlBxE,KAAKkB,GACRlB,KAAKkB,uBCnIP,WAAa+D,EAAeC,EAAcC,GACzCnF,KAAKoF,EAASH,EACdjF,KAAKkF,GAAKA,EA6DZ,OA1DC1F,sBAAI6F,qBAAJ,WACC,OAAOrF,KAAKoF,EAAOE,OAGpB,SAAOA,GACN,IAAML,EAAQjF,KAAKoF,EACfH,EAAMK,IAAMA,IACfL,EAAMK,EAAIA,EACVtF,KAAKkF,GAAGjD,KAAMjC,KAAKmF,yCAIrB3F,sBAAI6F,qBAAJ,WACC,OAAOrF,KAAKoF,EAAOG,OAGpB,SAAOA,GACN,IAAMN,EAAQjF,KAAKoF,EACfH,EAAMM,IAAMA,IACfN,EAAMM,EAAIA,EACVvF,KAAKkF,GAAGjD,KAAMjC,KAAKmF,yCAIrBE,gBAAA,SAAKC,EAAWC,GACf,IAAMN,EAAQjF,KAAKoF,EACfH,EAAMK,IAAMA,GAAKL,EAAMM,IAAMA,IAChCN,EAAMO,IAAKF,EAAGC,GACdvF,KAAKkF,GAAGjD,KAAMjC,KAAKmF,SAIrBE,qBAAA,SAAUxE,GACT,IAAMoE,EAAQjF,KAAKoF,EAKnB,OAJIH,EAAMK,IAAMzE,EAAOyE,GAAKL,EAAMM,IAAM1E,EAAO0E,IAC9CN,EAAMQ,SAAU5E,GAChBb,KAAKkF,GAAGjD,KAAMjC,KAAKmF,QAEbnF,MAGRqF,mBAAA,SAAQxE,GACP,OAAOA,EAAO4E,SAAUzF,KAAKoF,IAG9BC,iBAAA,WACC,OAAOrF,KAAKyF,SAAUC,UAAW,KAGlCL,kBAAA,SAAOH,EAAeC,GAGrB,OAFAD,EAAKA,GAAMlF,KAAKkF,GAChBC,EAAQA,GAASnF,KAAKmF,MACf,IAAIE,EAAYrF,KAAKoF,EAAQF,EAAgBC,IAGrDE,mBAAA,SAAQzF,GACP,OAAOI,KAAKoF,EAAOO,OAAQ/F,uBCpD5B,WAAagG,EAAkBxD,EAAeyD,EAAgBC,EAAoBC,GAAlF,MACCC,YAAO,IAAIC,aAAc,IAAM,IAAIA,aAAc,IAAM,IAAIC,YAAa,kBAExEC,EAAKhE,EAASC,EACd+D,EAAKC,EAAUP,EACfM,EAAKE,EAAWT,EAChBO,EAAKG,EAAcR,EACnBK,EAAKI,EAAcR,EACnBI,EAAKK,GAAW,EAChBL,EAAKM,EAAaC,IAElBP,EAAKQ,EAAgBR,EAAKS,UAAW,mBACrCT,EAAKU,EAAYV,EAAKQ,EAAcG,KACpCX,EAAKY,EAAYZ,EAAKS,UAAW,iBACjCT,EAAKa,KAAOb,EAAKY,EAAUD,KAC3BX,EAAKc,EAAed,EAAKe,WACzBf,EAAKgB,EAAWhB,EAAKc,EAAaH,OAsNpC,OArPiDhH,OAkChDN,sBAAI4H,8BAAJ,WACC,OAAOpH,KAAKsG,OAGb,SAAgBR,GACX9F,KAAKsG,IAAgBR,IACxB9F,KAAKsG,EAAcR,EACnB9F,KAAKwG,GAAW,oCAIlBhH,sBAAI4H,8BAAJ,WACC,OAAOpH,KAAKuG,OAGb,SAAgBR,GACX/F,KAAKuG,IAAgBR,IACxB/F,KAAKuG,EAAcR,EACnB/F,KAAKwG,GAAW,oCAIlBhH,sBAAI4H,yBAAJ,WACC,OAAOpH,KAAKmC,OAGb,SAAWC,GACNpC,KAAKmC,IAAWC,IACnBpC,KAAKmC,EAASC,EACdpC,KAAKwG,GAAW,oCAIlBhH,sBAAI4H,0BAAJ,WACC,OAAOpH,KAAKoG,OAGb,SAAYP,GACP7F,KAAKoG,IAAYP,IACpB7F,KAAKoG,EAAUP,EACf7F,KAAKwG,GAAW,oCAIlBhH,sBAAI4H,2BAAJ,WACC,OAAOpH,KAAKqG,OAGb,SAAaT,GACR5F,KAAKqG,IAAaT,IACrB5F,KAAKqG,EAAWT,EAChB5F,KAAKwG,GAAW,EAChBxG,KAAKyG,EAAaC,sCAIVU,yBAAV,WACC,OAAQpH,KAAKqG,EAAiBgB,WAGrBD,yBAAV,SAAwBE,EAAYC,EAAqBC,EAAYC,EAAYC,EAAYC,GAC5FJ,EAAOD,EAAK,GAAME,EAClBD,EAAOD,EAAK,GAAMI,EAClBH,EAAOD,EAAK,GAAMG,EAClBF,EAAOD,EAAK,GAAMI,EAClBH,EAAOD,EAAK,GAAME,EAClBD,EAAOD,EAAK,GAAMK,EAClBJ,EAAOD,EAAK,GAAMG,EAClBF,EAAOD,EAAK,GAAMK,GAGTP,wBAAV,SAAuBQ,EAAYC,EAAsBP,GACxDO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,GAGhBF,0BAAV,SACCE,EAAYQ,EAAmBC,EAC/BC,EAAYC,EAAYC,EAAYC,EACpCC,EAAYC,EAAYC,EAAYC,GAEhCR,EACH/H,KAAKwI,aAAclB,EAAIQ,EAAKE,EAAIC,EAAIG,EAAIC,GAExCrI,KAAKwI,aAAclB,EAAIQ,EAAKK,EAAID,EAAIE,EAAIC,IAIhCjB,oBAAV,SAAmBE,EAAYQ,EAAmBE,EAAYC,EAAYG,EAAYC,GACrFrI,KAAKwI,aAAclB,EAAIQ,EAAKE,EAAIC,EAAIG,EAAIC,IAGzCjB,mBAAA,WACC,IAAMxB,EAAU5F,KAAK4F,QACrB,GAAMA,EAAQ6C,MAAd,CAGA,IAAMC,EAAY1I,KAAK2I,eACvB,GAAI3I,KAAKwG,GAAYxG,KAAKyG,IAAeiC,EAAY,CACpD1I,KAAKwG,GAAW,EAChBxG,KAAKyG,EAAaiC,EAClB,IAAME,EAAW5I,KAAK6G,EAChBiB,EAAM9H,KAAKgH,KACXa,EAAU7H,KAAKmH,EAEf/E,EAAQpC,KAAKmC,EACb0D,EAAS7F,KAAKoG,EACdN,EAAa9F,KAAKsG,EAGlBmB,EAAK3B,EACL+C,EAAKzG,EAAQ0D,EACbgD,EAAK1G,EAGLuF,EAAK7B,EACLiD,EAAKlD,EAASC,EACdkD,EAAKnD,EAELoD,EAAyBrD,EAAQoB,KAEjCkC,EAAID,EAAWzB,GACf2B,EAAIF,EAAWxB,GACf2B,EAAIH,EAAWvB,GACfnI,EAAI0J,EAAWD,GACfK,GAAKF,EAAID,IAAMpD,EAAaF,EAAQxD,OACpCkH,GAAK/J,EAAI6J,IAAMtD,EAAaF,EAAQC,QAEpCmC,EAAKkB,EACLjB,EAAKiB,EAAIG,EACTnB,EAAKiB,EAAIE,EACTlB,EAAKgB,EAELf,EAAKgB,EACLf,EAAKe,EAAIE,EACThB,EAAK/I,EAAI+J,EACTf,EAAKhJ,EAELwG,EAAa/F,KAAKuG,EAClBgD,IAASxD,EAAajE,EAAY0H,UAClCC,IAAS1D,EAAajE,EAAY4H,WAClCC,IAAS5D,EAAajE,EAAY8H,aAClCC,IAAS9D,EAAajE,EAAYgI,cAGpCxC,EAAK,EACLyC,EAAK,EACLnC,EAAK,EAGT5H,KAAKwI,aAAclB,EAAIsB,EAzCZ,EAyC0BnB,EApC1B,EAoCkCE,GAC7C3H,KAAKgK,cAAe1C,EAAIQ,EAAKyB,EAAKvB,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAC9DvI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUnB,EAAIoB,EA5C1B,EA4CkClB,GAC7C3H,KAAKkK,QAAS5C,EAAIQ,EAAKG,EAAIC,EAAIE,EAAIC,GACnCrI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUE,EAAID,EApD1B,EAoDkClB,GAC7C3H,KAAKgK,cAAe1C,EAAIQ,EAAK2B,EAAKzB,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAC9DvI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAjEZ,EAiE0BE,EAAInB,EAAIoB,GAC7C/I,KAAKkK,QAAS5C,EAAIQ,EAAKE,EAAIG,EAAIE,EAAIC,GACnCtI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAzEZ,EAyE0BnB,EAAIuB,EAAID,GAC7C/I,KAAKgK,cAAe1C,EAAIQ,EAAK6B,EAAK3B,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GAC9DvI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUnB,EAAIoB,EAAIE,EAAIC,GAC7ChJ,KAAKkK,QAAS5C,EAAIQ,EAAKG,EAAIC,EAAII,EAAIC,GACnCvI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUE,EAAID,EAAIG,EAAID,GAC7C/I,KAAKgK,cAAe1C,EAAIQ,EAAK+B,EAAK1B,EAAID,EAAID,EAAID,EAAIO,EAAID,EAAID,EAAID,GAC9DpI,KAAKiK,YAAarC,EAAIC,EAASkC,GAE/B/J,KAAK2G,EAAchG,SACnBX,KAAK+G,EAAUpG,SACfX,KAAKiH,EAAatG,eAlP4BwJ,8BCKhD,WAAavE,EAAkBE,EAAoBC,UAClDC,YACC,IAAIoB,EAA6BxB,EAAS,IAAK,IAAKE,EAAYC,GAChE,IAAIqE,eAAcxE,UAuDrB,OA9DyC9F,OAWxCN,sBAAI6K,2BAAJ,WACC,OAAOrK,KAAKsK,OAAO1E,aAGpB,SAAaA,GACR5F,KAAKsK,OAAO1E,UAAYA,IAC3B5F,KAAKsK,OAAO1E,QAAUA,EACtB5F,KAAKuK,SAAS3E,QAAUA,oCAI1BpG,sBAAI6K,yBAAJ,WACC,OAAOrK,KAAKuK,SAASnI,WAGtB,SAAWA,GACVpC,KAAKuK,SAASnI,MAAQA,mCAGvB5C,sBAAI6K,0BAAJ,WACC,OAAOrK,KAAKuK,SAAS1E,YAGtB,SAAYA,GACX7F,KAAKuK,SAAS1E,OAASA,mCAGxBrG,sBAAI6K,8BAAJ,WACC,OAAOrK,KAAKuK,SAASxE,gBAGtB,SAAgBD,GACf9F,KAAKuK,SAASzE,WAAaA,mCAG5BtG,sBAAI6K,8BAAJ,WACC,OAAOrK,KAAKuK,SAASxE,gBAGtB,SAAgBA,GACf/F,KAAKuK,SAASxE,WAAaA,mCAGlBsE,oBAAV,SAAmBG,GAClBxK,KAAKuK,SAAS5J,SACdqF,YAAMyE,kBAASD,IAGhBH,mBAAA,WACCrK,KAAKuK,SAAS5J,aA5DyB+J,sBCgBxC,WACC9E,EAAkBxD,EAAeyD,EACjCC,EAAoB6E,EAAyB5E,GAF9C,MAICC,YAAO,IAAIC,aAAc,IAAM,IAAIA,aAAc,IAAM,IAAIC,YAAa,kBAExEC,EAAKhE,EAASC,EACd+D,EAAKC,EAAUP,EACfM,EAAKE,EAAWT,EAChBO,EAAKG,EAAcR,EACnBK,EAAKyE,EAAcD,EACnBxE,EAAKI,EAAcR,EACnBI,EAAKK,GAAW,EAChBL,EAAKM,EAAaC,IAElBP,EAAKQ,EAAgBR,EAAKS,UAAW,mBACrCT,EAAKU,EAAYV,EAAKQ,EAAcG,KACpCX,EAAKY,EAAYZ,EAAKS,UAAW,iBACjCT,EAAKa,KAAOb,EAAKY,EAAUD,KAC3BX,EAAKc,EAAed,EAAKe,WACzBf,EAAKgB,EAAWhB,EAAKc,EAAaH,OA2PpC,OA/R6ChH,OAuC5CN,sBAAIqL,8BAAJ,WACC,OAAO7K,KAAK4K,OAGb,SAAgBD,GACX3K,KAAK4K,IAAgBD,IACxB3K,KAAK4K,EAAcD,EACnB3K,KAAKwG,GAAW,oCAIlBhH,sBAAIqL,8BAAJ,WACC,OAAO7K,KAAKuG,OAGb,SAAgBR,GACX/F,KAAKuG,IAAgBR,IACxB/F,KAAKuG,EAAcR,EACnB/F,KAAKwG,GAAW,oCAIlBhH,sBAAIqL,8BAAJ,WACC,OAAO7K,KAAKsG,OAGb,SAAgBR,GACX9F,KAAKsG,IAAgBR,IACxB9F,KAAKsG,EAAcR,EACnB9F,KAAKwG,GAAW,oCAIlBhH,sBAAIqL,yBAAJ,WACC,OAAO7K,KAAKmC,OAGb,SAAWC,GACNpC,KAAKmC,IAAWC,IACnBpC,KAAKmC,EAASC,EACdpC,KAAKwG,GAAW,oCAIlBhH,sBAAIqL,0BAAJ,WACC,OAAO7K,KAAKoG,OAGb,SAAYP,GACP7F,KAAKoG,IAAYP,IACpB7F,KAAKoG,EAAUP,EACf7F,KAAKwG,GAAW,oCAIlBhH,sBAAIqL,2BAAJ,WACC,OAAO7K,KAAKqG,OAGb,SAAaT,GACR5F,KAAKqG,IAAaT,IACrB5F,KAAKqG,EAAWT,EAChB5F,KAAKwG,GAAW,EAChBxG,KAAKyG,EAAaC,sCAIVmE,yBAAV,SAAwBvD,EAAYC,EAAqBC,EAAYC,EAAYC,EAAYC,GAC5FJ,EAAOD,EAAK,GAAME,EAClBD,EAAOD,EAAK,GAAMI,EAClBH,EAAOD,EAAK,GAAMG,EAClBF,EAAOD,EAAK,GAAMI,EAClBH,EAAOD,EAAK,GAAME,EAClBD,EAAOD,EAAK,GAAMK,EAClBJ,EAAOD,EAAK,GAAMG,EAClBF,EAAOD,EAAK,GAAMK,GAGTkD,wBAAV,SAAuBjD,EAAYC,EAAsBP,GACxDO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,EACzBO,EAASD,EAAK,GAAMN,EAAK,GAGhBuD,0BAAV,SACCvD,EAAYQ,EAAmBgD,EAAaC,EAAahD,EACzDC,EAAYC,EAAYC,EAAYC,EACpCC,EAAYC,EAAYC,EAAYC,GAEhCuC,GAAMC,EACLhD,EACH/H,KAAKwI,aAAclB,EAAIQ,EAAKE,EAAIC,EAAIG,EAAIC,GAC9ByC,GAAMC,EAChB/K,KAAKwI,aAAclB,EAAIQ,EAAKK,EAAID,EAAIE,EAAIC,GAC9ByC,EACV9K,KAAKwI,aAAclB,EAAIQ,EAAKG,EAAIC,EAAIE,EAAIC,GAExCrI,KAAKwI,aAAclB,EAAIQ,EAAKE,EAAIC,EAAII,EAAIC,GAGzCtI,KAAKwI,aAAclB,EAAIQ,EAAKG,EAAIA,EAAII,EAAIA,IAIhCwC,oBAAV,SACCvD,EAAYQ,EAAmBvI,EAC/ByI,EAAYC,EAAYG,EAAYC,EACpC2C,EAAYC,GAER1L,EACHS,KAAKwI,aAAclB,EAAIQ,EAAKE,EAAIC,EAAIG,EAAIC,GAExCrI,KAAKwI,aAAclB,EAAIQ,EAAKkD,EAAIA,EAAIC,EAAIA,IAI1CJ,mBAAA,WACC,IAAMjF,EAAU5F,KAAKqG,EACrB,GAAMT,EAAQ6C,MAAd,CAGA,IAAMC,EAAY9C,EAAQyB,UAC1B,GAAIrH,KAAKwG,GAAYxG,KAAKyG,IAAeiC,EAAY,CACpD1I,KAAKwG,GAAW,EAChBxG,KAAKyG,EAAaiC,EAClB,IAAME,EAAW5I,KAAK6G,EAChBiB,EAAM9H,KAAKgH,KACXa,EAAU7H,KAAKmH,EAEf/E,EAAQpC,KAAKmC,EACb0D,EAAS7F,KAAKoG,EACdN,EAAa9F,KAAKsG,EAGlBmB,EAAK3B,EACL+C,EAAKzG,EAAQ0D,EACbgD,EAAK1G,EAGLuF,EAAK7B,EACLiD,EAAKlD,EAASC,EACdkD,EAAKnD,EAELoD,EAAyBrD,EAAQoB,KAEjCkC,EAAID,EAAWzB,GACf2B,EAAIF,EAAWxB,GACf2B,EAAIH,EAAWvB,GACfnI,EAAI0J,EAAWD,GACfK,GAAKF,EAAID,IAAMpD,EAAaF,EAAQxD,OACpCkH,GAAK/J,EAAI6J,IAAMtD,EAAaF,EAAQC,QAEpCmC,EAAKkB,EACLjB,EAAKiB,EAAIG,EACTnB,EAAKiB,EAAIE,EACTlB,EAAKgB,EAELf,EAAKgB,EACLf,EAAKe,EAAIE,EACThB,EAAK/I,EAAI+J,EACTf,EAAKhJ,EAELoL,EAAa3K,KAAK4K,EAClBM,IAAQP,EAAavK,EAAY+K,KACjCC,IAAQT,EAAavK,EAAYiL,QACjCC,IAAQX,EAAavK,EAAYmL,MACjCC,IAAQb,EAAavK,EAAYqL,OAEjC1F,EAAa/F,KAAKuG,EAClBgD,IAASxD,EAAajE,EAAY0H,UAClCC,IAAS1D,EAAajE,EAAY4H,WAClCC,IAAS5D,EAAajE,EAAY8H,aAClCC,IAAS9D,EAAajE,EAAYgI,cAGpCxC,EAAK,EACLyC,EAAK,EACLnC,EAAK,EAGT5H,KAAKwI,aAAclB,EAAIsB,EA/CZ,EA+C0BnB,EA1C1B,EA0CkCE,GAC7C3H,KAAKgK,cAAe1C,EAAIQ,EAAKoD,EAAII,EAAI/B,EAAKvB,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GACtEvI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUnB,EAAIoB,EAlD1B,EAkDkClB,GAC7C3H,KAAKkK,QAAS5C,EAAIQ,EAAKoD,EAAIjD,EAAIC,EAAIE,EAAIC,EAAIJ,EAAII,GAC/CrI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUE,EAAID,EA1D1B,EA0DkClB,GAC7C3H,KAAKgK,cAAe1C,EAAIQ,EAAKoD,EAAIM,EAAI/B,EAAKzB,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GACtEvI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAvEZ,EAuE0BnB,EAAIE,EAAIoB,GAC7C/I,KAAKkK,QAAS5C,EAAIQ,EAAKwD,EAAItD,EAAIC,EAAII,EAAIC,EAAIL,EAAII,GAC/CrI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUC,EAAIC,EAAInB,EAAIoB,GAC7C/I,KAAKkK,QAAS5C,EAAIQ,EAAK0D,EAAItD,EAAIC,EAAIE,EAAIC,EAAIJ,EAAII,GAC/CtI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAvFZ,EAuF0BnB,EAAIuB,EAAID,GAC7C/I,KAAKgK,cAAe1C,EAAIQ,EAAKsD,EAAIE,EAAI3B,EAAK3B,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,EAAIC,GACtEvI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUnB,EAAIoB,EAAIE,EAAIC,GAC7ChJ,KAAKkK,QAAS5C,EAAIQ,EAAKsD,EAAInD,EAAIC,EAAII,EAAIC,EAAIL,EAAII,GAC/CtI,KAAKiK,YAAarC,EAAIC,EAASkC,GAC/BzC,GAAM,EACNyC,GAAM,EACNnC,GAAM,EAGN5H,KAAKwI,aAAclB,EAAIsB,EAAUE,EAAID,EAAIG,EAAID,GAC7C/I,KAAKgK,cAAe1C,EAAIQ,EAAKsD,EAAII,EAAI3B,EAAK1B,EAAID,EAAID,EAAID,EAAIO,EAAID,EAAID,EAAID,GACtEpI,KAAKiK,YAAarC,EAAIC,EAASkC,GAE/B/J,KAAK2G,EAAchG,SACnBX,KAAK+G,EAAUpG,SACfX,KAAKiH,EAAatG,eA5RwBwJ,8BCK5C,WAAavE,EAAkBE,EAAoB6E,EAAyB5E,UAC3EC,YACC,IAAI6E,EAAyBjF,EAAS,IAAK,IAAKE,EAAY6E,EAAY5E,GACxE,IAAIqE,eAAcxE,UA+DrB,OAtEqC9F,OAWpCN,sBAAIkM,2BAAJ,WACC,OAAO1L,KAAKsK,OAAO1E,aAGpB,SAAaA,GACR5F,KAAKsK,OAAO1E,UAAYA,IAC3B5F,KAAKsK,OAAO1E,QAAUA,EACtB5F,KAAKuK,SAAS3E,QAAUA,oCAI1BpG,sBAAIkM,yBAAJ,WACC,OAAO1L,KAAKuK,SAASnI,WAGtB,SAAWA,GACVpC,KAAKuK,SAASnI,MAAQA,mCAGvB5C,sBAAIkM,0BAAJ,WACC,OAAO1L,KAAKuK,SAAS1E,YAGtB,SAAYA,GACX7F,KAAKuK,SAAS1E,OAASA,mCAGxBrG,sBAAIkM,8BAAJ,WACC,OAAO1L,KAAKuK,SAASzE,gBAGtB,SAAgBA,GACf9F,KAAKuK,SAASzE,WAAaA,mCAG5BtG,sBAAIkM,8BAAJ,WACC,OAAO1L,KAAKuK,SAASI,gBAGtB,SAAgBA,GACf3K,KAAKuK,SAASI,WAAaA,mCAG5BnL,sBAAIkM,8BAAJ,WACC,OAAO1L,KAAKuK,SAASxE,gBAGtB,SAAgBA,GACf/F,KAAKuK,SAASxE,WAAaA,mCAGlB2F,oBAAV,SAAmBlB,GAClBxK,KAAKuK,SAAS5J,SACdqF,YAAMyE,kBAASD,IAGhBkB,mBAAA,WACC1L,KAAKuK,SAAS5J,aApEqB+J,sBCHrC,4DAEA,OAFsC5K,UAAA4L,GCFzBC,EAAe,SAAEC,GAC7B,MAAO,6BAA6BC,KAAKD,iBCY1C,cAsEA,OAhEkBE,OAAjB,SAAuB3I,EAAgBQ,EAAgBoI,GACtD,IAAMC,EAAaC,KAAKC,IAAK,EAAG/I,EAASQ,GACnCwI,EAA4B,EAAbH,EAAiB,EAChCI,EAAmBD,EAAgB,EAATxI,EAC1BrE,EACL,KAAIqE,EAASqI,OAAcrI,EAC3B,KAAIA,EAASwI,OAAQxI,EACrB,KAAIA,EAASwI,QAAQxI,EAASwI,EAAOH,GAjBrB,SAAErI,EAAgBwI,EAAcX,GAClD,OAAS,EAAIA,EAAK,IAAIA,MAAMA,aAAY7H,EAASwI,EAAOX,QAAM7H,EAASwI,GAAS,GAiB9EE,CAAY1I,EAAQwI,EAAMH,GAC1B,IAAIrI,OAAUA,EAASwI,GACvB,IAAIxI,OAAUA,EAASqI,GAxBP,SAAErI,EAAgBwI,EAAcG,GAClD,OAAS,EAAIA,EAAK,IAAIA,MAAMA,aAAY3I,EAAS2I,OAAM3I,EAAW,GAwBhE4I,CAAY5I,EAAQwI,EAAMH,GAC1B,IACD,OAAOhM,KAAKwM,MAAOJ,EAAUL,EAAMzM,IAGnBwM,QAAjB,SAAwBM,EAAkBL,EAAczM,GACvD,IAAMmN,EAAaC,WAASC,WAItBf,EAAM,eAHgBQ,EAAWK,eACTL,EAAWK,oBACLL,MAAYA,gDAEtCL,SAAWzM,oBAErB,OAAOsN,UAAQC,KAAMlB,EAAcC,GAAO,CACzCa,gBAIeX,WAAjB,WACCzL,EAAcM,UAGRmL,gBAAP,SAAsB3I,GACrB,IAAM2J,EAAQ9M,KAAK+M,iBAEfnH,EAAUkH,EAAME,IAAK7J,GAOzB,OANe,MAAXyC,KACHA,EAAU5F,KAAKiN,KAAM9J,EAAQ,EAAGnD,KAAKkN,uBAC7BC,GAAI,SAAUnN,KAAKoN,UAC3BN,EAAMtH,IAAKrC,EAAQyC,IAGbA,GAGDkG,YAAP,SAAkB3I,EAAgBf,GACjC,IAAM0K,EAAQ9M,KAAKqN,aAEfC,EAAgBR,EAAME,IAAK7J,GACV,MAAjBmK,IACHA,EAAgB,IAAIC,IACpBT,EAAMtH,IAAKrC,EAAQmK,IAGpB,IAAI1H,EAAU0H,EAAcN,IAAK5K,GAOjC,OANe,MAAXwD,KACHA,EAAU5F,KAAKiN,KAAM9J,EAAQ,GAAMf,EAAOpC,KAAKwN,iBAAkBpL,KACzD+K,GAAI,SAAUnN,KAAKoN,UAC3BE,EAAc9H,IAAKpD,EAAOwD,IAGpBA,GAnESkG,mBAAyC,IAAIyB,IAC7CzB,uBAA+B,4BAC/BA,eAAkD,IAAIyB,IACtDzB,mBAAmB,SAAE1J,GAA2B,MAAA,2CAA2CA,yBCD5G,WAAaqL,GACZ,IAAMxK,EAASwK,EAAKxK,OACdyK,EAAezK,EAAO0K,YACtBC,EAAeF,EAAe,EAC9B3H,EAAa9C,EAAO4K,UACpBC,EAAkB9N,KAAK+N,EAAmB,IAAI1D,EACnDyB,EAAiBkC,cAAeN,GAChCE,EAAc7H,GAEf0H,EAAKQ,iBAAkBH,GAAiB,GAExC,IAAMrM,EAAQgM,EAAKhM,MAEbS,EAASuL,EAAKvL,OACdgM,EAAchM,EAAOiM,SAAU1M,GAC/BkJ,EAAazI,EAAO2L,QAASpM,GAC7B2M,EAAcpO,KAAKqO,EAAe,IAAI3C,EAC3CI,EAAiBwC,UAAWZ,EAAcQ,GAC1CN,EACAjD,EACA5E,GAED0H,EAAKQ,iBAAkBG,GAAa,GAEpC,IAAM3K,EAAUgK,EAAKhK,QACf8K,EAAe9K,EAAQ0K,SAAU1M,GACjC+M,EAAc/K,EAAQoK,QAASpM,GAC/BgN,EAAezO,KAAK0O,EAAgB,IAAIC,EAC7C7C,EAAiBwC,UAAWZ,EAAca,GAC1CX,EACAY,EACAzI,GAED0H,EAAKQ,iBAAkBQ,GAAc,GAErCzO,KAAK4O,EAA8BlB,EACnC1N,KAAK6O,EAA0BnB,EAC/B1N,KAAK8O,EAAmBZ,EACxBlO,KAAK+O,GAA2BrB,EAChC1N,KAAKgP,GAAoBT,EAEzBd,EAAKwB,cAAejP,MAsGtB,OAnGCkP,qBAAA,SAAUzB,EAAarL,EAAeyD,GACrC,IAAMpE,EAAQgM,EAAKhM,MACbwB,EAASwK,EAAKxK,OACdyK,EAAezK,EAAO0K,YACtBC,EAAeF,EAAe,EAC9B3H,EAAa9C,EAAO4K,UAGpB1M,EAAasM,EAAKtM,WAClB2M,EAAkB9N,KAAK+N,EACvBoB,EAAkBhO,EAAWiO,SAAU3N,GAC7C,GAAuB,MAAnB0N,EAA0B,CAC7B,IAAME,EAAkBlO,EAAWmO,SAAU7N,GACzC,EAAI4N,GACHrP,KAAK4O,IAAgClB,IACxC1N,KAAK4O,EAA8BlB,EACnCI,EAAgBlI,QAAUkG,EAAiBkC,cAAeN,GAC1DI,EAAgBhI,WAAa8H,GAE9BE,EAAgByB,KAAOJ,EACvBrB,EAAgBvM,MAAQ8N,EACxBvB,EAAgB1L,MAAQA,EACxB0L,EAAgBjI,OAASA,EACzBiI,EAAgB/H,WAAaA,EAC7B+H,EAAgB0B,SAAU,GAE1B1B,EAAgB0B,SAAU,OAG3B1B,EAAgB0B,SAAU,EAI3B,IAAMtN,EAASuL,EAAKvL,OACdkM,EAAcpO,KAAKqO,EACnBoB,EAAcvN,EAAOkN,SAAU3N,GACrC,GAAmB,MAAfgO,EAAsB,CACzB,IAAMC,EAAcxN,EAAOoN,SAAU7N,GACrC,GAAI,EAAIiO,EAAc,CACrB,IAAMxB,EAAchM,EAAOiM,SAAU1M,GACjCzB,KAAK6O,IAA4BnB,GAAgB1N,KAAK8O,IAAqBZ,IAC9ElO,KAAK6O,EAA0BnB,EAC/B1N,KAAK8O,EAAmBZ,EACxBE,EAAYxI,QAAUkG,EAAiBwC,UAAWZ,EAAcQ,GAChEE,EAAYtI,WAAa8H,GAE1B,IAAM+B,EAAczN,EAAO0N,SAAUnO,GAC/BkJ,EAAazI,EAAO2L,QAASpM,GACnC2M,EAAYmB,KAAOE,EACnBrB,EAAY7M,MAAQmO,EACpB,IAAMG,EAAeF,EAAczB,EACnCE,EAAY9I,GAAKuK,EACjBzB,EAAY7I,GAAKsK,EACjBzB,EAAYhM,MAAQA,EAAuB,EAAfyN,EAC5BzB,EAAYvI,OAASA,EAAwB,EAAfgK,EAC9BzB,EAAYzD,WAAaA,EACzByD,EAAYrI,WAAaA,EACzBqI,EAAYoB,SAAU,OAEtBpB,EAAYoB,SAAU,OAGvBpB,EAAYoB,SAAU,EAIvB,IAAM/L,EAAUgK,EAAKhK,QACfgL,EAAezO,KAAK0O,EACpBoB,EAAerM,EAAQ2L,SAAU3N,GACvC,GAAoB,MAAhBqO,EAAuB,CAC1B,IAAMC,EAAetM,EAAQ6L,SAAU7N,GACvC,GAAI,EAAIsO,EAAe,CACtB,IAAMxB,EAAe9K,EAAQ0K,SAAU1M,GACnCzB,KAAK+O,KAA6BrB,GAAgB1N,KAAKgP,KAAsBT,IAChFvO,KAAK+O,GAA2BrB,EAChC1N,KAAKgP,GAAoBT,EACzBE,EAAa7I,QAAUkG,EAAiBwC,UAAWZ,EAAca,GACjEE,EAAa3I,WAAa8H,GAE3B,IAAMY,EAAc/K,EAAQoK,QAASpM,GAC/BuO,EAAgBvM,EAAQwM,UAAWxO,GACnCyO,EAAezM,EAAQmM,SAAUnO,GACvCgN,EAAac,KAAOO,EACpBrB,EAAalN,MAAQwO,EACrB,IAAMI,EAA4BH,EAAgBE,EAAe3B,EACjEE,EAAanJ,GAAK6K,EAClB1B,EAAalJ,GAAK4K,EAClB1B,EAAarM,MAAQA,EAAoC,EAA5B+N,EAC7B1B,EAAa5I,OAASA,EAAqC,EAA5BsK,EAC/B1B,EAAa9D,WAAa6D,EAC1BC,EAAa1I,WAAaA,EAC1B0I,EAAae,SAAU,OAEvBf,EAAae,SAAU,OAGxBf,EAAae,SAAU,SV5J1B,SAAYhM,GACXA,mBACAA,yBACAA,uBACAA,6BACAA,yBACAA,gCACAA,kCACAA,gCACAA,+BACAA,6BACAA,6BACAA,4BACAA,4BACAA,gCACAA,0BAEAA,uCACAA,uCACAA,uCACAA,uCAEAA,8BAtBD,CAAYA,IAAAA,OWGZ,ICHY4M,eDGZ,cA6EA,OA5EQC,KAAP,SAAWxP,EAAoBY,GAC9B,OAA8B,IAApBZ,EAASY,IAGb4O,YAAP,SAAkBxP,GACjB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAW+M,UAGpCF,aAAP,SAAmBxP,GAClB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWgN,WAGpCH,YAAP,SAAkBxP,GACjB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWiN,UAGpCJ,cAAP,SAAoBxP,GACnB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWiN,QAAUjN,EAAWkN,aAGzDL,WAAP,SAAiBxP,GAChB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWmN,SAGpCN,aAAP,SAAmBxP,GAClB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWmN,OAASnN,EAAWoN,YAGxDP,cAAP,SAAoB5O,GACnB,OAAO4O,EAAYC,GAAI7O,EAAO+B,EAAWqN,YAAgBR,EAAYC,GAAI7O,EAAO+B,EAAWmN,SAGrFN,YAAP,SAAkBxP,GACjB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWsN,UAGpCT,aAAP,SAAmBxP,GAClB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWqN,WAGpCR,aAAP,SAAmBxP,GAClB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWuN,YAGpCV,eAAP,SAAqBxP,GACpB,OAASwP,EAAYC,GAAIzP,EAAQ2C,EAAWqN,SAAWrN,EAAWuN,YAG5DV,YAAP,SAAkBxP,GACjB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWwN,UAGpCX,cAAP,SAAoBxP,GACnB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAWyN,YAGpCZ,WAAP,SAAiBxP,GAChB,OAAOwP,EAAYC,GAAIzP,EAAQ2C,EAAW0N,SAGpCb,OAAP,SACCc,EAA8BC,EAC9BC,EAAyBC,GAEzBH,EAAYI,SAAUH,EAAkBE,EAAMD,EAAO5P,QACrD4P,EAAOlE,GAAI,eAAe,SAAEqE,GAC3BL,EAAYI,SAAUH,EAAkBE,EAAME,QAIzCnB,UAAP,SACCc,EAA8BE,EAC9BC,gBAAAA,EAA+CjB,EAAYoB,aAE3DpB,EAAYqB,KAAMP,EAAa3N,EAAWqN,SAAUQ,EAAQC,UC9E9D,SAAYlB,GACXA,mBAKAA,+BAKAA,qBAXD,CAAYA,IAAAA,OCGZ,ICAWuB,eDAX,cAoBA,OAnBCC,oBAAA,WACC,OAAO,GAGRA,iBAAA,WACC,MAAM,IAAInR,MAAM,4BAGjBmR,iBAAA,WACC,MAAM,IAAInR,MAAM,4BAGjBmR,oBAAA,aAIAA,oBAAA,WACC,OAAOxB,EAAayB,WAAazB,EAAa0B,yBElBhD,cAoBA,OAnBCC,oBAAA,WACC,MAAM,IAAItR,MAAO,kBAGlBsR,iBAAA,WACC,MAAM,IAAItR,MAAO,kBAGlBsR,iBAAA,WACC,MAAM,IAAItR,MAAO,kBAGlBsR,oBAAA,aAIAA,oBAAA,WACC,OAAO3B,EAAayB,8BClBtB,cAoBA,OAnBCG,oBAAA,WACC,MAAM,IAAIvR,MAAO,kBAGlBuR,iBAAA,WACC,MAAM,IAAIvR,MAAO,kBAGlBuR,iBAAA,WACC,MAAM,IAAIvR,MAAO,kBAGlBuR,oBAAA,aAIAA,oBAAA,WACC,OAAO5B,EAAayB,iBCbhBI,EAAoB,SAAEC,GAC3B,OAA2D,IAAlDA,EAAQC,UAAY/B,EAAayB,2BAa1C,aAAA,MACC7L,0BAEAG,EAAKiM,GAAY,EACjBjM,EAAKkM,GAAQ,GACblM,EAAKmM,GAAW,GAChBnM,EAAKoM,GAAa,OAkLpB,OA9L+CzS,OAe9C0S,iBAAA,WACC,IAAMC,EAAOzS,KAAKqS,GACZK,EAAU1S,KAAKsS,GAErB,OAAII,EAAQC,QAAU,EACjB,EAAIF,EAAKE,OACLF,EAAMA,EAAKE,OAAS,GAEpB,KAGDD,EAASA,EAAQC,OAAS,IAInCH,iBAAA,SAAMN,GACWlS,KAAKsS,GACbM,KAAMV,GACdlS,KAAK6S,QAGNL,iBAAA,WAAA,WACC,GAAuB,MAAnBxS,KAAKuS,GAAqB,CAC7B,IAAMG,EAAU1S,KAAKsS,GACrB,GAAI,EAAII,EAAQC,OAAS,CACxB,IAAMG,EAAUJ,EAAQK,QACxB,GAAe,MAAXD,EACH,GAAIA,aAAmBd,EAAe,CACrC,IAAMS,EAAOzS,KAAKqS,GAClB,GAAIrS,KAAKoS,GAAYK,EAAKE,OAAS,CAClC,IAAMK,EAAUP,EAAMA,EAAKE,OAAS,EAAI3S,KAAKoS,IAC7CpS,KAAKoS,IAAa,EAClBpS,KAAKiT,KAAM,SAAUjT,OAEN,KADTO,EAASyS,EAAQE,QAEtBlT,KAAKmT,UAAWL,IACK,IAAXvS,EACVP,KAAKoT,OAAQN,GAEb9S,KAAKuS,GAAahS,EAAO8S,MAAK,WAC7BlN,EAAKgN,UAAWL,MACd,WACF3M,EAAKiN,OAAQN,YAIV,GAAIA,aAAmBf,EACvBU,EAAOzS,KAAKqS,GACd,EAAIrS,KAAKoS,KACNY,EAAUP,EAAMA,EAAKE,OAAS3S,KAAKoS,IACzCpS,KAAKoS,IAAa,EAClBpS,KAAKiT,KAAM,SAAUjT,OAEN,KADTO,EAASyS,EAAQM,QAEtBtT,KAAKmT,UAAWL,IACK,IAAXvS,EACVP,KAAKoT,OAAQN,GAEb9S,KAAKuS,GAAahS,EAAO8S,MAAK,WAC7BlN,EAAKgN,UAAWL,MACd,WACF3M,EAAKiN,OAAQN,WAIV,CACN,IAWMvS,EAXAgT,EApF2C,IAoFjBT,EApFpBX,UAAY/B,EAAa0B,OAqF/B0B,EAAavB,EAAmBa,GACtC,GAAIS,GAAWC,EAAa,CAC3B,IAAMrH,EAASoH,EAAUvT,KAAKqS,GAAMM,OAAS3S,KAAKoS,GAC9C,EAAIjG,IACPnM,KAAKyT,OAAQtH,GACbnM,KAAKoS,GAAY,EACjBpS,KAAKiT,KAAM,SAAUjT,OAEtBA,KAAK0T,WAGS,KADTnT,EAASuS,EAAQa,WAEtB3T,KAAKmT,UAAWL,IACK,IAAXvS,EACVP,KAAKoT,OAAQN,GAEb9S,KAAKuS,GAAahS,EAAO8S,MAAK,WAC7BlN,EAAKgN,UAAWL,MACd,WACF3M,EAAKiN,OAAQN,UASVN,oBAAV,WACC,IAAMC,EAAOzS,KAAKqS,GACZlG,EAAOsG,EAAKE,OAAS,IAC3B,GAAI,EAAIxG,EACP,IAAK,IAAIyH,EAAI,EAAGA,EAAIzH,IAAQyH,EAC3BnB,EAAMmB,GAAIC,UACVpB,EAAKM,SAKEP,mBAAV,SAAkBrG,GACjB,IAAMsG,EAAOzS,KAAKqS,GAClB,GAAI,EAAIlG,EAAO,CACd,IAAM2H,EAAQ7H,KAAKC,IAAK,EAAGuG,EAAKE,OAASxG,GAEzC,GAAI,GADJA,EAAOsG,EAAKE,OAASmB,GACN,CACd,IAAK,IAAIF,EAAIE,EAAOC,EAAOtB,EAAKE,OAAQiB,EAAIG,IAAQH,EACnDnB,EAAMmB,GAAIC,UAIX,OADApB,EAAKuB,OAAQF,EAAOrB,EAAKE,OAASmB,IAC3B,GAGT,OAAO,GAGEtB,sBAAV,SAAqBN,GACpBlS,KAAKuS,GAAa,KACdN,EAAmBC,IACtBlS,KAAKqS,GAAMO,KAAMV,GACjBlS,KAAKiT,KAAM,QAASjT,QACVkS,aAAmBF,GAAgBE,aAAmBH,IAChE/R,KAAKiT,KAAM,QAASjT,MAErBA,KAAKiT,KAAM,SAAUjT,MACrBA,KAAK6S,QAGIL,mBAAV,SAAkBN,GACjBlS,KAAKuS,GAAa,KAClB,IAAMG,EAAU1S,KAAKsS,GACrBJ,EAAQ2B,UACR,IAAK,IAAID,EAAI,EAAGG,EAAOrB,EAAQC,OAAQiB,EAAIG,IAAQH,EAClDlB,EAASkB,GAAIC,UAEdnB,EAAQC,OAAS,EACjB3S,KAAKiT,KAAM,SAAUjT,OAGtBwS,iBAAA,WACC,OAAOxS,KAAKqS,GAAMM,QAGnBH,kBAAA,WACCxS,KAAK4S,KAAM,IAAIhB,IAGhBY,iBAAA,WACKxS,KAAKiU,eACRjU,KAAKsS,GAASM,KAAM,IAAIb,GACxB/R,KAAK6S,SAIPL,iBAAA,WACKxS,KAAKkU,eACRlU,KAAKsS,GAASM,KAAM,IAAIZ,GACxBhS,KAAK6S,SAIPL,uBAAA,WACC,OAAS,EAAIxS,KAAKoS,IAAgC,MAAnBpS,KAAKuS,IAGrCC,uBAAA,WACC,OAASxS,KAAKoS,GAAYpS,KAAKqS,GAAMM,QAA6B,MAAnB3S,KAAKuS,OA5LP4B,QAAMC,cCX/CC,EAAc,SAAExT,GACrB,OAAmB,MAAVA,GAAmB,aAAcA,GAGrCyT,EAAuB,SAAEzT,GAC9B,OAAmB,MAAVA,GAAkB,aAAcA,GAOpC0T,EAAe,SAAE1T,GACtB,OAAmB,MAAVA,GAAkB,WAAYA,gBAGxC,aACSb,QAA8B,KAmMvC,OAjMCwU,uBAAA,SAAYC,EAA8BC,EAAoBC,GAC7D,GAAID,EAAY,CACf,IAAME,EAAW5U,KAAK6U,GACtB,OAAID,IAAaH,GACA,MAAZG,GACHA,EAASrD,SAAU/N,EAAWiN,SAAS,GAGxCzQ,KAAK6U,GAAWJ,EACC,MAAbA,GAAqBzU,KAAKqU,YAAaI,KAC1CA,EAAUlD,SAAU/N,EAAWiN,SAAS,GACpCkE,GAAUJ,EAAcE,IAC3BA,EAAUE,UAGLC,GAEA,KAGR,OAAiB,MAAbH,GAAqBzU,KAAK6U,KAAaJ,GAC1CA,EAAUlD,SAAU/N,EAAWiN,SAAS,GACpCkE,GAAUJ,EAAcE,IAC3BA,EAAUE,SAEJF,GAEA,MAKVD,uBAAA,WACC,OAAOxU,KAAK6U,IAGbL,gCAAA,SAAqBM,GAEpB,IADA,IAAI9B,EAA0D8B,EAC5C,MAAX9B,GAAkB,CACxB,GAAIhT,KAAKqU,YAAarB,GACrB,OAAOA,EAEPA,EAAUA,EAAQ+B,OAGpB,OAAO,MAGEP,wBAAV,SAAuB3T,GACtB,OACCwT,EAAaxT,KACXA,EAAOmU,SAAUxR,EAAWqN,SAAWrN,EAAWyR,cACpDpU,EAAO2O,SAICgF,wBAAV,SAAuB3T,GACtB,OACCwT,EAAaxT,IACbA,EAAOmU,SAAUxR,EAAW0R,aAC5BrU,EAAO2O,SAITgF,0BAAA,SACC3T,EAA2BsU,EAAyBC,EAAiCC,GAErF,GAAIA,EAAY,CAEf,GAAc,OADR9U,EAASP,KAAKsV,kBAAmBzU,EAAQsU,EAAgBC,IAE9D,OAAO7U,EAGR,IAAMgV,EAAS1U,EAAOkU,OACtB,GAAc,MAAVQ,GAGC,IADEC,GADAC,EAAWF,EAAOE,UACDC,QAAS7U,IACf,CAEhB,IAAK,IAAI+S,EAAI4B,EAAQ,EAAGzB,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAE3D,GAAa,OADP+B,EAAQ3V,KAAKsV,kBAAmBG,EAAU7B,IAAK,GAAM,IAE1D,OAAO+B,EAGT,GAAI3V,KAAK4V,YAAaL,GACrB,IAAS3B,EAAI,EAAGG,EAAOyB,EAAQ,EAAG5B,EAAIG,IAAQH,EAE7C,GAAa,OADP+B,EAAQ3V,KAAKsV,kBAAmBG,EAAU7B,IAAK,GAAM,IAE1D,OAAO+B,EAMV,OAAO3V,KAAK6V,cAAeN,GAAQ,GAAO,GAAO,QAG7C,CACN,IAAMhV,EACN,GAAc,OADRA,EAASP,KAAK8V,sBAAuBjV,EAAQsU,EAAgBC,IAElE,OAAO7U,EAGR,IAEOkV,EACAD,EAHDO,EAASlV,EAAOkU,OACtB,GAAc,MAAVgB,GAGC,IADEP,GADAC,EAAWM,EAAON,UACDC,QAAS7U,IACf,CAEhB,IAAS+S,EAAI4B,EAAQ,EAAG,GAAK5B,IAAKA,EAEjC,GAAa,OADP+B,EAAQ3V,KAAK8V,sBAAuBL,EAAU7B,IAAK,GAAM,IAE9D,OAAO+B,EAGT,GAAI3V,KAAK4V,YAAaG,GAAW,CAChC,IAASnC,EAAI6B,EAAS9C,OAAS,EAAG6C,GAAS5B,IAAKA,EAAI,CACnD,IAAM+B,EACN,GAAa,OADPA,EAAQ3V,KAAK8V,sBAAuBL,EAAU7B,IAAK,GAAM,IAE9D,OAAO+B,EAGT,OAAOI,EAIR,OAAO/V,KAAK6V,cAAeE,GAAQ,GAAM,GAAO,IAInD,OAAO,MAGEvB,8BAAV,SACC3T,EAA2BsU,EAAyBC,GAGpD,GAAID,GACCnV,KAAKqU,YAAaxT,GACrB,OAAOA,EAKT,GAAIuU,GAA0Bd,EAAsBzT,IAAYA,EAAO2O,QAEtE,IADA,IAAMiG,EAAW5U,EAAO4U,SACf7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM+B,EAAQ3V,KAAKsV,kBAAmBG,EAAU7B,IAAK,GAAM,GAC3D,GAAa,MAAT+B,EACH,OAAOA,EAMV,OAAI3V,KAAK4V,YAAa/U,GACdA,EAID,MAGE2T,kCAAV,SACC3T,EAA2BsU,EAAyBC,GAGpD,GAAIA,GAA0Bd,EAAsBzT,IAAYA,EAAO2O,QAEtE,IADA,IAAMiG,EAAW5U,EAAO4U,SACf7B,EAAI6B,EAAS9C,OAAS,EAAG,GAAKiB,IAAKA,EAAI,CAC/C,IAAM+B,EAAQ3V,KAAK8V,sBAAuBL,EAAU7B,IAAK,GAAM,GAC/D,GAAa,MAAT+B,EACH,OAAOA,EAMV,OAAIR,GACCnV,KAAKqU,YAAaxT,GACdA,EAKLb,KAAK4V,YAAa/U,GACdA,EAID,wBC3FT,cAiIA,OAhIQmV,gBAAP,SAAsBC,GACrB,MAAmB,UAAVA,EAAEC,KAA6B,UAAVD,EAAEC,KAA+B,KAAZD,EAAEE,OAA4B,KAAZF,EAAEE,OAGjEH,eAAP,SAAqBC,GACpB,MAAmB,YAAVA,EAAEC,KAAiC,KAAZD,EAAEE,OAG5BH,iBAAP,SAAuBC,GACtB,MAAmB,cAAVA,EAAEC,KAAmC,KAAZD,EAAEE,OAG9BH,iBAAP,SAAuBC,GACtB,MAAmB,cAAVA,EAAEC,KAAmC,KAAZD,EAAEE,OAG9BH,kBAAP,SAAwBC,GACvB,MAAmB,eAAVA,EAAEC,KAAoC,KAAZD,EAAEE,OAG/BH,cAAP,SAAoBC,GACnB,MAAmB,QAAVA,EAAEC,KAA6B,KAAZD,EAAEE,OAGxBH,aAAP,SAAmBC,GAClB,MAAmB,QAAVA,EAAEC,KAA6B,IAAZD,EAAEE,OAGxBH,YAAP,SAAkBC,GACjB,OAASA,EAAEG,UAAuB,MAAVH,EAAEC,KAA2B,KAAZD,EAAEE,QAGrCH,YAAP,SAAkBC,GACjB,OAASA,EAAEG,UAAuB,MAAVH,EAAEC,KAA2B,KAAZD,EAAEE,QAGrCH,YAAP,SAAkBC,GACjB,OAASA,EAAEG,UAAaH,EAAEI,WAAwB,MAAVJ,EAAEC,KAA2B,KAAZD,EAAEE,QAGrDH,cAAP,SAAoBC,GACnB,OAASA,EAAEG,SAAWH,EAAEI,WAAwB,MAAVJ,EAAEC,KAA2B,KAAZD,EAAEE,QAGnDH,cAAP,SAAoBC,GACnB,MAAmB,WAAVA,EAAEC,KAAgC,KAAZD,EAAEE,OAG3BH,iBAAP,SAAuBC,GACtB,OAASA,EAAEG,UAAaH,EAAEI,WAAwB,MAAVJ,EAAEC,KAA2B,KAAZD,EAAEE,QAGrDH,UAAP,SAAgBC,GACf,MAAmB,UAAVA,EAAEC,KAA+B,KAAZD,EAAEE,OAG1BH,oBAAP,SAA0BC,GACzB,OAAwB,IAAfA,EAAEI,UAGLL,aAAP,SAAmBM,GAClB,GAAMvU,EAAcuU,GAEb,CACN,IAGIC,EAHEC,EAAaF,EACbG,EAAaD,EAAWd,QAAQ,MAClCgB,SAEA,GAAKD,GACRC,EAAgBF,EAAWG,UAAW,EAAGF,GAAaG,OACtDL,EAAQC,EAAWG,UAAWF,EAAa,GAAIG,QAE/CF,EAAgBF,EAAWI,OAE5B,IAAMC,EAAOH,EAAcI,cAAcC,MAAO,KAKhD,OAhM4B,SAAEC,GAChC,IAAMd,EAAMc,EAASd,IACrB,GAAIA,EAAIvD,QAAU,EAAI,CACjBqE,EAASjE,QACZiE,EAASd,IAAMA,EAAIe,eAEpB,IAAMC,EAAOhB,EAAIiB,WAAY,GAG5BH,EAASb,MAFN,IAAMe,GAAQA,GAAQ,IAERA,EAAO,GAEPA,OAGlB,OAAQhB,GACR,IAAK,QACJc,EAASb,MAAQ,GACjB,MACD,IAAK,QACJa,EAASd,IAAM,IACfc,EAASb,MAAQ,GACjB,MACD,IAAK,SACJa,EAASb,MAAQ,GACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,KACJa,EAASb,MAAQ,IACjB,MACD,IAAK,MACJa,EAASb,MAAQ,IACjB,MACD,IAAK,MACJa,EAASb,MAAQ,IACjB,MACD,IAAK,MACJa,EAASb,MAAQ,IACjB,MACD,IAAK,WACAa,EAASjE,MACZiE,EAASb,MAAQ,GAEjBa,EAASb,MAAQ,IAElB,MACD,IAAK,UACJa,EAASb,MAAQ,GACjB,MACD,IAAK,YACJa,EAASb,MAAQ,GACjB,MACD,IAAK,YACJa,EAASb,MAAQ,GACjB,MACD,IAAK,aACJa,EAASb,MAAQ,GACjB,MACD,IAAK,SACJa,EAASb,MAAQ,GACjB,MACD,IAAK,SACJa,EAASb,MAAQ,GACjB,MACD,IAAK,SACJa,EAASb,MAAQ,GACjB,MACD,IAAK,WACJa,EAASb,MAAQ,GACjB,MACD,IAAK,YACJa,EAASb,MAAQ,EACjB,MACD,IAAK,IACJa,EAASb,MAAQ,IACjB,MACD,IAAK,QACJa,EAASb,MAAQ,GACjB,MACD,IAAK,aACJa,EAASb,MAAQ,IACjB,MACD,IAAK,MACJa,EAASb,MAAQ,EAInB,OAAOa,EAmFEI,CAAuB,CAC7BC,IALoB,GAAKR,EAAKnB,QAAS,OAMvC4B,KALqB,GAAKT,EAAKnB,QAAS,QAMxC3C,MALsB,GAAK8D,EAAKnB,QAAS,SAMzCQ,IALmBW,EAAMA,EAAKlE,OAAS,GAMvCwD,MAAO,EACPoB,UAvBD,OAAOjB,GA4BFN,WAAP,SAAiBgB,GAChB,IAAMQ,EAAQ,GAWd,OAVIR,EAASM,MACZE,EAAM5E,KAAM,QAEToE,EAASjE,OACZyE,EAAM5E,KAAM,SAEToE,EAASK,KACZG,EAAM5E,KAAM,OAEb4E,EAAM5E,KAAMoE,EAASd,IAAIe,eAClBO,EAAMC,KAAM,MAGbzB,KAAP,SACCnV,EACAyV,EACAoB,GAEA,IAAMV,EAAWhX,KAAK2X,WAAYrB,GAClCsB,SAASC,KAAKC,iBAAkB,WAAW,SAAE7B,GAE3CA,EAAE8B,SAAWf,EAASK,KAAOpB,EAAEG,UAAYY,EAASM,MACpDrB,EAAEI,WAAaW,EAASjE,OACtBkD,EAAEC,MAAQc,EAASd,KAAOD,EAAEE,QAAUa,EAASb,QAE7CtV,EAAOmX,iBACY,MAAlBhB,EAASO,MACZ1W,EAAOoS,KAAM+D,EAASO,OACD,MAAXG,GACVA,EAASzB,IAGXA,EAAEgC,yCCpPN,4DA2DA,OA3DyCnY,OACxCoY,iBAAA,SAAMC,EAAsBC,EAAkBC,GAA9C,WACCF,EAAQL,iBAAkB,WAAW,SAAE7B,GACtC9P,EAAK8M,KAAM,UAAWgD,GAEtB,IAAMqC,EAAUD,EAAgBE,aAChC,GAAe,MAAXD,EAEH,IADA,IAAItF,EAAmDsF,EACrC,MAAXtF,GAAkB,CACxB,GAAI7M,EAAKqS,aAAcxF,IAClBA,EAAQyF,UAAWxC,GACtB,OAGFjD,EAAUA,EAAQ+B,OAIpB,GAAIiB,EAAkB0C,WAAYzC,GAAM,CACvC,IAAMZ,EAAYW,EAAkB2C,kBAAmB1C,GACjDpD,EAAoB,MAAXyF,EACdD,EAAgBxC,cACfyC,GAAS,EAAOA,EAAQtD,SAAUxR,EAAW0R,aAAgBG,EAAWA,GAEzEgD,EAAgBxC,cAAeuC,GAAO,GAAO,EAAM/C,GAExC,MAARxC,IACHwF,EAAgBO,WAAY/F,GAAM,GAAM,GACxCoD,EAAEgC,iBACFhC,EAAE4C,gCAKLV,EAAQL,iBAAkB,SAAS,SAAE7B,GACpC9P,EAAK8M,KAAM,QAASgD,GAEpB,IAAMqC,EAAUD,EAAgBE,aAChC,GAAe,MAAXD,EAEH,IADA,IAAItF,EAAmDsF,EACrC,MAAXtF,GAAkB,CACxB,GAAI7M,EAAK2S,WAAY9F,IAChBA,EAAQ+F,QAAS9C,GACpB,OAGFjD,EAAUA,EAAQ+B,YAMZmD,yBAAV,SAAwBrX,GACvB,MAAO,cAAeA,GAGbqX,uBAAV,SAAsBrX,GACrB,MAAO,YAAaA,MAzDmBsT,QAAMC,2BCG/C,cA+DA,OAxDQ4E,qBAAP,WAIC,OAHkB,MAAdhZ,KAAKiZ,QACRjZ,KAAKiZ,MAAQ,IAAIzE,GAEXxU,KAAKiZ,OAGND,qBAAP,SAA2B1Y,GAC1B,IAAMC,EAASP,KAAKiZ,MAEpB,OADAjZ,KAAKiZ,MAAQ3Y,EACNC,GAIDyY,wBAAP,WAIC,OAHqB,MAAjBhZ,KAAKkZ,WACRlZ,KAAKkZ,SAAW,IAAIhB,GAEdlY,KAAKkZ,UAGNF,wBAAP,SAA8B1Y,GAC7B,IAAMC,EAASP,KAAKkZ,SAEpB,OADAlZ,KAAKkZ,SAAW5Y,EACTC,GAIDyY,uBAAP,WAIC,OAHoB,MAAhBhZ,KAAKmZ,UACRnZ,KAAKmZ,QAAU,IAAI3G,GAEbxS,KAAKmZ,SAGNH,uBAAP,SAA6B1Y,GAC5B,IAAMC,EAASP,KAAKmZ,QAEpB,OADAnZ,KAAKmZ,QAAU7Y,EACRC,GAIDyY,wBAAP,WACC,GAAqB,MAAjBhZ,KAAKoZ,SACR,MAAM,IAAI3Y,MAAO,iBAElB,OAAOT,KAAKoZ,UAGNJ,wBAAP,SACC1Y,GAEA,IAAMC,EAASP,KAAKoZ,SAEpB,OADApZ,KAAKoZ,SAAW9Y,EACTC,SPlET,SAAWoR,GAEVA,mBACAA,qBACAA,+BAGAA,iCACAA,mCAEAA,mBACAA,qBAEAA,iBACAA,iBACAA,iBACAA,kBAGAA,wBACAA,oBACAA,0BACAA,0BACAA,wBAvBD,CAAWA,IAAAA,OA2EX,IQvEW0H,ERuELC,EAA8E,CACnFC,MACAC,MACAC,MACAC,OACAC,MACAC,OAGKC,EAA4E,CACjFC,OACAC,KACAna,KACAmI,mBA+BA,WAAayO,GACZ,IAAMwD,EAAuBha,KAAKia,QAASzD,GAK3C,GAJAxW,KAAKka,aAAcF,EAAO,GAC1Bha,KAAKma,QAASH,GACdha,KAAKoa,aAAcJ,QACnBha,KAAKoa,aAAcJ,OACE,IAAjBA,EAAMrH,OAAe,CACxB,IAAM0H,EAAOL,EAAO,GACpB,IAAMhX,EAAcqX,GAEnB,YADAra,KAAKsa,GAAQD,GAIf,MAAM,IAAI5Z,MAAO,oBAAoB+V,OA4KvC,OAzKC+D,yBAAA,SAAcP,EAAsBnN,GACnC,IAAK,IAAI+G,EAAI/G,EAAMkH,EAAOiG,EAAMrH,OAAQiB,EAAIG,IAAQH,EAEnD,OADcoG,EAAOpG,GACS,CAC7B,IAAK,IAAI4G,EAAI5G,EAAI,EAAG6G,EAAOT,EAAMrH,OAAQ6H,EAAIC,IAAQD,EAEpD,OADcR,EAAOQ,IAErB,OACC,IAAME,EAAUV,EAAMhG,OAAQJ,EAAI,EAAG4G,EAAI5G,GAGzC,OAFA8G,EAAQ/H,QAAU,OAClBqH,EAAOpG,GAAM,GAAuB8G,IAErC,OACC1a,KAAKka,aAAcF,EAAOQ,GAC1BC,EAAOT,EAAMrH,OAKf,MAAM,IAAIlS,MAAO,0BAKpB8Z,wBAAA,SAAaF,GACNrX,EAAcqX,QAAUA,EAAM,IACnCra,KAAKma,QAASE,EAAM,KAItBE,oBAAA,SAASP,GACR,IAAK,IAAIpG,EAAI,EAAGG,EAAOiG,EAAMrH,OAAQiB,EAAIG,IAAQH,EAAI,CACpD,IAAMyG,EAAOL,EAAOpG,GACpB,OAAIyG,OAAiCA,EACpC,GAAIzG,GAAK,GAAK5Q,EAAcgX,EAAOpG,EAAI,IAAQ,CAC9C,KAAIA,EAAI,EAAIG,IAAU/Q,EAAcgX,EAAOpG,EAAI,IAO9C,MAAM,IAAInT,MAAO,4BANjB,IAAMia,EAAUV,EAAMhG,OAAQJ,EAAI,EAAG,GAAK,GACpC+G,MAASN,MACfL,EAAOpG,GAAM,CAAE+G,EAAMD,GACrB3G,EAAOiG,EAAMrH,OACb3S,KAAK4a,YAAaF,QAKbC,MAASN,MACfL,EAAOpG,GAAM+G,OAGd3a,KAAK4a,YAAaP,GAClBtG,EAAOiG,EAAMrH,SAKhB4H,6BAAA,SAAkBF,EAAmBQ,EAAmCC,GACjE9X,EAAcqX,SACfA,EAAM,GACTra,KAAKoa,aAAcC,EAAM,GAAKQ,EAAWC,OAC/BT,EAAM,QAAyBA,EAAM,GAC/Cra,KAAK+a,iBAAkBV,EAAM,GAAKQ,EAAWC,OACnCT,EAAM,QAAwBA,EAAM,QAC9CA,EAAM,SAAwBA,EAAM,KACpCra,KAAK+a,iBAAkBV,EAAM,GAAKQ,EAAWC,GAC7C9a,KAAK+a,iBAAkBV,EAAM,GAAKQ,EAAWC,MAKhDP,yBAAA,SAAcP,EAAsBa,EAAmCC,GACtE,IAAK,IAAIlH,EAAI,EAAGG,EAAOiG,EAAMrH,OAAQiB,EAAIG,IAAQH,EAAI,CACpD,IAAMyG,EAAOL,EAAOpG,GACpB,GAAIyG,IAASQ,GAAaR,IAASS,EAAY,CAC9C,GAAI,EAAIlH,GAAKA,EAAI,EAAIG,EAAO,CAC3B,IAAMvP,EAAOwV,EAAOpG,EAAI,GAClBlP,EAAQsV,EAAOpG,EAAI,GACzB,IAAM5Q,EAAcwB,KAAYxB,EAAc0B,GAAU,CACvDsV,EAAMhG,OAAQJ,EAAG,GACjBoG,EAAOpG,EAAI,GAAM,CAAEyG,EAAM7V,EAAME,GAC/BkP,GAAK,EACLG,EAAOiG,EAAMrH,OACb3S,KAAK+a,iBAAkBvW,EAAMqW,EAAWC,GACxC9a,KAAK+a,iBAAkBrW,EAAOmW,EAAWC,GACzC,UAGF,MAAM,IAAIra,MAAO,uCAAuC4Z,GAExDra,KAAK+a,iBAAkBV,EAAMQ,EAAWC,GACxC/G,EAAOiG,EAAMrH,SAKhB4H,oBAAA,SAAS/D,GAGR,IAFA,IAAMwE,EAAa,iDACbC,EAAkB,KACV,CACb,IAAMC,EAAUF,EAAWG,KAAM3E,GACjC,GAAe,MAAX0E,EAmBH,MAlBA,IAAME,EAAQF,EAAS,GACjBG,EAAoB/B,EAAwB8B,GAClD,GAAyB,MAArBC,EACHJ,EAAOrI,KAAMyI,OACP,CACN,IAAMC,EAAcC,WAAYH,GAChC,GAAIE,GAAgBA,EACnB,MAAM,IAAI7a,MAAO,qBAAqB2a,UAAaF,EAAQ1F,cAAagB,OAGzE,IAAMgF,EAAmB3B,EAAuBuB,EAAOA,EAAMzI,OAAS,IAC9C,MAApB6I,EACHP,EAAOrI,KAAK,CAAE4I,EAAgC,IAAdF,IAEhCL,EAAOrI,KAAK,IAAmB0I,KAOnC,OAAOL,GAGEV,qBAAV,SAAoBF,EAAYtF,EAAgB0G,EAActX,EAAiB6O,GAC9E,OAAQqH,EAAM,IACd,OACC,OAAOra,KAAK0b,SAAUrB,EAAM,GAAK,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GAG9D,OACC,OAAShT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GAE3D,OACC,OAAShT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GAG3D,OACC,OAAOhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GACvDhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GACnD,OACC,OAAOhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GACvDhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GACnD,OACC,OAAOhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GACvDhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GACnD,QACC,OAAOhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GACvDhT,KAAK0b,SAAUrB,EAAM,GAAKtF,EAAQ0G,EAAMtX,EAAS6O,GAGnD,QACC,OAAOqH,EAAM,GAAMtF,EACpB,QACC,OAAOsF,EAAM,GAAMoB,EACpB,QACC,OAAOpB,EAAM,GAAMlW,EACpB,QACC,OAAOkW,EAAM,GAAMrH,EACpB,QACC,OAAOqH,EAAM,GAGd,OAAO,GAGRE,sBAAA,SAAWxF,EAAgB0G,EAActX,EAAiB6O,GACzD,OAAOhT,KAAK0b,SAAU1b,KAAKsa,GAAOvF,EAAQ0G,EAAMtX,EAAS6O,sBS1S3D,cAqDA,OA1CQ2I,WAAP,SAAiBC,GAChB,OAAO5b,KAAK6M,KAAM+O,GAAY,IAGxBD,OAAP,SAAaC,GACZ,OAAO5b,KAAK6M,KAAM+O,GAAY,IAGdD,OAAjB,SAAuBC,EAAqCC,GAC3D,GAAkB,MAAdD,GAAsB5Y,EAAc4Y,GACvC,OAAO,KACD,GAAI7Z,EAAc6Z,GAAe,CACvC,GAAIC,EACH,OAAQD,GACR,IAAK,SACJ,OAAOD,EAAiBG,SAASC,OAClC,IAAK,UACJ,OAAOJ,EAAiBG,SAASE,aAGlC,OAAQJ,GACR,IAAK,OACL,IAAK,YACJ,OAAOD,EAAiBM,KAAKC,UAC9B,IAAK,UACJ,OAAOP,EAAiBM,KAAKD,QAI/B,IAAMG,EAAmB,IAAI5B,EAAmBqB,GAChD,OAAO,SAAE7G,EAAgB0G,EAActX,EAAiB6O,GACvD,OAAOmJ,EAAiBC,UAAWrH,EAAQ0G,EAAMtX,EAAS6O,IAErD,GAAIpS,EAAgBgb,GAC1B,OAAOA,EAEP,IAAMS,EAAST,EACf,OAAO,SAAE7G,EAAgB0G,EAActX,EAAiB6O,GACvD,OAAOqJ,EAAOD,UAAWrH,EAAQ0G,EAAMtX,EAAS6O,KAhD5C2I,WAAW,CACjBK,QAAS,SAAEpc,EAAWma,EAAWza,GAAe,OAAAA,GAChDyc,OAAQ,SAAEnc,EAAWma,GAAe,MAAY,IAAVna,EAAIma,KAGpC4B,OAAO,CACbO,UAAW,SAAEtc,GAAe,OAAAA,GAC5Boc,QAAS,SAAEpc,EAAWma,EAAWza,GAAe,OAAAM,EAAIN,UDRtD,SAAW+Z,GACVA,mBACAA,qBACAA,uBAHD,CAAWA,IAAAA,OAMX,IEbYiD,eFkBX,WAAa7O,EAAuB8O,GACnCvc,KAAKwc,GAAQ/O,EACbzN,KAAKyc,GAAaF,EAClBvc,KAAK0c,KA8HP,OA3HCld,sBAAImd,qBAAJ,WACC,IAAMJ,EAAYvc,KAAKyc,GACvB,OAAmB,MAAfF,EAAUjX,EACNiX,EAAUjX,EAEVtF,KAAKwc,GAAMlX,OAIpB,SAAOA,GACN,IAAMmI,EAAOzN,KAAKwc,GAClB,GAAIxZ,EAAcsC,GACjBmI,EAAKnI,EAAIA,MACH,CACN,IAAMiX,EAAYvc,KAAKyc,GACjBG,EAASjB,EAAiBkB,SAAUvX,GACtCiX,EAAUjX,IAAMsX,IACnBL,EAAUjX,EAAIsX,EACdnP,EAAKqP,4CAKRtd,sBAAImd,qBAAJ,WACC,IAAMJ,EAAYvc,KAAKyc,GACvB,OAAmB,MAAfF,EAAUhX,EACNgX,EAAUhX,EAEVvF,KAAKwc,GAAMjX,OAIpB,SAAOA,GACN,IAAMkI,EAAOzN,KAAKwc,GAClB,GAAIxZ,EAAcuC,GACjBkI,EAAKlI,EAAIA,MACH,CACN,IAAMgX,EAAYvc,KAAKyc,GACjBG,EAASjB,EAAiBkB,SAAUtX,GACtCgX,EAAUhX,IAAMqX,IACnBL,EAAUhX,EAAIqX,EACdnP,EAAKqP,4CAKRH,wBAAA,WACC3c,KAAK0c,OAGNC,wBAAA,WACC,OAAgD,MAAvC3c,KAAK0c,KAGfld,sBAAImd,yBAAJ,WACC,IAAMJ,EAAYvc,KAAKyc,GACvB,OAAIzc,KAAK+c,cACD,OACsB,MAAnBR,EAAUna,MACbma,EAAUna,MAEVpC,KAAKwc,GAAMpa,WAIpB,SAAWA,GACV,GAAIY,EAAcZ,GACjBpC,KAAKwc,GAAMpa,MAAQA,OACb,GAAc,SAAVA,EACJpC,KAAK+c,gBACV/c,KAAKgd,cACQhd,KAAKwc,GACbS,kBACL5c,EAAcM,cAET,CACN,IAAM4b,EAAYvc,KAAKyc,GACjBG,EAASjB,EAAiBxP,KAAM/J,GAClCma,EAAUna,QAAUwa,IACvBL,EAAUna,MAAQwa,EAClB5c,KAAKwc,GAAMM,4CAKdH,yBAAA,WACC3c,KAAK0c,OAGNC,yBAAA,WACC,OAAiD,MAAxC3c,KAAK0c,KAGfld,sBAAImd,0BAAJ,WACC,IAAMJ,EAAYvc,KAAKyc,GACvB,OAAIzc,KAAKkd,eACD,OACuB,MAApBX,EAAU1W,OACb0W,EAAU1W,OAEV7F,KAAKwc,GAAM3W,YAIpB,SAAYA,GACX,GAAI7C,EAAc6C,GACjB7F,KAAKwc,GAAM3W,OAASA,OACd,GAAe,SAAXA,EACJ7F,KAAKkd,iBACVld,KAAKmd,eACQnd,KAAKwc,GACbS,kBACL5c,EAAcM,cAET,CACN,IAAM4b,EAAYvc,KAAKyc,GACjBG,EAASjB,EAAiBxP,KAAMtG,GAClC0W,EAAU1W,SAAW+W,IACxBL,EAAU1W,OAAS+W,EACnB5c,KAAKwc,GAAMM,kDE/If,SAAYR,GACXA,mBACAA,uBACAA,qBACAA,mBAJD,CAAYA,IAAAA,OCEZ,ICFYc,ECAAC,ECAAC,eHEZ,cA4BA,OAxBeC,uBAAd,SAAoCzc,GACnCd,KAAKwd,oBAAsB1c,GAGdyc,uBAAd,WACC,OAAOvd,KAAKwd,qBAGCD,cAAd,WACC,GAAqB,MAAjBvd,KAAKQ,SAAmB,CAC3B,IAAMid,EAAoBzd,KAAK0d,uBAC/B,GAAyB,MAArBD,EACH,MAAM,IAAIhd,MAAO,gCAElBT,KAAKQ,SAAW,IAAIid,EAErB,OAAOzd,KAAKQ,UAGC+c,cAAd,SAA2Bjd,GAC1B,IAAMC,EAASP,KAAKQ,SAEpB,OADAR,KAAKQ,SAAWF,EACTC,GAzBOgd,sBAAiD,KACjDA,WAA0B,uBIJ1C,cAYA,OATQI,SAAP,SAAehD,GACd,IAAMiD,EAAU5d,KAAK6d,GACrB,OAAIlD,KAAQiD,EACDjD,SAAUiD,EAASjD,IAE7BiD,EAASjD,GAAS,EACRA,SARKgD,KAAuC,qBCSzD,cAuQA,OAlQCne,sBAAWse,mBAAX,WACC,MAAS,iBAAkBlG,0CAG5BpY,sBAAWse,aAAX,WACC,MAAO,8CAGRte,sBAAWse,cAAX,WACC,MAAO,+CAGRte,sBAAWse,eAAX,WACC,MAAO,gDAGRte,sBAAWse,eAAX,WACC,MAAO,gDAGRte,sBAAWse,cAAX,WACC,MAAO,+CAGRte,sBAAWse,aAAX,WACC,MAAO,8CAGRte,sBAAWse,cAAX,WACC,MAAO,+CAGRte,sBAAWse,YAAX,WACC,MAAO,6CAGRte,sBAAWse,gBAAX,WACC,MAAO,iDAGDA,WAAP,SAAiB7H,EAA4B1V,GAC5C,IAAMwd,EAAqB1d,EAAcK,cAAc8J,SAASwT,QAAQC,YACxE,GAAI,YAAahI,EAAI,CACpB,IAAMiI,EAAUjI,EAAEkI,eACZC,EAAQF,EAASA,EAAQvL,OAAS,GAC3B,MAATyL,EACHL,EAAmBM,mBAAoB9d,EAAQ6d,EAAME,QAASF,EAAMG,SAEpER,EAAmBM,mBAAoB9d,EAAQ,EAAG,QAGnDwd,EAAmBM,mBAAoB9d,EAAQ0V,EAAEqI,QAASrI,EAAEsI,SAE7D,OAAOhe,GAGDud,UAAP,SAAgBjd,EAAqC6W,GAArD,WACC,GAAM1X,KAAKwe,UAEJ,CACN,IAAIC,GAAW,EACXC,EAAQ,EACRC,EAAQ,EACNC,EAAU,WACfH,GAAW,EACXI,EAAmBC,IAAKC,EAAIC,IAS7Bne,EAAOsM,GAAI,SAAS,SAAE8I,GACjBwI,GACHG,IAEDlH,EAASzB,MAEV,IAAM8I,EAAK/e,KAAKif,GACVD,EAAO,SAAE/I,GACVwI,IACHG,IACIzY,EAAK+Y,SAAUre,EAAQoV,EAAEpV,SAjBP,SAAEoV,GACzB,IAAMkJ,EAASlJ,EAAEnP,KAAKqY,OAChBC,EAAKnT,KAAKoT,IAAKX,EAAQS,EAAO7Z,GAC9Bga,EAAKrT,KAAKoT,IAAKV,EAAQQ,EAAO5Z,GAC9Bga,EAAYpZ,EAAKqZ,yBACvB,OAASJ,EAAKG,GAAaD,EAAKC,EAa1BE,CAAiBxJ,IACpByB,EAASzB,KAKP4I,EAAqBxe,EAAcK,cAAc8J,SAASwT,QAAQC,YACxEpd,EAAOsM,GAAInN,KAAK0f,MAAM,SAAEzJ,GACvB,IAAMwI,EAAW,CAChBA,GAAW,EACX,IAAMkB,EAAS1J,EAAEnP,KAAKqY,OACtBT,EAAQiB,EAAOra,EACfqZ,EAAQgB,EAAOpa,EACfsZ,EAAmBC,IAAKC,EAAIC,GAC5BH,EAAmBe,KAAMb,EAAIC,YAzC/Bne,EAAOsM,GAAI,QAASuK,IA+CfoG,cAAP,SACCjd,EACAgf,EACAC,GAHD,WAKC,GAAM9f,KAAKwe,UAEJ,CACN,IAAIuB,GAAW,EACXC,EAAQ,EACRC,EAAQ,EACRC,EAA2B,KACzBC,EAAiB,WACL,MAAbD,IACHE,aAAcF,GACdA,EAAY,OAGRG,EAAU,WACfN,GAAW,EACXO,EAAmBxB,IAAKyB,EAAIC,GAC5BF,EAAmBxB,IAAK2B,EAAMC,GAC9BP,KAEKQ,EAAkB,SAAE1K,GACzB,IAAMkJ,EAASlJ,EAAEnP,KAAKqY,OAChBC,EAAKnT,KAAKoT,IAAKW,EAAQb,EAAO7Z,GAC9Bga,EAAKrT,KAAKoT,IAAKY,EAAQd,EAAO5Z,GAC9Bga,EAAYpZ,EAAKqZ,yBACvB,OAASJ,EAAKG,GAAaD,EAAKC,GAEjC1e,EAAOsM,GAAI,SAAS,SAAE8I,GACjB8J,GACHM,IAEDR,EAAS5J,MAEV,IAAMsK,EAAKvgB,KAAKif,GACVwB,EAAOzgB,KAAK4gB,KACZJ,EAAO,SAAEvK,GACV8J,IACHM,IACIla,EAAK+Y,SAAUre,EAAQoV,EAAEpV,SACxB8f,EAAiB1K,IACpB4J,EAAS5J,KAKPyK,EAAS,SAAEzK,GACZ8J,GACC5Z,EAAK+Y,SAAUre,EAAQoV,EAAEpV,UACtB8f,EAAiB1K,IACtBoK,MAKEC,EAAqBjgB,EAAcK,cAAc8J,SAASwT,QAAQC,YACxEpd,EAAOsM,GAAInN,KAAK0f,MAAM,SAAEzJ,GACvB,IAAM8J,EAAW,CAChBA,GAAW,EACX,IAAMc,EAAS5K,EAAEnP,KAAKqY,OACtBa,EAAQa,EAAOvb,EACf2a,EAAQY,EAAOtb,EACf4a,IAEI,YADOlK,EAAEnP,KAAKga,gBAEjBZ,EAAYa,OAAOC,YAAW,WACzBjB,IACHM,IACAP,EAAa7J,MAEZ9P,EAAK8a,uBAETX,EAAmBxB,IAAKyB,EAAIC,GAC5BF,EAAmBxB,IAAK2B,EAAMC,GAC9BJ,EAAmBV,KAAMW,EAAIC,GAC7BF,EAAmBnT,GAAIsT,EAAMC,YAxE/B7f,EAAOsM,GAAI,QAAS0S,IA8Ef/B,aAAP,SAAmBjd,EAAqB6W,GAAxC,WACC,GAAM1X,KAAKwe,UAEJ,CACN,IAAI0C,EAAW,EACXC,EAAQ,EACRC,EAAQ,EACRC,EAAY,EAEhBxgB,EAAOiX,iBAAkB,WAAYJ,GAErC7W,EAAOiX,iBAAkB,YAAY,SAAE7B,GACtC,GAAiB,IAAbiL,GAA+B,IAAbA,EAAiB,CACtC,IAAMhD,EAAUjI,EAAEkI,eACZC,EAAsBF,EAASA,EAAQvL,OAAS,GACtD,GAAa,MAATyL,EAAgB,CACnB,IAAMgB,EAAK+B,EAAQ/C,EAAME,QACnBgB,EAAK8B,EAAQhD,EAAMG,QACzB,GAAItS,KAAKoT,IAAKD,GAAOnT,KAAKoT,IAAKC,GAAOnZ,EAAKqZ,yBAc1C,YAZiB,KADjB0B,GAAY,IAEXA,EAAW,EACSjL,EAAEqL,UAAYD,EAChBlb,EAAKob,4BACtB7J,EAASzB,IAEToL,EAAYpL,EAAEqL,UACdJ,EAAW,IAGZG,EAAYpL,EAAEqL,YAMlBJ,EAAW,KAGZrgB,EAAOiX,iBAAkB,cAAc,SAAE7B,GACxC,GAAiB,IAAbiL,GAEH,GAAa,OADP9C,EAAsBnI,EAAEiI,QAAQsD,KAAMvL,EAAEiI,QAAQvL,OAAS,IAK9D,OAHAuO,EAAW,EACXC,EAAQ/C,EAAME,aACd8C,EAAQhD,EAAMG,cAGT,GAAiB,IAAb2C,EAAiB,CAC3B,IAAM9C,EACN,GAAa,OADPA,EAAsBnI,EAAEiI,QAAQsD,KAAMvL,EAAEiI,QAAQvL,OAAS,IAK9D,OAHAuO,EAAW,EACXC,EAAQ/C,EAAME,aACd8C,EAAQhD,EAAMG,SAIhB2C,EAAW,UAvDZrgB,EAAOiX,iBAAkB,WAAYJ,IA4DhCoG,WAAP,SAAiBjd,EAAiB4gB,GAEjC,IADA,IAAIzO,EAAUyO,EACI,MAAXzO,GAAmBA,IAAYnS,GACrCmS,EAAUA,EAAQ+B,OAEnB,OAAO/B,IAAYnS,GApQbid,2BAAmC,EACnCA,8BAAsC,IACtCA,uBAA+B,SCmHjC4D,EAAU,SAA4B3gB,GAC3C,GAAe,MAAXA,GAAoC,MAAjBA,EAAQD,MAAgB,CAC9C,IAAMA,EAAQC,EAAQD,MACtB,OAAIiB,EAAcjB,GACVyc,EAAQ7c,cAAcsM,IAAKlM,GAE3BA,EAGT,OAAO,MAQF6gB,GAAc,SACnB5gB,GAEA,GAAe,MAAXA,IAA0C,MAArBA,EAAQ6gB,WAAyC,MAApB7gB,EAAQiW,UAAqB,CAClF,IAAMzW,EAAsC,GAK5C,GAJwB,MAApBQ,EAAQiW,UACXzW,EAAOqS,KAAMoD,EAAkB2B,WAAY5W,EAAQiW,WAG3B,MAArBjW,EAAQ6gB,UAEX,IADA,IAAMA,EAAY7gB,EAAQ6gB,UACjBhO,EAAI,EAAGG,EAAO6N,EAAUjP,OAAQiB,EAAIG,IAAQH,EACpDoC,EAAkB2B,WAAYiK,EAAWhO,IAG3C,OAAOrT,mBAmDR,WAAaQ,GAAb,MACCiF,mBAGM6b,EAAuB1b,EAAK2b,GAAa3b,EAAK0b,UACpD1b,EAAKiM,GAAY,IAAI/M,EAAYwc,EAAUhF,UAAU,WACpD1W,EAAK4b,YAEN5b,EAAK6b,GAAS,IAAI3c,EAAYwc,EAAUI,OAAO,WAC9C9b,EAAK+b,aAEN/b,EAAKgc,GAAQ,IAAI9c,EAAYwc,EAAUO,MAAM,WAC5Cjc,EAAKkc,YAINlc,EAAKmc,GAAWvhB,EAChB,IAAMwb,EAAwBpW,EAAKsW,GAAa,GAChDtW,EAAKoc,GAAiB,IAAI5F,EAAgBxW,EAAMoW,GAChDpW,EAAKK,GAAW,EAChBL,EAAKqc,IAAY,EACjBrc,EAAKsc,IAAmB,EACxBtc,EAAKuc,GAAU,KACfvc,EAAKwc,GAAU5hB,GAA2B,MAAhBA,EAAQ6hB,KAAe7hB,EAAQ6hB,KAAOjF,EAASxd,OAAQgG,EAAK0c,WACtF,IAAM/hB,EAAQqF,EAAKlF,EAASygB,EAAS3gB,IAAaoF,EAAK2c,kBACvD3c,EAAK4c,GAAW,GAChB5c,EAAK6c,GAAU,GACf7c,EAAK8c,GAAe,GACpB9c,EAAK+c,GAAeniB,GAA4B,MAAjBA,EAAQoiB,MACpCphB,EAAchB,EAAQoiB,OAAU7G,EAAkBvb,EAAQoiB,OAAUpiB,EAAQoiB,MAC9EriB,EAAMsiB,eAEPjd,EAAKkd,GAAW,IAAIze,EAAc9D,EAAOC,GAAS,WACjDoF,EAAK2W,SACL3W,EAAK8W,kBACL5c,EAAcM,YAEf,IAAM2iB,EAAmB,WACxBnd,EAAKod,UACLljB,EAAcM,UAEfwF,EAAKqd,GAAc,IAAIhiB,EAAiBV,EAAOC,EAASuiB,GACxDnd,EAAKsd,GAAU,IAAIhhB,EAAa3B,EAAOC,EAASuiB,GAChDnd,EAAKud,GAAW,IAAI9f,EAAc9C,EAAOC,EAASuiB,GAClDnd,EAAKwd,GAAU,IAAIvgB,EAAatC,EAAOC,EAASuiB,GAChDnd,EAAKyd,iBAGL,IAAM/G,EAAWgF,EAAUhF,SACrBvX,EAAMvE,GAAwB,MAAbA,EAAQuE,EAAYvE,EAAQuE,EAAIxE,EAAM+iB,OACzD7gB,EAAcsC,GACjBuX,EAASvX,EAAIA,GAEbuX,EAASvX,EAAI,EACbiX,EAAUjX,EAAIqW,EAAiBkB,SAAUvX,IAI1C,IAAMC,EAAMxE,GAAwB,MAAbA,EAAQwE,EAAYxE,EAAQwE,EAAIzE,EAAMgjB,OACzD9gB,EAAcuC,GACjBsX,EAAStX,EAAIA,GAEbsX,EAAStX,EAAI,EACbgX,EAAUhX,EAAIoW,EAAiBkB,SAAUtX,IAI1C,IAAMnD,EAAUrB,GAA4B,MAAjBA,EAAQqB,MAAgBrB,EAAQqB,MAAQtB,EAAMqN,WACrEnL,EAAcZ,GACjB+D,EAAKhE,EAASC,EACM,SAAVA,GACV+D,EAAKhE,EAAS,IACdgE,EAAKoc,GAAevF,gBAEpB7W,EAAKhE,EAAS,IACdoa,EAAUna,MAAQuZ,EAAiBxP,KAAM/J,IAI1C,IAAMyD,EAAW9E,GAA6B,MAAlBA,EAAQ8E,OAAiB9E,EAAQ8E,OAAS/E,EAAMijB,YACxE/gB,EAAc6C,GACjBM,EAAKC,EAAUP,EACM,SAAXA,GACVM,EAAKC,EAAU,IACfD,EAAKoc,GAAepF,iBAEpBhX,EAAKC,EAAU,IACfmW,EAAU1W,OAAS8V,EAAiBxP,KAAMtG,IAIvC9E,GAA8B,MAAnBA,EAAQyO,UACtBrJ,EAAKqJ,QAAUzO,EAAQyO,SAIxBrJ,EAAK6d,GAASxgB,EAAWygB,KACzB9d,EAAK+d,GAAc1gB,EAAWygB,KAG9B,IAAME,EAAgBpjB,GAAkC,MAAvBA,EAAQojB,YACtCpiB,EAAchB,EAAQojB,aAAgBphB,EAAkBhC,EAAQojB,aAAgBpjB,EAAQojB,YAC1FrjB,EAAMsjB,iBAMP,GAJAje,EAAKge,YAA4D,IAA1CA,EAAcphB,EAAiBshB,MACtDle,EAAKme,oBAAwE,IAA9CH,EAAcphB,EAAiBwhB,UAG/C,MAAXxjB,EAAkB,CACrB,IAAMoM,EAAKpM,EAAQoM,GACnB,GAAU,MAANA,EACH,IAAK,IAAMqX,KAAQrX,EAClBhH,EAAKgH,GAAIqX,EAAMrX,EAAIqX,IAMtBre,EAAKse,GAAW1jB,GAA4B,MAAjBA,EAAQ2jB,MAAgB3jB,EAAQ2jB,MAAQ5jB,EAAM6jB,WAGzExe,EAAKye,GAAY7jB,GAA6B,MAAlBA,EAAQ8jB,OAAiB9jB,EAAQ8jB,OAAS/jB,EAAMgkB,YAG5E3e,EAAK4e,GAAuB,WAC3B1kB,EAAcM,UAEf,IAAMqkB,EAAUjkB,GAAWA,EAAQikB,QAAWlkB,EAAMmkB,YAChDD,IACH7e,EAAK6e,OAASA,GAIf7e,EAAKgH,GAAI2Q,EAAiBoH,MAAM,SAAEjP,GAEjC9P,EAAKgf,YAAY,GAGblP,EAAEpV,SAAWsF,GAChBA,EAAKif,gBAIPjf,EAAKgH,GAAI2Q,EAAiBuH,KAAK,WAC9Blf,EAAKgf,YAAY,MAGlBhf,EAAKgH,GAAI2Q,EAAiB4B,MAAM,SAAEzJ,GACjC9P,EAAKmf,OAAQrP,MAId9P,EAAKgH,GAAI,SAAS,WACjBhH,EAAK2W,UACD3W,EAAKof,WAAapf,EAAKqf,aAC1Brf,EAAKsf,mBAEFtf,EAAKsc,IACRtc,EAAKuf,wBAENvf,EAAKwf,cACLtlB,EAAcM,YAGfwF,EAAKgH,GAAI,WAAW,WACnBhH,EAAKyf,MAAM,GACXzf,EAAKwf,cACLtlB,EAAcM,YAIf,IAAMihB,EAAYzb,EAAK0f,GAAalE,GAAa5gB,GACjD,GAAiB,MAAb6gB,EAIH,IAHA,IAAMkE,EAAkB,SAAE7P,GACzB9P,EAAK4f,WAAY9P,IAETrC,EAAI,EAAGG,EAAO6N,EAAUjP,OAAQiB,EAAIG,IAAQH,EACpDoC,EAAkB7I,GAAIhH,EAAMyb,EAAWhO,GAAKkS,GAQ9C,GAHA3f,EAAK6f,KAAMjlB,GAGPA,GAA4B,MAAjBA,EAAQU,MACtB,GAAIM,EAAchB,EAAQU,OACzB0E,EAAKoL,SAAU/N,EAAYzC,EAAQU,QAAS,QACtC,GAAIuB,EAAcjC,EAAQU,OAChC0E,EAAKoL,SAAUxQ,EAAQU,OAAO,OAE9B,CAAA,IAAMwkB,EAASllB,EAAQU,MACvB,IAASmS,EAAI,EAAGG,EAAOkS,EAAOtT,OAAQiB,EAAIG,IAAQH,EACjDzN,EAAKoL,SAAU/N,EAAYyiB,EAAQrS,KAAO,GAW7C,GALI7S,GAA6B,MAAlBA,EAAQgU,QACtBhU,EAAQgU,OAAOmR,SAAU/f,GAItBpF,GAA+B,MAApBA,EAAQ0U,SACtB,CAAA,IAAMA,EAAW1U,EAAQ0U,SACzB,IAAS7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,EAAQ1Q,EAAU7B,GACX,MAATuS,GACHhgB,EAAK+f,SAAUC,WAMlBhgB,EAAK8M,KAAM,OAAQ9M,KA65BrB,OAtpCUrG,OA4PTsmB,8BAAA,SAAmBC,EAAyBC,GAC1CD,EAAmBtR,OAAS/U,MACdsmB,EAAQtmB,KAAK+iB,GAAW/iB,KAAKgjB,IACvCuD,QAASF,IAGfD,6BAAA,SAAkBC,EAAyBC,GACzCD,EAAmBtR,OAAS/U,MACdsmB,EAAQtmB,KAAK+iB,GAAW/iB,KAAKgjB,IACvCpQ,KAAMyT,IAGZD,6BAAA,SAAkBC,EAAyBC,GACzCD,EAAmBtR,OAAS,KAC7B,IAAMyR,EAASF,EAAQtmB,KAAK+iB,GAAW/iB,KAAKgjB,GACtCxN,EAAQgR,EAAK9Q,QAAS2Q,GACxB,GAAK7Q,GACRgR,EAAKxS,OAAQwB,EAAO,IAItB4Q,0BAAA,SAAeK,GACdzmB,KAAKijB,GAAarQ,KAAM6T,IAGzBL,6BAAA,SAAkBK,GACjB,IAAMC,EAAc1mB,KAAKijB,GACnBzN,EAAQkR,EAAYhR,QAAS+Q,GAC/B,GAAKjR,GACRkR,EAAY1S,OAAQwB,EAAO,IAInB4Q,2BAAV,WACC,IAAIlX,EAAiBlP,OAGZomB,6BAAV,WACCpmB,KAAKid,kBACLjX,YAAM2gB,6BAGGP,uBAAV,SAAsBnQ,KAItBzW,sBAAI4mB,8BAAJ,WACC,OAAOpmB,KAAKuiB,oCAGH6D,iBAAV,SAAgBrlB,KAIhBvB,sBAAI4mB,0BAAJ,WACC,OAAOpmB,KAAK4kB,oCAGbwB,mBAAA,WACCpmB,KAAK4mB,eACLvmB,EAAcM,SACdX,KAAKiT,KAAM,OAAQjT,OAGpBomB,mBAAA,SAAQhkB,EAAeyD,GACtB,IAAMghB,EAAW7mB,KAAKmC,EAChB2kB,EAAY9mB,KAAKoG,EACjB2gB,EAAeF,IAAazkB,EAC5B4kB,EAAgBF,IAAcjhB,EAEhCkhB,IACH/mB,KAAKmC,EAASC,GAGX4kB,IACHhnB,KAAKoG,EAAUP,GAGhB,IAeO0W,EAfD0K,EAAUF,GAAgBC,EAKhC,GAJIC,GACHjnB,KAAKknB,SAAU9kB,EAAOyD,EAAQghB,EAAUC,GAGrCC,GAEgB,OADbxK,EAAYvc,KAAKyc,IACTnX,EAAY,CACzB,IAAMuX,EAAW7c,KAAK8hB,GAAWjF,SAC3BsK,EAAannB,KAAKonB,gBACxBpnB,KAAKsF,EAAIiX,EAAUjX,EAAG6hB,EAAW/kB,MAAOA,EAAO+kB,EAAWhjB,QAAQkjB,UAAWxK,EAASvX,GAaxF,OATI0hB,GAEgB,OADbzK,EAAYvc,KAAKyc,IACTlX,IACPsX,EAAW7c,KAAK8hB,GAAWjF,SAC3BsK,EAAannB,KAAKonB,gBACxBpnB,KAAKuF,EAAIgX,EAAUhX,EAAG4hB,EAAWthB,OAAQA,EAAQshB,EAAWhjB,QAAQmjB,SAAUzK,EAAStX,IAIlF0hB,GAGRb,yBAAA,WACC,OAAOpmB,KAAKkjB,IAGbkD,qBAAA,SAAUmB,EAAkBC,EAAmBX,EAAkBC,GAChE9mB,KAAKujB,UACLvjB,KAAKid,kBACLjd,KAAKynB,iBACLpnB,EAAcM,SACdX,KAAKiT,KAAM,SAAUsU,EAAUC,EAAWX,EAAUC,EAAW9mB,OAGhEomB,oBAAA,WACC/lB,EAAcM,SACdX,KAAKiT,KAAM,QAASjT,OAGrBomB,mBAAA,WACC/lB,EAAcM,SACdX,KAAKiT,KAAM,OAAQjT,OAGpBR,sBAAI4mB,wBAAJ,WACC,OAAOpmB,KAAK6iB,2CAGbrjB,sBAAI4mB,wBAAJ,WACC,OAAOpmB,KAAK2iB,QAGb,SAAUC,GACT5iB,KAAK2iB,GAAQC,mCAGdpjB,sBAAI4mB,qBAAJ,WACC,OAAOpmB,KAAKoS,GAAU9M,OAGvB,SAAOA,GACNtF,KAAKoS,GAAU9M,EAAIA,mCAGpB9F,sBAAI4mB,qBAAJ,WACC,OAAOpmB,KAAKoS,GAAU7M,OAGvB,SAAOA,GACNvF,KAAKoS,GAAU7M,EAAIA,mCAGpB/F,sBAAI4mB,yBAAJ,WACC,OAAOpmB,KAAKmC,OAGb,SAAWC,GACV,IAAMykB,EAAW7mB,KAAKmC,EACtB,GAAI0kB,IAAazkB,EAAQ,CACxBpC,KAAKmC,EAASC,EACd,IAAMyD,EAAS7F,KAAKoG,EACpBpG,KAAKknB,SAAU9kB,EAAOyD,EAAQghB,EAAUhhB,GAGxC,IAAM0W,EAAYvc,KAAKyc,GACvB,GAAmB,MAAfF,EAAUjX,EAAY,CACzB,IAAMuX,EAAW7c,KAAK8hB,GAAWjF,SAC3BsK,EAAannB,KAAKonB,gBACxBpnB,KAAKsF,EAAIiX,EAAUjX,EAAG6hB,EAAW/kB,MAAOA,EAAO+kB,EAAWhjB,QAAQkjB,UAAWxK,EAASvX,sCAKzF9F,sBAAI4mB,0BAAJ,WACC,OAAOpmB,KAAKoG,OAGb,SAAYP,GACX,IAAMihB,EAAY9mB,KAAKoG,EACvB,GAAI0gB,IAAcjhB,EAAS,CAC1B7F,KAAKoG,EAAUP,EACf,IAAMzD,EAAQpC,KAAKmC,EACnBnC,KAAKknB,SAAU9kB,EAAOyD,EAAQzD,EAAO0kB,GAGrC,IAAMvK,EAAYvc,KAAKyc,GACvB,GAAmB,MAAfF,EAAUhX,EAAY,CACzB,IAAMsX,EAAW7c,KAAK8hB,GAAWjF,SAC3BsK,EAAannB,KAAKonB,gBACxBpnB,KAAKuF,EAAIgX,EAAUhX,EAAG4hB,EAAWthB,OAAQA,EAAQshB,EAAWhjB,QAAQmjB,SAAUzK,EAAStX,sCAK1F/F,sBAAI4mB,4BAAJ,WACC,OAAOpmB,KAAKoS,oCAGb5S,sBAAI4mB,yBAAJ,WACC,OAAOpmB,KAAKgiB,oCAGbxiB,sBAAI4mB,wBAAJ,WACC,OAAOpmB,KAAKmiB,oCAGb3iB,sBAAI4mB,2BAAJ,WACC,OAAOpmB,KAAKqjB,oCAGb7jB,sBAAI4mB,0BAAJ,WACC,OAAOpmB,KAAK2jB,oCAGbnkB,sBAAI4mB,8BAAJ,WACC,OAAOpmB,KAAKwjB,oCAGbhkB,sBAAI4mB,0BAAJ,WACC,OAAOpmB,KAAKyjB,oCAGbjkB,sBAAI4mB,2BAAJ,WACC,OAAOpmB,KAAK0jB,oCAGblkB,sBAAI4mB,0BAAJ,WACC,OAAOpmB,KAAK8hB,oCAGbtiB,sBAAI4mB,yBAAJ,WACC,OAAOpmB,KAAKykB,QAGb,SAAWC,GACN1kB,KAAKykB,KAAWC,IACnB1kB,KAAKykB,GAASC,EACV1kB,KAAK0nB,aACR1nB,KAAKolB,+CAKEgB,uBAAV,WACC/lB,EAAcK,cAAcinB,KAAKjD,MAAQ1kB,KAAKykB,IAG/C2B,iBAAA,WAMC,OALMpmB,KAAKwP,UACVxP,KAAKwP,SAAU,EACfxP,KAAK0lB,wBACLrlB,EAAcM,UAERX,MAGRomB,oBAAA,WACC,OAAOpmB,KAAKwP,SAGb4W,iBAAA,WAMC,OALIpmB,KAAKwP,UACRxP,KAAKwP,SAAU,EACfxP,KAAK0lB,wBACLrlB,EAAcM,UAERX,MAGRomB,qBAAA,WACC,OAASpmB,KAAKwP,SAGf4W,oBAAA,WACC,OAAMpmB,KAAKwG,IACVxG,KAAKwG,GAAW,EAChBxG,KAAKylB,oBACE,IAKTW,uBAAA,WACC,OAAMpmB,KAAKwiB,KACVxiB,KAAKwiB,IAAY,EACjBxiB,KAAKylB,oBACE,IAKTW,6BAAA,WACC,IAAMrR,EAAS/U,KAAK+U,OAChBA,aAAkBqR,GACrBrR,EAAO6S,cAITxB,4BAAA,WACC,OAAMpmB,KAAKyiB,KACVziB,KAAKyiB,IAAmB,EACxBziB,KAAK6nB,kBACL7nB,KAAK0lB,yBACE,IAKTU,kCAAA,WACC,IAAMrR,EAAS/U,KAAK+U,OAChBA,aAAkBqR,GACrBrR,EAAOkI,mBAITmJ,4BAAA,WACC,OAAOpmB,KAAKyiB,IAGH2D,4BAAV,aAIAA,oBAAA,WACC,OAAOpmB,KAAKwG,GAGb4f,qBAAA,WACC,OAAOpmB,KAAKwiB,IAGb4D,uBAAA,SAAYsB,GACX,OAAO1nB,KAAKuR,SAAU/N,EAAW+M,QAASmX,IAG3CtB,sBAAA,SAAW0B,GACV,OAAO9nB,KAAKuR,SAAU/N,EAAWmN,OAAQmX,IAG1C1B,uBAAA,SAAY2B,GACX,OAAO/nB,KAAKuR,SAAU/N,EAAWsN,QAASiX,IAG3C3B,wBAAA,SAAa4B,GACZ,OAAOhoB,KAAKuR,SAAU/N,EAAWuN,UAAWiX,IAG7C5B,wBAAA,SAAa6B,GACZ,OAAOjoB,KAAKuR,SAAU/N,EAAWqN,SAAUoX,IAG5C7B,wBAAA,SAAa8B,GACZ,OAAOloB,KAAKuR,SAAU/N,EAAWgN,SAAU0X,IAG5C9B,uBAAA,SAAY+B,GACX,OAAOnoB,KAAKuR,SAAU/N,EAAWwN,QAASmX,IAG3C/B,yBAAA,SAAcgC,GACb,OAAOpoB,KAAKuR,SAAU/N,EAAWyN,UAAWmX,IAG7ChC,sBAAA,SAAWiC,GACV,OAAOroB,KAAKuR,SAAU/N,EAAW0N,OAAQmX,IAG1CjC,uBAAA,SAAY1R,GAIX,OAHI1U,KAAK0U,cAAgBA,GACxBsE,EAAasP,qBAAqB1P,WAAY5Y,KAAM0U,GAAW,GAEzD1U,MAGRomB,kBAAA,WACC,OAAOpmB,KAAK4Y,YAAY,IAGzBwN,iBAAA,SAAMmC,GACL,GAAIA,EAAc,CACjB,IACMjQ,EADkBU,EAAasP,qBACL/P,aAChC,GAAID,aAAmB8N,EAEtB,IADA,IAAIpT,EAAqBsF,EAClBtF,GAAU,CAChB,GAAIA,IAAYhT,KAAO,CACtBsY,EAAQM,YAAY,GACpB,MAED5F,EAAUA,EAAQ+B,aAIpB/U,KAAK4Y,YAAY,GAElB,OAAO5Y,MAGRomB,sBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAW+M,UAGlC6V,qBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWmN,SAGlCyV,uBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWmN,OAASnN,EAAWoN,YAGtDwV,sBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWsN,UAGlCsV,uBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWuN,YAGlCqV,uBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWqN,WAGlCuV,yBAAA,WACC,OAASpmB,KAAKgV,SAAUxR,EAAWqN,SAAWrN,EAAWuN,YAG1DqV,uBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWgN,WAGlC4V,sBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWiN,UAGlC2V,wBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWiN,QAAUjN,EAAWkN,aAGvD0V,0BAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWyR,cAGlCmR,sBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWwN,UAGlCoV,wBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAWyN,YAGlCmV,qBAAA,WACC,OAAOpmB,KAAKgV,SAAUxR,EAAW0N,SAGlCkV,qBAAA,SAAU3kB,EAAmB+mB,GAC5B,IAAMC,EAAgBzoB,KAAKkkB,GACrBwE,EAAkBF,EAAQC,EAAgBhnB,EAAUgnB,GAAiBhnB,EAK3E,OAJIgnB,IAAkBC,IACrB1oB,KAAKkkB,GAAcwE,EACnB1oB,KAAK2lB,eAEC3lB,MAGRomB,sBAAA,SAAWuC,EAAsBC,GAChC,IAAMH,EAAgBzoB,KAAKkkB,GACrBwE,GAAmBD,EAAgBE,IAAaC,EAKtD,OAJIH,IAAkBC,IACrB1oB,KAAKkkB,GAAcwE,EACnB1oB,KAAK2lB,eAEC3lB,MAGEomB,wBAAV,WACC,IAAMrR,EAAS/U,KAAK+U,OACd8T,EAAa7oB,KAAKkkB,GAClB4E,EAAa/T,aAAkBqR,EACpCpmB,KAAK+oB,WAAYF,EAAY9T,EAAOtT,OACpConB,EAEKG,EAAWhpB,KAAKgkB,GAClBgF,IAAaF,IAChB9oB,KAAKgkB,GAAS8E,EACd9oB,KAAKipB,cAAeH,EAAUE,KAItB5C,uBAAV,SAAsByC,EAAwBK,GAC7C,OAAOL,EAAeK,EAAc1lB,EAAWqN,UAC5CqY,GAAe1lB,EAAWiN,QAAUjN,EAAWkN,YAAclN,EAAWkN,WAAalN,EAAWygB,OAChGiF,GAAe1lB,EAAWmN,OAASnN,EAAWoN,WAAapN,EAAWoN,UAAYpN,EAAWygB,OAGvFmC,0BAAV,SAAyB0C,EAAkBE,GAC1ChpB,KAAKujB,UACLljB,EAAcM,SACdX,KAAKiT,KAAM,cAAe6V,EAAUE,EAAUhpB,MAG9C,IADA,IAAMyV,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,EAAQ1Q,EAAU7B,GACpBuS,aAAiBC,GACpBD,EAAMgD,oBAAqBL,EAAUE,GAInC3Y,EAAYqE,UAAWoU,GACpBzY,EAAYqE,UAAWsU,IAC5BhpB,KAAKopB,YAGF/Y,EAAYqE,UAAWsU,IAC1BhpB,KAAKqpB,YAKEjD,2BAAV,SAA0B9N,GACzB,IAAMvD,EAAS/U,KAAK+U,OAChBA,aAAkBqR,GACrBrR,EAAOuU,eAAgBhR,IAIf8N,sBAAV,WACC,IAAMrR,EAAS/U,KAAK+U,OAChBA,aAAkBqR,GACrBrR,EAAOuU,eAAgBtpB,OAIfomB,qBAAV,aAIUA,gCAAV,SAA+BmD,EAAwBC,GACtD,IAAMV,EAAW9oB,KAAK+oB,WAAY/oB,KAAKkkB,GAAaqF,GAC9CP,EAAWhpB,KAAKgkB,GAClBgF,IAAaF,IAChB9oB,KAAKgkB,GAAS8E,EACd9oB,KAAKipB,cAAeH,EAAUE,KAIhCxpB,sBAAI4mB,yBAAJ,WACC,OAAOpmB,KAAKgkB,oCAGboC,qBAAA,WACC,OAAOpmB,KAAKgkB,IAGboC,qBAAA,SAAU3kB,GACT,OAAO4O,EAAYC,GAAItQ,KAAKgkB,GAAQviB,IAGrCjC,sBAAI4mB,yBAAJ,WACC,OAAOpmB,KAAKiB,OAGb,SAAWH,GACKd,KAAKiB,IACLH,IACdd,KAAKiB,EAASH,EACdd,KAAKqjB,GAASoG,SAAU3oB,GACxBd,KAAKwjB,GAAYiG,SAAU3oB,GAC3Bd,KAAKyjB,GAAQgG,SAAU3oB,GACvBd,KAAK0jB,GAAS+F,SAAU3oB,GACxBd,KAAK2jB,GAAQ8F,SAAU3oB,GACvBd,KAAKujB,UACLljB,EAAcM,2CAIhBylB,kBAAA,WACC,GAAIpmB,KAAKyiB,GAAmB,CAC3BziB,KAAKyiB,IAAmB,EAGxB,IADA,IAAMhN,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,EAAQ1Q,EAAU7B,GACpBuS,aAAiBC,GACpBD,EAAMuD,QAIR1pB,KAAK2pB,YAIGvD,oBAAV,WACC,IAAMwD,EAAgB5pB,KAAKuiB,GACrBxF,EAAc6M,EAAc7M,cAC5BG,EAAe0M,EAAc1M,eACnC,GAAIH,GAAeG,EAAe,CAIjC,IAHA,IAAI9a,EAAQ,EACRyD,EAAS,EAEJ+N,EAAI,EAAGG,GADV0B,EAAWzV,KAAKyV,UACU9C,OAAQiB,EAAIG,IAAQH,GAC7CuS,EAAQ1Q,EAAU7B,IACdpE,UACLxP,KAAK6pB,kBAAmB1D,KAC3B/jB,EAAQ6J,KAAKC,IAAK9J,EAAO+jB,EAAM7gB,EAAI6gB,EAAM/jB,QAEtCpC,KAAK8pB,mBAAoB3D,KAC5BtgB,EAASoG,KAAKC,IAAKrG,EAAQsgB,EAAM5gB,EAAI4gB,EAAMtgB,UAI9C,IAAM1B,EAAUnE,KAAKmE,QACrBnE,KAAK+pB,OAAQ3nB,EAAQ+B,EAAQ6lB,WAAYnkB,EAAS1B,EAAQ8lB,kBACpD,GAAIlN,EAAc,CAGxB,IAFI3a,EAAQ,EAEHwR,EAAI,EAAGG,GADV0B,EAAWzV,KAAKyV,UACU9C,OAAQiB,EAAIG,IAAQH,GAC7CuS,EAAQ1Q,EAAU7B,IACdpE,SAAWxP,KAAK6pB,kBAAmB1D,KAC5C/jB,EAAQ6J,KAAKC,IAAK9J,EAAO+jB,EAAM7gB,EAAI6gB,EAAM/jB,QAGrC+B,EAAUnE,KAAKmE,QACrBnE,KAAKoC,MAAQA,EAAQ+B,EAAQ6lB,gBACvB,GAAI9M,EAAe,CACzB,IACMzH,EACN,IAFI5P,EAAS,EAEJ+N,EAAI,EAAGG,GADV0B,EAAWzV,KAAKyV,UACU9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,GAAAA,EAAQ1Q,EAAU7B,IACdpE,SAAWxP,KAAK8pB,mBAAoB3D,KAC7CtgB,EAASoG,KAAKC,IAAKrG,EAAQsgB,EAAM5gB,EAAI4gB,EAAMtgB,SAGvC1B,EAAUnE,KAAKmE,QACrBnE,KAAK6F,OAASA,EAAS1B,EAAQ8lB,cAIvB7D,wBAAV,SAAuBvlB,GACtB,OAAOA,aAAkBulB,GAGhBA,+BAAV,SAA8BvlB,GAC7B,OAAOb,KAAKkqB,YAAarpB,MACpBA,aAAkBulB,GAASxlB,EAAgBC,EAAO+a,WAAW/V,UAGzDugB,8BAAV,SAA6BvlB,GAC5B,OAAOb,KAAKkqB,YAAarpB,MACpBA,aAAkBulB,GAASxlB,EAAgBC,EAAO+a,WAAWxZ,SAGnEgkB,mBAAA,WAMC,GALIpmB,KAAKwG,IACRxG,KAAKmqB,WACLnqB,KAAKwG,GAAW,GAGbxG,KAAKwiB,GAAY,CAEpB,IADA,IAAM/M,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,EAAQ1Q,EAAU7B,GACpBuS,aAAiBC,GACpBD,EAAMiE,SAGRpqB,KAAKwiB,IAAY,IAIT4D,qBAAV,WAIC,IAHA,IAAMhkB,EAAQpC,KAAKoC,MACbyD,EAAS7F,KAAK6F,OACd6gB,EAAc1mB,KAAKijB,GAChBrP,EAAI,EAAGG,EAAO2S,EAAY/T,OAAQiB,EAAIG,IAAQH,EACtD8S,EAAa9S,GAAIuW,SAAUnqB,KAAMoC,EAAOyD,IAI1CrG,sBAAI4mB,0BAAJ,WACC,OAAOpmB,KAAK0iB,QAGb,SAAYsC,GACX,IAAMpQ,EAAW5U,KAAK0iB,GAClB9N,IAAaoQ,IACA,MAAZpQ,IACHA,EAASkK,IAAK,SAAU9e,KAAK+kB,IAC7B/kB,KAAKqqB,iBAAkBzV,GACvB5U,KAAKsqB,iBAAkB1V,GAAU,IAGlC5U,KAAK0iB,GAAUsC,EACD,MAAVA,IACHA,EAAO7X,GAAI,SAAUnN,KAAK+kB,IAC1B/kB,KAAKiP,cAAe+V,GACpBhlB,KAAKuqB,kBAAmBvF,GAAQ,IAGjC3kB,EAAcM,2CAIhBylB,mBAAA,WACC,IAAMja,EAAOnM,KAAKonB,gBAClBpnB,KAAKwqB,eAAgBre,EAAK/J,MAAO+J,EAAKtG,OAAQsG,EAAKhI,UAG1CiiB,0BAAV,WACC,IAAMrR,EAAS/U,KAAK+U,OACpB,OAAIA,aAAkBqR,EACdrR,EAEA1U,EAAcK,eAUvB0lB,2BAAA,SAAgBqE,EAAqBC,EAAsBC,GAC1D,IAAMpO,EAAYvc,KAAKyc,GACjBI,EAAW7c,KAAK8hB,GAAWjF,SAC3BvX,EAAIuX,EAASvX,EACbC,EAAIsX,EAAStX,EACbnD,EAAQpC,KAAKmC,EACb0D,EAAS7F,KAAKoG,EAGdwkB,EAAeD,EAActD,UAAYsD,EAAcX,WACvDa,EAAgBF,EAAcrD,SAAWqD,EAAcV,YACvD1C,EAAgC,MAAnBhL,EAAUna,MAC5Bma,EAAUna,MAAOqoB,EAAaroB,EAAOwoB,EAAcxoB,GAAUA,EACxDolB,EAAkC,MAApBjL,EAAU1W,OAC7B0W,EAAU1W,OAAQ6kB,EAAc7kB,EAAQglB,EAAehlB,GAAWA,EACnE7F,KAAK+pB,OAAQxC,EAAUC,GAGvB,IAAMsD,EAAwB,MAAfvO,EAAUjX,EAAYiX,EAAUjX,EAAGmlB,EAAazqB,KAAKoC,MAAOuoB,EAActD,UAAW/hB,GAAMA,EACpGylB,EAAwB,MAAfxO,EAAUhX,EAAYgX,EAAUhX,EAAGmlB,EAAc1qB,KAAK6F,OAAQ8kB,EAAcrD,SAAU/hB,GAAMA,EAC3GvF,KAAK6c,SAASrX,IAAKslB,EAAMC,IAG1B3E,2BAAA,WAMC,IALA,IAAMhkB,EAAQpC,KAAKoC,MACbyD,EAAS7F,KAAK6F,OACd1B,EAAUnE,KAAKqjB,GAEf5N,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,EAAQ1Q,EAAU7B,GACpBuS,aAAiBC,GACpBD,EAAMqE,eAAgBpoB,EAAOyD,EAAQ1B,KAWxCiiB,yBAAA,SAAc9gB,EAAWC,KAIf6gB,yBAAV,WAIC,IAHA,IAAM9gB,EAAItF,KAAKsF,EACTC,EAAIvF,KAAKuF,EACTkQ,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,EAAQ1Q,EAAU7B,GACpBuS,aAAiBC,GACpBD,EAAM6E,aAAc1lB,EAAGC,KAM1B6gB,oBAAA,SAASnQ,EAAegV,EAA8B9L,GAErD,OADAnf,KAAKiT,KAAM,QAASgD,EAAGgV,EAAQ9L,EAAQnf,OAChC,GAIRomB,sBAAA,SAAWnQ,GAEV,OADAjW,KAAKiT,KAAM,UAAWgD,EAAGjW,OAClB,GAGRomB,oBAAA,SAASnQ,GAER,OADAjW,KAAKiT,KAAM,QAASgD,EAAGjW,OAChB,GAIEomB,mBAAV,SAAkBnQ,GACjB,IAAMpV,EAASoV,EAAEpV,OACjB,GAAIA,IAAWb,KACdA,KAAKkrB,WAAYjV,QACX,KAAOpV,aAAkBulB,GAAU,CAEzC,IADA,IAAI7Q,EAAS1U,EAAOkU,OACH,MAAVQ,KAAsBA,aAAkB6Q,IAC9C7Q,EAASA,EAAOR,OAEbQ,IAAWvV,MACdA,KAAKkrB,WAAYjV,KAKVmQ,uBAAV,SAAsBnQ,GACrB,IAAMoC,EAAkBW,EAAasP,qBACrCjQ,EAAgBO,WAAYP,EAAgB8S,oBAAqBnrB,OAAQ,GAAM,IAIhFomB,uBAAA,SAAYnQ,GAEX,OADAjW,KAAKiT,KAAM,WAAYgD,EAAGjW,OACnB,GAIRomB,mBAAA,SAAQ5b,GACHxK,KAAKwP,SAAW,EAAIxP,KAAKorB,YAAcprB,KAAKqmB,aAC/CrmB,KAAKqrB,aAAc7gB,GACnBxE,YAAMslB,iBAAQ9gB,GACdxK,KAAKurB,YAAa/gB,KAIV4b,yBAAV,SAAwB5b,GAEvB,IADA,IAAMghB,EAAUxrB,KAAK+iB,GACZnP,EAAI,EAAGG,EAAOyX,EAAQ7Y,OAAQiB,EAAIG,IAAQH,EAAI,CACtD,IAAM6X,EAASD,EAAS5X,GACxB6X,EAAOC,kBACPD,EAAOH,OAAQ9gB,KAIP4b,wBAAV,SAAuB5b,GAEtB,IADA,IAAMmhB,EAAS3rB,KAAKgjB,GACXpP,EAAI,EAAGG,EAAO4X,EAAOhZ,OAAQiB,EAAIG,IAAQH,EAAI,CACrD,IAAMgY,EAAQD,EAAQ/X,GACtBgY,EAAMF,kBACNE,EAAMN,OAAQ9gB,KAKN4b,4BAAV,WACC,OAAO7I,EAAQ7c,cAAcsM,IAAKhN,KAAK6iB,YAG9BuD,oBAAV,WACC,MAAO,SAIEA,6BAAV,WACC,IAAMyF,EAAiB7rB,KAAK8hB,GAAW+J,eACjCC,EAAS9rB,KAAK+rB,QAEdC,EAAO5F,EAAM6F,oBACnBD,EAAKxmB,IAAK,EAAG,GACbqmB,EAAeK,MAAOF,EAAMA,GAC5BF,EAAOK,SAAUH,GAEjBA,EAAKxmB,IAAKxF,KAAKmC,EAAQnC,KAAKoG,GAC5BylB,EAAeK,MAAOF,EAAMA,GAC5BF,EAAOK,SAAUH,GAEjBhmB,YAAMomB,6BAGPhG,0BAAA,SAAenhB,GACd,OAAOjF,KAAKqsB,oBAAqBpnB,IAAWjF,KAAKssB,mBAChDtsB,KAAK6rB,eAAeU,aAActnB,EAAOmhB,EAAM6F,uBAIvC7F,gCAAV,SAA+BnhB,GAC9B,OAAO,GAGEmhB,+BAAV,SAA8BnhB,GAC7B,OACC,GAAKA,EAAMK,GAAKL,EAAMK,GAAKtF,KAAKoC,OAChC,GAAK6C,EAAMM,GAAKN,EAAMM,GAAKvF,KAAK6F,QAIlCugB,oBAAA,WAEC,IAAM7J,EAAYvc,KAAKyc,GACvBF,EAAUjX,EAAI,KACdiX,EAAUhX,EAAI,KACdgX,EAAUna,MAAQ,KAClBma,EAAU1W,OAAS,KAGnB,IAAMmf,EAAShlB,KAAK0iB,GAChBsC,IACHhlB,KAAK0iB,GAAU,KACfsC,EAAOnR,WAKR,IADA,IAAM4B,EAAWzV,KAAKyV,SACb7B,EAAI6B,EAAS9C,OAAS,EAAG,GAAKiB,IAAKA,EAC3C6B,EAAU7B,GAAIC,UAEf4B,EAAS9C,OAAS,EAGlB3M,YAAM6N,oBAnpCUuS,sBAA6B,IAAIoG,WADzCC,4BCxKT,aAAA,MACCzmB,YAAO,IAAIC,aAAc,IAAM,IAAIA,aAAc,IAAM,IAAIC,YAAa,kBACxEC,EAAK/D,MAAQ,EACb+D,EAAKN,OAAS,IA2NhB,OAnO0C/F,OAWzC4sB,mBAAA,SAAQC,EAAcC,EAAgCC,GACrD,IAAMC,EAAe9sB,KAAK4G,UAAW,mBAC/BmmB,EAAW/sB,KAAK4G,UAAW,iBAC3BomB,EAAchtB,KAAKkH,WAEnB3G,EAASP,KAAKitB,YAAaN,EAAMC,EAAOC,GACxCK,EAAmBjhB,KAAKkhB,KAAM5sB,EAAQ,GAAM,IAAO,EACnD6sB,EAAqBF,GAAoB,EAC1CJ,EAAahmB,KAAsB6L,OAASya,IAChDN,EAAahmB,KAAO,IAAIb,aAAcmnB,GACtCL,EAASjmB,KAAO,IAAIb,aAAcmnB,IAEnC,IAAMC,EAAuC,EAAnBH,EACrBF,EAAYlmB,KAAqB6L,OAAS0a,IAC9CL,EAAYlmB,KAAO,IAAIZ,YAAamnB,IAGrC,IAAMzkB,EAAWkkB,EAAahmB,KACxBgB,EAAMilB,EAASjmB,KACfe,EAAUmlB,EAAYlmB,KAE5B,GAAa,MAAT8lB,EAAgB,CAInB,IAHA,IAAItnB,EAAI,EACJC,EAAI,EACJ+nB,EAAQ,EACH1Z,EAAI,EAAGG,EAAOxT,EAAQ,GAAKqT,EAAIG,IAAQH,EAAI,CAEnD,IADA,IAAM2Z,EAAc,GAAT,EAAI3Z,GACN4G,EAAIja,EAAQgtB,EAAI,GAAK9S,EAAOla,EAAQgtB,EAAI,GAAK/S,EAAIC,EAAMD,GAAK,EAAG8S,GAAS,EAAI,CACpF,IAAME,EACG,OADHA,EAAIZ,EAAM5f,IAAK2f,EAAMnS,MAE1Bxa,KAAKytB,eACJ7kB,EAAUd,EAAKD,EACfylB,EAAOhoB,EAAGC,EACVioB,EAAGZ,EAAMxqB,MAAOwqB,EAAM/mB,QAEvBP,GAAKkoB,EAAEE,SAEP1tB,KAAK2tB,oBAAqB/kB,EAAUd,EAAKD,EAASylB,GAGhD/sB,EAAQgtB,EAAI,KAEN,OADHC,EAAIZ,EAAM5f,IAAK,SAEpBhN,KAAKytB,eACJ7kB,EAAUd,EAAKD,EACfylB,EAAOhoB,EAAGC,EACVioB,EAAGZ,EAAMxqB,MAAOwqB,EAAM/mB,QAEvBP,GAAKkoB,EAAEE,SAEP1tB,KAAK2tB,oBAAqB/kB,EAAUd,EAAKD,EAASylB,GAEnDA,GAAS,GAEVhoB,EAAI,EACJC,GAAKqnB,EAAMgB,KAAK/nB,OAEjB,IAAS+N,EAAI0Z,EAAOvZ,EAAOnL,EAAS+J,QAAU,EAAGiB,EAAIG,IAAQH,EAC5D5T,KAAK2tB,oBAAqB/kB,EAAUd,EAAKD,EAAS+L,GAEnD5T,KAAKoC,MAAQ7B,EAAQ,GACrBP,KAAK6F,OAASN,MACR,CACN,IAASqO,EAAI,EAAGG,EAAOnL,EAAS+J,QAAU,EAAGiB,EAAIG,IAAQH,EACxD5T,KAAK2tB,oBAAqB/kB,EAAUd,EAAKD,EAAS+L,GAEnD5T,KAAKoC,MAAQ,EACbpC,KAAK6F,OAAS,EAGfinB,EAAansB,SACbosB,EAASpsB,SACTqsB,EAAYrsB,UAGH+rB,2BAAV,SACC9jB,EAAwBd,EAAmBD,EAC3C2N,EAAelQ,EAAWC,EAC1BsoB,EACAzrB,EAAeyD,GAEf,IAAMioB,EAAUD,EAAUvoB,EAAIuoB,EAAUE,OAAOzoB,EAGzCgC,EAAKkO,GAAS,EACpB5M,EAAUtB,EAAK,GAAMhC,EAAIwoB,EACzBllB,EAAUtB,EAAK,GAAM/B,EAJL,EAKhBqD,EAAUtB,EAAK,GAAMhC,EAAIwoB,EAAUD,EAAUzrB,MAC7CwG,EAAUtB,EAAK,GAAM/B,EANL,EAOhBqD,EAAUtB,EAAK,GAAMhC,EAAIwoB,EAAUD,EAAUzrB,MAC7CwG,EAAUtB,EAAK,GAAM/B,EARL,EAQmBsoB,EAAUhoB,OAC7C+C,EAAUtB,EAAK,GAAMhC,EAAIwoB,EACzBllB,EAAUtB,EAAK,GAAM/B,EAVL,EAUmBsoB,EAAUhoB,OAE7C,IAAM2B,EAAKqmB,EAAUvoB,EAAIlD,EACnBsF,EAAKmmB,EAAUtoB,EAAIM,EACnB4B,GAAOomB,EAAUvoB,EAAIuoB,EAAUzrB,OAAUA,EACzCuF,GAAOkmB,EAAUtoB,EAAIsoB,EAAUhoB,QAAWA,EAChDiC,EAAKR,EAAK,GAAME,EAChBM,EAAKR,EAAK,GAAMI,EAChBI,EAAKR,EAAK,GAAMG,EAChBK,EAAKR,EAAK,GAAMI,EAChBI,EAAKR,EAAK,GAAMG,EAChBK,EAAKR,EAAK,GAAMK,EAChBG,EAAKR,EAAK,GAAME,EAChBM,EAAKR,EAAK,GAAMK,EAEhB,IAAMC,EAAa,EAAR4N,EACLwY,EAAKxY,GAAS,EACpB3N,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,GAGhBtB,gCAAV,SACC9jB,EAAwBd,EAAmBD,EAC3C2N,GAEA,IAAMlO,EAAKkO,GAAS,EACpB5M,EAAUtB,EAAK,GAAM,EACrBsB,EAAUtB,EAAK,GAAM,EACrBsB,EAAUtB,EAAK,GAAM,EACrBsB,EAAUtB,EAAK,GAAM,EACrBsB,EAAUtB,EAAK,GAAM,EACrBsB,EAAUtB,EAAK,GAAM,EACrBsB,EAAUtB,EAAK,GAAM,EACrBsB,EAAUtB,EAAK,GAAM,EAErBQ,EAAKR,EAAK,GAAM,EAChBQ,EAAKR,EAAK,GAAM,EAChBQ,EAAKR,EAAK,GAAM,EAChBQ,EAAKR,EAAK,GAAM,EAChBQ,EAAKR,EAAK,GAAM,EAChBQ,EAAKR,EAAK,GAAM,EAChBQ,EAAKR,EAAK,GAAM,EAChBQ,EAAKR,EAAK,GAAM,EAEhB,IAAMM,EAAa,EAAR4N,EACLwY,EAAKxY,GAAS,EACpB3N,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,EACzBnmB,EAASD,EAAK,GAAMomB,EAAK,GAGhBtB,wBAAV,SACCC,EAAcC,EAAgCC,GAE9C,IAAItsB,EAASmsB,EAAqBuB,KAAOvB,EAAqBuB,MAAQ,IAAIC,YAAa,IAKvF,GAJA3tB,EAAQ,GAAM,EACdA,EAAQ,GAAM,EACdA,EAAQ,GAAM,EACdA,EAAQ,GAAM,EACD,MAATqsB,EAAgB,CAGnB,IAFA,IAAItnB,EAAI,EACF4D,EAAIyjB,EAAKha,OACNiB,EAAI,EAAGA,EAAI1K,IAAK0K,EAAI,CAC5B,IAAMua,EAAOxB,EAAM/Y,GACnB,GAAa,OAATua,EACH5tB,EAASP,KAAKouB,UAAW7tB,EAAQqT,GAAG,EAAOtO,EAAGsO,EAAI,GAClDtO,EAAI,MACE,CACN,IAAMkoB,EAAIZ,EAAM5f,IAAKmhB,GACrB,GAAS,MAALX,EACH,GAAqB,MAAjBX,GAAyBA,EAAgBvnB,EAAIkoB,EAAEE,QAAU,CAI5D,IAHA,IAAMW,EAAOzB,EAAM5f,IAAK,OAClBshB,EAAkB,MAARD,GAAgBxB,EAAgBvnB,EAAI+oB,EAAKX,QAAW9Z,EAAI,EAAIA,EACxE2a,EAAQ3a,EAAI,EACT2a,EAAQrlB,IAAKqlB,EACnB,GAAsB,OAAlB5B,EAAM4B,GAAmB,CAC5BA,GAAS,EACT,MAGFhuB,EAASP,KAAKouB,UAAW7tB,EAAQ+tB,GAAM,EAAMhpB,EAAGipB,GAChD3a,EAAI2a,EAAQ,EACZjpB,EAAI,OAEJA,GAAKkoB,EAAEE,SAKXntB,EAASP,KAAKouB,UAAW7tB,EAAQ2I,GAAG,EAAO5D,EAAG4D,GAE/C,OAAO3I,GAGEmsB,sBAAV,SAAqBnsB,EAAqB+tB,EAAcE,EAAkBlpB,EAAWipB,GACpF,IAAME,EAAgC,GAApB,EAAIluB,EAAQ,IAC1BmuB,EAASnuB,EAAQkuB,EAAU,GAC/B,GAAIC,EAASJ,GAAQE,EAAU,CAK9B,GAJAE,EAASziB,KAAK0iB,IAAKD,EAAQJ,GAC3B/tB,EAAQkuB,EAAU,GAAMC,EACxBnuB,EAAQkuB,EAAU,GAAMH,EACxB/tB,EAAQkuB,EAAU,GAAQD,EAAU,EAAI,EACpCjuB,EAAOoS,QAAU8b,EAAU,EAAI,CAClC,IAAMG,EAAY,IAAIV,YAAa3tB,EAAOoS,OAAS,IACnDic,EAAUppB,IAAKjF,GACfA,EAASquB,EACTlC,EAAqBuB,KAAOW,EAE7BruB,EAAQ,IAAO,EACfA,EAAQ,IAAO+tB,EAAOI,EACtBnuB,EAAQ,GAAM0L,KAAKC,IAAK3L,EAAQ,GAAK0L,KAAKkhB,KAAM7nB,IAChD/E,EAAQkuB,EAAU,GAAMF,OAExBhuB,EAAQkuB,EAAU,GAAMF,EAEzB,OAAOhuB,GAhOSmsB,OAA2B,QADHviB,8BC+BzC,WAAapJ,EAA+Ca,GAC3D5B,KAAK6uB,GAAM,EACX7uB,KAAK8uB,IAAe,EAEpB,IAAMlB,EAAOmB,EAAkBC,KAC9BD,EAAkBC,MAAQzR,EAAQ7c,cAAcsM,IAAK,SAEtDhN,KAAKqC,EAAUtB,GAAWA,EAAQuB,OAAU,OAC5CtC,KAAKivB,GAAeluB,GAAWA,EAAQmuB,YAAetB,EAAKuB,iBAC3DnvB,KAAKovB,GAAaruB,GAAWA,EAAQsuB,UAAazB,EAAK0B,cACvDtvB,KAAKuvB,GAAcxuB,GAAWA,EAAQyuB,WAAc,SACpDxvB,KAAKyvB,GAAgB1uB,GAAWA,EAAQ2uB,aAAgB,SACxD1vB,KAAK2vB,GAAe5uB,GAAWA,EAAQ6uB,YAAe,SAEtD5vB,KAAK6vB,IAAa,EAClB7vB,KAAK8vB,GAAU,GACf9vB,KAAK+vB,GAAkB,GAEvB/vB,KAAKgwB,GAASjvB,GAAWA,EAAQkvB,MAASrC,EAAKxe,SAAU,GACzDpP,KAAKkwB,GAAgB,EAErBlwB,KAAKmwB,IAAcpvB,GAA+B,MAApBA,EAAQqvB,UAAoBrvB,EAAQqvB,SAElEpwB,KAAKqwB,GAAYzuB,EA2HnB,OAxHCpC,sBAAIuvB,sBAAJ,WACC,OAAO/uB,KAAK6uB,oCAGbrvB,sBAAIuvB,8BAAJ,WACC,OAAO/uB,KAAK8uB,oCAGbtvB,sBAAIuvB,0BAAJ,WAEC,OADA/uB,KAAKW,SACEX,KAAK8vB,oCAGbtwB,sBAAIuvB,kCAAJ,WACC,OAAO/uB,KAAK+vB,oCAGbvwB,sBAAIuvB,wBAAJ,WACC,OAAO/uB,KAAKgwB,QAGb,SAAUC,GACLjwB,KAAKgwB,KAAUC,IAClBjwB,KAAKgwB,GAAQC,EACbjwB,KAAK4B,6CAIGmtB,qBAAV,WACC/uB,KAAK6uB,IAAO,EACZ7uB,KAAKqwB,MAGN7wB,sBAAIuvB,gCAAJ,WACC,OAAO/uB,KAAKkwB,oCAGbnB,oBAAA,WACC/uB,KAAKW,SACLX,KAAK8uB,GAAc9uB,KAAK6uB,GACxB7uB,KAAK+vB,GAAkB/vB,KAAK8vB,GAC5B9vB,KAAKkwB,GAAgBlwB,KAAKgwB,IAG3BxwB,sBAAIuvB,8BAAJ,WACC,OAAO/uB,KAAKivB,QAGb,SAAgBC,GACXlvB,KAAKivB,KAAgBC,IACxBlvB,KAAKivB,GAAcC,EACnBlvB,KAAK4B,6CAIPpC,sBAAIuvB,4BAAJ,WACC,OAAO/uB,KAAKovB,QAGb,SAAcC,GACTrvB,KAAKovB,KAAcC,IACtBrvB,KAAKovB,GAAYC,EACjBrvB,KAAK4B,6CAIPpC,sBAAIuvB,6BAAJ,WACC,OAAO/uB,KAAKuvB,QAGb,SAAeC,GACVxvB,KAAKuvB,KAAeC,IACvBxvB,KAAKuvB,GAAaC,EAClBxvB,KAAK4B,6CAIPpC,sBAAIuvB,+BAAJ,WACC,OAAO/uB,KAAKyvB,QAGb,SAAiBC,GACZ1vB,KAAKyvB,KAAiBC,IACzB1vB,KAAKyvB,GAAeC,EACpB1vB,KAAK4B,6CAIPpC,sBAAIuvB,8BAAJ,WACC,OAAO/uB,KAAK2vB,QAGb,SAAgBC,GACX5vB,KAAK2vB,KAAgBC,IACxB5vB,KAAK2vB,GAAcC,EACnB5vB,KAAK4B,6CAIGmtB,mBAAV,WACK/uB,KAAK6vB,KAAc7vB,KAAK6uB,KAC3B7uB,KAAK6vB,GAAY7vB,KAAK6uB,GACtB7uB,KAAK8vB,GAAU9vB,KAAKswB,cAIZvB,sBAAV,WACC,OAAU/uB,KAAKuvB,OAAcvvB,KAAKyvB,OAAgBzvB,KAAK2vB,OAAe3vB,KAAKovB,SAAepvB,KAAKivB,IAGhGzvB,sBAAIuvB,4BAAJ,WACC,OAAO/uB,KAAKmwB,QAGb,SAAcC,GACTpwB,KAAKmwB,KAAcC,IACtBpwB,KAAKmwB,GAAYC,EACjBpwB,KAAK4B,6CAjKUmtB,OAA0B,UCjB/BwB,GACZ,uGCGA,SAAajrB,EAAWC,GACvBvF,KAAKsF,EAAIA,EACTtF,KAAKuF,EAAIA,MCOV,SAAamoB,EAAiBtrB,EAAeyD,EAAgB2qB,GAC5DxwB,KAAKywB,IAAM,EACXzwB,KAAK0wB,KAAO,GACZ1wB,KAAKsF,EAAI,EACTtF,KAAKuF,EAAI,EACTvF,KAAKoC,MAAQA,EACbpC,KAAK6F,OAASA,EACd7F,KAAK0tB,QAAUA,EACf1tB,KAAK+tB,OAAS,IAAI4C,GAAiC,EAAG,GACtD3wB,KAAKwwB,SAAWA,MCXjB,SAAaI,EAAgBzkB,EAAc9K,EAAe8C,GACzDnE,KAAK6wB,GAAKD,EACV5wB,KAAKmM,KAAOA,EACZnM,KAAKqB,MAAQ8S,QAAM2c,WAAYzvB,GAC/BrB,KAAK6F,OAAS7F,KAAKmM,KAAiB,EAAVhI,EAC1B,IAAM4sB,EAAUC,cAAYC,YAAaL,GACzC5wB,KAAKkxB,OAASH,EAAQG,OACtBlxB,KAAKmxB,QAAUJ,EAAQI,SCZnBnV,GAAU,gBAgBf,WAAa4U,EAAgBvB,EAAkB+B,GAC9CpxB,KAAK6uB,GAAM+B,EACX5wB,KAAKqxB,GAAUzZ,SAAS0Z,cAAe,UACvCtxB,KAAKuxB,GAAW,KAChBvxB,KAAKwxB,GAAQ,IAAIC,GAAsBb,EAAQvB,EAAU+B,EAAWpV,IACpEhc,KAAK0xB,GAAc,GACnB1xB,KAAK2xB,GAAU,EACf3xB,KAAK4xB,GAAc,EACnB5xB,KAAKmC,EAAS,EACdnC,KAAKoG,EAAU,EACfpG,KAAK6xB,GAAY,EACjB7xB,KAAK8xB,GAAmB,EACxB9xB,KAAKqG,EAAWuG,UAAQC,KAAM7M,KAAKqxB,GAAS,CAC3CU,OAAQC,eAAaC,IACrBxlB,WAAYC,WAASC,WACrBulB,UAAWC,cAAYC,UAGxBpyB,KAAKqyB,IAAK9B,IAAkB,GAC5BvwB,KAAKsyB,GAAM,MAAOtyB,KAAK0xB,IAAa,GAoOtC,OAjOClyB,sBAAI+yB,sBAAJ,WACC,OAAOvyB,KAAK6uB,oCAGbrvB,sBAAI+yB,wBAAJ,WACC,OAAOvyB,KAAKwxB,oCAGbhyB,sBAAI+yB,yBAAJ,WACC,OAAOvyB,KAAKmC,mCAGb3C,sBAAI+yB,0BAAJ,WACC,OAAOvyB,KAAKoG,mCAGb5G,sBAAI+yB,0BAAJ,WACC,OAAOvyB,KAAKqxB,oCAGb7xB,sBAAI+yB,8BAAJ,WACC,OAAOvyB,KAAK0xB,oCAGblyB,sBAAI+yB,2BAAJ,WACC,OAAOvyB,KAAKqG,mCAGHksB,eAAV,SAAgB1E,EAAmB2E,EAAwChC,GAC1E,GAAkB,OAAd3C,EAAqB,CACxB,IAAM/mB,EAAO0rB,EAAY3E,GACzB,GAAY,MAAR/mB,EACGA,EAAK0pB,WACO,IAAb1pB,EAAK2pB,MACRzwB,KAAK4xB,IAAe,GAErB9qB,EAAK2pB,KAAO,OAEP,CACN,IAAM/C,EAAU1tB,KAAKyyB,WAAY5E,GAC3BzrB,EAAQ6J,KAAKkhB,KAAMnR,GAAU0R,EAAU1R,IACvCnW,EAAS7F,KAAK4tB,KAAK/nB,OACzB2sB,EAAY3E,GAAc,IAAI6E,GAA2BhF,EAAStrB,EAAOyD,IAAW2qB,GACpFxwB,KAAK2xB,IAAW,EAChB3xB,KAAK6xB,IAAa,KAKXU,eAAV,SAAmB1E,EAAmB2E,GACrC,GAAkB,OAAd3E,EAAqB,CACxB,IAAM/mB,EAAO0rB,EAAY3E,GACb,MAAR/mB,IACGA,EAAK0pB,UAAY,EAAI1pB,EAAK2pB,MAC/B3pB,EAAK2pB,KAAO,EACK,IAAb3pB,EAAK2pB,MACRzwB,KAAK4xB,IAAe,MAOfW,eAAV,WACC,GAAKvyB,KAAK2xB,IAAW,GAAM3xB,KAAK4xB,GAAc,CAC7C,IAAMY,EAAaxyB,KAAK0xB,GACxB,IAAK,IAAM7D,KAAa2E,EACnBA,EAAY3E,GAAY4C,KAAO,UAC3B+B,EAAY3E,GAGrB7tB,KAAK2xB,IAAW3xB,KAAK4xB,GACrB5xB,KAAK6xB,IAAa,EAClB7xB,KAAK4xB,GAAc,IAIrBW,gBAAA,SAAKI,EAAiBnC,GAErB,IADA,IAAMgC,EAAaxyB,KAAK0xB,GACf9d,EAAI,EAAGG,EAAO4e,EAAQhgB,OAAQiB,EAAIG,IAAQH,EAClD5T,KAAKsyB,GAAMK,EAAS/e,GAAK4e,EAAYhC,IAIvC+B,mBAAA,SAAQI,GAEP,IADA,IAAMH,EAAaxyB,KAAK0xB,GACf9d,EAAI,EAAGG,EAAO4e,EAAQhgB,OAAQiB,EAAIG,IAAQH,EAClD5T,KAAK4yB,GAASD,EAAS/e,GAAK4e,IAI9BD,gBAAA,SAAK1E,GACJ,OAAO7tB,KAAK0xB,GAAa7D,IAG1B0E,uBAAA,SAAY1xB,GACX,IAAMgyB,EAAU7yB,KAAK8yB,aACrB,OAAe,MAAXD,EACIA,EAAQ5F,YAAapsB,GAASuB,MAE/B,GAGRmwB,uBAAA,WACC,IAAIM,EAAU7yB,KAAKuxB,GACnB,GAAe,MAAXsB,EAAkB,CACrB,IAAME,EAAS/yB,KAAKqxB,GACpB,GAAc,MAAV0B,EAMH,OAAO,KAJP,GAAe,OADfF,EAAU7yB,KAAKuxB,GAAWwB,EAAOD,WAAY,KAAM,CAAEvxB,OAAO,KAE3D,OAAO,KAOV,IAAMqsB,EAAO5tB,KAAKwxB,GAalB,OAZIqB,EAAQjF,OAASA,EAAKiD,KACzBgC,EAAQjF,KAAOA,EAAKiD,GACpBjD,EAAKiD,GAAKgC,EAAQjF,KAClBiF,EAAQG,UAAY,OACpBH,EAAQI,aAAe,aACvBJ,EAAQK,UAAY,EACpBL,EAAQM,QAAU,QAClBN,EAAQO,SAAW,QACnBP,EAAQQ,WAAa,EACrBR,EAAQS,UAAY1F,EAAKvsB,MACzBwxB,EAAQU,YAAc,WAEhBV,GAGRN,mBAAA,WAGC,GAFAvyB,KAAKwzB,KAEDxzB,KAAK8xB,GAAmB9xB,KAAK6xB,GAAY,CAC5C7xB,KAAK8xB,GAAmB9xB,KAAK6xB,GAE7B,IAAMkB,EAAS/yB,KAAKqxB,GACpB,GAAc,MAAV0B,EAAiB,CACpB,IAAMnF,EAAO5tB,KAAKwxB,GACZiC,EAAa7F,EAAK/nB,OAClB2sB,EAAaxyB,KAAK0xB,GAClBtvB,EAAQpC,KAAKmC,EAASnC,KAAK0zB,WAAYznB,KAAKkhB,KAAMlhB,KAAK0nB,KAAM3zB,KAAK2xB,KAAc8B,GAEhF3F,EAAU9R,GACV4X,EAAU3nB,KAAK4nB,MAAqD,IAA7CJ,GAAc7F,EAAKsD,OAAStD,EAAKuD,UAAkBvD,EAAKsD,QACjF5rB,EAAI,EACJC,EAAI,EACR,IAAK,IAAM2Q,KAAOsc,EAEbpwB,GAASkD,GADPuoB,EAAY2E,EAAYtc,IACH9T,QAC1BkD,EAAI,EACJC,GAAKkuB,GAGN5F,EAAUvoB,EAAIA,EACduoB,EAAUtoB,EAAIA,EACdsoB,EAAUE,OAAOzoB,EAAIA,EAAIwoB,EACzBD,EAAUE,OAAOxoB,EAAIA,EAAIquB,EAEzBtuB,GAAKuoB,EAAUzrB,MAEhB,IAAMyD,EAAS7F,KAAKoG,EAAUb,EAAIkuB,EAK5BK,EAAc9zB,KAAKqG,EAASytB,YAC5BrnB,EAAaqnB,EAAYrnB,WACzBsnB,EAAY9nB,KAAKkhB,KAAM/qB,EAAQqK,GAC/BunB,EAAa/nB,KAAKkhB,KAAMtnB,EAAS4G,GACvCsmB,EAAO3wB,MAAQ2xB,EACfhB,EAAOltB,OAASmuB,EAChB,IAAMnB,EAAU7yB,KAAK8yB,aACrB,GAAe,MAAXD,EAAkB,CAIrB,IAAK,IAAM3c,KAHX2c,EAAQoB,OACRpB,EAAQ5Q,MAAOxV,EAAYA,GAC3BomB,EAAQqB,UAAW,EAAG,EAAG9xB,EAAOyD,GACd2sB,EAAa,CAC9B,IAAM3E,EAAY2E,EAAYtc,GAC9B2c,EAAQsB,SAAUje,EAAK2X,EAAUE,OAAOzoB,EAAGuoB,EAAUE,OAAOxoB,GAE7DstB,EAAQuB,UAIT,OAFAN,EAAYO,YAAaN,EAAWC,IAE7B,GAGT,OAAO,GAGRzB,wBAAA,WACC,OAAOvyB,KAAK6xB,IAGbU,8BAAA,WACC,OAAOvyB,KAAK8xB,IAGbtyB,sBAAI+yB,0BAAJ,WACC,OAAOvyB,KAAK2xB,oCAGbY,oBAAA,WAEe,MADCvyB,KAAKqxB,KAEnBrxB,KAAKqxB,GAAU,MAGhB,IAAMmB,EAAaxyB,KAAK0xB,GACxB,IAAK,IAAM7D,KAAa2E,SAChBA,EAAY3E,IAIrB0E,uBAAA,SAAYpmB,GAEX,IADA,IAAI5L,EAAS,GACNA,EAAS4L,GACf5L,IAAW,EAEZ,OAAOA,QCxQHI,GAAS,SAAEisB,GAChBA,EAAMjsB,UAGD2zB,GAAY,SAAEC,GACnBA,EAAaC,QAAS7zB,KAGjBkT,GAAU,SAAE+Y,GACjBA,EAAMjsB,UAGD8zB,GAAa,SAAEF,GACpBA,EAAaC,QAAS3gB,mBAOtB,aAAA,WACC7T,KAAK00B,GAAW,IAAInnB,IAEpBlN,EAAcK,cAAc8J,SAAS2C,GAAI,aAAa,WACrDhH,EAAKxF,YA0DR,OAtDCg0B,gBAAA,SAAK/D,EAAgBvB,EAAkB+B,EAAmBuB,GACzD,IAAMiC,EAAU50B,KAAK00B,GACjBG,EAAeD,EAAQ5nB,IAAK4jB,GACZ,MAAhBiE,IACHA,EAAe,IAAItnB,IACnBqnB,EAAQpvB,IAAKorB,EAAQiE,IAEtB,IAAIjI,EAAQiI,EAAa7nB,IAAKokB,GACjB,MAATxE,IACHA,EAAQ,IAAI2F,GAAkB3B,EAAQvB,EAAU+B,GAChDyD,EAAarvB,IAAK4rB,EAAWxE,IAE9BA,EAAMyF,IAAKM,IAGZgC,mBAAA,SAAQ/D,EAAgBQ,EAAmBuB,GAC1C,IAAMkC,EAAe70B,KAAK00B,GAAS1nB,IAAK4jB,GACxC,GAAoB,MAAhBiE,EAAuB,CAC1B,IAAMjI,EAAQiI,EAAa7nB,IAAKokB,GACnB,MAATxE,GACHA,EAAMnZ,OAAQkf,KAKjBgC,gBAAA,SAAK/D,EAAgBQ,GACpB,IACMyD,EADU70B,KAAK00B,GACQ1nB,IAAK4jB,GAClC,GAAoB,MAAhBiE,EACH,OAAO,KAER,IAAMjI,EAAQiI,EAAa7nB,IAAKokB,GAChC,OAAa,MAATxE,EACI,KAEDA,GAGR+H,mBAAA,WACC30B,KAAK00B,GAASF,QAASF,KAGxBK,oBAAA,WACC,IAAMC,EAAU50B,KAAK00B,GACrBE,EAAQJ,QAASC,IACjBG,EAAQzR,SAGFwR,cAAP,WAIC,OAHmC,MAA/BA,EAAmBn0B,WACtBm0B,EAAmBn0B,SAAW,IAAIm0B,GAE5BA,EAAmBn0B,UA/DVm0B,WAAsC,yBCEvD,WAAahI,EAAc5rB,GAA3B,MACCiF,YAAO,IAAI0mB,GAAwB,IAAItiB,eAAcwC,UAAQkoB,qBAE7D3uB,EAAK4uB,GAAS,IAAIhG,GAAmBhuB,GAAS,WAC7CoF,EAAKK,GAAW,EAChBL,EAAK6uB,IAAmB,EACxB7uB,EAAK8uB,GAAS,KACd9uB,EAAK+uB,QAEN/uB,EAAKgvB,GAAQxI,EACbxmB,EAAKivB,GAAgB,GACrBjvB,EAAKK,GAAW,EAChBL,EAAK6uB,IAAmB,EACxB7uB,EAAK8uB,GAAS,KACd9uB,EAAKkvB,GAAwB,EAC7BlvB,EAAKhE,EAAS,EACdgE,EAAKC,EAAU,EACfD,EAAKmvB,GAAsB,EAC3BnvB,EAAK+uB,OAgIP,OAjKkCp1B,OAoCvBy1B,eAAV,WACC,IAAMC,EAAQx1B,KAAK+0B,GACnB,GAAI/0B,KAAKwG,EAAW,CACnBxG,KAAKwG,GAAW,EAEhB,IAAMmmB,EAAO3sB,KAAKm1B,GACZM,EAAez1B,KAAKo1B,GAC1Bp1B,KAAKo1B,GAAgBzI,EACrB,IAAMiE,EAAS4E,EAAM5E,OACf8E,EAAiBF,EAAME,eACvBrG,EAAWmG,EAAMnG,SACjBY,EAAOuF,EAAMvF,KACb0F,EAAeH,EAAMG,aAC3BH,EAAMI,UAEN,IAAMhB,EAAUD,GAAmBj0B,cAC/BisB,IAAS8I,GAAgB7E,IAAW8E,GAAkBzF,IAAS0F,IAClEf,EAAQvC,IAAKzB,EAAQvB,EAAUY,EAAMtD,GACrCiI,EAAQnhB,OAAQiiB,EAAgBC,EAAcF,MAKjDj2B,sBAAI+1B,wBAAJ,WACC,OAAOv1B,KAAKm1B,QAGb,SAAUxI,GACL3sB,KAAKm1B,KAAUxI,IAClB3sB,KAAKm1B,GAAQxI,EACb3sB,KAAKwG,GAAW,EAChBxG,KAAKg1B,IAAmB,EACxBh1B,KAAKk1B,uCAIP11B,sBAAI+1B,yBAAJ,WAEC,OADAv1B,KAAKW,SACEsL,KAAKoT,IAAKrf,KAAKiiB,MAAM3c,GAAMtF,KAAKuK,SAASnI,WAGjD,SAAWA,GACVpC,KAAKW,SACL,IAAMk1B,EAAgB71B,KAAKuK,SAASnI,MACpC,GAAI,KAAQyzB,EAAgB,CAC3B,IAAMC,EAAW1zB,EAAQyzB,EACzB71B,KAAKiiB,MAAM3c,EAAM,GAAKtF,KAAKiiB,MAAM3c,GAAKwwB,GAAYA,oCAIpDt2B,sBAAI+1B,0BAAJ,WAEC,OADAv1B,KAAKW,SACEsL,KAAKoT,IAAKrf,KAAKiiB,MAAM1c,GAAMvF,KAAKuK,SAAS1E,YAGjD,SAAYA,GACX7F,KAAKW,SACL,IAAMo1B,EAAiB/1B,KAAKuK,SAAS1E,OACrC,GAAI,KAAQkwB,EAAiB,CAC5B,IAAMD,EAAWjwB,EAASkwB,EAC1B/1B,KAAKiiB,MAAM1c,EAAM,GAAKvF,KAAKiiB,MAAM1c,GAAKuwB,GAAYA,oCAIpDt2B,sBAAI+1B,yBAAJ,WACC,OAAOv1B,KAAK+0B,oCAGbQ,mBAAA,WACCv1B,KAAKk1B,KAEL,IAAItI,EAAQ5sB,KAAKi1B,GACjB,GAAa,MAATrI,EAAgB,CACnB,IAAM4I,EAAQx1B,KAAK+0B,GAEN,OADbnI,EAAQ+H,GAAmBj0B,cAAcsM,IAAKwoB,EAAM5E,OAAQ4E,EAAMvF,SAEjEjwB,KAAKq1B,GAAwBzI,EAAMoJ,oBACnCh2B,KAAKi1B,GAASrI,EACd5sB,KAAK4F,QAAUgnB,EAAMhnB,QACrB5F,KAAKg1B,IAAmB,OAEnB,CACN,IAAMiB,EAAiBrJ,EAAMoJ,oBACzBC,IAAmBj2B,KAAKq1B,KAC3Br1B,KAAKq1B,GAAwBY,EAC7Bj2B,KAAKg1B,IAAmB,GAI1B,IAAMnI,EAAgB7sB,KAAKk2B,GACrBC,EAAmBn2B,KAAKo2B,mBAC1BvJ,IAAkBsJ,IACrBn2B,KAAKk2B,GAAiBC,EACtBn2B,KAAKg1B,IAAmB,GAGrBh1B,KAAKg1B,KACRh1B,KAAKg1B,IAAmB,EACxBh1B,KAAKuK,SAAS5J,OAAQX,KAAKm1B,GAAOvI,EAAOuJ,KAIjCZ,6BAAV,WACC,GAAIv1B,KAAK+0B,GAAO3E,SAAW,CAC1B,IAAM7a,EAASvV,KAAK+U,OACpB,GAAIQ,aAAkB6Q,GACrB,OAAO7Q,EAAOnT,MAAQmT,EAAOpR,QAAQkjB,UAAY9R,EAAOpR,QAAQ6lB,WAAahqB,KAAKs1B,KAMrFC,kCAAA,SAAuBnzB,GACtBpC,KAAKs1B,GAAsBlzB,GAG5BmzB,6BAAA,WACCv1B,KAAKW,SACLqF,YAAMomB,6BAGPmJ,oBAAA,SAAS/qB,GACRxK,KAAKW,SACJqF,YAAMyE,kBAAiBD,OA/JQE,SdPlC,SAAY0S,GACXA,mBACAA,uBACAA,qBAHD,CAAYA,IAAAA,OCAZ,SAAYC,GACXA,iBACAA,uBACAA,uBAHD,CAAYA,IAAAA,OCAZ,SAAYC,GACXA,mBACAA,yBACAA,uBAHD,CAAYA,IAAAA,OaGZ,mBACC,WAAavI,GAAb,MACC/O,0BACCG,EAAa4O,OAASA,IAczB,OAjB6CjV,OAM5Cu2B,mBAAA,SAAQ7rB,GACPxK,KAAK0rB,kBACL1lB,YAAMslB,iBAAQ9gB,IAGf6rB,qBAAA,SAAU5oB,EAAarL,EAAeyD,GACrC7F,KAAKmjB,QACLnjB,KAAKs2B,UAAW,SAAU,GAC1Bt2B,KAAKu2B,SAAU,EAAG,EAAGn0B,EAAOyD,GAC5B7F,KAAKw2B,cAfsCC,2BCyI7C,4DAiOA,OA7NU32B,OAgBC42B,iBAAV,SAAgB31B,GACfiF,YAAMggB,eAAMjlB,GAEZf,KAAKm1B,GAAQ,KACb,IAAMr0B,EAAQd,KAAKc,MACnBd,KAAK22B,GAhHa,SACnB71B,EACAC,GAEA,OAAIA,GAAWA,EAAQ4rB,WAA+BjrB,IAAvBX,EAAQ4rB,KAAKiK,MACpC71B,EAAQ4rB,KAAKiK,MAEd91B,EAAM+1B,eAyGMC,CAAah2B,EAAOC,GACtCf,KAAK+2B,GAAqB/2B,KAAKg3B,mBAC/Bh3B,KAAKi3B,GAAel2B,GAAWA,EAAQ4rB,MAAQ5rB,EAAQ4rB,KAAKtrB,MAC5DrB,KAAKk3B,GAAen2B,GAAWA,EAAQ4rB,MAAQ5rB,EAAQ4rB,KAAKprB,MAC5DvB,KAAKm3B,GA1Ga,SACnBr2B,EAAuBC,EAAqDU,GAE5E,GAAIV,GAAWA,EAAQ4rB,MAA8B,MAAtB5rB,EAAQ4rB,KAAK6I,MAAgB,CAC3D,IAAMA,EAAQz0B,EAAQ4rB,KAAK6I,MAQ3B,MAAO,CACNvF,KAR0B,MAAduF,EAAMvF,KAAeuF,EAAMvF,KAAOnvB,EAAMsO,SAAU3N,GAS9D4tB,SARkC,MAAlBmG,EAAMnG,SAAmBmG,EAAMnG,SAAWvuB,EAAMwuB,cAShEJ,WARsC,MAApBsG,EAAMtG,WAAqBsG,EAAMtG,WAAapuB,EAAMquB,iBAStES,WARsC,MAApB4F,EAAM5F,WAAqB4F,EAAM5F,WAAa9uB,EAAMs2B,gBAStE5H,UARoC,MAAnBgG,EAAMhG,UAAoBgG,EAAMhG,UAAY1uB,EAAMu2B,eASnE3H,YARwC,MAArB8F,EAAM9F,YAAsB8F,EAAM9F,YAAc5uB,EAAMw2B,iBASzElH,SARkC,MAAlBoF,EAAMpF,SAAmBoF,EAAMpF,SAAWtvB,EAAMy2B,wBAYlE,MAAO,CACNtH,KAAMnvB,EAAMsO,SAAU3N,GACtB4tB,SAAUvuB,EAAMwuB,cAChBJ,WAAYpuB,EAAMquB,iBAClBS,WAAY9uB,EAAMs2B,gBAClB5H,UAAW1uB,EAAMu2B,eACjB3H,YAAa5uB,EAAMw2B,iBACnBlH,SAAUtvB,EAAMy2B,wBA4EEC,CAAa12B,EAAOC,EAASf,KAAKyB,OACpDzB,KAAKy3B,GAzEa,SACnB32B,EAAuBC,GAEvB,GAAIA,GAAWA,EAAQ4rB,MAAQ5rB,EAAQ4rB,KAAKrqB,MAAQ,CACnD,IAAMA,EAAQvB,EAAQ4rB,KAAKrqB,MAS3B,MAAO,CACNo1B,SAToC,MAAlBp1B,EAAMo1B,SACtB31B,EAAcO,EAAMo1B,UAAara,EAAgB/a,EAAMo1B,UAAap1B,EAAMo1B,SAC5E52B,EAAM62B,uBAQNC,WANwC,MAApBt1B,EAAMs1B,WACxB71B,EAAcO,EAAMs1B,YAAexa,EAAkB9a,EAAMs1B,YAAet1B,EAAMs1B,WAClF92B,EAAM+2B,0BAOR,MAAO,CACNH,SAAU52B,EAAM62B,uBAChBC,WAAY92B,EAAM+2B,0BAqDAC,CAAah3B,EAAOC,GACtCf,KAAK+3B,GAlDiB,SACvBj3B,EACAC,GAEA,OAAIA,GAAWA,EAAQ4rB,MAAQ5rB,EAAQ4rB,KAAKqL,UACpCj3B,EAAQ4rB,KAAKqL,UAEdl3B,EAAMm3B,mBA2CUC,CAAiBp3B,EAAOC,GAC9Cf,KAAKm4B,GAzCe,SACrBr3B,EAAuBC,GAEvB,OAAIA,GAAWA,EAAQ4rB,MAAgC,MAAxB5rB,EAAQ4rB,KAAKyL,QACpCr3B,EAAQ4rB,KAAKyL,QAEdt3B,EAAMu3B,gBAmCQC,CAAex3B,EAAOC,GAC1Cf,KAAKu4B,GAjIuB,SAC7Bz3B,EAAuBC,GAEvB,OAAIA,GAA2B,MAAhBA,EAAQyB,KACfzB,EAAQyB,KAET1B,EAAM03B,wBA2HkBA,CAAuB13B,EAAOC,GAC5Df,KAAKy4B,GAAgB,KACrBz4B,KAAK04B,eACL14B,KAAK24B,sBAGNn5B,sBAAIk3B,wBAOJ,WACC,OAAO12B,KAAK22B,QARb,SAAUhK,GACL3sB,KAAK22B,KAAehK,IACvB3sB,KAAK22B,GAAahK,EAClB3sB,KAAK44B,oDAQGlC,yBAAV,aAIUA,6BAAV,WACC,IAAMmC,EAAY74B,KAAK22B,GACvB,QAAkBj1B,IAAdm3B,EAA0B,CAC7B,IAAIj4B,EAAgBi4B,GAMnB,OAAOA,EALP,IAAMt4B,EAASs4B,EAAW74B,KAAKyB,OAC/B,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKc,MAAMg4B,aAAc94B,KAAKyB,QAG5Bi1B,+BAAV,WACC,IAAMqC,EAAY/4B,KAAK+3B,GAAgB/3B,KAAK+2B,GAAoB/2B,MAChE,GAAkB,MAAdA,KAAKm1B,IACR,GAAI,EAAI4D,EAAUpmB,OAAS,CAC1B,IAAMga,EAAO3sB,KAAKg5B,WAAYD,GAC9B/4B,KAAKm1B,GAAQxI,EACb3sB,KAAKkmB,SAAUyG,GACf3sB,KAAKi5B,mBAAoBtM,GACrB3sB,KAAKu4B,KACR5L,EAAKnqB,KAAOxC,KAAKk5B,2BAElBl5B,KAAKujB,UACLljB,EAAcM,eAGfX,KAAKm1B,GAAMxI,KAAOoM,EAClB/4B,KAAKujB,UACLljB,EAAcM,UAIN+1B,uBAAV,SAAsBqC,GACrB,OAAS/4B,KAAKm4B,GACb,IAAI5C,GAAcwD,EAAW/4B,KAAKm3B,IAClC,IAAIgC,OAAMJ,EAAW/4B,KAAKm3B,KAIlBT,oCAAV,WAMC,OAL0B,MAAtB12B,KAAKy4B,KACRz4B,KAAKy4B,GAAgB,IAAIpC,GAAyBr2B,MAClDA,KAAKiP,cAAejP,KAAKy4B,IACzBz4B,KAAKujB,WAECvjB,KAAKy4B,IAGH/B,+BAAV,SAA8B/J,GAC7B,IAAMrqB,EAAQtC,KAAKy3B,GACbtzB,EAAUnE,KAAKqjB,GAErB,OAAQ/gB,EAAMs1B,YACd,KAAKxa,EAAiB7R,KACrBohB,EAAKrnB,EAAItF,KAAKo5B,UAAWj1B,EAAQkjB,WACjC,MACD,KAAKjK,EAAiBrB,OACrB4Q,EAAKrnB,EAAItF,KAAKo5B,UAAyC,IAA5Bp5B,KAAKoC,MAAQuqB,EAAKvqB,QAC7C,MACD,KAAKgb,EAAiB3R,MACrBkhB,EAAKrnB,EAAItF,KAAKo5B,UAAWp5B,KAAKoC,MAAQuqB,EAAKvqB,MAAQ+B,EAAQ6lB,YAI5D,OAAQ1nB,EAAMo1B,UACd,KAAKra,EAAelS,IACnBwhB,EAAKpnB,EAAIvF,KAAKo5B,UAAWj1B,EAAQmjB,UACjC,MACD,KAAKjK,EAAegc,OACnB1M,EAAKpnB,EAAIvF,KAAKo5B,UAA2C,IAA9Bp5B,KAAK6F,OAAS8mB,EAAK9mB,SAC9C,MACD,KAAKwX,EAAehS,OACnBshB,EAAKpnB,EAAIvF,KAAKo5B,UAAWp5B,KAAK6F,OAAS8mB,EAAK9mB,OAAS1B,EAAQ8lB,eAKrDyM,sBAAV,SAAqBE,GACpB,OAAO3qB,KAAK4nB,MAAO+C,IAGVF,yBAAV,SAAwB51B,EAAcW,GACrC,IAAMJ,EAAQrB,KAAKi3B,GACnB,QAAcv1B,IAAVL,EAAsB,CACzB,IAAIT,EAAgBS,GAMnB,OAAOA,EALP,IAAMd,EAASc,EAAOI,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOO,EAAMsO,SAAU3N,IAGdi1B,yBAAV,SAAwB51B,EAAcW,GACrC,IAAMF,EAAQvB,KAAKk3B,GACnB,QAAcx1B,IAAVH,EAAsB,CACzB,IAAIX,EAAgBW,GAMnB,OAAOA,EALP,IAAMhB,EAASgB,EAAOE,GACtB,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOO,EAAMwO,SAAU7N,IAGdi1B,4BAAV,SAA2B/J,GAC1B,IAAM7rB,EAAQd,KAAKc,MACbW,EAAQzB,KAAKyB,MACnBkrB,EAAK6I,MAAMvF,KAAOjwB,KAAKs5B,aAAcx4B,EAAOW,GAC5CkrB,EAAKprB,MAAQvB,KAAKu5B,aAAcz4B,EAAOW,IAG9Bi1B,4BAAV,WACC,IAAM8C,EAAuBx5B,KAAKg3B,mBAC9Bh3B,KAAK+2B,KAAuByC,IAC/Bx5B,KAAK+2B,GAAqByC,EAC1Bx5B,KAAK04B,eACL14B,KAAK24B,uBAIGjC,uBAAV,WACC,IAAM/J,EAAO3sB,KAAKm1B,GACN,MAARxI,IACH3sB,KAAK44B,kBACL54B,KAAKi5B,mBAAoBtM,GACzB3sB,KAAKy5B,gBAAiB9M,KAId+J,qBAAV,WACC1wB,YAAMmkB,oBACNnqB,KAAK05B,cAGIhD,wBAAV,SAAuB71B,GACtB,OAAOmF,YAAMkkB,sBAAarpB,IACd,MAAVA,GAAkBA,IAAWb,KAAKm1B,IAG3BuB,oBAAV,WACC,MAAO,aAGRA,oBAAA,WAEC,IAAM/J,EAAO3sB,KAAKm1B,GACN,MAARxI,IACH3sB,KAAKm1B,GAAQ,KACbxI,EAAK9Y,WAIN,IAAM8lB,EAAe35B,KAAKy4B,GACN,MAAhBkB,IACH35B,KAAKy4B,GAAgB,KACrBkB,EAAa9lB,WAGd7N,YAAM6N,uBA3NEuS,mBCtCV,4DA2eA,OAveUtmB,OAkBC85B,iBAAV,SAAgB74B,GAAhB,WACCiF,YAAMggB,eAAMjlB,GACZf,KAAK65B,GAAS,KACd,IAAM/4B,EAAQd,KAAKc,MACnBd,KAAK85B,GAnFc,SACpBh5B,EAAwBC,GAExB,GAAe,MAAXA,GAAoC,MAAjBA,EAAQg5B,OAAwC,MAAvBh5B,EAAQg5B,MAAMz3B,MAAgB,CAC7E,IAAMA,EAAQvB,EAAQg5B,MAAMz3B,MAa5B,MAAO,CACN03B,KAb6C,MAAd13B,EAAM03B,KACnCj4B,EAAcO,EAAM03B,MAAS1c,EAAYhb,EAAM03B,MAAS13B,EAAM03B,KAChEl5B,EAAMm5B,oBAYNvC,SAVyD,MAAlBp1B,EAAMo1B,SAC3C31B,EAAcO,EAAMo1B,UAAara,EAAgB/a,EAAMo1B,UAAap1B,EAAMo1B,SAC5E52B,EAAMo5B,wBASNtC,WAP+D,MAApBt1B,EAAMs1B,WAC/C71B,EAAcO,EAAMs1B,YAAexa,EAAkB9a,EAAMs1B,YAAet1B,EAAMs1B,WAClF92B,EAAMq5B,2BAQR,MAAO,CACNH,KAAMl5B,EAAMm5B,oBACZvC,SAAU52B,EAAMo5B,wBAChBtC,WAAY92B,EAAMq5B,2BAyDCC,CAAct5B,EAAOC,GACxCf,KAAKq6B,GAtDe,SACrBv5B,EAAwBC,GAExB,GAAe,MAAXA,GAAoC,MAAjBA,EAAQg5B,OAAyC,MAAxBh5B,EAAQg5B,MAAMO,OAAiB,CAC9E,IAAMA,EAASv5B,EAAQg5B,MAAMO,OAG7B,MAAO,CACN5C,SAHqC,MAAnB4C,EAAO5C,SAAmB4C,EAAO5C,SAAW52B,EAAMy5B,wBAIpE3C,WAHyC,MAArB0C,EAAO1C,WAAqB0C,EAAO1C,WAAa92B,EAAM05B,4BAM5E,MAAO,CACN9C,SAAU52B,EAAMy5B,wBAChB3C,WAAY92B,EAAM05B,4BAwCEC,CAAe35B,EAAOC,GAC1Cf,KAAK06B,GArCa,SACnB55B,EAAwBC,GAExB,GAAe,MAAXA,GAAoC,MAAjBA,EAAQg5B,OAAuC,MAAtBh5B,EAAQg5B,MAAMxqB,KAC7D,OAAOxO,EAAQg5B,MAAMxqB,KAiCHorB,CAAa75B,EAAOC,GACtCf,KAAK46B,GAAc,IAAIC,YACvB76B,KAAK86B,GAAmB,IAAItO,QAC5BxsB,KAAK+6B,GAAiBh6B,GAAWA,EAAQg5B,OAASh5B,EAAQg5B,MAAM1oB,OAChErR,KAAKg7B,GAAuB,KAC5Bh7B,KAAKi7B,GAAsB,WAC1B90B,EAAK+0B,kBAIP17B,sBAAIo6B,yBAAJ,WACC,OAAO55B,KAAK+6B,QAGb,SAAWI,GACNn7B,KAAK+6B,KAAiBI,IACzBn7B,KAAK+6B,GAAeI,EACpBn7B,KAAKujB,UACLljB,EAAcM,2CAINi5B,+BAAV,WACC,IAAMuB,EAAcn7B,KAAK+6B,GACzB,QAAoBr5B,IAAhBy5B,EAA4B,CAC/B,IAAIv6B,EAAgBu6B,GAMnB,OAAOA,EALP,IAAM56B,EAAS46B,EAAan7B,KAAKyB,OACjC,QAAeC,IAAXnB,EACH,OAAOA,EAMV,OAAOP,KAAKc,MAAMs6B,eAAgBp7B,KAAKyB,QAG9Bm4B,0BAAV,WACC55B,KAAKujB,UACLljB,EAAcM,UAGLi5B,0BAAV,SAAyB9Q,EAAsBE,GAC9ChjB,YAAMijB,wBAAeH,EAAUE,GAE/B,IAAM+Q,EAAQ/5B,KAAK65B,GACN,MAATE,GACH/5B,KAAKq7B,gBAAiBtB,IAIdH,yBAAV,SAAwBG,GACvBA,EAAMrO,kBACN,IAAMI,EAASiO,EAAMuB,eAAgBt7B,KAAK46B,IACpC31B,EAAQjF,KAAK86B,GACnB71B,EAAMO,IAAKsmB,EAAOtnB,KAAMsnB,EAAOrnB,KAC/Bs1B,EAAMwB,eAAerP,MAAOjnB,EAAOA,GACnC,IAAMuC,EAAKvC,EAAMK,EACXoC,EAAKzC,EAAMM,EACjBN,EAAMO,IAAKsmB,EAAOpnB,MAAOonB,EAAOrnB,KAChCs1B,EAAMwB,eAAerP,MAAOjnB,EAAOA,GACnC,IAAMwC,EAAKxC,EAAMK,EACXqC,EAAK1C,EAAMM,EACjBN,EAAMO,IAAKsmB,EAAOpnB,MAAOonB,EAAOnnB,QAChCo1B,EAAMwB,eAAerP,MAAOjnB,EAAOA,GACnC,IAAM4D,EAAK5D,EAAMK,EACXyD,EAAK9D,EAAMM,EACjBN,EAAMO,IAAKsmB,EAAOtnB,KAAMsnB,EAAOnnB,QAC/Bo1B,EAAMwB,eAAerP,MAAOjnB,EAAOA,GACnC,IAAM6D,EAAK7D,EAAMK,EACX0D,EAAK/D,EAAMM,EAKjB,OAJAumB,EAAOxmB,EAAI2G,KAAK0iB,IAAKnnB,EAAIC,EAAIoB,EAAIC,GACjCgjB,EAAOvmB,EAAI0G,KAAK0iB,IAAKjnB,EAAIC,EAAIoB,EAAIC,GACjC8iB,EAAO1pB,MAAQ6J,KAAKC,IAAK1E,EAAIC,EAAIoB,EAAIC,GAAOgjB,EAAOxmB,EACnDwmB,EAAOjmB,OAASoG,KAAKC,IAAKxE,EAAIC,EAAIoB,EAAIC,GAAO8iB,EAAOvmB,EAC7CumB,GAGE8N,uCAAV,SAAsCjN,EAA2BoN,GAChE,IAAMjO,EAAS9rB,KAAKw7B,aAAczB,GAC5B0B,EAAa3P,EAAO1pB,MACpBs5B,EAAc5P,EAAOjmB,OAErBmtB,EAAYhzB,KAAKy3B,GACjBkE,EAAa37B,KAAK85B,GAClBQ,EAASt6B,KAAKq6B,GACdl2B,EAAUnE,KAAKqjB,GAEfuY,EAAmBtB,EAAO1C,WAC1BiE,EAAYJ,EAAaG,EAC/B,OAAQD,EAAW/D,YACnB,KAAKxa,EAAiB7R,KACrB,OAAQynB,EAAU4E,YAClB,KAAKxa,EAAiB7R,KACjBohB,aAAgB4I,IACnB5I,EAAKmP,sBAAuBD,GAE7B9B,EAAMz0B,EAAItF,KAAKo5B,UAAWj1B,EAAQkjB,WAClC,MACD,KAAKjK,EAAiBrB,OACjB4Q,aAAgB4I,IACnB5I,EAAKmP,sBAAuBD,GAE7B9B,EAAMz0B,EAAItF,KAAKo5B,UAAqD,IAAxCp5B,KAAKoC,MAAQuqB,EAAKvqB,MAAQy5B,IACtD,MACD,KAAKze,EAAiB3R,MACjBkhB,aAAgB4I,IACnB5I,EAAKmP,sBAAuB,GAE7B/B,EAAMz0B,EAAItF,KAAKo5B,UAAWp5B,KAAKoC,MAAQuqB,EAAKvqB,MAAQ+B,EAAQ6lB,WAAa6R,GAG1ElP,EAAKrnB,EAAItF,KAAKo5B,UAAWW,EAAMz0B,EAAIu2B,GACnC,MACD,KAAKze,EAAiBrB,OAIrB,OAHI4Q,aAAgB4I,IACnB5I,EAAKmP,sBAAuB,GAErB9I,EAAU4E,YAClB,KAAKxa,EAAiB7R,KACrBohB,EAAKrnB,EAAItF,KAAKo5B,UAAWj1B,EAAQkjB,WACjC,MACD,KAAKjK,EAAiBrB,OACrB4Q,EAAKrnB,EAAItF,KAAKo5B,UAAyC,IAA5Bp5B,KAAKoC,MAAQuqB,EAAKvqB,QAC7C,MACD,KAAKgb,EAAiB3R,MACrBkhB,EAAKrnB,EAAItF,KAAKo5B,UAAWp5B,KAAKoC,MAAQuqB,EAAKvqB,MAAQ+B,EAAQ6lB,YAG5D+P,EAAMz0B,EAAItF,KAAKo5B,UAAWzM,EAAKrnB,EAAkC,IAA5BqnB,EAAKvqB,MAAQq5B,IAClD,MACD,KAAKre,EAAiB3R,MACrB,OAAQunB,EAAU4E,YAClB,KAAKxa,EAAiB7R,KACjBohB,aAAgB4I,IACnB5I,EAAKmP,sBAAuB,GAE7BnP,EAAKrnB,EAAItF,KAAKo5B,UAAWj1B,EAAQkjB,WACjC,MACD,KAAKjK,EAAiBrB,OACjB4Q,aAAgB4I,IACnB5I,EAAKmP,sBAAuBD,GAE7BlP,EAAKrnB,EAAItF,KAAKo5B,UAAqD,IAAxCp5B,KAAKoC,MAAQuqB,EAAKvqB,MAAQy5B,IACrD,MACD,KAAKze,EAAiB3R,MACjBkhB,aAAgB4I,IACnB5I,EAAKmP,sBAAuBD,GAE7BlP,EAAKrnB,EAAItF,KAAKo5B,UAAWp5B,KAAKoC,MAAQuqB,EAAKvqB,MAAQ+B,EAAQ6lB,WAAa6R,GAGzE9B,EAAMz0B,EAAItF,KAAKo5B,UAAWzM,EAAKrnB,EAAIqnB,EAAKvqB,MAAQw5B,GAIjD,IAAMG,EAAiBzB,EAAO5C,SACxBsE,EAAYP,EAAaG,EAC/B,OAAQD,EAAWjE,UACnB,KAAKra,EAAelS,IACnB,OAAQ6nB,EAAU0E,UAClB,KAAKra,EAAelS,IACnB4uB,EAAMx0B,EAAIvF,KAAKo5B,UAAWj1B,EAAQmjB,UAClC,MACD,KAAKjK,EAAegc,OACnBU,EAAMx0B,EAAIvF,KAAKo5B,UAAuD,IAA1Cp5B,KAAK6F,OAAS8mB,EAAK9mB,OAASm2B,IACxD,MACD,KAAK3e,EAAehS,OACnB0uB,EAAMx0B,EAAIvF,KAAKo5B,UAAWp5B,KAAK6F,OAAS8mB,EAAK9mB,OAAS1B,EAAQ8lB,YAAc+R,GAG7ErP,EAAKpnB,EAAIvF,KAAKo5B,UAAWW,EAAMx0B,EAAIy2B,GACnC,MACD,KAAK3e,EAAegc,OACnB,OAAQrG,EAAU0E,UAClB,KAAKra,EAAelS,IACnBwhB,EAAKpnB,EAAIvF,KAAKo5B,UAAWj1B,EAAQmjB,UACjC,MACD,KAAKjK,EAAegc,OACnB1M,EAAKpnB,EAAIvF,KAAKo5B,UAA2C,IAA9Bp5B,KAAK6F,OAAS8mB,EAAK9mB,SAC9C,MACD,KAAKwX,EAAehS,OACnBshB,EAAKpnB,EAAIvF,KAAKo5B,UAAWp5B,KAAK6F,OAAS8mB,EAAK9mB,OAAS1B,EAAQ8lB,aAG9D8P,EAAMx0B,EAAIvF,KAAKo5B,UAAWzM,EAAKpnB,EAAoC,IAA9BonB,EAAK9mB,OAAS61B,IACnD,MACD,KAAKre,EAAehS,OACnB,OAAQ2nB,EAAU0E,UAClB,KAAKra,EAAelS,IACnBwhB,EAAKpnB,EAAIvF,KAAKo5B,UAAWj1B,EAAQmjB,UACjC,MACD,KAAKjK,EAAegc,OACnB1M,EAAKpnB,EAAIvF,KAAKo5B,UAAuD,IAA1Cp5B,KAAK6F,OAAS8mB,EAAK9mB,OAASm2B,IACvD,MACD,KAAK3e,EAAehS,OACnBshB,EAAKpnB,EAAIvF,KAAKo5B,UAAWp5B,KAAK6F,OAAS8mB,EAAK9mB,OAAS1B,EAAQ8lB,YAAc+R,GAG5EjC,EAAMx0B,EAAIvF,KAAKo5B,UAAWzM,EAAKpnB,EAAIonB,EAAK9mB,OAASk2B,KAKzCnC,oCAAV,SAAmCG,GAClC,IAAMjO,EAAS9rB,KAAKw7B,aAAczB,GAClCA,EAAMz0B,EAAItF,KAAKo5B,UAA2C,IAA9Bp5B,KAAKoC,MAAQ0pB,EAAO1pB,QAChD23B,EAAMx0B,EAAIvF,KAAKo5B,UAA6C,IAAhCp5B,KAAK6F,OAASimB,EAAOjmB,UAGxC+zB,uCAAV,SAAsCG,GACrC,IAAMO,EAASt6B,KAAKq6B,GACd/3B,EAAQtC,KAAK85B,GACb31B,EAAUnE,KAAKqjB,GACfyI,EAAS9rB,KAAKw7B,aAAczB,GAC5B0B,EAAa3P,EAAO1pB,MACpBs5B,EAAc5P,EAAOjmB,OAErB+1B,EAAmBtB,EAAO1C,WAChC,OAAQt1B,EAAMs1B,YACd,KAAKxa,EAAiB7R,KACrBwuB,EAAMz0B,EAAItF,KAAKo5B,UAAWj1B,EAAQkjB,UAAYuU,GAC9C,MACD,KAAKxe,EAAiBrB,OACrBge,EAAMz0B,EAAItF,KAAKo5B,UAAyC,IAA5Bp5B,KAAKoC,MAAQq5B,IACzC,MACD,KAAKre,EAAiB3R,MACrBsuB,EAAMz0B,EAAItF,KAAKo5B,UAAWp5B,KAAKoC,MAAQ+B,EAAQ6lB,WAAa4R,EAAmBH,GAIhF,IAAMM,EAAiBzB,EAAO5C,SAC9B,OAAQp1B,EAAMo1B,UACd,KAAKra,EAAelS,IACnB4uB,EAAMx0B,EAAIvF,KAAKo5B,UAAWj1B,EAAQmjB,SAAWyU,GAC7C,MACD,KAAK1e,EAAegc,OACnBU,EAAMx0B,EAAIvF,KAAKo5B,UAA2C,IAA9Bp5B,KAAK6F,OAAS61B,IAC1C,MACD,KAAKre,EAAehS,OACnB0uB,EAAMx0B,EAAIvF,KAAKo5B,UAAWp5B,KAAK6F,OAAS1B,EAAQ8lB,YAAc8R,KAKtDnC,sCAAV,SAAqCG,GACpC,IAAMO,EAASt6B,KAAKq6B,GACd/3B,EAAQtC,KAAK85B,GACbhO,EAAS9rB,KAAKw7B,aAAczB,GAC5B0B,EAAa3P,EAAO1pB,MACpBs5B,EAAc5P,EAAOjmB,OAErB+1B,EAAmBtB,EAAO1C,WAChC,OAAQt1B,EAAMs1B,YACd,KAAKxa,EAAiB7R,KACrBwuB,EAAMz0B,EAAItF,KAAKo5B,UAAWwC,GAC1B,MACD,KAAKxe,EAAiBrB,OACrBge,EAAMz0B,EAAItF,KAAKo5B,UAAyC,IAA5Bp5B,KAAKoC,MAAQq5B,IACzC,MACD,KAAKre,EAAiB3R,MACrBsuB,EAAMz0B,EAAItF,KAAKo5B,UAAWp5B,KAAKoC,MAAQw5B,EAAmBH,GAI3D,IAAMM,EAAiBzB,EAAO5C,SAC9B,OAAQp1B,EAAMo1B,UACd,KAAKra,EAAelS,IACnB4uB,EAAMx0B,EAAIvF,KAAKo5B,UAAW2C,GAC1B,MACD,KAAK1e,EAAegc,OACnBU,EAAMx0B,EAAIvF,KAAKo5B,UAA2C,IAA9Bp5B,KAAK6F,OAAS61B,IAC1C,MACD,KAAKre,EAAehS,OACnB0uB,EAAMx0B,EAAIvF,KAAKo5B,UAAWp5B,KAAK6F,OAASk2B,KAKhCnC,8BAAV,SAA6B94B,EAAcW,GAC1C,IAAMw6B,EAAYj8B,KAAK06B,GACvB,GAAiB,MAAbuB,EAAoB,CACvB,IAAM56B,EAAQ46B,EAAU56B,MACxB,QAAcK,IAAVL,EAAsB,CACzB,IAAIT,EAAgBS,GAMnB,OAAOA,EALP,IAAMd,EAASc,EAAOI,GACtB,QAAeC,IAAXnB,EACH,OAAOA,GAOX,OAAOO,EAAMo7B,kBAAmBz6B,IAGvBm4B,8BAAV,SAA6B94B,EAAcW,GAC1C,IAAMw6B,EAAYj8B,KAAK06B,GACvB,GAAiB,MAAbuB,EAAoB,CACvB,IAAM16B,EAAQ06B,EAAU16B,MACxB,QAAcG,IAAVH,EAAsB,CACzB,IAAIX,EAAgBW,GAMnB,OAAOA,EALP,IAAMhB,EAASgB,EAAOE,GACtB,QAAeC,IAAXnB,EACH,OAAOA,GAOX,OAAOO,EAAMq7B,kBAAmB16B,IAGvBm4B,4BAAV,SAA2BG,GAC1B,GAAI/5B,KAAKo8B,YAAarC,GAAU,CAC/B,IAAMj5B,EAAQd,KAAKc,MACbW,EAAQzB,KAAKyB,MACbJ,EAAQrB,KAAKk8B,kBAAmBp7B,EAAOW,GAC7C,GAAa,MAATJ,EAAgB,CACf04B,EAAMxqB,OAASlO,IAClB04B,EAAMxqB,KAAOlO,GAEd,IAAME,EAAQvB,KAAKm8B,kBAAmBr7B,EAAOW,GACzCs4B,EAAMx4B,QAAUA,IACnBw4B,EAAMx4B,MAAQA,MAMRq4B,wBAAV,SAAuB/4B,GACtB,OAAmB,MAAVA,GAAkB,SAAUA,GAG5B+4B,8BAAV,WACC,IAAMyC,EAAyBr8B,KAAKs8B,qBAC9BC,EAAyBv8B,KAAKg7B,GACpC,GAAIqB,IAA2BE,EAAyB,CACvDv8B,KAAKg7B,GAAuBqB,EAE5B,IAAMG,EAAWx8B,KAAK65B,GACtB,GAAIwC,aAAkCzvB,UACrC,GAAI2vB,aAAkC3vB,UACrC2vB,EAAuBzd,IAAK,SAAU9e,KAAKi7B,IACvCuB,aAAoBC,WACvBD,EAAS52B,QAAUy2B,EACnBA,EAAuBlvB,GAAI,SAAUnN,KAAKi7B,SAErC,CACU,MAAZuB,GACHx8B,KAAK08B,YAAaF,GAGnB,IAAMG,EAAW,IAAIF,SAAQJ,GACzBr8B,KAAKu4B,KACRoE,EAASn6B,KAAOxC,KAAKk5B,2BAEtBmD,EAAuBlvB,GAAI,SAAUnN,KAAKi7B,IAC1Cj7B,KAAKkmB,SAAUyW,GACf38B,KAAK65B,GAAS8C,OAGXJ,aAAkC3vB,WACrC2vB,EAAuBzd,IAAK,SAAU9e,KAAKi7B,IAC3B,MAAZuB,IACHx8B,KAAK08B,YAAaF,GAClBA,EAAS3oB,YAEY,MAAZ2oB,GACVx8B,KAAK08B,YAAaF,GAGW,MAA1BH,IACCr8B,KAAKu4B,KACR8D,EAAuB75B,KAAOxC,KAAKk5B,2BAEpCl5B,KAAKkmB,SAAUmW,IAEhBr8B,KAAK65B,GAASwC,IAKPzC,uBAAV,WACC55B,KAAK44B,kBACL54B,KAAK48B,oBAEL,IAAMjQ,EAAO3sB,KAAKm1B,GACZ4E,EAAQ/5B,KAAK65B,GACnB,GAAY,MAARlN,EACH,GAAa,MAAToN,EAAgB,CAEnB,OADc/5B,KAAK85B,GACLE,MACd,KAAK1c,EAAWuf,KACf78B,KAAK88B,2BAA4BnQ,EAAMoN,GACvC,MACD,KAAKzc,EAAWtB,QACX2Q,aAAgB4I,IACnB5I,EAAKmP,sBAAuB,GAE7B97B,KAAKi5B,mBAAoBtM,GACzB3sB,KAAK+8B,2BAA4BhD,GACjC,MACD,KAAKzc,EAAW0f,OACXrQ,aAAgB4I,IACnB5I,EAAKmP,sBAAuB,GAE7B97B,KAAKi5B,mBAAoBtM,GACzB3sB,KAAKi9B,0BAA2BlD,GAGjC/5B,KAAKy5B,gBAAiB9M,GACtB3sB,KAAKq7B,gBAAiBtB,QAElBpN,aAAgB4I,IACnB5I,EAAKmP,sBAAuB,GAE7B97B,KAAKi5B,mBAAoBtM,GACzB3sB,KAAKy5B,gBAAiB9M,QAEjB,GAAa,MAAToN,EAAgB,CAE1B,OADc/5B,KAAK85B,GACLE,MACd,KAAK1c,EAAWuf,KACf78B,KAAKk9B,wBAAyBnD,GAC9B,MACD,KAAKzc,EAAWtB,QACfhc,KAAK+8B,2BAA4BhD,GACjC,MACD,KAAKzc,EAAW0f,OACfh9B,KAAKi9B,0BAA2BlD,GAGjC/5B,KAAKq7B,gBAAiBtB,KAIdH,wBAAV,SAAuB/4B,GACtB,OAAOmF,YAAMkkB,sBAAarpB,IACd,MAAVA,GAAkBA,IAAWb,KAAK65B,IAG3BD,oBAAV,WACC,MAAO,cAGRA,oBAAA,WAEC,IAAMG,EAAQ/5B,KAAK65B,GACnB,GAAa,MAATE,EAAgB,CACnB/5B,KAAK65B,GAAS,KACd,IAAMsD,EAAsBn9B,KAAKg7B,GAC7BmC,aAA+BvwB,YAClCuwB,EAAoBre,IAAK,SAAU9e,KAAKi7B,GAAqBj7B,MAC7D+5B,EAAMlmB,WAKR7N,YAAM6N,uBAreE6iB,mBCjGV,4DAQA,OAJU52B,OACCs9B,oBAAV,WACC,MAAO,aAFCxD,mBCaV,4DA2DA,OAvDU95B,OAGCu9B,iBAAV,SAAgBt8B,GACfiF,YAAMggB,eAAMjlB,GACZf,KAAKs9B,YAAa,EAClBt9B,KAAKu9B,GAnBS,SAAuCx8B,GACtD,OAAoB,MAAXA,GAAoC,MAAjBA,EAAQ61B,MACnC71B,EAAQ61B,MAAQ,KAiBF4G,CAASz8B,IAGxBvB,sBAAI69B,yBAAJ,WACC,OAAOr9B,KAAKu9B,QAGb,SAAW3G,GACV52B,KAAKu9B,GAAS3G,mCAGLyG,yBAAV,SAAwBx8B,GACvB,OAASA,GAAUA,EAAO48B,WAAa58B,EAAO48B,UAAUpL,KAG/CgL,yBAAV,WAEC,IADA,IAAItoB,EAAS/U,KAAK+U,OACXA,GAAS,CACf,GAAI/U,KAAK09B,aAAc3oB,GACtB,OAAOA,EAAO0oB,UAEf1oB,EAASA,EAAOA,OAEjB,OAAO,MAGEsoB,qBAAV,SAAoBpnB,GACnB,IAAMwnB,EAAYz9B,KAAK29B,eACnBF,GACHA,EAAUpL,IAAKryB,OAIjBq9B,sBAAA,SAAWpnB,GAKV,OAJIjW,KAAKgY,gBAAkBhY,KAAK0U,aAAesB,EAAkB4nB,cAAe3nB,IAC/EjW,KAAK69B,SAAU5nB,GAGTjQ,YAAMyS,oBAAWxC,IAGfonB,0BAAV,SAAyBvU,EAAkBE,GAC1ChjB,YAAMijB,wBAAeH,EAAUE,GAC/BhpB,KAAKs9B,WAAajtB,EAAY2H,aAAc8Q,IAGnCuU,oBAAV,WACC,MAAO,gBArDCD,mBCpBV,4DA8BA,OA1BUt9B,OACTg+B,uBAAA,WAEC,IADA,IAAI/oB,EAAS/U,KAAK+U,OACXA,GAAS,CACf,GAAIA,EAAO+d,WACV,OAAO/d,EAAO+d,aAEf/d,EAASA,EAAOA,OAEjB,OAAO,MAGR+oB,yBAAA,WAEC,IADA,IAAI/oB,EAAS/U,KAAK+U,OACXA,GAAS,CACf,GAAIA,EAAOgpB,aACV,OAAOhpB,EAAOgpB,eAEfhpB,EAASA,EAAOA,OAEjB,OAAO,MAGE+oB,oBAAV,WACC,MAAO,gBAxBCT,mBCAV,4DA+FA,OA3FUv9B,OAICk+B,iBAAV,SAAgBj9B,GACfiF,YAAMggB,eAAMjlB,GACZf,KAAKi+B,YAAal9B,GAClBf,KAAKk+B,WAAYn9B,GACjBf,KAAKm+B,cAAep9B,IAGXi9B,wBAAV,SAAuBj9B,GAAvB,WACC+c,EAAiB+B,QAAS7f,MAAM,SAAEiW,GAC7B9P,EAAK6R,gBACR7R,EAAK03B,SAAU5nB,OAKR+nB,uBAAV,SAAsBj9B,GAAtB,WACCf,KAAKmN,GAAI2Q,EAAiBoH,MAAM,WAC/B,IAAM2N,EAAU1sB,EAAK2sB,aACN,MAAXD,GACY1sB,EAAK4O,kBACEqR,IACrByM,EAAQjc,KAAMzQ,EAAK43B,oBAMbC,0BAAV,SAAyBj9B,GACxB,IAAM6gB,EAAY5hB,KAAK6lB,GAEvB,GADA7lB,KAAKo+B,GAAkBp+B,KAAKc,MAAMu9B,wBACjB,MAAbzc,GAAqB,EAAIA,EAAUjP,OAAS,CAC/C,IAAMqE,EAAW4K,EAAW,GACtB0c,EAAoBtoB,EAAkBhU,SAAUgV,GACtDhX,KAAKu+B,GAAkBv+B,KAAKm4B,GAC3B,IAAI5C,GAAc+I,EAAmBt+B,KAAKm3B,IAC1C,IAAIgC,OAAMmF,EAAmBt+B,KAAKm3B,IAEnCn3B,KAAKiO,iBAAkBjO,KAAKu+B,IAAe,QAE3Cv+B,KAAKu+B,GAAgB,MAIbP,+BAAV,WACC,IAAMrR,EAAO3sB,KAAKu+B,GACN,MAAR5R,GACHA,EAAK9P,SAASrX,IACbxF,KAAKo5B,UAAWp5B,KAAKoC,MAAQpC,KAAKo+B,GAAkBzR,EAAKvqB,OACzDpC,KAAKo5B,UAA2C,IAA9Bp5B,KAAK6F,OAAS8mB,EAAK9mB,WAK9Bm4B,4BAAV,SAA2BrR,GAC1B3mB,YAAMyzB,0BAAiB9M,GAEvB,IAAM6R,EAAex+B,KAAKu+B,GAC1B,GAAoB,MAAhBC,EAAuB,CAC1B,IAAM19B,EAAQd,KAAKc,MACbW,EAAQzB,KAAKyB,MACnB+8B,EAAahJ,MAAMvF,KAAOnvB,EAAMsO,SAAU3N,GAC1C+8B,EAAaj9B,MAAQT,EAAMwO,SAAU7N,KAI7Bu8B,uBAAV,WACCh4B,YAAM0zB,sBACN15B,KAAKy+B,sBAGIT,oBAAV,WACC,MAAO,iBAGEA,qBAAV,SAAoB/nB,GACnB,IAAMyoB,EAAY1+B,KAAK+9B,eACN,MAAbW,GACHA,EAAUzrB,KAAM,SAAUjT,KAAK42B,MAAO52B,KAAM0+B,GAG7C14B,YAAM63B,mBAAU5nB,IAGP+nB,uBAAV,SAAsB/nB,GACrBjQ,YAAM+f,qBAAY9P,GAClBjW,KAAK69B,SAAU5nB,OAzFP6nB,mBCPV,4DAwBA,OApBUh+B,OACC6+B,iBAAV,SAAgB59B,GACfiF,YAAMggB,eAAMjlB,GACRA,GAAWA,EAAQ69B,OACtB5+B,KAAK6+B,WAAW,IAIRF,oBAAV,WACC,MAAO,kBAGEA,qBAAV,SAAoB1oB,GACnBjW,KAAK6+B,WAAa7+B,KAAK8nB,YACvB9hB,YAAM63B,mBAAU5nB,IAGV0oB,eAAP,SAA4B59B,GAC3B,MAAO,UAAWA,MAlBVi9B,kBCXV,cA2EA,OAtEQc,iBAAP,SAAuBC,GACtB/+B,KAAKg/B,SAASpsB,KAAMmsB,IAGdD,wBAAP,SAA8BC,GAC7B/+B,KAAKi/B,gBAAkBF,GAGjBD,iBAAP,SAAuBC,GACtB/+B,KAAKk/B,aAAeH,GAGdD,YAAP,SACCK,EACAC,EACAr+B,EACAs+B,GAEA,IAAK,IAAIzrB,EAAI,EAAGG,EAAOorB,EAASxsB,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM0rB,EAAUH,EAAUvrB,GAAK7S,EAASs+B,GACxC,GAAe,MAAXC,EACH,OAAOA,EAGT,OAAIF,EACIA,EAAgBr+B,EAASs+B,GAE1B,MAGDP,UAAP,SAAuB/9B,EAAuCs+B,GAC7D,OAAOr/B,KAAKu/B,UAAWv/B,KAAKg/B,SAAUh/B,KAAKi/B,gBAAiBl+B,EAASs+B,IAG/DP,aAAP,SACCC,EACAhqB,EACAyqB,EACAH,GAEA,IAAK,IAAIzrB,EAAI,EAAGG,EAAOyrB,EAAM7sB,OAAQiB,EAAIG,IAAQH,EAAI,CACpD,IAAM4N,EAAOge,EAAO5rB,GACpB,GAAI4N,aAAgBie,gBACnB1qB,EAAOmR,SAAU1E,OACX,CACN,IAAM8d,EAAUP,EAAQW,QAASle,EAAM6d,GACvC,GAAe,MAAXC,EAGH,MAAM,IAAI7+B,MAAO,wCAAwCk/B,KAAKC,UAAWpe,IAFzEzM,EAAOmR,SAAUoZ,MAQdR,WAAP,SACC/pB,EACAyqB,EACAH,GAEAr/B,KAAK6/B,WAAY7/B,KAAM+U,EAAQyqB,EAAOH,IAGhCP,UAAP,SAAuB/9B,GACtB,GAAyB,MAArBf,KAAKk/B,aACR,OAAOl/B,KAAKk/B,aAAcn+B,GAE1B,MAAM,IAAIN,MAAO,2BAvEFq+B,WAA+B,GAC/BA,kBAA2C,wBCE5D,WACCjO,EACAzuB,EAAeyD,EAAgBi6B,EAC/BhM,GAEA9zB,KAAK6wB,GAAKA,EACV7wB,KAAKywB,IAAM,EACX,IAAMhkB,EAAaqnB,EAAYrnB,WAC/BzM,KAAK+/B,MAAQ,IAAIlF,YAAW,EAAG,EAAGz4B,EAAQqK,EAAY5G,EAAS4G,GAC/DzM,KAAK4F,QAAU,IAAIgH,UAASknB,EAAa,IAAI+G,YAAW,EAAG,EAAG,EAAG,IAEjE76B,KAAKoC,MAAQA,EACbpC,KAAK6F,OAASA,EACd7F,KAAK8/B,YAAcA,EAkBrB,OAbCE,uBAAA,WACC,IAAMC,EAAoB,EAAIjgC,KAAK4F,QAAQkuB,YAAYrnB,WACvDzM,KAAK4F,QAAQm6B,MAAMz6B,EAAItF,KAAK+/B,MAAMz6B,EAAI26B,EACtCjgC,KAAK4F,QAAQm6B,MAAMx6B,EAAIvF,KAAK+/B,MAAMx6B,EAAI06B,EACtCjgC,KAAK4F,QAAQm6B,MAAM39B,MAAQpC,KAAKoC,MAChCpC,KAAK4F,QAAQm6B,MAAMl6B,OAAS7F,KAAK6F,OACjC7F,KAAK4F,QAAQs6B,YACblgC,KAAK4F,QAAQqN,KAAM,SAAUjT,OAG9BggC,oBAAA,WACChgC,KAAK4F,QAAQiO,+BCvCf,4DAIA,OAJ2C/T,OAC1CqgC,mBAAA,SAAQtN,QADkCmN,mBCK1C,WAAapT,EAA4BkH,GAAzC,MACC9tB,YAAO4mB,EAAMiE,GAAIjE,EAAMxqB,MAAQ0xB,EAAYrnB,WAAYmgB,EAAM/mB,OAASiuB,EAAYrnB,WAAY,EAAGqnB,gBACjG3tB,EAAK4sB,OAASnG,EAAMmG,SAUtB,OAf+CjzB,OAQ9CsgC,mBAAA,SAAQvN,GACP,IAAME,EAAS/yB,KAAK+yB,OACpB,GAAc,MAAVA,EAAiB,CACpB,IAAMgN,EAAQ//B,KAAK+/B,MACnBlN,EAAQwN,UAAWtN,EAAQgN,EAAMz6B,EAAGy6B,EAAMx6B,EAAGw6B,EAAM39B,MAAO29B,EAAMl6B,aAZpBm6B,mBCE9C,WAAajG,EAAyBjG,GAAtC,MACC9tB,YAAO+zB,EAAMuG,IAAKvG,EAAM33B,MAAQ0xB,EAAYrnB,WAAYstB,EAAMl0B,OAASiuB,EAAYrnB,WAAY,EAAGqnB,gBAClG3tB,EAAK4zB,MAAQA,IAkBf,OAvB2Cj6B,OAQ1CygC,mBAAA,SAAQ1N,GACP,IAAMkN,EAAQ//B,KAAK+/B,MACbz6B,EAAIy6B,EAAMz6B,EACVC,EAAIw6B,EAAMx6B,EACV8D,EAAI02B,EAAM39B,MACVkH,EAAIy2B,EAAMl6B,OACVk0B,EAAQ/5B,KAAK+5B,MAEnBlH,EAAQwN,UAAWtG,EAAOz0B,EAAGC,EAAG8D,EAAGC,GAEnCupB,EAAQwN,UAAWtG,EAAO,EAAG,EAAG,EAAGzwB,EAAGhE,EAAI,EAAGC,EAAI,EAAG,EAAG+D,EAAI,GAC3DupB,EAAQwN,UAAWtG,EAAO,EAAG,EAAG1wB,EAAG,EAAG/D,EAAGC,EAAI,EAAG8D,EAAG,GACnDwpB,EAAQwN,UAAWtG,EAAO1wB,EAAI,EAAG,EAAG,EAAGC,EAAGhE,EAAI+D,EAAG9D,EAAI,EAAG,EAAG+D,EAAI,GAC/DupB,EAAQwN,UAAWtG,EAAO,EAAGzwB,EAAI,EAAGD,EAAG,EAAG/D,EAAGC,EAAI+D,EAAGD,EAAG,OArBd22B,mBCG1C,WAAanP,EAAYlE,EAAYmH,GAArC,MACC9tB,YAAO6qB,EAAIlE,EAAKvqB,MAAOuqB,EAAK9mB,OAAQ,EAAGiuB,gBACvC3tB,EAAKgvB,GAAQxI,IAOf,OAZ0C7sB,OAQzC0gC,mBAAA,SAAQ3N,GACP,IAAMkN,EAAQ//B,KAAK+/B,MACnBlN,EAAQwN,UAAWrgC,KAAKm1B,GAAMpC,OAAQgN,EAAMz6B,EAAGy6B,EAAMx6B,EAAGw6B,EAAM39B,MAAO29B,EAAMl6B,YAVnCm6B,mBCD1C,4DASA,OAT2ClgC,OAC1C2gC,mBAAA,SAAQ5N,GACP,IAAMkN,EAAQ//B,KAAK+/B,MAEnBlN,EAAQoB,OACRpB,EAAQS,UAAY,UACpBT,EAAQ6N,SAAUX,EAAMz6B,EAAI,EAAGy6B,EAAMx6B,EAAI,EAAGw6B,EAAM39B,MAAQ,EAAG29B,EAAMl6B,OAAS,GAC5EgtB,EAAQuB,cAPiC4L,kBCe1C,aACC,IAAMjN,EAAS/yB,KAAKqxB,GAAUzZ,SAAS0Z,cAAe,UACtDyB,EAAO3wB,MAAQ2wB,EAAOltB,OAAS,IAE/B,IAAMiuB,EAAc9zB,KAAK2gC,GAAeC,cAAY/zB,KAAMkmB,EAAQ,CACjEhB,OAAQC,eAAaC,IACrBxlB,WAAYC,WAASC,aAGtB3M,KAAK6gC,GAAa,GAClB7gC,KAAK8gC,GAAc,GACnB9gC,KAAK+gC,GAAc,CAClBC,MAAO,IAAIb,GACV,QAAS,GAAI,GAAI,EAAGrM,GAErBmN,MAAO,IAAIR,GACV,QAAS,GAAI,GAAI,EAAG3M,IAItB9zB,KAAKwG,GAAW,EAwLlB,OArLC06B,yBAAA,SAAc9+B,EAAe0E,GAK5B,IAJA,IACIxB,EADY,EAEZC,EAFY,EAGZ47B,EAAe,EACVvtB,EAAI,EAAGG,EAAOjN,EAAK6L,OAAQiB,EAAIG,IAAQH,EAAI,CACnD,IAAMwtB,EAAQt6B,EAAM8M,GAChBxR,EAAQkD,EAAI87B,EAAMrB,MAAM39B,MANb,IAOdkD,EAPc,EAQdC,GAAK47B,EARS,EASdA,EAAe,GAEhBC,EAAMrB,MAAMz6B,EAAQ,EAAJA,EAChB87B,EAAMrB,MAAMx6B,EAAQ,EAAJA,EAChBD,GAAK87B,EAAMrB,MAAM39B,MAbF,EAcf++B,EAAel1B,KAAKC,IAAKi1B,EAAcC,EAAMrB,MAAMl6B,QAKpD,IAFA,IAAMw7B,EAAY97B,EAAI47B,EAjBN,EAkBZ5gC,EAAS,IACNA,EAAS8gC,GACf9gC,IAAW,EAEZ,OAAO0L,KAAK0iB,IA1De,KA0DYpuB,IAGxC2gC,yBAAA,SAAc9+B,EAAeyD,EAAgBiB,GAC5C,IAAMisB,EAAS/yB,KAAKqxB,GACpB0B,EAAO3wB,MAAQA,EACf2wB,EAAOltB,OAASA,EAChB,IAAMgtB,EAAUE,EAAOD,WAAY,MACnC,GAAe,MAAXD,EACH,IAAK,IAAIjf,EAAI,EAAGG,EAAOjN,EAAK6L,OAAQiB,EAAIG,IAAQH,EACjC9M,EAAM8M,GACd0X,OAAQuH,IAKjBqO,wBAAA,SAAap6B,GACZ,IAAK,IAAI8M,EAAI,EAAGG,EAAOjN,EAAK6L,OAAQiB,EAAIG,IAAQH,EACjC9M,EAAM8M,GACd0tB,cAIRJ,4BAAA,SAAiBp6B,GAEhB,IADA,IAAIvG,EAAS,IACJqT,EAAI9M,EAAK6L,OAAS,EAAG,GAAKiB,IAAKA,EAGvC,IAFA,IAAMwtB,EAAQt6B,EAAM8M,GACdzH,EAAOF,KAAKC,IAAKk1B,EAAMrB,MAAM39B,MAAOg/B,EAAMrB,MAAMl6B,QAC/CtF,EAAS4L,GACf5L,IAAW,EAGb,OAAO0L,KAAK0iB,IA1Fe,KA0FYpuB,GAAU,IAGlD2gC,oBAAA,SAASp6B,GACRA,EAAKy6B,KAAML,EAAaM,iBACxB,IAAK,IAAI5tB,EAAI9M,EAAK6L,OAAS,EAAG,GAAKiB,IAAKA,EAEvC,GAAI,EADU9M,EAAM8M,GACN6c,IAEb,YADA3pB,EAAK6L,OAASiB,EAAI,GAIpB9M,EAAK6L,OAAS,GAGfuuB,kBAAA,WAEC,IADA,IAAMp6B,EAAO9G,KAAK8gC,GACTltB,EAAI,EAAGG,EAAOjN,EAAK6L,OAAQiB,EAAIG,IAAQH,EACjC9M,EAAM8M,GACd6c,IAAM,EAGbzwB,KAAKwG,GAAW,GAGjB06B,gBAAA,WAGC,IAFA,IAAMO,EAAYzhC,KAAK6gC,GACjB/5B,EAAO9G,KAAK8gC,GACTltB,EAAI,EAAGG,EAAOjN,EAAK6L,OAAQiB,EAAIG,IAAQH,EAAI,CACnD,IAAMwtB,EAAQt6B,EAAM8M,GAChBwtB,EAAM3Q,KAAO,IACT2Q,EAAMvQ,MAAM7wB,KAAK+gC,IACvBK,EAAMvtB,iBAEA4tB,EAAWL,EAAMvQ,IACxB7wB,KAAKwG,GAAW,KAKnB06B,mBAAA,SAAQQ,GACP,IAAiB,IAAbA,GAAqB1hC,KAAKwG,EAAW,CACxCxG,KAAKwG,GAAW,EAChB,IAAMM,EAAO9G,KAAK8gC,GAClB9gC,KAAK0T,QAAS5M,GACd,IAAM66B,EAAc3hC,KAAK4hC,gBAAiB96B,GACpC+6B,EAAe7hC,KAAK8hC,aAAcH,EAAa76B,GACrD9G,KAAK+hC,aAAcJ,EAAaE,EAAc/6B,GAC9C9G,KAAK2gC,GAAatM,YAAasN,EAAaE,GAC5C7hC,KAAKgiC,YAAal7B,KAIpBo6B,gBAAA,SAAKrQ,GACJ,IACMuQ,EADYphC,KAAK6gC,GACGhQ,GAC1B,GAAa,MAATuQ,EAEH,OADAA,EAAM3Q,KAAO,EACN2Q,EAEP,IAAMa,EAAajiC,KAAK+gC,GAAalQ,GACrC,OAAkB,MAAdoR,GACHjiC,KAAKwF,IAAKqrB,EAAIoR,GACPA,GAGF,MAGRf,gBAAA,SAAKrQ,EAAYrP,GAChB,IAAMjhB,EAASP,KAAK6gC,GAAYhQ,GAKhC,OAJArP,EAAKiP,KAAO,EACZzwB,KAAK6gC,GAAYhQ,GAAOrP,EACxBxhB,KAAK8gC,GAAYluB,KAAM4O,GACvBxhB,KAAKwG,GAAW,EACTjG,GAGR2gC,oBAAA,WACClhC,KAAKwG,GAAW,GAGjB06B,8BAAA,WACC,OAAOlhC,KAAKgN,IAAK,SAAWpH,SAG7Bs7B,2BAAA,WACC,OAAOlhC,KAAK2gC,IAGbO,oBAAA,SAASrQ,GACR,IAAM4Q,EAAYzhC,KAAK6gC,GACjBO,EAAQK,EAAW5Q,GACZ,MAATuQ,IACHA,EAAM3Q,KAAO,EACT2Q,EAAM3Q,KAAO,IACT2Q,EAAMvQ,MAAM7wB,KAAK+gC,IACvBK,EAAMvtB,iBAEA4tB,EAAW5Q,GAClB7wB,KAAKwG,GAAW,KAKZ06B,kBAAkB,SAAE1T,EAAqBjuB,GAC/C,OAAIiuB,EAAEiD,KAAO,EACRlxB,EAAEkxB,KAAO,EACL,EAEA,EAGJlxB,EAAEkxB,KAAO,GACJ,EAINjD,EAAEuS,MAAMl6B,OAAStG,EAAEwgC,MAAMl6B,QACpB,EACEtG,EAAEwgC,MAAMl6B,OAAS2nB,EAAEuS,MAAMl6B,OAC5B,EAEA2nB,EAAEuS,MAAM39B,MAAQ7C,EAAEwgC,MAAM39B,0BCxIjC,aAAA,WACCpC,KAAKkiC,GAAM,KACXliC,KAAKqG,EAAW,KAChBrG,KAAKmiC,GAAiB,KACtBniC,KAAKoiC,GAA2B17B,IAChC1G,KAAKqiC,GAAyB37B,IAC9B1G,KAAKsiC,GAAkB57B,IACvB1G,KAAKuiC,GAAe77B,IACpB1G,KAAKwiC,GAAM,KACXxiC,KAAKyiC,GAAO,KAEZ,IAAM1P,EAAS/yB,KAAKqxB,GAAUzZ,SAAS0Z,cAAe,UACtDyB,EAAO3wB,MAAQ,GACf2wB,EAAOltB,OAAS,GAChB7F,KAAK0iC,GAAe,SAAEzsB,GACrBA,EAAEgC,kBAEHjY,KAAK2iC,GAAkB,WACtBx8B,EAAKiuB,WAENp0B,KAAK4iC,GAAiB,WACrBz8B,EAAK0N,WAENkf,EAAOjb,iBAAkB,mBAAoB9X,KAAK0iC,IAAc,GAChE3P,EAAOjb,iBAAkB,uBAAwB9X,KAAK2iC,IAAiB,GACvE5hB,OAAOjJ,iBAAkB,SAAU9X,KAAK4iC,IAAgB,GAwR1D,OArRCC,iBAAA,WACC,IAAM9P,EAAS/yB,KAAKqxB,GACpB,GAAc,MAAV0B,IAA+B,MAAZ/yB,KAAKkiC,IAAeliC,KAAKkiC,GAAIY,iBAAmB,CACtE,IAAMC,EAAiC,CACtCxhC,OAAO,EACPyhC,WAAW,EACXC,OAAO,EACPC,SAAS,EACTC,oBAAoB,GAEfC,EAAKpjC,KAAKkiC,GACfnP,EAAOD,WAAY,QAASiQ,IAC5BhQ,EAAOD,WAAY,qBAAsBiQ,GAEhC,MAANK,IACHA,EAAGC,WAAW,EAAK,EAAK,EAAK,GAC7BrjC,KAAKsjC,mBACLtjC,KAAKujC,eACLvjC,KAAKwjC,cACLxjC,KAAKqG,EAAW,MAGlB,OAAOrG,MAGR6iC,oBAAA,WACC7iC,KAAKgmB,QAGN6c,sBAAA,WACC,OAAO7iC,KAAKqxB,IAGbwR,sBAAA,SAAWO,EAA2BlsB,EAAcyD,GACnD,IAAMrQ,EAAWqQ,EAChByoB,EAAGK,aAAcL,EAAGM,iBACpBN,EAAGK,aAAcL,EAAGO,eAErB,OAAc,MAAVr5B,IACH84B,EAAGQ,aAAct5B,EAAQ4M,GACzBksB,EAAGS,cAAev5B,GACZ84B,EAAGU,mBAAoBx5B,EAAQ84B,EAAGW,iBAMlCz5B,GAJL05B,SAAWA,QAAQC,MAAO,iCAAiCb,EAAGc,iBAAiB55B,IACxE,OAMVu4B,wBAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GAChB,GAAU,MAANkB,IAAqC,IAAvBA,EAAGN,gBAA2B,CAC/C,IAAMqB,EAAenkC,KAAKokC,UAAWhB,EAnKlB,qNAmKqC,GACxD,GAAoB,MAAhBe,EAAuB,CAC1B,IAAME,EAAiBrkC,KAAKokC,UAAWhB,EA3JnB,+hDA2JwC,GAC5D,GAAsB,MAAlBiB,EAAyB,CAC5B,IAAMC,EAAgBtkC,KAAKmiC,GAAiBiB,EAAGmB,gBAC/C,GAAqB,MAAjBD,EAIH,OAHAlB,EAAGoB,aAAcF,EAAeH,GAChCf,EAAGoB,aAAcF,EAAeD,GAChCjB,EAAGqB,YAAaH,GACVlB,EAAGsB,oBAAoBJ,EAAelB,EAAGuB,cAO9CvB,EAAGwB,aAAcT,GACjBf,EAAGwB,aAAcP,GAEjBjB,EAAGyB,WAAYP,GACftkC,KAAKoiC,GAA2BgB,EAAG0B,kBAAmBR,EAAe,mBACrEtkC,KAAKqiC,GAAyBe,EAAG0B,kBAAmBR,EAAe,iBACnEtkC,KAAKsiC,GAAkBc,EAAG2B,mBAAoBT,EAAe,YAC7DtkC,KAAKuiC,GAAea,EAAG2B,mBAAoBT,EAAe,SAC1DlB,EAAGyB,WAAY,MACRP,IAdPN,SAAWA,QAAQC,MAAO,+BAA+Bb,EAAG4B,YAC5D5B,EAAGwB,aAAcT,GACjBf,EAAGwB,aAAcP,GACV,MAcRjB,EAAGwB,aAAcT,GACjBf,EAAGwB,aAAcP,QAGlBjB,EAAGwB,aAAcT,IAIpB,OAAO,MAGRtB,2BAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GAChB,GAAU,MAANkB,IAAqC,IAAvBA,EAAGN,gBAA2B,CAC/C,IAAMwB,EAAgBtkC,KAAKmiC,GACN,MAAjBmC,IACHtkC,KAAKmiC,GAAiB,KACtBiB,EAAGyB,WAAY,MACfzB,EAAG6B,cAAeX,MAKrBzB,0BAAA,SAAeqC,GACd,IAAM9B,EAAKpjC,KAAKkiC,GACVnP,EAAS/yB,KAAKqxB,GACpB,GAAU,MAAN+R,IAAqC,IAAvBA,EAAGN,iBAAsC,MAAV/P,EAAiB,CACjE,IAAM3wB,EAAQ8iC,EAAc9iC,MACtByD,EAASq/B,EAAcr/B,OACzBktB,EAAO3wB,QAAUA,GAAS2wB,EAAOltB,SAAWA,IAC/CktB,EAAO3wB,MAAQA,EACf2wB,EAAOltB,OAASA,EAChBu9B,EAAG+B,SAAU,EAAG,EAAG/iC,EAAOyD,IAG3B,IAAID,EAAU5F,KAAKqG,EAenB,OAde,MAAXT,GACHA,EAAU5F,KAAKqG,EAAW+8B,EAAGgC,gBAC7BhC,EAAGiC,YAAajC,EAAGkC,WAAY1/B,GAC/Bw9B,EAAGmC,WAAYnC,EAAGkC,WAAY,EAAGlC,EAAGoC,KAAMpC,EAAGoC,KAAMpC,EAAGqC,cAAeP,GACrE9B,EAAGsC,cAAetC,EAAGkC,WAAYlC,EAAGuC,eAAgBvC,EAAGwC,eACvDxC,EAAGsC,cAAetC,EAAGkC,WAAYlC,EAAGyC,eAAgBzC,EAAGwC,eACvDxC,EAAGsC,cAAetC,EAAGkC,WAAYlC,EAAG0C,mBAAoB1C,EAAGhR,SAC3DgR,EAAGsC,cAAetC,EAAGkC,WAAYlC,EAAG2C,mBAAoB3C,EAAGhR,SAC3DgR,EAAGiC,YAAajC,EAAGkC,WAAY,QAE/BlC,EAAGiC,YAAajC,EAAGkC,WAAY1/B,GAC/Bw9B,EAAGmC,WAAYnC,EAAGkC,WAAY,EAAGlC,EAAGoC,KAAMpC,EAAGoC,KAAMpC,EAAGqC,cAAeP,GACrE9B,EAAGiC,YAAajC,EAAGkC,WAAY,OAEzB1/B,EAER,OAAO,MAGRi9B,2BAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GACVt8B,EAAU5F,KAAKqG,EACX,MAAN+8B,IAAqC,IAAvBA,EAAGN,iBAAuC,MAAXl9B,IAChD5F,KAAKqG,EAAW,KAChB+8B,EAAGiC,YAAajC,EAAGkC,WAAY,MAC/BlC,EAAG4C,cAAepgC,KAIpBi9B,6BAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GAChB,GAAU,MAANkB,IAAqC,IAAvBA,EAAGN,gBAA2B,CAC/C,IAAMmD,EAAKjmC,KAAKwiC,GAAMY,EAAG8C,eAWzB,OAVA9C,EAAG+C,WAAY/C,EAAGgD,aAAcH,GAShC7C,EAAGiD,WAAYjD,EAAGgD,aAAc,IAAIngC,aAPnB,EACf,EAAK,EACN,EAAM,GACL,GAAM,EACP,GAAO,IAGoDm9B,EAAGkD,aACxDL,EAER,OAAO,MAGRpD,gCAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GACV+D,EAAKjmC,KAAKwiC,GACN,MAANY,IAAqC,IAAvBA,EAAGN,iBAAkC,MAANmD,IAChDjmC,KAAKwiC,GAAM,KACXY,EAAG+C,WAAY/C,EAAGgD,aAAc,MAChChD,EAAGmD,aAAcN,KAInBpD,yBAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GAChB,GAAU,MAANkB,IAAqC,IAAvBA,EAAGN,gBAA2B,CAC/C,IAAM0D,EAAMxmC,KAAKyiC,GAAOW,EAAG8C,eAW3B,OAVA9C,EAAG+C,WAAY/C,EAAGgD,aAAcI,GAShCpD,EAAGiD,WAAYjD,EAAGgD,aAAc,IAAIngC,aAPxB,CACX,EAAM,EACN,EAAM,EACN,EAAM,EACN,EAAM,IAGgDm9B,EAAGkD,aACnDE,EAER,OAAO,MAGR3D,4BAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GACVsE,EAAMxmC,KAAKyiC,GACP,MAANW,IAAqC,IAAvBA,EAAGN,iBAAmC,MAAP0D,IAChDxmC,KAAKyiC,GAAO,KACZW,EAAG+C,WAAY/C,EAAGgD,aAAc,MAChChD,EAAGmD,aAAcC,KAInB3D,mBAAA,WACC,IAAMO,EAAKpjC,KAAKkiC,GACVnP,EAAS/yB,KAAKqxB,GACdiT,EAAgBtkC,KAAKmiC,GACrB8D,EAAKjmC,KAAKwiC,GACVgE,EAAMxmC,KAAKyiC,GACX78B,EAAU5F,KAAKqG,EACrB,GAAU,MAAN+8B,IAAqC,IAAvBA,EAAGN,iBAAsC,MAAV/P,GAC/B,MAAjBuR,GAA+B,MAAN2B,GAAqB,MAAPO,GAA0B,MAAX5gC,EAAkB,CACxEw9B,EAAGjgB,MAAOigB,EAAGqD,kBAEbrD,EAAGyB,WAAYP,GAEflB,EAAG+C,WAAY/C,EAAGgD,aAAcH,GAChC,IAAMS,EAA0B1mC,KAAKoiC,GACrCgB,EAAGuD,wBAAyBD,GAC5BtD,EAAGwD,oBAAqBF,EAAyB,EAAGtD,EAAGyD,OAAO,EAAO,EAAG,GAExEzD,EAAG+C,WAAY/C,EAAGgD,aAAcI,GAChC,IAAMM,EAAwB9mC,KAAKqiC,GACnCe,EAAGuD,wBAAyBG,GAC5B1D,EAAGwD,oBAAqBE,EAAuB,EAAG1D,EAAGyD,OAAO,EAAO,EAAG,GAEtEzD,EAAG2D,cAAe3D,EAAG4D,UACrB5D,EAAGiC,YAAajC,EAAGkC,WAAY1/B,GAC/Bw9B,EAAG6D,UAAWjnC,KAAKsiC,GAAiB,GACpCc,EAAG8D,UAAWlnC,KAAKuiC,GAAcxP,EAAO3wB,MAAO2wB,EAAOltB,QAEtDu9B,EAAG+D,WAAY/D,EAAGgE,eAAgB,EAAG,GAErChE,EAAGiC,YAAajC,EAAGkC,WAAY,MAC/BlC,EAAG+C,WAAY/C,EAAGgD,aAAc,MAChChD,EAAGyB,WAAY,QAIjBhC,iBAAA,SAAMwE,GACL,IAAMjE,EAAKpjC,KAAKkiC,GACVnP,EAAS/yB,KAAKqxB,GACpB,GAAU,MAAN+R,IAAqC,IAAvBA,EAAGN,iBAAsC,MAAV/P,EAAiB,CACjE,IAAM3wB,EAAQ2wB,EAAO3wB,MACfyD,EAASktB,EAAOltB,OACtBwhC,EAAWjlC,MAAQA,EACnBilC,EAAWxhC,OAASA,EACpB,IAAMyhC,EAAcD,EAAWvU,WAAY,MACxB,MAAfwU,GACHA,EAAYjH,UAAWtN,EAAQ,EAAG,KAKrC8P,oBAAA,WACC7iC,KAAKunC,sBACLvnC,KAAKwnC,kBACLxnC,KAAKynC,iBAEL,IAAM1U,EAAS/yB,KAAKqxB,GACN,MAAV0B,IACH/yB,KAAKqxB,GAAU,KACf0B,EAAO2U,oBAAqB,mBAAoB1nC,KAAK0iC,IAAc,GACnE3P,EAAO2U,oBAAqB,uBAAwB1nC,KAAK2iC,IAAiB,GAC1E5hB,OAAO2mB,oBAAqB,SAAU1nC,KAAK4iC,IAAgB,IAG5D,IAAMQ,EAAKpjC,KAAKkiC,GAChB,GAAU,MAANkB,EAAa,CAChBpjC,KAAKkiC,GAAM,KACX,IAAMyF,EAAmBvE,EAAGwE,aAAc,sBAClB,MAApBD,GACHA,EAAiBE,mCC9VpB,WAAa3Y,GACZlvB,KAAK6uB,GAAM,cAAcK,EACzBlvB,KAAK8nC,GAAaC,EAAoBC,eAAehiB,OACrDhmB,KAAKqxB,GAAUzZ,SAAS0Z,cAAe,UACvCtxB,KAAKwxB,GAAQ,CACZyW,OAAQF,EAAoBG,aAAchZ,GAC1C/iB,KAAM,GACNg8B,QAAQ,GAETnoC,KAAK0xB,GAAc,GACnB1xB,KAAK2xB,GAAU,EACf3xB,KAAKmC,EAAS,EACdnC,KAAKoG,EAAU,EACfpG,KAAKwG,GAAW,EA2OlB,OAxOChH,sBAAIuoC,sBAAJ,WACC,OAAO/nC,KAAK6uB,oCAGbrvB,sBAAIuoC,wBAAJ,WACC,OAAO/nC,KAAKwxB,QAGb,SAAU5D,GACT5tB,KAAKwxB,GAAMyW,OAASra,EAAKqa,OACzBjoC,KAAKwxB,GAAMrlB,KAAOyhB,EAAKzhB,KACvBnM,KAAKwxB,GAAM2W,OAASva,EAAKua,wCAG1B3oC,sBAAIuoC,yBAAJ,WACC,OAAO/nC,KAAKmC,mCAGb3C,sBAAIuoC,0BAAJ,WACC,OAAO/nC,KAAKoG,mCAGb5G,sBAAIuoC,0BAAJ,WACC,OAAO/nC,KAAKqxB,oCAGb7xB,sBAAIuoC,6BAAJ,WACC,OAAO/nC,KAAK8nC,oCAGbtoC,sBAAIuoC,8BAAJ,WACC,OAAO/nC,KAAK0xB,oCAGbqW,kBAAA,WACC/nC,KAAK2xB,GAAU,EACf,IAAMa,EAAaxyB,KAAK0xB,GACxB,IAAK,IAAM7D,KAAa2E,EACvBA,EAAY3E,GAAY4C,IAAM,GAIhCsX,gBAAA,WACC,IAAMvV,EAAaxyB,KAAK0xB,GACxB,IAAK,IAAM7D,KAAa2E,EAAa,CACpC,IAAM1rB,EAAO0rB,EAAY3E,GACrB/mB,EAAK2pB,KAAO,IACf3pB,EAAK4pB,MAAQ,EACT5pB,EAAK4pB,MAAQ,WACT8B,EAAY3E,GACnB7tB,KAAKwG,GAAY,MAMrBuhC,qBAAA,WACC/nC,KAAKqyB,IAAK9B,IACVvwB,KAAKooC,QAAS,QAGfL,oBAAA,SAASla,GACR,IAAM2E,EAAaxyB,KAAK0xB,GACxB,GAAkB,OAAd7D,EAAqB,CACxB,IAAM/mB,EAAO0rB,EAAY3E,GACb,MAAR/mB,GACCA,EAAK2pB,KAAO,IACfzwB,KAAK2xB,IAAW,GAEjB7qB,EAAK2pB,KAAO,IAEZ+B,EAAY3E,GAAc,IAAI6E,GAA2B,EAAG,EAAG,GAAG,GAClE1yB,KAAK2xB,IAAW,EAChB3xB,KAAKwG,GAAW,KAKnBuhC,gBAAA,SAAKvV,GACJ,IAAK,IAAI5e,EAAI,EAAGG,EAAOye,EAAW7f,OAAQiB,EAAIG,IAAQH,EACrD5T,KAAKooC,QAAS5V,EAAY5e,KAI5Bm0B,gBAAA,SAAKla,GACJ,OAAO7tB,KAAK0xB,GAAa7D,IAG1Bka,mBAAA,WACC,GAAI/nC,KAAKwG,EAAW,CACnB,IAAMusB,EAAS/yB,KAAKqxB,GACdgX,EAAYroC,KAAK8nC,GACvB,GAAc,MAAV/U,GAA+B,MAAbsV,EAAoB,CACzC,IAAMxV,EAAUE,EAAOD,WAAY,MACnC,GAAe,MAAXD,EAAkB,CACrB7yB,KAAKwG,GAAW,EAEhB,IAAMonB,EAAO5tB,KAAKwxB,GACZgB,EAAaxyB,KAAK0xB,GAClB4W,EAAgB1a,EAAKzhB,KAAO,GAC5B/J,EAAQ2lC,EAAoBrU,WAAYznB,KAAKkhB,KAAMlhB,KAAK0nB,KAAM3zB,KAAK2xB,KAAc2W,GACvFtoC,KAAKmC,EAASC,EACd,IAAMotB,GAAa5B,EAAKua,OAAS,UAAY,IAAOva,EAAKzhB,KAAO,MAASyhB,EAAKqa,OAE9EpV,EAAQjF,KAAO4B,EACfqD,EAAQG,UAAY,OACpBH,EAAQI,aAAe,SACvBJ,EAAQK,UAAY,EACpBL,EAAQM,QAAU,QAClBN,EAAQO,SAAW,QACnBP,EAAQQ,WAAa,EACrBR,EAAQS,UAAY,UAEpB,IACMM,EAAY0U,GAAiB,EAC/BhjC,EAAI,EACJC,EAAI,EACR,IAAK,IAAMsoB,KAAa2E,EAAa,CACpC,IAAM1rB,EAAO0rB,EAAY3E,GACnBH,EAAUmF,EAAQ5F,YAAaY,GAAYzrB,MAC3CmmC,EAAiBt8B,KAAKkhB,KAPb,EAO6BO,EAP7B,GAQT8a,EAAkBF,EACpBlmC,GAASkD,EAAIijC,IAChBjjC,EAAI,EACJC,GAAK+iC,GAGNxhC,EAAKxB,EAAIA,EACTwB,EAAKvB,EAAIA,EACTuB,EAAK1E,MAAQmmC,EACbzhC,EAAKjB,OAAS2iC,EACd1hC,EAAK4mB,QAAUA,EACf5mB,EAAKinB,OAAOzoB,EAAIA,EAnBD,EAoBfwB,EAAKinB,OAAOxoB,EAAIA,EAAIquB,EAEpBtuB,GAAKijC,EAEN,IAAM1iC,EAAS7F,KAAKoG,EAAUb,EAAI+iC,EAgBlC,IAAK,IAAMza,KAXXkF,EAAO3wB,MAAQA,EACf2wB,EAAOltB,OAASA,EAChBgtB,EAAQjF,KAAO4B,EACfqD,EAAQG,UAAY,OACpBH,EAAQI,aAAe,SACvBJ,EAAQK,UAAY,EACpBL,EAAQM,QAAU,QAClBN,EAAQO,SAAW,QACnBP,EAAQQ,WAAa,EACrBR,EAAQS,UAAY,UACpBT,EAAQqB,UAAW,EAAG,EAAG9xB,EAAOyD,GACR2sB,EACjB1rB,EAAO0rB,EAAY3E,GACzBgF,EAAQsB,SAAUtG,EAAW/mB,EAAKinB,OAAOzoB,EAAGwB,EAAKinB,OAAOxoB,GAQzD,OAJA8iC,EAAUI,cAAe1V,GACzBsV,EAAU/c,SACV+c,EAAUK,KAAM3V,IAET,IAIV,OAAO,GAGRvzB,sBAAIuoC,0BAAJ,WACC,OAAO/nC,KAAK2xB,oCAGboW,mBAAA,WACC,MAAO,CACN3lC,MAAOpC,KAAKmC,EACZ0D,OAAQ7F,KAAKoG,EACbwnB,KAAM5tB,KAAKwxB,GACXgB,WAAYxyB,KAAK0xB,KAInBqW,qBAAA,WACC,OAAOpI,KAAKC,UAAW5/B,KAAK2oC,WAG7BZ,oBAAA,WAEkB,MADC/nC,KAAK8nC,KAEtB9nC,KAAK8nC,GAAa,MAIL,MADC9nC,KAAKqxB,KAEnBrxB,KAAKqxB,GAAU,MAGhB,IAAMmB,EAAaxyB,KAAK0xB,GACxB,IAAK,IAAM7D,KAAa2E,SAChBA,EAAY3E,IAIdka,eAAP,SAAqB7Y,GACpB,MAAwB,SAAfA,EACR6Y,EAAoBa,oBACpB1Z,GAIK6Y,aAAP,SAAmB57B,GAElB,IADA,IAAI5L,EAAS,GACNA,EAAS4L,GACf5L,IAAW,EAEZ,OAAOA,GAGDwnC,eAAP,WAIC,OAHqC,MAAjCA,EAAoBc,YACvBd,EAAoBc,UAAY,IAAIhG,IAE9BkF,EAAoBc,WAGrBd,oBAAP,WAIC,OAH4C,MAAxCA,EAAoBe,mBACvBf,EAAoBe,iBAAoBvrB,EAAQ7c,cAAcsM,IAAK,SAAkBmiB,kBAE/E4Y,EAAoBe,kBAnQXf,YAA4C,KAC5CA,mBAAkC,wBCdnD,aACC/nC,KAAK00B,GAAW,GAgFlB,OA7ECqU,kBAAA,WACC,IAAMnU,EAAU50B,KAAK00B,GACrB,IAAK,IAAMuT,KAAUrT,EACNA,EAASqT,GACjBe,SAIRD,gBAAA,WACC,IAAMnU,EAAU50B,KAAK00B,GACrB,IAAK,IAAMuT,KAAUrT,EAAU,CAC9B,IAAMhI,EAAQgI,EAASqT,GACnB,EAAIrb,EAAMja,QACbia,EAAMqc,WAEPrc,EAAMsc,MACFtc,EAAMja,QAAU,IACnBia,EAAM/Y,iBACC+gB,EAASqT,MAKnBc,gBAAA,SAAKd,EAAgBtV,GACpB,IAAM/F,EAAQ5sB,KAAK00B,GAAUuT,GAC7B,GAAa,MAATrb,EACHA,EAAMyF,IAAKM,OACL,CACN,IAAMwW,EAAW,IAAIpB,GAAqBE,GAC1CkB,EAAS9W,IAAKM,GACd3yB,KAAK00B,GAAUuT,GAAWkB,IAI5BJ,gBAAA,SAAKd,GACJ,IAAMrb,EAAQ5sB,KAAK00B,GAAUuT,GAC7B,OAAa,MAATrb,EACIA,EAED,MAGRmc,mBAAA,SAAQK,GACP,IAAMxU,EAAU50B,KAAK00B,GACfZ,EAAcsV,EAAUC,iBAC9B,IAAK,IAAMpB,KAAUrT,EAAU,CAC9B,IAAMhI,EAAQgI,EAASqT,GACvB,GAAIrb,EAAMjsB,SAAW,CACpB,IAAM2oC,EAAU1c,EAAMiE,GAChBrP,EAAO4nB,EAAUp8B,IAAKs8B,GAC5B,GAAY,MAAR9nB,EAAe,CAClB,IAAMpf,EAAQwqB,EAAMxqB,MACdyD,EAAS+mB,EAAM/mB,OACf4G,EAAaqnB,EAAYrnB,WAC/B+U,EAAKue,MAAM39B,MAAQA,EACnBof,EAAKue,MAAMl6B,OAASA,EACpB2b,EAAKpf,MAAQA,EAAQqK,EACrB+U,EAAK3b,OAASA,EAAS4G,EACvB28B,EAAU7lB,eAEV6lB,EAAU5jC,IACT8jC,EACA,IAAIlJ,GAA2BxT,EAAOkH,OAO3CiV,oBAAA,WACC,IAAMnU,EAAU50B,KAAK00B,GACrB,IAAK,IAAMuT,KAAUrT,EACNA,EAASqT,GACjBp0B,UAEP7T,KAAK00B,GAAW,uBC/EjB,WAAa6U,EAAmDxoC,EAAkB0M,GAAlF,WACCzN,KAAKM,SAAW,KAChBN,KAAKupC,YAAcA,EACnBvpC,KAAKe,QAAUA,EAEH,MAAR0M,IACCA,EAAKqa,YACR9G,YAAW,WACV7a,EAAK6G,QACH,GAGJS,EAAKN,GAAI,UAAU,WAClBhH,EAAK6G,UAYT,OAPCw8B,gBAAA,WACC,IAAIlpC,EAAWN,KAAKM,SAIpB,OAHgB,MAAZA,IACHA,EAAWN,KAAKM,SAAW,IAAKN,KAAgB,YAAGA,KAAKe,UAElDT,sBC5BT,cAIA,OAHCmpC,mBAAA,SAAQ5oC,EAAgB6oC,EAAcC,GACrC,OAAQA,EAAKC,WAAa,GAAK,KAAO,yBCFxC,cAIA,OAHCC,mBAAA,SAAQhpC,EAAgB6oC,EAAcC,GACrC,OAAQA,EAAKC,WAAa,GAAK,KAAO,yBCFxC,cAIA,OAHCE,mBAAA,SAAQjpC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAKK,+BCFrB,cAIA,OAHCC,mBAAA,SAAQppC,EAAgB6oC,EAAcC,GACrC,MAAO,IAAY,EAAT9oC,YCCX,SAAaqpC,GAEXlqC,KAAKkqC,UADW,MAAbA,GACeA,EAAUvzB,UAAU,EAAGuzB,EAAUv3B,QAElC,kBCPpB,4DAIA,OAJiC7S,OAChCqqC,mBAAA,SAAQtpC,EAAgB6oC,EAAcC,GACrC,OAAO9oC,EAAOupC,cAAcpqC,KAAKkqC,eAFFG,mBCAjC,4DAIA,OAJiCvqC,OAChCwqC,mBAAA,SAAQzpC,EAAgB6oC,EAAcC,GACrC,OAAO9oC,EAAO0pC,QAAQvqC,KAAKkqC,eAFIG,mBCAjC,4DAkDA,OAlDmCvqC,OAClC0qC,mBAAA,SAAQ3pC,EAAgB6oC,EAAcC,GACrC,IAAMtqB,EAAMrf,KAAKyqC,MAAO5pC,EAAQ6oC,EAAMC,GACtC,OAAItqB,EAAM,MACFrf,KAAK0qC,GAAS7pC,EAAQ,EAAO,IAC1Bwe,EAAM,MACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,MACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,MACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,MACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,IAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,IAAO,KAC1Bwe,EAAM,EACTrf,KAAK0qC,GAAS7pC,EAAQ,IAAO,KAC1Bwe,EAAM,IACTrf,KAAK0qC,GAAS7pC,EAAQ,EAAO,IAC1Bwe,EAAM,IACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,IACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,KAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,MAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,MAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,MAAO,KAC1Bwe,EAAM,KACTrf,KAAK0qC,GAAS7pC,EAAQ,MAAO,KAE7Bb,KAAK0qC,GAAS7pC,EAAQ,MAAO,MAI5B2pC,kBAAV,SAAgB3pC,EAAgB6oC,EAAcC,GAC7C,OAAO19B,KAAKoT,IAAIxe,IAGP2pC,eAAV,SAAkB3pC,EAAgB8pC,EAAqBC,GAEtD,MAAO,IADO/pC,EAAS8pC,GACPJ,QAAQvqC,KAAKkqC,WAAaU,MAhDTP,mBCAnC,4DAIA,OAJiCvqC,OAChC+qC,mBAAA,SAAQhqC,EAAgB6oC,EAAcC,GACrC,OAAO9oC,EAAOiqC,YAAY9qC,KAAKkqC,eAFAG,kBCAjC,cAIA,OAHCU,mBAAA,SAAQlqC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAKC,gCCFrB,cAIA,OAHCoB,mBAAA,SAAQnqC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAKC,WAAa,wBCFlC,cAIA,OAHCqB,mBAAA,SAAQpqC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAKuB,WAAa,uBCFlC,cAIA,OAHCC,mBAAA,SAAQtqC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAKyB,kCCFrB,cAIA,OAHCC,mBAAA,SAAQxqC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAK2B,uCCFrB,cAIA,OAHCC,mBAAA,SAAQ1qC,EAAgB6oC,EAAcC,GACrC,OAAoB,IAAT9oC,EAAgB,2BCF7B,cAIA,OAHC2qC,mBAAA,SAAQ3qC,EAAgB6oC,EAAcC,GACrC,OAAmB,EAAT9oC,aCJC4qC,GAAU,SAAEC,EAAa/4B,EAAgB5K,GACrD,IAAM4jC,EAAYD,EAAI/4B,OACtB,GAAIA,EAASg5B,EACZ,OAAOD,EAGR,IADA,IAAIvnC,EAAU,GACLyP,EAAI,EAAGG,EAAOpB,EAASg5B,EAAW/3B,EAAIG,IAAQH,EACtDzP,GAAW4D,EAEZ,OAAO5D,EAAUunC,iBCDjB,WAAa/4B,EAAgBkb,EAAmBxT,GAC/Cra,KAAK2S,OAASA,EACd3S,KAAK6tB,UAAYA,EACjB7tB,KAAKqa,KAAOA,EAMd,OAHCuxB,mBAAA,SAAQ/qC,EAAgB6oC,EAAcC,GACrC,OAAO8B,GAAQzrC,KAAKqa,KAAKwxB,OAAOhrC,EAAQ6oC,EAAMC,GAAO3pC,KAAK2S,OAAQ3S,KAAK6tB,+BCVxE,WAAaxT,GACZra,KAAKqa,KAAOA,EAUd,OAPCyxB,mBAAA,SAAQjrC,EAAgB6oC,EAAcC,GACrC,IAAMppC,EAASP,KAAKqa,KAAKwxB,OAAOhrC,EAAQ6oC,EAAMC,GAC9C,OAAI,EAAIppC,EAAOoS,QAAwB,MAAdpS,EAAO,GACxB,IAAIA,EAAOoW,UAAU,EAAGpW,EAAOoS,YAEhCpS,sBCTR,WAAY8Z,GACXra,KAAKqa,KAAOA,EAUd,OAPC0xB,mBAAA,SAAQlrC,EAAgB6oC,EAAcC,GACrC,IAAMppC,EAASP,KAAKqa,KAAKwxB,OAAOhrC,EAAQ6oC,EAAMC,GAC9C,OAAI,EAAIppC,EAAOoS,QAAwB,MAAdpS,EAAO,GACxB,IAAIA,EAELA,sBCZT,cAIA,OAHCyrC,mBAAA,SAAQnrC,EAAgB6oC,EAAcC,GACrC,OAAU19B,KAAK4nB,MAAe,IAAThzB,2BCFvB,cAIA,OAHCorC,mBAAA,SAAOprC,EAAgB6oC,EAAcC,GACpC,OAAU19B,KAAK4nB,MAAMhzB,2BCOtB,WACCqrC,EAAeC,EAAeC,EAC9BC,EAAeC,EAAevyB,EAAewyB,GAE7CvsC,KAAKksC,EAAIA,EACTlsC,KAAKmsC,EAAIA,EACTnsC,KAAKosC,EAAIA,EACTpsC,KAAKqsC,EAAIA,EACTrsC,KAAKssC,EAAIA,EACTtsC,KAAK+Z,EAAIA,EACT/Z,KAAKusC,GAAKA,EAoBZ,OAjBCC,mBAAA,SAAQ3rC,EAAgB6oC,EAAcC,GACrC,OAAID,EAAO,IACA1pC,KAAK+Z,EAAE8xB,OAAOhrC,EAAQ6oC,EAAMC,OAAS3pC,KAAKusC,GAAGV,OAAOhrC,EAAQ6oC,EAAMC,GAClED,EAAO,IACP1pC,KAAKssC,EAAET,OAAOhrC,EAAQ6oC,EAAMC,OAAS3pC,KAAK+Z,EAAE8xB,OAAOhrC,EAAQ6oC,EAAMC,GACjED,EAAO,KACP1pC,KAAKqsC,EAAER,OAAOhrC,EAAQ6oC,EAAMC,OAAS3pC,KAAKssC,EAAET,OAAOhrC,EAAQ6oC,EAAMC,GACjED,EAAO,MACP1pC,KAAKmsC,EAAEN,OAAOhrC,EAAQ6oC,EAAMC,OAC5B3pC,KAAKosC,EAAEP,OAAOhrC,EAAQ6oC,EAAMC,OAClB3pC,KAAKqsC,EAAER,OAAOhrC,EAAQ6oC,EAAMC,GACtCD,EAAO,OACP1pC,KAAKmsC,EAAEN,OAAOhrC,EAAQ6oC,EAAMC,OAAS3pC,KAAKosC,EAAEP,OAAOhrC,EAAQ6oC,EAAMC,GAEjE3pC,KAAKksC,EAAEL,OAAOhrC,EAAQ6oC,EAAMC,OAAS3pC,KAAKmsC,EAAEN,OAAOhrC,EAAQ6oC,EAAMC,uBClC7E,WAAYtvB,GACXra,KAAKqa,KAAOA,EASd,OAPCoyB,mBAAA,SAAQ5rC,EAAgB6oC,EAAcC,GACrC,IAAMppC,EAASP,KAAKqa,KAAKwxB,OAAOhrC,EAAQ6oC,EAAMC,GAC9C,OAAI,EAAIppC,EAAOoS,QAAwB,MAAdpS,EAAO,GACxB,IAAIA,EAELA,uBCVT,4DAIA,OAJmCT,OACxB4sC,kBAAV,SAAiB7rC,EAAgB6oC,EAAcC,GAC9C,OAAO19B,KAAKoT,IAAIqqB,OAFiBc,kBCGlC,WAAYkB,GACX1rC,KAAK0rC,IAAMA,EAMb,OAHCiB,mBAAA,SAAQ9rC,EAAgB6oC,EAAcC,GACrC,OAAO3pC,KAAK0rC,wBCRd,cAIA,OAHCkB,mBAAA,SAAQ/rC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAKkD,mCCFrB,cAIA,OAHCC,mBAAA,SAAQjsC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAKkD,cAAgB,yBCDrC,cAQA,OAPCE,mBAAA,SAAQlsC,EAAgB6oC,EAAcC,GACrC,IAAMqD,EAAIrD,EAAKsD,oBAIf,OAHaD,GAAK,EAAI,IAAM,KAChBvB,GAAQ1B,OAAO99B,KAAKihC,MAAMjhC,KAAKoT,IAAI2tB,GAAK,KAAM,EAAG,SACjDvB,GAAQ1B,OAAO99B,KAAKihC,MAAMjhC,KAAKoT,IAAI2tB,GAAK,KAAM,EAAG,yBCN/D,cAIA,OAHCG,mBAAA,SAAQtsC,EAAgB6oC,EAAcC,GACrC,MAAO,GAAG19B,KAAK4nB,MAAMhzB,uBCFvB,cAIA,OAHCusC,mBAAA,SAAQvsC,EAAgB6oC,EAAcC,GACrC,OAAOI,OAAOJ,EAAK0D,oBC6BfC,GAAS,sJAOd,WAAazB,GACZ,IAAI0B,EAAgB,EAChBC,GAAiB,EACfxzB,EAAsB,GAE5B,IADAszB,GAAOG,UAAY,IACL,CACb,IAAMvyB,EAAUoyB,GAAOnyB,KAAM0wB,GAC7B,GAAe,MAAX3wB,EAwMG,CACFqyB,EAAgB1B,EAAOl5B,QAC1BqH,EAAMpH,KAAM,IAAI+5B,GAAkBd,EAAOl1B,UAAW42B,EAAe1B,EAAOl5B,UAE3E,MA3MA,IAAM6C,EAAQ0F,EAAQ1F,MAClB+3B,EAAgB/3B,GACnBwE,EAAMpH,KAAM,IAAI+5B,GAAkBd,EAAOl1B,UAAW42B,EAAe/3B,KAEpE+3B,EAAgB/3B,EAAQ0F,EAAS,GAAIvI,OAErC,IAAM+6B,EAAMxyB,EAAS,GACfyyB,EAAWzyB,EAAS,GACpBgvB,EAAYhvB,EAAS,GAG3B,OAFkBA,EAAS,IAG3B,IAAK,IACJsyB,GAAiB,EACjBxzB,EAAMpH,KAAM,IAAIg6B,IAChB,MACD,IAAK,KACJY,GAAiB,EACjBxzB,EAAMpH,KACL,IAAIg6B,GACJ,IAAID,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAI1C,KAE7C,MACD,IAAK,MACJuC,GAAiB,EACjBxzB,EAAMpH,KACL,IAAIg6B,GACJ,IAAID,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAI1C,IAC5C,IAAI0B,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAI7D,KAE7C,MACD,IAAK,IACJ0D,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK4tC,wBAAyBD,EAAU,IAAIb,KACxD,MACD,IAAK,KACJU,GAAiB,EACjBxzB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAIb,IAC5C,IAAIH,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAI1C,KAE7C,MACD,IAAK,MACJjxB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAIb,IAC5C,IAAIH,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAI1C,IAC5C,IAAI0B,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAI7D,KAE7C,MACD,IAAK,IACJ0D,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK4tC,wBAAyBD,EAAU,IAAI1C,KACxD,MACD,IAAK,KACJuC,GAAiB,EACjBxzB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAI1C,IAC5C,IAAI0B,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAI7D,KAE7C,MACD,IAAK,IACJ0D,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK4tC,wBAAyBD,EAAU,IAAI7D,KACxD,MACD,IAAK,IACJ0D,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK4tC,wBAAyBD,EAAU,IAAI5C,KACxD,MACD,IAAK,KACJyC,GAAiB,EACjBxzB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAI5C,IAC5C,IAAI4B,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAIxC,KAE7C,MACD,IAAK,MACJqC,GAAiB,EACjBxzB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAI5C,IAC5C,IAAI4B,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAIxC,IAC5C,IAAIwB,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAIP,KAE7C,MACD,IAAK,IACJI,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK4tC,wBAAyBD,EAAU,IAAI3C,KACxD,MACD,IAAK,KACJwC,GAAiB,EACjBxzB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAI3C,IAC5C,IAAI2B,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAIxC,KAE7C,MACD,IAAK,MACJqC,GAAiB,EACjBxzB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAI3C,IAC5C,IAAI2B,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAIxC,IAC5C,IAAIwB,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAIP,KAE7C,MACD,IAAK,IACJI,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK4tC,wBAAyBD,EAAU,IAAIxC,KACxD,MACD,IAAK,KACJqC,GAAiB,EACjBxzB,EAAMpH,KACL5S,KAAK4tC,wBAAyBD,EAAU,IAAIxC,IAC5C,IAAIwB,GAAkB,KACtB3sC,KAAK4tC,wBAAyBD,EAAU,IAAIP,KAE7C,MACD,IAAK,KACJI,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK6tC,wBAAyBF,EAAU,IAAItC,KACxD,MACD,IAAK,IACJmC,GAAiB,EACjBxzB,EAAMpH,KAAM,IAAIi3B,IAChB,MACD,IAAK,IACJ2D,GAAiB,EACjBxzB,EAAMpH,KAAM,IAAI62B,IAChB,MACD,IAAK,IACJ+D,GAAiB,EACjBxzB,EAAMpH,KAAM5S,KAAK4tC,wBAAyBD,EAAU,IAAIP,KACxD,MACD,IAAK,MACJI,GAAiB,EACjBxzB,EAAMpH,KAAK,IAAI45B,GACd,IAAII,GACJ5sC,KAAK4tC,wBAAyBD,EAAU,IAAI1C,IAC5CjrC,KAAK4tC,wBAAyBD,EAAU,IAAI7D,IAC5C9pC,KAAK4tC,wBAAyBD,EAAU,IAAI5C,IAC5C/qC,KAAK4tC,wBAAyBD,EAAU,IAAIxC,IAC5CnrC,KAAK4tC,wBAAyBD,EAAU,IAAIP,IAC5CptC,KAAK6tC,wBAAyBF,EAAU,IAAItC,MAE7C,MACD,IAAK,IACJmC,GAAiB,EACjBxzB,EAAMpH,KAAM,IAAIm6B,IAChB,MACD,IAAK,IACJ/yB,EAAMpH,KAAM,IAAI+5B,GAAkB,MAClC,MACD,IAAK,IACJ3yB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAIrD,GAAaJ,KAClE,MACD,IAAK,IACJlwB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAIxD,GAAaD,KAClE,MACD,IAAK,IACJlwB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAI9C,GAAaX,KAClE,MACD,IAAK,KACJlwB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAIR,KACrD,MACD,IAAK,IACJnzB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAI1D,KACrD,MACD,IAAK,IACJjwB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAIpC,KACrD,MACD,IAAK,IACJvxB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAInC,KACrD,MACD,IAAK,KACJxxB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAI3B,KACrD,MACD,IAAK,KACJhyB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAI1B,KACrD,MACD,IAAK,MACJjyB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAInD,GAAeN,KACpE,MACD,IAAK,MACJlwB,EAAMpH,KAAM5S,KAAK8tC,qBAAsBH,EAAU,IAAIjB,GAAexC,KACpE,MACD,QACClwB,EAAMpH,KAAM,IAAI+5B,GAAkBe,KAWrC1tC,KAAKwtC,eAAiBA,EACtBxtC,KAAKga,MAAQA,EACbha,KAAK2pC,KAAO,IAAIoE,KAwDlB,OArDWC,oCAAV,SAAmCL,EAAkBtzB,GACpD,OAAQszB,GACR,IAAK,IACJ,OAAO,IAAI/B,GAAmB,EAAG,IAAKvxB,GACvC,IAAK,IACJ,OAAOA,EACR,QACC,OAAO,IAAIuxB,GAAmB,EAAG,IAAKvxB,KAI9B2zB,oCAAV,SAAmCL,EAAkBtzB,GACpD,OAAQszB,GACR,IAAK,IACJ,OAAO,IAAI/B,GAAmB,EAAG,IAAKvxB,GACvC,IAAK,IACJ,OAAOA,EACR,QACC,OAAO,IAAIuxB,GAAmB,EAAG,IAAKvxB,KAI9B2zB,iCAAV,SAAgCL,EAAkBtzB,GACjD,OAAQszB,GACR,IAAK,IACJ,OAAO,IAAIlB,GAAiBpyB,GAC7B,IAAK,IACJ,OAAO,IAAI0xB,GAAgB1xB,GAC5B,IAAK,IACJ,OAAO,IAAIyxB,GAAuBzxB,GACnC,QACC,OAAOA,IAIT2zB,mBAAA,SAAQntC,EAAgB6oC,GACvB,IAAM1vB,EAAQha,KAAKga,MACb2vB,EAAO3pC,KAAK2pC,KACd3pC,KAAKwtC,gBACR7D,EAAKsE,QAASptC,GAGf,IADA,IAAIN,EAAS,GACJqT,EAAI,EAAGG,EAAOiG,EAAMrH,OAAQiB,EAAIG,IAAQH,EAChDrT,GAAUyZ,EAAOpG,GAAIi4B,OAAQhrC,EAAQ6oC,EAAMC,GAE5C,OAAOppC,GAGRytC,uBAAA,WAAA,WACC,OAAO,SAAEntC,EAAgB6oC,GACxB,OAAOvjC,EAAK0lC,OAAQhrC,EAAQ6oC,wBCnT/B,cAIA,OAHQwE,SAAP,SAAerC,GACd,OAAO,IAAImC,GAAqBnC,uBCLlC,cAKA,OAJQsC,QAAP,SAAcC,EAAgBC,EAAgBjlC,GAC7C,IAAMC,EAAI4C,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,EAAGvlB,IACpC,OAAO6C,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,EAAGyf,GAAU,EAAI/kC,GAAKglC,EAAShlC,yBCK9D,WAAagI,EAAgBtQ,GAA7B,MACCiF,YAAO,IAAIsoC,oBAHFnoC,KAA8B,KAIvCA,EAAKhE,EAAS,EACdgE,EAAKC,EAAU,EACfD,EAAKyF,IAAMyF,EAEXk9B,YAAUC,kBAAkBC,YAAatoC,EAAKkL,OAAQlL,EAAKyF,IAAK7K,GAAWA,EAAQ2tC,aAE7E3tC,IAAgC,IAArBA,EAAQ4tC,UACxBxoC,EAAKyoC,SAoCR,OAnDiC9uC,OAmBhC+uC,iBAAA,WAAA,WACC,OAAI7uC,KAAK8uC,GACD9uC,KAAK8uC,IAGb9uC,KAAK8uC,GAAQ,IAAIC,SAAQ,SAAEC,GAC1B,IAAMjV,EAA0B5zB,EAAKkL,OAErC0oB,EAAMkV,QAAU,SAAE13B,GACjBwiB,EAAMkV,QAAU,KACf9oC,EAAa+oC,QAAQC,IAAK53B,IAG5BwiB,EAAMqV,OAAS,WACbjpC,EAAK4jB,OAAgBgQ,EAAM33B,MAAO23B,EAAMl0B,QACzCmpC,KAGDjV,EAAMuG,IAAMn6B,EAAKyF,OAGX5L,KAAK8uC,KAGND,OAAP,SAAax9B,EAAiBg+B,GAE7B,MAAqB,QAAdA,GAEgB,iBAAXh+B,GAAuE,IAAhDA,EAAOqE,QAAQ,8BAE3B,iBAAXrE,GAAkD,IAA3BA,EAAOqE,QAAQ,YAjDnB64B,YAAUC,+BCKjCc,UAAU18B,KAAMi8B,IAO1B,ICNYU,iBDmBX,WAAantC,EAAeotC,EAAelV,GAC1Ct6B,KAAKmC,EAASC,EACdpC,KAAKyvC,GAASD,EACdxvC,KAAK0vC,GAAUpV,EAEft6B,KAAK2vC,GAAU,GACf3vC,KAAK4vC,GAAO,GACZ5vC,KAAK6vC,GAAS,EACd7vC,KAAK8vC,GAAS,EACd9vC,KAAKoG,EAAU,EA0EjB,OAvEC5G,sBAAIuwC,yBAAJ,WACC,OAAO/vC,KAAKmC,mCAGb3C,sBAAIuwC,yBAAJ,WACC,OAAO/vC,KAAKyvC,oCAGbjwC,sBAAIuwC,0BAAJ,WACC,OAAO/vC,KAAK0vC,oCAGbK,gBAAA,SAAKntB,EAAcxgB,EAAeyD,EAAgBmqC,GACjD,IAAMC,EAASjwC,KAAK2vC,GACpB,KAAQ/sB,KAAQqtB,GAAW,CAE1B,IAAM3V,EAASt6B,KAAK0vC,GAChBpqC,EAAItF,KAAK6vC,GACTtqC,EAAIvF,KAAK8vC,GACT9vC,KAAKmC,GAAUmD,EAAIlD,GACtBkD,EAAI,EACJC,EAAIvF,KAAK8vC,GAAS9vC,KAAKoG,EAAUk0B,EACjCt6B,KAAKoG,EAAUP,EACf7F,KAAK8vC,GAASvqC,GAEdvF,KAAKoG,EAAU6F,KAAKC,IAAKlM,KAAKoG,EAASP,GAExC7F,KAAK6vC,GAASvqC,EAAIlD,EAAQk4B,EAG1B2V,EAAQrtB,GAAS,IAAIiY,YAAWv1B,EAAGC,EAAGnD,EAAOyD,GAG7C,IAAM2pC,EAAQxvC,KAAKyvC,GAEnB,OADAzvC,KAAK4vC,IAAQ,2BAA2BtqC,EAAIkqC,MAASjqC,EAAIiqC,QAAWQ,UAC7D,EAER,OAAO,GAGRxwC,sBAAIuwC,4BAAJ,WACC,OAAO/vC,KAAKkwC,yCAGbH,kBAAA,SAAOhvC,GACN,IAAIovC,EAAQnwC,KAAKowC,GACjB,GAAa,MAATD,GAAkBpvC,GAAWA,EAAQsvC,MAAS,CACjD,IAAM5jC,EAAaC,WAASC,WACtBvK,EAAQpC,KAAKmC,EACb0D,EAASoG,KAAKqkC,IAAK,EAAGrkC,KAAKkhB,KAAMlhB,KAAKskC,IAAKvwC,KAAK8vC,GAAS9vC,KAAKoG,GAAY6F,KAAKukC,MAC/Ezc,EAAY3xB,EAAQqK,EACpBunB,EAAanuB,EAAS4G,EACtB+iC,EAAQxvC,KAAKyvC,GAKbgB,EAAM9kC,EAAc,eAJEooB,eACEC,oBACM5xB,EAAQotC,MAAS3pC,EAAS2pC,0CAE2BxvC,KAAK4vC,aACxF1d,EAAanxB,GAA8B,MAAnBA,EAAQ2vC,QAAkB3vC,EAAQ2vC,QAAUve,cAAYC,QAChF0B,EAAc8M,cAAY/zB,KAAM4jC,EAAK,CAC1ChkC,aACAylB,cAEKye,EAAS3wC,KAAK2vC,GAEpB,IAAK,IAAMnrB,KADX2rB,EAAQnwC,KAAKowC,GAAS,GACHO,EAClBR,EAAO3rB,GAAS,IAAI5X,UAASknB,EAAa6c,EAAQnsB,IAGpD,OAAO2rB,SCpGT,SAAYZ,GACXA,iBACAA,mBACAA,qBACAA,uBAJD,CAAYA,KAAAA,QAOZ,ICfYqB,iBDeZ,cAyEA,OAxEQC,SAAP,SACChwC,EACAirB,EACAgC,EAAiB8F,EACjB/G,EAAuBikB,EACvBxuC,GAEA,IAAMF,EAAQvB,EAAOuB,MACfyD,EAAShF,EAAOgF,OAClBP,EAAI,EACJC,EAAI,EACR,OAAQjD,GACR,KAAKitC,GAAgBhkC,MACpBjG,EAAIwmB,EAAOtnB,KAAOpC,EAAQ0rB,GAClB,GAEHjB,GADJvnB,EAAIwmB,EAAOpnB,MAAQopB,GACK1rB,IACvBkD,EAAI,GAGNC,EAAIvF,KAAK+wC,OAAQjlB,EAAOrnB,IAAKoB,EAAQirC,GACrC,MACD,KAAKvB,GAAgBpkC,IACpB7F,EAAItF,KAAK+wC,OAAQjlB,EAAOtnB,KAAMpC,EAAOyqB,IACrCtnB,EAAIumB,EAAOrnB,IAAMoB,EAAS+tB,GAClB,GAEHkd,GADJvrC,EAAIumB,EAAOnnB,OAASivB,GACK/tB,IACxBN,EAAI,GAGN,MACD,KAAKgqC,GAAgB9jC,MAEhBohB,GADJvnB,EAAIwmB,EAAOpnB,MAAQopB,GACK1rB,IACvBkD,EAAIwmB,EAAOtnB,KAAOpC,EAAQ0rB,GAClB,IACPxoB,EAAIunB,EAAgBzqB,GAGtBmD,EAAIvF,KAAK+wC,OAAQjlB,EAAOrnB,IAAKoB,EAAQirC,GACrC,MACD,KAAKvB,GAAgBlkC,OACpB/F,EAAItF,KAAK+wC,OAAQjlB,EAAOtnB,KAAMpC,EAAOyqB,GAEjCikB,GADJvrC,EAAIumB,EAAOnnB,OAASivB,GACK/tB,IACxBN,EAAIumB,EAAOrnB,IAAMoB,EAAS+tB,GAClB,IACPruB,EAAIurC,EAAiBjrC,GAKxBhF,EAAOgc,SAASrX,IAAKF,EAAGC,IAGlBsrC,SAAP,SAAeh0B,EAAkB1Q,EAAc6kC,GAC9C,OAAIn0B,EAAW,EACVm0B,EAAen0B,EAAW1Q,EACE,IAAvB6kC,EAAe7kC,GAEhB,EAEE6kC,EAAen0B,EAAW1Q,EAChC6kC,EAAe7kC,EACa,IAAvB6kC,EAAe7kC,GAEhB6kC,EAAe7kC,EAGjB0Q,sBE/ET,cAiBA,OAdQo0B,QAAP,SAAcpwC,EAAyBgf,GAAvC,WACChf,EAAOsM,GAAI2Q,EAAiB4B,MAAM,SAAEzJ,GACnC,GAAIA,EAAEpV,SAAWA,EAAS,CACzB,IAAMoE,EAAQkB,EAAKlB,MACnBA,EAAMQ,SAAUwQ,EAAEnP,KAAKqY,QACvBte,EAAOqwC,QAASjsC,OAAOvD,EAAWuD,GAAO,GACzC,IAAMK,EAAIL,EAAMK,EACVC,EAAIN,EAAMM,GACZD,EAAI,GAAKC,EAAI,GAAK1E,EAAOuB,MAAQkD,GAAKzE,EAAOgF,OAASN,IACzDsa,EAAS5J,QAXIg7B,QAAQ,IAAIzkB,4BCL7B,aAAA,MACCxmB,mBAEMmS,EAAUP,SAASC,YACzBM,EAAQL,iBAAkB,QAAQ,SAAE7B,GAC/BA,EAAEpV,SAAWsX,IAChBlC,EAAEgC,iBACFhC,EAAEk7B,kBACFhrC,EAAK8M,KAAM,OAAQ9M,EAAKirC,gBAAiBn7B,QAI3CkC,EAAQL,iBAAkB,OAAO,SAAE7B,GAC9BA,EAAEpV,SAAWsX,IAChBlC,EAAEgC,iBACFhC,EAAEk7B,kBACFhrC,EAAK8M,KAAM,MAAO9M,EAAKirC,gBAAiBn7B,QAI1CkC,EAAQL,iBAAkB,SAAS,SAAE7B,GAChCA,EAAEpV,SAAWsX,IAChBlC,EAAEgC,iBACFhC,EAAEk7B,kBACFhrC,EAAK8M,KAAM,QAAS9M,EAAKirC,gBAAiBn7B,UA4B9C,OArDmCnW,OA8BlCuxC,4BAAA,SAAiBp7B,GAChB,OAAOA,EAAEq7B,eAAkBvwB,OAAeuwB,eAGpCD,OAAP,SAAa1kB,GACZ,GAAI4kB,UAAUC,UACbD,UAAUC,UAAUC,UAAW9kB,OACzB,CACN,IAAM+kB,EAAW95B,SAAS0Z,cAAe,YACzCogB,EAAS9a,MAAQjK,EACjB/U,SAASC,KAAK85B,YAAaD,GAC3BA,EAASE,QACTF,EAAS/8B,SAET,IACCiD,SAASi6B,YAAa,QACrB,MAAQ57B,IAIV2B,SAASC,KAAK6kB,YAAagV,QAlDKv9B,QAAMC,4BCIxC,WAAagL,EAAYE,EAAYwyB,EAAYC,GAChD/xC,KAAKof,GAAKA,EACVpf,KAAKsf,GAAKA,EACVtf,KAAK8xC,GAAKA,EACV9xC,KAAK+xC,GAAKA,EASZ,OANCC,gBAAA,SAAK5yB,EAAYE,EAAYwyB,EAAYC,GACxC/xC,KAAKof,GAAKA,EACVpf,KAAKsf,GAAKA,EACVtf,KAAK8xC,GAAKA,EACV9xC,KAAK+xC,GAAKA,sBCjBZ,cAYA,OAXQE,SAAP,SAAe7oC,GACd,OAAOA,GAGD6oC,UAAP,SAAgB7oC,GACf,OAAOA,GAAM,GAAK,EAAIA,IAAM,EAAIA,GAAKA,GAAM,GAAK,EAAIA,GAAKA,KAGnD6oC,cAAP,SAAoB7oC,GACnB,OAAOA,EAAI,GAAM,EAAIA,EAAIA,GAAW,EAAI,EAAIA,GAAMA,EAApB,uBCQ/B,WAAarI,GAAb,MACCiF,0BAEAG,EAAK0oB,GAAM,KACX1oB,EAAK+rC,GAAU,KACf/rC,EAAKgsC,GAAa,EAClBhsC,EAAKisC,GAAyB,MAAXrxC,GAAuC,MAApBA,EAAQsxC,SAAmBtxC,EAAQsxC,SAAW,IACpFlsC,EAAKmsC,GAAmB,EAAIrmC,KAAKC,IAAK,EAAG/F,EAAKisC,IAC9CjsC,EAAKosC,IAAW,EAChBpsC,EAAKqsC,GAAuB,MAAXzxC,EAAkBA,EAAQ0xC,YAAS/wC,EACpDyE,EAAKusC,GAAmB,WACvBvsC,EAAKwsC,cAENxsC,EAAKysC,GAAwB,MAAX7xC,EAAkBA,EAAQ8xC,aAAUnxC,EACtDyE,EAAK2sC,GAAsB,MAAX/xC,EAAkBA,EAAQgyC,WAAQrxC,EAClDyE,EAAK6sC,GAAuB,MAAXjyC,GAAqC,MAAlBA,EAAQkyC,OAAiBlyC,EAAQkyC,OAAShB,GAAkBiB,UAwHlG,OApJoCpzC,OA+BnCN,sBAAI2zC,0BAAJ,WACC,OAAOnzC,KAAKkyC,QAGb,SAAYrxC,GACXb,KAAKkyC,GAAUrxC,mCAGhBrB,sBAAI2zC,4BAAJ,WACC,OAAOnzC,KAAKoyC,QAGb,SAAcC,GACbryC,KAAKoyC,GAAYC,EACjBryC,KAAKsyC,GAAmB,EAAIrmC,KAAKC,IAAK,EAAGmmC,oCAG1Cc,kBAAA,SAAOC,gBAAAA,MACNpzC,KAAKqzC,OACLrzC,KAAKmyC,GAAapE,KAAKuF,MACvBtzC,KAAKuyC,GAAWa,EAChBpzC,KAAK6uB,GAAM9N,OAAOC,WAAYhhB,KAAK0yC,GAAkB,GAGrD1yC,KAAK6yC,QAASO,GAGd,IAAMf,EAAWryC,KAAKoyC,GAChBmB,EAAOvzC,KAAKwzC,OAAQJ,EAAUf,EAAW,GAC/CryC,KAAKyyC,OAAQc,EAAMH,EAAS,IAGnBD,oBAAV,SAAmBM,GAClB,IAAMZ,EAAU7yC,KAAK4yC,GACN,MAAXC,GACHA,EAASY,EAAWzzC,MAErBA,KAAKiT,KAAM,QAASwgC,EAAWzzC,OAGtBmzC,mBAAV,SAAkBI,EAAcE,EAAoBC,GACnD,IAAMjB,EAASzyC,KAAKwyC,GACN,MAAVC,GACHA,EAAQc,EAAME,EAAWC,EAAa1zC,MAEvCA,KAAKiT,KAAM,OAAQsgC,EAAME,EAAWC,EAAa1zC,OAGxCmzC,kBAAV,SAAiBM,GAChB,IAAMV,EAAQ/yC,KAAK8yC,GACN,MAATC,GACHA,EAAOU,EAAWzzC,MAEnBA,KAAKiT,KAAM,MAAOwgC,EAAWzzC,OAG9BmzC,sBAAA,WACC,OAAoB,MAAZnzC,KAAK6uB,IAGdskB,sBAAA,WACC,OAAOnzC,KAAKuyC,IAGHY,uBAAV,WAEC,GAAU,MADCnzC,KAAK6uB,GACC,CAChB7uB,KAAK6uB,GAAM,KACX,IAAM6kB,EAAc3F,KAAKuF,MAAQtzC,KAAKmyC,GAChCE,EAAWryC,KAAKoyC,GAChBgB,EAAUpzC,KAAKuyC,GACrB,GAAImB,EAAcrB,EAAW,CAC5BryC,KAAK6uB,GAAM9N,OAAOC,WAAYhhB,KAAK0yC,GAAkB,GAGrD,IAAMa,EAAOvzC,KAAKwzC,OAAQJ,EAAUf,EAAWqB,EAAcA,GAC7D1zC,KAAKyyC,OAAQc,EAAMH,EAASM,QAGtBH,EAAOvzC,KAAKwzC,OAAQJ,EAAU,EAAIf,GACxCryC,KAAKyyC,OAAQc,EAAMH,EAASM,GAG5B1zC,KAAK+yC,MAAOK,KAKLD,mBAAV,SAAkBO,GACjB,OAAO1zC,KAAKgzC,GAASU,EAAc1zC,KAAKsyC,GAAkBtyC,OAG3DmzC,iBAAA,WACC,IAAMtiB,EAAK7wB,KAAK6uB,GACN,MAANgC,IACH7wB,KAAK6uB,GAAM,KACX9N,OAAOX,aAAcyQ,KAIvBsiB,gBAAA,WACC,IAAMtiB,EAAK7wB,KAAK6uB,GAChB,GAAU,MAANgC,EAAa,CAChB7wB,KAAK6uB,GAAM,KACX9N,OAAOX,aAAcyQ,GAGrB,IAAMuiB,EAAUpzC,KAAKuyC,GACfmB,EAAc3F,KAAKuF,MAAQtzC,KAAKmyC,GAChCE,EAAWryC,KAAKoyC,GAChBmB,EAAOvzC,KAAKwzC,OAAQJ,EAAU,EAAIf,GACxCryC,KAAKyyC,OAAQc,EAAMH,EAASM,GAG5B1zC,KAAK+yC,MAAOK,QAjJqBj/B,QAAMC,4BCyBzC,WAAarT,GAAb,WACCf,KAAK2zC,GAAa,GAClB3zC,KAAK4zC,GAAmB,GACxB5zC,KAAK6zC,GAAgB,EACrB7zC,KAAK8zC,IAAe,EACpB9zC,KAAK+zC,GAAM,EACX/zC,KAAKg0C,GAAM,EACXh0C,KAAKi0C,GAAM,EACXj0C,KAAKk0C,GAAM,EACXl0C,KAAKm0C,GAAa,IAAIhB,GAAe,CACpCV,OAAQ,SAAErpC,GACTjD,EAAKiuC,OAAQhrC,IAEd6pC,OAAQhB,GAAkBoC,OAC1BhC,SAAU,MAEX,IAAMA,EAAWtxC,GAAWA,EAAQsxC,SAChCA,GACHryC,KAAKs0C,GAA2C,MAArBjC,EAASx1B,SAAmBw1B,EAASx1B,SAAW,EAC3E7c,KAAKu0C,GAAqC,MAAlBlC,EAASpwB,MAAgBowB,EAASpwB,MAAQ,IAElEjiB,KAAKs0C,GAAoB,EACzBt0C,KAAKu0C,GAAiB,GAEvBv0C,KAAKw0C,GAAUzzC,EAAQoM,GAAGyT,KAgI5B,OA7HC6zB,oBAAA,WAGC,IADA,IAAMC,EAAY10C,KAAK2zC,GACd//B,EAAI8gC,EAAU/hC,OAAQoB,EAAO0gC,EAAeE,iBAAkB/gC,EAAIG,IAAQH,EAClF8gC,EAAU9hC,KAAM,IAAIo/B,GAAuB,EAAG,EAAG,EAAG,IAErDhyC,KAAK6zC,GAAgB,EACrB7zC,KAAK8zC,IAAe,EAGpB9zC,KAAKm0C,GAAWd,QAGjBoB,mBAAA,SAAQr1B,EAAYE,EAAYwyB,EAAYC,GAC3C,IAAM6C,EAAWH,EAAeE,iBAE1BE,EAAgB70C,KAAK8zC,GACrBgB,GAAiBD,EAAgB,GAAKD,EAC5C50C,KAAK8zC,GAAcgB,EAEnB,IAAMC,EAAkB/0C,KAAK6zC,IACzBiB,EAAgBD,GAAkB,GAAKA,GAAiBA,EAAgBE,KAC3E/0C,KAAK6zC,IAAiBkB,EAAkB,GAAKH,GAG9C50C,KAAK2zC,GAAYmB,GAAgBtvC,IAAK4Z,EAAIE,EAAIwyB,EAAIC,IAGzC0C,kCAAV,SAAiC1C,GAChC,IAAMiD,EAAWh1C,KAAK2zC,GAChBsB,EAASj1C,KAAK4zC,GACd5K,EAAQhpC,KAAK6zC,GACb3K,EAAMlpC,KAAK8zC,GACXnhC,EAASqiC,EAASriC,OAExB,GAAIu2B,EAAM,EAET,OADA+L,EAAOtiC,OAAS,EACTo/B,EACD,GAAI7I,EAAMF,EAAQ,CACxB,IAAIkM,EAAQnD,EACZkD,EAAOtiC,OAAS,EAChB,IAAK,IAAIiB,EAAIs1B,EAAK,GAAKt1B,IAAKA,EAAI,CAC/B,IAAMuhC,EAAUH,EAAUphC,GAC1B,KAAIshC,EAAQC,EAAQpD,GATJ,KAaf,OAAOmD,EAHPA,GAASC,EAAQpD,GACjBkD,EAAOriC,KAAMuiC,GAMf,IAASvhC,EAAIjB,EAAS,EAAGq2B,GAASp1B,IAAKA,EAAI,CAC1C,IAAMwhC,EAAUJ,EAAUphC,GAC1B,KAAIshC,EAAQE,EAAQrD,GAnBJ,KAuBf,OAAOmD,EAHPA,GAASE,EAAQrD,GACjBkD,EAAOriC,KAAMwiC,GAKf,OAAOF,EAIP,IAFIA,EAAQnD,EACZkD,EAAOtiC,OAAS,EACPiB,EAAIs1B,EAAKF,GAASp1B,IAAKA,EAAI,CACnC,IAAMyhC,EAAUL,EAAUphC,GAC1B,KAAIshC,EAAQG,EAAQtD,GAhCJ,KAoCf,OAAOmD,EAHPA,GAASG,EAAQtD,GACjBkD,EAAOriC,KAAMyiC,GAKf,OAAOH,GAITT,kBAAA,SAAOa,GACN,IAAMC,EAAMv1C,KAAKw1C,sBAAuBF,GAClCL,EAASj1C,KAAK4zC,GACd6B,EAAeR,EAAOtiC,OAC5B,GAAI,EAAI8iC,EAAe,CAKtB,IAJA,IAAIr2B,EAAK,EACLE,EAAK,EACLwyB,EAAK,EACLC,EAAK,EACAn+B,EAAI,EAAGA,EAAI6hC,IAAgB7hC,EAAI,CACvC,IAAM8hC,EAAUT,EAAQrhC,GACxBwL,GAAMs2B,EAAQt2B,GACdE,GAAMo2B,EAAQp2B,GACdwyB,GAAM4D,EAAQ5D,GACdC,GAAM2D,EAAQ3D,GAEf,IAAM1oC,GAAK,EAAIisC,EAAMC,GAAOE,EAC5Br2B,GAAM/V,EACNiW,GAAMjW,EACNyoC,EAAK,GAAKA,EAAK2D,GAAgBpsC,EAC/B0oC,GAAM1oC,EACNrJ,KAAK+zC,GAAM30B,EACXpf,KAAKg0C,GAAM10B,EACXtf,KAAKi0C,GAAMnC,EACX9xC,KAAKk0C,GAAMnC,EAGX,IAAM4D,EAA8B,GAAzB31C,KAAKs0C,GAAyBroC,KAAK0nB,KAAMvU,EAAKA,EAAKE,EAAKA,GAC7Ds2B,EAA2B,IAAtB51C,KAAKu0C,GAAyBtoC,KAAKoT,IAAKyyB,EAAK,GAClD+D,EAAY71C,KAAKm0C,GACvB0B,EAAUxD,SAAWpmC,KAAKC,IAAKypC,EAAIC,GACnCC,EAAUC,UAIFrB,mBAAV,SAAkBlB,GACjB,IAAMlqC,EAAI,EAAIkqC,EACdvzC,KAAKw0C,GACJx0C,KAAK+zC,GAAM1qC,EACXrJ,KAAKg0C,GAAM3qC,EACX,GAAMrJ,KAAKi0C,GAAM,GAAM5qC,EACvBkqC,IAIFkB,iBAAA,WACCz0C,KAAKm0C,GAAWd,QApKAoB,mBAAmB,QNhBrC,SAAY7D,GACXA,mBACAA,mBACAA,qBACAA,iBAEAA,iBACAA,gBAEAA,4BATD,CAAYA,KAAAA,QOKZ,ICHYmF,iBDGZ,cAeA,OAdQC,OAAP,SAAa//B,GACZ,IAAMggC,EAAO,SAAUhgC,EAAIA,EAAEnP,KAAKga,cAAgB7K,EAClD,OAASggC,EAAG7/B,QAAUw6B,GAAesF,KAAOtF,GAAe3sB,OACxDgyB,EAAGl+B,OAAS64B,GAAeuF,IAAMvF,GAAe3sB,OAChDgyB,EAAG5/B,SAAWu6B,GAAewF,MAAQxF,GAAe3sB,OAGjD+xB,QAAP,SAAc//B,EAAwB03B,GACrC,OAAIA,EAAWiD,GAAeyF,MAClBr2C,KAAK6M,KAAMoJ,GAAM03B,GAErB3tC,KAAK6M,KAAMoJ,KAAQ03B,QEgBvB2I,GAAkB,SACvBv1C,EACAghB,GAEA,GAAe,MAAXhhB,IAA+B,IAAZA,EACtB,MAAO,CACNoM,GAAI,CACHyT,KAAMmB,IAIR,IAAMswB,EAAWtxC,EAAQsxC,SACzB,OAAIrvC,EAAcqvC,GACV,CACNA,SAAU,CACTx1B,SAAUw1B,EACVpwB,MAAOowB,GAERllC,GAAI,CACHyT,KAAMmB,IAID,CACNswB,WACAllC,GAAI,CACHyT,KAAMmB,mBA2BV,WAAahhB,GAAb,WACOF,EAASb,KAAKkyC,GAAUnxC,EAAQF,OAChCsM,EAAKpM,EAAQoM,GACfA,IACHnN,KAAK4yC,GAAWzlC,EAAG2oC,MACnB91C,KAAKw0C,GAAUrnC,EAAGyT,KAClB5gB,KAAK8yC,GAAS3lC,EAAG+7B,KAElBlpC,KAAKu2C,GAAYx1C,GAAWA,EAAQ4sC,UAAYiD,GAAe3sB,KAC/DjkB,KAAKw2C,GAAsBn2C,EAAcK,cAAc8J,SAASwT,QAAQC,YACxEje,KAAKy2C,GAAU,IAAIjqB,QACnBxsB,KAAKgiB,GAAS,EACdhiB,KAAK02C,GAAiB,IAAIlqB,QAC1BxsB,KAAK22C,GAAQ,EAEb,IAAMC,EAAS71C,EAAQ61C,OACT,MAAVA,IAA6B,IAAXA,IAIrB52C,KAAK62C,GAAU,IAAIpC,GAAgB6B,GAAiBM,GAH1B,SAAEx3B,EAAYE,EAAYwyB,EAAYyB,GAC/DptC,EAAK2wC,aAAc13B,EAAIE,EAAIwyB,EAAIyB,QAKjCvzC,KAAK+2C,GAAe,SAAE9gC,GACrB9P,EAAKmf,OAAQrP,IAGdjW,KAAKg3C,GAAe,SAAE/gC,GACrB9P,EAAK4b,OAAQ9L,IAGdjW,KAAKi3C,GAAc,SAAEhhC,GACpB9P,EAAK4sC,MAAO98B,IAGTlV,EAAQqd,OACXpe,KAAKk3C,GAAQ,aACbl3C,KAAKm3C,GAAQ,YACbn3C,KAAKo3C,GAAM,aAEXp3C,KAAKk3C,GAAQp5B,EAAiB4B,KAC9B1f,KAAKm3C,GAAQr5B,EAAiB8C,KAC9B5gB,KAAKo3C,GAAMt5B,EAAiBmB,IAG7Bpe,EAAOsM,GAAInN,KAAKk3C,GAAOl3C,KAAK+2C,IAyK9B,OAtKWM,+BAAV,SAA8BphC,EAAqBqhC,GAClD,IAAMrB,EAAKhgC,EAAEnP,KAAKga,cACZ3B,EAASlJ,EAAEnP,KAAKqY,OACtB,GAAI,YAAa82B,EAAK,CACrB,IAAM/3B,EAAU+3B,EAAG/3B,QACbq5B,EAAgBr5B,EAAQvL,OAC9B,GAAI,EAAI4kC,EAAgB,CAKvB,IAHA,IAAMC,EAAQt5B,EAAS,GACnBu5B,EAAUD,EAAMl5B,QAChBo5B,EAAUF,EAAMj5B,QACX3K,EAAI,EAAGG,EAAOmK,EAAQvL,OAAQiB,EAAIG,IAAQH,EAElD6jC,IADMr5B,EAAQF,EAAStK,IACN0K,QACjBo5B,GAAWt5B,EAAMG,QAMlB,GAJAk5B,GAAWF,EACXG,GAAWH,EACXv3C,KAAKw2C,GAAoBn4B,mBAAoBi5B,EAAQG,EAASC,GAE1D,EAAIH,EAAgB,CAEvB,IAAII,EAAiB,EACrB,IAAS/jC,EAAI,EAAGG,EAAOmK,EAAQvL,OAAQiB,EAAIG,IAAQH,EAAI,CACtD,IAAMwK,EACAgB,GADAhB,EAAQF,EAAStK,IACN0K,QAAUm5B,EACrBn4B,EAAKlB,EAAMG,QAAUm5B,EAC3BC,EAAiB1rC,KAAKC,IAAKyrC,EAAgBv4B,EAAKA,EAAKE,EAAKA,GAE3D,OAAOrT,KAAK0nB,KAAMgkB,GAElB,OAAO,GAKV,OADAL,EAAO7xC,SAAU0Z,GACV,GAGEk4B,mBAAV,SAAkBphC,GACjB,GAAI+/B,GAAgB4B,MAAO3hC,EAAGjW,KAAKu2C,IAAc,CAChDtgC,EAAEk7B,kBAGF,IAAMmG,EAASt3C,KAAKy2C,GACpBz2C,KAAKgiB,GAAShiB,KAAK63C,mBAAoB5hC,EAAGqhC,GAG1C,IAAMz2C,EAASb,KAAKkyC,GACpB,IAAMrxC,EAAOqnB,aAAe,CAC3BrnB,EAAOi3C,aAAa,GAGpB93C,KAAK22C,GAAQ1gC,EAAEnP,KAAKga,cAAcQ,UAGlC,IAAMs1B,EAAS52C,KAAK62C,GAChBD,GACHA,EAAO/D,UAIR,IAAMA,EAAU7yC,KAAK4yC,GACN,MAAXC,GACHA,IAID,IAAM90B,EAAqB/d,KAAKw2C,GAChCz4B,EAAmB5Q,GAAInN,KAAKm3C,GAAOn3C,KAAKg3C,IACxCj5B,EAAmB5Q,GAAInN,KAAKo3C,GAAKp3C,KAAKi3C,OAK/BI,mBAAV,SAAkBphC,GACjB,GAAI+/B,GAAgB4B,MAAO3hC,EAAGjW,KAAKu2C,KACnBv2C,KAAKkyC,GACThqB,aAAe,CAEzB,IAAMovB,EAASt3C,KAAKy2C,GACdgB,EAAUH,EAAOhyC,EACjBoyC,EAAUJ,EAAO/xC,EACjBuwB,EAAW91B,KAAK63C,mBAAoB5hC,EAAGqhC,GACvCS,EAAW/3C,KAAKgiB,GACtBhiB,KAAKgiB,GAAS8T,EACd,IAAMkiB,EAAUh4C,KAAK22C,GACfsB,EAAUhiC,EAAEnP,KAAKga,cAAcQ,UACrCthB,KAAK22C,GAAQsB,EAGb,IAAM74B,EAAKk4B,EAAOhyC,EAAImyC,EAChBn4B,EAAKg4B,EAAO/xC,EAAImyC,EAChB3F,EAAKkG,EAAUD,EACflG,EAAOuF,EAASa,QAAUH,EAAWjiB,EAAWiiB,EAAW,EAG3DnB,EAAS52C,KAAK62C,GAChBD,GACHA,EAAO70B,OAAQ3C,EAAIE,EAAIwyB,EAAIC,GAI5B,IAAMhwB,EAAS/hB,KAAKw0C,GACN,MAAVzyB,IACQ,IAAP3C,GAAmB,IAAPE,GAAmB,IAAPwyB,GAC3B/vB,EAAQ3C,EAAIE,EAAIg4B,EAAOhyC,EAAGgyC,EAAO/xC,EAAGusC,MAO/BuF,kBAAV,SAAiBphC,GAChB,IAAMpV,EAASb,KAAKkyC,GACpB,GAAIrxC,EAAOqnB,aAAe,CAEzB,IAAMovB,EAASt3C,KAAKy2C,GACpBz2C,KAAK02C,GAAejxC,SAAU6xC,GAC9Bt3C,KAAKgiB,GAAShiB,KAAK63C,mBAAoB5hC,EAAGqhC,GAG1C,IAAMrB,EAAKhgC,EAAEnP,KAAKga,cAClB,KAAI,YAAam1B,IAAKA,EAAG/3B,QAAQvL,QAAU,EAAW,CACrD9R,EAAOi3C,aAAa,GAGpB,IAAM/5B,EAAqB/d,KAAKw2C,GAChCz4B,EAAmBe,IAAK9e,KAAKm3C,GAAOn3C,KAAKg3C,IACzCj5B,EAAmBe,IAAK9e,KAAKo3C,GAAKp3C,KAAKi3C,IAGvC,IAAMlE,EAAQ/yC,KAAK8yC,GACN,MAATC,GACHA,IAID,IAAM6D,EAAS52C,KAAK62C,GAChBD,GACHA,EAAO7D,MAAO98B,EAAEnP,KAAKga,cAAcQ,UAAYthB,KAAK22C,OAM9CU,yBAAV,SAAwBj4B,EAAYE,EAAYwyB,EAAYyB,GAC3D,IAAMxxB,EAAS/hB,KAAKw0C,GACpB,GAAc,MAAVzyB,IACQ,IAAP3C,GAAmB,IAAPE,GAAmB,IAAPwyB,GAAW,CACtC,IAAMqG,EAAgBn4C,KAAK02C,GAC3ByB,EAAc3yC,IACb2yC,EAAc7yC,EAAI8Z,EAClB+4B,EAAc5yC,EAAI+Z,GAEnByC,EAAQ3C,EAAIE,EAAI64B,EAAc7yC,EAAG6yC,EAAc5yC,EAAGusC,KAKrDuF,iBAAA,WACC,IAAMT,EAAS52C,KAAK62C,GAChBD,GACHA,EAAOvD,QAtOQgE,UAAU,wBC/D5B,cA6EA,OA5EQe,YAAP,SACCv3C,EAAe4L,EACf0W,EAAiBk1B,GAEjB,IAAM93C,EAAS+3C,KAAKC,cAAcp4C,OAAO,CACxCiC,MAAOvB,EAAOuB,MACdyD,OAAQhF,EAAOgF,OACfqsB,UAAWomB,KAAKnmB,YAAYkiB,OAC5B5nC,eAEK+rC,EAAS,IAAIF,KAAKG,YACvB/2C,OAAWA,OAAWA,OAAWA,GAChCb,EAAOgc,SAASvX,GAAIzE,EAAOgc,SAAStX,GAGtC,OADAlF,EAAcK,cAAc8J,SAAS8gB,OAAQzqB,EAAQN,EAAQ4iB,EAAOq1B,EAAQH,GACrE93C,GAGD63C,WAAP,SAAiBM,GAChB,IAAMjsC,EAAaisC,EAAcjsC,WAC3BszB,EAAQ2Y,EAAc3Y,MACtB39B,EAAQ6J,KAAKihC,MAAOnN,EAAM39B,MAAQqK,GAClC5G,EAASoG,KAAKihC,MAAOnN,EAAMl6B,OAAS4G,GACpCksC,EAAS,IAAIC,WAAY,EAAIx2C,EAAQyD,GAErC2E,EAAWnK,EAAcK,cAAc8J,SAC7CA,EAASkuC,cAAchnC,KAAMgnC,GAC7B,IAAMtV,EAAM54B,EAAiB44B,GAW7B,OAVAA,EAAGyV,WACF9Y,EAAMz6B,EAAImH,EACVszB,EAAMx6B,EAAIkH,EACVrK,EACAyD,EACAu9B,EAAGoC,KACHpC,EAAGqC,cACHkT,GAGM,CACNv2C,QACAyD,SACA0B,MAAOoxC,IAIFP,WAAP,SAAiBO,EAA6B12B,EAAgB62B,GAC7D,IAAM12C,EAAQu2C,EAAOv2C,MACfyD,EAAS8yC,EAAO9yC,OAChB0B,EAAQoxC,EAAOpxC,MACfwxC,EAAqB,IAAIT,KAAKnkC,MAAM6kC,mBAAoB52C,EAAOyD,EAAQ,GAEvEozC,EAAYF,EAAmBlmB,QAAQqmB,aAAc,EAAG,EAAG92C,EAAOyD,GASxE,GARIizC,EACHG,EAAUnyC,KAAKtB,IAAK+B,GAEnB+wC,KAAKa,QAAQC,QAAgBC,gBAAiB9xC,EAAO0xC,EAAUnyC,MAEjEiyC,EAAmBlmB,QAAQymB,aAAcL,EAAW,EAAG,GAG1C,MAATh3B,GAA2B,IAAVA,EAAc,CAClC82B,EAAmBlmB,QAAQ5Q,MAAOA,EAAOA,GACzC82B,EAAmBlmB,QAAQwN,UAAW0Y,EAAmBhmB,OAAQ,EAAG,GACpE,IAAMwmB,EAActtC,KAAKihC,MAAO9qC,EAAQ6f,GAClCu3B,EAAevtC,KAAKihC,MAAOrnC,EAASoc,GACpCw3B,EAAkBV,EAAmBlmB,QAAQqmB,aAAc,EAAG,EAAGK,EAAaC,GACpFT,EAAmBhvB,OAAQwvB,EAAaC,GACxCT,EAAmBlmB,QAAQymB,aAAcG,EAAiB,EAAG,GAG9D,OAAOV,EAAmBhmB,QAGpBqlB,WAAP,SAAiBrlB,EAA2B8Y,EAAiB6N,GAC5D,OAAO3mB,EAAO4mB,UAAW9N,EAAQ6N,uBC/EnC,cAwBA,OAvBQE,cAAP,SAAoBC,EAAkBpJ,GACrC,IAAMjjB,EAAI5V,SAAS0Z,cAAe,KAClC9D,EAAEssB,KAAOrJ,EACTjjB,EAAEusB,SAAWF,EACbrsB,EAAEgI,MAAMwkB,QAAU,OAClBpiC,SAASC,KAAK85B,YAAankB,GAC3BA,EAAEysB,QACFj5B,YAAW,WACVpJ,SAASC,KAAK6kB,YAAalP,KACzB,MAGGosB,WAAP,SAAiBC,EAAkBK,GAClC,IAAMC,EAAO,IAAIC,KAChB,CAAEF,GACF,CAAEv/B,KAAM,eAELoG,OAAOwwB,UAAU8I,WACpBt5B,OAAOwwB,UAAU8I,WAAYF,EAAMN,GAEnC75C,KAAKs6C,YAAaT,EAAUU,IAAIC,gBAAiBL,wBCiDpD,cA0BA,OAzBQM,UAAP,SAAgB15C,GACf,IAAMF,EAASE,EAAQF,OACjB4L,EA5Ba,SAAE1L,GACtB,IAAMF,EAASE,EAAQF,OACvB,OAA+B,MAAtBE,EAAQ0L,WACdzJ,EAAcjC,EAAQ0L,YACvB1L,EAAQ0L,WACRR,KAAK0iB,IAAK,EAAG5tB,EAAQ0L,WAAWN,KAAOF,KAAKC,IAAKrL,EAAOuB,MAAOvB,EAAOgF,SACnEyyC,KAAK5rC,SAASC,WAsBC+tC,CAAc35C,GAC3Bs3C,EAjCsB,SAAEt3C,GAC/B,OAAOA,EAAQ8gB,WAAa9gB,EAAQ8gB,UAAUlhB,OAgCjBg6C,CAAuB55C,GACnD,OAAOq3C,GAAcwC,UAAW/5C,EAAQ4L,EAAY1L,EAAQoiB,MAAOk1B,IAG7DoC,SAAP,SAAe15C,GACd,OAAOq3C,GAAcyC,SAAU76C,KAAK4F,QAAS7E,KAGvC05C,SAAP,SAAe15C,GACd,IAAM43C,EAAS34C,KAAK24C,OAAQ53C,GACtB+3C,EA7B2B,SAAE/3C,GACpC,OAASA,EAAQQ,OAASR,EAAQQ,MAAMu5C,eAAiB/5C,EAAQQ,MAAMu5C,cAAcC,OA4BpDC,CAA4Bj6C,GACtDkhB,EA1BQ,SAAE02B,EAA6B53C,GAC9C,GAAqB,MAAjBA,EAAQkhB,MAAgB,CAC3B,GAAIjf,EAAcjC,EAAQkhB,OACzB,OAAOlhB,EAAQkhB,MAEf,IAAM9V,EAAOpL,EAAQkhB,MAAM9V,KAC3B,OAAOF,KAAK0iB,IAAK,EAAGxiB,EAAOwsC,EAAOv2C,MAAO+J,EAAOwsC,EAAO9yC,SAoB1Co1C,CAAStC,EAAQ53C,GAC/B,OAAOq3C,GAAc8C,SAAUvC,EAAQ12B,EAAO62B,IAGxC2B,SAAP,SAAe15C,GACd,OAAOq3C,GAAc+C,SAAUn7C,KAAK+yB,OAAQhyB,GAAWA,EAAQ8qC,OAAQ9qC,EAAQ24C,UAGzEe,OAAP,SAAa15C,GACZ64C,GAAmBU,YAAav5C,EAAQ84C,SAAU75C,KAAKo7C,OAAQr6C,WJ5FjE,SAAYg1C,GACXA,mBACAA,2BACAA,qCACAA,mCAJD,CAAYA,KAAAA,QAWZ,IKEYsF,GAKAC,iBLFX,WAAaC,EAAgBC,GAC5Bx7C,KAAKy7C,GAAS,KACdz7C,KAAK07C,GAAMH,EACXv7C,KAAK27C,GAAUH,EA8EjB,OA3ECI,iBAAA,WACC,IAAMC,EAAQ77C,KAAK87C,mBACN,MAATD,EACHA,EAAM5B,QAENj6C,KAAK+7C,YAIGH,6BAAV,WAAA,WACC,GAAI,eAAgB76B,QAAyB,MAAf/gB,KAAKy7C,GAAiB,CACnD,IAAMO,EAAQh8C,KAAKy7C,GAAS7jC,SAAS0Z,cAAe,SACpD0qB,EAAMC,aAAc,OAAQ,QAC5BD,EAAMC,aAAc,QAAS,gBAC7BD,EAAMlkC,iBAAkB,UAAU,SAAE7B,GACnC9P,EAAK+1C,cAAeF,GACpBA,EAAMplB,MAAQ,GACd3gB,EAAE4C,2BACF5C,EAAEgC,oBAEH5X,EAAcK,cAAcinB,KAAKgqB,YAAaqK,GAE/C,OAAOh8C,KAAKy7C,IAGHG,0BAAV,SAAyBC,GAAzB,WACOM,EAAQN,EAAMM,MACpB,GAAa,MAATA,GAAiB,EAAIA,EAAMxpC,OAAS,CACvC,IAAMypC,EAAOD,EAAO,GACdE,EAAa,IAAIC,WAUvB,OATAD,EAAWjN,OAAS,SAAEn5B,GACrB,GAAgB,MAAZA,EAAEpV,OAAiB,CACtB,IAAMA,EAASoV,EAAEpV,OACjBsF,EAAKo2C,OAAQ17C,EAAON,UAGtB87C,EAAWG,QAAU,SAAEvmC,GACtB9P,EAAKs2C,SAAUxmC,IAERjW,KAAK07C,IACb,KAAK3F,GAAWlZ,KACfwf,EAAWK,WAAYN,GACvB,MACD,KAAKrG,GAAW4G,SACfN,EAAWO,cAAeR,GAC1B,MACD,KAAKrG,GAAW8G,cACfR,EAAWS,mBAAoBV,GAC/B,MACD,KAAKrG,GAAWgH,aACfV,EAAWW,kBAAmBZ,GAC9B,MACD,QACCC,EAAWK,WAAYN,SAIxBp8C,KAAK+7C,YAIGH,mBAAV,SAAkBr7C,GACjB,IAAMi7C,EAASx7C,KAAK27C,GACpBH,EAAOvoC,KAAM,OAAQ1S,EAAQi7C,IAGpBI,qBAAV,SAAoB3lC,GACnB,IAAMulC,EAASx7C,KAAK27C,GACpBH,EAAOvoC,KAAM,QAASgD,EAAGulC,IAGhBI,qBAAV,WACC,IAAMJ,EAASx7C,KAAK27C,GACpBH,EAAOvoC,KAAM,SAAUuoC,uBMjGzB,cAoEA,OAnEQyB,UAAP,SAAgB57C,GACf,IAAM8H,GAAa,SAAR9H,IAAqB,GAC1B67C,GAAa,MAAR77C,IAAqB,EAC1B9B,EAAa,IAAR8B,EAAoB,EAEzB6K,EAAMD,KAAKC,IAAK/C,EAAG+zC,EAAG39C,GAEtBoT,EAASzG,EADHD,KAAK0iB,IAAKxlB,EAAG+zC,EAAG39C,GAExB+J,EAAI,EAgBR,OAfI,EAAIqJ,IACHxJ,IAAM+C,EACT5C,EAAI,IAAO4zC,EAAI39C,GAAMoT,EACXuqC,IAAMhxC,EAChB5C,EAAI,IAAO/J,EAAI4J,GAAMwJ,EAAS,IACpBpT,IAAM2M,IAChB5C,EAAI,IAAOH,EAAI+zC,GAAMvqC,EAAS,KAE3BrJ,EAAI,IACPA,GAAK,MAMA,CAAEA,EAFGqJ,EAASzG,EAAQ,IACnBA,IAIJ+wC,QAAP,SAAc3zC,EAAWyQ,EAAWojC,GACnC,IACMxuB,EAAMwuB,EAAKpjC,EAAI,IAAOojC,EACtBxqC,EAFMwqC,EAESxuB,EAEjBxlB,EAAI,EACJ+zC,EAAI,EACJ39C,EAAI,EA+BR,OA9BI+J,GAAK,IACRH,EARWg0C,EASXD,EAAK5zC,EAAI,GAAMqJ,EAASgc,EACxBpvB,EAAIovB,GACMrlB,GAAK,KACfH,GAAM,IAAMG,GAAK,GAAMqJ,EAASgc,EAChCuuB,EAbWC,EAcX59C,EAAIovB,GACMrlB,GAAK,KACfH,EAAIwlB,EACJuuB,EAjBWC,EAkBX59C,GAAM+J,EAAI,KAAO,GAAMqJ,EAASgc,GACtBrlB,GAAK,KACfH,EAAIwlB,EACJuuB,GAAM,IAAM5zC,GAAK,GAAMqJ,EAASgc,EAChCpvB,EAtBW49C,GAuBD7zC,GAAK,KACfH,GAAMG,EAAI,KAAO,GAAMqJ,EAASgc,EAChCuuB,EAAIvuB,EACJpvB,EA1BW49C,IA4BXh0C,EA5BWg0C,EA6BXD,EAAIvuB,EACJpvB,GAAM,IAAM+J,GAAK,GAAMqJ,EAASgc,IAGjCxlB,EAAI8C,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,IAAKxlB,MAInB,IAHb+zC,EAAIjxC,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,IAAKuuB,MAGP,EAFrBjxC,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,IAAKpvB,UChErB69C,GAAc,SAAK71C,EAAYqvB,GAI3C,IAHA,IAAIymB,EAAK,EACLC,EAAK/1C,EAAMoL,OAAS,EAEjB0qC,GAAMC,GAAK,CACjB,IAAMC,EAAKF,GAAOC,EAAKD,GAAO,GACxB/0C,EAAKf,EAAOg2C,GAClB,GAAI3mB,EAAQtuB,EACXg1C,EAAKC,EAAK,MACJ,CAAA,KAAIj1C,EAAKsuB,GAGf,OAAO2mB,EAFPF,EAAKE,EAAK,GAMZ,OAAQ,GChBIC,GAAc79C,MAAM89C,kBAAc58C,GAC9C,MAAoD,mBAA7CrB,OAAOU,UAAU8B,SAASC,KAAMpB,ICD3B68C,GAAY,SAAE78C,GAC1B,OAAOA,GAAWA,iBCDnB,cAEA,OADQ88C,WAAW,gCCCnB,cA6CA,OA5CQC,SAAP,SAAev8C,GACd,OAAOoqC,GAASpqC,EAAMW,SAAU,IAAKiV,cAAe,EAAG,MAGjD2mC,WAAP,SAAiB1mC,GAChB,IAAM2mC,EAAU3mC,EAAKN,OAAOE,cAC5B,GAAuB,IAAnB+mC,EAAQlrC,OAAe,CAC1B,IAAMtR,EAAQy8C,OAAQ,KAAKD,GAC3B,GAAIx8C,GAAUA,EACb,OAAOA,EAGT,OAAO,MAGDu8C,UAAP,SAAgBz0C,EAAW+zC,EAAW39C,GACrC,OAAa,IAAJ4J,GAAa,KAAY,IAAJ+zC,GAAa,IAAW,IAAJ39C,EAAY,IAGxDq+C,QAAP,SAAcG,EAAgBC,EAAgB50C,GAC7C,IAAM60C,EAAOF,GAAU,GAAM,IACvBG,EAAOH,GAAU,EAAK,IACtBI,EAAqB,KAAL,EAATJ,GAEPvyC,EAAOwyC,GAAU,GAAM,IACvBI,EAAOJ,GAAU,EAAK,IACtB5yC,EAAqB,KAAL,EAAT4yC,GAEPK,EAAKpyC,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,EAAGvlB,IAC/Bk1C,EAAK,EAAID,EAKf,OAJWpyC,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,IAAMsvB,EAAKK,EAAK9yC,EAAK6yC,KAIzC,KAHHpyC,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,IAAMuvB,EAAKI,EAAKF,EAAKC,KAG5B,IAAW,EAF3BpyC,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,IAAMwvB,EAAKG,EAAKlzC,EAAKizC,MAKjDT,WAAP,SAAiBv8C,EAAek9C,GAC/B,OAAOv+C,KAAKw+C,MAAOn9C,EAAO,SAAUk9C,IAG9BX,SAAP,SAAev8C,EAAek9C,GAC7B,OAAOv+C,KAAKw+C,MAAOn9C,EAAO,EAAUk9C,uBC7CtC,cAOA,OANQE,SAAP,SAAep9C,EAAeE,GAI7B,MAAO,SAHKF,GAAS,GAAO,UAChBA,GAAS,EAAM,UACP,IAARA,OACkBE,0BCHhC,cAWA,OAVQm9C,YAAP,SAAkBjO,EAAahkC,EAAoBkyC,GAClD,IAAM/4C,EAAUgH,UAAQC,KAAM4jC,EAAK,CAClChkC,eAEK7G,EAAQkuB,YAAYrrB,MAGzBk2C,EAAQ/4C,GAFRA,EAAQga,KAAM,SAAU++B,SCRdC,GAAe,SAAEhoB,GAC7B,OAAkB,MAATA,EAAgBmT,OAAQnT,GAAU,kBCW3C,WAAa71B,GACZf,KAAKoyC,GAAyB,MAAXrxC,GAAuC,MAApBA,EAAQsxC,SAAmBtxC,EAAQsxC,SAAW,IACpFryC,KAAK6+C,GAAW,KAChB7+C,KAAK8+C,GAAc,EACnB9+C,KAAK++C,GAAY,KA4CnB,OAzCCC,iBAAA,SAAMnsC,EAA8B6uB,GAApC,WACOud,EAAWj/C,KAAK++C,GACN,MAAZE,GACH7+B,aAAc6+B,GAGf,IAAMjsC,EAAUhT,KAAK6+C,GACrB,GAAIhsC,IAASG,EAAU,CACtB,IAAMq/B,EAAWryC,KAAKoyC,GAChB8M,EAAal/C,KAAK8+C,GAClBxL,EAAMvF,KAAKuF,MACX6L,EAAaD,EAAa7M,EAAYiB,GAC3B,IAAb5R,GAAqByd,GAAa,EACrCn/C,KAAKW,OAAQ2yC,EAAKzgC,GAElB7S,KAAK++C,GAAYh+B,OAAOC,YAAW,WAClC7a,EAAKxF,OAAQotC,KAAKuF,MAAOzgC,KACvBssC,KAKIH,mBAAV,SAAkB1L,EAAazgC,GAC9B,IAAMG,EAAUhT,KAAK6+C,GACjB7rC,IAAYH,IACf7S,KAAK8+C,GAAcxL,EAEH,OAAZtgC,GACHA,EAAQosC,OAGTp/C,KAAK6+C,GAAWhsC,EACJ,MAARA,GACHA,EAAKwsC,SAKRL,iBAAA,WACCh/C,KAAKq/C,KAAM,0BC7BZ,aALQr/C,QAAyB,KACzBA,QAAqB,EACrBA,QAA6B,KAC7BA,QAA6B,KAGpCA,KAAKs/C,GAAW,YAAa1nC,UAAY,GAAMA,SAAiB2nC,aAC/D,CAAE,SAAY,CAAE,aAAc,iBAAkB,uBAqInD,OAjICC,eAAA,SAAI3+C,EAAqB6W,EAA4C+nC,gBAAAA,MAEpE,IADA,IAAMC,EAAQ1/C,KAAKs/C,GACV1rC,EAAI8rC,EAAM/sC,OAAS,EAAG,GAAKiB,IAAKA,EAAI,CAC5C,IAAM4Q,EAAOk7B,EAAO9rC,GACpB/S,EAAOiX,iBAAkB0M,EAAM9M,EAAS+nC,KAI1CD,gBAAA,SAAK3+C,EAAqB6W,EAA4C+nC,gBAAAA,MAErE,IADA,IAAMC,EAAQ1/C,KAAKs/C,GACV1rC,EAAI8rC,EAAM/sC,OAAS,EAAG,GAAKiB,IAAKA,EAAI,CAC5C,IAAM+rC,EAAOD,EAAO9rC,GACpB/S,EAAO6mC,oBAAqBiY,EAAMjoC,EAAS+nC,KAI7CD,0BAAA,WACC,GAAwB,MAApBx/C,KAAK4/C,GAAsB,CAC9B,IAAM9+C,EAAQyc,EAAQ7c,cAAcsM,IAAK,SACzChN,KAAK4/C,GAAc9+C,EAAM++C,gBAE1B,OAAO7/C,KAAK4/C,IAGbJ,0BAAA,WAIC,OAHwB,MAApBx/C,KAAK8/C,KACR9/C,KAAK8/C,GAAqC,GAAvB9/C,KAAK6/C,iBAElB7/C,KAAK8/C,IAGbN,sBAAA,SAAWvpC,GACV,IAAI8pC,EAAS,EACTC,EAAS,EA+Bb,GA5BK,WAAY/pC,IAChB+pC,GAAqB,EAAZ/pC,EAAEgqC,QAEP,eAAgBhqC,IACpB+pC,EAAS/pC,EAAEiqC,YAEP,gBAAiBjqC,IACrB+pC,EAAS/pC,EAAEkqC,aAEP,gBAAiBlqC,IACrB8pC,GAA0B,EAAjB9pC,EAAEmqC,aAIP,SAAUnqC,GAAKA,EAAEoqC,OAASpqC,EAAEqqC,kBAChCP,GAAmB,EAAVC,EACTA,EAAS,GAIL,WAAY/pC,IAChB+pC,GAAqB,EAAZ/pC,EAAE+pC,QAEP,WAAY/pC,IAChB8pC,EAAS9pC,EAAE8pC,QAII,IAAXC,GAA2B,IAAXD,EACpB,OAAO,KAIR,IAAIQ,EAAQt0C,KAAKC,IAAKD,KAAKoT,IAAI2gC,GAAS/zC,KAAKoT,IAAI0gC,IAK3CzM,EAAMvF,KAAKuF,MACbtzC,KAAKwgD,GAAa,KAAOlN,IAC5BtzC,KAAKygD,GAAU,MAEhBzgD,KAAKwgD,GAAalN,EAGlB,IAAMoN,EAA2B,eAAXzqC,EAAE0E,MAAyB4lC,EAAQ,KAAQ,IAC1DvgD,KAAKygD,IAAWF,EAAQvgD,KAAKygD,MACnCzgD,KAAKygD,GAAUF,EAGVG,IACJ1gD,KAAKygD,IAAW,KAKbC,IAEJH,GAAU,GACVR,GAAU,GACVC,GAAU,IAIX,IAAMW,EAAS3gD,KAAKygD,GACpBF,EAASt0C,KAAKihC,MAAOqT,EAASI,GAC9BZ,EAAS9zC,KAAM,GAAK8zC,EAAS,QAAU,QAASA,EAASY,GACzDX,EAAS/zC,KAAM,GAAK+zC,EAAS,QAAU,QAASA,EAASW,GAGzD,IAAMC,EAAO3qC,EAAE4qC,WAAa,EAC5B,GAAa,IAATD,EAAa,CAChB,IAAM3+B,EAAmB,IAAT2+B,EAAa5gD,KAAK6/C,gBAAkB7/C,KAAK8gD,gBACzDP,GAASt+B,EACT89B,GAAU99B,EACV+9B,GAAU/9B,EAGX,MAAO,CACN2+B,OACAL,QACAR,SACAC,SACAW,WAIKnB,cAAP,WAIC,OAHqB,MAAjBx/C,KAAKQ,WACRR,KAAKQ,SAAW,IAAIg/C,GAEdx/C,KAAKQ,gBXnJd,SAAY66C,GACXA,yDACAA,6CAFD,CAAYA,KAAAA,QAKZ,SAAYC,GACXA,mBACAA,iCACAA,+BAHD,CAAYA,KAAAA,QAoBZ,IY/BYyF,kBZ0CX,WAAahgD,GAAb,MACCiF,YAAOjF,gBACPoF,EAAK66C,GAAQjgD,EAAQkgD,KACrB96C,EAAK+rC,GAAUnxC,EAAQF,OACvBsF,EAAK+6C,GAAWngD,EAAQogD,QACxBh7C,EAAKi7C,GAAergD,EAAQsgD,OAyL9B,OArMUvhD,OAeCwhD,iBAAV,SAAgBvgD,GACXA,EAAQF,SAAWy6C,GAAoBiG,aAC1CxgD,EAAQU,MAAUV,EAAQU,OAAS+B,EAAWygB,MAAUzgB,EAAWg+C,aAEpEx7C,YAAMggB,eAAMjlB,IAGbvB,sBAAI8hD,wBAAJ,WACC,IAAML,EAAOjhD,KAAKghD,GAClB,OAAIj/C,EAAck/C,IAAkB,MAARA,EACpBA,EAEAA,EAAMjhD,uCAIfR,sBAAI8hD,wBAAJ,WAAA,WACKD,EAAOrhD,KAAKyhD,GAChB,GAAY,MAARJ,EAAe,CAClB,IAAMvgD,EAAQd,KAAKc,MACbC,EAAUf,KAAKohD,IAAgBtgD,EAAM4gD,iBAC3CL,EAAOrhD,KAAK2hD,OAAQ5gD,GACpBf,KAAKyhD,GAAQJ,EACbA,EAAKl0C,GAAI,UAAU,SAClBypB,EACApV,EACAkd,GAEAv4B,EAAKy7C,aAAchrB,EAAOpV,EAAMkd,MAGlC,OAAO2iB,mCAGEC,mBAAV,SACCvgD,GAEA,OAAIA,aAAmB0+B,gBACf1+B,EAEDf,KAAK6hD,QAAS9gD,IAGZugD,oBAAV,SAAmBvgD,GAClB,OAAO+9B,GAAO+iB,QAAS9gD,IAGdugD,yBAAV,SACC1qB,EACApV,EACAkd,GAHD,WAKC,OAAQ9H,GACR,KAAKykB,GAAwByG,wBAC5B9hD,KAAK+hD,MAAM,GACX,MACD,KAAK1G,GAAwB2G,kBAC5B,IAAMf,EAAOjhD,KAAKihD,KACN,MAARA,IACCl/C,EAAck/C,GACjBjhD,KAAKiiD,KAAMhB,GAEXA,EAAK5tC,MAAK,SAAE6uC,GACK,MAAZA,GACH/7C,EAAK87C,KAAMC,SASPZ,iBAAV,SAAgBL,GACf,IAAMzzB,EAAI5V,SAAS0Z,cAAe,KAClC9D,EAAEssB,KAAOmH,EACT5P,GAAc4Q,KAAMz0B,EAAEssB,OAGbwH,wBAAV,SAAuBvgD,GAAvB,WACO8e,EAAU,SAAE5J,GACb9P,EAAK6R,gBACR7R,EAAK03B,SAAU5nB,KAWFlV,GAAWA,EAAQF,UACnBy6C,GAAoBiG,WAClCzjC,EAAiB+B,QAAS7f,KAAM6f,GAEhC/B,EAAiBgC,YAAa9f,KAAM6f,GAZjB,SAAE5J,GACrB,GAAI9P,EAAK6R,eAAiB,CACzB,IAAMqpC,EAAOl7C,EAAKk7C,KACdA,EAAKc,YACRd,EAAKU,KAAM57C,QAYLm7C,oBAAV,WACC,MAAO,iBAGEA,qBAAV,SAAoBrrC,GACnBjQ,YAAM63B,mBAAU5nB,GAChBjW,KAAK+hD,KAAM/hD,KAAKoiD,YAAansC,KAG9BqrC,iBAAA,SAAMc,GAAN,WACOnB,EAAOjhD,KAAKihD,KACN,MAARA,IACCl/C,EAAck/C,GACjBjhD,KAAK4+B,MAAOqiB,EAAMmB,GAElBnB,EAAK5tC,MAAK,SAAE6uC,GACPA,GACH/7C,EAAKy4B,MAAOsjB,EAAUE,QAOjBd,kBAAV,SAAiBL,EAAcmB,GAA/B,WACOjB,EAAUnhD,KAAKkhD,GACrB,GAAIC,EAAU,CACb,IAAMkB,EAAUlB,EAASnhD,OACT,IAAZqiD,EACHriD,KAAKmb,KAAM8lC,EAAMmB,IACK,IAAZC,GAGVA,EAAQhvC,MAAK,SAAE6uC,GACVA,GACH/7C,EAAKgV,KAAM8lC,EAAMmB,WAKpBpiD,KAAKmb,KAAM8lC,EAAMmB,IAITd,iBAAV,SAAgBL,EAAcmB,GAC7B,GAAIA,EAAc,CACjB,IAAME,EAAI1qC,SAAS0Z,cAAe,KAClCgxB,EAAExI,KAAOmH,EACTqB,EAAEzhD,OAAS,SACXyhD,EAAE9sB,MAAMwkB,QAAU,OAClBsI,EAAEC,IAAM,sBACR3qC,SAASC,KAAK85B,YAAa2Q,GAC3BA,EAAErI,QACFj5B,YAAW,WACVpJ,SAASC,KAAK6kB,YAAa4lB,KACzB,UAEHvhC,OAAOyhC,SAAS1I,KAAOmH,GAIfK,wBAAV,SAAuBrrC,GACtB,GAAIjW,KAAKkyC,KAAYoJ,GAAoBiG,WACxC,OAAO,EAEP,IAAMtL,EAAOhgC,aAAagI,cAAYwkC,iBAAmBxsC,EAAEnP,KAAKga,cAAgB7K,EAChF,OACGggC,EAAG7/B,SAAW6/B,EAAG5/B,UAAY4/B,EAAGl+B,QAAUk+B,EAAGyM,SAC7C,WAAYzM,GAAoB,IAAdA,EAAG0M,QAKhBrB,uBAAV,SAAsBrrC,GACrBjQ,YAAM+f,qBAAY9P,GAClBjW,KAAK69B,SAAU5nB,IAGTqrC,eAAP,SAA4BvgD,GAC3B,MAAO,SAAUA,MAnMTi9B,Ia1CI4kB,GAAarT,kBCyB1B,WAAaxuC,UACZiF,YAAOjF,SAwGT,OA5GUjB,OAOC+iD,iBAAV,SAAgB9hD,GAAhB,WACCiF,YAAMggB,eAAMjlB,GAEZ+c,EAAiB+B,QAAS7f,MAAM,WAC3BmG,EAAK6R,gBACR7R,EAAK28C,YAIP9iD,KAAK+iD,UAAWhiD,GAEhB,IAAMsgD,EAAOrhD,KAAK2hD,OAAQ5gD,GAC1Bf,KAAKyhD,GAAQJ,EACbA,EAAKl0C,GAAI,UAAU,SAAEypB,EAAcpV,EAAwBkd,GAC1Dv4B,EAAKy7C,aAAchrB,EAAOpV,EAAMkd,OAIxBmkB,sBAAV,SAAqB9hD,GAArB,WACCf,KAAKmN,GAAI2Q,EAAiBoH,MAAM,WAC3B/e,EAAK6R,gBACR7R,EAAK47C,WAKEc,mBAAV,SAAkB9hD,GACjB,IAAMsgD,EAAOtgD,EAAQsgD,KACrB,OAAIA,aAAgB5hB,gBACZ4hB,EAEDrhD,KAAK6hD,QAASR,IAGZwB,oBAAV,SAAmB9hD,GAClB,OAAO+9B,GAAO+iB,QAAS9gD,IAGxBvB,sBAAIqjD,wBAAJ,WACC,OAAO7iD,KAAKyhD,oCAGHoB,oBAAV,WACC,MAAO,iBAGRA,iBAAA,WACC,IAAMxB,EAAOrhD,KAAKyhD,GACdJ,EAAKc,YACRniD,KAAKu8C,OAAQ8E,IAILwB,mBAAV,SAAkBxB,GACjB,IAAMxuB,EAAU7yB,KAAK8yB,aACN,MAAXD,GACHwuB,EAAKU,KAAM/hD,KAAMA,KAAK+9B,eAAgBlL,IAIxCgwB,kBAAA,WACC7iD,KAAKyhD,GAAMuB,SAGZH,mBAAA,WACC,IAAMxB,EAAOrhD,KAAKyhD,GACdJ,EAAKc,WACRniD,KAAKu8C,OAAQ8E,GAEbA,EAAK2B,SAIGH,qBAAV,SAAoB5sC,GACnBjW,KAAK+hD,OACL/7C,YAAM63B,mBAAU5nB,IAGP4sC,yBAAV,SAAwBjsB,EAAcpV,EAAwBkd,GAC7D,IAAM7rB,EAAO7S,KAAK+9B,eACN,MAARlrB,GACHA,EAAKI,KAAM,SAAU2jB,EAAOpV,EAAMkd,IAI7BmkB,eAAP,SAA4B9hD,GAC3B,MAAO,SAAUA,GAGX8hD,mBAAP,SAAgC9hD,EAAsCs+B,GACrE,IAAMgiB,EAAOtgD,EAAQsgD,KASrB,OAROA,aAAgB5hB,kBACH,MAAf4hB,EAAKhiB,SACRgiB,EAAKhiB,OAASA,GAEG,MAAdgiB,EAAK/+C,QACR++C,EAAK/+C,MAAQsgD,GAAWn3C,QAGnB1K,MA1GC+8B,mBCpBT,WAAarwB,GAAb,MACCzH,0BACAyH,EAAKQ,iBAAkB9H,GAAM,GAC7BsH,EAAKwB,cAAe9I,KAuBtB,OA3BkDrG,OAOjDmjD,qBAAA,SAAUx1C,EAAarL,EAAeyD,GACrC,IAAMpE,EAAQgM,EAAKhM,MACbS,EAASuL,EAAKvL,OACdgM,EAAchM,EAAOiM,SAAU1M,GAC/BgO,EAAcvN,EAAOkN,SAAU3N,GACrC,GAAmB,MAAfgO,EAAsB,CACzB,IAAMC,EAAcxN,EAAOoN,SAAU7N,GAC/BkO,EAAczN,EAAO0N,SAAUnO,GAC/B0C,EAAUsJ,EAAKtJ,QACf++C,EAAkB,GAATr9C,EACf7F,KAAKmjB,QACLnjB,KAAKmjD,UAAWj1C,EAAauB,EAAaC,EAAaC,GACvD3P,KAAKojD,OAAQj/C,EAAQkjB,UAAW67B,GAChCljD,KAAKqjD,OAAQjhD,EAAQ+B,EAAQ6lB,WAAYk5B,GACzCljD,KAAKwP,SAAU,OAEfxP,KAAKmjB,QACLnjB,KAAKwP,SAAU,MAxBgCinB,2BCUlD,4DAmBA,OAfU32B,OACCwjD,iBAAV,SAAgBviD,GACfiF,YAAMggB,eAAMjlB,GACZf,KAAKmkB,aAAc,EACnBnkB,KAAKs9B,YAAa,EAClBt9B,KAAKuR,SAAU/N,EAAWyR,aAAa,IAG9BquC,2BAAV,WACC,IAAIL,GAA8BjjD,OAGzBsjD,oBAAV,WACC,MAAO,yBAbCjmB,mBCHV,4DAYA,OARUv9B,OACCyjD,oBAAV,WACC,MAAO,sBAGDA,eAAP,SAA4BxiD,GAC3B,MAAO,cAAeA,MANduiD,mBCHT,WAAaviD,GAAb,MACCiF,YAAOjF,gBACPoF,EAAKqJ,SAAU,EACfrJ,EAAKoL,SAAU/N,EAAWyR,aAAa,KAMzC,OAVUnV,OAOC0jD,oBAAV,WACC,MAAO,mBARCp9B,mBCDV,4DAWA,OARUtmB,OACC2jD,oBAAV,WACC,MAAO,kBAGDA,eAAP,SAA4B1iD,GAC3B,MAAO,UAAWA,MANVyiD,ICNGE,GAAe,WAC3B5kB,GAAO6kB,gBAAe,SAAE5iD,GACvB,OAAI49B,GAAeilB,aAAc7iD,GACzB,IAAI49B,GAAgB59B,GAErB,QAGR+9B,GAAO6kB,gBAAe,SAAE5iD,GACvB,OAAIugD,GAAcsC,aAAc7iD,GACxB,IAAIugD,GAAevgD,GAEpB,QAGR+9B,GAAO6kB,gBAAe,SAAE5iD,EAAqCs+B,GAC5D,OAAIwjB,GAAce,aAAc7iD,GACxB,IAAI8hD,GAAeA,GAAcgB,iBAAkB9iD,EAASs+B,IAE7D,QAGRP,GAAO6kB,gBAAe,SAAE5iD,GACvB,OAAIwiD,GAAmBK,aAAc7iD,GAC7B,IAAIwiD,GAAoBxiD,GAEzB,QAGR+9B,GAAO6kB,gBAAe,SAAE5iD,GACvB,OAAI0iD,GAAeG,aAAc7iD,GACzB,IAAI0iD,GAAgB1iD,GAErB,QAGR+9B,GAAOglB,uBAAsB,SAAE/iD,GAC9B,OAAO,IAAIi9B,GAAej9B,QRtC5B,SAAYggD,GACXA,2BACAA,+BAFD,CAAYA,KAAAA,QA6BZ,IStCYgD,GTsCNC,GAAiB,SAAE79B,GACxB,OAAOA,aAAiBC,KAAUD,EAAM3W,SAAW2W,aAAiBq9B,KAG/DS,GAAiB,SAA8BnjD,EAAcC,GAClE,GAAIA,EAAU,CACb,GAAmB,MAAfA,EAAQmjD,IACX,OAAOnjD,EAAQmjD,IAEhB,GAAsB,MAAlBnjD,EAAQojD,OACX,OAAOpjD,EAAQojD,OAGjB,OAAOrjD,EAAMsjD,mBAGRC,GAAW,SAA8BvjD,EAAcC,GAC5D,GAAIA,GAA6B,MAAlBA,EAAQu5B,OAAiB,CACvC,IAAMA,EAASv5B,EAAQu5B,OACvB,GAAIt3B,EAAcs3B,GACjB,MAAO,CACN1C,WAAY0C,EACZ5C,SAAU4C,GAGX,IAAMgqB,EAAcxjD,EAAMyjD,YAC1B,MAAO,CACN3sB,WAAmC,MAArB0C,EAAO1C,WAAqB0C,EAAO1C,WAAa0sB,EAC9D5sB,SAA+B,MAAnB4C,EAAO5C,SAAmB4C,EAAO5C,SAAW4sB,GAK1D,MAAO,CACN1sB,WAFK0sB,EAAcxjD,EAAMyjD,YAGzB7sB,SAAU4sB,IAKPE,GAAc,SAA8B1jD,EAAcC,GAC/D,GAAIA,GAAgC,MAArBA,EAAQsU,UAAoB,CAC1C,IAAMA,EAAYtU,EAAQsU,UAC1B,OAAItT,EAAcsT,GACV0rC,GAAkB1rC,GAElBA,EAGT,OAAOvU,EAAM2jD,gBAGRC,GAAiB,SAA8B5jD,EAAcC,GAClE,OAAIA,GAA6B,MAAlBA,EAAQkC,SAAoBD,EAAcjC,EAAQkC,SAAqC,MAAzBlC,EAAQkC,OAAO8tC,OACpFhwC,EAAQkC,OAAO8tC,OAEhBjwC,EAAM6jD,kCAcb,WAAa5jD,GAAb,MACCiF,YAAOjF,SAEPoF,EAAKoL,SAAU/N,EAAWyR,aAAa,GAEvC,IAAMnU,EAAQqF,EAAKrF,aACnBqF,EAAKupC,GAAU2U,GAAUvjD,EAAOC,GAChCoF,EAAKy+C,GAAaJ,GAAa1jD,EAAOC,GACtCoF,EAAK0+C,GAAgBH,GAAgB5jD,EAAOC,GAC5CoF,EAAK2+C,GAAgBb,GAAgBnjD,EAAOC,KA+lB9C,OAhnBUjB,OAoBCilD,2BAAV,WAIC,IAHA,IAAMtvC,EAAWzV,KAAKyV,SAClBlV,EAAS,EACPykD,EAAehlD,KAAK8kD,GACjBlxC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,GAAQ,CAGnD,IAFA,IAAI8Q,GAAU,EACVrK,EAAI,EACDA,EAAIwqC,GAAgBpxC,EAAI4G,EAAIzG,IAAQyG,EAAI,CAC9C,IAAM2L,EAAQ1Q,EAAU7B,EAAI4G,GAC5B,GAAIwpC,GAAgB79B,GAAU,CAC7B,IAAM8+B,EAAY9+B,EAAM/C,eACxB,GAAU,IAAN5I,GAAYyqC,EAAY3oC,EAAiB4oC,OAC5C,MAGA,GADArgC,EAAS5Y,KAAKC,IAAK2Y,EAAQsB,EAAMtB,QAC7BogC,GAAa3oC,EAAiB6oC,MAAQ,CACzC3qC,GAAK,EACL,YAIF5G,GAAK,EACL4G,GAAK,EAGP5G,GAAK4G,EACD,GAAKqK,IACRtkB,GAAUskB,GAGZ,OAAOtkB,GAGEwkD,yBAAV,SAAwBK,EAAkB9qB,GACzC,IAAM7kB,EAAWzV,KAAKyV,SAChBuvC,EAAehlD,KAAK8kD,GAC1B,GAAI9kD,KAAK4kD,KAAe7D,GAAiBsE,SAAW,CAGnD,IAFA,IAAI9kD,EAAS6kD,EACTE,EAAa,EACR1xC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,GAAQ,CAInD,IAHA,IAAIlO,EAAS,EACTgf,GAAU,EACVrK,EAAI,EACDA,EAAIwqC,GAAgBpxC,EAAI4G,EAAIzG,IAAQyG,EAAI,CAC9C,IAAM2L,EAAQ1Q,EAAU7B,EAAI4G,GAC5B,GAAIwpC,GAAgB79B,GAAU,CAC7B,IAAM8+B,EAAY9+B,EAAM/C,eACxB,GAAU,IAAN5I,GAAYyqC,EAAY3oC,EAAiB4oC,OAC5C,MAQA,GAJCr/C,GAFDgf,EAAS5Y,KAAKC,IAAK2Y,EAAQsB,EAAMtB,SACpB,EACH5Y,KAAKC,IAAKrG,EAAQsgB,EAAMtgB,OAASy/C,GAEjCA,EAENL,EAAY3oC,EAAiB6oC,MAAQ,CACxC3qC,GAAK,EACL,YAIF5G,GAAK,EACL4G,GAAK,EAGP5G,GAAK4G,EACLja,GAAUsF,EACVy/C,EAAahrB,EAEd,OAAOruB,KAAKC,IAAK,EAAG3L,GAIpB,IAFIA,EAAS6kD,EACTE,EAAa,EACR1xC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,GAAQ,CACnD,IAAI3R,EAAQ,EAGZ,IAFIyiB,GAAU,EACVrK,EAAI,EACDA,EAAIwqC,GAAgBpxC,EAAI4G,EAAIzG,IAAQyG,EAE1C,GADM2L,EAAQ1Q,EAAU7B,EAAI4G,GACxBwpC,GAAgB79B,GAAU,CAE7B,GADM8+B,EAAY9+B,EAAM/C,eACd,IAAN5I,GAAYyqC,EAAY3oC,EAAiB4oC,OAC5C,MAQA,GAJC9iD,GAFDyiB,EAAS5Y,KAAKC,IAAK2Y,EAAQsB,EAAMtB,SACpB,EACJ5Y,KAAKC,IAAK9J,EAAO+jB,EAAM/jB,MAAQkjD,GAE/BA,EAELL,EAAY3oC,EAAiB6oC,MAAQ,CACxC3qC,GAAK,EACL,YAIF5G,GAAK,EACL4G,GAAK,EAGP5G,GAAK4G,EACLja,GAAU6B,EACVkjD,EAAahrB,EAEd,OAAOruB,KAAKC,IAAK,EAAG3L,IAIZwkD,oBAAV,WACC,IAAMtvC,EAAWzV,KAAKyV,SAChBtR,EAAUnE,KAAKqjB,GACfkiC,EAAaphD,EAAQmjB,SACrBk+B,EAAgBrhD,EAAQ8lB,YACxBw7B,EAActhD,EAAQkjB,UACtBq+B,EAAevhD,EAAQ6lB,WACvBsQ,EAASt6B,KAAK0vC,GACd3T,EAAiBzB,EAAO5C,SACxBkE,EAAmBtB,EAAO1C,WAC1B+tB,EAAc3lD,KAAK4lD,iBACnBZ,EAAehlD,KAAK8kD,GAEtBe,EAAmB,KACvB,GAAI7lD,KAAK6kD,GAAgB,CACxB,IAAMiB,EAAe,GAAMrwC,EAAS9C,QAAU,IACZ,MAA9BoyC,EAAQgB,oBAA8BhB,EAAQgB,mBAAmBpzC,OAASmzC,KAC7Ef,EAAQgB,mBAAqB,IAAI9/C,aAAc6/C,KAEhDD,EAAmBd,EAAQgB,oBACT,IAAO,EACzBF,EAAkB,IAAO,EACzBA,EAAkBC,EAAe,IAAO,EACxCD,EAAkBC,EAAe,IAAO,EAGzC,GAAI9lD,KAAK4kD,KAAe7D,GAAiBsE,SAAW,CACnD,IAAIW,EAAO,EACPzgD,EAAIggD,EAAaxpB,EACrB,GAAI,EAAI4pB,EAAc,CAIrB,IAHA,IAAMM,EAAqB,EAAIN,EACzBP,EAAWplD,KAAK6F,OAAS0/C,EAAaC,EACtCU,EAAYlmD,KAAKmmD,aAAcf,EAAUrpB,GACtCnoB,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,GAAQ,CAInD,IAHA,IAAIzO,EAAImgD,EAAc7pB,EAClB/1B,EAAS,EACT2U,EAAI,EACDA,EAAIwqC,GAAgBpxC,EAAI4G,EAAIzG,IAAQyG,EAAI,CAC9C,IAAM2L,EAAQ1Q,EAAU7B,EAAI4G,GAC5B,GAAIwpC,GAAgB79B,GAAU,CAC7B,IAAM8+B,EAAY9+B,EAAM/C,eACxB,GAAU,IAAN5I,GAAYyqC,EAAY3oC,EAAiB4oC,OAC5C,MASA,GAPA/+B,EAAMtJ,SAASrX,IAAKo2B,EAAmBt2B,EAAGy2B,EAAiBx2B,GAEvD,IADEsf,EAASsB,EAAMtB,UAEpBsB,EAAMtgB,OAASqgD,GAAcrhC,EAASohC,IAEvC3gD,GAAKs2B,EAAmBzV,EAAM/jB,MAC9ByD,EAASoG,KAAKC,IAAKrG,EAAQsgB,EAAMtgB,QAC7Bo/C,EAAY3oC,EAAiB6oC,MAAQ,CAChB,MAApBU,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGA,EAC5BqrC,EAAkBt4B,EAAI,GAAMy4B,GAE7BxrC,GAAK,EACL,MAEwB,MAApBqrC,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGA,EAC5BqrC,EAAkBt4B,EAAI,GAAMy4B,QAKP,MAApBH,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGA,EAAI,EAChCqrC,EAAkBt4B,EAAI,GAAMy4B,GAE7BpyC,GAAK,EACL4G,GAAK,EAGPjV,GAAKw2B,EAAiBl2B,EACtB+N,GAAK4G,EACLwrC,GAAQ,EAGT,GAAwB,MAApBH,EACH,IAASjyC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAEnD,GADMuS,EAAQ1Q,EAAU7B,GACpBowC,GAAgB79B,GAAU,CAC7B,IACMigC,EAAWP,EAAuB,GADlCvI,EAAK,GAAM1pC,GAAK,KAEhByyC,EAAQR,EAAkBvI,EAAK,GAGjCgJ,GAAY,EAChB,MAHMrB,EAAY9+B,EAAM/C,gBAGL9G,EAAiB4oC,QAAU,CAC7C,IAAM7H,EAAKr9C,KAAKumD,qBAAsBjJ,EAAI+I,EAAOR,GAC3C7lD,KAAKwmD,kBAAmB/wC,EAAU4nC,KACvCiJ,EAAWT,EAAkBxI,IAI/B,IAAIoJ,GAAY,EAChB,KAAOxB,EAAY3oC,EAAiB6oC,OAAS,CAC5C,IAAM5H,EAAKv9C,KAAK0mD,iBAAkBpJ,EAAI+I,EAAOR,GACvC7lD,KAAK2mD,mBAAoBlxC,EAAU8nC,KACxCkJ,EAAWZ,EAAkBtI,IAI/B,IAAMqJ,EAAU5mD,KAAK6mD,YAAavJ,EAAI+I,EAAOR,GAC7C1/B,EAAMljB,OAAOT,KAAOxC,KAAK8mD,mBAAoBR,EAAUF,EAAUK,EAAUG,QAIxE,CACN,IAAShzC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,GAAQ,CAInD,IAHIzO,EAAImgD,EAAc7pB,EAClB/1B,EAAS,EACT2U,EAAI,EACDA,EAAIwqC,GAAgBpxC,EAAI4G,EAAIzG,IAAQyG,EAE1C,GADM2L,EAAQ1Q,EAAU7B,EAAI4G,GACxBwpC,GAAgB79B,GAAU,CAE7B,GADM8+B,EAAY9+B,EAAM/C,eACd,IAAN5I,GAAYyqC,EAAY3oC,EAAiB4oC,OAC5C,MASA,GAPA/+B,EAAMtJ,SAASrX,IAAKo2B,EAAmBt2B,EAAGy2B,EAAiBx2B,GAEvD,IADEsf,EAASsB,EAAMtB,UAEpBsB,EAAMtgB,OAAS,GAEhBP,GAAKs2B,EAAmBzV,EAAM/jB,MAC9ByD,EAASoG,KAAKC,IAAKrG,EAAQsgB,EAAMtgB,QAC7Bo/C,EAAY3oC,EAAiB6oC,MAAQ,CAChB,MAApBU,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGA,EAC5BqrC,EAAkBt4B,EAAI,GAAMy4B,GAE7BxrC,GAAK,EACL,MAEwB,MAApBqrC,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGA,EAC5BqrC,EAAkBt4B,EAAI,GAAMy4B,QAKP,MAApBH,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGA,EAAI,EAChCqrC,EAAkBt4B,EAAI,GAAMy4B,GAE7BpyC,GAAK,EACL4G,GAAK,EAGPjV,GAAKw2B,EAAiBl2B,EACtB+N,GAAK4G,EACLwrC,GAAQ,EAGT,GAAwB,MAApBH,EACH,IAASjyC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAC7CuS,EAAQ1Q,EAAU7B,GACpBowC,GAAgB79B,KAEbigC,EAAWP,EAAuB,GADlCvI,EAAK,GAAM1pC,GAAK,KAEhByyC,EAAQR,EAAkBvI,EAAK,GAGjCgJ,GAAY,GAFVrB,EAAY9+B,EAAM/C,gBAGL9G,EAAiB4oC,SAC7B7H,EAAKr9C,KAAKumD,qBAAsBjJ,EAAI+I,EAAOR,GAC3C7lD,KAAKwmD,kBAAmB/wC,EAAU4nC,KACvCiJ,EAAWT,EAAkBxI,KAI3BoJ,GAAY,EACTxB,EAAY3oC,EAAiB6oC,QAC7B5H,EAAKv9C,KAAK0mD,iBAAkBpJ,EAAI+I,EAAOR,GACvC7lD,KAAK2mD,mBAAoBlxC,EAAU8nC,KACxCkJ,EAAWZ,EAAkBtI,KAIzBqJ,EAAU5mD,KAAK6mD,YAAavJ,EAAI+I,EAAOR,GAC7C1/B,EAAMljB,OAAOT,KAAOxC,KAAK8mD,mBAAoBR,EAAUF,EAAUK,EAAUG,SAKzE,CACN,IAAIG,EAAU,EAEd,GADIzhD,EAAImgD,EAAc7pB,EAClB,EAAI+pB,EAAc,CAIrB,IAHMM,EAAqB,EAAIN,EACzBP,EAAWplD,KAAKoC,MAAQqjD,EAAcC,EACtCQ,EAAYlmD,KAAKmmD,aAAcf,EAAUxpB,GACtChoB,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,GAAQ,CAC/CxO,EAAIggD,EAAaxpB,EAArB,IACI35B,EAAQ,EAEZ,IADIoY,EAAI,EACDA,EAAIwqC,GAAgBpxC,EAAI4G,EAAIzG,IAAQyG,EAE1C,GADM2L,EAAQ1Q,EAAU7B,EAAI4G,GACxBwpC,GAAgB79B,GAAU,CAE7B,GADM8+B,EAAY9+B,EAAM/C,eACd,IAAN5I,GAAYyqC,EAAY3oC,EAAiB4oC,OAC5C,MASA,GAPA/+B,EAAMtJ,SAASrX,IAAKo2B,EAAmBt2B,EAAGy2B,EAAiBx2B,GAEvD,IADEsf,EAASsB,EAAMtB,UAEpBsB,EAAM/jB,MAAQ8jD,GAAcrhC,EAASohC,IAEtC7jD,EAAQ6J,KAAKC,IAAK9J,EAAO+jB,EAAM/jB,OAC/BmD,GAAKw2B,EAAiB5V,EAAMtgB,OACxBo/C,EAAY3oC,EAAiB6oC,MAAQ,CAChB,MAApBU,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGusC,EAC5BlB,EAAkBt4B,EAAI,GAAM/S,GAE7BA,GAAK,EACL,MAEwB,MAApBqrC,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGusC,EAC5BlB,EAAkBt4B,EAAI,GAAM/S,QAKP,MAApBqrC,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGusC,EAC5BlB,EAAkBt4B,EAAI,GAAM/S,EAAI,GAEjC5G,GAAK,EACL4G,GAAK,EAGPlV,GAAKs2B,EAAmBx5B,EACxBwR,GAAK4G,EACLusC,GAAW,EAGZ,GAAwB,MAApBlB,EACH,IAASjyC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAEnD,GADMuS,EAAQ1Q,EAAU7B,GACpBowC,GAAgB79B,GAAU,CAEvBigC,EAAWP,EAAuB,GADlCvI,EAAK,GAAM1pC,GAAK,KAEhByyC,EAAQR,EAAkBvI,EAAK,GAFrC,IAKI0J,GAAS,GAFP/B,EAAY9+B,EAAM/C,gBAGL9G,EAAiB4oC,SAC7B7H,EAAKr9C,KAAKinD,wBAAyB3J,EAAI8I,EAAUP,GACjD7lD,KAAKwmD,kBAAmB/wC,EAAU4nC,KACvC2J,EAAQnB,EAAkBxI,EAAK,KAIjC,IAAI6J,GAAS,EACNjC,EAAY3oC,EAAiB6oC,QAC7B5H,EAAKv9C,KAAKmnD,oBAAqB7J,EAAI8I,EAAUP,GAC7C7lD,KAAK2mD,mBAAoBlxC,EAAU8nC,KACxC2J,EAAQrB,EAAkBtI,EAAK,KAIjC,IAAM6J,EAAOpnD,KAAKqnD,SAAU/J,EAAI8I,EAAUP,GAC1C1/B,EAAMljB,OAAOT,KAAOxC,KAAKsnD,gBAAiBN,EAAOX,EAAOa,EAAOE,QAI5D,CACN,IAASxzC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,GAAQ,CAInD,IAHIxO,EAAIggD,EAAaxpB,EACjB35B,EAAQ,EACRoY,EAAI,EACDA,EAAIwqC,GAAgBpxC,EAAI4G,EAAIzG,IAAQyG,EAE1C,GADM2L,EAAQ1Q,EAAU7B,EAAI4G,GACxBwpC,GAAgB79B,GAAU,CAC7B,IAKOtB,EAJP,GADMogC,EAAY9+B,EAAM/C,eACd,IAAN5I,GAAYyqC,EAAY3oC,EAAiB4oC,OAC5C,MASA,GAPA/+B,EAAMtJ,SAASrX,IAAKo2B,EAAmBt2B,EAAGy2B,EAAiBx2B,GAEvD,IADEsf,EAASsB,EAAMtB,UAEpBsB,EAAM/jB,MAAQ,GAEfA,EAAQ6J,KAAKC,IAAK9J,EAAO+jB,EAAM/jB,OAC/BmD,GAAKw2B,EAAiB5V,EAAMtgB,OACxBo/C,EAAY3oC,EAAiB6oC,MAAQ,CAChB,MAApBU,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGusC,EAC5BlB,EAAkBt4B,EAAI,GAAM/S,GAE7BA,GAAK,EACL,MAEwB,MAApBqrC,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGusC,EAC5BlB,EAAkBt4B,EAAI,GAAM/S,OAIzB,CAEL,IAAM+S,EADiB,MAApBs4B,IAEHA,EAAsB,GADhBt4B,EAAK3Z,EAAI4G,EAAI,GAAM,IACGusC,EAC5BlB,EAAkBt4B,EAAI,GAAM/S,EAAI,GAEjC5G,GAAK,EACL4G,GAAK,EAGPlV,GAAKs2B,EAAmBx5B,EACxBwR,GAAK4G,EACLusC,GAAW,EAGZ,GAAwB,MAApBlB,EACH,IAASjyC,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CAGtD,IAAM0pC,EAFDn3B,EAAQ1Q,EAAU7B,GACpBowC,GAAgB79B,KAEbigC,EAAWP,EAAuB,GADlCvI,EAAK,GAAM1pC,GAAK,KAEhByyC,EAAQR,EAAkBvI,EAAK,GAGjC0J,GAAS,GAFP/B,EAAY9+B,EAAM/C,gBAGL9G,EAAiB4oC,SAC7B7H,EAAKr9C,KAAKinD,wBAAyB3J,EAAI8I,EAAUP,GACjD7lD,KAAKwmD,kBAAmB/wC,EAAU4nC,KACvC2J,EAAQnB,EAAkBxI,EAAK,KAI7B6J,GAAS,EACNjC,EAAY3oC,EAAiB6oC,QAC7B5H,EAAKv9C,KAAKmnD,oBAAqB7J,EAAI8I,EAAUP,GAC7C7lD,KAAK2mD,mBAAoBlxC,EAAU8nC,KACxC2J,EAAQrB,EAAkBtI,EAAK,KAI3B6J,EAAOpnD,KAAKqnD,SAAU/J,EAAI8I,EAAUP,GAC1C1/B,EAAMljB,OAAOT,KAAOxC,KAAKsnD,gBAAiBN,EAAOX,EAAOa,EAAOE,MAOpEphD,YAAM2jB,oBAGGo7B,+BAAV,SAA8BtvC,EAA2BD,GACxD,OAAOxV,KAAKunD,aAAc9xC,EAAUD,EAAO8G,EAAiB4oC,SAGnDH,8BAAV,SAA6BtvC,EAA2BD,GACvD,OAAOxV,KAAKunD,aAAc9xC,EAAUD,EAAO8G,EAAiB6oC,QAGnDJ,yBAAV,SAAwBtvC,EAA2BD,EAAeyvC,GACjE,GAAI,GAAKzvC,EAAQ,CAChB,IAAM5B,EAAK4B,EAAQ,GAAM,EACzB,GAAI,GAAK5B,GAAKA,EAAI6B,EAAS9C,OAAS,CACnC,IAAMwT,EAAQ1Q,EAAU7B,GACxB,GAAIuS,aAAiBC,GACpB,SAAWD,EAAM/C,eAAiB6hC,IAIrC,OAAO,GAGEF,oCAAV,SAAmCr2B,EAAgBq4B,EAAiBlB,GACnE,IAAK,IAAIjyC,EAAI8a,EAAS,EAAG,GAAK9a,EAAGA,GAAK,EACrC,GAAIiyC,EAAkBjyC,KAAQmzC,EAC7B,OAAOnzC,EAGT,OAAO,GAGEmxC,gCAAV,SAA+Br2B,EAAgBq4B,EAAiBlB,GAC/D,IAAK,IAAIjyC,EAAI8a,EAAS,EAAG3a,EAAO8xC,EAAiBlzC,OAAQiB,EAAIG,EAAMH,GAAK,EAAI,CAC3E,IAAM6yC,EAAWZ,EAAkBjyC,GACnC,GAAI6yC,IAAaM,EAAU,CAC1B,IAAK,IAAIvsC,EAAI5G,EAAI,EAAG4G,EAAIzG,EAAMyG,GAAK,EAClC,GAAIqrC,EAAkBrrC,KAAQisC,EAC7B,OAAOjsC,EAAI,EAGb,OAAO5G,GAGT,OAAOiyC,EAAiBlzC,OAAS,GAGxBoyC,qBAAV,SAAoBr2B,EAAgBq4B,EAAiBlB,GACpD,IAAK,IAAIjyC,EAAI8a,EAAS,EAAG3a,EAAO8xC,EAAiBlzC,OAAQiB,EAAIG,EAAMH,GAAK,EAEvE,GADiBiyC,EAAkBjyC,KAClBmzC,EAChB,OAAOlB,EAAkBjyC,EAAI,EAAI,GAAM,EAGzC,OAAO,GAGEmxC,iCAAV,SAAgCr2B,EAAgBs3B,EAAcH,GAC7D,IAAK,IAAIjyC,EAAI8a,EAAS,EAAG,GAAK9a,EAAGA,GAAK,EACrC,GAAIiyC,EAAkBjyC,EAAI,KAAQoyC,EACjC,OAAOpyC,EAGT,OAAO,GAGEmxC,6BAAV,SAA4Br2B,EAAgBs3B,EAAcH,GACzD,IAAK,IAAIjyC,EAAI8a,EAAS,EAAG3a,EAAO8xC,EAAiBlzC,OAAQiB,EAAIG,EAAMH,GAAK,EAAI,CAC3E,IAAMszC,EAAQrB,EAAkBjyC,EAAI,GACpC,GAAIszC,IAAUlB,EAAO,CACpB,IAAK,IAAIxrC,EAAI5G,EAAI,EAAG4G,EAAIzG,EAAMyG,GAAK,EAClC,GAAIqrC,EAAkBrrC,EAAI,KAAQ0sC,EACjC,OAAO1sC,EAAI,EAGb,OAAO5G,GAGT,OAAOiyC,EAAiBlzC,OAAS,GAGxBoyC,wBAAV,SAAuBr2B,EAAgBs3B,EAAcH,GACpD,IAAK,IAAIjyC,EAAI8a,EAAS,EAAG3a,EAAO8xC,EAAiBlzC,OAAQiB,EAAIG,EAAMH,GAAK,EAEvE,GADciyC,EAAkBjyC,EAAI,KACtBoyC,EACb,OAAOH,EAAkBjyC,EAAI,EAAI,GAAM,EAGzC,OAAO,GAGEmxC,+BAAV,SAA8B1H,EAAYC,EAAYC,EAAYiK,GACjE,IAAIjnD,EAASuB,EAAYmiB,KAazB,OAZIo5B,EAAK,EAAIC,GAAa,IAAPA,IAClB/8C,GAAUuB,EAAY0H,UAEnB+zC,EAAK,EAAID,GAAa,IAAPA,IAClB/8C,GAAUuB,EAAY8H,aAEnByzC,EAAKC,GAAMA,EAAK,IAAMkK,IACzBjnD,GAAUuB,EAAY4H,WAEnB6zC,EAAKD,GAAMA,EAAK,IAAMkK,IACzBjnD,GAAUuB,EAAYgI,cAEhBhI,EAAY2lD,KAAQlnD,GAGlBwkD,4BAAV,SAA2B1H,EAAYC,EAAYC,EAAYiK,GAC9D,IAAIjnD,EAASuB,EAAYmiB,KAazB,OAZIo5B,EAAK,EAAIC,GAAa,IAAPA,IAClB/8C,GAAUuB,EAAY0H,UAEnB+zC,EAAK,EAAID,GAAa,IAAPA,IAClB/8C,GAAUuB,EAAY4H,WAEnB2zC,EAAKC,GAAMA,EAAK,IAAMkK,IACzBjnD,GAAUuB,EAAY8H,aAEnB2zC,EAAKD,GAAMA,EAAK,IAAMkK,IACzBjnD,GAAUuB,EAAYgI,cAEhBhI,EAAY2lD,KAAQlnD,GAG5BwkD,qBAAA,SAAUhkD,GACT,OAAOf,KAAKkmB,SAAU,IAAIs9B,GAAcziD,KAG/BgkD,oBAAV,WACC,MAAO,WA7mBDA,qBAA0C,QADxC3+B,mBU1FV,4DAOA,OAJUtmB,OACC4nD,oBAAV,WACC,MAAO,sBAFC3C,mBCIT,WAAahkD,UACZiF,YAAOjF,SAMT,OATUjB,OAMC6nD,oBAAV,WACC,MAAO,8BAPCD,mBCAV,4DA2BA,OAvBU5nD,OACC8nD,iBAAV,SAAgB7mD,GAAhB,WACCiF,YAAMggB,eAAMjlB,GAEZf,KAAKmN,GAAI2Q,EAAiB4B,MAAM,SAAEzJ,GAC7B9P,EAAK6R,gBACR7R,EAAK03B,SAAU5nB,OAKR2xC,yBAAV,WACC,OAAO,MAGEA,oBAAV,WACC,MAAO,6BAGEA,qBAAV,SAAoB3xC,GACnBjW,KAAKiT,KAAM,SAAUjT,MACrBgG,YAAM63B,mBAAU5nB,OArBRonB,kBCfV,cAwBA,OApBQwqB,iBAAP,SAAuB9oB,GACtB/+B,KAAKg/B,SAASpsB,KAAMmsB,IAGd8oB,wBAAP,SAA8B9oB,GAC7B/+B,KAAKi/B,gBAAkBF,GAGjB8oB,UAAP,SAAuB9mD,EAAuCs+B,GAC7D,OAAOP,GAAOS,UAAWv/B,KAAKg/B,SAAUh/B,KAAKi/B,gBAAiBl+B,EAASs+B,IACtEP,GAAOY,QAAS3+B,EAASs+B,IAGpBwoB,WAAP,SACC9yC,EACAyqB,EACAH,GAEAP,GAAOe,WAAY7/B,KAAM+U,EAAQyqB,EAAOH,IArBxBwoB,WAA+B,GAC/BA,kBAA2C,yBCkB7D,4DA0HA,OAtHU/nD,OAICgoD,iBAAV,SAAgB/mD,GAAhB,WACCiF,YAAMggB,eAAMjlB,GAGZ,IAAMD,EAAQd,KAAKc,MACbinD,EAAS/nD,KAAKgoD,SAAUlnD,EAAOC,GACrCf,KAAKioD,GAAUF,EACfA,EAAO56C,GAAI,UAAU,WACpBhH,EAAK28C,YAEN9iD,KAAKkmB,SAAU6hC,GAGf,IAAMlwC,EAAO7X,KAAKkoD,OAAQpnD,EAAOC,GACjCf,KAAKmoD,GAAQtwC,EACb,IAAMwnB,KAAWt+B,GAA6B,MAAlBA,EAAQs+B,SAAiBt+B,EAAQs+B,OAC7Dr/B,KAAKooD,SAAUvwC,EAAMwnB,EAAQv+B,EAAOC,GACpCf,KAAKkmB,SAAUrO,GAGX7X,KAAK8nB,WACR9nB,KAAKqoD,cAELroD,KAAKsoD,iBAIGR,qBAAV,SAAoBjwC,EAAiBwnB,EAAiBv+B,EAAcC,GACpD,MAAXA,GAAoC,MAAjBA,EAAQy+B,OAC9BqoB,GAAqBO,SAAUvwC,EAAM9W,EAAQy+B,MAAOH,IAI5CyoB,qBAAV,SAAoBhnD,EAAcC,GACjC,OAAIA,EACCA,EAAQgnD,kBAAkBtoB,gBACtB1+B,EAAQgnD,OAER/nD,KAAKuoD,UAAWznD,EAAOC,EAAQgnD,QAGjC/nD,KAAKuoD,UAAWznD,IAGdgnD,sBAAV,SAAqBhnD,EAAcC,GAClC,OAAO,IAAI6mD,GAAkC7mD,IAGpC+mD,mBAAV,SAAkBhnD,EAAeC,GAChC,OAAIA,GAAWA,EAAQ8W,KAClB9W,EAAQ8W,gBAAgB4nB,gBACpB1+B,EAAQ8W,KAER7X,KAAKwoD,QAAS1nD,EAAOC,EAAQ8W,MAG/B7X,KAAKwoD,QAAS1nD,IAGZgnD,oBAAV,SAAmBhnD,EAAcC,GAChC,OAAO,IAAI4mD,GAAyB5mD,IAGrC+mD,iBAAA,WACC9nD,KAAK6+B,WAAW,IAGjBipB,kBAAA,WACC9nD,KAAK6+B,WAAW,IAGjBipB,mBAAA,WACC9nD,KAAK6+B,WAAa7+B,KAAK8nB,aAGdggC,wBAAV,WACC,IAAMjwC,EAAO7X,KAAKmoD,GACdtwC,aAAgBuO,GACnBvO,EAAKwnC,OAELxnC,EAAKrI,SAAU,GAIPs4C,0BAAV,WACC,IAAMjwC,EAAO7X,KAAKmoD,GACdtwC,aAAgBuO,GACnBvO,EAAKunC,OAELvnC,EAAKrI,SAAU,GAIPs4C,0BAAV,SAAyBh/B,EAAsBE,GAC9ChjB,YAAMijB,wBAAeH,EAAUE,GAE3B3Y,EAAYyX,SAAUgB,GACnBzY,EAAYyX,SAAUkB,IAC3BhpB,KAAKqoD,cAGFh4C,EAAYyX,SAAUkB,IACzBhpB,KAAKsoD,iBAKER,oBAAV,WACC,MAAO,uBAGDA,eAAP,SAA4B/mD,GAC3B,MAAO,WAAYA,MApHX2mD,mBC1BV,4DAQA,OAJU5nD,OACC2oD,oBAAV,WACC,MAAO,mCAFC9pB,mBCJV,4DAQA,OAJU7+B,OACC4oD,oBAAV,WACC,MAAO,kCAFCpH,mBCJV,4DAQA,OAJUxhD,OACC6oD,oBAAV,WACC,MAAO,uCAFCpF,mBCJV,4DAOA,OAJUzjD,OACC8oD,oBAAV,WACC,MAAO,mCAFCnF,mBCHV,4DAQA,OAJU3jD,OACC+oD,oBAAV,WACC,MAAO,kCAFC7qB,ICSG8qB,GAAyB,WACrChqB,GAAO6kB,gBAAe,SAAE5iD,GACvB,OAAI+mD,GAAoBlE,aAAc7iD,GAC9B,IAAI+mD,GAAqB/mD,GAE1B,QAGR8mD,GAAqBlE,gBAAe,SAAE5iD,GACrC,OAAI49B,GAAeilB,aAAc7iD,GACzB,IAAI0nD,GAA8B1nD,GAEnC,QAGR8mD,GAAqBlE,gBAAe,SAAE5iD,GACrC,OAAIugD,GAAcsC,aAAc7iD,GACxB,IAAI2nD,GAA6B3nD,GAElC,QAGR8mD,GAAqBlE,gBAAe,SAAE5iD,GACrC,OAAIwiD,GAAmBK,aAAc7iD,GAC7B,IAAI4nD,GAAkC5nD,GAEvC,QAGR8mD,GAAqBlE,gBAAe,SAAE5iD,GACrC,OAAI0iD,GAAeG,aAAc7iD,GACzB,IAAI6nD,GAA8B7nD,GAEnC,QAGR8mD,GAAqB/D,uBAAsB,SAAE/iD,GAC5C,OAAO,IAAI8nD,GAA6B9nD,sBClD1C,4DAQA,OAJUjB,OACCipD,oBAAV,WACC,MAAO,0BAFCpqB,mBCHV,4DAYA,OARU7+B,OACCkpD,yBAAV,WACC,OAAO,MAGEA,oBAAV,WACC,MAAO,yBANC1H,mBCFV,4DAwBA,OApBUxhD,OACCmpD,sBAAV,SAAqBloD,KAIXkoD,yBAAV,SAAwBryB,EAAcpV,EAAwBkd,GAC7D14B,YAAM47C,uBAAchrB,EAAOpV,EAAMkd,GACjC,IAAMjB,EAAYz9B,KAAK29B,eACnBF,GACHA,EAAUpL,IAAK7Q,IAIPynC,mBAAV,SAAkB5H,GACjBA,EAAKU,KAAM/hD,KAAMA,OAGRipD,oBAAV,WACC,MAAO,yBAlBCpG,mBCPV,4DAQA,OAJU/iD,OACCopD,oBAAV,WACC,MAAO,8BAFC3F,mBCJV,4DAOA,OAJUzjD,OACCqpD,oBAAV,WACC,MAAO,0BAFC1F,mBCHV,4DAQA,OAJU3jD,OACCspD,oBAAV,WACC,MAAO,yBAFCprB,kBCFV,cAwBA,OApBQqrB,iBAAP,SAAuBtqB,GACtB/+B,KAAKg/B,SAASpsB,KAAMmsB,IAGdsqB,wBAAP,SAA8BtqB,GAC7B/+B,KAAKi/B,gBAAkBF,GAGjBsqB,UAAP,SAAuBtoD,EAAuCs+B,GAC7D,OAAOP,GAAOS,UAAWv/B,KAAKg/B,SAAUh/B,KAAKi/B,gBAAiBl+B,EAASs+B,IACtEP,GAAOY,QAAS3+B,EAASs+B,IAGpBgqB,WAAP,SACCt0C,EACAyqB,EACAH,GAEAP,GAAOe,WAAY7/B,KAAM+U,EAAQyqB,EAAOH,IArBxBgqB,WAA+B,GAC/BA,kBAA2C,UCShDC,GAAoB,WAChCD,GAAYvF,uBAAsB,SAAE/iD,GACnC,OAAO,IAAIqoD,GAAoBroD,MAGhCsoD,GAAY1F,gBAAe,SAAE5iD,GAC5B,OAAI0iD,GAAeG,aAAc7iD,GACzB,IAAIooD,GAAqBpoD,GAE1B,QAGRsoD,GAAY1F,gBAAe,SAAE5iD,GAC5B,OAAIwiD,GAAmBK,aAAc7iD,GAC7B,IAAImoD,GAAyBnoD,GAE9B,QAGRsoD,GAAY1F,gBAAe,SAAE5iD,EAAqCs+B,GACjE,OAAIwjB,GAAce,aAAc7iD,GACxB,IAAIkoD,GAAoBpG,GAAcgB,iBAAkB9iD,EAASs+B,IAElE,QAGRgqB,GAAY1F,gBAAe,SAAE5iD,GAC5B,OAAIugD,GAAcsC,aAAc7iD,GACxB,IAAIioD,GAAoBjoD,GAEzB,QAGRsoD,GAAY1F,gBAAe,SAAE5iD,GAC5B,OAAI49B,GAAeilB,aAAc7iD,GACzB,IAAIgoD,GAAqBhoD,GAE1B,uBC/CT,cAwBA,OApBQwoD,iBAAP,SAAuBxqB,GACtB/+B,KAAKg/B,SAASpsB,KAAMmsB,IAGdwqB,wBAAP,SAA8BxqB,GAC7B/+B,KAAKi/B,gBAAkBF,GAGjBwqB,UAAP,SAAuBxoD,EAAuCs+B,GAC7D,OAAOP,GAAOS,UAAWv/B,KAAKg/B,SAAUh/B,KAAKi/B,gBAAiBl+B,EAASs+B,IACtEgqB,GAAY3pB,QAAS3+B,EAASs+B,IAGzBkqB,WAAP,SACCx0C,EACAyqB,EACAH,GAEAP,GAAOe,WAAY7/B,KAAM+U,EAAQyqB,EAAOH,IArBxBkqB,WAA+B,GAC/BA,kBAA2C,yBCH7D,4DAcA,OAVUzpD,OACC0pD,qBAAV,SAAoB3xC,EAAiBwnB,EAAiBv+B,EAAcC,GACpD,MAAXA,GAAoC,MAAjBA,EAAQy+B,OAC9B+pB,GAA0BnB,SAAUvwC,EAAM9W,EAAQy+B,MAAOH,IAIjDmqB,oBAAV,WACC,MAAO,+BARC1B,mBCLV,4DAQA,OAJUhoD,OACC2pD,oBAAV,WACC,MAAO,wCAFChB,mBCLV,4DAQA,OAJU3oD,OACC4pD,oBAAV,WACC,MAAO,uCAFCpI,mBCJV,4DAQA,OAJUxhD,OACC6pD,oBAAV,WACC,MAAO,kCAFC9G,mBCFV,4DAYA,OARU/iD,OACC8pD,mBAAV,SAAkBvI,GACjBA,EAAKU,KAAM/hD,KAAMA,OAGR4pD,oBAAV,WACC,MAAO,uCANCD,mBCLV,4DAQA,OAJU7pD,OACC+pD,oBAAV,WACC,MAAO,8BAFClB,mBCJV,4DAOA,OAJU7oD,OACCgqD,oBAAV,WACC,MAAO,wCAFClB,mBCHV,4DAQA,OAJU9oD,OACCiqD,oBAAV,WACC,MAAO,uCAFClB,ICWGmB,GAA8B,WAC1CX,GAAY1F,gBAAe,SAAE5iD,GAC5B,OAAI+mD,GAAoBlE,aAAc7iD,GAC9B,IAAIyoD,GAA0BzoD,GAE/B,QAGRwoD,GAA0B5F,gBAAe,SAAE5iD,GAC1C,OAAI49B,GAAeilB,aAAc7iD,GACzB,IAAI0oD,GAAmC1oD,GAExC,QAGRwoD,GAA0B5F,gBAAe,SAAE5iD,GAC1C,OAAIugD,GAAcsC,aAAc7iD,GACxB,IAAI2oD,GAAkC3oD,GAEvC,QAGRwoD,GAA0B5F,gBAAe,SACxC5iD,EAAqCs+B,GAErC,OAAIwjB,GAAce,aAAc7iD,GACxB,IAAI6oD,GAAkC/G,GAAcgB,iBAAkB9iD,EAASs+B,IAEhF,QAGRkqB,GAA0B5F,gBAAe,SAAE5iD,GAC1C,OAAIwiD,GAAmBK,aAAc7iD,GAC7B,IAAI8oD,GAAuC9oD,GAE5C,QAGRwoD,GAA0B5F,gBAAe,SAAE5iD,GAC1C,OAAI0iD,GAAeG,aAAc7iD,GACzB,IAAI+oD,GAAmC/oD,GAExC,QAGRwoD,GAA0BzF,uBAAsB,SAAE/iD,GACjD,OAAO,IAAIgpD,GAAkChpD,OC3DlCkpD,GAAkB,WAC9BvG,KACAoF,KACAQ,KACAU,MCDYE,GAAsE,I/BRnF,SAAYnG,GACXA,uBACAA,6BACAA,6CACAA,2BACAA,2CACAA,mBACAA,qBACAA,qBACAA,iBACAA,qBACAA,oBACAA,wCACAA,+BAbD,CAAYA,KAAAA,QgCQL,ICJKoG,GDICC,GAET,ICNJ,SAAYD,GACXA,mBACAA,uBACAA,iDACAA,iDACAA,2DACAA,wBACAA,wCACAA,wCACAA,yBACAA,yCACAA,yCACAA,mCACAA,mCACAA,0CAdD,CAAYA,KAAAA,QCDZ,ICHYE,iBDGZ,cAiCA,OAhCQC,mBAAP,SAAyB90B,GACxB,IAAM+0B,EAAsB/0B,EAAQ20B,GAAkBK,oBAAsB,EAAI,EAC1EC,EAAsBj1B,EAAQ20B,GAAkBO,oBAAsB,EAAI,EAC1EC,EAAyBn1B,EAAQ20B,GAAkBS,yBAA2B,EAAI,EACxF,OAAIp1B,EAAQ20B,GAAkBU,eACtBN,EAAoBE,EAAoBE,EAExCJ,EAAoBE,GAItBH,SAAP,SACC33C,EAAgBmtB,EAAqBtK,EAA0Bj1B,GAkB/D,OAhBAA,EAAOiF,IAAK,EAAImN,EAAQ,GACpB6iB,EAAQ20B,GAAkBU,iBACzBr1B,EAAQ20B,GAAkBW,OAC7BvqD,EAAOiF,IAAKs6B,EAAaA,GACftK,EAAQ20B,GAAkBY,eACpCxqD,EAAOiF,IAAKs6B,EAA2B,GAAdA,GACftK,EAAQ20B,GAAkBa,eACpCzqD,EAAOiF,IAAKs6B,EAA2B,EAAdA,GACftK,EAAQ20B,GAAkBc,OACpC1qD,EAAOiF,IAAmB,EAAds6B,EAAiBA,GACnBtK,EAAQ20B,GAAkBe,eACpC3qD,EAAOiF,IAAmB,EAAds6B,EAA+B,GAAdA,GACnBtK,EAAQ20B,GAAkBgB,gBACpC5qD,EAAOiF,IAAmB,EAAds6B,EAA+B,EAAdA,IAGxBv/B,SClCT,SAAY8pD,GACXA,iBACAA,mBACAA,qBACAA,uBAJD,CAAYA,KAAAA,QCOZ,ICPYe,GCGAC,iBFkBX,WAAat2C,EAA4B8H,EAA6B1Q,EAAcqpB,GACnFx1B,KAAKsrD,GAAUv2C,EACf/U,KAAK6uB,GAAM,EACX7uB,KAAKurD,GAAU,CAAE,EAAG,EAAG,EAAG,GAC1BvrD,KAAKwrD,GAAY,GACjBxrD,KAAK+0B,GAASS,EACdx1B,KAAKyrD,GAAQt/C,EACbnM,KAAKoS,GAAYyK,EAEjB7c,KAAK0rD,GAAehlD,IACpB1G,KAAK2rD,GAAsBjlD,IAC3B1G,KAAK4rD,GAAsBllD,IAC3B1G,KAAK6rD,GAAmBnlD,IA8L1B,OA3LWolD,4BAAV,SAA2B3/C,EAAc0Q,EAA6BkvC,EAAeC,GACpF,GAAI,GAAK7/C,EACR,OAAOA,EAEP,OAAQ0Q,GACR,KAAKwtC,GAAkBl/C,IACvB,KAAKk/C,GAAkBh/C,OACtB,OAAOY,KAAKoT,IAAK2sC,GAClB,KAAK3B,GAAkB5+C,MACvB,KAAK4+C,GAAkB9+C,KACtB,OAAOU,KAAKoT,IAAK0sC,GAElB,OAAO,GAICD,mBAAV,WACC,IAAM3kC,EAAannB,KAAKsrD,GAAQn/C,KAC1B8/C,EAAc9kC,EAAW7hB,EACzB4mD,EAAc/kC,EAAW5hB,EACzBsX,EAAW7c,KAAKoS,GAChBjG,EAAOnM,KAAKyrD,GAClB,GAAIzrD,KAAK0rD,KAAiBv/C,GAAQnM,KAAK2rD,KAAwBM,GAC9DjsD,KAAK4rD,KAAwBM,GAAelsD,KAAK6rD,KAAqBhvC,EAAW,CACjF7c,KAAK6uB,IAAO,EACZ7uB,KAAK0rD,GAAev/C,EACpBnM,KAAK2rD,GAAsBM,EAC3BjsD,KAAK4rD,GAAsBM,EAC3BlsD,KAAK6rD,GAAmBhvC,EACxB,IAAMsvC,EAAqB,GAAdF,EACPG,EAAqB,GAAdF,EACPG,EAAersD,KAAKssD,gBAAiBngD,EAAM0Q,EAAUovC,EAAaC,GAClEK,EAASvsD,KAAKurD,GACpB,OAAQ1uC,GACR,KAAKwtC,GAAkBl/C,IACtBohD,EAAQ,GAAM,EACdA,EAAQ,IAAOH,EACfG,EAAQ,GAAM,EACdA,EAAQ,IAAOH,EAAOC,EACtB,MACD,KAAKhC,GAAkB5+C,MACtB8gD,EAAQ,GAAMJ,EACdI,EAAQ,GAAM,EACdA,EAAQ,GAAMJ,EAAOE,EACrBE,EAAQ,GAAM,EACd,MACD,KAAKlC,GAAkBh/C,OACtBkhD,EAAQ,GAAM,EACdA,EAAQ,GAAMH,EACdG,EAAQ,GAAM,EACdA,EAAQ,GAAMH,EAAOC,EACrB,MACD,KAAKhC,GAAkB9+C,KACtBghD,EAAQ,IAAOJ,EACfI,EAAQ,GAAM,EACdA,EAAQ,IAAOJ,EAAOE,EACtBE,EAAQ,GAAM,KAMjB/sD,sBAAIssD,0BAAJ,WACC,OAAO,mCAGRtsD,sBAAIssD,sBAAJ,WAEC,OADA9rD,KAAKW,SACEX,KAAK6uB,oCAGbrvB,sBAAIssD,0BAAJ,WAEC,OADA9rD,KAAKW,SACEX,KAAKurD,QAGb,SAAYgB,qCAIZ/sD,sBAAIssD,4BAAJ,WACC,OAAO9rD,KAAKwrD,QAGb,SAAcgB,qCAIdhtD,sBAAIssD,wBAAJ,WACC,OAAO9rD,KAAKyrD,QAGb,SAAUt/C,GACTnM,KAAKojD,YAAQ1hD,EAAWyK,OAAMzK,oCAG/BlC,sBAAIssD,4BAAJ,WACC,OAAO9rD,KAAKoS,QAGb,SAAcyK,GACb7c,KAAKojD,OAAQvmC,OAAUnb,OAAWA,oCAGnClC,sBAAIssD,yBAAJ,WACC,OAAO9rD,KAAK+0B,QAGb,SAAWS,GACVx1B,KAAKojD,YAAQ1hD,OAAWA,EAAW8zB,oCAGpCs2B,iBAAA,SAAMz6C,GACL,OAAIA,aAAkBy6C,EACd9rD,KAAKojD,OAAQ/xC,EAAOwL,SAAUxL,EAAOlF,KAAMkF,EAAOmkB,OAElDx1B,KAAKojD,YAAQ1hD,OAAWA,EAAW2P,EAAOmkB,QAInDs2B,gBAAA,SAAKW,EAAsBC,EAAwBC,GAClD,IAAIC,EACAC,EACJ,GAAiB,MAAbJ,EAAoB,CACvB,IAAMjlD,EAAKilD,EAAW,GACtB,GAAW,IAAPjlD,EAAW,CACd,IAAME,EAAK+kD,EAAW,GACtBG,EAAgBllD,GAAM,EAAI2iD,GAAkBl/C,IAAMk/C,GAAkBh/C,OACpEwhD,EAAU5gD,KAAKoT,IAAKotC,EAAW,GAAM/kD,QAErCklD,EAAgBplD,GAAM,EAAI6iD,GAAkB9+C,KAAO8+C,GAAkB5+C,MACrEohD,EAAU5gD,KAAKoT,IAAKotC,EAAW,GAAMjlD,GAGvC,OAAOxH,KAAKojD,OAAQwJ,EAAaC,EAASF,IAGjCb,mBAAV,SAAkBjvC,EAA8B1Q,EAAeqpB,GAC9D,IAAIjyB,GAAY,EAqBhB,OAnBa,MAATiyB,GAAiBx1B,KAAK+0B,KAAWS,IACpCx1B,KAAK+0B,GAASS,EACdjyB,GAAY,GAGG,MAAZsZ,GAAoB7c,KAAKoS,KAAcyK,IAC1C7c,KAAKoS,GAAYyK,EACjBtZ,GAAY,GAGD,MAAR4I,GAAgBnM,KAAKyrD,KAAUt/C,IAClCnM,KAAKyrD,GAAQt/C,EACb5I,GAAY,GAGTA,GACHvD,KAAKsrD,GAAQwB,iBAGP9sD,MAGR8rD,kBAAA,SAAO/2C,GACN,OAAO,IAAI+2C,EAAiB/2C,EAAQ/U,KAAKoS,GAAWpS,KAAKyrD,GAAOzrD,KAAK+0B,KAGtE+2B,qBAAA,SAAUjqC,GAGT,IAFA,IAAMthB,EAAkB,GAClBgsD,EAASvsD,KAAKusD,OACX34C,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,EAAMH,GAAK,EAAI,CACxD,IAAM3O,EAAQ,IAAIunB,QAAO+/B,EAAQ34C,EAAI,GAAK24C,EAAQ34C,EAAI,IACtDrT,EAAOqS,KAAMiP,EAAUqK,MAAOjnB,EAAOA,IAEtC,OAAO1E,GAGRurD,sBAAA,SAAWiB,GACV,OAAOA,EAAQ16B,IAAK,IAAIryB,KAAKoS,OAAapS,KAAKyrD,OAASzrD,KAAK+0B,SAG9D+2B,wBAAA,SAAakB,EAAoBD,GAChC,GAAI,GAAKC,GAAcA,EAAaD,EAAQxe,UAAU57B,OAAS,CAC9D,IAAMs6C,EAAWF,EAAQxe,UAAWye,GAC9BE,EAASvtB,KAAKwtB,MAAOF,GAC3BjtD,KAAKojD,OAAQ8J,EAAQ,GAAKA,EAAQ,GAAKA,EAAQ,YC5NlD,SAAY9B,GACXA,mBACAA,2BACAA,6BACAA,iCACAA,mCACAA,iBACAA,wBACAA,mBACAA,sBACAA,kBAVD,CAAYA,KAAAA,QCGZ,SAAYC,GACXA,mBACAA,iBACAA,qBACAA,uBACAA,mBACAA,iCACAA,mCACAA,wCACAA,yCACAA,kBAVD,CAAYA,KAAAA,QCDZ,ICkBY+B,GCTAC,GAoBAC,iBF7BZ,cAqBA,OApBQC,gBAAwB,EAExBA,aAAqB,SACrBA,aAAqB,GACrBA,eAAuB,QACvBA,oBAA4B,QAC5BA,qBAA6B,SAC7BA,eAAuB,EACvBA,eAAuB,EACvBA,eAAuB,EACvBA,cAAsBlC,GAAiB5D,IACvC8F,aAAqB,GACrBA,cAAsB,OACtBA,YAAoB,GACpBA,SAAiB,GACjBA,SAAiB,IACjBA,SAAiB,IACjBA,SAAiB,IACjBA,mBAA2B,KAAQxsC,OAAOysC,kBAAoB,GAC9DD,kBAA0B,2BGhBjC,aACCvtD,KAAKusD,OAAS,GAiFhB,OA9ECkB,gBAAA,SAAK72B,EAA0BphB,GAC9B,IAAM+2C,EAASvsD,KAAKusD,OACP,MAAT/2C,EACH+2C,EAAOv4C,OAAQwB,EAAO,EAAGohB,GAEzB21B,EAAO35C,KAAMgkB,IAIf62B,mBAAA,SAAQlB,GAGP,IAFA,IAAMmB,EAAUnB,EACVoB,EAAe3tD,KAAKusD,OACjB34C,EAAI,EAAGG,EAAO25C,EAAQ/6C,OAAQiB,EAAIG,IAAQH,EAClD+5C,EAAa/6C,KAAM86C,EAAQ95C,KAI7B65C,oBAAA,SAAS5sD,GAIR,IAHA,IAAM0rD,EAASvsD,KAAKusD,OAGX34C,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,IAAQH,EAEjD,GADc24C,EAAQ34C,KACR/S,EACb,OAAO+S,EAKT,IAASA,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,IAAQH,EAEjD,GADc24C,EAAQ34C,GACZg6C,SAAU/sD,GACnB,OAAO+S,EAIT,OAAQ,GAGT65C,gBAAA,SAAKj4C,GACJ,IAAMjV,EAASP,KAAKusD,OAAQ/2C,GAC5B,OAAc,MAAVjV,EACIA,EAED,MAGRktD,gBAAA,SAAKj4C,EAAeohB,GACnB52B,KAAKusD,OAAQ/2C,GAAUohB,GAGxB62B,mBAAA,SAAQj4C,GACPxV,KAAKusD,OAAOv4C,OAAQwB,EAAO,IAG5Bi4C,kBAAA,WACCztD,KAAKusD,OAAO55C,OAAS,GAGtB86C,iBAAA,WACC,OAAOztD,KAAKusD,OAAO55C,QAGpB86C,iBAAA,SAAMI,EAAgBC,GACrB,IAAMvB,EAASvsD,KAAKusD,OACdwB,EAAMxB,EAAQuB,GACpBvB,EAAQuB,GAAWvB,EAAQsB,GAC3BtB,EAAQsB,GAAWE,GAGpBN,sBAAA,SAAWV,GAGV,IAFA,IAAMxsD,EAAmB,GACnBgsD,EAASvsD,KAAKusD,OACX34C,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,IAAQH,EACjDrT,EAAOqS,KAAM25C,EAAQ34C,GAAIo6C,UAAWjB,IAErC,OAAOxsD,SFlET,SAAY6sD,GACXA,mBACAA,6BACAA,mBACAA,qBACAA,uBACAA,wBACAA,sBACAA,kBARD,CAAYA,KAAAA,QCTZ,SAAYC,GACXA,mBACAA,+BACAA,+BACAA,2BACAA,2BACAA,+BACAA,oCACAA,sDACAA,gCACAA,gDACAA,uBACAA,iCACAA,yBACAA,uBACAA,qBACAA,sBACAA,0BAjBD,CAAYA,KAAAA,QAoBZ,SAAYC,GACXA,mBACAA,yBACAA,yBACAA,mBACAA,eACAA,0BACAA,gCAPD,CAAYA,KAAAA,QAUZ,IErCYW,GCDAC,iBH0DX,WAAaC,GACZ,IAAMtsC,EAAYssC,EAAMtsC,UAClBhF,EAAWgF,EAAUhF,SAC3B7c,KAAKsF,EAAIuX,EAASvX,EAClBtF,KAAKuF,EAAIsX,EAAStX,EAClBvF,KAAKmM,KAAO,IAAIqgB,QAAO2hC,EAAMhiD,KAAK7G,EAAG6oD,EAAMhiD,KAAK5G,GAChDvF,KAAKouD,SAAWvsC,EAAUusC,SAC1BpuD,KAAKquD,QAAU,GACfruD,KAAKiwB,KAAOk+B,EAAMl+B,KAAKq+B,WACvBtuD,KAAKuuD,OAASJ,EAAMI,OAAOD,WAC3BtuD,KAAK2sB,KAAOwhC,EAAMxhC,KAAK2hC,WACvBtuD,KAAKwuD,OAASL,EAAMK,OACpBxuD,KAAKyuD,MAAQpB,GAAmBppC,KAChCjkB,KAAK0uD,QAAUrB,GAAmBppC,KAClCjkB,KAAK2uD,OAASjoD,IACd1G,KAAKyB,MAAQ6rD,GAAmBrpC,KAChCjkB,KAAKmkB,aAAc,EA4JrB,OAzJCyqC,2BAAA,SAAgBT,EAAel4C,GACxBk4C,EAAMU,UACJ7uD,KAAKyB,MAAQ6rD,GAAmBwB,UACtC9uD,KAAKyB,OAAS6rD,GAAmByB,QAAUzB,GAAmBwB,QAC9DzuD,EAAcM,WAKjBiuD,8BAAA,SAAmBT,EAAel4C,GACjC,OAAO,GAGR24C,0BAAA,SAAeT,EAAel4C,GAC7Bk4C,EAAMa,SAAU,GAGjBJ,yBAAA,SAAcT,EAAel4C,GAC5Bk4C,EAAMa,SAAU,GAGjBJ,0BAAA,SAAeT,EAAel4C,GACtBjW,KAAKyB,MAAQ6rD,GAAmB2B,OACtCjvD,KAAKyB,OAAS6rD,GAAmByB,QAAUzB,GAAmB2B,KAAO3B,GAAmBx8C,QACxFzQ,EAAcM,UAEf,IAAM0X,EAAkBW,EAAasP,qBACrCjQ,EAAgBO,WAAYP,EAAgB8S,oBAAqBgjC,IAAS,GAAM,IAGjFS,wBAAA,SAAaT,EAAel4C,GACpBjW,KAAKyB,MAAQ6rD,GAAmB4B,KACtClvD,KAAKyB,OAAS6rD,GAAmByB,QAAUzB,GAAmB4B,GAC9DlvD,KAAKyB,QAAU6rD,GAAmBx8C,QAClCzQ,EAAcM,WAIhBiuD,0BAAA,SAAeT,EAAel4C,KAI9B24C,sBAAA,SAAWT,EAAel4C,GAIzB,OAHID,EAAkB4nB,cAAe3nB,IACpCjW,KAAKmvD,cAAehB,IAEd,GAGRS,oBAAA,SAAST,EAAel4C,GAKvB,OAJID,EAAkB4nB,cAAe3nB,KACpCjW,KAAKovD,YAAajB,GAClBnuD,KAAKqvD,eAAgBlB,KAEf,GAGRS,0BAAA,SAAeT,EAAerlC,EAAsBE,GACnDhpB,KAAKyB,OAAS6rD,GAAmByB,QACjC1uD,EAAcM,UAGfiuD,mBAAA,SAAQT,EAAe5a,GACtB,IAAM+b,EAAMnB,EAAMmB,IACZC,EAAmBvvD,KAAK2uD,QAAUpb,GACpC+b,EAAI/rD,WAAcvD,KAAKyB,MAAQ6rD,GAAmByB,SAAYQ,KAC7DA,IACHvvD,KAAK2uD,OAASjoD,KAEfynD,EAAMqB,yBACNxvD,KAAKoN,SAAU+gD,EAAO5a,GACtB4a,EAAMsB,sBACNzvD,KAAKyB,OAAS6rD,GAAmBoC,WACjCJ,EAAI/rD,WAAY,IAIRqrD,qBAAV,SAAoBT,EAAe5a,GAC9B,EAAIvzC,KAAKquD,QAAQ17C,SACpB3S,KAAK2vD,eAAgBxB,EAAO5a,GAC5BvzC,KAAK4vD,yBAA0BzB,KAIvBS,2BAAV,SAA0BT,EAAe5a,GACxCvzC,KAAK0uD,QAAUrB,GAAmBppC,KAElC,IADA,IAAMoqC,EAAUruD,KAAKquD,QACZz6C,EAAI,EAAGG,EAAOs6C,EAAQ17C,OAAQiB,EAAIG,IAAQH,EAClDy6C,EAASz6C,GAAID,QAASw6C,EAAOnuD,KAAMuzC,IAI3Bqb,qCAAV,SAAoCT,GACnC,IAAMttD,GAAWb,KAAK0uD,QAAW1uD,KAAKyuD,MACtC,GAAI5tD,IAAWwsD,GAAmBppC,KAAO,CAUxC,GATIpjB,EAASwsD,GAAmBwC,aAC/B1B,EAAMtsC,UAAUhF,SAASvX,EAAItF,KAAKsF,GAE/BzE,EAASwsD,GAAmByC,aAC/B3B,EAAMtsC,UAAUhF,SAAStX,EAAIvF,KAAKuF,GAE/B1E,EAASwsD,GAAmB0C,aAC/B5B,EAAM3+C,SAAU,GAEb3O,EAASwsD,GAAmB2C,WAAa,CAC5C,IAAM//B,EAAOjwB,KAAKiwB,KAClBk+B,EAAMl+B,KAAKzqB,SACV9D,EACAuuB,EAAK5uB,MACL4uB,EAAK1uB,OAGP,GAAIV,EAASwsD,GAAmB4C,aAAe,CAC9C,IAAM1B,EAASvuD,KAAKuuD,OACpBJ,EAAMI,OAAO/oD,SACZ9D,EACA6sD,EAAOltD,MACPktD,EAAOhtD,OAGT,GAAIV,EAASwsD,GAAmB6C,WAAa,CAC5C,IAAMvjC,EAAO3sB,KAAK2sB,KAClBwhC,EAAMxhC,KAAKnnB,SACV9D,EACAirB,EAAKtrB,MACLsrB,EAAKprB,OAGP,GAAIV,EAASwsD,GAAmB8C,mBAAqB,CACpD,IAAM1sD,EAAUzD,KAAK2sB,KAAKlpB,QAC1B0qD,EAAMxhC,KAAKlpB,QAAQ+B,SAClB9D,EACA+B,EAAQpC,MACRoC,EAAQlC,OAGNV,EAASwsD,GAAmB+C,SAC/BjC,EAAMhiD,KAAK5G,EAAIvF,KAAKmM,KAAK5G,GAEtB1E,EAASwsD,GAAmBgD,QAC/BlC,EAAMhiD,KAAK7G,EAAItF,KAAKmM,KAAK7G,GAEtBzE,EAASwsD,GAAmBiD,WAC/BnC,EAAMtsC,UAAUusC,SAAWpuD,KAAKouD,UAE7BvtD,EAASwsD,GAAmBxwB,OAC/BsxB,EAAMxhC,KAAKiK,MAAQ52B,KAAK2sB,KAAKiK,OAE1B/1B,EAASwsD,GAAmBkD,SAC/BpC,EAAMK,OAASxuD,KAAKwuD,8BI/MvB,WAAaz5C,GAAb,MACC/O,0BACAG,EAAKqqD,kBAAoB,IAAI/X,SAC7BtyC,EAAKmlD,GAAUv2C,IAoDjB,OA3DyCjV,OAU9B2wD,qBAAV,WACEC,YAAUxwD,UAAkB0B,SAASK,KAAMjC,MAC5CA,KAAKsrD,GAAQqF,qBAGJF,uBAAV,WACEC,YAAUxwD,UAAkB0wD,WAAW3uD,KAAMjC,MAC9CA,KAAKsrD,GAAQqF,qBAGdF,8BAAA,WACC,OAAQzwD,KAAa6wD,iBAGtBJ,uBAAA,WACC,OAAQzwD,KAAa8wD,UAGtBL,wBAAA,WACC,OAAQzwD,KAAa+wD,WAGtBN,uBAAA,WACC,OAAQzwD,KAAagxD,UAGtBP,4BAAA,SAAiBQ,GAChB,IAAMC,EAAclxD,KAAa6wD,gBAC3BM,EAAcnxD,KAAagxD,SACjChrD,YAAM0lB,0BAAiBulC,GACvB,IAAMG,EAAcpxD,KAAa6wD,gBAC3BQ,EAAcrxD,KAAagxD,SACjC,GAAIE,IAAeE,EAAa,CAC/B,IAAM71B,EAAiBv7B,KAAKu7B,eACtBi1B,EAAoBxwD,KAAKwwD,kBAC/Bj1B,EAAe+1B,OAAQd,GACnBS,aAA2BR,GAC9BD,EAAkBe,QAASN,EAAgBT,wBAElCW,IAAeE,IACnB91B,EAAiBv7B,KAAKu7B,eACtBi1B,EAAoBxwD,KAAKwwD,kBAC3BS,aAA2BR,IAC9Bl1B,EAAe+1B,OAAQd,GAAoBe,QAASN,EAAgBT,mBACnExwD,KAAa6wD,iBAAmB,EAChC7wD,KAAa8wD,SAAY9wD,KAAa6wD,sBAvDFH,2BCdzC,cAiFA,OAhFQc,oBAAP,SAA0BC,GAGzB,IAFA,IAAMC,EAASD,EAASC,OACpBnxD,EAAS,IAAIkxD,EAASp8C,UACjBzB,EAAI,EAAGG,EAAO29C,EAAO/+C,OAAQ6H,EAAI,EAAG5G,EAAIG,EAAMH,GAAK,EAAG4G,GAAK,EAAI,CACvE,IAAMvV,EAAQysD,EAAQ99C,GACtBrT,GAAU,IAAI0E,EAAM5D,UAAS4D,EAAM1D,UAAS0D,EAAM4X,SAGnD,OADAtc,EAAU,KAIJixD,gBAAP,SAAsB3wD,GACrB,IACC,OAAO8+B,KAAKwtB,MAAOtsD,GAClB,MAAOoV,GACR,OAAO,OAIFu7C,sBAAP,SAA4B3wD,GAC3B,IAAMqsD,EAASltD,KAAK2xD,cAAe9wD,GACnC,KAAc,MAAVqsD,GAAkBA,EAAOv6C,OAAS,GAAtC,CAKC,IAFA,IAAM0C,EAAY63C,EAAQ,GACpBwE,EAAoC,GACjC99C,EAAI,EAAGG,EAAOm5C,EAAOv6C,OAAQiB,EAAIG,EAAMH,GAAK,EACpD89C,EAAO9+C,KAAK,CACXvR,MAAO6rD,EAAQt5C,EAAI,GACnBrS,MAAO2rD,EAAQt5C,EAAI,GACnBiJ,SAAUqwC,EAAQt5C,EAAI,KAGxB,MAAO,CACN89C,SACAr8C,eAKIm8C,eAAP,SAAqBC,EAA0C1E,GAC9D,OAAgB,MAAZ0E,GACwB,MAAvBA,EAASG,aACZH,EAASG,WAAa5xD,KAAK6xD,kBAAmBJ,IAExC1E,EAAQ16B,IAAKo/B,EAASG,cAEtB,GAGFJ,qBAAP,SAA2BC,GAK1B,IAJA,IAAMp8C,EAAYo8C,EAASp8C,UACrBq8C,EAASD,EAASC,OAEpBI,EAAQ,GACHl+C,EAAI,EAAGG,EAAO29C,EAAO/+C,OAAQiB,EAAIG,IAAQH,EAAI,CACrD,IAAM3O,EAAQysD,EAAQ99C,GAChBvS,EAAQu8C,GAAQmU,OAAQ9sD,EAAM5D,OAC9BE,EAAQ0D,EAAM1D,MAEpBuwD,GAAS,iBADuB,IAAjB7sD,EAAM4X,4BAC8Bxb,qBAAwBE,SAG5E,IAAMywD,EAAS38C,EAAYpJ,KAAKgmD,GAAK,IAC/B7yC,EAAK,GAAMnT,KAAKimD,IAAKF,GACrB1yC,GAAM,GAAMrT,KAAKkmD,IAAKH,GAa5B,MAXY,6BAA+BnmD,KAC1C,qIAE6C,GAAMuT,aAAW,GAAMA,aAAW,GAAME,aAAW,GAAMA,QACnGwyC,EACD,4ICIJ,WAAan3C,GAAb,MACC3U,0BACAG,EAAK0qB,GAAK,GACV1qB,EAAKwU,KAAOA,EACZxU,EAAK0b,UAAY1b,EAAKisD,eACtBjsD,EAAKksD,GAAyB,EAC9BlsD,EAAKmsD,IAAwB,EAC7BnsD,EAAKosD,OAAS,IAAI9E,GAClBtnD,EAAKqsD,IAAW,EAChBrsD,EAAKssD,GAAsB,EAC3BtsD,EAAKusD,IAAqB,EAC1BvsD,EAAKwsD,IAAgC,EAErCxsD,EAAKysD,GAAqBlsD,IAC1BP,EAAK0sD,GAA6BnsD,IAClCP,EAAK2sD,GAA0BpsD,IAE/BP,EAAK6d,GAAS7d,EAAK+d,GAAc1gB,EAAWyR,YAC5C9O,EAAKge,aAAc,EAGnBhe,EAAK4O,OAAS,KACd5O,EAAKsP,SAAW,GAGhBtP,EAAK4sD,UAAW,EAChB5sD,EAAKqP,MAAQ,EACbrP,EAAK6sD,UAAY,IAmuBnB,OAvzByClzD,OAuF9BmzD,yBAAV,WACC,OAAO,IAAIxC,GAAqBzwD,OAGjCizD,yBAAA,WACCjzD,KAAK4yD,GAAqBlsD,IAC1B1G,KAAK6yD,GAA6BnsD,IAClC1G,KAAK8yD,GAA0BpsD,IAE/B1G,KAAKkzD,KACLlzD,KAAK8sD,kBAGNmG,8BAAA,WACCjzD,KAAKkzD,KACLlzD,KAAKmzD,6BAGIF,eAAV,WACC,GAAoC,IAAhCjzD,KAAKqyD,GAA+B,CACvC,IAAM98C,EAASvV,KAAK+U,OACN,MAAVQ,GACHA,EAAO69C,8BAGRpzD,KAAKsyD,IAAwB,GAI/BW,sCAAA,WACCjzD,KAAKqyD,IAA0B,EACK,IAAhCryD,KAAKqyD,KACRryD,KAAKsyD,IAAwB,IAI/BW,mCAAA,SAAwBI,GACvBrzD,KAAKqyD,IAA0B,EACK,IAAhCryD,KAAKqyD,IACJryD,KAAKsyD,KACRtyD,KAAKsyD,IAAwB,EACzBe,GACHrzD,KAAK2wD,sBAMTsC,mCAAA,aAIAA,mCAAA,WACCjzD,KAAKyyD,IAAuB,EACK,IAA7BzyD,KAAKyyD,KACRzyD,KAAK0yD,IAAqB,EAC1B1yD,KAAK2yD,IAAgC,IAIvCM,gCAAA,WACCjzD,KAAKyyD,IAAuB,EACK,IAA7BzyD,KAAKyyD,KACJzyD,KAAK2yD,IACR3yD,KAAK2yD,IAAgC,EACrC3yD,KAAK0yD,IAAqB,EAC1B1yD,KAAKmzD,6BACKnzD,KAAK0yD,KACf1yD,KAAK0yD,IAAqB,EAC1B1yD,KAAK8sD,oBAKRmG,sCAAA,WACC,GAAiC,IAA7BjzD,KAAKyyD,GAA4B,CACpCzyD,KAAK8sD,iBAEL,IADA,IAAMr3C,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIu/C,iCAGfnzD,KAAK2yD,IAAgC,GAIvCM,2BAAA,WACC,GAAiC,IAA7BjzD,KAAKyyD,GAA4B,CACpC,IAAMa,EAAWtzD,KAAKszD,SACN,MAAZA,GACHA,EAAS3yD,OAAQX,WAGlBA,KAAK0yD,IAAqB,GAK5BlzD,sBAAIyzD,wBAAJ,WAEC,IADA,IAAIM,EAAevzD,KACZuzD,EAAKx+C,kBAAkBk+C,GAC7BM,EAAOA,EAAKx+C,OAEb,OAAOw+C,mCAIR/zD,sBAAIyzD,2BAAJ,WACC,IAAMl+C,EAAS/U,KAAK+U,OACpB,OAAIA,aAAkBk+C,EACdl+C,EAAOvF,SAAWxP,KAAKwyD,GAEvBxyD,KAAKwyD,QAId,SAAahjD,GACRxP,KAAKwyD,KAAahjD,IACrBxP,KAAKwyD,GAAWhjD,EAChBxP,KAAKmzD,8DAQPF,oBAAA,WACC,IAAMl+C,EAAS/U,KAAK+U,OACN,MAAVA,GACHA,EAAOwO,WAKT0vC,mBAAA,SAAQl+C,EAAkCy+C,GACzCxzD,KAAKyzD,SACLzzD,KAAK+U,OAASA,EACd,IAAMU,EAAWV,EAAOU,SASxB,OARU,MAAN+9C,GAAc,GAAKA,GAAMA,EAAK/9C,EAAS9C,OAC1C8C,EAASzB,OAAQw/C,EAAI,EAAGxzD,MAExByV,EAAS7C,KAAM5S,MAEhBA,KAAKszD,cAAW5xD,EAChBqT,EAAOq+C,yBACPr+C,EAAOwO,UACAvjB,MAGRizD,mBAAA,WACC,IAAMl+C,EAAS/U,KAAK+U,OACpB,GAAc,MAAVA,EAAiB,CACpB/U,KAAK+U,OAAS,KACd/U,KAAKszD,cAAW5xD,EAChB,IAAM+T,EAAWV,EAAOU,SAClBD,EAAQC,EAASC,QAAS1V,MAC5B,GAAKwV,IACRC,EAASzB,OAAQwB,EAAO,GACxBT,EAAOq+C,yBACPr+C,EAAOwO,WAGT,OAAOvjB,MAIRizD,4BAAA,WACC,IAAMl+C,EAAS/U,KAAK+U,OACN,MAAVA,GACHA,EAAO2W,kBACP1rB,KAAK6hB,UAAU6J,gBAAgB3W,EAAO8M,YAEtC7hB,KAAK6hB,UAAU6J,gBAAiBglC,YAAkBgD,WAKpDT,8BAAA,SAAmBlG,GAGlB,IAFA,IAAMt3C,EAAWzV,KAAKyV,SAChBk+C,EAAqB,GAClB//C,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAG,CACtD,IAAMuS,EAAQ1Q,EAAS7B,GACvB+/C,EAAmB/gD,KAAKuT,EAAM6nC,UAAUjB,IAEzC,OAAO4G,GAGRV,2BAAA,SAAgBlG,GACf,IAAMhzB,EAAQ/5B,KAAK+5B,MACnB,OAAiB,MAATA,EAAgBgzB,EAAQ16B,IAAK0H,EAAMuG,MAAS,GAGrD2yB,8BAAA,SAAmBlG,GAClB,OAAOyE,GAAgBoC,aAAc5zD,KAAKyxD,SAAU1E,IAGrDkG,sBAAA,SAAWlG,GACV,IAAMlrC,EAAY7hB,KAAK6hB,UACjBhF,EAAWgF,EAAUhF,SACrBg3C,EAAQhyC,EAAUgyC,MAClB1nD,EAAOnM,KAAKmM,KACZ6K,EAAWhX,KAAKgX,SAChB88C,EAA2B,MAAZ98C,EAAmB+1C,EAAQ16B,IAAKrb,IAAc,EAC7D0N,EAAQ1kB,KAAK0kB,MACbqvC,EAAqB,MAATrvC,EAAgBqoC,EAAQ16B,IAAK3N,IAAW,EAC1D,MAAO,CACN1kB,KAAK2a,KACLoyC,EAAQ16B,IAAIryB,KAAK6wB,IACjBhU,EAASvX,EACTuX,EAAStX,EACT4G,EAAK7G,EACL6G,EAAK5G,EACLsc,EAAUusC,SACVvsC,EAAUO,KAAK9c,EACftF,KAAKiwB,KAAK+9B,UAAWjB,GACrB/sD,KAAKuuD,OAAOP,UAAWjB,GACvBA,EAAQ16B,IAAKryB,KAAKwuD,OAAO53C,QACzB5W,KAAK2sB,KAAKqhC,UAAWjB,GACrB/sD,KAAKsvD,IAAItB,UAAWjB,GACpB/sD,KAAKmD,OACLnD,KAAKiD,QACJ,GACA,EACDjD,KAAKuyD,OAAOvE,UAAWjB,GACvB/sD,KAAKg0D,eAAgBjH,GACrB/sD,KAAK6xD,kBAAmB9E,GACxB/sD,KAAKi0D,kBAAmBlH,GACxB8G,EAAMvuD,EACNuuD,EAAMtuD,GACJvF,KAAKmkB,YAAc,EAAI,IAAQnkB,KAAKk0D,YAAc,EAAI,GACxDJ,EACAC,IAKFd,qBAAA,SAAUhuD,GACT,IAAMK,EAAIL,EAAMK,EACVC,EAAIN,EAAMM,EACV4G,EAAOnM,KAAKmM,KACZgoD,EAAK,GAAMhoD,EAAK7G,EAChB8uD,EAAK,GAAMjoD,EAAK5G,EAChBsuD,EAAQ7zD,KAAK6hB,UAAUgyC,MACvBz0C,EAAK9Z,EAAIuuD,EAAMvuD,EACfga,EAAK/Z,EAAIsuD,EAAMtuD,EACfgpD,EAASvuD,KAAKuuD,OACdx0C,EAAIw0C,EAAOnsD,MAAQmsD,EAAOjsD,MAChC,GAAI,GAAK6xD,GACR,GAAI,GAAKC,GACR,GAAIp0D,KAAKq0D,aAAaj1C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,GAC7C,OAAO/Z,UAGR,GAAIA,KAAKq0D,aAAaj1C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,GAC7C,OAAO/Z,UAIT,GAAI,GAAKo0D,GACR,GAAIp0D,KAAKq0D,aAAaj1C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,GAC7C,OAAO/Z,UAGR,GAAIA,KAAKq0D,aAAaj1C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,GAC7C,OAAO/Z,KAKV,OAAOA,KAAKs0D,aAAchvD,EAAGC,EAAGN,IAC/BjF,KAAKu0D,iBAAkBjvD,EAAGC,EAAGN,IAGrBguD,yBAAV,SAAwB3tD,EAAWC,EAAWymB,GAC7C,IAAMW,EAAO3sB,KAAK2sB,KAElB,GAAiB,MADCA,EAAKC,MACC,CACvB,IAAM4nC,EAAY7nC,EAAK8nC,MACvB,GAAiB,MAAbD,EAAoB,CACvBxoC,EAAKxmB,IAAKF,EAAGC,GACbvF,KAAK6hB,UAAU2uC,kBAAkBtkC,MAAOF,EAAMA,GAC9C,IAAM0oC,EAAK1oC,EAAK1mB,EAAIkvD,EAAW,GACzBG,EAAK3oC,EAAKzmB,EAAIivD,EAAW,GACzBI,EAAKJ,EAAW,GAAME,EAAKF,EAAW,GAAMG,EAC5CE,EAAKL,EAAW,GAAME,EAAKF,EAAW,GAAMG,EAClD,GAAI,GAAKC,GAAMA,GAAMJ,EAAW,IAAO,GAAKK,GAAMA,GAAML,EAAW,GAClE,OAAOx0D,MAIV,OAAO,MAGEizD,6BAAV,SAA4B3tD,EAAWC,EAAWymB,GAEjD,IADA,IAAMvW,EAAWzV,KAAKyV,SACb7B,EAAI6B,EAAS9C,OAAS,EAAG,GAAKiB,IAAKA,EAAI,CAC/C,IAAMuS,EAAQ1Q,EAAU7B,GACxBoY,EAAKxmB,IAAKF,EAAGC,GACb4gB,EAAMuF,kBACNvF,EAAMtE,UAAU0Z,eAAehP,aAAcP,EAAMA,GACnD,IAAM8oC,EAAc3uC,EAAMjH,SAAU8M,GACpC,GAAmB,MAAf8oC,EACH,OAAI90D,KAAK+0D,SACD/0D,KAEA80D,EAIV,OAAO,MAGR7B,yBAAA,SAAchuD,GACb,IAAMK,EAAIL,EAAMK,EACVC,EAAIN,EAAMM,EACV4G,EAAOnM,KAAKmM,KACZgoD,EAAK,GAAMhoD,EAAK7G,EAChB8uD,EAAK,GAAMjoD,EAAK5G,EAChBsuD,EAAQ7zD,KAAK6hB,UAAUgyC,MACvBz0C,EAAK9Z,EAAIuuD,EAAMvuD,EACfga,EAAK/Z,EAAIsuD,EAAMtuD,EACfgpD,EAASvuD,KAAKuuD,OACdx0C,EAAIw0C,EAAOnsD,MAAQmsD,EAAOjsD,MAChC,OAAI,GAAK6xD,EACJ,GAAKC,EACDp0D,KAAKg1D,iBAAiB51C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,GAE9C/Z,KAAKg1D,iBAAiB51C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,GAGlD,GAAKq6C,EACDp0D,KAAKg1D,iBAAiB51C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,GAE9C/Z,KAAKg1D,iBAAiB51C,GAAKE,GAAK60C,EAAKp6C,GAAIq6C,EAAKr6C,IAKxDk5C,wBAAA,SAAa3tD,EAAWC,EAAW0vD,EAAYC,GAC9C,OAAOl1D,KAAKg1D,gBAAiB1vD,EAAGC,EAAG0vD,EAAIC,IAGxCjC,4BAAA,SAAiB3tD,EAAWC,EAAW0vD,EAAYC,GAClD,OAASD,GAAM3vD,GAAKA,IAAM2vD,IAAOC,GAAM3vD,GAAKA,IAAM2vD,GAGnDjC,mBAAA,SAAQhuD,GACP,OAAO,GAIRguD,qBAAA,SAAUp2C,EAAkB5X,EAAckwD,GAMzC,OALmB,IAAfA,GACHn1D,KAAK0rB,kBAENzmB,EAAMQ,SAAUoX,GAChB7c,KAAK6hB,UAAUgK,eAAeK,MAAOjnB,EAAOA,GACrCA,GAGRguD,oBAAA,SACCp2C,EACAhQ,EACA5H,EACAkwD,GAUA,OARmB,IAAfA,GACHn1D,KAAK0rB,uBAEQhqB,IAAVuD,IACHA,EAAQ,IAAIunB,SAEbvnB,EAAMQ,SAAUoX,GAChB7c,KAAK6hB,UAAUgK,eAAeU,aAActnB,EAAcA,GACnDA,GAGRguD,sBAAA,SAAWjnC,EAAampC,EAAqB50D,IACzB,IAAf40D,GACHn1D,KAAK0rB,kBAEN,IAAMI,EAAS9rB,KAAK+rB,QAAY/rB,KAAK+rB,SAAW,IAAI8O,YAC9Cu6B,EAAUp1D,KAAK6hB,UAAUwzC,aAM/B,OALID,IAAYp1D,KAAK4yD,KACpB5yD,KAAK4yD,GAAqBwC,EAC1Bp1D,KAAKs1D,GAAYt1D,KAAK6hB,UAAUgK,eAAgBG,EAAMF,IAEvDvrB,EAAOkF,SAAUqmB,GACVvrB,GAGR0yD,8BAAA,SAAmBjnC,EAAampC,EAAqB50D,IACjC,IAAf40D,GACHn1D,KAAK0rB,kBAEN,IAAM6pC,EAAiBv1D,KAAKw1D,GAAoBx1D,KAAKw1D,IAAmB,IAAI36B,YACtE46B,EAAiBz1D,KAAK6hB,UAAU6zC,oBAMtC,OALID,IAAmBz1D,KAAK6yD,KAC3B7yD,KAAK6yD,GAA6B4C,EAClCz1D,KAAKs1D,GAAYt1D,KAAK6hB,UAAU2uC,kBAAmBxkC,EAAMupC,IAE1Dh1D,EAAOkF,SAAU8vD,GACVh1D,GAGR0yD,2BAAA,SAAgBjnC,EAAampC,EAAqB50D,IAC9B,IAAf40D,GACHn1D,KAAK0rB,kBAEN,IAAMiqC,EAAc31D,KAAK41D,GAAiB51D,KAAK41D,IAAgB,IAAI/6B,YAC7D46B,EAAiBz1D,KAAK6hB,UAAU6zC,oBAMtC,OALID,IAAmBz1D,KAAK8yD,KAC3B9yD,KAAK8yD,GAA0B2C,EAC/Bz1D,KAAKs1D,GAAYt1D,KAAK6hB,UAAU0Z,eAAgBvP,EAAM2pC,IAEvDp1D,EAAOkF,SAAUkwD,GACVp1D,GAGE0yD,0BAAV,WACC,OAAOjzD,KAAKmM,MAGH8mD,eAAV,SAAsBpxC,EAAmBmK,EAAazrB,GACrD,IAAMszD,EAAQ7zD,KAAK6hB,UAAUgyC,MACvBgC,EAAKhC,EAAMvuD,EACXwwD,EAAKjC,EAAMtuD,EACX4G,EAAOnM,KAAK+1D,gBACZ5B,EAAK,GAAMhoD,EAAK7G,EAChB8uD,EAAK,GAAMjoD,EAAK5G,EAEhBioB,EAAI3L,EAAU2L,EACdjuB,EAAIsiB,EAAUtiB,EACdwI,EAAI8Z,EAAU9Z,EACdzI,EAAIuiB,EAAUviB,EAEhBgG,GAAK6uD,EAAK0B,EACVtwD,GAAK6uD,EAAK0B,EACRtuD,EAAKgmB,EAAIloB,EAAIyC,EAAIxC,EACjBmC,EAAKnI,EAAI+F,EAAIhG,EAAIiG,EAIjBkC,EAAK+lB,GAFXloB,GAAK6uD,EAAK0B,GAES9tD,GADnBxC,GAAK6uD,EAAK0B,GAEJnuD,EAAKpI,EAAI+F,EAAIhG,EAAIiG,EAIjBsD,EAAK2kB,GAFXloB,GAAK6uD,EAAK0B,GAES9tD,GADnBxC,GAAK6uD,EAAK0B,GAEJ/sD,EAAKxJ,EAAI+F,EAAIhG,EAAIiG,EAIjBuD,EAAK0kB,GAFXloB,GAAK6uD,EAAK0B,GAES9tD,GADnBxC,GAAK6uD,EAAK0B,GAEJ9sD,EAAKzJ,EAAI+F,EAAIhG,EAAIiG,EAEjBywD,EAAO/pD,KAAK0iB,IAAKnnB,EAAIC,EAAIoB,EAAIC,GAC7BmtD,EAAOhqD,KAAK0iB,IAAKjnB,EAAIC,EAAIoB,EAAIC,GAC7BktD,EAAOjqD,KAAKC,IAAK1E,EAAIC,EAAIoB,EAAIC,GAC7BqtD,EAAOlqD,KAAKC,IAAKxE,EAAIC,EAAIoB,EAAIC,GAKnC,OAJAzI,EAAO+E,EAAI0wD,EAAOn0C,EAAU6yC,GAC5Bn0D,EAAOgF,EAAI0wD,EAAOp0C,EAAU8yC,GAC5Bp0D,EAAO6B,MAAQ8zD,EAAOF,EACtBz1D,EAAOsF,OAASswD,EAAOF,EAChB11D,GAIR0yD,oBAAA,WAEC,IADA,IAAMx9C,EAAWzV,KAAKyV,SACb7B,EAAI6B,EAAS9C,OAAS,EAAG,GAAKiB,IAAKA,EAC3C6B,EAAU7B,GAAIC,UAEf4B,EAAS9C,OAAS,GAITsgD,wBAAV,WACC,IAAMl+C,EAAS/U,KAAK+U,OACd8T,EAAa7oB,KAAKkkB,GAClB4E,EAAa/T,aAAkBk+C,EACpCjzD,KAAK+oB,WAAYF,EAAY9T,EAAOqhD,YACpCvtC,EAEKG,EAAWhpB,KAAKgkB,GAClBgF,IAAaF,IAChB9oB,KAAKgkB,GAAS8E,EACd9oB,KAAKipB,cAAeH,EAAUE,KAItBiqC,uBAAV,SAAsBpqC,EAAwBK,GAC7C,OAAOL,EAAcK,EAAc1lB,EAAWqN,UAC5CqY,GAAe1lB,EAAWiN,QAAUjN,EAAWkN,YAAclN,EAAWkN,WAAalN,EAAWygB,OAGzFgvC,0BAAV,SAAyBnqC,EAAkBE,GAC1C,IAAMqtC,EAAUr2D,KAAKq2D,QACN,MAAXA,GACHA,EAAQptC,cAAejpB,KAAM8oB,EAAUE,GAIxC,IADA,IAAMvT,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMuS,EAAQ1Q,EAAU7B,GACpBuS,aAAiB8sC,GACpB9sC,EAAMgD,oBAAqBL,EAAUE,KAK9BiqC,gCAAV,SAA+B1pC,EAAwBC,GACtD,IAAMV,EAAW9oB,KAAK+oB,WAAY/oB,KAAKkkB,GAAaqF,GAC9CP,EAAWhpB,KAAKgkB,GAClBgF,IAAaF,IAChB9oB,KAAKgkB,GAAS8E,EACd9oB,KAAKipB,cAAeH,EAAUE,KAIhCiqC,qBAAA,WACC,OAAOjzD,KAAKgkB,IAGbivC,qBAAA,SAAUxxD,EAAmB+mB,GAS5B,OARInY,EAAYC,GAAItQ,KAAKkkB,GAAaziB,KAAY+mB,IAC7CA,EACHxoB,KAAKkkB,IAAeziB,EAEpBzB,KAAKkkB,KAAgBziB,EAEtBzB,KAAK2lB,eAEC3lB,MAGRizD,qBAAA,SAAUxxD,GACT,OAAO4O,EAAYC,GAAItQ,KAAKgkB,GAAQviB,IAGrCwxD,kBAAA,WAEC,OADAjzD,KAAKsY,SAAU,EACRtY,MAGRizD,iBAAA,WAEC,OADAjzD,KAAKsY,SAAU,EACRtY,MAGRR,sBAAIyzD,2BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAW+M,cAGlC,SAAamX,GACZ1nB,KAAKuR,SAAU/N,EAAW+M,QAASmX,oCAGpCloB,sBAAIyzD,0BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAWmN,aAGlC,SAAYmX,GACX9nB,KAAKuR,SAAU/N,EAAWmN,OAAQmX,oCAGnCtoB,sBAAIyzD,4BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAWuN,gBAGlC,SAAciX,GACbhoB,KAAKuR,SAAU/N,EAAWuN,UAAWiX,oCAGtCxoB,sBAAIyzD,2BAAJ,WACC,OAASjzD,KAAKgV,SAAUxR,EAAWqN,2CAGpCrR,sBAAIyzD,4BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAWqN,eAGlC,SAAcoX,GACbjoB,KAAKuR,SAAU/N,EAAWqN,SAAUoX,oCAGrCzoB,sBAAIyzD,4BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAWgN,eAGlC,SAAc0X,GACbloB,KAAKuR,SAAU/N,EAAWgN,SAAU0X,oCAGrC1oB,sBAAIyzD,2BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAWiN,cAGlC,SAAa6H,GACRtY,KAAKsY,UAAYA,GACpBU,EAAasP,qBAAqB1P,WAAY5Y,KAAMsY,GAAS,oCAI/D9Y,sBAAIyzD,6BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAWiN,QAAUjN,EAAWkN,6CAGvDlR,sBAAIyzD,+BAAJ,WACC,OAAOjzD,KAAKgV,SAAUxR,EAAWyR,kBAGlC,SAAiBqhD,GAChBt2D,KAAKuR,SAAU/N,EAAWyR,YAAaqhD,oCAGxC92D,sBAAIyzD,2BAAJ,WACC,IAAMoD,EAAUr2D,KAAKq2D,QACrB,SAAYA,GAAYA,EAAQ50D,MAAQ6rD,GAAmBwB,0CAG5DtvD,sBAAIyzD,2BAAJ,WACC,IAAMoD,EAAUr2D,KAAKq2D,QACrB,SAAYA,GAAYA,EAAQ50D,MAAQ6rD,GAAmBx8C,0CAG5DtR,sBAAIyzD,wBAAJ,WACC,IAAMoD,EAAUr2D,KAAKq2D,QACrB,SAAYA,GAAYA,EAAQ50D,MAAQ6rD,GAAmB2B,uCAG5DzvD,sBAAIyzD,sBAAJ,WACC,IAAMoD,EAAUr2D,KAAKq2D,QACrB,SAAYA,GAAYA,EAAQ50D,MAAQ6rD,GAAmB4B,qCAG5D1vD,sBAAIyzD,4BAAJ,WACC,OAAO,mCAGRA,uBAAA,SAAYh9C,GACX,IAAMogD,EAAUr2D,KAAKq2D,QACrB,OAAe,MAAXA,GACIA,EAAQE,kBAAmBv2D,OAKpCizD,uBAAA,SAAYh9C,GACX,IAAMogD,EAAUr2D,KAAKq2D,QACrB,GAAe,MAAXA,EACH,OAAOA,EAAQhH,eAAgBrvD,OAIjCizD,sBAAA,SAAWh9C,GACV,IAAMogD,EAAUr2D,KAAKq2D,QACrB,OAAe,MAAXA,GACIA,EAAQ59C,UAAWzY,KAAMiW,IAKlCg9C,oBAAA,SAASh9C,GACR,IAAMogD,EAAUr2D,KAAKq2D,QACrB,OAAe,MAAXA,GACIA,EAAQt9C,QAAS/Y,KAAMiW,IAMhCg9C,mBAAA,SAAQ1f,GACP,IAAM8iB,EAAUr2D,KAAKq2D,QACN,MAAXA,GACHA,EAAQ11D,OAAQX,KAAMuzC,IAIxB0f,8BAAA,SAAmB1f,GAClBvzC,KAAKW,OAAQ4yC,GAGb,IADA,IAAM99B,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIjT,OAAQ4yC,IAIxB0f,iBAAA,SAAM5hD,EAAgBmlD,GAErB,gBAFqBA,EAAuBpJ,GAAe3F,KAC3DznD,KAAK6wB,GAAKxf,EAAOwf,GACyB,IAArC2lC,EAAOpJ,GAAeqJ,WAAmB,CAC7C,IAAM50C,EAAY7hB,KAAK6hB,UACjB60C,EAAkBrlD,EAAOwQ,UAC/BA,EAAUhF,SAASpX,SAAUixD,EAAgB75C,UAC7CgF,EAAUusC,SAAWsI,EAAgBtI,SACrCvsC,EAAUO,KAAK3c,SAAUixD,EAAgBt0C,MACzCP,EAAUgyC,MAAMpuD,SAAUixD,EAAgB7C,OAC1ChyC,EAAUI,MAAMxc,SAAUixD,EAAgBz0C,OAsB3C,GApBqC,IAAhCu0C,EAAOpJ,GAAenxC,OAC1Bjc,KAAKmM,KAAK1G,SAAU4L,EAAOlF,MAEU,IAAjCqqD,EAAOpJ,GAAeuJ,SAC1B32D,KAAKiwB,KAAKgyB,KAAM5wC,EAAO4e,MACvBjwB,KAAKuuD,OAAOtM,KAAM5wC,EAAOk9C,QACzBvuD,KAAKsvD,IAAIrN,KAAM5wC,EAAOi+C,KACtBtvD,KAAK2sB,KAAKs1B,KAAM5wC,EAAOsb,MACvB3sB,KAAKmD,OAASkO,EAAOlO,OACrBnD,KAAKiD,OAASoO,EAAOpO,OACH,MAAdjD,KAAK+5B,QACR/5B,KAAK+5B,MAAQ1oB,EAAO0oB,QAGiB,IAAlCy8B,EAAOpJ,GAAewJ,UAC1B52D,KAAKuyD,OAAOsE,OAAQxlD,EAAOkhD,OAAOhG,QAClCvsD,KAAKmkB,YAAc9S,EAAO8S,YAC1BnkB,KAAKwuD,OAASn9C,EAAOm9C,OACrBxuD,KAAKgX,SAAW3F,EAAO2F,UAEe,IAAlCw/C,EAAOpJ,GAAe0J,QAAgB,CAC1C,IAAMC,EAAe1lD,EAAOqgD,OAC5B,GAAoB,MAAhBqF,EAAuB,CAC1B,IAAMrF,EAAS1xD,KAAK0xD,OACN,MAAVA,EACHA,EAAOzP,KAAM8U,GAEb/2D,KAAK0xD,OAASqF,EAAaC,MAAOh3D,OAOrC,OAHsC,IAAjCw2D,EAAOpJ,GAAe6J,QAC1Bj3D,KAAKuR,SAAUF,EAAO+kD,YAAY,GAE5Bp2D,SArzBgCmU,QAAMC,4BCb9C,WAAaW,EAA8BmiD,EAAiB71D,EAAeE,GAC1EvB,KAAKsrD,GAAUv2C,EACf/U,KAAKm3D,GAAUD,EACfl3D,KAAKoB,EAASC,EACdrB,KAAKsB,EAASC,EAqGhB,OAlGC/B,sBAAI43D,0BAAJ,WACC,OAAOp3D,KAAKm3D,QAGb,SAAYD,GACPl3D,KAAKm3D,KAAYD,IACpBl3D,KAAKm3D,GAAUD,EACfl3D,KAAKsrD,GAAQwB,mDAIfttD,sBAAI43D,yBAAJ,WACC,OAAOp3D,KAAKoB,OAGb,SAAWC,GACNrB,KAAKoB,IAAWC,IACnBrB,KAAKoB,EAASC,EACdrB,KAAKsrD,GAAQwB,mDAIfttD,sBAAI43D,yBAAJ,WACC,OAAOp3D,KAAKsB,OAGb,SAAWC,GACNvB,KAAKsB,IAAWC,IACnBvB,KAAKsB,EAASC,EACdvB,KAAKsrD,GAAQwB,mDAIfsK,iBAAA,SAAMv2D,GACLb,KAAKwF,IAAK3E,EAAOq2D,OAAQr2D,EAAOQ,MAAOR,EAAOU,QAG/C61D,gBAAA,SAAKF,EAAkB71D,EAAgBE,GACtC,IAAIgC,GAAY,OAED7B,IAAXw1D,GAAwBl3D,KAAKm3D,KAAYD,IAC5Cl3D,KAAKm3D,GAAUD,EACf3zD,GAAY,QAGC7B,IAAVL,GAAuBrB,KAAKoB,IAAWC,IAC1CrB,KAAKoB,EAASC,EACdkC,GAAY,QAGC7B,IAAVH,GAAuBvB,KAAKsB,IAAWC,IAC1CvB,KAAKsB,EAASC,EACdgC,GAAY,GAGTA,GACHvD,KAAKsrD,GAAQwB,kBAIfsK,kBAAA,WACC,OAAO,IAAIA,EAAgBp3D,KAAKsrD,GAAStrD,KAAKm3D,GAASn3D,KAAKoB,EAAQpB,KAAKsB,IAG1E81D,qBAAA,WACC,MAAO,CACNF,OAAQl3D,KAAKm3D,GACb91D,MAAOrB,KAAKoB,EACZG,MAAOvB,KAAKsB,IAId81D,sBAAA,SAAWrK,GACV,IAAMsK,EAAc,KAAIr3D,KAAKm3D,GAAU,EAAI,OAAKn3D,KAAKoB,MAAUpB,KAAKsB,MACpE,OAAOyrD,EAAQ16B,IAAKglC,IAGrBD,wBAAA,SAAav2D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAMu6C,EAASH,EAAQuK,MAAMtqD,IAAKnM,GAClC,GAAc,MAAVqsD,EACHltD,KAAKwF,IACY,IAAhB0nD,EAAQ,GACRA,EAAQ,GACRA,EAAQ,QAEH,CACN,IAAMqK,EAAe53B,KAAKwtB,MAAO5e,EAAW1tC,IAC5CksD,EAAQuK,MAAM9xD,IAAK3E,EAAQ02D,GAC3Bv3D,KAAKwF,IACkB,IAAtB+xD,EAAc,GACdA,EAAc,GACdA,EAAc,0BCjGlB,WACCxiD,EACAmiD,EAAiB71D,EAAeE,EAChCa,EAAeE,EAAek1D,GAE9Bx3D,KAAKsrD,GAAUv2C,EACf/U,KAAKm3D,GAAUD,EACfl3D,KAAKoB,EAASC,EACdrB,KAAKsB,EAASC,EACdvB,KAAKmC,EAASC,EACdpC,KAAKqC,EAASC,EACdtC,KAAKy3D,GAAQD,EAqKf,OAlKCh4D,sBAAIk4D,0BAAJ,WACC,OAAO13D,KAAKm3D,QAGb,SAAYD,GACPl3D,KAAKm3D,KAAYD,IACpBl3D,KAAKm3D,GAAUD,EACfl3D,KAAKsrD,GAAQwB,mDAIfttD,sBAAIk4D,yBAAJ,WACC,OAAO13D,KAAKoB,OAGb,SAAWC,GACNrB,KAAKoB,IAAWC,IACnBrB,KAAKoB,EAASC,EACdrB,KAAKsrD,GAAQwB,mDAIfttD,sBAAIk4D,yBAAJ,WACC,OAAO13D,KAAKsB,OAGb,SAAWC,GACNvB,KAAKsB,IAAWC,IACnBvB,KAAKsB,EAASC,EACdvB,KAAKsrD,GAAQwB,mDAIfttD,sBAAIk4D,yBAAJ,WACC,OAAO13D,KAAKmC,OAGb,SAAWC,GACNpC,KAAKmC,IAAWC,IACnBpC,KAAKmC,EAASC,EACdpC,KAAKsrD,GAAQwB,mDAIfttD,sBAAIk4D,yBAAJ,WACC,OAAO13D,KAAKqC,OAGb,SAAWC,GACNtC,KAAKqC,IAAWC,IACnBtC,KAAKqC,EAASC,EACdtC,KAAKsrD,GAAQwB,mDAIfttD,sBAAIk4D,wBAAJ,WACC,OAAO13D,KAAKy3D,QAGb,SAAUD,GACLx3D,KAAKy3D,KAAUD,IAClBx3D,KAAKy3D,GAAQD,EACbx3D,KAAKsrD,GAAQwB,mDAIf4K,iBAAA,SAAM72D,GACDA,GACHb,KAAKwF,IAAK3E,EAAOq2D,OAAQr2D,EAAOQ,MAAOR,EAAOU,MAAOV,EAAOuB,MAAOvB,EAAOyB,MAAOzB,EAAO22D,OAI1FE,gBAAA,SAAKR,EAAkB71D,EAAgBE,EAAgBa,EAAgBE,EAAgBk1D,GACtF,IAAIj0D,GAAY,OAED7B,IAAXw1D,GAAwBl3D,KAAKm3D,KAAYD,IAC5Cl3D,KAAKm3D,GAAUD,EACf3zD,GAAY,QAGC7B,IAAVL,GAAuBrB,KAAKoB,IAAWC,IAC1CrB,KAAKoB,EAASC,EACdkC,GAAY,QAGC7B,IAAVH,GAAuBvB,KAAKsB,IAAWC,IAC1CvB,KAAKsB,EAASC,EACdgC,GAAY,QAGC7B,IAAVU,GAAuBpC,KAAKmC,IAAWC,IAC1CpC,KAAKmC,EAASC,EACdmB,GAAY,QAGC7B,IAAVY,GAAuBtC,KAAKqC,IAAWC,IAC1CtC,KAAKqC,EAASC,EACdiB,GAAY,QAGA7B,IAAT81D,GAAsBx3D,KAAKy3D,KAAUD,IACxCx3D,KAAKy3D,GAAQD,EACbj0D,GAAY,GAGTA,GACHvD,KAAKsrD,GAAQwB,kBAIf4K,kBAAA,WACC,OAAO,IAAIA,EACV13D,KAAKsrD,GACLtrD,KAAKm3D,GAASn3D,KAAKoB,EAAQpB,KAAKsB,EAChCtB,KAAKmC,EAAQnC,KAAKqC,EAAQrC,KAAKy3D,KAIjCC,qBAAA,WACC,MAAO,CACNR,OAAQl3D,KAAKm3D,GACb91D,MAAOrB,KAAKoB,EACZG,MAAOvB,KAAKsB,EACZc,MAAOpC,KAAKmC,EACZG,MAAOtC,KAAKqC,EACZm1D,KAAMx3D,KAAKy3D,KAIbC,sBAAA,SAAW3K,GACV,IACM6E,EAAa,KADJ5xD,KAAKm3D,GAAU,EAAI,OACDn3D,KAAKoB,MAAUpB,KAAKsB,MAAUtB,KAAKmC,MAAUnC,KAAKqC,MAAUrC,KAAKy3D,OAClG,OAAO1K,EAAQ16B,IAAKu/B,IAGrB8F,wBAAA,SAAa72D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAMu6C,EAASH,EAAQ4K,QAAQ3qD,IAAKnM,GACpC,GAAc,MAAVqsD,EACHltD,KAAKwF,IACY,IAAhB0nD,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,QAEH,CACN,IAAMqK,EAAe53B,KAAKwtB,MAAO5e,EAAW1tC,IAC5CksD,EAAQ4K,QAAQnyD,IAAK3E,EAAQ02D,GAC7Bv3D,KAAKwF,IACkB,IAAtB+xD,EAAc,GACdA,EAAc,GACdA,EAAc,GACdA,EAAc,GACdA,EAAc,GACdA,EAAc,aNrLnB,SAAYtJ,GACXA,6BACAA,+BAFD,CAAYA,KAAAA,QCDZ,SAAYC,GACXA,mBACAA,mBACAA,eACAA,yBAJD,CAAYA,KAAAA,QMGZ,ICGY0J,GAKAC,GCdAC,GCAAC,GCAAC,iBJYX,aACCh4D,KAAKi4D,GAAQ/J,GAAwBjqC,KACrCjkB,KAAKk4D,GAAQ,EACbl4D,KAAKm4D,GAAM,EAkNb,OA/MC34D,sBAAI44D,wBAAJ,WACC,OAAOp4D,KAAKi4D,QAGb,SAAUt9C,GACT,GAAI3a,KAAKi4D,KAAUt9C,EAAO,CACzB3a,KAAKi4D,GAAQt9C,EACb,IAAMpF,EAASvV,KAAK+U,OACN,MAAVQ,IACHA,EAAOhS,WAAY,qCAKtB/D,sBAAI44D,wBAAJ,WACC,OAAOp4D,KAAKk4D,QAGb,SAAUrrD,GACT,GAAI7M,KAAKk4D,KAAUrrD,EAAO,CACzB7M,KAAKk4D,GAAQrrD,EACb,IAAMkJ,EAAS/V,KAAK+U,OACN,MAAVgB,IACHA,EAAOxS,WAAY,qCAKtB/D,sBAAI44D,sBAAJ,WACC,OAAOp4D,KAAKm4D,QAGb,SAAQE,GACP,GAAIr4D,KAAKm4D,KAAQE,EAAK,CACrBr4D,KAAKm4D,GAAME,EACX,IAAMC,EAASt4D,KAAK+U,OACN,MAAVujD,IACHA,EAAO/0D,WAAY,qCAKtB60D,gBAAA,SAAKvrD,EAAsBwrD,GAC1B,IAAI93D,GAAS,EACb,QAAamB,IAATmL,QAA6BnL,IAAP22D,EACzB,GAAa,OAATxrD,GAAwB,OAAPwrD,EAAc,CAClC,IAAM19C,EAAQ3a,KAAKi4D,GAAQ/J,GAAwBqK,KAAQrK,GAAwBsK,GAC/Ex4D,KAAKi4D,KAAUt9C,GAAQ3a,KAAKk4D,KAAUrrD,GAAQ7M,KAAKm4D,KAAQE,IAC9Dr4D,KAAKi4D,GAAQt9C,EACb3a,KAAKk4D,GAAQrrD,EACb7M,KAAKm4D,GAAME,EACX93D,GAAS,QAES,OAATsM,GACJ8N,GAAQ3a,KAAKi4D,GAAQ/J,GAAwBqK,OAAUrK,GAAwBsK,GACjFx4D,KAAKi4D,KAAUt9C,GAAQ3a,KAAKk4D,KAAUrrD,IACzC7M,KAAKi4D,GAAQt9C,EACb3a,KAAKk4D,GAAQrrD,EACbtM,GAAS,IAEO,OAAP83D,GACJ19C,GAAQ3a,KAAKi4D,GAAQ/J,GAAwBsK,KAAQtK,GAAwBqK,KAC/Ev4D,KAAKi4D,KAAUt9C,GAAQ3a,KAAKk4D,KAAUrrD,IACzC7M,KAAKi4D,GAAQt9C,EACb3a,KAAKm4D,GAAME,EACX93D,GAAS,KAGJoa,EAAO3a,KAAKi4D,KAAW/J,GAAwBsK,GAAKtK,GAAwBqK,MAC9Ev4D,KAAKi4D,KAAUt9C,IAClB3a,KAAKi4D,GAAQt9C,EACbpa,GAAS,cAGQmB,IAATmL,EACG,OAATA,GACG8N,EAAO3a,KAAKi4D,GAAQ/J,GAAwBqK,KAC9Cv4D,KAAKi4D,KAAUt9C,GAAQ3a,KAAKk4D,KAAUrrD,IACzC7M,KAAKi4D,GAAQt9C,EACb3a,KAAKk4D,GAAQrrD,EACbtM,GAAS,KAGJoa,EAAO3a,KAAKi4D,IAAU/J,GAAwBqK,KAChDv4D,KAAKi4D,KAAUt9C,IAClB3a,KAAKi4D,GAAQt9C,EACbpa,GAAS,SAGMmB,IAAP22D,IACC,OAAPA,GACG19C,EAAO3a,KAAKi4D,GAAQ/J,GAAwBsK,GAC9Cx4D,KAAKi4D,KAAUt9C,GAAQ3a,KAAKm4D,KAAQE,IACvCr4D,KAAKi4D,GAAQt9C,EACb3a,KAAKm4D,GAAME,EACX93D,GAAS,KAGJoa,EAAO3a,KAAKi4D,IAAU/J,GAAwBsK,GAChDx4D,KAAKi4D,KAAUt9C,IAClB3a,KAAKi4D,GAAQt9C,EACbpa,GAAS,KAKZ,GAAIA,EAAS,CACZ,IAAMk4D,EAASz4D,KAAK+U,OACN,MAAV0jD,IACHA,EAAOl1D,WAAY,GAIrB,OAAOhD,GAGR63D,sBAAA,SAAWxhC,GACV,IAAMjc,EAAO3a,KAAKi4D,GACZprD,EAAO7M,KAAKk4D,GACZG,EAAKr4D,KAAKm4D,GAChB,OAAQx9C,GACR,KAAKuzC,GAAwBwK,QAC5B,OAAQ9hC,EAAQ/pB,IAASwrD,EAAKxrD,GAC/B,KAAKqhD,GAAwBqK,KAC5B,OAAO3hC,EAAQ/pB,EAChB,KAAKqhD,GAAwBsK,GAC5B,OAAOH,EAAKzhC,EACb,KAAKs3B,GAAwBjqC,KAC7B,QACC,OAAO2S,IAITwhC,qBAAA,SAAUv3D,GACT,OACCb,KAAKi4D,KAAUp3D,EAAO8Z,MACtB3a,KAAKk4D,KAAUr3D,EAAOgM,MACtB7M,KAAKm4D,KAAQt3D,EAAOw3D,IAItBD,iBAAA,SAAMv3D,GACL,OAAOb,KAAK24D,GAAO93D,EAAO8Z,KAAM9Z,EAAOgM,KAAMhM,EAAOw3D,KAG3CD,eAAV,SAAiBz9C,EAA+B9N,EAAcwrD,GAC7D,IAAI90D,GAAY,EAiBhB,GAfIvD,KAAKi4D,KAAUt9C,IAClB3a,KAAKi4D,GAAQt9C,EACbpX,GAAY,GAGTvD,KAAKk4D,KAAUrrD,IAClB7M,KAAKk4D,GAAQrrD,EACbtJ,GAAY,GAGTvD,KAAKm4D,KAAQE,IAChBr4D,KAAKm4D,GAAME,EACX90D,GAAY,GAGTA,EAAY,CACf,IAAMq1D,EAAS54D,KAAK+U,OACN,MAAV6jD,IACHA,EAAOr1D,WAAY,GAIrB,OAAOvD,MAGRo4D,qBAAA,WACC,MAAO,CACNz9C,KAAM3a,KAAK2a,KACX9N,KAAM7M,KAAK6M,KACXwrD,GAAIr4D,KAAKq4D,KAIXD,sBAAA,SAAWrL,GACV,IAAM6E,EAAa,IAAI5xD,KAAKi4D,OAASj4D,KAAKk4D,OAASl4D,KAAKm4D,OACxD,OAAOpL,EAAQ16B,IAAKu/B,IAGrBwG,wBAAA,SAAav3D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAMu6C,EAASH,EAAQ8L,OAAO7rD,IAAKnM,GACnC,GAAc,MAAVqsD,EACHltD,KAAK24D,GACJzL,EAAQ,GACRA,EAAQ,GACRA,EAAQ,QAEH,CACN,IAAMqK,EAAe53B,KAAKwtB,MAAO5e,EAAW1tC,IAC5CksD,EAAQ8L,OAAOrzD,IAAK3E,EAAQ02D,GAC5Bv3D,KAAK24D,GACJpB,EAAc,GACdA,EAAc,GACdA,EAAc,YKrNbuB,GAAmB,SAAEtrC,EAAWjuB,GACrC,OAAOiuB,EAAIjuB,iBAoBX,aACCS,KAAK6wB,GAAK,GACV7wB,KAAK+4D,QAAU,GACf/4D,KAAK6rC,OAAS,GACd7rC,KAAKg5D,MAAQ,IAAIZ,GACjBp4D,KAAKu9B,GAAS,EACdv9B,KAAK22C,GAAQ,EACb32C,KAAKi5D,GAAY,EACjBj5D,KAAKk5D,GAASjL,GAAoBkL,UA0epC,OAveC35D,sBAAI45D,0BAAJ,WACC,OAAOp5D,KAAKsrD,QAGb,SAAYv2C,GACP/U,KAAKsrD,KAAYv2C,IACpB/U,KAAKsrD,GAAUv2C,EACf/U,KAAKg5D,MAAMjkD,OAASA,oCAItBvV,sBAAI45D,yBAAJ,WACC,OAAOp5D,KAAKu9B,QAGb,SAAW87B,GACV,IAAMrhC,EAAYh4B,KAAKg4B,UACN,MAAbA,IACHqhC,EAAWrhC,EAAWqhC,IAGvB,IAAMzkB,EAAW50C,KAAKi5D,GACtB,GAAIrkB,GAAY,GACf,GAAI50C,KAAKu9B,KAAW87B,EAAW,CAC9Br5D,KAAKu9B,GAAS87B,EACd,IAAM9jD,EAASvV,KAAK+U,OACN,MAAVQ,IACHA,EAAOhS,WAAY,QAGf,CACN,IAAIgpD,EAASvsD,KAAKurD,GACJ,MAAVgB,IACHA,EAAS,GACTvsD,KAAKurD,GAAUgB,GAIhBvsD,KAAKu9B,GAAS87B,EAGd,IAAMC,EAAQt5D,KAAKk5D,GACfI,IAAUrL,GAAoBkL,UACjC5M,EAAO35C,KAAMymD,GAEb9M,EAAOhmC,QAAS8yC,GAIjB,IAAME,EAAQhN,EAAO55C,OAASiiC,EAC9B,GAAI,EAAI2kB,EACP,GAAID,IAAUrL,GAAoBkL,UACjC,IAAK,IAAIvlD,EAAI,EAAGA,EAAI2lD,IAAS3lD,EAC5B24C,EAAOx5C,aAGRw5C,EAAO55C,OAASiiC,EAKlB,IAAM7+B,EAAS/V,KAAK+U,OACN,MAAVgB,IACHA,EAAOxS,WAAY,qCAKtB/D,sBAAI45D,0BAAJ,WACC,OAAOp5D,KAAKg5D,MAAMQ,UAAWx5D,KAAKu9B,qCAGnC/9B,sBAAI45D,0BAAJ,WACC,IAAI74D,EAASP,KAAKurD,GAKlB,OAJc,MAAVhrD,IACHA,EAAS,GACTP,KAAKurD,GAAUhrD,GAETA,OAGR,SAAYksD,GACX,GAAI,EAAIA,EAAU95C,OAAS,CAC1B,IAAMiiC,EAAW50C,KAAKi5D,GACtB,GAAIrkB,GAAY,EAAI,CACnB,IAAIykB,EAAW5M,EAAWA,EAAU95C,OAAS,GAK7C,GAHiB,OADXqlB,EAAYh4B,KAAKg4B,aAEtBqhC,EAAWrhC,EAAWqhC,IAEnBr5D,KAAKu9B,KAAW87B,EAAW,CAC9Br5D,KAAKu9B,GAAS87B,EACd,IAAMf,EAASt4D,KAAK+U,OACN,MAAVujD,IACHA,EAAO/0D,WAAY,QAGf,CACN,IAAIgpD,EAASvsD,KAAKurD,GACJ,MAAVgB,IACHA,EAAS,GACTvsD,KAAKurD,GAAUgB,GAGhB,IACMv0B,EADAshC,EAAQt5D,KAAKk5D,GAEnB,GAAiB,OADXlhC,EAAYh4B,KAAKg4B,WAMtB,GAHAh4B,KAAKu9B,GAASvF,EAAWy0B,EAAWA,EAAU95C,OAAS,IAGnD2mD,IAAUrL,GAAoBkL,UACjC,IAAK,IAAIvlD,EAAI,EAAGG,EAAO04C,EAAU95C,OAAQiB,EAAIG,IAAQH,EACpD24C,EAAO35C,KAAMolB,EAAWy0B,EAAW74C,UAGpC,IAASA,EAAI,EAAGG,EAAO04C,EAAU95C,OAAQiB,EAAIG,IAAQH,EACpD24C,EAAOhmC,QAASyR,EAAWy0B,EAAW74C,UAQxC,GAHA5T,KAAKu9B,GAASkvB,EAAWA,EAAU95C,OAAS,GAGxC2mD,IAAUrL,GAAoBkL,UACjC,IAASvlD,EAAI,EAAGG,EAAO04C,EAAU95C,OAAQiB,EAAIG,IAAQH,EACpD24C,EAAO35C,KAAM65C,EAAW74C,SAGzB,IAASA,EAAI,EAAGG,EAAO04C,EAAU95C,OAAQiB,EAAIG,IAAQH,EACpD24C,EAAOhmC,QAASkmC,EAAW74C,IAM9B,IAAM2lD,EAAQhN,EAAO55C,OAASiiC,EAC9B,GAAI,EAAI2kB,EACP,GAAID,IAAUrL,GAAoBkL,UACjC,IAASvlD,EAAI,EAAGA,EAAI2lD,IAAS3lD,EAC5B24C,EAAOx5C,aAGRw5C,EAAO55C,OAASiiC,EAKlB,IAAM6jB,EAASz4D,KAAK+U,OACN,MAAV0jD,IACHA,EAAOl1D,WAAY,sCAMvB/D,sBAAI45D,wBAAJ,WACC,OAAOp5D,KAAK22C,QAGb,SAAUsB,GACT,IAAMrD,EAAW50C,KAAKi5D,GACtB,GAAIrkB,GAAY,GACf,GAAI50C,KAAK22C,KAAUsB,EAAU,CAC5Bj4C,KAAK22C,GAAQsB,EACb,IAAM2gB,EAAS54D,KAAK+U,OACN,MAAV6jD,IACHA,EAAOr1D,WAAY,QAGf,CAEN,IAAIk2D,EAAQz5D,KAAK05D,GACJ,MAATD,IACHA,EAAQ,GACRz5D,KAAK05D,GAASD,GAIfz5D,KAAK22C,GAAQsB,EAGb,IAAMqhB,EAAQt5D,KAAKk5D,GACfI,IAAUrL,GAAoBkL,UACjCM,EAAM7mD,KAAMqlC,GAEZwhB,EAAMlzC,QAAS0xB,GAIhB,IAAMshB,EAAQE,EAAM9mD,OAASiiC,EAC7B,GAAI,EAAI2kB,EACP,GAAID,IAAUrL,GAAoBkL,UACjC,IAAK,IAAIvlD,EAAI,EAAGA,EAAI2lD,IAAS3lD,EAC5B6lD,EAAM1mD,aAGP0mD,EAAM9mD,OAASiiC,EAKjB,IAAM+kB,EAAS35D,KAAK+U,OACN,MAAV4kD,IACHA,EAAOp2D,WAAY,qCAKtB/D,sBAAI45D,yBAAJ,WACC,IAAI74D,EAASP,KAAK05D,GAKlB,OAJc,MAAVn5D,IACHA,EAAS,GACTP,KAAK05D,GAASn5D,GAERA,OAGR,SAAWq5D,GACV,GAAI,EAAIA,EAASjnD,OAAS,CACzB,IAAMiiC,EAAW50C,KAAKi5D,GACtB,GAAIrkB,GAAY,EAAI,CACnB,IAAMqD,EAAU2hB,EAAUA,EAASjnD,OAAS,GAC5C,GAAI3S,KAAK22C,KAAUsB,EAAU,CAC5Bj4C,KAAK22C,GAAQsB,EACb,IAAM4hB,EAAS75D,KAAK+U,OACN,MAAV8kD,IACHA,EAAOt2D,WAAY,QAGf,CAEN,IAAIk2D,EAAQz5D,KAAK05D,GACJ,MAATD,IACHA,EAAQ,GACRz5D,KAAK05D,GAASD,GAIfz5D,KAAK22C,GAAQijB,EAAUA,EAASjnD,OAAS,GAGzC,IAAM2mD,EAAQt5D,KAAKk5D,GACnB,GAAII,IAAUrL,GAAoBkL,UACjC,IAAK,IAAIvlD,EAAI,EAAGG,EAAO6lD,EAASjnD,OAAQiB,EAAIG,IAAQH,EACnD6lD,EAAM7mD,KAAMgnD,EAAUhmD,SAGvB,IAASA,EAAI,EAAGG,EAAO6lD,EAASjnD,OAAQiB,EAAIG,IAAQH,EACnD6lD,EAAMlzC,QAASqzC,EAAUhmD,IAK3B,IAAM2lD,EAAQE,EAAM9mD,OAASiiC,EAC7B,GAAI,EAAI2kB,EACP,GAAID,IAAUrL,GAAoBkL,UACjC,IAASvlD,EAAI,EAAGA,EAAI2lD,IAAS3lD,EAC5B6lD,EAAM1mD,aAGP0mD,EAAM9mD,OAASiiC,EAKjB,IAAMklB,EAAS95D,KAAK+U,OACN,MAAV+kD,IACHA,EAAOv2D,WAAY,sCAMvB/D,sBAAI45D,4BAAJ,WACC,OAAOp5D,KAAKi5D,QAGb,SAAcrkB,GACb,GAAI50C,KAAKi5D,GAAYrkB,EACpB50C,KAAKi5D,GAAYrkB,OACX,GAAIA,EAAW50C,KAAKi5D,GAAY,CACtCj5D,KAAKi5D,GAAYrkB,EAEjB,IAAIrxC,GAAY,EAGV+1D,EAAQt5D,KAAKk5D,GACb3M,EAASvsD,KAAKurD,GACpB,GAAc,MAAVgB,GAEC,GADEgN,EAAQhN,EAAO55C,OAASiiC,GACd,CACf,GAAI0kB,IAAUrL,GAAoBkL,UACjC,IAAK,IAAIvlD,EAAI,EAAGA,EAAI2lD,IAAS3lD,EAC5B24C,EAAOx5C,aAGRw5C,EAAO55C,OAASiiC,EAEjBrxC,GAAY,EAKd,IAEOg2D,EAFDE,EAAQz5D,KAAK05D,GACnB,GAAa,MAATD,GAEC,GADEF,EAAQE,EAAM9mD,OAASiiC,GACb,CACf,GAAI0kB,IAAUrL,GAAoBkL,UACjC,IAASvlD,EAAI,EAAGA,EAAI2lD,IAAS3lD,EAC5B6lD,EAAM1mD,aAGP0mD,EAAM9mD,OAASiiC,EAEhBrxC,GAAY,EAId,GAAIA,EAAY,CACf,IAAMw2D,EAAS/5D,KAAK+U,OACN,MAAVglD,IACHA,EAAOx2D,WAAY,sCAMvB/D,sBAAI45D,yBAAJ,WACC,OAAOp5D,KAAKk5D,QAGb,SAAWI,GACVt5D,KAAKk5D,GAASI,mCAGfF,mBAAA,SAAQ5jD,GACP,IAAIjS,GAAY,EAGVgpD,EAASvsD,KAAKurD,GACN,MAAVgB,GACC,GAAK/2C,GAASA,EAAQ+2C,EAAO55C,SAChC45C,EAAOv4C,OAAQwB,EAAO,GACtBjS,GAAY,GAKd,IAAMk2D,EAAQz5D,KAAK05D,GAQnB,GAPa,MAATD,GACC,GAAKjkD,GAASA,EAAQikD,EAAM9mD,SAC/B8mD,EAAMzlD,OAAQwB,EAAO,GACrBjS,GAAY,GAIVA,EAAY,CACf,IAAMy2D,EAASh6D,KAAK+U,OACN,MAAVilD,IACHA,EAAOz2D,WAAY,KAKtB61D,sBAAA,SAAWvxD,GACV,IAAItE,GAAY,EAEVgpD,EAASvsD,KAAKurD,GACdkO,EAAQz5D,KAAK05D,GACbzkB,EAASptC,EAAQoyD,MAAM,GAAG14B,KAAMu3B,IACtC,GAAc,MAAVvM,EACH,GAAa,MAATkN,EACH,IAAK,IAAI7lD,EAAIqhC,EAAOtiC,OAAS,EAAG,GAAKiB,IAAKA,EAErC,IADE4B,EAAQy/B,EAAQrhC,MAEjB4B,EAAQ+2C,EAAO55C,SAClB45C,EAAOv4C,OAAQwB,EAAO,GACtBjS,GAAY,GAETiS,EAAQikD,EAAM9mD,SACjB8mD,EAAMzlD,OAAQwB,EAAO,GACrBjS,GAAY,SAKf,IAASqQ,EAAIqhC,EAAOtiC,OAAS,EAAG,GAAKiB,IAAKA,EAErC,IADE4B,EAAQy/B,EAAQrhC,KACJ4B,EAAQ+2C,EAAO55C,SAChC45C,EAAOv4C,OAAQwB,EAAO,GACtBjS,GAAY,QAKf,GAAa,MAATk2D,EACH,IAAS7lD,EAAIqhC,EAAOtiC,OAAS,EAAG,GAAKiB,IAAKA,EAAI,CAC7C,IAAM4B,EACF,IADEA,EAAQy/B,EAAQrhC,KACJ4B,EAAQikD,EAAM9mD,SAC/B8mD,EAAMzlD,OAAQwB,EAAO,GACrBjS,GAAY,GAMhB,GAAIA,EAAY,CACf,IAAM22D,EAASl6D,KAAK+U,OACN,MAAVmlD,IACHA,EAAO32D,WAAY,KAKtB61D,kBAAA,WACC,IAAI71D,GAAY,EAGVgpD,EAASvsD,KAAKurD,GACN,MAAVgB,IACHA,EAAO55C,OAAS,EAChBpP,GAAY,GAIb,IAAMk2D,EAAQz5D,KAAK05D,GAOnB,GANa,MAATD,IACHA,EAAM9mD,OAAS,EACfpP,GAAY,GAITA,EAAY,CACf,IAAM42D,EAASn6D,KAAK+U,OACN,MAAVolD,IACHA,EAAO52D,WAAY,KAUtB61D,iBAAA,SAAMv4D,GASL,OARAb,KAAK6wB,GAAKhwB,EAAOgwB,GACjB7wB,KAAK+4D,QAAUl4D,EAAOk4D,QACtB/4D,KAAK6rC,OAAShrC,EAAOgrC,OACrB7rC,KAAKg4B,UAAYn3B,EAAOm3B,UACxBh4B,KAAKg5D,MAAM/W,KAAMphD,EAAOm4D,OACxBh5D,KAAKu9B,GAAS18B,EAAO+1B,MACrB52B,KAAK22C,GAAQ91C,EAAO0yC,KACpBvzC,KAAKi5D,GAAYp4D,EAAO+zC,SACjB50C,MAGRo5D,sBAAA,SAAWrM,GACV,IAAMqN,EAAerN,EAAQ16B,IAAKryB,KAAK6wB,IACjCwpC,EAAoBtN,EAAQ16B,IAAKryB,KAAK+4D,SACtCuB,EAAmBvN,EAAQ16B,IAAKryB,KAAK6rC,OAAOj1B,QAC5C2jD,EAAkBv6D,KAAKg5D,MAAMhL,UAAWjB,GAC9C,OAAOA,EAAQ16B,IACd,IAAI+nC,MAAgBC,MAAqBC,MAAoBC,MAAmBv6D,KAAKi5D,OAAaj5D,KAAKk5D,SAIzGE,wBAAA,SAAav4D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAIu6C,EAASH,EAAQyN,UAAUxtD,IAAKnM,GACtB,MAAVqsD,IACHA,EAASvtB,KAAKwtB,MAAO5e,EAAW1tC,IAChCksD,EAAQyN,UAAUh1D,IAAK3E,EAAQqsD,IAEhCltD,KAAK6wB,GAAK0d,EAAW2e,EAAQ,KAAS,GACtCltD,KAAK+4D,QAAUxqB,EAAW2e,EAAQ,KAAS,GAC3CltD,KAAK6rC,OAAS0C,EAAW2e,EAAQ,KAAS,GAC1CltD,KAAKg5D,MAAMyB,YAAavN,EAAQ,GAAKH,GACrC/sD,KAAKi5D,GAAY/L,EAAQ,GACzBltD,KAAKk5D,GAAShM,EAAQ,GAGvB,OAAOltD,yBC5fR,aACCA,KAAKurD,GAAU,GACfvrD,KAAKuD,WAAY,EAqUnB,OAlUC/D,sBAAIk7D,sBAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAI17B,GAEnB,IAAM8pC,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAU9pC,GAGZ,oCAGRrxB,sBAAIk7D,2BAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAIwM,QAEnB,IAAM4B,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAU5B,QAGZ,oCAGRv5D,sBAAIk7D,0BAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAI1gB,OAEnB,IAAM8uB,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAU9uB,OAGZ,oCAGRrsC,sBAAIk7D,yBAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAIyM,MAEnB,IAAM2B,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAU3B,MAGZ0B,EAAcE,6CAGtBp7D,sBAAIk7D,yBAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAI31B,MAEnB,IAAM+jC,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAU/jC,MAGZ,OAGR,SAAWA,GACV,IAAM21B,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd45C,EAAQ,GAAI31B,MAAQA,MACd,CACN,IAAM+jC,EAAY36D,KAAK26D,UACN,MAAbA,IACHA,EAAU/jC,MAAQA,qCAKrBp3B,sBAAIk7D,0BAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAIsO,OAEnB,IAAMF,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAUE,OAGZ,mCAGRr7D,sBAAIk7D,wBAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAIhZ,KAEnB,IAAMonB,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAUpnB,KAGZ,OAGR,SAAUA,GACT,IAAMgZ,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd45C,EAAQ,GAAIhZ,KAAOA,MACb,CACN,IAAMonB,EAAY36D,KAAK26D,UACN,MAAbA,IACHA,EAAUpnB,KAAOA,qCAKpB/zC,sBAAIk7D,0BAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAIA,OAEnB,IAAMoO,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAUpO,OAGZmO,EAAcI,iBAGtB,SAAYrO,GACX,IAAMF,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd45C,EAAQ,GAAIA,OAASE,MACf,CACN,IAAMkO,EAAY36D,KAAK26D,UACN,MAAbA,IACHA,EAAUpO,OAASE,qCAKtBjtD,sBAAIk7D,yBAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAIkN,MAEnB,IAAMkB,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAUlB,MAGZiB,EAAcI,iBAGtB,SAAWlB,GACV,IAAMrN,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd45C,EAAQ,GAAIkN,MAAQG,MACd,CACN,IAAMe,EAAY36D,KAAK26D,UACN,MAAbA,IACHA,EAAUlB,MAAQG,qCAKrBp6D,sBAAIk7D,4BAAJ,WACC,IAAMnO,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd,OAAO45C,EAAQ,GAAI3X,SAEnB,IAAM+lB,EAAY36D,KAAK26D,UACvB,OAAiB,MAAbA,EACIA,EAAU/lB,SAGZ,OAGR,SAAcA,GACb,IAAM2X,EAASvsD,KAAKurD,GACpB,GAAI,EAAIgB,EAAO55C,OACd45C,EAAQ,GAAI3X,SAAWA,MACjB,CACN,IAAM+lB,EAAY36D,KAAK26D,UACN,MAAbA,IACHA,EAAU/lB,SAAWA,qCAKxB8lB,gBAAA,SAAK9jC,EAAuBphB,GAC3B,IAAM+2C,EAASvsD,KAAKurD,GACpB30B,EAAM7hB,OAAS/U,UACD0B,IAAV8T,EACH+2C,EAAO35C,KAAMgkB,GAEb21B,EAAOv4C,OAAQwB,EAAO,EAAGohB,IAI3B8jC,gBAAA,SAAKllD,EAAeohB,GACnB,IAAM21B,EAASvsD,KAAKurD,GACpB,GAAI,GAAK/1C,GAASA,EAAQ+2C,EAAO55C,OAAS,CACzC,IAAMpS,EAASgsD,EAAQ/2C,GAIvB,OAHAohB,EAAM7hB,OAAS/U,KACfusD,EAAQ/2C,GAAUohB,EAClBr2B,EAAOwU,YAASrT,EACTnB,EAER,OAAO,MAGRm6D,mBAAA,SAAQllD,GACP,IAAM+2C,EAASvsD,KAAKurD,GAChB,GAAK/1C,GAASA,EAAQ+2C,EAAO55C,SAChC45C,EAAOv4C,OAAQwB,EAAO,GAAK,GAAIT,YAASrT,IAI1Cg5D,oBAAA,SAAS75D,GAIR,IAHA,IAAM0rD,EAASvsD,KAAKurD,GAGX33C,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,IAAQH,EAEjD,IADMgjB,EAAQ21B,EAAQ34C,MACR/S,EACb,OAAO+S,EAKT,IAASA,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,IAAQH,EAEjD,IADMgjB,EAAQ21B,EAAQ34C,IAEfid,KAAOhwB,EAAOgwB,IACpB+F,EAAMmiC,UAAYl4D,EAAOk4D,SACzBniC,EAAMoB,YAAcn3B,EAAOm3B,WAC3BpB,EAAMoiC,MAAMpL,SAAU/sD,EAAOm4D,OAE7B,OAAOplD,EAKT,IAASA,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,IAAQH,EAAI,CACrD,IAAMgjB,EACN,IADMA,EAAQ21B,EAAQ34C,IACZid,KAAOhwB,EAAOgwB,GACvB,OAAOjd,EAIT,OAAQ,GAGT8mD,gBAAA,SAAKllD,GACJ,IAAM+2C,EAASvsD,KAAKurD,GACpB,OAAI,GAAK/1C,GAASA,EAAQ+2C,EAAO55C,OACzB45C,EAAQ/2C,GAET,MAGRklD,iBAAA,WACC,OAAO16D,KAAKurD,GAAQ54C,QAGrB+nD,iBAAA,SAAM7M,EAAgBC,GACrB,IAAMvB,EAASvsD,KAAKurD,GACdwC,EAAMxB,EAAQuB,GACpBvB,EAAQuB,GAAWvB,EAAQsB,GAC3BtB,EAAQsB,GAAWE,GAGpB2M,iBAAA,SAAM75D,GACL,IAAM0rD,EAASvsD,KAAKurD,GACpBgB,EAAO55C,OAAS,EAEhB,IAAK,IAAIiB,EAAI,EAAGG,EAAOlT,EAAOsL,OAAQyH,EAAIG,IAAQH,EAAI,CACrD,IAAMgjB,EAAQ/1B,EAAOmM,IAAK4G,GAC1B,GAAa,MAATgjB,EAAgB,CACnB,IAAMyiC,GAAW,IAAID,IAAqBnX,KAAMrrB,GAChDyiC,EAAStkD,OAAS/U,KAClBusD,EAAO35C,KAAMymD,IAIf,OAAOr5D,MAGR06D,sBAAA,SAAW3N,GACV,IAAMR,EAASvsD,KAAKurD,GACpB,GAAIgB,EAAO55C,QAAU,EACpB,OAAOo6C,EAAQ16B,IAAK,MAGpB,IADA,IAAIu/B,EAAa,IAAIrF,EAAQ,GAAIyB,UAAWjB,GACnCn5C,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,IAAQH,EACjDg+C,GAAc,IAAIrF,EAAQ34C,GAAIo6C,UAAWjB,GAG1C,OADA6E,GAAc,IACP7E,EAAQ16B,IAAKu/B,IAItB8I,wBAAA,SAAa75D,EAAgBksD,GAC5B,GAAI,GAAKlsD,GAAUA,EAASksD,EAAQxe,UAAU57B,OAAS,CACtD,IAAI4kD,EAAqCxK,EAAQgO,KAAK/tD,IAAKnM,GACvC,MAAhB02D,IACHA,EAAe53B,KAAKwtB,MAAOJ,EAAQxe,UAAW1tC,IAC9CksD,EAAQgO,KAAKv1D,IAAK3E,EAAQ02D,IAG3B,IAAMhL,EAASvsD,KAAKurD,GACpBgB,EAAO55C,OAAS,EAChB,IAAK,IAAIiB,EAAI,EAAGG,EAAOwjD,EAAa5kD,OAAQiB,EAAIG,IAAQH,EAAI,CAC3D,IAAM4B,EAAQ+hD,EAAc3jD,GACtBgjB,EAAQ,IAAIwiC,GAClBxiC,EAAM7hB,OAAS/U,KACf42B,EAAM6jC,YAAajlD,EAAOu3C,GAC1BR,EAAO35C,KAAMgkB,MA1UT8jC,cAAc,IAAItC,GAClBsC,cAAc,SLDtB,SAAY9C,GACXA,uBACAA,mBAFD,CAAYA,KAAAA,QAKZ,SAAYC,GACXA,uBACAA,uBAFD,CAAYA,KAAAA,QCdZ,SAAYC,GACXA,mBACAA,uBACAA,qBACAA,mCACAA,qCALD,CAAYA,KAAAA,QCAZ,SAAYC,GACXA,iBACAA,uBACAA,uBACAA,iCACAA,uCALD,CAAYA,KAAAA,QCAZ,SAAYC,GACXA,qCACAA,qCACAA,qCAHD,CAAYA,KAAAA,QGOZ,ICPYgD,iBDYX,WACCjmD,EACA6iB,EAAuCF,GAEvC13B,KAAKsrD,GAAUv2C,EACf/U,KAAKi7D,GAAcrjC,EACnB53B,KAAKk7D,GAAYxjC,EA+EnB,OA5ECl4B,sBAAI27D,8BAAJ,WACC,OAAOn7D,KAAKi7D,QAGb,SAAgBrjC,GACX53B,KAAKi7D,KAAgBrjC,IACxB53B,KAAKi7D,GAAcrjC,EACnB53B,KAAKsrD,GAAQwB,mDAIfttD,sBAAI27D,4BAAJ,WACC,OAAOn7D,KAAKk7D,QAGb,SAAcxjC,GACT13B,KAAKk7D,KAAcxjC,IACtB13B,KAAKk7D,GAAYxjC,EACjB13B,KAAKsrD,GAAQwB,mDAIfqO,iBAAA,SAAMt6D,GACDA,GACHb,KAAKwF,IAAK3E,EAAO+2B,WAAY/2B,EAAO62B,WAItCyjC,gBAAA,SAAKvjC,EAAwCF,GAC5C,IAAIn0B,GAAY,EAEE,MAAdq0B,GAAsB53B,KAAKi7D,KAAgBrjC,IAC9C53B,KAAKi7D,GAAcrjC,EACnBr0B,GAAY,GAGG,MAAZm0B,GAAoB13B,KAAKk7D,KAAcxjC,IAC1C13B,KAAKk7D,GAAYxjC,EACjBn0B,GAAY,GAGTA,GACHvD,KAAKsrD,GAAQwB,kBAIfqO,qBAAA,WACC,MAAO,CACNvjC,WAAY53B,KAAKi7D,GACjBvjC,SAAU13B,KAAKk7D,KAIjBC,sBAAA,SAAWpO,GACV,OAAOA,EAAQ16B,IAAK,IAAIryB,KAAKi7D,OAAej7D,KAAKk7D,SAGlDC,wBAAA,SAAat6D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAMu6C,EAASH,EAAQqO,OAAOpuD,IAAKnM,GACnC,GAAc,MAAVqsD,EACHltD,KAAKwF,IACJ0nD,EAAQ,GACRA,EAAQ,QAEH,CACN,IAAMqK,EAAe53B,KAAKwtB,MAAO5e,EAAW1tC,IAC5CksD,EAAQqO,OAAO51D,IAAK3E,EAAQ02D,GAC5Bv3D,KAAKwF,IACJ+xD,EAAc,GACdA,EAAc,0BElFlB,WAAaxiD,EAAoC6iB,EAAoBF,GACpE13B,KAAKsrD,GAAUv2C,EACf/U,KAAKi7D,GAAcrjC,EACnB53B,KAAKk7D,GAAYxjC,EA+EnB,OA5ECl4B,sBAAI67D,8BAAJ,WACC,OAAOr7D,KAAKi7D,QAGb,SAAgBrjC,GACX53B,KAAKi7D,KAAgBrjC,IACxB53B,KAAKi7D,GAAcrjC,EACnB53B,KAAKsrD,GAAQwB,mDAIfttD,sBAAI67D,4BAAJ,WACC,OAAOr7D,KAAKk7D,QAGb,SAAcxjC,GACT13B,KAAKk7D,KAAcxjC,IACtB13B,KAAKk7D,GAAYxjC,EACjB13B,KAAKsrD,GAAQwB,mDAIfuO,iBAAA,SAAMx6D,GACDA,GACHb,KAAKwF,IAAK3E,EAAO+2B,WAAY/2B,EAAO62B,WAItC2jC,gBAAA,SAAKzjC,EAAqBF,GACzB,IAAIn0B,GAAY,EAEE,MAAdq0B,GAAsB53B,KAAKi7D,KAAgBrjC,IAC9C53B,KAAKi7D,GAAcrjC,EACnBr0B,GAAY,GAGG,MAAZm0B,GAAoB13B,KAAKk7D,KAAcxjC,IAC1C13B,KAAKk7D,GAAYxjC,EACjBn0B,GAAY,GAGTA,GACHvD,KAAKsrD,GAAQwB,kBAIfuO,qBAAA,WACC,MAAO,CACNzjC,WAAY53B,KAAKi7D,GACjBvjC,SAAU13B,KAAKk7D,KAIjBG,sBAAA,SAAWtO,GACV,OAAOA,EAAQ16B,IAAK,IAAIryB,KAAKi7D,OAAej7D,KAAKk7D,SAGlDG,wBAAA,SAAax6D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAMu6C,EAASH,EAAQuO,QAAQtuD,IAAKnM,GACpC,GAAc,MAAVqsD,EACHltD,KAAKwF,IACJ0nD,EAAQ,GACRA,EAAQ,QAEH,CACN,IAAMqK,EAAe53B,KAAKwtB,MAAO5e,EAAW1tC,IAC5CksD,EAAQuO,QAAQ91D,IAAK3E,EAAQ02D,GAC7Bv3D,KAAKwF,IACJ+xD,EAAc,GACdA,EAAc,0BC3ElB,WAAaxiD,EAAqCmiD,EAAiB71D,EAAeE,EAAea,GAChGpC,KAAKsrD,GAAUv2C,EACf/U,KAAKm3D,GAAUD,EACfl3D,KAAKoB,EAASC,EACdrB,KAAKsB,EAASC,EACdvB,KAAKmC,EAASC,EA0HhB,OAvHC5C,sBAAI+7D,0BAAJ,WACC,OAAOv7D,KAAKm3D,QAGb,SAAYD,GACPl3D,KAAKm3D,KAAYD,IACpBl3D,KAAKm3D,GAAUD,EACfl3D,KAAKsrD,GAAQwB,mDAIfttD,sBAAI+7D,yBAAJ,WACC,OAAOv7D,KAAKoB,OAGb,SAAWC,GACNrB,KAAKoB,IAAWC,IACnBrB,KAAKoB,EAASC,EACdrB,KAAKsrD,GAAQwB,mDAIfttD,sBAAI+7D,yBAAJ,WACC,OAAOv7D,KAAKsB,OAGb,SAAWC,GACNvB,KAAKsB,IAAWC,IACnBvB,KAAKsB,EAASC,EACdvB,KAAKsrD,GAAQwB,mDAIfttD,sBAAI+7D,yBAAJ,WACC,OAAOv7D,KAAKmC,OAGb,SAAWC,GACNpC,KAAKmC,IAAWC,IACnBpC,KAAKmC,EAASC,EACdpC,KAAKsrD,GAAQwB,mDAIfyO,iBAAA,SAAM16D,GACDA,GACHb,KAAKwF,IAAK3E,EAAOq2D,OAAQr2D,EAAOQ,MAAOR,EAAOU,MAAOV,EAAOuB,QAI9Dm5D,gBAAA,SAAKrE,EAAkB71D,EAAgBE,EAAgBa,GACtD,IAAImB,GAAY,OAED7B,IAAXw1D,GAAwBl3D,KAAKm3D,KAAYD,IAC5Cl3D,KAAKm3D,GAAUD,EACf3zD,GAAY,QAGC7B,IAAVL,GAAuBrB,KAAKoB,IAAWC,IAC1CrB,KAAKoB,EAASC,EACdkC,GAAY,QAGC7B,IAAVH,GAAuBvB,KAAKsB,IAAWC,IAC1CvB,KAAKsB,EAASC,EACdgC,GAAY,QAGC7B,IAAVU,GAAuBpC,KAAKmC,IAAWC,IAC1CpC,KAAKmC,EAASC,EACdmB,GAAY,GAGTA,GACHvD,KAAKsrD,GAAQwB,kBAIfyO,kBAAA,WACC,OAAO,IAAIA,EAAuBv7D,KAAKsrD,GAAStrD,KAAKm3D,GAASn3D,KAAKoB,EAAQpB,KAAKsB,EAAQtB,KAAKmC,IAG9Fo5D,qBAAA,WACC,MAAO,CACNrE,OAAQl3D,KAAKm3D,GACb91D,MAAOrB,KAAKoB,EACZG,MAAOvB,KAAKsB,EACZc,MAAOpC,KAAKmC,IAIdo5D,sBAAA,SAAWxO,GACV,IAAM6E,EAAa,KAAI5xD,KAAKm3D,GAAU,EAAI,OAAKn3D,KAAKoB,MAAUpB,KAAKsB,MAAUtB,KAAKmC,MAClF,OAAO4qD,EAAQ16B,IAAKu/B,IAGrB2J,wBAAA,SAAa16D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAMu6C,EAASH,EAAQyO,aAAaxuD,IAAKnM,GACzC,GAAc,MAAVqsD,EACHltD,KAAKwF,IACY,IAAhB0nD,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,QAEH,CACN,IAAMqK,EAAe53B,KAAKwtB,MAAO5e,EAAW1tC,IAC5CksD,EAAQyO,aAAah2D,IAAK3E,EAAQ02D,GAClCv3D,KAAKwF,IACkB,IAAtB+xD,EAAc,GACdA,EAAc,GACdA,EAAc,GACdA,EAAc,0BC/FlB,WACCxiD,EACA6hB,EAAev1B,EAAeE,EAAe0mC,EAAgB97B,GAE7DnM,KAAKsrD,GAAUv2C,EACf/U,KAAKm3D,IAAU,EACfn3D,KAAKu9B,GAAS3G,EACd52B,KAAKoB,EAASC,EACdrB,KAAKsB,EAASC,EACdvB,KAAKy7D,GAAUxzB,EACfjoC,KAAKyrD,GAAQt/C,EACbnM,KAAK4kB,GAAUgzC,GAAiB8D,OAChC17D,KAAKsC,MAAQ,IAAI64D,GAAqBpmD,EAAQ+iD,GAA0B/7C,OAAQg8C,GAAwB1+B,QACxGr5B,KAAK2D,OAAS,IAAI03D,GAAsBtmD,EAAQ,EAAG,GACnD/U,KAAK+0B,GAAS8iC,GAAgB6D,OAC9B17D,KAAK27D,QAAU,IAAIN,GAAsBtmD,EAAQ,EAAG,GACpD/U,KAAKyD,QAAU,IAAI83D,GAAuBxmD,GAAQ,EAAO,SAAU,EAAK,IACxE/U,KAAK4kD,GAAaoT,GAAoB4D,cACtC57D,KAAKmE,QAAU,IAAIk3D,GAAsBtmD,EAAQ,GAAI,IACrD/U,KAAKmwB,IAAY,EA6RnB,OA1RC3wB,sBAAIq8D,0BAAJ,WACC,OAAO77D,KAAKm3D,QAGb,SAAYD,GACPl3D,KAAKm3D,KAAYD,IACpBl3D,KAAKm3D,GAAUD,EACfl3D,KAAKsrD,GAAQwB,mDAIfttD,sBAAIq8D,yBAAJ,WACC,OAAO77D,KAAKu9B,QAGb,SAAW3G,GACV,GAAI52B,KAAKu9B,KAAW3G,EAAQ,CAC3B52B,KAAKu9B,GAAS3G,EAGd,IAAMrhB,EAASvV,KAAKsrD,GACdgI,EAAW/9C,EAAO+9C,SACxB,GAAgB,MAAZA,IAAsBA,EAAS1P,aAAcruC,GAGhD,OAFAvV,KAAK4sB,WAAQlrB,OACb6T,EAAOgO,UAKR,IAAMqJ,EAAQ5sB,KAAK4sB,MACb4F,EAAa5F,GAASA,EAAM4F,WAClC,GAAkB,MAAdA,EAYH,OAFAxyB,KAAK4sB,WAAQlrB,OACb6T,EAAOgO,UAVP,IAAK,IAAI3P,EAAI,EAAGG,EAAO6iB,EAAMjkB,OAAQiB,EAAIG,IAAQH,EAEhD,KADagjB,EAAOhjB,KACL4e,GAGd,OAFAxyB,KAAK4sB,WAAQlrB,OACb6T,EAAOgO,UAWVhO,EAAOu3C,mDAITttD,sBAAIq8D,0BAAJ,WACC,OAAO77D,KAAKy7D,QAGb,SAAYxzB,GACPjoC,KAAKy7D,KAAYxzB,IACpBjoC,KAAKy7D,GAAUxzB,EACfjoC,KAAKsrD,GAAQ/nC,4CAIf/jB,sBAAIq8D,yBAAJ,WACC,OAAO77D,KAAKoB,OAGb,SAAWC,GACNrB,KAAKoB,IAAWC,IACnBrB,KAAKoB,EAASC,EACdrB,KAAKsrD,GAAQwB,mDAIfttD,sBAAIq8D,yBAAJ,WACC,OAAO77D,KAAKsB,OAGb,SAAWC,GACNvB,KAAKsB,IAAWC,IACnBvB,KAAKsB,EAASC,EACdvB,KAAKsrD,GAAQwB,mDAIfttD,sBAAIq8D,wBAAJ,WACC,OAAO77D,KAAKyrD,QAGb,SAAUt/C,GACLnM,KAAKyrD,KAAUt/C,IAClBnM,KAAKyrD,GAAQt/C,EACbnM,KAAKsrD,GAAQwB,mDAIfttD,sBAAIq8D,0BAAJ,WACC,OAAO77D,KAAK4kB,QAGb,SAAYC,GACP7kB,KAAK4kB,KAAYC,IACpB7kB,KAAK4kB,GAAUC,EACf7kB,KAAKsrD,GAAQwB,mDAIfttD,sBAAIq8D,yBAAJ,WACC,OAAO77D,KAAK+0B,QAGb,SAAWS,GACNx1B,KAAK+0B,KAAWS,IACnBx1B,KAAK+0B,GAASS,EACdx1B,KAAKsrD,GAAQwB,mDAIfttD,sBAAIq8D,6BAAJ,WACC,OAAO77D,KAAK4kD,QAGb,SAAevvC,GACVrV,KAAK4kD,KAAevvC,IACvBrV,KAAK4kD,GAAavvC,EAClBrV,KAAKsrD,GAAQwB,mDAIfttD,sBAAIq8D,4BAAJ,WACC,OAAO77D,KAAKmwB,QAGb,SAAcC,GACTpwB,KAAKmwB,KAAcC,IACtBpwB,KAAKmwB,GAAYC,EACjBpwB,KAAKsrD,GAAQwB,mDAIf+O,iBAAA,SAAMh7D,GAmBL,OAlBIA,IACHb,KAAKwF,IACJ3E,EAAO+1B,MACP/1B,EAAOQ,MACPR,EAAOU,MACPV,EAAOonC,OACPpnC,EAAOsL,KACPtL,EAAOgkB,OACPhkB,EAAO20B,MACP30B,EAAOwU,UACPxU,EAAOuvB,UAERpwB,KAAKsC,MAAM2/C,KAAMphD,EAAOyB,OACxBtC,KAAK2D,OAAOs+C,KAAMphD,EAAO8C,QACzB3D,KAAKyD,QAAQw+C,KAAMphD,EAAO4C,SAC1BzD,KAAK27D,QAAQ1Z,KAAMphD,EAAO86D,SAC1B37D,KAAKmE,QAAQ89C,KAAMphD,EAAOsD,UAEpBnE,MAGR67D,gBAAA,SACCjlC,EAAgBv1B,EAAgBE,EAChC0mC,EAAiB97B,EAAe0Y,EAChC2Q,EAAyBngB,EACzB+a,GAEA,IAAI0rC,GAAiB,EACjBC,GAAoB,EAqDxB,OAnDa,MAATnlC,GAAiB52B,KAAKu9B,KAAW3G,IACpC52B,KAAKu9B,GAAS3G,EACdklC,GAAiB,GAGL,MAATz6D,GAAiBrB,KAAKoB,IAAWC,IACpCrB,KAAKoB,EAASC,EACd06D,GAAoB,GAGR,MAATx6D,GAAiBvB,KAAKsB,IAAWC,IACpCvB,KAAKsB,EAASC,EACdw6D,GAAoB,GAGP,MAAV9zB,GAAkBjoC,KAAKy7D,KAAYxzB,IACtCjoC,KAAKy7D,GAAUxzB,EACf6zB,GAAiB,GAGN,MAAR3vD,GAAgBnM,KAAKyrD,KAAUt/C,IAClCnM,KAAKyrD,GAAQt/C,EACb4vD,GAAoB,GAGP,MAAVl3C,GAAkB7kB,KAAK4kB,KAAYC,IACtC7kB,KAAK4kB,GAAUC,EACfk3C,GAAoB,GAGR,MAATvmC,GAAiBx1B,KAAK+0B,KAAWS,IACpCx1B,KAAK+0B,GAASS,EACdumC,GAAoB,GAGJ,MAAb1mD,GAAqBrV,KAAK4kD,KAAevvC,IAC5CrV,KAAK4kD,GAAavvC,EAClB0mD,GAAoB,GAGL,MAAZ3rC,GAAoBpwB,KAAKmwB,KAAcC,IAC1CpwB,KAAKmwB,GAAYC,EACjB2rC,GAAoB,GAGjBD,EACH97D,KAAKsrD,GAAQ/nC,UACHw4C,GACV/7D,KAAKsrD,GAAQwB,iBAGP9sD,MAGR67D,qBAAA,WACC,MAAO,CACNjlC,MAAO52B,KAAKu9B,GACZl8B,MAAOrB,KAAKoB,EACZG,MAAOvB,KAAKsB,EACZ2mC,OAAQjoC,KAAKy7D,GACbtvD,KAAMnM,KAAKyrD,GACX5mC,OAAQ7kB,KAAK4kB,GACbtiB,MAAOtC,KAAKsC,MAAMgsD,WAClB3qD,OAAQ3D,KAAK2D,OAAO2qD,WACpB94B,MAAOx1B,KAAK+0B,GACZtxB,QAASzD,KAAKyD,QAAQ6qD,WACtBj5C,UAAWrV,KAAK4kD,GAChB+W,QAAS37D,KAAK27D,QAAQrN,WACtBnqD,QAASnE,KAAKmE,QAAQmqD,WACtBl+B,SAAUpwB,KAAKmwB,KAIjB0rC,sBAAA,SAAW9O,GACV,IAAMiP,EAAkBh8D,KAAKsC,MAAM0rD,UAAWjB,GACxCkP,EAAmBj8D,KAAK2D,OAAOqqD,UAAWjB,GAC1CmP,EAAoBl8D,KAAKyD,QAAQuqD,UAAWjB,GAC5CoP,EAAoBn8D,KAAK27D,QAAQ3N,UAAWjB,GAC5CqP,EAAoBp8D,KAAKmE,QAAQ6pD,UAAWjB,GAC5C6E,EAAa,IAAI7E,EAAQ16B,IAAKryB,KAAKu9B,QAAYv9B,KAAKoB,MAAUpB,KAAKsB,MACrEyrD,EAAQ16B,IAAKryB,KAAKy7D,QAAaz7D,KAAKyrD,OAASzrD,KAAK4kB,OAAWo3C,MAC7DC,MAAoBj8D,KAAK+0B,OAAUmnC,MAAqBC,MACxDn8D,KAAK4kD,OAAcwX,OAAqBp8D,KAAKmwB,GAAY,EAAI,OACjE,OAAO48B,EAAQ16B,IAAKu/B,IAGrBiK,wBAAA,SAAah7D,EAAgBksD,GAC5B,IAAMxe,EAAYwe,EAAQxe,UAC1B,GAAI,GAAK1tC,GAAUA,EAAS0tC,EAAU57B,OAAS,CAC9C,IAAIu6C,EAASH,EAAQsP,MAAMrvD,IAAKnM,GAClB,MAAVqsD,IACHA,EAASvtB,KAAKwtB,MAAO5e,EAAW1tC,IAChCksD,EAAQsP,MAAM72D,IAAK3E,EAAQqsD,IAE5BltD,KAAKwF,IACJ+oC,EAAW2e,EAAQ,KAAS,GAC5BA,EAAQ,GACRA,EAAQ,GACR3e,EAAW2e,EAAQ,KAAS,OAC5BA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,GACRA,EAAQ,IACW,IAAjBA,EAAQ,KAEXltD,KAAKsC,MAAMm4D,YAAavN,EAAQ,GAAKH,GACrC/sD,KAAK2D,OAAO82D,YAAavN,EAAQ,GAAKH,GACtC/sD,KAAKyD,QAAQg3D,YAAavN,EAAQ,GAAKH,GACvC/sD,KAAK27D,QAAQlB,YAAavN,EAAQ,IAAMH,GACxC/sD,KAAKmE,QAAQs2D,YAAavN,EAAQ,IAAMH,yBCtT1C,WAAapyC,GAAb,MACC3U,YAAO2U,gBACPxU,EAAKgG,KAAOhG,EAAK0mD,UACjB1mD,EAAK8pB,KAAO9pB,EAAKm2D,UACjBn2D,EAAKooD,OAASpoD,EAAKo2D,YACnBp2D,EAAKjD,EAAUqqD,GAAeiP,OAC9Br2D,EAAKwd,GAAUynC,GAAa3D,IAC5BthD,EAAKmpD,IAAM,IAAIoL,GACfv0D,EAAKwmB,KAAOxmB,EAAKs2D,UACjBt2D,EAAKqoD,OAASjB,GAAegD,SAqF/B,OA3G8CzwD,OAyBnC48D,oBAAV,WAAA,WACC,OAAO,IAAIC,mBACV,WAAQx2D,EAAKy2D,sBACbl7D,EACA6rD,GAAesP,OACftP,GAAeuP,SAIPJ,oBAAV,WACC,OAAO,IAAItF,GACVp3D,MAAM,EACNutD,GAAewP,WACfxP,GAAeyP,aAIPN,sBAAV,WACC,OAAO,IAAIhF,GACV13D,MAAM,EACNutD,GAAe0P,aACf1P,GAAe2P,aACf3P,GAAe4P,aACf5P,GAAe6P,aACf7P,GAAe8P,cAIPX,oBAAV,WACC,OAAO,IAAIb,GACV77D,KACAutD,GAAe+P,WACf/P,GAAe0P,aACf1P,GAAe2P,aACf3P,GAAegQ,YACfhQ,GAAeiQ,YAMjBh+D,sBAAIk9D,0BAAJ,WACC,OAAO18D,KAAK2jB,QAGb,SAAY1gB,GACPjD,KAAK2jB,KAAY1gB,IACpBjD,KAAK2jB,GAAU1gB,EACfjD,KAAK8sD,mDAIPttD,sBAAIk9D,0BAAJ,WACC,OAAO18D,KAAKkD,OAGb,SAAYC,GACPnD,KAAKkD,IAAYC,IACpBnD,KAAKkD,EAAUC,EACfnD,KAAK8sD,mDAIPttD,sBAAIk9D,yBAAJ,WACC,OAAO18D,KAAK65B,QAGb,SAAWE,GACV,GAAI/5B,KAAK65B,KAAWE,EAAQ,CACd,MAATA,GACH/5B,KAAK65B,GAASE,EACd/5B,KAAKy9D,SAAW1jC,EAAMuG,MAEtBtgC,KAAK65B,QAASn4B,EACd1B,KAAKy9D,cAAW/7D,GAEjB,IAAM6T,EAASvV,KAAK+U,OACN,MAAVQ,GACHA,EAAOgO,+CAvGmC0vC,mBCX9C,4DA8GA,OA9G6CnzD,OAI5C49D,sBAAA,SAAW3Q,GACV,IAAMxsD,EAASyF,YAAMgoD,oBAAWjB,GAEhC,OADAxsD,EAAQ,IAAOP,KAAK0xD,OAAO1D,UAAWjB,GAC/BxsD,GAGEm9D,0BAAV,WACC,IAAMC,EAAY39D,KAAKuzD,KAAKx+C,OAC5B,OAAiB,MAAb4oD,GAAgD,MAA3BA,EAAUC,cAC3BD,EAAUC,gBAEX,GAGEF,gCAAV,SAA+BhM,GAC9B,IAAMl8B,EAAQk8B,EAAOl8B,MACrB,OAAIA,EAAQ20B,GAAkBK,oBACzBh1B,EAAQ20B,GAAkBO,oBACtB1qD,KAAK49D,gBAEL3xD,KAAK0iB,IAAK,EAAK3uB,KAAK49D,iBAGxBpoC,EAAQ20B,GAAkBO,oBACtBz+C,KAAKC,IAAK,EAAKlM,KAAK49D,iBAEpB,GAKAF,iCAAV,SAAgChM,GAC/B,IAAMnD,EAASvuD,KAAKuuD,OACpB,OAASA,EAAO2I,OAAS3I,EAAOnsD,MAAQpC,KAAK69D,oBAAqBnM,GAAW,GAG9EgM,wBAAA,SAAap4D,EAAWC,EAAW0vD,EAAYC,GAC9C,IAAMxD,EAAS1xD,KAAK0xD,OACdoM,EAA4C,GAAtC99D,KAAK+9D,qBAAsBrM,GACvC,GAAI1xD,KAAKg1D,gBAAiB1vD,EAAGC,EAAG0vD,EAAK6I,EAAK5I,EAAK4I,GAAQ,CACtD,IAAMv+C,EAAYu+C,EAAMA,EAClBE,EAAatM,EAAO/+C,OAC1B,GAAI,GAAKqrD,EAAa,CAGrB,IAFA,IAAMC,EAAcvM,EAAOnF,OACrB2R,EAAgBxM,EAAOlF,SACpB54C,EAAI,EAAGG,EAAOiqD,EAAa,EAAG12D,EAAK,EAAGsM,EAAIG,EAAMH,GAAK,EAAGtM,GAAM,EACtE,GAAI81C,GAAa8gB,EAAetqD,EAAI,GAAM,EAAI,CAC7C,IAAMuqD,EAAMF,EAAa32D,EAAK,GACxB82D,EAAMH,EAAa32D,EAAK,GACxB+2D,EAAMJ,EAAa32D,EAAK,GACxBg3D,EAAML,EAAa32D,EAAK,GAC9B,GAAI,GAAKo2D,EAAea,gBAAiBj5D,EAAGC,EAAG44D,EAAKC,EAAKC,EAAKC,EAAK/+C,GAClE,OAAO,EAIV,GAAI,EAAIy+C,GAAetM,EAAOl8B,MAAQ20B,GAAkBqU,QACnDphB,GAAa8gB,EAAe,GAAM,IAE/BC,EAAMF,EAAkB,GADxB32D,EAAM02D,EAAa,GAAM,IAEzBI,EAAMH,EAAa32D,EAAK,GACxB+2D,EAAMJ,EAAa,GACnBK,EAAML,EAAa,GACrB,GAAKP,EAAea,gBAAiBj5D,EAAGC,EAAG44D,EAAKC,EAAKC,EAAKC,EAAK/+C,IAClE,OAAO,GAMZ,OAAO,GAGDm+C,kBAAP,SACCp4D,EAAWC,EACX44D,EAAaC,EACbC,EAAaC,EACbG,GAaA,IAAMC,EAAML,EAAMF,EACZQ,EAAML,EAAMF,EACZQ,EAAMt5D,EAAI64D,EACVU,EAAMt5D,EAAI64D,EACV5wC,EAAIkxC,EAAMA,EAAMC,EAAMA,EACtBp/D,EAAIm/D,EAAME,EAAMD,EAAME,EACtB92D,EAAI62D,EAAMA,EAAMC,EAAMA,EAC5B,GAAI,KAASrxC,EAAI,CAChB,IAAMsxC,EAAK7yD,KAAKC,IAAK,EAAGD,KAAK0iB,IAAK,EAAGpvB,EAAIiuB,IAEzC,GADUA,EAAIsxC,EAAKA,EAAK,EAAIv/D,EAAIu/D,EAAK/2D,EAC7B02D,EACP,OAAOK,EAGT,OAAQ,MA5GmCpC,mBCG5C,WAAa7/C,EAA6B1Q,EAAc/J,EAAeozB,GAAvE,MACCxvB,YAAO+9C,GAAWgb,kBAClB54D,EAAK8pB,KAAKinC,QAAS,EACnB/wD,EAAKooD,OAAO/oD,KAAK,OAAM9D,OAAWA,EAAWU,GAC7C+D,EAAKurD,OAAS,IAAI5F,GAAiB3lD,EAAM0W,EAAU1Q,EAAMqpB,KAY3D,OAnB+B11B,OAU9Bk/D,kBAAA,WACC,IAAMtN,EAAS1xD,KAAK0xD,OACpB,OAAO,IAAIsN,EAAWtN,EAAO70C,SAAU60C,EAAOvlD,KAAMnM,KAAKuuD,OAAOnsD,MAAOsvD,EAAOl8B,OAAQysB,KAAMjiD,OAG7Fg/D,4BAAA,SAAiB15D,EAAWC,EAAW0vD,EAAYC,GAClD,IAAM/oD,EAAOF,KAAKC,IAAK,EAAGlM,KAAK0xD,OAAOvlD,MACtC,OAAOnG,YAAMgvD,0BAAiB1vD,EAAGC,EAAG0vD,EAAK9oD,EAAM+oD,EAAK/oD,OAjBvBuxD,kBC6C9B,WAAauB,EAAsBC,EAAiBC,EAAiBC,EAAgBC,GACpFr/D,KAAKi/D,OAASA,EAEdj/D,KAAKs/D,kBAAoB,EAEzBt/D,KAAKu/D,aAAeL,EACpBl/D,KAAKw/D,YAAcJ,EACnBp/D,KAAKy/D,YAAcN,EACnBn/D,KAAK0/D,WAAaL,EAElBr/D,KAAK2/D,UAAYj5D,IACjB1G,KAAK4/D,WAAa,EAClB5/D,KAAK6/D,YAAcn5D,IACnB1G,KAAK8/D,aAAe,EAEpB9/D,KAAK+rD,MAAQrlD,IACb1G,KAAKgsD,MAAQtlD,IACb1G,KAAK+/D,eAAiBr5D,IACtB1G,KAAKggE,eAAiBt5D,IACtB1G,KAAKigE,eAAiBv5D,IACtB1G,KAAKkgE,eAAiBx5D,IACtB1G,KAAKmgE,WAAaz5D,IAClB1G,KAAK8/B,YAAcp5B,IACnB1G,KAAKogE,YAAc15D,IACnB1G,KAAKqgE,WAAa35D,IAClB1G,KAAKmD,OAASuD,IACd1G,KAAKiD,OAASyD,IAEd1G,KAAK4F,QAAU,KACf5F,KAAKsgE,mBAAqB55D,IAwN5B,OArNC65D,iBAAA,SAAMpS,GAEL,OADAA,EAAMmF,SAAWtzD,KACVA,MAKRugE,yBAAA,SAAcpS,GACb,OAAO,GAGRoS,sBAAA,WACC,OAAOvgE,KAAKi/D,QAGbsB,4BAAA,WACC,OAAOvgE,KAAKu/D,cAGbgB,2BAAA,WACC,OAAOvgE,KAAKw/D,aAGbe,2BAAA,WACC,OAAOvgE,KAAKy/D,aAGbc,0BAAA,WACC,OAAOvgE,KAAK0/D,YAGHa,+BAAV,SAA8BpS,GAE7B,OADAA,EAAMziC,kBACCyiC,EAAMtsC,UAAU2+C,cAGdD,sBAAV,SAAqBpS,GACpB,OAAOA,EAAMvoD,SAAWgH,UAAQ6zD,OAGvBF,iCAAV,SAAgC36D,GAC/B,IAAM86D,EAAa96D,EAInB,OAHuB,MAAnB86D,EAAW15D,MACdpB,EAAQs6B,YAEFwgC,EAAWr5D,WAGTk5D,yBAAV,SAAwB36D,GACvB,OAAQA,EAAgBoB,MAGfu5D,sBAAV,SAAqBl/D,EAAeE,EAAe29D,EAAiB3F,EAAeoH,GAOlF,IANA,IAAMC,EAAOzsD,QAAM0sD,sBAAuBx/D,EAAOE,EAAOvB,KAAKi/D,OAAO6B,WAC9D33D,EAAIy3D,EAAM,GACV1jB,EAAI0jB,EAAM,GACVrhE,EAAIqhE,EAAM,GACVpzC,EAAIozC,EAAM,GAEPhtD,EAAc,EAAVsrD,EAAanrD,EAAOH,EAAY,EAAR2lD,EAAW3lD,EAAIG,EAAMH,GAAK,EAC9D+sD,EAAQ/sD,EAAI,GAAMzK,EAClBw3D,EAAQ/sD,EAAI,GAAMspC,EAClByjB,EAAQ/sD,EAAI,GAAMrU,EAClBohE,EAAQ/sD,EAAI,GAAM4Z,GAIV+yC,4BAAV,SAA2BtB,EAAsB9Q,EAAeqR,GAC/D,IAAMvvC,EAAOk+B,EAAMl+B,KACb8wC,EAAY5S,EAAM3+C,SAAWygB,EAAKinC,OAClC71D,EAAQ4uB,EAAK5uB,MACbE,EAASw/D,EAAY9wC,EAAK1uB,MAAQ,EACpCF,IAAUrB,KAAK2/D,WAAap+D,IAAUvB,KAAK4/D,YAC9C5/D,KAAK2/D,UAAYt+D,EACjBrB,KAAK4/D,UAAYr+D,EACjB09D,EAAO+B,gBAAgBrgE,SAEvBX,KAAKihE,UACJ5/D,EAAOE,EACPvB,KAAKu/D,aACLC,EACAP,EAAOiC,cAKAX,8BAAV,SAA6BtB,EAAsB9Q,EAAeqR,GACjE,IAAMjR,EAASJ,EAAMI,OACfwS,EAAY5S,EAAM3+C,SAAW++C,EAAO2I,QAAU,EAAI3I,EAAOnsD,MACzDf,EAAQktD,EAAOltD,MACfE,EAASw/D,EAAYxS,EAAOhtD,MAAQ,EACtCF,IAAUrB,KAAK6/D,aAAet+D,IAAUvB,KAAK8/D,cAChD9/D,KAAK6/D,YAAcx+D,EACnBrB,KAAK8/D,YAAcv+D,EACnB09D,EAAOkC,kBAAkBxgE,SAEzBX,KAAKihE,UACJ5/D,EAAOE,EACPvB,KAAKu/D,aACLC,EACAP,EAAOmC,gBAKAb,qCAAV,SAAoCtB,EAAsB9Q,EAAeqR,GACxEx/D,KAAKqhE,gBAAiBpC,EAAQ9Q,EAAOqR,GACrCx/D,KAAKshE,kBAAmBrC,EAAQ9Q,EAAOqR,IAG9Be,qBAAV,SAAoBp0D,EAAc2zB,EAAqBv/B,GACtD,IAAMghE,EAAkBhU,GAAeiU,iBACvC,GA5LmB,KA4LR1hC,EAAc,CACxB,IAAM2hC,EAAOt1D,EAAO2zB,EACpB,GA9LkB,KA8LP2hC,EAAO,CACjB,IAAMC,EAAMH,EAAkBE,EACxBE,EAAMJ,EAAkBt1D,KAAKC,IAhMlB,KAgM6BC,GACxCy1D,EAAM,EAAI31D,KAAKC,IAjMJ,KAiMe,EAAI4zB,EAAc3zB,GAClD5L,EAAQ,GAAMqhE,EACdrhE,EAAQ,GAAMmhE,EACdnhE,EAAQ,GAAMohE,OAERD,EAAMH,EAtMK,KAuMXI,EAAMJ,EAAkBt1D,KAAKC,IAvMlB,KAuM6BC,GACxCy1D,EAAM,EAxMK,KAyMjBrhE,EAAQ,GAAMqhE,EACdrhE,EAAQ,GAAMmhE,EACdnhE,EAAQ,GAAMohE,MAET,CAEN,IAAME,EAAKN,EAAkBt1D,KAAKC,IA/MhB,KA+M2BC,GAC7C5L,EAAQ,GAAM,EACdA,EAAQ,GAAMshE,EACdthE,EAAQ,GAAMshE,EAEf,OAAOthE,GAGEggE,uBAAV,SACCtB,EACAC,EAAiBE,EACjB0C,EAAaC,EAAaC,EAAaC,EAAaC,EAAaC,GASjE,IAPA,IAAMC,EAAQnD,EAAOmD,MACfC,EAAcpD,EAAOoD,YACrBC,EAAYrD,EAAOqD,UACnB5zC,EAAmB,EAAVwwC,EACTnrD,EAAO2a,EAAkB,EAAT0wC,EAGbxrD,EAAI8a,EAAQlU,EAFI,EAAV0kD,EAEkB3xC,EADR,EAAV2xC,EAC8BtrD,EAAIG,EAAMH,GAAK,EAAG4G,GAAK,EAAG+S,GAAK,EAAI,CAC/E,IAAMg1C,EAAKD,EAAW9nD,EAAI,GACpBgoD,EAAKF,EAAW9nD,EAAI,GAC1B4nD,EAAOxuD,EAAI,GAAMkuD,EAAMS,EACvBH,EAAOxuD,EAAI,GAAMmuD,EAAMS,EACvBH,EAAa90C,EAAI,GAAMy0C,EACvBK,EAAa90C,EAAI,GAAM00C,EACvBI,EAAa90C,EAAI,GAAM20C,EACvBG,EAAa90C,EAAI,GAAM40C,IAIf5B,yBAAV,SACCtB,EACAC,EAAiBE,EACjBwC,EAAaF,EAAaC,EAC1BG,EAAaC,EAAaC,EAAaC,EAAaC,EAAaC,GASjE,IAPA,IAAMC,EAAQnD,EAAOmD,MACfC,EAAcpD,EAAOoD,YACrBC,EAAYrD,EAAOqD,UACnB5zC,EAAmB,EAAVwwC,EACTnrD,EAAO2a,EAAkB,EAAT0wC,EAGbxrD,EAAI8a,EAAQlU,EAFI,EAAV0kD,EAEkB3xC,EADR,EAAV2xC,EAC8BtrD,EAAIG,EAAMH,GAAK,EAAG4G,GAAK,EAAG+S,GAAK,EAAI,CAC/E,IAAMg1C,EAAKD,EAAW9nD,EAAI,GACpBgoD,EAAKF,EAAW9nD,EAAI,GAEtB,GADO8nD,EAAW9nD,EAAI,IAEzB4nD,EAAOxuD,EAAI,GAAMguD,EAAMW,EACvBH,EAAOxuD,EAAI,GAAMguD,EAAMY,EACvBH,EAAa90C,EAAI,GAAMm0C,EACvBW,EAAa90C,EAAI,GAAMm0C,EACvBW,EAAa90C,EAAI,GAAMo0C,EACvBU,EAAa90C,EAAI,GAAMo0C,IAEvBS,EAAOxuD,EAAI,GAAMkuD,EAAMS,EACvBH,EAAOxuD,EAAI,GAAMmuD,EAAMS,EACvBH,EAAa90C,EAAI,GAAMy0C,EACvBK,EAAa90C,EAAI,GAAM00C,EACvBI,EAAa90C,EAAI,GAAM20C,EACvBG,EAAa90C,EAAI,GAAM40C,KAKhB5B,uBAAV,SAAsBpC,EAAaC,EAAaC,EAAaC,GAC5D,IAAMmE,EAAOpE,EAAMF,EACbuE,EAAOpE,EAAMF,EACnB,OAAOnyD,KAAK0nB,KAAM8uC,EAAOA,EAAOC,EAAOA,IAGxCnC,sBAAA,SAAWoC,GACV,IAAM/8D,EAAU5F,KAAK4F,SAAWgH,UAAQ6zD,MAClC3sC,EAAcluB,EAAQkuB,YAC5B,GAAIA,IAAgB6uC,EAAQ7uC,YAAc,CACzC6uC,EAAQ7uC,YAAcA,EACtB,IAAM2rC,EAAcz/D,KAAKy/D,YACzBkD,EAAQ/vD,KAAMhN,EAAS65D,wBClS1B,cAQA,OAPQmD,eAAP,SAAqBzU,EAAe5tD,GACnC,IAAMoS,EAASw7C,EAAMxhC,KAAKiK,MAAMjkB,OAC1B4mD,EAAmC,GAA3BttD,KAAKkhB,KAAMxa,EAAS,IAGlC,OAFApS,EAAOi/D,YAAcjG,GAAS,EAC9Bh5D,EAAOm/D,WAAanG,GAAS,EACtBh5D,uBC8BR,WACC0+D,EACAC,EAAiBC,EACjB0D,EAAiBC,EACjB1D,EAAgBC,GAJjB,MAMCr5D,YAAOi5D,EAAQC,EAASC,EAASC,EAAQC,gBAEzCl5D,EAAK48D,SAAWr8D,IAChBP,EAAK68D,WAAa,OAClB78D,EAAK0yB,UAAY,GACjB1yB,EAAK88D,YAAc,KACnB98D,EAAK+8D,uBAAyBx8D,IAC9BP,EAAKg9D,UAAYz8D,IACjBP,EAAKi9D,UAAY18D,IACjBP,EAAKk9D,WAAa38D,IAClBP,EAAKm9D,UAAY58D,IACjBP,EAAKo9D,oBAAsB78D,IAC3BP,EAAKq9D,kBAAoB98D,IACzBP,EAAKs9D,qBAAuB/8D,IAC5BP,EAAKu9D,mBAAqBh9D,IAC1BP,EAAKw9D,iBAAmBj9D,IACxBP,EAAKy9D,iBAAmBl9D,IACxBP,EAAK09D,iBAAmBn9D,IACxBP,EAAK29D,sBAAwBp9D,IAC7BP,EAAK49D,oBAAsBr9D,IAC3BP,EAAK69D,cAAgBt9D,IACrBP,EAAK89D,sBAAwBv9D,IAC7BP,EAAK+9D,oBAAsBx9D,IAC3BP,EAAKg+D,cAAe,EACpBh+D,EAAKi+D,gBAAkBvB,EACvB18D,EAAKk+D,eAAiBvB,IAkkCxB,OA3nCiDhjE,OA4DhDwkE,yBAAA,SAAcnW,GACb,QAAInoD,YAAM49C,uBAAcuK,IACLyU,GAAoB2B,aAAcpW,EAAOnuD,KAAKi/D,OAAOuF,WACpDhF,cAAgBx/D,KAAKokE,iBAKhCE,wBAAV,SAAuBrF,EAAsB9Q,GAC5C,IAAMqR,EAAcx/D,KAAKw/D,YAAcx/D,KAAKokE,gBAC5CpkE,KAAKykE,yBAA0BxF,EAAQ9Q,EAAOqR,IAGrC8E,wBAAV,SACCI,EACAC,EACAC,EACA1F,EACA2F,EACAC,EACA1iE,EAAeyD,EACf2B,EAAYE,EACZD,EAAYE,EACZkB,EAAYE,EACZD,EAAYE,EACZ+7D,EAAaC,EACbC,EAAaC,EACb3kE,GAEA,OAAQmkE,GACR,KAAK5M,GAA0BvsD,KAC9B,OAAQo5D,GACR,KAAK5M,GAAwB5sD,IAC5B5K,EAAO+E,EAAIkC,EACRu9D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAImC,EACRs9D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,GACrB,MACD,KAAK/M,GAAwB1+B,OAC5B94B,EAAO+E,EAAI,IAAQkC,EAAKsB,GACrBi8D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU,GAAMr5D,GAC3BtF,EAAOgF,EAAI,IAAQmC,EAAKsB,GACrBg8D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU,GAAMr5D,GAC3B,MACD,KAAKkyD,GAAwB1sD,OAC5B9K,EAAO+E,EAAIwD,EACRi8D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAIyD,EACRg8D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBoN,YAC5B5kE,EAAO+E,EAAIkC,EACRu9D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAImC,EACRs9D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBqN,eAC5B7kE,EAAO+E,EAAIwD,EACRi8D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAIyD,EACRg8D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,GAGtB,MACD,KAAKhN,GAA0B/7C,OAC9B,OAAQ4oD,GACR,KAAK5M,GAAwB5sD,IAC5B5K,EAAO+E,EAAI,IAAQkC,EAAKC,GACrBs9D,GAAQH,EAAU,GAAMxiE,GACxB6iE,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAI,IAAQmC,EAAKC,GACrBq9D,GAAQJ,EAAU,GAAMxiE,GACxB8iE,GAAQhG,EAAU4F,GACrB,MACD,KAAK/M,GAAwB1+B,OAC5B94B,EAAO+E,EAAI,IAAQkC,EAAKqB,GACrBk8D,GAAQH,EAAU,GAAMxiE,GACxB6iE,GAAQ/F,EAAU,GAAMr5D,GAC3BtF,EAAOgF,EAAI,IAAQmC,EAAKqB,GACrBi8D,GAAQJ,EAAU,GAAMxiE,GACxB8iE,GAAQhG,EAAU,GAAMr5D,GAC3B,MACD,KAAKkyD,GAAwB1sD,OAC5B9K,EAAO+E,EAAI,IAAQwD,EAAKD,GACrBk8D,GAAQH,EAAU,GAAMxiE,GACxB6iE,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAI,IAAQyD,EAAKD,GACrBi8D,GAAQJ,EAAU,GAAMxiE,GACxB8iE,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBoN,YAC5B5kE,EAAO+E,EAAI,IAAQkC,EAAKC,GACrBs9D,GAAQH,EAAU,GAAMxiE,GACxB6iE,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAI,IAAQmC,EAAKC,GACrBq9D,GAAQJ,EAAU,GAAMxiE,GACxB8iE,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBqN,eAC5B7kE,EAAO+E,EAAI,IAAQwD,EAAKD,GACrBk8D,GAAQH,EAAU,GAAMxiE,GACxB6iE,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAI,IAAQyD,EAAKD,GACrBi8D,GAAQJ,EAAU,GAAMxiE,GACxB8iE,GAAQhG,EAAU4F,GAGtB,MACD,KAAKhN,GAA0BrsD,MAC9B,OAAQk5D,GACR,KAAK5M,GAAwB5sD,IAC5B5K,EAAO+E,EAAImC,EACRs9D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAIoC,EACRq9D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,GACrB,MACD,KAAK/M,GAAwB1+B,OAC5B94B,EAAO+E,EAAI,IAAQmC,EAAKoB,GACrBk8D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU,GAAMr5D,GAC3BtF,EAAOgF,EAAI,IAAQoC,EAAKoB,GACrBi8D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU,GAAMr5D,GAC3B,MACD,KAAKkyD,GAAwB1sD,OAC5B9K,EAAO+E,EAAIuD,EACRk8D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAIwD,EACRi8D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBoN,YAC5B5kE,EAAO+E,EAAImC,EACRs9D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAIoC,EACRq9D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBqN,eAC5B7kE,EAAO+E,EAAIuD,EACRk8D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAIwD,EACRi8D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,GAGtB,MACD,KAAKhN,GAA0BuN,aAC9B,OAAQV,GACR,KAAK5M,GAAwB5sD,IAC5B5K,EAAO+E,EAAIkC,EACRu9D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAImC,EACRs9D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,GACrB,MACD,KAAK/M,GAAwB1+B,OAC5B94B,EAAO+E,EAAI,IAAQkC,EAAKsB,GACrBi8D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU,GAAMr5D,GAC3BtF,EAAOgF,EAAI,IAAQmC,EAAKsB,GACrBg8D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU,GAAMr5D,GAC3B,MACD,KAAKkyD,GAAwB1sD,OAC5B9K,EAAO+E,EAAIwD,EACRi8D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAIyD,EACRg8D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBoN,YAC5B5kE,EAAO+E,EAAIkC,EACRu9D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAImC,EACRs9D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBqN,eAC5B7kE,EAAO+E,EAAIwD,EACRi8D,GAAQH,EAAUC,EAAWziE,GAC7B6iE,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAIyD,EACRg8D,GAAQJ,EAAUC,EAAWziE,GAC7B8iE,GAAQhG,EAAU4F,GAGtB,MACD,KAAKhN,GAA0BwN,cAC9B,OAAQX,GACR,KAAK5M,GAAwB5sD,IAC5B5K,EAAO+E,EAAImC,EACRs9D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAIoC,EACRq9D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,GACrB,MACD,KAAK/M,GAAwB1+B,OAC5B94B,EAAO+E,EAAI,IAAQmC,EAAKoB,GACrBk8D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU,GAAMr5D,GAC3BtF,EAAOgF,EAAI,IAAQoC,EAAKoB,GACrBi8D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU,GAAMr5D,GAC3B,MACD,KAAKkyD,GAAwB1sD,OAC5B9K,EAAO+E,EAAIuD,EACRk8D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAIwD,EACRi8D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBoN,YAC5B5kE,EAAO+E,EAAImC,EACRs9D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,EAAWj/D,GAChCtF,EAAOgF,EAAIoC,EACRq9D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,EAAWj/D,GAChC,MACD,KAAKkyD,GAAwBqN,eAC5B7kE,EAAO+E,EAAIuD,EACRk8D,GAAQH,EAAUC,GAClBI,GAAQ/F,EAAU4F,GACrBvkE,EAAOgF,EAAIwD,EACRi8D,GAAQJ,EAAUC,GAClBK,GAAQhG,EAAU4F,MAOdR,sBAAV,SAAqBllD,EAAYE,EAAYimD,EAAcC,EAAcjlE,GACxE,IAAMjB,EAAI8f,EAAKA,EAAKE,EAAKA,EACzB,GA7TmB,KA6TRhgB,EAAI,CACd,IAAM4J,EAAI+C,KAAK0nB,KAAMr0B,GACfmmE,EAAK,EAAIv8D,EAEf,OADA3I,EAAOiF,IAAK4Z,EAAKqmD,EAAInmD,EAAKmmD,GACnBv8D,EAGP,OADA3I,EAAOiF,IAAK+/D,EAAMC,GACX,GAIClB,uCAAV,SAAsChiE,GACrC,OAAQA,GACR,KAAKw1D,GAA0BvsD,KAC9B,OAAOwsD,GAAwB1sD,OAChC,KAAKysD,GAA0B/7C,OAC9B,OAAOg8C,GAAwB1+B,OAChC,KAAKy+B,GAA0BrsD,MAC9B,OAAOssD,GAAwB5sD,IAChC,KAAK2sD,GAA0BuN,aAC9B,OAAOtN,GAAwBqN,eAChC,KAAKtN,GAA0BwN,cAC9B,OAAOvN,GAAwBoN,cAIvBb,qCAAV,SAAoChiE,GACnC,OAAQA,GACR,KAAKy1D,GAAwB5sD,IAC5B,OAAO2sD,GAA0BvsD,KAClC,KAAKwsD,GAAwB1+B,OAC5B,OAAOy+B,GAA0B/7C,OAClC,KAAKg8C,GAAwB1sD,OAC5B,OAAOysD,GAA0BrsD,MAClC,KAAKssD,GAAwBoN,YAC5B,OAAOrN,GAA0BuN,aAClC,KAAKtN,GAAwBqN,eAC5B,OAAOtN,GAA0BwN,gBAIzBhB,sCAAV,SAAqChiE,GACpC,OAAQA,GACR,KAAKw1D,GAA0BvsD,KAC9B,OAAOwsD,GAAwB5sD,IAChC,KAAK2sD,GAA0B/7C,OAC9B,OAAOg8C,GAAwB1+B,OAChC,KAAKy+B,GAA0BrsD,MAC9B,OAAOssD,GAAwB1sD,OAChC,KAAKysD,GAA0BuN,aAC9B,OAAOtN,GAAwBoN,YAChC,KAAKrN,GAA0BwN,cAC9B,OAAOvN,GAAwBqN,iBAIvBd,oCAAV,SAAmChiE,GAClC,OAAQA,GACR,KAAKy1D,GAAwB5sD,IAC5B,OAAO2sD,GAA0BrsD,MAClC,KAAKssD,GAAwB1+B,OAC5B,OAAOy+B,GAA0B/7C,OAClC,KAAKg8C,GAAwB1sD,OAC5B,OAAOysD,GAA0BvsD,KAClC,KAAKwsD,GAAwBoN,YAC5B,OAAOrN,GAA0BwN,cAClC,KAAKvN,GAAwBqN,eAC5B,OAAOtN,GAA0BuN,eAIzBf,6BAAV,SAA4BrF,EAAsB9Q,EAAeuX,GAChE,IAAM/4C,EAAOwhC,EAAMxhC,KACbo2C,EAAWp2C,EAAKxgB,KAChB62D,EAAar2C,EAAKsb,OAClBpP,EAAYlM,EAAKiK,MACjB0sC,EAAY32C,EAAK6I,MACjB+tC,EAAsB52C,EAAKrqB,MAAMs1B,WACjC4rC,EAAoB72C,EAAKrqB,MAAMo1B,SAC/B+rC,EAAuB92C,EAAKhpB,OAAOi0B,WACnC8rC,EAAqB/2C,EAAKhpB,OAAO+zB,SACjCosC,EAAwBn3C,EAAKgvC,QAAQ/jC,WACrCmsC,EAAsBp3C,EAAKgvC,QAAQjkC,SACnCssC,EAAgBr3C,EAAKtX,UACrB4uD,EAAwBt3C,EAAKxoB,QAAQyzB,WACrCssC,EAAsBv3C,EAAKxoB,QAAQuzB,SACnCysC,EAAex3C,EAAKyD,SACpB6yC,EAAct2C,EAAK/mB,SAAWgH,UAAQ6zD,MACtCyC,EAAyBljE,KAAK2lE,qBAAsB1C,GAEpD2C,EAAiB/sC,IAAc74B,KAAK64B,WAAamqC,IAAehjE,KAAKgjE,WACrE6C,EAAqB9C,IAAa/iE,KAAK+iE,SACvC+C,EAAsBxC,IAActjE,KAAKsjE,UACzCyC,EAAsBxC,IAAwBvjE,KAAKujE,qBACxDC,IAAsBxjE,KAAKwjE,kBACtBwC,EAAuBvC,IAAyBzjE,KAAKyjE,sBAC1DC,IAAuB1jE,KAAK0jE,mBACvBuC,EAAwBnC,IAA0B9jE,KAAK8jE,uBAC5DC,IAAwB/jE,KAAK+jE,qBAC7BE,IAA0BjkE,KAAKikE,uBAC/BC,IAAwBlkE,KAAKkkE,oBACxBgC,EAA0BlC,IAAkBhkE,KAAKgkE,cACjDmC,EAAsBnmE,KAAKmkE,eAAiBA,EAC5CiC,EAAqBnD,IAAgBjjE,KAAKijE,aAC/CC,IAA2BljE,KAAKkjE,uBAEjC,GAAI0C,GAAiBC,GAAqBC,GACzCC,GAAsBC,GAAuBC,GAC7CC,GAA0BC,GAAqBC,EAAmB,CAClEpmE,KAAK+iE,SAAWA,EAChB/iE,KAAKgjE,WAAaA,EAClBhjE,KAAK64B,UAAYA,EACjB74B,KAAKsjE,UAAYA,EACjBtjE,KAAKujE,oBAAsBA,EAC3BvjE,KAAKwjE,kBAAoBA,EACzBxjE,KAAKyjE,qBAAuBA,EAC5BzjE,KAAK0jE,mBAAqBA,EAC1B1jE,KAAK8jE,sBAAwBA,EAC7B9jE,KAAK+jE,oBAAsBA,EAC3B/jE,KAAKgkE,cAAgBA,EACrBhkE,KAAKikE,sBAAwBA,EAC7BjkE,KAAKkkE,oBAAsBA,EAC3BlkE,KAAKmkE,aAAeA,EACpBnkE,KAAKijE,YAAcA,EACnBjjE,KAAKkjE,uBAAyBA,EAE1B2C,IAEH7lE,KAAKqjE,WAAa38D,KAWnB,IAAMyF,EAAOgiD,EAAMhiD,KACbgoD,EAAc,GAAThoD,EAAK7G,EACV8uD,EAAc,GAATjoD,EAAK5G,EAChB4oD,EAAMziC,kBACN,IAAM8kC,EAAoBrC,EAAMtsC,UAAU2uC,kBACpCxkC,EAAOizC,EAAOjzC,KACpBA,EAAKxmB,KAAM2uD,GAAKC,GAChB5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMxkB,EAAKwkB,EAAK1mB,EACVoC,EAAKskB,EAAKzmB,EAChBymB,EAAKxmB,KAAM2uD,GAAKC,GAChB5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMvkB,EAAKukB,EAAK1mB,EACVqC,EAAKqkB,EAAKzmB,EAChBymB,EAAKxmB,KAAM2uD,GAAKC,GAChB5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMnjB,EAAKmjB,EAAK1mB,EACVyD,EAAKijB,EAAKzmB,EACVuD,EAAKtB,GAAMqB,EAAKpB,GAChBuB,EAAKtB,GAAMqB,EAAKpB,GAGhB0+D,EAAKrmE,KAAKsmE,WAAY9+D,EAAIE,EAAID,EAAIE,GACxC3H,KAAKw5D,UAAWhJ,EAAkBhjC,EAAGgjC,EAAkBjxD,EAAG,EAAG,EAAGysB,GAChE,IAAI+4C,EAAM/4C,EAAK1mB,EACX0/D,EAAMh5C,EAAKzmB,EAGTghE,EAAKvmE,KAAKsmE,WAAY9+D,EAAIE,EAAIoB,EAAIE,GACxChJ,KAAKw5D,UAAWhJ,EAAkBzoD,EAAGyoD,EAAkBlxD,EAAG,EAAG,EAAG0sB,GAWhE,IAVA,IAAIi5C,EAAMj5C,EAAK1mB,EACX4/D,EAAMl5C,EAAKzmB,EAGXnD,EAAQ,EACRyD,EAAS,EACT2gE,EAAa,EACXC,EAAax6D,KAAKC,IAAK,EAAG62D,EAAWgB,GACvC7wC,EAAY,EACVwzC,GAAsBhB,EAAUlzC,WAC7B5e,GAAI,EAAGG,GAAO8kB,EAAUlmB,OAAQiB,GAAIG,KAAQH,GAElC,QADZia,GAAYgL,EAAWjlB,KAGhB,OADN9M,GAAO4/D,GAAqB74C,OAEjCqF,GAAalzB,KAAK2mE,UAAW/yD,GAAGG,GAAM8kB,EAAW/xB,GAAK4mB,QAASo2C,GAC/D0C,EAAa1/D,GAAKjB,SAGnBzD,EAAQ6J,KAAKC,IAAK9J,EAAO8wB,GACzBA,EAAY,EACZrtB,GAAU4gE,GAIZ,IAAMxkD,GAAQ8gD,EAAW2C,EAAU93C,KAAKzhB,KACxC/J,EAAQ6J,KAAKC,IAAK9J,EAAO8wB,GAAcjR,GACvCukD,GAAcvkD,GACdpc,GAAUk9D,EAGV,IAAI6D,GAAM,EACNC,GAAM,EACNC,GAAmBpgE,IACvB,OAAQs9D,GACR,KAAKhM,GAAoB4D,cAmBxB,GAlBA57D,KAAK+mE,YACJxD,EACAC,EACAC,EACAC,EACAO,EACAC,EACA9hE,EAAOyD,EACP2B,EAAIE,EACJD,EAAIE,EACJkB,EAAIE,EACJD,EAAIE,EACJ+7D,EAAKC,EACLC,EAAKC,EACLl5C,GAED46C,GAAM56C,EAAK1mB,EACXuhE,GAAM76C,EAAKzmB,EACP4+D,EACH,OAAQZ,GACR,KAAKzL,GAA0BvsD,KAC/B,KAAKusD,GAA0B/7C,OAC/B,KAAK+7C,GAA0BrsD,MAC9B,OAAQ+3D,GACR,KAAKzL,GAAwB5sD,IAC7B,KAAK4sD,GAAwB1+B,OAC7B,KAAK0+B,GAAwB1sD,OAC5By7D,GAAmBT,EAA6B,EAAxBpC,GAM3B,MACD,KAAKjM,GAAoBgP,cA2BxB,GAzBAh7C,EAAKxmB,IAAKy/D,EAAKC,GACfD,GAAOF,EACPG,GAAOF,EACPD,EAAM/4C,EAAK1mB,EACX0/D,EAAMh5C,EAAKzmB,EAGXvF,KAAK+mE,YACJ/mE,KAAKinE,yBAA0BzD,GAC/BxjE,KAAKknE,2BAA4B3D,GACjCG,EACAD,EACAS,EACAD,EACA7hE,EAAOyD,EACP4B,EAAIE,EACJkB,EAAIE,EACJD,EAAIE,EACJxB,EAAIE,EACJq9D,EAAKC,EACLC,EAAKC,EACLl5C,GAED46C,GAAM56C,EAAK1mB,EACXuhE,GAAM76C,EAAKzmB,EACP4+D,EACH,OAAQX,GACR,KAAKzL,GAAwB5sD,IAC7B,KAAK4sD,GAAwB1+B,OAC7B,KAAK0+B,GAAwB1sD,OAC5B,OAAQk4D,GACR,KAAKzL,GAA0BvsD,KAC/B,KAAKusD,GAA0B/7C,OAC/B,KAAK+7C,GAA0BrsD,MAC9Bq7D,GAAmBP,EAA2B,EAAtBrC,GAM3B,MACD,KAAKlM,GAAoBmP,cA2BxB,GAzBAn7C,EAAKxmB,IAAKy/D,EAAKC,GACfD,EAAMF,EACNG,EAAMF,EACND,GAAO/4C,EAAK1mB,EACZ0/D,GAAOh5C,EAAKzmB,EAGZvF,KAAK+mE,YACJ/mE,KAAKonE,wBAAyB5D,GAC9BxjE,KAAKqnE,0BAA2B9D,GAChCG,EACAD,EACAS,EACAD,EACA7hE,EAAOyD,EACPiD,EAAIE,EACJxB,EAAIE,EACJD,EAAIE,EACJkB,EAAIE,EACJg8D,EAAKC,EACLC,EAAKC,EACLl5C,GAED46C,GAAM56C,EAAK1mB,EACXuhE,GAAM76C,EAAKzmB,EACP4+D,EACH,OAAQX,GACR,KAAKzL,GAAwB5sD,IAC7B,KAAK4sD,GAAwB1+B,OAC7B,KAAK0+B,GAAwB1sD,OAC5B,OAAQk4D,GACR,KAAKzL,GAA0BvsD,KAC/B,KAAKusD,GAA0B/7C,OAC/B,KAAK+7C,GAA0BrsD,MAC9Bq7D,GAAmBP,EAA2B,EAAtBrC,IAU5B,IAAM1P,GAAY7nC,EAAK8nC,MAAQ9nC,EAAK8nC,OAAS,IAAIxuD,aAAc,GAC/D,GAAI6gE,GAAmB1kE,EAAQ,CAC9B,IAAMklE,GAAwC,IAA7BllE,EAAQ0kE,IACzBtS,GAAW,GAAMoS,GAAM7B,EAAMuC,GAC7B9S,GAAW,GAAMqS,GAAM7B,EAAMsC,GAC7B9S,GAAW,GAAMuQ,EACjBvQ,GAAW,GAAMwQ,EACjBxQ,GAAW,GAAMyQ,EACjBzQ,GAAW,GAAM0Q,EACjB1Q,GAAW,GAAMsS,GACjBtS,GAAW,GAAM3uD,OAEjB2uD,GAAW,GAAMoS,GACjBpS,GAAW,GAAMqS,GACjBrS,GAAW,GAAMuQ,EACjBvQ,GAAW,GAAMwQ,EACjBxQ,GAAW,GAAMyQ,EACjBzQ,GAAW,GAAM0Q,EACjB1Q,GAAW,GAAMpyD,EACjBoyD,GAAW,GAAM3uD,EAIlB,IAAMoD,GAAajJ,KAAKunE,aAActE,GAChCuE,GAAOv+D,GAAWzB,GAClBigE,GAAOx+D,GAAWxB,GAClBigE,GAAOz+D,GAAWH,GAClB6+D,GAAO1+D,GAAWvB,GAClBkgE,GAAO3+D,GAAWtB,GAClBkgE,GAAO5+D,GAAWD,GAElB8+D,GAAWL,GAAOD,GAClBO,GAAWH,GAAOD,GAClBK,GAAWN,GAAOF,GAClBS,GAAWJ,GAAOF,GAGlBvI,GAASp/D,KAAKokE,gBACdlF,GAAUl/D,KAAKu/D,aAAev/D,KAAKw/D,YAAcJ,GACjDx2D,GAAWq2D,EAAOr2D,SAClBd,GAAMm3D,EAAOn3D,IACnBm3D,EAAOnyC,aAAansB,SACpBs+D,EAAOlyC,SAASpsB,SAEhB,IAAMunE,GAAMzB,EAAaxB,EACnBkD,GAAM1B,EAAavB,EAEnBkD,GAAMnmD,GAAQ8iD,EACdsD,GAAMpmD,GAAQ+iD,EAEdpxC,GAAoC,IAAzB4yC,EAAazD,GACxBuF,GAAM10C,GAAUqxC,EAChBsD,GAAM30C,GAAUsxC,EAEhBsD,GAAiBlF,IAAczL,GAAgB6D,OAAS,EAAgB,IAAZ/uC,EAAKxgB,KACnEs8D,GAAM7B,GAAM0B,GAAME,GAAeJ,GACjCM,GAAM7B,GAAM0B,GAAMC,GAAeH,GACjCM,GAAM/B,GAAM0B,GAAMvF,EAAWkC,EAC7B2D,GAAM/B,GAAM0B,GAAMxF,EAAWmC,EAC7B2D,GAAMJ,GACNK,GAAMJ,GACNK,GAAMJ,GACNK,GAAMJ,GAEV11C,EAAY,EAGZ,IAFA,IAAI+1C,GAAY,EACVC,GAAkBrwC,EAAUlmB,OAClBrL,IAAPsM,GAAI,EAAkB,EAAVsrD,IAAatrD,GAAIs1D,GAAiBt1D,IAAK,EAAGtM,IAAM,EAAI,CACxE,IAAMumB,GAEC/mB,GADP,GAAkB,QADZ+mB,GAAYgL,EAAWjlB,KAI5B,GADAq1D,IAAa,EACD,OAFNniE,GAAO4/D,GAAqB74C,KAEf,CAClB,IAAMH,GAAU1tB,KAAK2mE,UAAW/yD,GAAGs1D,GAAiBrwC,EAAW/xB,GAAK4mB,QAASo2C,GAE7E,GAAIgD,IADJ5zC,GAAaxF,GAAUzL,IACY,CAClC,IAAMoM,GAAOq4C,GAAqB,OAClC,GAAY,MAARr4C,GAAe,CAClBruB,KAAKytB,eACJ7kB,GAAUd,GAAKR,GAAI+mB,GAAMq3C,EACzB0C,GAAKC,GACLQ,GAAKC,GAAKC,GAAKC,GACflB,GAAQC,GAAQC,GAAQC,GACxBT,GAAMG,IAGP,IAAMwB,GAAcnpE,KAAK2mE,UAAW/yD,GAAGs1D,GAAiBrwC,EAAWxK,GAAKX,QAASo2C,GASjF,IANA5wC,IAAci2C,GAAcz7C,IAAWzL,GACvC4mD,IAHM5T,GAAKkU,GAAcf,GAIzBU,IAHM5T,GAAKiU,GAAcd,GAIzBU,IAAY9T,GACZ+T,IAAY9T,GAEPthD,IAAK,EAAGtM,IAAM,EAAGsM,GAAIs1D,GAAiBt1D,IAAK,EAAGtM,IAAM,EAAI,CAC5D,GAAuB,OAAnBuxB,EAAWjlB,IAOR,CACNA,IAAK,EACLtM,IAAM,EACN,MATAtH,KAAK2tB,oBACJ/kB,GAAUd,GAAKR,GACfuhE,GAAKC,GAAKC,GAAKC,GACfxB,GAAMG,GAAMD,GAAMG,IAEnBoB,IAAa,QAQfjpE,KAAK2tB,oBACJ/kB,GAAUd,GAAKR,GACfuhE,GAAKC,GAAKC,GAAKC,GACfxB,GAAMG,GAAMD,GAAMG,QAGd,CASN,IAAM5S,GACAC,GATNl1D,KAAKytB,eACJ7kB,GAAUd,GAAKR,GAAIR,GAAM4+D,EACzB0C,GAAKC,GACLQ,GAAKC,GAAKC,GAAKC,GACflB,GAAQC,GAAQC,GAAQC,GACxBT,GAAMG,IAKPkB,IAFM5T,GAAKvnC,GAAU06C,GAGrBU,IAFM5T,GAAKxnC,GAAU26C,GAGrBU,IAAY9T,GACZ+T,IAAY9T,SAGbl1D,KAAK2tB,oBACJ/kB,GAAUd,GAAKR,GACfuhE,GAAKC,GAAKC,GAAKC,GACfxB,GAAMG,GAAMD,GAAMG,SAIpB7nE,KAAK2tB,oBACJ/kB,GAAUd,GAAKR,GACfuhE,GAAKC,GAAKC,GAAKC,GACfxB,GAAMG,GAAMD,GAAMG,IAOnBgB,GAJAJ,IAAOP,GAKPY,GAJAJ,IAAOP,GAKPY,GAJAJ,IAAOT,GAKPc,GAJAJ,IAAOT,GAMPnoE,KAAKopE,oBACJxgE,GACAm8D,EAAKC,EACLiE,GACA3hE,GACAlF,EAAQ8wB,EACR8wC,EACAT,EACAC,GAEDtwC,EAAY,EACZ+1C,GAAY,EAed,IAXAjpE,KAAKopE,oBACJxgE,GACAm8D,EAAKC,EACLiE,GACU,EAAV/J,GAAgC,EAAlBgK,GACd9mE,EAAQ8wB,EACR8wC,EACAT,EACAC,GAGQ5vD,GAAc,EAAVsrD,GAAiC,EAAnBrmC,EAAUlmB,OAAYoB,GAA4B,GAApBmrD,GAAUE,IAAaxrD,GAAIG,GAAMH,IAAK,EAC9FhL,GAAUgL,GAAI,GAAMgzD,GACpBh+D,GAAUgL,GAAI,GAAMizD,GACpB/+D,GAAK8L,GAAI,GAAM4zD,GACf1/D,GAAK8L,GAAI,GAAM+zD,KAKRrD,sBAAV,SAAqB9uD,EAAerJ,EAAcwgB,EAAce,EAAiBiuC,GAChF,OACCnmD,EAAQ,EAAIrJ,GAA8B,OAAtBwgB,EAAMnX,EAAQ,GAClCvJ,KAAKC,IAAK,EAAGwhB,EAAUiuC,GAAYjuC,GAI3B42C,gCAAV,SACC17D,EAAwBd,EAAmBR,EAC3CuhE,EAAaC,EACbC,EAAaC,EACbxB,EAAcG,EACdD,EAAcG,GAEdj/D,EAAUtB,EAAK,GAAMuhE,EACrBjgE,EAAUtB,EAAK,GAAMwhE,EACrBlgE,EAAUtB,EAAK,GAAMuhE,EACrBjgE,EAAUtB,EAAK,GAAMwhE,EACrBlgE,EAAUtB,EAAK,GAAMyhE,EACrBngE,EAAUtB,EAAK,GAAM0hE,EACrBpgE,EAAUtB,EAAK,GAAMyhE,EACrBngE,EAAUtB,EAAK,GAAM0hE,EAErBlhE,EAAKR,EAAK,GAAMkgE,EAChB1/D,EAAKR,EAAK,GAAMqgE,EAChB7/D,EAAKR,EAAK,GAAMkgE,EAChB1/D,EAAKR,EAAK,GAAMqgE,EAChB7/D,EAAKR,EAAK,GAAMogE,EAChB5/D,EAAKR,EAAK,GAAMugE,EAChB//D,EAAKR,EAAK,GAAMogE,EAChB5/D,EAAKR,EAAK,GAAMugE,GAGPvD,2BAAV,SACC17D,EAAwBd,EAAmBR,EAC3CR,EAAgC8lB,EAChCw7C,EAAaC,EACbQ,EAAaC,EACbC,EAAaC,EACblB,EAAgBC,EAChBC,EAAgBC,EAChBT,EAAcG,GAGd,IAAM0B,EAAcviE,EAAKxB,EAAIwB,EAAKinB,OAAOzoB,EACnCgkE,EAAYxiE,EAAK1E,MACjBmnE,EAAMF,EAAcjB,EACpBoB,EAAMH,EAAchB,EACpBoB,GAAOJ,EAAcC,GAAalB,EAClCsB,GAAOL,EAAcC,GAAajB,EACxCz/D,EAAUtB,EAAK,GAAMuhE,EAAMU,EAC3B3gE,EAAUtB,EAAK,GAAMwhE,EAAMU,EAC3B5gE,EAAUtB,EAAK,GAAMuhE,EAAMY,EAC3B7gE,EAAUtB,EAAK,GAAMwhE,EAAMY,EAC3B9gE,EAAUtB,EAAK,GAAMyhE,EAAMU,EAC3B7gE,EAAUtB,EAAK,GAAM0hE,EAAMU,EAC3B9gE,EAAUtB,EAAK,GAAMyhE,EAAMQ,EAC3B3gE,EAAUtB,EAAK,GAAM0hE,EAAMQ,EAG3B,IAAMxH,EAAMl7D,EAAKxB,EAAIsnB,EAAMxqB,MACrB6/D,EAAMn7D,EAAKvB,EAAIqnB,EAAM/mB,OACrBq8D,GAAOp7D,EAAKxB,EAAIwB,EAAK1E,OAASwqB,EAAMxqB,MACpC+/D,GAAOr7D,EAAKvB,EAAIuB,EAAKjB,QAAU+mB,EAAM/mB,OAErC8jE,EAAO7B,EAAS9F,EAChB4H,EAAO7B,EAAS/F,EAChB6H,EAAO/B,EAAS5F,EAChB4H,EAAO/B,EAAS7F,EAEhB6H,EAAO/B,EAAS/F,EAChB+H,EAAO/B,EAAShG,EAChBgI,EAAOjC,EAAS7F,EAChB+H,EAAOjC,EAAS9F,EACtBr6D,EAAKR,EAAK,GAAMkgE,EAAOmC,EAAOI,EAC9BjiE,EAAKR,EAAK,GAAMqgE,EAAOiC,EAAOI,EAC9BliE,EAAKR,EAAK,GAAMkgE,EAAOqC,EAAOE,EAC9BjiE,EAAKR,EAAK,GAAMqgE,EAAOmC,EAAOE,EAC9BliE,EAAKR,EAAK,GAAMkgE,EAAOqC,EAAOI,EAC9BniE,EAAKR,EAAK,GAAMqgE,EAAOmC,EAAOI,EAC9BpiE,EAAKR,EAAK,GAAMkgE,EAAOmC,EAAOM,EAC9BniE,EAAKR,EAAK,GAAMqgE,EAAOiC,EAAOM,GAGrB5F,qBAAV,SAAoB17D,EAAwBuhE,EAAqBC,EAAmBhrD,EAAYE,GAC/F,IAAK,IAAI1L,EAAI,EAAGtM,EAAK6iE,EAAc,EAAIC,EAAWx2D,EAAIw2D,EAAWx2D,GAAK,EAAGtM,GAAM,EAC9EsB,EAAUtB,EAAK,IAAO8X,EACtBxW,EAAUtB,EAAK,IAAOgY,EACtB1W,EAAUtB,EAAK,IAAO8X,EACtBxW,EAAUtB,EAAK,IAAOgY,EACtB1W,EAAUtB,EAAK,IAAO8X,EACtBxW,EAAUtB,EAAK,IAAOgY,EACtB1W,EAAUtB,EAAK,IAAO8X,EACtBxW,EAAUtB,EAAK,IAAOgY,GAIdglD,yBAAV,SACC17D,EAAwBuhE,EAAqBC,EAC7CzmE,EAAgB0mE,EAAYC,GAE5B3mE,GAAU,GACV3D,KAAKuqE,SAAU3hE,EAAUuhE,EAAaC,EAAWzmE,EAAS0mE,EAAI1mE,EAAS2mE,IAG9DhG,yBAAV,SACC17D,EAAwBuhE,EAAqBC,EAC7CzmE,EAAgB0mE,EAAYC,GAE5BtqE,KAAKuqE,SAAU3hE,EAAUuhE,EAAaC,EAAWzmE,EAAS0mE,EAAI1mE,EAAS2mE,IAG9DhG,gCAAV,SACC17D,EACAyhE,EAAYC,EACZrB,EAAmBkB,EACnBxmE,EACAqgE,EACAT,EACAC,GAEA,GA57BmB,KA47BR7/D,EACV,OAAQqgE,GACR,KAAKhM,GAAoB4D,cACxB,OAAQ2H,GACR,KAAKzL,GAA0BwN,cAC/B,KAAKxN,GAA0BvsD,KAE9B,MACD,KAAKusD,GAA0B/7C,OAC9B/b,KAAKwqE,aAAc5hE,EAAUuhE,EAAalB,EAAWtlE,EAAQ0mE,EAAIC,GACjE,MACD,KAAKxS,GAA0BuN,aAC/B,KAAKvN,GAA0BrsD,MAC9BzL,KAAKyqE,aAAc7hE,EAAUuhE,EAAalB,EAAWtlE,EAAQ0mE,EAAIC,GAGlE,MACD,KAAKtS,GAAoBgP,cACxB,OAAQxD,GACR,KAAKzL,GAAwBqN,eAC7B,KAAKrN,GAAwB5sD,IAE5B,MACD,KAAK4sD,GAAwB1+B,OAC5Br5B,KAAKwqE,aAAc5hE,EAAUuhE,EAAalB,EAAWtlE,EAAQ0mE,EAAIC,GACjE,MACD,KAAKvS,GAAwBoN,YAC7B,KAAKpN,GAAwB1sD,OAC5BrL,KAAKyqE,aAAc7hE,EAAUuhE,EAAalB,EAAWtlE,EAAQ0mE,EAAIC,GAGlE,MACD,KAAKtS,GAAoBmP,cACxB,OAAQ3D,GACR,KAAKzL,GAAwBqN,eAC7B,KAAKrN,GAAwB5sD,IAC5BnL,KAAKyqE,aAAc7hE,EAAUuhE,EAAalB,EAAWtlE,EAAQ0mE,EAAIC,GACjE,MACD,KAAKvS,GAAwB1+B,OAC5Br5B,KAAKwqE,aAAc5hE,EAAUuhE,EAAalB,EAAWtlE,EAAQ0mE,EAAIC,GACjE,MACD,KAAKvS,GAAwBoN,YAC7B,KAAKpN,GAAwB1sD,WAStBi5D,gCAAV,SAA+BrF,EAAsB9Q,GACpD,IAAMxhC,EAAOwhC,EAAMxhC,KACbtrB,EAAQsrB,EAAKtrB,MACbE,EAAU4sD,EAAM3+C,SAAWmd,EAAKuqC,OAASvqC,EAAKprB,MAAQ,EACxDF,IAAUrB,KAAKmjE,WAAa5hE,IAAUvB,KAAKojE,YAC9CpjE,KAAKmjE,UAAY9hE,EACjBrB,KAAKojE,UAAY7hE,EACjB09D,EAAO+B,gBAAgBrgE,SAEvBX,KAAKihE,UACJ5/D,EAAOE,EACPvB,KAAKu/D,aAAev/D,KAAKw/D,YAAcx/D,KAAKokE,gBAC5CpkE,KAAKokE,gBACLnF,EAAOiC,cAKAoD,kCAAV,SAAiCrF,EAAsB9Q,GACtD,IAAMxhC,EAAOwhC,EAAMxhC,KACblpB,EAAUkpB,EAAKlpB,QACfpC,EAAQoC,EAAQpC,MAChBE,EAAU4sD,EAAM3+C,SAAWmd,EAAKuqC,OAASzzD,EAAQlC,MAAQ,EAC3DF,IAAUrB,KAAK4jE,kBAAoBriE,IAAUvB,KAAK6jE,mBACrD7jE,KAAK4jE,iBAAmBviE,EACxBrB,KAAK6jE,iBAAmBtiE,EACxB09D,EAAOkC,kBAAkBxgE,SAEzBX,KAAKihE,UACJ5/D,EAAOE,EACPvB,KAAKu/D,aAAev/D,KAAKw/D,YAAcx/D,KAAKokE,gBAC5CpkE,KAAKokE,gBACLnF,EAAOmC,gBAKAkD,2BAAV,SAA0BrF,EAAsB9Q,GAC/C,IAAMxhC,EAAOwhC,EAAMxhC,KACb+9C,EAAc/9C,EAAKlpB,QACnBkgE,EAAoB+G,EAAYxT,OAASwT,EAAYtoE,MAAQ,EAC7DihE,EAAa12C,EAAK9H,OACxB,GAAIw+C,IAAerjE,KAAKqjE,YAAcM,IAAqB3jE,KAAK2jE,iBAAmB,CAClF3jE,KAAKqjE,WAAaA,EAClBrjE,KAAK2jE,iBAAmBA,EAExB1E,EAAO0L,WAAWhqE,SAClBs+D,EAAO2L,gBAAgBjqE,SACvB,IAAMyhE,EAAQnD,EAAOmD,MACfC,EAAcpD,EAAOoD,YACrBjD,EAASp/D,KAAKokE,gBACdlF,EAAUl/D,KAAKu/D,aAAev/D,KAAKw/D,YAAcJ,EAEjDsG,EAAY/4C,EAAKC,MACvB,GAAiB,MAAb84C,EAAoB,CAIvB,IAHA,IAAMzjD,EAAQ,KAAQ0K,EAAKxgB,KAAOu5D,EAAU93C,KAAKzhB,MAC3CoC,EAAkC,GAAnBo1D,EACf9+C,GAAqBw+C,IAAezL,GAAiB8D,OAAS,EAAM,KAAzD,KACS3nD,GAAjBH,EAAc,EAAVsrD,GAAiC,EAATE,EAAYxrD,EAAIG,EAAMH,GAAK,EAC/DwuD,EAAOxuD,EAAI,GAAMqO,EACjBmgD,EAAOxuD,EAAI,GAAMrF,EAElB,IAA0BwF,GAAjBH,EAAc,EAAVsrD,GAAiC,EAATE,EAAYxrD,EAAIG,EAAMH,GAAK,EAC/DyuD,EAAazuD,EAAK,GAAMiR,EACxBw9C,EAAazuD,EAAK,GA/iCF,KAgjChByuD,EAAazuD,EAAK,GAhjCF,KAijChByuD,EAAazuD,EAAK,GAjjCF,SAmjCX,CACN,IAA0BG,GAAjBH,EAAc,EAAVsrD,GAAiC,EAATE,EAAYxrD,EAAIG,EAAMH,GAAK,EAC/DwuD,EAAOxuD,EAAI,GAAM,EACjBwuD,EAAOxuD,EAAI,GAAM,EAEb,IAAIA,EAAT,IAA0BG,GAAjBH,EAAc,EAAVsrD,GAAiC,EAATE,EAAYxrD,EAAIG,EAAMH,GAAK,EAC/DyuD,EAAazuD,EAAK,GAzjCF,KA0jChByuD,EAAazuD,EAAK,GA1jCF,KA2jChByuD,EAAazuD,EAAK,GA3jCF,KA4jChByuD,EAAazuD,EAAK,GA5jCF,QAkkCV0wD,uBAAV,SAAsBrF,EAAsB9Q,GAE3C,GAAI,EADWnuD,KAAKokE,gBACH,CAChB,IAAMsB,EAAYvX,EAAMxhC,KAAKC,MACZ,MAAb84C,IACH1lE,KAAK6qE,iBAAkB5L,EAAQ9Q,EAAOuX,GACtC1lE,KAAK8qE,oBAAqB7L,EAAQ9Q,GAClCnuD,KAAK+qE,sBAAuB9L,EAAQ9Q,GACpCnuD,KAAKgrE,eAAgB/L,EAAQ9Q,MAKhCmW,qBAAA,WACC,IAAMlF,EAASp/D,KAAKokE,gBACpB,GAAI,EAAIhF,EAAS,CAChB,IAAMC,EAASr/D,KAAKqkE,eACdnF,EAAUl/D,KAAKu/D,aAAev/D,KAAKw/D,YAAcJ,EACjDD,EAAUn/D,KAAKy/D,YAAcz/D,KAAK0/D,WAAaL,EAC/CJ,EAASj/D,KAAKi/D,OAGpBA,EAAOgM,eAAetqE,SAEtB,IADA,IAAM2hE,EAAYrD,EAAOqD,UACCvuD,GAAjBH,EAAc,EAAVsrD,GAAiC,EAATE,EAAYxrD,EAAIG,EAAMH,GAAK,EAC/D0uD,EAAW1uD,EAAI,GAAM,EACrB0uD,EAAW1uD,EAAI,GAAM,EACrB0uD,EAAW1uD,EAAI,GAAM,EAItBqrD,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QACd+L,EAAI,EAAGhM,EAAe,EAAVu3D,EAArB,IAAkCprD,EAAQsrD,GAAU,EAAIzrD,EAAIG,EAAMH,GAAK,EAAGhM,GAAM,EAAI,CACnF,IAAM4S,EAAI0kD,GAAYtrD,GAAK,GAC3B/L,EAASD,EAAK,GAAM4S,EAAI,EACxB3S,EAASD,EAAK,GAAM4S,EAAI,EACxB3S,EAASD,EAAK,GAAM4S,EAAI,EAExB3S,EAASD,EAAK,GAAM4S,EAAI,EACxB3S,EAASD,EAAK,GAAM4S,EAAI,EACxB3S,EAASD,EAAK,GAAM4S,EAAI,KAK3B8pD,sBAAA,SAAW3B,GAGV,GAFA38D,YAAMklE,oBAAWvI,GAEb,EAAI3iE,KAAKokE,gBAAkB,CAC9B,IAAMnB,EAAcjjE,KAAKijE,aAAer2D,UAAQ6zD,MAC1C0K,EAAkBlI,EAAYnvC,YACpC,GAAIq3C,IAAoBxI,EAAQ7uC,YAAc,CAC7C6uC,EAAQ7uC,YAAcq3C,EACtB,IAAM1L,EAAcz/D,KAAKy/D,YAAcz/D,KAAK0/D,WAAa1/D,KAAKqkE,eAC9D1B,EAAQ/vD,KAAMqwD,EAAaxD,SAvnCkBc,mBCEhD,WACCtB,EACAC,EAAiBC,EACjB0D,EAAiBC,EACjB1D,EAAgBC,GAJjB,MAMCr5D,YAAOi5D,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,gBAC3Dl5D,EAAKilE,SAAW1kE,IAChBP,EAAKklE,YAAclhB,GAAkBlmC,OA+OvC,OA3PuCnkB,OAetCwrE,iBAAA,SAAMnd,GACLnoD,YAAMggB,eAAMmoC,GACZ,IAAM8Q,EAASj/D,KAAKi/D,OACdC,EAAUl/D,KAAKu/D,aACfJ,EAAUn/D,KAAKy/D,YAGrBR,EAAOgM,eAAetqE,SACtB,IAAM2hE,EAAYrD,EAAOqD,UACzBrD,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QAGjB0jE,EAAe,EAAVrM,EACXoD,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAGvB,IAAM3jE,EAAe,EAAVu3D,EAcX,OAbAt3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAE9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAG9Bl/D,KAAKwrE,WAGLxrE,KAAKW,OAAQwtD,GACNnuD,MAGRsrE,mBAAA,SAAQnd,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACpB,GAAI9Q,aAAiB6Q,GAAY,CAChC,IAAM7yD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACbkmE,EAAkB1f,IAAU/rD,KAAK+rD,OAASC,IAAUhsD,KAAKgsD,MACzDuC,EAASJ,EAAMI,OACfzuB,EAAgByuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC/CspE,EAAyB5rC,IAAgB9/B,KAAK8/B,YAC9Cw/B,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5Cyd,EAAuB5rE,KAAKs/D,mBAAqBA,EACjD8L,EAAWjd,EAAMuD,OAAO7gC,GACxBg7C,EAAsBT,IAAaprE,KAAKorE,SACxCC,EAAcld,EAAMuD,OAAOl8B,MAC3Bs2C,EAAyBT,IAAgBrrE,KAAKqrE,YACpD,GAAII,GAAiBG,GAAsBF,GAAwBG,GAAqBC,EAAuB,CAC9G9rE,KAAK+rD,MAAQA,EACb/rD,KAAKgsD,MAAQA,EACbhsD,KAAK8/B,YAAcA,EACnB9/B,KAAKs/D,iBAAmBA,EACxBt/D,KAAKorE,SAAWA,EAChBprE,KAAKqrE,YAAcA,EACnBpM,EAAOnyC,aAAansB,SACpBs+D,EAAO0L,WAAWhqE,SAClBs+D,EAAO2L,gBAAgBjqE,SACvBs+D,EAAO+B,gBAAgBrgE,UAEnB8qE,GAAiBG,KAEpB5rE,KAAK8jE,sBAAwBp9D,KAE1BmlE,IAEH7rE,KAAKsgE,mBAAqB55D,KAG3B,IAAMw4D,EAAUl/D,KAAKu/D,aACfH,EAASp/D,KAAKw/D,YAAcx/D,KAAKokE,gBACvCpkE,KAAK+rE,iCACJ9M,EACA9Q,EAAMuD,OACN5xB,EACAquB,EAAMtsC,UAAU2uC,kBAChB0O,EAASE,IAKZp/D,KAAKgsE,YAAa/M,EAAQ9Q,GAC1BnuD,KAAKisE,YAAahN,EAAQ9Q,GAC1BnuD,KAAK05B,WAAYulC,EAAQ9Q,IAGhBmd,qCAAV,SAAoCrM,EAAsB9Q,EAAeqR,GACxEx/D,KAAKshE,kBAAmBrC,EAAQ9Q,EAAOqR,IAG9B8L,6CAAV,SACCrM,EACAvN,EACA5xB,EACA0wB,EACA0O,EACAE,GAEA,IAAM93D,EAAe,EAAV43D,EACLn1D,EAAe,EAAVm1D,EACLt2D,EAAWq2D,EAAOr2D,SAClBw5D,EAAQnD,EAAOmD,MACfC,EAAcpD,EAAOoD,YACrBnB,EAAajC,EAAOiC,WACpBlD,EAAatM,EAAO/+C,OACpBsrD,EAAcvM,EAAOnF,OACrB8e,EAAc3Z,EAAOl8B,MACrB02C,EAAaxa,EAAOvlD,KACpBggE,EAAiB7hB,GAA2B8hB,iBAAkBf,GAG9Dr/C,EAAOizC,EAAOjzC,KACpBA,EAAKxmB,IAAKy4D,EAAa,GAAKA,EAAa,IACzCzN,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMqyC,EAAMryC,EAAK1mB,EACXg5D,EAAMtyC,EAAKzmB,EAGXkoC,EAAauwB,EAAa,GAAM,EACtChyC,EAAKxmB,IAAKy4D,EAAaxwB,EAAY,GAAKwwB,EAAaxwB,EAAY,IACjE+iB,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAIqgD,EAAMrgD,EAAK1mB,EACXgnE,EAAMtgD,EAAKzmB,EAGX6Z,EAAKitD,EAAMhO,EACX/+C,EAAKgtD,EAAMhO,EACTh/D,EAAI2M,KAAK0nB,KAAMvU,EAAKA,EAAKE,EAAKA,GAChCpW,EAAI5J,EACR,GAAI,GAAK4sE,GAlKU,KAkKW5sE,EAAI,CACjC,IAAMkwC,EAAQ08B,EAAa5sE,EAG3B+sE,EAAMhO,GAFNj/C,GAAMowB,GAGN88B,EAAMhO,GAFNh/C,GAAMkwB,GAGNtmC,EAAIgjE,EAIL,IAAM/N,EAAME,EAAMj/C,EACZg/C,EAAME,EAAMh/C,EACZitD,EAAMF,EAAMjtD,EACZotD,EAAMF,EAAMhtD,EAGlB1W,EAAUtB,EAAK,GAAM+2D,EACrBz1D,EAAUtB,EAAK,GAAMg3D,EACrB11D,EAAUtB,EAAK,GAAM+2D,EACrBz1D,EAAUtB,EAAK,GAAMg3D,EACrB8D,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB/J,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB9J,EAAat4D,EAAK,GAAMo0D,EACxBkE,EAAat4D,EAAK,GAAMq0D,EACxBiE,EAAat4D,EAAK,GAAMsiE,EACxBhK,EAAat4D,EAAK,GAAMuiE,EACxBjK,EAAat4D,EAAK,GAAMo0D,EACxBkE,EAAat4D,EAAK,GAAMq0D,EACxBiE,EAAat4D,EAAK,GAAMsiE,EACxBhK,EAAat4D,EAAK,GAAMuiE,EACxBpL,EAAYn3D,EAAK,GAAM,EACvBm3D,EAAYn3D,EAAK,GAAM,EAEvBnB,EAAUtB,EAAK,GAAM+kE,EACrBzjE,EAAUtB,EAAK,GAAMglE,EACrB1jE,EAAUtB,EAAK,GAAM+kE,EACrBzjE,EAAUtB,EAAK,GAAMglE,EACrBlK,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB/J,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB9J,EAAat4D,EAAM,GAAMs0D,EACzBgE,EAAat4D,EAAM,GAAMu0D,EACzB+D,EAAat4D,EAAK,IAAOwiE,EACzBlK,EAAat4D,EAAK,IAAOyiE,EACzBnK,EAAat4D,EAAK,IAAOs0D,EACzBgE,EAAat4D,EAAK,IAAOu0D,EACzB+D,EAAat4D,EAAK,IAAOwiE,EACzBlK,EAAat4D,EAAK,IAAOyiE,EACzBtL,EAAYn3D,EAAM,GAAMb,EACxBg4D,EAAYn3D,EAAK,IAAOb,EAGxBohD,GAA2BmiB,OAAQvjE,EAAG42B,EAAaurC,EAAar/C,GAGhE,IAFA,IAAM0gD,EAAQ1gD,EAAK1mB,EACbqnE,EAAQ3gD,EAAKzmB,EACVqO,EAAc,EAAVsrD,EAAanrD,EAAOH,EAAa,EAATwrD,EAAYxrD,EAAIG,EAAMH,GAAK,EAC/DstD,EAAYttD,EAAI,GAAM84D,EACtBxL,EAAYttD,EAAI,GAAM+4D,EACtBzL,EAAYttD,EAAI,GAAM1K,GAIxBoiE,wBAAA,SAAarM,EAAsB9Q,GAClC,IAAMvoD,EAAU5F,KAAK46C,UAAWuT,GAC1BmS,EAAqBtgE,KAAK2lE,qBAAsB//D,GACtD,GAAIA,IAAY5F,KAAK4F,SAAW06D,IAAuBtgE,KAAKsgE,mBAAqB,CAChFtgE,KAAK4F,QAAUA,EACf5F,KAAKsgE,mBAAqBA,EAE1B,IAAMr3D,EAAajJ,KAAKunE,aAAc3hE,GAGtCq5D,EAAOlyC,SAASpsB,SAChB,IAAMmH,EAAMm3D,EAAOn3D,IAEb8kE,EAAgB,EADN5sE,KAAKu/D,aAGrBz3D,EAAK8kE,EAAM,GAAM3jE,EAAWzB,GAC5BM,EAAK8kE,EAAM,GAAM3jE,EAAWvB,GAC5BI,EAAK8kE,EAAM,GAAM3jE,EAAWH,GAC5BhB,EAAK8kE,EAAM,GAAM3jE,EAAWD,GAE5BlB,EAAK8kE,EAAM,GAAM3jE,EAAWxB,GAC5BK,EAAK8kE,EAAM,GAAM3jE,EAAWtB,GAC5BG,EAAK8kE,EAAM,GAAM3jE,EAAWJ,GAC5Bf,EAAK8kE,EAAM,GAAM3jE,EAAWF,QAxPQu7D,kBCNvC,cAgBA,OAfQuI,SAAP,SACC5N,EAAsB9Q,EAAe+Q,EAAiBC,GAEtD,IAAM2N,EAASlK,GAAoB2B,aAAcpW,EAAO8Q,EAAOuF,WACzD3B,EAAUiK,EAAOtN,YACjBsD,EAAUgK,EAAOpN,WACjBN,EAAS,EAAIyD,EACbxD,EAAS,EAAIyD,EACnB,OAAI5D,EAAUE,EAASH,EAAO8N,gBAAkB5N,EAAUE,EAASJ,EAAO+N,cAClE,IAAI1B,GACVrM,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,GACnDr5C,KAAMmoC,GAEF,yBCZT,cAgBA,OAfQ8e,aAAP,SAAmB9e,EAAekI,GACjC,OAASA,EAAQ3H,QAAUrB,GAAmB2C,WAAa7B,EAAQkI,GAAUpmC,MAGvEg9C,eAAP,SAAqB9e,EAAekI,GACnC,OAASA,EAAQ3H,QAAUrB,GAAmB4C,aAAe9B,EAAQkI,GAAU9H,QAGzE0e,aAAP,SAAmB9e,EAAekI,GACjC,OAASA,EAAQ3H,QAAUrB,GAAmB6C,WAAa/B,EAAQkI,GAAU1pC,MAGvEsgD,oBAAP,SAA0B9e,EAAekI,GACxC,OAASA,EAAQ3H,QAAUrB,GAAmB8C,mBAAqBhC,EAAQkI,GAAU1pC,KAAKlpB,4BCZ3F,WAAagrD,GACZzuD,KAAKyuD,MAAQA,GAASpB,GAAmBppC,KA4C3C,OAzCCipD,yBAAA,SACC12D,EAAoB22D,EAAgCC,GAEpD,GAAI52D,EAAWI,OAAOjE,QAAU,EAC/B,OAAOw6D,EAGR,IACC,OAAOE,SACN,QAAS,OACT,gCAAgC72D,gCAAwC42D,SAExE,MAAOn3D,GACR,OAAOk3D,IAITD,iBAAA,SAAMtqD,EAAcurC,EAAemf,EAAsBC,QACrC7rE,IAAf4rE,EACHnf,EAAMl7C,KAAM2P,EAAMurC,QACOzsD,IAAf6rE,EACVpf,EAAMl7C,KAAM2P,EAAMurC,EAAOmf,GAEzBnf,EAAMl7C,KAAM2P,EAAMurC,EAAOmf,EAAYC,GAGtC,IAAMC,EAAcntE,EAAcK,cAC9B,UAAW8sE,SACK9rE,IAAf4rE,EACHE,EAAYrf,MAAMl7C,KAAM2P,EAAMurC,QACLzsD,IAAf6rE,EACVC,EAAYrf,MAAMl7C,KAAM2P,EAAMurC,EAAOmf,GAErCE,EAAYrf,MAAMl7C,KAAM2P,EAAMurC,EAAOmf,EAAYC,KAKpDL,oBAAA,SAAS/e,EAAekI,EAAwB9iB,UC/C3Ck6B,GAAmB,WAAe,OAAA,kBAKvC,WAAa72C,EAA0B63B,GAAvC,MACCzoD,YAAOyoD,gBACPtoD,EAAKunE,UAAYvnE,EAAKwnE,aAAc/2C,EAAM82C,UAAWD,GAAkB,UAEzE,OAPoD3tE,UAAAotE,mBCEnD,WAAat2C,EAA+B63B,GAA5C,MACCzoD,YAAO4wB,EAAO63B,gBACdtoD,EAAKynE,SAAWh3C,EAAMg3C,WAyBxB,OA9B8C9tE,OAQ7C+tE,oBAAA,SAAS1f,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMq6B,EAAW5tE,KAAK4tE,SAChBE,EAAcF,GAAY,EAC1BG,EAAYx6B,EAAOu6B,EACrBC,EAAUH,GACb5tE,KAAKguE,MAAO7f,EAAOkI,GACnBA,EAAQ1H,OAASpb,GAASq6B,EAAWG,KAErC/tE,KAAKiuE,KAAM9f,EAAOkI,GAClBA,EAAQ1H,OAASpb,GAASu6B,EAAYC,MAK/BF,iBAAV,SAAgB1f,EAAekI,KAIrBwX,kBAAV,SAAiB1f,EAAekI,QA3Ba6X,mBCG7C,WAAat3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8gB,aAkCnC,OApCsDruE,OAK3CsuE,iBAAV,SAAgBjgB,EAAekI,GAC9B,IAAMpmC,EAAOg9C,GAAkBoB,WAAYlgB,EAAOkI,GAClDlI,EAAMl+B,KAAKzqB,SACV9D,EACAk8C,GAAQ0wB,SAAUr+C,EAAK5uB,MAAO,IAC9B4uB,EAAK1uB,OAGN,IAAMgtD,EAAS0e,GAAkBsB,aAAcpgB,EAAOkI,GACtDlI,EAAMI,OAAO/oD,SACZ9D,EACAk8C,GAAQ0wB,SAAU/f,EAAOltD,MAAO,IAChCktD,EAAOhtD,OAGR,IAAMorB,EAAOsgD,GAAkBuB,WAAYrgB,EAAOkI,GAClDlI,EAAMxhC,KAAKnnB,SACV9D,EACAk8C,GAAQ0wB,SAAU3hD,EAAKtrB,MAAO,IAC9BsrB,EAAKprB,OAGN,IAAMkC,EAAUwpE,GAAkBwB,kBAAmBtgB,EAAOkI,GAC5DlI,EAAMxhC,KAAKlpB,QAAQ+B,SAClB9D,EACAk8C,GAAQ0wB,SAAU7qE,EAAQpC,MAAO,IACjCoC,EAAQlC,OAGT80D,EAAQ3H,SAAW1uD,KAAKyuD,UAlC4Bof,mBCErD,WAAaj3C,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmB2C,yBACjC7pD,EAAK9E,MAAQu1B,EAAMv1B,MACnB8E,EAAK5E,MAAQq1B,EAAMr1B,QAOrB,OAduDzB,OAU5C4uE,iBAAV,SAAgBvgB,EAAekI,GAC9BlI,EAAMl+B,KAAKzqB,SAAK9D,EAAW1B,KAAKqB,MAAOrB,KAAKuB,OAC5C80D,EAAQ3H,SAAW1uD,KAAKyuD,UAZ6Bof,mBCItD,WAAaj3C,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmB4C,2BACjC9pD,EAAK9E,MAAQu1B,EAAMv1B,MACnB8E,EAAK5E,MAAQq1B,EAAMr1B,QAOrB,OAdyDzB,OAU9C6uE,iBAAV,SAAgBxgB,EAAekI,GAC9BlI,EAAMI,OAAO/oD,SAAK9D,EAAW1B,KAAKqB,MAAOrB,KAAKuB,OAC9C80D,EAAQ3H,SAAW1uD,KAAKyuD,UAZ+Bof,mBCGxD,WAAaj3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8gB,aAkCnC,OApCoDruE,OAKzC8uE,iBAAV,SAAgBzgB,EAAekI,GAC9B,IAAMpmC,EAAOg9C,GAAkBoB,WAAYlgB,EAAOkI,GAClDlI,EAAMl+B,KAAKzqB,SACV9D,EACAk8C,GAAQixB,OAAQ5+C,EAAK5uB,MAAO,IAC5B4uB,EAAK1uB,OAGN,IAAMgtD,EAAS0e,GAAkBsB,aAAcpgB,EAAOkI,GACtDlI,EAAMI,OAAO/oD,SACZ9D,EACAk8C,GAAQixB,OAAQtgB,EAAOltD,MAAO,IAC9BktD,EAAOhtD,OAGR,IAAMorB,EAAOsgD,GAAkBuB,WAAYrgB,EAAOkI,GAClDlI,EAAMxhC,KAAKnnB,SACV9D,EACAk8C,GAAQixB,OAAQliD,EAAKtrB,MAAO,IAC5BsrB,EAAKprB,OAGN,IAAMkC,EAAUwpE,GAAkBwB,kBAAmBtgB,EAAOkI,GAC5DlI,EAAMxhC,KAAKlpB,QAAQ+B,SAClB9D,EACAk8C,GAAQixB,OAAQprE,EAAQpC,MAAO,IAC/BoC,EAAQlC,OAGT80D,EAAQ3H,SAAW1uD,KAAKyuD,UAlC0Bof,mBCAnD,WAAaj3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmByhB,6BAoBnC,OAtBqDhvE,OAK1CivE,iBAAV,SAAgB5gB,EAAekI,GAC9B,IAAMpmC,EAAOg9C,GAAkBoB,WAAYlgB,EAAOkI,GAClDlI,EAAMl+B,KAAKzqB,SACV9D,EACAuuB,EAAK5uB,MACQ,GAAb4uB,EAAK1uB,OAGN,IAAMgtD,EAAS0e,GAAkBsB,aAAcpgB,EAAOkI,GACtDlI,EAAMI,OAAO/oD,SACZ9D,EACA6sD,EAAOltD,MACQ,GAAfktD,EAAOhtD,OAGR80D,EAAQ3H,SAAW1uD,KAAKyuD,UApB2Bof,mBCApD,WAAaj3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB0C,kBAYnC,OAdwDjwD,OAK7CkvE,iBAAV,SAAgB7gB,EAAekI,GAC9BlI,EAAM3+C,SAAU,EAChB6mD,EAAQ3H,SAAW1uD,KAAKyuD,OAGfugB,kBAAV,SAAiB7gB,EAAekI,GAC/BlI,EAAM3+C,SAAU,EAChB6mD,EAAQ3H,SAAW1uD,KAAKyuD,UAZ8Bof,KrBLxD,SAAY7S,GACXA,+BACAA,2BACAA,uBACAA,yBACAA,+BACAA,mCAND,CAAYA,KAAAA,QsBEZ,ICFYiU,iBDMX,WAAat0D,EAA6B+yD,GACzC1tE,KAAK2a,KAAOA,EACZ3a,KAAK0tE,UAAYA,EAgBnB,OAbCwB,qBAAA,SAAUt4C,GACT,OACC52B,KAAK2a,OAASic,EAAMjc,MACpB3a,KAAK0tE,YAAc92C,EAAM82C,WAI3BwB,oBAAA,WACC,OAAO3xD,EAAQ7c,cAAcsM,IAA6B,qBAAsBmiE,QAASnvE,2BEjB1F,WAAa2a,EAA6B+yD,EAAmB0B,GAA7D,MACCppE,YAAO2U,EAAM+yD,gBACbvnE,EAAKipE,QAAUA,IAUjB,OAfgFtvE,OAQ/EuvE,qBAAA,SAAUz4C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBy4C,GAClBrvE,KAAKovE,UAAYx4C,EAAMw4C,YAZsDF,KDChF,SAAYD,GACXA,6BACAA,qBACAA,6BACAA,mBACAA,+BACAA,mCACAA,iCACAA,qCACAA,mBATD,CAAYA,KAAAA,QEEZ,ICFYK,GASAC,iBDPZ,cAUA,OATQC,aAAP,SAAmBh6D,EAAe03C,EAAkB3e,GACnD,GAAI,GAAK/4B,GAASA,EAAQ03C,EAAOv6C,OAAS,CACzC,IAAMke,EAAKq8B,EAAQ13C,GACnB,GAAIxS,EAAc6tB,IAAQ,GAAKA,GAAMA,EAAK0d,EAAU57B,OACnD,OAAO47B,EAAW1d,GAGpB,MAAO,wBEgBR,WAAau+C,EAAqC1B,EAAmBE,EAAkBvsE,EAAeE,GAAtG,MACCyE,YAAOipE,GAAsBQ,MAAO/B,EAAW0B,gBAC/CjpE,EAAKynE,SAAWA,EAChBznE,EAAK9E,MAAQA,EACb8E,EAAK5E,MAAQA,IA+Cf,OAxD4CzB,OAY3C4vE,qBAAA,SAAU94C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiB84C,GAClB1vE,KAAK4tE,WAAah3C,EAAMg3C,UACxB5tE,KAAKqB,QAAUu1B,EAAMv1B,OACrBrB,KAAKuB,QAAUq1B,EAAMr1B,OAIvBmuE,sBAAA,WACC,OAAQ1vE,KAAKovE,SACb,KAAKpU,GAA2B2U,SAC/B,OAAO,IAAIvB,GAAkCpuE,MAC9C,KAAKg7D,GAA2BhL,WAC/B,OAAO,IAAI0e,GAAmC1uE,MAC/C,KAAKg7D,GAA2B/K,aAC/B,OAAO,IAAI0e,GAAqC3uE,MACjD,KAAKg7D,GAA2B4U,OAC/B,OAAO,IAAIhB,GAAgC5uE,MAC5C,KAAKg7D,GAA2B6U,QAC/B,OAAO,IAAId,GAAiC/uE,MAC7C,KAAKg7D,GAA2BjL,WAC/B,OAAO,IAAIif,GAAoChvE,QAIjD0vE,sBAAA,SAAW3iB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WACrC,OAAO3gB,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWpvE,KAAK4tE,aAAY5tE,KAAKqB,UAASrB,KAAKuB,YAI/EmuE,cAAP,SACC9d,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACxE,OAAO,IAAImhC,EACV9d,EAAY,GAAK8b,EAAW9b,EAAY,GACxCA,EAAY,GAAKA,EAAY,QArDYyd,KDrB5C,SAAYC,GACXA,mBACAA,uBACAA,yCACAA,mBACAA,mCACAA,iBAND,CAAYA,KAAAA,QASZ,SAAYC,GACXA,yCACAA,qBACAA,qBACAA,mBACAA,+BALD,CAAYA,KAAAA,QEIZ,ICbYS,GDaNC,GAAe,WAAqB,OAAA,qBAOzC,WAAar5C,EAAqC63B,GAAlD,MACCzoD,YAAO4wB,EAAO63B,SAEd,OAAQ73B,EAAM/1B,QACd,KAAK0uE,GAAmCpB,MACvChoE,EAAK9E,MAAQu1B,EAAMv1B,MACnB8E,EAAK5E,WAAQG,EACb,MACD,KAAK6tE,GAAmCW,MACvC/pE,EAAK9E,WAAQK,EACbyE,EAAK5E,MAAQq1B,EAAMr1B,MACnB,MACD,QACC4E,EAAK9E,MAAQu1B,EAAMv1B,MACnB8E,EAAK5E,MAAQq1B,EAAMr1B,aAIpB4E,EAAKq4C,MAAQr4C,EAAKwnE,aAAc/2C,EAAM4nB,MAAOyxB,GAAc,UAuN7D,OA9OoDnwE,OA0BzCqwE,gBAAV,SACChiB,EAAekI,EAAwB9iB,EACvC1yC,EACA4M,GAEA,IAAMpM,EAAQrB,KAAKqB,MACbE,EAAQvB,KAAKuB,MACnB,GAAa,MAATF,EACU,MAATE,EAEU,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,IAEhC1yC,EAAO2E,SACN9D,EACAk8C,GAAQY,MAAO/wC,EAAKpM,MAAOA,EAAOm9C,GAClCrQ,GAAUqQ,MAAO/wC,EAAKlM,MAAOA,EAAOi9C,IAGrC39C,EAAO2E,SAAK9D,EAAWL,EAAOE,GAIlB,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,IAEhC1yC,EAAO2E,SACN9D,EACAk8C,GAAQY,MAAO/wC,EAAKpM,MAAOA,EAAOm9C,GAClC/wC,EAAKlM,OAGNV,EAAO2E,SAAK9D,EAAWL,EAAOoM,EAAKlM,OAGrC80D,EAAQ3H,SAAW1uD,KAAKyuD,WAClB,GAAa,MAATltD,EAAgB,CAC1B,IAAMi9C,EACO,OADPA,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,IAEhC1yC,EAAO2E,SACN9D,EACA+L,EAAKpM,MACL8sC,GAAUqQ,MAAO/wC,EAAKlM,MAAOA,EAAOi9C,IAGrC39C,EAAO2E,SAAK9D,EAAW+L,EAAKpM,MAAOE,GAEpC80D,EAAQ3H,SAAW1uD,KAAKyuD,QAIhB0hB,iBAAV,SACChiB,EAAekI,EAAwB9iB,EACvCtjB,EAAkBs+B,EAClB6hB,EAA0BC,GAE1B,IAAMhvE,EAAQrB,KAAKqB,MACbE,EAAQvB,KAAKuB,MACnB,GAAa,MAATF,EACU,MAATE,EAEU,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtCrQ,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxCrQ,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,MAG3CvuB,EAAKzqB,SAAK9D,EAAWL,EAAOE,GAC5BgtD,EAAO/oD,SAAK9D,EAAWL,EAAOE,IAIlB,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtC4xB,EAAS7uE,OAEVgtD,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxC6xB,EAAW9uE,SAGZ0uB,EAAKzqB,SAAK9D,EAAWL,EAAO+uE,EAAS7uE,OACrCgtD,EAAO/oD,SAAK9D,EAAWL,EAAOgvE,EAAW9uE,QAG3C80D,EAAQ3H,SAAW1uD,KAAKyuD,WAClB,GAAa,MAATltD,EAAgB,CAC1B,IAAMi9C,EACO,OADPA,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACA0uE,EAAS/uE,MACT8sC,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACA2uE,EAAWhvE,MACX8sC,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,MAG3CvuB,EAAKzqB,SAAK9D,EAAW0uE,EAAS/uE,MAAOE,GACrCgtD,EAAO/oD,SAAK9D,EAAW2uE,EAAWhvE,MAAOE,IAE1C80D,EAAQ3H,SAAW1uD,KAAKyuD,QAIhB0hB,mBAAV,SACChiB,EAAekI,EAAwB9iB,EACvCtjB,EAAkBs+B,EAAsB5hC,EAAkBlpB,EAC1D2sE,EAA0BC,EAA8BC,EAA0BC,GAElF,IAAMlvE,EAAQrB,KAAKqB,MACbE,EAAQvB,KAAKuB,MACnB,GAAa,MAATF,EACU,MAATE,EAEU,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtCrQ,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxCrQ,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,IAE3C7xB,EAAKnnB,SACJ9D,EACAk8C,GAAQY,MAAO8xB,EAASjvE,MAAOA,EAAOm9C,GACtCrQ,GAAUqQ,MAAO8xB,EAAS/uE,MAAOA,EAAOi9C,IAEzC/6C,EAAQ+B,SACP9D,EACAk8C,GAAQY,MAAO+xB,EAAYlvE,MAAOA,EAAOm9C,GACzCrQ,GAAUqQ,MAAO+xB,EAAYhvE,MAAOA,EAAOi9C,MAG5CvuB,EAAKzqB,SAAK9D,EAAWL,EAAOE,GAC5BgtD,EAAO/oD,SAAK9D,EAAWL,EAAOE,GAC9BorB,EAAKnnB,SAAK9D,EAAWL,EAAOE,GAC5BkC,EAAQ+B,SAAK9D,EAAWL,EAAOE,IAInB,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtC4xB,EAAS7uE,OAEVgtD,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxC6xB,EAAW9uE,OAEZorB,EAAKnnB,SACJ9D,EACAk8C,GAAQY,MAAO8xB,EAASjvE,MAAOA,EAAOm9C,GACtC8xB,EAAS/uE,OAEVkC,EAAQ+B,SACP9D,EACAk8C,GAAQY,MAAO+xB,EAAYlvE,MAAOA,EAAOm9C,GACzC+xB,EAAYhvE,SAGb0uB,EAAKzqB,SAAK9D,EAAWL,EAAO+uE,EAAS7uE,OACrCgtD,EAAO/oD,SAAK9D,EAAWL,EAAOgvE,EAAW9uE,OACzCorB,EAAKnnB,SAAK9D,EAAWL,EAAOivE,EAAS/uE,OACrCkC,EAAQ+B,SAAK9D,EAAWL,EAAOkvE,EAAYhvE,QAG7C80D,EAAQ3H,SAAW1uD,KAAKyuD,WAClB,GAAa,MAATltD,EAAgB,CAC1B,IAAMi9C,EACO,OADPA,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACA0uE,EAAS/uE,MACT8sC,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACA2uE,EAAWhvE,MACX8sC,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,IAE3C7xB,EAAKnnB,SACJ9D,EACA0uE,EAAS/uE,MACT8sC,GAAUqQ,MAAO8xB,EAAS/uE,MAAOA,EAAOi9C,IAEzC/6C,EAAQ+B,SACP9D,EACA2uE,EAAWhvE,MACX8sC,GAAUqQ,MAAO+xB,EAAYhvE,MAAOA,EAAOi9C,MAG5CvuB,EAAKzqB,SAAK9D,EAAW0uE,EAAS/uE,MAAOE,GACrCgtD,EAAO/oD,SAAK9D,EAAW2uE,EAAWhvE,MAAOE,GACzCorB,EAAKnnB,SAAK9D,EAAW4uE,EAASjvE,MAAOE,GACrCkC,EAAQ+B,SAAK9D,EAAW6uE,EAAYlvE,MAAOE,IAE5C80D,EAAQ3H,SAAW1uD,KAAKyuD,WA3OyByf,mBERnD,WAAat3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8gB,aAkBnC,OApBuDruE,OAKtD0wE,oBAAA,SAASriB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKywE,OACJtiB,EAAOkI,EAAS9iB,EAChB4a,EAAMl+B,KACNk+B,EAAMI,OACNJ,EAAMxhC,KACNwhC,EAAMxhC,KAAKlpB,QACXwpE,GAAkBoB,WAAYlgB,EAAOkI,GACrC4W,GAAkBsB,aAAcpgB,EAAOkI,GACvC4W,GAAkBuB,WAAYrgB,EAAOkI,GACrC4W,GAAkBwB,kBAAmBtgB,EAAOkI,QAhBO8Z,mBCCtD,WAAav5C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB2C,kBAQnC,OAVwDlwD,OAKvD4wE,oBAAA,SAASviB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMl+B,KAAMg9C,GAAkBoB,WAAYlgB,EAAOkI,QAP5B8Z,mBCCvD,WAAav5C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmByhB,6BAcnC,OAhBiEhvE,OAKhE6wE,oBAAA,SAASxiB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAK4wE,KACJziB,EAAOkI,EAAS9iB,EAChB4a,EAAMl+B,KACNk+B,EAAMI,OACN0e,GAAkBoB,WAAYlgB,EAAOkI,GACrC4W,GAAkBsB,aAAcpgB,EAAOkI,QAZsB8Z,mBCChE,WAAav5C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB4C,oBAQnC,OAV0DnwD,OAKzD+wE,oBAAA,SAAS1iB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMI,OAAQ0e,GAAkBsB,aAAcpgB,EAAOkI,QAP9B8Z,mBCCzD,WAAav5C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB6C,kBAQnC,OAVwDpwD,OAKvDgxE,oBAAA,SAAS3iB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMxhC,KAAMsgD,GAAkBuB,WAAYrgB,EAAOkI,QAP5B8Z,mBCCvD,WAAav5C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8C,0BAQnC,OAV+DrwD,OAK9DixE,oBAAA,SAAS5iB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMxhC,KAAKlpB,QAASwpE,GAAkBwB,kBAAmBtgB,EAAOkI,QAPpC8Z,mBCwB9D,WACCf,EAA2C1B,EAC3C7sE,EAAgBQ,EAAeE,EAAei9C,GAF/C,MAICx4C,YAAOipE,GAAsB+B,aAActD,EAAW0B,gBACtDjpE,EAAKtF,OAASA,EACdsF,EAAK9E,MAAQA,EACb8E,EAAK5E,MAAQA,EACb4E,EAAKq4C,MAAQA,IAiDf,OA/DkD1+C,OAiBjDmxE,qBAAA,SAAUr6C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBq6C,GAClBjxE,KAAKa,SAAW+1B,EAAM/1B,QACtBb,KAAKqB,QAAUu1B,EAAMv1B,OACrBrB,KAAKuB,QAAUq1B,EAAMr1B,OACrBvB,KAAKw+C,QAAU5nB,EAAM4nB,OAIvByyB,sBAAA,WACC,OAAQjxE,KAAKovE,SACb,KAAKE,GAAiC4B,KACrC,OAAO,IAAIR,GAAoC1wE,MAChD,KAAKsvE,GAAiC6B,OACrC,OAAO,IAAIN,GAAsC7wE,MAClD,KAAKsvE,GAAiC8B,gBACrC,OAAO,IAAIT,GAA6C3wE,MACzD,KAAKsvE,GAAiCzyC,KACrC,OAAO,IAAIi0C,GAAoC9wE,MAChD,KAAKsvE,GAAiC+B,aACrC,OAAO,IAAIN,GAA2C/wE,MACvD,KAAKsvE,GAAiC7nB,IACrC,OAAO,IAAI+oB,GAAmCxwE,QAIhDixE,sBAAA,SAAWlkB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/B4D,EAAUvkB,EAAQ16B,IAAIryB,KAAKw+C,OACjC,OAAOuO,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWpvE,KAAKa,WAAUb,KAAKqB,UAASrB,KAAKuB,UAAS+vE,QAItFL,cAAP,SACCrf,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClEiQ,EAAQgxB,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACpE,OAAO,IAAI0iC,EACVrf,EAAY,GAAK8b,EAAW9b,EAAY,GAAKA,EAAY,GAAKA,EAAY,GAAKpT,OA5DhC6wB,ICb5CkC,GAAoB,WAAqB,OAAA,qBAK9C,WAAa36C,EAA+C63B,GAA5D,MACCzoD,YAAO4wB,EAAO63B,gBACdtoD,EAAKqrE,WAAarrE,EAAKwnE,aAAc/2C,EAAM46C,WAAYD,GAAmB,UAoF5E,OAzF8DzxE,OAQnD2xE,gBAAV,SACCtjB,EAAekI,EAAwB9iB,EACvC1yC,EACA4M,GAEA,IAAM+jE,EAAaxxE,KAAKwxE,WAAYrjB,EAAO5a,GACzB,MAAdi+B,IACH3wE,EAAO2E,SACN9D,EACA1B,KAAK0xE,gBAAiBjkE,EAAKpM,MAAOmwE,GAClC/jE,EAAKlM,OAEN80D,EAAQ3H,SAAW1uD,KAAKyuD,QAIhBgjB,iBAAV,SACCtjB,EAAekI,EAAwB9iB,EACvCtjB,EAAkBs+B,EAClB6hB,EAA0BC,GAE1B,IAAMmB,EAAaxxE,KAAKwxE,WAAYrjB,EAAO5a,GACzB,MAAdi+B,IACHvhD,EAAKzqB,SACJ9D,EACA1B,KAAK0xE,gBAAiBtB,EAAS/uE,MAAOmwE,GACtCpB,EAAS7uE,OAGVgtD,EAAO/oD,SACN9D,EACA1B,KAAK0xE,gBAAiBrB,EAAWhvE,MAAOmwE,GACxCnB,EAAW9uE,OAGZ80D,EAAQ3H,SAAW1uD,KAAKyuD,QAIhBgjB,mBAAV,SACCtjB,EAAekI,EAAwB9iB,EACvCtjB,EAAkBs+B,EAAsB5hC,EAAkBlpB,EAC1D2sE,EAA0BC,EAA8BC,EAA0BC,GAElF,IAAMiB,EAAaxxE,KAAKwxE,WAAYrjB,EAAO5a,GACzB,MAAdi+B,IACHvhD,EAAKzqB,SACJ9D,EACA1B,KAAK0xE,gBAAiBtB,EAAS/uE,MAAOmwE,GACtCpB,EAAS7uE,OAGVgtD,EAAO/oD,SACN9D,EACA1B,KAAK0xE,gBAAiBrB,EAAWhvE,MAAOmwE,GACxCnB,EAAW9uE,OAGZorB,EAAKnnB,SACJ9D,EACA1B,KAAK0xE,gBAAiBpB,EAASjvE,MAAOmwE,GACtClB,EAAS/uE,OAGVkC,EAAQ+B,SACP9D,EACA1B,KAAK0xE,gBAAiBnB,EAAYlvE,MAAOmwE,GACzCjB,EAAYhvE,OAGb80D,EAAQ3H,SAAW1uD,KAAKyuD,QAIhBgjB,4BAAV,SAA2BpwE,EAAemwE,GACzC,OAAI,GAAKA,EACD5zB,GAAQ0wB,SAAUjtE,GAAQmwE,GAE1B5zB,GAAQixB,OAAQxtE,GAAQmwE,OAtF4BtD,mBCN7D,WAAat3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8gB,aAkBnC,OApBiEruE,OAKhE6xE,oBAAA,SAASxjB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKywE,OACJtiB,EAAOkI,EAAS9iB,EAChB4a,EAAMl+B,KACNk+B,EAAMI,OACNJ,EAAMxhC,KACNwhC,EAAMxhC,KAAKlpB,QACXwpE,GAAkBoB,WAAYlgB,EAAOkI,GACrC4W,GAAkBsB,aAAcpgB,EAAOkI,GACvC4W,GAAkBuB,WAAYrgB,EAAOkI,GACrC4W,GAAkBwB,kBAAmBtgB,EAAOkI,QAhBiBob,mBCChE,WAAa76C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB2C,kBAQnC,OAVkElwD,OAKjE8xE,oBAAA,SAASzjB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMl+B,KAAMg9C,GAAkBoB,WAAYlgB,EAAOkI,QAPlBob,mBCCjE,WAAa76C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmByhB,6BAcnC,OAhB2EhvE,OAK1E+xE,oBAAA,SAAS1jB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAK4wE,KACJziB,EAAOkI,EAAS9iB,EAChB4a,EAAMl+B,KACNk+B,EAAMI,OACN0e,GAAkBoB,WAAYlgB,EAAOkI,GACrC4W,GAAkBsB,aAAcpgB,EAAOkI,QAZgCob,mBCC1E,WAAa76C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB4C,oBAQnC,OAVoEnwD,OAKnEgyE,oBAAA,SAAS3jB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMI,OAAQ0e,GAAkBsB,aAAcpgB,EAAOkI,QAPpBob,mBCCnE,WAAa76C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB6C,kBAQnC,OAVkEpwD,OAKjEiyE,oBAAA,SAAS5jB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMxhC,KAAMsgD,GAAkBuB,WAAYrgB,EAAOkI,QAPlBob,mBCCjE,WAAa76C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8C,0BAQnC,OAVyErwD,OAKxEkyE,oBAAA,SAAS7jB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMxhC,KAAKlpB,QAASwpE,GAAkBwB,kBAAmBtgB,EAAOkI,QAP1Bob,mBC0BxE,WACCrC,EAA2C1B,EAAmB8D,GAD/D,MAGCxrE,YAAOipE,GAAsB+B,aAActD,EAAW0B,gBACtDjpE,EAAKqrE,WAAaA,IA+CpB,OAtDS1xE,OAURmyE,qBAAA,SAAUr7C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBq7C,GAClBjyE,KAAKwxE,aAAe56C,EAAM46C,YAI5BS,sBAAA,WACC,OAAQjyE,KAAKovE,SACb,KAAKE,GAAiC4B,KACrC,OAAO,IAAIU,GAA8C5xE,MAC1D,KAAKsvE,GAAiC6B,OACrC,OAAO,IAAIW,GAAgD9xE,MAC5D,KAAKsvE,GAAiC8B,gBACrC,OAAO,IAAIS,GAAuD7xE,MACnE,KAAKsvE,GAAiCzyC,KACrC,OAAO,IAAIk1C,GAA8C/xE,MAC1D,KAAKsvE,GAAiC+B,aACrC,OAAO,IAAIW,GAAqDhyE,MACjE,KAAKsvE,GAAiC7nB,IACrC,OAAO,IAAIkqB,GAA6C3xE,QAI1DiyE,sBAAA,SAAWllB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/B7sE,EAAS0uE,GAAmC2C,WAC5CC,EAAeplB,EAAQ16B,IAAIryB,KAAKwxE,YACtC,OAAOzkB,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWvuE,MAAUsxE,QAIrDF,cAAP,SACCrgB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClEijC,EAAahC,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACzE,OAAO,IAAI0jC,EACVrgB,EAAY,GAAK8b,EAAW8D,OAnDtBnC,ICjBH+C,GAAe,WAAqB,OAAA,MACpCC,GAAe,WAAqB,OAAA,MACpCpC,GAAe,WAAqB,OAAA,qBAOzC,WAAar5C,EAAyC63B,GAAtD,MACCzoD,YAAO4wB,EAAO63B,gBACdtoD,EAAK9E,MAAQ8E,EAAKwnE,aAAc/2C,EAAMv1B,MAAO+wE,GAAc,QAC3DjsE,EAAK5E,MAAQ4E,EAAKwnE,aAAc/2C,EAAMr1B,MAAO8wE,GAAc,QAC3DlsE,EAAKq4C,MAAQr4C,EAAKwnE,aAAc/2C,EAAM4nB,MAAOyxB,GAAc,UAuN7D,OAhOwDnwE,OAY7CwyE,gBAAV,SACCnkB,EAAekI,EAAwB9iB,EACvC1yC,EACA4M,GAEA,IAAMpM,EAAQrB,KAAKqB,MAAO8sD,EAAO5a,GAC3BhyC,EAAQvB,KAAKuB,MAAO4sD,EAAO5a,GACjC,GAAa,MAATlyC,EACU,MAATE,EAEU,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,IAEhC1yC,EAAO2E,SACN9D,EACAk8C,GAAQY,MAAO/wC,EAAKpM,MAAOA,EAAOm9C,GAClCrQ,GAAUqQ,MAAO/wC,EAAKlM,MAAOA,EAAOi9C,IAGrC39C,EAAO2E,SAAK9D,EAAWL,EAAOE,GAIlB,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,IAEhC1yC,EAAO2E,SACN9D,EACAk8C,GAAQY,MAAO/wC,EAAKpM,MAAOA,EAAOm9C,GAClC/wC,EAAKlM,OAGNV,EAAO2E,SAAK9D,EAAWL,EAAOoM,EAAKlM,OAGrC80D,EAAQ3H,SAAW1uD,KAAKyuD,WAClB,GAAa,MAATltD,EAAgB,CAC1B,IAAMi9C,EACO,OADPA,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,IAEhC1yC,EAAO2E,SACN9D,EACA+L,EAAKpM,MACL8sC,GAAUqQ,MAAO/wC,EAAKlM,MAAOA,EAAOi9C,IAGrC39C,EAAO2E,SAAK9D,EAAW+L,EAAKpM,MAAOE,GAEpC80D,EAAQ3H,SAAW1uD,KAAKyuD,QAIhB6jB,iBAAV,SACCnkB,EAAekI,EAAwB9iB,EACvCtjB,EAAkBs+B,EAClB6hB,EAA0BC,GAE1B,IAAMhvE,EAAQrB,KAAKqB,MAAO8sD,EAAO5a,GAC3BhyC,EAAQvB,KAAKuB,MAAO4sD,EAAO5a,GACjC,GAAa,MAATlyC,EACU,MAATE,EAEU,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtCrQ,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxCrQ,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,MAG3CvuB,EAAKzqB,SAAK9D,EAAWL,EAAOE,GAC5BgtD,EAAO/oD,SAAK9D,EAAWL,EAAOE,IAIlB,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtC4xB,EAAS7uE,OAEVgtD,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxC6xB,EAAW9uE,SAGZ0uB,EAAKzqB,SAAK9D,EAAWL,EAAO+uE,EAAS7uE,OACrCgtD,EAAO/oD,SAAK9D,EAAWL,EAAOgvE,EAAW9uE,QAG3C80D,EAAQ3H,SAAW1uD,KAAKyuD,WAClB,GAAa,MAATltD,EAAgB,CAC1B,IAAMi9C,EACO,OADPA,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACA0uE,EAAS/uE,MACT8sC,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACA2uE,EAAWhvE,MACX8sC,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,MAG3CvuB,EAAKzqB,SAAK9D,EAAW0uE,EAAS/uE,MAAOE,GACrCgtD,EAAO/oD,SAAK9D,EAAW2uE,EAAWhvE,MAAOE,IAE1C80D,EAAQ3H,SAAW1uD,KAAKyuD,QAIhB6jB,mBAAV,SACCnkB,EAAekI,EAAwB9iB,EACvCtjB,EAAkBs+B,EAAsB5hC,EAAkBlpB,EAC1D2sE,EAA0BC,EAA8BC,EAA0BC,GAElF,IAAMlvE,EAAQrB,KAAKqB,MAAO8sD,EAAO5a,GAC3BhyC,EAAQvB,KAAKuB,MAAO4sD,EAAO5a,GACjC,GAAa,MAATlyC,EACU,MAATE,EAEU,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtCrQ,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxCrQ,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,IAE3C7xB,EAAKnnB,SACJ9D,EACAk8C,GAAQY,MAAO8xB,EAASjvE,MAAOA,EAAOm9C,GACtCrQ,GAAUqQ,MAAO8xB,EAAS/uE,MAAOA,EAAOi9C,IAEzC/6C,EAAQ+B,SACP9D,EACAk8C,GAAQY,MAAO+xB,EAAYlvE,MAAOA,EAAOm9C,GACzCrQ,GAAUqQ,MAAO+xB,EAAYhvE,MAAOA,EAAOi9C,MAG5CvuB,EAAKzqB,SAAK9D,EAAWL,EAAOE,GAC5BgtD,EAAO/oD,SAAK9D,EAAWL,EAAOE,GAC9BorB,EAAKnnB,SAAK9D,EAAWL,EAAOE,GAC5BkC,EAAQ+B,SAAK9D,EAAWL,EAAOE,IAInB,OADPi9C,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACAk8C,GAAQY,MAAO4xB,EAAS/uE,MAAOA,EAAOm9C,GACtC4xB,EAAS7uE,OAEVgtD,EAAO/oD,SACN9D,EACAk8C,GAAQY,MAAO6xB,EAAWhvE,MAAOA,EAAOm9C,GACxC6xB,EAAW9uE,OAEZorB,EAAKnnB,SACJ9D,EACAk8C,GAAQY,MAAO8xB,EAASjvE,MAAOA,EAAOm9C,GACtC8xB,EAAS/uE,OAEVkC,EAAQ+B,SACP9D,EACAk8C,GAAQY,MAAO+xB,EAAYlvE,MAAOA,EAAOm9C,GACzC+xB,EAAYhvE,SAGb0uB,EAAKzqB,SAAK9D,EAAWL,EAAO+uE,EAAS7uE,OACrCgtD,EAAO/oD,SAAK9D,EAAWL,EAAOgvE,EAAW9uE,OACzCorB,EAAKnnB,SAAK9D,EAAWL,EAAOivE,EAAS/uE,OACrCkC,EAAQ+B,SAAK9D,EAAWL,EAAOkvE,EAAYhvE,QAG7C80D,EAAQ3H,SAAW1uD,KAAKyuD,WAClB,GAAa,MAATltD,EAAgB,CAC1B,IAAMi9C,EACO,OADPA,EAAQx+C,KAAKw+C,MAAO2P,EAAO5a,KAEhCtjB,EAAKzqB,SACJ9D,EACA0uE,EAAS/uE,MACT8sC,GAAUqQ,MAAO4xB,EAAS7uE,MAAOA,EAAOi9C,IAEzC+P,EAAO/oD,SACN9D,EACA2uE,EAAWhvE,MACX8sC,GAAUqQ,MAAO6xB,EAAW9uE,MAAOA,EAAOi9C,IAE3C7xB,EAAKnnB,SACJ9D,EACA0uE,EAAS/uE,MACT8sC,GAAUqQ,MAAO8xB,EAAS/uE,MAAOA,EAAOi9C,IAEzC/6C,EAAQ+B,SACP9D,EACA2uE,EAAWhvE,MACX8sC,GAAUqQ,MAAO+xB,EAAYhvE,MAAOA,EAAOi9C,MAG5CvuB,EAAKzqB,SAAK9D,EAAW0uE,EAAS/uE,MAAOE,GACrCgtD,EAAO/oD,SAAK9D,EAAW2uE,EAAWhvE,MAAOE,GACzCorB,EAAKnnB,SAAK9D,EAAW4uE,EAASjvE,MAAOE,GACrCkC,EAAQ+B,SAAK9D,EAAW6uE,EAAYlvE,MAAOE,IAE5C80D,EAAQ3H,SAAW1uD,KAAKyuD,WA7N6Byf,mBCTvD,WAAat3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8gB,aAkBnC,OApB2DruE,OAK1DyyE,oBAAA,SAASpkB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKywE,OACJtiB,EAAOkI,EAAS9iB,EAChB4a,EAAMl+B,KACNk+B,EAAMI,OACNJ,EAAMxhC,KACNwhC,EAAMxhC,KAAKlpB,QACXwpE,GAAkBoB,WAAYlgB,EAAOkI,GACrC4W,GAAkBsB,aAAcpgB,EAAOkI,GACvC4W,GAAkBuB,WAAYrgB,EAAOkI,GACrC4W,GAAkBwB,kBAAmBtgB,EAAOkI,QAhBWic,mBCC1D,WAAa17C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB2C,kBAQnC,OAV4DlwD,OAK3D0yE,oBAAA,SAASrkB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMl+B,KAAMg9C,GAAkBoB,WAAYlgB,EAAOkI,QAPxBic,mBCC3D,WAAa17C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmByhB,6BAcnC,OAhBqEhvE,OAKpE2yE,oBAAA,SAAStkB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAK4wE,KACJziB,EAAOkI,EAAS9iB,EAChB4a,EAAMl+B,KACNk+B,EAAMI,OACN0e,GAAkBoB,WAAYlgB,EAAOkI,GACrC4W,GAAkBsB,aAAcpgB,EAAOkI,QAZ0Bic,mBCCpE,WAAa17C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB4C,oBAQnC,OAV8DnwD,OAK7D4yE,oBAAA,SAASvkB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMI,OAAQ0e,GAAkBsB,aAAcpgB,EAAOkI,QAP1Bic,mBCC7D,WAAa17C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB6C,kBAQnC,OAV4DpwD,OAK3D6yE,oBAAA,SAASxkB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMxhC,KAAMsgD,GAAkBuB,WAAYrgB,EAAOkI,QAPxBic,mBCC3D,WAAa17C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmB8C,0BAQnC,OAVmErwD,OAKlE8yE,oBAAA,SAASzkB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,IAC7BvzC,KAAKwF,IAAK2oD,EAAOkI,EAAS9iB,EAAM4a,EAAMxhC,KAAKlpB,QAASwpE,GAAkBwB,kBAAmBtgB,EAAOkI,QAPhCic,mBCuBlE,WACClD,EAA2C1B,EAC3CrsE,EAAeE,EAAei9C,GAF/B,MAICx4C,YAAOipE,GAAsB+B,aAActD,EAAW0B,gBACtDjpE,EAAK9E,MAAQA,EACb8E,EAAK5E,MAAQA,EACb4E,EAAKq4C,MAAQA,IAqDf,OAjEsD1+C,OAerD+yE,qBAAA,SAAUj8C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBi8C,GAClB7yE,KAAKqB,QAAUu1B,EAAMv1B,OACrBrB,KAAKuB,QAAUq1B,EAAMr1B,OACrBvB,KAAKw+C,QAAU5nB,EAAM4nB,OAIvBq0B,sBAAA,WACC,OAAQ7yE,KAAKovE,SACb,KAAKE,GAAiC4B,KACrC,OAAO,IAAIsB,GAAwCxyE,MACpD,KAAKsvE,GAAiC6B,OACrC,OAAO,IAAIuB,GAA0C1yE,MACtD,KAAKsvE,GAAiC8B,gBACrC,OAAO,IAAIqB,GAAiDzyE,MAC7D,KAAKsvE,GAAiCzyC,KACrC,OAAO,IAAI81C,GAAwC3yE,MACpD,KAAKsvE,GAAiC+B,aACrC,OAAO,IAAIuB,GAA+C5yE,MAC3D,KAAKsvE,GAAiC7nB,IACrC,OAAO,IAAI8qB,GAAuCvyE,QAIpD6yE,sBAAA,SAAW9lB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/B7sE,EAAS0uE,GAAmCuD,KAC5CC,EAAUhmB,EAAQ16B,IAAIryB,KAAKqB,OAC3B2xE,EAAUjmB,EAAQ16B,IAAIryB,KAAKuB,OAC3B+vE,EAAUvkB,EAAQ16B,IAAIryB,KAAKw+C,OACjC,OAAOuO,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWvuE,MAAUkyE,MAAWC,MAAW1B,QAI3EuB,cAAP,SACCjhB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClEltC,EAAQmuE,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAC9DhtC,EAAQiuE,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAC9DiQ,EAAQgxB,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACpE,OAAO,IAAIskC,EACVjhB,EAAY,GAAK8b,EAAWrsE,EAAOE,EAAOi9C,OA9DS6wB,IClBhD4D,GAAc,WAAqB,OAAA,qBAKxC,WAAar8C,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBkD,qBACjCpqD,EAAKyc,KAAOzc,EAAKwnE,aAAc/2C,EAAMhU,KAAMqwD,GAAa,UAY1D,OAjBqDnzE,OAQpDozE,oBAAA,SAAS/kB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM/uB,EAAOxkB,KAAK4iB,KAAMurC,EAAO5a,GACnB,MAAR/uB,IACH2pC,EAAMK,OAAShqC,EACf6xC,EAAQ3H,SAAW1uD,KAAKyuD,YAbyByf,mBCOpD,WAAaR,EAAmB9qD,GAAhC,MACC5c,YAAOipE,GAAsBkE,cAAezF,gBAC5CvnE,EAAKyc,KAAOA,IA+Bd,OApCmD9iB,OAQlDszE,qBAAA,SAAUx8C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBw8C,GAClBpzE,KAAK4iB,OAASgU,EAAMhU,MAItBwwD,sBAAA,WACC,OAAO,IAAIF,GAAiClzE,OAG7CozE,sBAAA,SAAWrmB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/B2F,EAAStmB,EAAQ16B,IAAIryB,KAAK4iB,MAChC,OAAOmqC,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAeuD,QAI3BD,cAAP,SACCxhB,EACA7E,GAIA,OAAO,IAAIqmB,EAFO5D,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAC3DihC,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,gBAjClB2gC,ICJ7CoE,GAAgB,WAAc,OAAA,kBAMnC,WAAa18C,EAAoCiV,GAAjD,MACC7lC,YAAO4wB,EAAOy2B,GAAmBxwB,mBAEjC12B,EAAKotE,OAASptE,EAAKwnE,aAAc/2C,EAAMA,MAAO08C,GAAe,KAE7DznC,EAASA,EAAOj1B,OAChBzQ,EAAK6xB,UAAc,EAAI6T,EAAOl5B,OAASu7B,GAAiB/tC,OAAQ0rC,GAAW,OAU7E,OApByD/rC,OAaxD0zE,oBAAA,SAASrlB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM3c,EAAQ52B,KAAKuzE,OAAQplB,EAAO5a,GAClC4a,EAAMxhC,KAAKiK,MAA4B,MAAlB52B,KAAKg4B,UAAoBh4B,KAAKg4B,UAAU6T,OAAQjV,EAAO,GAAMmT,OAAOnT,GACzFy/B,EAAQ3H,SAAW1uD,KAAKyuD,WAjB8Byf,ICJnDuF,GAAc,WAAM,MAAA,mBAKzB,WAAa78C,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBxwB,mBACjC12B,EAAKwmB,KAAOxmB,EAAKwnE,aAAc/2C,EAAMA,MAAO68C,GAAa,QAS3D,OAduD3zE,OAQtD4zE,oBAAA,SAASvlB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,KAC7B4a,EAAMxhC,KAAKiK,MAAQmT,OAAO/pC,KAAK2sB,KAAMwhC,EAAO5a,IAC5C8iB,EAAQ3H,SAAW1uD,KAAKyuD,WAX4Byf,K3BRvD,SAAY8B,GACXA,mBACAA,uBAFD,CAAYA,KAAAA,Q4BeZ,ICfY2D,kBDkBX,WAAavE,EAA0C1B,EAAmB92C,GAA1E,MACC5wB,YAAOipE,GAAsB2E,YAAalG,EAAW0B,gBACrDjpE,EAAKywB,MAAQA,IAoCf,OAzCiD92B,OAQhD+zE,qBAAA,SAAUj9C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBi9C,GAClB7zE,KAAK42B,QAAUA,EAAMA,OAIvBi9C,sBAAA,SAAW1lB,GACV,OAAQnuD,KAAKovE,SACb,KAAKY,GAAgCnzC,KACpC,OAAO,IAAI62C,GAAmC1zE,MAC/C,KAAKgwE,GAAgC8D,OACpC,OAAO,IAAIN,GAAqCxzE,KAAMmuD,EAAMxhC,KAAKiK,SAInEi9C,sBAAA,SAAW9mB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/BqG,EAAUhnB,EAAQ16B,IAAIryB,KAAK42B,OACjC,OAAOm2B,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAW2E,QAI3CF,cAAP,SACCjiB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClE3X,EAAQ44C,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACpE,OAAO,IAAIslC,EAA6BjiB,EAAY,GAAK8b,EAAW92C,OAvCrBy4C,IET3C4D,GAAc,WAAqB,OAAA,qBAKxC,WAAar8C,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBppC,mBACjC9d,EAAKyc,KAAOzc,EAAKwnE,aAAc/2C,EAAMhU,KAAMqwD,GAAa,UAW1D,OAhBkDnzE,OAQjDk0E,oBAAA,SAAS7lB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM/uB,EAAOxkB,KAAK4iB,KAAMurC,EAAO5a,GACnB,MAAR/uB,GACHxkB,KAAKiT,KAAMuR,EAAM2pC,QAZ6B+f,mBCOjD,WAAaR,EAAmB9qD,GAAhC,MACC5c,YAAOipE,GAAsBgF,WAAYvG,gBACzCvnE,EAAKyc,KAAOA,IA6Bd,OAlCgD9iB,OAQ/Co0E,qBAAA,SAAUt9C,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBs9C,GAClBl0E,KAAK4iB,OAASgU,EAAMhU,MAItBsxD,sBAAA,WACC,OAAO,IAAIF,GAA8Bh0E,OAG1Ck0E,sBAAA,SAAWnnB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/B2F,EAAStmB,EAAQ16B,IAAIryB,KAAK4iB,MAChC,OAAOmqC,EAAQ16B,IAAK,IAAIryB,KAAK2a,SAAQm1D,MAAeuD,QAG9Ca,cAAP,SACCtiB,EACA7E,GAIA,OAAO,IAAImnB,EAFO1E,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAC3DihC,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,gBA/BrB2gC,kBCgB/C,aAAA,WACClvE,KAAK67C,MAAQ,KACb77C,KAAKmuD,MAAQ,KACbnuD,KAAK42B,MAAQ,GAEb52B,KAAKiF,MAAQ,IAAIunB,QACjBxsB,KAAKm0E,KAAO,IAAIt5C,YAEhB76B,KAAKo0E,GAAuB,SAAEn+D,GAC7B9P,EAAKkuE,eAAgBp+D,IAGtBjW,KAAKs0E,GAAoB,SAAEr+D,GAC1B9P,EAAKouE,YAAat+D,IAGnBjW,KAAKw0E,GAAoB,WACxBruE,EAAKsuE,eAGNz0E,KAAK00E,GAAsB,WAC1BvuE,EAAK+1C,iBAGNl8C,KAAK20E,GAAqB,SAAE1+D,GAC3B9P,EAAKyuE,aAAc3+D,IAGpBjW,KAAK60E,GAA4B,KA0PnC,OAvPWC,qBAAV,WAMC,OALkB,MAAd90E,KAAK67C,OACRx7C,EAAcK,cAAcq0E,iBAAiBpjC,YAC5C3xC,KAAK67C,MAAQ77C,KAAKg1E,eAGbh1E,KAAK67C,OAGHi5B,wBAAV,WACC,IAAMv0E,EAASqX,SAAS0Z,cAAe,SAEvC,OADA/wB,EAAO07C,aAAc,aAAc,SAC5B17C,GAGEu0E,yBAAV,WACC,MAAO,QAGEA,sBAAV,SAAqB3mB,EAAetS,EAAyBjlB,GAC5DilB,EAAMlhC,KAAO3a,KAAKi1E,eAClBp5B,EAAMjlB,MAAQA,EACdilB,EAAM/jC,iBAAkB,UAAW9X,KAAKo0E,IACxCv4B,EAAM/jC,iBAAkB,OAAQ9X,KAAKs0E,IACrCz4B,EAAM/jC,iBAAkB,SAAU9X,KAAK00E,IACvC74B,EAAM/jC,iBAAkB,QAAS9X,KAAK20E,IAGtC94B,EAAMI,aAAc,QAASj8C,KAAKk1E,cAAe/mB,IAG7CA,EAAMgnB,SACTt5B,EAAMI,aAAc,WAAY,YAEhCJ,EAAMu5B,gBAAiB,YAIpBjnB,EAAMU,SACThT,EAAMI,aAAc,WAAY,YAEhCJ,EAAMu5B,gBAAiB,aAIfN,oCAAV,WACC,MAAO,kCAGEA,gCAAV,WACC,MAAO,yCAGEA,iCAAV,SAAgC3mB,EAAelsC,GAC9C,IAEMozD,EAFUlnB,EAAMxhC,KAAKxoB,QAEOyzB,WAAa3V,EAC/C,MAAO,gBAAiCozD,YAA4CA,SAG3EP,iCAAV,WACC,MAAO,kBAGEA,kCAAV,SAAiCX,EAAiB37B,GACjD,MAAO,4BACG27B,EAAK7uE,aACN6uE,EAAK5uE,eACH4uE,EAAK/xE,oBACJ+xE,EAAKtuE,0BACAsuE,EAAKtuE,+BACA2yC,EAAOhrB,MAAKgrB,EAAOj5C,MAAKi5C,EAAOzwC,MAAKywC,EAAOl5C,MAAKk5C,EAAOkc,OAAMlc,EAAOmc,SAGjFmgB,8BAAV,SAA6B3mB,EAAegmB,EAAiBlyD,GAC5D,IAAM0K,EAAOwhC,EAAMxhC,KACnB,MAAO,gBAAgBob,GAAoBG,aAAcvb,EAAKsb,uBAC/Ctb,EAAKxgB,KAAO8V,sBACV0K,EAAK9H,SAAW+yC,GAAiB8D,OAAS,SAAW,oBAC1D/uC,EAAKtrB,MAAMW,SAAU,SAGxB8yE,gCAAV,SAA+B3mB,EAAegmB,EAAiBlyD,GAC9D,MAAO,cAGE6yD,0BAAV,SAAyB3mB,GACxB,IAAM0F,EAAQ1F,EAAMtsC,UAAUgyC,MACxB1nD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACb4uE,EAAOn0E,KAAKm0E,KAClBA,EAAK7uE,GAAK,GAAMymD,EAAQ8H,EAAMvuD,EAC9B6uE,EAAK5uE,GAAK,GAAMymD,EAAQ6H,EAAMtuD,EAC9B4uE,EAAK/xE,MAAQ2pD,EACbooB,EAAKtuE,OAASmmD,EAEdmC,EAAMziC,kBACN,IACMG,EAAiBsiC,EAAMtsC,UAAUgK,eAEvC,OAAO7rB,KAAKs1E,sBAAuBnB,EAAMtoD,GACxC7rB,KAAKu1E,oBAAqBpnB,EAAOgmB,EAJpB,GAKbn0E,KAAKw1E,kBAAmBrnB,EAAOgmB,EALlB,GAMbn0E,KAAKy1E,0BACLz1E,KAAK01E,sBACL11E,KAAK21E,qBAAsBxnB,EARd,GASbnuD,KAAK41E,wBAGGd,2BAAV,SAA0B7+D,GACzB,GAAID,EAAkB0C,WAAYzC,GAAM,CACvC,IAAMk4C,EAAQnuD,KAAKmuD,MACnB,GAAa,MAATA,EAAgB,CACnBnuD,KAAKk8C,gBACLl8C,KAAKo/C,OAEL,IAAM/mC,EAAkBW,EAAasP,qBAC/BjT,EAAYW,EAAkB2C,kBAAmB1C,GACjDxB,EAAY4D,EAAgBxC,cAAes4C,GAAO,GAAO,EAAO94C,GACrD,MAAbZ,IACHpU,EAAcK,cAAcinB,KAAKiqB,QACjC37B,EAAEgC,iBACFI,EAAgBO,WAAYnE,GAAW,GAAM,UAGrCuB,EAAkB6/D,QAAS5/D,KACrCjW,KAAKk8C,gBACLl8C,KAAKo/C,SAIG01B,wBAAV,SAAuB7+D,GACtBjW,KAAKk8C,gBACLl8C,KAAKo/C,QAGI01B,yBAAV,SAAwB7+D,GACvB,GAAIA,EAAEpV,kBAAkBi1E,iBAAmB,CAC1C,IAAM3nB,EAAQnuD,KAAKmuD,MACb4nB,EAAU/1E,KAAK+1E,QACR,MAAT5nB,GAA4B,MAAX4nB,GACpBA,EAAS5nB,EAAOl4C,EAAEpV,OAAO+1B,SAKlBk+C,wBAAV,WACC,IAAM3mB,EAAQnuD,KAAKmuD,MACnB,GAAa,MAATA,EACH,GAAIA,EAAM3+C,QAAU,CACnB,IAAMqsC,EAAQ77C,KAAK67C,MACN,MAATA,GACHA,EAAMI,aAAc,QAASj8C,KAAKk1E,cAAe/mB,SAGlDnuD,KAAKo/C,QAKR01B,oBAAA,SAAS3mB,GACR,OAASnuD,KAAKmuD,QAAUA,GAGzB2mB,iBAAA,SACCkB,EAAkBp/C,EAClBh1B,EAAqBm0E,GAErB,IAAME,EAAWj2E,KAAKmuD,MAItB,GAHgB,MAAZ8nB,GAAoBA,IAAaD,GACpCh2E,KAAKo/C,OAEY,MAAdp/C,KAAKmuD,MAAgB,CACxBnuD,KAAKmuD,MAAQ6nB,EACbh2E,KAAK42B,MAAQA,EACb52B,KAAK4B,SAAWA,EAChB5B,KAAK+1E,QAAUA,EAEf,IAAMppD,EAAOqpD,EAASrpD,KACV,MAARA,IACHA,EAAKuqC,QAAS,GAGf,IAAMgf,EAAM71E,EAAcK,cACpBm7C,EAAQ77C,KAAKm2E,WACnB,GAAa,MAATt6B,EAAgB,CACnB77C,KAAKo2E,UAAWJ,EAAUn6B,EAAOjlB,GAEjC,IAAMy/C,EAAmBr2E,KAAKw0E,GACxBhqE,EAAWxK,KAAK60E,GACN,MAAZrqE,GACHA,EAASsU,IAAK,aAAcu3D,GAE7Br2E,KAAK60E,GAA4BqB,EAAI1rE,SACrC0rE,EAAI1rE,SAAS2C,GAAI,aAAckpE,GAE/Bx6B,EAAMrmB,MAAMwkB,QAAU,GACtB6B,EAAMjK,QACNiK,EAAMlnC,SAGPtU,EAAcM,WAIhBm0E,iBAAA,WACC,IAAM3mB,EAAQnuD,KAAKmuD,MACnB,GAAa,MAATA,EAAgB,CACnBnuD,KAAKmuD,MAAQ,KACbnuD,KAAK42B,MAAQ,GAEb,IAAMjK,EAAOwhC,EAAMxhC,KACP,MAARA,IACHA,EAAKuqC,QAAS,GAGf,IAAMrb,EAAQ77C,KAAK67C,MACN,MAATA,IACHA,EAAMnU,oBAAqB,UAAW1nC,KAAKo0E,IAC3Cv4B,EAAMnU,oBAAqB,OAAQ1nC,KAAKs0E,IACxCz4B,EAAMnU,oBAAqB,SAAU1nC,KAAK00E,IAC1C74B,EAAMnU,oBAAqB,QAAS1nC,KAAK20E,IACzC94B,EAAMrmB,MAAMwkB,QAAU,QAGvB,IAAMxvC,EAAWxK,KAAK60E,GACN,MAAZrqE,IACHxK,KAAK60E,GAA4B,KACjCrqE,EAASsU,IAAK,aAAc9e,KAAKw0E,KAGlCn0E,EAAcM,WAIhBm0E,0BAAA,WACC,IAAM3mB,EAAQnuD,KAAKmuD,MACbtS,EAAQ77C,KAAK67C,MACbj6C,EAAW5B,KAAK4B,SACtB,GAAa,MAATusD,GAA0B,MAATtS,GAA6B,MAAZj6C,EAAmB,CACxD,IAAMy3D,EAAWxd,EAAMjlB,MACnB52B,KAAK42B,QAAUyiC,GAClBz3D,EAAUusD,EAAOkL,yBCtSpB,oBACCrzD,mBA8BF,OAlCkDlG,OAOjDw2E,oBAAA,SAASnoB,EAAekI,EAAwB9iB,GAAhD,WACC,IAAM4a,EAAMU,SAAW,CACtB,IAAM0nB,EAAOD,EAA6BE,UACtCroB,EAAM71C,QACHi+D,EAAKE,QAAStoB,IACnBntC,YAAW,WACVu1D,EAAKl3B,KAAM8O,EAAOA,EAAMxhC,KAAKiK,OAAO,SAAE8/C,EAAW9/C,GAChDu3B,EAAMxhC,KAAKiK,MAAQA,EACnBzwB,EAAK8M,KAAM,SAAUk7C,EAAOv3B,QAE3B,GAGA2/C,EAAKE,QAAStoB,KACjBooB,EAAKr6B,gBACLq6B,EAAKn3B,UAMFk3B,UAAP,WAIC,OAHyC,MAArCA,EAA6BxvE,OAChCwvE,EAA6BxvE,KAAO,IAAIguE,IAElCwB,EAA6BxvE,MA/B9BwvE,OAAgD,QADNpJ,KJLlD,SAAYyG,GACXA,qBADD,CAAYA,KAAAA,QKcZ,ICdYgD,kBDeX,WAAavH,EAAoC1B,UAChD1nE,YAAOipE,GAAsB2H,KAAMlJ,EAAW0B,SAsBhD,OAxB2CtvE,OAK1C+2E,sBAAA,SAAW1oB,GACV,OAAQnuD,KAAKovE,SACb,KAAKuE,GAA0BmD,MAC9B,OAAO,IAAIR,KAIbO,sBAAA,SAAW9pB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WACrC,OAAO3gB,EAAQ16B,IAAK,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,cAGnDyH,cAAP,SACCjlB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACxE,OAAO,IAAIsoC,EAAuBjlB,EAAY,GAAK8b,OAtBV2B,IETrC0H,GAAgB,WAAqB,OAAA,qBAK1C,WAAangD,EAA8B63B,GAA3C,MACCzoD,YAAO4wB,EAAO63B,gBACdtoD,EAAKtF,OAASsF,EAAKwnE,aAAc/2C,EAAM/1B,OAAQk2E,GAAe,UAEhE,OAP6Cj3E,UAAAouE,mBCA5C,WAAat3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmBppC,YAcnC,OAhBiDnkB,OAKhDk3E,oBAAA,SAAS7oB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM1yC,EAASb,KAAKa,OAAQstD,EAAO5a,GACnC,GAAc,MAAV1yC,EAAiB,CACpB,IAAM2sE,EAAcntE,EAAcK,cAC9B,WAAY8sE,GACfA,EAAYyJ,OAAQp2E,SAXwBq2E,mBCAhD,WAAatgD,UACZ5wB,YAAO4wB,EAAOy2B,GAAmBppC,YAWnC,OAbiDnkB,OAKhDq3E,oBAAA,SAAShpB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM1yC,EAASb,KAAKa,OAAQstD,EAAO5a,GACrB,MAAV1yC,GACHkgB,OAAOghC,KAAMlhD,QATgCq2E,mBCChD,WAAatgD,UACZ5wB,YAAO4wB,EAAOy2B,GAAmBppC,YAWnC,OAbwDnkB,OAKvDs3E,oBAAA,SAASjpB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM1yC,EAASb,KAAKa,OAAQstD,EAAO5a,GACrB,MAAV1yC,IACHkgB,OAAOyhC,SAAS1I,KAAOj5C,QAT6Bq2E,KJLxD,SAAYP,GACXA,mBACAA,mBACAA,mCAHD,CAAYA,KAAAA,QKgBZ,IChBYU,kBDmBX,WAAajI,EAAoC1B,EAAmB7sE,GAApE,MACCmF,YAAOipE,GAAsBqI,KAAM5J,EAAW0B,gBAC9CjpE,EAAKtF,OAASA,IAoChB,OAzC2Cf,OAQ1Cy3E,qBAAA,SAAU3gD,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiB2gD,GAClBv3E,KAAKa,SAAW+1B,EAAM/1B,QAIxB02E,sBAAA,WACC,OAAQv3E,KAAKovE,SACb,KAAKuH,GAA0Ba,KAC9B,OAAO,IAAIR,GAA6Bh3E,MACzC,KAAK22E,GAA0Bc,KAC9B,OAAO,IAAIN,GAA6Bn3E,MACzC,KAAK22E,GAA0Be,aAC9B,OAAO,IAAIN,GAAoCp3E,QAIjDu3E,sBAAA,SAAWxqB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/BiK,EAAW5qB,EAAQ16B,IAAIryB,KAAKa,QAClC,OAAOksD,EAAQ16B,IAAK,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWuI,QAG9DJ,cAAP,SACC3lB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClE1tC,EAAS2uE,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACrE,OAAO,IAAIgpC,EAAuB3lB,EAAY,GAAK8b,EAAW7sE,OAvCrBwuE,KChB3C,SAAYgI,GACXA,mBACAA,mBAFD,CAAYA,KAAAA,QCMZ,ICNYO,GCAAC,kBFSX,WAAajhD,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmB0C,yBACjC5pD,EAAK2xE,WAAelhD,EAAMw4C,UAAYiI,GAA8BU,OAStE,OAdiDj4E,OAQhDk4E,oBAAA,SAAS7pB,EAAekI,EAAwB9iB,GACxCvzC,KAAK0tE,UAAWvf,EAAO5a,KAC7B4a,EAAM3+C,QAAUxP,KAAK83E,WACrBzhB,EAAQ3H,SAAW1uD,KAAKyuD,WAXsByf,mBGOhD,WAAakB,EAAwC1B,UACpD1nE,YAAOipE,GAAsBgJ,UAAWvK,EAAW0B,SAmBrD,OArB+CtvE,OAK9Co4E,sBAAA,WACC,OAAO,IAAIF,GAA6Bh4E,OAGzCk4E,sBAAA,SAAWnrB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WACrC,OAAO3gB,EAAQ16B,IAAK,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,cAGnD8I,cAAP,SACCtmB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACxE,OAAO,IAAI2pC,EAA2BtmB,EAAY,GAAK8b,OAnBV2B,ICPzC8I,GAAgB,WAAc,OAAA,kBAKnC,WAAavhD,EAAuC63B,GAApD,MACCzoD,YAAO4wB,EAAO63B,gBACdtoD,EAAKo4C,OAASp4C,EAAKwnE,aAAc/2C,EAAM2nB,OAAQ45B,GAAe,OAEhE,OAPsDr4E,UAAAouE,mBCDrD,WAAat3C,UACZ5wB,YAAO4wB,EAAOy2B,GAAmBwC,kBAUnC,OAZ+D/vD,OAK9Ds4E,oBAAA,SAASjqB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GACnC4a,EAAMtsC,UAAUhF,SAASvX,EAAIi5C,EAC7B8X,EAAQ3H,SAAW1uD,KAAKyuD,WAToC4pB,mBCC9D,WAAazhD,UACZ5wB,YAAO4wB,EAAOy2B,GAAmByC,kBAUnC,OAZ+DhwD,OAK9Dw4E,oBAAA,SAASnqB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GACnC4a,EAAMtsC,UAAUhF,SAAStX,EAAIg5C,EAC7B8X,EAAQ3H,SAAW1uD,KAAKyuD,WAToC4pB,mBCC9D,WAAazhD,UACZ5wB,YAAO4wB,EAAOy2B,GAAmBvxC,gBAkBnC,OApBuEhc,OAKtEy4E,oBAAA,SAASpqB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GAE7B12B,EADYsxC,EAAMtsC,UACGhF,SACrB27D,EAA2E,IAArDniB,EAAQ3H,QAAUrB,GAAmBwC,YAC3D4oB,EAA2E,IAArDpiB,EAAQ3H,QAAUrB,GAAmByC,YAC3D4oB,EAAiBF,EAAmB37D,EAASvX,EAAI+wD,EAAQ/wD,EACzDqzE,EAAiBF,EAAmB57D,EAAStX,EAAI8wD,EAAQ9wD,EAC/D4oD,EAAMziC,kBACN,IAAM6P,EAAiB4yB,EAAMtsC,UAAU0Z,eACvC1e,EAASrX,IAAKkzE,EAAen9C,EAAexzB,EAAIw2C,EAAQo6B,EAAep9C,EAAej8B,EAAIi/C,GAC1F8X,EAAQ3H,SAAW1uD,KAAKyuD,WAjB4C4pB,mBCCtE,WAAazhD,UACZ5wB,YAAO4wB,EAAOy2B,GAAmBvxC,gBAkBnC,OApBiEhc,OAKhE84E,oBAAA,SAASzqB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GAE7B12B,EADYsxC,EAAMtsC,UACGhF,SACrB27D,EAA2E,IAArDniB,EAAQ3H,QAAUrB,GAAmBwC,YAC3D4oB,EAA2E,IAArDpiB,EAAQ3H,QAAUrB,GAAmByC,YAC3D4oB,EAAiBF,EAAmB37D,EAASvX,EAAI+wD,EAAQ/wD,EACzDqzE,EAAiBF,EAAmB57D,EAAStX,EAAI8wD,EAAQ9wD,EAC/D4oD,EAAMziC,kBACN,IAAM6P,EAAiB4yB,EAAMtsC,UAAU0Z,eACvC1e,EAASrX,IAAKkzE,EAAen9C,EAAe/N,EAAI+wB,EAAQo6B,EAAep9C,EAAeh8B,EAAIg/C,GAC1F8X,EAAQ3H,SAAW1uD,KAAKyuD,WAjBsC4pB,mBCChE,WAAazhD,UACZ5wB,YAAO4wB,EAAOy2B,GAAmBwC,kBAanC,OAf+D/vD,OAK9D+4E,oBAAA,SAAS1qB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GAC7BilC,EAA2E,IAArDniB,EAAQ3H,QAAUrB,GAAmBwC,YAC3DhzC,EAAWsxC,EAAMtsC,UAAUhF,SAC3B67D,EAAiBF,EAAmB37D,EAASvX,EAAI+wD,EAAQ/wD,EAC/DuX,EAASvX,EAAIozE,EAAen6B,EAC5B8X,EAAQ3H,SAAW1uD,KAAKyuD,WAZoC4pB,mBCC9D,WAAa9lB,UACZvsD,YAAOusD,EAAQlF,GAAmByC,kBAapC,OAf+DhwD,OAK9Dg5E,oBAAA,SAAS3qB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GAC7BklC,EAA2E,IAArDpiB,EAAQ3H,QAAUrB,GAAmByC,YAC3DjzC,EAAWsxC,EAAMtsC,UAAUhF,SAC3B87D,EAAiBF,EAAmB57D,EAAStX,EAAI8wD,EAAQ9wD,EAC/DsX,EAAStX,EAAIozE,EAAep6B,EAC5B8X,EAAQ3H,SAAW1uD,KAAKyuD,WAZoC4pB,mBCA9D,WAAa19D,EAA6B+yD,EAAmB0B,EAAkB2J,GAA/E,MACC/yE,YAAO2U,EAAM+yD,EAAW0B,gBACxBjpE,EAAK4yE,QAAUA,IAWjB,OAhBUj5E,OAQTk5E,qBAAA,SAAUpiD,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBoiD,GAClBh5E,KAAK+4E,UAAYniD,EAAMmiD,YAZhB1J,KVFV,SAAYuI,GACXA,+BACAA,+BACAA,+BACAA,+BACAA,iDACAA,qCAND,CAAYA,KAAAA,QCAZ,SAAYC,GACXA,uBACAA,mBACAA,uBAHD,CAAYA,KAAAA,QUuBZ,ICvBYoB,kBD2BX,WAAaF,EAA6CrL,EAAmBnvB,GAA7E,MACCv4C,YAAOipE,GAAsBxY,UAAWiX,EAAWmK,GAA+BqB,KAAMH,gBACxF5yE,EAAKo4C,OAASA,IA4ChB,OAjDSz+C,OAQRq5E,qBAAA,SAAUviD,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBuiD,GAClBn5E,KAAKu+C,SAAW3nB,EAAM2nB,QAIxB46B,sBAAA,WACC,OAAQn5E,KAAK+4E,SACb,KAAKnB,GAAmCwB,WACvC,OAAO,IAAIhB,GAA2Cp4E,MACvD,KAAK43E,GAAmCyB,WACvC,OAAO,IAAIf,GAA2Ct4E,MACvD,KAAK43E,GAAmC0B,oBACvC,OAAO,IAAIf,GAAmDv4E,MAC/D,KAAK43E,GAAmC2B,cACvC,OAAO,IAAIX,GAA6C54E,MACzD,KAAK43E,GAAmC4B,WACvC,OAAO,IAAIX,GAA2C74E,MACvD,KAAK43E,GAAmC6B,WACvC,OAAO,IAAIX,GAA2C94E,QAIxDm5E,sBAAA,SAAWpsB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAIryB,KAAK0tE,WAC/BgM,EAAW3sB,EAAQ16B,IAAIryB,KAAKu+C,QAClC,OAAOwO,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWpvE,KAAK+4E,YAAWW,QAI3DP,cAAP,SACCvnB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClEgQ,EAASixB,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACrE,OAAO,IAAI4qC,EAAgCvnB,EAAY,GAAK8b,EAAWnvB,OA/ChEy6B,kBErBT,cA+EA,OA9EQW,YAAP,SAAkB/iD,GACjB,OAAO3qB,KAAK4nB,MAAe,IAAR+C,GAAgB,KAG7B+iD,eAAP,SAAqBxtE,GAEpB,OAAIF,KAAKoT,IAAKlT,GADI,KAERA,EAAO,GAFC,KAEgB,KAE3BwtE,EAAYvgD,UAAWjtB,IAGxBwtE,SAAP,SAAexrB,EAAethD,EAAawrD,EAAWuhB,EAAqBC,GAC1E1rB,EAAMqB,yBACN,IAAM3yC,EAAWsxC,EAAMtsC,UAAUhF,SACjC,GAAI+8D,EAAa,CAChB,IAAMx6D,EAAKnT,KAAKoT,IAAIg5C,EAAG/yD,EAAIuH,EAAKvH,GAC1Bga,EAAKrT,KAAKoT,IAAIg5C,EAAG9yD,EAAIsH,EAAKtH,GAChC,GAAIs0E,EAAW,CACd,IACM1tE,GADA2tE,EAAQ7tE,KAAKC,IAAIkT,EAAIE,IACNw6D,EACrB3rB,EAAMhiD,KAAK3G,IACVm0E,EAAYI,aAAc5tE,GAC1BwtE,EAAYI,aAAc5tE,IAE3B0Q,EAASrX,IACRm0E,EAAYvgD,UAAWvsB,EAAKvH,GAC5Bq0E,EAAYvgD,UAAWvsB,EAAKtH,SAG7B4oD,EAAMhiD,KAAK3G,IACVm0E,EAAYI,aAAc36D,EAAKA,GAC/Bu6D,EAAYI,aAAcz6D,EAAKA,IAEhCzC,EAASrX,IACRm0E,EAAYvgD,UAAWvsB,EAAKvH,GAC5Bq0E,EAAYvgD,UAAWvsB,EAAKtH,SAI9B,GAAIs0E,EAAY,CACTz6D,EAAKi5C,EAAG/yD,EAAIuH,EAAKvH,EACjBga,EAAK+4C,EAAG9yD,EAAIsH,EAAKtH,EACjB4G,EAAOF,KAAKC,IAAID,KAAKoT,IAAID,GAAKnT,KAAKoT,IAAIC,IAF7C,IAGMzW,EAAKgE,EAAKvH,GAAK8Z,EAAK,GAAKjT,GAAQA,GACjCpD,EAAK8D,EAAKtH,GAAK+Z,EAAK,GAAKnT,GAAQA,GACjC2tE,EAAe,GAAP3tE,EACR7G,EAAI2G,KAAK0iB,IAAI9hB,EAAKvH,EAAGuD,GAAMixE,EAC3Bv0E,EAAI0G,KAAK0iB,IAAI9hB,EAAKtH,EAAGwD,GAAM+wE,EACjC3rB,EAAMhiD,KAAK3G,IACVm0E,EAAYI,aAAc5tE,GAC1BwtE,EAAYI,aAAc5tE,IAE3B0Q,EAASrX,IACRm0E,EAAYvgD,UAAW9zB,GACvBq0E,EAAYvgD,UAAW7zB,QAElB,CACN,IAAMiC,EAAKyE,KAAK0iB,IAAI9hB,EAAKvH,EAAG+yD,EAAG/yD,GACzBoC,EAAKuE,KAAK0iB,IAAI9hB,EAAKtH,EAAG8yD,EAAG9yD,GAGzBnD,EAFK6J,KAAKC,IAAIW,EAAKvH,EAAG+yD,EAAG/yD,GAEZkC,EACb3B,EAFKoG,KAAKC,IAAIW,EAAKtH,EAAG8yD,EAAG9yD,GAEXmC,EACdmuD,EAAa,GAARzzD,EACL0zD,EAAc,GAATjwD,EACXsoD,EAAMhiD,KAAK3G,IACVm0E,EAAYI,aAAc33E,GAC1Bu3E,EAAYI,aAAcl0E,IAE3BgX,EAASrX,IACRm0E,EAAYvgD,UAAW5xB,EAAKquD,GAC5B8jB,EAAYvgD,UAAW1xB,EAAKouD,IAI/B3H,EAAMsB,6BDhFR,SAAYwpB,GACXA,qCACAA,yCACAA,uCACAA,qCACAA,yCACAA,uCAND,CAAYA,KAAAA,QEOZ,ICPYe,GDONC,GAAsB,WAAc,OAAA,GACpCC,GAAsB,WAAc,OAAA,oBAKzC,WAAatjD,EAAyC63B,GAAtD,MACCzoD,YAAO4wB,EAAO63B,SACd,OAAQ73B,EAAMmiD,SACd,KAAKE,GAAqCkB,cACzCh0E,EAAKgG,KAAOhG,EAAKwnE,aAAc/2C,EAAM2nB,OAAQ07B,GAAqB,KAClE,MACD,KAAKhB,GAAqCmB,cACzCj0E,EAAKgG,KAAOhG,EAAKwnE,aAAc/2C,EAAM2nB,OAAQ27B,GAAqB,OAClE,MACD,KAAKjB,GAAqCoB,gBACzCl0E,EAAKgG,KAAOhG,EAAKwnE,aAAc/2C,EAAM2nB,OAAQ07B,GAAqB,KAClE,MACD,KAAKhB,GAAqCqB,gBACzCn0E,EAAKgG,KAAOhG,EAAKwnE,aAAc/2C,EAAM2nB,OAAQ27B,GAAqB,OAClE,MACD,KAAKjB,GAAqCsB,eACzCp0E,EAAKgG,KAAOhG,EAAKwnE,aAAc/2C,EAAM2nB,OAAQ07B,GAAqB,KAClE,MACD,KAAKhB,GAAqCuB,eACzCr0E,EAAKgG,KAAOhG,EAAKwnE,aAAc/2C,EAAM2nB,OAAQ27B,GAAqB,OAClE,MACD,QACC/zE,EAAKgG,KAAO8tE,YAyBf,OAlDwDn6E,OA6B7C26E,2BAAV,SACCtsB,EAAekI,EACfqkB,EAAaC,EACbC,EAAiBC,GAEjB,IAAMz7D,IAAQ,GAAMw7D,GAAYF,EAC1Bp7D,IAAQ,GAAMu7D,GAAYF,EAChCxsB,EAAMziC,kBACN,IAAM7J,EAAYssC,EAAMtsC,UAClBhF,EAAWgF,EAAUhF,SACrB0e,EAAiB1Z,EAAU0Z,eAC3Bi9C,EAA2E,IAArDniB,EAAQ3H,QAAUrB,GAAmBwC,YAC3D4oB,EAA2E,IAArDpiB,EAAQ3H,QAAUrB,GAAmByC,YAC3D4oB,EAAiBF,EAAmB37D,EAASvX,EAAI+wD,EAAQ/wD,EACzDqzE,EAAiBF,EAAmB57D,EAAStX,EAAI8wD,EAAQ9wD,EAC/D8wD,EAAQ3H,SAAWrB,GAAmBvxC,SACtCe,EAASrX,IACRkzE,EAAet5D,EAAKmc,EAAe/N,EAAIlO,EAAKic,EAAexzB,EAC3D4wE,EAAev5D,EAAKmc,EAAeh8B,EAAI+f,EAAKic,EAAej8B,OA/CN4uE,mBEDvD,WAAat3C,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmB+C,qBACjCjqD,EAAK4nB,OAAS6I,EAAMikD,QACpB10E,EAAKsoD,OAASpB,GAAmBvxC,WAkBnC,OAxBsEhc,OASrEg7E,oBAAA,SAAS3sB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMwnC,EAAe/6E,KAAKmM,KAAMgiD,EAAO5a,GACjCpnC,EAAOgiD,EAAMhiD,KAEb6uE,EADoE,IAAjD3kB,EAAQ3H,QAAUrB,GAAmB+C,QAC5BjkD,EAAK5G,EAAI8wD,EAAQlqD,KAAK5G,EACxD4G,EAAK5G,EAAIo0E,GAAYI,aAAcgB,GACnC1kB,EAAQ3H,SAAWrB,GAAmB+C,OACtCpwD,KAAKi7E,eACJ9sB,EAAOkI,EACP,EAAG2kB,EAAW7uE,EAAK5G,EACnB,GAAKvF,KAAK+tB,aApBwD0sD,mBCGrE,WAAa7jD,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmB+C,qBACjCjqD,EAAK4nB,OAAS6I,EAAMikD,QACpB10E,EAAKsoD,OAASpB,GAAmBvxC,WAkBnC,OAxBsEhc,OASrEo7E,oBAAA,SAAS/sB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM4nC,EAAen7E,KAAKmM,KAAMgiD,EAAO5a,GACjCpnC,EAAOgiD,EAAMhiD,KAEb6uE,EADoE,IAAjD3kB,EAAQ3H,QAAUrB,GAAmB+C,QAC5BjkD,EAAK5G,EAAI8wD,EAAQlqD,KAAK5G,EACxD4G,EAAK5G,EAAIo0E,GAAYI,aAAciB,EAAWG,GAC9C9kB,EAAQ3H,SAAWrB,GAAmB+C,OACtCpwD,KAAKi7E,eACJ9sB,EAAOkI,EACP,EAAG2kB,EAAW7uE,EAAK5G,EACnB,GAAKvF,KAAK+tB,aApBwD0sD,mBCIrE,WAAa7jD,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBpxC,mBACjC9V,EAAKy0E,QAAUhkD,EAAMgkD,QACrBz0E,EAAK00E,QAAUjkD,EAAMikD,QACrB10E,EAAKsoD,OAASpB,GAAmBvxC,WAoBnC,OA5BoEhc,OAWnEs7E,oBAAA,SAASjtB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMwnC,EAAepB,GAAYI,aAAc/5E,KAAKmM,KAAMgiD,EAAO5a,IAC3DpnC,EAAOgiD,EAAMhiD,KACbkvE,EAAkE,IAAhDhlB,EAAQ3H,QAAUrB,GAAmBgD,OACvDirB,EAAoE,IAAjDjlB,EAAQ3H,QAAUrB,GAAmB+C,QACxDmrB,EAAYF,EAAelvE,EAAK7G,EAAI+wD,EAAQlqD,KAAK7G,EACjD01E,EAAYM,EAAgBnvE,EAAK5G,EAAI8wD,EAAQlqD,KAAK5G,EACxD4G,EAAK3G,IAAKu1E,EAAcA,GACxB1kB,EAAQ3H,SAAWrB,GAAmBpxC,KACtCjc,KAAKi7E,eACJ9sB,EAAOkI,EACPklB,EAAWpvE,EAAK7G,EAAG01E,EAAW7uE,EAAK5G,EACnCvF,KAAK46E,QAAS56E,KAAK66E,cAxB6CJ,mBCInE,WAAa7jD,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBpxC,mBACjC9V,EAAKy0E,QAAUhkD,EAAMgkD,QACrBz0E,EAAK00E,QAAUjkD,EAAMikD,QACrB10E,EAAKsoD,OAASpB,GAAmBvxC,WAuBnC,OA/BoEhc,OAWnE07E,oBAAA,SAASrtB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM4nC,EAAen7E,KAAKmM,KAAMgiD,EAAO5a,GACjCpnC,EAAOgiD,EAAMhiD,KACbkvE,EAAkE,IAAhDhlB,EAAQ3H,QAAUrB,GAAmBgD,OACvDirB,EAAoE,IAAjDjlB,EAAQ3H,QAAUrB,GAAmB+C,QACxDmrB,EAAYF,EAAelvE,EAAK7G,EAAI+wD,EAAQlqD,KAAK7G,EACjD01E,EAAYM,EAAgBnvE,EAAK5G,EAAI8wD,EAAQlqD,KAAK5G,EACxD4G,EAAK3G,IACJm0E,GAAYI,aAAcwB,EAAWJ,GACrCxB,GAAYI,aAAciB,EAAWG,IAEtC9kB,EAAQ3H,SAAWrB,GAAmBpxC,KACtCjc,KAAKi7E,eACJ9sB,EAAOkI,EACPklB,EAAWpvE,EAAK7G,EAAG01E,EAAW7uE,EAAK5G,EACnCvF,KAAK46E,QAAS56E,KAAK66E,cA3B6CJ,mBCGnE,WAAa7jD,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBgD,oBACjClqD,EAAK4nB,OAAS6I,EAAMgkD,QACpBz0E,EAAKsoD,OAASpB,GAAmBvxC,WAkBnC,OAxBqEhc,OASpE27E,oBAAA,SAASttB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMwnC,EAAe/6E,KAAKmM,KAAMgiD,EAAO5a,GACjCpnC,EAAOgiD,EAAMhiD,KAEbovE,EADkE,IAAhDllB,EAAQ3H,QAAUrB,GAAmBgD,OAC5BlkD,EAAK7G,EAAI+wD,EAAQlqD,KAAK7G,EACvD6G,EAAK7G,EAAIq0E,GAAYI,aAAcgB,GACnC1kB,EAAQ3H,SAAWrB,GAAmBgD,MACtCrwD,KAAKi7E,eACJ9sB,EAAOkI,EACPklB,EAAWpvE,EAAK7G,EAAG,EACnBtF,KAAK+tB,OAAQ,SApBoD0sD,mBCGpE,WAAa7jD,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBgD,oBACjClqD,EAAK4nB,OAAS6I,EAAMgkD,QACpBz0E,EAAKsoD,OAASpB,GAAmBvxC,WAkBnC,OAxBqEhc,OASpE47E,oBAAA,SAASvtB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAM4nC,EAAen7E,KAAKmM,KAAMgiD,EAAO5a,GACjCpnC,EAAOgiD,EAAMhiD,KAEbovE,EADkE,IAAhDllB,EAAQ3H,QAAUrB,GAAmBgD,OAC3BlkD,EAAK7G,EAAI+wD,EAAQlqD,KAAK7G,EACxD6G,EAAK7G,EAAIq0E,GAAYI,aAAcwB,EAAWJ,GAC9C9kB,EAAQ3H,SAAWrB,GAAmBgD,MACtCrwD,KAAKi7E,eACJ9sB,EAAOkI,EACPklB,EAAWpvE,EAAK7G,EAAG,EACnBtF,KAAK+tB,OAAQ,SApBoD0sD,mBCkCpE,WACC1B,EACArL,EACAkN,EAAiBC,EACjBt8B,GAJD,MAMCv4C,YAAOipE,GAAsBxY,UAAWiX,EAAWmK,GAA+B8D,OAAQ5C,gBAC1F5yE,EAAKy0E,QAAUA,EACfz0E,EAAK00E,QAAUA,EACf10E,EAAKo4C,OAASA,IAiDhB,OA/DSz+C,OAiBR87E,qBAAA,SAAUhlD,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBglD,GAClB57E,KAAK46E,UAAYhkD,EAAMgkD,SACvB56E,KAAK66E,UAAYjkD,EAAMikD,SACvB76E,KAAKu+C,SAAW3nB,EAAM2nB,QAIxBq9B,sBAAA,WACC,OAAQ57E,KAAK+4E,SACb,KAAKE,GAAqCqB,gBACzC,OAAO,IAAIQ,GAAkD96E,MAC9D,KAAKi5E,GAAqCuB,eACzC,OAAO,IAAIiB,GAAiDz7E,MAC7D,KAAKi5E,GAAqCmB,cACzC,OAAO,IAAIgB,GAAgDp7E,MAC5D,KAAKi5E,GAAqCoB,gBACzC,OAAO,IAAIa,GAAkDl7E,MAC9D,KAAKi5E,GAAqCsB,eACzC,OAAO,IAAImB,GAAiD17E,MAC7D,KAAKi5E,GAAqCkB,cACzC,OAAO,IAAIqB,GAAgDx7E,QAI7D47E,sBAAA,SAAW7uB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAKryB,KAAK0tE,WAChCgM,EAAW3sB,EAAQ16B,IAAKryB,KAAKu+C,QACnC,OAAOwO,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWpvE,KAAK+4E,YAAW/4E,KAAK46E,YAAW56E,KAAK66E,YAAWnB,QAI3FkC,cAAP,SACChqB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClEgQ,EAASixB,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACrE,OAAO,IAAIqtC,EACVhqB,EAAY,GAAK8b,EACjB9b,EAAY,GAAKA,EAAY,GAAKrT,OA5D5By6B,IC7BHb,GAAgB,WAAc,OAAA,kBAOnC,WAAavhD,EAAyC63B,GAAtD,MACCzoD,YAAO4wB,EAAO63B,gBACdtoD,EAAKy0E,QAAUhkD,EAAMgkD,QACrBz0E,EAAK00E,QAAUjkD,EAAMikD,QACrB10E,EAAKo4C,OAASp4C,EAAKwnE,aAAc,IAAI/2C,EAAM2nB,6BAA6B45B,GAAe,OAyBzF,OAlCwDr4E,OAY7C+7E,2BAAV,SACC1tB,EAAekI,EACfylB,EAAqBC,EACrBnB,EAAiBC,GAEjB,IAAMQ,EAAkE,IAAhDhlB,EAAQ3H,QAAUrB,GAAmBgD,OACvDirB,EAAoE,IAAjDjlB,EAAQ3H,QAAUrB,GAAmB+C,QACxDhxC,IAAO,GAAMw7D,IAAYS,EAAeltB,EAAMhiD,KAAK7G,EAAI+wD,EAAQlqD,KAAK7G,GACpEga,IAAO,GAAMu7D,IAAYS,EAAgBntB,EAAMhiD,KAAK5G,EAAI8wD,EAAQlqD,KAAK5G,GACrEwU,EAAI9N,KAAKkmD,IAAK2pB,GAAgB7vE,KAAKkmD,IAAK4pB,GACxCh0E,EAAIkE,KAAKimD,IAAK4pB,GAAgB7vE,KAAKimD,IAAK6pB,GACxCl/D,EAAWsxC,EAAMtsC,UAAUhF,SAC3B27D,EAA2E,IAArDniB,EAAQ3H,QAAUrB,GAAmBwC,YAC3D4oB,EAA2E,IAArDpiB,EAAQ3H,QAAUrB,GAAmByC,YAC3D4oB,EAAiBF,EAAmB37D,EAASvX,EAAI+wD,EAAQ/wD,EACzDqzE,EAAiBF,EAAmB57D,EAAStX,EAAI8wD,EAAQ9wD,EAC/D8wD,EAAQ3H,SAAWrB,GAAmBvxC,SACtCe,EAASrX,IACRkzE,EAAet5D,EAAKrX,EAAIuX,EAAKvF,EAC7B4+D,EAAev5D,EAAKrF,EAAIuF,EAAKvX,OA/BwBmmE,mBCFvD,WAAat3C,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBiD,uBACjCnqD,EAAKsoD,OAASpB,GAAmBvxC,WAkBnC,OArBgEhc,OAM/Dk8E,oBAAA,SAAS7tB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GAC7B1xB,EAAYssC,EAAMtsC,UAElBi6D,EADwE,IAAnDzlB,EAAQ3H,QAAUrB,GAAmBiD,UACzBzuC,EAAUusC,SAAWiI,EAAQjI,SACpEvsC,EAAUusC,SAAW7P,EACrB8X,EAAQ3H,SAAWrB,GAAmBiD,SACtCtwD,KAAKi7E,eACJ9sB,EAAOkI,EACPylB,EAAav9B,EACbv+C,KAAK46E,QAAS56E,KAAK66E,cAjByCgB,mBCC/D,WAAajlD,GAAb,MACC5wB,YAAO4wB,EAAOy2B,GAAmBiD,uBACjCnqD,EAAKsoD,OAASpB,GAAmBvxC,WAkBnC,OArBgEhc,OAM/Dm8E,oBAAA,SAAS9tB,EAAekI,EAAwB9iB,GAC/C,GAAOvzC,KAAK0tE,UAAWvf,EAAO5a,GAAS,CACtC,IAAMgL,EAASv+C,KAAKu+C,OAAQ4P,EAAO5a,GAC7B1xB,EAAYssC,EAAMtsC,UAElBi6D,EADwE,IAAnDzlB,EAAQ3H,QAAUrB,GAAmBiD,UACzBzuC,EAAUusC,SAAWiI,EAAQjI,SACpEvsC,EAAUusC,SAAW0tB,EAAcv9B,EACnC8X,EAAQ3H,SAAWrB,GAAmBiD,SACtCtwD,KAAKi7E,eACJ9sB,EAAOkI,EACPylB,EAAaj6D,EAAUusC,SACvBpuD,KAAK46E,QAAS56E,KAAK66E,cAjByCgB,KVLhE,SAAY7B,GACXA,2BACAA,2BAFD,CAAYA,KAAAA,QWkBZ,IClBYkC,kBDwBX,WACCnD,EAA+CrL,EAC/CkN,EAAiBC,EAAiBt8B,GAFnC,MAICv4C,YAAOipE,GAAsBxY,UAAWiX,EAAWmK,GAA+BsE,OAAQpD,gBAC1F5yE,EAAKy0E,QAAUA,EACfz0E,EAAK00E,QAAUA,EACf10E,EAAKo4C,OAASA,IAyChB,OArDSz+C,OAeRs8E,qBAAA,SAAUxlD,GACT,OACC5wB,YAAM4nD,mBAAUh3B,IACfA,aAAiBwlD,GAClBp8E,KAAK46E,UAAYhkD,EAAMgkD,SACvB56E,KAAK66E,UAAYjkD,EAAMikD,SACvB76E,KAAKu+C,SAAW3nB,EAAM2nB,QAIxB69B,sBAAA,WACC,OAAQp8E,KAAK+4E,SACb,KAAKiB,GAAqCqC,SACzC,OAAO,IAAIL,GAA4Ch8E,MACxD,KAAKg6E,GAAqCsC,SACzC,OAAO,IAAIL,GAA4Cj8E,QAIzDo8E,sBAAA,SAAWrvB,GACV,IAAM+iB,EAAc/iB,EAAQ16B,IAAKryB,KAAK0tE,WAChCgM,EAAW3sB,EAAQ16B,IAAKryB,KAAKu+C,QACnC,OAAOwO,EAAQ16B,IACd,IAAIryB,KAAK2a,SAAQm1D,MAAe9vE,KAAKovE,YAAWpvE,KAAK+4E,YAAW/4E,KAAK46E,YAAW56E,KAAK66E,YAAWnB,QAI3F0C,cAAP,SACCxqB,EACA7E,GAEA,IAAM2gB,EAAY8B,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WAClEgQ,EAASixB,GAAmBO,WAAY,EAAGne,EAAY7E,EAAQxe,WACrE,OAAO,IAAI6tC,EACVxqB,EAAY,GAAK8b,EACjB9b,EAAY,GAAKA,EAAY,GAAKrT,OAlD5By6B,kBE0BT,cAyEA,OAxEQuD,eAAP,SAAqBtvB,GACpB,IACC,IAAMC,EAASvtB,KAAKwtB,MAAOF,GAC3B,GAAIzP,GAAa0P,GAAW,CAC3B,IAAK,IAAIt5C,EAAI,EAAGG,EAAOm5C,EAAOv6C,OAAQiB,EAAIG,IAAQH,EACjD,IAAM5Q,EAAckqD,EAAQt5C,IAC3B,OAAO,KAGT,GAAI,GAAKs5C,EAAOv6C,OACf,OAAOu6C,EAGT,OAAO,KACN,MAAOj3C,GACR,OAAO,OAIFsmE,cAAP,SAAoB1rD,EAAYk8B,GAC/B,IACMwF,EADUxF,EAAQsB,QACDrhD,IAAK6jB,GAC5B,GAAc,MAAV0hC,EACH,OAAOA,EAGR,IACMtF,EADYF,EAAQxe,UACE1d,GAC5B,GAAgB,MAAZo8B,EAAmB,CACtB,IAAM2E,EAAa5xD,KAAKw8E,aAAcvvB,GACtC,GAAkB,MAAd2E,EACH,OAAQA,EAAY,IACpB,KAAKqd,GAAsBgJ,UAC1B,OAAOC,GAA0Bzd,YAAa7I,EAAY7E,GAC3D,KAAKkiB,GAAsBQ,MAC1B,OAAOC,GAAuBjV,YAAa7I,EAAY7E,GACxD,KAAKkiB,GAAsB+B,aAC1B,OAAQpf,EAAY,IACnB,KAAK2d,GAAmCkN,gBACxC,KAAKlN,GAAmCpB,MACxC,KAAKoB,GAAmCW,MACvC,OAAOe,GAA6BxW,YAAa7I,EAAY7E,GAC9D,KAAKwiB,GAAmCuD,KACvC,OAAOD,GAAiCpY,YAAa7I,EAAY7E,GAClE,KAAKwiB,GAAmC2C,WACvC,OAAOD,GAAuCxX,YAAa7I,EAAY7E,GAE1E,KAAKkiB,GAAsB2E,YAC1B,OAAOC,GAA4BpZ,YAAa7I,EAAY7E,GAC7D,KAAKkiB,GAAsBkE,cAC1B,OAAOC,GAA8B3Y,YAAa7I,EAAY7E,GAC/D,KAAKkiB,GAAsBgF,WAC1B,OAAOC,GAA2BzZ,YAAa7I,EAAY7E,GAC5D,KAAKkiB,GAAsBqI,KAC1B,OAAOC,GAAsB9c,YAAa7I,EAAY7E,GACvD,KAAKkiB,GAAsBxY,UAC1B,OAAQ7E,EAAY,IACpB,KAAKimB,GAA+BqB,KACnC,OAAOC,GAA+B1e,YAAa7I,EAAY7E,GAChE,KAAK8qB,GAA+B8D,OACnC,OAAOC,GAAiCnhB,YAAa7I,EAAY7E,GAClE,KAAK8qB,GAA+BsE,OACnC,OAAOC,GAAiC3hB,YAAa7I,EAAY7E,GAElE,MACD,KAAKkiB,GAAsB2H,KAC1B,OAAOC,GAAsBpc,YAAa7I,EAAY7E,IAIzD,OAAO,IAAImrB,GAA2Bb,GAA8BU,KAAM,wBCxH5E,cA4BA,OAzBQ2E,iBAAP,SAAuBC,GACtB,IAAMC,EAAgBF,EAAoBE,cACpCC,EAAqBD,EAAeD,GAC1C,GAA0B,MAAtBE,EACH,OAAIA,aAA8BC,iBAC1B/tC,QAAQC,QAAS6tC,GAEjBA,EAGR,IAAMt8E,EAAS,IAAIwuC,SAA0B,SAAEC,EAAS+tC,GACvD,IAAMC,EAAeplE,SAAS0Z,cAAe,OAC7C0rD,EAAa5tC,OAAS,WACrBwtC,EAAeD,GAAYK,EAC3BhuC,EAASguC,IAEVA,EAAaxgC,QAAUwgC,EAAa/tC,QAAU,WAC7C8tC,KAEDC,EAAa18C,IAAMq8C,KAGpB,OADAC,EAAeD,GAAYp8E,EACpBA,GAxBFm8E,gBAA+F,WCuBtG,SAAanuC,GACZvuC,KAAKuuC,UAAYA,EACjBvuC,KAAKquD,QAAU,IAAI9gD,IACnBvN,KAAKs3D,MAAQ,IAAI/pD,IACjBvN,KAAK23D,QAAU,IAAIpqD,IACnBvN,KAAK+6D,KAAO,IAAIxtD,IAChBvN,KAAKw6D,UAAY,IAAIjtD,IACrBvN,KAAK64D,OAAS,IAAItrD,IAClBvN,KAAKo7D,OAAS,IAAI7tD,IAClBvN,KAAKs7D,QAAU,IAAI/tD,IACnBvN,KAAKq8D,MAAQ,IAAI9uD,IACjBvN,KAAKw7D,aAAe,IAAIjuD,IACxBvN,KAAKi9E,WAAa,IAAI1vE,mBCtBxB,cA6HA,OA5HQ2vE,UAAP,SACC17D,EAA8BurC,GAE9B,IAAMowB,EAAoBjzB,GAAqB1oC,EAAM,IACrD,OAAyB,MAArB27D,EACIA,EAAmB37D,EAAMurC,GAE1B,MAGDmwB,cAAP,SACC17D,EAA8BurC,EAA+CxsD,GAE7EA,EAAOswB,GAAKk8B,EAAQxe,UAAW/sB,EAAM,KAAS,GAC9CjhB,EAAOshB,UAAUhF,SAASrX,IAAKgc,EAAM,GAAKA,EAAM,IAChDjhB,EAAOshB,UAAUusC,SAAW5sC,EAAM,GAClCjhB,EAAOshB,UAAUO,KAAK5c,IAAKgc,EAAM,GAAKA,EAAM,IAC5CjhB,EAAOshB,UAAUgyC,MAAMruD,IAAKgc,EAAM,IAAMA,EAAM,KAC9CjhB,EAAO4L,KAAK3G,IAAKm0E,GAAYI,aAAcv4D,EAAM,IAAOm4D,GAAYI,aAAcv4D,EAAM,KACxFjhB,EAAO0vB,KAAKwqC,YAAaj5C,EAAM,GAAKurC,GACpCxsD,EAAOguD,OAAOkM,YAAaj5C,EAAM,GAAKurC,GACtCxsD,EAAOiuD,OAASzB,EAAQxe,UAAW/sB,EAAM,MAAU,GACnDjhB,EAAOosB,KAAK8tC,YAAaj5C,EAAM,IAAMurC,GACrCxsD,EAAO+uD,IAAImL,YAAaj5C,EAAM,IAAMurC,GACpCxsD,EAAO4C,OAASqe,EAAM,IACtBjhB,EAAO0C,OAASue,EAAM,IACtBjhB,EAAO4jB,eAAgC,EAAb3C,EAAM,KAChCjhB,EAAO2zD,eAAgC,EAAb1yC,EAAM,KAChCjhB,EAAOyW,SAAa,GAAKwK,EAAM,IAAOurC,EAAQxe,UAAW/sB,EAAM,UAAS9f,EACxEnB,EAAOmkB,MAAU,GAAKlD,EAAM,IAAOurC,EAAQxe,UAAW/sB,EAAM,UAAS9f,EAGrE,IAAI07E,EAAyC,KACvCzpB,EAAqBnyC,EAAM,IACjC,GAAI,EAAImyC,EAAmBhhD,OAAS,CAEnC,IADA,IAAM0qE,EAAqB,GAClBzpE,EAAI,EAAGG,EAAO4/C,EAAmBhhD,OAAQiB,EAAIG,IAAQH,EAAI,CACjE,IAAM0pE,EAAkB3pB,EAAoB//C,GACtC2pE,EAAiBL,EAAmBM,QAASF,EAAiBvwB,GAC9C,MAAlBwwB,GACHF,EAAmBzqE,KAAM2qE,GAG3BH,EAAkBruC,QAAQrB,IAAK2vC,GAAqBhqE,MAAK,SAAEoC,GAC1DlV,EAAOkV,SAAWA,EAClB,IAAK,IAAI7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAImB,OAASxU,EAIxB,OAFAA,EAAO6yD,yBACP7yD,EAAOgjB,UACAhjB,KAKT,IAAMk9E,EAAoBj8D,EAAM,IAChC,IAAS5N,EAAI,EAAGG,EAAO0pE,EAAkB9qE,OAAQiB,EAAIG,IAAQH,EAC5DrT,EAAOgyD,OAAOlgC,IAAKkqD,GAA8B9hB,YAAagjB,EAAmB7pE,GAAKm5C,IAIvF,IAAM2wB,EAAal8D,EAAM,IACzB,GAAI,GAAKk8D,GAAcA,EAAa3wB,EAAQxe,UAAU57B,OAAS,CAC9D,IAAM8+C,EAAW1E,EAAQxe,UAAWmvC,GAChC37E,EAAc0vD,KACjBlxD,EAAOkxD,SAAWD,GAAgBmsB,oBAAqBlsB,IAKzD,IAAImsB,EAAsC,KACpCC,EAAUr8D,EAAM,IACtB,GAAI,GAAKq8D,GAAWA,EAAU9wB,EAAQxe,UAAU57B,OAAS,CACxD,IAAM8qD,EAAW1Q,EAAQxe,UAAWsvC,GAChC97E,EAAc07D,KACjBmgB,EAAelB,GAAoBoB,eAAgBrgB,GAAWpqD,MAAK,SAAE2pE,GAEpE,OADAz8E,EAAOw5B,MAAQijD,EACRz8E,MAMV,OAAuB,MAAnB68E,EACiB,MAAhBQ,EACI7uC,QAAQrB,IAAI,CAAE0vC,EAAiBQ,IAAgBvqE,MAAK,WAC1D,OAAO9S,KAGD68E,EAGY,MAAhBQ,EACIA,EAEAr9E,GAKH28E,iBAAP,SAAuBa,EAAuCxvC,GAG7D,IAFA,IAAMwe,EAAU,IAAIixB,GAAsCzvC,GACpD0vC,EAA0C,GACvCrqE,EAAI,EAAGG,EAAOgqE,EAAYprE,OAAQiB,EAAIG,IAAQH,EAAI,CAC1D,IAAMg+C,EAAamsB,EAAanqE,GAC1Bu6C,EAAQ+uB,EAAmBM,QAAS5rB,EAAY7E,GACtD,GAAa,MAAToB,EAQH,OAPI,EAAI8vB,EAAOtrE,QACdo8B,QAAQrB,IAAKuwC,GAAS5qE,MAAM,SAAE6uC,GAC7B,IAAK,IAAI1nC,EAAI,EAAGC,EAAOynC,EAASvvC,OAAQ6H,EAAIC,IAAQD,EACnD0nC,EAAU1nC,GAAI3G,aAIV,KAGRoqE,EAAOrrE,KAAMu7C,GAEd,OAAI,EAAI8vB,EAAOtrE,OACPo8B,QAAQrB,IAAKuwC,GAEd,yBC9HT,cASA,OARQC,cAAP,SACC18D,EAA8BurC,GAE9B,IAAMoB,EAAQ,IAAI6Q,GAAW3U,GAAkB5+C,MAAO,GAAI,EAAG0+C,GAAkBlmC,MACzE1jB,EAAS28E,GAAmBziB,YAAaj5C,EAAMurC,EAASoB,GAE9D,OADAA,EAAMuD,OAAO+I,YAAaj5C,EAAM,IAAMurC,GAC/BxsD,QCRI49E,GAAe,WAC3B/zB,GAAiBrG,GAAWgb,KAAQ8N,GAAmB1sE,OACvD+pD,GAAqBnG,GAAWgb,KAAQmf,GAAWzjB,4BCJpD,4DAgQA,OAhQ0C36D,OACzCs+E,iBAAA,SAAMjwB,GACLnoD,YAAMggB,eAAMmoC,GACZ,IAAM8Q,EAASj/D,KAAKi/D,OACdC,EAAUl/D,KAAKu/D,aACfJ,EAAUn/D,KAAKy/D,YAGrBR,EAAOgM,eAAetqE,SACtB,IAAM2hE,EAAYrD,EAAOqD,UACnBiJ,EAAe,EAAVrM,EACXoD,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAEvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAEvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAEvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAEvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAEvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAGvBtM,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QACjBD,EAAe,EAAVu3D,EAqCX,OApCAt3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAG/Bl/D,KAAKwrE,WAELxrE,KAAKW,OAAQwtD,GACNnuD,MAGRo+E,mBAAA,SAAQjwB,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACpBj/D,KAAKq+E,kBAAmBpf,EAAQ9Q,GAChCnuD,KAAKgsE,YAAa/M,EAAQ9Q,GAC1BnuD,KAAKs+E,gBAAiBrf,EAAQ9Q,GAC9BnuD,KAAKu+E,cAAetf,EAAQ9Q,GAC5BnuD,KAAK05B,WAAYulC,EAAQ9Q,IAGhBiwB,8BAAV,SAA6Bnf,EAAsB9Q,GAClD,IAAMhiD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACb+5D,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5Csd,EAAkB1f,IAAU/rD,KAAK+rD,OAASC,IAAUhsD,KAAKgsD,MACzD4f,EAAuB5rE,KAAKs/D,mBAAqBA,EACjD/Q,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MACrBk8E,EAAoBx+E,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,EACnF,GAAI2rC,GAAiBG,GAAsB4S,EAAkB,CAC5Dx+E,KAAK+rD,MAAQA,EACb/rD,KAAKgsD,MAAQA,EACbhsD,KAAKs/D,iBAAmBA,EAGxBt/D,KAAK8/B,YAAcp5B,IAGnB1G,KAAK8jE,sBAAwBp9D,IAE7Bu4D,EAAOnyC,aAAansB,SAWpB,IAAMoZ,EAAIqmD,EAActgC,EAClBq0B,EAAa,GAARpI,GAAe,GAAKA,GAAShyC,GAAKA,GACvCq6C,EAAa,GAARpI,GAAe,GAAKA,GAASjyC,GAAKA,GACvCy2C,EAAoBrC,EAAMtsC,UAAU2uC,kBACpCxkC,EAAOhsB,KAAKi/D,OAAOjzC,KACzBA,EAAKxmB,KAAM2uD,GAAKC,GAChB5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMxkB,EAAKwkB,EAAK1mB,EACVoC,EAAKskB,EAAKzmB,EAChBymB,EAAKxmB,IAAK,GAAI4uD,GACd5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMvkB,EAAKukB,EAAK1mB,EACVqC,EAAKqkB,EAAKzmB,EACV6Z,EAAK3X,EAAKD,EACV8X,EAAK3X,EAAKD,EACV+2E,EAAKjuB,EAAkBkE,GACvBgqB,EAAKluB,EAAkBmE,GACvBgqB,EAAKF,GAAMA,EAAKh3E,GAChBm3E,EAAKF,GAAMA,EAAK/2E,GAChBmB,EAAK21E,EAAKr/D,EACVpW,EAAK01E,EAAKp/D,EAGhBtf,KAAK+/D,eAAiB//D,KAAKsmE,WAAY9+D,EAAIE,EAAID,EAAIE,GACnD3H,KAAKggE,eAAiBhgE,KAAKsmE,WAAY9+D,EAAIE,EAAIoB,EAAIE,GAGnD,IAAMk2D,EAAUl/D,KAAKu/D,aACf32D,EAAWq2D,EAAOr2D,SAClBtB,EAAe,EAAV43D,EACXt2D,EAAUtB,EAAM,GAAME,EACtBoB,EAAUtB,EAAM,GAAMI,EACtBkB,EAAUtB,EAAM,GAAMG,EACtBmB,EAAUtB,EAAM,GAAMK,EACtBiB,EAAUtB,EAAM,GAAMG,EAAK2X,EAC3BxW,EAAUtB,EAAM,GAAMK,EAAK2X,EAE3B1W,EAAUtB,EAAM,GAAMwB,EACtBF,EAAUtB,EAAM,GAAM0B,EACtBJ,EAAUtB,EAAM,GAAMm3E,EACtB71E,EAAUtB,EAAM,GAAMo3E,EACtB91E,EAAUtB,EAAK,IAAOm3E,EAAKr/D,EAC3BxW,EAAUtB,EAAK,IAAOo3E,EAAKp/D,EAE3B1W,EAAUtB,EAAK,IAAOq3E,EAAKv/D,EAC3BxW,EAAUtB,EAAK,IAAOs3E,EAAKt/D,EAC3B1W,EAAUtB,EAAK,IAAOq3E,EACtB/1E,EAAUtB,EAAK,IAAOs3E,EACtBh2E,EAAUtB,EAAK,IAAOq3E,EAAKv/D,EAC3BxW,EAAUtB,EAAK,IAAOs3E,EAAKt/D,IAInB8+D,4BAAV,SAA2Bnf,EAAsB9Q,GAChD,IAAMI,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MAC3B,GAAItC,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,EAAc,CAC1E9/B,KAAK8/B,YAAcA,EACnB9/B,KAAKogE,YAAcA,EACnBnB,EAAO0L,WAAWhqE,SAClBs+D,EAAO2L,gBAAgBjqE,SAEvB,IAAMqrB,EAAOizC,EAAO4f,SACpB7+E,KAAK8+E,SAAU9+E,KAAK+/D,eAAgBjgC,EAAa9T,GACjD,IAAM81C,EAAM91C,EAAM,GACZg2C,EAAMh2C,EAAM,GACZk2C,EAAMl2C,EAAM,GAElBhsB,KAAK8+E,SAAU9+E,KAAKggE,eAAgBlgC,EAAa9T,GACjD,IAAM+1C,EAAM/1C,EAAM,GACZi2C,EAAMj2C,EAAM,GACZm2C,EAAMn2C,EAAM,GAEZkzC,EAAUl/D,KAAKu/D,aACfH,EAASp/D,KAAKw/D,YAAcx/D,KAAKokE,gBACvCpkE,KAAK++E,WAAY9f,EAAQC,EAASE,EAAQ0C,EAAKC,EAAKC,EAAKC,EAAKC,EAAKC,KAI3Dic,0BAAV,SAAyBnf,EAAsB9Q,GAC9C,IAAMvoD,EAAU5F,KAAK46C,UAAWuT,GAC1BmS,EAAqBtgE,KAAK2lE,qBAAsB//D,GACtD,GAAIA,IAAY5F,KAAK4F,SAAW06D,IAAuBtgE,KAAKsgE,mBAAqB,CAChFtgE,KAAK4F,QAAUA,EACf5F,KAAKsgE,mBAAqBA,EAE1B,IAAMr3D,EAAajJ,KAAKunE,aAAc3hE,GAChC4B,EAAKyB,EAAWzB,GAChBC,EAAKwB,EAAWxB,GAChBoB,EAAKI,EAAWJ,GAChBC,EAAKG,EAAWH,GAChBpB,EAAKuB,EAAWvB,GAChBC,EAAKsB,EAAWtB,GAChBoB,EAAKE,EAAWF,GAChBC,EAAKC,EAAWD,GAGtBi2D,EAAOlyC,SAASpsB,SAChB,IAAMmH,EAAMm3D,EAAOn3D,IAEb8kE,EAAgB,EADN5sE,KAAKu/D,aAErBz3D,EAAK8kE,EAAO,GAAMplE,EAClBM,EAAK8kE,EAAO,GAAMllE,EAClBI,EAAK8kE,EAAO,GAAM,IAAQplE,EAAKC,GAC/BK,EAAK8kE,EAAO,GAAM,IAAQllE,EAAKC,GAC/BG,EAAK8kE,EAAO,GAAMnlE,EAClBK,EAAK8kE,EAAO,GAAMjlE,EAElBG,EAAK8kE,EAAO,GAAM,IAAQplE,EAAKsB,GAC/BhB,EAAK8kE,EAAO,GAAM,IAAQllE,EAAKsB,GAC/BlB,EAAK8kE,EAAO,GAAM,IAAQplE,EAAKqB,GAC/Bf,EAAK8kE,EAAO,GAAM,IAAQllE,EAAKqB,GAC/BjB,EAAK8kE,EAAM,IAAO,IAAQnlE,EAAKoB,GAC/Bf,EAAK8kE,EAAM,IAAO,IAAQjlE,EAAKoB,GAE/BjB,EAAK8kE,EAAM,IAAO9jE,EAClBhB,EAAK8kE,EAAM,IAAO5jE,EAClBlB,EAAK8kE,EAAM,IAAO,IAAQ9jE,EAAKD,GAC/Bf,EAAK8kE,EAAM,IAAO,IAAQ5jE,EAAKD,GAC/BjB,EAAK8kE,EAAM,IAAO/jE,EAClBf,EAAK8kE,EAAM,IAAO7jE,OA7PqBu7D,kBCC1C,cAiBA,OAhBQ0a,SAAP,SACC/f,EAAsB9Q,EACtB+Q,EAAiBC,GAEjB,IAAM2N,EAASlK,GAAoB2B,aAAcpW,EAAO8Q,EAAOuF,WACzD3B,EAAUiK,EAAOtN,YACjBsD,EAAUgK,EAAOpN,WACjBN,EAAS,EAAIyD,EACbxD,EAAS,EAAIyD,EACnB,OAAI5D,EAAUE,EAASH,EAAO8N,gBAAkB5N,EAAUE,EAASJ,EAAO+N,cAClE,IAAIoR,GACVnf,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,GACnDr5C,KAAMmoC,GAEF,0BChBR,WAAaxzC,uBAAAA,EAAOopC,GAAWk7B,QAC9Bj5E,YAAO2U,SAwCT,OA1CkC7a,OAKjCo/E,kBAAA,WACC,OAAO,IAAIA,GAAej9B,KAAMjiD,OAGjCk/E,wBAAA,SAAa55E,EAAWC,EAAW0vD,EAAYC,GAC9C,GAAIlvD,YAAMgvD,0BAAiB1vD,EAAGC,EAAG0vD,EAAIC,GAAO,CAC3C,IAAMjlC,EAAOjwB,KAAKiwB,KACZs+B,EAASvuD,KAAKuuD,OACpB,GAAIt+B,EAAKinC,QAKR,IAJMruD,EAAKvD,EAAIA,IAGT65E,EAAMjqB,EAAKA,IAFXnsD,EAAKxD,EAAIA,IACT65E,EAAMnqB,EAAKA,IAEUmqB,EAAMD,EAChC,OAAO,MAEF,CACN,IAAMr/C,EAAcyuB,EAAOnsD,MAC3B,GAAImsD,EAAO2I,QAAU,EAAIp3B,EAAc,CACtC,IAOOs/C,EACAD,EARDt2E,EAAKvD,EAAIA,EACTyD,EAAKxD,EAAIA,EACT85E,EAAKpzE,KAAKC,IAAK,EAAK+oD,EAAKn1B,GACzBw/C,EAAKrzE,KAAKC,IAAK,EAAKgpD,EAAKp1B,GACzBy/C,EAAMF,EAAKA,EACXG,EAAMF,EAAKA,EACjB,GAAIC,EAAMC,GAAO32E,EAAK22E,EAAMz2E,EAAKw2E,GAG5B12E,GADEs2E,EAAMjqB,EAAKA,GACFnsD,GAFTq2E,EAAMnqB,EAAKA,IAEUmqB,EAAMD,EAChC,OAAO,IAMZ,OAAO,MAxCyBziB,kBCElC,cAUA,OATQ+iB,cAAP,SACCj+D,EAA8BurC,GAE9B,OAAOmwB,GAAmBziB,YAAaj5C,EAAMurC,EAAS0yB,EAAct/E,WAG9Ds/E,SAAP,WACC,OAAO,IAAIP,SCPAQ,GAAkB,WAC9Bt1B,GAAiBrG,GAAWk7B,QAAWD,GAAsB7+E,OAC7D+pD,GAAqBnG,GAAWk7B,QAAWQ,GAAchlB,4BCFzD,WAAawE,EAAsBC,EAAiBC,UACnDn5D,YAAOi5D,EAAQC,EAASC,EAAS,EAAG,SAYtC,OAdyCr/D,OAKxC6/E,iBAAA,SAAMxxB,GAGL,OAFAnoD,YAAMggB,eAAMmoC,GACZnuD,KAAK4F,QAAUuoD,EAAMvoD,SAAWgH,UAAQ6zD,MACjCzgE,MAGR2/E,mBAAA,SAAQxxB,QAXgCoS,kBCDzC,cAMA,OALQqf,SAAP,SACC3gB,EAAsB9Q,EAAe+Q,EAAiBC,GAEtD,OAAO,IAAIwgB,GAAqB1gB,EAAQC,EAASC,GAAUn5C,KAAMmoC,uBCAlE,WAAap5C,GACZ/U,KAAKsrD,GAAUv2C,EAqFjB,OAlFCvV,sBAAIqgF,0BAAJ,WACC,IAAMpqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,QAAI,EAAIA,EAAS9C,SACT8C,EAAUA,EAAS9C,OAAS,GAAIsd,KAAKinC,YAK9C,SAAYA,GAEX,IADA,IAAMzhD,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIqc,KAAKinC,OAASA,mCAI9B13D,sBAAIqgF,yBAAJ,WACC,IAAMpqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIsd,KAAK5uB,MAEtC,cAGR,SAAWA,GAEV,IADA,IAAMoU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIqc,KAAK5uB,MAAQA,mCAI7B7B,sBAAIqgF,yBAAJ,WACC,IAAMpqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIsd,KAAK1uB,MAEtC,OAGR,SAAWA,GAEV,IADA,IAAMkU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIqc,KAAK1uB,MAAQA,mCAI7Bs+E,iBAAA,SAAMh/E,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIqc,KAAKgyB,KAAMphD,IAI3Bg/E,gBAAA,SAAK3oB,EAAiB71D,EAAeE,GAEpC,IADA,IAAMkU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIqc,KAAKzqB,IAAK0xD,EAAQ71D,EAAOE,IAIzCs+E,kBAAA,WACC,OAAO,IAAIA,EAAuB7/E,KAAKsrD,KAGxCu0B,qBAAA,WACC,IAAMpqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIsd,KAAKq+B,WAEtC,CACN4I,QAAQ,EACR71D,MAAO,SACPE,MAAO,IAITs+E,sBAAA,SAAW9yB,GACV,OAAQ,GAGT8yB,wBAAA,SAAah/E,EAAgBksD,wBClF7B,WAAah4C,GACZ/U,KAAKsrD,GAAUv2C,EAuIjB,OApICvV,sBAAIsgF,0BAAJ,WACC,IAAMrqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,GAAI,EAAIA,EAAS9C,OAAS,CACzB,IAAM++C,EAASj8C,EAAUA,EAAS9C,OAAS,GAAI++C,OAC/C,GAAc,MAAVA,EACH,OAAOA,EAAO/+C,OAGhB,OAAO,mCAGRnT,sBAAIsgF,sBAAJ,WACC,IAAMrqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,GAAI,EAAIA,EAAS9C,OAAS,CACzB,IAAM++C,EAASj8C,EAAUA,EAAS9C,OAAS,GAAI++C,OAC/C,GAAc,MAAVA,EACH,OAAOA,EAAO7gC,GAGhB,OAAO,mCAGRrxB,sBAAIsgF,0BAAJ,WACC,IAAMrqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,GAAI,EAAIA,EAAS9C,OAAS,CACzB,IAAM++C,EAASj8C,EAAUA,EAAS9C,OAAS,GAAI++C,OAC/C,GAAc,MAAVA,EACH,OAAOA,EAAOnF,OAGhB,MAAO,QAGR,SAAYA,GAEX,IADA,IAAM92C,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM89C,EAASj8C,EAAU7B,GAAI89C,OACf,MAAVA,IACHA,EAAOnF,OAASA,qCAKnB/sD,sBAAIsgF,4BAAJ,WACC,IAAMrqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,GAAI,EAAIA,EAAS9C,OAAS,CACzB,IAAM++C,EAASj8C,EAAUA,EAAS9C,OAAS,GAAI++C,OAC/C,GAAc,MAAVA,EACH,OAAOA,EAAOlF,SAGhB,MAAO,QAGR,SAAcA,GAEb,IADA,IAAM/2C,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM89C,EAASj8C,EAAU7B,GAAI89C,OACf,MAAVA,IACHA,EAAOlF,SAAWA,qCAKrBhtD,sBAAIsgF,yBAAJ,WACC,IAAMrqE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,GAAI,EAAIA,EAAS9C,OAAS,CACzB,IAAM++C,EAASj8C,EAAUA,EAAS9C,OAAS,GAAI++C,OAC/C,GAAc,MAAVA,EACH,OAAOA,EAAOl8B,MAGhB,OAAO20B,GAAkBlmC,UAG1B,SAAWuR,GAEV,IADA,IAAM/f,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM89C,EAASj8C,EAAU7B,GAAI89C,OACf,MAAVA,IACHA,EAAOl8B,MAAQA,qCAKlBsqD,iBAAA,SAAMzuE,GAEL,IADA,IAAMoE,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM89C,EAASj8C,EAAU7B,GAAI89C,OACf,MAAVA,GACHA,EAAOzP,KAAM5wC,GAGf,OAAOrR,MAGR8/E,gBAAA,SAAKvzB,EAAmBC,EAAqBh3B,GAE5C,IADA,IAAM/f,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM89C,EAASj8C,EAAU7B,GAAI89C,OACf,MAAVA,GACHA,EAAOlsD,IAAK+mD,EAAQC,EAAUh3B,GAGhC,OAAOx1B,MAGR8/E,kBAAA,SAAO/qE,GACN,OAAO,IAAI+qE,EAAmB/qE,IAG/B+qE,qBAAA,SAAUj+D,GAET,IADA,IAAMpM,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM89C,EAASj8C,EAAU7B,GAAI89C,OAC7B,GAAc,MAAVA,EACH,OAAOA,EAAOquB,SAAUl+D,GAG1B,MAAO,IAGRi+D,sBAAA,SAAW/yB,GAEV,IADA,IAAMt3C,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAM89C,EAASj8C,EAAU7B,GAAI89C,OAC7B,GAAc,MAAVA,EACH,OAAOA,EAAO1D,UAAWjB,GAG3B,OAAQ,WCtIT,WACC/sD,KAAKu7B,eAAiB,IAAIkd,SAC1Bz4C,KAAKwwD,kBAAoB,IAAI/X,SAC7Bz4C,KAAKggF,+BAAiC,IAAIvnC,SAC1Cz4C,KAAKouD,SAAW,EAChBpuD,KAAKmM,KAAO,IAAIqgB,uBCRlB,cA4FA,OA3FQyzD,UAAP,SAAgB9xB,GACf,IAAM+xB,EAAS/xB,EAAM+xB,OAAU/xB,EAAM+xB,QAAU,IAAIC,GAGnDhyB,EAAMziC,kBACN,IAAM3W,EAASo5C,EAAMp5C,OACjBA,aAAkBk+C,GACrBl+C,EAAO8M,UAAU2uC,kBAAkBc,OAAO4uB,EAAOF,gCAAgCI,SAEjFF,EAAOF,+BAA+BK,WAEvClyB,EAAMtsC,UAAU2uC,kBAAkBc,OAAO4uB,EAAO1vB,mBAGhD0vB,EAAO9xB,SAAWD,EAAMtsC,UAAUusC,SAGlC8xB,EAAO/zE,KAAK1G,SAAU0oD,EAAMhiD,MAG5BgiD,EAAMmyB,6BAGAL,WAAP,SAAiB9xB,GAChBA,EAAMoyB,wBAAwB,IAGxBN,QAAP,SAAc9xB,EAAetsC,EAAmB2+D,GAC/C,IAAMN,EAAS/xB,EAAM+xB,OACrB,GAAc,MAAVA,EAAiB,CACpB,IAAMO,EAAoBP,EAAO3kD,eAGjC,GAFA2kD,EAAOF,+BAA+B1uB,OAAOmvB,GAC3CC,OAAO7+D,GAAW6+D,OAAOR,EAAO1vB,mBAC9BgwB,EACHxgF,KAAK2gF,WAAYxyB,EAAOsyB,OAClB,CACN,IAAMt0E,EAAO+zE,EAAO/zE,KACpBnM,KAAK2gF,WAAYxyB,EAAOsyB,EAAmBt0E,EAAK7G,EAAG6G,EAAK5G,MAKpD06E,aAAP,SAAmB9xB,EAAe5yB,EAAwBqlD,EAAaC,GACtE1yB,EAAMqB,yBAGN,IAAMhiC,EAAI+N,EAAe/N,EACnBjuB,EAAIg8B,EAAeh8B,EACnBwI,EAAIwzB,EAAexzB,EACnBzI,EAAIi8B,EAAej8B,EACnBo1D,EAAKn5B,EAAem5B,GACpBC,EAAKp5B,EAAeo5B,GAGpB9yC,EAAYssC,EAAMtsC,UAClBi/D,EAAK70E,KAAK80E,OAAOh5E,EAAGzI,GACpB0hF,EAAK/0E,KAAK80E,OAAOxhF,EAAGiuB,GAC1B3L,EAAUusC,SAAuB,IAAX0yB,EAAKE,GAG3B,IAAM5+D,EAAmB,IAAX4+D,EAAKF,GACnBj/D,EAAUO,KAAK5c,IAAI4c,EAAMA,GASzB,IAAMyxC,EAAQhyC,EAAUgyC,MAClBgC,EAAKhC,EAAMvuD,EACXwwD,EAAKjC,EAAMtuD,EAOjB,GANAsc,EAAUhF,SAASrX,IAClBkvD,GAAMlnC,EAAIqoC,EAAK9tD,EAAI+tD,GACnBnB,GAAMp1D,EAAIs2D,EAAKv2D,EAAIw2D,IAIV,MAAN8qB,GAAoB,MAANC,EAAa,CAC9B,IAAM1sB,EAAKloD,KAAK0nB,KAAMnG,EAAIA,EAAIjuB,EAAIA,GAC5B60D,EAAKnoD,KAAK0nB,KAAM5rB,EAAIA,EAAIzI,EAAIA,GAClC6uD,EAAMhiD,KAAK3G,IACVm0E,GAAYI,aAAc6G,EAAKzsB,GAC/BwlB,GAAYI,aAAc8G,EAAKzsB,IAKjCjG,EAAMsB,0CCnFP,WAAatB,EAAeyyB,EAAYC,GACvC7gF,KAAKmuD,MAAQA,EAGbnuD,KAAKyN,KAAO,IAAI+e,QAAOo0D,EAAIC,GAG3B,IAAM10E,EAAOgiD,EAAMhiD,KACnBnM,KAAKihF,UAAY,IAAIz0D,QAAOrgB,EAAK7G,EAAG6G,EAAK5G,GAGzCvF,KAAK6hB,UAAY,IAAI42B,SACrB0V,EAAMziC,kBACNyiC,EAAMtsC,UAAU0Z,eAAe+1B,OAAQtxD,KAAK6hB,WAoC9C,OAjCCq/D,yBAAA,SAAc/yB,GACb,OAAOnuD,KAAKmuD,QAAUA,GAGvB+yB,kBAAA,SAAO/yB,EAAegzB,EAAeC,GACpCphF,KAAKyN,KAAKjI,IAAK27E,EAAOC,GAGtB,IAAMj1E,EAAOgiD,EAAMhiD,KACnBnM,KAAKihF,UAAUx7E,SAAU0G,GAGzBgiD,EAAMziC,kBACNyiC,EAAMtsC,UAAU0Z,eAAe+1B,OAAQtxD,KAAK6hB,YAG7Cq/D,mBAAA,SACC/yB,EAAegzB,EAAeC,EAC9BC,EAAgBC,GAEhB,IAAMntB,EAAKgtB,EAAQnhF,KAAKyN,KAAKnI,EACvB8uD,EAAKgtB,EAAQphF,KAAKyN,KAAKlI,EACvBg8E,EAAYvhF,KAAKihF,UACjBp/D,EAAYq/D,EAAsBM,eACxC3/D,EAAUw+D,WACRK,OAAQ1gF,KAAK6hB,WACb4/D,WAAYJ,GAASC,GACrBr/D,MAAOkyC,EAAIC,GACXqtB,WAAYJ,GAASC,GACvBnzB,EAAMmyB,4BACNL,GAAiBU,WAAYxyB,EAAOtsC,EAAW0/D,EAAUj8E,EAAGi8E,EAAUh8E,GACtE4oD,EAAMoyB,wBAAwB,IAtDdW,iBAAyB,IAAIzoC,4BCS9C,WAAa1jC,EAA+BzP,EAAWC,GAJ7CvF,QAAoB,IAAIwsB,QACxBxsB,QAAkC,IAAI66B,YACtC76B,QAA6B,IAAI66B,YAG1C76B,KAAKsrD,GAAUv2C,EACf/U,KAAK0hF,GAAW,GAChB1hF,KAAKyrD,GAAQ,IAAIj/B,QAAOlnB,EAAGC,GA0N7B,OAvNCo8E,iBAAA,aAIAniF,sBAAImiF,qBAAJ,WACC,OAAO3hF,KAAKyrD,GAAMnmD,OAGnB,SAAOA,GACN,IAAM6G,EAAOnM,KAAKyrD,GAClB,GAAIt/C,EAAK7G,IAAMA,EAAI,CAClB,IAAMs8E,EAAKz1E,EAAK7G,EAChB6G,EAAK7G,EAAIA,EACTtF,KAAK4B,SAAUggF,EAAIz1E,EAAK5G,qCAI1B/F,sBAAImiF,qBAAJ,WACC,OAAO3hF,KAAKyrD,GAAMlmD,OAGnB,SAAOA,GACN,IAAM4G,EAAOnM,KAAKyrD,GAClB,GAAIt/C,EAAK5G,IAAMA,EAAI,CAClB,IAAMs8E,EAAK11E,EAAK5G,EAChB4G,EAAK5G,EAAIA,EACTvF,KAAK4B,SAAUuK,EAAK7G,EAAGu8E,qCAIzBF,gBAAA,SAAKr8E,EAAwBC,GAC5B,IAAIhC,GAAY,EACV4I,EAAOnM,KAAKyrD,GACZm2B,EAAKz1E,EAAK7G,EACVu8E,EAAK11E,EAAK5G,EACP,MAALD,GAAas8E,IAAOt8E,IACvB/B,GAAY,EACZ4I,EAAK7G,EAAIA,GAED,MAALC,GAAas8E,IAAOt8E,IACvBhC,GAAY,EACZ4I,EAAK5G,EAAIA,GAENhC,GACHvD,KAAK4B,SAAUggF,EAAIC,IAIrBF,kBAAA,WACC,IAAMx1E,EAAOnM,KAAKyrD,GAClB,OAAO,IAAIk2B,EAAuB3hF,KAAKsrD,GAASn/C,EAAK7G,EAAG6G,EAAK5G,IAG9Do8E,iBAAA,aAIAA,qBAAA,SAAU18E,GACT,IAAMK,EAAIL,EAAMK,EACVC,EAAIN,EAAMM,EACV4G,EAAOnM,KAAKyrD,GACZm2B,EAAKz1E,EAAK7G,EACVu8E,EAAK11E,EAAK5G,EAMhB,OALIq8E,IAAOt8E,GAAKu8E,IAAOt8E,IACtB4G,EAAK7G,EAAIA,EACT6G,EAAK5G,EAAIA,EACTvF,KAAK4B,SAAUggF,EAAIC,IAEb7hF,MAGR2hF,mBAAA,SAAQ18E,GACP,OAAOjF,KAAKyrD,GAAM6F,OAAQrsD,IAG3B08E,mBAAA,SAAQ18E,GACP,OAAOjF,KAAKyrD,GAAM9lD,OAAQV,IAG3B08E,gBAAA,WACC,IAAM5sE,EAAS/U,KAAKsrD,GACpBv2C,EAAOurE,4BAGP,IAAMnM,EAAOn0E,KAAK8hF,SAAU9hF,KAAK+hF,IAG3B51E,EAAOnM,KAAKyrD,GAClBt/C,EAAK3G,IAAK2uE,EAAK/xE,MAAO+xE,EAAKtuE,QA2B3BkP,EAAO2W,kBACP,IAAM7J,EAAY9M,EAAO8M,UACnBvc,EAAI6uE,EAAK7uE,EAAiB,GAAb6uE,EAAK/xE,MAClBmD,EAAI4uE,EAAK5uE,EAAkB,GAAd4uE,EAAKtuE,OAClBgX,EAAWgF,EAAUhF,SACrB0e,EAAiB1Z,EAAU0Z,eAC3B/N,EAAI+N,EAAe/N,EACnBjuB,EAAIg8B,EAAeh8B,EACnBwI,EAAIwzB,EAAexzB,EACnBzI,EAAIi8B,EAAej8B,EACnBu0D,EAAQhyC,EAAUgyC,MACxBh3C,EAASrX,IACRqX,EAASvX,GAAKkoB,EAAIloB,EAAIyC,EAAIxC,IAAMioB,EAAIqmC,EAAMvuD,EAAIyC,EAAI8rD,EAAMtuD,GACxDsX,EAAStX,GAAKhG,EAAI+F,EAAIhG,EAAIiG,IAAMhG,EAAIs0D,EAAMvuD,EAAIhG,EAAIu0D,EAAMtuD,IAEzDsuD,EAAMruD,IAAKF,EAAGC,GAGdvF,KAAKyuD,MAAO15C,EAAOU,SAAUzV,KAAK0hF,GAAUv1E,GAG5C4I,EAAOwrE,wBAAwB,IAGtBoB,kBAAV,SAAiBlsE,EAAoBusE,EAAyB71E,GAC7D,IAAK,IAAIyH,EAAI,EAAGG,EAAO9H,KAAK0iB,IAAKqzD,EAAQrvE,OAAQ8C,EAAS9C,QAAUiB,EAAIG,IAAQH,EAAI,CACnF,IAAMuS,EAAQ1Q,EAAU7B,GAClBkJ,EAASklE,EAASpuE,GACxB,IAAIkJ,EAAO8mC,aAAcz9B,GAElB,CACN67D,EAAQrvE,OAASiB,EACjB,MAHAkJ,EAAO2xC,MAAOtoC,EAAOha,EAAK7G,EAAG6G,EAAK5G,GAMhCkQ,EAAS9C,OAASqvE,EAAQrvE,SAC7BqvE,EAAQrvE,OAAS8C,EAAS9C,SAI5BgvE,qBAAA,SAAUphF,GACT,IACMkV,EADSzV,KAAKsrD,GACI71C,SACxB,GAAIA,EAAS9C,QAAU,EACtBpS,EAAO+E,EAAI,EACX/E,EAAOgF,EAAI,EACXhF,EAAO6B,MAAQ,EACf7B,EAAOsF,OAAS,MACV,CACN,IAAMo8E,EAAYjiF,KAAKkiF,GACjBC,EAAWniF,KAAKoiF,GACtB3sE,EAAU,GAAI4sE,eAAgBJ,GAAW,EAAO1hF,GAChD,IAAK,IAAIqT,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACrC6B,EAAU7B,GAClByuE,eAAgBJ,GAAW,EAAOE,GACxC5hF,EAAO+hF,QAASH,GAGlB,OAAO5hF,GAGEohF,qBAAV,SAAoBC,EAAYC,GAC/B,IAAM9sE,EAAS/U,KAAKsrD,GACdn/C,EAAOnM,KAAKyrD,GACZoI,EAAQ9+C,EAAO8M,UAAUgyC,MAC/B7zD,KAAKuiF,GAAWxtE,EAAOU,SAAUzV,KAAK0hF,GAAUv1E,EAAK7G,EAAG6G,EAAK5G,EAAGsuD,EAAMvuD,EAAGuuD,EAAMtuD,EAAGq8E,EAAIC,GACtF9sE,EAAO6nD,gBAGE+kB,eAAV,SACClsE,EACAusE,EACA7tB,EAAYC,EACZyB,EAAYC,EACZ8rB,EAAYC,GAEZ,IAAK,IAAIjuE,EAAI,EAAGG,EAAO9H,KAAK0iB,IAAKqzD,EAAQrvE,OAAQ8C,EAAS9C,QAAUiB,EAAIG,IAAQH,EAAI,CACnF,IAAMuS,EAAQ1Q,EAAU7B,GAExB,KADMkJ,EAASklE,EAASpuE,IACbgwC,aAAcz9B,GAElB,CACN67D,EAAQrvE,OAASiB,EACjB,MAHAkJ,EAAOnc,OAAQwlB,EAAOguC,EAAIC,EAAIyB,EAAIC,GAMpC,IAASliD,EAAIouE,EAAQrvE,OAAQoB,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACpE,IACMkJ,EADAqJ,EAAQ1Q,EAAU7B,IAClBkJ,EAAS9c,KAAKwiF,UAAWr8D,EAAOy7D,EAAIC,IACnClhF,OAAQwlB,EAAOguC,EAAIC,EAAIyB,EAAIC,GAClCksB,EAAQpvE,KAAMkK,GAEXklE,EAAQrvE,SAAW8C,EAAS9C,SAC/BqvE,EAAQrvE,OAAS8C,EAAS9C,SAIlBgvE,sBAAV,SAAqBxzB,EAAeyzB,EAAYC,GAC/C,OAAO1zB,EAAMrxC,QAAU,IAAIokE,GAAuB/yB,EAAOyzB,EAAIC,wBCpO9D,WAAa38E,EAAgBI,EAAWC,GAAxC,MACCS,YAAOd,OAAIxD,EAAW4D,EAAGC,gBACzBY,EAAKsH,KAAO,IAAI+e,QAAOlnB,EAAGC,KAW5B,OAhB2CzF,OAQ1C2iF,iBAAA,WACCziF,KAAKyN,KAAKhI,SAAUzF,MACnBA,KAAakF,MAGfu9E,gBAAA,gBAb0C9lB,iCCK1C,WAAa5nD,GACZ/U,KAAKsrD,GAAUv2C,EAqIjB,OAlICvV,sBAAIkjF,0BAAJ,WACC,IAAMjtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,QACT8C,EAAUA,EAAS9C,OAAS,GAAI47C,OAAO2I,YAKhD,SAAYA,GAEX,IADA,IAAMzhD,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAO2I,OAASA,mCAIhC13D,sBAAIkjF,yBAAJ,WACC,IAAMjtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI47C,OAAOltD,MAExC,cAGR,SAAWA,GAEV,IADA,IAAMoU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAOltD,MAAQA,mCAI/B7B,sBAAIkjF,yBAAJ,WACC,IAAMjtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI47C,OAAOhtD,MAExC,OAGR,SAAWA,GAEV,IADA,IAAMkU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAOhtD,MAAQA,mCAI/B/B,sBAAIkjF,yBAAJ,WACC,IAAMjtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI47C,OAAOnsD,MAExC,OAGR,SAAWA,GAEV,IADA,IAAMqT,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAOnsD,MAAQA,mCAI/B5C,sBAAIkjF,yBAAJ,WACC,IAAMjtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI47C,OAAOjsD,MAExC,OAGR,SAAWA,GAEV,IADA,IAAMmT,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAOjsD,MAAQA,mCAI/B9C,sBAAIkjF,wBAAJ,WACC,IAAMjtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI47C,OAAOiJ,KAExC,OAGR,SAAUA,GAET,IADA,IAAM/hD,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAOiJ,KAAOA,mCAI9BkrB,iBAAA,SAAM7hF,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAOtM,KAAMphD,IAI7B6hF,gBAAA,SAAKxrB,EAAiB71D,EAAeE,EAAea,EAAeo1D,GAElE,IADA,IAAM/hD,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI26C,OAAO/oD,IAAK0xD,EAAQ71D,EAAOE,EAAOa,EAAOo1D,IAIzDkrB,kBAAA,WACC,OAAO,IAAIA,EAAyB1iF,KAAKsrD,KAG1Co3B,qBAAA,WACC,IAAMjtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI47C,OAAOD,WAExC,CACN4I,QAAQ,EACR71D,MAAO,SACPE,MAAO,EACPa,MAAO,EACPE,MAAO,EACPk1D,KAAMnM,GAAiBpnC,OAIzBy+D,sBAAA,SAAW31B,GACV,OAAQ,GAGT21B,wBAAA,SAAa7hF,EAAgBksD,wBCjI7B,WAAah4C,GACZ/U,KAAKsrD,GAAUv2C,EAiEjB,OA9DCvV,sBAAImjF,8BAAJ,WACC,IAAMltE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKrqB,MAAMs1B,WAE5CkgC,GAA0B/7C,YAGlC,SAAgB6b,GAEf,IADA,IAAMniB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKrqB,MAAMs1B,WAAaA,mCAIxCp4B,sBAAImjF,4BAAJ,WACC,IAAMltE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKrqB,MAAMo1B,SAE5CqgC,GAAwB1+B,YAGhC,SAAc3B,GAEb,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKrqB,MAAMo1B,SAAWA,mCAItCirD,iBAAA,SAAM9hF,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKrqB,MAAM2/C,KAAMphD,IAIjC8hF,gBAAA,SAAK/qD,EAAwCF,GAE5C,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKrqB,MAAMkD,IAAKoyB,EAAYF,IAI5CirD,qBAAA,WACC,IAAMltE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKrqB,MAAMgsD,WAE5C,CACN12B,WAAYkgC,GAA0B/7C,OACtC2b,SAAUqgC,GAAwB1+B,SAIpCspD,sBAAA,SAAW51B,GACV,OAAQ,GAGT41B,wBAAA,SAAa9hF,EAAgBksD,wBCjE7B,WAAah4C,GACZ/U,KAAKsrD,GAAUv2C,EAiEjB,OA9DCvV,sBAAIojF,8BAAJ,WACC,IAAMntE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKhpB,OAAOi0B,WAE7C,OAGR,SAAgBA,GAEf,IADA,IAAMniB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKhpB,OAAOi0B,WAAaA,mCAIzCp4B,sBAAIojF,4BAAJ,WACC,IAAMntE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKhpB,OAAO+zB,SAE7C,OAGR,SAAcA,GAEb,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKhpB,OAAO+zB,SAAWA,mCAIvCkrD,iBAAA,SAAM/hF,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKhpB,OAAOs+C,KAAMphD,IAIlC+hF,gBAAA,SAAKhrD,EAAoBF,GAExB,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKhpB,OAAO6B,IAAKoyB,EAAYF,IAI7CkrD,qBAAA,WACC,IAAMntE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKhpB,OAAO2qD,WAE7C,CACN12B,WAAY,EACZF,SAAU,IAIZkrD,sBAAA,SAAW71B,GACV,OAAQ,GAGT61B,wBAAA,SAAa/hF,EAAgBksD,wBC/D7B,WAAah4C,GACZ/U,KAAKsrD,GAAUv2C,EAqGjB,OAlGCvV,sBAAIqjF,0BAAJ,WACC,IAAMptE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,QACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKlpB,QAAQyzD,YAKtD,SAAYA,GAEX,IADA,IAAMzhD,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKlpB,QAAQyzD,OAASA,mCAItC13D,sBAAIqjF,yBAAJ,WACC,IAAMptE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKlpB,QAAQpC,MAE9C,cAGR,SAAWA,GAEV,IADA,IAAMoU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKlpB,QAAQpC,MAAQA,mCAIrC7B,sBAAIqjF,yBAAJ,WACC,IAAMptE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKlpB,QAAQlC,MAE9C,OAGR,SAAWA,GAEV,IADA,IAAMkU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKlpB,QAAQlC,MAAQA,mCAIrC/B,sBAAIqjF,yBAAJ,WACC,IAAMptE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKlpB,QAAQrB,MAE9C,OAGR,SAAWA,GAEV,IADA,IAAMqT,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKlpB,QAAQrB,MAAQA,mCAIrCygF,iBAAA,SAAMhiF,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKlpB,QAAQw+C,KAAMphD,IAInCgiF,gBAAA,SAAK3rB,EAAkB71D,EAAgBE,EAAgBa,GAEtD,IADA,IAAMqT,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKlpB,QAAQ+B,IAAK0xD,EAAQ71D,EAAOE,EAAOa,IAIxDygF,kBAAA,WACC,OAAO,IAAIA,EAA8B7iF,KAAKsrD,KAG/Cu3B,qBAAA,WACC,IAAMptE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKlpB,QAAQ6qD,WAE9C,CACN4I,QAAQ,EACR71D,MAAO,SACPE,MAAO,EACPa,MAAO,IAITygF,sBAAA,SAAW91B,GACV,OAAQ,GAGT81B,wBAAA,SAAahiF,EAAgBksD,wBCnG7B,WAAah4C,GACZ/U,KAAKsrD,GAAUv2C,EAiEjB,OA9DCvV,sBAAIsjF,8BAAJ,WACC,IAAMrtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKxoB,QAAQyzB,WAE9C,OAGR,SAAgBA,GAEf,IADA,IAAMniB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKxoB,QAAQyzB,WAAaA,mCAI1Cp4B,sBAAIsjF,4BAAJ,WACC,IAAMrtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKxoB,QAAQuzB,SAE9C,OAGR,SAAcA,GAEb,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKxoB,QAAQuzB,SAAWA,mCAIxCorD,iBAAA,SAAMjiF,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKxoB,QAAQ89C,KAAMphD,IAInCiiF,gBAAA,SAAKlrD,EAAoBF,GAExB,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKxoB,QAAQqB,IAAKoyB,EAAYF,IAI9CorD,qBAAA,WACC,IAAMrtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKxoB,QAAQmqD,WAE9C,CACN12B,WAAY,EACZF,SAAU,IAIZorD,sBAAA,SAAW/1B,GACV,OAAQ,GAGT+1B,wBAAA,SAAajiF,EAAgBksD,wBC/D7B,WAAah4C,GACZ/U,KAAKsrD,GAAUv2C,EAiEjB,OA9DCvV,sBAAIujF,8BAAJ,WACC,IAAMttE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKgvC,QAAQ/jC,WAE9C,OAGR,SAAgBA,GAEf,IADA,IAAMniB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKgvC,QAAQ/jC,WAAaA,mCAI1Cp4B,sBAAIujF,4BAAJ,WACC,IAAMttE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKgvC,QAAQjkC,SAE9C,OAGR,SAAcA,GAEb,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKgvC,QAAQjkC,SAAWA,mCAIxCqrD,iBAAA,SAAMliF,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKgvC,QAAQ1Z,KAAMphD,IAInCkiF,gBAAA,SAAKnrD,EAAoBF,GAExB,IADA,IAAMjiB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKgvC,QAAQn2D,IAAKoyB,EAAYF,IAI9CqrD,qBAAA,WACC,IAAMttE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKgvC,QAAQrN,WAE9C,CACN12B,WAAY,EACZF,SAAU,IAIZqrD,sBAAA,SAAWh2B,GACV,OAAQ,GAGTg2B,wBAAA,SAAaliF,EAAgBksD,wBCjD7B,WAAah4C,GACZ/U,KAAKsrD,GAAUv2C,EAEf/U,KAAKsC,MAAQ,IAAIqgF,GAA4B5tE,GAC7C/U,KAAK2D,OAAS,IAAIi/E,GAA6B7tE,GAC/C/U,KAAKyD,QAAU,IAAIo/E,GAA8B9tE,GACjD/U,KAAK27D,QAAU,IAAIonB,GAA8BhuE,GACjD/U,KAAKmE,QAAU,IAAI2+E,GAA8B/tE,GA2MnD,OAxMCvV,sBAAIwjF,0BAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,QAAI,EAAIA,EAAS9C,SACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKuqC,YAK9C,SAAYA,GAEX,IADA,IAAMzhD,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKuqC,OAASA,mCAI9B13D,sBAAIwjF,yBAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKiK,MAEtC,QAGR,SAAWA,GAEV,IADA,IAAMnhB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKiK,MAAQA,mCAI7Bp3B,sBAAIwjF,yBAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKtrB,MAEtC,OAGR,SAAWA,GAEV,IADA,IAAMoU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKtrB,MAAQA,mCAI7B7B,sBAAIwjF,yBAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKprB,MAEtC,OAGR,SAAWA,GAEV,IADA,IAAMkU,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKprB,MAAQA,mCAI7B/B,sBAAIwjF,0BAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKsb,OAEtC,YAGR,SAAYA,GAEX,IADA,IAAMxyB,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKsb,OAASA,mCAI9BzoC,sBAAIwjF,wBAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKxgB,KAEtC,QAGR,SAAUA,GAET,IADA,IAAMsJ,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKxgB,KAAOA,mCAI5B3M,sBAAIwjF,0BAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAK9H,OAEtC+yC,GAAiB8D,YAGzB,SAAY72C,GAEX,IADA,IAAMpP,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAK9H,OAASA,mCAI9BrlB,sBAAIwjF,yBAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAK6I,MAEtCqiC,GAAgB6D,YAGxB,SAAWlmC,GAEV,IADA,IAAM/f,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAK6I,MAAQA,mCAI7Bh2B,sBAAIwjF,6BAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKtX,UAEtC,OAGR,SAAeA,GAEd,IADA,IAAMI,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKtX,UAAYA,mCAIjC7V,sBAAIwjF,4BAAJ,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,QACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAKyD,cAK9C,SAAcA,GAEb,IADA,IAAM3a,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKyD,SAAWA,mCAIhC4yD,iBAAA,SAAMniF,GAEL,IADA,IAAM4U,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKs1B,KAAMphD,GAE1B,OAAOb,MAGRgjF,gBAAA,SACCpsD,EAAgBv1B,EAAgBE,EAChC0mC,EAAiB97B,EAAe0Y,EAChC2Q,EAAyBngB,GAGzB,IADA,IAAMI,EAAWzV,KAAKsrD,GAAQ71C,SACrB7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI+Y,KAAKnnB,IAAKoxB,EAAOv1B,EAAOE,EAAO0mC,EAAQ97B,EAAM0Y,EAAQ2Q,EAAOngB,GAE3E,OAAOrV,MAGRgjF,qBAAA,WACC,IAAMvtE,EAAWzV,KAAKsrD,GAAQ71C,SAC9B,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIga,KAAK2hC,WAEtC,CACN13B,MAAO,GACPv1B,MAAO,EACPE,MAAO,EACP0mC,OAAQ,OACR97B,KAAM,GACN0Y,OAAQ+yC,GAAiB8D,OACzBp5D,MAAOtC,KAAKsC,MAAMgsD,WAClB3qD,OAAQ3D,KAAK2D,OAAO2qD,WACpB94B,MAAOqiC,GAAgB6D,OACvBj4D,QAASzD,KAAKyD,QAAQ6qD,WACtBqN,QAAS37D,KAAK27D,QAAQrN,WACtBj5C,UAAW2iD,GAAoB4D,cAC/Bz3D,QAASnE,KAAKmE,QAAQmqD,WACtBl+B,UAAU,IAIZ4yD,sBAAA,SAAWj2B,GACV,OAAQ,GAGTi2B,wBAAA,SAAaniF,EAAgBksD,yBCvM7B,WAAapyC,gBAAAA,EAAOopC,GAAWk/B,OAA/B,MACCj9E,YAAO2U,gBACPxU,EAAKmpD,IAAM,IAAIoL,GACfv0D,EAAKgG,KAAOhG,EAAK+8E,eACjB/8E,EAAK8pB,KAAO9pB,EAAKg9E,eACjBh9E,EAAKooD,OAASpoD,EAAKi9E,iBACnBj9E,EAAKwmB,KAAOxmB,EAAKk9E,eACjBl9E,EAAKurD,OAASvrD,EAAKm9E,mBAyKrB,OAzLiCxjF,OAmBtByjF,yBAAV,WAAA,WACC,GAAIh2B,GAAei2B,aAClB,OAAO,IAAI7B,GACV3hF,KACAutD,GAAesP,OACftP,GAAeuP,QAGhB,IAAM2mB,EAAS,IAAIhB,IAClB,WACC,IAAMh1E,EAAOg2E,EAAOh2E,KACpBtH,EAAK0b,UAAUI,MAAMzc,IACpBi+E,EAAOn+E,EAAImI,EAAKnI,EAChBm+E,EAAOl+E,EAAIkI,EAAKlI,KAGlBgoD,GAAesP,OACftP,GAAeuP,QAEhB,OAAO2mB,GAICF,yBAAV,WACC,OAAO,IAAI1D,GAAuB7/E,OAGzBujF,2BAAV,WACC,OAAO,IAAIb,GAAyB1iF,OAG3BujF,yBAAV,WACC,OAAO,IAAIP,GAAuBhjF,OAGzBujF,2BAAV,WACC,OAAO,IAAIzD,GAAmB9/E,OAGrBujF,0BAAV,WACC,IAAMp3E,EAAOnM,KAAKmM,KAClB,OAAIA,aAAgBs2E,GACZt2E,EAAKsB,KAELtB,GAITo3E,mCAAA,WACCv9E,YAAMotD,kCACNpzD,KAAKmM,KAAKu3E,OAGXlkF,sBAAI+jF,0BAAJ,WACC,IAAM9tE,EAAWzV,KAAKyV,SACtB,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI1P,OAEjCmoD,GAAa3D,SAGrB,SAAYxkD,GAEX,IADA,IAAMwS,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI3Q,OAASA,mCAIzBzD,sBAAI+jF,0BAAJ,WACC,IAAM9tE,EAAWzV,KAAKyV,SACtB,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAI67C,OAEjC,QAGR,SAAYA,GAEX,IADA,IAAM/4C,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI46C,OAASA,mCAIzBhvD,sBAAI+jF,4BAAJ,WAEC,IADA,IAAM9tE,EAAWzV,KAAKyV,SACb7B,EAAI6B,EAAS9C,OAAS,EAAG,GAAKiB,IAAKA,EAAI,CAC/C,IAAM69C,EAAWh8C,EAAU7B,GAAI69C,SAC/B,GAAgB,MAAZA,EACH,OAAOA,QAMV,SAAcA,GAEb,IADA,IAAMh8C,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAI69C,SAAWA,mCAI3BjyD,sBAAI+jF,0BAAJ,WACC,IAAM9tE,EAAWzV,KAAKyV,SACtB,OAAI,EAAIA,EAAS9C,OACT8C,EAAUA,EAAS9C,OAAS,GAAIxP,OAEjC,QAGR,SAAYA,GAEX,IADA,IAAMsS,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAIzQ,OAASA,mCAIzB3D,sBAAI+jF,yBAAJ,WAEC,IADA,IAAM9tE,EAAWzV,KAAKyV,SACb7B,EAAI6B,EAAS9C,OAAS,EAAG,GAAKiB,IAAKA,EAAI,CAC/C,IAAMmmB,EAAQtkB,EAAU7B,GAAImmB,MAC5B,GAAa,MAATA,EACH,OAAOA,QAMV,SAAWA,GAEV,IADA,IAAMtkB,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD6B,EAAU7B,GAAImmB,MAAQA,mCAIxBv6B,sBAAI+jF,0BAAJ,WAEC,IADA,IAAM9tE,EAAWzV,KAAKyV,SACb7B,EAAI6B,EAAS9C,OAAS,EAAG,GAAKiB,IAAKA,EAE3C,GAAc,MADC6B,EAAU7B,GAAI89C,OAE5B,OAAO1xD,KAAK2jF,QAMf,SAAYjyB,qCAIZ6xB,kBAAA,WAIC,IAHA,IACMhjF,GAAS,IAAIN,EADCD,KAAKC,cACQgiD,KAAMjiD,MACjCyV,EAAWzV,KAAKyV,SACb7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EAAI,CACvD,IAAMojD,EAAQvhD,EAAU7B,GAAIojD,QAC5BA,EAAMjiD,OAASxU,EACfA,EAAOkV,SAAS7C,KAAMokD,GAIvB,OAFAz2D,EAAO6yD,yBACP7yD,EAAOgjB,UACAhjB,GAGRgjF,wBAAA,SAAaj+E,EAAWC,EAAW0vD,EAAYC,GAC9C,OAAO,MAvLwBjC,kBChBjC,cAaA,OAZQ2wB,cAAP,SACCpiE,EAA8BurC,GAE9B,IAAMoB,EAAQy1B,EAAazjF,SACrBI,EAAS28E,GAAmBziB,YAAaj5C,EAAMurC,EAASoB,GAE9D,OADAA,EAAMhiD,KAAK6Z,OACJzlB,GAGDqjF,SAAP,WACC,OAAO,IAAIL,SCVAM,GAAiB,WAC7Bz5B,GAAiBrG,GAAWk/B,OAAUrD,GAAqBz/E,OAC3D+pD,GAAqBnG,GAAWk/B,OAAUW,GAAanpB,2BCAvD,WAAa1lD,EAA+BzP,EAAWC,GACtDvF,KAAKsrD,GAAUv2C,EACf/U,KAAKyrD,GAAQ,IAAIj/B,QAAOlnB,EAAGC,GAyF7B,OAtFCu+E,iBAAA,aAIAtkF,sBAAIskF,qBAAJ,WACC,OAAO9jF,KAAKyrD,GAAMnmD,OAGnB,SAAOA,GACN,IAAM6G,EAAOnM,KAAKyrD,GAClB,GAAIt/C,EAAK7G,IAAMA,EAAI,CAClB,IAAMs8E,EAAKz1E,EAAK7G,EAChB6G,EAAK7G,EAAIA,EACTtF,KAAK4B,SAAUggF,EAAIz1E,EAAK5G,qCAI1B/F,sBAAIskF,qBAAJ,WACC,OAAO9jF,KAAKyrD,GAAMlmD,OAGnB,SAAOA,GACN,IAAM4G,EAAOnM,KAAKyrD,GAClB,GAAIt/C,EAAK5G,IAAMA,EAAI,CAClB,IAAMs8E,EAAK11E,EAAK5G,EAChB4G,EAAK5G,EAAIA,EACTvF,KAAK4B,SAAUuK,EAAK7G,EAAGu8E,qCAIzBiC,gBAAA,SAAKx+E,EAAwBC,GAC5B,IAAIhC,GAAY,EACV4I,EAAOnM,KAAKyrD,GACZm2B,EAAKz1E,EAAK7G,EACVu8E,EAAK11E,EAAK5G,EACP,MAALD,GAAas8E,IAAOt8E,IACvB/B,GAAY,EACZ4I,EAAK7G,EAAIA,GAED,MAALC,GAAas8E,IAAOt8E,IACvBhC,GAAY,EACZ4I,EAAK5G,EAAIA,GAENhC,GACHvD,KAAK4B,SAAUggF,EAAIC,IAIrBiC,kBAAA,WACC,IAAM33E,EAAOnM,KAAKyrD,GAClB,OAAO,IAAIq4B,EAAyB9jF,KAAKsrD,GAASn/C,EAAK7G,EAAG6G,EAAK5G,IAGhEu+E,iBAAA,aAIAA,qBAAA,SAAU7+E,GACT,IAAMK,EAAIL,EAAMK,EACVC,EAAIN,EAAMM,EACV4G,EAAOnM,KAAKyrD,GACZm2B,EAAKz1E,EAAK7G,EACVu8E,EAAK11E,EAAK5G,EAMhB,OALIq8E,IAAOt8E,GAAKu8E,IAAOt8E,IACtB4G,EAAK7G,EAAIA,EACT6G,EAAK5G,EAAIA,EACTvF,KAAK4B,SAAUggF,EAAIC,IAEb7hF,MAGR8jF,mBAAA,SAAQ7+E,GACP,OAAOjF,KAAKyrD,GAAM6F,OAAQrsD,IAG3B6+E,mBAAA,SAAQ7+E,GACP,OAAOjF,KAAKyrD,GAAM9lD,OAAQV,IAG3B6+E,gBAAA,aAIUA,qBAAV,SAAoBlC,EAAYC,GAC/B7hF,KAAKsrD,GAAQsR,oCC1Fd,WAAajiD,uBAAAA,EAAmBopC,GAAWggC,gBAC1C/9E,YAAO2U,SAcT,OAhByC7a,OAK9BkkF,yBAAV,WACC,OAAIz2B,GAAei2B,aACX,IAAIM,GACV9jF,KACAutD,GAAesP,OACftP,GAAeuP,QAGT92D,YAAMk9E,4BAbyBK,kBCDzC,cAaA,OAZQU,cAAP,SACCziE,EAA8BurC,GAE9B,IAAMoB,EAAQ81B,EAAqB9jF,SAC7BI,EAAS28E,GAAmBziB,YAAaj5C,EAAMurC,EAASoB,GAE9D,OADAA,EAAMhiD,KAAK6Z,OACJzlB,GAGD0jF,SAAP,WACC,OAAO,IAAID,SCVAE,GAAyB,WACrC95B,GAAiBrG,GAAWggC,gBAAmBnE,GAAqBz/E,OACpE+pD,GAAqBnG,GAAWggC,gBAAmBE,GAAqBxpB,4BCHxE,WAAa9/C,uBAAAA,EAAOopC,GAAWogC,WAC9Bn+E,YAAO2U,SAuDT,OAzDqC7a,OAKpCskF,kBAAA,WACC,OAAO,IAAIA,GAAkBniC,KAAMjiD,OAGpCokF,wBAAA,SAAa9+E,EAAWC,EAAW0vD,EAAYC,GAC9C,GAAIlvD,YAAMgvD,0BAAiB1vD,EAAGC,EAAG0vD,EAAIC,GAAO,CAC3C,IAAMjlC,EAAOjwB,KAAKiwB,KACZs+B,EAASvuD,KAAKuuD,OACpB,GAAIt+B,EAAKinC,OACR,OAAO,EAEP,IAAMp3B,EAAcyuB,EAAOnsD,MACrBi+D,EAAa9R,EAAOiJ,KAC1B,GAAIjJ,EAAO2I,QAAU,EAAIp3B,GAAeugC,IAAehV,GAAiBpnC,KAAO,CAC9E,IAAMo7D,EAAKpzE,KAAKC,IAAK,EAAK+oD,EAAKn1B,GACzBw/C,EAAKrzE,KAAKC,IAAK,EAAKgpD,EAAKp1B,GAC/B,IAAM9/B,KAAKg1D,gBAAiB1vD,EAAGC,EAAG85E,EAAIC,GACrC,OAAIjf,IAAehV,GAAiB5D,MAG/BniD,IAAM+5E,EACL95E,IAAM+5E,EACgD,IAAhDjf,EAAahV,GAAiBg5B,cAC5B/E,GAAM/5E,EAC2C,IAAnD86D,EAAahV,GAAiBi5B,gBAEW,IAAzCjkB,EAAahV,GAAiB9/C,OAE7B8zE,GAAM/5E,EACbC,IAAM+5E,EACiD,IAAjDjf,EAAahV,GAAiBk5B,eAC5BjF,GAAM/5E,EAC4C,IAApD86D,EAAahV,GAAiBm5B,iBAEY,IAA1CnkB,EAAahV,GAAiB5/C,OAGpClG,IAAM+5E,EACwC,IAAxCjf,EAAahV,GAAiBlgD,MAC5Bm0E,GAAM/5E,GACmC,IAA3C86D,EAAahV,GAAiBhgD,UAU9C,OAAO,MAvD4BqxD,mBCApC,WAAa3iC,EAA0Bpf,gBAAAA,EAAOopC,GAAW0gC,OAAzD,MACCz+E,YAAO2U,gBACM,MAATof,IACH5zB,EAAK4zB,MAAQA,EACb5zB,EAAKgG,KAAK3G,IAAKu0B,EAAM33B,MAAO23B,EAAMl0B,SAEnCM,EAAK8pB,KAAK1uB,MAAQ,IAMpB,OAbiCzB,OAUhC4kF,kBAAA,WACC,OAAO,IAAIA,EAAa1kF,KAAK+5B,OAAQkoB,KAAMjiD,UAXZokF,kBCGjC,cAgBA,OAfQO,OAAP,SAAahI,GACZ,OAAOD,GAAoBoB,eAAgBnB,GAAUtpE,MAAK,SAAE2pE,GAC3D,OAAO,IAAI0H,GAAa1H,OAInB2H,cAAP,SACCnjE,EAA8BurC,GAE9B,OAAOmwB,GAAmBziB,YAAaj5C,EAAMurC,EAAS43B,EAAaxkF,WAG7DwkF,SAAP,WACC,OAAO,IAAID,wBCfb,4DAmcA,OAnc6C5kF,OAC5C8kF,iBAAA,SAAMz2B,GACLnoD,YAAMggB,eAAMmoC,GACZ,IAAM8Q,EAASj/D,KAAKi/D,OACdC,EAAUl/D,KAAKu/D,aACfJ,EAAUn/D,KAAKy/D,YAGrBR,EAAOgM,eAAetqE,SACtB,IAAM2hE,EAAYrD,EAAOqD,UACrBiJ,EAAe,EAAVrM,EACToD,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAEtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAEtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEW,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EAGvBjJ,GAFAiJ,GAAM,IAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAEtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAEtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBtM,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QACjBD,EAAe,EAAVu3D,EAqCX,OApCAt3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAG/Bl/D,KAAKwrE,WAELxrE,KAAKW,OAAQwtD,GACNnuD,MAGR4kF,mBAAA,SAAQz2B,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACpBj/D,KAAKq+E,kBAAmBpf,EAAQ9Q,GAChCnuD,KAAKgsE,YAAa/M,EAAQ9Q,GAC1BnuD,KAAKs+E,gBAAiBrf,EAAQ9Q,GAC9BnuD,KAAKu+E,cAAetf,EAAQ9Q,GAC5BnuD,KAAK05B,WAAYulC,EAAQ9Q,IAGhBy2B,8BAAV,SAA6B3lB,EAAsB9Q,GAClD,IAAMhiD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACb+5D,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5Csd,EAAkB1f,IAAU/rD,KAAK+rD,OAASC,IAAUhsD,KAAKgsD,MACzD4f,EAAuB5rE,KAAKs/D,mBAAqBA,EACjD/Q,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MACrBk8E,EAAoBx+E,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,EACnF,GAAI2rC,GAAiBG,GAAsB4S,EAAkB,CAC5Dx+E,KAAK+rD,MAAQA,EACb/rD,KAAKgsD,MAAQA,EACbhsD,KAAKs/D,iBAAmBA,EAGxBt/D,KAAK8/B,YAAcp5B,IAGnB1G,KAAK8jE,sBAAwBp9D,IAE7Bu4D,EAAOnyC,aAAansB,SAYpB,IAAMoZ,EAAIqmD,EAActgC,EAClBq0B,EAAa,GAARpI,GAAe,GAAKA,GAAShyC,GAAKA,GACvCq6C,EAAa,GAARpI,GAAe,GAAKA,GAASjyC,GAAKA,GACvCy2C,EAAoBrC,EAAMtsC,UAAU2uC,kBACpCxkC,EAAOhsB,KAAKi/D,OAAOjzC,KACzBA,EAAKxmB,KAAM2uD,GAAKC,GAChB5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMxkB,EAAKwkB,EAAK1mB,EACVoC,EAAKskB,EAAKzmB,EAChBymB,EAAKxmB,IAAK,GAAI4uD,GACd5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMvkB,EAAKukB,EAAK1mB,EACVqC,EAAKqkB,EAAKzmB,EACV6Z,EAAK3X,EAAKD,EACV8X,EAAK3X,EAAKD,EACVoB,EAAK0nD,EAAkBkE,GACvB1rD,EAAKwnD,EAAkBmE,GACvBkwB,EAAM/7E,GAAMA,EAAKrB,GACjBq9E,EAAM97E,GAAMA,EAAKrB,GACjB82E,EAAK31E,EAAKsW,EACVs/D,EAAK11E,EAAKsW,EAGhBtf,KAAK+/D,eAAiB//D,KAAKsmE,WAAY9+D,EAAIE,EAAID,EAAIE,GACnD3H,KAAKggE,eAAiBhgE,KAAKsmE,WAAY9+D,EAAIE,EAAI+2E,EAAIC,GAGnD,IAAMxf,EAAUl/D,KAAKu/D,aACf32D,EAAWq2D,EAAOr2D,SACpBtB,EAAe,EAAV43D,EACTt2D,EAAUtB,EAAK,GAAME,EACrBoB,EAAUtB,EAAK,GAAMI,EACrBkB,EAAUtB,EAAK,GAAMG,EACrBmB,EAAUtB,EAAK,GAAMK,EACrBiB,EAAUtB,EAAK,GAAMG,EAAK2X,EAC1BxW,EAAUtB,EAAK,GAAMK,EAAK2X,EAG1B1W,GAFAtB,GAAM,GAES,GAAMwB,EACrBF,EAAUtB,EAAK,GAAM0B,EAGrBJ,GAFAtB,GAAM,GAES,GAAMm3E,EACrB71E,EAAUtB,EAAK,GAAMo3E,EACrB91E,EAAUtB,EAAK,GAAMwB,EACrBF,EAAUtB,EAAK,GAAM0B,EACrBJ,EAAUtB,EAAK,GAAMwB,EACrBF,EAAUtB,EAAK,GAAM0B,EACrBJ,EAAUtB,EAAK,GAAMwB,EAAKsW,EAC1BxW,EAAUtB,EAAK,GAAM0B,EAAKsW,EAG1B1W,GAFAtB,GAAM,GAES,GAAMwB,EACrBF,EAAUtB,EAAK,GAAM0B,EAGrBJ,GAFAtB,GAAM,GAES,GAAMu9E,EAAMzlE,EAC3BxW,EAAUtB,EAAK,GAAMw9E,EAAMxlE,EAC3B1W,EAAUtB,EAAK,GAAMu9E,EACrBj8E,EAAUtB,EAAK,GAAMw9E,EACrBl8E,EAAUtB,EAAK,GAAMu9E,EAAMzlE,EAC3BxW,EAAUtB,EAAK,GAAMw9E,EAAMxlE,IAInBslE,4BAAV,SAA2B3lB,EAAsB9Q,GAChD,IAAMI,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MACrB+9D,EAAa9R,EAAOiJ,KAC1B,GAAIx3D,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,GAAe9/B,KAAKqgE,aAAeA,EAAa,CAC5GrgE,KAAK8/B,YAAcA,EACnB9/B,KAAKogE,YAAcA,EACnBpgE,KAAKqgE,WAAaA,EAClBpB,EAAO0L,WAAWhqE,SAClBs+D,EAAO2L,gBAAgBjqE,SAEvB,IAAMqrB,EAAOizC,EAAO4f,SACpB7+E,KAAK8+E,SAAU9+E,KAAK+/D,eAAgBjgC,EAAa9T,GACjD,IAAM81C,EAAM91C,EAAM,GACZg2C,EAAMh2C,EAAM,GACZk2C,EAAMl2C,EAAM,GAElBhsB,KAAK8+E,SAAU9+E,KAAKggE,eAAgBlgC,EAAa9T,GACjD,IAAM+1C,EAAM/1C,EAAM,GACZi2C,EAAMj2C,EAAM,GACZm2C,EAAMn2C,EAAM,GAEd+4D,EAAMhjB,EACNijB,EAAM/iB,EACH5B,EAAahV,GAAiBlgD,MACpC45E,EAAM,EACNC,EAAM7iB,GAEP,IAAI8iB,EAAMnjB,EACNojB,EAAMljB,EACH3B,EAAahV,GAAiB5/C,QACpCw5E,EAAM,EACNC,EAAMhjB,GAEP,IAAIijB,EAAMpjB,EACNqjB,EAAMnjB,EACH5B,EAAahV,GAAiBhgD,SACpC85E,EAAM,EACNC,EAAMjjB,GAEP,IAAIkjB,EAAMvjB,EACNwjB,EAAMtjB,EACH3B,EAAahV,GAAiB9/C,OACpC85E,EAAM,EACNC,EAAMpjB,GAEP,IAAMR,EAAM,IAAO4jB,EAAMJ,GACnBK,EAAM,IAAOP,EAAMI,GAEnBhjB,EAAQnD,EAAOmD,MACfC,EAAcpD,EAAOoD,YACrBnD,EAAUl/D,KAAKu/D,aACjBjvD,EAAe,EAAV4uD,EACLn1D,EAAe,EAAVm1D,EAGTkD,EAAO9xD,EAAK,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAM23D,EACxBW,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAM23D,EACxBW,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMw7E,EACxBljB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMw7E,EACxBljB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMw7E,EACxBljB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMw7E,EACxBljB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAM23D,EACxBW,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAM23D,EACxBW,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EACxB7xD,GAAM,EACNvG,GAAM,IAIE66E,0BAAV,SAAyB3lB,EAAsB9Q,GAC9C,IAAMvoD,EAAU5F,KAAK46C,UAAWuT,GAC1BmS,EAAqBtgE,KAAK2lE,qBAAsB//D,GACtD,GAAIA,IAAY5F,KAAK4F,SAAW06D,IAAuBtgE,KAAKsgE,mBAAqB,CAChFtgE,KAAK4F,QAAUA,EACf5F,KAAKsgE,mBAAqBA,EAE1B,IAAMr3D,EAAajJ,KAAKunE,aAAc3hE,GAChC4B,EAAKyB,EAAWzB,GAChBC,EAAKwB,EAAWxB,GAChBoB,EAAKI,EAAWJ,GAChBC,EAAKG,EAAWH,GAChBpB,EAAKuB,EAAWvB,GAChBC,EAAKsB,EAAWtB,GAChBoB,EAAKE,EAAWF,GAChBC,EAAKC,EAAWD,GAEhBw8E,EAAM,IAAQh+E,EAAKqB,GACnB48E,EAAM,IAAQ/9E,EAAKqB,GAGzBk2D,EAAOlyC,SAASpsB,SAChB,IAAMmH,EAAMm3D,EAAOn3D,IAEf8kE,EAAgB,EADJ5sE,KAAKu/D,aAErBz3D,EAAK8kE,EAAM,GAAMplE,EACjBM,EAAK8kE,EAAM,GAAMllE,EACjBI,EAAK8kE,EAAM,GAAM,IAAQplE,EAAKC,GAC9BK,EAAK8kE,EAAM,GAAM,IAAQllE,EAAKC,GAC9BG,EAAK8kE,EAAM,GAAMnlE,EACjBK,EAAK8kE,EAAM,GAAMjlE,EAGjBG,GAFA8kE,GAAO,GAEI,GAAM4Y,EACjB19E,EAAK8kE,EAAM,GAAM6Y,EAGjB39E,GAFA8kE,GAAO,GAEI,GAAM,IAAQplE,EAAKsB,GAC9BhB,EAAK8kE,EAAM,GAAM,IAAQllE,EAAKsB,GAC9BlB,EAAK8kE,EAAM,GAAM4Y,EACjB19E,EAAK8kE,EAAM,GAAM6Y,EACjB39E,EAAK8kE,EAAM,GAAM4Y,EACjB19E,EAAK8kE,EAAM,GAAM6Y,EACjB39E,EAAK8kE,EAAM,GAAM,IAAQnlE,EAAKoB,GAC9Bf,EAAK8kE,EAAM,GAAM,IAAQjlE,EAAKoB,GAG9BjB,GAFA8kE,GAAO,GAEI,GAAM4Y,EACjB19E,EAAK8kE,EAAM,GAAM6Y,EAGjB39E,GAFA8kE,GAAO,GAEI,GAAM9jE,EACjBhB,EAAK8kE,EAAM,GAAM5jE,EACjBlB,EAAK8kE,EAAM,GAAM,IAAQ9jE,EAAKD,GAC9Bf,EAAK8kE,EAAM,GAAM,IAAQ5jE,EAAKD,GAC9BjB,EAAK8kE,EAAM,GAAM/jE,EACjBf,EAAK8kE,EAAM,GAAM7jE,OAhcyBu7D,kBCA7C,cAiBA,OAhBQohB,SAAP,SACCzmB,EAAsB9Q,EACtB+Q,EAAiBC,GAEjB,IAAM2N,EAASlK,GAAoB2B,aAAcpW,EAAO8Q,EAAOuF,WACzD3B,EAAUiK,EAAOtN,YACjBsD,EAAUgK,EAAOpN,WACjBN,EAAS,GAAKyD,EACdxD,EAAS,EAAIyD,EACnB,OAAI5D,EAAUE,EAASH,EAAO8N,gBAAkB5N,EAAUE,EAASJ,EAAO+N,cAClE,IAAI4X,GACV3lB,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,GACnDr5C,KAAMmoC,GAEF,WCdIw3B,GAAiB,WAC7Bv7B,GAAiBrG,GAAW0gC,OAAUiB,GAAyBvlF,OAC/D+pD,GAAqBnG,GAAW0gC,OAAUE,GAAalqB,4BCJxD,4DAmCA,OAnCyC36D,OACxC8lF,iBAAA,SAAMz3B,GAIL,OAHAnoD,YAAMggB,eAAMmoC,GACZnuD,KAAKwrE,WACLxrE,KAAKW,OAAQwtD,GACNnuD,MAGR4lF,mBAAA,SAAQz3B,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACpBj/D,KAAK6lF,kBAAmB5mB,EAAQ9Q,GAChCnuD,KAAK8lF,cAAe7mB,EAAQ9Q,GAC5BnuD,KAAK05B,WAAYulC,EAAQ9Q,IAG1By3B,8BAAA,SAAmB3mB,EAAsB9Q,GACxC,IAAMhiD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACbkmE,EAAkB1f,IAAU/rD,KAAK+rD,OAASC,IAAUhsD,KAAKgsD,MACzDsT,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5Cyd,EAAuB5rE,KAAKs/D,mBAAqBA,GACnDmM,GAAiBG,KACpB5rE,KAAK+rD,MAAQA,EACb/rD,KAAKgsD,MAAQA,EACbhsD,KAAKs/D,iBAAmBA,EAGxBt/D,KAAK8jE,sBAAwBp9D,MAI/Bk/E,0BAAA,SAAe3mB,EAAsB9Q,GACpCnuD,KAAK4F,QAAU5F,KAAK46C,UAAWuT,OAjCQmW,kBCCzC,cAgBA,OAfQyhB,SAAP,SACC9mB,EAAsB9Q,EAAe+Q,EAAiBC,GAEtD,IAAM2N,EAASlK,GAAoB2B,aAAcpW,EAAO8Q,EAAOuF,WACzD3B,EAAUiK,EAAOtN,YACjBsD,EAAUgK,EAAOpN,WACjBN,EAASyD,EACTxD,EAASyD,EACf,OAAI5D,EAAUE,EAASH,EAAO8N,gBAAkB5N,EAAUE,EAASJ,EAAO+N,cAClE,IAAI4Y,GACV3mB,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,GACnDr5C,KAAMmoC,GAEF,0BCfR,WAAaxzC,uBAAAA,EAAmBopC,GAAWiiC,OAC1ChgF,YAAO2U,SAMT,OARiC7a,OAKhCmmF,kBAAA,WACC,OAAO,IAAIA,GAAchkC,KAAMjiD,UANA08D,kBCEjC,cAMA,OALQwpB,cAAP,SACC1kE,EAA8BurC,GAE9B,OAAOmwB,GAAmBziB,YAAaj5C,EAAMurC,EAAS,IAAIk5B,UCH/CE,GAAiB,WAC7B/7B,GAAiBrG,GAAWiiC,OAAUD,GAAqB5lF,OAC3D+pD,GAAqBnG,GAAWiiC,OAAUE,GAAazrB,4BCSvD,WACCwE,EACAC,EAAiBC,EACjB0D,EAAiBC,EACjB1D,EAAgBC,EAChBrB,EAAoBooB,GALrB,MAOCpgF,YAAOi5D,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,gBAC3Dl5D,EAAKkgF,QAAU3/E,IACfP,EAAK63D,WAAaA,EAClB73D,EAAKigF,aAAeA,EACpBjgF,EAAKklE,YAAclhB,GAAkBlmC,KACrC9d,EAAKwM,OAAS,IAqiBhB,OAxjBwC7S,OAsBvCwmF,iBAAA,SAAMn4B,GACLnoD,YAAMggB,eAAMmoC,GACZ,IAAM8Q,EAASj/D,KAAKi/D,OACdC,EAAUl/D,KAAKu/D,aACfJ,EAAUn/D,KAAKy/D,YACfzB,EAAah+D,KAAKg+D,WAClBooB,EAAepmF,KAAKomF,aAG1B,GAAI,GAAKpoB,EAAa,CACrBiB,EAAOgM,eAAetqE,SACtB,IAAM2hE,EAAYrD,EAAOqD,UACzBrD,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QAEnB0jE,EAAe,EAAVrM,EACLt3D,EAAe,EAAVu3D,EACLonB,EAAKrnB,EAGHknB,IACL9jB,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBA,GAAM,EAEN1jE,EAASD,EAAK,GAAM2+E,EAAK,EACzB1+E,EAASD,EAAK,GAAM2+E,EAAK,EACzB1+E,EAASD,EAAK,GAAM2+E,EAAK,EAEzB1+E,EAASD,EAAK,GAAM2+E,EAAK,EACzB1+E,EAASD,EAAK,GAAM2+E,EAAK,EACzB1+E,EAASD,EAAK,GAAM2+E,EAAK,EACzBA,GAAM,EACN3+E,GAAM,GAIP,IAAK,IAAIgM,EAAKwyE,EAAe,EAAI,EAAIryE,EAAOiqD,EAAapqD,EAAGA,EAAIG,IAAQH,EACvE0uD,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAM,GAAM,EAEvBjJ,EAAWiJ,EAAM,GAAM,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBjJ,EAAWiJ,EAAK,IAAO,EACvBA,GAAM,GAEN1jE,EAASD,EAAM,GAAM2+E,EAAK,EAC1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAC1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAE1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAC1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAC1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAE1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAC1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAC1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAE1B1+E,EAASD,EAAM,GAAM2+E,EAAK,EAC1B1+E,EAASD,EAAK,IAAO2+E,EAAK,EAC1B1+E,EAASD,EAAK,IAAO2+E,EAAK,EAC1BA,GAAM,EACN3+E,GAAM,GAIP06D,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAEtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EASvB,OALAvrE,KAAKwrE,WAGLxrE,KAAKW,OAAQwtD,GAENnuD,MAGRsmF,mBAAA,SAAQn4B,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACdvN,EAASvD,EAAMuD,OACrB,GAAc,MAAVA,GAAkB,GAAKA,EAAO/+C,OAAS,CAC1C,IAAM0zE,EAAU30B,EAAO7gC,GACjB21D,EAAmBH,IAAYrmF,KAAKqmF,QACpC93B,EAASJ,EAAMI,OACfzuB,EAAgByuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC/CspE,EAAyB5rC,IAAgB9/B,KAAK8/B,YAC9Cw/B,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5Cyd,EAAuB5rE,KAAKs/D,mBAAqBA,EACjD+L,EAAc3Z,EAAOl8B,MACrBs2C,EAAyBT,IAAgBrrE,KAAKqrE,YACpD,GAAImb,GAAkB5a,GAAsBF,GAAwBI,EAAuB,CAC1F9rE,KAAKqmF,QAAUA,EACfrmF,KAAK8/B,YAAcA,EACnB9/B,KAAKs/D,iBAAmBA,EACxBt/D,KAAKqrE,YAAcA,EACnBpM,EAAOnyC,aAAansB,SACpBs+D,EAAO0L,WAAWhqE,SAClBs+D,EAAO2L,gBAAgBjqE,SACvBs+D,EAAO+B,gBAAgBrgE,UAEnB6lF,GAAkB5a,KAErB5rE,KAAK8jE,sBAAwBp9D,KAE1B8/E,IAEHxmF,KAAKsgE,mBAAqB55D,KAG3B,IAAMw4D,EAAUl/D,KAAKu/D,aACfH,EAASp/D,KAAKw/D,YAAcx/D,KAAKokE,gBACvCpkE,KAAK+rE,iCACJ9M,EACAvN,EAAQ5xB,EAAaquB,EAAMtsC,UAAU2uC,kBACrC0O,EAASE,IAKZp/D,KAAKgsE,YAAa/M,EAAQ9Q,GAC1BnuD,KAAKymF,aAAcxnB,EAAQ9Q,GAC3BnuD,KAAK05B,WAAYulC,EAAQ9Q,IAGhBm4B,qCAAV,SAAoCrnB,EAAsB9Q,EAAeqR,GACxEx/D,KAAKshE,kBAAmBrC,EAAQ9Q,EAAOqR,IAGxC8mB,yBAAA,SAAcn4B,GACb,GAAInoD,YAAM49C,uBAAcuK,GAAU,CACjC,IAAMuD,EAASvD,EAAMuD,OACrB,OAAIA,EAEF1xD,KAAKg+D,aAAetM,EAAO/+C,QAC3B3S,KAAKomF,kBAAsB10B,EAAOl8B,MAAQ20B,GAAkBqU,QAIxC,IAApBx+D,KAAKg+D,aACiB,IAAtBh+D,KAAKomF,aAIR,OAAO,GAGEE,6CAAV,SACCrnB,EACAvN,EACA5xB,EACA0wB,EACA0O,EACAE,GAEA,IAAI93D,EAAe,EAAV43D,EACLn1D,EAAe,EAAVm1D,EACHt2D,EAAWq2D,EAAOr2D,SAClBw5D,EAAQnD,EAAOmD,MACfC,EAAcpD,EAAOoD,YACrBnB,EAAajC,EAAOiC,WACpBlD,EAAatM,EAAO/+C,OACpBsrD,EAAcvM,EAAOnF,OACrB2R,EAAgBxM,EAAOlF,SACvB6e,EAAc3Z,EAAOl8B,MACrBkxD,EAAwD,IAA5Crb,EAAclhB,GAAkBqU,QAC5C2N,EAAiB7hB,GAA2B8hB,iBAAkBf,GAGhEniE,EAAI,EACJy9E,EAAQ,EACRC,EAAQ,EACRC,EAAO,EACPC,EAAM,EACNC,EAAO,EACPC,EAAS,EACTC,EAAS,EACTpxB,EAAK,EACLC,EAAK,EACLoxB,EAAS,EACTC,EAAS,EACTC,GAAO,EACPC,GAAW,EACXC,EAAoB,EAAVpoB,EACVqoB,EAAU,EAGRv7D,EAAOizC,EAAOjzC,KACpBA,EAAKxmB,IAAKy4D,EAAa,GAAKA,EAAa,IACzCzN,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMw7D,EAAUx7D,EAAK1mB,EACfmiF,EAAUz7D,EAAKzmB,EACfmiF,EAAc,GAAKtqC,GAAa8gB,EAAe,GAG/CzwB,EAAauwB,EAAa,GAAM,EACtChyC,EAAKxmB,IAAKy4D,EAAaxwB,EAAY,GAAKwwB,EAAaxwB,EAAY,IACjE+iB,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAM27D,EAAS37D,EAAK1mB,EACdsiF,EAAS57D,EAAKzmB,EACdsiF,EAAa,GAAKzqC,GAAa8gB,EAAeF,EAAa,GAG7D8pB,EAAWH,EACXI,EAAWH,EACXI,EAAaH,EACb,EAAI7pB,IACPhyC,EAAKxmB,IAAKy4D,EAAa,GAAKA,EAAa,IACzCzN,EAAkBtkC,MAAOF,EAAMA,GAC/B87D,EAAW97D,EAAK1mB,EAChByiF,EAAW/7D,EAAKzmB,EAChByiF,EAAe,GAAK5qC,GAAa8gB,EAAe,IAI7CwoB,GACH7wB,EAAK8xB,EACL7xB,EAAK8xB,EACLV,EAASM,EACTL,EAASM,EACTL,EAAOS,EACPR,EAAWK,IAEXV,EAASQ,GAAWM,EAAWN,GAC/BP,EAASQ,GAAWM,EAAWN,GAC/B5xB,EAAK2xB,EACL1xB,EAAK2xB,EACLP,EAASY,EACTX,EAASY,EACTX,EAAOM,EACPL,EAAWW,EACXpB,GAAS5mF,KAAKsmE,WAAYzQ,EAAIC,EAAIoxB,EAAQC,GAG1Cv+E,EAAUtB,EAAK,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBltD,EAAUtB,EAAK,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBsM,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB/J,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB9J,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm9E,EACxB7kB,EAAat4D,EAAK,GAAMo9E,EACxB9kB,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm9E,EACxB7kB,EAAat4D,EAAK,GAAMo9E,EACxBjmB,EAAYn3D,EAAK,GAAM+8E,EACvB5lB,EAAYn3D,EAAK,GAAM+8E,EACvBx/E,GAAM,EACNyC,GAAM,GAIP,IAAK,IAA4BgK,EAAOiqD,GAA/BpqD,EAAM8yE,EAAS,EAAI,GAA4B9yE,EAAIG,IAAQH,EAAI,CAMvE,GALAozE,EAASnxB,EACToxB,EAASnxB,EACTD,EAAKqxB,EACLpxB,EAAKqxB,EACLC,EAAOC,EACHzzE,IAAMoqD,EAAa,EACtBkpB,EAASS,EACTR,EAASS,EACTP,EAAWQ,OACL,GAAU,IAANj0E,EACVszE,EAASY,EACTX,EAASY,EACTV,EAAWW,OACL,GAAIp0E,EAAIoqD,EAAa,EAAI,CAC/B,IAAMiqB,EAAar0E,EAAI,GAAM,EAC7BoY,EAAKxmB,IAAKy4D,EAAagqB,EAAY,GAAKhqB,EAAagqB,EAAY,IACjEz3B,EAAkBtkC,MAAOF,EAAMA,GAC/Bk7D,EAASl7D,EAAK1mB,EACd6hF,EAASn7D,EAAKzmB,EACd8hF,EAAa,GAAKjqC,GAAa8gB,EAAetqD,EAAI,QAElDszE,EAASM,EACTL,EAASM,EACTJ,EAAWK,EAEZf,EAAQz9E,EACRA,EAAI09E,EACJA,GAAS5mF,KAAKsmE,WAAYzQ,EAAIC,EAAIoxB,EAAQC,GAE1C,IAAIe,EAAUhB,EACViB,EAAUhB,EACViB,EAAcb,EAClB,GAAIH,EAAO,CACVJ,EAASnxB,GAAMqxB,EAASrxB,GACxBoxB,EAASnxB,GAAMqxB,EAASrxB,GAExBixB,EAAO96E,KAAKC,IAAK66E,EAAMD,GAEvBD,EAAOF,EAAQY,EACfj9B,GAA2BmiB,OAAQoa,EAAM/mD,EAAaurC,EAAar/C,GAGnE,IAFA,IAAM0gD,EAAQ1gD,EAAK1mB,EACbqnE,EAAQ3gD,EAAKzmB,EACViV,EAAI8sE,EAAS9sE,EAAIzQ,EAAK,EAAGyQ,GAAK,EACtC0mD,EAAY1mD,EAAI,GAAMkyD,EACtBxL,EAAY1mD,EAAI,GAAMmyD,EACtBzL,EAAY1mD,EAAI,GAAMqsE,EAEvBS,EAAUv9E,EAAK,EACfq+E,EAAcb,EACdA,EAAUr+E,OACAm+E,IACVa,EAAUryB,GAAMA,EAAKmxB,GACrBmB,EAAUryB,GAAMA,EAAKmxB,IAItBr+E,EAAUtB,EAAK,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBltD,EAAUtB,EAAK,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBsM,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB/J,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB9J,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm+E,EACxB7lB,EAAat4D,EAAK,GAAMo+E,EACxB9lB,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm+E,EACxB7lB,EAAat4D,EAAK,GAAMo+E,EACxBtB,EAAO39E,EAAIk/E,EACXlnB,EAAYn3D,EAAK,GAAM88E,EACvB3lB,EAAYn3D,EAAK,GAAM88E,EAEvB98E,GAAM,EAENnB,GAHAtB,GAAM,GAGS,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBltD,EAAUtB,EAAK,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBsM,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB/J,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB9J,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm+E,EACxB7lB,EAAat4D,EAAK,GAAMo+E,EACxB9lB,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm+E,EACxB7lB,EAAat4D,EAAK,GAAMo+E,EACxBrB,EAAM59E,EAAIq+E,EACVrmB,EAAYn3D,EAAK,GAAM+8E,EACvB5lB,EAAYn3D,EAAK,GAAM+8E,EACvBx/E,GAAM,EACNyC,GAAM,EAyBN,GApBAi9E,EAASnxB,EACToxB,EAASnxB,EACTD,EAAKqxB,EACLpxB,EAAKqxB,EACLC,EAAOC,EACHX,GACHQ,EAASY,EACTX,EAASY,EACTV,EAAWW,IAEXd,EAASrxB,GAAMA,EAAKmxB,GACpBG,EAASrxB,GAAMA,EAAKmxB,GACpBI,GAAW,GAEZV,EAAQz9E,EACRA,EAAI09E,EAEAsB,EAAUhB,EACViB,EAAUhB,EACViB,EAAcb,EACdH,EAAO,CAUV,IATAJ,EAASnxB,GAAMqxB,EAASrxB,GACxBoxB,EAASnxB,GAAMqxB,EAASrxB,GAExBixB,EAAO96E,KAAKC,IAAK66E,EAAMD,GAEvBD,EAAOF,EAAQY,EACfj9B,GAA2BmiB,OAAQoa,EAAM/mD,EAAaurC,EAAar/C,GAC7D0gD,EAAQ1gD,EAAK1mB,EACbqnE,EAAQ3gD,EAAKzmB,EACViV,EAAI8sE,EAAS9sE,EAAIzQ,EAAK,EAAGyQ,GAAK,EACtC0mD,EAAY1mD,EAAI,GAAMkyD,EACtBxL,EAAY1mD,EAAI,GAAMmyD,EACtBzL,EAAY1mD,EAAI,GAAMqsE,EAEvBS,EAAUv9E,EAAK,EACfq+E,EAAcb,EACdA,EAAUr+E,OACAm+E,IACVa,EAAUryB,GAAMA,EAAKmxB,GACrBmB,EAAUryB,GAAMA,EAAKmxB,IA6BtB,GAzBAr+E,EAAUtB,EAAK,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBltD,EAAUtB,EAAK,GAAMuuD,EACrBjtD,EAAUtB,EAAK,GAAMwuD,EACrBsM,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB/J,EAAO96D,EAAK,GAAMw4B,EAClBsiC,EAAO96D,EAAK,GAAM6kE,EAClB9J,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm+E,EACxB7lB,EAAat4D,EAAK,GAAMo+E,EACxB9lB,EAAat4D,EAAK,GAAMi9E,EACxB3kB,EAAat4D,EAAK,GAAMk9E,EACxB5kB,EAAat4D,EAAK,GAAMm+E,EACxB7lB,EAAat4D,EAAK,GAAMo+E,EACxBtB,EAAO39E,EAAIk/E,EACXrB,EAAO96E,KAAKC,IAAK66E,EAAMF,GACvB3lB,EAAYn3D,EAAK,GAAM88E,EACvB3lB,EAAYn3D,EAAK,GAAM88E,EACvBv/E,GAAM,EACNyC,GAAM,EAGN/J,KAAK2S,OAASo0E,EACVO,EAAUv9E,EAIb,GAHAugD,GAA2BmiB,OAAQoa,EAAM/mD,EAAaurC,EAAar/C,GAC7D0gD,EAAQ1gD,EAAK1mB,EACbqnE,EAAQ3gD,EAAKzmB,EACfmhF,EACH,IAAK,IAAI9yE,EAAI0zE,EAAS1zE,EAAI7J,EAAI6J,GAAK,EAClCstD,EAAYttD,EAAI,GAAM84D,EACtBxL,EAAYttD,EAAI,GAAM+4D,EACtBzL,EAAYttD,EAAI,IAAO,OAGxB,IAASA,EAAI0zE,EAAS1zE,EAAI7J,EAAI6J,GAAK,EAClCstD,EAAYttD,EAAI,GAAM84D,EACtBxL,EAAYttD,EAAI,GAAM+4D,EACtBzL,EAAYttD,EAAI,GAAMizE,GAO3BP,yBAAA,SAAcrnB,EAAsB9Q,GACnC,IAAMvoD,EAAU5F,KAAK46C,UAAWuT,GAC1BmS,EAAqBtgE,KAAK2lE,qBAAsB//D,GACtD,GAAIA,IAAY5F,KAAK4F,SAAW06D,IAAuBtgE,KAAKsgE,mBAAqB,CAChFtgE,KAAK4F,QAAUA,EACf5F,KAAKsgE,mBAAqBA,EAE1B,IAAMtC,EAAah+D,KAAKg+D,WACxB,GAAI,GAAKA,EAAa,CACrB,IAAM/0D,EAAajJ,KAAKunE,aAAc3hE,GAChC4B,EAAKyB,EAAWzB,GAChBC,EAAKwB,EAAWxB,GAChBoB,EAAKI,EAAWJ,GAChBC,EAAKG,EAAWH,GAChBpB,EAAKuB,EAAWvB,GAChBC,EAAKsB,EAAWtB,GAChBoB,EAAKE,EAAWF,GAChBC,EAAKC,EAAWD,GAEhBy5D,EAAOh7D,EAAKD,EACZk7D,EAAO/6D,EAAKD,EACZ2gF,EAAOx/E,EAAKC,EACZw/E,EAAOv/E,EAAKC,EAGlBi2D,EAAOlyC,SAASpsB,SAChB,IAAMmH,EAAMm3D,EAAOn3D,IACbo5D,EAAajC,EAAOiC,WACpBqnB,EAASvoF,KAAKomF,aACdlnB,EAAUl/D,KAAKu/D,aAEjBqN,EAAgB,EAAV1N,EACNspB,EAAgB,EAAVtpB,EACJupB,EAAgB,EAAIx8E,KAAKC,IAhhBd,KAghByBlM,KAAK2S,QAC3CxJ,EAAI,EAGFo/E,IACLp/E,EAAI+3D,EAAYsnB,GAAQC,EACxB3gF,EAAK8kE,EAAM,GAAMplE,EAAK2B,EAAIs5D,EAC1B36D,EAAK8kE,EAAM,GAAMllE,EAAKyB,EAAIu5D,EAC1B56D,EAAK8kE,EAAM,GAAM9jE,EAAKK,EAAIk/E,EAC1BvgF,EAAK8kE,EAAM,GAAM5jE,EAAKG,EAAIm/E,EAC1B1b,GAAO,EACP4b,GAAO,GAIR,IAAK,IAAI50E,EAAK20E,EAAS,EAAI,EAAIx0E,EAAOiqD,EAAapqD,EAAGA,EAAIG,IAAQH,EACjEzK,EAAI+3D,EAAYsnB,GAAQC,EACxB3gF,EAAK8kE,EAAM,GAAMplE,EAAK2B,EAAIs5D,EAC1B36D,EAAK8kE,EAAM,GAAMllE,EAAKyB,EAAIu5D,EAC1B56D,EAAK8kE,EAAM,GAAM9jE,EAAKK,EAAIk/E,EAC1BvgF,EAAK8kE,EAAM,GAAM5jE,EAAKG,EAAIm/E,EAC1B1b,GAAO,EAGPzjE,EAAI+3D,EAFJsnB,GAAO,GAEiBC,EACxB3gF,EAAK8kE,EAAM,GAAMplE,EAAK2B,EAAIs5D,EAC1B36D,EAAK8kE,EAAM,GAAMllE,EAAKyB,EAAIu5D,EAC1B56D,EAAK8kE,EAAM,GAAM9jE,EAAKK,EAAIk/E,EAC1BvgF,EAAK8kE,EAAM,GAAM5jE,EAAKG,EAAIm/E,EAC1B1b,GAAO,EACP4b,GAAO,EAIRr/E,EAAI+3D,EAAYsnB,GAAQC,EACxB3gF,EAAK8kE,EAAM,GAAMplE,EAAK2B,EAAIs5D,EAC1B36D,EAAK8kE,EAAM,GAAMllE,EAAKyB,EAAIu5D,EAC1B56D,EAAK8kE,EAAM,GAAM9jE,EAAKK,EAAIk/E,EAC1BvgF,EAAK8kE,EAAM,GAAM5jE,EAAKG,EAAIm/E,QApjBUhkB,kBCJxC,cA4BA,OA3BQokB,SAAP,SACCzpB,EAAsB9Q,EAAe+Q,EAAiBC,GAEtD,IAAMzN,EAASvD,EAAMuD,OACf00B,IAAiB10B,GAAuD,IAA7CA,EAAOl8B,MAAQ20B,GAAkBqU,QAC5DR,EAAetM,EAASA,EAAO/+C,OAAS,EACxCm6D,EAASlK,GAAoB2B,aAAcpW,EAAO8Q,EAAOuF,WACzD3B,EAAUiK,EAAOtN,YACjBsD,EAAUgK,EAAOpN,WACnBN,EAASyD,EACTxD,EAASyD,EAUb,OATI,GAAK9E,IACJooB,GACHhnB,GAAuB,EAAbpB,EAAiB,EAC3BqB,GAAuB,EAAbrB,IAEVoB,GAA6B,GAAlBpB,EAAa,GAAS,EAAI,EACrCqB,GAA6B,GAAlBrB,EAAa,GAAS,IAG/BkB,EAAUE,EAASH,EAAO8N,gBAAkB5N,EAAUE,EAASJ,EAAO+N,cAClE,IAAIsZ,GACVrnB,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,EAAQrB,EAAYooB,GACvEpgE,KAAMmoC,GAEF,yBCfR,WACCp5C,EACA28C,EACAlF,EACAh3B,GAGA,IAAM+2B,EAAmB,GACrBo8B,EAAO,EACPC,EAAO,EACPC,EAAO,EACPC,EAAO,EACLC,EAAer3B,EAAO/+C,OAC5B,GAAI,GAAKo2E,EAAe,CACvBJ,EAAOC,EAAOl3B,EAAQ,GACtBm3B,EAAOC,EAAOp3B,EAAQ,GACtB,IAAK,IAAI99C,EAAI,EAAGA,EAAIm1E,EAAcn1E,GAAK,EAAI,CAC1C,IAAMtO,EAAIosD,EAAQ99C,GACZrO,EAAImsD,EAAQ99C,EAAI,GACtB+0E,EAAO18E,KAAK0iB,IAAKg6D,EAAMrjF,GACvBsjF,EAAO38E,KAAKC,IAAK08E,EAAMtjF,GACvBujF,EAAO58E,KAAK0iB,IAAKk6D,EAAMtjF,GACvBujF,EAAO78E,KAAKC,IAAK48E,EAAMvjF,IAGzB,IAAMg9D,EAAqB,IAAfqmB,EAAOD,GACbnmB,EAAqB,IAAfsmB,EAAOD,GACnB,IAASj1E,EAAI,EAAGA,EAAIm1E,EAAcn1E,GAAK,EAChCtO,EAAIosD,EAAQ99C,EAAI,GAAM2uD,EACtBh9D,EAAImsD,EAAQ99C,EAAI,GAAM4uD,EAC5BjW,EAAO35C,KAAMtN,EAAGC,GAEjB,IAAM4uD,EAAKy0B,EAAOD,EACZv0B,EAAK00B,EAAOD,EAGlB7oF,KAAKsrD,GAAUv2C,EACf/U,KAAKgpF,QAActnF,EACnB1B,KAAKipF,GAAoB18B,EAAO55C,OAChC3S,KAAKurD,GAAUgB,EACfvsD,KAAKwrD,GAAYgB,EAASyN,MAAO,GACjCj6D,KAAKkpF,GAAY,IAAI18D,QAAO2nC,EAAIC,GAChCp0D,KAAKmM,KAAO,IAAIqgB,QAAO2nC,EAAIC,GAC3Bp0D,KAAK6c,SAAW,IAAI2P,QAAO+1C,EAAIC,GAC/BxiE,KAAK6uB,GAAM,EACX7uB,KAAK+0B,GAASS,EA0LhB,OAvLCh2B,sBAAI2pF,0BAAJ,WACC,OAAOnpF,KAAKurD,GAAQ54C,QAAU,mCAGvBw2E,4BAAR,WACC,IAAMh9E,EAAOnM,KAAKmM,KACZgb,EAAannB,KAAKsrD,GAAQn/C,KAC1Bi9E,EAAMjiE,EAAW7hB,EACjB+jF,EAAMliE,EAAW5hB,EAEvB,GADkB,KACF0G,KAAKoT,IAAK+pE,EAAMj9E,EAAK7G,IADnB,KACsC2G,KAAKoT,IAAKgqE,EAAMl9E,EAAK5G,GAAM,CAClF4G,EAAK3G,IAAK4jF,EAAKC,GAEf,IAAMC,EAAWtpF,KAAKkpF,GAChBK,EALW,KAKgBt9E,KAAKoT,IAAKiqE,EAAShkF,GAC9CkkF,EANW,KAMgBv9E,KAAKoT,IAAKiqE,EAAS/jF,GACpD,GAAIgkF,GAAgBC,EAAe,CAClC,IAAMC,EAAWF,EAAeH,EAAME,EAAShkF,EAAI,EAC7CokF,EAAWF,EAAeH,EAAMC,EAAS/jF,EAAI,EAE7CgnD,EAASvsD,KAAKurD,GAChBo+B,EAAa3pF,KAAKgpF,GACtB,GAAkB,MAAdW,EAAqB,CACxBA,EAAa,GACb3pF,KAAKgpF,GAAcW,EAEnB,IAAK,IAAI/1E,EAAI,EAAGG,EAAO/T,KAAK2S,QAAU,EAAGiB,EAAIG,EAAMH,GAAK,EAAI,CAC3D,IAAMtO,EAAIinD,EAAQ34C,GACZrO,EAAIgnD,EAAQ34C,EAAI,GACtB24C,EAAQ34C,GAAMtO,EAAImkF,EAClBl9B,EAAQ34C,EAAI,GAAMrO,EAAImkF,EACtBC,EAAW/2E,KAAMtN,EAAGC,SAGrB,IAASqO,EAAI,EAAGG,EAAO/T,KAAK2S,QAAU,EAAGiB,EAAIG,EAAMH,GAAK,EACvD24C,EAAQ34C,GAAM+1E,EAAY/1E,GAAM61E,EAChCl9B,EAAQ34C,EAAI,GAAM+1E,EAAY/1E,EAAI,GAAM81E,EAG1C1pF,KAAK6uB,IAAO,KAKfrvB,sBAAI2pF,sBAAJ,WAEC,OADAnpF,KAAK4pF,kBACE5pF,KAAK6uB,oCAGbrvB,sBAAI2pF,0BAAJ,WAEC,OADAnpF,KAAK4pF,kBACE5pF,KAAKurD,QAGb,SAAYgB,GACXvsD,KAAKwF,IAAK+mD,OAAQ7qD,OAAWA,oCAG9BlC,sBAAI2pF,4BAAJ,WACC,OAAOnpF,KAAKwrD,QAMb,SAAcgB,GACbxsD,KAAKwF,SAAK9D,EAAW8qD,OAAU9qD,oCAGhClC,sBAAI2pF,yBAAJ,WACC,OAAOnpF,KAAK+0B,QAGb,SAAWS,GACVx1B,KAAKwF,SAAK9D,OAAWA,EAAW8zB,oCAGjC2zD,iBAAA,SAAM93E,GACL,OAAOrR,KAAKwF,IAAK6L,EAAOk7C,OAAQl7C,EAAOm7C,SAAUn7C,EAAOmkB,QAGzD2zD,gBAAA,SAAK18B,EAAsBC,EAAwBC,GAClD,IAAIpnC,GAAU,EACVskE,GAAY,EAGhB,GAAiB,MAAbp9B,EAAoB,CACvB,IAAMF,EAASvsD,KAAKurD,GACdu+B,EAAmB9pF,KAAKipF,GACxBc,EAAkBt9B,EAAU95C,OAC5Bq3E,EAAU/9E,KAAK0iB,IAAKo7D,EAAiBD,GAG3C,GAFA9pF,KAAKgpF,QAActnF,EACnB1B,KAAK6uB,IAAO,EACR09B,IAAWE,EAAY,CAC1B,IAAK,IAAI74C,EAAI,EAAGA,EAAIo2E,IAAWp2E,EAC9B24C,EAAQ34C,GAAM64C,EAAW74C,GAG1B,IAASA,EAAIo2E,EAASp2E,EAAIm2E,IAAmBn2E,EAC5C24C,EAAO35C,KAAM65C,EAAW74C,IAGrBk2E,IAAqBC,GACxBx9B,EAAO55C,OAASo3E,EAChB/pF,KAAKipF,GAAoBc,EACzBxkE,GAAU,GAEVskE,GAAY,OAGTC,IAAqBC,GACxB/pF,KAAKipF,GAAoBc,EACzBxkE,GAAU,GAEVskE,GAAY,EAMf,GAAmB,MAAfn9B,EAAsB,CACzB,IAAMF,EAAWxsD,KAAKwrD,GAEtB,GADAxrD,KAAK6uB,IAAO,EACR29B,IAAaE,EAAc,CAC9B,IAAMu9B,EAAoBv9B,EAAY/5C,OAEtC,IADMq3E,EAAU/9E,KAAK0iB,IAAK69B,EAAS75C,OAAQs3E,GAClCr2E,EAAI,EAAGA,EAAIo2E,IAAWp2E,EAC9B44C,EAAU54C,GAAM84C,EAAa94C,GAG9B,IAASA,EAAIo2E,EAASp2E,EAAIq2E,IAAqBr2E,EAC9C44C,EAAS55C,KAAM85C,EAAa94C,IAGzB44C,EAAS75C,SAAWs3E,IACvBz9B,EAAS75C,OAASs3E,GAGpBJ,GAAY,EAIb,GAAgB,MAAZl9B,EAAmB,CACtB,IAAMu9B,EAAWlqF,KAAK+0B,GAClBm1D,IAAav9B,IAChB3sD,KAAK+0B,GAAS43B,GACTu9B,EAAW//B,GAAkBqU,UAAa7R,EAAWxC,GAAkBqU,QAC3Ej5C,GAAU,EAEVskE,GAAY,GAMf,GAAItkE,EAAU,CACb,IAAMhQ,EAASvV,KAAKsrD,GACpB/1C,EAAO+9C,cAAW5xD,EAClB6T,EAAOgO,eACGsmE,GACV7pF,KAAKsrD,GAAQwB,iBAGd,OAAO9sD,MAGRmpF,kBAAA,SAAOp0E,GACN,OAAO,IAAIo0E,EAAkBp0E,EAAQ/U,KAAKurD,GAASvrD,KAAKwrD,GAAWxrD,KAAK+0B,KAGzEo0D,qBAAA,SAAUtnE,GAGT,IAFA,IAAMthB,EAAkB,GAClBgsD,EAASvsD,KAAKusD,OACX34C,EAAI,EAAGG,EAAOw4C,EAAO55C,OAAQiB,EAAIG,EAAMH,GAAK,EAAI,CACxD,IAAM3O,EAAQ,IAAIunB,QAAO+/B,EAAQ34C,EAAI,GAAK24C,EAAQ34C,EAAI,IACtDrT,EAAOqS,KAAMiP,EAAUqK,MAAOjnB,EAAOA,IAEtC,OAAO1E,GAGR4oF,sBAAA,SAAWp8B,GACV,OAAOA,EAAQ16B,IAAK,IAAIsN,KAAKC,UAAU5/B,KAAKurD,QAAY5rB,KAAKC,UAAU5/B,KAAKwrD,QAAcxrD,KAAK+0B,6BC5OhG,WACCo1D,EACA39B,EACApqD,EACAozB,GAJD,MAMCxvB,YAAO+9C,GAAWqmC,mBACdD,aAAwBE,EAC3BlkF,EAAK87C,KAAMkoC,IAEXhkF,EAAK8pB,KAAKinC,QAAS,EACnB/wD,EAAKooD,OAAO/oD,KAAK,OAAM9D,OAAWA,EAAWU,GAC7C+D,EAAKurD,OAAS,IAAIy3B,GAAkBhjF,EAAMgkF,EAAc39B,EAAWh3B,GACnErvB,EAAK0b,UAAUhF,SAASpX,SAAUU,EAAKurD,OAAO70C,UAC9C1W,EAAKgG,KAAK1G,SAAUU,EAAKurD,OAAOvlD,SAOnC,OA1BgCrM,OAuB/BuqF,kBAAA,WACC,OAAO,IAAIA,EAAYrqF,UAxBO09D,kBCEhC,cA0CA,OAzCQ4sB,gBAAP,SAAsB90E,EAAe+4B,GACpC,GAAI,GAAK/4B,GAASA,EAAQ+4B,EAAU57B,OACnC,IACC,OAAOgtB,KAAKwtB,MAAO5e,EAAW/4B,IAAW,GACxC,MAAOS,IAIV,OAAO,GAGDq0E,cAAP,SACC9oE,EAA8BurC,GAE9B,IAAMxe,EAAYwe,EAAQxe,UACpBye,EAAaxrC,EAAM,IACzB,GAAI,GAAKwrC,GAAcA,EAAaze,EAAU57B,OAAS,CACtD,IAAIu6C,EAASH,EAAQkwB,WAAWjwE,IAAKggD,GACvB,MAAVE,IACHA,EAASvtB,KAAKwtB,MAAO5e,EAAWye,IAChCD,EAAQkwB,WAAWz3E,IAAKwnD,EAAYE,IAErC,IAAMiB,EAAQm8B,EAAYnqF,OACzB+sD,EAAQ,GACRA,EAAQ,GACRK,GAAe4P,aACfjQ,EAAQ,IAET,OAAOgwB,GAAmBziB,YAAaj5C,EAAMurC,EAASoB,GAEvD,OAAO,MAGDm8B,SAAP,SACC54B,EACAlF,EACA1sB,EACAtK,GAEA,OAAO,IAAI60D,GAAY34B,EAAQlF,EAAU1sB,EAAatK,SCzC3C+0D,GAAgB,WAC5BngC,GAAiBrG,GAAWqmC,MAAS1B,GAAoBvoF,OACzD+pD,GAAqBnG,GAAWqmC,MAASE,GAAY7vB,4BCFrD,WAAawE,EAAsBC,EAAiBC,UACnDn5D,YAAOi5D,EAAQC,EAASC,EAAS,EAAG,SAYtC,OAdwCr/D,OAKvC0qF,iBAAA,SAAMr8B,GAGL,OAFAnoD,YAAMggB,eAAMmoC,GACZnuD,KAAK4F,QAAUuoD,EAAMvoD,SAAWgH,UAAQ6zD,MACjCzgE,MAGRwqF,mBAAA,SAAQr8B,QAX+BoS,kBCDxC,cAMA,OALQkqB,SAAP,SACCxrB,EAAsB9Q,EAAe+Q,EAAiBC,GAEtD,OAAO,IAAIqrB,GAAoBvrB,EAAQC,EAASC,GAAUn5C,KAAMmoC,wBCJjE,WAAaxzC,uBAAAA,EAAmBopC,GAAW2mC,MAC1C1kF,YAAO2U,SAMT,OARgC7a,OAK/B6qF,kBAAA,WACC,OAAO,IAAIA,GAAa1oC,KAAMjiD,UANA08D,kBCEhC,cAMA,OALQkuB,cAAP,SACCppE,EAA8BurC,GAE9B,OAAOmwB,GAAmBziB,YAAaj5C,EAAMurC,EAAS,IAAI49B,UCH/CE,GAAgB,WAC5BzgC,GAAiBrG,GAAW2mC,MAASD,GAAoBtqF,OACzD+pD,GAAqBnG,GAAW2mC,MAASE,GAAYnwB,cxDRtD,SAAYyhB,GACXA,mBAEAA,eACAA,2BACAA,qBACAA,uBACAA,4BACAA,oBACAA,sBAEAA,+BACAA,6BACAA,qBACAA,0BACAA,oCACAA,wCAEAA,sBACAA,6BACAA,qBACAA,2BACAA,4BACAA,4CAEAA,iCACAA,wBACAA,wCACAA,oCACAA,4DACAA,0BACAA,kCACAA,uBACAA,sBAjCD,CAAYA,KAAAA,QyDIZ,kBAAA,cA0BA,OAvBQ4O,MAAP,SAAYnwE,GACX,OAAO3a,KAAK+qF,SAAUpwE,IAAUuhE,GAAiB8O,WAG3CF,WAAP,SAAiB38B,EAAkC88B,GAClD,GAAa,MAAT98B,EAAgB,CACnB,GAAInuD,KAAKgN,IAAKmhD,EAAMxzC,MAASswE,EAC5B,OAAO,EAIR,IADA,IAAMx1E,EAAW04C,EAAM14C,SACd7B,EAAI,EAAGG,EAAO0B,EAAS9C,OAAQiB,EAAIG,IAAQH,EACnD,GAAI5T,KAAKkf,SAAUzJ,EAAU7B,GAAKq3E,GACjC,OAAO,EAIV,OAAO,GAGDH,MAAP,SAAYnwE,EAAkBswE,GAC7BjrF,KAAK+qF,SAAUpwE,GAASswE,GAvBlBH,WAAmD,sBCA3D,cAUA,OATQI,cAAP,SACC1pE,EAA8BurC,GAE9B,OAAOmwB,GAAmBziB,YAAaj5C,EAAMurC,EAASm+B,EAAiB/qF,WAGjE+qF,SAAP,WACC,OAAO,IAAI9G,SCLA+G,GAAqB,WACjC/gC,GAAiBrG,GAAWogC,WAAcuB,GAAyBvlF,OACnE+pD,GAAqBnG,GAAWogC,WAAc+G,GAAiBzwB,YAC/DqwB,GAAmBtlF,IAClBu+C,GAAWogC,UACXjI,GAAiB8O,UAAY9O,GAAiB7e,6BCPhD,4DAs2CA,OAt2CoDv9D,OACnDsrF,iBAAA,SAAMj9B,GACLnoD,YAAMggB,eAAMmoC,GACZ,IAAM8Q,EAASj/D,KAAKi/D,OACdC,EAAUl/D,KAAKu/D,aACfJ,EAAUn/D,KAAKy/D,YAGrBR,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QACnBD,EAAe,EAAVu3D,EA6GT,OA1GAt3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAI9Br3D,GAHAD,GAAM,GAGQ,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAI9Br3D,GAHAD,GAAM,GAGQ,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAI9Br3D,GAHAD,GAAM,GAGQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAI9Br3D,GAHAD,GAAM,GAGQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAG9Br3D,GAFAD,GAAM,GAEQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAI9Br3D,GAHAD,GAAM,GAGQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAG9Br3D,GAFAD,GAAM,GAEQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAI9Br3D,GAHAD,GAAM,GAGQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAG9Br3D,GAFAD,GAAM,GAEQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAI9Br3D,GAHAD,GAAM,GAGQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAG9Br3D,GAFAD,GAAM,GAEQ,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,GAG9Bl/D,KAAKwrE,WAELxrE,KAAKW,OAAQwtD,GACNnuD,MAGRorF,mBAAA,SAAQj9B,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACpBj/D,KAAKqrF,kBAAmBpsB,EAAQ9Q,GAChCnuD,KAAKsrF,oBAAqBrsB,EAAQ9Q,GAClCnuD,KAAKgsE,YAAa/M,EAAQ9Q,GAC1BnuD,KAAKurF,gBAAiBtsB,EAAQ9Q,GAC9BnuD,KAAKwrF,cAAevsB,EAAQ9Q,GAC5BnuD,KAAK05B,WAAYulC,EAAQ9Q,IAMhBi9B,8BAAV,SAA6BnsB,EAAsB9Q,GAClD,IAAMhiD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACb+5D,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5ChrD,EAASgrD,EAAMhrD,OACfsoE,EACL1f,IAAU/rD,KAAK+rD,OACfC,IAAUhsD,KAAKgsD,OACf7oD,IAAWnD,KAAKmD,OAEXyoE,EAAuB5rE,KAAKs/D,mBAAqBA,EACjD/Q,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MACrBk8E,EAAoBx+E,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,EACnF,GAAI2rC,GAAiBG,GAAsB4S,EAAkB,CAC5Dx+E,KAAK+rD,MAAQA,EACb/rD,KAAKgsD,MAAQA,EACbhsD,KAAKs/D,iBAAmBA,EACxBt/D,KAAKmD,OAASA,EACVsoE,IAEHzrE,KAAKiD,OAASyD,IAGd1G,KAAKsgE,mBAAqB55D,KAG3B1G,KAAK8/B,YAAcp5B,IAGnB1G,KAAK8jE,sBAAwBp9D,IAC7Bu4D,EAAOnyC,aAAansB,SAiCpB,IAAMoZ,EAAIqmD,EAActgC,EAClBq0B,EAAa,GAARpI,GAAe,GAAKA,GAAShyC,GAAKA,GACvCq6C,EAAa,GAARpI,GAAe,GAAKA,GAASjyC,GAAKA,GACvCk7C,EAAKhpD,KAAKoT,IAAK80C,GACfe,EAAKjpD,KAAKoT,IAAK+0C,GACf5mC,EAAIrqB,EAAS8I,KAAK0iB,IAAKsmC,EAAIC,GAC3B4rB,EAAKtzD,EAAIynC,EACT+rB,EAAKxzD,EAAI0nC,EAET1E,EAAoBrC,EAAMtsC,UAAU2uC,kBACpCxkC,EAAOizC,EAAOjzC,KACpBA,EAAKxmB,KAAM2uD,GAAKC,GAChB5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMxkB,EAAKwkB,EAAK1mB,EACVoC,EAAKskB,EAAKzmB,EAChBymB,EAAKxmB,IAAK,GAAI4uD,GACd5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMnjB,EAAKmjB,EAAK1mB,EACVyD,EAAKijB,EAAKzmB,EACVkmF,EAAM5iF,EAAKrB,EACXkkF,EAAM3iF,EAAKrB,EACXikF,EAAO7K,EAAK2K,EACZG,EAAO9K,EAAK4K,EACZjkF,EAAKD,EAAKmkF,EACVhkF,EAAKD,EAAKkkF,EACVnN,EAAK51E,EAAK4iF,EACV/M,EAAK31E,EAAK2iF,EACV5iF,EAAK21E,EAAKkN,EACV3iF,EAAK01E,EAAKkN,EACVC,EAAMr7B,EAAkBkE,GACxBo3B,EAAMt7B,EAAkBmE,GACxBo3B,EAAMF,EAAMhjF,EACZmjF,EAAMF,EAAM/iF,EACZkjF,EAAOjL,EAAK+K,EACZG,EAAOlL,EAAKgL,EACZrN,EAAK91E,EAAKojF,EACVrN,EAAK71E,EAAKmjF,EACVC,EAAKxN,EAAK8M,EACVW,EAAKxN,EAAK8M,EACVW,EAAKF,EAAKR,EACVW,EAAKF,EAAKR,EACVW,EAAK5N,EAAK8M,EACVe,EAAK5N,EAAK8M,EACVe,EAAKF,EAAKZ,EACVe,EAAKF,EAAKZ,EACV/G,EAAMgH,EAAMJ,EACZ3G,GAAMgH,EAAMJ,EACZiB,GAAMd,EAAMJ,EACZmB,GAAMd,EAAMJ,EACZmB,GAAMhB,EAAME,EACZe,GAAMhB,EAAME,EACZe,GAAMF,GAAMZ,EACZe,GAAMF,GAAMZ,EACZe,GAAMF,GAAMtB,EACZyB,GAAMF,GAAMtB,EACZyB,GAAMF,GAAMtB,EACZyB,GAAMF,GAAMtB,EACZyB,GAAMN,GAAMtB,EACZ6B,GAAMN,GAAMtB,EACZ6B,GAAMF,GAAM1B,EACZ6B,GAAMF,GAAM1B,EACZ6B,GAAMZ,GAAMpB,EACZiC,GAAMZ,GAAMpB,EACZiC,GAAMF,GAAM9B,EACZiC,GAAMF,GAAM9B,EACZiC,GAAMhB,GAAMpB,EACZqC,GAAMhB,GAAMpB,EACZqC,GAAMF,GAAMlC,EACZqC,GAAMF,GAAMlC,EAGlB5rF,KAAK+/D,eAAiB//D,KAAKsmE,WAAY9+D,EAAIE,EAAImB,EAAIE,GACnD/I,KAAKggE,eAAiBhgE,KAAKsmE,WAAY9+D,EAAIE,EAAIm9E,EAAKC,IACpD9kF,KAAKmgE,WAAangE,KAAKsmE,WAAY9+D,EAAIE,EAAID,EAAIE,GAG/C,IAAMu3D,GAAUl/D,KAAKu/D,aACf32D,GAAWq2D,EAAOr2D,SACpBtB,GAAe,EAAV43D,GAGTt2D,GAAUtB,GAAK,GAAME,EACrBoB,GAAUtB,GAAK,GAAMI,EACrBkB,GAAUtB,GAAK,GAAMG,EACrBmB,GAAUtB,GAAK,GAAMK,EACrBiB,GAAUtB,GAAK,GAAM6kF,EACrBvjF,GAAUtB,GAAK,GAAM8kF,EACrBxjF,GAAUtB,GAAK,GAAM+kF,EACrBzjF,GAAUtB,GAAK,GAAMglF,EAIrB1jF,IAHAtB,IAAM,GAGS,GAAMwB,EACrBF,GAAUtB,GAAK,GAAM0B,EACrBJ,GAAUtB,GAAK,GAAMm3E,EACrB71E,GAAUtB,GAAK,GAAMo3E,EACrB91E,GAAUtB,GAAK,GAAMmlF,EACrB7jF,GAAUtB,GAAK,GAAMolF,EACrB9jF,GAAUtB,GAAK,GAAMilF,EACrB3jF,GAAUtB,GAAK,GAAMklF,EAIrB5jF,IAHAtB,IAAM,GAGS,GAAM2lF,GACrBrkF,GAAUtB,GAAK,GAAM4lF,GACrBtkF,GAAUtB,GAAK,GAAM6lF,GACrBvkF,GAAUtB,GAAK,GAAM8lF,GACrBxkF,GAAUtB,GAAK,GAAMmmF,GACrB7kF,GAAUtB,GAAK,GAAMomF,GACrB9kF,GAAUtB,GAAK,GAAMqmF,GACrB/kF,GAAUtB,GAAK,GAAMsmF,GAIrBhlF,IAHAtB,IAAM,GAGS,GAAMimF,GACrB3kF,GAAUtB,GAAK,GAAMkmF,GACrB5kF,GAAUtB,GAAK,GAAM+lF,GACrBzkF,GAAUtB,GAAK,GAAMgmF,GACrB1kF,GAAUtB,GAAK,GAAMymF,GACrBnlF,GAAUtB,GAAK,GAAM0mF,GACrBplF,GAAUtB,GAAK,GAAMumF,GACrBjlF,GAAUtB,GAAK,GAAMwmF,GAIrBllF,IAHAtB,IAAM,GAGS,GAAMG,EACrBmB,GAAUtB,GAAK,GAAMK,EACrBiB,GAAUtB,GAAK,GAAMuB,EACrBD,GAAUtB,GAAK,GAAMyB,EACrBH,GAAUtB,GAAK,GAAMwB,EACrBF,GAAUtB,GAAK,GAAM0B,EAIrBJ,IAHAtB,IAAM,GAGS,GAAM6kF,EACrBvjF,GAAUtB,GAAK,GAAM8kF,EACrBxjF,GAAUtB,GAAK,GAAM+kF,EACrBzjF,GAAUtB,GAAK,GAAMglF,EACrB1jF,GAAUtB,GAAK,GAAMq3E,EACrB/1E,GAAUtB,GAAK,GAAMs3E,EACrBh2E,GAAUtB,GAAK,GAAMmlF,EACrB7jF,GAAUtB,GAAK,GAAMolF,EACrB9jF,GAAUtB,GAAK,GAAMilF,EACrB3jF,GAAUtB,GAAK,GAAMklF,EAIrB5jF,IAHAtB,IAAM,IAGS,GAAMu9E,EACrBj8E,GAAUtB,GAAK,GAAMw9E,GACrBl8E,GAAUtB,GAAK,GAAMukF,EACrBjjF,GAAUtB,GAAK,GAAMwkF,EACrBljF,GAAUtB,GAAK,GAAMukF,EACrBjjF,GAAUtB,GAAK,GAAMwkF,EACrBljF,GAAUtB,GAAK,GAAMqlF,GACrB/jF,GAAUtB,GAAK,GAAMslF,GAIrBhkF,IAHAtB,IAAM,GAGS,GAAM2lF,GACrBrkF,GAAUtB,GAAK,GAAM4lF,GACrBtkF,GAAUtB,GAAK,GAAM6lF,GACrBvkF,GAAUtB,GAAK,GAAM8lF,GACrBxkF,GAAUtB,GAAK,GAAMylF,GACrBnkF,GAAUtB,GAAK,GAAM0lF,GACrBpkF,GAAUtB,GAAK,GAAMimF,GACrB3kF,GAAUtB,GAAK,GAAMkmF,GACrB5kF,GAAUtB,GAAK,GAAM+lF,GACrBzkF,GAAUtB,GAAK,GAAMgmF,GAIrB1kF,IAHAtB,IAAM,IAGS,GAAMqmF,GACrB/kF,GAAUtB,GAAK,GAAMsmF,GACrBhlF,GAAUtB,GAAK,GAAMulF,GACrBjkF,GAAUtB,GAAK,GAAMwlF,GACrBlkF,GAAUtB,GAAK,GAAMymF,GACrBnlF,GAAUtB,GAAK,GAAM0mF,KAOb5C,gCAAV,SAA+BnsB,EAAsB9Q,GACpD,IAAMlrD,EAASkrD,EAAMlrD,OACrB,GAAIA,IAAWjD,KAAKiD,OAAS,CAC5BjD,KAAKiD,OAASA,EAGdjD,KAAK8/B,YAAcp5B,IAGnBu4D,EAAOgM,eAAetqE,SACtB,IAAM2hE,EAAYrD,EAAOqD,UAErBiJ,EAAe,EADHvrE,KAAKu/D,aAEf0uB,EAAM,EAAIjuF,KAAKmgE,WAAangE,KAAK+/D,eACjCmuB,EAAM,EAAIluF,KAAKmgE,WAAangE,KAAKggE,eAGnC/8D,EAASmoD,GAAa5hD,UACzB84D,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,IAENjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,GAIHtoE,EAASmoD,GAAa1hD,WACzB44D,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,IAENjJ,EAAWiJ,EAAK,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,GAIHtoE,EAASmoD,GAAaxhD,aACzB04D,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,IAENjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,GAIHtoE,EAASmoD,GAAathD,cACzBw4D,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,IAENjJ,EAAWiJ,EAAK,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,GAIPjJ,EAAWiJ,EAAK,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAItBjJ,GAHAiJ,GAAM,GAGU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAItBjJ,GAHAiJ,GAAM,GAGU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAItBjJ,GAHAiJ,GAAM,GAGU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM2iB,EACtB5rB,EAAWiJ,EAAK,GAAM,EAItBjJ,GAHAiJ,GAAM,GAGU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EAGtBjJ,GAFAiJ,GAAM,GAEU,GAAM0iB,EACtB3rB,EAAWiJ,EAAK,GAAM,EACtBjJ,EAAWiJ,EAAK,GAAM,EACtBA,GAAM,IAIE6f,4BAAV,SAA2BnsB,EAAsB9Q,GAChD,IAAMI,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MACrB+9D,EAAalS,EAAMI,OAAOiJ,KAChC,GAAIx3D,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,GAAeugC,IAAergE,KAAKqgE,WAAa,CAC5GrgE,KAAK8/B,YAAcA,EACnB9/B,KAAKogE,YAAcA,EACnBpgE,KAAKqgE,WAAaA,EAClBpB,EAAO0L,WAAWhqE,SAClBs+D,EAAO2L,gBAAgBjqE,SAEvB,IAAMqrB,EAAOizC,EAAO4f,SACpB7+E,KAAK8+E,SAAU9+E,KAAKmgE,WAAYrgC,EAAa9T,GAC7C,IAAM41C,EAAM51C,EAAM,GACZ01C,EAAM11C,EAAM,GACZ21C,EAAM31C,EAAM,GAElBhsB,KAAK8+E,SAAU9+E,KAAK+/D,eAAgBjgC,EAAa9T,GACjD,IAAM81C,EAAM91C,EAAM,GACZg2C,EAAMh2C,EAAM,GACZk2C,EAAMl2C,EAAM,GAElBhsB,KAAK8+E,SAAU9+E,KAAKggE,eAAgBlgC,EAAa9T,GACjD,IAAM+1C,EAAM/1C,EAAM,GACZi2C,EAAMj2C,EAAM,GACZm2C,EAAMn2C,EAAM,GAEZkzC,EAAUl/D,KAAKu/D,aACf6C,EAAQnD,EAAOmD,MACfC,EAAcpD,EAAOoD,YACvB/xD,EAAe,EAAV4uD,EACLn1D,EAAe,EAAVm1D,EACH+uB,EAAM,EAAIjuF,KAAKmgE,WAAangE,KAAK+/D,eACjCmuB,EAAM,EAAIluF,KAAKmgE,WAAangE,KAAKggE,eAEnC+kB,EAAMhjB,EACNijB,EAAM/iB,EACNksB,EAAOvsB,EACPwsB,EAAO1sB,EACJrB,EAAahV,GAAiBlgD,MACpC45E,EAAM,EACNC,EAAM7iB,EACNgsB,EAAO,EACPC,EAAOzsB,GAER,IAAIsjB,EAAMnjB,EACNojB,EAAMljB,EACNqsB,EAAOzsB,EACP0sB,EAAO5sB,EACJrB,EAAahV,GAAiB5/C,QACpCw5E,EAAM,EACNC,EAAMhjB,EACNmsB,EAAO,EACPC,EAAO3sB,GAER,IAAIwjB,EAAMpjB,EACNqjB,EAAMnjB,EACNssB,EAAO3sB,EACP4sB,EAAO9sB,EACJrB,EAAahV,GAAiBhgD,SACpC85E,EAAM,EACNC,EAAMjjB,EACNosB,EAAO,EACPC,EAAO7sB,GAER,IAAI0jB,EAAMvjB,EACNwjB,EAAMtjB,EACNysB,EAAO7sB,EACP8sB,EAAOhtB,EACJrB,EAAahV,GAAiB9/C,OACpC85E,EAAM,EACNC,EAAMpjB,EACNusB,EAAO,EACPC,EAAO/sB,GAER,IAAMgtB,EAAO,IAAOrJ,EAAMJ,GACpB0J,EAAO,IAAO5J,EAAMI,GAGpBniF,EAASjD,KAAKiD,OAChBA,EAASmoD,GAAa5hD,UACzB44D,EAAO9xD,EAAK,GAAMm+E,EAClBrsB,EAAO9xD,EAAK,GAAM69E,EAClB9rB,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM69E,EAClB9rB,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAMm+E,EAClBrsB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EACxBrxD,GAAM,EACNvG,GAAM,IAENq4D,EAAO9xD,EAAK,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EACxB7xD,GAAM,EACNvG,GAAM,GAIH9G,EAASmoD,GAAa1hD,WACzB04D,EAAO9xD,EAAK,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM69E,EAClB9rB,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+9E,EAClBjsB,EAAO9xD,EAAK,GAAM69E,EAClB9rB,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+9E,EAClBjsB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMqkF,EACxB/rB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EACxBrxD,GAAM,EACNvG,GAAM,IAENq4D,EAAO9xD,EAAK,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EACxB7xD,GAAM,EACNvG,GAAM,GAIH9G,EAASmoD,GAAaxhD,aACzBw4D,EAAO9xD,EAAK,GAAMm+E,EAClBrsB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAMm+E,EAClBrsB,EAAO9xD,EAAK,GAAMi+E,EAClBlsB,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAMi+E,EAClBlsB,EAAat4D,EAAK,GAAM2kF,EACxBrsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EACxBrxD,GAAM,EACNvG,GAAM,IAENq4D,EAAO9xD,EAAK,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EACxB7xD,GAAM,EACNvG,GAAM,GAIH9G,EAASmoD,GAAathD,cACzBs4D,EAAO9xD,EAAK,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+9E,EAClBjsB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAMi+E,EAClBlsB,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EAExB53D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+9E,EAClBjsB,EAAO9xD,EAAK,GAAMi+E,EAClBlsB,EAAat4D,EAAK,GAAMukF,EACxBjsB,EAAat4D,EAAK,GAAMykF,EACxBnsB,EAAat4D,EAAK,GAAM43D,EACxBU,EAAat4D,EAAK,GAAM43D,EACxBrxD,GAAM,EACNvG,GAAM,IAENq4D,EAAO9xD,EAAK,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EACxB7xD,GAAM,EACNvG,GAAM,GAIPq4D,EAAO9xD,EAAK,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAM4kF,EACxBtsB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAClB1iB,EAAat4D,EAAK,GAAM4kF,EACxBtsB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAM4kF,EACxBtsB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAMy0E,EAAMmJ,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMi7E,EACxB3iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAM6kF,EACxBvsB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAM6kF,EACxBvsB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAM6kF,EACxBvsB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAM,EAClB+xD,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAM6kF,EACxBvsB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM+0E,EAClBjjB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAM4kF,EACxBtsB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAClB7iB,EAAO9xD,EAAK,GAAM60E,EAAM+I,EACxB7rB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAGNq4D,GAJA9xD,GAAM,GAIM,GAAM+0E,EAAM4I,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMu7E,EACxBjjB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM,EAClB8xD,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAM4kF,EACxBtsB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EAExBp4D,GAAM,EAENq4D,GAHA9xD,GAAM,GAGM,GAAM20E,EAAMgJ,EACxB7rB,EAAO9xD,EAAK,GAAM60E,EAClB9iB,EAAat4D,EAAK,GAAMm7E,EACxB7iB,EAAat4D,EAAK,GAAMq7E,EACxB/iB,EAAat4D,EAAK,GAAMm4D,EACxBG,EAAat4D,EAAK,GAAMo4D,EACxB7xD,GAAM,EACNvG,GAAM,IAIEqhF,0BAAV,SAAyBnsB,EAAsB9Q,GAC9C,IAAMvoD,EAAU5F,KAAK46C,UAAWuT,GAC1BmS,EAAqBtgE,KAAK2lE,qBAAsB//D,GACtD,GAAIA,IAAY5F,KAAK4F,SAAW06D,IAAuBtgE,KAAKsgE,mBAAqB,CAChFtgE,KAAK4F,QAAUA,EACf5F,KAAKsgE,mBAAqBA,EAE1B,IAAMr3D,EAAajJ,KAAKunE,aAAc3hE,GAChC4B,EAAKyB,EAAWzB,GAChBC,EAAKwB,EAAWxB,GAChBoB,EAAKI,EAAWJ,GAChBC,EAAKG,EAAWH,GAChBpB,EAAKuB,EAAWvB,GAChBC,EAAKsB,EAAWtB,GAChBoB,EAAKE,EAAWF,GAChBC,EAAKC,EAAWD,GAEhBy1E,EAAK,IAAOj3E,EAAKC,GACjBi3E,EAAK,IAAOh3E,EAAKC,GACjBwkF,EAAK,IAAOrjF,EAAKD,GACjBujF,EAAK,IAAOpjF,EAAKD,GAEjB8lF,EAAO,GAAM7uF,KAAKmgE,WAAangE,KAAK+/D,eACpC+uB,EAAO,GAAM9uF,KAAKmgE,WAAangE,KAAKggE,eACpCtB,EAAMmwB,GAAQpnF,EAAKD,GACnBm3D,EAAMkwB,GAAQlnF,EAAKD,GACnBk3D,EAAMkwB,GAAQhmF,EAAKtB,GACnBq3D,EAAMiwB,GAAQ9lF,EAAKtB,GAGzBu3D,EAAOlyC,SAASpsB,SAChB,IAAMmH,EAAMm3D,EAAOn3D,IAEf8kE,EAAgB,EADJ5sE,KAAKu/D,aAIrBz3D,EAAK8kE,EAAM,GAAMplE,EACjBM,EAAK8kE,EAAM,GAAMllE,EACjBI,EAAK8kE,EAAM,GAAMplE,EAAKk3D,EACtB52D,EAAK8kE,EAAM,GAAMllE,EAAKi3D,EACtB72D,EAAK8kE,EAAM,GAAMplE,EAAKo3D,EACtB92D,EAAK8kE,EAAM,GAAMllE,EAAKm3D,EACtB/2D,EAAK8kE,EAAM,GAAMplE,EAAKk3D,EAAME,EAC5B92D,EAAK8kE,EAAM,GAAMllE,EAAKi3D,EAAME,EAI5B/2D,GAHA8kE,GAAO,GAGI,GAAMnlE,EAAKi3D,EACtB52D,EAAK8kE,EAAM,GAAMjlE,EAAKg3D,EACtB72D,EAAK8kE,EAAM,GAAMnlE,EACjBK,EAAK8kE,EAAM,GAAMjlE,EACjBG,EAAK8kE,EAAM,GAAMnlE,EAAKi3D,EAAME,EAC5B92D,EAAK8kE,EAAM,GAAMjlE,EAAKg3D,EAAME,EAC5B/2D,EAAK8kE,EAAM,GAAMnlE,EAAKm3D,EACtB92D,EAAK8kE,EAAM,GAAMjlE,EAAKk3D,EAItB/2D,GAHA8kE,GAAO,GAGI,GAAM9jE,EAAK81D,EACtB92D,EAAK8kE,EAAM,GAAM5jE,EAAK61D,EACtB/2D,EAAK8kE,EAAM,GAAM9jE,EAAK41D,EAAME,EAC5B92D,EAAK8kE,EAAM,GAAM5jE,EAAK21D,EAAME,EAC5B/2D,EAAK8kE,EAAM,GAAM9jE,EACjBhB,EAAK8kE,EAAM,GAAM5jE,EACjBlB,EAAK8kE,EAAM,GAAM9jE,EAAK41D,EACtB52D,EAAK8kE,EAAM,GAAM5jE,EAAK21D,EAItB72D,GAHA8kE,GAAO,GAGI,GAAM/jE,EAAK61D,EAAME,EAC5B92D,EAAK8kE,EAAM,GAAM7jE,EAAK41D,EAAME,EAC5B/2D,EAAK8kE,EAAM,GAAM/jE,EAAK+1D,EACtB92D,EAAK8kE,EAAM,GAAM7jE,EAAK81D,EACtB/2D,EAAK8kE,EAAM,GAAM/jE,EAAK61D,EACtB52D,EAAK8kE,EAAM,GAAM7jE,EAAK41D,EACtB72D,EAAK8kE,EAAM,GAAM/jE,EACjBf,EAAK8kE,EAAM,GAAM7jE,EAIjBjB,GAHA8kE,GAAO,GAGI,GAAMplE,EAAKk3D,EACtB52D,EAAK8kE,EAAM,GAAMllE,EAAKi3D,EACtB72D,EAAK8kE,EAAM,GAAM6R,EACjB32E,EAAK8kE,EAAM,GAAM8R,EACjB52E,EAAK8kE,EAAM,GAAMnlE,EAAKi3D,EACtB52D,EAAK8kE,EAAM,GAAMjlE,EAAKg3D,EAItB72D,GAHA8kE,GAAO,GAGI,GAAMplE,EAAKo3D,EACtB92D,EAAK8kE,EAAM,GAAMllE,EAAKm3D,EACtB/2D,EAAK8kE,EAAM,GAAMplE,EAAKo3D,EAAMF,EAC5B52D,EAAK8kE,EAAM,GAAMllE,EAAKm3D,EAAMF,EAC5B72D,EAAK8kE,EAAM,GAAM6R,EAAK7f,EACtB92D,EAAK8kE,EAAM,GAAM8R,EAAK7f,EACtB/2D,EAAK8kE,EAAM,GAAMnlE,EAAKm3D,EAAMF,EAC5B52D,EAAK8kE,EAAM,GAAMjlE,EAAKk3D,EAAMF,EAC5B72D,EAAK8kE,EAAM,GAAMnlE,EAAKm3D,EACtB92D,EAAK8kE,EAAM,GAAMjlE,EAAKk3D,EAItB,IAAM2mB,EAAM,IAAOh+E,EAAKqB,GAClB48E,EAAM,IAAO/9E,EAAKqB,GACxBjB,GALA8kE,GAAO,IAKI,GAAM,IAAOplE,EAAKsB,GAC7BhB,EAAK8kE,EAAM,GAAM,IAAOllE,EAAKsB,GAC7BlB,EAAK8kE,EAAM,GAAM4Y,EACjB19E,EAAK8kE,EAAM,GAAM6Y,EACjB39E,EAAK8kE,EAAM,GAAM4Y,EACjB19E,EAAK8kE,EAAM,GAAM6Y,EACjB39E,EAAK8kE,EAAM,GAAM,IAAOnlE,EAAKoB,GAC7Bf,EAAK8kE,EAAM,GAAM,IAAOjlE,EAAKoB,GAI7BjB,GAHA8kE,GAAO,GAGI,GAAM9jE,EAAK81D,EACtB92D,EAAK8kE,EAAM,GAAM5jE,EAAK61D,EACtB/2D,EAAK8kE,EAAM,GAAM9jE,EAAK81D,EAAMF,EAC5B52D,EAAK8kE,EAAM,GAAM5jE,EAAK61D,EAAMF,EAC5B72D,EAAK8kE,EAAM,GAAMuf,EAAKvtB,EACtB92D,EAAK8kE,EAAM,GAAMwf,EAAKvtB,EACtB/2D,EAAK8kE,EAAM,GAAM/jE,EAAK+1D,EAAMF,EAC5B52D,EAAK8kE,EAAM,GAAM7jE,EAAK81D,EAAMF,EAC5B72D,EAAK8kE,EAAM,GAAM/jE,EAAK+1D,EACtB92D,EAAK8kE,EAAM,GAAM7jE,EAAK81D,EAItB/2D,GAHA8kE,GAAO,IAGI,GAAM9jE,EAAK41D,EACtB52D,EAAK8kE,EAAM,GAAM5jE,EAAK21D,EACtB72D,EAAK8kE,EAAM,GAAMuf,EACjBrkF,EAAK8kE,EAAM,GAAMwf,EACjBtkF,EAAK8kE,EAAM,GAAM/jE,EAAK61D,EACtB52D,EAAK8kE,EAAM,GAAM7jE,EAAK41D,OAn2C2B2F,kBCDpD,cAiBA,OAhBQyqB,SAAP,SACC9vB,EAAsB9Q,EACtB+Q,EAAiBC,GAEjB,IAAM2N,EAASlK,GAAoB2B,aAAcpW,EAAO8Q,EAAOuF,WACzD3B,EAAUiK,EAAOtN,YACjBsD,EAAUgK,EAAOpN,WACjBN,EAAS,GAAKyD,EACdxD,EAAS,GAAKyD,EACpB,OAAI5D,EAAUE,EAASH,EAAO8N,gBAAkB5N,EAAUE,EAASJ,EAAO+N,cAClE,IAAIoe,GACVnsB,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,GACnDr5C,KAAMmoC,GAEF,0BCdR,WAAaxzC,uBAAAA,EAAOopC,GAAWirC,mBAC9BhpF,YAAO2U,SAkJT,OApJ4C7a,OAK3CmvF,kBAAA,WACC,OAAO,IAAIA,GAAyBhtC,KAAMjiD,OAGnCivF,eAAR,SAAsB3pF,EAAWC,EAAW0vD,EAAYC,EAAY/rD,EAAWlG,GAC9E,IAAMwlE,GAAOxT,EAAK9rD,EAClB,GAAI7D,GAAKmjE,EAER,OAAIljE,IADEmjE,GAAOxT,EAAK/rD,IACDlG,EAASmoD,GAAa5hD,UAEhC4V,EAAK9Z,EAAImjE,GAEHrpD,GADNE,EAAK/Z,EAAImjE,GACOppD,GAAMnW,EAAIA,GAE1B+lF,GAAOh6B,EAAK/rD,IACP5D,GAAMtC,EAASmoD,GAAaxhD,aAEhCwV,EAAK9Z,EAAImjE,GAEHrpD,GADNE,EAAK/Z,EAAI2pF,GACO5vE,GAAMnW,EAAIA,GAGxB8rD,GAAM3vD,EAIhB,IAEOojE,EAOCwmB,EAGC9vE,EACAE,EAbH6vE,GAAOl6B,EAAK9rD,EAClB,OAAIgmF,GAAO7pF,EAENC,IADEmjE,GAAOxT,EAAK/rD,IACDlG,EAASmoD,GAAa1hD,WAEhC0V,EAAK9Z,EAAI6pF,GAEH/vE,GADNE,EAAK/Z,EAAImjE,GACOppD,GAAMnW,EAAIA,GAE1B+lF,GAAOh6B,EAAK/rD,IACP5D,GAAMtC,EAASmoD,GAAathD,cAEhCsV,EAAK9Z,EAAI6pF,GAEH/vE,GADNE,EAAK/Z,EAAI2pF,GACO5vE,GAAMnW,EAAIA,EAGzB7D,IAAM2vD,GAIPC,GAAM3vD,GAAKA,IAAM2vD,GAK5B+5B,wBAAA,SAAa3pF,EAAWC,EAAW0vD,EAAYC,GAC9C,GAAIlvD,YAAMgvD,0BAAiB1vD,EAAGC,EAAG0vD,EAAIC,GAAO,CAC3C,IAAMjlC,EAAOjwB,KAAKiwB,KACZs+B,EAASvuD,KAAKuuD,OACdzuB,EAAgByuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EACrD,GAAI6tB,EAAKinC,QAAU,EAAIp3B,EAAc,CACpC,IAAM32B,EAAInJ,KAAKmD,OAAS8I,KAAK0iB,IAAKsmC,EAAIC,GAChCjyD,EAASjD,KAAKiD,OACdo9D,EAAa9R,EAAOiJ,KAC1B,GAAIx3D,KAAKovF,GAAc9pF,EAAGC,EAAG0vD,EAAIC,EAAI/rD,EAAGlG,GAAW,CAClD,GAAIgtB,EAAKinC,OACR,OAAO,EAEP,IAAMmoB,EAAKpzE,KAAKC,IAAK,EAAK+oD,EAAKn1B,GACzBw/C,EAAKrzE,KAAKC,IAAK,EAAKgpD,EAAKp1B,GACzBuvD,EAAKpjF,KAAKC,IAAK,EAAK/C,EAAI22B,GAC9B,IAAM9/B,KAAKovF,GAAc9pF,EAAGC,EAAG85E,EAAIC,EAAI+P,EAAIpsF,GAAW,CACrD,GAAIo9D,IAAehV,GAAiB5D,IACnC,OAAO,EAEP,GAAIniD,IAAM+5E,EAAKgQ,EAAK,CACnB,IAAMC,EAAyD,IAAzCjvB,EAAahV,GAAiB9/C,MACpD,OAAIhG,IAAM+5E,EAAK+P,MACRE,EAAelvB,EAAahV,GAAiBlgD,OACjCmkF,KAEPC,GACFlQ,GAAM95E,IACJ+pF,GACHhqF,IAAM+5E,IAIHC,EAAK+P,GAAM9pF,MAChBiqF,EAAkBnvB,EAAahV,GAAiBhgD,UACjCikF,KAEVE,GACFnQ,GAAM95E,IACJ+pF,GACHhqF,IAAM+5E,GAKPiQ,EAEF,IAAKjQ,EAAKgQ,GAAM/pF,EAAI,CAC1B,IAEOiqF,EAWAC,EAbDC,EAA2D,IAA1CpvB,EAAahV,GAAiB5/C,OACrD,OAAIlG,IAAM+5E,EAAK+P,MACRE,EAAelvB,EAAahV,GAAiBlgD,OACjCskF,KAEPF,GACFlQ,GAAM95E,IACJkqF,IACFpQ,GAAM/5E,IAIJg6E,EAAK+P,GAAM9pF,MAChBiqF,EAAkBnvB,EAAahV,GAAiBhgD,UACjCokF,KAEVD,GACFnQ,GAAM95E,IACJkqF,IACFpQ,GAAM/5E,GAKRmqF,EAGR,OAAIlqF,IAAM+5E,EAAK+P,EACmC,IAAxChvB,EAAahV,GAAiBlgD,MAC5Bm0E,EAAK+P,GAAM9pF,GAC8B,IAA3C86D,EAAahV,GAAiBhgD,WAW/C,OAAO,MAlJmCqxD,kBCA5C,cAUA,OATQgzB,cAAP,SACCluE,EAA8BurC,GAE9B,OAAOmwB,GAAmBziB,YAAaj5C,EAAMurC,EAAS2iC,EAAwBvvF,WAGxEuvF,SAAP,WACC,OAAO,IAAIT,SCLAU,GAA4B,WACxCvlC,GAAiBrG,GAAWirC,mBAAsBD,GAAgC5uF,OAClF+pD,GAAqBnG,GAAWirC,mBAAsBU,GAAwBj1B,YAC9EqwB,GAAmBtlF,IAClBu+C,GAAWirC,kBACX9S,GAAiB8O,UAAY9O,GAAiB7e,YAAc6e,GAAiB0T,+BCT/E,4DAkOA,OAlO4C9vF,OAC3C+vF,iBAAA,SAAM1hC,GACLnoD,YAAMggB,eAAMmoC,GACZ,IAAM8Q,EAASj/D,KAAKi/D,OACdC,EAAUl/D,KAAKu/D,aACfJ,EAAUn/D,KAAKy/D,YAGrBR,EAAOgM,eAAetqE,SACtB,IAAM2hE,EAAYrD,EAAOqD,UACnBh7D,EAAe,EAAV43D,EACXoD,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EAEvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EAEvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EAEvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAGvB23D,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QACjBD,EAAe,EAAVu3D,EAiBX,OAhBAt3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAE9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAE9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAC9Br3D,EAASD,EAAK,GAAMs3D,EAAU,EAG9Bl/D,KAAKwrE,WAELxrE,KAAKW,OAAQwtD,GACNnuD,MAGR6vF,mBAAA,SAAQ1hC,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACpBj/D,KAAK8vF,qBAAsB7wB,EAAQ9Q,GACnCnuD,KAAKgsE,YAAa/M,EAAQ9Q,GAC1BnuD,KAAK+vF,mBAAoB9wB,EAAQ9Q,GACjCnuD,KAAKgwF,iBAAkB/wB,EAAQ9Q,GAC/BnuD,KAAK05B,WAAYulC,EAAQ9Q,IAGhB0hC,iCAAV,SAAgC5wB,EAAsB9Q,GACrD,IAAMhiD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACb+5D,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5Csd,EAAkB1f,IAAU/rD,KAAK+rD,OAASC,IAAUhsD,KAAKgsD,MACzD4f,EAAuB5rE,KAAKs/D,mBAAqBA,EACjD/Q,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MACrBk8E,EAAoBx+E,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,EACnF,GAAI2rC,GAAiBG,GAAsB4S,EAAkB,CAC5Dx+E,KAAK+rD,MAAQA,EACb/rD,KAAKgsD,MAAQA,EACbhsD,KAAKs/D,iBAAmBA,EACpBmM,IAEHzrE,KAAKsgE,mBAAqB55D,KAG3B1G,KAAK8/B,YAAcp5B,IAGnB1G,KAAK8jE,sBAAwBp9D,IAC7Bu4D,EAAOnyC,aAAansB,SAGpB,IAAMoZ,EAAIqmD,EAActgC,EAClBq0B,EAAa,GAARpI,GAAe,GAAKA,GAAShyC,GAAKA,GACvCq6C,EAAa,GAARpI,GAAe,GAAKA,GAASjyC,GAAKA,GAEvCk2E,EAAK,EAAI97B,EAAKC,GAAMD,EADfloD,KAAK0nB,KAAMwgC,EAAKA,EAAK,EAAIC,EAAKA,IAGnC5D,EAAoBrC,EAAMtsC,UAAU2uC,kBACpCxkC,EAAOizC,EAAOjzC,KACpBA,EAAKxmB,IAAK,GAAI4uD,GACd5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMxkB,EAAKwkB,EAAK1mB,EACVoC,EAAKskB,EAAKzmB,EAChBymB,EAAKxmB,KAAM2uD,EAAI,GACf3D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAM0oC,EAAKlE,EAAkBkE,GACvBC,EAAKnE,EAAkBmE,GACvBv1C,EAAKs1C,EAAKltD,EACV8X,EAAKq1C,EAAKjtD,EACVD,EAAKukB,EAAK1mB,EAAI8Z,EACdzX,EAAKqkB,EAAKzmB,EAAI+Z,EACdzW,EAAK6rD,GAAMA,EAAK1oC,EAAK1mB,GAAK8Z,EAC1BrW,EAAK4rD,GAAMA,EAAK3oC,EAAKzmB,GAAK+Z,EAChC0M,EAAKxmB,IAAK,EAAG4uD,EAAK67B,GAClBz/B,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMljB,EAAKkjB,EAAK1mB,EACV0D,EAAKgjB,EAAKzmB,EAGV2qF,EAAKx7B,EAAKt1C,EACV+wE,EAAKx7B,EAAKr1C,EAChBtf,KAAK+/D,eAAiB//D,KAAKsmE,WAAY7+D,EAAIE,EAAIuoF,EAAIC,GACnDnwF,KAAKggE,eAAiBhgE,KAAKsmE,WAAY9+D,EAAIE,EAAIgtD,EAAIC,GACnD30D,KAAKmgE,WAAangE,KAAKsmE,WAAY4pB,EAAIC,EAAIrnF,EAAIE,GAG/C,IAAMk2D,EAAUl/D,KAAKu/D,aACf32D,EAAWq2D,EAAOr2D,SAClBtB,EAAe,EAAV43D,EACXt2D,EAAUtB,EAAM,GAAMwB,EACtBF,EAAUtB,EAAM,GAAM0B,EAEtBJ,EAAUtB,EAAM,GAAME,EACtBoB,EAAUtB,EAAM,GAAMI,EACtBkB,EAAUtB,EAAM,GAAMG,EACtBmB,EAAUtB,EAAM,GAAMK,EAEtBiB,EAAUtB,EAAM,GAAMG,EACtBmB,EAAUtB,EAAM,GAAMK,EACtBiB,EAAUtB,EAAM,GAAMuB,EACtBD,EAAUtB,EAAM,GAAMyB,EAEtBH,EAAUtB,EAAK,IAAOuB,EACtBD,EAAUtB,EAAK,IAAOyB,EACtBH,EAAUtB,EAAK,IAAOE,EACtBoB,EAAUtB,EAAK,IAAOI,IAIdmoF,+BAAV,SAA8B5wB,EAAsB9Q,GACnD,IAAMI,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MAC3B,GAAItC,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,EAAc,CAC1E9/B,KAAK8/B,YAAcA,EACnB9/B,KAAKogE,YAAcA,EACnBnB,EAAO0L,WAAWhqE,SAClBs+D,EAAO2L,gBAAgBjqE,SAEvB,IAAMqrB,EAAOizC,EAAO4f,SACpB7+E,KAAK8+E,SAAU9+E,KAAKmgE,WAAYrgC,EAAa9T,GAC7C,IAAM41C,EAAM51C,EAAM,GACZ01C,EAAM11C,EAAM,GACZ21C,EAAM31C,EAAM,GAEZkzC,EAAUl/D,KAAKu/D,aACfH,EAASp/D,KAAKw/D,YAAcx/D,KAAKokE,gBACvCpkE,KAAK++E,WAAY9f,EAAQC,EAASE,EAAQwC,EAAKA,EAAKF,EAAKA,EAAKC,EAAKA,KAI3DkuB,6BAAV,SAA4B5wB,EAAsB9Q,GACjD,IAAMvoD,EAAU5F,KAAK46C,UAAWuT,GAC1BmS,EAAqBtgE,KAAK2lE,qBAAsB//D,GACtD,GAAIA,IAAY5F,KAAK4F,SAAW06D,IAAuBtgE,KAAKsgE,mBAAqB,CAChFtgE,KAAK4F,QAAUA,EACf5F,KAAKsgE,mBAAqBA,EAE1B,IAAMr3D,EAAajJ,KAAKunE,aAAc3hE,GAChC4B,EAAKyB,EAAWzB,GAChBC,EAAKwB,EAAWxB,GAChBoB,EAAKI,EAAWJ,GAChBC,EAAKG,EAAWH,GAChBpB,EAAKuB,EAAWvB,GAChBC,EAAKsB,EAAWtB,GAChBoB,EAAKE,EAAWF,GAChBC,EAAKC,EAAWD,GAEhBy1E,EAAK,IAAQj3E,EAAKC,GAClBi3E,EAAK,IAAQh3E,EAAKC,GAElBI,EAAI,EAAI,GAAM/H,KAAKmgE,WAAangE,KAAKggE,eACrCmsB,EAAK1N,EAAK12E,GAAMe,EAAKtB,GACrB4kF,EAAK1N,EAAK32E,GAAMiB,EAAKtB,GAG3Bu3D,EAAOlyC,SAASpsB,SAChB,IAAMmH,EAAMm3D,EAAOn3D,IAEb8kE,EAAgB,EADN5sE,KAAKu/D,aAErBz3D,EAAK8kE,EAAO,GAAMuf,EAClBrkF,EAAK8kE,EAAO,GAAMwf,EAElBtkF,EAAK8kE,EAAO,GAAM6R,EAClB32E,EAAK8kE,EAAO,GAAM8R,EAClB52E,EAAK8kE,EAAO,GAAM/jE,EAClBf,EAAK8kE,EAAO,GAAM7jE,EAElBjB,EAAK8kE,EAAO,GAAM/jE,EAClBf,EAAK8kE,EAAO,GAAM7jE,EAClBjB,EAAK8kE,EAAO,GAAM9jE,EAClBhB,EAAK8kE,EAAO,GAAM5jE,EAElBlB,EAAK8kE,EAAM,IAAO9jE,EAClBhB,EAAK8kE,EAAM,IAAO5jE,EAClBlB,EAAK8kE,EAAM,IAAO6R,EAClB32E,EAAK8kE,EAAM,IAAO8R,OA/NuBpa,kBCC5C,cAgBA,OAfQ8rB,SAAP,SACCnxB,EAAsB9Q,EAAe+Q,EAAiBC,GAEtD,IAAM2N,EAASlK,GAAoB2B,aAAcpW,EAAO8Q,EAAOuF,WACzD3B,EAAUiK,EAAOtN,YACjBsD,EAAUgK,EAAOpN,WACjBN,EAAS,EAAIyD,EACbxD,EAAS,EAAIyD,EACnB,OAAI5D,EAAUE,EAASH,EAAO8N,gBAAkB5N,EAAUE,EAASJ,EAAO+N,cAClE,IAAI6iB,GACV5wB,EAAQC,EAASC,EAAS0D,EAASC,EAAS1D,EAAQC,GACnDr5C,KAAMmoC,GAEF,0BCfR,WAAaxzC,uBAAAA,EAAOopC,GAAWssC,UAC9BrqF,YAAO2U,SA2CT,OA7CoC7a,OAKnCwwF,kBAAA,WACC,OAAO,IAAIA,GAAiBruC,KAAMjiD,OAGzBswF,eAAV,SAAwBhrF,EAAWC,EAAWioB,EAAW+iE,EAAapR,GAKrE,OAAU3xD,EAAIloB,EAAIirF,EAAMhrF,GAAK,IAAMioB,EAAIloB,EAAIirF,EAAMhrF,GAAK,GAAKA,GAAK45E,GAGjEmR,wBAAA,SAAahrF,EAAWC,EAAW0vD,EAAYC,GAC9C,GAAIlvD,YAAMgvD,0BAAiB1vD,EAAGC,EAAG0vD,EAAIC,GAAO,CAC3C,IAAM1nC,EAAI,EAAI0nC,EAAKD,EAEnB,GADaj1D,KAAKiwB,KACTinC,QACR,GAAIl3D,KAAKovF,GAAc9pF,EAAGC,EAAGioB,GAAI0nC,GAAKA,GACrC,OAAO,MAEF,CACN,IAAM3G,EAASvuD,KAAKuuD,OACdzuB,EAAcyuB,EAAOnsD,MAC3B,GAAImsD,EAAO2I,QAAU,EAAIp3B,GACpB9/B,KAAKovF,GAAc9pF,EAAGC,EAAGioB,GAAI0nC,GAAKA,GAAO,CAC5C,IACMs7B,EAAK,EAAIv7B,EAAKC,GAAMD,EADfhpD,KAAK0nB,KAAMshC,EAAKA,EAAK,EAAIC,EAAKA,IAGnCsN,EAAKtN,EAAKs7B,EACVD,EAAM/tB,IAAOtN,EAAKsN,GAAMv2D,KAAKC,IAAK,EAAKskF,EAAK1wD,GAAgB0wD,EAC5DrR,EAAMjqB,EAAKp1B,EACjB,IAAM9/B,KAAKovF,GAAc9pF,EAAGC,EAAGioB,EAAG+iE,EAAKpR,GACtC,OAAO,IAMZ,OAAO,MA3C2BziB,kBCEpC,cAUA,OATQ+zB,cAAP,SACCjvE,EAA8BurC,GAE9B,OAAOmwB,GAAmBziB,YAAaj5C,EAAMurC,EAAS0jC,EAAgBtwF,WAGhEswF,SAAP,WACC,OAAO,IAAIH,SCPAI,GAAoB,WAChCtmC,GAAiBrG,GAAWssC,UAAaD,GAAwBjwF,OACjE+pD,GAAqBnG,GAAWssC,UAAaI,GAAgBh2B,4BCH9D,4DAwiBA,OAxiBmD36D,OAClD6wF,iBAAA,SAAMxiC,GACLnoD,YAAMggB,eAAMmoC,GACZ,IAAM8Q,EAASj/D,KAAKi/D,OACdC,EAAUl/D,KAAKu/D,aACfJ,EAAUn/D,KAAKy/D,YAGrBR,EAAOjyC,YAAYrsB,SACnB,IAAMkH,EAAUo3D,EAAOp3D,QACjBD,EAAe,EAAVu3D,EAwEX,OArEAt3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAG/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAE/Br3D,EAASD,EAAM,GAAMs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAG/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,EAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAG/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAG/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAG/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAE/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAC/Br3D,EAASD,EAAK,IAAOs3D,EAAU,GAG/Bl/D,KAAKwrE,WAELxrE,KAAKW,OAAQwtD,GACNnuD,MAGR2wF,mBAAA,SAAQxiC,GACP,IAAM8Q,EAASj/D,KAAKi/D,OACpBj/D,KAAK4wF,4BAA6B3xB,EAAQ9Q,GAC1CnuD,KAAK6wF,8BAA+B5xB,EAAQ9Q,GAC5CnuD,KAAKgsE,YAAa/M,EAAQ9Q,GAC1BnuD,KAAK8wF,0BAA2B7xB,EAAQ9Q,GACxCnuD,KAAK+wF,wBAAyB9xB,EAAQ9Q,GACtCnuD,KAAK05B,WAAYulC,EAAQ9Q,IAGhBwiC,wCAAV,SAAuC1xB,EAAsB9Q,GAC5D,IAAMhiD,EAAOgiD,EAAMhiD,KACb4/C,EAAQ5/C,EAAK7G,EACb0mD,EAAQ7/C,EAAK5G,EACb+5D,EAAmBt/D,KAAK2rE,mBAAoBxd,GAC5ChrD,EAASgrD,EAAMhrD,OACf6tF,EAAoB7tF,IAAWnD,KAAKmD,OACpCsoE,EACL1f,IAAU/rD,KAAK+rD,OACfC,IAAUhsD,KAAKgsD,MAEV4f,EAAuB5rE,KAAKs/D,mBAAqBA,EACjD/Q,EAASJ,EAAMI,OACfzuB,EAAeyuB,EAAO2I,OAAS3I,EAAOnsD,MAAQ,EAC9Cg+D,EAAc7R,EAAOjsD,MACrBk8E,EAAoBx+E,KAAKogE,cAAgBA,GAAepgE,KAAK8/B,cAAgBA,EACnF,GAAI2rC,GAAiBG,GAAsBolB,GAAmBxS,EAAkB,CAC/Ex+E,KAAK+rD,MAAQA,EACb/rD,KAAKgsD,MAAQA,EACbhsD,KAAKs/D,iBAAmBA,EACxBt/D,KAAKmD,OAASA,EACV6tF,IAEHhxF,KAAKiD,OAASyD,MAEX+kE,GAAiBulB,KAEpBhxF,KAAKsgE,mBAAqB55D,KAG3B1G,KAAK8/B,YAAcp5B,IAGnB1G,KAAK8jE,sBAAwBp9D,IAC7Bu4D,EAAOnyC,aAAansB,SAGpB,IAAMoZ,EAAIqmD,EAActgC,EAClBq0B,EAAa,GAARpI,GAAe,GAAKA,GAAShyC,GAAKA,GACvCq6C,EAAa,GAARpI,GAAe,GAAKA,GAASjyC,GAAKA,GACvCk3E,EAAKhlF,KAAK0nB,KAAMwgC,EAAKA,EAAK,EAAIC,EAAKA,GACnC67B,EAAK,EAAI97B,EAAKC,GAAMD,EAAK88B,GACzBjQ,EAAOiP,EAAK9sF,GAAa,EAAIixD,GAC7B88B,EAAO,IAAQD,EAAKhB,GAAO9sF,IAC3B29E,EAAOE,EAAKiQ,GAAS,EAAI98B,GAEzB3D,EAAoBrC,EAAMtsC,UAAU2uC,kBACpCxkC,EAAOizC,EAAOjzC,KACpBA,EAAKxmB,IAAK,GAAI4uD,GACd5D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMvkB,EAAKukB,EAAK1mB,EACVqC,EAAKqkB,EAAKzmB,EAChBymB,EAAKxmB,KAAM2uD,EAAI,GACf3D,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAM0oC,EAAKlE,EAAkBkE,GACvBC,EAAKnE,EAAkBmE,GACvBv1C,EAAKs1C,EAAKjtD,EACV6X,EAAKq1C,EAAKhtD,EACV82E,EAAKzyD,EAAK1mB,EAAI8Z,EACds/D,EAAK1yD,EAAKzmB,EAAI+Z,EACdq/D,EAAKjqB,GAAMA,EAAK1oC,EAAK1mB,GAAK8Z,EAC1Bw/D,EAAKjqB,GAAMA,EAAK3oC,EAAKzmB,GAAK+Z,EAC1B6xE,EAAO1S,EAAKh3E,EACZ2pF,EAAO1S,EAAK/2E,EACZkB,EAAKpB,EAAKypF,EAAKC,EACfpoF,EAAKpB,EAAKupF,EAAKE,EACftoF,EAAK21E,EAAKuC,EAAKmQ,EACfnoF,EAAK01E,EAAKsC,EAAKoQ,EACfC,EAAQvQ,GAAMnC,EAAKF,GACnB6S,EAAQxQ,GAAMlC,EAAKF,GACnByN,EAAK1N,EAAK4S,EACVjF,EAAK1N,EAAK4S,EACVjF,EAAK1N,EAAK0S,EACV/E,EAAK1N,EAAK0S,EACVC,EAAO9pF,EAAKk3E,EACZ6S,EAAO7pF,EAAKi3E,EACZ6N,EAAK9N,EAAKqC,EAAKuQ,EACf7E,EAAK9N,EAAKoC,EAAKwQ,EACfjF,EAAK9kF,EAAKypF,EAAKK,EACf/E,EAAK7kF,EAAKupF,EAAKM,EACrBxlE,EAAKxmB,IAAK,EAAG4uD,EAAK67B,GAClBz/B,EAAkBtkC,MAAOF,EAAMA,GAC/B,IAAMxkB,EAAKwkB,EAAK1mB,EACVoC,EAAKskB,EAAKzmB,EAEVs/E,GAAMp9E,EAAKtE,GAAWqE,EAAKC,GAC3Bq9E,GAAMn9E,EAAKxE,GAAWuE,EAAKC,GAC3BkkF,GAAMpN,EAAKt7E,GAAWqE,EAAKi3E,GAC3BqN,GAAMpN,EAAKv7E,GAAWuE,EAAKg3E,GAC3BiO,GAAMhO,EAAKx7E,GAAWqE,EAAKm3E,GAC3BiO,GAAMhO,EAAKz7E,GAAWuE,EAAKk3E,GAG3BsR,GAAKx7B,EAAKt1C,EACV+wE,GAAKx7B,EAAKr1C,EAChBtf,KAAK+/D,eAAiB+gB,EACtB9gF,KAAKggE,eAAiBghB,EACtBhhF,KAAKigE,eAAiBixB,EACtBlxF,KAAKkgE,eAAiB,EAAI,GAAM+vB,EAAK77B,EACrCp0D,KAAKmgE,WAAangE,KAAKsmE,WAAY4pB,GAAIC,GAAI3oF,EAAIE,GAG/C,IAAMw3D,GAAUl/D,KAAKu/D,aACf32D,GAAWq2D,EAAOr2D,SAClBtB,GAAe,EAAV43D,GAGXt2D,GAAUtB,GAAM,GAAMu9E,GACtBj8E,GAAUtB,GAAM,GAAMw9E,GACtBl8E,GAAUtB,GAAM,GAAMilF,EACtB3jF,GAAUtB,GAAM,GAAMklF,EACtB5jF,GAAUtB,GAAM,GAAMG,EACtBmB,GAAUtB,GAAM,GAAMK,EACtBiB,GAAUtB,GAAM,GAAMuB,EACtBD,GAAUtB,GAAM,GAAMyB,EAGtBH,GAAUtB,GAAM,GAAMukF,GACtBjjF,GAAUtB,GAAM,GAAMwkF,GACtBljF,GAAUtB,GAAK,IAAOwB,EACtBF,GAAUtB,GAAK,IAAO0B,EACtBJ,GAAUtB,GAAK,IAAOm3E,EACtB71E,GAAUtB,GAAK,IAAOo3E,EACtB91E,GAAUtB,GAAK,IAAO6kF,EACtBvjF,GAAUtB,GAAK,IAAO8kF,EAGtBxjF,GAAUtB,GAAK,IAAOqlF,GACtB/jF,GAAUtB,GAAK,IAAOslF,GACtBhkF,GAAUtB,GAAK,IAAO+kF,EACtBzjF,GAAUtB,GAAK,IAAOglF,EACtB1jF,GAAUtB,GAAK,IAAOq3E,EACtB/1E,GAAUtB,GAAK,IAAOs3E,EACtBh2E,GAAUtB,GAAK,IAAOmlF,EACtB7jF,GAAUtB,GAAK,IAAOolF,EAGtB9jF,GAAUtB,GAAK,IAAOE,EACtBoB,GAAUtB,GAAK,IAAOI,EAEtBkB,GAAUtB,GAAK,IAAOu9E,GACtBj8E,GAAUtB,GAAK,IAAOw9E,GAEtBl8E,GAAUtB,GAAK,IAAOuB,EACtBD,GAAUtB,GAAK,IAAOyB,EACtBH,GAAUtB,GAAK,IAAOwB,EACtBF,GAAUtB,GAAK,IAAO0B,EAEtBJ,GAAUtB,GAAK,IAAOukF,GACtBjjF,GAAUtB,GAAK,IAAOwkF,GAEtBljF,GAAUtB,GAAK,IAAO6kF,EACtBvjF,GAAUtB,GAAK,IAAO8kF,EACtBxjF,GAAUtB,GAAK,IAAO+kF,EACtBzjF,GAAUtB,GAAK,IAAOglF,EAEtB1jF,GAAUtB,GAAK,IAAOqlF,GACtB/jF,GAAUtB,GAAK,IAAOslF,GAEtBhkF,GAAUtB,GAAK,IAAOmlF,EACtB7jF,GAAUtB,GAAK,IAAOolF,EACtB9jF,GAAUtB,GAAK,IAAOilF,EACtB3jF,GAAUtB,GAAK,IAAOklF,IAIdmE,0CAAV,SAAyC1xB,EAAsB9Q,GAC9D,IAAMlrD,EAASkrD,EAAMlrD,OACrB,GAAIA,IAAWjD,KAAKiD,OAAS,CAC5BjD,KAAKiD,OAASA,EAGdjD,KAAK8/B,YAAcp5B,IAEnBu4D,EAAOgM,eAAetqE,SACtB,IAAM2hE,EAAYrD,EAAOqD,UAEnBh7D,EAAe,EADLtH,KAAKu/D,aAEfl2D,EAAI,EAAI8kD,EAAMhrD,OAGhBF,EAASmoD,GAAajgD,KACzBm3D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,IAEvBg7D,EAAWh7D,EAAM,GAAM+B,EACvBi5D,EAAWh7D,EAAM,GAAM+B,EACvBi5D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM+B,EACvBi5D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM,EACvBg7D,EAAWh7D,EAAM,GAAM+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,GAIpBrE,EAASmoD,GAAathD,cACzBw4D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,IAEvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,GAIpBrE,EAASmoD,GAAaxhD,aACzB04D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,IAEvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,GAIxBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO+B,EACvBi5D,EAAWh7D,EAAK,IAAO,EACvBg7D,EAAWh7D,EAAK,IAAO,EAEvBg7D,EAAWh7D,EAAK,IAAO,EACvBg7D,E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"}