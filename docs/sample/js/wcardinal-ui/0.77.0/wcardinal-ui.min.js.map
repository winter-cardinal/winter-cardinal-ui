{"version":3,"file":"wcardinal-ui.min.js","sources":["wcardinal/ui/shape/e-shape-deserializers.ts","wcardinal/ui/shape/e-shape-type.ts","wcardinal/ui/shape/e-shape-uploadeds.ts","wcardinal/ui/shape/e-shape-points-style.ts","wcardinal/ui/shape/variant/to-dash.ts","wcardinal/ui/shape/e-shape-text.ts","wcardinal/ui/shape/e-shape-text-align-horizontal.ts","wcardinal/ui/shape/e-shape-text-align-vertical.ts","wcardinal/ui/shape/e-shape-text-direction.ts","wcardinal/ui/shape/variant/to-scale-invariant.ts","wcardinal/ui/shape/variant/build-bar.ts","wcardinal/ui/util/util-character-iterator.ts","wcardinal/ui/shape/variant/to-length.ts","wcardinal/ui/shape/variant/e-shape-bar-position.ts","wcardinal/ui/shape/variant/build-text.ts","../../../node_modules/tslib/tslib.es6.js","wcardinal/ui/shape/variant/e-shape-bar-points.ts","wcardinal/ui/shape/e-shape.ts","wcardinal/ui/d-applications.ts","wcardinal/ui/shape/action/e-shape-action.ts","wcardinal/ui/d-base-state.ts","wcardinal/ui/shape/e-shape-corner.ts","wcardinal/ui/d-base-state-set-data-impl.ts","wcardinal/ui/util/is-function.ts","wcardinal/ui/util/is-string.ts","wcardinal/ui/d-base-state-set-impl.ts","wcardinal/ui/d-base-state-set-impl-observable.ts","wcardinal/ui/shape/e-shape-state.ts","wcardinal/ui/shape/e-shape-state-set-impl-observable.ts","wcardinal/ui/shape/e-shape-transform.ts","wcardinal/ui/util/to-padded.ts","wcardinal/ui/util/util-rgb.ts","wcardinal/ui/shape/variant/e-shape-gradients.ts","wcardinal/ui/shape/variant/e-shape-base.ts","wcardinal/ui/theme/d-themes.ts","wcardinal/ui/shape/e-shape-tag-value.ts","wcardinal/ui/shape/e-shape-tag-value-range.ts","wcardinal/ui/shape/e-shape-defaults.ts","wcardinal/ui/shape/variant/e-shape-fill-impl.ts","wcardinal/ui/shape/variant/e-shape-stroke-impl.ts","wcardinal/ui/shape/variant/e-shape-tag-value-range-impl.ts","wcardinal/ui/shape/e-shape-runtime.ts","wcardinal/ui/shape/variant/e-shape-tag-value-impl.ts","wcardinal/ui/shape/variant/e-shape-tag-impl.ts","wcardinal/ui/shape/variant/e-shape-text-align-impl.ts","wcardinal/ui/shape/variant/e-shape-text-offset-impl.ts","wcardinal/ui/shape/variant/e-shape-text-outline-impl.ts","wcardinal/ui/shape/variant/e-shape-text-impl.ts","wcardinal/ui/shape/variant/e-shape-primitive.ts","wcardinal/ui/shape/variant/e-shape-line-base.ts","wcardinal/ui/shape/variant/e-shape-bar.ts","wcardinal/ui/shape/variant/build-color.ts","wcardinal/ui/shape/e-shape-uploaded.ts","wcardinal/ui/shape/variant/e-shape-text-uploaded.ts","wcardinal/ui/shape/variant/e-shape-bar-uploaded.ts","wcardinal/ui/shape/variant/create-bar-uploaded.ts","wcardinal/ui/util/is-array.ts","wcardinal/ui/util/is-number.ts","wcardinal/ui/util/util-keyboard-event.ts","wcardinal/ui/shape/action/e-shape-action-value-blink-type.ts","wcardinal/ui/shape/action/e-shape-action-bases.ts","wcardinal/ui/shape/action/e-shape-action-expressions.ts","wcardinal/ui/shape/action/e-shape-action-runtime.ts","wcardinal/ui/shape/action/e-shape-action-runtime-conditional.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-brighten.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-color-fill.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-color-stroke.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-darken.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-opacity.ts","wcardinal/ui/shape/action/e-shape-action-runtime-blink-visibility.ts","wcardinal/ui/shape/action/e-shape-action-value-base.ts","wcardinal/ui/shape/action/e-shape-action-value-type.ts","wcardinal/ui/shape/action/e-shape-action-value-subtyped.ts","wcardinal/ui/shape/action/e-shape-action-values.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-target.ts","wcardinal/ui/shape/action/e-shape-action-value-blink.ts","wcardinal/ui/util/util-alpha.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-base.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-type.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-type-legacy.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-types.ts","wcardinal/ui/shape/action/e-shape-action-value-change-text-type.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-brightness.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-brightness.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-color-code.ts","wcardinal/ui/shape/action/e-shape-action-value-change-color-code.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-cursor.ts","wcardinal/ui/shape/action/e-shape-action-value-change-cursor.ts","wcardinal/ui/util/format-node/format-node-a-large.ts","wcardinal/ui/util/format-node/format-node-a-small.ts","wcardinal/ui/util/format-node/format-node-d-large.ts","wcardinal/ui/util/format-node/format-node-d-small.ts","wcardinal/ui/util/format-node/format-node-precision.ts","wcardinal/ui/util/format-node/format-node-e.ts","wcardinal/ui/util/format-node/format-node-f.ts","wcardinal/ui/util/format-node/format-node-fsi.ts","wcardinal/ui/util/format-node/format-node-g.ts","wcardinal/ui/util/format-node/format-node-h-large.ts","wcardinal/ui/util/format-node/format-node-h-small.ts","wcardinal/ui/util/format-node/format-node-m-large.ts","wcardinal/ui/util/format-node/format-node-m-small.ts","wcardinal/ui/util/format-node/format-node-mi.ts","wcardinal/ui/util/format-node/format-node-p-large.ts","wcardinal/ui/util/format-node/format-node-p-small.ts","wcardinal/ui/util/format-node/format-node-padding.ts","wcardinal/ui/util/format-node/format-node-parenthesis.ts","wcardinal/ui/util/format-node/format-node-plus.ts","wcardinal/ui/util/format-node/format-node-rp-large.ts","wcardinal/ui/util/format-node/format-node-rp-small.ts","wcardinal/ui/util/format-node/format-node-sdt.ts","wcardinal/ui/util/format-node/format-node-space.ts","wcardinal/ui/util/format-node/format-node-ssi.ts","wcardinal/ui/util/format-node/format-node-string.ts","wcardinal/ui/util/format-node/format-node-y-large.ts","wcardinal/ui/util/format-node/format-node-y-small.ts","wcardinal/ui/util/format-node/format-node-z.ts","wcardinal/ui/util/format-node/format-noder-d.ts","wcardinal/ui/util/format-node/format-nodes.ts","wcardinal/ui/util/number-formatter-impl.ts","wcardinal/ui/util/number-formatters.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-text-number.ts","wcardinal/ui/shape/action/e-shape-action-runtime-change-text-text.ts","wcardinal/ui/shape/action/e-shape-action-value-change-text.ts","wcardinal/ui/d-border-mask.ts","wcardinal/ui/d-base-background.ts","wcardinal/ui/d-base-border.ts","wcardinal/ui/d-corner-mask.ts","wcardinal/ui/d-base-corner.ts","wcardinal/ui/d-base-interactive.ts","wcardinal/ui/d-base-outline.ts","wcardinal/ui/d-layout-clear-type.ts","wcardinal/ui/d-scalar-expression.ts","wcardinal/ui/d-base-padding.ts","wcardinal/ui/d-base-point.ts","wcardinal/ui/d-base-background-mesh-geometry.ts","wcardinal/ui/d-base-background-mesh.ts","wcardinal/ui/d-base-background-renderable.ts","wcardinal/ui/d-base-border-mesh-geometry.ts","wcardinal/ui/d-base-border-mesh.ts","wcardinal/ui/d-base-border-renderable.ts","wcardinal/ui/d-base-outline-renderable.ts","wcardinal/ui/d-base-reflowable.ts","wcardinal/ui/d-mouse-modifier.ts","wcardinal/ui/d-scalar-functions.ts","wcardinal/ui/util/util-pointer-event.ts","wcardinal/ui/d-base-auto.ts","wcardinal/ui/d-base-auto-set.ts","wcardinal/ui/util/to-enum.ts","wcardinal/ui/d-base.ts","wcardinal/ui/d-base-overflow-mask.ts","wcardinal/ui/d-mouse-modifiers.ts","wcardinal/ui/d-drag-mode.ts","wcardinal/ui/d-animation-timings.ts","wcardinal/ui/util/util-html-element-when.ts","wcardinal/ui/d-animation-base.ts","wcardinal/ui/util/util-drag-easing-history.ts","wcardinal/ui/util/util-drag-easing.ts","wcardinal/ui/util/util-drag.ts","wcardinal/ui/d-view-drag-impl.ts","wcardinal/ui/d-view-transform-impl.ts","wcardinal/ui/d-view-impl.ts","wcardinal/ui/d-canvas-container.ts","wcardinal/ui/shape/action/e-shape-action-runtimes.ts","wcardinal/ui/shape/action/e-shape-action-runtime-emit-event.ts","wcardinal/ui/shape/action/e-shape-action-value-emit-event.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-emit-event.ts","wcardinal/ui/d-html-element-state.ts","wcardinal/ui/util/util-html-element.ts","wcardinal/ui/shape/action/e-shape-action-value-misc-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-html-element.ts","wcardinal/ui/shape/action/e-shape-action-value-on-input-action.ts","wcardinal/ui/util/util-input.ts","wcardinal/ui/util/util-input-number.ts","wcardinal/ui/shape/action/e-shape-action-value-on-input-actions.ts","wcardinal/ui/d-button-base-when.ts","wcardinal/ui/d-align-horizontal.ts","wcardinal/ui/d-align-vertical.ts","wcardinal/ui/d-align-with.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input-integer.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input-real.ts","wcardinal/ui/util/util-input-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-input-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-write.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-write-both.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-write-local.ts","wcardinal/ui/shape/action/e-shape-action-runtime-misc-write-remote.ts","wcardinal/ui/shape/action/e-shape-action-value-misc.ts","wcardinal/ui/d-dynamic-text-measure-result-character.ts","wcardinal/ui/util/util-attach.ts","wcardinal/ui/d-dynamic-text-measure-result.ts","wcardinal/ui/d-dynamic-text-measure.ts","wcardinal/ui/d-dynamic-text-geometry.ts","wcardinal/ui/d-dynamic-text-style.ts","wcardinal/ui/d-dynamic-text.ts","wcardinal/ui/d-image-base-theme-wrapper-secondary.ts","wcardinal/ui/d-image-base-theme-wrapper-tertiary.ts","wcardinal/ui/d-image-piece.ts","wcardinal/ui/d-base-overflow-mask-simple.ts","wcardinal/ui/d-text-base.ts","wcardinal/ui/d-image-base.ts","wcardinal/ui/d-button-base.ts","wcardinal/ui/d-button.ts","wcardinal/ui/d-button-primary.ts","wcardinal/ui/d-animation-fade-in.ts","wcardinal/ui/d-dialog-close-on.ts","wcardinal/ui/d-dialog-mode.ts","wcardinal/ui/d-dialog-state.ts","wcardinal/ui/d-layout-direction.ts","wcardinal/ui/util/util-click-outside.ts","wcardinal/ui/util/util-overlay.ts","wcardinal/ui/d-dialog.ts","wcardinal/ui/d-layout-space.ts","wcardinal/ui/shape/action/e-shape-action-value-open-type.ts","wcardinal/ui/d-layout.ts","wcardinal/ui/d-layout-horizontal.ts","wcardinal/ui/d-layout-vertical.ts","wcardinal/ui/d-dialog-command.ts","wcardinal/ui/d-text.ts","wcardinal/ui/d-dialog-input.ts","wcardinal/ui/d-button-group.ts","wcardinal/ui/d-input-boolean-button-off.ts","wcardinal/ui/d-input-boolean-button-on.ts","wcardinal/ui/d-input-boolean.ts","wcardinal/ui/d-dialog-input-boolean.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog-boolean.ts","wcardinal/ui/d-html-element.ts","wcardinal/ui/d-input.ts","wcardinal/ui/d-input-number.ts","wcardinal/ui/d-input-integer.ts","wcardinal/ui/d-dialog-input-integer.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog-integer.ts","wcardinal/ui/d-input-real.ts","wcardinal/ui/d-dialog-input-real.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog-real.ts","wcardinal/ui/d-input-text.ts","wcardinal/ui/d-dialog-input-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog-text.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-diagram.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-page.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-page-inplace.ts","wcardinal/ui/d-button-ambient.ts","wcardinal/ui/d-picker-datetime-mask.ts","wcardinal/ui/d-picker-datetime-button-back.ts","wcardinal/ui/d-picker-datetime-button-date.ts","wcardinal/ui/d-picker-datetime-button-next.ts","wcardinal/ui/d-picker-datetime-label.ts","wcardinal/ui/d-picker-datetime-label-date.ts","wcardinal/ui/d-picker-datetime-space.ts","wcardinal/ui/d-picker-datetime-masks.ts","wcardinal/ui/shape/action/e-shape-action-value-show-hide-type.ts","wcardinal/ui/d-picker-time-bound.ts","wcardinal/ui/d-picker-time-bound-hours.ts","wcardinal/ui/d-picker-time-bound-minutes.ts","wcardinal/ui/d-picker-time-bound-seconds.ts","wcardinal/ui/d-picker-time-bounds.ts","wcardinal/ui/d-picker-time.ts","wcardinal/ui/d-picker-datetime.ts","wcardinal/ui/d-dialog-datetime.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog-datetime.ts","wcardinal/ui/d-dialog-time.ts","wcardinal/ui/util/is-nan.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog-time.ts","wcardinal/ui/d-picker-date.ts","wcardinal/ui/d-dialog-date.ts","wcardinal/ui/shape/action/e-shape-action-runtime-open-dialog-date.ts","wcardinal/ui/shape/action/e-shape-action-value-open.ts","wcardinal/ui/shape/action/e-shape-action-runtime-show-hide.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-move-type.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-type.ts","wcardinal/ui/shape/action/e-shape-action-value-show-hide.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-absolute-x.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-absolute-y.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-forward-or-backward.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-left-or-right.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-relative-x.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-move-relative-y.ts","wcardinal/ui/shape/action/e-shape-action-value-opetyped.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-move.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-resize-type.ts","wcardinal/ui/shape/e-shape-sizes.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-rotate-type.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-height-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-height-relative.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-size-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-size-relative.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-width-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-resize-width-relative.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-resize.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate-absolute.ts","wcardinal/ui/shape/action/e-shape-action-runtime-transform-rotate-relative.ts","wcardinal/ui/shape/action/e-shape-action-value-transform-rotate.ts","wcardinal/ui/shape/e-shape-capability.ts","wcardinal/ui/shape/action/e-shape-action-value-deserializer.ts","wcardinal/ui/shape/e-shape-image-elements.ts","wcardinal/ui/shape/e-shape-deserializer.ts","wcardinal/ui/shape/variant/deserialize-bar.ts","wcardinal/ui/shape/load/load-shape-bar.ts","wcardinal/ui/shape/variant/build-step.ts","wcardinal/ui/shape/variant/to-step.ts","wcardinal/ui/shape/variant/build-circle.ts","wcardinal/ui/shape/variant/e-shape-circle-uploaded.ts","wcardinal/ui/shape/variant/create-circle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-circle.ts","wcardinal/ui/shape/variant/deserialize-circle.ts","wcardinal/ui/shape/load/load-shape-circle.ts","wcardinal/ui/shape/e-shape-capabilities.ts","wcardinal/ui/shape/e-shape-stroke-side.ts","wcardinal/ui/shape/variant/e-shape-group-uploaded.ts","wcardinal/ui/shape/variant/create-group-uploaded.ts","wcardinal/ui/shape/e-shape-resource-manager-deserialization.ts","wcardinal/ui/shape/variant/e-shape-embedded-datum.ts","wcardinal/ui/shape/variant/e-shape-group-fill-viewer.ts","wcardinal/ui/shape/e-shape-editor.ts","wcardinal/ui/shape/e-shape-transforms.ts","wcardinal/ui/shape/variant/e-shape-group-size-layout.ts","wcardinal/ui/shape/variant/e-shape-group-size-editor.ts","wcardinal/ui/shape/variant/e-shape-group-size-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-stroke-viewer.ts","wcardinal/ui/d-link-menu-item-id.ts","wcardinal/ui/shape/variant/e-shape-group-text-align-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-offset-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-outline-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-padding-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-spacing-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-text-viewer.ts","wcardinal/ui/shape/variant/e-shape-group-viewer.ts","wcardinal/ui/shape/variant/e-shape-embedded-layer.ts","wcardinal/ui/shape/variant/e-shape-embedded-layer-container.ts","wcardinal/ui/d-diagrams.ts","wcardinal/ui/shape/variant/e-shape-group-text-align-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-offset-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-outline-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-padding-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-spacing-editor.ts","wcardinal/ui/shape/variant/e-shape-group-text-editor.ts","wcardinal/ui/shape/variant/e-shape-embedded.ts","wcardinal/ui/shape/variant/e-shape-embeddeds.ts","wcardinal/ui/shape/variant/deserialize-embedded.ts","wcardinal/ui/shape/load/load-shape-embedded.ts","wcardinal/ui/shape/variant/e-shape-group-fill-editor.ts","wcardinal/ui/shape/variant/e-shape-group-points.ts","wcardinal/ui/shape/variant/e-shape-group-stroke-editor.ts","wcardinal/ui/shape/variant/e-shape-group.ts","wcardinal/ui/shape/variant/deserialize-group.ts","wcardinal/ui/shape/load/load-shape-group.ts","wcardinal/ui/shape/variant/e-shape-group-size-shadowed.ts","wcardinal/ui/shape/variant/e-shape-group-shadowed.ts","wcardinal/ui/shape/variant/deserialize-group-shadowed.ts","wcardinal/ui/shape/load/load-shape-group-shadowed.ts","wcardinal/ui/shape/variant/build-rectangle.ts","wcardinal/ui/shape/variant/e-shape-rectangle-uploaded.ts","wcardinal/ui/shape/variant/create-rectangle-uploaded.ts","wcardinal/ui/shape/variant/e-shape-rectangle.ts","wcardinal/ui/shape/variant/e-shape-image.ts","wcardinal/ui/shape/variant/deserialize-image.ts","wcardinal/ui/shape/load/load-shape-image.ts","wcardinal/ui/shape/variant/build-image-sdf.ts","wcardinal/ui/shape/variant/e-shape-image-sdf-uploaded.ts","wcardinal/ui/shape/variant/create-image-sdf-uploaded.ts","wcardinal/ui/shape/variant/e-shape-image-sdf.ts","wcardinal/ui/shape/variant/deserialize-image-sdf.ts","wcardinal/ui/shape/variant/e-shape-label-uploaded.ts","wcardinal/ui/shape/variant/create-label-uploaded.ts","wcardinal/ui/shape/variant/e-shape-label.ts","wcardinal/ui/shape/variant/deserialize-label.ts","wcardinal/ui/shape/load/load-shape-label.ts","wcardinal/ui/util/to-index-of.ts","wcardinal/ui/shape/variant/build-line.ts","wcardinal/ui/shape/variant/e-shape-line-uploaded.ts","wcardinal/ui/shape/variant/create-line-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-points.ts","wcardinal/ui/shape/variant/e-shape-line.ts","wcardinal/ui/shape/variant/deserialize-line.ts","wcardinal/ui/shape/load/load-shape-line.ts","wcardinal/ui/shape/variant/build-line-of-any.ts","wcardinal/ui/shape/variant/create-line-of-any-uploaded.ts","wcardinal/ui/shape/variant/build-null.ts","wcardinal/ui/shape/variant/copy-clipping.ts","wcardinal/ui/shape/variant/copy-index.ts","wcardinal/ui/shape/variant/copy-step.ts","wcardinal/ui/shape/variant/copy-uv.ts","wcardinal/ui/shape/variant/copy-vertex.ts","wcardinal/ui/shape/variant/is-static.ts","wcardinal/ui/shape/variant/to-computed.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points-fill-impl.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points-point-impl.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points-stroke-impl.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-points-impl.ts","wcardinal/ui/shape/variant/e-shape-line-of-any-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-circles-uploaded.ts","wcardinal/ui/shape/variant/create-line-of-circles-uploaded.ts","wcardinal/ui/shape/variant/to-hit-threshold.ts","wcardinal/ui/shape/variant/e-shape-line-of-circles.ts","wcardinal/ui/shape/variant/deserialize-line-of-circles.ts","wcardinal/ui/shape/load/load-shape-line-of-circles.ts","wcardinal/ui/shape/variant/build-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangle-roundeds-uploaded.ts","wcardinal/ui/shape/variant/create-line-of-rectangle-roundeds-uploaded.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangle-roundeds.ts","wcardinal/ui/shape/variant/deserialize-line-of-rectangle-roundeds.ts","wcardinal/ui/shape/load/load-shape-line-of-rectangle-roundeds.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangles-uploaded.ts","wcardinal/ui/shape/variant/create-line-of-rectangles-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-rectangles.ts","wcardinal/ui/shape/variant/deserialize-line-of-rectangles.ts","wcardinal/ui/shape/load/load-shape-line-of-rectangles.ts","wcardinal/ui/shape/variant/build-triangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangle-roundeds-uploaded.ts","wcardinal/ui/shape/variant/create-line-of-triangle-roundeds-uploaded.ts","wcardinal/ui/shape/variant/e-shape-triangle.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangle-roundeds.ts","wcardinal/ui/shape/variant/deserialize-line-of-triangle-roundeds.ts","wcardinal/ui/shape/load/load-shape-line-of-triangle-roundeds.ts","wcardinal/ui/shape/variant/build-triangle.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangles-uploaded.ts","wcardinal/ui/shape/variant/create-line-of-triangles-uploaded.ts","wcardinal/ui/shape/variant/e-shape-line-of-triangles.ts","wcardinal/ui/shape/variant/deserialize-line-of-triangles.ts","wcardinal/ui/shape/load/load-shape-line-of-triangles.ts","wcardinal/ui/shape/variant/e-shape-null-uploaded.ts","wcardinal/ui/shape/variant/create-null-uploaded.ts","wcardinal/ui/shape/variant/e-shape-null.ts","wcardinal/ui/shape/variant/deserialize-null.ts","wcardinal/ui/shape/load/load-shape-null.ts","wcardinal/ui/shape/variant/deserialize-rectangle.ts","wcardinal/ui/shape/load/load-shape-rectangle.ts","wcardinal/ui/shape/variant/e-shape-rectangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/create-rectangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/deserialize-rectangle-rounded.ts","wcardinal/ui/shape/load/load-shape-rectangle-rounded.ts","wcardinal/ui/shape/variant/e-shape-triangle-uploaded.ts","wcardinal/ui/shape/variant/create-triangle-uploaded.ts","wcardinal/ui/shape/variant/deserialize-triangle.ts","wcardinal/ui/shape/load/load-shape-triangle.ts","wcardinal/ui/shape/variant/e-shape-triangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/create-triangle-rounded-uploaded.ts","wcardinal/ui/shape/variant/deserialize-triangle-rounded.ts","wcardinal/ui/shape/load/load-shape-triangle-rounded.ts","wcardinal/ui/shape/load/load-shape-all.ts","wcardinal/ui/shape/load/load-shape-image-sdf.ts","wcardinal/ui/d-image.ts","wcardinal/ui/d-list-item.ts","wcardinal/ui/d-menu-item.ts","wcardinal/ui/d-menu-item-text.ts","wcardinal/ui/d-menu-item-check.ts","wcardinal/ui/d-menus.ts","wcardinal/ui/d-link-target.ts","wcardinal/ui/d-link-menu.ts","wcardinal/ui/util/util-clipboard.ts","wcardinal/ui/snapper/e-snapper-target-value.ts","wcardinal/ui/d-link.ts","wcardinal/ui/d-links.ts","wcardinal/ui/d-menu-item-link.ts","wcardinal/ui/d-menu-item-menu.ts","wcardinal/ui/d-list-item-separator-reflowable.ts","wcardinal/ui/d-list-item-separator.ts","wcardinal/ui/d-menu-item-separator.ts","wcardinal/ui/d-menu-item-space.ts","wcardinal/ui/load/load-menu-item.ts","wcardinal/ui/d-menu-item-expandable-body.ts","wcardinal/ui/d-menu-item-expandable-header.ts","wcardinal/ui/d-menu-item-expandables.ts","wcardinal/ui/d-menu-item-expandable.ts","wcardinal/ui/d-menu-item-expandable-item-check.ts","wcardinal/ui/d-menu-item-expandable-item-link.ts","wcardinal/ui/d-menu-item-expandable-item-separator.ts","wcardinal/ui/d-menu-item-expandable-item-space.ts","wcardinal/ui/d-menu-item-expandable-item-text.ts","wcardinal/ui/load/load-menu-item-expandable.ts","wcardinal/ui/d-menu-sided-item-check.ts","wcardinal/ui/d-menu-sided-item-link.ts","wcardinal/ui/d-menu-sided-item-menu.ts","wcardinal/ui/d-menu-sided-item-separator.ts","wcardinal/ui/d-menu-sided-item-space.ts","wcardinal/ui/d-menu-sided-item-text.ts","wcardinal/ui/d-menu-sideds.ts","wcardinal/ui/load/load-menu-sided-item.ts","wcardinal/ui/d-menu-sided-item-expandables.ts","wcardinal/ui/d-menu-sided-item-expandable.ts","wcardinal/ui/d-menu-sided-item-expandable-item-check.ts","wcardinal/ui/d-menu-sided-item-expandable-item-link.ts","wcardinal/ui/d-menu-item-expandable-item-menu.ts","wcardinal/ui/d-menu-sided-item-expandable-item-menu.ts","wcardinal/ui/d-menu-sided-item-expandable-item-separator.ts","wcardinal/ui/d-menu-sided-item-expandable-item-space.ts","wcardinal/ui/d-menu-sided-item-expandable-item-text.ts","wcardinal/ui/load/load-menu-sided-item-expandable.ts","wcardinal/ui/load/load-menu-item-all.ts","wcardinal/ui/load/load-all.ts","wcardinal/ui/util/dynamic-sdf-font-generator.ts","wcardinal/ui/shape/variant/create-image-sdf.ts","wcardinal/ui/shape/e-shape-buffer-unit.ts","wcardinal/ui/shape/e-shape-buffer-unit-builder.ts","wcardinal/ui/shape/e-shape-buffer.ts","wcardinal/ui/util/dynamic-atlas-item.ts","wcardinal/ui/util/dynamic-atlas-item-empty.ts","wcardinal/ui/util/dynamic-atlas-item-white.ts","wcardinal/ui/util/dynamic-atlas.ts","wcardinal/ui/util/dynamic-atlas-item-font-atlas.ts","wcardinal/ui/util/ascii.ts","wcardinal/ui/util/dynamic-font-atlas-chaaracter-origin.ts","wcardinal/ui/util/dynamic-font-atlas-character.ts","wcardinal/ui/util/dynamic-sdf-font-atlas.ts","wcardinal/ui/util/dynamic-sdf-font-atlases.ts","wcardinal/ui/util/dynamic-atlas-item-image.ts","wcardinal/ui/shape/e-shape-renderer-iterator-datum.ts","wcardinal/ui/shape/e-shape-renderer-iterator.ts","wcardinal/ui/shape/e-shape-renderer.ts","wcardinal/ui/shape/e-shape-container.ts","wcardinal/ui/shape/e-shape-search.ts","wcardinal/ui/shape/e-shape-deleter.ts","wcardinal/ui/shape/e-shape-resource-manager-serialization.ts","wcardinal/ui/shape/e-shape-runtimes.ts","wcardinal/ui/snapper/e-snapper-grid.ts","wcardinal/ui/snapper/e-snapper-result.ts","wcardinal/ui/snapper/e-snapper.ts","wcardinal/ui/snapper/e-snapper-target.ts","wcardinal/ui/util/util-file-opener.ts","wcardinal/ui/util/dynamic-atlas-item-text.ts","wcardinal/ui/util/dynamic-font-atlas-font.ts","wcardinal/ui/util/dynamic-font-atlas.ts","wcardinal/ui/util/dynamic-font-atlases.ts","wcardinal/ui/util/lazy.ts","wcardinal/ui/util/to-ceiling-index.ts","wcardinal/ui/util/to-svg-url.ts","wcardinal/ui/util/util-svg-atlas-builder.ts","wcardinal/ui/util/util-extractor.ts","wcardinal/ui/util/util-file-downloader.ts","wcardinal/ui/util/util-extract.ts","wcardinal/ui/d-command-flag.ts","wcardinal/ui/util/util-hsv.ts","wcardinal/ui/util/util-name.ts","wcardinal/ui/util/util-promise.ts","wcardinal/ui/util/util-rgba.ts","wcardinal/ui/util/util-state-blinker.ts","wcardinal/ui/util/util-texture-plane.ts","wcardinal/ui/util/util-texture.ts","wcardinal/ui/util/util-transition.ts","wcardinal/ui/util/util-wheel-event.ts","wcardinal/ui/d-animation-empty.ts","wcardinal/ui/d-application-padding.ts","wcardinal/ui/d-application-layer-options.ts","wcardinal/ui/d-controller-default-focus.ts","wcardinal/ui/d-command-clear.ts","wcardinal/ui/d-list-selection.ts","wcardinal/ui/d-command-redo.ts","wcardinal/ui/d-command-undo.ts","wcardinal/ui/d-controller-default-command.ts","wcardinal/ui/d-controller-keyboard.ts","wcardinal/ui/d-controllers.ts","wcardinal/ui/d-application-layer.ts","wcardinal/ui/d-application.ts","wcardinal/ui/d-board.ts","wcardinal/ui/d-button-check.ts","wcardinal/ui/d-button-check-right.ts","wcardinal/ui/d-color-gradient-point-observable.ts","wcardinal/ui/d-color-gradient-observable.ts","wcardinal/ui/d-input-label.ts","wcardinal/ui/d-input-and-label.ts","wcardinal/ui/d-input-real-and-label.ts","wcardinal/ui/d-input-text-and-label.ts","wcardinal/ui/d-picker-color-and-alpha.ts","wcardinal/ui/d-picker-color-recent.ts","wcardinal/ui/d-picker-color.ts","wcardinal/ui/d-picker-color-gradient-recent.ts","wcardinal/ui/d-picker-color-gradient-view.ts","wcardinal/ui/d-picker-color-gradient.ts","wcardinal/ui/d-dialog-color-gradient.ts","wcardinal/ui/d-button-color-gradient.ts","wcardinal/ui/d-dialog-color.ts","wcardinal/ui/d-button-color.ts","wcardinal/ui/d-button-danger.ts","wcardinal/ui/d-dialog-dates.ts","wcardinal/ui/d-button-date.ts","wcardinal/ui/d-dialog-datetimes.ts","wcardinal/ui/d-picker-dates.ts","wcardinal/ui/d-picker-times.ts","wcardinal/ui/d-picker-datetimes.ts","wcardinal/ui/d-button-datetime.ts","wcardinal/ui/d-button-file.ts","wcardinal/ui/d-button-link.ts","wcardinal/ui/d-button-radio.ts","wcardinal/ui/d-button-radio-right.ts","wcardinal/ui/d-button-redo.ts","wcardinal/ui/d-button-secondary.ts","wcardinal/ui/d-chart-axis-position.ts","wcardinal/ui/d-chart-axis-tick-position.ts","wcardinal/ui/d-content.ts","wcardinal/ui/d-scroll-bar.ts","wcardinal/ui/d-scroll-bar-thumb.ts","wcardinal/ui/d-scroll-bar-thumb-reflowable-horizontal.ts","wcardinal/ui/d-scroll-bar-thumb-horizontal.ts","wcardinal/ui/d-scroll-bar-horizontal.ts","wcardinal/ui/d-scroll-bar-thumb-reflowable-vertical.ts","wcardinal/ui/d-scroll-bar-thumb-vertical.ts","wcardinal/ui/d-scroll-bar-vertical.ts","wcardinal/ui/d-pane.ts","wcardinal/ui/d-list.ts","wcardinal/ui/d-dialog-select-list.ts","wcardinal/ui/d-dialog-select-list-item.ts","wcardinal/ui/d-dialog-select-search.ts","wcardinal/ui/d-note.ts","wcardinal/ui/d-dialog-select.ts","wcardinal/ui/d-button-select.ts","wcardinal/ui/d-dialog-times.ts","wcardinal/ui/d-button-time.ts","wcardinal/ui/d-button-undo.ts","wcardinal/ui/d-canvas.ts","wcardinal/ui/shape/e-shape-points-styles.ts","wcardinal/ui/d-chart-coordinate.ts","wcardinal/ui/d-chart-axis-base-options-parser.ts","wcardinal/ui/d-chart-axis-base.ts","wcardinal/ui/d-chart-axis-container-impl.ts","wcardinal/ui/d-chart-axis-x.ts","wcardinal/ui/d-chart-axis-x-datetime.ts","wcardinal/ui/d-chart-axis-y.ts","wcardinal/ui/d-chart-color-set.ts","wcardinal/ui/d-chart-coordinate-container-sub-impl.ts","wcardinal/ui/d-chart-selection.ts","wcardinal/ui/d-chart-coordinate-container-impl.ts","wcardinal/ui/d-chart-coordinate-linear-tick.ts","wcardinal/ui/d-chart-coordinate-transform-impl.ts","wcardinal/ui/d-chart-coordinate-transform-mark.ts","wcardinal/ui/d-chart-region-impl.ts","wcardinal/ui/d-chart-coordinate-linear.ts","wcardinal/ui/d-chart-coordinate-log-tick.ts","wcardinal/ui/d-chart-coordinate-log.ts","wcardinal/ui/d-chart-legend-item.ts","wcardinal/ui/d-chart-legend.ts","wcardinal/ui/d-chart-overview.ts","wcardinal/ui/d-chart-plot-area-container.ts","wcardinal/ui/d-chart-series.ts","wcardinal/ui/d-chart-series-fill-computed-impl.ts","wcardinal/ui/d-chart-series-scalar.ts","wcardinal/ui/d-chart-series-fill-impl.ts","wcardinal/ui/d-chart-series-padding-computed-impl.ts","wcardinal/ui/d-chart-series-padding-impl.ts","wcardinal/ui/d-chart-series-point-computed-impl.ts","wcardinal/ui/d-chart-series-point-impl.ts","wcardinal/ui/d-chart-series-stroke-computed-impl.ts","wcardinal/ui/d-chart-series-stroke-impl.ts","wcardinal/ui/d-chart-series-container-impl.ts","wcardinal/ui/d-chart-plot-area.ts","wcardinal/ui/d-chart-region-impl-observable.ts","wcardinal/ui/d-chart-series-base-coordinate-container.ts","wcardinal/ui/d-chart-series-base.ts","wcardinal/ui/d-chart-series-line-of-any.ts","wcardinal/ui/d-chart-series-bar.ts","wcardinal/ui/d-chart-series-line-of-circles.ts","wcardinal/ui/d-chart-series-line-of-rectangle-roundeds.ts","wcardinal/ui/d-chart-series-line-of-rectangles.ts","wcardinal/ui/d-chart-series-line-of-triangles.ts","wcardinal/ui/d-chart-series-line-of-triangle-roundeds.ts","wcardinal/ui/d-chart-series-line.ts","wcardinal/ui/d-chart-series-linear-parameters-impl.ts","wcardinal/ui/d-chart-series-linear.ts","wcardinal/ui/d-chart-selection-shape-base.ts","wcardinal/ui/d-chart-selection-gridline-x.ts","wcardinal/ui/d-chart-selection-gridline-y.ts","wcardinal/ui/d-chart-selection-gridline-container-impl.ts","wcardinal/ui/d-chart-selection-marker.ts","wcardinal/ui/d-chart-selection-sub-impl.ts","wcardinal/ui/d-chart-selection-simple.ts","wcardinal/ui/d-chart.ts","wcardinal/ui/d-command-create.ts","wcardinal/ui/d-command-delete.ts","wcardinal/ui/d-command-save-as.ts","wcardinal/ui/d-command-save.ts","wcardinal/ui/d-diagram-canvas-editor-background.ts","wcardinal/ui/d-diagram-canvas-mapping-point-impl.ts","wcardinal/ui/d-diagram-canvas-mapping-impl.ts","wcardinal/ui/d-diagram-canvas-tile.ts","wcardinal/ui/d-diagram-layer.ts","wcardinal/ui/d-diagram-layer-container.ts","wcardinal/ui/d-diagram-canvas-base.ts","wcardinal/ui/d-diagram-canvas-editor.ts","wcardinal/ui/d-diagram-serialized.ts","wcardinal/ui/d-diagram-canvas.ts","wcardinal/ui/d-diagram-snapshot.ts","wcardinal/ui/d-diagram-base.ts","wcardinal/ui/d-diagram-editor-thumbnail.ts","wcardinal/ui/d-diagram-editor.ts","wcardinal/ui/d-diagram-shape.ts","wcardinal/ui/d-diagram-tag-remote.ts","wcardinal/ui/d-diagram-tag.ts","wcardinal/ui/d-diagram.ts","wcardinal/ui/d-dialog-confirm-message.ts","wcardinal/ui/d-dialog-confirm.ts","wcardinal/ui/d-dialog-confirm-delete.ts","wcardinal/ui/d-dialog-confirm-discard.ts","wcardinal/ui/d-dialog-message.ts","wcardinal/ui/d-dialog-processing-message.ts","wcardinal/ui/d-dialog-processing.ts","wcardinal/ui/d-dialog-save-as.ts","wcardinal/ui/d-menu-context.ts","wcardinal/ui/d-menu.ts","wcardinal/ui/d-dropdown-base.ts","wcardinal/ui/d-menu-sided-selection.ts","wcardinal/ui/d-dropdown.ts","wcardinal/ui/d-expandable-header.ts","wcardinal/ui/d-expandable.ts","wcardinal/ui/d-input-integer-and-label.ts","wcardinal/ui/d-map-coordinate-epsg3857.ts","wcardinal/ui/d-map-coordinates.ts","wcardinal/ui/d-map-tile.ts","wcardinal/ui/d-map-tile-plane.ts","wcardinal/ui/d-map-tile-pyramid-impl.ts","wcardinal/ui/d-map-tile-pyramids.ts","wcardinal/ui/d-menu-bar-item.ts","wcardinal/ui/d-menu-bar.ts","wcardinal/ui/d-menu-sided-content.ts","wcardinal/ui/d-table-column.ts","wcardinal/ui/d-menu-sided.ts","wcardinal/ui/d-notification.ts","wcardinal/ui/d-pagination-dots-button.ts","wcardinal/ui/d-pagination-dynamic-buttons.ts","wcardinal/ui/d-pagination-navigation-button.ts","wcardinal/ui/d-pagination.ts","wcardinal/ui/d-picker-datetime-range.ts","wcardinal/ui/d-picker-time-range.ts","wcardinal/ui/d-select-multiple.ts","wcardinal/ui/d-select.ts","wcardinal/ui/d-shadow-impl.ts","wcardinal/ui/d-slider-label.ts","wcardinal/ui/d-slider-thumb.ts","wcardinal/ui/d-slider-value.ts","wcardinal/ui/d-slider.ts","wcardinal/ui/d-slider-track.ts","wcardinal/ui/d-slider-track-horizontal.ts","wcardinal/ui/d-slider-horizontal.ts","wcardinal/ui/d-slider-track-vertical.ts","wcardinal/ui/d-slider-vertical.ts","wcardinal/ui/d-table-body-cells.ts","wcardinal/ui/d-table-body-cell-select-dialog.ts","wcardinal/ui/d-table-body-cell-action-dialog.ts","wcardinal/ui/d-table-body-cell-action-menu.ts","wcardinal/ui/d-table-body-cell-select-promise.ts","wcardinal/ui/d-table-body-cell-action-promise.ts","wcardinal/ui/d-table-body-cell-text.ts","wcardinal/ui/d-table-body-cell-button.ts","wcardinal/ui/d-table-body-cell-check.ts","wcardinal/ui/d-table-data-selection.ts","wcardinal/ui/d-table-body-cell-color.ts","wcardinal/ui/d-table-body-cell-date.ts","wcardinal/ui/d-table-body-cell-datetime.ts","wcardinal/ui/d-table-body-cell-index.ts","wcardinal/ui/d-table-body-cell-input-integer.ts","wcardinal/ui/d-table-body-cell-input-real.ts","wcardinal/ui/d-table-body-cell-input-text.ts","wcardinal/ui/d-base-padding-adjustable.ts","wcardinal/ui/d-table-body-cell-input-tree-input.ts","wcardinal/ui/d-table-body-cell-input-tree-marker.ts","wcardinal/ui/d-table-state.ts","wcardinal/ui/d-table-body-cell-input-tree.ts","wcardinal/ui/d-table-body-cell-link.ts","wcardinal/ui/d-table-body-cell-select-menu.ts","wcardinal/ui/d-table-body-cell-select-multiple.ts","wcardinal/ui/d-table-body-cell-tree.ts","wcardinal/ui/d-table-body-cell-time.ts","wcardinal/ui/d-table-row.ts","wcardinal/ui/d-table-data-sorter.ts","wcardinal/ui/d-table-body-row.ts","wcardinal/ui/d-table-data-list-filter.ts","wcardinal/ui/d-table-data-list-mapped.ts","wcardinal/ui/d-table-data-list-selection.ts","wcardinal/ui/d-table-data-list-sorter.ts","wcardinal/ui/d-tree.ts","wcardinal/ui/d-table-data-list.ts","wcardinal/ui/d-table-body.ts","wcardinal/ui/d-table-category-cell.ts","wcardinal/ui/d-table-category.ts","wcardinal/ui/d-table-data-tree-filter.ts","wcardinal/ui/d-table-data-tree-item-accessor.ts","wcardinal/ui/d-table-data-tree-selection-impl.ts","wcardinal/ui/d-table-data-tree-sorter.ts","wcardinal/ui/d-table-data-tree.ts","wcardinal/ui/d-table-header-cell-check.ts","wcardinal/ui/d-table-header-cell.ts","wcardinal/ui/d-table-header.ts","wcardinal/ui/d-table.ts","wcardinal/ui/d-tree-item-state.ts","wcardinal/ui/d-tree-item-text-and-image.ts","wcardinal/ui/d-tree-item-toggle-icon.ts","wcardinal/ui/d-tree-item.ts","wcardinal/ui/d-tree-selection.ts","wcardinal/ui/shape/variant/create-image.ts","wcardinal/ui/shape/variant/create-line.ts","wcardinal/ui/snapper/e-snapper-result-scale.ts","wcardinal/ui/util/to-label.ts","wcardinal/ui/util/to-string.ts","wcardinal/ui/util/to-svg-texture.ts","wcardinal-ui.browser.ts"],"sourcesContent":["/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\n\ntype Deserializer = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n) => Promise<EShape> | EShape | null;\n\nexport const EShapeDeserializers: { [ type: number ]: Deserializer | undefined } = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeType {\n\tCIRCLE,\n\tRECTANGLE,\n\tRECTANGLE_ROUNDED,\n\tTRIANGLE,\n\tTRIANGLE_ROUNDED,\n\tLINE,\n\tIMAGE,\n\tIMAGE_SDF,\n\tGROUP,\n\tBAR,\n\tLABEL,\n\tNULL,\n\tGROUP_SHADOWED,\n\tLINE_OF_CIRCLES,\n\tLINE_OF_RECTANGLES,\n\tLINE_OF_RECTANGLE_ROUNDEDS,\n\tLINE_OF_TRIANGLES,\n\tLINE_OF_TRIANGLE_ROUNDEDS,\n\tEMBEDDED,\n\tLAYER,\n\tEXTENSION = 1000\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\n\nexport type EShapeUploadedCreator = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n) => EShapeUploaded | null;\n\nexport const EShapeUploadeds: {\n\t[ type: number ]: EShapeUploadedCreator | undefined\n} = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapePointsStyle {\n\tNONE = 0,\n\tCLOSED = 1,\n\tNON_EXPANDING_WIDTH = 2,\n\tNON_SHRINKING_WIDTH = 4,\n\tNON_SCALING_DOT_AND_DASH = 8,\n\tDOTTED = 16,\n\tDOTTED_DENSELY = 32,\n\tDOTTED_LOOSELY = 64,\n\tDASHED = 128,\n\tDASHED_DENSELY = 256,\n\tDASHED_LOOSELY = 512,\n\tDOTTED_MASK = DOTTED | DOTTED_DENSELY | DOTTED_LOOSELY,\n\tDASHED_MASK = DASHED | DASHED_DENSELY | DASHED_LOOSELY,\n\tNON_SOLID_MASK = DOTTED_MASK | DASHED_MASK\n}\n","import { IPoint } from \"pixi.js\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\n\nexport const toDash = (\n\tlength: number, strokeWidth: number,\n\tstyle: EShapePointsStyle, result: IPoint\n): IPoint => {\n\tresult.set( 2 * length, 0 );\n\tif( style & EShapePointsStyle.NON_SOLID_MASK ) {\n\t\tif( style & EShapePointsStyle.DOTTED ) {\n\t\t\tresult.set( strokeWidth, strokeWidth );\n\t\t} else if( style & EShapePointsStyle.DOTTED_DENSELY ) {\n\t\t\tresult.set( strokeWidth, strokeWidth * 0.5 );\n\t\t} else if( style & EShapePointsStyle.DOTTED_LOOSELY ) {\n\t\t\tresult.set( strokeWidth, strokeWidth * 2 );\n\t\t} else if( style & EShapePointsStyle.DASHED ) {\n\t\t\tresult.set( strokeWidth * 2, strokeWidth );\n\t\t} else if( style & EShapePointsStyle.DASHED_DENSELY ) {\n\t\t\tresult.set( strokeWidth * 2, strokeWidth * 0.5 );\n\t\t} else if( style & EShapePointsStyle.DASHED_LOOSELY ) {\n\t\t\tresult.set( strokeWidth * 2, strokeWidth * 2 );\n\t\t}\n\t}\n\treturn result;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DeepPartial } from \"../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"./e-shape-text-align\";\nimport { EShapeTextDirection } from \"./e-shape-text-direction\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"./e-shape-text-offset\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"./e-shape-text-outline\";\n\nexport enum EShapeTextWeight {\n\tNORMAL,\n\tBOLD\n}\n\nexport enum EShapeTextStyle {\n\tNORMAL,\n\tITALIC\n}\n\nexport interface EShapeTextLike {\n\tvalue: string;\n\tcolor: number;\n\talpha: number;\n\tfamily: string;\n\tsize: number;\n\tweight: EShapeTextWeight;\n\talign: EShapeTextAlignLike;\n\toffset: EShapeTextOffsetLike;\n\tstyle: EShapeTextStyle;\n\toutline: EShapeTextOutlineLike;\n\tspacing: EShapeTextOffsetLike;\n\tdirection: EShapeTextDirection;\n\tpadding: EShapeTextOffsetLike;\n\tclipping: boolean;\n}\n\nexport interface EShapeTextAtlasCharacter {\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tadvance: number;\n\torigin: {\n\t\tx: number,\n\t\ty: number\n\t};\n}\n\nexport interface EShapeTextAtlasCharacters {\n\t[ character: string ]: EShapeTextAtlasCharacter;\n}\n\nexport interface EShapeTextAtlas {\n\twidth: number;\n\theight: number;\n\tfont: {\n\t\tsize: number;\n\t};\n\tcharacters: EShapeTextAtlasCharacters;\n}\n\nexport interface EShapeText extends EShapeTextLike {\n\tenable: boolean;\n\n\talign: EShapeTextAlign;\n\toffset: EShapeTextOffset;\n\toutline: EShapeTextOutline;\n\tspacing: EShapeTextOffset;\n\tpadding: EShapeTextOffset;\n\n\ttexture?: Texture;\t\t\t// Used for rendering and updated when rendered\n\tatlas?: EShapeTextAtlas;\t// Used for rendering and updated when rendered\n\tworld?: number[];\t\t\t// Updated when rendered\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this;\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this;\n\ttoObject(): EShapeTextLike;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextAlignHorizontal {\n\tLEFT,\n\tCENTER,\n\tRIGHT,\n\tOUTSIDE_LEFT,\n\tOUTSIDE_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextAlignVertical {\n\tTOP,\n\tMIDDLE,\n\tBOTTOM,\n\tOUTSIDE_TOP,\n\tOUTSIDE_BOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeTextDirection {\n\tLEFT_TO_RIGHT,\n\tTOP_TO_BOTTOM,\n\tBOTTOM_TO_TOP\n}\n","import { EShapePointsStyle } from \"../e-shape-points-style\";\n\nexport const toScaleInvariant = ( style: EShapePointsStyle ): number => {\n\tconst nonExpandingWidth = ( style & EShapePointsStyle.NON_EXPANDING_WIDTH ? 1 : 0 );\n\tconst nonShrinkingWidth = ( style & EShapePointsStyle.NON_SHRINKING_WIDTH ? 2 : 0 );\n\tconst nonScalingDotAndDash = ( style & EShapePointsStyle.NON_SCALING_DOT_AND_DASH ? 4 : 0 );\n\tif( style & EShapePointsStyle.NON_SOLID_MASK ) {\n\t\treturn nonExpandingWidth | nonShrinkingWidth | nonScalingDotAndDash;\n\t} else {\n\t\treturn nonExpandingWidth | nonShrinkingWidth;\n\t}\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { toDash } from \"./to-dash\";\nimport { toScaleInvariant } from \"./to-scale-invariant\";\n\nexport const BAR_VERTEX_COUNT = 4;\nexport const BAR_INDEX_COUNT = 2;\nconst BAR_FMIN: number = 0.00001;\nconst BAR_WORK_POINT: Point = new Point();\n\nexport const buildBarClipping = (\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\tconst ic = voffset * 3;\n\tclippings[ ic +  0 ] = 1;\n\tclippings[ ic +  1 ] = 0;\n\tclippings[ ic +  2 ] = 3;\n\n\tclippings[ ic +  3 ] = 0;\n\tclippings[ ic +  4 ] = 1;\n\tclippings[ ic +  5 ] = 5;\n\n\tclippings[ ic +  6 ] = 1;\n\tclippings[ ic +  7 ] = 0;\n\tclippings[ ic +  8 ] = 3;\n\n\tclippings[ ic +  9 ] = 0;\n\tclippings[ ic + 10 ] = 1;\n\tclippings[ ic + 11 ] = 5;\n};\n\nexport const buildBarIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\tconst ii = ioffset * 3;\n\tindices[ ii + 0 ] = voffset + 0;\n\tindices[ ii + 1 ] = voffset + 2;\n\tindices[ ii + 2 ] = voffset + 1;\n\n\tindices[ ii + 3 ] = voffset + 1;\n\tindices[ ii + 4 ] = voffset + 2;\n\tindices[ ii + 5 ] = voffset + 3;\n};\n\nexport const buildBarVertexStepAndColorFill = (\n\tvertices: Float32Array,\n\tsteps: Float32Array,\n\tcolorFills: Float32Array,\n\tvoffset: number,\n\tpointValues: number[],\n\tpointsStyle: EShapePointsStyle,\n\tpointsSize: number,\n\tstrokeWidth: number,\n\tinternalTransform: Matrix\n): void => {\n\t// First point\n\tconst a  = internalTransform.a;\n\tconst b  = internalTransform.b;\n\tconst c  = internalTransform.c;\n\tconst d  = internalTransform.d;\n\tconst tx = internalTransform.tx;\n\tconst ty = internalTransform.ty;\n\tconst pv0 = pointValues[ 0 ];\n\tconst pv1 = pointValues[ 1 ];\n\tconst p1x = a * pv0 + c * pv1 + tx;\n\tconst p1y = b * pv0 + d * pv1 + ty;\n\n\t// Last point\n\tconst pv2 = pointValues[ 2 ];\n\tconst pv3 = pointValues[ 3 ];\n\tlet p2x = a * pv2 + c * pv3 + tx;\n\tlet p2y = b * pv2 + d * pv3 + ty;\n\n\t// Normal\n\tlet dx = p2x - p1x;\n\tlet dy = p2y - p1y;\n\tconst distance = Math.sqrt( dx * dx + dy * dy );\n\tlet l = distance;\n\tif( 0 <= pointsSize && BAR_FMIN < distance ) {\n\t\tconst ratio = pointsSize / distance;\n\t\tdx *= ratio;\n\t\tdy *= ratio;\n\t\tp2x = p1x + dx;\n\t\tp2y = p1y + dy;\n\t\tl = pointsSize;\n\t}\n\n\t// Other points\n\tconst p0x = p1x - dx;\n\tconst p0y = p1y - dy;\n\tconst p3x = p2x + dx;\n\tconst p3y = p2y + dy;\n\n\t//\n\tconst scaleInvariant = toScaleInvariant( pointsStyle );\n\tconst iv = voffset << 1;\n\tconst icf = voffset << 2;\n\tconst is = voffset * 6;\n\tvertices[ iv + 0 ] = p1x;\n\tvertices[ iv + 1 ] = p1y;\n\tvertices[ iv + 2 ] = p1x;\n\tvertices[ iv + 3 ] = p1y;\n\tsteps[ is +  0 ] = strokeWidth;\n\tsteps[ is +  1 ] = scaleInvariant;\n\tsteps[ is +  2 ] = p0x;\n\tsteps[ is +  3 ] = p0y;\n\tsteps[ is +  4 ] = p2x;\n\tsteps[ is +  5 ] = p2y;\n\tsteps[ is +  6 ] = strokeWidth;\n\tsteps[ is +  7 ] = scaleInvariant;\n\tsteps[ is +  8 ] = p0x;\n\tsteps[ is +  9 ] = p0y;\n\tsteps[ is + 10 ] = p2x;\n\tsteps[ is + 11 ] = p2y;\n\tcolorFills[ icf + 0 ] = 0.0;\n\tcolorFills[ icf + 4 ] = 0.0;\n\n\tvertices[ iv + 4 ] = p2x;\n\tvertices[ iv + 5 ] = p2y;\n\tvertices[ iv + 6 ] = p2x;\n\tvertices[ iv + 7 ] = p2y;\n\tsteps[ is + 12 ] = strokeWidth;\n\tsteps[ is + 13 ] = scaleInvariant;\n\tsteps[ is + 14 ] = p1x;\n\tsteps[ is + 15 ] = p1y;\n\tsteps[ is + 16 ] = p3x;\n\tsteps[ is + 17 ] = p3y;\n\tsteps[ is + 18 ] = strokeWidth;\n\tsteps[ is + 19 ] = scaleInvariant;\n\tsteps[ is + 20 ] = p1x;\n\tsteps[ is + 21 ] = p1y;\n\tsteps[ is + 22 ] = p3x;\n\tsteps[ is + 23 ] = p3y;\n\tcolorFills[ icf +  8 ] = l;\n\tcolorFills[ icf + 12 ] = l;\n\n\t// Total length\n\tconst dash = toDash( l, strokeWidth, pointsStyle, BAR_WORK_POINT );\n\tconst dash0 = dash.x;\n\tconst dash1 = dash.y;\n\tcolorFills[ icf +  1 ] = dash0;\n\tcolorFills[ icf +  2 ] = dash1;\n\tcolorFills[ icf +  3 ] = l;\n\n\tcolorFills[ icf +  5 ] = dash0;\n\tcolorFills[ icf +  6 ] = dash1;\n\tcolorFills[ icf +  7 ] = l;\n\n\tcolorFills[ icf +  9 ] = dash0;\n\tcolorFills[ icf + 10 ] = dash1;\n\tcolorFills[ icf + 11 ] = l;\n\n\tcolorFills[ icf + 13 ] = dash0;\n\tcolorFills[ icf + 14 ] = dash1;\n\tcolorFills[ icf + 15 ] = l;\n};\n\nexport const buildBarUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs\n): void => {\n\tconst iuv = voffset << 1;\n\tuvs[ iuv + 0 ] = textureUvs.x0;\n\tuvs[ iuv + 1 ] = textureUvs.y0;\n\tuvs[ iuv + 2 ] = textureUvs.x3;\n\tuvs[ iuv + 3 ] = textureUvs.y3;\n\n\tuvs[ iuv + 4 ] = textureUvs.x1;\n\tuvs[ iuv + 5 ] = textureUvs.y1;\n\tuvs[ iuv + 6 ] = textureUvs.x2;\n\tuvs[ iuv + 7 ] = textureUvs.y2;\n};\n","\nexport class UtilCharacterIterator {\n\tprotected static _instance: UtilCharacterIterator | null = null;\n\tprotected _target: string;\n\tprotected _position: number;\n\n\tconstructor() {\n\t\tthis._target = \"\";\n\t\tthis._position = 0;\n\t}\n\n\tget position(): number {\n\t\treturn this._position;\n\t}\n\n\tset position( position: number ) {\n\t\tthis._position = position;\n\t}\n\n\tinit( target: string ): void {\n\t\tthis._target = target;\n\t\tthis._position = 0;\n\t}\n\n\thasNext(): boolean {\n\t\treturn this._position < this._target.length;\n\t}\n\n\tprotected findNextBreak( target: string, istart: number ): number {\n\t\tconst iend = target.length;\n\t\tfor( let i = istart; i < iend; ++i ) {\n\t\t\tconst code = target.charCodeAt( i );\n\t\t\tif( ! this.isLowSurrogate( code ) && ! this.isVariationSelector( code ) ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn iend;\n\t}\n\n\tprotected isHighSurrogate( code: number ): boolean {\n\t\treturn ( 0xd800 <= code && code <= 0xdbff );\n\t}\n\n\tprotected isLowSurrogate( code: number ): boolean {\n\t\treturn ( 0xdc00 <= code && code <= 0xdfff );\n\t}\n\n\tprotected isVariationSelector( code: number ): boolean {\n\t\treturn ( 0xfe00 <= code && code <= 0xfe0f );\n\t}\n\n\tnext(): string {\n\t\tconst target = this._target;\n\t\tconst position = this._position;\n\t\tconst nextBreak = this.findNextBreak( target, position + 1 );\n\t\tconst result = target.substring( position, nextBreak );\n\t\tthis._position = nextBreak;\n\t\treturn result;\n\t}\n\n\t/**\n\t * Advances the position if the next character is not equal to\n\t * the given `except`.\n\t *\n\t * @param except\n\t * @return true if the position is advanced\n\t */\n\tadvance( except?: string ): boolean {\n\t\tconst target = this._target;\n\t\tconst position = this._position;\n\t\tconst nextBreak = this.findNextBreak( target, position + 1 );\n\t\tif( target.substring( position, nextBreak ) !== except ) {\n\t\t\tthis._position = nextBreak;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic from( target: string ): UtilCharacterIterator {\n\t\tif( UtilCharacterIterator._instance == null ) {\n\t\t\tUtilCharacterIterator._instance = new UtilCharacterIterator();\n\t\t}\n\t\tconst instance = UtilCharacterIterator._instance;\n\t\tinstance.init( target );\n\t\treturn instance;\n\t}\n}\n","export const toLength = ( p0x: number, p0y: number, p1x: number, p1y: number ) => {\n\tconst dx01 = p1x - p0x;\n\tconst dy01 = p1y - p0y;\n\treturn Math.sqrt( dx01 * dx01 + dy01 * dy01 );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeBarPosition {\n\tTOP,\n\tLEFT,\n\tRIGHT,\n\tBOTTOM\n}\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { UtilCharacterIterator } from \"../../util/util-character-iterator\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeTextAtlas, EShapeTextAtlasCharacter, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { toLength } from \"./to-length\";\n\nexport const TEXT_VERTEX_COUNT = 4;\nexport const TEXT_INDEX_COUNT = 2;\nconst TEXT_SDF_WINDOW = 12;\nconst TEXT_FMIN: number = 0.00001;\nconst TEXT_WORK_POINT: Point = new Point();\n\nexport const toTextBufferCount = ( shape: EShape ): number => {\n\treturn Math.ceil( shape.text.value.length / 12 ) * 12;\n};\n\nexport const buildTextClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tvcount: number\n): void => {\n\tfor( let i = voffset * 3, imax = i + vcount * 3; i < imax; i += 3 ) {\n\t\tclippings[ i + 0 ] = 0;\n\t\tclippings[ i + 1 ] = 0;\n\t\tclippings[ i + 2 ] = 2;\n\t}\n};\n\nexport const buildTextIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number,\n\ticount: number\n): void => {\n\tfor( let i = 0, ii = ioffset * 3, imax = (icount >> 1); i < imax; i += 1, ii += 6 ) {\n\t\tconst j = voffset + ( i << 2 );\n\t\tindices[ ii + 0 ] = j + 0;\n\t\tindices[ ii + 1 ] = j + 1;\n\t\tindices[ ii + 2 ] = j + 3;\n\n\t\tindices[ ii + 3 ] = j + 1;\n\t\tindices[ ii + 4 ] = j + 2;\n\t\tindices[ ii + 5 ] = j + 3;\n\t}\n};\n\nexport const buildTextStep = (\n\tsteps: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\ttextAtlas: EShapeTextAtlas | undefined,\n\ttextSize: number,\n\ttextOutlineWidth: number,\n\ttextWeight: EShapeTextWeight,\n\tantialiasWeight: number\n): void => {\n\tif( textAtlas != null ) {\n\t\tconst scaleBase = (0.4 / TEXT_SDF_WINDOW) * antialiasWeight;\n\t\tconst scale = scaleBase * (textAtlas.font.size / textSize);\n\t\tconst outlineWidth = textOutlineWidth * 0.4;\n\t\tconst weight = ( textWeight === EShapeTextWeight.NORMAL ? 0.0 : 0.05 );\n\t\tfor( let i = voffset * 6, imax = i + vcount * 6; i < imax; i += 6 ) {\n\t\t\tsteps[ i + 0 ] = scale;\n\t\t\tsteps[ i + 1 ] = outlineWidth;\n\t\t\tsteps[ i + 2 ] = weight;\n\t\t\tsteps[ i + 3 ] = TEXT_FMIN;\n\t\t\tsteps[ i + 4 ] = TEXT_FMIN;\n\t\t\tsteps[ i + 5 ] = TEXT_FMIN;\n\t\t}\n\t} else {\n\t\tfor( let i = voffset * 6, imax = i + vcount * 6; i < imax; i += 6 ) {\n\t\t\tsteps[ i + 0 ] = 0;\n\t\t\tsteps[ i + 1 ] = 0;\n\t\t\tsteps[ i + 2 ] = TEXT_FMIN;\n\t\t\tsteps[ i + 3 ] = TEXT_FMIN;\n\t\t\tsteps[ i + 4 ] = TEXT_FMIN;\n\t\t\tsteps[ i + 5 ] = TEXT_FMIN;\n\t\t}\n\t}\n};\n\nconst getTextBBox = (\n\thalign: EShapeTextAlignHorizontal,\n\tvalign: EShapeTextAlignVertical,\n\thoffset: number,\n\tvoffset: number,\n\thpadding: number,\n\tvpadding: number,\n\twidth: number, height: number,\n\tx0: number, y0: number,\n\tx1: number, y1: number,\n\tx2: number, y2: number,\n\tx3: number, y3: number,\n\thnx: number, hny: number,\n\tvnx: number, vny: number,\n\tresult: Point\n): void => {\n\tswitch( halign ) {\n\tcase EShapeTextAlignHorizontal.LEFT:\n\t\tswitch( valign ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\tresult.x = x0\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y0\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\tresult.x = 0.5 * ( x0 + x3 )\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\tresult.y = 0.5 * ( y0 + y3 )\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\tresult.x = x3\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y3\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\tresult.x = x0\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y0\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\tresult.x = x3\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y3\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tcase EShapeTextAlignHorizontal.CENTER:\n\t\tswitch( valign ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\tresult.x = 0.5 * ( x0 + x1 )\n\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = 0.5 * ( y0 + y1 )\n\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\tresult.x = 0.5 * ( x0 + x2 )\n\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\tresult.y = 0.5 * ( y0 + y2 )\n\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\tresult.x = 0.5 * ( x3 + x2 )\n\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = 0.5 * ( y3 + y2 )\n\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\tresult.x = 0.5 * ( x0 + x1 )\n\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = 0.5 * ( y0 + y1 )\n\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\tresult.x = 0.5 * ( x3 + x2 )\n\t\t\t\t+ hnx * ( hoffset - 0.5 * width )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = 0.5 * ( y3 + y2 )\n\t\t\t\t+ hny * ( hoffset - 0.5 * width )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\tswitch( valign ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\tresult.x = x1\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y1\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\tresult.x = 0.5 * ( x1 + x2 )\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\tresult.y = 0.5 * ( y1 + y2 )\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\tresult.x = x2\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y2\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\tresult.x = x1\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y1\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\tresult.x = x2\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y2\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\tswitch( valign ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\tresult.x = x0\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y0\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\tresult.x = 0.5 * ( x0 + x3 )\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\tresult.y = 0.5 * ( y0 + y3 )\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\tresult.x = x3\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y3\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\tresult.x = x0\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y0\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\tresult.x = x3\n\t\t\t\t+ hnx * ( hoffset - hpadding - width )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y3\n\t\t\t\t+ hny * ( hoffset - hpadding - width )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\tswitch( valign ) {\n\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\tresult.x = x1\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y1\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\tresult.x = 0.5 * ( x1 + x2 )\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset - 0.5 * height );\n\t\t\tresult.y = 0.5 * ( y1 + y2 )\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset - 0.5 * height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\tresult.x = x2\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y2\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\tresult.x = x1\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset - vpadding - height );\n\t\t\tresult.y = y1\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset - vpadding - height );\n\t\t\tbreak;\n\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\tresult.x = x2\n\t\t\t\t+ hnx * ( hoffset + hpadding )\n\t\t\t\t+ vnx * ( voffset + vpadding );\n\t\t\tresult.y = y2\n\t\t\t\t+ hny * ( hoffset + hpadding )\n\t\t\t\t+ vny * ( voffset + vpadding );\n\t\t\tbreak;\n\t\t}\n\t\tbreak;\n\t}\n};\n\nconst toNormalized = ( dx: number, dy: number, defx: number, defy: number, result: Point ): number => {\n\tconst d = dx * dx + dy * dy;\n\tif( TEXT_FMIN < d ) {\n\t\tconst l = Math.sqrt( d );\n\t\tconst li = 1 / l;\n\t\tresult.set( dx * li, dy * li );\n\t\treturn l;\n\t} else {\n\t\tresult.set( defx, defy );\n\t\treturn 0;\n\t}\n};\n\nconst rotateAlignHorizontalRight = ( align: EShapeTextAlignHorizontal ): EShapeTextAlignVertical => {\n\tswitch( align ) {\n\tcase EShapeTextAlignHorizontal.LEFT:\n\t\treturn EShapeTextAlignVertical.BOTTOM;\n\tcase EShapeTextAlignHorizontal.CENTER:\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\treturn EShapeTextAlignVertical.TOP;\n\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\t}\n};\n\nconst rotateAlignVerticalRight = ( align: EShapeTextAlignVertical ): EShapeTextAlignHorizontal => {\n\tswitch( align ) {\n\tcase EShapeTextAlignVertical.TOP:\n\t\treturn EShapeTextAlignHorizontal.LEFT;\n\tcase EShapeTextAlignVertical.MIDDLE:\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\tcase EShapeTextAlignVertical.BOTTOM:\n\t\treturn EShapeTextAlignHorizontal.RIGHT;\n\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\t}\n};\n\nconst rotateAlignHorizontalLeft = ( align: EShapeTextAlignHorizontal ): EShapeTextAlignVertical => {\n\tswitch( align ) {\n\tcase EShapeTextAlignHorizontal.LEFT:\n\t\treturn EShapeTextAlignVertical.TOP;\n\tcase EShapeTextAlignHorizontal.CENTER:\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\treturn EShapeTextAlignVertical.BOTTOM;\n\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\treturn EShapeTextAlignVertical.OUTSIDE_TOP;\n\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\treturn EShapeTextAlignVertical.OUTSIDE_BOTTOM;\n\t}\n};\n\nconst rotateAlignVerticalLeft = ( align: EShapeTextAlignVertical ): EShapeTextAlignHorizontal => {\n\tswitch( align ) {\n\tcase EShapeTextAlignVertical.TOP:\n\t\treturn EShapeTextAlignHorizontal.RIGHT;\n\tcase EShapeTextAlignVertical.MIDDLE:\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\tcase EShapeTextAlignVertical.BOTTOM:\n\t\treturn EShapeTextAlignHorizontal.LEFT;\n\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\treturn EShapeTextAlignHorizontal.OUTSIDE_RIGHT;\n\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\treturn EShapeTextAlignHorizontal.OUTSIDE_LEFT;\n\t}\n};\n\nexport const buildTextVertex = (\n\tvertices: Float32Array,\n\tuvs: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\ttextAtlas: EShapeTextAtlas,\n\ttextSize: number,\n\ttextValue: string,\n\ttextStyle: EShapeTextStyle,\n\ttextAlignHorizontal: EShapeTextAlignHorizontal,\n\ttextAlignVertical: EShapeTextAlignVertical,\n\ttextOffsetHorizontal: number,\n\ttextOffsetVertical: number,\n\ttextSpacingHorizontal: number,\n\ttextSpacingVertical: number,\n\ttextDirection: EShapeTextDirection,\n\ttextPaddingHorizontal: number,\n\ttextPaddingVertical: number,\n\ttextClipping: boolean,\n\ttextWorld: number[],\n\ttextureUvs: TextureUvs,\n\tinternalTransform: Matrix\n): void => {\n\t// Calculate the transformed positions\n\t//\n\t//  0               1\n\t// |---------------|\n\t// |               |\n\t// |3              |2\n\t// |---------------|\n\t//\n\tconst sx = sizeX * 0.5;\n\tconst sy = sizeY * 0.5;\n\tconst work = TEXT_WORK_POINT;\n\twork.set( originX - sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( originX + sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x1 = work.x;\n\tconst y1 = work.y;\n\twork.set( originX + sx, originY + sy );\n\tinternalTransform.apply( work, work );\n\tconst x2 = work.x;\n\tconst y2 = work.y;\n\tconst x3 = x0 + (x2 - x1);\n\tconst y3 = y0 + (y2 - y1);\n\n\t// Horizontal normal\n\tconst hl = toLength( x0, y0, x1, y1 );\n\ttoNormalized( internalTransform.a, internalTransform.b, 1, 0, work );\n\tlet hnx = work.x;\n\tlet hny = work.y;\n\n\t// Vertical normal\n\tconst vl = toLength( x0, y0, x3, y3 );\n\ttoNormalized( internalTransform.c, internalTransform.d, 0, 1, work );\n\tlet vnx = work.x;\n\tlet vny = work.y;\n\n\t// Calculate the width / height\n\tlet width = 0;\n\tlet height = 0;\n\tlet heightChar = 0;\n\tconst lineHeight = Math.max( 0, textSize + textSpacingVertical );\n\tlet lineWidth = 0;\n\tconst textAtlasCharacters = textAtlas.characters;\n\tconst iterator = UtilCharacterIterator.from( textValue );\n\tlet advancePrevious = 0;\n\twhile( iterator.hasNext() ) {\n\t\tconst character = iterator.next();\n\t\tif( character !== \"\\n\" ) {\n\t\t\tif( 0 < advancePrevious ) {\n\t\t\t\tlineWidth += Math.max( 0, advancePrevious + textSpacingHorizontal );\n\t\t\t}\n\t\t\tconst data = textAtlasCharacters[ character ];\n\t\t\tif( data ) {\n\t\t\t\tadvancePrevious = data.advance;\n\t\t\t\theightChar = data.height;\n\t\t\t} else {\n\t\t\t\tadvancePrevious = 0;\n\t\t\t}\n\t\t} else {\n\t\t\tlineWidth += advancePrevious;\n\t\t\tadvancePrevious = 0;\n\t\t\twidth = Math.max( width, lineWidth );\n\t\t\tlineWidth = 0;\n\t\t\theight += lineHeight;\n\t\t}\n\t}\n\n\tconst scale = textSize / textAtlas.font.size;\n\tlineWidth += advancePrevious;\n\twidth = Math.max( width, lineWidth ) * scale;\n\tlineWidth = 0;\n\theightChar *= scale;\n\theight += textSize;\n\n\t//\n\tlet tx0 = 0;\n\tlet ty0 = 0;\n\tlet lineWidthMaximum = NaN;\n\tswitch( textDirection ) {\n\tcase EShapeTextDirection.LEFT_TO_RIGHT:\n\t\tgetTextBBox(\n\t\t\ttextAlignHorizontal,\n\t\t\ttextAlignVertical,\n\t\t\ttextOffsetHorizontal,\n\t\t\ttextOffsetVertical,\n\t\t\ttextPaddingHorizontal,\n\t\t\ttextPaddingVertical,\n\t\t\twidth, height,\n\t\t\tx0, y0,\n\t\t\tx1, y1,\n\t\t\tx2, y2,\n\t\t\tx3, y3,\n\t\t\thnx, hny,\n\t\t\tvnx, vny,\n\t\t\twork\n\t\t);\n\t\ttx0 = work.x;\n\t\tty0 = work.y;\n\t\tif( textClipping ) {\n\t\t\tswitch( textAlignHorizontal ) {\n\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\tswitch( textAlignVertical ) {\n\t\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t\tlineWidthMaximum = hl - textPaddingHorizontal * 2;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase EShapeTextDirection.TOP_TO_BOTTOM:\n\t\t// Swap normals\n\t\twork.set( vnx, vny );\n\t\tvnx = -hnx;\n\t\tvny = -hny;\n\t\thnx = work.x;\n\t\thny = work.y;\n\n\t\t// Get text bbox\n\t\tgetTextBBox(\n\t\t\trotateAlignVerticalRight( textAlignVertical ),\n\t\t\trotateAlignHorizontalRight( textAlignHorizontal ),\n\t\t\ttextOffsetVertical,\n\t\t\ttextOffsetHorizontal,\n\t\t\ttextPaddingVertical,\n\t\t\ttextPaddingHorizontal,\n\t\t\twidth, height,\n\t\t\tx1, y1,\n\t\t\tx2, y2,\n\t\t\tx3, y3,\n\t\t\tx0, y0,\n\t\t\thnx, hny,\n\t\t\tvnx, vny,\n\t\t\twork\n\t\t);\n\t\ttx0 = work.x;\n\t\tty0 = work.y;\n\t\tif( textClipping ) {\n\t\t\tswitch( textAlignVertical ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\tlineWidthMaximum = vl - textPaddingVertical * 2;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tbreak;\n\tcase EShapeTextDirection.BOTTOM_TO_TOP:\n\t\t// Swap normals\n\t\twork.set( vnx, vny );\n\t\tvnx = hnx;\n\t\tvny = hny;\n\t\thnx = -work.x;\n\t\thny = -work.y;\n\n\t\t// Get text bbox\n\t\tgetTextBBox(\n\t\t\trotateAlignVerticalLeft( textAlignVertical ),\n\t\t\trotateAlignHorizontalLeft( textAlignHorizontal ),\n\t\t\ttextOffsetVertical,\n\t\t\ttextOffsetHorizontal,\n\t\t\ttextPaddingVertical,\n\t\t\ttextPaddingHorizontal,\n\t\t\twidth, height,\n\t\t\tx3, y3,\n\t\t\tx0, y0,\n\t\t\tx1, y1,\n\t\t\tx2, y2,\n\t\t\thnx, hny,\n\t\t\tvnx, vny,\n\t\t\twork\n\t\t);\n\t\ttx0 = work.x;\n\t\tty0 = work.y;\n\t\tif( textClipping ) {\n\t\t\tswitch( textAlignVertical ) {\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tswitch( textAlignHorizontal ) {\n\t\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\t\tlineWidthMaximum = vl - textPaddingVertical * 2;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tbreak;\n\t}\n\n\t//\n\tif( lineWidthMaximum < width ) {\n\t\tconst dwidth = ( width - lineWidthMaximum ) * 0.5;\n\t\ttextWorld[ 0 ] = tx0 + hnx * dwidth;\n\t\ttextWorld[ 1 ] = ty0 + hny * dwidth;\n\t\ttextWorld[ 2 ] = hnx;\n\t\ttextWorld[ 3 ] = hny;\n\t\ttextWorld[ 4 ] = vnx;\n\t\ttextWorld[ 5 ] = vny;\n\t\ttextWorld[ 6 ] = lineWidthMaximum;\n\t\ttextWorld[ 7 ] = height;\n\t} else {\n\t\ttextWorld[ 0 ] = tx0;\n\t\ttextWorld[ 1 ] = ty0;\n\t\ttextWorld[ 2 ] = hnx;\n\t\ttextWorld[ 3 ] = hny;\n\t\ttextWorld[ 4 ] = vnx;\n\t\ttextWorld[ 5 ] = vny;\n\t\ttextWorld[ 6 ] = width;\n\t\ttextWorld[ 7 ] = height;\n\t}\n\n\t// Texture\n\tconst uvx0 = textureUvs.x0;\n\tconst uvx1 = textureUvs.x1;\n\tconst uvx3 = textureUvs.x3;\n\tconst uvy0 = textureUvs.y0;\n\tconst uvy1 = textureUvs.y1;\n\tconst uvy3 = textureUvs.y3;\n\n\tconst duvx01 = ( uvx1 - uvx0 );\n\tconst duvy01 = ( uvy1 - uvy0 );\n\tconst duvx03 = ( uvx3 - uvx0 );\n\tconst duvy03 = ( uvy3 - uvy0 );\n\n\t// Vertices & UVs\n\tconst lhx = lineHeight * vnx;\n\tconst lhy = lineHeight * vny;\n\n\tconst snx = scale * hnx;\n\tconst sny = scale * hny;\n\n\tconst offsetY = (heightChar - textSize) * 0.5;\n\tconst oyx = offsetY * vnx;\n\tconst oyy = offsetY * vny;\n\n\tconst offsetItalic = ( textStyle === EShapeTextStyle.NORMAL ? 0 : textSize * 0.25 );\n\tlet bx0 = tx0 - oyx + offsetItalic * snx;\n\tlet by0 = ty0 - oyy + offsetItalic * sny;\n\tlet bx3 = tx0 + oyx + textSize * vnx;\n\tlet by3 = ty0 + oyy + textSize * vny;\n\tlet cx0 = bx0;\n\tlet cy0 = by0;\n\tlet cx3 = bx3;\n\tlet cy3 = by3;\n\n\tlineWidth = 0;\n\tadvancePrevious = 0;\n\titerator.position = 0;\n\tlet lineCount = 0;\n\tlet iv = voffset * 2;\n\tfor( ; iterator.hasNext(); iv += 8 ) {\n\t\tconst character = iterator.next();\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst lineWidthPrevious = lineWidth;\n\t\t\tif( 0 < advancePrevious ) {\n\t\t\t\tlineWidth += Math.max( 0, advancePrevious + textSpacingHorizontal );\n\t\t\t}\n\n\t\t\tconst ax = lineWidth * snx;\n\t\t\tconst ay = lineWidth * sny;\n\t\t\tcx0 = bx0 + ax;\n\t\t\tcy0 = by0 + ay;\n\t\t\tcx3 = bx3 + ax;\n\t\t\tcy3 = by3 + ay;\n\n\t\t\tconst data = textAtlasCharacters[ character ];\n\t\t\tlineCount += 1;\n\t\t\tif( data ) {\n\t\t\t\tconst advance = data.advance;\n\t\t\t\tif( lineWidthMaximum < (lineWidth + advance) * scale ) {\n\t\t\t\t\tconst dots = textAtlasCharacters[ \"...\" ];\n\t\t\t\t\tif( dots ) {\n\t\t\t\t\t\tif( 1 < lineCount && lineWidthMaximum < (lineWidth + dots.advance) * scale ) {\n\t\t\t\t\t\t\tlineWidth = lineWidthPrevious;\n\t\t\t\t\t\t\tiv -= 8;\n\t\t\t\t\t\t\tlineCount -= 1;\n\t\t\t\t\t\t\tconst bx = lineWidth * snx;\n\t\t\t\t\t\t\tconst by = lineWidth * sny;\n\t\t\t\t\t\t\tcx0 = bx0 + bx;\n\t\t\t\t\t\t\tcy0 = by0 + by;\n\t\t\t\t\t\t\tcx3 = bx3 + bx;\n\t\t\t\t\t\t\tcy3 = by3 + by;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tadvancePrevious = dots.advance;\n\n\t\t\t\t\t\twriteCharacter(\n\t\t\t\t\t\t\tvertices, uvs, iv, dots, textAtlas,\n\t\t\t\t\t\t\tsnx, sny,\n\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\tduvx01, duvy01, duvx03, duvy03,\n\t\t\t\t\t\t\tuvx0, uvy0\n\t\t\t\t\t\t);\n\n\t\t\t\t\t\tfor( iv += 8; true; iv += 8 ) {\n\t\t\t\t\t\t\tif( iterator.hasNext() && iterator.advance( \"\\n\" ) ) {\n\t\t\t\t\t\t\t\twriteCharacterEmpty(\n\t\t\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\tlineCount += 1;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tiv -= 8;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tadvancePrevious = advance;\n\n\t\t\t\t\t\twriteCharacterEmpty(\n\t\t\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tadvancePrevious = advance;\n\n\t\t\t\t\twriteCharacter(\n\t\t\t\t\t\tvertices, uvs, iv, data, textAtlas,\n\t\t\t\t\t\tsnx, sny,\n\t\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\t\tduvx01, duvy01, duvx03, duvy03,\n\t\t\t\t\t\tuvx0, uvy0\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tadvancePrevious = 0;\n\n\t\t\t\twriteCharacterEmpty(\n\t\t\t\t\tvertices, uvs, iv,\n\t\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tlineWidth += advancePrevious;\n\t\t\tadvancePrevious = 0;\n\n\t\t\tbx0 += lhx;\n\t\t\tby0 += lhy;\n\t\t\tbx3 += lhx;\n\t\t\tby3 += lhy;\n\t\t\tcx0 = bx0;\n\t\t\tcy0 = by0;\n\t\t\tcx3 = bx3;\n\t\t\tcy3 = by3;\n\n\t\t\twriteCharacterEmpty(\n\t\t\t\tvertices, uvs, iv,\n\t\t\t\tcx0, cy0, cx3, cy3,\n\t\t\t\tuvx0, uvy0, uvx3, uvy3\n\t\t\t);\n\n\t\t\tadjustTextAlignment(\n\t\t\t\tvertices,\n\t\t\t\thnx, hny,\n\t\t\t\tlineCount,\n\t\t\t\tiv,\n\t\t\t\twidth - lineWidth * scale,\n\t\t\t\ttextDirection,\n\t\t\t\ttextAlignHorizontal,\n\t\t\t\ttextAlignVertical\n\t\t\t);\n\t\t\tlineWidth = 0;\n\t\t\tlineCount = 0;\n\t\t}\n\t}\n\n\tlineWidth += advancePrevious;\n\tadjustTextAlignment(\n\t\tvertices,\n\t\thnx, hny,\n\t\tlineCount,\n\t\tiv,\n\t\twidth - lineWidth * scale,\n\t\ttextDirection,\n\t\ttextAlignHorizontal,\n\t\ttextAlignVertical\n\t);\n\n\tfor( const ivmax = (voffset + vcount) * 2; iv < ivmax; iv += 2 ) {\n\t\tvertices[ iv + 0 ] = tx0;\n\t\tvertices[ iv + 1 ] = ty0;\n\t\tuvs[ iv + 0 ] = uvx0;\n\t\tuvs[ iv + 1 ] = uvy0;\n\t}\n};\n\nconst writeCharacterEmpty = (\n\tvertices: Float32Array, uvs: Float32Array, iv: number,\n\tcx0: number, cy0: number,\n\tcx3: number, cy3: number,\n\tuvx0: number, uvy0: number,\n\tuvx3: number, uvy3: number\n): void => {\n\tvertices[ iv + 0 ] = cx0;\n\tvertices[ iv + 1 ] = cy0;\n\tvertices[ iv + 2 ] = cx0;\n\tvertices[ iv + 3 ] = cy0;\n\tvertices[ iv + 4 ] = cx3;\n\tvertices[ iv + 5 ] = cy3;\n\tvertices[ iv + 6 ] = cx3;\n\tvertices[ iv + 7 ] = cy3;\n\n\tuvs[ iv + 0 ] = uvx0;\n\tuvs[ iv + 1 ] = uvy0;\n\tuvs[ iv + 2 ] = uvx0;\n\tuvs[ iv + 3 ] = uvy0;\n\tuvs[ iv + 4 ] = uvx3;\n\tuvs[ iv + 5 ] = uvy3;\n\tuvs[ iv + 6 ] = uvx3;\n\tuvs[ iv + 7 ] = uvy3;\n};\n\nconst writeCharacter = (\n\tvertices: Float32Array, uvs: Float32Array, iv: number,\n\tdata: EShapeTextAtlasCharacter, atlas: EShapeTextAtlas,\n\tsnx: number, sny: number,\n\tcx0: number, cy0: number,\n\tcx3: number, cy3: number,\n\tduvx01: number, duvy01: number,\n\tduvx03: number, duvy03: number,\n\tuvx0: number, uvy0: number\n): void => {\n\t// Vertices\n\tconst dataOffsetX = data.x - data.origin.x;\n\tconst dataWidth = data.width;\n\tconst dx0 = dataOffsetX * snx;\n\tconst dy0 = dataOffsetX * sny;\n\tconst dx1 = (dataOffsetX + dataWidth) * snx;\n\tconst dy1 = (dataOffsetX + dataWidth) * sny;\n\tvertices[ iv + 0 ] = cx0 + dx0;\n\tvertices[ iv + 1 ] = cy0 + dy0;\n\tvertices[ iv + 2 ] = cx0 + dx1;\n\tvertices[ iv + 3 ] = cy0 + dy1;\n\tvertices[ iv + 4 ] = cx3 + dx1;\n\tvertices[ iv + 5 ] = cy3 + dy1;\n\tvertices[ iv + 6 ] = cx3 + dx0;\n\tvertices[ iv + 7 ] = cy3 + dy0;\n\n\t// UVs\n\tconst px0 = data.x / atlas.width;\n\tconst py0 = data.y / atlas.height;\n\tconst px1 = (data.x + data.width) / atlas.width;\n\tconst py1 = (data.y + data.height) / atlas.height;\n\n\tconst dux0 = duvx01 * px0;\n\tconst duy0 = duvy01 * px0;\n\tconst dux1 = duvx01 * px1;\n\tconst duy1 = duvy01 * px1;\n\n\tconst dvx0 = duvx03 * py0;\n\tconst dvy0 = duvy03 * py0;\n\tconst dvx1 = duvx03 * py1;\n\tconst dvy1 = duvy03 * py1;\n\tuvs[ iv + 0 ] = uvx0 + dux0 + dvx0;\n\tuvs[ iv + 1 ] = uvy0 + duy0 + dvy0;\n\tuvs[ iv + 2 ] = uvx0 + dux1 + dvx0;\n\tuvs[ iv + 3 ] = uvy0 + duy1 + dvy0;\n\tuvs[ iv + 4 ] = uvx0 + dux1 + dvx1;\n\tuvs[ iv + 5 ] = uvy0 + duy1 + dvy1;\n\tuvs[ iv + 6 ] = uvx0 + dux0 + dvx1;\n\tuvs[ iv + 7 ] = uvy0 + duy0 + dvy1;\n};\n\nconst moveText = ( vertices: Float32Array, vertexIndex: number, textCount: number, dx: number, dy: number ): void => {\n\tfor( let i = 0, iv = vertexIndex - 8 * textCount; i < textCount; i += 1, iv += 8 ) {\n\t\tvertices[ iv + 0 ] += dx;\n\t\tvertices[ iv + 1 ] += dy;\n\t\tvertices[ iv + 2 ] += dx;\n\t\tvertices[ iv + 3 ] += dy;\n\t\tvertices[ iv + 4 ] += dx;\n\t\tvertices[ iv + 5 ] += dy;\n\t\tvertices[ iv + 6 ] += dx;\n\t\tvertices[ iv + 7 ] += dy;\n\t}\n};\n\nconst moveTextHalf = (\n\tvertices: Float32Array, vertexIndex: number, textCount: number,\n\toffset: number, nx: number, ny: number\n): void => {\n\toffset *= 0.5;\n\tmoveText( vertices, vertexIndex, textCount, offset * nx, offset * ny );\n};\n\nconst moveTextFull = (\n\tvertices: Float32Array, vertexIndex: number, textCount: number,\n\toffset: number, nx: number, ny: number\n): void => {\n\tmoveText( vertices, vertexIndex, textCount, offset * nx, offset * ny );\n};\n\nconst adjustTextAlignment = (\n\tvertices: Float32Array,\n\tnx: number, ny: number,\n\tlineCount: number, vertexIndex: number,\n\toffset: number,\n\ttextDirection: EShapeTextDirection,\n\ttextAlignHorizontal: EShapeTextAlignHorizontal,\n\ttextAlignVertical: EShapeTextAlignVertical\n): void => {\n\tif( TEXT_FMIN < offset ) {\n\t\tswitch( textDirection ) {\n\t\tcase EShapeTextDirection.LEFT_TO_RIGHT:\n\t\t\tswitch( textAlignHorizontal ) {\n\t\t\tcase EShapeTextAlignHorizontal.OUTSIDE_RIGHT:\n\t\t\tcase EShapeTextAlignHorizontal.LEFT:\n\t\t\t\t// DO NOTHING\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignHorizontal.CENTER:\n\t\t\t\tmoveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignHorizontal.OUTSIDE_LEFT:\n\t\t\tcase EShapeTextAlignHorizontal.RIGHT:\n\t\t\t\tmoveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextDirection.TOP_TO_BOTTOM:\n\t\t\tswitch( textAlignVertical ) {\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\t// DO NOTHING\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tmoveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\tmoveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase EShapeTextDirection.BOTTOM_TO_TOP:\n\t\t\tswitch( textAlignVertical ) {\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_BOTTOM:\n\t\t\tcase EShapeTextAlignVertical.TOP:\n\t\t\t\tmoveTextFull( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.MIDDLE:\n\t\t\t\tmoveTextHalf( vertices, vertexIndex, lineCount, offset, nx, ny );\n\t\t\t\tbreak;\n\t\t\tcase EShapeTextAlignVertical.OUTSIDE_TOP:\n\t\t\tcase EShapeTextAlignVertical.BOTTOM:\n\t\t\t\t// DO NOTHING\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n};\n","/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation.\r\n\r\nPermission to use, copy, modify, and/or distribute this software for any\r\npurpose with or without fee is hereby granted.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH\r\nREGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY\r\nAND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,\r\nINDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM\r\nLOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR\r\nOTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR\r\nPERFORMANCE OF THIS SOFTWARE.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nexport function __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nexport var __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    }\r\n    return __assign.apply(this, arguments);\r\n}\r\n\r\nexport function __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nexport function __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nexport function __param(paramIndex, decorator) {\r\n    return function (target, key) { decorator(target, key, paramIndex); }\r\n}\r\n\r\nexport function __metadata(metadataKey, metadataValue) {\r\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(metadataKey, metadataValue);\r\n}\r\n\r\nexport function __awaiter(thisArg, _arguments, P, generator) {\r\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nexport function __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nexport var __createBinding = Object.create ? (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\r\n}) : (function(o, m, k, k2) {\r\n    if (k2 === undefined) k2 = k;\r\n    o[k2] = m[k];\r\n});\r\n\r\nexport function __exportStar(m, o) {\r\n    for (var p in m) if (p !== \"default\" && !Object.prototype.hasOwnProperty.call(o, p)) __createBinding(o, m, p);\r\n}\r\n\r\nexport function __values(o) {\r\n    var s = typeof Symbol === \"function\" && Symbol.iterator, m = s && o[s], i = 0;\r\n    if (m) return m.call(o);\r\n    if (o && typeof o.length === \"number\") return {\r\n        next: function () {\r\n            if (o && i >= o.length) o = void 0;\r\n            return { value: o && o[i++], done: !o };\r\n        }\r\n    };\r\n    throw new TypeError(s ? \"Object is not iterable.\" : \"Symbol.iterator is not defined.\");\r\n}\r\n\r\nexport function __read(o, n) {\r\n    var m = typeof Symbol === \"function\" && o[Symbol.iterator];\r\n    if (!m) return o;\r\n    var i = m.call(o), r, ar = [], e;\r\n    try {\r\n        while ((n === void 0 || n-- > 0) && !(r = i.next()).done) ar.push(r.value);\r\n    }\r\n    catch (error) { e = { error: error }; }\r\n    finally {\r\n        try {\r\n            if (r && !r.done && (m = i[\"return\"])) m.call(i);\r\n        }\r\n        finally { if (e) throw e.error; }\r\n    }\r\n    return ar;\r\n}\r\n\r\nexport function __spread() {\r\n    for (var ar = [], i = 0; i < arguments.length; i++)\r\n        ar = ar.concat(__read(arguments[i]));\r\n    return ar;\r\n}\r\n\r\nexport function __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n};\r\n\r\nexport function __await(v) {\r\n    return this instanceof __await ? (this.v = v, this) : new __await(v);\r\n}\r\n\r\nexport function __asyncGenerator(thisArg, _arguments, generator) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var g = generator.apply(thisArg, _arguments || []), i, q = [];\r\n    return i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i;\r\n    function verb(n) { if (g[n]) i[n] = function (v) { return new Promise(function (a, b) { q.push([n, v, a, b]) > 1 || resume(n, v); }); }; }\r\n    function resume(n, v) { try { step(g[n](v)); } catch (e) { settle(q[0][3], e); } }\r\n    function step(r) { r.value instanceof __await ? Promise.resolve(r.value.v).then(fulfill, reject) : settle(q[0][2], r); }\r\n    function fulfill(value) { resume(\"next\", value); }\r\n    function reject(value) { resume(\"throw\", value); }\r\n    function settle(f, v) { if (f(v), q.shift(), q.length) resume(q[0][0], q[0][1]); }\r\n}\r\n\r\nexport function __asyncDelegator(o) {\r\n    var i, p;\r\n    return i = {}, verb(\"next\"), verb(\"throw\", function (e) { throw e; }), verb(\"return\"), i[Symbol.iterator] = function () { return this; }, i;\r\n    function verb(n, f) { i[n] = o[n] ? function (v) { return (p = !p) ? { value: __await(o[n](v)), done: n === \"return\" } : f ? f(v) : v; } : f; }\r\n}\r\n\r\nexport function __asyncValues(o) {\r\n    if (!Symbol.asyncIterator) throw new TypeError(\"Symbol.asyncIterator is not defined.\");\r\n    var m = o[Symbol.asyncIterator], i;\r\n    return m ? m.call(o) : (o = typeof __values === \"function\" ? __values(o) : o[Symbol.iterator](), i = {}, verb(\"next\"), verb(\"throw\"), verb(\"return\"), i[Symbol.asyncIterator] = function () { return this; }, i);\r\n    function verb(n) { i[n] = o[n] && function (v) { return new Promise(function (resolve, reject) { v = o[n](v), settle(resolve, reject, v.done, v.value); }); }; }\r\n    function settle(resolve, reject, d, v) { Promise.resolve(v).then(function(v) { resolve({ value: v, done: d }); }, reject); }\r\n}\r\n\r\nexport function __makeTemplateObject(cooked, raw) {\r\n    if (Object.defineProperty) { Object.defineProperty(cooked, \"raw\", { value: raw }); } else { cooked.raw = raw; }\r\n    return cooked;\r\n};\r\n\r\nvar __setModuleDefault = Object.create ? (function(o, v) {\r\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\r\n}) : function(o, v) {\r\n    o[\"default\"] = v;\r\n};\r\n\r\nexport function __importStar(mod) {\r\n    if (mod && mod.__esModule) return mod;\r\n    var result = {};\r\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\r\n    __setModuleDefault(result, mod);\r\n    return result;\r\n}\r\n\r\nexport function __importDefault(mod) {\r\n    return (mod && mod.__esModule) ? mod : { default: mod };\r\n}\r\n\r\nexport function __classPrivateFieldGet(receiver, privateMap) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to get private field on non-instance\");\r\n    }\r\n    return privateMap.get(receiver);\r\n}\r\n\r\nexport function __classPrivateFieldSet(receiver, privateMap, value) {\r\n    if (!privateMap.has(receiver)) {\r\n        throw new TypeError(\"attempted to set private field on non-instance\");\r\n    }\r\n    privateMap.set(receiver, value);\r\n    return value;\r\n}\r\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\nimport {\n\tEShapeLineBasePoints, EShapeLineBasePointsHitTester, EShapeLineBasePointsTestRange\n} from \"./e-shape-line-base-points\";\n\nexport class EShapeBarPoints implements EShapeLineBasePoints {\n\tprotected _parent: EShape;\n\tprotected _id: number;\n\tprotected _style: EShapePointsStyle;\n\tprotected _values: [ number, number, number, number ];\n\tprotected _segments: number[];\n\tprotected _size: number;\n\tprotected _position: EShapeBarPosition;\n\n\tprotected _updatedSize: number;\n\tprotected _updatedParentSizeX: number;\n\tprotected _updatedParentSizeY: number;\n\tprotected _updatedPosition: EShapeBarPosition;\n\n\tconstructor( parent: EShape, position: EShapeBarPosition, size?: number, style?: EShapePointsStyle ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._values = [ 0, 0, 0, 0 ];\n\t\tthis._segments = [];\n\t\tthis._style = style != null ? style : EShapePointsStyle.NONE;\n\t\tthis._size = size != null ? size : -1;\n\t\tthis._position = position;\n\n\t\tthis._updatedSize = NaN;\n\t\tthis._updatedParentSizeX = NaN;\n\t\tthis._updatedParentSizeY = NaN;\n\t\tthis._updatedPosition = NaN;\n\t}\n\n\tprotected getComputedSize( size: number, position: EShapeBarPosition, sizeX: number, sizeY: number ): number {\n\t\tif( 0 <= size ) {\n\t\t\treturn size;\n\t\t} else {\n\t\t\tswitch( position ) {\n\t\t\tcase EShapeBarPosition.TOP:\n\t\t\tcase EShapeBarPosition.BOTTOM:\n\t\t\t\treturn Math.abs( sizeY );\n\t\t\tcase EShapeBarPosition.RIGHT:\n\t\t\tcase EShapeBarPosition.LEFT:\n\t\t\t\treturn Math.abs( sizeX );\n\t\t\t}\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tprotected update(): void {\n\t\tconst parentSize = this._parent.size;\n\t\tconst parentSizeX = parentSize.x;\n\t\tconst parentSizeY = parentSize.y;\n\t\tconst position = this._position;\n\t\tconst size = this._size;\n\t\tif( this._updatedSize !== size || this._updatedParentSizeX !== parentSizeX ||\n\t\t\tthis._updatedParentSizeY !== parentSizeY || this._updatedPosition !== position ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._updatedSize = size;\n\t\t\tthis._updatedParentSizeX = parentSizeX;\n\t\t\tthis._updatedParentSizeY = parentSizeY;\n\t\t\tthis._updatedPosition = position;\n\t\t\tconst psxh = parentSizeX * 0.5;\n\t\t\tconst psyh = parentSizeY * 0.5;\n\t\t\tconst computedSize = this.getComputedSize( size, position, parentSizeX, parentSizeY );\n\t\t\tconst values = this._values;\n\t\t\tswitch( position ) {\n\t\t\tcase EShapeBarPosition.TOP:\n\t\t\t\tvalues[ 0 ] = 0;\n\t\t\t\tvalues[ 1 ] = -psyh;\n\t\t\t\tvalues[ 2 ] = 0;\n\t\t\t\tvalues[ 3 ] = -psyh + computedSize;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.RIGHT:\n\t\t\t\tvalues[ 0 ] = psxh;\n\t\t\t\tvalues[ 1 ] = 0;\n\t\t\t\tvalues[ 2 ] = psxh - computedSize;\n\t\t\t\tvalues[ 3 ] = 0;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.BOTTOM:\n\t\t\t\tvalues[ 0 ] = 0;\n\t\t\t\tvalues[ 1 ] = psyh;\n\t\t\t\tvalues[ 2 ] = 0;\n\t\t\t\tvalues[ 3 ] = psyh - computedSize;\n\t\t\t\tbreak;\n\t\t\tcase EShapeBarPosition.LEFT:\n\t\t\t\tvalues[ 0 ] = -psxh;\n\t\t\t\tvalues[ 1 ] = 0;\n\t\t\t\tvalues[ 2 ] = -psxh + computedSize;\n\t\t\t\tvalues[ 3 ] = 0;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tget length(): number {\n\t\treturn 2;\n\t}\n\n\tget id(): number {\n\t\tthis.update();\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\tthis.update();\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\t// SUPPOSED NOT TO BE CALLED\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\tset segments( segments: number[] ) {\n\t\t// SUPPOSED NOT TO BE CALLED\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tthis.moveTo( undefined, size, undefined );\n\t}\n\n\tget position(): EShapeBarPosition {\n\t\treturn this._position;\n\t}\n\n\tset position( position: EShapeBarPosition ) {\n\t\tthis.moveTo( position, undefined, undefined );\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.moveTo( undefined, undefined, style );\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\tif( source instanceof EShapeBarPoints ) {\n\t\t\treturn this.moveTo( source.position, source.size, source.style );\n\t\t} else {\n\t\t\treturn this.moveTo( undefined, undefined, source.style );\n\t\t}\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet newPosition: EShapeBarPosition | undefined;\n\t\tlet newSize: number | undefined;\n\t\tif( newValues != null ) {\n\t\t\tconst x0 = newValues[ 0 ];\n\t\t\tif( x0 === 0 ) {\n\t\t\t\tconst y0 = newValues[ 1 ];\n\t\t\t\tnewPosition = ( y0 <= 0 ? EShapeBarPosition.TOP : EShapeBarPosition.BOTTOM );\n\t\t\t\tnewSize = Math.abs( newValues[ 3 ] - y0 );\n\t\t\t} else {\n\t\t\t\tnewPosition = ( x0 <= 0 ? EShapeBarPosition.LEFT : EShapeBarPosition.RIGHT );\n\t\t\t\tnewSize = Math.abs( newValues[ 2 ] - x0 );\n\t\t\t}\n\t\t}\n\t\treturn this.moveTo( newPosition, newSize, newStyle );\n\t}\n\n\tprotected moveTo( position?: EShapeBarPosition, size?: number, style?: EShapePointsStyle ): this {\n\t\tlet isChanged = false;\n\n\t\tif( style != null && this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( position != null && this._position !== position ) {\n\t\t\tthis._position = position;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( size != null && this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclone( parent: EShape ): EShapeBarPoints {\n\t\treturn new EShapeBarPoints( parent, this._position, this._size, this._style );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.addResource( `[${this._position},${this._size},${this._style}]` );\n\t}\n\n\tdeserialize( resourceId: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tif( 0 <= resourceId && resourceId < manager.resources.length ) {\n\t\t\tconst resource = manager.resources[ resourceId ];\n\t\t\tconst parsed = JSON.parse( resource ) as [ number, number, number ];\n\t\t\tthis.moveTo( parsed[ 0 ], parsed[ 1 ], parsed[ 2 ] );\n\t\t}\n\t}\n\n\tcalcHitPointAbs<RESULT>(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tthreshold: number,\n\t\trange: EShapeLineBasePointsTestRange | null,\n\t\ttester: EShapeLineBasePointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst length = this.length;\n\t\tif( 2 <= length ) {\n\t\t\tconst values = this._values;\n\t\t\tconst v0x = values[ 0 ];\n\t\t\tconst v0y = values[ 1 ];\n\t\t\tconst v1x = values[ 2 ];\n\t\t\tconst v1y = values[ 3 ];\n\t\t\tif( tester( x, y, v0x, v0y, v1x, v1y, 0, threshold, result ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Point, Rectangle, Renderer, Texture, utils } from \"pixi.js\";\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { EShapeAction } from \"./action/e-shape-action\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeCorner } from \"./e-shape-corner\";\nimport { EShapeEditor } from \"./e-shape-editor\";\nimport { EShapeFill } from \"./e-shape-fill\";\nimport { EShapeGradientLike } from \"./e-shape-gradient\";\nimport { EShapeLayout } from \"./e-shape-layout\";\nimport { EShapePoints } from \"./e-shape-points\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeRuntime } from \"./e-shape-runtime\";\nimport { EShapeStateSet } from \"./e-shape-state-set\";\nimport { EShapeStroke } from \"./e-shape-stroke\";\nimport { EShapeTag } from \"./e-shape-tag\";\nimport { EShapeText } from \"./e-shape-text\";\nimport { EShapeTransform } from \"./e-shape-transform\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\n\nexport enum EShapeCopyPart {\n\tNONE = 0,\n\tTRANSFORM = 1,\n\tSIZE = 2,\n\tSTYLE = 4,\n\tACTION = 8,\n\tPOINTS = 16,\n\tSTATE = 32,\n\tALL = TRANSFORM | SIZE | STYLE | ACTION | POINTS | STATE\n}\n\nexport interface EShape extends utils.EventEmitter {\n\tid: string; // Used to identity a shape by users\n\tuuid: number; // Used to identify a shape uniquely\n\treadonly type: EShapeType;\n\treadonly size: IPoint;\n\treadonly fill: EShapeFill;\n\treadonly stroke: EShapeStroke;\n\treadonly transform: EShapeTransform;\n\tradius: number;\n\tcorner: EShapeCorner;\n\treadonly points?: EShapePoints;\n\timage?: HTMLImageElement;\n\timageSrc?: string;\n\ttexture?: Texture;\n\tgradient?: EShapeGradientLike;\n\treadonly text: EShapeText;\n\treadonly tag: EShapeTag;\n\treadonly action: EShapeAction;\n\tcursor: string;\n\tvisible: boolean;\n\treadonly worldVisible: boolean;\n\tinteractive: boolean;\n\tshortcut?: string;\n\ttitle?: string;\n\n\t// Hierarchy\n\tparent: EShapeContainer | EShape | null;\n\troot: EShape;\n\tchildren: EShape[];\n\tlayout?: EShapeLayout;\n\n\t// Working space\n\tindex: number;\t\t// A work space for sorting.\n\tselected: boolean;\n\treference: number;\t// Count of references from commands\n\n\t// Working space for the viewer\n\truntime?: EShapeRuntime;\n\n\t// Working space for the editor\n\teditor?: EShapeEditor;\n\n\t// Working space for the renderer\n\tuploaded?: EShapeUploaded;\n\n\t//\n\treadonly state: EShapeStateSet;\n\n\t//\n\ttoDirty(): void;\n\tattach( parent: EShapeContainer | EShape, at?: number ): this;\n\tdetach(): this;\n\tcopy( source: EShape ): this;\n\tcopy( source: EShape, part: EShapeCopyPart ): this;\n\tclone(): EShape;\n\tdestroy(): void;\n\n\t//\n\tfocus(): this;\n\tblur(): this;\n\n\t//\n\tonSizeChange(): void;\n\n\t// Action\n\tupdate( time: number ): void;\n\tonRender( time: number, renderer: Renderer ): void;\n\n\t// Transform\n\tupdateTransform(): void;\n\tdisallowOnTransformChange(): void;\n\tallowOnTransformChange( invokeOnTransformChange: boolean ): void;\n\tonTransformChange(): void;\n\tonChildTransformChange(): void;\n\n\t// Uploaded\n\tdisallowUploadedUpdate(): void;\n\tallowUploadedUpdate(): void;\n\tupdateUploaded(): void;\n\tupdateUploadedRecursively(): void;\n\n\t// Serialization\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem;\n\taddUuid( manager: EShapeResourceManagerSerialization ): void;\n\tupdateUuid( manager: EShapeResourceManagerSerialization ): void;\n\n\t// Hit test\n\tcontains( point: Point ): EShape | null;\n\tcontainsBBox( point: Point ): boolean;\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean;\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean;\n\n\t// Coordinate\n\ttoGlobal( position: IPoint, result: Point, skipUpdate?: boolean ): Point;\n\ttoLocal( position: IPoint, from?: DisplayObject, result?: Point, skipUpdate?: boolean ): Point;\n\tgetBounds( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n\tgetBoundsInternal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n\tgetBoundsLocal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationLayerLike } from \"./d-application-layer-like\";\nimport { DApplicationLayerStageLike } from \"./d-application-layer-stage-like\";\nimport { DApplicationLike, DApplicationTarget } from \"./d-application-like\";\n\nexport class DApplications {\n\tprotected static INSTANCES: DApplicationLike[] = [];\n\n\tstatic add( instance: DApplicationLike ): void {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tinstances.push( instance );\n\t}\n\n\tstatic first(): DApplicationLike {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tif( 0 < instances.length ) {\n\t\t\treturn instances[ 0 ];\n\t\t}\n\t\tthrow new Error( \"No application found.\" );\n\t}\n\n\tstatic last(): DApplicationLike {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tif( 0 < instances.length ) {\n\t\t\treturn instances[ instances.length - 1 ];\n\t\t}\n\t\tthrow new Error( \"No application found.\" );\n\t}\n\n\tstatic get( index: number ): DApplicationLike | null {\n\t\tconst instances = DApplications.INSTANCES;\n\t\tif( 0 <= index && index < instances.length ) {\n\t\t\treturn instances[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic indexOf( instance: DApplicationLike ): number {\n\t\treturn DApplications.INSTANCES.indexOf( instance );\n\t}\n\n\tstatic size(): number {\n\t\treturn DApplications.INSTANCES.length;\n\t}\n\n\tprotected static getStage( target: DApplicationTarget ): DApplicationLayerStageLike | null {\n\t\tlet stage: any = target;\n\t\twhile( stage.parent ) {\n\t\t\tstage = stage.parent;\n\t\t}\n\t\tif( (\"application\" in stage) && (\"layer\" in stage) ) {\n\t\t\treturn stage as DApplicationLayerStageLike;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic find( target: DApplicationTarget ): DApplicationLike | null {\n\t\tconst stage = this.getStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer.application;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic getLayerBase( target: DApplicationTarget ): DApplicationLayerLike | null {\n\t\tconst stage = this.getStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer.application.getLayerBase();\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic getLayerOverlay( target: DApplicationTarget ): DApplicationLayerLike | null {\n\t\tconst stage = this.getStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer.application.getLayerOverlay();\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic getLayer( target: DApplicationTarget ): DApplicationLayerLike | null {\n\t\tconst stage = this.getStage( target );\n\t\tif( stage ) {\n\t\t\treturn stage.layer;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic getResolution( target: DApplicationTarget ): number {\n\t\tconst layer = this.getLayer( target );\n\t\tif( layer ) {\n\t\t\treturn layer.renderer.resolution;\n\t\t}\n\t\treturn (window.devicePixelRatio ?? 1);\n\t}\n\n\tstatic update( target?: DApplicationTarget ): void {\n\t\tif( target ) {\n\t\t\tconst stage = this.getStage( target );\n\t\t\tif( stage ) {\n\t\t\t\tstage.layer.update();\n\t\t\t}\n\t\t} else {\n\t\t\tconst instances = DApplications.INSTANCES;\n\t\t\tfor( let i = 0, imax = instances.length; i < imax; ++i ) {\n\t\t\t\tinstances[ i ].update();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic render( target?: DApplicationTarget ): void {\n\t\tif( target ) {\n\t\t\tconst stage = this.getStage( target );\n\t\t\tif( stage ) {\n\t\t\t\tstage.layer.render();\n\t\t\t}\n\t\t} else {\n\t\t\tconst instances = DApplications.INSTANCES;\n\t\t\tfor( let i = 0, imax = instances.length; i < imax; ++i ) {\n\t\t\t\tinstances[ i ].render();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\n\nexport class EShapeAction {\n\tvalues: EShapeActionValue[];\n\n\tconstructor() {\n\t\tthis.values = [];\n\t}\n\n\tadd( value: EShapeActionValue, index?: number ): void {\n\t\tconst values = this.values;\n\t\tif( index != null ) {\n\t\t\tvalues.splice( index, 0, value );\n\t\t} else {\n\t\t\tvalues.push( value );\n\t\t}\n\t}\n\n\taddAll( values: EShapeActionValue[] ): void {\n\t\tconst sources = values;\n\t\tconst destinations = this.values;\n\t\tfor( let i = 0, imax = sources.length; i < imax; ++i) {\n\t\t\tdestinations.push( sources[i] );\n\t\t}\n\t}\n\n\tindexOf( target: EShapeActionValue ): number {\n\t\tconst values = this.values;\n\n\t\t// Instance-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value === target ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// Data-based matching\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tconst value = values[ i ];\n\t\t\tif( value.isEquals( target ) ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tget( index: number ): EShapeActionValue | null {\n\t\tconst result = this.values[ index ];\n\t\tif( result != null ) {\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, value: EShapeActionValue ): void {\n\t\tthis.values[ index ] = value;\n\t}\n\n\tremove( index: number ): void {\n\t\tthis.values.splice( index, 1 );\n\t}\n\n\tclear(): void {\n\t\tthis.values.length = 0;\n\t}\n\n\tsize(): number {\n\t\treturn this.values.length;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tconst values = this.values;\n\t\tconst tmp = values[ indexB ];\n\t\tvalues[ indexB ] = values[ indexA ];\n\t\tvalues[ indexA ] = tmp;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number[] {\n\t\tconst result: number[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\tresult.push( values[ i ].serialize( manager ) );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const DBaseState = {\n\tHOVERED\t\t\t: \"HOVERED\",\n\tACTIVE\t\t\t: \"ACTIVE\",\n\tFOCUSED\t\t\t: \"FOCUSED\",\n\tUNFOCUSABLE\t\t: \"UNFOCUSABLE\",\n\tFOCUS_ROOT\t\t: \"FOCUS_ROOT\",\n\tFOCUS_REVERSE\t: \"FOCUS_REVERSE\",\n\tREAD_ONLY\t\t: \"READ_ONLY\",\n\tDISABLED\t\t: \"DISABLED\",\n\tDRAGGING\t\t: \"DRAGGING\",\n\tPRESSED\t\t\t: \"PRESSED\",\n\tINVALID\t\t\t: \"INVALID\",\n\tSUCCEEDED\t\t: \"SUCCEEDED\",\n\tFAILED\t\t\t: \"FAILED\",\n\tWARNED\t\t\t: \"WARNED\",\n\tCHANGED\t\t\t: \"CHANGED\",\n\tALTERNATED\t\t: \"ALTERNATED\",\n\tNEW_WINDOW\t\t: \"NEW_WINDOW\"\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeCorner {\n\tNONE = 0,\n\tTOP_LEFT = 1,\n\tTOP_RIGHT = 2,\n\tBOTTOM_LEFT = 4,\n\tBOTTOM_RIGHT = 8,\n\tTOP = TOP_LEFT | TOP_RIGHT,\n\tBOTTOM = BOTTOM_LEFT | BOTTOM_RIGHT,\n\tLEFT = TOP_LEFT | BOTTOM_LEFT,\n\tRIGHT = TOP_RIGHT | BOTTOM_RIGHT,\n\tALL = TOP | BOTTOM\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseStateSetData } from \"./d-base-state-set-data\";\nimport { DBaseStateSetDataLike } from \"./d-base-state-set-data-like\";\n\nexport class DBaseStateSetDataImpl implements DBaseStateSetData {\n\tprotected _data: Map<unknown, unknown>;\n\n\tconstructor() {\n\t\tthis._data = new Map<unknown, unknown>();\n\t}\n\n\tset( key: unknown, data: unknown ): this {\n\t\tthis._data.set( key, data );\n\t\treturn this;\n\t}\n\n\tget( key: unknown ): undefined | unknown {\n\t\treturn this._data.get( key );\n\t}\n\n\tdelete( key: unknown ): boolean {\n\t\treturn this._data.delete( key );\n\t}\n\n\tclear(): this {\n\t\tthis._data.clear();\n\t\treturn this;\n\t}\n\n\teach( iteratee: ( data: unknown, key: unknown ) => void ): this {\n\t\tthis._data.forEach(( data: unknown, key: unknown ): void => {\n\t\t\titeratee( data, key );\n\t\t});\n\t\treturn this;\n\t}\n\n\tsize(): number {\n\t\treturn this._data.size;\n\t}\n\n\tcopy( other: DBaseStateSetData ): this {\n\t\tif( other instanceof DBaseStateSetDataImpl ) {\n\t\t\tconst otherData = other._data;\n\t\t\tconst thisData = this._data;\n\t\t\tthisData.clear();\n\t\t\totherData.forEach(( data, key ): void => {\n\t\t\t\tthisData.set( key, data );\n\t\t\t});\n\t\t}\n\t\treturn this;\n\t}\n\n\ttoArray(): DBaseStateSetDataLike {\n\t\tconst result: DBaseStateSetDataLike = [];\n\t\tthis._data.forEach(( data, key ): void => {\n\t\t\tresult.push([ data, key ]);\n\t\t});\n\t\treturn result;\n\t}\n\n\ttoString(): string {\n\t\treturn JSON.stringify( this.toArray() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isFunction = ( target: unknown ): target is Function => {\n\treturn (typeof target) === \"function\";\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isString = ( target: unknown ): target is string => {\n\treturn ( typeof target === \"string\" ) ||\n\t\t( Object.prototype.toString.call( target ) === \"[object String]\" );\n};\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBaseStateSetData } from \"./d-base-state-set-data\";\nimport { DBaseStateSetDataImpl } from \"./d-base-state-set-data-impl\";\nimport { DBaseStateSetLike } from \"./d-base-state-set-like\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\nexport class DBaseStateSetImpl implements DBaseStateSet {\n\tprotected _local: Set<string>;\n\tprotected _parent: DBaseStateSet | null;\n\tprotected _data?: DBaseStateSetData;\n\n\tconstructor() {\n\t\tthis._local = new Set<string>();\n\t\tthis._parent = null;\n\t}\n\n\tis( state: string ): boolean {\n\t\treturn this._local.has( state );\n\t}\n\n\tin( state: string ): boolean {\n\t\treturn this.is( state ) || this.under( state );\n\t}\n\n\ton( state: string ): boolean {\n\t\treturn this._parent?.is( state ) ?? false;\n\t}\n\n\tunder( state: string ): boolean {\n\t\treturn this._parent?.in( state ) ?? false;\n\t}\n\n\tlock( callOnChange?: boolean ): this {\n\t\treturn this;\n\t}\n\n\tunlock(): this {\n\t\treturn this;\n\t}\n\n\tprotected begin(): this {\n\t\treturn this;\n\t}\n\n\tprotected end(): this {\n\t\treturn this;\n\t}\n\n\tprotected checkAdded( added: string ): boolean {\n\t\treturn ! this._local.has( added );\n\t}\n\n\tadd( state: string ): this {\n\t\tif( this.checkAdded( state ) ) {\n\t\t\tthis.begin();\n\t\t\tthis._local.add( state );\n\t\t\tthis.end();\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected checkAddeds( states: string[] ) {\n\t\tconst local = this._local;\n\t\tfor( let i = 0, imax = states.length; i < imax; ++i ) {\n\t\t\tif( ! local.has( states[ i ] ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\taddAll( states: string[] ): this;\n\taddAll( ...states: string[] ): this;\n\taddAll( stateOrStates: string | string[] ): this {\n\t\tconst states = ( isString( stateOrStates ) ?\n\t\t\targuments as unknown as string[] : stateOrStates\n\t\t);\n\t\tif( this.checkAddeds( states ) ) {\n\t\t\tthis.begin();\n\t\t\tconst local = this._local;\n\t\t\tfor( let i = 0, imax = states.length; i < imax; ++i ) {\n\t\t\t\tlocal.add( states[ i ] );\n\t\t\t}\n\t\t\tthis.end();\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected checkRemoved( removed: string ): boolean {\n\t\treturn this._local.has( removed );\n\t}\n\n\tremove( state: string ): this {\n\t\tif( this.checkRemoved( state ) ) {\n\t\t\tthis.begin();\n\t\t\tthis._local.delete( state );\n\t\t\tthis.end();\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected checkRemoveds( states: string[] ) {\n\t\tconst local = this._local;\n\t\tfor( let i = 0, imax = states.length; i < imax; ++i ) {\n\t\t\tif( local.has( states[ i ] ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tremoveAll( states: string[] ): this;\n\tremoveAll( ...states: string[] ): this;\n\tremoveAll( matcher: ( state: string ) => void | boolean ): this;\n\tremoveAll( stateOrStatesOrMatcher: string | string[] | (( state: string ) => void | boolean) ): this {\n\t\tconst local = this._local;\n\t\tif( isFunction( stateOrStatesOrMatcher ) ) {\n\t\t\tlet isDirty = false;\n\t\t\tlocal.forEach(( state ): void => {\n\t\t\t\tif( stateOrStatesOrMatcher( state ) ) {\n\t\t\t\t\tif( ! isDirty ) {\n\t\t\t\t\t\tisDirty = true;\n\t\t\t\t\t\tthis.begin();\n\t\t\t\t\t}\n\t\t\t\t\tlocal.delete( state );\n\t\t\t\t}\n\t\t\t});\n\t\t\tif( isDirty ) {\n\t\t\t\tthis.end();\n\t\t\t}\n\t\t} else {\n\t\t\tconst states = ( isString( stateOrStatesOrMatcher ) ?\n\t\t\t\targuments as unknown as string[] : stateOrStatesOrMatcher\n\t\t\t);\n\t\t\tif( this.checkRemoveds( states ) ) {\n\t\t\t\tthis.begin();\n\t\t\t\tfor( let i = 0, imax = states.length; i < imax; ++i ) {\n\t\t\t\t\tlocal.delete( states[ i ] );\n\t\t\t\t}\n\t\t\t\tthis.end();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tclear(): this {\n\t\tconst local = this._local;\n\t\tif( 0 < local.size ) {\n\t\t\tthis.begin();\n\t\t\tlocal.clear();\n\t\t\tthis.end();\n\t\t}\n\t\treturn this;\n\t}\n\n\tset( state: string, isOn: boolean ): this;\n\tset( added: string | null, removed: string | null ): this;\n\tset( stateOrAdded: string | null, isOnOrRemoved: string | null | boolean ): this {\n\t\tif( isOnOrRemoved === true ) {\n\t\t\tthis.add( stateOrAdded! );\n\t\t} else if( isOnOrRemoved === false ) {\n\t\t\tthis.remove( stateOrAdded! );\n\t\t} else {\n\t\t\tconst added = stateOrAdded;\n\t\t\tconst removed = isOnOrRemoved;\n\t\t\tif( added != null ) {\n\t\t\t\tif( removed != null ) {\n\t\t\t\t\tif( this.checkAdded( added ) || this.checkRemoved( removed ) ) {\n\t\t\t\t\t\tthis.begin();\n\t\t\t\t\t\tthis._local.add( added ).delete( removed );\n\t\t\t\t\t\tthis.end();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.add( added );\n\t\t\t\t}\n\t\t\t} else if( removed != null ) {\n\t\t\t\tthis.remove( removed );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tsetAll( states: string[], isOn: boolean ): this;\n\tsetAll( addeds: string[] | null, removeds: string[] | null ): this;\n\tsetAll( statesOrAddeds: string[] | null, isOnOrRemoveds: string[] | null | boolean ): this {\n\t\tif( isOnOrRemoveds === true ) {\n\t\t\tthis.addAll( statesOrAddeds! );\n\t\t} else if( isOnOrRemoveds === false ) {\n\t\t\tthis.removeAll( statesOrAddeds! );\n\t\t} else {\n\t\t\tconst addeds = statesOrAddeds;\n\t\t\tconst removeds = isOnOrRemoveds;\n\t\t\tif( addeds != null ) {\n\t\t\t\tif( removeds != null ) {\n\t\t\t\t\tif( this.checkAddeds( addeds ) || this.checkRemoveds( removeds ) ) {\n\t\t\t\t\t\tthis.begin();\n\t\t\t\t\t\tconst local = this._local;\n\t\t\t\t\t\tfor( let i = 0, imax = addeds.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tlocal.add( addeds[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor( let i = 0, imax = removeds.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tlocal.delete( removeds[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tthis.end();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.addAll( addeds );\n\t\t\t\t}\n\t\t\t} else if( removeds != null ) {\n\t\t\t\tthis.removeAll( removeds );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\teach( iteratee: ( state: string ) => void ): this {\n\t\tthis._local.forEach(( state: string ): void => {\n\t\t\titeratee( state );\n\t\t});\n\t\treturn this;\n\t}\n\n\tsize(): number {\n\t\treturn this._local.size;\n\t}\n\n\tcopy( other: DBaseStateSet ): this {\n\t\tif( other instanceof DBaseStateSetImpl ) {\n\t\t\tthis.begin();\n\t\t\tconst local = this._local;\n\t\t\tlocal.clear();\n\t\t\tother.local.forEach(( value: string ): void => {\n\t\t\t\tlocal.add( value );\n\t\t\t});\n\t\t\tthis._parent = other.parent;\n\t\t\tconst otherData = other._data;\n\t\t\tif( otherData != null ) {\n\t\t\t\tthis.data.copy( otherData );\n\t\t\t}\n\t\t\tthis.end();\n\t\t}\n\t\treturn this;\n\t}\n\n\tget local(): Set<string> {\n\t\treturn this._local;\n\t}\n\n\tget parent(): DBaseStateSet | null {\n\t\treturn this._parent;\n\t}\n\n\tset parent( parent: DBaseStateSet | null ) {\n\t\tif( this._parent !== parent ) {\n\t\t\tthis.begin();\n\t\t\tthis._parent = parent;\n\t\t\tthis.end();\n\t\t}\n\t}\n\n\tget data(): DBaseStateSetData {\n\t\tlet result = this._data;\n\t\tif( result == null ) {\n\t\t\tresult = new DBaseStateSetDataImpl();\n\t\t\tthis._data = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tonParentChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tthis._parent = oldState;\n\t\tthis.begin();\n\t\tthis._parent = newState;\n\t\tthis.end();\n\t}\n\n\tget isHovered(): boolean {\n\t\treturn this.is( DBaseState.HOVERED );\n\t}\n\n\tset isHovered( isHovered: boolean ) {\n\t\tthis.set( DBaseState.HOVERED, isHovered );\n\t}\n\n\tget inHovered(): boolean {\n\t\treturn this.in( DBaseState.HOVERED );\n\t}\n\n\tget onHovered(): boolean {\n\t\treturn this.on( DBaseState.HOVERED );\n\t}\n\n\tget underHovered(): boolean {\n\t\treturn this.under( DBaseState.HOVERED );\n\t}\n\n\tget isActive(): boolean {\n\t\treturn this.is( DBaseState.ACTIVE );\n\t}\n\n\tset isActive( isActive: boolean ) {\n\t\tthis.set( DBaseState.ACTIVE, isActive );\n\t}\n\n\tget inActive(): boolean {\n\t\treturn this.in( DBaseState.ACTIVE );\n\t}\n\n\tget onActive(): boolean {\n\t\treturn this.on( DBaseState.ACTIVE );\n\t}\n\n\tget underActive(): boolean {\n\t\treturn this.under( DBaseState.ACTIVE );\n\t}\n\n\tget isPressed(): boolean {\n\t\treturn this.is( DBaseState.PRESSED );\n\t}\n\n\tset isPressed( isPressed: boolean ) {\n\t\tthis.set( DBaseState.PRESSED, isPressed );\n\t}\n\n\tget inPressed(): boolean {\n\t\treturn this.in( DBaseState.PRESSED );\n\t}\n\n\tget onPressed(): boolean {\n\t\treturn this.on( DBaseState.PRESSED );\n\t}\n\n\tget underPressed(): boolean {\n\t\treturn this.under( DBaseState.PRESSED );\n\t}\n\n\tget isReadOnly(): boolean {\n\t\treturn this.is( DBaseState.READ_ONLY );\n\t}\n\n\tset isReadOnly( isReadOnly: boolean ) {\n\t\tthis.set( DBaseState.READ_ONLY, isReadOnly );\n\t}\n\n\tget inReadOnly(): boolean {\n\t\treturn this.in( DBaseState.READ_ONLY );\n\t}\n\n\tget onReadOnly(): boolean {\n\t\treturn this.on( DBaseState.READ_ONLY );\n\t}\n\n\tget underReadOnly(): boolean {\n\t\treturn this.under( DBaseState.READ_ONLY );\n\t}\n\n\tget isEnabled(): boolean {\n\t\treturn ! this.is( DBaseState.DISABLED );\n\t}\n\n\tset isEnabled( isEnabled: boolean ) {\n\t\tthis.set( DBaseState.DISABLED, ! isEnabled );\n\t}\n\n\tget inEnabled(): boolean {\n\t\treturn ! this.in( DBaseState.DISABLED );\n\t}\n\n\tget onEnabled(): boolean {\n\t\treturn ! this.on( DBaseState.DISABLED );\n\t}\n\n\tget underEnabled(): boolean {\n\t\treturn ! this.under( DBaseState.DISABLED );\n\t}\n\n\tget isDisabled(): boolean {\n\t\treturn this.is( DBaseState.DISABLED );\n\t}\n\n\tset isDisabled( isDisabled: boolean ) {\n\t\tthis.set( DBaseState.DISABLED, isDisabled );\n\t}\n\n\tget inDisabled(): boolean {\n\t\treturn this.in( DBaseState.DISABLED );\n\t}\n\n\tget onDisabled(): boolean {\n\t\treturn this.on( DBaseState.DISABLED );\n\t}\n\n\tget underDisabled(): boolean {\n\t\treturn this.under( DBaseState.DISABLED );\n\t}\n\n\tget isActionable(): boolean {\n\t\treturn ! this.in( DBaseState.DISABLED ) && ! this.in( DBaseState.READ_ONLY );\n\t}\n\n\tget isDragging(): boolean {\n\t\treturn this.is( DBaseState.DRAGGING );\n\t}\n\n\tset isDragging( isDragging: boolean ) {\n\t\tthis.set( DBaseState.DRAGGING, isDragging );\n\t}\n\n\tget inDragging(): boolean {\n\t\treturn this.in( DBaseState.DRAGGING );\n\t}\n\n\tget onDragging(): boolean {\n\t\treturn this.on( DBaseState.DRAGGING );\n\t}\n\n\tget underDragging(): boolean {\n\t\treturn this.under( DBaseState.DRAGGING );\n\t}\n\n\tget isFocused(): boolean {\n\t\treturn this.is( DBaseState.FOCUSED );\n\t}\n\n\tset isFocused( isFocused: boolean ) {\n\t\tthis.set( DBaseState.FOCUSED, isFocused );\n\t}\n\n\tget inFocused(): boolean {\n\t\treturn this.in( DBaseState.FOCUSED );\n\t}\n\n\tget onFocused(): boolean {\n\t\treturn this.on( DBaseState.FOCUSED );\n\t}\n\n\tget underFocused(): boolean {\n\t\treturn this.under( DBaseState.FOCUSED );\n\t}\n\n\tget isFocusRoot(): boolean {\n\t\treturn this.is( DBaseState.FOCUS_ROOT );\n\t}\n\n\tset isFocusRoot( isFocusRoot: boolean ) {\n\t\tthis.set( DBaseState.FOCUS_ROOT, isFocusRoot );\n\t}\n\n\tget inFocusRoot(): boolean {\n\t\treturn this.in( DBaseState.FOCUS_ROOT );\n\t}\n\n\tget onFocusRoot(): boolean {\n\t\treturn this.on( DBaseState.FOCUS_ROOT );\n\t}\n\n\tget underFocusRoot(): boolean {\n\t\treturn this.under( DBaseState.FOCUS_ROOT );\n\t}\n\n\tget isFocusReverse(): boolean {\n\t\treturn this.is( DBaseState.FOCUS_REVERSE );\n\t}\n\n\tset isFocusReverse( isFocusReverse: boolean ) {\n\t\tthis.set( DBaseState.FOCUS_REVERSE, isFocusReverse );\n\t}\n\n\tget inFocusReverse(): boolean {\n\t\treturn this.in( DBaseState.FOCUS_REVERSE );\n\t}\n\n\tget onFocusReverse(): boolean {\n\t\treturn this.on( DBaseState.FOCUS_REVERSE );\n\t}\n\n\tget underFocusReverse(): boolean {\n\t\treturn this.under( DBaseState.FOCUS_REVERSE );\n\t}\n\n\tget isFocusable(): boolean {\n\t\treturn ! this.is( DBaseState.UNFOCUSABLE );\n\t}\n\n\tset isFocusable( isFocusable: boolean ) {\n\t\tthis.set( DBaseState.UNFOCUSABLE, ! isFocusable );\n\t}\n\n\tget inFocusable(): boolean {\n\t\treturn ! this.in( DBaseState.UNFOCUSABLE );\n\t}\n\n\tget onFocusable(): boolean {\n\t\treturn ! this.on( DBaseState.UNFOCUSABLE );\n\t}\n\n\tget underFocusable(): boolean {\n\t\treturn ! this.under( DBaseState.UNFOCUSABLE );\n\t}\n\n\tget isUnfocusable(): boolean {\n\t\treturn this.is( DBaseState.UNFOCUSABLE );\n\t}\n\n\tset isUnfocusable( unfocusable: boolean ) {\n\t\tthis.set( DBaseState.UNFOCUSABLE, unfocusable );\n\t}\n\n\tget inUnfocusable(): boolean {\n\t\treturn this.in( DBaseState.UNFOCUSABLE );\n\t}\n\n\tget onUnfocusable(): boolean {\n\t\treturn this.on( DBaseState.UNFOCUSABLE );\n\t}\n\n\tget underUnfocusable(): boolean {\n\t\treturn this.under( DBaseState.UNFOCUSABLE );\n\t}\n\n\tget isInvalid(): boolean {\n\t\treturn this.is( DBaseState.INVALID );\n\t}\n\n\tset isInvalid( invalid: boolean ) {\n\t\tthis.set( DBaseState.INVALID, invalid );\n\t}\n\n\tget inInvalid(): boolean {\n\t\treturn this.in( DBaseState.INVALID );\n\t}\n\n\tget onInvalid(): boolean {\n\t\treturn this.on( DBaseState.INVALID );\n\t}\n\n\tget underInvalid(): boolean {\n\t\treturn this.on( DBaseState.INVALID );\n\t}\n\n\tget isSucceeded(): boolean {\n\t\treturn this.is( DBaseState.SUCCEEDED );\n\t}\n\n\tset isSucceeded( succeeded: boolean ) {\n\t\tthis.set( DBaseState.SUCCEEDED, succeeded );\n\t}\n\n\tget inSucceeded(): boolean {\n\t\treturn this.in( DBaseState.SUCCEEDED );\n\t}\n\n\tget onSucceeded(): boolean {\n\t\treturn this.on( DBaseState.SUCCEEDED );\n\t}\n\n\tget underSucceeded(): boolean {\n\t\treturn this.under( DBaseState.SUCCEEDED );\n\t}\n\n\tget isFailed(): boolean {\n\t\treturn this.is( DBaseState.FAILED );\n\t}\n\n\tset isFailed( failed: boolean ) {\n\t\tthis.set( DBaseState.FAILED, failed );\n\t}\n\n\tget inFailed(): boolean {\n\t\treturn this.in( DBaseState.FAILED );\n\t}\n\n\tget onFailed(): boolean {\n\t\treturn this.on( DBaseState.FAILED );\n\t}\n\n\tget underFailed(): boolean {\n\t\treturn this.under( DBaseState.FAILED );\n\t}\n\n\tget isWarned(): boolean {\n\t\treturn this.is( DBaseState.WARNED );\n\t}\n\n\tset isWarned( isWarned: boolean ) {\n\t\tthis.set( DBaseState.WARNED, isWarned );\n\t}\n\n\tget inWarned(): boolean {\n\t\treturn this.in( DBaseState.WARNED );\n\t}\n\n\tget onWarned(): boolean {\n\t\treturn this.on( DBaseState.WARNED );\n\t}\n\n\tget underWarned(): boolean {\n\t\treturn this.on( DBaseState.WARNED );\n\t}\n\n\tget isChanged(): boolean {\n\t\treturn this.is( DBaseState.CHANGED );\n\t}\n\n\tset isChanged( isChanged: boolean ) {\n\t\tthis.set( DBaseState.CHANGED, isChanged );\n\t}\n\n\tget inChanged(): boolean {\n\t\treturn this.in( DBaseState.CHANGED );\n\t}\n\n\tget onChanged(): boolean {\n\t\treturn this.on( DBaseState.CHANGED );\n\t}\n\n\tget underChanged(): boolean {\n\t\treturn this.on( DBaseState.CHANGED );\n\t}\n\n\tget isAlternated(): boolean {\n\t\treturn this.is( DBaseState.ALTERNATED );\n\t}\n\n\tset isAlternated( isAlternated: boolean ) {\n\t\tthis.set( DBaseState.ALTERNATED, isAlternated );\n\t}\n\n\tget inAlternated(): boolean {\n\t\treturn this.in( DBaseState.ALTERNATED );\n\t}\n\n\tget onAlternated(): boolean {\n\t\treturn this.on( DBaseState.ALTERNATED );\n\t}\n\n\tget underAlternated(): boolean {\n\t\treturn this.on( DBaseState.ALTERNATED );\n\t}\n\n\ttoObject(): DBaseStateSetLike {\n\t\tconst states: string[] = [];\n\t\tthis._local.forEach(( value: string ): void => {\n\t\t\tstates.push( value );\n\t\t});\n\t\treturn {\n\t\t\tlocal: states,\n\t\t\tdata: this._data?.toArray() ?? []\n\t\t};\n\t}\n\n\ttoString(): string {\n\t\treturn JSON.stringify( this.toObject() );\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBaseStateSetImpl } from \"./d-base-state-set-impl\";\n\nexport type DBaseStateSetImplObservableOnChange = ( newState: DBaseStateSet, oldState: DBaseStateSet ) => void;\n\nexport class DBaseStateSetImplObservable extends DBaseStateSetImpl {\n\tprotected _onChange: DBaseStateSetImplObservableOnChange;\n\tprotected _isLocked: number;\n\tprotected _isSaved: boolean;\n\tprotected _doSave: boolean;\n\tprotected _saved?: DBaseStateSetImpl;\n\n\tconstructor( onChange: DBaseStateSetImplObservableOnChange ) {\n\t\tsuper();\n\t\tthis._onChange = onChange;\n\t\tthis._isLocked = 0;\n\t\tthis._isSaved = false;\n\t\tthis._doSave = true;\n\t}\n\n\tlock( callOnChange?: boolean ): this {\n\t\tthis._isLocked += 1;\n\t\tif( callOnChange === false ) {\n\t\t\tthis._doSave = false;\n\t\t}\n\t\treturn this;\n\t}\n\n\tunlock(): this {\n\t\tthis._isLocked -= 1;\n\t\treturn this.end();\n\t}\n\n\tprotected get saved(): DBaseStateSetImpl {\n\t\tlet result = this._saved;\n\t\tif( result == null ) {\n\t\t\tresult = new DBaseStateSetImpl();\n\t\t\tthis._saved = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected begin(): this {\n\t\tif( this._doSave && ! this._isSaved ) {\n\t\t\tthis._isSaved = true;\n\t\t\tthis.saved.copy( this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected end(): this {\n\t\tif( this._isLocked <= 0 ) {\n\t\t\tthis._doSave = true;\n\t\t\tif( this._isSaved ) {\n\t\t\t\tthis._isSaved = false;\n\t\t\t\tthis._onChange( this, this.saved );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const EShapeState = {\n\tCLICKED: \"CLICKED\",\n\tDOWN: \"DOWN\",\n\tUP: \"UP\"\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseStateSetImplObservable } from \"../d-base-state-set-impl-observable\";\nimport { EShapeState } from \"./e-shape-state\";\n\nexport class EShapeStateSetImplObservable extends DBaseStateSetImplObservable {\n\tget isClicked(): boolean {\n\t\treturn this.is( EShapeState.CLICKED );\n\t}\n\n\tset isClicked( isClicked: boolean ) {\n\t\tthis.set( EShapeState.CLICKED, isClicked );\n\t}\n\n\tget inClicked(): boolean {\n\t\treturn this.in( EShapeState.CLICKED );\n\t}\n\n\tget onClicked(): boolean {\n\t\treturn this.on( EShapeState.CLICKED );\n\t}\n\n\tget underClicked(): boolean {\n\t\treturn this.under( EShapeState.CLICKED );\n\t}\n\n\tget isDown(): boolean {\n\t\treturn this.is( EShapeState.DOWN );\n\t}\n\n\tset isDown( isDown: boolean ) {\n\t\tthis.set( EShapeState.DOWN, isDown );\n\t}\n\n\tget inDown(): boolean {\n\t\treturn this.in( EShapeState.DOWN );\n\t}\n\n\tget onDown(): boolean {\n\t\treturn this.on( EShapeState.DOWN );\n\t}\n\n\tget underDown(): boolean {\n\t\treturn this.under( EShapeState.DOWN );\n\t}\n\n\tget isUp(): boolean {\n\t\treturn this.is( EShapeState.UP );\n\t}\n\n\tset isUp( isUp: boolean ) {\n\t\tthis.set( EShapeState.UP, isUp );\n\t}\n\n\tget inUp(): boolean {\n\t\treturn this.in( EShapeState.UP );\n\t}\n\n\tget onUp(): boolean {\n\t\treturn this.on( EShapeState.UP );\n\t}\n\n\tget underUp(): boolean {\n\t\treturn this.under( EShapeState.UP );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, ObservablePoint, Transform } from \"pixi.js\";\nimport { EShapeTransformParent } from \"./e-shape-transform-parent\";\n\nexport interface EShapeTransform extends Transform {\n\tinternalTransform: Matrix;\n\n\tposition: ObservablePoint;\n\tpivot: ObservablePoint;\n\trotation: number;\n\tskew: ObservablePoint;\n\tscale: ObservablePoint;\n\n\tgetLocalIdCurrent(): number;\n\tgetLocalId(): number;\n\tgetParentId(): number;\n\tgetWorldId(): number;\n}\n\nexport class EShapeTransformImpl extends Transform implements EShapeTransform {\n\tprotected _parent: EShapeTransformParent;\n\tinternalTransform: Matrix;\n\n\tconstructor( parent: EShapeTransformParent ) {\n\t\tsuper();\n\t\tthis.internalTransform = new Matrix();\n\t\tthis._parent = parent;\n\t}\n\n\tprotected onChange(): void {\n\t\tsuper.onChange();\n\t\tthis._parent.onTransformChange();\n\t}\n\n\tprotected updateSkew(): void {\n\t\tsuper.updateSkew();\n\t\tthis._parent.onTransformChange();\n\t}\n\n\tgetLocalIdCurrent(): number {\n\t\treturn this._currentLocalID;\n\t}\n\n\tgetLocalId(): number {\n\t\treturn this._localID;\n\t}\n\n\tgetParentId(): number {\n\t\treturn this._parentID;\n\t}\n\n\tgetWorldId(): number {\n\t\treturn this._worldID;\n\t}\n\n\tupdateTransform( parentTransform: Transform ): void {\n\t\tconst oldLocalId = this._currentLocalID;\n\t\tconst oldWorldId = this._worldID;\n\t\tsuper.updateTransform( parentTransform );\n\t\tconst newLocalId = this._currentLocalID;\n\t\tconst newWorldId = this._worldID;\n\t\tif( oldLocalId !== newLocalId ) {\n\t\t\tconst localTransform = this.localTransform;\n\t\t\tconst internalTransform = this.internalTransform;\n\t\t\tlocalTransform.copyTo( internalTransform );\n\t\t\tif( parentTransform instanceof EShapeTransformImpl ) {\n\t\t\t\tinternalTransform.prepend( parentTransform.internalTransform );\n\t\t\t}\n\t\t} else if( oldWorldId !== newWorldId ) {\n\t\t\tconst localTransform = this.localTransform;\n\t\t\tconst internalTransform = this.internalTransform;\n\t\t\tif( parentTransform instanceof EShapeTransformImpl ) {\n\t\t\t\tlocalTransform.copyTo( internalTransform ).prepend( parentTransform.internalTransform );\n\t\t\t\tthis._currentLocalID += 1;\n\t\t\t\tthis._localID = this._currentLocalID;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toPadded = ( str: string, length: number, c: string ): string => {\n\tconst strLength = str.length;\n\tif( length < strLength ) {\n\t\treturn str;\n\t}\n\tlet padding = \"\";\n\tfor( let i = 0, imax = length - strLength; i < imax; ++i ) {\n\t\tpadding += c;\n\t}\n\treturn padding + str;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"./to-padded\";\n\nexport class UtilRgb {\n\tstatic toCode( color: number ): string {\n\t\treturn toPadded( color.toString( 16 ).toUpperCase(), 6, \"0\" );\n\t}\n\n\tstatic fromCode( code: string ): number | null {\n\t\tconst trimmed = code.trim().toLowerCase();\n\t\tif( trimmed.length === 6 ) {\n\t\t\tconst color = Number( `0x${trimmed}` );\n\t\t\tif( color === color ) {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic fromRgb( r: number, g: number, b: number ): number {\n\t\treturn ((r * 0xff) << 16) + ((g * 0xff) << 8) + ((b * 0xff) | 0);\n\t}\n\n\tstatic blend( colorA: number, colorB: number, t: number ): number {\n\t\tconst ar = ((colorA >> 16) & 0xff);\n\t\tconst ag = ((colorA >> 8) & 0xff);\n\t\tconst ab = ((colorA | 0) & 0xff);\n\n\t\tconst br = ((colorB >> 16) & 0xff);\n\t\tconst bg = ((colorB >> 8) & 0xff);\n\t\tconst bb = ((colorB | 0) & 0xff);\n\n\t\tconst w1 = Math.max( 0, Math.min( 1, t ) );\n\t\tconst w0 = 1 - w1;\n\t\tconst cr = Math.max( 0, Math.min( 0xff, ar * w0 + br * w1 ) );\n\t\tconst cg = Math.max( 0, Math.min( 0xff, ag * w0 + bg * w1 ) );\n\t\tconst cb = Math.max( 0, Math.min( 0xff, ab * w0 + bb * w1 ) );\n\n\t\treturn (cr << 16) + (cg << 8) + (cb | 0);\n\t}\n\n\tstatic brighten( color: number, amount: number ): number {\n\t\treturn this.blend( color, 0xffffff, amount );\n\t}\n\n\tstatic darken( color: number, amount: number ): number {\n\t\treturn this.blend( color, 0x000000, amount );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShapeGradientLike, EShapeGradientPointLike } from \"../e-shape-gradient\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\n\nexport class EShapeGradients {\n\tstatic serializeGradient( gradient: EShapeGradientLike ): string {\n\t\tconst points = gradient.points;\n\t\tlet result = `[${gradient.direction}`;\n\t\tfor( let i = 0, imax = points.length, j = 1; i < imax; i += 1, j += 3 ) {\n\t\t\tconst point = points[ i ];\n\t\t\tresult += `,${point.color},${point.alpha},${point.position}`;\n\t\t}\n\t\tresult += \"]\";\n\t\treturn result;\n\t}\n\n\tstatic parseGradient( target: string ): number[] | null {\n\t\ttry {\n\t\t\treturn JSON.parse( target ) as number[];\n\t\t} catch( e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic deserializeGradient( target: string ): EShapeGradientLike | undefined {\n\t\tconst parsed = this.parseGradient( target );\n\t\tif( parsed == null || parsed.length < 7 ) {\n\t\t\treturn undefined;\n\t\t} else {\n\t\t\tconst direction = parsed[ 0 ];\n\t\t\tconst points: EShapeGradientPointLike[] = [];\n\t\t\tfor( let i = 1, imax = parsed.length; i < imax; i += 3 ) {\n\t\t\t\tpoints.push({\n\t\t\t\t\tcolor: parsed[ i + 0 ],\n\t\t\t\t\talpha: parsed[ i + 1 ],\n\t\t\t\t\tposition: parsed[ i + 2 ]\n\t\t\t\t});\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tpoints,\n\t\t\t\tdirection\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic toGradientId( gradient: EShapeGradientLike | undefined, manager: EShapeResourceManagerSerialization ): number {\n\t\tif( gradient != null ) {\n\t\t\tif( gradient.serialized == null ) {\n\t\t\t\tgradient.serialized = this.serializeGradient( gradient );\n\t\t\t}\n\t\t\treturn manager.addResource( gradient.serialized );\n\t\t}\n\t\treturn -1;\n\t}\n\n\tstatic toGradientImageUrl( gradient: EShapeGradientLike ): string {\n\t\tconst direction = gradient.direction;\n\t\tconst points = gradient.points;\n\n\t\tlet stops = \"\";\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tconst point = points[ i ];\n\t\t\tconst color = UtilRgb.toCode( point.color );\n\t\t\tconst alpha = point.alpha;\n\t\t\tconst offset = point.position * 100;\n\t\t\tstops += `<stop offset=\"${offset}%\" stop-color=\"#${color}\" stop-opacity=\"${alpha}\" />`;\n\t\t}\n\n\t\tconst radian = direction * Math.PI / 180;\n\t\tconst dx = 0.5 * Math.cos( radian );\n\t\tconst dy = -0.5 * Math.sin( radian );\n\n\t\tconst url = \"data:image/svg+xml;base64,\" + btoa(\n\t\t\t`<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"32\" height=\"32\" viewBox=\"0 0 32 32\">` +\n\t\t\t\t`<defs>` +\n\t\t\t\t\t`<linearGradient id=\"o2glkm3aeu2oio\" x1=\"${0.5 - dx}\" x2=\"${0.5 + dx}\" y1=\"${0.5 - dy}\" y2=\"${0.5 + dy}\">` +\n\t\t\t\t\t\tstops +\n\t\t\t\t\t`</linearGradient>` +\n\t\t\t\t`</defs>` +\n\t\t\t\t`<rect x=\"0\" y=\"0\" width=\"32\" height=\"32\" stroke=\"none\" fill=\"url(#o2glkm3aeu2oio)\" />` +\n\t\t\t`</svg>`\n\t\t);\n\n\t\treturn url;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Matrix, Point, Rectangle, Renderer, Texture, Transform, utils } from \"pixi.js\";\nimport { DApplications } from \"../../d-applications\";\nimport { DBaseStateSet } from \"../../d-base-state-set\";\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeAction } from \"../action/e-shape-action\";\nimport { EShape, EShapeCopyPart } from \"../e-shape\";\nimport { EShapeContainer } from \"../e-shape-container\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeEditor } from \"../e-shape-editor\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeStateSet } from \"../e-shape-state-set\";\nimport { EShapeStateSetImplObservable } from \"../e-shape-state-set-impl-observable\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeTransform, EShapeTransformImpl } from \"../e-shape-transform\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploaded } from \"../e-shape-uploaded\";\nimport { EShapeGradients } from \"./e-shape-gradients\";\n\nexport abstract class EShapeBase extends utils.EventEmitter implements EShape {\n\tprotected static WORK_RECT = new Rectangle();\n\tid: string;\n\tuuid: number;\n\treadonly type: EShapeType;\n\tabstract readonly size: IPoint;\n\tabstract readonly fill: EShapeFill;\n\tabstract readonly stroke: EShapeStroke;\n\treadonly transform: EShapeTransform;\n\tabstract radius: number;\n\tabstract corner: EShapeCorner;\n\tprotected _points?: EShapePoints;\n\tprotected _image?: HTMLImageElement;\n\timageSrc?: string;\n\ttexture?: Texture;\n\tabstract gradient?: EShapeGradientLike;\n\tabstract readonly text: EShapeText;\n\tabstract readonly tag: EShapeTag;\n\treadonly action: EShapeAction;\n\tabstract cursor: string;\n\tinteractive: boolean;\n\tshortcut?: string;\n\ttitle?: string;\n\tprotected _visible: boolean;\n\tprotected _onTransformChangeLock: number;\n\tprotected _isOnTransformChanged: boolean;\n\tprotected _uploadedUpdateLock: number;\n\tprotected _isUploadedUpdated: boolean;\n\tprotected _isUploadedUpdatedRecursively: boolean;\n\n\tprotected _bounds?: Rectangle;\n\tprotected _boundsTransformId: number;\n\tprotected _boundsInternal?: Rectangle;\n\tprotected _boundsInternalTransformId: number;\n\tprotected _boundsLocal?: Rectangle;\n\tprotected _boundsLocalTransformId: number;\n\n\tprotected _state?: EShapeStateSet;\n\n\t// Hierarchy\n\tparent: EShapeContainer | EShape | null;\n\tchildren: EShape[];\n\tlayout?: EShapeLayout;\n\n\t// Working space\n\tindex: number; // A work space for sorting.\n\tselected: boolean;\n\treference: number; // Count of references from commands\n\n\t// Working space for the viewer\n\truntime?: EShapeRuntime;\n\n\t// Working space for the editor\n\teditor?: EShapeEditor;\n\n\t// Working space for the renderer\n\tuploaded?: EShapeUploaded;\n\n\tconstructor( type: EShapeType ) {\n\t\tsuper();\n\t\tthis.id = \"\";\n\t\tthis.uuid = 0;\n\t\tthis.type = type;\n\t\tthis.transform = this.newTransform();\n\t\tthis._onTransformChangeLock = 0;\n\t\tthis._isOnTransformChanged = false;\n\t\tthis.action = new EShapeAction();\n\t\tthis._visible = true;\n\t\tthis._uploadedUpdateLock = 0;\n\t\tthis._isUploadedUpdated = false;\n\t\tthis._isUploadedUpdatedRecursively = false;\n\n\t\tthis._boundsTransformId = NaN;\n\t\tthis._boundsInternalTransformId = NaN;\n\t\tthis._boundsLocalTransformId = NaN;\n\n\t\tthis.interactive = false;\n\n\t\t//\n\t\tthis.parent = null;\n\t\tthis.children = [];\n\n\t\t//\n\t\tthis.selected = false;\n\t\tthis.index = 0;\n\t\tthis.reference = 0;\n\t}\n\n\tprotected newTransform(): EShapeTransform {\n\t\treturn new EShapeTransformImpl( this );\n\t}\n\n\tonSizeChange(): void {\n\t\tthis._boundsTransformId = NaN;\n\t\tthis._boundsInternalTransformId = NaN;\n\t\tthis._boundsLocalTransformId = NaN;\n\n\t\tthis.onTransformChange_();\n\t\tthis.updateUploaded();\n\t}\n\n\tonTransformChange(): void {\n\t\tthis.onTransformChange_();\n\t\tthis.updateUploadedRecursively();\n\t}\n\n\tprotected onTransformChange_(): void {\n\t\tif( this._onTransformChangeLock === 0 ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isOnTransformChanged = true;\n\t\t}\n\t}\n\n\tdisallowOnTransformChange(): void {\n\t\tthis._onTransformChangeLock += 1;\n\t\tif( this._onTransformChangeLock === 1 ) {\n\t\t\tthis._isOnTransformChanged = false;\n\t\t}\n\t}\n\n\tallowOnTransformChange( invokeOnTransformChange: boolean ): void {\n\t\tthis._onTransformChangeLock -= 1;\n\t\tif( this._onTransformChangeLock === 0 ) {\n\t\t\tif( this._isOnTransformChanged ) {\n\t\t\t\tthis._isOnTransformChanged = false;\n\t\t\t\tif( invokeOnTransformChange ) {\n\t\t\t\t\tthis.onTransformChange();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonChildTransformChange(): void {\n\t\t//\n\t}\n\n\tdisallowUploadedUpdate(): void {\n\t\tthis._uploadedUpdateLock += 1;\n\t\tif( this._uploadedUpdateLock === 1 ) {\n\t\t\tthis._isUploadedUpdated = false;\n\t\t\tthis._isUploadedUpdatedRecursively = false;\n\t\t}\n\t}\n\n\tallowUploadedUpdate(): void {\n\t\tthis._uploadedUpdateLock -= 1;\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tif( this._isUploadedUpdatedRecursively ) {\n\t\t\t\tthis._isUploadedUpdatedRecursively = false;\n\t\t\t\tthis._isUploadedUpdated = false;\n\t\t\t\tthis.updateUploadedRecursively();\n\t\t\t} else if( this._isUploadedUpdated ) {\n\t\t\t\tthis._isUploadedUpdated = false;\n\t\t\t\tthis.updateUploaded();\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateUploadedRecursively(): void {\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tthis.updateUploaded();\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tchildren[ i ].updateUploadedRecursively();\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isUploadedUpdatedRecursively = true;\n\t\t}\n\t}\n\n\tupdateUploaded(): void {\n\t\tif( this._uploadedUpdateLock === 0 ) {\n\t\t\tconst uploaded = this.uploaded;\n\t\t\tif( uploaded != null ) {\n\t\t\t\tuploaded.update( this );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._isUploadedUpdated = true;\n\t\t}\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\treturn this._image;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\tthis._image = image;\n\t}\n\n\tget points(): EShapePoints | undefined {\n\t\treturn this._points;\n\t}\n\n\t//\n\tget root(): EShape {\n\t\tlet root: EShape = this;\n\t\twhile( root.parent instanceof EShapeBase ) {\n\t\t\troot = root.parent;\n\t\t}\n\t\treturn root;\n\t}\n\n\t//\n\tget visible(): boolean {\n\t\treturn this._visible && (this.parent?.visible ?? true);\n\t}\n\n\tset visible( visible: boolean ) {\n\t\tif( this._visible !== visible ) {\n\t\t\tthis._visible = visible;\n\t\t\tthis.updateUploadedRecursively();\n\t\t}\n\t}\n\n\tget worldVisible(): boolean {\n\t\treturn this._visible && (this.parent?.worldVisible ?? true);\n\t}\n\n\t//\n\tabstract clone(): EShape;\n\n\t//\n\ttoDirty() {\n\t\tthis.parent?.toDirty();\n\t}\n\n\t// Hierarchy\n\tattach( parent: EShapeContainer | EShape, at?: number ): this {\n\t\tthis.detach();\n\t\tthis.parent = parent;\n\t\tconst children = parent.children;\n\t\tif( at != null && 0 <= at && at < children.length ) {\n\t\t\tchildren.splice( at, 0, this );\n\t\t} else {\n\t\t\tchildren.push( this );\n\t\t}\n\t\tthis.uploaded = undefined;\n\t\tparent.onChildTransformChange();\n\t\tparent.toDirty();\n\t\treturn this;\n\t}\n\n\tdetach(): this {\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tthis.parent = null;\n\t\t\tthis.uploaded = undefined;\n\t\t\tconst children = parent.children;\n\t\t\tconst index = children.indexOf( this );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tchildren.splice( index, 1 );\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t// Transform\n\tupdateTransform() {\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tif( parent.parent ) {\n\t\t\t\tparent.updateTransform();\n\t\t\t}\n\t\t\tthis.transform.updateTransform(parent.transform);\n\t\t} else {\n\t\t\tthis.transform.updateTransform((Transform as any).IDENTITY);\n\t\t}\n\t}\n\n\t// Serialization\n\tserializeChildren( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem[] {\n\t\tconst children = this.children;\n\t\tconst childrenSerialized = [];\n\t\tfor (let i = 0, imax = children.length; i < imax; ++i) {\n\t\t\tconst child = children[i];\n\t\t\tchildrenSerialized.push(child.serialize(manager));\n\t\t}\n\t\treturn childrenSerialized;\n\t}\n\n\tserializeImage( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst image = this._image;\n\t\treturn (image != null ? manager.addResource( image.src ) : -1);\n\t}\n\n\tserializeGradient( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn EShapeGradients.toGradientId( this.gradient, manager );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem {\n\t\tconst transform = this.transform;\n\t\tconst position = transform.position;\n\t\tconst pivot = transform.pivot;\n\t\tconst size = this.size;\n\t\tconst shortcut = this.shortcut;\n\t\tconst shortcutId = ( shortcut != null ? manager.addResource( shortcut ) : -1 );\n\t\tconst title = this.title;\n\t\tconst titleId = ( title != null ? manager.addResource( title ) : -1 );\n\t\treturn [\n\t\t\tthis.type,\n\t\t\tmanager.addResource(this.id),\n\t\t\tposition.x,\n\t\t\tposition.y,\n\t\t\tsize.x,\n\t\t\tsize.y,\n\t\t\ttransform.rotation,\n\t\t\ttransform.skew.x,\n\t\t\tthis.fill.serialize( manager ),\n\t\t\tthis.stroke.serialize( manager ),\n\t\t\tmanager.addResource( this.cursor.trim() ),\n\t\t\tthis.text.serialize( manager ),\n\t\t\tthis.tag.serialize( manager ),\n\t\t\tthis.radius,\n\t\t\tthis.corner,\n\t\t\t-1,\n\t\t\t-1,\n\t\t\tthis.action.serialize( manager ),\n\t\t\tthis.serializeImage( manager ),\n\t\t\tthis.serializeGradient( manager ),\n\t\t\tthis.serializeChildren( manager ),\n\t\t\tpivot.x,\n\t\t\tpivot.y,\n\t\t\t( this.interactive ? 1 : 0 ) | ( this.state.isFocusable ? 0 : 2 ),\n\t\t\tshortcutId,\n\t\t\ttitleId,\n\t\t\tthis.uuid\n\t\t];\n\t}\n\n\taddUuid( manager: EShapeResourceManagerSerialization ): void {\n\t\tthis.uuid = manager.addUuid( this.uuid );\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].addUuid( manager );\n\t\t}\n\t}\n\n\tupdateUuid( manager: EShapeResourceManagerSerialization ): void {\n\t\tthis.uuid = manager.updateUuid( this.uuid );\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].updateUuid( manager );\n\t\t}\n\t}\n\n\t// Hit test\n\ttoLocalRect( point: IPoint, result: Rectangle ): Rectangle {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this.size;\n\t\tconst sx = 0.5 * size.x;\n\t\tconst sy = 0.5 * size.y;\n\t\tconst pivot = this.transform.pivot;\n\t\tconst dx = x - pivot.x;\n\t\tconst dy = y - pivot.y;\n\t\tconst stroke = this.stroke;\n\t\tconst s = stroke.width * stroke.align;\n\t\tif( 0 <= sx ) {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\tresult.x = +dx;\n\t\t\t\tresult.y = +dy;\n\t\t\t\tresult.width = +sx + s;\n\t\t\t\tresult.height = +sy + s;\n\t\t\t} else {\n\t\t\t\tresult.x = +dx;\n\t\t\t\tresult.y = -dy;\n\t\t\t\tresult.width = +sx + s;\n\t\t\t\tresult.height = -sy + s;\n\t\t\t}\n\t\t} else {\n\t\t\tif( 0 <= sy ) {\n\t\t\t\tresult.x = -dx;\n\t\t\t\tresult.y = +dy;\n\t\t\t\tresult.width = -sx + s;\n\t\t\t\tresult.height = +sy + s;\n\t\t\t} else {\n\t\t\t\tresult.x = -dx;\n\t\t\t\tresult.y = -dy;\n\t\t\t\tresult.width = -sx + s;\n\t\t\t\tresult.height = -sy + s;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tcontains( point: Point ): EShape | null {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tif( this.containsAbs( rect.x, rect.y, rect.width, rect.height ) ) {\n\t\t\treturn this;\n\t\t}\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\treturn this.containsText( x, y, point ) || this.containsChildren( x, y, point );\n\t}\n\n\tprotected containsText( x: number, y: number, work: Point ): EShape | null {\n\t\tconst text = this.text;\n\t\tconst textAtlas = text.atlas;\n\t\tif( textAtlas != null ) {\n\t\t\tconst textWorld = text.world;\n\t\t\tif( textWorld != null ) {\n\t\t\t\twork.set( x, y );\n\t\t\t\tthis.transform.internalTransform.apply( work, work );\n\t\t\t\tconst tx = work.x - textWorld[ 0 ];\n\t\t\t\tconst ty = work.y - textWorld[ 1 ];\n\t\t\t\tconst th = textWorld[ 2 ] * tx + textWorld[ 3 ] * ty;\n\t\t\t\tconst tv = textWorld[ 4 ] * tx + textWorld[ 5 ] * ty;\n\t\t\t\tif( 0 <= th && th <= textWorld[ 6 ] && 0 <= tv && tv <= textWorld[ 7 ] ) {\n\t\t\t\t\treturn this;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected containsChildren( x: number, y: number, work: Point ): EShape | null {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\twork.set( x, y );\n\t\t\tchild.updateTransform();\n\t\t\tchild.transform.localTransform.applyInverse( work, work );\n\t\t\tconst childResult = child.contains( work );\n\t\t\tif( childResult != null ) {\n\t\t\t\treturn childResult;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontainsBBox( point: IPoint ): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\treturn this.containsAbsBBox( rect.x, rect.y, rect.width, rect.height );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn this.containsAbsBBox( x, y, ax, ay );\n\t}\n\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn (-ax <= x && x <= +ax && -ay <= y && y <= +ay);\n\t}\n\n\tselect( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\t//\n\ttoGlobal( position: IPoint, result: Point, skipUpdate?: boolean ): Point {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tresult.copyFrom( position );\n\t\tthis.transform.worldTransform.apply( result, result );\n\t\treturn result;\n\t}\n\n\ttoLocal( position: IPoint, from?: DisplayObject, result?: Point, skipUpdate?: boolean ): Point {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tif( result === undefined ) {\n\t\t\tresult = new Point();\n\t\t}\n\t\tresult.copyFrom( position );\n\t\tthis.transform.worldTransform.applyInverse( result, result );\n\t\treturn result;\n\t}\n\n\tgetBounds( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst bounds = this._bounds = ( this._bounds || new Rectangle() );\n\t\tconst worldId = this.transform.getWorldId();\n\t\tif( worldId !== this._boundsTransformId ) {\n\t\t\tthis._boundsTransformId = worldId;\n\t\t\tthis.getBounds_( this.transform.worldTransform, work, bounds );\n\t\t}\n\t\tresult.copyFrom( bounds );\n\t\treturn result;\n\t}\n\n\tgetBoundsInternal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst boundsInternal = this._boundsInternal = ( this._boundsInternal || new Rectangle() );\n\t\tconst currentLocalId = this.transform.getLocalIdCurrent();\n\t\tif( currentLocalId !== this._boundsInternalTransformId ) {\n\t\t\tthis._boundsInternalTransformId = currentLocalId;\n\t\t\tthis.getBounds_( this.transform.internalTransform, work, boundsInternal );\n\t\t}\n\t\tresult.copyFrom( boundsInternal );\n\t\treturn result;\n\t}\n\n\tgetBoundsLocal( work: Point, skipUpdate: boolean, result: Rectangle ): Rectangle {\n\t\tif( skipUpdate !== true ) {\n\t\t\tthis.updateTransform();\n\t\t}\n\t\tconst boundsLocal = this._boundsLocal = ( this._boundsLocal || new Rectangle() );\n\t\tconst currentLocalId = this.transform.getLocalIdCurrent();\n\t\tif( currentLocalId !== this._boundsLocalTransformId ) {\n\t\t\tthis._boundsLocalTransformId = currentLocalId;\n\t\t\tthis.getBounds_( this.transform.localTransform, work, boundsLocal );\n\t\t}\n\t\tresult.copyFrom( boundsLocal );\n\t\treturn result;\n\t}\n\n\tprotected getBoundsSize(): IPoint {\n\t\treturn this.size;\n\t}\n\n\tprotected getBounds_( transform: Matrix, work: Point, result: Rectangle ): Rectangle {\n\t\tconst pivot = this.transform.pivot;\n\t\tconst px = pivot.x;\n\t\tconst py = pivot.y;\n\t\tconst size = this.getBoundsSize();\n\t\tconst sx = 0.5 * size.x;\n\t\tconst sy = 0.5 * size.y;\n\n\t\tconst a = transform.a;\n\t\tconst b = transform.b;\n\t\tconst c = transform.c;\n\t\tconst d = transform.d;\n\n\t\tlet x = -sx + px;\n\t\tlet y = -sy + py;\n\t\tconst x0 = a * x + c * y;\n\t\tconst y0 = b * x + d * y;\n\n\t\tx = +sx + px;\n\t\ty = -sy + py;\n\t\tconst x1 = a * x + c * y;\n\t\tconst y1 = b * x + d * y;\n\n\t\tx = -sx + px;\n\t\ty = +sy + py;\n\t\tconst x2 = a * x + c * y;\n\t\tconst y2 = b * x + d * y;\n\n\t\tx = +sx + px;\n\t\ty = +sy + py;\n\t\tconst x3 = a * x + c * y;\n\t\tconst y3 = b * x + d * y;\n\n\t\tconst xmin = Math.min( x0, x1, x2, x3 );\n\t\tconst ymin = Math.min( y0, y1, y2, y3 );\n\t\tconst xmax = Math.max( x0, x1, x2, x3 );\n\t\tconst ymax = Math.max( y0, y1, y2, y3 );\n\t\tresult.x = xmin + transform.tx;\n\t\tresult.y = ymin + transform.ty;\n\t\tresult.width = xmax - xmin;\n\t\tresult.height = ymax - ymin;\n\t\treturn result;\n\t}\n\n\t//\n\tdestroy(): void {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\t}\n\n\t//\n\tprotected onStateChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tthis.runtime?.onStateChange( this, newState, oldState );\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof EShapeBase ) {\n\t\t\t\tchild.state.onParentChange( newState, oldState );\n\t\t\t}\n\t\t}\n\t}\n\n\tget state(): EShapeStateSet {\n\t\tlet result = this._state;\n\t\tif( result == null ) {\n\t\t\tresult = new EShapeStateSetImplObservable(( newState, oldState ): void => {\n\t\t\t\tthis.onStateChange( newState, oldState );\n\t\t\t});\n\t\t\tthis._state = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tfocus(): this {\n\t\tthis.setFocused( true );\n\t\treturn this;\n\t}\n\n\tblur(): this {\n\t\tthis.setFocused( false );\n\t\treturn this;\n\t}\n\n\tprotected setFocused( isFocused: boolean ): void {\n\t\tif( this.state.isFocused !== isFocused ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.getFocusController().set( this, isFocused );\n\t\t\t}\n\t\t}\n\t}\n\n\tget shadowed(): boolean {\n\t\treturn false;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime ) {\n\t\t\treturn runtime.onKeyDown( this, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime ) {\n\t\t\treturn runtime.onKeyUp( this, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\t//\n\tupdate( time: number ): void {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime ) {\n\t\t\truntime.update( this, time );\n\t\t}\n\t}\n\n\tonRender( time: number, renderer: Renderer ): void {\n\t\tconst runtime = this.runtime;\n\t\tif( runtime ) {\n\t\t\truntime.onRender( this, time, renderer );\n\t\t}\n\t}\n\n\tupdateRecursively( time: number ): void {\n\t\tthis.update( time );\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].update( time );\n\t\t}\n\t}\n\n\tcopy( source: EShape, part: EShapeCopyPart = EShapeCopyPart.ALL ): this {\n\t\tthis.id = source.id;\n\t\tthis.uuid = source.uuid;\n\t\tif( (part & EShapeCopyPart.TRANSFORM) !== 0 ) {\n\t\t\tconst transform = this.transform;\n\t\t\tconst sourceTransform = source.transform;\n\t\t\ttransform.position.copyFrom( sourceTransform.position );\n\t\t\ttransform.rotation = sourceTransform.rotation;\n\t\t\ttransform.skew.copyFrom( sourceTransform.skew );\n\t\t\ttransform.pivot.copyFrom( sourceTransform.pivot );\n\t\t\ttransform.scale.copyFrom( sourceTransform.scale );\n\t\t}\n\t\tif( (part & EShapeCopyPart.SIZE) !== 0 ) {\n\t\t\tthis.size.copyFrom( source.size );\n\t\t}\n\t\tif( (part & EShapeCopyPart.STYLE) !== 0 ) {\n\t\t\tthis.fill.copy( source.fill );\n\t\t\tthis.stroke.copy( source.stroke );\n\t\t\tthis.tag.copy( source.tag );\n\t\t\tthis.text.copy( source.text );\n\t\t\tthis.radius = source.radius;\n\t\t\tthis.corner = source.corner;\n\t\t\tif (this._image == null) {\n\t\t\t\tthis._image = source.image;\n\t\t\t}\n\t\t}\n\t\tif( (part & EShapeCopyPart.ACTION) !== 0 ) {\n\t\t\tthis.action.addAll( source.action.values );\n\t\t\tthis.interactive = source.interactive;\n\t\t\tthis.cursor = source.cursor;\n\t\t\tthis.shortcut = source.shortcut;\n\t\t}\n\t\tif( (part & EShapeCopyPart.POINTS) !== 0 ) {\n\t\t\tconst sourcePoints = source.points;\n\t\t\tif( sourcePoints != null ) {\n\t\t\t\tconst points = this.points;\n\t\t\t\tif( points != null ) {\n\t\t\t\t\tpoints.copy( sourcePoints );\n\t\t\t\t} else {\n\t\t\t\t\tthis._points = sourcePoints.clone( this );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( (part & EShapeCopyPart.STATE) !== 0 ) {\n\t\t\tthis.state.lock( false ).copy( source.state ).unlock();\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTheme } from \"./d-theme\";\n\nexport class DThemes {\n\tprivate static DEFAULT_THEME_CLASS: (new () => DTheme) | null = null;\n\tprivate static INSTANCE: DTheme | null = null;\n\n\tpublic static setDefaultThemeClass( theme: new () => DTheme ): void {\n\t\tthis.DEFAULT_THEME_CLASS = theme;\n\t}\n\n\tpublic static getDefaultThemeClass(): (new () => DTheme) | null {\n\t\treturn this.DEFAULT_THEME_CLASS;\n\t}\n\n\tpublic static getInstance(): DTheme {\n\t\tif( this.INSTANCE == null ) {\n\t\t\tconst defaultThemeClass = this.getDefaultThemeClass();\n\t\t\tif( defaultThemeClass == null ) {\n\t\t\t\tthrow new Error( \"No default theme class found\" );\n\t\t\t}\n\t\t\tthis.INSTANCE = new defaultThemeClass();\n\t\t}\n\t\treturn this.INSTANCE;\n\t}\n\n\tpublic static setInstance( instance: DTheme ): DTheme | null {\n\t\tconst result = this.INSTANCE;\n\t\tthis.INSTANCE = instance;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\nimport { EShapeTagValueRange, EShapeTagValueRangeLike } from \"./e-shape-tag-value-range\";\n\nexport enum EShapeTagValueOrder {\n\tASCENDING,\n\tDESCENDING\n}\n\nexport interface EShapeTagValueLike {\n\tid: string;\n\tinitial: string;\n\tformat: string;\n\trange: EShapeTagValueRangeLike;\n\tcapacity: number;\n\torder: EShapeTagValueOrder;\n}\n\nexport interface EShapeTagValueParent {\n\tisChanged: boolean;\n}\n\nexport interface EShapeTagValue extends EShapeTagValueLike {\n\tvalue: unknown;\n\treadonly nvalue: number;\n\ttime: number;\n\n\tvalues: unknown[];\n\ttimes: number[];\n\n\trange: EShapeTagValueRange;\n\tparent?: EShapeTagValueParent;\n\n\tformatter?: ( value: unknown ) => unknown;\n\n\tclear(): void;\n\tremove( index: number ): void;\n\tremoveAll( indices: number[] ): void;\n\tcopy( target: EShapeTagValue ): void;\n\tisEquals( target: EShapeTagValue ): boolean;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"./e-shape-resource-manager-serialization\";\n\nexport enum EShapeTagValueRangeType {\n\tNONE = 0,\n\tFROM = 1,\n\tTO = 2,\n\tFROM_TO = 3\n}\n\nexport interface EShapeTagValueRangeLike {\n\ttype: EShapeTagValueRangeType;\n\tfrom: number;\n\tto: number;\n}\n\nexport interface EShapeTagValueRangeParent {\n\tisChanged: boolean;\n}\n\nexport interface EShapeTagValueRange extends EShapeTagValueRangeLike {\n\tparent?: EShapeTagValueRangeParent;\n\n\tset( from?: number | null, to?: number | null ): boolean;\n\tnormalize( value: number ): number;\n\tisEquals( target: EShapeTagValueRangeLike ): boolean;\n\tcopy( target: EShapeTagValueRangeLike ): void;\n\ttoObject(): EShapeTagValueRangeLike;\n\tserialize( manager: EShapeResourceManagerSerialization ): number;\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemes } from \"../theme/d-themes\";\nimport { EShapeStrokeSide } from \"./e-shape-stroke-side\";\n\nexport interface EThemeShape {\n\tgetFillColor(): number;\n\tgetFillAlpha(): number;\n\tgetStrokeColor(): number;\n\tgetStrokeAlpha(): number;\n\tgetStrokeWidth(): number;\n\tgetStrokeAlign(): number;\n\tgetStrokeSide(): EShapeStrokeSide;\n\tgetTextValue(): string;\n\tgetTextColor(): number;\n\tgetTextAlpha(): number;\n\tgetTextFamily(): string;\n\tgetTextSize(): number;\n\tgetCursor(): string;\n\tgetRadius(): number;\n\tgetSizeX(): number;\n\tgetSizeY(): number;\n\tgetHighlightColor(): number;\n}\n\nexport class EShapeDefaults {\n\tprotected static _THEME?: EThemeShape;\n\n\tstatic get THEME(): EThemeShape {\n\t\tconst theme = this._THEME;\n\t\tif( theme != null ) {\n\t\t\treturn theme;\n\t\t}\n\t\tconst newTheme: EThemeShape = DThemes.getInstance().get( \"EShape\" );\n\t\tthis._THEME = newTheme;\n\t\treturn newTheme;\n\t}\n\n\tstatic get FILL_COLOR(): number {\n\t\treturn this.THEME.getFillColor();\n\t}\n\n\tstatic get FILL_ALPHA(): number {\n\t\treturn this.THEME.getFillAlpha();\n\t}\n\n\tstatic get STROKE_COLOR(): number {\n\t\treturn this.THEME.getStrokeColor();\n\t}\n\n\tstatic get STROKE_ALPHA(): number {\n\t\treturn this.THEME.getStrokeAlpha();\n\t}\n\n\tstatic get STROKE_WIDTH(): number {\n\t\treturn this.THEME.getStrokeWidth();\n\t}\n\n\tstatic get STROKE_ALIGN(): number {\n\t\treturn this.THEME.getStrokeAlign();\n\t}\n\n\tstatic get STROKE_SIDE(): number {\n\t\treturn this.THEME.getStrokeSide();\n\t}\n\n\tstatic get TEXT_VALUE(): string {\n\t\treturn this.THEME.getTextValue();\n\t}\n\n\tstatic get TEXT_COLOR(): number {\n\t\treturn this.THEME.getTextColor();\n\t}\n\n\tstatic get TEXT_ALPHA(): number {\n\t\treturn this.THEME.getTextAlpha();\n\t}\n\n\tstatic get TEXT_FAMILY(): string {\n\t\treturn this.THEME.getTextFamily();\n\t}\n\n\tstatic get TEXT_SIZE(): number {\n\t\treturn this.THEME.getTextSize();\n\t}\n\n\tstatic get CURSOR(): string {\n\t\treturn this.THEME.getCursor();\n\t}\n\n\tstatic get RADIUS(): number {\n\t\treturn this.THEME.getRadius();\n\t}\n\n\tstatic get SIZE_X(): number {\n\t\treturn this.THEME.getSizeX();\n\t}\n\n\tstatic get SIZE_Y(): number {\n\t\treturn this.THEME.getSizeY();\n\t}\n\n\tstatic get HIGHLIGHT_COLOR(): number {\n\t\treturn this.THEME.getHighlightColor();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeFillImplParent } from \"./e-shape-fill-impl-parent\";\n\nexport class EShapeFillImpl implements EShapeFill {\n\tprotected _parent: EShapeFillImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\n\tconstructor( parent: EShapeFillImplParent, enable: boolean, color: number, alpha: number ) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeFillLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeFill {\n\t\treturn new EShapeFillImpl( this._parent, this._enable, this._color, this._alpha );\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst stringified = `[${this._enable ? 1 : 0},${this._color},${this._alpha}]`;\n\t\treturn manager.addResource( stringified );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.getFill( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.setFill( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeStrokeImplParent } from \"./e-shape-stroke-impl-parent\";\n\nexport class EShapeStrokeImpl implements EShapeStroke {\n\tprotected _parent: EShapeStrokeImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _width: number;\n\tprotected _align: number;\n\tprotected _side: EShapeStrokeSide;\n\n\tconstructor(\n\t\tparent: EShapeStrokeImplParent,\n\t\tenable: boolean, color: number, alpha: number,\n\t\twidth: number, align: number, side: EShapeStrokeSide\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._width = width;\n\t\tthis._align = align;\n\t\tthis._side = side;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget align(): number {\n\t\treturn this._align;\n\t}\n\n\tset align( align: number ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\treturn this._side;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\tif( this._side !== side ) {\n\t\t\tthis._side = side;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha, target.width, target.align, target.side );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number, align?: number, side?: EShapeStrokeSide ) {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( width !== undefined && this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( align !== undefined && this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( side !== undefined && this._side !== side ) {\n\t\t\tthis._side = side;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeStroke {\n\t\treturn new EShapeStrokeImpl(\n\t\t\tthis._parent,\n\t\t\tthis._enable, this._color, this._alpha,\n\t\t\tthis._width, this._align, this._side\n\t\t);\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\twidth: this._width,\n\t\t\talign: this._align,\n\t\t\tside: this._side\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst enable = this._enable ? 1 : 0;\n\t\tconst serialized = `[${enable},${this._color},${this._alpha},${this._width},${this._align},${this._side}]`;\n\t\treturn manager.addResource( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.getStroke( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ],\n\t\t\t\t\tparsed[ 3 ],\n\t\t\t\t\tparsed[ 4 ],\n\t\t\t\t\tparsed[ 5 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.setStroke( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ],\n\t\t\t\t\tdeserialized[ 3 ],\n\t\t\t\t\tdeserialized[ 4 ],\n\t\t\t\t\tdeserialized[ 5 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport {\n\tEShapeTagValueRange, EShapeTagValueRangeLike, EShapeTagValueRangeParent, EShapeTagValueRangeType\n} from \"../e-shape-tag-value-range\";\n\nexport class EShapeTagValueRangeImpl implements EShapeTagValueRange {\n\tprotected _type: EShapeTagValueRangeType;\n\tprotected _from: number;\n\tprotected _to: number;\n\tparent?: EShapeTagValueRangeParent;\n\n\tconstructor() {\n\t\tthis._type = EShapeTagValueRangeType.NONE;\n\t\tthis._from = 0;\n\t\tthis._to = 1;\n\t}\n\n\tget type(): EShapeTagValueRangeType {\n\t\treturn this._type;\n\t}\n\n\tset type( type: EShapeTagValueRangeType ) {\n\t\tif( this._type !== type ) {\n\t\t\tthis._type = type;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget from(): number {\n\t\treturn this._from;\n\t}\n\n\tset from( from: number ) {\n\t\tif( this._from !== from ) {\n\t\t\tthis._from = from;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget to(): number {\n\t\treturn this._to;\n\t}\n\n\tset to( to: number ) {\n\t\tif( this._to !== to ) {\n\t\t\tthis._to = to;\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tset( from?: number | null, to?: number | null ): boolean {\n\t\tlet result = false;\n\t\tif( from !== undefined && to !== undefined ) {\n\t\t\tif( from !== null && to !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) | EShapeTagValueRangeType.TO;\n\t\t\t\tif( this._type !== type || this._from !== from || this._to !== to ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else if( from !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.FROM) & (~EShapeTagValueRangeType.TO);\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else if( to !== null ) {\n\t\t\t\tconst type = (this._type | EShapeTagValueRangeType.TO) & (~EShapeTagValueRangeType.FROM);\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~(EShapeTagValueRangeType.TO | EShapeTagValueRangeType.FROM));\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( from !== undefined ) {\n\t\t\tif( from !== null ) {\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.FROM;\n\t\t\t\tif( this._type !== type || this._from !== from ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._from = from;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.FROM);\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( to !== undefined ) {\n\t\t\tif( to !== null ) {\n\t\t\t\tconst type = this._type | EShapeTagValueRangeType.TO;\n\t\t\t\tif( this._type !== type || this._to !== to ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tthis._to = to;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst type = this._type & (~EShapeTagValueRangeType.TO);\n\t\t\t\tif( this._type !== type ) {\n\t\t\t\t\tthis._type = type;\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( result ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tnormalize( value: number ): number {\n\t\tconst type = this._type;\n\t\tconst from = this._from;\n\t\tconst to = this._to;\n\t\tswitch( type ) {\n\t\tcase EShapeTagValueRangeType.FROM_TO:\n\t\t\treturn (value - from) / (to - from);\n\t\tcase EShapeTagValueRangeType.FROM:\n\t\t\treturn value - from;\n\t\tcase EShapeTagValueRangeType.TO:\n\t\t\treturn to - value;\n\t\tcase EShapeTagValueRangeType.NONE:\n\t\tdefault:\n\t\t\treturn value;\n\t\t}\n\t}\n\n\tisEquals( target: EShapeTagValueRangeLike ): boolean {\n\t\treturn (\n\t\t\tthis._type === target.type &&\n\t\t\tthis._from === target.from &&\n\t\t\tthis._to === target.to\n\t\t);\n\t}\n\n\tcopy( target: EShapeTagValueRangeLike ): this {\n\t\treturn this.copy_( target.type, target.from, target.to );\n\t}\n\n\tprotected copy_( type: EShapeTagValueRangeType, from: number, to: number ): this {\n\t\tlet isChanged = false;\n\n\t\tif( this._type !== type ) {\n\t\t\tthis._type = type;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._from !== from ) {\n\t\t\tthis._from = from;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._to !== to ) {\n\t\t\tthis._to = to;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTagValueRangeLike {\n\t\treturn {\n\t\t\ttype: this.type,\n\t\t\tfrom: this.from,\n\t\t\tto: this.to\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst serialized = `[${this._type},${this._from},${this._to}]`;\n\t\treturn manager.addResource( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.getRange( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.copy_(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.setRange( target, deserialized );\n\t\t\t\tthis.copy_(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Renderer } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBaseState } from \"../d-base-state\";\nimport { DBaseStateSet } from \"../d-base-state-set\";\nimport { UtilKeyboardEvent } from \"../util/util-keyboard-event\";\nimport { EShapeActionRuntime } from \"./action/e-shape-action-runtime\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeFillLike } from \"./e-shape-fill\";\nimport { EShapeState } from \"./e-shape-state\";\nimport { EShapeStrokeLike } from \"./e-shape-stroke\";\nimport { EShapeTextLike } from \"./e-shape-text\";\n\nexport enum EShapeRuntimeReset {\n\tNONE = 0,\n\tPOSITION_X = 1,\n\tPOSITION_Y = 2,\n\tPOSITION = POSITION_X | POSITION_Y,\n\tROTATION = 4,\n\tCOLOR_FILL = 8,\n\tCOLOR_STROKE = 16,\n\tCOLOR_FILL_AND_STROKE = COLOR_FILL | COLOR_STROKE,\n\tCOLOR_TEXT = 32,\n\tCOLOR_TEXT_OUTLINE = 64,\n\tCOLOR = COLOR_FILL | COLOR_STROKE | COLOR_TEXT | COLOR_TEXT_OUTLINE,\n\tVISIBILITY = 128,\n\tHEIGHT = 256,\n\tWIDTH = 512,\n\tSIZE = HEIGHT | WIDTH,\n\tTEXT = 1024,\n\tCURSOR = 2048\n}\n\nexport class EShapeRuntime {\n\tx: number;\n\ty: number;\n\tsize: Point;\n\trotation: number;\n\tactions: EShapeActionRuntime[];\n\tfill: EShapeFillLike;\n\tstroke: EShapeStrokeLike;\n\ttext: EShapeTextLike;\n\tcursor: string;\n\n\treset: EShapeRuntimeReset;\n\twritten: EShapeRuntimeReset;\n\n\teffect: number;\n\n\tisStateChanged: boolean;\n\tinteractive: boolean;\n\n\tconstructor( shape: EShape ) {\n\t\tconst transform = shape.transform;\n\t\tconst position = transform.position;\n\t\tthis.x = position.x;\n\t\tthis.y = position.y;\n\t\tthis.size = new Point( shape.size.x, shape.size.y );\n\t\tthis.rotation = transform.rotation;\n\t\tthis.actions = [];\n\t\tthis.fill = shape.fill.toObject();\n\t\tthis.stroke = shape.stroke.toObject();\n\t\tthis.text = shape.text.toObject();\n\t\tthis.cursor = shape.cursor;\n\t\tthis.reset = EShapeRuntimeReset.NONE;\n\t\tthis.written = EShapeRuntimeReset.NONE;\n\t\tthis.effect = NaN;\n\t\tthis.isStateChanged = false;\n\t\tthis.interactive = false;\n\t}\n\n\tonClick( shape: EShape, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tif( ! shape.state.inDisabled ) {\n\t\t\tshape.state.isClicked = true;\n\t\t}\n\t}\n\n\tonDblClick( shape: EShape, e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].onDblClick( shape, this, e, interactionManager );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonOver( shape: EShape, e: interaction.InteractionEvent ): void {\n\t\tshape.state.isHovered = true;\n\t}\n\n\tonOut( shape: EShape, e: interaction.InteractionEvent ): void {\n\t\tshape.state.isHovered = false;\n\t}\n\n\tonDown( shape: EShape, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tif( ! shape.state.isDown ) {\n\t\t\tthis.onDownThisBefore( shape, e );\n\n\t\t\t// State\n\t\t\tshape.state.addAll( EShapeState.DOWN, DBaseState.PRESSED );\n\n\n\t\t\t// Focus\n\t\t\tconst layer = DApplications.getLayer( shape );\n\t\t\tif( layer ) {\n\t\t\t\tconst focusController = layer.getFocusController();\n\t\t\t\tfocusController.focus( focusController.findParent( shape ) );\n\t\t\t}\n\n\t\t\tthis.onDownThisAfter( shape, e );\n\t\t}\n\t}\n\n\tprotected onDownThisBefore( shape: EShape, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].onDownThisBefore( shape, this, e );\n\t\t}\n\t}\n\n\tprotected onDownThisAfter( shape: EShape, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].onDownThisAfter( shape, this, e );\n\t\t}\n\t}\n\n\tonUp( shape: EShape, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tif( ! shape.state.isUp && shape.state.isPressed ) {\n\t\t\tshape.state.set( EShapeState.UP, DBaseState.PRESSED );\n\n\t\t\t// Click\n\t\t\tthis.onClick( shape, e );\n\t\t}\n\t}\n\n\tonMove( shape: EShape, e?: interaction.InteractionEvent ): void {\n\t\t//\n\t}\n\n\tonKeyDown( shape: EShape, e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onDown( shape, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonKeyUp( shape: EShape, e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onUp( shape, e );\n\t\t}\n\t\treturn false;\n\t}\n\n\tonStateChange( shape: EShape, newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tthis.isStateChanged = true;\n\t\tDApplications.update( shape );\n\n\t\tif( newState.isFocused ) {\n\t\t\tif( ! oldState.isFocused ) {\n\t\t\t\tthis.onFocus( shape );\n\t\t\t}\n\t\t} else if( oldState.isFocused ) {\n\t\t\tthis.onBlur( shape );\n\t\t}\n\t}\n\n\tonFocus( shape: EShape ): void {\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].onFocus( shape, this );\n\t\t}\n\t}\n\n\tonBlur( shape: EShape ): void {\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].onBlur( shape, this );\n\t\t}\n\t}\n\n\tupdate( shape: EShape, time: number ): void {\n\t\tconst tag = shape.tag;\n\t\tconst isEffectTimeUp = ( this.effect <= time );\n\t\tif( tag.isChanged || this.isStateChanged || isEffectTimeUp ) {\n\t\t\tif( isEffectTimeUp ) {\n\t\t\t\tthis.effect = NaN;\n\t\t\t}\n\t\t\tshape.disallowUploadedUpdate();\n\t\t\tthis.onUpdate( shape, time );\n\t\t\tshape.allowUploadedUpdate();\n\t\t\tshape.state.removeAll( EShapeState.CLICKED, EShapeState.DOWN, EShapeState.UP );\n\t\t\tthis.isStateChanged = false;\n\t\t\ttag.isChanged = false;\n\t\t}\n\t}\n\n\tonRender( shape: EShape, time: number, renderer: Renderer ): void {\n\t\tconst actions = this.actions;\n\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\tactions[ i ].onRender( shape, this, time, renderer );\n\t\t}\n\t\tthis.update( shape, time );\n\t}\n\n\tprotected onUpdate( shape: EShape, time: number ): void {\n\t\tconst actions = this.actions;\n\t\tif( 0 < actions.length ) {\n\t\t\tthis.written = EShapeRuntimeReset.NONE;\n\t\t\tfor( let i = 0, imax = actions.length; i < imax; ++i ) {\n\t\t\t\tactions[ i ].execute( shape, this, time );\n\t\t\t}\n\t\t\tthis.doReset( shape );\n\t\t}\n\t}\n\n\tprotected doReset( shape: EShape ): void {\n\t\tconst target = (~this.written) & this.reset;\n\t\tif( target !== EShapeRuntimeReset.NONE ) {\n\t\t\tif( target & EShapeRuntimeReset.POSITION_X ) {\n\t\t\t\tshape.transform.position.x = this.x;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.POSITION_Y ) {\n\t\t\t\tshape.transform.position.y = this.y;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.VISIBILITY ) {\n\t\t\t\tshape.visible = true;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\tconst fill = this.fill;\n\t\t\t\tshape.fill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tfill.color,\n\t\t\t\t\tfill.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\tconst stroke = this.stroke;\n\t\t\t\tshape.stroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\tstroke.color,\n\t\t\t\t\tstroke.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\tconst text = this.text;\n\t\t\t\tshape.text.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\ttext.color,\n\t\t\t\t\ttext.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\tconst outline = this.text.outline;\n\t\t\t\tshape.text.outline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\toutline.color,\n\t\t\t\t\toutline.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.HEIGHT ) {\n\t\t\t\tshape.size.y = this.size.y;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.WIDTH ) {\n\t\t\t\tshape.size.x = this.size.x;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.ROTATION ) {\n\t\t\t\tshape.transform.rotation = this.rotation;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.TEXT ) {\n\t\t\t\tshape.text.value = this.text.value;\n\t\t\t}\n\t\t\tif( target & EShapeRuntimeReset.CURSOR ) {\n\t\t\t\tshape.cursor = this.cursor;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedTagValue } from \"../../d-diagram-serialized\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTagValue, EShapeTagValueOrder, EShapeTagValueParent } from \"../e-shape-tag-value\";\nimport { EShapeTagValueRange } from \"../e-shape-tag-value-range\";\nimport { EShapeTagValueRangeImpl } from \"./e-shape-tag-value-range-impl\";\n\nconst INDEX_COMPARATOR = ( a: number, b: number ): number => {\n\treturn a - b;\n};\n\nexport class EShapeTagValueImpl implements EShapeTagValue {\n\tid: string;\n\tinitial: string;\n\tformat: string;\n\trange: EShapeTagValueRange;\n\tprotected _value: unknown;\n\tprotected _time: number;\n\n\tprotected _values: unknown[] | undefined;\n\tprotected _times: number[] | undefined;\n\tprotected _capacity: number;\n\tprotected _order: EShapeTagValueOrder;\n\n\tprotected _parent?: EShapeTagValueParent;\n\n\tformatter?: ( value: unknown ) => unknown;\n\n\tconstructor() {\n\t\tthis.id = \"\";\n\t\tthis.initial = \"\";\n\t\tthis.format = \"\";\n\t\tthis.range = new EShapeTagValueRangeImpl();\n\t\tthis._value = 0;\n\t\tthis._time = 0;\n\t\tthis._capacity = 0;\n\t\tthis._order = EShapeTagValueOrder.ASCENDING;\n\t}\n\n\tget parent(): EShapeTagValueParent | undefined {\n\t\treturn this._parent;\n\t}\n\n\tset parent( parent: EShapeTagValueParent | undefined ) {\n\t\tif( this._parent !== parent ) {\n\t\t\tthis._parent = parent;\n\t\t\tthis.range.parent = parent;\n\t\t}\n\t}\n\n\tget value(): unknown {\n\t\treturn this._value;\n\t}\n\n\tset value( newValue: unknown ) {\n\t\tconst formatter = this.formatter;\n\t\tif( formatter != null ) {\n\t\t\tnewValue = formatter( newValue );\n\t\t}\n\n\t\tconst capacity = this._capacity;\n\t\tif( capacity <= 0 ) {\n\t\t\tif( this._value !== newValue ) {\n\t\t\t\tthis._value = newValue;\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tlet values = this._values;\n\t\t\tif( values == null ) {\n\t\t\t\tvalues = [];\n\t\t\t\tthis._values = values;\n\t\t\t}\n\n\t\t\t// Update the value\n\t\t\tthis._value = newValue;\n\n\t\t\t// Update the values\n\t\t\tconst order = this._order;\n\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\tvalues.push( newValue );\n\t\t\t} else {\n\t\t\t\tvalues.unshift( newValue );\n\t\t\t}\n\n\t\t\t// Remove the unnecessary values\n\t\t\tconst count = values.length - capacity;\n\t\t\tif( 0 < count ) {\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Tell the parent it's changed\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget nvalue(): number {\n\t\treturn this.range.normalize( this._value as number );\n\t}\n\n\tget values(): unknown[] {\n\t\tlet result = this._values;\n\t\tif( result == null ) {\n\t\t\tresult = [];\n\t\t\tthis._values = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tset values( newValues: unknown[] ) {\n\t\tif( 0 < newValues.length ) {\n\t\t\tconst capacity = this._capacity;\n\t\t\tif( capacity <= 0 ) {\n\t\t\t\tlet newValue = newValues[ newValues.length - 1 ];\n\t\t\t\tconst formatter = this.formatter;\n\t\t\t\tif( formatter != null ) {\n\t\t\t\t\tnewValue = formatter( newValue );\n\t\t\t\t}\n\t\t\t\tif( this._value !== newValue ) {\n\t\t\t\t\tthis._value = newValue;\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif( parent != null ) {\n\t\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tlet values = this._values;\n\t\t\t\tif( values == null ) {\n\t\t\t\t\tvalues = [];\n\t\t\t\t\tthis._values = values;\n\t\t\t\t}\n\n\t\t\t\tconst order = this._order;\n\t\t\t\tconst formatter = this.formatter;\n\t\t\t\tif( formatter != null ) {\n\t\t\t\t\t// Update the value\n\t\t\t\t\tthis._value = formatter( newValues[ newValues.length - 1 ] );\n\n\t\t\t\t\t// Update the values\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.push( formatter( newValues[ i ] ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.unshift( formatter( newValues[ i ] ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Update the value\n\t\t\t\t\tthis._value = newValues[ newValues.length - 1 ];\n\n\t\t\t\t\t// Update the values\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = 0, imax = newValues.length; i < imax; ++i ) {\n\t\t\t\t\t\t\tvalues.unshift( newValues[ i ] );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Remove the unnecessary values\n\t\t\t\tconst count = values.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Tell the parent it's changed\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget time(): number {\n\t\treturn this._time;\n\t}\n\n\tset time( newTime: number ) {\n\t\tconst capacity = this._capacity;\n\t\tif( capacity <= 0 ) {\n\t\t\tif( this._time !== newTime ) {\n\t\t\t\tthis._time = newTime;\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Update the times\n\t\t\tlet times = this._times;\n\t\t\tif( times == null ) {\n\t\t\t\ttimes = [];\n\t\t\t\tthis._times = times;\n\t\t\t}\n\n\t\t\t// Update the time\n\t\t\tthis._time = newTime;\n\n\t\t\t// Update the times\n\t\t\tconst order = this._order;\n\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\ttimes.push( newTime );\n\t\t\t} else {\n\t\t\t\ttimes.unshift( newTime );\n\t\t\t}\n\n\t\t\t// Remove the unnecessary times\n\t\t\tconst count = times.length - capacity;\n\t\t\tif( 0 < count ) {\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Tell the parent it's changed\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tget times(): number[] {\n\t\tlet result = this._times;\n\t\tif( result == null ) {\n\t\t\tresult = [];\n\t\t\tthis._times = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tset times( newTimes: number[] ) {\n\t\tif( 0 < newTimes.length ) {\n\t\t\tconst capacity = this._capacity;\n\t\t\tif( capacity <= 0 ) {\n\t\t\t\tconst newTime = newTimes[ newTimes.length - 1 ];\n\t\t\t\tif( this._time !== newTime ) {\n\t\t\t\t\tthis._time = newTime;\n\t\t\t\t\tconst parent = this.parent;\n\t\t\t\t\tif( parent != null ) {\n\t\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Update the times\n\t\t\t\tlet times = this._times;\n\t\t\t\tif( times == null ) {\n\t\t\t\t\ttimes = [];\n\t\t\t\t\tthis._times = times;\n\t\t\t\t}\n\n\t\t\t\t// Update the value\n\t\t\t\tthis._time = newTimes[ newTimes.length - 1 ];\n\n\t\t\t\t//\n\t\t\t\tconst order = this._order;\n\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\tfor( let i = 0, imax = newTimes.length; i < imax; ++i ) {\n\t\t\t\t\t\ttimes.push( newTimes[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = newTimes.length; i < imax; ++i ) {\n\t\t\t\t\t\ttimes.unshift( newTimes[ i ] );\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t//\n\t\t\t\tconst count = times.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Tell the parent it's changed\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget capacity(): number {\n\t\treturn this._capacity;\n\t}\n\n\tset capacity( capacity: number ) {\n\t\tif( this._capacity < capacity ) {\n\t\t\tthis._capacity = capacity;\n\t\t} else if( capacity < this._capacity ) {\n\t\t\tthis._capacity = capacity;\n\n\t\t\tlet isChanged = false;\n\n\t\t\t// Values\n\t\t\tconst order = this._order;\n\t\t\tconst values = this._values;\n\t\t\tif( values != null ) {\n\t\t\t\tconst count = values.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\tvalues.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t\tisChanged = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Times\n\t\t\tconst times = this._times;\n\t\t\tif( times != null ) {\n\t\t\t\tconst count = times.length - capacity;\n\t\t\t\tif( 0 < count ) {\n\t\t\t\t\tif( order === EShapeTagValueOrder.ASCENDING ) {\n\t\t\t\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\t\t\t\ttimes.shift();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttimes.length = capacity;\n\t\t\t\t\t}\n\t\t\t\t\tisChanged = true;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( isChanged ) {\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent != null ) {\n\t\t\t\t\tparent.isChanged = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget order(): EShapeTagValueOrder {\n\t\treturn this._order;\n\t}\n\n\tset order( order: EShapeTagValueOrder ) {\n\t\tthis._order = order;\n\t}\n\n\tremove( index: number ): void {\n\t\tlet isChanged = false;\n\n\t\t// Values\n\t\tconst values = this._values;\n\t\tif( values != null ) {\n\t\t\tif( 0 <= index && index < values.length ) {\n\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\t// Times\n\t\tconst times = this._times;\n\t\tif( times != null ) {\n\t\t\tif( 0 <= index && index < times.length ) {\n\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tremoveAll( indices: number[] ): void {\n\t\tlet isChanged = false;\n\n\t\tconst values = this._values;\n\t\tconst times = this._times;\n\t\tconst sorted = indices.slice(0).sort( INDEX_COMPARATOR );\n\t\tif( values != null ) {\n\t\t\tif( times != null ) {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\t\tif( index < values.length ) {\n\t\t\t\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( index < times.length ) {\n\t\t\t\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index && index < values.length ) {\n\t\t\t\t\t\tvalues.splice( index, 1 );\n\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( times != null ) {\n\t\t\t\tfor( let i = sorted.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst index = sorted[ i ];\n\t\t\t\t\tif( 0 <= index && index < times.length ) {\n\t\t\t\t\t\ttimes.splice( index, 1 );\n\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tlet isChanged = false;\n\n\t\t// Values\n\t\tconst values = this._values;\n\t\tif( values != null ) {\n\t\t\tvalues.length = 0;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\t// Times\n\t\tconst times = this._times;\n\t\tif( times != null ) {\n\t\t\ttimes.length = 0;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\t// Change flag\n\t\tif( isChanged ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.isChanged = true;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * This method does not copy the `#values` and `#times` for the performance.\n\t *\n\t * @param target a copy target\n\t */\n\tcopy( target: EShapeTagValue ): this {\n\t\tthis.id = target.id;\n\t\tthis.initial = target.initial;\n\t\tthis.format = target.format;\n\t\tthis.formatter = target.formatter;\n\t\tthis.range.copy( target.range );\n\t\tthis._value = target.value;\n\t\tthis._time = target.time;\n\t\tthis._capacity = target.capacity;\n\t\treturn this;\n\t}\n\n\tisEquals( target: EShapeTagValue ): boolean {\n\t\treturn (\n\t\t\tthis.id === target.id &&\n\t\t\tthis.initial === target.initial &&\n\t\t\tthis.formatter === target.formatter &&\n\t\t\tthis.range.isEquals( target.range )\n\t\t);\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst idSerialized = manager.addTag( this.id );\n\t\tconst initialSerialized = manager.addResource( this.initial );\n\t\tconst formatSerialized = manager.addResource( this.format.trim() );\n\t\tconst rangeSerialized = this.range.serialize( manager );\n\t\treturn manager.addResource(\n\t\t\t`[${idSerialized},${initialSerialized},${formatSerialized},${rangeSerialized},${this._capacity},${this._order}]`\n\t\t);\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): this {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tlet parsed = manager.getTagValue( target );\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ target ] ) as DDiagramSerializedTagValue;\n\t\t\t\tmanager.setTagValue( target, parsed );\n\t\t\t}\n\t\t\tthis.id = manager.tags[ parsed[ 0 ] ] || \"\";\n\t\t\tthis.initial = resources[ parsed[ 1 ] ] || \"\";\n\t\t\tthis.format = resources[ parsed[ 2 ] ] || \"\";\n\t\t\tthis.range.deserialize( parsed[ 3 ], manager );\n\t\t\tthis._capacity = parsed[ 4 ];\n\t\t\tthis._order = parsed[ 5 ];\n\t\t}\n\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeTagValue } from \"../e-shape-tag-value\";\nimport { EShapeTagValueRange } from \"../e-shape-tag-value-range\";\nimport { EShapeTagValueImpl } from \"./e-shape-tag-value-impl\";\nimport { EShapeTagValueRangeImpl } from \"./e-shape-tag-value-range-impl\";\n\nexport class EShapeTagImpl implements EShapeTag {\n\tstatic RANGE_DUMMY = new EShapeTagValueRangeImpl();\n\tstatic EMPTY_ARRAY = [];\n\n\tprotected _values: EShapeTagValue[];\n\tisChanged: boolean;\n\tinherited?: EShapeTagValue;\n\n\tconstructor() {\n\t\tthis._values = [];\n\t\tthis.isChanged = true;\n\t}\n\n\tget id(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].id;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.id;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget initial(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].initial;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.initial;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget format(): string {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].format;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.format;\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tget range(): EShapeTagValueRange {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].range;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.range;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.RANGE_DUMMY;\n\t}\n\n\tget value(): unknown {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].value;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.value;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset value( value: unknown ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].value = value;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.value = value;\n\t\t\t}\n\t\t}\n\t}\n\n\tget nvalue(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].nvalue;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.nvalue;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget time(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].time;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.time;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset time( time: number ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].time = time;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.time = time;\n\t\t\t}\n\t\t}\n\t}\n\n\tget values(): unknown[] {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].values;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.values;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.EMPTY_ARRAY;\n\t}\n\n\tset values( newValues: unknown[] ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].values = newValues;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.values = newValues;\n\t\t\t}\n\t\t}\n\t}\n\n\tget times(): number[] {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].times;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.times;\n\t\t\t}\n\t\t}\n\t\treturn EShapeTagImpl.EMPTY_ARRAY;\n\t}\n\n\tset times( newTimes: number[] ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].times = newTimes;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.times = newTimes;\n\t\t\t}\n\t\t}\n\t}\n\n\tget capacity(): number {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\treturn values[ 0 ].capacity;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\treturn inherited.capacity;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset capacity( capacity: number ) {\n\t\tconst values = this._values;\n\t\tif( 0 < values.length ) {\n\t\t\tvalues[ 0 ].capacity = capacity;\n\t\t} else {\n\t\t\tconst inherited = this.inherited;\n\t\t\tif( inherited != null ) {\n\t\t\t\tinherited.capacity = capacity;\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( value: EShapeTagValue, index?: number ): void {\n\t\tconst values = this._values;\n\t\tvalue.parent = this;\n\t\tif( index === undefined ) {\n\t\t\tvalues.push( value );\n\t\t} else {\n\t\t\tvalues.splice( index, 0, value );\n\t\t}\n\t}\n\n\tset( index: number, value: EShapeTagValue ): EShapeTagValue | null {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tconst result = values[ index ];\n\t\t\tvalue.parent = this;\n\t\t\tvalues[ index ] = value;\n\t\t\tresult.parent = undefined;\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tremove( index: number ): void {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tvalues.splice( index, 1 )[ 0 ].parent = undefined;\n\t\t}\n\t}\n\n\tindexOf( target: EShapeTagValue ): number {\n\t\tconst values = this._values;\n\t\tconst valuesLength = values.length;\n\n\t\t// Instance-based matching\n\t\tfor( let i = 0; i < valuesLength; ++i ) {\n\t\t\tif( values[ i ] === target ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// Data-based matching\n\t\tfor( let i = 0; i < valuesLength; ++i ) {\n\t\t\tif( values[ i ].isEquals( target ) ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\t// ID-based matching\n\t\tfor( let i = 0; i < valuesLength; ++i ) {\n\t\t\tif( values[ i ].id === target.id ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\n\t\treturn -1;\n\t}\n\n\tget( index: number ): EShapeTagValue | null {\n\t\tconst values = this._values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\treturn values[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._values.length;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tconst values = this._values;\n\t\tconst tmp = values[ indexB ];\n\t\tvalues[ indexB ] = values[ indexA ];\n\t\tvalues[ indexA ] = tmp;\n\t}\n\n\tcopy( target: EShapeTag ): this {\n\t\tconst values = this._values;\n\t\tvalues.length = 0;\n\n\t\tfor( let i = 0, imax = target.size(); i < imax; ++i ) {\n\t\t\tconst value = target.get( i );\n\t\t\tif( value != null ) {\n\t\t\t\tconst newValue = new EShapeTagValueImpl().copy( value );\n\t\t\t\tnewValue.parent = this;\n\t\t\t\tvalues.push( newValue );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst values = this._values;\n\t\tif( values.length <= 0 ) {\n\t\t\treturn manager.addResource( \"[]\" );\n\t\t} else {\n\t\t\tlet serialized = `[${values[ 0 ].serialize( manager )}`;\n\t\t\tfor( let i = 1, imax = values.length; i < imax; ++i ) {\n\t\t\t\tserialized += `,${values[ i ].serialize( manager )}`;\n\t\t\t}\n\t\t\tserialized += \"]\";\n\t\t\treturn manager.addResource( serialized );\n\t\t}\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tif( 0 <= target && target < manager.resources.length ) {\n\t\t\tlet deserialized: number[] | undefined = manager.getTag( target );\n\t\t\tif( deserialized == null ) {\n\t\t\t\tdeserialized = JSON.parse( manager.resources[ target ] ) as number[];\n\t\t\t\tmanager.setTag( target, deserialized );\n\t\t\t}\n\n\t\t\tconst values = this._values;\n\t\t\tvalues.length = 0;\n\t\t\tconst deserializedLength = deserialized.length;\n\t\t\tfor( let i = 0; i < deserializedLength; ++i ) {\n\t\t\t\tconst index = deserialized[ i ];\n\t\t\t\tconst value = new EShapeTagValueImpl();\n\t\t\t\tvalue.parent = this;\n\t\t\t\tvalue.deserialize( index, manager );\n\t\t\t\tvalues.push( value );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextAlignImplParent } from \"./e-shape-text-align-impl-parent\";\n\nexport class EShapeTextAlignImpl implements EShapeTextAlign {\n\tprotected _parent: EShapeTextAlignImplParent;\n\tprotected _horizontal: EShapeTextAlignHorizontal;\n\tprotected _vertical: EShapeTextAlignVertical;\n\n\tconstructor(\n\t\tparent: EShapeTextAlignImplParent,\n\t\thorizontal: EShapeTextAlignHorizontal, vertical: EShapeTextAlignVertical\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._horizontal = horizontal;\n\t\tthis._vertical = vertical;\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\treturn this._horizontal;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\tif( this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\treturn this._vertical;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\tif( this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.horizontal, target.vertical );\n\t\t}\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\tlet isChanged = false;\n\n\t\tif( horizontal != null && this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( vertical != null && this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\treturn {\n\t\t\thorizontal: this._horizontal,\n\t\t\tvertical: this._vertical\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.addResource( `[${this._horizontal},${this._vertical}]` );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.getAlign( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.setAlign( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeTextOffsetImplParent } from \"./e-shape-text-offset-impl-parent\";\n\nexport class EShapeTextOffsetImpl implements EShapeTextOffset {\n\tprotected _parent: EShapeTextOffsetImplParent;\n\tprotected _horizontal: number;\n\tprotected _vertical: number;\n\n\tconstructor( parent: EShapeTextOffsetImplParent, horizontal: number, vertical: number ) {\n\t\tthis._parent = parent;\n\t\tthis._horizontal = horizontal;\n\t\tthis._vertical = vertical;\n\t}\n\n\tget horizontal(): number {\n\t\treturn this._horizontal;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tif( this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\treturn this._vertical;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tif( this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.horizontal, target.vertical );\n\t\t}\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( horizontal != null && this._horizontal !== horizontal ) {\n\t\t\tthis._horizontal = horizontal;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( vertical != null && this._vertical !== vertical ) {\n\t\t\tthis._vertical = vertical;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: this._horizontal,\n\t\t\tvertical: this._vertical\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.addResource( `[${this._horizontal},${this._vertical}]` );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.getMargin( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ],\n\t\t\t\t\tparsed[ 1 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.setMargin( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ],\n\t\t\t\t\tdeserialized[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeTextOutlineImplParent } from \"./e-shape-text-outline-impl-parent\";\n\nexport class EShapeTextOutlineImpl implements EShapeTextOutline {\n\tprotected _parent: EShapeTextOutlineImplParent;\n\tprotected _enable: boolean;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _width: number;\n\n\tconstructor( parent: EShapeTextOutlineImplParent, enable: boolean, color: number, alpha: number, width: number ) {\n\t\tthis._parent = parent;\n\t\tthis._enable = enable;\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._width = width;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ): void {\n\t\tif( target ) {\n\t\t\tthis.set( target.enable, target.color, target.alpha, target.width );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\tlet isChanged = false;\n\n\t\tif( enable !== undefined && this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( width !== undefined && this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tclone(): EShapeTextOutline {\n\t\treturn new EShapeTextOutlineImpl( this._parent, this._enable, this._color, this._alpha, this._width );\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\twidth: this._width\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst serialized = `[${this._enable ? 1 : 0},${this._color},${this._alpha},${this._width}]`;\n\t\treturn manager.addResource( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tconst parsed = manager.getTextOutline( target );\n\t\t\tif( parsed != null ) {\n\t\t\t\tthis.set(\n\t\t\t\t\tparsed[ 0 ] !== 0,\n\t\t\t\t\tparsed[ 1 ],\n\t\t\t\t\tparsed[ 2 ],\n\t\t\t\t\tparsed[ 3 ]\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst deserialized = JSON.parse( resources[ target ] );\n\t\t\t\tmanager.setTextOutline( target, deserialized );\n\t\t\t\tthis.set(\n\t\t\t\t\tdeserialized[ 0 ] !== 0,\n\t\t\t\t\tdeserialized[ 1 ],\n\t\t\t\t\tdeserialized[ 2 ],\n\t\t\t\t\tdeserialized[ 3 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DDiagramSerializedText } from \"../../d-diagram-serialized\";\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextAtlas, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextAlign } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeTextOffset } from \"../e-shape-text-offset\";\nimport { EShapeTextOutline } from \"../e-shape-text-outline\";\nimport { EShapeTextAlignImpl } from \"./e-shape-text-align-impl\";\nimport { EShapeTextImplParent } from \"./e-shape-text-impl-parent\";\nimport { EShapeTextOffsetImpl } from \"./e-shape-text-offset-impl\";\nimport { EShapeTextOutlineImpl } from \"./e-shape-text-outline-impl\";\n\nexport class EShapeTextImpl implements EShapeText {\n\tprotected _parent: EShapeTextImplParent;\n\tprotected _enable: boolean;\n\tprotected _value: string;\n\tprotected _family: string;\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _size: number;\n\tprotected _weight: EShapeTextWeight;\n\treadonly align: EShapeTextAlign;\n\treadonly offset: EShapeTextOffset;\n\tprotected _style: EShapeTextStyle;\n\treadonly outline: EShapeTextOutline;\n\treadonly spacing: EShapeTextOffset;\n\tprotected _direction: EShapeTextDirection;\n\treadonly padding: EShapeTextOffset;\n\tprotected _clipping: boolean;\n\n\ttexture?: Texture;\t\t\t// Used for rendering and updated when rendered\n\tatlas?: EShapeTextAtlas;\t// Used for rendering and updated when rendered\n\tworld?: number[];\t\t\t// Updated when rendered\n\n\tconstructor(\n\t\tparent: EShapeTextImplParent,\n\t\tvalue: string, color: number, alpha: number, family: string, size: number\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._enable = true;\n\t\tthis._value = value;\n\t\tthis._color = color!;\n\t\tthis._alpha = alpha!;\n\t\tthis._family = family!;\n\t\tthis._size = size!;\n\t\tthis._weight = EShapeTextWeight.NORMAL;\n\t\tthis.align = new EShapeTextAlignImpl( parent, EShapeTextAlignHorizontal.CENTER, EShapeTextAlignVertical.MIDDLE );\n\t\tthis.offset = new EShapeTextOffsetImpl( parent, 0, 0 );\n\t\tthis._style = EShapeTextStyle.NORMAL;\n\t\tthis.spacing = new EShapeTextOffsetImpl( parent, 0, 0 );\n\t\tthis.outline = new EShapeTextOutlineImpl( parent, false, 0xffffff, 1.0, 0.5 );\n\t\tthis._direction = EShapeTextDirection.LEFT_TO_RIGHT;\n\t\tthis.padding = new EShapeTextOffsetImpl( parent, 10, 10 );\n\t\tthis._clipping = false;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget value(): string {\n\t\treturn this._value;\n\t}\n\n\tset value( value: string ) {\n\t\tif( this._value !== value ) {\n\t\t\tthis._value = value;\n\n\t\t\t// Compatibility check\n\t\t\tconst parent = this._parent;\n\t\t\tconst uploaded = parent.uploaded;\n\t\t\tif( uploaded == null || ! uploaded.isCompatible( parent ) ) {\n\t\t\t\tthis.atlas = undefined;\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Character code check\n\t\t\tconst atlas = this.atlas;\n\t\t\tconst characters = atlas && atlas.characters;\n\t\t\tif( characters != null ) {\n\t\t\t\tfor( let i = 0, imax = value.length; i < imax; ++i ) {\n\t\t\t\t\tconst char = value[ i ];\n\t\t\t\t\tif( ! (char in characters) ) {\n\t\t\t\t\t\tthis.atlas = undefined;\n\t\t\t\t\t\tparent.toDirty();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.atlas = undefined;\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// Update uploaded\n\t\t\tparent.updateUploaded();\n\t\t}\n\t}\n\n\tget family(): string {\n\t\treturn this._family;\n\t}\n\n\tset family( family: string ) {\n\t\tif( this._family !== family ) {\n\t\t\tthis._family = family;\n\t\t\tthis._parent.toDirty();\n\t\t}\n\t}\n\n\tget color(): number {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tif( this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\treturn this._weight;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\tif( this._weight !== weight ) {\n\t\t\tthis._weight = weight;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\tif( this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget direction(): EShapeTextDirection {\n\t\treturn this._direction;\n\t}\n\n\tset direction( direction: EShapeTextDirection ) {\n\t\tif( this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tget clipping(): boolean {\n\t\treturn this._clipping;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tif( this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\tif( target ) {\n\t\t\tthis.set(\n\t\t\t\ttarget.value,\n\t\t\t\ttarget.color,\n\t\t\t\ttarget.alpha,\n\t\t\t\ttarget.family,\n\t\t\t\ttarget.size,\n\t\t\t\ttarget.weight,\n\t\t\t\ttarget.style,\n\t\t\t\ttarget.direction,\n\t\t\t\ttarget.clipping\n\t\t\t);\n\t\t\tthis.align.copy( target.align );\n\t\t\tthis.offset.copy( target.offset );\n\t\t\tthis.outline.copy( target.outline );\n\t\t\tthis.spacing.copy( target.spacing );\n\t\t\tthis.padding.copy( target.padding );\n\t\t}\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this {\n\t\tlet isChangedDirty = false;\n\t\tlet isChangedUploaded = false;\n\n\t\tif( value != null && this._value !== value ) {\n\t\t\tthis._value = value;\n\t\t\tisChangedDirty = true;\n\t\t}\n\n\t\tif( color != null && this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( alpha != null && this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( family != null && this._family !== family ) {\n\t\t\tthis._family = family;\n\t\t\tisChangedDirty = true;\n\t\t}\n\n\t\tif( size != null && this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( weight != null && this._weight !== weight ) {\n\t\t\tthis._weight = weight;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( style != null && this._style !== style ) {\n\t\t\tthis._style = style;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( direction != null && this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( clipping != null && this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tisChangedUploaded = true;\n\t\t}\n\n\t\tif( isChangedDirty ) {\n\t\t\tthis._parent.toDirty();\n\t\t} else if( isChangedUploaded ) {\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\treturn {\n\t\t\tvalue: this._value,\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\tfamily: this._family,\n\t\t\tsize: this._size,\n\t\t\tweight: this._weight,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: this._style,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tdirection: this._direction,\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: this._clipping\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst alignSerialized = this.align.serialize( manager );\n\t\tconst offsetSerialized = this.offset.serialize( manager );\n\t\tconst outlineSerialized = this.outline.serialize( manager );\n\t\tconst spacingSerialized = this.spacing.serialize( manager );\n\t\tconst paddingSerialized = this.padding.serialize( manager );\n\t\tconst serialized = `[${manager.addResource( this._value )},${this._color},${this._alpha},` +\n\t\t\t`${manager.addResource( this._family )},${this._size},${this._weight},${alignSerialized},` +\n\t\t\t`${offsetSerialized},${this._style},${outlineSerialized},${spacingSerialized},` +\n\t\t\t`${this._direction},${paddingSerialized},${this._clipping ? 1 : 0 }]`;\n\t\treturn manager.addResource( serialized );\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\tconst resources = manager.resources;\n\t\tif( 0 <= target && target < resources.length ) {\n\t\t\tlet parsed = manager.getText( target );\n\t\t\tif( parsed == null ) {\n\t\t\t\tparsed = JSON.parse( resources[ target ] ) as DDiagramSerializedText;\n\t\t\t\tmanager.setText( target, parsed );\n\t\t\t}\n\t\t\tthis.set(\n\t\t\t\tresources[ parsed[ 0 ] ] || \"\",\n\t\t\t\tparsed[ 1 ],\n\t\t\t\tparsed[ 2 ],\n\t\t\t\tresources[ parsed[ 3 ] ] || \"auto\",\n\t\t\t\tparsed[ 4 ],\n\t\t\t\tparsed[ 5 ],\n\t\t\t\tparsed[ 8 ],\n\t\t\t\tparsed[ 11 ],\n\t\t\t\t( parsed[ 13 ] !== 0 )\n\t\t\t);\n\t\t\tthis.align.deserialize( parsed[ 6 ], manager );\n\t\t\tthis.offset.deserialize( parsed[ 7 ], manager );\n\t\t\tthis.outline.deserialize( parsed[ 9 ], manager );\n\t\t\tthis.spacing.deserialize( parsed[ 10 ], manager );\n\t\t\tthis.padding.deserialize( parsed[ 12 ], manager );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, ObservablePoint } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeFillImpl } from \"./e-shape-fill-impl\";\nimport { EShapeStrokeImpl } from \"./e-shape-stroke-impl\";\nimport { EShapeTagImpl } from \"./e-shape-tag-impl\";\nimport { EShapeTextImpl } from \"./e-shape-text-impl\";\n\nexport abstract class EShapePrimitive extends EShapeBase {\n\treadonly size: IPoint;\n\treadonly fill: EShapeFill;\n\treadonly stroke: EShapeStroke;\n\tprotected _radius: number;\n\tprotected _corner: EShapeCorner;\n\tprotected _image?: HTMLImageElement;\n\tgradient?: EShapeGradientLike;\n\treadonly text: EShapeText;\n\treadonly tag: EShapeTag;\n\tcursor: string;\n\n\tconstructor( type: EShapeType ) {\n\t\tsuper( type );\n\t\tthis.size = this.newSize();\n\t\tthis.fill = this.newFill();\n\t\tthis.stroke = this.newStroke();\n\t\tthis._radius = EShapeDefaults.RADIUS;\n\t\tthis._corner = EShapeCorner.ALL;\n\t\tthis.tag = new EShapeTagImpl();\n\t\tthis.text = this.newText();\n\t\tthis.cursor = EShapeDefaults.CURSOR;\n\t}\n\n\tprotected newSize(): IPoint {\n\t\treturn new ObservablePoint(\n\t\t\t() => { this.onSizeChange(); },\n\t\t\tundefined,\n\t\t\tEShapeDefaults.SIZE_X,\n\t\t\tEShapeDefaults.SIZE_Y\n\t\t);\n\t}\n\n\tprotected newFill(): EShapeFill {\n\t\treturn new EShapeFillImpl(\n\t\t\tthis, true,\n\t\t\tEShapeDefaults.FILL_COLOR,\n\t\t\tEShapeDefaults.FILL_ALPHA\n\t\t);\n\t}\n\n\tprotected newStroke(): EShapeStroke {\n\t\treturn new EShapeStrokeImpl(\n\t\t\tthis, true,\n\t\t\tEShapeDefaults.STROKE_COLOR,\n\t\t\tEShapeDefaults.STROKE_ALPHA,\n\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\tEShapeDefaults.STROKE_ALIGN,\n\t\t\tEShapeDefaults.STROKE_SIDE\n\t\t);\n\t}\n\n\tprotected newText(): EShapeText {\n\t\treturn new EShapeTextImpl(\n\t\t\tthis,\n\t\t\tEShapeDefaults.TEXT_VALUE,\n\t\t\tEShapeDefaults.STROKE_COLOR,\n\t\t\tEShapeDefaults.STROKE_ALPHA,\n\t\t\tEShapeDefaults.TEXT_FAMILY,\n\t\t\tEShapeDefaults.TEXT_SIZE\n\t\t);\n\t}\n\n\tabstract clone(): EShape;\n\n\tget corner(): number {\n\t\treturn this._corner;\n\t}\n\n\tset corner( corner: number ) {\n\t\tif( this._corner !== corner ) {\n\t\t\tthis._corner = corner;\n\t\t\tthis.updateUploaded();\n\t\t}\n\t}\n\n\tget radius(): number {\n\t\treturn this._radius;\n\t}\n\n\tset radius( radius: number ) {\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tthis.updateUploaded();\n\t\t}\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\treturn this._image;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\tif( this._image !== image ) {\n\t\t\tif( image != null ) {\n\t\t\t\tthis._image = image;\n\t\t\t\tthis.imageSrc = image.src;\n\t\t\t} else {\n\t\t\t\tthis._image = undefined;\n\t\t\t\tthis.imageSrc = undefined;\n\t\t\t}\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tparent.toDirty();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport {\n\tEShapeLineBasePoints, EShapeLineBasePointsHitTester, EShapeLineBasePointsTestRange,\n\tEShapeLineBasePointsToHitThreshold\n} from \"./e-shape-line-base-points\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport abstract class EShapeLineBase extends EShapePrimitive {\n\tprotected static WORK_RANGE: [ number, number ] = [ 0, 0 ];\n\tprotected declare _points: EShapeLineBasePoints;\n\tabstract clone(): EShapeLineBase;\n\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem {\n\t\tconst result = super.serialize( manager );\n\t\tresult[ 15 ] = this._points.serialize( manager );\n\t\treturn result;\n\t}\n\n\tprotected getPixelScale(): number {\n\t\tconst container = this.root.parent as any;\n\t\tif( container != null && container.getPixelScale != null ) {\n\t\t\treturn container.getPixelScale();\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tprotected getStrokeWidthScale( points: EShapePoints ): number {\n\t\tconst style = points.style;\n\t\tif( style & EShapePointsStyle.NON_EXPANDING_WIDTH ) {\n\t\t\tif( style & EShapePointsStyle.NON_SHRINKING_WIDTH ) {\n\t\t\t\treturn this.getPixelScale();\n\t\t\t} else {\n\t\t\t\treturn Math.min( 1.0, this.getPixelScale() );\n\t\t\t}\n\t\t} else {\n\t\t\tif( style & EShapePointsStyle.NON_SHRINKING_WIDTH ) {\n\t\t\t\treturn Math.max( 1.0, this.getPixelScale() );\n\t\t\t} else {\n\t\t\t\treturn 1.0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toHitThreshold(\n\t\ttoThreshold: EShapeLineBasePointsToHitThreshold | null\n\t): number {\n\t\tconst stroke = this.stroke;\n\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\tconst strokeScale = this.getStrokeWidthScale( this._points );\n\t\treturn ( toThreshold ?\n\t\t\ttoThreshold( strokeWidth, strokeScale ) :\n\t\t\tstrokeWidth * strokeScale * 0.5\n\t\t);\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst points = this._points;\n\t\tconst threshold = this.toHitThreshold( null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tax, ay,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis.calcHitPointAbsHitTester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoHitThreshold: EShapeLineBasePointsToHitThreshold | null,\n\t\trange: EShapeLineBasePointsTestRange | null,\n\t\ttester: EShapeLineBasePointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst points = this._points;\n\t\tconst threshold = this.toHitThreshold( toHitThreshold );\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\trect.width, rect.height,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected calcHitPointAbsHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tp0x: number, p0y: number,\n\t\tp1x: number, p1y: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: unknown\n\t): boolean {\n\t\t// (x, y) = p0 + (p1 - p0) * t where 0 <= t <= 1\n\t\t// d0 := p1 - p0\n\t\t// d1 := v - p0\n\t\t// (p0.x + d0.x * t - x)^2 + (p0.y + d0.y * t - y)^2\n\t\t// (d0.x t - d1.x)^2 + (d0.y t - d1.y)^2\n\t\t// (d0.x^2 + d0.y^2) t^2 - 2 (d0.x * d1.x + d0.y * d1.y) t + (d1.x^2 + d1.y^2)\n\t\t// a := dot( d0, d0 )\n\t\t// b := dot( d0, d1 )\n\t\t// c := dot( d1, d1 )\n\t\t// a t^2 - 2 b t + c = a (t - b / a)^2 + c - b * b / a\n\t\t// t0 = b / a  min = c - b * b / a\n\t\tconst d0x = p1x - p0x;\n\t\tconst d0y = p1y - p0y;\n\t\tconst d1x = x - p0x;\n\t\tconst d1y = y - p0y;\n\t\tconst a = d0x * d0x + d0y * d0y;\n\t\tconst b = d0x * d1x + d0y * d1y;\n\t\tconst c = d1x * d1x + d1y * d1y;\n\t\tif( 0.0001 < a ) {\n\t\t\tconst t = Math.max( 0, Math.min( 1, b / a ) );\n\t\t\tconst d = a * t * t - 2 * b * t + c;\n\t\t\tif( d < threshold * threshold ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBarPoints } from \"./e-shape-bar-points\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\nimport { EShapeLineBase } from \"./e-shape-line-base\";\n\nexport class EShapeBar extends EShapeLineBase {\n\tprotected declare _points: EShapeBarPoints;\n\n\tconstructor( position: EShapeBarPosition, size?: number, width?: number, style?: EShapePointsStyle ) {\n\t\tsuper( EShapeType.BAR );\n\t\tthis.fill.enable = false;\n\t\tthis.stroke.set( true, undefined, undefined, width );\n\t\tthis._points = new EShapeBarPoints( this, position, size, style );\n\t}\n\n\tget points(): EShapeBarPoints {\n\t\treturn this._points;\n\t}\n\n\tclone(): EShapeBar {\n\t\tconst points = this._points;\n\t\treturn new EShapeBar( points.position, points.size, this.stroke.width, points.style ).copy( this );\n\t}\n\n\tcontainsAbsBBox( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst size = Math.max( 0, this._points.size );\n\t\treturn super.containsAbsBBox( x, y, ax + size, ay + size );\n\t}\n}\n","export const buildColor = (\n\tcolor: number,\n\talpha: number,\n\tvoffset: number,\n\tvcount: number,\n\tcolors: Float32Array\n): void => {\n\tconst r = ((color >> 16) & 0xFF) / 255.0 * alpha;\n\tconst g = ((color >>  8) & 0xFF) / 255.0 * alpha;\n\tconst b = ((color >>  0) & 0xFF) / 255.0 * alpha;\n\tconst a = alpha;\n\n\tlet ic = voffset << 2;\n\tfor( let i = 0; i < vcount; ++i ) {\n\t\tcolors[ ic + 0 ] = r;\n\t\tcolors[ ic + 1 ] = g;\n\t\tcolors[ ic + 2 ] = b;\n\t\tcolors[ ic + 3 ] = a;\n\t\tic += 4;\n\t}\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture, TextureUvs } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeBufferUnitBuilder } from \"./e-shape-buffer-unit-builder\";\nimport { EShapeCorner } from \"./e-shape-corner\";\nimport { buildColor } from \"./variant/build-color\";\n\nexport interface EShapeUploaded {\n\tupdate( shape: EShape ): void;\n\tisCompatible( shape: EShape ): boolean;\n\tgetBuffer(): EShapeBuffer;\n\tgetVertexOffset(): number;\n\tgetVertexCount(): number;\n\tgetIndexOffset(): number;\n\tgetIndexCount(): number;\n\tbuildUnit( builder: EShapeBufferUnitBuilder ): void;\n}\n\nexport abstract class EShapeUploadedBase implements EShapeUploaded {\n\tprotected buffer: EShapeBuffer;\n\n\tprotected transformLocalId: number;\n\n\tprotected vertexOffset: number;\n\tprotected vertexCount: number;\n\tprotected indexOffset: number;\n\tprotected indexCount: number;\n\n\tprotected colorFill: number;\n\tprotected alphaFill: number;\n\tprotected colorStroke: number;\n\tprotected alphaStroke: number;\n\n\tprotected sizeX: number;\n\tprotected sizeY: number;\n\tprotected strokeWidth: number;\n\tprotected strokeAlign: number;\n\tprotected strokeSide: number;\n\tprotected radius: number;\n\tprotected corner: EShapeCorner;\n\n\tprotected texture: Texture | null;\n\tprotected textureTransformId: number;\n\n\tprotected antialiasWeight: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tthis.buffer = buffer;\n\n\t\tthis.transformLocalId = -1;\n\n\t\tthis.vertexOffset = voffset;\n\t\tthis.vertexCount = vcount;\n\t\tthis.indexOffset = ioffset;\n\t\tthis.indexCount = icount;\n\n\t\tthis.colorFill = NaN;\n\t\tthis.alphaFill = -1;\n\t\tthis.colorStroke = NaN;\n\t\tthis.alphaStroke = -1;\n\n\t\tthis.sizeX = NaN;\n\t\tthis.sizeY = NaN;\n\t\tthis.strokeWidth = NaN;\n\t\tthis.strokeAlign = NaN;\n\t\tthis.strokeSide = NaN;\n\t\tthis.radius = NaN;\n\t\tthis.corner = NaN;\n\n\t\tthis.texture = null;\n\t\tthis.textureTransformId = NaN;\n\n\t\tthis.antialiasWeight = antialiasWeight;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tshape.uploaded = this;\n\t\treturn this;\n\t}\n\n\tabstract update( shape: EShape ): void;\n\n\tisCompatible( shape: EShape ): boolean {\n\t\treturn true;\n\t}\n\n\tgetBuffer(): EShapeBuffer {\n\t\treturn this.buffer;\n\t}\n\n\tgetVertexOffset(): number {\n\t\treturn this.vertexOffset;\n\t}\n\n\tgetVertexCount(): number {\n\t\treturn this.vertexCount;\n\t}\n\n\tgetIndexOffset(): number {\n\t\treturn this.indexOffset;\n\t}\n\n\tgetIndexCount(): number {\n\t\treturn this.indexCount;\n\t}\n\n\tprotected toTransformLocalId( shape: EShape ) {\n\t\tshape.updateTransform();\n\t\treturn shape.transform.getLocalId();\n\t}\n\n\tprotected toTexture( shape: EShape ) {\n\t\treturn shape.texture || Texture.WHITE;\n\t}\n\n\tprotected toTextureTransformId( texture: Texture ): number {\n\t\tconst textureAny = texture as any;\n\t\tif( textureAny._uvs == null ) {\n\t\t\ttexture.updateUvs();\n\t\t}\n\t\treturn textureAny._updateID;\n\t}\n\n\tprotected toTextureUvs( texture: Texture ): TextureUvs {\n\t\treturn (texture as any)._uvs;\n\t}\n\n\tprotected updateColorFill( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tconst fill = shape.fill;\n\t\tconst isEnabled = shape.visible && fill.enable;\n\t\tconst color = fill.color;\n\t\tconst alpha = (isEnabled ? fill.alpha : 0);\n\t\tif( color !== this.colorFill || alpha !== this.alphaFill ) {\n\t\t\tthis.colorFill = color;\n\t\t\tthis.alphaFill = alpha;\n\t\t\tbuffer.updateColorFills();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvertexCount,\n\t\t\t\tbuffer.colorFills\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateColorStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tconst stroke = shape.stroke;\n\t\tconst isEnabled = shape.visible && stroke.enable && 0 < stroke.width;\n\t\tconst color = stroke.color;\n\t\tconst alpha = (isEnabled ? stroke.alpha : 0);\n\t\tif( color !== this.colorStroke || alpha !== this.alphaStroke ) {\n\t\t\tthis.colorStroke = color;\n\t\t\tthis.alphaStroke = alpha;\n\t\t\tbuffer.updateColorStrokes();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvertexCount,\n\t\t\t\tbuffer.colorStrokes\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tthis.updateColorFill( buffer, shape, vertexCount );\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tbuildUnit( builder: EShapeBufferUnitBuilder ) {\n\t\tconst texture = this.texture || Texture.WHITE;\n\t\tconst baseTexture = texture.baseTexture;\n\t\tif( baseTexture !== builder.baseTexture ) {\n\t\t\tbuilder.baseTexture = baseTexture;\n\t\t\tconst indexOffset = this.indexOffset;\n\t\t\tbuilder.push( texture, indexOffset );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeBufferUnitBuilder } from \"../e-shape-buffer-unit-builder\";\nimport { EShapeTextAtlas } from \"../e-shape-text\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\nimport { buildColor } from \"./build-color\";\nimport {\n\tbuildTextClipping, buildTextIndex, buildTextStep, buildTextVertex,\n\tTEXT_VERTEX_COUNT, toTextBufferCount\n} from \"./build-text\";\n\nexport abstract class EShapeTextUploaded extends EShapeUploadedBase {\n\tprotected textTexture: Texture | null;\n\tprotected textTextureTransformId: number;\n\tprotected textValue: string;\n\tprotected textFamily: string;\n\tprotected textSize: number;\n\tprotected textColor: number;\n\tprotected textAlpha: number;\n\tprotected textWeight: number;\n\tprotected textStyle: number;\n\tprotected textAlignHorizontal: number;\n\tprotected textAlignVertical: number;\n\tprotected textOffsetHorizontal: number;\n\tprotected textOffsetVertical: number;\n\tprotected textOutlineWidth: number;\n\tprotected textOutlineColor: number;\n\tprotected textOutlineAlpha: number;\n\tprotected textSpacingHorizontal: number;\n\tprotected textSpacingVertical: number;\n\tprotected textDirection: number;\n\tprotected textPaddingHorizontal: number;\n\tprotected textPaddingVertical: number;\n\tprotected textClipping: boolean;\n\tprotected textVertexOffset: number;\n\tprotected textIndexOffset: number;\n\tprotected textVertexCount: number;\n\tprotected textIndexCount: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, vcount, icount, antialiasWeight );\n\n\t\tthis.textSize = NaN;\n\t\tthis.textFamily = \"auto\";\n\t\tthis.textValue = \"\";\n\t\tthis.textTexture = null;\n\t\tthis.textTextureTransformId = NaN;\n\t\tthis.textColor = NaN;\n\t\tthis.textAlpha = NaN;\n\t\tthis.textWeight = NaN;\n\t\tthis.textStyle = NaN;\n\t\tthis.textAlignHorizontal = NaN;\n\t\tthis.textAlignVertical = NaN;\n\t\tthis.textOffsetHorizontal = NaN;\n\t\tthis.textOffsetVertical = NaN;\n\t\tthis.textOutlineWidth = NaN;\n\t\tthis.textOutlineColor = NaN;\n\t\tthis.textOutlineAlpha = NaN;\n\t\tthis.textSpacingHorizontal = NaN;\n\t\tthis.textSpacingVertical = NaN;\n\t\tthis.textDirection = NaN;\n\t\tthis.textPaddingHorizontal = NaN;\n\t\tthis.textPaddingVertical = NaN;\n\t\tthis.textClipping = false;\n\t\tthis.textVertexOffset = this.vertexOffset + this.vertexCount - tvcount;\n\t\tthis.textIndexOffset = this.indexOffset + this.indexCount - ticount;\n\t\tthis.textVertexCount = tvcount;\n\t\tthis.textIndexCount = ticount;\n\t}\n\n\tinitText(): void {\n\t\tconst vcount = this.textVertexCount;\n\t\tif( 0 < vcount ) {\n\t\t\t// Clippings\n\t\t\tconst buffer = this.buffer;\n\t\t\tconst voffset = this.textVertexOffset;\n\t\t\tbuffer.updateClippings();\n\t\t\tbuildTextClipping(\n\t\t\t\tbuffer.clippings,\n\t\t\t\tvoffset,\n\t\t\t\tvcount\n\t\t\t);\n\n\t\t\t// Indices\n\t\t\tbuffer.updateIndices();\n\t\t\tbuildTextIndex(\n\t\t\t\tbuffer.indices,\n\t\t\t\tvoffset,\n\t\t\t\tthis.textIndexOffset,\n\t\t\t\tthis.textIndexCount\n\t\t\t);\n\t\t}\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\treturn ( toTextBufferCount( shape ) * TEXT_VERTEX_COUNT === this.textVertexCount );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateText( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst vcount = this.textVertexCount;\n\t\tif( 0 < vcount ) {\n\t\t\tconst textAtlas = shape.text.atlas;\n\t\t\tif( textAtlas != null ) {\n\t\t\t\tthis.updateTextVertex( buffer, shape, textAtlas );\n\t\t\t\tthis.updateTextColorFill( buffer, shape );\n\t\t\t\tthis.updateTextColorStroke( buffer, shape );\n\t\t\t\tthis.updateTextStep( buffer, shape );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateColor( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst vertexCount = this.vertexCount - this.textVertexCount;\n\t\tthis.updateColorFillAndStroke( buffer, shape, vertexCount );\n\t}\n\n\tprotected updateTextVertex( buffer: EShapeBuffer, shape: EShape, textAtlas: EShapeTextAtlas ) {\n\t\tconst text = shape.text;\n\t\tconst textSize = text.size;\n\t\tconst textFamily = text.family;\n\t\tconst textValue = text.value;\n\t\tconst textStyle = text.style;\n\t\tconst textAlignHorizontal = text.align.horizontal;\n\t\tconst textAlignVertical = text.align.vertical;\n\t\tconst textOffsetHorizontal = text.offset.horizontal;\n\t\tconst textOffsetVertical = text.offset.vertical;\n\t\tconst textSpacingHorizontal = text.spacing.horizontal;\n\t\tconst textSpacingVertical = text.spacing.vertical;\n\t\tconst textDirection = text.direction;\n\t\tconst textPaddingHorizontal = text.padding.horizontal;\n\t\tconst textPaddingVertical = text.padding.vertical;\n\t\tconst textClipping = text.clipping;\n\t\tconst textTexture = text.texture || Texture.WHITE;\n\t\tconst textTextureTransformId = this.toTextureTransformId( textTexture );\n\n\t\tconst isCharChanged = (textValue !== this.textValue || textFamily !== this.textFamily);\n\t\tconst isCharSizeChanged = (textSize !== this.textSize);\n\t\tconst isCharStyleChanged = (textStyle !== this.textStyle);\n\t\tconst isCharAlignChanged = (textAlignHorizontal !== this.textAlignHorizontal ||\n\t\t\ttextAlignVertical !== this.textAlignVertical);\n\t\tconst isCharOffsetChanged = (textOffsetHorizontal !== this.textOffsetHorizontal ||\n\t\t\ttextOffsetVertical !== this.textOffsetVertical);\n\t\tconst isCharSpacingChanged = (textSpacingHorizontal !== this.textSpacingHorizontal ||\n\t\t\ttextSpacingVertical !== this.textSpacingVertical ||\n\t\t\ttextPaddingHorizontal !== this.textPaddingHorizontal ||\n\t\t\ttextPaddingVertical !== this.textPaddingVertical);\n\t\tconst isCharDirectionChanged = (textDirection !== this.textDirection);\n\t\tconst isClippingChanged = ( this.textClipping !== textClipping );\n\t\tconst isTextureChanged = ( textTexture !== this.textTexture ||\n\t\t\ttextTextureTransformId !== this.textTextureTransformId );\n\n\t\tif( isCharChanged || isCharSizeChanged || isCharStyleChanged ||\n\t\t\tisCharAlignChanged || isCharOffsetChanged || isCharSpacingChanged ||\n\t\t\tisCharDirectionChanged || isClippingChanged || isTextureChanged ) {\n\t\t\tthis.textSize = textSize;\n\t\t\tthis.textFamily = textFamily;\n\t\t\tthis.textValue = textValue;\n\t\t\tthis.textStyle = textStyle;\n\t\t\tthis.textAlignHorizontal = textAlignHorizontal;\n\t\t\tthis.textAlignVertical = textAlignVertical;\n\t\t\tthis.textOffsetHorizontal = textOffsetHorizontal;\n\t\t\tthis.textOffsetVertical = textOffsetVertical;\n\t\t\tthis.textSpacingHorizontal = textSpacingHorizontal;\n\t\t\tthis.textSpacingVertical = textSpacingVertical;\n\t\t\tthis.textDirection = textDirection;\n\t\t\tthis.textPaddingHorizontal = textPaddingHorizontal;\n\t\t\tthis.textPaddingVertical = textPaddingVertical;\n\t\t\tthis.textClipping = textClipping;\n\t\t\tthis.textTexture = textTexture;\n\t\t\tthis.textTextureTransformId = textTextureTransformId;\n\n\t\t\tif( isCharSizeChanged ) {\n\t\t\t\t// Invalidate the text weight to update the text steps.\n\t\t\t\tthis.textWeight = NaN;\n\t\t\t}\n\n\t\t\t// Vertices & UVs\n\t\t\tbuffer.updateVertices();\n\t\t\tbuffer.updateUvs();\n\t\t\tconst shapeSize = shape.size;\n\t\t\tlet textWorld = text.world;\n\t\t\tif( textWorld == null ) {\n\t\t\t\ttextWorld = [ 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0, 0.0 ];\n\t\t\t\ttext.world = textWorld;\n\t\t\t}\n\t\t\tbuildTextVertex(\n\t\t\t\tbuffer.vertices,\n\t\t\t\tbuffer.uvs,\n\t\t\t\tthis.textVertexOffset,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tshapeSize.x,\n\t\t\t\tshapeSize.y,\n\t\t\t\ttextAtlas,\n\t\t\t\ttextSize,\n\t\t\t\ttextValue,\n\t\t\t\ttextStyle,\n\t\t\t\ttextAlignHorizontal,\n\t\t\t\ttextAlignVertical,\n\t\t\t\ttextOffsetHorizontal,\n\t\t\t\ttextOffsetVertical,\n\t\t\t\ttextSpacingHorizontal,\n\t\t\t\ttextSpacingVertical,\n\t\t\t\ttextDirection,\n\t\t\t\ttextPaddingHorizontal,\n\t\t\t\ttextPaddingVertical,\n\t\t\t\ttextClipping,\n\t\t\t\ttextWorld,\n\t\t\t\tthis.toTextureUvs( textTexture ),\n\t\t\t\tshape.transform.internalTransform\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextColorFill( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst color = text.color;\n\t\tconst alpha = ( shape.visible && text.enable ? text.alpha : 0 );\n\t\tif( color !== this.textColor || alpha !== this.textAlpha ) {\n\t\t\tthis.textColor = color;\n\t\t\tthis.textAlpha = alpha;\n\t\t\tbuffer.updateColorFills();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.textVertexOffset,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\tbuffer.colorFills\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextColorStroke( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst outline = text.outline;\n\t\tconst color = outline.color;\n\t\tconst alpha = ( shape.visible && text.enable ? outline.alpha : 0 );\n\t\tif( color !== this.textOutlineColor || alpha !== this.textOutlineAlpha ) {\n\t\t\tthis.textOutlineColor = color;\n\t\t\tthis.textOutlineAlpha = alpha;\n\t\t\tbuffer.updateColorStrokes();\n\n\t\t\tbuildColor(\n\t\t\t\tcolor, alpha,\n\t\t\t\tthis.textVertexOffset,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\tbuffer.colorStrokes\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextStep( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst text = shape.text;\n\t\tconst textOutline = text.outline;\n\t\tconst textOutlineWidth = (textOutline.enable ? textOutline.width : 0);\n\t\tconst textWeight = text.weight;\n\t\tif( textWeight !== this.textWeight || textOutlineWidth !== this.textOutlineWidth ) {\n\t\t\tthis.textWeight = textWeight;\n\t\t\tthis.textOutlineWidth = textOutlineWidth;\n\n\t\t\tbuffer.updateSteps();\n\t\t\tbuildTextStep(\n\t\t\t\tbuffer.steps,\n\t\t\t\tthis.textVertexOffset,\n\t\t\t\tthis.textVertexCount,\n\t\t\t\ttext.atlas,\n\t\t\t\ttext.size,\n\t\t\t\ttextOutlineWidth,\n\t\t\t\ttextWeight,\n\t\t\t\tthis.antialiasWeight\n\t\t\t);\n\t\t}\n\t}\n\n\tbuildUnit( builder: EShapeBufferUnitBuilder ) {\n\t\tsuper.buildUnit( builder );\n\n\t\tif( 0 < this.textVertexCount ) {\n\t\t\tconst textTexture = this.textTexture || Texture.WHITE;\n\t\t\tconst textBaseTexture = textTexture.baseTexture;\n\t\t\tif( textBaseTexture !== builder.baseTexture ) {\n\t\t\t\tbuilder.baseTexture = textBaseTexture;\n\t\t\t\tbuilder.push( textTexture, this.textIndexOffset );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { buildBarClipping, buildBarIndex, buildBarUv, buildBarVertexStepAndColorFill } from \"./build-bar\";\nimport { EShapeBar } from \"./e-shape-bar\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeBarUploaded extends EShapeTextUploaded {\n\tprotected pointsId: number;\n\tprotected pointsStyle: EShapePointsStyle;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount, antialiasWeight );\n\t\tthis.pointsId = NaN;\n\t\tthis.pointsStyle = EShapePointsStyle.NONE;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clipping & indices\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tbuffer.updateClippings();\n\t\tbuffer.updateIndices();\n\t\tbuildBarClipping(\n\t\t\tbuffer.clippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildBarIndex(\n\t\t\tbuffer.indices,\n\t\t\tvoffset,\n\t\t\tioffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\t//\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexStepAndColorFill( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexStepAndColorFill( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tif( shape instanceof EShapeBar ) {\n\t\t\tconst size = shape.size;\n\t\t\tconst sizeX = size.x;\n\t\t\tconst sizeY = size.y;\n\t\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\t\tconst stroke = shape.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tconst isStrokeWidthChanged = ( strokeWidth !== this.strokeWidth );\n\n\t\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\t\tconst points = shape.points;\n\t\t\tconst pointsId = points.id;\n\t\t\tconst isPointsIdChanged = ( pointsId !== this.pointsId );\n\n\t\t\tconst pointsStyle = points.style;\n\t\t\tconst isPointsStyleChanged = ( pointsStyle !== this.pointsStyle );\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeWidthChanged || isPointsIdChanged || isPointsStyleChanged ) {\n\t\t\t\tthis.sizeX = sizeX;\n\t\t\t\tthis.sizeY = sizeY;\n\t\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\t\tthis.pointsId = pointsId;\n\t\t\t\tthis.pointsStyle = pointsStyle;\n\n\t\t\t\tif( isSizeChanged || isTransformChanged ) {\n\t\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t\t}\n\t\t\t\tif( isPointsIdChanged ) {\n\t\t\t\t\t// Invalidate the texture transform ID to update the UVs\n\t\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t\t}\n\n\t\t\t\tbuffer.updateVertices();\n\t\t\t\tbuffer.updateSteps();\n\t\t\t\tbuffer.updateColorFills();\n\t\t\t\tbuildBarVertexStepAndColorFill(\n\t\t\t\t\tbuffer.vertices,\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tbuffer.colorFills,\n\t\t\t\t\tthis.vertexOffset,\n\t\t\t\t\tpoints.values,\n\t\t\t\t\tpointsStyle,\n\t\t\t\t\tpoints.size,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.transform.internalTransform\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ): void {\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tprotected updateUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuildBarUv(\n\t\t\t\tbuffer.uvs,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tthis.toTextureUvs( texture )\n\t\t\t);\n\t\t}\n\t}\n}\n","import { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { BAR_INDEX_COUNT, BAR_VERTEX_COUNT } from \"./build-bar\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { EShapeBarUploaded } from \"./e-shape-bar-uploaded\";\n\nexport const createBarUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeBarUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = BAR_VERTEX_COUNT + tvcount;\n\tconst icount = BAR_INDEX_COUNT + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeBarUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isArray = Array.isArray || (( target: any ): target is unknown[] => {\n\treturn Object.prototype.toString.call( target ) === \"[object Array]\";\n});\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isNumber = ( target: unknown ): target is number => {\n\treturn ( typeof target === \"number\" ) ||\n\t\t( Object.prototype.toString.call( target ) === \"[object Number]\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationLayerLike } from \"../d-application-layer-like\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { isString } from \"./is-string\";\n\nexport interface UtilKeyboardEventLayerPicker {\n\tpicked: DApplicationLayerLike | null;\n}\n\nexport interface UtilKeyboardEventShortcut {\n\talt: boolean;\n\tctrl: boolean;\n\tshift: boolean;\n\tkey: string;\n\twhich: number;\n\tevent?: string;\n}\n\nconst setShortcutKeyAndWhich = ( shortcut: UtilKeyboardEventShortcut ): UtilKeyboardEventShortcut => {\n\tconst key = shortcut.key;\n\tif( key.length <= 1 ) {\n\t\tif( shortcut.shift ) {\n\t\t\tshortcut.key = key.toUpperCase();\n\t\t}\n\t\tconst code = key.charCodeAt( 0 );\n\t\tif( 97 <= code && code <= 122 ) {\n\t\t\t// a ... z\n\t\t\tshortcut.which = code - 32;\n\t\t} else {\n\t\t\tshortcut.which = code;\n\t\t}\n\t} else {\n\t\tswitch( key ) {\n\t\tcase \"Enter\":\n\t\t\tshortcut.which = 13;\n\t\t\tbreak;\n\t\tcase \"Space\":\n\t\t\tshortcut.key = \" \";\n\t\t\tshortcut.which = 32;\n\t\t\tbreak;\n\t\tcase \"Escape\":\n\t\t\tshortcut.which = 27;\n\t\t\tbreak;\n\t\tcase \"F1\":\n\t\t\tshortcut.which = 112;\n\t\t\tbreak;\n\t\tcase \"F2\":\n\t\t\tshortcut.which = 113;\n\t\t\tbreak;\n\t\tcase \"F3\":\n\t\t\tshortcut.which = 114;\n\t\t\tbreak;\n\t\tcase \"F4\":\n\t\t\tshortcut.which = 115;\n\t\t\tbreak;\n\t\tcase \"F5\":\n\t\t\tshortcut.which = 116;\n\t\t\tbreak;\n\t\tcase \"F6\":\n\t\t\tshortcut.which = 117;\n\t\t\tbreak;\n\t\tcase \"F7\":\n\t\t\tshortcut.which = 118;\n\t\t\tbreak;\n\t\tcase \"F8\":\n\t\t\tshortcut.which = 119;\n\t\t\tbreak;\n\t\tcase \"F9\":\n\t\t\tshortcut.which = 120;\n\t\t\tbreak;\n\t\tcase \"F10\":\n\t\t\tshortcut.which = 121;\n\t\t\tbreak;\n\t\tcase \"F11\":\n\t\t\tshortcut.which = 122;\n\t\t\tbreak;\n\t\tcase \"F12\":\n\t\t\tshortcut.which = 123;\n\t\t\tbreak;\n\t\tcase \"CapsLock\":\n\t\t\tif( shortcut.shift ) {\n\t\t\t\tshortcut.which = 20;\n\t\t\t} else {\n\t\t\t\tshortcut.which = 240;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase \"ArrowUp\":\n\t\t\tshortcut.which = 38;\n\t\t\tbreak;\n\t\tcase \"ArrowDown\":\n\t\t\tshortcut.which = 40;\n\t\t\tbreak;\n\t\tcase \"ArrowLeft\":\n\t\t\tshortcut.which = 37;\n\t\t\tbreak;\n\t\tcase \"ArrowRight\":\n\t\t\tshortcut.which = 39;\n\t\t\tbreak;\n\t\tcase \"Insert\":\n\t\t\tshortcut.which = 45;\n\t\t\tbreak;\n\t\tcase \"Delete\":\n\t\t\tshortcut.which = 46;\n\t\t\tbreak;\n\t\tcase \"PageUp\":\n\t\t\tshortcut.which = 33;\n\t\t\tbreak;\n\t\tcase \"PageDown\":\n\t\t\tshortcut.which = 34;\n\t\t\tbreak;\n\t\tcase \"Backspace\":\n\t\t\tshortcut.which = 8;\n\t\t\tbreak;\n\t\tcase \";\":\n\t\t\tshortcut.which = 187;\n\t\t\tbreak;\n\t\tcase \"Pause\":\n\t\t\tshortcut.which = 19;\n\t\t\tbreak;\n\t\tcase \"ScrollLock\":\n\t\t\tshortcut.which = 145;\n\t\t\tbreak;\n\t\tcase \"Tab\":\n\t\t\tshortcut.which = 9;\n\t\t\tbreak;\n\t\t}\n\t}\n\treturn shortcut;\n};\n\nexport class UtilKeyboardEvent {\n\tstatic isActivateKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Space\" || e.key === \"Enter\" || e.which === 32 || e.which === 13 );\n\t}\n\n\tstatic isArrowUpKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowUp\" || e.which === 38 );\n\t}\n\n\tstatic isArrowDownKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowDown\" || e.which === 40 );\n\t}\n\n\tstatic isArrowLeftKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowLeft\" || e.which === 37 );\n\t}\n\n\tstatic isArrowRightKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"ArrowRight\" || e.which === 39 );\n\t}\n\n\tstatic isCancelKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Esc\" || e.which === 27 );\n\t}\n\n\tstatic isFocusKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Tab\" || e.which === 9 );\n\t}\n\n\tstatic isUndoKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ( e.key === \"z\" || e.which === 90 ) );\n\t}\n\n\tstatic isRedoKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ( e.key === \"y\" || e.which === 89 ) );\n\t}\n\n\tstatic isSaveKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ! e.shiftKey && ( e.key === \"s\" || e.which === 83 ) );\n\t}\n\n\tstatic isSaveAsKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && e.shiftKey && ( e.key === \"S\" || e.which === 83 ) );\n\t}\n\n\tstatic isDeleteKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Delete\" || e.which === 46 );\n\t}\n\n\tstatic isSelectAllKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.ctrlKey && ! e.shiftKey && ( e.key === \"a\" || e.which === 65 ) );\n\t}\n\n\tstatic isOkKey( e: KeyboardEvent ): boolean {\n\t\treturn ( e.key === \"Enter\" || e.which === 13 );\n\t}\n\n\tstatic getFocusDirection( e: KeyboardEvent ): boolean {\n\t\treturn ( e.shiftKey !== true );\n\t}\n\n\tstatic toShortcut( expressionOrShortcut: string | UtilKeyboardEventShortcut ): UtilKeyboardEventShortcut {\n\t\tif( ! isString( expressionOrShortcut ) ) {\n\t\t\treturn expressionOrShortcut;\n\t\t} else {\n\t\t\tconst expression = expressionOrShortcut;\n\t\t\tconst arrowIndex = expression.indexOf(\"->\");\n\t\t\tlet keyExpression: string;\n\t\t\tlet event: string | undefined;\n\t\t\tif( 0 <= arrowIndex ) {\n\t\t\t\tkeyExpression = expression.substring( 0, arrowIndex ).trim();\n\t\t\t\tevent = expression.substring( arrowIndex + 2 ).trim();\n\t\t\t} else {\n\t\t\t\tkeyExpression = expression.trim();\n\t\t\t}\n\t\t\tconst keys = keyExpression.toLowerCase().split( \"+\" );\n\t\t\tconst alt: boolean = 0 <= keys.indexOf( \"alt\" );\n\t\t\tconst ctrl: boolean = 0 <= keys.indexOf( \"ctrl\" );\n\t\t\tconst shift: boolean = 0 <= keys.indexOf( \"shift\" );\n\t\t\tconst key: string = keys[ keys.length - 1 ];\n\t\t\treturn setShortcutKeyAndWhich({\n\t\t\t\talt,\n\t\t\t\tctrl,\n\t\t\t\tshift,\n\t\t\t\tkey,\n\t\t\t\twhich: 0,\n\t\t\t\tevent\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic toString( shortcut: UtilKeyboardEventShortcut ): string {\n\t\tconst parts = [];\n\t\tif( shortcut.ctrl ) {\n\t\t\tparts.push( \"Ctrl\" );\n\t\t}\n\t\tif( shortcut.shift ) {\n\t\t\tparts.push( \"Shift\" );\n\t\t}\n\t\tif( shortcut.alt ) {\n\t\t\tparts.push( \"Alt\" );\n\t\t}\n\t\tparts.push( shortcut.key.toUpperCase() );\n\t\treturn parts.join( \"+\" );\n\t}\n\n\tstatic on(\n\t\ttarget: DBase<any, any>,\n\t\texpressionOrShortcut: string | UtilKeyboardEventShortcut,\n\t\thandler?: ( e: KeyboardEvent ) => void\n\t): void {\n\t\tconst shortcut = this.toShortcut( expressionOrShortcut );\n\t\tdocument.body.addEventListener( \"keydown\", ( e: KeyboardEvent ): void => {\n\t\t\tif(\n\t\t\t\te.altKey === shortcut.alt && e.ctrlKey === shortcut.ctrl &&\n\t\t\t\te.shiftKey === shortcut.shift &&\n\t\t\t\t( e.key === shortcut.key || e.which === shortcut.which )\n\t\t\t) {\n\t\t\t\tif( target.state.isActionable ) {\n\t\t\t\t\tif( shortcut.event != null ) {\n\t\t\t\t\t\ttarget.emit( shortcut.event );\n\t\t\t\t\t} else if( handler != null ) {\n\t\t\t\t\t\thandler( e );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic moveFocusVertically( e: KeyboardEvent, target: DBase, picker?: UtilKeyboardEventLayerPicker ): boolean {\n\t\tif( target.state.isActionable ) {\n\t\t\tconst isBackward = UtilKeyboardEvent.isArrowUpKey( e );\n\t\t\tconst isForward = UtilKeyboardEvent.isArrowDownKey( e );\n\t\t\tif( isBackward || isForward ) {\n\t\t\t\treturn this.moveFocus( isForward, target, picker );\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic moveFocusHorizontally( e: KeyboardEvent, target: DBase, picker?: UtilKeyboardEventLayerPicker ) {\n\t\tif( target.state.isActionable ) {\n\t\t\tconst isBackward = UtilKeyboardEvent.isArrowLeftKey( e );\n\t\t\tconst isForward = UtilKeyboardEvent.isArrowRightKey( e );\n\t\t\tif( isBackward || isForward ) {\n\t\t\t\treturn this.moveFocus( isForward, target, picker );\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic moveFocus( direction: boolean, target: DBase, picker?: UtilKeyboardEventLayerPicker ): boolean {\n\t\tconst layer = ( picker?.picked ?? DApplications.getLayer( target ) );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tconst focused = focusController.get();\n\t\t\tif( focused != null ) {\n\t\t\t\tconst next = focusController.find(\n\t\t\t\t\tfocused, false, focused.state.isFocusRoot || direction, direction, target\n\t\t\t\t);\n\t\t\t\tif( next != null ) {\n\t\t\t\t\tfocusController.focus( next );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueBlinkType {\n\tVISIBILITY,\n\tBRIGHTEN,\n\tDARKEN,\n\tOPACITY,\n\tCOLOR_FILL,\n\tCOLOR_STROKE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeTextLike } from \"../e-shape-text\";\nimport { EShapeTextOutlineLike } from \"../e-shape-text-outline\";\n\nexport class EShapeActionBases {\n\tstatic toBaseFill( shape: EShape, runtime: EShapeRuntime ): EShapeFillLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_FILL ? shape : runtime ).fill;\n\t}\n\n\tstatic toBaseStroke( shape: EShape, runtime: EShapeRuntime ): EShapeStrokeLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_STROKE ? shape : runtime ).stroke;\n\t}\n\n\tstatic toBaseText( shape: EShape, runtime: EShapeRuntime ): EShapeTextLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_TEXT ? shape : runtime ).text;\n\t}\n\n\tstatic toBaseTextOutline( shape: EShape, runtime: EShapeRuntime ): EShapeTextOutlineLike {\n\t\treturn ( runtime.written & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ? shape : runtime ).text.outline;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeActionExpression, EShapeActionExpressionWithParameter } from \"./e-shape-action-expression\";\n\nexport class EShapeActionExpressions {\n\tstatic NULL = () => null;\n\tstatic ZERO = () => 0;\n\tstatic ONE = () => 1;\n\tstatic ONE_HUNDRED = () => 100;\n\tstatic EMPTY = () => \"\";\n\tstatic TRUE = () => true;\n\tstatic FALSE = () => false;\n\n\tstatic from<T, DEF>(\n\t\texpression: string, caster: string, def: DEF,\n\t\tdefLiteral: string, nullable: boolean\n\t): EShapeActionExpression<T> | DEF;\n\tstatic from<T, P, DEF>(\n\t\texpression: string, caster: string, def: DEF,\n\t\tdefLiteral: string, nullable: boolean, parameter: string\n\t): EShapeActionExpressionWithParameter<T, P> | DEF;\n\tstatic from<T, P>(\n\t\texpression: string, caster: string, def: EShapeActionExpression<T> | EShapeActionExpressionWithParameter<T, P> | undefined,\n\t\tdefLiteral: string, nullable: boolean, parameter?: string\n\t): EShapeActionExpression<T> | EShapeActionExpressionWithParameter<T, P> | undefined {\n\t\tif( expression.trim().length <= 0 ) {\n\t\t\treturn def;\n\t\t}\n\n\t\ttry {\n\t\t\tconst body = `` +\n\t\t\t\t`try{` +\n\t\t\t\t\t`with( shape ) {` +\n\t\t\t\t\t\t`with( state ) {` +\n\t\t\t\t\t\t\t( nullable ?\n\t\t\t\t\t\t\t\t(\n\t\t\t\t\t\t\t\t\t`var result = (${expression});` +\n\t\t\t\t\t\t\t\t\t`return (result != null ? ${caster}(result) : null);`\n\t\t\t\t\t\t\t\t) :\n\t\t\t\t\t\t\t\t`return ${caster}(${expression});`\n\t\t\t\t\t\t\t) +\n\t\t\t\t\t\t`}` +\n\t\t\t\t\t`}` +\n\t\t\t\t`} catch( e ) {` +\n\t\t\t\t\t`return ${defLiteral};` +\n\t\t\t\t`}`;\n\t\t\tif( parameter == null ) {\n\t\t\t\treturn Function(\n\t\t\t\t\t\"shape\", \"time\", body\n\t\t\t\t) as EShapeActionExpression<T>;\n\t\t\t} else {\n\t\t\t\treturn Function(\n\t\t\t\t\t\"shape\", \"time\", parameter, body\n\t\t\t\t) as EShapeActionExpressionWithParameter<T, P>;\n\t\t\t}\n\t\t} catch( e ) {\n\t\t\treturn def;\n\t\t}\n\t}\n\n\tstatic ofNumberOrNull( expression: string ): EShapeActionExpression<number | null> {\n\t\treturn this.from( expression, \"Number\", this.NULL, \"null\", true );\n\t}\n\n\tstatic ofStringOrNull( expression: string ): EShapeActionExpression<string | null> {\n\t\treturn this.from( expression, \"String\", this.NULL, \"null\", true );\n\t}\n\n\tstatic ofUnknown( expression: string ): EShapeActionExpression<unknown> {\n\t\treturn this.from( expression, \"\", this.NULL, \"null\", false );\n\t}\n\n\tstatic ofNumber( expression: string ): EShapeActionExpression<number> {\n\t\treturn this.from( expression, \"Number\", this.ZERO, \"0\", false );\n\t}\n\n\tstatic ofNumberOrOne( expression: string ): EShapeActionExpression<number> {\n\t\treturn this.from( expression, \"Number\", this.ONE, \"1\", false );\n\t}\n\n\tstatic ofNumberOrOneHundred( expression: string ): EShapeActionExpression<number> {\n\t\treturn this.from( expression, \"Number\", this.ONE_HUNDRED, \"100\", false );\n\t}\n\n\tstatic ofString( expression: string ): EShapeActionExpression<string> {\n\t\treturn this.from( expression, \"String\", this.EMPTY, \"\\\"\\\"\", false );\n\t}\n\n\tstatic ofBoolean( expression: string ): EShapeActionExpression<boolean> {\n\t\treturn this.from( expression, \"Boolean\", this.TRUE, \"true\", false );\n\t}\n\n\tstatic ofBooleanOrTrue( expression: string ): EShapeActionExpression<boolean> {\n\t\treturn this.from( expression, \"Boolean\", this.TRUE, \"true\", false );\n\t}\n\n\tstatic ofBooleanOrFalse( expression: string ): EShapeActionExpression<boolean> {\n\t\treturn this.from( expression, \"Boolean\", this.FALSE, \"false\", false );\n\t}\n\n\tstatic ofElementOrNull<ELEMENT extends HTMLElement>( expression: string ): EShapeActionExpressionWithParameter<ELEMENT | null, HTMLElement> | undefined {\n\t\treturn this.from( expression, \"\", undefined, \"null\", false, \"container\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Renderer } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\n\n/**\n * An action runtime.\n * Please note that all the action runtimes are shared across shapes.\n */\nexport class EShapeActionRuntime {\n\treset: EShapeRuntimeReset;\n\n\tconstructor( reset?: EShapeRuntimeReset ) {\n\t\tthis.reset = reset || EShapeRuntimeReset.NONE;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\t// OVERRIDE THIS\n\t}\n\n\tonFocus( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t// DO NOTHING\n\t}\n\n\tonBlur( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t// DO NOTHING\n\t}\n\n\tonDownThisBefore( shape: EShape, runtime: EShapeRuntime, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\t// DO NOTHING\n\t}\n\n\tonDownThisAfter( shape: EShape, runtime: EShapeRuntime, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\t// DO NOTHING\n\t}\n\n\tonDblClick( shape: EShape, runtime: EShapeRuntime, e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): void {\n\t\t// DO NOTHING\n\t}\n\n\tonRender( shape: EShape, runtime: EShapeRuntime, time: number, renderer: Renderer ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\n\nexport class EShapeActionRuntimeConditional extends EShapeActionRuntime {\n\tprotected readonly condition: EShapeActionExpression<boolean>;\n\n\tconstructor( value: EShapeActionValue, reset: EShapeRuntimeReset ) {\n\t\tsuper( reset );\n\t\tthis.condition = EShapeActionExpressions.ofBoolean( value.condition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlink extends EShapeActionRuntimeConditional {\n\tprotected interval: number;\n\n\tconstructor( value: EShapeActionValueBlink, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.interval = value.interval;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst interval = this.interval;\n\t\t\tconst dinterval = ( interval << 1 );\n\t\t\tconst elapsed = ( time % dinterval );\n\t\t\tif( elapsed < interval ) {\n\t\t\t\tthis.toOff( shape, runtime );\n\t\t\t\truntime.effect = time + ( interval - elapsed );\n\t\t\t} else {\n\t\t\t\tthis.toOn( shape, runtime );\n\t\t\t\truntime.effect = time + ( dinterval - elapsed );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t//\n\t}\n\n\tprotected toOff( shape: EShape, runtime: EShapeRuntime ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkBrighten extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( fill.color, 0.5 ),\n\t\t\tfill.alpha\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( stroke.color, 0.5 ),\n\t\t\tstroke.alpha\n\t\t);\n\n\t\tconst text = EShapeActionBases.toBaseText( shape, runtime );\n\t\tshape.text.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( text.color, 0.5 ),\n\t\t\ttext.alpha\n\t\t);\n\n\t\tconst outline = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\tshape.text.outline.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.brighten( outline.color, 0.5 ),\n\t\t\toutline.alpha\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkColorFill extends EShapeActionRuntimeBlink {\n\tprotected color: number;\n\tprotected alpha: number;\n\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL );\n\t\tthis.color = value.color;\n\t\tthis.alpha = value.alpha;\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.fill.set( undefined, this.color, this.alpha );\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkColorStroke extends EShapeActionRuntimeBlink {\n\tprotected color: number;\n\tprotected alpha: number;\n\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_STROKE );\n\t\tthis.color = value.color;\n\t\tthis.alpha = value.alpha;\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.stroke.set( undefined, this.color, this.alpha );\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkDarken extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( fill.color, 0.5 ),\n\t\t\tfill.alpha\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( stroke.color, 0.5 ),\n\t\t\tstroke.alpha\n\t\t);\n\n\t\tconst text = EShapeActionBases.toBaseText( shape, runtime );\n\t\tshape.text.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( text.color, 0.5 ),\n\t\t\ttext.alpha\n\t\t);\n\n\t\tconst outline = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\tshape.text.outline.set(\n\t\t\tundefined,\n\t\t\tUtilRgb.darken( outline.color, 0.5 ),\n\t\t\toutline.alpha\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkOpacity extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.COLOR_FILL_AND_STROKE );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tconst fill = EShapeActionBases.toBaseFill( shape, runtime );\n\t\tshape.fill.set(\n\t\t\tundefined,\n\t\t\tfill.color,\n\t\t\tfill.alpha * 0.5\n\t\t);\n\n\t\tconst stroke = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\tshape.stroke.set(\n\t\t\tundefined,\n\t\t\tstroke.color,\n\t\t\tstroke.alpha * 0.5\n\t\t);\n\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionValueBlink } from \"./e-shape-action-value-blink\";\n\nexport class EShapeActionRuntimeBlinkVisibility extends EShapeActionRuntimeBlink {\n\tconstructor( value: EShapeActionValueBlink ) {\n\t\tsuper( value, EShapeRuntimeReset.VISIBILITY );\n\t}\n\n\tprotected toOn( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.visible = true;\n\t\truntime.written |= this.reset;\n\t}\n\n\tprotected toOff( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tshape.visible = false;\n\t\truntime.written |= this.reset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemes } from \"../../theme/d-themes\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionValue, EThemeShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueBase implements EShapeActionValue {\n\treadonly type: EShapeActionValueType;\n\treadonly condition: string;\n\n\tconstructor( type: EShapeActionValueType, condition: string ) {\n\t\tthis.type = type;\n\t\tthis.condition = condition;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tthis.type === value.type &&\n\t\t\tthis.condition === value.condition\n\t\t);\n\t}\n\n\ttoLabel(): string {\n\t\treturn DThemes.getInstance().get<EThemeShapeActionValue>( \"EShapeActionValue\" ).toLabel( this );\n\t}\n\n\tabstract toRuntime(): EShapeActionRuntime;\n\tabstract serialize( manager: EShapeResourceManagerSerialization ): number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueType {\n\tSHOW_HIDE = 0,\n\tBLINK = 1,\n\tTRANSFORM = 2,\n\tOPEN = 3,\n\tEMIT_EVENT = 4, // Deprecated in favor of EShapeActionValueMiscType.EMIT_EVENT\n\tCHANGE_COLOR_LEGACY = 5, // Deprecated in favor of EShapeActionValueType.CHANGE_COLOR\n\tCHANGE_TEXT = 6,\n\tCHANGE_CURSOR = 7,\n\tMISC = 8,\n\tCHANGE_COLOR = 9\n}\n","import { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueSubtyped<SUBTYPE extends number> extends EShapeActionValueBase {\n\treadonly subtype: SUBTYPE;\n\n\tconstructor( type: EShapeActionValueType, condition: string, subtype: SUBTYPE ) {\n\t\tsuper( type, condition );\n\t\tthis.subtype = subtype;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueSubtyped) &&\n\t\t\tthis.subtype === value.subtype\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isNumber } from \"../../util/is-number\";\n\nexport class EShapeActionValues {\n\tstatic toResource( index: number, parsed: number[], resources: string[] ): string {\n\t\tif( 0 <= index && index < parsed.length ) {\n\t\t\tconst id = parsed[ index ];\n\t\t\tif( isNumber( id ) && 0 <= id && id < resources.length ) {\n\t\t\t\treturn resources[ id ];\n\t\t\t}\n\t\t}\n\t\treturn \"\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeColorTarget {\n\tCOLOR_AND_ALPHA,\n\tCOLOR,\n\tALPHA,\n\tCODE,\n\tBRIGHTNESS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeBlink } from \"./e-shape-action-runtime-blink\";\nimport { EShapeActionRuntimeBlinkBrighten } from \"./e-shape-action-runtime-blink-brighten\";\nimport { EShapeActionRuntimeBlinkColorFill } from \"./e-shape-action-runtime-blink-color-fill\";\nimport { EShapeActionRuntimeBlinkColorStroke } from \"./e-shape-action-runtime-blink-color-stroke\";\nimport { EShapeActionRuntimeBlinkDarken } from \"./e-shape-action-runtime-blink-darken\";\nimport { EShapeActionRuntimeBlinkOpacity } from \"./e-shape-action-runtime-blink-opacity\";\nimport { EShapeActionRuntimeBlinkVisibility } from \"./e-shape-action-runtime-blink-visibility\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBlinkType } from \"./e-shape-action-value-blink-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueBlinkSerialized = [\n\tEShapeActionValueType.BLINK, number,\n\tEShapeActionValueBlinkType.COLOR_FILL | EShapeActionValueBlinkType.COLOR_STROKE,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueBlink extends EShapeActionValueSubtyped<EShapeActionValueBlinkType> {\n\treadonly interval: number;\n\treadonly color: number;\n\treadonly alpha: number;\n\n\tconstructor( subtype: EShapeActionValueBlinkType, condition: string, interval: number, color: number, alpha: number ) {\n\t\tsuper( EShapeActionValueType.BLINK, condition, subtype );\n\t\tthis.interval = interval;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueBlink) &&\n\t\t\tthis.interval === value.interval &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeBlink {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueBlinkType.BRIGHTEN:\n\t\t\treturn new EShapeActionRuntimeBlinkBrighten( this );\n\t\tcase EShapeActionValueBlinkType.COLOR_FILL:\n\t\t\treturn new EShapeActionRuntimeBlinkColorFill( this );\n\t\tcase EShapeActionValueBlinkType.COLOR_STROKE:\n\t\t\treturn new EShapeActionRuntimeBlinkColorStroke( this );\n\t\tcase EShapeActionValueBlinkType.DARKEN:\n\t\t\treturn new EShapeActionRuntimeBlinkDarken( this );\n\t\tcase EShapeActionValueBlinkType.OPACITY:\n\t\t\treturn new EShapeActionRuntimeBlinkOpacity( this );\n\t\tcase EShapeActionValueBlinkType.VISIBILITY:\n\t\t\treturn new EShapeActionRuntimeBlinkVisibility( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.interval},${this.color},${this.alpha}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueBlinkSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueBlink {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueBlink(\n\t\t\tserialized[ 2 ], condition, serialized[ 3 ],\n\t\t\tserialized[ 4 ], serialized[ 5 ]\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilAlpha {\n\tstatic blend( alphaA: number, alphaB: number, t: number ): number {\n\t\tconst w = Math.max( 0, Math.min( 1, t ) );\n\t\treturn Math.max( 0, Math.min( 1, alphaA * (1 - w) + alphaB * w ) );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilAlpha } from \"../../util/util-alpha\";\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\n\nconst toReset = ( type: EShapeActionValueChangeColorType ): EShapeRuntimeReset => {\n\treturn type << 3;\n};\n\nexport interface EShapeActionRuntimeChangeColorBaseValue extends EShapeActionValue {\n\tsubtype: EShapeActionValueChangeColorType;\n}\n\nexport class EShapeActionRuntimeChangeColorBase extends EShapeActionRuntimeConditional {\n\tconstructor( value: EShapeActionRuntimeChangeColorBaseValue ) {\n\t\tsuper( value, toReset( value.subtype ) );\n\t}\n\n\tprotected set( shape: EShape, runtime: EShapeRuntime, time: number, color: number | null, alpha: number | null, blend: number | null ): void {\n\t\tconst reset = this.reset;\n\t\tif( color != null ) {\n\t\t\tif( alpha != null ) {\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseFill( shape, runtime );\n\t\t\t\t\t\tshape.fill.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\t\t\t\t\tshape.stroke.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseText( shape, runtime );\n\t\t\t\t\t\tshape.text.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\t\t\t\t\tshape.text.outline.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\t\t\tshape.fill.set( undefined, color, alpha );\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\t\t\tshape.stroke.set( undefined, color, alpha );\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\t\t\tshape.text.set( undefined, color, alpha );\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\t\t\tshape.text.outline.set( undefined, color, alpha );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( blend != null ) {\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseFill( shape, runtime );\n\t\t\t\t\t\tshape.fill.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\t\t\t\t\tshape.stroke.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseText( shape, runtime );\n\t\t\t\t\t\tshape.text.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\t\t\t\t\tshape.text.outline.set(\n\t\t\t\t\t\t\tundefined,\n\t\t\t\t\t\t\tUtilRgb.blend( base.color, color, blend ),\n\t\t\t\t\t\t\tbase.alpha\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseFill( shape, runtime );\n\t\t\t\t\t\tshape.fill.set( undefined, color, base.alpha );\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\t\t\t\t\tshape.stroke.set( undefined, color, base.alpha );\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseText( shape, runtime );\n\t\t\t\t\t\tshape.text.set( undefined, color, base.alpha );\n\t\t\t\t\t}\n\t\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\t\t\tconst base = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\t\t\t\t\tshape.text.outline.set( undefined, color, base.alpha );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= reset;\n\t\t} else if( alpha != null ) {\n\t\t\tif( blend != null ) {\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseFill( shape, runtime );\n\t\t\t\t\tshape.fill.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tbase.color,\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\t\t\t\tshape.stroke.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tbase.color,\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseText( shape, runtime );\n\t\t\t\t\tshape.text.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tbase.color,\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\t\t\t\tshape.text.outline.set(\n\t\t\t\t\t\tundefined,\n\t\t\t\t\t\tbase.color,\n\t\t\t\t\t\tUtilAlpha.blend( base.alpha, alpha, blend )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseFill( shape, runtime );\n\t\t\t\t\tshape.fill.set( undefined, base.color, alpha );\n\t\t\t\t}\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\t\t\t\tshape.stroke.set( undefined, base.color, alpha );\n\t\t\t\t}\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseText( shape, runtime );\n\t\t\t\t\tshape.text.set( undefined, base.color, alpha );\n\t\t\t\t}\n\t\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\t\tconst base = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\t\t\t\tshape.text.outline.set( undefined, base.color, alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t\truntime.written |= reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeChangeColorBase } from \"./e-shape-action-runtime-change-color-base\";\nimport { EShapeActionValueChangeColor } from \"./e-shape-action-value-change-color\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\n\nexport class EShapeActionRuntimeChangeColor extends EShapeActionRuntimeChangeColorBase {\n\tprotected readonly color: number | null;\n\tprotected readonly alpha: number | null;\n\tprotected readonly blend: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColor ) {\n\t\tsuper( value );\n\n\t\tswitch( value.target ) {\n\t\tcase EShapeActionValueChangeColorTarget.COLOR:\n\t\t\tthis.color = value.color;\n\t\t\tthis.alpha = null;\n\t\t\tbreak;\n\t\tcase EShapeActionValueChangeColorTarget.ALPHA:\n\t\t\tthis.color = null;\n\t\t\tthis.alpha = value.alpha;\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.color = value.color;\n\t\t\tthis.alpha = value.alpha;\n\t\t\tbreak;\n\t\t}\n\n\t\tthis.blend = EShapeActionExpressions.ofNumberOrNull( value.blend );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst color = this.color;\n\t\t\tconst alpha = this.alpha;\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tthis.set( shape, runtime, time, color, alpha, blend );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeColorType {\n\tNONE = 0,\n\tFILL = 1,\n\tSTROKE = 2,\n\tTEXT = 4,\n\tTEXT_OUTLINE = 8,\n\tFILL_AND_STROKE = FILL | STROKE,\n\tALL = FILL | STROKE | TEXT | TEXT_OUTLINE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeColorTypeLegacy {\n\tFILL,\n\tSTROKE,\n\tFILL_AND_STROKE,\n\tTEXT,\n\tTEXT_OUTLINE,\n\tALL\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueChangeColorTypeLegacy } from \"./e-shape-action-value-change-color-type-legacy\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport interface EShapeActionValueChangeColorTypesSerialized {\n\t[ 0 ]: EShapeActionValueType.CHANGE_COLOR;\n\t[ 2 ]: EShapeActionValueChangeColorType;\n}\n\nexport interface EShapeActionValueChangeColorTypesSerializedLegacy {\n\t[ 0 ]: EShapeActionValueType.CHANGE_COLOR_LEGACY;\n\t[ 2 ]: EShapeActionValueChangeColorTypeLegacy;\n}\n\nexport class EShapeActionValueChangeColorTypes {\n\tstatic from(\n\t\tserialized: EShapeActionValueChangeColorTypesSerialized | EShapeActionValueChangeColorTypesSerializedLegacy\n\t): EShapeActionValueChangeColorType {\n\t\tif( serialized[ 0 ] === EShapeActionValueType.CHANGE_COLOR ) {\n\t\t\treturn serialized[ 2 ];\n\t\t}\n\t\tswitch( serialized[ 2 ] ) {\n\t\tcase EShapeActionValueChangeColorTypeLegacy.FILL:\n\t\t\treturn EShapeActionValueChangeColorType.FILL;\n\t\tcase EShapeActionValueChangeColorTypeLegacy.STROKE:\n\t\t\treturn EShapeActionValueChangeColorType.STROKE;\n\t\tcase EShapeActionValueChangeColorTypeLegacy.FILL_AND_STROKE:\n\t\t\treturn EShapeActionValueChangeColorType.FILL_AND_STROKE;\n\t\tcase EShapeActionValueChangeColorTypeLegacy.TEXT:\n\t\t\treturn EShapeActionValueChangeColorType.TEXT;\n\t\tcase EShapeActionValueChangeColorTypeLegacy.TEXT_OUTLINE:\n\t\t\treturn EShapeActionValueChangeColorType.TEXT_OUTLINE;\n\t\tcase EShapeActionValueChangeColorTypeLegacy.ALL:\n\t\t\treturn EShapeActionValueChangeColorType.ALL;\n\t\t}\n\t}\n\n\tstatic unpack( type: EShapeActionValueChangeColorType ): EShapeActionValueChangeColorType[] {\n\t\tconst result: EShapeActionValueChangeColorType[] = [];\n\t\tif( type & EShapeActionValueChangeColorType.FILL ) {\n\t\t\tresult.push( EShapeActionValueChangeColorType.FILL );\n\t\t}\n\t\tif( type & EShapeActionValueChangeColorType.STROKE ) {\n\t\t\tresult.push( EShapeActionValueChangeColorType.STROKE );\n\t\t}\n\t\tif( type & EShapeActionValueChangeColorType.TEXT ) {\n\t\t\tresult.push( EShapeActionValueChangeColorType.TEXT );\n\t\t}\n\t\tif( type & EShapeActionValueChangeColorType.TEXT_OUTLINE ) {\n\t\t\tresult.push( EShapeActionValueChangeColorType.TEXT_OUTLINE );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic pack( types: EShapeActionValueChangeColorType[] ): EShapeActionValueChangeColorType {\n\t\tlet result = EShapeActionValueChangeColorType.NONE;\n\t\tfor( let i = 0, imax = types.length; i < imax; ++i ) {\n\t\t\tresult |= types[ i ];\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueChangeTextType {\n\tTEXT,\n\tNUMBER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColor } from \"./e-shape-action-runtime-change-color\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueChangeColorTypeLegacy } from \"./e-shape-action-value-change-color-type-legacy\";\nimport { EShapeActionValueChangeColorTypes } from \"./e-shape-action-value-change-color-types\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\ntype Target = EShapeActionValueChangeColorTarget.COLOR_AND_ALPHA | EShapeActionValueChangeColorTarget.COLOR |\n\tEShapeActionValueChangeColorTarget.ALPHA;\n\nexport type EShapeActionValueChangeColorSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tTarget, number, number, number\n];\n\nexport type EShapeActionValueChangeColorSerializedLegacy = [\n\tEShapeActionValueType.CHANGE_COLOR_LEGACY, number, EShapeActionValueChangeColorTypeLegacy,\n\tTarget, number, number, number\n];\n\nexport class EShapeActionValueChangeColor extends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly target: Target;\n\treadonly color: number;\n\treadonly alpha: number;\n\treadonly blend: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string,\n\t\ttarget: Target, color: number, alpha: number, blend: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.target = target;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.blend = blend;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColor) &&\n\t\t\tthis.target === value.target &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha &&\n\t\t\tthis.blend === value.blend\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColor {\n\t\treturn new EShapeActionRuntimeChangeColor( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource( this.condition );\n\t\tconst blendId = manager.addResource( this.blend );\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.target},${this.color},${this.alpha},${blendId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorSerialized | EShapeActionValueChangeColorSerializedLegacy,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColor {\n\t\tconst subtype = EShapeActionValueChangeColorTypes.from( serialized );\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst blend = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColor(\n\t\t\tsubtype, condition, serialized[ 3 ], serialized[ 4 ], serialized[ 5 ], blend\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"../../util/util-rgb\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionBases } from \"./e-shape-action-bases\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeChangeColorBase } from \"./e-shape-action-runtime-change-color-base\";\nimport { EShapeActionValueChangeColorBrightness } from \"./e-shape-action-value-change-color-brightness\";\n\nexport class EShapeActionRuntimeChangeColorBrightness extends EShapeActionRuntimeChangeColorBase {\n\tprotected readonly brightness: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColorBrightness ) {\n\t\tsuper( value );\n\t\tthis.brightness = EShapeActionExpressions.ofNumberOrNull( value.brightness );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst brightness = this.brightness( shape, time );\n\t\t\tthis.set( shape, runtime, time, brightness );\n\t\t}\n\t}\n\n\tprotected set( shape: EShape, runtime: EShapeRuntime, time: number, brightness: number | null ): void {\n\t\tconst reset = this.reset;\n\t\tif( brightness != null ) {\n\t\t\tconst toAdjusted = this.toAdjusted;\n\n\t\t\tif( reset & EShapeRuntimeReset.COLOR_FILL ) {\n\t\t\t\tconst base = EShapeActionBases.toBaseFill( shape, runtime );\n\t\t\t\tshape.fill.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\ttoAdjusted( base.color, brightness ),\n\t\t\t\t\tbase.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( reset & EShapeRuntimeReset.COLOR_STROKE ) {\n\t\t\t\tconst base = EShapeActionBases.toBaseStroke( shape, runtime );\n\t\t\t\tshape.stroke.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\ttoAdjusted( base.color, brightness ),\n\t\t\t\t\tbase.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT ) {\n\t\t\t\tconst base = EShapeActionBases.toBaseText( shape, runtime );\n\t\t\t\tshape.text.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\ttoAdjusted( base.color, brightness ),\n\t\t\t\t\tbase.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\tif( reset & EShapeRuntimeReset.COLOR_TEXT_OUTLINE ) {\n\t\t\t\tconst base = EShapeActionBases.toBaseTextOutline( shape, runtime );\n\t\t\t\tshape.text.outline.set(\n\t\t\t\t\tundefined,\n\t\t\t\t\ttoAdjusted( base.color, brightness ),\n\t\t\t\t\tbase.alpha\n\t\t\t\t);\n\t\t\t}\n\t\t\truntime.written |= reset;\n\t\t}\n\t}\n\n\tprotected toAdjusted( color: number, brightness: number ): number {\n\t\tif( 0 <= brightness ) {\n\t\t\treturn UtilRgb.brighten( color, +brightness );\n\t\t} else {\n\t\t\treturn UtilRgb.darken( color, -brightness );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColorBrightness } from \"./e-shape-action-runtime-change-color-brightness\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueChangeColorTypeLegacy } from \"./e-shape-action-value-change-color-type-legacy\";\nimport { EShapeActionValueChangeColorTypes } from \"./e-shape-action-value-change-color-types\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeColorBrightnessSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tEShapeActionValueChangeColorTarget.BRIGHTNESS, number\n];\n\nexport type EShapeActionValueChangeColorBrightnessSerializedLegacy = [\n\tEShapeActionValueType.CHANGE_COLOR_LEGACY, number, EShapeActionValueChangeColorTypeLegacy,\n\tEShapeActionValueChangeColorTarget.BRIGHTNESS, number\n];\n\nexport class EShapeActionValueChangeColorBrightness\n\textends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly brightness: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string, brightness: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.brightness = brightness;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColorBrightness) &&\n\t\t\tthis.brightness === value.brightness\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColorBrightness {\n\t\treturn new EShapeActionRuntimeChangeColorBrightness( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\tconst target = EShapeActionValueChangeColorTarget.BRIGHTNESS;\n\t\tconst brightnessId = manager.addResource(this.brightness);\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${target},${brightnessId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorBrightnessSerialized | EShapeActionValueChangeColorBrightnessSerializedLegacy,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColorBrightness {\n\t\tconst subtype = EShapeActionValueChangeColorTypes.from( serialized );\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst brightness = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColorBrightness(\n\t\t\tsubtype, condition, brightness\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeChangeColorBase } from \"./e-shape-action-runtime-change-color-base\";\nimport { EShapeActionValueChangeColorCode } from \"./e-shape-action-value-change-color-code\";\n\nexport class EShapeActionRuntimeChangeColorCode extends EShapeActionRuntimeChangeColorBase {\n\tprotected readonly color: EShapeActionExpression<number | null>;\n\tprotected readonly alpha: EShapeActionExpression<number | null>;\n\tprotected readonly blend: EShapeActionExpression<number | null>;\n\n\tconstructor( value: EShapeActionValueChangeColorCode ) {\n\t\tsuper( value );\n\t\tthis.color = EShapeActionExpressions.ofNumberOrNull( value.color );\n\t\tthis.alpha = EShapeActionExpressions.ofNumberOrNull( value.alpha );\n\t\tthis.blend = EShapeActionExpressions.ofNumberOrNull( value.blend );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst color = this.color( shape, time );\n\t\t\tconst alpha = this.alpha( shape, time );\n\t\t\tconst blend = this.blend( shape, time );\n\t\t\tthis.set( shape, runtime, time, color, alpha, blend );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeColorCode } from \"./e-shape-action-runtime-change-color-code\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport { EShapeActionValueChangeColorTypeLegacy } from \"./e-shape-action-value-change-color-type-legacy\";\nimport { EShapeActionValueChangeColorType } from \"./e-shape-action-value-change-color-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\nimport { EShapeActionValueChangeColorTypes } from \"./e-shape-action-value-change-color-types\";\n\nexport type EShapeActionValueChangeColorCodeSerialized = [\n\tEShapeActionValueType.CHANGE_COLOR, number, EShapeActionValueChangeColorType,\n\tEShapeActionValueChangeColorTarget.CODE, number, number, number\n];\n\nexport type EShapeActionValueChangeColorCodeSerializedLegacy = [\n\tEShapeActionValueType.CHANGE_COLOR_LEGACY, number, EShapeActionValueChangeColorTypeLegacy,\n\tEShapeActionValueChangeColorTarget.CODE, number, number, number\n];\n\nexport class EShapeActionValueChangeColorCode extends EShapeActionValueSubtyped<EShapeActionValueChangeColorType> {\n\treadonly color: string;\n\treadonly alpha: string;\n\treadonly blend: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueChangeColorType, condition: string,\n\t\tcolor: string, alpha: string, blend: string\n\t) {\n\t\tsuper( EShapeActionValueType.CHANGE_COLOR, condition, subtype );\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.blend = blend;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeColorCode) &&\n\t\t\tthis.color === value.color &&\n\t\t\tthis.alpha === value.alpha &&\n\t\t\tthis.blend === value.blend\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeColorCode {\n\t\treturn new EShapeActionRuntimeChangeColorCode( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource( this.condition );\n\t\tconst target = EShapeActionValueChangeColorTarget.CODE;\n\t\tconst colorId = manager.addResource( this.color );\n\t\tconst alphaId = manager.addResource( this.alpha );\n\t\tconst blendId = manager.addResource( this.blend );\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${target},${colorId},${alphaId},${blendId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeColorCodeSerialized | EShapeActionValueChangeColorCodeSerializedLegacy,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeColorCode {\n\t\tconst subtype = EShapeActionValueChangeColorTypes.from( serialized );\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst color = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\tconst alpha = EShapeActionValues.toResource( 5, serialized, manager.resources );\n\t\tconst blend = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeColorCode(\n\t\t\tsubtype, condition, color, alpha, blend\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeCursor } from \"./e-shape-action-value-change-cursor\";\n\nexport class EShapeActionRuntimeChangeCursor extends EShapeActionRuntimeConditional {\n\tprotected name: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueChangeCursor ) {\n\t\tsuper( value, EShapeRuntimeReset.CURSOR );\n\t\tthis.name = EShapeActionExpressions.ofStringOrNull( value.name );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst name = this.name( shape, time );\n\t\t\tif( name != null ) {\n\t\t\t\tshape.cursor = name;\n\t\t\t\truntime.written |= this.reset;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeCursor } from \"./e-shape-action-runtime-change-cursor\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeCursorSerialized = [\n\tEShapeActionValueType.CHANGE_CURSOR, number, number\n];\n\nexport class EShapeActionValueChangeCursor extends EShapeActionValueBase {\n\treadonly name: string;\n\n\tconstructor( condition: string, name: string ) {\n\t\tsuper( EShapeActionValueType.CHANGE_CURSOR, condition );\n\t\tthis.name = name;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeCursor) &&\n\t\t\tthis.name === value.name\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeCursor {\n\t\treturn new EShapeActionRuntimeChangeCursor( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\tconst nameId = manager.addResource(this.name);\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${nameId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeCursorSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeCursor {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst name = EShapeActionValues.toResource( 2, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeCursor( condition, name );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeA implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn (date.getHours() < 12 ? \"AM\" : \"PM\");\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodea implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn (date.getHours() < 12 ? \"am\" : \"pm\");\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeD implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getDate());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoded implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${target | 0}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport abstract class FormatNodePrecision implements FormatNode {\n\tprotected precision: number | undefined;\n\n\tconstructor( precision?: string ) {\n\t\tif( precision != null ) {\n\t\t\tthis.precision = +precision.substring( 1, precision.length );\n\t\t} else {\n\t\t\tthis.precision = undefined;\n\t\t}\n\t}\n\n\tabstract format( target: number, step: number, date: Date ): string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodee extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toExponential(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodef extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toFixed(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodefsi extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst abs = this.toAbs( target, step, date );\n\t\tif( abs < 1e-24 ) {\n\t\t\treturn this.format_( target, 1e+00, \"\"  );\n\t\t} else if( abs < 1e-21 ) {\n\t\t\treturn this.format_( target, 1e+24, \"y\" );\n\t\t} else if( abs < 1e-18 ) {\n\t\t\treturn this.format_( target, 1e+21, \"z\" );\n\t\t} else if( abs < 1e-15 ) {\n\t\t\treturn this.format_( target, 1e+18, \"a\" );\n\t\t} else if( abs < 1e-12 ) {\n\t\t\treturn this.format_( target, 1e+15, \"f\" );\n\t\t} else if( abs < 1e-09 ) {\n\t\t\treturn this.format_( target, 1e+12, \"p\" );\n\t\t} else if( abs < 1e-06 ) {\n\t\t\treturn this.format_( target, 1e+09, \"n\" );\n\t\t} else if( abs < 1e-03 ) {\n\t\t\treturn this.format_( target, 1e+06, \"\" );\n\t\t} else if( abs < 1e+00 ) {\n\t\t\treturn this.format_( target, 1e+03, \"m\" );\n\t\t} else if( abs < 1e+03 ) {\n\t\t\treturn this.format_( target, 1e+00, \"\"  );\n\t\t} else if( abs < 1e+06 ) {\n\t\t\treturn this.format_( target, 1e-03, \"k\" );\n\t\t} else if( abs < 1e+09 ) {\n\t\t\treturn this.format_( target, 1e-06, \"M\" );\n\t\t} else if( abs < 1e+12 ) {\n\t\t\treturn this.format_( target, 1e-09, \"G\" );\n\t\t} else if( abs < 1e+15 ) {\n\t\t\treturn this.format_( target, 1e-12, \"T\" );\n\t\t} else if( abs < 1e+18 ) {\n\t\t\treturn this.format_( target, 1e-15, \"P\" );\n\t\t} else if( abs < 1e+21 ) {\n\t\t\treturn this.format_( target, 1e-18, \"E\" );\n\t\t} else if( abs < 1e+24 ) {\n\t\t\treturn this.format_( target, 1e-21, \"Z\" );\n\t\t} else {\n\t\t\treturn this.format_( target, 1e-24, \"Y\" );\n\t\t}\n\t}\n\n\tprotected toAbs(target: number, step: number, date: Date): number {\n\t\treturn Math.abs(target);\n\t}\n\n\tprotected format_(target: number, unitInverse: number, postfix: string): string {\n\t\tconst value = target * unitInverse;\n\t\treturn `${value.toFixed(this.precision)}${postfix}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodePrecision } from \"./format-node-precision\";\n\nexport class FormatNodeg extends FormatNodePrecision {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn target.toPrecision(this.precision);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeH implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getHours());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeh implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getHours() % 12);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeM implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMonth() + 1);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodem implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMinutes());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodemi implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getMilliseconds());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeP implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${(target * 100) | 0}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodep implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${target | 0}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"../to-padded\";\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodePadding implements FormatNode {\n\tprotected length: number;\n\tprotected character: string;\n\tprotected node: FormatNode;\n\n\tconstructor( length: number, character: string, node: FormatNode ) {\n\t\tthis.length = length;\n\t\tthis.character = character;\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn toPadded(this.node.format(target, step, date), this.length, this.character);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeParenthesis {\n\tprotected node: FormatNode;\n\n\tconstructor( node: FormatNode ) {\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif (0 < result.length && result[0] === \"-\") {\n\t\t\treturn `(${result.substring(1, result.length)})`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodePlus implements FormatNode {\n\tprotected node: FormatNode;\n\n\tconstructor(node: FormatNode) {\n\t\tthis.node = node;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif (0 < result.length && result[0] !== \"-\") {\n\t\t\treturn `+${result}`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeRP implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${Math.round(target * 100)}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoderp implements FormatNode {\n\tformat(target: number, step: number, date: Date): string {\n\t\treturn `${Math.round(target)}%`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodesdt implements FormatNode {\n\tprotected Y: FormatNode;\n\tprotected M: FormatNode;\n\tprotected D: FormatNode;\n\tprotected H: FormatNode;\n\tprotected m: FormatNode;\n\tprotected s: FormatNode;\n\tprotected mi: FormatNode;\n\n\tconstructor(\n\t\tY: FormatNode, M: FormatNode, D: FormatNode,\n\t\tH: FormatNode, m: FormatNode, s: FormatNode, mi: FormatNode\n\t) {\n\t\tthis.Y = Y;\n\t\tthis.M = M;\n\t\tthis.D = D;\n\t\tthis.H = H;\n\t\tthis.m = m;\n\t\tthis.s = s;\n\t\tthis.mi = mi;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\tif (step < 1000) {\n\t\t\treturn `${this.s.format(target, step, date)}.${this.mi.format(target, step, date)}`;\n\t\t} else if (step < 60000) {\n\t\t\treturn `${this.m.format(target, step, date)}:${this.s.format(target, step, date)}`;\n\t\t} else if (step < 3600000) {\n\t\t\treturn `${this.H.format(target, step, date)}:${this.m.format(target, step, date)}`;\n\t\t} else if (step < 86400000) {\n\t\t\tconst M = this.M.format(target, step, date);\n\t\t\tconst D = this.D.format(target, step, date);\n\t\t\treturn `${M}/${D} ${this.H.format(target, step, date)}`;\n\t\t} else if (step < 2592000000) {\n\t\t\treturn `${this.M.format(target, step, date)}/${this.D.format(target, step, date)}`;\n\t\t} else {\n\t\t\treturn `${this.Y.format(target, step, date)}/${this.M.format(target, step, date)}`;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeSpace {\n\tprotected node: FormatNode;\n\tconstructor(node: FormatNode) {\n\t\tthis.node = node;\n\t}\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst result = this.node.format(target, step, date);\n\t\tif( 0 < result.length && result[0] !== \"-\" ) {\n\t\t\treturn ` ${result}`;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNodefsi } from \"./format-node-fsi\";\n\nexport class FormatNodessi extends FormatNodefsi {\n\tprotected toAbs( target: number, step: number, date: Date ): number {\n\t\treturn Math.abs(step);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeString implements FormatNode {\n\tprotected str: string;\n\n\tconstructor(str: string) {\n\t\tthis.str = str;\n\t}\n\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn this.str;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodeY implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getFullYear());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodey implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getFullYear() % 100);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"../to-padded\";\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodez implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\tconst z = date.getTimezoneOffset();\n\t\tconst tzs = (z <= 0 ? \"+\" : \"-\");\n\t\tconst tzh = toPadded(String(Math.floor(Math.abs(z) / 60)), 2, \"0\");\n\t\tconst tzm = toPadded(String(Math.floor(Math.abs(z) % 60)), 2, \"0\");\n\t\treturn `${tzs}${tzh}:${tzm}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNoderd implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn `${Math.round(target)}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node\";\n\nexport class FormatNodes implements FormatNode {\n\tformat( target: number, step: number, date: Date ): string {\n\t\treturn String(date.getSeconds());\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { FormatNode } from \"./format-node/format-node\";\nimport { FormatNodeA } from \"./format-node/format-node-a-large\";\nimport { FormatNodea } from \"./format-node/format-node-a-small\";\nimport { FormatNodeD } from \"./format-node/format-node-d-large\";\nimport { FormatNoded } from \"./format-node/format-node-d-small\";\nimport { FormatNodee } from \"./format-node/format-node-e\";\nimport { FormatNodef } from \"./format-node/format-node-f\";\nimport { FormatNodefsi } from \"./format-node/format-node-fsi\";\nimport { FormatNodeg } from \"./format-node/format-node-g\";\nimport { FormatNodeH } from \"./format-node/format-node-h-large\";\nimport { FormatNodeh } from \"./format-node/format-node-h-small\";\nimport { FormatNodeM } from \"./format-node/format-node-m-large\";\nimport { FormatNodem } from \"./format-node/format-node-m-small\";\nimport { FormatNodemi } from \"./format-node/format-node-mi\";\nimport { FormatNodeP } from \"./format-node/format-node-p-large\";\nimport { FormatNodep } from \"./format-node/format-node-p-small\";\nimport { FormatNodePadding } from \"./format-node/format-node-padding\";\nimport { FormatNodeParenthesis } from \"./format-node/format-node-parenthesis\";\nimport { FormatNodePlus } from \"./format-node/format-node-plus\";\nimport { FormatNodeRP } from \"./format-node/format-node-rp-large\";\nimport { FormatNoderp } from \"./format-node/format-node-rp-small\";\nimport { FormatNodesdt } from \"./format-node/format-node-sdt\";\nimport { FormatNodeSpace } from \"./format-node/format-node-space\";\nimport { FormatNodessi } from \"./format-node/format-node-ssi\";\nimport { FormatNodeString } from \"./format-node/format-node-string\";\nimport { FormatNodeY } from \"./format-node/format-node-y-large\";\nimport { FormatNodey } from \"./format-node/format-node-y-small\";\nimport { FormatNodez } from \"./format-node/format-node-z\";\nimport { FormatNoderd } from \"./format-node/format-noder-d\";\nimport { FormatNodes } from \"./format-node/format-nodes\";\nimport { NumberFormatter } from \"./number-formatter\";\n\n// tslint:disable-next-line: max-line-length\nconst REGEXP = /%(0|_|-|\\+|\\()?(\\.\\d+)?(Y(?:MD?)?|y(?:MD?)?|MD?|D|H(?:ms?)?|h(?:ms?)?|m(?:i|s)?|a|A|s(?:s?i|dt)?|z|%|f(?:si)?|e|g|d|r(?:d|p)|p|P|RP)/g;\n\n/**\n * A NumberFormatter implementation class.\n */\nexport class NumberFormatterImpl implements NumberFormatter {\n\tprotected isDateRequired: boolean;\n\tprotected nodes: FormatNode[];\n\tprotected date: Date;\n\n\tconstructor( format: string ) {\n\t\tlet previousIndex = 0;\n\t\tlet isDateRequired = false;\n\t\tconst nodes: FormatNode[] = [];\n\t\tREGEXP.lastIndex = 0;\n\t\twhile( true ) {\n\t\t\tconst matched = REGEXP.exec( format );\n\t\t\tif( matched != null ) {\n\t\t\t\tconst index = matched.index;\n\t\t\t\tif( previousIndex < index ) {\n\t\t\t\t\tnodes.push( new FormatNodeString( format.substring( previousIndex, index ) ) );\n\t\t\t\t}\n\t\t\t\tpreviousIndex = index + matched[ 0 ].length;\n\n\t\t\t\tconst all = matched[ 0 ];\n\t\t\t\tconst modifier = matched[ 1 ];\n\t\t\t\tconst precision = matched[ 2 ];\n\t\t\t\tconst specifier = matched[ 3 ];\n\n\t\t\t\tswitch( specifier ) {\n\t\t\t\tcase \"Y\": // full year\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodeY() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"YM\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"YMD\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"y\": // short year: [0, 99]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodey() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"yM\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodey() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"yMD\":\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodey() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"M\": // month: [1, 12]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeM() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"MD\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tnew FormatNodeString( \"/\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"D\": // day of the month: [1, 31]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeD() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"H\": // 24-hour clock: [0, 23]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeH() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Hm\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"Hms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"h\": // 12-hour clock: [1, 12]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodeh() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hm\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeh() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"hms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeh() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"m\": // minute [0, 59]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodem() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"ms\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tnew FormatNodeString( \":\" ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() )\n\t\t\t\t\t);\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"mi\": // milliseconds [0, 999]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime3( modifier, new FormatNodemi() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"a\": // am or pm\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodea() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"A\": // AM or PM\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodeA() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"s\": // seconds: [0, 61]\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( this.toModifiedNodeDatetime2( modifier, new FormatNodes() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"sdt\":\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push(new FormatNodesdt(\n\t\t\t\t\t\tnew FormatNodeY(),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeM() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeD() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodeH() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodem() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime2( modifier, new FormatNodes() ),\n\t\t\t\t\t\tthis.toModifiedNodeDatetime3( modifier, new FormatNodemi() )\n\t\t\t\t\t));\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"z\": // time zone\n\t\t\t\t\tisDateRequired = true;\n\t\t\t\t\tnodes.push( new FormatNodez() );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"%\": // a % literal\n\t\t\t\t\tnodes.push( new FormatNodeString( \"%\" ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"f\": // fixed point notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodef( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"e\": // exponent notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodee( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"g\": // %f or %e\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeg( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"rd\": // rounded decimal notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoderd() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"d\": // decimal notation\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoded() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"P\": // percent notation (Multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeP() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"p\": // percent notation (Not multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodep() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"RP\": // percent notation (Multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodeRP() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"rp\": // percent notation (Not multiplied by 100)\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNoderp() ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"fsi\": // fixed point notation with a SI prefix\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodefsi( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"ssi\": // Step-based fixed point notation with a SI prefix\n\t\t\t\t\tnodes.push( this.toModifiedNodeNumber( modifier, new FormatNodessi( precision ) ) );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tnodes.push( new FormatNodeString( all ) );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( previousIndex < format.length ) {\n\t\t\t\t\tnodes.push( new FormatNodeString( format.substring( previousIndex, format.length ) ) );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tthis.isDateRequired = isDateRequired;\n\t\tthis.nodes = nodes;\n\t\tthis.date = new Date();\n\t}\n\n\tprotected toModifiedNodeDatetime2( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\":\n\t\t\treturn new FormatNodePadding( 2, \" \", node );\n\t\tcase \"-\":\n\t\t\treturn node;\n\t\tdefault:\n\t\t\treturn new FormatNodePadding( 2, \"0\", node );\n\t\t}\n\t}\n\n\tprotected toModifiedNodeDatetime3( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\":\n\t\t\treturn new FormatNodePadding( 3, \" \", node );\n\t\tcase \"-\":\n\t\t\treturn node;\n\t\tdefault:\n\t\t\treturn new FormatNodePadding( 3, \"0\", node );\n\t\t}\n\t}\n\n\tprotected toModifiedNodeNumber( modifier: string, node: FormatNode ): FormatNode {\n\t\tswitch( modifier ) {\n\t\tcase \"_\": // space for non-negative numbers\n\t\t\treturn new FormatNodeSpace( node );\n\t\tcase \"+\": // plus sign for non-negative numbers\n\t\t\treturn new FormatNodePlus( node );\n\t\tcase \"(\": // parenthesis for the negative numbers\n\t\t\treturn new FormatNodeParenthesis( node );\n\t\tdefault:\n\t\t\treturn node;\n\t\t}\n\t}\n\n\tformat( target: number, step: number ): string {\n\t\tconst nodes = this.nodes;\n\t\tconst date = this.date;\n\t\tif( this.isDateRequired ) {\n\t\t\tdate.setTime( target );\n\t\t}\n\t\tlet result = \"\";\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tresult += nodes[ i ].format( target, step, date );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NumberFormatter } from \"./number-formatter\";\nimport { NumberFormatterImpl } from \"./number-formatter-impl\";\n\n/**\n * An number formatter utility class.\n */\nexport class NumberFormatters {\n\t/**\n\t * Creates a number formatter of the given format.\n\t * Please refer to {@link NumberFormatter} for format details.\n\t *\n\t * @return A created number formatter\n\t */\n\tstatic create( format: string ): NumberFormatter {\n\t\treturn new NumberFormatterImpl( format );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NumberFormatter } from \"../../util/number-formatter\";\nimport { NumberFormatters } from \"../../util/number-formatters\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeText } from \"./e-shape-action-value-change-text\";\n\nexport class EShapeActionRuntimeChangeTextNumber extends EShapeActionRuntimeConditional {\n\tprotected number: EShapeActionExpression<number>;\n\tprotected formatters: Map<string, NumberFormatter | null>;\n\n\tconstructor( value: EShapeActionValueChangeText ) {\n\t\tsuper( value, EShapeRuntimeReset.TEXT );\n\n\t\tthis.number = EShapeActionExpressions.ofNumber( value.value );\n\t\tthis.formatters = new Map<string, NumberFormatter | null>();\n\t}\n\n\tprotected getFormatter( shape: EShape, runtime: EShapeRuntime ): NumberFormatter | null {\n\t\tconst formatters = this.formatters;\n\t\tconst text = runtime.text.value;\n\t\tlet result = formatters.get( text );\n\t\tif( result === undefined ) {\n\t\t\tresult = this.newFormatter( text );\n\t\t\tformatters.set( text, result );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newFormatter( format: string ): NumberFormatter | null {\n\t\tformat = format.trim();\n\t\tif( 0 < format.length ) {\n\t\t\treturn NumberFormatters.create( format );\n\t\t}\n\t\treturn null;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst value = this.number( shape, time );\n\t\t\tconst formatter = this.getFormatter( shape, runtime );\n\t\t\tshape.text.value = ( formatter != null ? formatter.format( value, 0 ) : String(value) );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueChangeText } from \"./e-shape-action-value-change-text\";\n\nexport class EShapeActionRuntimeChangeTextText extends EShapeActionRuntimeConditional {\n\tprotected text: EShapeActionExpression<string>;\n\n\tconstructor( value: EShapeActionValueChangeText ) {\n\t\tsuper( value, EShapeRuntimeReset.TEXT );\n\t\tthis.text = EShapeActionExpressions.ofString( value.value );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tshape.text.value = this.text( shape, time );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeChangeTextNumber } from \"./e-shape-action-runtime-change-text-number\";\nimport { EShapeActionRuntimeChangeTextText } from \"./e-shape-action-runtime-change-text-text\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueChangeTextType } from \"./e-shape-action-value-change-text-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueChangeTextSerialized = [\n\tEShapeActionValueType.CHANGE_TEXT, number, EShapeActionValueChangeTextType, number\n];\n\nexport class EShapeActionValueChangeText extends EShapeActionValueSubtyped<EShapeActionValueChangeTextType> {\n\treadonly value: string;\n\n\tconstructor( subtype: EShapeActionValueChangeTextType, condition: string, value: string ) {\n\t\tsuper( EShapeActionValueType.CHANGE_TEXT, condition, subtype );\n\t\tthis.value = value;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueChangeText) &&\n\t\t\tthis.value === value.value\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeChangeTextText | EShapeActionRuntimeChangeTextNumber {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueChangeTextType.TEXT:\n\t\t\treturn new EShapeActionRuntimeChangeTextText( this );\n\t\tcase EShapeActionValueChangeTextType.NUMBER:\n\t\t\treturn new EShapeActionRuntimeChangeTextNumber( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\tconst valueId = manager.addResource(this.value);\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${valueId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueChangeTextSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueChangeText {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst value = EShapeActionValues.toResource( 3, serialized, manager.resources );\n\t\treturn new EShapeActionValueChangeText( serialized[ 2 ], condition, value );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * A border mask.\n * Borders on masked parts are not rendered.\n */\nexport enum DBorderMask {\n\tNONE = 0,\n\n\tTOP = 1,\n\tRIGHT = 2,\n\tBOTTOM = 4,\n\tLEFT = 8,\n\n\tTOP_RIGHT = TOP | RIGHT,\n\tTOP_BOTTOM = TOP | BOTTOM,\n\tTOP_LEFT = TOP | LEFT,\n\n\tRIGHT_BOTTOM = RIGHT | BOTTOM,\n\tRIGHT_LEFT = RIGHT | LEFT,\n\n\tBOTTOM_LEFT = BOTTOM | LEFT,\n\n\tNOT_TOP = RIGHT | BOTTOM | LEFT,\n\tNOT_RIGHT = TOP | BOTTOM | LEFT,\n\tNOT_BOTTOM = TOP | RIGHT | LEFT,\n\tNOT_LEFT = TOP | RIGHT | BOTTOM,\n\n\tALL = TOP | RIGHT | BOTTOM | LEFT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBackgroundStateAware } from \"./d-background\";\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\n\ntype Callback = () => void;\n\nexport class DBaseBackground implements DBackgroundStateAware {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.background != null ) {\n\t\t\tconst background = options.background;\n\t\t\tthis._color = background.color;\n\t\t\tthis._alpha = background.alpha;\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseStateSet ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBackgroundColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseStateSet ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBackgroundAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tconst callback = this._callback;\n\t\tif( callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBorderStateAware } from \"./d-border\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseBorder implements DBorderStateAware {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _width?: DStateAwareOrValueMightBe<number>;\n\tprotected _align?: DStateAwareOrValueMightBe<number>;\n\tprotected _mask?: DStateAwareOrValueMightBe<DBorderMask>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.border != null ) {\n\t\t\tconst border = options.border;\n\t\t\tthis._color = border.color;\n\t\t\tthis._alpha = border.alpha;\n\t\t\tthis._width = border.width;\n\t\t\tthis._align = border.align;\n\t\t\tthis._mask = ( isString( border.mask ) ? DBorderMask[ border.mask ] : border.mask );\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseStateSet ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseStateSet ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetWidth( state: DBaseStateSet ): number {\n\t\tconst width = this._width;\n\t\tif( width !== undefined ) {\n\t\t\tif( isFunction( width ) ) {\n\t\t\t\tconst result = width( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderWidth( state );\n\t}\n\n\tget width(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._width;\n\t}\n\n\tset width( width: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetAlign( state: DBaseStateSet ): number {\n\t\tconst align = this._align;\n\t\tif( align !== undefined ) {\n\t\t\tif( isFunction( align ) ) {\n\t\t\t\tconst result = align( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn align;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderAlign( state );\n\t}\n\n\tget align(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._align;\n\t}\n\n\tset align( align: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tgetMask( state: DBaseStateSet ): number {\n\t\tconst mask = this._mask;\n\t\tif( mask !== undefined ) {\n\t\t\tif( isFunction( mask ) ) {\n\t\t\t\tconst result = mask( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn mask;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getBorderMask( state );\n\t}\n\n\tget mask(): DStateAwareOrValueMightBe<DBorderMask> {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DStateAwareOrValueMightBe<DBorderMask> ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tconst callback = this._callback;\n\t\tif( callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DCornerMask {\n\tNONE = 0,\n\tTOP_LEFT = 1,\n\tTOP_RIGHT = 2,\n\tBOTTOM_LEFT = 4,\n\tBOTTOM_RIGHT = 8,\n\tTOP = TOP_LEFT | TOP_RIGHT,\n\tBOTTOM = BOTTOM_LEFT | BOTTOM_RIGHT,\n\tLEFT = TOP_LEFT | BOTTOM_LEFT,\n\tRIGHT = TOP_RIGHT | BOTTOM_RIGHT,\n\tALL = TOP_LEFT | TOP_RIGHT | BOTTOM_LEFT | BOTTOM_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DCorner } from \"./d-corner\";\nimport { DCornerMask } from \"./d-corner-mask\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseCorner implements DCorner {\n\tprotected _theme: DThemeBase;\n\tprotected _radius?: number;\n\tprotected _mask?: DCornerMask;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: () => void ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.corner != null ) {\n\t\t\tconst corner = options.corner;\n\t\t\tif( isNumber( corner ) ) {\n\t\t\t\tthis._radius = corner;\n\t\t\t\tthis._mask = undefined;\n\t\t\t} else {\n\t\t\t\tthis._radius = corner.radius;\n\t\t\t\tthis._mask = ( isString( corner.mask ) ? DCornerMask[ corner.mask ] : corner.mask );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetRadius(): number {\n\t\tconst radius = this._radius;\n\t\treturn ( radius !== undefined ? radius : this._theme.getCornerRadius() );\n\t}\n\n\tget radius(): number | undefined {\n\t\treturn this._radius;\n\t}\n\n\tset radius( radius: number | undefined ) {\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMask(): DCornerMask {\n\t\tconst mask = this._mask;\n\t\treturn ( mask !== undefined ? mask : this._theme.getCornerMask() );\n\t}\n\n\tget mask(): DCornerMask | undefined {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DCornerMask | undefined ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tset( radius?: number, mask?: DCornerMask ): void {\n\t\tlet isChanged = false;\n\n\t\tif( this._radius !== radius ) {\n\t\t\tthis._radius = radius;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tisChanged = true;\n\t\t}\n\n\t\tconst callback = this._callback;\n\t\tif( isChanged && callback != null ) {\n\t\t\tcallback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * DBase interactivity.\n * Mouse / touch events are triggered only on interactive objects.\n */\nexport enum DBaseInteractive {\n\t/**\n\t * Not interactive.\n\t */\n\tNONE = 0,\n\n\t/**\n\t * Interactive.\n\t * However children are not interactive.\n\t */\n\tSELF = 1,\n\n\t/**\n\t * Not interactive.\n\t * However children are interactive.\n\t */\n\tCHILDREN = 2,\n\n\t/**\n\t * Interactive.\n\t * Children are also interactive.\n\t */\n\tBOTH = SELF | CHILDREN\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DOutline } from \"./d-outline\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\ntype Callback = () => void;\n\nexport class DBaseOutline implements DOutline {\n\tprotected _theme: DThemeBase;\n\tprotected _color?: DStateAwareOrValueMightBe<number | null>;\n\tprotected _alpha?: DStateAwareOrValueMightBe<number>;\n\tprotected _width?: DStateAwareOrValueMightBe<number>;\n\tprotected _offset?: DStateAwareOrValueMightBe<number>;\n\tprotected _align?: DStateAwareOrValueMightBe<number>;\n\tprotected _mask?: DStateAwareOrValueMightBe<DBorderMask>;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: Callback ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\t\tif( options != null && options.outline != null ) {\n\t\t\tconst outline = options.outline;\n\t\t\tthis._color = outline.color;\n\t\t\tthis._alpha = outline.alpha;\n\t\t\tthis._width = outline.width;\n\t\t\tthis._offset = outline.offset;\n\t\t\tthis._align = outline.align;\n\t\t\tthis._mask = ( isString( outline.mask ) ? DBorderMask[ outline.mask ] : outline.mask );\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetColor( state: DBaseStateSet ): number | null {\n\t\tconst color = this._color;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineColor( state );\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAlpha( state: DBaseStateSet ): number {\n\t\tconst alpha = this._alpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWidth( state: DBaseStateSet ): number {\n\t\tconst width = this._width;\n\t\tif( width !== undefined ) {\n\t\t\tif( isFunction( width ) ) {\n\t\t\t\tconst result = width( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn width;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineWidth( state );\n\t}\n\n\tget width(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._width;\n\t}\n\n\tset width( width: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetOffset( state: DBaseStateSet ): number {\n\t\tconst offset = this._offset;\n\t\tif( offset !== undefined ) {\n\t\t\tif( isFunction( offset ) ) {\n\t\t\t\tconst result = offset( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn offset;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineOffset( state );\n\t}\n\n\tget offset(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._offset;\n\t}\n\n\tset offset( offset: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._offset !== offset ) {\n\t\t\tthis._offset = offset;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetAlign( state: DBaseStateSet ): number {\n\t\tconst align = this._align;\n\t\tif( align !== undefined ) {\n\t\t\tif( isFunction( align ) ) {\n\t\t\t\tconst result = align( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn align;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineAlign( state );\n\t}\n\n\tget align(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._align;\n\t}\n\n\tset align( align: DStateAwareOrValueMightBe<number> ) {\n\t\tif( this._align !== align ) {\n\t\t\tthis._align = align;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetMask( state: DBaseStateSet ): number {\n\t\tconst mask = this._mask;\n\t\tif( mask !== undefined ) {\n\t\t\tif( isFunction( mask ) ) {\n\t\t\t\tconst result = mask( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn mask;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getOutlineMask( state );\n\t}\n\n\tget mask(): DStateAwareOrValueMightBe<DBorderMask> {\n\t\treturn this._mask;\n\t}\n\n\tset mask( mask: DStateAwareOrValueMightBe<DBorderMask> ) {\n\t\tif( this._mask !== mask ) {\n\t\t\tthis._mask = mask;\n\t\t\tconst callback = this._callback;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback();\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DLayoutClearType {\n\tNONE = 0,\n\tBEFORE = 1,\n\tAFTER = 2,\n\tBOTH = BEFORE | AFTER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScalar } from \"./d-scalar\";\nimport { isNumber } from \"./util/is-number\";\n\nconst enum NodeType {\n\t// Parensesis\n\tOPEN,\n\tCLOSE,\n\tPARENSESIS,\n\n\t// Operations\n\tADD_OR_PLUS,\n\tSUB_OR_MINUS,\n\n\tPLUS,\n\tMINUS,\n\n\tADD,\n\tSUB,\n\tMUL,\n\tDIV,\n\n\t// Functions\n\tMIN,\n\tMAX,\n\tCOMMA,\n\n\t// Literals\n\tPARENT,\n\tSELF,\n\tPADDING,\n\tCURRENT,\n\tNUMBER\n}\n\ntype NodeTypeOperator = NodeType.SUB_OR_MINUS | NodeType.ADD_OR_PLUS |\n\tNodeType.SUB | NodeType.ADD | NodeType.MUL | NodeType.DIV |\n\tNodeType.OPEN | NodeType.CLOSE |\n\tNodeType.MIN | NodeType.MAX | NodeType.COMMA;\ntype NodeTypeLiteral = NodeType.NUMBER | NodeType.PARENT | NodeType.SELF | NodeType.PADDING | NodeType.CURRENT;\ntype Token = NodeTypeOperator | [ NodeTypeLiteral, number ];\n\ninterface NodeOrTokenParensesis {\n\t[ 0 ]: NodeType.PARENSESIS;\n\t[ 1 ]: NodeOrToken[];\n}\n\ninterface NodeOrTokenUnary {\n\t[ 0 ]: NodeType.PLUS | NodeType.MINUS;\n\t[ 1 ]: NodeOrToken;\n}\n\ntype NodeArithmeticOperator = NodeType.SUB | NodeType.ADD | NodeType.MUL | NodeType.DIV;\n\ninterface NodeOrTokenArithmetic {\n\t[ 0 ]: NodeArithmeticOperator;\n\t[ 1 ]: NodeOrToken;\n\t[ 2 ]: NodeOrToken;\n}\n\ninterface NodeOrTokenFunction {\n\t[ 0 ]: NodeType.MIN | NodeType.MAX;\n\t[ 1 ]: NodeOrToken[];\n}\n\ntype NodeOrToken = Token | NodeOrTokenParensesis | NodeOrTokenUnary | NodeOrTokenArithmetic | NodeOrTokenFunction;\n\ninterface NodeLiteral {\n\t[ 0 ]: NodeTypeLiteral;\n\t[ 1 ]: number;\n}\n\ninterface NodeParensesis {\n\t[ 0 ]: NodeType.PARENSESIS;\n\t[ 1 ]: Node[];\n}\n\ninterface NodeUnary {\n\t[ 0 ]: NodeType.PLUS | NodeType.MINUS;\n\t[ 1 ]: Node;\n}\n\ninterface NodeArithmetic {\n\t[ 0 ]: NodeArithmeticOperator;\n\t[ 1 ]: Node;\n\t[ 2 ]: Node;\n}\n\ninterface NodeFunction {\n\t[ 0 ]: NodeType.MIN | NodeType.MAX;\n\t[ 1 ]: Node[];\n}\n\ntype Node = NodeParensesis | NodeUnary | NodeArithmetic | NodeFunction | NodeLiteral;\n\nconst TOKEN_MAPPING_OPERATOR: { [ token: string ]: NodeTypeOperator | undefined } = {\n\t\"+\": NodeType.ADD_OR_PLUS,\n\t\"-\": NodeType.SUB_OR_MINUS,\n\t\"*\": NodeType.MUL,\n\t\"/\": NodeType.DIV,\n\t\"(\": NodeType.OPEN,\n\t\")\": NodeType.CLOSE,\n\t\",\": NodeType.COMMA,\n\t\"min\": NodeType.MIN,\n\t\"max\": NodeType.MAX\n};\n\nconst TOKEN_MAPPING_LITERAL: { [ token: string ]: NodeTypeLiteral | undefined } = {\n\t\"%\": NodeType.PARENT,\n\t\"s\": NodeType.SELF,\n\t\"p\": NodeType.PADDING,\n\t\"c\": NodeType.CURRENT\n};\n\n/**\n * Parser and evaluator of the scalar expressions like `100% - 50s`.\n *\n * Literals\n *\n * * x%: 0.01 * x * parent value\n * * xs: 0.01 * x * self value\n * * xp: 0.01 * x * padding value\n * * xc: 0.01 * x * current value\n *\n * Operators\n *\n * * `+`\n * * `-`\n * * `*`\n * * `/`\n * * `(` and `)`\n *\n * Functions\n *\n * * min( a, b, ... )\n * * max( a, b, ... )\n *\n * Examples\n *\n * * `90%`: 0.9 * parent value\n * * `50s`: 0.5 * self value\n * * `90% - 50s`: 0.9 * parent value - 0.5 * self value\n * * `90% - (50s + 100) * 2`: 0.9 * parent value - ( 0.5 * self value + 100 ) * 2\n */\nexport class DScalarExpression implements DScalar {\n\tprotected static TOKEN_REGEX = /(?:\\+|-|\\*|\\/|\\(|\\)|min|max|,|(?:\\d+(?:\\.\\d*)?[%psc]?))/g;\n\tprotected _node: Node;\n\n\tconstructor( expression: string ) {\n\t\tconst nodes: NodeOrToken[] = this.toToken( expression );\n\t\tlet i = 0;\n\t\tdo {\n\t\t\ti = this.toParensesis( nodes, i );\n\t\t} while( i < nodes.length );\n\t\tthis.toUnary( nodes );\n\t\tthis.toArithmetic( nodes, NodeType.MUL, NodeType.DIV );\n\t\tthis.toArithmetic( nodes, NodeType.ADD, NodeType.SUB );\n\t\tif( nodes.length === 1 ) {\n\t\t\tconst node = nodes[ 0 ];\n\t\t\tif( ! isNumber( node ) ) {\n\t\t\t\tthis._node = node as any;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tthrow new Error( `Failed to parse '${expression}'` );\n\t}\n\n\ttoParensesis( nodes: NodeOrToken[], ifrom: number ): number {\n\t\tlet ito = nodes.length;\n\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\tconst inode = nodes[ i ];\n\t\t\tif( inode === NodeType.OPEN ) {\n\t\t\t\tlet istart = i;\n\t\t\t\tlet nodeType = NodeType.PARENSESIS;\n\t\t\t\tif( 0 < i ) {\n\t\t\t\t\tconst nodeTypePrev = nodes[ i - 1 ];\n\t\t\t\t\tif( nodeTypePrev === NodeType.MIN || nodeTypePrev === NodeType.MAX ) {\n\t\t\t\t\t\tistart -= 1;\n\t\t\t\t\t\tnodeType = nodeTypePrev;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tfor( let j = i + 1; j < ito; ++j ) {\n\t\t\t\t\tconst jnode = nodes[ j ];\n\t\t\t\t\tif( jnode === NodeType.CLOSE ) {\n\t\t\t\t\t\tnodes[ istart ] = [ nodeType, this.toComma( nodes, i + 1, j ) ];\n\t\t\t\t\t\tnodes.splice( istart + 1, j - istart );\n\t\t\t\t\t\treturn istart + 1;\n\t\t\t\t\t} else if( jnode === NodeType.OPEN ) {\n\t\t\t\t\t\tj = this.toParensesis( nodes, j ) - 1;\n\t\t\t\t\t\tito = nodes.length;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error( `Malformed parensesis` );\n\t\t\t}\n\t\t}\n\t\treturn ito;\n\t}\n\n\ttoCommaOf( nodes: NodeOrToken[], ifrom: number, ito: number ): NodeOrToken {\n\t\tconst l = ito - ifrom;\n\t\tif( l <= 0 ) {\n\t\t\treturn [ NodeType.NUMBER, 0 ];\n\t\t} else if( l <= 1 ) {\n\t\t\treturn nodes[ ifrom ];\n\t\t} else {\n\t\t\tconst operand: NodeOrToken[] = [];\n\t\t\tfor( let j = ifrom; j < ito; ++j ) {\n\t\t\t\toperand.push( nodes[ j ] );\n\t\t\t}\n\t\t\treturn [ NodeType.PARENSESIS, operand ];\n\t\t}\n\t}\n\n\ttoComma( nodes: NodeOrToken[], ifrom: number, ito: number ): NodeOrToken[] {\n\t\tlet result: NodeOrToken[] | null = null;\n\t\tlet iprev = ifrom;\n\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === NodeType.COMMA ) {\n\t\t\t\tresult = result || [];\n\t\t\t\tresult.push( this.toCommaOf( nodes, iprev, i ) );\n\t\t\t\tiprev = i + 1;\n\t\t\t}\n\t\t}\n\t\tif( iprev < ito ) {\n\t\t\tif( result == null ) {\n\t\t\t\tconst operand: NodeOrToken[] = [];\n\t\t\t\tfor( let i = iprev; i < ito; ++i ) {\n\t\t\t\t\toperand.push( nodes[ i ] );\n\t\t\t\t}\n\t\t\t\treturn operand;\n\t\t\t} else {\n\t\t\t\tresult.push( this.toCommaOf( nodes, iprev, ito ) );\n\t\t\t}\n\t\t}\n\t\treturn result || [];\n\t}\n\n\ttoUnaryNode( node: NodeOrToken ): void {\n\t\tif( ! isNumber( node ) ) {\n\t\t\tif( node[ 0 ] === NodeType.PARENSESIS ||\n\t\t\t\tnode[ 0 ] === NodeType.MIN ||\n\t\t\t\tnode[ 0 ] === NodeType.MAX ) {\n\t\t\t\tthis.toUnary( node[ 1 ] );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoUnary( nodes: NodeOrToken[] ): void {\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === NodeType.ADD_OR_PLUS || node === NodeType.SUB_OR_MINUS ) {\n\t\t\t\tif( i <= 0 || isNumber( nodes[ i - 1 ] ) ) {\n\t\t\t\t\tif( i + 1 < imax && ! isNumber( nodes[ i + 1 ] ) ) {\n\t\t\t\t\t\tconst operand = nodes.splice( i + 1, 1 )[ 0 ];\n\t\t\t\t\t\tconst type = ( node === NodeType.ADD_OR_PLUS ? NodeType.PLUS : NodeType.MINUS );\n\t\t\t\t\t\tnodes[ i ] = [ type, operand ];\n\t\t\t\t\t\timax = nodes.length;\n\t\t\t\t\t\tthis.toUnaryNode( operand );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthrow new Error( \"Malformed unary operator\" );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst type = ( node === NodeType.ADD_OR_PLUS ? NodeType.ADD : NodeType.SUB );\n\t\t\t\t\tnodes[ i ] = type;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.toUnaryNode( node );\n\t\t\t\timax = nodes.length;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoArithmeticNode( node: NodeOrToken, operatorA: NodeArithmeticOperator, operatorB: NodeArithmeticOperator ): void {\n\t\tif( ! isNumber( node ) ) {\n\t\t\tif( node[ 0 ] === NodeType.PARENSESIS || node[ 0 ] === NodeType.MIN || node[ 0 ] === NodeType.MAX ) {\n\t\t\t\tthis.toArithmetic( node[ 1 ], operatorA, operatorB );\n\t\t\t} else if( node[ 0 ] === NodeType.PLUS || node[ 0 ] === NodeType.MINUS ) {\n\t\t\t\tthis.toArithmeticNode( node[ 1 ], operatorA, operatorB );\n\t\t\t} else if( node[ 0 ] === NodeType.ADD || node[ 0 ] === NodeType.SUB ||\n\t\t\t\tnode[ 0 ] === NodeType.MUL || node[ 0 ] === NodeType.DIV ) {\n\t\t\t\tthis.toArithmeticNode( node[ 1 ], operatorA, operatorB );\n\t\t\t\tthis.toArithmeticNode( node[ 2 ], operatorA, operatorB );\n\t\t\t}\n\t\t}\n\t}\n\n\ttoArithmetic( nodes: NodeOrToken[], operatorA: NodeArithmeticOperator, operatorB: NodeArithmeticOperator ): void {\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( node === operatorA || node === operatorB ) {\n\t\t\t\tif( 0 < i && i + 1 < imax ) {\n\t\t\t\t\tconst left = nodes[ i - 1 ];\n\t\t\t\t\tconst right = nodes[ i + 1 ];\n\t\t\t\t\tif( ! isNumber( left ) && ! isNumber( right ) ) {\n\t\t\t\t\t\tnodes.splice( i, 2 );\n\t\t\t\t\t\tnodes[ i - 1 ] = [ node, left, right ];\n\t\t\t\t\t\ti -= 1;\n\t\t\t\t\t\timax = nodes.length;\n\t\t\t\t\t\tthis.toArithmeticNode( left, operatorA, operatorB );\n\t\t\t\t\t\tthis.toArithmeticNode( right, operatorA, operatorB );\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthrow new Error( `Malformed operands for the operator ${node}` );\n\t\t\t} else {\n\t\t\t\tthis.toArithmeticNode( node, operatorA, operatorB );\n\t\t\t\timax = nodes.length;\n\t\t\t}\n\t\t}\n\t}\n\n\ttoToken( expression: string ): Token[] {\n\t\tconst tokens: Token[] = [];\n\t\twhile( true ) {\n\t\t\tconst matched = DScalarExpression.TOKEN_REGEX.exec( expression );\n\t\t\tif( matched != null ) {\n\t\t\t\tconst token = matched[ 0 ];\n\t\t\t\tconst tokenTypeOperator = TOKEN_MAPPING_OPERATOR[ token ];\n\t\t\t\tif( tokenTypeOperator != null ) {\n\t\t\t\t\ttokens.push( tokenTypeOperator );\n\t\t\t\t} else {\n\t\t\t\t\tconst parsedToken = parseFloat( token );\n\t\t\t\t\tif( parsedToken !== parsedToken ) {\n\t\t\t\t\t\tthrow new Error( `Unexpected token '${token}' at ${matched.index} in '${expression}'` );\n\t\t\t\t\t}\n\n\t\t\t\t\tconst tokenTypeLiteral = TOKEN_MAPPING_LITERAL[ token[ token.length - 1 ] ];\n\t\t\t\t\tif( tokenTypeLiteral != null ) {\n\t\t\t\t\t\ttokens.push([ tokenTypeLiteral, parsedToken * 0.01 ]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttokens.push([ NodeType.NUMBER, parsedToken ]);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\treturn tokens;\n\t}\n\n\tprotected evaluate( node: Node, parent: number, self: number, padding: number, current: number ): number {\n\t\tswitch( node[ 0 ] ) {\n\t\tcase NodeType.PARENSESIS:\n\t\t\tconst nodes = node[ 1 ];\n\t\t\treturn this.evaluate( nodes[ nodes.length - 1 ], parent, self, padding, current );\n\n\t\t// Unary operators\n\t\tcase NodeType.PLUS:\n\t\t\treturn + this.evaluate( node[ 1 ], parent, self, padding, current );\n\n\t\tcase NodeType.MINUS:\n\t\t\treturn - this.evaluate( node[ 1 ], parent, self, padding, current );\n\n\t\t// Four arithmetic operators\n\t\tcase NodeType.ADD:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) +\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.SUB:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) -\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.MUL:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) *\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\t\tcase NodeType.DIV:\n\t\t\treturn this.evaluate( node[ 1 ], parent, self, padding, current ) /\n\t\t\t\tthis.evaluate( node[ 2 ], parent, self, padding, current );\n\n\t\t// Functions\n\t\tcase NodeType.MIN:\n\t\t\tif( 0 < node[ 1 ].length ) {\n\t\t\t\tconst args = node[ 1 ];\n\t\t\t\tlet result = this.evaluate( args[ 0 ], parent, self, padding, current );\n\t\t\t\tfor( let i = 1, imax = args.length; i < imax; ++i ) {\n\t\t\t\t\tresult = Math.min( result, this.evaluate( args[ i ], parent, self, padding, current ) );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\t\tcase NodeType.MAX:\n\t\t\tif( 0 < node[ 1 ].length ) {\n\t\t\t\tconst args = node[ 1 ];\n\t\t\t\tlet result = this.evaluate( args[ 0 ], parent, self, padding, current );\n\t\t\t\tfor( let i = 1, imax = args.length; i < imax; ++i ) {\n\t\t\t\t\tresult = Math.max( result, this.evaluate( args[ i ], parent, self, padding, current ) );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\n\t\t// Literals\n\t\tcase NodeType.PARENT:\n\t\t\treturn node[ 1 ] * parent;\n\t\tcase NodeType.SELF:\n\t\t\treturn node[ 1 ] * self;\n\t\tcase NodeType.PADDING:\n\t\t\treturn node[ 1 ] * padding;\n\t\tcase NodeType.CURRENT:\n\t\t\treturn node[ 1 ] * current;\n\t\tcase NodeType.NUMBER:\n\t\t\treturn node[ 1 ];\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tcalculate( parent: number, self: number, padding: number, current: number ): number {\n\t\treturn this.evaluate( this._node, parent, self, padding, current );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DPadding } from \"./d-padding\";\nimport { isNumber } from \"./util/is-number\";\n\ntype Callback = () => void;\n\nexport class DBasePadding implements DPadding {\n\tprotected _theme: DThemeBase;\n\tprotected _left?: number;\n\tprotected _top?: number;\n\tprotected _right?: number;\n\tprotected _bottom?: number;\n\tprotected _callback: Callback | undefined;\n\n\tconstructor( theme: DThemeBase, options?: DBaseOptions<any>, callback?: () => void ) {\n\t\tthis._theme = theme;\n\t\tthis._callback = callback;\n\n\t\tif( options != null && options.padding != null ) {\n\t\t\tconst padding = options.padding;\n\t\t\tif( isNumber( padding ) ) {\n\t\t\t\tthis._left = padding;\n\t\t\t\tthis._top = padding;\n\t\t\t\tthis._right = padding;\n\t\t\t\tthis._bottom = padding;\n\t\t\t} else {\n\t\t\t\tthis._left = padding.left;\n\t\t\t\tthis._top = padding.top;\n\t\t\t\tthis._right = padding.right;\n\t\t\t\tthis._bottom = padding.bottom;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._theme;\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._theme = theme;\n\t}\n\n\tgetLeft(): number {\n\t\tconst left = this._left;\n\t\treturn left !== undefined ? left : this._theme.getPaddingLeft();\n\t}\n\n\tget left(): number | undefined {\n\t\treturn this._left;\n\t}\n\n\tset left( left: number | undefined ) {\n\t\tif( this._left !== left ) {\n\t\t\tthis._left = left;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetTop(): number {\n\t\tconst top = this._top;\n\t\treturn top !== undefined ? top : this._theme.getPaddingTop();\n\t}\n\n\tget top(): number | undefined {\n\t\treturn this._top;\n\t}\n\n\tset top( top: number | undefined ) {\n\t\tif( this._top !== top ) {\n\t\t\tthis._top = top;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetRight(): number {\n\t\tconst right = this._right;\n\t\treturn right !== undefined ? right : this._theme.getPaddingRight();\n\t}\n\n\tget right(): number | undefined {\n\t\treturn this._right;\n\t}\n\n\tset right( right: number | undefined ) {\n\t\tif( this._right !== right ) {\n\t\t\tthis._right = right;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tgetBottom(): number {\n\t\tconst bottom = this._bottom;\n\t\treturn bottom !== undefined ? bottom : this._theme.getPaddingBottom();\n\t}\n\n\tget bottom(): number | undefined {\n\t\treturn this._bottom;\n\t}\n\n\tset bottom( bottom: number | undefined ) {\n\t\tif( this._bottom !== bottom ) {\n\t\t\tthis._bottom = bottom;\n\t\t\tif( this._callback != null ) {\n\t\t\t\tthis._callback();\n\t\t\t}\n\t\t}\n\t}\n\n\tset( padding: number ): void;\n\tset( topAndBottom: number, leftAndRight: number ): void;\n\tset( top: number, leftAndRight: number, bottom: number ): void;\n\tset( top: number, right: number, bottom: number, left: number ): void;\n\tset( top: number, right?: number, bottom?: number, left?: number ) {\n\t\tif( right == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = top;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = top;\n\t\t} else if( bottom == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = right;\n\t\t} else if( left == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = right;\n\t\t} else {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = left;\n\t\t}\n\t\tif( this._callback != null ) {\n\t\t\tthis._callback();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\n\nexport type DBasePointCallback = ( newX: number, newY: number, oldX: number, oldY: number ) => any;\n\nexport class DBasePoint {\n\tprotected _point: IPoint;\n\tprotected _onChange: DBasePointCallback;\n\n\tconstructor( point: IPoint, onChange: DBasePointCallback ) {\n\t\tthis._point = point;\n\t\tthis._onChange = onChange;\n\t}\n\n\tget x() {\n\t\treturn this._point.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst point = this._point;\n\t\tconst oldX = point.x;\n\t\tif( oldX !== x ) {\n\t\t\tpoint.x = x;\n\t\t\tconst y = point.y;\n\t\t\tthis._onChange( x, y, oldX, y );\n\t\t}\n\t}\n\n\tget y() {\n\t\treturn this._point.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst point = this._point;\n\t\tconst oldY = point.y;\n\t\tif( oldY !== y ) {\n\t\t\tpoint.y = y;\n\t\t\tconst x = point.x;\n\t\t\tthis._onChange( x, y, x, oldY );\n\t\t}\n\t}\n\n\tset( x: number, y: number ): this {\n\t\tconst point = this._point;\n\t\tconst oldX = point.x;\n\t\tconst oldY = point.y;\n\t\tif( oldX !== x || oldY !== y ) {\n\t\t\tpoint.set( x, y );\n\t\t\tthis._onChange( x, y, oldX, oldY );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyFrom( target: IPoint ): this {\n\t\tconst x = target.x;\n\t\tconst y = target.y;\n\t\tconst point = this._point;\n\t\tconst oldX = point.x;\n\t\tconst oldY = point.y;\n\t\tif( oldX !== x || oldY !== y ) {\n\t\t\tpoint.copyFrom( target );\n\t\t\tthis._onChange( x, y, oldX, oldY );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( target: IPoint ): IPoint {\n\t\treturn target.copyFrom( this._point );\n\t}\n\n\tcopy(): this {\n\t\treturn this.copyFrom( arguments[ 0 ] );\n\t}\n\n\tclone( onChange?: DBasePointCallback ): DBasePoint {\n\t\tonChange = onChange || this._onChange;\n\t\treturn new DBasePoint( this._point, onChange );\n\t}\n\n\tequals( p: IPoint ): boolean {\n\t\treturn this._point.equals( p );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, MeshGeometry, Texture, TextureUvs } from \"pixi.js\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBackgroundMeshGeometry extends MeshGeometry {\n\tprotected _texture: Texture;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _borderSize: number;\n\tprotected _cornerMask: DCornerMask;\n\tprotected _isDirty: boolean;\n\tprotected _textureId: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _vertexBuffer: Buffer;\n\tprotected _uvBuffer: Buffer;\n\tprotected _indexBuffer: Buffer;\n\n\tconstructor( texture: Texture, width: number, height: number, borderSize: number, cornerMask: DCornerMask ) {\n\t\tsuper( new Float32Array( 56 ), new Float32Array( 56 ), new Uint16Array( 42 ) );\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._texture = texture;\n\t\tthis._borderSize = borderSize;\n\t\tthis._cornerMask = cornerMask;\n\t\tthis._isDirty = true;\n\t\tthis._textureId = NaN;\n\n\t\tthis._vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tthis._vertices = this._vertexBuffer.data as Float32Array;\n\t\tthis._uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tthis._uvs = this._uvBuffer.data as Float32Array;\n\t\tthis._indexBuffer = this.getIndex();\n\t\tthis._indices = this._indexBuffer.data as Uint16Array;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this._borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tif( this._borderSize !== borderSize ) {\n\t\t\tthis._borderSize = borderSize;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this._cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tif( this._cornerMask !== cornerMask ) {\n\t\t\tthis._cornerMask = cornerMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tif( this._height !== height ) {\n\t\t\tthis._height = height;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this._texture !== texture ) {\n\t\t\tthis._texture = texture;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._textureId = NaN;\n\t\t}\n\t}\n\n\tprotected getTextureId(): number {\n\t\treturn (this._texture as any)._updateID;\n\t}\n\n\tprotected fillVertices( iv: number, array: Float32Array, x0: number, x1: number, y0: number, y1: number ): void {\n\t\tarray[ iv + 0 ] = x0;\n\t\tarray[ iv + 1 ] = y0;\n\t\tarray[ iv + 2 ] = x1;\n\t\tarray[ iv + 3 ] = y0;\n\t\tarray[ iv + 4 ] = x0;\n\t\tarray[ iv + 5 ] = y1;\n\t\tarray[ iv + 6 ] = x1;\n\t\tarray[ iv + 7 ] = y1;\n\t}\n\n\tprotected fillIndices( ii: number, indices: Uint16Array, iv: number ): void {\n\t\tindices[ ii + 0 ] = iv + 0;\n\t\tindices[ ii + 1 ] = iv + 1;\n\t\tindices[ ii + 2 ] = iv + 2;\n\t\tindices[ ii + 3 ] = iv + 1;\n\t\tindices[ ii + 4 ] = iv + 3;\n\t\tindices[ ii + 5 ] = iv + 2;\n\t}\n\n\tprotected fillUvsCorner(\n\t\tiv: number, uvs: Float32Array, c: boolean,\n\t\tu0: number, u1: number, u2: number, u3: number,\n\t\tv0: number, v1: number, v2: number, v3: number\n\t): void {\n\t\tif( c ) {\n\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, u3, u2, v0, v1 );\n\t\t}\n\t}\n\n\tprotected fillUvs( iv: number, uvs: Float32Array, u0: number, u1: number, v0: number, v1: number ): void {\n\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t}\n\n\tupdate(): void {\n\t\tconst texture = this.texture;\n\t\tif( ! texture.valid ) {\n\t\t\treturn;\n\t\t}\n\t\tconst textureId = this.getTextureId();\n\t\tif( this._isDirty || this._textureId !== textureId ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._textureId = textureId;\n\t\t\tconst vertices = this._vertices;\n\t\t\tconst uvs = this._uvs;\n\t\t\tconst indices = this._indices;\n\n\t\t\tconst width = this._width;\n\t\t\tconst height = this._height;\n\t\t\tconst borderSize = this._borderSize;\n\n\t\t\tconst x0 = 0;\n\t\t\tconst x1 = Math.min( width * 0.5, borderSize );\n\t\t\tconst x2 = Math.max( width * 0.5, width - borderSize );\n\t\t\tconst x3 = width;\n\n\t\t\tconst y0 = 0;\n\t\t\tconst y1 = Math.min( height * 0.5, borderSize );\n\t\t\tconst y2 = Math.max( height * 0.5, height - borderSize );\n\t\t\tconst y3 = height;\n\n\t\t\tconst textureUvs: TextureUvs = (texture as any)._uvs;\n\n\t\t\tconst l = textureUvs.x0;\n\t\t\tconst r = textureUvs.x1;\n\t\t\tconst t = textureUvs.y0;\n\t\t\tconst b = textureUvs.y3;\n\t\t\tconst w = (r - l) * (borderSize / texture.width);\n\t\t\tconst h = (b - t) * (borderSize / texture.height);\n\n\t\t\tconst u0 = l;\n\t\t\tconst u1 = l + w;\n\t\t\tconst u2 = r - w;\n\t\t\tconst u3 = r;\n\n\t\t\tconst v0 = t;\n\t\t\tconst v1 = t + h;\n\t\t\tconst v2 = b - h;\n\t\t\tconst v3 = b;\n\n\t\t\tconst cornerMask = this._cornerMask;\n\t\t\tconst ctl = ! (cornerMask & DCornerMask.TOP_LEFT);\n\t\t\tconst ctr = ! (cornerMask & DCornerMask.TOP_RIGHT);\n\t\t\tconst cbl = ! (cornerMask & DCornerMask.BOTTOM_LEFT);\n\t\t\tconst cbr = ! (cornerMask & DCornerMask.BOTTOM_RIGHT);\n\n\t\t\t// Vertices & UVs\n\t\t\tlet iv = 0;\n\t\t\tlet ia = 0;\n\t\t\tlet ii = 0;\n\n\t\t\t// Top left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, ctl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y0, y1 );\n\t\t\tthis.fillUvs( iv, uvs, u1, u2, v0, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, ctr, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle\n\t\t\tthis.fillVertices( iv, vertices, x0, x3, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, u0, u3, v1, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, cbl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y2, y3 );\n\t\t\tthis.fillUvs( iv, uvs, u1, u2, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, cbr, u3, u2, u1, u0, v3, v2, v1, v0 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\n\t\t\tthis._vertexBuffer.update();\n\t\t\tthis._uvBuffer.update();\n\t\t\tthis._indexBuffer.update();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Renderer, Texture } from \"pixi.js\";\nimport { DBaseBackgroundMeshGeometry } from \"./d-base-background-mesh-geometry\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBackgroundMesh extends Mesh {\n\tgeometry!: DBaseBackgroundMeshGeometry;\n\tshader!: MeshMaterial;\n\n\tconstructor( texture: Texture, borderSize: number, cornerMask: DCornerMask ) {\n\t\tsuper(\n\t\t\tnew DBaseBackgroundMeshGeometry( texture, 100, 100, borderSize, cornerMask ),\n\t\t\tnew MeshMaterial( texture )\n\t\t);\n\t}\n\n\t// @ts-ignore\n\tget texture() {\n\t\treturn this.shader.texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this.shader.texture !== texture ) {\n\t\t\tthis.shader.texture = texture;\n\t\t\tthis.geometry.texture = texture;\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget width(): number {\n\t\treturn this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.geometry.width = width;\n\t}\n\n\t// @ts-ignore\n\tget height(): number {\n\t\treturn this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.geometry.height = height;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tthis.geometry.borderSize = borderSize;\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tthis.geometry.cornerMask = cornerMask;\n\t}\n\n\tprotected _render( renderer: Renderer ): void {\n\t\tthis.geometry.update();\n\t\tsuper._render( renderer );\n\t}\n\n\tupdate(): void {\n\t\tthis.geometry.update();\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DRenderable, DThemeBase } from \"./d-base\";\nimport { DBaseBackgroundMesh } from \"./d-base-background-mesh\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBackgroundRenderable implements DRenderable {\n\tprotected _mesh?: DBaseBackgroundMesh;\n\tprotected _cornerRadius: number;\n\n\tconstructor() {\n\t\tthis._cornerRadius = 0;\n\t}\n\n\tprotected get(\n\t\tbase: DBase, theme: DThemeBase,\n\t\tcornerRadius: number, cornerHeight: number, cornerMask: DCornerMask\n\t): DBaseBackgroundMesh {\n\t\tlet result = this._mesh;\n\t\tif( result == null ) {\n\t\t\tresult = new DBaseBackgroundMesh(\n\t\t\t\ttheme.getBackgroundTexture( cornerRadius ),\n\t\t\t\tcornerHeight, cornerMask\n\t\t\t);\n\t\t\t(result as any).parent = base;\n\t\t\tthis._mesh = result;\n\t\t\tthis._cornerRadius = cornerRadius;\n\t\t}\n\t\tif( this._cornerRadius !== cornerRadius ) {\n\t\t\tthis._cornerRadius = cornerRadius;\n\t\t\tresult.texture = theme.getBackgroundTexture( cornerRadius );\n\t\t\tresult.borderSize = cornerHeight;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected hide() {\n\t\tconst mesh = this._mesh;\n\t\tif( mesh != null ) {\n\t\t\tmesh.visible = false;\n\t\t}\n\t}\n\n\tonReflow(\n\t\tbase: DBase, width: number, height: number,\n\t\ttheme: DThemeBase, state: DBaseStateSet,\n\t\tcornerRadius: number, cornerHeight: number, cornerMask: DCornerMask\n\t): void {\n\t\tconst background = base.background;\n\t\tconst backgroundColor = background.getColor( state );\n\t\tif( backgroundColor != null ) {\n\t\t\tconst backgroundAlpha = background.getAlpha( state );\n\t\t\tif( 0 < backgroundAlpha ) {\n\t\t\t\tconst backgroundMesh = this.get( base, theme, cornerRadius, cornerHeight, cornerMask );\n\t\t\t\tbackgroundMesh.tint = backgroundColor;\n\t\t\t\tbackgroundMesh.alpha = backgroundAlpha;\n\t\t\t\tbackgroundMesh.width = width;\n\t\t\t\tbackgroundMesh.height = height;\n\t\t\t\tbackgroundMesh.cornerMask = cornerMask;\n\t\t\t\tbackgroundMesh.visible = true;\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\trender( renderer: PIXI.Renderer ): void {\n\t\tthis._mesh?.render( renderer );\n\t}\n\n\tupdateTransform(): void {\n\t\tthis._mesh?.updateTransform();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, MeshGeometry, Texture, TextureUvs } from \"pixi.js\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBorderMeshGeometry extends MeshGeometry {\n\tprotected _texture: Texture;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _borderSize: number;\n\tprotected _borderMask: DBorderMask;\n\tprotected _cornerMask: DCornerMask;\n\tprotected _isDirty: boolean;\n\tprotected _textureId: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _vertexBuffer: Buffer;\n\tprotected _uvBuffer: Buffer;\n\tprotected _indexBuffer: Buffer;\n\n\tconstructor(\n\t\ttexture: Texture, width: number, height: number,\n\t\tborderSize: number, borderMask: DBorderMask, cornerMask: DCornerMask\n\t) {\n\t\tsuper( new Float32Array( 64 ), new Float32Array( 64 ), new Uint16Array( 48 ) );\n\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._texture = texture;\n\t\tthis._borderSize = borderSize;\n\t\tthis._borderMask = borderMask;\n\t\tthis._cornerMask = cornerMask;\n\t\tthis._isDirty = true;\n\t\tthis._textureId = NaN;\n\n\t\tthis._vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tthis._vertices = this._vertexBuffer.data as Float32Array;\n\t\tthis._uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tthis._uvs = this._uvBuffer.data as Float32Array;\n\t\tthis._indexBuffer = this.getIndex();\n\t\tthis._indices = this._indexBuffer.data as Uint16Array;\n\t}\n\n\tget borderMask(): DBorderMask {\n\t\treturn this._borderMask;\n\t}\n\n\tset borderMask( borderMask: DBorderMask ) {\n\t\tif( this._borderMask !== borderMask ) {\n\t\t\tthis._borderMask = borderMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this._cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tif( this._cornerMask !== cornerMask ) {\n\t\t\tthis._cornerMask = cornerMask;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget borderSize(): number {\n\t\treturn this._borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tif( this._borderSize !== borderSize ) {\n\t\t\tthis._borderSize = borderSize;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tif( this._width !== width ) {\n\t\t\tthis._width = width;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tif( this._height !== height ) {\n\t\t\tthis._height = height;\n\t\t\tthis._isDirty = true;\n\t\t}\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this._texture !== texture ) {\n\t\t\tthis._texture = texture;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._textureId = NaN;\n\t\t}\n\t}\n\n\tprotected fillVertices( iv: number, array: Float32Array, x0: number, x1: number, y0: number, y1: number ): void {\n\t\tarray[ iv + 0 ] = x0;\n\t\tarray[ iv + 1 ] = y0;\n\t\tarray[ iv + 2 ] = x1;\n\t\tarray[ iv + 3 ] = y0;\n\t\tarray[ iv + 4 ] = x0;\n\t\tarray[ iv + 5 ] = y1;\n\t\tarray[ iv + 6 ] = x1;\n\t\tarray[ iv + 7 ] = y1;\n\t}\n\n\tprotected fillIndices( ii: number, indices: Uint16Array, iv: number ): void {\n\t\tindices[ ii + 0 ] = iv + 0;\n\t\tindices[ ii + 1 ] = iv + 1;\n\t\tindices[ ii + 2 ] = iv + 2;\n\t\tindices[ ii + 3 ] = iv + 1;\n\t\tindices[ ii + 4 ] = iv + 3;\n\t\tindices[ ii + 5 ] = iv + 2;\n\t}\n\n\tprotected fillUvsCorner(\n\t\tiv: number, uvs: Float32Array, b1: boolean, b2: boolean, c: boolean,\n\t\tu0: number, u1: number, u2: number, u3: number,\n\t\tv0: number, v1: number, v2: number, v3: number\n\t): void {\n\t\tif( b1 || b2 ) {\n\t\t\tif( c ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t\t} else if( b1 && b2 ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u3, u2, v0, v1 );\n\t\t\t} else if( b1 ) {\n\t\t\t\tthis.fillVertices( iv, uvs, u1, u2, v0, v1 );\n\t\t\t} else {\n\t\t\t\tthis.fillVertices( iv, uvs, u0, u1, v1, v2 );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, u1, u1, v1, v1 );\n\t\t}\n\t}\n\n\tprotected fillUvs(\n\t\tiv: number, uvs: Float32Array, b: boolean,\n\t\tu0: number, u1: number, v0: number, v1: number,\n\t\tuz: number, vz: number\n\t): void {\n\t\tif( b ) {\n\t\t\tthis.fillVertices( iv, uvs, u0, u1, v0, v1 );\n\t\t} else {\n\t\t\tthis.fillVertices( iv, uvs, uz, uz, vz, vz );\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tconst texture = this._texture;\n\t\tif( ! texture.valid ) {\n\t\t\treturn;\n\t\t}\n\t\tconst textureId: number = (texture as any)._updateID;\n\t\tif( this._isDirty || this._textureId !== textureId ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis._textureId = textureId;\n\t\t\tconst vertices = this._vertices;\n\t\t\tconst uvs = this._uvs;\n\t\t\tconst indices = this._indices;\n\n\t\t\tconst width = this._width;\n\t\t\tconst height = this._height;\n\t\t\tconst borderSize = this._borderSize;\n\n\t\t\tconst x0 = 0;\n\t\t\tconst x1 = Math.min( width * 0.5, borderSize );\n\t\t\tconst x2 = Math.max( width * 0.5, width - borderSize );\n\t\t\tconst x3 = width;\n\n\t\t\tconst y0 = 0;\n\t\t\tconst y1 = Math.min( height * 0.5, borderSize );\n\t\t\tconst y2 = Math.max( height * 0.5, height - borderSize );\n\t\t\tconst y3 = height;\n\n\t\t\tconst textureUvs: TextureUvs = (texture as any)._uvs;\n\n\t\t\tconst l = textureUvs.x0;\n\t\t\tconst r = textureUvs.x1;\n\t\t\tconst t = textureUvs.y0;\n\t\t\tconst b = textureUvs.y3;\n\t\t\tconst w = (r - l) * (borderSize / texture.width);\n\t\t\tconst h = (b - t) * (borderSize / texture.height);\n\n\t\t\tconst u0 = l;\n\t\t\tconst u1 = l + w;\n\t\t\tconst u2 = r - w;\n\t\t\tconst u3 = r;\n\n\t\t\tconst v0 = t;\n\t\t\tconst v1 = t + h;\n\t\t\tconst v2 = b - h;\n\t\t\tconst v3 = b;\n\n\t\t\tconst borderMask = this._borderMask;\n\t\t\tconst bt = ! (borderMask & DBorderMask.TOP);\n\t\t\tconst bb = ! (borderMask & DBorderMask.BOTTOM);\n\t\t\tconst bl = ! (borderMask & DBorderMask.LEFT);\n\t\t\tconst br = ! (borderMask & DBorderMask.RIGHT);\n\n\t\t\tconst cornerMask = this._cornerMask;\n\t\t\tconst ctl = ! (cornerMask & DCornerMask.TOP_LEFT);\n\t\t\tconst ctr = ! (cornerMask & DCornerMask.TOP_RIGHT);\n\t\t\tconst cbl = ! (cornerMask & DCornerMask.BOTTOM_LEFT);\n\t\t\tconst cbr = ! (cornerMask & DCornerMask.BOTTOM_RIGHT);\n\n\t\t\t// Vertices & UVs\n\t\t\tlet iv = 0;\n\t\t\tlet ia = 0;\n\t\t\tlet ii = 0;\n\n\t\t\t// Top left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bt, bl, ctl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y0, y1 );\n\t\t\tthis.fillUvs( iv, uvs, bt, u1, u2, v0, v1, u1, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Top right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y0, y1 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bt, br, ctr, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, bl, u0, u1, v1, v2, u1, v1 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Middle right\n\t\t\tthis.fillVertices( iv, vertices, x2, x3, y1, y2 );\n\t\t\tthis.fillUvs( iv, uvs, br, u2, u3, v1, v2, u2, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom left\n\t\t\tthis.fillVertices( iv, vertices, x0, x1, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bb, bl, cbl, u0, u1, u2, u3, v0, v1, v2, v3 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom middle\n\t\t\tthis.fillVertices( iv, vertices, x1, x2, y2, y3 );\n\t\t\tthis.fillUvs( iv, uvs, bb, u1, u2, v2, v3, u2, v2 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\t\t\tiv += 8;\n\t\t\tia += 4;\n\t\t\tii += 6;\n\n\t\t\t// Bottom right\n\t\t\tthis.fillVertices( iv, vertices, x3, x2, y3, y2 );\n\t\t\tthis.fillUvsCorner( iv, uvs, bb, br, cbr, u3, u2, u1, u0, v3, v2, v1, v0 );\n\t\t\tthis.fillIndices( ii, indices, ia );\n\n\t\t\tthis._vertexBuffer.update();\n\t\t\tthis._uvBuffer.update();\n\t\t\tthis._indexBuffer.update();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Renderer, Texture } from \"pixi.js\";\nimport { DBaseBorderMeshGeometry } from \"./d-base-border-mesh-geometry\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBorderMesh extends Mesh {\n\tgeometry!: DBaseBorderMeshGeometry;\n\tshader!: MeshMaterial;\n\n\tconstructor( texture: Texture, borderSize: number, borderMask: DBorderMask, cornerMask: DCornerMask ) {\n\t\tsuper(\n\t\t\tnew DBaseBorderMeshGeometry( texture, 100, 100, borderSize, borderMask, cornerMask ),\n\t\t\tnew MeshMaterial( texture )\n\t\t);\n\t}\n\n\t// @ts-ignore\n\tget texture() {\n\t\treturn this.shader.texture;\n\t}\n\n\tset texture( texture: Texture ) {\n\t\tif( this.shader.texture !== texture ) {\n\t\t\tthis.shader.texture = texture;\n\t\t\tthis.geometry.texture = texture;\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget width(): number {\n\t\treturn this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.geometry.width = width;\n\t}\n\n\t// @ts-ignore\n\tget height(): number {\n\t\treturn this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.geometry.height = height;\n\t}\n\n\tget borderSize(): number {\n\t\treturn this.geometry.borderSize;\n\t}\n\n\tset borderSize( borderSize: number ) {\n\t\tthis.geometry.borderSize = borderSize;\n\t}\n\n\tget borderMask(): DBorderMask {\n\t\treturn this.geometry.borderMask;\n\t}\n\n\tset borderMask( borderMask: DBorderMask ) {\n\t\tthis.geometry.borderMask = borderMask;\n\t}\n\n\tget cornerMask(): DCornerMask {\n\t\treturn this.geometry.cornerMask;\n\t}\n\n\tset cornerMask( cornerMask: DCornerMask ) {\n\t\tthis.geometry.cornerMask = cornerMask;\n\t}\n\n\tprotected _render( renderer: Renderer ): void {\n\t\tthis.geometry.update();\n\t\tsuper._render( renderer );\n\t}\n\n\tupdate(): void {\n\t\tthis.geometry.update();\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DRenderable, DThemeBase } from \"./d-base\";\nimport { DBaseBorderMesh } from \"./d-base-border-mesh\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseBorderRenderable implements DRenderable {\n\tprotected _mesh?: DBaseBorderMesh;\n\tprotected _cornerRadius: number;\n\tprotected _borderWidth: number;\n\n\tconstructor() {\n\t\tthis._cornerRadius = 0;\n\t\tthis._borderWidth = 0;\n\t}\n\n\tprotected get(\n\t\tbase: DBase, theme: DThemeBase,\n\t\tcornerRadius: number, cornerHeight: number, cornerMask: DCornerMask,\n\t\tborderWidth: number, borderMask: DBorderMask\n\t): DBaseBorderMesh {\n\t\tlet result = this._mesh;\n\t\tif( result == null ) {\n\t\t\tresult = new DBaseBorderMesh(\n\t\t\t\ttheme.getBorderTexture( cornerRadius, borderWidth ),\n\t\t\t\tcornerHeight,\n\t\t\t\tborderMask,\n\t\t\t\tcornerMask\n\t\t\t);\n\t\t\t(result as any).parent = base;\n\t\t\tthis._mesh = result;\n\t\t\tthis._cornerRadius = cornerRadius;\n\t\t}\n\t\tif( this._cornerRadius !== cornerRadius || this._borderWidth !== borderWidth ) {\n\t\t\tthis._cornerRadius = cornerRadius;\n\t\t\tthis._borderWidth = borderWidth;\n\t\t\tresult.texture = theme.getBorderTexture( cornerRadius, borderWidth );\n\t\t\tresult.borderSize = cornerHeight;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected hide() {\n\t\tconst mesh = this._mesh;\n\t\tif( mesh != null ) {\n\t\t\tmesh.visible = false;\n\t\t}\n\t}\n\n\tonReflow(\n\t\tbase: DBase, width: number, height: number,\n\t\ttheme: DThemeBase, state: DBaseStateSet,\n\t\tcornerRadius: number, cornerHeight: number, cornerMask: DCornerMask\n\t): void {\n\t\tconst border = base.border;\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tif( 0 < borderAlpha ) {\n\t\t\t\tconst borderWidth = border.getWidth( state );\n\t\t\t\tconst borderMask = border.getMask( state );\n\t\t\t\tconst borderMesh = this.get( base, theme, cornerRadius, cornerHeight, cornerMask, borderWidth, borderMask );\n\t\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\t\tconst borderOffset = borderAlign * borderWidth;\n\t\t\t\tborderMesh.tint = borderColor;\n\t\t\t\tborderMesh.alpha = borderAlpha;\n\t\t\t\tborderMesh.x = -borderOffset;\n\t\t\t\tborderMesh.y = -borderOffset;\n\t\t\t\tborderMesh.width = width + borderOffset * 2;\n\t\t\t\tborderMesh.height = height + borderOffset * 2;\n\t\t\t\tborderMesh.borderMask = borderMask;\n\t\t\t\tborderMesh.cornerMask = cornerMask;\n\t\t\t\tborderMesh.visible = true;\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\trender( renderer: PIXI.Renderer ): void {\n\t\tthis._mesh?.render( renderer );\n\t}\n\n\tupdateTransform(): void {\n\t\tthis._mesh?.updateTransform();\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DRenderable, DThemeBase } from \"./d-base\";\nimport { DBaseBorderMesh } from \"./d-base-border-mesh\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseOutlineRenderable implements DRenderable {\n\tprotected _mesh?: DBaseBorderMesh;\n\tprotected _cornerRadius: number;\n\tprotected _outlineWidth: number;\n\n\tconstructor() {\n\t\tthis. _cornerRadius = 0;\n\t\tthis. _outlineWidth = 0;\n\t}\n\n\tprotected get(\n\t\tbase: DBase, theme: DThemeBase,\n\t\tcornerRadius: number, cornerHeight: number, cornerMask: DCornerMask,\n\t\toutlineWidth: number, outlineMask: DBorderMask\n\t): DBaseBorderMesh {\n\t\tlet result = this._mesh;\n\t\tif( result == null ) {\n\t\t\tresult = new DBaseBorderMesh(\n\t\t\t\ttheme.getBorderTexture( cornerRadius, outlineWidth ),\n\t\t\t\tcornerHeight,\n\t\t\t\toutlineMask,\n\t\t\t\tcornerMask\n\t\t\t);\n\t\t\t(result as any).parent = base;\n\t\t\tthis._mesh = result;\n\t\t\tthis._cornerRadius = cornerRadius;\n\t\t\tthis._outlineWidth = outlineWidth;\n\t\t}\n\t\tif( this._cornerRadius !== cornerRadius || this._outlineWidth !== outlineWidth ) {\n\t\t\tthis._cornerRadius = cornerRadius;\n\t\t\tthis._outlineWidth = outlineWidth;\n\t\t\tresult.texture = theme.getBorderTexture( cornerRadius, outlineWidth );\n\t\t\tresult.borderSize = cornerHeight;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected hide() {\n\t\tconst mesh = this._mesh;\n\t\tif( mesh != null ) {\n\t\t\tmesh.visible = false;\n\t\t}\n\t}\n\n\tonReflow(\n\t\tbase: DBase, width: number, height: number,\n\t\ttheme: DThemeBase, state: DBaseStateSet,\n\t\tcornerRadius: number, cornerHeight: number, cornerMask: DCornerMask\n\t): void {\n\t\tconst outline = base.outline;\n\t\tconst outlineColor = outline.getColor( state );\n\t\tif( outlineColor != null ) {\n\t\t\tconst outlineAlpha = outline.getAlpha( state );\n\t\t\tif( 0 < outlineAlpha ) {\n\t\t\t\tconst outlineWidth = outline.getWidth( state );\n\t\t\t\tconst outlineMask = outline.getMask( state );\n\t\t\t\tconst outlineMesh = this.get( base, theme, cornerRadius, cornerHeight, cornerMask, outlineWidth, outlineMask );\n\t\t\t\tconst outlineOffset = outline.getOffset( state );\n\t\t\t\tconst outlineAlign = outline.getAlign( state );\n\t\t\t\tconst outlineOffsetAccumulative = outlineOffset + outlineAlign * outlineWidth;\n\t\t\t\toutlineMesh.tint = outlineColor;\n\t\t\t\toutlineMesh.alpha = outlineAlpha;\n\t\t\t\toutlineMesh.x = -outlineOffsetAccumulative;\n\t\t\t\toutlineMesh.y = -outlineOffsetAccumulative;\n\t\t\t\toutlineMesh.width = width + outlineOffsetAccumulative * 2;\n\t\t\t\toutlineMesh.height = height + outlineOffsetAccumulative * 2;\n\t\t\t\toutlineMesh.borderMask = outlineMask;\n\t\t\t\toutlineMesh.cornerMask = cornerMask;\n\t\t\t\toutlineMesh.visible = true;\n\t\t\t} else {\n\t\t\t\tthis.hide();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.hide();\n\t\t}\n\t}\n\n\trender( renderer: PIXI.Renderer ): void {\n\t\tthis._mesh?.render( renderer );\n\t}\n\n\tupdateTransform(): void {\n\t\tthis._mesh?.updateTransform();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DBaseBackgroundRenderable } from \"./d-base-background-renderable\";\nimport { DBaseBorderRenderable } from \"./d-base-border-renderable\";\nimport { DBaseOutlineRenderable } from \"./d-base-outline-renderable\";\n\nexport class DBaseReflowable implements DReflowable {\n\tprotected _background: DBaseBackgroundRenderable;\n\tprotected _border: DBaseBorderRenderable;\n\tprotected _outline: DBaseOutlineRenderable;\n\n\tconstructor( base: DBase ) {\n\t\tconst background = new DBaseBackgroundRenderable();\n\t\tthis._background = background;\n\t\tbase.addRenderable( background, true );\n\n\t\tconst border = new DBaseBorderRenderable();\n\t\tthis._border = border;\n\t\tbase.addRenderable( border, false );\n\n\t\tconst outline = new DBaseOutlineRenderable();\n\t\tthis._outline = outline;\n\t\tbase.addRenderable( outline, false );\n\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst theme = base.theme;\n\t\tconst state = base.state;\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = corner.getRadius();\n\t\tconst cornerHeight = cornerRadius + 1;\n\t\tconst cornerMask = corner.getMask();\n\t\tthis._background.onReflow(\n\t\t\tbase, width, height, theme, state,\n\t\t\tcornerRadius, cornerHeight, cornerMask\n\t\t);\n\t\tthis._border.onReflow(\n\t\t\tbase, width, height, theme, state,\n\t\t\tcornerRadius, cornerHeight, cornerMask\n\t\t);\n\t\tthis._outline.onReflow(\n\t\t\tbase, width, height, theme, state,\n\t\t\tcornerRadius, cornerHeight, cornerMask\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DMouseModifier {\n\tNONE\t\t= 0,\n\tCTRL\t\t= 1,\n\tSHIFT\t\t= 2,\n\tALT\t\t\t= 4,\n\n\tAND\t\t\t= 8,\n\tOR\t\t\t= 16,\n\n\tNOT_NONE\t= CTRL | SHIFT | ALT | OR\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinatePosition, DCoordinateSizeNoAuto } from \"./d-coordinate\";\nimport { DScalarExpression } from \"./d-scalar-expression\";\nimport { DScalarFunction } from \"./d-scalar-function\";\nimport { isFunction } from \"./util/is-function\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nconst POSITION_CENTER = ( p: number, s: number ) => ( p - s ) * 0.5;\nconst POSITION_PADDING = ( p: number, s: number, d: number ) => d;\nconst SIZE_MAXIMIZED = ( p: number ) => p;\nconst SIZE_PADDING = ( p: number, s: number, d: number ) => p - d;\n\nexport class DScalarFunctions {\n\tstatic position( coordinate: DCoordinatePosition | undefined ): DScalarFunction | null {\n\t\tif( coordinate == null || isNumber( coordinate ) ) {\n\t\t\treturn null;\n\t\t} else if( isString( coordinate ) ) {\n\t\t\tswitch( coordinate ) {\n\t\t\tcase \"center\":\n\t\t\tcase \"CENTER\":\n\t\t\t\treturn POSITION_CENTER;\n\t\t\tcase \"padding\":\n\t\t\tcase \"PADDING\":\n\t\t\t\treturn POSITION_PADDING;\n\t\t\t}\n\n\t\t\tconst scalarExpression = new DScalarExpression( coordinate );\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalarExpression.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t} else if( isFunction( coordinate ) ) {\n\t\t\treturn coordinate;\n\t\t} else {\n\t\t\tconst scalar = coordinate;\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalar.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic size( coordinate: DCoordinateSizeNoAuto | undefined ): DScalarFunction | null {\n\t\tif( coordinate == null || isNumber( coordinate ) ) {\n\t\t\treturn null;\n\t\t} else if( isString( coordinate ) ) {\n\t\t\tswitch( coordinate ) {\n\t\t\tcase \"100%\":\n\t\t\tcase \"maximized\":\n\t\t\tcase \"MAXIMIZED\":\n\t\t\t\treturn SIZE_MAXIMIZED;\n\t\t\tcase \"padding\":\n\t\t\tcase \"PADDING\":\n\t\t\t\treturn SIZE_PADDING;\n\t\t\t}\n\n\t\t\tconst scalarExpression = new DScalarExpression( coordinate );\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalarExpression.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t} else if( isFunction( coordinate ) ) {\n\t\t\treturn coordinate;\n\t\t} else {\n\t\t\tconst scalar = coordinate;\n\t\t\treturn ( parent: number, self: number, padding: number, current: number ): number => {\n\t\t\t\treturn scalar.calculate( parent, self, padding, current );\n\t\t\t};\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction, Point } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplicationTarget } from \"../d-application-like\";\nimport { DApplications } from \"../d-applications\";\n\nexport type UtilPointerEventOnClick = ( e: InteractionEvent ) => void;\n\nexport type UtilPointerEventIsLongClickable = ( e: InteractionEvent ) => boolean;\n\nexport interface UtilPointerEventClickTarget extends DApplicationTarget {\n\ton( name: string, handler: UtilPointerEventOnClick ): void;\n}\n\nexport class UtilPointerEvent {\n\tstatic CLICK_DISTANCE_THRESHOLD: number = 10;\n\tstatic DBLCLICK_INTERVAL_THRESHOLD: number = 333;\n\tstatic LONG_CLICK_THRESHOLD: number = 750;\n\n\tstatic get touchable(): boolean {\n\t\treturn ( \"ontouchstart\" in document );\n\t}\n\n\tstatic get tap(): string {\n\t\treturn \"pointertap\";\n\t}\n\n\tstatic get down(): string {\n\t\treturn \"pointerdown\";\n\t}\n\n\tstatic get enter(): string {\n\t\treturn \"pointerenter\";\n\t}\n\n\tstatic get leave(): string {\n\t\treturn \"pointerleave\";\n\t}\n\n\tstatic get move(): string {\n\t\treturn \"pointermove\";\n\t}\n\n\tstatic get out(): string {\n\t\treturn \"pointerout\";\n\t}\n\n\tstatic get over(): string {\n\t\treturn \"pointerover\";\n\t}\n\n\tstatic get up(): string {\n\t\treturn \"pointerup\";\n\t}\n\n\tstatic get cancel(): string {\n\t\treturn \"pointercancel\";\n\t}\n\n\tstatic toGlobal(\n\t\te: MouseEvent | TouchEvent,\n\t\tinteractionManager: interaction.InteractionManager,\n\t\tresult: Point\n\t): Point {\n\t\tif( \"touches\" in e ) {\n\t\t\tconst touches = e.changedTouches;\n\t\t\tconst touch = touches[ touches.length - 1 ];\n\t\t\tif( touch != null ) {\n\t\t\t\tinteractionManager.mapPositionToPoint( result, touch.clientX, touch.clientY );\n\t\t\t} else {\n\t\t\t\tinteractionManager.mapPositionToPoint( result, 0, 0 );\n\t\t\t}\n\t\t} else {\n\t\t\tinteractionManager.mapPositionToPoint( result, e.clientX, e.clientY );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected static isValidDistance( e: InteractionEvent, x: number, y: number ): boolean {\n\t\tconst global = e.data.global;\n\t\tconst dx = Math.abs( x - global.x );\n\t\tconst dy = Math.abs( y - global.y );\n\t\tconst threshold = this.CLICK_DISTANCE_THRESHOLD;\n\t\treturn ( dx < threshold && dy < threshold );\n\t};\n\n\tstatic onClick( target: UtilPointerEventClickTarget, onClick: UtilPointerEventOnClick ): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.on( \"click\", onClick );\n\t\t} else {\n\t\t\tlet isDowned = false;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet interactionManagerBound: interaction.InteractionManager | null = null;\n\t\t\tconst cleanup = (): void => {\n\t\t\t\tisDowned = false;\n\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\ttarget.on( \"click\", ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t\tonClick( e );\n\t\t\t});\n\t\t\tconst up = this.up;\n\t\t\tconst onUp = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( this.isValidDistance( e, downX, downY ) ) {\n\t\t\t\t\t\t\tonClick( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\ttarget.on( this.down, ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t} else {\n\t\t\t\t\tisDowned = true;\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t\t}\n\t\t\t\t\tconst layer = DApplications.getLayer( target );\n\t\t\t\t\tif( layer ) {\n\t\t\t\t\t\tinteractionManagerBound = layer.renderer.plugins.interaction;\n\t\t\t\t\t\tinteractionManagerBound.once( up, onUp );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic onLongClick(\n\t\ttarget: UtilPointerEventClickTarget,\n\t\tonClick: UtilPointerEventOnClick,\n\t\tonLongClick: UtilPointerEventOnClick,\n\t\tisLongClickable?: UtilPointerEventIsLongClickable\n\t): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.on( \"click\", onClick );\n\t\t} else {\n\t\t\tlet isDowned = false;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet timeoutId: number | null = null;\n\t\t\tlet interactionManagerBound: interaction.InteractionManager | null = null;\n\t\t\tconst cleanupTimeout = (): void => {\n\t\t\t\tif( timeoutId != null ) {\n\t\t\t\t\tclearTimeout( timeoutId );\n\t\t\t\t\ttimeoutId = null;\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst cleanup = (): void => {\n\t\t\t\tisDowned = false;\n\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\tinteractionManagerBound.off( move, onMove );\n\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t}\n\t\t\t\tcleanupTimeout();\n\t\t\t};\n\t\t\ttarget.on( \"click\", ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t}\n\t\t\t\tonClick( e );\n\t\t\t});\n\t\t\tconst up = this.up;\n\t\t\tconst move = this.move;\n\t\t\tconst onUp = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tcleanup();\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( this.isValidDistance( e, downX, downY ) ) {\n\t\t\t\t\t\t\tonClick( e );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst onMove = ( e: InteractionEvent ): void => {\n\t\t\t\tif( isDowned ) {\n\t\t\t\t\tif( this.contains( target, e.target ) ) {\n\t\t\t\t\t\tif( ! this.isValidDistance( e, downX, downY ) ) {\n\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\ttarget.on( this.down, ( e: InteractionEvent ): void => {\n\t\t\t\tif( ! isDowned ) {\n\t\t\t\t\tisDowned = true;\n\t\t\t\t\tconst global = e.data.global;\n\t\t\t\t\tdownX = global.x;\n\t\t\t\t\tdownY = global.y;\n\t\t\t\t\tcleanupTimeout();\n\t\t\t\t\tconst oe = e.data.originalEvent;\n\t\t\t\t\tif( (\"touches\" in oe) && (isLongClickable == null || isLongClickable( e )) ) {\n\t\t\t\t\t\ttimeoutId = window.setTimeout((): void => {\n\t\t\t\t\t\t\tif( isDowned ) {\n\t\t\t\t\t\t\t\tcleanup();\n\t\t\t\t\t\t\t\tonLongClick( e );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}, this.LONG_CLICK_THRESHOLD );\n\t\t\t\t\t}\n\t\t\t\t\tif( interactionManagerBound ) {\n\t\t\t\t\t\tinteractionManagerBound.off( up, onUp );\n\t\t\t\t\t\tinteractionManagerBound.off( move, onMove );\n\t\t\t\t\t\tinteractionManagerBound = null;\n\t\t\t\t\t}\n\t\t\t\t\tconst layer = DApplications.getLayer( target );\n\t\t\t\t\tif( layer ) {\n\t\t\t\t\t\tinteractionManagerBound = layer.renderer.plugins.interaction;\n\t\t\t\t\t\tinteractionManagerBound.once( up, onUp );\n\t\t\t\t\t\tinteractionManagerBound.on( move, onMove );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic onDblClick( target: HTMLElement, handler: ( e: MouseEvent | TouchEvent ) => void ): void {\n\t\tif( ! this.touchable ) {\n\t\t\ttarget.addEventListener( \"dblclick\", handler );\n\t\t} else {\n\t\t\tlet isDowned = 0;\n\t\t\tlet downX = 0;\n\t\t\tlet downY = 0;\n\t\t\tlet clickTime = 0;\n\n\t\t\ttarget.addEventListener( \"dblclick\", handler );\n\n\t\t\ttarget.addEventListener( \"touchend\", ( e: TouchEvent ): void => {\n\t\t\t\tif( isDowned === 1 || isDowned === 3 ) {\n\t\t\t\t\tconst touches = e.changedTouches;\n\t\t\t\t\tconst touch: Touch | null = touches[ touches.length - 1 ];\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tconst dx = downX - touch.clientX;\n\t\t\t\t\t\tconst dy = downY - touch.clientY;\n\t\t\t\t\t\tif( Math.abs( dx ) + Math.abs( dy ) < this.CLICK_DISTANCE_THRESHOLD ) {\n\t\t\t\t\t\t\tisDowned += 1;\n\t\t\t\t\t\t\tif( isDowned === 4 ) {\n\t\t\t\t\t\t\t\tisDowned = 0;\n\t\t\t\t\t\t\t\tconst elapsedTime = e.timeStamp - clickTime;\n\t\t\t\t\t\t\t\tif( elapsedTime < this.DBLCLICK_INTERVAL_THRESHOLD ) {\n\t\t\t\t\t\t\t\t\thandler( e );\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tclickTime = e.timeStamp;\n\t\t\t\t\t\t\t\t\tisDowned = 2;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tclickTime = e.timeStamp;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tisDowned = 0;\n\t\t\t});\n\n\t\t\ttarget.addEventListener( \"touchstart\", ( e: TouchEvent ): void => {\n\t\t\t\tif( isDowned === 0 ) {\n\t\t\t\t\tconst touch: Touch | null = e.touches.item( e.touches.length - 1 );\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tisDowned = 1;\n\t\t\t\t\t\tdownX = touch.clientX;\n\t\t\t\t\t\tdownY = touch.clientY;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if( isDowned === 2 ) {\n\t\t\t\t\tconst touch: Touch | null = e.touches.item( e.touches.length - 1 );\n\t\t\t\t\tif( touch != null ) {\n\t\t\t\t\t\tisDowned = 3;\n\t\t\t\t\t\tdownX = touch.clientX;\n\t\t\t\t\t\tdownY = touch.clientY;\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tisDowned = 0;\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic contains( target: unknown, targetOrChild: DisplayObject | null ): boolean {\n\t\tlet current = targetOrChild;\n\t\twhile( current != null && current !== target ) {\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\treturn current === target;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCoordinateSize } from \"./d-coordinate\";\n\nexport class DBaseAuto {\n\tprotected _isOn: boolean;\n\n\tconstructor() {\n\t\tthis._isOn = false;\n\t}\n\n\tget isOff(): boolean {\n\t\treturn ! this._isOn;\n\t}\n\n\tget isOn(): boolean {\n\t\treturn this._isOn;\n\t}\n\n\ttoCoordinate( def: DCoordinateSize ): DCoordinateSize {\n\t\treturn ( this._isOn ? \"auto\" : def );\n\t}\n\n\t/**\n\t * Update the auto settings by the given size.\n\t *\n\t * @param size a size\n\t * @returns True if the given size is \"auto\".\n\t */\n\tfrom( size: DCoordinateSize ): boolean {\n\t\tif( size === \"auto\" || size === \"AUTO\" ) {\n\t\t\tthis._isOn = true;\n\t\t\treturn true;\n\t\t}\n\t\tthis._isOn = false;\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseAuto } from \"./d-base-auto\";\n\nexport class DBaseAutoSet {\n\treadonly width: DBaseAuto;\n\treadonly height: DBaseAuto;\n\n\tconstructor() {\n\t\tthis.width = new DBaseAuto();\n\t\tthis.height = new DBaseAuto();\n\t}\n}\n","import { isString } from \"./is-string\"\n\nexport const toEnum = <TE>( target: keyof TE | TE[ keyof TE ], te: TE ): TE[ keyof TE ] => {\n\treturn isString( target ) ? (te as any)[ target ] : target;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject, interaction, Point, Rectangle, Renderer, Texture, Transform } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport InteractionManager = interaction.InteractionManager;\nimport { DApplications } from \"./d-applications\";\nimport { DBackgroundStateAware } from \"./d-background\";\nimport { DBaseBackground } from \"./d-base-background\";\nimport { DBaseBorder } from \"./d-base-border\";\nimport { DBaseCorner } from \"./d-base-corner\";\nimport { DBaseInteractive } from \"./d-base-interactive\";\nimport { DBaseOutline } from \"./d-base-outline\";\nimport { DBasePadding } from \"./d-base-padding\";\nimport { DBasePoint } from \"./d-base-point\";\nimport { DBaseReflowable } from \"./d-base-reflowable\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBaseStateSetImplObservable } from \"./d-base-state-set-impl-observable\";\nimport { DBorderStateAware } from \"./d-border\";\nimport { DBorderMask } from \"./d-border-mask\";\nimport { DCoordinatePosition, DCoordinateSize } from \"./d-coordinate\";\nimport { DCorner } from \"./d-corner\";\nimport { DCornerMask } from \"./d-corner-mask\";\nimport { DThemeFont } from \"./d-font\";\nimport { DLayoutClearType } from \"./d-layout-clear-type\";\nimport { DOutline } from \"./d-outline\";\nimport { DPadding } from \"./d-padding\";\nimport { DScalarFunctions } from \"./d-scalar-functions\";\nimport { DScalarSet } from \"./d-scalar-set\";\nimport { DShadow } from \"./d-shadow\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isFunction } from \"./util/is-function\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\nimport { UtilKeyboardEvent, UtilKeyboardEventShortcut } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\nimport { DBaseAutoSet } from \"./d-base-auto-set\";\nimport { toEnum } from \"./util/to-enum\";\n\n/**\n * {@link DBase} padding options.\n */\nexport interface DBasePaddingOptions {\n\t/** A top padding */\n\ttop?: number;\n\n\t/** A right padding */\n\tright?: number;\n\n\t/** A bottom padding */\n\tbottom?: number;\n\n\t/** A left padding */\n\tleft?: number;\n}\n\n/**\n * {@link DBase} corner options.\n */\nexport interface DBaseCornerOptions {\n\t/** A radius */\n\tradius?: number;\n\n\t/** Masked corners get unrounded. */\n\tmask?: (keyof typeof DCornerMask) | DCornerMask;\n}\n\n/**\n * {@link DBase} events.\n */\nexport interface DBaseEvents<EMITTER> {\n\t/**\n\t * Triggered when an initialization is finished.\n\t *\n\t *     on( \"init\", ( emitter ) => {} )\n\t *\n\t * @param emitter an emitter\n\t */\n\tinit( emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when added to a container.\n\t *\n\t * @param container a container added to\n\t */\n\tadded( container: Container ): void;\n\n\t/**\n\t * Triggered when removed from a container.\n\t *\n\t * @param container a container removed from\n\t */\n\tremoved( container: Container ): void;\n\n\t/**\n\t * Triggered when moved.\n\t *\n\t * @param newX a new x\n\t * @param newY a new y\n\t * @param oldX an old x\n\t * @param oldY an old y\n\t * @param emitter an emitter\n\t */\n\tmove( newX: number, newY: number, oldX: number, oldY: number, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when resized.\n\t *\n\t * @param newWidth a new width\n\t * @param newHeight a new height\n\t * @param oldWidth an old width\n\t * @param oldHeight an old height\n\t * @param emitter an emitter\n\t */\n\tresize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when scaled.\n\t *\n\t * @param newX a new x\n\t * @param newY a new y\n\t * @param oldX an old x\n\t * @param oldY an old y\n\t * @param emitter an emitter\n\t */\n\tscale( newX: number, newY: number, oldX: number, oldY: number, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when skewed.\n\t *\n\t * @param newX a new x\n\t * @param newY a new y\n\t * @param oldX an old x\n\t * @param oldY an old y\n\t * @param emitter an emitter\n\t */\n\tskew( newX: number, newY: number, oldX: number, oldY: number, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a state is changed.\n\t *\n\t * @param newState a new state\n\t * @param oldState an old state\n\t * @param emitter an emitter\n\t */\n\tstatechange( newState: DBaseStateSet, oldState: DBaseStateSet, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a wheel moves.\n\t *\n\t * @param e a wheel event\n\t * @param deltas wheel move amounts\n\t * @param global a point wheel moved\n\t * @param emitter an emitter\n\t */\n\twheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a key gets down.\n\t *\n\t * @param e a keyboard event\n\t * @param emitter an emitter\n\t */\n\tkeydown( e: KeyboardEvent, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a key gets up.\n\t *\n\t * @param e a keyboard event\n\t * @param emitter an emitter\n\t */\n\tkeyup( e: KeyboardEvent, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a pointer gets on an emitter.\n\t *\n\t * @param e an interaction event.\n\t * @param emitter an emitter\n\t */\n\tover( e: InteractionEvent, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a pointer gets out of an emitter.\n\t *\n\t * @param e an interaction event\n\t * @param emitter an emitter\n\t */\n\tout( e: InteractionEvent, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a pointer gets down on an emitter.\n\t *\n\t * @param e an interaction event.\n\t * @param emitter an emitter\n\t */\n\tdown( e: InteractionEvent, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a pointer gets up on an emitter.\n\t *\n\t * @param e an interaction event\n\t * @param emitter an emitter\n\t */\n\tup( e: InteractionEvent, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when an emitter is double clicked.\n\t *\n\t * @param e an event\n\t * @param interactionManager an interaction manager\n\t * @param emitter an emitter\n\t */\n\tdblclick( e: MouseEvent | TouchEvent, interactionManager: InteractionManager, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DBase} \"on\" options.\n */\nexport interface DBaseOnOptions<EMITTER> extends Partial<DBaseEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DBase} background options.\n */\nexport interface DBaseBackgroundOptions {\n\t/**\n\t * A color code or a function returning a color code.\n\t * If a computed value is undefined, falls back to the theme color.\n\t * If a computed value is null, a background is not rendered.\n\t */\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\n\t/**\n\t * An alpha or a function returning an alpha.\n\t * If a computed value is undefined, falls back to an background alpha of a theme.\n\t */\n\talpha?: DStateAwareOrValueMightBe<number>;\n}\n\n/**\n * {@link DBase} border options.\n */\nexport interface DBaseBorderOptions {\n\t/**\n\t * A color code or a function returning a color code.\n\t * If a computed value is undefined, falls back to the theme color.\n\t * If a computed value is null, a background is not rendered.\n\t */\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\n\t/**\n\t * An alpha or a function returning an alpha.\n\t * If a computed value is undefined, falls back to a border alpha of a theme.\n\t */\n\talpha?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * A width or a function returning a width.\n\t * If a computed value is undefined, falls back to a border width of a theme.\n\t */\n\twidth?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * An align or a function returning an align.\n\t * If a computed value is undefined, falls back to a border align of a theme.\n\t * If an align is 0, a border is rendered completely inside of a {@link DBase}.\n\t * If an align is 1, a border is rendered completely outside of a {@link DBase}.\n\t */\n\talign?: DStateAwareOrValueMightBe<number>;\n\n\t/** Masked borders get removed. */\n\tmask?: DStateAwareOrValueMightBe<DBorderMask> | (keyof typeof DBorderMask);\n}\n\n/**\n * {@link DBase} outline optons.\n */\nexport interface DBaseOutlineOptions {\n\t/**\n\t * A color code or a function returning a color code.\n\t * If a computed value is undefined, falls back to the theme color.\n\t * If a computed value is null, a background is not rendered.\n\t */\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\n\t/**\n\t * An alpha or a function returning an alpha.\n\t * If a computed value is undefined, falls back to an outline alpha of a theme.\n\t */\n\talpha?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * A width or a function returning a width.\n\t * If a computed value is undefined, falls back to an outline width of a theme.\n\t */\n\twidth?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * An offset or a function returning an offset.\n\t * If a computed value is undefined, falls back to an outline align of a theme.\n\t * A outline moves to outside when an offset gets larger.\n\t */\n\toffset?: DStateAwareOrValueMightBe<number>;\n\n\t/**\n\t * An align or a function returning an align.\n\t * If a computed value is undefined, falls back to an outline align of a theme.\n\t * If an align is 0, an outline is rendered completely inside.\n\t * If an align is 1, an outline is rendered completely outside.\n\t */\n\talign?: DStateAwareOrValueMightBe<number>;\n\n\t/** Masked outlines get removed. */\n\tmask?: DStateAwareOrValueMightBe<DBorderMask> | (keyof typeof DBorderMask);\n}\n\n/**\n * {@link DBase} options.\n */\nexport interface DBaseOptions<\n\tTHEME extends DThemeBase = DThemeBase,\n\tEMITTER = any\n> {\n\t/**\n\t * A parent.\n\t *\n\t * In the case of UI classes which pop up (e.g., {@link DDialog} and {@link DMenu}),\n\t * if multiple application instances are there, better to set\n\t * this to an `application.stage` so that they pick a right application.\n\t * By default, they assume the last created application is\n\t * the one they belong to at the time when they are created.\n\t */\n\tparent?: Container;\n\n\t/** Children. */\n\tchildren?: Array<DisplayObject | null>;\n\n\t/** A name. */\n\tname?: string;\n\n\t/**\n\t * One of the followings:\n\t * * A X position\n\t * * A position keyword\n\t * * A position expression (Parsed by {@link DScalarExpression})\n\t * * A function returning a X position ({@link DScalarFunction})\n\t * * An object returning a X position ({@link DScalar})\n\t */\n\tx?: DCoordinatePosition;\n\n\t/**\n\t * One of the followings:\n\t * * A Y position\n\t * * A position keyword\n\t * * A position expresion (Parsed by {@link DScalarExpression})\n\t * * A function returning a Y position ({@link DScalarFunction})\n\t * * An object returning a Y position ({@link DScalar})\n\t */\n\ty?: DCoordinatePosition;\n\n\t/**\n\t * One of the followings:\n\t * * A width\n\t * * A size keyword\n\t * * A size expression (Parsed by {@link DScalarExpression})\n\t * * A function returning a width ({@link DScalarFunction})\n\t * * An object returning a width ({@link DScalar})\n\t */\n\twidth?: DCoordinateSize;\n\n\t/**\n\t * One of the followings:\n\t * * A height\n\t * * A size keyword\n\t * * A size expression (Parsed by {@link DScalarExpression})\n\t * * A function returning a hight ({@link DScalarFunction})\n\t * * An object returning a hight ({@link DScalar})\n\t */\n\theight?: DCoordinateSize;\n\n\t/**\n\t * A visibility.\n\t * Set to true to make {@link DBase} visible.\n\t * Set to false to make {@link DBase} invisible.\n\t * The default values is true.\n\t */\n\tvisible?: boolean;\n\n\t/** A default state. */\n\tstate?: string | string[];\n\n\t/** An interactivity option. */\n\tinteractive?: (keyof typeof DBaseInteractive) | DBaseInteractive;\n\n\t/** A padding options. */\n\tpadding?: number | DBasePaddingOptions;\n\n\t/** A corner options. */\n\tcorner?: number | DBaseCornerOptions;\n\n\t/** A theme or a theme name. */\n\ttheme?: THEME | string;\n\n\t/**\n\t * Mappings of event names and event handlers.\n\t */\n\ton?: DBaseOnOptions<EMITTER>;\n\n\t/**\n\t * A weight used by {@link DLayoutVertical} and {@link DLayoutHorizontal}.\n\t */\n\tweight?: number;\n\n\t/** A tooltip text. */\n\ttitle?: string;\n\n\t/** A shortcut option. */\n\tshortcut?: string | UtilKeyboardEventShortcut;\n\n\t/** A shortcut options. */\n\tshortcuts?: Array<string | UtilKeyboardEventShortcut>;\n\n\t/** A background options. */\n\tbackground?: DBaseBackgroundOptions;\n\n\t/** A border options. */\n\tborder?: DBaseBorderOptions;\n\n\t/** An outline options. */\n\toutline?: DBaseOutlineOptions;\n\n\t/** A shadow. */\n\tshadow?: \"NONE\" | \"WEAK\" | \"DEFAULT\" | DShadow | null;\n\n\t/** A clear type used by {@link DLayoutVertical} and {@link DLayoutHorizontal}. */\n\tclear?: (keyof typeof DLayoutClearType) | DLayoutClearType;\n\n\t/** A cursor shape. */\n\tcursor?: DStateAwareOrValueMightBe<string>;\n}\n\n/**\n * {@link DBase} theme.\n */\nexport interface DThemeBase extends DThemeFont {\n\t/**\n\t * Returns a X coordinate.\n\t */\n\tgetX(): DCoordinatePosition;\n\n\t/**\n\t * Returns a Y coordinate.\n\t */\n\tgetY(): DCoordinatePosition;\n\n\t/**\n\t * Returns a height.\n\t */\n\tgetHeight(): DCoordinateSize;\n\n\t/**\n\t * Returns a width.\n\t */\n\tgetWidth(): DCoordinateSize;\n\n\t/**\n\t * Returns a background color.\n\t * If the color is null, backgrounds are not be rendered.\n\t *\n\t * @param state a state\n\t */\n\tgetBackgroundColor( state: DBaseStateSet ): number | null;\n\n\t/**\n\t * Returns a background alpha.\n\t *\n\t * @param state a state\n\t */\n\tgetBackgroundAlpha( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns a background texture of the given radius.\n\t *\n\t * @param radius a corner radius\n\t */\n\tgetBackgroundTexture( radius: number ): Texture;\n\n\t/**\n\t * Returns a border color.\n\t * If the color is null, borders are not be rendered.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderColor( state: DBaseStateSet ): number | null;\n\n\t/**\n\t * Returns a border alpha.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderAlpha( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns a border width.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderWidth( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns a border align.\n\t *\n\t * @param state a state\n\t */\n\tgetBorderAlign( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns a border mask.\n\t *\n\t * @param state a mask\n\t */\n\tgetBorderMask( state: DBaseStateSet ): DBorderMask;\n\n\t/**\n\t * Returns a border texture of the given radius and width.\n\t *\n\t * @param radius a corner radius\n\t * @param width a border width\n\t */\n\tgetBorderTexture( radius: number, width: number ): Texture;\n\n\t/**\n\t * Returns a left padding.\n\t */\n\tgetPaddingLeft(): number;\n\n\t/**\n\t * Returns a right padding.\n\t */\n\tgetPaddingRight(): number;\n\n\t/**\n\t * Returns a top padding.\n\t */\n\tgetPaddingTop(): number;\n\n\t/**\n\t * Returns a bottom padding.\n\t */\n\tgetPaddingBottom(): number;\n\n\t/**\n\t * Returns a corner radius.\n\t */\n\tgetCornerRadius(): number;\n\n\t/**\n\t * Returns a corner mask.\n\t */\n\tgetCornerMask(): DCornerMask;\n\n\t/**\n\t * Returns an outline color.\n\t * If the color is null, outlines are not be rendered.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineColor( state: DBaseStateSet ): number | null;\n\n\t/**\n\t * Returns an outline alpha.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineAlpha( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns an outline width.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineWidth( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns an outline offset.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineOffset( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns an outline align.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineAlign( state: DBaseStateSet ): number;\n\n\t/**\n\t * Returns an outline mask.\n\t *\n\t * @param state a state\n\t */\n\tgetOutlineMask( state: DBaseStateSet ): DBorderMask;\n\n\t/**\n\t * Returns a shadow.\n\t * If a shadow is null, no shadow is rendered.\n\t */\n\tgetShadow(): DShadow | null;\n\n\t/**\n\t * Returns an interactivity.\n\t */\n\tgetInteractive(): DBaseInteractive;\n\n\t/**\n\t * Returns a tooltip text.\n\t */\n\tgetTitle(): string;\n\n\t/**\n\t * Returns a clear type.\n\t * A clear type is for layout classes including {@link DLayoutVertical}.\n\t */\n\tgetClearType(): DLayoutClearType;\n\n\t/**\n\t * Returns a weight.\n\t * Weights are for layout classes including {@link DLayoutVertical}.\n\t * If a weight is less than or equals to zero, layout classes are supposed not to change a width / height.\n\t */\n\tgetWeight(): number;\n\n\t/**\n\t * Creates a new shadow.\n\t */\n\tnewShadow(): DShadow | null;\n\n\t/**\n\t * Creates a new weak shadow.\n\t */\n\tnewShadowWeak(): DShadow | null;\n\n\t/**\n\t * Returns a cursor.\n\t */\n\tgetCursor( state: DBaseStateSet ): string;\n}\n\nconst toTheme = <THEME extends DThemeBase>( options?: DBaseOptions<THEME> ): THEME | null => {\n\tif( options != null && options.theme != null ) {\n\t\tconst theme = options.theme;\n\t\tif( isString( theme ) ) {\n\t\t\treturn DThemes.getInstance().get( theme );\n\t\t} else {\n\t\t\treturn theme;\n\t\t}\n\t}\n\treturn null;\n};\n\nexport interface DRefitable {\n\treadonly width: number;\n\treadonly height: number;\n}\n\nconst toShortcuts = <THEME extends DThemeBase>(\n\toptions?: DBaseOptions<THEME>\n): UtilKeyboardEventShortcut[] | undefined => {\n\tif( options != null && ( options.shortcuts != null || options.shortcut != null ) ) {\n\t\tconst result: UtilKeyboardEventShortcut[] = [];\n\t\tif( options.shortcut != null ) {\n\t\t\tresult.push( UtilKeyboardEvent.toShortcut( options.shortcut ) );\n\t\t}\n\n\t\tif( options.shortcuts != null ) {\n\t\t\tconst shortcuts = options.shortcuts;\n\t\t\tfor( let i = 0, imax = shortcuts.length; i < imax; ++i ) {\n\t\t\t\tUtilKeyboardEvent.toShortcut( shortcuts[ i ] );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\treturn undefined;\n};\n\nexport interface DRenderable {\n\tparent?: Container | null;\n\trender( renderer: Renderer ): void;\n\tupdateTransform(): void;\n}\n\nexport interface DReflowable {\n\tonReflow( base: DBase, width: number, height: number ): void;\n}\n\n/**\n * A base class for UI classes.\n * See {@link DBaseEvents} for event details.\n */\nexport class DBase<\n\tTHEME extends DThemeBase = DThemeBase,\n\tOPTIONS extends DBaseOptions<THEME> = DBaseOptions<THEME>\n> extends Container {\n\tprotected static WORK_CONTAINS_POINT: Point = new Point();\n\n\tprivate _state: DBaseStateSet;\n\tprivate _theme: THEME;\n\tprotected _options: OPTIONS | undefined;\n\tprivate _width: number;\n\tprivate _height: number;\n\tprotected _padding: DPadding;\n\tprotected _corner: DCorner;\n\tprivate _scalarSet: DScalarSet;\n\tprotected _auto: DBaseAutoSet;\n\tprivate _isDirty: boolean;\n\tprivate _hasDirty: boolean;\n\tprotected _isChildrenDirty: boolean;\n\tprivate _shadow: DShadow | null;\n\tprivate _onShadowUpdateBound: () => void;\n\tprivate _weight: number;\n\tprivate _position: DBasePoint;\n\tprivate _scale: DBasePoint;\n\tprivate _skew: DBasePoint;\n\tprotected _title: string;\n\tprotected _background: DBackgroundStateAware;\n\tprotected _border: DBorderStateAware;\n\tprotected _outline: DOutline;\n\tprotected _clearType: DLayoutClearType;\n\tprotected _shortcuts?: UtilKeyboardEventShortcut[];\n\tprotected _befores: DRenderable[];\n\tprotected _afters: DRenderable[];\n\tprotected _reflowables: DReflowable[];\n\tprotected _lastDownPoint?: Point;\n\tprotected _cursor?: DStateAwareOrValueMightBe<string>;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper();\n\n\t\t// Transform\n\t\tconst transform: Transform = this.transform;\n\t\tthis._position = new DBasePoint( transform.position, ( newX, newY, oldX, oldY ): void => {\n\t\t\tthis.onMove( newX, newY, oldX, oldY );\n\t\t});\n\t\tthis._scale = new DBasePoint( transform.scale, ( newX, newY, oldX, oldY ): void => {\n\t\t\tthis.onScale( newX, newY, oldX, oldY );\n\t\t});\n\t\tthis._skew = new DBasePoint( transform.skew, ( newX, newY, oldX, oldY ): void => {\n\t\t\tthis.onSkew( newX, newY, oldX, oldY );\n\t\t});\n\n\t\t//\n\t\tthis._options = options;\n\t\tconst scalarSet: DScalarSet = this._scalarSet = {};\n\t\tthis._auto = new DBaseAutoSet();\n\t\tthis._isDirty = true;\n\t\tthis._hasDirty = false;\n\t\tthis._isChildrenDirty = false;\n\t\tthis._shadow = null;\n\t\tthis.name = options?.name ?? \"\";\n\t\tconst theme = this._theme = toTheme( options ) || this.getThemeDefault();\n\t\tthis._befores = [];\n\t\tthis._afters = [];\n\t\tthis._reflowables = [];\n\t\tthis._clearType = toEnum( options?.clear ?? theme.getClearType(), DLayoutClearType );\n\t\tthis._padding = new DBasePadding( theme, options, (): void => {\n\t\t\tthis.layout();\n\t\t\tthis.toChildrenDirty();\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tconst toDirtyAndUpdate = (): void => {\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update( this );\n\t\t};\n\t\tthis._background = new DBaseBackground( theme, options, toDirtyAndUpdate );\n\t\tthis._border = new DBaseBorder( theme, options, toDirtyAndUpdate );\n\t\tthis._outline = new DBaseOutline( theme, options, toDirtyAndUpdate );\n\t\tthis._corner = new DBaseCorner( theme, options, toDirtyAndUpdate );\n\n\t\t// X\n\t\tconst position = transform.position;\n\t\tconst x = options?.x ?? theme.getX();\n\t\tif( isNumber( x ) ) {\n\t\t\tposition.x = x;\n\t\t} else {\n\t\t\tposition.x = 0;\n\t\t\tscalarSet.x = DScalarFunctions.position( x );\n\t\t}\n\n\t\t// Y\n\t\tconst y = options?.y ?? theme.getY();\n\t\tif( isNumber( y ) ) {\n\t\t\tposition.y = y;\n\t\t} else {\n\t\t\tposition.y = 0;\n\t\t\tscalarSet.y = DScalarFunctions.position( y );\n\t\t}\n\n\t\t// Width\n\t\tconst width = options?.width ?? theme.getWidth();\n\t\tif( ! this._auto.width.from( width ) ) {\n\t\t\tif( isNumber( width ) ) {\n\t\t\t\tthis._width = width;\n\t\t\t} else {\n\t\t\t\tthis._width = 100;\n\t\t\t\tscalarSet.width = DScalarFunctions.size( width );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._width = 100;\n\t\t}\n\n\t\t// Height\n\t\tconst height = options?.height ?? theme.getHeight();\n\t\tif( ! this._auto.height.from( height ) ) {\n\t\t\tif( isNumber( height ) ) {\n\t\t\t\tthis._height = height;\n\t\t\t} else {\n\t\t\t\tthis._height = 100;\n\t\t\t\tscalarSet.height = DScalarFunctions.size( height );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._height = 100;\n\t\t}\n\n\t\t// Visibility\n\t\tconst visible = options?.visible;\n\t\tif( visible != null ) {\n\t\t\tthis.visible = visible;\n\t\t}\n\n\t\t// State\n\t\tthis._state = new DBaseStateSetImplObservable(( newState, oldState ): void => {\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t});\n\n\t\t// Interactive\n\t\tconst interactive = toEnum( options?.interactive ?? theme.getInteractive(), DBaseInteractive );\n\t\tthis.interactive = ( ( interactive & DBaseInteractive.SELF ) !== 0 );\n\t\tthis.interactiveChildren = ( ( interactive & DBaseInteractive.CHILDREN ) !== 0 );\n\n\t\t// Events\n\t\tconst on = options?.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tconst handler = on[ name ];\n\t\t\t\tif( handler ) {\n\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Title\n\t\tthis._title = options?.title ?? theme.getTitle();\n\n\t\t// Weight\n\t\tthis._weight = options?.weight ?? theme.getWeight();\n\n\t\t// Reflowable\n\t\tthis.initReflowable();\n\n\t\t// Shadow\n\t\tthis._onShadowUpdateBound = (): void => {\n\t\t\tDApplications.update( this );\n\t\t};\n\t\tlet shadow = options?.shadow;\n\t\tif( shadow === undefined ) {\n\t\t\tshadow = theme.getShadow();\n\t\t}\n\t\tif( shadow ) {\n\t\t\tif( isString( shadow )  ) {\n\t\t\t\tswitch( shadow ) {\n\t\t\t\tcase \"WEAK\":\n\t\t\t\t\tthis.shadow = theme.newShadowWeak();\n\t\t\t\t\tbreak;\n\t\t\t\tcase \"DEFAULT\":\n\t\t\t\t\tthis.shadow = theme.newShadow();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.shadow = shadow;\n\t\t\t}\n\t\t}\n\n\t\t// Event handlers\n\t\tthis.on( UtilPointerEvent.over, ( e: InteractionEvent ): void => {\n\t\t\tthis.onOver( e );\n\t\t});\n\n\t\tthis.on( UtilPointerEvent.out, ( e: InteractionEvent ): void => {\n\t\t\tthis.onOut( e );\n\t\t});\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tthis.onDown( e );\n\t\t});\n\n\t\tthis.on( UtilPointerEvent.up, ( e: InteractionEvent ): void => {\n\t\t\tthis.onUp( e );\n\t\t});\n\n\t\t// Children change detection\n\t\tthis.on( \"added\", (): void => {\n\t\t\tthis.layout();\n\t\t\tif( this.isDirty() || this.hasDirty() ) {\n\t\t\t\tthis.toParentHasDirty();\n\t\t\t}\n\t\t\tif( this._isChildrenDirty ) {\n\t\t\t\tthis.toParentChildrenDirty();\n\t\t\t}\n\t\t\tconst newParent = this.parent;\n\t\t\tif( newParent instanceof DBase ) {\n\t\t\t\tthis.state.parent = newParent.state;\n\t\t\t}\n\t\t\tDApplications.update( this );\n\t\t});\n\n\t\tthis.on( \"removed\", (): void => {\n\t\t\tthis.blur( true );\n\t\t\tthis.state.parent = null;\n\t\t\tDApplications.update( this );\n\t\t});\n\n\t\t// Shortcut\n\t\tconst shortcuts = this._shortcuts = toShortcuts( options );\n\t\tif( shortcuts != null ) {\n\t\t\tconst onShortcutBound = ( e: KeyboardEvent ): void => {\n\t\t\t\tthis.onShortcut( e );\n\t\t\t};\n\t\t\tfor( let i = 0, imax = shortcuts.length; i < imax; ++i ) {\n\t\t\t\tUtilKeyboardEvent.on( this, shortcuts[ i ], onShortcutBound );\n\t\t\t}\n\t\t}\n\n\t\t// Other initialization\n\t\tthis.init( options );\n\n\t\t// State Override\n\t\tconst state = options?.state;\n\t\tif( state != null ) {\n\t\t\tif( isString( state ) ) {\n\t\t\t\tthis._state.add( state );\n\t\t\t} else {\n\t\t\t\tthis._state.addAll( state );\n\t\t\t}\n\t\t}\n\n\t\t// Parent\n\t\tconst parent = options?.parent;\n\t\tif( parent != null ) {\n\t\t\tparent.addChild( this );\n\t\t}\n\n\t\t// Children\n\t\tconst children = options?.children;\n\t\tif( children != null ) {\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child != null ) {\n\t\t\t\t\tthis.addChild( child );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Cursor\n\t\tconst cursor = options?.cursor;\n\t\tthis._cursor = cursor;\n\t\tthis.cursor = this.toCursor( cursor, this._state );\n\n\t\t// Done\n\t\tthis.emit( \"init\", this );\n\t}\n\n\tprotected toCursor( cursor: DStateAwareOrValueMightBe<string> | undefined, state: DBaseStateSet ): string {\n\t\tif( cursor ) {\n\t\t\tif( isFunction( cursor ) ) {\n\t\t\t\tconst result = cursor( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else if( cursor !== undefined ) {\n\t\t\t\treturn cursor;\n\t\t\t}\n\t\t}\n\t\treturn this.theme.getCursor( state );\n\t}\n\n\taddRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tlist.push( renderable );\n\t\tif( \"parent\" in renderable ) {\n\t\t\trenderable.parent = this;\n\t\t}\n\t}\n\n\taddRenderableAt( renderable: DRenderable, phase: boolean, index: number ): void {\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tif( index === 0 ) {\n\t\t\tlist.unshift( renderable );\n\t\t} else if( 0 < index && index < list.length ) {\n\t\t\tlist.splice( index, 0, renderable );\n\t\t} else {\n\t\t\tlist.push( renderable );\n\t\t}\n\t\tif( \"parent\" in renderable ) {\n\t\t\trenderable.parent = this;\n\t\t}\n\t}\n\n\tremoveRenderable( renderable: DRenderable, phase: boolean ): void {\n\t\tconst list = ( phase ? this._befores : this._afters );\n\t\tconst index = list.indexOf( renderable );\n\t\tif( 0 <= index ) {\n\t\t\tlist.splice( index, 1 );\n\t\t\tif( \"parent\" in renderable ) {\n\t\t\t\trenderable.parent = null;\n\t\t\t}\n\t\t}\n\t}\n\n\taddReflowable( reflowable: DReflowable ): void {\n\t\tthis._reflowables.push( reflowable );\n\t}\n\n\tremoveReflowable( reflowable: DReflowable ): void {\n\t\tconst reflowables = this._reflowables;\n\t\tconst index = reflowables.indexOf( reflowable );\n\t\tif( 0 <= index ) {\n\t\t\treflowables.splice( index, 1 );\n\t\t}\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DBaseReflowable( this );\n\t}\n\n\tprotected onChildrenChange(): void {\n\t\tthis.toChildrenDirty();\n\t\tsuper.onChildrenChange();\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\t// OTHER INITIALIZATIONS BEFORE `parent.addChild( this )`\n\t}\n\n\tget weight(): number {\n\t\treturn this._weight;\n\t}\n\n\tprotected onMove( newX: number, newY: number, oldX: number, oldY: number ): void {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentMove( newX, newY, oldX, oldY );\n\t\t\t}\n\t\t}\n\t\tDApplications.update( this );\n\t\tthis.emit( \"move\", newX, newY, oldX, oldY, this );\n\t}\n\n\tresize( width: number, height: number ): boolean {\n\t\tconst oldWidth = this._width;\n\t\tconst oldHeight = this._height;\n\t\tconst widthResized = oldWidth !== width;\n\t\tconst heightResized = oldHeight !== height;\n\n\t\tif( widthResized ) {\n\t\t\tthis._width = width;\n\t\t}\n\n\t\tif( heightResized ) {\n\t\t\tthis._height = height;\n\t\t}\n\n\t\tconst resized = widthResized || heightResized;\n\t\tif( resized ) {\n\t\t\tthis.onResize( width, height, oldWidth, oldHeight );\n\t\t}\n\n\t\tif( widthResized ) {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.x != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.x = scalarSet.x( parent.width, width, parent.padding.getLeft(), position.x );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( heightResized ) {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.y != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.y = scalarSet.y( parent.height, height, parent.padding.getTop(), position.y );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn resized;\n\t}\n\n\tgetClearType(): DLayoutClearType {\n\t\treturn this._clearType;\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tthis.toDirty();\n\t\tthis.toChildrenDirty();\n\n\t\tconst padding = this._padding;\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentResize( newWidth, newHeight, padding );\n\t\t\t}\n\t\t}\n\n\t\tDApplications.update( this );\n\t\tthis.emit( \"resize\", newWidth, newHeight, oldWidth, oldHeight, this );\n\t}\n\n\tprotected onScale( newX: number, newY: number, oldX: number, oldY: number ): void {\n\t\tDApplications.update( this );\n\t\tthis.emit( \"scale\", newX, newY, oldX, oldY, this );\n\t}\n\n\tprotected onSkew( newX: number, newY: number, oldX: number, oldY: number ): void {\n\t\tDApplications.update( this );\n\t\tthis.emit( \"skew\", newX, newY, oldX, oldY, this );\n\t}\n\n\tget type(): string {\n\t\treturn this.getType();\n\t}\n\n\t// @ts-ignore\n\tget x(): number {\n\t\treturn this._position.x;\n\t}\n\n\tset x( x: number ) {\n\t\tthis._position.x = x;\n\t}\n\n\tgetX(): DCoordinatePosition {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( scalarSet.x != null ) {\n\t\t\treturn scalarSet.x;\n\t\t} else {\n\t\t\treturn this.x;\n\t\t}\n\t}\n\n\tsetX( x: DCoordinatePosition ) {\n\t\tif( isNumber( x ) ) {\n\t\t\tthis.x = x;\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.position( x );\n\t\t\tif( scalarSet.x !== scalar ) {\n\t\t\t\tscalarSet.x = scalar;\n\t\t\t\tthis.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget y(): number {\n\t\treturn this._position.y;\n\t}\n\n\tset y( y: number ) {\n\t\tthis._position.y = y;\n\t}\n\n\tgetY(): DCoordinatePosition {\n\t\tconst scalarSet = this._scalarSet;\n\t\tif( scalarSet.y != null ) {\n\t\t\treturn scalarSet.y;\n\t\t} else {\n\t\t\treturn this.y;\n\t\t}\n\t}\n\n\tsetY( y: DCoordinatePosition ) {\n\t\tif( isNumber( y ) ) {\n\t\t\tthis.y = y;\n\t\t} else {\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tconst scalar = DScalarFunctions.position( y );\n\t\t\tif( scalarSet.y !== scalar ) {\n\t\t\t\tscalarSet.y = scalar;\n\t\t\t\tthis.layout();\n\t\t\t}\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tset width( width: number ) {\n\t\tconst oldWidth = this._width;\n\t\tif( oldWidth !== width ) {\n\t\t\tthis._width = width;\n\t\t\tconst height = this._height;\n\t\t\tthis.onResize( width, height, oldWidth, height );\n\n\t\t\t// Layout\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.x != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.x = scalarSet.x( parent.width, width, parent.padding.getLeft(), position.x );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetWidth(): DCoordinateSize {\n\t\treturn this._auto.width.toCoordinate(\n\t\t\tthis._scalarSet.width || this._width\n\t\t);\n\t}\n\n\tsetWidth( width: DCoordinateSize ) {\n\t\tconst auto = this._auto.width;\n\t\tconst isOn = auto.isOn;\n\t\tconst isAuto = auto.from( width );\n\t\tif( auto.isOn !== isOn ) {\n\t\t\tthis.toChildrenDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t\tif( ! isAuto ){\n\t\t\tif( isNumber( width ) ) {\n\t\t\t\tthis.width = width;\n\t\t\t} else {\n\t\t\t\tconst scalarSet = this._scalarSet;\n\t\t\t\tconst scalar = DScalarFunctions.size( width );\n\t\t\t\tif( scalarSet.width !== scalar ) {\n\t\t\t\t\tscalarSet.width = scalar;\n\t\t\t\t\tthis.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tset height( height: number ) {\n\t\tconst oldHeight = this._height;\n\t\tif( oldHeight !== height ) {\n\t\t\tthis._height = height;\n\t\t\tconst width = this._width;\n\t\t\tthis.onResize( width, height, width, oldHeight );\n\n\t\t\t// Layout\n\t\t\tconst scalarSet = this._scalarSet;\n\t\t\tif( scalarSet.y != null ) {\n\t\t\t\tconst position = this.transform.position;\n\t\t\t\tconst parent = this.getParentOfSize();\n\t\t\t\tif( parent ) {\n\t\t\t\t\tthis.y = scalarSet.y( parent.height, height, parent.padding.getTop(), position.y );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetHeight(): DCoordinateSize {\n\t\treturn this._auto.height.toCoordinate(\n\t\t\tthis._scalarSet.height || this._height\n\t\t);\n\t}\n\n\tsetHeight( height: DCoordinateSize ) {\n\t\tconst auto = this._auto.height;\n\t\tconst isOn = auto.isOn;\n\t\tconst isAuto = auto.from( height );\n\t\tif( auto.isOn !== isOn ) {\n\t\t\tthis.toChildrenDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t\tif( ! isAuto ) {\n\t\t\tif( isNumber( height ) ) {\n\t\t\t\tthis.height = height;\n\t\t\t} else {\n\t\t\t\tconst scalarSet = this._scalarSet;\n\t\t\t\tconst scalar = DScalarFunctions.size( height );\n\t\t\t\tif( scalarSet.height !== scalar ) {\n\t\t\t\t\tscalarSet.height = scalar;\n\t\t\t\t\tthis.layout();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget position(): DBasePoint {\n\t\treturn this._position;\n\t}\n\n\t// @ts-ignore\n\tget scale(): DBasePoint {\n\t\treturn this._scale;\n\t}\n\n\t// @ts-ignore\n\tget skew(): DBasePoint {\n\t\treturn this._skew;\n\t}\n\n\tget padding(): DPadding {\n\t\treturn this._padding;\n\t}\n\n\tget corner(): DCorner {\n\t\treturn this._corner;\n\t}\n\n\tget background(): DBackgroundStateAware {\n\t\treturn this._background;\n\t}\n\n\tget border(): DBorderStateAware {\n\t\treturn this._border;\n\t}\n\n\tget outline(): DOutline {\n\t\treturn this._outline;\n\t}\n\n\tget unsafe(): Transform {\n\t\treturn this.transform;\n\t}\n\n\tget title(): string {\n\t\treturn this._title;\n\t}\n\n\tset title( title: string ) {\n\t\tif( this._title !== title ) {\n\t\t\tthis._title = title;\n\t\t\tif( this.state.isHovered ) {\n\t\t\t\tthis.applyTitle();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected applyTitle(): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tlayer.view.title = this._title;\n\t\t}\n\t}\n\n\tshow(): this {\n\t\tif( ! this.visible ) {\n\t\t\tthis.visible = true;\n\t\t\tthis.toParentChildrenDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tisShown(): boolean {\n\t\treturn this.visible;\n\t}\n\n\thide(): this {\n\t\tif( this.visible ) {\n\t\t\tthis.visible = false;\n\t\t\tthis.toParentChildrenDirty();\n\t\t\tthis.blur( true );\n\t\t\tDApplications.update( this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tisHidden(): boolean {\n\t\treturn ! this.visible;\n\t}\n\n\ttoDirty(): boolean {\n\t\tif( ! this._isDirty ) {\n\t\t\tthis._isDirty = true;\n\t\t\tthis.toParentHasDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoHasDirty(): boolean {\n\t\tif( ! this._hasDirty ) {\n\t\t\tthis._hasDirty = true;\n\t\t\tthis.toParentHasDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoParentHasDirty(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.toHasDirty();\n\t\t}\n\t}\n\n\ttoChildrenDirty(): boolean {\n\t\tif( ! this._isChildrenDirty ) {\n\t\t\tthis._isChildrenDirty = true;\n\t\t\tthis.onChildrenDirty();\n\t\t\tthis.toParentChildrenDirty();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\ttoParentChildrenDirty(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.toChildrenDirty();\n\t\t}\n\t}\n\n\tisChildrenDirty(): boolean {\n\t\treturn this._isChildrenDirty;\n\t}\n\n\tprotected onChildrenDirty() {\n\t\t// DO NOTHING\n\t}\n\n\tisDirty() {\n\t\treturn this._isDirty;\n\t}\n\n\thasDirty() {\n\t\treturn this._hasDirty;\n\t}\n\n\tprotected setFocused( isFocused: boolean ) {\n\t\tif( this.state.isFocused !== isFocused ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.getFocusController().set( this, isFocused );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tfocus(): this {\n\t\treturn this.setFocused( true );\n\t}\n\n\tblur( recursively?: boolean ): this {\n\t\tif( recursively ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tconst focusController = layer.getFocusController();\n\t\t\t\tconst focused = focusController.get();\n\t\t\t\tif( focused instanceof DBase ) {\n\t\t\t\t\tlet current: Container = focused;\n\t\t\t\t\twhile( current ) {\n\t\t\t\t\t\tif( current === this ) {\n\t\t\t\t\t\t\tfocused.setFocused( false );\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.setFocused( false );\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected onStateChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tthis.toDirty();\n\t\tDApplications.update( this );\n\t\tthis.emit( \"statechange\", newState, oldState, this );\n\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.state.onParentChange( newState, oldState );\n\t\t\t}\n\t\t}\n\n\t\tif( newState.isFocused ) {\n\t\t\tif( ! oldState.isFocused ) {\n\t\t\t\tthis.onFocus();\n\t\t\t}\n\t\t} else if( oldState.isFocused ) {\n\t\t\tthis.onBlur();\n\t\t}\n\n\t\tthis.cursor = this.toCursor( this._cursor, newState );\n\t}\n\n\tprotected onChildFocus( focused: DBase ): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildFocus( focused );\n\t\t}\n\t}\n\n\tprotected onFocus(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildFocus( this );\n\t\t}\n\t}\n\n\tprotected onChildBlur( blured: DBase ): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildBlur( blured );\n\t\t}\n\t}\n\n\tprotected onBlur(): void {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\tparent.onChildBlur( this );\n\t\t}\n\t}\n\n\tget state(): DBaseStateSet {\n\t\treturn this._state;\n\t}\n\n\tget theme(): THEME {\n\t\treturn this._theme;\n\t}\n\n\tset theme( theme: THEME ) {\n\t\tconst result = this._theme;\n\t\tif( result !== theme ) {\n\t\t\tthis._theme = theme;\n\t\t\tthis._padding.setTheme( theme );\n\t\t\tthis._background.setTheme( theme );\n\t\t\tthis._border.setTheme( theme );\n\t\t\tthis._outline.setTheme( theme );\n\t\t\tthis._corner.setTheme( theme );\n\t\t\tthis.toDirty();\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\trefit(): void {\n\t\tif( this._isChildrenDirty ) {\n\t\t\tthis._isChildrenDirty = false;\n\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.refit();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onRefit();\n\t\t}\n\t}\n\n\tprotected onRefit(): void {\n\t\tconst auto = this._auto;\n\t\tconst isWidthAuto = auto.width.isOn;\n\t\tconst isHeightAuto = auto.height.isOn;\n\t\tif( isWidthAuto && isHeightAuto ) {\n\t\t\tlet width = 0;\n\t\t\tlet height = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible ) {\n\t\t\t\t\tif( this.hasRefitableWidth( child ) ) {\n\t\t\t\t\t\twidth = Math.max( width, child.x + child.width );\n\t\t\t\t\t}\n\t\t\t\t\tif( this.hasRefitableHeight( child ) ) {\n\t\t\t\t\t\theight = Math.max( height, child.y + child.height );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst padding = this.padding;\n\t\t\tthis.resize( width + padding.getRight(), height + padding.getBottom() );\n\t\t} else if( isWidthAuto ) {\n\t\t\tlet width = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible && this.hasRefitableWidth( child ) ) {\n\t\t\t\t\twidth = Math.max( width, child.x + child.width );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.width = width + this.padding.getRight();\n\t\t} else if( isHeightAuto ) {\n\t\t\tlet height = 0;\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible && this.hasRefitableHeight( child ) ) {\n\t\t\t\t\theight = Math.max( height, child.y + child.height );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.height = height + this.padding.getBottom();\n\t\t}\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn target instanceof DBase;\n\t}\n\n\tprotected hasRefitableHeight( target: any ): target is DRefitable {\n\t\treturn this.isRefitable( target ) &&\n\t\t\t! ( target instanceof DBase && isFunction( target.getHeight() ) );\n\t}\n\n\tprotected hasRefitableWidth( target: any ): target is DBase<any, any> {\n\t\treturn this.isRefitable( target ) &&\n\t\t\t! ( target instanceof DBase && isFunction( target.getWidth() ) );\n\t}\n\n\treflow(): void {\n\t\tif( this._isDirty ) {\n\t\t\tthis.onReflow();\n\t\t\tthis._isDirty = false;\n\t\t}\n\n\t\tif( this._hasDirty ) {\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.reflow();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._hasDirty = false;\n\t\t}\n\t}\n\n\tprotected onReflow(): void {\n\t\tconst width = this._width;\n\t\tconst height = this._height;\n\t\tconst reflowables = this._reflowables;\n\t\tfor( let i = 0, imax = reflowables.length; i < imax; ++i ) {\n\t\t\treflowables[ i ].onReflow( this, width, height );\n\t\t}\n\t}\n\n\tget shadow(): DShadow | null {\n\t\treturn this._shadow;\n\t}\n\n\tset shadow( shadow: DShadow | null ) {\n\t\tconst previous = this._shadow;\n\t\tif( previous !== shadow ) {\n\t\t\tif( previous != null ) {\n\t\t\t\tprevious.off( \"update\", this._onShadowUpdateBound );\n\t\t\t\tthis.removeReflowable( previous );\n\t\t\t\tthis.removeRenderable( previous, true );\n\t\t\t}\n\n\t\t\tthis._shadow = shadow;\n\t\t\tif( shadow != null ) {\n\t\t\t\tshadow.on( \"update\", this._onShadowUpdateBound );\n\t\t\t\tthis.addReflowable( shadow );\n\t\t\t\tthis.addRenderableAt( shadow, true, 0 );\n\t\t\t}\n\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tlayout(): void {\n\t\tconst parent = this.getParentOfSize();\n\t\tif( parent ) {\n\t\t\tthis.onParentResize( parent.width, parent.height, parent.padding );\n\t\t}\n\t}\n\n\tprotected getParentOfSize(): { width: number, height: number, padding: DPadding } | null {\n\t\tconst parent = this.parent;\n\t\tif( parent instanceof DBase ) {\n\t\t\treturn parent;\n\t\t} else {\n\t\t\treturn DApplications.getLayer( this );\n\t\t}\n\t}\n\n\t/**\n\t * Called when a parent resized.\n\t *\n\t * @param parentWidth a parent's local width\n\t * @param parentHeight a parent's local height\n\t */\n\tonParentResize( parentWidth: number, parentHeight: number, parentPadding: DPadding ): void {\n\t\tconst scalarSet = this._scalarSet;\n\t\tconst position = this.transform.position;\n\t\tconst x = position.x;\n\t\tconst y = position.y;\n\t\tconst width = this._width;\n\t\tconst height = this._height;\n\n\t\t// Width & height\n\t\tconst paddingWidth = parentPadding.getLeft() + parentPadding.getRight();\n\t\tconst paddingHeight = parentPadding.getTop() + parentPadding.getBottom();\n\t\tconst newWidth = ( scalarSet.width != null ?\n\t\t\tscalarSet.width( parentWidth, width, paddingWidth, width ) : width );\n\t\tconst newHeight = ( scalarSet.height != null ?\n\t\t\tscalarSet.height( parentHeight, height, paddingHeight, height ) : height );\n\t\tthis.resize( newWidth, newHeight );\n\n\t\t// X & Y\n\t\tconst newX = ( scalarSet.x != null ? scalarSet.x( parentWidth, this._width, parentPadding.getLeft(), x ) : x );\n\t\tconst newY = ( scalarSet.y != null ? scalarSet.y( parentHeight, this._height, parentPadding.getTop(), y ) : y );\n\t\tthis.position.set( newX, newY );\n\t}\n\n\t/**\n\t * Called when a parent moved.\n\t *\n\t * @param newX a new parent's local x position\n\t * @param newY a new parent's local y position\n\t * @param oldX an old parent's local x position\n\t * @param oldY an old parent's local y position\n\t */\n\tprotected onParentMove( newX: number, newY: number, oldX: number, oldY: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\t// Wheel\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tthis.emit( \"wheel\", e, deltas, global, this );\n\t\treturn false;\n\t}\n\n\t// Keydown\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tthis.emit( \"keydown\", e, this );\n\t\treturn false;\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tthis.emit( \"keyup\", e, this );\n\t\treturn false;\n\t}\n\n\t// Down\n\tprotected isEventTarget( e: InteractionEvent ): boolean {\n\t\tconst target = e.target;\n\t\tif( target === this ) {\n\t\t\treturn true;\n\t\t} else if( !( target instanceof DBase ) ) {\n\t\t\tlet parent = target.parent;\n\t\t\twhile( parent != null && ! ( parent instanceof DBase ) ) {\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\treturn ( parent === this );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onDown( e: InteractionEvent ): void {\n\t\tif( this.isEventTarget( e ) ) {\n\t\t\tthis.onDownThis( e );\n\t\t}\n\t\tthis.emit( \"down\", e, this );\n\t}\n\n\tprotected onDownThis( e: InteractionEvent ): void {\n\t\tconst oe = e.data.originalEvent;\n\t\tif( \"touches\" in oe ) {\n\t\t\tconst lastDownPoint = this._lastDownPoint || new Point();\n\t\t\tthis._lastDownPoint = lastDownPoint;\n\t\t\tlastDownPoint.copyFrom( e.data.global );\n\t\t} else {\n\t\t\tthis.focusOnClosest();\n\t\t}\n\t}\n\n\tprotected onUp( e: InteractionEvent ): void {\n\t\tif( this.isEventTarget( e ) ) {\n\t\t\tthis.onUpThis( e );\n\t\t}\n\t\tthis.emit( \"up\", e, this );\n\t}\n\n\tprotected onUpThis( e: InteractionEvent ): void {\n\t\tconst oe = e.data.originalEvent;\n\t\tif( \"touches\" in oe ) {\n\t\t\tconst lastDownPoint = this._lastDownPoint;\n\t\t\tif( lastDownPoint ) {\n\t\t\t\tconst global = e.data.global;\n\t\t\t\tconst dx = Math.abs( global.x - lastDownPoint.x );\n\t\t\t\tconst dy = Math.abs( global.y - lastDownPoint.y );\n\t\t\t\tconst threshold = UtilPointerEvent.CLICK_DISTANCE_THRESHOLD;\n\t\t\t\tif( dx < threshold && dy < threshold ) {\n\t\t\t\t\tthis.focusOnClosest();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected focusOnClosest(): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tfocusController.focus( focusController.findParent( this ) );\n\t\t}\n\t}\n\n\t// Over\n\tprotected onOver( e: InteractionEvent ): void {\n\t\t// Update the hover state\n\t\tthis.state.isHovered = true;\n\n\t\t// Update the title\n\t\tif( e.target === this ) {\n\t\t\tthis.applyTitle();\n\t\t}\n\n\t\t// Event\n\t\tthis.emit( \"over\", e, this );\n\t}\n\n\t// Out\n\tprotected onOut( e: InteractionEvent ): void {\n\t\t// Update the hover state\n\t\tthis.state.isHovered = false;\n\n\t\t// Event\n\t\tthis.emit( \"out\", e, this );\n\t}\n\n\t// Double click\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: InteractionManager ): boolean {\n\t\tthis.emit( \"dblclick\", e, interactionManager, this );\n\t\treturn false;\n\t}\n\n\t//\n\trender( renderer: Renderer ): void {\n\t\tif( this.visible && 0 < this.worldAlpha && this.renderable ) {\n\t\t\tthis.renderBefore( renderer );\n\t\t\tsuper.render( renderer );\n\t\t\tthis.renderAfter( renderer );\n\t\t}\n\t}\n\n\tprotected renderBefore( renderer: Renderer ): void {\n\t\tconst befores = this._befores;\n\t\tfor( let i = 0, imax = befores.length; i < imax; ++i ) {\n\t\t\tconst before = befores[ i ];\n\t\t\tbefore.updateTransform();\n\t\t\tbefore.render( renderer );\n\t\t}\n\t}\n\n\tprotected renderAfter( renderer: Renderer ): void {\n\t\tconst afters = this._afters;\n\t\tfor( let i = 0, imax = afters.length; i < imax; ++i ) {\n\t\t\tconst after = afters[ i ];\n\t\t\tafter.updateTransform();\n\t\t\tafter.render( renderer );\n\t\t}\n\t}\n\n\t//\n\tprotected getThemeDefault(): THEME {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DBase\";\n\t}\n\n\t//\n\tprotected _calculateBounds(): void {\n\t\tconst worldTransform = this.transform.worldTransform;\n\t\tconst bounds = this._bounds;\n\n\t\tconst work = DBase.WORK_CONTAINS_POINT;\n\t\twork.set( 0, 0 );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\twork.set( this._width, this._height );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\tsuper._calculateBounds();\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\treturn this.containsGlobalPoint( point ) || this.containsLocalPoint(\n\t\t\tthis.worldTransform.applyInverse( point, DBase.WORK_CONTAINS_POINT )\n\t\t);\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\tprotected containsLocalPoint( point: Point ): boolean {\n\t\treturn (\n\t\t\t0 <= point.x && point.x <= this._width &&\n\t\t\t0 <= point.y && point.y <= this._height\n\t\t);\n\t}\n\n\t/**\n\t * Returns a clipping rect.\n\t *\n\t * @param result a clipping rect\n\t */\n\tgetClippingRect( target: unknown, result: Rectangle ): void {\n\t\tresult.x = 0;\n\t\tresult.y = 0;\n\t\tresult.width = this._width;\n\t\tresult.height = this._height;\n\t}\n\n\tdestroy(): void {\n\t\t// Layout\n\t\tconst scalarSet = this._scalarSet;\n\t\tscalarSet.x = null;\n\t\tscalarSet.y = null;\n\t\tscalarSet.width = null;\n\t\tscalarSet.height = null;\n\n\t\t// Shadow\n\t\tconst shadow = this._shadow;\n\t\tif( shadow ) {\n\t\t\tthis._shadow = null;\n\t\t\tshadow.destroy();\n\t\t}\n\n\t\t// Children\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Renderer } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DCornerMask } from \"./d-corner-mask\";\n\nexport class DBaseOverflowMask extends Graphics implements DReflowable {\n\tconstructor( parent: DBase ) {\n\t\tsuper();\n\t\t(this as any).parent = parent;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.updateTransform();\n\t\tsuper.render( renderer );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number): void {\n\t\tconst x = 0;\n\t\tconst y = 0;\n\t\tconst corner = base.corner;\n\t\tconst cornerRadius = Math.max( 0, corner.getRadius() - 0.5 );\n\t\tconst cornerMask = corner.getMask();\n\t\tconst tl = ( cornerMask & DCornerMask.TOP_LEFT ? 0 : cornerRadius );\n\t\tconst tr = ( cornerMask & DCornerMask.TOP_RIGHT ? 0 : cornerRadius );\n\t\tconst bl = ( cornerMask & DCornerMask.BOTTOM_LEFT ? 0 : cornerRadius );\n\t\tconst br = ( cornerMask & DCornerMask.BOTTOM_RIGHT ? 0 : cornerRadius );\n\t\tthis.clear();\n\t\tthis.beginFill( 0xFFFFFF, 1 );\n\t\tthis.lineStyle( 0, 0, 0, 0, false );\n\t\tif( tl <= 0 && tr <= 0 && bl <= 0 && br <= 0 ) {\n\t\t\tthis.drawRect( x, y, width, height );\n\t\t} else {\n\t\t\tthis.moveTo( x + tl, y );\n\t\t\tif( 0 < tr ) {\n\t\t\t\tthis.arcTo( x + width, y, x + width, y + height, tr );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x + width, y );\n\t\t\t}\n\t\t\tif( 0 < br ) {\n\t\t\t\tthis.arcTo( x + width, y + height, x, y + height, br );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x + width, y + height );\n\t\t\t}\n\t\t\tif( 0 < bl ) {\n\t\t\t\tthis.arcTo( x, y + height, x, y, bl );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x, y + height );\n\t\t\t}\n\t\t\tif( 0 < tl ) {\n\t\t\t\tthis.arcTo( x, y, x + width, y, tl );\n\t\t\t} else {\n\t\t\t\tthis.lineTo( x, y );\n\t\t\t}\n\t\t}\n\t\tthis.endFill();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\n\nexport type DMouseModifierEvent = WheelEvent | MouseEvent | TouchEvent | interaction.InteractionEvent;\n\nexport class DMouseModifiers {\n\tstatic from( e: DMouseModifierEvent ): DMouseModifier {\n\t\tconst oe = ( \"data\" in e ? e.data.originalEvent : e );\n\t\treturn ( oe.ctrlKey ? DMouseModifier.CTRL : DMouseModifier.NONE ) |\n\t\t\t( oe.altKey ? DMouseModifier.ALT : DMouseModifier.NONE ) |\n\t\t\t( oe.shiftKey ? DMouseModifier.SHIFT : DMouseModifier.NONE );\n\t}\n\n\tstatic match( e: DMouseModifierEvent, modifier: DMouseModifier ): boolean {\n\t\tif( modifier & DMouseModifier.OR ) {\n\t\t\treturn !! (DMouseModifiers.from( e ) & modifier);\n\t\t} else {\n\t\t\treturn DMouseModifiers.from( e ) === modifier;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DDragMode {\n\tOFF,\n\tON,\n\tTOUCH\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DAnimationTimings {\n\tstatic LINEAR( t: number ): number {\n\t\treturn t;\n\t}\n\n\tstatic ELASTIC( t: number ): number {\n\t\treturn t * ( 3 * (1 - t) * (1 - t) + t * ( 3 * (1 - t) + t ) );\n\t}\n\n\tstatic QUAD_IN_OUT( t: number ): number {\n\t\treturn t < 0.5 ? 2 * t * t : -1 + ( 4 - 2 * t ) * t;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * {@link DHtmlElement} option when to show a HTML element\n */\nexport enum UtilHtmlElementWhen {\n\t/**\n\t * Shows a HTML element when clicked.\n\t */\n\tCLICKED,\n\n\t/**\n\t * Shows a HTML element when double clicked.\n\t */\n\tDOUBLE_CLICKED,\n\n\t/**\n\t * Shows a HTML element when focused.\n\t * And also shows when clicked if focused.\n\t */\n\tFOCUSED,\n\n\t/**\n\t * Always shows a HTML element.\n\t */\n\tALWAYS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport {\n\tDAnimation, DAnimationOnEnd, DAnimationOnTime,\n\tDAnimationOptions, DAnimationTiming\n} from \"./d-animation\";\nimport { DAnimationTimings } from \"./d-animation-timings\";\n\nexport class DAnimationBase<TARGET = unknown> extends utils.EventEmitter implements DAnimation<TARGET> {\n\tprotected _id: number | null;\n\tprotected _startTime: number;\n\tprotected _duration: number;\n\tprotected _durationInverse: number;\n\tprotected _reverse: boolean;\n\tprotected _onTime: DAnimationOnTime<TARGET> | undefined;\n\tprotected _onTimeBaseBound: () => void;\n\tprotected _onStart: DAnimationOnEnd<TARGET> | undefined;\n\tprotected _onEnd: DAnimationOnEnd<TARGET> | undefined;\n\tprotected _timing: DAnimationTiming<TARGET>;\n\tprotected _target: TARGET | null;\n\n\tconstructor( options?: DAnimationOptions<TARGET> ) {\n\t\tsuper();\n\n\t\tthis._id = null;\n\t\tthis._target = options?.target ?? null;\n\t\tthis._startTime = 0;\n\t\tthis._duration = options?.duration ?? 200;\n\t\tthis._durationInverse = 1 / Math.max( 1, this._duration );\n\t\tthis._reverse = false;\n\t\tthis._onTime = options?.onTime;\n\t\tthis._onTimeBaseBound = () => {\n\t\t\tthis.onTimeBase();\n\t\t};\n\t\tthis._onStart = options?.onStart;\n\t\tthis._onEnd = options?.onEnd;\n\t\tthis._timing = options?.timing ?? DAnimationTimings.ELASTIC;\n\n\t\t// Events\n\t\tconst on = options?.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tconst handler = on[ name ];\n\t\t\t\tif( handler ) {\n\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget target(): TARGET | null {\n\t\treturn this._target;\n\t}\n\n\tset target( target: TARGET | null ) {\n\t\tthis._target = target;\n\t}\n\n\tget duration(): number {\n\t\treturn this._duration;\n\t}\n\n\tset duration( duration: number ) {\n\t\tthis._duration = duration;\n\t\tthis._durationInverse = 1 / Math.max( 1, duration );\n\t}\n\n\tstart( reverse: boolean = false ): void {\n\t\tthis.stop();\n\t\tthis._startTime = Date.now();\n\t\tthis._reverse = reverse;\n\t\tthis._id = window.setTimeout( this._onTimeBaseBound, 0 );\n\n\t\t// onStart\n\t\tthis.onStart( reverse );\n\n\t\t// onTime\n\t\tconst duration = this._duration;\n\t\tconst time = this.toTime( reverse ? duration : 0 );\n\t\tthis.onTime( time, reverse, 0 );\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst onStart = this._onStart;\n\t\tif( onStart != null ) {\n\t\t\tonStart( isReverse, this );\n\t\t}\n\t\tthis.emit( \"start\", isReverse, this );\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst onTime = this._onTime;\n\t\tif( onTime != null ) {\n\t\t\tonTime( time, isReverse, elapsedTime, this );\n\t\t}\n\t\tthis.emit( \"time\", time, isReverse, elapsedTime, this );\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst onEnd = this._onEnd;\n\t\tif( onEnd != null ) {\n\t\t\tonEnd( isReverse, this );\n\t\t}\n\t\tthis.emit( \"end\", isReverse, this );\n\t}\n\n\tisStarted(): boolean {\n\t\treturn (this._id != null);\n\t}\n\n\tisReverse(): boolean {\n\t\treturn this._reverse;\n\t}\n\n\tprotected onTimeBase(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst duration = this._duration;\n\t\t\tconst reverse = this._reverse;\n\t\t\tif( elapsedTime < duration ) {\n\t\t\t\tthis._id = window.setTimeout( this._onTimeBaseBound, 0 );\n\n\t\t\t\t// OnTime\n\t\t\t\tconst time = this.toTime( reverse ? duration - elapsedTime : elapsedTime );\n\t\t\t\tthis.onTime( time, reverse, elapsedTime );\n\t\t\t} else {\n\t\t\t\t// OnTime\n\t\t\t\tconst time = this.toTime( reverse ? 0 : duration );\n\t\t\t\tthis.onTime( time, reverse, elapsedTime );\n\n\t\t\t\t// OnEnd\n\t\t\t\tthis.onEnd( reverse );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toTime( elapsedTime: number ): number {\n\t\treturn this._timing( elapsedTime * this._durationInverse, this );\n\t}\n\n\tstop(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\twindow.clearTimeout( id );\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst id = this._id;\n\t\tif( id != null ) {\n\t\t\tthis._id = null;\n\t\t\twindow.clearTimeout( id );\n\n\t\t\t// OnTime\n\t\t\tconst reverse = this._reverse;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst duration = this._duration;\n\t\t\tconst time = this.toTime( reverse ? 0 : duration );\n\t\t\tthis.onTime( time, reverse, elapsedTime );\n\n\t\t\t// OnEnd\n\t\t\tthis.onEnd( reverse );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilDragEasingHistory {\n\tdx: number;\n\tdy: number;\n\tds: number;\n\tdt: number;\n\n\tconstructor( dx: number, dy: number, ds: number, dt: number ) {\n\t\tthis.dx = dx;\n\t\tthis.dy = dy;\n\t\tthis.ds = ds;\n\t\tthis.dt = dt;\n\t}\n\n\tset( dx: number, dy: number, ds: number, dt: number ) {\n\t\tthis.dx = dx;\n\t\tthis.dy = dy;\n\t\tthis.ds = ds;\n\t\tthis.dt = dt;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimation } from \"../d-animation\";\nimport { DAnimationBase } from \"../d-animation-base\";\nimport { DAnimationTimings } from \"../d-animation-timings\";\nimport { isNumber } from \"./is-number\";\nimport { UtilDragEasingHistory } from \"./util-drag-easing-history\";\n\nexport type UtilDragEasingOnMove = ( dx: number, dy: number, ds: number, time: number ) => void;\n\nexport interface UtilDragEasingDurationOptions {\n\tposition?: number;\n\tscale?: number;\n}\n\nexport interface UtilDragEasingOptions {\n\tduration?: number | UtilDragEasingDurationOptions;\n}\n\nexport class UtilDragEasing {\n\tprotected static HISTORY_CAPACITY = 5;\n\tprotected _histories: UtilDragEasingHistory[];\n\tprotected _historiesSorted: UtilDragEasingHistory[];\n\tprotected _historyBegin: number;\n\tprotected _historyEnd: number;\n\tprotected _animation: DAnimation;\n\tprotected _dx: number;\n\tprotected _dy: number;\n\tprotected _dt: number;\n\tprotected _ds: number;\n\tprotected _durationPosition: number;\n\tprotected _durationScale: number;\n\tprotected _onMove: UtilDragEasingOnMove;\n\n\tconstructor( onMove: UtilDragEasingOnMove, options?: UtilDragEasingOptions ) {\n\t\tthis._histories = [];\n\t\tthis._historiesSorted = [];\n\t\tthis._historyBegin = 0;\n\t\tthis._historyEnd = -1;\n\t\tthis._dx = 0;\n\t\tthis._dy = 0;\n\t\tthis._ds = 0;\n\t\tthis._dt = 0;\n\t\tthis._animation = new DAnimationBase({\n\t\t\tonTime: ( t: number ): void => {\n\t\t\t\tthis.onEase( t );\n\t\t\t},\n\t\t\ttiming: DAnimationTimings.LINEAR,\n\t\t\tduration: 1000\n\t\t});\n\t\tconst duration = options && options.duration;\n\t\tif( duration ) {\n\t\t\tif( isNumber( duration ) ) {\n\t\t\t\tthis._durationPosition = duration;\n\t\t\t\tthis._durationScale = duration;\n\t\t\t} else {\n\t\t\t\tthis._durationPosition = ( duration.position != null ? duration.position : 1 );\n\t\t\t\tthis._durationScale = ( duration.scale != null ? duration.scale : 1 );\n\t\t\t}\n\t\t} else {\n\t\t\tthis._durationPosition = 1;\n\t\t\tthis._durationScale = 1;\n\t\t}\n\t\tthis._onMove = onMove;\n\t}\n\n\tonStart(): void {\n\t\t// History\n\t\tconst histories = this._histories;\n\t\tfor( let i = histories.length, imax = UtilDragEasing.HISTORY_CAPACITY; i < imax; ++i ) {\n\t\t\thistories.push( new UtilDragEasingHistory( 0, 0, 1, 0 ) );\n\t\t}\n\t\tthis._historyBegin = 0;\n\t\tthis._historyEnd = -1;\n\n\t\t// Stop animation\n\t\tthis._animation.stop();\n\t}\n\n\tonMove( dx: number, dy: number, ds: number, dt: number ): void {\n\t\tconst capacity = UtilDragEasing.HISTORY_CAPACITY;\n\n\t\tconst oldHistoryEnd = this._historyEnd;\n\t\tconst newHistoryEnd = (oldHistoryEnd + 1) % capacity;\n\t\tthis._historyEnd = newHistoryEnd;\n\n\t\tconst oldHistoryBegin = this._historyBegin;\n\t\tif( newHistoryEnd < oldHistoryEnd || (0 <= oldHistoryEnd && oldHistoryEnd < oldHistoryBegin) ) {\n\t\t\tthis._historyBegin = (oldHistoryBegin + 1) % capacity;\n\t\t}\n\n\t\tthis._histories[ newHistoryEnd ].set( dx, dy, ds, dt );\n\t}\n\n\tprotected updateHistoriesSorted( dt: number ): number {\n\t\tconst unsorted = this._histories;\n\t\tconst sorted = this._historiesSorted;\n\t\tconst begin = this._historyBegin;\n\t\tconst end = this._historyEnd;\n\t\tconst length = unsorted.length;\n\t\tconst threshold = 160;\n\t\tif( end < 0 ) {\n\t\t\tsorted.length = 0;\n\t\t\treturn dt;\n\t\t} else if( end < begin ) {\n\t\t\tlet total = dt;\n\t\t\tsorted.length = 0;\n\t\t\tfor( let i = end; 0 <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let i = length - 1; begin <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn total;\n\t\t} else {\n\t\t\tlet total = dt;\n\t\t\tsorted.length = 0;\n\t\t\tfor( let i = end; begin <= i; --i ) {\n\t\t\t\tconst history = unsorted[ i ];\n\t\t\t\tif( total + history.dt < threshold ) {\n\t\t\t\t\ttotal += history.dt;\n\t\t\t\t\tsorted.push( history );\n\t\t\t\t} else {\n\t\t\t\t\treturn total;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn total;\n\t\t}\n\t}\n\n\tonEnd( ldt: number ): void {\n\t\tconst adt = this.updateHistoriesSorted( ldt );\n\t\tconst sorted = this._historiesSorted;\n\t\tconst sortedLength = sorted.length;\n\t\tif( 0 < sortedLength ) {\n\t\t\tlet dx = 0;\n\t\t\tlet dy = 0;\n\t\t\tlet ds = 0;\n\t\t\tlet dt = 0;\n\t\t\tfor( let i = 0; i < sortedLength; ++i ) {\n\t\t\t\tconst history = sorted[ i ];\n\t\t\t\tdx += history.dx;\n\t\t\t\tdy += history.dy;\n\t\t\t\tds += history.ds;\n\t\t\t\tdt += history.dt;\n\t\t\t}\n\t\t\tconst w = (1 - ldt / adt) / sortedLength;\n\t\t\tdx *= w;\n\t\t\tdy *= w;\n\t\t\tds = 1 + (ds - sortedLength) * w;\n\t\t\tdt *= w;\n\t\t\tthis._dx = dx;\n\t\t\tthis._dy = dy;\n\t\t\tthis._ds = ds;\n\t\t\tthis._dt = dt;\n\n\t\t\t// Start animation\n\t\t\tconst d0 = this._durationPosition * 40 * Math.sqrt( dx * dx + dy * dy );\n\t\t\tconst d1 = this._durationScale * 10000 * Math.abs( ds - 1 );\n\t\t\tconst animation = this._animation;\n\t\t\tanimation.duration = Math.max( d0, d1 );\n\t\t\tanimation.start();\n\t\t}\n\t}\n\n\tprotected onEase( time: number ): void {\n\t\tconst w = 1 - time;\n\t\tthis._onMove(\n\t\t\tthis._dx * w,\n\t\t\tthis._dy * w,\n\t\t\t1 + ( this._ds - 1 ) * w,\n\t\t\ttime\n\t\t);\n\t}\n\n\tstop(): void {\n\t\tthis._animation.stop();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { DMouseModifier } from \"../d-mouse-modifier\";\nimport { DMouseModifiers } from \"../d-mouse-modifiers\";\nimport { UtilDragEasing, UtilDragEasingOptions } from \"./util-drag-easing\";\nimport { UtilPointerEvent } from \"./util-pointer-event\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport InteractionManager = interaction.InteractionManager;\n\nexport type UtilDragOnMove = ( dx: number, dy: number, x: number, y: number, ds: number ) => void;\nexport type UtilDragOnStart = () => void;\nexport type UtilDragOnEnd = () => void;\nexport type UtilDragChecker = ( e: InteractionEvent, modifier: DMouseModifier, target: DBase ) => boolean;\n\nexport interface UtilDragCheckerOptions {\n\tstart?: UtilDragChecker;\n\tmove?: UtilDragChecker;\n}\n\nexport interface UtilDragOnOptions {\n\tstart?: UtilDragOnStart;\n\tmove?: UtilDragOnMove;\n\tend?: UtilDragOnEnd;\n}\n\nexport interface UtilDragOptions {\n\ttarget: DBase;\n\ttouch?: boolean;\n\tmodifier?: DMouseModifier;\n\tchecker?: UtilDragCheckerOptions;\n\teasing?: boolean | UtilDragEasingOptions;\n\tbind?: boolean;\n\ton?: UtilDragOnOptions;\n}\n\nconst toEasingOptions = ( options: true | UtilDragEasingOptions | undefined ): UtilDragEasingOptions | undefined => {\n\treturn ( options == null || options === true ?\n\t\tundefined : options\n\t);\n};\n\nconst toChecker = ( options?: UtilDragOptions ): { start: UtilDragChecker, move: UtilDragChecker } => {\n\tconst checker = options && options.checker;\n\tconst defaultChecker = DMouseModifiers.match;\n\tif( checker ) {\n\t\treturn {\n\t\t\tstart: checker.start || defaultChecker,\n\t\t\tmove: checker.move || defaultChecker\n\t\t};\n\t}\n\treturn {\n\t\tstart: defaultChecker,\n\t\tmove: defaultChecker\n\t};\n};\n\nexport class UtilDrag {\n\tprotected static EPSILON = 0.00001;\n\tprotected _target: DBase<any, any>;\n\tprotected _onDownBound: ( e: InteractionEvent ) => void;\n\tprotected _onMoveBound: ( e: InteractionEvent ) => void;\n\tprotected _onEndBound: ( e: InteractionEvent ) => void;\n\tprotected _onStart?: UtilDragOnStart;\n\tprotected _onMove?: UtilDragOnMove;\n\tprotected _onEnd?: UtilDragOnEnd;\n\tprotected _down: string;\n\tprotected _move: string;\n\tprotected _up: string;\n\tprotected _easing?: UtilDragEasing;\n\tprotected _modifier: DMouseModifier;\n\tprotected _checker: { start: UtilDragChecker, move: UtilDragChecker };\n\tprotected _interactionManager: InteractionManager | null;\n\tprotected _center: Point;\n\tprotected _scale: number;\n\tprotected _scalingCenter: Point;\n\tprotected _time: number;\n\n\tconstructor( options: UtilDragOptions ) {\n\t\tconst target = this._target = options.target;\n\t\tconst on = options.on;\n\t\tif( on ) {\n\t\t\tthis._onStart = on.start;\n\t\t\tthis._onMove = on.move;\n\t\t\tthis._onEnd = on.end;\n\t\t}\n\t\tthis._modifier = (options && options.modifier) || DMouseModifier.NONE;\n\t\tthis._checker = toChecker( options );\n\t\tthis._interactionManager = null;\n\t\tthis._center = new Point();\n\t\tthis._scale = 1;\n\t\tthis._scalingCenter = new Point();\n\t\tthis._time = 0;\n\n\t\tconst easing = options.easing;\n\t\tif( easing == null || easing !== false ) {\n\t\t\tconst onEasingMoveBound = ( dx: number, dy: number, ds: number, time: number ): void => {\n\t\t\t\tthis.onEasingMove( dx, dy, ds, time );\n\t\t\t};\n\t\t\tthis._easing = new UtilDragEasing( onEasingMoveBound, toEasingOptions( easing ) );\n\t\t}\n\n\t\tthis._onDownBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onDown( e );\n\t\t};\n\n\t\tthis._onMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMove( e );\n\t\t};\n\n\t\tthis._onEndBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onEnd( e );\n\t\t};\n\n\t\tif( options.touch ) {\n\t\t\tthis._down = \"touchstart\";\n\t\t\tthis._move = \"touchmove\";\n\t\t\tthis._up = \"touchend\";\n\t\t} else {\n\t\t\tthis._down = UtilPointerEvent.down;\n\t\t\tthis._move = UtilPointerEvent.move;\n\t\t\tthis._up = UtilPointerEvent.up;\n\t\t}\n\n\t\tif( options.bind !== false ) {\n\t\t\ttarget.on( this._down, this._onDownBound );\n\t\t}\n\t}\n\n\tprotected calcCenterAndScale(\n\t\te: InteractionEvent, center: Point,\n\t\tinteractionManager: InteractionManager\n\t): number {\n\t\tconst oe = e.data.originalEvent;\n\t\tconst global = e.data.global;\n\t\tif( \"touches\" in oe ) {\n\t\t\tconst touches = oe.touches;\n\t\t\tconst touchesLength = touches.length;\n\t\t\tif( 0 < touchesLength ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst first = touches[ 0 ];\n\t\t\t\tlet centerX = first.clientX;\n\t\t\t\tlet centerY = first.clientY;\n\t\t\t\tfor( let i = 1, imax = touches.length; i < imax; ++i ) {\n\t\t\t\t\tconst touch = touches[ i ];\n\t\t\t\t\tcenterX += touch.clientX;\n\t\t\t\t\tcenterY += touch.clientY;\n\t\t\t\t}\n\t\t\t\tcenterX /= touchesLength;\n\t\t\t\tcenterY /= touchesLength;\n\t\t\t\tinteractionManager.mapPositionToPoint( center, centerX, centerY );\n\n\t\t\t\tif( 1 < touchesLength ) {\n\t\t\t\t\t// Calculate the maximum distance from the center\n\t\t\t\t\tlet squareDistance = 0;\n\t\t\t\t\tfor( let i = 1, imax = touches.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst touch = touches[ i ];\n\t\t\t\t\t\tconst dx = touch.clientX - centerX;\n\t\t\t\t\t\tconst dy = touch.clientY - centerY;\n\t\t\t\t\t\tsquareDistance = Math.max( squareDistance, dx * dx + dy * dy );\n\t\t\t\t\t}\n\t\t\t\t\treturn Math.sqrt( squareDistance );\n\t\t\t\t} else {\n\t\t\t\t\treturn 0;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcenter.copyFrom( global );\n\t\treturn 0;\n\t}\n\n\tonDown( e: InteractionEvent ): void {\n\t\tconst target = this._target;\n\t\tif( this._checker.start( e, this._modifier, target ) ) {\n\t\t\tconst layer = DApplications.getLayer( target );\n\t\t\tif( layer ) {\n\t\t\t\te.stopPropagation();\n\n\t\t\t\tif( target.state.isDragging ) {\n\t\t\t\t\tconst interactionManager = this._interactionManager;\n\t\t\t\t\tif( interactionManager ) {\n\t\t\t\t\t\tconst center = this._center;\n\t\t\t\t\t\tthis._scale = this.calcCenterAndScale( e, center, interactionManager );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ttarget.state.isDragging = true;\n\n\t\t\t\t\t// Interaction manager\n\t\t\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\n\t\t\t\t\tthis._interactionManager = interactionManager;\n\n\t\t\t\t\t// Update the center\n\t\t\t\t\tconst center = this._center;\n\t\t\t\t\tthis._scale = this.calcCenterAndScale( e, center, interactionManager );\n\n\t\t\t\t\t//\n\t\t\t\t\tthis._time = e.data.originalEvent.timeStamp;\n\n\t\t\t\t\t// Easing util\n\t\t\t\t\tconst easing = this._easing;\n\t\t\t\t\tif( easing ) {\n\t\t\t\t\t\teasing.onStart();\n\t\t\t\t\t}\n\n\t\t\t\t\t// User-defined handler\n\t\t\t\t\tconst onStart = this._onStart;\n\t\t\t\t\tif( onStart != null ) {\n\t\t\t\t\t\tonStart();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Event handler\n\t\t\t\t\tinteractionManager.on( this._move, this._onMoveBound );\n\t\t\t\t\tinteractionManager.on( this._up, this._onEndBound );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onMove( e: InteractionEvent ): void {\n\t\tconst target = this._target;\n\t\tif( target.state.isDragging && this._checker.move( e, this._modifier, target ) ) {\n\t\t\tconst interactionManager = this._interactionManager;\n\t\t\tif( interactionManager ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst center = this._center;\n\t\t\t\tconst centerX = center.x;\n\t\t\t\tconst centerY = center.y;\n\t\t\t\tconst newScale = this.calcCenterAndScale( e, center, interactionManager );\n\t\t\t\tconst oldScale = this._scale;\n\t\t\t\tthis._scale = newScale;\n\t\t\t\tconst oldTime = this._time;\n\t\t\t\tconst newTime = e.data.originalEvent.timeStamp;\n\t\t\t\tthis._time = newTime;\n\n\t\t\t\t// Calculate the position\n\t\t\t\tconst dx = center.x - centerX;\n\t\t\t\tconst dy = center.y - centerY;\n\t\t\t\tconst dt = newTime - oldTime;\n\t\t\t\tconst ds = ( UtilDrag.EPSILON < oldScale ? newScale / oldScale : 1 );\n\n\t\t\t\t// Easing util\n\t\t\t\tconst easing = this._easing;\n\t\t\t\tif( easing ) {\n\t\t\t\t\teasing.onMove( dx, dy, ds, dt );\n\t\t\t\t}\n\n\t\t\t\t// User-defined handler\n\t\t\t\tconst onMove = this._onMove;\n\t\t\t\tif( onMove != null ) {\n\t\t\t\t\tif( dx !== 0 || dy !== 0 || ds !== 1 ) {\n\t\t\t\t\t\tonMove( dx, dy, center.x, center.y, ds );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEnd( e: InteractionEvent ): void {\n\t\tconst target = this._target;\n\t\tif( target.state.isDragging ) {\n\t\t\tconst interactionManager = this._interactionManager;\n\t\t\tif( interactionManager ) {\n\t\t\t\t// Update the center\n\t\t\t\tconst center = this._center;\n\t\t\t\tthis._scalingCenter.copyFrom( center );\n\t\t\t\tthis._scale = this.calcCenterAndScale( e, center, interactionManager );\n\n\t\t\t\t// Finalize\n\t\t\t\tconst oe = e.data.originalEvent;\n\t\t\t\tif( \"touches\" in oe ? oe.touches.length <= 0 : true ) {\n\t\t\t\t\ttarget.state.isDragging = false;\n\n\t\t\t\t\t// Event handler\n\t\t\t\t\tthis._interactionManager = null;\n\t\t\t\t\tinteractionManager.off( this._move, this._onMoveBound );\n\t\t\t\t\tinteractionManager.off( this._up, this._onEndBound );\n\n\t\t\t\t\t// User-defined handler\n\t\t\t\t\tconst onEnd = this._onEnd;\n\t\t\t\t\tif( onEnd != null ) {\n\t\t\t\t\t\tonEnd();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Easing util\n\t\t\t\t\tconst easing = this._easing;\n\t\t\t\t\tif( easing ) {\n\t\t\t\t\t\teasing.onEnd( e.data.originalEvent.timeStamp - this._time );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEasingMove( dx: number, dy: number, ds: number, time: number ): void {\n\t\tconst onMove = this._onMove;\n\t\tif( onMove != null ) {\n\t\t\tif( dx !== 0 || dy !== 0 || ds !== 1 ) {\n\t\t\t\tconst scalingCenter = this._scalingCenter;\n\t\t\t\tscalingCenter.set(\n\t\t\t\t\tscalingCenter.x + dx,\n\t\t\t\t\tscalingCenter.y + dy\n\t\t\t\t);\n\t\t\t\tonMove( dx, dy, scalingCenter.x, scalingCenter.y, ds );\n\t\t\t}\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tconst easing = this._easing;\n\t\tif( easing ) {\n\t\t\teasing.stop();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DDragMode } from \"./d-drag-mode\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\nimport { DThemeViewDrag, DViewDrag, DViewDragOptions } from \"./d-view-drag\";\nimport { DViewStopper } from \"./d-view-stopper\";\nimport { DViewToTarget } from \"./d-view-to-target\";\nimport { isString } from \"./util/is-string\";\nimport { UtilDrag } from \"./util/util-drag\";\n\nexport class DViewDragImpl implements DViewDrag {\n\tprotected _parent: DBase;\n\tprotected _toTarget: DViewToTarget;\n\tprotected _stopper: DViewStopper;\n\tprotected _dragUtil?: UtilDrag;\n\tprotected _bind: boolean;\n\n\tconstructor(\n\t\tparent: DBase,\n\t\ttoTarget: DViewToTarget,\n\t\tstopper: DViewStopper,\n\t\ttheme: DThemeViewDrag,\n\t\toptions: DViewDragOptions | undefined\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._toTarget = toTarget;\n\t\tthis._stopper = stopper;\n\n\t\tconst mode = ( options && options.mode != null ?\n\t\t\t( isString( options.mode ) ? DDragMode[ options.mode ] : options.mode ) :\n\t\t\ttheme.getDragMode()\n\t\t);\n\t\tconst modifier = ( options && options.modifier != null ?\n\t\t\t( isString( options.modifier ) ? DMouseModifier[ options.modifier ] : options.modifier ) :\n\t\t\ttheme.getDragModifier()\n\t\t);\n\t\tconst duration = ( options && options.duration != null ?\n\t\t\toptions.duration : {\n\t\t\t\tposition: theme.getDragDurationPosition(),\n\t\t\t\tscale: theme.getDragDurationScale()\n\t\t\t}\n\t\t);\n\t\tconst bind = (mode === DDragMode.TOUCH);\n\t\tthis._bind = bind;\n\t\tif( mode === DDragMode.ON || mode === DDragMode.TOUCH ) {\n\t\t\tthis._dragUtil = new UtilDrag({\n\t\t\t\ttarget: parent,\n\t\t\t\ttouch: bind,\n\t\t\t\tmodifier,\n\t\t\t\tchecker: options && options.checker,\n\t\t\t\teasing: {\n\t\t\t\t\tduration\n\t\t\t\t},\n\t\t\t\tbind,\n\t\t\t\ton: {\n\t\t\t\t\tstart: (): void => {\n\t\t\t\t\t\tthis._stopper.stop();\n\t\t\t\t\t},\n\t\t\t\t\tmove: ( dx: number, dy: number, x: number, y: number, ds: number ): void => {\n\t\t\t\t\t\tconst target = toTarget( parent );\n\t\t\t\t\t\tif( target != null ) {\n\t\t\t\t\t\t\t// Scale\n\t\t\t\t\t\t\tconst oldScale = target.scale.y;\n\t\t\t\t\t\t\tconst newScale = stopper.toNormalizedScale( oldScale * ds );\n\t\t\t\t\t\t\tconst scaleRatio = newScale / oldScale;\n\n\t\t\t\t\t\t\t// Position\n\t\t\t\t\t\t\tconst cx = x - dx;\n\t\t\t\t\t\t\tconst cy = y - dy;\n\t\t\t\t\t\t\tconst position = target.position;\n\t\t\t\t\t\t\tconst newX = (position.x - cx) * scaleRatio + x;\n\t\t\t\t\t\t\tconst newY = (position.y - cy) * scaleRatio + y;\n\n\t\t\t\t\t\t\t// Update\n\t\t\t\t\t\t\ttarget.scale.set( newScale, newScale );\n\t\t\t\t\t\t\ttarget.position.set( newX, newY );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t}\n\n\tonDown( e: interaction.InteractionEvent ): void {\n\t\tif( ! this._bind ) {\n\t\t\tconst dragUtil = this._dragUtil;\n\t\t\tif( dragUtil ) {\n\t\t\t\tdragUtil.onDown( e );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimation } from \"./d-animation\";\nimport { DAnimationBase } from \"./d-animation-base\";\nimport { DBase } from \"./d-base\";\nimport { DViewStopper } from \"./d-view-stopper\";\nimport { DViewTarget, DViewToTarget } from \"./d-view-to-target\";\nimport { DViewTransform } from \"./d-view-transform\";\n\nexport class DViewTransformImpl implements DViewTransform {\n\tprotected _parent: DBase;\n\tprotected _toTarget: DViewToTarget;\n\tprotected _newX: number;\n\tprotected _newY: number;\n\tprotected _newScaleX: number;\n\tprotected _newScaleY: number;\n\tprotected _oldX: number;\n\tprotected _oldY: number;\n\tprotected _oldScaleX: number;\n\tprotected _oldScaleY: number;\n\tprotected _animation: DAnimation;\n\tprotected _stopper: DViewStopper;\n\tprotected _duration: number;\n\n\tconstructor( parent: DBase, toTarget: DViewToTarget, stopper: DViewStopper, duration: number ) {\n\t\tthis._parent = parent;\n\t\tthis._toTarget = toTarget;\n\t\tthis._newScaleX = 1;\n\t\tthis._newScaleY = 1;\n\t\tthis._newX =  0;\n\t\tthis._newY = 0;\n\t\tthis._oldScaleX = 1;\n\t\tthis._oldScaleY = 1;\n\t\tthis._oldX = 0;\n\t\tthis._oldY = 0;\n\t\tthis._animation = new DAnimationBase({\n\t\t\tonTime: ( time: number ): void => {\n\t\t\t\tthis.onTime( time );\n\t\t\t},\n\t\t\tduration\n\t\t});\n\t\tthis._stopper = stopper;\n\t\tthis._duration = duration;\n\t}\n\n\tprotected onTime( time: number ): void {\n\t\tconst w0 = 1 - time;\n\t\tconst w1 = time;\n\n\t\tconst scaleX = this._oldScaleX * w0 + this._newScaleX * w1;\n\t\tconst scaleY = this._oldScaleY * w0 + this._newScaleY * w1;\n\t\tconst x = this._oldX * w0 + this._newX * w1;\n\t\tconst y = this._oldY * w0 + this._newY * w1;\n\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target != null ) {\n\t\t\ttarget.scale.set( scaleX, scaleY );\n\t\t\ttarget.position.set( x, y );\n\t\t}\n\t}\n\n\tstart(\n\t\ttarget: DViewTarget,\n\t\tx: number, Y: number,\n\t\tscaleX: number, scaleY: number,\n\t\tduration?: number, stop?: boolean\n\t): void {\n\t\tif( stop !== false ) {\n\t\t\tthis._stopper.stop();\n\t\t}\n\t\tif( duration == null ) {\n\t\t\tduration = this._duration;\n\t\t}\n\t\tif( duration <= 0 ) {\n\t\t\ttarget.scale.set( scaleX, scaleY );\n\t\t\ttarget.position.set( x, Y );\n\t\t} else {\n\t\t\tconst position = target.position;\n\t\t\tconst scale = target.scale;\n\t\t\tthis._oldX = position.x;\n\t\t\tthis._oldY = position.y;\n\t\t\tthis._oldScaleX = scale.x;\n\t\t\tthis._oldScaleY = scale.y;\n\n\t\t\tthis._newX = x;\n\t\t\tthis._newY = Y;\n\t\t\tthis._newScaleX = scaleX;\n\t\t\tthis._newScaleY = scaleY;\n\n\t\t\tthis._animation.duration = duration;\n\t\t\tthis._animation.start();\n\t\t}\n\t}\n\n\tstop(): void {\n\t\tthis._animation.stop();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, IPoint, Point, Rectangle } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DMouseModifier } from \"./d-mouse-modifier\";\nimport { DMouseModifiers } from \"./d-mouse-modifiers\";\nimport { DThemeView, DView, DViewChecker, DViewOptions } from \"./d-view\";\nimport { DViewDrag } from \"./d-view-drag\";\nimport { DViewDragImpl } from \"./d-view-drag-impl\";\nimport { DViewTargetPoint, DViewToTarget } from \"./d-view-to-target\";\nimport { DViewTransformImpl } from \"./d-view-transform-impl\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isString } from \"./util/is-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport class DViewImpl implements DView {\n\tprotected _parent: DBase;\n\tprotected _toTarget: DViewToTarget;\n\n\tprotected _zoomPoint: Point;\n\tprotected _zoomMin: number;\n\tprotected _zoomMax: number;\n\tprotected _zoomKeepRatio: boolean;\n\n\tprotected _isWheelZoomEnabled: boolean;\n\tprotected _wheelZoomSpeed: number;\n\tprotected _wheelZoomModifier: DMouseModifier;\n\tprotected _wheelZoomChecker: DViewChecker;\n\n\tprotected _isDblClickZoomEnabled: boolean;\n\tprotected _dblClickZoomSpeed: number;\n\tprotected _dblClickZoomModifier: DMouseModifier;\n\tprotected _dblClickZoomChecker: DViewChecker;\n\tprotected _dblclickZoomDuration: number;\n\n\tprotected _isWheelTranslationEnabled: boolean;\n\tprotected _wheelTranslationSpeed: number;\n\tprotected _wheelTranslationModifier: DMouseModifier;\n\tprotected _wheelTranslationChecker: DViewChecker;\n\n\tprotected _transform: DViewTransformImpl;\n\tprotected _drag: DViewDragImpl;\n\n\tprotected _workRect: Rectangle;\n\n\tconstructor( parent: DBase, toTarget: DViewToTarget, options: DViewOptions | undefined ) {\n\t\tthis._parent = parent;\n\t\tthis._toTarget = toTarget;\n\n\t\tthis._workRect = new Rectangle();\n\n\t\t// Theme\n\t\tconst theme = this.toTheme( options ) || this.getThemeDefault();\n\n\t\t// Zoom\n\t\tconst zoom = options && options.zoom;\n\t\tthis._zoomPoint = new Point();\n\t\tthis._zoomMin = zoom && zoom.min != null ? zoom.min : theme.getZoomMin();\n\t\tthis._zoomMax = zoom && zoom.max != null ? zoom.max : theme.getZoomMax();\n\t\tthis._zoomKeepRatio = zoom && zoom.keepRatio != null ? zoom.keepRatio : theme.getZoomKeepRatio();\n\n\t\t// Zoom: Wheel\n\t\tconst wheelZoom = zoom && zoom.wheel;\n\t\tthis._isWheelZoomEnabled = ( wheelZoom && wheelZoom.enable != null ?\n\t\t\twheelZoom.enable : theme.isWheelZoomEnabled()\n\t\t);\n\t\tthis._wheelZoomSpeed = ( wheelZoom && wheelZoom.speed != null ?\n\t\t\twheelZoom.speed : theme.getWheelZoomSpeed()\n\t\t);\n\t\tthis._wheelZoomModifier = ( wheelZoom && wheelZoom.modifier != null ?\n\t\t\t( isString( wheelZoom.modifier ) ?\n\t\t\t\tDMouseModifier[ wheelZoom.modifier ] : wheelZoom.modifier\n\t\t\t) :\n\t\t\ttheme.getWheelZoomModifier()\n\t\t);\n\t\tthis._wheelZoomChecker = (wheelZoom && wheelZoom.checker) || DMouseModifiers.match;\n\n\t\t// Zoom: Dbl click\n\t\tconst dblClickZoom = zoom && zoom.dblclick;\n\t\tthis._isDblClickZoomEnabled = ( dblClickZoom && dblClickZoom.enable != null ?\n\t\t\tdblClickZoom.enable : theme.isDblClickZoomEnabled()\n\t\t);\n\t\tthis._dblClickZoomSpeed = ( dblClickZoom && dblClickZoom.amount != null ?\n\t\t\tdblClickZoom.amount : theme.getDblClickZoomSpeed()\n\t\t);\n\t\tthis._dblClickZoomModifier = ( dblClickZoom && dblClickZoom.modifier != null ?\n\t\t\t( isString( dblClickZoom.modifier ) ?\n\t\t\t\tDMouseModifier[ dblClickZoom.modifier ] : dblClickZoom.modifier\n\t\t\t) :\n\t\t\ttheme.getDblClickZoomModifier()\n\t\t);\n\t\tthis._dblClickZoomChecker = ( dblClickZoom && dblClickZoom.checker ) || DMouseModifiers.match;\n\t\tthis._dblclickZoomDuration = ( dblClickZoom && dblClickZoom.duration != null ?\n\t\t\tdblClickZoom.duration : theme.getDblClickZoomDuration()\n\t\t);\n\n\t\t// Translation: Wheel\n\t\tconst wheelTranslation = options && options.translation && options.translation.wheel;\n\t\tthis._isWheelTranslationEnabled = ( wheelTranslation && wheelTranslation.enable != null ?\n\t\t\twheelTranslation.enable : theme.isWheelTranslationEnabled()\n\t\t);\n\t\tthis._wheelTranslationSpeed = ( wheelTranslation && wheelTranslation.speed != null ?\n\t\t\twheelTranslation.speed : theme.getWheelTranslationSpeed()\n\t\t);\n\t\tthis._wheelTranslationModifier = ( wheelTranslation && wheelTranslation.modifier != null ?\n\t\t\t( isString( wheelTranslation.modifier ) ?\n\t\t\t\tDMouseModifier[ wheelTranslation.modifier ] : wheelTranslation.modifier\n\t\t\t) :\n\t\t\ttheme.getWheelTranslationModifier()\n\t\t);\n\t\tthis._wheelTranslationChecker = ( wheelTranslation && wheelTranslation.checker ) || DMouseModifiers.match;\n\n\t\t// Drag\n\t\tthis._drag = new DViewDragImpl( parent, toTarget, this, theme, options && options.drag );\n\n\t\t// Transform\n\t\tthis._transform = new DViewTransformImpl( parent, toTarget, this, this._dblclickZoomDuration );\n\t}\n\n\tget drag(): DViewDrag {\n\t\treturn this._drag;\n\t}\n\n\tstop(): void {\n\t\tthis._drag.stop();\n\t\tthis._transform.stop();\n\t}\n\n\treset( duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst target = this._toTarget( parent );\n\t\tif( target ) {\n\t\t\tconst targetRect = target.getLocalBounds( this._workRect );\n\t\t\tconst newTargetX = (parent.width - targetRect.width) * 0.5 - targetRect.x;\n\t\t\tconst newTargetY = (parent.height - targetRect.height) * 0.5 - targetRect.y;\n\t\t\tthis._transform.start( target, newTargetX, newTargetY, 1, 1, duration, stop );\n\t\t}\n\t}\n\n\tfit( duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tconst target = this._toTarget( parent ) as any;\n\t\tif( target ) {\n\t\t\tconst padding = parent.padding;\n\t\t\tconst width = parent.width;\n\t\t\tconst height = parent.height;\n\t\t\tconst targetRect = target.getLocalBounds( this._workRect );\n\t\t\tconst targetX = targetRect.x;\n\t\t\tconst targetY = targetRect.y;\n\t\t\tconst targetWidth = targetRect.width;\n\t\t\tconst targetHeight = targetRect.height;\n\t\t\tlet newTargetScaleX = (width - padding.getLeft() - padding.getRight()) / targetWidth;\n\t\t\tlet newTargetScaleY = (height - padding.getTop() - padding.getBottom()) / targetHeight;\n\t\t\tif( this._zoomKeepRatio ) {\n\t\t\t\tconst newTargetScale = this.toNormalizedScale( Math.min( newTargetScaleX, newTargetScaleY ) );\n\t\t\t\tnewTargetScaleX = newTargetScale;\n\t\t\t\tnewTargetScaleY = newTargetScale;\n\t\t\t} else {\n\t\t\t\tnewTargetScaleX = this.toNormalizedScale( newTargetScaleX );\n\t\t\t\tnewTargetScaleY = this.toNormalizedScale( newTargetScaleY );\n\t\t\t}\n\t\t\tconst newTargetWidth = targetWidth * newTargetScaleX;\n\t\t\tconst newTargetHeight = targetHeight * newTargetScaleY;\n\t\t\tconst newTargetX = (width - newTargetWidth) * 0.5 - targetX * newTargetScaleX;\n\t\t\tconst newTargetY = (height - newTargetHeight) * 0.5 - targetY * newTargetScaleY;\n\t\t\tthis._transform.start( target, newTargetX, newTargetY, newTargetScaleX, newTargetScaleY, duration, stop );\n\t\t}\n\t}\n\n\tzoomIn( duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst factor = this._dblClickZoomSpeed;\n\t\t\tconst targetScale = target.scale;\n\t\t\tthis.zoom( targetScale.x * factor, targetScale.y * factor, duration, stop );\n\t\t}\n\t}\n\n\tzoomOut( duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst factor = 1 / this._dblClickZoomSpeed;\n\t\t\tconst targetScale = target.scale;\n\t\t\tthis.zoom( targetScale.x * factor, targetScale.y * factor, duration, stop );\n\t\t}\n\t}\n\n\tzoomAt( x: number, y: number, scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\t// Scale\n\t\t\tconst oldScaleX = target.scale.x;\n\t\t\tconst oldScaleY = target.scale.y;\n\t\t\tconst newScaleX = this.toNormalizedScale( scaleX );\n\t\t\tconst newScaleY = this.toNormalizedScale( scaleY );\n\t\t\tconst scaleRatioX = newScaleX / oldScaleX;\n\t\t\tconst scaleRatioY = newScaleY / oldScaleY;\n\n\t\t\t// Position\n\t\t\tconst newX = (target.position.x - x) * scaleRatioX + x;\n\t\t\tconst newY = (target.position.y - y) * scaleRatioY + y;\n\n\t\t\t// Start\n\t\t\tthis._transform.start( target, newX, newY, newScaleX, newScaleY, duration, stop );\n\t\t}\n\t}\n\n\tzoomAtGlobal( x: number, y: number, scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\n\t\tconst local = this._zoomPoint;\n\t\tlocal.set( x, y );\n\t\tthis.toLocal( local, local );\n\t\tthis.zoomAt( local.x, local.y, scaleX, scaleY, duration, stop );\n\t}\n\n\tzoom( scaleX: number, scaleY: number, duration?: number, stop?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tthis.zoomAt( parent.width * 0.5, parent.height * 0.5, scaleX, scaleY, duration, stop );\n\t}\n\n\tget scale(): DViewTargetPoint {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\treturn target.scale;\n\t\t}\n\t\treturn new Point( 1, 1 );\n\t}\n\n\tset scale( scale: DViewTargetPoint ) {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst newScaleX = this.toNormalizedScale( scale.x );\n\t\t\tconst newScaleY = this.toNormalizedScale( scale.y );\n\t\t\ttarget.scale.set( newScaleX, newScaleY );\n\t\t}\n\t}\n\n\tmoveTo( x: number, y: number, duration?: number, stop?: boolean ): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tconst targetScale = target.scale;\n\t\t\tthis._transform.start( target, x, y, targetScale.x, targetScale.y, duration, stop );\n\t\t}\n\t}\n\n\tget position(): DViewTargetPoint {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\treturn target.position;\n\t\t}\n\t\treturn new Point( 0, 0 );\n\t}\n\n\tset position( position: DViewTargetPoint ) {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\ttarget.position.set( position.x, position.y );\n\t\t}\n\t}\n\n\ttransform(\n\t\tx: number, y: number,\n\t\tscaleX: number, scaleY: number,\n\t\tduration?: number, stop?: boolean\n\t): void {\n\t\tconst target = this._toTarget( this._parent );\n\t\tif( target ) {\n\t\t\tthis._transform.start( target, x, y, scaleX, scaleY, duration, stop );\n\t\t}\n\t}\n\n\ttoLocal( global: IPoint, local: IPoint, skipUpdate?: boolean ): IPoint {\n\t\treturn this._parent.toLocal( global, undefined, local, skipUpdate );\n\t}\n\n\ttoGlobal( local: IPoint, global: IPoint, skipUpdate?: boolean ): IPoint {\n\t\treturn this._parent.toGlobal( local, global, skipUpdate );\n\t}\n\n\ttoNormalizedScale( scale: number ): number {\n\t\treturn Math.min( this._zoomMax, Math.max( this._zoomMin, scale ) );\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tif( this._isWheelZoomEnabled &&\n\t\t\tthis._wheelZoomChecker( e, this._wheelZoomModifier, this._parent ) ) {\n\t\t\tif( deltas.deltaY !== 0 ) {\n\t\t\t\tconst target = this._toTarget( this._parent );\n\t\t\t\tif( target ) {\n\t\t\t\t\tconst speed = deltas.lowest * this._wheelZoomSpeed;\n\t\t\t\t\tconst factor = 1 + deltas.deltaY * speed;\n\t\t\t\t\tconst targetScale = target.scale;\n\t\t\t\t\tthis.zoomAtGlobal( global.x, global.y, targetScale.x * factor, targetScale.y * factor, 0 );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( this._isWheelTranslationEnabled &&\n\t\t\tthis._wheelTranslationChecker( e, this._wheelTranslationModifier, this._parent ) ) {\n\t\t\tconst target = this._toTarget( this._parent );\n\t\t\tif( target ) {\n\t\t\t\tthis.stop();\n\t\t\t\tconst speed = deltas.lowest * this._wheelTranslationSpeed;\n\t\t\t\ttarget.position.set(\n\t\t\t\t\ttarget.position.x - deltas.deltaX * speed,\n\t\t\t\t\ttarget.position.y + deltas.deltaY * speed\n\t\t\t\t);\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tonDown( e: interaction.InteractionEvent ): void {\n\t\tthis._drag.onDown( e );\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tif( this._isDblClickZoomEnabled &&\n\t\t\tthis._dblClickZoomChecker( e, this._dblClickZoomModifier, this._parent ) ) {\n\t\t\tconst target = this._toTarget( this._parent );\n\t\t\tif( target ) {\n\t\t\t\tconst global = this._zoomPoint;\n\t\t\t\tUtilPointerEvent.toGlobal( e, interactionManager, global );\n\t\t\t\tconst factor = this._dblClickZoomSpeed;\n\t\t\t\tconst targetScale = target.scale;\n\t\t\t\tthis.zoomAtGlobal( global.x, global.y, targetScale.x * factor, targetScale.y * factor, this._dblclickZoomDuration );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprotected toTheme( options?: DViewOptions ): DThemeView | null {\n\t\tif( options && options.theme ) {\n\t\t\tconst theme = options.theme;\n\t\t\tif( isString( theme ) ) {\n\t\t\t\treturn DThemes.getInstance().get( theme );\n\t\t\t} else {\n\t\t\t\treturn theme;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getThemeDefault(): DThemeView {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DView\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseEvents, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DCanvas } from \"./d-canvas\";\nimport { DView, DViewOptions } from \"./d-view\";\nimport { DViewImpl } from \"./d-view-impl\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\n/**\n * {@link DCanvasContainer} events.\n */\nexport interface DCanvasContainerEvents<CANVAS, EMITTER> extends DBaseEvents<EMITTER> {\n\t/**\n\t * Triggered when a canvas is removed.\n\t *\n\t * @param canvas a removed canvas\n\t * @param emitter an emitter\n\t */\n\tunset( canvas: CANVAS, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a canvas is set.\n\t *\n\t * @param canvas a new canvas\n\t * @param emitter an emitter\n\t */\n\tset( canvas: CANVAS, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DCanvasContainer} \"on\" options.\n */\nexport interface DCanvasContainerOnOptions<CANVAS, EMITTER> extends Partial<DCanvasContainerEvents<CANVAS, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DCanvasContainer} options.\n */\nexport interface DCanvasContainerOptions<\n\tCANVAS extends DBase = DCanvas,\n\tCANVAS_OPTIONS extends DBaseOptions = DBaseOptions,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer,\n\tEMITTER = any\n> extends DBaseOptions<THEME> {\n\tmask?: boolean;\n\tview?: DViewOptions;\n\tcanvas?: CANVAS | CANVAS_OPTIONS;\n\ton?: DCanvasContainerOnOptions<CANVAS, EMITTER>;\n}\n\n/**\n * {@link DCanvasContainer} theme.\n */\nexport interface DThemeCanvasContainer extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n}\n\n/**\n * A canvas container.\n */\nexport class DCanvasContainer<\n\tCANVAS extends DBase = DCanvas,\n\tCANVAS_OPTIONS extends DBaseOptions = DBaseOptions,\n\tTHEME extends DThemeCanvasContainer = DThemeCanvasContainer,\n\tOPTIONS extends DCanvasContainerOptions<CANVAS, CANVAS_OPTIONS, THEME>\n\t\t= DCanvasContainerOptions<CANVAS, CANVAS_OPTIONS, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _canvas!: CANVAS | null;\n\tprotected _canvasOptions?: CANVAS_OPTIONS | null;\n\tprotected _overflowMask?: DBaseOverflowMask | null;\n\tprotected _view!: DViewImpl;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._canvas = null;\n\t\tconst theme = this.theme;\n\t\tthis._view = new DViewImpl( this, () => this._canvas, options?.view );\n\n\t\t// Canvas\n\t\tconst canvas = options?.canvas;\n\t\tif( canvas instanceof DBase ) {\n\t\t\tthis._canvasOptions = null;\n\t\t\tthis.canvas = canvas;\n\t\t} else {\n\t\t\tthis._canvasOptions = canvas;\n\t\t}\n\n\t\t// Overflow mask\n\t\tconst mask = options?.mask ?? theme.isOverflowMaskEnabled();\n\t\tif( mask ) {\n\t\t\tthis.mask = this.getOverflowMask();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DCanvasContainer\";\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.updateContentSize( newWidth, newHeight, oldWidth, oldHeight );\n\t}\n\n\tget canvas(): CANVAS | null {\n\t\treturn this._canvas;\n\t}\n\n\tset canvas( canvas: CANVAS | null ) {\n\t\tconst previous = this._canvas;\n\t\tif( previous != null ) {\n\t\t\tthis._canvas = null;\n\t\t\tthis.removeChild( previous );\n\t\t\tthis.emit( \"unset\", previous, this );\n\t\t\tprevious.destroy();\n\t\t}\n\n\t\tthis._canvas = canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis.addChild( canvas );\n\t\t\tthis._view.reset( 0 );\n\t\t\tthis.emit( \"set\", canvas, this );\n\t\t} else {\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tprotected getOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tprotected updateContentSize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst canvasX = canvas.x + (newWidth - oldWidth) * 0.5;\n\t\t\tconst canvasY = canvas.y + (newHeight - oldHeight) * 0.5;\n\t\t\tcanvas.position.set( canvasX, canvasY );\n\t\t}\n\t}\n\n\tget view(): DView {\n\t\treturn this._view;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst vresult = this._view.onWheel( e, deltas, global );\n\t\tconst sresult = super.onWheel( e, deltas, global );\n\t\treturn vresult || sresult;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst vresult = this._view.onDblClick( e, interactionManager );\n\t\tconst sresult = super.onDblClick( e, interactionManager );\n\t\treturn vresult || sresult;\n\t}\n\n\tprotected onDown( e: interaction.InteractionEvent ): void {\n\t\tthis._view.onDown( e );\n\t\tsuper.onDown( e );\n\t}\n\n\tdestroy(): void {\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\t\t(this as any).mask = null;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCanvasContainer } from \"../../d-canvas-container\";\nimport { EShape } from \"../e-shape\";\n\ninterface EShapeActionRuntimeContainerTagRemote {\n\tset( id: string, value: unknown, time: number ): void;\n}\n\ninterface EShapeActionRuntimeContainerTag {\n\treadonly remote: EShapeActionRuntimeContainerTagRemote;\n\n\tset( id: string, value: unknown, time?: number, from?: number | null, to?: number | null ): void;\n}\n\ninterface EShapeActionRuntimeContainerShape {\n\temit( name: string, ...args: unknown[] ): void;\n}\n\ninterface EShapeActionRuntimeContainer extends DCanvasContainer {\n\treadonly shape: EShapeActionRuntimeContainerShape;\n\treadonly tag: EShapeActionRuntimeContainerTag;\n\n\topenByName( target: string ): void;\n}\n\nexport class EShapeActionRuntimes {\n\tstatic toContainer( shape?: EShape | null ): EShapeActionRuntimeContainer | null {\n\t\tlet current: { parent: any; } | null | undefined = shape;\n\t\twhile( current != null ) {\n\t\t\tif( current instanceof DCanvasContainer ) {\n\t\t\t\treturn current as EShapeActionRuntimeContainer;\n\t\t\t}\n\t\t\tcurrent = current.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic open( shape: EShape, target: string ) {\n\t\tconst container = this.toContainer( shape );\n\t\tif( container ) {\n\t\t\tcontainer.openByName( target );\n\t\t}\n\t}\n\n\tstatic write( shape: EShape, id: string, value: unknown, time: number, remote: boolean ) {\n\t\tconst container = this.toContainer( shape );\n\t\tif( container ) {\n\t\t\tif( remote ) {\n\t\t\t\tcontainer.tag.remote.set( id, value, time );\n\t\t\t} else {\n\t\t\t\tcontainer.tag.set( id, value, time );\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic emit( shape: EShape, name: string ): void;\n\tstatic emit( shape: EShape, name: string, value: unknown, time: number ): void;\n\tstatic emit( shape: EShape, name: string, value?: unknown, time?: number ): void {\n\t\tconst container = EShapeActionRuntimes.toContainer( shape );\n\t\tif( time === undefined ) {\n\t\t\tshape.emit( name, shape );\n\t\t\tif( container ) {\n\t\t\t\tcontainer.shape.emit( name, shape );\n\t\t\t}\n\t\t} else {\n\t\t\tshape.emit( name, value, time, shape );\n\t\t\tif( container ) {\n\t\t\t\tcontainer.shape.emit( name, value, time, shape );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\nimport { EShapeActionValueEmitEvent } from \"./e-shape-action-value-emit-event\";\n\nexport class EShapeActionRuntimeEmitEvent extends EShapeActionRuntimeConditional {\n\tprotected name: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueEmitEvent ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t\tthis.name = EShapeActionExpressions.ofStringOrNull( value.name );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst name = this.name( shape, time );\n\t\t\tif( name != null ) {\n\t\t\t\tEShapeActionRuntimes.emit( shape, name );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeEmitEvent } from \"./e-shape-action-runtime-emit-event\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBase } from \"./e-shape-action-value-base\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueEmitEventSerialized = [\n\tEShapeActionValueType.EMIT_EVENT, number, number\n];\n\nexport class EShapeActionValueEmitEvent extends EShapeActionValueBase {\n\treadonly name: string;\n\n\tconstructor( condition: string, name: string ) {\n\t\tsuper( EShapeActionValueType.EMIT_EVENT, condition );\n\t\tthis.name = name;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueEmitEvent) &&\n\t\t\tthis.name === value.name\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeEmitEvent {\n\t\treturn new EShapeActionRuntimeEmitEvent( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\tconst nameId = manager.addResource(this.name);\n\t\treturn manager.addResource( `[${this.type},${conditionId},${nameId}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueEmitEventSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueEmitEvent {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst name = EShapeActionValues.toResource( 2, serialized, manager.resources );\n\t\treturn new EShapeActionValueEmitEvent( condition, name );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\nimport { EShapeActionValueMisc } from \"./e-shape-action-value-misc\";\n\nexport class EShapeActionRuntimeMiscEmitEvent extends EShapeActionRuntimeConditional {\n\tprotected target: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueMisc ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t\tthis.target = EShapeActionExpressions.ofStringOrNull( value.target );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\tEShapeActionRuntimes.emit( shape, target );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const DHtmlElementState = {\n\tNO_POINTER_EVENTS: \"NO_POINTER_EVENTS\"\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Matrix, Point, Rectangle, Renderer } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { DBaseStateSet } from \"../d-base-state-set\";\nimport { DFocusableMightBe } from \"../d-controller-focus\";\nimport { toEnum } from \"./to-enum\";\nimport { UtilHtmlElementWhen } from \"./util-html-element-when\";\n\nexport interface UtilHtmlElementPaddingLTRB {\n\tgetLeft(): number;\n\tgetTop(): number;\n\tgetRight(): number;\n\tgetBottom(): number;\n}\n\nexport interface UtilHtmlElementPaddingVH {\n\treadonly horizontal: number;\n\treadonly vertical: number;\n}\n\nexport type UtilHtmlElementPadding = UtilHtmlElementPaddingVH | UtilHtmlElementPaddingLTRB;\n\nexport type UtilHtmlElementCreator<T extends HTMLElement> = ( container: HTMLElement ) => T | null;\nexport type UtilHtmlElementStyler<T extends HTMLElement> = (\n\ttarget: T,\n\tstate: DBaseStateSet, padding: UtilHtmlElementPadding | null,\n\telementRect: Rectangle | null, elementMatrix: Matrix | null,\n\tclipperRect: Rectangle | null\n) => void;\n\nexport type UtilHtmlElementStylerBefore = ( target: HTMLDivElement ) => void;\nexport type UtilHtmlElementStylerAfter = ( target: HTMLDivElement ) => void;\nexport type UtilHtmlElementToRect = ( resolution: number, work: Point, result: Rectangle ) => Rectangle | null;\nexport type UtilHtmlElementToMatrix = () => Matrix | null;\n\nexport interface UtilHtmlElementElementOptions<ELEMENT extends HTMLElement> {\n\tcreator?: UtilHtmlElementCreator<ELEMENT>;\n\tstyler?: UtilHtmlElementStyler<ELEMENT>;\n}\n\nexport interface UtilHtmlElementClipperOptions {\n\tcreator?: UtilHtmlElementCreator<HTMLDivElement>;\n\tstyler?: UtilHtmlElementStyler<HTMLDivElement>;\n}\n\nexport interface UtilHtmlElementBeforeOptions {\n\tcreator?: UtilHtmlElementCreator<HTMLDivElement>;\n\tstyler?: UtilHtmlElementStylerBefore;\n}\n\nexport interface UtilHtmlElementAfterOptions {\n\tcreator?: UtilHtmlElementCreator<HTMLDivElement>;\n\tstyler?: UtilHtmlElementStylerAfter;\n}\n\nexport interface UtilHtmlElementOptions<ELEMENT extends HTMLElement = HTMLElement> {\n\telement?: UtilHtmlElementElementOptions<ELEMENT>;\n\tclipper?: UtilHtmlElementClipperOptions;\n\tbefore?: UtilHtmlElementBeforeOptions;\n\tafter?: UtilHtmlElementAfterOptions;\n\twhen?: UtilHtmlElementWhen | (keyof typeof UtilHtmlElementWhen);\n\tselect?: boolean;\n}\n\nexport interface UtilThemeHtmlElement<ELEMENT extends HTMLElement> {\n\tgetElementCreator(): UtilHtmlElementCreator<ELEMENT>;\n\tsetElementStyle(\n\t\ttarget: ELEMENT, state: DBaseStateSet, padding: UtilHtmlElementPadding | null,\n\t\telementRect: Rectangle | null, elementMatrix: Matrix | null,\n\t\tclipperRect: Rectangle | null\n\t): void;\n\tgetClipperCreator(): UtilHtmlElementCreator<HTMLDivElement>;\n\tsetClipperStyle( target: HTMLDivElement, state: DBaseStateSet, padding: UtilHtmlElementPadding | null,\n\t\telementRect: Rectangle | null, elementMatrix: Matrix | null,\n\t\tclipperRect: Rectangle | null\n\t): void;\n\tgetBeforeCreator(): UtilHtmlElementCreator<HTMLDivElement>;\n\tsetBeforeStyle( target: HTMLDivElement ): void;\n\tgetAfterCreator(): UtilHtmlElementCreator<HTMLDivElement>;\n\tsetAfterStyle( target: HTMLDivElement ): void;\n\tgetWhen(): UtilHtmlElementWhen;\n\tgetSelect(): boolean;\n}\n\nexport interface UtilHtmlElementElementData<ELEMENT extends HTMLElement> {\n\tcreator: UtilHtmlElementCreator<ELEMENT>;\n\tstyler: UtilHtmlElementStyler<ELEMENT>;\n}\n\nexport interface UtilHtmlElementClipperData {\n\tcreator: UtilHtmlElementCreator<HTMLDivElement>;\n\tstyler: UtilHtmlElementStyler<HTMLDivElement>;\n}\n\nexport interface UtilHtmlElementBeforeData {\n\tcreator: UtilHtmlElementCreator<HTMLDivElement>;\n\tstyler: UtilHtmlElementStylerBefore;\n}\n\nexport interface UtilHtmlElementAfterData {\n\tcreator: UtilHtmlElementCreator<HTMLDivElement>;\n\tstyler: UtilHtmlElementStylerAfter;\n}\n\nexport interface UtilHtmlElementData<ELEMENT extends HTMLElement = HTMLElement> {\n\telement: UtilHtmlElementElementData<ELEMENT>;\n\tclipper: UtilHtmlElementClipperData;\n\tbefore: UtilHtmlElementBeforeData;\n\tafter: UtilHtmlElementAfterData;\n\twhen: UtilHtmlElementWhen;\n\tselect: boolean;\n}\n\nexport interface UtilHtmlElementTarget extends DFocusableMightBe {\n\treadonly state: DBaseStateSet;\n\treadonly cursor: string;\n\treadonly worldVisible: boolean;\n\n\tfocus(): void;\n}\n\nexport interface UtilHtmlElementOperation<ELEMENT extends HTMLElement> {\n\tgetElementRect( resolution: number, work: Point, result: Rectangle ): Rectangle | null;\n\tgetElementMatrix(): Matrix | null;\n\tgetClipperRect( resolution: number, work: Point, result: Rectangle ): Rectangle | null;\n\tgetPadding(): UtilHtmlElementPadding | null;\n\tcontainsPoint( point: Point ): boolean;\n\tonStart(): void;\n\tonCancel(): void;\n\tonEnd(): void;\n}\n\nexport class UtilHtmlElement<\n\tELEMENT extends HTMLElement = HTMLElement,\n\tTARGET extends UtilHtmlElementTarget = UtilHtmlElementTarget,\n\tOPERATION extends UtilHtmlElementOperation<ELEMENT> = UtilHtmlElementOperation<ELEMENT>,\n\tTHEME extends UtilThemeHtmlElement<ELEMENT> = UtilThemeHtmlElement<ELEMENT>,\n\tOPTIONS extends UtilHtmlElementOptions<ELEMENT> = UtilHtmlElementOptions<ELEMENT>,\n> {\n\tprotected _target: TARGET;\n\tprotected _operation: OPERATION;\n\tprotected _data: UtilHtmlElementData<ELEMENT>;\n\n\tprotected _point?: Point;\n\n\tprotected _clipper?: HTMLDivElement | null;\n\tprotected _clipperRectResult?: Rectangle;\n\n\tprotected _element?: ELEMENT | null;\n\tprotected _elementRectResult?: Rectangle;\n\tprotected _isElementShown: boolean;\n\tprotected _onElementFocusBound: ( e: FocusEvent ) => void;\n\n\tprotected _before?: HTMLDivElement | null;\n\tprotected _onBeforeFocusBound: ( e: FocusEvent ) => void;\n\n\tprotected _after?: HTMLDivElement | null;\n\tprotected _onAfterFocusBound!: ( e: FocusEvent ) => void;\n\n\tprotected _isStarted: boolean;\n\tprotected _wasStarted: boolean;\n\tprotected _doSelectBound: () => void;\n\tprotected _isStartRequested: boolean;\n\n\tprotected _rendererBound?: Renderer;\n\tprotected _onPostRenderBound: () => void;\n\n\tconstructor( target: TARGET, operation: OPERATION, theme: THEME, options?: OPTIONS ) {\n\t\tthis._target = target;\n\t\tthis._operation = operation;\n\t\tconst data = this.toData( theme, options );\n\t\tthis._data = data;\n\n\t\tthis._isElementShown = false;\n\t\tthis._onElementFocusBound = ( e: FocusEvent ): void => {\n\t\t\tthis.onElementFocus( e );\n\t\t};\n\n\t\tthis._onBeforeFocusBound = ( e: FocusEvent ): void => {\n\t\t\tthis.onBeforeFocus( e );\n\t\t};\n\n\t\tthis._onAfterFocusBound = ( e: FocusEvent ): void => {\n\t\t\tthis.onAfterFocus( e );\n\t\t};\n\n\t\tthis._isStarted = false;\n\t\tthis._wasStarted = false;\n\t\tthis._doSelectBound = () => {\n\t\t\tthis.doSelect();\n\t\t};\n\t\tthis._isStartRequested = ( this._data.when === UtilHtmlElementWhen.ALWAYS );\n\t\tthis._onPostRenderBound = () => {\n\t\t\tthis.updateElement( this._rendererBound! );\n\t\t};\n\t}\n\n\tprotected toData( theme: THEME, options?: OPTIONS ): UtilHtmlElementData<ELEMENT> {\n\t\treturn {\n\t\t\telement: this.toElementOptions( theme, options?.element ),\n\t\t\tclipper: this.toClipperOptions( theme, options?.clipper ),\n\t\t\tbefore: this.toBeforeOptions( theme, options?.before ),\n\t\t\tafter: this.toAfterOptions( theme, options?.after ),\n\t\t\twhen: toEnum( options?.when ?? theme.getWhen(), UtilHtmlElementWhen ),\n\t\t\tselect: options?.select ?? theme.getSelect()\n\t\t};\n\t}\n\n\tprotected toElementOptions( theme: THEME, options?: OPTIONS[ \"element\" ] ) {\n\t\treturn {\n\t\t\tcreator: options?.creator ?? theme.getElementCreator(),\n\t\t\tstyler: options?.styler ?? this.newElementStyler( theme )\n\t\t}\n\t}\n\n\tprotected newElementStyler( theme: THEME ) {\n\t\treturn (\n\t\t\ttarget: ELEMENT, state: DBaseStateSet, padding: UtilHtmlElementPadding | null,\n\t\t\telementRect: Rectangle | null, elementMatrix: Matrix | null,\n\t\t\tclipperRect: Rectangle | null\n\t\t): void => {\n\t\t\treturn theme.setElementStyle( target, state, padding, elementRect, elementMatrix, clipperRect );\n\t\t};\n\t}\n\n\tprotected toClipperOptions( theme: THEME, options?: OPTIONS[ \"clipper\" ] ) {\n\t\treturn {\n\t\t\tcreator: options?.creator ?? theme.getClipperCreator(),\n\t\t\tstyler: options?.styler ?? this.newClipperStyler( theme )\n\t\t};\n\t}\n\n\tprotected newClipperStyler( theme: THEME ) {\n\t\treturn (\n\t\t\ttarget: HTMLDivElement, state: DBaseStateSet, padding: UtilHtmlElementPadding | null,\n\t\t\telementRect: Rectangle | null, elementMatrix: Matrix | null,\n\t\t\tclipperRect: Rectangle | null\n\t\t): void => {\n\t\t\treturn theme.setClipperStyle( target, state, padding, elementRect, elementMatrix, clipperRect );\n\t\t};\n\t}\n\n\tprotected toBeforeOptions( theme: THEME, options?: OPTIONS[ \"before\" ] ) {\n\t\treturn {\n\t\t\tcreator: options?.creator ?? theme.getBeforeCreator(),\n\t\t\tstyler: options?.styler ?? this.newBeforeStyler( theme )\n\t\t};\n\t}\n\n\tprotected newBeforeStyler( theme: THEME ) {\n\t\treturn ( target: HTMLDivElement ): void => {\n\t\t\ttheme.setBeforeStyle( target );\n\t\t};\n\t}\n\n\tprotected toAfterOptions( theme: THEME, options?: OPTIONS[ \"after\" ] ) {\n\t\treturn {\n\t\t\tcreator: options?.creator ?? theme.getAfterCreator(),\n\t\t\tstyler: options?.styler ?? this.newAfterStyler( theme )\n\t\t};\n\t}\n\n\tprotected newAfterStyler( theme: THEME) {\n\t\treturn ( target: HTMLDivElement ): void => {\n\t\t\ttheme.setAfterStyle( target );\n\t\t};\n\t}\n\n\tget element(): ELEMENT | null {\n\t\treturn this._element ?? null;\n\t}\n\n\tget when(): UtilHtmlElementWhen {\n\t\treturn this._data.when;\n\t}\n\n\tonDownThisBefore( e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tthis._wasStarted = this._isStarted;\n\t\tswitch( this.when ) {\n\t\tcase UtilHtmlElementWhen.CLICKED:\n\t\t\tthis.start();\n\t\t\tbreak;\n\t\tcase UtilHtmlElementWhen.FOCUSED:\n\t\t\tif( this._target.state.isFocused ) {\n\t\t\t\tthis.start();\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tonDownThisAfter( e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tif( ! this._wasStarted && this._isStarted ) {\n\t\t\tif( \"data\" in e ) {\n\t\t\t\te.data.originalEvent.preventDefault();\n\t\t\t} else {\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t}\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent | KeyboardEvent, interactionManager: interaction.InteractionManager ): void {\n\t\tswitch( this.when ) {\n\t\tcase UtilHtmlElementWhen.DOUBLE_CLICKED:\n\t\t\tthis.start();\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tonFocus(): void {\n\t\tswitch( this.when ) {\n\t\tcase UtilHtmlElementWhen.FOCUSED:\n\t\t\tthis.start();\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis._element?.focus();\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tonBlur(): void {\n\t\tswitch( this.when ) {\n\t\tcase UtilHtmlElementWhen.CLICKED:\n\t\tcase UtilHtmlElementWhen.DOUBLE_CLICKED:\n\t\tcase UtilHtmlElementWhen.FOCUSED:\n\t\t\tthis.onEndByBlur();\n\t\t\tthis.cancel();\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis._element?.blur();\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tisStartable(): boolean {\n\t\tswitch( this.when ) {\n\t\tcase UtilHtmlElementWhen.CLICKED:\n\t\tcase UtilHtmlElementWhen.DOUBLE_CLICKED:\n\t\tcase UtilHtmlElementWhen.FOCUSED:\n\t\t\treturn this._target.state.isActionable;\n\t\tdefault:\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tstart(): void {\n\t\tif( ! this._isStarted && this.isStartable() ) {\n\t\t\tthis._isStarted = true;\n\t\t\tif( this._target.worldVisible ) {\n\t\t\t\tthis.doStart();\n\t\t\t} else {\n\t\t\t\tthis._isStartRequested = true;\n\t\t\t}\n\t\t\tDApplications.update( this._target );\n\t\t}\n\t}\n\n\tisShown(): boolean {\n\t\treturn this._isElementShown;\n\t}\n\n\tonRender( renderer: Renderer ): void {\n\t\tif( this._isStartRequested || (! this._isElementShown && this.when === UtilHtmlElementWhen.ALWAYS) ) {\n\t\t\tthis._isStartRequested = false;\n\t\t\tthis.doStart( renderer );\n\t\t}\n\t\tif( this._isStarted ) {\n\t\t\tthis._isStarted = false;\n\t\t}\n\t}\n\n\tprotected getElementRect( resolution: number ): Rectangle | null {\n\t\tconst point = ( this._point || new Point( 0, 0 ) );\n\t\tthis._point = point;\n\t\tconst result = ( this._elementRectResult || new Rectangle() );\n\t\tthis._elementRectResult = result;\n\t\treturn this._operation.getElementRect( resolution, point, result );\n\t}\n\n\tprotected getElementMatrix(): Matrix | null {\n\t\treturn this._operation.getElementMatrix();\n\t}\n\n\tprotected getClipperRect( resolution: number ): Rectangle | null {\n\t\tconst point = ( this._point || new Point( 0, 0 ) );\n\t\tthis._point = point;\n\t\tconst result = ( this._clipperRectResult || new Rectangle() );\n\t\tthis._clipperRectResult = result;\n\t\treturn this._operation.getClipperRect( resolution, point, result );\n\t}\n\n\tprotected doStart( renderer?: Renderer ): void {\n\t\tif( ! this._isElementShown ) {\n\t\t\tthis._isElementShown = true;\n\n\t\t\tconst rendererBound = this._rendererBound;\n\t\t\tif( rendererBound != null ) {\n\t\t\t\tthis._rendererBound = undefined;\n\t\t\t\trendererBound.off( \"postrender\", this._onPostRenderBound );\n\t\t\t}\n\n\t\t\tconst target = this._target;\n\t\t\tif( renderer == null ) {\n\t\t\t\trenderer = DApplications.getLayer( target )?.renderer;\n\t\t\t}\n\t\t\tif( renderer ) {\n\t\t\t\tthis._rendererBound = renderer;\n\t\t\t\trenderer.on( \"postrender\", this._onPostRenderBound );\n\t\t\t}\n\n\t\t\tthis.onStart();\n\n\t\t\tconst clipper = this.getClipper();\n\t\t\tif( clipper ) {\n\t\t\t\tconst before = this.getBefore( clipper );\n\t\t\t\tconst element = this.getElement( clipper );\n\t\t\t\tconst after = this.getAfter( clipper );\n\t\t\t\tif( element ) {\n\t\t\t\t\tconst resolution = ( renderer?.resolution ?? DApplications.getResolution( target ) );\n\t\t\t\t\tconst elementRect = this.getElementRect( resolution );\n\t\t\t\t\tconst elementMatrix = this.getElementMatrix();\n\t\t\t\t\tconst clipperRect = this.toClipperRectAdjusted(\n\t\t\t\t\t\telementRect, elementMatrix, this.getClipperRect( resolution )\n\t\t\t\t\t);\n\t\t\t\t\tconst state = target.state;\n\t\t\t\t\tconst padding = this._operation.getPadding();\n\t\t\t\t\tconst options = this._data;\n\t\t\t\t\toptions.clipper.styler( clipper, state, padding, elementRect, elementMatrix, clipperRect );\n\t\t\t\t\toptions.element.styler( element, state, padding, elementRect, elementMatrix, clipperRect );\n\t\t\t\t\tif( before ) {\n\t\t\t\t\t\toptions.before.styler( before );\n\t\t\t\t\t}\n\t\t\t\t\tif( after ) {\n\t\t\t\t\t\toptions.after.styler( after );\n\t\t\t\t\t}\n\t\t\t\t\tthis.onElementAttached( element, before, after );\n\n\t\t\t\t\t// Show HTML elements\n\t\t\t\t\tclipper.style.display = \"\";\n\t\t\t\t\tif( state.isFocused ) {\n\t\t\t\t\t\telement.focus();\n\t\t\t\t\t}\n\t\t\t\t\tclipper.scrollTop = 0;\n\t\t\t\t\tclipper.scrollLeft = 0;\n\n\t\t\t\t\t// Select the element if required.\n\t\t\t\t\tif( this._data.select ) {\n\t\t\t\t\t\tsetTimeout( this._doSelectBound, 0 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onStart(): void {\n\t\tthis._operation.onStart();\n\t}\n\n\tprotected doSelect(): void {\n\t\tconst element = this._element;\n\t\tif( element ) {\n\t\t\tif( element instanceof HTMLInputElement || element instanceof HTMLTextAreaElement ) {\n\t\t\t\t// The following does not work on mobile devices.\n\t\t\t\t// I think selecting texts on a tap is annoying.\n\t\t\t\t// Therefore, I leave this untouched.\n\t\t\t\telement.select();\n\t\t\t}\n\t\t}\n\t}\n\n\tcancel(): void {\n\t\tif( this._isElementShown ) {\n\t\t\tthis._isElementShown = false;\n\n\t\t\tconst rendererBound = this._rendererBound;\n\t\t\tif( rendererBound != null ) {\n\t\t\t\tthis._rendererBound = undefined;\n\t\t\t\trendererBound.off( \"postrender\", this._onPostRenderBound );\n\t\t\t}\n\n\t\t\tthis.onCancel();\n\n\t\t\tconst target = this._target;\n\t\t\tconst layer = DApplications.getLayer( target );\n\t\t\tif( layer ) {\n\t\t\t\tconst view = layer.view;\n\t\t\t\tswitch( this.when ) {\n\t\t\t\tcase UtilHtmlElementWhen.CLICKED:\n\t\t\t\tcase UtilHtmlElementWhen.DOUBLE_CLICKED:\n\t\t\t\tcase UtilHtmlElementWhen.FOCUSED:\n\t\t\t\t\tif( document.activeElement === this._element ) {\n\t\t\t\t\t\tview.focus();\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\tconst state = target.state;\n\t\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\n\t\t\t\tif( this._operation.containsPoint( interactionManager.mouse.global ) && ! state.isHovered ) {\n\t\t\t\t\tstate.isHovered = true;\n\t\t\t\t\tview.style.cursor = target.cursor;\n\t\t\t\t}\n\n\t\t\t\tlayer.update();\n\t\t\t}\n\n\t\t\tconst element = this._element;\n\t\t\tif( element != null ) {\n\t\t\t\tthis.onElementDetached( element, this._before, this._after );\n\t\t\t}\n\n\t\t\tconst clipper = this._clipper;\n\t\t\tif( clipper != null ) {\n\t\t\t\tclipper.style.display = \"none\";\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onCancel(): void {\n\t\tthis._operation.onCancel();\n\t}\n\n\tprotected onElementAttached(\n\t\telement: ELEMENT, before?: HTMLDivElement | null, after?: HTMLDivElement | null\n\t): void {\n\t\tbefore?.addEventListener( \"focus\", this._onBeforeFocusBound );\n\t\tafter?.addEventListener( \"focus\", this._onAfterFocusBound );\n\t\telement.addEventListener( \"focus\", this._onElementFocusBound, true );\n\t}\n\n\tprotected onElementDetached(\n\t\telement: ELEMENT, before?: HTMLDivElement | null, after?: HTMLDivElement | null\n\t): void {\n\t\tbefore?.removeEventListener( \"focus\", this._onBeforeFocusBound );\n\t\tafter?.removeEventListener( \"focus\", this._onAfterFocusBound );\n\t\telement.removeEventListener( \"focus\", this._onElementFocusBound, true );\n\t}\n\n\tprotected getClipper(): HTMLDivElement | null {\n\t\tlet result = this._clipper;\n\t\tif( result == null ) {\n\t\t\tconst layer = DApplications.getLayer( this._target );\n\t\t\tresult = ( layer ?\n\t\t\t\tthis._data.clipper.creator( layer.getElementContainer() ) :\n\t\t\t\tnull\n\t\t\t);\n\t\t\tthis._clipper = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getElement( clipper: HTMLDivElement ): ELEMENT | null {\n\t\tlet result = this._element;\n\t\tif( result == null ) {\n\t\t\tresult = this._data.element.creator( clipper );\n\t\t\tthis._element = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getBefore( clipper: HTMLDivElement ): HTMLDivElement | null {\n\t\tlet result = this._before;\n\t\tif( result == null ) {\n\t\t\tresult = this._data.before.creator( clipper );\n\t\t\tthis._before = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getAfter( clipper: HTMLDivElement ): HTMLDivElement | null {\n\t\tlet result = this._after;\n\t\tif( result == null ) {\n\t\t\tresult = this._data.after.creator( clipper );\n\t\t\tthis._after = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onBeforeFocus( e: FocusEvent ): void {\n\t\tconst target = this._target;\n\t\tconst layer = DApplications.getLayer( target );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tconst focusable = focusController.find( target, false, false, false );\n\t\t\tlayer.view.focus();\n\t\t\tfocusController.focus( focusable );\n\t\t\te.preventDefault();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n\n\tprotected onAfterFocus( e: FocusEvent ): void {\n\t\tconst target = this._target;\n\t\tconst layer = DApplications.getLayer( target );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tconst focusable = focusController.find( target, false, false, true );\n\t\t\tlayer.view.focus();\n\t\t\tfocusController.focus( focusable );\n\t\t\te.preventDefault();\n\t\t\te.stopImmediatePropagation();\n\t\t}\n\t}\n\n\tprotected onElementFocus( e: FocusEvent ): void {\n\t\tif( this.when === UtilHtmlElementWhen.ALWAYS ) {\n\t\t\tconst target = this._target;\n\t\t\tif( ! target.state.isFocused ) {\n\t\t\t\ttarget.focus();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEndByBlur(): void {\n\t\tthis.onEnd();\n\t}\n\n\tprotected onEnd(): void {\n\t\tthis._operation.onEnd();\n\t}\n\n\tend(): void {\n\t\tthis.onEnd();\n\t\tthis.cancel();\n\t}\n\n\tselect(): this {\n\t\tif( this._isElementShown && this._data.select ) {\n\t\t\tthis.doSelect();\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected toClipperRectAdjusted( elementRect: Rectangle | null, elementMatrix: Matrix | null, clipperRect: Rectangle | null ): Rectangle | null {\n\t\tif( clipperRect && elementRect && elementMatrix == null ) {\n\t\t\tconst ex0 = elementRect.x;\n\t\t\tconst ey0 = elementRect.y;\n\t\t\tconst ex1 = ex0 + elementRect.width;\n\t\t\tconst ey1 = ey0 + elementRect.height;\n\t\t\tconst cx0 = clipperRect.x;\n\t\t\tconst cy0 = clipperRect.y;\n\t\t\tconst cx1 = cx0 + clipperRect.width;\n\t\t\tconst cy1 = cy0 + clipperRect.height;\n\t\t\tconst ncx0 = Math.min( Math.max( cx0, ex0 ), cx1 );\n\t\t\tconst ncx1 = Math.min( Math.max( cx0, ex1 ), cx1 );\n\t\t\tconst ncy0 = Math.min( Math.max( cy0, ey0 ), cy1 );\n\t\t\tconst ncy1 = Math.min( Math.max( cy0, ey1 ), cy1 );\n\t\t\tclipperRect.x = ncx0;\n\t\t\tclipperRect.y = ncy0;\n\t\t\tclipperRect.width = ncx1 - ncx0;\n\t\t\tclipperRect.height = ncy1 - ncy0;\n\t\t}\n\t\treturn clipperRect;\n\t}\n\n\tprotected updateElement( renderer: Renderer ) {\n\t\tif( this._isElementShown ) {\n\t\t\tconst target = this._target;\n\t\t\tif( target.worldVisible ) {\n\t\t\t\tconst element = this._element;\n\t\t\t\tconst clipper = this._clipper;\n\t\t\t\tif( element && clipper ) {\n\t\t\t\t\tconst resolution = renderer.resolution;\n\t\t\t\t\tconst elementRect = this.getElementRect( resolution );\n\t\t\t\t\tconst elementMatrix = this.getElementMatrix();\n\t\t\t\t\tconst clipperRect = this.toClipperRectAdjusted(\n\t\t\t\t\t\telementRect, elementMatrix, this.getClipperRect( resolution )\n\t\t\t\t\t);\n\t\t\t\t\tconst state = target.state;\n\t\t\t\t\tconst padding = this._operation.getPadding();\n\t\t\t\t\tconst options = this._data;\n\t\t\t\t\toptions.clipper.styler( clipper, state, padding, elementRect, elementMatrix, clipperRect );\n\t\t\t\t\toptions.element.styler( element, state, padding, elementRect, elementMatrix, clipperRect );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tswitch( this.when ) {\n\t\t\t\tcase UtilHtmlElementWhen.ALWAYS:\n\t\t\t\t\tconst clipper = this._clipper;\n\t\t\t\t\tif( clipper ) {\n\t\t\t\t\t\tclipper.style.display = \"none\";\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tthis.cancel();\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getClipperRect( parent: unknown, target: unknown, resolution: number, point: Point, result: Rectangle ): Rectangle | null {\n\t\tlet isFirst = true;\n\n\t\tlet x0 = 0;\n\t\tlet y0 = 0;\n\t\tlet x1 = 0;\n\t\tlet y1 = 0;\n\n\t\tlet current = parent;\n\t\twhile( current instanceof DBase ) {\n\t\t\tcurrent.getClippingRect( target, result );\n\n\t\t\tpoint.set( result.x, result.y );\n\t\t\tcurrent.toGlobal( point, point, false );\n\t\t\tconst cx0 = ( (point.x * resolution) | 0 ) / resolution;\n\t\t\tconst cy0 = ( (point.y * resolution) | 0 ) / resolution;\n\n\t\t\tpoint.set( result.x + result.width, result.y + result.height );\n\t\t\tcurrent.toGlobal( point, point, true );\n\t\t\tconst cx1 = point.x;\n\t\t\tconst cy1 = point.y;\n\n\t\t\tconst dx0 = Math.min( cx0, cx1 );\n\t\t\tconst dy0 = Math.min( cy0, cy1 );\n\t\t\tconst dx1 = Math.max( cx0, cx1 );\n\t\t\tconst dy1 = Math.max( cy0, cy1 );\n\n\t\t\tif( isFirst ) {\n\t\t\t\tisFirst = false;\n\t\t\t\tx0 = dx0;\n\t\t\t\ty0 = dy0;\n\t\t\t\tx1 = dx1;\n\t\t\t\ty1 = dy1;\n\t\t\t} else {\n\t\t\t\tx0 = Math.min( Math.max( x0, dx0 ), dx1 );\n\t\t\t\ty0 = Math.min( Math.max( y0, dy0 ), dy1 );\n\t\t\t\tx1 = Math.min( Math.max( x1, dx0 ), dx1 );\n\t\t\t\ty1 = Math.min( Math.max( y1, dy0 ), dy1 );\n\t\t\t}\n\n\t\t\tcurrent = current.parent;\n\t\t}\n\n\t\tif( isFirst ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tresult.x = x0;\n\t\tresult.y = y0;\n\t\tresult.width = x1 - x0;\n\t\tresult.height = y1 - y0;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueMiscType {\n\tINPUT_TEXT,\n\tINPUT_INTEGER,\n\tINPUT_REAL,\n\tEMIT_EVENT,\n\tWRITE_BOTH,\n\tWRITE_LOCAL,\n\tWRITE_REMOTE,\n\tHTML_ELEMENT,\n\tHTML_ELEMENT_WITHOUT_POINTER_EVENTS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Matrix, Point, Rectangle, Renderer } from \"pixi.js\";\nimport { DHtmlElementState } from \"../../d-html-element-state\";\nimport { DThemes } from \"../../theme/d-themes\";\nimport { UtilHtmlElement, UtilHtmlElementCreator, UtilHtmlElementOperation, UtilHtmlElementOptions, UtilHtmlElementPadding } from \"../../util/util-html-element\";\nimport { UtilHtmlElementWhen } from \"../../util/util-html-element-when\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionExpression, EShapeActionExpressionWithParameter } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\nimport { EShapeActionValueMisc } from \"./e-shape-action-value-misc\";\nimport { EShapeActionValueMiscType } from \"./e-shape-action-value-misc-type\";\nimport { EShapeActionValueOnInputAction } from \"./e-shape-action-value-on-input-action\";\n\nexport class EShapeActionRuntimeMiscHtmlElement<\n\tELEMENT extends HTMLElement = HTMLElement,\n\tUTIL extends UtilHtmlElement<ELEMENT> = UtilHtmlElement<ELEMENT>\n> extends EShapeActionRuntime {\n\tprotected static WORK?: Point;\n\tprotected readonly condition: EShapeActionExpression<string | null>;\n\tprotected readonly target: EShapeActionExpression<string | null>;\n\tprotected onInputAction: EShapeActionValueOnInputAction;\n\tprotected elementCreator?: EShapeActionExpressionWithParameter<ELEMENT | null, HTMLElement>;\n\tprotected noPointerEvent: boolean;\n\tprotected utils: Map<EShape, UTIL>;\n\n\tconstructor( value: EShapeActionValueMisc ) {\n\t\tsuper();\n\t\tthis.condition = EShapeActionExpressions.ofString( value.condition );\n\t\tthis.target = EShapeActionExpressions.ofStringOrNull( value.target );\n\t\tthis.onInputAction = value.onInputAction;\n\t\tthis.elementCreator = EShapeActionExpressions.ofElementOrNull( value.value );\n\t\tthis.noPointerEvent = ( value.subtype === EShapeActionValueMiscType.HTML_ELEMENT_WITHOUT_POINTER_EVENTS );\n\t\tthis.utils = new Map<EShape, UTIL>();\n\t}\n\n\tprotected getUtil( shape: EShape, runtime: EShapeRuntime ): UTIL {\n\t\tconst utils = this.utils;\n\t\tlet result = utils.get( shape );\n\t\tif( result == null ) {\n\t\t\tresult = this.newUtil( shape, runtime );\n\t\t\tutils.set( shape, result );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newUtil( shape: EShape, runtime: EShapeRuntime ): UTIL {\n\t\tif( this.noPointerEvent ) {\n\t\t\tshape.state.add( DHtmlElementState.NO_POINTER_EVENTS );\n\t\t}\n\t\treturn new UtilHtmlElement<ELEMENT>(\n\t\t\tshape, this.newOperation( shape, runtime ),\n\t\t\tDThemes.getInstance().get( \"DHtmlElement\" ),\n\t\t\tthis.newUtilOptions( shape, runtime )\n\t\t) as any;\n\t}\n\n\tprotected newOperation( shape: EShape, runtime: EShapeRuntime ): UtilHtmlElementOperation<ELEMENT> {\n\t\treturn {\n\t\t\tgetElementRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getElementRect( shape, runtime, resolution, work, result );\n\t\t\t},\n\n\t\t\tgetElementMatrix: (): Matrix | null => {\n\t\t\t\treturn this.getElementMatrix( shape, runtime );\n\t\t\t},\n\n\t\t\tgetClipperRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getClipperToRect( shape, runtime, resolution, work, result );\n\t\t\t},\n\n\t\t\tgetPadding: (): UtilHtmlElementPadding | null => {\n\t\t\t\treturn this.getPadding( shape, runtime );\n\t\t\t},\n\n\t\t\tcontainsPoint: ( point: Point ): boolean => {\n\t\t\t\treturn this.containsPoint( shape, runtime, point );\n\t\t\t},\n\n\t\t\tonStart: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tonCancel: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tonEnd: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected newUtilOptions( shape: EShape, runtime: EShapeRuntime ): UtilHtmlElementOptions<ELEMENT> {\n\t\treturn {\n\t\t\telement: {\n\t\t\t\tcreator: this.newElementCreator( shape, runtime )\n\t\t\t},\n\t\t\twhen: this.toWhen( shape, runtime )\n\t\t};\n\t}\n\n\tprotected newElementCreator( shape: EShape, runtime: EShapeRuntime ): UtilHtmlElementCreator<ELEMENT> | undefined {\n\t\tconst elementCreator = this.elementCreator;\n\t\tif( elementCreator ) {\n\t\t\treturn ( container: HTMLElement ): ELEMENT | null => {\n\t\t\t\treturn elementCreator( shape, Date.now(), container );\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected toWhen( shape: EShape, runtime: EShapeRuntime ): UtilHtmlElementWhen | undefined {\n\t\tconst value = this.condition( shape, Date.now() );\n\t\tif( value != null && value in UtilHtmlElementWhen ) {\n\t\t\treturn UtilHtmlElementWhen[ value as (keyof typeof UtilHtmlElementWhen) ];\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected containsPoint( shape: EShape, runtime: EShapeRuntime, point: Point ): boolean {\n\t\tif( shape.visible ) {\n\t\t\tconst local = EShapeActionRuntimeMiscHtmlElement.WORK || new Point();\n\t\t\tEShapeActionRuntimeMiscHtmlElement.WORK = local;\n\t\t\tshape.toLocal( point, undefined, local );\n\t\t\treturn shape.contains( local ) != null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getPadding( shape: EShape, runtime: EShapeRuntime ): UtilHtmlElementPadding | null {\n\t\treturn null;\n\t}\n\n\tprotected getElementRect( shape: EShape, runtime: EShapeRuntime, resolution: number, point: Point, result: Rectangle ): Rectangle | null {\n\t\tconst pivot = shape.transform.pivot;\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tresult.x = -0.5 * sizeX + pivot.x;\n\t\tresult.y = -0.5 * sizeY + pivot.y;\n\t\tresult.width = sizeX;\n\t\tresult.height = sizeY;\n\t\treturn result;\n\t}\n\n\tprotected getElementMatrix( shape: EShape, runtime: EShapeRuntime ): Matrix | null {\n\t\tshape.updateTransform();\n\t\treturn shape.transform.worldTransform;\n\t}\n\n\tprotected getClipperToRect( shape: EShape, runtime: EShapeRuntime, resolution: number, point: Point, result: Rectangle ): Rectangle | null {\n\t\tconst container = EShapeActionRuntimes.toContainer( shape );\n\t\treturn UtilHtmlElement.getClipperRect( container, shape, resolution, point, result );\n\t}\n\n\tonRender( shape: EShape, runtime: EShapeRuntime, time: number, renderer: Renderer ): void {\n\t\tthis.getUtil( shape, runtime ).onRender( renderer );\n\t}\n\n\tonFocus( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tthis.getUtil( shape, runtime ).onFocus();\n\t}\n\n\tonBlur( shape: EShape, runtime: EShapeRuntime ): void {\n\t\tthis.getUtil( shape, runtime ).onBlur();\n\t}\n\n\tonDownThisBefore( shape: EShape, runtime: EShapeRuntime, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tthis.getUtil( shape, runtime ).onDownThisBefore( e );\n\t}\n\n\tonDownThisAfter( shape: EShape, runtime: EShapeRuntime, e: interaction.InteractionEvent | KeyboardEvent ): void {\n\t\tthis.getUtil( shape, runtime ).onDownThisAfter( e );\n\t}\n\n\tonDblClick( shape: EShape, runtime: EShapeRuntime, e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): void {\n\t\tthis.getUtil( shape, runtime ).onDblClick( e, interactionManager );\n\t}\n}\n","\nexport enum EShapeActionValueOnInputAction {\n\tEMIT_EVENT,\n\tWRITE_BOTH,\n\tWRITE_LOCAL,\n\tWRITE_REMOTE\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"../d-applications\";\nimport { isString } from \"./is-string\";\nimport { UtilHtmlElement, UtilHtmlElementOperation, UtilHtmlElementOptions, UtilHtmlElementTarget, UtilThemeHtmlElement } from \"./util-html-element\";\nimport { UtilKeyboardEvent } from \"./util-keyboard-event\";\n\nexport interface UtilInputTarget extends UtilHtmlElementTarget {\n\n}\n\nexport interface UtilInputOperation<VALUE> extends UtilHtmlElementOperation<HTMLInputElement> {\n\tgetValue(): VALUE | undefined;\n\tapplyTitle(): void;\n\n\tonValueInput( newValue: VALUE ): void;\n\tonValueChange( newValue: VALUE, oldValue: VALUE ): void;\n\tonEnter(): void;\n}\n\nexport interface UtilInputEditingOptions<VALUE = unknown> {\n\tformatter?: ( value: VALUE ) => string;\n\tunformatter?: ( text: string ) => VALUE;\n\tvalidator?: ( value: VALUE ) => string | null;\n}\n\nexport interface UtilInputOptions<VALUE> extends UtilHtmlElementOptions<HTMLInputElement> {\n\tdescription?: string;\n\tediting?: UtilInputEditingOptions<VALUE>;\n}\n\nexport interface UtilThemeInput<VALUE> extends UtilThemeHtmlElement<HTMLInputElement> {\n\tgetEditingFormatter(): ( value: VALUE, caller: any ) => string;\n\tgetEditingUnformatter(): ( text: string, caller: any ) => VALUE;\n\tgetEditingValidator(): ( value: VALUE, caller: any ) => string | null;\n}\n\nexport abstract class UtilInput<\n\tVALUE = unknown,\n\tTARGET extends UtilInputTarget = UtilInputTarget,\n\tOPERATION extends UtilInputOperation<VALUE> = UtilInputOperation<VALUE>,\n\tTHEME extends UtilThemeInput<VALUE> = UtilThemeInput<VALUE>,\n\tOPTIONS extends UtilInputOptions<VALUE> = UtilInputOptions<VALUE>\n> extends UtilHtmlElement<HTMLInputElement, TARGET, OPERATION, THEME, OPTIONS> {\n\tprotected _onInputKeyDownBound: ( e: KeyboardEvent ) => void;\n\tprotected _onInputChangeBound: ( e: Event ) => void;\n\tprotected _onInputInputBound: ( e: Event ) => void;\n\n\tprotected _description: string;\n\n\tprotected _editingFormatter: ( value: VALUE, caller: any ) => string;\n\tprotected _editingUnformatter: ( text: string, caller: any ) => VALUE;\n\tprotected _editingValidator: ( value: VALUE, caller: any ) => string | null;\n\tprotected _editingValidationResult?: string | null;\n\n\tconstructor( target: TARGET, operation: OPERATION, theme: THEME, options?: OPTIONS ) {\n\t\tsuper( target, operation, theme, options );\n\n\t\tthis._operation = operation;\n\n\t\tthis._onInputKeyDownBound = ( e: KeyboardEvent ): void => {\n\t\t\tthis.onInputKeyDown( e );\n\t\t};\n\t\tthis._onInputChangeBound = (): void => {\n\t\t\tthis.onInputChange();\n\t\t};\n\t\tthis._onInputInputBound = ( e: Event ): void => {\n\t\t\tthis.onInputInput( e );\n\t\t};\n\n\t\tthis._description = options?.description ?? \"\";\n\n\t\tconst editing = options?.editing;\n\t\tthis._editingFormatter = editing?.formatter ?? ( (options as any)?.text?.formatter ?? theme.getEditingFormatter() );\n\t\tthis._editingUnformatter = editing?.unformatter ?? theme.getEditingUnformatter();\n\t\tthis._editingValidator = editing?.validator ?? theme.getEditingValidator();\n\t}\n\n\tprotected onEnd(): void {\n\t\tsuper.onEnd();\n\t\tthis.onInputChange();\n\t}\n\n\tprotected onElementAttached(\n\t\telement: HTMLInputElement, before?: HTMLDivElement | null, after?: HTMLDivElement | null\n\t): void {\n\t\telement.type = this.getInputType();\n\t\telement.value = this.fromValue( this._operation.getValue() );\n\t\telement.addEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\telement.addEventListener( \"change\", this._onInputChangeBound );\n\t\telement.addEventListener( \"input\", this._onInputInputBound );\n\t\tsuper.onElementAttached( element, before, after );\n\t}\n\n\tprotected onElementDetached(\n\t\telement: HTMLInputElement, before?: HTMLDivElement | null, after?: HTMLDivElement | null\n\t): void {\n\t\tsuper.onElementDetached( element, before, after );\n\t\telement.removeEventListener( \"keydown\", this._onInputKeyDownBound );\n\t\telement.removeEventListener( \"change\", this._onInputChangeBound );\n\t\telement.removeEventListener( \"input\", this._onInputInputBound );\n\t}\n\n\tprotected onInputKeyDown( e: KeyboardEvent ): void {\n\t\tif( UtilKeyboardEvent.isOkKey( e ) ) {\n\t\t\tthis.end();\n\t\t\tthis._operation.onEnter();\n\t\t} else if( UtilKeyboardEvent.isCancelKey( e ) ) {\n\t\t\tthis.cancel();\n\t\t}\n\t}\n\n\tprotected onInputChange(): void {\n\t\tif( this.isShown() ) {\n\t\t\tconst element = this.element;\n\t\t\tif( element != null ) {\n\t\t\t\tconst operation = this._operation;\n\t\t\t\tconst newValue = this.toValue( element.value );\n\t\t\t\tconst oldValue = operation.getValue()!;\n\t\t\t\tif( oldValue !== newValue ) {\n\t\t\t\t\toperation.onValueChange( newValue, oldValue );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ttoValue( valueAsString: string ): VALUE {\n\t\treturn this._editingUnformatter( valueAsString, this );\n\t}\n\n\tfromValue( value: VALUE | undefined ): string {\n\t\tif( value !== undefined ) {\n\t\t\treturn this._editingFormatter( value, this );\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tprotected onInputInput( e: Event ): void {\n\t\tconst target = e.target;\n\t\tif( target instanceof HTMLInputElement ) {\n\t\t\tthis._operation.onValueInput( this.toValue( target.value ) );\n\t\t}\n\t}\n\n\tvalidate(): string | null {\n\t\tconst value = this._operation.getValue();\n\t\tif( value !== undefined ) {\n\t\t\tconst result = this._editingValidator( value, this );\n\t\t\tif( this._editingValidationResult !== result ) {\n\t\t\t\tthis._editingValidationResult = result;\n\t\t\t\tconst state = this._target.state;\n\t\t\t\tstate.isInvalid = ( result != null );\n\t\t\t\tif( state.isHovered ) {\n\t\t\t\t\tthis._operation.applyTitle();\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tapplyTitle(): boolean {\n\t\tconst editingValidationResult = this._editingValidationResult;\n\t\tif( isString( editingValidationResult ) ) {\n\t\t\tconst layer = DApplications.getLayer( this._target );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.view.title = editingValidationResult;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected abstract getInputType(): string;\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilInput, UtilInputOperation, UtilInputOptions, UtilInputTarget, UtilThemeInput } from \"./util-input\";\n\nexport interface UtilInputNumberTarget extends UtilInputTarget {\n\n}\n\nexport interface UtilInputNumberOperation extends UtilInputOperation<number> {\n\n}\n\nexport interface UtilInputNumberOptions extends UtilInputOptions<number> {\n\tstep?: number | null;\n\tmin?: number | null;\n\tmax?: number | null;\n}\n\nexport interface UtilThemeInputNumber extends UtilThemeInput<number> {\n\tgetStep(): number | null;\n\tgetMin(): number | null;\n\tgetMax(): number | null;\n}\n\nexport class UtilInputNumber<\n\tTARGET extends UtilInputNumberTarget = UtilInputNumberTarget,\n\tOPERATION extends UtilInputNumberOperation = UtilInputNumberOperation,\n\tTHEME extends UtilThemeInputNumber = UtilThemeInputNumber,\n\tOPTIONS extends UtilInputNumberOptions = UtilInputNumberOptions\n> extends UtilInput<number, TARGET, OPERATION, THEME, OPTIONS> {\n\tprotected _step: number | null;\n\tprotected _min: number | null;\n\tprotected _max: number | null;\n\n\tconstructor( target: TARGET, operation: OPERATION, theme: THEME, options?: OPTIONS ) {\n\t\tsuper( target, operation, theme, options );\n\n\t\tthis._step = options?.step ?? theme.getStep();\n\t\tthis._min = options?.min ?? theme.getMin();\n\t\tthis._max = options?.max ?? theme.getMax();\n\t}\n\n\tget step(): number | null {\n\t\treturn this._step;\n\t}\n\n\tset step( step: number | null ) {\n\t\tif( this._step !== step ) {\n\t\t\tthis._step = step;\n\t\t\tthis.onStepChange();\n\t\t}\n\t}\n\n\tget min(): number | null {\n\t\treturn this._min;\n\t}\n\n\tset min( min: number | null ) {\n\t\tif( this._min !== min ) {\n\t\t\tthis._min = min;\n\t\t\tthis.onMinChange();\n\t\t}\n\t}\n\n\tget max(): number | null {\n\t\treturn this._max;\n\t}\n\n\tset max( max: number | null ) {\n\t\tif( this._max !== max ) {\n\t\t\tthis._max = max;\n\t\t\tthis.onMaxChange();\n\t\t}\n\t}\n\n\ttoValue( valueAsString: string ): number {\n\t\tconst result = super.toValue( valueAsString );\n\t\tif( result === result /* NaN Check */ ) {\n\t\t\tif( this._min != null && result < this._min ) {\n\t\t\t\treturn this._min;\n\t\t\t}\n\t\t\tif( this._max != null && this._max < result ) {\n\t\t\t\treturn this._max;\n\t\t\t}\n\t\t\treturn result;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tfromValue( value: number | undefined ): string {\n\t\tif( value !== undefined ) {\n\t\t\treturn this._editingFormatter( value, this );\n\t\t}\n\t\treturn \"0\";\n\t}\n\n\tprotected onStepChange(): void {\n\t\tif( this.isShown() ) {\n\t\t\tconst element = this.element;\n\t\t\tif( element ) {\n\t\t\t\tthis.updateStep( element );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onMinChange(): void {\n\t\tif( this.isShown() ) {\n\t\t\tconst element = this.element;\n\t\t\tif( element ) {\n\t\t\t\tthis.updateMin( element );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onMaxChange(): void {\n\t\tif( this.isShown() ) {\n\t\t\tconst element = this.element;\n\t\t\tif( element ) {\n\t\t\t\tthis.updateMax( element );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateStep( input: HTMLInputElement ): void {\n\t\tconst step = this.step;\n\t\tif( step != null ) {\n\t\t\tinput.step = `${step}`;\n\t\t} else {\n\t\t\tinput.step = \"any\";\n\t\t}\n\t}\n\n\tprotected updateMin( input: HTMLInputElement ): void {\n\t\tconst min = this.min;\n\t\tif( min != null ) {\n\t\t\tinput.min = `${min}`;\n\t\t} else {\n\t\t\tinput.removeAttribute( \"min\" );\n\t\t}\n\t}\n\n\tprotected updateMax( input: HTMLInputElement ): void {\n\t\tconst max = this.max;\n\t\tif( max != null ) {\n\t\t\tinput.max = `${max}`;\n\t\t} else {\n\t\t\tinput.removeAttribute( \"max\" );\n\t\t}\n\t}\n\n\tprotected onElementAttached(\n\t\telement: HTMLInputElement, before?: HTMLDivElement | null, after?: HTMLDivElement | null\n\t): void {\n\t\tsuper.onElementAttached( element, before, after );\n\t\tthis.updateStep( element );\n\t\tthis.updateMin( element );\n\t\tthis.updateMax( element );\n\t}\n\n\tprotected getInputType(): string {\n\t\treturn \"number\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\nimport { EShapeActionValueOnInputAction } from \"./e-shape-action-value-on-input-action\";\n\nexport class EShapeActionValueOnInputActions {\n\tstatic execute<VALUE>(\n\t\tshape: EShape,\n\t\taction: EShapeActionValueOnInputAction,\n\t\ttarget: string, value: VALUE, time: number\n\t): void {\n\t\tswitch( action ) {\n\t\tcase EShapeActionValueOnInputAction.EMIT_EVENT:\n\t\t\tshape.emit( target, shape, value );\n\t\t\tEShapeActionRuntimes.emit( shape, target, value, time );\n\t\t\tbreak;\n\t\tcase EShapeActionValueOnInputAction.WRITE_LOCAL:\n\t\t\tEShapeActionRuntimes.write( shape, target, value, time, false );\n\t\t\tbreak;\n\t\tcase EShapeActionValueOnInputAction.WRITE_REMOTE:\n\t\t\tEShapeActionRuntimes.write( shape, target, value, time, true );\n\t\t\tbreak;\n\t\tcase EShapeActionValueOnInputAction.WRITE_BOTH:\n\t\t\tEShapeActionRuntimes.write( shape, target, value, time, false );\n\t\t\tEShapeActionRuntimes.write( shape, target, value, time, true );\n\t\t\tbreak;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * {@link DButtonBase} option when to activate a button.\n */\nexport enum DButtonBaseWhen {\n\t/** Activates when clicked */\n\tCLICKED,\n\n\t/** Activates when double clicked */\n\tDOUBLE_CLICKED\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignHorizontal {\n\tLEFT,\n\tCENTER,\n\tRIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignVertical {\n\tTOP,\n\tMIDDLE,\n\tBOTTOM\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DAlignWith {\n\tTEXT,\n\tPADDING,\n\tBORDER\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point, Rectangle } from \"pixi.js\";\nimport { UtilHtmlElementPadding } from \"../../util/util-html-element\";\nimport { UtilInput, UtilInputOperation } from \"../../util/util-input\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeMiscHtmlElement } from \"./e-shape-action-runtime-misc-html-element\";\nimport { EShapeActionValueOnInputActions } from \"./e-shape-action-value-on-input-actions\";\n\nexport abstract class EShapeActionRuntimeMiscInput<\n\tVALUE = unknown,\n\tUTIL extends UtilInput<VALUE> = UtilInput<VALUE>\n> extends EShapeActionRuntimeMiscHtmlElement<HTMLInputElement, UTIL> {\n\tprotected newOperation( shape: EShape, runtime: EShapeRuntime ): UtilInputOperation<VALUE> {\n\t\treturn {\n\t\t\tgetElementRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getElementRect( shape, runtime, resolution, work, result );\n\t\t\t},\n\n\t\t\tgetElementMatrix: (): Matrix | null => {\n\t\t\t\treturn this.getElementMatrix( shape, runtime );\n\t\t\t},\n\n\t\t\tgetClipperRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getClipperToRect( shape, runtime, resolution, work, result );\n\t\t\t},\n\n\t\t\tgetPadding: (): UtilHtmlElementPadding | null => {\n\t\t\t\treturn this.getPadding( shape, runtime );\n\t\t\t},\n\n\t\t\tcontainsPoint: ( point: Point ): boolean => {\n\t\t\t\treturn this.containsPoint( shape, runtime, point );\n\t\t\t},\n\n\t\t\tonStart: (): void => {\n\t\t\t\tshape.text.enable = false;\n\t\t\t},\n\n\t\t\tonCancel: (): void => {\n\t\t\t\tshape.text.enable = true;\n\t\t\t},\n\n\t\t\tonEnd: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tgetValue: (): VALUE | undefined => {\n\t\t\t\treturn this.getUtil( shape, runtime ).toValue( shape.text.value );\n\t\t\t},\n\n\t\t\tonValueInput: ( newValue: VALUE ): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tonValueChange: ( newValue: VALUE, oldValue: VALUE ): void => {\n\t\t\t\tthis.onValueChange( shape, runtime, newValue, oldValue );\n\t\t\t},\n\n\t\t\tonEnter: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tapplyTitle: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected getPadding( shape: EShape, runtime: EShapeRuntime ): UtilHtmlElementPadding | null {\n\t\treturn shape.text.padding;\n\t}\n\n\tprotected onValueChange( shape: EShape, runtime: EShapeRuntime, newValue: VALUE, oldValue: VALUE ): void {\n\t\tshape.text.value = this.getUtil( shape, runtime ).fromValue( newValue );\n\t\tconst now = Date.now();\n\t\tconst target = this.target( shape, now );\n\t\tif( target != null ) {\n\t\t\tEShapeActionValueOnInputActions.execute(\n\t\t\t\tshape, this.onInputAction, target, newValue, now\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeInputInteger } from \"../../d-input-integer\";\nimport { DThemes } from \"../../theme/d-themes\";\nimport { UtilInputNumber } from \"../../util/util-input-number\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeMiscInput } from \"./e-shape-action-runtime-misc-input\";\n\nexport class EShapeActionRuntimeMiscInputInteger extends EShapeActionRuntimeMiscInput<number, UtilInputNumber> {\n\tprotected newUtil( shape: EShape, runtime: EShapeRuntime ): UtilInputNumber {\n\t\treturn new UtilInputNumber(\n\t\t\tshape, this.newOperation( shape, runtime ),\n\t\t\tDThemes.getInstance().get<DThemeInputInteger>( \"DInputInteger\" ),\n\t\t\tthis.newUtilOptions( shape, runtime )\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeInputReal } from \"../../d-input-real\";\nimport { DThemes } from \"../../theme/d-themes\";\nimport { UtilInputNumber } from \"../../util/util-input-number\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeMiscInput } from \"./e-shape-action-runtime-misc-input\";\n\nexport class EShapeActionRuntimeMiscInputReal extends EShapeActionRuntimeMiscInput<number, UtilInputNumber> {\n\tprotected newUtil( shape: EShape, runtime: EShapeRuntime ): UtilInputNumber {\n\t\treturn new UtilInputNumber(\n\t\t\tshape, this.newOperation( shape, runtime ),\n\t\t\tDThemes.getInstance().get<DThemeInputReal>( \"DInputReal\" ),\n\t\t\tthis.newUtilOptions( shape, runtime )\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilInput, UtilInputOperation, UtilInputOptions, UtilInputTarget, UtilThemeInput } from \"./util-input\";\n\nexport interface UtilInputTextTarget extends UtilInputTarget {\n\n}\n\nexport interface UtilInputTextOperation extends UtilInputOperation<string> {\n\n}\n\nexport interface UtilInputTextOptions extends UtilInputOptions<string> {\n\n}\n\nexport interface UtilThemeInputText extends UtilThemeInput<string> {\n\n}\n\nexport class UtilInputText<\n\tTARGET extends UtilInputTextTarget = UtilInputTextTarget,\n\tOPERATION extends UtilInputTextOperation = UtilInputTextOperation,\n\tTHEME extends UtilThemeInputText = UtilThemeInputText,\n\tOPTIONS extends UtilInputTextOptions = UtilInputTextOptions\n> extends UtilInput<string, TARGET, OPERATION, THEME, OPTIONS> {\n\tprotected getInputType(): string {\n\t\treturn \"text\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeInputText } from \"../../d-input-text\";\nimport { DThemes } from \"../../theme/d-themes\";\nimport { UtilInputText } from \"../../util/util-input-text\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeMiscInput } from \"./e-shape-action-runtime-misc-input\";\n\nexport class EShapeActionRuntimeMiscInputText extends EShapeActionRuntimeMiscInput<string, UtilInputText> {\n\tprotected newUtil( shape: EShape, runtime: EShapeRuntime ): UtilInputText {\n\t\treturn new UtilInputText(\n\t\t\tshape, this.newOperation( shape, runtime ),\n\t\t\tDThemes.getInstance().get<DThemeInputText>( \"DInputText\" ),\n\t\t\tthis.newUtilOptions( shape, runtime )\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueMisc } from \"./e-shape-action-value-misc\";\n\nexport abstract class EShapeActionRuntimeMiscWrite extends EShapeActionRuntimeConditional {\n\tprotected target: EShapeActionExpression<string | null>;\n\tprotected value: EShapeActionExpression<unknown>;\n\n\tconstructor( value: EShapeActionValueMisc ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t\tthis.target = EShapeActionExpressions.ofStringOrNull( value.target );\n\t\tthis.value = EShapeActionExpressions.ofUnknown( value.value );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\tthis.write( shape, target, this.value( shape, time ), time );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected abstract write( shape: EShape, target: string, value: unknown, time: number ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeActionRuntimeMiscWrite } from \"./e-shape-action-runtime-misc-write\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\n\nexport class EShapeActionRuntimeMiscWriteBoth extends EShapeActionRuntimeMiscWrite {\n\tprotected write( shape: EShape, target: string, value: unknown, time: number ): void {\n\t\tEShapeActionRuntimes.write( shape, target, value, time, false );\n\t\tEShapeActionRuntimes.write( shape, target, value, time, true );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeActionRuntimeMiscWrite } from \"./e-shape-action-runtime-misc-write\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\n\nexport class EShapeActionRuntimeMiscWriteLocal extends EShapeActionRuntimeMiscWrite {\n\tprotected write( shape: EShape, target: string, value: unknown, time: number ): void {\n\t\tEShapeActionRuntimes.write( shape, target, value, time, false );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeActionRuntimeMiscWrite } from \"./e-shape-action-runtime-misc-write\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\n\nexport class EShapeActionRuntimeMiscWriteRemote extends EShapeActionRuntimeMiscWrite {\n\tprotected write( shape: EShape, target: string, value: unknown, time: number ): void {\n\t\tEShapeActionRuntimes.write( shape, target, value, time, true );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntime } from \"./e-shape-action-runtime\";\nimport { EShapeActionRuntimeMiscEmitEvent } from \"./e-shape-action-runtime-misc-emit-event\";\nimport { EShapeActionRuntimeMiscHtmlElement } from \"./e-shape-action-runtime-misc-html-element\";\nimport { EShapeActionRuntimeMiscInputInteger } from \"./e-shape-action-runtime-misc-input-integer\";\nimport { EShapeActionRuntimeMiscInputReal } from \"./e-shape-action-runtime-misc-input-real\";\nimport { EShapeActionRuntimeMiscInputText } from \"./e-shape-action-runtime-misc-input-text\";\nimport { EShapeActionRuntimeMiscWriteBoth } from \"./e-shape-action-runtime-misc-write-both\";\nimport { EShapeActionRuntimeMiscWriteLocal } from \"./e-shape-action-runtime-misc-write-local\";\nimport { EShapeActionRuntimeMiscWriteRemote } from \"./e-shape-action-runtime-misc-write-remote\";\nimport { EShapeActionValueMiscType } from \"./e-shape-action-value-misc-type\";\nimport { EShapeActionValueOnInputAction } from \"./e-shape-action-value-on-input-action\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueMiscSerialized = [\n\tEShapeActionValueType.MISC, number, EShapeActionValueMiscType, number, EShapeActionValueOnInputAction, number\n];\n\nexport class EShapeActionValueMisc extends EShapeActionValueSubtyped<EShapeActionValueMiscType> {\n\treadonly target: string;\n\treadonly onInputAction: EShapeActionValueOnInputAction;\n\treadonly value: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueMiscType,\n\t\tcondition: string,\n\t\ttarget: string,\n\t\tonInputAction: EShapeActionValueOnInputAction,\n\t\tvalue: string\n\t) {\n\t\tsuper( EShapeActionValueType.MISC, condition, subtype );\n\t\tthis.target = target;\n\t\tthis.onInputAction = onInputAction;\n\t\tthis.value = value;\n\t}\n\n\ttoRuntime(): EShapeActionRuntime {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueMiscType.INPUT_TEXT:\n\t\t\treturn new EShapeActionRuntimeMiscInputText( this );\n\t\tcase EShapeActionValueMiscType.INPUT_INTEGER:\n\t\t\treturn new EShapeActionRuntimeMiscInputInteger( this );\n\t\tcase EShapeActionValueMiscType.INPUT_REAL:\n\t\t\treturn new EShapeActionRuntimeMiscInputReal( this );\n\t\tcase EShapeActionValueMiscType.EMIT_EVENT:\n\t\t\treturn new EShapeActionRuntimeMiscEmitEvent( this );\n\t\tcase EShapeActionValueMiscType.WRITE_BOTH:\n\t\t\treturn new EShapeActionRuntimeMiscWriteBoth( this );\n\t\tcase EShapeActionValueMiscType.WRITE_LOCAL:\n\t\t\treturn new EShapeActionRuntimeMiscWriteLocal( this );\n\t\tcase EShapeActionValueMiscType.WRITE_REMOTE:\n\t\t\treturn new EShapeActionRuntimeMiscWriteRemote( this );\n\t\tcase EShapeActionValueMiscType.HTML_ELEMENT:\n\t\tcase EShapeActionValueMiscType.HTML_ELEMENT_WITHOUT_POINTER_EVENTS:\n\t\t\treturn new EShapeActionRuntimeMiscHtmlElement( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\tconst targetId = manager.addResource(this.target);\n\t\tconst valueId = manager.addResource(this.value);\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${targetId},${this.onInputAction},${valueId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueMiscSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueMisc {\n\t\tconst resources = manager.resources;\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, resources );\n\t\tconst target = EShapeActionValues.toResource( 3, serialized, resources );\n\t\tconst value = EShapeActionValues.toResource( 5, serialized, resources );\n\t\treturn new EShapeActionValueMisc( serialized[ 2 ], condition, target, serialized[ 4 ], value );\n\t}\n}\n","import { DynamicFontAtlasCharacter } from \"./util/dynamic-font-atlas-character\";\n\nexport class DDynamicTextMeasureResultCharacter {\n\tx: number;\n\ty: number;\n\tcharacter: DynamicFontAtlasCharacter;\n\n\tconstructor( x: number, y: number, character: DynamicFontAtlasCharacter ) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.character = character;\n\t}\n\n\tset( x: number, y: number, character: DynamicFontAtlasCharacter ): void {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t\tthis.character = character;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Rectangle } from \"pixi.js\";\n\nexport interface UtilAttachTarget {\n\treadonly width: number;\n\treadonly height: number;\n\treadonly position: IPoint;\n}\n\nexport enum UtilAttachAlign {\n\tTOP,\n\tTOP_LEFT,\n\tTOP_CENTER,\n\tTOP_RIGHT,\n\n\tLEFT,\n\tLEFT_TOP,\n\tLEFT_MIDDLE,\n\tLEFT_BOTTOM,\n\n\tRIGHT,\n\tRIGHT_TOP,\n\tRIGHT_MIDDLE,\n\tRIGHT_BOTTOM,\n\n\tBOTTOM,\n\tBOTTOM_LEFT,\n\tBOTTOM_CENTER,\n\tBOTTOM_RIGHT,\n\n\tOVER\n}\n\nexport class UtilAttach {\n\tstatic attach(\n\t\ttarget: UtilAttachTarget,\n\t\tbounds: Rectangle,\n\t\toffsetX: number, offsetY: number,\n\t\tclippingWidth: number, clippingHeight: number,\n\t\talign: UtilAttachAlign\n\t): void {\n\t\tconst width = target.width;\n\t\tconst height = target.height;\n\n\t\tlet x = 0;\n\t\tswitch( align ) {\n\t\tcase UtilAttachAlign.LEFT:\n\t\tcase UtilAttachAlign.LEFT_TOP:\n\t\tcase UtilAttachAlign.LEFT_MIDDLE:\n\t\tcase UtilAttachAlign.LEFT_BOTTOM:\n\t\t\tx = bounds.left - width - offsetX;\n\t\t\tif( x < offsetX ) {\n\t\t\t\tx = bounds.right + offsetX;\n\t\t\t\tif( clippingWidth - offsetX < x + width ) {\n\t\t\t\t\tx = offsetX;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.RIGHT:\n\t\tcase UtilAttachAlign.RIGHT_TOP:\n\t\tcase UtilAttachAlign.RIGHT_MIDDLE:\n\t\tcase UtilAttachAlign.RIGHT_BOTTOM:\n\t\t\tx = bounds.right + offsetX;\n\t\t\tif( clippingWidth - offsetX < x + width ) {\n\t\t\t\tx = bounds.left - width - offsetX;\n\t\t\t\tif( x < offsetX ) {\n\t\t\t\t\tx = clippingWidth - width - offsetX;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.TOP:\n\t\tcase UtilAttachAlign.TOP_LEFT:\n\t\tcase UtilAttachAlign.BOTTOM:\n\t\tcase UtilAttachAlign.BOTTOM_LEFT:\n\t\t\tx = this.adjust( bounds.left, width, offsetX, clippingWidth );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.TOP_RIGHT:\n\t\tcase UtilAttachAlign.BOTTOM_RIGHT:\n\t\t\tx = this.adjust( bounds.right - width, width, offsetX, clippingWidth );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.TOP_CENTER:\n\t\tcase UtilAttachAlign.BOTTOM_CENTER:\n\t\tcase UtilAttachAlign.OVER:\n\t\t\tx = this.adjust( (bounds.left + bounds.right - width) * 0.5, width, offsetX, clippingWidth );\n\t\t\tbreak;\n\t\t}\n\n\t\tlet y = 0;\n\t\tswitch( align ) {\n\t\tcase UtilAttachAlign.LEFT:\n\t\tcase UtilAttachAlign.LEFT_TOP:\n\t\tcase UtilAttachAlign.RIGHT:\n\t\tcase UtilAttachAlign.RIGHT_TOP:\n\t\t\ty = this.adjust( bounds.top, height, offsetY, clippingHeight );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.LEFT_MIDDLE:\n\t\tcase UtilAttachAlign.RIGHT_MIDDLE:\n\t\tcase UtilAttachAlign.OVER:\n\t\t\ty = this.adjust( (bounds.top + bounds.bottom - height) * 0.5, height, offsetY, clippingHeight );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.LEFT_BOTTOM:\n\t\tcase UtilAttachAlign.RIGHT_BOTTOM:\n\t\t\ty = this.adjust( bounds.bottom, height, offsetY, clippingHeight );\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.TOP:\n\t\tcase UtilAttachAlign.TOP_LEFT:\n\t\tcase UtilAttachAlign.TOP_RIGHT:\n\t\tcase UtilAttachAlign.TOP_CENTER:\n\t\t\ty = bounds.top - height - offsetY;\n\t\t\tif( y < offsetY ) {\n\t\t\t\ty = bounds.bottom + offsetY;\n\t\t\t\tif( clippingHeight < y + height ) {\n\t\t\t\t\ty = offsetY;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase UtilAttachAlign.BOTTOM:\n\t\tcase UtilAttachAlign.BOTTOM_LEFT:\n\t\tcase UtilAttachAlign.BOTTOM_RIGHT:\n\t\tcase UtilAttachAlign.BOTTOM_CENTER:\n\t\t\ty = bounds.bottom + offsetY;\n\t\t\tif( clippingHeight - offsetY < y + height ) {\n\t\t\t\ty = bounds.top - height - offsetY;\n\t\t\t\tif( y < offsetY ) {\n\t\t\t\t\ty = clippingHeight - height - offsetY;\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\ttarget.position.set( x, y );\n\t}\n\n\tstatic adjust(\n\t\tposition: number,\n\t\tsize: number,\n\t\toffset: number,\n\t\tclippingSize: number\n\t): number {\n\t\tif( position < offset ) {\n\t\t\tif( clippingSize - offset < position + size ) {\n\t\t\t\treturn (clippingSize - size) * 0.5;\n\t\t\t} else {\n\t\t\t\treturn offset;\n\t\t\t}\n\t\t} else if( clippingSize - offset < position + size ) {\n\t\t\tif( clippingSize < size ) {\n\t\t\t\treturn (clippingSize - size) * 0.5;\n\t\t\t} else {\n\t\t\t\treturn clippingSize - size - offset;\n\t\t\t}\n\t\t}\n\t\treturn position;\n\t}\n}\n","import { DDynamicTextMeasureResultCharacter } from \"./d-dynamic-text-measure-result-character\";\nimport { DynamicFontAtlasCharacter } from \"./util/dynamic-font-atlas-character\";\n\nexport class DDynamicTextMeasureResult {\n\tcount: number;\n\twidth: number;\n\theight: number;\n\tcharacters: DDynamicTextMeasureResultCharacter[];\n\tclipped: boolean;\n\n\tx: number;\n\ty: number;\n\n\tconstructor() {\n\t\tthis.count = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.characters = [];\n\t\tthis.clipped = false;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t}\n\n\tstart(): void {\n\t\tthis.count = 0;\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.clipped = false;\n\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t}\n\n\tpush( character: DynamicFontAtlasCharacter ): void {\n\t\tconst x = this.x;\n\t\tthis.x += character.advance;\n\t\tconst y = this.y;\n\t\tconst count = this.count;\n\t\tconst characters = this.characters;\n\t\tif( count < characters.length ) {\n\t\t\tcharacters[ count ].set( x, y, character );\n\t\t} else {\n\t\t\tcharacters.push( new DDynamicTextMeasureResultCharacter( x, y, character ) );\n\t\t}\n\t\tthis.count += 1;\n\t}\n\n\tnewLine( lineHeight: number ): void {\n\t\tthis.width = Math.max( this.width, this.x );\n\t\tthis.x = 0;\n\t\tthis.y += lineHeight;\n\t}\n\n\tpop(): boolean {\n\t\tif( 0 < this.x ) {\n\t\t\tconst count = this.count;\n\t\t\tconst characters = this.characters;\n\t\t\tif( 0 < count ) {\n\t\t\t\tconst character = characters[ count - 1 ];\n\t\t\t\tthis.x -= character.character.advance;\n\t\t\t\tthis.count -= 1;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tend( lineHeight: number ): void {\n\t\tthis.newLine( lineHeight );\n\t\tthis.height = this.y;\n\t}\n}\n","import { DDynamicTextMeasureResult } from \"./d-dynamic-text-measure-result\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\nimport { UtilCharacterIterator } from \"./util/util-character-iterator\";\n\nexport class DDynamicTextMeasure {\n\tprotected static RESULT: DDynamicTextMeasureResult | null = null;\n\n\tstatic measure(\n\t\ttext: string, atlas: DynamicFontAtlas | null, clippingWidth: number | undefined\n\t): DDynamicTextMeasureResult {\n\t\tconst result = DDynamicTextMeasure.RESULT = DDynamicTextMeasure.RESULT || new DDynamicTextMeasureResult();\n\t\tresult.start();\n\t\tif( atlas != null ) {\n\t\t\tconst iterator = UtilCharacterIterator.from( text );\n\t\t\tconst lineHeight = atlas.font.height;\n\t\t\tconst newLine = \"\\n\";\n\t\t\twhile( iterator.hasNext() ) {\n\t\t\t\tconst character = iterator.next();\n\t\t\t\tif( character === newLine ) {\n\t\t\t\t\tresult.newLine( lineHeight );\n\t\t\t\t} else {\n\t\t\t\t\tconst a = atlas.get( character );\n\t\t\t\t\tif( a != null ) {\n\t\t\t\t\t\tif( clippingWidth != null && clippingWidth < result.x + a.advance ) {\n\t\t\t\t\t\t\tresult.clipped = true;\n\t\t\t\t\t\t\tconst dots = atlas.get( \"...\" );\n\t\t\t\t\t\t\tif( dots != null ) {\n\t\t\t\t\t\t\t\twhile( clippingWidth - dots.advance < result.x ) {\n\t\t\t\t\t\t\t\t\tif( ! result.pop() ) {\n\t\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tif( result.x <= clippingWidth - dots.advance ) {\n\t\t\t\t\t\t\t\t\tresult.push( dots );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\twhile( iterator.hasNext() ) {\n\t\t\t\t\t\t\t\tif( iterator.next() === newLine ) {\n\t\t\t\t\t\t\t\t\tresult.newLine( lineHeight );\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.push( a );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tresult.end( lineHeight );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { MeshGeometry } from \"pixi.js\";\nimport { DDynamicTextMeasure } from \"./d-dynamic-text-measure\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\nimport { DynamicFontAtlasCharacter } from \"./util/dynamic-font-atlas-character\";\n\nexport class DDynamicTextGeometry extends MeshGeometry {\n\twidth: number;\n\theight: number;\n\tclipped: boolean;\n\n\tconstructor() {\n\t\tsuper( new Float32Array( 64 ), new Float32Array( 64 ), new Uint16Array( 48 ) );\n\t\tthis.width = 0;\n\t\tthis.height = 0;\n\t\tthis.clipped = false;\n\t}\n\n\tupdate( text: string, atlas: DynamicFontAtlas | null, clippingWidth: number | undefined ): void {\n\t\tconst vertexBuffer = this.getBuffer( \"aVertexPosition\" );\n\t\tconst uvBuffer = this.getBuffer( \"aTextureCoord\" );\n\t\tconst indexBuffer = this.getIndex();\n\n\t\tconst result = DDynamicTextMeasure.measure( text, atlas, clippingWidth );\n\t\tconst requiredTextSize = Math.ceil( result.count / 8 ) << 3;\n\t\tconst requiredVertexSize = requiredTextSize << 3;\n\t\tif( (vertexBuffer.data as Float32Array).length < requiredVertexSize ) {\n\t\t\tvertexBuffer.data = new Float32Array( requiredVertexSize );\n\t\t\tuvBuffer.data = new Float32Array( requiredVertexSize );\n\t\t}\n\t\tconst requiredIndexSize = requiredTextSize * 6;\n\t\tif( (indexBuffer.data as Uint16Array).length < requiredIndexSize ) {\n\t\t\tindexBuffer.data = new Uint16Array( requiredIndexSize );\n\t\t}\n\n\t\tconst vertices = vertexBuffer.data as Float32Array;\n\t\tconst uvs = uvBuffer.data as Float32Array;\n\t\tconst indices = indexBuffer.data as Uint16Array;\n\n\t\tif( atlas != null ) {\n\t\t\tconst count = result.count;\n\t\t\tconst characters = result.characters;\n\t\t\tfor( let i = 0; i < count; ++i ) {\n\t\t\t\tconst character = characters[ i ];\n\t\t\t\tthis.writeCharacter(\n\t\t\t\t\tvertices, uvs, indices,\n\t\t\t\t\ti, character.x, character.y,\n\t\t\t\t\tcharacter.character, atlas.width, atlas.height\n\t\t\t\t);\n\t\t\t}\n\t\t\tfor( let i = count, imax = vertices.length >> 3; i < imax; ++i ) {\n\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, i );\n\t\t\t}\n\t\t\tthis.width = result.width;\n\t\t\tthis.height = result.height;\n\t\t\tthis.clipped = result.clipped;\n\t\t} else {\n\t\t\tfor( let i = 0, imax = vertices.length >> 3; i < imax; ++i ) {\n\t\t\t\tthis.writeCharacterEmpty( vertices, uvs, indices, i );\n\t\t\t}\n\t\t\tthis.width = 0;\n\t\t\tthis.height = 0;\n\t\t\tthis.clipped = false;\n\t\t}\n\n\t\tvertexBuffer.update();\n\t\tuvBuffer.update();\n\t\tindexBuffer.update();\n\t}\n\n\tprotected writeCharacter(\n\t\tvertices: Float32Array, uvs: Float32Array, indices: Uint16Array,\n\t\tindex: number, x: number, y: number,\n\t\tcharacter: DynamicFontAtlasCharacter,\n\t\twidth: number, height: number\n\t): void {\n\t\tconst cx = character.x;\n\t\tconst cy = character.y;\n\t\tconst cw = character.width;\n\t\tconst ch = character.height;\n\t\tconst cox = character.origin.x;\n\n\t\tconst x0 = x + (cx - cox);\n\t\tconst y0 = y;\n\t\tconst x1 = x0 + cw;\n\t\tconst y1 = y0 + ch;\n\n\t\tconst iv = index << 3;\n\t\tvertices[ iv + 0 ] = x0;\n\t\tvertices[ iv + 1 ] = y0;\n\t\tvertices[ iv + 2 ] = x1;\n\t\tvertices[ iv + 3 ] = y0;\n\t\tvertices[ iv + 4 ] = x1;\n\t\tvertices[ iv + 5 ] = y1;\n\t\tvertices[ iv + 6 ] = x0;\n\t\tvertices[ iv + 7 ] = y1;\n\n\t\tconst u0 = cx / width;\n\t\tconst v0 = cy / height;\n\t\tconst u1 = ( cx + cw ) / width;\n\t\tconst v1 = ( cy + ch ) / height;\n\t\tuvs[ iv + 0 ] = u0;\n\t\tuvs[ iv + 1 ] = v0;\n\t\tuvs[ iv + 2 ] = u1;\n\t\tuvs[ iv + 3 ] = v0;\n\t\tuvs[ iv + 4 ] = u1;\n\t\tuvs[ iv + 5 ] = v1;\n\t\tuvs[ iv + 6 ] = u0;\n\t\tuvs[ iv + 7 ] = v1;\n\n\t\tconst ii = index * 6;\n\t\tconst vo = index << 2;\n\t\tindices[ ii + 0 ] = vo + 0;\n\t\tindices[ ii + 1 ] = vo + 1;\n\t\tindices[ ii + 2 ] = vo + 3;\n\t\tindices[ ii + 3 ] = vo + 1;\n\t\tindices[ ii + 4 ] = vo + 2;\n\t\tindices[ ii + 5 ] = vo + 3;\n\t}\n\n\tprotected writeCharacterEmpty(\n\t\tvertices: Float32Array, uvs: Float32Array, indices: Uint16Array,\n\t\tindex: number\n\t): void {\n\t\tconst iv = index << 3;\n\t\tvertices[ iv + 0 ] = 0;\n\t\tvertices[ iv + 1 ] = 0;\n\t\tvertices[ iv + 2 ] = 0;\n\t\tvertices[ iv + 3 ] = 0;\n\t\tvertices[ iv + 4 ] = 0;\n\t\tvertices[ iv + 5 ] = 0;\n\t\tvertices[ iv + 6 ] = 0;\n\t\tvertices[ iv + 7 ] = 0;\n\n\t\tuvs[ iv + 0 ] = 0;\n\t\tuvs[ iv + 1 ] = 0;\n\t\tuvs[ iv + 2 ] = 0;\n\t\tuvs[ iv + 3 ] = 0;\n\t\tuvs[ iv + 4 ] = 0;\n\t\tuvs[ iv + 5 ] = 0;\n\t\tuvs[ iv + 6 ] = 0;\n\t\tuvs[ iv + 7 ] = 0;\n\n\t\tconst ii = index * 6;\n\t\tconst vo = index << 2;\n\t\tindices[ ii + 0 ] = vo + 0;\n\t\tindices[ ii + 1 ] = vo + 1;\n\t\tindices[ ii + 2 ] = vo + 3;\n\t\tindices[ ii + 3 ] = vo + 1;\n\t\tindices[ ii + 4 ] = vo + 2;\n\t\tindices[ ii + 5 ] = vo + 3;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseStateSetImpl } from \"./d-base-state-set-impl\";\nimport { DFontStyle, DFontVariant, DFontWeight, DThemeFont } from \"./d-font\";\nimport { DThemes } from \"./theme/d-themes\";\n\nexport type DDynamicTextAlign = \"left\" | \"center\" | \"right\";\n\nexport interface DDynamicTextStyleOptions {\n\talign?: DDynamicTextAlign;\n\tfontFamily?: string;\n\tfontSize?: number;\n\tfontStyle?: DFontStyle;\n\tfontVariant?: DFontVariant;\n\tfontWeight?: DFontWeight;\n\tfill?: number;\n\tclipping?: boolean;\n}\n\nexport class DDynamicTextStyle {\n\tprotected static DEFAULT_OPTIONS?: Required<DDynamicTextStyleOptions>;\n\n\tprotected _id: number;\n\tprotected _idApproved: number;\n\tprotected _fontIdId: number;\n\tprotected _fontId: string;\n\tprotected _fontIdApproved: string;\n\tprotected _align: DDynamicTextAlign;\n\tprotected _fontFamily: string;\n\tprotected _fontSize: number;\n\tprotected _fontStyle: DFontStyle;\n\tprotected _fontVariant: DFontVariant;\n\tprotected _fontWeight: DFontWeight;\n\tprotected _fill: number;\n\tprotected _fillApproved: number;\n\tprotected _clipping: boolean;\n\tprotected _onChange: () => void;\n\n\tconstructor( options: DDynamicTextStyleOptions | undefined, onChange: () => void ) {\n\t\tthis._id = 0;\n\t\tthis._idApproved = -1;\n\n\t\tconst defaultOptions = this.getDefaultOptions();\n\t\tif( options ) {\n\t\t\tthis._align = options.align ?? defaultOptions.align;\n\t\t\tthis._fontFamily = options.fontFamily ?? defaultOptions.fontFamily;\n\t\t\tthis._fontSize = options.fontSize ?? defaultOptions.fontSize;\n\t\t\tthis._fontStyle = options.fontStyle ?? defaultOptions.fontStyle;\n\t\t\tthis._fontVariant = options.fontVariant ?? defaultOptions.fontVariant;\n\t\t\tthis._fontWeight = options.fontWeight ?? defaultOptions.fontWeight;\n\t\t\tthis._fill = options.fill ?? defaultOptions.fill;\n\t\t\tthis._clipping = options.clipping ?? defaultOptions.clipping;\n\t\t} else {\n\t\t\tthis._align = defaultOptions.align;\n\t\t\tthis._fontFamily = defaultOptions.fontFamily;\n\t\t\tthis._fontSize = defaultOptions.fontSize;\n\t\t\tthis._fontStyle = defaultOptions.fontStyle;\n\t\t\tthis._fontVariant = defaultOptions.fontVariant;\n\t\t\tthis._fontWeight = defaultOptions.fontWeight;\n\t\t\tthis._fill = defaultOptions.fill;\n\t\t\tthis._clipping = defaultOptions.clipping;\n\t\t}\n\n\t\tthis._fontIdId = -1;\n\t\tthis._fontId = \"\";\n\t\tthis._fontIdApproved = \"\";\n\t\tthis._fillApproved = 0x000000;\n\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected getDefaultOptions(): Required<DDynamicTextStyleOptions> {\n\t\tlet result = DDynamicTextStyle.DEFAULT_OPTIONS;\n\t\tif( result == null ) {\n\t\t\tconst theme = DThemes.getInstance().get( \"DBase\" ) as DThemeFont;\n\t\t\tresult = {\n\t\t\t\talign: \"left\",\n\t\t\t\tfontFamily: theme.getFontFamilly(),\n\t\t\t\tfontSize: theme.getFontSize(),\n\t\t\t\tfontStyle: \"normal\",\n\t\t\t\tfontVariant: \"normal\",\n\t\t\t\tfontWeight: \"normal\",\n\t\t\t\tfill: theme.getColor( new DBaseStateSetImpl() ),\n\t\t\t\tclipping: true\n\t\t\t};\n\t\t\tDDynamicTextStyle.DEFAULT_OPTIONS = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget idApproved(): number {\n\t\treturn this._idApproved;\n\t}\n\n\tget fontId(): string {\n\t\tthis.update();\n\t\treturn this._fontId;\n\t}\n\n\tget fontIdApproved(): string {\n\t\treturn this._fontIdApproved;\n\t}\n\n\tget fill(): number {\n\t\treturn this._fill;\n\t}\n\n\tset fill( fill: number ) {\n\t\tif( this._fill !== fill ) {\n\t\t\tthis._fill = fill;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected onChange(): void {\n\t\tthis._id += 1;\n\t\tthis._onChange();\n\t}\n\n\tget fillApproved(): number {\n\t\treturn this._fillApproved;\n\t}\n\n\tapprove(): void {\n\t\tthis.update();\n\t\tthis._idApproved = this._id;\n\t\tthis._fontIdApproved = this._fontId;\n\t\tthis._fillApproved = this._fill;\n\t}\n\n\tget fontFamily(): string {\n\t\treturn this._fontFamily;\n\t}\n\n\tset fontFamily( fontFamily: string ) {\n\t\tif( this._fontFamily !== fontFamily ) {\n\t\t\tthis._fontFamily = fontFamily;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontSize(): number {\n\t\treturn this._fontSize;\n\t}\n\n\tset fontSize( fontSize: number ) {\n\t\tif( this._fontSize !== fontSize ) {\n\t\t\tthis._fontSize = fontSize;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontStyle(): DFontStyle {\n\t\treturn this._fontStyle;\n\t}\n\n\tset fontStyle( fontStyle: DFontStyle ) {\n\t\tif( this._fontStyle !== fontStyle ) {\n\t\t\tthis._fontStyle = fontStyle;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontVariant(): DFontVariant {\n\t\treturn this._fontVariant;\n\t}\n\n\tset fontVariant( fontVariant: DFontVariant ) {\n\t\tif( this._fontVariant !== fontVariant ) {\n\t\t\tthis._fontVariant = fontVariant;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget fontWeight(): DFontWeight {\n\t\treturn this._fontWeight;\n\t}\n\n\tset fontWeight( fontWeight: DFontWeight ) {\n\t\tif( this._fontWeight !== fontWeight ) {\n\t\t\tthis._fontWeight = fontWeight;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tprotected update(): void {\n\t\tif( this._fontIdId !== this._id ) {\n\t\t\tthis._fontIdId = this._id;\n\t\t\tthis._fontId = this.newFontId();\n\t\t}\n\t}\n\n\tprotected newFontId(): string {\n\t\treturn `${this._fontStyle} ${this._fontVariant} ${this._fontWeight} ${this._fontSize}px ${this._fontFamily}`;\n\t}\n\n\tget clipping(): boolean {\n\t\treturn this._clipping;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tif( this._clipping !== clipping ) {\n\t\t\tthis._clipping = clipping;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Mesh, MeshMaterial, Renderer, Texture } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DDynamicTextGeometry } from \"./d-dynamic-text-geometry\";\nimport { DDynamicTextStyle, DDynamicTextStyleOptions } from \"./d-dynamic-text-style\";\nimport { DynamicFontAtlas } from \"./util/dynamic-font-atlas\";\n\nexport class DDynamicText extends Mesh {\n\tprotected _style: DDynamicTextStyle;\n\tprotected _text: string;\n\tprotected _textApproved: string;\n\tprotected _isDirty: boolean;\n\tprotected _isGeometryDirty: boolean;\n\tprotected _atlas: DynamicFontAtlas | null;\n\tprotected _atlasRevisionUpdated: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _clippingWidth: number | undefined;\n\tprotected _clippingWidthDelta: number;\n\n\treadonly geometry!: DDynamicTextGeometry;\n\n\tconstructor( text: string, options?: DDynamicTextStyleOptions ) {\n\t\tsuper( new DDynamicTextGeometry(), new MeshMaterial( Texture.EMPTY ) );\n\n\t\tthis._style = new DDynamicTextStyle( options, (): void => {\n\t\t\tthis._isDirty = true;\n\t\t\tthis._isGeometryDirty = true;\n\t\t\tthis._atlas = null;\n\t\t\tthis.update_();\n\t\t});\n\t\tthis._text = text;\n\t\tthis._textApproved = \"\";\n\t\tthis._isDirty = true;\n\t\tthis._isGeometryDirty = true;\n\t\tthis._atlas = null;\n\t\tthis._atlasRevisionUpdated = 0;\n\t\tthis._width = 0;\n\t\tthis._height = 0;\n\t\tthis._clippingWidthDelta = 0;\n\t\tthis.update_();\n\t}\n\n\tprotected update_(): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst style = this._style;\n\t\t\tif( this._isDirty ) {\n\t\t\t\tthis._isDirty = false;\n\n\t\t\t\tconst text = this._text;\n\t\t\t\tconst textApproved = this._textApproved;\n\t\t\t\tthis._textApproved = text;\n\t\t\t\tconst fontId = style.fontId;\n\t\t\t\tconst fontIdApproved = style.fontIdApproved;\n\t\t\t\tconst fontSize = style.fontSize;\n\t\t\t\tconst fill = style.fill;\n\t\t\t\tconst fillApproved = style.fillApproved;\n\t\t\t\tstyle.approve();\n\n\t\t\t\tconst atlases = layer.getDynamicFontAtlases();\n\t\t\t\tif( text !== textApproved || fontId !== fontIdApproved || fill !== fillApproved ) {\n\t\t\t\t\tatlases.add( fontId, fontSize, fill, text );\n\t\t\t\t\tatlases.remove( fontIdApproved, fillApproved, textApproved );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget text(): string {\n\t\treturn this._text;\n\t}\n\n\tset text( text: string ) {\n\t\tif( this._text !== text ) {\n\t\t\tthis._text = text;\n\t\t\tthis._isDirty = true;\n\t\t\tthis._isGeometryDirty = true;\n\t\t\tthis.update_();\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget width(): number {\n\t\tthis.update();\n\t\treturn Math.abs( this.scale.x ) * this.geometry.width;\n\t}\n\n\tset width( width: number ) {\n\t\tthis.update();\n\t\tconst geometryWidth = this.geometry.width;\n\t\tif( +1e-4 < geometryWidth ) {\n\t\t\tconst newScale = width / geometryWidth;\n\t\t\tthis.scale.x = ( 0 <= this.scale.x ? +newScale : -newScale );\n\t\t}\n\t}\n\n\t// @ts-ignore\n\tget height(): number {\n\t\tthis.update();\n\t\treturn Math.abs( this.scale.y ) * this.geometry.height;\n\t}\n\n\tset height( height: number ) {\n\t\tthis.update();\n\t\tconst geometryHeight = this.geometry.height;\n\t\tif( +1e-4 < geometryHeight ) {\n\t\t\tconst newScale = height / geometryHeight;\n\t\t\tthis.scale.y = ( 0 <= this.scale.y ? +newScale : -newScale );\n\t\t}\n\t}\n\n\tget clipped(): boolean {\n\t\treturn this.geometry.clipped;\n\t}\n\n\tget style(): DDynamicTextStyle {\n\t\treturn this._style;\n\t}\n\n\tupdate(): void {\n\t\tthis.update_();\n\n\t\tlet atlas = this._atlas;\n\t\tif( atlas == null ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tconst style = this._style;\n\t\t\t\tatlas = layer.getDynamicFontAtlases().get( style.fontId, style.fill );\n\t\t\t\tif( atlas != null ) {\n\t\t\t\t\tthis._atlasRevisionUpdated = atlas.getRevisionUpdate();\n\t\t\t\t\tthis._atlas = atlas;\n\t\t\t\t\tthis.texture = atlas.texture;\n\t\t\t\t\tthis._isGeometryDirty = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst revisionUpdate = atlas.getRevisionUpdate();\n\t\t\tif( revisionUpdate !== this._atlasRevisionUpdated ) {\n\t\t\t\tthis._atlasRevisionUpdated = revisionUpdate;\n\t\t\t\tthis._isGeometryDirty = true;\n\t\t\t}\n\t\t}\n\n\t\tconst clippingWidth = this._clippingWidth;\n\t\tconst newClippingWidth = this.getClippingWidth();\n\t\tif( clippingWidth !== newClippingWidth ) {\n\t\t\tthis._clippingWidth = newClippingWidth;\n\t\t\tthis._isGeometryDirty = true;\n\t\t}\n\n\t\tif( this._isGeometryDirty ) {\n\t\t\tthis._isGeometryDirty = false;\n\t\t\tthis.geometry.update( this._text, atlas, newClippingWidth );\n\t\t}\n\t}\n\n\tprotected getClippingWidth(): number | undefined {\n\t\tif( this._style.clipping ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent instanceof DBase ) {\n\t\t\t\treturn parent.width - parent.padding.getLeft() - parent.padding.getRight() - this._clippingWidthDelta;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tsetClippingWidthDelta( width: number ): void {\n\t\tthis._clippingWidthDelta = width;\n\t}\n\n\t_calculateBounds(): void {\n\t\tthis.update();\n\t\tsuper._calculateBounds();\n\t}\n\n\t_render( renderer?: Renderer ): void {\n\t\tthis.update();\n\t\t(super._render as any)( renderer );\n\t}\n}\n","import { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DAlignWith } from \"./d-align-with\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DThemeImagePiece } from \"./d-image-piece\";\n\nexport interface DThemeImageBaseSecondary {\n\tgetSecondaryImageAlignHorizontal(): DAlignHorizontal;\n\tgetSecondaryImageAlignVertical(): DAlignVertical;\n\tgetSecondaryImageAlignWith(): DAlignWith;\n\tgetSecondaryImageMarginHorizontal(): number;\n\tgetSecondaryImageMarginVertial(): number;\n\tgetSecondaryImageTintColor( state: DBaseStateSet ): number | null;\n\tgetSecondaryImageTintAlpha( state: DBaseStateSet ): number;\n\tgetSecondaryImageSource( state: DBaseStateSet ): Texture | DisplayObject | null;\n}\n\nexport class DImageBaseThemeWrapperSecondary implements DThemeImagePiece {\n\tprotected _theme: DThemeImageBaseSecondary;\n\n\tconstructor( theme: DThemeImageBaseSecondary ) {\n\t\tthis._theme = theme;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn this._theme.getSecondaryImageAlignHorizontal();\n\t}\n\n\tgetImageAlignVertical(): DAlignVertical {\n\t\treturn this._theme.getSecondaryImageAlignVertical();\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn this._theme.getSecondaryImageAlignWith();\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn this._theme.getSecondaryImageMarginHorizontal();\n\t}\n\n\tgetImageMarginVertial(): number {\n\t\treturn this._theme.getSecondaryImageMarginVertial();\n\t}\n\n\tgetImageTintColor( state: DBaseStateSet ): number | null {\n\t\treturn this._theme.getSecondaryImageTintColor( state );\n\t}\n\n\tgetImageTintAlpha( state: DBaseStateSet ): number {\n\t\treturn this._theme.getSecondaryImageTintAlpha( state );\n\t}\n\n\tgetImageSource( state: DBaseStateSet ): Texture | DisplayObject | null {\n\t\treturn this._theme.getSecondaryImageSource( state );\n\t}\n}\n","import { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DAlignWith } from \"./d-align-with\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DThemeImagePiece } from \"./d-image-piece\";\n\nexport interface DThemeImageBaseTertiary {\n\tgetTertiaryImageAlignHorizontal(): DAlignHorizontal;\n\tgetTertiaryImageAlignVertical(): DAlignVertical;\n\tgetTertiaryImageAlignWith(): DAlignWith;\n\tgetTertiaryImageMarginHorizontal(): number;\n\tgetTertiaryImageMarginVertial(): number;\n\tgetTertiaryImageTintColor( state: DBaseStateSet ): number | null;\n\tgetTertiaryImageTintAlpha( state: DBaseStateSet ): number;\n\tgetTertiaryImageSource( state: DBaseStateSet ): Texture | DisplayObject | null;\n}\n\nexport class DImageBaseThemeWrapperTertiary implements DThemeImagePiece {\n\tprotected _theme: DThemeImageBaseTertiary;\n\n\tconstructor( theme: DThemeImageBaseTertiary ) {\n\t\tthis._theme = theme;\n\t}\n\n\tgetImageAlignHorizontal(): DAlignHorizontal {\n\t\treturn this._theme.getTertiaryImageAlignHorizontal();\n\t}\n\n\tgetImageAlignVertical(): DAlignVertical {\n\t\treturn this._theme.getTertiaryImageAlignVertical();\n\t}\n\n\tgetImageAlignWith(): DAlignWith {\n\t\treturn this._theme.getTertiaryImageAlignWith();\n\t}\n\n\tgetImageMarginHorizontal(): number {\n\t\treturn this._theme.getTertiaryImageMarginHorizontal();\n\t}\n\n\tgetImageMarginVertial(): number {\n\t\treturn this._theme.getTertiaryImageMarginVertial();\n\t}\n\n\tgetImageTintColor( state: DBaseStateSet ): number | null {\n\t\treturn this._theme.getTertiaryImageTintColor( state );\n\t}\n\n\tgetImageTintAlpha( state: DBaseStateSet ): number {\n\t\treturn this._theme.getTertiaryImageTintAlpha( state );\n\t}\n\n\tgetImageSource( state: DBaseStateSet ): Texture | DisplayObject | null {\n\t\treturn this._theme.getTertiaryImageSource( state );\n\t}\n}\n","import { DisplayObject, Graphics, Rectangle, Sprite, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DAlignWith } from \"./d-align-with\";\nimport { DApplicationTarget } from \"./d-application-like\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { toEnum } from \"./util/to-enum\";\n\nexport interface DImagePieceTintOptions {\n\tcolor?: DStateAwareOrValueMightBe<number | null>;\n\talpha?: DStateAwareOrValueMightBe<number>;\n}\n\nexport interface DImagePieceAlignOptions {\n\twith?: (keyof typeof DAlignWith) | DAlignWith;\n\tvertical?: (keyof typeof DAlignVertical) | DAlignVertical;\n\thorizontal?: (keyof typeof DAlignHorizontal) | DAlignHorizontal;\n}\n\nexport interface DImagePieceMarginOptions {\n\tvertical?: number;\n\thorizontal?: number;\n}\n\nexport interface DImagePieceOptions {\n\tsource?: DStateAwareOrValueMightBe<Texture | DisplayObject | null>;\n\ttint?: DImagePieceTintOptions;\n\talign?: DImagePieceAlignOptions;\n\tmargin?: DImagePieceMarginOptions;\n}\n\nexport interface DImagePieceAlign {\n\twith: DAlignWith;\n\tvertical: DAlignVertical;\n\thorizontal: DAlignHorizontal;\n}\n\nexport interface DImagePieceMargin {\n\tvertical: number;\n\thorizontal: number;\n}\n\nexport interface DImagePieceTextAlign {\n\tvertical: DAlignVertical;\n\thorizontal: DAlignHorizontal;\n}\n\nexport interface DImagePieceParent extends DApplicationTarget {\n\treadonly state: DBaseStateSet;\n\taddChild( displayObject: DisplayObject ): void;\n\tremoveChild( displayObject: DisplayObject ): void;\n\ttoDirty(): void;\n\tgetOverflowMask(): Graphics | null;\n}\n\nexport interface DThemeImagePiece {\n\tgetImageAlignHorizontal(): DAlignHorizontal;\n\tgetImageAlignVertical(): DAlignVertical;\n\tgetImageAlignWith(): DAlignWith;\n\tgetImageMarginHorizontal(): number;\n\tgetImageMarginVertial(): number;\n\tgetImageTintColor( state: DBaseStateSet ): number | null;\n\tgetImageTintAlpha( state: DBaseStateSet ): number;\n\tgetImageSource( state: DBaseStateSet ): Texture | DisplayObject | null;\n}\n\nconst toImageAlign = ( theme: DThemeImagePiece, options?: DImagePieceOptions ): DImagePieceAlign => {\n\tconst align = options?.align;\n\treturn {\n\t\twith: toEnum( align?.with ?? theme.getImageAlignWith(), DAlignWith ),\n\t\tvertical: toEnum( align?.vertical ?? theme.getImageAlignVertical(), DAlignVertical ),\n\t\thorizontal: toEnum( align?.horizontal ?? theme.getImageAlignHorizontal(), DAlignHorizontal )\n\t};\n};\n\nconst toImageMargin = ( theme: DThemeImagePiece, options?: DImagePieceOptions ): DImagePieceMargin => {\n\tconst margin = options?.margin;\n\treturn {\n\t\tvertical: ( margin?.vertical ?? theme.getImageMarginVertial() ),\n\t\thorizontal: ( margin?.horizontal ?? theme.getImageMarginHorizontal() )\n\t};\n};\n\nexport class DImagePiece {\n\tprotected _parent: DImagePieceParent;\n\tprotected _theme: DThemeImagePiece;\n\tprotected _textAlign: DImagePieceTextAlign;\n\n\tprotected _image: DisplayObject | null;\n\tprotected _computed: Texture | DisplayObject | null;\n\tprotected _source: DStateAwareOrValueMightBe<Texture | DisplayObject | null>;\n\tprotected _align: DImagePieceAlign;\n\tprotected _margin: DImagePieceMargin;\n\tprotected _tint: DImagePieceTintOptions | undefined;\n\tprotected _bound: Rectangle;\n\n\tprotected _onUpdateBound: () => void;\n\n\tconstructor(\n\t\tparent: DImagePieceParent,\n\t\ttheme: DThemeImagePiece,\n\t\ttextAlign: DImagePieceTextAlign,\n\t\toptions?: DImagePieceOptions\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._theme = theme;\n\t\tthis._textAlign = textAlign;\n\n\t\tthis._image = null;\n\t\tthis._align = toImageAlign( theme, options );\n\t\tthis._margin = toImageMargin( theme, options );\n\t\tthis._tint = options?.tint;\n\t\tthis._bound = new Rectangle();\n\t\tthis._source = options?.source;\n\t\tthis._computed = null;\n\n\t\tthis._onUpdateBound = () => {\n\t\t\tthis.onUpdate();\n\t\t};\n\t}\n\n\tget image(): DisplayObject | null {\n\t\treturn this._image;\n\t}\n\n\tget align(): DImagePieceAlign {\n\t\treturn this._align;\n\t}\n\n\tget margin(): DImagePieceMargin {\n\t\treturn this._margin;\n\t}\n\n\tget bound(): Rectangle {\n\t\treturn this._bound;\n\t}\n\n\tget source(): DStateAwareOrValueMightBe<Texture | DisplayObject | null> {\n\t\treturn this._source;\n\t}\n\n\tset source( source: DStateAwareOrValueMightBe<Texture | DisplayObject | null> ) {\n\t\tif( this._source !== source ) {\n\t\t\tthis._source = source;\n\t\t\tthis.onUpdate();\n\t\t}\n\t}\n\n\tprotected computeSource(): Texture | DisplayObject | null {\n\t\tconst source = this._source;\n\t\tif( source !== undefined ) {\n\t\t\tif( isFunction( source ) ) {\n\t\t\t\tconst result = source( this._parent.state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn source;\n\t\t\t}\n\t\t}\n\t\treturn this._theme.getImageSource( this._parent.state );\n\t}\n\n\tonStateChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tthis.updateTint();\n\t}\n\n\tupdateBound(): void {\n\t\tconst bound = this._bound;\n\t\tconst image = this._image;\n\t\tif( image != null ) {\n\t\t\timage.updateTransform();\n\t\t\timage.getLocalBounds( bound );\n\t\t\tconst bl = bound.left;\n\t\t\tconst bt = bound.top;\n\t\t\tconst br = bound.right;\n\t\t\tconst bb = bound.bottom;\n\n\t\t\tconst localTransform = image.localTransform;\n\t\t\tconst a = localTransform.a;\n\t\t\tconst b = localTransform.b;\n\t\t\tconst c = localTransform.c;\n\t\t\tconst d = localTransform.d;\n\n\t\t\tconst x0 = a * bl + c * bt;\n\t\t\tconst y0 = b * bl + d * bt;\n\t\t\tconst x1 = a * br + c * bt;\n\t\t\tconst y1 = b * br + d * bt;\n\t\t\tconst x2 = a * br + c * bb;\n\t\t\tconst y2 = b * br + d * bb;\n\t\t\tconst x3 = a * bl + c * bb;\n\t\t\tconst y3 = b * bl + d * bb;\n\n\t\t\tconst xmin = Math.min( x0, x1, x2, x3 );\n\t\t\tconst xmax = Math.max( x0, x1, x2, x3 );\n\t\t\tconst ymin = Math.min( y0, y1, y2, y3 );\n\t\t\tconst ymax = Math.max( y0, y1, y2, y3 );\n\n\t\t\tbound.x = xmin + localTransform.tx;\n\t\t\tbound.y = ymin + localTransform.ty;\n\t\t\tbound.width = xmax - xmin;\n\t\t\tbound.height = ymax - ymin;\n\t\t} else {\n\t\t\tbound.x = 0;\n\t\t\tbound.y = 0;\n\t\t\tbound.width = 0;\n\t\t\tbound.height = 0;\n\t\t}\n\t}\n\n\tprotected isTintAware( target: DisplayObject | null ): target is DisplayObject & { tint: number } {\n\t\treturn ( target != null && \"tint\" in target );\n\t}\n\n\tprotected toTintColor( theme: DThemeImagePiece, state: DBaseStateSet ): number | null {\n\t\tconst tint = this._tint;\n\t\tif( tint ) {\n\t\t\tconst color = tint.color;\n\t\t\tif( color !== undefined ) {\n\t\t\t\tif( isFunction( color ) ) {\n\t\t\t\t\tconst result = color( state );\n\t\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn color;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn theme.getImageTintColor( state );\n\t}\n\n\tprotected toTintAlpha( theme: DThemeImagePiece, state: DBaseStateSet ): number {\n\t\tconst tint = this._tint;\n\t\tif( tint ) {\n\t\t\tconst alpha = tint.alpha;\n\t\t\tif( alpha !== undefined ) {\n\t\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\t\tconst result = alpha( state );\n\t\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn alpha;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn theme.getImageTintAlpha( state );\n\t}\n\n\t/**\n\t * Updates the tint.\n\t *\n\t * @returns True if the tint is changed.\n\t */\n\tupdateTint(): boolean {\n\t\tconst image = this._image;\n\t\tif( image ) {\n\t\t\tif( this.isTintAware( image ) ) {\n\t\t\t\tconst theme = this._theme;\n\t\t\t\tconst state = this._parent.state;\n\t\t\t\tconst color = this.toTintColor( theme, state );\n\t\t\t\tif( color != null ) {\n\t\t\t\t\tlet result = false;\n\t\t\t\t\tif( image.tint !== color ) {\n\t\t\t\t\t\timage.tint = color;\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t\tconst alpha = this.toTintAlpha( theme, state );\n\t\t\t\t\tif( image.alpha !== alpha ) {\n\t\t\t\t\t\timage.alpha = alpha;\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t}\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Updates the computed source.\n\t *\n\t * @returns True if the computed source is changed\n\t */\n\tupdateSource(): boolean {\n\t\tconst newComputed = this.computeSource();\n\t\tconst oldComputed = this._computed;\n\t\tif( newComputed !== oldComputed ) {\n\t\t\tthis._computed = newComputed;\n\n\t\t\tconst parent = this._parent;\n\t\t\tconst oldImage = this._image;\n\t\t\tconst onUpdateBound = this._onUpdateBound;\n\t\t\tif( newComputed instanceof Texture ) {\n\t\t\t\tif( oldComputed instanceof Texture ) {\n\t\t\t\t\toldComputed.off( \"update\", onUpdateBound );\n\t\t\t\t\tif( oldImage instanceof Sprite ) {\n\t\t\t\t\t\toldImage.texture = newComputed;\n\t\t\t\t\t\tnewComputed.on( \"update\", onUpdateBound );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( oldImage != null ) {\n\t\t\t\t\t\tparent.removeChild( oldImage );\n\t\t\t\t\t}\n\n\t\t\t\t\tconst newImage = new Sprite( newComputed );\n\t\t\t\t\tconst overflowMask = parent.getOverflowMask();\n\t\t\t\t\tif( overflowMask ) {\n\t\t\t\t\t\tnewImage.mask = overflowMask;\n\t\t\t\t\t}\n\t\t\t\t\tnewComputed.on( \"update\", onUpdateBound );\n\t\t\t\t\tparent.addChild( newImage );\n\t\t\t\t\tthis._image = newImage;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( oldComputed instanceof Texture ) {\n\t\t\t\t\toldComputed.off( \"update\", onUpdateBound );\n\t\t\t\t\tif( oldImage != null ) {\n\t\t\t\t\t\tparent.removeChild( oldImage );\n\t\t\t\t\t\toldImage.destroy();\n\t\t\t\t\t}\n\t\t\t\t} else if( oldImage != null ) {\n\t\t\t\t\tparent.removeChild( oldImage );\n\t\t\t\t}\n\n\t\t\t\tif( newComputed != null ) {\n\t\t\t\t\tconst overflowMask = parent.getOverflowMask();\n\t\t\t\t\tif( overflowMask ) {\n\t\t\t\t\t\tnewComputed.mask = overflowMask;\n\t\t\t\t\t}\n\t\t\t\t\tparent.addChild( newComputed );\n\t\t\t\t}\n\t\t\t\tthis._image = newComputed;\n\t\t\t}\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tisRefitable( target: any ): boolean {\n\t\treturn ( target != null && target === this._image );\n\t}\n\n\tdestroy(): void {\n\t\tconst image = this._image;\n\t\tif( image ) {\n\t\t\tthis._image = null;\n\t\t\tconst computed = this._computed;\n\t\t\tif( computed instanceof Texture ) {\n\t\t\t\tcomputed.off( \"update\", this._onUpdateBound, this );\n\t\t\t\timage.destroy();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onUpdate(): void {\n\t\tthis._parent.toDirty();\n\t\tDApplications.update( this._parent );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, Renderer } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DBaseOverflowMaskSimple extends Graphics implements DReflowable {\n\tconstructor( parent: DBase ) {\n\t\tsuper();\n\t\t(this as any).parent = parent;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.updateTransform();\n\t\tsuper.render( renderer );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number): void {\n\t\tthis.clear();\n\t\tthis.beginFill( 0xFFFFFF, 1 );\n\t\tthis.drawRect( 0, 0, width, height );\n\t\tthis.endFill();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics, SCALE_MODES, Text } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseEvents, DBaseOptions, DRefitable, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMaskSimple } from \"./d-base-overflow-mask-simple\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DDynamicTextStyleOptions } from \"./d-dynamic-text-style\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { toEnum } from \"./util/to-enum\";\n\n/**\n * {@link DTextBase} text align options.\n */\nexport interface DTextBaseTextAlignOptions {\n\tvertical?: (keyof typeof DAlignVertical) | DAlignVertical;\n\thorizontal?: (keyof typeof DAlignHorizontal) | DAlignHorizontal;\n}\n\n/**\n * {@link DTextBase} text options.\n */\nexport interface DTextBaseTextOptions<VALUE = unknown> {\n\tvalue?: DStateAwareOrValueMightBe<VALUE>;\n\tcolor?: DStateAwareOrValueMightBe<number>;\n\talpha?: DStateAwareOrValueMightBe<number>;\n\tstyle?: DDynamicTextStyleOptions;\n\talign?: DTextBaseTextAlignOptions;\n\tformatter?: ( value: VALUE, caller: any ) => string;\n\tdynamic?: boolean;\n}\n\n/**\n * {@link DTextBase} events.\n */\nexport interface DTextBaseEvents<VALUE, EMITTER> extends DBaseEvents<EMITTER> {\n\n}\n\n/**\n * {@link DTextBase} \"on\" options.\n */\nexport interface DTextBaseOnOptions<VALUE, EMITTER> extends Partial<DTextBaseEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DTextBase} options.\n */\nexport interface DTextBaseOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeTextBase<VALUE> = DThemeTextBase<VALUE>,\n\tEMITTER = any\n> extends DBaseOptions<THEME, EMITTER> {\n\ttext?: DTextBaseTextOptions<VALUE>;\n\tmask?: boolean;\n\ton?: DTextBaseOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DTextBase} theme.\n */\nexport interface DThemeTextBase<VALUE = unknown> extends DThemeBase {\n\tgetTextFormatter(): ( value: VALUE, caller: any ) => string;\n\n\t/**\n\t * Returns a new text value.\n\t * Called to initialize a text value if a text value is not given.\n\t */\n\tnewTextValue(): DStateAwareOrValueMightBe<VALUE>;\n\n\t/**\n\t * Returns a text value.\n\t * Called to get a text vale if there is no text value.\n\t *\n\t * @param state a state\n\t */\n\tgetTextValue( state: DBaseStateSet ): VALUE | undefined;\n\n\tgetTextAlignVertical(): DAlignVertical;\n\tgetTextAlignHorizontal(): DAlignHorizontal;\n\tgetTextStyleClipping(): boolean;\n\tisOverflowMaskEnabled(): boolean;\n\n\t/**\n\t * Returns true if a dynamic text should be enabled.\n\t */\n\tisTextDynamic(): boolean;\n}\n\nconst toTextStyle = <VALUE, THEME extends DThemeTextBase<VALUE>>(\n\ttheme: THEME, options: DTextBaseOptions<VALUE, THEME> | undefined, state: DBaseStateSet\n): DDynamicTextStyleOptions => {\n\tconst style = options?.text?.style;\n\tif( style != null ) {\n\t\tconst fill = style.fill ?? theme.getColor( state );\n\t\tconst fontSize = style.fontSize ?? theme.getFontSize();\n\t\tconst fontFamily = style.fontFamily ?? theme.getFontFamilly();\n\t\tconst fontWeight = style.fontWeight ?? theme.getFontWeight();\n\t\tconst fontStyle = style.fontStyle ?? theme.getFontStyle();\n\t\tconst fontVariant = style.fontVariant ?? theme.getFontVariant();\n\t\tconst clipping = style.clipping ?? theme.getTextStyleClipping();\n\t\treturn {\n\t\t\tfill,\n\t\t\tfontSize,\n\t\t\tfontFamily,\n\t\t\tfontWeight,\n\t\t\tfontStyle,\n\t\t\tfontVariant,\n\t\t\tclipping\n\t\t};\n\t}\n\n\treturn {\n\t\tfill: theme.getColor( state ),\n\t\tfontSize: theme.getFontSize(),\n\t\tfontFamily: theme.getFontFamilly(),\n\t\tfontWeight: theme.getFontWeight(),\n\t\tfontStyle: theme.getFontStyle(),\n\t\tfontVariant: theme.getFontVariant(),\n\t\tclipping: theme.getTextStyleClipping()\n\t};\n};\n\nconst toTextAlign = <VALUE, THEME extends DThemeTextBase<VALUE>>(\n\ttheme: THEME, options?: DTextBaseOptions<VALUE, THEME>\n): { vertical: DAlignVertical, horizontal: DAlignHorizontal } => {\n\tconst align = options?.text?.align;\n\treturn {\n\t\tvertical: toEnum( align?.vertical ?? theme.getTextAlignVertical(), DAlignVertical ),\n\t\thorizontal: toEnum( align?.horizontal ??  theme.getTextAlignHorizontal(), DAlignHorizontal )\n\t};\n};\n\n/**\n * A base class for UI classes with a text support.\n * See {@link DTextBaseEvents} for event defaults.\n */\nexport class DTextBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeTextBase<VALUE> = DThemeTextBase<VALUE>,\n\tOPTIONS extends DTextBaseOptions<VALUE, THEME> = DTextBaseOptions<VALUE, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _text?: DDynamicText | Text | null;\n\tprotected _textValue?: DStateAwareOrValueMightBe<VALUE>;\n\tprotected _textValueComputed?: VALUE;\n\tprotected _textColor!: DStateAwareOrValueMightBe<number>;\n\tprotected _textAlpha!: DStateAwareOrValueMightBe<number>;\n\tprotected _textStyle!: DDynamicTextStyleOptions;\n\tprotected _textAlign!: {\n\t\tvertical: DAlignVertical,\n\t\thorizontal: DAlignHorizontal\n\t};\n\tprotected _textFormatter!: ( value: VALUE, caller: any ) => string;\n\tprotected _isOverflowMaskEnabled!: boolean;\n\tprotected _overflowMask?: DBaseOverflowMaskSimple | null;\n\tprotected _textDynamic!: boolean;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tconst theme = this.theme;\n\t\tthis._textValue = ( options?.text?.value ?? theme.newTextValue() );\n\t\tthis._textValueComputed = this.computeTextValue();\n\t\tconst text = options?.text;\n\t\tthis._textColor = text?.color;\n\t\tthis._textAlpha = text?.alpha;\n\t\tthis._textStyle = toTextStyle( theme, options, this.state );\n\t\tthis._textAlign = toTextAlign( theme, options );\n\t\tthis._textFormatter = ( text?.formatter ?? theme.getTextFormatter() );\n\t\tthis._textDynamic = ( text?.dynamic ?? theme.isTextDynamic() );\n\t\tthis._isOverflowMaskEnabled = ( options?.mask ?? theme.isOverflowMaskEnabled() );\n\t\tthis.onTextChange();\n\t\tthis.createOrUpdateText();\n\t}\n\n\tset text( text: DStateAwareOrValueMightBe<VALUE> ) {\n\t\tif( this._textValue !== text ) {\n\t\t\tthis._textValue = text;\n\t\t\tthis.updateTextValue();\n\t\t}\n\t}\n\n\tget text(): DStateAwareOrValueMightBe<VALUE> {\n\t\treturn this._textValue;\n\t}\n\n\tprotected onTextChange() {\n\t\t// DO NOTHING\n\t}\n\n\tprotected computeTextValue(): VALUE | undefined {\n\t\tconst textValue = this._textValue;\n\t\tif( textValue !== undefined ) {\n\t\t\tif( isFunction( textValue ) ) {\n\t\t\t\tconst result = textValue( this.state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn textValue;\n\t\t\t}\n\t\t}\n\t\treturn this.theme.getTextValue( this.state );\n\t}\n\n\tprotected createOrUpdateText(): void {\n\t\tconst textValueComputed = this._textValueComputed;\n\t\tif( textValueComputed !== undefined ) {\n\t\t\tconst formatted = this._textFormatter( textValueComputed, this );\n\t\t\tconst text = this._text;\n\t\t\tif( text == null ) {\n\t\t\t\tif( 0 < formatted.length ) {\n\t\t\t\t\tconst newText = this.createText( formatted );\n\t\t\t\t\tthis._text = newText;\n\t\t\t\t\tthis.addChild( newText );\n\t\t\t\t\tthis.updateTextPosition( newText );\n\t\t\t\t\tconst overflowMask = this.getOverflowMask();\n\t\t\t\t\tif( overflowMask ) {\n\t\t\t\t\t\tnewText.mask = overflowMask;\n\t\t\t\t\t}\n\t\t\t\t\tthis.toDirty();\n\t\t\t\t\tDApplications.update( this );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttext.text = formatted;\n\t\t\t\tthis.toDirty();\n\t\t\t\tDApplications.update( this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected createText( formatted: string ): Text | DDynamicText {\n\t\tif( this._textDynamic ) {\n\t\t\treturn new DDynamicText( formatted, this._textStyle );\n\t\t} else {\n\t\t\tconst result = new Text( formatted, this._textStyle );\n\t\t\tresult.texture.baseTexture.scaleMode = SCALE_MODES.NEAREST;\n\t\t\tresult.resolution = DApplications.getResolution( this );\n\t\t\treturn result;\n\t\t}\n\t}\n\n\tgetOverflowMask(): Graphics | null {\n\t\tif( this._isOverflowMaskEnabled ) {\n\t\t\tif( this._overflowMask == null ) {\n\t\t\t\tthis._overflowMask = new DBaseOverflowMaskSimple( this );\n\t\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\t\tthis.toDirty();\n\t\t\t}\n\t\t\treturn this._overflowMask;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected updateTextPosition( text: DDynamicText | Text ): void {\n\t\tconst align = this._textAlign;\n\t\tconst padding = this._padding;\n\t\tconst toRounded = this.toRounded;\n\n\t\tswitch( align.horizontal ) {\n\t\tcase DAlignHorizontal.LEFT:\n\t\t\ttext.x = toRounded( padding.getLeft() );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.CENTER:\n\t\t\ttext.x = toRounded( ( this.width - text.width ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignHorizontal.RIGHT:\n\t\t\ttext.x = toRounded( this.width - text.width - padding.getRight() );\n\t\t\tbreak;\n\t\t}\n\n\t\tswitch( align.vertical ) {\n\t\tcase DAlignVertical.TOP:\n\t\t\ttext.y = toRounded( padding.getTop() );\n\t\t\tbreak;\n\t\tcase DAlignVertical.MIDDLE:\n\t\t\ttext.y = toRounded( ( this.height - text.height ) * 0.5 );\n\t\t\tbreak;\n\t\tcase DAlignVertical.BOTTOM:\n\t\t\ttext.y = toRounded( this.height - text.height - padding.getBottom() );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected toRounded( this: unknown, value: number ): number {\n\t\treturn Math.round( value );\n\t}\n\n\tprotected getTextColor( theme: THEME, state: DBaseStateSet ): number {\n\t\tconst color = this._textColor;\n\t\tif( color !== undefined ) {\n\t\t\tif( isFunction( color ) ) {\n\t\t\t\tconst result = color( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn color;\n\t\t\t}\n\t\t}\n\t\treturn theme.getColor( state );\n\t}\n\n\tprotected getTextAlpha( theme: THEME, state: DBaseStateSet ): number {\n\t\tconst alpha = this._textAlpha;\n\t\tif( alpha !== undefined ) {\n\t\t\tif( isFunction( alpha ) ) {\n\t\t\t\tconst result = alpha( state );\n\t\t\t\tif( result !== undefined ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn alpha;\n\t\t\t}\n\t\t}\n\t\treturn theme.getAlpha( state );\n\t}\n\n\tprotected updateTextColor( text: DDynamicText | Text ): void {\n\t\tconst theme = this.theme;\n\t\tconst state = this.state;\n\t\ttext.style.fill = this.getTextColor( theme, state );\n\t\ttext.alpha = this.getTextAlpha( theme, state );\n\t}\n\n\tprotected updateTextValue(): void {\n\t\tconst newTextValueComputed = this.computeTextValue();\n\t\tif( this._textValueComputed !== newTextValueComputed ) {\n\t\t\tthis._textValueComputed = newTextValueComputed;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\tthis.updateTextValue();\n\t\t\tthis.updateTextPosition( text );\n\t\t\tthis.updateTextColor( text );\n\t\t}\n\t}\n\n\tprotected onReflow(): void {\n\t\tsuper.onReflow();\n\t\tthis.updateText();\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\treturn super.isRefitable( target ) ||\n\t\t\t(target != null && target === this._text);\n\t}\n\n\tprotected applyTitle(): void {\n\t\tconst text = this._text;\n\t\tif( this._title.length <= 0 && text && (\"clipped\" in text) && text.clipped ) {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tlayer.view.title = text.text;\n\t\t\t}\n\t\t} else {\n\t\t\tsuper.applyTitle();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTextBase\";\n\t}\n\n\tdestroy(): void {\n\t\t// Text\n\t\tconst text = this._text;\n\t\tif( text != null ) {\n\t\t\tthis._text = null;\n\t\t\ttext.destroy();\n\t\t}\n\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Texture } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DAlignVertical } from \"./d-align-vertical\";\nimport { DAlignWith } from \"./d-align-with\";\nimport { DApplications } from \"./d-applications\";\nimport { DRefitable } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DImageBaseThemeWrapperSecondary, DThemeImageBaseSecondary } from \"./d-image-base-theme-wrapper-secondary\";\nimport { DImageBaseThemeWrapperTertiary, DThemeImageBaseTertiary } from \"./d-image-base-theme-wrapper-tertiary\";\nimport { DImagePiece, DImagePieceOptions, DThemeImagePiece } from \"./d-image-piece\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { DTextBase, DTextBaseEvents, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\n\n/**\n * {@link DImageBase} events.\n */\nexport interface DImageBaseEvents<VALUE, EMITTER> extends DTextBaseEvents<VALUE, EMITTER> {\n\n}\n\n/**\n * {@link DImageBase} \"on\" options.\n */\nexport interface DImageBaseOnOptions<VALUE, EMITTER> extends Partial<DImageBaseEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DImageBase} options.\n */\nexport interface DImageBaseOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeImageBase<VALUE> = DThemeImageBase<VALUE>,\n\tEMITTER = any\n> extends DTextBaseOptions<VALUE, THEME, EMITTER> {\n\timage?: DImagePieceOptions;\n\ton?: DImageBaseOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DImageBase} theme.\n */\nexport interface DThemeImageBase<VALUE = unknown> extends DThemeTextBase<VALUE>, DThemeImagePiece {\n\tgetSecondaryImageAlignHorizontal(): DAlignHorizontal;\n\tgetSecondaryImageAlignVertical(): DAlignVertical;\n\tgetSecondaryImageAlignWith(): DAlignWith;\n\tgetSecondaryImageMarginHorizontal(): number;\n\tgetSecondaryImageMarginVertial(): number;\n\tgetSecondaryImageTintColor( state: DBaseStateSet ): number | null;\n\tgetSecondaryImageTintAlpha( state: DBaseStateSet ): number;\n\tgetSecondaryImageSource?( state: DBaseStateSet ): Texture | DisplayObject | null;\n\n\tgetTertiaryImageAlignHorizontal(): DAlignHorizontal;\n\tgetTertiaryImageAlignVertical(): DAlignVertical;\n\tgetTertiaryImageAlignWith(): DAlignWith;\n\tgetTertiaryImageMarginHorizontal(): number;\n\tgetTertiaryImageMarginVertial(): number;\n\tgetTertiaryImageTintColor( state: DBaseStateSet ): number | null;\n\tgetTertiaryImageTintAlpha( state: DBaseStateSet ): number;\n\tgetTertiaryImageSource?( state: DBaseStateSet ): Texture | DisplayObject | null;\n}\n\nconst hasSecondaryImageSource = <VALUE>( theme: DThemeImageBase<VALUE> ): theme is DThemeImageBase<VALUE> & DThemeImageBaseSecondary => {\n\treturn !! theme.getSecondaryImageSource;\n};\n\nconst hasTertiaryImageSource = <VALUE>( theme: DThemeImageBase<VALUE> ): theme is DThemeImageBase<VALUE> & DThemeImageBaseTertiary => {\n\treturn !! theme.getTertiaryImageSource;\n};\n\n/**\n * A base class for UI classes with an image support.\n * See {@link DImageBaseEvents} for event details.\n */\nexport class DImageBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeImageBase<VALUE> = DThemeImageBase<VALUE>,\n\tOPTIONS extends DImageBaseOptions<VALUE, THEME> = DImageBaseOptions<VALUE, THEME>\n> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected _images!: DImagePiece[];\n\n\tprotected init( options?: OPTIONS ) {\n\t\tthis._images = this.newImages( this.theme, options );\n\t\tsuper.init( options );\n\t}\n\n\tprotected newImages( theme: THEME, options?: OPTIONS ): DImagePiece[] {\n\t\tconst images: DImagePiece[] = [];\n\t\timages.push( this.newImage( theme, this.toImageOptions( theme, options?.image ) ) );\n\t\tif( hasSecondaryImageSource( theme ) ) {\n\t\t\timages.push( this.newImage( new DImageBaseThemeWrapperSecondary( theme ) ) );\n\t\t}\n\t\tif( hasTertiaryImageSource( theme ) ) {\n\t\t\timages.push( this.newImage( new DImageBaseThemeWrapperTertiary( theme ) ) );\n\t\t}\n\t\treturn images;\n\t}\n\n\tprotected toImageOptions( theme: THEME, options?: DImagePieceOptions ): DImagePieceOptions | undefined {\n\t\treturn options;\n\t}\n\n\tprotected newImage( theme: DThemeImagePiece, options?: DImagePieceOptions ) {\n\t\treturn new DImagePiece( this, theme, this._textAlign, options );\n\t}\n\n\tget image(): DStateAwareOrValueMightBe<Texture | DisplayObject | null> {\n\t\treturn this._images[ 0 ].source;\n\t}\n\n\tset image( imageSource: DStateAwareOrValueMightBe<Texture | DisplayObject | null> ) {\n\t\tthis._images[ 0 ].source = imageSource;\n\t}\n\n\tprotected onStateChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tconst images = this._images;\n\t\tfor( let i = 0, imax = images.length; i < imax; ++i ) {\n\t\t\timages[ i ].onStateChange( newState, oldState );\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tthis.updateTextValue();\n\t\tthis.updateTextAndImage();\n\t}\n\n\tprotected updateTextAndImage(): void {\n\t\tconst text = this._text;\n\t\tconst images = this._images;\n\t\tconst padding = this._padding;\n\n\t\tconst toRounded = this.toRounded;\n\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\n\t\tconst pl = padding.getLeft();\n\t\tconst pr = padding.getRight();\n\t\tconst pt = padding.getTop();\n\t\tconst pb = padding.getBottom();\n\n\t\tconst noText = text == null;\n\n\t\tlet textLeftFirst = noText;\n\t\tlet textTopFirst = noText;\n\n\t\tlet textRightLastMargin = 0;\n\t\tlet textBottomLastMargin = 0;\n\n\t\tlet textLeft = 0;\n\t\tlet textRight = 0;\n\t\tlet textTop = 0;\n\t\tlet textBottom = 0;\n\n\t\tlet paddingLeft = pl;\n\t\tlet paddingRight = width - pr;\n\t\tlet paddingTop = pt;\n\t\tlet paddingBottom = height - pb;\n\n\t\tlet borderLeft = 0;\n\t\tlet borderRight = width;\n\t\tlet borderTop = 0;\n\t\tlet borderBottom = height;\n\n\t\tfor( let i = 0, imax = images.length; i < imax; ++i ) {\n\t\t\tconst image = images[ i ];\n\t\t\timage.updateSource();\n\t\t\timage.updateTint();\n\t\t\timage.updateBound();\n\n\t\t\tconst imageImage = image.image;\n\t\t\tif( imageImage ) {\n\t\t\t\tconst imageBound = image.bound;\n\t\t\t\tconst imageBoundWidth = imageBound.width;\n\t\t\t\tconst imageBoundHeight = imageBound.height;\n\t\t\t\tconst imageMargin = image.margin;\n\t\t\t\tconst imageMarginHorizontal = imageMargin.horizontal;\n\t\t\t\tconst imageMarginVertical = imageMargin.vertical;\n\n\t\t\t\t// Text\n\t\t\t\tif( image.align.with === DAlignWith.TEXT ) {\n\t\t\t\t\tswitch( image.align.horizontal ) {\n\t\t\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\t\t\timageImage.x = textLeft;\n\t\t\t\t\t\ttextLeft += imageBoundWidth;\n\t\t\t\t\t\tif( textLeftFirst ) {\n\t\t\t\t\t\t\ttextLeftFirst = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttextLeft += imageMarginHorizontal;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\t\t\t// DO NOTHING\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\t\t\ttextRight -= imageBoundWidth;\n\t\t\t\t\t\timageImage.x = textRight;\n\t\t\t\t\t\ttextRight -= imageMarginHorizontal;\n\t\t\t\t\t\ttextRightLastMargin = imageMarginHorizontal;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tswitch( image.align.vertical ) {\n\t\t\t\t\tcase DAlignVertical.TOP:\n\t\t\t\t\t\timageImage.y = textTop;\n\t\t\t\t\t\ttextTop += imageBoundHeight;\n\t\t\t\t\t\tif( textTopFirst ) {\n\t\t\t\t\t\t\ttextTopFirst = false;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttextTop += imageMarginVertical;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\t\t\t// DO NOTHING\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\t\t\ttextBottom -= imageBoundHeight;\n\t\t\t\t\t\timageImage.y = textBottom;\n\t\t\t\t\t\ttextBottom -= imageMarginVertical;\n\t\t\t\t\t\ttextBottomLastMargin = imageMarginVertical;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Padding\n\t\t\t\tif( image.align.with === DAlignWith.PADDING ) {\n\t\t\t\t\tswitch( image.align.horizontal ) {\n\t\t\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\t\t\tpaddingLeft += imageMarginHorizontal;\n\t\t\t\t\t\timageImage.x = toRounded( paddingLeft );\n\t\t\t\t\t\tpaddingLeft += imageBoundWidth;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\t\t\t// DO NOTHING\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\t\t\tpaddingRight -= imageBoundWidth + imageMarginHorizontal;\n\t\t\t\t\t\timageImage.x = toRounded( paddingRight );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tswitch( image.align.vertical ) {\n\t\t\t\t\tcase DAlignVertical.TOP:\n\t\t\t\t\t\tpaddingTop += imageMarginVertical;\n\t\t\t\t\t\timageImage.y = toRounded( paddingTop );\n\t\t\t\t\t\tpaddingTop += imageBoundHeight;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\t\t\t// DO NOTHING\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\t\t\tpaddingBottom -= imageBoundHeight + imageMarginVertical;\n\t\t\t\t\t\timageImage.y = toRounded( paddingBottom );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Border\n\t\t\t\tif( image.align.with === DAlignWith.BORDER ) {\n\t\t\t\t\tswitch( image.align.horizontal ) {\n\t\t\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\t\t\tborderLeft += imageMarginHorizontal;\n\t\t\t\t\t\timageImage.x = toRounded( borderLeft );\n\t\t\t\t\t\tborderLeft += imageBoundWidth;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\t\t\t// DO NOTHING\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\t\t\tborderRight -= imageBoundWidth + imageMarginHorizontal;\n\t\t\t\t\t\timageImage.x = toRounded( borderRight );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tswitch( image.align.vertical ) {\n\t\t\t\t\tcase DAlignVertical.TOP:\n\t\t\t\t\t\tborderTop += imageMarginVertical;\n\t\t\t\t\t\timageImage.y = toRounded( borderTop );\n\t\t\t\t\t\tborderTop += imageBoundHeight;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\t\t\t// DO NOTHING\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\t\t\tborderBottom -= imageBoundHeight + imageMarginVertical;\n\t\t\t\t\t\timageImage.y = toRounded( borderBottom );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( noText ) {\n\t\t\ttextRight += textRightLastMargin;\n\t\t\ttextBottom += textBottomLastMargin;\n\t\t}\n\n\t\t// Text\n\t\tlet textLeftAdjust = 0;\n\t\tlet textCenterAdjust = 0;\n\t\tlet textRightAdjust = 0;\n\t\tlet textTopAdjust = 0;\n\t\tlet textMiddleAdjust = 0;\n\t\tlet textBottomAdjust = 0;\n\n\t\tif( text != null ) {\n\t\t\tthis.updateTextColor( text );\n\t\t\tif( text instanceof DDynamicText ) {\n\t\t\t\ttext.setClippingWidthDelta( textLeft - textRight );\n\t\t\t}\n\n\t\t\tconst textAlign = this._textAlign;\n\t\t\tconst textWidth = text.width;\n\t\t\tconst textHeight = text.height;\n\t\t\tswitch( textAlign.horizontal ) {\n\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\ttextLeftAdjust = pl;\n\t\t\t\ttextRightAdjust = textLeftAdjust + textLeft + textWidth - textRight;\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\ttextLeftAdjust = (width - textLeft + textRight - textWidth) * 0.5;\n\t\t\t\ttextRightAdjust = textLeftAdjust + textLeft + textWidth - textRight;\n\t\t\t\tbreak;\n\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\ttextRightAdjust = width - pr;\n\t\t\t\ttextLeftAdjust = textRightAdjust + textRight - textWidth - textLeft;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\ttext.x = toRounded( textLeftAdjust + textLeft );\n\t\t\ttextCenterAdjust = textLeftAdjust + textLeft + textWidth * 0.5;\n\n\t\t\tswitch( textAlign.vertical ) {\n\t\t\tcase DAlignVertical.TOP:\n\t\t\t\ttextTopAdjust = pt;\n\t\t\t\ttextBottomAdjust = textTopAdjust + textTop + textHeight - textBottom;\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\ttextTopAdjust = (height - textTop + textBottom - textHeight) * 0.5;\n\t\t\t\ttextBottomAdjust = textTopAdjust + textTop + textHeight - textBottom;\n\t\t\t\tbreak;\n\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\ttextBottomAdjust = height - pb;\n\t\t\t\ttextTopAdjust = textBottomAdjust + textBottom - textHeight - textTop;\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\ttext.y = toRounded( textTopAdjust + textTop );\n\t\t\ttextMiddleAdjust = textTopAdjust + textTop + textHeight * 0.5;\n\t\t} else {\n\t\t\ttextLeftAdjust = (width - textLeft + textRight) * 0.5;\n\t\t\ttextRightAdjust = textLeftAdjust + textLeft - textRight;\n\t\t\ttextCenterAdjust = textLeftAdjust + textLeft;\n\n\t\t\ttextTopAdjust = (height - textTop + textBottom) * 0.5;\n\t\t\ttextBottomAdjust = textTopAdjust + textTop - textBottom;\n\t\t\ttextMiddleAdjust = textTopAdjust + textTop;\n\t\t}\n\n\t\tconst paddingCenterAdjust = width * 0.5;\n\t\tconst paddingMiddleAdjust = height * 0.5;\n\n\t\tconst borderCenterAdjust = width * 0.5;\n\t\tconst borderMiddleAdjust = height * 0.5;\n\n\t\tfor( let i = 0, imax = images.length; i < imax; ++i ) {\n\t\t\tconst image = images[ i ];\n\t\t\tconst imageImage = image.image;\n\t\t\tif( imageImage ) {\n\t\t\t\tconst imageBound = image.bound;\n\t\t\t\tconst imageBoundWidth = imageBound.width;\n\t\t\t\tconst imageBoundHeight = imageBound.height;\n\n\t\t\t\t// Text\n\t\t\t\tif( image.align.with === DAlignWith.TEXT ) {\n\t\t\t\t\tswitch( image.align.horizontal ) {\n\t\t\t\t\tcase DAlignHorizontal.LEFT:\n\t\t\t\t\t\timageImage.x = toRounded( imageImage.x + textLeftAdjust );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\t\t\timageImage.x = toRounded( textCenterAdjust - imageBoundWidth * 0.5 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignHorizontal.RIGHT:\n\t\t\t\t\t\timageImage.x = toRounded( imageImage.x + textRightAdjust );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tswitch( image.align.vertical ) {\n\t\t\t\t\tcase DAlignVertical.TOP:\n\t\t\t\t\t\timageImage.y = toRounded( imageImage.y + textTopAdjust );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\t\t\timageImage.y = toRounded( textMiddleAdjust - imageBoundHeight * 0.5 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase DAlignVertical.BOTTOM:\n\t\t\t\t\t\timageImage.y = toRounded( imageImage.y + textBottomAdjust );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Padding\n\t\t\t\tif( image.align.with === DAlignWith.PADDING ) {\n\t\t\t\t\tswitch( image.align.horizontal ) {\n\t\t\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\t\t\timageImage.x = toRounded( paddingCenterAdjust - imageBoundWidth * 0.5 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tswitch( image.align.vertical ) {\n\t\t\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\t\t\timageImage.y = toRounded( paddingMiddleAdjust - imageBoundHeight * 0.5 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Border\n\t\t\t\tif( image.align.with === DAlignWith.BORDER ) {\n\t\t\t\t\tswitch( image.align.horizontal ) {\n\t\t\t\t\tcase DAlignHorizontal.CENTER:\n\t\t\t\t\t\timageImage.x = toRounded( borderCenterAdjust - imageBoundWidth * 0.5 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tswitch( image.align.vertical ) {\n\t\t\t\t\tcase DAlignVertical.MIDDLE:\n\t\t\t\t\t\timageImage.y = toRounded( borderMiddleAdjust - imageBoundHeight * 0.5 );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected isRefitable( target: any ): target is DRefitable {\n\t\tif( super.isRefitable( target ) ) {\n\t\t\treturn true;\n\t\t}\n\n\t\tconst images = this._images;\n\t\tfor( let i = 0, imax = images.length; i < imax; ++i ) {\n\t\t\tif( images[ i ].isRefitable( target ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DImageBase\";\n\t}\n\n\tdestroy(): void {\n\t\tconst images = this._images;\n\t\tfor( let i = 0, imax = images.length; i < imax; ++i ) {\n\t\t\timages[ i ].destroy();\n\t\t}\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DButtonBaseWhen } from \"./d-button-base-when\";\nimport { DButtonGroup } from \"./d-button-group\";\nimport { DImageBase, DImageBaseEvents, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { toEnum } from \"./util/to-enum\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\n/**\n * {@link DButtonBase} events.\n */\nexport interface DButtonBaseEvents<VALUE, EMITTER> extends DImageBaseEvents<VALUE, EMITTER> {\n\t/**\n\t * Triggered when the button is activated.\n\t *\n\t * @param emitter an emitter\n\t */\n\tactive( emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when the button is inactivated.\n\t *\n\t * @param emitter an emitter\n\t */\n\tinactive( emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonBase} \"on\" options.\n */\nexport interface DButtonBaseOnOptions<VALUE, EMITTER> extends Partial<DButtonBaseEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButtonBase} options.\n */\nexport interface DButtonBaseOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonBase<VALUE> = DThemeButtonBase<VALUE>,\n\tEMITTER = any\n> extends DImageBaseOptions<VALUE, THEME, EMITTER> {\n\t/**\n\t * True to turn a toggle mode on.\n\t */\n\ttoggle?: boolean;\n\n\t/**\n\t * A button group.\n\t */\n\tgroup?: DButtonGroup;\n\n\t/**\n\t * An option when to activate a button.\n\t */\n\twhen?: DButtonBaseWhen | (keyof typeof DButtonBaseWhen);\n\n\t/**\n\t * Mappings of event names and handlers.\n\t */\n\ton?: DButtonBaseOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DButtonBase} theme.\n */\nexport interface DThemeButtonBase<VALUE = unknown> extends DThemeImageBase<VALUE> {\n\t/**\n\t * Returns true to turn a toggle mode on.\n\t */\n\tisToggle(): boolean;\n\n\t/**\n\t * Returns when to activate a button.\n\t */\n\tgetWhen(): DButtonBaseWhen;\n}\n\n/**\n * A base class for button classes.\n * See {@link DButtonBaseEvents} for event details.\n */\nexport class DButtonBase<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonBase<VALUE> = DThemeButtonBase<VALUE>,\n\tOPTIONS extends DButtonBaseOptions<VALUE, THEME> = DButtonBaseOptions<VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected _isToggle!: boolean;\n\tprotected _when!: DButtonBaseWhen;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst theme = this.theme;\n\t\tthis._isToggle = ( options?.toggle ?? theme.isToggle() );\n\t\tconst when = toEnum( options?.when ?? theme.getWhen(), DButtonBaseWhen );\n\t\tthis._when = when;\n\n\t\t// Event handlers\n\t\tthis.initOnClick( when, theme, options );\n\t\tthis.initOnPress( when, theme, options );\n\n\t\t// Group\n\t\tconst group = options?.group;\n\t\tif( group ) {\n\t\t\tgroup.add( this );\n\t\t}\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ): void {\n\t\tsuper.onShortcut( e );\n\t\tthis.onClick( e );\n\t}\n\n\tisToggle(): boolean {\n\t\treturn this._isToggle;\n\t}\n\n\tprotected initOnClick( when: DButtonBaseWhen, theme: THEME, options?: OPTIONS ): void {\n\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( when === DButtonBaseWhen.CLICKED ) {\n\t\t\t\tthis.onClick( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected initOnPress( when: DButtonBaseWhen, theme: THEME, options?: OPTIONS ): void {\n\t\tlet interactionManager: interaction.InteractionManager | null = null;\n\n\t\tconst onUp = (): void => {\n\t\t\tthis.state.isPressed = false;\n\t\t\tif( interactionManager != null ) {\n\t\t\t\tinteractionManager.off( UtilPointerEvent.up, onUp );\n\t\t\t\tinteractionManager = null;\n\t\t\t}\n\t\t};\n\n\t\tthis.on( UtilPointerEvent.down, (): void => {\n\t\t\tthis.state.isPressed = true;\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tinteractionManager = layer.renderer.plugins.interaction;\n\t\t\t\tinteractionManager.on( UtilPointerEvent.up, onUp );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButton\";\n\t}\n\n\tonClick( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleStart( e );\n\t\t\t\tthis.onToggleEnd( e );\n\t\t\t} else {\n\t\t\t\tthis.onActivate( e );\n\t\t\t}\n\t\t}\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tif( this._when === DButtonBaseWhen.DOUBLE_CLICKED ) {\n\t\t\tthis.onClick( e );\n\t\t}\n\t\treturn super.onDblClick( e, interactionManager );\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tthis.emit( \"active\", this );\n\t}\n\n\tprotected onInactivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tthis.emit( \"inactive\", this );\n\t}\n\n\ttoggle(): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t\tthis.onToggleEnd();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onToggleStart( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tthis.state.isActive = ! this.state.isActive;\n\t}\n\n\tprotected onToggleEnd( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tif( this.state.isActive ) {\n\t\t\tthis.onActivate( e );\n\t\t} else {\n\t\t\tthis.onInactivate( e );\n\t\t}\n\t}\n\n\tprotected onActivateKeyDown( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleStart( e );\n\t\t\t} else {\n\t\t\t\tthis.state.isPressed = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onActivateKeyUp( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isToggle() ) {\n\t\t\t\tthis.onToggleEnd( e );\n\t\t\t} else {\n\t\t\t\tif( this.state.isPressed ) {\n\t\t\t\t\tthis.onActivate( e );\n\t\t\t\t}\n\t\t\t\tthis.state.isPressed = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyDown( e );\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyUp( e );\n\t\t}\n\n\t\treturn super.onKeyUp( e );\n\t}\n\n\tdestroy(): void {\n\t\tthis._options?.group?.remove( this );\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseEvents, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\n/**\n * {@link DButton} events.\n */\nexport interface DButtonEvents<VALUE, EMITTER> extends DButtonBaseEvents<VALUE, EMITTER> {\n\n}\n\n/**\n * {@link DButton} \"on\" options.\n */\nexport interface DButtonOnOptions<VALUE, EMITTER> extends Partial<DButtonEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButton} options.\n */\nexport interface DButtonOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton<VALUE> = DThemeButton<VALUE>,\n\tEMITTER = any\n> extends DButtonBaseOptions<VALUE, THEME, EMITTER> {\n\ton?: DButtonOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DButton} theme.\n */\nexport interface DThemeButton<VALUE = unknown> extends DThemeButtonBase<VALUE> {\n\n}\n\n/**\n * A button class.\n */\nexport class DButton<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton<VALUE> = DThemeButton<VALUE>,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButton\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonPrimary extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonPrimary\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAnimationOptions } from \"./d-animation\";\nimport { DAnimationBase } from \"./d-animation-base\";\nimport { DApplicationLayerLike } from \"./d-application-layer-like\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\n\nexport interface DAnimationFadeInShiftOptions {\n\tx?: number | null;\n\ty?: number | null;\n}\n\nexport interface DAnimationFadeInOptions<TARGET> extends DAnimationOptions<TARGET> {\n\tshift?: DAnimationFadeInShiftOptions;\n}\n\nexport class DAnimationFadeIn<TARGET extends DBase = DBase> extends DAnimationBase<TARGET> {\n\tprotected _shiftX: number;\n\tprotected _shiftY: number;\n\n\tprotected _storedX: number = 0;\n\tprotected _storedY: number = 0;\n\tprotected _storedAlpha: number = 0;\n\tprotected _storedTime: number = 0;\n\tprotected _storedTarget: TARGET | null = null;\n\n\tprotected _layer: DApplicationLayerLike | null = null;\n\n\tprotected _onPrerenderBound: () => void;\n\tprotected _onPostrenderBound: () => void;\n\n\tconstructor( options?: DAnimationFadeInOptions<TARGET> ) {\n\t\tsuper( options );\n\n\t\t// Shifts\n\t\tconst shift = options?.shift;\n\t\tthis._shiftX = (shift?.x ?? 0);\n\t\tthis._shiftY = (shift?.y ?? 15);\n\n\t\tthis._onPrerenderBound = () => {\n\t\t\tthis.onPrerender();\n\t\t};\n\n\t\tthis._onPostrenderBound = () => {\n\t\t\tthis.onPostrender();\n\t\t};\n\t}\n\n\tstop(): void {\n\t\tthis._storedTime = 0;\n\t\tthis.removeEventListeners();\n\t\tsuper.stop();\n\t}\n\n\tprotected addEventListeners( target: TARGET ): void {\n\t\tconst layer = DApplications.getLayer( target );\n\t\tif( layer ) {\n\t\t\tthis._layer = layer;\n\t\t\tconst renderer = layer.renderer;\n\t\t\trenderer.on( \"prerender\", this._onPrerenderBound );\n\t\t\trenderer.on( \"postrender\", this._onPostrenderBound );\n\t\t}\n\t}\n\n\tprotected removeEventListeners(): void {\n\t\tconst layer = this._layer;\n\t\tif( layer ) {\n\t\t\tthis._layer = null;\n\t\t\tconst renderer = layer.renderer;\n\t\t\trenderer.off( \"prerender\", this._onPrerenderBound );\n\t\t\trenderer.off( \"postrender\", this._onPostrenderBound );\n\t\t}\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst target = this._storedTarget = this._target;\n\t\tif( target != null ) {\n\t\t\tthis._storedTime = 0;\n\t\t\tthis.removeEventListeners();\n\t\t\tthis.addEventListeners( target );\n\t\t\tif( ! isReverse ) {\n\t\t\t\ttarget.visible = true;\n\t\t\t}\n\t\t\tsuper.onStart( isReverse );\n\t\t}\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tconst layer = this._layer;\n\t\t\tif( layer ) {\n\t\t\t\tthis._storedTime = time;\n\t\t\t\tsuper.onTime( time, isReverse, elapsedTime );\n\t\t\t\tlayer.update();\n\t\t\t} else {\n\t\t\t\tthis._storedTime = time;\n\t\t\t\tsuper.onTime( time, isReverse, elapsedTime );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tthis.removeEventListeners();\n\t\t\tif( isReverse ) {\n\t\t\t\ttarget.visible = false;\n\t\t\t}\n\t\t\tsuper.onEnd( isReverse );\n\t\t}\n\t}\n\n\tprotected onPrerender(): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\tconst storedTime = this._storedTime;\n\n\t\t\t// Position\n\t\t\tconst position = target.unsafe.position;\n\t\t\tthis._storedX = position.x;\n\t\t\tthis._storedY = position.y;\n\t\t\tposition.set(\n\t\t\t\tposition.x - this._shiftX * ( 1 - storedTime ),\n\t\t\t\tposition.y - this._shiftY * ( 1 - storedTime )\n\t\t\t);\n\n\t\t\t// Alpha\n\t\t\tthis._storedAlpha = target.alpha;\n\t\t\ttarget.alpha = storedTime;\n\t\t}\n\t}\n\n\tprotected onPostrender(): void {\n\t\tconst target = this._storedTarget;\n\t\tif( target != null ) {\n\t\t\t// Position\n\t\t\tconst position = target.unsafe.position;\n\t\t\tposition.set(\n\t\t\t\tthis._storedX,\n\t\t\t\tthis._storedY\n\t\t\t);\n\n\t\t\t// Alpha\n\t\t\ttarget.alpha = this._storedAlpha;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DDialogCloseOn {\n\tNONE = 0,\n\tESC = 1,\n\tCLICK_OUTSIDE = 2\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * {@link DDialog} mode options.\n */\nexport enum DDialogMode {\n\tMODAL,\n\tMODELESS,\n\tMENU\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const DDialogState = {\n\tMODAL: \"MODAL\",\n\tMODELESS: \"MODELESS\",\n\tMENU: \"MENU\"\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DLayoutDirection {\n\tVERTICAL,\n\tHORIZONTAL\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase } from \"../d-base\";\nimport { UtilPointerEvent } from \"./util-pointer-event\";\n\nexport type UtilClickOutsideOnClick = ( e: InteractionEvent ) => void;\n\nexport class UtilClickOutside {\n\tprotected static point = new Point();\n\n\tstatic apply( target: DBase<any, any>, onClick: UtilClickOutsideOnClick ) {\n\t\ttarget.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( e.target === target ) {\n\t\t\t\tconst point = this.point;\n\t\t\t\tpoint.copyFrom( e.data.global );\n\t\t\t\ttarget.toLocal( point, undefined, point, true );\n\t\t\t\tconst x = point.x;\n\t\t\t\tconst y = point.y;\n\t\t\t\tif( x < 0 || y < 0 || target.width < x || target.height < y ) {\n\t\t\t\t\tonClick( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n}\n","import { DApplicationLayerLike } from \"../d-application-layer-like\";\nimport { DApplicationLike, DApplicationTarget } from \"../d-application-like\";\nimport { DApplications } from \"../d-applications\";\n\nexport class UtilOverlay {\n\tprotected _layer: DApplicationLayerLike | null;\n\tprotected _application: DApplicationLike | null;\n\n\tconstructor( options?: { parent?: unknown; } ) {\n\t\tthis._layer = null;\n\t\tthis._application = ( options?.parent == null ?\n\t\t\tDApplications.last() : null\n\t\t);\n\t}\n\n\tget picked(): DApplicationLayerLike | null {\n\t\treturn this._layer;\n\t}\n\n\tpick( target: DApplicationTarget ): DApplicationLayerLike {\n\t\tlet layer = this._layer;\n\t\tif( layer == null ) {\n\t\t\tlayer = DApplications.getLayerOverlay( target );\n\t\t\tif( ! layer ) {\n\t\t\t\tconst application = this._application;\n\t\t\t\tif( application ) {\n\t\t\t\t\tlayer = application.getLayerOverlay();\n\t\t\t\t} else {\n\t\t\t\t\tlayer = DApplications.last().getLayerOverlay();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._layer = layer;\n\t\t}\n\t\treturn layer;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DAnimation } from \"./d-animation\";\nimport { DAnimationFadeIn } from \"./d-animation-fade-in\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseEvents, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DFocusable } from \"./d-controller-focus\";\nimport { DDialogAlign } from \"./d-dialog-align\";\nimport { DDialogCloseOn } from \"./d-dialog-close-on\";\nimport { DDialogMode } from \"./d-dialog-mode\";\nimport { DDialogState } from \"./d-dialog-state\";\nimport { toEnum } from \"./util/to-enum\";\nimport { UtilAttach } from \"./util/util-attach\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilOverlay } from \"./util/util-overlay\";\n\n/**\n * {@link DDialog} events.\n */\nexport interface DDialogEvents<EMITTER> extends DBaseEvents<EMITTER> {\n\t/**\n\t * Triggered when a dialog is opened.\n\t *\n\t * @param emitter this\n\t */\n\topen( emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a dialog is closed.\n\t *\n\t * @param emitter this\n\t */\n\tclose( emitter: EMITTER ): void;\n}\n\n/**\n * {@link DDialog} `on` options.\n */\nexport interface DDialogOnOptions<EMITTER> extends Partial<DDialogEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DDialog} options.\n */\nexport interface DDialogOptions<\n\tTHEME extends DThemeDialog = DThemeDialog,\n\tEMITTER = any\n> extends DBaseOptions<THEME> {\n\tcloseOn?: DDialogCloseOn;\n\tanimation?: DAnimation<DBase>;\n\n\t/**\n\t * A dialog mode.\n\t */\n\tmode?: DDialogMode | (keyof typeof DDialogMode);\n\n\tsticky?: boolean;\n\n\talign?: DDialogAlign;\n\n\t/**\n\t * Mappings of event names and handlers.\n\t */\n\ton?: DDialogOnOptions<EMITTER>;\n}\n\n/**\n * {@link DDialog} theme.\n */\nexport interface DThemeDialog extends DThemeBase {\n\tgetMode(): DDialogMode;\n\tcloseOn(): DDialogCloseOn;\n\tisSticky(): boolean;\n\tgetOffsetX(): number;\n\tgetOffsetY(): number;\n}\n\n/**\n * A dialog class.\n *\n * If multiple application instances are there, better to set the constructor\n * option `parent` to an `application.stage` so that the dialog picks a right\n * application. By default, the dialog assumes the last created application is\n * the one it belongs to at the time when it is created.\n */\nexport class DDialog<\n\tVALUE = void,\n\tTHEME extends DThemeDialog = DThemeDialog,\n\tOPTIONS extends DDialogOptions<THEME> = DDialogOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _promise?: Promise<VALUE>;\n\tprotected _resolve?: ( value: VALUE | PromiseLike<VALUE> ) => void;\n\tprotected _reject?: ( reason?: any ) => void;\n\n\tprotected _animation?: DAnimation<DBase> | null;\n\tprotected _closeOn!: DDialogCloseOn;\n\tprotected _focusable?: DFocusable | null;\n\tprotected _overlay!: UtilOverlay;\n\tprotected _mode!: DDialogMode;\n\tprotected _sticky!: boolean;\n\tprotected _onPrerenderBound!: () => void;\n\tprotected _align!: DDialogAlign;\n\tprotected _owner?: DBase<any, any> | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._onPrerenderBound = (): void => {\n\t\t\tthis.onPrerender();\n\t\t};\n\n\t\t// Modeless\n\t\tconst theme = this.theme;\n\t\tconst mode = toEnum( options?.mode ?? theme.getMode(), DDialogMode );\n\t\tthis._mode = mode;\n\n\t\t// Sticky\n\t\tthis._sticky = options?.sticky ?? theme.isSticky();\n\n\t\t// Close On\n\t\tconst closeOn = options?.closeOn ?? theme.closeOn();\n\t\tthis._closeOn = closeOn;\n\n\t\t// Align\n\t\tthis._align = toEnum( options?.align ?? DDialogAlign.BOTTOM, DDialogAlign );\n\n\t\t// Overlay\n\t\tthis._overlay = new UtilOverlay();\n\n\t\t// Others\n\t\tswitch( mode ) {\n\t\tcase DDialogMode.MODAL:\n\t\tcase DDialogMode.MENU:\n\t\t\tthis.visible = false;\n\t\t\tconst state = this.state;\n\t\t\tstate.lock();\n\t\t\tstate.isFocusRoot = true;\n\t\t\tstate.add( mode === DDialogMode.MODAL ? DDialogState.MODAL : DDialogState.MENU );\n\t\t\tstate.unlock();\n\t\t\tif( closeOn & DDialogCloseOn.CLICK_OUTSIDE ) {\n\t\t\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\t\t\tthis.onCloseOn();\n\t\t\t\t});\n\t\t\t}\n\t\t\tbreak;\n\t\tcase DDialogMode.MODELESS:\n\t\t\tthis.state.add( DDialogState.MODELESS );\n\t\t\tbreak;\n\t\t}\n\t}\n\n\tprotected getAnimation(): DAnimation | null {\n\t\tlet result = this._animation;\n\t\tif( result === undefined ) {\n\t\t\tswitch( this._mode ) {\n\t\t\tcase DDialogMode.MODAL:\n\t\t\t\tresult = this._options?.animation ?? new DAnimationFadeIn();\n\t\t\t\tbreak;\n\t\t\tcase DDialogMode.MODELESS:\n\t\t\t\tresult = null;\n\t\t\t\tbreak;\n\t\t\tcase DDialogMode.MENU:\n\t\t\t\tresult = this._options?.animation ?? null;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif( result ) {\n\t\t\t\tresult.target = this;\n\t\t\t\tresult.on( \"end\", ( isReverse: boolean ): void => {\n\t\t\t\t\tthis.onAnimationEnd( isReverse );\n\t\t\t\t});\n\t\t\t}\n\t\t\tthis._animation = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onAnimationEnd( isReverse: boolean ) {\n\t\tif( isReverse ) {\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent ) {\n\t\t\t\tparent.removeChild( this );\n\t\t\t}\n\t\t} else {\n\t\t\tconst layer = DApplications.getLayer( this );\n\t\t\tif( layer ) {\n\t\t\t\tconst focusController = layer.getFocusController();\n\t\t\t\tthis._focusable = focusController.get();\n\t\t\t\tconst firstFocusable = focusController.find( this, false, true, true );\n\t\t\t\tfocusController.focus( firstFocusable || this );\n\t\t\t}\n\t\t}\n\t}\n\n\topen( owner?: DBase<any, any> ): Promise<VALUE> {\n\t\tlet result = this._promise;\n\t\tif( result == null ) {\n\t\t\tresult = new Promise<VALUE>(( resolve, reject ): void => {\n\t\t\t\tthis._resolve = resolve;\n\t\t\t\tthis._reject = reject;\n\t\t\t});\n\t\t\tthis._promise = result;\n\n\t\t\tthis._owner = owner;\n\n\t\t\tswitch( this._mode ) {\n\t\t\tcase DDialogMode.MODAL: {\n\t\t\t\t\tconst layer = this._overlay.pick( this );\n\t\t\t\t\tlayer.stage.addChild( this );\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DDialogMode.MODELESS:\n\t\t\t\tbreak;\n\t\t\tcase DDialogMode.MENU: {\n\t\t\t\t\tconst layer = this._overlay.pick( this );\n\t\t\t\t\tlayer.stage.addChild( this );\n\n\t\t\t\t\t// Position & size\n\t\t\t\t\tconst renderer = layer.renderer;\n\t\t\t\t\tconst onPrerenderBound = this._onPrerenderBound;\n\t\t\t\t\tif( this._sticky ) {\n\t\t\t\t\t\trenderer.on( \"prerender\", onPrerenderBound );\n\t\t\t\t\t} else {\n\t\t\t\t\t\trenderer.once( \"prerender\", onPrerenderBound );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tthis.onOpen();\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onPrerender(): void {\n\t\tconst owner = this._owner;\n\t\tif( owner ) {\n\t\t\tconst bounds = owner.getBounds();\n\t\t\tif( bounds ) {\n\t\t\t\tconst layer = this._overlay.picked;\n\t\t\t\tif( layer ) {\n\t\t\t\t\tconst theme = this.theme;\n\t\t\t\t\tUtilAttach.attach(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tbounds,\n\t\t\t\t\t\ttheme.getOffsetX(), theme.getOffsetY(),\n\t\t\t\t\t\tlayer.width, layer.height,\n\t\t\t\t\t\tthis._align\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onOpen(): void {\n\t\tthis.emit( \"open\", this );\n\n\t\t// Animation\n\t\tconst animation = this.getAnimation();\n\t\tif( animation ) {\n\t\t\tanimation.start();\n\t\t} else if( this._mode === DDialogMode.MENU ) {\n\t\t\tthis.visible = true;\n\t\t\tthis.onAnimationEnd( false );\n\t\t}\n\t}\n\n\tisOpened(): boolean {\n\t\treturn this._promise != null;\n\t}\n\n\tclose() {\n\t\tthis.doReject();\n\t}\n\n\tprotected doResolve( value: VALUE | PromiseLike<VALUE>  ): void {\n\t\tconst resolve = this._resolve;\n\t\tif( resolve ) {\n\t\t\tthis._promise = undefined;\n\t\t\tthis._resolve = undefined;\n\t\t\tthis._reject = undefined;\n\n\t\t\tthis.onClose();\n\n\t\t\tresolve( value );\n\t\t}\n\t}\n\n\tprotected doReject( reason?: any ): void {\n\t\tconst reject = this._reject;\n\t\tif( reject ) {\n\t\t\tthis._promise = undefined;\n\t\t\tthis._resolve = undefined;\n\t\t\tthis._reject = undefined;\n\n\t\t\tthis.onClose();\n\n\t\t\treject( reason );\n\t\t}\n\t}\n\n\tprotected onClose(): void {\n\t\t// Focus\n\t\tconst layer = this._overlay.picked;\n\t\tconst focusable = this._focusable;\n\t\tif( focusable != null ) {\n\t\t\tthis._focusable = null;\n\t\t\tif( layer ) {\n\t\t\t\tlayer.getFocusController().focus( focusable );\n\t\t\t} else {\n\t\t\t\tthis.blur( true );\n\t\t\t}\n\t\t} else {\n\t\t\tthis.blur( true );\n\t\t}\n\n\t\t// Remove the prerender event handler\n\t\tswitch( this._mode ) {\n\t\tcase DDialogMode.MODAL:\n\t\t\tbreak;\n\t\tcase DDialogMode.MODELESS:\n\t\t\tbreak;\n\t\tcase DDialogMode.MENU:\n\t\t\tif( layer ) {\n\t\t\t\tlayer.renderer.off( \"prerender\", this._onPrerenderBound );\n\t\t\t}\n\t\t\tbreak;\n\t\t}\n\n\t\t// Forget the owner\n\t\tthis._owner = null;\n\n\t\t// Animation\n\t\tconst animation = this.getAnimation();\n\t\tif( animation ) {\n\t\t\tanimation.start( true );\n\t\t} else if( this._mode === DDialogMode.MENU ) {\n\t\t\tthis.visible = false;\n\t\t\tthis.onAnimationEnd( true );\n\t\t}\n\n\t\tthis.emit( \"close\", this );\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tswitch( this._mode ) {\n\t\tcase DDialogMode.MODAL:\n\t\tcase DDialogMode.MENU:\n\t\t\tif( this._closeOn & DDialogCloseOn.ESC ) {\n\t\t\t\tif( UtilKeyboardEvent.isCancelKey( e ) ) {\n\t\t\t\t\tthis.onCloseOn();\n\t\t\t\t}\n\t\t\t}\n\t\t\tbreak;\n\t\tcase DDialogMode.MODELESS:\n\t\t\tbreak;\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onCloseOn(): void {\n\t\tthis.close();\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\tswitch( this._mode ) {\n\t\tcase DDialogMode.MODAL:\n\t\tcase DDialogMode.MENU:\n\t\t\treturn true;\n\t\tcase DDialogMode.MODELESS:\n\t\t\treturn super.containsGlobalPoint( point );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialog\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DLayoutSpaceOptions<THEME extends DThemeLayoutSpace = DThemeLayoutSpace> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutSpace extends DThemeBase {\n\n}\n\nexport class DLayoutSpace<\n\tTHEME extends DThemeLayoutSpace = DThemeLayoutSpace,\n\tOPTIONS extends DLayoutSpaceOptions<THEME> = DLayoutSpaceOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.visible = false;\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DLayoutSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueOpenType {\n\tDIAGRAM,\n\tPAGE,\n\tPAGE_INPLACE,\n\tDIALOG_TEXT,\n\tDIALOG_INTEGER,\n\tDIALOG_REAL,\n\tDIALOG_BOOLEAN,\n\tDIALOG_DATE,\n\tDIALOG_TIME,\n\tDIALOG_DATETIME\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseCornerOptions, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DCornerMask } from \"./d-corner-mask\";\nimport { DLayoutClearType } from \"./d-layout-clear-type\";\nimport { DLayoutDirection } from \"./d-layout-direction\";\nimport { DLayoutSpace, DLayoutSpaceOptions } from \"./d-layout-space\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DLayoutMargin {\n\thorizontal: number;\n\tvertical: number;\n}\n\nexport interface DLayoutMarginOptions {\n\thorizontal?: number;\n\tvertical?: number;\n}\n\nexport interface DLayoutCornerOptions extends DBaseCornerOptions {\n\tadjust?: boolean;\n}\n\nexport interface DLayoutOptions<THEME extends DThemeLayout> extends DBaseOptions<THEME> {\n\tmargin?: number | DLayoutMarginOptions;\n\tcorner?: number | DLayoutCornerOptions;\n\trow?: number;\n\tcolumn?: number;\n\tdirection?: (keyof typeof DLayoutDirection) | DLayoutDirection;\n\treverse?: boolean;\n}\n\nexport interface DThemeLayout extends DThemeBase {\n\tgetMargin(): number;\n\tgetDirection(): DLayoutDirection;\n\tgetCornerAdjust(): boolean;\n\tgetMultiplicity(): number;\n\tgetReverse(): boolean;\n}\n\nconst isVisible = ( child: DisplayObject ): child is DBase => {\n\treturn child instanceof DBase && (child.visible || child instanceof DLayoutSpace);\n};\n\nconst toMultiplicity = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): number => {\n\tif( options ) {\n\t\tconst row = options.row;\n\t\tif( row != null ) {\n\t\t\treturn row;\n\t\t}\n\t\tconst column = options.column;\n\t\tif( column != null ) {\n\t\t\treturn column;\n\t\t}\n\t}\n\treturn theme.getMultiplicity();\n};\n\nconst toMargin = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): DLayoutMargin => {\n\tconst margin = options?.margin;\n\tif( margin != null ) {\n\t\tif( isNumber( margin ) ) {\n\t\t\treturn {\n\t\t\t\thorizontal: margin,\n\t\t\t\tvertical: margin\n\t\t\t};\n\t\t} else {\n\t\t\tconst themeMargin = theme.getMargin();\n\t\t\treturn {\n\t\t\t\thorizontal: ( margin.horizontal != null ? margin.horizontal : themeMargin ),\n\t\t\t\tvertical: ( margin.vertical != null ? margin.vertical : themeMargin )\n\t\t\t};\n\t\t}\n\t} else {\n\t\tconst themeMargin = theme.getMargin();\n\t\treturn {\n\t\t\thorizontal: themeMargin,\n\t\t\tvertical: themeMargin\n\t\t};\n\t}\n};\n\nconst toDirection = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): DLayoutDirection => {\n\tconst direction = options?.direction;\n\tif( direction != null ) {\n\t\tif( isString( direction ) ) {\n\t\t\treturn DLayoutDirection[ direction ];\n\t\t} else {\n\t\t\treturn direction;\n\t\t}\n\t}\n\treturn theme.getDirection();\n};\n\nconst toCornerAdjust = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): boolean => {\n\tconst corner = options?.corner;\n\tif( corner != null && ! isNumber( corner ) ) {\n\t\tconst adjust = corner.adjust;\n\t\tif( adjust != null ) {\n\t\t\treturn adjust;\n\t\t}\n\t}\n\treturn theme.getCornerAdjust();\n};\n\nconst toReverse = ( theme: DThemeLayout, options?: DLayoutOptions<DThemeLayout> ): boolean => {\n\treturn options?.reverse ?? theme.getReverse();\n};\n\nexport abstract class DLayout<\n\tTHEME extends DThemeLayout,\n\tOPTIONS extends DLayoutOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tstatic CORNER_ADJUST_WORK: Float32Array | null = null;\n\n\tprotected _margin!: DLayoutMargin;\n\tprotected _cornerAdjust!: boolean;\n\tprotected _multiplicity!: number;\n\tprotected _direction!: DLayoutDirection;\n\tprotected _reverse!: boolean;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tthis.state.isFocusable = false;\n\t\tconst theme = this.theme;\n\t\tthis._margin = toMargin( theme, options );\n\t\tthis._direction = toDirection( theme, options );\n\t\tthis._cornerAdjust = toCornerAdjust( theme, options );\n\t\tthis._multiplicity = toMultiplicity( theme, options );\n\t\tthis._reverse = toReverse( theme, options );\n\t}\n\n\tget margin(): DLayoutMargin {\n\t\treturn this._margin;\n\t}\n\n\tget multiplicity(): number {\n\t\treturn this._multiplicity;\n\t}\n\n\tprotected getWeightTotal() {\n\t\tconst children = this.children;\n\t\tlet result = 0;\n\t\tconst multiplicity = this._multiplicity;\n\t\tconst reverse = this._reverse;\n\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\tlet weight = -1;\n\t\t\tlet j = 0;\n\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\tif( clearType && DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ti += 1;\n\t\t\t\t\tj -= 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\ti += j;\n\t\t\tif( 0 <= weight ) {\n\t\t\t\tresult += weight;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getSpaceLeft( baseSize: number, margin: number ) {\n\t\tconst children = this.children;\n\t\tconst multiplicity = this._multiplicity;\n\t\tconst reverse = this._reverse;\n\t\tif( this._direction === DLayoutDirection.VERTICAL ) {\n\t\t\tlet result = baseSize;\n\t\t\tlet marginNext = 0;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\tlet height = 0;\n\t\t\t\tlet weight = -1;\n\t\t\t\tlet j = 0;\n\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\t\tif( weight < 0 ) {\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height + marginNext );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\theight = marginNext;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti += j;\n\t\t\t\tresult -= height;\n\t\t\t\tmarginNext = margin;\n\t\t\t}\n\t\t\treturn Math.max( 0, result );\n\t\t} else {\n\t\t\tlet result = baseSize;\n\t\t\tlet marginNext = 0;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\tlet width = 0;\n\t\t\t\tlet weight = -1;\n\t\t\t\tlet j = 0;\n\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tweight = Math.max( weight, child.weight );\n\t\t\t\t\t\t\tif( weight < 0 ) {\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width + marginNext );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\twidth = marginNext;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\ti += j;\n\t\t\t\tresult -= width;\n\t\t\t\tmarginNext = margin;\n\t\t\t}\n\t\t\treturn Math.max( 0, result );\n\t\t}\n\t}\n\n\tprotected calcSpaceLeft( isOn: boolean, size: number, padding: number, margin: number ): number {\n\t\treturn ( isOn ? 0 : this.getSpaceLeft( size - padding, margin ) );\n\t}\n\n\tprotected onRefit(): void {\n\t\tconst children = this.children;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst margin = this._margin;\n\t\tconst marginVertical = margin.vertical;\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tconst weightTotal = this.getWeightTotal();\n\t\tconst multiplicity = this._multiplicity;\n\t\tconst reverse = this._reverse;\n\t\tconst auto = this._auto;\n\n\t\tlet cornerAdjustWork = null;\n\t\tif( this._cornerAdjust ) {\n\t\t\tconst requiredSize = 4 + ( children.length << 1 );\n\t\t\tif( DLayout.CORNER_ADJUST_WORK == null || DLayout.CORNER_ADJUST_WORK.length < requiredSize ) {\n\t\t\t\tDLayout.CORNER_ADJUST_WORK = new Float32Array( requiredSize );\n\t\t\t}\n\t\t\tcornerAdjustWork = DLayout.CORNER_ADJUST_WORK;\n\t\t\tcornerAdjustWork[ 0 ] = -2;\n\t\t\tcornerAdjustWork[ 1 ] = -2;\n\t\t\tcornerAdjustWork[ requiredSize - 2 ] = -3;\n\t\t\tcornerAdjustWork[ requiredSize - 1 ] = -3;\n\t\t}\n\n\t\tif( this._direction === DLayoutDirection.VERTICAL ) {\n\t\t\tlet irow = 0;\n\t\t\tlet y = paddingTop - marginVertical;\n\t\t\tif( 0 < weightTotal ) {\n\t\t\t\tconst weightTotalInverse = 1 / weightTotal;\n\t\t\t\tconst spaceLeft = this.calcSpaceLeft(\n\t\t\t\t\tauto.height.isOn,\n\t\t\t\t\tthis.height,\n\t\t\t\t\tpaddingTop + paddingBottom,\n\t\t\t\t\tmarginVertical\n\t\t\t\t);\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\t\t\tlet height = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.height = spaceLeft * ( weight * weightTotalInverse );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tx += marginHorizontal + child.width;\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height );\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j - 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ty += marginVertical + height;\n\t\t\t\t\ti += j;\n\t\t\t\t\tirow += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet icolumn0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findRowIndexPrevious( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn0 = cornerAdjustWork[ i0 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet icolumn2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findRowIndexNext( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn2 = cornerAdjustWork[ i2 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst ncolumn = this.countColumn( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskColumn( icolumn0, icolumn1, icolumn2, ncolumn );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\t\t\tlet height = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.height = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tx += marginHorizontal + child.width;\n\t\t\t\t\t\t\t\theight = Math.max( height, child.height );\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = j - 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = irow;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\ty += marginVertical + height;\n\t\t\t\t\ti += j;\n\t\t\t\t\tirow += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet icolumn0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findRowIndexPrevious( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn0 = cornerAdjustWork[ i0 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet icolumn2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findRowIndexNext( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\ticolumn2 = cornerAdjustWork[ i2 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst ncolumn = this.countColumn( i1, irow1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskColumn( icolumn0, icolumn1, icolumn2, ncolumn );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tlet icolumn = 0;\n\t\t\tlet x = paddingLeft - marginHorizontal;\n\t\t\tif( 0 < weightTotal ) {\n\t\t\t\tconst weightTotalInverse = 1 / weightTotal;\n\t\t\t\tconst spaceLeft = this.calcSpaceLeft(\n\t\t\t\t\tauto.width.isOn,\n\t\t\t\t\tthis.width,\n\t\t\t\t\tpaddingLeft + paddingRight,\n\t\t\t\t\tmarginHorizontal\n\t\t\t\t);\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet y = paddingTop - marginVertical;\n\t\t\t\t\tlet width = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.width = spaceLeft * ( weight * weightTotalInverse );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width );\n\t\t\t\t\t\t\t\ty += marginVertical + child.height;\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tx += marginHorizontal + width;\n\t\t\t\t\ti += j;\n\t\t\t\t\ticolumn += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet irow0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findColumnIndexPrevious( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\tirow0 = cornerAdjustWork[ i0 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet irow2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findColumnIndexNext( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\tirow2 = cornerAdjustWork[ i2 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst nrow = this.countRow( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskRow( irow0, irow1, irow2, nrow );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ) {\n\t\t\t\t\tlet y = paddingTop - marginVertical;\n\t\t\t\t\tlet width = 0;\n\t\t\t\t\tlet j = 0;\n\t\t\t\t\tfor( ; j < multiplicity && i + j < imax; ++j ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - (i + j) : i + j ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\t\t\t\t\t\t\tif( j !== 0 && (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tchild.position.set( marginHorizontal + x, marginVertical + y );\n\t\t\t\t\t\t\t\tconst weight = child.weight;\n\t\t\t\t\t\t\t\tif( 0 <= weight ) {\n\t\t\t\t\t\t\t\t\tchild.width = 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\twidth = Math.max( width, child.width );\n\t\t\t\t\t\t\t\ty += marginVertical + child.height;\n\t\t\t\t\t\t\t\tif( clearType & DLayoutClearType.AFTER ) {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\tj += 1;\n\t\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\t\t\t\tconst k = (i + j + 1) << 1;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 0 ] = icolumn;\n\t\t\t\t\t\t\t\tcornerAdjustWork[ k + 1 ] = j - 1;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\ti += 1;\n\t\t\t\t\t\t\tj -= 1;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tx += marginHorizontal + width;\n\t\t\t\t\ti += j;\n\t\t\t\t\ticolumn += 1;\n\t\t\t\t}\n\n\t\t\t\tif( cornerAdjustWork != null ) {\n\t\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst child = children[ reverse ? imax - 1 - i : i ];\n\t\t\t\t\t\tif( isVisible( child ) ) {\n\t\t\t\t\t\t\tconst i1 = 2 + ( i << 1 );\n\t\t\t\t\t\t\tconst icolumn1 = cornerAdjustWork[ i1 + 0 ];\n\t\t\t\t\t\t\tconst irow1 = cornerAdjustWork[ i1 + 1 ];\n\t\t\t\t\t\t\tconst clearType = child.getClearType();\n\n\t\t\t\t\t\t\tlet irow0 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.BEFORE) ) {\n\t\t\t\t\t\t\t\tconst i0 = this.findColumnIndexPrevious( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeAfter( children, i0 ) ) {\n\t\t\t\t\t\t\t\t\tirow0 = cornerAdjustWork[ i0 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tlet irow2 = -2;\n\t\t\t\t\t\t\tif( ! (clearType & DLayoutClearType.AFTER) ) {\n\t\t\t\t\t\t\t\tconst i2 = this.findColumnIndexNext( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\t\tif( ! this.hasClearTypeBefore( children, i2 ) ) {\n\t\t\t\t\t\t\t\t\tirow2 = cornerAdjustWork[ i2 + 1 ];\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tconst nrow = this.countRow( i1, icolumn1, cornerAdjustWork );\n\t\t\t\t\t\t\tchild.corner.mask = this.toCornerMaskRow( irow0, irow1, irow2, nrow );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tsuper.onRefit();\n\t}\n\n\tprotected hasClearTypeBefore( children: DisplayObject[], index: number ): boolean {\n\t\treturn this.hasClearType( children, index, DLayoutClearType.BEFORE );\n\t}\n\n\tprotected hasClearTypeAfter( children: DisplayObject[], index: number ): boolean {\n\t\treturn this.hasClearType( children, index, DLayoutClearType.AFTER );\n\t}\n\n\tprotected hasClearType( children: DisplayObject[], index: number, clearType: DLayoutClearType ): boolean {\n\t\tif( 2 <= index ) {\n\t\t\tconst i = (index - 2) >> 1;\n\t\t\tif( 0 <= i && i < children.length ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\treturn !!( child.getClearType() & clearType );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected findColumnIndexPrevious( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart - 2; 0 <= i; i -= 2 ) {\n\t\t\tif( cornerAdjustWork[ i ] !== icolumn ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findColumnIndexNext( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst icolumn2 = cornerAdjustWork[ i ];\n\t\t\tif( icolumn2 !== icolumn ) {\n\t\t\t\tfor( let j = i + 2; j < imax; j += 2 ) {\n\t\t\t\t\tif( cornerAdjustWork[ j ] !== icolumn2 ) {\n\t\t\t\t\t\treturn j - 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn cornerAdjustWork.length - 2;\n\t}\n\n\tprotected countRow( istart: number, icolumn: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst icolumn2 = cornerAdjustWork[ i ];\n\t\t\tif( icolumn2 !== icolumn ) {\n\t\t\t\treturn cornerAdjustWork[ i - 2 + 1 ] + 1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findRowIndexPrevious( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart - 2; 0 <= i; i -= 2 ) {\n\t\t\tif( cornerAdjustWork[ i + 1 ] !== irow ) {\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected findRowIndexNext( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst irow2 = cornerAdjustWork[ i + 1 ];\n\t\t\tif( irow2 !== irow ) {\n\t\t\t\tfor( let j = i + 2; j < imax; j += 2 ) {\n\t\t\t\t\tif( cornerAdjustWork[ j + 1 ] !== irow2 ) {\n\t\t\t\t\t\treturn j - 2;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn i;\n\t\t\t}\n\t\t}\n\t\treturn cornerAdjustWork.length - 2;\n\t}\n\n\tprotected countColumn( istart: number, irow: number, cornerAdjustWork: Float32Array ): number {\n\t\tfor( let i = istart + 2, imax = cornerAdjustWork.length; i < imax; i += 2 ) {\n\t\t\tconst irow2 = cornerAdjustWork[ i + 1 ];\n\t\t\tif( irow2 !== irow ) {\n\t\t\t\treturn cornerAdjustWork[ i - 2 + 0 ] + 1;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected toCornerMaskColumn( i0: number, i1: number, i2: number, n: number ): DCornerMask {\n\t\tlet result = DCornerMask.NONE;\n\t\tif( i0 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_LEFT;\n\t\t}\n\t\tif( i2 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.BOTTOM_LEFT;\n\t\t}\n\t\tif( i0 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.TOP_RIGHT;\n\t\t}\n\t\tif( i2 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_RIGHT;\n\t\t}\n\t\treturn DCornerMask.ALL & (~result);\n\t}\n\n\tprotected toCornerMaskRow( i0: number, i1: number, i2: number, n: number ): DCornerMask {\n\t\tlet result = DCornerMask.NONE;\n\t\tif( i0 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_LEFT;\n\t\t}\n\t\tif( i2 + 1 < i1 && i1 === 0 ) {\n\t\t\tresult |= DCornerMask.TOP_RIGHT;\n\t\t}\n\t\tif( i0 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_LEFT;\n\t\t}\n\t\tif( i2 < i1 && i1 + 1 === n ) {\n\t\t\tresult |= DCornerMask.BOTTOM_RIGHT;\n\t\t}\n\t\treturn DCornerMask.ALL & (~result);\n\t}\n\n\taddSpace( options?: DLayoutSpaceOptions ) {\n\t\treturn this.addChild( new DLayoutSpace( options ) );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DLayout\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayout, DLayoutOptions, DThemeLayout } from \"./d-layout\";\n\nexport interface DLayoutHorizontalOptions<THEME extends DThemeLayoutHorizontal> extends DLayoutOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutHorizontal extends DThemeLayout {\n\n}\n\nexport class DLayoutHorizontal<\n\tTHEME extends DThemeLayoutHorizontal = DThemeLayoutHorizontal,\n\tOPTIONS extends DLayoutHorizontalOptions<THEME> = DLayoutHorizontalOptions<THEME>\n> extends DLayout<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DLayoutHorizontal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayout, DLayoutOptions, DThemeLayout } from \"./d-layout\";\n\nexport interface DLayoutVerticalOptions<THEME extends DThemeLayoutVertical> extends DLayoutOptions<THEME> {\n\n}\n\nexport interface DThemeLayoutVertical extends DThemeLayout {\n\n}\n\nexport class DLayoutVertical<\n\tTHEME extends DThemeLayoutVertical = DThemeLayoutVertical,\n\tOPTIONS extends DLayoutVerticalOptions<THEME> = DLayoutVerticalOptions<THEME>\n> extends DLayout<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DLayoutVertical\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\nimport { DButtonPrimary } from \"./d-button-primary\";\nimport { DCoordinatePosition, DCoordinateSize } from \"./d-coordinate\";\nimport { DDialog, DDialogEvents, DDialogOptions, DThemeDialog } from \"./d-dialog\";\nimport { DDialogMode } from \"./d-dialog-mode\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace } from \"./d-layout-space\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\n\n/**\n * {@link DDialogCommand} events.\n */\nexport interface DDialogCommandEvents<VALUE, EMITTER> extends DDialogEvents<EMITTER> {\n\t/**\n\t * Triggered when a dialog is successfully finished.\n\t *\n\t * @param value a value\n\t * @param emitter an emitter\n\t */\n\tok( value: VALUE, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when a dialog is canceled.\n\t *\n\t * @param reason a reason why canceled\n\t * @param emitter an emitter\n\t */\n\tcancel( reason: any, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DDialogCommand} \"on\" options.\n */\nexport interface DDialogCommandOnOptions<VALUE, EMITTER> extends Partial<DDialogCommandEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n\n}\n\n/**\n * {@link DDialogCommand} options.\n */\nexport interface DDialogCommandOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogCommand = DThemeDialogCommand,\n\tEMITTER = any\n> extends DDialogOptions<THEME> {\n\t/**\n\t * A ok button label.\n\t */\n\tok?: string;\n\n\t/**\n\t * A cancel button label.\n\t */\n\tcancel?: string;\n\n\t/**\n\t * Mappings of event names and handlers.\n\t */\n\ton?: DDialogCommandOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DDialogCommand} theme.\n */\nexport interface DThemeDialogCommand extends DThemeDialog {\n\tgetOk(): string | null;\n\tgetCancel(): string | null;\n\tgetLayoutX(): DCoordinatePosition;\n\tgetLayoutY(): DCoordinatePosition;\n\tgetLayoutWidth(): DCoordinateSize;\n\tgetLayoutHeight(): DCoordinateSize;\n\tgetLayoutMargin(): number | undefined;\n}\n\n/**\n * A dialog with \"ok\" and \"cancel\" buttons.\n */\nexport abstract class DDialogCommand<\n\tVALUE = void,\n\tTHEME extends DThemeDialogCommand = DThemeDialogCommand,\n\tOPTIONS extends DDialogCommandOptions<VALUE, THEME> = DDialogCommandOptions<VALUE, THEME>\n> extends DDialog<VALUE, THEME, OPTIONS> {\n\tprotected _buttonLayout?: DLayoutHorizontal;\n\tprotected _buttonOk?: DButton;\n\tprotected _buttonCancel?: DButton;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst theme = this.theme;\n\t\tconst layout = new DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: theme.getLayoutX(),\n\t\t\ty: theme.getLayoutY(),\n\t\t\twidth: theme.getLayoutWidth(),\n\t\t\theight: theme.getLayoutHeight(),\n\t\t\tmargin: theme.getLayoutMargin()\n\t\t});\n\n\t\tthis.onInit( layout, options );\n\n\t\t// Buttons\n\t\tconst ok = ( options?.ok ?? theme.getOk() );\n\t\tconst cancel = ( options?.cancel ?? theme.getCancel() );\n\t\tif( ok != null || cancel != null ) {\n\t\t\tconst buttonLayout = new DLayoutHorizontal({\n\t\t\t\tparent: layout,\n\t\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\t\tpadding: {\n\t\t\t\t\ttop: Math.max( 0, this.padding.getTop() - layout.margin.vertical )\n\t\t\t\t}\n\t\t\t});\n\t\t\tthis._buttonLayout = buttonLayout;\n\t\t\tnew DLayoutSpace({\n\t\t\t\tparent: buttonLayout,\n\t\t\t\tweight: 1\n\t\t\t});\n\t\t\tif( ok != null && cancel != null ) {\n\t\t\t\tthis._buttonCancel = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: cancel\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\tthis._buttonOk = new DButton({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ok\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.ok();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if( ok != null ) {\n\t\t\t\tthis._buttonOk = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: ok\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.ok();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else if( cancel != null ) {\n\t\t\t\tthis._buttonCancel = new DButtonPrimary({\n\t\t\t\t\tparent: buttonLayout,\n\t\t\t\t\ttext: {\n\t\t\t\t\t\tvalue: cancel\n\t\t\t\t\t},\n\t\t\t\t\ton: {\n\t\t\t\t\t\tactive: (): void => {\n\t\t\t\t\t\t\tthis.cancel();\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t\tnew DLayoutSpace({\n\t\t\t\tparent: buttonLayout,\n\t\t\t\tweight: 1\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\t// OVERRIDE THIS\n\t}\n\n\tok(): void {\n\t\tthis.onOk( this.getResolvedValue() );\n\t}\n\n\tprotected onOk( value: VALUE | PromiseLike<VALUE> ): void {\n\t\tif( this._mode !== DDialogMode.MODELESS ) {\n\t\t\tthis.doResolve( value );\n\t\t}\n\t\tthis.emit( \"ok\", value, this );\n\t}\n\n\tcancel(): void {\n\t\tthis.onCancel( this.getRejectReason() );\n\t}\n\n\tprotected onCancel( reason: any ): void {\n\t\tif( this._mode !== DDialogMode.MODELESS ) {\n\t\t\tthis.doReject( reason );\n\t\t}\n\t\tthis.emit( \"cancel\", reason, this );\n\t}\n\n\tprotected abstract getResolvedValue(): VALUE | PromiseLike<VALUE>;\n\n\tprotected getRejectReason(): any {\n\t\treturn undefined;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogCommand\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\n\nexport interface DTextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeText<VALUE> = DThemeText<VALUE>\n> extends DTextBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeText<VALUE = unknown> extends DThemeTextBase<VALUE> {\n\n}\n\nexport class DText<\n\tVALUE = unknown,\n\tTHEME extends DThemeText<VALUE> = DThemeText<VALUE>,\n\tOPTIONS extends DTextOptions<VALUE, THEME> = DTextOptions<VALUE, THEME>\n> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace } from \"./d-layout-space\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DText, DTextOptions } from \"./d-text\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DDialogInputMargin {\n\thorizontal: number;\n\tvertical: number;\n}\n\nexport interface DDialogInputMarginOptions extends Partial<DDialogInputMargin> {\n\n}\n\nexport interface DDialogInputOptions<\n\tVALUE = void,\n\tINPUT_OPTIONS extends DBaseOptions = DBaseOptions,\n\tTHEME extends DThemeDialogInput = DThemeDialogInput\n> extends DDialogCommandOptions<VALUE, THEME> {\n\tlabel?: string | DTextOptions<string>;\n\tinput?: INPUT_OPTIONS;\n\tmargin?: number | DDialogInputMarginOptions;\n}\n\nexport interface DThemeDialogInput extends DThemeDialogCommand {\n\tgetMarginVertical(): number;\n\tgetMarginHorizontal(): number;\n\tgetLabel(): string;\n}\n\nexport abstract class DDialogInput<\n\tVALUE = void,\n\tINPUT extends DBase & { value: VALUE } = any,\n\tINPUT_OPTIONS extends DBaseOptions = DBaseOptions,\n\tTHEME extends DThemeDialogInput = DThemeDialogInput,\n\tOPTIONS extends DDialogInputOptions<VALUE, INPUT_OPTIONS, THEME> = DDialogInputOptions<VALUE, INPUT_OPTIONS, THEME>\n> extends DDialogCommand<VALUE, THEME, OPTIONS> {\n\tprotected _label?: DText<string>;\n\tprotected _input?: INPUT;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\n\t\tconst theme = this.theme;\n\t\tconst margin = this.toMargin( theme, options );\n\t\tconst marginHorizontal = margin.horizontal;\n\t\tconst marginVertical = margin.vertical;\n\t\tconst labelOptions = this.toLabelOptions( theme, options );\n\t\tif( labelOptions ) {\n\t\t\tthis._label = new DText<string>( labelOptions );\n\t\t\tnew DLayoutHorizontal({\n\t\t\t\tparent: layout,\n\t\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\t\tmargin: 0,\n\t\t\t\tchildren: [\n\t\t\t\t\tnew DLayoutSpace({ width: marginHorizontal }),\n\t\t\t\t\tthis._label\n\t\t\t\t]\n\t\t\t});\n\t\t}\n\t\tnew DLayoutHorizontal({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\", height: \"auto\",\n\t\t\tmargin: 0,\n\t\t\tpadding: ( labelOptions ? { top: marginVertical } : undefined ),\n\t\t\tchildren: [\n\t\t\t\tnew DLayoutSpace({ width: marginHorizontal }),\n\t\t\t\tthis.input,\n\t\t\t\tnew DLayoutSpace({ width: marginHorizontal })\n\t\t\t]\n\t\t});\n\t}\n\n\tprotected toMargin( theme: THEME, options?: OPTIONS ): Required<DDialogInputMarginOptions> {\n\t\tconst margin = options && options.margin;\n\t\tif( margin != null ) {\n\t\t\tif( isNumber( margin ) ) {\n\t\t\t\treturn {\n\t\t\t\t\thorizontal: margin,\n\t\t\t\t\tvertical: margin\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tconst horizontal = margin.horizontal;\n\t\t\t\tconst vertical = margin.vertical;\n\t\t\t\treturn {\n\t\t\t\t\thorizontal: ( horizontal != null ? horizontal : theme.getMarginHorizontal() ),\n\t\t\t\t\tvertical: ( vertical != null ? vertical : theme.getMarginVertical() )\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\thorizontal: theme.getMarginHorizontal(),\n\t\t\tvertical: theme.getMarginVertical()\n\t\t};\n\t}\n\n\tprotected toLabelOptions( theme: THEME, options: OPTIONS | undefined ): DTextOptions<string> | null {\n\t\tconst label = options && options.label ;\n\t\tif( label == null ) {\n\t\t\treturn null;\n\t\t}\n\n\t\tif( isString( label ) ) {\n\t\t\treturn {\n\t\t\t\tweight: 1,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: label\n\t\t\t\t}\n\t\t\t};\n\t\t} else {\n\t\t\t// Text\n\t\t\tconst text = label.text = label.text || {};\n\t\t\tif( text.value === undefined ) {\n\t\t\t\ttext.value = theme.getLabel();\n\t\t\t}\n\n\t\t\t// Margin\n\t\t\tif( label.width === undefined && label.weight === undefined ) {\n\t\t\t\tlabel.weight = 1;\n\t\t\t}\n\n\t\t\treturn label;\n\t\t}\n\t}\n\n\tget label(): DText<string> | undefined {\n\t\treturn this._label;\n\t}\n\n\tprotected abstract newInput( options?: INPUT_OPTIONS ): INPUT;\n\n\tget input(): INPUT {\n\t\tlet result = this._input;\n\t\tif( result == null ) {\n\t\t\tconst options = this._options;\n\t\t\tresult = this.newInput( options && options.input );\n\t\t\tthis._input = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tget value(): VALUE {\n\t\treturn this.input.value;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.input.value = value;\n\t}\n\n\tprotected getResolvedValue(): VALUE | PromiseLike<VALUE> {\n\t\treturn this.input.value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogInput\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DButtonBase } from \"./d-button-base\";\n\n/**\n * {@link DButtonGroup} events.\n */\nexport interface DButtonGroupEvents<BUTTON, EMITTER> {\n\t/**\n\t * Triggered when the active button is changed.\n\t *\n\t * @param emitter an emitter\n\t */\n\tactive( newActive: BUTTON | null, oldActive: BUTTON | null, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonGroup} \"on\" options.\n */\nexport interface DButtonGroupOnOptions<BUTTON, EMITTER> extends Partial<DButtonGroupEvents<BUTTON, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\nexport interface DButtonGroupOptions<\n\tBUTTON extends DButtonBase<any, any, any> = DButtonBase<any, any, any>,\n\tEMITTER = any\n> {\n\ton?: DButtonGroupOnOptions<BUTTON, EMITTER>;\n}\n\nexport class DButtonGroup<\n\tBUTTON extends DButtonBase<any, any, any> = DButtonBase<any, any, any>,\n\tOPTIONS extends DButtonGroupOptions<BUTTON> = DButtonGroupOptions<BUTTON>\n> extends utils.EventEmitter {\n\tprotected _buttons: BUTTON[];\n\tprotected _active: BUTTON | null;\n\tprotected _onActiveBound: ( button: BUTTON ) => void;\n\tprotected _isEnabled?: boolean;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper();\n\n\t\tthis._buttons = [];\n\t\tthis._active = null;\n\t\tthis._onActiveBound = ( button: BUTTON ): void => {\n\t\t\tthis.active = button;\n\t\t};\n\n\t\t// Events\n\t\tif( options != null ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tconst handler = on[ name ];\n\t\t\t\t\tif( handler ) {\n\t\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Done\n\t\tthis.emit( \"init\", this );\n\t}\n\n\tadd( button: BUTTON ): void {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\tif( index < 0 ) {\n\t\t\tthis._buttons.push( button );\n\t\t\tconst isEnabled = this._isEnabled;\n\t\t\tif( isEnabled != null ) {\n\t\t\t\tbutton.state.isEnabled = isEnabled;\n\t\t\t}\n\t\t\tbutton.on( \"active\", this._onActiveBound );\n\t\t\tif( button.state.isActive ) {\n\t\t\t\tthis.active = button;\n\t\t\t}\n\t\t}\n\t}\n\n\tget active(): BUTTON | null {\n\t\treturn this._active;\n\t}\n\n\tset active( newActive: BUTTON | null ) {\n\t\tif( (newActive == null || newActive.isToggle()) && this._active !== newActive ) {\n\t\t\tconst oldActive = this._active;\n\t\t\tthis._active = null;\n\t\t\tconst buttons = this._buttons;\n\t\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\t\tconst button = buttons[ i ];\n\t\t\t\tif( button !== newActive && button.isToggle() && button.state.isActive ) {\n\t\t\t\t\tbutton.toggle();\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.emit( \"active\", newActive, oldActive, this );\n\t\t}\n\t}\n\n\tremove( button: BUTTON ): void {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\tif( 0 <= index ) {\n\t\t\tbuttons.splice( index, 1 );\n\t\t\tbutton.off( \"active\", this._onActiveBound );\n\t\t\tif( this._active === button ) {\n\t\t\t\tthis.active = null;\n\t\t\t}\n\t\t}\n\t}\n\n\tcontains( button: BUTTON ): boolean {\n\t\tconst buttons = this._buttons;\n\t\tconst index = buttons.indexOf( button );\n\t\treturn ( 0 <= index );\n\t}\n\n\tclear(): void {\n\t\tthis._buttons.length = 0;\n\t\tthis.active = null;\n\t}\n\n\tsize(): number {\n\t\treturn this._buttons.length;\n\t}\n\n\teach( iteratee: ( button: BUTTON ) => boolean | void ): void {\n\t\tconst buttons = this._buttons;\n\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\tconst button = buttons[ i ];\n\t\t\tif( iteratee( button ) === false ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tdisable(): void {\n\t\tconst buttons = this._buttons;\n\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\tbuttons[ i ].state.isDisabled = true;\n\t\t}\n\t\tthis._isEnabled = false;\n\t}\n\n\tenable(): void {\n\t\tconst buttons = this._buttons;\n\t\tfor( let i = 0, imax = buttons.length; i < imax; ++i ) {\n\t\t\tbuttons[ i ].state.isDisabled = false;\n\t\t}\n\t\tthis._isEnabled = true;\n\t}\n\n\tdestroy(): void {\n\t\tthis.clear();\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\n\nexport interface DInputBooleanButtonOffOptions<\n\tTHEME extends DThemeInputBooleanButtonOff = DThemeInputBooleanButtonOff,\n\tEMITTER = any\n> extends DButtonOptions<string, THEME, EMITTER> {\n\n}\n\nexport interface DThemeInputBooleanButtonOff extends DThemeButton<string> {\n\n}\n\nexport class DInputBooleanButtonOff<\n\tTHEME extends DThemeInputBooleanButtonOff = DThemeInputBooleanButtonOff,\n\tOPTIONS extends DInputBooleanButtonOffOptions<THEME> = DInputBooleanButtonOffOptions<THEME>\n> extends DButton<string, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputBooleanButtonOff\";\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\n\nexport interface DInputBooleanButtonOnOptions<\n\tTHEME extends DThemeInputBooleanButtonOn = DThemeInputBooleanButtonOn,\n\tEMITTER = any\n> extends DButtonOptions<string, THEME, EMITTER> {\n\n}\n\nexport interface DThemeInputBooleanButtonOn extends DThemeButton<string> {\n\n}\n\nexport class DInputBooleanButtonOn<\n\tTHEME extends DThemeInputBooleanButtonOn = DThemeInputBooleanButtonOn,\n\tOPTIONS extends DInputBooleanButtonOnOptions<THEME> = DInputBooleanButtonOnOptions<THEME>\n> extends DButton<string, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputBooleanButtonOn\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DButtonGroup } from \"./d-button-group\";\nimport { DInputBooleanButtonOff } from \"./d-input-boolean-button-off\";\nimport { DInputBooleanButtonOn } from \"./d-input-boolean-button-on\";\nimport { DLayoutOptions } from \"./d-layout\";\nimport { DLayoutHorizontal, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\n\nexport interface DInputBooleanOptions<\n\tTHEME extends DThemeInputBoolean = DThemeInputBoolean\n> extends DLayoutOptions<THEME> {\n\tvalue?: boolean;\n}\n\nexport interface DThemeInputBoolean extends DThemeLayoutHorizontal {\n\n}\n\nexport class DInputBoolean<\n\tTHEME extends DThemeInputBoolean = DThemeInputBoolean,\n\tOPTIONS extends DInputBooleanOptions<THEME> = DInputBooleanOptions<THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _buttonGroup?: DButtonGroup;\n\tprotected _buttonOn?: DInputBooleanButtonOn;\n\tprotected _buttonOff?: DInputBooleanButtonOff;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.addChild( this.getButtonOff() );\n\t\tthis.addChild( this.getButtonOn() );\n\n\t\tif( options && options.value != null ) {\n\t\t\tthis.value = options.value;\n\t\t}\n\n\t\tthis.getButtonGroup().on( \"active\", (): void => {\n\t\t\tconst newValue = this.value;\n\t\t\tthis.emit( \"change\", newValue, ! newValue, this );\n\t\t});\n\t}\n\n\tprotected getButtonGroup(): DButtonGroup {\n\t\tlet result = this._buttonGroup;\n\t\tif( result == null ) {\n\t\t\tresult = this.newButtonGroup();\n\t\t\tthis._buttonGroup = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newButtonGroup(): DButtonGroup {\n\t\treturn new DButtonGroup();\n\t}\n\n\tprotected getButtonOn(): DInputBooleanButtonOn {\n\t\tlet result = this._buttonOn;\n\t\tif( result == null ) {\n\t\t\tresult = this.newButtonOn();\n\t\t\tthis._buttonOn = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newButtonOn(): DInputBooleanButtonOn {\n\t\treturn new DInputBooleanButtonOn({\n\t\t\tweight: 1,\n\t\t\tgroup: this.getButtonGroup()\n\t\t});\n\t}\n\n\tprotected getButtonOff(): DInputBooleanButtonOff {\n\t\tlet result = this._buttonOff;\n\t\tif( result == null ) {\n\t\t\tresult = this.newButtonOff();\n\t\t\tthis._buttonOff = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newButtonOff(): DInputBooleanButtonOff {\n\t\treturn new DInputBooleanButtonOff({\n\t\t\tweight: 1,\n\t\t\tgroup: this.getButtonGroup(),\n\t\t\tstate: DBaseState.ACTIVE\n\t\t});\n\t}\n\n\tget value(): boolean {\n\t\treturn this.getButtonOn().state.isActive;\n\t}\n\n\tset value( value: boolean ) {\n\t\tif( this.value !== value ) {\n\t\t\tif( value ) {\n\t\t\t\tthis.getButtonOn().onClick();\n\t\t\t} else {\n\t\t\t\tthis.getButtonOff().onClick();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DInputBoolean\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInput, DDialogInputOptions, DThemeDialogInput } from \"./d-dialog-input\";\nimport { DInputBoolean, DInputBooleanOptions } from \"./d-input-boolean\";\n\nexport interface DDialogInputBooleanOptions<\n\tTHEME extends DThemeDialogInputBoolean\n> extends DDialogInputOptions<boolean, DInputBooleanOptions, THEME> {\n\n}\n\nexport interface DThemeDialogInputBoolean extends DThemeDialogInput {\n\n}\n\nexport class DDialogInputBoolean<\n\tTHEME extends DThemeDialogInputBoolean = DThemeDialogInputBoolean,\n\tOPTIONS extends DDialogInputBooleanOptions<THEME> = DDialogInputBooleanOptions<THEME>\n> extends DDialogInput<boolean, DInputBoolean, DInputBooleanOptions, THEME, OPTIONS> {\n\tprotected newInput( options?: DInputBooleanOptions ): DInputBoolean {\n\t\treturn new DInputBoolean( this.toInputOptions( options ) );\n\t}\n\n\tprotected toInputOptions( options?: DInputBooleanOptions ): DInputBooleanOptions {\n\t\tif( options ) {\n\t\t\tif( options.weight === undefined ) {\n\t\t\t\toptions.weight = 1;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tweight: 1\n\t\t};\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogInputBoolean\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpen extends EShapeActionRuntimeConditional {\n\tprotected readonly target: EShapeActionExpression<string | null>;\n\n\tconstructor( value: EShapeActionValueOpen, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.target = EShapeActionExpressions.ofStringOrNull( value.target );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOnInputAction } from \"./e-shape-action-value-on-input-action\";\nimport { EShapeActionValueOnInputActions } from \"./e-shape-action-value-on-input-actions\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport abstract class EShapeActionRuntimeOpenDialog<VALUE = unknown, INITIAL = VALUE> extends EShapeActionRuntimeOpen {\n\tprotected onInputAction: EShapeActionValueOnInputAction;\n\tprotected isOpened: boolean;\n\tprotected abstract initial: EShapeActionExpression<INITIAL>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t\tthis.onInputAction = value.onInputAction;\n\t\tthis.isOpened = false;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( ! this.isOpened ) {\n\t\t\tif( this.condition( shape, time ) ) {\n\t\t\t\tconst target = this.target( shape, time );\n\t\t\t\tif( target != null ) {\n\t\t\t\t\tconst initial = this.initial( shape, time );\n\t\t\t\t\tthis.isOpened = true;\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tthis.open( target, initial ).then(( value ) => {\n\t\t\t\t\t\t\tthis.isOpened = false;\n\t\t\t\t\t\t\tEShapeActionValueOnInputActions.execute( shape, this.onInputAction, target, value, time );\n\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\tthis.isOpened = false;\n\t\t\t\t\t\t});\n\t\t\t\t\t}, 0);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected abstract open( target: string, initial: INITIAL ): Promise<VALUE>;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInputBoolean } from \"../../d-dialog-input-boolean\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeOpenDialog } from \"./e-shape-action-runtime-open-dialog\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDialogBoolean extends EShapeActionRuntimeOpenDialog<boolean> {\n\tprotected static DIALOG?: DDialogInputBoolean;\n\tprotected initial: EShapeActionExpression<boolean>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value );\n\t\tthis.initial = EShapeActionExpressions.ofBooleanOrFalse( value.initial );\n\t}\n\n\tprotected open( target: string, initial: boolean ): Promise<boolean> {\n\t\tlet dialog = EShapeActionRuntimeOpenDialogBoolean.DIALOG;\n\t\tif( dialog == null ) {\n\t\t\tdialog = new DDialogInputBoolean({\n\t\t\t\tlabel: target\n\t\t\t});\n\t\t\tEShapeActionRuntimeOpenDialogBoolean.DIALOG = dialog;\n\t\t} else {\n\t\t\tconst label = dialog.label;\n\t\t\tif( label ) {\n\t\t\t\tlabel.text = target;\n\t\t\t}\n\t\t}\n\t\tdialog.value = initial;\n\t\treturn dialog.open();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Matrix, Point, Rectangle, Renderer } from \"pixi.js\";\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilHtmlElement, UtilHtmlElementOperation, UtilHtmlElementOptions, UtilHtmlElementPadding, UtilThemeHtmlElement } from \"./util/util-html-element\";\n\nexport interface DHtmlElementOptions<\n\tVALUE = unknown,\n\tELEMENT extends HTMLElement = HTMLElement,\n\tTHEME extends DThemeHtmlElement<VALUE, ELEMENT> = DThemeHtmlElement<VALUE, ELEMENT>\n> extends DImageBaseOptions<VALUE, THEME>, UtilHtmlElementOptions<ELEMENT> {\n\n}\n\nexport interface DThemeHtmlElement<\n\tVALUE = unknown,\n\tELEMENT extends HTMLElement = HTMLElement\n> extends DThemeImageBase<VALUE>, UtilThemeHtmlElement<ELEMENT> {\n\n}\n\nexport class DHtmlElement<\n\tVALUE = unknown,\n\tELEMENT extends HTMLElement = HTMLElement,\n\tTHEME extends DThemeHtmlElement<VALUE, ELEMENT> = DThemeHtmlElement<VALUE, ELEMENT>,\n\tOPTIONS extends DHtmlElementOptions<VALUE, ELEMENT, THEME> = DHtmlElementOptions<VALUE, ELEMENT, THEME>,\n\tUTIL extends UtilHtmlElement<ELEMENT> = UtilHtmlElement<ELEMENT>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected _util?: UTIL;\n\n\tprotected getUtil(): UTIL {\n\t\tlet result = this._util;\n\t\tif( result == null ) {\n\t\t\tresult = this.newUtil();\n\t\t\tthis._util = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newUtil(): UTIL {\n\t\treturn new UtilHtmlElement<ELEMENT>(\n\t\t\tthis, this.newOperation(), this.theme, this._options\n\t\t) as any;\n\t}\n\n\tprotected newOperation(): UtilHtmlElementOperation<ELEMENT> {\n\t\treturn {\n\t\t\tgetElementRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getElementRect( resolution, work, result );\n\t\t\t},\n\n\t\t\tgetElementMatrix: (): Matrix | null => {\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tgetClipperRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getClipperRect( resolution, work, result );\n\t\t\t},\n\n\t\t\tgetPadding: (): UtilHtmlElementPadding | null => {\n\t\t\t\treturn this.padding;\n\t\t\t},\n\n\t\t\tcontainsPoint: ( point: Point ): boolean => {\n\t\t\t\treturn this.containsPoint( point );\n\t\t\t},\n\n\t\t\tonStart: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tonCancel: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tonEnd: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t}\n\t\t};\n\t}\n\n\tget element(): ELEMENT | null {\n\t\treturn this.getUtil().element;\n\t}\n\n\tprotected onDownThis( e: interaction.InteractionEvent ): void {\n\t\tconst util = this.getUtil();\n\t\tutil.onDownThisBefore( e );\n\t\tsuper.onDownThis( e );\n\t\tutil.onDownThisAfter( e );\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tthis.getUtil().onDblClick( e, interactionManager );\n\t\treturn super.onDblClick( e, interactionManager );\n\t}\n\n\tprotected onFocus(): void {\n\t\tsuper.onFocus();\n\t\tthis.getUtil().onFocus();\n\t}\n\n\tprotected onBlur(): void {\n\t\tsuper.onBlur();\n\t\tthis.getUtil().onBlur();\n\t}\n\n\tstart(): void {\n\t\tthis.getUtil().start();\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.getUtil().onRender( renderer );\n\t\tsuper.render( renderer );\n\t}\n\n\t/**\n\t * Please note that this method does not update transforms.\n\t *\n\t * @param resolution\n\t */\n\tprotected getElementRect( resolution: number, point: Point, result: Rectangle ): Rectangle | null {\n\t\tpoint.set( 0, 0 );\n\t\tthis.toGlobal( point, point, false );\n\t\tresult.x = point.x;\n\t\tresult.y = point.y;\n\n\t\tpoint.set( this.width, this.height );\n\t\tthis.toGlobal( point, point, true );\n\t\tresult.width = point.x - result.x;\n\t\tresult.height = point.y - result.y;\n\n\t\t// Rounds pixels as Pixi.js does\n\t\tresult.x = ( (result.x * resolution) | 0 ) / resolution;\n\t\tresult.y = ( (result.y * resolution) | 0 ) / resolution;\n\n\t\treturn result;\n\t}\n\n\tprotected getClipperRect( resolution: number, point: Point, result: Rectangle ): Rectangle | null {\n\t\treturn UtilHtmlElement.getClipperRect(\n\t\t\tthis.parent, this, resolution, point, result\n\t\t);\n\t}\n\n\tcancel(): void {\n\t\tthis.getUtil().cancel();\n\t}\n\n\tend(): void {\n\t\tthis.getUtil().end();\n\t}\n\n\tselect(): this {\n\t\tthis.getUtil().select();\n\t\treturn this;\n\t}\n\n\tprotected onActivateKeyDown( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tthis.state.isPressed = true;\n\t\t}\n\t}\n\n\tprotected onActivateKeyUp( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.state.isPressed ) {\n\t\t\t\tthis.start();\n\t\t\t}\n\t\t\tthis.state.isPressed = false;\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyDown( e );\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyUp( e );\n\t\t}\n\t\treturn super.onKeyUp( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DHtmlElement\";\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point, Rectangle } from \"pixi.js\";\nimport { DHtmlElement, DHtmlElementOptions, DThemeHtmlElement } from \"./d-html-element\";\nimport { UtilHtmlElementPadding } from \"./util/util-html-element\";\nimport { UtilInput, UtilInputOperation, UtilInputOptions, UtilThemeInput } from \"./util/util-input\";\n\nexport interface DInputOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeInput<VALUE> = DThemeInput<VALUE>\n> extends DHtmlElementOptions<VALUE, HTMLInputElement, THEME>, UtilInputOptions<VALUE> {\n\n}\n\nexport interface DThemeInput<VALUE = unknown> extends DThemeHtmlElement<VALUE, HTMLInputElement>, UtilThemeInput<VALUE> {\n\n}\n\nexport abstract class DInput<\n\tVALUE = unknown,\n\tTHEME extends DThemeInput<VALUE> = DThemeInput<VALUE>,\n\tOPTIONS extends DInputOptions<VALUE, THEME> = DInputOptions<VALUE, THEME>,\n\tUTIL extends UtilInput<VALUE> = UtilInput<VALUE>\n> extends DHtmlElement<VALUE, HTMLInputElement, THEME, OPTIONS, UTIL> {\n\tprotected newOperation(): UtilInputOperation<VALUE> {\n\t\treturn {\n\t\t\tgetElementRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getElementRect( resolution, work, result );\n\t\t\t},\n\n\t\t\tgetElementMatrix: (): Matrix | null => {\n\t\t\t\treturn null;\n\t\t\t},\n\n\t\t\tgetClipperRect: ( resolution: number, work: Point, result: Rectangle ): Rectangle | null => {\n\t\t\t\treturn this.getClipperRect( resolution, work, result );\n\t\t\t},\n\n\t\t\tgetPadding: (): UtilHtmlElementPadding | null => {\n\t\t\t\treturn this.padding;\n\t\t\t},\n\n\t\t\tcontainsPoint: ( point: Point ): boolean => {\n\t\t\t\treturn this.containsPoint( point );\n\t\t\t},\n\n\t\t\tonStart: (): void => {\n\t\t\t\tconst text = this._text;\n\t\t\t\tif( text != null ) {\n\t\t\t\t\ttext.visible = false;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonCancel: (): void => {\n\t\t\t\tconst text = this._text;\n\t\t\t\tif( text != null ) {\n\t\t\t\t\ttext.visible = true;\n\t\t\t\t}\n\t\t\t},\n\n\t\t\tonEnd: (): void => {\n\t\t\t\t// DO NOTHING\n\t\t\t},\n\n\t\t\tgetValue: (): VALUE | undefined => {\n\t\t\t\treturn this._textValueComputed;\n\t\t\t},\n\n\t\t\tonValueInput: ( newValue: VALUE ): void => {\n\t\t\t\tthis.onValueInput( newValue );\n\t\t\t},\n\n\t\t\tonValueChange: ( newValue: VALUE, oldValue: VALUE ): void => {\n\t\t\t\tthis.text = newValue;\n\t\t\t\tthis.onValueChange( newValue, oldValue );\n\t\t\t},\n\n\t\t\tonEnter: (): void => {\n\t\t\t\tthis.onEnter();\n\t\t\t},\n\n\t\t\tapplyTitle: (): void => {\n\t\t\t\tthis.applyTitle();\n\t\t\t}\n\t\t};\n\t}\n\n\tget value(): VALUE {\n\t\treturn this._textValueComputed!;\n\t}\n\n\tset value( value: VALUE ) {\n\t\tthis.text = value;\n\t}\n\n\tprotected onTextChange(): void {\n\t\tsuper.onTextChange();\n\t\tthis.validate();\n\t}\n\n\tprotected onValueChange( newValue: VALUE, oldValue: VALUE ): void {\n\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t}\n\n\tprotected onValueInput( newValue: VALUE ): void {\n\t\tthis.emit( \"input\", newValue, this );\n\t}\n\n\tprotected onEnter(): void {\n\t\tthis.emit( \"enter\", this );\n\t}\n\n\tvalidate(): string | null {\n\t\treturn this.getUtil().validate();\n\t}\n\n\tprotected applyTitle(): void {\n\t\tif( ! this.getUtil().applyTitle() ) {\n\t\t\tsuper.applyTitle();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DInput\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInput, DInputOptions, DThemeInput } from \"./d-input\";\nimport { UtilInputNumber, UtilInputNumberOptions, UtilThemeInputNumber } from \"./util/util-input-number\";\n\nexport interface DInputNumberOptions<\n\tTHEME extends DThemeInputNumber = DThemeInputNumber\n> extends DInputOptions<number, THEME>, UtilInputNumberOptions {\n\n}\n\nexport interface DThemeInputNumber extends DThemeInput<number>, UtilThemeInputNumber {\n\n}\n\nexport abstract class DInputNumber<\n\tTHEME extends DThemeInputNumber = DThemeInputNumber,\n\tOPTIONS extends DInputNumberOptions<THEME> = DInputNumberOptions<THEME>\n> extends DInput<number, THEME, OPTIONS, UtilInputNumber> {\n\tprotected newUtil(): UtilInputNumber {\n\t\treturn new UtilInputNumber(\n\t\t\tthis, this.newOperation(), this.theme, this._options\n\t\t);\n\t}\n\n\tget step(): number | null {\n\t\treturn this.getUtil().step;\n\t}\n\n\tset step( step: number | null ) {\n\t\tthis.getUtil().step = step;\n\t}\n\n\tget min(): number | null {\n\t\treturn this.getUtil().min;\n\t}\n\n\tset min( min: number | null ) {\n\t\tthis.getUtil().min = min;\n\t}\n\n\tget max(): number | null {\n\t\treturn this.getUtil().max;\n\t}\n\n\tset max( max: number | null ) {\n\t\tthis.getUtil().max = max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputNumber, DInputNumberOptions, DThemeInputNumber } from \"./d-input-number\";\n\nexport interface DInputIntegerOptions<\n\tTHEME extends DThemeInputInteger = DThemeInputInteger\n> extends DInputNumberOptions<THEME> {\n\n}\n\nexport interface DThemeInputInteger extends DThemeInputNumber {\n}\n\nexport class DInputInteger<\n\tTHEME extends DThemeInputInteger = DThemeInputInteger,\n\tOPTIONS extends DInputIntegerOptions<THEME> = DInputIntegerOptions<THEME>\n> extends DInputNumber<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputInteger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInput, DDialogInputOptions, DThemeDialogInput } from \"./d-dialog-input\";\nimport { DInputInteger, DInputIntegerOptions } from \"./d-input-integer\";\n\nexport interface DDialogInputIntegerOptions<\n\tTHEME extends DThemeDialogInputInteger\n> extends DDialogInputOptions<number, DInputIntegerOptions, THEME> {\n\n}\n\nexport interface DThemeDialogInputInteger extends DThemeDialogInput {\n\n}\n\nexport class DDialogInputInteger<\n\tTHEME extends DThemeDialogInputInteger = DThemeDialogInputInteger,\n\tOPTIONS extends DDialogInputIntegerOptions<THEME> = DDialogInputIntegerOptions<THEME>\n> extends DDialogInput<number, DInputInteger, DInputIntegerOptions, THEME, OPTIONS> {\n\tprotected newInput( options?: DInputIntegerOptions ): DInputInteger {\n\t\tconst result = new DInputInteger( this.toInputOptions( options ) );\n\t\tresult.on( \"enter\", () => {\n\t\t\tthis.ok();\n\t\t});\n\t\treturn result;\n\t}\n\n\tprotected toInputOptions( options?: DInputIntegerOptions ): DInputIntegerOptions {\n\t\tif( options ) {\n\t\t\tif( options.weight === undefined ) {\n\t\t\t\toptions.weight = 1;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tweight: 1\n\t\t};\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogInputInteger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInputInteger } from \"../../d-dialog-input-integer\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeOpenDialog } from \"./e-shape-action-runtime-open-dialog\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDialogInteger extends EShapeActionRuntimeOpenDialog<number> {\n\tprotected static DIALOG?: DDialogInputInteger;\n\tprotected initial: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value );\n\t\tthis.initial = EShapeActionExpressions.ofNumber( value.initial );\n\t}\n\n\tprotected open( target: string, initial: number ): Promise<number> {\n\t\tlet dialog = EShapeActionRuntimeOpenDialogInteger.DIALOG;\n\t\tif( dialog == null ) {\n\t\t\tdialog = new DDialogInputInteger({\n\t\t\t\tlabel: target\n\t\t\t});\n\t\t\tEShapeActionRuntimeOpenDialogInteger.DIALOG = dialog;\n\t\t} else {\n\t\t\tconst label = dialog.label;\n\t\t\tif( label ) {\n\t\t\t\tlabel.text = target;\n\t\t\t}\n\t\t}\n\t\tdialog.value = initial;\n\t\treturn dialog.open();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputNumber, DInputNumberOptions, DThemeInputNumber } from \"./d-input-number\";\n\nexport interface DInputRealOptions<\n\tTHEME extends DThemeInputReal = DThemeInputReal\n> extends DInputNumberOptions<THEME> {\n\n}\n\nexport interface DThemeInputReal extends DThemeInputNumber {\n\n}\n\nexport class DInputReal<\n\tTHEME extends DThemeInputReal = DThemeInputReal,\n\tOPTIONS extends DInputRealOptions<THEME> = DInputRealOptions<THEME>\n> extends DInputNumber<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputReal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInput, DDialogInputOptions, DThemeDialogInput } from \"./d-dialog-input\";\nimport { DInputReal, DInputRealOptions } from \"./d-input-real\";\n\nexport interface DDialogInputRealOptions<\n\tTHEME extends DThemeDialogInputReal\n> extends DDialogInputOptions<number, DInputRealOptions, THEME> {\n\n}\n\nexport interface DThemeDialogInputReal extends DThemeDialogInput {\n\n}\n\nexport class DDialogInputReal<\n\tTHEME extends DThemeDialogInputReal = DThemeDialogInputReal,\n\tOPTIONS extends DDialogInputRealOptions<THEME> = DDialogInputRealOptions<THEME>\n> extends DDialogInput<number, DInputReal, DInputRealOptions, THEME, OPTIONS> {\n\tprotected newInput( options?: DInputRealOptions ): DInputReal {\n\t\tconst result = new DInputReal( this.toInputOptions( options ) );\n\t\tresult.on( \"enter\", () => {\n\t\t\tthis.ok();\n\t\t});\n\t\treturn result;\n\t}\n\n\tprotected toInputOptions( options?: DInputRealOptions ): DInputRealOptions | undefined {\n\t\tif( options ) {\n\t\t\tif( options.weight === undefined ) {\n\t\t\t\toptions.weight = 1;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tweight: 1\n\t\t};\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogInputReal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInputReal } from \"../../d-dialog-input-real\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeOpenDialog } from \"./e-shape-action-runtime-open-dialog\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDialogReal extends EShapeActionRuntimeOpenDialog<number> {\n\tprotected static DIALOG?: DDialogInputReal;\n\tprotected initial: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value );\n\t\tthis.initial = EShapeActionExpressions.ofNumber( value.initial );\n\t}\n\n\tprotected open( target: string, initial: number ): Promise<number> {\n\t\tlet dialog = EShapeActionRuntimeOpenDialogReal.DIALOG;\n\t\tif( dialog == null ) {\n\t\t\tdialog = new DDialogInputReal({\n\t\t\t\tlabel: target\n\t\t\t});\n\t\t\tEShapeActionRuntimeOpenDialogReal.DIALOG = dialog;\n\t\t} else {\n\t\t\tconst label = dialog.label;\n\t\t\tif( label ) {\n\t\t\t\tlabel.text = target;\n\t\t\t}\n\t\t}\n\t\tdialog.value = initial;\n\t\treturn dialog.open();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInput, DInputOptions, DThemeInput } from \"./d-input\";\nimport { UtilInputText, UtilInputTextOptions, UtilThemeInputText } from \"./util/util-input-text\";\n\nexport interface DInputTextOptions<\n\tTHEME extends DThemeInputText = DThemeInputText\n> extends DInputOptions<string, THEME>, UtilInputTextOptions {\n\n}\n\nexport interface DThemeInputText extends DThemeInput<string>, UtilThemeInputText {\n\n}\n\nexport class DInputText<\n\tTHEME extends DThemeInputText = DThemeInputText,\n\tOPTIONS extends DInputTextOptions<THEME> = DInputTextOptions<THEME>\n> extends DInput<string, THEME, OPTIONS, UtilInputText> {\n\tprotected newUtil(): UtilInputText {\n\t\treturn new UtilInputText(\n\t\t\tthis, this.newOperation(), this.theme, this._options\n\t\t);\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInput, DDialogInputOptions, DThemeDialogInput } from \"./d-dialog-input\";\nimport { DInputText, DInputTextOptions } from \"./d-input-text\";\n\nexport interface DDialogInputTextOptions<\n\tTHEME extends DThemeDialogInputText\n> extends DDialogInputOptions<string, DInputTextOptions, THEME> {\n\n}\n\nexport interface DThemeDialogInputText extends DThemeDialogInput {\n\n}\n\nexport class DDialogInputText<\n\tTHEME extends DThemeDialogInputText = DThemeDialogInputText,\n\tOPTIONS extends DDialogInputTextOptions<THEME> = DDialogInputTextOptions<THEME>\n> extends DDialogInput<string, DInputText, DInputTextOptions, THEME, OPTIONS> {\n\tprotected newInput( options?: DInputTextOptions ): DInputText {\n\t\tconst result = new DInputText( this.toInputOptions( options ) );\n\t\tresult.on( \"enter\", () => {\n\t\t\tthis.ok();\n\t\t});\n\t\treturn result;\n\t}\n\n\tprotected toInputOptions( options?: DInputTextOptions ): DInputTextOptions {\n\t\tif( options ) {\n\t\t\tif( options.weight === undefined ) {\n\t\t\t\toptions.weight = 1;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tweight: 1\n\t\t};\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogInputText } from \"../../d-dialog-input-text\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeOpenDialog } from \"./e-shape-action-runtime-open-dialog\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDialogText extends EShapeActionRuntimeOpenDialog<string> {\n\tprotected static DIALOG?: DDialogInputText;\n\tprotected initial: EShapeActionExpression<string>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value );\n\t\tthis.initial = EShapeActionExpressions.ofString( value.initial );\n\t}\n\n\tprotected open( target: string, initial: string ): Promise<string> {\n\t\tlet dialog = EShapeActionRuntimeOpenDialogText.DIALOG;\n\t\tif( dialog == null ) {\n\t\t\tdialog = new DDialogInputText({\n\t\t\t\tlabel: target\n\t\t\t});\n\t\t\tEShapeActionRuntimeOpenDialogText.DIALOG = dialog;\n\t\t} else {\n\t\t\tconst label = dialog.label;\n\t\t\tif( label ) {\n\t\t\t\tlabel.text = target;\n\t\t\t}\n\t\t}\n\t\tdialog.value = initial;\n\t\treturn dialog.open();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionRuntimes } from \"./e-shape-action-runtimes\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDiagram extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\tEShapeActionRuntimes.open( shape, target );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenPage extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\twindow.open( target );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenPageInplace extends EShapeActionRuntimeOpen {\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value, EShapeRuntimeReset.NONE );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst target = this.target( shape, time );\n\t\t\tif( target != null ) {\n\t\t\t\twindow.location.href = target;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\n\nexport interface DButtonAmbientOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonAmbient<VALUE> = DThemeButtonAmbient<VALUE>\n> extends DButtonOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonAmbient<VALUE = unknown> extends DThemeButton<VALUE> {\n\n}\n\nexport class DButtonAmbient<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonAmbient<VALUE> = DThemeButtonAmbient<VALUE>,\n\tOPTIONS extends DButtonAmbientOptions<VALUE, THEME> = DButtonAmbientOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonAmbient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DPickerDatetimeMask {\n\tNONE = 0,\n\tDATE = 1,\n\tHOURS = 2,\n\tMINUTES = 4,\n\tSECONDS = 8,\n\tTIME = HOURS | MINUTES | SECONDS,\n\tALL = DATE | TIME\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonBackOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonBack<VALUE> = DThemePickerDatetimeButtonBack<VALUE>\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonBack<VALUE = unknown> extends DThemeButtonAmbient<VALUE> {\n\n}\n\nexport class DPickerDatetimeButtonBack<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonBack<VALUE> = DThemePickerDatetimeButtonBack<VALUE>,\n\tOPTIONS extends DPickerDatetimeButtonBackOptions<VALUE, THEME> = DPickerDatetimeButtonBackOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonBack\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonDateOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonDate<VALUE> = DThemePickerDatetimeButtonDate<VALUE>\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonDate<VALUE = unknown> extends DThemeButtonAmbient<VALUE> {\n\n}\n\nexport class DPickerDatetimeButtonDate<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonDate<VALUE> = DThemePickerDatetimeButtonDate<VALUE>,\n\tOPTIONS extends DPickerDatetimeButtonDateOptions<VALUE, THEME> = DPickerDatetimeButtonDateOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPickerDatetimeButtonNextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonNext<VALUE> = DThemePickerDatetimeButtonNext<VALUE>\n> extends DButtonAmbientOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeButtonNext<VALUE = unknown> extends DThemeButtonAmbient<VALUE> {\n\n}\n\nexport class DPickerDatetimeButtonNext<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeButtonNext<VALUE> = DThemePickerDatetimeButtonNext<VALUE>,\n\tOPTIONS extends DPickerDatetimeButtonNextOptions<VALUE, THEME> = DPickerDatetimeButtonNextOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeButtonNext\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DPickerDatetimeLabelOptions<\n\tTHEME extends DThemePickerDatetimeLabel = DThemePickerDatetimeLabel\n> extends DTextOptions<Date, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeLabel extends DThemeText<Date> {\n\n}\n\nexport class DPickerDatetimeLabel<\n\tTHEME extends DThemePickerDatetimeLabel = DThemePickerDatetimeLabel,\n\tOPTIONS extends DPickerDatetimeLabelOptions<THEME> = DPickerDatetimeLabelOptions<THEME>\n> extends DText<Date, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DPickerDatetimeLabelDateOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabelDate<VALUE> = DThemePickerDatetimeLabelDate<VALUE>\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemePickerDatetimeLabelDate<VALUE = unknown> extends DThemeText<VALUE> {\n\n}\n\nexport class DPickerDatetimeLabelDate<\n\tVALUE = unknown,\n\tTHEME extends DThemePickerDatetimeLabelDate<VALUE> = DThemePickerDatetimeLabelDate<VALUE>,\n\tOPTIONS extends DPickerDatetimeLabelDateOptions<VALUE, THEME> = DPickerDatetimeLabelDateOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeLabelDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPickerDatetimeSpaceOptions<\n\tTHEME extends DThemePickerDatetimeSpace = DThemePickerDatetimeSpace\n> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerDatetimeSpace extends DThemeBase {\n\n}\n\nexport class DPickerDatetimeSpace<\n\tTHEME extends DThemePickerDatetimeSpace = DThemePickerDatetimeSpace,\n\tOPTIONS extends DPickerDatetimeSpaceOptions<THEME> = DPickerDatetimeSpaceOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.state.isFocusable = false;\n\t\tthis.renderable = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetimeSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DPickerDatetimeMaskOptions {\n\tmask?: keyof typeof DPickerDatetimeMask | Array<keyof typeof DPickerDatetimeMask> | DPickerDatetimeMask;\n}\n\nexport interface DPickerDatetimeMaskTheme {\n\tgetMask(): DPickerDatetimeMask;\n}\n\nexport class DPickerDatetimeMasks {\n\tstatic from( themeOrThemeName?: DPickerDatetimeMaskTheme | string, options?: DPickerDatetimeMaskOptions ): DPickerDatetimeMask {\n\t\tconst mask = options?.mask;\n\t\tif( mask == null ) {\n\t\t\tif( isString( themeOrThemeName ) ) {\n\t\t\t\tconst theme = DThemes.getInstance().get<DPickerDatetimeMaskTheme>( themeOrThemeName );\n\t\t\t\tif( theme != null ) {\n\t\t\t\t\treturn theme.getMask();\n\t\t\t\t}\n\t\t\t} else if( themeOrThemeName != null ) {\n\t\t\t\treturn themeOrThemeName.getMask();\n\t\t\t}\n\t\t\treturn DPickerDatetimeMask.NONE;\n\t\t} else if( isString( mask ) ) {\n\t\t\treturn DPickerDatetimeMask[ mask ];\n\t\t} else if( isNumber( mask ) ) {\n\t\t\treturn mask;\n\t\t}\n\t\tlet result = DPickerDatetimeMask.NONE;\n\t\tfor( let i = 0, imax = mask.length; i < imax; ++i ) {\n\t\t\tresult |= DPickerDatetimeMask[ mask[ i ] ];\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueShowHideType {\n\tSHOW,\n\tHIDE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport type DPickerTimeBoundDate = Date | null;\n\nexport interface DPickerTimeBoundOptions {\n\tdate?: DPickerTimeBoundDate;\n\tinclusive?: boolean;\n}\n\nexport class DPickerTimeBound {\n\tprotected _date: DPickerTimeBoundDate;\n\tprotected _inclusive: boolean;\n\tprotected _onChange: () => void;\n\n\tconstructor( options: DPickerTimeBoundOptions | undefined, onChange: () => void ) {\n\t\tthis._date = ( options && options.date !== undefined ? options.date : null );\n\t\tthis._inclusive = ( options && options.inclusive !== undefined ? options.inclusive : false );\n\t\tthis._onChange = onChange;\n\t}\n\n\tget date(): DPickerTimeBoundDate {\n\t\treturn this._date;\n\t}\n\n\tset date( date: DPickerTimeBoundDate ) {\n\t\tif( this._date !== date ) {\n\t\t\tthis._date = date;\n\t\t\tthis._onChange();\n\t\t}\n\t}\n\n\tget inclusive(): boolean {\n\t\treturn this._inclusive;\n\t}\n\n\tset inclusive( inclusive: boolean ) {\n\t\tif( this._inclusive !== inclusive ) {\n\t\t\tthis._inclusive = inclusive;\n\t\t\tthis._onChange();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundHoursParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundHours {\n\tprotected _parent: DPickerTimeBoundHoursParent;\n\n\tconstructor( parent: DPickerTimeBoundHoursParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.hour.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst lowerDateHours = lowerDate.getHours();\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn lowerDateHours;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( lowerDate.getSeconds() < constant.second.max ) {\n\t\t\t\t\t\treturn lowerDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\tif( lowerDate.getMinutes() < constant.minute.max ) {\n\t\t\t\t\t\treturn lowerDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn lowerDateHours + 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.hour.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.hour.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst upperDateHours = upperDate.getHours();\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn upperDateHours;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( constant.second.min < upperDate.getSeconds() ) {\n\t\t\t\t\t\treturn upperDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\tif( constant.minute.min < upperDate.getMinutes() ) {\n\t\t\t\t\t\treturn upperDateHours;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn upperDateHours - 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.hour.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundMinutesParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundMinutes {\n\tprotected _parent: DPickerTimeBoundMinutesParent;\n\n\tconstructor( parent: DPickerTimeBoundMinutesParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( lowerDate.getHours() < date.getHours() ) {\n\t\t\t\t\treturn constant.minute.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst lowerDateMinutes = lowerDate.getMinutes();\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn lowerDateMinutes;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( lowerDate.getSeconds() < constant.second.max ) {\n\t\t\t\t\t\treturn lowerDateMinutes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn lowerDateMinutes + 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.minute.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( date.getHours() < upperDate.getHours() ) {\n\t\t\t\t\treturn constant.minute.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst upperDateMinutes = upperDate.getMinutes();\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn upperDateMinutes;\n\t\t\t} else {\n\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\tif( constant.second.min < upperDate.getSeconds() ) {\n\t\t\t\t\t\treturn upperDateMinutes;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn upperDateMinutes - 1;\n\t\t\t}\n\t\t}\n\t\treturn constant.minute.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\n\nexport interface DPickerTimeBoundSecondsParent {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\tconstant: DPickerTimeBoundConstant;\n}\n\nexport class DPickerTimeBoundSeconds {\n\tprotected _parent: DPickerTimeBoundSecondsParent;\n\n\tconstructor( parent: DPickerTimeBoundSecondsParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmin( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst lower = parent.lower;\n\t\tconst lowerDate = lower.date;\n\t\tconst constant = parent.constant;\n\t\tif( lowerDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( lowerDate.getFullYear() < date.getFullYear() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getMonth() < date.getMonth() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t\tif( lowerDate.getDate() < date.getDate() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( lowerDate.getHours() < date.getHours() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\tif( lowerDate.getMinutes() < date.getMinutes() ) {\n\t\t\t\t\treturn constant.second.min;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn lowerDate.getSeconds() + ( lower.inclusive ? 0 : 1 );\n\t\t}\n\t\treturn constant.second.min;\n\t}\n\n\tmax( date: Date ): number {\n\t\tconst parent = this._parent;\n\t\tconst upper = parent.upper;\n\t\tconst upperDate = upper.date;\n\t\tconst constant = parent.constant;\n\t\tif( upperDate != null ) {\n\t\t\tconst mask = parent.mask;\n\t\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\tif( date.getFullYear() < upperDate.getFullYear() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t\tif( date.getMonth() < upperDate.getMonth() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t\tif( date.getDate() < upperDate.getDate() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\tif( date.getHours() < upperDate.getHours() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\tif( date.getMinutes() < upperDate.getMinutes() ) {\n\t\t\t\t\treturn constant.second.max;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn upperDate.getSeconds() - ( upper.inclusive ? 0 : 1 );\n\t\t}\n\t\treturn constant.second.max;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimeBound, DPickerTimeBoundOptions } from \"./d-picker-time-bound\";\nimport { DPickerTimeBoundConstant } from \"./d-picker-time-bound-constant\";\nimport { DPickerTimeBoundHours } from \"./d-picker-time-bound-hours\";\nimport { DPickerTimeBoundMinutes } from \"./d-picker-time-bound-minutes\";\nimport { DPickerTimeBoundSeconds } from \"./d-picker-time-bound-seconds\";\n\nexport interface DPickerTimeBoundsOptions {\n\tlower?: DPickerTimeBoundOptions;\n\tupper?: DPickerTimeBoundOptions;\n}\n\nexport class DPickerTimeBounds {\n\tlower: DPickerTimeBound;\n\tupper: DPickerTimeBound;\n\tmask: DPickerDatetimeMask;\n\thours: DPickerTimeBoundHours;\n\tminutes: DPickerTimeBoundMinutes;\n\tseconds: DPickerTimeBoundSeconds;\n\tconstant: DPickerTimeBoundConstant;\n\n\tconstructor( options: DPickerTimeBoundsOptions | undefined, onChange: () => void ) {\n\t\tthis.constant = this.newConstant();\n\t\tthis.lower = new DPickerTimeBound( options && options.lower, onChange );\n\t\tthis.upper = new DPickerTimeBound( options && options.upper, onChange );\n\t\tthis.mask = DPickerDatetimeMask.ALL;\n\t\tthis.hours = new DPickerTimeBoundHours( this );\n\t\tthis.minutes = new DPickerTimeBoundMinutes( this );\n\t\tthis.seconds = new DPickerTimeBoundSeconds( this );\n\t}\n\n\tnewConstant(): DPickerTimeBoundConstant {\n\t\treturn {\n\t\t\tsecond: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 59\n\t\t\t},\n\n\t\t\tminute: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 59\n\t\t\t},\n\n\t\t\thour: {\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 23\n\t\t\t}\n\t\t};\n\t}\n\n\tadjust( date: Date ): boolean {\n\t\tconst result = this.test( date );\n\t\tif( result < 0 ) {\n\t\t\tconst lower = this.lower;\n\t\t\tconst lowerDate = lower.date;\n\t\t\tif( lowerDate ) {\n\t\t\t\tdate.setTime( lowerDate.getTime() );\n\t\t\t\tif( ! lower.inclusive ) {\n\t\t\t\t\tconst mask = this.mask;\n\t\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\t\tdate.setSeconds( lowerDate.getSeconds() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\t\tdate.setMinutes( lowerDate.getMinutes() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\t\t\tdate.setHours( lowerDate.getHours() + 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\t\t\tdate.setDate( lowerDate.getDate() + 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else if( 0 < result ) {\n\t\t\tconst upper = this.upper;\n\t\t\tconst upperDate = upper.date;\n\t\t\tif( upperDate ) {\n\t\t\t\tdate.setTime( upperDate.getTime() );\n\t\t\t\tif( ! upper.inclusive ) {\n\t\t\t\t\tconst mask = this.mask;\n\t\t\t\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\t\t\t\tdate.setSeconds( upperDate.getSeconds() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\t\t\t\tdate.setMinutes( upperDate.getMinutes() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\t\t\t\tdate.setHours( upperDate.getHours() - 1 );\n\t\t\t\t\t} else if( mask & DPickerDatetimeMask.DATE ) {\n\t\t\t\t\t\tdate.setDate( upperDate.getDate() - 1 );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tcompare( a: Date, b: Date ): number {\n\t\tconst mask = this.mask;\n\t\tif( mask & DPickerDatetimeMask.DATE ) {\n\t\t\tconst ay = a.getFullYear();\n\t\t\tconst by = b.getFullYear();\n\t\t\tif( ay !== by ) {\n\t\t\t\treturn ( ay < by ? -1 : +1 );\n\t\t\t}\n\n\t\t\tconst am = a.getMonth();\n\t\t\tconst bm = b.getMonth();\n\t\t\tif( am !== bm ) {\n\t\t\t\treturn ( am < bm ? -1 : +1 );\n\t\t\t}\n\n\t\t\tconst ad = a.getDate();\n\t\t\tconst bd = b.getDate();\n\t\t\tif( ad !== bd ) {\n\t\t\t\treturn ( ad < bd ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\tconst ah = a.getHours();\n\t\t\tconst bh = b.getHours();\n\t\t\tif( ah !== bh ) {\n\t\t\t\treturn ( ah < bh ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\tconst am = a.getMinutes();\n\t\t\tconst bm = b.getMinutes();\n\t\t\tif( am !== bm ) {\n\t\t\t\treturn ( am < bm ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\tconst ad = a.getSeconds();\n\t\t\tconst bd = b.getSeconds();\n\t\t\tif( ad !== bd ) {\n\t\t\t\treturn ( ad < bd ? -1 : +1 );\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\ttest( date: Date ): number {\n\t\t// Lower bound\n\t\tconst lower = this.lower;\n\t\tconst lowerDate = lower.date;\n\t\tif( lowerDate != null ) {\n\t\t\tconst result = this.compare( lowerDate, date );\n\t\t\tif( lower.inclusive ) {\n\t\t\t\treturn ( result <= 0 ? 0 : -1 );\n\t\t\t} else {\n\t\t\t\treturn ( result < 0 ? 0 : -1 );\n\t\t\t}\n\t\t}\n\n\t\t// Upper bound\n\t\tconst upper = this.upper;\n\t\tconst upperDate = upper.date;\n\t\tif( upperDate != null ) {\n\t\t\tconst result = this.compare( date, upperDate );\n\t\t\tif( upper.inclusive ) {\n\t\t\t\treturn ( result <= 0 ? 0 : +1 );\n\t\t\t} else {\n\t\t\t\treturn ( result < 0 ? 0 : +1 );\n\t\t\t}\n\t\t}\n\n\t\treturn 0;\n\t}\n\n\tcontains( date: Date ): boolean {\n\t\treturn this.test( date ) === 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DCoordinateSize } from \"./d-coordinate\";\nimport { DInputInteger, DInputIntegerOptions } from \"./d-input-integer\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimeMasks } from \"./d-picker-datetime-masks\";\nimport { DPickerTimeBoundDate, DPickerTimeBoundOptions } from \"./d-picker-time-bound\";\nimport { DPickerTimeBounds, DPickerTimeBoundsOptions } from \"./d-picker-time-bounds\";\nimport { DText } from \"./d-text\";\n\nexport interface DPickerTimeOptions<THEME extends DThemePickerTime = DThemePickerTime> extends DBaseOptions<THEME> {\n\tmargin?: number;\n\thours?: DInputIntegerOptions;\n\tminutes?: DInputIntegerOptions;\n\tseconds?: DInputIntegerOptions;\n\tmask?: keyof typeof DPickerDatetimeMask | Array<keyof typeof DPickerDatetimeMask> | DPickerDatetimeMask;\n\tbounds?: DPickerTimeBoundsOptions;\n}\n\nexport interface DThemePickerTime extends DThemeBase {\n\tgetMargin(): number;\n\tgetHoursOptions(): DInputIntegerOptions;\n\tgetMinutesOptions(): DInputIntegerOptions;\n\tgetSecondsOptions(): DInputIntegerOptions;\n\tgetMask(): DPickerDatetimeMask;\n\tgetLowerBound(): DPickerTimeBoundDate;\n\tisLowerBoundInclusive(): boolean;\n\tgetUpperBound(): DPickerTimeBoundDate;\n\tisUpperBoundInclusive(): boolean;\n}\n\nconst toBoundOptions = (\n\toptions: DPickerTimeBoundOptions | undefined,\n\tdate: DPickerTimeBoundDate,\n\tinclusive: boolean\n): DPickerTimeBoundOptions => {\n\tif( options ) {\n\t\treturn {\n\t\t\tdate: ( options.date !== undefined ? options.date : date ),\n\t\t\tinclusive: ( options.inclusive !== undefined ? options.inclusive : inclusive )\n\t\t};\n\t}\n\treturn {\n\t\tdate,\n\t\tinclusive\n\t};\n};\n\nconst toBoundsOptions = (\n\ttheme: DThemePickerTime,\n\toptions: DPickerTimeBoundsOptions | undefined\n): DPickerTimeBoundsOptions => {\n\tif( options ) {\n\t\treturn {\n\t\t\tlower: toBoundOptions(\n\t\t\t\toptions.lower,\n\t\t\t\ttheme.getLowerBound(),\n\t\t\t\ttheme.isLowerBoundInclusive()\n\t\t\t),\n\t\t\tupper: toBoundOptions(\n\t\t\t\toptions.upper,\n\t\t\t\ttheme.getUpperBound(),\n\t\t\t\ttheme.isUpperBoundInclusive()\n\t\t\t)\n\t\t};\n\t}\n\treturn {\n\t\tlower: {\n\t\t\tdate: theme.getLowerBound(),\n\t\t\tinclusive: theme.isLowerBoundInclusive()\n\t\t},\n\t\tupper: {\n\t\t\tdate: theme.getUpperBound(),\n\t\t\tinclusive: theme.isUpperBoundInclusive()\n\t\t}\n\t};\n};\n\nexport class DPickerTime<\n\tTHEME extends DThemePickerTime = DThemePickerTime,\n\tOPTIONS extends DPickerTimeOptions<THEME> = DPickerTimeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _dateBounds!: DPickerTimeBounds;\n\tprotected _dateCurrent!: Date;\n\tprotected _dateNew!: Date;\n\tprotected _inputHours!: DInputInteger | null;\n\tprotected _inputMinutes!: DInputInteger | null;\n\tprotected _inputSeconds!: DInputInteger | null;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.onNewChange();\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.state.isFocusable = false;\n\n\t\tconst theme = this.theme;\n\t\tthis._dateCurrent = new Date();\n\t\tconst dateCurrentTime = this._dateCurrent.getTime();\n\t\tthis._dateNew = new Date( dateCurrentTime );\n\t\tthis._dateBounds = new DPickerTimeBounds(\n\t\t\ttoBoundsOptions( theme, options && options.bounds ),\n\t\t\t(): void => { this.onNewChange(); }\n\t\t);\n\t\tconst margin = ( options && options.margin != null ?\n\t\t\toptions.margin : theme.getMargin() );\n\t\tnew DLayoutVertical({\n\t\t\tparent: this,\n\t\t\tx: \"padding\", y: \"padding\",\n\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\tmargin,\n\t\t\tchildren: this.newChildren( theme, options, margin )\n\t\t});\n\t}\n\n\tget current(): Date {\n\t\treturn this._dateCurrent;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tif( this._dateCurrent.getTime() !== dateCurrent.getTime() ) {\n\t\t\tthis._dateCurrent = dateCurrent;\n\t\t}\n\t}\n\n\tget new(): Date {\n\t\treturn this._dateNew;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tif( this._dateNew.getTime() !== dateNew.getTime() ) {\n\t\t\tthis._dateNew = dateNew;\n\t\t\tthis.onNewChange();\n\t\t}\n\t}\n\n\tget bounds(): DPickerTimeBounds {\n\t\treturn this._dateBounds;\n\t}\n\n\thasHours(): boolean {\n\t\treturn this._inputHours != null;\n\t}\n\n\thasMinutes(): boolean {\n\t\treturn this._inputMinutes != null;\n\t}\n\n\thasSeconds(): boolean {\n\t\treturn this._inputSeconds != null;\n\t}\n\n\treset(): void {\n\t\tconst currentTime = this._dateCurrent.getTime();\n\t\tthis._dateNew.setTime( currentTime );\n\t\tthis.onReset();\n\t}\n\n\tprotected onReset(): void {\n\t\tthis.onNewChange();\n\t}\n\n\tprotected onNewChange(): void {\n\t\tconst dateNew = this._dateNew;\n\t\tconst dateBounds = this._dateBounds;\n\t\tdateBounds.adjust( this._dateNew );\n\n\t\tconst inputHours = this._inputHours;\n\t\tif( inputHours ) {\n\t\t\tconst hours = dateBounds.hours;\n\t\t\tinputHours.value = dateNew.getHours();\n\t\t\tinputHours.min = hours.min( dateNew );\n\t\t\tinputHours.max = hours.max( dateNew );\n\t\t}\n\n\t\tconst inputMinutes = this._inputMinutes;\n\t\tif( inputMinutes ) {\n\t\t\tconst minutes = dateBounds.minutes;\n\t\t\tinputMinutes.value = dateNew.getMinutes();\n\t\t\tinputMinutes.min = minutes.min( dateNew );\n\t\t\tinputMinutes.max = minutes.max( dateNew );\n\t\t}\n\n\t\tconst inputSeconds = this._inputSeconds;\n\t\tif( inputSeconds ) {\n\t\t\tconst seconds = dateBounds.seconds;\n\t\t\tinputSeconds.value = dateNew.getSeconds();\n\t\t\tinputSeconds.min = seconds.min( dateNew );\n\t\t\tinputSeconds.max = seconds.max( dateNew );\n\t\t}\n\t}\n\n\tprotected newChildren( theme: THEME, options: OPTIONS | undefined, margin: number ): Array<DisplayObject | null> {\n\t\tconst mask = DPickerDatetimeMasks.from( theme, options );\n\t\tthis._dateBounds.mask = mask;\n\t\tthis._inputHours = ( (mask & DPickerDatetimeMask.HOURS) ? this.newInputHours( theme, options ) : null );\n\t\tthis._inputMinutes = ( (mask & DPickerDatetimeMask.MINUTES) ? this.newInputMinutes( theme, options ) : null );\n\t\tthis._inputSeconds = ( (mask & DPickerDatetimeMask.SECONDS) ? this.newInputSeconds( theme, options ) : null );\n\t\treturn [\n\t\t\tthis.newTimeLayout(\n\t\t\t\tthis._inputHours,\n\t\t\t\tthis._inputMinutes,\n\t\t\t\tthis._inputSeconds,\n\t\t\t\tmargin\n\t\t\t)\n\t\t];\n\t}\n\n\tprotected newTimeLayout(\n\t\thours: DInputInteger | null,\n\t\tminutes: DInputInteger | null,\n\t\tseconds: DInputInteger | null,\n\t\tmargin: number\n\t): DLayoutHorizontal | null {\n\t\tconst children = this.newTimeLayoutChildren( hours, minutes, seconds );\n\t\tif( 0 < children.length ) {\n\t\t\treturn new DLayoutHorizontal({\n\t\t\t\twidth: this.getTimeLayoutWidth(),\n\t\t\t\theight: this.getTimeLayoutHeight(),\n\t\t\t\tmargin,\n\t\t\t\tchildren\n\t\t\t});\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getTimeLayoutWidth(): DCoordinateSize {\n\t\treturn \"auto\";\n\t}\n\n\tprotected getTimeLayoutHeight(): DCoordinateSize {\n\t\treturn \"auto\";\n\t}\n\n\tprotected newTimeLayoutChildren(\n\t\thours: DInputInteger | null,\n\t\tminutes: DInputInteger | null,\n\t\tseconds: DInputInteger | null\n\t): Array<DisplayObject | null> {\n\t\tconst result = [];\n\t\tif( hours != null ) {\n\t\t\tresult.push( hours );\n\t\t}\n\t\tif( minutes != null ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult.push( this.newMinuteSeparator() );\n\t\t\t}\n\t\t\tresult.push( minutes );\n\t\t}\n\t\tif( seconds != null ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult.push( this.newSecondSeparator() );\n\t\t\t}\n\t\t\tresult.push( seconds );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newMinuteSeparator(): DText | null {\n\t\treturn new DText({\n\t\t\twidth: \"auto\",\n\t\t\ttext: {\n\t\t\t\tvalue: this.getMinuteSeparator()\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMinuteSeparator(): string {\n\t\treturn \":\";\n\t}\n\n\tprotected newSecondSeparator(): DText | null {\n\t\treturn new DText({\n\t\t\twidth: \"auto\",\n\t\t\ttext: {\n\t\t\t\tvalue: this.getSecondSeparator()\n\t\t\t}\n\t\t});\n\t}\n\n\tgetSecondSeparator(): string {\n\t\treturn \":\";\n\t}\n\n\tprotected adjustInputOptions( theme: THEME, options: DInputIntegerOptions, max: number ): DInputIntegerOptions {\n\t\tif( options.step == null ) {\n\t\t\toptions.step = 1;\n\t\t}\n\t\tif( options.min == null ) {\n\t\t\toptions.min = 0;\n\t\t}\n\t\tif( options.max == null ) {\n\t\t\toptions.max = max;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected newInputHours( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.hours ) || theme.getHoursOptions();\n\t\tconst max = this._dateBounds.constant.hour.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onHoursChange( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onHoursChange( value: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tdateNew.setHours( value );\n\t\tthis.onNewChange();\n\t}\n\n\tprotected newInputMinutes( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.minutes ) || theme.getMinutesOptions();\n\t\tconst max = this._dateBounds.constant.minute.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onMinutesChange( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onMinutesChange( value: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tdateNew.setMinutes( value );\n\t\tthis.onNewChange();\n\t}\n\n\tprotected newInputSeconds( theme: THEME, options?: OPTIONS ): DInputInteger | null {\n\t\tconst inputOptions = ( options && options.seconds ) || theme.getSecondsOptions();\n\t\tconst max = this._dateBounds.constant.second.max;\n\t\tconst input = new DInputInteger( this.adjustInputOptions( theme, inputOptions, max ) );\n\t\tinput.on( \"change\", ( value: number ): void => {\n\t\t\tthis.onSecondsChange( value );\n\t\t});\n\t\treturn input;\n\t}\n\n\tprotected onSecondsChange( value: number ): void {\n\t\tthis._dateNew.setSeconds( value );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DCoordinateSize } from \"./d-coordinate\";\nimport { DInputIntegerOptions } from \"./d-input-integer\";\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetimeButtonBack, DPickerDatetimeButtonBackOptions } from \"./d-picker-datetime-button-back\";\nimport { DPickerDatetimeButtonDate } from \"./d-picker-datetime-button-date\";\nimport { DPickerDatetimeButtonNext, DPickerDatetimeButtonNextOptions } from \"./d-picker-datetime-button-next\";\nimport { DPickerDatetimeLabel, DPickerDatetimeLabelOptions } from \"./d-picker-datetime-label\";\nimport { DPickerDatetimeLabelDate } from \"./d-picker-datetime-label-date\";\nimport { DPickerDatetimeSpace } from \"./d-picker-datetime-space\";\nimport { DPickerTime, DPickerTimeOptions, DThemePickerTime } from \"./d-picker-time\";\n\nexport type DPickerDatetimeLabelFormatter = ( date: Date ) => string;\nexport type DPickerDatetimeDateDecorator = ( date: Date, button: DPickerDatetimeButtonDate ) => void;\nexport type DPickerDatetimeDayLabels = [ string, string, string, string, string, string, string ];\n\nexport interface DPickerDatetimeDayOptions {\n\tstart?: number;\n\tlabels?: DPickerDatetimeDayLabels;\n}\n\nexport interface DPickerDatetimeDateOptions {\n\tdecorator?: DPickerDatetimeDateDecorator;\n}\n\nexport interface DPickerDatetimeOptions<\n\tTHEME extends DThemePickerDatetime = DThemePickerDatetime\n> extends DPickerTimeOptions<THEME> {\n\tback?: DPickerDatetimeButtonBackOptions | null;\n\tnext?: DPickerDatetimeButtonNextOptions | null;\n\tday?: DPickerDatetimeDayOptions;\n\tlabel?: DPickerDatetimeLabelOptions;\n\tdate?: DPickerDatetimeDateOptions;\n}\n\nexport interface DThemePickerDatetime extends DThemePickerTime {\n\tgetDayLabels(): DPickerDatetimeDayLabels;\n\tgetDayStart(): number;\n\tgetLabelFormatter(): DPickerDatetimeLabelFormatter;\n\tgetDateDecorator(): DPickerDatetimeDateDecorator;\n\tgetBackButtonOptions(): DPickerDatetimeButtonBackOptions | null;\n\tgetNextButtonOptions(): DPickerDatetimeButtonNextOptions | null;\n}\n\nexport class DPickerDatetime<\n\tTHEME extends DThemePickerDatetime = DThemePickerDatetime,\n\tOPTIONS extends DPickerDatetimeOptions<THEME> = DPickerDatetimeOptions<THEME>\n> extends DPickerTime<THEME, OPTIONS> {\n\tprotected _datePage!: Date;\n\tprotected _dateButtons!: Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate>;\n\tprotected _dateDecorator!: DPickerDatetimeDateDecorator;\n\tprotected _label!: DPickerDatetimeLabel;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._datePage = new Date( this._dateCurrent.getTime() );\n\t}\n\n\tprotected newChildren( theme: THEME, options: OPTIONS | undefined, margin: number ): Array<DisplayObject | null> {\n\t\tthis._dateButtons = this.newDateButtons( theme, options );\n\t\tthis._dateDecorator = ( options && options.date && options.date.decorator ) ||\n\t\t\ttheme.getDateDecorator();\n\t\tthis._label = this.newLabel( theme, options );\n\t\tconst result = super.newChildren( theme, options, margin );\n\t\tresult.unshift(\n\t\t\tnew DLayoutHorizontal({\n\t\t\t\twidth: \"100%\", height: \"auto\",\n\t\t\t\tchildren: [\n\t\t\t\t\tthis.newBackButton( theme, options ),\n\t\t\t\t\tthis._label,\n\t\t\t\t\tthis.newNextButton( theme, options )\n\t\t\t\t]\n\t\t\t}),\n\t\t\tnew DLayoutHorizontal({\n\t\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\t\tmargin,\n\t\t\t\tchildren: this.newDateLabels( theme, options )\n\t\t\t}),\n\t\t\tnew DLayoutVertical({\n\t\t\t\twidth: \"auto\", height: \"auto\",\n\t\t\t\tmargin,\n\t\t\t\tcolumn: 7,\n\t\t\t\tchildren: this._dateButtons\n\t\t\t})\n\t\t);\n\t\treturn result;\n\t}\n\n\tget page(): Date {\n\t\treturn this._datePage;\n\t}\n\n\tset page( datePage: Date ) {\n\t\tif( this._datePage.getTime() !== datePage.getTime() ) {\n\t\t\tthis._datePage = datePage;\n\t\t\tthis.onPageChange();\n\t\t}\n\t}\n\n\tprotected onReset(): void {\n\t\tthis._datePage.setTime( this._dateCurrent.getTime() );\n\t\tsuper.onReset();\n\t}\n\n\tnext(): void {\n\t\tconst work = this._datePage;\n\t\twork.setFullYear( work.getFullYear(), work.getMonth() + 1, 1 );\n\t\twork.setHours( 0, 0, 0, 0 );\n\t\tthis.onPageChange();\n\t}\n\n\tback(): void {\n\t\tconst work = this._datePage;\n\t\twork.setFullYear( work.getFullYear(), work.getMonth() - 1, 1 );\n\t\twork.setHours( 0, 0, 0, 0 );\n\t\tthis.onPageChange();\n\t}\n\n\tonNewChange(): void {\n\t\tthis._dateBounds.adjust( this._datePage );\n\t\tsuper.onNewChange();\n\t\tthis.onPageChange();\n\t}\n\n\tprotected onPageChange(): void {\n\t\tconst buttons = this._dateButtons;\n\t\tconst bounds = this._dateBounds;\n\t\tconst datePage = this._datePage;\n\t\tconst dateNew = this._dateNew;\n\n\t\tconst tmp = new Date( datePage.getTime() );\n\t\ttmp.setDate( 1 );\n\t\ttmp.setHours( 0, 0, 0, 0 );\n\n\t\t// Spaces\n\t\tconst theme = this.theme;\n\t\tconst spaceCount = ( tmp.getDay() - theme.getDayStart() + 7 ) % 7;\n\t\tfor( let i = 0; i < spaceCount; ++i ) {\n\t\t\tbuttons[ i ].show();\n\t\t}\n\t\tfor( let i = spaceCount; i < 7; ++i ) {\n\t\t\tbuttons[ i ].hide();\n\t\t}\n\n\t\t// Date buttons\n\t\tconst dateDecorator = this._dateDecorator;\n\t\ttmp.setFullYear( tmp.getFullYear(), tmp.getMonth() + 1, 0 );\n\t\tconst dateCount = tmp.getDate();\n\t\tconst dateNewDate = ( dateNew.getFullYear() === tmp.getFullYear() &&\n\t\t\tdateNew.getMonth() === tmp.getMonth() ? dateNew.getDate() : 0 );\n\t\tfor( let i = 0; i < dateCount; ++i ) {\n\t\t\ttmp.setDate( i + 1 );\n\n\t\t\tconst button = buttons[ i + 7 ];\n\t\t\tbutton.state.isActive = dateNewDate === i + 1;\n\t\t\tbutton.state.isDisabled = ! bounds.contains( tmp );\n\t\t\tbutton.show();\n\n\t\t\tdateDecorator( tmp, button as DPickerDatetimeButtonDate );\n\t\t}\n\t\tfor( let i = dateCount; i < 31; ++i ) {\n\t\t\tconst button = buttons[ i + 7 ];\n\t\t\tbutton.state.isActive = false;\n\t\t\tbutton.hide();\n\t\t}\n\n\t\t// Label\n\t\ttmp.setTime( datePage.getTime() );\n\t\tthis._label.text = tmp;\n\t}\n\n\tprotected adjustInputOptions( theme: THEME, options: DInputIntegerOptions, max: number ): DInputIntegerOptions {\n\t\tif( options.weight == null ) {\n\t\t\toptions.weight = 1;\n\t\t}\n\t\treturn super.adjustInputOptions( theme, options, max );\n\t}\n\n\tprotected getTimeLayoutWidth(): DCoordinateSize {\n\t\treturn \"100%\";\n\t}\n\n\tprotected toLabelOptions( theme: THEME, options?: DPickerDatetimeOptions ): DPickerDatetimeLabelOptions {\n\t\tconst result = (options && options.label) || {};\n\t\tif( result.weight === undefined ) {\n\t\t\tresult.weight = 1;\n\t\t}\n\n\t\tif( result.padding === undefined ) {\n\t\t\tresult.padding = 0;\n\t\t}\n\n\t\tconst labelText = result.text = result.text || {};\n\t\tconst labelTextAlign = labelText.align = labelText.align || {};\n\t\tif( labelTextAlign.horizontal === undefined ) {\n\t\t\tlabelTextAlign.horizontal = \"CENTER\";\n\t\t}\n\n\t\tif( labelText.formatter === undefined ) {\n\t\t\tlabelText.formatter = theme.getLabelFormatter();\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newLabel( theme: THEME, options?: DPickerDatetimeOptions ): DPickerDatetimeLabel {\n\t\treturn new DPickerDatetimeLabel( this.toLabelOptions( theme, options ) );\n\t}\n\n\tprotected newBackButton( theme: THEME, options?: OPTIONS ): DPickerDatetimeButtonBack | null {\n\t\tconst buttonOptions = ( options && options.back !== undefined ?\n\t\t\toptions.back : theme.getBackButtonOptions() );\n\t\tif( buttonOptions != null ) {\n\t\t\tconst button = new DPickerDatetimeButtonBack( buttonOptions );\n\t\t\tbutton.on( \"active\", (): void => {\n\t\t\t\tthis.back();\n\t\t\t});\n\t\t\treturn button;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected newNextButton( theme: THEME, options?: OPTIONS ): DPickerDatetimeButtonNext | null {\n\t\tconst buttonOptions = ( options && options.next !== undefined ?\n\t\t\toptions.next : theme.getNextButtonOptions() );\n\t\tif( buttonOptions != null ) {\n\t\t\tconst button = new DPickerDatetimeButtonNext( buttonOptions );\n\t\t\tbutton.on( \"active\", (): void => {\n\t\t\t\tthis.next();\n\t\t\t});\n\t\t\treturn button;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected newDateLabels( theme: THEME, options: OPTIONS | undefined ): DPickerDatetimeLabelDate[] {\n\t\tconst dateLabels = theme.getDayLabels();\n\t\tconst dayStart = theme.getDayStart();\n\t\tconst result: DPickerDatetimeLabelDate[] = [];\n\t\tfor( let i = 0; i < 7; ++i ) {\n\t\t\tconst label = dateLabels[ (dayStart + i) % 7 ];\n\t\t\tresult.push(\n\t\t\t\tthis.newDateLabel( theme, options, label )\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newDateLabel( theme: THEME, options: OPTIONS | undefined, label: string ): DPickerDatetimeLabelDate {\n\t\treturn new DPickerDatetimeLabelDate({\n\t\t\ttext: {\n\t\t\t\tvalue: label\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newDateButtons(\n\t\ttheme: THEME, options: OPTIONS | undefined\n\t): Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate> {\n\t\tconst result: Array<DPickerDatetimeSpace | DPickerDatetimeButtonDate> = [];\n\t\tfor( let i = 0; i < 7; ++i ) {\n\t\t\tresult.push(\n\t\t\t\tthis.newSpace( theme, options )\n\t\t\t);\n\t\t}\n\t\tfor( let i = 1; i <= 31; ++i ) {\n\t\t\tresult.push(\n\t\t\t\tthis.newDateButton( theme, options, i )\n\t\t\t);\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newSpace( theme: THEME, options: OPTIONS | undefined ): DPickerDatetimeSpace {\n\t\treturn new DPickerDatetimeSpace();\n\t}\n\n\tprotected newDateButton( theme: THEME, options: OPTIONS | undefined, date: number ): DPickerDatetimeButtonDate {\n\t\treturn new DPickerDatetimeButtonDate({\n\t\t\ttext: {\n\t\t\t\tvalue: String( date )\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tactive: (): void => {\n\t\t\t\t\tthis.onDateButtonClicked( date );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onDateButtonClicked( date: number ): void {\n\t\tconst dateNew = this._dateNew;\n\t\tif( dateNew.getDate() !== date ) {\n\t\t\tconst datePage = this._datePage;\n\t\t\tdateNew.setFullYear( datePage.getFullYear() );\n\t\t\tdateNew.setMonth( datePage.getMonth() );\n\t\t\tdateNew.setDate( date );\n\t\t\tthis.onNewChange();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDatetime, DPickerDatetimeOptions } from \"./d-picker-datetime\";\n\nexport interface DDialogDatetimeOptions<\n\tTHEME extends DThemeDialogDatetime = DThemeDialogDatetime\n> extends DDialogCommandOptions<Date, THEME> {\n\tpicker?: DPickerDatetimeOptions;\n}\n\nexport interface DThemeDialogDatetime extends DThemeDialogCommand {\n\n}\n\nexport class DDialogDatetime<\n\tTHEME extends DThemeDialogDatetime = DThemeDialogDatetime,\n\tOPTIONS extends DDialogDatetimeOptions<THEME> = DDialogDatetimeOptions<THEME>\n> extends DDialogCommand<Date, THEME, OPTIONS> {\n\tprotected _picker?: DPickerDatetime;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tlayout.addChild( this.picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this.picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis.picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this.picker.new;\n\t}\n\n\tset new( value: Date ) {\n\t\tthis.picker.new = value;\n\t}\n\n\tget page(): Date {\n\t\treturn this.picker.new;\n\t}\n\n\tset page( page: Date ) {\n\t\tthis.picker.page = page;\n\t}\n\n\tget picker(): DPickerDatetime {\n\t\tlet result = this._picker;\n\t\tif( result == null ) {\n\t\t\tresult = new DPickerDatetime( this._options?.picker );\n\t\t\tthis._picker = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getResolvedValue(): Date | PromiseLike<Date> {\n\t\treturn this.picker.new;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDatetime } from \"../../d-dialog-datetime\";\nimport { isNumber } from \"../../util/is-number\";\nimport { isString } from \"../../util/is-string\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeOpenDialog } from \"./e-shape-action-runtime-open-dialog\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDialogDatetime extends EShapeActionRuntimeOpenDialog<string, unknown> {\n\tprotected static DIALOG?: DDialogDatetime;\n\n\tprotected initial: EShapeActionExpression<unknown>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value );\n\t\tthis.initial = EShapeActionExpressions.ofUnknown( value.initial );\n\t}\n\n\tprotected open( target: string, initial: unknown ): Promise<string> {\n\t\tlet dialog = EShapeActionRuntimeOpenDialogDatetime.DIALOG;\n\t\tif( dialog == null ) {\n\t\t\tdialog = new DDialogDatetime();\n\t\t\tEShapeActionRuntimeOpenDialogDatetime.DIALOG = dialog;\n\t\t}\n\t\tdialog.new = dialog.current = this.toDate( initial );\n\t\treturn dialog.open().then( ( value ) => {\n\t\t\treturn value.toISOString();\n\t\t});\n\t}\n\n\tprotected toDate( value: unknown ): Date {\n\t\tif( isString( value ) || isNumber( value ) ) {\n\t\t\treturn new Date( value );\n\t\t} else if( value instanceof Date ) {\n\t\t\treturn value;\n\t\t} else {\n\t\t\treturn new Date();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerTime, DPickerTimeOptions } from \"./d-picker-time\";\n\nexport interface DDialogTimeOptions<\n\tTHEME extends DThemeDialogTime = DThemeDialogTime\n> extends DDialogCommandOptions<Date, THEME> {\n\tpicker?: DPickerTimeOptions;\n}\n\nexport interface DThemeDialogTime extends DThemeDialogCommand {\n\n}\n\nexport class DDialogTime<\n\tTHEME extends DThemeDialogTime = DThemeDialogTime,\n\tOPTIONS extends DDialogTimeOptions<THEME> = DDialogTimeOptions<THEME>\n> extends DDialogCommand<Date, THEME, OPTIONS> {\n\tprotected _picker?: DPickerTime;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tlayout.addChild( this.picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this.picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis.picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this.picker.new;\n\t}\n\n\tset new( dateNew: Date ) {\n\t\tthis.picker.new = dateNew;\n\t}\n\n\tget picker(): DPickerTime {\n\t\tlet result = this._picker;\n\t\tif( result == null ) {\n\t\t\tresult = new DPickerTime( this._options?.picker );\n\t\t\tthis._picker = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getResolvedValue(): Date | PromiseLike<Date> {\n\t\treturn this.picker.new;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const isNaN = ( target: number ): boolean => {\n\treturn target !== target;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogTime } from \"../../d-dialog-time\";\nimport { isNaN } from \"../../util/is-nan\";\nimport { isNumber } from \"../../util/is-number\";\nimport { isString } from \"../../util/is-string\";\nimport { NumberFormatter } from \"../../util/number-formatter\";\nimport { NumberFormatters } from \"../../util/number-formatters\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeOpenDialog } from \"./e-shape-action-runtime-open-dialog\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDialogTime extends EShapeActionRuntimeOpenDialog<string, unknown> {\n\tprotected static DIALOG?: DDialogTime;\n\tprotected static PATTERN?: RegExp;\n\tprotected static FORMATTER?: NumberFormatter;\n\n\tprotected initial: EShapeActionExpression<unknown>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value );\n\t\tthis.initial = EShapeActionExpressions.ofUnknown( value.initial );\n\t}\n\n\tprotected open( target: string, initial: unknown ): Promise<string> {\n\t\tlet dialog = EShapeActionRuntimeOpenDialogTime.DIALOG;\n\t\tif( dialog == null ) {\n\t\t\tdialog = new DDialogTime();\n\t\t\tEShapeActionRuntimeOpenDialogTime.DIALOG = dialog;\n\t\t}\n\t\tdialog.new = dialog.current = this.toDate( initial );\n\t\treturn dialog.open().then(( value ) => {\n\t\t\treturn this.getFormatter().format( value.getTime(), 0 );\n\t\t});\n\t}\n\n\tprotected toDate( value: unknown ): Date {\n\t\tif( isNumber( value ) ) {\n\t\t\treturn new Date( value );\n\t\t} else if( isString( value ) ) {\n\t\t\tconst result = new Date();\n\t\t\tconst pattern = this.getPattern();\n\t\t\tconst matched = pattern.exec( value );\n\t\t\tif( matched != null ) {\n\t\t\t\tconst hours = this.toHours( matched[ 1 ] );\n\t\t\t\tif( hours != null ) {\n\t\t\t\t\tresult.setHours( hours );\n\t\t\t\t}\n\t\t\t\tconst minutes = this.toMinutes( matched[ 2 ] );\n\t\t\t\tif( minutes != null ) {\n\t\t\t\t\tresult.setMinutes( minutes );\n\t\t\t\t}\n\t\t\t\tconst seconds = this.toSeconds( matched[ 3 ] );\n\t\t\t\tif( seconds != null ) {\n\t\t\t\t\tresult.setSeconds( seconds );\n\t\t\t\t}\n\t\t\t\tconst milliseconds = this.toMilliseconds( matched[ 4 ] );\n\t\t\t\tif( milliseconds != null ) {\n\t\t\t\t\tresult.setMilliseconds( milliseconds );\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn result;\n\t\t} else if( value instanceof Date ) {\n\t\t\treturn value;\n\t\t} else {\n\t\t\treturn new Date();\n\t\t}\n\t}\n\n\tprotected toHours( value: string ): number | null {\n\t\treturn this.toNumber( value, 0, 23 );\n\t}\n\n\tprotected toMinutes( value: string ): number | null {\n\t\treturn this.toNumber( value, 0, 59 );\n\t}\n\n\tprotected toSeconds( value: string ): number | null {\n\t\treturn this.toNumber( value, 0, 59 );\n\t}\n\n\tprotected toMilliseconds( value: string ): number | null {\n\t\tconst result = this.toNumber( value, 0, 999 );\n\t\tif( result != null ) {\n\t\t\tconst length = value.length;\n\t\t\tif( length === 1 ) {\n\t\t\t\treturn result * 100;\n\t\t\t} else if( length === 2 ) {\n\t\t\t\treturn result * 10;\n\t\t\t} else {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected toNumber( value: string, min: number, max: number ): number | null {\n\t\tif( value != null ) {\n\t\t\tconst num = +value;\n\t\t\tif( ! isNaN( num ) ) {\n\t\t\t\treturn Math.min( max, Math.max( min, num ) );\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getPattern(): RegExp {\n\t\tlet result = EShapeActionRuntimeOpenDialogTime.PATTERN;\n\t\tif( result == null ) {\n\t\t\tresult = this.newPattern();\n\t\t\tEShapeActionRuntimeOpenDialogTime.PATTERN = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newPattern(): RegExp {\n\t\treturn /^\\s*(?:(\\d+)(?::(\\d+)(?::(\\d+))?)?)?(?:\\.(\\d+))?\\s*$/;\n\t}\n\n\tprotected getFormatter(): NumberFormatter {\n\t\tlet result = EShapeActionRuntimeOpenDialogTime.FORMATTER;\n\t\tif( result == null ) {\n\t\t\tresult = this.newFormatter();\n\t\t\tEShapeActionRuntimeOpenDialogTime.FORMATTER = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newFormatter() {\n\t\treturn NumberFormatters.create( \"%Hm\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetime, DPickerDatetimeOptions, DThemePickerDatetime } from \"./d-picker-datetime\";\n\nexport interface DPickerDateOptions<\n\tTHEME extends DThemePickerDate = DThemePickerDate\n> extends DPickerDatetimeOptions<THEME> {\n\n}\n\nexport interface DThemePickerDate extends DThemePickerDatetime {\n\n}\n\nexport class DPickerDate<\n\tTHEME extends DThemePickerDate = DThemePickerDate,\n\tOPTIONS extends DPickerDateOptions<THEME> = DPickerDateOptions<THEME>\n> extends DPickerDatetime<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DPickerDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerDate, DPickerDateOptions } from \"./d-picker-date\";\n\nexport interface DDialogDateOptions<\n\tTHEME extends DThemeDialogDate = DThemeDialogDate\n> extends DDialogCommandOptions<Date, THEME> {\n\tpicker?: DPickerDateOptions;\n}\n\nexport interface DThemeDialogDate extends DThemeDialogCommand {\n\n}\n\nexport class DDialogDate<\n\tTHEME extends DThemeDialogDate = DThemeDialogDate,\n\tOPTIONS extends DDialogDateOptions<THEME> = DDialogDateOptions<THEME>\n> extends DDialogCommand<Date, THEME, OPTIONS> {\n\tprotected _picker?: DPickerDate;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tlayout.addChild( this.picker );\n\t}\n\n\tget current(): Date {\n\t\treturn this.picker.current;\n\t}\n\n\tset current( dateCurrent: Date ) {\n\t\tthis.picker.current = dateCurrent;\n\t}\n\n\tget new(): Date {\n\t\treturn this.picker.new;\n\t}\n\n\tset new( value: Date ) {\n\t\tthis.picker.new = value;\n\t}\n\n\tget page(): Date {\n\t\treturn this.picker.new;\n\t}\n\n\tset page( page: Date ) {\n\t\tthis.picker.page = page;\n\t}\n\n\tget picker(): DPickerDate {\n\t\tlet result = this._picker;\n\t\tif( result == null ) {\n\t\t\tresult = new DPickerDate( this._options?.picker );\n\t\t\tthis._picker = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getResolvedValue(): Date | PromiseLike<Date> {\n\t\treturn this.picker.new;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDate } from \"../../d-dialog-date\";\nimport { isNumber } from \"../../util/is-number\";\nimport { isString } from \"../../util/is-string\";\nimport { NumberFormatter } from \"../../util/number-formatter\";\nimport { NumberFormatters } from \"../../util/number-formatters\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeOpenDialog } from \"./e-shape-action-runtime-open-dialog\";\nimport { EShapeActionValueOpen } from \"./e-shape-action-value-open\";\n\nexport class EShapeActionRuntimeOpenDialogDate extends EShapeActionRuntimeOpenDialog<string, unknown> {\n\tprotected static DIALOG?: DDialogDate;\n\tprotected static FORMATTER?: NumberFormatter;\n\n\tprotected initial: EShapeActionExpression<unknown>;\n\n\tconstructor( value: EShapeActionValueOpen ) {\n\t\tsuper( value );\n\t\tthis.initial = EShapeActionExpressions.ofUnknown( value.initial );\n\t}\n\n\tprotected open( target: string, initial: unknown ): Promise<string> {\n\t\tlet dialog = EShapeActionRuntimeOpenDialogDate.DIALOG;\n\t\tif( dialog == null ) {\n\t\t\tdialog = new DDialogDate();\n\t\t\tEShapeActionRuntimeOpenDialogDate.DIALOG = dialog;\n\t\t}\n\t\tdialog.new = dialog.current = this.toDate( initial );\n\t\treturn dialog.open().then( ( value ) => {\n\t\t\treturn this.getFormatter().format( value.getTime(), 0 );\n\t\t});\n\t}\n\n\tprotected toDate( value: unknown ): Date {\n\t\tif( isString( value ) || isNumber( value ) ) {\n\t\t\treturn new Date( value );\n\t\t} else if( value instanceof Date ) {\n\t\t\treturn value;\n\t\t} else {\n\t\t\treturn new Date();\n\t\t}\n\t}\n\n\tprotected getFormatter(): NumberFormatter {\n\t\tlet result = EShapeActionRuntimeOpenDialogDate.FORMATTER;\n\t\tif( result == null ) {\n\t\t\tresult = this.newFormatter();\n\t\t\tEShapeActionRuntimeOpenDialogDate.FORMATTER = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newFormatter() {\n\t\treturn NumberFormatters.create( \"%Y-%M-%D\" );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeOpen } from \"./e-shape-action-runtime-open\";\nimport { EShapeActionRuntimeOpenDialogBoolean } from \"./e-shape-action-runtime-open-dialog-boolean\";\nimport { EShapeActionRuntimeOpenDialogInteger } from \"./e-shape-action-runtime-open-dialog-integer\";\nimport { EShapeActionRuntimeOpenDialogReal } from \"./e-shape-action-runtime-open-dialog-real\";\nimport { EShapeActionRuntimeOpenDialogText } from \"./e-shape-action-runtime-open-dialog-text\";\nimport { EShapeActionRuntimeOpenDiagram } from \"./e-shape-action-runtime-open-diagram\";\nimport { EShapeActionRuntimeOpenPage } from \"./e-shape-action-runtime-open-page\";\nimport { EShapeActionRuntimeOpenPageInplace } from \"./e-shape-action-runtime-open-page-inplace\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOnInputAction } from \"./e-shape-action-value-on-input-action\";\nimport { EShapeActionValueOpenType } from \"./e-shape-action-value-open-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\nimport { EShapeActionRuntimeOpenDialogDatetime } from \"./e-shape-action-runtime-open-dialog-datetime\";\nimport { EShapeActionRuntimeOpenDialogTime } from \"./e-shape-action-runtime-open-dialog-time\";\nimport { EShapeActionRuntimeOpenDialogDate } from \"./e-shape-action-runtime-open-dialog-date\";\n\nexport type EShapeActionValueOpenSerialized = [\n\tEShapeActionValueType.OPEN, number, EShapeActionValueOpenType, number, EShapeActionValueOnInputAction, number\n];\n\nexport class EShapeActionValueOpen extends EShapeActionValueSubtyped<EShapeActionValueOpenType> {\n\treadonly target: string;\n\treadonly onInputAction: EShapeActionValueOnInputAction;\n\treadonly initial: string;\n\n\tconstructor(\n\t\tsubtype: EShapeActionValueOpenType,\n\t\tcondition: string,\n\t\ttarget: string,\n\t\tonInputAction: EShapeActionValueOnInputAction,\n\t\tinitial: string\n\t) {\n\t\tsuper( EShapeActionValueType.OPEN, condition, subtype );\n\t\tthis.target = target;\n\t\tthis.onInputAction = onInputAction;\n\t\tthis.initial = initial;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueOpen) &&\n\t\t\tthis.target === value.target\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeOpen {\n\t\tswitch( this.subtype ) {\n\t\tcase EShapeActionValueOpenType.DIAGRAM:\n\t\t\treturn new EShapeActionRuntimeOpenDiagram( this );\n\t\tcase EShapeActionValueOpenType.PAGE:\n\t\t\treturn new EShapeActionRuntimeOpenPage( this );\n\t\tcase EShapeActionValueOpenType.PAGE_INPLACE:\n\t\t\treturn new EShapeActionRuntimeOpenPageInplace( this );\n\t\tcase EShapeActionValueOpenType.DIALOG_TEXT:\n\t\t\treturn new EShapeActionRuntimeOpenDialogText( this );\n\t\tcase EShapeActionValueOpenType.DIALOG_INTEGER:\n\t\t\treturn new EShapeActionRuntimeOpenDialogInteger( this );\n\t\tcase EShapeActionValueOpenType.DIALOG_REAL:\n\t\t\treturn new EShapeActionRuntimeOpenDialogReal( this );\n\t\tcase EShapeActionValueOpenType.DIALOG_BOOLEAN:\n\t\t\treturn new EShapeActionRuntimeOpenDialogBoolean( this );\n\t\tcase EShapeActionValueOpenType.DIALOG_DATE:\n\t\t\treturn new EShapeActionRuntimeOpenDialogDate( this );\n\t\tcase EShapeActionValueOpenType.DIALOG_TIME:\n\t\t\treturn new EShapeActionRuntimeOpenDialogTime( this );\n\t\tcase EShapeActionValueOpenType.DIALOG_DATETIME:\n\t\t\treturn new EShapeActionRuntimeOpenDialogDatetime( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\tconst targetId = manager.addResource(this.target);\n\t\tconst initialId = manager.addResource(this.initial);\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${targetId},${this.onInputAction},${initialId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueOpenSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueOpen {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst target = EShapeActionValues.toResource( 3, serialized, manager.resources );\n\t\tconst initial = EShapeActionValues.toResource( 5, serialized, manager.resources );\n\t\treturn new EShapeActionValueOpen( serialized[ 2 ], condition, target, serialized[ 4 ], initial );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueShowHide } from \"./e-shape-action-value-show-hide\";\nimport { EShapeActionValueShowHideType } from \"./e-shape-action-value-show-hide-type\";\n\nexport class EShapeActionRuntimeShowHide extends EShapeActionRuntimeConditional {\n\tvisibility: boolean;\n\n\tconstructor( value: EShapeActionValueShowHide ) {\n\t\tsuper( value, EShapeRuntimeReset.VISIBILITY );\n\t\tthis.visibility = ( value.subtype === EShapeActionValueShowHideType.SHOW );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tshape.visible = this.visibility;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformMoveType {\n\tRELATIVE_X,\n\tRELATIVE_Y,\n\tABSOLUTE_X,\n\tABSOLUTE_Y,\n\tFORWARD_OR_BACKWARD,\n\tLEFT_OR_RIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformType {\n\tRESIZE,\n\tMOVE,\n\tROTATE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeShowHide } from \"./e-shape-action-runtime-show-hide\";\nimport { EShapeActionValueShowHideType } from \"./e-shape-action-value-show-hide-type\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueShowHideSerialized = [\n\tEShapeActionValueType.SHOW_HIDE, number, EShapeActionValueShowHideType\n];\n\nexport class EShapeActionValueShowHide extends EShapeActionValueSubtyped<EShapeActionValueShowHideType> {\n\tconstructor( subtype: EShapeActionValueShowHideType, condition: string ) {\n\t\tsuper( EShapeActionValueType.SHOW_HIDE, condition, subtype );\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeShowHide {\n\t\treturn new EShapeActionRuntimeShowHide( this );\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\treturn manager.addResource( `[${this.type},${conditionId},${this.subtype}]` );\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueShowHideSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueShowHide {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\treturn new EShapeActionValueShowHide( serialized[ 2 ], condition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMove extends EShapeActionRuntimeConditional {\n\tprotected readonly amount: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformMove, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.amount = EShapeActionExpressions.ofNumber( value.amount );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveAbsoluteX extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_X );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tshape.transform.position.x = amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveAbsoluteY extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_Y );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tshape.transform.position.y = amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveForwardOrBackward extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst position = transform.position;\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tshape.updateTransform();\n\t\t\tconst localTransform = shape.transform.localTransform;\n\t\t\tposition.set( oldPositionX - localTransform.c * amount, oldPositionY - localTransform.d * amount );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveLeftOrRight extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst position = transform.position;\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tshape.updateTransform();\n\t\t\tconst localTransform = shape.transform.localTransform;\n\t\t\tposition.set( oldPositionX + localTransform.a * amount, oldPositionY + localTransform.b * amount );\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveRelativeX extends EShapeActionRuntimeTransformMove {\n\tconstructor( value: EShapeActionValueTransformMove ) {\n\t\tsuper( value, EShapeRuntimeReset.POSITION_X );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\t\tconst position = shape.transform.position;\n\t\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\t\tposition.x = oldPositionX + amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionValueTransformMove } from \"./e-shape-action-value-transform-move\";\n\nexport class EShapeActionRuntimeTransformMoveRelativeY extends EShapeActionRuntimeTransformMove {\n\tconstructor( action: EShapeActionValueTransformMove ) {\n\t\tsuper( action, EShapeRuntimeReset.POSITION_Y );\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\t\tconst position = shape.transform.position;\n\t\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\t\tposition.y = oldPositionY + amount;\n\t\t\truntime.written |= this.reset;\n\t\t}\n\t}\n}\n","import { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueSubtyped } from \"./e-shape-action-value-subtyped\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport abstract class EShapeActionValueOpetyped<\n\tSUBTYPE extends number,\n\tOPETYPE extends number\n> extends EShapeActionValueSubtyped<SUBTYPE> {\n\treadonly opetype: OPETYPE;\n\n\tconstructor( type: EShapeActionValueType, condition: string, subtype: SUBTYPE, opetype: OPETYPE ) {\n\t\tsuper( type, condition, subtype );\n\t\tthis.opetype = opetype;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueOpetyped) &&\n\t\t\tthis.opetype === value.opetype\n\t\t);\n\t}\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformMove } from \"./e-shape-action-runtime-transform-move\";\nimport { EShapeActionRuntimeTransformMoveAbsoluteX } from \"./e-shape-action-runtime-transform-move-absolute-x\";\nimport { EShapeActionRuntimeTransformMoveAbsoluteY } from \"./e-shape-action-runtime-transform-move-absolute-y\";\nimport {\n\tEShapeActionRuntimeTransformMoveForwardOrBackward\n} from \"./e-shape-action-runtime-transform-move-forward-or-backward\";\nimport { EShapeActionRuntimeTransformMoveLeftOrRight } from \"./e-shape-action-runtime-transform-move-left-or-right\";\nimport { EShapeActionRuntimeTransformMoveRelativeX } from \"./e-shape-action-runtime-transform-move-relative-x\";\nimport { EShapeActionRuntimeTransformMoveRelativeY } from \"./e-shape-action-runtime-transform-move-relative-y\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformMoveType } from \"./e-shape-action-value-transform-move-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformMoveSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.MOVE,\n\tEShapeActionValueTransformMoveType, number\n];\n\nexport class EShapeActionValueTransformMove\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformMoveType> {\n\treadonly amount: string;\n\n\tconstructor( opetype: EShapeActionValueTransformMoveType, condition: string, amount: string ) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.MOVE, opetype );\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformMove) &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformMove {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_X:\n\t\t\treturn new EShapeActionRuntimeTransformMoveAbsoluteX( this );\n\t\tcase EShapeActionValueTransformMoveType.ABSOLUTE_Y:\n\t\t\treturn new EShapeActionRuntimeTransformMoveAbsoluteY( this );\n\t\tcase EShapeActionValueTransformMoveType.FORWARD_OR_BACKWARD:\n\t\t\treturn new EShapeActionRuntimeTransformMoveForwardOrBackward( this );\n\t\tcase EShapeActionValueTransformMoveType.LEFT_OR_RIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformMoveLeftOrRight( this );\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_X:\n\t\t\treturn new EShapeActionRuntimeTransformMoveRelativeX( this );\n\t\tcase EShapeActionValueTransformMoveType.RELATIVE_Y:\n\t\t\treturn new EShapeActionRuntimeTransformMoveRelativeY( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource(this.condition);\n\t\tconst amountId = manager.addResource(this.amount);\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformMoveSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformMove {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 4, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformMove( serialized[ 3 ], condition, amount );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformResizeType {\n\tRELATIVE_SIZE,\n\tRELATIVE_HEIGHT,\n\tRELATIVE_WIDTH,\n\tABSOLUTE_SIZE,\n\tABSOLUTE_HEIGHT,\n\tABSOLUTE_WIDTH\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\n\nexport class EShapeSizes {\n\tstatic toRounded( value: number ): number {\n\t\treturn Math.round( value * 100 ) / 100;\n\t}\n\n\tstatic toNormalized( size: number ): number {\n\t\tconst THRESHOLD = 0.001;\n\t\tif( Math.abs( size ) < THRESHOLD ) {\n\t\t\treturn ( size < 0 ? -THRESHOLD : +THRESHOLD );\n\t\t}\n\t\treturn EShapeSizes.toRounded( size );\n\t}\n\n\tstatic resize( shape: EShape, from: IPoint, to: IPoint, centerMode: boolean, isPerfect: boolean ): void {\n\t\tshape.disallowUploadedUpdate();\n\t\tconst position = shape.transform.position;\n\t\tif( centerMode ) {\n\t\t\tconst dx = Math.abs(to.x - from.x);\n\t\t\tconst dy = Math.abs(to.y - from.y);\n\t\t\tif (isPerfect) {\n\t\t\t\tconst hsize = Math.max(dx, dy);\n\t\t\t\tconst size = hsize + hsize;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( size ),\n\t\t\t\t\tEShapeSizes.toNormalized( size )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( from.x ),\n\t\t\t\t\tEShapeSizes.toRounded( from.y )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( dx + dx ),\n\t\t\t\t\tEShapeSizes.toNormalized( dy + dy )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( from.x ),\n\t\t\t\t\tEShapeSizes.toRounded( from.y )\n\t\t\t\t);\n\t\t\t}\n\t\t} else {\n\t\t\tif( isPerfect ) {\n\t\t\t\tconst dx = to.x - from.x;\n\t\t\t\tconst dy = to.y - from.y;\n\t\t\t\tconst size = Math.max(Math.abs(dx), Math.abs(dy));\n\t\t\t\tconst x2 = from.x + (dx < 0 ? -size : +size);\n\t\t\t\tconst y2 = from.y + (dy < 0 ? -size : +size);\n\t\t\t\tconst hsize = size * 0.5;\n\t\t\t\tconst x = Math.min(from.x, x2) + hsize;\n\t\t\t\tconst y = Math.min(from.y, y2) + hsize;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( size ),\n\t\t\t\t\tEShapeSizes.toNormalized( size )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( x ),\n\t\t\t\t\tEShapeSizes.toRounded( y )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tconst x0 = Math.min(from.x, to.x);\n\t\t\t\tconst y0 = Math.min(from.y, to.y);\n\t\t\t\tconst x1 = Math.max(from.x, to.x);\n\t\t\t\tconst y1 = Math.max(from.y, to.y);\n\t\t\t\tconst width = x1 - x0;\n\t\t\t\tconst height = y1 - y0;\n\t\t\t\tconst px = width * 0.5;\n\t\t\t\tconst py = height * 0.5;\n\t\t\t\tshape.size.set(\n\t\t\t\t\tEShapeSizes.toNormalized( width ),\n\t\t\t\t\tEShapeSizes.toNormalized( height )\n\t\t\t\t);\n\t\t\t\tposition.set(\n\t\t\t\t\tEShapeSizes.toRounded( x0 + px ),\n\t\t\t\t\tEShapeSizes.toRounded( y0 + py )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\tshape.allowUploadedUpdate();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\nimport { EShapeActionValueTransformResizeType } from \"./e-shape-action-value-transform-resize-type\";\n\nexport class EShapeActionRuntimeTransformResize extends EShapeActionRuntimeConditional {\n\tprotected readonly size: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformResize, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tswitch( value.opetype ) {\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_SIZE:\n\t\t\tthis.size = EShapeActionExpressions.ofNumberOrOne( value.amount );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_SIZE:\n\t\t\tthis.size = EShapeActionExpressions.ofNumberOrOneHundred( value.amount );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_HEIGHT:\n\t\t\tthis.size = EShapeActionExpressions.ofNumberOrOne( value.amount );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_HEIGHT:\n\t\t\tthis.size = EShapeActionExpressions.ofNumberOrOneHundred( value.amount );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_WIDTH:\n\t\t\tthis.size = EShapeActionExpressions.ofNumberOrOne( value.amount );\n\t\t\tbreak;\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_WIDTH:\n\t\t\tthis.size = EShapeActionExpressions.ofNumberOrOneHundred( value.amount );\n\t\t\tbreak;\n\t\tdefault:\n\t\t\tthis.size = EShapeActionExpressions.ONE;\n\t\t}\n\t}\n\n\tprotected adjustPosition(\n\t\tshape: EShape, runtime: EShapeRuntime,\n\t\tdsx: number, dsy: number,\n\t\toriginX: number, originY: number\n\t): void {\n\t\tconst dx = ( -0.5 + originX ) * dsx;\n\t\tconst dy = ( -0.5 + originY ) * dsy;\n\t\tshape.updateTransform();\n\t\tconst transform = shape.transform;\n\t\tconst position = transform.position;\n\t\tconst localTransform = transform.localTransform;\n\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\truntime.written |= EShapeRuntimeReset.POSITION;\n\t\tposition.set(\n\t\t\toldPositionX + dx * localTransform.a + dy * localTransform.c,\n\t\t\toldPositionY + dx * localTransform.b + dy * localTransform.d\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeActionValueTransformRotateType {\n\tRELATIVE,\n\tABSOLUTE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeHeightAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.HEIGHT );\n\t\tthis.origin = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.y = EShapeSizes.toNormalized( sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.HEIGHT;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\t0, oldSizeY - size.y,\n\t\t\t\t0.5, this.origin\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeHeightRelative extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.HEIGHT );\n\t\tthis.origin = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.y = EShapeSizes.toNormalized( oldSizeY * sizeRelative );\n\t\t\truntime.written |= EShapeRuntimeReset.HEIGHT;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\t0, oldSizeY - size.y,\n\t\t\t\t0.5, this.origin\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeSizeAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected originX: number;\n\tprotected originY: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.SIZE );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = EShapeSizes.toNormalized( this.size( shape, time ) );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.set( sizeAbsolute, sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.SIZE;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, oldSizeY - size.y,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeSizeRelative extends EShapeActionRuntimeTransformResize {\n\tprotected originX: number;\n\tprotected originY: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.SIZE );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tconst oldSizeY = (writtenHeight ? size.y : runtime.size.y);\n\t\t\tsize.set(\n\t\t\t\tEShapeSizes.toNormalized( oldSizeX * sizeRelative ),\n\t\t\t\tEShapeSizes.toNormalized( oldSizeY * sizeRelative )\n\t\t\t);\n\t\t\truntime.written |= EShapeRuntimeReset.SIZE;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, oldSizeY - size.y,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeWidthAbsolute extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.WIDTH );\n\t\tthis.origin = value.originX;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst sizeAbsolute = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst oldSizeX = (writtenWidth ? size.x : runtime.size.x);\n\t\t\tsize.x = EShapeSizes.toNormalized( sizeAbsolute );\n\t\t\truntime.written |= EShapeRuntimeReset.WIDTH;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, 0,\n\t\t\t\tthis.origin, 0.5\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeSizes } from \"../e-shape-sizes\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport { EShapeActionValueTransformResize } from \"./e-shape-action-value-transform-resize\";\n\nexport class EShapeActionRuntimeTransformResizeWidthRelative extends EShapeActionRuntimeTransformResize {\n\tprotected origin: number;\n\n\tconstructor( value: EShapeActionValueTransformResize ) {\n\t\tsuper( value, EShapeRuntimeReset.WIDTH );\n\t\tthis.origin = value.originX;\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst sizeRelative = this.size( shape, time );\n\t\t\tconst size = shape.size;\n\t\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\t\tconst oldSizeX = ( writtenWidth ? size.x : runtime.size.x );\n\t\t\tsize.x = EShapeSizes.toNormalized( oldSizeX * sizeRelative );\n\t\t\truntime.written |= EShapeRuntimeReset.WIDTH;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldSizeX - size.x, 0,\n\t\t\t\tthis.origin, 0.5\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformResize } from \"./e-shape-action-runtime-transform-resize\";\nimport {\n\tEShapeActionRuntimeTransformResizeHeightAbsolute\n} from \"./e-shape-action-runtime-transform-resize-height-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeHeightRelative\n} from \"./e-shape-action-runtime-transform-resize-height-relative\";\nimport {\n\tEShapeActionRuntimeTransformResizeSizeAbsolute\n} from \"./e-shape-action-runtime-transform-resize-size-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeSizeRelative\n} from \"./e-shape-action-runtime-transform-resize-size-relative\";\nimport {\n\tEShapeActionRuntimeTransformResizeWidthAbsolute\n} from \"./e-shape-action-runtime-transform-resize-width-absolute\";\nimport {\n\tEShapeActionRuntimeTransformResizeWidthRelative\n} from \"./e-shape-action-runtime-transform-resize-width-relative\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformResizeType } from \"./e-shape-action-value-transform-resize-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformResizeSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.RESIZE,\n\tEShapeActionValueTransformResizeType,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueTransformResize\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformResizeType> {\n\treadonly originX: number;\n\treadonly originY: number;\n\treadonly amount: string;\n\n\tconstructor(\n\t\topetype: EShapeActionValueTransformResizeType,\n\t\tcondition: string,\n\t\toriginX: number, originY: number,\n\t\tamount: string\n\t) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.RESIZE, opetype );\n\t\tthis.originX = originX;\n\t\tthis.originY = originY;\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformResize) &&\n\t\t\tthis.originX === value.originX &&\n\t\t\tthis.originY === value.originY &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformResize {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_HEIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformResizeHeightAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_WIDTH:\n\t\t\treturn new EShapeActionRuntimeTransformResizeWidthAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.ABSOLUTE_SIZE:\n\t\t\treturn new EShapeActionRuntimeTransformResizeSizeAbsolute( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_HEIGHT:\n\t\t\treturn new EShapeActionRuntimeTransformResizeHeightRelative( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_WIDTH:\n\t\t\treturn new EShapeActionRuntimeTransformResizeWidthRelative( this );\n\t\tcase EShapeActionValueTransformResizeType.RELATIVE_SIZE:\n\t\t\treturn new EShapeActionRuntimeTransformResizeSizeRelative( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource( this.condition );\n\t\tconst amountId = manager.addResource( this.amount );\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${this.originX},${this.originY},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformResizeSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformResize {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformResize(\n\t\t\tserialized[ 3 ], condition,\n\t\t\tserialized[ 4 ], serialized[ 5 ], amount\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionExpression } from \"./e-shape-action-expression\";\nimport { EShapeActionExpressions } from \"./e-shape-action-expressions\";\nimport { EShapeActionRuntimeConditional } from \"./e-shape-action-runtime-conditional\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nexport class EShapeActionRuntimeTransformRotate extends EShapeActionRuntimeConditional {\n\tprotected originY: number;\n\tprotected originX: number;\n\tprotected readonly amount: EShapeActionExpression<number>;\n\n\tconstructor( value: EShapeActionValueTransformRotate, reset: EShapeRuntimeReset ) {\n\t\tsuper( value, reset );\n\t\tthis.originX = value.originX;\n\t\tthis.originY = value.originY;\n\t\tthis.amount = EShapeActionExpressions.ofNumber( `(${value.amount}) * (Math.PI / 180)` );\n\t}\n\n\tprotected adjustPosition(\n\t\tshape: EShape, runtime: EShapeRuntime,\n\t\toldRotation: number, newRotation: number,\n\t\toriginX: number, originY: number\n\t): void {\n\t\tconst writtenWidth = ( (runtime.written & EShapeRuntimeReset.WIDTH) !== 0 );\n\t\tconst writtenHeight = ( (runtime.written & EShapeRuntimeReset.HEIGHT) !== 0 );\n\t\tconst dx = (-0.5 + originX) * (writtenWidth ? shape.size.x : runtime.size.x);\n\t\tconst dy = (-0.5 + originY) * (writtenHeight ? shape.size.y : runtime.size.y);\n\t\tconst s = Math.sin( oldRotation ) - Math.sin( newRotation );\n\t\tconst c = Math.cos( oldRotation ) - Math.cos( newRotation );\n\t\tconst position = shape.transform.position;\n\t\tconst writtenPositionX = ( (runtime.written & EShapeRuntimeReset.POSITION_X) !== 0 );\n\t\tconst writtenPositionY = ( (runtime.written & EShapeRuntimeReset.POSITION_Y) !== 0 );\n\t\tconst oldPositionX = ( writtenPositionX ? position.x : runtime.x );\n\t\tconst oldPositionY = ( writtenPositionY ? position.y : runtime.y );\n\t\truntime.written |= EShapeRuntimeReset.POSITION;\n\t\tposition.set(\n\t\t\toldPositionX + dx * c - dy * s,\n\t\t\toldPositionY + dx * s + dy * c\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nexport class EShapeActionRuntimeTransformRotateAbsolute extends EShapeActionRuntimeTransformRotate {\n\tconstructor( value: EShapeActionValueTransformRotate ) {\n\t\tsuper( value, EShapeRuntimeReset.ROTATION );\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst writtenRotation = ( (runtime.written & EShapeRuntimeReset.ROTATION) !== 0 );\n\t\t\tconst oldRotation = (writtenRotation ? transform.rotation : runtime.rotation);\n\t\t\ttransform.rotation = amount;\n\t\t\truntime.written |= EShapeRuntimeReset.ROTATION;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldRotation, amount,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeRuntime, EShapeRuntimeReset } from \"../e-shape-runtime\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionValueTransformRotate } from \"./e-shape-action-value-transform-rotate\";\n\nexport class EShapeActionRuntimeTransformRotateRelative extends EShapeActionRuntimeTransformRotate {\n\tconstructor( value: EShapeActionValueTransformRotate ) {\n\t\tsuper( value, EShapeRuntimeReset.ROTATION );\n\t\tthis.reset |= EShapeRuntimeReset.POSITION;\n\t}\n\n\texecute( shape: EShape, runtime: EShapeRuntime, time: number ): void {\n\t\tif( this.condition( shape, time ) ) {\n\t\t\tconst amount = this.amount( shape, time );\n\t\t\tconst transform = shape.transform;\n\t\t\tconst writtenRotation = ( (runtime.written & EShapeRuntimeReset.ROTATION) !== 0 );\n\t\t\tconst oldRotation = (writtenRotation ? transform.rotation : runtime.rotation);\n\t\t\ttransform.rotation = oldRotation + amount;\n\t\t\truntime.written |= EShapeRuntimeReset.ROTATION;\n\t\t\tthis.adjustPosition(\n\t\t\t\tshape, runtime,\n\t\t\t\toldRotation, transform.rotation,\n\t\t\t\tthis.originX, this.originY\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeActionRuntimeTransformRotate } from \"./e-shape-action-runtime-transform-rotate\";\nimport { EShapeActionRuntimeTransformRotateAbsolute } from \"./e-shape-action-runtime-transform-rotate-absolute\";\nimport { EShapeActionRuntimeTransformRotateRelative } from \"./e-shape-action-runtime-transform-rotate-relative\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueOpetyped } from \"./e-shape-action-value-opetyped\";\nimport { EShapeActionValueTransformRotateType } from \"./e-shape-action-value-transform-rotate-type\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\nimport { EShapeActionValues } from \"./e-shape-action-values\";\n\nexport type EShapeActionValueTransformRotateSerialized = [\n\tEShapeActionValueType.TRANSFORM, number, EShapeActionValueTransformType.ROTATE,\n\tEShapeActionValueTransformRotateType,\n\tnumber, number, number\n];\n\nexport class EShapeActionValueTransformRotate\n\textends EShapeActionValueOpetyped<EShapeActionValueTransformType, EShapeActionValueTransformRotateType> {\n\treadonly originX: number;\n\treadonly originY: number;\n\treadonly amount: string;\n\n\tconstructor(\n\t\topetype: EShapeActionValueTransformRotateType, condition: string,\n\t\toriginX: number, originY: number, amount: string\n\t) {\n\t\tsuper( EShapeActionValueType.TRANSFORM, condition, EShapeActionValueTransformType.ROTATE, opetype );\n\t\tthis.originX = originX;\n\t\tthis.originY = originY;\n\t\tthis.amount = amount;\n\t}\n\n\tisEquals( value: EShapeActionValue ): boolean {\n\t\treturn (\n\t\t\tsuper.isEquals( value ) &&\n\t\t\t(value instanceof EShapeActionValueTransformRotate) &&\n\t\t\tthis.originX === value.originX &&\n\t\t\tthis.originY === value.originY &&\n\t\t\tthis.amount === value.amount\n\t\t);\n\t}\n\n\ttoRuntime(): EShapeActionRuntimeTransformRotate {\n\t\tswitch( this.opetype ) {\n\t\tcase EShapeActionValueTransformRotateType.ABSOLUTE:\n\t\t\treturn new EShapeActionRuntimeTransformRotateAbsolute( this );\n\t\tcase EShapeActionValueTransformRotateType.RELATIVE:\n\t\t\treturn new EShapeActionRuntimeTransformRotateRelative( this );\n\t\t}\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst conditionId = manager.addResource( this.condition );\n\t\tconst amountId = manager.addResource( this.amount );\n\t\treturn manager.addResource(\n\t\t\t`[${this.type},${conditionId},${this.subtype},${this.opetype},${this.originX},${this.originY},${amountId}]`\n\t\t);\n\t}\n\n\tstatic deserialize(\n\t\tserialized: EShapeActionValueTransformRotateSerialized,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeActionValueTransformRotate {\n\t\tconst condition = EShapeActionValues.toResource( 1, serialized, manager.resources );\n\t\tconst amount = EShapeActionValues.toResource( 6, serialized, manager.resources );\n\t\treturn new EShapeActionValueTransformRotate(\n\t\t\tserialized[ 3 ], condition,\n\t\t\tserialized[ 4 ], serialized[ 5 ], amount\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeCapability {\n\tNONE\t\t\t= 0,\n\n\tID\t\t\t\t= 1 << 0,\n\tPOSITION\t\t= 1 << 1,\n\tWIDTH\t\t\t= 1 << 2,\n\tHEIGHT\t\t\t= 1 << 3,\n\tROTATION\t\t= 1 << 4,\n\tSKEW\t\t\t= 1 << 5,\n\tALIGN\t\t\t= 1 << 6,\n\n\tREPLACING\t\t= 1 << 7,\n\tGROUPING\t\t= 1 << 8,\n\tFILL\t\t\t= 1 << 9,\n\tSTROKE\t\t\t= 1 << 10,\n\tSTROKE_SIDE\t\t= 1 << 11,\n\tBORDER_RADIUS\t= 1 << 12,\n\n\tTEXT\t\t\t= 1 << 13,\n\tTEXTURE\t\t\t= 1 << 14,\n\tTAG\t\t\t\t= 1 << 15,\n\tACTION\t\t\t= 1 << 16,\n\tCURSOR\t\t\t= 1 << 17,\n\tORDER_IN_LAYER\t= 1 << 18,\n\n\tCHILDREN\t\t= 1 << 19,\n\n\tCOORDINATE\t\t= ID | POSITION | WIDTH | HEIGHT | ROTATION | SKEW | ALIGN,\n\tSHAPE\t\t\t= REPLACING | GROUPING | FILL | STROKE,\n\tLAYER\t\t\t= ORDER_IN_LAYER,\n\tPRIMITIVE\t\t= COORDINATE | SHAPE | TEXT | TEXTURE | TAG | ACTION | CURSOR | LAYER | CHILDREN,\n\tEMBEDDED\t\t= COORDINATE | REPLACING | GROUPING | TEXT | TAG | ACTION | LAYER,\n\tALL\t\t\t\t= PRIMITIVE | STROKE_SIDE | BORDER_RADIUS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isArray } from \"../../util/is-array\";\nimport { isNumber } from \"../../util/is-number\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeActionValue } from \"./e-shape-action-value\";\nimport { EShapeActionValueBlink, EShapeActionValueBlinkSerialized } from \"./e-shape-action-value-blink\";\nimport {\n\tEShapeActionValueChangeColor, EShapeActionValueChangeColorSerialized, EShapeActionValueChangeColorSerializedLegacy\n} from \"./e-shape-action-value-change-color\";\nimport {\n\tEShapeActionValueChangeColorBrightness, EShapeActionValueChangeColorBrightnessSerialized, EShapeActionValueChangeColorBrightnessSerializedLegacy\n} from \"./e-shape-action-value-change-color-brightness\";\nimport {\n\tEShapeActionValueChangeColorCode, EShapeActionValueChangeColorCodeSerialized, EShapeActionValueChangeColorCodeSerializedLegacy\n} from \"./e-shape-action-value-change-color-code\";\nimport { EShapeActionValueChangeColorTarget } from \"./e-shape-action-value-change-color-target\";\nimport {\n\tEShapeActionValueChangeCursor, EShapeActionValueChangeCursorSerialized } from \"./e-shape-action-value-change-cursor\";\nimport { EShapeActionValueChangeText, EShapeActionValueChangeTextSerialized } from \"./e-shape-action-value-change-text\";\nimport { EShapeActionValueEmitEvent, EShapeActionValueEmitEventSerialized } from \"./e-shape-action-value-emit-event\";\nimport { EShapeActionValueMisc, EShapeActionValueMiscSerialized } from \"./e-shape-action-value-misc\";\nimport { EShapeActionValueOpen, EShapeActionValueOpenSerialized } from \"./e-shape-action-value-open\";\nimport { EShapeActionValueShowHide, EShapeActionValueShowHideSerialized } from \"./e-shape-action-value-show-hide\";\nimport {\n\tEShapeActionValueShowHideType\n} from \"./e-shape-action-value-show-hide-type\";\nimport {\n\tEShapeActionValueTransformMove, EShapeActionValueTransformMoveSerialized\n} from \"./e-shape-action-value-transform-move\";\nimport {\n\tEShapeActionValueTransformResize, EShapeActionValueTransformResizeSerialized\n} from \"./e-shape-action-value-transform-resize\";\nimport {\n\tEShapeActionValueTransformRotate, EShapeActionValueTransformRotateSerialized\n} from \"./e-shape-action-value-transform-rotate\";\nimport { EShapeActionValueTransformType } from \"./e-shape-action-value-transform-type\";\nimport { EShapeActionValueType } from \"./e-shape-action-value-type\";\n\nexport type EShapeActionValueSerialized = EShapeActionValueShowHideSerialized |\n\tEShapeActionValueBlinkSerialized | EShapeActionValueBlinkSerialized |\n\tEShapeActionValueChangeColorSerialized | EShapeActionValueChangeColorSerializedLegacy |\n\tEShapeActionValueChangeColorCodeSerialized | EShapeActionValueChangeColorCodeSerializedLegacy |\n\tEShapeActionValueChangeColorBrightnessSerialized | EShapeActionValueChangeColorBrightnessSerializedLegacy |\n\tEShapeActionValueChangeTextSerialized |\n\tEShapeActionValueChangeCursorSerialized | EShapeActionValueEmitEventSerialized |\n\tEShapeActionValueOpenSerialized | EShapeActionValueTransformMoveSerialized |\n\tEShapeActionValueTransformResizeSerialized | EShapeActionValueTransformRotateSerialized |\n\tEShapeActionValueMiscSerialized;\n\nexport class EShapeActionValueDeserializer {\n\tstatic toSerialized( resource: string ): EShapeActionValueSerialized | null {\n\t\ttry {\n\t\t\tconst parsed = JSON.parse( resource );\n\t\t\tif( isArray( parsed ) ) {\n\t\t\t\tfor( let i = 0, imax = parsed.length; i < imax; ++i ) {\n\t\t\t\t\tif( ! isNumber( parsed[ i ] ) ) {\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( 2 <= parsed.length ) {\n\t\t\t\t\treturn parsed as EShapeActionValueSerialized;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t} catch( e ) {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tstatic deserialize( id: number, manager: EShapeResourceManagerDeserialization ): EShapeActionValue {\n\t\tconst action = manager.getAction( id );\n\t\tif( action != null ) {\n\t\t\treturn action;\n\t\t}\n\n\t\tconst resources = manager.resources;\n\t\tconst resource = resources[ id ];\n\t\tif( resource != null ) {\n\t\t\tconst serialized = this.toSerialized( resource );\n\t\t\tif( serialized != null ) {\n\t\t\t\tswitch( serialized[ 0 ] ) {\n\t\t\t\tcase EShapeActionValueType.SHOW_HIDE:\n\t\t\t\t\treturn EShapeActionValueShowHide.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.BLINK:\n\t\t\t\t\treturn EShapeActionValueBlink.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.CHANGE_COLOR:\n\t\t\t\tcase EShapeActionValueType.CHANGE_COLOR_LEGACY:\n\t\t\t\t\tswitch( serialized[ 3 ] ) {\n\t\t\t\t\tcase EShapeActionValueChangeColorTarget.COLOR_AND_ALPHA:\n\t\t\t\t\tcase EShapeActionValueChangeColorTarget.COLOR:\n\t\t\t\t\tcase EShapeActionValueChangeColorTarget.ALPHA:\n\t\t\t\t\t\treturn EShapeActionValueChangeColor.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueChangeColorTarget.CODE:\n\t\t\t\t\t\treturn EShapeActionValueChangeColorCode.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueChangeColorTarget.BRIGHTNESS:\n\t\t\t\t\t\treturn EShapeActionValueChangeColorBrightness.deserialize( serialized, manager );\n\t\t\t\t\t}\n\t\t\t\tcase EShapeActionValueType.CHANGE_TEXT:\n\t\t\t\t\treturn EShapeActionValueChangeText.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.CHANGE_CURSOR:\n\t\t\t\t\treturn EShapeActionValueChangeCursor.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.EMIT_EVENT:\n\t\t\t\t\treturn EShapeActionValueEmitEvent.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.OPEN:\n\t\t\t\t\treturn EShapeActionValueOpen.deserialize( serialized, manager );\n\t\t\t\tcase EShapeActionValueType.TRANSFORM:\n\t\t\t\t\tswitch( serialized[ 2 ] ) {\n\t\t\t\t\tcase EShapeActionValueTransformType.MOVE:\n\t\t\t\t\t\treturn EShapeActionValueTransformMove.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueTransformType.RESIZE:\n\t\t\t\t\t\treturn EShapeActionValueTransformResize.deserialize( serialized, manager );\n\t\t\t\t\tcase EShapeActionValueTransformType.ROTATE:\n\t\t\t\t\t\treturn EShapeActionValueTransformRotate.deserialize( serialized, manager );\n\t\t\t\t\t}\n\t\t\t\t\tbreak;\n\t\t\t\tcase EShapeActionValueType.MISC:\n\t\t\t\t\treturn EShapeActionValueMisc.deserialize( serialized, manager );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn new EShapeActionValueShowHide( EShapeActionValueShowHideType.SHOW, \"\" );\n\t}\n}\n","\nexport class EShapeImageElements {\n\tstatic imageElements: { [ src: string ]: Promise<HTMLImageElement> | HTMLImageElement | undefined } = {};\n\n\tstatic toImageElement( dataUrl: string ): Promise<HTMLImageElement> {\n\t\tconst imageElements = EShapeImageElements.imageElements;\n\t\tconst cachedImageElement = imageElements[ dataUrl ];\n\t\tif( cachedImageElement != null ) {\n\t\t\tif( cachedImageElement instanceof HTMLImageElement ) {\n\t\t\t\treturn Promise.resolve( cachedImageElement );\n\t\t\t} else {\n\t\t\t\treturn cachedImageElement;\n\t\t\t}\n\t\t} else {\n\t\t\tconst result = new Promise<HTMLImageElement>(( resolve, reject ): void => {\n\t\t\t\tconst imageElement = document.createElement( \"img\" );\n\t\t\t\timageElement.onload = () => {\n\t\t\t\t\timageElements[ dataUrl ] = imageElement;\n\t\t\t\t\tresolve( imageElement );\n\t\t\t\t};\n\t\t\t\timageElement.onabort = imageElement.onerror = () => {\n\t\t\t\t\treject();\n\t\t\t\t};\n\t\t\t\timageElement.src = dataUrl;\n\t\t\t});\n\t\t\timageElements[ dataUrl ] = result;\n\t\t\treturn result;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../d-diagram-serialized\";\nimport { isString } from \"../util/is-string\";\nimport { EShapeActionValueDeserializer } from \"./action/e-shape-action-value-deserializer\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeDeserializers } from \"./e-shape-deserializers\";\nimport { EShapeImageElements } from \"./e-shape-image-elements\";\nimport { EShapeResourceManagerDeserialization } from \"./e-shape-resource-manager-deserialization\";\nimport { EShapeSizes } from \"./e-shape-sizes\";\nimport { EShapeGradients } from \"./variant/e-shape-gradients\";\n\nexport class EShapeDeserializer {\n\tstatic toShape(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n\t): Promise<EShape> | EShape | null {\n\t\tconst shapeDeserializer = EShapeDeserializers[ item[ 0 ] ];\n\t\tif( shapeDeserializer != null ) {\n\t\t\treturn shapeDeserializer( item, manager );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic deserialize<SHAPE extends EShape>(\n\t\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization, result: SHAPE\n\t): Promise<SHAPE> | SHAPE {\n\t\tresult.id = manager.resources[ item[ 1 ] ] || \"\";\n\t\tresult.transform.position.set( item[ 2 ], item[ 3 ] );\n\t\tresult.transform.rotation = item[ 6 ];\n\t\tresult.transform.skew.set( item[ 7 ], item[ 7 ] );\n\t\tresult.transform.pivot.set( item[ 21 ], item[ 22 ] );\n\t\tresult.size.set( EShapeSizes.toNormalized( item[ 4 ] ), EShapeSizes.toNormalized( item[ 5 ] ) );\n\t\tresult.fill.deserialize( item[ 8 ], manager );\n\t\tresult.stroke.deserialize( item[ 9 ], manager );\n\t\tresult.cursor = manager.resources[ item[ 10 ] ] || \"\";\n\t\tresult.text.deserialize( item[ 11 ], manager );\n\t\tresult.tag.deserialize( item[ 12 ], manager );\n\t\tresult.radius = item[ 13 ];\n\t\tresult.corner = item[ 14 ];\n\t\tresult.interactive = !! ( item[ 23 ] & 1 );\n\t\tresult.state.isFocusable = ! ( item[ 23 ] & 2 );\n\t\tresult.shortcut = ( 0 <= item[ 24 ] ? manager.resources[ item[ 24 ] ] : undefined );\n\t\tresult.title = ( 0 <= item[ 25 ] ? manager.resources[ item[ 25 ] ] : undefined );\n\t\tresult.uuid = ( item[ 26 ] != null ? item[ 26 ] : 0 );\n\n\t\t// Children\n\t\tlet childrenPromise: Promise<SHAPE> | null = null;\n\t\tconst childrenSerialized = item[ 20 ];\n\t\tif( 0 < childrenSerialized.length ) {\n\t\t\tconst childrenOrPromises = [];\n\t\t\tfor( let i = 0, imax = childrenSerialized.length; i < imax; ++i ) {\n\t\t\t\tconst childSerialized = childrenSerialized[ i ];\n\t\t\t\tconst childOrPromise = EShapeDeserializer.toShape( childSerialized, manager );\n\t\t\t\tif( childOrPromise != null ) {\n\t\t\t\t\tchildrenOrPromises.push( childOrPromise );\n\t\t\t\t}\n\t\t\t}\n\t\t\tchildrenPromise = Promise.all( childrenOrPromises ).then(( children: EShape[] ) => {\n\t\t\t\tresult.children = children;\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\tchildren[ i ].parent = result;\n\t\t\t\t}\n\t\t\t\tresult.onChildTransformChange();\n\t\t\t\tresult.toDirty();\n\t\t\t\treturn result;\n\t\t\t});\n\t\t}\n\n\t\t// Action\n\t\tconst serializedActions = item[ 17 ];\n\t\tfor( let i = 0, imax = serializedActions.length; i < imax; ++i ) {\n\t\t\tresult.action.add( EShapeActionValueDeserializer.deserialize( serializedActions[ i ], manager ) );\n\t\t}\n\n\t\t// Gradient\n\t\tconst gradientId = item[ 19 ];\n\t\tif( 0 <= gradientId && gradientId < manager.resources.length ) {\n\t\t\tconst gradient = manager.resources[ gradientId ];\n\t\t\tif( isString( gradient ) ) {\n\t\t\t\tresult.gradient = EShapeGradients.deserializeGradient( gradient );\n\t\t\t}\n\t\t}\n\n\t\t// Image\n\t\tlet imagePromise: Promise<SHAPE> | null = null;\n\t\tconst imageId = item[ 18 ];\n\t\tif( 0 <= imageId && imageId < manager.resources.length ) {\n\t\t\tconst imageSrc = manager.resources[ imageId ];\n\t\t\tif( isString( imageSrc ) ) {\n\t\t\t\timagePromise = EShapeImageElements.toImageElement( imageSrc ).then(( imageElement ) => {\n\t\t\t\t\tresult.image = imageElement;\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( childrenPromise != null ) {\n\t\t\tif( imagePromise != null ) {\n\t\t\t\treturn Promise.all([ childrenPromise, imagePromise ]).then(() => {\n\t\t\t\t\treturn result;\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\treturn childrenPromise;\n\t\t\t}\n\t\t} else {\n\t\t\tif( imagePromise != null ) {\n\t\t\t\treturn imagePromise;\n\t\t\t} else {\n\t\t\t\treturn result;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic deserializeAll(\n\t\tserializeds: DDiagramSerializedItem[],\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): Promise<EShape[]> | null {\n\t\tconst shapes: Array<Promise<EShape> | EShape> = [];\n\t\tfor( let i = 0, imax = serializeds.length; i < imax; ++i ) {\n\t\t\tconst serialized = serializeds[ i ];\n\t\t\tconst shape = EShapeDeserializer.toShape( serialized, manager );\n\t\t\tif( shape == null ) {\n\t\t\t\tif( 0 < shapes.length ) {\n\t\t\t\t\tPromise.all( shapes ).then( ( resolved: EShape[] ): void => {\n\t\t\t\t\t\tfor( let j = 0, jmax = resolved.length; j < jmax; ++j ) {\n\t\t\t\t\t\t\tresolved[ j ].destroy();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tshapes.push( shape );\n\t\t}\n\t\tif( 0 < shapes.length ) {\n\t\t\treturn Promise.all( shapes );\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeBar } from \"./e-shape-bar\";\nimport { EShapeBarPosition } from \"./e-shape-bar-position\";\n\nexport const deserializeBar = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeBar> | EShapeBar => {\n\tconst shape = new EShapeBar( EShapeBarPosition.RIGHT );\n\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\tshape.points.deserialize( item[ 15 ], manager );\n\treturn result;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createBarUploaded } from \"../variant/create-bar-uploaded\";\nimport { deserializeBar } from \"../variant/deserialize-bar\";\n\nexport const loadShapeBar = () => {\n\tEShapeUploadeds[ EShapeType.BAR ] = createBarUploaded;\n\tEShapeDeserializers[ EShapeType.BAR ] = deserializeBar;\n};\n","\nexport const buildStep = (\n\tsteps: Float32Array,\n\tclippings: Float32Array,\n\tvoffset: number, vcount: number,\n\tswx: number, swy: number, px0: number, py0: number, px1: number, py1: number\n): void => {\n\tlet ic = voffset * 3;\n\tlet is = voffset * 6;\n\tfor( let i = 0; i < vcount; ++i ) {\n\t\tsteps[ is + 0 ] = swx * clippings[ ic + 0 ];\n\t\tsteps[ is + 1 ] = swy * clippings[ ic + 1 ];\n\t\tsteps[ is + 2 ] = px0;\n\t\tsteps[ is + 3 ] = py0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tic += 3;\n\t\tis += 6;\n\t}\n};\n","export const STEP_VALUES: [ number, number, number ] = [ 0, 0, 0 ];\n\nexport const toStep = (\n\tsize: number,\n\tstrokeWidth: number,\n\tantialiasWeight: number,\n\tresult: [ number, number, number ]\n): [ number, number, number ] => {\n\tconst FMIN: number = 0.00001;\n\tif( FMIN < strokeWidth ) {\n\t\tconst dpc0 = size - strokeWidth;\n\t\tif( FMIN < dpc0 ) {\n\t\t\tconst pc0 = antialiasWeight / dpc0;\n\t\t\tconst pc1 = antialiasWeight / Math.max( FMIN, size );\n\t\t\tconst swc = 1 / Math.max( FMIN, 1 - strokeWidth / size );\n\t\t\tresult[ 0 ] = swc;\n\t\t\tresult[ 1 ] = pc0;\n\t\t\tresult[ 2 ] = pc1;\n\t\t} else {\n\t\t\tconst pc0 = antialiasWeight / FMIN;\n\t\t\tconst pc1 = antialiasWeight / Math.max( FMIN, size );\n\t\t\tconst swc = 1 / FMIN;\n\t\t\tresult[ 0 ] = swc;\n\t\t\tresult[ 1 ] = pc0;\n\t\t\tresult[ 2 ] = pc1;\n\t\t}\n\t} else {\n\t\t// Assumes strokeWidth === 0\n\t\tconst pc = antialiasWeight / Math.max( FMIN, size );\n\t\tresult[ 0 ] = 1;\n\t\tresult[ 1 ] = pc;\n\t\tresult[ 2 ] = pc;\n\t}\n\treturn result;\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { buildStep } from \"./build-step\";\nimport { toLength } from \"./to-length\";\nimport { STEP_VALUES, toStep } from \"./to-step\";\n\nexport const CIRCLE_VERTEX_COUNT = 9;\nexport const CIRCLE_INDEX_COUNT = 8;\nexport const CIRCLE_WORLD_SIZE: [ number, number ] = [ 0, 0 ];\nconst CIRCLE_WORK_POINT: Point = new Point();\n\nexport const buildCircleClipping = (\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\tconst ic = voffset * 3;\n\tclippings[ ic +  0 ] = 1;\n\tclippings[ ic +  1 ] = 1;\n\tclippings[ ic +  2 ] = 1;\n\n\tclippings[ ic +  3 ] = 0;\n\tclippings[ ic +  4 ] = 1;\n\tclippings[ ic +  5 ] = 1;\n\n\tclippings[ ic +  6 ] = 1;\n\tclippings[ ic +  7 ] = 1;\n\tclippings[ ic +  8 ] = 1;\n\n\tclippings[ ic +  9 ] = 1;\n\tclippings[ ic + 10 ] = 0;\n\tclippings[ ic + 11 ] = 1;\n\n\tclippings[ ic + 12 ] = 0;\n\tclippings[ ic + 13 ] = 0;\n\tclippings[ ic + 14 ] = 1;\n\n\tclippings[ ic + 15 ] = 1;\n\tclippings[ ic + 16 ] = 0;\n\tclippings[ ic + 17 ] = 1;\n\n\tclippings[ ic + 18 ] = 1;\n\tclippings[ ic + 19 ] = 1;\n\tclippings[ ic + 20 ] = 1;\n\n\tclippings[ ic + 21 ] = 0;\n\tclippings[ ic + 22 ] = 1;\n\tclippings[ ic + 23 ] = 1;\n\n\tclippings[ ic + 24 ] = 1;\n\tclippings[ ic + 25 ] = 1;\n\tclippings[ ic + 26 ] = 1;\n};\n\nexport const buildCircleIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\tconst ii = ioffset * 3;\n\tindices[ ii +  0 ] = voffset + 0;\n\tindices[ ii +  1 ] = voffset + 1;\n\tindices[ ii +  2 ] = voffset + 3;\n\n\tindices[ ii +  3 ] = voffset + 1;\n\tindices[ ii +  4 ] = voffset + 4;\n\tindices[ ii +  5 ] = voffset + 3;\n\n\tindices[ ii +  6 ] = voffset + 1;\n\tindices[ ii +  7 ] = voffset + 2;\n\tindices[ ii +  8 ] = voffset + 4;\n\n\tindices[ ii +  9 ] = voffset + 2;\n\tindices[ ii + 10 ] = voffset + 5;\n\tindices[ ii + 11 ] = voffset + 4;\n\n\tindices[ ii + 12 ] = voffset + 3;\n\tindices[ ii + 13 ] = voffset + 4;\n\tindices[ ii + 14 ] = voffset + 6;\n\n\tindices[ ii + 15 ] = voffset + 4;\n\tindices[ ii + 16 ] = voffset + 7;\n\tindices[ ii + 17 ] = voffset + 6;\n\n\tindices[ ii + 18 ] = voffset + 4;\n\tindices[ ii + 19 ] = voffset + 5;\n\tindices[ ii + 20 ] = voffset + 7;\n\n\tindices[ ii + 21 ] = voffset + 5;\n\tindices[ ii + 22 ] = voffset + 8;\n\tindices[ ii + 23 ] = voffset + 7;\n};\n\nexport const buildCircleVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number ]\n): void => {\n\t// Calculate the transformed positions\n\t//\n\t//  0       1       2\n\t// |-------|-------|\n\t// |3      |4      |5\n\t// |-------|-------|\n\t// |6      |7      |8\n\t// |-------|-------|\n\t//\n\tconst work = CIRCLE_WORK_POINT;\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\twork.set( -sx + originX, -sy + originY );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( 0 + originX, -sy + originY );\n\tinternalTransform.apply( work, work );\n\tconst x1 = work.x;\n\tconst y1 = work.y;\n\tconst dx = x1 - x0;\n\tconst dy = y1 - y0;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst x4 = work.x;\n\tconst y4 = work.y;\n\tconst x7 = x4 + (x4 - x1);\n\tconst y7 = y4 + (y4 - y1);\n\tconst x3 = x4 - dx;\n\tconst y3 = y4 - dy;\n\n\t// Vertices\n\tconst iv = voffset * 2;\n\tvertices[ iv +  0 ] = x0;\n\tvertices[ iv +  1 ] = y0;\n\tvertices[ iv +  2 ] = x1;\n\tvertices[ iv +  3 ] = y1;\n\tvertices[ iv +  4 ] = x1 + dx;\n\tvertices[ iv +  5 ] = y1 + dy;\n\n\tvertices[ iv +  6 ] = x3;\n\tvertices[ iv +  7 ] = y3;\n\tvertices[ iv +  8 ] = x4;\n\tvertices[ iv +  9 ] = y4;\n\tvertices[ iv + 10 ] = x4 + dx;\n\tvertices[ iv + 11 ] = y4 + dy;\n\n\tvertices[ iv + 12 ] = x7 - dx;\n\tvertices[ iv + 13 ] = y7 - dy;\n\tvertices[ iv + 14 ] = x7;\n\tvertices[ iv + 15 ] = y7;\n\tvertices[ iv + 16 ] = x7 + dx;\n\tvertices[ iv + 17 ] = y7 + dy;\n\n\tworldSize[ 0 ] = toLength( x0, y0, x1, y1 );\n\tworldSize[ 1 ] = toLength( x0, y0, x3, y3 );\n};\n\nexport const buildCircleStep = (\n\tsteps: Float32Array,\n\tclippings: Float32Array,\n\tvoffset: number,\n\tstrokeWidth: number,\n\tantialiasWeight: number,\n\tworldSize: [ number, number ]\n): void => {\n\ttoStep( worldSize[ 0 ], strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swx = STEP_VALUES[ 0 ];\n\tconst px0 = STEP_VALUES[ 1 ];\n\tconst px1 = STEP_VALUES[ 2 ];\n\n\ttoStep( worldSize[ 1 ], strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swy = STEP_VALUES[ 0 ];\n\tconst py0 = STEP_VALUES[ 1 ];\n\tconst py1 = STEP_VALUES[ 2 ];\n\n\tbuildStep(\n\t\tsteps, clippings,\n\t\tvoffset, CIRCLE_VERTEX_COUNT,\n\t\tswx, swy, px0, py0, px1, py1\n\t);\n};\n\nexport const buildCircleUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\t// UVs\n\tconst iuv = voffset * 2;\n\tuvs[ iuv +  0 ] = x0;\n\tuvs[ iuv +  1 ] = y0;\n\tuvs[ iuv +  2 ] = 0.5 * ( x0 + x1 );\n\tuvs[ iuv +  3 ] = 0.5 * ( y0 + y1 );\n\tuvs[ iuv +  4 ] = x1;\n\tuvs[ iuv +  5 ] = y1;\n\n\tuvs[ iuv +  6 ] = 0.5 * ( x0 + x3 );\n\tuvs[ iuv +  7 ] = 0.5 * ( y0 + y3 );\n\tuvs[ iuv +  8 ] = 0.5 * ( x0 + x2 );\n\tuvs[ iuv +  9 ] = 0.5 * ( y0 + y2 );\n\tuvs[ iuv + 10 ] = 0.5 * ( x1 + x2 );\n\tuvs[ iuv + 11 ] = 0.5 * ( y1 + y2 );\n\n\tuvs[ iuv + 12 ] = x3;\n\tuvs[ iuv + 13 ] = y3;\n\tuvs[ iuv + 14 ] = 0.5 * ( x3 + x2 );\n\tuvs[ iuv + 15 ] = 0.5 * ( y3 + y2 );\n\tuvs[ iuv + 16 ] = x2;\n\tuvs[ iuv + 17 ] = y2;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildCircleClipping, buildCircleIndex, buildCircleStep, buildCircleUv,\n\tbuildCircleVertex, CIRCLE_WORLD_SIZE\n} from \"./build-circle\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeCircleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clippings & indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateClippings();\n\t\tbuffer.updateIndices();\n\t\tconst voffset = this.vertexOffset;\n\t\tbuildCircleClipping(\n\t\t\tbuffer.clippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildCircleIndex(\n\t\t\tbuffer.indices,\n\t\t\tvoffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateCircleVertexAndStep( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateCircleUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateCircleVertexAndStep( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\n\t\t\t// Buffer\n\t\t\tbuffer.updateVertices();\n\t\t\tbuffer.updateSteps();\n\t\t\tbuildCircleVertex(\n\t\t\t\tbuffer.vertices, this.vertexOffset,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign, strokeWidth,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tCIRCLE_WORLD_SIZE\n\t\t\t);\n\t\t\tbuildCircleStep(\n\t\t\t\tbuffer.steps, buffer.clippings,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tstrokeWidth,\n\t\t\t\tthis.antialiasWeight,\n\t\t\t\tCIRCLE_WORLD_SIZE\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateCircleUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuffer.updateUvs();\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tbuildCircleUv(\n\t\t\t\tbuffer.uvs,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\ttextureUvs\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { CIRCLE_INDEX_COUNT, CIRCLE_VERTEX_COUNT } from \"./build-circle\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { EShapeCircleUploaded } from \"./e-shape-circle-uploaded\";\n\nexport const createCircle = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeCircleUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = CIRCLE_VERTEX_COUNT + tvcount;\n\tconst icount = CIRCLE_INDEX_COUNT + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeCircleUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeCircle extends EShapePrimitive {\n\tconstructor( type = EShapeType.CIRCLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeCircle {\n\t\treturn new EShapeCircle().copy( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tif( fill.enable ) {\n\t\t\t\tconst x2 = x * x;\n\t\t\t\tconst y2 = y * y;\n\t\t\t\tconst ax2 = ax * ax;\n\t\t\t\tconst ay2 = ay * ay;\n\t\t\t\tif( x2 * ay2 + y2 * ax2 <= ax2 * ay2 ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\tconst x2 = x * x;\n\t\t\t\t\tconst y2 = y * y;\n\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\tconst wx2 = wx * wx;\n\t\t\t\t\tconst wy2 = wy * wy;\n\t\t\t\t\tif( wx2 * wy2 <= x2 * wy2 + y2 * wx2 ) {\n\t\t\t\t\t\tconst ax2 = ax * ax;\n\t\t\t\t\t\tconst ay2 = ay * ay;\n\t\t\t\t\t\tif( x2 * ay2 + y2 * ax2 <= ax2 * ay2 ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeCircle } from \"./e-shape-circle\";\n\nexport const deserializeCircle = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeCircle> | EShapeCircle => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeCircle() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createCircle } from \"../variant/create-circle-uploaded\";\nimport { deserializeCircle } from \"../variant/deserialize-circle\";\n\nexport const loadShapeCircle = () => {\n\tEShapeUploadeds[ EShapeType.CIRCLE ] = createCircle;\n\tEShapeDeserializers[ EShapeType.CIRCLE ] = deserializeCircle;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeCapability } from \"./e-shape-capability\";\nimport { EShapeType } from \"./e-shape-type\";\n\nexport class EShapeCapabilities {\n\tstatic mappings: { [ type: number ]: EShapeCapability | undefined } = {};\n\n\tstatic get( type: EShapeType ): EShapeCapability {\n\t\tconst capability = this.mappings[ type ];\n\t\tif( capability != null ) {\n\t\t\treturn capability;\n\t\t}\n\t\treturn EShapeCapability.PRIMITIVE;\n\t}\n\n\tstatic contains( shape: EShape | null | undefined, target: EShapeCapability ): shape is EShape {\n\t\tif( shape != null ) {\n\t\t\tconst capability = this.get( shape.type );\n\t\t\tif( capability & target ) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\tif( capability & EShapeCapability.CHILDREN ) {\n\t\t\t\tconst children = shape.children;\n\t\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\t\tif( this.contains( children[ i ], target ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic set( type: EShapeType, capability: EShapeCapability ): void {\n\t\tthis.mappings[ type ] = capability;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum EShapeStrokeSide {\n\tNONE = 0,\n\tTOP = 1,\n\tRIGHT = 2,\n\tBOTTOM = 4,\n\tLEFT = 8,\n\tTOP_OR_LEFT = TOP | LEFT,\n\tTOP_OR_RIGHT = TOP | RIGHT,\n\tBOTTOM_OR_LEFT = BOTTOM | LEFT,\n\tBOTTOM_OR_RIGHT = BOTTOM | RIGHT,\n\tALL = TOP | RIGHT | BOTTOM | LEFT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\n\nexport class EShapeGroupUploaded extends EShapeUploadedBase {\n\tconstructor( buffer: EShapeBuffer, voffset: number, ioffset: number ) {\n\t\tsuper( buffer, voffset, ioffset, 0, 0, 1 );\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.texture = shape.texture || Texture.WHITE;\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeGroupUploaded } from \"./e-shape-group-uploaded\";\n\nexport const createGroupUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number\n): EShapeGroupUploaded | null => {\n\treturn new EShapeGroupUploaded(\n\t\tbuffer,\n\t\tvoffset, ioffset\n\t).init( shape );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDDiagramSerializedFill, DDiagramSerializedStroke, DDiagramSerializedTagRange,\n\tDDiagramSerializedTagValue, DDiagramSerializedText, DDiagramSerializedTextOutline\n} from \"../d-diagram-serialized\";\nimport { EShapeActionValue } from \"./action/e-shape-action-value\";\nimport { EShapeEmbeddedDatum } from \"./variant/e-shape-embedded-datum\";\n\nexport interface EShapeResourceManagerDeserializationSerialized {\n\tresources: string[];\n\ttags?: string[];\n}\n\nexport class EShapeResourceManagerDeserialization {\n\tresources: string[];\n\ttags: string[];\n\tpieces?: string[];\n\tpieceData?: Map<string, EShapeEmbeddedDatum>;\n\tisEditMode: boolean;\n\n\tprotected _actions: Map<number, EShapeActionValue>;\n\tprotected _fills: Map<number, DDiagramSerializedFill>;\n\tprotected _strokes: Map<number, DDiagramSerializedStroke>;\n\tprotected _tagValues: Map<number, DDiagramSerializedTagValue>;\n\tprotected _tags: Map<number, number[]>;\n\tprotected _ranges: Map<number, DDiagramSerializedTagRange>;\n\tprotected _aligns: Map<number, [ number, number ]>;\n\tprotected _margins: Map<number, [ number, number ]>;\n\tprotected _texts: Map<number, DDiagramSerializedText>;\n\tprotected _textOutlines: Map<number, DDiagramSerializedTextOutline>;\n\tprotected _extensions: Map<number, unknown>;\n\n\tconstructor(\n\t\tserialized: EShapeResourceManagerDeserializationSerialized,\n\t\tpieces: string[] | undefined,\n\t\tpieceData: Map<string, EShapeEmbeddedDatum> | undefined,\n\t\tisEditMode: boolean\n\t) {\n\t\tthis.resources = serialized.resources;\n\t\tthis.tags = serialized.tags || serialized.resources;\n\t\tthis.pieces = pieces;\n\t\tthis.pieceData = pieceData;\n\t\tthis.isEditMode = isEditMode;\n\n\t\tthis._actions = new Map<number, EShapeActionValue>();\n\t\tthis._fills = new Map<number, DDiagramSerializedFill>();\n\t\tthis._strokes = new Map<number, DDiagramSerializedStroke>();\n\t\tthis._tags = new Map<number, number[]>();\n\t\tthis._tagValues = new Map<number, DDiagramSerializedTagValue>();\n\t\tthis._ranges = new Map<number, DDiagramSerializedTagRange>();\n\t\tthis._aligns = new Map<number, [ number, number ]>();\n\t\tthis._margins = new Map<number, [ number, number ]>();\n\t\tthis._texts = new Map<number, DDiagramSerializedText>();\n\t\tthis._textOutlines = new Map<number, DDiagramSerializedTextOutline>();\n\t\tthis._extensions = new Map<number, unknown>();\n\t}\n\n\tgetAction( id: number ): EShapeActionValue | undefined {\n\t\treturn this._actions.get( id );\n\t}\n\n\tsetAction( id: number, action: EShapeActionValue ): void {\n\t\tthis._actions.set( id, action );\n\t}\n\n\tgetFill( id: number ): DDiagramSerializedFill | undefined {\n\t\treturn this._fills.get( id );\n\t}\n\n\tsetFill( id: number, fill: DDiagramSerializedFill ): void {\n\t\tthis._fills.set( id, fill );\n\t}\n\n\tgetStroke( id: number ): DDiagramSerializedStroke | undefined {\n\t\treturn this._strokes.get( id );\n\t}\n\n\tsetStroke( id: number, stroke: DDiagramSerializedStroke ): void {\n\t\tthis._strokes.set( id, stroke );\n\t}\n\n\tgetTag( id: number ): number[] | undefined {\n\t\treturn this._tags.get( id );\n\t}\n\n\tsetTag( id: number, tag: number[] ): void {\n\t\tthis._tags.set( id, tag );\n\t}\n\n\tgetTagValue( id: number ): DDiagramSerializedTagValue | undefined {\n\t\treturn this._tagValues.get( id );\n\t}\n\n\tsetTagValue( id: number, tagValue: DDiagramSerializedTagValue ): void {\n\t\tthis._tagValues.set( id, tagValue );\n\t}\n\n\tgetRange( id: number ): DDiagramSerializedTagRange | undefined {\n\t\treturn this._ranges.get( id );\n\t}\n\n\tsetRange( id: number, range: DDiagramSerializedTagRange ): void {\n\t\tthis._ranges.set( id, range );\n\t}\n\n\tgetAlign( id: number ): [ number, number ] | undefined {\n\t\treturn this._aligns.get( id );\n\t}\n\n\tsetAlign( id: number, align: [ number, number ] ): void {\n\t\tthis._aligns.set( id, align );\n\t}\n\n\tgetMargin( id: number ): [ number, number ] | undefined {\n\t\treturn this._margins.get( id );\n\t}\n\n\tsetMargin( id: number, margin: [ number, number ] ): void {\n\t\tthis._margins.set( id, margin );\n\t}\n\n\tgetText( id: number ): DDiagramSerializedText | undefined {\n\t\treturn this._texts.get( id );\n\t}\n\n\tsetText( id: number, text: DDiagramSerializedText ): void {\n\t\tthis._texts.set( id, text );\n\t}\n\n\tgetTextOutline( id: number ): DDiagramSerializedTextOutline | undefined {\n\t\treturn this._textOutlines.get( id );\n\t}\n\n\tsetTextOutline( id: number, textOutline: DDiagramSerializedTextOutline ): void {\n\t\tthis._textOutlines.set( id, textOutline );\n\t}\n\n\tgetExtension<T>( id: number ): T | undefined {\n\t\treturn this._extensions.get( id ) as T | undefined;\n\t}\n\n\tsetExtension( id: number, extension: unknown ): void {\n\t\tthis._extensions.set( id, extension );\n\t}\n}\n","import { EShapeLayerContainer } from \"../e-shape-layer-container\";\n\nexport class EShapeEmbeddedDatum {\n\tname: string;\n\twidth: number;\n\theight: number;\n\tlayer: EShapeLayerContainer;\n\n\tconstructor( name: string, width: number, height: number, layer: EShapeLayerContainer ) {\n\t\tthis.name = name;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.layer = layer;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\n\nexport class EShapeGroupFillViewer implements EShapeFill {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeFillLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable: boolean, color: number, alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupFillViewer {\n\t\treturn new EShapeGroupFillViewer();\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\n\nexport class EShapeEditor {\n\tlocalTransform: Matrix;\n\tinternalTransform: Matrix;\n\tinternalTransformParentInverse: Matrix;\n\trotation: number;\n\tsize: Point;\n\n\tconstructor() {\n\t\tthis.localTransform = new Matrix();\n\t\tthis.internalTransform = new Matrix();\n\t\tthis.internalTransformParentInverse = new Matrix();\n\t\tthis.rotation = 0;\n\t\tthis.size = new Point();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeEditor } from \"./e-shape-editor\";\nimport { EShapeSizes } from \"./e-shape-sizes\";\nimport { EShapeBase } from \"./variant/e-shape-base\";\n\nexport class EShapeTransforms {\n\tstatic prepare( shape: EShape ): void {\n\t\tconst editor = shape.editor = (shape.editor || new EShapeEditor());\n\n\t\t// Ttransform\n\t\tshape.updateTransform();\n\t\tconst parent = shape.parent;\n\t\tif( parent instanceof EShapeBase ) {\n\t\t\tparent.transform.internalTransform.copyTo(editor.internalTransformParentInverse).invert();\n\t\t} else {\n\t\t\teditor.internalTransformParentInverse.identity();\n\t\t}\n\t\tshape.transform.internalTransform.copyTo(editor.internalTransform);\n\n\t\t// Rotation\n\t\teditor.rotation = shape.transform.rotation;\n\n\t\t// Size\n\t\teditor.size.copyFrom( shape.size );\n\n\t\t//\n\t\tshape.disallowOnTransformChange();\n\t}\n\n\tstatic finalize( shape: EShape ): void {\n\t\tshape.allowOnTransformChange( true );\n\t}\n\n\tstatic apply( shape: EShape, transform: Matrix, keepSize: boolean ): void {\n\t\tconst editor = shape.editor;\n\t\tif( editor != null ) {\n\t\t\tconst newLocalTransform = editor.localTransform;\n\t\t\teditor.internalTransformParentInverse.copyTo(newLocalTransform)\n\t\t\t\t.append(transform).append(editor.internalTransform);\n\t\t\tif( keepSize ) {\n\t\t\t\tthis.applyLocal( shape, newLocalTransform );\n\t\t\t} else {\n\t\t\t\tconst size = editor.size;\n\t\t\t\tthis.applyLocal( shape, newLocalTransform, size.x, size.y );\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic applyLocal( shape: EShape, localTransform: Matrix, bx?: number, by?: number ): void {\n\t\tshape.disallowUploadedUpdate();\n\n\t\t// Reconstruct the position, the rotation and the size\n\t\tconst a = localTransform.a;\n\t\tconst b = localTransform.b;\n\t\tconst c = localTransform.c;\n\t\tconst d = localTransform.d;\n\t\tconst tx = localTransform.tx;\n\t\tconst ty = localTransform.ty;\n\n\t\t// Rotation\n\t\tconst transform = shape.transform;\n\t\tconst rx = Math.atan2(-c, d); // rotation - skewX\n\t\tconst ry = Math.atan2(+b, a); // rotation + skewY\n\t\ttransform.rotation = (rx + ry) * 0.5; // Here, assumes `skewX` === `skewY`\n\n\t\t// Skew\n\t\tconst skew = (ry - rx) * 0.5;\n\t\ttransform.skew.set(skew, skew);\n\n\t\t// Position: Assumes the pivot is invariant.\n\t\t// tx = position.x - (a * px + c * py)\n\t\t// ty = position.y - (b * px + d * py)\n\t\t//\n\t\t// Thus,\n\t\t// position.x = tx + (a * px + c * py)\n\t\t// position.y = ty + (b * px + d * py)\n\t\tconst pivot = transform.pivot;\n\t\tconst px = pivot.x;\n\t\tconst py = pivot.y;\n\t\ttransform.position.set(\n\t\t\ttx + (a * px + c * py),\n\t\t\tty + (b * px + d * py)\n\t\t);\n\n\t\t// Scale\n\t\tif( bx != null && by != null ) {\n\t\t\tconst sx = Math.sqrt( a * a + b * b );\n\t\t\tconst sy = Math.sqrt( c * c + d * d );\n\t\t\tshape.size.set(\n\t\t\t\tEShapeSizes.toNormalized( bx * sx ),\n\t\t\t\tEShapeSizes.toNormalized( by * sy )\n\t\t\t);\n\t\t}\n\n\t\t//\n\t\tshape.allowUploadedUpdate();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapeTransforms } from \"../e-shape-transforms\";\n\nexport class EShapeGroupSizeLayout implements EShapeLayout {\n\tprotected static WORK_TRANSFORM: Matrix = new Matrix();\n\n\tprotected shape: EShape;\n\tprotected base: Point;\n\tprotected shapeBase: Point;\n\tprotected transform: Matrix;\n\n\tconstructor( shape: EShape, bx: number, by: number ) {\n\t\tthis.shape = shape;\n\n\t\t// Base group size\n\t\tthis.base = new Point( bx, by );\n\n\t\t// Base shape size\n\t\tconst size = shape.size;\n\t\tthis.shapeBase = new Point( size.x, size.y );\n\n\t\t// Transform\n\t\tthis.transform = new Matrix();\n\t\tshape.updateTransform();\n\t\tshape.transform.localTransform.copyTo( this.transform );\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\treturn this.shape === shape;\n\t}\n\n\treset( shape: EShape, baseX: number, baseY: number ): void {\n\t\tthis.base.set( baseX, baseY );\n\n\t\t// Base shape size\n\t\tconst size = shape.size;\n\t\tthis.shapeBase.copyFrom( size );\n\n\t\t// Transform\n\t\tshape.updateTransform();\n\t\tshape.transform.localTransform.copyTo( this.transform );\n\t}\n\n\tupdate(\n\t\tshape: EShape, baseX: number, baseY: number,\n\t\tpivotX: number, pivotY: number\n\t) {\n\t\tconst sx = baseX / this.base.x;\n\t\tconst sy = baseY / this.base.y;\n\t\tconst childBase = this.shapeBase;\n\t\tconst transform = EShapeGroupSizeLayout.WORK_TRANSFORM;\n\t\ttransform.identity()\n\t\t\t.append( this.transform )\n\t\t\t.translate( -pivotX, -pivotY )\n\t\t\t.scale( sx, sy )\n\t\t\t.translate( +pivotX, +pivotY );\n\t\tshape.disallowOnTransformChange();\n\t\tEShapeTransforms.applyLocal( shape, transform, childBase.x, childBase.y );\n\t\tshape.allowOnTransformChange( false );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point, Rectangle } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeLayout } from \"../e-shape-layout\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeLayout } from \"./e-shape-group-size-layout\";\nimport { EShapeGroupSizeParent } from \"./e-shape-group-size-parent\";\n\nexport class EShapeGroupSizeEditor implements EShapeGroupSize {\n\tprotected _parent: EShapeGroupSizeParent;\n\tprotected _size: Point;\n\tprotected _layouts: EShapeLayout[];\n\tprotected _workPoint: Point = new Point();\n\tprotected _workRectForCalcRect: Rectangle = new Rectangle();\n\tprotected _workRectForFit: Rectangle = new Rectangle();\n\tprotected _isFittable: boolean;\n\n\tconstructor( parent: EShapeGroupSizeParent, x: number, y: number, isFittable: boolean ) {\n\t\tthis._parent = parent;\n\t\tthis._layouts = [];\n\t\tthis._size = new Point( x, y );\n\t\tthis._isFittable = isFittable;\n\t}\n\n\tinit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget x(): number {\n\t\treturn this._size.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst size = this._size;\n\t\tif( size.x !== x ) {\n\t\t\tconst ox = size.x;\n\t\t\tsize.x = x;\n\t\t\tthis.onChange( ox, size.y );\n\t\t}\n\t}\n\n\tget y(): number {\n\t\treturn this._size.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst size = this._size;\n\t\tif( size.y !== y ) {\n\t\t\tconst oy = size.y;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( size.x, oy );\n\t\t}\n\t}\n\n\tset( x?: number, y?: number ): this {\n\t\tlet isChanged = false;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( x != null && ox !== x ) {\n\t\t\tisChanged = true;\n\t\t\tsize.x = x;\n\t\t}\n\t\tif( y != null && oy !== y ) {\n\t\t\tisChanged = true;\n\t\t\tsize.y = y;\n\t\t}\n\t\tif( isChanged ) {\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tclone(): EShapeGroupSizeEditor {\n\t\tconst size = this._size;\n\t\treturn new EShapeGroupSizeEditor( this._parent, size.x, size.y, this._isFittable );\n\t}\n\n\tcopy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tcopyFrom( point: IPoint ): this {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( ox !== x || oy !== y ) {\n\t\t\tsize.x = x;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( point: IPoint ): IPoint {\n\t\treturn this._size.copyTo( point );\n\t}\n\n\tequals( point: IPoint ): boolean {\n\t\treturn this._size.equals( point );\n\t}\n\n\tfit(): void {\n\t\tif( this._isFittable ) {\n\t\t\tthis.doFit();\n\t\t}\n\t}\n\n\tprotected doFit(): void {\n\t\tconst parent = this._parent;\n\t\tparent.disallowOnTransformChange();\n\n\t\t// Calculate the rect\n\t\tconst rect = this.calcRect( this._workRectForFit );\n\n\t\t// Set size\n\t\tconst size = this._size;\n\t\tsize.set( rect.width, rect.height );\n\n\t\t// Position & Pivot\n\t\t// rx := rect.x\n\t\t// ry := rect.y\n\t\t//\n\t\t// | a c tx | | 1 0 +rx | | 1 0 -rx |   | a c tx + (a * rx + c * ry) | | 1 0 -rx |\n\t\t// | b d ty | | 0 1 +ry | | 0 1 -ry | = | b d ty + (b * rx + d * ry) | | 0 1 -ry |\n\t\t// | 0 0 1  | | 0 0  1  | | 0 0  1  |   | 0 0 1                      | | 0 0  1  |\n\t\t//\n\t\t// tx -> tx + (a * rx + c * ry) = poxition.x - (a * pivot.x + c * pivot.y)\n\t\t// ty -> ty + (b * rx + d * ry) = poxition.y - (b * pivot.x + d * pivot.y)\n\t\t// position.x -> position.x + (a * rx + c * ry) - (a * pivot.x + c * pivot.y)\n\t\t// position.y -> position.y + (b * rx + d * ry) - (b * pivot.x + d * pivot.y)\n\t\t// pivot.x -> 0\n\t\t// pivot.y -> 0\n\t\t//\n\t\t// a -> a', b -> b', c -> c', tx -> tx', ty -> ty'\n\t\t//\n\t\t// | a' c' tx' | | 1 0 -rx |   | a' c' tx' - (a' * rx + c' * ry) |\n\t\t// | b' d' ty' | | 0 1 -ry | = | b' d' ty' - (b' * rx + d' * ry) |\n\t\t// | 0  0  1   | | 0 0  1  |   | 0  0  1                         |\n\t\t//\n\t\t// tx' -> tx' - (a' * rx + c' * ry) = poxition.x - (a' * pivot.x + c' * pivot.y)\n\t\t// ty' -> ty' - (b' * rx + d' * ry) = poxition.y - (b' * pivot.x + d' * pivot.y)\n\t\t// pivot.x -> pivot.x + rx\n\t\t// pivot.y -> pivot.y + ry\n\t\tparent.updateTransform();\n\t\tconst transform = parent.transform;\n\t\tconst x = rect.x + rect.width * 0.5;\n\t\tconst y = rect.y + rect.height * 0.5;\n\t\tconst position = transform.position;\n\t\tconst localTransform = transform.localTransform;\n\t\tconst a = localTransform.a;\n\t\tconst b = localTransform.b;\n\t\tconst c = localTransform.c;\n\t\tconst d = localTransform.d;\n\t\tconst pivot = transform.pivot;\n\t\tposition.set(\n\t\t\tposition.x + (a * x + c * y) - (a * pivot.x + c * pivot.y),\n\t\t\tposition.y + (b * x + d * y) - (b * pivot.x + d * pivot.y)\n\t\t);\n\t\tpivot.set( x, y );\n\n\t\t// Reset the data\n\t\tthis.reset( parent.children, this._layouts, size );\n\n\t\t//\n\t\tparent.allowOnTransformChange( true );\n\t}\n\n\tprotected reset( children: EShape[], layouts: EShapeLayout[], size: IPoint ): void {\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = layouts[ i ];\n\t\t\tif( layout.isCompatible( child ) ) {\n\t\t\t\tlayout.reset( child, size.x, size.y );\n\t\t\t} else {\n\t\t\t\tlayouts.length = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif( children.length < layouts.length ) {\n\t\t\tlayouts.length = children.length;\n\t\t}\n\t}\n\n\tcalcRect( result: Rectangle ): Rectangle {\n\t\tconst parent = this._parent;\n\t\tconst children = parent.children;\n\t\tif( children.length <= 0 ) {\n\t\t\tresult.x = 0;\n\t\t\tresult.y = 0;\n\t\t\tresult.width = 0;\n\t\t\tresult.height = 0;\n\t\t} else {\n\t\t\tconst workPoint = this._workPoint;\n\t\t\tconst workRect = this._workRectForCalcRect;\n\t\t\tchildren[ 0 ].getBoundsLocal( workPoint, false, result );\n\t\t\tfor( let i = 1, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tchild.getBoundsLocal( workPoint, false, workRect );\n\t\t\t\tresult.enlarge( workRect );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onChange( ox: number, oy: number ): void {\n\t\tconst parent = this._parent;\n\t\tconst size = this._size;\n\t\tconst pivot = parent.transform.pivot;\n\t\tthis.onChange_( parent.children, this._layouts, size.x, size.y, pivot.x, pivot.y, ox, oy );\n\t\tparent.onSizeChange();\n\t}\n\n\tprotected onChange_(\n\t\tchildren: EShape[],\n\t\tlayouts: EShapeLayout[],\n\t\tsx: number, sy: number,\n\t\tpx: number, py: number,\n\t\tox: number, oy: number\n\t): void {\n\t\tfor( let i = 0, imax = Math.min( layouts.length, children.length ); i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = layouts[ i ];\n\t\t\tif( layout.isCompatible( child ) ) {\n\t\t\t\tlayout.update( child, sx, sy, px, py );\n\t\t\t} else {\n\t\t\t\tlayouts.length = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tfor( let i = layouts.length, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst layout = this.newLayout( child, ox, oy );\n\t\t\tlayout.update( child, sx, sy, px, py );\n\t\t\tlayouts.push( layout );\n\t\t}\n\t\tif( layouts.length !== children.length ) {\n\t\t\tlayouts.length = children.length;\n\t\t}\n\t}\n\n\tprotected newLayout( shape: EShape, ox: number, oy: number ): EShapeLayout {\n\t\treturn shape.layout || new EShapeGroupSizeLayout( shape, ox, oy );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\n\nexport interface EShapeGroupSizeViewerParentTransform {\n\tscale: IPoint;\n}\n\nexport interface EShapeGroupSizeViewerParent {\n\treadonly transform: EShapeGroupSizeViewerParentTransform;\n}\n\nexport class EShapeGroupSizeViewer implements EShapeGroupSize {\n\tprotected _x: number;\n\tprotected _y: number;\n\tprotected _parent: EShapeGroupSizeViewerParent;\n\tprotected _base: Point;\n\n\tconstructor( parent: EShapeGroupSizeViewerParent, x: number, y: number, bx: number, by: number ) {\n\t\tthis._parent = parent;\n\t\tthis._x = x;\n\t\tthis._y = y;\n\t\tthis._base = new Point( bx, by );\n\t}\n\n\tget x() {\n\t\treturn this._x;\n\t}\n\n\tset x( x: number ) {\n\t\tif( this._x !== x ) {\n\t\t\tthis._x = x;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget y() {\n\t\treturn this._y;\n\t}\n\n\tset y( y: number ) {\n\t\tif (this._y !== y) {\n\t\t\tthis._y = y;\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget base(): IPoint {\n\t\treturn this._base;\n\t}\n\n\tinit(): void {\n\t\tthis._base.copyFrom( this );\n\t\tthis.onChange();\n\t}\n\n\tclone(): EShapeGroupSizeViewer {\n\t\tconst base = this._base;\n\t\treturn new EShapeGroupSizeViewer( this._parent, this._x, this._y, base.x, base.y );\n\t}\n\n\tset( x?: number, y?: number ): this {\n\t\tlet isChanged = false;\n\t\tif( x != null && this._x !== x ) {\n\t\t\tthis._x = x;\n\t\t\tisChanged = true;\n\t\t}\n\t\tif( y != null && this._y !== y) {\n\t\t\tthis._y = y;\n\t\t\tisChanged = true;\n\t\t}\n\t\tif( isChanged ) {\n\t\t\tthis.onChange();\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyFrom( p: IPoint ): this {\n\t\tif( p instanceof EShapeGroupSizeViewer ) {\n\t\t\tthis._base.copyFrom( p.base );\n\t\t}\n\t\tif( this._x !== p.x || this._y !== p.y ) {\n\t\t\tthis._x = p.x;\n\t\t\tthis._y = p.y;\n\t\t\tthis.onChange();\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( p: IPoint ): IPoint {\n\t\tif( p instanceof EShapeGroupSizeViewer ) {\n\t\t\tthis._base.copyTo( p.base );\n\t\t}\n\t\tp.set(this._x, this._y);\n\t\treturn p;\n\t}\n\n\tequals( p: IPoint ): boolean {\n\t\treturn (p.x === this._x) && (p.y === this._y);\n\t}\n\n\tfit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onChange(): void {\n\t\tconst base = this._base;\n\t\tthis._parent.transform.scale.set(\n\t\t\tthis._x / base.x,\n\t\t\tthis._y / base.y\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\n\nexport class EShapeGroupStrokeViewer implements EShapeStroke {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget width(): number {\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget align(): number {\n\t\treturn 0.0;\n\t}\n\n\tset align( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\treturn EShapeStrokeSide.NONE;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number, side?: EShapeStrokeSide ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupStrokeViewer {\n\t\treturn new EShapeGroupStrokeViewer();\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0,\n\t\t\talign: 0.0,\n\t\t\tside: EShapeStrokeSide.NONE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DLinkMenuItemId {\n\tOPEN_LINK_IN_NEW_WINDOW,\n\tCOPY_LINK_ADDRESS\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\n\nexport class EShapeGroupTextAlignViewer implements EShapeTextAlign {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\treturn {\n\t\t\thorizontal: EShapeTextAlignHorizontal.CENTER,\n\t\t\tvertical: EShapeTextAlignVertical.MIDDLE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextOffsetViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\n\nexport class EShapeGroupTextOutlineViewer implements EShapeTextOutline {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget enable(): boolean {\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget width(): number {\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ) {\n\t\t// DO NOTHING\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroupTextOutlineViewer {\n\t\treturn new EShapeGroupTextOutlineViewer();\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextPaddingViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffset, EShapeTextOffsetLike } from \"../e-shape-text-offset\";\n\nexport class EShapeGroupTextSpacingViewer implements EShapeTextOffset {\n\tconstructor() {\n\t\t// DO NOTHING\n\t}\n\n\tget horizontal(): number {\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget vertical(): number {\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: Partial<EShapeTextOffsetLike> ): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( horizontal?: number, vertical?: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeGroupTextAlignViewer } from \"./e-shape-group-text-align-viewer\";\nimport { EShapeGroupTextOffsetViewer } from \"./e-shape-group-text-offset-viewer\";\nimport { EShapeGroupTextOutlineViewer } from \"./e-shape-group-text-outline-viewer\";\nimport { EShapeGroupTextPaddingViewer } from \"./e-shape-group-text-padding-viewer\";\nimport { EShapeGroupTextSpacingViewer } from \"./e-shape-group-text-spacing-viewer\";\n\nexport class EShapeGroupTextViewer implements EShapeText {\n\talign: EShapeGroupTextAlignViewer;\n\toffset: EShapeGroupTextOffsetViewer;\n\toutline: EShapeGroupTextOutlineViewer;\n\tspacing: EShapeGroupTextSpacingViewer;\n\tpadding: EShapeGroupTextPaddingViewer;\n\n\tconstructor() {\n\t\tthis.align = new EShapeGroupTextAlignViewer();\n\t\tthis.offset = new EShapeGroupTextOffsetViewer();\n\t\tthis.outline = new EShapeGroupTextOutlineViewer();\n\t\tthis.spacing = new EShapeGroupTextSpacingViewer();\n\t\tthis.padding = new EShapeGroupTextPaddingViewer();\n\t}\n\n\tget enable(): boolean {\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tget value(): string {\n\t\treturn \"\";\n\t}\n\n\tset value( value: string ) {\n\t\t// DO NOTHING\n\t}\n\n\tget color(): number {\n\t\treturn 0x000000;\n\t}\n\n\tset color( color: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget alpha(): number {\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget family(): string {\n\t\treturn \"auto\";\n\t}\n\n\tset family( family: string ) {\n\t\t// DO NOTHING\n\t}\n\n\tget size(): number {\n\t\treturn 24;\n\t}\n\n\tset size( size: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\treturn EShapeTextWeight.NORMAL;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\t// DO NOTHING\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\treturn EShapeTextStyle.NORMAL;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\t// DO NOTHING\n\t}\n\n\tget direction(): number {\n\t\treturn EShapeTextDirection.LEFT_TO_RIGHT;\n\t}\n\n\tset direction( direction: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget clipping(): boolean {\n\t\treturn false;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\t// DO NOTHING\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection,\n\t\tclipping?: boolean\n\t): this {\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\treturn {\n\t\t\tvalue: \"\",\n\t\t\tcolor: 0x000000,\n\t\t\talpha: 1.0,\n\t\t\tfamily: \"auto\",\n\t\t\tsize: 24,\n\t\t\tweight: EShapeTextWeight.NORMAL,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: EShapeTextStyle.NORMAL,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tdirection: EShapeTextDirection.LEFT_TO_RIGHT,\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: false\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","import { IPoint } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeGroupFillViewer } from \"./e-shape-group-fill-viewer\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeEditor } from \"./e-shape-group-size-editor\";\nimport { EShapeGroupSizeViewer } from \"./e-shape-group-size-viewer\";\nimport { EShapeGroupStrokeViewer } from \"./e-shape-group-stroke-viewer\";\nimport { EShapeGroupTextViewer } from \"./e-shape-group-text-viewer\";\nimport { EShapeTagImpl } from \"./e-shape-tag-impl\";\n\nexport abstract class EShapeGroupViewer extends EShapeBase {\n\tsize: EShapeGroupSize;\n\tfill: EShapeFill;\n\tstroke: EShapeStroke;\n\ttag: EShapeTag;\n\ttext: EShapeText;\n\n\tprotected _isEditMode: boolean;\n\n\tconstructor( isEditMode: boolean, type: EShapeType ) {\n\t\tsuper( type );\n\t\tthis._isEditMode = isEditMode;\n\t\tthis.tag = this.newTag();\n\t\tthis.size = this.newGroupSize( isEditMode );\n\t\tthis.fill = this.newGroupFill();\n\t\tthis.stroke = this.newGroupStroke();\n\t\tthis.text = this.newGroupText();\n\t}\n\n\tget isEditMode(): boolean {\n\t\treturn this._isEditMode;\n\t}\n\n\tprotected newGroupSize( isEditMode: boolean ): EShapeGroupSize {\n\t\tconst sizeX = EShapeDefaults.SIZE_X;\n\t\tconst sizeY = EShapeDefaults.SIZE_Y;\n\t\tif( isEditMode ) {\n\t\t\treturn new EShapeGroupSizeEditor( this, sizeX, sizeY, this.isGroupSizeFittable() );\n\t\t} else {\n\t\t\treturn new EShapeGroupSizeViewer( this, sizeX, sizeY, sizeX, sizeY );\n\t\t}\n\t}\n\n\tprotected isGroupSizeFittable(): boolean {\n\t\treturn true;\n\t}\n\n\tprotected newTag(): EShapeTag {\n\t\treturn new EShapeTagImpl();\n\t}\n\n\tprotected newGroupFill(): EShapeFill {\n\t\treturn new EShapeGroupFillViewer();\n\t}\n\n\tprotected newGroupStroke(): EShapeStroke {\n\t\treturn new EShapeGroupStrokeViewer();\n\t}\n\n\tprotected newGroupText(): EShapeText {\n\t\treturn new EShapeGroupTextViewer();\n\t}\n\n\tprotected getBoundsSize(): IPoint {\n\t\tconst size = this.size;\n\t\tif( size instanceof EShapeGroupSizeViewer ) {\n\t\t\treturn size.base;\n\t\t} else {\n\t\t\treturn size;\n\t\t}\n\t}\n\n\tonChildTransformChange(): void {\n\t\tsuper.onChildTransformChange();\n\t\tthis.size.fit();\n\t}\n\n\tget corner(): EShapeCorner {\n\t\treturn EShapeCorner.NONE;\n\t}\n\n\tset corner( corner: EShapeCorner ) {\n\t\t// DO NOTHING\n\t}\n\n\tget cursor(): string {\n\t\treturn \"\";\n\t}\n\n\tset cursor( cursor: string ) {\n\t\t// DO NOTHING\n\t}\n\n\tget gradient(): EShapeGradientLike | undefined {\n\t\treturn undefined;\n\t}\n\n\tset gradient( gradient: EShapeGradientLike | undefined ) {\n\t\t// DO NOTHING\n\t}\n\n\tget radius(): number {\n\t\treturn 0;\n\t}\n\n\tset radius( radius: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\treturn undefined;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\t// DO NOTHING\n\t}\n\n\tget points(): EShapePoints | undefined {\n\t\treturn undefined;\n\t}\n\n\tset points( points: EShapePoints | undefined ) {\n\t\t// DO NOTHING\n\t}\n\n\tabstract clone(): EShapeGroupViewer;\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn false;\n\t}\n}\n","import { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeGroupViewer } from \"./e-shape-group-viewer\";\n\nexport class EShapeEmbeddedLayer extends EShapeGroupViewer {\n\tprotected _name: string;\n\n\tconstructor( name: string, isEditMode: boolean, type = EShapeType.LAYER ) {\n\t\tsuper( isEditMode, type );\n\t\tthis._name = name;\n\t}\n\n\tprotected isGroupSizeFittable(): boolean {\n\t\treturn false;\n\t}\n\n\tclone(): EShapeEmbeddedLayer {\n\t\tconst result = this.newClone().copy( this );\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst clone = children[ i ].clone();\n\t\t\tclone.parent = result;\n\t\t\tresult.children.push( clone );\n\t\t}\n\t\tresult.onChildTransformChange();\n\t\tresult.toDirty();\n\t\tresult.size.init();\n\t\treturn result;\n\t}\n\n\tprotected newClone(): EShapeEmbeddedLayer {\n\t\tconst constructor = this.constructor as typeof EShapeEmbeddedLayer;\n\t\treturn new constructor(  this._name, this._isEditMode, this.type );\n\t}\n\n\tserializeChildren( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem[] {\n\t\treturn [];\n\t}\n\n\tserializeImage( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tserializeGradient( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n}\n","import { EShapeLayerContainer } from \"../e-shape-layer-container\";\nimport { EShapeEmbeddedLayer } from \"./e-shape-embedded-layer\";\n\nexport class EShapeEmbeddedLayerContainer implements EShapeLayerContainer {\n\tchildren: EShapeEmbeddedLayer[];\n\tprotected _x: number;\n\tprotected _y: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _isEditMode: boolean;\n\n\tconstructor( width: number, height: number, isEditMode: boolean ) {\n\t\tthis.children = [];\n\t\tthis._x = -width * 0.5;\n\t\tthis._y = -height * 0.5;\n\t\tthis._width = width;\n\t\tthis._height = height;\n\t\tthis._isEditMode = isEditMode;\n\t}\n\n\tcreate( name: string ): EShapeEmbeddedLayer {\n\t\tconst result = new EShapeEmbeddedLayer( name, this._isEditMode );\n\t\tresult.transform.position.set( this._x, this._y );\n\t\tresult.size.set( this._width, this._height ).init();\n\t\tthis.children.push( result );\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramBaseController } from \"./d-diagram-base\";\nimport { DDiagramLayerContainer } from \"./d-diagram-layer-container\";\nimport { DDiagramSerialized, DDiagramSerializedSimple } from \"./d-diagram-serialized\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeDeserializer } from \"./shape/e-shape-deserializer\";\nimport { EShapeLayerContainer } from \"./shape/e-shape-layer-container\";\nimport { EShapeResourceManagerDeserialization } from \"./shape/e-shape-resource-manager-deserialization\";\nimport { EShapeEmbeddedDatum } from \"./shape/variant/e-shape-embedded-datum\";\nimport { EShapeEmbeddedLayerContainer } from \"./shape/variant/e-shape-embedded-layer-container\";\n\nexport class DDiagrams {\n\tstatic toSimple( serialized: DDiagramSerialized ): DDiagramSerializedSimple {\n\t\tconst tags = serialized.tags;\n\t\tconst pieces = serialized.pieces;\n\t\treturn {\n\t\t\tversion: serialized.version,\n\t\t\tid: serialized.id,\n\t\t\tname: serialized.name,\n\t\t\ttags: (tags != null ? JSON.stringify(tags) : undefined),\n\t\t\tpieces: (pieces != null ? JSON.stringify(pieces) : undefined),\n\t\t\tthumbnail: serialized.thumbnail,\n\t\t\tdata: JSON.stringify({\n\t\t\t\twidth: serialized.width,\n\t\t\t\theight: serialized.height,\n\t\t\t\tbackground: serialized.background,\n\t\t\t\ttile: serialized.tile,\n\t\t\t\tresources: serialized.resources,\n\t\t\t\tlayers: serialized.layers,\n\t\t\t\titems: serialized.items,\n\t\t\t\tsnap: serialized.snap\n\t\t\t})\n\t\t};\n\t}\n\n\tstatic toSerialized( target: DDiagramSerializedSimple | DDiagramSerialized ): DDiagramSerialized {\n\t\tif( \"data\" in target ) {\n\t\t\tconst result: DDiagramSerialized = JSON.parse( target.data );\n\t\t\tresult.version = target.version;\n\t\t\tresult.id = target.id;\n\t\t\tresult.name = target.name;\n\t\t\tconst tags = target.tags;\n\t\t\tif( tags != null ) {\n\t\t\t\tresult.tags = JSON.parse(tags);\n\t\t\t}\n\t\t\tconst pieces = target.pieces;\n\t\t\tif( pieces != null ) {\n\t\t\t\tresult.pieces = JSON.parse(pieces);\n\t\t\t}\n\t\t\tresult.thumbnail = target.thumbnail;\n\t\t\treturn result;\n\t\t}\n\t\treturn target;\n\t}\n\n\tstatic newLayer(\n\t\tserialized: DDiagramSerialized,\n\t\tcontainer: DDiagramLayerContainer | EShapeLayerContainer,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): Promise<EShape[]> {\n\t\t// Layers\n\t\tconst serializedLayers = serialized.layers;\n\t\tfor( let i = 0, imax = serializedLayers.length; i < imax; ++i ) {\n\t\t\tcontainer.create( serializedLayers[ i ][ 0 ] || \"\" );\n\t\t}\n\n\t\t// Items\n\t\tconst serializedItems = serialized.items;\n\t\tconst shapePromises = EShapeDeserializer.deserializeAll( serializedItems, manager );\n\t\tif( shapePromises != null ) {\n\t\t\treturn shapePromises.then(( shapes: EShape[] ): EShape[] => {\n\t\t\t\tconst layers = container.children;\n\t\t\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\t\t\tconst serializedItem = serializedItems[ i ];\n\t\t\t\t\tconst shape = shapes[ i ];\n\t\t\t\t\tconst layer = layers[ serializedItem[ 16 ] ];\n\t\t\t\t\tif( layer != null ) {\n\t\t\t\t\t\tshape.attach( layer );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn shapes;\n\t\t\t});\n\t\t} else {\n\t\t\treturn Promise.resolve([]);\n\t\t}\n\t}\n\n\tstatic toPieceData(\n\t\tcontroller: DDiagramBaseController | null | undefined,\n\t\tpieces: string[] | null | undefined,\n\t\tisEditMode: boolean,\n\t\tmappings?: Map<string, EShapeEmbeddedDatum>\n\t): Promise<Map<string, EShapeEmbeddedDatum>> | undefined {\n\t\tif( pieces && 0 < pieces.length && controller ) {\n\t\t\tconst newMappings = mappings || new Map<string, EShapeEmbeddedDatum>();\n\t\t\treturn new Promise(( resolve ): void => {\n\t\t\t\tconst size = pieces.length;\n\t\t\t\tlet finished = size;\n\t\t\t\tconst onFinished = (): void => {\n\t\t\t\t\tfinished -= 1;\n\t\t\t\t\tif( finished <= 0 ) {\n\t\t\t\t\t\tresolve( newMappings );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tconst load = ( piece: string ): void => {\n\t\t\t\t\tif( newMappings.has( piece ) ) {\n\t\t\t\t\t\tonFinished();\n\t\t\t\t\t} else {\n\t\t\t\t\t\tcontroller.piece.getByName( piece ).then(( found ): void => {\n\t\t\t\t\t\t\tthis.toPieceDataSub( controller, piece, found, isEditMode, newMappings )\n\t\t\t\t\t\t\t.then( onFinished, onFinished );\n\t\t\t\t\t\t}, onFinished );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\t\t\tload( pieces[ i ] );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tstatic toPieceDataSub(\n\t\tcontroller: DDiagramBaseController,\n\t\tname: string,\n\t\tserializedOrSimple: DDiagramSerialized | DDiagramSerializedSimple,\n\t\tisEditMode: boolean,\n\t\tmappings: Map<string, EShapeEmbeddedDatum>\n\t): Promise<EShape[]> {\n\t\tconst serialized = this.toSerialized( serializedOrSimple );\n\t\tconst width = serialized.width;\n\t\tconst height = serialized.height;\n\t\tconst container = new EShapeEmbeddedLayerContainer( width, height, isEditMode );\n\n\t\tmappings.set( name, new EShapeEmbeddedDatum(\n\t\t\tname, width, height, container\n\t\t));\n\n\t\tconst pieces = serialized.pieces;\n\t\tconst pieceDataOrPromise = this.toPieceData(\n\t\t\tcontroller, pieces, isEditMode, mappings\n\t\t);\n\t\tif( pieceDataOrPromise == null ) {\n\t\t\treturn this.newLayer( serialized, container, new EShapeResourceManagerDeserialization(\n\t\t\t\tserialized, undefined, undefined, isEditMode\n\t\t\t));\n\t\t} else {\n\t\t\treturn pieceDataOrPromise.then(( pieceData ): Promise<EShape[]> => {\n\t\t\t\treturn this.newLayer( serialized, container, new EShapeResourceManagerDeserialization(\n\t\t\t\t\tserialized, pieces, pieceData, isEditMode\n\t\t\t\t));\n\t\t\t});\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextAlign, EShapeTextAlignLike } from \"../e-shape-text-align\";\nimport { EShapeTextAlignHorizontal } from \"../e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"../e-shape-text-align-vertical\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextAlignEditor implements EShapeTextAlign {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): EShapeTextAlignHorizontal {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.horizontal;\n\t\t}\n\t\treturn EShapeTextAlignHorizontal.CENTER;\n\t}\n\n\tset horizontal( horizontal: EShapeTextAlignHorizontal ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): EShapeTextAlignVertical {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.vertical;\n\t\t}\n\t\treturn EShapeTextAlignVertical.MIDDLE;\n\t}\n\n\tset vertical( vertical: EShapeTextAlignVertical ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextAlignLike> ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal?: EShapeTextAlignHorizontal, vertical?: EShapeTextAlignVertical ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.align.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextAlignLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.align.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: EShapeTextAlignHorizontal.CENTER,\n\t\t\tvertical: EShapeTextAlignVertical.MIDDLE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextOffsetEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.offset.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.offset.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOutline, EShapeTextOutlineLike } from \"../e-shape-text-outline\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextOutlineEditor implements EShapeTextOutline {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.enable;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.alpha = alpha;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.width;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.width = width;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeTextOutlineLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.copy( target );\n\t\t}\n\t}\n\n\tset( enable?: boolean, color?: number, alpha?: number, width?: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.outline.set( enable, color, alpha, width );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupTextOutlineEditor {\n\t\treturn new EShapeGroupTextOutlineEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeTextOutlineLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.outline.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextPaddingEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.padding.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.padding.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeTextOffsetLike } from \"../e-shape-text-offset\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupTextSpacingEditor {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget horizontal(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.horizontal;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset horizontal( horizontal: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.horizontal = horizontal;\n\t\t}\n\t}\n\n\tget vertical(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.vertical;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset vertical( vertical: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.vertical = vertical;\n\t\t}\n\t}\n\n\tcopy( target: EShapeTextOffsetLike ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.copy( target );\n\t\t}\n\t}\n\n\tset( horizontal: number, vertical: number ): void {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.spacing.set( horizontal, vertical );\n\t\t}\n\t}\n\n\ttoObject(): EShapeTextOffsetLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.spacing.toObject();\n\t\t}\n\t\treturn {\n\t\t\thorizontal: 0,\n\t\t\tvertical: 0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DeepPartial } from \"../../util/deep-partial\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText, EShapeTextLike, EShapeTextStyle, EShapeTextWeight } from \"../e-shape-text\";\nimport { EShapeTextDirection } from \"../e-shape-text-direction\";\nimport { EShapeTextOutline } from \"../e-shape-text-outline\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\nimport { EShapeGroupTextAlignEditor } from \"./e-shape-group-text-align-editor\";\nimport { EShapeGroupTextOffsetEditor } from \"./e-shape-group-text-offset-editor\";\nimport { EShapeGroupTextOutlineEditor } from \"./e-shape-group-text-outline-editor\";\nimport { EShapeGroupTextPaddingEditor } from \"./e-shape-group-text-padding-editor\";\nimport { EShapeGroupTextSpacingEditor } from \"./e-shape-group-text-spacing-editor\";\n\nexport class EShapeGroupTextEditor implements EShapeText {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\talign: EShapeGroupTextAlignEditor;\n\toffset: EShapeGroupTextOffsetEditor;\n\toutline: EShapeTextOutline;\n\tspacing: EShapeGroupTextSpacingEditor;\n\tpadding: EShapeGroupTextPaddingEditor;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\n\t\tthis.align = new EShapeGroupTextAlignEditor( parent );\n\t\tthis.offset = new EShapeGroupTextOffsetEditor( parent );\n\t\tthis.outline = new EShapeGroupTextOutlineEditor( parent );\n\t\tthis.spacing = new EShapeGroupTextSpacingEditor( parent );\n\t\tthis.padding = new EShapeGroupTextPaddingEditor( parent );\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.enable;\n\t\t}\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.enable = enable;\n\t\t}\n\t}\n\n\tget value(): string {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.value;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tset value( value: string ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.value = value;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.color;\n\t\t}\n\t\treturn 0x000000;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.alpha = alpha;\n\t\t}\n\t}\n\n\tget family(): string {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.family;\n\t\t}\n\t\treturn \"auto\";\n\t}\n\n\tset family( family: string ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.family = family;\n\t\t}\n\t}\n\n\tget size(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.size;\n\t\t}\n\t\treturn 24;\n\t}\n\n\tset size( size: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.size = size;\n\t\t}\n\t}\n\n\tget weight(): EShapeTextWeight {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.weight;\n\t\t}\n\t\treturn EShapeTextWeight.NORMAL;\n\t}\n\n\tset weight( weight: EShapeTextWeight ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.weight = weight;\n\t\t}\n\t}\n\n\tget style(): EShapeTextStyle {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.style;\n\t\t}\n\t\treturn EShapeTextStyle.NORMAL;\n\t}\n\n\tset style( style: EShapeTextStyle ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.style = style;\n\t\t}\n\t}\n\n\tget direction(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.direction;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tset direction( direction: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.direction = direction;\n\t\t}\n\t}\n\n\tget clipping(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.clipping;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset clipping( clipping: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.clipping = clipping;\n\t\t}\n\t}\n\n\tcopy( target?: DeepPartial<EShapeTextLike> ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.copy( target );\n\t\t}\n\t\treturn this;\n\t}\n\n\tset(\n\t\tvalue?: string, color?: number, alpha?: number,\n\t\tfamily?: string, size?: number, weight?: EShapeTextWeight,\n\t\tstyle?: EShapeTextStyle, direction?: EShapeTextDirection\n\t): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].text.set( value, color, alpha, family, size, weight, style, direction );\n\t\t}\n\t\treturn this;\n\t}\n\n\ttoObject(): EShapeTextLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].text.toObject();\n\t\t}\n\t\treturn {\n\t\t\tvalue: \"\",\n\t\t\tcolor: 0x000000,\n\t\t\talpha: 1.0,\n\t\t\tfamily: \"auto\",\n\t\t\tsize: 24,\n\t\t\tweight: EShapeTextWeight.NORMAL,\n\t\t\talign: this.align.toObject(),\n\t\t\toffset: this.offset.toObject(),\n\t\t\tstyle: EShapeTextStyle.NORMAL,\n\t\t\toutline: this.outline.toObject(),\n\t\t\tspacing: this.spacing.toObject(),\n\t\t\tdirection: EShapeTextDirection.LEFT_TO_RIGHT,\n\t\t\tpadding: this.padding.toObject(),\n\t\t\tclipping: false\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","import { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeGroupTextEditor } from \"./e-shape-group-text-editor\";\nimport { EShapeGroupViewer } from \"./e-shape-group-viewer\";\n\nexport class EShapeEmbedded extends EShapeGroupViewer {\n\tprotected _name: string;\n\n\tconstructor( name: string, isEditMode: boolean, type = EShapeType.EMBEDDED ) {\n\t\tsuper( isEditMode, type );\n\t\tthis._name = name;\n\t}\n\n\tget name(): string {\n\t\treturn this._name;\n\t}\n\n\tprotected newGroupText(): EShapeText {\n\t\treturn new EShapeGroupTextEditor( this );\n\t}\n\n\tprotected isGroupSizeFittable(): boolean {\n\t\treturn false;\n\t}\n\n\tclone(): EShapeEmbedded {\n\t\tconst result = this.newClone().copy( this );\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst clone = children[ i ].clone();\n\t\t\tclone.parent = result;\n\t\t\tresult.children.push( clone );\n\t\t}\n\t\tresult.onChildTransformChange();\n\t\tresult.toDirty();\n\t\treturn result;\n\t}\n\n\tprotected newClone(): EShapeEmbedded {\n\t\tconst constructor = this.constructor as typeof EShapeEmbedded;\n\t\treturn new constructor( this._name, this._isEditMode, this.type );\n\t}\n\n\tserializeChildren( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem[] {\n\t\treturn [];\n\t}\n\n\tserializeImage( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tserializeGradient( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): DDiagramSerializedItem {\n\t\tconst result = super.serialize( manager );\n\t\tresult[ 15 ] = manager.addPiece( this._name );\n\t\treturn result;\n\t}\n\n\taddUuid( manager: EShapeResourceManagerSerialization ): void {\n\t\tthis.uuid = manager.addUuid( this.uuid );\n\t}\n\n\tupdateUuid( manager: EShapeResourceManagerSerialization ): void {\n\t\tthis.uuid = manager.updateUuid( this.uuid );\n\t}\n}\n","import { DDiagramBaseController } from \"../../d-diagram-base\";\nimport { DDiagramSerialized, DDiagramSerializedItem, DDiagramSerializedSimple } from \"../../d-diagram-serialized\";\nimport { DDiagrams } from \"../../d-diagrams\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeLayerContainer } from \"../e-shape-layer-container\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeEmbedded } from \"./e-shape-embedded\";\nimport { EShapeEmbeddedDatum } from \"./e-shape-embedded-datum\";\nimport { EShapeEmbeddedLayerContainer } from \"./e-shape-embedded-layer-container\";\n\nexport class EShapeEmbeddeds {\n\tstatic from(\n\t\tserializedOrSimple: DDiagramSerialized | DDiagramSerializedSimple,\n\t\tcontroller: DDiagramBaseController | null | undefined,\n\t\tisEditMode: boolean\n\t): Promise<EShapeEmbedded> {\n\t\tconst serialized = DDiagrams.toSerialized( serializedOrSimple );\n\t\tconst pieces = serialized.pieces;\n\t\tconst pieceDataOrPromise = DDiagrams.toPieceData( controller, pieces, isEditMode );\n\t\tif( pieceDataOrPromise == null ) {\n\t\t\treturn this.from_( serialized, isEditMode );\n\t\t} else {\n\t\t\treturn pieceDataOrPromise.then(( pieceData ) => {\n\t\t\t\treturn this.from_( serialized, isEditMode, pieces, pieceData );\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected static from_(\n\t\tserialized: DDiagramSerialized,\n\t\tisEditMode: boolean,\n\t\tpieces?: string[],\n\t\tpieceData?: Map<string, EShapeEmbeddedDatum>\n\t): Promise<EShapeEmbedded> {\n\t\tconst width = serialized.width;\n\t\tconst height = serialized.height;\n\t\tconst container = new EShapeEmbeddedLayerContainer(\n\t\t\twidth, height, isEditMode\n\t\t);\n\t\tconst manager = new EShapeResourceManagerDeserialization(\n\t\t\tserialized, pieces, pieceData, isEditMode\n\t\t);\n\t\treturn DDiagrams.newLayer( serialized, container, manager ).then(() => {\n\t\t\treturn this.create( serialized.name, width, height, container, manager );\n\t\t});\n\t}\n\n\tstatic deserialize(\n\t\tname: string, width: number, height: number, layer: EShapeLayerContainer,\n\t\tmanager: EShapeResourceManagerDeserialization, item: DDiagramSerializedItem\n\t): Promise<EShapeEmbedded> | EShapeEmbedded {\n\t\tconst shape = new EShapeEmbedded( name, manager.isEditMode );\n\t\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\t\tconst shapeSize = shape.size;\n\t\tconst sizeX = shapeSize.x;\n\t\tconst sizeY = shapeSize.y;\n\t\tshape.size.set( width, height );\n\t\tthis.init( shape, layer );\n\t\tshape.size.set( sizeX, sizeY );\n\t\treturn result;\n\t}\n\n\tstatic create(\n\t\tname: string, width: number, height: number, layer: EShapeLayerContainer,\n\t\tmanager: EShapeResourceManagerDeserialization\n\t): EShapeEmbedded {\n\t\tconst shape = new EShapeEmbedded( name, manager.isEditMode );\n\t\tshape.size.set( width, height );\n\t\tthis.init( shape, layer );\n\t\treturn shape;\n\t}\n\n\tstatic init( shape: EShapeEmbedded, layer: EShapeLayerContainer ): void {\n\t\tconst layers = layer.children;\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\tconst clone = layers[ i ].clone();\n\t\t\tclone.parent = shape;\n\t\t\tchildren.push( clone );\n\t\t}\n\t\tshape.onChildTransformChange();\n\t\tshape.toDirty();\n\t\tshape.size.init();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeEmbedded } from \"./e-shape-embedded\";\nimport { EShapeEmbeddeds } from \"./e-shape-embeddeds\";\n\nexport const deserializeEmbedded = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeEmbedded> | EShapeEmbedded | null => {\n\tconst pieces = manager.pieces;\n\tconst pieceId = item[ 15 ];\n\tif( pieces && 0 <= pieceId && pieceId < pieces.length ) {\n\t\tconst pieceData = manager.pieceData;\n\t\tif( pieceData ) {\n\t\t\tconst piece = pieces[ pieceId ];\n\t\t\tconst pieceDatum = pieceData.get( piece );\n\t\t\tif( pieceDatum ) {\n\t\t\t\treturn EShapeEmbeddeds.deserialize(\n\t\t\t\t\tpiece, pieceDatum.width, pieceDatum.height,\n\t\t\t\t\tpieceDatum.layer, manager, item\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../e-shape-capabilities\";\nimport { EShapeCapability } from \"../e-shape-capability\";\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createGroupUploaded } from \"../variant/create-group-uploaded\";\nimport { deserializeEmbedded } from \"../variant/deserialize-embedded\";\n\nexport const loadShapeEmbedded = () => {\n\tEShapeUploadeds[ EShapeType.EMBEDDED ] = createGroupUploaded;\n\tEShapeDeserializers[ EShapeType.EMBEDDED ] = deserializeEmbedded;\n\tEShapeCapabilities.set( EShapeType.EMBEDDED, EShapeCapability.EMBEDDED );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeFill, EShapeFillLike } from \"../e-shape-fill\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupFillEditor implements EShapeFill {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.enable;\n\t\t}\n\t\treturn true;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.alpha = alpha;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeFillLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.copy( target );\n\t\t}\n\t}\n\n\tset( enable: boolean, color: number, alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].fill.set( enable, color, alpha );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupFillEditor {\n\t\treturn new EShapeGroupFillEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeFillLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].fill.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ) {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupPoints implements EShapePoints {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget length(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.length;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget id(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.id;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tget values(): number[] {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.values;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tset values( values: number[] ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.values = values;\n\t\t\t}\n\t\t}\n\t}\n\n\tget segments(): number[] {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.segments;\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tset segments( segments: number[] ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.segments = segments;\n\t\t\t}\n\t\t}\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\tconst points = children[ children.length - 1 ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.style;\n\t\t\t}\n\t\t}\n\t\treturn EShapePointsStyle.NONE;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.style = style;\n\t\t\t}\n\t\t}\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.copy( source );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tset( values?: number[], segments?: number[], style?: EShapePointsStyle ): this {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\tpoints.set( values, segments, style );\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\tclone( parent: EShape ): EShapeGroupPoints {\n\t\treturn new EShapeGroupPoints( parent );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.toPoints( transform );\n\t\t\t}\n\t\t}\n\t\treturn [];\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn points.serialize( manager );\n\t\t\t}\n\t\t}\n\t\treturn -1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeStroke, EShapeStrokeLike } from \"../e-shape-stroke\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\n\nexport class EShapeGroupStrokeEditor implements EShapeStroke {\n\tprotected _parent: EShapeGroupPropertyParent;\n\n\tconstructor( parent: EShapeGroupPropertyParent ) {\n\t\tthis._parent = parent;\n\t}\n\n\tget enable(): boolean {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.enable;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.enable = enable;\n\t\t}\n\t}\n\n\tget color(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.color;\n\t\t}\n\t\treturn 0xffffff;\n\t}\n\n\tset color( color: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.color = color;\n\t\t}\n\t}\n\n\tget alpha(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.alpha;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.alpha = alpha;\n\t\t}\n\t}\n\n\tget width(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.width;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset width( width: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.width = width;\n\t\t}\n\t}\n\n\tget align(): number {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.align;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset align( align: number ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.align = align;\n\t\t}\n\t}\n\n\tget side(): EShapeStrokeSide {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.side;\n\t\t}\n\t\treturn 1.0;\n\t}\n\n\tset side( side: EShapeStrokeSide ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.side = side;\n\t\t}\n\t}\n\n\tcopy( target?: Partial<EShapeStrokeLike> ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.copy( target );\n\t\t}\n\t}\n\n\tset( enable: boolean, color: number, alpha: number, width: number, side: EShapeStrokeSide ) {\n\t\tconst children = this._parent.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].stroke.set( enable, color, alpha, width, side );\n\t\t}\n\t}\n\n\tclone(): EShapeGroupStrokeEditor {\n\t\treturn new EShapeGroupStrokeEditor( this._parent );\n\t}\n\n\ttoObject(): EShapeStrokeLike {\n\t\tconst children = this._parent.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].stroke.toObject();\n\t\t}\n\t\treturn {\n\t\t\tenable: false,\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0,\n\t\t\twidth: 1.0,\n\t\t\talign: 0.0,\n\t\t\tside: EShapeStrokeSide.NONE\n\t\t};\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn -1;\n\t}\n\n\tdeserialize( target: number, manager: EShapeResourceManagerDeserialization ): void {\n\t\t//\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeFill } from \"../e-shape-fill\";\nimport { EShapeGradientLike } from \"../e-shape-gradient\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeTag } from \"../e-shape-tag\";\nimport { EShapeText } from \"../e-shape-text\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeGroupFillEditor } from \"./e-shape-group-fill-editor\";\nimport { EShapeGroupPoints } from \"./e-shape-group-points\";\nimport { EShapeGroupPropertyParent } from \"./e-shape-group-property-parent\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeEditor } from \"./e-shape-group-size-editor\";\nimport { EShapeGroupSizeViewer } from \"./e-shape-group-size-viewer\";\nimport { EShapeGroupStrokeEditor } from \"./e-shape-group-stroke-editor\";\nimport { EShapeGroupTextEditor } from \"./e-shape-group-text-editor\";\nimport { EShapeTagImpl } from \"./e-shape-tag-impl\";\n\nexport class EShapeGroup extends EShapeBase implements EShapeGroupPropertyParent {\n\tsize: EShapeGroupSize;\n\tfill: EShapeFill;\n\tstroke: EShapeStroke;\n\ttag: EShapeTag;\n\ttext: EShapeText;\n\n\tprotected _isEditMode: boolean;\n\tprotected _points?: EShapePoints;\n\n\tconstructor( isEditMode: boolean, type = EShapeType.GROUP ) {\n\t\tsuper( type );\n\t\tthis._isEditMode = isEditMode;\n\t\tthis.tag = new EShapeTagImpl();\n\t\tthis.size = this.newGroupSize( isEditMode );\n\t\tthis.fill = this.newGroupFill();\n\t\tthis.stroke = this.newGroupStroke();\n\t\tthis.text = this.newGroupText();\n\t\tthis._points = this.newGroupPoints();\n\t}\n\n\tget isEditMode(): boolean {\n\t\treturn this._isEditMode;\n\t}\n\n\tprotected newGroupSize( isEditMode: boolean ): EShapeGroupSize {\n\t\tconst sizeX = EShapeDefaults.SIZE_X;\n\t\tconst sizeY = EShapeDefaults.SIZE_Y;\n\t\tif( isEditMode ) {\n\t\t\treturn new EShapeGroupSizeEditor( this, sizeX, sizeY, this.isGroupSizeFittable() );\n\t\t} else {\n\t\t\treturn new EShapeGroupSizeViewer( this, sizeX, sizeY, sizeX, sizeY );\n\t\t}\n\t}\n\n\tprotected isGroupSizeFittable(): boolean {\n\t\treturn true;\n\t}\n\n\tprotected newGroupFill(): EShapeFill {\n\t\treturn new EShapeGroupFillEditor( this );\n\t}\n\n\tprotected newGroupStroke(): EShapeStroke {\n\t\treturn new EShapeGroupStrokeEditor( this );\n\t}\n\n\tprotected newGroupText(): EShapeText {\n\t\treturn new EShapeGroupTextEditor( this );\n\t}\n\n\tprotected newGroupPoints(): EShapePoints | undefined {\n\t\treturn new EShapeGroupPoints( this );\n\t}\n\n\tprotected getBoundsSize(): IPoint {\n\t\tconst size = this.size;\n\t\tif( size instanceof EShapeGroupSizeViewer ) {\n\t\t\treturn size.base;\n\t\t} else {\n\t\t\treturn size;\n\t\t}\n\t}\n\n\tonChildTransformChange(): void {\n\t\tsuper.onChildTransformChange();\n\t\tthis.size.fit();\n\t}\n\n\tget corner(): EShapeCorner {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].corner;\n\t\t}\n\t\treturn EShapeCorner.ALL;\n\t}\n\n\tset corner( corner: EShapeCorner ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].corner = corner;\n\t\t}\n\t}\n\n\tget cursor(): string {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].cursor;\n\t\t}\n\t\treturn \"\";\n\t}\n\n\tset cursor( cursor: string ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].cursor = cursor;\n\t\t}\n\t}\n\n\tget gradient(): EShapeGradientLike | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst gradient = children[ i ].gradient;\n\t\t\tif( gradient != null ) {\n\t\t\t\treturn gradient;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset gradient( gradient: EShapeGradientLike | undefined ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].gradient = gradient;\n\t\t}\n\t}\n\n\tget radius(): number {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\treturn children[ children.length - 1 ].radius;\n\t\t}\n\t\treturn 0.5;\n\t}\n\n\tset radius( radius: number ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].radius = radius;\n\t\t}\n\t}\n\n\tget image(): HTMLImageElement | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst image = children[ i ].image;\n\t\t\tif( image != null ) {\n\t\t\t\treturn image;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset image( image: HTMLImageElement | undefined ) {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].image = image;\n\t\t}\n\t}\n\n\tget points(): EShapePoints | undefined {\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst points = children[ i ].points;\n\t\t\tif( points != null ) {\n\t\t\t\treturn this._points;\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tset points( points: EShapePoints | undefined ) {\n\t\t// DO NOTHING\n\t}\n\n\tclone(): EShapeGroup {\n\t\tconst result = this.newClone().copy( this );\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst clone = children[ i ].clone();\n\t\t\tclone.parent = result;\n\t\t\tresult.children.push( clone );\n\t\t}\n\t\tresult.onChildTransformChange();\n\t\tresult.toDirty();\n\t\treturn result;\n\t}\n\n\tprotected newClone(): EShapeGroup {\n\t\tconst constructor = this.constructor as typeof EShapeGroup;\n\t\treturn new constructor( this._isEditMode, this.type );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeGroup } from \"./e-shape-group\";\n\nexport const deserializeGroup = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeGroup> | EShapeGroup => {\n\tconst shape = new EShapeGroup( manager.isEditMode );\n\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\tshape.size.init();\n\treturn result;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createGroupUploaded } from \"../variant/create-group-uploaded\";\nimport { deserializeGroup } from \"../variant/deserialize-group\";\n\nexport const loadShapeGroup = () => {\n\tEShapeUploadeds[ EShapeType.GROUP ] = createGroupUploaded;\n\tEShapeDeserializers[ EShapeType.GROUP ] = deserializeGroup;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeParent } from \"./e-shape-group-size-parent\";\n\nexport class EShapeGroupSizeShadowed implements EShapeGroupSize {\n\tprotected _parent: EShapeGroupSizeParent;\n\tprotected _size: Point;\n\n\tconstructor( parent: EShapeGroupSizeParent, x: number, y: number ) {\n\t\tthis._parent = parent;\n\t\tthis._size = new Point( x, y );\n\t}\n\n\tinit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget x(): number {\n\t\treturn this._size.x;\n\t}\n\n\tset x( x: number ) {\n\t\tconst size = this._size;\n\t\tif( size.x !== x ) {\n\t\t\tconst ox = size.x;\n\t\t\tsize.x = x;\n\t\t\tthis.onChange( ox, size.y );\n\t\t}\n\t}\n\n\tget y(): number {\n\t\treturn this._size.y;\n\t}\n\n\tset y( y: number ) {\n\t\tconst size = this._size;\n\t\tif( size.y !== y ) {\n\t\t\tconst oy = size.y;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( size.x, oy );\n\t\t}\n\t}\n\n\tset( x?: number | undefined, y?: number | undefined ): this {\n\t\tlet isChanged = false;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( x != null && ox !== x ) {\n\t\t\tisChanged = true;\n\t\t\tsize.x = x;\n\t\t}\n\t\tif( y != null && oy !== y ) {\n\t\t\tisChanged = true;\n\t\t\tsize.y = y;\n\t\t}\n\t\tif( isChanged ) {\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tclone(): EShapeGroupSizeShadowed {\n\t\tconst size = this._size;\n\t\treturn new EShapeGroupSizeShadowed( this._parent, size.x, size.y );\n\t}\n\n\tcopy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tcopyFrom( point: IPoint ): this {\n\t\tconst x = point.x;\n\t\tconst y = point.y;\n\t\tconst size = this._size;\n\t\tconst ox = size.x;\n\t\tconst oy = size.y;\n\t\tif( ox !== x || oy !== y ) {\n\t\t\tsize.x = x;\n\t\t\tsize.y = y;\n\t\t\tthis.onChange( ox, oy );\n\t\t}\n\t\treturn this;\n\t}\n\n\tcopyTo( point: IPoint ): IPoint {\n\t\treturn this._size.copyTo( point );\n\t}\n\n\tequals( point: IPoint ): boolean {\n\t\treturn this._size.equals( point );\n\t}\n\n\tfit(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onChange( ox: number, oy: number ): void {\n\t\tthis._parent.onSizeChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeGroup } from \"./e-shape-group\";\nimport { EShapeGroupSize } from \"./e-shape-group-size\";\nimport { EShapeGroupSizeShadowed } from \"./e-shape-group-size-shadowed\";\n\nexport class EShapeGroupShadowed extends EShapeGroup {\n\tconstructor( isEditMode: boolean, type: EShapeType = EShapeType.GROUP_SHADOWED ) {\n\t\tsuper( isEditMode, type );\n\t}\n\n\tprotected newGroupSize( isEditMode: boolean ): EShapeGroupSize {\n\t\tif( isEditMode ) {\n\t\t\treturn new EShapeGroupSizeShadowed(\n\t\t\t\tthis,\n\t\t\t\tEShapeDefaults.SIZE_X,\n\t\t\t\tEShapeDefaults.SIZE_Y\n\t\t\t);\n\t\t} else {\n\t\t\treturn super.newGroupSize( isEditMode );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeGroupShadowed } from \"./e-shape-group-shadowed\";\n\nexport const deserializeGroupShadowed = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeGroupShadowed> | EShapeGroupShadowed => {\n\tconst shape = new EShapeGroupShadowed( manager.isEditMode );\n\tconst result = EShapeDeserializer.deserialize( item, manager, shape );\n\tshape.size.init();\n\treturn result;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createGroupUploaded } from \"../variant/create-group-uploaded\";\nimport { deserializeGroupShadowed } from \"../variant/deserialize-group-shadowed\";\n\nexport const loadShapeGroupShadowed = () => {\n\tEShapeUploadeds[ EShapeType.GROUP_SHADOWED ] = createGroupUploaded;\n\tEShapeDeserializers[ EShapeType.GROUP_SHADOWED ] = deserializeGroupShadowed;\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { toLength } from \"./to-length\";\nimport { STEP_VALUES, toStep } from \"./to-step\";\n\nexport const RECTANGLE_VERTEX_COUNT = 18;\nexport const RECTANGLE_INDEX_COUNT = 12;\nexport const RECTANGLE_WORLD_SIZE: [ number, number, number ] = [ 0, 0, 0 ];\nconst RECTANGLE_WORK_POINT: Point = new Point();\n\nexport const buildRectangleClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst br = worldSize[ 0 ];\n\tconst bri = 1 - br;\n\tconst worldSizeX = worldSize[ 1 ];\n\tconst worldSizeY = worldSize[ 2 ];\n\tif( worldSizeX <= worldSizeY ) {\n\t\tbuildRectangleClippingVertical(\n\t\t\t0, 1,\n\t\t\t0, bri,\n\t\t\tclippings,\n\t\t\tvoffset\n\t\t);\n\t} else {\n\t\tbuildRectangleClippingVertical(\n\t\t\t1, 0,\n\t\t\tbri, 0,\n\t\t\tclippings,\n\t\t\tvoffset\n\t\t);\n\t}\n};\n\nexport const buildRectangleClippingVertical = (\n\tcx: number, cy: number,\n\tcbx: number, cby: number,\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\tlet ic = voffset * 3;\n\n\tclippings[ ic + 0 ] = cx;\n\tclippings[ ic + 1 ] = cy;\n\tclippings[ ic + 2 ] = 0;\n\n\tclippings[ ic + 3 ] = cx;\n\tclippings[ ic + 4 ] = cy;\n\tclippings[ ic + 5 ] = 0;\n\n\tclippings[ ic + 6 ] = cx;\n\tclippings[ ic + 7 ] = cy;\n\tclippings[ ic + 8 ] = 0;\n\tic += 9;\n\n\tclippings[ ic + 0 ] = cbx;\n\tclippings[ ic + 1 ] = cby;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = cbx;\n\tclippings[ ic + 1 ] = cby;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = cx;\n\tclippings[ ic + 1 ] = cy;\n\tclippings[ ic + 2 ] = 0;\n\n\tclippings[ ic + 3 ] = cx;\n\tclippings[ ic + 4 ] = cy;\n\tclippings[ ic + 5 ] = 0;\n\n\tclippings[ ic + 6 ] = cx;\n\tclippings[ ic + 7 ] = cy;\n\tclippings[ ic + 8 ] = 0;\n\tic += 9;\n\n\t// --------------------------------\n\n\tclippings[ ic +  0 ] = cy;\n\tclippings[ ic +  1 ] = cx;\n\tclippings[ ic +  2 ] = 0;\n\n\tclippings[ ic +  3 ] = cy;\n\tclippings[ ic +  4 ] = cx;\n\tclippings[ ic +  5 ] = 0;\n\n\tclippings[ ic +  6 ] = cy;\n\tclippings[ ic +  7 ] = cx;\n\tclippings[ ic +  8 ] = 0;\n\n\tclippings[ ic +  9 ] = cy;\n\tclippings[ ic + 10 ] = cx;\n\tclippings[ ic + 11 ] = 0;\n\tic += 12;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// --------------------------------\n\n\tclippings[ ic +  0 ] = cy;\n\tclippings[ ic +  1 ] = cx;\n\tclippings[ ic +  2 ] = 0;\n\n\tclippings[ ic +  3 ] = cy;\n\tclippings[ ic +  4 ] = cx;\n\tclippings[ ic +  5 ] = 0;\n\n\tclippings[ ic +  6 ] = cy;\n\tclippings[ ic +  7 ] = cx;\n\tclippings[ ic +  8 ] = 0;\n\n\tclippings[ ic +  9 ] = cy;\n\tclippings[ ic + 10 ] = cx;\n\tclippings[ ic + 11 ] = 0;\n};\n\nexport const buildRectangleIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\tlet ii = ioffset * 3;\n\tindices[ ii + 0 ] = voffset + 0;\n\tindices[ ii + 1 ] = voffset + 1;\n\tindices[ ii + 2 ] = voffset + 3;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 1;\n\tindices[ ii + 1 ] = voffset + 2;\n\tindices[ ii + 2 ] = voffset + 3;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 4;\n\tindices[ ii + 1 ] = voffset + 6;\n\tindices[ ii + 2 ] = voffset + 5;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 4;\n\tindices[ ii + 1 ] = voffset + 7;\n\tindices[ ii + 2 ] = voffset + 6;\n\tii += 3;\n\n\t// --------------------------------\n\n\tindices[ ii + 0 ] = voffset + 8;\n\tindices[ ii + 1 ] = voffset + 12;\n\tindices[ ii + 2 ] = voffset + 9;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 9;\n\tindices[ ii + 1 ] = voffset + 12;\n\tindices[ ii + 2 ] = voffset + 10;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 10;\n\tindices[ ii + 1 ] = voffset + 12;\n\tindices[ ii + 2 ] = voffset + 13;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 10;\n\tindices[ ii + 1 ] = voffset + 13;\n\tindices[ ii + 2 ] = voffset + 11;\n\tii += 3;\n\n\t// --------------------------------\n\n\tindices[ ii + 0 ] = voffset + 14;\n\tindices[ ii + 1 ] = voffset + 15;\n\tindices[ ii + 2 ] = voffset + 12;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 12;\n\tindices[ ii + 1 ] = voffset + 15;\n\tindices[ ii + 2 ] = voffset + 16;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 16;\n\tindices[ ii + 1 ] = voffset + 13;\n\tindices[ ii + 2 ] = voffset + 12;\n\tii += 3;\n\n\tindices[ ii + 0 ] = voffset + 13;\n\tindices[ ii + 1 ] = voffset + 16;\n\tindices[ ii + 2 ] = voffset + 17;\n};\n\nexport const buildRectangleVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number, number ]\n): void => {\n\t// 0               1\n\t// |-------|-------|\n\t// |       |       |\n\t// |-------|-------|\n\t// |       |       |\n\t// |-------|-------|\n\t//                 2\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\tconst work = RECTANGLE_WORK_POINT;\n\twork.set( originX - sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst bx0 = work.x;\n\tconst by0 = work.y;\n\twork.set( originX + sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst bx1 = work.x;\n\tconst by1 = work.y;\n\twork.set( originX + sx, originY + sy );\n\tinternalTransform.apply( work, work );\n\tconst bx2 = work.x;\n\tconst by2 = work.y;\n\tconst bx3 = bx0 + (bx2 - bx1);\n\tconst by3 = by0 + (by2 - by1);\n\n\tconst ax = toLength( bx0, by0, bx1, by1 ) * 0.5;\n\tconst ay = toLength( bx1, by1, bx2, by2 ) * 0.5;\n\tworldSize[ 1 ] = ax;\n\tworldSize[ 2 ] = ay;\n\tif( ax <= ay ) {\n\t\tconst br = ax / ay;\n\t\tworldSize[ 0 ] = br;\n\t\tbuildRectangleVertexVertical(\n\t\t\tbr,\n\t\t\tbx0, by0,\n\t\t\tbx1, by1,\n\t\t\tbx2, by2,\n\t\t\tbx3, by3,\n\t\t\tvertices,\n\t\t\tvoffset,\n\t\t\tworldSize\n\t\t);\n\t} else {\n\t\tconst br = ay / ax;\n\t\tworldSize[ 0 ] = br;\n\t\tbuildRectangleVertexVertical(\n\t\t\tbr,\n\t\t\tbx3, by3,\n\t\t\tbx0, by0,\n\t\t\tbx1, by1,\n\t\t\tbx2, by2,\n\t\t\tvertices,\n\t\t\tvoffset,\n\t\t\tworldSize\n\t\t);\n\t}\n};\n\nexport const buildRectangleVertexVertical = (\n\tbr: number,\n\tbx0: number, by0: number,\n\tbx1: number, by1: number,\n\tbx2: number, by2: number,\n\tbx3: number, by3: number,\n\tvertices: Float32Array,\n\tvoffset: number,\n\tworldSize: [ number, number, number ]\n): void => {\n\t// 0       1       2\n\t// |-------|-------|\n\t// |       |       |\n\t// |-------3-------|\n\t// |       |       |\n\t// |-------4-------|\n\t// |       |       |\n\t// |-------|-------|\n\t// 5       6       7\n\tconst x0 = bx0;\n\tconst y0 = by0;\n\tconst x1 = (bx0 + bx1) * 0.5;\n\tconst y1 = (by0 + by1) * 0.5;\n\tconst x2 = bx1;\n\tconst y2 = by1;\n\n\tconst xc = (bx0 + bx2) * 0.5;\n\tconst yc = (by0 + by2) * 0.5;\n\tconst x3 = x1 + br * (xc - x1);\n\tconst y3 = y1 + br * (yc - y1);\n\n\tconst x5 = bx3;\n\tconst y5 = by3;\n\tconst x6 = (bx3 + bx2) * 0.5;\n\tconst y6 = (by3 + by2) * 0.5;\n\tconst x7 = bx2;\n\tconst y7 = by2;\n\n\tconst x4 = x6 + br * (xc - x6);\n\tconst y4 = y6 + br * (yc - y6);\n\n\tlet iv = voffset << 1;\n\tvertices[ iv + 0 ] = x0;\n\tvertices[ iv + 1 ] = y0;\n\tvertices[ iv + 2 ] = x1;\n\tvertices[ iv + 3 ] = y1;\n\tvertices[ iv + 4 ] = x2;\n\tvertices[ iv + 5 ] = y2;\n\tiv += 6;\n\n\tvertices[ iv + 0 ] = x3;\n\tvertices[ iv + 1 ] = y3;\n\tiv += 2;\n\n\tvertices[ iv + 0 ] = x4;\n\tvertices[ iv + 1 ] = y4;\n\tiv += 2;\n\n\tvertices[ iv + 0 ] = x5;\n\tvertices[ iv + 1 ] = y5;\n\tvertices[ iv + 2 ] = x6;\n\tvertices[ iv + 3 ] = y6;\n\tvertices[ iv + 4 ] = x7;\n\tvertices[ iv + 5 ] = y7;\n\tiv += 6;\n\n\t// 8               14\n\t// |-------|-------|\n\t// |       |       |\n\t// 9-------12------15\n\t// |       |       |\n\t// 10------13------16\n\t// |       |       |\n\t// |-------|-------|\n\t// 11              17\n\tconst xcl = (bx0 + bx3) * 0.5;\n\tconst ycl = (by0 + by3) * 0.5;\n\tconst x8 = bx0;\n\tconst y8 = by0;\n\tconst x9 = bx0 + br * (xcl - bx0);\n\tconst y9 = by0 + br * (ycl - by0);\n\tconst x10 = bx3 + br * (xcl - bx3);\n\tconst y10 = by3 + br * (ycl - by3);\n\tconst x11 = bx3;\n\tconst y11 = by3;\n\n\tconst x12 = x3;\n\tconst y12 = y3;\n\tconst x13 = x4;\n\tconst y13 = y4;\n\n\tconst xcr = (bx1 + bx2) * 0.5;\n\tconst ycr = (by1 + by2) * 0.5;\n\tconst x14 = bx1;\n\tconst y14 = by1;\n\tconst x15 = bx1 + br * (xcr - bx1);\n\tconst y15 = by1 + br * (ycr - by1);\n\tconst x16 = bx2 + br * (xcr - bx2);\n\tconst y16 = by2 + br * (ycr - by2);\n\tconst x17 = bx2;\n\tconst y17 = by2;\n\n\tvertices[ iv + 0 ] = x8;\n\tvertices[ iv + 1 ] = y8;\n\tvertices[ iv + 2 ] = x9;\n\tvertices[ iv + 3 ] = y9;\n\tvertices[ iv + 4 ] = x10;\n\tvertices[ iv + 5 ] = y10;\n\tvertices[ iv + 6 ] = x11;\n\tvertices[ iv + 7 ] = y11;\n\tiv += 8;\n\n\tvertices[ iv + 0 ] = x12;\n\tvertices[ iv + 1 ] = y12;\n\tiv += 2;\n\n\tvertices[ iv + 0 ] = x13;\n\tvertices[ iv + 1 ] = y13;\n\tiv += 2;\n\n\tvertices[ iv + 0 ] = x14;\n\tvertices[ iv + 1 ] = y14;\n\tvertices[ iv + 2 ] = x15;\n\tvertices[ iv + 3 ] = y15;\n\tvertices[ iv + 4 ] = x16;\n\tvertices[ iv + 5 ] = y16;\n\tvertices[ iv + 6 ] = x17;\n\tvertices[ iv + 7 ] = y17;\n};\n\nexport const buildRectangleStep = (\n\tvoffset: number,\n\tsteps: Float32Array,\n\tstrokeWidth: number,\n\tstrokeSide: EShapeStrokeSide,\n\tantialiasWeight: number,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst br = worldSize[ 0 ];\n\tconst bri = 1 - br;\n\tconst worldSizeX = worldSize[ 1 ];\n\tconst worldSizeY = worldSize[ 2 ];\n\ttoStep( worldSizeX, strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swx = STEP_VALUES[ 0 ];\n\tconst px0 = STEP_VALUES[ 1 ];\n\tconst px1 = STEP_VALUES[ 2 ];\n\n\ttoStep( worldSizeY, strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swy = STEP_VALUES[ 0 ];\n\tconst py0 = STEP_VALUES[ 1 ];\n\tconst py1 = STEP_VALUES[ 2 ];\n\n\tlet swt = swy;\n\tlet pt0 = py0;\n\tif( ! (strokeSide & EShapeStrokeSide.TOP) ) {\n\t\tswt = 1;\n\t\tpt0 = py1;\n\t}\n\tlet swr = swx;\n\tlet pr0 = px0;\n\tif( ! (strokeSide & EShapeStrokeSide.RIGHT) ) {\n\t\tswr = 1;\n\t\tpr0 = px1;\n\t}\n\tlet swb = swy;\n\tlet pb0 = py0;\n\tif( ! (strokeSide & EShapeStrokeSide.BOTTOM) ) {\n\t\tswb = 1;\n\t\tpb0 = py1;\n\t}\n\tlet swl = swx;\n\tlet pl0 = px0;\n\tif( ! (strokeSide & EShapeStrokeSide.LEFT) ) {\n\t\tswl = 1;\n\t\tpl0 = px1;\n\t}\n\tconst pc0 = 0.5 * (pl0 + pr0);\n\tconst pm0 = 0.5 * (pt0 + pb0);\n\tif( worldSizeX <= worldSizeY ) {\n\t\tbuildRectangleStepVertical(\n\t\t\tbri,\n\t\t\tswx, px0, px1,\n\t\t\tswy, py0, py1,\n\t\t\tswt, pt0,\n\t\t\tswr, pr0,\n\t\t\tswb, pb0,\n\t\t\tswl, pl0,\n\t\t\tpc0, pm0,\n\t\t\tvoffset,\n\t\t\tsteps\n\t\t);\n\t} else {\n\t\tbuildRectangleStepHorizontal(\n\t\t\tbri,\n\t\t\tswx, px0, px1,\n\t\t\tswy, py0, py1,\n\t\t\tswt, pt0,\n\t\t\tswr, pr0,\n\t\t\tswb, pb0,\n\t\t\tswl, pl0,\n\t\t\tpc0, pm0,\n\t\t\tvoffset,\n\t\t\tsteps\n\t\t);\n\t}\n};\n\nexport const buildRectangleStepVertical = (\n\tbri: number,\n\tswx: number, px0: number, px1: number,\n\tswy: number, py0: number, py1: number,\n\tswt: number, pt0: number,\n\tswr: number, pr0: number,\n\tswb: number, pb0: number,\n\tswl: number, pl0: number,\n\tpc0: number, pm0: number,\n\tvoffset: number,\n\tsteps: Float32Array\n): void => {\n\tlet is = voffset * 6;\n\n\t// 0\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 1\n\tsteps[ is     ] = 0;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pc0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 2\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 3\n\tsteps[ is     ] = 0;\n\tsteps[ is + 1 ] = bri * swt;\n\tsteps[ is + 2 ] = pc0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 4\n\tsteps[ is     ] = 0;\n\tsteps[ is + 1 ] = bri * swb;\n\tsteps[ is + 2 ] = pc0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 5\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 6\n\tsteps[ is     ] = 0;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pc0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 7\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// ------------------------------\n\n\t// 8\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 9\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = bri * swt;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 10\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = bri * swb;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 11\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// ------------------------------\n\n\t// 12\n\tsteps[ is     ] = 0;\n\tsteps[ is + 1 ] = bri * swt;\n\tsteps[ is + 2 ] = pc0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 13\n\tsteps[ is     ] = 0;\n\tsteps[ is + 1 ] = bri * swb;\n\tsteps[ is + 2 ] = pc0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// ------------------------------\n\n\t// 14\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 15\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = bri * swt;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 16\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = bri * swb;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 17\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n};\n\nexport const buildRectangleStepHorizontal = (\n\tbri: number,\n\tswx: number, px0: number, px1: number,\n\tswy: number, py0: number, py1: number,\n\tswt: number, pt0: number,\n\tswr: number, pr0: number,\n\tswb: number, pb0: number,\n\tswl: number, pl0: number,\n\tpc0: number, pm0: number,\n\tvoffset: number,\n\tsteps: Float32Array\n): void => {\n\tlet is = voffset * 6;\n\n\t// 0\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 1\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pm0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 2\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 3\n\tsteps[ is     ] = bri * swl;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pm0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 4\n\tsteps[ is     ] = bri * swr;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pm0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 5\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 6\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pm0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 7\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// ------------------------------\n\n\t// 8\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 9\n\tsteps[ is     ] = bri * swl;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 10\n\tsteps[ is     ] = bri * swr;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 11\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// ------------------------------\n\n\t// 12\n\tsteps[ is     ] = bri * swl;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pm0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 13\n\tsteps[ is     ] = bri * swr;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pm0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// ------------------------------\n\n\t// 14\n\tsteps[ is     ] = swl;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 15\n\tsteps[ is     ] = bri * swl;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 16\n\tsteps[ is     ] = bri * swr;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// 17\n\tsteps[ is     ] = swr;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n};\n\nexport const buildRectangleUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst br = worldSize[ 0 ];\n\tconst bri = 1 - br;\n\tconst worldSizeX = worldSize[ 1 ];\n\tconst worldSizeY = worldSize[ 2 ];\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\tif( worldSizeX <= worldSizeY ) {\n\t\tbuildRectangleUvVertical(\n\t\t\tbri,\n\t\t\tx0, x1, x2, x3,\n\t\t\ty0, y1, y2, y3,\n\t\t\tuvs, voffset\n\t\t);\n\t} else {\n\t\tbuildRectangleUvVertical(\n\t\t\tbri,\n\t\t\tx3, x0, x1, x2,\n\t\t\ty3, y0, y1, y2,\n\t\t\tuvs, voffset\n\t\t);\n\t}\n};\n\nexport const buildRectangleUvVertical = (\n\tbri: number,\n\tx0: number, x1: number, x2: number, x3: number,\n\ty0: number, y1: number, y2: number, y3: number,\n\tuvs: Float32Array,\n\tvoffset: number\n): void => {\n\tconst x01 = 0.5 * ( x0 + x1 );\n\tconst y01 = 0.5 * ( y0 + y1 );\n\tconst x02 = 0.5 * ( x0 + x2 );\n\tconst y02 = 0.5 * ( y0 + y2 );\n\tconst x23 = 0.5 * ( x2 + x3 );\n\tconst y23 = 0.5 * ( y2 + y3 );\n\tconst x03 = 0.5 * ( x0 + x3 );\n\tconst y03 = 0.5 * ( y0 + y3 );\n\tconst x12 = 0.5 * ( x1 + x2 );\n\tconst y12 = 0.5 * ( y1 + y2 );\n\n\tconst xbu = x02 + bri * (x01 - x02);\n\tconst ybu = y02 + bri * (y01 - y02);\n\n\tconst xbb = x02 + bri * (x23 - x02);\n\tconst ybb = y02 + bri * (y23 - y02);\n\n\t// UVs\n\tlet iuv = voffset << 1;\n\tuvs[ iuv + 0 ] = x0;\n\tuvs[ iuv + 1 ] = y0;\n\tuvs[ iuv + 2 ] = x01;\n\tuvs[ iuv + 3 ] = y01;\n\tuvs[ iuv + 4 ] = x1;\n\tuvs[ iuv + 5 ] = y1;\n\tiuv += 6;\n\n\tuvs[ iuv + 0 ] = xbu;\n\tuvs[ iuv + 1 ] = ybu;\n\tiuv += 2;\n\n\tuvs[ iuv + 0 ] = xbb;\n\tuvs[ iuv + 1 ] = ybb;\n\tiuv += 2;\n\n\tuvs[ iuv + 0 ] = x3;\n\tuvs[ iuv + 1 ] = y3;\n\tuvs[ iuv + 2 ] = x23;\n\tuvs[ iuv + 3 ] = y23;\n\tuvs[ iuv + 4 ] = x2;\n\tuvs[ iuv + 5 ] = y2;\n\tiuv += 6;\n\n\t// ------------------------------\n\n\tuvs[ iuv + 0 ] = x0;\n\tuvs[ iuv + 1 ] = y0;\n\tuvs[ iuv + 2 ] = x03 + bri * (x0 - x03);\n\tuvs[ iuv + 3 ] = y03 + bri * (y0 - y03);\n\tuvs[ iuv + 4 ] = x03 + bri * (x3 - x03);\n\tuvs[ iuv + 5 ] = y03 + bri * (y3 - y03);\n\tuvs[ iuv + 6 ] = x3;\n\tuvs[ iuv + 7 ] = y3;\n\tiuv += 8;\n\n\tuvs[ iuv + 0 ] = xbu;\n\tuvs[ iuv + 1 ] = ybu;\n\tiuv += 2;\n\n\tuvs[ iuv + 0 ] = xbb;\n\tuvs[ iuv + 1 ] = ybb;\n\tiuv += 2;\n\n\tuvs[ iuv + 0 ] = x1;\n\tuvs[ iuv + 1 ] = y1;\n\tuvs[ iuv + 2 ] = x12 + bri * (x1 - x12);\n\tuvs[ iuv + 3 ] = y12 + bri * (y1 - y12);\n\tuvs[ iuv + 4 ] = x12 + bri * (x2 - x12);\n\tuvs[ iuv + 5 ] = y12 + bri * (y2 - y12);\n\tuvs[ iuv + 6 ] = x2;\n\tuvs[ iuv + 7 ] = y2;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildRectangleClipping, buildRectangleIndex, buildRectangleStep, buildRectangleUv,\n\tbuildRectangleVertex, RECTANGLE_WORLD_SIZE\n} from \"./build-rectangle\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeRectangleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateIndices();\n\t\tbuildRectangleIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexClippingStepAndUv( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexClippingStepAndUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isTextureChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tbuffer.updateVertices();\n\t\t\tbuildRectangleVertex(\n\t\t\t\tbuffer.vertices, voffset,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign, strokeWidth,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t);\n\n\t\t\t// Steps\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t\tbuildRectangleStep(\n\t\t\t\t\tvoffset,\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\tthis.antialiasWeight,\n\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Clippings\n\t\t\tif( isVertexChanged ) {\n\t\t\t\tbuffer.updateClippings();\n\t\t\t\tbuildRectangleClipping(\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// UVs\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t\tbuildRectangleUv(\n\t\t\t\t\tbuffer.uvs,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_INDEX_COUNT, RECTANGLE_VERTEX_COUNT } from \"./build-rectangle\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { EShapeRectangleUploaded } from \"./e-shape-rectangle-uploaded\";\n\nexport const createRectangleUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeRectangleUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = RECTANGLE_VERTEX_COUNT + tvcount;\n\tconst icount = RECTANGLE_INDEX_COUNT + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeRectangleUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeRectangle extends EShapePrimitive {\n\tconstructor( type = EShapeType.RECTANGLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeRectangle {\n\t\treturn new EShapeRectangle().copy( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tif( fill.enable ) {\n\t\t\t\treturn true;\n\t\t\t} else {\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tconst strokeSide = stroke.side;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth && strokeSide !== EShapeStrokeSide.NONE ) {\n\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\tif( ! this.containsAbsBBox( x, y, wx, wy ) ) {\n\t\t\t\t\t\tif( strokeSide === EShapeStrokeSide.ALL ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( x <= -wx ) {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP_OR_LEFT ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM_OR_LEFT ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.LEFT ) !== 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else if( +wx <= x ) {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP_OR_RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM_OR_RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif( y <= -wy ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP ) !== 0;\n\t\t\t\t\t\t\t\t} else if( +wy <= y ) {\n\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM ) !== 0;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\n\nexport class EShapeImage extends EShapeRectangle {\n\tconstructor( image?: HTMLImageElement, type = EShapeType.IMAGE ) {\n\t\tsuper( type );\n\t\tif( image != null ) {\n\t\t\tthis.image = image;\n\t\t\tthis.size.set( image.width, image.height );\n\t\t}\n\t\tthis.fill.alpha = 1.0;\n\t}\n\n\tclone(): EShapeImage {\n\t\treturn new EShapeImage( this.image ).copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeImage } from \"./e-shape-image\";\n\nexport const deserializeImage = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeImage> | EShapeImage => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeImage() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createRectangleUploaded } from \"../variant/create-rectangle-uploaded\";\nimport { deserializeImage } from \"../variant/deserialize-image\";\n\nexport const loadShapeImage = () => {\n\tEShapeUploadeds[ EShapeType.IMAGE ] = createRectangleUploaded;\n\tEShapeDeserializers[ EShapeType.IMAGE ] = deserializeImage;\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { toLength } from \"./to-length\";\n\nexport const IMAGE_SDF_VERTEX_COUNT = 9;\nexport const IMAGE_SDF_INDEX_COUNT = 8;\nexport const IMAGE_SDF_WORLD_SIZE: [ number, number ] = [ 0, 0 ];\nconst IMAGE_SDF_FMIN: number = 0.00001;\nconst IMAGE_SDF_SDF_WINDOW: number = 12;\nconst IMAGE_SDF_WORK_POINT: Point = new Point();\n\nexport const buildImageSdfClipping = (\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\tfor( let ic = voffset * 3, imax = (voffset + IMAGE_SDF_VERTEX_COUNT) * 3; ic < imax; ic += 3 ) {\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 2;\n\t}\n};\n\nexport const buildImageSdfIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\tlet ii = ioffset * 3;\n\tindices[ ii + 0 ] = voffset + 0;\n\tindices[ ii + 1 ] = voffset + 1;\n\tindices[ ii + 2 ] = voffset + 3;\n\tindices[ ii + 3 ] = voffset + 1;\n\tindices[ ii + 4 ] = voffset + 4;\n\tindices[ ii + 5 ] = voffset + 3;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 1;\n\tindices[ ii + 1 ] = voffset + 2;\n\tindices[ ii + 2 ] = voffset + 4;\n\tindices[ ii + 3 ] = voffset + 2;\n\tindices[ ii + 4 ] = voffset + 5;\n\tindices[ ii + 5 ] = voffset + 4;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 3;\n\tindices[ ii + 1 ] = voffset + 4;\n\tindices[ ii + 2 ] = voffset + 6;\n\tindices[ ii + 3 ] = voffset + 4;\n\tindices[ ii + 4 ] = voffset + 7;\n\tindices[ ii + 5 ] = voffset + 6;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 4;\n\tindices[ ii + 1 ] = voffset + 5;\n\tindices[ ii + 2 ] = voffset + 7;\n\tindices[ ii + 3 ] = voffset + 5;\n\tindices[ ii + 4 ] = voffset + 8;\n\tindices[ ii + 5 ] = voffset + 7;\n};\n\nexport const buildImageSdfStep = (\n\tsteps: Float32Array,\n\tvoffset: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\ttextureWidth: number,\n\ttextureHeight: number,\n\tantialiasWeight: number,\n\tworldSize: [ number, number ]\n): void => {\n\tconst scaleBase = (0.333 / IMAGE_SDF_SDF_WINDOW) * antialiasWeight;\n\tconst scaleX = scaleBase * ( textureWidth / worldSize[ 0 ] );\n\tconst scaleY = scaleBase * ( textureHeight / worldSize[ 1 ] );\n\tconst scaleZ = (scaleX + scaleY) * 0.5;\n\tconst outlineLimit = 0.4;\n\tconst strokeWidthMax = ( outlineLimit / 0.5 ) * IMAGE_SDF_SDF_WINDOW;\n\tconst strokeWidthRatio = Math.max( 0.0, Math.min( 1.0, strokeWidth / strokeWidthMax ));\n\tconst outlineWidth = strokeWidthRatio * outlineLimit;\n\tconst outlinePosition = -outlineWidth * (1 - strokeAlign);\n\n\tlet is = voffset * 6;\n\tsteps[ is + 0 ] = scaleZ;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleY;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleZ;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleX;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleZ;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleX;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleZ;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleY;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n\n\tsteps[ is + 0 ] = scaleY;\n\tsteps[ is + 1 ] = outlineWidth;\n\tsteps[ is + 2 ] = outlinePosition;\n\tsteps[ is + 3 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 4 ] = IMAGE_SDF_FMIN;\n\tsteps[ is + 5 ] = IMAGE_SDF_FMIN;\n\tis += 6;\n};\n\nexport const buildImageSdfVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number ]\n): void => {\n\t// Calculate the transformed positions\n\t//\n\t// 0       1       2\n\t// |-------|-------|\n\t// |       |       |\n\t// 3-------4-------5\n\t// |       |       |\n\t// |-------|-------|\n\t// 6       7       8\n\t//\n\tconst work = IMAGE_SDF_WORK_POINT;\n\tconst sx = sizeX * 0.5;\n\tconst sy = sizeY * 0.5;\n\twork.set( originX - sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( originX + sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x2 = work.x;\n\tconst y2 = work.y;\n\twork.set( originX + sx, originY + sy );\n\tinternalTransform.apply( work, work );\n\tconst x8 = work.x;\n\tconst y8 = work.y;\n\tconst x6 = x0 + (x8 - x2);\n\tconst y6 = y0 + (y8 - y2);\n\n\t// Vertices\n\tlet iv = voffset << 1;\n\tvertices[ iv + 0 ] = x0;\n\tvertices[ iv + 1 ] = y0;\n\tvertices[ iv + 2 ] = (x0 + x2) * 0.5;\n\tvertices[ iv + 3 ] = (y0 + y2) * 0.5;\n\tvertices[ iv + 4 ] = x2;\n\tvertices[ iv + 5 ] = y2;\n\tiv += 6;\n\n\tvertices[ iv + 0 ] = (x0 + x6) * 0.5;\n\tvertices[ iv + 1 ] = (y0 + y6) * 0.5;\n\tvertices[ iv + 2 ] = (x0 + x8) * 0.5;\n\tvertices[ iv + 3 ] = (y0 + y8) * 0.5;\n\tvertices[ iv + 4 ] = (x2 + x8) * 0.5;\n\tvertices[ iv + 5 ] = (y2 + y8) * 0.5;\n\tiv += 6;\n\n\tvertices[ iv + 0 ] = x6;\n\tvertices[ iv + 1 ] = y6;\n\tvertices[ iv + 2 ] = (x6 + x8) * 0.5;\n\tvertices[ iv + 3 ] = (y6 + y8) * 0.5;\n\tvertices[ iv + 4 ] = x8;\n\tvertices[ iv + 5 ] = y8;\n\n\tworldSize[ 0 ] = toLength( x0, y0, x2, y2 ) * 0.5;\n\tworldSize[ 1 ] = toLength( x0, y0, x6, y6 ) * 0.5;\n};\n\nexport const buildImageSdfUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUv: TextureUvs\n): void => {\n\tconst x0 = textureUv.x0;\n\tconst y0 = textureUv.y0;\n\tconst x1 = textureUv.x1;\n\tconst y1 = textureUv.y1;\n\tconst x2 = textureUv.x2;\n\tconst y2 = textureUv.y2;\n\tconst x3 = textureUv.x3;\n\tconst y3 = textureUv.y3;\n\n\tlet iv = voffset << 1;\n\tuvs[ iv + 0 ] = x0;\n\tuvs[ iv + 1 ] = y0;\n\tuvs[ iv + 2 ] = (x1 + x0) * 0.5;\n\tuvs[ iv + 3 ] = (y1 + y0) * 0.5;\n\tuvs[ iv + 4 ] = x1;\n\tuvs[ iv + 5 ] = y1;\n\tiv += 6;\n\n\tuvs[ iv + 0 ] = (x0 + x3) * 0.5;\n\tuvs[ iv + 1 ] = (y0 + y3) * 0.5;\n\tuvs[ iv + 2 ] = (x0 + x2) * 0.5;\n\tuvs[ iv + 3 ] = (y0 + y2) * 0.5;\n\tuvs[ iv + 4 ] = (x1 + x2) * 0.5;\n\tuvs[ iv + 5 ] = (y1 + y2) * 0.5;\n\tiv += 6;\n\n\tuvs[ iv + 0 ] = x3;\n\tuvs[ iv + 1 ] = y3;\n\tuvs[ iv + 2 ] = (x3 + x2) * 0.5;\n\tuvs[ iv + 3 ] = (y3 + y2) * 0.5;\n\tuvs[ iv + 4 ] = x2;\n\tuvs[ iv + 5 ] = y2;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildImageSdfClipping, buildImageSdfIndex, buildImageSdfStep,\n\tbuildImageSdfUv, buildImageSdfVertex, IMAGE_SDF_WORLD_SIZE\n} from \"./build-image-sdf\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeImageSdfUploaded extends EShapeTextUploaded {\n\tprotected textureWidth: number;\n\tprotected textureHeight: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount, antialiasWeight );\n\n\t\tthis.textureWidth = -1;\n\t\tthis.textureHeight = -1;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clippings & indices\n\t\tconst buffer = this.buffer;\n\t\tconst voffset = this.vertexOffset;\n\t\tbuffer.updateClippings();\n\t\tbuffer.updateIndices();\n\t\tbuildImageSdfClipping(\n\t\t\tbuffer.clippings,\n\t\t\tvoffset\n\t\t);\n\t\tbuildImageSdfIndex(\n\t\t\tbuffer.indices,\n\t\t\tvoffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexAndStep( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexAndStep( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureWidth = texture.width * texture.resolution;\n\t\tconst textureHeight = texture.height * texture.resolution;\n\t\tconst isTextureSizeChanged = ( this.textureWidth !== textureWidth || this.textureHeight !== textureHeight );\n\n\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged || isTextureSizeChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.textureWidth = textureWidth;\n\t\t\tthis.textureHeight = textureHeight;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\n\t\t\t// Vertices\n\t\t\tbuffer.updateVertices();\n\t\t\tbuildImageSdfVertex(\n\t\t\t\tbuffer.vertices,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tIMAGE_SDF_WORLD_SIZE\n\t\t\t);\n\n\t\t\t// Steps\n\t\t\tbuffer.updateSteps();\n\t\t\tbuildImageSdfStep(\n\t\t\t\tbuffer.steps,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tstrokeAlign,\n\t\t\t\tstrokeWidth,\n\t\t\t\ttextureWidth,\n\t\t\t\ttextureHeight,\n\t\t\t\tthis.antialiasWeight,\n\t\t\t\tIMAGE_SDF_WORLD_SIZE\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuffer.updateUvs();\n\t\t\tbuildImageSdfUv(\n\t\t\t\tbuffer.uvs,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tthis.toTextureUvs( texture )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { IMAGE_SDF_INDEX_COUNT, IMAGE_SDF_VERTEX_COUNT } from \"./build-image-sdf\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { EShapeImageSdfUploaded } from \"./e-shape-image-sdf-uploaded\";\n\nexport const createImageSdfUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeImageSdfUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = IMAGE_SDF_VERTEX_COUNT + tvcount;\n\tconst icount = IMAGE_SDF_INDEX_COUNT + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeImageSdfUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeImage } from \"./e-shape-image\";\n\nexport class EShapeImageSdf extends EShapeImage {\n\tconstructor( image?: HTMLImageElement, type = EShapeType.IMAGE_SDF ) {\n\t\tsuper( image, type );\n\t}\n\n\tclone(): EShapeImageSdf {\n\t\treturn new EShapeImageSdf( this.image ).copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeImageSdf } from \"./e-shape-image-sdf\";\n\nexport const deserializeImageSdf = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeImageSdf> | EShapeImageSdf => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeImageSdf() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeLabelUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.initText();\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateLabelVertex( buffer, shape );\n\t\tthis.updateLabelUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tupdateLabelVertex( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\t\tif( isSizeChanged || isTransformChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\n\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t}\n\t}\n\n\tupdateLabelUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tthis.texture = this.toTexture( shape );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { EShapeLabelUploaded } from \"./e-shape-label-uploaded\";\n\nexport const createLabelUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeLabelUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = tvcount;\n\tconst icount = ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeLabelUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeLabel extends EShapePrimitive {\n\tconstructor( type: EShapeType = EShapeType.LABEL ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeLabel {\n\t\treturn new EShapeLabel().copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLabel } from \"./e-shape-label\";\n\nexport const deserializeLabel = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeLabel> | EShapeLabel => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLabel() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createLabelUploaded } from \"../variant/create-label-uploaded\";\nimport { deserializeLabel } from \"../variant/deserialize-label\";\n\nexport const loadShapeLabel = () => {\n\tEShapeUploadeds[ EShapeType.LABEL ] = createLabelUploaded;\n\tEShapeDeserializers[ EShapeType.LABEL ] = deserializeLabel;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toIndexOf = <V>( array: V[], value: V ): number => {\n\tlet i0 = 0;\n\tlet i1 = array.length - 1;\n\n\twhile( i0 <= i1 ) {\n\t\tconst i2 = i0 + ((i1 - i0) >> 1);\n\t\tconst v2 = array[ i2 ];\n\t\tif( value < v2 ) {\n\t\t\ti1 = i2 - 1;\n\t\t} else if( v2 < value ) {\n\t\t\ti0 = i2 + 1;\n\t\t} else {\n\t\t\treturn i2;\n\t\t}\n\t}\n\n\treturn -1;\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { toIndexOf } from \"../../util/to-index-of\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { toDash } from \"./to-dash\";\nimport { toLength } from \"./to-length\";\nimport { toScaleInvariant } from \"./to-scale-invariant\";\n\nconst LINE_FMIN: number = 0.00001;\nconst LINE_WORK_POINT: Point = new Point();\n\nexport const toLineVertexCount = ( pointCount: number ): number => {\n\treturn (Math.ceil( pointCount / 12 ) * 12) * 4 + 2;\n};\n\nexport const buildLineClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\tpointCount: number,\n\tpointsClosed: boolean\n): void => {\n\tlet ic = voffset * 3;\n\tif( 2 <= pointCount ) {\n\t\t// First\n\t\tif( ! pointsClosed ) {\n\t\t\tclippings[ ic +  0 ] = 1;\n\t\t\tclippings[ ic +  1 ] = 0;\n\t\t\tclippings[ ic +  2 ] = 3;\n\n\t\t\tclippings[ ic +  3 ] = 0;\n\t\t\tclippings[ ic +  4 ] = 1;\n\t\t\tclippings[ ic +  5 ] = 5;\n\t\t\tic += 6;\n\t\t}\n\n\t\t// Middle\n\t\tfor( let i = (pointsClosed ? 0 : 1), imax = pointCount - i; i < imax; ++i ) {\n\t\t\tclippings[ ic +  0 ] = 1;\n\t\t\tclippings[ ic +  1 ] = 0;\n\t\t\tclippings[ ic +  2 ] = 3;\n\n\t\t\tclippings[ ic +  3 ] = 0;\n\t\t\tclippings[ ic +  4 ] = 1;\n\t\t\tclippings[ ic +  5 ] = 5;\n\n\t\t\tclippings[ ic +  6 ] = 1;\n\t\t\tclippings[ ic +  7 ] = 0;\n\t\t\tclippings[ ic +  8 ] = 4;\n\n\t\t\tclippings[ ic +  9 ] = 0;\n\t\t\tclippings[ ic + 10 ] = 1;\n\t\t\tclippings[ ic + 11 ] = 6;\n\t\t\tic += 12;\n\t\t}\n\n\t\t// Last\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 3;\n\n\t\tclippings[ ic + 3 ] = 0;\n\t\tclippings[ ic + 4 ] = 1;\n\t\tclippings[ ic + 5 ] = 5;\n\t\tic += 6;\n\t}\n\n\t// Fill the rest\n\tfor( const icmax = (voffset + vcount) * 3; ic < icmax; ic += 3 ) {\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 0;\n\t}\n};\n\nexport const buildLineIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number,\n\ticount: number\n): void => {\n\tfor( let ii = ioffset * 3, iimax = (ioffset + icount) * 3, io = voffset; ii < iimax; ii += 6, io += 2 ) {\n\t\tindices[ ii + 0 ] = io + 0;\n\t\tindices[ ii + 1 ] = io + 2;\n\t\tindices[ ii + 2 ] = io + 1;\n\t\tindices[ ii + 3 ] = io + 1;\n\t\tindices[ ii + 4 ] = io + 2;\n\t\tindices[ ii + 5 ] = io + 3;\n\t}\n};\n\nexport const buildLineUv = (\n\tuvs: Float32Array,\n\tcolorFills: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\tpointCount: number,\n\tpointsClosed: boolean,\n\ttextureUvs: TextureUvs,\n\tlength: number\n): void => {\n\tlet iuv = voffset << 1;\n\tif( 2 <= pointCount ) {\n\t\tconst x0 = textureUvs.x0;\n\t\tconst x1 = textureUvs.x1;\n\t\tconst x2 = textureUvs.x2;\n\t\tconst x3 = textureUvs.x3;\n\t\tconst y0 = textureUvs.y0;\n\t\tconst y1 = textureUvs.y1;\n\t\tconst y2 = textureUvs.y2;\n\t\tconst y3 = textureUvs.y3;\n\n\t\tconst dx01 = x1 - x0;\n\t\tconst dy01 = y1 - y0;\n\t\tconst dx32 = x2 - x3;\n\t\tconst dy32 = y2 - y3;\n\n\t\t// Uvs\n\t\tlet icf = voffset << 2;\n\t\tconst lengthInverse = 1 / Math.max( LINE_FMIN, length );\n\t\tlet r = 0;\n\n\t\t// UV: First\n\t\tif( ! pointsClosed ) {\n\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\tiuv += 4;\n\t\t\ticf += 8;\n\t\t}\n\n\t\t// UV: Middle\n\t\tfor( let i = (pointsClosed ? 0 : 1), imax = pointCount - i; i < imax; ++i ) {\n\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\tiuv += 4;\n\t\t\ticf += 8;\n\n\t\t\tr = colorFills[ icf ] * lengthInverse;\n\t\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\t\tiuv += 4;\n\t\t\ticf += 8;\n\t\t}\n\n\t\t// UV: Last\n\t\tr = colorFills[ icf ] * lengthInverse;\n\t\tuvs[ iuv + 0 ] = x0 + r * dx01;\n\t\tuvs[ iuv + 1 ] = y0 + r * dy01;\n\t\tuvs[ iuv + 2 ] = x3 + r * dx32;\n\t\tuvs[ iuv + 3 ] = y3 + r * dy32;\n\t\tiuv += 4;\n\t}\n\n\t// Fill the rest\n\tfor( const iuvmax = ((voffset + vcount) << 1); iuv < iuvmax; iuv += 2 ) {\n\t\tuvs[ iuv + 0 ] = 0;\n\t\tuvs[ iuv + 1 ] = 0;\n\t}\n};\n\nexport const buildLineVertexStepAndColorFill = (\n\tvertices: Float32Array,\n\tsteps: Float32Array,\n\tcolorFills: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\tpointCount: number,\n\tpointsClosed: boolean,\n\tpointValues: number[],\n\tpointSegments: number[],\n\tpointsStyle: EShapePointsStyle,\n\tstrokeWidth: number,\n\tinternalTransform: Matrix\n): number => {\n\tlet iv = voffset << 1;\n\tlet is = voffset * 6;\n\tlet icf = voffset << 2;\n\tlet lmax = 0;\n\tlet px = 0;\n\tlet py = 0;\n\tif( 2 <= pointCount ) {\n\t\tconst scaleInvariant = toScaleInvariant( pointsStyle );\n\n\t\t//\n\t\tlet l = 0;\n\t\tlet lprev = 0;\n\t\tlet lnext = 0;\n\t\tlet llop = 0;\n\t\tlet llo = 0;\n\t\tlet pprevx = 0;\n\t\tlet pprevy = 0;\n\t\tlet pnextx = 0;\n\t\tlet pnexty = 0;\n\t\tlet pseg = false;\n\t\tlet psegnext = false;\n\t\tlet icfprev = icf;\n\t\tlet loffset = 0;\n\n\t\t//\n\t\tconst a  = internalTransform.a;\n\t\tconst b  = internalTransform.b;\n\t\tconst c  = internalTransform.c;\n\t\tconst d  = internalTransform.d;\n\t\tconst tx = internalTransform.tx;\n\t\tconst ty = internalTransform.ty;\n\n\t\t// First point\n\t\tconst pv0 = pointValues[ 0 ];\n\t\tconst pv1 = pointValues[ 1 ];\n\t\tconst pfirstx = a * pv0 + c * pv1 + tx;\n\t\tconst pfirsty = b * pv0 + d * pv1 + ty;\n\t\tconst psegfirst = ( 0 <= toIndexOf( pointSegments, 0 ) );\n\n\t\t// Last point\n\t\tconst lastIndex = (pointCount - 1) << 1;\n\t\tconst pvl0 = pointValues[ lastIndex + 0 ];\n\t\tconst pvl1 = pointValues[ lastIndex + 1 ];\n\t\tconst plastx = a * pvl0 + c * pvl1 + tx;\n\t\tconst plasty = b * pvl0 + d * pvl1 + ty;\n\t\tconst pseglast = ( 0 <= toIndexOf( pointSegments, pointCount - 1 ) );\n\n\t\t// Second point\n\t\tlet psecondx = plastx;\n\t\tlet psecondy = plasty;\n\t\tlet psegsecond = pseglast;\n\t\tif( 2 < pointCount ) {\n\t\t\tconst pv2 = pointValues[ 2 ];\n\t\t\tconst pv3 = pointValues[ 3 ];\n\t\t\tpsecondx = a * pv2 + c * pv3 + tx;\n\t\t\tpsecondy = b * pv2 + d * pv3 + ty;\n\t\t\tpsegsecond = ( 0 <= toIndexOf( pointSegments, 1 ) );\n\t\t}\n\n\t\t// First segment\n\t\tif( pointsClosed ) {\n\t\t\tpx = plastx;\n\t\t\tpy = plasty;\n\t\t\tpnextx = pfirstx;\n\t\t\tpnexty = pfirsty;\n\t\t\tpseg = pseglast;\n\t\t\tpsegnext = psegfirst;\n\t\t} else {\n\t\t\tpprevx = pfirstx - (psecondx - pfirstx);\n\t\t\tpprevy = pfirsty - (psecondy - pfirsty);\n\t\t\tpx = pfirstx;\n\t\t\tpy = pfirsty;\n\t\t\tpnextx = psecondx;\n\t\t\tpnexty = psecondy;\n\t\t\tpseg = psegfirst;\n\t\t\tpsegnext = psegsecond;\n\t\t\tlnext += toLength( px, py, pnextx, pnexty );\n\n\t\t\t//\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ is +  0 ] = strokeWidth;\n\t\t\tsteps[ is +  1 ] = scaleInvariant;\n\t\t\tsteps[ is +  2 ] = pprevx;\n\t\t\tsteps[ is +  3 ] = pprevy;\n\t\t\tsteps[ is +  4 ] = pnextx;\n\t\t\tsteps[ is +  5 ] = pnexty;\n\t\t\tsteps[ is +  6 ] = strokeWidth;\n\t\t\tsteps[ is +  7 ] = scaleInvariant;\n\t\t\tsteps[ is +  8 ] = pprevx;\n\t\t\tsteps[ is +  9 ] = pprevy;\n\t\t\tsteps[ is + 10 ] = pnextx;\n\t\t\tsteps[ is + 11 ] = pnexty;\n\t\t\tcolorFills[ icf + 0 ] = llo;\n\t\t\tcolorFills[ icf + 4 ] = llo;\n\t\t\tiv += 4;\n\t\t\tis += 12;\n\t\t\ticf += 8;\n\t\t}\n\n\t\t// Middle segments\n\t\tfor( let i = ( pointsClosed ? 0 : 1 ), imax = pointCount - i; i < imax; ++i ) {\n\t\t\tpprevx = px;\n\t\t\tpprevy = py;\n\t\t\tpx = pnextx;\n\t\t\tpy = pnexty;\n\t\t\tpseg = psegnext;\n\t\t\tif( i === pointCount - 2 ) {\n\t\t\t\tpnextx = plastx;\n\t\t\t\tpnexty = plasty;\n\t\t\t\tpsegnext = pseglast;\n\t\t\t} else if( i === 0 ) {\n\t\t\t\tpnextx = psecondx;\n\t\t\t\tpnexty = psecondy;\n\t\t\t\tpsegnext = psegsecond;\n\t\t\t} else if( i < pointCount - 1 ) {\n\t\t\t\tconst nextIndex = (i + 1) << 1;\n\t\t\t\tconst pvn0 = pointValues[ nextIndex + 0 ];\n\t\t\t\tconst pvn1 = pointValues[ nextIndex + 1 ];\n\t\t\t\tpnextx = a * pvn0 + c * pvn1 + tx;\n\t\t\t\tpnexty = b * pvn0 + d * pvn1 + ty;\n\t\t\t\tpsegnext = ( 0 <= toIndexOf( pointSegments, i + 1 ) );\n\t\t\t} else {\n\t\t\t\tpnextx = pfirstx;\n\t\t\t\tpnexty = pfirsty;\n\t\t\t\tpsegnext = psegfirst;\n\t\t\t}\n\t\t\tlprev = l;\n\t\t\tl = lnext;\n\t\t\tlnext += toLength( px, py, pnextx, pnexty );\n\n\t\t\tlet pnextxn = pnextx;\n\t\t\tlet pnextyn = pnexty;\n\t\t\tlet loffsetprev = loffset;\n\t\t\tif( pseg ) {\n\t\t\t\tpprevx = px - (pnextx - px);\n\t\t\t\tpprevy = py - (pnexty - py);\n\n\t\t\t\tlmax = Math.max( lmax, llo );\n\n\t\t\t\tllop = lprev - loffset;\n\t\t\t\tconst dash = toDash( llop, strokeWidth, pointsStyle, LINE_WORK_POINT );\n\t\t\t\tconst dash0 = dash.x;\n\t\t\t\tconst dash1 = dash.y;\n\t\t\t\tfor( let j = icfprev; j < icf + 8; j += 4 ) {\n\t\t\t\t\tcolorFills[ j + 1 ] = dash0;\n\t\t\t\t\tcolorFills[ j + 2 ] = dash1;\n\t\t\t\t\tcolorFills[ j + 3 ] = llop;\n\t\t\t\t}\n\t\t\t\ticfprev = icf + 8;\n\t\t\t\tloffsetprev = loffset;\n\t\t\t\tloffset = l;\n\t\t\t} else if( psegnext ) {\n\t\t\t\tpnextxn = px + (px - pprevx);\n\t\t\t\tpnextyn = py + (py - pprevy);\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ is +  0 ] = strokeWidth;\n\t\t\tsteps[ is +  1 ] = scaleInvariant;\n\t\t\tsteps[ is +  2 ] = pprevx;\n\t\t\tsteps[ is +  3 ] = pprevy;\n\t\t\tsteps[ is +  4 ] = pnextxn;\n\t\t\tsteps[ is +  5 ] = pnextyn;\n\t\t\tsteps[ is +  6 ] = strokeWidth;\n\t\t\tsteps[ is +  7 ] = scaleInvariant;\n\t\t\tsteps[ is +  8 ] = pprevx;\n\t\t\tsteps[ is +  9 ] = pprevy;\n\t\t\tsteps[ is + 10 ] = pnextxn;\n\t\t\tsteps[ is + 11 ] = pnextyn;\n\t\t\tllop = l - loffsetprev;\n\t\t\tcolorFills[ icf + 0 ] = llop;\n\t\t\tcolorFills[ icf + 4 ] = llop;\n\t\t\tiv += 4;\n\t\t\tis += 12;\n\t\t\ticf += 8;\n\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ is +  0 ] = strokeWidth;\n\t\t\tsteps[ is +  1 ] = scaleInvariant;\n\t\t\tsteps[ is +  2 ] = pprevx;\n\t\t\tsteps[ is +  3 ] = pprevy;\n\t\t\tsteps[ is +  4 ] = pnextxn;\n\t\t\tsteps[ is +  5 ] = pnextyn;\n\t\t\tsteps[ is +  6 ] = strokeWidth;\n\t\t\tsteps[ is +  7 ] = scaleInvariant;\n\t\t\tsteps[ is +  8 ] = pprevx;\n\t\t\tsteps[ is +  9 ] = pprevy;\n\t\t\tsteps[ is + 10 ] = pnextxn;\n\t\t\tsteps[ is + 11 ] = pnextyn;\n\t\t\tllo = l - loffset;\n\t\t\tcolorFills[ icf + 0 ] = llo;\n\t\t\tcolorFills[ icf + 4 ] = llo;\n\t\t\tiv += 4;\n\t\t\tis += 12;\n\t\t\ticf += 8;\n\t\t}\n\n\t\t// Last segment\n\t\t{\n\t\t\tpprevx = px;\n\t\t\tpprevy = py;\n\t\t\tpx = pnextx;\n\t\t\tpy = pnexty;\n\t\t\tpseg = psegnext;\n\t\t\tif( pointsClosed ) {\n\t\t\t\tpnextx = psecondx;\n\t\t\t\tpnexty = psecondy;\n\t\t\t\tpsegnext = psegsecond;\n\t\t\t} else {\n\t\t\t\tpnextx = px + (px - pprevx);\n\t\t\t\tpnexty = py + (py - pprevy);\n\t\t\t\tpsegnext = false;\n\t\t\t}\n\t\t\tlprev = l;\n\t\t\tl = lnext;\n\n\t\t\tlet pnextxn = pnextx;\n\t\t\tlet pnextyn = pnexty;\n\t\t\tlet loffsetprev = loffset;\n\t\t\tif( pseg ) {\n\t\t\t\tpprevx = px - (pnextx - px);\n\t\t\t\tpprevy = py - (pnexty - py);\n\n\t\t\t\tlmax = Math.max( lmax, llo );\n\n\t\t\t\tllop = lprev - loffset;\n\t\t\t\tconst dash = toDash( llop, strokeWidth, pointsStyle, LINE_WORK_POINT );\n\t\t\t\tconst dash0 = dash.x;\n\t\t\t\tconst dash1 = dash.y;\n\t\t\t\tfor( let j = icfprev; j < icf + 8; j += 4 ) {\n\t\t\t\t\tcolorFills[ j + 1 ] = dash0;\n\t\t\t\t\tcolorFills[ j + 2 ] = dash1;\n\t\t\t\t\tcolorFills[ j + 3 ] = llop;\n\t\t\t\t}\n\t\t\t\ticfprev = icf + 8;\n\t\t\t\tloffsetprev = loffset;\n\t\t\t\tloffset = l;\n\t\t\t} else if( psegnext ) {\n\t\t\t\tpnextxn = px + (px - pprevx);\n\t\t\t\tpnextyn = py + (py - pprevy);\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tvertices[ iv + 0 ] = px;\n\t\t\tvertices[ iv + 1 ] = py;\n\t\t\tvertices[ iv + 2 ] = px;\n\t\t\tvertices[ iv + 3 ] = py;\n\t\t\tsteps[ is +  0 ] = strokeWidth;\n\t\t\tsteps[ is +  1 ] = scaleInvariant;\n\t\t\tsteps[ is +  2 ] = pprevx;\n\t\t\tsteps[ is +  3 ] = pprevy;\n\t\t\tsteps[ is +  4 ] = pnextxn;\n\t\t\tsteps[ is +  5 ] = pnextyn;\n\t\t\tsteps[ is +  6 ] = strokeWidth;\n\t\t\tsteps[ is +  7 ] = scaleInvariant;\n\t\t\tsteps[ is +  8 ] = pprevx;\n\t\t\tsteps[ is +  9 ] = pprevy;\n\t\t\tsteps[ is + 10 ] = pnextxn;\n\t\t\tsteps[ is + 11 ] = pnextyn;\n\t\t\tllop = l - loffsetprev;\n\t\t\tlmax = Math.max( lmax, llop );\n\t\t\tcolorFills[ icf + 0 ] = llop;\n\t\t\tcolorFills[ icf + 4 ] = llop;\n\t\t\tiv += 4;\n\t\t\tis += 12;\n\t\t\ticf += 8;\n\n\t\t\t// Total length\n\t\t\tif( icfprev < icf ) {\n\t\t\t\tconst dash = toDash( llop, strokeWidth, pointsStyle, LINE_WORK_POINT );\n\t\t\t\tconst dash0 = dash.x;\n\t\t\t\tconst dash1 = dash.y;\n\t\t\t\tif( pointsClosed ) {\n\t\t\t\t\tfor( let i = icfprev; i < icf; i += 4 ) {\n\t\t\t\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\t\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\t\t\t\tcolorFills[ i + 3 ] = -1;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = icfprev; i < icf; i += 4 ) {\n\t\t\t\t\t\tcolorFills[ i + 1 ] = dash0;\n\t\t\t\t\t\tcolorFills[ i + 2 ] = dash1;\n\t\t\t\t\t\tcolorFills[ i + 3 ] = llop;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t}\n\t}\n\n\t// Fill the rest\n\tfor( const ivmax = ((voffset + vcount) << 1); iv < ivmax; iv += 2, is += 6, icf += 4 ) {\n\t\tvertices[ iv + 0 ] = px;\n\t\tvertices[ iv + 1 ] = py;\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = 0;\n\t\tsteps[ is + 3 ] = 0;\n\t\tsteps[ is + 4 ] = 0;\n\t\tsteps[ is + 5 ] = 0;\n\t\tcolorFills[ icf + 0 ] = 0;\n\t\tcolorFills[ icf + 1 ] = 0;\n\t\tcolorFills[ icf + 2 ] = 0;\n\t\tcolorFills[ icf + 4 ] = 0;\n\t}\n\n\treturn lmax;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport {\n\tbuildLineClipping, buildLineIndex, buildLineUv,\n\tbuildLineVertexStepAndColorFill, toLineVertexCount\n} from \"./build-line\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeLineUploaded extends EShapeTextUploaded {\n\tprotected pointCount: number;\n\tprotected pointId: number;\n\tprotected pointsClosed: boolean;\n\tprotected length: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount, antialiasWeight );\n\t\tthis.pointId = -1;\n\t\tthis.pointCount = 0;\n\t\tthis.pointsClosed = false;\n\t\tthis.length = 1;\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clipping & indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateIndices();\n\t\tbuildLineIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset,\n\t\t\tthis.indexCount - this.textIndexCount\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\t//\n\t\tthis.update( shape );\n\n\t\treturn this;\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst points = shape.points;\n\t\t\tconst vcount = toLineVertexCount( points ? points.length : 0 );\n\t\t\treturn vcount === this.vertexCount - this.textVertexCount;\n\t\t}\n\t\treturn false;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateLineClipping( buffer, shape );\n\t\tthis.updateLineVertexStepAndColorFill( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateLineUv( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateLineClipping( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst points = shape.points;\n\t\tif( points ) {\n\t\t\tconst pointCount = points.length;\n\t\t\tconst pointsClosed = (!! (points.style & EShapePointsStyle.CLOSED));\n\t\t\tif( this.pointCount !== pointCount || this.pointsClosed !== pointsClosed ) {\n\t\t\t\tthis.pointCount = pointCount;\n\t\t\t\tthis.pointsClosed = pointsClosed;\n\n\t\t\t\t// Invalidate the pointId to update the vertices\n\t\t\t\tthis.pointId = -1;\n\n\t\t\t\tbuffer.updateClippings();\n\t\t\t\tbuildLineClipping(\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tthis.vertexOffset,\n\t\t\t\t\tthis.vertexCount - this.textVertexCount,\n\t\t\t\t\tpointCount,\n\t\t\t\t\tpointsClosed\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLineVertexStepAndColorFill( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst points = shape.points;\n\t\tif( points ) {\n\t\t\tconst pointId = points.id;\n\t\t\tconst isPointChanged = ( pointId !== this.pointId );\n\n\t\t\tconst stroke = shape.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tconst isStrokeWidthChanged = ( strokeWidth !== this.strokeWidth );\n\n\t\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\t\tif( isPointChanged || isTransformChanged || isStrokeWidthChanged ) {\n\t\t\t\tthis.pointId = pointId;\n\t\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\t\tthis.transformLocalId = transformLocalId;\n\n\t\t\t\tif( isPointChanged || isTransformChanged ) {\n\t\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t\t}\n\t\t\t\tif( isPointChanged ) {\n\t\t\t\t\t// Invalidate the texture transform ID to update the UVs\n\t\t\t\t\tthis.textureTransformId = NaN;\n\t\t\t\t}\n\n\t\t\t\tbuffer.updateVertices();\n\t\t\t\tbuffer.updateSteps();\n\t\t\t\tbuffer.updateColorFills();\n\t\t\t\tthis.length = buildLineVertexStepAndColorFill(\n\t\t\t\t\tbuffer.vertices,\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tbuffer.colorFills,\n\t\t\t\t\tthis.vertexOffset,\n\t\t\t\t\tthis.vertexCount - this.textVertexCount,\n\t\t\t\t\tthis.pointCount,\n\t\t\t\t\tthis.pointsClosed,\n\t\t\t\t\tpoints.values,\n\t\t\t\t\tpoints.segments,\n\t\t\t\t\tpoints.style,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.transform.internalTransform\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateColorFillAndStroke( buffer: EShapeBuffer, shape: EShape, vertexCount: number ) {\n\t\tthis.updateColorStroke( buffer, shape, vertexCount );\n\t}\n\n\tupdateLineUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tbuffer.updateUvs();\n\t\t\tbuildLineUv(\n\t\t\t\tbuffer.uvs,\n\t\t\t\tbuffer.colorFills,\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tthis.vertexCount - this.textVertexCount,\n\t\t\t\tpointCount,\n\t\t\t\tthis.pointsClosed,\n\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\tthis.length\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { toLineVertexCount } from \"./build-line\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { EShapeLineUploaded } from \"./e-shape-line-uploaded\";\n\nexport const createLineUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeLineUploaded | null => {\n\tconst points = shape.points;\n\tconst pointCount = ( points ? points.length : 0 );\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = toLineVertexCount( pointCount ) + tvcount;\n\tconst icount = vcount - tvcount - 2 + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeLineUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { toIndexOf } from \"../../util/to-index-of\";\nimport { EShape } from \"../e-shape\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport { EShapeLineBasePointsHitTester, EShapeLineBasePointsTestRange } from \"./e-shape-line-base-points\";\n\nexport class EShapeLinePoints implements EShapePoints {\n\tprotected static WORK_RANGE: [ number, number ] = [ 0, 0 ];\n\n\tprotected _parent: EShape;\n\tprotected _valuesBase?: number[];\n\tprotected _valuesBaseLength: number;\n\tprotected _values: number[];\n\tprotected _segments: number[];\n\treadonly position: Point;\n\tprotected _sizeBase: Point;\n\treadonly size: Point;\n\tprotected _id: number;\n\tprotected _style: EShapePointsStyle;\n\n\tconstructor(\n\t\tparent: EShape,\n\t\tpoints: number[],\n\t\tsegments: number[],\n\t\tstyle: EShapePointsStyle\n\t) {\n\t\t// Calculate the center\n\t\tconst values: number[] = [];\n\t\tlet minX = 0;\n\t\tlet maxX = 0;\n\t\tlet minY = 0;\n\t\tlet maxY = 0;\n\t\tconst pointsLength = points.length;\n\t\tif( 2 <= pointsLength ) {\n\t\t\tminX = maxX = points[ 0 ];\n\t\t\tminY = maxY = points[ 1 ];\n\t\t\tfor( let i = 2; i < pointsLength; i += 2 ) {\n\t\t\t\tconst x = points[ i ];\n\t\t\t\tconst y = points[ i + 1 ];\n\t\t\t\tminX = Math.min( minX, x );\n\t\t\t\tmaxX = Math.max( maxX, x );\n\t\t\t\tminY = Math.min( minY, y );\n\t\t\t\tmaxY = Math.max( maxY, y );\n\t\t\t}\n\t\t}\n\t\tconst cx = (maxX + minX) * 0.5;\n\t\tconst cy = (maxY + minY) * 0.5;\n\t\tfor( let i = 0; i < pointsLength; i += 2 ) {\n\t\t\tconst x = points[ i + 0 ] - cx;\n\t\t\tconst y = points[ i + 1 ] - cy;\n\t\t\tvalues.push( x, y );\n\t\t}\n\t\tconst sx = maxX - minX;\n\t\tconst sy = maxY - minY;\n\n\t\t//\n\t\tthis._parent = parent;\n\t\tthis._valuesBase = undefined;\n\t\tthis._valuesBaseLength = values.length;\n\t\tthis._values = values;\n\t\tthis._segments = segments.slice( 0 );\n\t\tthis._sizeBase = new Point( sx, sy );\n\t\tthis.size = new Point( sx, sy );\n\t\tthis.position = new Point( cx, cy );\n\t\tthis._id = 0;\n\t\tthis._style = style!;\n\t}\n\n\tget length(): number {\n\t\treturn this._values.length >> 1;\n\t}\n\n\tprivate fitToParentSize() {\n\t\tconst size = this.size;\n\t\tconst parentSize = this._parent.size;\n\t\tconst ssx = parentSize.x;\n\t\tconst ssy = parentSize.y;\n\t\tconst threshold = 0.00001;\n\t\tif( threshold < Math.abs( ssx - size.x ) || threshold < Math.abs( ssy - size.y ) ) {\n\t\t\tsize.set( ssx, ssy );\n\n\t\t\tconst sizeBase = this._sizeBase;\n\t\t\tconst hasSizeBaseX = threshold < Math.abs( sizeBase.x );\n\t\t\tconst hasSizeBaseY = threshold < Math.abs( sizeBase.y );\n\t\t\tif( hasSizeBaseX || hasSizeBaseY ) {\n\t\t\t\tconst scaleX = ( hasSizeBaseX ? ssx / sizeBase.x : 1 );\n\t\t\t\tconst scaleY = ( hasSizeBaseY ? ssy / sizeBase.y : 1 );\n\n\t\t\t\tconst values = this._values;\n\t\t\t\tlet valuesBase = this._valuesBase;\n\t\t\t\tif( valuesBase == null ) {\n\t\t\t\t\tvaluesBase = [];\n\t\t\t\t\tthis._valuesBase = valuesBase;\n\n\t\t\t\t\tfor( let i = 0, imax = this.length << 1; i < imax; i += 2 ) {\n\t\t\t\t\t\tconst x = values[ i ];\n\t\t\t\t\t\tconst y = values[ i + 1 ];\n\t\t\t\t\t\tvalues[ i ] = x * scaleX;\n\t\t\t\t\t\tvalues[ i + 1 ] = y * scaleY;\n\t\t\t\t\t\tvaluesBase.push( x, y );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = this.length << 1; i < imax; i += 2 ) {\n\t\t\t\t\t\tvalues[ i ] = valuesBase[ i ] * scaleX;\n\t\t\t\t\t\tvalues[ i + 1 ] = valuesBase[ i + 1 ] * scaleY;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._id += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tget id(): number {\n\t\tthis.fitToParentSize();\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\tthis.fitToParentSize();\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\tthis.set( values, undefined, undefined );\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\t/**\n\t * Must be sorted in ascending order.\n\t */\n\tset segments( segments: number[] ) {\n\t\tthis.set( undefined, segments, undefined );\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn this._style;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.set( undefined, undefined, style );\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\treturn this.set( source.values, source.segments, source.style );\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet isDirty = false;\n\t\tlet isUpdated = false;\n\n\t\t// Values\n\t\tif( newValues != null ) {\n\t\t\tconst values = this._values;\n\t\t\tconst valuesBaseLength = this._valuesBaseLength;\n\t\t\tconst newValuesLength = newValues.length;\n\t\t\tconst iupdate = Math.min( newValuesLength, valuesBaseLength );\n\t\t\tthis._valuesBase = undefined;\n\t\t\tif( values !== newValues ) {\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tvalues[ i ] = newValues[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newValuesLength; ++i ) {\n\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( valuesBaseLength !== newValuesLength ) {\n\t\t\t\t\tvalues.length = newValuesLength;\n\t\t\t\t\tthis._valuesBaseLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( valuesBaseLength !== newValuesLength ) {\n\t\t\t\t\tthis._valuesBaseLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Segments\n\t\tif( newSegments != null ) {\n\t\t\tconst segments = this._segments;\n\t\t\tif( segments !== newSegments ) {\n\t\t\t\tconst newSegmentsLength = newSegments.length;\n\t\t\t\tconst iupdate = Math.min( segments.length, newSegmentsLength );\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tsegments[ i ] = newSegments[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newSegmentsLength; ++i ) {\n\t\t\t\t\tsegments.push( newSegments[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( segments.length !== newSegmentsLength ) {\n\t\t\t\t\tsegments.length = newSegmentsLength;\n\t\t\t\t}\n\t\t\t}\n\t\t\tisUpdated = true;\n\t\t}\n\n\t\t// Style\n\t\tif( newStyle != null ) {\n\t\t\tconst oldStyle = this._style;\n\t\t\tif( oldStyle !== newStyle ) {\n\t\t\t\tthis._style = newStyle;\n\t\t\t\tisUpdated = true;\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( isDirty ) {\n\t\t\tthis._id += 1;\n\t\t\tconst parent = this._parent;\n\t\t\tconst uploaded = parent.uploaded;\n\t\t\tif( uploaded ) {\n\t\t\t\tif( uploaded.isCompatible( parent ) ) {\n\t\t\t\t\tparent.updateUploaded();\n\t\t\t\t} else {\n\t\t\t\t\tparent.uploaded = undefined;\n\t\t\t\t\tparent.toDirty();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tparent.updateUploaded();\n\t\t\t}\n\t\t} else if( isUpdated ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclone( parent: EShape ): EShapeLinePoints {\n\t\treturn new EShapeLinePoints( parent, this._values, this._segments, this._style );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.addResource( `[${JSON.stringify(this._values)},${JSON.stringify(this._segments)},${this._style}]` );\n\t}\n\n\tcalcHitPointAbs<RESULT>(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tthreshold: number,\n\t\trange: EShapeLineBasePointsTestRange | null,\n\t\ttester: EShapeLineBasePointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst pointCount = this.length;\n\t\tif( 2 <= pointCount ) {\n\t\t\tconst pointValues = this._values;\n\t\t\tconst pointSegments = this._segments;\n\t\t\tlet istart = 0;\n\t\t\tlet iend = pointCount;\n\t\t\tif( range ) {\n\t\t\t\tconst rangeResult = range( x, y, threshold, pointValues, EShapeLinePoints.WORK_RANGE );\n\t\t\t\tistart = rangeResult[ 0 ];\n\t\t\t\tiend = rangeResult[ 1 ];\n\t\t\t}\n\t\t\tfor( let i = istart, imax = Math.min( iend, pointCount - 1 ), iv = 2 * istart; i < imax; i += 1, iv += 2 ) {\n\t\t\t\tif( toIndexOf( pointSegments, i + 1 ) < 0 ) {\n\t\t\t\t\tconst p0x = pointValues[ iv + 0 ];\n\t\t\t\t\tconst p0y = pointValues[ iv + 1 ];\n\t\t\t\t\tconst p1x = pointValues[ iv + 2 ];\n\t\t\t\t\tconst p1y = pointValues[ iv + 3 ];\n\t\t\t\t\tif( tester( x, y, p0x, p0y, p1x, p1y, i, threshold, result ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 2 < pointCount && pointCount <= iend && (this.style & EShapePointsStyle.CLOSED) ) {\n\t\t\t\tif( toIndexOf( pointSegments, 0 ) < 0 ) {\n\t\t\t\t\tconst i = pointCount - 1;\n\t\t\t\t\tconst iv = i << 1;\n\t\t\t\t\tconst p0x = pointValues[ iv + 0 ];\n\t\t\t\t\tconst p0y = pointValues[ iv + 1 ];\n\t\t\t\t\tconst p1x = pointValues[ 0 ];\n\t\t\t\t\tconst p1y = pointValues[ 1 ];\n\t\t\t\t\tif( tester( x, y, p0x, p0y, p1x, p1y, i, threshold, result ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeLineBase } from \"./e-shape-line-base\";\nimport { EShapeLinePoints } from \"./e-shape-line-points\";\n\nexport class EShapeLine extends EShapeLineBase {\n\tprotected declare _points: EShapeLinePoints;\n\n\tconstructor( line: EShapeLine );\n\tconstructor( points: number[], segments: number[], width: number, style: EShapePointsStyle );\n\tconstructor(\n\t\tlineOrPoints: EShapeLine | number[],\n\t\tsegments?: number[],\n\t\twidth?: number,\n\t\tstyle?: EShapePointsStyle\n\t) {\n\t\tsuper( EShapeType.LINE );\n\t\tif( lineOrPoints instanceof EShapeLine ) {\n\t\t\tthis.copy( lineOrPoints );\n\t\t} else {\n\t\t\tthis.fill.enable = false;\n\t\t\tthis.stroke.set( true, undefined, undefined, width! );\n\t\t\tthis._points = new EShapeLinePoints( this, lineOrPoints, segments!, style! );\n\t\t\tthis.transform.position.copyFrom( this._points.position );\n\t\t\tthis.size.copyFrom( this._points.size );\n\t\t}\n\t}\n\n\tget points(): EShapeLinePoints {\n\t\treturn this._points;\n\t}\n\n\tclone(): EShapeLine {\n\t\treturn new EShapeLine( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLine } from \"./e-shape-line\";\n\nexport const deserializeLine = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeLine> | EShapeLine | null => {\n\tconst resources = manager.resources;\n\tconst resourceId = item[ 15 ];\n\tif( 0 <= resourceId && resourceId < resources.length ) {\n\t\tlet parsed = manager.getExtension<[ number[], number[], number ]>( resourceId );\n\t\tif( parsed == null ) {\n\t\t\tparsed = JSON.parse( resources[ resourceId ] ) as [ number[], number[], number ];\n\t\t\tmanager.setExtension( resourceId, parsed );\n\t\t}\n\t\tconst shape = new EShapeLine(\n\t\t\tparsed[ 0 ],\n\t\t\tparsed[ 1 ],\n\t\t\tEShapeDefaults.STROKE_WIDTH,\n\t\t\tparsed[ 2 ]\n\t\t);\n\t\treturn EShapeDeserializer.deserialize( item, manager, shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createLineUploaded } from \"../variant/create-line-uploaded\";\nimport { deserializeLine } from \"../variant/deserialize-line\";\n\nexport const loadShapeLine = () => {\n\tEShapeUploadeds[ EShapeType.LINE ] = createLineUploaded;\n\tEShapeDeserializers[ EShapeType.LINE ] = deserializeLine;\n};\n","import { buildColor } from \"./build-color\";\nimport { EShapeLineOfAnyPointsFill } from \"./e-shape-line-of-any-points-fill\";\nimport { EShapeLineOfAnyPointsStroke } from \"./e-shape-line-of-any-points-stroke\";\n\nexport const toLineOfAnyPointCount = ( pointCount: number ): number => {\n\treturn (Math.ceil( pointCount / 12 ) * 12);\n};\n\nexport const buildLineOfAnyColor = (\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpoint: EShapeLineOfAnyPointsStroke | EShapeLineOfAnyPointsFill,\n\tpointCount: number,\n\tcolors: Float32Array,\n\tisEnabled: boolean,\n\tcolorDef: number,\n\talphaDef: number\n): void => {\n\tif( isEnabled ) {\n\t\tif( point.isStaticColor() ) {\n\t\t\tconst color = point.getColor( 0, colorDef );\n\t\t\tif( point.isStaticAlpha() ) {\n\t\t\t\tconst alpha = point.getAlpha( 0, alphaDef );\n\t\t\t\tbuildColor( color, alpha, voffset, vcountPerPoint * pointCount, colors );\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\t\tconst alpha = point.getAlpha( i, alphaDef );\n\t\t\t\t\tbuildColor( color, alpha, iv, vcountPerPoint, colors );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( point.isStaticAlpha() ) {\n\t\t\t\tconst alpha = point.getAlpha( 0, alphaDef );\n\t\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\t\tconst color = point.getColor( i, colorDef );\n\t\t\t\t\tbuildColor( color, alpha, iv, vcountPerPoint, colors );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\t\tconst color = point.getColor( i, colorDef );\n\t\t\t\t\tconst alpha = point.getAlpha( i, alphaDef );\n\t\t\t\t\tbuildColor( color, alpha, iv, vcountPerPoint, colors );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t} else {\n\t\tif( point.isStaticColor() ) {\n\t\t\tconst color = point.getColor( 0, colorDef );\n\t\t\tbuildColor( color, 0, voffset, vcountPerPoint * pointCount, colors );\n\t\t} else {\n\t\t\tfor( let i = 0, iv = voffset; i < pointCount; i += 1, iv += vcountPerPoint ) {\n\t\t\t\tconst color = point.getColor( i, colorDef );\n\t\t\t\tbuildColor( color, 0, iv, vcountPerPoint, colors );\n\t\t\t}\n\t\t}\n\t}\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { toLineOfAnyPointCount } from \"./build-line-of-any\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\n\ninterface Initializable {\n\tinit( shape: EShape ): this;\n}\n\nexport type EShapeLineOfAnyUploadedConstructor<T extends Initializable> = new (\n\tbuffer: EShapeBuffer,\n\tvoffset: number, ioffset: number,\n\ttvcount: number, ticount: number,\n\tvcount: number, icount: number,\n\tantialiasWeight: number,\n\tpointCount: number\n) => T;\n\nexport const createLineOfAnyUploaded = <T extends Initializable>(\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tioffset: number,\n\ticountPerPoint: number,\n\tantialiasWeight: number,\n\tconstructor: EShapeLineOfAnyUploadedConstructor<T>\n): T | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst points = shape.points;\n\tconst pointCount = toLineOfAnyPointCount( points ? points.length : 0 );\n\tconst vcount = pointCount * vcountPerPoint + tvcount;\n\tconst icount = pointCount * icountPerPoint + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new constructor(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight,\n\t\t\tpointCount\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","\nexport const buildNullClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tvcount: number\n): void => {\n\tfor( let i = voffset * 3, imax = (voffset + vcount) * 3; i < imax; i += 3 ) {\n\t\tclippings[ i + 0 ] = 0;\n\t\tclippings[ i + 1 ] = 0;\n\t\tclippings[ i + 2 ] = 0;\n\t}\n};\n\nexport const buildNullIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number,\n\ticount: number\n): void => {\n\tfor( let ii = ioffset * 3, iimax = (ioffset + icount) * 3; ii < iimax; ii += 3 ) {\n\t\tindices[ ii + 0 ] = voffset;\n\t\tindices[ ii + 1 ] = voffset;\n\t\tindices[ ii + 2 ] = voffset;\n\t}\n};\n\nexport const buildNullVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\tvcount: number\n): void => {\n\tfor( let i = voffset * 2, imax = (voffset + vcount) * 2; i < imax; i += 2 ) {\n\t\tvertices[ i + 0 ] = 0;\n\t\tvertices[ i + 1 ] = 0;\n\t}\n};\n\nexport const buildNullStep = (\n\tsteps: Float32Array,\n\tvoffset: number,\n\tvcount: number\n): void => {\n\tfor( let i = voffset * 6, imax = (voffset + vcount) * 6; i < imax; i += 6 ) {\n\t\tsteps[ i + 0 ] = 0;\n\t\tsteps[ i + 1 ] = 0;\n\t\tsteps[ i + 2 ] = 0;\n\t\tsteps[ i + 3 ] = 0;\n\t\tsteps[ i + 4 ] = 0;\n\t\tsteps[ i + 5 ] = 0;\n\t}\n};\n\nexport const buildNullUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\tvcount: number\n): void => {\n\tfor( let i = voffset * 2, imax = (voffset + vcount) * 2; i < imax; i += 2 ) {\n\t\tuvs[ i + 0 ] = 0;\n\t\tuvs[ i + 1 ] = 0;\n\t}\n};\n","\nexport const copyClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number\n): void => {\n\tlet iv = voffset + vcountPerPoint;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet icd = iv * 3;\n\t\tlet ics = voffset * 3;\n\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\tclippings[ icd + 0 ] = clippings[ ics + 0 ];\n\t\t\tclippings[ icd + 1 ] = clippings[ ics + 1 ];\n\t\t\tclippings[ icd + 2 ] = clippings[ ics + 2 ];\n\t\t\ticd += 3;\n\t\t\tics += 3;\n\t\t}\n\t\tiv += vcountPerPoint;\n\t}\n};\n","export const copyIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvcountPerPoint: number,\n\tioffset: number,\n\ticountPerPoint: number,\n\tpointCount: number\n): void => {\n\tlet idiv = vcountPerPoint;\n\tlet ii = ioffset + icountPerPoint;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet iid = ii * 3;\n\t\tlet iis = ioffset * 3;\n\t\tfor( let j = 0; j < icountPerPoint; ++j ) {\n\t\t\tindices[ iid + 0 ] = indices[ iis + 0 ] + idiv;\n\t\t\tindices[ iid + 1 ] = indices[ iis + 1 ] + idiv;\n\t\t\tindices[ iid + 2 ] = indices[ iis + 2 ] + idiv;\n\t\t\tiid += 3;\n\t\t\tiis += 3;\n\t\t}\n\t\tidiv += vcountPerPoint;\n\t\tii += icountPerPoint;\n\t}\n};\n","export const copyStep = (\n\tsteps: Float32Array,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number\n): void => {\n\tconst iss0 = voffset * 6;\n\tlet isd = (voffset + vcountPerPoint) * 6;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet iss = iss0;\n\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\tsteps[ isd + 0 ] = steps[ iss + 0 ];\n\t\t\tsteps[ isd + 1 ] = steps[ iss + 1 ];\n\t\t\tsteps[ isd + 2 ] = steps[ iss + 2 ];\n\t\t\tsteps[ isd + 3 ] = steps[ iss + 3 ];\n\t\t\tsteps[ isd + 4 ] = steps[ iss + 4 ];\n\t\t\tsteps[ isd + 5 ] = steps[ iss + 5 ];\n\t\t\tisd += 6;\n\t\t\tiss += 6;\n\t\t}\n\t}\n};\n","\nexport const copyUvs = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number\n): void => {\n\tlet iv = voffset + vcountPerPoint;\n\tfor( let i = 1; i < pointCount; ++i ) {\n\t\tlet iuvd = iv << 1;\n\t\tlet iuvs = voffset << 1;\n\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\tuvs[ iuvd     ] = uvs[ iuvs     ];\n\t\t\tuvs[ iuvd + 1 ] = uvs[ iuvs + 1 ];\n\t\t\tiuvd += 2;\n\t\t\tiuvs += 2;\n\t\t}\n\t\tiv += vcountPerPoint;\n\t}\n};\n","import { Matrix } from \"pixi.js\";\nimport { EShapeLineOfAnyPointsPoint } from \"./e-shape-line-of-any-points-point\";\n\nexport const copyVertex = (\n\tvertices: Float32Array,\n\tinternalTransform: Matrix,\n\tvoffset: number,\n\tvcountPerPoint: number,\n\tpointCount: number,\n\tpointsValues: number[],\n\tpointOffset: EShapeLineOfAnyPointsPoint\n): void => {\n\tconst a = internalTransform.a;\n\tconst b = internalTransform.b;\n\tconst c = internalTransform.c;\n\tconst d = internalTransform.d;\n\tlet i = pointCount - 1;\n\tlet iv = voffset + i * vcountPerPoint;\n\tif( pointOffset.isStaticX() && pointOffset.isStaticY() ) {\n\t\tconst ox = pointOffset.getX( 0 );\n\t\tconst oy = pointOffset.getY( 0 );\n\t\tfor( ; 0 <= i; --i ) {\n\t\t\tconst ip = i << 1;\n\t\t\tconst px = pointsValues[ ip     ] + ox;\n\t\t\tconst py = pointsValues[ ip + 1 ] + oy;\n\t\t\tconst dx = a * px + c * py;\n\t\t\tconst dy = b * px + d * py;\n\t\t\tlet ivd = iv << 1;\n\t\t\tlet ivs = voffset << 1;\n\t\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\t\tvertices[ ivd     ] = vertices[ ivs     ] + dx;\n\t\t\t\tvertices[ ivd + 1 ] = vertices[ ivs + 1 ] + dy;\n\t\t\t\tivd += 2;\n\t\t\t\tivs += 2;\n\t\t\t}\n\t\t\tiv -= vcountPerPoint;\n\t\t}\n\t} else {\n\t\tfor( ; 0 <= i; --i ) {\n\t\t\tconst ip = i << 1;\n\t\t\tconst px = pointsValues[ ip     ] + pointOffset.getX( i );\n\t\t\tconst py = pointsValues[ ip + 1 ] + pointOffset.getY( i );\n\t\t\tconst dx = a * px + c * py;\n\t\t\tconst dy = b * px + d * py;\n\t\t\tlet ivd = iv << 1;\n\t\t\tlet ivs = voffset << 1;\n\t\t\tfor( let j = 0; j < vcountPerPoint; ++j ) {\n\t\t\t\tvertices[ ivd     ] = vertices[ ivs     ] + dx;\n\t\t\t\tvertices[ ivd + 1 ] = vertices[ ivs + 1 ] + dy;\n\t\t\t\tivd += 2;\n\t\t\t\tivs += 2;\n\t\t\t}\n\t\t\tiv -= vcountPerPoint;\n\t\t}\n\t}\n};\n","import { isNumber } from \"../../util/is-number\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\n\nexport const isStatic = ( value: EShapeLineOfAnyValue ): boolean => {\n\treturn isNumber( value ) || value == null;\n};\n","import { isFunction } from \"../../util/is-function\";\nimport { isNumber } from \"../../util/is-number\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\n\nexport const toComputed = ( index: number, value: EShapeLineOfAnyValue, def: number ): number => {\n\tif( isNumber( value ) ) {\n\t\treturn value;\n\t} else if( isFunction( value ) ) {\n\t\treturn value( index );\n\t} else if( value ) {\n\t\treturn value[ index % value.length ];\n\t}\n\treturn def;\n};\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeLineOfAnyPointsFill } from \"./e-shape-line-of-any-points-fill\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\nimport { isStatic } from \"./is-static\";\nimport { toComputed } from \"./to-computed\";\n\nexport interface EShapeLineOfAnyPointsFillImplParent {\n\tupdateUploaded(): void;\n}\n\nexport class EShapeLineOfAnyPointsFillImpl implements EShapeLineOfAnyPointsFill {\n\tprotected _parent: EShapeLineOfAnyPointsFillImplParent;\n\tprotected _id: number;\n\tprotected _color: EShapeLineOfAnyValue;\n\tprotected _alpha: EShapeLineOfAnyValue;\n\n\tconstructor( parent: EShapeLineOfAnyPointsFillImplParent ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._color = null;\n\t\tthis._alpha = null;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget color(): EShapeLineOfAnyValue {\n\t\treturn this._color;\n\t}\n\n\tset color( color: EShapeLineOfAnyValue ) {\n\t\tthis.set( color, undefined );\n\t}\n\n\tget alpha(): EShapeLineOfAnyValue {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: EShapeLineOfAnyValue ) {\n\t\tthis.set( undefined, alpha );\n\t}\n\n\tset( color?: EShapeLineOfAnyValue, alpha?: EShapeLineOfAnyValue ): void {\n\t\tlet isChanged = false;\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tisChanged = true;\n\t\t\tthis._color = color;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tisChanged = true;\n\t\t\tthis._alpha = alpha;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tgetColor( index: number, def: number ): number {\n\t\treturn toComputed( index, this._color, def );\n\t}\n\n\tgetAlpha( index: number, def: number ): number {\n\t\treturn toComputed( index, this._alpha, def );\n\t}\n\n\tisStaticColor(): boolean {\n\t\treturn isStatic( this._color );\n\t}\n\n\tisStaticAlpha(): boolean {\n\t\treturn isStatic( this._alpha );\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isFunction } from \"../../util/is-function\";\nimport { isNumber } from \"../../util/is-number\";\nimport { EShapeLineOfAnyPointsPoint } from \"./e-shape-line-of-any-points-point\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\nimport { isStatic } from \"./is-static\";\nimport { toComputed } from \"./to-computed\";\n\nexport interface EShapeLineOfAnyPointsPointImplParent {\n\treadonly length: number;\n\tupdateUploaded(): void;\n}\n\nexport class EShapeLineOfAnyPointsPointImpl implements EShapeLineOfAnyPointsPoint {\n\tprotected _parent: EShapeLineOfAnyPointsPointImplParent;\n\tprotected _id: number;\n\tprotected _x: EShapeLineOfAnyValue;\n\tprotected _y: EShapeLineOfAnyValue;\n\tprotected _defX: number;\n\tprotected _defY: number;\n\tprotected _limit: number | null;\n\tprotected _limitComputed: number;\n\tprotected _limitId: number;\n\tprotected _limitParentLength: number;\n\n\tconstructor( parent: EShapeLineOfAnyPointsPointImplParent, defX: number, defY: number ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._x = null;\n\t\tthis._y = null;\n\t\tthis._defX = defX;\n\t\tthis._defY = defY;\n\t\tthis._limit = null;\n\t\tthis._limitComputed = 0;\n\t\tthis._limitId = -1;\n\t\tthis._limitParentLength = 0;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget x(): EShapeLineOfAnyValue {\n\t\treturn this._x;\n\t}\n\n\tset x( x: EShapeLineOfAnyValue ) {\n\t\tthis.set( x, undefined );\n\t}\n\n\tget y(): EShapeLineOfAnyValue {\n\t\treturn this._y;\n\t}\n\n\tset y( y: EShapeLineOfAnyValue ) {\n\t\tthis.set( undefined, y );\n\t}\n\n\tget limit(): number | null {\n\t\treturn this._limit;\n\t}\n\n\tset limit( limit: number | null ) {\n\t\tthis._limit = limit;\n\t}\n\n\tset( x?: EShapeLineOfAnyValue, y?: EShapeLineOfAnyValue ): void {\n\t\tlet isChanged = false;\n\n\t\tif( x !== undefined && this._x !== x ) {\n\t\t\tisChanged = true;\n\t\t\tthis._x = x;\n\t\t}\n\n\t\tif( y !== undefined && this._y !== y ) {\n\t\t\tisChanged = true;\n\t\t\tthis._y = y;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tgetX( index: number ): number {\n\t\treturn toComputed( index, this._x, this._defX );\n\t}\n\n\tgetY( index: number ): number {\n\t\treturn toComputed( index, this._y, this._defY );\n\t}\n\n\tgetLimit(): number {\n\t\tconst limit = this._limit;\n\t\tif( limit != null ) {\n\t\t\treturn limit;\n\t\t}\n\t\tthis.updateLimitComputed();\n\t\treturn this._limitComputed;\n\t}\n\n\tprotected updateLimitComputed(): void {\n\t\tconst limitId = this._id;\n\t\tconst parent = this._parent;\n\t\tconst limitParentLength = parent.length;\n\t\tif( this._limitId !== limitId || this._limitParentLength !== limitParentLength ) {\n\t\t\tthis._limitId = limitId;\n\t\t\tthis._limitParentLength = limitParentLength;\n\t\t\tthis._limitComputed = Math.max(\n\t\t\t\tthis.calcLimit( this._x, limitParentLength, this._defX ),\n\t\t\t\tthis.calcLimit( this._y, limitParentLength, this._defY )\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected calcLimit( value: EShapeLineOfAnyValue, parentLenght: number, def: number ): number {\n\t\tif( isNumber( value ) ) {\n\t\t\treturn Math.abs( value );\n\t\t} else if( isFunction( value ) ) {\n\t\t\tif( 0 < parentLenght ) {\n\t\t\t\tlet result = Math.abs( value( 0 ) );\n\t\t\t\tfor( let i = 1; i < parentLenght; ++i ) {\n\t\t\t\t\tresult = Math.max( result, Math.abs( value( i ) ) );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\t\t} else if( value != null ) {\n\t\t\tconst l = value.length;\n\t\t\tif( 0 < l ) {\n\t\t\t\tlet result = value[ 0 ];\n\t\t\t\tfor( let i = 1; i < l; ++i ) {\n\t\t\t\t\tresult = Math.max( result, Math.abs( value[ i ] ) );\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t}\n\t\t\treturn 0;\n\t\t} else {\n\t\t\treturn Math.abs( def );\n\t\t}\n\t}\n\n\tisStaticX(): boolean {\n\t\treturn isStatic( this._x );\n\t}\n\n\tisStaticY(): boolean {\n\t\treturn isStatic( this._y );\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeLineOfAnyPointsStroke } from \"./e-shape-line-of-any-points-stroke\";\nimport { EShapeLineOfAnyValue } from \"./e-shape-line-of-any-value\";\nimport { isStatic } from \"./is-static\";\nimport { toComputed } from \"./to-computed\";\n\nexport interface EShapeLineOfAnyPointsStrokeImplParent {\n\tupdateUploaded(): void;\n}\n\nexport class EShapeLineOfAnyPointsStrokeImpl implements EShapeLineOfAnyPointsStroke {\n\tprotected _parent: EShapeLineOfAnyPointsStrokeImplParent;\n\tprotected _id: number;\n\tprotected _color: EShapeLineOfAnyValue;\n\tprotected _alpha: EShapeLineOfAnyValue;\n\n\tconstructor( parent: EShapeLineOfAnyPointsStrokeImplParent ) {\n\t\tthis._parent = parent;\n\t\tthis._id = 0;\n\t\tthis._color = null;\n\t\tthis._alpha = null;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget color(): EShapeLineOfAnyValue {\n\t\treturn this._color;\n\t}\n\n\tset color( color: EShapeLineOfAnyValue ) {\n\t\tthis.set( color, undefined );\n\t}\n\n\tget alpha(): EShapeLineOfAnyValue {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: EShapeLineOfAnyValue ) {\n\t\tthis.set( undefined, alpha );\n\t}\n\n\tset( color?: EShapeLineOfAnyValue, alpha?: EShapeLineOfAnyValue ): void {\n\t\tlet isChanged = false;\n\n\t\tif( color !== undefined && this._color !== color ) {\n\t\t\tisChanged = true;\n\t\t\tthis._color = color;\n\t\t}\n\n\t\tif( alpha !== undefined && this._alpha !== alpha ) {\n\t\t\tisChanged = true;\n\t\t\tthis._alpha = alpha;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\t}\n\n\tgetColor( index: number, def: number ): number {\n\t\treturn toComputed( index, this._color, def );\n\t}\n\n\tgetAlpha( index: number, def: number ): number {\n\t\treturn toComputed( index, this._alpha, def );\n\t}\n\n\tisStaticColor(): boolean {\n\t\treturn isStatic( this._color );\n\t}\n\n\tisStaticAlpha(): boolean {\n\t\treturn isStatic( this._alpha );\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix, Point } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeDefaults } from \"../e-shape-defaults\";\nimport { EShapePoints } from \"../e-shape-points\";\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeResourceManagerSerialization } from \"../e-shape-resource-manager-serialization\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester, EShapeLineOfAnyPointsTestRange\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsFill } from \"./e-shape-line-of-any-points-fill\";\nimport { EShapeLineOfAnyPointsFillImpl } from \"./e-shape-line-of-any-points-fill-impl\";\nimport { EShapeLineOfAnyPointsPoint } from \"./e-shape-line-of-any-points-point\";\nimport { EShapeLineOfAnyPointsPointImpl } from \"./e-shape-line-of-any-points-point-impl\";\nimport { EShapeLineOfAnyPointsStroke } from \"./e-shape-line-of-any-points-stroke\";\nimport { EShapeLineOfAnyPointsStrokeImpl } from \"./e-shape-line-of-any-points-stroke-impl\";\n\nexport class EShapeLineOfAnyPointsImpl implements EShapeLineOfAnyPoints {\n\tprotected static WORK_RANGE: [ number, number ] = [ 0, 0 ];\n\n\tprotected _parent: EShape;\n\tprotected _values: number[];\n\tprotected _valuesLength: number;\n\tprotected _segments: number[];\n\tprotected _size: EShapeLineOfAnyPointsPoint;\n\tprotected _offset: EShapeLineOfAnyPointsPoint;\n\tprotected _fill: EShapeLineOfAnyPointsFill;\n\tprotected _stroke: EShapeLineOfAnyPointsStroke;\n\tprotected _id: number;\n\n\tconstructor( parent: EShape ) {\n\t\tthis._parent = parent;\n\t\tthis._values = [];\n\t\tthis._valuesLength = 0;\n\t\tthis._segments = [];\n\t\tthis._size = new EShapeLineOfAnyPointsPointImpl( this, EShapeDefaults.SIZE_X, EShapeDefaults.SIZE_Y );\n\t\tthis._offset = new EShapeLineOfAnyPointsPointImpl( this, 0, 0 );\n\t\tthis._fill = new EShapeLineOfAnyPointsFillImpl( parent );\n\t\tthis._stroke = new EShapeLineOfAnyPointsStrokeImpl( parent );\n\t\tthis._id = 0;\n\t}\n\n\tget length(): number {\n\t\treturn this._values.length >> 1;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget values(): number[] {\n\t\treturn this._values;\n\t}\n\n\tset values( values: number[] ) {\n\t\tthis.set( values, undefined, undefined );\n\t}\n\n\tget segments(): number[] {\n\t\treturn this._segments;\n\t}\n\n\tset segments( segments: number[] ) {\n\t\t// DO NOTHING\n\t}\n\n\tget style(): EShapePointsStyle {\n\t\treturn EShapePointsStyle.NONE;\n\t}\n\n\tset style( style: EShapePointsStyle ) {\n\t\tthis.set( undefined, undefined, style );\n\t}\n\n\tget size(): EShapeLineOfAnyPointsPoint {\n\t\treturn this._size;\n\t}\n\n\tget offset(): EShapeLineOfAnyPointsPoint {\n\t\treturn this._offset;\n\t}\n\n\tget fill(): EShapeLineOfAnyPointsFill {\n\t\treturn this._fill;\n\t}\n\n\tget stroke(): EShapeLineOfAnyPointsStroke {\n\t\treturn this._stroke;\n\t}\n\n\tcopy( source: EShapePoints ): this {\n\t\treturn this.set( source.values, source.segments, source.style );\n\t}\n\n\tset( newValues?: number[], newSegments?: number[], newStyle?: EShapePointsStyle ): this {\n\t\tlet isDirty = false;\n\t\tlet isUpdated = false;\n\n\t\t// Values\n\t\tif( newValues != null ) {\n\t\t\tconst values = this._values;\n\t\t\tconst valuesLength = this._valuesLength;\n\t\t\tconst newValuesLength = newValues.length;\n\t\t\tif( values !== newValues ) {\n\t\t\t\tconst iupdate = Math.min( valuesLength, newValuesLength );\n\n\t\t\t\tfor( let i = 0; i < iupdate; ++i ) {\n\t\t\t\t\tvalues[ i ] = newValues[ i ];\n\t\t\t\t}\n\n\t\t\t\tfor( let i = iupdate; i < newValuesLength; ++i ) {\n\t\t\t\t\tvalues.push( newValues[ i ] );\n\t\t\t\t}\n\n\t\t\t\tif( valuesLength !== newValuesLength ) {\n\t\t\t\t\tvalues.length = newValuesLength;\n\t\t\t\t\tthis._valuesLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( valuesLength !== newValuesLength ) {\n\t\t\t\t\tthis._valuesLength = newValuesLength;\n\t\t\t\t\tisDirty = true;\n\t\t\t\t} else {\n\t\t\t\t\tisUpdated = true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tif( isDirty ) {\n\t\t\tthis._id += 1;\n\t\t\tconst parent = this._parent;\n\t\t\tconst uploaded = parent.uploaded;\n\t\t\tif( uploaded ) {\n\t\t\t\tif( uploaded.isCompatible( parent ) ) {\n\t\t\t\t\tparent.updateUploaded();\n\t\t\t\t} else {\n\t\t\t\t\tparent.uploaded = undefined;\n\t\t\t\t\tparent.toDirty();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tparent.updateUploaded();\n\t\t\t}\n\t\t} else if( isUpdated ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.updateUploaded();\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tupdateUploaded(): void {\n\t\tthis._parent.updateUploaded();\n\t}\n\n\tclone( parent: EShape ): EShapeLineOfAnyPointsImpl {\n\t\treturn new EShapeLineOfAnyPointsImpl( parent );\n\t}\n\n\ttoPoints( transform: Matrix ): Point[] {\n\t\tconst result: Point[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tconst point = new Point( values[ i + 0 ], values[ i + 1 ] );\n\t\t\tresult.push( transform.apply( point, point ) );\n\t\t}\n\t\treturn result;\n\t}\n\n\tserialize( manager: EShapeResourceManagerSerialization ): number {\n\t\treturn manager.addResource( `[]` );\n\t}\n\n\tcalcHitPointAbs<RESULT>(\n\t\tx: number, y: number,\n\t\tthreshold: number,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT>,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst pointCount = this.length;\n\t\tconst pointValues = this._values;\n\t\tconst size = this._size;\n\t\tconst offset = this._offset;\n\t\tlet istart = 0;\n\t\tlet iend = pointCount;\n\t\tif( range ) {\n\t\t\tconst s = size.getLimit() * 0.5;\n\t\t\tconst o = offset.getLimit();\n\t\t\tconst rangeResult = range( x, y, s, s, o, o, threshold, pointValues, EShapeLineOfAnyPointsImpl.WORK_RANGE );\n\t\t\tistart = rangeResult[ 0 ];\n\t\t\tiend = rangeResult[ 1 ];\n\t\t}\n\t\ttester = tester;\n\t\tfor( let i = istart, imax = Math.min( iend, pointCount ), iv = istart << 1; i < imax; i += 1, iv += 2 ) {\n\t\t\tconst px = pointValues[ iv     ];\n\t\t\tconst py = pointValues[ iv + 1 ];\n\t\t\tconst sx = size.getX( i ) * 0.5;\n\t\t\tconst sy = size.getY( i ) * 0.5;\n\t\t\tconst ox = offset.getX( i );\n\t\t\tconst oy = offset.getY( i );\n\t\t\tif( tester( x, y, sx, sy, ox, oy, px, py, i, threshold, result ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { buildLineOfAnyColor, toLineOfAnyPointCount } from \"./build-line-of-any\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport abstract class EShapeLineOfAnyUploaded extends EShapeTextUploaded {\n\tprotected pointId: number;\n\tprotected pointCount: number;\n\tprotected pointCountReserved: number;\n\tprotected pointSizeId: number;\n\tprotected pointOffsetId: number;\n\tprotected pointFillId: number;\n\tprotected pointStrokeId: number;\n\n\tconstructor(\n\t\tbuffer: EShapeBuffer,\n\t\tvoffset: number, ioffset: number,\n\t\ttvcount: number, ticount: number,\n\t\tvcount: number, icount: number,\n\t\tantialiasWeight: number,\n\t\tpointCountReserved: number\n\t) {\n\t\tsuper( buffer, voffset, ioffset, tvcount, ticount, vcount, icount, antialiasWeight );\n\t\tthis.pointId = -1;\n\t\tthis.pointCount = 0;\n\t\tthis.pointCountReserved = pointCountReserved;\n\t\tthis.pointSizeId = -1;\n\t\tthis.pointOffsetId = -1;\n\t\tthis.pointFillId = -1;\n\t\tthis.pointStrokeId = -1;\n\t}\n\n\tisCompatible( shape: EShape ): boolean {\n\t\tif( super.isCompatible( shape ) ) {\n\t\t\tconst points = shape.points;\n\t\t\tconst pointCount = toLineOfAnyPointCount( points ? points.length : 0 );\n\t\t\treturn pointCount === this.pointCountReserved;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateLineOfAnyColorFill(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints, vcountPerPoint: number\n\t): void {\n\t\tconst pointFill = points.fill;\n\t\tconst pointFillId = pointFill.id;\n\t\tconst isPointFillChanged = ( pointFillId !== this.pointFillId );\n\n\t\tconst fill = shape.fill;\n\t\tconst isFillEnabled = shape.visible && fill.enable;\n\t\tconst colorFill = fill.color;\n\t\tconst alphaFill = (isFillEnabled ? fill.alpha : 0);\n\t\tconst isFillChanged = ( colorFill !== this.colorFill || alphaFill !== this.alphaFill );\n\n\t\tif( isPointFillChanged || isFillChanged ) {\n\t\t\tthis.colorFill = colorFill;\n\t\t\tthis.alphaFill = alphaFill;\n\t\t\tthis.pointFillId = pointFillId;\n\t\t\tbuffer.updateColorFills();\n\t\t\tbuildLineOfAnyColor(\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvcountPerPoint,\n\t\t\t\tpointFill,\n\t\t\t\tthis.pointCountReserved,\n\t\t\t\tbuffer.colorFills,\n\t\t\t\tisFillEnabled,\n\t\t\t\tcolorFill,\n\t\t\t\talphaFill\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateLineOfAnyColorStroke(\n\t\tbuffer: EShapeBuffer, shape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints, vcountPerPoint: number\n\t): void {\n\t\tconst pointStroke = points.stroke;\n\t\tconst pointStrokeId = pointStroke.id;\n\t\tconst isPointStrokeChanged = ( pointStrokeId !== this.pointStrokeId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst isStrokeEnabled = shape.visible && stroke.enable;\n\t\tconst colorStroke = stroke.color;\n\t\tconst alphaStroke = (isStrokeEnabled ? stroke.alpha : 0);\n\t\tconst isStrokeChanged = ( colorStroke !== this.colorStroke || alphaStroke !== this.alphaStroke );\n\n\t\tif( isPointStrokeChanged || isStrokeChanged ) {\n\t\t\tthis.colorStroke = colorStroke;\n\t\t\tthis.alphaStroke = alphaStroke;\n\t\t\tthis.pointStrokeId = pointStrokeId;\n\t\t\tbuffer.updateColorStrokes();\n\t\t\tbuildLineOfAnyColor(\n\t\t\t\tthis.vertexOffset,\n\t\t\t\tvcountPerPoint,\n\t\t\t\tpointStroke,\n\t\t\t\tthis.pointCountReserved,\n\t\t\t\tbuffer.colorStrokes,\n\t\t\t\tisStrokeEnabled,\n\t\t\t\tcolorStroke,\n\t\t\t\talphaStroke\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildCircleClipping, buildCircleIndex, buildCircleStep, buildCircleUv,\n\tbuildCircleVertex, CIRCLE_INDEX_COUNT, CIRCLE_VERTEX_COUNT, CIRCLE_WORLD_SIZE\n} from \"./build-circle\";\nimport { buildNullStep, buildNullVertex } from \"./build-null\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfCirclesUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Clippings & indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateClippings();\n\t\tbuffer.updateIndices();\n\t\tconst clippings = buffer.clippings;\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCountReserved = this.pointCountReserved;\n\t\tif( 0 < pointCountReserved ) {\n\t\t\tbuildCircleClipping(\n\t\t\t\tclippings,\n\t\t\t\tvoffset\n\t\t\t);\n\t\t\tcopyClipping(\n\t\t\t\tclippings,\n\t\t\t\tvoffset,\n\t\t\t\tCIRCLE_VERTEX_COUNT,\n\t\t\t\tpointCountReserved\n\t\t\t);\n\t\t\tbuildCircleIndex(\n\t\t\t\tindices,\n\t\t\t\tvoffset,\n\t\t\t\tioffset\n\t\t\t);\n\t\t\tcopyIndex(\n\t\t\t\tindices,\n\t\t\t\tCIRCLE_VERTEX_COUNT,\n\t\t\t\tioffset,\n\t\t\t\tCIRCLE_INDEX_COUNT,\n\t\t\t\tpointCountReserved\n\t\t\t);\n\t\t}\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPointsImpl ) {\n\t\t\tthis.updateVertexAndStep( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, CIRCLE_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, CIRCLE_VERTEX_COUNT );\n\t\t\tthis.updateUv( buffer, shape );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexAndStep( buffer: EShapeBuffer, shape: EShape, points: EShapeLineOfAnyPoints ): void {\n\t\tconst pointId = points.id;\n\t\tconst pointOffset = points.offset;\n\t\tconst pointOffsetId = pointOffset.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId || pointOffsetId !== this.pointOffsetId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tif( isPointChanged || isPointSizeChanged || isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointCount = points.length;\n\t\t\tthis.pointOffsetId = pointOffsetId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.updateVertices();\n\t\t\tbuffer.updateSteps();\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tif( 0 < pointCount && pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\tbuildCircleVertex(\n\t\t\t\t\tvertices, voffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tCIRCLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, CIRCLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues,\n\t\t\t\t\tpointOffset\n\t\t\t\t);\n\t\t\t\tbuildCircleStep(\n\t\t\t\t\tsteps, clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tantialiasWeight,\n\t\t\t\t\tCIRCLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t\tcopyStep(\n\t\t\t\t\tsteps,\n\t\t\t\t\tvoffset, CIRCLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ] + pointOffset.getX( i );\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ] + pointOffset.getY( i );\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\t\t\t\t\tconst iv = voffset + i * CIRCLE_VERTEX_COUNT;\n\t\t\t\t\tbuildCircleVertex(\n\t\t\t\t\t\tvertices, iv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tCIRCLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tbuildCircleStep(\n\t\t\t\t\t\tsteps, clippings,\n\t\t\t\t\t\tiv,\n\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tCIRCLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fill the rest\n\t\t\tconst pointCountReserved = this.pointCountReserved;\n\t\t\tconst voffsetReserved = voffset + pointCount * CIRCLE_VERTEX_COUNT;\n\t\t\tconst vcountReserved = CIRCLE_VERTEX_COUNT * (pointCountReserved - pointCount);\n\t\t\tbuildNullVertex(\n\t\t\t\tvertices,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullStep(\n\t\t\t\tsteps,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tif( texture !== this.texture || textureTransformId !== this.textureTransformId ) {\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tbuffer.updateUvs();\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tconst pointCountReserved = this.pointCountReserved;\n\t\t\tif( 0 < pointCountReserved ) {\n\t\t\t\tbuildCircleUv(\n\t\t\t\t\tuvs,\n\t\t\t\t\tvoffset,\n\t\t\t\t\ttextureUvs\n\t\t\t\t);\n\t\t\t\tcopyUvs(\n\t\t\t\t\tuvs,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tCIRCLE_VERTEX_COUNT,\n\t\t\t\t\tpointCountReserved\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { CIRCLE_INDEX_COUNT, CIRCLE_VERTEX_COUNT } from \"./build-circle\";\nimport { createLineOfAnyUploaded } from \"./create-line-of-any-uploaded\";\nimport { EShapeLineOfCirclesUploaded } from \"./e-shape-line-of-circles-uploaded\";\n\nexport const createLineOfCirclesUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeLineOfCirclesUploaded | null => {\n\treturn createLineOfAnyUploaded(\n\t\tbuffer, shape,\n\t\tvoffset, CIRCLE_VERTEX_COUNT,\n\t\tioffset, CIRCLE_INDEX_COUNT,\n\t\tantialiasWeight,\n\t\tEShapeLineOfCirclesUploaded\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeStroke } from \"../e-shape-stroke\";\nimport { EShapeLineOfAnyPoints, EShapeLineOfAnyPointsToHitThreshold } from \"./e-shape-line-of-any-points\";\n\nexport const toHitThreshold = (\n\ttarget: { readonly stroke: EShapeStroke, readonly points: EShapeLineOfAnyPoints; },\n\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null\n): number => {\n\tconst stroke = target.stroke;\n\tconst size = target.points.size.getLimit() + ( stroke.enable ? stroke.width * stroke.align : 0 );\n\treturn ( toThreshold ?\n\t\ttoThreshold( size, 1 ) :\n\t\tsize * 0.5\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeCircle } from \"./e-shape-circle\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfCircles extends EShapeCircle implements EShapeLineOfAny {\n\tprotected declare _points: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfCircles ) {\n\t\tsuper( EShapeType.LINE_OF_CIRCLES );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis._points = new EShapeLineOfAnyPointsImpl( this );\n\t\t}\n\n\t\tthis._tester = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\t}\n\n\tget points(): EShapeLineOfAnyPoints {\n\t\treturn this._points;\n\t}\n\n\tclone(): EShapeLineOfCircles {\n\t\treturn new EShapeLineOfCircles( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbs( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbsBBox( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfCircles } from \"./e-shape-line-of-circles\";\n\nexport const deserializeLineOfCircles = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeLineOfCircles> | EShapeLineOfCircles => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfCircles() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createLineOfCirclesUploaded } from \"../variant/create-line-of-circles-uploaded\";\nimport { deserializeLineOfCircles } from \"../variant/deserialize-line-of-circles\";\n\nexport const loadShapeLineOfCircles = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_CIRCLES ] = createLineOfCirclesUploaded;\n\tEShapeDeserializers[ EShapeType.LINE_OF_CIRCLES ] = deserializeLineOfCircles;\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { toLength } from \"./to-length\";\nimport { STEP_VALUES, toStep } from \"./to-step\";\n\nexport const RECTANGLE_ROUNDED_VERTEX_COUNT = 36;\nexport const RECTANGLE_ROUNDED_INDEX_COUNT = 24;\nexport const RECTANGLE_ROUNDED_WORLD_SIZE: [ number, number, number ] = [ 0, 0, 0 ];\nconst RECTANGLE_ROUNDED_WORK_POINT: Point = new Point();\n\nexport const buildRectangleRoundedIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\t// Top-left corner\n\tlet ii = ioffset * 3;\n\tindices[ ii + 0 ] = voffset + 0;\n\tindices[ ii + 1 ] = voffset + 1;\n\tindices[ ii + 2 ] = voffset + 2;\n\tindices[ ii + 3 ] = voffset + 1;\n\tindices[ ii + 4 ] = voffset + 3;\n\tindices[ ii + 5 ] = voffset + 2;\n\tii += 6;\n\n\t// Top-right corner\n\tindices[ ii + 0 ] = voffset + 4;\n\tindices[ ii + 1 ] = voffset + 5;\n\tindices[ ii + 2 ] = voffset + 6;\n\tindices[ ii + 3 ] = voffset + 5;\n\tindices[ ii + 4 ] = voffset + 7;\n\tindices[ ii + 5 ] = voffset + 6;\n\tii += 6;\n\n\t// Bottom-left corner\n\tindices[ ii + 0 ] = voffset + 8;\n\tindices[ ii + 1 ] = voffset + 9;\n\tindices[ ii + 2 ] = voffset + 10;\n\tindices[ ii + 3 ] = voffset + 9;\n\tindices[ ii + 4 ] = voffset + 11;\n\tindices[ ii + 5 ] = voffset + 10;\n\tii += 6;\n\n\t// Bottom-right corner\n\tindices[ ii + 0 ] = voffset + 12;\n\tindices[ ii + 1 ] = voffset + 13;\n\tindices[ ii + 2 ] = voffset + 14;\n\tindices[ ii + 3 ] = voffset + 13;\n\tindices[ ii + 4 ] = voffset + 15;\n\tindices[ ii + 5 ] = voffset + 14;\n\tii += 6;\n\n\t// Top edge\n\tindices[ ii + 0 ] = voffset + 16;\n\tindices[ ii + 1 ] = voffset + 17;\n\tindices[ ii + 2 ] = voffset + 20;\n\tindices[ ii + 3 ] = voffset + 17;\n\tindices[ ii + 4 ] = voffset + 21;\n\tindices[ ii + 5 ] = voffset + 20;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 17;\n\tindices[ ii + 1 ] = voffset + 18;\n\tindices[ ii + 2 ] = voffset + 21;\n\tindices[ ii + 3 ] = voffset + 18;\n\tindices[ ii + 4 ] = voffset + 22;\n\tindices[ ii + 5 ] = voffset + 21;\n\tii += 6;\n\n\t// Upper middle\n\tindices[ ii + 0 ] = voffset + 19;\n\tindices[ ii + 1 ] = voffset + 21;\n\tindices[ ii + 2 ] = voffset + 24;\n\tindices[ ii + 3 ] = voffset + 21;\n\tindices[ ii + 4 ] = voffset + 25;\n\tindices[ ii + 5 ] = voffset + 24;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 21;\n\tindices[ ii + 1 ] = voffset + 23;\n\tindices[ ii + 2 ] = voffset + 26;\n\tindices[ ii + 3 ] = voffset + 23;\n\tindices[ ii + 4 ] = voffset + 27;\n\tindices[ ii + 5 ] = voffset + 26;\n\tii += 6;\n\n\t// Lower middle\n\tindices[ ii + 0 ] = voffset + 24;\n\tindices[ ii + 1 ] = voffset + 25;\n\tindices[ ii + 2 ] = voffset + 28;\n\tindices[ ii + 3 ] = voffset + 25;\n\tindices[ ii + 4 ] = voffset + 30;\n\tindices[ ii + 5 ] = voffset + 28;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 26;\n\tindices[ ii + 1 ] = voffset + 27;\n\tindices[ ii + 2 ] = voffset + 30;\n\tindices[ ii + 3 ] = voffset + 27;\n\tindices[ ii + 4 ] = voffset + 32;\n\tindices[ ii + 5 ] = voffset + 30;\n\tii += 6;\n\n\t// Bottom edge\n\tindices[ ii + 0 ] = voffset + 29;\n\tindices[ ii + 1 ] = voffset + 30;\n\tindices[ ii + 2 ] = voffset + 33;\n\tindices[ ii + 3 ] = voffset + 30;\n\tindices[ ii + 4 ] = voffset + 34;\n\tindices[ ii + 5 ] = voffset + 33;\n\tii += 6;\n\n\tindices[ ii + 0 ] = voffset + 30;\n\tindices[ ii + 1 ] = voffset + 31;\n\tindices[ ii + 2 ] = voffset + 34;\n\tindices[ ii + 3 ] = voffset + 31;\n\tindices[ ii + 4 ] = voffset + 35;\n\tindices[ ii + 5 ] = voffset + 34;\n};\n\nexport const buildRectangleRoundedVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tradius: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number, number ]\n): void => {\n\t// Calculate the transformed positions\n\t//\n\t//  0   1       4   5\n\t// |---|       |---|\n\t// |2  |3      |6  |7\n\t// |---|       |---|\n\t//\n\t//\n\t//\n\t//\n\t//\n\t// |---|       |---|\n\t// |8  |9      |12 |13\n\t// |---|       |---|\n\t//  10  11      14  15\n\t//\n\t//\n\t//      16  17  18       <-- Top edge\n\t//     |---|---|\n\t//  19 |20 |21 |22  23   <-- Top\n\t// |---|---|---|---|\n\t// |       |       |\n\t// |24   25|26     |27   <-- Middle\n\t// |-------|-------|\n\t// |       |       |\n\t// |       |       |\n\t// |---|---|---|---|\n\t//  28 |29 |30 |31  32   <-- Bottom\n\t//     |---|---|\n\t//      33  34  35       <-- Bottom edge\n\t//\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\tconst ax = Math.abs( sx );\n\tconst ay = Math.abs( sy );\n\tconst a = radius * Math.min( ax, ay );\n\tconst rx = a / ax;\n\tconst ry = a / ay;\n\n\tconst work = RECTANGLE_ROUNDED_WORK_POINT;\n\twork.set( originX - sx, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( originX, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x2 = work.x;\n\tconst y2 = work.y;\n\tconst dxh = x2 - x0;\n\tconst dyh = y2 - y0;\n\tconst dxhr = rx * dxh;\n\tconst dyhr = rx * dyh;\n\tconst x1 = x0 + dxhr;\n\tconst y1 = y0 + dyhr;\n\tconst x4 = x2 + dxh;\n\tconst y4 = y2 + dyh;\n\tconst x3 = x4 - dxhr;\n\tconst y3 = y4 - dyhr;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst x11 = work.x;\n\tconst y11 = work.y;\n\tconst dxv = x11 - x2;\n\tconst dyv = y11 - y2;\n\tconst dxvr = ry * dxv;\n\tconst dyvr = ry * dyv;\n\tconst x7 = x2 + dxvr;\n\tconst y7 = y2 + dyvr;\n\tconst x5 = x7 - dxh;\n\tconst y5 = y7 - dyh;\n\tconst x6 = x5 + dxhr;\n\tconst y6 = y5 + dyhr;\n\tconst x9 = x7 + dxh;\n\tconst y9 = y7 + dyh;\n\tconst x8 = x9 - dxhr;\n\tconst y8 = y9 - dyhr;\n\tconst x10 = x11 - dxh;\n\tconst y10 = y11 - dyh;\n\tconst x12 = x11 + dxh;\n\tconst y12 = y11 + dyh;\n\tconst x20 = x11 + dxv;\n\tconst y20 = y11 + dyv;\n\tconst x15 = x20 - dxvr;\n\tconst y15 = y20 - dyvr;\n\tconst x13 = x15 - dxh;\n\tconst y13 = y15 - dyh;\n\tconst x14 = x13 + dxhr;\n\tconst y14 = y13 + dyhr;\n\tconst x17 = x15 + dxh;\n\tconst y17 = y15 + dyh;\n\tconst x16 = x17 - dxhr;\n\tconst y16 = y17 - dyhr;\n\tconst x18 = x20 - dxh;\n\tconst y18 = y20 - dyh;\n\tconst x19 = x18 + dxhr;\n\tconst y19 = y18 + dyhr;\n\tconst x22 = x20 + dxh;\n\tconst y22 = y20 + dyh;\n\tconst x21 = x22 - dxhr;\n\tconst y21 = y22 - dyhr;\n\n\t// World size\n\tworldSize[ 0 ] = toLength( x0, y0, x1, y1 );\n\tworldSize[ 1 ] = toLength( x0, y0, x2, y2 );\n\tworldSize[ 2 ] = toLength( x0, y0, x10, y10 );\n\n\t// Vertices\n\tlet iv = voffset * 2;\n\n\t// Top-left corner\n\tvertices[ iv + 0 ] = x0;\n\tvertices[ iv + 1 ] = y0;\n\tvertices[ iv + 2 ] = x1;\n\tvertices[ iv + 3 ] = y1;\n\tvertices[ iv + 4 ] = x5;\n\tvertices[ iv + 5 ] = y5;\n\tvertices[ iv + 6 ] = x6;\n\tvertices[ iv + 7 ] = y6;\n\tiv += 8;\n\n\t// Top-right corner\n\tvertices[ iv + 0 ] = x3;\n\tvertices[ iv + 1 ] = y3;\n\tvertices[ iv + 2 ] = x4;\n\tvertices[ iv + 3 ] = y4;\n\tvertices[ iv + 4 ] = x8;\n\tvertices[ iv + 5 ] = y8;\n\tvertices[ iv + 6 ] = x9;\n\tvertices[ iv + 7 ] = y9;\n\tiv += 8;\n\n\t// Bottom-left corner\n\tvertices[ iv + 0 ] = x13;\n\tvertices[ iv + 1 ] = y13;\n\tvertices[ iv + 2 ] = x14;\n\tvertices[ iv + 3 ] = y14;\n\tvertices[ iv + 4 ] = x18;\n\tvertices[ iv + 5 ] = y18;\n\tvertices[ iv + 6 ] = x19;\n\tvertices[ iv + 7 ] = y19;\n\tiv += 8;\n\n\t// Bottom-right corner\n\tvertices[ iv + 0 ] = x16;\n\tvertices[ iv + 1 ] = y16;\n\tvertices[ iv + 2 ] = x17;\n\tvertices[ iv + 3 ] = y17;\n\tvertices[ iv + 4 ] = x21;\n\tvertices[ iv + 5 ] = y21;\n\tvertices[ iv + 6 ] = x22;\n\tvertices[ iv + 7 ] = y22;\n\tiv += 8;\n\n\t// Top edge\n\tvertices[ iv + 0 ] = x1;\n\tvertices[ iv + 1 ] = y1;\n\tvertices[ iv + 2 ] = x2;\n\tvertices[ iv + 3 ] = y2;\n\tvertices[ iv + 4 ] = x3;\n\tvertices[ iv + 5 ] = y3;\n\tiv += 6;\n\n\t// Top\n\tvertices[ iv + 0 ] = x5;\n\tvertices[ iv + 1 ] = y5;\n\tvertices[ iv + 2 ] = x6;\n\tvertices[ iv + 3 ] = y6;\n\tvertices[ iv + 4 ] = x7;\n\tvertices[ iv + 5 ] = y7;\n\tvertices[ iv + 6 ] = x8;\n\tvertices[ iv + 7 ] = y8;\n\tvertices[ iv + 8 ] = x9;\n\tvertices[ iv + 9 ] = y9;\n\tiv += 10;\n\n\t// Middle\n\tvertices[ iv + 0 ] = x10;\n\tvertices[ iv + 1 ] = y10;\n\tvertices[ iv + 2 ] = x11;\n\tvertices[ iv + 3 ] = y11;\n\tvertices[ iv + 4 ] = x11;\n\tvertices[ iv + 5 ] = y11;\n\tvertices[ iv + 6 ] = x12;\n\tvertices[ iv + 7 ] = y12;\n\tiv += 8;\n\n\t// Bottom\n\tvertices[ iv + 0 ] = x13;\n\tvertices[ iv + 1 ] = y13;\n\tvertices[ iv + 2 ] = x14;\n\tvertices[ iv + 3 ] = y14;\n\tvertices[ iv + 4 ] = x15;\n\tvertices[ iv + 5 ] = y15;\n\tvertices[ iv + 6 ] = x16;\n\tvertices[ iv + 7 ] = y16;\n\tvertices[ iv + 8 ] = x17;\n\tvertices[ iv + 9 ] = y17;\n\tiv += 10;\n\n\t// Bottom edge\n\tvertices[ iv + 0 ] = x19;\n\tvertices[ iv + 1 ] = y19;\n\tvertices[ iv + 2 ] = x20;\n\tvertices[ iv + 3 ] = y20;\n\tvertices[ iv + 4 ] = x21;\n\tvertices[ iv + 5 ] = y21;\n};\n\nexport const buildRectangleRoundedClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tcorner: EShapeCorner,\n\tworldSize: [ number, number, number ]\n): void => {\n\tlet ic = voffset * 3;\n\tconst rxc = 1 - worldSize[ 0 ] / worldSize[ 1 ];\n\tconst ryc = 1 - worldSize[ 0 ] / worldSize[ 2 ];\n\n\t// Top-left corner\n\tif( corner & EShapeCorner.TOP_LEFT ) {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Top-right corner\n\tif( corner & EShapeCorner.TOP_RIGHT ) {\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Bottom-left corner\n\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Bottom-right corner\n\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 0;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 0;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 1;\n\t\tic += 3;\n\t} else {\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = ryc;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = rxc;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\n\t\tclippings[ ic + 0 ] = 1;\n\t\tclippings[ ic + 1 ] = 1;\n\t\tclippings[ ic + 2 ] = 0;\n\t\tic += 3;\n\t}\n\n\t// Top edge\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Top\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Middle\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = 0;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Bottom\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 1;\n\tclippings[ ic + 1 ] = ryc;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\t// Bottom edge\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = 0;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n\n\tclippings[ ic + 0 ] = rxc;\n\tclippings[ ic + 1 ] = 1;\n\tclippings[ ic + 2 ] = 0;\n\tic += 3;\n};\n\nexport const buildRectangleRoundedStep = (\n\tsteps: Float32Array,\n\tvoffset: number,\n\tstrokeWidth: number,\n\tstrokeSide: EShapeStrokeSide,\n\tcorner: EShapeCorner,\n\tantialiasWeight: number,\n\tworldSize: [ number, number, number ]\n): void => {\n\ttoStep( worldSize[ 0 ], strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swc = STEP_VALUES[ 0 ];\n\tconst pc0 = STEP_VALUES[ 1 ];\n\tconst pc1 = STEP_VALUES[ 2 ];\n\n\ttoStep( worldSize[ 1 ], strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swx = STEP_VALUES[ 0 ];\n\tconst px0 = STEP_VALUES[ 1 ];\n\tconst px1 = STEP_VALUES[ 2 ];\n\n\ttoStep( worldSize[ 2 ], strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swy = STEP_VALUES[ 0 ];\n\tconst py0 = STEP_VALUES[ 1 ];\n\tconst py1 = STEP_VALUES[ 2 ];\n\n\tconst rxc = 1 - worldSize[ 0 ] / worldSize[ 1 ];\n\tconst ryc = 1 - worldSize[ 0 ] / worldSize[ 2 ];\n\n\tlet swt = swy;\n\tlet pt0 = py0;\n\tlet swtc = swc;\n\tlet ptc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.TOP) ) {\n\t\tswt = 1;\n\t\tpt0 = py1;\n\t\tswtc = 1;\n\t\tptc0 = pc1;\n\t}\n\tlet swr = swx;\n\tlet pr0 = px0;\n\tlet swrc = swc;\n\tlet prc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.RIGHT) ) {\n\t\tswr = 1;\n\t\tpr0 = px1;\n\t\tswrc = 1;\n\t\tprc0 = pc1;\n\t}\n\tlet swb = swy;\n\tlet pb0 = py0;\n\tlet swbc = swc;\n\tlet pbc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.BOTTOM) ) {\n\t\tswb = 1;\n\t\tpb0 = py1;\n\t\tswbc = 1;\n\t\tpbc0 = pc1;\n\t}\n\tlet swl = swx;\n\tlet pl0 = px0;\n\tlet swlc = swc;\n\tlet plc0 = pc0;\n\tif( ! (strokeSide & EShapeStrokeSide.LEFT) ) {\n\t\tswl = 1;\n\t\tpl0 = px1;\n\t\tswlc = 1;\n\t\tplc0 = pc1;\n\t}\n\tconst plr0 = 0.5 * (pl0 + pr0);\n\tconst ptb0 = 0.5 * (pt0 + pb0);\n\n\t// Top-left corner\n\tlet is = voffset * 6;\n\tif( corner & EShapeCorner.TOP_LEFT ) {\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\t} else {\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swt;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swt;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\t}\n\n\t// Top-right corner\n\tif( corner & EShapeCorner.TOP_RIGHT ) {\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = swtc;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = ptc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\t} else {\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swt;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swt;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swt * ryc;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pt0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\t}\n\n\t// Bottom-left corner\n\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swlc;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tsteps[ is + 2 ] = plc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\t} else {\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swl;\n\t\tsteps[ is + 1 ] = swb;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swl * rxc;\n\t\tsteps[ is + 1 ] = swb;\n\t\tsteps[ is + 2 ] = pl0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\t}\n\n\t// Bottom-right corner\n\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = 0;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = 0;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swrc;\n\t\tsteps[ is + 1 ] = swbc;\n\t\tsteps[ is + 2 ] = prc0;\n\t\tsteps[ is + 3 ] = pbc0;\n\t\tsteps[ is + 4 ] = pc1;\n\t\tsteps[ is + 5 ] = pc1;\n\t\tis += 6;\n\t} else {\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swb * ryc;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swr * rxc;\n\t\tsteps[ is + 1 ] = swb;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\n\t\tsteps[ is + 0 ] = swr;\n\t\tsteps[ is + 1 ] = swb;\n\t\tsteps[ is + 2 ] = pr0;\n\t\tsteps[ is + 3 ] = pb0;\n\t\tsteps[ is + 4 ] = px1;\n\t\tsteps[ is + 5 ] = py1;\n\t\tis += 6;\n\t}\n\n\t// Top edge\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = plr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swt;\n\tsteps[ is + 2 ] = plr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// Top\n\tsteps[ is + 0 ] = swl;\n\tsteps[ is + 1 ] = swt * ryc;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swt * ryc;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swt * ryc;\n\tsteps[ is + 2 ] = plr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swt * ryc;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swr;\n\tsteps[ is + 1 ] = swt * ryc;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pt0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// Middle\n\tsteps[ is + 0 ] = swl;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = ptb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = ptb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = ptb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swr;\n\tsteps[ is + 1 ] = 0;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = ptb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// Bottom\n\tsteps[ is + 0 ] = swl;\n\tsteps[ is + 1 ] = swb * ryc;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swb * ryc;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swb * ryc;\n\tsteps[ is + 2 ] = plr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swb * ryc;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swr;\n\tsteps[ is + 1 ] = swb * ryc;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\t// Bottom edge\n\tsteps[ is + 0 ] = swl * rxc;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pl0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = 0;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = plr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n\n\tsteps[ is + 0 ] = swr * rxc;\n\tsteps[ is + 1 ] = swb;\n\tsteps[ is + 2 ] = pr0;\n\tsteps[ is + 3 ] = pb0;\n\tsteps[ is + 4 ] = px1;\n\tsteps[ is + 5 ] = py1;\n\tis += 6;\n};\n\nexport const buildRectangleRoundedUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\tconst x4 = 0.5 * (x0 + x1);\n\tconst y4 = 0.5 * (y0 + y1);\n\tconst x5 = 0.5 * (x3 + x2);\n\tconst y5 = 0.5 * (y3 + y2);\n\n\tconst ruvx = 0.5 * worldSize[ 0 ] / worldSize[ 1 ];\n\tconst ruvy = 0.5 * worldSize[ 0 ] / worldSize[ 2 ];\n\tconst d0x = ruvx * (x1 - x0);\n\tconst d0y = ruvx * (y1 - y0);\n\tconst d1x = ruvy * (x3 - x0);\n\tconst d1y = ruvy * (y3 - y0);\n\n\t// UVs\n\tlet iuv = voffset * 2;\n\n\t// Top-left corner\n\tuvs[ iuv + 0 ] = x0;\n\tuvs[ iuv + 1 ] = y0;\n\tuvs[ iuv + 2 ] = x0 + d0x;\n\tuvs[ iuv + 3 ] = y0 + d0y;\n\tuvs[ iuv + 4 ] = x0 + d1x;\n\tuvs[ iuv + 5 ] = y0 + d1y;\n\tuvs[ iuv + 6 ] = x0 + d0x + d1x;\n\tuvs[ iuv + 7 ] = y0 + d0y + d1y;\n\tiuv += 8;\n\n\t// Top-right corner\n\tuvs[ iuv + 0 ] = x1 - d0x;\n\tuvs[ iuv + 1 ] = y1 - d0y;\n\tuvs[ iuv + 2 ] = x1;\n\tuvs[ iuv + 3 ] = y1;\n\tuvs[ iuv + 4 ] = x1 - d0x + d1x;\n\tuvs[ iuv + 5 ] = y1 - d0y + d1y;\n\tuvs[ iuv + 6 ] = x1 + d1x;\n\tuvs[ iuv + 7 ] = y1 + d1y;\n\tiuv += 8;\n\n\t// Bottom-left corner\n\tuvs[ iuv + 0 ] = x3 - d1x;\n\tuvs[ iuv + 1 ] = y3 - d1y;\n\tuvs[ iuv + 2 ] = x3 + d0x - d1x;\n\tuvs[ iuv + 3 ] = y3 + d0y - d1y;\n\tuvs[ iuv + 4 ] = x3;\n\tuvs[ iuv + 5 ] = y3;\n\tuvs[ iuv + 6 ] = x3 + d0x;\n\tuvs[ iuv + 7 ] = y3 + d0y;\n\tiuv += 8;\n\n\t// Bottom-right corner\n\tuvs[ iuv + 0 ] = x2 - d0x - d1x;\n\tuvs[ iuv + 1 ] = y2 - d0y - d1y;\n\tuvs[ iuv + 2 ] = x2 - d1x;\n\tuvs[ iuv + 3 ] = y2 - d1y;\n\tuvs[ iuv + 4 ] = x2 - d0x;\n\tuvs[ iuv + 5 ] = y2 - d0y;\n\tuvs[ iuv + 6 ] = x2;\n\tuvs[ iuv + 7 ] = y2;\n\tiuv += 8;\n\n\t// Top edge\n\tuvs[ iuv + 0 ] = x0 + d0x;\n\tuvs[ iuv + 1 ] = y0 + d0y;\n\tuvs[ iuv + 2 ] = x4;\n\tuvs[ iuv + 3 ] = y4;\n\tuvs[ iuv + 4 ] = x1 - d0x;\n\tuvs[ iuv + 5 ] = y1 - d0y;\n\tiuv += 6;\n\n\t// Top\n\tuvs[ iuv + 0 ] = x0 + d1x;\n\tuvs[ iuv + 1 ] = y0 + d1y;\n\tuvs[ iuv + 2 ] = x0 + d1x + d0x;\n\tuvs[ iuv + 3 ] = y0 + d1y + d0y;\n\tuvs[ iuv + 4 ] = x4 + d1x;\n\tuvs[ iuv + 5 ] = y4 + d1y;\n\tuvs[ iuv + 6 ] = x1 + d1x - d0x;\n\tuvs[ iuv + 7 ] = y1 + d1y - d0y;\n\tuvs[ iuv + 8 ] = x1 + d1x;\n\tuvs[ iuv + 9 ] = y1 + d1y;\n\tiuv += 10;\n\n\t// Middle\n\tconst x02 = 0.5 * (x0 + x2);\n\tconst y02 = 0.5 * (y0 + y2);\n\tuvs[ iuv + 0 ] = 0.5 * (x0 + x3);\n\tuvs[ iuv + 1 ] = 0.5 * (y0 + y3);\n\tuvs[ iuv + 2 ] = x02;\n\tuvs[ iuv + 3 ] = y02;\n\tuvs[ iuv + 4 ] = x02;\n\tuvs[ iuv + 5 ] = y02;\n\tuvs[ iuv + 6 ] = 0.5 * (x1 + x2);\n\tuvs[ iuv + 7 ] = 0.5 * (y1 + y2);\n\tiuv += 8;\n\n\t// Bottom\n\tuvs[ iuv + 0 ] = x3 - d1x;\n\tuvs[ iuv + 1 ] = y3 - d1y;\n\tuvs[ iuv + 2 ] = x3 - d1x + d0x;\n\tuvs[ iuv + 3 ] = y3 - d1y + d0y;\n\tuvs[ iuv + 4 ] = x5 - d1x;\n\tuvs[ iuv + 5 ] = y5 - d1y;\n\tuvs[ iuv + 6 ] = x2 - d1x - d0x;\n\tuvs[ iuv + 7 ] = y2 - d1y - d0y;\n\tuvs[ iuv + 8 ] = x2 - d1x;\n\tuvs[ iuv + 9 ] = y2 - d1y;\n\tiuv += 10;\n\n\t// Bottom edge\n\tuvs[ iuv + 0 ] = x3 + d0x;\n\tuvs[ iuv + 1 ] = y3 + d0y;\n\tuvs[ iuv + 2 ] = x5;\n\tuvs[ iuv + 3 ] = y5;\n\tuvs[ iuv + 4 ] = x2 - d0x;\n\tuvs[ iuv + 5 ] = y2 - d0y;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { buildNullClipping, buildNullStep, buildNullUv, buildNullVertex } from \"./build-null\";\nimport {\n\tbuildRectangleRoundedClipping, buildRectangleRoundedIndex, buildRectangleRoundedStep, buildRectangleRoundedUv,\n\tbuildRectangleRoundedVertex, RECTANGLE_ROUNDED_INDEX_COUNT, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\tRECTANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-rectangle-rounded\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfRectangleRoundedsUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateIndices();\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCountReserved = this.pointCountReserved;\n\t\tif( 0 < pointCountReserved ) {\n\t\t\tbuildRectangleRoundedIndex(\n\t\t\t\tindices,\n\t\t\t\tvoffset,\n\t\t\t\tioffset\n\t\t\t);\n\t\t\tcopyIndex(\n\t\t\t\tindices,\n\t\t\t\tRECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\tioffset,\n\t\t\t\tRECTANGLE_ROUNDED_INDEX_COUNT,\n\t\t\t\tpointCountReserved\n\t\t\t);\n\t\t}\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPointsImpl ) {\n\t\t\tthis.updateVertexClippingStepAndUv( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, RECTANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, RECTANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexClippingStepAndUv(\n\t\tbuffer: EShapeBuffer,\n\t\tshape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints\n\t): void {\n\t\tconst pointId = points.id;\n\t\tconst pointOffset = points.offset;\n\t\tconst pointOffsetId = pointOffset.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId || pointOffsetId !== this.pointOffsetId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst radius = shape.radius;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY || radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( corner !== this.corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointCount = points.length;\n\t\t\tthis.pointOffsetId = pointOffsetId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.updateVertices();\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t}\n\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\tbuffer.updateClippings();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t}\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tif( 0 < pointCount && pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\t// Vertices\n\t\t\t\tbuildRectangleRoundedVertex(\n\t\t\t\t\tvertices, voffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues,\n\t\t\t\t\tpointOffset\n\t\t\t\t);\n\n\t\t\t\t// Steps\n\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\tbuildRectangleRoundedStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\t\tcorner,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tvoffset, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Clippings\n\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\tbuildRectangleRoundedClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tcorner,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// UVs\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\tbuildRectangleRoundedUv(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyUvs(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ] + pointOffset.getX( i );\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ] + pointOffset.getY( i );\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\n\t\t\t\t\tconst iv = voffset + i * RECTANGLE_ROUNDED_VERTEX_COUNT;\n\n\t\t\t\t\t// Vertices\n\t\t\t\t\tbuildRectangleRoundedVertex(\n\t\t\t\t\t\tvertices, iv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\n\t\t\t\t\t// Steps\n\t\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\t\tbuildRectangleRoundedStep(\n\t\t\t\t\t\t\tsteps,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\t\t\tcorner,\n\t\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Clippings\n\t\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\t\tbuildRectangleRoundedClipping(\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tcorner,\n\t\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// UVs\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\t\tbuildRectangleRoundedUv(\n\t\t\t\t\t\t\tuvs,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fill the rest\n\t\t\tconst pointCountReserved = this.pointCountReserved;\n\t\t\tconst voffsetReserved = voffset + pointCount * RECTANGLE_ROUNDED_VERTEX_COUNT;\n\t\t\tconst vcountReserved = RECTANGLE_ROUNDED_VERTEX_COUNT * (pointCountReserved - pointCount);\n\t\t\tbuildNullVertex(\n\t\t\t\tvertices,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullStep(\n\t\t\t\tsteps,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullClipping(\n\t\t\t\tclippings,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullUv(\n\t\t\t\tuvs,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_ROUNDED_INDEX_COUNT, RECTANGLE_ROUNDED_VERTEX_COUNT } from \"./build-rectangle-rounded\";\nimport { createLineOfAnyUploaded } from \"./create-line-of-any-uploaded\";\nimport { EShapeLineOfRectangleRoundedsUploaded } from \"./e-shape-line-of-rectangle-roundeds-uploaded\";\n\nexport const createLineOfRectangleRoundedsUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeLineOfRectangleRoundedsUploaded | null => {\n\treturn createLineOfAnyUploaded(\n\t\tbuffer, shape,\n\t\tvoffset, RECTANGLE_ROUNDED_VERTEX_COUNT,\n\t\tioffset, RECTANGLE_ROUNDED_INDEX_COUNT,\n\t\tantialiasWeight,\n\t\tEShapeLineOfRectangleRoundedsUploaded\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeStrokeSide } from \"../e-shape-stroke-side\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeRectangleRounded extends EShapePrimitive {\n\tconstructor( type = EShapeType.RECTANGLE_ROUNDED ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeRectangleRounded {\n\t\treturn new EShapeRectangleRounded().copy( this );\n\t}\n\n\tprivate containsAbs_( x: number, y: number, ax: number, ay: number, r: number, corner: EShapeCorner ): boolean {\n\t\tconst bx0 = -ax + r;\n\t\tif( x <= bx0 ) {\n\t\t\tconst by0 = -ay + r;\n\t\t\tif( y <= by0 && (corner & EShapeCorner.TOP_LEFT) ) {\n\t\t\t\t// Top-left corner\n\t\t\t\tconst dx = x - bx0;\n\t\t\t\tconst dy = y - by0;\n\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t} else {\n\t\t\t\tconst by1 = +ay - r;\n\t\t\t\tif( by1 <= y && (corner & EShapeCorner.BOTTOM_LEFT) ) {\n\t\t\t\t\t// Bottom-left corner\n\t\t\t\t\tconst dx = x - bx0;\n\t\t\t\t\tconst dy = y - by1;\n\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t} else {\n\t\t\t\t\t// Middle-left box\n\t\t\t\t\treturn -ax <= x;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst bx1 = +ax - r;\n\t\t\tif( bx1 <= x ) {\n\t\t\t\tconst by0 = -ay + r;\n\t\t\t\tif( y <= by0 && (corner & EShapeCorner.TOP_RIGHT) ) {\n\t\t\t\t\t// Top-right corner\n\t\t\t\t\tconst dx = x - bx1;\n\t\t\t\t\tconst dy = y - by0;\n\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t} else {\n\t\t\t\t\tconst by1 = +ay - r;\n\t\t\t\t\tif( by1 <= y && (corner & EShapeCorner.BOTTOM_RIGHT) ) {\n\t\t\t\t\t\t// Bottom-right corner\n\t\t\t\t\t\tconst dx = x - bx1;\n\t\t\t\t\t\tconst dy = y - by1;\n\t\t\t\t\t\treturn dx * dx + dy * dy <= r * r;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// Middle-right box\n\t\t\t\t\t\treturn x <= +ax;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn -ay <= y && y <= +ay;\n\t\t\t}\n\t\t}\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst fill = this.fill;\n\t\t\tconst stroke = this.stroke;\n\t\t\tconst strokeWidth = ( stroke.enable ? stroke.width : 0 );\n\t\t\tif( fill.enable || 0 < strokeWidth ) {\n\t\t\t\tconst r = this.radius * Math.min( ax, ay );\n\t\t\t\tconst corner = this.corner;\n\t\t\t\tconst strokeSide = stroke.side;\n\t\t\t\tif( this.containsAbs_( x, y, ax, ay, r, corner ) ) {\n\t\t\t\t\tif( fill.enable ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst wx = Math.max( 0.0, ax - strokeWidth );\n\t\t\t\t\t\tconst wy = Math.max( 0.0, ay - strokeWidth );\n\t\t\t\t\t\tconst wr = Math.max( 0.0, r - strokeWidth );\n\t\t\t\t\t\tif( ! this.containsAbs_( x, y, wx, wy, wr, corner ) ) {\n\t\t\t\t\t\t\tif( strokeSide === EShapeStrokeSide.ALL ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tif( x <= -wx + wr ) {\n\t\t\t\t\t\t\t\t\tconst hasLeftSide = ( strokeSide & EShapeStrokeSide.LEFT ) !== 0;\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\tconst hasTopSide = ( strokeSide & EShapeStrokeSide.TOP );\n\t\t\t\t\t\t\t\t\t\tif( hasTopSide && hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasTopSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn -wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn x <= -wx;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\tconst hasBottomSide = ( strokeSide & EShapeStrokeSide.BOTTOM );\n\t\t\t\t\t\t\t\t\t\tif( hasBottomSide && hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasBottomSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasLeftSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn x <= -wx;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn hasLeftSide;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else if( +wx - wr <= x ) {\n\t\t\t\t\t\t\t\t\tconst hasRightSide = ( strokeSide & EShapeStrokeSide.RIGHT ) !== 0;\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\tconst hasTopSide = ( strokeSide & EShapeStrokeSide.TOP );\n\t\t\t\t\t\t\t\t\t\tif( hasTopSide && hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasTopSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn -wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= x;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\tconst hasBottomSide = ( strokeSide & EShapeStrokeSide.BOTTOM );\n\t\t\t\t\t\t\t\t\t\tif( hasBottomSide && hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t\t\t\t} else if( hasBottomSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= y;\n\t\t\t\t\t\t\t\t\t\t} else if( hasRightSide ) {\n\t\t\t\t\t\t\t\t\t\t\treturn +wx <= x;\n\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn hasRightSide;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tif( y <= -wy + wr ) {\n\t\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.TOP ) !== 0;\n\t\t\t\t\t\t\t\t\t} else if( +wy - wr <= y ) {\n\t\t\t\t\t\t\t\t\t\treturn ( strokeSide & EShapeStrokeSide.BOTTOM ) !== 0;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeRectangleRounded } from \"./e-shape-rectangle-rounded\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfRectangleRoundeds extends EShapeRectangleRounded implements EShapeLineOfAny {\n\tprotected declare _points: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfRectangleRoundeds ) {\n\t\tsuper( EShapeType.LINE_OF_RECTANGLE_ROUNDEDS );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis._points = new EShapeLineOfAnyPointsImpl( this );\n\t\t}\n\n\t\tthis._tester = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\t}\n\n\tget points(): EShapeLineOfAnyPoints {\n\t\treturn this._points;\n\t}\n\n\tclone(): EShapeLineOfRectangleRoundeds {\n\t\treturn new EShapeLineOfRectangleRoundeds( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbs( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbsBBox( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfRectangleRoundeds } from \"./e-shape-line-of-rectangle-roundeds\";\n\nexport const deserializeLineOfRectangleRoundeds = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeLineOfRectangleRoundeds> | EShapeLineOfRectangleRoundeds => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfRectangleRoundeds() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../e-shape-capabilities\";\nimport { EShapeCapability } from \"../e-shape-capability\";\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createLineOfRectangleRoundedsUploaded } from \"../variant/create-line-of-rectangle-roundeds-uploaded\";\nimport { deserializeLineOfRectangleRoundeds } from \"../variant/deserialize-line-of-rectangle-roundeds\";\n\nexport const loadShapeLineOfRectangleRoundeds = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_RECTANGLE_ROUNDEDS ] = createLineOfRectangleRoundedsUploaded;\n\tEShapeDeserializers[ EShapeType.LINE_OF_RECTANGLE_ROUNDEDS ] = deserializeLineOfRectangleRoundeds;\n\tEShapeCapabilities.set(\n\t\tEShapeType.LINE_OF_RECTANGLE_ROUNDEDS,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { buildNullClipping, buildNullStep, buildNullUv, buildNullVertex } from \"./build-null\";\nimport {\n\tbuildRectangleClipping, buildRectangleIndex, buildRectangleStep,\n\tbuildRectangleUv, buildRectangleVertex,\n\tRECTANGLE_INDEX_COUNT, RECTANGLE_VERTEX_COUNT, RECTANGLE_WORLD_SIZE\n} from \"./build-rectangle\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfRectanglesUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateIndices();\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCountReserved = this.pointCountReserved;\n\t\tif( 0 < pointCountReserved ) {\n\t\t\tbuildRectangleIndex(\n\t\t\t\tindices,\n\t\t\t\tvoffset,\n\t\t\t\tioffset\n\t\t\t);\n\t\t\tcopyIndex(\n\t\t\t\tindices,\n\t\t\t\tRECTANGLE_VERTEX_COUNT,\n\t\t\t\tioffset,\n\t\t\t\tRECTANGLE_INDEX_COUNT,\n\t\t\t\tpointCountReserved\n\t\t\t);\n\t\t}\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPointsImpl ) {\n\t\t\tthis.updateVertexClippingStepAndUv( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, RECTANGLE_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, RECTANGLE_VERTEX_COUNT );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexClippingStepAndUv( buffer: EShapeBuffer, shape: EShape, points: EShapeLineOfAnyPoints ) {\n\t\tconst pointId = points.id;\n\t\tconst pointOffset = points.offset;\n\t\tconst pointOffsetId = pointOffset.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId || pointOffsetId !== this.pointOffsetId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isTextureChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointCount = points.length;\n\t\t\tthis.pointOffsetId = pointOffsetId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.updateVertices();\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t}\n\t\t\tif( isVertexChanged ) {\n\t\t\t\tbuffer.updateClippings();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t}\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tif( 0 < pointCount && pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\t// Vertices\n\t\t\t\tbuildRectangleVertex(\n\t\t\t\t\tvertices, voffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues,\n\t\t\t\t\tpointOffset\n\t\t\t\t);\n\n\t\t\t\t// Steps\n\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\tbuildRectangleStep(\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Clippings\n\t\t\t\tif( isVertexChanged ) {\n\t\t\t\t\tbuildRectangleClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// UVs\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\tbuildRectangleUv(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyUvs(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ] + pointOffset.getX( i );\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ] + pointOffset.getY( i );\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\t\t\t\t\tconst iv = voffset + i * RECTANGLE_VERTEX_COUNT;\n\n\t\t\t\t\t// Vertices\n\t\t\t\t\tbuildRectangleVertex(\n\t\t\t\t\t\tvertices, iv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\n\t\t\t\t\t// Steps\n\t\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\t\tbuildRectangleStep(\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tsteps,\n\t\t\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Clippings\n\t\t\t\t\tif( isVertexChanged ) {\n\t\t\t\t\t\tbuildRectangleClipping(\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// UVs\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\t\tbuildRectangleUv(\n\t\t\t\t\t\t\tuvs,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\t\tRECTANGLE_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fill the rest\n\t\t\tconst pointCountReserved = this.pointCountReserved;\n\t\t\tconst voffsetReserved = voffset + pointCount * RECTANGLE_VERTEX_COUNT;\n\t\t\tconst vcountReserved = RECTANGLE_VERTEX_COUNT * (pointCountReserved - pointCount);\n\t\t\tbuildNullVertex(\n\t\t\t\tvertices,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullStep(\n\t\t\t\tsteps,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullClipping(\n\t\t\t\tclippings,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullUv(\n\t\t\t\tuvs,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_INDEX_COUNT, RECTANGLE_VERTEX_COUNT } from \"./build-rectangle\";\nimport { createLineOfAnyUploaded } from \"./create-line-of-any-uploaded\";\nimport { EShapeLineOfRectanglesUploaded } from \"./e-shape-line-of-rectangles-uploaded\";\n\nexport const createLineOfRectanglesUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeLineOfRectanglesUploaded | null => {\n\treturn createLineOfAnyUploaded(\n\t\tbuffer, shape,\n\t\tvoffset, RECTANGLE_VERTEX_COUNT,\n\t\tioffset, RECTANGLE_INDEX_COUNT,\n\t\tantialiasWeight,\n\t\tEShapeLineOfRectanglesUploaded\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfRectangles extends EShapeRectangle implements EShapeLineOfAny {\n\tprotected declare _points: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfRectangles ) {\n\t\tsuper( EShapeType.LINE_OF_RECTANGLES );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis._points = new EShapeLineOfAnyPointsImpl( this );\n\t\t}\n\n\t\tthis._tester = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\t}\n\n\tget points(): EShapeLineOfAnyPoints {\n\t\treturn this._points;\n\t}\n\n\tclone(): EShapeLineOfRectangles {\n\t\treturn new EShapeLineOfRectangles( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbs( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbsBBox( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfRectangles } from \"./e-shape-line-of-rectangles\";\n\nexport const deserializeLineOfRectangles = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeLineOfRectangles> | EShapeLineOfRectangles => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfRectangles() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../e-shape-capabilities\";\nimport { EShapeCapability } from \"../e-shape-capability\";\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createLineOfRectanglesUploaded } from \"../variant/create-line-of-rectangles-uploaded\";\nimport { deserializeLineOfRectangles } from \"../variant/deserialize-line-of-rectangles\";\n\nexport const loadShapeLineOfRectangles = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_RECTANGLES ] = createLineOfRectanglesUploaded;\n\tEShapeDeserializers[ EShapeType.LINE_OF_RECTANGLES ] = deserializeLineOfRectangles;\n\tEShapeCapabilities.set(\n\t\tEShapeType.LINE_OF_RECTANGLES,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE\n\t);\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { toLength } from \"./to-length\";\nimport { STEP_VALUES, toStep } from \"./to-step\";\n\nexport const TRIANGLE_ROUNDED_VERTEX_COUNT = 22;\nexport const TRIANGLE_ROUNDED_INDEX_COUNT = 15;\nexport const TRIANGLE_ROUNDED_WORLD_SIZE: [ number, number, number, number, number ] = [ 0, 0, 0, 0, 0 ];\nconst TRIANGLE_ROUNDED_WORK_POINT: Point = new Point();\n\nexport const buildTriangleRoundedIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\t// Top corner\n\tconst ii = ioffset * 3;\n\tindices[ ii +  0 ] = voffset + 0;\n\tindices[ ii +  1 ] = voffset + 1;\n\tindices[ ii +  2 ] = voffset + 3;\n\n\tindices[ ii +  3 ] = voffset + 1;\n\tindices[ ii +  4 ] = voffset + 2;\n\tindices[ ii +  5 ] = voffset + 3;\n\n\t// Bottom-right corner\n\tindices[ ii +  6 ] = voffset + 4;\n\tindices[ ii +  7 ] = voffset + 5;\n\tindices[ ii +  8 ] = voffset + 7;\n\n\tindices[ ii +  9 ] = voffset + 5;\n\tindices[ ii + 10 ] = voffset + 6;\n\tindices[ ii + 11 ] = voffset + 7;\n\n\t// Bottom-left corner\n\tindices[ ii + 12 ] = voffset + 8;\n\tindices[ ii + 13 ] = voffset + 9;\n\tindices[ ii + 14 ] = voffset + 11;\n\n\tindices[ ii + 15 ] = voffset + 9;\n\tindices[ ii + 16 ] = voffset + 10;\n\tindices[ ii + 17 ] = voffset + 11;\n\n\t// Others\n\tindices[ ii + 18 ] = voffset + 12;\n\tindices[ ii + 19 ] = voffset + 13;\n\tindices[ ii + 20 ] = voffset + 16;\n\n\tindices[ ii + 21 ] = voffset + 13;\n\tindices[ ii + 22 ] = voffset + 14;\n\tindices[ ii + 23 ] = voffset + 16;\n\n\tindices[ ii + 24 ] = voffset + 14;\n\tindices[ ii + 25 ] = voffset + 15;\n\tindices[ ii + 26 ] = voffset + 16;\n\n\t//\n\tindices[ ii + 27 ] = voffset + 12;\n\tindices[ ii + 28 ] = voffset + 16;\n\tindices[ ii + 29 ] = voffset + 19;\n\n\tindices[ ii + 30 ] = voffset + 16;\n\tindices[ ii + 31 ] = voffset + 17;\n\tindices[ ii + 32 ] = voffset + 19;\n\n\tindices[ ii + 33 ] = voffset + 17;\n\tindices[ ii + 34 ] = voffset + 18;\n\tindices[ ii + 35 ] = voffset + 19;\n\n\t//\n\tindices[ ii + 36 ] = voffset + 12;\n\tindices[ ii + 37 ] = voffset + 19;\n\tindices[ ii + 38 ] = voffset + 13;\n\n\tindices[ ii + 39 ] = voffset + 19;\n\tindices[ ii + 40 ] = voffset + 20;\n\tindices[ ii + 41 ] = voffset + 13;\n\n\tindices[ ii + 42 ] = voffset + 20;\n\tindices[ ii + 43 ] = voffset + 21;\n\tindices[ ii + 44 ] = voffset + 13;\n};\n\nexport const buildTriangleRoundedVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tradius: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number, number, number, number ]\n): void => {\n\t// Calculate the transformed positions\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\tconst sz = Math.sqrt( sx * sx + 4 * sy * sy );\n\tconst sw = 2 * sx * sy / (sx + sz);\n\tconst ry = ( sw * radius ) / ( 2 * sy );\n\tconst rz = ( 0.5 * ( sz - sw ) * radius ) / ( sz );\n\tconst rx = ( ry * sz ) / ( 2 * sx );\n\n\tconst work = TRIANGLE_ROUNDED_WORK_POINT;\n\twork.set( originX, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x1 = work.x;\n\tconst y1 = work.y;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst tx = work.x;\n\tconst ty = work.y;\n\twork.set( originX + sx, originY );\n\tinternalTransform.apply( work, work );\n\tconst dx = tx - x1;\n\tconst dy = ty - y1;\n\tconst x4 = work.x + dx;\n\tconst y4 = work.y + dy;\n\tconst x7 = tx + (tx - work.x) + dx;\n\tconst y7 = ty + (ty - work.y) + dy;\n\tconst dx14 = x4 - x1;\n\tconst dy14 = y4 - y1;\n\tconst x2 = x1 + rz * dx14;\n\tconst y2 = y1 + rz * dy14;\n\tconst x3 = x4 - ry * dx14;\n\tconst y3 = y4 - ry * dy14;\n\tconst dx47r = rx * (x7 - x4);\n\tconst dy47r = rx * (y7 - y4);\n\tconst x5 = x4 + dx47r;\n\tconst y5 = y4 + dy47r;\n\tconst x6 = x7 - dx47r;\n\tconst y6 = y7 - dy47r;\n\tconst dx71 = x1 - x7;\n\tconst dy71 = y1 - y7;\n\tconst x8 = x7 + ry * dx71;\n\tconst y8 = y7 + ry * dy71;\n\tconst x9 = x1 - rz * dx71;\n\tconst y9 = y1 - rz * dy71;\n\twork.set( originX, originY + sy - sw ); // Incenter of a triangle\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\n\tconst x10 = x1 + radius * ( x0 - x1 );\n\tconst y10 = y1 + radius * ( y0 - y1 );\n\tconst x11 = x4 + radius * ( x0 - x4 );\n\tconst y11 = y4 + radius * ( y0 - y4 );\n\tconst x12 = x7 + radius * ( x0 - x7 );\n\tconst y12 = y7 + radius * ( y0 - y7 );\n\n\t// World size\n\tconst xb = tx + dx;\n\tconst yb = ty + dy;\n\tworldSize[ 0 ] = toLength( xb, yb, x0, y0 );\n\tworldSize[ 1 ] = rx;\n\tworldSize[ 2 ] = ry;\n\tworldSize[ 3 ] = rz;\n\tworldSize[ 4 ] = 1 - 0.5 * sw / sy;\n\n\t// Vertices\n\t// Top corner\n\tconst iv = voffset * 2;\n\tvertices[ iv +  0 ] = x10;\n\tvertices[ iv +  1 ] = y10;\n\tvertices[ iv +  2 ] = x9;\n\tvertices[ iv +  3 ] = y9;\n\tvertices[ iv +  4 ] = x1;\n\tvertices[ iv +  5 ] = y1;\n\tvertices[ iv +  6 ] = x2;\n\tvertices[ iv +  7 ] = y2;\n\n\t// Bottom-right corner\n\tvertices[ iv +  8 ] = x11;\n\tvertices[ iv +  9 ] = y11;\n\tvertices[ iv + 10 ] = x3;\n\tvertices[ iv + 11 ] = y3;\n\tvertices[ iv + 12 ] = x4;\n\tvertices[ iv + 13 ] = y4;\n\tvertices[ iv + 14 ] = x5;\n\tvertices[ iv + 15 ] = y5;\n\n\t// Bottom-left corner\n\tvertices[ iv + 16 ] = x12;\n\tvertices[ iv + 17 ] = y12;\n\tvertices[ iv + 18 ] = x6;\n\tvertices[ iv + 19 ] = y6;\n\tvertices[ iv + 20 ] = x7;\n\tvertices[ iv + 21 ] = y7;\n\tvertices[ iv + 22 ] = x8;\n\tvertices[ iv + 23 ] = y8;\n\n\t// Others\n\tvertices[ iv + 24 ] = x0;\n\tvertices[ iv + 25 ] = y0;\n\n\tvertices[ iv + 26 ] = x10;\n\tvertices[ iv + 27 ] = y10;\n\n\tvertices[ iv + 28 ] = x2;\n\tvertices[ iv + 29 ] = y2;\n\tvertices[ iv + 30 ] = x3;\n\tvertices[ iv + 31 ] = y3;\n\n\tvertices[ iv + 32 ] = x11;\n\tvertices[ iv + 33 ] = y11;\n\n\tvertices[ iv + 34 ] = x5;\n\tvertices[ iv + 35 ] = y5;\n\tvertices[ iv + 36 ] = x6;\n\tvertices[ iv + 37 ] = y6;\n\n\tvertices[ iv + 38 ] = x12;\n\tvertices[ iv + 39 ] = y12;\n\n\tvertices[ iv + 40 ] = x8;\n\tvertices[ iv + 41 ] = y8;\n\tvertices[ iv + 42 ] = x9;\n\tvertices[ iv + 43 ] = y9;\n};\n\nexport const buildTriangleRoundedClipping = (\n\tclippings: Float32Array,\n\tvoffset: number,\n\tcorner: EShapeCorner,\n\tradius: number\n): void => {\n\t// Top corner\n\tlet iv = voffset * 3;\n\tconst w = 1 - radius;\n\tif( corner & EShapeCorner.TOP ) {\n\t\tclippings[ iv +  0 ] = 0;\n\t\tclippings[ iv +  1 ] = 0;\n\t\tclippings[ iv +  2 ] = 1;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = 0;\n\t\tclippings[ iv +  5 ] = 1;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 1;\n\t\tclippings[ iv +  9 ] = 0;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 1;\n\t} else {\n\t\tclippings[ iv +  0 ] = w;\n\t\tclippings[ iv +  1 ] = w;\n\t\tclippings[ iv +  2 ] = 0;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = w;\n\t\tclippings[ iv +  5 ] = 0;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 0;\n\t\tclippings[ iv +  9 ] = w;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 0;\n\t}\n\tiv += 12;\n\n\t// Bottom-right corner\n\tif( corner & EShapeCorner.BOTTOM_RIGHT ) {\n\t\tclippings[ iv +  0 ] = 0;\n\t\tclippings[ iv +  1 ] = 0;\n\t\tclippings[ iv +  2 ] = 1;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = 0;\n\t\tclippings[ iv +  5 ] = 1;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 1;\n\t\tclippings[ iv +  9 ] = 0;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 1;\n\t} else {\n\t\tclippings[ iv +  0 ] = w;\n\t\tclippings[ iv +  1 ] = w;\n\t\tclippings[ iv +  2 ] = 0;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = w;\n\t\tclippings[ iv +  5 ] = 0;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 0;\n\t\tclippings[ iv +  9 ] = w;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 0;\n\t}\n\tiv += 12;\n\n\t// Bottom-left corner\n\tif( corner & EShapeCorner.BOTTOM_LEFT ) {\n\t\tclippings[ iv +  0 ] = 0;\n\t\tclippings[ iv +  1 ] = 0;\n\t\tclippings[ iv +  2 ] = 1;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = 0;\n\t\tclippings[ iv +  5 ] = 1;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 1;\n\t\tclippings[ iv +  9 ] = 0;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 1;\n\t} else {\n\t\tclippings[ iv +  0 ] = w;\n\t\tclippings[ iv +  1 ] = w;\n\t\tclippings[ iv +  2 ] = 0;\n\t\tclippings[ iv +  3 ] = 1;\n\t\tclippings[ iv +  4 ] = w;\n\t\tclippings[ iv +  5 ] = 0;\n\t\tclippings[ iv +  6 ] = 1;\n\t\tclippings[ iv +  7 ] = 1;\n\t\tclippings[ iv +  8 ] = 0;\n\t\tclippings[ iv +  9 ] = w;\n\t\tclippings[ iv + 10 ] = 1;\n\t\tclippings[ iv + 11 ] = 0;\n\t}\n\tiv += 12;\n\n\t// Others\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = w;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tclippings[ iv + 3 ] = 1;\n\tclippings[ iv + 4 ] = 0;\n\tclippings[ iv + 5 ] = 0;\n\tiv += 6;\n\n\tclippings[ iv + 0 ] = w;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tclippings[ iv + 3 ] = 1;\n\tclippings[ iv + 4 ] = 0;\n\tclippings[ iv + 5 ] = 0;\n\tiv += 6;\n\n\tclippings[ iv + 0 ] = w;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tclippings[ iv + 3 ] = 1;\n\tclippings[ iv + 4 ] = 0;\n\tclippings[ iv + 5 ] = 0;\n};\n\nexport const buildTriangleRoundedStep = (\n\tsteps: Float32Array,\n\tclippings: Float32Array,\n\tvoffset: number,\n\tstrokeWidth: number,\n\tradius: number,\n\tantialiasWeight: number,\n\tworldSize: [ number, number, number, number, number ]\n): void => {\n\tconst wsr = worldSize[ 0 ];\n\ttoStep( wsr, strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swc = STEP_VALUES[ 0 ];\n\tconst pc0 = STEP_VALUES[ 1 ];\n\tconst pc1 = STEP_VALUES[ 2 ];\n\n\ttoStep( radius * wsr, strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swr = STEP_VALUES[ 0 ];\n\tconst pr0 = STEP_VALUES[ 1 ];\n\tconst pr1 = STEP_VALUES[ 2 ];\n\n\tlet ic = voffset * 3;\n\tlet is = voffset * 6;\n\tfor( let i = 0; i < TRIANGLE_ROUNDED_VERTEX_COUNT; ++i ) {\n\t\tlet sw = swc;\n\t\tlet p0 = pc0;\n\t\tlet p1 = pc1;\n\t\tif( 0.5 < clippings[ ic + 2 ] ) {\n\t\t\tsw = swr;\n\t\t\tp0 = pr0;\n\t\t\tp1 = pr1;\n\t\t}\n\t\tsteps[ is + 0 ] = sw * clippings[ ic + 0 ];\n\t\tsteps[ is + 1 ] = sw * clippings[ ic + 1 ];\n\t\tsteps[ is + 2 ] = p0;\n\t\tsteps[ is + 3 ] = p0;\n\t\tsteps[ is + 4 ] = p1;\n\t\tsteps[ is + 5 ] = p1;\n\t\tic += 3;\n\t\tis += 6;\n\t}\n};\n\nexport const buildTriangleRoundedUv = (\n\tuvs: Float32Array,\n\tvoffset: number,\n\ttextureUvs: TextureUvs,\n\tradius: number,\n\tworldSize: [ number, number, number, number, number ]\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\tconst x4 = 0.5 * ( x0 + x1 );\n\tconst y4 = 0.5 * ( y0 + y1 );\n\n\tconst c = worldSize[ 4 ];\n\tconst x5 = x4 + c * ( x3 - x0 );\n\tconst y5 = y4 + c * ( y3 - y0 );\n\n\tconst rx = worldSize[ 1 ];\n\tconst ry = worldSize[ 2 ];\n\tconst rz = worldSize[ 3 ];\n\tconst x6 = x4 + rz * (x3 - x4);\n\tconst y6 = y4 + rz * (y3 - y4);\n\tconst x7 = x4 + radius * (x5 - x4);\n\tconst y7 = y4 + radius * (y5 - y4);\n\tconst x8 = x4 + rz * (x2 - x4);\n\tconst y8 = y4 + rz * (y2 - y4);\n\n\tconst x9 = x2 + ry * (x4 - x2);\n\tconst y9 = y2 + ry * (y4 - y2);\n\tconst x10 = x2 + radius * (x5 - x2);\n\tconst y10 = y2 + radius * (y5 - y2);\n\tconst x11 = x2 + rx * (x3 - x2);\n\tconst y11 = y2 + rx * (y3 - y2);\n\n\tconst x12 = x3 + rx * (x2 - x3);\n\tconst y12 = y3 + rx * (y2 - y3);\n\tconst x13 = x3 + radius * (x5 - x3);\n\tconst y13 = y3 + radius * (y5 - y3);\n\tconst x14 = x3 + ry * (x4 - x3);\n\tconst y14 = y3 + ry * (y4 - y3);\n\n\t// Uvs\n\t// Top corner\n\tlet iuv = voffset * 2;\n\tuvs[ iuv + 0 ] = x7;\n\tuvs[ iuv + 1 ] = y7;\n\tuvs[ iuv + 2 ] = x6;\n\tuvs[ iuv + 3 ] = y6;\n\tuvs[ iuv + 4 ] = x4;\n\tuvs[ iuv + 5 ] = y4;\n\tuvs[ iuv + 6 ] = x8;\n\tuvs[ iuv + 7 ] = y8;\n\tiuv += 8;\n\n\t// Bottom-right corner\n\tuvs[ iuv + 0 ] = x10;\n\tuvs[ iuv + 1 ] = y10;\n\tuvs[ iuv + 2 ] = x9;\n\tuvs[ iuv + 3 ] = y9;\n\tuvs[ iuv + 4 ] = x2;\n\tuvs[ iuv + 5 ] = y2;\n\tuvs[ iuv + 6 ] = x11;\n\tuvs[ iuv + 7 ] = y11;\n\tiuv += 8;\n\n\t// Bottom-left corner\n\tuvs[ iuv + 0 ] = x13;\n\tuvs[ iuv + 1 ] = y13;\n\tuvs[ iuv + 2 ] = x12;\n\tuvs[ iuv + 3 ] = y12;\n\tuvs[ iuv + 4 ] = x3;\n\tuvs[ iuv + 5 ] = y3;\n\tuvs[ iuv + 6 ] = x14;\n\tuvs[ iuv + 7 ] = y14;\n\tiuv += 8;\n\n\t// Others\n\tuvs[ iuv +  0 ] = x5;\n\tuvs[ iuv +  1 ] = y5;\n\n\tuvs[ iuv +  2 ] = x7;\n\tuvs[ iuv +  3 ] = y7;\n\n\tuvs[ iuv +  4 ] = x8;\n\tuvs[ iuv +  5 ] = y8;\n\tuvs[ iuv +  6 ] = x9;\n\tuvs[ iuv +  7 ] = y9;\n\n\tuvs[ iuv +  8 ] = x10;\n\tuvs[ iuv +  9 ] = y10;\n\n\tuvs[ iuv + 10 ] = x11;\n\tuvs[ iuv + 11 ] = y11;\n\tuvs[ iuv + 12 ] = x12;\n\tuvs[ iuv + 13 ] = y12;\n\n\tuvs[ iuv + 14 ] = x13;\n\tuvs[ iuv + 15 ] = y13;\n\n\tuvs[ iuv + 16 ] = x14;\n\tuvs[ iuv + 17 ] = y14;\n\tuvs[ iuv + 18 ] = x6;\n\tuvs[ iuv + 19 ] = y6;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { buildNullClipping, buildNullStep, buildNullUv, buildNullVertex } from \"./build-null\";\nimport {\n\tbuildTriangleRoundedClipping, buildTriangleRoundedIndex, buildTriangleRoundedStep,\n\tbuildTriangleRoundedUv, buildTriangleRoundedVertex, TRIANGLE_ROUNDED_INDEX_COUNT, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\tTRIANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-triangle-rounded\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfTriangleRoundedsUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateIndices();\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCountReserved = this.pointCountReserved;\n\t\tif( 0 < pointCountReserved ) {\n\t\t\tbuildTriangleRoundedIndex(\n\t\t\t\tbuffer.indices,\n\t\t\t\tvoffset,\n\t\t\t\tioffset\n\t\t\t);\n\t\t\tcopyIndex(\n\t\t\t\tbuffer.indices,\n\t\t\t\tTRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\tioffset,\n\t\t\t\tTRIANGLE_ROUNDED_INDEX_COUNT,\n\t\t\t\tpointCountReserved\n\t\t\t);\n\t\t}\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPointsImpl ) {\n\t\t\tthis.updateVertexClippingStepAndUv( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, TRIANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, TRIANGLE_ROUNDED_VERTEX_COUNT );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexClippingStepAndUv(\n\t\tbuffer: EShapeBuffer,\n\t\tshape: EShape,\n\t\tpoints: EShapeLineOfAnyPoints\n\t): void {\n\t\tconst pointId = points.id;\n\t\tconst pointOffset = points.offset;\n\t\tconst pointOffsetId = pointOffset.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId || pointOffsetId !== this.pointOffsetId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst radius = shape.radius;\n\t\tconst isRadiusChanged = ( radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( this.corner !== corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isRadiusChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointCount = points.length;\n\t\t\tthis.pointOffsetId = pointOffsetId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.updateVertices();\n\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\tbuffer.updateClippings();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t}\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tif( 0 < pointCount && pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\t// Vertices\n\t\t\t\tbuildTriangleRoundedVertex(\n\t\t\t\t\tvertices, voffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues,\n\t\t\t\t\tpointOffset\n\t\t\t\t);\n\n\t\t\t\t// Clippings\n\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\tbuildTriangleRoundedClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tcorner,\n\t\t\t\t\t\tradius\n\t\t\t\t\t);\n\t\t\t\t\tcopyClipping(\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// Steps\n\t\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\t\tbuildTriangleRoundedStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\tradius,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tvoffset, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\n\t\t\t\t// UVs\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\tbuildTriangleRoundedUv(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\tradius,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyUvs(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ] + pointOffset.getX( i );\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ] + pointOffset.getY( i );\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\n\t\t\t\t\tconst iv = voffset + i * TRIANGLE_ROUNDED_VERTEX_COUNT;\n\n\t\t\t\t\t// Vertices\n\t\t\t\t\tbuildTriangleRoundedVertex(\n\t\t\t\t\t\tvertices, iv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t);\n\n\t\t\t\t\t// Clippings\n\t\t\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\t\t\tbuildTriangleRoundedClipping(\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tcorner,\n\t\t\t\t\t\t\tradius\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// Steps\n\t\t\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\t\t\tbuildTriangleRoundedStep(\n\t\t\t\t\t\t\tsteps,\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tradius,\n\t\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\n\t\t\t\t\t// UVs\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\t\tbuildTriangleRoundedUv(\n\t\t\t\t\t\t\tuvs,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\t\tradius,\n\t\t\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fill the rest\n\t\t\tconst pointCountReserved = this.pointCountReserved;\n\t\t\tconst voffsetReserved = voffset + pointCount * TRIANGLE_ROUNDED_VERTEX_COUNT;\n\t\t\tconst vcountReserved = TRIANGLE_ROUNDED_VERTEX_COUNT * (pointCountReserved - pointCount);\n\t\t\tbuildNullVertex(\n\t\t\t\tvertices,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullStep(\n\t\t\t\tsteps,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullClipping(\n\t\t\t\tclippings,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullUv(\n\t\t\t\tuvs,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TRIANGLE_ROUNDED_INDEX_COUNT, TRIANGLE_ROUNDED_VERTEX_COUNT } from \"./build-triangle-rounded\";\nimport { createLineOfAnyUploaded } from \"./create-line-of-any-uploaded\";\nimport { EShapeLineOfTriangleRoundedsUploaded } from \"./e-shape-line-of-triangle-roundeds-uploaded\";\n\nexport const createLineOfTriangleRoundedsUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeLineOfTriangleRoundedsUploaded | null => {\n\treturn createLineOfAnyUploaded(\n\t\tbuffer, shape,\n\t\tvoffset, TRIANGLE_ROUNDED_VERTEX_COUNT,\n\t\tioffset, TRIANGLE_ROUNDED_INDEX_COUNT,\n\t\tantialiasWeight,\n\t\tEShapeLineOfTriangleRoundedsUploaded\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeTriangle extends EShapePrimitive {\n\tconstructor( type = EShapeType.TRIANGLE ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeTriangle {\n\t\treturn new EShapeTriangle().copy( this );\n\t}\n\n\tprotected containsAbs_( x: number, y: number, a: number, ay1: number, ay2: number ): boolean {\n\t\t// a = 2 * ay / ax\n\t\t// y = + a * x + ay1\n\t\t// y = - a * x + ay1\n\t\t// y = ay2;\n\t\treturn ( +a * x + ay1 - y <= 0 && -a * x + ay1 - y <= 0 && y <= ay2 );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst a = 2 * ay / ax;\n\t\t\tconst fill = this.fill;\n\t\t\tif( fill.enable ) {\n\t\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst stroke = this.stroke;\n\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\t\t\tconst az = Math.sqrt( ax * ax + 4 * ay * ay );\n\t\t\t\t\t\tconst aw = 2 * ax * ay / (ax + az);\n\n\t\t\t\t\t\tconst cy = ay - aw;\n\t\t\t\t\t\tconst ay1 = cy + (-ay - cy) * Math.max( 0.0, aw - strokeWidth ) / aw;\n\t\t\t\t\t\tconst ay2 = ay - strokeWidth;\n\t\t\t\t\t\tif( ! this.containsAbs_( x, y, a, ay1, ay2 ) ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCorner } from \"../e-shape-corner\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\n\nconst FMIN = 0.00001;\n\nexport class EShapeTriangleRounded extends EShapeTriangle {\n\tconstructor( type = EShapeType.TRIANGLE_ROUNDED ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeTriangleRounded {\n\t\treturn new EShapeTriangleRounded().copy( this );\n\t}\n\n\tprotected containsCorner_( x: number, y: number, r: number, aw: number ) {\n\t\tconst fill = this.fill;\n\t\tif( fill.enable ) {\n\t\t\tif( x * x + y * y <= r * r ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t} else {\n\t\t\tconst stroke = this.stroke;\n\t\t\tconst strokeWidth = stroke.width;\n\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\tconst d = x * x + y * y;\n\t\t\t\tif( d <= r * r ) {\n\t\t\t\t\tconst w = Math.max( 0.0, r * ( 1 - strokeWidth / aw ) );\n\t\t\t\t\tif( w * w <= d ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected containsCorner(\n\t\tx: number, y: number,\n\t\tx0: number, y0: number,\n\t\tx1: number, y1: number,\n\t\tx2: number, y2: number,\n\t\tx3: number, y3: number,\n\t\tr12: number, r13: number,\n\t\taw: number,\n\t\tradius: number\n\t) {\n\t\tconst xl = x1 + r12 * ( x2 - x1 ) - x0;\n\t\tconst yl = y1 + r12 * ( y2 - y1 ) - y0;\n\t\tconst n = Math.sqrt( xl * xl + yl * yl );\n\t\tif( FMIN < n ) {\n\t\t\tconst ni = 1 / n;\n\t\t\tconst nlx = xl * ni;\n\t\t\tconst nly = yl * ni;\n\n\t\t\tconst xr = x1 + r13 * ( x3 - x1 ) - x0;\n\t\t\tconst yr = y1 + r13 * ( y3 - y1 ) - y0;\n\t\t\tconst nrx = xr * ni;\n\t\t\tconst nry = yr * ni;\n\n\t\t\tconst det = nlx * nry - nrx * nly;\n\t\t\tif( FMIN < Math.abs( det ) ) {\n\t\t\t\tconst deti = 1 / det;\n\t\t\t\tconst xc = x - x0;\n\t\t\t\tconst yc = y - y0;\n\t\t\t\tconst dx = ( +nry * xc - nrx * yc ) * deti;\n\t\t\t\tconst dy = ( -nly * xc + nlx * yc ) * deti;\n\t\t\t\tif( this.containsCorner_( dx, dy, n, aw * radius ) ) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ) {\n\t\tif( super.containsAbsBBox( x, y, ax, ay ) ) {\n\t\t\tconst a = 2 * ay / ax;\n\t\t\tif( this.containsAbs_( x, y, a, -ay, +ay ) ) {\n\t\t\t\tconst az = Math.sqrt( ax * ax + 4 * ay * ay );\n\t\t\t\tconst aw = 2 * ax * ay / (ax + az);\n\t\t\t\tconst radius = this.radius;\n\n\t\t\t\tconst x0 = 0;\n\t\t\t\tconst y0 = ay - aw;\n\t\t\t\tconst x1 = 0;\n\t\t\t\tconst y1 = -ay;\n\t\t\t\tconst x4 = +ax;\n\t\t\t\tconst y4 = +ay;\n\t\t\t\tconst x7 = -x4;\n\t\t\t\tconst y7 = +y4;\n\t\t\t\tconst x10 = x1 + radius * ( x0 - x1 );\n\t\t\t\tconst y10 = y1 + radius * ( y0 - y1 );\n\t\t\t\tconst x11 = x4 + radius * ( x0 - x4 );\n\t\t\t\tconst y11 = y4 + radius * ( y0 - y4 );\n\t\t\t\tconst y12 = +y11;\n\t\t\t\tconst x12 = -x11;\n\n\t\t\t\tconst c0 = -a * x + y10 - y <= 0;\n\t\t\t\tconst c1 = +a * x + y10 - y <= 0;\n\t\t\t\tconst c2 = y <= y11;\n\t\t\t\tconst corner = this.corner;\n\t\t\t\tif( ! c0 && ! c1 && (corner & EShapeCorner.TOP) ) {\n\t\t\t\t\t// Top corner\n\t\t\t\t\tconst rz = ( 0.5 * ( az - aw ) * radius ) / ( az );\n\t\t\t\t\tif( this.containsCorner( x, y, x10, y10, x1, y1, x7, y7, x4, y4, rz, rz, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if( ! c0 && ! c2 && (corner & EShapeCorner.BOTTOM_LEFT) ) {\n\t\t\t\t\t// Bottom-left corner\n\t\t\t\t\tconst ry = ( aw * radius ) / ( 2 * ay );\n\t\t\t\t\tconst rx = ( ry * az ) / ( 2 * ax );\n\t\t\t\t\tif( this.containsCorner( x, y, x12, y12, x7, y7, x4, y4, x1, y1, rx, ry, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else if( ! c1 && ! c2 && (corner & EShapeCorner.BOTTOM_RIGHT) ) {\n\t\t\t\t\t// Bottom-right corner\n\t\t\t\t\tconst ry = ( aw * radius ) / ( 2 * ay );\n\t\t\t\t\tconst rx = ( ry * az ) / ( 2 * ax );\n\t\t\t\t\tif( this.containsCorner( x, y, x11, y11, x4, y4, x1, y1, x7, y7, ry, rx, aw, radius ) ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// Others\n\t\t\t\t\tconst fill = this.fill;\n\t\t\t\t\tif( fill.enable ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst stroke = this.stroke;\n\t\t\t\t\t\tconst strokeWidth = stroke.width;\n\t\t\t\t\t\tif( stroke.enable && 0 < strokeWidth ) {\n\t\t\t\t\t\t\tconst cy = ay - aw;\n\t\t\t\t\t\t\tconst ay1 = cy + (-ay - cy) * Math.max( 0.0, aw - strokeWidth ) / aw;\n\t\t\t\t\t\t\tconst ay2 = ay - strokeWidth;\n\t\t\t\t\t\t\tif( ! this.containsAbs_( x, y, a, ay1, ay2 ) ) {\n\t\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeTriangleRounded } from \"./e-shape-triangle-rounded\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfTriangleRoundeds extends EShapeTriangleRounded implements EShapeLineOfAny {\n\tprotected declare _points: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfTriangleRoundeds ) {\n\t\tsuper( EShapeType.LINE_OF_TRIANGLE_ROUNDEDS );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis._points = new EShapeLineOfAnyPointsImpl( this );\n\t\t}\n\n\t\tthis._tester = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\t}\n\n\tget points(): EShapeLineOfAnyPoints {\n\t\treturn this._points;\n\t}\n\n\tclone(): EShapeLineOfTriangleRoundeds {\n\t\treturn new EShapeLineOfTriangleRoundeds( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbs( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbsBBox( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfTriangleRoundeds } from \"./e-shape-line-of-triangle-roundeds\";\n\nexport const deserializeLineOfTriangleRoundeds = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeLineOfTriangleRoundeds> | EShapeLineOfTriangleRoundeds => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfTriangleRoundeds() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../e-shape-capabilities\";\nimport { EShapeCapability } from \"../e-shape-capability\";\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createLineOfTriangleRoundedsUploaded } from \"../variant/create-line-of-triangle-roundeds-uploaded\";\nimport { deserializeLineOfTriangleRoundeds } from \"../variant/deserialize-line-of-triangle-roundeds\";\n\nexport const loadShapeLineOfTriangleRoundeds = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_TRIANGLE_ROUNDEDS ] = createLineOfTriangleRoundedsUploaded;\n\tEShapeDeserializers[ EShapeType.LINE_OF_TRIANGLE_ROUNDEDS ] = deserializeLineOfTriangleRoundeds;\n\tEShapeCapabilities.set(\n\t\tEShapeType.LINE_OF_TRIANGLE_ROUNDEDS,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","import { Matrix, Point, TextureUvs } from \"pixi.js\";\nimport { buildStep } from \"./build-step\";\nimport { toLength } from \"./to-length\";\nimport { STEP_VALUES, toStep } from \"./to-step\";\n\nexport const TRIANGLE_VERTEX_COUNT = 7;\nexport const TRIANGLE_INDEX_COUNT = 3;\nexport const TRIANGLE_WORLD_SIZE: [ number, number, number ] = [ 0, 0, 0 ];\nconst TRIANGLE_WORK_POINT: Point = new Point();\n\nexport const buildTriangleClipping = (\n\tclippings: Float32Array,\n\tvoffset: number\n): void => {\n\t// Clippings\n\tlet iv = voffset * 3;\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 1;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 0;\n\tclippings[ iv + 1 ] = 1;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n\tiv += 3;\n\n\tclippings[ iv + 0 ] = 1;\n\tclippings[ iv + 1 ] = 0;\n\tclippings[ iv + 2 ] = 0;\n};\n\nexport const buildTriangleIndex = (\n\tindices: Uint16Array | Uint32Array,\n\tvoffset: number,\n\tioffset: number\n): void => {\n\t// Indices\n\tconst ii = ioffset * 3;\n\tindices[ ii + 0 ] = voffset + 0;\n\tindices[ ii + 1 ] = voffset + 1;\n\tindices[ ii + 2 ] = voffset + 2;\n\n\tindices[ ii + 3 ] = voffset + 0;\n\tindices[ ii + 4 ] = voffset + 3;\n\tindices[ ii + 5 ] = voffset + 4;\n\n\tindices[ ii + 6 ] = voffset + 0;\n\tindices[ ii + 7 ] = voffset + 5;\n\tindices[ ii + 8 ] = voffset + 6;\n};\n\nexport const buildTriangleVertex = (\n\tvertices: Float32Array,\n\tvoffset: number,\n\toriginX: number,\n\toriginY: number,\n\tsizeX: number,\n\tsizeY: number,\n\tstrokeAlign: number,\n\tstrokeWidth: number,\n\tinternalTransform: Matrix,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst s = strokeAlign * strokeWidth;\n\tconst sx = sizeX * 0.5 + (0 <= sizeX ? +s : -s);\n\tconst sy = sizeY * 0.5 + (0 <= sizeY ? +s : -s);\n\tconst sz = Math.sqrt( sx * sx + 4 * sy * sy );\n\tconst sw = 2 * sx * sy / (sx + sz);\n\n\tconst work = TRIANGLE_WORK_POINT;\n\twork.set( originX, originY - sy );\n\tinternalTransform.apply( work, work );\n\tconst x0 = work.x;\n\tconst y0 = work.y;\n\twork.set( originX, originY );\n\tinternalTransform.apply( work, work );\n\tconst tx = work.x;\n\tconst ty = work.y;\n\twork.set( originX + sx, originY );\n\tinternalTransform.apply( work, work );\n\tconst dx = tx - x0;\n\tconst dy = ty - y0;\n\tconst x1 = work.x + dx;\n\tconst y1 = work.y + dy;\n\tconst x2 = tx + (tx - work.x) + dx;\n\tconst y2 = ty + (ty - work.y) + dy;\n\twork.set( originX, originY + sy - sw ); // Incenter of a triangle\n\tinternalTransform.apply( work, work );\n\tconst x3 = work.x;\n\tconst y3 = work.y;\n\n\t// World size\n\tconst xb = tx + dx;\n\tconst yb = ty + dy;\n\tworldSize[ 0 ] = toLength( xb, yb, x3, y3 );\n\tworldSize[ 1 ] = toLength( x1, y1, xb, yb );\n\tworldSize[ 2 ] = toLength( x0, y0, tx, ty );\n\n\t// Vertices\n\tconst iv = voffset << 1;\n\tvertices[ iv +  0 ] = x3;\n\tvertices[ iv +  1 ] = y3;\n\n\tvertices[ iv +  2 ] = x0;\n\tvertices[ iv +  3 ] = y0;\n\tvertices[ iv +  4 ] = x1;\n\tvertices[ iv +  5 ] = y1;\n\n\tvertices[ iv +  6 ] = x1;\n\tvertices[ iv +  7 ] = y1;\n\tvertices[ iv +  8 ] = x2;\n\tvertices[ iv +  9 ] = y2;\n\n\tvertices[ iv + 10 ] = x2;\n\tvertices[ iv + 11 ] = y2;\n\tvertices[ iv + 12 ] = x0;\n\tvertices[ iv + 13 ] = y0;\n};\n\nexport const buildTriangleStep = (\n\tsteps: Float32Array,\n\tclippings: Float32Array,\n\tvoffset: number,\n\tvcount: number,\n\tstrokeWidth: number,\n\tantialiasWeight: number,\n\tworldSize: [ number, number, number ]\n): void => {\n\ttoStep( worldSize[ 0 ], strokeWidth, antialiasWeight, STEP_VALUES );\n\tconst swc = STEP_VALUES[ 0 ];\n\tconst pc0 = STEP_VALUES[ 1 ];\n\tconst pc1 = STEP_VALUES[ 2 ];\n\n\tbuildStep(\n\t\tsteps,\n\t\tclippings,\n\t\tvoffset,\n\t\tvcount,\n\t\tswc, swc,\n\t\tpc0, pc0,\n\t\tpc1, pc1\n\t);\n};\n\nexport const buildTriangleUv = (\n\tuvs: Float32Array,\n\ttextureUvs: TextureUvs,\n\tvoffset: number,\n\tworldSize: [ number, number, number ]\n): void => {\n\tconst x0 = textureUvs.x0;\n\tconst x1 = textureUvs.x1;\n\tconst x2 = textureUvs.x2;\n\tconst x3 = textureUvs.x3;\n\tconst y0 = textureUvs.y0;\n\tconst y1 = textureUvs.y1;\n\tconst y2 = textureUvs.y2;\n\tconst y3 = textureUvs.y3;\n\n\tconst x4 = 0.5 * ( x0 + x1 );\n\tconst y4 = 0.5 * ( y0 + y1 );\n\n\tconst c = 1 - 0.5 * worldSize[ 0 ] / worldSize[ 2 ];\n\tconst x5 = x4 + c * ( x3 - x0 );\n\tconst y5 = y4 + c * ( y3 - y0 );\n\n\tconst iuv = voffset << 1;\n\tuvs[ iuv +  0 ] = x5;\n\tuvs[ iuv +  1 ] = y5;\n\n\tuvs[ iuv +  2 ] = x4;\n\tuvs[ iuv +  3 ] = y4;\n\tuvs[ iuv +  4 ] = x2;\n\tuvs[ iuv +  5 ] = y2;\n\n\tuvs[ iuv +  6 ] = x2;\n\tuvs[ iuv +  7 ] = y2;\n\tuvs[ iuv +  8 ] = x3;\n\tuvs[ iuv +  9 ] = y3;\n\n\tuvs[ iuv + 10 ] = x3;\n\tuvs[ iuv + 11 ] = y3;\n\tuvs[ iuv + 12 ] = x4;\n\tuvs[ iuv + 13 ] = y4;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { buildNullStep, buildNullUv, buildNullVertex } from \"./build-null\";\nimport {\n\tbuildTriangleClipping, buildTriangleIndex, buildTriangleStep, buildTriangleUv, buildTriangleVertex,\n\tTRIANGLE_INDEX_COUNT, TRIANGLE_VERTEX_COUNT, TRIANGLE_WORLD_SIZE\n} from \"./build-triangle\";\nimport { copyClipping } from \"./copy-clipping\";\nimport { copyIndex } from \"./copy-index\";\nimport { copyStep } from \"./copy-step\";\nimport { copyUvs } from \"./copy-uv\";\nimport { copyVertex } from \"./copy-vertex\";\nimport { EShapeLineOfAnyPoints } from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeLineOfAnyUploaded } from \"./e-shape-line-of-any-uploaded\";\n\nexport class EShapeLineOfTrianglesUploaded extends EShapeLineOfAnyUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateClippings();\n\t\tbuffer.updateIndices();\n\t\tconst clippings = buffer.clippings;\n\t\tconst indices = buffer.indices;\n\t\tconst voffset = this.vertexOffset;\n\t\tconst ioffset = this.indexOffset;\n\t\tconst pointCountReserved = this.pointCountReserved;\n\t\tif( 0 < pointCountReserved ) {\n\t\t\tbuildTriangleClipping(\n\t\t\t\tclippings,\n\t\t\t\tvoffset\n\t\t\t);\n\t\t\tcopyClipping(\n\t\t\t\tclippings,\n\t\t\t\tvoffset,\n\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\tpointCountReserved\n\t\t\t);\n\t\t\tbuildTriangleIndex(\n\t\t\t\tindices,\n\t\t\t\tvoffset,\n\t\t\t\tioffset\n\t\t\t);\n\t\t\tcopyIndex(\n\t\t\t\tindices,\n\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\tioffset,\n\t\t\t\tTRIANGLE_INDEX_COUNT,\n\t\t\t\tpointCountReserved\n\t\t\t);\n\t\t}\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tconst points = shape.points;\n\t\tif( points instanceof EShapeLineOfAnyPointsImpl ) {\n\t\t\tthis.updateVertexStepAndUvs( buffer, shape, points );\n\t\t\tthis.updateLineOfAnyColorFill( buffer, shape, points, TRIANGLE_VERTEX_COUNT );\n\t\t\tthis.updateLineOfAnyColorStroke( buffer, shape, points, TRIANGLE_VERTEX_COUNT );\n\t\t\tthis.updateText( buffer, shape );\n\t\t}\n\t}\n\n\tprotected updateVertexStepAndUvs( buffer: EShapeBuffer, shape: EShape, points: EShapeLineOfAnyPoints ) {\n\t\tconst pointId = points.id;\n\t\tconst pointOffset = points.offset;\n\t\tconst pointOffsetId = pointOffset.id;\n\t\tconst isPointChanged = ( pointId !== this.pointId || pointOffsetId !== this.pointOffsetId );\n\n\t\tconst pointSize = points.size;\n\t\tconst pointSizeId = pointSize.id;\n\t\tconst isPointSizeChanged = ( pointSizeId !== this.pointSizeId );\n\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isPointChanged || isPointSizeChanged || isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isTextureChanged ) {\n\t\t\tthis.pointId = pointId;\n\t\t\tthis.pointCount = points.length;\n\t\t\tthis.pointOffsetId = pointOffsetId;\n\t\t\tthis.pointSizeId = pointSizeId;\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Buffer\n\t\t\tbuffer.updateVertices();\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t}\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t}\n\n\t\t\tconst pointCount = this.pointCount;\n\t\t\tconst pointsValues = points.values;\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tconst vertices = buffer.vertices;\n\t\t\tconst steps = buffer.steps;\n\t\t\tconst clippings = buffer.clippings;\n\t\t\tconst uvs = buffer.uvs;\n\t\t\tconst textureUvs = this.toTextureUvs( texture );\n\t\t\tconst internalTransform = shape.transform.internalTransform;\n\t\t\tconst antialiasWeight = this.antialiasWeight;\n\t\t\tif( 0 < pointCount && pointSize.isStaticX() && pointSize.isStaticY() ) {\n\t\t\t\tconst pointSizeX = pointSize.getX( 0 );\n\t\t\t\tconst pointSizeY = pointSize.getY( 0 );\n\n\t\t\t\tbuildTriangleVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tvoffset,\n\t\t\t\t\t0, 0,\n\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\tstrokeAlign,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t\tcopyVertex(\n\t\t\t\t\tvertices,\n\t\t\t\t\tinternalTransform,\n\t\t\t\t\tvoffset, TRIANGLE_VERTEX_COUNT,\n\t\t\t\t\tpointCount, pointsValues,\n\t\t\t\t\tpointOffset\n\t\t\t\t);\n\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\tbuildTriangleStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tclippings,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyStep(\n\t\t\t\t\t\tsteps,\n\t\t\t\t\t\tvoffset, TRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\tbuildTriangleUv(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tcopyUvs(\n\t\t\t\t\t\tuvs,\n\t\t\t\t\t\tvoffset,\n\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\tpointCount\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < pointCount; ++i ) {\n\t\t\t\t\tconst ip = i << 1;\n\t\t\t\t\tconst px = pointsValues[ ip     ] + pointOffset.getX( i );\n\t\t\t\t\tconst py = pointsValues[ ip + 1 ] + pointOffset.getY( i );\n\t\t\t\t\tconst pointSizeX = pointSize.getX( i );\n\t\t\t\t\tconst pointSizeY = pointSize.getY( i );\n\t\t\t\t\tconst iv = voffset + i * TRIANGLE_VERTEX_COUNT;\n\n\t\t\t\t\tbuildTriangleVertex(\n\t\t\t\t\t\tvertices,\n\t\t\t\t\t\tiv,\n\t\t\t\t\t\tpx, py,\n\t\t\t\t\t\tpointSizeX, pointSizeY,\n\t\t\t\t\t\tstrokeAlign,\n\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\tinternalTransform,\n\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t\t);\n\t\t\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t\t\tbuildTriangleStep(\n\t\t\t\t\t\t\tsteps,\n\t\t\t\t\t\t\tclippings,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\t\t\tstrokeWidth,\n\t\t\t\t\t\t\tantialiasWeight,\n\t\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\t\t\tbuildTriangleUv(\n\t\t\t\t\t\t\tuvs,\n\t\t\t\t\t\t\ttextureUvs,\n\t\t\t\t\t\t\tiv,\n\t\t\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Fill the rest\n\t\t\tconst pointCountReserved = this.pointCountReserved;\n\t\t\tconst voffsetReserved = voffset + pointCount * TRIANGLE_VERTEX_COUNT;\n\t\t\tconst vcountReserved = TRIANGLE_VERTEX_COUNT * (pointCountReserved - pointCount);\n\t\t\tbuildNullVertex(\n\t\t\t\tvertices,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullStep(\n\t\t\t\tsteps,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t\tbuildNullUv(\n\t\t\t\tuvs,\n\t\t\t\tvoffsetReserved,\n\t\t\t\tvcountReserved\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TRIANGLE_INDEX_COUNT, TRIANGLE_VERTEX_COUNT } from \"./build-triangle\";\nimport { createLineOfAnyUploaded } from \"./create-line-of-any-uploaded\";\nimport { EShapeLineOfTrianglesUploaded } from \"./e-shape-line-of-triangles-uploaded\";\n\nexport const createLineOfTrianglesUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeLineOfTrianglesUploaded | null => {\n\treturn createLineOfAnyUploaded(\n\t\tbuffer, shape,\n\t\tvoffset, TRIANGLE_VERTEX_COUNT,\n\t\tioffset, TRIANGLE_INDEX_COUNT,\n\t\tantialiasWeight,\n\t\tEShapeLineOfTrianglesUploaded\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeBase } from \"./e-shape-base\";\nimport { EShapeLineOfAny } from \"./e-shape-line-of-any\";\nimport {\n\tEShapeLineOfAnyPoints, EShapeLineOfAnyPointsHitTester,\n\tEShapeLineOfAnyPointsTestRange, EShapeLineOfAnyPointsToHitThreshold\n} from \"./e-shape-line-of-any-points\";\nimport { EShapeLineOfAnyPointsImpl } from \"./e-shape-line-of-any-points-impl\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\nimport { toHitThreshold } from \"./to-hit-threshold\";\n\nexport class EShapeLineOfTriangles extends EShapeTriangle implements EShapeLineOfAny {\n\tprotected declare _points: EShapeLineOfAnyPoints;\n\tprotected _tester: EShapeLineOfAnyPointsHitTester<unknown>;\n\tprotected _testerBBox: EShapeLineOfAnyPointsHitTester<unknown>;\n\n\tconstructor( other?: EShapeLineOfTriangles ) {\n\t\tsuper( EShapeType.LINE_OF_TRIANGLES );\n\t\tif( other ) {\n\t\t\tthis.copy( other );\n\t\t} else {\n\t\t\tthis._points = new EShapeLineOfAnyPointsImpl( this );\n\t\t}\n\n\t\tthis._tester = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbs( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\n\t\tthis._testerBBox = ( x, y, ax, ay, ox, oy, px, py ): boolean => {\n\t\t\treturn this.containsPointAbsBBox( x, y, ax, ay, ox, oy, px, py );\n\t\t};\n\t}\n\n\tget points(): EShapeLineOfAnyPoints {\n\t\treturn this._points;\n\t}\n\n\tclone(): EShapeLineOfTriangles {\n\t\treturn new EShapeLineOfTriangles( this );\n\t}\n\n\tcontainsAbs( x: number, y: number, ax: number, ay: number ): boolean {\n\t\tconst threshold = toHitThreshold( this, null );\n\t\tif( this.containsAbsBBox( x, y, ax + threshold, ay + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\tx, y,\n\t\t\t\tthreshold,\n\t\t\t\tnull,\n\t\t\t\tthis._tester,\n\t\t\t\tnull\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontainsPointAbs(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbs( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcontainsPointAbsBBox(\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number\n\t): boolean {\n\t\treturn super.containsAbsBBox( x - px - ox, y - py - oy, ax, ay );\n\t}\n\n\tcalcHitPoint<RESULT>(\n\t\tpoint: IPoint,\n\t\ttoThreshold: EShapeLineOfAnyPointsToHitThreshold | null,\n\t\trange: EShapeLineOfAnyPointsTestRange | null,\n\t\ttester: EShapeLineOfAnyPointsHitTester<RESULT> | null,\n\t\tresult: RESULT\n\t): boolean {\n\t\tconst rect = this.toLocalRect( point, EShapeBase.WORK_RECT );\n\t\tconst threshold = toHitThreshold( this, toThreshold );\n\t\tif( this.containsAbsBBox( rect.x, rect.y, rect.width + threshold, rect.height + threshold ) ) {\n\t\t\treturn this._points.calcHitPointAbs(\n\t\t\t\trect.x, rect.y,\n\t\t\t\tthreshold,\n\t\t\t\trange,\n\t\t\t\ttester || this._tester,\n\t\t\t\tresult\n\t\t\t);\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeLineOfTriangles } from \"./e-shape-line-of-triangles\";\n\nexport const deserializeLineOfTriangles = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeLineOfTriangles> | EShapeLineOfTriangles => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeLineOfTriangles() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createLineOfTrianglesUploaded } from \"../variant/create-line-of-triangles-uploaded\";\nimport { deserializeLineOfTriangles } from \"../variant/deserialize-line-of-triangles\";\n\nexport const loadShapeLineOfTriangles = () => {\n\tEShapeUploadeds[ EShapeType.LINE_OF_TRIANGLES ] = createLineOfTrianglesUploaded;\n\tEShapeDeserializers[ EShapeType.LINE_OF_TRIANGLES ] = deserializeLineOfTriangles;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeUploadedBase } from \"../e-shape-uploaded\";\n\nexport class EShapeNullUploaded extends EShapeUploadedBase {\n\tconstructor( buffer: EShapeBuffer, voffset: number, ioffset: number ) {\n\t\tsuper( buffer, voffset, ioffset, 0, 0, 1 );\n\t}\n\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\t\tthis.texture = shape.texture || Texture.WHITE;\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { EShapeNullUploaded } from \"./e-shape-null-uploaded\";\n\nexport const createNullUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number\n): EShapeNullUploaded | null => {\n\treturn new EShapeNullUploaded(\n\t\tbuffer,\n\t\tvoffset, ioffset\n\t).init( shape );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapePrimitive } from \"./e-shape-primitive\";\n\nexport class EShapeNull extends EShapePrimitive {\n\tconstructor( type: EShapeType = EShapeType.NULL ) {\n\t\tsuper( type );\n\t}\n\n\tclone(): EShapeNull {\n\t\treturn new EShapeNull().copy( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeNull } from \"./e-shape-null\";\n\nexport const deserializeNull = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeNull> | EShapeNull => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeNull() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createNullUploaded } from \"../variant/create-null-uploaded\";\nimport { deserializeNull } from \"../variant/deserialize-null\";\n\nexport const loadShapeNull = () => {\n\tEShapeUploadeds[ EShapeType.NULL ] = createNullUploaded;\n\tEShapeDeserializers[ EShapeType.NULL ] = deserializeNull;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeRectangle } from \"./e-shape-rectangle\";\n\nexport const deserializeRectangle = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeRectangle> | EShapeRectangle => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeRectangle() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../e-shape-capabilities\";\nimport { EShapeCapability } from \"../e-shape-capability\";\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createRectangleUploaded } from \"../variant/create-rectangle-uploaded\";\nimport { deserializeRectangle } from \"../variant/deserialize-rectangle\";\n\nexport const loadShapeRectangle = () => {\n\tEShapeUploadeds[ EShapeType.RECTANGLE ] = createRectangleUploaded;\n\tEShapeDeserializers[ EShapeType.RECTANGLE ] = deserializeRectangle;\n\tEShapeCapabilities.set(\n\t\tEShapeType.RECTANGLE,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildRectangleRoundedClipping, buildRectangleRoundedIndex, buildRectangleRoundedStep,\n\tbuildRectangleRoundedUv, buildRectangleRoundedVertex, RECTANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-rectangle-rounded\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeRectangleRoundedUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateIndices();\n\t\tbuildRectangleRoundedIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexClippingStepAndUv( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexClippingStepAndUv( buffer: EShapeBuffer, shape: EShape ) {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst radius = shape.radius;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY || radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst strokeSide = stroke.side;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign ||\n\t\t\tthis.strokeWidth !== strokeWidth || this.strokeSide !== strokeSide );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( corner !== this.corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeSide = strokeSide;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\t// Vertices\n\t\t\tconst voffset = this.vertexOffset;\n\t\t\tbuffer.updateVertices();\n\t\t\tbuildRectangleRoundedVertex(\n\t\t\t\tbuffer.vertices, voffset,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign, strokeWidth, radius,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t);\n\n\t\t\t// Steps\n\t\t\tif( isVertexChanged || isCornerChanged || isTransformChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t\tbuildRectangleRoundedStep(\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tstrokeWidth, strokeSide,\n\t\t\t\t\tcorner,\n\t\t\t\t\tthis.antialiasWeight,\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// Clippings\n\t\t\tif( isVertexChanged || isCornerChanged ) {\n\t\t\t\tbuffer.updateClippings();\n\t\t\t\tbuildRectangleRoundedClipping(\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tcorner,\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\n\t\t\t// UVs\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t\tbuildRectangleRoundedUv(\n\t\t\t\t\tbuffer.uvs,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\t\tRECTANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { RECTANGLE_ROUNDED_INDEX_COUNT, RECTANGLE_ROUNDED_VERTEX_COUNT } from \"./build-rectangle-rounded\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { EShapeRectangleRoundedUploaded } from \"./e-shape-rectangle-rounded-uploaded\";\n\nexport const createRectangleRoundedUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeRectangleRoundedUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = RECTANGLE_ROUNDED_VERTEX_COUNT + tvcount;\n\tconst icount = RECTANGLE_ROUNDED_INDEX_COUNT + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeRectangleRoundedUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeRectangleRounded } from \"./e-shape-rectangle-rounded\";\n\nexport const deserializeRectangleRounded = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeRectangleRounded> | EShapeRectangleRounded => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeRectangleRounded() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../e-shape-capabilities\";\nimport { EShapeCapability } from \"../e-shape-capability\";\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createRectangleRoundedUploaded } from \"../variant/create-rectangle-rounded-uploaded\";\nimport { deserializeRectangleRounded } from \"../variant/deserialize-rectangle-rounded\";\n\nexport const loadShapeRectangleRounded = () => {\n\tEShapeUploadeds[ EShapeType.RECTANGLE_ROUNDED ] = createRectangleRoundedUploaded;\n\tEShapeDeserializers[ EShapeType.RECTANGLE_ROUNDED ] = deserializeRectangleRounded;\n\tEShapeCapabilities.set(\n\t\tEShapeType.RECTANGLE_ROUNDED,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildTriangleClipping, buildTriangleIndex, buildTriangleStep, buildTriangleUv,\n\tbuildTriangleVertex, TRIANGLE_VERTEX_COUNT, TRIANGLE_WORLD_SIZE\n} from \"./build-triangle\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeTriangleUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateClippings();\n\t\tbuffer.updateIndices();\n\t\tbuildTriangleClipping(\n\t\t\tbuffer.clippings,\n\t\t\tthis.vertexOffset\n\t\t);\n\t\tbuildTriangleIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexStepAndUv( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexStepAndUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isSizeChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isTextureChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\tconst voffset = this.vertexOffset;\n\n\t\t\tbuffer.updateVertices();\n\t\t\tbuildTriangleVertex(\n\t\t\t\tbuffer.vertices,\n\t\t\t\tvoffset,\n\t\t\t\t0, 0,\n\t\t\t\tsizeX, sizeY,\n\t\t\t\tstrokeAlign,\n\t\t\t\tstrokeWidth,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t);\n\n\t\t\tif( isVertexChanged || isTransformChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t\tbuildTriangleStep(\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tTRIANGLE_VERTEX_COUNT,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tthis.antialiasWeight,\n\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t\tbuildTriangleUv(\n\t\t\t\t\tbuffer.uvs,\n\t\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\t\tvoffset,\n\t\t\t\t\tTRIANGLE_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { TRIANGLE_INDEX_COUNT, TRIANGLE_VERTEX_COUNT } from \"./build-triangle\";\nimport { EShapeTriangleUploaded } from \"./e-shape-triangle-uploaded\";\n\nexport const createTriangleUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeTriangleUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = TRIANGLE_VERTEX_COUNT + tvcount;\n\tconst icount = TRIANGLE_INDEX_COUNT + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeTriangleUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeTriangle } from \"./e-shape-triangle\";\n\nexport const deserializeTriangle = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeTriangle> | EShapeTriangle => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeTriangle() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createTriangleUploaded } from \"../variant/create-triangle-uploaded\";\nimport { deserializeTriangle } from \"../variant/deserialize-triangle\";\n\nexport const loadShapeTriangle = () => {\n\tEShapeUploadeds[ EShapeType.TRIANGLE ] = createTriangleUploaded;\n\tEShapeDeserializers[ EShapeType.TRIANGLE ] = deserializeTriangle;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport {\n\tbuildTriangleRoundedClipping, buildTriangleRoundedIndex, buildTriangleRoundedStep,\n\tbuildTriangleRoundedUv, buildTriangleRoundedVertex, TRIANGLE_ROUNDED_WORLD_SIZE\n} from \"./build-triangle-rounded\";\nimport { EShapeTextUploaded } from \"./e-shape-text-uploaded\";\n\nexport class EShapeTriangleRoundedUploaded extends EShapeTextUploaded {\n\tinit( shape: EShape ): this {\n\t\tsuper.init( shape );\n\n\t\t// Indices\n\t\tconst buffer = this.buffer;\n\t\tbuffer.updateIndices();\n\t\tbuildTriangleRoundedIndex(\n\t\t\tbuffer.indices,\n\t\t\tthis.vertexOffset,\n\t\t\tthis.indexOffset\n\t\t);\n\n\t\t// Text\n\t\tthis.initText();\n\n\t\tthis.update( shape );\n\t\treturn this;\n\t}\n\n\tupdate( shape: EShape ): void {\n\t\tconst buffer = this.buffer;\n\t\tthis.updateVertexClippingStepAndUv( buffer, shape );\n\t\tthis.updateColor( buffer, shape );\n\t\tthis.updateText( buffer, shape );\n\t}\n\n\tprotected updateVertexClippingStepAndUv( buffer: EShapeBuffer, shape: EShape ): void {\n\t\tconst size = shape.size;\n\t\tconst sizeX = size.x;\n\t\tconst sizeY = size.y;\n\t\tconst isSizeChanged = ( sizeX !== this.sizeX || sizeY !== this.sizeY );\n\n\t\tconst radius = shape.radius;\n\t\tconst isRadiusChanged = ( radius !== this.radius );\n\n\t\tconst transformLocalId = this.toTransformLocalId( shape );\n\t\tconst isTransformChanged = ( this.transformLocalId !== transformLocalId );\n\n\t\tconst stroke = shape.stroke;\n\t\tconst strokeWidth = (stroke.enable ? stroke.width : 0);\n\t\tconst strokeAlign = stroke.align;\n\t\tconst isStrokeChanged = ( this.strokeAlign !== strokeAlign || this.strokeWidth !== strokeWidth );\n\n\t\tconst corner = shape.corner;\n\t\tconst isCornerChanged = ( corner !== this.corner );\n\n\t\tconst texture = this.toTexture( shape );\n\t\tconst textureTransformId = this.toTextureTransformId( texture );\n\t\tconst isTextureChanged = ( texture !== this.texture || textureTransformId !== this.textureTransformId );\n\n\t\tconst isVertexChanged = isSizeChanged || isRadiusChanged || isStrokeChanged;\n\n\t\tif( isVertexChanged || isTransformChanged || isCornerChanged || isTextureChanged ) {\n\t\t\tthis.sizeX = sizeX;\n\t\t\tthis.sizeY = sizeY;\n\t\t\tthis.radius = radius;\n\t\t\tthis.transformLocalId = transformLocalId;\n\t\t\tthis.strokeWidth = strokeWidth;\n\t\t\tthis.strokeAlign = strokeAlign;\n\t\t\tthis.corner = corner;\n\t\t\tthis.texture = texture;\n\t\t\tthis.textureTransformId = textureTransformId;\n\n\t\t\tif( isSizeChanged || isTransformChanged || isStrokeChanged ) {\n\t\t\t\t// Invalidate the text layout to update the text layout.\n\t\t\t\tthis.textSpacingHorizontal = NaN;\n\t\t\t}\n\n\t\t\tconst voffset = this.vertexOffset;\n\n\t\t\tbuffer.updateVertices();\n\t\t\tbuildTriangleRoundedVertex(\n\t\t\t\tbuffer.vertices,\n\t\t\t\tvoffset,\n\t\t\t\t0,\n\t\t\t\t0,\n\t\t\t\tsizeX,\n\t\t\t\tsizeY,\n\t\t\t\tstrokeAlign,\n\t\t\t\tstrokeWidth,\n\t\t\t\tradius,\n\t\t\t\tshape.transform.internalTransform,\n\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t);\n\n\t\t\tif( isRadiusChanged || isCornerChanged ) {\n\t\t\t\tbuffer.updateClippings();\n\t\t\t\tbuildTriangleRoundedClipping(\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tcorner,\n\t\t\t\t\tradius\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif( isVertexChanged || isTransformChanged || isCornerChanged ) {\n\t\t\t\tbuffer.updateSteps();\n\t\t\t\tbuildTriangleRoundedStep(\n\t\t\t\t\tbuffer.steps,\n\t\t\t\t\tbuffer.clippings,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tstrokeWidth,\n\t\t\t\t\tshape.radius,\n\t\t\t\t\tthis.antialiasWeight,\n\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tif( isVertexChanged || isTextureChanged ) {\n\t\t\t\tbuffer.updateUvs();\n\t\t\t\tbuildTriangleRoundedUv(\n\t\t\t\t\tbuffer.uvs,\n\t\t\t\t\tvoffset,\n\t\t\t\t\tthis.toTextureUvs( texture ),\n\t\t\t\t\tradius,\n\t\t\t\t\tTRIANGLE_ROUNDED_WORLD_SIZE\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"../e-shape\";\nimport { EShapeBuffer } from \"../e-shape-buffer\";\nimport { TEXT_INDEX_COUNT, TEXT_VERTEX_COUNT, toTextBufferCount } from \"./build-text\";\nimport { TRIANGLE_ROUNDED_INDEX_COUNT, TRIANGLE_ROUNDED_VERTEX_COUNT } from \"./build-triangle-rounded\";\nimport { EShapeTriangleRoundedUploaded } from \"./e-shape-triangle-rounded-uploaded\";\n\nexport const createTriangleRoundedUploaded = (\n\tbuffer: EShapeBuffer, shape: EShape,\n\tvoffset: number, ioffset: number,\n\tantialiasWeight: number\n): EShapeTriangleRoundedUploaded | null => {\n\tconst tcount = toTextBufferCount( shape );\n\tconst tvcount = tcount * TEXT_VERTEX_COUNT;\n\tconst ticount = tcount * TEXT_INDEX_COUNT;\n\tconst vcount = TRIANGLE_ROUNDED_VERTEX_COUNT + tvcount;\n\tconst icount = TRIANGLE_ROUNDED_INDEX_COUNT + ticount;\n\tif( buffer.check( voffset, ioffset, vcount, icount ) ) {\n\t\treturn new EShapeTriangleRoundedUploaded(\n\t\t\tbuffer,\n\t\t\tvoffset, ioffset,\n\t\t\ttvcount, ticount,\n\t\t\tvcount, icount,\n\t\t\tantialiasWeight\n\t\t).init( shape );\n\t}\n\treturn null;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem } from \"../../d-diagram-serialized\";\nimport { EShapeDeserializer } from \"../e-shape-deserializer\";\nimport { EShapeResourceManagerDeserialization } from \"../e-shape-resource-manager-deserialization\";\nimport { EShapeTriangleRounded } from \"./e-shape-triangle-rounded\";\n\nexport const deserializeTriangleRounded = (\n\titem: DDiagramSerializedItem, manager: EShapeResourceManagerDeserialization\n): Promise<EShapeTriangleRounded> | EShapeTriangleRounded => {\n\treturn EShapeDeserializer.deserialize( item, manager, new EShapeTriangleRounded() );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeCapabilities } from \"../e-shape-capabilities\";\nimport { EShapeCapability } from \"../e-shape-capability\";\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createTriangleRoundedUploaded } from \"../variant/create-triangle-rounded-uploaded\";\nimport { deserializeTriangleRounded } from \"../variant/deserialize-triangle-rounded\";\n\nexport const loadShapeTriangleRounded = () => {\n\tEShapeUploadeds[ EShapeType.TRIANGLE_ROUNDED ] = createTriangleRoundedUploaded;\n\tEShapeDeserializers[ EShapeType.TRIANGLE_ROUNDED ] = deserializeTriangleRounded;\n\tEShapeCapabilities.set(\n\t\tEShapeType.TRIANGLE_ROUNDED,\n\t\tEShapeCapability.PRIMITIVE | EShapeCapability.STROKE_SIDE | EShapeCapability.BORDER_RADIUS\n\t);\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadShapeBar } from \"./load-shape-bar\";\nimport { loadShapeCircle } from \"./load-shape-circle\";\nimport { loadShapeEmbedded } from \"./load-shape-embedded\";\nimport { loadShapeGroup } from \"./load-shape-group\";\nimport { loadShapeGroupShadowed } from \"./load-shape-group-shadowed\";\nimport { loadShapeImage } from \"./load-shape-image\";\nimport { loadShapeImageSdf } from \"./load-shape-image-sdf\";\nimport { loadShapeLabel } from \"./load-shape-label\";\nimport { loadShapeLine } from \"./load-shape-line\";\nimport { loadShapeLineOfCircles } from \"./load-shape-line-of-circles\";\nimport { loadShapeLineOfRectangleRoundeds } from \"./load-shape-line-of-rectangle-roundeds\";\nimport { loadShapeLineOfRectangles } from \"./load-shape-line-of-rectangles\";\nimport { loadShapeLineOfTriangleRoundeds } from \"./load-shape-line-of-triangle-roundeds\";\nimport { loadShapeLineOfTriangles } from \"./load-shape-line-of-triangles\";\nimport { loadShapeNull } from \"./load-shape-null\";\nimport { loadShapeRectangle } from \"./load-shape-rectangle\";\nimport { loadShapeRectangleRounded } from \"./load-shape-rectangle-rounded\";\nimport { loadShapeTriangle } from \"./load-shape-triangle\";\nimport { loadShapeTriangleRounded } from \"./load-shape-triangle-rounded\";\n\nexport const loadShapeAll = () => {\n\tloadShapeBar();\n\tloadShapeCircle();\n\tloadShapeEmbedded();\n\tloadShapeGroupShadowed();\n\tloadShapeGroup();\n\tloadShapeImage();\n\tloadShapeImageSdf();\n\tloadShapeLabel();\n\tloadShapeLine();\n\tloadShapeNull();\n\tloadShapeRectangleRounded();\n\tloadShapeRectangle();\n\tloadShapeTriangleRounded();\n\tloadShapeTriangle();\n\tloadShapeLineOfCircles();\n\tloadShapeLineOfRectangleRoundeds();\n\tloadShapeLineOfRectangles();\n\tloadShapeLineOfTriangleRoundeds();\n\tloadShapeLineOfTriangles();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeDeserializers } from \"../e-shape-deserializers\";\nimport { EShapeType } from \"../e-shape-type\";\nimport { EShapeUploadeds } from \"../e-shape-uploadeds\";\nimport { createImageSdfUploaded } from \"../variant/create-image-sdf-uploaded\";\nimport { deserializeImageSdf } from \"../variant/deserialize-image-sdf\";\n\nexport const loadShapeImageSdf = () => {\n\tEShapeUploadeds[ EShapeType.IMAGE_SDF ] = createImageSdfUploaded;\n\tEShapeDeserializers[ EShapeType.IMAGE_SDF ] = deserializeImageSdf;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\n\nexport interface DImageOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeImage<VALUE> = DThemeImage<VALUE>\n> extends DImageBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeImage<VALUE = unknown> extends DThemeImageBase<VALUE> {\n\n}\n\nexport class DImage<\n\tVALUE = unknown,\n\tTHEME extends DThemeImage<VALUE> = DThemeImage<VALUE>,\n\tOPTIONS extends DImageOptions<VALUE, THEME> = DImageOptions<VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DImage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DListItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeListItem = DThemeListItem\n> extends DImageOptions<string, THEME> {\n\tvalue?: VALUE;\n}\n\nexport interface DThemeListItem extends DThemeImage<string> {\n\n}\n\nexport interface DListItemSelection {\n\tadd( item: DBase ): void;\n}\n\nexport class DListItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeListItem = DThemeListItem,\n\tOPTIONS extends DListItemOptions<VALUE, THEME> = DListItemOptions<VALUE, THEME>\n> extends DImage<string, THEME, OPTIONS> {\n\tprotected _value: VALUE | null;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._value = options?.value ?? null;\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\t\tthis.initOnClick( options );\n\t}\n\n\tprotected initOnClick( options?: OPTIONS ): void {\n\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.state.isActionable ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tget value(): VALUE | null {\n\t\treturn this._value;\n\t}\n\n\tset value( value: VALUE | null ) {\n\t\tthis._value = value;\n\t}\n\n\tprotected hasSelection( target: any ): target is { selection: DListItemSelection } {\n\t\treturn ( target && target.selection && target.selection.add );\n\t}\n\n\tprotected getSelection(): DListItemSelection | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( this.hasSelection( parent ) ) {\n\t\t\t\treturn parent.selection;\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tthis.emit( \"select\", this );\n\t\tconst selection = this.getSelection();\n\t\tif( selection ) {\n\t\t\tselection.add( this );\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onKeyDownActivate( e );\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onKeyDownActivate( e: KeyboardEvent ): boolean {\n\t\tif( this.state.isActionable && this.state.isFocused ) {\n\t\t\tthis.onSelect( e );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DListItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\n\nexport interface DMenuItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItem = DThemeMenuItem\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItem extends DThemeListItem {\n\n}\n\nexport class DMenuItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItem = DThemeMenuItem,\n\tOPTIONS extends DMenuItemOptions<VALUE, THEME> = DMenuItemOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tgetContext(): DMenuContext | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( parent.getContext ) {\n\t\t\t\treturn parent.getContext();\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\tlet parent = this.parent as any;\n\t\twhile( parent ) {\n\t\t\tif( parent.getCloseable ) {\n\t\t\t\treturn parent.getCloseable();\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Text } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DDynamicText } from \"./d-dynamic-text\";\nimport { DMenuItem, DMenuItemOptions, DThemeMenuItem } from \"./d-menu-item\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemTextOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText\n> extends DMenuItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemText extends DThemeMenuItem {\n\tgetShortcutTextMargin(): number;\n\tgetShortcutColor( state: DBaseStateSet ): number;\n\tgetShortcutAlpha( state: DBaseStateSet ): number;\n}\n\nexport class DMenuItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItem<VALUE, THEME, OPTIONS> {\n\tprotected _shortcutText?: Text | DDynamicText | null;\n\tprotected _shortcutMargin?: number;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.initOnOver( options );\n\t\tthis.initShortcuts( options );\n\t}\n\n\tprotected initOnOver( options?: OPTIONS ): void {\n\t\tthis.on( UtilPointerEvent.over, (): void => {\n\t\t\tconst context = this.getContext();\n\t\t\tif( context != null ) {\n\t\t\t\tconst parent = this.parent;\n\t\t\t\tif( parent instanceof DBase ) {\n\t\t\t\t\tcontext.trim( this.getCloseable() );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected initShortcuts( options?: OPTIONS ): void {\n\t\tconst shortcuts = this._shortcuts;\n\t\tif( shortcuts != null && 0 < shortcuts.length ) {\n\t\t\tconst shortcut = shortcuts[ 0 ];\n\t\t\tconst shortcutTextValue = UtilKeyboardEvent.toString( shortcut );\n\t\t\tthis._shortcutText = this.createText( shortcutTextValue );\n\t\t\tthis.addRenderable( this._shortcutText, true );\n\t\t} else {\n\t\t\tthis._shortcutText = null;\n\t\t}\n\n\t\tthis._shortcutMargin = this.theme.getShortcutTextMargin();\n\t}\n\n\tprotected updateShortcutText(): void {\n\t\tconst text = this._shortcutText;\n\t\tconst margin = this._shortcutMargin;\n\t\tif( text != null && margin != null ) {\n\t\t\tconst toRounded = this.toRounded;\n\t\t\ttext.position.set(\n\t\t\t\ttoRounded( this.width - margin - text.width ),\n\t\t\t\ttoRounded( ( this.height - text.height ) * 0.5 )\n\t\t\t);\n\t\t}\n\t}\n\n\tprotected updateTextColor( text: DDynamicText | Text ): void {\n\t\tsuper.updateTextColor( text );\n\n\t\tconst shortcutText = this._shortcutText;\n\t\tif( shortcutText != null ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst state = this.state;\n\t\t\tshortcutText.style.fill = theme.getShortcutColor( state );\n\t\t\tshortcutText.alpha = theme.getShortcutAlpha( state );\n\t\t}\n\t}\n\n\tprotected updateText(): void {\n\t\tsuper.updateText();\n\t\tthis.updateShortcutText();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemText\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tsuper.onSelect( e );\n\t\tconst closeable = this.getCloseable();\n\t\tif( closeable != null ) {\n\t\t\tcloseable.emit( \"select\", this.value, this, closeable );\n\t\t}\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ) {\n\t\tsuper.onShortcut( e );\n\t\tthis.onSelect( e );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport interface DMenuItemCheckOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck\n> extends DMenuItemTextOptions<VALUE, THEME> {\n\tcheck: boolean;\n}\n\nexport interface DThemeMenuItemCheck extends DThemeMenuItemText {\n\n}\n\nexport class DMenuItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tif( options && options.check ) {\n\t\t\tthis.state.isActive = true;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemCheck\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tthis.state.isActive = ! this.state.isActive;\n\t\tsuper.onSelect( e );\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemCheckOptions<VALUE> {\n\t\treturn \"check\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport type DMenuItemCreator = ( options: DMenuItemOptionsUnion<any>, sticky: boolean ) => DisplayObject | null;\n\nexport type DMenuMenuCreator = ( options?: DMenuOptions ) => DMenu<any>;\n\nexport class DMenus {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\tprotected static MENU_CREATOR?: DMenuMenuCreator;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic setMenuCreator( creator: DMenuMenuCreator ): void {\n\t\tthis.MENU_CREATOR = creator;\n\t}\n\n\tstatic newItemOf<VALUE>(\n\t\tcreators: DMenuItemCreator[],\n\t\tcreatorDefault: DMenuItemCreator | null,\n\t\toptions: DMenuItemOptionsUnion<VALUE>,\n\t\tsticky: boolean\n\t): DisplayObject | null {\n\t\tfor( let i = 0, imax = creators.length; i < imax; ++i ) {\n\t\t\tconst created = creators[ i ]( options, sticky );\n\t\t\tif( created != null ) {\n\t\t\t\treturn created;\n\t\t\t}\n\t\t}\n\t\tif( creatorDefault ) {\n\t\t\treturn creatorDefault( options, sticky );\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn this.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky );\n\t}\n\n\tstatic newItemsOf<VALUE>(\n\t\tcreator: { newItem( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null },\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject | null | undefined>,\n\t\tsticky: boolean\n\t): void {\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DisplayObject ) {\n\t\t\t\tparent.addChild( item );\n\t\t\t} else if( item != null ) {\n\t\t\t\tconst created = creator.newItem( item, sticky );\n\t\t\t\tif( created != null ) {\n\t\t\t\t\tparent.addChild( created );\n\t\t\t\t} else {\n\t\t\t\t\tthrow new Error( `No matching menu item creator found: ${JSON.stringify( item )}` );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject | null | undefined>,\n\t\tsticky: boolean\n\t): void {\n\t\tthis.newItemsOf( this, parent, items, sticky );\n\t}\n\n\tstatic newMenu<VALUE>( options?: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\tif( this.MENU_CREATOR != null ) {\n\t\t\treturn this.MENU_CREATOR( options );\n\t\t} else {\n\t\t\tthrow new Error( \"Missing DMenu creator.\" );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DLinkTarget {\n\tAUTO,\n\tTHIS_WINDOW,\n\tNEW_WINDOW\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DLinkMenuItemId } from \"./d-link-menu-item-id\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenus } from \"./d-menus\";\n\nexport type DLinkMenuOptions = DMenuOptions<DLinkMenuItemId> | DMenu<DLinkMenuItemId>;\n\nexport interface DLinkMenuParent {\n\tcopy(): void;\n\topen( inNewWindow: boolean ): void;\n}\n\nexport class DLinkMenu {\n\tprotected _parent: DLinkMenuParent;\n\tprotected _menu?: DMenu<DLinkMenuItemId>;\n\tprotected _options: DMenuOptions<DLinkMenuItemId> | DMenu<DLinkMenuItemId>;\n\tprotected _isEnabled: boolean;\n\n\tconstructor( parent: DLinkMenuParent, options: DLinkMenuOptions ) {\n\t\tthis._parent = parent;\n\t\tthis._options = options;\n\t\tthis._isEnabled = true;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tthis._isEnabled = enable;\n\t}\n\n\topen( target: DBase ): void {\n\t\tthis.get().open( target );\n\t}\n\n\tget(): DMenu<DLinkMenuItemId> {\n\t\tlet result = this._menu;\n\t\tif( result == null ) {\n\t\t\tresult = this.toMenu( this._options );\n\t\t\tthis._menu = result;\n\t\t\tresult.on( \"select\", (\n\t\t\t\tvalue: DLinkMenuItemId,\n\t\t\t\titem: DMenuItem<DLinkMenuItemId>,\n\t\t\t\tmenu: DMenu<DLinkMenuItemId>\n\t\t\t): void => {\n\t\t\t\tthis.onSelect( value, item, menu );\n\t\t\t});\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected toMenu( options: DMenuOptions<DLinkMenuItemId> | DMenu<DLinkMenuItemId> ): DMenu<DLinkMenuItemId> {\n\t\tif( options instanceof DisplayObject ) {\n\t\t\treturn options;\n\t\t}\n\t\treturn this.newMenu( options );\n\t}\n\n\tprotected newMenu( options: DMenuOptions<DLinkMenuItemId> ): DMenu<DLinkMenuItemId> {\n\t\treturn DMenus.newMenu( options );\n\t}\n\n\tprotected onSelect(\n\t\tvalue: DLinkMenuItemId,\n\t\titem: DMenuItem<DLinkMenuItemId>,\n\t\tmenu: DMenu<DLinkMenuItemId>\n\t): void {\n\t\tconst parent = this._parent;\n\t\tswitch( value ) {\n\t\tcase DLinkMenuItemId.OPEN_LINK_IN_NEW_WINDOW:\n\t\t\tparent.open( true );\n\t\t\tbreak;\n\t\tcase DLinkMenuItemId.COPY_LINK_ADDRESS:\n\t\t\tparent.copy();\n\t\t\tbreak;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\n\nconst getSelection = ( element: Element ): Selection | null => {\n\tconst selection = document.getSelection();\n\tif( selection ) {\n\t\tconst range = document.createRange();\n\t\trange.selectNodeContents( element );\n\t\tselection.removeAllRanges();\n\t\tselection.addRange( range );\n\t}\n\treturn selection;\n};\n\nconst toClipboardData = ( e: ClipboardEvent ): DataTransfer => {\n\treturn e.clipboardData || (window as any).clipboardData;\n};\n\nconst copyUsingDiv = ( text: string ): boolean => {\n\tconst div = document.createElement( \"div\" );\n\tdiv.setAttribute( \"style\", \"-webkit-user-select: text !important\" );\n\tdiv.textContent = \"Dummy\";\n\tdocument.body.appendChild( div );\n\tconst selection = getSelection( div );\n\tlet result = false;\n\tif( selection ) {\n\t\tconst handler = ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === div ) {\n\t\t\t\tconst clipboardData = toClipboardData( e );\n\t\t\t\tclipboardData.setData( \"text/plain\", text );\n\t\t\t\tresult = ( clipboardData.getData( \"text/plain\" ) === text );\n\t\t\t\te.preventDefault();\n\t\t\t}\n\t\t};\n\t\tdocument.addEventListener( \"copy\", handler );\n\t\ttry {\n\t\t\tdocument.execCommand( \"copy\" );\n\t\t} finally {\n\t\t\tdocument.removeEventListener( \"copy\", handler );\n\t\t}\n\t\tselection.removeAllRanges();\n\t}\n\tdocument.body.removeChild( div );\n\treturn result;\n};\n\nconst copyUsingSpan = ( text: string ): boolean => {\n\tconst div = document.createElement( \"div\" );\n\tdiv.setAttribute( \"style\", \"-webkit-user-select: text !important\" );\n\tconst span = document.createElement( \"span\" );\n\tspan.innerText = text;\n\tconst root: Node = ( div.attachShadow ? div.attachShadow({ mode: \"open\" }) : div );\n\troot.appendChild( span );\n\tdocument.body.appendChild( div );\n\tlet result = false;\n\tconst selection = getSelection( div );\n\tif( selection ) {\n\t\tresult = document.execCommand( \"copy\" );\n\t\tselection.removeAllRanges();\n\t}\n\tdocument.body.removeChild( div );\n\treturn result;\n};\n\nconst copyUsingWindow = ( window: Window, text: string ): boolean => {\n\tif( typeof ClipboardEvent === \"undefined\" ) {\n\t\tconst clipboardData = (window as any).clipboardData;\n\t\tif( typeof clipboardData !== \"undefined\" && typeof clipboardData.setData !== \"undefined\" ) {\n\t\t\tclipboardData.setData( \"Text\", text );\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n};\n\nexport class UtilClipboard extends utils.EventEmitter {\n\tconstructor() {\n\t\tsuper();\n\n\t\tconst element = document.body;\n\t\telement.addEventListener( \"copy\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"copy\", toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"cut\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"cut\", toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"paste\", ( e: ClipboardEvent ): void => {\n\t\t\tif( e.target === element ) {\n\t\t\t\te.preventDefault();\n\t\t\t\te.stopPropagation();\n\t\t\t\tthis.emit( \"paste\", toClipboardData( e ) );\n\t\t\t}\n\t\t});\n\t}\n\n\tstatic copy( text: string ): void {\n\t\tconst clipboard = navigator.clipboard;\n\t\tif( clipboard && clipboard.writeText ) {\n\t\t\tclipboard.writeText( text );\n\t\t} else {\n\t\t\tif( ! copyUsingWindow( window, text ) ) {\n\t\t\t\tif( ! copyUsingDiv( text ) ) {\n\t\t\t\t\tif( navigator.userAgent.indexOf( \"Edge\" ) < 0 ) {\n\t\t\t\t\t\tcopyUsingSpan( text );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedSnapTargetValue } from \"../d-diagram-serialized\";\n\nexport enum ESnapperTargetValueType {\n\tHORIZONTAL = 0,\n\tVERTICAL = 1\n}\n\nexport class ESnapperTargetValue {\n\ttype: ESnapperTargetValueType;\n\tposition: number;\n\n\tconstructor( type: ESnapperTargetValueType, position: number ) {\n\t\tthis.type = type;\n\t\tthis.position = position;\n\t}\n\n\tserialize(): DDiagramSerializedSnapTargetValue {\n\t\treturn [ this.type, this.position ];\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DLinkMenu } from \"./d-link-menu\";\nimport { DLinkMenuItemId } from \"./d-link-menu-item-id\";\nimport { DLinkTarget } from \"./d-link-target\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\nimport { toEnum } from \"./util/to-enum\";\nimport { UtilClipboard } from \"./util/util-clipboard\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport type DLinkUrlMaker = () => string | null | Promise<string | null>;\nexport type DLinkChecker = () => boolean | Promise<boolean>;\n\nexport interface DLinkOptions {\n\turl?: string | null | DLinkUrlMaker;\n\ttarget?: DLinkTarget | (keyof typeof DLinkTarget);\n\tchecker?: DLinkChecker;\n\tmenu?: DMenuOptions<DLinkMenuItemId> | DMenu<DLinkMenuItemId>;\n}\n\nexport interface DThemeLink {\n\tgetLinkMenuOptions(): DMenuOptions<DLinkMenuItemId>;\n}\n\nexport class DLink {\n\tprotected static ANCHOR_ELEMENT?: HTMLAnchorElement;\n\n\tprotected _url: string | null | DLinkUrlMaker;\n\tprotected _target: DLinkTarget;\n\tprotected _checker?: DLinkChecker;\n\tprotected _menu: DLinkMenu;\n\tprotected _theme: DThemeLink;\n\tprotected _isEnabled: boolean;\n\n\tconstructor( theme: DThemeLink, options?: DLinkOptions ) {\n\t\tthis._url = options?.url ?? null;\n\t\tthis._target = toEnum( options?.target ?? DLinkTarget.AUTO, DLinkTarget );\n\t\tthis._checker = options?.checker;\n\t\tthis._theme = theme;\n\t\tthis._isEnabled = true;\n\t\tthis._menu = new DLinkMenu( this, options?.menu ?? theme.getLinkMenuOptions() );\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tthis._isEnabled = enable;\n\t}\n\n\tget url(): string | null | DLinkUrlMaker {\n\t\treturn this._url;\n\t}\n\n\tset url( url: string | null | DLinkUrlMaker ) {\n\t\tthis._url = url;\n\t}\n\n\tget target(): DLinkTarget {\n\t\treturn this._target;\n\t}\n\n\tget menu(): DLinkMenu {\n\t\treturn this._menu;\n\t}\n\n\tprotected toStringifiedUrl( target: string | null | DLinkUrlMaker, onResolved: ( url: string ) => void ): void {\n\t\tconst url = ( isFunction( target ) ? target() : target );\n\t\tif( url != null ) {\n\t\t\tif( isString( url )  ) {\n\t\t\t\tonResolved( url );\n\t\t\t} else {\n\t\t\t\turl.then(( resolved: string | null ): void => {\n\t\t\t\t\tif( resolved != null ) {\n\t\t\t\t\t\tonResolved( resolved );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toNormalizedUrl( url: string ): string {\n\t\tconst a = DLink.ANCHOR_ELEMENT || document.createElement( \"a\" );\n\t\tDLink.ANCHOR_ELEMENT = a;\n\t\ta.href = url;\n\t\treturn a.href;\n\t}\n\n\t/**\n\t * Copys the URL to the clipboard.\n\t */\n\tcopy(): void {\n\t\tthis.toStringifiedUrl( this._url, ( url: string ): void => {\n\t\t\tUtilClipboard.copy( this.toNormalizedUrl( url ) );\n\t\t});\n\t}\n\n\t/**\n\t * Checks and opens the URL.\n\t *\n\t * @param e An event object which triggered this method call.\n\t */\n\topen( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void;\n\n\t/**\n\t * Checks and opens the URL.\n\t *\n\t * @param inNewWindow True to open in a new window\n\t */\n\topen( inNewWindow: boolean ): void;\n\topen( x: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent | undefined | boolean ): void {\n\t\tthis.toStringifiedUrl( this._url, ( url ): void => {\n\t\t\tconst inNewWindow = ( x === true || x === false ?\n\t\t\t\tx : this.inNewWindow( x )\n\t\t\t);\n\t\t\tthis.check( url, inNewWindow, (): void => {\n\t\t\t\tthis.exec( url, inNewWindow );\n\t\t\t});\n\t\t});\n\t}\n\n\tcheck( url: string, inNewWindow: boolean, onResolved: () => void ): void {\n\t\tconst checker = this._checker;\n\t\tif( checker ) {\n\t\t\tconst checked = checker();\n\t\t\tif( checked === true ) {\n\t\t\t\tonResolved();\n\t\t\t} else if( checked === false ) {\n\t\t\t\t// DO NOTHING\n\t\t\t} else {\n\t\t\t\tchecked.then(( resolved: boolean ): void => {\n\t\t\t\t\tif( resolved ) {\n\t\t\t\t\t\tonResolved();\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tonResolved();\n\t\t}\n\t}\n\n\t/**\n\t * Opens the given URL.\n\t *\n\t * @param url An URL to be opened\n\t * @param inNewWindow True to open in a new window.\n\t */\n\texec( url: string, inNewWindow: boolean ): void {\n\t\tif( inNewWindow ) {\n\t\t\tconst a = document.createElement( \"a\" );\n\t\t\ta.href = url;\n\t\t\ta.target = \"_blank\";\n\t\t\ta.style.display = \"none\";\n\t\t\ta.rel = \"noopener noreferrer\";\n\t\t\tdocument.body.appendChild( a );\n\t\t\ta.click();\n\t\t\tsetTimeout((): void => {\n\t\t\t\tdocument.body.removeChild( a );\n\t\t\t}, 100);\n\t\t} else {\n\t\t\twindow.location.href = url;\n\t\t}\n\t}\n\n\t/**\n\t * Returns true if the URL need to be opened in a new window.\n\t *\n\t * @param e An event object.\n\t */\n\tinNewWindow( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): boolean {\n\t\tswitch( this._target ) {\n\t\tcase DLinkTarget.NEW_WINDOW:\n\t\t\treturn true;\n\t\tcase DLinkTarget.THIS_WINDOW:\n\t\t\treturn false;\n\t\tcase DLinkTarget.AUTO:\n\t\t\tif( e != null ) {\n\t\t\t\tconst oe = ( e instanceof interaction.InteractionEvent ? e.data.originalEvent : e );\n\t\t\t\treturn (\n\t\t\t\t\t( oe.ctrlKey || oe.shiftKey || oe.altKey || oe.metaKey ) ||\n\t\t\t\t\t( \"button\" in oe && oe.button !== 0 )\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tapply( base: DBase, onSelect: ( e: interaction.InteractionEvent ) => void ): void {\n\t\tconst onClick = ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this._isEnabled && base.state.isActionable ) {\n\t\t\t\tonSelect( e );\n\t\t\t}\n\t\t};\n\t\tif( this._target === DLinkTarget.NEW_WINDOW ) {\n\t\t\tUtilPointerEvent.onClick( base, onClick );\n\t\t} else {\n\t\t\tconst menu = this._menu;\n\t\t\tconst onLongClick = ( e: interaction.InteractionEvent ): void => {\n\t\t\t\tif( this._isEnabled && base.state.isActionable ) {\n\t\t\t\t\tmenu.open( base );\n\t\t\t\t}\n\t\t\t};\n\t\t\tconst isLongClickable = ( e: interaction.InteractionEvent ): boolean => {\n\t\t\t\treturn menu.enable;\n\t\t\t};\n\t\t\tUtilPointerEvent.onLongClick( base, onClick, onLongClick, isLongClickable );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DLinkTarget } from \"./d-link-target\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DLinksStateOptions {\n\tstate?: string | string[];\n}\n\nexport class DLinks {\n\tstatic toStateOptions<OPTIONS extends DLinksStateOptions>(\n\t\ttarget?: DLinkTarget | (keyof typeof DLinkTarget),\n\t\toptions?: OPTIONS\n\t): OPTIONS | undefined {\n\t\tif( options ) {\n\t\t\tif( target === DLinkTarget.NEW_WINDOW || target === \"NEW_WINDOW\" ) {\n\t\t\t\tconst state = options.state;\n\t\t\t\tif( state == null ) {\n\t\t\t\t\toptions.state = DBaseState.NEW_WINDOW;\n\t\t\t\t} else if( isString( state ) ) {\n\t\t\t\t\tif( state !== DBaseState.NEW_WINDOW ) {\n\t\t\t\t\t\toptions.state = [ state, DBaseState.NEW_WINDOW ];\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( state.indexOf( DBaseState.NEW_WINDOW ) < 0 ) {\n\t\t\t\t\t\tstate.push( DBaseState.NEW_WINDOW );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DLink, DLinkChecker, DLinkOptions, DLinkUrlMaker, DThemeLink } from \"./d-link\";\nimport { DLinkMenuItemId } from \"./d-link-menu-item-id\";\nimport { DLinkTarget } from \"./d-link-target\";\nimport { DLinks } from \"./d-links\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\nimport { isString } from \"./util/is-string\";\n\nexport type DMenuItemLinkUrlMaker = ( item: DMenuItemLink ) => string | null | Promise<string | null>;\nexport type DMenuItemLinkChecker = ( item: DMenuItemLink ) => boolean | Promise<boolean>;\n\nexport interface DMenuItemLinkOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink\n> extends DMenuItemTextOptions<VALUE, THEME> {\n\turl?: string | DMenuItemLinkUrlMaker;\n\ttarget?: DLinkTarget | (keyof typeof DLinkTarget);\n\tchecker?: DMenuItemLinkChecker;\n\tmenu?: DMenuOptions<DLinkMenuItemId> | DMenu<DLinkMenuItemId>;\n}\n\nexport interface DThemeMenuItemLink extends DThemeMenuItemText, DThemeLink {\n\n}\n\nexport class DMenuItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected _link!: DLink;\n\n\tprotected toLinkOptions( options?: OPTIONS ): DLinkOptions | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\turl: this.toUrl( options.url ),\n\t\t\t\ttarget: options.target,\n\t\t\t\tchecker: this.toChecker( options.checker ),\n\t\t\t\tmenu: options.menu\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected toUrl( url?: string | DMenuItemLinkUrlMaker ): string | DLinkUrlMaker | undefined {\n\t\tif( isString( url ) || url == null ) {\n\t\t\treturn url;\n\t\t} else {\n\t\t\treturn () => {\n\t\t\t\treturn url( this );\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toChecker( checker?: DMenuItemLinkChecker ): DLinkChecker | undefined {\n\t\tif( checker != null ) {\n\t\t\treturn () => {\n\t\t\t\treturn checker( this );\n\t\t\t};\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tthis._link = new DLink( this.theme, this.toLinkOptions( options ) );\n\t\tsuper.init( DLinks.toStateOptions( options?.target, options ) );\n\t}\n\n\tget link(): DLink {\n\t\treturn this._link;\n\t}\n\n\tprotected initOnClick( options?: OPTIONS ): void {\n\t\tthis._link.apply( this, ( e ) => this.onSelect( e ) );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemLink\";\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tsuper.onSelect( e );\n\t\tthis._link.open( e );\n\t}\n\n\topen( inNewWindow: boolean ): void {\n\t\tthis._link.open( inNewWindow );\n\t}\n\n\tprotected onShortcut( e: KeyboardEvent ) {\n\t\tsuper.onShortcut( e );\n\t\tthis.onSelect( e );\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemLinkOptions<VALUE> {\n\t\treturn \"url\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction } from \"pixi.js\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuAlign } from \"./d-menu-align\";\nimport { DMenuItem, DMenuItemOptions, DThemeMenuItem } from \"./d-menu-item\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenus } from \"./d-menus\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemMenuOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu\n> extends DMenuItemOptions<VALUE, THEME> {\n\tmenu: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\nexport interface DThemeMenuItemMenu extends DThemeMenuItem {\n\n}\n\nexport class DMenuItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItem<VALUE, THEME, OPTIONS> {\n\tprotected _menu?: DMenu<VALUE>;\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.initHover( options );\n\t}\n\n\tprotected initHover( options: OPTIONS ): void {\n\t\tthis.on( UtilPointerEvent.over, (): void => {\n\t\t\tif( this.state.isActionable ) {\n\t\t\t\tthis.open();\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected toMenu( options?: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options?.menu;\n\t\tif( menu instanceof DisplayObject ) {\n\t\t\treturn menu;\n\t\t}\n\t\treturn this.newMenu( menu );\n\t}\n\n\tprotected newMenu( options?: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\treturn DMenus.newMenu( options );\n\t}\n\n\tget menu(): DMenu<VALUE> {\n\t\tlet result = this._menu;\n\t\tif( result == null ) {\n\t\t\tresult = this.toMenu( this._options );\n\t\t\tresult.on( \"select\", ( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void => {\n\t\t\t\tthis.onMenuSelect( value, item, menu );\n\t\t\t});\n\t\t\tthis._menu = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemMenu\";\n\t}\n\n\topen(): void {\n\t\tconst menu = this.menu;\n\t\tif( menu.isHidden() ) {\n\t\t\tthis.onOpen( menu );\n\t\t}\n\t}\n\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tconst context = this.getContext();\n\t\tif( context != null ) {\n\t\t\tmenu.open( this, this.getCloseable(), context );\n\t\t}\n\t}\n\n\tclose(): void {\n\t\tthis.menu.close();\n\t}\n\n\ttoggle(): void {\n\t\tconst menu = this.menu;\n\t\tif( menu.isHidden() ) {\n\t\t\tthis.onOpen( menu );\n\t\t} else {\n\t\t\tmenu.close();\n\t\t}\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ): void {\n\t\tthis.open();\n\t\tsuper.onSelect( e );\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tconst closeable = this.getCloseable();\n\t\tif( closeable != null ) {\n\t\t\tcloseable.emit( \"select\", value, item, closeable );\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isArrowRightKey( e ) ) {\n\t\t\tthis.onKeyDownArrowRight( e );\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onKeyDownArrowRight( e: KeyboardEvent ): boolean {\n\t\tif( this.state.isActionable && this.state.isFocused ) {\n\t\t\tthis.onSelect( e );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemMenuOptions<VALUE> {\n\t\treturn \"menu\" in options;\n\t}\n\n\tstatic toSubMenuOptions<VALUE>( options: DMenuItemMenuOptions<VALUE>, sticky: boolean ): DMenuItemMenuOptions<VALUE> {\n\t\tconst menu = options.menu;\n\t\tif( ! (menu instanceof DisplayObject) ) {\n\t\t\tif( menu.sticky == null ) {\n\t\t\t\tmenu.sticky = sticky;\n\t\t\t}\n\t\t\tif( menu.align == null ) {\n\t\t\t\tmenu.align = DMenuAlign.RIGHT;\n\t\t\t}\n\t\t}\n\t\treturn options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DListItemSeparatorReflowable extends Graphics implements DReflowable {\n\tconstructor( base: DBase ) {\n\t\tsuper();\n\t\tbase.addRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst state = base.state;\n\t\tconst border = base.border;\n\t\tconst borderWidth = border.getWidth( state );\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\tconst padding = base.padding;\n\t\t\tconst middle = height * 0.5;\n\t\t\tthis.clear();\n\t\t\tthis.lineStyle( borderWidth, borderColor, borderAlpha, borderAlign );\n\t\t\tthis.moveTo( padding.getLeft(), middle );\n\t\t\tthis.lineTo( width - padding.getRight(), middle );\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.clear();\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\nimport { DListItemSeparatorReflowable } from \"./d-list-item-separator-reflowable\";\n\nexport interface DListItemSeparatorOptions<VALUE, THEME extends DThemeListItemSeparator>\n\textends DListItemOptions<VALUE, THEME> {\n\tseparator?: true;\n}\n\nexport interface DThemeListItemSeparator extends DThemeListItem {\n\n}\n\nexport class DListItemSeparator<\n\tVALUE,\n\tTHEME extends DThemeListItemSeparator = DThemeListItemSeparator,\n\tOPTIONS extends DListItemSeparatorOptions<VALUE, THEME> = DListItemSeparatorOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DListItemSeparatorReflowable( this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DListItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItemSeparator, DListItemSeparatorOptions, DThemeListItemSeparator } from \"./d-list-item-separator\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemSeparatorOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator\n> extends DListItemSeparatorOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemSeparator extends DThemeListItemSeparator {\n\n}\n\nexport class DMenuItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DListItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemSeparator\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemSeparatorOptions<VALUE> {\n\t\treturn \"separator\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayoutSpace, DLayoutSpaceOptions, DThemeLayoutSpace } from \"./d-layout-space\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\n\nexport interface DMenuItemSpaceOptions<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace\n> extends DLayoutSpaceOptions<THEME> {\n\tspace: true;\n}\n\nexport interface DThemeMenuItemSpace extends DThemeLayoutSpace {\n\n}\n\nexport class DMenuItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DLayoutSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemSpace\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemSpaceOptions {\n\t\treturn \"space\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuItemText } from \"../d-menu-item-text\";\nimport { DMenus } from \"../d-menus\";\n\nexport const loadMenuItem = () => {\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any>, sticky: boolean ): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenus.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DMenuItemExpandableBodyOptions<\n\tTHEME extends DThemeMenuItemExpandableBody = DThemeMenuItemExpandableBody\n> extends DLayoutVerticalOptions<THEME> {\n\n}\n\nexport interface DThemeMenuItemExpandableBody extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuItemExpandableBody<\n\tTHEME extends DThemeMenuItemExpandableBody = DThemeMenuItemExpandableBody,\n\tOPTIONS extends DMenuItemExpandableBodyOptions<THEME> = DMenuItemExpandableBodyOptions<THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableBody\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DListItem, DListItemOptions, DListItemSelection, DThemeListItem } from \"./d-list-item\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DMenuItemExpandableHeaderOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandableHeader = DThemeMenuItemExpandableHeader\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeMenuItemExpandableHeader extends DThemeListItem {\n\n}\n\nexport class DMenuItemExpandableHeader<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandableHeader = DThemeMenuItemExpandableHeader,\n\tOPTIONS extends DMenuItemExpandableHeaderOptions<VALUE, THEME> = DMenuItemExpandableHeaderOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected getSelection(): DListItemSelection | null {\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableHeader\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuItemExpandables {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenus.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\nimport { DMenuItemExpandableBody, DMenuItemExpandableBodyOptions } from \"./d-menu-item-expandable-body\";\nimport { DMenuItemExpandableHeader, DMenuItemExpandableHeaderOptions } from \"./d-menu-item-expandable-header\";\nimport { DMenuItemExpandables } from \"./d-menu-item-expandables\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DMenuItemExpandableOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n> extends DLayoutVerticalOptions<THEME> {\n\theader: DisplayObject | DMenuItemExpandableHeaderOptions<VALUE>;\n\tbody?: Container | DMenuItemExpandableBodyOptions;\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n\tsticky?: boolean;\n}\n\nexport interface DThemeMenuItemExpandable extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuItemExpandable<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n\tOPTIONS extends DMenuItemExpandableOptions<VALUE, THEME> = DMenuItemExpandableOptions<VALUE, THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _header!: DisplayObject;\n\tprotected _body!: DisplayObject;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Header\n\t\tconst theme = this.theme;\n\t\tconst header = this.toHeader( theme, options );\n\t\tthis._header = header;\n\t\theader.on( \"select\", (): void => {\n\t\t\tthis.toggle();\n\t\t});\n\t\tthis.addChild( header );\n\n\t\t// Body\n\t\tconst body = this.toBody( theme, options );\n\t\tthis._body = body;\n\t\tconst sticky = ( options && options.sticky != null ? options.sticky : false );\n\t\tthis.newItems( body, sticky, theme, options );\n\t\tthis.addChild( body );\n\n\t\t//\n\t\tif( this.state.isActive ) {\n\t\t\tthis.onActivated();\n\t\t} else {\n\t\t\tthis.onDeactivated();\n\t\t}\n\t}\n\n\tprotected newItems( body: Container, sticky: boolean, theme: THEME, options: OPTIONS | undefined ): void {\n\t\tif( options != null && options.items != null ) {\n\t\t\tDMenuItemExpandables.newItems( body, options.items, sticky );\n\t\t}\n\t}\n\n\tprotected toHeader( theme: THEME, options?: OPTIONS ): DisplayObject {\n\t\tif( options ) {\n\t\t\tif( options.header instanceof DisplayObject ) {\n\t\t\t\treturn options.header;\n\t\t\t} else {\n\t\t\t\treturn this.newHeader( theme, options.header );\n\t\t\t}\n\t\t}\n\t\treturn this.newHeader( theme );\n\t}\n\n\tprotected newHeader( theme: THEME, options?: DMenuItemExpandableHeaderOptions<VALUE> ): DisplayObject {\n\t\treturn new DMenuItemExpandableHeader<VALUE>( options );\n\t}\n\n\tprotected toBody( theme: THEME,  options?: OPTIONS ): Container {\n\t\tif( options && options.body ) {\n\t\t\tif( options.body instanceof DisplayObject ) {\n\t\t\t\treturn options.body;\n\t\t\t} else {\n\t\t\t\treturn this.newBody( theme, options.body );\n\t\t\t}\n\t\t}\n\t\treturn this.newBody( theme );\n\t}\n\n\tprotected newBody( theme: THEME, options?: DMenuItemExpandableBodyOptions ): Container {\n\t\treturn new DMenuItemExpandableBody( options );\n\t}\n\n\topen(): void {\n\t\tthis.state.isActive = true;\n\t}\n\n\tclose(): void {\n\t\tthis.state.isActive = false;\n\t}\n\n\ttoggle(): void {\n\t\tthis.state.isActive = ! this.state.isActive;\n\t}\n\n\tprotected onActivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.show();\n\t\t} else {\n\t\t\tbody.visible = true;\n\t\t}\n\t}\n\n\tprotected onDeactivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.hide();\n\t\t} else {\n\t\t\tbody.visible = false;\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tif( newState.isActive ) {\n\t\t\tif( ! oldState.isActive ) {\n\t\t\t\tthis.onActivated();\n\t\t\t}\n\t\t} else {\n\t\t\tif( oldState.isActive ) {\n\t\t\t\tthis.onDeactivated();\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isArrowRightKey( e ) ) {\n\t\t\tif( this.state.isActionable && ! this.state.isActive ) {\n\t\t\t\tconst header = this._header;\n\t\t\t\tif( header instanceof DBase && header.state.isFocused ) {\n\t\t\t\t\tthis.state.isActive = true;\n\t\t\t\t}\n\t\t\t}\n\t\t} else if( UtilKeyboardEvent.isArrowLeftKey( e ) ) {\n\t\t\tif( this.state.isActionable && this.state.isActive ) {\n\t\t\t\t// Move the focus\n\t\t\t\tconst header = this._header;\n\t\t\t\tif( header instanceof DBase ) {\n\t\t\t\t\theader.focus();\n\t\t\t\t} else {\n\t\t\t\t\tthis.focus();\n\t\t\t\t}\n\n\t\t\t\t// Deactivate\n\t\t\t\tthis.state.isActive = false;\n\n\t\t\t\t// Key handling\n\t\t\t\tsuper.onKeyDown( e );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandable\";\n\t}\n\n\tstatic isCompatible<VALUE>( options: DMenuItemOptionsUnion<VALUE> ): options is DMenuItemExpandableOptions<VALUE> {\n\t\treturn \"header\" in options;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheck, DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\n\nexport class DMenuItemExpandableItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuItemExpandableItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSeparator, DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuItemExpandableItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSpace, DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuItemExpandableItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuItemExpandableItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemExpandable } from \"../d-menu-item-expandable\";\nimport { DMenuItemExpandableItemCheck } from \"../d-menu-item-expandable-item-check\";\nimport { DMenuItemExpandableItemLink } from \"../d-menu-item-expandable-item-link\";\nimport { DMenuItemExpandableItemSeparator } from \"../d-menu-item-expandable-item-separator\";\nimport { DMenuItemExpandableItemSpace } from \"../d-menu-item-expandable-item-space\";\nimport { DMenuItemExpandableItemText } from \"../d-menu-item-expandable-item-text\";\nimport { DMenuItemExpandables } from \"../d-menu-item-expandables\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenus } from \"../d-menus\";\n\nexport const loadMenuItemExpandable = () => {\n\tDMenus.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemExpandable.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandable( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuItemExpandableItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuItemExpandables.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuItemExpandableItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheck, DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\n\nexport class DMenuSidedItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItemSelection } from \"./d-list-item\";\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuSidedItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getSelection(): DListItemSelection | null {\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItemSelection } from \"./d-list-item\";\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemMenu, DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuSidedItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected initHover( options: OPTIONS ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tsuper.onMenuSelect( value, item, menu );\n\t\tconst selection = super.getSelection();\n\t\tif( selection ) {\n\t\t\tselection.add( item );\n\t\t}\n\t}\n\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tmenu.open( this, this );\n\t}\n\n\tprotected getSelection(): DListItemSelection | null {\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSeparator, DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuSidedItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemSpace, DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuSidedItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemText, DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuSidedItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuSideds {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenus.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuSidedItemCheck } from \"../d-menu-sided-item-check\";\nimport { DMenuSidedItemLink } from \"../d-menu-sided-item-link\";\nimport { DMenuSidedItemMenu } from \"../d-menu-sided-item-menu\";\nimport { DMenuSidedItemSeparator } from \"../d-menu-sided-item-separator\";\nimport { DMenuSidedItemSpace } from \"../d-menu-sided-item-space\";\nimport { DMenuSidedItemText } from \"../d-menu-sided-item-text\";\nimport { DMenuSideds } from \"../d-menu-sideds\";\n\nexport const loadMenuSidedItem = () => {\n\tDMenuSideds.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuSidedItemText( options );\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any>, sticky: boolean ): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuSideds } from \"./d-menu-sideds\";\nimport { DMenuItemCreator, DMenus } from \"./d-menus\";\n\nexport class DMenuSidedItemExpandables {\n\tprotected static CREATORS: DMenuItemCreator[] = [];\n\tprotected static CREATOR_DEFAULT: DMenuItemCreator | null = null;\n\n\tstatic addItemCreator( creator: DMenuItemCreator ): void {\n\t\tthis.CREATORS.push( creator );\n\t}\n\n\tstatic setItemCreatorDefault( creator: DMenuItemCreator ): void {\n\t\tthis.CREATOR_DEFAULT = creator;\n\t}\n\n\tstatic newItem<VALUE>( options: DMenuItemOptionsUnion<VALUE>, sticky: boolean ): DisplayObject | null {\n\t\treturn DMenus.newItemOf( this.CREATORS, this.CREATOR_DEFAULT, options, sticky ) ||\n\t\t\tDMenuSideds.newItem( options, sticky );\n\t}\n\n\tstatic newItems<VALUE>(\n\t\tparent: Container,\n\t\titems: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>,\n\t\tsticky: boolean\n\t): void {\n\t\tDMenus.newItemsOf( this, parent, items, sticky );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DMenuItemExpandable, DMenuItemExpandableOptions, DThemeMenuItemExpandable } from \"./d-menu-item-expandable\";\nimport { DMenuSidedItemExpandables } from \"./d-menu-sided-item-expandables\";\n\nexport class DMenuSidedItemExpandable<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemExpandable = DThemeMenuItemExpandable,\n\tOPTIONS extends DMenuItemExpandableOptions<VALUE, THEME> = DMenuItemExpandableOptions<VALUE, THEME>\n> extends DMenuItemExpandable<VALUE, THEME, OPTIONS> {\n\tprotected newItems( body: Container, sticky: boolean, theme: THEME, options: OPTIONS | undefined ): void {\n\t\tif( options != null && options.items != null ) {\n\t\t\tDMenuSidedItemExpandables.newItems( body, options.items, sticky );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandable\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemCheckOptions, DThemeMenuItemCheck } from \"./d-menu-item-check\";\nimport { DMenuItemExpandableItemCheck } from \"./d-menu-item-expandable-item-check\";\n\nexport class DMenuSidedItemExpandableItemCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemCheck = DThemeMenuItemCheck,\n\tOPTIONS extends DMenuItemCheckOptions<VALUE, THEME> = DMenuItemCheckOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemLink, DMenuItemLinkOptions, DThemeMenuItemLink } from \"./d-menu-item-link\";\n\nexport class DMenuSidedItemExpandableItemLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemLink = DThemeMenuItemLink,\n\tOPTIONS extends DMenuItemLinkOptions<VALUE, THEME> = DMenuItemLinkOptions<VALUE, THEME>\n> extends DMenuItemLink<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemMenu, DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuItemExpandableItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuItemExpandableItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItemExpandableItemMenu } from \"./d-menu-item-expandable-item-menu\";\nimport { DMenuItemMenuOptions, DThemeMenuItemMenu } from \"./d-menu-item-menu\";\n\nexport class DMenuSidedItemExpandableItemMenu<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemMenu = DThemeMenuItemMenu,\n\tOPTIONS extends DMenuItemMenuOptions<VALUE, THEME> = DMenuItemMenuOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemMenu<VALUE, THEME, OPTIONS> {\n\tprotected onOpen( menu: DMenu<VALUE> ): void {\n\t\tmenu.open( this, this );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemSeparator } from \"./d-menu-item-expandable-item-separator\";\nimport { DMenuItemSeparatorOptions, DThemeMenuItemSeparator } from \"./d-menu-item-separator\";\n\nexport class DMenuSidedItemExpandableItemSeparator<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemSeparator = DThemeMenuItemSeparator,\n\tOPTIONS extends DMenuItemSeparatorOptions<VALUE, THEME> = DMenuItemSeparatorOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemSeparator<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemSeparator\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemSpace } from \"./d-menu-item-expandable-item-space\";\nimport { DMenuItemSpaceOptions, DThemeMenuItemSpace } from \"./d-menu-item-space\";\n\nexport class DMenuSidedItemExpandableItemSpace<\n\tTHEME extends DThemeMenuItemSpace = DThemeMenuItemSpace,\n\tOPTIONS extends DMenuItemSpaceOptions<THEME> = DMenuItemSpaceOptions<THEME>\n> extends DMenuItemExpandableItemSpace<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemSpace\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItemExpandableItemText } from \"./d-menu-item-expandable-item-text\";\nimport { DMenuItemTextOptions, DThemeMenuItemText } from \"./d-menu-item-text\";\n\nexport class DMenuSidedItemExpandableItemText<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuItemText = DThemeMenuItemText,\n\tOPTIONS extends DMenuItemTextOptions<VALUE, THEME> = DMenuItemTextOptions<VALUE, THEME>\n> extends DMenuItemExpandableItemText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedItemExpandableItemText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DMenuItemCheck } from \"../d-menu-item-check\";\nimport { DMenuItemExpandable } from \"../d-menu-item-expandable\";\nimport { DMenuItemLink } from \"../d-menu-item-link\";\nimport { DMenuItemMenu } from \"../d-menu-item-menu\";\nimport { DMenuItemOptionsUnion } from \"../d-menu-item-options-union\";\nimport { DMenuItemSeparator } from \"../d-menu-item-separator\";\nimport { DMenuItemSpace } from \"../d-menu-item-space\";\nimport { DMenuSidedItemExpandable } from \"../d-menu-sided-item-expandable\";\nimport { DMenuSidedItemExpandableItemCheck } from \"../d-menu-sided-item-expandable-item-check\";\nimport { DMenuSidedItemExpandableItemLink } from \"../d-menu-sided-item-expandable-item-link\";\nimport { DMenuSidedItemExpandableItemMenu } from \"../d-menu-sided-item-expandable-item-menu\";\nimport { DMenuSidedItemExpandableItemSeparator } from \"../d-menu-sided-item-expandable-item-separator\";\nimport { DMenuSidedItemExpandableItemSpace } from \"../d-menu-sided-item-expandable-item-space\";\nimport { DMenuSidedItemExpandableItemText } from \"../d-menu-sided-item-expandable-item-text\";\nimport { DMenuSidedItemExpandables } from \"../d-menu-sided-item-expandables\";\nimport { DMenuSideds } from \"../d-menu-sideds\";\n\nexport const loadMenuSidedItemExpandable = () => {\n\tDMenuSideds.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemExpandable.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandable( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemCheck.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemCheck( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemLink.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemLink( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator((\n\t\toptions: DMenuItemOptionsUnion<any>, sticky: boolean\n\t): DisplayObject | null => {\n\t\tif( DMenuItemMenu.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemMenu( DMenuItemMenu.toSubMenuOptions( options, sticky ) );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSeparator.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemSeparator( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.addItemCreator(( options: DMenuItemOptionsUnion<any> ): DisplayObject | null => {\n\t\tif( DMenuItemSpace.isCompatible( options ) ) {\n\t\t\treturn new DMenuSidedItemExpandableItemSpace( options );\n\t\t}\n\t\treturn null;\n\t});\n\n\tDMenuSidedItemExpandables.setItemCreatorDefault(( options: any ): DisplayObject | null => {\n\t\treturn new DMenuSidedItemExpandableItemText( options );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadMenuItem } from \"./load-menu-item\";\nimport { loadMenuItemExpandable } from \"./load-menu-item-expandable\";\nimport { loadMenuSidedItem } from \"./load-menu-sided-item\";\nimport { loadMenuSidedItemExpandable } from \"./load-menu-sided-item-expandable\";\n\nexport const loadMenuItemAll = () => {\n\tloadMenuItem();\n\tloadMenuItemExpandable();\n\tloadMenuSidedItem();\n\tloadMenuSidedItemExpandable();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { loadShapeAll } from \"../shape/load/load-shape-all\";\nimport { loadMenuItemAll } from \"./load-menu-item-all\";\n\nexport const loadAll = () => {\n\tloadMenuItemAll();\n\tloadShapeAll();\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nconst VERTEX_SHADER = `\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nvarying mediump vec2 vTextureCoord;\nvoid main(void) {\n\tgl_Position = vec4(aVertexPosition, 0.0, 1.0);\n\tvTextureCoord = aTextureCoord;\n}\n`;\n\nconst FRAGMENT_SHADER = `\nprecision mediump float;\n\nvarying mediump vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uSize;\n\nfloat calcDistance( float x, float y, float dx, float dy ) {\n\tfloat xd = x + dx;\n\tfloat yd = y + dy;\n\tfloat u = xd / uSize.x;\n\tfloat v = yd / uSize.y;\n\tfloat ul = (xd - 1.0) / uSize.x;\n\tfloat vt = (yd - 1.0) / uSize.y;\n\n\tfloat m = texture2D(uSampler, vec2(u , v )).a;\n\tfloat l = texture2D(uSampler, vec2(ul, v )).a;\n\tfloat t = texture2D(uSampler, vec2(u , vt)).a;\n\n\tfloat xl = mix( xd - 1.0, xd, (0.5 - l) / (m - l) );\n\tfloat yt = mix( yd - 1.0, yd, (0.5 - t) / (m - t) );\n\n\tbool bl = ( min(l, m) < 0.5 && 0.5 <= max(l, m) );\n\tbool bt = ( min(t, m) < 0.5 && 0.5 <= max(t, m) );\n\n\tfloat ll = (bl ? length( vec2( xl - x, yd - y ) ) : 100.0);\n\tfloat lt = (bt ? length( vec2( xd - x, yt - y ) ) : 100.0);\n\n\treturn min( ll, lt );\n}\n\nfloat calcDistancesY( float x, float y, float dx ) {\n\tfloat d = 100.0;\n\tfor( float dy=-6.0; dy<6.5; dy++ ) {\n\t\td = min( d, calcDistance( x, y, dx, dy ) );\n\t}\n\treturn d;\n}\n\nfloat calcDistances( float x, float y ) {\n\tfloat d = 100.0;\n\tfor( float dx=-6.0; dx<6.5; dx++ ) {\n\t\td = min( d, calcDistancesY( x, y, dx ) );\n\t}\n\treturn d;\n}\n\nvoid main(void) {\n\tfloat t = texture2D(uSampler, vTextureCoord).a;\n\tfloat x = vTextureCoord.x * uSize.x;\n\tfloat y = vTextureCoord.y * uSize.y;\n\tfloat d = min( 6.0, calcDistances( x, y ) ) / 12.0;\n\td = clamp( mix( 0.5 - d, 0.5 + d, step( 0.5, t ) ), 0.0, 1.0 );\n\tgl_FragColor = vec4(1.0, 1.0, 1.0, d);\n}\n`;\n\nexport class DynamicSDFFontGenerator {\n\tprotected static _INSTANCE: DynamicSDFFontGenerator | null = null;\n\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _onLostBound: EventListener;\n\tprotected _onRestoreBound: EventListener;\n\tprotected _onUnloadBound: EventListener;\n\tprotected _gl: WebGLRenderingContext | null;\n\tprotected _texture: WebGLTexture | null;\n\tprotected _shaderProgram: WebGLProgram | null;\n\tprotected _vertexPositionAttribute: number;\n\tprotected _textureCoordAttribute: number;\n\tprotected _samplerUniform: WebGLUniformLocation | null;\n\tprotected _sizeUniform: WebGLUniformLocation | null;\n\tprotected _vb: WebGLBuffer | null;\n\tprotected _uvb: WebGLBuffer | null;\n\n\tconstructor() {\n\t\tthis._gl = null;\n\t\tthis._texture = null;\n\t\tthis._shaderProgram = null;\n\t\tthis._vertexPositionAttribute = NaN;\n\t\tthis._textureCoordAttribute = NaN;\n\t\tthis._samplerUniform = NaN;\n\t\tthis._sizeUniform = NaN;\n\t\tthis._vb = null;\n\t\tthis._uvb = null;\n\n\t\tconst canvas = this._canvas = document.createElement( \"canvas\" );\n\t\tcanvas.width = 64;\n\t\tcanvas.height = 64;\n\t\tthis._onLostBound = ( e: Event ): void => {\n\t\t\te.preventDefault();\n\t\t};\n\t\tthis._onRestoreBound = (): void => {\n\t\t\tthis.restore();\n\t\t};\n\t\tthis._onUnloadBound = (): void => {\n\t\t\tthis.destroy();\n\t\t};\n\t\tcanvas.addEventListener( \"webglcontextlost\", this._onLostBound, false);\n\t\tcanvas.addEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\n\t\twindow.addEventListener( \"unload\", this._onUnloadBound, false );\n\t}\n\n\tinit(): this {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null && (this._gl == null || this._gl.isContextLost()) ) {\n\t\t\tconst config: WebGLContextAttributes = {\n\t\t\t\talpha: true,\n\t\t\t\tantialias: false,\n\t\t\t\tdepth: false,\n\t\t\t\tstencil: false,\n\t\t\t\tpremultipliedAlpha: false\n\t\t\t};\n\t\t\tconst gl = this._gl = (\n\t\t\t\tcanvas.getContext( \"webgl\", config ) ||\n\t\t\t\tcanvas.getContext( \"experimental-webgl\", config ) as WebGLRenderingContext | null\n\t\t\t);\n\t\t\tif( gl != null ) {\n\t\t\t\tgl.clearColor(1.0, 1.0, 1.0, 0.0);\n\t\t\t\tthis.makeVertexBuffer();\n\t\t\t\tthis.makeUvBuffer();\n\t\t\t\tthis.makeShaders();\n\t\t\t\tthis._texture = null;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\trestore(): void {\n\t\tthis.init();\n\t}\n\n\tgetCanvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tgetShader( gl: WebGLRenderingContext, code: string, type: boolean ): WebGLShader | null {\n\t\tconst shader = ( type ?\n\t\t\tgl.createShader( gl.FRAGMENT_SHADER ) :\n\t\t\tgl.createShader( gl.VERTEX_SHADER )\n\t\t);\n\t\tif( shader != null ) {\n\t\t\tgl.shaderSource( shader, code );\n\t\t\tgl.compileShader( shader );\n\t\t\tif( ! gl.getShaderParameter( shader, gl.COMPILE_STATUS ) ) {\n\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\n\t\t\t\tconsole && console.error( `Failed to compile the shader: ${gl.getShaderInfoLog(shader)}` );\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\treturn shader;\n\t}\n\n\tmakeShaders(): WebGLShader | null {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst vertexShader = this.getShader( gl, VERTEX_SHADER, false );\n\t\t\tif( vertexShader != null ) {\n\t\t\t\tconst fragmentShader = this.getShader( gl, FRAGMENT_SHADER, true );\n\t\t\t\tif( fragmentShader != null ) {\n\t\t\t\t\tconst shaderProgram = this._shaderProgram = gl.createProgram();\n\t\t\t\t\tif( shaderProgram != null ) {\n\t\t\t\t\t\tgl.attachShader( shaderProgram, vertexShader );\n\t\t\t\t\t\tgl.attachShader( shaderProgram, fragmentShader );\n\t\t\t\t\t\tgl.linkProgram( shaderProgram );\n\t\t\t\t\t\tif( ! gl.getProgramParameter(shaderProgram, gl.LINK_STATUS) ) {\n\t\t\t\t\t\t\t// tslint:disable-next-line: no-console no-unused-expression\n\t\t\t\t\t\t\tconsole && console.error( `Failed to link the program: ${gl.getError()}` );\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\t\t\t\t\t\t\treturn null;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\n\t\t\t\t\t\t\tgl.useProgram( shaderProgram );\n\t\t\t\t\t\t\tthis._vertexPositionAttribute = gl.getAttribLocation( shaderProgram, \"aVertexPosition\" );\n\t\t\t\t\t\t\tthis._textureCoordAttribute = gl.getAttribLocation( shaderProgram, \"aTextureCoord\" );\n\t\t\t\t\t\t\tthis._samplerUniform = gl.getUniformLocation( shaderProgram, \"uSampler\" );\n\t\t\t\t\t\t\tthis._sizeUniform = gl.getUniformLocation( shaderProgram, \"uSize\" );\n\t\t\t\t\t\t\tgl.useProgram( null );\n\t\t\t\t\t\t\treturn shaderProgram;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t\t\tgl.deleteShader( fragmentShader );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tgl.deleteShader( vertexShader );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyShaders(): void {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst shaderProgram = this._shaderProgram;\n\t\t\tif( shaderProgram != null ) {\n\t\t\t\tthis._shaderProgram = null;\n\t\t\t\tgl.useProgram( null );\n\t\t\t\tgl.deleteProgram( shaderProgram );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTexture( source: TexImageSource ): WebGLTexture | null {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\n\t\t\tconst width = source.width;\n\t\t\tconst height = source.height;\n\t\t\tif( canvas.width !== width || canvas.height !== height ) {\n\t\t\t\tcanvas.width = width;\n\t\t\t\tcanvas.height = height;\n\t\t\t\tgl.viewport( 0, 0, width, height );\n\t\t\t}\n\n\t\t\tlet texture = this._texture;\n\t\t\tif( texture == null ) {\n\t\t\t\ttexture = this._texture = gl.createTexture();\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST );\n\t\t\t\tgl.texParameteri( gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST );\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t} else {\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\t\tgl.texImage2D( gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, source );\n\t\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\t}\n\t\t\treturn texture;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyTexture(): void {\n\t\tconst gl = this._gl;\n\t\tconst texture = this._texture;\n\t\tif( gl != null && gl.isContextLost() !== true && texture != null ) {\n\t\t\tthis._texture = null;\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\tgl.deleteTexture( texture );\n\t\t}\n\t}\n\n\tmakeVertexBuffer(): WebGLBuffer | null {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst vb = this._vb = gl.createBuffer();\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\n\n\t\t\tconst vertices = [\n\t\t\t\t-1.0, +1.0,\n\t\t\t\t+1.0, +1.0,\n\t\t\t\t-1.0, -1.0,\n\t\t\t\t+1.0, -1.0\n\t\t\t];\n\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW );\n\t\t\treturn vb;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyVertexBuffer(): void {\n\t\tconst gl = this._gl;\n\t\tconst vb = this._vb;\n\t\tif( gl != null && gl.isContextLost() !== true && vb != null ) {\n\t\t\tthis._vb = null;\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.deleteBuffer( vb );\n\t\t}\n\t}\n\n\tmakeUvBuffer(): WebGLBuffer | null {\n\t\tconst gl = this._gl;\n\t\tif( gl != null && gl.isContextLost() !== true ) {\n\t\t\tconst uvb = this._uvb = gl.createBuffer();\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\n\n\t\t\tconst uvs = [\n\t\t\t\t0.0,  0.0,\n\t\t\t\t1.0,  0.0,\n\t\t\t\t0.0,  1.0,\n\t\t\t\t1.0,  1.0\n\t\t\t];\n\n\t\t\tgl.bufferData( gl.ARRAY_BUFFER, new Float32Array(uvs), gl.STATIC_DRAW );\n\t\t\treturn uvb;\n\t\t}\n\t\treturn null;\n\t}\n\n\tdestroyUvBuffer(): void {\n\t\tconst gl = this._gl;\n\t\tconst uvb = this._uvb;\n\t\tif( gl != null && gl.isContextLost() !== true && uvb != null ) {\n\t\t\tthis._uvb = null;\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.deleteBuffer( uvb );\n\t\t}\n\t}\n\n\trender(): void {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tconst shaderProgram = this._shaderProgram;\n\t\tconst vb = this._vb;\n\t\tconst uvb = this._uvb;\n\t\tconst texture = this._texture;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null &&\n\t\t\tshaderProgram != null && vb != null && uvb != null && texture != null ) {\n\t\t\tgl.clear( gl.COLOR_BUFFER_BIT );\n\n\t\t\tgl.useProgram( shaderProgram );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, vb );\n\t\t\tconst vertexPositionAttribute = this._vertexPositionAttribute;\n\t\t\tgl.enableVertexAttribArray( vertexPositionAttribute );\n\t\t\tgl.vertexAttribPointer( vertexPositionAttribute, 2, gl.FLOAT, false, 0, 0 );\n\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, uvb );\n\t\t\tconst textureCoordAttribute = this._textureCoordAttribute;\n\t\t\tgl.enableVertexAttribArray( textureCoordAttribute );\n\t\t\tgl.vertexAttribPointer( textureCoordAttribute, 2, gl.FLOAT, false, 0, 0 );\n\n\t\t\tgl.activeTexture( gl.TEXTURE0 );\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, texture );\n\t\t\tgl.uniform1i( this._samplerUniform, 0 );\n\t\t\tgl.uniform2f( this._sizeUniform, canvas.width, canvas.height );\n\n\t\t\tgl.drawArrays( gl.TRIANGLE_STRIP, 0, 4 );\n\n\t\t\tgl.bindTexture( gl.TEXTURE_2D, null );\n\t\t\tgl.bindBuffer( gl.ARRAY_BUFFER, null );\n\t\t\tgl.useProgram( null );\n\t\t}\n\t}\n\n\tread( copyCanvas: HTMLCanvasElement ): void {\n\t\tconst gl = this._gl;\n\t\tconst canvas = this._canvas;\n\t\tif( gl != null && gl.isContextLost() !== true && canvas != null ) {\n\t\t\tconst width = canvas.width;\n\t\t\tconst height = canvas.height;\n\t\t\tcopyCanvas.width = width;\n\t\t\tcopyCanvas.height = height;\n\t\t\tconst copyContext = copyCanvas.getContext( \"2d\" );\n\t\t\tif( copyContext != null ) {\n\t\t\t\tcopyContext.drawImage( canvas, 0, 0 );\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tthis.destroyVertexBuffer();\n\t\tthis.destroyUvBuffer();\n\t\tthis.destroyShaders();\n\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t\tcanvas.removeEventListener( \"webglcontextlost\", this._onLostBound, false);\n\t\t\tcanvas.removeEventListener( \"webglcontextrestored\", this._onRestoreBound, false);\n\t\t\twindow.removeEventListener( \"unload\", this._onUnloadBound, false );\n\t\t}\n\n\t\tconst gl = this._gl;\n\t\tif( gl != null ) {\n\t\t\tthis._gl = null;\n\t\t\tconst WebGLLoseContext = gl.getExtension( \"WEBGL_lose_context\" );\n\t\t\tif( WebGLLoseContext != null ) {\n\t\t\t\tWebGLLoseContext.loseContext();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic getInstance(): DynamicSDFFontGenerator {\n\t\tif( DynamicSDFFontGenerator._INSTANCE == null ) {\n\t\t\tDynamicSDFFontGenerator._INSTANCE = new DynamicSDFFontGenerator();\n\t\t}\n\t\treturn DynamicSDFFontGenerator._INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicSDFFontGenerator } from \"../../util/dynamic-sdf-font-generator\";\nimport { EShapeImageElements } from \"../e-shape-image-elements\";\nimport { EShapeImageSdf } from \"./e-shape-image-sdf\";\n\nexport const createImageSdf = ( dataUrl: string, convertToSdf: boolean ): Promise<EShapeImageSdf> => {\n\tif( convertToSdf ) {\n\t\treturn EShapeImageElements.toImageElement( dataUrl )\n\t\t.then(( imageElement: HTMLImageElement ): Promise<EShapeImageSdf> => {\n\t\t\tconst generator = DynamicSDFFontGenerator.getInstance().init();\n\t\t\tgenerator.updateTexture( imageElement );\n\t\t\tgenerator.render();\n\n\t\t\tconst canvas = document.createElement( \"canvas\" );\n\t\t\tgenerator.read( canvas );\n\n\t\t\treturn createImageSdf( canvas.toDataURL(), false );\n\t\t});\n\t} else {\n\t\treturn EShapeImageElements.toImageElement( dataUrl )\n\t\t.then(( imageElement: HTMLImageElement ): EShapeImageSdf => {\n\t\t\treturn new EShapeImageSdf( imageElement );\n\t\t});\n\t}\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\n\nexport class EShapeBufferUnit {\n\ttexture: Texture;\n\tindexOffset: number;\n\n\tconstructor( texture: Texture, indexOffset: number ) {\n\t\tthis.texture = texture;\n\t\tthis.indexOffset = indexOffset;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Texture } from \"pixi.js\";\nimport { EShapeBufferUnit } from \"./e-shape-buffer-unit\";\n\nexport class EShapeBufferUnitBuilder {\n\tindex: number;\n\tbaseTexture: BaseTexture | null;\n\tunits: EShapeBufferUnit[];\n\n\tconstructor() {\n\t\tthis.index = 0;\n\t\tthis.baseTexture = null;\n\t\tthis.units = [];\n\t}\n\n\tbegin(): void {\n\t\tthis.index = 0;\n\t\tthis.baseTexture = null;\n\t}\n\n\tpush( texture: Texture, indexOffset: number ): void {\n\t\tif( this.index < this.units.length ) {\n\t\t\tconst unit = this.units[ this.index ];\n\t\t\tunit.texture = texture;\n\t\t\tunit.indexOffset = indexOffset;\n\t\t} else {\n\t\t\tthis.units.push( new EShapeBufferUnit( texture, indexOffset ) );\n\t\t}\n\t\tthis.index += 1;\n\t}\n\n\tend(): void {\n\t\tif( this.units.length !== this.index ) {\n\t\t\tthis.units.length = this.index;\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tthis.units.length = 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, DRAW_MODES, Geometry, Renderer, Shader, Texture } from \"pixi.js\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBufferUnitBuilder } from \"./e-shape-buffer-unit-builder\";\nimport { EShapeRendererIterator } from \"./e-shape-renderer-iterator\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeUploaded } from \"./e-shape-uploaded\";\nimport { EShapeUploadeds } from \"./e-shape-uploadeds\";\n\nexport class EShapeBuffer {\n\tvertices: Float32Array;\n\tprotected _vertexCapacity: number;\n\tprotected _vertexCount: number;\n\tprotected _vertexBuffer: Buffer | null;\n\n\tclippings: Float32Array;\n\tprotected _clippingBuffer: Buffer | null;\n\n\tsteps: Float32Array;\n\tprotected _stepBuffer: Buffer | null;\n\n\tcolorFills: Float32Array;\n\tprotected _colorFillBuffer: Buffer | null;\n\n\tcolorStrokes: Float32Array;\n\tprotected _colorStrokeBuffer: Buffer | null;\n\n\tuvs: Float32Array;\n\tprotected _uvBuffer: Buffer | null;\n\n\tindices: Uint16Array | Uint32Array;\n\tprotected _indexCapacity: number;\n\tprotected _indexCount: number;\n\tindexCountRequested: number;\n\tprotected _indexBuffer: Buffer | null;\n\n\tprotected _renderer: Renderer;\n\tprotected _geometry: Geometry | null;\n\n\tprotected _builder: EShapeBufferUnitBuilder;\n\n\tconstructor( ntriangles: number, renderer: Renderer ) {\n\t\tconst nindices = ntriangles * 3;\n\t\tconst nvertices = nindices;\n\n\t\tthis.vertices = new Float32Array( nvertices * 2 );\n\t\tthis._vertexCapacity = nvertices;\n\t\tthis._vertexCount = 0;\n\t\tthis._vertexBuffer = null;\n\n\t\tthis.clippings = new Float32Array( nvertices * 3 );\n\t\tthis._clippingBuffer = null;\n\n\t\tthis.steps = new Float32Array( nvertices * 6 );\n\t\tthis._stepBuffer = null;\n\n\t\tthis.colorFills = new Float32Array( nvertices * 4 );\n\t\tthis._colorFillBuffer = null;\n\n\t\tthis.colorStrokes = new Float32Array( nvertices * 4 );\n\t\tthis._colorStrokeBuffer = null;\n\n\t\tthis.uvs = new Float32Array( nvertices * 2 );\n\t\tthis._uvBuffer = null;\n\n\t\tconst isIndicesShort = ( nvertices <= 65535 );\n\t\tthis.indices = ( isIndicesShort ? new Uint16Array( nindices ) : new Uint32Array( nindices ) );\n\t\tthis._indexCapacity = ntriangles;\n\t\tthis._indexCount = 0;\n\t\tthis.indexCountRequested = 0;\n\t\tthis._indexBuffer = null;\n\n\t\tthis._renderer = renderer;\n\n\t\tthis._builder = new EShapeBufferUnitBuilder();\n\n\t\tthis._geometry = null;\n\t}\n\n\tupdateVertices(): void {\n\t\tconst vertexBuffer = this._vertexBuffer;\n\t\tif( vertexBuffer ) {\n\t\t\tvertexBuffer.update();\n\t\t}\n\t}\n\n\tupdateClippings(): void {\n\t\tconst clippingBuffer = this._clippingBuffer;\n\t\tif( clippingBuffer ) {\n\t\t\tclippingBuffer.update();\n\t\t}\n\t}\n\n\tupdateSteps(): void {\n\t\tconst stepBuffer = this._stepBuffer;\n\t\tif( stepBuffer ) {\n\t\t\tstepBuffer.update();\n\t\t}\n\t}\n\n\tupdateColorFills(): void {\n\t\tconst colorFillBuffer = this._colorFillBuffer;\n\t\tif( colorFillBuffer ) {\n\t\t\tcolorFillBuffer.update();\n\t\t}\n\t}\n\n\tupdateColorStrokes(): void {\n\t\tconst colorStrokeBuffer = this._colorStrokeBuffer;\n\t\tif( colorStrokeBuffer ) {\n\t\t\tcolorStrokeBuffer.update();\n\t\t}\n\t}\n\n\tupdateUvs(): void {\n\t\tconst uvBuffer = this._uvBuffer;\n\t\tif( uvBuffer ) {\n\t\t\tuvBuffer.update();\n\t\t}\n\t}\n\n\tupdateIndices(): void {\n\t\tconst indexBuffer = this._indexBuffer;\n\t\tif( indexBuffer ) {\n\t\t\tindexBuffer.update();\n\t\t}\n\t}\n\n\tprotected getGeometry(): Geometry {\n\t\tlet result = this._geometry;\n\t\tif( result == null ) {\n\t\t\tthis._vertexBuffer = new Buffer( this.vertices, false, false );\n\t\t\tthis._clippingBuffer = new Buffer( this.clippings, false, false );\n\t\t\tthis._stepBuffer = new Buffer( this.steps, false, false );\n\t\t\tthis._colorFillBuffer = new Buffer( this.colorFills, false, false );\n\t\t\tthis._colorStrokeBuffer = new Buffer( this.colorStrokes, false, false );\n\t\t\tthis._uvBuffer = new Buffer( this.uvs, false, false );\n\t\t\tthis._indexBuffer = new Buffer( this.indices, false, true );\n\n\t\t\tthis._geometry = result = new Geometry()\n\t\t\t\t.addIndex( this._indexBuffer )\n\t\t\t\t.addAttribute( \"aPosition\", this._vertexBuffer, 2 )\n\t\t\t\t.addAttribute( \"aClipping\", this._clippingBuffer, 3 )\n\t\t\t\t.addAttribute( \"aStep\", this._stepBuffer, 2 )\n\t\t\t\t.addAttribute( \"aAntialias\", this._stepBuffer, 4 )\n\t\t\t\t.addAttribute( \"aColorFill\", this._colorFillBuffer, 4 )\n\t\t\t\t.addAttribute( \"aColorStroke\", this._colorStrokeBuffer, 4 )\n\t\t\t\t.addAttribute( \"aUv\", this._uvBuffer, 2 );\n\t\t}\n\t\treturn result;\n\t}\n\n\tupload(): void {\n\t\tthis._renderer.geometry.bind( this.getGeometry() );\n\t}\n\n\trender( shader: Shader ): void {\n\t\tconst renderer = this._renderer;\n\t\trenderer.geometry.bind( this.getGeometry() );\n\n\t\tconst units = this._builder.units;\n\t\tconst unitCount = units.length;\n\t\tif( 0 < unitCount ) {\n\t\t\tconst type = DRAW_MODES.TRIANGLES;\n\n\t\t\tlet unit0 = null;\n\t\t\tlet unit1 = units[ 0 ];\n\t\t\tlet ioffset0 = 0;\n\t\t\tlet ioffset1 = unit1.indexOffset * 3;\n\t\t\tlet vcount = 0;\n\t\t\tlet texture = Texture.WHITE;\n\t\t\tfor( let i = 0, imax = unitCount - 1; i < imax; ++i ) {\n\t\t\t\tunit0 = unit1;\n\t\t\t\tunit1 = units[ i + 1 ];\n\t\t\t\tioffset0 = ioffset1;\n\t\t\t\tioffset1 = unit1.indexOffset * 3;\n\t\t\t\tvcount = ioffset1 - ioffset0;\n\t\t\t\ttexture = unit0.texture || Texture.WHITE;\n\t\t\t\tif( 0 < vcount && texture.valid ) {\n\t\t\t\t\tshader.uniforms.sampler = renderer.texture.bind( texture );\n\t\t\t\t\trenderer.geometry.draw( type, vcount, ioffset0 );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tvcount = this._indexCount * 3 - ioffset1;\n\t\t\ttexture = unit1.texture || Texture.WHITE;\n\t\t\tif( 0 < vcount && texture.valid ) {\n\t\t\t\tshader.uniforms.sampler = renderer.texture.bind( texture );\n\t\t\t\trenderer.geometry.draw( type, vcount, ioffset1 );\n\t\t\t}\n\t\t}\n\t}\n\n\tisCompatible( shape: EShape, uploaded: EShapeUploaded, vindex: number, iindex: number ): boolean {\n\t\treturn (\n\t\t\tuploaded.getBuffer() === this &&\n\t\t\tuploaded.getVertexOffset() === vindex &&\n\t\t\tuploaded.getIndexOffset() === iindex &&\n\t\t\tuploaded.isCompatible( shape )\n\t\t);\n\t}\n\n\tupdate( iterator: EShapeRendererIterator, antialiasWeight: number, noMoreThanOne: boolean ): boolean {\n\t\tconst builder = this._builder;\n\t\tbuilder.begin();\n\n\t\tlet vindex = 0;\n\t\tlet iindex = 0;\n\t\tlet shape = iterator.get();\n\t\tfor( ; shape != null; shape = iterator.next() ) {\n\t\t\tconst uploaded = shape.uploaded;\n\t\t\tif( uploaded == null || ! this.isCompatible( shape, uploaded, vindex, iindex ) ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tuploaded.update( shape );\n\t\t\tuploaded.buildUnit( builder );\n\n\t\t\tvindex += uploaded.getVertexCount();\n\t\t\tiindex += uploaded.getIndexCount();\n\n\t\t\tif( noMoreThanOne ) {\n\t\t\t\titerator.next();\n\t\t\t\tbuilder.end();\n\t\t\t\tthis._vertexCount = vindex;\n\t\t\t\tthis._indexCount = iindex;\n\t\t\t\treturn 0 < builder.units.length;\n\t\t\t}\n\t\t}\n\n\t\tfor( ; shape != null; shape = iterator.next() ) {\n\t\t\tconst creater = EShapeUploadeds[ shape.type ] || EShapeUploadeds[ EShapeType.GROUP ];\n\t\t\tif( creater == null ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tconst uploaded = creater( this, shape, vindex, iindex, antialiasWeight );\n\t\t\tif( uploaded == null ) {\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tuploaded.buildUnit( builder );\n\t\t\tvindex += uploaded.getVertexCount();\n\t\t\tiindex += uploaded.getIndexCount();\n\n\t\t\tif( noMoreThanOne ) {\n\t\t\t\titerator.next();\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\n\t\tbuilder.end();\n\t\tthis._vertexCount = vindex;\n\t\tthis._indexCount = iindex;\n\t\treturn 0 < builder.units.length;\n\t}\n\n\tcheck( vindex: number, ioffset: number, vcount: number, icount: number ): boolean {\n\t\tthis.indexCountRequested = icount;\n\t\treturn vindex + vcount <= this._vertexCapacity && ioffset + icount <= this._indexCapacity;\n\t}\n\n\tdestroy(): void {\n\t\tconst geometry = this._geometry;\n\t\tif( geometry ) {\n\t\t\tgeometry.destroy();\n\t\t}\n\t\tthis._builder.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Rectangle, Texture } from \"pixi.js\";\n\nexport abstract class DynamicAtlasItem {\n\tid: string;\n\tref: number;\n\tframe: Rectangle;\n\ttexture: Texture;\n\n\twidth: number;\n\theight: number;\n\tstrokeWidth: number;\n\n\tconstructor(\n\t\tid: string,\n\t\twidth: number, height: number, strokeWidth: number,\n\t\tbaseTexture: BaseTexture\n\t) {\n\t\tthis.id = id;\n\t\tthis.ref = 0;\n\t\tconst resolution = baseTexture.resolution;\n\t\tthis.frame = new Rectangle( 0, 0, width * resolution, height * resolution );\n\t\tthis.texture = new Texture( baseTexture, new Rectangle( 0, 0, 1, 1 ) );\n\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.strokeWidth = strokeWidth;\n\t}\n\n\tabstract render( context: CanvasRenderingContext2D ): void;\n\n\tapplyFrame(): void {\n\t\tconst resolutionInverse = 1 / this.texture.baseTexture.resolution;\n\t\tthis.texture.frame.x = this.frame.x * resolutionInverse;\n\t\tthis.texture.frame.y = this.frame.y * resolutionInverse;\n\t\tthis.texture.frame.width = this.width;\n\t\tthis.texture.frame.height = this.height;\n\t\tthis.texture.updateUvs();\n\t\tthis.texture.emit( \"update\", this );\n\t}\n\n\tdestroy(): void {\n\t\tthis.texture.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemEmpty extends DynamicAtlasItem {\n\trender( context: CanvasRenderingContext2D ): void {\n\t\t// DO NOTHING\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemWhite extends DynamicAtlasItem {\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\n\t\tcontext.save();\n\t\tcontext.fillStyle = \"#ffffff\";\n\t\tcontext.fillRect( frame.x - 1, frame.y - 1, frame.width + 2, frame.height + 2 );\n\t\tcontext.restore();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, MIPMAP_MODES, Texture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\nimport { DynamicAtlasItemEmpty } from \"./dynamic-atlas-item-empty\";\nimport { DynamicAtlasItemWhite } from \"./dynamic-atlas-item-white\";\n\nconst MAXIMUM_TEXTURE_SIZE = 4096;\n\nexport class DynamicAtlas {\n\tprotected static INSTANCE: DynamicAtlas | null;\n\n\tprotected _canvas: HTMLCanvasElement;\n\tprotected _sortedData: DynamicAtlasItem[];\n\tprotected _idToDatum: { [ id: string ]: DynamicAtlasItem };\n\tprotected _baseTexture: BaseTexture;\n\tprotected _isDirty: boolean;\n\tprotected _predefined: { [ id: string ]: DynamicAtlasItem };\n\n\tconstructor( resolution: number ) {\n\t\tconst canvas = this._canvas = document.createElement( \"canvas\" );\n\t\tcanvas.width = canvas.height = 256;\n\n\t\tconst baseTexture = this._baseTexture = BaseTexture.from( canvas, {\n\t\t\tmipmap: MIPMAP_MODES.OFF,\n\t\t\tresolution\n\t\t});\n\n\t\tthis._idToDatum = {};\n\t\tthis._sortedData = [];\n\t\tthis._predefined = {\n\t\t\tempty: new DynamicAtlasItemEmpty(\n\t\t\t\t\"empty\", 10, 10, 0, baseTexture\n\t\t\t),\n\t\t\twhite: new DynamicAtlasItemWhite(\n\t\t\t\t\"white\", 10, 10, 0, baseTexture\n\t\t\t)\n\t\t};\n\n\t\tthis._isDirty = true;\n\t}\n\n\tupdateFrames( width: number, data: DynamicAtlasItem[] ): number {\n\t\tconst padding = 4;\n\t\tlet x = padding;\n\t\tlet y = padding;\n\t\tlet maxRowHeight = 0;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( width < x + datum.frame.width + padding ) {\n\t\t\t\tx = padding;\n\t\t\t\ty += maxRowHeight + padding;\n\t\t\t\tmaxRowHeight = 0;\n\t\t\t}\n\t\t\tdatum.frame.x = x | 0;\n\t\t\tdatum.frame.y = y | 0;\n\t\t\tx += datum.frame.width + padding;\n\t\t\tmaxRowHeight = Math.max( maxRowHeight, datum.frame.height );\n\t\t}\n\n\t\tconst minHeight = y + maxRowHeight + padding;\n\t\tlet result = 256;\n\t\twhile( result < minHeight ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn Math.min( MAXIMUM_TEXTURE_SIZE, result );\n\t}\n\n\trenderFrames( width: number, height: number, data: DynamicAtlasItem[] ): void {\n\t\tconst canvas = this._canvas;\n\t\tcanvas.width = width;\n\t\tcanvas.height = height;\n\t\tconst context = canvas.getContext( \"2d\" );\n\t\tif( context != null ) {\n\t\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\t\tconst datum = data[ i ];\n\t\t\t\tdatum.render( context );\n\t\t\t}\n\t\t}\n\t}\n\n\tapplyFrames( data: DynamicAtlasItem[] ): void {\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tdatum.applyFrame();\n\t\t}\n\t}\n\n\tcalcCanvasWidth( data: DynamicAtlasItem[] ): number {\n\t\tlet result = 128;\n\t\tfor( let i = data.length - 1; 0 <= i; --i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tconst size = Math.max( datum.frame.width, datum.frame.height );\n\t\t\twhile( result < size ) {\n\t\t\t\tresult <<= 1;\n\t\t\t}\n\t\t}\n\t\treturn Math.min( MAXIMUM_TEXTURE_SIZE, result << 1 );\n\t}\n\n\tcleanup( data: DynamicAtlasItem[] ): void {\n\t\tdata.sort( DynamicAtlas.ITEM_COMPARATOR );\n\t\tfor( let i = data.length - 1; 0 <= i; --i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( 0 < datum.ref ) {\n\t\t\t\tdata.length = i + 1;\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tdata.length = 0;\n\t}\n\n\tbegin(): void {\n\t\tconst data = this._sortedData;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tdatum.ref = 0;\n\t\t}\n\n\t\tthis._isDirty = false;\n\t}\n\n\tend(): void {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst data = this._sortedData;\n\t\tfor( let i = 0, imax = data.length; i < imax; ++i ) {\n\t\t\tconst datum = data[ i ];\n\t\t\tif( datum.ref <= 0 ) {\n\t\t\t\tif( !( datum.id in this._predefined ) ) {\n\t\t\t\t\tdatum.destroy();\n\t\t\t\t}\n\t\t\t\tdelete idToDatum[ datum.id ];\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\trepack( forcibly?: boolean ): void {\n\t\tif( forcibly === true || this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tconst data = this._sortedData;\n\t\t\tthis.cleanup( data );\n\t\t\tconst canvasWidth = this.calcCanvasWidth( data );\n\t\t\tconst canvasHeight = this.updateFrames( canvasWidth, data );\n\t\t\tthis.renderFrames( canvasWidth, canvasHeight, data );\n\t\t\tthis._baseTexture.setRealSize( canvasWidth, canvasHeight );\n\t\t\tthis.applyFrames( data );\n\t\t}\n\t}\n\n\tget( id: string ): DynamicAtlasItem | null {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst datum =  idToDatum[ id ];\n\t\tif( datum != null ) {\n\t\t\tdatum.ref += 1;\n\t\t\treturn datum;\n\t\t} else {\n\t\t\tconst predefined = this._predefined[ id ];\n\t\t\tif( predefined != null ) {\n\t\t\t\tthis.set( id, predefined );\n\t\t\t\treturn predefined;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( id: string, item: DynamicAtlasItem ): DynamicAtlasItem | undefined {\n\t\tconst result = this._idToDatum[ id ];\n\t\titem.ref += 1;\n\t\tthis._idToDatum[ id ] = item;\n\t\tthis._sortedData.push( item );\n\t\tthis._isDirty = true;\n\t\treturn result;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._isDirty = true;\n\t}\n\n\tgetDefaultTexture(): Texture {\n\t\treturn this.get( \"white\" )!.texture;\n\t}\n\n\tgetBaseTexture(): BaseTexture {\n\t\treturn this._baseTexture;\n\t}\n\n\trelease( id: string ): void {\n\t\tconst idToDatum = this._idToDatum;\n\t\tconst datum = idToDatum[ id ];\n\t\tif( datum != null ) {\n\t\t\tdatum.ref -= 1;\n\t\t\tif( datum.ref <= 0 ) {\n\t\t\t\tif( !( datum.id in this._predefined ) ) {\n\t\t\t\t\tdatum.destroy();\n\t\t\t\t}\n\t\t\t\tdelete idToDatum[ id ];\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic ITEM_COMPARATOR = ( a: DynamicAtlasItem, b: DynamicAtlasItem ): number => {\n\t\tif( a.ref <= 0 ) {\n\t\t\tif( b.ref <= 0 ) {\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\treturn +1;\n\t\t\t}\n\t\t} else {\n\t\t\tif( b.ref <= 0 ) {\n\t\t\t\treturn -1;\n\t\t\t}\n\t\t}\n\n\t\tif( a.frame.height < b.frame.height ) {\n\t\t\treturn -1;\n\t\t} else if( b.frame.height < a.frame.height ) {\n\t\t\treturn +1;\n\t\t} else {\n\t\t\treturn a.frame.width - b.frame.width;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\nimport { DynamicSDFFontAtlas } from \"./dynamic-sdf-font-atlas\";\n\nexport class DynamicAtlasItemFontAtlas extends DynamicAtlasItem {\n\tcanvas: HTMLCanvasElement | null;\n\n\tconstructor( atlas: DynamicSDFFontAtlas, baseTexture: BaseTexture ) {\n\t\tsuper( atlas.id, atlas.width / baseTexture.resolution, atlas.height / baseTexture.resolution, 0, baseTexture );\n\t\tthis.canvas = atlas.canvas;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst frame = this.frame;\n\t\t\tcontext.drawImage( canvas, frame.x, frame.y, frame.width, frame.height );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const ASCII_CHARACTERS =\n\t\" !\\\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\\\]^_`abcdefghijklmnopqrstuvwxyz{|}~\";\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DynamicFontAtlasCharacterOrigin {\n\tx: number;\n\ty: number;\n\n\tconstructor( x: number, y: number ) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicFontAtlasCharacterOrigin } from \"./dynamic-font-atlas-chaaracter-origin\";\n\nexport class DynamicFontAtlasCharacter {\n\tref: number;\n\tlife: number;\n\tx: number;\n\ty: number;\n\twidth: number;\n\theight: number;\n\tadvance: number;\n\torigin: DynamicFontAtlasCharacterOrigin;\n\treserved: boolean;\n\n\tconstructor( advance: number, width: number, height: number, reserved: boolean ) {\n\t\tthis.ref = 1;\n\t\tthis.life = 10;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.width = width;\n\t\tthis.height = height;\n\t\tthis.advance = advance;\n\t\tthis.origin = new DynamicFontAtlasCharacterOrigin( 0, 0 );\n\t\tthis.reserved = reserved;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemes } from \"../theme/d-themes\";\nimport { ASCII_CHARACTERS } from \"./ascii\";\nimport { DynamicFontAtlasCharacter } from \"./dynamic-font-atlas-character\";\nimport { DynamicFontAtlasCharacters } from \"./dynamic-font-atlas-characters\";\nimport { DynamicSDFFontGenerator } from \"./dynamic-sdf-font-generator\";\nimport { UtilCharacterIterator } from \"./util-character-iterator\";\n\nexport interface DynamicSDFFontAtlasFont {\n\tfamily: string;\n\tsize: number;\n\titalic: boolean;\n}\n\nexport interface DynamicSDFFontAtlasJson {\n\twidth: number;\n\theight: number;\n\tfont: DynamicSDFFontAtlasFont;\n\tcharacters: DynamicFontAtlasCharacters;\n}\n\nexport class DynamicSDFFontAtlas {\n\tprotected static FONT_FAMILY_AUTO: string | null = null;\n\n\tprotected _id: string;\n\tprotected _generator: DynamicSDFFontGenerator | null;\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _font: DynamicSDFFontAtlasFont;\n\tprotected _characters: DynamicFontAtlasCharacters;\n\tprotected _length: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _isDirty: boolean;\n\n\tconstructor( fontFamily: string ) {\n\t\tthis._id = `font-atlas:${fontFamily}`;\n\t\tthis._generator = DynamicSDFFontGenerator.getInstance().init();\n\t\tthis._canvas = document.createElement( \"canvas\" );\n\t\tthis._font = {\n\t\t\tfamily: DynamicSDFFontAtlas.toFontFamily( fontFamily ),\n\t\t\tsize: 32,\n\t\t\titalic: false\n\t\t};\n\t\tthis._characters = {};\n\t\tthis._length = 0;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\t\tthis._isDirty = true;\n\t}\n\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget font(): DynamicSDFFontAtlasFont {\n\t\treturn this._font;\n\t}\n\n\tset font( font: DynamicSDFFontAtlasFont ) {\n\t\tthis._font.family = font.family;\n\t\tthis._font.size = font.size;\n\t\tthis._font.italic = font.italic;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tget canvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tget generator(): DynamicSDFFontGenerator | null {\n\t\treturn this._generator;\n\t}\n\n\tget characters(): DynamicFontAtlasCharacters {\n\t\treturn this._characters;\n\t}\n\n\tbegin(): void {\n\t\tthis._length = 0;\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tcharacters[ character ].ref = 0;\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data.ref <= 0 ) {\n\t\t\t\tdata.life -= 1;\n\t\t\t\tif( data.life <= 0 ) {\n\t\t\t\t\tdelete characters[ character ];\n\t\t\t\t\tthis._isDirty =  true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\taddAscii(): void {\n\t\tthis.add( ASCII_CHARACTERS );\n\t\tthis.addChar( \"...\" );\n\t}\n\n\taddChar( character: string ): void {\n\t\tconst characters = this._characters;\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( data.ref <= 0 ) {\n\t\t\t\t\tthis._length += 1;\n\t\t\t\t}\n\t\t\t\tdata.ref += 1;\n\t\t\t} else {\n\t\t\t\tcharacters[ character ] = new DynamicFontAtlasCharacter( 0, 1, 1, false );\n\t\t\t\tthis._length += 1;\n\t\t\t\tthis._isDirty = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( characters: string ): void {\n\t\tconst iterator = UtilCharacterIterator.from( characters );\n\t\twhile( iterator.hasNext() ) {\n\t\t\tthis.addChar( iterator.next() );\n\t\t}\n\t}\n\n\tget( character: string ): DynamicFontAtlasCharacter | undefined {\n\t\treturn this._characters[ character ];\n\t}\n\n\tupdate(): boolean {\n\t\tif( this._isDirty ) {\n\t\t\tconst canvas = this._canvas;\n\t\t\tconst generator = this._generator;\n\t\t\tif( canvas != null && generator != null ) {\n\t\t\t\tconst context = canvas.getContext( \"2d\" );\n\t\t\t\tif( context != null ) {\n\t\t\t\t\tthis._isDirty = false;\n\n\t\t\t\t\tconst font = this._font;\n\t\t\t\t\tconst characters = this._characters;\n\t\t\t\t\tconst characterSize = font.size + 14;\n\t\t\t\t\tconst width = DynamicSDFFontAtlas.toPowerOf2( Math.ceil( Math.sqrt( this._length ) ) * characterSize );\n\t\t\t\t\tthis._width = width;\n\t\t\t\t\tconst fontStyle = (font.italic ? \"italic \" : \"\") + (font.size + \"px \") + font.family;\n\n\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\tcontext.textAlign = \"left\";\n\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\tcontext.lineWidth = 0;\n\t\t\t\t\tcontext.lineCap = \"round\";\n\t\t\t\t\tcontext.lineJoin = \"miter\";\n\t\t\t\t\tcontext.miterLimit = 0;\n\t\t\t\t\tcontext.fillStyle = \"#FFFFFF\";\n\n\t\t\t\t\tconst offsetX = 7;\n\t\t\t\t\tconst offsetY = ( characterSize >> 1 );\n\t\t\t\t\tlet x = 0;\n\t\t\t\t\tlet y = 0;\n\t\t\t\t\tfor( const character in characters ) {\n\t\t\t\t\t\tconst data = characters[ character ];\n\t\t\t\t\t\tconst advance = context.measureText( character ).width;\n\t\t\t\t\t\tconst characterWidth = Math.ceil( offsetX + advance + offsetX );\n\t\t\t\t\t\tconst characterHeight = characterSize;\n\t\t\t\t\t\tif( width <= x + characterWidth ) {\n\t\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\t\ty += characterSize;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tdata.x = x;\n\t\t\t\t\t\tdata.y = y;\n\t\t\t\t\t\tdata.width = characterWidth;\n\t\t\t\t\t\tdata.height = characterHeight;\n\t\t\t\t\t\tdata.advance = advance;\n\t\t\t\t\t\tdata.origin.x = x + offsetX;\n\t\t\t\t\t\tdata.origin.y = y + offsetY;\n\n\t\t\t\t\t\tx += characterWidth;\n\t\t\t\t\t}\n\t\t\t\t\tconst height = this._height = y + characterSize;\n\n\t\t\t\t\t// Make a input canvas\n\t\t\t\t\t// Here, we need to reset the context because\n\t\t\t\t\t// context settings will be lost when we set the width/height.\n\t\t\t\t\tcanvas.width = width;\n\t\t\t\t\tcanvas.height = height;\n\t\t\t\t\tcontext.font = fontStyle;\n\t\t\t\t\tcontext.textAlign = \"left\";\n\t\t\t\t\tcontext.textBaseline = \"middle\";\n\t\t\t\t\tcontext.lineWidth = 0;\n\t\t\t\t\tcontext.lineCap = \"round\";\n\t\t\t\t\tcontext.lineJoin = \"miter\";\n\t\t\t\t\tcontext.miterLimit = 4;\n\t\t\t\t\tcontext.fillStyle = \"#FFFFFF\";\n\t\t\t\t\tcontext.clearRect( 0, 0, width, height );\n\t\t\t\t\tfor( const character in characters ) {\n\t\t\t\t\t\tconst data = characters[ character ];\n\t\t\t\t\t\tcontext.fillText( character, data.origin.x, data.origin.y );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Convert to SDF font texture\n\t\t\t\t\tgenerator.updateTexture( canvas );\n\t\t\t\t\tgenerator.render();\n\t\t\t\t\tgenerator.read( canvas );\n\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tget length(): number {\n\t\treturn this._length;\n\t}\n\n\ttoJson(): DynamicSDFFontAtlasJson {\n\t\treturn {\n\t\t\twidth: this._width,\n\t\t\theight: this._height,\n\t\t\tfont: this._font,\n\t\t\tcharacters: this._characters\n\t\t};\n\t}\n\n\ttoString(): string {\n\t\treturn JSON.stringify( this.toJson() );\n\t}\n\n\tdestroy() {\n\t\tconst generator = this._generator;\n\t\tif( generator != null ) {\n\t\t\tthis._generator = null;\n\t\t}\n\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t}\n\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tdelete characters[ character ];\n\t\t}\n\t}\n\n\tstatic toFontFamily( fontFamily: string ) {\n\t\treturn ( fontFamily === \"auto\" ?\n\t\t\tDynamicSDFFontAtlas.getAutoFontFamily() :\n\t\t\tfontFamily\n\t\t);\n\t}\n\n\tstatic toPowerOf2( size: number ): number {\n\t\tlet result = 32;\n\t\twhile( result < size ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic getAutoFontFamily(): string {\n\t\tif( DynamicSDFFontAtlas.FONT_FAMILY_AUTO == null ) {\n\t\t\tDynamicSDFFontAtlas.FONT_FAMILY_AUTO = (DThemes.getInstance().get( \"DBase\" ) as any).getFontFamilly() as string;\n\t\t}\n\t\treturn DynamicSDFFontAtlas.FONT_FAMILY_AUTO;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DynamicAtlas } from \"./dynamic-atlas\";\nimport { DynamicAtlasItemFontAtlas } from \"./dynamic-atlas-item-font-atlas\";\nimport { DynamicSDFFontAtlas } from \"./dynamic-sdf-font-atlas\";\n\nexport class DynamicSDFFontAtlases {\n\tprotected _atlases: { [ family: string ]: DynamicSDFFontAtlas };\n\n\tconstructor() {\n\t\tthis._atlases = {};\n\t}\n\n\tbegin(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tatlas.begin();\n\t\t}\n\t}\n\n\tend(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tif( 0 < atlas.length ) {\n\t\t\t\tatlas.addAscii();\n\t\t\t}\n\t\t\tatlas.end();\n\t\t\tif( atlas.length <= 0 ) {\n\t\t\t\tatlas.destroy();\n\t\t\t\tdelete atlases[ family ];\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( family: string, targets: string ) {\n\t\tconst atlas = this._atlases[ family ];\n\t\tif( atlas != null ) {\n\t\t\tatlas.add( targets );\n\t\t} else {\n\t\t\tconst newAtlas = new DynamicSDFFontAtlas( family );\n\t\t\tnewAtlas.add( targets );\n\t\t\tthis._atlases[ family ] = newAtlas;\n\t\t}\n\t}\n\n\tget( family: string ): DynamicSDFFontAtlas | null {\n\t\tconst atlas = this._atlases[ family ];\n\t\tif( atlas != null ) {\n\t\t\treturn atlas;\n\t\t}\n\t\treturn null;\n\t}\n\n\tupdate( baseAtlas: DynamicAtlas ): void {\n\t\tconst atlases = this._atlases;\n\t\tconst baseTexture = baseAtlas.getBaseTexture();\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tif( atlas.update() ) {\n\t\t\t\tconst atlasId = atlas.id;\n\t\t\t\tconst item = baseAtlas.get( atlasId );\n\t\t\t\tif( item != null ) {\n\t\t\t\t\tconst width = atlas.width;\n\t\t\t\t\tconst height = atlas.height;\n\t\t\t\t\tconst resolution = baseTexture.resolution;\n\t\t\t\t\titem.frame.width = width;\n\t\t\t\t\titem.frame.height = height;\n\t\t\t\t\titem.width = width / resolution;\n\t\t\t\t\titem.height = height / resolution;\n\t\t\t\t\tbaseAtlas.toDirty();\n\t\t\t\t} else {\n\t\t\t\t\tbaseAtlas.set(\n\t\t\t\t\t\tatlasId,\n\t\t\t\t\t\tnew DynamicAtlasItemFontAtlas( atlas, baseTexture )\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst atlases = this._atlases;\n\t\tfor( const family in atlases ) {\n\t\t\tconst atlas = atlases[ family ];\n\t\t\tatlas.destroy();\n\t\t}\n\t\tthis._atlases = {};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemImage extends DynamicAtlasItem {\n\timage: HTMLImageElement;\n\n\tconstructor( image: HTMLImageElement, baseTexture: BaseTexture ) {\n\t\tsuper( image.src, image.width / baseTexture.resolution, image.height / baseTexture.resolution, 0, baseTexture );\n\t\tthis.image = image;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\t\tconst x = frame.x;\n\t\tconst y = frame.y;\n\t\tconst w = frame.width;\n\t\tconst h = frame.height;\n\t\tconst image = this.image;\n\n\t\tcontext.drawImage( image, x, y, w, h );\n\n\t\tcontext.drawImage( image, 0, 0, 1, h, x - 1, y - 1, 1, h + 2 );\n\t\tcontext.drawImage( image, 0, 0, w, 1, x, y - 1, w, 1 );\n\t\tcontext.drawImage( image, w - 1, 0, 1, h, x + w, y - 1, 1, h + 2 );\n\t\tcontext.drawImage( image, 0, h - 1, w, 1, x, y + h, w, 1 );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\n\nconst DUMMY_SHAPES: EShape[] = [];\n\nexport class EShapeRendererIteratorDatum {\n\tprotected index: number;\n\tprotected shapes: EShape[];\n\n\tconstructor() {\n\t\tthis.index = 0;\n\t\tthis.shapes = DUMMY_SHAPES;\n\t}\n\n\treset( shapes: EShape[] ) {\n\t\tthis.index = -1;\n\t\tthis.shapes = shapes;\n\t}\n\n\tnext(): EShape | null {\n\t\tconst index = this.index = this.index + 1;\n\t\tconst shapes = this.shapes;\n\t\tif( index < shapes.length ) {\n\t\t\treturn shapes[ index ];\n\t\t}\n\t\treturn null;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeRendererIteratorDatum } from \"./e-shape-renderer-iterator-datum\";\n\nexport class EShapeRendererIterator {\n\tprotected _index: number;\n\tprotected _data: EShapeRendererIteratorDatum[];\n\tprotected _datum: EShapeRendererIteratorDatum;\n\tprotected _current: EShape | null;\n\n\tconstructor() {\n\t\tthis._index = -1;\n\t\tthis._datum = new EShapeRendererIteratorDatum();\n\t\tthis._data = [ this._datum ];\n\t\tthis._current = null;\n\t}\n\n\treset( shapes: EShape[] ): EShape | null {\n\t\tthis._index = 0;\n\t\tconst current = this._datum = this._data[ 0 ];\n\t\tcurrent.reset( shapes );\n\t\tthis._current = null;\n\t\treturn this.next();\n\t}\n\n\tget(): EShape | null {\n\t\treturn this._current;\n\t}\n\n\tnext(): EShape | null {\n\t\tconst datum = this._datum;\n\t\tconst shape = datum.next();\n\t\tif( shape != null ) {\n\t\t\tthis._current = shape;\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tconst datumIndex = this._index = this._index + 1;\n\t\t\t\tconst data = this._data;\n\t\t\t\tif( datumIndex < data.length ) {\n\t\t\t\t\tconst newDatum = data[ datumIndex ];\n\t\t\t\t\tnewDatum.reset( children );\n\t\t\t\t\tthis._datum = newDatum;\n\t\t\t\t} else {\n\t\t\t\t\tconst newDatum = new EShapeRendererIteratorDatum();\n\t\t\t\t\tdata.push( newDatum );\n\t\t\t\t\tnewDatum.reset( children );\n\t\t\t\t\tthis._datum = newDatum;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn shape;\n\t\t} else {\n\t\t\tconst datumIndex = this._index = this._index - 1;\n\t\t\tconst data = this._data;\n\t\t\tif( 0 <= datumIndex ) {\n\t\t\t\tthis._datum = data[ datumIndex ];\n\t\t\t\tthis._current = null;\n\t\t\t\treturn this.next();\n\t\t\t} else {\n\t\t\t\tthis._current = null;\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, BLEND_MODES, ObjectRenderer, Renderer, Shader, Texture, utils } from \"pixi.js\";\nimport { DynamicAtlas } from \"../util/dynamic-atlas\";\nimport { DynamicAtlasItemImage } from \"../util/dynamic-atlas-item-image\";\nimport { DynamicSDFFontAtlases } from \"../util/dynamic-sdf-font-atlases\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeRendererIterator } from \"./e-shape-renderer-iterator\";\n\nconst VERTEX_SHADER = `\nattribute vec2 aPosition;\nattribute vec3 aClipping;\nattribute vec2 aStep;\nattribute vec4 aAntialias;\nattribute vec4 aColorFill;\nattribute vec4 aColorStroke;\nattribute vec2 aUv;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mediump float pixelScale;\nuniform mediump float antialiasWeight;\n\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nvec2 toInverse( in vec2 v ) {\n\treturn vec2( -v.y, v.x );\n}\n\nvec2 toTransformedPosition( in vec2 v ) {\n\treturn (projectionMatrix * translationMatrix * vec3(v, 1.0)).xy;\n}\n\nvec4 toAntialias01( in vec4 antialias, in float scale ) {\n\t// Taylor series of 1 / ( 1 - a ) = 1 + a + a^2 + ....\n\treturn 1.0 + min( vec4( 1.0 ), antialias * scale );\n}\n\nvec4 toAntialias2( in vec2 step, in vec4 antialias, in float scale ) {\n\tfloat x = min( 0.4, step.x * scale );\n\tfloat y = 0.5 - antialias.x;\n\tfloat z = 0.5 - antialias.x - step.y;\n\treturn vec4( y, z, y - max( 0.01, y - x ), z - max( 0.01, z - x ) );\n}\n\nvec2 toPosition3456( in float type, in vec2 p, in vec2 pprev, in vec2 pnext, in float strokeWidth, out float shift ) {\n\tvec2 d0 = p - pprev;\n\tvec2 d1 = pnext - p;\n\tfloat l0 = dot( d0, d0 );\n\tfloat l1 = dot( d1, d1 );\n\tvec2 nd0 = normalize( toInverse( d0 ) );\n\tvec2 nd1 = normalize( toInverse( d1 ) );\n\tvec2 n0 = 0.00001 < l0 ? nd0 : nd1;\n\tvec2 n1 = 0.00001 < l1 ? nd1 : nd0;\n\tvec2 n0i = toInverse( n0 );\n\tvec2 n1i = toInverse( n1 );\n\tfloat direction = sign( 4.5 - type );\n\n\t// Offset\n\tfloat cross = dot( n0i, n1 );\n\tfloat crossInverse = ( 0.00001 < abs( cross ) ? 1.0 / cross : 0.0 );\n\tfloat b = dot(n1 - n0, n0) * crossInverse;\n\tfloat offsetSize = direction * strokeWidth * 0.5;\n\tvec2 offset = n1 + n1i * b;\n\n\t// Miter\n\tvec2 pmiter = p + offsetSize * offset;\n\tfloat miterAngle0 = dot( n0i, pmiter - pprev );\n\tfloat miterAngle1 = dot( n1i, pmiter - pnext );\n\tfloat miterLength = dot( offset, offset );\n\tfloat miterSide = direction * cross;\n\n\t// Bevel\n\tvec2 n = ( type == 4.0 || type == 6.0 ? n1 : n0 );\n\tvec2 pbevel = p + offsetSize * n;\n\n\t//\n\tvec2 presult = (\n\t\t0.0 <= miterAngle0 || miterAngle1 < 0.0 || miterSide < 0.0 ?\n\t\tpbevel : pmiter\n\t);\n\t/*\n\tvec2 presult = (\n\t\tmiterAngle0 < 0.0 && 0.0 <= miterAngle1 && miterLength < 50.0 ?\n\t\tpmiter : pbevel\n\t);\n\t*/\n\tvec2 ni = ( type == 4.0 || type == 6.0 ? n1i : n0i );\n\tshift = dot( ni, p - presult );\n\treturn toTransformedPosition( presult );\n}\n\nvec2 toStep3456( in float type ) {\n\treturn ( type < 4.5 ? vec2( 1.0, 0.0 ) : vec2( 0.0, 1.0 ) );\n}\n\nvec4 toAntialias3456( in float strokeWidth, in float scale ) {\n\tfloat a = antialiasWeight / max( 0.0001, strokeWidth );\n\treturn toAntialias01( vec4( a, a, a, a ), scale );\n}\n\nfloat toDotAndDashScale( in float scale, in float strokeWidthScale ) {\n\treturn (\n\t\tscale == 4.0 || scale == 5.0 || scale == 6.0 || scale == 7.0 ?\n\t\tstrokeWidthScale : 1.0\n\t);\n}\n\nvec4 toColorStroke3456( in float shift, in float scale ) {\n\tfloat x = aColorFill.x + shift;\n\tfloat y = scale * aColorFill.y;\n\tfloat z = scale * aColorFill.z;\n\tfloat w = aColorFill.w;\n\treturn vec4( x, y, z, w );\n}\n\nfloat toStrokeWidthScale( in float scale ) {\n\treturn (\n\t\tscale == 3.0 || scale == 7.0 ?\n\t\tpixelScale : (\n\t\t\tscale == 1.0 || scale == 5.0 ?\n\t\t\tmin( 1.0, pixelScale ) : (\n\t\t\t\tscale == 2.0 || scale == 6.0 ?\n\t\t\t\tmax( 1.0, pixelScale ) : 1.0\n\t\t\t)\n\t\t)\n\t);\n}\n\nvoid main(void) {\n\tvec2 p012 = toTransformedPosition( aPosition );\n\n\tfloat type = aClipping.z;\n\n\t// type === 0 or 1\n\tvec4 a01 = toAntialias01( aAntialias, pixelScale );\n\n\t// type === 2\n\tvec4 a2 = toAntialias2( aStep, aAntialias, pixelScale );\n\n\t// type === 3, 4, 5 or 6\n\tfloat shift3456 = 0.0;\n\tfloat strokeWidthScale = toStrokeWidthScale( aStep.y );\n\tfloat strokeWidth = strokeWidthScale * aStep.x;\n\tvec2 p3456 = toPosition3456( type, aPosition, aAntialias.xy, aAntialias.zw, strokeWidth, shift3456 );\n\tvec2 step3456 = toStep3456( type );\n\tvec4 a3456 = toAntialias3456( strokeWidth, pixelScale );\n\tvec4 colorStroke3456 = toColorStroke3456( shift3456, toDotAndDashScale( aStep.y, strokeWidthScale ) );\n\n\t//\n\tgl_Position = vec4( ( 2.5 < type ? p3456 : p012 ), 0.0, 1.0 );\n\tvAntialias = ( 1.5 < type ? ( 2.5 < type ? a3456 : a2 ) : a01 );\n\tvClipping = aClipping;\n\tvStep = ( 2.5 < type ? step3456 : aStep );\n\tvColorFill = ( 2.5 < type ? aColorStroke : aColorFill );\n\tvColorStroke = ( 2.5 < type ? colorStroke3456 : aColorStroke );\n\tvUv = aUv;\n}`;\n\nconst FRAGMENT_SHADER_NO_AA = `\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec2 d01 = ( v0.x < v0.y ? vec2( v0.y, v2.y ) : vec2( v0.x, v2.x ) );\n\tvec2 d02 = ( v1.x < v1.y ? vec2( v1.y, v3.y ) : vec2( v1.x, v3.x ) );\n\tvec4 d0 = vec4( d01.x, d02.x, d01.y, d02.y );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = step( vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = step( 0.0, lm );\n\tfloat ls1 = step( lp0, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - step( lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}`;\n\nconst FRAGMENT_SHADER = `\nvarying mediump vec3 vClipping;\nvarying mediump vec2 vStep;\nvarying mediump vec4 vAntialias;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float pixelScale;\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tfloat type = vClipping.z;\n\tvec2 v0 = vStep;\n\tvec2 v1 = vClipping.xy;\n\tvec2 v2 = v0 * vAntialias.xy;\n\tvec2 v3 = v1 * vAntialias.zw;\n\tvec2 d01 = ( v0.x < v0.y ? vec2( v0.y, v2.y ) : vec2( v0.x, v2.x ) );\n\tvec2 d02 = ( v1.x < v1.y ? vec2( v1.y, v3.y ) : vec2( v1.x, v3.x ) );\n\tvec4 d0 = vec4( d01.x, d02.x, d01.y, d02.y );\n\tvec4 d1 = vec4( dot( v0, v0 ), dot( v1, v1 ), dot( v2, v2 ), dot( v3, v3 ) );\n\tvec4 d = ( type == 1.0 ? d1 : d0 );\n\tvec2 s = smoothstep( 1.0 - (d.zw - d.xy), vec2( 1.0 ), d.xy );\n\tvec4 color01 = texture * (vColorStroke * (s.x - s.y) + vColorFill * (1.0 - s.x));\n\n\tfloat l = vColorStroke.x;\n\tfloat lp0 = vColorStroke.y;\n\tfloat lp1 = vColorStroke.z;\n\tfloat lt = vColorStroke.w;\n\tfloat ld = 0.5 * pixelScale;\n\tfloat lm = mod( l, lp0 + lp1 );\n\tfloat ls0 = smoothstep( 0.0, 0.0 + ld, lm );\n\tfloat ls1 = smoothstep( lp0, lp0 + ld, lm );\n\tfloat ls2 = ( 0.0 <= lt ? 1.0 - smoothstep( lt - ld, lt, l ) : 1.0 );\n\tvec4 color3456 = color01 * ( ls0 - ls1 ) * ls2;\n\n\tvec2 a0 = vAntialias.xy;\n\tvec2 a1 = vAntialias.zw;\n\tvec2 a2 = vec2( texture.a );\n\tvec2 a = smoothstep( a0 - a1, a0 + a1, a2 );\n\tvec4 color2 = a.x * vColorFill + ( a.y - a.x ) * vColorStroke;\n\tgl_FragColor = ( type == 2.0 ? color2 : (2.5 < type ? color3456 : color01) );\n}`;\n\nexport class EShapeRenderer extends ObjectRenderer {\n\tstatic SHADER: Shader | null = null;\n\n\tprotected _shader: Shader | null;\n\tprotected _iterator: EShapeRendererIterator;\n\tprotected _bufferSizeMax: number;\n\n\tconstructor( renderer: Renderer ) {\n\t\tsuper( renderer );\n\t\tEShapeRenderer.SHADER = EShapeRenderer.SHADER || Shader.from( VERTEX_SHADER, FRAGMENT_SHADER );\n\t\tthis._shader = EShapeRenderer.SHADER;\n\t\tthis._iterator = new EShapeRendererIterator();\n\t\tthis._bufferSizeMax = this.getBufferSizeMax( renderer );\n\t}\n\n\tprotected getBufferSizeMax( renderer: Renderer ): number {\n\t\tconst context = renderer.context;\n\t\tconst extensions = context.extensions as any;\n\t\tif( 1 < context.webGLVersion || !! extensions.uint32ElementIndex ) {\n\t\t\treturn 1431655765; // 2^32 / 3\n\t\t}\n\t\treturn 21845; // 2^16 / 3\n\t}\n\n\tupdateAtlas(\n\t\tshape: EShape,\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture, baseTexture: BaseTexture\n\t): void {\n\t\t// Texture\n\t\t// Do not access the shape.image.src here.\n\t\t// It slows down the rendering speed significantly.\n\t\tconst imageSrc = shape.imageSrc;\n\t\tif( imageSrc != null ) {\n\t\t\tconst textureItem = atlas.get( imageSrc );\n\t\t\tif( textureItem != null ) {\n\t\t\t\tshape.texture = textureItem.texture;\n\t\t\t} else {\n\t\t\t\tconst newTextureItem = new DynamicAtlasItemImage( shape.image!, baseTexture );\n\t\t\t\tshape.texture = newTextureItem.texture;\n\t\t\t\tatlas.set( newTextureItem.id, newTextureItem );\n\t\t\t}\n\t\t} else {\n\t\t\tshape.texture = defaultTexture;\n\t\t}\n\n\t\t// Font texture atlas\n\t\tconst text = shape.text;\n\t\tconst textValue = text.value;\n\t\tif( 0 < textValue.length ) {\n\t\t\tfontAtlases.add( text.family, textValue );\n\t\t}\n\t}\n\n\tupdateAtlases(\n\t\tshapes: EShape[],\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture, baseTexture: BaseTexture\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tthis.updateAtlas( shape, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\tconst children = shape.children;\n\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\tconst child = children[ j ];\n\t\t\t\tthis.updateAtlas( child, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t\tthis.updateAtlases( child.children, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateFontAtlas(\n\t\tshape: EShape,\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture\n\t): void {\n\t\tconst text = shape.text;\n\t\tconst fontAtlas = fontAtlases.get( text.family );\n\t\tif( fontAtlas != null ) {\n\t\t\tconst textureItem = atlas.get( fontAtlas.id );\n\t\t\tif( textureItem != null ) {\n\t\t\t\ttext.atlas = fontAtlas;\n\t\t\t\ttext.texture = textureItem.texture;\n\t\t\t} else {\n\t\t\t\ttext.atlas = undefined;\n\t\t\t\ttext.texture = defaultTexture;\n\t\t\t}\n\t\t} else {\n\t\t\ttext.atlas = undefined;\n\t\t\ttext.texture = defaultTexture;\n\t\t}\n\t}\n\n\tupdateFontAtlases(\n\t\tshapes: EShape[],\n\t\tatlas: DynamicAtlas, fontAtlases: DynamicSDFFontAtlases,\n\t\tdefaultTexture: Texture\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tthis.updateFontAtlas( shape, atlas, fontAtlases, defaultTexture );\n\t\t\tconst children = shape.children;\n\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\tconst child = children[ j ];\n\t\t\t\tthis.updateFontAtlas( child, atlas, fontAtlases, defaultTexture );\n\t\t\t\tthis.updateFontAtlases( child.children, atlas, fontAtlases, defaultTexture );\n\t\t\t}\n\t\t}\n\t}\n\n\trender_( container: EShapeContainer, shapes: EShape[], isDirty: boolean ): void {\n\t\tconst renderer = this.renderer;\n\t\tconst shader = this._shader;\n\n\t\tif( shader != null && 0 < shapes.length ) {\n\t\t\tconst resolution = renderer.resolution;\n\t\t\tconst buffers = container.getBuffers();\n\t\t\tconst antialiasWeight = container.getAntialiasWeight( resolution );\n\n\t\t\t// Update textures\n\t\t\tif( isDirty ) {\n\t\t\t\t// Atlases\n\t\t\t\tconst atlas = container.getAtlas( resolution );\n\t\t\t\tconst fontAtlases = container.getFontAtlases();\n\t\t\t\tatlas.begin();\n\t\t\t\tfontAtlases.begin();\n\t\t\t\tconst defaultTexture = atlas.getDefaultTexture();\n\t\t\t\tconst baseTexture: BaseTexture = atlas.getBaseTexture();\n\t\t\t\tthis.updateAtlases( shapes, atlas, fontAtlases, defaultTexture, baseTexture );\n\t\t\t\tfontAtlases.end();\n\t\t\t\tfontAtlases.update( atlas );\n\t\t\t\tthis.updateFontAtlases( shapes, atlas, fontAtlases, defaultTexture );\n\t\t\t\tatlas.end();\n\t\t\t\tatlas.repack();\n\n\t\t\t\t// Update buffers\n\t\t\t\tthis.updateBuffers( shapes, buffers, renderer, antialiasWeight );\n\t\t\t}\n\n\t\t\t// Render buffers\n\t\t\tshader.uniforms.pixelScale = container.toPixelScale( resolution );\n\t\t\tshader.uniforms.antialiasWeight = antialiasWeight;\n\t\t\tshader.uniforms.translationMatrix = container.worldTransform.toArray( true );\n\t\t\trenderer.shader.bind( shader, false );\n\t\t\trenderer.state!.setBlendMode(utils.correctBlendMode(BLEND_MODES.NORMAL, true));\n\t\t\tconst buffersLength = buffers.length;\n\t\t\tif( 1 < buffersLength ) {\n\t\t\t\tfor( let i = 0; i < buffersLength; ++i ) {\n\t\t\t\t\tbuffers[ i ].upload();\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor( let i = 0; i < buffersLength; ++i ) {\n\t\t\t\tbuffers[ i ].render( shader );\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateBuffers(\n\t\tshapes: EShape[], buffers: EShapeBuffer[],\n\t\trenderer: Renderer, antialiasWeight: number\n\t): void {\n\t\tconst iterator = this._iterator;\n\t\titerator.reset( shapes );\n\n\t\tlet ib = 0;\n\t\tlet bufferSize = 0;\n\t\tconst bufferSizeBase = 5000;\n\t\tconst bufferSizeMax = this._bufferSizeMax;\n\t\twhile( iterator.get() != null ) {\n\t\t\tlet buffer: EShapeBuffer | null = null;\n\t\t\tlet noMoreThanOne = false;\n\t\t\tif( 0 < bufferSize ) {\n\t\t\t\tbuffer = new EShapeBuffer( bufferSize, renderer );\n\t\t\t\tbuffers.splice( ib, 0, buffer );\n\t\t\t\tnoMoreThanOne = true;\n\t\t\t} else if( ib < buffers.length ) {\n\t\t\t\tbuffer = buffers[ ib ];\n\t\t\t\tnoMoreThanOne = false;\n\t\t\t} else {\n\t\t\t\tbuffer = new EShapeBuffer( bufferSizeBase, renderer );\n\t\t\t\tbuffers.push( buffer );\n\t\t\t\tnoMoreThanOne = false;\n\t\t\t}\n\t\t\tif( buffer.update( iterator, antialiasWeight, noMoreThanOne ) ) {\n\t\t\t\tbufferSize = 0;\n\t\t\t\tib += 1;\n\t\t\t} else {\n\t\t\t\tbufferSize = buffer.indexCountRequested;\n\t\t\t\tif( bufferSize <= bufferSizeMax ) {\n\t\t\t\t\tbufferSize = Math.ceil( bufferSize / bufferSizeBase ) * bufferSizeBase;\n\t\t\t\t\tbufferSize = Math.min( bufferSize, bufferSizeMax );\n\t\t\t\t} else {\n\t\t\t\t\t// No way to render\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif( ib < buffers.length ) {\n\t\t\tfor( let jb = ib, ibmax = buffers.length; jb < ibmax; ++jb ) {\n\t\t\t\tbuffers[ jb ].destroy();\n\t\t\t}\n\t\t\tbuffers.length = ib;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Point, Renderer } from \"pixi.js\";\nimport { DynamicAtlas } from \"../util/dynamic-atlas\";\nimport { DynamicSDFFontAtlases } from \"../util/dynamic-sdf-font-atlases\";\nimport { EShape } from \"./e-shape\";\nimport { EShapeBuffer } from \"./e-shape-buffer\";\nimport { EShapeRenderer } from \"./e-shape-renderer\";\n\nexport class EShapeContainer extends DisplayObject {\n\tprotected _shapeRenderer: EShapeRenderer | null = null;\n\n\treadonly children: EShape[];\n\tprotected _childrenId: number;\n\tprotected _childrenIdRendered: number;\n\n\tprotected _atlas: DynamicAtlas | null;\n\tprotected _fontAtlases: DynamicSDFFontAtlases;\n\n\tprotected _pixelScale: number;\n\tprotected _pixelScaleId: number;\n\n\tprotected _work: Point;\n\n\tprotected _buffers: EShapeBuffer[];\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis.children = [];\n\n\t\tthis._childrenId = 0;\n\t\tthis._childrenIdRendered = -1;\n\n\t\tthis._atlas = null;\n\t\tthis._fontAtlases = new DynamicSDFFontAtlases();\n\n\t\tthis._pixelScale = 1;\n\t\tthis._pixelScaleId = NaN;\n\n\t\tthis._work = new Point();\n\n\t\tthis._buffers = [];\n\t}\n\n\tcalculateBounds(): void {\n\t\tthis._bounds.clear();\n\t}\n\n\tonChildTransformChange(): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoDirty(): number {\n\t\treturn this._childrenId += 1;\n\t}\n\n\tisDirty(): boolean {\n\t\treturn this._childrenIdRendered < this._childrenId;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tif( !this.visible || this.worldAlpha <= 0 || !this.renderable ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst childrenId = this._childrenId;\n\t\tconst childrenIdRendered = this._childrenIdRendered;\n\t\tthis._childrenIdRendered = childrenId;\n\t\tconst isChildrenDirty = childrenIdRendered < childrenId;\n\t\tconst children = this.children;\n\n\t\tlet shapeRenderer: EShapeRenderer | null = this._shapeRenderer;\n\t\tif( shapeRenderer == null ) {\n\t\t\tshapeRenderer = this._shapeRenderer = new EShapeRenderer( renderer );\n\t\t}\n\t\trenderer.batch.setObjectRenderer( shapeRenderer );\n\n\t\tconst mask = this.mask;\n\t\tif( mask ) {\n\t\t\trenderer.mask.push( this, mask );\n\t\t\tshapeRenderer.render_( this, children, isChildrenDirty );\n\t\t\trenderer.mask.pop( this );\n\t\t} else {\n\t\t\tshapeRenderer.render_( this, children, isChildrenDirty );\n\t\t}\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\treturn false;\n\t}\n\n\tgetFontAtlases(): DynamicSDFFontAtlases {\n\t\treturn this._fontAtlases;\n\t}\n\n\tgetAtlas( resolution: number ): DynamicAtlas {\n\t\tlet atlas = this._atlas;\n\t\tif( atlas == null ) {\n\t\t\tatlas = new DynamicAtlas( resolution );\n\t\t\tthis._atlas = atlas;\n\t\t}\n\t\treturn atlas;\n\t}\n\n\tgetBuffers(): EShapeBuffer[] {\n\t\treturn this._buffers;\n\t}\n\n\ttoPixelScale( resolution: number ): number {\n\t\tthis.updateTransform();\n\t\tconst transform = this.transform;\n\t\tconst worldID = (transform as any)._worldID;\n\t\tif( worldID !== this._pixelScaleId ) {\n\t\t\tthis._pixelScaleId = worldID;\n\t\t\tconst worldTransform = transform.worldTransform;\n\t\t\tconst a = worldTransform.a;\n\t\t\tconst b = worldTransform.b;\n\t\t\tconst scale = Math.sqrt( a * a + b * b );\n\t\t\tthis._pixelScale = 1 / ( resolution * scale );\n\t\t}\n\t\treturn this._pixelScale;\n\t}\n\n\tgetPixelScale(): number {\n\t\treturn this._pixelScale;\n\t}\n\n\tgetAntialiasWeight( resolution: number ): number {\n\t\treturn 1.25 / resolution;\n\t}\n\n\thitTest( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst work = this._work;\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.visible ) {\n\t\t\t\tconst childLocal = child.toLocal( global, undefined, work );\n\t\t\t\tconst childResult = child.contains( childLocal );\n\t\t\t\tif( childResult != null ) {\n\t\t\t\t\tif( handler == null || handler( childResult ) ) {\n\t\t\t\t\t\treturn childResult;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\thitTestBBox( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst work = this._work;\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.visible ) {\n\t\t\t\tconst childLocal = child.toLocal( global, undefined, work );\n\t\t\t\tif( child.containsBBox( childLocal ) ) {\n\t\t\t\t\tif( handler == null || handler( child ) ) {\n\t\t\t\t\t\treturn child;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\n\tdestroy(): void {\n\t\t// Buffer\n\t\tconst buffers = this._buffers;\n\t\tif( buffers != null ) {\n\t\t\tfor( let i = 0, imax = buffers.length; i < imax; ++i ) {\n\t\t\t\tbuffers[ i ].destroy();\n\t\t\t}\n\t\t}\n\t\tthis._buffers.length = 0;\n\n\t\t// Shapes\n\t\tconst children = this.children;\n\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\t\tchildren.length = 0;\n\n\t\t//\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeType } from \"./e-shape-type\";\nimport { EShapeBase } from \"./variant/e-shape-base\";\n\n/**\n * {@link EShape} search utility.\n */\nexport class EShapeSearch {\n\tstatic COMPARATOR_INDEX = ( a: EShape, b: EShape ): number => {\n\t\treturn a.index - b.index;\n\t}\n\n\t/**\n\t * Returns indices of the given shapes.\n\t *\n\t * @param shapes shapes\n\t * @return indices\n\t */\n\tstatic toIndices( shapes: EShape[] ): number[] {\n\t\tconst result = [];\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tresult.push( shapes[ i ].index );\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns a depth of the given shape.\n\t *\n\t * @param shape a shape\n\t * @return a depth\n\t */\n\tstatic toDepth( shape: EShape ): number {\n\t\tlet result = 0;\n\t\tlet parent = shape.parent;\n\t\twhile( parent instanceof EShapeBase ) {\n\t\t\tresult += 1;\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns a deepest shape on the path to the given shapes.\n\t *\n\t * @param shapeA a shape\n\t * @param shapeB a shape\n\t * @return a found shape\n\t */\n\tstatic toSharedParent( shapeA: EShape, shapeB: EShape ): EShape | EShapeContainer {\n\t\tconst depthA = this.toDepth( shapeA );\n\t\tconst depthB = this.toDepth( shapeB );\n\t\tif( depthA < depthB ) {\n\t\t\tlet parent = shapeA.parent;\n\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\tif( this.isParent( shapeB, parent ) ) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\treturn parent!;\n\t\t} else {\n\t\t\tlet parent = shapeB.parent;\n\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\tif( this.isParent( shapeA, parent ) ) {\n\t\t\t\t\treturn parent;\n\t\t\t\t}\n\t\t\t\tparent = parent.parent;\n\t\t\t}\n\t\t\treturn parent!;\n\t\t}\n\t}\n\n\t/**\n\t * Returns a shape on the path to the given shape whose parent is equals to the given parent.\n\t * If there is no such shape, returns a root shape on the path.\n\t *\n\t * @param shape a shape\n\t * @param parent a parent\n\t * @returns a found shape\n\t */\n\tstatic toOfParent( shape: EShape, parent: EShape | EShapeContainer ) {\n\t\tlet shapeParent = shape.parent;\n\t\twhile( shapeParent !== parent && shapeParent instanceof EShapeBase ) {\n\t\t\tshape = shapeParent;\n\t\t\tshapeParent = shapeParent.parent;\n\t\t}\n\t\treturn shape;\n\t}\n\n\t/**\n\t * Returns true if the given target is on the path to the given shape.\n\t *\n\t * @param shape a shape\n\t * @param target a check target\n\t * @return true if the given target is on the path to the given shape\n\t */\n\tstatic isParent( shape: EShape, target: EShape | null ): boolean {\n\t\tlet parent = shape.parent;\n\t\twhile( parent instanceof EShapeBase ) {\n\t\t\tif( parent === target ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tparent = parent.parent;\n\t\t}\n\t\treturn false;\n\t}\n\n\t/**\n\t * Returns a selected shape on the path to the given shape.\n\t * If there are more than one selected shapes, returns a deepest selected shape.\n\t *\n\t * @param shape a shape\n\t * @return a found selected shape or null\n\t */\n\tstatic toSelected( shape: EShape ): EShape | null {\n\t\tlet target: EShape | EShapeContainer | null = shape;\n\t\twhile( target instanceof EShapeBase ) {\n\t\t\tif( target.selected ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t\ttarget = target.parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildById( shape: { children: EShape[] }, id: string, recursively?: boolean ): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.id === id ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChildById( child, id, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildByType( shape: { children: EShape[] }, type: EShapeType, recursively?: boolean ): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.type === type ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChildByType( child, type, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChild(\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean\n\t): EShape | null {\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( matcher( child ) ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tconst result = EShapeSearch.findChild( child, matcher, recursively );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tstatic findChildrenByType(\n\t\tshape: { children: EShape[] }, type: EShapeType, recursively?: boolean, result?: EShape[]\n\t): EShape[] {\n\t\tresult = result || [];\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.type === type ) {\n\t\t\t\tresult.push( child );\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tEShapeSearch.findChildrenByType( child, type, recursively, result );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic findChildren(\n\t\tshape: { children: EShape[] }, matcher: ( shape: EShape ) => boolean, recursively?: boolean, result?: EShape[]\n\t): EShape[] {\n\t\tresult = result || [];\n\t\tconst children = shape.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( matcher( child ) ) {\n\t\t\t\tresult.push( child );\n\t\t\t}\n\t\t\tif( recursively === true ) {\n\t\t\t\tEShapeSearch.findChildren( child, matcher, recursively, result );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeContainer } from \"./e-shape-container\";\nimport { EShapeSearch } from \"./e-shape-search\";\n\nexport class EShapeDeleter {\n\tstatic delete(\n\t\tparent: EShape | EShapeContainer, shapes?: EShape[], generateListOfDetachedShapes?: boolean\n\t): EShape[] | null {\n\t\tconst children = parent.children;\n\t\tconst length = children.length;\n\n\t\t// Update indices\n\t\tfor( let i = 0; i < length; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child.selected ) {\n\t\t\t\tchild.index = length + i;\n\t\t\t} else {\n\t\t\t\tchild.index = i;\n\t\t\t}\n\t\t}\n\n\t\t// Sort\n\t\tchildren.sort( EShapeSearch.COMPARATOR_INDEX );\n\n\t\t// Detach\n\t\tif( generateListOfDetachedShapes === true ) {\n\t\t\tfor( let i = length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.selected ) {\n\t\t\t\t\tchild.index -= length;\n\t\t\t\t\tchild.parent = null;\n\t\t\t\t\tchild.selected = false;\n\t\t\t\t\tchild.uploaded = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tconst size = children.length - (i + 1);\n\t\t\t\t\tif( 0 < size ) {\n\t\t\t\t\t\tconst result = children.splice( i + 1, size );\n\t\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tparent.onChildTransformChange();\n\t\t\t\t\t\tparent.toDirty();\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tconst result = children.splice( 0, children.length );\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\tfor( let i = length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.selected ) {\n\t\t\t\t\tchild.parent = null;\n\t\t\t\t\tchild.selected = false;\n\t\t\t\t\tchild.uploaded = undefined;\n\t\t\t\t} else {\n\t\t\t\t\tchildren.length = i + 1;\n\t\t\t\t\tif( shapes != null ) {\n\t\t\t\t\t\tshapes.length = 0;\n\t\t\t\t\t}\n\t\t\t\t\tparent.onChildTransformChange();\n\t\t\t\t\tparent.toDirty();\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tchildren.length = 0;\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t\tparent.onChildTransformChange();\n\t\t\t\tparent.toDirty();\n\t\t\t} else {\n\t\t\t\tif( shapes != null ) {\n\t\t\t\t\tshapes.length = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn null;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class EShapeResourceManagerSerialization {\n\tresources: string[];\n\ttags: string[];\n\tpieces: string[];\n\tprotected resourceToIndex: Map<string, number>;\n\tprotected tagToIndex: Map<string, number>;\n\tprotected pieceToIndex: Map<string, number>;\n\tprotected uuids: Set<number>;\n\tprotected uuidNext: number;\n\n\tconstructor() {\n\t\tthis.resources = [];\n\t\tthis.resourceToIndex = new Map<string, number>();\n\t\tthis.tags = [];\n\t\tthis.tagToIndex = new Map<string, number>();\n\t\tthis.pieces = [];\n\t\tthis.pieceToIndex = new Map<string, number>();\n\t\tthis.uuids = new Set<number>();\n\t\tthis.uuidNext = 0;\n\t}\n\n\taddResource( resource: string ): number {\n\t\treturn this.add_( resource, this.resources, this.resourceToIndex );\n\t}\n\n\taddTag( tag: string ): number {\n\t\treturn this.add_( tag, this.tags, this.tagToIndex );\n\t}\n\n\taddPiece( piece: string ): number {\n\t\treturn this.add_( piece, this.pieces, this.pieceToIndex );\n\t}\n\n\taddUuid( uuid: number ): number {\n\t\tif( uuid !== 0 ) {\n\t\t\tconst uuids = this.uuids;\n\t\t\tif( uuids.has( uuid ) ) {\n\t\t\t\treturn 0;\n\t\t\t} else {\n\t\t\t\tuuids.add( uuid );\n\t\t\t\treturn uuid;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tupdateUuid( uuid: number ): number {\n\t\tconst uuids = this.uuids;\n\t\tif( uuid !== 0 ) {\n\t\t\treturn uuid;\n\t\t} else {\n\t\t\tconst newUuid = this.newUuid();\n\t\t\tuuids.add( newUuid );\n\t\t\treturn newUuid;\n\t\t}\n\t}\n\n\tnewUuid(): number {\n\t\tconst uuids = this.uuids;\n\t\tlet uuidNext = this.uuidNext;\n\t\twhile( true ) {\n\t\t\tuuidNext += 1;\n\t\t\tif( uuidNext !== 0 && ! uuids.has( uuidNext ) ) {\n\t\t\t\tthis.uuidNext = uuidNext;\n\t\t\t\treturn uuidNext;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected add_( target: string, array: string[], map: Map<string, number> ): number {\n\t\tconst result = map.get( target );\n\t\tif( result != null ) {\n\t\t\treturn result;\n\t\t}\n\t\tconst index = array.length;\n\t\tarray.push( target );\n\t\tmap.set( target, index );\n\t\treturn index;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShape } from \"./e-shape\";\nimport { EShapeRuntime } from \"./e-shape-runtime\";\n\nexport const EShapeRuntimes: {\n\t[ type: number ]: (new ( shape: EShape ) => EShapeRuntime) | undefined\n} = {};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DDiagramSerializedSnapGrid } from \"../d-diagram-serialized\";\nimport { ESnapperResult } from \"./e-snapper-result\";\n\nexport class ESnapperGrid extends utils.EventEmitter {\n\tprotected _isEnabled: boolean;\n\tprotected _size: number;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._isEnabled = true;\n\t\tthis._size = 10;\n\t}\n\n\tget enable() {\n\t\treturn this._isEnabled;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._isEnabled !== enable ) {\n\t\t\tthis._isEnabled = enable;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tif( this._size !== size ) {\n\t\t\tthis._size = size;\n\t\t\tthis.emit( \"change\", size, this );\n\t\t}\n\t}\n\n\tsnap( value: number, result: ESnapperResult ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst size = this._size;\n\t\t\tresult.set( value, Math.round( value / size ) * size );\n\t\t}\n\t}\n\n\treset(): void {\n\t\tthis._isEnabled = true;\n\t\tthis._size = 10;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tserialize(): DDiagramSerializedSnapGrid {\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\tthis._size\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnapGrid ): void {\n\t\tthis.enable = ( serialized[ 0 ] !== 0 );\n\t\tthis.size = serialized[ 1 ];\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class ESnapperResult {\n\tdistance: number;\n\tresult: number;\n\tthreshold: number;\n\n\tconstructor() {\n\t\tthis.distance = NaN;\n\t\tthis.result = 0;\n\t\tthis.threshold = 10;\n\t}\n\n\treset( value: number, scale: number ): void {\n\t\tthis.distance = NaN;\n\t\tthis.result = value;\n\t\tthis.threshold = ( 0.0001 < scale ? 10 / scale : 10 );\n\t}\n\n\tset( value: number, snapped: number ): void {\n\t\tconst newDistance = Math.abs( snapped - value );\n\t\tif( newDistance <= this.threshold ) {\n\t\t\tconst oldDistance = this.distance;\n\t\t\tif( oldDistance !== oldDistance || newDistance < oldDistance ) {\n\t\t\t\tthis.distance = newDistance;\n\t\t\t\tthis.result = snapped;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, IPoint, Matrix, Point, Rectangle, utils } from \"pixi.js\";\nimport { DDiagramSerializedSnap } from \"../d-diagram-serialized\";\nimport { isNaN } from \"../util/is-nan\";\nimport { ESnapperGrid } from \"./e-snapper-grid\";\nimport { ESnapperResult } from \"./e-snapper-result\";\nimport { ESnapperResultScale } from \"./e-snapper-result-scale\";\nimport { ESnapperTarget } from \"./e-snapper-target\";\n\nconst EPSILON = 0.00001;\n\nexport interface ESnapperModifier extends DisplayObject {\n\twidth: number;\n\theight: number;\n}\n\nexport enum ESnapperModifierAnchor {\n\tNONE,\n\tTOP_LEFT,\n\tTOP_CENTER,\n\tTOP_RIGHT,\n\tMIDDLE_LEFT,\n\tMIDDLE_RIGHT,\n\tBOTTOM_LEFT,\n\tBOTTOM_CENTER,\n\tBOTTOM_RIGHT,\n\tROTATION\n}\n\nexport interface ESnapperParentCanvas {\n\tscale: {\n\t\tx: number,\n\t\ty: number\n\t};\n\twidth: number;\n\theight: number;\n}\n\nexport interface ESnapperParent {\n\tcanvas: ESnapperParentCanvas | null;\n}\n\nexport class ESnapper extends utils.EventEmitter {\n\tprotected _points: Point[];\n\tprotected _normals: Point[];\n\tprotected _lengths: number[];\n\n\tprotected _workScale: Point;\n\tprotected _workScaleResult: ESnapperResultScale;\n\n\tprotected _workTranslate: Point;\n\n\tprotected _workSnap: Point;\n\tprotected _workSnapRectangle: Rectangle;\n\tprotected _workSnapResultX: ESnapperResult;\n\tprotected _workSnapResultY: ESnapperResult;\n\n\tprotected _parent: ESnapperParent;\n\n\tprotected _isEnabled: boolean;\n\n\tgrid: ESnapperGrid;\n\n\ttarget: ESnapperTarget;\n\n\tconstructor( parent: ESnapperParent ) {\n\t\tsuper();\n\n\t\tthis._points = [\n\t\t\tnew Point(), // Top left\n\t\t\tnew Point(), // Top right\n\t\t\tnew Point(), // Bottom left\n\t\t\tnew Point(), // Bottom right\n\t\t\tnew Point()  // Center\n\t\t];\n\n\t\tthis._normals = [\n\t\t\tnew Point(),\n\t\t\tnew Point()\n\t\t];\n\n\t\tthis._lengths = [\n\t\t\t1,\n\t\t\t1\n\t\t];\n\n\t\tthis._workScale = new Point();\n\t\tthis._workSnapResultX = new ESnapperResult();\n\t\tthis._workSnapResultY = new ESnapperResult();\n\t\tthis._workScaleResult = {\n\t\t\tdistance: 0,\n\t\t\tscale: new Point()\n\t\t};\n\n\t\tthis._workTranslate = new Point();\n\n\t\tthis._workSnapRectangle = new Rectangle();\n\t\tthis._workSnap = new Point();\n\n\t\t// Grid\n\t\tthis.grid = new ESnapperGrid();\n\n\t\t// Target\n\t\tthis.target = new ESnapperTarget();\n\n\t\t//\n\t\tthis._parent = parent;\n\t\tthis._isEnabled = true;\n\t}\n\n\tget enable() {\n\t\treturn this._isEnabled;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._isEnabled !== enable ) {\n\t\t\tthis._isEnabled = enable;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tprotected prepare( modifier: ESnapperModifier ): void {\n\t\tmodifier.updateTransform();\n\t\tconst localTransform = modifier.transform.localTransform;\n\t\tconst sx = modifier.width;\n\t\tconst sy = modifier.height;\n\n\t\tconst points = this._points;\n\t\tpoints[ 0 ].set( 0, 0 );\n\t\tpoints[ 1 ].set( sx, 0 );\n\t\tpoints[ 2 ].set( sx, sy );\n\t\tpoints[ 3 ].set( 0, sy );\n\t\tpoints[ 4 ].set( sx * 0.5, sy * 0.5 );\n\n\t\tlocalTransform.apply( points[ 0 ], points[ 0 ] );\n\t\tlocalTransform.apply( points[ 1 ], points[ 1 ] );\n\t\tlocalTransform.apply( points[ 2 ], points[ 2 ] );\n\t\tlocalTransform.apply( points[ 3 ], points[ 3 ] );\n\t\tlocalTransform.apply( points[ 4 ], points[ 4 ] );\n\t}\n\n\tprepareForTranslate( modifier: ESnapperModifier ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis.prepare( modifier );\n\t\t}\n\t}\n\n\tprotected snap( point: IPoint, result: IPoint ): IPoint {\n\t\tconst px = point.x;\n\t\tconst py = point.y;\n\t\tconst canvas = this._parent.canvas;\n\t\tconst x = this._workSnapResultX;\n\t\tconst y = this._workSnapResultY;\n\n\t\t// Canvas\n\t\tif( canvas != null ) {\n\t\t\tconst scale = Math.max( canvas.scale.x, canvas.scale.y );\n\t\t\tx.reset( px, scale );\n\t\t\ty.reset( py, scale );\n\t\t\tx.set( px, 0 );\n\t\t\tx.set( px, canvas.width );\n\t\t\ty.set( py, 0 );\n\t\t\ty.set( py, canvas.height );\n\t\t} else {\n\t\t\tx.reset( px, 1 );\n\t\t\ty.reset( py, 1 );\n\t\t}\n\n\t\t// Target\n\t\tthis.target.snap( px, py, x, y );\n\n\t\t// Grid\n\t\tthis.grid.snap( px, x );\n\t\tthis.grid.snap( py, y );\n\n\t\t//\n\t\tresult.x = ( isNaN( x.distance ) ? NaN : x.result );\n\t\tresult.y = ( isNaN( y.distance ) ? NaN : y.result );\n\t\treturn result;\n\t}\n\n\ttoSnapped( point: IPoint, result: IPoint ): IPoint {\n\t\tconst px = point.x;\n\t\tconst py = point.y;\n\t\tif( this._isEnabled ) {\n\t\t\tthis.snap( point, result );\n\t\t\tconst x = result.x;\n\t\t\tconst y = result.y;\n\t\t\tresult.set(\n\t\t\t\tisNaN( x ) ? px : x,\n\t\t\t\tisNaN( y ) ? py : y\n\t\t\t);\n\t\t} else {\n\t\t\tresult.set( px, py );\n\t\t}\n\t\treturn result;\n\t}\n\n\ttoTranslationSnapped( delta: IPoint, result: IPoint ): IPoint {\n\t\tconst dx = delta.x;\n\t\tconst dy = delta.y;\n\t\tlet x = NaN;\n\t\tlet y = NaN;\n\t\tif( this._isEnabled ) {\n\t\t\tconst workTranslate = this._workTranslate;\n\t\t\tconst points = this._points;\n\t\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\t\tconst point = points[ i ];\n\t\t\t\tworkTranslate.set( point.x + dx, point.y + dy );\n\t\t\t\tthis.snap( workTranslate, workTranslate );\n\n\t\t\t\t// X\n\t\t\t\tif( ! isNaN( workTranslate.x ) ) {\n\t\t\t\t\tconst newDx = workTranslate.x - point.x;\n\t\t\t\t\tif( isNaN( x ) || Math.abs( newDx - dx ) < Math.abs( x - dx ) ) {\n\t\t\t\t\t\tx = newDx;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Y\n\t\t\t\tif( ! isNaN( workTranslate.y ) ) {\n\t\t\t\t\tconst newDy = workTranslate.y - point.y;\n\t\t\t\t\tif( isNaN( y ) || Math.abs( newDy - dy ) < Math.abs( y - dy ) ) {\n\t\t\t\t\t\ty = newDy;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tresult.x = ( isNaN( x ) ? dx : x );\n\t\tresult.y = ( isNaN( y ) ? dy : y );\n\t\treturn result;\n\t}\n\n\tprepareForRotate( modifier: ESnapperModifier ): void {\n\t\t//\n\t}\n\n\tprotected getGridSizeRotation(): number {\n\t\treturn 5;\n\t}\n\n\tprotected toRadian( value: number ): number {\n\t\treturn value / 180 * Math.PI;\n\t}\n\n\tprotected toDegree( value: number ): number {\n\t\treturn value / Math.PI * 180;\n\t}\n\n\ttoRotationSnapped( baseRotation: number, deltaRotation: number ): number {\n\t\tif( this._isEnabled ) {\n\t\t\tconst gridSize = this.getGridSizeRotation();\n\t\t\tconst newRotation = baseRotation + deltaRotation;\n\t\t\tconst newRotationDegree = Math.round( this.toDegree( newRotation ) );\n\t\t\tconst newRotationDegreeResidual = newRotationDegree % 90;\n\t\t\tif( Math.abs( newRotationDegreeResidual ) <= gridSize ) {\n\t\t\t\treturn this.toRadian( newRotationDegree - newRotationDegreeResidual ) - baseRotation;\n\t\t\t} else {\n\t\t\t\tif( 90 - gridSize <= newRotationDegreeResidual ) {\n\t\t\t\t\treturn this.toRadian( newRotationDegree + (90 - newRotationDegreeResidual) ) - baseRotation;\n\t\t\t\t} else if( newRotationDegreeResidual <= -90 + gridSize ) {\n\t\t\t\t\treturn this.toRadian( newRotationDegree - (90 + newRotationDegreeResidual) ) - baseRotation;\n\t\t\t\t} else {\n\t\t\t\t\treturn deltaRotation;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn deltaRotation;\n\t}\n\n\tprotected calcNormalizedVector( p0: IPoint, p1: IPoint, result: Point ): number {\n\t\tconst dx = p1.x - p0.x;\n\t\tconst dy = p1.y - p0.y;\n\t\tconst l = Math.sqrt( dx * dx + dy * dy );\n\t\tif( EPSILON < l ) {\n\t\t\tconst d = 1 / l;\n\t\t\tresult.x = dx * d;\n\t\t\tresult.y = dy * d;\n\t\t} else {\n\t\t\tresult.x = 1;\n\t\t\tresult.y = 0;\n\t\t}\n\t\treturn l;\n\t}\n\n\tprepareForScale( modifier: ESnapperModifier, anchor: ESnapperModifierAnchor ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis.prepare( modifier );\n\n\t\t\tconst points = this._points;\n\t\t\tconst normals = this._normals;\n\t\t\tconst lengths = this._lengths;\n\t\t\tswitch( anchor ) {\n\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 1 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 3 ], points[ 0 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 3 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 1 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 2 ], points[ 1 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 1 ], points[ 0 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 1 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 2 ], points[ 3 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 0 ], points[ 3 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 0 ], points[ 3 ], normals[ 0 ] );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\tlengths[ 0 ] = this.calcNormalizedVector( points[ 3 ], points[ 2 ], normals[ 0 ] );\n\t\t\t\tlengths[ 1 ] = this.calcNormalizedVector( points[ 1 ], points[ 2 ], normals[ 1 ] );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected setScaleSnappedResult(\n\t\tdistance: number,\n\t\tlength: number,\n\t\tmove: number,\n\t\taxis: boolean, // true => x axis, false y axis\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tif( EPSILON < length ) {\n\t\t\tif( isNaN( result.distance ) || distance < result.distance ) {\n\t\t\t\tresult.distance = distance;\n\t\t\t\tconst newScale = 1 + move / length;\n\t\t\t\tif( axis ) {\n\t\t\t\t\tresult.scale.x = newScale;\n\t\t\t\t} else {\n\t\t\t\t\tresult.scale.y = newScale;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnapped1D(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\taxis: boolean,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tconst work = this._workScale;\n\t\ttransform.apply( point, work );\n\t\tconst tx = work.x;\n\t\tconst ty = work.y;\n\t\tthis.snap( work, work );\n\t\tconst x = work.x;\n\t\tconst y = work.y;\n\n\t\t// X coordinate\n\t\tif( ! isNaN( x ) ) {\n\t\t\tconst nx = Math.abs( normal.x );\n\t\t\tif( EPSILON < nx ) {\n\t\t\t\tconst dx = (x - tx) / normal.x;\n\t\t\t\tconst distance = Math.abs( dx );\n\t\t\t\tconst mx = (x - point.x) / normal.x;\n\t\t\t\tthis.setScaleSnappedResult( distance, length, mx, axis, result );\n\t\t\t}\n\t\t}\n\n\t\t// Y coordinate\n\t\tif( ! isNaN( y ) ) {\n\t\t\tconst ny = Math.abs( normal.y );\n\t\t\tif( EPSILON < ny ) {\n\t\t\t\tconst dy = (y - ty) / normal.y;\n\t\t\t\tconst distance = Math.abs( dy );\n\t\t\t\tconst my = (y - point.y) / normal.y;\n\t\t\t\tthis.setScaleSnappedResult( distance, length, my, axis, result );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnappedX(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped1D( transform, point, normal, length, true, result );\n\t}\n\n\tprotected calcScaleSnappedY(\n\t\ttransform: Matrix,\n\t\tpoint: Point,\n\t\tnormal: IPoint,\n\t\tlength: number,\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped1D( transform, point, normal, length, false, result );\n\t}\n\n\tcalcScaleSnapped2D(\n\t\ttransform: Matrix, point: Point, normals: IPoint[],\n\t\tlengths: number[], result: ESnapperResultScale\n\t): void {\n\t\tconst work = this._workScale;\n\t\ttransform.apply( point, work );\n\t\tconst tx = work.x;\n\t\tconst ty = work.y;\n\n\t\tthis.snap( work, work );\n\t\tlet x = work.x;\n\t\tlet y = work.y;\n\t\tif( isNaN( x ) ) {\n\t\t\tif( isNaN( y ) ) {\n\t\t\t\treturn;\n\t\t\t} else {\n\t\t\t\tx = tx;\n\t\t\t}\n\t\t} else {\n\t\t\tif( isNaN( y ) ) {\n\t\t\t\ty = ty;\n\t\t\t}\n\t\t}\n\n\t\t// (x, y) = (tx, ty) + normalA * a + normalB * b\n\t\t// dx = x - tx\n\t\t// dy = y - ty\n\t\t// V = ( a, b )^T\n\t\t// D = ( dx, dy )^T\n\t\t// A = | normalA.x normalB.x |\n\t\t//     | normalA.y normalB.y |\n\t\t// A V = D\n\t\t// det A = normalA.x * normalB.y - normalB.x * normalA.y\n\t\t// A^-1 = |  normalB.y -normalB.x | / det A\n\t\t//        | -normalA.y  normalA.x |\n\t\tconst detA = normals[ 0 ].x * normals[ 1 ].y - normals[ 1 ].x * normals[ 0 ].y;\n\t\tif( EPSILON < Math.abs( detA ) ) {\n\t\t\tconst dx = x - tx;\n\t\t\tconst dy = y - ty;\n\t\t\tconst distance = Math.abs( dx * dx + dy * dy );\n\t\t\tif( isNaN( result.distance ) || distance < result.distance ) {\n\t\t\t\tresult.distance = distance;\n\t\t\t\tconst mdx = x - point.x;\n\t\t\t\tconst mdy = y - point.y;\n\t\t\t\tconst mx = ( +normals[ 1 ].y * mdx - normals[ 1 ].x * mdy ) / detA;\n\t\t\t\tconst my = ( -normals[ 0 ].y * mdx + normals[ 0 ].x * mdy ) / detA;\n\t\t\t\tresult.scale.set(\n\t\t\t\t\t1 + mx / lengths[ 0 ],\n\t\t\t\t\t1 + my / lengths[ 1 ]\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected calcScaleSnappedXY(\n\t\ttransform: Matrix,\n\t\tpointO: Point,\n\t\tpointX: Point,\n\t\tpointY: Point,\n\t\tnormals: IPoint[],\n\t\tlengths: number[],\n\t\tresult: ESnapperResultScale\n\t): void {\n\t\tthis.calcScaleSnapped2D( transform, pointO, normals, lengths, result );\n\t\tthis.calcScaleSnappedX( transform, pointY, normals[ 0 ], lengths[ 0 ], result );\n\t\tthis.calcScaleSnappedY( transform, pointX, normals[ 1 ], lengths[ 1 ], result );\n\t}\n\n\ttoScaleSnapped(\n\t\ttransform: Matrix, anchor: ESnapperModifierAnchor, keepRatio: boolean, scale: IPoint\n\t): boolean {\n\t\tif( this._isEnabled ) {\n\t\t\tconst points = this._points;\n\t\t\tconst normals = this._normals;\n\t\t\tconst lengths = this._lengths;\n\t\t\tconst work = this._workScaleResult;\n\t\t\twork.distance = NaN;\n\t\t\twork.scale.set( scale.x, scale.y );\n\n\t\t\tswitch( anchor ) {\n\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 0 ], points[ 1 ], points[ 3 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 0 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 1 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 1 ], points[ 0 ], points[ 2 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 0 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 3 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 1 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedX( transform, points[ 2 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 3 ], points[ 2 ], points[ 0 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 2 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tthis.calcScaleSnappedY( transform, points[ 3 ], normals[ 0 ], lengths[ 0 ], work );\n\t\t\t\tbreak;\n\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\tthis.calcScaleSnappedXY( transform, points[ 2 ], points[ 3 ], points[ 1 ], normals, lengths, work );\n\t\t\t\tbreak;\n\t\t\t}\n\n\t\t\tif( ! isNaN( work.distance ) ) {\n\t\t\t\tscale.copyFrom( work.scale );\n\t\t\t\tif( keepRatio ) {\n\t\t\t\t\tswitch( anchor ) {\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_RIGHT:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_RIGHT:\n\t\t\t\t\t\tscale.x = scale.y = Math.max( scale.x, scale.y );\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.TOP_CENTER:\n\t\t\t\t\tcase ESnapperModifierAnchor.BOTTOM_CENTER:\n\t\t\t\t\t\tscale.x = scale.y;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.MIDDLE_LEFT:\n\t\t\t\t\tcase ESnapperModifierAnchor.MIDDLE_RIGHT:\n\t\t\t\t\t\tscale.y = scale.x;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase ESnapperModifierAnchor.NONE:\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\treset(): void {\n\t\tthis.enable = true;\n\t\tthis.target.reset();\n\t\tthis.grid.reset();\n\t}\n\n\tserialize(): DDiagramSerializedSnap {\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\tthis.target.serialize(),\n\t\t\tthis.grid.serialize()\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnap ): void {\n\t\tthis.enable = ( serialized[ 0 ] !== 0 );\n\t\tthis.target.deserialize( serialized[ 1 ] );\n\t\tthis.grid.deserialize( serialized[ 2 ] );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DDiagramSerializedSnapTarget, DDiagramSerializedSnapTargetValue } from \"../d-diagram-serialized\";\nimport { ESnapperResult } from \"./e-snapper-result\";\nimport { ESnapperTargetValue, ESnapperTargetValueType } from \"./e-snapper-target-value\";\n\nexport class ESnapperTarget extends utils.EventEmitter {\n\tvalues: ESnapperTargetValue[];\n\tprotected _isVisible: boolean;\n\tprotected _isEnabled: boolean;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis.values = [];\n\t\tthis._isVisible = true;\n\t\tthis._isEnabled = true;\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._isEnabled !== enable ) {\n\t\t\tthis._isEnabled = enable;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tget visible(): boolean {\n\t\treturn this._isVisible;\n\t}\n\n\tset visible( visible: boolean ) {\n\t\tif( this._isVisible !== visible ) {\n\t\t\tthis._isVisible = visible;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tget size(): number {\n\t\treturn this.values.length;\n\t}\n\n\tadd( target: ESnapperTargetValue, index?: number ): void {\n\t\tif( index != null ) {\n\t\t\tthis.values.splice( index, 0, target );\n\t\t} else {\n\t\t\tthis.values.push( target );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tremove( index: number ): void {\n\t\tconst values = this.values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tvalues.splice( index, 1 );\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\treplace( index: number, value: ESnapperTargetValue ): ESnapperTargetValue | null {\n\t\tconst values = this.values;\n\t\tif( 0 <= index && index < values.length ) {\n\t\t\tconst result = values[ index ];\n\t\t\tvalues[ index ] = value;\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tswap( indexA: number, indexB: number ): void {\n\t\tif( indexA !== indexB ) {\n\t\t\tconst values = this.values;\n\t\t\tconst valueA = values[ indexA ];\n\t\t\tvalues[ indexA ] = values[ indexB ];\n\t\t\tvalues[ indexB ] = valueA;\n\t\t}\n\t}\n\n\tsnap( px: number, py: number, x: ESnapperResult, y: ESnapperResult ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst values = this.values;\n\t\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\t\tconst value = values[ i ];\n\t\t\t\tif( value.type === ESnapperTargetValueType.VERTICAL ) {\n\t\t\t\t\tx.set( px, value.position );\n\t\t\t\t} else {\n\t\t\t\t\ty.set( py, value.position );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\treset(): void {\n\t\tthis._isEnabled = true;\n\t\tthis._isVisible = true;\n\t\tthis.values.length = 0;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tserialize(): DDiagramSerializedSnapTarget {\n\t\tconst targets: DDiagramSerializedSnapTargetValue[] = [];\n\t\tconst values = this.values;\n\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\ttargets.push( values[ i ].serialize() );\n\t\t}\n\t\treturn [\n\t\t\t(this._isEnabled ? 1 : 0),\n\t\t\t(this._isVisible ? 1 : 0),\n\t\t\ttargets\n\t\t];\n\t}\n\n\tdeserialize( serialized: DDiagramSerializedSnapTarget ): void {\n\t\t// Availability\n\t\tthis._isEnabled = ( serialized[ 0 ] !== 0 );\n\n\t\t// Visibility\n\t\tthis._isVisible = ( serialized[ 1 ] !== 0 );\n\n\t\t// Values\n\t\tconst sources = serialized[ 2 ];\n\t\tconst values = this.values;\n\t\tvalues.length = 0;\n\t\tfor( let i = 0, imax = sources.length; i < imax; ++i ) {\n\t\t\tconst source = sources[ i ];\n\t\t\tvalues.push( new ESnapperTargetValue( source[ 0 ], source[ 1 ] ) );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * An output format.\n */\nexport enum UtilFileAs {\n\tTEXT,\n\tDATA_URL,\n\tBINARY_STRING,\n\tARRAY_BUTTER,\n\tFILE\n}\n\nexport interface UtilFileFacade {\n\temit( name: string, ...args: any[] ): void;\n}\n\n/**\n * An `open` event handler.\n *\n * @param result a file contents\n * @param file an opened file\n * @param emitter an emitter\n */\nexport type UtilFileOnOpen<RESULT, EMITTER> = ( result: RESULT, file: File, emitter: EMITTER ) => void;\n\n/**\n * {@link UtilFileOpener} events.\n */\nexport interface UtilFileEvents<EMITTER> {\n\t/**\n\t * Triggered when a file is opened.\n\t */\n\topen: UtilFileOnOpen<string, EMITTER> | UtilFileOnOpen<ArrayBuffer, EMITTER> | UtilFileOnOpen<File, EMITTER>;\n\n\t/**\n\t * Triggered when an operation is aborted.\n\t *\n\t * @param e an event object\n\t * @param emitter an emitter\n\t */\n\tabort( e: ProgressEvent, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when an operation is canceled.\n\t *\n\t * @param emitter an emitter\n\t */\n\tcancel( emitter: EMITTER ): void;\n}\n\n/**\n * An utility class for opening files.\n */\nexport class UtilFileOpener {\n\tprotected _input: HTMLInputElement | null;\n\tprotected _as: UtilFileAs;\n\tprotected _facade: UtilFileFacade;\n\n\tconstructor( as: UtilFileAs, facade: UtilFileFacade ) {\n\t\tthis._input = null;\n\t\tthis._as = as;\n\t\tthis._facade = facade;\n\t}\n\n\topen(): void {\n\t\tconst input = this.getOrCreateInput();\n\t\tif( input != null ) {\n\t\t\tinput.click();\n\t\t} else {\n\t\t\tthis.onCancel();\n\t\t}\n\t}\n\n\tprotected getOrCreateInput(): HTMLInputElement | null {\n\t\tif( \"FileReader\" in window && this._input == null ) {\n\t\t\tconst input = this._input = document.createElement( \"input\" );\n\t\t\tinput.setAttribute( \"type\", \"file\" );\n\t\t\tinput.setAttribute( \"style\", \"display:none\" );\n\t\t\tinput.addEventListener( \"change\", ( e: Event ): void => {\n\t\t\t\tthis.onInputChange( input );\n\t\t\t\tinput.value = \"\";\n\t\t\t\te.stopImmediatePropagation();\n\t\t\t\te.preventDefault();\n\t\t\t});\n\t\t\tdocument.body.appendChild( input );\n\t\t}\n\t\treturn this._input;\n\t}\n\n\tprotected onInputChange( input: HTMLInputElement ): void {\n\t\tconst files = input.files;\n\t\tif( files != null && 0 < files.length ) {\n\t\t\tconst file = files[ 0 ];\n\t\t\tif( this._as === UtilFileAs.FILE ) {\n\t\t\t\tthis.onOpen( file, file );\n\t\t\t} else {\n\t\t\t\tconst fileReader = new FileReader();\n\t\t\t\tfileReader.onload = ( e: ProgressEvent ) => {\n\t\t\t\t\tif( e.target != null ) {\n\t\t\t\t\t\tconst target = e.target as any;\n\t\t\t\t\t\tthis.onOpen( target.result, file );\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tfileReader.onabort = ( e: ProgressEvent ) => {\n\t\t\t\t\tthis.onAboart( e );\n\t\t\t\t};\n\t\t\t\tswitch( this._as ) {\n\t\t\t\tcase UtilFileAs.TEXT:\n\t\t\t\t\tfileReader.readAsText( file );\n\t\t\t\t\tbreak;\n\t\t\t\tcase UtilFileAs.DATA_URL:\n\t\t\t\t\tfileReader.readAsDataURL( file );\n\t\t\t\t\tbreak;\n\t\t\t\tcase UtilFileAs.BINARY_STRING:\n\t\t\t\t\tfileReader.readAsBinaryString( file );\n\t\t\t\t\tbreak;\n\t\t\t\tcase UtilFileAs.ARRAY_BUTTER:\n\t\t\t\t\tfileReader.readAsArrayBuffer( file );\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\tfileReader.readAsText( file );\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tthis.onCancel();\n\t\t}\n\t}\n\n\tprotected onOpen( result: string | ArrayBuffer | File, file: File ): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"open\", result, file, facade );\n\t}\n\n\tprotected onAboart( e: ProgressEvent ): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"abort\", e, facade );\n\t}\n\n\tprotected onCancel(): void {\n\t\tconst facade = this._facade;\n\t\tfacade.emit( \"cancel\", facade );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Text } from \"pixi.js\";\nimport { DynamicAtlasItem } from \"./dynamic-atlas-item\";\n\nexport class DynamicAtlasItemText extends DynamicAtlasItem {\n\tprotected _text: Text;\n\n\tconstructor( id: string, text: Text, baseTexture: BaseTexture ) {\n\t\tsuper( id, text.width, text.height, 0, baseTexture );\n\t\tthis._text = text;\n\t}\n\n\trender( context: CanvasRenderingContext2D ): void {\n\t\tconst frame = this.frame;\n\t\tcontext.drawImage( this._text.canvas, frame.x, frame.y, frame.width, frame.height );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { TextMetrics, utils } from \"pixi.js\";\n\nexport class DynamicFontAtlasFont {\n\tid: string;\n\tsize: number;\n\tcolor: string;\n\theight: number;\n\n\tascent: number;\n\tdescent: number;\n\n\tconstructor( fontId: string, size: number, color: number, padding: number ) {\n\t\tthis.id = fontId;\n\t\tthis.size = size;\n\t\tthis.color = utils.hex2string( color );\n\t\tthis.height = size + padding * 2;\n\t\tconst metrics = TextMetrics.measureFont( fontId );\n\t\tthis.ascent = metrics.ascent;\n\t\tthis.descent = metrics.descent;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { MIPMAP_MODES, SCALE_MODES, Texture } from \"pixi.js\";\nimport { ASCII_CHARACTERS } from \"./ascii\";\nimport { DynamicFontAtlasCharacter } from \"./dynamic-font-atlas-character\";\nimport { DynamicFontAtlasCharacters } from \"./dynamic-font-atlas-characters\";\nimport { DynamicFontAtlasFont } from \"./dynamic-font-atlas-font\";\nimport { UtilCharacterIterator } from \"./util-character-iterator\";\n\nconst PADDING = 3;\n\nexport class DynamicFontAtlas {\n\tprotected _id: string;\n\tprotected _canvas: HTMLCanvasElement | null;\n\tprotected _context: CanvasRenderingContext2D | null;\n\tprotected _font: DynamicFontAtlasFont;\n\tprotected _characters: DynamicFontAtlasCharacters;\n\tprotected _length: number;\n\tprotected _unrefCount: number;\n\tprotected _width: number;\n\tprotected _height: number;\n\tprotected _revision: number;\n\tprotected _revisionUpdated: number;\n\tprotected _texture: Texture;\n\n\tconstructor( fontId: string, fontSize: number, fontColor: number, resolution: number ) {\n\t\tthis._id = fontId;\n\t\tthis._canvas = document.createElement( \"canvas\" );\n\t\tthis._context = null;\n\t\tthis._font = new DynamicFontAtlasFont( fontId, fontSize, fontColor, PADDING );\n\t\tthis._characters = {};\n\t\tthis._length = 0;\n\t\tthis._unrefCount = 0;\n\t\tthis._width = 1;\n\t\tthis._height = 1;\n\t\tthis._revision = 0;\n\t\tthis._revisionUpdated = 0;\n\t\tthis._texture = Texture.from( this._canvas, {\n\t\t\tmipmap: MIPMAP_MODES.OFF,\n\t\t\tresolution,\n\t\t\tscaleMode: SCALE_MODES.NEAREST\n\t\t});\n\n\t\tthis.add( ASCII_CHARACTERS, true );\n\t\tthis.add_( \"...\", this._characters, true );\n\t}\n\n\tget id() {\n\t\treturn this._id;\n\t}\n\n\tget font(): DynamicFontAtlasFont {\n\t\treturn this._font;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget height(): number {\n\t\treturn this._height;\n\t}\n\n\tget canvas(): HTMLCanvasElement | null {\n\t\treturn this._canvas;\n\t}\n\n\tget characters(): DynamicFontAtlasCharacters {\n\t\treturn this._characters;\n\t}\n\n\tget texture(): Texture {\n\t\treturn this._texture;\n\t}\n\n\tprotected add_( character: string, characters: DynamicFontAtlasCharacters, reserved?: boolean ): void {\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( ! data.reserved ) {\n\t\t\t\t\tif( data.ref === 0 ) {\n\t\t\t\t\t\tthis._unrefCount -= 1;\n\t\t\t\t\t}\n\t\t\t\t\tdata.ref += 1;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst advance = this.getAdvance( character );\n\t\t\t\tconst width = Math.ceil( PADDING + advance + PADDING );\n\t\t\t\tconst height = this.font.height;\n\t\t\t\tcharacters[ character ] = new DynamicFontAtlasCharacter( advance, width, height, !! reserved );\n\t\t\t\tthis._length += 1;\n\t\t\t\tthis._revision += 1;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected remove_( character: string, characters: DynamicFontAtlasCharacters ): void {\n\t\tif( character !== \"\\n\" ) {\n\t\t\tconst data = characters[ character ];\n\t\t\tif( data != null ) {\n\t\t\t\tif( ! data.reserved && 0 < data.ref ) {\n\t\t\t\t\tdata.ref -= 1;\n\t\t\t\t\tif( data.ref === 0 ) {\n\t\t\t\t\t\tthis._unrefCount += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup_(): void {\n\t\tif( (this._length >> 1) <= this._unrefCount ) {\n\t\t\tconst characters = this._characters;\n\t\t\tfor( const character in characters ) {\n\t\t\t\tif( characters[ character ].ref <= 0 ) {\n\t\t\t\t\tdelete characters[ character ];\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis._length -= this._unrefCount;\n\t\t\tthis._revision += 1;\n\t\t\tthis._unrefCount = 0;\n\t\t}\n\t}\n\n\tadd( targets: string, reserved?: boolean ): void {\n\t\tconst characters = this._characters;\n\t\tconst iterator = UtilCharacterIterator.from( targets );\n\t\twhile( iterator.hasNext() ) {\n\t\t\tthis.add_( iterator.next(), characters, reserved );\n\t\t}\n\t}\n\n\tremove( targets: string ): void {\n\t\tconst characters = this._characters;\n\t\tconst iterator = UtilCharacterIterator.from( targets );\n\t\twhile( iterator.hasNext() ) {\n\t\t\tthis.remove_( iterator.next(), characters );\n\t\t}\n\t}\n\n\tget( character: string ): DynamicFontAtlasCharacter | undefined {\n\t\treturn this._characters[ character ];\n\t}\n\n\tgetAdvance( target: string ): number {\n\t\tconst context = this.getContext();\n\t\tif( context != null ) {\n\t\t\treturn context.measureText( target ).width;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tgetContext(): CanvasRenderingContext2D | null {\n\t\tlet context = this._context;\n\t\tif( context == null ) {\n\t\t\tconst canvas = this._canvas;\n\t\t\tif( canvas != null ) {\n\t\t\t\tcontext = this._context = canvas.getContext( \"2d\", { alpha: true } );\n\t\t\t\tif( context == null ) {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\tconst font = this._font;\n\t\tif( context.font !== font.id ) {\n\t\t\tcontext.font = font.id;\n\t\t\tfont.id = context.font;\n\t\t\tcontext.textAlign = \"left\";\n\t\t\tcontext.textBaseline = \"alphabetic\";\n\t\t\tcontext.lineWidth = 0;\n\t\t\tcontext.lineCap = \"round\";\n\t\t\tcontext.lineJoin = \"miter\";\n\t\t\tcontext.miterLimit = 0;\n\t\t\tcontext.fillStyle = font.color;\n\t\t\tcontext.strokeStyle = \"#0000ff\";\n\t\t}\n\t\treturn context;\n\t}\n\n\tupdate(): boolean {\n\t\tthis.cleanup_();\n\n\t\tif( this._revisionUpdated < this._revision ) {\n\t\t\tthis._revisionUpdated = this._revision;\n\n\t\t\tconst canvas = this._canvas;\n\t\t\tif( canvas != null ) {\n\t\t\t\tconst font = this._font;\n\t\t\t\tconst fontHeight = font.height;\n\t\t\t\tconst characters = this._characters;\n\t\t\t\tconst width = this._width = this.toPowerOf2( Math.ceil( Math.sqrt( this._length ) ) * fontHeight );\n\n\t\t\t\tconst offsetX = PADDING;\n\t\t\t\tconst offsetY = Math.round( (fontHeight - (font.ascent + font.descent)) * 0.5 + font.ascent );\n\t\t\t\tlet x = 0;\n\t\t\t\tlet y = 0;\n\t\t\t\tfor( const key in characters ) {\n\t\t\t\t\tconst character = characters[ key ];\n\t\t\t\t\tif( width <= x + character.width ) {\n\t\t\t\t\t\tx = 0;\n\t\t\t\t\t\ty += fontHeight;\n\t\t\t\t\t}\n\n\t\t\t\t\tcharacter.x = x;\n\t\t\t\t\tcharacter.y = y;\n\t\t\t\t\tcharacter.origin.x = x + offsetX;\n\t\t\t\t\tcharacter.origin.y = y + offsetY;\n\n\t\t\t\t\tx += character.width;\n\t\t\t\t}\n\t\t\t\tconst height = this._height = y + fontHeight;\n\n\t\t\t\t// Make a input canvas\n\t\t\t\t// Here, we need to reset the context because\n\t\t\t\t// context settings will be lost when we set the width/height.\n\t\t\t\tconst baseTexture = this._texture.baseTexture;\n\t\t\t\tconst resolution = baseTexture.resolution;\n\t\t\t\tconst realWidth = Math.ceil( width * resolution );\n\t\t\t\tconst realHeight = Math.ceil( height * resolution );\n\t\t\t\tcanvas.width = realWidth;\n\t\t\t\tcanvas.height = realHeight;\n\t\t\t\tconst context = this.getContext();\n\t\t\t\tif( context != null ) {\n\t\t\t\t\tcontext.save();\n\t\t\t\t\tcontext.scale( resolution, resolution );\n\t\t\t\t\tcontext.clearRect( 0, 0, width, height );\n\t\t\t\t\tfor( const key in characters ) {\n\t\t\t\t\t\tconst character = characters[ key ];\n\t\t\t\t\t\tcontext.fillText( key, character.origin.x, character.origin.y );\n\t\t\t\t\t}\n\t\t\t\t\tcontext.restore();\n\t\t\t\t}\n\t\t\t\tbaseTexture.setRealSize( realWidth, realHeight );\n\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetRevision(): number {\n\t\treturn this._revision;\n\t}\n\n\tgetRevisionUpdate(): number {\n\t\treturn this._revisionUpdated;\n\t}\n\n\tget length(): number {\n\t\treturn this._length;\n\t}\n\n\tdestroy() {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis._canvas = null;\n\t\t}\n\n\t\tconst characters = this._characters;\n\t\tfor( const character in characters ) {\n\t\t\tdelete characters[ character ];\n\t\t}\n\t}\n\n\ttoPowerOf2( size: number ): number {\n\t\tlet result = 32;\n\t\twhile( result < size ) {\n\t\t\tresult <<= 1;\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationLayerLike } from \"../d-application-layer-like\";\nimport { DynamicFontAtlas } from \"./dynamic-font-atlas\";\n\nconst update = ( atlas: DynamicFontAtlas ): void => {\n\tatlas.update();\n};\n\nconst updateAll = ( colorToAltas: Map<number, DynamicFontAtlas> ): void => {\n\tcolorToAltas.forEach( update );\n};\n\nconst destroy = ( atlas: DynamicFontAtlas ): void => {\n\tatlas.update();\n};\n\nconst destroyAll = ( colorToAltas: Map<number, DynamicFontAtlas> ): void => {\n\tcolorToAltas.forEach( destroy );\n};\n\nexport class DynamicFontAtlases {\n\tprotected _atlases: Map<string, Map<number, DynamicFontAtlas>>;\n\tprotected _resolution: number;\n\n\tconstructor( layer: DApplicationLayerLike ) {\n\t\tthis._atlases = new Map<string, Map<number, DynamicFontAtlas>>();\n\t\tthis._resolution = layer.renderer.resolution;\n\n\t\tlayer.renderer.on( \"prerender\", (): void => {\n\t\t\tthis.update();\n\t\t});\n\t}\n\n\tadd( fontId: string, fontSize: number, fontColor: number, targets: string ): void {\n\t\tconst atlases = this._atlases;\n\t\tlet colorToAtlas = atlases.get( fontId );\n\t\tif( colorToAtlas == null ) {\n\t\t\tcolorToAtlas = new Map<number, DynamicFontAtlas>();\n\t\t\tatlases.set( fontId, colorToAtlas );\n\t\t}\n\t\tlet atlas = colorToAtlas.get( fontColor );\n\t\tif( atlas == null ) {\n\t\t\tatlas = new DynamicFontAtlas( fontId, fontSize, fontColor, this._resolution );\n\t\t\tcolorToAtlas.set( fontColor, atlas );\n\t\t}\n\t\tatlas.add( targets );\n\t}\n\n\tremove( fontId: string, fontColor: number, targets: string ): void {\n\t\tconst colorToAtlas = this._atlases.get( fontId );\n\t\tif( colorToAtlas != null ) {\n\t\t\tconst atlas = colorToAtlas.get( fontColor );\n\t\t\tif( atlas != null ) {\n\t\t\t\tatlas.remove( targets );\n\t\t\t}\n\t\t}\n\t}\n\n\tget( fontId: string, fontColor: number ): DynamicFontAtlas | null {\n\t\tconst atlases = this._atlases;\n\t\tconst colorToAtlas = atlases.get( fontId );\n\t\tif( colorToAtlas == null ) {\n\t\t\treturn null;\n\t\t}\n\t\tconst atlas = colorToAtlas.get( fontColor );\n\t\tif( atlas == null ) {\n\t\t\treturn null;\n\t\t}\n\t\treturn atlas;\n\t}\n\n\tupdate(): void {\n\t\tthis._atlases.forEach( updateAll );\n\t}\n\n\tdestroy() {\n\t\tconst atlases = this._atlases;\n\t\tatlases.forEach( destroyAll );\n\t\tatlases.clear();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\n\nexport class Lazy<INSTANCE, OPTIONS> {\n\tinstance: INSTANCE | null;\n\tnewInstance: new ( options: OPTIONS ) => INSTANCE;\n\toptions: OPTIONS;\n\n\tconstructor( newInstance: new ( options: OPTIONS ) => INSTANCE, options: OPTIONS, base?: DBase ) {\n\t\tthis.instance = null;\n\t\tthis.newInstance = newInstance;\n\t\tthis.options = options;\n\n\t\tif( base != null ) {\n\t\t\tif( base.state.isActive ) {\n\t\t\t\tsetTimeout((): void => {\n\t\t\t\t\tthis.get();\n\t\t\t\t}, 0);\n\t\t\t}\n\n\t\t\tbase.on( \"active\", (): void => {\n\t\t\t\tthis.get();\n\t\t\t});\n\t\t}\n\t}\n\n\tget(): INSTANCE {\n\t\tlet instance = this.instance;\n\t\tif( instance == null ) {\n\t\t\tinstance = this.instance = new (this.newInstance)( this.options );\n\t\t}\n\t\treturn instance;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Returns a ceiling index of the given value.\n * The array must be sorted in an ascending order.\n *\n * @param array an array sorted in an ascending order\n * @param value a value to be searched\n * @returns a ceiling index of the given value\n */\nexport const toCeilingIndex = <V>( array: V[], value: V, size: number, offset: number ): number => {\n\tlet i0 = 0;\n\tlet i1 = Math.floor( array.length / size ) - 1;\n\n\twhile( i0 <= i1 ) {\n\t\tconst i2 = i0 + ((i1 - i0) >> 1);\n\t\tconst v2 = array[ i2 * size + offset ];\n\t\tif( value < v2 ) {\n\t\t\ti1 = i2 - 1;\n\t\t} else if( v2 < value ) {\n\t\t\ti0 = i2 + 1;\n\t\t} else {\n\t\t\treturn i2;\n\t\t}\n\t}\n\n\treturn Math.max( i0, i1 );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toSvgUrl = ( svg: string ): string => {\n\treturn `data:image/svg+xml;base64,${btoa(svg)}`;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { BaseTexture, Rectangle, SCALE_MODES, Texture } from \"pixi.js\";\nimport { toSvgUrl } from \"./to-svg-url\";\n\nexport interface UtilSvgAtlasBuilderBuildOptions {\n\tforce?: boolean;\n\tscaling?: SCALE_MODES;\n\tresolution?: number;\n}\n\nexport class UtilSvgAtlasBuilder {\n\tprotected _width: number;\n\tprotected _ratio: number;\n\tprotected _margin: number;\n\n\tprotected _frames: { [ name: string ]: Rectangle };\n\tprotected _svg: string;\n\tprotected _nextX: number;\n\tprotected _nextY: number;\n\tprotected _height: number;\n\n\tprotected _built?: { [ name: string ]: Texture };\n\n\tconstructor( width: number, ratio: number, margin: number ) {\n\t\tthis._width = width;\n\t\tthis._ratio = ratio;\n\t\tthis._margin = margin;\n\n\t\tthis._frames = {};\n\t\tthis._svg = \"\";\n\t\tthis._nextX = 0;\n\t\tthis._nextY = 0;\n\t\tthis._height = 0;\n\t}\n\n\tget width(): number {\n\t\treturn this._width;\n\t}\n\n\tget ratio(): number {\n\t\treturn this._ratio;\n\t}\n\n\tget margin(): number {\n\t\treturn this._margin;\n\t}\n\n\tadd( name: string, width: number, height: number, path: string ): boolean {\n\t\tconst frames = this._frames;\n\t\tif( ! ( name in frames ) ) {\n\t\t\t// Position\n\t\t\tconst margin = this._margin;\n\t\t\tlet x = this._nextX;\n\t\t\tlet y = this._nextY;\n\t\t\tif( this._width <= x + width ) {\n\t\t\t\tx = 0;\n\t\t\t\ty = this._nextY + this._height + margin;\n\t\t\t\tthis._height = height;\n\t\t\t\tthis._nextY = y;\n\t\t\t} else {\n\t\t\t\tthis._height = Math.max( this._height, height );\n\t\t\t}\n\t\t\tthis._nextX = x + width + margin;\n\n\t\t\t// Frame\n\t\t\tframes[ name ] = new Rectangle( x, y, width, height );\n\n\t\t\t// Svg\n\t\t\tconst ratio = this._ratio;\n\t\t\tthis._svg += `<g transform=\"translate(${x * ratio},${y * ratio})\">${path}</g>`;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tget mappings(): { [ name: string ]: Texture } {\n\t\treturn this.build();\n\t}\n\n\tbuild( options?: UtilSvgAtlasBuilderBuildOptions ): { [ name: string ]: Texture } {\n\t\tlet built = this._built;\n\t\tif( built == null || (options?.force) ) {\n\t\t\tconst resolution = ( options?.resolution ?? (window.devicePixelRatio ?? 1) );\n\t\t\tconst width = this._width;\n\t\t\tconst height = Math.pow( 2, Math.ceil( Math.log( this._nextY + this._height ) / Math.LN2 ) );\n\t\t\tconst realWidth = width * resolution;\n\t\t\tconst realHeight = height * resolution;\n\t\t\tconst ratio = this._ratio;\n\t\t\tconst attrWidth = `width=\"${realWidth}\"`;\n\t\t\tconst attrHeight = `height=\"${realHeight}\"`;\n\t\t\tconst attrViewBox = `viewBox=\"0 0 ${width * ratio} ${height * ratio}\"`;\n\t\t\tconst attrXmlns = `xmlns=\"http://www.w3.org/2000/svg\"`;\n\t\t\tconst url = toSvgUrl( `<svg ${attrWidth} ${attrHeight} ${attrViewBox} ${attrXmlns}>${this._svg}</svg>` );\n\t\t\tconst scaleMode = (options?.scaling ?? SCALE_MODES.NEAREST);\n\t\t\tconst baseTexture = BaseTexture.from( url, {\n\t\t\t\tresolution,\n\t\t\t\tscaleMode\n\t\t\t});\n\t\t\tconst frames = this._frames;\n\t\t\tbuilt = this._built = {};\n\t\t\tfor( const name in frames ) {\n\t\t\t\tbuilt[ name ] = new Texture( baseTexture, frames[ name ] );\n\t\t\t}\n\t\t}\n\t\treturn built;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Extract, Matrix, Renderer, RenderTexture, SCALE_MODES, utils } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { UtilExtractorPixels } from \"./util-extractor-pixels\";\n\nexport class UtilExtractor {\n\tstatic toTexture(\n\t\ttarget: DBase, resolution?: number,\n\t\tclear?: boolean, skipUpdateTransform?: boolean\n\t): RenderTexture {\n\t\tconst scale = target.transform.scale;\n\t\tconst result = RenderTexture.create({\n\t\t\twidth: target.width * scale.x,\n\t\t\theight: target.height * scale.y,\n\t\t\tscaleMode: SCALE_MODES.LINEAR,\n\t\t\tresolution\n\t\t});\n\t\tconst matrix = new Matrix(\n\t\t\tundefined, undefined, undefined, undefined,\n\t\t\t-target.position.x, -target.position.y\n\t\t);\n\t\tconst layer = DApplications.getLayer( target );\n\t\tif( layer ) {\n\t\t\tlayer.renderer.render( target, result, clear, matrix, skipUpdateTransform );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toPixels( renderTexture: RenderTexture, renderer: Renderer ): UtilExtractorPixels {\n\t\tconst resolution = renderTexture.resolution;\n\t\tconst frame = renderTexture.frame;\n\t\tconst width = Math.floor( frame.width * resolution );\n\t\tconst height = Math.floor( frame.height * resolution );\n\t\tconst pixels = new Uint8Array( 4 * width * height );\n\n\t\trenderer.renderTexture.bind( renderTexture );\n\t\tconst gl = renderer.gl;\n\t\tgl.readPixels(\n\t\t\tframe.x * resolution,\n\t\t\tframe.y * resolution,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tgl.RGBA,\n\t\t\tgl.UNSIGNED_BYTE,\n\t\t\tpixels\n\t\t);\n\n\t\treturn {\n\t\t\twidth,\n\t\t\theight,\n\t\t\tarray: pixels\n\t\t};\n\t}\n\n\tstatic toCanvas( pixels: UtilExtractorPixels, scale?: number, ignorePremutipliedAlpha?: boolean ): utils.CanvasRenderTarget {\n\t\tconst width = pixels.width;\n\t\tconst height = pixels.height;\n\t\tconst array = pixels.array;\n\t\tconst canvasRenderTarget = new utils.CanvasRenderTarget( width, height, 1 );\n\n\t\tconst imageData = canvasRenderTarget.context.getImageData( 0, 0, width, height );\n\t\tif( ignorePremutipliedAlpha ) {\n\t\t\timageData.data.set( array );\n\t\t} else {\n\t\t\t(Extract as any).arrayPostDivide( array, imageData.data );\n\t\t}\n\t\tcanvasRenderTarget.context.putImageData( imageData, 0, 0 );\n\n\t\t// Scale down\n\t\tif( scale != null && scale !== 1 ) {\n\t\t\tcanvasRenderTarget.context.scale( scale, scale );\n\t\t\tcanvasRenderTarget.context.drawImage( canvasRenderTarget.canvas, 0, 0 );\n\t\t\tconst scaledWidth = Math.floor( width * scale );\n\t\t\tconst scaledHeight = Math.floor( height * scale );\n\t\t\tconst scaledImageData = canvasRenderTarget.context.getImageData( 0, 0, scaledWidth, scaledHeight );\n\t\t\tcanvasRenderTarget.resize( scaledWidth, scaledHeight );\n\t\t\tcanvasRenderTarget.context.putImageData( scaledImageData, 0, 0 );\n\t\t}\n\n\t\treturn canvasRenderTarget;\n\t}\n\n\tstatic toBase64( canvas: HTMLCanvasElement, format?: string, quality?: number ): string {\n\t\treturn canvas.toDataURL( format, quality );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilFileDownloader {\n\t/**\n\t * Downloads a file of the given name and URL.\n\t *\n\t * @param filename a file name\n\t * @param url a file URL\n\t */\n\tstatic downloadUrl( filename: string, url: string ): void {\n\t\tconst a = document.createElement( \"a\" );\n\t\tif( \"download\" in a ) {\n\t\t\ta.href = url;\n\t\t\ta.setAttribute( \"download\", filename );\n\t\t\ta.style.display = \"none\";\n\t\t\tdocument.body.appendChild( a );\n\t\t\ta.click();\n\t\t\tsetTimeout((): void => {\n\t\t\t\tdocument.body.removeChild( a );\n\t\t\t}, 66);\n\t\t} else {\n\t\t\tif( ! window.open( url ) ) {\n\t\t\t\tlocation.href = url;\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Downloads a file of the given name with the given contents.\n\t *\n\t * @param filename a file name\n\t * @param contents file contents\n\t * @param insertBom false to stop the BOM insertion\n\t */\n\tstatic download( filename: string, contents: string, insertBom?: boolean ): void {\n\t\tconst blob = new Blob(\n\t\t\t( insertBom !== false ? [ \"\\ufeff\", contents ] : [ contents ] ),\n\t\t\t{ type: \"text/plain\" }\n\t\t);\n\t\tif( window.navigator.msSaveBlob ) {\n\t\t\twindow.navigator.msSaveBlob( blob, filename );\n\t\t} else {\n\t\t\tthis.downloadUrl( filename, URL.createObjectURL( blob ) );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Renderer, RenderTexture, utils } from \"pixi.js\";\nimport { DApplicationLayerLike } from \"../d-application-layer-like\";\nimport { DApplicationLike } from \"../d-application-like\";\nimport { DApplications } from \"../d-applications\";\nimport { DBase } from \"../d-base\";\nimport { isNumber } from \"./is-number\";\nimport { UtilExtractor } from \"./util-extractor\";\nimport { UtilExtractorPixels } from \"./util-extractor-pixels\";\nimport { UtilFileDownloader } from \"./util-file-downloader\";\n\nexport interface UtilExtractTextureResolutionOptions {\n\tsize: number;\n}\n\nexport interface UtilExtractTextureTransformOptions {\n\tupdate?: boolean;\n}\n\nexport interface UtilExtractTextureOptions {\n\ttarget: DBase;\n\tresolution?: number | UtilExtractTextureResolutionOptions;\n\ttransform?: UtilExtractTextureTransformOptions;\n\tclear?: boolean;\n}\n\nexport interface UtilExtractPixelsOptions extends UtilExtractTextureOptions {\n\trenderer?: Renderer;\n\tapplication?: DApplicationLike;\n\tlayer?: DApplicationLayerLike;\n}\n\nexport interface UtilExtractCanvasOptions extends UtilExtractPixelsOptions {\n\tscale?: number | {\n\t\tsize: number;\n\t};\n\talpha?: {\n\t\tpremultiplied?: {\n\t\t\tignore?: boolean;\n\t\t}\n\t};\n}\n\nexport interface UtilExtractBase64Options extends UtilExtractCanvasOptions {\n\tformat?: string;\n\tquality?: number;\n}\n\nexport interface UtilExtractFileOptions extends UtilExtractBase64Options {\n\tfilename: string;\n}\n\nconst toSkipUpdateTransform = ( options: UtilExtractTextureOptions ): boolean | undefined => {\n\treturn options.transform && options.transform.update;\n};\n\nconst toResolution = ( options: UtilExtractTextureOptions ): number => {\n\tconst target = options.target;\n\tif( options.resolution != null ) {\n\t\tif( isNumber( options.resolution ) ) {\n\t\t\treturn options.resolution;\n\t\t} else {\n\t\t\tconst scale = target.transform.scale;\n\t\t\tconst size = Math.max( target.width * scale.x, target.height * scale.y );\n\t\t\treturn Math.min( 1, options.resolution.size / size );\n\t\t}\n\t} else {\n\t\treturn window.devicePixelRatio || 1;\n\t}\n};\n\nconst toIgnorePremultipliedAlpha = ( options: UtilExtractCanvasOptions ): boolean | undefined => {\n\treturn ( options.alpha && options.alpha.premultiplied && options.alpha.premultiplied.ignore );\n};\n\nconst toScale = ( pixels: UtilExtractorPixels, options: UtilExtractCanvasOptions ): number | undefined => {\n\tif( options.scale != null ) {\n\t\tif( isNumber( options.scale ) ) {\n\t\t\treturn options.scale;\n\t\t} else {\n\t\t\tconst size = options.scale.size;\n\t\t\treturn Math.min( 1, size / pixels.width, size / pixels.height );\n\t\t}\n\t}\n};\n\nconst toRenderer = ( options: UtilExtractPixelsOptions ): Renderer => {\n\tif( options.renderer ) {\n\t\treturn options.renderer;\n\t} else if( options.application ) {\n\t\treturn options.application.getLayerBase().renderer;\n\t} else if( options.layer ) {\n\t\treturn options.layer.renderer;\n\t} else {\n\t\tconst layer = DApplications.getLayer( options.target );\n\t\tif( layer ) {\n\t\t\treturn layer.renderer;\n\t\t} else {\n\t\t\tthrow new Error( \"No renderer / application / layer found.\" );\n\t\t}\n\t}\n};\n\nexport class UtilExtract {\n\tstatic texture( options: UtilExtractTextureOptions ): RenderTexture {\n\t\tconst target = options.target;\n\t\tconst resolution = toResolution( options );\n\t\tconst skipUpdateTransform = toSkipUpdateTransform( options );\n\t\treturn UtilExtractor.toTexture( target, resolution, options.clear, skipUpdateTransform );\n\t}\n\n\tstatic pixels( options: UtilExtractPixelsOptions ): UtilExtractorPixels {\n\t\tconst renderer = toRenderer( options );\n\t\tconst texture = this.texture( options );\n\t\ttry {\n\t\t\treturn UtilExtractor.toPixels( texture, renderer );\n\t\t} finally {\n\t\t\tif( texture ) {\n\t\t\t\ttexture.destroy();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic canvas( options: UtilExtractCanvasOptions ): utils.CanvasRenderTarget {\n\t\tconst pixels = this.pixels( options );\n\t\tconst ignorePremutipliedAlpha = toIgnorePremultipliedAlpha( options );\n\t\tconst scale = toScale( pixels, options );\n\t\treturn UtilExtractor.toCanvas( pixels, scale, ignorePremutipliedAlpha );\n\t}\n\n\tstatic base64( options: UtilExtractBase64Options ): string {\n\t\tconst canvas = this.canvas( options );\n\t\ttry {\n\t\t\treturn UtilExtractor.toBase64( canvas.canvas, options.format, options.quality );\n\t\t} finally {\n\t\t\tif( canvas ) {\n\t\t\t\tcanvas.destroy();\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic file( options: UtilExtractFileOptions ): void {\n\t\tUtilFileDownloader.downloadUrl( options.filename, this.base64( options ) );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DCommandFlag {\n\tNONE = 0,\n\n\t/**\n\t * Commands with a `UNSTORABLE` flag will not be queued to the `done` queue.\n\t */\n\tUNSTORABLE = 1,\n\n\t/**\n\t * Commands with a `CLEAR` flag clears the command queue.\n\t */\n\tCLEAR = 2\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilHsv {\n\t/**\n\t * Returns HSV colors.\n\t * Ranges of components are:\n\t *\n\t * * H: [0, 360)\n\t * * S: [0, 255]\n\t * * V: [0, 255]\n\t *\n\t * @param color a rgb color\n\t * @return an array of hsv components\n\t */\n\tstatic fromRgb( color: number ): [ number, number, number ] {\n\t\tconst r = (color & 0xff0000) >> 16;\n\t\tconst g = (color & 0x00ff00) >> 8;\n\t\tconst b = (color & 0x0000ff) | 0;\n\n\t\tconst max = Math.max( r, g, b );\n\t\tconst min = Math.min( r, g, b );\n\t\tconst length = max - min;\n\t\tlet h = 0;\n\t\tif( 0 < length ) {\n\t\t\tif( r === max ) {\n\t\t\t\th = 60 * ( g - b ) / length;\n\t\t\t} else if( g === max ) {\n\t\t\t\th = 60 * ( b - r ) / length + 120;\n\t\t\t} else if( b === max ) {\n\t\t\t\th = 60 * ( r - g ) / length + 240;\n\t\t\t}\n\t\t\tif( h < 0 ) {\n\t\t\t\th += 360;\n\t\t\t}\n\t\t}\n\n\t\tconst s = ( length / max ) * 255;\n\t\tconst v = max;\n\t\treturn [ h, s, v ];\n\t}\n\n\tstatic toRgb( h: number, s: number, v: number ): number {\n\t\tconst max = v;\n\t\tconst min = v - (s / 255) * v;\n\t\tconst length = max - min;\n\n\t\tlet r = 0;\n\t\tlet g = 0;\n\t\tlet b = 0;\n\t\tif( h <= 60 ) {\n\t\t\tr = max;\n\t\t\tg = (h / 60) * length + min;\n\t\t\tb = min;\n\t\t} else if( h <= 120 ) {\n\t\t\tr = ((120 - h) / 60) * length + min;\n\t\t\tg = max;\n\t\t\tb = min;\n\t\t} else if( h <= 180 ) {\n\t\t\tr = min;\n\t\t\tg = max;\n\t\t\tb = ((h - 120) / 60) * length + min;\n\t\t} else if( h <= 240 ) {\n\t\t\tr = min;\n\t\t\tg = ((240 - h) / 60) * length + min;\n\t\t\tb = max;\n\t\t} else if( h <= 300 ) {\n\t\t\tr = ((h - 240) / 60) * length + min;\n\t\t\tg = min;\n\t\t\tb = max;\n\t\t} else {\n\t\t\tr = max;\n\t\t\tg = min;\n\t\t\tb = ((360 - h) / 60) * length + min;\n\t\t}\n\n\t\tr = Math.max( 0, Math.min( 255, r ) );\n\t\tg = Math.max( 0, Math.min( 255, g ) );\n\t\tb = Math.max( 0, Math.min( 255, b ) );\n\n\t\treturn (r << 16) | (g << 8) | b;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilName {\n\tprotected static _mapping: { [ key: string]: number } = {};\n\n\tstatic create( type: string ) {\n\t\tconst mapping = this._mapping;\n\t\tif( type in mapping ) {\n\t\t\treturn `${type} ${++mapping[ type ]}`;\n\t\t} else {\n\t\t\tmapping[ type ] = 1;\n\t\t\treturn `${type} 1`;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilPromise {\n\tstatic IDENTITY = () => { /* DO NOTHING*/ };\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class UtilRgba {\n\tstatic toCode( color: number, alpha: number ): string {\n\t\tconst r = ( color >> 16 ) & 0xff;\n\t\tconst g = ( color >> 8 ) & 0xff;\n\t\tconst b = ( color & 0xff );\n\t\treturn `rgba(${r},${g},${b},${alpha})`;\n\t}\n}\n","import { DBase } from \"../d-base\";\n\nexport class UtilStateBlinker {\n\tprotected _isOn: boolean;\n\tprotected _targets: Set<DBase>;\n\tprotected _state: string;\n\tprotected _delay: number;\n\tprotected _interval: number;\n\tprotected _timeout: number | null;\n\tprotected _updateBound: () => void;\n\n\tconstructor( state: string, delay: number, interval: number ) {\n\t\tthis._isOn = true;\n\t\tthis._targets = new Set();\n\t\tthis._state = state;\n\t\tthis._delay = delay;\n\t\tthis._interval = interval;\n\t\tthis._timeout = null;\n\n\t\tconst updateBound = (): void => {\n\t\t\tthis.advance();\n\t\t\tthis.update();\n\t\t\tthis._timeout = window.setTimeout( updateBound, interval );\n\t\t};\n\t\tthis._updateBound = updateBound;\n\t}\n\n\tstart(): this {\n\t\tif( this._timeout == null ) {\n\t\t\tthis._timeout = window.setTimeout( this._updateBound, this._delay );\n\t\t}\n\t\treturn this;\n\t}\n\n\tstop(): this {\n\t\tconst timeout = this._timeout;\n\t\tif( timeout != null ) {\n\t\t\tthis._timeout = null;\n\t\t\tclearTimeout( timeout );\n\t\t}\n\t\treturn this;\n\t}\n\n\tadd( target: DBase ): this {\n\t\tthis._targets.add( target );\n\t\ttarget.state.set( this._state, this.isOn() );\n\t\treturn this;\n\t}\n\n\tremove( target: DBase ): boolean {\n\t\tif( this._targets.delete( target ) ) {\n\t\t\ttarget.state.remove( this._state );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcontains( target: DBase ): boolean {\n\t\treturn this._targets.has( target );\n\t}\n\n\tclear(): this {\n\t\tthis._targets.clear();\n\t\treturn this;\n\t}\n\n\tisOn(): boolean {\n\t\treturn this._isOn;\n\t}\n\n\tisOff(): boolean {\n\t\treturn ! this._isOn;\n\t}\n\n\tadvance(): this {\n\t\tthis._isOn = ! this._isOn;\n\t\treturn this;\n\t}\n\n\tupdate(): this {\n\t\tconst isOn = this.isOn();\n\t\tconst state = this._state;\n\t\tthis._targets.forEach(( target: DBase ): void => {\n\t\t\ttarget.state.set( state, isOn );\n\t\t});\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { DApplications } from \"../d-applications\";\nimport { DCornerMask } from \"../d-corner-mask\";\nimport { toSvgUrl } from \"./to-svg-url\";\n\nexport class UtilTexturePlane {\n\tprotected static INSTANCE: UtilTexturePlane | null = null;\n\n\tprotected _backgroundCache: Map<number, Texture>;\n\tprotected _backgroundAttribute: string;\n\tprotected _borderCache: Map<number, Map<number, Texture>>;\n\tprotected _borderAttribute: ( width: number ) => string;\n\tprotected _onUpdate: () => void;\n\n\tconstructor() {\n\t\tthis._backgroundCache = new Map<number, Texture>();\n\t\tthis._backgroundAttribute = `fill=\"#fff\" stroke=\"none\"`;\n\t\tthis._borderCache = new Map<number, Map<number, Texture>>();\n\t\tthis._borderAttribute = ( width: number ): string => {\n\t\t\treturn `fill=\"none\" stroke=\"#fff\" stroke-width=\"${width}\"`;\n\t\t};\n\t\tthis._onUpdate = (): void => {\n\t\t\tDApplications.update();\n\t\t};\n\t}\n\n\tprotected toCornerTl( offset: number, size: number, tl: number ): string {\n\t\treturn ( 0 < tl ? `A${tl} ${tl} 0 0 1 ${offset + tl} ${offset}` : \"\" );\n\t}\n\n\tprotected toCornerBr( offset: number, size: number, br: number ): string {\n\t\treturn ( 0 < br ? `A${br} ${br} 0 0 1 ${offset + size - br} ${offset + size}` : \"\" );\n\t}\n\n\tprotected make( radius: number, offset: number, attr: string ): Texture {\n\t\tconst realRadius = Math.max( 0, radius - offset );\n\t\tconst size: number = realRadius * 2 + 4;\n\t\tconst realSize: number = size + offset * 2;\n\t\tconst d =\n\t\t\t`M${offset + realRadius} ${offset}` +\n\t\t\t`L${offset + size} ${offset}` +\n\t\t\t`L${offset + size} ${offset + size - realRadius}` +\n\t\t\tthis.toCornerBr( offset, size, realRadius ) +\n\t\t\t`L${offset} ${offset + size}` +\n\t\t\t`L${offset} ${offset + realRadius}` +\n\t\t\tthis.toCornerTl( offset, size, realRadius ) +\n\t\t\t`Z`;\n\t\treturn this.toSvg( realSize, attr, d );\n\t}\n\n\tprotected toSvg( realSize: number, attr: string, d: string ): Texture {\n\t\tconst resolution = (window.devicePixelRatio || 1);\n\t\tconst widthAttr = `width=\"${realSize * resolution}\"`;\n\t\tconst heightAttr = `height=\"${realSize * resolution}\"`;\n\t\tconst viewBoxAttr = `viewBox=\"0 0 ${realSize} ${realSize}\"`;\n\t\tconst svg = `<svg ${widthAttr} ${heightAttr} ${viewBoxAttr} xmlns=\"http://www.w3.org/2000/svg\">` +\n\t\t\t`<path ${attr} d=\"${d}\"></path>` +\n\t\t`</svg>`;\n\t\treturn Texture.from( toSvgUrl( svg ), {\n\t\t\tresolution\n\t\t});\n\t}\n\n\tnewBackground( radius: number ): Texture {\n\t\tconst result = this.make( radius, 0, this._backgroundAttribute );\n\t\tresult.on( \"update\", this._onUpdate );\n\t\treturn result;\n\t}\n\n\tnewBorder( radius: number, width: number ): Texture {\n\t\tconst result = this.make( radius, 0.5 * width, this._borderAttribute( width ) );\n\t\tresult.on( \"update\", this._onUpdate );\n\t\treturn result;\n\t}\n\n\tgetBackground( radius: number ): Texture {\n\t\tconst cache = this._backgroundCache;\n\n\t\tlet texture = cache.get( radius );\n\t\tif( texture == null ) {\n\t\t\ttexture = this.newBackground( radius );\n\t\t\tcache.set( radius, texture );\n\t\t}\n\n\t\treturn texture;\n\t}\n\n\tgetBorder( radius: number, width: number ): Texture {\n\t\tconst cache = this._borderCache;\n\n\t\tlet maskToTexture = cache.get( radius );\n\t\tif( maskToTexture == null ) {\n\t\t\tmaskToTexture = new Map<DCornerMask, Texture>();\n\t\t\tcache.set( radius, maskToTexture );\n\t\t}\n\n\t\tlet texture = maskToTexture.get( width );\n\t\tif( texture == null ) {\n\t\t\ttexture = this.newBorder( radius, width );\n\t\t\tmaskToTexture.set( width, texture );\n\t\t}\n\n\t\treturn texture;\n\t}\n\n\tstatic getInstance(): UtilTexturePlane {\n\t\tif( UtilTexturePlane.INSTANCE == null ) {\n\t\t\tUtilTexturePlane.INSTANCE = new UtilTexturePlane();\n\t\t}\n\t\treturn UtilTexturePlane.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\n\nexport class UtilTexture {\n\tstatic fromImage( url: string, resolution: number, onLoad: ( texture: Texture ) => void ) {\n\t\tconst texture = Texture.from( url, {\n\t\t\tresolution\n\t\t});\n\t\tif( ! texture.baseTexture.valid ) {\n\t\t\ttexture.once( \"update\", onLoad );\n\t\t} else {\n\t\t\tonLoad( texture );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"../d-base\";\n\nexport interface UtilTransitionOptions {\n\tduration?: number;\n}\n\nexport class UtilTransition {\n\tprotected _duration: number;\n\tprotected _current: DBase<any, any> | null;\n\tprotected _lastUpdate: number;\n\tprotected _updateId: number | null;\n\n\tconstructor( options?: UtilTransitionOptions ) {\n\t\tthis._duration = ( options != null && options.duration != null ? options.duration : 300 );\n\t\tthis._current = null;\n\t\tthis._lastUpdate = 0;\n\t\tthis._updateId = null;\n\t}\n\n\tshow( next: DBase<any, any> | null, forcibly?: boolean ): void {\n\t\tconst updateId = this._updateId;\n\t\tif( updateId != null ) {\n\t\t\tclearTimeout( updateId );\n\t\t}\n\n\t\tconst current = this._current;\n\t\tif( next !== current ) {\n\t\t\tconst duration = this._duration;\n\t\t\tconst lastUpdate = this._lastUpdate;\n\t\t\tconst now = Date.now();\n\t\t\tconst remaining = (lastUpdate + duration) - now;\n\t\t\tif( forcibly === true || remaining <= 0 ) {\n\t\t\t\tthis.update( now, next );\n\t\t\t} else {\n\t\t\t\tthis._updateId = window.setTimeout(() => {\n\t\t\t\t\tthis.update( Date.now(), next );\n\t\t\t\t}, remaining );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected update( now: number, next: DBase<any, any> | null ) {\n\t\tconst current = this._current;\n\t\tif( current !== next ) {\n\t\t\tthis._lastUpdate = now;\n\n\t\t\tif( current !== null ) {\n\t\t\t\tcurrent.hide();\n\t\t\t}\n\n\t\t\tthis._current = next;\n\t\t\tif( next != null ) {\n\t\t\t\tnext.show();\n\t\t\t}\n\t\t}\n\t}\n\n\thide(): void {\n\t\tthis.show( null );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeFont } from \"../d-font\";\nimport { DThemes } from \"../theme/d-themes\";\n\nexport interface UtilWheelEventDeltas {\n\tmode: number;\n\tdelta: number;\n\tdeltaX: number;\n\tdeltaY: number;\n\tlowest: number;\n}\n\n/*!\n* jQuery Mousewheel 3.1.13\n*\n* Copyright jQuery Foundation and other contributors\n* Released under the MIT license\n* http://jquery.org/license\n*\n* See also https://github.com/mapbox/mapbox-gl-js/blob/001c7b9/js/ui/handler/scroll_zoom.js\n* and https://github.com/openlayers/openlayers/blob/v5.2.0/src/ol/interaction/MouseWheelZoom.js#L51\n*/\nexport class UtilWheelEvent {\n\tprivate static INSTANCE: UtilWheelEvent | null;\n\tprivate _names: Array<\"wheel\" | \"mousewheel\" | \"DOMMouseScroll\" | \"MozMousePixelScroll\">;\n\tprivate _lowest: number | null = null;\n\tprivate _timestamp: number = 0;\n\tprivate _lineHeight: number | null = null;\n\tprivate _pageHeight: number | null = null;\n\n\tconstructor() {\n\t\tthis._names = ( \"onwheel\" in document || 9 <= (document as any).documentMode ?\n\t\t\t[ \"wheel\" ] : [ \"mousewheel\", \"DOMMouseScroll\", \"MozMousePixelScroll\" ]\n\t\t);\n\t}\n\n\ton( target: HTMLElement, handler: ( e: WheelEvent | Event ) => void, useCapture: boolean = false ) {\n\t\tconst names = this._names;\n\t\tfor( let i = names.length - 1; 0 <= i; --i ) {\n\t\t\tconst name = names[ i ];\n\t\t\ttarget.addEventListener( name, handler, useCapture );\n\t\t}\n\t}\n\n\toff( target: HTMLElement, handler: ( e: WheelEvent | Event ) => void, useCapture: boolean = false ) {\n\t\tconst names = this._names;\n\t\tfor( let i = names.length - 1; 0 <= i; --i ) {\n\t\t\tconst name = names[ i ];\n\t\t\ttarget.removeEventListener( name, handler, useCapture );\n\t\t}\n\t}\n\n\tgetLineHeight(): number {\n\t\tif( this._lineHeight == null ) {\n\t\t\tconst theme = DThemes.getInstance().get( \"DBase\" ) as DThemeFont;\n\t\t\tthis._lineHeight = theme.getLineHeight();\n\t\t}\n\t\treturn this._lineHeight;\n\t}\n\n\tgetPageHeight(): number {\n\t\tif( this._pageHeight == null ) {\n\t\t\tthis._pageHeight = this.getLineHeight() * 12;\n\t\t}\n\t\treturn this._pageHeight;\n\t}\n\n\tnormalize( e: any ): UtilWheelEventDeltas | null {\n\t\tlet deltaX = 0;\n\t\tlet deltaY = 0;\n\n\t\t// Old school scrollwheel delta\n\t\tif ( \"detail\" in e ) {\n\t\t\tdeltaY = e.detail * -1;\n\t\t}\n\t\tif ( \"wheelDelta\" in e ) {\n\t\t\tdeltaY = e.wheelDelta;\n\t\t}\n\t\tif ( \"wheelDeltaY\" in e ) {\n\t\t\tdeltaY = e.wheelDeltaY;\n\t\t}\n\t\tif ( \"wheelDeltaX\" in e ) {\n\t\t\tdeltaX = e.wheelDeltaX * -1;\n\t\t}\n\n\t\t// Firefox < 17 horizontal scrolling related to DOMMouseScroll event\n\t\tif ( \"axis\" in e && e.axis === e.HORIZONTAL_AXIS ) {\n\t\t\tdeltaX = deltaY * -1;\n\t\t\tdeltaY = 0;\n\t\t}\n\n\t\t// New school wheel delta (wheel event)\n\t\tif ( \"deltaY\" in e ) {\n\t\t\tdeltaY = e.deltaY * -1;\n\t\t}\n\t\tif ( \"deltaX\" in e ) {\n\t\t\tdeltaX = e.deltaX;\n\t\t}\n\n\t\t// No change actually happened, no reason to go any further\n\t\tif ( deltaY === 0 && deltaX === 0 ) {\n\t\t\treturn null;\n\t\t}\n\n\t\t// Store lowest absolute delta to normalize the delta values\n\t\tlet delta = Math.max( Math.abs(deltaY), Math.abs(deltaX) );\n\n\t\t// Reset the this._lowest to better handle multiple device types\n\t\t// that give different a different lowestDelta\n\t\t// Ex: trackpad = 3 and mouse wheel = 120\n\t\tconst now = Date.now();\n\t\tif( this._timestamp + 200 <= now ) {\n\t\t\tthis._lowest = null;\n\t\t}\n\t\tthis._timestamp = now;\n\n\t\t//\n\t\tconst shouldAdjust = (e.type === \"mousewheel\" && delta % 120 === 0);\n\t\tif ( ! this._lowest || delta < this._lowest ) {\n\t\t\tthis._lowest = delta;\n\n\t\t\t// Adjust older deltas if necessary\n\t\t\tif ( shouldAdjust ) {\n\t\t\t\tthis._lowest /= 40;\n\t\t\t}\n\t\t}\n\n\t\t// Adjust older deltas if necessary\n\t\tif ( shouldAdjust ) {\n\t\t\t// Divide all the things by 40!\n\t\t\tdelta  /= 40;\n\t\t\tdeltaX /= 40;\n\t\t\tdeltaY /= 40;\n\t\t}\n\n\t\t// Get a whole, normalized value for the deltas\n\t\tconst lowest = this._lowest;\n\t\tdelta  = Math.floor( delta  / lowest );\n\t\tdeltaX = Math[ 1 <= deltaX ? \"floor\" : \"ceil\" ](deltaX / lowest);\n\t\tdeltaY = Math[ 1 <= deltaY ? \"floor\" : \"ceil\" ](deltaY / lowest);\n\n\t\t// Mode\n\t\tconst mode = e.deltaMode || 0;\n\t\tif( mode !== 0 ) {\n\t\t\tconst scale = ( mode === 1 ? this.getLineHeight() : this.getPageHeight() );\n\t\t\tdelta *= scale;\n\t\t\tdeltaX *= scale;\n\t\t\tdeltaY *= scale;\n\t\t}\n\n\t\treturn {\n\t\t\tmode,\n\t\t\tdelta,\n\t\t\tdeltaX,\n\t\t\tdeltaY,\n\t\t\tlowest\n\t\t};\n\t}\n\n\tstatic getInstance(): UtilWheelEvent {\n\t\tif( this.INSTANCE == null ) {\n\t\t\tthis.INSTANCE = new UtilWheelEvent();\n\t\t}\n\t\treturn this.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DAnimation, DAnimationOnEnd, DAnimationOnTime, DAnimationOptions } from \"./d-animation\";\n\nexport class DAnimationEmpty<TARGET = unknown> extends utils.EventEmitter implements DAnimation<TARGET> {\n\tprotected _reverse: boolean;\n\tprotected _onTime: DAnimationOnTime<TARGET> | undefined;\n\tprotected _onStart: DAnimationOnEnd<TARGET> | undefined;\n\tprotected _onEnd: DAnimationOnEnd<TARGET> | undefined;\n\tprotected _target: TARGET | null;\n\tprotected _isStarted: boolean;\n\n\tconstructor( options?: DAnimationOptions<TARGET> ) {\n\t\tsuper();\n\n\t\tthis._target = (options && options.target != null ? options.target : null);\n\t\tthis._reverse = false;\n\t\tthis._isStarted = false;\n\t\tthis._onTime = options && options.onTime;\n\t\tthis._onStart = options && options.onStart;\n\t\tthis._onEnd = options && options.onEnd;\n\t}\n\n\tget target(): TARGET | null {\n\t\treturn this._target;\n\t}\n\n\tset target( target: TARGET | null ) {\n\t\tthis._target = target;\n\t}\n\n\tget duration(): number {\n\t\treturn 0;\n\t}\n\n\tset duration( duration: number ) {\n\t\t// DO NOTHING\n\t}\n\n\tstart( reverse: boolean = false ): void {\n\t\tthis.stop();\n\t\tthis._isStarted = true;\n\t\tthis._reverse = reverse;\n\n\t\t// onStart\n\t\tthis.onStart( reverse );\n\t\tif( ! this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// onTime\n\t\tthis.onTime( reverse ? 1 : 0, reverse, 0 );\n\t\tif( ! this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.onTime( reverse ? 0 : 1, reverse, 0 );\n\t\tif( this._isStarted ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// OnEnd\n\t\tthis.onEnd( reverse );\n\t}\n\n\tprotected onStart( isReverse: boolean ): void {\n\t\tconst onStart = this._onStart;\n\t\tif( onStart != null ) {\n\t\t\tonStart( isReverse, this );\n\t\t}\n\t\tthis.emit( \"start\", isReverse, this );\n\t}\n\n\tprotected onTime( time: number, isReverse: boolean, elapsedTime: number ): void {\n\t\tconst onTime = this._onTime;\n\t\tif( onTime != null ) {\n\t\t\tonTime( time, isReverse, elapsedTime, this );\n\t\t}\n\t\tthis.emit( \"time\", time, isReverse, elapsedTime, this );\n\t}\n\n\tprotected onEnd( isReverse: boolean ): void {\n\t\tconst onEnd = this._onEnd;\n\t\tif( onEnd != null ) {\n\t\t\tonEnd( isReverse, this );\n\t\t}\n\t\tthis.emit( \"end\", isReverse, this );\n\t}\n\n\tisStarted(): boolean {\n\t\treturn this._isStarted;\n\t}\n\n\tisReverse(): boolean {\n\t\treturn this._reverse;\n\t}\n\n\tstop(): void {\n\t\tthis._isStarted = false;\n\t}\n\n\tend(): void {\n\t\tconst isStarted = this._isStarted;\n\t\tif( isStarted ) {\n\t\t\tthis._isStarted = false;\n\n\t\t\t// OnTime\n\t\t\tconst reverse = this._reverse;\n\t\t\tconst time = ( reverse ? 0 : 1 );\n\t\t\tthis.onTime( time, reverse, 0 );\n\n\t\t\t// OnEnd\n\t\t\tthis.onEnd( reverse );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeBase } from \"./d-base\";\nimport { DPadding } from \"./d-padding\";\n\nexport class DApplicationPadding implements DPadding {\n\tleft: number;\n\ttop: number;\n\tright: number;\n\tbottom: number;\n\n\tconstructor( top: number, right: number, bottom: number, left: number ) {\n\t\tthis.left = left;\n\t\tthis.top = top;\n\t\tthis.right = right;\n\t\tthis.bottom = bottom;\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tgetTop(): number {\n\t\treturn this.left;\n\t}\n\n\tgetRight(): number {\n\t\treturn this.right;\n\t}\n\n\tgetBottom(): number {\n\t\treturn this.bottom;\n\t}\n\n\tgetLeft(): number {\n\t\treturn this.left;\n\t}\n\n\tset( padding: number ): void;\n\tset( topAndBottom: number, leftAndRight: number ): void;\n\tset( top: number, leftAndRight: number, bottom: number ): void;\n\tset( top: number, right?: number, bottom?: number, left?: number ): void {\n\t\tif( right == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = top;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = top;\n\t\t} else if( bottom == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = top;\n\t\t\tthis.left = right;\n\t\t} else if( left == null ) {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = right;\n\t\t} else {\n\t\t\tthis.top = top;\n\t\t\tthis.right = right;\n\t\t\tthis.bottom = bottom;\n\t\t\tthis.left = left;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplicationPadding } from \"./d-application-padding\";\nimport { DPadding, DPaddingLike } from \"./d-padding\";\nimport { isNumber } from \"./util/is-number\";\n\n/**\n * PixiJS options\n */\ninterface PixiApplicationOptions {\n\twidth: number;\n\theight: number;\n\tautoStart: boolean;\n\tbackgroundColor: number;\n\ttransparent: boolean;\n\tresolution: number;\n\tantialias: boolean;\n}\n\ninterface DApplicationLayerBackgroundOptions {\n\tcolor?: number | null;\n}\n\ninterface DApplicationLayerOptionsOptions {\n\troot: HTMLElement;\n\tpadding?: number | DPaddingLike;\n\twidth?: number;\n\theight?: number;\n\tbackground?: DApplicationLayerBackgroundOptions;\n\tresolution: number;\n\tantialias?: boolean;\n\n\t/**\n\t * Sets to true if a layer is a overlay layer.\n\t */\n\toverlay: boolean;\n}\n\n/**\n * DApplicationLayer options\n */\nexport class DApplicationLayerOptions {\n\tprivate _root: HTMLElement;\n\tprivate _pixi: PixiApplicationOptions;\n\tprivate _padding: DPadding;\n\tprivate _overlay: boolean;\n\n\tconstructor( options: DApplicationLayerOptionsOptions ) {\n\t\t// Root\n\t\tconst root = this._root = options.root;\n\n\t\t// Overlay mode or not\n\t\tthis._overlay = options.overlay;\n\n\t\t// Padding\n\t\tconst padding = options && options.padding;\n\t\tif( isNumber( padding ) ) {\n\t\t\tthis._padding = new DApplicationPadding( padding, padding, padding, padding );\n\t\t} else if( padding != null ) {\n\t\t\tthis._padding = new DApplicationPadding(\n\t\t\t\tpadding.top || 0,\n\t\t\t\tpadding.right || 0,\n\t\t\t\tpadding.bottom || 0,\n\t\t\t\tpadding.left || 0\n\t\t\t);\n\t\t} else {\n\t\t\tthis._padding = new DApplicationPadding( 6, 6, 6, 6 );\n\t\t}\n\n\t\t// Width & height\n\t\tlet width = 100;\n\t\tlet height = 100;\n\t\tif( options ) {\n\t\t\tif( options.width != null ) {\n\t\t\t\twidth = options.width;\n\t\t\t\tif( options.height != null ) {\n\t\t\t\t\theight = options.height;\n\t\t\t\t} else {\n\t\t\t\t\theight = root.getBoundingClientRect().height;\n\t\t\t\t}\n\t\t\t} else if( options.height != null ) {\n\t\t\t\twidth = root.getBoundingClientRect().width;\n\t\t\t\theight = options.height;\n\t\t\t} else {\n\t\t\t\tconst bbox = root.getBoundingClientRect();\n\t\t\t\twidth = bbox.width;\n\t\t\t\theight = bbox.height;\n\t\t\t}\n\t\t} else {\n\t\t\tconst bbox = root.getBoundingClientRect();\n\t\t\twidth = bbox.width;\n\t\t\theight = bbox.height;\n\t\t}\n\n\t\t// Background color\n\t\tconst background = options && options.background;\n\t\tlet backgroundColor = 0;\n\t\tlet transparent = true;\n\t\tif( background != null ) {\n\t\t\tconst color = background.color;\n\t\t\tif( color != null ) {\n\t\t\t\tbackgroundColor = color;\n\t\t\t\ttransparent = false;\n\t\t\t}\n\t\t}\n\n\t\t// Resolution\n\t\tconst resolution = options.resolution;\n\n\t\t// Antialias\n\t\tconst antialias = ( options && options.antialias != null ? options.antialias : false );\n\n\t\t// Pixi\n\t\tthis._pixi = {\n\t\t\twidth,\n\t\t\theight,\n\t\t\tautoStart: false,\n\t\t\tbackgroundColor,\n\t\t\ttransparent,\n\t\t\tresolution,\n\t\t\tantialias\n\t\t};\n\t}\n\n\t/**\n\t * Returns a root element.\n\t * `HTMLCanvasElement` and other DOM elements are created in this element.\n\t * The default root element is `document.body`.\n\t */\n\tgetRootElement(): HTMLElement {\n\t\treturn this._root;\n\t}\n\n\t/**\n\t * Sets a root element and updates the canvas width and height\n\t * if `updateWidthAndHeight` is not false.\n\t *\n\t * @param root new root element\n\t * @param updateWidthAndHeight false to preserve the canvas width / height\n\t */\n\tsetRootElement( root: HTMLElement, updateWidthAndHeight?: boolean ): this {\n\t\tif( this._root !== root ) {\n\t\t\tthis._root = root;\n\t\t\tif( updateWidthAndHeight !== false ) {\n\t\t\t\tconst bbox = root.getBoundingClientRect();\n\t\t\t\tconst pixi = this._pixi;\n\t\t\t\tpixi.width = bbox.width;\n\t\t\t\tpixi.height = bbox.height;\n\t\t\t}\n\t\t}\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a canvas width.\n\t */\n\tgetWidth(): number {\n\t\treturn this._pixi.width;\n\t}\n\n\t/**\n\t * Sets a canvas width.\n\t *\n\t * @param width new canvas width\n\t */\n\tsetWidth( width: number ): this {\n\t\tthis._pixi.width = width;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a canvas height.\n\t */\n\tgetHeight(): number {\n\t\treturn this._pixi.height;\n\t}\n\n\t/**\n\t * Sets a canvas height.\n\t *\n\t * @param height new canvas height\n\t */\n\tsetHeight( height: number ): this {\n\t\tthis._pixi.height = height;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns padding sizes.\n\t * The default padding size is 6.\n\t */\n\tgetPadding(): DPadding {\n\t\treturn this._padding;\n\t}\n\n\t/**\n\t * Sets padding sizes.\n\t *\n\t * @param left new left padding\n\t * @param top new top padding\n\t * @param right new right padding\n\t * @param bottom new bottom padding\n\t */\n\tsetPadding( left: number, top: number, right: number, bottom: number ): this {\n\t\tconst padding = this._padding;\n\t\tpadding.left = left;\n\t\tpadding.top = top;\n\t\tpadding.right = right;\n\t\tpadding.bottom = bottom;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns a background color.\n\t */\n\tgetBackgroundColor(): number {\n\t\treturn this._pixi.backgroundColor;\n\t}\n\n\t/**\n\t * Sets a background color.\n\t *\n\t * @param color new background color\n\t */\n\tsetBackgroundColor( color: number ): this {\n\t\tthis._pixi.backgroundColor = color;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns an antialias setting.\n\t * The default antialias setting is false.\n\t */\n\tgetAntialias(): boolean {\n\t\treturn this._pixi.antialias;\n\t}\n\n\t/**\n\t * Sets an antialias setting.\n\t *\n\t * @param antialias new antialias setting\n\t */\n\tsetAntialias( antialias: boolean ): this {\n\t\tthis._pixi.antialias = antialias;\n\t\treturn this;\n\t}\n\n\t/**\n\t * Returns true if a layer is supposed to be an overlay layer.\n\t */\n\tisOverlay(): boolean {\n\t\treturn this._overlay;\n\t}\n\n\tgetPixiApplicationOptions(): PixiApplicationOptions {\n\t\treturn this._pixi;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DControllerFocus, DFocusable, DFocusableContainer, DFocusableMightBe } from \"./d-controller-focus\";\n\nexport class DControllerDefaultFocus implements DControllerFocus {\n\tprivate _focused: DFocusable | null = null;\n\n\tfocus( focusable: DFocusable | null ): DFocusable | null {\n\t\tconst previous = this._focused;\n\t\tif( previous !== focusable ) {\n\t\t\tif( previous != null ) {\n\t\t\t\tprevious.state.isFocused = false;\n\t\t\t}\n\n\t\t\tthis._focused = focusable;\n\t\t\tif( this.isFocusable( focusable ) ) {\n\t\t\t\tfocusable.state.isFocused = true;\n\t\t\t}\n\t\t\treturn previous;\n\t\t}\n\t\treturn null;\n\t}\n\n\tblur( focusable: DFocusable | null ): DFocusable | null {\n\t\tif( focusable != null && this._focused === focusable ) {\n\t\t\tthis._focused = null;\n\t\t\tfocusable.state.isFocused = false;\n\t\t\treturn focusable;\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): DFocusable | null {\n\t\treturn this.focus( null );\n\t}\n\n\tset( focusable: DFocusable | null, isFocused: boolean ): DFocusable | null {\n\t\tif( isFocused ) {\n\t\t\treturn this.focus( focusable );\n\t\t} else {\n\t\t\treturn this.blur( focusable );\n\t\t}\n\t}\n\n\tget(): DFocusable | null {\n\t\treturn this._focused;\n\t}\n\n\tfindParent( mightBeFocusable: DFocusableMightBe | null ): DFocusable | null {\n\t\tlet current: DFocusableMightBe | DFocusableContainer | null = mightBeFocusable;\n\t\twhile( current != null ) {\n\t\t\tif( this.isFocusable( current ) ) {\n\t\t\t\treturn current;\n\t\t\t} else {\n\t\t\t\tcurrent = current.parent;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tfind(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean,\n\t\tdirection: boolean, root?: unknown\n\t): DFocusable | null {\n\t\tif( direction ) {\n\t\t\tconst result = this.findNext( target, includesTarget, includesTargetChildren );\n\t\t\tif( result != null ) {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tconst parent = target.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tconst children = parent.children;\n\t\t\t\tconst index = children.indexOf( target );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\tconst childrenLength = children.length;\n\t\t\t\t\tif( this.isFocusReverse( parent ) ) {\n\t\t\t\t\t\tfor( let i = index - 1; 0 <= i; --i ) {\n\t\t\t\t\t\t\tconst found = this.findNext( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( ! this.isFocusRoot( parent, root ) ) {\n\t\t\t\t\t\t\tconst found = this.find( parent, false, false, true, root );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor( let i = childrenLength - 1; index <= i; --i ) {\n\t\t\t\t\t\t\tconst found = this.findNext( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = index + 1; i < childrenLength; ++i ) {\n\t\t\t\t\t\t\tconst found = this.findNext( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( ! this.isFocusRoot( parent, root ) ) {\n\t\t\t\t\t\t\tconst found = this.find( parent, false, false, true, root );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor( let i = 0; i <= index; ++i ) {\n\t\t\t\t\t\t\tconst found = this.findNext( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst result = this.findPrevious( target, includesTarget, includesTargetChildren );\n\t\t\tif( result != null ) {\n\t\t\t\treturn result;\n\t\t\t}\n\n\t\t\tconst parent = target.parent;\n\t\t\tif( parent != null ) {\n\t\t\t\tconst children = parent.children;\n\t\t\t\tconst index = children.indexOf( target );\n\t\t\t\tif( 0 <= index ) {\n\t\t\t\t\tconst childrenLength = children.length;\n\t\t\t\t\tif( this.isFocusReverse( parent ) ) {\n\t\t\t\t\t\tfor( let i = index + 1; i < childrenLength; ++i ) {\n\t\t\t\t\t\t\tconst found = this.findPrevious( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( ! this.isFocusRoot( parent, root ) ) {\n\t\t\t\t\t\t\tconst found = this.find( parent, true, false, false, root );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor( let i = 0; i <= index; ++i ) {\n\t\t\t\t\t\t\tconst found = this.findPrevious( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfor( let i = index - 1; 0 <= i; --i ) {\n\t\t\t\t\t\t\tconst found = this.findPrevious( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif( ! this.isFocusRoot( parent, root ) ) {\n\t\t\t\t\t\t\tconst found = this.find( parent, true, false, false, root );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tfor( let i = childrenLength - 1; index <= i; --i ) {\n\t\t\t\t\t\t\tconst found = this.findPrevious( children[ i ], true, true );\n\t\t\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\t\t\treturn found;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected findNext(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean\n\t): DFocusable | null {\n\t\t// Target itself\n\t\tif( includesTarget ) {\n\t\t\tif( this.isFocusable( target ) ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\n\t\t// Target children\n\t\tif( includesTargetChildren && this.isFocusableContainer( target ) && target.visible ) {\n\t\t\tconst children = target.children;\n\t\t\tconst childrenLength = children.length;\n\t\t\tif( this.isFocusReverse( target ) ) {\n\t\t\t\tfor( let i = childrenLength - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst found = this.findNext( children[ i ], true, true );\n\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < childrenLength; ++i ) {\n\t\t\t\t\tconst found = this.findNext( children[ i ], true, true );\n\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Found nothing\n\t\treturn null;\n\t}\n\n\tprotected findPrevious(\n\t\ttarget: DFocusableMightBe, includesTarget: boolean, includesTargetChildren: boolean\n\t): DFocusable | null {\n\t\t// Target children\n\t\tif( includesTargetChildren && this.isFocusableContainer( target ) && target.visible ) {\n\t\t\tconst children = target.children;\n\t\t\tconst childrenLength = children.length;\n\t\t\tif( this.isFocusReverse( target ) ) {\n\t\t\t\tfor( let i = 0; i < childrenLength; ++i ) {\n\t\t\t\t\tconst found = this.findPrevious( children[ i ], true, true );\n\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = childrenLength - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst found = this.findPrevious( children[ i ], true, true );\n\t\t\t\t\tif( found != null ) {\n\t\t\t\t\t\treturn found;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Target itself\n\t\tif( includesTarget ) {\n\t\t\tif( this.isFocusable( target ) ) {\n\t\t\t\treturn target;\n\t\t\t}\n\t\t}\n\n\t\t// Found nothing\n\t\treturn null;\n\t}\n\n\tprotected isFocusable( target: any ): target is DFocusable {\n\t\treturn (\n\t\t\ttarget != null &&\n\t\t\t(\"state\" in target) &&\n\t\t\ttarget.state.inEnabled &&\n\t\t\ttarget.state.isFocusable &&\n\t\t\ttarget.visible\n\t\t);\n\t}\n\n\tprotected isFocusableContainer( target: any ): target is DFocusableContainer {\n\t\treturn (\n\t\t\ttarget != null &&\n\t\t\t(\"children\" in target)\n\t\t);\n\t}\n\n\tprotected isFocusRoot( target: any, root: unknown ): target is DFocusable {\n\t\tif( target === root ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn (\n\t\t\ttarget != null &&\n\t\t\t(\"state\" in target) &&\n\t\t\ttarget.state.isFocusRoot &&\n\t\t\ttarget.visible\n\t\t);\n\t}\n\n\tprotected isFocusReverse( target: any ): boolean {\n\t\treturn (\n\t\t\ttarget != null &&\n\t\t\t(\"state\" in target) &&\n\t\t\ttarget.state.isFocusReverse\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandClear implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DListItem } from \"./d-list-item\";\nimport { toEnum } from \"./util/to-enum\";\n\nexport enum DListSelectionMode {\n\tNONE,\n\tSINGLE,\n\tMULTIPLE\n}\n\n/**\n * {@link DListSelection} events.\n */\nexport interface DListSelectionEvents<EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param emitter an emitter\n\t */\n\tchange( emitter: EMITTER ): void;\n}\n\n/**\n * {@link DListSelection} \"on\" options.\n */\nexport interface DListSelectionOnOptions<EMITTER> extends Partial<DListSelectionEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DListSelection} options.\n */\nexport interface DListSelectionOptions<VALUE, EMITTER = any> {\n\tmode?: DListSelectionMode | (keyof typeof DListSelectionMode);\n\n\t/**\n\t * Mappings of event names and handlers.\n\t */\n\ton?: DListSelectionOnOptions<EMITTER>;\n}\n\nexport class DListSelection<VALUE = unknown> extends utils.EventEmitter {\n\tprotected _content: Container;\n\tprotected _isDirty: boolean;\n\tprotected _indices: number[];\n\tprotected _mode: DListSelectionMode;\n\n\tconstructor( content: Container, options?: DListSelectionOptions<VALUE> ) {\n\t\tsuper();\n\n\t\tthis._content = content;\n\t\tthis._isDirty = false;\n\t\tthis._indices = [];\n\t\tthis._mode = toEnum( options?.mode ?? DListSelectionMode.SINGLE, DListSelectionMode );\n\n\t\t// Events\n\t\tconst on = options?.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tconst handler = on[ name ];\n\t\t\t\tif( handler ) {\n\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tthis._isDirty = true;\n\t}\n\n\tupdate(): void {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tconst indices = this._indices;\n\t\t\tindices.length = 0;\n\t\t\tconst children = this._content.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tif( child.state.isActive ) {\n\t\t\t\t\t\tindices.push( i );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsize(): number {\n\t\tthis.update();\n\t\treturn this._indices.length;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this.size() <= 0;\n\t}\n\n\tfirst(): DListItem<VALUE> | null {\n\t\treturn this.get( 0 );\n\t}\n\n\tget( index: number ): DListItem<VALUE> | null {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 <= index && index < indices.length ) {\n\t\t\tconst child = this._content.children[ indices[ index ] ];\n\t\t\tif( child != null ) {\n\t\t\t\treturn child as any;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tgetIndex( index: number ): number | null {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 <= index && index < indices.length ) {\n\t\t\treturn indices[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): void {\n\t\tthis.update();\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.length ) {\n\t\t\tconst children = this._content.children;\n\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ indices[ i ] ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.state.isActive = false;\n\t\t\t\t}\n\t\t\t}\n\t\t\tindices.length = 0;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tadd( target: DListItem<VALUE> ): void {\n\t\tconst mode = this._mode;\n\t\tconst content = this._content;\n\t\tif( mode === DListSelectionMode.SINGLE ) {\n\t\t\tif( ! target.state.isActive ) {\n\t\t\t\tthis.update();\n\n\t\t\t\t// Remove the existing\n\t\t\t\tconst indices = this._indices;\n\t\t\t\tconst children = content.children as Array<DListItem<VALUE>>;\n\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\tconst child = children[ indices[ i ] ];\n\t\t\t\t\tchild.state.isActive = false;\n\t\t\t\t}\n\t\t\t\tindices.length = 0;\n\n\t\t\t\t// Add a new child\n\t\t\t\tindices.push( content.getChildIndex( target ) );\n\t\t\t\ttarget.state.isActive = true;\n\n\t\t\t\t// Event\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t} else if( mode === DListSelectionMode.MULTIPLE ) {\n\t\t\tif( ! target.state.isActive ) {\n\t\t\t\tif( this._isDirty ) {\n\t\t\t\t\ttarget.state.isActive = true;\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t} else {\n\t\t\t\t\t// Find an insertion position\n\t\t\t\t\tconst indices = this._indices;\n\t\t\t\t\tconst targetIndex = content.getChildIndex( target );\n\t\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst index = indices[ i ];\n\t\t\t\t\t\tif( targetIndex === index ) {\n\t\t\t\t\t\t\ttarget.state.isActive = true;\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t} else if( targetIndex < index ) {\n\t\t\t\t\t\t\tindices.splice( i, 0, targetIndex );\n\t\t\t\t\t\t\ttarget.state.isActive = true;\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Push\n\t\t\t\t\tindices.push( targetIndex );\n\t\t\t\t\ttarget.state.isActive = true;\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tremove( target: DListItem<VALUE> ): void {\n\t\tif( ! target.state.isActive ) {\n\t\t\tif( this._isDirty ) {\n\t\t\t\ttarget.state.isActive = false;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t} else {\n\t\t\t\tconst indices = this._indices;\n\t\t\t\tconst content = this._content;\n\t\t\t\tconst targetIndex = content.getChildIndex( target );\n\t\t\t\tfor( let i = 0, imax = indices.length; i < imax; ++i ) {\n\t\t\t\t\tconst index = indices[ i ];\n\t\t\t\t\tif( targetIndex === index ) {\n\t\t\t\t\t\tindices.splice( i, 1 );\n\t\t\t\t\t\ttarget.state.isActive = false;\n\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandRedo implements DCommand {\n\texecute(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tredo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tundo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport class DCommandUndo implements DCommand {\n\texecute(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tredo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tundo(): Promise<void> | boolean {\n\t\tthrow new Error( \"Not supported\" );\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DCommand } from \"./d-command\";\nimport { DCommandClear } from \"./d-command-clear\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DCommandRedo } from \"./d-command-redo\";\nimport { DCommandUndo } from \"./d-command-undo\";\nimport { DControllerCommand } from \"./d-controller-command\";\n\nconst isCommandStorable = ( command: DCommand ): boolean => {\n\treturn ( command.getFlag() & DCommandFlag.UNSTORABLE ) === 0;\n};\n\nconst isCommandClear = ( command: DCommand ): boolean => {\n\treturn ( command.getFlag() & DCommandFlag.CLEAR ) !== 0;\n};\n\nexport class DControllerDefaultCommand extends utils.EventEmitter implements DControllerCommand {\n\tprotected _position: number;\n\tprotected _done: DCommand[];\n\tprotected _waiting: DCommand[];\n\tprotected _executing: Promise<void> | null;\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._position = 0;\n\t\tthis._done = [];\n\t\tthis._waiting = [];\n\t\tthis._executing = null;\n\t}\n\n\tlast(): DCommand | null {\n\t\tconst done = this._done;\n\t\tconst waiting = this._waiting;\n\n\t\tif( waiting.length <= 0 ) {\n\t\t\tif( 0 < done.length ) {\n\t\t\t\treturn done[ done.length - 1 ];\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t} else {\n\t\t\treturn waiting[ waiting.length - 1 ];\n\t\t}\n\t}\n\n\tpush( command: DCommand ): void {\n\t\tconst waiting = this._waiting;\n\t\twaiting.push( command );\n\t\tthis.next();\n\t}\n\n\tnext() {\n\t\tif( this._executing == null ) {\n\t\t\tconst waiting = this._waiting;\n\t\t\tif( 0 < waiting.length ) {\n\t\t\t\tconst command = waiting.shift();\n\t\t\t\tif( command != null ) {\n\t\t\t\t\tif( command instanceof DCommandUndo ) {\n\t\t\t\t\t\tconst done = this._done;\n\t\t\t\t\t\tif( this._position < done.length ) {\n\t\t\t\t\t\t\tconst current = done[ done.length - 1 - this._position ];\n\t\t\t\t\t\t\tthis._position += 1;\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\tconst result = current.undo();\n\t\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if( command instanceof DCommandRedo ) {\n\t\t\t\t\t\tconst done = this._done;\n\t\t\t\t\t\tif( 0 < this._position ) {\n\t\t\t\t\t\t\tconst current = done[ done.length - this._position ];\n\t\t\t\t\t\t\tthis._position -= 1;\n\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\tconst result = current.redo();\n\t\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst isClear = isCommandClear( command );\n\t\t\t\t\t\tconst isStorable = isCommandStorable( command );\n\t\t\t\t\t\tif( isClear || isStorable ) {\n\t\t\t\t\t\t\tconst size = ( isClear ? this._done.length : this._position );\n\t\t\t\t\t\t\tif( 0 < size ) {\n\t\t\t\t\t\t\t\tthis.remove( size );\n\t\t\t\t\t\t\t\tthis._position = 0;\n\t\t\t\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tthis.cleanup();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst result = command.execute();\n\t\t\t\t\t\tif( result === true ) {\n\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t} else if( result === false ) {\n\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._executing = result.then(() => {\n\t\t\t\t\t\t\t\tthis.onSuccess( command );\n\t\t\t\t\t\t\t}, () => {\n\t\t\t\t\t\t\t\tthis.onFail( command );\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup(): void {\n\t\tconst done = this._done;\n\t\tconst size = done.length - 100;\n\t\tif( 0 < size ) {\n\t\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\t\tdone[ i ].destroy();\n\t\t\t\tdone.shift();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected remove( size: number ): boolean {\n\t\tconst done = this._done;\n\t\tif( 0 < size ) {\n\t\t\tconst ifrom = Math.max( 0, done.length - size );\n\t\t\tsize = done.length - ifrom;\n\t\t\tif( 0 < size ) {\n\t\t\t\tfor( let i = ifrom, imax = done.length; i < imax; ++i ) {\n\t\t\t\t\tdone[ i ].destroy();\n\t\t\t\t}\n\n\t\t\t\tdone.splice( ifrom, done.length - ifrom );\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onSuccess( command: DCommand ) {\n\t\tthis._executing = null;\n\t\tif( isCommandStorable( command ) ) {\n\t\t\tthis._done.push( command );\n\t\t\tthis.emit( \"dirty\", this );\n\t\t} else if( command instanceof DCommandUndo || command instanceof DCommandRedo ) {\n\t\t\tthis.emit( \"dirty\", this );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tthis.next();\n\t}\n\n\tprotected onFail( command: DCommand ) {\n\t\tthis._executing = null;\n\t\tconst waiting = this._waiting;\n\t\tcommand.destroy();\n\t\tfor( let i = 0, imax = waiting.length; i < imax; ++i ) {\n\t\t\twaiting[ i ].destroy();\n\t\t}\n\t\twaiting.length = 0;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tsize(): number {\n\t\treturn this._done.length;\n\t}\n\n\tclear(): void {\n\t\tthis.push( new DCommandClear() );\n\t}\n\n\tredo(): void {\n\t\tif( this.isRedoable() ) {\n\t\t\tthis._waiting.push( new DCommandRedo() );\n\t\t\tthis.next();\n\t\t}\n\t}\n\n\tundo(): void {\n\t\tif( this.isUndoable() ) {\n\t\t\tthis._waiting.push( new DCommandUndo() );\n\t\t\tthis.next();\n\t\t}\n\t}\n\n\tisRedoable(): boolean {\n\t\treturn ( 0 < this._position && this._executing == null );\n\t}\n\n\tisUndoable(): boolean {\n\t\treturn ( this._position < this._done.length && this._executing == null );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DControllerFocus, DFocusable, DFocusableContainer } from \"./d-controller-focus\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport class DControllerKeyboard extends utils.EventEmitter {\n\tinit( element: HTMLElement, stage: Container, focusController: DControllerFocus ) {\n\t\telement.addEventListener( \"keydown\", ( e: KeyboardEvent ): void => {\n\t\t\tthis.emit( \"keydown\", e );\n\n\t\t\tconst focused = focusController.get();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( this.hasOnKeyDown( current ) ) {\n\t\t\t\t\t\tif( current.onKeyDown( e ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( UtilKeyboardEvent.isFocusKey( e ) ) {\n\t\t\t\tconst direction = UtilKeyboardEvent.getFocusDirection( e );\n\t\t\t\tconst next = ( focused != null ?\n\t\t\t\t\tfocusController.find(\n\t\t\t\t\t\tfocused, false, focused.state.isFocusRoot || direction, direction\n\t\t\t\t\t) :\n\t\t\t\t\tfocusController.find( stage, false, true, direction )\n\t\t\t\t);\n\t\t\t\tif( next != null ) {\n\t\t\t\t\tfocusController.focus( next );\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\te.stopImmediatePropagation();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\telement.addEventListener( \"keyup\", ( e: KeyboardEvent ): void => {\n\t\t\tthis.emit( \"keyup\", e );\n\n\t\t\tconst focused = focusController.get();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( this.hasOnKeyUp( current ) ) {\n\t\t\t\t\t\tif( current.onKeyUp( e ) ) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected hasOnKeyDown( target: any ): target is { onKeyDown( e: KeyboardEvent ): boolean; } {\n\t\treturn \"onKeyDown\" in target;\n\t}\n\n\tprotected hasOnKeyUp( target: any ): target is { onKeyUp( e: KeyboardEvent ): boolean; } {\n\t\treturn \"onKeyUp\" in target;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DControllerCommand } from \"./d-controller-command\";\nimport { DControllerDefaultCommand } from \"./d-controller-default-command\";\nimport { DControllerDocument } from \"./d-controller-document\";\nimport { DControllerKeyboard } from \"./d-controller-keyboard\";\nimport { DDocument } from \"./d-document\";\n\nexport class DControllers {\n\tprotected static KEYBOARD: DControllerKeyboard | null;\n\tprotected static COMMAND: DControllerCommand | null;\n\tprotected static DOCUMENT: DControllerDocument<any> | null;\n\n\t// Keyboard\n\tstatic getKeyboardController(): DControllerKeyboard {\n\t\tif( this.KEYBOARD == null ) {\n\t\t\tthis.KEYBOARD = new DControllerKeyboard();\n\t\t}\n\t\treturn this.KEYBOARD;\n\t}\n\n\tstatic setKeyboardController( instance: DControllerKeyboard ): DControllerKeyboard | null {\n\t\tconst result = this.KEYBOARD;\n\t\tthis.KEYBOARD = instance;\n\t\treturn result;\n\t}\n\n\t// Command\n\tstatic getCommandController(): DControllerCommand {\n\t\tif( this.COMMAND == null ) {\n\t\t\tthis.COMMAND = new DControllerDefaultCommand();\n\t\t}\n\t\treturn this.COMMAND;\n\t}\n\n\tstatic setCommandController( instance: DControllerCommand ): DControllerCommand | null {\n\t\tconst result = this.COMMAND;\n\t\tthis.COMMAND = instance;\n\t\treturn result;\n\t}\n\n\t// Document\n\tstatic getDocumentController<DOCUMENT extends DDocument>(): DControllerDocument<DOCUMENT> {\n\t\tif( this.DOCUMENT == null ) {\n\t\t\tthrow new Error( \"Not supported\" );\n\t\t}\n\t\treturn this.DOCUMENT;\n\t}\n\n\tstatic setDocumentController<DOCUMENT extends DDocument>(\n\t\tinstance: DControllerDocument<DOCUMENT>\n\t): DControllerDocument<DOCUMENT> | null {\n\t\tconst result = this.DOCUMENT;\n\t\tthis.DOCUMENT = instance;\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Application, Container, interaction, Point } from \"pixi.js\";\nimport { DApplicationLayerLike } from \"./d-application-layer-like\";\nimport { DApplicationLayerOptions } from \"./d-application-layer-options\";\nimport { DApplicationLike } from \"./d-application-like\";\nimport { DBase } from \"./d-base\";\nimport { DControllerDefaultFocus } from \"./d-controller-default-focus\";\nimport { DControllerFocus, DFocusable, DFocusableContainer } from \"./d-controller-focus\";\nimport { DControllers } from \"./d-controllers\";\nimport { DPadding } from \"./d-padding\";\nimport { DynamicFontAtlases } from \"./util/dynamic-font-atlases\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilWheelEvent, UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\ninterface DblClickable {\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean;\n}\n\nconst isDblClickable = ( target: any ): target is DblClickable => {\n\treturn target != null && target.onDblClick != null;\n};\n\ninterface Wheelable {\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean;\n}\n\nconst isWheelable = ( target: any ): target is Wheelable => {\n\treturn target != null && target.onWheel != null;\n};\n\nexport class DApplicationLayer extends Application implements DApplicationLayerLike {\n\tprotected _options: DApplicationLayerOptions;\n\tprotected _renderId: number | null = null;\n\tprotected _renderBound: () => void;\n\tprotected _isLocked: boolean;\n\tprotected _isOverlay: boolean;\n\tprotected _refitLimit: number;\n\tprotected _reflowLimit: number;\n\tprotected _focus?: DControllerFocus;\n\tprotected _rootElement: HTMLElement;\n\tprotected _elementContainer: HTMLElement;\n\tprotected _padding: DPadding;\n\tprotected _dynamicFontAtlases: DynamicFontAtlases | null = null;\n\tprotected _isVisible: boolean;\n\n\treadonly application: DApplicationLike;\n\n\tconstructor( application: DApplicationLike, options: DApplicationLayerOptions ) {\n\t\tsuper( options.getPixiApplicationOptions() );\n\n\t\tthis.application = application;\n\t\tconst stage = this.stage;\n\t\t(stage as any).layer = this;\n\t\t(stage as any).application = application;\n\t\tstage.interactive = true;\n\n\t\tthis._options = options;\n\t\tthis._isLocked = true;\n\t\tthis._isVisible = true;\n\t\tconst isOverlay = options.isOverlay();\n\t\tthis._isOverlay = isOverlay;\n\t\tthis._padding = options.getPadding();\n\t\tconst rootElement = options.getRootElement();\n\t\tthis._rootElement = rootElement;\n\t\tthis._refitLimit = 5;\n\t\tthis._reflowLimit = 5;\n\n\t\tthis._renderBound = (): void => {\n\t\t\tif( this._renderId != null ) {\n\t\t\t\tthis.render();\n\t\t\t}\n\t\t};\n\n\t\t// Init element container\n\t\tconst elementContainer = this.newElementContainer();\n\t\tthis._elementContainer = elementContainer;\n\n\t\t// Init canvas\n\t\tconst view = this.view;\n\t\tconst viewStyle = view.style;\n\t\tviewStyle.position = \"absolute\";\n\t\tviewStyle.top = \"0\";\n\t\tviewStyle.left = \"0\";\n\t\tviewStyle.width = \"100%\";\n\t\tviewStyle.height = \"100%\";\n\t\tviewStyle.display = \"block\";\n\t\tviewStyle.outline = \"none\";\n\n\t\t// Init root element\n\t\tthis.initRootElement( rootElement, view, elementContainer, stage, isOverlay );\n\n\t\t// Focus handling\n\t\tlet hasFocus = false;\n\t\tconst focusController = this.getFocusController();\n\t\tconst onBlurBound = (): void => {\n\t\t\tif( ! hasFocus ) {\n\t\t\t\tfocusController.clear();\n\t\t\t}\n\t\t};\n\t\trootElement.addEventListener( \"focus\", ( e ): void => {\n\t\t\thasFocus = true;\n\t\t}, true );\n\t\trootElement.addEventListener( \"blur\", ( e ): void => {\n\t\t\thasFocus = false;\n\t\t\tsetTimeout( onBlurBound, 0 );\n\t\t}, true );\n\t\tview.setAttribute( \"tabindex\", \"0\" );\n\n\t\tDControllers.getKeyboardController().init( view, stage, focusController );\n\n\t\tconst interactionManager: interaction.InteractionManager = this.renderer.plugins.interaction;\n\t\tinteractionManager.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( e.target == null || e.target === stage ) {\n\t\t\t\tfocusController.clear();\n\t\t\t}\n\t\t});\n\n\t\t// Resize handling\n\t\tconst onResizeBound = (): void => {\n\t\t\tthis.onResize();\n\t\t};\n\t\twindow.addEventListener( \"resize\", onResizeBound );\n\t\twindow.addEventListener( \"orientationchange\", onResizeBound );\n\n\t\t// Mouse wheel handling\n\t\tconst wheelGlobal = new Point();\n\t\tconst wheelEventUtil = UtilWheelEvent.getInstance();\n\t\twheelEventUtil.on( view, ( e: WheelEvent | Event ): void => {\n\t\t\tconst wheelEvent = e as WheelEvent;\n\t\t\tUtilPointerEvent.toGlobal( wheelEvent, interactionManager, wheelGlobal );\n\t\t\tlet current = interactionManager.hitTest( wheelGlobal );\n\t\t\tconst deltas = wheelEventUtil.normalize( e );\n\t\t\tif( deltas != null ) {\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( isWheelable( current ) ) {\n\t\t\t\t\t\tif( current.onWheel( wheelEvent, deltas, wheelGlobal ) ) {\n\t\t\t\t\t\t\twheelEvent.preventDefault();\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Double click handling\n\t\tUtilPointerEvent.onDblClick( view, ( e: MouseEvent | TouchEvent ) => {\n\t\t\tconst focused = focusController.get();\n\t\t\tif( focused != null ) {\n\t\t\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\t\t\twhile( current != null ) {\n\t\t\t\t\tif( isDblClickable( current ) ) {\n\t\t\t\t\t\tif( current.onDblClick( e, interactionManager ) ) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcurrent = current.parent;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected newElementContainer(): HTMLElement {\n\t\tconst result = document.createElement( \"div\" );\n\t\tresult.setAttribute( \"style\",\n\t\t\t\"position: absolute; top: 0; left: 0; width: 0; height: 0;\" +\n\t\t\t\"margin: 0; padding: 0; outline: none;\"\n\t\t);\n\t\treturn result;\n\t}\n\n\tprotected initRootElement(\n\t\trootElement: HTMLElement, view: HTMLCanvasElement, elementContainer: HTMLElement,\n\t\tstage: Container, isOverlay: boolean\n\t): void {\n\t\t// Insert elements\n\t\tconst insertionPosition = ( isOverlay ? 2 : 0 );\n\t\tconst children = rootElement.children;\n\t\tif( insertionPosition < children.length ) {\n\t\t\tconst child = children[ insertionPosition ];\n\t\t\trootElement.insertBefore( view, child );\n\t\t\trootElement.insertBefore( elementContainer, child );\n\t\t} else {\n\t\t\trootElement.appendChild( view );\n\t\t\trootElement.appendChild( elementContainer );\n\t\t}\n\n\t\tif( isOverlay ) {\n\t\t\tconst oldOnChildrenChange = (stage as any).onChildrenChange;\n\t\t\t(stage as any).onChildrenChange = (): void => {\n\t\t\t\tthis.onStageDirty();\n\t\t\t\toldOnChildrenChange.call( stage );\n\t\t\t};\n\t\t}\n\n\t\t// Init styles\n\t\tconst rootElementStyle = rootElement.style;\n\t\tif( rootElement !== document.body ) {\n\t\t\tconst rootElementStylePosition = window.getComputedStyle( rootElement ).position;\n\t\t\tif( rootElementStylePosition === \"static\" ) {\n\t\t\t\trootElementStyle.position = \"relative\";\n\t\t\t}\n\t\t}\n\t\trootElementStyle.margin = \"0\";\n\t\trootElementStyle.padding = \"0\";\n\t\trootElementStyle.overflow = \"hidden\";\n\t}\n\n\tprotected onResize(): void {\n\t\tconst bbox = this._rootElement.getBoundingClientRect();\n\t\tconst bboxWidth = bbox.width;\n\t\tconst bboxHeight = bbox.height;\n\t\tthis.renderer.resize( bboxWidth, bboxHeight );\n\n\t\tconst padding = this._padding;\n\t\tconst children = this.stage.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DBase ) {\n\t\t\t\tchild.onParentResize( bboxWidth, bboxHeight, padding );\n\t\t\t}\n\t\t}\n\n\t\tthis.update();\n\t}\n\n\tlock(): void {\n\t\tthis._isLocked = false;\n\t}\n\n\tunlock(): void {\n\t\tthis._isLocked = true;\n\t}\n\n\tupdate(): void {\n\t\tif( this._isLocked && this._renderId == null ) {\n\t\t\tthis._renderId = requestAnimationFrame( this._renderBound );\n\t\t}\n\t}\n\n\tprotected onStageDirty(): void {\n\t\t// Update the visibility if this is a overlay layer.\n\t\tif( this._isOverlay ) {\n\t\t\tif( 0 < this.stage.children.length ) {\n\t\t\t\t// There are more than one children,\n\t\t\t\t// therefore must be visible.\n\t\t\t\tif( ! this._isVisible ) {\n\t\t\t\t\tthis._isVisible = true;\n\t\t\t\t\tthis.view.style.display = \"block\";\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// There is no child,\n\t\t\t\t// therefore must not be visible.\n\t\t\t\tif( this._isVisible ) {\n\t\t\t\t\tthis._isVisible = false;\n\t\t\t\t\tthis.view.style.display = \"none\";\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\trender(): void {\n\t\tthis.refit();\n\t\tthis.reflow();\n\n\t\t// Please note why the following line is here.\n\t\t//\n\t\t// Before this line, the update method does not enque a rendering task\n\t\t// because `this._renderId` is not null. As a result, this prevents\n\t\t// an unintentional rendering loop caused by the refit or the reflow.\n\t\t//\n\t\t// After this line, the update method enques a rendering task.\n\t\t// Namely, in the DisplayObject#render(Renderer) method, allowed to enque\n\t\t// a rendering task. For instance, please refer to the DDiagramShape#update().\n\t\tthis._renderId = null;\n\n\t\t// Render\n\t\tsuper.render();\n\t}\n\n\tget width(): number {\n\t\treturn this.screen.width;\n\t}\n\n\tget height(): number {\n\t\treturn this.screen.height;\n\t}\n\n\tget padding(): DPadding {\n\t\treturn this._padding;\n\t}\n\n\trefit(): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let ilimit = 0, limit = this._refitLimit; ilimit < limit; ++ilimit ) {\n\t\t\tlet isChildrenDirty = false;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.refit();\n\t\t\t\t\tisChildrenDirty = isChildrenDirty || child.isChildrenDirty();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If DBases are changed during the `refit` process, need to refit again.\n\t\t\tif( ! isChildrenDirty ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\treflow(): void {\n\t\tconst children = this.stage.children;\n\t\tfor( let ilimit = 0, limit = this._refitLimit; ilimit < limit; ++ilimit ) {\n\t\t\tlet isDirty = false;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.reflow();\n\t\t\t\t\tisDirty = isDirty || child.isDirty() || child.hasDirty();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// If DBases are changed during the `reflow` process, need to reflow again.\n\t\t\tif( ! isDirty ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tgetFocusController(): DControllerFocus {\n\t\tif( this._focus == null ) {\n\t\t\tthis._focus = new DControllerDefaultFocus();\n\t\t}\n\t\treturn this._focus;\n\t}\n\n\tgetRootElement(): HTMLElement {\n\t\treturn this._rootElement;\n\t}\n\n\tgetElementContainer(): HTMLElement {\n\t\treturn this._elementContainer;\n\t}\n\n\tgetDynamicFontAtlases(): DynamicFontAtlases {\n\t\tif( this._dynamicFontAtlases == null ) {\n\t\t\tthis._dynamicFontAtlases = new DynamicFontAtlases( this );\n\t\t}\n\t\treturn this._dynamicFontAtlases;\n\t}\n}\n","import { Container, Renderer } from \"pixi.js\";\nimport { DApplicationLayer } from \"./d-application-layer\";\nimport { DApplicationLayerOptions } from \"./d-application-layer-options\";\nimport { DApplicationLike } from \"./d-application-like\";\nimport { DApplications } from \"./d-applications\";\nimport { DPaddingLike } from \"./d-padding\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DApplicationBackgroundOptions {\n\tcolor?: number;\n}\n\nexport interface DApplicationOptions {\n\t/**\n\t * A root element selector or a root element.\n\t * `HTMLCanvasElement` and other DOM elements are created in this element.\n\t * The default root element is `document.body`.\n\t */\n\troot?: string | HTMLElement;\n\n\t/**\n\t * Padding settings.\n\t */\n\tpadding?: number | DPaddingLike;\n\n\t/**\n\t * A canvas width.\n\t */\n\twidth?: number;\n\n\t/**\n\t * A canvas height.\n\t */\n\theight?: number;\n\n\t/**\n\t * A background setting.\n\t */\n\tbackground?: DApplicationBackgroundOptions;\n\n\t/**\n\t * An antialias setting.\n\t */\n\tantialias?: boolean;\n\n\t/**\n\t * A resolution.\n\t * The default value is `devicePixelRatio`.\n\t */\n\tresolution?: number;\n\n\t/**\n\t * An overlay layer setting.\n\t * The overlay layer is used by modal UI elements including DDialog\n\t * to provide the better interoperability with DOM-based UI elements\n\t * and WebGL-based UI elements.\n\t * However, an extra layer requires extra memory.\n\t * Set to true to enable the overlay layer.\n\t * The default value is false.\n\t */\n\toverlay?: boolean;\n}\n\nexport class DApplication implements DApplicationLike {\n\tprotected _options?: DApplicationOptions;\n\tprotected _root: HTMLElement;\n\tprotected _base: DApplicationLayer;\n\tprotected _overlay?: DApplicationLayer;\n\tprotected _resolution: number;\n\tprotected _isOverlayEnabled: boolean;\n\n\tconstructor( options?: DApplicationOptions ) {\n\t\tDApplications.add( this );\n\n\t\t// Root\n\t\tthis._root = this.toRootElement( options );\n\n\t\t// Resolution\n\t\tconst resolution = ( options && options.resolution != null ?\n\t\t\toptions.resolution : (window.devicePixelRatio || 1)\n\t\t);\n\t\tthis._resolution = resolution;\n\n\t\t// Remove the accessibility plugin\n\t\tdelete (Renderer as any).__plugins.accessibility;\n\n\t\t// Options\n\t\tthis._options = options;\n\n\t\t// Base layer\n\t\tconst base = this._base = this.newLayerBase( options );\n\n\t\t// Overlay layer\n\t\tthis._isOverlayEnabled = !! ( options && options.overlay );\n\t\tif( ! this._isOverlayEnabled ) {\n\t\t\tthis._overlay = base;\n\t\t}\n\t}\n\n\tget stage(): Container {\n\t\treturn this._base.stage;\n\t}\n\n\tgetRootElement(): HTMLElement {\n\t\treturn this._root;\n\t}\n\n\tgetResolution(): number {\n\t\treturn this._resolution;\n\t}\n\n\tprotected toRootElement( options?: DApplicationOptions ): HTMLElement {\n\t\tconst root = options && options.root;\n\t\tif( root != null ) {\n\t\t\tif( isString( root ) ) {\n\t\t\t\tconst found = document.querySelector<HTMLElement>( root );\n\t\t\t\tif( found ) {\n\t\t\t\t\treturn found;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn root;\n\t\t\t}\n\t\t}\n\t\treturn document.body;\n\t}\n\n\tprotected toLayerBaseOptions( options?: DApplicationOptions ): DApplicationLayerOptions {\n\t\tconst root = this._root;\n\t\tconst resolution = this._resolution;\n\t\tif( options ) {\n\t\t\treturn new DApplicationLayerOptions({\n\t\t\t\troot,\n\t\t\t\tpadding: options.padding,\n\t\t\t\twidth: options.width,\n\t\t\t\theight: options.height,\n\t\t\t\tbackground: options.background,\n\t\t\t\tresolution,\n\t\t\t\tantialias: options.antialias,\n\t\t\t\toverlay: false\n\t\t\t});\n\t\t}\n\t\treturn new DApplicationLayerOptions({\n\t\t\troot,\n\t\t\tresolution,\n\t\t\toverlay: false\n\t\t});\n\t}\n\n\tprotected newLayerBase( options?: DApplicationOptions ): DApplicationLayer {\n\t\treturn new DApplicationLayer( this, this.toLayerBaseOptions( options ) );\n\t}\n\n\tgetLayerBase(): DApplicationLayer {\n\t\treturn  this._base;\n\t}\n\n\tprotected toLayerOverlayOptions( options?: DApplicationOptions ): DApplicationLayerOptions {\n\t\tconst root = this._root;\n\t\tconst resolution = this._resolution;\n\t\tif( options ) {\n\t\t\treturn new DApplicationLayerOptions({\n\t\t\t\troot,\n\t\t\t\tpadding: options.padding,\n\t\t\t\twidth: options.width,\n\t\t\t\theight: options.height,\n\t\t\t\tbackground: {\n\t\t\t\t\tcolor: null\n\t\t\t\t},\n\t\t\t\tresolution,\n\t\t\t\tantialias: options.antialias,\n\t\t\t\toverlay: true\n\t\t\t});\n\t\t}\n\t\treturn new DApplicationLayerOptions({\n\t\t\troot,\n\t\t\tresolution,\n\t\t\toverlay: true\n\t\t});\n\t}\n\n\tprotected newLayerOverlay( options?: DApplicationOptions ): DApplicationLayer {\n\t\treturn new DApplicationLayer( this, this.toLayerOverlayOptions( options ) );\n\t}\n\n\tgetLayerOverlay(): DApplicationLayer {\n\t\tif( this._isOverlayEnabled ) {\n\t\t\tif( this._overlay == null ) {\n\t\t\t\tthis._overlay = this.newLayerOverlay( this._options );\n\t\t\t}\n\t\t\treturn this._overlay;\n\t\t} else {\n\t\t\treturn this._base;\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tif( this._isOverlayEnabled ) {\n\t\t\tconst base = this._base;\n\t\t\tbase.update();\n\n\t\t\tconst overlay = this._overlay;\n\t\t\tif( overlay ) {\n\t\t\t\toverlay.update();\n\t\t\t}\n\t\t} else {\n\t\t\treturn this._base.update();\n\t\t}\n\t}\n\n\trender(): void {\n\t\tif( this._isOverlayEnabled ) {\n\t\t\tconst base = this._base;\n\t\t\tbase.render();\n\n\t\t\tconst overlay = this._overlay;\n\t\t\tif( overlay ) {\n\t\t\t\toverlay.render();\n\t\t\t}\n\t\t} else {\n\t\t\treturn this._base.render();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DBoardOptions<THEME extends DThemeBoard = DThemeBoard> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeBoard extends DThemeBase {\n\n}\n\nexport class DBoard<\n\tTHEME extends DThemeBoard = DThemeBoard,\n\tOPTIONS extends DBoardOptions<THEME> = DBoardOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DBoard\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonCheckOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck<VALUE> = DThemeButtonCheck<VALUE>\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonCheck<VALUE = unknown> extends DThemeButtonBase<VALUE> {\n\n}\n\nexport class DButtonCheck<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck<VALUE> = DThemeButtonCheck<VALUE>,\n\tOPTIONS extends DButtonCheckOptions<VALUE, THEME> = DButtonCheckOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonCheck, DButtonCheckOptions, DThemeButtonCheck } from \"./d-button-check\";\n\nexport interface DButtonCheckRightOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheckRight<VALUE> = DThemeButtonCheckRight<VALUE>\n> extends DButtonCheckOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonCheckRight<VALUE = unknown> extends DThemeButtonCheck<VALUE> {\n\n}\n\nexport class DButtonCheckRight<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonCheck<VALUE> = DThemeButtonCheck<VALUE>,\n\tOPTIONS extends DButtonCheckOptions<VALUE, THEME> = DButtonCheckOptions<VALUE, THEME>\n> extends DButtonCheck<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonCheckRight\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorGradientPoint } from \"./d-color-gradient\";\n\ntype Callback = ( target: DColorGradientPointObservable ) => void;\n\nexport class DColorGradientPointObservable implements DColorGradientPoint {\n\tprotected _color: number;\n\tprotected _alpha: number;\n\tprotected _position: number;\n\tprotected _callback: Callback;\n\tprotected _selected: boolean;\n\n\tconstructor( color: number, alpha: number, position: number, selected: boolean, callback: Callback ) {\n\t\tthis._color = color;\n\t\tthis._alpha = alpha;\n\t\tthis._position = position;\n\t\tthis._callback = callback;\n\t\tthis._selected = selected;\n\t}\n\n\tset( color: number, alpha: number, position: number, selected: boolean ) {\n\t\tif( this._color !== color || this._alpha !== alpha || this._position !== position || this._selected !== selected ) {\n\t\t\tthis._color = color;\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._position = position;\n\t\t\tthis._selected = selected;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget color() {\n\t\treturn this._color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._color !== color ) {\n\t\t\tthis._color = color;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget alpha() {\n\t\treturn this._alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._alpha !== alpha ) {\n\t\t\tthis._alpha = alpha;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget position() {\n\t\treturn this._position;\n\t}\n\n\tset position( position: number ) {\n\t\tif( this._position !== position ) {\n\t\t\tthis._position = position;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\tget selected() {\n\t\treturn this._selected;\n\t}\n\n\tset selected( selected: boolean ) {\n\t\tif( this._selected !== selected ) {\n\t\t\tthis._selected = selected;\n\t\t\tthis._callback( this );\n\t\t}\n\t}\n\n\ttoObject(): DColorGradientPoint {\n\t\treturn {\n\t\t\tcolor: this._color,\n\t\t\talpha: this._alpha,\n\t\t\tposition: this._position\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DColorGradient, DColorGradientPoint } from \"./d-color-gradient\";\nimport { DColorGradientPointObservable } from \"./d-color-gradient-point-observable\";\n\nconst POINT_SORTER = ( a: DColorGradientPoint, b: DColorGradientPoint ): number => {\n\treturn a.position - b.position;\n};\n\nexport class DColorGradientObservable extends utils.EventEmitter implements DColorGradient {\n\tprotected _points: DColorGradientPointObservable[];\n\tprotected _direction: number;\n\tprotected _selected: DColorGradientPointObservable | null;\n\n\tprotected _onChangeBound: ( target: DColorGradientPointObservable ) => void;\n\tprotected _workColor: number[];\n\n\tconstructor() {\n\t\tsuper();\n\n\t\tthis._onChangeBound = ( target: DColorGradientPointObservable ): void => {\n\t\t\tthis.onChange( target );\n\t\t};\n\n\t\tconst first = new DColorGradientPointObservable( 0xffffff, 1, 0, false, this._onChangeBound );\n\t\tconst second = new DColorGradientPointObservable( 0x808080, 1, 1, true, this._onChangeBound );\n\t\tthis._points = [ first, second ];\n\t\tthis._direction = -90;\n\t\tthis._selected = second;\n\t\tthis._workColor = [ 0, 0, 0 ];\n\t}\n\n\tprotected onChange( target: DColorGradientPointObservable ): void {\n\t\tconst isSelectionChanged = ( target.selected && this._selected !== target );\n\t\tif( isSelectionChanged ) {\n\t\t\tconst selected = this._selected;\n\t\t\tif( selected != null ) {\n\t\t\t\t(selected as any)._selected = false;\n\t\t\t}\n\t\t\tthis._selected = target;\n\t\t}\n\t\tthis._points.sort( POINT_SORTER );\n\t\tif( isSelectionChanged ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tget points(): DColorGradientPointObservable[] {\n\t\treturn this._points;\n\t}\n\n\tget direction(): number {\n\t\treturn this._direction;\n\t}\n\n\tset direction( direction: number ) {\n\t\tif( this._direction !== direction ) {\n\t\t\tthis._direction = direction;\n\t\t\tthis.emit( \"directionchange\", direction, this );\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tget selected(): DColorGradientPointObservable | null {\n\t\treturn this._selected;\n\t}\n\n\tsize(): number {\n\t\treturn this._points.length;\n\t}\n\n\tget( index: number ): DColorGradientPointObservable | null {\n\t\tconst points = this._points;\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\treturn points[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\taddAt( position: number ): DColorGradientPointObservable {\n\t\tconst points = this._points;\n\t\tlet previous: DColorGradientPointObservable | null = null;\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tconst point = points[ i ];\n\t\t\tif( position <= point.position ) {\n\t\t\t\tif( previous != null ) {\n\t\t\t\t\tconst span = point.position - previous.position;\n\t\t\t\t\tif( 0.001 < span ) {\n\t\t\t\t\t\tconst rgb0 = utils.hex2rgb( point.color, this._workColor );\n\t\t\t\t\t\tconst r0 = rgb0[ 0 ];\n\t\t\t\t\t\tconst g0 = rgb0[ 1 ];\n\t\t\t\t\t\tconst b0 = rgb0[ 2 ];\n\n\t\t\t\t\t\tconst rgb1 = utils.hex2rgb( previous.color, this._workColor );\n\t\t\t\t\t\tconst r1 = rgb1[ 0 ];\n\t\t\t\t\t\tconst g1 = rgb1[ 1 ];\n\t\t\t\t\t\tconst b1 = rgb1[ 2 ];\n\n\t\t\t\t\t\tconst ratio = (position - previous.position) / span;\n\t\t\t\t\t\tconst r = r0 * ratio + r1 * (1 - ratio);\n\t\t\t\t\t\tconst g = g0 * ratio + g1 * (1 - ratio);\n\t\t\t\t\t\tconst b = b0 * ratio + b1 * (1 - ratio);\n\n\t\t\t\t\t\tconst rgb = this._workColor;\n\t\t\t\t\t\trgb[ 0 ] = r;\n\t\t\t\t\t\trgb[ 1 ] = g;\n\t\t\t\t\t\trgb[ 2 ] = b;\n\n\t\t\t\t\t\tconst color = utils.rgb2hex( rgb );\n\t\t\t\t\t\tconst alpha = point.alpha * ratio + previous.alpha * (1 - ratio);\n\t\t\t\t\t\treturn this.add( color, alpha, position, true );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\treturn this.add( point.color, point.alpha, position, true );\n\t\t\t\t}\n\t\t\t}\n\t\t\tprevious = point;\n\t\t}\n\t\tif( previous != null ) {\n\t\t\treturn this.add( previous.color, previous.alpha, position, true );\n\t\t} else {\n\t\t\treturn this.add( 0xffffff, 1.0, position, true );\n\t\t}\n\t}\n\n\tadd( color: number, alpha: number, position: number, selected: boolean ): DColorGradientPointObservable {\n\t\tconst result = new DColorGradientPointObservable( color, alpha, position, selected, this._onChangeBound );\n\t\tthis._points.push( result );\n\t\tthis._onChangeBound( result );\n\t\treturn result;\n\t}\n\n\tremove( point: DColorGradientPointObservable ): boolean {\n\t\tconst points = this._points;\n\t\tif( 2 < points.length ) {\n\t\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\t\tif( points[ i ] === point ) {\n\t\t\t\t\tpoints.splice( i, 1 );\n\t\t\t\t\tconst isSelectionChanged = ( this._selected === point );\n\t\t\t\t\tif( isSelectionChanged ) {\n\t\t\t\t\t\tif( i + 1 < imax ) {\n\t\t\t\t\t\t\tthis._selected = points[ i ];\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tthis._selected = points[ i - 1 ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( isSelectionChanged ) {\n\t\t\t\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\treset(): this {\n\t\tconst oldDirection = this._direction;\n\t\tthis._direction = -90;\n\n\t\tconst points = this._points;\n\t\tconst oldSelected = this._selected;\n\t\tconst index = ( oldSelected ? points.indexOf( oldSelected ) : -1 );\n\t\tpoints.length = 0;\n\t\tpoints.push( new DColorGradientPointObservable( 0xffffff, 0, 0, false, this._onChangeBound ) );\n\t\tpoints.push( new DColorGradientPointObservable( 0xffffff, 0, 1, false, this._onChangeBound ) );\n\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\tconst point = points[ index ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else if( 0 < points.length ) {\n\t\t\tconst point = points[ points.length - 1 ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else {\n\t\t\tthis._selected = null;\n\t\t}\n\t\tif( oldSelected !== this._selected ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\n\t\tif( oldDirection !== this._direction ) {\n\t\t\tthis.emit( \"directionchange\", this._direction, this );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n\n\ttoObject(): DColorGradient {\n\t\tconst pointsCopy = [];\n\t\tconst points = this._points;\n\t\tfor( let i = 0, imax = points.length; i < imax; ++i ) {\n\t\t\tpointsCopy.push( points[ i ].toObject() );\n\t\t}\n\t\treturn {\n\t\t\tpoints: pointsCopy,\n\t\t\tdirection: this._direction\n\t\t};\n\t}\n\n\tfromObject( data: DColorGradient ): this {\n\t\tconst oldDirection = this._direction;\n\t\tthis._direction = data.direction;\n\n\t\tconst points = this._points;\n\t\tconst oldSelected = this._selected;\n\t\tconst index = ( oldSelected ? points.indexOf( oldSelected ) : -1 );\n\t\tpoints.length = 0;\n\t\tfor( let i = 0, imax = data.points.length; i < imax; ++i ) {\n\t\t\tconst pointLike = data.points[ i ];\n\t\t\tconst point = new DColorGradientPointObservable(\n\t\t\t\tpointLike.color, pointLike.alpha, pointLike.position,\n\t\t\t\tfalse, this._onChangeBound\n\t\t\t);\n\t\t\tpoints.push( point );\n\t\t}\n\t\tpoints.sort( POINT_SORTER );\n\n\t\tif( 0 <= index && index < points.length ) {\n\t\t\tconst point = points[ index ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else if( 0 < points.length ) {\n\t\t\tconst point = points[ points.length - 1 ];\n\t\t\t(point as any)._selected = true;\n\t\t\tthis._selected = point;\n\t\t} else {\n\t\t\tthis._selected = null;\n\t\t}\n\t\tif( oldSelected !== this._selected ) {\n\t\t\tthis.emit( \"selectionchange\", this._selected, this );\n\t\t}\n\n\t\tif( oldDirection !== this._direction ) {\n\t\t\tthis.emit( \"directionchange\", this._direction, this );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DInputLabelOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeText<VALUE> = DThemeText<VALUE>\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeInputLabel<VALUE = unknown> extends DThemeText<VALUE> {\n\n}\n\nexport class DInputLabel<\n\tVALUE = unknown,\n\tTHEME extends DThemeInputLabel<VALUE> = DThemeInputLabel<VALUE>,\n\tOPTIONS extends DInputLabelOptions<VALUE, THEME> = DInputLabelOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DInputLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DInputLabel, DInputLabelOptions } from \"./d-input-label\";\nimport { DLayoutOptions } from \"./d-layout\";\nimport { DLayoutHorizontal, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace, DLayoutSpaceOptions } from \"./d-layout-space\";\n\ninterface InputOptions {\n\tweight?: number;\n}\n\ninterface Input extends DisplayObject {\n\treadonly height: number;\n}\n\nexport interface DInputAndLabelOptions<\n\tINPUT_OPTIONS extends InputOptions = InputOptions,\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DLayoutOptions<THEME> {\n\tinput?: INPUT_OPTIONS;\n\tlabel?: DInputLabelOptions;\n\tspace?: DLayoutSpaceOptions;\n}\n\nexport interface DThemeInputAndLabel extends DThemeLayoutHorizontal {\n\n}\n\nexport abstract class DInputAndLabel<\n\tINPUT extends Input,\n\tINPUT_OPTIONS extends InputOptions,\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputAndLabelOptions<INPUT_OPTIONS, THEME> = DInputAndLabelOptions<INPUT_OPTIONS, THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _input: INPUT;\n\tprotected _label: DInputLabel;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.addChild( this._label = new DInputLabel( options != null ? options.label : undefined ) );\n\t\tthis.addChild( this._input = this.createInput( options != null ? options.input : undefined ) );\n\t\tif( options != null && options.space != null ) {\n\t\t\tthis.addChild( new DLayoutSpace( options.space ) );\n\t\t}\n\t}\n\n\tget input() {\n\t\treturn this._input;\n\t}\n\n\tget label() {\n\t\treturn this._label;\n\t}\n\n\tprotected abstract createInput( options?: INPUT_OPTIONS | { weight: number } ): INPUT;\n\n\tprotected getType(): string {\n\t\treturn \"DInputAndLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputReal, DInputRealOptions, DThemeInputReal } from \"./d-input-real\";\n\nexport interface DInputRealAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputRealOptions, THEME> {}\n\nexport class DInputRealAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputRealAndLabelOptions<THEME> = DInputRealAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputReal, DInputRealOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputRealOptions<DThemeInputReal> ): DInputReal {\n\t\treturn new DInputReal( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputText, DInputTextOptions, DThemeInputText } from \"./d-input-text\";\n\nexport interface DInputTextAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputTextOptions, THEME> {}\n\nexport class DInputTextAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputTextAndLabelOptions<THEME> = DInputTextAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputText, DInputTextOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputTextOptions<DThemeInputText> ): DInputText {\n\t\treturn new DInputText( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorAndAlpha } from \"./d-color-and-alpha\";\n\nexport class DPickerColorAndAlpha implements DColorAndAlpha {\n\tprotected _colorAndAlpha: DColorAndAlpha;\n\tprotected _onColorChange: ( color: number ) => void;\n\tprotected _onAlphaChange: ( alpha: number ) => void;\n\n\tconstructor(\n\t\tcolorAndAlpha: DColorAndAlpha,\n\t\tonColorChange: ( color: number ) => void,\n\t\tonAlphaChange: ( alpha: number ) => void\n\t) {\n\t\tthis._colorAndAlpha = colorAndAlpha;\n\t\tthis._onColorChange = onColorChange;\n\t\tthis._onAlphaChange = onAlphaChange;\n\t}\n\n\tget color() {\n\t\treturn this._colorAndAlpha.color;\n\t}\n\n\tset color( color: number ) {\n\t\tif( this._colorAndAlpha.color !== color ) {\n\t\t\tconst callback = this._onColorChange;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback( color );\n\t\t\t}\n\t\t}\n\t}\n\n\tget alpha() {\n\t\treturn this._colorAndAlpha.alpha;\n\t}\n\n\tset alpha( alpha: number ) {\n\t\tif( this._colorAndAlpha.alpha !== alpha ) {\n\t\t\tconst callback = this._onAlphaChange;\n\t\t\tif( callback != null ) {\n\t\t\t\tcallback( alpha );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DColorAndAlpha } from \"./d-color-and-alpha\";\n\nexport class DPickerColorRecent extends utils.EventEmitter {\n\tprotected _recents: DColorAndAlpha[];\n\tprotected _capacity: number;\n\n\tconstructor( recents: DColorAndAlpha[], capacity: number ) {\n\t\tsuper();\n\n\t\tthis._recents = recents;\n\t\tthis._capacity = capacity;\n\t}\n\n\tget( index: number ): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\treturn recents[ recents.length - 1 - index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, colorAndAlpha: DColorAndAlpha ): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\tconst result = recents[ recents.length - 1 - index ];\n\t\t\trecents[ recents.length - 1 - index ] = {\n\t\t\t\tcolor: colorAndAlpha.color,\n\t\t\t\talpha: colorAndAlpha.alpha\n\t\t\t};\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontains( colorAndAlpha: DColorAndAlpha ): boolean {\n\t\tconst recents = this._recents;\n\t\tfor( let i = 0, imax = recents.length; i < imax; ++i ) {\n\t\t\tconst recent = recents[ i ];\n\t\t\tif( recent.color === colorAndAlpha.color && recent.alpha === colorAndAlpha.alpha ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tadd( colorAndAlpha: DColorAndAlpha ): this {\n\t\tconst recents = this._recents;\n\t\trecents.push({\n\t\t\tcolor: colorAndAlpha.color,\n\t\t\talpha: colorAndAlpha.alpha\n\t\t});\n\t\tif( this._capacity < recents.length ) {\n\t\t\trecents.shift();\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n\n\tpop(): DColorAndAlpha | null {\n\t\tconst recents = this._recents;\n\t\tconst result = recents.shift();\n\t\tif( result != null ) {\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._recents.length;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, interaction, Point, Sprite, Texture } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DColorAndAlpha } from \"./d-color-and-alpha\";\nimport { DInputRealAndLabel } from \"./d-input-real-and-label\";\nimport { DInputTextAndLabel } from \"./d-input-text-and-label\";\nimport { DPickerColorAndAlpha } from \"./d-picker-color-and-alpha\";\nimport { DPickerColorRecent } from \"./d-picker-color-recent\";\nimport { UtilHsv } from \"./util/util-hsv\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\nimport { UtilRgb } from \"./util/util-rgb\";\n\nexport interface DPickerColorOptions<THEME extends DThemePickerColor = DThemePickerColor> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerColor extends DThemeBase {\n\tgetMainWidth(): number;\n\tgetMainHeight(): number;\n\tgetMainTexture(): Texture;\n\tgetMainPointerTexture(): Texture;\n\tgetMainPointerColor(): number;\n\tgetMainPointerAlpha(): number;\n\n\tgetBaseHeight(): number;\n\tgetBaseMargin(): number;\n\tgetBaseTexture(): Texture;\n\tgetBasePointerTexture(): Texture;\n\tgetBasePointerColor(): number;\n\tgetBasePointerAlpha(): number;\n\n\tgetAlphaHeight(): number;\n\tgetAlphaMargin(): number;\n\tgetAlphaTexture(): Texture;\n\tgetAlphaCheckerboardTexture(): Texture;\n\tgetAlphaPointerTexture(): Texture;\n\tgetAlphaPointerColor(): number;\n\tgetAlphaPointerAlpha(): number;\n\n\tgetRecentMargin(): number;\n\tgetRecentColorMargin(): number;\n\tgetRecentColorWidth(): number;\n\tgetRecentColorHeight(): number;\n\tgetRecentColorCount(): number;\n\tgetRecentCheckerboardTexture(): Texture;\n\tgetRecents(): DColorAndAlpha[];\n\n\tgetInputMargin(): number;\n\tgetInputLabelWidth(): number;\n\n\tgetSampleCheckerboardTexture(): Texture;\n}\n\nexport class DPickerColor<\n\tTHEME extends DThemePickerColor = DThemePickerColor,\n\tOPTIONS extends DPickerColorOptions<THEME> = DPickerColorOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static RECENT_COLORS: DPickerColorRecent | null = null;\n\n\tprotected _mainBaseSprite!: Sprite;\n\tprotected _mainSprite!: Sprite;\n\tprotected _mainPointerSprite!: Sprite;\n\tprotected _pointerPoint!: Point;\n\tprotected _onMainMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onMainUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _baseSprite!: Sprite;\n\tprotected _basePointerSprite!: Sprite;\n\tprotected _onBaseMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onBaseUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _alphaCheckerboardSprite!: Sprite;\n\tprotected _alphaSprite!: Sprite;\n\tprotected _alphaPointerSprite!: Sprite;\n\tprotected _onAlphaMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAlphaUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _recentColorSprites!: Sprite[];\n\tprotected _recent!: DPickerColorRecent;\n\n\tprotected _inputAndLabelColor!: DInputTextAndLabel;\n\tprotected _inputAndLabelAlpha!: DInputRealAndLabel;\n\n\tprotected _sampleCurrentCheckerboardSprite!: Sprite;\n\tprotected _sampleCurrentSprite!: Sprite;\n\tprotected _sampleNewCheckerboardSprite!: Sprite;\n\tprotected _sampleNewSprite!: Sprite;\n\n\tprotected _current!: DColorAndAlpha;\n\tprotected _currentPicker!: DPickerColorAndAlpha;\n\tprotected _base!: number;\n\tprotected _new!: DColorAndAlpha;\n\tprotected _newPicker!: DPickerColorAndAlpha;\n\n\tget current(): DColorAndAlpha {\n\t\treturn this._currentPicker;\n\t}\n\n\tget new(): DColorAndAlpha {\n\t\treturn this._newPicker;\n\t}\n\n\tget recent(): DPickerColorRecent {\n\t\treturn this._recent;\n\t}\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.state.isFocusable = false;\n\n\t\tthis._base = 0xff0000;\n\t\tthis._new = { color: 0xffffff, alpha: 1 };\n\t\tthis._newPicker = new DPickerColorAndAlpha( this._new, ( color ) => {\n\t\t\tthis.setColorNew( color );\n\t\t}, ( alpha: number ) => {\n\t\t\tthis.setAlphaNew( alpha );\n\t\t});\n\t\tthis._current = { color: 0xffffff, alpha: 1 };\n\t\tthis._currentPicker = new DPickerColorAndAlpha( this._current, ( color ) => {\n\t\t\tthis.setColorCurrent( color );\n\t\t}, ( alpha: number ) => {\n\t\t\tthis.setAlphaCurrent( alpha );\n\t\t});\n\n\t\tconst theme = this.theme;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tthis._pointerPoint = new Point();\n\n\t\t// Main\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst mainBaseSprite = new Sprite( Texture.WHITE );\n\t\tthis._mainBaseSprite = mainBaseSprite;\n\t\tmainBaseSprite.x = paddingLeft;\n\t\tmainBaseSprite.y = paddingTop;\n\t\tmainBaseSprite.width = mainWidth;\n\t\tmainBaseSprite.height = mainHeight;\n\t\tmainBaseSprite.interactive = true;\n\t\tthis.addChild( mainBaseSprite );\n\n\t\tconst mainSprite = new Sprite( theme.getMainTexture() );\n\t\tthis._mainSprite = mainSprite;\n\t\tmainSprite.x = paddingLeft;\n\t\tmainSprite.y = paddingTop;\n\t\tmainSprite.tint = this._base;\n\t\tmainSprite.interactive = false;\n\t\tthis.addChild( mainSprite );\n\n\t\t// Main event handling\n\t\tthis._onMainMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMainMove( e );\n\t\t};\n\t\tthis._onMainUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onMainUp( e );\n\t\t};\n\t\tmainBaseSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onMainDown( e );\n\t\t});\n\n\t\t// Base color picker\n\t\tconst baseSprite = new Sprite( theme.getBaseTexture() );\n\t\tthis._baseSprite = baseSprite;\n\t\tbaseSprite.x = paddingLeft;\n\t\tbaseSprite.y = mainBaseSprite.y + mainBaseSprite.height + theme.getBaseMargin();\n\t\tbaseSprite.interactive = true;\n\t\tthis.addChild( baseSprite );\n\n\t\t// Base event\n\t\tthis._onBaseMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onBaseMove( e );\n\t\t};\n\t\tthis._onBaseUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onBaseUp( e );\n\t\t};\n\t\tbaseSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onBaseDown( e );\n\t\t});\n\n\t\t// Alpha picker\n\t\tconst alphaCheckerboardSprite = new Sprite( theme.getAlphaCheckerboardTexture() );\n\t\tthis._alphaCheckerboardSprite = alphaCheckerboardSprite;\n\t\talphaCheckerboardSprite.x = padding.getLeft();\n\t\talphaCheckerboardSprite.y = baseSprite.y + theme.getBaseHeight() + theme.getBaseMargin();\n\t\talphaCheckerboardSprite.interactive = false;\n\t\tthis.addChild( alphaCheckerboardSprite );\n\n\t\tconst alphaSprite = new Sprite( theme.getAlphaTexture() );\n\t\talphaSprite.tint = this._new.color;\n\t\talphaSprite.interactive = true;\n\t\talphaCheckerboardSprite.addChild( alphaSprite );\n\n\t\t// Alpha event\n\t\tthis._onAlphaMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAlphaMove( e );\n\t\t};\n\t\tthis._onAlphaUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAlphaUp( e );\n\t\t};\n\t\talphaSprite.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis.onAlphaDown( e );\n\t\t});\n\n\t\t// Pointers\n\t\tconst mainPointerSprite = new Sprite( theme.getMainPointerTexture() );\n\t\tthis._mainPointerSprite = mainPointerSprite;\n\t\tmainPointerSprite.x = paddingLeft;\n\t\tmainPointerSprite.y = paddingTop;\n\t\tmainPointerSprite.anchor.x = 0.5;\n\t\tmainPointerSprite.anchor.y = 0.5;\n\t\tmainPointerSprite.tint = theme.getMainPointerColor();\n\t\tmainPointerSprite.alpha = theme.getMainPointerAlpha();\n\t\tmainPointerSprite.interactive = false;\n\t\tthis.addChild( mainPointerSprite );\n\n\t\tconst alphaPointerSprite = new Sprite( theme.getAlphaPointerTexture() );\n\t\tthis._alphaPointerSprite = alphaPointerSprite;\n\t\talphaPointerSprite.x = mainWidth;\n\t\talphaPointerSprite.y = alphaCheckerboardSprite.height * 0.5;\n\t\talphaPointerSprite.tint = theme.getAlphaPointerColor();\n\t\talphaPointerSprite.alpha = theme.getAlphaPointerAlpha();\n\t\talphaPointerSprite.anchor.set( 0.5, 0.5 );\n\t\talphaPointerSprite.interactive = false;\n\t\talphaCheckerboardSprite.addChild( alphaPointerSprite );\n\n\t\tconst basePointerSprite = new Sprite( theme.getBasePointerTexture() );\n\t\tthis._basePointerSprite = basePointerSprite;\n\t\tbasePointerSprite.x = 0;\n\t\tbasePointerSprite.y = baseSprite.height * 0.5;\n\t\tbasePointerSprite.tint = theme.getBasePointerColor();\n\t\tbasePointerSprite.alpha = theme.getBasePointerAlpha();\n\t\tbasePointerSprite.anchor.set( 0.5, 0.5 );\n\t\tbasePointerSprite.interactive = false;\n\t\tbaseSprite.addChild( basePointerSprite );\n\n\t\t// Recently used\n\t\tthis._recentColorSprites = [];\n\t\tconst recentColorSprites = this._recentColorSprites;\n\t\tconst recentColorCount = theme.getRecentColorCount();\n\t\tconst recentColorWidth = theme.getRecentColorWidth();\n\t\tconst recentColorHeight = theme.getRecentColorHeight();\n\t\tconst recentColorWidthHalf = recentColorWidth * 0.5;\n\t\tconst recentColorHeightHalf = recentColorHeight * 0.5;\n\t\tconst recentColorMargin = theme.getRecentColorMargin();\n\t\tconst recentColorY = alphaCheckerboardSprite.y + theme.getAlphaHeight() + theme.getRecentMargin();\n\t\tconst recentCheckerboardTexture = theme.getRecentCheckerboardTexture();\n\t\tif( DPickerColor.RECENT_COLORS == null ) {\n\t\t\tDPickerColor.RECENT_COLORS = new DPickerColorRecent(\n\t\t\t\ttheme.getRecents().slice( 0 ),\n\t\t\t\trecentColorCount\n\t\t\t);\n\t\t}\n\t\tconst recent = this._recent = DPickerColor.RECENT_COLORS;\n\t\trecent.on( \"change\", () => {\n\t\t\tthis.onRecentChange();\n\t\t});\n\t\tconst onRecentClick = ( e: InteractionEvent ) => {\n\t\t\tconst checkerboardSprite = e.currentTarget;\n\t\t\tif( checkerboardSprite instanceof Container ) {\n\t\t\t\tconst sprite = checkerboardSprite.children[ 0 ];\n\t\t\t\tif( sprite instanceof Sprite ) {\n\t\t\t\t\tthis.setColorNew( sprite.tint );\n\t\t\t\t\tthis.setAlphaNew( sprite.alpha );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tfor( let i = 0; i < recentColorCount; ++i ) {\n\t\t\tconst x = paddingLeft + i * (recentColorWidth + recentColorMargin);\n\n\t\t\tconst checkerboardSprite = new Sprite( recentCheckerboardTexture );\n\t\t\tcheckerboardSprite.x = x + recentColorWidthHalf;\n\t\t\tcheckerboardSprite.y = recentColorY + recentColorHeightHalf;\n\t\t\tcheckerboardSprite.anchor.x = 0.5;\n\t\t\tcheckerboardSprite.anchor.y = 0.5;\n\t\t\tcheckerboardSprite.buttonMode = true;\n\t\t\tcheckerboardSprite.interactive = true;\n\t\t\tUtilPointerEvent.onClick( checkerboardSprite, onRecentClick );\n\t\t\tthis.addChild( checkerboardSprite );\n\n\t\t\tconst sprite = new Sprite( Texture.WHITE );\n\t\t\tconst recentColorAndAlpha = recent.get( i );\n\t\t\tif( recentColorAndAlpha != null ) {\n\t\t\t\tsprite.tint = recentColorAndAlpha.color;\n\t\t\t\tsprite.alpha = recentColorAndAlpha.alpha;\n\t\t\t} else {\n\t\t\t\tsprite.tint = 0xffffff;\n\t\t\t\tsprite.alpha = 0;\n\t\t\t}\n\t\t\tsprite.width = recentColorWidth;\n\t\t\tsprite.height = recentColorHeight;\n\t\t\tsprite.anchor.x = 0.5;\n\t\t\tsprite.anchor.y = 0.5;\n\t\t\tsprite.interactive = false;\n\t\t\tcheckerboardSprite.addChild( sprite );\n\t\t\trecentColorSprites.push( sprite );\n\t\t}\n\n\t\t// Input color\n\t\tconst inputMargin = theme.getInputMargin();\n\t\tconst inputLabelWidth = theme.getInputLabelWidth();\n\t\tconst inputY = recentColorY + recentColorHeight + inputMargin;\n\t\tconst inputWidth = (mainWidth - inputMargin) * 0.5;\n\t\tconst inputAndLabelColor = new DInputTextAndLabel({\n\t\t\tparent: this,\n\t\t\tx: paddingLeft,\n\t\t\ty: inputY,\n\t\t\twidth: inputWidth,\n\t\t\tlabel: {\n\t\t\t\twidth: inputLabelWidth,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"#\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"FFFFFF\"\n\t\t\t\t},\n\t\t\t\ton: {\n\t\t\t\t\tinput: ( code: string ): void => {\n\t\t\t\t\t\tconst color = UtilRgb.fromCode( code );\n\t\t\t\t\t\tif( color != null ) {\n\t\t\t\t\t\t\tthis.setColorNew( color );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis._inputAndLabelColor = inputAndLabelColor;\n\t\tconst inputHeight = inputAndLabelColor.height;\n\n\t\tconst inputAndLabelAlpha = new DInputRealAndLabel({\n\t\t\tparent: this,\n\t\t\tx: paddingLeft,\n\t\t\ty: inputY + inputHeight + inputMargin,\n\t\t\twidth: inputWidth,\n\t\t\tlabel: {\n\t\t\t\twidth: inputLabelWidth,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: \"A\"\n\t\t\t\t}\n\t\t\t},\n\t\t\tinput: {\n\t\t\t\tweight: 1,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: 1\n\t\t\t\t},\n\t\t\t\tmin: 0,\n\t\t\t\tmax: 1,\n\t\t\t\ton: {\n\t\t\t\t\tinput: ( value: number ) => {\n\t\t\t\t\t\tthis.setAlphaNew( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis._inputAndLabelAlpha = inputAndLabelAlpha;\n\n\t\t// Samples\n\t\tconst sampleWidth = (inputWidth - inputLabelWidth - inputMargin) * 0.5;\n\t\tconst sampleHeight = inputHeight + inputMargin + inputHeight;\n\t\tconst sampleX = paddingLeft + (mainWidth - inputMargin) * 0.5 + inputMargin;\n\t\tconst sampleY = inputY + (inputHeight + inputMargin + inputAndLabelAlpha.height - sampleHeight) * 0.5;\n\n\t\tconst sampleCurrentCheckerboardSprite = new Sprite( theme.getSampleCheckerboardTexture() );\n\t\tthis._sampleCurrentCheckerboardSprite = sampleCurrentCheckerboardSprite;\n\t\tsampleCurrentCheckerboardSprite.x = sampleX;\n\t\tsampleCurrentCheckerboardSprite.y = sampleY;\n\t\tsampleCurrentCheckerboardSprite.width = sampleWidth;\n\t\tsampleCurrentCheckerboardSprite.height = sampleHeight;\n\t\tsampleCurrentCheckerboardSprite.interactive = false;\n\t\tthis.addChild( sampleCurrentCheckerboardSprite );\n\n\t\tconst current = this._current;\n\t\tconst sampleCurrentSprite = new Sprite( Texture.WHITE );\n\t\tthis._sampleCurrentSprite = sampleCurrentSprite;\n\t\tsampleCurrentSprite.x = sampleX;\n\t\tsampleCurrentSprite.y = sampleY;\n\t\tsampleCurrentSprite.tint = current.color;\n\t\tsampleCurrentSprite.alpha = current.alpha;\n\t\tsampleCurrentSprite.width = sampleWidth;\n\t\tsampleCurrentSprite.height = sampleHeight;\n\t\tsampleCurrentSprite.interactive = true;\n\t\tsampleCurrentSprite.buttonMode = true;\n\t\tUtilPointerEvent.onClick( sampleCurrentSprite, (): void => {\n\t\t\tthis.setColorNew( current.color );\n\t\t\tthis.setAlphaNew( current.alpha );\n\t\t});\n\t\tthis.addChild( sampleCurrentSprite );\n\n\t\tconst sampleNewCheckerboardSprite = new Sprite( theme.getSampleCheckerboardTexture() );\n\t\tthis._sampleNewCheckerboardSprite = sampleNewCheckerboardSprite;\n\t\tsampleNewCheckerboardSprite.x = sampleX + sampleWidth;\n\t\tsampleNewCheckerboardSprite.y = sampleY;\n\t\tsampleNewCheckerboardSprite.width = sampleWidth;\n\t\tsampleNewCheckerboardSprite.height = sampleHeight;\n\t\tsampleNewCheckerboardSprite.interactive = false;\n\t\tthis.addChild( sampleNewCheckerboardSprite );\n\n\t\tconst sampleNewSprite = new Sprite( Texture.WHITE );\n\t\tthis._sampleNewSprite = sampleNewSprite;\n\t\tsampleNewSprite.x = sampleX + sampleWidth;\n\t\tsampleNewSprite.y = sampleY;\n\t\tsampleNewSprite.tint = this._new.color;\n\t\tsampleNewSprite.alpha = this._new.alpha;\n\t\tsampleNewSprite.width = sampleWidth;\n\t\tsampleNewSprite.height = sampleHeight;\n\t\tsampleNewSprite.interactive = false;\n\t\tthis.addChild( sampleNewSprite );\n\n\t\t// Width\n\t\tif( options == null || options.width == null ) {\n\t\t\tthis.width = paddingLeft + mainWidth + paddingRight;\n\t\t}\n\n\t\t// Height\n\t\tif( options == null || options.height == null ) {\n\t\t\tthis.height = inputY + inputAndLabelColor.height + inputMargin + inputAndLabelAlpha.height + paddingBottom;\n\t\t}\n\t}\n\n\tprotected onMainDown( e: InteractionEvent ): void {\n\t\tthis.onMainPick( e.data.global );\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onMainMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onMainUpBound );\n\t\t}\n\t}\n\n\tprotected onMainMove( e: InteractionEvent ): void {\n\t\tthis.onMainPick( e.data.global );\n\t}\n\n\tprotected onMainUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onMainMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onMainUpBound );\n\t\t}\n\t}\n\n\tprotected toMainHex( b: number, w0: number, w1: number, shift: number ) {\n\t\treturn Math.max( 0, Math.min( 255, w0 * 255 + w1 * (( b >> shift ) & 0xff) ) ) << shift;\n\t}\n\n\tprotected toMainColor( base: number, tx: number, ty: number, width: number, height: number ): number {\n\t\tconst hw = width * 0.5;\n\t\tconst ux = Math.max( 0, Math.min( 1, ((tx - hw) * ( 1 - ty / height ) + hw) / width ) );\n\t\tconst uy = Math.max( 0, Math.min( 1, ty / height ) );\n\t\tconst w1 = Math.abs( 0.5 * uy  - ux );\n\t\tconst w0 = 1 - w1 - uy;\n\t\tconst r = this.toMainHex( base, w0, w1, 16 );\n\t\tconst g = this.toMainHex( base, w0, w1, 8 );\n\t\tconst b = this.toMainHex( base, w0, w1, 0 );\n\t\treturn r | g | b;\n\t}\n\n\tprotected onMainPick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst paddingLeft = padding.getLeft();\n\t\tconst paddingTop = padding.getTop();\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - paddingLeft ) );\n\t\tconst y = Math.max( 0, Math.min( mainHeight, point.y - paddingTop ) );\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tmainPointerSprite.position.set( paddingLeft + x, paddingTop + y );\n\t\tthis.onColorNew( this.toMainColor(\n\t\t\tthis._base, x, y, mainWidth, mainHeight ) );\n\t}\n\n\tprotected setColorCurrent( color: number ) {\n\t\tthis._sampleCurrentSprite.tint = this._current.color = color;\n\t}\n\n\tprotected setAlphaCurrent( alpha: number ) {\n\t\tthis._sampleCurrentSprite.alpha = this._current.alpha = alpha;\n\t}\n\n\tprotected setColorNew( color: number ) {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst padding = this._padding;\n\n\t\t// Base color\n\t\tconst hsv = UtilHsv.fromRgb( color );\n\t\tthis._mainSprite.tint = this._base = UtilHsv.toRgb( hsv[ 0 ], 255, 255 );\n\n\t\t// Move the base pointer\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = Math.max( 0, Math.min( 1, hsv[ 0 ] / 360 ) ) * mainWidth;\n\n\t\t// Move the main pointer\n\t\tconst ns = Math.max( 0, Math.min( 1, hsv[ 1 ] / 255 ) );\n\t\tconst nv = Math.max( 0, Math.min( 1, 1 - hsv[ 2 ] / 255 ) );\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tmainPointerSprite.tint = (nv < 0.45 ? theme.getMainPointerColor() : 0xffffff);\n\t\tmainPointerSprite.position.set(\n\t\t\tpadding.getLeft() + ns * mainWidth,\n\t\t\tpadding.getTop() + nv * mainHeight\n\t\t);\n\n\t\t// New color\n\t\tthis.onColorNew( color );\n\t}\n\n\tprotected onColorNew( color: number ) {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tlayer.lock();\n\t\t}\n\t\tthis._sampleNewSprite.tint = this._new.color = color;\n\t\tthis._inputAndLabelColor.input.value = UtilRgb.toCode( color );\n\t\tthis.emit( \"newcolorchange\", color, this );\n\t\tif( layer ) {\n\t\t\tlayer.unlock();\n\t\t\tlayer.update();\n\t\t}\n\t}\n\n\tprotected onBaseDown( e: InteractionEvent ): void {\n\t\tthis.onBasePick( e.data.global );\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onBaseMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onBaseUpBound );\n\t\t}\n\t}\n\n\tprotected onBaseMove( e: InteractionEvent ): void {\n\t\tthis.onBasePick( e.data.global );\n\t}\n\n\tprotected onBaseUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onBaseMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onBaseUpBound );\n\t\t}\n\t}\n\n\tprotected toBaseHex( t: number, shift: number ) {\n\t\treturn Math.max( 0, Math.min( 255, t * 6 * 255 ) ) << shift;\n\t}\n\n\tprotected toBaseColor( t: number ): number {\n\t\tif( t <= 0.167 ) {\n\t\t\treturn 0xff0000 + this.toBaseHex( t, 8 );\n\t\t} else if( t <= 0.333 ) {\n\t\t\tt = 0.333 - t;\n\t\t\treturn 0x00ff00 + this.toBaseHex( t, 16 );\n\t\t} else if( t <= 0.5 ) {\n\t\t\tt -= 0.333;\n\t\t\treturn 0x00ff00 + this.toBaseHex( t, 0 );\n\t\t} else if( t < 0.667 ) {\n\t\t\tt = 0.667 - t;\n\t\t\treturn 0x0000ff + this.toBaseHex( t, 8 );\n\t\t} else if( t < 0.883 ) {\n\t\t\tt -= 0.667;\n\t\t\treturn 0x0000ff + this.toBaseHex( t, 16 );\n\t\t} else {\n\t\t\tt = 0.883 - t;\n\t\t\treturn 0xff0000 + this.toBaseHex( t, 0 );\n\t\t}\n\t}\n\n\tprotected onBasePick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - padding.getLeft() ) );\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = x;\n\t\tthis.onColorBase( this.toBaseColor( x / mainWidth ) );\n\t}\n\n\tprotected setColorBase( h: number ) {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst basePointerSprite = this._basePointerSprite;\n\t\tbasePointerSprite.x = Math.max( 0, Math.min( 1, h / 360 ) ) * mainWidth;\n\t\tthis.onColorBase( UtilHsv.toRgb( h, 255, 255 ) );\n\t}\n\n\tprotected onColorBase( color: number ) {\n\t\tthis._mainSprite.tint = this._base = color;\n\n\t\tconst mainPointerSprite = this._mainPointerSprite;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tconst mainHeight = theme.getMainHeight();\n\t\tconst padding = this._padding;\n\t\tthis.onColorNew( this.toMainColor(\n\t\t\tthis._base,\n\t\t\tmainPointerSprite.x - padding.getLeft(),\n\t\t\tmainPointerSprite.y - padding.getTop(),\n\t\t\tmainWidth,\n\t\t\tmainHeight\n\t\t));\n\t}\n\n\tprotected onAlphaDown( e: InteractionEvent ): void {\n\t\tthis.onAlphaPick( e.data.global );\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onAlphaMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onAlphaUpBound );\n\t\t}\n\t}\n\n\tprotected onAlphaMove( e: InteractionEvent ): void {\n\t\tthis.onAlphaPick( e.data.global );\n\t}\n\n\tprotected onAlphaUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onAlphaMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onAlphaUpBound );\n\t\t}\n\t}\n\n\tprotected onAlphaPick( global: Point ) {\n\t\tconst point = this._pointerPoint;\n\t\tconst padding = this._padding;\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( mainWidth, point.x - padding.getLeft() ) );\n\t\tthis._alphaPointerSprite.x = x;\n\t\tthis.onAlphaNew( x / mainWidth );\n\t}\n\n\tprotected setAlphaNew( alpha: number ): void {\n\t\tconst theme = this.theme;\n\t\tconst mainWidth = theme.getMainWidth();\n\t\tthis._alphaPointerSprite.x = Math.max( 0, Math.min( 1, alpha ) ) * mainWidth;\n\t\tthis.onAlphaNew( alpha );\n\t}\n\n\tprotected onAlphaNew( alpha: number ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tlayer.lock();\n\t\t}\n\t\tthis._sampleNewSprite.alpha = this._new.alpha = alpha;\n\t\tthis._inputAndLabelAlpha.input.value = Number( alpha.toFixed( 2 ) );\n\t\tthis.emit( \"newalphachange\", alpha, this );\n\t\tif( layer ) {\n\t\t\tlayer.unlock();\n\t\t\tlayer.update();\n\t\t}\n\t}\n\n\tprotected onRecentChange(): void {\n\t\tconst sprites = this._recentColorSprites;\n\t\tconst recent = this._recent;\n\t\tfor( let i = 0, imax = sprites.length; i < imax; ++i ) {\n\t\t\tconst sprite = sprites[ i ];\n\t\t\tconst colorAndAlpha = recent.get( i );\n\t\t\tif( colorAndAlpha != null ) {\n\t\t\t\tsprite.tint = colorAndAlpha.color;\n\t\t\t\tsprite.alpha = colorAndAlpha.alpha;\n\t\t\t} else {\n\t\t\t\tsprite.tint = 0xffffff;\n\t\t\t\tsprite.alpha = 0;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DColorGradient } from \"./d-color-gradient\";\n\nconst isEqual = ( a: DColorGradient, b: DColorGradient ) => {\n\tif( a.direction !== b.direction ) {\n\t\treturn false;\n\t}\n\n\tconst ap = a.points;\n\tconst bp = b.points;\n\tif( ap.length !== bp.length ) {\n\t\treturn false;\n\t}\n\n\tfor( let j = 0, jmax = ap.length; j < jmax; ++j ) {\n\t\tconst apj = ap[ j ];\n\t\tconst bpj = bp[ j ];\n\t\tif( apj.color !== bpj.color || apj.alpha !== bpj.alpha || apj.position !== bpj.position ) {\n\t\t\treturn false;\n\t\t}\n\t}\n\n\treturn true;\n};\n\nexport class DPickerColorGradientRecent extends utils.EventEmitter {\n\tprotected _recents: DColorGradient[];\n\tprotected _capacity: number;\n\n\tconstructor( recents: DColorGradient[], capacity: number ) {\n\t\tsuper();\n\n\t\tthis._recents = recents;\n\t\tthis._capacity = capacity;\n\t}\n\n\tgetCapacity(): number {\n\t\treturn this._capacity;\n\t}\n\n\tget( index: number ): DColorGradient | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\treturn recents[ recents.length - 1 - index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, points: DColorGradient ): DColorGradient | null {\n\t\tconst recents = this._recents;\n\t\tif( 0 <= index && index < recents.length ) {\n\t\t\tconst result = recents[ recents.length - 1 - index ];\n\t\t\trecents[ recents.length - 1 - index ] = points;\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tcontains( points: DColorGradient ): boolean {\n\t\tconst recents = this._recents;\n\t\tfor( let i = 0, imax = recents.length; i < imax; ++i ) {\n\t\t\tif( isEqual( recents[ i ], points ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tadd( points: DColorGradient ): this {\n\t\tconst recents = this._recents;\n\t\trecents.push( points );\n\t\tif( this._capacity < recents.length ) {\n\t\t\trecents.shift();\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\treturn this;\n\t}\n\n\tpop(): DColorGradient | null {\n\t\tconst recents = this._recents;\n\t\tconst result = recents.shift();\n\t\tif( result != null ) {\n\t\t\tthis.emit( \"change\", this );\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsize(): number {\n\t\treturn this._recents.length;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Buffer, Geometry, Mesh, Point, Rectangle, Shader, Texture, TextureUvs, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DColorGradient } from \"./d-color-gradient\";\n\nconst VERTEX_SHADER = `\nattribute vec2 aPosition;\nattribute vec2 aUv;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main(void) {\n\tvec3 position = vec3(aPosition.x, aPosition.y, 1.0);\n\tgl_Position = vec4((projectionMatrix * translationMatrix * position).xy, 0.0, 1.0);\n\tvUv = aUv;\n\tvColor = aColor;\n}\n`;\n\nconst FRAGMENT_SHADER = `\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform vec2 uCheckerColors;\n\nvoid main(void) {\n\tvec4 texture = texture2D(uSampler, vUv);\n\tfloat cy = step( 1.0, mod( gl_FragCoord.y / 10.0, 2.0 ) );\n\tfloat cx = step( 1.0, mod( gl_FragCoord.x / 10.0 + cy, 2.0 ) );\n\tfloat c = mix( uCheckerColors.x, uCheckerColors.y, cx );\n\tgl_FragColor = texture * vec4( mix( vec3( c ), vColor.xyz, vColor.a ), 1.0 );\n}`;\n\ntype Parts = Array<{ data: DColorGradient | null, rect: Rectangle }>;\n\nexport class DPickerColorGradientView extends Mesh {\n\tprotected _nPointsPerData: number;\n\tprotected _vertices: Float32Array;\n\tprotected _uvs: Float32Array;\n\tprotected _colors: Float32Array;\n\tprotected _indices: Uint16Array;\n\tprotected _lastHitIndex: number;\n\n\tprotected _workColor: number[];\n\tprotected _workPoint: Point;\n\n\tprotected _parts: Parts;\n\n\tprotected constructor(\n\t\tnPointsPerData: number,\n\t\tvertices: Float32Array, uvs: Float32Array, colors: Float32Array, indices: Uint16Array,\n\t\tparts: Parts, geometry: Geometry, shader: Shader\n\t) {\n\t\tsuper( geometry, shader );\n\n\t\tthis.interactive = true;\n\t\tthis.interactiveChildren = false;\n\t\tthis.cursor = \"pointer\";\n\n\t\tthis._nPointsPerData = nPointsPerData;\n\t\tthis._vertices = vertices;\n\t\tthis._uvs = uvs;\n\t\tthis._colors = colors;\n\t\tthis._indices = indices;\n\t\tthis._lastHitIndex = -1;\n\t\tthis._workColor = [ 0, 0, 0 ];\n\t\tthis._workPoint = new Point();\n\t\tthis._parts = parts;\n\n\t\tshader.uniforms.uSampler.on( \"update\", (): void => {\n\t\t\tthis.update();\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tthis.update();\n\t}\n\n\tgetRectangle( index: number ): Rectangle | null {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\treturn parts[ index ].rect;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetRectangle( index: number, x: number, y: number, width: number, height: number ): void {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\tconst rect = parts[ index ].rect;\n\t\t\trect.x = x;\n\t\t\trect.y = y;\n\t\t\trect.width = width;\n\t\t\trect.height = height;\n\t\t}\n\t}\n\n\tgetData( index: number ): DColorGradient | null {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\treturn parts[ index ].data;\n\t\t}\n\t\treturn null;\n\t}\n\n\tsetData( index: number, data: DColorGradient | null ): void {\n\t\tconst parts = this._parts;\n\t\tif( 0 <= index && index < parts.length ) {\n\t\t\tparts[ index ].data = data;\n\t\t}\n\t}\n\n\tgetLastHitIndex(): number {\n\t\treturn this._lastHitIndex;\n\t}\n\n\tprivate setColors( ic: number, colors: Float32Array, rgb: number[], alpha: number ) {\n\t\tcolors[ ic + 0 ] = rgb[ 0 ];\n\t\tcolors[ ic + 1 ] = rgb[ 1 ];\n\t\tcolors[ ic + 2 ] = rgb[ 2 ];\n\t\tcolors[ ic + 3 ] = alpha;\n\t\tcolors[ ic + 4 ] = rgb[ 0 ];\n\t\tcolors[ ic + 5 ] = rgb[ 1 ];\n\t\tcolors[ ic + 6 ] = rgb[ 2 ];\n\t\tcolors[ ic + 7 ] = alpha;\n\t}\n\n\tprivate setColorsHex( ic: number, colors: Float32Array, color: number, alpha: number ) {\n\t\tconst rgb = utils.hex2rgb( color, this._workColor );\n\t\tthis.setColors( ic, colors, rgb, alpha );\n\t}\n\n\tprivate setColorsWhite( ic: number, colors: Float32Array ) {\n\t\tconst rgb = this._workColor;\n\t\trgb[ 0 ] = 1;\n\t\trgb[ 1 ] = 1;\n\t\trgb[ 2 ] = 1;\n\t\tthis.setColors( ic, colors, rgb, 0 );\n\t}\n\n\tprivate setColorsPoint( ic: number, data: DColorGradient, index: number, colors: Float32Array ) {\n\t\tconst point = data.points[ index ];\n\t\tif( point != null ) {\n\t\t\tthis.setColorsHex( ic, colors, point.color, point.alpha );\n\t\t} else {\n\t\t\tthis.setColorsWhite( ic, colors );\n\t\t}\n\t}\n\n\tprotected setVertices( iv: number, vertices: Float32Array, position: number, rect: Rectangle ) {\n\t\tconst y = rect.y + rect.height * position;\n\t\tvertices[ iv + 0 ] = rect.x;\n\t\tvertices[ iv + 1 ] = y;\n\t\tvertices[ iv + 2 ] = rect.x + rect.width;\n\t\tvertices[ iv + 3 ] = y;\n\t}\n\n\tprotected setUvs( iv: number, uvs: Float32Array, position: number, textureUvs: TextureUvs ) {\n\t\tconst x0 = textureUvs.x0 + (textureUvs.x3 - textureUvs.x0) * position;\n\t\tconst y0 = textureUvs.y0 + (textureUvs.y3 - textureUvs.y0) * position;\n\t\tconst x1 = textureUvs.x1 + (textureUvs.x2 - textureUvs.x1) * position;\n\t\tconst y1 = textureUvs.y1 + (textureUvs.y2 - textureUvs.y1) * position;\n\t\tuvs[ iv + 0 ] = x0;\n\t\tuvs[ iv + 1 ] = y0;\n\t\tuvs[ iv + 2 ] = x1;\n\t\tuvs[ iv + 3 ] = y1;\n\t}\n\n\tprivate newIndices( ii: number, iv: number, size: number, indices: Uint16Array ): Uint16Array {\n\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\tindices[ ii + 0 ] = iv + 0;\n\t\t\tindices[ ii + 1 ] = iv + 1;\n\t\t\tindices[ ii + 2 ] = iv + 2;\n\n\t\t\tindices[ ii + 3 ] = iv + 2;\n\t\t\tindices[ ii + 4 ] = iv + 1;\n\t\t\tindices[ ii + 5 ] = iv + 3;\n\n\t\t\tii += 6;\n\t\t\tiv += 2;\n\t\t}\n\t\treturn indices;\n\t}\n\n\tprotected _calculateBounds() {\n\t\tconst rect = this._parts[ 0 ].rect;\n\t\tconst bounds = this._bounds;\n\t\tconst work = this._workPoint;\n\t\twork.set( rect.x, rect.y );\n\t\tbounds.addPoint( work );\n\t\twork.set( rect.x + rect.width, rect.y + rect.height );\n\t\tbounds.addPoint( work );\n\t}\n\n\tupdate(): void {\n\t\tconst vertices = this._vertices;\n\t\tconst uvs = this._uvs;\n\t\tconst colors = this._colors;\n\t\tconst indices = this._indices;\n\n\t\tconst texture = this.shader.uniforms.uSampler;\n\t\tif( texture._uvs == null ) {\n\t\t\ttexture.updateUvs();\n\t\t}\n\t\tconst textureUvs: TextureUvs = texture._uvs;\n\n\t\tlet iv = 0;\n\t\tlet nv = 0;\n\t\tlet ic = 0;\n\t\tlet ii = 0;\n\n\t\tconst parts = this._parts;\n\t\tfor( let i = 0, imax = parts.length; i < imax; ++i ) {\n\t\t\tconst data = parts[ i ].data;\n\t\t\tconst rect = parts[ i ].rect;\n\t\t\tif( data == null ) {\n\t\t\t\tthis.setVertices( iv, vertices, 0, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 0, textureUvs );\n\t\t\t\tthis.setColorsWhite( ic, colors );\n\t\t\t\tthis.setVertices( iv + 4, vertices, 1, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 1, textureUvs );\n\t\t\t\tthis.setColorsWhite( ic + 8, colors );\n\t\t\t\tthis.newIndices( ii, nv, 1, indices );\n\t\t\t\tiv += 4 * 2;\n\t\t\t\tic += 4 * 4;\n\t\t\t\tnv += 4;\n\t\t\t\tii += 6;\n\t\t\t} else {\n\t\t\t\tthis.setVertices( iv, vertices, 0, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 0, textureUvs );\n\t\t\t\tthis.setColorsPoint( ic, data, 0, colors );\n\t\t\t\tiv += 2 * 2;\n\t\t\t\tic += 2 * 4;\n\t\t\t\tconst pointSize = data.points.length;\n\t\t\t\tfor( let j = 0, jmax = Math.min( pointSize, this._nPointsPerData ); j < jmax; ++j ) {\n\t\t\t\t\tconst point = data.points[ j ];\n\t\t\t\t\tthis.setVertices( iv, vertices, point.position, rect );\n\t\t\t\t\tthis.setUvs( iv, uvs, point.position, textureUvs );\n\t\t\t\t\tthis.setColorsHex( ic, colors, point.color, point.alpha );\n\t\t\t\t\tiv += 2 * 2;\n\t\t\t\t\tic += 2 * 4;\n\t\t\t\t}\n\t\t\t\tthis.setVertices( iv, vertices, 1, rect );\n\t\t\t\tthis.setUvs( iv, uvs, 1, textureUvs );\n\t\t\t\tthis.setColorsPoint( ic, data, pointSize - 1, colors );\n\t\t\t\tiv += 2 * 2;\n\t\t\t\tic += 2 * 4;\n\n\t\t\t\tthis.newIndices( ii, nv, pointSize + 1, indices );\n\t\t\t\tii += (pointSize + 1) * 6;\n\t\t\t\tnv += (pointSize + 2) * 2;\n\t\t\t}\n\t\t}\n\n\t\tthis.size = ii;\n\n\t\tconst geometry = this.geometry;\n\t\tgeometry.getBuffer( \"aPosition\" ).update();\n\t\tgeometry.getBuffer( \"aUv\" ).update();\n\t\tgeometry.getBuffer( \"aColor\" ).update();\n\t\tgeometry.getIndex().update();\n\t}\n\n\tcontainsPoint( point: Point ): boolean {\n\t\tconst local = this.toLocal( point, undefined, this._workPoint );\n\t\tconst parts = this._parts;\n\t\tfor( let i = 0, imax = parts.length; i < imax; ++i ) {\n\t\t\tconst rect = parts[ i ].rect;\n\t\t\tif( rect.contains( local.x, local.y ) ) {\n\t\t\t\tthis._lastHitIndex = i;\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tstatic from(\n\t\tsize: number,\n\t\tnPointsPerData: number,\n\t\tcheckerColors: [ number, number ],\n\t\ttexture: Texture = Texture.WHITE\n\t) {\n\t\tconst vertices = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 2 );\n\t\tconst uvs = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 2 );\n\t\tconst colors = new Float32Array( size * ( nPointsPerData + 2 ) * 2 * 4 );\n\t\tconst indices = new Uint16Array( size * ( nPointsPerData + 1 ) * 6 );\n\n\t\tconst parts: Parts = [];\n\t\tfor( let i = 0; i < size; ++i ) {\n\t\t\tparts.push({\n\t\t\t\tdata: null,\n\t\t\t\trect: new Rectangle()\n\t\t\t});\n\t\t}\n\n\t\tconst geometry = new Geometry()\n\t\t\t.addIndex( new Buffer( indices, false, true ) )\n\t\t\t.addAttribute( \"aPosition\", new Buffer( vertices, false, false ), 2 )\n\t\t\t.addAttribute( \"aUv\", new Buffer( uvs, false, false ), 2 )\n\t\t\t.addAttribute( \"aColor\", new Buffer( colors, false, false ), 4 );\n\t\tconst shader = Shader.from( VERTEX_SHADER, FRAGMENT_SHADER, { uSampler: texture, uCheckerColors: checkerColors } );\n\n\t\treturn new DPickerColorGradientView(\n\t\t\tnPointsPerData,\n\t\t\tvertices, uvs, colors, indices,\n\t\t\tparts, geometry, shader\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Sprite, Texture } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DAlignWith } from \"./d-align-with\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DColorGradient, DColorGradientPoint } from \"./d-color-gradient\";\nimport { DColorGradientObservable } from \"./d-color-gradient-observable\";\nimport { DInputReal } from \"./d-input-real\";\nimport { DPickerColor } from \"./d-picker-color\";\nimport { DPickerColorGradientRecent } from \"./d-picker-color-gradient-recent\";\nimport { DPickerColorGradientView } from \"./d-picker-color-gradient-view\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DPickerColorGradientOptions<\n\tTHEME extends DThemePickerColorGradient = DThemePickerColorGradient\n> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerColorGradient extends DThemeBase {\n\tgetGradientPointsWidth(): number;\n\tgetGradientPointsMargin(): number;\n\n\tgetGradientAnchorTexture(): Texture;\n\tgetGradientAnchorOutlinedTexture(): Texture;\n\tgetGradientAnchorOutlineTexture(): Texture;\n\n\tgetGradientDirectionMargin(): number;\n\tgetGradientDirectionTexture(): Texture;\n\n\tgetGradientRecentColumn(): number;\n\tgetGradientRecentWidth(): number;\n\tgetGradientRecentMargin(): number;\n\tgetGradientRecentCount(): number;\n\tgetGradientRecents(): DColorGradient[];\n\n\tgetGradientCheckerColors(): [ number, number ];\n}\n\nexport class DPickerColorGradient<\n\tTHEME extends DThemePickerColorGradient = DThemePickerColorGradient,\n\tOPTIONS extends DPickerColorGradientOptions<THEME> = DPickerColorGradientOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static RECENT_COLOR_GRADIENT: DPickerColorGradientRecent | null = null;\n\n\tprotected _picker!: DPickerColor;\n\tprotected _view!: DPickerColorGradientView;\n\tprotected _anchors!: Sprite[];\n\tprotected _recent!: DPickerColorGradientRecent;\n\n\tprotected _onAnchorDownBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAnchorMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onAnchorUpBound!: ( e: InteractionEvent ) => void;\n\n\tprotected _value!: DColorGradientObservable;\n\tprotected _work!: Point;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.state.isFocusable = false;\n\n\t\tconst theme = this.theme;\n\t\tconst padding = this._padding;\n\t\tconst paddingTop = padding.getTop();\n\t\tconst paddingRight = padding.getRight();\n\t\tconst paddingBottom = padding.getBottom();\n\t\tconst paddingLeft = padding.getLeft();\n\t\tthis._work = new Point();\n\n\t\t// Picker\n\t\tconst gradientPointsWidth = theme.getGradientPointsWidth();\n\t\tconst gradientPointsMargin = theme.getGradientPointsMargin();\n\t\tconst picker = this._picker = new DPickerColor({\n\t\t\tx: paddingLeft + gradientPointsWidth + gradientPointsMargin,\n\t\t\ty: paddingTop\n\t\t});\n\t\tpicker.on( \"newcolorchange\", ( color: number ): void => {\n\t\t\tthis.onAnchorColorChange( color );\n\t\t});\n\t\tpicker.on( \"newalphachange\", ( alpha: number ): void => {\n\t\t\tthis.onAnchorAlphaChange( alpha );\n\t\t});\n\t\tthis.addChild( picker );\n\n\t\t// Points view\n\t\tconst view = this._view = DPickerColorGradientView.from( 17, 10, theme.getGradientCheckerColors() );\n\t\tview.setRectangle( 0, paddingLeft, paddingTop, gradientPointsWidth, picker.height );\n\t\tthis.addChild( view );\n\t\tview.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( view.getLastHitIndex() === 0 ) {\n\t\t\t\tthis.onViewDown( e );\n\t\t\t}\n\t\t});\n\n\t\t// Anchor\n\t\tthis._onAnchorDownBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorDown( e );\n\t\t};\n\t\tthis._onAnchorMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorMove( e );\n\t\t};\n\t\tthis._onAnchorUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onAnchorUp( e );\n\t\t};\n\t\tthis._anchors = [];\n\n\t\t//\n\t\tconst inputLabelWidth = picker.theme.getInputLabelWidth();\n\t\tconst inputWidth = picker.theme.getMainWidth() * 0.5;\n\t\tconst inputMargin = 5;\n\t\tconst inputDirectionMargin = theme.getGradientDirectionMargin();\n\t\tconst inputDirectionTexture = theme.getGradientDirectionTexture();\n\t\tconst inputLeft = picker.x + picker.width + inputDirectionMargin;\n\t\tconst inputDirection = new DInputReal({\n\t\t\tparent: this,\n\t\t\tx: inputLeft + inputLabelWidth + inputMargin,\n\t\t\ty: paddingTop,\n\t\t\twidth: inputWidth - inputLabelWidth - inputMargin,\n\t\t\tstep: 1,\n\t\t\timage: {\n\t\t\t\tsource: inputDirectionTexture,\n\t\t\t\talign: {\n\t\t\t\t\twith: DAlignWith.BORDER\n\t\t\t\t},\n\t\t\t\tmargin: {\n\t\t\t\t\thorizontal: -inputDirectionTexture.width - inputMargin\n\t\t\t\t}\n\t\t\t},\n\t\t\ton: {\n\t\t\t\tchange: ( value: number ) => {\n\t\t\t\t\t(this._value as any)._direction = value;\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Recent gradients\n\t\tconst recentColumn = theme.getGradientRecentColumn();\n\t\tconst recentWidth = theme.getGradientRecentWidth();\n\t\tconst recentMargin = theme.getGradientRecentMargin();\n\t\tconst recentWidthAndMargin = recentWidth + recentMargin;\n\t\tconst x0 = inputLeft;\n\t\tconst y0 = inputDirection.y + inputDirection.height + inputDirectionMargin;\n\t\tif( DPickerColorGradient.RECENT_COLOR_GRADIENT == null ) {\n\t\t\tDPickerColorGradient.RECENT_COLOR_GRADIENT = new DPickerColorGradientRecent(\n\t\t\t\ttheme.getGradientRecents(),\n\t\t\t\ttheme.getGradientRecentCount()\n\t\t\t);\n\t\t}\n\t\tthis._recent = DPickerColorGradient.RECENT_COLOR_GRADIENT;\n\t\tconst recent = this._recent;\n\t\tfor( let i = 0, imax = recent.getCapacity(); i < imax; ++i ) {\n\t\t\tconst ix = i % recentColumn;\n\t\t\tconst x = x0 + ix * recentWidthAndMargin;\n\t\t\tconst iy = (i / recentColumn) | 0;\n\t\t\tconst y = y0 + iy * recentWidthAndMargin;\n\t\t\tview.setRectangle( 1 + i, x, y, recentWidth, recentWidth );\n\t\t}\n\t\trecent.on( \"change\", (): void => {\n\t\t\tthis.onRecentUpdate();\n\t\t});\n\t\tUtilPointerEvent.onClick( view, ( e: InteractionEvent ): void => {\n\t\t\tconst lastHitIndex = view.getLastHitIndex();\n\t\t\tif( 1 <= lastHitIndex ) {\n\t\t\t\tthis.onRecentClick( view.getData( lastHitIndex ) );\n\t\t\t}\n\t\t});\n\n\t\t// Points\n\t\tconst data = this._value = new DColorGradientObservable();\n\t\tdata.on( \"change\", (): void => {\n\t\t\tthis.updateAnchors();\n\t\t\tview.update();\n\t\t});\n\t\tdata.on( \"selectionchange\", ( point: DColorGradientPoint ): void => {\n\t\t\tthis.onAnchorSelect( point );\n\t\t});\n\t\tdata.on( \"directionchange\", ( value: number ): void => {\n\t\t\tinputDirection.value = value;\n\t\t});\n\t\tview.setData( 0, data );\n\t\tview.update();\n\t\tinputDirection.value = data.direction;\n\t\tthis.updateAnchors();\n\t\tconst selected = data.selected;\n\t\tif( selected != null ) {\n\t\t\tthis.onAnchorSelect( selected );\n\t\t}\n\n\t\t// Width\n\t\tif( options == null || options.width == null ) {\n\t\t\tthis.width = paddingLeft + gradientPointsWidth + gradientPointsMargin +\n\t\t\t\tpicker.width + inputDirectionMargin + (recentColumn - 1) * recentMargin +\n\t\t\t\trecentColumn * recentWidth + paddingRight;\n\t\t}\n\n\t\t// Height\n\t\tif( options == null || options.height == null ) {\n\t\t\tthis.height = paddingTop + picker.height + paddingBottom;\n\t\t}\n\t}\n\n\tget value(): DColorGradientObservable {\n\t\treturn this._value;\n\t}\n\n\tget recent() {\n\t\treturn this._recent;\n\t}\n\n\tprotected onRecentClick( recentData: DColorGradient | null ) {\n\t\tconst value = this._value;\n\t\tif( recentData != null ) {\n\t\t\tvalue.fromObject( recentData );\n\t\t} else {\n\t\t\tvalue.reset();\n\t\t}\n\t}\n\n\tprotected onRecentUpdate() {\n\t\tconst recent = this._recent;\n\t\tconst view = this._view;\n\t\tfor( let i = 0, imax = recent.size(); i < imax; ++i ) {\n\t\t\tview.setData( 1 + i, recent.get( i ) );\n\t\t}\n\t\tview.update();\n\t\tDApplications.update( this );\n\t}\n\n\tprotected toAnchorPosition( e: InteractionEvent ) {\n\t\tconst local = this.toLocal( e.data.global, undefined, this._work );\n\t\treturn Math.max( 0, Math.min( 1, (local.y - this.padding.getTop()) / this._picker.height ) );\n\t}\n\n\tprotected onViewDown( e: InteractionEvent ) {\n\t\tthis._value.addAt( this.toAnchorPosition( e ) );\n\t\tthis.onAnchorDragStart();\n\t}\n\n\tprotected onAnchorDown( e: InteractionEvent ) {\n\t\tconst target = e.target;\n\t\tif( target instanceof Sprite ) {\n\t\t\tconst value = this._value;\n\t\t\tconst index = this._anchors.indexOf( target );\n\t\t\tif( 0 <= index && index < value.points.length ) {\n\t\t\t\tvalue.points[ index ].selected = true;\n\t\t\t\tthis.onAnchorDragStart();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorSelect( point: DColorGradientPoint ) {\n\t\tconst picker = this._picker;\n\t\tpicker.current.color = point.color;\n\t\tpicker.current.alpha = point.alpha;\n\t\tpicker.new.color = point.color;\n\t\tpicker.new.alpha = point.alpha;\n\t}\n\n\tprotected onAnchorColorChange( color: number ) {\n\t\tconst value = this._value;\n\t\tif( value != null ) {\n\t\t\tconst selected = value.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.color = color;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorAlphaChange( alpha: number ) {\n\t\tconst value = this._value;\n\t\tif( value != null ) {\n\t\t\tconst selected = value.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.alpha = alpha;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorDragStart() {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.on( UtilPointerEvent.move, this._onAnchorMoveBound );\n\t\t\tstage.on( UtilPointerEvent.up, this._onAnchorUpBound );\n\t\t}\n\t}\n\n\tprotected onAnchorMove( e: InteractionEvent ): void {\n\t\tconst value = this._value;\n\t\tif( value != null ) {\n\t\t\tconst selected = value.selected;\n\t\t\tif( selected != null ) {\n\t\t\t\tselected.position = this.toAnchorPosition( e );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onAnchorUp( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst stage = layer.stage;\n\t\t\tstage.off( UtilPointerEvent.move, this._onAnchorMoveBound );\n\t\t\tstage.off( UtilPointerEvent.up, this._onAnchorUpBound );\n\t\t}\n\t}\n\n\tprotected updateAnchors() {\n\t\tconst theme = this.theme;\n\t\tconst anchorTexture = theme.getGradientAnchorTexture();\n\t\tconst anchorOutlinedTexture = theme.getGradientAnchorOutlinedTexture();\n\t\tconst gradientPointsWidth = theme.getGradientPointsWidth();\n\n\t\tconst value = this._value;\n\t\tconst pointSize = value.points.length;\n\n\t\tconst anchors = this._anchors;\n\t\tconst anchorSize = anchors.length;\n\t\tfor( let i = anchorSize; i < pointSize; ++i ) {\n\t\t\tconst newAnchor = new Sprite( anchorTexture );\n\t\t\tnewAnchor.anchor.set( 0.5, 0.5 );\n\t\t\tnewAnchor.cursor = \"pointer\";\n\t\t\tnewAnchor.interactive = true;\n\t\t\tnewAnchor.on( UtilPointerEvent.down, this._onAnchorDownBound );\n\t\t\tanchors.push( newAnchor );\n\t\t\tthis.addChild( newAnchor );\n\t\t}\n\n\t\tfor( let i = anchorSize - 1; pointSize <= i; --i ) {\n\t\t\tconst oldAnchor = anchors[ i ];\n\t\t\toldAnchor.off( UtilPointerEvent.down, this._onAnchorDownBound );\n\t\t\toldAnchor.destroy();\n\t\t}\n\t\tanchors.length = pointSize;\n\n\t\tconst y = this.padding.getTop();\n\t\tconst right = this.padding.getLeft() + gradientPointsWidth;\n\t\tconst height = this._picker.height;\n\t\tfor( let i = 0; i < pointSize; ++i ) {\n\t\t\tconst point = value.points[ i ];\n\t\t\tconst anchor = anchors[ i ];\n\t\t\tanchor.tint = point.color;\n\t\t\tanchor.position.set(\n\t\t\t\tright,\n\t\t\t\ty + height * point.position\n\t\t\t);\n\t\t\tanchor.texture = (point.selected ? anchorOutlinedTexture : anchorTexture);\n\t\t}\n\n\t\tDApplications.update( this );\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isDeleteKey( e ) ) {\n\t\t\tconst value = this._value;\n\t\t\tif( value != null ) {\n\t\t\t\tconst selected = value.selected;\n\t\t\t\tif( selected != null ) {\n\t\t\t\t\tvalue.remove( selected );\n\t\t\t\t\tsuper.onKeyDown( e );\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPickerColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorGradient } from \"./d-color-gradient\";\nimport { DColorGradientObservable } from \"./d-color-gradient-observable\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerColorGradient, DPickerColorGradientOptions } from \"./d-picker-color-gradient\";\nimport { DPickerColorGradientRecent } from \"./d-picker-color-gradient-recent\";\n\nexport interface DDialogColorGradientOptions<\n\tTHEME extends DThemeDialogColorGradient = DThemeDialogColorGradient\n> extends DDialogCommandOptions<DColorGradient, THEME> {\n\tpicker?: DPickerColorGradientOptions;\n}\n\nexport interface DThemeDialogColorGradient extends DThemeDialogCommand {\n\n}\n\nexport class DDialogColorGradient<\n\tTHEME extends DThemeDialogColorGradient = DThemeDialogColorGradient,\n\tOPTIONS extends DDialogColorGradientOptions<THEME> = DDialogColorGradientOptions<THEME>\n> extends DDialogCommand<DColorGradient, THEME, OPTIONS> {\n\tprotected _picker?: DPickerColorGradient;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tlayout.addChild( this.picker );\n\t}\n\n\tprotected onOk( value: DColorGradient | PromiseLike<DColorGradient> ): void {\n\t\tsuper.onOk( value );\n\n\t\tconst picker = this.picker;\n\t\tconst data = picker.value;\n\t\tconst recent = picker.recent;\n\t\tif( ! recent.contains( data ) ) {\n\t\t\trecent.add( data.toObject() );\n\t\t}\n\t}\n\n\tget value(): DColorGradientObservable {\n\t\treturn this.picker.value;\n\t}\n\n\tget recent(): DPickerColorGradientRecent {\n\t\treturn this.picker.recent;\n\t}\n\n\tget picker(): DPickerColorGradient {\n\t\tlet result = this._picker;\n\t\tif( result == null ) {\n\t\t\tresult = new DPickerColorGradient( this._options?.picker );\n\t\t\tthis._picker = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getResolvedValue(): DColorGradient | PromiseLike<DColorGradient> {\n\t\treturn this.picker.value;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tthis.picker.onKeyDown( e );\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Texture } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DButton, DButtonEvents, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DColorGradientObservable } from \"./d-color-gradient-observable\";\nimport { DDialogColorGradient, DDialogColorGradientOptions } from \"./d-dialog-color-gradient\";\nimport { DPickerColorGradientView } from \"./d-picker-color-gradient-view\";\n\n/**\n * {@link DButtonColorGradient} events.\n */\nexport interface DButtonColorGradientEvents<EMITTER> extends DButtonEvents<DColorGradientObservable, EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param newValue a newly selected value\n\t * @param oldValue a previously selected value\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: DColorGradientObservable, oldValue: DColorGradientObservable, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonColorGradient} \"on\" options.\n */\nexport interface DButtonColorGradientOnOptions<EMITTER> extends Partial<DButtonColorGradientEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButtonColorGradient} options.\n */\nexport interface DButtonColorGradientOptions<\n\tTHEME extends DThemeButtonColorGradient = DThemeButtonColorGradient,\n\tEMITTER = any\n> extends DButtonOptions<DColorGradientObservable, THEME, EMITTER> {\n\tdialog?: DDialogColorGradientOptions;\n\ton?: DButtonColorGradientOnOptions<EMITTER>;\n}\n\n/**\n * {@link DButtonColorGradient} theme.\n */\nexport interface DThemeButtonColorGradient extends DThemeButton<DColorGradientObservable> {\n\tgetViewBaseTexture(): Texture | null;\n\tgetCheckerColors(): [ number, number ];\n}\n\nexport class DButtonColorGradient<\n\tTHEME extends DThemeButtonColorGradient = DThemeButtonColorGradient,\n\tOPTIONS extends DButtonColorGradientOptions<THEME> = DButtonColorGradientOptions<THEME>\n> extends DButton<DColorGradientObservable, THEME, OPTIONS> {\n\tprotected static DIALOG?: DDialogColorGradient;\n\tprotected _dialog?: DDialogColorGradient;\n\tprotected _view?: DPickerColorGradientView;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst source = options?.image?.source;\n\t\tif( source === undefined ) {\n\t\t\tconst theme = this.theme;\n\t\t\tconst texture = theme.getViewBaseTexture();\n\t\t\tif( texture instanceof Texture ) {\n\t\t\t\tconst checkers = theme.getCheckerColors();\n\t\t\t\tconst view = this._view = DPickerColorGradientView.from( 1, 10, checkers, texture );\n\t\t\t\tview.setRectangle( 0, 0, 0, texture.width, texture.height );\n\t\t\t\tview.setData( 0, this._textValueComputed! );\n\t\t\t\tview.update();\n\t\t\t\tthis.image = view;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed!;\n\t\tconst dialog = this.dialog;\n\t\tdialog.value.fromObject( value );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = dialog.value;\n\t\t\tconst oldValue = new DColorGradientObservable().fromObject( value );\n\t\t\tvalue.fromObject( newValue );\n\t\t\tconst view = this._view;\n\t\t\tif( view != null ) {\n\t\t\t\tview.update();\n\t\t\t}\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t\tDApplications.update( this );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t});\n\t}\n\n\tget dialog(): DDialogColorGradient {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options ) {\n\t\t\t\tdialog = new DDialogColorGradient( options );\n\t\t\t} else {\n\t\t\t\tif( DButtonColorGradient.DIALOG == null ) {\n\t\t\t\t\tDButtonColorGradient.DIALOG = new DDialogColorGradient();\n\t\t\t\t}\n\t\t\t\tdialog = DButtonColorGradient.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): DColorGradientObservable {\n\t\treturn this._textValueComputed!;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonColorGradient\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DColorAndAlpha } from \"./d-color-and-alpha\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DPickerColor, DPickerColorOptions } from \"./d-picker-color\";\nimport { DPickerColorRecent } from \"./d-picker-color-recent\";\n\nexport interface DDialogColorOptions<\n\tTHEME extends DThemeDialogColor = DThemeDialogColor\n> extends DDialogCommandOptions<DColorAndAlpha, THEME> {\n\tpicker?: DPickerColorOptions;\n}\n\nexport interface DThemeDialogColor extends DThemeDialogCommand {\n\n}\n\nexport class DDialogColor<\n\tTHEME extends DThemeDialogColor = DThemeDialogColor,\n\tOPTIONS extends DDialogColorOptions<THEME> = DDialogColorOptions<THEME>\n> extends DDialogCommand<DColorAndAlpha, THEME, OPTIONS> {\n\tprotected _picker?: DPickerColor;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tlayout.addChild( this.picker );\n\t}\n\n\tprotected onOk( value: DColorAndAlpha | PromiseLike<DColorAndAlpha> ): void {\n\t\tsuper.onOk( value );\n\n\t\tconst picker = this.picker;\n\t\tconst recent = picker.recent;\n\t\tif( ! recent.contains( picker.new ) ) {\n\t\t\trecent.add( picker.new );\n\t\t}\n\t}\n\n\tget current(): DColorAndAlpha {\n\t\treturn this.picker.current;\n\t}\n\n\tget new(): DColorAndAlpha {\n\t\treturn this.picker.new;\n\t}\n\n\tget recent(): DPickerColorRecent {\n\t\treturn this.picker.recent;\n\t}\n\n\tget picker(): DPickerColor {\n\t\tlet result = this._picker;\n\t\tif( result == null ) {\n\t\t\tresult = new DPickerColor( this._options?.picker );\n\t\t\tthis._picker = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getResolvedValue(): DColorAndAlpha | PromiseLike<DColorAndAlpha> {\n\t\treturn this.picker.new;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DButton, DButtonEvents, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DColorAndAlpha } from \"./d-color-and-alpha\";\nimport { DDialogColor, DDialogColorOptions } from \"./d-dialog-color\";\nimport { DImagePieceOptions, DImagePieceTintOptions } from \"./d-image-piece\";\nimport { DPickerColorAndAlpha } from \"./d-picker-color-and-alpha\";\n\n/**\n * {@link DButtonColor} events.\n */\nexport interface DButtonColorEvents<EMITTER> extends DButtonEvents<DColorAndAlpha, EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param newValue a newly selected value\n\t * @param oldValue a previously selected value\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: DColorAndAlpha, oldValue: DColorAndAlpha, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonColor} \"on\" options.\n */\nexport interface DButtonColorOnOptions<EMITTER>\textends Partial<DButtonColorEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButtonColor} options.\n */\nexport interface DButtonColorOptions<\n\tTHEME extends DThemeButtonColor = DThemeButtonColor,\n\tEMITTER = any\n> extends DButtonOptions<DColorAndAlpha, THEME, EMITTER> {\n\t/**\n\t * A dialog to pick a color.\n\t */\n\tdialog?: DDialogColorOptions;\n\n\ton?: DButtonColorOnOptions<EMITTER>;\n}\n\n/**\n * {@link DButtonColor} theme.\n */\nexport interface DThemeButtonColor extends DThemeButton<DColorAndAlpha> {\n\n}\n\nexport class DButtonColor<\n\tTHEME extends DThemeButtonColor = DThemeButtonColor,\n\tOPTIONS extends DButtonColorOptions<THEME> = DButtonColorOptions<THEME>\n> extends DButton<DColorAndAlpha, THEME, OPTIONS> {\n\tprotected static DIALOG?: DDialogColor;\n\tprotected _dialog?: DDialogColor;\n\tprotected _value!: DPickerColorAndAlpha;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst value = this._textValueComputed!;\n\t\tthis._value = new DPickerColorAndAlpha( value, ( color: number ): void => {\n\t\t\tvalue.color = color;\n\t\t\tthis.onColorChange();\n\t\t}, ( alpha: number ): void => {\n\t\t\tvalue.alpha = alpha;\n\t\t\tthis.updateTextForcibly();\n\t\t});\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed!;\n\t\tconst dialog = this.dialog;\n\t\tconst dialogCurrent = dialog.current;\n\t\tconst dialogNew = dialog.new;\n\t\tdialogCurrent.color = value.color;\n\t\tdialogCurrent.alpha = value.alpha;\n\t\tdialogNew.color = value.color;\n\t\tdialogNew.alpha = value.alpha;\n\t\tdialog.open().then((): void => {\n\t\t\tvalue.color = dialogNew.color;\n\t\t\tvalue.alpha = dialogNew.alpha;\n\t\t\tthis.onColorChange();\n\t\t\tthis.onValueChange(\n\t\t\t\tthis.toClone( dialogNew ),\n\t\t\t\tthis.toClone( dialogCurrent )\n\t\t\t);\n\t\t});\n\t}\n\n\tprotected toClone( value: DColorAndAlpha ): DColorAndAlpha {\n\t\treturn {\n\t\t\tcolor: value.color,\n\t\t\talpha: value.alpha\n\t\t};\n\t}\n\n\tprotected onValueChange( newValue: DColorAndAlpha, oldValue: DColorAndAlpha ): void {\n\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t}\n\n\tprotected toImageTintOptions( tint?: DImagePieceTintOptions ): DImagePieceTintOptions {\n\t\tconst color = () => this._textValueComputed!.color;\n\t\tif( tint ) {\n\t\t\treturn {\n\t\t\t\tcolor: tint.color || color,\n\t\t\t\talpha: tint.alpha\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tcolor\n\t\t};\n\t}\n\n\tprotected toImageOptions( theme: THEME, options?: DImagePieceOptions ): DImagePieceOptions | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\tsource: options.source,\n\t\t\t\ttint: this.toImageTintOptions( options.tint ),\n\t\t\t\talign: options.align,\n\t\t\t\tmargin: options.margin\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\ttint: this.toImageTintOptions()\n\t\t};\n\t}\n\n\tprotected onColorChange(): void {\n\t\tif( this._images[ 0 ].updateTint() ) {\n\t\t\tDApplications.update( this );\n\t\t}\n\t\tthis.updateTextForcibly();\n\t}\n\n\tprotected updateTextForcibly(): void {\n\t\tthis.onTextChange();\n\t\tthis.createOrUpdateText();\n\t}\n\n\tget dialog(): DDialogColor {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options != null ) {\n\t\t\t\tdialog = new DDialogColor( options );\n\t\t\t} else {\n\t\t\t\tif( DButtonColor.DIALOG == null ) {\n\t\t\t\t\tDButtonColor.DIALOG = new DDialogColor();\n\t\t\t\t}\n\t\t\t\tdialog = DButtonColor.DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): DColorAndAlpha {\n\t\treturn this._value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonDanger extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonDanger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDate } from \"./d-dialog-date\";\n\nexport class DDialogDates {\n\tprotected static INSTANCE?: DDialogDate;\n\tstatic getInstance(): DDialogDate {\n\t\tif( DDialogDates.INSTANCE == null ) {\n\t\t\tDDialogDates.INSTANCE = new DDialogDate();\n\t\t}\n\t\treturn DDialogDates.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonEvents, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDate, DDialogDateOptions } from \"./d-dialog-date\";\nimport { DDialogDates } from \"./d-dialog-dates\";\n\n/**\n * {@link DButtonDate} events.\n */\nexport interface DButtonDateEvents<EMITTER> extends DButtonEvents<Date, EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param newValue a newly selected value\n\t * @param oldValue a previously selected value\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: Date, oldValue: Date, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonDate} \"on\" options.\n */\nexport interface DButtonDateOnOptions<EMITTER> extends Partial<DButtonDateEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButtonDate} options.\n */\nexport interface DButtonDateOptions<\n\tTHEME extends DThemeButtonDate = DThemeButtonDate,\n\tEMITTER = any\n> extends DButtonOptions<Date, THEME, EMITTER> {\n\tdialog?: DDialogDateOptions;\n\ton?: DButtonDateOnOptions<EMITTER>;\n}\n\n/**\n * {@link DButtonDate} theme.\n */\nexport interface DThemeButtonDate extends DThemeButton<Date> {\n\n}\n\nexport class DButtonDate<\n\tTHEME extends DThemeButtonDate = DThemeButtonDate,\n\tOPTIONS extends DButtonDateOptions<THEME> = DButtonDateOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogDate;\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed?.getTime() ?? Date.now();\n\t\tconst dialog = this.dialog;\n\t\tdialog.current = new Date( value );\n\t\tdialog.new = new Date( value );\n\t\tdialog.page = new Date( value );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = dialog.new;\n\t\t\tconst oldValue = dialog.current;\n\t\t\tthis.text = new Date( newValue.getTime() );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t});\n\t}\n\n\tget dialog(): DDialogDate {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options ) {\n\t\t\t\tdialog = new DDialogDate( options );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDates.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed ?? new Date();\n\t}\n\n\tset value( value: Date ) {\n\t\tconst textValueComputed = this._textValueComputed;\n\t\tif( textValueComputed === undefined || textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogDatetime } from \"./d-dialog-datetime\";\n\nexport class DDialogDatetimes {\n\tprotected static INSTANCE?: DDialogDatetime;\n\tstatic getInstance(): DDialogDatetime {\n\t\tif( DDialogDatetimes.INSTANCE == null ) {\n\t\t\tDDialogDatetimes.INSTANCE = new DDialogDatetime();\n\t\t}\n\t\treturn DDialogDatetimes.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { toPadded } from \"./util/to-padded\";\n\nexport class DPickerDates {\n\tstatic format( date: Date ): string {\n\t\tconst y = toPadded( String( date.getFullYear() ), 4, \"0\" );\n\t\tconst M = toPadded( String( date.getMonth() + 1 ), 2, \"0\");\n\t\tconst S = toPadded( String( date.getDate() ), 2, \"0\" );\n\t\treturn `${y}/${M}/${S}`;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimeMaskOptions, DPickerDatetimeMasks } from \"./d-picker-datetime-masks\";\nimport { toPadded } from \"./util/to-padded\";\n\nexport class DPickerTimes {\n\tstatic format( date: Date, mask: DPickerDatetimeMask ): string {\n\t\tlet result = \"\";\n\t\tif( mask & DPickerDatetimeMask.HOURS ) {\n\t\t\tresult += toPadded( String( date.getHours() ), 2, \"0\" );\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.MINUTES ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult += \":\";\n\t\t\t}\n\t\t\tresult += toPadded( String( date.getMinutes() ), 2, \"0\" );\n\t\t}\n\t\tif( mask & DPickerDatetimeMask.SECONDS ) {\n\t\t\tif( 0 < result.length ) {\n\t\t\t\tresult += \":\";\n\t\t\t}\n\t\t\tresult += toPadded( String( date.getSeconds() ), 2, \"0\" );\n\t\t}\n\t\treturn result;\n\t}\n\n\tstatic toMask( options?: DPickerDatetimeMaskOptions ) {\n\t\treturn DPickerDatetimeMasks.from( \"DPickerTime\", options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DPickerDates } from \"./d-picker-dates\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimeMaskOptions, DPickerDatetimeMasks } from \"./d-picker-datetime-masks\";\nimport { DPickerTimes } from \"./d-picker-times\";\n\nexport class DPickerDatetimes {\n\tstatic format( date: Date, mask: DPickerDatetimeMask ): string {\n\t\tconst hms = DPickerTimes.format( date, mask );\n\t\tif( 0 < hms.length ) {\n\t\t\treturn `${DPickerDates.format( date )} ${hms}`;\n\t\t} else {\n\t\t\treturn `${DPickerDates.format( date )}`;\n\t\t}\n\t}\n\n\tstatic toMask( options?: DPickerDatetimeMaskOptions ) {\n\t\treturn DPickerDatetimeMasks.from( \"DPickerDatetime\", options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonEvents, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDatetime, DDialogDatetimeOptions } from \"./d-dialog-datetime\";\nimport { DDialogDatetimes } from \"./d-dialog-datetimes\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimes } from \"./d-picker-datetimes\";\n\n/**\n * {@link DButtonDatetime} events.\n */\nexport interface DButtonDatetimeEvents<EMITTER> extends DButtonEvents<Date, EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: Date, oldValue: Date, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonDatetime} \"on\" options.\n */\nexport interface DButtonDatetimeOnOptions<EMITTER> extends Partial<DButtonDatetimeEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButtonDatetime} options.\n */\nexport interface DButtonDatetimeOptions<\n\tTHEME extends DThemeButtonDatetime = DThemeButtonDatetime,\n\tEMITTER = any\n> extends DButtonOptions<Date, THEME, EMITTER> {\n\tdialog?: DDialogDatetimeOptions;\n\ton?: DButtonDatetimeOnOptions<EMITTER>;\n}\n\n/**\n * {@link DButtonDatetime} theme.\n */\nexport interface DThemeButtonDatetime extends DThemeButton<Date> {\n\n}\n\nexport class DButtonDatetime<\n\tTHEME extends DThemeButtonDatetime = DThemeButtonDatetime,\n\tOPTIONS extends DButtonDatetimeOptions<THEME> = DButtonDatetimeOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogDatetime;\n\tprotected _datetimeMask?: DPickerDatetimeMask;\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed?.getTime() ?? Date.now();\n\t\tconst dialog = this.dialog;\n\t\tdialog.current = new Date( value );\n\t\tdialog.new = new Date( value );\n\t\tdialog.page = new Date( value );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = dialog.new;\n\t\t\tconst oldValue = dialog.current;\n\t\t\tthis.text = new Date( newValue.getTime() );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\tlet result = this._datetimeMask;\n\t\tif( result == null ) {\n\t\t\tresult = DPickerDatetimes.toMask( this._options?.dialog?.picker );\n\t\t\tthis._datetimeMask = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tget dialog(): DDialogDatetime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options ) {\n\t\t\t\tdialog = new DDialogDatetime( options );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDatetimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed ?? new Date();\n\t}\n\n\tset value( value: Date ) {\n\t\tconst textValueComputed = this._textValueComputed;\n\t\tif( textValueComputed === undefined || textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonEvents, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { toEnum } from \"./util/to-enum\";\nimport { UtilFileAs, UtilFileEvents, UtilFileOpener } from \"./util/util-file-opener\";\n\nexport import DButtonFileAs = UtilFileAs;\n\n/**\n * {@link DButtonFile} events.\n */\nexport interface DButtonFileEvents<VALUE, EMITTER> extends DButtonEvents<VALUE, EMITTER>, UtilFileEvents<EMITTER> {\n\n}\n\n/**\n * {@link DButtonFile} \"on\" options.\n */\nexport interface DButtonFileOnOptions<VALUE, EMITTER> extends Partial<DButtonFileEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\nexport type DButtonFileChecker = () => Promise<unknown> | boolean;\n\n/**\n * {@link DButtonFile} options.\n */\nexport interface DButtonFileOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonFile<VALUE> = DThemeButtonFile<VALUE>,\n\tEMITTER = any\n> extends DButtonOptions<VALUE, THEME, EMITTER> {\n\t/**\n\t * An output format.\n\t */\n\tas?: (keyof typeof UtilFileAs) | UtilFileAs;\n\n\t/**\n\t * A checker called before opening a file.\n\t * If the checker returns false or the returned promise object is rejected,\n\t * files will not be opened.\n\t */\n\tchecker?: DButtonFileChecker;\n\n\ton?: DButtonFileOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DButtonFile} theme.\n */\nexport interface DThemeButtonFile<VALUE = unknown> extends DThemeButton<VALUE> {\n\n}\n\n/**\n * A file selector.\n */\nexport class DButtonFile<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonFile<VALUE> = DThemeButtonFile<VALUE>,\n\tOPTIONS extends DButtonFileOptions<VALUE, THEME> = DButtonFileOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected _checker?: DButtonFileChecker | null;\n\tprotected _opener?: UtilFileOpener;\n\n\tprotected getChecker(): DButtonFileChecker | null {\n\t\tlet result = this._checker;\n\t\tif( result === undefined ) {\n\t\t\tresult = this._options?.checker ?? null;\n\t\t\tthis._checker = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getOpener(): UtilFileOpener {\n\t\tlet result = this._opener;\n\t\tif( result == null ) {\n\t\t\tresult = this.newOpener();\n\t\t\tthis._opener = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newOpener(): UtilFileOpener {\n\t\treturn new UtilFileOpener(\n\t\t\ttoEnum( this._options?.as ?? DButtonFileAs.TEXT, DButtonFileAs ),\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tthis.check((): void => {\n\t\t\tthis.open();\n\t\t});\n\t}\n\n\tprotected check( onResolve: () => void ): void {\n\t\tconst checker = this.getChecker();\n\t\tif( checker != null ) {\n\t\t\tconst result = checker();\n\t\t\tif( result === true ) {\n\t\t\t\tonResolve();\n\t\t\t} else if( result === false ) {\n\t\t\t\t// DO NOTHING\n\t\t\t} else {\n\t\t\t\tresult.then((): void => {\n\t\t\t\t\tonResolve();\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\tonResolve();\n\t\t}\n\t}\n\n\topen(): void {\n\t\tthis.getOpener().open();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonFile\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\nimport { DButtonBaseWhen } from \"./d-button-base-when\";\nimport { DLink, DLinkOptions, DThemeLink } from \"./d-link\";\n\nexport interface DButtonLinkOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonLink<VALUE> = DThemeButtonLink<VALUE>\n> extends DButtonBaseOptions<VALUE, THEME>, DLinkOptions {\n\n}\n\nexport interface DThemeButtonLink<VALUE = unknown> extends DThemeButtonBase<VALUE>, DThemeLink {\n\n}\n\nexport class DButtonLink<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonLink<VALUE> = DThemeButtonLink<VALUE>,\n\tOPTIONS extends DButtonLinkOptions<VALUE, THEME> = DButtonLinkOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected _link!: DLink;\n\n\tprotected initOnClick( when: DButtonBaseWhen, theme: THEME, options?: OPTIONS ): void {\n\t\tconst link = new DLink( theme, options );\n\t\tthis._link = link;\n\t\tlink.apply( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( when === DButtonBaseWhen.CLICKED ) {\n\t\t\t\tthis.onClick( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tget link(): DLink {\n\t\treturn this._link;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tthis._link.open( e );\n\t}\n\n\topen( inNewWindow: boolean ): void {\n\t\tthis._link.open( inNewWindow );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonLink\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DButtonRadioOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadio<VALUE> = DThemeButtonRadio<VALUE>\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonRadio<VALUE = unknown> extends DThemeButtonBase<VALUE> {\n\n}\n\nexport class DButtonRadio<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadio<VALUE> = DThemeButtonRadio<VALUE>,\n\tOPTIONS extends DButtonRadioOptions<VALUE, THEME> = DButtonRadioOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonRadio\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonRadio, DButtonRadioOptions, DThemeButtonRadio } from \"./d-button-radio\";\n\nexport interface DButtonRadioRightOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadioRight<VALUE> = DThemeButtonRadioRight<VALUE>\n> extends DButtonRadioOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeButtonRadioRight<VALUE = unknown> extends DThemeButtonRadio<VALUE> {\n\n}\n\nexport class DButtonRadioRight<\n\tVALUE = unknown,\n\tTHEME extends DThemeButtonRadioRight<VALUE> = DThemeButtonRadioRight<VALUE>,\n\tOPTIONS extends DButtonRadioRightOptions<VALUE, THEME> = DButtonRadioRightOptions<VALUE, THEME>\n> extends DButtonRadio<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DButtonRadioRight\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DButtonRedo<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton<VALUE> = DThemeButton<VALUE>,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst state = this.state;\n\t\tconst commandController = DControllers.getCommandController();\n\t\tstate.isDisabled = ! commandController.isRedoable();\n\t\tcommandController.on( \"change\", (): void => {\n\t\t\tstate.isDisabled = ! commandController.isRedoable();\n\t\t});\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tDControllers.getCommandController().redo();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\n\nexport class DButtonSecondary extends DButton {\n\tprotected getType(): string {\n\t\treturn \"DButtonSecondary\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DChartAxisPosition {\n\tTOP,\n\tBOTTOM,\n\tLEFT,\n\tRIGHT\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport enum DChartAxisTickPosition {\n\tINSIDE,\n\tOUTSIDE\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DContentOptions extends DBaseOptions<DThemeContent> {\n\n}\n\nexport interface DThemeContent extends DThemeBase {\n\n}\n\nexport class DContent extends DBase<DThemeContent, DContentOptions> {\n\tprotected init( options?: DContentOptions ) {\n\t\tsuper.init( options );\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tprotected initReflowable(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DContent\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\n\nexport interface DScrollBarOptions extends DBaseOptions<DThemeScrollBar> {\n\tthumb?: DScrollBarThumbOptions;\n}\n\nexport interface DThemeScrollBar extends DThemeBase {\n\n}\n\nexport abstract class DScrollBar extends DBase<DThemeScrollBar, DScrollBarOptions> {\n\tprotected _start!: number;\n\tprotected _end!: number;\n\tprotected _thumb!: DScrollBarThumb;\n\n\tprotected init( options?: DScrollBarOptions ): void {\n\t\tsuper.init( options );\n\n\t\tthis._start = 0;\n\t\tthis._end = 1;\n\t\tconst thumb = this._thumb = this.createThumb( options?.thumb );\n\t\tthis.addChild( thumb );\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tget thumb(): DScrollBarThumb {\n\t\treturn this._thumb;\n\t}\n\n\tprotected abstract createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb;\n\n\tprotected getType(): string {\n\t\treturn \"DScrollBar\";\n\t}\n\n\tsetRegion( start: number, end: number, size: number ): void {\n\t\tif( size < 1 ) {\n\t\t\tstart = 0;\n\t\t\tend = 1;\n\t\t} else {\n\t\t\tstart = Math.max( 0, Math.min( 1, start / size ) );\n\t\t\tend = Math.max( start, Math.min( 1, end / size ) );\n\t\t}\n\t\tif( this._start !== start || this._end !== end ) {\n\t\t\tthis._start = start;\n\t\t\tthis._end = end;\n\t\t\tthis.onRegionChange();\n\t\t}\n\t}\n\n\tisRegionVisible(): boolean {\n\t\treturn 0 < this._start || this._end < 1;\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.onRegionChange();\n\t}\n\n\tonRegionChange(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetRegionStart(): number {\n\t\treturn this._start;\n\t}\n\n\tgetRegionEnd(): number {\n\t\treturn this._end;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { UtilDrag } from \"./util/util-drag\";\n\nexport interface DScrollBarThumbOptions extends DBaseOptions<DThemeScrollBarThumb> {\n\n}\n\nexport interface DThemeScrollBarThumb extends DThemeBase {\n\tgetThumbMinimumLength(): number;\n}\n\nexport abstract class DScrollBarThumb extends DBase<DThemeScrollBarThumb, DScrollBarThumbOptions> {\n\tprotected _dragUtil!: UtilDrag;\n\n\tprotected init( options?: DScrollBarThumbOptions ) {\n\t\tsuper.init( options );\n\t\tthis.state.isFocusable = false;\n\n\t\tconst position = new Point();\n\t\tthis._dragUtil = new UtilDrag({\n\t\t\ttarget: this,\n\t\t\teasing: false,\n\t\t\ton: {\n\t\t\t\tstart: (): void => {\n\t\t\t\t\tposition.copyFrom( this.position );\n\t\t\t\t},\n\t\t\t\tmove: ( dx: number, dy: number ): void => {\n\t\t\t\t\tposition.set( position.x + dx, position.y + dy );\n\t\t\t\t\tthis.onDragMove( position.x, position.y );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tgetMinimumLength(): number {\n\t\treturn this.theme.getThumbMinimumLength();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DScrollBarThumb\";\n\t}\n\n\tprotected abstract onDragMove( dx: number, dy: number ): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\n\nexport class DScrollBarThumbReflowableHorizontal extends Graphics implements DReflowable {\n\tconstructor( base: DScrollBarThumb ) {\n\t\tsuper();\n\t\tbase.addRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tthis.clear();\n\t\tconst state = base.state;\n\t\tconst border = base.border;\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tconst borderWidth = border.getWidth( state );\n\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\tthis.beginFill( borderColor, borderAlpha );\n\t\t\tthis.lineStyle( 0, 0, 0, 0 );\n\t\t\tthis.drawRect( 0, height - borderWidth - borderAlign, width, borderWidth );\n\t\t\tthis.endFill();\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbReflowableHorizontal } from \"./d-scroll-bar-thumb-reflowable-horizontal\";\n\nexport class DScrollBarThumbHorizontal extends DScrollBarThumb {\n\tprotected onDragMove( dx: number, dy: number ) {\n\t\tthis.emit( \"regionmove\", dx, this );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DScrollBarThumbReflowableHorizontal( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbHorizontal } from \"./d-scroll-bar-thumb-horizontal\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DScrollBarHorizontal extends DScrollBar {\n\tprotected init( options?: DScrollBarOptions ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst width = this.width;\n\t\t\t\tif( 0 < width ) {\n\t\t\t\t\tconst size = this._end - this._start;\n\t\t\t\t\tconst position = e.data.getLocalPosition( this );\n\t\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, position.x / width - size * 0.5 ) );\n\t\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\tthis._thumb.on( \"regionmove\", ( x: number ) => {\n\t\t\tconst width = this.width;\n\t\t\tif( 0 < width ) {\n\t\t\t\tconst size = this._end - this._start;\n\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, x / width ) );\n\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb {\n\t\treturn new DScrollBarThumbHorizontal( options );\n\t}\n\n\tonRegionChange(): void {\n\t\tconst thumb = this._thumb;\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst thumbMinimumLength = Math.min( width * 0.5, thumb.getMinimumLength() );\n\t\tconst space = width - thumbMinimumLength;\n\t\tconst barStart = space * this._start;\n\t\tconst barLength = space * this._end + thumbMinimumLength - barStart;\n\n\t\tthumb.position.set( barStart, 0 );\n\t\tthumb.resize( barLength, height );\n\n\t\tsuper.onRegionChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DBase, DReflowable } from \"./d-base\";\n\nexport class DScrollBarThumbReflowableVertical extends Graphics implements DReflowable {\n\tconstructor( base: DBase ) {\n\t\tsuper();\n\t\tbase.addRenderable( this, true );\n\t\tbase.addReflowable( this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tthis.clear();\n\t\tconst state = base.state;\n\t\tconst border = base.border;\n\t\tconst borderColor = border.getColor( state );\n\t\tif( borderColor != null ) {\n\t\t\tconst borderAlpha = border.getAlpha( state );\n\t\t\tconst borderWidth = border.getWidth( state );\n\t\t\tconst borderAlign = border.getAlign( state );\n\t\t\tthis.beginFill( borderColor, borderAlpha );\n\t\t\tthis.lineStyle( 0, 0, 0, 0 );\n\t\t\tthis.drawRect( width - borderWidth - borderAlign, 0, borderWidth, height );\n\t\t\tthis.endFill();\n\t\t\tthis.visible = true;\n\t\t} else {\n\t\t\tthis.visible = false;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DScrollBarThumb } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbReflowableVertical } from \"./d-scroll-bar-thumb-reflowable-vertical\";\n\nexport class DScrollBarThumbVertocal extends DScrollBarThumb {\n\tprotected onDragMove( dx: number, dy: number ) {\n\t\tthis.emit( \"regionmove\", dy, this );\n\t}\n\n\tprotected initReflowable(): void {\n\t\tnew DScrollBarThumbReflowableVertical( this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarThumb, DScrollBarThumbOptions } from \"./d-scroll-bar-thumb\";\nimport { DScrollBarThumbVertocal } from \"./d-scroll-bar-thumb-vertical\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport class DScrollBarVertical extends DScrollBar {\n\tprotected init( options?: DScrollBarOptions ) {\n\t\tsuper.init( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: InteractionEvent ): void => {\n\t\t\tif( e.target === this ) {\n\t\t\t\tconst height = this.height;\n\t\t\t\tif( 0 < height ) {\n\t\t\t\t\tconst size = this._end - this._start;\n\t\t\t\t\tconst position = e.data.getLocalPosition( this );\n\t\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, position.y / height - size * 0.5 ) );\n\t\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\te.stopPropagation();\n\t\t\t}\n\t\t});\n\n\t\tthis._thumb.on( \"regionmove\", ( y: number ): void => {\n\t\t\tconst height = this.height;\n\t\t\tif( 0 < height ) {\n\t\t\t\tconst size = this._end - this._start;\n\t\t\t\tconst newStart = Math.min( 1 - size, Math.max( 0, y / height ) );\n\t\t\t\tif( this._start !== newStart ) {\n\t\t\t\t\tthis.emit( \"regionmove\", newStart, this );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected createThumb( options?: DScrollBarThumbOptions ): DScrollBarThumb {\n\t\treturn new DScrollBarThumbVertocal( options );\n\t}\n\n\tonRegionChange(): void {\n\t\tconst thumb = this._thumb;\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst thumbMinimumLength = Math.min( height * 0.5, thumb.getMinimumLength() );\n\t\tconst space = height - thumbMinimumLength;\n\t\tconst barStart = space * this._start;\n\t\tconst barLength = space * this._end + thumbMinimumLength - barStart;\n\n\t\tthumb.position.set( 0, barStart );\n\t\tthumb.resize( width, barLength );\n\n\t\tsuper.onRegionChange();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Rectangle } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DContent, DContentOptions } from \"./d-content\";\nimport { DDragMode } from \"./d-drag-mode\";\nimport { DScrollBar, DScrollBarOptions } from \"./d-scroll-bar\";\nimport { DScrollBarHorizontal } from \"./d-scroll-bar-horizontal\";\nimport { DScrollBarVertical } from \"./d-scroll-bar-vertical\";\nimport { toEnum } from \"./util/to-enum\";\nimport { UtilDrag } from \"./util/util-drag\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\n/**\n * {@link DPane} drag options.\n */\nexport interface DPaneDragOptions {\n\tmode?: (keyof typeof DDragMode) | DDragMode;\n}\n\n/**\n * {@link DPane} scroll bar options.\n */\nexport interface DPaneScrollBarOptions {\n\tvertical?: DScrollBarOptions;\n\thorizontal?: DScrollBarOptions;\n}\n\nexport interface DPaneScrollBar {\n\tvertical: DScrollBarVertical;\n\thorizontal: DScrollBarHorizontal;\n}\n\n/**\n * {@link DPane} options.\n */\nexport interface DPaneOptions<\n\tTHEME extends DThemePane = DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DBaseOptions<THEME> {\n\t/**\n\t * True to enable an overflow mask.\n\t */\n\tmask?: boolean;\n\n\t/**\n\t * Content options or a content.\n\t */\n\tcontent?: CONTENT_OPTIONS | DBase;\n\n\t/**\n\t * Scroll bar options.\n\t */\n\tscrollbar?: DPaneScrollBarOptions;\n\n\t/**\n\t * Drag options.\n\t */\n\tdrag?: DPaneDragOptions;\n}\n\nexport interface DThemePane extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n\tgetWheelSpeed(): number;\n\tgetDragMode(): DDragMode;\n}\n\n// Class\nexport class DPane<\n\tTHEME extends DThemePane = DThemePane,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DPaneOptions<THEME, CONTENT_OPTIONS> = DPaneOptions<THEME, CONTENT_OPTIONS>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static WORK_POINT?: Point;\n\tprotected static WORK_RECTANGLE?: Rectangle;\n\n\tprotected _content!: DBase;\n\tprotected _overflowMask?: DBaseOverflowMask | null;\n\tprotected _scrollbar?: DPaneScrollBar;\n\tprotected _dragUtil?: UtilDrag;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Content\n\t\tconst theme = this.theme;\n\t\tconst content = this._content = this.toContent( options );\n\t\tif( options?.mask ?? theme.isOverflowMaskEnabled() ) {\n\t\t\tthis.mask = this.getOverflowMask();\n\t\t}\n\t\tthis.addChild( content );\n\n\t\t// Scroll bar\n\t\tconst scrollbar = this.newScrollBar( theme, options?.scrollbar );\n\t\tthis._scrollbar = scrollbar;\n\t\tscrollbar.vertical.on( \"regionmove\", ( start: number ): void => {\n\t\t\tthis.onRegionMoveY( content, start );\n\t\t});\n\t\tscrollbar.horizontal.on( \"regionmove\", ( start: number ): void => {\n\t\t\tthis.onRegionMoveX( content, start );\n\t\t});\n\t\tthis.addChild( scrollbar.vertical );\n\t\tthis.addChild( scrollbar.horizontal );\n\t\tcontent.on( \"move\", (): void => {\n\t\t\tthis.onContentChange();\n\t\t});\n\t\tcontent.on( \"resize\", (): void => {\n\t\t\tthis.onContentChange();\n\t\t});\n\t\tthis.updateScrollBar();\n\n\t\t// Drag\n\t\tthis.initDrag( content, theme, options );\n\t}\n\n\tprotected initDrag( content: DBase, theme: THEME, options?: OPTIONS ): void {\n\t\t// Edge does not fire the wheel event when scrolling using the 2-fingure scroll gesture on a touchpad.\n\t\t// Instead, it fires touch events. This is why the dragging is enabled regardless of the `UtilPointerEvent.touchable`.\n\t\t// https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/7134034/\n\t\tconst dragMode = toEnum( options?.drag?.mode ?? theme.getDragMode(), DDragMode );\n\t\tif( dragMode === DDragMode.ON || dragMode === DDragMode.TOUCH ) {\n\t\t\tconst position = new Point();\n\t\t\tthis._dragUtil = new UtilDrag({\n\t\t\t\ttarget: this,\n\t\t\t\ttouch: dragMode === DDragMode.TOUCH,\n\t\t\t\ton: {\n\t\t\t\t\tstart: (): void => {\n\t\t\t\t\t\tposition.copyFrom( content.position );\n\t\t\t\t\t},\n\t\t\t\t\tmove: ( dx: number, dy: number ): void => {\n\t\t\t\t\t\tposition.set( position.x + dx, position.y + dy );\n\t\t\t\t\t\tcontent.position.set(\n\t\t\t\t\t\t\tthis.toContentX( content, position.x ),\n\t\t\t\t\t\t\tthis.toContentY( content, position.y )\n\t\t\t\t\t\t);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onRegionMoveX( content: DBase, start: number ) {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t\tcontent.x = - content.width * start;\n\t}\n\n\tprotected onRegionMoveY( content: DBase, start: number ) {\n\t\tconst dragUtil = this._dragUtil;\n\t\tif( dragUtil != null ) {\n\t\t\tdragUtil.stop();\n\t\t}\n\t\tcontent.y = - content.height * start;\n\t}\n\n\tprotected newScrollBar( theme: THEME, options?: DPaneScrollBarOptions ): DPaneScrollBar {\n\t\treturn {\n\t\t\tvertical: new DScrollBarVertical( options?.vertical ),\n\t\t\thorizontal: new DScrollBarHorizontal( options?.horizontal )\n\t\t};\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPane\";\n\t}\n\n\tget content(): DBase {\n\t\treturn this._content;\n\t}\n\n\tprotected toContent( options?: OPTIONS ): DBase {\n\t\tconst content = options?.content;\n\t\tif( content ) {\n\t\t\tif( content instanceof DBase ) {\n\t\t\t\treturn content;\n\t\t\t} else {\n\t\t\t\treturn this.newContent( content );\n\t\t\t}\n\t\t}\n\t\treturn this.newContent();\n\t}\n\n\tprotected newContent( options?: CONTENT_OPTIONS ): DBase {\n\t\treturn new DContent( options );\n\t}\n\n\tprotected getOverflowMask(): DBaseOverflowMask {\n\t\tlet result = this._overflowMask;\n\t\tif( result == null ) {\n\t\t\tresult = new DBaseOverflowMask( this );\n\t\t\tthis._overflowMask = result;\n\t\t\tthis.addReflowable( result );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn result;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst content = this._content;\n\t\tconst x = this.getWheelContentX( content, deltas.deltaX * deltas.lowest );\n\t\tconst y = this.getWheelContentY( content, deltas.deltaY * deltas.lowest );\n\t\tif( content.x !== x || content.y !== y ) {\n\t\t\tconst dragUtil = this._dragUtil;\n\t\t\tif( dragUtil != null ) {\n\t\t\t\tdragUtil.stop();\n\t\t\t}\n\t\t\tcontent.position.set( x, y );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getWheelContentX( content: DBase, delta: number ): number {\n\t\tif( 0 < delta || delta < 0 ) {\n\t\t\tconst speed = this.theme.getWheelSpeed();\n\t\t\treturn this.toContentX( content, content.x - delta * speed );\n\t\t}\n\t\treturn content.x;\n\t}\n\n\tprotected getWheelContentY( content: DBase, delta: number ): number {\n\t\tif( 0 < delta || delta < 0 ) {\n\t\t\tconst speed = this.theme.getWheelSpeed();\n\t\t\treturn this.toContentY( content, content.y + delta * speed );\n\t\t}\n\t\treturn content.y;\n\t}\n\n\tprotected toContentX( content: DBase, x: number ): number {\n\t\treturn Math.min( 0, Math.max( this.width - content.width, x ) );\n\t}\n\n\tprotected toContentY( content: DBase, y: number ): number {\n\t\treturn Math.min( 0, Math.max( this.height - content.height, y ) );\n\t}\n\n\tprotected isRefitable( target: any ): target is DBase<any, any> {\n\t\treturn super.isRefitable( target ) && ! ( target instanceof DScrollBar );\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected onContentChange(): void {\n\t\tthis.updateScrollBar();\n\t}\n\n\tprotected updateScrollBar(): void {\n\t\tconst scrollbar = this._scrollbar;\n\t\tif( scrollbar != null ) {\n\t\t\tconst vertical = scrollbar.vertical;\n\t\t\tconst horizontal = scrollbar.horizontal;\n\t\t\tthis.updateScrollBarRegions( vertical, horizontal );\n\t\t\tthis.updateScrollBarVisibilities( vertical, horizontal );\n\t\t\tthis.updateScrollBarPositions( vertical, horizontal );\n\t\t}\n\t}\n\n\tprotected getScrollBarOffsetHorizontalStart( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected getScrollBarOffsetHorizontalEnd( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected getScrollBarOffsetVerticalStart( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected getScrollBarOffsetVerticalEnd( size: number ): number {\n\t\treturn size * 0.5;\n\t}\n\n\tprotected updateScrollBarPositions( vertical: DScrollBarVertical, horizontal: DScrollBarHorizontal ): void {\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\n\t\tconst verticalWidth = vertical.width;\n\t\tconst verticalOffsetStart = this.getScrollBarOffsetVerticalStart( verticalWidth );\n\t\tconst verticalOffsetEnd = this.getScrollBarOffsetVerticalEnd( verticalWidth );\n\t\tvertical.position.set( width - verticalWidth, verticalOffsetStart );\n\t\tvertical.height = height - verticalOffsetStart - verticalOffsetEnd;\n\n\t\tconst horizontalHeight = horizontal.height;\n\t\tconst horizontalOffsetStart = this.getScrollBarOffsetHorizontalStart( horizontalHeight );\n\t\tconst horizontalOffsetEnd = this.getScrollBarOffsetHorizontalEnd( horizontalHeight );\n\t\thorizontal.position.set( horizontalOffsetStart, height - horizontalHeight );\n\t\thorizontal.width = width - horizontalOffsetStart - horizontalOffsetEnd;\n\t}\n\n\tprotected updateScrollBarRegions( vertical: DScrollBarVertical, horizontal: DScrollBarHorizontal ): void {\n\t\tconst content = this._content;\n\t\tconst x = -content.x;\n\t\tconst y = -content.y;\n\t\thorizontal.setRegion( x, x + this.width, content.width );\n\t\tvertical.setRegion( y, y + this.height, content.height );\n\t}\n\n\tprotected updateScrollBarVisibilities( vertical: DScrollBarVertical, horizontal: DScrollBarHorizontal ): void {\n\t\tconst isChangedHorizontal = this.updateScrollBarVisibility( horizontal );\n\t\tconst isChangedVertical = this.updateScrollBarVisibility( vertical );\n\t\tif( isChangedHorizontal || isChangedVertical ) {\n\t\t\t// Update the overflow mask\n\t\t\tconst overflowMask = this._overflowMask;\n\t\t\tif( overflowMask != null ) {\n\t\t\t\tif( horizontal.visible || vertical.visible ) {\n\t\t\t\t\tconst content = this._content;\n\t\t\t\t\tif( content.mask !== overflowMask ) {\n\t\t\t\t\t\tcontent.mask = overflowMask;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst content = this._content;\n\t\t\t\t\tif( content.mask ) {\n\t\t\t\t\t\t(content as any).mask = null;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Rerender\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tprotected updateScrollBarVisibility( scrollbar: DScrollBar ): boolean {\n\t\tconst isRegionVisible = scrollbar.isRegionVisible();\n\t\tif( scrollbar.visible !== isRegionVisible ) {\n\t\t\tscrollbar.visible = isRegionVisible;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getFocusedChildClippingRect(\n\t\tfocused: DBase,\n\t\tcontentX: number, contentY: number,\n\t\tcontentWidth: number, contentHeight: number,\n\t\twidth: number, height: number,\n\t\tresult: Rectangle\n\t): Rectangle {\n\t\tresult.x = 0;\n\t\tresult.y = 0;\n\t\tresult.width = width;\n\t\tresult.height = height;\n\t\treturn result;\n\t}\n\n\tprotected onChildFocus( focused: DBase ): void {\n\t\tconst point = DPane.WORK_POINT = (DPane.WORK_POINT || new Point());\n\n\t\t// Content rectangle\n\t\tconst content = this._content;\n\t\tconst contentX = content.x;\n\t\tconst contentY = content.y;\n\t\tconst contentWidth = content.width;\n\t\tconst contentHeight = content.height;\n\n\t\tpoint.set( 0, 0 );\n\t\tfocused.toGlobal( point, point, false );\n\t\tcontent.toLocal( point, undefined, point, false );\n\t\tconst x0 = contentX + Math.min( contentWidth, Math.max( 0, point.x ) );\n\t\tconst y0 = contentY + Math.min( contentHeight, Math.max( 0, point.y ) );\n\n\t\tpoint.set( focused.width, focused.height );\n\t\tfocused.toGlobal( point, point, true );\n\t\tcontent.toLocal( point, undefined, point, true );\n\t\tconst x1 = contentX + Math.min( contentWidth, Math.max( 0, point.x ) );\n\t\tconst y1 = contentY + Math.min( contentHeight, Math.max( 0, point.y ) );\n\n\t\tconst width = this.width;\n\t\tconst height = this.height;\n\t\tconst clippingRect = DPane.WORK_RECTANGLE = (DPane.WORK_RECTANGLE || new Rectangle());\n\t\tthis.getFocusedChildClippingRect(\n\t\t\tfocused,\n\t\t\tcontentX, contentY,\n\t\t\tcontentWidth, contentHeight,\n\t\t\twidth, height,\n\t\t\tclippingRect\n\t\t);\n\t\tconst clippingRectX = clippingRect.x;\n\t\tconst clippingRectY = clippingRect.y;\n\t\tconst clippingRectX0 = clippingRectX;\n\t\tconst clippingRectY0 = clippingRectY;\n\t\tconst clippingRectX1 = clippingRectX + clippingRect.width;\n\t\tconst clippingRectY1 = clippingRectY + clippingRect.height;\n\n\t\tlet newX: number | null = null;\n\t\tif( x0 < clippingRectX0 ) {\n\t\t\tif( x1 <= clippingRectX1 ) {\n\t\t\t\tnewX = contentX + Math.min( clippingRectX0 - x0, clippingRectX1 - x1 );\n\t\t\t\tnewX = Math.max( width - contentWidth, Math.min( 0, newX ) );\n\t\t\t}\n\t\t} else if( clippingRectX1 < x1 ) {\n\t\t\tnewX = contentX - Math.min( x0 - clippingRectX0, x1 - clippingRectX1 );\n\t\t\tnewX = Math.max( width - contentWidth, Math.min( 0, newX ) );\n\t\t}\n\n\t\tlet newY: number | null = null;\n\t\tif( y0 < clippingRectY0 ) {\n\t\t\tif( y1 <= clippingRectY1 ) {\n\t\t\t\tnewY = contentY + Math.min( clippingRectY0 - y0, clippingRectY1 - y1 );\n\t\t\t\tnewY = Math.max( height - contentHeight, Math.min( 0, newY ) );\n\t\t\t}\n\t\t} else if( clippingRectY1 < y1 ) {\n\t\t\tnewY = contentY - Math.min( y0 - clippingRectY0, y1 - clippingRectY1 );\n\t\t\tnewY = Math.max( height - contentHeight, Math.min( 0, newY ) );\n\t\t}\n\n\t\tconst contentPosition = content.position;\n\t\tif( newX != null ) {\n\t\t\tif( newY != null ) {\n\t\t\t\tcontentPosition.set( newX, newY );\n\t\t\t} else {\n\t\t\t\tcontentPosition.x = newX;\n\t\t\t}\n\t\t} else {\n\t\t\tif( newY != null ) {\n\t\t\t\tcontentPosition.y = newY;\n\t\t\t}\n\t\t}\n\n\t\tsuper.onChildFocus( focused );\n\t}\n\n\tdestroy(): void {\n\t\t// Overflow mask\n\t\tconst overflowMask = this._overflowMask;\n\t\tif( overflowMask != null ) {\n\t\t\tthis._overflowMask = null;\n\t\t\toverflowMask.destroy();\n\t\t}\n\t\t(this as any).mask = null;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DListSelection, DListSelectionOptions } from \"./d-list-selection\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DListOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeList = DThemeList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\tselection?: DListSelectionOptions<VALUE> | DListSelection<VALUE>;\n}\n\nexport interface DThemeList extends DThemePane {\n\n}\n\nexport class DList<\n\tVALUE = unknown,\n\tTHEME extends DThemeList = DThemeList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DListOptions<VALUE, THEME, CONTENT_OPTIONS> = DListOptions<VALUE, THEME, CONTENT_OPTIONS>\n> extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _selection?: DListSelection<VALUE>;\n\n\tprotected onChildrenDirty(): void {\n\t\tconst selection = this._selection;\n\t\tif( selection != null ) {\n\t\t\tselection.toDirty();\n\t\t}\n\t\tsuper.onChildrenDirty();\n\t}\n\n\tget selection(): DListSelection<VALUE> {\n\t\tlet result = this._selection;\n\t\tif( result == null ) {\n\t\t\tconst options = this._options?.selection;\n\t\t\tresult = ( options instanceof DListSelection ?\n\t\t\t\toptions : this.newSelection( options )\n\t\t\t);\n\t\t\tthis._selection = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newSelection( options?: DListSelectionOptions<VALUE> ): DListSelection<VALUE> {\n\t\treturn new DListSelection<VALUE>( this._content, options );\n\t}\n\n\tprotected onRefit(): void {\n\t\tsuper.onRefit();\n\t\tthis.updateChildPosition();\n\t\tthis.updateChildVisibility();\n\t}\n\n\tprotected updateChildPosition(): void {\n\t\tconst content = this._content;\n\t\tconst items = content.children;\n\t\tlet y = 0;\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DBase ) {\n\t\t\t\titem.y = y;\n\t\t\t\ty += item.height;\n\t\t\t}\n\t\t}\n\t\tconst scrollLimit = Math.min( 0, -y + this.height );\n\t\tif( content.y < scrollLimit ) {\n\t\t\tcontent.y = scrollLimit;\n\t\t}\n\t\tcontent.height = y;\n\t}\n\n\tprotected updateChildVisibility(): void {\n\t\tconst content = this._content;\n\t\tconst items = content.children;\n\t\tconst from = -content.y;\n\t\tconst to = from + this.height;\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\tif( item instanceof DBase ) {\n\t\t\t\tconst itemY = item.y;\n\t\t\t\titem.visible = ( from <= itemY + item.height && itemY <= to );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onContentChange(): void {\n\t\tsuper.onContentChange();\n\t\tthis.updateChildVisibility();\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tUtilKeyboardEvent.moveFocusVertically( e, this );\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DList\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseOptions } from \"./d-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DList, DListOptions, DThemeList } from \"./d-list\";\n\nexport interface DDialogSelectListOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecList = DThemeDialogSelecList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DListOptions<VALUE, THEME, CONTENT_OPTIONS> {\n\n}\n\nexport interface DThemeDialogSelecList extends DThemeList {\n\n}\n\nexport class DDialogSelectList<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecList = DThemeDialogSelecList,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DDialogSelectListOptions<VALUE, THEME, CONTENT_OPTIONS> = DDialogSelectListOptions<VALUE, THEME, CONTENT_OPTIONS>\n> extends DList<VALUE, THEME, CONTENT_OPTIONS, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSelectList\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DListItem, DListItemOptions, DThemeListItem } from \"./d-list-item\";\n\nexport interface DDialogSelectListItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecListItem = DThemeDialogSelecListItem\n> extends DListItemOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeDialogSelecListItem extends DThemeListItem {\n\n}\n\nexport class DDialogSelectListItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelecListItem = DThemeDialogSelecListItem,\n\tOPTIONS extends DDialogSelectListItemOptions<VALUE, THEME> = DDialogSelectListItemOptions<VALUE, THEME>\n> extends DListItem<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogSelectListItem\";\n\t}\n}\n","import { utils } from \"pixi.js\";\n\nexport class DDialogSelectSearh<SEARCH_RESULT> extends utils.EventEmitter {\n\tprotected _search: ( word: string ) => Promise<SEARCH_RESULT[]>;\n\tprotected _id: number;\n\tprotected _idCompleted: number;\n\tprotected _result: SEARCH_RESULT[] | null;\n\n\tconstructor( search?: ( word: string ) => Promise<SEARCH_RESULT[]> ) {\n\t\tsuper();\n\n\t\tthis._search = search || (( _: string ) => Promise.resolve([]));\n\t\tthis._id = 0;\n\t\tthis._idCompleted = 0;\n\t\tthis._result = null;\n\t}\n\n\tcreate( args: [ string ] ): void {\n\t\tconst id = ++this._id;\n\t\tthis._search( args[ 0 ] ).then(( searchResult: SEARCH_RESULT[] ) => {\n\t\t\tif( this._id === id ) {\n\t\t\t\tthis._idCompleted = id;\n\t\t\t\tthis._result = searchResult;\n\t\t\t\tthis.emit( \"success\", this, searchResult );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}, () => {\n\t\t\tif( this._id === id ) {\n\t\t\t\tthis._idCompleted = id;\n\t\t\t\tthis._result = null;\n\t\t\t\tthis.emit( \"fail\", this );\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t});\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tisDone(): boolean {\n\t\treturn this._id === this._idCompleted;\n\t}\n\n\tgetResult(): SEARCH_RESULT[] | null {\n\t\treturn this._result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DText, DTextOptions, DThemeText } from \"./d-text\";\n\nexport interface DNoteOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeNote<VALUE> = DThemeNote<VALUE>\n> extends DTextOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeNote<VALUE = unknown> extends DThemeText<VALUE> {\n\n}\n\nexport class DNote<\n\tVALUE = unknown,\n\tTHEME extends DThemeNote<VALUE> = DThemeNote<VALUE>,\n\tOPTIONS extends DNoteOptions<VALUE, THEME> = DNoteOptions<VALUE, THEME>\n> extends DText<VALUE, THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.visible = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DNote\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport {\n\tDDialogCommand, DDialogCommandEvents, DDialogCommandOptions, DThemeDialogCommand\n} from \"./d-dialog-command\";\nimport { DDialogSelectList } from \"./d-dialog-select-list\";\nimport { DDialogSelectListItem } from \"./d-dialog-select-list-item\";\nimport { DDialogSelectSearh } from \"./d-dialog-select-search\";\nimport { DInputText } from \"./d-input-text\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DListItem } from \"./d-list-item\";\nimport { DListSelection } from \"./d-list-selection\";\nimport { DNote, DNoteOptions } from \"./d-note\";\nimport { UtilTransition } from \"./util/util-transition\";\n\n/**\n * {@link DDialogSelect} search object.\n */\nexport interface DDialogSelectSearch<VALUE> {\n\tcreate( args: [ string ] ): void;\n\ton( event: \"success\", handler: ( e: unknown, searchResults: VALUE[] ) => void ): void;\n\ton( event: \"change\", handler: () => void ): void;\n\tisDone(): boolean;\n\tgetResult(): VALUE[] | null;\n}\n\n/**\n * {@link DDialogSelect} search function.\n */\nexport type DDialogSelectSearchFunction<VALUE> = ( word: string ) => Promise<VALUE[]>;\n\n/**\n * {@link DDialogSelect} controller.\n */\nexport interface DDialogSelectController<VALUE> {\n\tsearch: DDialogSelectSearch<VALUE> | DDialogSelectSearchFunction<VALUE>;\n}\n\n/**\n * {@link DDialogSelect} note options.\n */\nexport interface DDialogSelectNoteOptions {\n\tnoItems?: DNoteOptions;\n\tsearching?: DNoteOptions;\n}\n\nexport type DDialogSelectItemToLabel<VALUE> = ( result: VALUE, caller: any ) => string;\n\nexport type DDialogSelectItemIsEqual<VALUE> = ( a: VALUE, b: VALUE, caller: any ) => boolean;\n\n/**\n * {@link DDialogSelect} item options.\n */\nexport interface DDialogSelectItemOptions<VALUE> {\n\ttoLabel?: DDialogSelectItemToLabel<VALUE>;\n\tisEqual?: DDialogSelectItemIsEqual<VALUE>;\n\tpredefineds?: VALUE[];\n}\n\n/**\n * {@link DDialogSelect} events.\n */\nexport interface DDialogSelectEvents<VALUE, EMITTER> extends DDialogCommandEvents<VALUE, EMITTER> {\n\tselect( value: VALUE, self: EMITTER ): void;\n}\n\n/**\n * {@link DDialogSelect} \"on\" options.\n */\nexport interface DDialogSelectOnOptions<VALUE, EMITTER> extends Partial<DDialogSelectEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DDialogSelect} options.\n */\nexport interface DDialogSelectOptions<\n\tVALUE,\n\tTHEME extends DThemeDialogSelect<VALUE> = DThemeDialogSelect<VALUE>,\n\tEMITTER = any\n> extends DDialogCommandOptions<VALUE, THEME> {\n\tcontroller?: DDialogSelectController<VALUE>;\n\titem?: DDialogSelectItemOptions<VALUE>;\n\tnote?: DDialogSelectNoteOptions;\n\ton?: DDialogSelectOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DDialogSelect} theme.\n */\nexport interface DThemeDialogSelect<VALUE = unknown> extends DThemeDialogCommand {\n\tgetItemToLabel(): DDialogSelectItemToLabel<VALUE>;\n\tgetItemIsEqual(): DDialogSelectItemIsEqual<VALUE>;\n\tgetNoteNoItemsText(): string;\n\tgetNoteSearchingText(): string;\n}\n\n// Helper\nconst toNoteOptions = ( parent: DBase, text: string, options?: DNoteOptions ): DNoteOptions => {\n\tif( options != null ) {\n\t\tif( options.parent == null ) {\n\t\t\toptions.parent = parent;\n\t\t}\n\t\tif( options.text == null ) {\n\t\t\toptions.text = {\n\t\t\t\tvalue: text\n\t\t\t};\n\t\t} else if( options.text.value == null ) {\n\t\t\toptions.text.value = text;\n\t\t}\n\t\treturn options;\n\t}\n\treturn {\n\t\tparent,\n\t\ttext: {\n\t\t\tvalue: text\n\t\t}\n\t};\n};\n\nconst toSearch = <VALUE>(\n\tcontroller?: DDialogSelectController<VALUE>\n): DDialogSelectSearch<VALUE> => {\n\tif( controller ) {\n\t\tconst search = controller.search;\n\t\tif( \"create\" in search ) {\n\t\t\treturn search;\n\t\t} else {\n\t\t\treturn new DDialogSelectSearh( search );\n\t\t}\n\t} else {\n\t\treturn new DDialogSelectSearh();\n\t}\n};\n\nexport class DDialogSelect<\n\tVALUE = unknown,\n\tTHEME extends DThemeDialogSelect<VALUE> = DThemeDialogSelect<VALUE>,\n\tOPTIONS extends DDialogSelectOptions<VALUE, THEME> = DDialogSelectOptions<VALUE, THEME>\n> extends DDialogCommand<VALUE | null, THEME, OPTIONS> {\n\tprotected _value!: VALUE | null;\n\tprotected _input!: DInputText;\n\tprotected _list!: DDialogSelectList<VALUE>;\n\tprotected _search!: DDialogSelectSearch<VALUE>;\n\tprotected _noteNoItems!: DNote;\n\tprotected _noteSearching!: DNote;\n\tprotected _itemToLabel!: DDialogSelectItemToLabel<VALUE>;\n\tprotected _itemIsEqual!: DDialogSelectItemIsEqual<VALUE>;\n\tprotected _itemPredefineds?: VALUE[];\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tthis._value = null;\n\t\tconst theme = this.theme;\n\n\t\tconst item = options?.item;\n\t\tthis._itemToLabel = item?.toLabel ?? theme.getItemToLabel();\n\t\tthis._itemIsEqual = item?.isEqual ?? theme.getItemIsEqual();\n\t\tthis._itemPredefineds = item?.predefineds;\n\n\t\t// Search box\n\t\tthis._input = new DInputText({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\"\n\t\t});\n\n\t\t// List\n\t\tconst list = new DDialogSelectList<VALUE>({\n\t\t\tparent: layout,\n\t\t\twidth: \"padding\",\n\t\t\tselection: {\n\t\t\t\ton: {\n\t\t\t\t\tchange: ( selection: DListSelection<VALUE> ): void => {\n\t\t\t\t\t\tconst first = selection.first();\n\t\t\t\t\t\tif( first ) {\n\t\t\t\t\t\t\tconst value = first.value;\n\t\t\t\t\t\t\tthis._value = value;\n\t\t\t\t\t\t\tthis.onOk( value );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t\tthis._list = list;\n\n\t\t// Text No Items\n\t\tconst noteNoItems = new DNote(toNoteOptions(\n\t\t\tlist,\n\t\t\ttheme.getNoteNoItemsText(),\n\t\t\toptions?.note?.noItems\n\t\t));\n\t\tthis._noteNoItems = noteNoItems;\n\n\t\t// Text Searching\n\t\tconst noteSearching = new DNote(toNoteOptions(\n\t\t\tlist,\n\t\t\ttheme.getNoteSearchingText(),\n\t\t\toptions?.note?.searching\n\t\t));\n\t\tthis._noteSearching = noteSearching;\n\n\t\t// Controller binding\n\t\tconst search = toSearch( options?.controller );\n\t\tthis._search = search;\n\t\tthis._input.on( \"input\", ( value: string ): void => {\n\t\t\tsearch.create([ value ]);\n\t\t});\n\n\t\tsearch.on( \"success\", ( e: unknown, results: VALUE[] ): void => {\n\t\t\tthis.onSearched( results );\n\t\t});\n\n\t\t// Visibility\n\t\tconst transition = new UtilTransition();\n\t\tsearch.on( \"change\", (): void => {\n\t\t\tif( search.isDone() ) {\n\t\t\t\tconst result = search.getResult();\n\t\t\t\tif( result != null && 0 < result.length ) {\n\t\t\t\t\ttransition.hide();\n\t\t\t\t} else {\n\t\t\t\t\ttransition.show( noteNoItems );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttransition.show( noteSearching );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onSearched( results: VALUE[] ): void {\n\t\tconst list = this._list;\n\t\tconst content = list.content;\n\t\tconst children = content.children as Array<DListItem<VALUE>>;\n\t\tconst value = this._value;\n\t\tconst toLabel = this._itemToLabel;\n\t\tconst isEqual = this._itemIsEqual;\n\t\tconst predefineds = this._itemPredefineds;\n\n\t\t// Update the existing children\n\t\tconst childrenLength = children.length;\n\t\tconst resultsLength = results.length;\n\t\tconst predefinedsLength = predefineds ? predefineds.length : 0;\n\t\tconst totalLength = predefinedsLength + resultsLength;\n\t\tconst minLength = Math.min( childrenLength, totalLength );\n\t\tfor( let i = 0; i < minLength; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tconst result = i < predefinedsLength ? predefineds![ i ] : results[ i - predefinedsLength ];\n\t\t\tchild.text = toLabel( result, this );\n\t\t\tchild.value = result;\n\t\t\tchild.state.isActive = (value != null ? isEqual( result, value, this ) : false);\n\t\t}\n\n\t\t// Insert new children\n\t\tfor( let i = minLength; i < totalLength; ++i ) {\n\t\t\tconst result = i < predefinedsLength ? predefineds![ i ] : results[ i - predefinedsLength ];\n\t\t\tconst newChild = this.newItem( result, toLabel( result, this ) );\n\t\t\tnewChild.state.isActive = (value != null ? isEqual( result, value, this ) : false);\n\t\t\tcontent.addChild( newChild );\n\t\t}\n\n\t\t// Remove unused children\n\t\tfor( let i = childrenLength - 1; minLength <= i; --i ) {\n\t\t\tchildren[ i ].destroy();\n\t\t}\n\n\t\t// Clear selection\n\t\tlist.selection.toDirty();\n\t}\n\n\tprotected newItem( result: VALUE, label: string ): DDialogSelectListItem<VALUE> {\n\t\treturn new DDialogSelectListItem<VALUE>({\n\t\t\tvalue: result,\n\t\t\ttext: {\n\t\t\t\tvalue: label\n\t\t\t}\n\t\t});\n\t}\n\n\tget value(): VALUE | null {\n\t\treturn this._value;\n\t}\n\n\tprotected getResolvedValue(): VALUE | null | PromiseLike<VALUE | null> {\n\t\treturn this._value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSelect\";\n\t}\n\n\tprotected onOpen(): void {\n\t\tsuper.onOpen();\n\t\tthis._list.selection.clear();\n\t\tthis._search.create([ this._input.value ]);\n\t}\n\n\tprotected onOk( value: VALUE | null | PromiseLike<VALUE | null> ): void {\n\t\tthis.emit( \"select\", value, this );\n\t\tsuper.onOk( value );\n\t}\n\n\tdestroy(): void {\n\t\tthis._input.destroy();\n\t\tthis._noteNoItems.destroy();\n\t\tthis._noteSearching.destroy();\n\t\tthis._list.destroy();\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonEvents, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogSelect, DDialogSelectOptions } from \"./d-dialog-select\";\n\n/**\n * A dialog to select values.\n */\nexport interface DButtonSelectDialog<VALUE> {\n\treadonly value: VALUE | null;\n\topen(): Promise<void>;\n}\n\n/**\n * A function to retrieve a selected value from a dialog.\n */\nexport type DButtonSelectGetter<VALUE, DIALOG> = ( dialog: DIALOG ) => VALUE | null;\n\n/**\n * A function to set a selecte value to a dialog.\n * Called before opening a dialog.\n */\nexport type DButtonSelectSetter<VALUE, DIALOG> = ( dialog: DIALOG, value: VALUE | null ) => void;\n\n/**\n * {@link DButtonSelect} events.\n */\nexport interface DButtonSelectEvents<VALUE, EMITTER> extends DButtonEvents<VALUE, EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param newValue a newly selected value\n\t * @param oldValue a previously selected value\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: VALUE | null, oldValue: VALUE | null, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonSelect} \"on\" options.\n */\nexport interface DButtonSelectOnOptions<VALUE, EMITTER> extends Partial<DButtonSelectEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButtonSelect} options.\n */\nexport interface DButtonSelectOptions<\n\tVALUE extends unknown = unknown,\n\tDIALOG_VALUE extends unknown = unknown,\n\tDIALOG extends DButtonSelectDialog<DIALOG_VALUE> = DButtonSelectDialog<DIALOG_VALUE>,\n\tTHEME extends DThemeButtonSelect<VALUE> = DThemeButtonSelect<VALUE>,\n\tEMITTER = any\n> extends DButtonOptions<VALUE | null, THEME, EMITTER> {\n\t/**\n\t * A function to retrieve a selected value from a dialog.\n\t */\n\tgetter?: DButtonSelectGetter<VALUE, DIALOG>;\n\n\t/**\n\t * A function to set a selected value to a dialog.\n\t * Called before opening a dialog.\n\t */\n\tsetter?: DButtonSelectSetter<VALUE, DIALOG>;\n\n\t/**\n\t * A dialog to select values.\n\t */\n\tdialog?: DDialogSelectOptions<DIALOG_VALUE> | DIALOG;\n\n\ton?: DButtonSelectOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DButtonSelect} theme.\n */\nexport interface DThemeButtonSelect<VALUE = unknown> extends DThemeButton<VALUE | null> {\n\n}\n\nconst defaultGetter = ( dialog: DButtonSelectDialog<any> ): any => {\n\t// Assumes the dialog.value is VALUE.\n\treturn dialog.value;\n};\n\nconst defaultSetter = (): void => {\n\t// DO NOTHING\n};\n\nconst toOptions = <\n\tOPTIONS extends DButtonSelectOptions<any, any, any, any>\n>( options?: OPTIONS ): OPTIONS | undefined => {\n\tif( options ) {\n\t\t// Try to copy text.formatter to dialog.item.text.formatter at first\n\t\tconst formatter = options.text?.formatter;\n\t\tif( formatter !== undefined ) {\n\t\t\tlet dialog = options.dialog;\n\t\t\tif( ! (dialog && \"open\" in dialog) ) {\n\t\t\t\tdialog = dialog || {};\n\t\t\t\tconst item = dialog.item = dialog.item || {};\n\t\t\t\tconst text = item.text = item.text || {};\n\t\t\t\tif( text.formatter === undefined ) {\n\t\t\t\t\t// Assumes formatter is ( value: DIALOG_VALUE | null, caller: any ) => string.\n\t\t\t\t\ttext.formatter = formatter as any;\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// Try to copy dialog.item.text.formatter to text.formatter\n\t\t\tconst dialog = options.dialog;\n\t\t\tif( ! (dialog && \"open\" in dialog) ) {\n\t\t\t\tconst dialogFormatter = dialog?.item?.text?.formatter;\n\t\t\t\tif( dialogFormatter !== undefined ) {\n\t\t\t\t\tconst text = options.text = options.text || {};\n\t\t\t\t\tif( text.formatter === undefined ) {\n\t\t\t\t\t\t// Assumes dialogFormatter is ( value: VALUE | null, caller: any ) => string.\n\t\t\t\t\t\ttext.formatter = dialogFormatter as any;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\treturn options;\n};\n\nexport class DButtonSelect<\n\tVALUE extends unknown = unknown,\n\tDIALOG_VALUE extends unknown = unknown,\n\tDIALOG extends DButtonSelectDialog<DIALOG_VALUE> = DButtonSelectDialog<DIALOG_VALUE>,\n\tTHEME extends DThemeButtonSelect<VALUE> = DThemeButtonSelect<VALUE>,\n\tOPTIONS extends DButtonSelectOptions<VALUE, DIALOG_VALUE, DIALOG, THEME>\n\t\t= DButtonSelectOptions<VALUE, DIALOG_VALUE, DIALOG, THEME>\n> extends DButton<VALUE | null, THEME, OPTIONS> {\n\tprotected _dialog?: DIALOG;\n\tprotected _dialogGetter: DButtonSelectGetter<VALUE, DIALOG>;\n\tprotected _dialogSetter: DButtonSelectSetter<VALUE, DIALOG>;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( toOptions( options ) );\n\t\tthis._dialogGetter = options?.getter ?? defaultGetter;\n\t\tthis._dialogSetter = options?.setter ?? defaultSetter;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst dialog = this.dialog;\n\t\tconst oldValue = this._textValueComputed ?? null;\n\t\tthis._dialogSetter( dialog, oldValue );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = this._dialogGetter( dialog );\n\t\t\tif( newValue !== oldValue ) {\n\t\t\t\tthis.text = newValue;\n\t\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\t}\n\t\t});\n\t}\n\n\tget dialog(): DIALOG {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options && (\"open\" in options) ) {\n\t\t\t\tdialog = options;\n\t\t\t} else {\n\t\t\t\t// Assumes DIALOG === DDialogSelect<DIALOG_VALUE>.\n\t\t\t\tdialog = new DDialogSelect<DIALOG_VALUE>( options ) as unknown as DIALOG;\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): VALUE | null {\n\t\treturn this._textValueComputed ?? null;\n\t}\n\n\tset value( value: VALUE | null ) {\n\t\tthis.text = value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonSelect\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogTime } from \"./d-dialog-time\";\n\nexport class DDialogTimes {\n\tprotected static INSTANCE?: DDialogTime;\n\tstatic getInstance(): DDialogTime {\n\t\tif( DDialogTimes.INSTANCE == null ) {\n\t\t\tDDialogTimes.INSTANCE = new DDialogTime();\n\t\t}\n\t\treturn DDialogTimes.INSTANCE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonEvents, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogTime, DDialogTimeOptions } from \"./d-dialog-time\";\nimport { DDialogTimes } from \"./d-dialog-times\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\n\n/**\n * {@link DButtonTime} events.\n */\nexport interface DButtonTimeEvents<EMITTER> extends DButtonEvents<Date, EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: Date, oldValue: Date, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DButtonTime} \"on\" options.\n */\nexport interface DButtonTimeOnOptions<EMITTER> extends Partial<DButtonTimeEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DButtonTime} options.\n */\nexport interface DButtonTimeOptions<\n\tTHEME extends DThemeButtonTime = DThemeButtonTime,\n\tEMITTER = any\n> extends DButtonOptions<Date, THEME, EMITTER> {\n\tdialog?: DDialogTimeOptions;\n\ton?: DButtonTimeOnOptions<EMITTER>;\n}\n\n/**\n * {@link DButtonTime} theme.\n */\nexport interface DThemeButtonTime extends DThemeButton<Date> {\n\n}\n\nexport class DButtonTime<\n\tTHEME extends DThemeButtonTime = DThemeButtonTime,\n\tOPTIONS extends DButtonTimeOptions<THEME> = DButtonTimeOptions<THEME>\n> extends DButton<Date, THEME, OPTIONS> {\n\tprotected _dialog?: DDialogTime;\n\tprotected _datetimeMask?: DPickerDatetimeMask;\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed?.getTime() ?? Date.now();\n\t\tconst dialog = this.dialog;\n\t\tdialog.current = new Date( value );\n\t\tdialog.new = new Date( value );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = dialog.new;\n\t\t\tconst oldValue = dialog.current;\n\t\t\tthis.text = new Date( newValue.getTime() );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\tlet result = this._datetimeMask;\n\t\tif( result == null ) {\n\t\t\tresult = DPickerTimes.toMask( this._options?.dialog?.picker );\n\t\t\tthis._datetimeMask = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tget dialog(): DDialogTime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options ) {\n\t\t\t\tdialog = new DDialogTime( options );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogTimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget value(): Date {\n\t\treturn this._textValueComputed ?? new Date();\n\t}\n\n\tset value( value: Date ) {\n\t\tconst textValueComputed = this._textValueComputed;\n\t\tif( textValueComputed === undefined || textValueComputed.getTime() !== value.getTime() ) {\n\t\t\tthis.text = value;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DButtonTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DButtonUndo<\n\tVALUE = unknown,\n\tTHEME extends DThemeButton<VALUE> = DThemeButton<VALUE>,\n\tOPTIONS extends DButtonOptions<VALUE, THEME> = DButtonOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst state = this.state;\n\t\tconst commandController = DControllers.getCommandController();\n\t\tstate.isDisabled = ! commandController.isUndoable();\n\t\tcommandController.on( \"change\", (): void => {\n\t\t\tstate.isDisabled = ! commandController.isUndoable();\n\t\t});\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tDControllers.getCommandController().undo();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase,  DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DCanvasOptions<THEME extends DThemeCanvas = DThemeCanvas> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeCanvas extends DThemeBase {\n\n}\n\nexport class DCanvas<\n\tTHEME extends DThemeCanvas = DThemeCanvas,\n\tOPTIONS extends DCanvasOptions<THEME> = DCanvasOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DCanvas\";\n\t}\n}\n","import { isNumber } from \"../util/is-number\";\nimport { isString } from \"../util/is-string\";\nimport { EShapePointsStyle } from \"./e-shape-points-style\";\n\nexport type EShapePointsStyleOption = EShapePointsStyle | keyof typeof EShapePointsStyle |\n\tArray<keyof typeof EShapePointsStyle>;\n\nexport class EShapePointsStyles {\n\tstatic from( style: EShapePointsStyleOption | undefined ): EShapePointsStyle {\n\t\tif( isString( style ) ) {\n\t\t\treturn EShapePointsStyle[ style ];\n\t\t} else if( isNumber( style ) ) {\n\t\t\treturn style;\n\t\t} else if( style != null ) {\n\t\t\tlet result = EShapePointsStyle.NONE;\n\t\t\tfor( let i = 0, imax = style.length; i < imax; ++i ) {\n\t\t\t\tresult |= EShapePointsStyle[ style[ i ] ];\n\t\t\t}\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn EShapePointsStyle.NONE;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\n\nexport enum DChartCoordinateDirection {\n\tX,\n\tY\n}\n\nexport interface DChartCoordinate {\n\t/**\n\t * Monotonic increasing ID for change detection.\n\t */\n\treadonly id: number;\n\treadonly transform: DChartCoordinateTransform;\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void;\n\tunbind(): void;\n\n\t/**\n\t * Adjusts the transform so that mapped points of the given range fit into the plot area\n\t * if the plot area container's localTransform is an identity matrix.\n\t *\n\t * @param from a lower end of the range\n\t * @param to an upper end of the range\n\t */\n\tfit( from?: number, to?: number ): void;\n\n\tmark( from?: number, to?: number ): void;\n\n\tblend( ratio: number ): void;\n\n\t/**\n\t * Transforms the given raw value to the untransformed value.\n\t *\n\t * @param value a raw value\n\t */\n\tmap( value: number ): number;\n\n\t/**\n\t * Transforms the given raw values to untransformed values.\n\t * Numbers whose indices are ifrom + i * stride + offset and less than iend will be transformed.\n\t * Here, i is a non-negative integer.\n\t *\n\t * @param values raw values to be transformed\n\t * @param ifrom an index on raw values at which to begin a transformation\n\t * @param iend an index on raw values before which to end a transformation\n\t * @param stride a stride of indices\n\t * @param offset an offset of indices\n\t */\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void;\n\n\t/**\n\t * Transforms the given untransformed value to the raw value.\n\t *\n\t * @param value an untransformed value\n\t */\n\tunmap( value: number ): number;\n\n\t/**\n\t * Transforms the given untransformed values to raw values.\n\t * Numbers whose indices are ifrom + i * stride + offset and less than iend will be transformed.\n\t * Here, i is a non-negative integer.\n\t *\n\t * @param values untrasformed values to be transformed\n\t * @param ifrom an index on raw values at which to begin a transformation\n\t * @param iend an index on raw values at which to begin a transformation\n\t * @param stride a stride of indices\n\t * @param offset an offset of indices\n\t */\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void;\n\n\t/**\n\t * Returns major / minor tick positions.\n\t *\n\t * @param domainMin minimum domain\n\t * @param domainMax maximum domain\n\t * @param majorCount Expected major tick count\n\t * @param minorCountPerMajor Expected minor tick count per major ticks\n\t * @param minorCount Expected total minor tick count\n\t * @param majorResult `majorResult.length` must be larger than `majorCount * 3`.\n\t * @param minorResult `minorResult.length` must be larger than `minorCount * 3`.\n\t */\n\tticks(\n\t\tdomainMin: number,\n\t\tdomainMax: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDChartAxisBaseOptions, DChartAxisBaseTickContainerOptions,\n\tDChartAxisBaseTickMajorGridlineOptions, DChartAxisBaseTickMajorOptions,\n\tDChartAxisBaseTickMajorTextOptions, DThemeChartAxisBase\n} from \"./d-chart-axis-base-options\";\nimport { DChartAxisPosition } from \"./d-chart-axis-position\";\nimport { DChartAxisTickPosition } from \"./d-chart-axis-tick-position\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points-style\";\nimport { EShapePointsStyleOption, EShapePointsStyles } from \"./shape/e-shape-points-styles\";\nimport { EShapeStrokeLike } from \"./shape/e-shape-stroke\";\nimport { EShapeStrokeSide } from \"./shape/e-shape-stroke-side\";\nimport { EShapeTextLike } from \"./shape/e-shape-text\";\nimport { EShapeTextAlignLike } from \"./shape/e-shape-text-align\";\nimport { EShapeTextDirection } from \"./shape/e-shape-text-direction\";\nimport { EShapeTextOffsetLike } from \"./shape/e-shape-text-offset\";\nimport { EShapeTextOutlineLike } from \"./shape/e-shape-text-outline\";\nimport { EShapeBar } from \"./shape/variant/e-shape-bar\";\nimport { EShapeBarPosition } from \"./shape/variant/e-shape-bar-position\";\nimport { DeepPartial } from \"./util/deep-partial\";\nimport { isString } from \"./util/is-string\";\nimport { NumberFormatter } from \"./util/number-formatter\";\nimport { NumberFormatters } from \"./util/number-formatters\";\n\nexport interface DChartAxisBaseGridline {\n\tenable: boolean;\n\tstyle?: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tshapes?: EShapeBar[];\n}\n\nexport interface DChartAxisBaseTickMajor {\n\tcount: number;\n\tsize: number;\n\tposition: EShapeBarPosition;\n\tstyle?: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\ttext?: DChartAxisBaseTickMajorTextOptions;\n\tformatter: NumberFormatter;\n\tshapes?: EShapeBar[];\n\n\tgridline: DChartAxisBaseGridline;\n}\n\nexport interface DChartAxisBaseTickMinor {\n\tcount: number;\n\tsize: number;\n\tposition: EShapeBarPosition;\n\tstyle?: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tshapes?: EShapeBar[];\n}\n\nexport interface DChartAxisBaseBar {\n\tstyle?: EShapePointsStyle;\n\tstroke?: Partial<EShapeStrokeLike>;\n\tshape?: EShapeBar;\n}\n\nexport interface DChartAxisBaseTickContainer {\n\tenable: boolean;\n\tmajor: DChartAxisBaseTickMajor;\n\tminor: DChartAxisBaseTickMinor;\n}\n\nexport class DChartAxisBaseOptionParser {\n\tprotected _coordinateIndex: number;\n\tprotected _position: DChartAxisPosition;\n\tprotected _tick: DChartAxisBaseTickContainer;\n\tprotected _label: DeepPartial<EShapeTextLike> | undefined;\n\tprotected _padding: number;\n\tprotected _bar: DChartAxisBaseBar;\n\n\tconstructor( theme: DThemeChartAxisBase, options?: DChartAxisBaseOptions ) {\n\t\tthis._coordinateIndex = ( options && options.coordinate != null ? options.coordinate : 0 );\n\t\tthis._position = this.toPosition( theme, options );\n\t\tthis._tick = this.toTickContainer( theme, options );\n\t\tthis._label = this.toLabel( theme, options );\n\t\tthis._padding = ( options && options.padding != null ? options.padding : theme.getPadding() );\n\t\tthis._bar = this.toBar( theme, options );\n\t}\n\n\tget coordinateIndex(): number {\n\t\treturn this._coordinateIndex;\n\t}\n\n\tget padding(): number {\n\t\treturn this._padding;\n\t}\n\n\tget position(): DChartAxisPosition {\n\t\treturn this._position;\n\t}\n\n\tget bar(): DChartAxisBaseBar {\n\t\treturn this._bar;\n\t}\n\n\tget tick(): DChartAxisBaseTickContainer {\n\t\treturn this._tick;\n\t}\n\n\tget label(): DeepPartial<EShapeTextLike> | undefined {\n\t\treturn this._label;\n\t}\n\n\tprotected toPosition(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisPosition {\n\t\tconst position = options && options.position;\n\t\tif( isString( position ) ) {\n\t\t\treturn DChartAxisPosition[ position ];\n\t\t} else if( position != null ) {\n\t\t\treturn position;\n\t\t}\n\t\treturn theme.getPosition();\n\t}\n\n\tprotected toBar(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisBaseBar {\n\t\treturn {\n\t\t\tstyle: options && options.style != null ? options.style : theme.getStyle(),\n\t\t\tstroke: this.toBarStroke( theme, options && options.stroke ),\n\t\t\tshape: undefined\n\t\t};\n\t}\n\n\tprotected toTickContainer(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DChartAxisBaseTickContainer {\n\t\tconst tick = options && options.tick;\n\t\treturn {\n\t\t\tenable: ( tick && tick.enable != null ? tick.enable : theme.getTickEnable() ),\n\t\t\tmajor: this.toTickMajor( theme, tick ),\n\t\t\tminor: this.toMinorTick( theme, tick )\n\t\t};\n\t}\n\n\tprotected toTickMajor(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickContainerOptions\n\t): DChartAxisBaseTickMajor {\n\t\tconst major: DChartAxisBaseTickMajorOptions | undefined = options && options.major;\n\t\tconst position = ( major && major.position != null ? major.position :\n\t\t\t( options && options.position != null ? options.position : theme.getMajorTickPosition() )\n\t\t);\n\t\tconst optionsStyle = options && options.style;\n\t\tconst style = EShapePointsStyles.from( major && major.style != null ? major.style :\n\t\t\t( optionsStyle != null ? optionsStyle : theme.getMajorTickStyle() )\n\t\t);\n\t\tconst optionsStroke = options && options.stroke;\n\t\tconst stroke = this.toTickMajorStroke( theme, major && major.stroke, optionsStroke );\n\t\treturn {\n\t\t\tcount: ( major && major.count != null ? major.count : theme.getMajorTickCount() ),\n\t\t\tsize: ( major && major.size != null ? major.size : theme.getMajorTickSize() ),\n\t\t\tposition: this.toTickPosition( position ),\n\t\t\tstyle,\n\t\t\tstroke,\n\t\t\ttext: this.toMajorTickText( theme, major && major.text ),\n\t\t\tformatter: this.toMajorTickFormatter( theme, major ),\n\t\t\tshapes: undefined,\n\t\t\tgridline: this.toTickMajorGridline( theme, major && major.gridline, optionsStyle, optionsStroke )\n\t\t};\n\t}\n\n\tprotected toTickMajorGridline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions: DChartAxisBaseTickMajorGridlineOptions | undefined,\n\t\toptionsStyle: EShapePointsStyleOption | undefined,\n\t\toptionsStroke: Partial<EShapeStrokeLike> | undefined\n\t): DChartAxisBaseGridline {\n\t\tconst style = EShapePointsStyles.from( options && options.style != null ? options.style :\n\t\t\t( optionsStyle != null ? optionsStyle : theme.getMajorTickGridlineStyle() )\n\t\t);\n\t\treturn {\n\t\t\tenable: options && options.enable != null ? options.enable : theme.getMajorTickGridlineEnable(),\n\t\t\tstyle,\n\t\t\tstroke: this.toTickMajorGridlineStroke( theme, options && options.stroke, optionsStroke ),\n\t\t\tshapes: undefined\n\t\t};\n\t}\n\n\tprotected toTickPosition(\n\t\ttickPosition: DChartAxisTickPosition | keyof typeof DChartAxisTickPosition\n\t): EShapeBarPosition {\n\t\tconst position = this._position;\n\t\tif( tickPosition === DChartAxisTickPosition.OUTSIDE || tickPosition === \"OUTSIDE\" ) {\n\t\t\tswitch( position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\treturn EShapeBarPosition.BOTTOM;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\treturn EShapeBarPosition.RIGHT;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\treturn EShapeBarPosition.LEFT;\n\t\t\tdefault:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\t}\n\t\t} else {\n\t\t\tswitch( position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\treturn EShapeBarPosition.BOTTOM;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\treturn EShapeBarPosition.LEFT;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\treturn EShapeBarPosition.RIGHT;\n\t\t\tdefault:\n\t\t\t\treturn EShapeBarPosition.TOP;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toMinorTick(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickContainerOptions\n\t): DChartAxisBaseTickMinor {\n\t\tconst minor: DChartAxisBaseTickMajorOptions | undefined = options && options.major;\n\t\tconst position = ( minor && minor.position != null ? minor.position :\n\t\t\t( options && options.position != null ? options.position : theme.getMinorTickPosition() )\n\t\t);\n\t\tconst style = EShapePointsStyles.from( minor && minor.style != null ? minor.style :\n\t\t\t( options && options.style != null ? options.style : theme.getMinorTickStyle() )\n\t\t);\n\t\treturn {\n\t\t\tcount: ( minor && minor.count != null ? minor.count : theme.getMinorTickCount() ),\n\t\t\tsize: ( minor && minor.size != null ? minor.size : theme.getMinorTickSize() ),\n\t\t\tposition: this.toTickPosition( position ),\n\t\t\tstyle,\n\t\t\tstroke: this.toTickMinorStroke( theme, minor && minor.stroke, options && options.stroke ),\n\t\t\tshapes: undefined\n\t\t};\n\t}\n\n\tprotected toBarStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeStrokeLike>\n\t): Partial<EShapeStrokeLike> {\n\t\treturn this.toStroke(\n\t\t\toptions, undefined,\n\t\t\ttheme.getStrokeEnable(),\n\t\t\ttheme.getStrokeColor(),\n\t\t\ttheme.getStrokeAlpha(),\n\t\t\ttheme.getStrokeWidth(),\n\t\t\ttheme.getStrokeAlign(),\n\t\t\ttheme.getStrokeSide()\n\t\t);\n\t}\n\n\tprotected toTickMajorStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptionsA?: Partial<EShapeStrokeLike>,\n\t\toptionsB?: Partial<EShapeStrokeLike>\n\t): Partial<EShapeStrokeLike> {\n\t\treturn this.toStroke(\n\t\t\toptionsA, optionsB,\n\t\t\ttheme.getMajorTickStrokeEnable(),\n\t\t\ttheme.getMajorTickStrokeColor(),\n\t\t\ttheme.getMajorTickStrokeAlpha(),\n\t\t\ttheme.getMajorTickStrokeWidth(),\n\t\t\ttheme.getMajorTickStrokeAlign(),\n\t\t\ttheme.getMajorTickStrokeSide()\n\t\t);\n\t}\n\n\tprotected toTickMajorGridlineStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptionsA?: Partial<EShapeStrokeLike>,\n\t\toptionsB?: Partial<EShapeStrokeLike>\n\t): Partial<EShapeStrokeLike> {\n\t\treturn this.toStroke(\n\t\t\toptionsA, optionsB,\n\t\t\ttheme.getMajorTickGridlineStrokeEnable(),\n\t\t\ttheme.getMajorTickGridlineStrokeColor(),\n\t\t\ttheme.getMajorTickGridlineStrokeAlpha(),\n\t\t\ttheme.getMajorTickGridlineStrokeWidth(),\n\t\t\ttheme.getMajorTickGridlineStrokeAlign(),\n\t\t\ttheme.getMajorTickGridlineStrokeSide()\n\t\t);\n\t}\n\n\tprotected toTickMinorStroke(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptionsA?: Partial<EShapeStrokeLike>,\n\t\toptionsB?: Partial<EShapeStrokeLike>\n\t): Partial<EShapeStrokeLike> {\n\t\treturn this.toStroke(\n\t\t\toptionsA, optionsB,\n\t\t\ttheme.getMinorTickStrokeEnable(),\n\t\t\ttheme.getMinorTickStrokeColor(),\n\t\t\ttheme.getMinorTickStrokeAlpha(),\n\t\t\ttheme.getMinorTickStrokeWidth(),\n\t\t\ttheme.getMinorTickStrokeAlign(),\n\t\t\ttheme.getMinorTickStrokeSide()\n\t\t);\n\t}\n\n\tprotected toStroke(\n\t\toptionsA: Partial<EShapeStrokeLike> | undefined,\n\t\toptionsB: Partial<EShapeStrokeLike> | undefined,\n\t\tenable: boolean | undefined,\n\t\tcolor: number | undefined,\n\t\talpha: number | undefined,\n\t\twidth: number | undefined,\n\t\talign: number | undefined,\n\t\tside: EShapeStrokeSide | undefined\n\t): Partial<EShapeStrokeLike> {\n\t\tif( optionsA ) {\n\t\t\tif( optionsB ) {\n\t\t\t\treturn {\n\t\t\t\t\tenable: ( optionsA.enable != null ? optionsA.enable :\n\t\t\t\t\t\t( optionsB.enable != null ? optionsB.enable : enable )\n\t\t\t\t\t),\n\t\t\t\t\tcolor: ( optionsA.color != null ? optionsA.color :\n\t\t\t\t\t\t( optionsB.color != null ? optionsB.color : color )\n\t\t\t\t\t),\n\t\t\t\t\talpha: ( optionsA.alpha != null ? optionsA.alpha :\n\t\t\t\t\t\t( optionsB.alpha != null ? optionsB.alpha : alpha )\n\t\t\t\t\t),\n\t\t\t\t\twidth: ( optionsA.width != null ? optionsA.width :\n\t\t\t\t\t\t( optionsB.width != null ? optionsB.width : width )\n\t\t\t\t\t),\n\t\t\t\t\talign: ( optionsA.align != null ? optionsA.align :\n\t\t\t\t\t\t( optionsB.align != null ? optionsB.align : align )\n\t\t\t\t\t),\n\t\t\t\t\tside: ( optionsA.side != null ? optionsA.side :\n\t\t\t\t\t\t( optionsB.side != null ? optionsB.side : side )\n\t\t\t\t\t)\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn {\n\t\t\t\t\tenable: ( optionsA.enable != null ? optionsA.enable : enable ),\n\t\t\t\t\tcolor: ( optionsA.color != null ? optionsA.color : color ),\n\t\t\t\t\talpha: ( optionsA.alpha != null ? optionsA.alpha : alpha ),\n\t\t\t\t\twidth: ( optionsA.width != null ? optionsA.width : width ),\n\t\t\t\t\talign: ( optionsA.align != null ? optionsA.align : align ),\n\t\t\t\t\tside: ( optionsA.side != null ? optionsA.side : side )\n\t\t\t\t};\n\t\t\t}\n\t\t} else if( optionsB ) {\n\t\t\treturn {\n\t\t\t\tenable: ( optionsB.enable != null ? optionsB.enable : enable ),\n\t\t\t\tcolor: ( optionsB.color != null ? optionsB.color : color ),\n\t\t\t\talpha: ( optionsB.alpha != null ? optionsB.alpha : alpha ),\n\t\t\t\twidth: ( optionsB.width != null ? optionsB.width : width ),\n\t\t\t\talign: ( optionsB.align != null ? optionsB.align : align ),\n\t\t\t\tside: ( optionsB.side != null ? optionsB.side : side )\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tenable,\n\t\t\t\tcolor,\n\t\t\t\talpha,\n\t\t\t\twidth,\n\t\t\t\talign,\n\t\t\t\tside\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickFormatter(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickMajorOptions\n\t): NumberFormatter {\n\t\tconst text = options && options.text;\n\t\tif( text ) {\n\t\t\tconst format = text.format;\n\t\t\tif( format != null ) {\n\t\t\t\treturn NumberFormatters.create( format );\n\t\t\t} else {\n\t\t\t\tconst formatter = text.formatter;\n\t\t\t\tif( formatter ) {\n\t\t\t\t\treturn {\n\t\t\t\t\t\tformat: formatter\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn NumberFormatters.create(\n\t\t\ttheme.getMajorTickTextFormat()\n\t\t);\n\t}\n\n\tprotected toMajorTickText(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseTickMajorTextOptions\n\t): DChartAxisBaseTickMajorTextOptions | undefined {\n\t\toptions = options || {};\n\t\treturn {\n\t\t\tformat: options.format,\n\t\t\tcolor: this.toMajorTickTextColor( theme, options.color ),\n\t\t\talpha: options.alpha,\n\t\t\tfamily: options.family,\n\t\t\tsize: options.size,\n\t\t\tweight: options.weight,\n\t\t\talign: this.toMajorTickTextAlign( theme, options.align ),\n\t\t\toffset: this.toMajorTickTextOffset( theme, options.offset ),\n\t\t\tstyle: options.style,\n\t\t\toutline: this.toMajorTickTextOutline( theme, options.outline ),\n\t\t\tspacing: this.toMajorTickTextSpacing( theme, options.spacing ),\n\t\t\tdirection: this.toTickMajorTextDirection( theme, options.direction ),\n\t\t\tpadding: this.toMajorTickTextPadding( theme, options.padding ),\n\t\t\tclipping: options.clipping\n\t\t};\n\t}\n\n\tprotected toMajorTickTextOutline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOutlineLike>\n\t): Partial<EShapeTextOutlineLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\tenable: options.enable,\n\t\t\t\tcolor: options.color,\n\t\t\t\talpha: options.alpha,\n\t\t\t\twidth: options.width\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextAlign(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextAlignLike>\n\t): Partial<EShapeTextAlignLike> | undefined {\n\t\tconst position = this._position;\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: ( options.horizontal != null ? options.horizontal :\n\t\t\t\t\ttheme.getMajorTickTextAlignHorizontal( position )\n\t\t\t\t),\n\t\t\t\tvertical: ( options.vertical != null ? options.vertical :\n\t\t\t\t\ttheme.getMajorTickTextAlignVertical( position )\n\t\t\t\t)\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\thorizontal: theme.getMajorTickTextAlignHorizontal( position ),\n\t\t\tvertical: theme.getMajorTickTextAlignVertical( position )\n\t\t};\n\t}\n\n\tprotected toMajorTickTextOffset(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextSpacing(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toMajorTickTextPadding(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> {\n\t\treturn {\n\t\t\thorizontal: ( options && options.horizontal != null ?\n\t\t\t\toptions.horizontal : theme.getMajorTickTextPaddingHorizontal()\n\t\t\t),\n\t\t\tvertical: ( options && options.vertical != null ?\n\t\t\t\toptions.vertical : theme.getMajorTickTextPaddingVertical()\n\t\t\t)\n\t\t};\n\t}\n\n\tprotected toTickMajorTextDirection(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: EShapeTextDirection\n\t): EShapeTextDirection {\n\t\treturn ( options != null ? options : theme.getMajorTickTextDirection() );\n\t}\n\n\tprotected toMajorTickTextColor(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: number\n\t): number | undefined {\n\t\treturn ( options != null ? options : theme.getMajorTickTextColor() );\n\t}\n\n\tprotected toLabel(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: DChartAxisBaseOptions\n\t): DeepPartial<EShapeTextLike> | undefined {\n\t\tconst label = options && options.label;\n\t\tif( label ) {\n\t\t\treturn {\n\t\t\t\tvalue: label.value,\n\t\t\t\tcolor: this.toLabelColor(theme, label.color),\n\t\t\t\talpha: label.alpha,\n\t\t\t\tfamily: label.family,\n\t\t\t\tsize: label.size,\n\t\t\t\tweight: label.weight,\n\t\t\t\talign: this.toLabelAlign( theme, label.align ),\n\t\t\t\toffset: this.toLabelOffset( theme, label.offset ),\n\t\t\t\tstyle: label.style,\n\t\t\t\toutline: this.toLabelOutline( theme, label.outline ),\n\t\t\t\tspacing: this.toLabelSpacing( theme, label.spacing ),\n\t\t\t\tdirection: this.toLabelDirection( theme, label.direction ),\n\t\t\t\tpadding: this.toLabelPadding( theme, label.padding ),\n\t\t\t\tclipping: label.clipping\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelOutline(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOutlineLike>\n\t): Partial<EShapeTextOutlineLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\tenable: options.enable,\n\t\t\t\tcolor: options.color,\n\t\t\t\talpha: options.alpha,\n\t\t\t\twidth: options.width\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelAlign(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextAlignLike>\n\t): Partial<EShapeTextAlignLike> | undefined {\n\t\tconst position = this._position;\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: ( options.horizontal != null ?\n\t\t\t\t\toptions.horizontal : theme.getLabelAlignHorizontal( position )\n\t\t\t\t),\n\t\t\t\tvertical: ( options.vertical != null ?\n\t\t\t\t\toptions.vertical : theme.getLabelAlignVertical( position )\n\t\t\t\t)\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\thorizontal: theme.getLabelAlignHorizontal( position ),\n\t\t\tvertical: theme.getLabelAlignVertical( position )\n\t\t};\n\t}\n\n\tprotected toLabelOffset(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelSpacing(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> | undefined {\n\t\tif( options ) {\n\t\t\treturn {\n\t\t\t\thorizontal: options.horizontal,\n\t\t\t\tvertical: options.vertical\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected toLabelPadding(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: Partial<EShapeTextOffsetLike>\n\t): Partial<EShapeTextOffsetLike> {\n\t\treturn {\n\t\t\thorizontal: ( options && options.horizontal != null ?\n\t\t\t\toptions.horizontal : theme.getLabelPaddingHorizontal()\n\t\t\t),\n\t\t\tvertical: ( options && options.vertical != null ?\n\t\t\t\toptions.vertical : theme.getLabelPaddingVertical()\n\t\t\t)\n\t\t};\n\t}\n\n\tprotected toLabelDirection(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: EShapeTextDirection\n\t): EShapeTextDirection {\n\t\treturn ( options != null ? options : theme.getLabelDirection() );\n\t}\n\n\tprotected toLabelColor(\n\t\ttheme: DThemeChartAxisBase,\n\t\toptions?: number\n\t): number | undefined {\n\t\treturn ( options != null ? options : theme.getLabelColor() );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Matrix } from \"pixi.js\";\nimport { DChartAxis } from \"./d-chart-axis\";\nimport { DChartAxisBaseOptions, DThemeChartAxisBase } from \"./d-chart-axis-base-options\";\nimport {\n\tDChartAxisBaseBar, DChartAxisBaseOptionParser, DChartAxisBaseTickContainer\n} from \"./d-chart-axis-base-options-parser\";\nimport { DChartAxisContainer } from \"./d-chart-axis-container\";\nimport { DChartAxisPosition } from \"./d-chart-axis-position\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { EShapeTextLike } from \"./shape/e-shape-text\";\nimport { EShapeBar } from \"./shape/variant/e-shape-bar\";\nimport { EShapeBarPosition } from \"./shape/variant/e-shape-bar-position\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { DeepPartial } from \"./util/deep-partial\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport class DChartAxisBase<\n\tOPTIONS extends DChartAxisBaseOptions = DChartAxisBaseOptions\n> implements DChartAxis {\n\tprotected _coordinateIndex: number;\n\tprotected _padding: number;\n\tprotected _position: DChartAxisPosition;\n\tprotected _container?: DChartAxisContainer;\n\tprotected _bar: DChartAxisBaseBar;\n\tprotected _index: number;\n\tprotected _tick: DChartAxisBaseTickContainer;\n\tprotected _majorTicks: Float64Array;\n\tprotected _minorTicks: Float64Array;\n\tprotected _label?: DeepPartial<EShapeTextLike>;\n\tprotected _theme: DThemeChartAxisBase;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tthis._index = 0;\n\n\t\tconst parser = new DChartAxisBaseOptionParser( theme, options );\n\t\tthis._coordinateIndex = parser.coordinateIndex;\n\t\tthis._padding = parser.padding;\n\t\tthis._position = parser.position;\n\t\tconst tick = parser.tick;\n\t\tthis._tick = tick;\n\t\tthis._label = parser.label;\n\t\tthis._bar = parser.bar;\n\t\tthis._majorTicks = new Float64Array( tick.major.count * 3 );\n\t\tthis._minorTicks = new Float64Array( (tick.major.count + 1) * tick.minor.count * 3 );\n\t}\n\n\tget position(): DChartAxisPosition {\n\t\treturn this._position;\n\t}\n\n\tprotected updateBar( container: DChartAxisContainer ): void {\n\t\tconst bar = this._bar;\n\t\tconst barShape = bar.shape;\n\t\tif( barShape ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\tconst plotAreaHeight = plotArea.height;\n\t\t\tconst padding = this._padding * this._index;\n\t\t\tbarShape.disallowUploadedUpdate();\n\t\t\tswitch( this._position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\tbarShape.transform.position.set( plotAreaWidth * 0.5, 0 - padding );\n\t\t\t\tbarShape.size.set( plotAreaWidth, 0 );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\tbarShape.transform.position.set( plotAreaWidth * 0.5, plotAreaHeight + padding );\n\t\t\t\tbarShape.size.set( plotAreaWidth, 0 );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\tbarShape.transform.position.set( 0 - padding, plotAreaHeight * 0.5 );\n\t\t\t\tbarShape.size.set( 0, plotAreaHeight );\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\tbarShape.transform.position.set( plotAreaWidth + padding, plotAreaHeight * 0.5 );\n\t\t\t\tbarShape.size.set( 0, plotAreaHeight );\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tbarShape.allowUploadedUpdate();\n\t\t}\n\t}\n\n\tupdateTicksX(\n\t\tdomainMin: number, domainMax: number,\n\t\tcoordinate: DChartCoordinate,\n\t\tmajorShapes: EShapeBar[], minorShapes: EShapeBar[], gridlineShapes: EShapeBar[] | undefined,\n\t\tshapePositionY: number,\n\t\ttransform: Matrix, plotAreaHeight: number\n\t): void {\n\t\tconst tick = this._tick;\n\t\tconst majorCount = tick.major.count;\n\t\tconst majorFormatter = tick.major.formatter;\n\t\tconst minorCountPerMajor = tick.minor.count;\n\t\tconst minorCount = (majorCount + 1) * minorCountPerMajor;\n\t\tconst majorTicks = this._majorTicks;\n\t\tconst minorTicks = this._minorTicks;\n\t\tcoordinate.ticks(\n\t\t\tdomainMin, domainMax,\n\t\t\tmajorCount, minorCountPerMajor, minorCount,\n\t\t\tmajorTicks, minorTicks\n\t\t);\n\n\t\tconst a = transform.a;\n\t\tconst tx = transform.tx;\n\t\tfor( let i = 0; i < majorCount; ++i ) {\n\t\t\tconst majorShape = majorShapes[ i ];\n\t\t\tconst imajorTick = i * 3;\n\t\t\tconst majorTickPosition = majorTicks[ imajorTick + 0 ];\n\t\t\tif( ! isNaN( majorTickPosition ) ) {\n\t\t\t\tconst majorTickProjectedPosition = majorTicks[ imajorTick + 1 ];\n\t\t\t\tconst majotTickPositionX = a * majorTickProjectedPosition + tx;\n\t\t\t\tconst majorTickStep = majorTicks[ imajorTick + 2 ];\n\n\t\t\t\tmajorShape.disallowUploadedUpdate();\n\t\t\t\tmajorShape.visible = true;\n\t\t\t\tmajorShape.transform.position.set( majotTickPositionX, shapePositionY );\n\t\t\t\tmajorShape.text.value = majorFormatter.format( majorTickPosition, majorTickStep );\n\t\t\t\tmajorShape.allowUploadedUpdate();\n\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tconst gridlineShape = gridlineShapes[ i ];\n\t\t\t\t\tgridlineShape.disallowUploadedUpdate();\n\t\t\t\t\tgridlineShape.visible = true;\n\t\t\t\t\tgridlineShape.transform.position.set( majotTickPositionX, plotAreaHeight * 0.5 );\n\t\t\t\t\tgridlineShape.size.set( 0, plotAreaHeight );\n\t\t\t\t\tgridlineShape.allowUploadedUpdate();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmajorShape.visible = false;\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tgridlineShapes[ i ].visible = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\tconst minorShape = minorShapes[ i ];\n\t\t\tconst iminorTick = i * 3;\n\t\t\tconst minorTickPosition = minorTicks[ iminorTick + 0 ];\n\t\t\tconst minorTickProjectedPosition = minorTicks[ iminorTick + 1 ];\n\t\t\tif( ! isNaN( minorTickPosition ) ) {\n\t\t\t\tminorShape.disallowUploadedUpdate();\n\t\t\t\tminorShape.visible = true;\n\t\t\t\tminorShape.transform.position.set(\n\t\t\t\t\ta * minorTickProjectedPosition + tx,\n\t\t\t\t\tshapePositionY\n\t\t\t\t);\n\t\t\t\tminorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tminorShape.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tupdateTicksY(\n\t\tdomainMin: number, domainMax: number,\n\t\tcoordinate: DChartCoordinate,\n\t\tmajorShapes: EShapeBar[], minorShapes: EShapeBar[], gridlineShapes: EShapeBar[] | undefined,\n\t\tshapePositionX: number,\n\t\ttransform: Matrix, plotAreaWidth: number\n\t): void {\n\t\tconst tick = this._tick;\n\t\tconst majorCount = tick.major.count;\n\t\tconst majorFormatter = tick.major.formatter;\n\t\tconst minorCountPerMajor = tick.minor.count;\n\t\tconst minorCount = (majorCount + 1) * minorCountPerMajor;\n\t\tconst majorTicks = this._majorTicks;\n\t\tconst minorTicks = this._minorTicks;\n\t\tcoordinate.ticks(\n\t\t\tdomainMin, domainMax,\n\t\t\tmajorCount, minorCountPerMajor, minorCount,\n\t\t\tmajorTicks, minorTicks\n\t\t);\n\n\t\tconst d = transform.d;\n\t\tconst ty = transform.ty;\n\t\tfor( let i = 0; i < majorCount; ++i ) {\n\t\t\tconst majorShape = majorShapes[ i ];\n\t\t\tconst imajorTick = i * 3;\n\t\t\tconst majorTickPosition = majorTicks[ imajorTick + 0 ];\n\t\t\tif( ! isNaN( majorTickPosition ) ) {\n\t\t\t\tconst majorTickProjectedPosition = majorTicks[ imajorTick + 1 ];\n\t\t\t\tconst majotTickPositionY = d * majorTickProjectedPosition + ty;\n\t\t\t\tconst majorTickStep = majorTicks[ imajorTick + 2 ];\n\n\t\t\t\tmajorShape.disallowUploadedUpdate();\n\t\t\t\tmajorShape.visible = true;\n\t\t\t\tmajorShape.transform.position.set( shapePositionX, majotTickPositionY );\n\t\t\t\tmajorShape.text.value = majorFormatter.format( majorTickPosition, majorTickStep );\n\t\t\t\tmajorShape.allowUploadedUpdate();\n\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tconst gridlineShape = gridlineShapes[ i ];\n\t\t\t\t\tgridlineShape.disallowUploadedUpdate();\n\t\t\t\t\tgridlineShape.visible = true;\n\t\t\t\t\tgridlineShape.transform.position.set( plotAreaWidth * 0.5, majotTickPositionY );\n\t\t\t\t\tgridlineShape.size.set( plotAreaWidth, 0 );\n\t\t\t\t\tgridlineShape.allowUploadedUpdate();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tmajorShape.visible = false;\n\t\t\t\tif( gridlineShapes ) {\n\t\t\t\t\tgridlineShapes[ i ].visible = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\tconst minorShape = minorShapes[ i ];\n\t\t\tconst iminorTick = i * 3;\n\t\t\tconst minorTickPosition = minorTicks[ iminorTick + 0 ];\n\t\t\tconst minorTickProjectedPosition = minorTicks[ iminorTick + 1 ];\n\t\t\tif( ! isNaN( minorTickPosition ) ) {\n\t\t\t\tminorShape.disallowUploadedUpdate();\n\t\t\t\tminorShape.visible = true;\n\t\t\t\tminorShape.transform.position.set(\n\t\t\t\t\tshapePositionX,\n\t\t\t\t\td * minorTickProjectedPosition + ty\n\t\t\t\t);\n\t\t\t\tminorShape.allowUploadedUpdate();\n\t\t\t} else {\n\t\t\t\tminorShape.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateTicks( container: DChartAxisContainer ): void {\n\t\tconst tick = this._tick;\n\t\tconst majorShapes = tick.major.shapes;\n\t\tconst minorShapes = tick.minor.shapes;\n\t\tif( majorShapes && minorShapes ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst bounds = plotArea.getBoundsInContainer();\n\t\t\tconst transform = plotArea.container.transform.localTransform;\n\t\t\tconst gridlineShapes = tick.major.gridline.shapes;\n\n\t\t\tconst coordinateIndex = this._coordinateIndex;\n\t\t\tconst padding = this._padding * this._index;\n\t\t\tlet coordinate: DChartCoordinate | null;\n\t\t\tswitch( this._position ) {\n\t\t\tcase DChartAxisPosition.TOP:\n\t\t\t\tcoordinate = plotArea.coordinate.x.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x + bounds.width )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaHeight = plotArea.height;\n\t\t\t\t\tthis.updateTicksX(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\t0 - padding,\n\t\t\t\t\t\ttransform, plotAreaHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.BOTTOM:\n\t\t\t\tcoordinate = plotArea.coordinate.x.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.x + bounds.width )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaHeight = plotArea.height;\n\t\t\t\t\tthis.updateTicksX(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\tplotAreaHeight + padding,\n\t\t\t\t\t\ttransform, plotAreaHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.LEFT:\n\t\t\t\tcoordinate = plotArea.coordinate.y.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y + bounds.height )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\t\t\tthis.updateTicksY(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\t0 - padding,\n\t\t\t\t\t\ttransform, plotAreaWidth\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\tcase DChartAxisPosition.RIGHT:\n\t\t\t\tcoordinate = plotArea.coordinate.y.get( coordinateIndex );\n\t\t\t\tif( coordinate ) {\n\t\t\t\t\tconst domainFrom = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y )\n\t\t\t\t\t);\n\t\t\t\t\tconst domainTo = coordinate.unmap(\n\t\t\t\t\t\tcoordinate.transform.unmap( bounds.y + bounds.height )\n\t\t\t\t\t);\n\t\t\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\t\t\tthis.updateTicksY(\n\t\t\t\t\t\tdomainFrom, domainTo,\n\t\t\t\t\t\tcoordinate,\n\t\t\t\t\t\tmajorShapes, minorShapes, gridlineShapes,\n\t\t\t\t\t\tplotAreaWidth + padding,\n\t\t\t\t\t\ttransform, plotAreaWidth\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartAxisContainer, index: number ): void {\n\t\tthis._container = container;\n\t\tthis._index = index;\n\t\tconst tickShapeContainer = container.container;\n\n\t\t// Bar\n\t\tconst bar = this._bar;\n\t\tlet barShape = bar.shape;\n\t\tif( ! barShape ) {\n\t\t\tconst position = this._position;\n\t\t\tconst barPosition = ( position === DChartAxisPosition.LEFT || position === DChartAxisPosition.RIGHT ?\n\t\t\t\tEShapeBarPosition.TOP : EShapeBarPosition.LEFT\n\t\t\t);\n\t\t\tbarShape = new EShapeBar(\n\t\t\t\tbarPosition,\n\t\t\t\tundefined,\n\t\t\t\tundefined,\n\t\t\t\tbar.style\n\t\t\t);\n\t\t\tbarShape.stroke.copy( bar.stroke );\n\t\t\tbarShape.text.copy( this._label );\n\t\t\tthis._bar.shape = barShape;\n\t\t}\n\t\tbarShape.attach( container.container );\n\n\t\t// Major tick gridline\n\t\tconst tick = this._tick;\n\t\tconst tickMajor = tick.major;\n\t\tconst gridline = tickMajor.gridline;\n\t\tlet gridlineShapes = gridline.shapes;\n\t\tif( ! gridlineShapes && tick.enable && gridline.enable ) {\n\t\t\tgridlineShapes = [];\n\t\t\tgridline.shapes = gridlineShapes;\n\t\t\tconst position = this._position;\n\t\t\tconst gridlinePosition = ( position === DChartAxisPosition.LEFT || position === DChartAxisPosition.RIGHT ?\n\t\t\t\tEShapeBarPosition.LEFT : EShapeBarPosition.TOP\n\t\t\t);\n\t\t\tconst gridlineCount = tickMajor.count;\n\t\t\tconst gridlineStyle = gridline.style;\n\t\t\tfor( let i = 0; i < gridlineCount; ++i ) {\n\t\t\t\tconst gridlineShape = new EShapeBar(\n\t\t\t\t\tgridlinePosition,\n\t\t\t\t\tundefined,\n\t\t\t\t\tundefined,\n\t\t\t\t\tgridlineStyle\n\t\t\t\t);\n\t\t\t\tgridlineShape.stroke.copy( gridline.stroke );\n\t\t\t\tgridlineShapes.push( gridlineShape );\n\t\t\t}\n\t\t}\n\t\tif( gridlineShapes ) {\n\t\t\tfor( let i = 0, imax = gridlineShapes.length; i < imax; ++i ) {\n\t\t\t\tgridlineShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\n\t\t// Major ticks\n\t\tlet tickMajorShapes = tickMajor.shapes;\n\t\tif( ! tickMajorShapes && tick.enable ) {\n\t\t\ttickMajorShapes = [];\n\t\t\ttickMajor.shapes = tickMajorShapes;\n\t\t\tconst tickMajorCount = tickMajor.count;\n\t\t\tconst tickMajorSize = tickMajor.size;\n\t\t\tconst tickMajorPosition = tickMajor.position;\n\t\t\tconst tickMajorStyle = tickMajor.style;\n\t\t\tfor( let i = 0; i < tickMajorCount; ++i ) {\n\t\t\t\tconst tickMajorShape = new EShapeBar(\n\t\t\t\t\ttickMajorPosition,\n\t\t\t\t\ttickMajorSize,\n\t\t\t\t\tundefined,\n\t\t\t\t\ttickMajorStyle\n\t\t\t\t);\n\t\t\t\ttickMajorShape.stroke.copy( tickMajor.stroke );\n\t\t\t\ttickMajorShape.text.copy( tickMajor.text );\n\t\t\t\ttickMajorShape.size.set( 0, 0 );\n\t\t\t\ttickMajorShapes.push( tickMajorShape );\n\t\t\t}\n\t\t}\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinor = tick.minor;\n\t\tlet tickMinorShapes = tickMinor.shapes;\n\t\tif( ! tickMinorShapes && tick.enable ) {\n\t\t\ttickMinorShapes = [];\n\t\t\ttickMinor.shapes = tickMinorShapes;\n\t\t\tconst tickMinorCount = tickMinor.count;\n\t\t\tconst tickMinorSize = tickMinor.size;\n\t\t\tconst tickMinorPosition = tickMinor.position;\n\t\t\tconst tickMinorStyle = tickMinor.style;\n\t\t\tfor( let i = 0, imax = ( tickMajor.count + 1 ) * tickMinorCount; i < imax; ++i ) {\n\t\t\t\tconst tickMinorShape = new EShapeBar(\n\t\t\t\t\ttickMinorPosition,\n\t\t\t\t\ttickMinorSize,\n\t\t\t\t\tundefined,\n\t\t\t\t\ttickMinorStyle\n\t\t\t\t);\n\t\t\t\ttickMinorShape.stroke.copy( tickMinor.stroke );\n\t\t\t\ttickMinorShape.size.set( 0, 0 );\n\t\t\t\ttickMinorShapes.push( tickMinorShape );\n\t\t\t}\n\t\t}\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].attach( tickShapeContainer );\n\t\t\t}\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\t// Bar\n\t\tconst barShape = this._bar.shape;\n\t\tif( barShape ) {\n\t\t\tbarShape.detach();\n\t\t}\n\n\t\t// Major ticks\n\t\tconst tick = this._tick;\n\t\tconst tickMajorShapes = tick.major.shapes;\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t// Major tick gridlines\n\t\tconst tickMajorGridlineShapes = tick.major.gridline.shapes;\n\t\tif( tickMajorGridlineShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorGridlineShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorGridlineShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinorShapes = tick.minor.shapes;\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].detach();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._container = undefined;\n\t}\n\n\tupdate(): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tthis.updateBar( container );\n\t\t\tthis.updateTicks( container );\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\t// Bar\n\t\tconst barShape = this._bar.shape;\n\t\tif( barShape ) {\n\t\t\tbarShape.destroy();\n\t\t}\n\n\t\t// Major ticks\n\t\tconst tick = this._tick;\n\t\tconst tickMajorShapes = tick.major.shapes;\n\t\tif( tickMajorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t// Major tick gridlines\n\t\tconst tickMajorGridlineShapes = tick.major.gridline.shapes;\n\t\tif( tickMajorGridlineShapes ) {\n\t\t\tfor( let i = 0, imax = tickMajorGridlineShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMajorGridlineShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t// Minor ticks\n\t\tconst tickMinorShapes = tick.minor.shapes;\n\t\tif( tickMinorShapes ) {\n\t\t\tfor( let i = 0, imax = tickMinorShapes.length; i < imax; ++i ) {\n\t\t\t\ttickMinorShapes[ i ].destroy();\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._container = undefined;\n\t}\n\n\tprotected toTheme( options?: DChartAxisBaseOptions ): DThemeChartAxisBase {\n\t\treturn ( options && options.theme ) || this.getThemeDefault();\n\t}\n\n\tprotected getThemeDefault(): DThemeChartAxisBase {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartAxisBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxis } from \"./d-chart-axis\";\nimport { DChartAxisContainer, DChartAxisContainerOptions } from \"./d-chart-axis-container\";\nimport { DChartAxisPosition } from \"./d-chart-axis-position\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\n\nexport class DChartAxisContainerImpl implements DChartAxisContainer {\n\tprotected _plotArea: DChartPlotArea;\n\tprotected _container: EShapeContainer;\n\tprotected _list: Map<DChartAxisPosition, DChartAxis[]>;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartAxisContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tthis._container = new EShapeContainer();\n\n\t\tthis._list = new Map<DChartAxisPosition, DChartAxis[]>();\n\t\tconst list = options && options.list;\n\t\tif( list ) {\n\t\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\t\tthis.add( list[ i ] );\n\t\t\t}\n\t\t}\n\t}\n\n\tget container(): EShapeContainer {\n\t\treturn this._container;\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tadd( axis: DChartAxis ): void {\n\t\tconst list = this._list;\n\t\tlet axes = list.get( axis.position );\n\t\tif( axes == null ) {\n\t\t\taxes = [];\n\t\t\tlist.set( axis.position, axes );\n\t\t}\n\t\taxes.push( axis );\n\t\taxis.bind( this, axes.length - 1 );\n\t}\n\n\tget( position: DChartAxisPosition, index: number ): DChartAxis | null {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\tif( 0 <= index && index < axes.length ) {\n\t\t\t\treturn axes[ index ];\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( axis: DChartAxis ): number {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( axis.position );\n\t\tif( axes ) {\n\t\t\treturn axes.indexOf( axis );\n\t\t}\n\t\treturn -1;\n\t}\n\n\tclear( position: DChartAxisPosition ): this {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].destroy();\n\t\t\t}\n\t\t\taxes.length = 0;\n\t\t}\n\t\treturn this;\n\t}\n\n\tsize( position: DChartAxisPosition ): number {\n\t\tconst list = this._list;\n\t\tconst axes = list.get( position );\n\t\tif( axes ) {\n\t\t\treturn axes.length;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tupdate(): void {\n\t\tthis._list.forEach(( axes: DChartAxis[] ): void => {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].update();\n\t\t\t}\n\t\t});\n\t}\n\n\tdestroy(): void {\n\t\tthis._list.forEach(( axes: DChartAxis[] ): void => {\n\t\t\tfor( let i = 0, imax = axes.length; i < imax; ++i ) {\n\t\t\t\taxes[ i ].destroy();\n\t\t\t}\n\t\t\taxes.length = 0;\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisBase } from \"./d-chart-axis-base\";\nimport { DChartAxisBaseOptions } from \"./d-chart-axis-base-options\";\n\nexport interface DChartAxisXOptions extends DChartAxisBaseOptions {\n\n}\n\n/**\n * An X axis.\n */\nexport class DChartAxisX<\n\tOPTIONS extends DChartAxisXOptions = DChartAxisXOptions\n> extends DChartAxisBase<OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisX\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisX, DChartAxisXOptions } from \"./d-chart-axis-x\";\n\nexport interface DChartAxisXDatetimeOptions extends DChartAxisXOptions {\n\n}\n\n/**\n * An X axis for datetimes.\n */\nexport class DChartAxisXDatetime<\n\tOPTIONS extends DChartAxisXDatetimeOptions = DChartAxisXDatetimeOptions\n> extends DChartAxisX<OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisXDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartAxisBase } from \"./d-chart-axis-base\";\nimport { DChartAxisBaseOptions } from \"./d-chart-axis-base-options\";\n\nexport interface DChartAxisYOptions extends DChartAxisBaseOptions {\n\n}\n\n/**\n * An Y axis.\n */\nexport class DChartAxisY<\n\tOPTIONS extends DChartAxisYOptions = DChartAxisYOptions\n> extends DChartAxisBase<OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DChartAxisY\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { UtilRgb } from \"./util/util-rgb\";\n\nconst DCHART_COLOR_SET_1 = [\n\t0x10b7e3,\n\t0xfe5420,\n\t0xf0c312,\n\t0x1c5d71\n];\n\nconst DCHART_COLOR_SET_2 = [\n\tDCHART_COLOR_SET_1[ 0 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 0 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 1 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 1 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 2 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 2 ], 0.4 ),\n\n\tDCHART_COLOR_SET_1[ 3 ],\n\tUtilRgb.brighten( DCHART_COLOR_SET_1[ 3 ], 0.4 )\n];\n\nexport const DChartColorSet1 = ( index: number ): number => {\n\treturn DCHART_COLOR_SET_1[ index % DCHART_COLOR_SET_1.length ];\n};\n\nexport const DChartColorSet2 = ( index: number ): number => {\n\treturn DCHART_COLOR_SET_2[ index % DCHART_COLOR_SET_2.length ];\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainer } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { isNumber } from \"./util/is-number\";\n\nexport class DChartCoordinateContainerSubImpl implements DChartCoordinateContainerSub {\n\tprotected _list: DChartCoordinate[];\n\tprotected _direction: DChartCoordinateDirection;\n\tprotected _container: DChartCoordinateContainer;\n\n\tconstructor( container: DChartCoordinateContainer, direction: DChartCoordinateDirection ) {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t\tthis._list = [];\n\t}\n\n\tget container(): DChartCoordinateContainer {\n\t\treturn this._container;\n\t}\n\n\tadd( coordinate: DChartCoordinate, index?: number ): this {\n\t\tconst list = this._list;\n\t\tif( index == null ) {\n\t\t\tlist.push( coordinate );\n\t\t} else if( 0 <= index && index < list.length ) {\n\t\t\tlist.splice( index, 0, coordinate );\n\t\t} else {\n\t\t\tlist.push( coordinate );\n\t\t}\n\t\tcoordinate.bind( this, this._direction );\n\t\treturn this;\n\t}\n\n\tget( index: number ): DChartCoordinate | null {\n\t\tconst list = this._list;\n\t\tif( 0 <= index && index < list.length ) {\n\t\t\treturn list[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( coordinate: DChartCoordinate ): number {\n\t\treturn this._list.indexOf( coordinate );\n\t}\n\n\tremove( coordinate: DChartCoordinate ): DChartCoordinate | null;\n\tremove( index: number ): DChartCoordinate | null;\n\tremove( coordinateOrIndex: DChartCoordinate | number ): DChartCoordinate | null {\n\t\tconst list = this._list;\n\t\tif( isNumber( coordinateOrIndex ) ) {\n\t\t\tconst index = coordinateOrIndex;\n\t\t\tif( 0 <= index && index < list.length ) {\n\t\t\t\tconst removed = list.splice( index, 1 )[ 0 ];\n\t\t\t\tremoved.unbind();\n\t\t\t\treturn removed;\n\t\t\t}\n\t\t} else {\n\t\t\tconst coordinate = coordinateOrIndex;\n\t\t\tconst index = list.indexOf( coordinate );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tlist.splice( index, 1 );\n\t\t\t\tcoordinate.unbind();\n\t\t\t\treturn coordinate;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].unbind();\n\t\t}\n\t\tlist.length = 0;\n\t\treturn this;\n\t}\n\n\tdestroy(): this {\n\t\treturn this.clear();\n\t}\n\n\tsize(): number {\n\t\treturn this._list.length;\n\t}\n\n\tfit( from?: number, to?: number ): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].fit( from, to );\n\t\t}\n\t\treturn this;\n\t}\n\n\tmark( from?: number, to?: number ): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].mark( from, to );\n\t\t}\n\t\treturn this;\n\t}\n\n\tblend( ratio: number ): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].blend( ratio );\n\t\t}\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport enum DChartSelectionPoint {\n\tPREVIOUS,\n\tNEXT,\n\tCLOSER,\n\tINTERSECTION\n}\n\nexport type DChartSelectionStyle = ( shape: EShape, series: DChartSeries ) => void;\n\nexport interface DChartSelection extends utils.EventEmitter {\n\tbind( container: DChartSeriesContainer ): void;\n\tunbind(): void;\n\tupdate(): void;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainer, DChartCoordinateContainerOptions } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateContainerSubImpl } from \"./d-chart-coordinate-container-sub-impl\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { isArray } from \"./util/is-array\";\n\nexport class DChartCoordinateContainerImpl implements DChartCoordinateContainer {\n\tprotected _x: DChartCoordinateContainerSub;\n\tprotected _y: DChartCoordinateContainerSub;\n\tprotected _plotArea: DChartPlotArea;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartCoordinateContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tconst x = this._x = new DChartCoordinateContainerSubImpl( this, DChartCoordinateDirection.X );\n\t\tconst y = this._y = new DChartCoordinateContainerSubImpl( this, DChartCoordinateDirection.Y );\n\t\tif( options ) {\n\t\t\tconst cxs = options.x;\n\t\t\tif( cxs ) {\n\t\t\t\tif( isArray( cxs ) ) {\n\t\t\t\t\tfor( let i = 0, imax = cxs.length; i < imax; ++i ) {\n\t\t\t\t\t\tx.add( cxs[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tx.add( cxs );\n\t\t\t\t}\n\t\t\t}\n\t\t\tconst cys = options.y;\n\t\t\tif( cys ) {\n\t\t\t\tif( isArray( cys ) ) {\n\t\t\t\t\tfor( let i = 0, imax = cys.length; i < imax; ++i ) {\n\t\t\t\t\t\ty.add( cys[ i ] );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\ty.add( cys );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget x(): DChartCoordinateContainerSub {\n\t\treturn this._x;\n\t}\n\n\tget y(): DChartCoordinateContainerSub {\n\t\treturn this._y;\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tfit( domainFrom?: number, domainTo?: number, rangeFrom?: number, rangeTo?: number ): this {\n\t\tthis._x.fit( domainFrom, domainTo );\n\t\tthis._y.fit( rangeFrom, rangeTo );\n\t\treturn this;\n\t}\n\n\tmark( domainFrom?: number, domainTo?: number, rangeFrom?: number, rangeTo?: number ): this {\n\t\tthis._x.mark( domainFrom, domainTo );\n\t\tthis._y.mark( rangeFrom, rangeTo );\n\t\treturn this;\n\t}\n\n\tblend( ratio: number ): this {\n\t\tthis._x.blend( ratio );\n\t\tthis._y.blend( ratio );\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\n\nexport interface DThemeChartCoordinateLinearTick {\n\ttoStepScale( scale: number ): number;\n}\n\nexport class DChartCoordinateLinearTick {\n\tprotected _theme: DThemeChartCoordinateLinearTick;\n\n\tconstructor( theme: DThemeChartCoordinateLinearTick ) {\n\t\tthis._theme = theme;\n\t}\n\n\tprotected calcStepMajor( domainMin: number, domainMax: number, count: number ): number {\n\t\tif( 0 < count ) {\n\t\t\tconst span = Math.abs( domainMax - domainMin ) / count;\n\t\t\tconst power = Math.floor( Math.log( span ) / Math.LN10 );\n\t\t\tconst base = Math.pow( 10, power );\n\t\t\treturn this._theme.toStepScale( span / base ) * base;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected calcStepMinor( step: number, minorCount: number ): number {\n\t\tif( 0 <= step ) {\n\t\t\treturn step / ( minorCount + 1 );\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tprotected calcTickMinorPositions(\n\t\tstep: number, count: number, majorPosition: number,\n\t\trangeMin: number, rangeMax: number,\n\t\tiresult: number, result: Float64Array\n\t): void {\n\t\tfor( let i = 0; i < count; i += 1 ) {\n\t\t\tconst minorPosition = majorPosition + (i + 1) * step;\n\t\t\tif( rangeMin <= minorPosition && minorPosition <= rangeMax ) {\n\t\t\t\tresult[ iresult++ ] = minorPosition;\n\t\t\t}\n\t\t}\n\t}\n\n\tcalculate(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array,\n\t\tcoordinate: DChartCoordinate\n\t): void {\n\t\tif( majorCount <= 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst transform = coordinate.transform;\n\n\t\tconst domainMin = Math.min( domainFrom, domainTo );\n\t\tconst domainMax = Math.max( domainFrom, domainTo );\n\n\t\tconst majorStep = this.calcStepMajor( domainMin, domainMax, majorCount );\n\t\tif( majorStep <= 0 ) {\n\t\t\tmajorResult[ 0 ] = domainMin;\n\t\t\tmajorResult[ 1 ] = transform.map( coordinate.map( domainMin ) );\n\t\t\tmajorResult[ 2 ] = 0;\n\t\t\tfor( let i = 1; i < majorCount; ++i ) {\n\t\t\t\tconst imajorResult = i * 3;\n\t\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\t\tconst iminorResult = i * 3;\n\t\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Major tick start position\n\t\tconst idomainStart = Math.floor( domainMin / majorStep ) - 1;\n\t\tconst idomainEnd = Math.ceil( domainMax / majorStep ) + 1;\n\n\t\t// Major / minor tick positions\n\t\tconst minorStep = this.calcStepMinor( majorStep, minorCountPerMajor );\n\t\tlet imajor = 0;\n\t\tlet iminor = 0;\n\t\tfor( let i = idomainStart; i <= idomainEnd; ++i ) {\n\t\t\tconst majorPosition = i * majorStep;\n\t\t\tif( imajor < majorCount ) {\n\t\t\t\tif( domainMin <= majorPosition && majorPosition <= domainMax ) {\n\t\t\t\t\tconst majorProjectedPosition = transform.map( coordinate.map( majorPosition ) );\n\t\t\t\t\tconst imajorResult = imajor * 3;\n\t\t\t\t\tmajorResult[ imajorResult + 0 ] = majorPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 1 ] = majorProjectedPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 2 ] = majorStep;\n\t\t\t\t\timajor += 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let j = 0; j < minorCountPerMajor; j += 1 ) {\n\t\t\t\tif( iminor < minorCount ) {\n\t\t\t\t\tconst minorPosition = majorPosition + (j + 1) * minorStep;\n\t\t\t\t\tif( domainMin <= minorPosition && minorPosition <= domainMax ) {\n\t\t\t\t\t\tconst minorProjectedPosition = transform.map( coordinate.map( minorPosition ) );\n\t\t\t\t\t\tconst iminorResult = iminor * 3;\n\t\t\t\t\t\tminorResult[ iminorResult + 0 ] = minorPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 1 ] = minorProjectedPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 2 ] = minorStep;\n\t\t\t\t\t\timinor += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor( let i = imajor; i < majorCount; ++i ) {\n\t\t\tconst imajorResult = i * 3;\n\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t}\n\t\tfor( let i = iminor; i < minorCount; ++i ) {\n\t\t\tconst iminorResult = i * 3;\n\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t}\n\t}\n}\n","import { DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateTransform, DThemeChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\nimport { DChartCoordinateTransformMark } from \"./d-chart-coordinate-transform-mark\";\n\nexport class DChartCoordinateTransformImpl implements DChartCoordinateTransform {\n\tprotected _theme: DThemeChartCoordinateTransform;\n\tprotected _id: number;\n\tprotected _translate: number;\n\tprotected _scale: number;\n\tprotected _itranslate: number;\n\tprotected _iscale: number;\n\n\tconstructor( theme: DThemeChartCoordinateTransform ) {\n\t\tthis._theme = theme;\n\t\tthis._id = 0;\n\t\tthis._translate = 0;\n\t\tthis._scale = 1;\n\t\tthis._itranslate = 0;\n\t\tthis._iscale = 1;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget translate(): number {\n\t\treturn this._translate;\n\t}\n\n\tset translate( translate: number ) {\n\t\tthis.set( translate );\n\t}\n\n\tget scale(): number {\n\t\treturn this._scale;\n\t}\n\n\tset scale( scale: number ) {\n\t\tthis.set( undefined, scale );\n\t}\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\n\t\tthis.set( 0, direction === DChartCoordinateDirection.X ? +1 : -1 );\n\t}\n\n\tunbind(): void {\n\t\t// DO NOTHING\n\t}\n\n\tset( translate?: number, scale?: number ): void {\n\t\tlet isChanged = false;\n\n\t\tif( translate != null && this._translate !== translate ) {\n\t\t\tisChanged = true;\n\t\t\tthis._translate = translate;\n\t\t}\n\n\t\tif( scale != null && this._scale !== scale ) {\n\t\t\tisChanged = true;\n\t\t\tthis._scale = scale;\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._iscale = ( this._theme.isZero( this._scale ) ? 0 : 1 / this._scale );\n\t\t\tthis._itranslate = - this._translate * this._iscale;\n\t\t}\n\t}\n\n\tblend( ratio: number, mark: DChartCoordinateTransformMark ): void {\n\t\tconst ratioi = 1 - ratio;\n\t\tconst newTranslate = mark.newTranslate * ratio + mark.oldTranslate * ratioi;\n\t\tconst newScale = mark.newScale * ratio + mark.oldScale * ratioi;\n\t\tthis.set( newTranslate, newScale );\n\t}\n\n\tmap( value: number ): number {\n\t\treturn this._translate + this._scale * value;\n\t}\n\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tconst translate = this._translate;\n\t\tconst scale = this._scale;\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tvalues[ i ] = translate + scale * values[ i ];\n\t\t}\n\t}\n\n\tunmap( value: number ): number {\n\t\treturn this._itranslate + this._iscale * value;\n\t}\n\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tconst itranslate = this._itranslate;\n\t\tconst iscale = this._iscale;\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tvalues[ i ] = itranslate + iscale * values[ i ];\n\t\t}\n\t}\n}\n","export interface DChartCoordinateTransformMark {\n\toldTranslate: number;\n\toldScale: number;\n\tnewTranslate: number;\n\tnewScale: number;\n\tset( translate?: number, scale?: number ): void;\n}\n\nexport class DChartCoordinateTransformMarkImpl implements DChartCoordinateTransformMark {\n\toldTranslate: number;\n\toldScale: number;\n\tnewTranslate: number;\n\tnewScale: number;\n\n\tconstructor() {\n\t\tthis.oldTranslate = 0;\n\t\tthis.oldScale = 1;\n\t\tthis.newTranslate = 0;\n\t\tthis.newScale = 1;\n\t}\n\n\tset( translate?: number | undefined, scale?: number | undefined ): void {\n\t\tif( translate != null ) {\n\t\t\tthis.newTranslate = translate;\n\t\t}\n\n\t\tif( scale != null ) {\n\t\t\tthis.newScale = scale;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartRegion } from \"./d-chart-region\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport class DChartRegionImpl implements DChartRegion {\n\tfrom: number;\n\tto: number;\n\n\tconstructor( from: number, to: number ) {\n\t\tthis.from = from;\n\t\tthis.to = to;\n\t}\n\n\tset( from?: number, to?: number ): this {\n\t\tif( from != null ) {\n\t\t\tthis.from = from;\n\t\t}\n\t\tif( to != null ) {\n\t\t\tthis.to = to;\n\t\t}\n\t\treturn this;\n\t}\n\n\tadd( from: number, to: number ): this {\n\t\tif( ! isNaN( from ) ) {\n\t\t\tthis.from = ( isNaN( this.from ) ?\n\t\t\t\tfrom : Math.min( this.from, from )\n\t\t\t);\n\t\t}\n\n\t\tif( ! isNaN( to ) ) {\n\t\t\tthis.to = ( isNaN( this.to ) ?\n\t\t\t\tto : Math.max( this.to, to )\n\t\t\t);\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tclear(): this {\n\t\tthis.from = NaN;\n\t\tthis.to = NaN;\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateLinearTick, DThemeChartCoordinateLinearTick } from \"./d-chart-coordinate-linear-tick\";\nimport { DChartCoordinateTransform, DThemeChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\nimport { DChartCoordinateTransformImpl } from \"./d-chart-coordinate-transform-impl\";\nimport { DChartCoordinateTransformMark, DChartCoordinateTransformMarkImpl } from \"./d-chart-coordinate-transform-mark\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport interface DThemeChartCoordinateLinear extends DThemeChartCoordinateTransform, DThemeChartCoordinateLinearTick {\n\n}\n\nexport interface DChartCoordinateLinearOptions {\n\ttheme?: DThemeChartCoordinateLinear;\n}\n\nexport class DChartCoordinateLinear implements DChartCoordinate {\n\tprotected _id: number;\n\tprotected _transform: DChartCoordinateTransform;\n\tprotected _container?: DChartCoordinateContainerSub;\n\tprotected _direction: DChartCoordinateDirection;\n\tprotected _theme: DThemeChartCoordinateLinear;\n\tprotected _work: DChartRegionImpl;\n\tprotected _tick: DChartCoordinateLinearTick;\n\tprotected _mark: DChartCoordinateTransformMarkImpl;\n\n\tconstructor( options?: DChartCoordinateLinearOptions ) {\n\t\tthis._id = 0;\n\t\tthis._direction = DChartCoordinateDirection.X;\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tthis._transform = new DChartCoordinateTransformImpl( theme );\n\t\tthis._tick = new DChartCoordinateLinearTick( theme );\n\t\tthis._work = new DChartRegionImpl( NaN, NaN );\n\t\tthis._mark = new DChartCoordinateTransformMarkImpl();\n\t}\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t\tthis._transform.bind( container, direction );\n\t}\n\n\tunbind(): void {\n\t\tthis._container = undefined;\n\t\tthis._transform.unbind();\n\t}\n\n\tfit( from?: number, to?: number ): void {\n\t\tthis.doFit( from, to, this._transform );\n\t}\n\n\tmark( from?: number, to?: number ): void {\n\t\tconst mark = this._mark;\n\t\tconst transform = this._transform;\n\t\tmark.oldTranslate = transform.translate;\n\t\tmark.oldScale = transform.scale;\n\t\tthis.doFit( from, to, mark );\n\t}\n\n\tblend( ratio: number ): void {\n\t\tthis._transform.blend( ratio, this._mark );\n\t}\n\n\tprotected doFit(\n\t\tfrom: number | undefined, to: number | undefined,\n\t\tresult: DChartCoordinateTransformMark | DChartCoordinateTransform\n\t): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst plotArea = container.container.plotArea;\n\t\t\tconst padding = plotArea.padding;\n\t\t\tconst work = this._work;\n\t\t\tswitch( this._direction ) {\n\t\t\tcase DChartCoordinateDirection.X:\n\t\t\t\tthis.doFit_(\n\t\t\t\t\tpadding.getLeft(), plotArea.width - padding.getRight(),\n\t\t\t\t\tthis.toFitDomain( from, to, plotArea, work ),\n\t\t\t\t\tresult\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase DChartCoordinateDirection.Y:\n\t\t\t\tthis.doFit_(\n\t\t\t\t\tplotArea.height - padding.getBottom(), padding.getTop(),\n\t\t\t\t\tthis.toFitRange( from, to, plotArea, work ),\n\t\t\t\t\tresult\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toFitDomain(\n\t\tfrom: number | undefined, to: number | undefined,\n\t\tplotArea: DChartPlotArea,\n\t\tresult: DChartRegion\n\t): DChartRegion {\n\t\tif( from != null && to != null ) {\n\t\t\tresult.set( from, to );\n\t\t} else {\n\t\t\tplotArea.series.getDomain( this, result );\n\t\t\tresult.set( from, to );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected toFitRange(\n\t\tfrom: number | undefined, to: number | undefined,\n\t\tplotArea: DChartPlotArea,\n\t\tresult: DChartRegion\n\t): DChartRegion {\n\t\tif( from != null && to != null ) {\n\t\t\tresult.set( from, to );\n\t\t} else {\n\t\t\tplotArea.series.getRange( this, result );\n\t\t\tresult.set( from, to );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected doFit_(\n\t\tpixelFrom: number, pixelTo: number,\n\t\tregion: DChartRegion,\n\t\tresult: DChartCoordinateTransformMark | DChartCoordinateTransform\n\t): void {\n\t\tconst regionFrom = region.from;\n\t\tconst regionTo = region.to;\n\t\tif( ! (isNaN( regionFrom ) || isNaN( regionTo )) ) {\n\t\t\t// Scale\n\t\t\tlet newScale = 1;\n\t\t\tconst regionSize = ( regionTo - regionFrom );\n\t\t\tif( ! this._theme.isZero( regionSize ) ) {\n\t\t\t\tconst pixelSize = ( pixelTo - pixelFrom );\n\t\t\t\tnewScale = pixelSize / regionSize;\n\t\t\t} else {\n\t\t\t\tnewScale = ( pixelTo < pixelFrom ? -1 : 1 );\n\t\t\t}\n\n\t\t\t// Translation\n\t\t\tconst newTranslation = pixelFrom - regionFrom * newScale;\n\n\t\t\t// Done\n\t\t\tresult.set( newTranslation, newScale );\n\t\t}\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget transform(): DChartCoordinateTransform {\n\t\treturn this._transform;\n\t}\n\n\tmap( value: number ): number {\n\t\treturn value;\n\t}\n\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\tunmap( value: number ): number {\n\t\treturn value;\n\t}\n\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\tticks(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void {\n\t\tthis._tick.calculate(\n\t\t\tdomainFrom, domainTo,\n\t\t\tmajorCount,\n\t\t\tminorCountPerMajor,\n\t\t\tminorCount,\n\t\t\tmajorResult,\n\t\t\tminorResult,\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected toTheme( options?: DChartCoordinateLinearOptions ): DThemeChartCoordinateLinear {\n\t\treturn ( options && options.theme ) || this.getThemeDefault();\n\t}\n\n\tprotected getThemeDefault(): DThemeChartCoordinateLinear {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartCoordinateLinear\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\n\nexport interface DThemeChartCoordinateLogTick {\n\ttoStepScale( scale: number ): number;\n}\n\nexport class DChartCoordinateLogTick {\n\tprotected _theme: DThemeChartCoordinateLogTick;\n\n\tconstructor( theme: DThemeChartCoordinateLogTick ) {\n\t\tthis._theme = theme;\n\t}\n\n\tprotected calcStepMajor( domainMin: number, domainMax: number, count: number ): number {\n\t\tif( 0 < count ) {\n\t\t\tconst span = Math.abs( domainMax - domainMin ) / count;\n\t\t\tconst power = Math.floor( Math.log( span ) / Math.LN10 );\n\t\t\tconst base = Math.pow( 10, power );\n\t\t\treturn this._theme.toStepScale( span / base ) * base;\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected calcStepMinor( step: number, minorCount: number ): number {\n\t\tif( 0 <= step ) {\n\t\t\treturn step / ( minorCount + 1 );\n\t\t} else {\n\t\t\treturn -1;\n\t\t}\n\t}\n\n\tprotected calcTickMinorPositions(\n\t\tstep: number, count: number, majorPosition: number,\n\t\trangeMin: number, rangeMax: number,\n\t\tiresult: number, result: Float64Array\n\t): void {\n\t\tfor( let i = 0; i < count; i += 1 ) {\n\t\t\tconst minorPosition = majorPosition + (i + 1) * step;\n\t\t\tif( rangeMin <= minorPosition && minorPosition <= rangeMax ) {\n\t\t\t\tresult[ iresult++ ] = minorPosition;\n\t\t\t}\n\t\t}\n\t}\n\n\tcalculate(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array,\n\t\tcoordinate: DChartCoordinate\n\t): void {\n\t\tif( majorCount <= 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst transform = coordinate.transform;\n\n\t\tconst domainFromMapped = coordinate.map( domainFrom );\n\t\tconst domainToMapped = coordinate.map( domainTo );\n\n\t\tconst domainMinMapped = Math.min( domainFromMapped, domainToMapped );\n\t\tconst domainMaxMapped = Math.max( domainFromMapped, domainToMapped );\n\n\t\tconst majorStepMapped = this.calcStepMajor( domainMinMapped, domainMaxMapped, majorCount );\n\t\tif( majorStepMapped <= 0 ) {\n\t\t\tconst domainMin = Math.min( domainFrom, domainTo );\n\t\t\tmajorResult[ 0 ] = domainMin;\n\t\t\tmajorResult[ 1 ] = transform.map( coordinate.map( domainMin ) );\n\t\t\tmajorResult[ 2 ] = 0;\n\t\t\tfor( let i = 1; i < majorCount; ++i ) {\n\t\t\t\tconst imajorResult = i * 3;\n\t\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\tfor( let i = 0; i < minorCount; ++i ) {\n\t\t\t\tconst iminorResult = i * 3;\n\t\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\t// Major tick start position\n\t\tconst idomainStartMapped = Math.floor( domainMinMapped / majorStepMapped ) - 1;\n\t\tconst idomainEndMapped = Math.ceil( domainMaxMapped / majorStepMapped ) + 1;\n\n\t\t// Major / minor tick positions\n\t\tconst minorStepMapped = this.calcStepMinor( majorStepMapped, minorCountPerMajor );\n\t\tlet imajor = 0;\n\t\tlet iminor = 0;\n\t\tfor( let i = idomainStartMapped; i <= idomainEndMapped; ++i ) {\n\t\t\tconst majorPositionMapped = i * majorStepMapped;\n\t\t\tif( imajor < majorCount ) {\n\t\t\t\tif( domainMinMapped <= majorPositionMapped && majorPositionMapped <= domainMaxMapped ) {\n\t\t\t\t\tconst majorPosition = coordinate.unmap( majorPositionMapped );\n\t\t\t\t\tconst majorProjectedPosition = transform.map( majorPositionMapped );\n\t\t\t\t\tconst majorStep = coordinate.unmap( majorPositionMapped - 1 );\n\t\t\t\t\tconst imajorResult = imajor * 3;\n\t\t\t\t\tmajorResult[ imajorResult + 0 ] = majorPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 1 ] = majorProjectedPosition;\n\t\t\t\t\tmajorResult[ imajorResult + 2 ] = majorStep;\n\t\t\t\t\timajor += 1;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor( let j = 0; j < minorCountPerMajor; j += 1 ) {\n\t\t\t\tif( iminor < minorCount ) {\n\t\t\t\t\tconst minorPositionMapped = majorPositionMapped + (j + 1) * minorStepMapped;\n\t\t\t\t\tif( domainMinMapped <= minorPositionMapped && minorPositionMapped <= domainMaxMapped ) {\n\t\t\t\t\t\tconst minorPosition = coordinate.unmap( minorPositionMapped );\n\t\t\t\t\t\tconst minorProjectedPosition = transform.map( minorPositionMapped );\n\t\t\t\t\t\tconst minorStep = coordinate.unmap( minorPositionMapped - 1 );\n\t\t\t\t\t\tconst iminorResult = iminor * 3;\n\t\t\t\t\t\tminorResult[ iminorResult + 0 ] = minorPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 1 ] = minorProjectedPosition;\n\t\t\t\t\t\tminorResult[ iminorResult + 2 ] = minorStep;\n\t\t\t\t\t\timinor += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tfor( let i = imajor; i < majorCount; ++i ) {\n\t\t\tconst imajorResult = i * 3;\n\t\t\tmajorResult[ imajorResult + 0 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 1 ] = NaN;\n\t\t\tmajorResult[ imajorResult + 2 ] = NaN;\n\t\t}\n\t\tfor( let i = iminor; i < minorCount; ++i ) {\n\t\t\tconst iminorResult = i * 3;\n\t\t\tminorResult[ iminorResult + 0 ] = NaN;\n\t\t\tminorResult[ iminorResult + 1 ] = NaN;\n\t\t\tminorResult[ iminorResult + 2 ] = NaN;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate, DChartCoordinateDirection } from \"./d-chart-coordinate\";\nimport { DChartCoordinateContainerSub } from \"./d-chart-coordinate-container-sub\";\nimport { DChartCoordinateLogTick, DThemeChartCoordinateLogTick } from \"./d-chart-coordinate-log-tick\";\nimport { DChartCoordinateTransform, DThemeChartCoordinateTransform } from \"./d-chart-coordinate-transform\";\nimport { DChartCoordinateTransformImpl } from \"./d-chart-coordinate-transform-impl\";\nimport { DChartCoordinateTransformMark, DChartCoordinateTransformMarkImpl } from \"./d-chart-coordinate-transform-mark\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport interface DThemeChartCoordinateLog extends DThemeChartCoordinateTransform, DThemeChartCoordinateLogTick {\n\n}\n\nexport interface DChartCoordinateLogOptions {\n\ttheme?: DThemeChartCoordinateLog;\n}\n\nexport class DChartCoordinateLog implements DChartCoordinate {\n\tprotected _id: number;\n\tprotected _transform: DChartCoordinateTransform;\n\tprotected _container?: DChartCoordinateContainerSub;\n\tprotected _direction: DChartCoordinateDirection;\n\tprotected _theme: DThemeChartCoordinateLog;\n\tprotected _work: DChartRegionImpl;\n\tprotected _tick: DChartCoordinateLogTick;\n\tprotected _mark: DChartCoordinateTransformMarkImpl;\n\n\tconstructor( options?: DChartCoordinateLogOptions ) {\n\t\tthis._id = 0;\n\t\tthis._direction = DChartCoordinateDirection.X;\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tthis._transform = new DChartCoordinateTransformImpl( theme );\n\t\tthis._tick = new DChartCoordinateLogTick( theme );\n\t\tthis._work = new DChartRegionImpl( NaN, NaN );\n\t\tthis._mark = new DChartCoordinateTransformMarkImpl();\n\t}\n\n\tbind( container: DChartCoordinateContainerSub, direction: DChartCoordinateDirection ): void {\n\t\tthis._container = container;\n\t\tthis._direction = direction;\n\t}\n\n\tunbind(): void {\n\t\tthis._container = undefined;\n\t}\n\n\tfit( from?: number, to?: number ): void {\n\t\tthis.doFit( from, to, this._transform );\n\t}\n\n\tmark( from?: number, to?: number ): void {\n\t\tconst mark = this._mark;\n\t\tconst transform = this._transform;\n\t\tmark.oldTranslate = transform.translate;\n\t\tmark.oldScale = transform.scale;\n\t\tthis.doFit( from, to, mark );\n\t}\n\n\tblend( ratio: number ): void {\n\t\tthis._transform.blend( ratio, this._mark );\n\t}\n\n\tprotected doFit(\n\t\tfrom: number | undefined,\n\t\tto: number | undefined,\n\t\tresult: DChartCoordinateTransformMark | DChartCoordinateTransform\n\t): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst plotArea = container.container.plotArea;\n\t\t\tconst padding = plotArea.padding;\n\t\t\tconst work = this._work;\n\t\t\tswitch( this._direction ) {\n\t\t\tcase DChartCoordinateDirection.X:\n\t\t\t\tthis.doFit_(\n\t\t\t\t\tpadding.getLeft(), plotArea.width - padding.getRight(),\n\t\t\t\t\tthis.toFitDomain( from, to, plotArea, work ),\n\t\t\t\t\tresult\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\tcase DChartCoordinateDirection.Y:\n\t\t\t\tthis.doFit_(\n\t\t\t\t\tplotArea.height - padding.getBottom(), padding.getTop(),\n\t\t\t\t\tthis.toFitRange( from, to, plotArea, work ),\n\t\t\t\t\tresult\n\t\t\t\t);\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toFitDomain(\n\t\tfrom: number | undefined, to: number | undefined,\n\t\tplotArea: DChartPlotArea,\n\t\tresult: DChartRegion\n\t): DChartRegion {\n\t\tif( from != null && to != null ) {\n\t\t\tresult.set( from, to );\n\t\t} else {\n\t\t\tplotArea.series.getDomain( this, result );\n\t\t\tresult.set( from, to );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected toFitRange(\n\t\tfrom: number | undefined, to: number | undefined,\n\t\tplotArea: DChartPlotArea,\n\t\tresult: DChartRegion\n\t): DChartRegion {\n\t\tif( from != null && to != null ) {\n\t\t\tresult.set( from, to );\n\t\t} else {\n\t\t\tplotArea.series.getRange( this, result );\n\t\t\tresult.set( from, to );\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected doFit_(\n\t\tpixelFrom: number, pixelTo: number, region: DChartRegion,\n\t\tresult: DChartCoordinateTransformMark | DChartCoordinateTransform\n\t): void {\n\t\tconst regionFrom = region.from;\n\t\tconst regionTo = region.to;\n\t\tif( ! (isNaN( regionFrom ) || isNaN( regionTo )) ) {\n\t\t\t// Scale\n\t\t\tlet newScale = 1;\n\t\t\tconst regionFromMapped = this.map( regionFrom );\n\t\t\tconst regionToMapped = this.map( regionTo );\n\t\t\tconst regionSizeMapped = ( regionToMapped - regionFromMapped );\n\t\t\tif( ! this._theme.isZero( regionSizeMapped ) ) {\n\t\t\t\tconst pixelSize = ( pixelTo - pixelFrom );\n\t\t\t\tnewScale = pixelSize / regionSizeMapped;\n\t\t\t} else {\n\t\t\t\tnewScale = ( pixelTo < pixelFrom ? -1 : 1 );\n\t\t\t}\n\n\t\t\t// Translation\n\t\t\tconst newTranslation = pixelFrom - regionFromMapped * newScale;\n\n\t\t\t// Done\n\t\t\tresult.set( newTranslation, newScale );\n\t\t}\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget transform(): DChartCoordinateTransform {\n\t\treturn this._transform;\n\t}\n\n\tmap( value: number ): number {\n\t\treturn Math.log( Math.max( 0, value ) ) / Math.LN10;\n\t}\n\n\tmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tconst factor = 1 / Math.LN10;\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tconst value = values[ i ];\n\t\t\tvalues[ i ] = Math.log( Math.max( 0, value ) ) * factor;\n\t\t}\n\t}\n\n\tunmap( value: number ): number {\n\t\treturn Math.pow( 10, value );\n\t}\n\n\tunmapAll( values: number[], ifrom: number, iend: number, stride: number, offset: number ): void {\n\t\tfor( let i = ifrom + offset; i < iend; i += stride ) {\n\t\t\tvalues[ i ] = Math.pow( 10, values[ i ] );\n\t\t}\n\t}\n\n\tticks(\n\t\tdomainFrom: number, domainTo: number,\n\t\tmajorCount: number,\n\t\tminorCountPerMajor: number,\n\t\tminorCount: number,\n\t\tmajorResult: Float64Array,\n\t\tminorResult: Float64Array\n\t): void {\n\t\tthis._tick.calculate(\n\t\t\tdomainFrom, domainTo,\n\t\t\tmajorCount,\n\t\t\tminorCountPerMajor,\n\t\t\tminorCount,\n\t\t\tmajorResult,\n\t\t\tminorResult,\n\t\t\tthis\n\t\t);\n\t}\n\n\tprotected toTheme( options?: DChartCoordinateLogOptions ): DThemeChartCoordinateLog {\n\t\treturn ( options && options.theme ) || this.getThemeDefault();\n\t}\n\n\tprotected getThemeDefault(): DThemeChartCoordinateLog {\n\t\treturn DThemes.getInstance().get( this.getType() );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartCoordinateLog\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DChartLegendItemOptions<THEME extends DThemeChartLegendItem> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeChartLegendItem extends DThemeBase {\n}\n\nexport class DChartLegendItem<\n\tTHEME extends DThemeChartLegendItem = DThemeChartLegendItem,\n\tOPTIONS extends DChartLegendItemOptions<THEME> = DChartLegendItemOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartLegendItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DChartLegendOptions<THEME extends DThemeChartLegend> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeChartLegend extends DThemeBase {\n}\n\nexport class DChartLegend<\n\tTHEME extends DThemeChartLegend = DThemeChartLegend,\n\tOPTIONS extends DChartLegendOptions<THEME> = DChartLegendOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartLegend\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DChartOverviewOptions<THEME extends DThemeChartOverview> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeChartOverview extends DThemeBase {\n}\n\nexport class DChartOverview<\n\tTHEME extends DThemeChartOverview = DThemeChartOverview,\n\tOPTIONS extends DChartOverviewOptions<THEME> = DChartOverviewOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartOverview\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Rectangle, Transform } from \"pixi.js\";\nimport { DBasePoint } from \"./d-base-point\";\nimport { DViewTarget } from \"./d-view-to-target\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\n\nexport class DChartPlotAreaContainer extends EShapeContainer implements DViewTarget {\n\tprotected _position: DBasePoint;\n\tprotected _scale: DBasePoint;\n\tprotected _workRect: Rectangle;\n\n\tconstructor( onChange: () => void ) {\n\t\tsuper();\n\t\tconst transform: Transform = this.transform;\n\t\tthis._position = new DBasePoint( transform.position, onChange );\n\t\tthis._scale = new DBasePoint( transform.scale, onChange );\n\t\tthis._workRect = new Rectangle();\n\t}\n\n\t// @ts-ignore\n\tget position(): DBasePoint {\n\t\treturn this._position;\n\t}\n\n\t// @ts-ignore\n\tget scale(): DBasePoint {\n\t\treturn this._scale;\n\t}\n\n\tgetBounds( skipUpdate?: boolean, rect?: Rectangle ): Rectangle {\n\t\t(this as any)._lastBoundsID = -1;\n\t\treturn super.getBounds( skipUpdate, rect );\n\t}\n\n\tcalculateBounds(): void {\n\t\tconst bounds = this._bounds;\n\t\tconst work = this._work;\n\t\tconst rect = this._workRect;\n\t\tconst worldTransform = this.transform.worldTransform;\n\n\t\tlet xmin = 0;\n\t\tlet xmax = 0;\n\t\tlet ymin = 0;\n\t\tlet ymax = 0;\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\tlet isFirst = true;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child.visible ) {\n\t\t\t\t\tchild.getBoundsInternal( work, false, rect );\n\t\t\t\t\tif( isFirst ) {\n\t\t\t\t\t\tisFirst = false;\n\t\t\t\t\t\txmin = rect.x;\n\t\t\t\t\t\tymin = rect.y;\n\t\t\t\t\t\txmax = rect.x + rect.width;\n\t\t\t\t\t\tymax = rect.y + rect.height;\n\t\t\t\t\t} else {\n\t\t\t\t\t\txmin = Math.min( xmin, rect.x );\n\t\t\t\t\t\tymin = Math.min( ymin, rect.y );\n\t\t\t\t\t\txmax = Math.max( xmax, rect.x + rect.width );\n\t\t\t\t\t\tymax = Math.max( ymax, rect.y + rect.height );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tbounds.clear();\n\n\t\twork.set( xmin, ymin );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\n\t\twork.set( xmax, ymax );\n\t\tworldTransform.apply( work, work );\n\t\tbounds.addPoint( work );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DChartRegionImmutable } from \"./d-chart-region\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesCoordinateContainer } from \"./d-chart-series-coordinate\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport class DChartSeriesHitResult {\n\tshape: EShape | null;\n\tx: number;\n\ty: number;\n\tp0x: number;\n\tp0y: number;\n\tp1x: number;\n\tp1y: number;\n\tindex: number;\n\tt: number;\n\tdistance: number;\n\n\tconstructor() {\n\t\tthis.shape = null;\n\t\tthis.x = 0;\n\t\tthis.y = 0;\n\t\tthis.p0x = 0;\n\t\tthis.p0y = 0;\n\t\tthis.p1x = 0;\n\t\tthis.p1y = 0;\n\t\tthis.index = 0;\n\t\tthis.t = 0;\n\t\tthis.distance = 0;\n\t}\n\n\tcopyFrom( other: DChartSeriesHitResult ): this {\n\t\tthis.shape = other.shape;\n\t\tthis.x = other.x;\n\t\tthis.y = other.y;\n\t\tthis.p0x = other.p0x;\n\t\tthis.p0y = other.p0y;\n\t\tthis.p1x = other.p1x;\n\t\tthis.p1y = other.p1y;\n\t\tthis.index = other.index;\n\t\tthis.t = other.t;\n\t\tthis.distance = other.distance;\n\t\treturn this;\n\t}\n}\n\nexport interface DChartSeries {\n\treadonly domain: DChartRegionImmutable;\n\treadonly range: DChartRegionImmutable;\n\treadonly shape: EShape | null;\n\treadonly container: DChartSeriesContainer | null;\n\treadonly coordinate: DChartSeriesCoordinateContainer;\n\treadonly index: number;\n\treadonly state: DBaseStateSet;\n\n\tbind( container: DChartSeriesContainer, index: number ): void;\n\tunbind(): void;\n\n\ttoDirty(): void;\n\n\tupdate(): void;\n\tdestroy(): void;\n\n\thitTest( global: IPoint ): boolean;\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesFill } from \"./d-chart-series-fill\";\nimport { DChartSeriesFillComputed, DChartSeriesFillComputedOptions } from \"./d-chart-series-fill-computed\";\n\nexport class DChartSeriesFillComputedImpl implements DChartSeriesFillComputed {\n\tenable: boolean;\n\tcolor: number;\n\talpha: number;\n\n\tconstructor( enable: boolean, color: number, alpha: number ) {\n\t\tthis.enable = enable;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t}\n\n\tstatic from(\n\t\tbase: DChartSeriesFill, index: number,\n\t\tfill?: DChartSeriesFillComputedOptions\n\t): DChartSeriesFillComputed {\n\t\tif( fill ) {\n\t\t\treturn new DChartSeriesFillComputedImpl(\n\t\t\t\t( fill.enable != null ? fill.enable : base.enable( index ) ),\n\t\t\t\t( fill.color != null ? fill.color : base.color( index ) ),\n\t\t\t\t( fill.alpha != null ? fill.alpha : base.alpha( index ) )\n\t\t\t);\n\t\t} else {\n\t\t\treturn new DChartSeriesFillComputedImpl(\n\t\t\t\tbase.enable( index ),\n\t\t\t\tbase.color( index ),\n\t\t\t\tbase.alpha( index )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isArray } from \"./util/is-array\";\nimport { isFunction } from \"./util/is-function\";\n\nexport type DChartSeriesScalar<T> = ( index: number ) => T;\n\nexport class DChartSeriesScalars {\n\tstatic from<T>(\n\t\tvalue: T | T[] | DChartSeriesScalar<T> | undefined,\n\t\tdef: T | T[] | DChartSeriesScalar<T>\n\t): DChartSeriesScalar<T> {\n\t\tif( isArray( value ) ) {\n\t\t\treturn ( index: number ) => value[ index % value.length ];\n\t\t} else if( isFunction( value ) ) {\n\t\t\treturn value;\n\t\t} else if( value != null ) {\n\t\t\treturn () => value;\n\t\t} else if( isArray( def ) ) {\n\t\t\treturn ( index: number ) => def[ index % def.length ];\n\t\t} else if( isFunction( def ) ) {\n\t\t\treturn def;\n\t\t} else {\n\t\t\treturn () => def;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartColorSet2 } from \"./d-chart-color-set\";\nimport { DChartSeriesFill, DChartSeriesFillOptions } from \"./d-chart-series-fill\";\nimport { DChartSeriesScalar, DChartSeriesScalars } from \"./d-chart-series-scalar\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\n\nexport class DChartSeriesFillImpl implements DChartSeriesFill {\n\tenable: DChartSeriesScalar<boolean>;\n\tcolor: DChartSeriesScalar<number>;\n\talpha: DChartSeriesScalar<number>;\n\n\tconstructor( options?: DChartSeriesFillOptions ) {\n\t\tthis.enable = DChartSeriesScalars.from( options && options.enable, true );\n\t\tthis.color = DChartSeriesScalars.from( options && options.color, DChartColorSet2 );\n\t\tthis.alpha = DChartSeriesScalars.from( options && options.alpha, EShapeDefaults.FILL_ALPHA );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesPadding } from \"./d-chart-series-padding\";\nimport {\n\tDChartSeriesPaddingComputed, DChartSeriesPaddingComputedOptions\n} from \"./d-chart-series-padding-computed\";\n\nexport class DChartSeriesPaddingComputedImpl implements DChartSeriesPaddingComputed {\n\touter: number;\n\tinner: number;\n\n\tconstructor( outer: number, inner: number ) {\n\t\tthis.outer = outer;\n\t\tthis.inner = inner;\n\t}\n\n\tstatic from(\n\t\tbase: DChartSeriesPadding, index: number,\n\t\tpoint: DChartSeriesPaddingComputedOptions | undefined\n\t): DChartSeriesPaddingComputed {\n\t\tif( point ) {\n\t\t\treturn new DChartSeriesPaddingComputedImpl(\n\t\t\t\t( point.outer != null ? point.outer : base.outer( index ) ),\n\t\t\t\t( point.inner != null ? point.inner : base.inner( index ) )\n\t\t\t);\n\t\t} else {\n\t\t\treturn new DChartSeriesPaddingComputedImpl(\n\t\t\t\tbase.outer( index ),\n\t\t\t\tbase.inner( index )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesPadding, DChartSeriesPaddingOptions } from \"./d-chart-series-padding\";\nimport { DChartSeriesScalar, DChartSeriesScalars } from \"./d-chart-series-scalar\";\n\nexport class DChartSeriesPaddingImpl implements DChartSeriesPadding {\n\touter: DChartSeriesScalar<number>;\n\tinner: DChartSeriesScalar<number>;\n\n\tconstructor( options: DChartSeriesPaddingOptions | undefined ) {\n\t\tthis.outer = DChartSeriesScalars.from( options && options.outer, 0.2 );\n\t\tthis.inner = DChartSeriesScalars.from( options && options.inner, 0.1 );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesPoint } from \"./d-chart-series-point\";\nimport { DChartSeriesPointComputed, DChartSeriesPointComputedOptions } from \"./d-chart-series-point-computed\";\n\nexport class DChartSeriesPointComputedImpl implements DChartSeriesPointComputed {\n\tx: number;\n\ty: number;\n\n\tconstructor( x: number, y: number ) {\n\t\tthis.x = x;\n\t\tthis.y = y;\n\t}\n\n\tstatic from(\n\t\tbase: DChartSeriesPoint, index: number,\n\t\tpoint: DChartSeriesPointComputedOptions | undefined,\n\t\tx: number, y: number\n\t): DChartSeriesPointComputed {\n\t\tif( point ) {\n\t\t\treturn new DChartSeriesPointComputedImpl(\n\t\t\t\t( point.x != null ? point.x : ( base.x != null ? base.x( index ) : x ) ),\n\t\t\t\t( point.y != null ? point.y : ( base.y != null ? base.y( index ) : y ) )\n\t\t\t);\n\t\t} else {\n\t\t\treturn new DChartSeriesPointComputedImpl(\n\t\t\t\tbase.x != null ? base.x( index ) : x,\n\t\t\t\tbase.y != null ? base.y( index ) : y\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesPoint, DChartSeriesPointOptions } from \"./d-chart-series-point\";\nimport { DChartSeriesScalar, DChartSeriesScalars } from \"./d-chart-series-scalar\";\n\nexport class DChartSeriesPointImpl implements DChartSeriesPoint {\n\tx?: DChartSeriesScalar<number>;\n\ty?: DChartSeriesScalar<number>;\n\n\tconstructor( options: DChartSeriesPointOptions | undefined ) {\n\t\tif( options ) {\n\t\t\tif( options.x != null ) {\n\t\t\t\tthis.x = DChartSeriesScalars.from( options.x, 0 );\n\t\t\t}\n\n\t\t\tif( options.y != null ) {\n\t\t\t\tthis.y = DChartSeriesScalars.from( options.y, 0 );\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesStroke } from \"./d-chart-series-stroke\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points-style\";\nimport { EShapePointsStyles } from \"./shape/e-shape-points-styles\";\nimport { EShapeStrokeSide } from \"./shape/e-shape-stroke-side\";\n\nexport class DChartSeriesStrokeComputedImpl implements DChartSeriesStrokeComputed {\n\tenable: boolean;\n\tcolor: number;\n\talpha: number;\n\twidth: number;\n\talign: number;\n\tside: EShapeStrokeSide;\n\tstyle: EShapePointsStyle;\n\n\tconstructor(\n\t\tenable: boolean, color: number, alpha: number, width: number,\n\t\talign: number, side: EShapeStrokeSide, style: EShapePointsStyle\n\t) {\n\t\tthis.enable = enable;\n\t\tthis.color = color;\n\t\tthis.alpha = alpha;\n\t\tthis.width = width;\n\t\tthis.align = align;\n\t\tthis.side = side;\n\t\tthis.style = style;\n\t}\n\n\tstatic from(\n\t\tbase: DChartSeriesStroke, index: number,\n\t\tstroke?: DChartSeriesStrokeComputedOptions\n\t): DChartSeriesStrokeComputed {\n\t\tif( stroke ) {\n\t\t\treturn new DChartSeriesStrokeComputedImpl(\n\t\t\t\t( stroke.enable != null ? stroke.enable : base.enable( index ) ),\n\t\t\t\t( stroke.color != null ? stroke.color : base.color( index ) ),\n\t\t\t\t( stroke.alpha != null ? stroke.alpha : base.alpha( index ) ),\n\t\t\t\t( stroke.width != null ? stroke.width : base.width( index ) ),\n\t\t\t\t( stroke.align != null ? stroke.align : base.align( index ) ),\n\t\t\t\t( stroke.side != null ? stroke.side : base.side( index ) ),\n\t\t\t\tEShapePointsStyles.from( stroke.style != null ? stroke.style : base.style( index ) )\n\t\t\t);\n\t\t} else {\n\t\t\treturn new DChartSeriesStrokeComputedImpl(\n\t\t\t\tbase.enable( index ),\n\t\t\t\tbase.color( index ),\n\t\t\t\tbase.alpha( index ),\n\t\t\t\tbase.width( index ),\n\t\t\t\tbase.align( index ),\n\t\t\t\tbase.side( index ),\n\t\t\t\tEShapePointsStyles.from( base.style( index ) )\n\t\t\t);\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartColorSet2 } from \"./d-chart-color-set\";\nimport { DChartSeriesScalar, DChartSeriesScalars } from \"./d-chart-series-scalar\";\nimport { DChartSeriesStroke, DChartSeriesStrokeOptions } from \"./d-chart-series-stroke\";\nimport { EShapeDefaults } from \"./shape/e-shape-defaults\";\nimport { EShapePointsStyle } from \"./shape/e-shape-points-style\";\nimport { EShapePointsStyleOption } from \"./shape/e-shape-points-styles\";\nimport { EShapeStrokeSide } from \"./shape/e-shape-stroke-side\";\n\nexport class DChartSeriesStrokeImpl implements DChartSeriesStroke {\n\tenable: DChartSeriesScalar<boolean>;\n\tcolor: DChartSeriesScalar<number>;\n\talpha: DChartSeriesScalar<number>;\n\twidth: DChartSeriesScalar<number>;\n\talign: DChartSeriesScalar<number>;\n\tside: DChartSeriesScalar<EShapeStrokeSide>;\n\tstyle: DChartSeriesScalar<EShapePointsStyleOption>;\n\n\tconstructor( options?: DChartSeriesStrokeOptions ) {\n\t\tthis.enable = DChartSeriesScalars.from( options && options.enable, true );\n\t\tthis.color = DChartSeriesScalars.from( options && options.color, DChartColorSet2 );\n\t\tthis.alpha = DChartSeriesScalars.from( options && options.alpha, EShapeDefaults.STROKE_ALPHA );\n\t\tthis.width = DChartSeriesScalars.from( options && options.width, EShapeDefaults.STROKE_WIDTH );\n\t\tthis.align = DChartSeriesScalars.from( options && options.width, EShapeDefaults.STROKE_ALIGN );\n\t\tthis.side = DChartSeriesScalars.from( options && options.side, EShapeStrokeSide.ALL );\n\t\tthis.style = DChartSeriesScalars.from( options && options.style,\n\t\t\tEShapePointsStyle.NON_EXPANDING_WIDTH |\n\t\t\tEShapePointsStyle.NON_SHRINKING_WIDTH |\n\t\t\tEShapePointsStyle.NON_SCALING_DOT_AND_DASH\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartPlotArea } from \"./d-chart-plot-area\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DChartSelection } from \"./d-chart-selection\";\nimport { DChartSeries, DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesContainer, DChartSeriesContainerOptions } from \"./d-chart-series-container\";\nimport { DChartSeriesFillComputed, DChartSeriesFillComputedOptions } from \"./d-chart-series-fill-computed\";\nimport { DChartSeriesFillComputedImpl } from \"./d-chart-series-fill-computed-impl\";\nimport { DChartSeriesFillImpl } from \"./d-chart-series-fill-impl\";\nimport { DChartSeriesPaddingComputed, DChartSeriesPaddingComputedOptions } from \"./d-chart-series-padding-computed\";\nimport { DChartSeriesPaddingComputedImpl } from \"./d-chart-series-padding-computed-impl\";\nimport { DChartSeriesPaddingImpl } from \"./d-chart-series-padding-impl\";\nimport { DChartSeriesPointComputed, DChartSeriesPointComputedOptions } from \"./d-chart-series-point-computed\";\nimport { DChartSeriesPointComputedImpl } from \"./d-chart-series-point-computed-impl\";\nimport { DChartSeriesPointImpl } from \"./d-chart-series-point-impl\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { DChartSeriesStrokeComputedImpl } from \"./d-chart-series-stroke-computed-impl\";\nimport { DChartSeriesStrokeImpl } from \"./d-chart-series-stroke-impl\";\n\nexport class DChartSeriesContainerImpl implements DChartSeriesContainer {\n\tprotected static WORK_CALCHITPOINT: DChartSeriesHitResult = new DChartSeriesHitResult();\n\n\tprotected _plotArea: DChartPlotArea;\n\tprotected _list: DChartSeries[];\n\tprotected _domain: DChartRegionImpl;\n\tprotected _range: DChartRegionImpl;\n\tprotected _selection: DChartSelection | null;\n\n\tprotected _fill: DChartSeriesFillImpl;\n\tprotected _stroke: DChartSeriesStrokeImpl;\n\tprotected _size: DChartSeriesPointImpl;\n\tprotected _offset: DChartSeriesPointImpl;\n\tprotected _padding: DChartSeriesPaddingImpl;\n\n\tconstructor( plotArea: DChartPlotArea, options?: DChartSeriesContainerOptions ) {\n\t\tthis._plotArea = plotArea;\n\t\tthis._domain = new DChartRegionImpl( NaN, NaN );\n\t\tthis._range = new DChartRegionImpl( NaN, NaN );\n\t\tthis._selection = (options && options.selection ) || null;\n\n\t\tthis._fill = new DChartSeriesFillImpl( options && options.fill );\n\t\tthis._stroke = new DChartSeriesStrokeImpl( options && options.stroke );\n\t\tthis._size = new DChartSeriesPointImpl( options && options.size );\n\t\tthis._offset = new DChartSeriesPointImpl( options && options.offset );\n\t\tthis._padding = new DChartSeriesPaddingImpl( options && options.padding );\n\n\t\tthis._list = [];\n\t\tconst list = options && options.list;\n\t\tif( list ) {\n\t\t\tconst listLength = list.length;\n\t\t\tif( 0 < listLength ) {\n\t\t\t\tfor( let i = 0; i < listLength; ++i ) {\n\t\t\t\t\tthis.add( list[ i ] );\n\t\t\t\t}\n\t\t\t\tthis.update();\n\t\t\t}\n\t\t}\n\t}\n\n\tnewFill(\n\t\tindex: number,\n\t\toptions: DChartSeriesFillComputedOptions | undefined\n\t): DChartSeriesFillComputed {\n\t\treturn DChartSeriesFillComputedImpl.from( this._fill, index, options );\n\t}\n\n\tnewStroke(\n\t\tindex: number,\n\t\toptions: DChartSeriesStrokeComputedOptions | undefined\n\t): DChartSeriesStrokeComputed {\n\t\treturn DChartSeriesStrokeComputedImpl.from( this._stroke, index, options );\n\t}\n\n\tnewSize(\n\t\tindex: number,\n\t\toptions: DChartSeriesPointComputedOptions | undefined,\n\t\tx: number, y: number\n\t): DChartSeriesPointComputed {\n\t\treturn DChartSeriesPointComputedImpl.from( this._size, index, options, x, y );\n\t}\n\n\tnewOffset(\n\t\tindex: number,\n\t\toptions: DChartSeriesPointComputedOptions | undefined,\n\t\tx: number, y: number\n\t): DChartSeriesPointComputed {\n\t\treturn DChartSeriesPointComputedImpl.from( this._offset, index, options, x, y );\n\t}\n\n\tnewPadding(\n\t\tindex: number,\n\t\toptions: DChartSeriesPaddingComputedOptions | undefined\n\t): DChartSeriesPaddingComputed {\n\t\treturn DChartSeriesPaddingComputedImpl.from( this._padding, index, options );\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tget selection(): DChartSelection | null {\n\t\treturn this._selection;\n\t}\n\n\tupdate(): void {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].update();\n\t\t}\n\t\tconst selection = this._selection;\n\t\tif( selection ) {\n\t\t\tselection.update();\n\t\t}\n\t}\n\n\tadd( series: DChartSeries ): void {\n\t\tconst list = this._list;\n\t\tseries.bind( this, list.length );\n\t\tlist.push( series );\n\t}\n\n\tget( index: number ): DChartSeries | null {\n\t\tconst list = this._list;\n\t\tif( 0 <= index && index < list.length ) {\n\t\t\treturn list[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tindexOf( series: DChartSeries ): number {\n\t\treturn this._list.indexOf( series );\n\t}\n\n\tclear(): this {\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tlist[ i ].destroy();\n\t\t}\n\t\tlist.length = 0;\n\t\treturn this;\n\t}\n\n\tsize(): number {\n\t\treturn this._list.length;\n\t}\n\n\tdestroy(): void {\n\t\tthis.clear();\n\t\tconst selection = this._selection;\n\t\tif( selection ) {\n\t\t\tselection.unbind();\n\t\t}\n\t}\n\n\tgetDomain( coordinate: DChartCoordinate, result: DChartRegion ): DChartRegion {\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.coordinate.x === coordinate ) {\n\t\t\t\tconst domain = series.domain;\n\t\t\t\tresult.add( domain.from, domain.to );\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tgetRange( coordinate: DChartCoordinate, result: DChartRegion ): DChartRegion {\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.coordinate.y === coordinate ) {\n\t\t\t\tconst range = series.range;\n\t\t\t\tresult.add( range.from, range.to );\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tget domain(): DChartRegion {\n\t\tconst result = this._domain;\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst domain = list[ i ].domain;\n\t\t\tresult.add( domain.from, domain.to );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tget range(): DChartRegion {\n\t\tconst result = this._range;\n\t\tresult.clear();\n\n\t\tconst list = this._list;\n\t\tfor( let i = 0, imax = list.length; i < imax; ++i ) {\n\t\t\tconst range = list[ i ].range;\n\t\t\tresult.add( range.from, range.to );\n\t\t}\n\n\t\treturn result;\n\t}\n\n\thitTest( global: IPoint ): DChartSeries | null {\n\t\tconst list = this._list;\n\t\tfor( let i = list.length - 1; 0 <= i; --i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.hitTest( global ) ) {\n\t\t\t\treturn series;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): DChartSeries | null {\n\t\tlet tmp1 = result;\n\t\tlet tmp2 = DChartSeriesContainerImpl.WORK_CALCHITPOINT;\n\t\tconst list = this._list;\n\t\tlet closest: DChartSeries | null = null;\n\t\ttmp2.distance = +Infinity;\n\t\tfor( let i = list.length - 1; 0 <= i; --i ) {\n\t\t\tconst series = list[ i ];\n\t\t\tif( series.calcHitPoint( global, tmp1 ) ) {\n\t\t\t\tif( tmp1.distance < tmp2.distance ) {\n\t\t\t\t\tclosest = series;\n\t\t\t\t\tconst tmp = tmp1;\n\t\t\t\t\ttmp1 = tmp2;\n\t\t\t\t\ttmp2 = tmp;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( closest && tmp2 !== result ) {\n\t\t\tresult.copyFrom( tmp2 );\n\t\t}\n\t\treturn closest;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Rectangle, Renderer } from \"pixi.js\";\nimport { DAnimationTimings } from \"./d-animation-timings\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DChart } from \"./d-chart\";\nimport { DChartAxisContainer, DChartAxisContainerOptions } from \"./d-chart-axis-container\";\nimport { DChartAxisContainerImpl } from \"./d-chart-axis-container-impl\";\nimport { DChartCoordinateContainer, DChartCoordinateContainerOptions } from \"./d-chart-coordinate-container\";\nimport { DChartCoordinateContainerImpl } from \"./d-chart-coordinate-container-impl\";\nimport { DChartPlotAreaContainer } from \"./d-chart-plot-area-container\";\nimport { DChartSeriesContainer, DChartSeriesContainerOptions } from \"./d-chart-series-container\";\nimport { DChartSeriesContainerImpl } from \"./d-chart-series-container-impl\";\nimport { DView, DViewOptions } from \"./d-view\";\nimport { DViewImpl } from \"./d-view-impl\";\nimport { UtilWheelEventDeltas } from \"./util/util-wheel-event\";\n\nexport interface DChartPlotAreaOptions<\n\tTHEME extends DThemeChartPlotArea = DThemeChartPlotArea\n> extends DBaseOptions<THEME> {\n\tmask?: boolean;\n\tcoordinate?: DChartCoordinateContainerOptions;\n\tseries?: DChartSeriesContainerOptions;\n\taxis?: DChartAxisContainerOptions;\n\tview?: DViewOptions;\n}\n\nexport interface DThemeChartPlotArea extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n}\n\nexport class DChartPlotArea<\n\tTHEME extends DThemeChartPlotArea = DThemeChartPlotArea,\n\tOPTIONS extends DChartPlotAreaOptions<THEME> = DChartPlotAreaOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _chart: DChart;\n\tprotected _container!: DChartPlotAreaContainer;\n\tprotected _series!: DChartSeriesContainerImpl;\n\tprotected _coordinate!: DChartCoordinateContainer;\n\tprotected _axis!: DChartAxisContainerImpl;\n\tprotected _view!: DViewImpl;\n\tprotected _isViewDirty!: boolean;\n\tprotected _isBoundsInContainerDirty!: boolean;\n\tprotected _boundsInContainer!: Rectangle;\n\tprotected _overflowMask?: DBaseOverflowMask | null;\n\tprotected _workPoint!: Point;\n\tprotected _blendStartTime: number;\n\tprotected _blendDuration: number;\n\tprotected _blendTimeout: number | null;\n\tprotected _onBlendBound: () => void;\n\n\tconstructor( chart: DChart, options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._chart = chart;\n\t\tthis._blendStartTime = 0;\n\t\tthis._blendDuration = 1000;\n\t\tthis._blendTimeout = null;\n\t\tthis._onBlendBound = () => {\n\t\t\tthis.onBlend();\n\t\t};\n\t}\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tconst container = new DChartPlotAreaContainer( (): void => {\n\t\t\tthis._isViewDirty = true;\n\t\t\tthis._isBoundsInContainerDirty = true;\n\t\t\tDApplications.update( this );\n\t\t});\n\t\tthis._container = container;\n\t\tthis._coordinate = new DChartCoordinateContainerImpl( this, options?.coordinate );\n\t\tconst series = new DChartSeriesContainerImpl( this, options?.series );\n\t\tthis._series = series;\n\t\tconst axis = new DChartAxisContainerImpl( this, options?.axis );\n\t\tthis._axis = axis;\n\t\tthis._isViewDirty = true;\n\t\tthis._isBoundsInContainerDirty = true;\n\t\tthis._boundsInContainer = new Rectangle();\n\t\tthis._workPoint = new Point();\n\n\t\tthis.addChild( container );\n\t\tthis.addChild( axis.container );\n\n\t\tthis._view = new DViewImpl( this, () => container, options?.view );\n\n\t\tconst selection = series.selection;\n\t\tif( selection ) {\n\t\t\tselection.bind( series );\n\t\t}\n\n\t\t// Overflow mask\n\t\tconst mask = options?.mask ?? this.theme.isOverflowMaskEnabled();\n\t\tif( mask ) {\n\t\t\tcontainer.mask = this.getOverflowMask();\n\t\t}\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tthis._isViewDirty = true;\n\t\tthis._isBoundsInContainerDirty = true;\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t}\n\n\tprotected getOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tget coordinate(): DChartCoordinateContainer {\n\t\treturn this._coordinate;\n\t}\n\n\tget chart(): DChart {\n\t\treturn this._chart;\n\t}\n\n\tget series(): DChartSeriesContainer {\n\t\treturn this._series;\n\t}\n\n\tget container(): DChartPlotAreaContainer {\n\t\treturn this._container;\n\t}\n\n\tget axis(): DChartAxisContainer {\n\t\treturn this._axis;\n\t}\n\n\tget view(): DView {\n\t\treturn this._view;\n\t}\n\n\tonWheel( e: WheelEvent, deltas: UtilWheelEventDeltas, global: Point ): boolean {\n\t\tconst vresult = this._view.onWheel( e, deltas, global );\n\t\tconst sresult = super.onWheel( e, deltas, global );\n\t\treturn vresult || sresult;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst vresult = this._view.onDblClick( e, interactionManager );\n\t\tconst sresult = super.onDblClick( e, interactionManager );\n\t\treturn vresult || sresult;\n\t}\n\n\tprotected onDown( e: interaction.InteractionEvent ): void {\n\t\tthis._view.onDown( e );\n\t\tsuper.onDown( e );\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tif( this._isViewDirty ) {\n\t\t\tthis._isViewDirty = false;\n\n\t\t\tthis._axis.update();\n\n\t\t\tconst selection = this._series.selection;\n\t\t\tif( selection ) {\n\t\t\t\tselection.update();\n\t\t\t}\n\t\t}\n\t\tsuper.render( renderer );\n\t}\n\n\tdestroy(): void {\n\t\tthis._container.destroy();\n\t\tthis._series.destroy();\n\t\tthis._axis.destroy();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartPlotArea\";\n\t}\n\n\tgetBoundsInContainer(): Rectangle {\n\t\tconst result = this._boundsInContainer;\n\t\tif( this._isBoundsInContainerDirty ) {\n\t\t\tthis._isBoundsInContainerDirty = false;\n\n\t\t\tconst container = this.container;\n\t\t\tcontainer.updateTransform();\n\t\t\tconst transform = container.transform.localTransform;\n\n\t\t\tconst work = this._workPoint;\n\n\t\t\twork.set( 0, 0 );\n\t\t\ttransform.applyInverse( work, work );\n\t\t\tresult.x = work.x;\n\t\t\tresult.y = work.y;\n\n\t\t\twork.set( this.width, this.height );\n\t\t\ttransform.applyInverse( work, work );\n\t\t\tresult.width = work.x - result.x;\n\t\t\tresult.height = work.y - result.y;\n\t\t}\n\t\treturn result;\n\t}\n\n\tfit( duration?: number, domainFrom?: number, domainTo?: number, rangeFrom?: number, rangeTo?: number ): this {\n\t\tconst coordinate = this._coordinate;\n\t\tconst axis = this._axis;\n\t\tconst series = this._series;\n\t\tif( duration != null && duration <= 0 ) {\n\t\t\tcoordinate.fit( domainFrom, domainTo, rangeFrom, rangeTo );\n\t\t\taxis.update();\n\t\t\tseries.update();\n\t\t} else {\n\t\t\tthis._blendDuration = duration != null ? duration : 200;\n\t\t\tthis._blendStartTime = Date.now();\n\t\t\tcoordinate.mark( domainFrom, domainTo, rangeFrom, rangeTo );\n\t\t\tconst blendTimeout = this._blendTimeout;\n\t\t\tif( blendTimeout != null ) {\n\t\t\t\twindow.clearTimeout( blendTimeout );\n\t\t\t}\n\t\t\tthis._blendTimeout = window.setTimeout( this._onBlendBound, 0 );\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected onBlend(): void {\n\t\tconst now = Date.now();\n\t\tlet ratio = (now - this._blendStartTime) / this._blendDuration;\n\t\tif( ratio < 1 ) {\n\t\t\tthis._blendTimeout = window.setTimeout( this._onBlendBound, 0 );\n\t\t} else {\n\t\t\tthis._blendTimeout = null;\n\t\t\tratio = 1;\n\t\t}\n\t\tthis._coordinate.blend( DAnimationTimings.ELASTIC( ratio ) );\n\t\tthis._axis.update();\n\t\tthis._series.update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartRegion } from \"./d-chart-region\";\nimport { isNaN } from \"./util/is-nan\";\n\nexport class DChartRegionImplObservable implements DChartRegion {\n\tprotected _from: number;\n\tprotected _to: number;\n\tprotected _onChange: () => void;\n\n\tconstructor( from: number, to: number, onChange: () => void ) {\n\t\tthis._from = from;\n\t\tthis._to = to;\n\t\tthis._onChange = onChange;\n\t}\n\n\tget from(): number {\n\t\treturn this._from;\n\t}\n\n\tset from( from: number ) {\n\t\tthis.set( from, undefined );\n\t}\n\n\tget to(): number {\n\t\treturn this._to;\n\t}\n\n\tset to( to: number ) {\n\t\tthis.set( undefined, to );\n\t}\n\n\tset( from?: number, to?: number ): this {\n\t\tlet isChanged = false;\n\n\t\tif( from != null && this._from !== from ) {\n\t\t\tif( ! isNaN( this._from ) || ! isNaN(from) ) {\n\t\t\t\tthis._from = from;\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif( to != null && this._to !== to ) {\n\t\t\tif( ! isNaN( this._to ) || ! isNaN(to) ) {\n\t\t\t\tthis._to = to;\n\t\t\t\tisChanged = true;\n\t\t\t}\n\t\t}\n\n\t\tif( isChanged ) {\n\t\t\tthis._onChange();\n\t\t}\n\t\treturn this;\n\t}\n\n\tadd( from: number, to: number ): this {\n\t\tlet newFrom: number | undefined;\n\t\tif( ! isNaN( from ) ) {\n\t\t\tnewFrom = ( isNaN( this.from ) ?\n\t\t\t\tfrom : Math.min( this.from, from )\n\t\t\t);\n\t\t}\n\n\t\tlet newTo: number | undefined;\n\t\tif( ! isNaN( to ) ) {\n\t\t\tnewTo = ( isNaN( this.to ) ?\n\t\t\t\tto : Math.max( this.to, to )\n\t\t\t);\n\t\t}\n\n\t\treturn this.set( newFrom, newTo );\n\t}\n\n\tclear(): this {\n\t\treturn this.set( NaN, NaN );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesCoordinateContainer, DChartSeriesCoordinateOptions } from \"./d-chart-series-coordinate\";\n\ninterface DChartSeriesBaseCoordinateContainerParent {\n\tcontainer: DChartSeriesContainer | null;\n}\n\nexport class DChartSeriesBaseCoordinateContainer implements DChartSeriesCoordinateContainer {\n\tprotected _parent: DChartSeriesBaseCoordinateContainerParent;\n\tprotected _coordinateIndexX: number;\n\tprotected _coordinateIndexY: number;\n\tprotected _coordinateIdUpdatedX: number;\n\tprotected _coordinateIdUpdatedY: number;\n\tprotected _coordinateTransformIdUpdatedX: number;\n\tprotected _coordinateTransformIdUpdatedY: number;\n\n\tconstructor( parent: DChartSeriesBaseCoordinateContainerParent, options?: DChartSeriesCoordinateOptions ) {\n\t\tthis._parent = parent;\n\t\tthis._coordinateIndexX = ( options && options.x != null ? options.x : 0 );\n\t\tthis._coordinateIndexY = ( options && options.y != null ? options.y : 0 );\n\t\tthis._coordinateIdUpdatedX = NaN;\n\t\tthis._coordinateIdUpdatedY = NaN;\n\t\tthis._coordinateTransformIdUpdatedX = NaN;\n\t\tthis._coordinateTransformIdUpdatedY = NaN;\n\t}\n\n\tget x(): DChartCoordinate | null {\n\t\tconst container = this._parent.container;\n\t\tif( container ) {\n\t\t\treturn container.plotArea.coordinate.x.get(\n\t\t\t\tthis._coordinateIndexX\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t}\n\n\tget y(): DChartCoordinate | null {\n\t\tconst container = this._parent.container;\n\t\tif( container ) {\n\t\t\treturn container.plotArea.coordinate.y.get(\n\t\t\t\tthis._coordinateIndexY\n\t\t\t);\n\t\t}\n\t\treturn null;\n\t}\n\n\tisDirty( coordinateX: DChartCoordinate, coordinateY: DChartCoordinate ): boolean {\n\t\tconst coordinateIdX = coordinateX.id;\n\t\tconst coordinateIdY = coordinateY.id;\n\t\tconst isCoordinateXChanged = ( coordinateIdX !== this._coordinateIdUpdatedX );\n\t\tconst isCoordinateYChanged = ( coordinateIdY !== this._coordinateIdUpdatedY );\n\t\tthis._coordinateIdUpdatedX = coordinateIdX;\n\t\tthis._coordinateIdUpdatedY = coordinateIdY;\n\t\treturn ( isCoordinateXChanged || isCoordinateYChanged );\n\t}\n\n\tisTransformDirty( coordinateX: DChartCoordinate, coordinateY: DChartCoordinate ): boolean {\n\t\tconst coordinateTransformIdX = coordinateX.transform.id;\n\t\tconst coordinateTransformIdY = coordinateY.transform.id;\n\t\tconst isCoordinateTransformXChanged = ( coordinateTransformIdX !== this._coordinateTransformIdUpdatedX );\n\t\tconst isCoordinateTransformYChanged = ( coordinateTransformIdY !== this._coordinateTransformIdUpdatedY );\n\t\tthis._coordinateTransformIdUpdatedX = coordinateTransformIdX;\n\t\tthis._coordinateTransformIdUpdatedY = coordinateTransformIdY;\n\t\treturn ( isCoordinateTransformXChanged || isCoordinateTransformYChanged );\n\t}\n\n\treset(): void {\n\t\tthis._coordinateIdUpdatedX = NaN;\n\t\tthis._coordinateIdUpdatedY = NaN;\n\t}\n\n\tdestroy(): void {\n\t\tthis.reset();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseOnOptions } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBaseStateSetImplObservable } from \"./d-base-state-set-impl-observable\";\nimport { DChartRegionImmutable } from \"./d-chart-region\";\nimport { DChartRegionImpl } from \"./d-chart-region-impl\";\nimport { DChartSeries, DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBaseCoordinateContainer } from \"./d-chart-series-base-coordinate-container\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesCoordinateContainer, DChartSeriesCoordinateOptions } from \"./d-chart-series-coordinate\";\nimport { EShape } from \"./shape/e-shape\";\n\n/**\n * {@link DChartSeriesBase} options.\n */\nexport interface DChartSeriesBaseOptions<EMITTER = any> {\n\tcoordinate?: DChartSeriesCoordinateOptions;\n\ton?: DBaseOnOptions<EMITTER>;\n}\n\n/**\n * A series represents a polyline.\n */\nexport abstract class DChartSeriesBase extends utils.EventEmitter implements DChartSeries {\n\tprotected _coordinate: DChartSeriesBaseCoordinateContainer;\n\n\tprotected _container?: DChartSeriesContainer;\n\tprotected _index: number;\n\n\tprotected _domain: DChartRegionImpl;\n\tprotected _range: DChartRegionImpl;\n\tprotected _regionPointId: number;\n\n\tprotected _state: DBaseStateSet;\n\n\tabstract readonly shape: EShape | null;\n\n\tconstructor( options?: DChartSeriesBaseOptions ) {\n\t\tsuper();\n\n\t\tthis._coordinate = new DChartSeriesBaseCoordinateContainer( this, options?.coordinate );\n\t\tthis._index = 0;\n\t\tthis._domain = new DChartRegionImpl( NaN, NaN );\n\t\tthis._range = new DChartRegionImpl( NaN, NaN );\n\t\tthis._regionPointId = NaN;\n\n\t\tthis._state = new DBaseStateSetImplObservable(( newState, oldState ): void => {\n\t\t\tthis.onStateChange( newState, oldState );\n\t\t});\n\n\t\t// Events\n\t\tif( options ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tconst handler = on[ name ];\n\t\t\t\t\tif( handler ) {\n\t\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tthis._container = container;\n\t\tthis._coordinate.reset();\n\t\tthis._index = index;\n\n\t\tconst chart = container.plotArea.chart;\n\t\tif( chart ) {\n\t\t\tthis._state.parent = chart.state;\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\tthis._container = undefined;\n\t}\n\n\tabstract toDirty(): void;\n\tabstract update(): void;\n\n\tget domain(): DChartRegionImmutable {\n\t\tthis.updateRegion();\n\t\treturn this._domain;\n\t}\n\n\tget range(): DChartRegionImmutable {\n\t\tthis.updateRegion();\n\t\treturn this._range;\n\t}\n\n\tget container(): DChartSeriesContainer | null {\n\t\treturn this._container || null;\n\t}\n\n\tget index(): number {\n\t\treturn this._index;\n\t}\n\n\tget coordinate(): DChartSeriesCoordinateContainer {\n\t\treturn this._coordinate;\n\t}\n\n\tget state(): DBaseStateSet {\n\t\treturn this._state;\n\t}\n\n\tprotected abstract updateRegion(): void;\n\n\tdestroy(): void {\n\t\tthis._container = undefined;\n\t\tthis._coordinate.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\treturn false;\n\t}\n\n\tprotected onStateChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tthis.toDirty();\n\t\tconst chart = this._container?.plotArea.chart;\n\t\tDApplications.update( chart );\n\t\tthis.emit( \"statechange\", newState, oldState, this );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBase, DChartSeriesBaseOptions } from \"./d-chart-series-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesFillComputed, DChartSeriesFillComputedOptions } from \"./d-chart-series-fill-computed\";\nimport { DChartSeriesPaddingComputedOptions } from \"./d-chart-series-padding-computed\";\nimport { DChartSeriesPointComputed, DChartSeriesPointComputedOptions } from \"./d-chart-series-point-computed\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfCircles } from \"./shape/variant/e-shape-line-of-circles\";\nimport { toCeilingIndex } from \"./util/to-ceiling-index\";\n\n/**\n * {@link DChartSeriesLineOfAny} options.\n */\nexport interface DChartSeriesLineOfAnyOptions extends DChartSeriesBaseOptions {\n\tpoints?: Array<number | null>;\n\tfill?: DChartSeriesFillComputedOptions;\n\tstroke?: DChartSeriesStrokeComputedOptions;\n\tsize?: DChartSeriesPointComputedOptions;\n\toffset?: DChartSeriesPointComputedOptions;\n\tpadding?: DChartSeriesPaddingComputedOptions;\n}\n\nexport interface DChartSeriesLineOfAnyRegion {\n\txmin: number;\n\txmax: number;\n\tymin: number;\n\tymax: number;\n}\n\n/**\n * A series represents a line of anything.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport abstract class DChartSeriesLineOfAny extends DChartSeriesBase {\n\tprotected static WORK: Point = new Point();\n\tprotected static WORK_REGION?: DChartSeriesLineOfAnyRegion;\n\n\tprotected _line: EShapeLineOfAny | null;\n\tprotected _options?: DChartSeriesLineOfAnyOptions;\n\tprotected _points: Array<number | null>;\n\tprotected _pointId: number;\n\tprotected _pointIdUpdated: number;\n\n\tprotected _stroke?: DChartSeriesStrokeComputed;\n\tprotected _fill?: DChartSeriesFillComputed;\n\tprotected _size?: DChartSeriesPointComputed;\n\tprotected _offset?: DChartSeriesPointComputed;\n\n\tconstructor( options?: DChartSeriesLineOfAnyOptions ) {\n\t\tsuper( options );\n\t\tthis._line = null;\n\t\tthis._options = options;\n\t\tthis._points = (options && options.points) || [];\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t}\n\n\tprotected getSizeDefault(): number {\n\t\treturn 10;\n\t}\n\n\tprotected getOffsetDefault(): number {\n\t\treturn 0;\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tlet line = this._line;\n\t\tif( ! line ) {\n\t\t\tline = this._line = this.newLineOfAny();\n\t\t\tconst options = this._options;\n\t\t\tthis.initLine( line, options, container, index );\n\t\t}\n\t\tline.attach( container.plotArea.container, index );\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.bind( container, index );\n\t}\n\n\tprotected initLine(\n\t\tline: EShapeLineOfAny,\n\t\toptions: DChartSeriesLineOfAnyOptions | undefined,\n\t\tcontainer: DChartSeriesContainer,\n\t\tindex: number\n\t): void {\n\t\tconst fill = container.newFill( index, options && options.fill );\n\t\tthis._fill = fill;\n\t\tline.fill.copy( fill );\n\n\t\tconst stroke = container.newStroke( index, options && options.stroke );\n\t\tthis._stroke = stroke;\n\t\tline.stroke.copy( stroke );\n\n\t\tconst sizeDefault = this.getSizeDefault();\n\t\tconst size = container.newSize( index, options && options.size, sizeDefault, sizeDefault );\n\t\tthis._size = size;\n\t\tline.points.size.set( size.x, size.y );\n\n\t\tconst offsetDefault = this.getOffsetDefault();\n\t\tconst offset = container.newOffset( index, options && options.offset, offsetDefault, offsetDefault );\n\t\tthis._offset = offset;\n\t\tline.points.offset.set( offset.x, offset.y );\n\t}\n\n\tprotected abstract newLineOfAny(): EShapeLineOfAny;\n\n\tunbind(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tline.detach();\n\t\t}\n\t\tsuper.unbind();\n\t}\n\n\tget shape(): EShapeLineOfAny | null {\n\t\treturn this._line;\n\t}\n\n\tget points(): Array<number | null> {\n\t\treturn this._points;\n\t}\n\n\tset points( points: Array<number | null> ) {\n\t\tthis._points = points;\n\t\tthis._pointId += 1;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._pointId += 1;\n\t}\n\n\tupdate(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst coordinate = this._coordinate;\n\t\t\tconst coordinateX = coordinate.x;\n\t\t\tconst coordinateY = coordinate.y;\n\t\t\tif( coordinateX && coordinateY ) {\n\t\t\t\tconst pointId = this._pointId;\n\t\t\t\tconst isPointChanged = ( pointId !== this._pointIdUpdated );\n\t\t\t\tconst isCoordinateChanged = coordinate.isDirty( coordinateX, coordinateY );\n\t\t\t\tconst isCoordinateTransformChanged = coordinate.isTransformDirty( coordinateX, coordinateY );\n\t\t\t\tif( isPointChanged || isCoordinateChanged || isCoordinateTransformChanged ) {\n\t\t\t\t\tthis._pointIdUpdated = pointId;\n\t\t\t\t\tthis.updateLine(\n\t\t\t\t\t\tline,\n\t\t\t\t\t\tcoordinateX,\n\t\t\t\t\t\tcoordinateY\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLine(\n\t\tline: EShapeLineOfAny,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate\n\t): void {\n\t\tconst values = line.points.values;\n\t\tconst valuesLength = values.length;\n\t\tlet ivalues = 0;\n\t\tconst points = this._points;\n\t\tlet xmin = NaN;\n\t\tlet xmax = NaN;\n\t\tlet ymin = NaN;\n\t\tlet ymax = NaN;\n\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\tconst x = points[ i ];\n\t\t\tconst y = points[ i + 1 ];\n\t\t\tif( x != null && y != null ) {\n\t\t\t\tif( ivalues < valuesLength ) {\n\t\t\t\t\tvalues[ ivalues ] = x;\n\t\t\t\t\tvalues[ ivalues + 1 ] = y;\n\t\t\t\t} else {\n\t\t\t\t\tvalues.push( x, y );\n\t\t\t\t}\n\t\t\t\tivalues += 2;\n\t\t\t\tif( xmin !== xmin ) {\n\t\t\t\t\txmin = x;\n\t\t\t\t\txmax = x;\n\t\t\t\t\tymin = y;\n\t\t\t\t\tymax = y;\n\t\t\t\t} else {\n\t\t\t\t\txmin = Math.min( xmin, x );\n\t\t\t\t\txmax = Math.max( xmax, x );\n\t\t\t\t\tymin = Math.min( ymin, y );\n\t\t\t\t\tymax = Math.max( ymax, y );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( values.length !== ivalues ) {\n\t\t\tvalues.length = ivalues;\n\t\t}\n\n\t\txcoordinate.mapAll( values, 0, ivalues, 2, 0 );\n\t\tycoordinate.mapAll( values, 0, ivalues, 2, 1 );\n\t\txcoordinate.transform.mapAll( values, 0, ivalues, 2, 0 );\n\t\tycoordinate.transform.mapAll( values, 0, ivalues, 2, 1 );\n\n\t\tif( xmin !== xmin ) {\n\t\t\txmin = 0;\n\t\t\txmax = 0;\n\t\t\tymin = 0;\n\t\t\tymax = 0;\n\t\t}\n\t\tconst region = this.adjustLineRegion(\n\t\t\txmin, xmax,\n\t\t\tymin, ymax,\n\t\t\tDChartSeriesLineOfAny.WORK_REGION || {\n\t\t\t\txmin: 0, xmax: 0,\n\t\t\t\tymin: 0, ymax: 0\n\t\t\t}\n\t\t);\n\t\txmin = xcoordinate.transform.map( xcoordinate.map( region.xmin ) );\n\t\txmax = xcoordinate.transform.map( xcoordinate.map( region.xmax ) );\n\t\tymin = ycoordinate.transform.map( ycoordinate.map( region.ymin ) );\n\t\tymax = ycoordinate.transform.map( ycoordinate.map( region.ymax ) );\n\n\t\tconst sx = Math.abs( xmax - xmin );\n\t\tconst sy = Math.abs( ymax - ymin );\n\t\tconst cx = ( xmin + xmax ) * 0.5;\n\t\tconst cy = ( ymin + ymax ) * 0.5;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\tvalues[ i + 0 ] -= cx;\n\t\t\tvalues[ i + 1 ] -= cy;\n\t\t}\n\n\t\tline.disallowUploadedUpdate();\n\t\tthis.applyLine( line, xcoordinate, ycoordinate, sx, sy, cx, cy, values );\n\t\tline.allowUploadedUpdate();\n\t\tDApplications.update( line );\n\t}\n\n\tprotected adjustLineRegion(\n\t\txmin: number, xmax: number,\n\t\tymin: number, ymax: number,\n\t\tresult: DChartSeriesLineOfAnyRegion\n\t): DChartSeriesLineOfAnyRegion {\n\t\tresult.xmin = xmin;\n\t\tresult.xmax = xmax;\n\t\tresult.ymin = ymin;\n\t\tresult.ymax = ymax;\n\t\treturn result;\n\t}\n\n\tprotected applyLine(\n\t\tline: EShapeLineOfAny,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate,\n\t\tsx: number, sy: number,\n\t\tcx: number, cy: number,\n\t\tvalues: number[]\n\t): void {\n\t\tline.points.set( values );\n\t\tline.size.set( sx, sy );\n\t\tline.transform.position.set( cx, cy );\n\t}\n\n\tprotected updateRegion(): void {\n\t\tconst pointId = this._pointId;\n\t\tif( this._regionPointId !== pointId ) {\n\t\t\tthis._regionPointId = pointId;\n\t\t\tconst points = this._points;\n\t\t\tconst domain = this._domain;\n\t\t\tconst range = this._range;\n\t\t\tdomain.clear();\n\t\t\trange.clear();\n\t\t\tthis.calcRegion( points, domain, range );\n\t\t}\n\t}\n\n\tprotected calcRegion( points: Array<number | null>, domain: DChartRegion, range: DChartRegion ): void {\n\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\tconst xraw = points[ i ];\n\t\t\tif( xraw != null ) {\n\t\t\t\tdomain.add( xraw, xraw );\n\t\t\t}\n\t\t\tconst yraw = points[ i + 1 ];\n\t\t\tif( yraw != null ) {\n\t\t\t\trange.add( yraw, yraw );\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tthis._line = null;\n\t\t\tline.detach();\n\t\t\tline.destroy();\n\t\t}\n\n\t\tthis._points.length = 0;\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLineOfAny.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\treturn line.contains( local ) != null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLineOfAny.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\tresult.shape = line;\n\t\t\treturn line.calcHitPoint( local, null, this.calcHitPointTestRange, this.calcHitPointHitTester, result );\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPointTestRange(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tthreshold: number,\n\t\tvalues: number[],\n\t\tresult: [ number, number ]\n\t): [ number, number ] {\n\t\tconst to = toCeilingIndex( values, x + ax + ox, 2, 0 );\n\t\tlet from = 0;\n\t\tfor( let i = to - 1, iv = i << 1; 0 <= i; i -= 1, iv -= 2 ) {\n\t\t\tif( values[ iv ] <= x - ax ) {\n\t\t\t\tfrom = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tresult[ 0 ] = from;\n\t\tresult[ 1 ] = from !== to ? to : Math.min( values.length << 1, to + 1 );\n\t\treturn result;\n\t}\n\n\tcalcHitPointHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tax: number, ay: number,\n\t\tox: number, oy: number,\n\t\tpx: number, py: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: DChartSeriesHitResult\n\t): boolean {\n\t\tconst shape = result.shape as EShapeLineOfCircles;\n\t\tif( shape.containsPointAbs( x, y, ax, ay, ox, oy, px, py ) ) {\n\t\t\tconst transform = shape.transform;\n\t\t\tconst position = transform.position;\n\t\t\tconst scale = transform.scale;\n\t\t\tresult.x = result.p0x = result.p1x = position.x + scale.x * px;\n\t\t\tresult.y = result.p0y = result.p1y = position.y + scale.y * py;\n\t\t\tresult.t = threshold;\n\t\t\tresult.index = index;\n\t\t\tconst dx = x - (px + ox);\n\t\t\tconst dy = y - (py + oy);\n\t\t\tresult.distance = Math.sqrt( dx * dx + dy * dy );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartRegion } from \"./d-chart-region\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport {\n\tDChartSeriesLineOfAny, DChartSeriesLineOfAnyOptions, DChartSeriesLineOfAnyRegion\n} from \"./d-chart-series-line-of-any\";\nimport { DChartSeriesPaddingComputed } from \"./d-chart-series-padding-computed\";\nimport { DChartSeriesPointComputedOptions } from \"./d-chart-series-point-computed\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfRectangles } from \"./shape/variant/e-shape-line-of-rectangles\";\nimport { isArray } from \"./util/is-array\";\n\nexport interface DChartSeriesBarSizeOptions extends DChartSeriesPointComputedOptions {\n\tauto?: boolean;\n}\n\nexport interface DChartSeriesBarOptions extends DChartSeriesLineOfAnyOptions {\n\tsize?: DChartSeriesBarSizeOptions;\n}\n\n/**\n * A series represents bars.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesBar extends DChartSeriesLineOfAny {\n\tprotected _barCount: number;\n\tprotected _barIndex: number;\n\tprotected _xcoordinateId: number;\n\tprotected _xcoordinateTransformId: number;\n\tprotected _padding?: DChartSeriesPaddingComputed;\n\tprotected _isSizeAutomatic: boolean;\n\n\tconstructor( options?: DChartSeriesBarOptions ) {\n\t\tsuper( options );\n\t\tthis._barCount = -1;\n\t\tthis._barIndex = -1;\n\t\tthis._xcoordinateId = -1;\n\t\tthis._xcoordinateTransformId = -1;\n\t\tthis._isSizeAutomatic = (options && options.size && options.size.auto) !== false;\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tthis._barCount = -1;\n\t\tthis._barIndex = -1;\n\t\tthis._xcoordinateId = -1;\n\t\tthis._xcoordinateTransformId = -1;\n\t\tsuper.bind( container, index );\n\t}\n\n\tprotected initLine(\n\t\tline: EShapeLineOfAny,\n\t\toptions: DChartSeriesLineOfAnyOptions | undefined,\n\t\tcontainer: DChartSeriesContainer,\n\t\tindex: number\n\t): void {\n\t\tsuper.initLine( line, options, container, index );\n\t\tthis._padding = container.newPadding( index, options && options.padding );\n\t}\n\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfRectangles();\n\t}\n\n\tprotected getSizeDefault(): number {\n\t\treturn 1;\n\t}\n\n\tprotected adjustLineRegion(\n\t\txmin: number, xmax: number,\n\t\tymin: number, ymax: number,\n\t\tresult: DChartSeriesLineOfAnyRegion\n\t): DChartSeriesLineOfAnyRegion {\n\t\treturn super.adjustLineRegion(\n\t\t\txmin,\n\t\t\txmax,\n\t\t\tMath.min( 0, ymin ),\n\t\t\tMath.max( 0, ymax ),\n\t\t\tresult\n\t\t);\n\t}\n\n\tprotected updateBarCountAndIndex(): boolean {\n\t\tif( this._barIndex < 0 || this._barCount < 0 ) {\n\t\t\tlet barIndex = 0;\n\t\t\tlet barCount = 0;\n\t\t\tconst container = this._container;\n\t\t\tif( container ) {\n\t\t\t\tfor( let i = 0, imax = container.size(); i < imax; ++i ) {\n\t\t\t\t\tconst series = container.get( i );\n\t\t\t\t\tif( series === this ) {\n\t\t\t\t\t\tbarIndex = barCount;\n\t\t\t\t\t}\n\t\t\t\t\tif( series instanceof DChartSeriesBar ) {\n\t\t\t\t\t\tbarCount += 1;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tbarCount = Math.max( 1, barCount );\n\t\t\tthis._barCount = barCount;\n\t\t\tthis._barIndex = barIndex;\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected applyLine(\n\t\tline: EShapeLineOfAny,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate,\n\t\tsx: number, sy: number,\n\t\tcx: number, cy: number,\n\t\tvalues: number[]\n\t): void {\n\t\t// Offset\n\t\tconst size = this._size;\n\t\tconst offset = this._offset;\n\t\tconst padding = this._padding;\n\t\tif( size && offset && padding ) {\n\t\t\tconst xcoordinateId = xcoordinate.id;\n\t\t\tconst xcoordinateTransformId = xcoordinate.transform.id;\n\t\t\tif( this.updateBarCountAndIndex() || this._xcoordinateId !== xcoordinateId ||\n\t\t\t\tthis._xcoordinateTransformId !== xcoordinateTransformId ) {\n\t\t\t\tconst barCount = this._barCount;\n\t\t\t\tconst barIndex = this._barIndex;\n\t\t\t\tthis._xcoordinateId = xcoordinateId;\n\t\t\t\tthis._xcoordinateTransformId = xcoordinateTransformId;\n\n\t\t\t\tconst totalBandWidth = Math.abs(\n\t\t\t\t\txcoordinate.transform.map( xcoordinate.map( 0 ) ) -\n\t\t\t\t\txcoordinate.transform.map( xcoordinate.map( size.x ) )\n\t\t\t\t) * ( 1 - padding.outer );\n\t\t\t\tif( barCount <= 1 ) {\n\t\t\t\t\tline.points.offset.x = offset.x;\n\t\t\t\t\tline.points.size.x = totalBandWidth;\n\t\t\t\t} else {\n\t\t\t\t\tconst totalBarWidth = totalBandWidth * ( 1 - padding.inner );\n\t\t\t\t\tconst totalPaddingInner = totalBandWidth - totalBarWidth;\n\t\t\t\t\tconst barWidth = totalBarWidth / barCount;\n\t\t\t\t\tconst barPadding = totalPaddingInner / ( barCount - 1 );\n\t\t\t\t\tconst barX = barWidth * (barIndex + 0.5) + barIndex * barPadding;\n\t\t\t\t\tline.points.offset.x = offset.x + barX - totalBandWidth * 0.5;\n\t\t\t\t\tline.points.size.x = barWidth;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Sizes & Offsets\n\t\tlet sizes = line.points.size.y;\n\t\tif( ! isArray( sizes ) ) {\n\t\t\tsizes = [];\n\t\t}\n\t\tconst sizesLength = sizes.length;\n\n\t\tlet offsets = line.points.offset.y;\n\t\tif( ! isArray( offsets ) ) {\n\t\t\toffsets = [];\n\t\t}\n\t\tconst offsetsLength = offsets.length;\n\n\t\tlet isize = 0;\n\t\tconst y0 = ycoordinate.transform.map( ycoordinate.map( 0 ) ) - cy;\n\t\tfor( let i = 0, imax = values.length; i < imax; i += 2, isize += 1 ) {\n\t\t\tconst distance = values[ i + 1 ] - y0;\n\n\t\t\tconst s = Math.abs( distance );\n\t\t\tif( isize < sizesLength ) {\n\t\t\t\tsizes[ isize ] = s;\n\t\t\t} else {\n\t\t\t\tsizes.push( s );\n\t\t\t}\n\n\t\t\tconst o = -0.5 * distance;\n\t\t\tif( isize < offsetsLength ) {\n\t\t\t\toffsets[ isize ] = o;\n\t\t\t} else {\n\t\t\t\toffsets.push( o );\n\t\t\t}\n\t\t}\n\t\tif( sizes.length !== isize ) {\n\t\t\tsizes.length = isize;\n\t\t}\n\t\tif( offsets.length !== isize ) {\n\t\t\toffsets.length = isize;\n\t\t}\n\n\t\tline.points.size.y = sizes;\n\t\tline.points.offset.y = offsets;\n\n\t\t// Others\n\t\tsuper.applyLine( line, xcoordinate, ycoordinate, sx, sy, cx, cy, values );\n\t}\n\n\tprotected calcSizeX( def: number ): number {\n\t\tconst points = this._points;\n\t\tif( 2 < points.length ) {\n\t\t\tconst pointsLength = points.length;\n\t\t\tlet x0: number | null = points[ pointsLength - 2 ];\n\t\t\tfor( let i = pointsLength - 4; 0 <= i; i -= 2 ) {\n\t\t\t\tconst x1 = points[ i ];\n\t\t\t\tif( x0 != null && x1 != null ) {\n\t\t\t\t\treturn Math.abs(x0 - x1);\n\t\t\t\t} else {\n\t\t\t\t\tx0 = x1;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn def;\n\t}\n\n\tprotected calcRegion( points: Array<number | null>, domain: DChartRegion, range: DChartRegion ): void {\n\t\tsuper.calcRegion( points, domain, range );\n\n\t\tconst size = this._size;\n\t\tif( size ) {\n\t\t\tlet sx = size.x;\n\t\t\tif( this._isSizeAutomatic ) {\n\t\t\t\tsx = this.calcSizeX( sx );\n\t\t\t\tsize.x = sx;\n\t\t\t}\n\t\t\tconst sxh = sx * 0.5;\n\t\t\tdomain.set( domain.from - sxh, domain.to + sxh );\n\t\t}\n\t\trange.add( 0, 0 );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfCircles } from \"./shape/variant/e-shape-line-of-circles\";\n\n/**\n * A series represents a line of circles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfCircles extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfCircles();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfRectangleRoundeds } from \"./shape/variant/e-shape-line-of-rectangle-roundeds\";\n\n/**\n * A series represents a line of rounded rectangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfRectangleRoundeds extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfRectangleRoundeds();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfAny } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfRectangles } from \"./shape/variant/e-shape-line-of-rectangles\";\n\n/**\n * A series represents a line of rectangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfRectangles extends DChartSeriesLineOfAny {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfRectangles();\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesLineOfAny, DChartSeriesLineOfAnyOptions } from \"./d-chart-series-line-of-any\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfTriangles } from \"./shape/variant/e-shape-line-of-triangles\";\n\n/**\n * A series represents a line of triangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfTriangles extends DChartSeriesLineOfAny {\n\tprotected _sizeId: number;\n\n\tconstructor( options?: DChartSeriesLineOfAnyOptions ) {\n\t\tsuper( options );\n\t\tthis._sizeId = 0;\n\t}\n\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfTriangles();\n\t}\n\n\tprotected applyLine(\n\t\tline: EShapeLineOfAny,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate,\n\t\tsx: number, sy: number,\n\t\tcx: number, cy: number,\n\t\tvalues: number[]\n\t): void {\n\t\t// Offset\n\t\tconst size = this._size;\n\t\tconst offset = this._offset;\n\t\tif( size && offset && this._sizeId !== size.y ) {\n\t\t\tthis._sizeId = size.y;\n\t\t\tline.points.offset.y = offset.y - size.y * 0.2;\n\t\t}\n\n\t\t//\n\t\tsuper.applyLine( line, xcoordinate, ycoordinate, sx, sy, cx, cy, values );\n\t}\n}\n","/*\n * Copyright (C) 2020 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DChartSeriesLineOfTriangles } from \"./d-chart-series-line-of-triangles\";\nimport { EShapeLineOfAny } from \"./shape/variant/e-shape-line-of-any\";\nimport { EShapeLineOfTriangleRoundeds } from \"./shape/variant/e-shape-line-of-triangle-roundeds\";\n\n/**\n * A series represents a line of rounded triangles.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLineOfTriangleRoundeds extends DChartSeriesLineOfTriangles {\n\tprotected newLineOfAny(): EShapeLineOfAny {\n\t\treturn new EShapeLineOfTriangleRoundeds();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBase, DChartSeriesBaseOptions } from \"./d-chart-series-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { EShapeLine } from \"./shape/variant/e-shape-line\";\nimport { toCeilingIndex } from \"./util/to-ceiling-index\";\n\n/**\n * {@link DChartSeriesLine} options.\n */\nexport interface DChartSeriesLineOptions extends DChartSeriesBaseOptions {\n\tpoints?: Array<number | null>;\n\tstroke?: DChartSeriesStrokeComputedOptions;\n}\n\n/**\n * A series represents a polyline.\n * Data points must be sorted in ascending order on the X axis.\n */\nexport class DChartSeriesLine extends DChartSeriesBase {\n\tprotected static WORK: Point = new Point();\n\tprotected _line: EShapeLine | null;\n\tprotected _options?: DChartSeriesLineOptions;\n\tprotected _points: Array<number | null>;\n\tprotected _pointId: number;\n\tprotected _pointIdUpdated: number;\n\tprotected _stroke?: DChartSeriesStrokeComputed;\n\tprotected _centerX: number;\n\tprotected _centerY: number;\n\n\tconstructor( options?: DChartSeriesLineOptions ) {\n\t\tsuper( options );\n\t\tthis._line = null;\n\t\tthis._options = options;\n\t\tthis._points = (options && options.points) || [];\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t\tthis._centerX = 0;\n\t\tthis._centerY = 0;\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tlet line = this._line;\n\t\tif( ! line ) {\n\t\t\tconst stroke = this._stroke = container.newStroke( index, this._options?.stroke );\n\t\t\tline = this._line = new EShapeLine([], [], stroke.width, stroke.style);\n\t\t\tline.stroke.copy( stroke );\n\t\t}\n\t\tline.attach( container.plotArea.container, index );\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.bind( container, index );\n\t}\n\n\tunbind(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tline.detach();\n\t\t}\n\t\tsuper.unbind();\n\t}\n\n\tget shape(): EShapeLine | null {\n\t\treturn this._line;\n\t}\n\n\tget points(): Array<number | null> {\n\t\treturn this._points;\n\t}\n\n\tset points( points: Array<number | null> ) {\n\t\tthis._points = points;\n\t\tthis._pointId += 1;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._pointId += 1;\n\t}\n\n\tupdate(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst coordinate = this._coordinate;\n\t\t\tconst coordinateX = coordinate.x;\n\t\t\tconst coordinateY = coordinate.y;\n\t\t\tif( coordinateX && coordinateY ) {\n\t\t\t\tconst pointId = this._pointId;\n\t\t\t\tconst isPointChanged = ( pointId !== this._pointIdUpdated );\n\t\t\t\tconst isCoordinateChanged = coordinate.isDirty( coordinateX, coordinateY );\n\t\t\t\tconst isCoordinateTransformChanged = coordinate.isTransformDirty( coordinateX, coordinateY );\n\t\t\t\tif( isPointChanged || isCoordinateChanged || isCoordinateTransformChanged ) {\n\t\t\t\t\tthis._pointIdUpdated = pointId;\n\t\t\t\t\tthis.updateLine(\n\t\t\t\t\t\tline,\n\t\t\t\t\t\tcoordinateX,\n\t\t\t\t\t\tcoordinateY,\n\t\t\t\t\t\tisPointChanged || isCoordinateChanged\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLine(\n\t\tline: EShapeLine,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate,\n\t\tisPointsDirty: boolean\n\t): void {\n\t\tline.disallowUploadedUpdate();\n\t\tif( isPointsDirty ) {\n\t\t\tconst values = line.points.values;\n\t\t\tconst segments = line.points.segments;\n\t\t\tconst valuesLength = values.length;\n\t\t\tconst segmentsLength = segments.length;\n\t\t\tlet ivalues = 0;\n\t\t\tlet isegments = 0;\n\t\t\tconst points = this._points;\n\t\t\tlet xmin = NaN;\n\t\t\tlet xmax = NaN;\n\t\t\tlet ymin = NaN;\n\t\t\tlet ymax = NaN;\n\t\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\t\tconst x = points[ i ];\n\t\t\t\tconst y = points[ i + 1 ];\n\t\t\t\tif( x != null && y != null ) {\n\t\t\t\t\tif( ivalues < valuesLength ) {\n\t\t\t\t\t\tvalues[ ivalues ] = x;\n\t\t\t\t\t\tvalues[ ivalues + 1 ] = y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvalues.push( x, y );\n\t\t\t\t\t}\n\t\t\t\t\tivalues += 2;\n\t\t\t\t\tif( xmin !== xmin ) {\n\t\t\t\t\t\txmin = x;\n\t\t\t\t\t\txmax = x;\n\t\t\t\t\t\tymin = y;\n\t\t\t\t\t\tymax = y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\txmin = Math.min( xmin, x );\n\t\t\t\t\t\txmax = Math.max( xmax, x );\n\t\t\t\t\t\tymin = Math.min( ymin, y );\n\t\t\t\t\t\tymax = Math.max( ymax, y );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tconst segment = (i >> 1) - isegments;\n\t\t\t\t\tif( isegments < segmentsLength ) {\n\t\t\t\t\t\tsegments[ isegments ] = segment;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsegments.push( segment );\n\t\t\t\t\t}\n\t\t\t\t\tisegments += 1;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( values.length !== ivalues ) {\n\t\t\t\tvalues.length = ivalues;\n\t\t\t}\n\t\t\tif( segments.length !== isegments ) {\n\t\t\t\tsegments.length = isegments;\n\t\t\t}\n\n\t\t\txcoordinate.mapAll( values, 0, ivalues, 2, 0 );\n\t\t\tycoordinate.mapAll( values, 0, ivalues, 2, 1 );\n\n\t\t\tif( xmin !== xmin ) {\n\t\t\t\txmin = 0;\n\t\t\t\txmax = 0;\n\t\t\t\tymin = 0;\n\t\t\t\tymax = 0;\n\t\t\t}\n\n\t\t\txmin = xcoordinate.map( xmin );\n\t\t\txmax = xcoordinate.map( xmax );\n\t\t\tymin = ycoordinate.map( ymin );\n\t\t\tymax = ycoordinate.map( ymax );\n\n\t\t\tconst sx = Math.abs( xmax - xmin );\n\t\t\tconst sy = Math.abs( ymax - ymin );\n\t\t\tconst cx = ( xmin + xmax ) * 0.5;\n\t\t\tconst cy = ( ymin + ymax ) * 0.5;\n\t\t\tfor( let i = 0, imax = values.length; i < imax; i += 2 ) {\n\t\t\t\tvalues[ i + 0 ] -= cx;\n\t\t\t\tvalues[ i + 1 ] -= cy;\n\t\t\t}\n\n\t\t\tline.size.set( sx, sy );\n\t\t\tline.points.set( values, segments );\n\t\t\tthis._centerX = cx;\n\t\t\tthis._centerY = cy;\n\t\t}\n\n\t\tline.transform.position.set(\n\t\t\txcoordinate.transform.map( this._centerX ),\n\t\t\tycoordinate.transform.map( this._centerY )\n\t\t);\n\t\tline.transform.scale.set(\n\t\t\txcoordinate.transform.scale,\n\t\t\tycoordinate.transform.scale\n\t\t);\n\n\t\tline.allowUploadedUpdate();\n\t\tDApplications.update( line );\n\t}\n\n\tprotected updateRegion(): void {\n\t\tconst pointId = this._pointId;\n\t\tif( this._regionPointId !== pointId ) {\n\t\t\tthis._regionPointId = pointId;\n\n\t\t\tconst points = this._points;\n\t\t\tconst domain = this._domain;\n\t\t\tconst range = this._range;\n\t\t\tdomain.clear();\n\t\t\trange.clear();\n\t\t\tif( points != null ) {\n\t\t\t\tfor( let i = 0, imax = points.length; i < imax; i += 2 ) {\n\t\t\t\t\tconst xraw = points[ i ];\n\t\t\t\t\tif( xraw != null ) {\n\t\t\t\t\t\tdomain.add( xraw, xraw );\n\t\t\t\t\t}\n\t\t\t\t\tconst yraw = points[ i + 1 ];\n\t\t\t\t\tif( yraw != null ) {\n\t\t\t\t\t\trange.add( yraw, yraw );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tthis._line = null;\n\t\t\tline.detach();\n\t\t\tline.destroy();\n\t\t}\n\n\t\tthis._points.length = 0;\n\t\tthis._pointId = 0;\n\t\tthis._pointIdUpdated = NaN;\n\t\tsuper.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLine.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\treturn line.contains( local ) != null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLine.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\tresult.shape = line;\n\t\t\treturn line.calcHitPoint( local, this.toThreshold, this.calcHitPointTestRange, this.calcHitPointHitTester, result );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected toThreshold( this: unknown, strokeWidth: number, strokeScale: number ): number {\n\t\treturn +Infinity;\n\t}\n\n\tcalcHitPointTestRange(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tthreshold: number,\n\t\tvalues: number[],\n\t\tresult: [ number, number ]\n\t): [ number, number ] {\n\t\tconst index = toCeilingIndex( values, x, 2, 0 );\n\t\tresult[ 0 ] = Math.max( 0, index - 1 );\n\t\tresult[ 1 ] = index;\n\t\treturn result;\n\t}\n\n\tcalcHitPointHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tp0x: number, p0y: number,\n\t\tp1x: number, p1y: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: DChartSeriesHitResult\n\t): boolean {\n\t\tif( p0x <= x && x < p1x ) {\n\t\t\tconst l = p1x - p0x;\n\t\t\tif( 0.0001 < Math.abs( l ) ) {\n\t\t\t\tconst t = (x - p0x) / l;\n\t\t\t\tconst p2x = x;\n\t\t\t\tconst p2y = p0y + t * (p1y - p0y);\n\t\t\t\tconst distance = Math.abs(p2y - y);\n\t\t\t\tif( distance < threshold ) {\n\t\t\t\t\tconst transform = result.shape!.transform;\n\t\t\t\t\tconst position = transform.position;\n\t\t\t\t\tconst px = position.x;\n\t\t\t\t\tconst py = position.y;\n\t\t\t\t\tconst scale = transform.scale;\n\t\t\t\t\tconst sx = scale.x;\n\t\t\t\t\tconst sy = scale.y;\n\t\t\t\t\tresult.x = px + sx * p2x;\n\t\t\t\t\tresult.y = py + sy * p2y;\n\t\t\t\t\tresult.p0x = px + sx * p0x;\n\t\t\t\t\tresult.p0y = py + sy * p0y;\n\t\t\t\t\tresult.p1x = px + sx * p1x;\n\t\t\t\t\tresult.p1y = py + sy * p1y;\n\t\t\t\t\tresult.t = t;\n\t\t\t\t\tresult.index = index;\n\t\t\t\t\tresult.distance = distance;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","import {\n\tDChartSeriesLinearParameters,\n\tDChartSeriesLinearParametersOptions\n} from \"./d-chart-series-linear-parameters\";\n\nexport class DChartSeriesExpressionParametersImpl implements DChartSeriesLinearParameters {\n\tprotected _id: number;\n\tprotected _idUpdated: number;\n\tprotected _a: number;\n\tprotected _b: number;\n\tprotected _x0: number;\n\tprotected _y0: number;\n\n\tconstructor( a: number, b: number, x0: number, y0: number ) {\n\t\tthis._id = 0;\n\t\tthis._idUpdated = NaN;\n\t\tthis._a = a;\n\t\tthis._b = b;\n\t\tthis._x0 = x0;\n\t\tthis._y0 = y0;\n\t}\n\n\tget a(): number {\n\t\treturn this._a;\n\t}\n\n\tset a( a: number ) {\n\t\tif( this._a !== a ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._a = a;\n\t\t}\n\t}\n\n\tget b(): number {\n\t\treturn this._b;\n\t}\n\n\tset b( b: number ) {\n\t\tif( this._b !== b ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._b = b;\n\t\t}\n\t}\n\n\tget x0(): number {\n\t\treturn this._x0;\n\t}\n\n\tset x0( x0: number ) {\n\t\tif( this._x0 !== x0 ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._x0 = x0;\n\t\t}\n\t}\n\n\tget y0(): number {\n\t\treturn this._y0;\n\t}\n\n\tset y0( y0: number ) {\n\t\tif( this._y0 !== y0 ) {\n\t\t\tthis._id += 1;\n\t\t\tthis._y0 = y0;\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n\n\tisDirty(): boolean {\n\t\treturn this._id !== this._idUpdated;\n\t}\n\n\ttoClean(): void {\n\t\tthis._idUpdated = this._id;\n\t}\n\n\tstatic from( options?: DChartSeriesLinearParametersOptions ): DChartSeriesExpressionParametersImpl {\n\t\tif( options ) {\n\t\t\treturn new DChartSeriesExpressionParametersImpl(\n\t\t\t\t( options.a != null ? options.a : 1 ),\n\t\t\t\t( options.b != null ? options.b : 1 ),\n\t\t\t\t( options.x0 != null ? options.x0 : 0 ),\n\t\t\t\t( options.y0 != null ? options.y0 : 0 )\n\t\t\t);\n\t\t}\n\t\treturn new DChartSeriesExpressionParametersImpl(\n\t\t\t1,\n\t\t\t1,\n\t\t\t0,\n\t\t\t0\n\t\t);\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesBase, DChartSeriesBaseOptions } from \"./d-chart-series-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { DChartSeriesLinearParameters, DChartSeriesLinearParametersOptions } from \"./d-chart-series-linear-parameters\";\nimport { DChartSeriesExpressionParametersImpl } from \"./d-chart-series-linear-parameters-impl\";\nimport { DChartSeriesStrokeComputed, DChartSeriesStrokeComputedOptions } from \"./d-chart-series-stroke-computed\";\nimport { EShapeLine } from \"./shape/variant/e-shape-line\";\n\n/**\n * {@link DChartSeriesLinear} options.\n */\nexport interface DChartSeriesLinearOptions extends DChartSeriesLinearParametersOptions, DChartSeriesBaseOptions {\n\tstroke?: DChartSeriesStrokeComputedOptions;\n}\n\n/**\n * A series represents a linear equation `a (x - x0) === b (y - y0)`.\n */\nexport class DChartSeriesLinear extends DChartSeriesBase {\n\tprotected static WORK: Point = new Point();\n\tprotected _line: EShapeLine | null;\n\tprotected _options?: DChartSeriesLinearOptions;\n\tprotected _plotAreaSizeXUpdated: number;\n\tprotected _plotAreaSizeYUpdated: number;\n\tprotected _parameters: DChartSeriesExpressionParametersImpl;\n\tprotected _stroke?: DChartSeriesStrokeComputed;\n\n\tconstructor( options?: DChartSeriesLinearOptions ) {\n\t\tsuper( options );\n\t\tthis._line = null;\n\t\tthis._options = options;\n\t\tthis._plotAreaSizeXUpdated = NaN;\n\t\tthis._plotAreaSizeYUpdated = NaN;\n\t\tthis._parameters = DChartSeriesExpressionParametersImpl.from( options );\n\t}\n\n\tbind( container: DChartSeriesContainer, index: number ): void {\n\t\tlet line = this._line;\n\t\tif( ! line ) {\n\t\t\tconst stroke = this._stroke = container.newStroke( index, this._options?.stroke );\n\t\t\tline = this._line = new EShapeLine([], [], stroke.width, stroke.style);\n\t\t\tline.stroke.color = stroke.color;\n\t\t\tline.stroke.alpha = stroke.alpha;\n\t\t}\n\t\tline.attach( container.plotArea.container, index );\n\t\tthis._parameters.toDirty();\n\t\tthis._plotAreaSizeXUpdated = NaN;\n\t\tthis._plotAreaSizeYUpdated = NaN;\n\t\tsuper.bind( container, index );\n\t}\n\n\tunbind(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tline.detach();\n\t\t}\n\t\tsuper.unbind();\n\t}\n\n\tget shape(): EShapeLine | null {\n\t\treturn this._line;\n\t}\n\n\tget parameters(): DChartSeriesLinearParameters {\n\t\treturn this._parameters;\n\t}\n\n\ttoDirty(): void {\n\t\tthis._parameters.toDirty();\n\t}\n\n\tupdate(): void {\n\t\tconst line = this._line;\n\t\tconst container = this._container;\n\t\tif( line && container ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tconst coordinate = this._coordinate;\n\t\t\tconst coordinateX = coordinate.x;\n\t\t\tconst coordinateY = coordinate.y;\n\t\t\tif( coordinateX && coordinateY ) {\n\t\t\t\tconst plotAreaWidth = plotArea.width;\n\t\t\t\tconst plotAreaHeight = plotArea.height;\n\n\t\t\t\tconst parameters = this._parameters;\n\t\t\t\tconst isParametersChanged = parameters.isDirty();\n\t\t\t\tconst isCoordinateChanged = coordinate.isDirty( coordinateX, coordinateY );\n\t\t\t\tconst isCoordinateTransformChanged = coordinate.isTransformDirty( coordinateX, coordinateY );\n\t\t\t\tconst isPlotAreaSizeChagned = ( plotAreaWidth !== this._plotAreaSizeXUpdated ||\n\t\t\t\t\tplotAreaHeight !== this._plotAreaSizeYUpdated );\n\t\t\t\tif( isParametersChanged || isCoordinateChanged || isCoordinateTransformChanged || isPlotAreaSizeChagned ) {\n\t\t\t\t\tparameters.toClean();\n\t\t\t\t\tthis._plotAreaSizeXUpdated = plotAreaWidth;\n\t\t\t\t\tthis._plotAreaSizeYUpdated = plotAreaHeight;\n\t\t\t\t\tthis.updateLine(\n\t\t\t\t\t\tline,\n\t\t\t\t\t\tcoordinateX,\n\t\t\t\t\t\tcoordinateY,\n\t\t\t\t\t\tplotAreaWidth,\n\t\t\t\t\t\tplotAreaHeight\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateLine(\n\t\tline: EShapeLine,\n\t\txcoordinate: DChartCoordinate,\n\t\tycoordinate: DChartCoordinate,\n\t\tplotAreaSizeX: number,\n\t\tplotAreaSizeY: number\n\t): void {\n\t\tconst values = line.points.values;\n\t\tconst segments = line.points.segments;\n\n\t\tconst parameters = this._parameters;\n\t\tconst a = parameters.a;\n\t\tconst b = parameters.b;\n\t\tconst x0 = parameters.x0;\n\t\tconst y0 = parameters.y0;\n\t\tconst aabs = Math.abs( a );\n\t\tconst babs = Math.abs( b );\n\n\t\tlet p0x = NaN;\n\t\tlet p0y = NaN;\n\t\tlet p1x = NaN;\n\t\tlet p1y = NaN;\n\n\t\tconst threshold = 0.00001;\n\t\tif( babs <= aabs ) {\n\t\t\tconst xfrom0 = xcoordinate.unmap(\n\t\t\t\txcoordinate.transform.unmap( 0 )\n\t\t\t);\n\t\t\tconst xto0 = xcoordinate.unmap(\n\t\t\t\txcoordinate.transform.unmap( plotAreaSizeX )\n\t\t\t);\n\t\t\tp0x = Math.min( xfrom0, xto0 );\n\t\t\tp1x = Math.max( xfrom0, xto0 );\n\n\t\t\tif( threshold < aabs ) {\n\t\t\t\tconst yfrom = ycoordinate.unmap(\n\t\t\t\t\tycoordinate.transform.unmap( 0 )\n\t\t\t\t);\n\t\t\t\tconst yto = ycoordinate.unmap(\n\t\t\t\t\tycoordinate.transform.unmap( plotAreaSizeY )\n\t\t\t\t);\n\t\t\t\tconst xfrom1 = b * (yfrom - y0) / a + x0;\n\t\t\t\tconst xto1 = b * (yto - y0) / a + x0;\n\t\t\t\tconst p2x = Math.min( xfrom1, xto1 );\n\t\t\t\tconst p3x = Math.max( xfrom1, xto1 );\n\n\t\t\t\tif( p0x < p2x ) {\n\t\t\t\t\tp0x = p2x;\n\t\t\t\t}\n\n\t\t\t\tif( p3x < p1x ) {\n\t\t\t\t\tp1x = p3x;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tp0y = a * (p0x - x0) + b * y0;\n\t\t\tp1y = a * (p1x - x0) + b * y0;\n\t\t} else {\n\t\t\tconst yfrom0 = ycoordinate.unmap(\n\t\t\t\tycoordinate.transform.unmap( 0 )\n\t\t\t);\n\t\t\tconst yto0 = ycoordinate.unmap(\n\t\t\t\tycoordinate.transform.unmap( plotAreaSizeY )\n\t\t\t);\n\t\t\tp0y = Math.min( yfrom0, yto0 );\n\t\t\tp1y = Math.max( yfrom0, yto0 );\n\n\t\t\tif( threshold < babs ) {\n\t\t\t\tconst xfrom = xcoordinate.unmap(\n\t\t\t\t\txcoordinate.transform.unmap( 0 )\n\t\t\t\t);\n\t\t\t\tconst xto = xcoordinate.unmap(\n\t\t\t\t\txcoordinate.transform.unmap( plotAreaSizeX )\n\t\t\t\t);\n\t\t\t\tconst yfrom1 = a * (xfrom - x0) / b + y0;\n\t\t\t\tconst yto1 = a * (xto - x0) / b + y0;\n\t\t\t\tconst p2y = Math.min( yfrom1, yto1 );\n\t\t\t\tconst p3y = Math.max( yfrom1, yto1 );\n\n\t\t\t\tif( p0y < p2y ) {\n\t\t\t\t\tp0y = p2y;\n\t\t\t\t}\n\n\t\t\t\tif( p3y < p1y ) {\n\t\t\t\t\tp1y = p3y;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tp0x = b * (p0y - y0) + a * x0;\n\t\t\tp1x = b * (p1y - y0) + a * x0;\n\t\t}\n\n\t\tp0x = xcoordinate.transform.map( xcoordinate.map( p0x ) );\n\t\tp0y = ycoordinate.transform.map( ycoordinate.map( p0y ) );\n\t\tp1x = xcoordinate.transform.map( xcoordinate.map( p1x ) );\n\t\tp1y = ycoordinate.transform.map( ycoordinate.map( p1y ) );\n\n\t\tconst cx = ( p0x + p1x ) * 0.5;\n\t\tconst cy = ( p0y + p1y ) * 0.5;\n\t\tconst sx = Math.abs( p1x - p0x );\n\t\tconst sy = Math.abs( p1y - p0y );\n\n\t\tp0x -= cx;\n\t\tp0y -= cy;\n\t\tp1x -= cx;\n\t\tp1y -= cy;\n\n\t\tif( values.length !== 4 ) {\n\t\t\tvalues.length = 0;\n\t\t\tvalues.push( p0x, p0y, p1x, p1y );\n\t\t} else {\n\t\t\tvalues[ 0 ] = p0x;\n\t\t\tvalues[ 1 ] = p0y;\n\t\t\tvalues[ 2 ] = p1x;\n\t\t\tvalues[ 3 ] = p1y;\n\t\t}\n\t\tif( segments.length !== 0 ) {\n\t\t\tsegments.length = 0;\n\t\t}\n\t\tline.disallowUploadedUpdate();\n\t\tline.points.set( values, segments );\n\t\tline.size.set( sx, sy );\n\t\tline.transform.position.set( cx, cy );\n\t\tline.allowUploadedUpdate();\n\t\tDApplications.update( line );\n\t}\n\n\tprotected updateRegion(): void {\n\t\t// DO NOTHING\n\t}\n\n\tdestroy(): void {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tthis._line = null;\n\t\t\tline.detach();\n\t\t\tline.destroy();\n\t\t}\n\t\tsuper.destroy();\n\t}\n\n\thitTest( global: IPoint ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLinear.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\treturn line.contains( local ) != null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tcalcHitPoint( global: IPoint, result: DChartSeriesHitResult ): boolean {\n\t\tconst line = this._line;\n\t\tif( line ) {\n\t\t\tconst work = DChartSeriesLinear.WORK;\n\t\t\tconst local = line.toLocal( global, undefined, work );\n\t\t\tresult.shape = line;\n\t\t\treturn line.calcHitPoint( local, this.toThreshold, null, this.calcHitPointHitTester, result );\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected toThreshold( this: unknown, strokeWidth: number, strokeScale: number ): number {\n\t\treturn +Infinity;\n\t}\n\n\tcalcHitPointHitTester(\n\t\tthis: unknown,\n\t\tx: number, y: number,\n\t\tp0x: number, p0y: number,\n\t\tp1x: number, p1y: number,\n\t\tindex: number,\n\t\tthreshold: number,\n\t\tresult: DChartSeriesHitResult\n\t): boolean {\n\t\tif( p0x <= x && x < p1x ) {\n\t\t\tconst l = p1x - p0x;\n\t\t\tif( 0.0001 < Math.abs( l ) ) {\n\t\t\t\tconst t = (x - p0x) / l;\n\t\t\t\tconst p2x = x;\n\t\t\t\tconst p2y = p0y + t * (p1y - p0y);\n\t\t\t\tconst distance = Math.abs(p2y - y);\n\t\t\t\tif( distance < threshold ) {\n\t\t\t\t\tconst transform = result.shape!.transform;\n\t\t\t\t\tconst position = transform.position;\n\t\t\t\t\tconst px = position.x;\n\t\t\t\t\tconst py = position.y;\n\t\t\t\t\tconst scale = transform.scale;\n\t\t\t\t\tconst sx = scale.x;\n\t\t\t\t\tconst sy = scale.y;\n\t\t\t\t\tresult.x = result.p0x = result.p1x = px + sx * p2x;\n\t\t\t\t\tresult.y = result.p0y = result.p1y = py + sy * p2y;\n\t\t\t\t\tresult.t = t;\n\t\t\t\t\tresult.index = index;\n\t\t\t\t\tresult.distance = distance;\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DBaseStateSetImpl } from \"./d-base-state-set-impl\";\nimport { DChartSelectionStyle } from \"./d-chart-selection\";\nimport {\n\tDChartSelectionShape, DChartSelectionShapeOptions,\n\tDThemeChartSelectionShape\n} from \"./d-chart-selection-shape\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { EShape } from \"./shape/e-shape\";\nimport { DThemes } from \"./theme/d-themes\";\nimport { isString } from \"./util/is-string\";\n\nexport abstract class DChartSelectionShapeBase implements DChartSelectionShape {\n\tprotected _isEnabled: boolean;\n\tprotected _shape?: EShape;\n\tprotected _style: DChartSelectionStyle;\n\tprotected _state: DBaseStateSet;\n\tprotected _theme: DThemeChartSelectionShape;\n\n\tconstructor( options?: DChartSelectionShapeOptions ) {\n\t\tconst theme = this.toTheme( options );\n\t\tthis._theme = theme;\n\t\tconst state = new DBaseStateSetImpl().add( options?.state ?? DBaseState.HOVERED );\n\t\tthis._state = state;\n\t\tthis._isEnabled = ( options?.enable ?? theme.isEnabled( state ) );\n\t\tthis._shape = options?.shape;\n\t\tthis._style = options?.style ?? this.setStyle;\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tconst shape = this._shape = (this._shape || this.newShape( this._theme ));\n\t\t\tshape.attach( container.plotArea.axis.container );\n\t\t\tshape.visible = false;\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tshape.detach();\n\t\t}\n\t}\n\n\tprotected newShape( theme: DThemeChartSelectionShape ): EShape {\n\t\treturn theme.newShape( this._state );\n\t}\n\n\tset( container: DChartSeriesContainer, mappedPosition: IPoint, series: DChartSeries ): void {\n\t\tthis.update( container, mappedPosition );\n\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tthis._style( shape, series );\n\t\t}\n\t}\n\n\tprotected setStyle( this: unknown, shape: EShape, series: DChartSeries ): void {\n\t\tconst seriesShape = series.shape;\n\t\tif( seriesShape ) {\n\t\t\tshape.stroke.color = seriesShape.stroke.color;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tshape.visible = false;\n\t\t}\n\t}\n\n\tabstract update( container: DChartSeriesContainer, mappedPosition: IPoint ): void;\n\n\tprotected toTheme( options?: DChartSelectionShapeOptions ): DThemeChartSelectionShape {\n\t\tconst theme = options?.theme;\n\t\tif( isString( theme ) ) {\n\t\t\treturn this.getTheme( theme );\n\t\t} else if( theme != null ) {\n\t\t\treturn theme;\n\t\t} else {\n\t\t\treturn this.getTheme( this.getType() );\n\t\t}\n\t}\n\n\tprotected getTheme( type: string ): DThemeChartSelectionShape {\n\t\treturn DThemes.getInstance().get( type );\n\t}\n\n\tprotected abstract getType(): string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartSelectionShapeBase } from \"./d-chart-selection-shape-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionGridlineX extends DChartSelectionShapeBase {\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tconst mappedX = mappedPosition.x;\n\t\t\tconst height = container.plotArea.height;\n\t\t\tshape.transform.position.set( mappedX, height * 0.5 );\n\t\t\tshape.size.set( 0, height );\n\t\t\tshape.visible = this.isVisible( container, mappedX );\n\t\t}\n\t}\n\n\tprotected isVisible( container: DChartSeriesContainer, mappedX: number ): boolean {\n\t\treturn ( 0 <= mappedX && mappedX <= container.plotArea.width );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartSelectionGridlineX\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartSelectionShapeBase } from \"./d-chart-selection-shape-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionGridlineY extends DChartSelectionShapeBase {\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tconst mappedY = mappedPosition.y;\n\t\t\tconst width = container.plotArea.width;\n\t\t\tshape.transform.position.set( width * 0.5, mappedY );\n\t\t\tshape.size.set( width, 0 );\n\t\t\tshape.visible = this.isVisible( container, mappedY );\n\t\t}\n\t}\n\n\tprotected isVisible( container: DChartSeriesContainer, mappedY: number ): boolean {\n\t\treturn ( 0 <= mappedY && mappedY <= container.plotArea.height );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartSelectionGridlineY\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport {\n\tDChartSelectionGridlineContainer, DChartSelectionGridlineContainerOptions\n} from \"./d-chart-selection-gridline-container\";\nimport { DChartSelectionGridlineX } from \"./d-chart-selection-gridline-x\";\nimport { DChartSelectionGridlineY } from \"./d-chart-selection-gridline-y\";\nimport { DChartSelectionShape } from \"./d-chart-selection-shape\";\nimport { DChartSeries } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionGridlineContainerImpl implements DChartSelectionGridlineContainer {\n\tprotected _x: DChartSelectionShape;\n\tprotected _y: DChartSelectionShape;\n\n\tconstructor( options?: DChartSelectionGridlineContainerOptions ) {\n\t\tthis._x = new DChartSelectionGridlineX( options && options.x );\n\t\tthis._y = new DChartSelectionGridlineY( options && options.y );\n\t}\n\n\tget x(): DChartSelectionShape {\n\t\treturn this._x;\n\t}\n\n\tget y(): DChartSelectionShape {\n\t\treturn this._y;\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tthis._x.bind( container );\n\t\tthis._y.bind( container );\n\t}\n\n\tunbind(): void {\n\t\tthis._x.unbind();\n\t\tthis._y.unbind();\n\t}\n\n\tset( container: DChartSeriesContainer, mappedPosition: IPoint, series: DChartSeries ): void {\n\t\tthis._x.set( container, mappedPosition, series );\n\t\tthis._y.set( container, mappedPosition, series );\n\t}\n\n\tunset(): void {\n\t\tthis._x.unset();\n\t\tthis._y.unset();\n\t}\n\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tthis._x.update( container, mappedPosition );\n\t\tthis._y.update( container, mappedPosition );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DChartSelectionShapeBase } from \"./d-chart-selection-shape-base\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\n\nexport class DChartSelectionMarker extends DChartSelectionShapeBase {\n\tupdate( container: DChartSeriesContainer, mappedPosition: IPoint ): void {\n\t\tconst shape = this._shape;\n\t\tif( shape ) {\n\t\t\tshape.transform.position.copyFrom( mappedPosition );\n\t\t\tshape.visible = this.isVisible( container, mappedPosition );\n\t\t}\n\t}\n\n\tprotected isVisible( container: DChartSeriesContainer, mappedPosition: IPoint ): boolean {\n\t\tconst x = mappedPosition.x;\n\t\tconst y = mappedPosition.y;\n\t\tconst plotArea = container.plotArea;\n\t\treturn ( 0 <= x && x <= plotArea.width && 0 <= y && y <= plotArea.height );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChartSelectionMarker\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DChartCoordinate } from \"./d-chart-coordinate\";\nimport { DChartSelectionPoint } from \"./d-chart-selection\";\nimport { DChartSelectionGridlineContainer } from \"./d-chart-selection-gridline-container\";\nimport { DChartSelectionGridlineContainerImpl } from \"./d-chart-selection-gridline-container-impl\";\nimport { DChartSelectionMarker } from \"./d-chart-selection-marker\";\nimport { DChartSelectionSub, DChartSelectionSubOptions } from \"./d-chart-selection-sub\";\nimport { DChartSeries, DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport class DChartSelectionSubImpl extends utils.EventEmitter implements DChartSelectionSub {\n\tprotected _container: DChartSeriesContainer | null;\n\tprotected _isEnabled: boolean;\n\tprotected _series: DChartSeries | null;\n\tprotected _coordinateX: DChartCoordinate | null;\n\tprotected _coordinateY: DChartCoordinate | null;\n\tprotected _position: Point;\n\tprotected _point: DChartSelectionPoint;\n\tprotected _work: Point;\n\tprotected _gridline: DChartSelectionGridlineContainer;\n\tprotected _marker: DChartSelectionMarker;\n\tprotected _state: string;\n\n\tconstructor( options: DChartSelectionSubOptions ) {\n\t\tsuper();\n\n\t\tthis._container = null;\n\t\tthis._series = null;\n\t\tthis._isEnabled = ( options.enable ?? true );\n\t\tthis._gridline = new DChartSelectionGridlineContainerImpl( options.gridline );\n\t\tthis._marker = new DChartSelectionMarker( options.marker );\n\t\tthis._state = ( options.state ?? DBaseState.HOVERED );\n\t\tthis._coordinateX = null;\n\t\tthis._coordinateY = null;\n\t\tthis._position = new Point();\n\t\tthis._point = ( options.point ?? DChartSelectionPoint.CLOSER );\n\t\tthis._work = new Point();\n\n\t\t// Events\n\t\tconst on = options.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tconst handler = on[ name ];\n\t\t\t\tif( handler ) {\n\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tif( this._isEnabled ) {\n\t\t\tthis._container = container;\n\t\t\tthis._gridline.bind( container );\n\t\t\tthis._marker.bind( container );\n\t\t}\n\t}\n\n\tunbind(): void {\n\t\tthis._marker.unbind();\n\t\tthis._gridline.unbind();\n\t\tthis._container = null;\n\t\tthis._coordinateX = null;\n\t\tthis._coordinateY = null;\n\t}\n\n\tget series(): DChartSeries | null {\n\t\treturn this._series;\n\t}\n\n\tget position(): Point {\n\t\treturn this._position;\n\t}\n\n\tget gridline(): DChartSelectionGridlineContainer {\n\t\treturn this._gridline;\n\t}\n\n\tget marker(): DChartSelectionMarker {\n\t\treturn this._marker;\n\t}\n\n\tset( series: DChartSeries, result: DChartSeriesHitResult | DChartSelectionSub ): void {\n\t\tconst container = this._container;\n\t\tconst coordinateX = this._coordinateX = series.coordinate.x;\n\t\tconst coordinateY = this._coordinateY = series.coordinate.y;\n\t\tif( container && coordinateX && coordinateY ) {\n\t\t\tconst transform = container.plotArea.container.localTransform;\n\t\t\tconst position = this._position;\n\t\t\tconst work = this._work;\n\t\t\tif( result instanceof DChartSeriesHitResult ) {\n\t\t\t\tlet x = result.x;\n\t\t\t\tlet y = result.y;\n\t\t\t\tswitch( this._point ) {\n\t\t\t\tcase DChartSelectionPoint.PREVIOUS:\n\t\t\t\t\tx = result.p0x;\n\t\t\t\t\ty = result.p0y;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DChartSelectionPoint.NEXT:\n\t\t\t\t\tx = result.p1x;\n\t\t\t\t\ty = result.p1y;\n\t\t\t\t\tbreak;\n\t\t\t\tcase DChartSelectionPoint.CLOSER:\n\t\t\t\t\tif( Math.abs( result.p0x - result.x ) < Math.abs( result.p1x - result.x ) ) {\n\t\t\t\t\t\tx = result.p0x;\n\t\t\t\t\t\ty = result.p0y;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tx = result.p1x;\n\t\t\t\t\t\ty = result.p1y;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\twork.set( x, y );\n\t\t\t\ttransform.apply( work, work );\n\t\t\t\tposition.set(\n\t\t\t\t\tcoordinateX.unmap( coordinateX.transform.unmap( x ) ),\n\t\t\t\t\tcoordinateY.unmap( coordinateY.transform.unmap( y ) )\n\t\t\t\t);\n\t\t\t} else {\n\t\t\t\tposition.copyFrom( result.position );\n\t\t\t\twork.set(\n\t\t\t\t\tcoordinateX.transform.map( coordinateX.map( position.x ) ),\n\t\t\t\t\tcoordinateY.transform.map( coordinateY.map( position.y ) )\n\t\t\t\t);\n\t\t\t\ttransform.apply( work, work );\n\t\t\t}\n\n\t\t\tthis._gridline.set( container, work, series );\n\t\t\tthis._marker.set( container, work, series );\n\n\t\t\tDApplications.update( container.plotArea );\n\t\t}\n\n\t\tconst oldSeries = this._series;\n\t\tif( oldSeries !== series ) {\n\t\t\tconst state = this._state;\n\t\t\tif( oldSeries ) {\n\t\t\t\toldSeries.state.remove( state );\n\t\t\t}\n\n\t\t\tthis._series = series;\n\t\t\tseries.state.add( state );\n\t\t}\n\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tprotected setStyle( this: unknown, shape: EShape, series: DChartSeries ): void {\n\t\tconst seriesShape = series.shape;\n\t\tif( seriesShape ) {\n\t\t\tshape.stroke.color = seriesShape.stroke.color;\n\t\t}\n\t}\n\n\tunset(): void {\n\t\tconst series = this._series;\n\t\tif( series ) {\n\t\t\tthis._series = null;\n\t\t\tthis._coordinateX = null;\n\t\t\tthis._coordinateY = null;\n\n\t\t\tseries.state.remove( this._state );\n\n\t\t\tthis._gridline.unset();\n\t\t\tthis._marker.unset();\n\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tupdate(): void {\n\t\tconst container = this._container;\n\t\tconst coordinateX = this._coordinateX;\n\t\tconst coordinateY = this._coordinateY;\n\t\tif( container && coordinateX && coordinateY ) {\n\t\t\tconst position = this._position;\n\t\t\tconst work = this._work;\n\t\t\twork.set(\n\t\t\t\tcoordinateX.transform.map( coordinateX.map( position.x ) ),\n\t\t\t\tcoordinateY.transform.map( coordinateY.map( position.y ) )\n\t\t\t);\n\t\t\tcontainer.plotArea.container.localTransform.apply( work, work );\n\n\t\t\tthis._gridline.update( container, work );\n\t\t\tthis._marker.update( container, work );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, utils } from \"pixi.js\";\nimport { DBaseOnOptions } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DChartSelection, DChartSelectionPoint } from \"./d-chart-selection\";\nimport { DChartSelectionSub, DChartSelectionSubOptions } from \"./d-chart-selection-sub\";\nimport { DChartSelectionSubImpl } from \"./d-chart-selection-sub-impl\";\nimport { DChartSeriesHitResult } from \"./d-chart-series\";\nimport { DChartSeriesContainer } from \"./d-chart-series-container\";\nimport { isString } from \"./util/is-string\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DChartSelectionSimpleOptions<EMITTER = any> {\n\tselected?: DChartSelectionSubOptions;\n\thovered?: DChartSelectionSubOptions;\n\tpoint?: DChartSelectionPoint | (keyof typeof DChartSelectionPoint);\n\ton?: DBaseOnOptions<EMITTER>;\n}\n\nexport class DChartSelectionSimple extends utils.EventEmitter implements DChartSelection {\n\tprotected static WORK_SELECT: DChartSeriesHitResult = new DChartSeriesHitResult();\n\n\tprotected _container: DChartSeriesContainer | null;\n\tprotected _selected: DChartSelectionSub;\n\tprotected _hovered: DChartSelectionSub;\n\n\tprotected _onClickBound!: ( e: interaction.InteractionEvent ) => void;\n\tprotected _onMoveBound!: ( e: interaction.InteractionEvent ) => void;\n\n\tconstructor( options?: DChartSelectionSimpleOptions ) {\n\t\tsuper();\n\n\t\tthis._container = null;\n\t\tconst point = ( options && options.point != null ?\n\t\t\t( isString( options.point ) ? DChartSelectionPoint[ options.point ] : options.point ) :\n\t\t\tDChartSelectionPoint.CLOSER\n\t\t);\n\n\t\tthis._selected = this.newSelected( point, options && options.selected );\n\t\tthis._hovered = this.newHovered( point, options && options.hovered );\n\n\t\t// Events\n\t\tif( options ) {\n\t\t\tconst on = options.on;\n\t\t\tif( on != null ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tconst handler = on[ name ];\n\t\t\t\t\tif( handler ) {\n\t\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//\n\t\tthis._onMoveBound = ( e: interaction.InteractionEvent ): void => {\n\t\t\tthis.onMove( e );\n\t\t};\n\n\t\tthis._onClickBound = ( e: interaction.InteractionEvent ): void => {\n\t\t\tthis.onClick( e );\n\t\t};\n\t}\n\n\tprotected newSelected(\n\t\tpoint: DChartSelectionPoint,\n\t\toptions?: DChartSelectionSubOptions\n\t): DChartSelectionSub {\n\t\treturn new DChartSelectionSubImpl(\n\t\t\tthis.toSubOptions(\n\t\t\t\tpoint,\n\t\t\t\toptions,\n\t\t\t\tDBaseState.ACTIVE\n\t\t\t)\n\t\t);\n\t}\n\n\tprotected newHovered(\n\t\tpoint: DChartSelectionPoint,\n\t\toptions?: DChartSelectionSubOptions\n\t): DChartSelectionSub {\n\t\treturn new DChartSelectionSubImpl(\n\t\t\tthis.toSubOptions(\n\t\t\t\tpoint,\n\t\t\t\toptions,\n\t\t\t\tDBaseState.HOVERED\n\t\t\t)\n\t\t);\n\t}\n\n\tprotected toSubOptions(\n\t\tpoint: DChartSelectionPoint,\n\t\toptions: DChartSelectionSubOptions | undefined,\n\t\tstate: string\n\t): DChartSelectionSubOptions {\n\t\toptions = options || {};\n\n\t\tif( options.point == null ) {\n\t\t\toptions.point = point;\n\t\t}\n\n\t\tif( options.state == null ) {\n\t\t\toptions.state = state;\n\t\t}\n\n\t\tconst gridline = options.gridline || {};\n\t\tconst gridlineX = gridline.x || {};\n\t\tif( gridlineX.state == null ) {\n\t\t\tgridlineX.state = state;\n\t\t}\n\n\t\tconst gridlineY = gridline.y || {};\n\t\tif( gridlineY.state == null ) {\n\t\t\tgridlineY.state = state;\n\t\t}\n\n\t\tconst marker = options.marker || {};\n\t\tif( marker.state == null ) {\n\t\t\tmarker.state = state;\n\t\t}\n\n\t\treturn options;\n\t}\n\n\tprotected onClick( e: interaction.InteractionEvent ): void {\n\t\tconst container = this._container;\n\t\tif( container && e.target === container.plotArea ) {\n\t\t\tconst hovered = this._hovered;\n\t\t\tconst series = hovered.series;\n\t\t\tconst selected = this._selected;\n\t\t\tif( series ) {\n\t\t\t\tselected.set( series, hovered );\n\t\t\t} else {\n\t\t\t\tselected.unset();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onMove( e: interaction.InteractionEvent ): void {\n\t\tconst container = this._container;\n\t\tif( container ) {\n\t\t\tconst hovered = this._hovered;\n\t\t\tif( e.target === container.plotArea ) {\n\t\t\t\tconst result = DChartSelectionSimple.WORK_SELECT;\n\t\t\t\tconst series = container.calcHitPoint( e.data.global, result );\n\t\t\t\tif( series ) {\n\t\t\t\t\thovered.set( series, result );\n\t\t\t\t} else {\n\t\t\t\t\thovered.unset();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\thovered.unset();\n\t\t\t}\n\t\t}\n\t}\n\n\tbind( container: DChartSeriesContainer ): void {\n\t\tthis._container = container;\n\t\tthis._selected.bind( container );\n\t\tthis._hovered.bind( container );\n\t\tconst plotArea = container.plotArea;\n\t\tplotArea.on( UtilPointerEvent.move, this._onMoveBound );\n\t\tUtilPointerEvent.onClick( plotArea, this._onClickBound );\n\t}\n\n\tunbind(): void {\n\t\tconst container = this._container;\n\t\tthis._container = null;\n\t\tif( container ) {\n\t\t\tconst plotArea = container.plotArea;\n\t\t\tplotArea.off( UtilPointerEvent.move, this._onMoveBound );\n\t\t}\n\n\t\tthis._selected.unbind();\n\t\tthis._hovered.unbind();\n\t}\n\n\tget selected(): DChartSelectionSub {\n\t\treturn this._selected;\n\t}\n\n\tget hovered(): DChartSelectionSub {\n\t\treturn this._hovered;\n\t}\n\n\tupdate(): void {\n\t\tthis._selected.update();\n\t\tthis._hovered.update();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseOverflowMask } from \"./d-base-overflow-mask\";\nimport { DChartPlotArea, DChartPlotAreaOptions} from \"./d-chart-plot-area\";\n\nexport interface DChartOptions<THEME extends DThemeChart> extends DBaseOptions<THEME> {\n\tplotArea: DChartPlotAreaOptions;\n\tmask?: boolean;\n}\n\nexport interface DThemeChart extends DThemeBase {\n\tisOverflowMaskEnabled(): boolean;\n}\n\nexport class DChart<\n\tTHEME extends DThemeChart = DThemeChart,\n\tOPTIONS extends DChartOptions<THEME> = DChartOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _plotArea!: DChartPlotArea;\n\tprotected _overflowMask?: DBaseOverflowMask | null;\n\n\tprotected init( options?: OPTIONS ): void {\n\t\tsuper.init( options );\n\n\t\tconst plotArea = new DChartPlotArea( this, options?.plotArea );\n\t\tthis._plotArea = plotArea;\n\t\tthis.addChild( plotArea );\n\n\t\t// Overflow mask\n\t\tconst mask = options?.mask ?? this.theme.isOverflowMaskEnabled();\n\t\tif( mask ) {\n\t\t\tplotArea.axis.container.mask = this.getOverflowMask();\n\t\t}\n\t}\n\n\tprotected getOverflowMask(): DBaseOverflowMask {\n\t\tif( this._overflowMask == null ) {\n\t\t\tthis._overflowMask = new DBaseOverflowMask( this );\n\t\t\tthis.addReflowable( this._overflowMask );\n\t\t\tthis.toDirty();\n\t\t}\n\t\treturn this._overflowMask;\n\t}\n\n\tget plotArea(): DChartPlotArea {\n\t\treturn this._plotArea;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DChart\";\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis._plotArea.destroy();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\n\nexport abstract class DCommandCreate implements DCommand {\n\tabstract execute(): Promise<unknown> | boolean;\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandDelete implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().delete();\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\tthrow new Error(\"Method not implemented.\");\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE | DCommandFlag.CLEAR;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandSaveAs implements DCommand {\n\tprotected _name: string;\n\n\tconstructor( name: string ) {\n\t\tthis._name = name;\n\t}\n\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().saveAs( this._name );\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommand } from \"./d-command\";\nimport { DCommandFlag } from \"./d-command-flag\";\nimport { DControllers } from \"./d-controllers\";\n\nexport class DCommandSave implements DCommand {\n\texecute(): Promise<unknown> | boolean {\n\t\treturn DControllers.getDocumentController().save();\n\t}\n\n\tredo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tundo(): Promise<unknown> | boolean {\n\t\treturn true;\n\t}\n\n\tdestroy(): void {\n\t\t// DO NOTHING\n\t}\n\n\tgetFlag(): DCommandFlag {\n\t\treturn DCommandFlag.UNSTORABLE;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBackgroundStateAware } from \"./d-background\";\nimport { DThemeBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\nimport { UtilRgb } from \"./util/util-rgb\";\n\nexport class DDiagramCanvasEditorBackground implements DBackgroundStateAware {\n\tprotected _target: DBackgroundStateAware;\n\tprotected _base: number | null;\n\n\tconstructor( target: DBackgroundStateAware, base: number | null ) {\n\t\tthis._target = target;\n\t\tthis._base = base;\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._target.getTheme();\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._target.setTheme( theme );\n\t}\n\n\tgetBaseColor(): number | null {\n\t\treturn this._base;\n\t}\n\n\tsetBaseColor( baseColor: number | null ): void {\n\t\tthis._base = baseColor;\n\t}\n\n\tgetColor( state: DBaseStateSet ): number | null {\n\t\tconst target = this._target;\n\t\tconst base = this._base;\n\t\tconst color = target.getColor( state );\n\t\tif( base != null ) {\n\t\t\tif( color != null ) {\n\t\t\t\treturn UtilRgb.blend( base, color, target.getAlpha( state ) );\n\t\t\t}\n\t\t\treturn base;\n\t\t}\n\t\treturn color;\n\t}\n\n\tget color(): DStateAwareOrValueMightBe<number | null> {\n\t\treturn this._target.color;\n\t}\n\n\tset color( color: DStateAwareOrValueMightBe<number | null> ) {\n\t\tthis._target.color = color;\n\t}\n\n\tgetAlpha( state: DBaseStateSet ): number {\n\t\tconst base = this._base;\n\t\tif( base != null ) {\n\t\t\treturn 1;\n\t\t}\n\t\treturn this._target.getAlpha( state );\n\t}\n\n\tget alpha(): DStateAwareOrValueMightBe<number> {\n\t\treturn this._target.alpha;\n\t}\n\n\tset alpha( alpha: DStateAwareOrValueMightBe<number> ) {\n\t\tthis._target.alpha = alpha;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { ObservablePoint } from \"pixi.js\";\nimport { DMapTileMappingPoint } from \"./d-map-tile-mapping\";\n\nexport class DDiagramCanvasTileMappingPointImpl extends ObservablePoint implements DMapTileMappingPoint {\n\tget lon(): number {\n\t\treturn this.x;\n\t}\n\n\tset lon( lon: number ) {\n\t\tthis.x = lon;\n\t}\n\n\tget lat(): number {\n\t\treturn this.y;\n\t}\n\n\tset lat( lat: number ) {\n\t\tthis.y = lat;\n\t}\n\n\ttoObject(): { lon: number, lat: number } {\n\t\treturn {\n\t\t\tlon: this.x,\n\t\t\tlat: this.y\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\nimport { DDiagramCanvasTileMappingPointImpl } from \"./d-diagram-canvas-mapping-point-impl\";\nimport { DMapTileMappingPoint } from \"./d-map-tile-mapping\";\n\nexport class DDiagramCanvasTileMappingImpl implements DDiagramCanvasTileMapping {\n\tprotected _enable: boolean;\n\tprotected _from: DDiagramCanvasTileMappingPointImpl;\n\tprotected _to: DDiagramCanvasTileMappingPointImpl;\n\tprotected _cb: () => void;\n\n\tconstructor( cb: () => void, mapping?: DDiagramCanvasTileMapping );\n\tconstructor( cb: () => void, enable: boolean, lon0: number, lat0: number, lon1: number, lat1: number );\n\tconstructor(\n\t\tcb: () => void,\n\t\tmappingOrEnable?: DDiagramCanvasTileMapping | boolean,\n\t\tlon0?: number,\n\t\tlat0?: number,\n\t\tlon1?: number,\n\t\tlat1?: number\n\t) {\n\t\tthis._cb = cb;\n\t\tif( mappingOrEnable === true || mappingOrEnable === false ) {\n\t\t\tthis._enable = mappingOrEnable;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, lon0, lat0 );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, lon1, lat1 );\n\t\t} else if( mappingOrEnable != null ) {\n\t\t\tthis._enable = mappingOrEnable.enable;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, mappingOrEnable.from.lon, mappingOrEnable.from.lat );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, mappingOrEnable.to.lon, mappingOrEnable.to.lat );\n\t\t} else {\n\t\t\tthis._enable = false;\n\t\t\tthis._from = new DDiagramCanvasTileMappingPointImpl( cb, null, -180, +85.05112877980659 );\n\t\t\tthis._to = new DDiagramCanvasTileMappingPointImpl( cb, null, +180, -85.05112877980659 );\n\t\t}\n\t}\n\n\tget enable(): boolean {\n\t\treturn this._enable;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tif( this._enable !== enable ) {\n\t\t\tthis._enable = enable;\n\t\t\tthis._cb();\n\t\t}\n\t}\n\n\tget from(): DMapTileMappingPoint {\n\t\treturn this._from;\n\t}\n\n\tget to(): DMapTileMappingPoint {\n\t\treturn this._to;\n\t}\n\n\tserialize(): DDiagramCanvasTileMapping {\n\t\treturn {\n\t\t\tenable: this._enable,\n\t\t\tfrom: this._from.toObject(),\n\t\t\tto: this._to.toObject()\n\t\t};\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\nimport { DDiagramCanvasTileMappingImpl } from \"./d-diagram-canvas-mapping-impl\";\nimport { DMapTilePyramid } from \"./d-map-tile-pyramid\";\n\n/**\n * A tile pyramid factory.\n */\nexport type DDiagramCanvasTilePyramidFactory = ( canvas: DDiagramCanvasBase<any, any> ) => DMapTilePyramid;\n\nexport interface DDiagramCanvasTileOptions {\n\tfactory?: DDiagramCanvasTilePyramidFactory;\n\tmapping?: DDiagramCanvasTileMapping;\n}\n\nexport class DDiagramCanvasTile {\n\tprotected _canvas: DDiagramCanvasBase<any, any>;\n\tprotected _pyramid?: DMapTilePyramid;\n\tprotected _factory?: DDiagramCanvasTilePyramidFactory;\n\tprotected _mapping: DDiagramCanvasTileMappingImpl;\n\n\tconstructor( canvas: DDiagramCanvasBase<any, any>, options?: DDiagramCanvasTileOptions ) {\n\t\tthis._canvas = canvas;\n\t\tthis._factory = options && options.factory;\n\t\tthis._mapping = new DDiagramCanvasTileMappingImpl((): void => {\n\t\t\tthis.onMappingChange();\n\t\t}, options && options.mapping );\n\t}\n\n\tinit(): void {\n\t\tthis.onMappingChange();\n\t}\n\n\tprotected onMappingChange(): void {\n\t\tconst factory = this._factory;\n\t\tif( factory ) {\n\t\t\tconst mapping = this._mapping;\n\t\t\tif( mapping.enable ) {\n\t\t\t\tconst pyramid = this._pyramid;\n\t\t\t\tif( pyramid ) {\n\t\t\t\t\tpyramid.mapping = mapping;\n\t\t\t\t} else {\n\t\t\t\t\tthis._pyramid = factory( this._canvas ).fit();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst pyramid = this._pyramid;\n\t\t\t\tif( pyramid ) {\n\t\t\t\t\tthis._pyramid = undefined;\n\t\t\t\t\tpyramid.destroy();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget pyramid(): DMapTilePyramid | undefined {\n\t\treturn this._pyramid;\n\t}\n\n\tget factory(): DDiagramCanvasTilePyramidFactory | undefined {\n\t\treturn this._factory;\n\t}\n\n\tget mapping(): DDiagramCanvasTileMapping {\n\t\treturn this._mapping;\n\t}\n\n\tserialize(): { mapping: DDiagramCanvasTileMapping } {\n\t\treturn {\n\t\t\tmapping: this._mapping.serialize()\n\t\t};\n\t}\n\n\tdestroy(): void {\n\t\tconst pyramid = this._pyramid;\n\t\tif( pyramid != null ) {\n\t\t\tthis._pyramid = undefined;\n\t\t\tpyramid.destroy();\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramSerializedItem, DDiagramSerializedLayer } from \"./d-diagram-serialized\";\nimport { EShapeContainer } from \"./shape/e-shape-container\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\n\nexport class DDiagramLayer extends EShapeContainer {\n\treference: number;\n\n\tconstructor( name: string ) {\n\t\tsuper();\n\t\tthis.name = name;\n\t\tthis.interactive = false;\n\t\tthis.reference = 0;\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tchildren[ i ].destroy();\n\t\t\t}\n\t\t\tchildren.length = 0;\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\tserialize(\n\t\tlayer: number, manager: EShapeResourceManagerSerialization, items: DDiagramSerializedItem[]\n\t): DDiagramSerializedLayer {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst shape = children[ i ];\n\t\t\tconst item = shape.serialize( manager );\n\t\t\titem[ 16 ] = layer;\n\t\t\titems.push( item );\n\t\t}\n\n\t\treturn [\n\t\t\tthis.name || \"\"\n\t\t];\n\t}\n\n\taddUuid( manager: EShapeResourceManagerSerialization ): void {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].addUuid( manager );\n\t\t}\n\t}\n\n\tupdateUuid( manager: EShapeResourceManagerSerialization ): void {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].updateUuid( manager );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramLayer } from \"./d-diagram-layer\";\nimport { DDiagramSerializedItem, DDiagramSerializedLayer } from \"./d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\n\nexport class DDiagramLayerContainer extends Container {\n\tpublic children!: DDiagramLayer[];\n\tprotected _active: DDiagramLayer | null;\n\n\tconstructor() {\n\t\tsuper();\n\t\tthis._active = null;\n\t\tthis.interactive = false;\n\t\tthis.interactiveChildren = false;\n\t}\n\n\tinit(): void {\n\t\tif( this._active == null ) {\n\t\t\tconst children = this.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tthis._active = children[ 0 ];\n\t\t\t}\n\t\t}\n\t}\n\n\tget active(): DDiagramLayer | null {\n\t\treturn this._active;\n\t}\n\n\tset active( layer: DDiagramLayer | null ) {\n\t\tif( this._active !== layer && (layer == null || 0 <= this.children.indexOf( layer )) ) {\n\t\t\tthis._active = layer;\n\t\t\tthis.emit( \"change\", this );\n\t\t}\n\t}\n\n\tcreate( name: string, activate?: boolean ): DDiagramLayer {\n\t\tconst result = new DDiagramLayer( name );\n\t\tthis.attach( result, activate );\n\t\treturn result;\n\t}\n\n\t/**\n\t * Adds the specified layer and activates it if the `activate` is true.\n\t *\n\t * @param layer\n\t * @param activate\n\t */\n\tattach( layer: DDiagramLayer, activate?: boolean ): void {\n\t\tthis.addChild( layer );\n\t\tif( activate === true ) {\n\t\t\tthis._active = layer;\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tDApplications.update( this );\n\t}\n\n\tattachAt( layer: DDiagramLayer, index: number, activate?: boolean ): void {\n\t\tthis.addChildAt( layer, index );\n\t\tif( activate === true ) {\n\t\t\tthis._active = layer;\n\t\t}\n\t\tthis.emit( \"change\", this );\n\t\tDApplications.update( this );\n\t}\n\n\t/**\n\t * Removes the specified layer from this container and activates the specified layer.\n\t * This method does not destroy the secified layer.\n\t *\n\t * @param layer\n\t */\n\tdetach( layer: DDiagramLayer, active: DDiagramLayer | null ): void {\n\t\tconst children = this.children;\n\t\tconst index = children.indexOf( layer );\n\t\tif( 0 <= index ) {\n\t\t\tthis._active = active;\n\n\t\t\tchildren.splice( index, 1 );\n\t\t\t(layer as any).parent = undefined;\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\t/**\n\t * Removes the specified layer and activate the next layer.\n\t * This method does not destroy the specified layer.\n\t *\n\t * @param layer\n\t * @param activateNext\n\t */\n\tdelete( layer: DDiagramLayer, activateNext?: boolean ): number {\n\t\tconst children = this.children;\n\t\tconst index = children.indexOf( layer );\n\t\tif( 0 <= index ) {\n\t\t\tchildren.splice( index, 1 );\n\t\t\t(layer as any).parent = undefined;\n\n\t\t\tif( this._active === layer ) {\n\t\t\t\tif( activateNext === true ) {\n\t\t\t\t\tif( index < children.length ) {\n\t\t\t\t\t\tthis._active = children[ index ];\n\t\t\t\t\t} else if( 0 < children.length ) {\n\t\t\t\t\t\tthis._active = children[ index - 1 ];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis._active = null;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis._active = null;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update( this );\n\t\t}\n\t\treturn index;\n\t}\n\n\tget( index: number ): DDiagramLayer | null {\n\t\tconst child = this.children[ index ];\n\t\tif( child != null ) {\n\t\t\treturn child;\n\t\t}\n\t\treturn null;\n\t}\n\n\tclear(): void {\n\t\tconst children = this.children;\n\t\tif( 0 < children.length ) {\n\t\t\tfor( let i = children.length - 1; 0 <= i; --i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\t(child as any).parent = null;\n\t\t\t\tchild.destroy();\n\t\t\t}\n\t\t\tchildren.length = 0;\n\n\t\t\tthis.emit( \"change\", this );\n\t\t\tDApplications.update( this );\n\t\t}\n\t}\n\n\tdestroy() {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis.clear();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this.children.length;\n\t}\n\n\tserialize(\n\t\tmanager: EShapeResourceManagerSerialization, items: DDiagramSerializedItem[]\n\t): DDiagramSerializedLayer[] {\n\t\tconst result: DDiagramSerializedLayer[] = [];\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].addUuid( manager );\n\t\t}\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tchildren[ i ].updateUuid( manager );\n\t\t}\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tresult.push( children[ i ].serialize( i, manager, items ) );\n\t\t}\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { IPoint } from \"pixi.js\";\nimport { DBaseBackgroundOptions } from \"./d-base\";\nimport { DCanvas, DCanvasOptions, DThemeCanvas } from \"./d-canvas\";\nimport { DDiagramCanvasEditorBackground } from \"./d-diagram-canvas-editor-background\";\nimport { DDiagramCanvasTile, DDiagramCanvasTileOptions } from \"./d-diagram-canvas-tile\";\nimport { DDiagramLayerContainer } from \"./d-diagram-layer-container\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport interface DDiagramCanvasBackgroundOptions extends DBaseBackgroundOptions {\n\tambient?: boolean;\n\tbase?: number | null;\n}\n\nexport interface DDiagramCanvasBaseOptions<\n\tTHEME extends DThemeDiagramCanvasBase = DThemeDiagramCanvasBase\n> extends DCanvasOptions<THEME> {\n\ttile?: DDiagramCanvasTileOptions;\n\tbackground?: DDiagramCanvasBackgroundOptions;\n}\n\nexport interface DThemeDiagramCanvasBase extends DThemeCanvas {\n\tgetBackgroundAmbient(): boolean;\n\tgetBackgroundBase(): number | null;\n}\n\nexport class DDiagramCanvasBase<\n\tTHEME extends DThemeDiagramCanvasBase = DThemeDiagramCanvasBase,\n\tOPTIONS extends DDiagramCanvasBaseOptions<THEME> = DDiagramCanvasBaseOptions<THEME>\n> extends DCanvas<THEME, OPTIONS> {\n\tprotected _layer: DDiagramLayerContainer;\n\tprotected _tile: DDiagramCanvasTile;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\t// Background\n\t\tif( ! this.toBackgroundAmbient( this.theme, options ) ) {\n\t\t\tthis._background = new DDiagramCanvasEditorBackground(\n\t\t\t\tthis._background,\n\t\t\t\tthis.toBackgroundColorBase( this.theme, options )\n\t\t\t);\n\t\t}\n\n\t\t// Layer\n\t\tconst layer = new DDiagramLayerContainer();\n\t\tthis._layer = layer;\n\t\tthis.addChild( layer );\n\n\t\t// Tile\n\t\tconst tile = this._tile = new DDiagramCanvasTile( this, options && options.tile );\n\t\ttile.init();\n\t}\n\n\tprotected toBackgroundAmbient( theme: THEME, options?: OPTIONS ): boolean {\n\t\tconst background = options && options.background;\n\t\tconst ambient = background && background.ambient;\n\t\treturn ( ambient != null ? ambient : theme.getBackgroundAmbient() );\n\t}\n\n\tprotected toBackgroundColorBase( theme: THEME, options?: OPTIONS ): number | null {\n\t\tconst background = options && options.background;\n\t\tconst backgroundBase = background && background.base;\n\t\treturn ( backgroundBase != null ? backgroundBase : theme.getBackgroundBase() );\n\t}\n\n\tget tile(): DDiagramCanvasTile {\n\t\treturn this._tile;\n\t}\n\n\tget layer(): DDiagramLayerContainer {\n\t\treturn this._layer;\n\t}\n\n\tinitialize( shapes: EShape[] ): void {\n\t\t// DO NOTHING\n\t}\n\n\tdestroy(): void {\n\t\tif( ! this._destroyed ) {\n\t\t\tthis._tile.destroy();\n\t\t\tthis._layer.destroy();\n\t\t\tsuper.destroy();\n\t\t}\n\t}\n\n\thitTest( global: IPoint, handler?: ( shape: EShape ) => boolean ): EShape | null {\n\t\tconst layers = this._layer.children;\n\t\tfor( let i = layers.length - 1; 0 <= i; --i ) {\n\t\t\tconst layer = layers[ i ];\n\t\t\tconst shape = layer.hitTest( global, handler );\n\t\t\tif( shape != null ) {\n\t\t\t\treturn shape;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvasBase\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Graphics } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramCanvasBase, DDiagramCanvasBaseOptions, DThemeDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramSerialized, DDiagramSerializedItem, DDiagramSerializedVersion } from \"./d-diagram-serialized\";\nimport { EShapeResourceManagerSerialization } from \"./shape/e-shape-resource-manager-serialization\";\nimport { ESnapper } from \"./snapper/e-snapper\";\nimport { ESnapperTargetValueType } from \"./snapper/e-snapper-target-value\";\nimport { isNumber } from \"./util/is-number\";\n\nexport interface DDiagramCanvasEditorOptions<\n\tTHEME extends DThemeDiagramCanvasEditor = DThemeDiagramCanvasEditor\n> extends DDiagramCanvasBaseOptions<THEME> {\n\tsnapper?: ESnapper;\n}\n\nexport interface DThemeDiagramCanvasEditor extends DThemeDiagramCanvasBase {\n\n}\n\nexport interface DDiagramCanvasEditorThumbnail {\n\tserialize(): string | undefined;\n}\n\nexport class DDiagramCanvasEditor<\n\tTHEME extends DThemeDiagramCanvasEditor = DThemeDiagramCanvasEditor,\n\tOPTIONS extends DDiagramCanvasEditorOptions<THEME> = DDiagramCanvasEditorOptions<THEME>\n> extends DDiagramCanvasBase<THEME, OPTIONS> {\n\tprotected _snapper?: ESnapper;\n\tprotected _snapperGraphics?: Graphics;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst snapper = options.snapper;\n\t\tthis._snapper = snapper;\n\t\tif( snapper ) {\n\t\t\tconst snapperGraphics = new Graphics();\n\t\t\tsnapperGraphics.visible = false;\n\t\t\tthis.addChildAt( snapperGraphics, this.children.length - 1 );\n\t\t\tthis._snapperGraphics = snapperGraphics;\n\n\t\t\tsnapper.target.on( \"change\", (): void => {\n\t\t\t\tthis.toDirty();\n\t\t\t\tDApplications.update( this );\n\t\t\t});\n\t\t}\n\t}\n\n\tserialize( id?: number, thumbnail?: DDiagramCanvasEditorThumbnail ): DDiagramSerialized {\n\t\tconst manager = new EShapeResourceManagerSerialization();\n\t\tconst items: DDiagramSerializedItem[] = [];\n\t\tconst background = this._background;\n\t\tconst backgroundColor = background.color;\n\t\tconst backgroundAlpha = background.alpha;\n\t\treturn {\n\t\t\tversion: DDiagramSerializedVersion,\n\t\t\tid,\n\t\t\tname: this.name,\n\t\t\twidth: this.width,\n\t\t\theight: this.height,\n\t\t\tbackground: {\n\t\t\t\tcolor: isNumber( backgroundColor ) ? backgroundColor : 0xffffff,\n\t\t\t\talpha: isNumber( backgroundAlpha ) ? backgroundAlpha : 0\n\t\t\t},\n\t\t\ttile: this._tile.serialize(),\n\t\t\tresources: manager.resources,\n\t\t\ttags: manager.tags,\n\t\t\tpieces: manager.pieces,\n\t\t\tlayers: this._layer.serialize( manager, items ),\n\t\t\titems,\n\t\t\tsnap: this._snapper?.serialize(),\n\t\t\tthumbnail: thumbnail?.serialize()\n\t\t};\n\t}\n\n\tonReflow(): void {\n\t\tsuper.onReflow();\n\n\t\tconst snapper = this._snapper;\n\t\tconst snapperGraphics = this._snapperGraphics;\n\t\tif( snapper && snapperGraphics ) {\n\t\t\tconst target = snapper.target;\n\t\t\tif( target.visible ) {\n\t\t\t\tconst borderColor = 0x1e87f0;\n\t\t\t\tconst borderWidth = 1;\n\t\t\t\tconst borderAlpha = 0.5;\n\t\t\t\tconst width = this.width + 0.5;\n\t\t\t\tconst height = this.height + 0.5;\n\t\t\t\tconst values = target.values;\n\t\t\t\tsnapperGraphics.clear();\n\t\t\t\tsnapperGraphics.lineStyle( 0, 0, 0, 0 );\n\t\t\t\tsnapperGraphics.beginFill( borderColor, borderAlpha );\n\t\t\t\tfor( let i = 0, imax = values.length; i < imax; ++i ) {\n\t\t\t\t\tconst value = values[ i ];\n\t\t\t\t\tif( value.type === ESnapperTargetValueType.VERTICAL ) {\n\t\t\t\t\t\tsnapperGraphics.drawRect( value.position, 0, borderWidth, height );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsnapperGraphics.drawRect( 0, value.position, width, borderWidth );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tsnapperGraphics.endFill();\n\t\t\t\tsnapperGraphics.visible = true;\n\t\t\t} else {\n\t\t\t\tsnapperGraphics.visible = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvasEditor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasTileMapping } from \"./d-diagram-canvas-mapping\";\nimport { EShapeCorner } from \"./shape/e-shape-corner\";\nimport { EShapeStrokeSide } from \"./shape/e-shape-stroke-side\";\nimport { EShapeTagValueOrder } from \"./shape/e-shape-tag-value\";\nimport { EShapeTextStyle, EShapeTextWeight } from \"./shape/e-shape-text\";\nimport { EShapeTextAlignHorizontal } from \"./shape/e-shape-text-align-horizontal\";\nimport { EShapeTextAlignVertical } from \"./shape/e-shape-text-align-vertical\";\nimport { EShapeTextDirection } from \"./shape/e-shape-text-direction\";\nimport { EShapeType } from \"./shape/e-shape-type\";\n\nexport const DDiagramSerializedVersion: number = 1;\n\n/**\n * A serialized tag range.\n */\nexport interface DDiagramSerializedTagRange {\n\t/** A type. */\n\t[ 0 ]: number;\n\n\t/** A lower bound. */\n\t[ 1 ]: number;\n\n\t/** An upper bound. */\n\t[ 2 ]: number;\n}\n\n/**\n * A serialized tag value.\n */\nexport interface DDiagramSerializedTagValue {\n\t/**\n\t * A resource index number of an ID.\n\t * Stored at DDiagramSerialized#resources.\n\t */\n\t[ 0 ]: number;\n\n\t/**\n\t * A resource index number of an initial value expression.\n\t * Stored at DDiagramSerialized#resources.\n\t */\n\t[ 1 ]: number;\n\n\t/**\n\t * A resource index number of a format expression.\n\t * Stored at DDiagramSerialized#resources.\n\t */\n\t[ 2 ]: number;\n\n\t/**\n\t * A resource index number of a serialized range, JSON.stringify(DDiagramSerializedTagRange).\n\t * Stored at DDiagramSerialized#resources.\n\t */\n\t[ 3 ]: number;\n\n\t/**\n\t * A capacity.\n\t */\n\t[ 4 ]: number;\n\n\t/**\n\t * A order.\n\t */\n\t[ 5 ]: EShapeTagValueOrder;\n}\n\n/**\n * A serialized fill.\n */\nexport interface DDiagramSerializedFill {\n\t/** 0: Enabled, 1: Disabled */\n\t[ 0 ]: number;\n\n\t/** A color. */\n\t[ 1 ]: number;\n\n\t/** An alpha. */\n\t[ 2 ]: number;\n}\n\n/**\n * A serialized stroke.\n */\nexport interface DDiagramSerializedStroke {\n\t/** 0: Enabled, 1: Disabled */\n\t[ 0 ]: number;\n\n\t/** A color. */\n\t[ 1 ]: number;\n\n\t/** An alpha. */\n\t[ 2 ]: number;\n\n\t/** A width. */\n\t[ 3 ]: number;\n\n\t/** An align. */\n\t[ 4 ]: number;\n\n\t/** A side. */\n\t[ 5 ]: EShapeStrokeSide;\n}\n\n/**\n * A serialized text outline.\n */\nexport interface DDiagramSerializedTextOutline {\n\t/** 0: Enabled, 1: Diabled */\n\t[ 0 ]: number;\n\n\t/** A color. */\n\t[ 1 ]: number;\n\n\t/** An alpha. */\n\t[ 2 ]: number;\n\n\t/** A width. */\n\t[ 3 ]: number;\n}\n\n/**\n * A serialized text align.\n */\nexport interface DDiagramSerializedTextAlign {\n\t/** A horizontal align. */\n\t[ 0 ]: EShapeTextAlignHorizontal;\n\n\t/** A vertical align. */\n\t[ 1 ]: EShapeTextAlignVertical;\n}\n\n/**\n * A serialized text offset.\n */\nexport interface DDiagramSerializedTextOffset {\n\t/** A horizontal offset. */\n\t[ 0 ]: number;\n\n\t/** A vertical offset. */\n\t[ 1 ]: number;\n}\n\n/**\n * A serialized text spacing.\n */\nexport interface DDiagramSerializedTextSpacing {\n\t/** A horizontal spacing. */\n\t[ 0 ]: number;\n\n\t/** A vertical spacing. */\n\t[ 1 ]: number;\n}\n\n/**\n * A serialized text padding.\n */\nexport interface DDiagramSerializedTextPadding {\n\t/** A horizontal padding. */\n\t[ 0 ]: number;\n\n\t/** A vertical padding. */\n\t[ 1 ]: number;\n}\n\n/**\n * A serialized text.\n */\nexport interface DDiagramSerializedText {\n\t/** A resource index number of a value. */\n\t[ 0 ]: number;\n\n\t/** A color. */\n\t[ 1 ]: number;\n\n\t/** An alpha. */\n\t[ 2 ]: number;\n\n\t/** A resource index number of a font family. */\n\t[ 3 ]: number;\n\n\t/** A size. */\n\t[ 4 ]: number;\n\n\t/** A weight. */\n\t[ 5 ]: EShapeTextWeight;\n\n\t/**\n\t * A resource index number of a stringified serialized align,\n\t * JSON.stringify(DDiagramSerializedTextAlign).\n\t */\n\t[ 6 ]: number;\n\n\t/**\n\t * A resource index number of a stringified serialized offset,\n\t * JSON.stringify(DDiagramSerializedTextOffset).\n\t */\n\t[ 7 ]: number;\n\n\t/** A style. */\n\t[ 8 ]: EShapeTextStyle;\n\n\t/**\n\t * A resource index number of a stringified serialized outline,\n\t * JSON.stringify(DDiagramSerializedTextOutline).\n\t */\n\t[ 9 ]: number;\n\n\t/**\n\t * A resource index number of a stringified serialized spacing,\n\t * JSON.stringify(DDiagramSerializedTextSpacing).\n\t */\n\t[ 10 ]: number;\n\n\t/** A direction. */\n\t[ 11 ]: EShapeTextDirection;\n\n\t/**\n\t * A resource index number of a stringified serialized padding,\n\t * JSON.stringify(DDiagramSerializedTextPadding).\n\t */\n\t[ 12 ]: number;\n\n\t/** A clipping. (0: Off, 1: On) */\n\t[ 13 ]: number;\n}\n\n/**\n * A serialized item.\n */\nexport interface DDiagramSerializedItem {\n\t/** A type. */\n\t[ 0 ]: EShapeType;\n\n\t/** A resource index number of a ID. */\n\t[ 1 ]: number;\n\n\t/** A X-coordinate position. */\n\t[ 2 ]: number;\n\n\t/** A Y-coordinate position. */\n\t[ 3 ]: number;\n\n\t/** A width. */\n\t[ 4 ]: number;\n\n\t/** A height. */\n\t[ 5 ]: number;\n\n\t/** A rotation. */\n\t[ 6 ]: number;\n\n\t/** A skew. */\n\t[ 7 ]: number;\n\n\t/**\n\t * A resource index number of a stringified serialized fill,\n\t * JSON.stringify(DDiagramSerializedFill).\n\t */\n\t[ 8 ]: number;\n\n\t/**\n\t * A resource index number of a stringified serialized stroke,\n\t * JSON.stringify(DDiagramSerializedStroke).\n\t */\n\t[ 9 ]: number;\n\n\t/** A resource index number of a cursor. */\n\t[ 10 ]: number;\n\n\t/**\n\t * A resource index number of a stringified serialized text,\n\t * JSON.stringify(DDiagramSerializedText).\n\t */\n\t[ 11 ]: number;\n\n\t/**\n\t * A resource index number of stringified serialized tags,\n\t * JSON.stringify(DDiagramSerializedTagValue[]).\n\t */\n\t[ 12 ]: number;\n\n\t/** A radius. */\n\t[ 13 ]: number;\n\n\t/** A corner. */\n\t[ 14 ]: EShapeCorner;\n\n\t/** A resource index number of a shape-specific resource. */\n\t[ 15 ]: number;\n\n\t/** A layer index number. */\n\t[ 16 ]: number;\n\n\t/** Actions */\n\t[ 17 ]: number[];\n\n\t/** A resource index number of an image. */\n\t[ 18 ]: number;\n\n\t/**\n\t * A resource index number of a stringified serialized gradient.\n\t * A stringified serialized gradient is a stringified number array,\n\t * JSON.stringify(number[]).\n\t *\n\t * * The first number in the array is a direction in degree.\n\t * * The number at an index number 1 + 3 * n + 0 is a color of a n-th point.\n\t * * The number at an index number 1 + 3 * n + 1 is a alpha of a n-th point.\n\t * * The number at an index number 1 + 3 * n + 2 is a position of a n-th point whose range is [0, 1].\n\t */\n\t[ 19 ]: number;\n\n\t/** A children. */\n\t[ 20 ]: DDiagramSerializedItem[];\n\n\t/** A X pivot. */\n\t[ 21 ]: number;\n\n\t/** A Y pivot. */\n\t[ 22 ]: number;\n\n\t/** (interactive ? 1 : 0) | (unfocusable ? 2 : 0) */\n\t[ 23 ]: number;\n\n\t/** A resource index number of a shortcut. */\n\t[ 24 ]: number;\n\n\t/** A resource index number of a title. */\n\t[ 25 ]: number;\n\n\t/** UUID */\n\t[ 26 ]: number;\n}\n\n/**\n * A serialized layer.\n */\nexport interface DDiagramSerializedLayer {\n\t/** A name. */\n\t[ 0 ]: string;\n}\n\n/**\n * A serialized snap target.\n */\nexport interface DDiagramSerializedSnapTargetValue {\n\t/** A type (0: Horizontal, 1: Vertical). */\n\t[ 0 ]: number;\n\n\t/** A position. */\n\t[ 1 ]: number;\n}\n\n/**\n * Serialized snap on guide settings.\n */\nexport interface DDiagramSerializedSnapTarget {\n\t/** Snap on guide (0: Off, 1: On) */\n\t[ 0 ]: number;\n\n\t/** A visibility (0: Invisible, 1: Visible). */\n\t[ 1 ]: number;\n\n\t/** Snap targets. */\n\t[ 2 ]: DDiagramSerializedSnapTargetValue[];\n}\n\n/**\n * Serialized grid snap settings.\n */\nexport interface DDiagramSerializedSnapGrid {\n\t/** Snap on grid (0: Off, 1: On) */\n\t[ 0 ]: number;\n\n\t/** A grid size. */\n\t[ 1 ]: number;\n}\n\n/**\n * Serialized snap settings.\n */\nexport interface DDiagramSerializedSnap {\n\t/** Snap (0: Off, 1: On). */\n\t[ 0 ]: number;\n\n\t/** Snap on targets */\n\t[ 1 ]: DDiagramSerializedSnapTarget;\n\n\t/** Snap on grid */\n\t[ 2 ]: DDiagramSerializedSnapGrid;\n}\n\n/**\n * Serialized background settings.\n */\nexport interface DDiagramSerializedBackground {\n\tcolor?: number | null;\n\talpha?: number;\n}\n\n/**\n * Serialized tile settings.\n */\nexport interface DDiagramSerializedTile {\n\tmapping?: DDiagramCanvasTileMapping;\n}\n\n/**\n * A serialized diagram.\n */\nexport interface DDiagramSerialized  {\n\tversion: number;\n\tid?: number;\n\tname: string;\n\twidth: number;\n\theight: number;\n\tbackground?: DDiagramSerializedBackground;\n\ttile?: DDiagramSerializedTile;\n\tresources: string[];\n\ttags?: string[];\n\tpieces?: string[];\n\tlayers: DDiagramSerializedLayer[];\n\titems: DDiagramSerializedItem[];\n\tsnap?: DDiagramSerializedSnap;\n\tthumbnail?: string;\n}\n\n/**\n * A simplified version of a serialized diagram.\n */\nexport interface DDiagramSerializedSimple {\n\tversion: number;\n\tid: number | undefined;\n\tname: string;\n\n\t/**\n\t * Stringified tags, JSON.stringify(DDiagramSerialized#tags).\n\t */\n\ttags?: string;\n\n\t/**\n\t * Stringified piece names, JSON.stringify(DDiagramSerialized#pieces).\n\t */\n\tpieces?: string;\n\n\t/**\n\t * Thumbnail data URL.\n\t */\n\tthumbnail?: string;\n\n\t/**\n\t * A stringified DDiagramSerialized.\n\t * Please note that the following properties are not included:\n\t *\n\t * * DDiagramSerialized#version\n\t * * DDiagramSerialized#id\n\t * * DDiagramSerialized#name\n\t * * DDiagramSerialized#tags\n\t * * DDiagramSerialized#pieces\n\t */\n\tdata: string;\n}\n\nexport interface DDiagramSerializedName {\n\tid: number;\n\tname: string;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramCanvasBase, DDiagramCanvasBaseOptions, DThemeDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasIdMap } from \"./d-diagram-canvas-id-map\";\nimport { DDiagramCanvasTagMap } from \"./d-diagram-canvas-tag-map\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeBase } from \"./shape/variant/e-shape-base\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DDiagramCanvasOptions<\n\tTHEME extends DThemeDiagramCanvas = DThemeDiagramCanvas\n> extends DDiagramCanvasBaseOptions<THEME> {\n\n}\n\nexport interface DThemeDiagramCanvas extends DThemeDiagramCanvasBase {\n\n}\n\nexport class DDiagramCanvas<\n\tTHEME extends DThemeDiagramCanvas = DThemeDiagramCanvas,\n\tOPTIONS extends DDiagramCanvasOptions<THEME> = DDiagramCanvasOptions<THEME>\n> extends DDiagramCanvasBase<THEME, OPTIONS> {\n\ttags: DDiagramCanvasTagMap;\n\tinteractives: EShape[];\n\tactionables: EShape[];\n\tids: DDiagramCanvasIdMap;\n\n\tprotected _workLocal: Point;\n\tprotected _workGlobal: Point;\n\tprotected _lastOverShape: EShape | null;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.tags = {};\n\t\tthis.interactives = [];\n\t\tthis.actionables = [];\n\t\tthis.ids = {};\n\t\tthis._workLocal = new Point();\n\t\tthis._workGlobal = new Point();\n\t\tthis._lastOverShape = null;\n\t}\n\n\tinitialize(): void {\n\t\tconst time = Date.now();\n\t\tconst tags = this.tags;\n\t\tconst interactives = this.interactives;\n\t\tconst actionables = this.actionables;\n\t\tconst ids = this.ids;\n\t\tconst layers = this._layer.children;\n\n\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\tthis.initializeShapes(\n\t\t\t\tlayers[ i ].children,\n\t\t\t\ttags,\n\t\t\t\tinteractives,\n\t\t\t\tactionables,\n\t\t\t\tids\n\t\t\t);\n\t\t}\n\n\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\tthis.updateShapes( layers[ i ].children, time );\n\t\t}\n\n\t\tthis.initializeFocus();\n\t}\n\n\tprotected initializeFocus(): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst focusController = layer.getFocusController();\n\t\t\tconst focusable = focusController.find( this, false, true, true );\n\t\t\tif( focusable ) {\n\t\t\t\tfocusController.focus( focusable );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected initializeShapes(\n\t\tshapes: EShape[],\n\t\ttags: DDiagramCanvasTagMap,\n\t\tinteractives: EShape[],\n\t\tactionables: EShape[],\n\t\tids: DDiagramCanvasIdMap\n\t): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\n\t\t\t// Tag mappings\n\t\t\tconst tag = shape.tag;\n\t\t\tfor( let j = 0, jmax = tag.size(); j < jmax; ++j ) {\n\t\t\t\tconst value = tag.get( j );\n\t\t\t\tif( value ) {\n\t\t\t\t\tconst valueId = value.id;\n\t\t\t\t\tif( 0 < valueId.length ) {\n\t\t\t\t\t\tlet values = tags[ valueId ];\n\t\t\t\t\t\tif( values == null ) {\n\t\t\t\t\t\t\tvalues = [];\n\t\t\t\t\t\t\ttags[ valueId ] = values;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvalues.push( value );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Id mappings\n\t\t\tconst shapeId = shape.id;\n\t\t\tif( 0 < shapeId.length ) {\n\t\t\t\tconst mapping: EShape[] | undefined = ids[ shapeId ];\n\t\t\t\tif( mapping == null ) {\n\t\t\t\t\tids[ shapeId ] = [ shape ];\n\t\t\t\t} else {\n\t\t\t\t\tmapping.push( shape );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Interactives\n\t\t\tconst runtime = shape.runtime;\n\t\t\tif( shape.interactive || (0 < shape.cursor.length) || (runtime && runtime.interactive) ) {\n\t\t\t\tinteractives.push( shape );\n\t\t\t}\n\n\t\t\t// Actionables\n\t\t\tif( runtime && 0 < runtime.actions.length ) {\n\t\t\t\tactionables.push( shape );\n\t\t\t}\n\n\t\t\t// Shortcuts\n\t\t\tconst shortcut = shape.shortcut;\n\t\t\tif( runtime && shortcut != null ) {\n\t\t\t\tUtilKeyboardEvent.on( this, shortcut, ( e: KeyboardEvent ): void => {\n\t\t\t\t\truntime.onClick( shape, e );\n\t\t\t\t});\n\t\t\t}\n\n\t\t\t// Children\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tthis.initializeShapes(\n\t\t\t\t\tchildren,\n\t\t\t\t\ttags,\n\t\t\t\t\tinteractives,\n\t\t\t\t\tactionables,\n\t\t\t\t\tids\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected updateShapes( shapes: EShape[], time: number ): void {\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tshapes[ i ].update( time );\n\t\t}\n\t}\n\n\tonShapeMove( e: interaction.InteractionEvent ): boolean {\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tconst interactives = this.interactives;\n\t\tlet found: EShape | null = null;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tfound = interactive;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( found ) {\n\t\t\tif( layer ) {\n\t\t\t\tlet cursor = found.cursor;\n\t\t\t\tif( cursor.length <= 0 ) {\n\t\t\t\t\tcursor = \"auto\";\n\t\t\t\t}\n\t\t\t\tconst style = layer.view.style;\n\t\t\t\tif( style.cursor !== cursor ) {\n\t\t\t\t\tstyle.cursor = cursor;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst lastOverShape = this._lastOverShape;\n\t\t\tif( found === lastOverShape ) {\n\t\t\t\tconst runtime = lastOverShape.runtime;\n\t\t\t\tif( runtime ) {\n\t\t\t\t\truntime.onMove( lastOverShape, e );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis._lastOverShape = found;\n\n\t\t\t\t// Previous\n\t\t\t\tif( lastOverShape ) {\n\t\t\t\t\tconst previousRuntime = lastOverShape.runtime;\n\t\t\t\t\tif( previousRuntime ) {\n\t\t\t\t\t\tpreviousRuntime.onOut( lastOverShape, e );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Parents\n\t\t\t\t\tlet lastOverParent = lastOverShape.parent;\n\t\t\t\t\twhile( (lastOverParent instanceof EShapeBase) && lastOverParent !== found ) {\n\t\t\t\t\t\tconst parentRuntime = lastOverShape.runtime;\n\t\t\t\t\t\tif( parentRuntime ) {\n\t\t\t\t\t\t\tparentRuntime.onOut( lastOverParent, e );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tlastOverParent = lastOverParent.parent;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Next\n\t\t\t\tconst runtime = found.runtime;\n\t\t\t\tif( runtime ) {\n\t\t\t\t\truntime.onOver( found, e );\n\t\t\t\t}\n\t\t\t\tif( layer ) {\n\t\t\t\t\tlayer.view.title = ( found.title || \"\" );\n\t\t\t\t}\n\n\t\t\t\t// Parents\n\t\t\t\tlet parent = found.parent;\n\t\t\t\twhile( parent instanceof EShapeBase ) {\n\t\t\t\t\tconst parentRuntime = parent.runtime;\n\t\t\t\t\tif( parentRuntime ) {\n\t\t\t\t\t\tparentRuntime.onOver( parent, e );\n\t\t\t\t\t}\n\t\t\t\t\tparent = parent.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn true;\n\t\t} else {\n\t\t\tif( layer ) {\n\t\t\t\tconst style = layer.view.style;\n\t\t\t\tif( style.cursor !== \"auto\" ) {\n\t\t\t\t\tstyle.cursor = \"auto\";\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Previous\n\t\t\tconst lastOverShape = this._lastOverShape;\n\t\t\tthis._lastOverShape = null;\n\t\t\tif( lastOverShape ) {\n\t\t\t\tconst runtime = lastOverShape.runtime;\n\t\t\t\tif( runtime ) {\n\t\t\t\t\truntime.onOut( lastOverShape, e );\n\t\t\t\t}\n\n\t\t\t\t// Parents\n\t\t\t\tlet lastOverParent = lastOverShape.parent;\n\t\t\t\twhile( lastOverParent instanceof EShapeBase ) {\n\t\t\t\t\tconst parentRuntime = lastOverParent.runtime;\n\t\t\t\t\tif( parentRuntime ) {\n\t\t\t\t\t\tparentRuntime.onOut( lastOverParent, e );\n\t\t\t\t\t}\n\t\t\t\t\tlastOverParent = lastOverParent.parent;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t//\n\t\t\tif( layer ) {\n\t\t\t\tlayer.view.title = \"\";\n\t\t\t}\n\n\t\t\treturn false;\n\t\t}\n\t}\n\n\tonShapeDown( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tconst runtime = interactive.runtime;\n\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\truntime.onDown( interactive, e );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeUp( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tconst runtime = interactive.runtime;\n\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\truntime.onUp( interactive, e );\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeClick( e: interaction.InteractionEvent ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = e.data.global;\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tlet target: EShape = interactive;\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tconst runtime = target.runtime;\n\t\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\t\truntime.onClick( target, e );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst parent = target.parent;\n\t\t\t\t\t\tif( parent instanceof EShapeBase ) {\n\t\t\t\t\t\t\ttarget = parent;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonShapeDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst interactives = this.interactives;\n\t\tconst global = UtilPointerEvent.toGlobal( e, interactionManager, this._workGlobal );\n\t\tconst local = this._workLocal;\n\t\tfor( let i = interactives.length - 1; 0 <= i; --i ) {\n\t\t\tconst interactive = interactives[ i ];\n\t\t\tif( interactive.visible ) {\n\t\t\t\tinteractive.toLocal( global, undefined, local );\n\t\t\t\tif( interactive.contains( local ) ) {\n\t\t\t\t\tlet target: EShape = interactive;\n\t\t\t\t\twhile( true ) {\n\t\t\t\t\t\tconst runtime = target.runtime;\n\t\t\t\t\t\tif( runtime ) {\n\t\t\t\t\t\t\truntime.onDblClick( target, e, interactionManager );\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconst parent = target.parent;\n\t\t\t\t\t\tif( parent instanceof EShapeBase ) {\n\t\t\t\t\t\t\ttarget = parent;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramCanvas\";\n\t}\n}\n","import { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DView } from \"./d-view\";\nimport { UtilExtract } from \"./util/util-extract\";\n\nexport interface DDiagramSnapshotParent<CANVAS> {\n\tcanvas: CANVAS | null;\n\tview: DView;\n}\n\nexport class DDiagramSnapshot<\n\tCANVAS extends DBase = DBase,\n> {\n\tprotected _parent: DDiagramSnapshotParent<CANVAS>;\n\n\tconstructor( parent: DDiagramSnapshotParent<CANVAS> ) {\n\t\tthis._parent = parent;\n\t}\n\n\tcreateAsUrl( size: number ): string | undefined {\n\t\treturn this.create( size, ( canvas ) => {\n\t\t\treturn UtilExtract.base64({ target: canvas });\n\t\t});\n\t}\n\n\tcreateAsFile( size: number, filename: string ): void {\n\t\tthis.create( size, ( canvas ) => {\n\t\t\treturn UtilExtract.file({ target: canvas, filename: filename! })\n\t\t});\n\t}\n\n\tcreate<DATA>( size: number, extractor: ( canvas: CANVAS ) => DATA ): DATA | undefined {\n\t\tconst parent = this._parent;\n\t\tconst canvas = parent.canvas;\n\t\tif( canvas ) {\n\t\t\tconst view = parent.view;\n\t\t\tconst viewPosition = view.position;\n\t\t\tconst viewScale = view.scale;\n\n\t\t\tconst oldPositionX = viewPosition.x;\n\t\t\tconst oldPositionY = viewPosition.y;\n\t\t\tconst oldScaleX = viewScale.x;\n\t\t\tconst oldScaleY = viewScale.y;\n\n\t\t\tconst newScale = size / DApplications.getResolution( canvas ) / Math.max( canvas.width, canvas.height );\n\n\t\t\tview.transform( 0, 0, newScale, newScale, 0 );\n\t\t\tconst result = extractor( canvas );\n\t\t\tview.transform( oldPositionX, oldPositionY, oldScaleX, oldScaleY, 0 );\n\t\t\treturn result;\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DApplications } from \"./d-applications\";\nimport { DBaseBackgroundOptions } from \"./d-base\";\nimport {\n\tDCanvasContainer, DCanvasContainerEvents, DCanvasContainerOptions, DThemeCanvasContainer\n} from \"./d-canvas-container\";\nimport { DDiagramCanvasBase, DDiagramCanvasBaseOptions } from \"./d-diagram-canvas-base\";\nimport { DDiagramCanvasTilePyramidFactory } from \"./d-diagram-canvas-tile\";\nimport { DDiagramLayer } from \"./d-diagram-layer\";\nimport { DDiagramSerialized, DDiagramSerializedSimple } from \"./d-diagram-serialized\";\nimport { DDiagramSnapshot } from \"./d-diagram-snapshot\";\nimport { DDiagrams } from \"./d-diagrams\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeResourceManagerDeserialization } from \"./shape/e-shape-resource-manager-deserialization\";\nimport { EShapeEmbeddedDatum } from \"./shape/variant/e-shape-embedded-datum\";\n\n/**\n * {@link DDiagramBase} events.\n */\nexport interface DDiagramBaseEvents<CANVAS, EMITTER> extends DCanvasContainerEvents<CANVAS, EMITTER> {\n\t/**\n\t * Triggered when all the shape initializations are finished.\n\t *\n\t * @param emitter an emitter\n\t */\n\tready( emitter: EMITTER ): void;\n}\n\n/**\n * {@link DDiagram} piece controller.\n */\nexport interface DDiagramBasePieceController {\n\tgetByName( name: string ): Promise<DDiagramSerializedSimple | DDiagramSerialized>;\n}\n\n/**\n * {@link DDiagram} controller.\n */\nexport interface DDiagramBaseController {\n\tpiece: DDiagramBasePieceController;\n\tgetByName( name: string ): Promise<DDiagramSerializedSimple | DDiagramSerialized>;\n}\n\n/**\n * {@link DDiagramBase} \"on\" options.\n */\nexport interface DDiagramBaseOnOptions<CANVAS, EMITTER> extends Partial<DDiagramBaseEvents<CANVAS, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\nexport interface DDiagramBaseBackgroundOptions extends DBaseBackgroundOptions {\n\tambient?: boolean;\n}\n\n/**\n * {@link DDiagramBase} options.\n */\nexport interface DDiagramBaseOptions<\n\tCANVAS extends DDiagramCanvasBase = DDiagramCanvasBase,\n\tCANVAS_OPTIONS extends DDiagramCanvasBaseOptions = DDiagramCanvasBaseOptions,\n\tCONTROLLER extends DDiagramBaseController = DDiagramBaseController,\n\tTHEME extends DThemeDiagramBase = DThemeDiagramBase,\n\tEMITTER = any\n> extends DCanvasContainerOptions<CANVAS, CANVAS_OPTIONS, THEME> {\n\tcontroller?: CONTROLLER;\n\n\t/**\n\t * A tile pyramid factory.\n\t */\n\ttile?: DDiagramCanvasTilePyramidFactory;\n\n\tbackground?: DDiagramBaseBackgroundOptions;\n\n\ton?: DDiagramBaseOnOptions<CANVAS, EMITTER>;\n}\n\n/**\n * {@link DDiagramBase} theme.\n */\nexport interface DThemeDiagramBase extends DThemeCanvasContainer {\n\tgetBackgroundAmbient(): boolean;\n}\n\nexport abstract class DDiagramBase<\n\tCANVAS extends DDiagramCanvasBase = DDiagramCanvasBase,\n\tCANVAS_OPTIONS extends DDiagramCanvasBaseOptions = DDiagramCanvasBaseOptions,\n\tCONTROLLER extends DDiagramBaseController = DDiagramBaseController,\n\tTHEME extends DThemeDiagramBase = DThemeDiagramBase,\n\tOPTIONS extends DDiagramBaseOptions<CANVAS, CANVAS_OPTIONS, CONTROLLER, THEME>\n\t\t= DDiagramBaseOptions<CANVAS, CANVAS_OPTIONS, CONTROLLER, THEME>\n> extends DCanvasContainer<CANVAS, CANVAS_OPTIONS, THEME, OPTIONS> {\n\tprotected _serialized: DDiagramSerialized | null;\n\tprotected _tileFactory?: DDiagramCanvasTilePyramidFactory;\n\tprotected _controller?: CONTROLLER;\n\tprotected _backgroundAmbient: boolean;\n\tprotected _snapshot: DDiagramSnapshot;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._serialized = null;\n\t\tthis._tileFactory = options?.tile;\n\t\tthis._controller = options?.controller;\n\t\tthis._backgroundAmbient = this.toBackgroundAmbient( this.theme, this._options );\n\t\tthis._snapshot = new DDiagramSnapshot( this );\n\t}\n\n\tget snapshot(): DDiagramSnapshot {\n\t\treturn this._snapshot;\n\t}\n\n\tget controller(): CONTROLLER | null {\n\t\treturn this._controller || null;\n\t}\n\n\tset( serialized: DDiagramSerialized | null ): void {\n\t\tconst oldSerialized = this._serialized;\n\t\tif( oldSerialized !== serialized ) {\n\t\t\tif( oldSerialized ) {\n\t\t\t\tthis._serialized = null;\n\t\t\t\tthis.onUnset();\n\t\t\t}\n\n\t\t\tthis._serialized = serialized;\n\t\t\tif( serialized ) {\n\t\t\t\tthis.onSet( serialized );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onSet( serialized: DDiagramSerialized ): void {\n\t\tconst canvas = this.newCanvas( serialized );\n\t\tconst pieces = serialized.pieces;\n\t\tconst isEditMode = this.isEditMode();\n\t\tconst pieceDataOrPromise = DDiagrams.toPieceData(\n\t\t\tthis._controller, pieces, isEditMode\n\t\t);\n\t\tif( pieceDataOrPromise == null ) {\n\t\t\tthis.newLayer( serialized, canvas, isEditMode );\n\t\t} else {\n\t\t\tpieceDataOrPromise.then(( pieceData ): void => {\n\t\t\t\tthis.newLayer( serialized, canvas, isEditMode, pieces, pieceData );\n\t\t\t});\n\t\t}\n\t\tthis.canvas = canvas;\n\t}\n\n\tprotected newLayer(\n\t\tserialized: DDiagramSerialized,\n\t\tcanvas: CANVAS,\n\t\tisEditMode: boolean,\n\t\tpieces?: string[],\n\t\tpieceData?: Map<string, EShapeEmbeddedDatum>\n\t): void {\n\t\tconst layer = canvas.layer;\n\t\tconst manager = new EShapeResourceManagerDeserialization(\n\t\t\tserialized, pieces, pieceData, isEditMode\n\t\t);\n\t\tDDiagrams.newLayer( serialized, layer, manager )\n\t\t.then(( shapes: EShape[] ): void => {\n\t\t\tlayer.init();\n\t\t\tthis.initialize( shapes );\n\t\t\tcanvas.initialize( shapes );\n\t\t\tDApplications.update( this );\n\t\t\tthis.emit( \"ready\", this );\n\t\t});\n\t\tif( this._backgroundAmbient ) {\n\t\t\tconst background = this.toBackground( serialized );\n\t\t\tthis.background.color = background.color;\n\t\t\tthis.background.alpha = background.alpha;\n\t\t}\n\t}\n\n\tprotected toCanvasBaseOptions( serialized: DDiagramSerialized, options: CANVAS_OPTIONS ): CANVAS_OPTIONS {\n\t\t// Name\n\t\tif( options.name === undefined ) {\n\t\t\toptions.name = serialized.name;\n\t\t}\n\n\t\t// Width\n\t\tif( options.width === undefined ) {\n\t\t\toptions.width = serialized.width;\n\t\t}\n\n\t\t// Height\n\t\tif( options.height === undefined ) {\n\t\t\toptions.height = serialized.height;\n\t\t}\n\n\t\t// Background, border and shadow\n\t\tconst background = options.background = options.background || {};\n\t\tconst backgroundAmbient = this._backgroundAmbient;\n\t\tconst backgroundSerialized = this.toBackground( serialized );\n\t\tif( backgroundAmbient ) {\n\t\t\tif( background.color === undefined ) {\n\t\t\t\tbackground.color = null;\n\t\t\t}\n\t\t\tconst border = options.border = options.border || {};\n\t\t\tif( border.color === undefined ) {\n\t\t\t\tborder.color = null;\n\t\t\t}\n\t\t} else {\n\t\t\tif( background.color === undefined ) {\n\t\t\t\tbackground.color = backgroundSerialized.color;\n\t\t\t}\n\t\t\tif( background.alpha === undefined ) {\n\t\t\t\tbackground.alpha = backgroundSerialized.alpha;\n\t\t\t}\n\t\t\tif( options.shadow === undefined ) {\n\t\t\t\toptions.shadow = \"WEAK\";\n\t\t\t}\n\t\t}\n\t\tif( background.ambient === undefined ) {\n\t\t\tconst diagramOptions = this._options;\n\t\t\tif( diagramOptions ) {\n\t\t\t\tconst diagramBackgroundOptions = diagramOptions.background;\n\t\t\t\tif( diagramBackgroundOptions && diagramBackgroundOptions.ambient !== undefined ) {\n\t\t\t\t\tbackground.ambient = backgroundAmbient;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Tile\n\t\tconst tileOptions = options.tile = options.tile || {};\n\t\tif( tileOptions.factory === undefined ) {\n\t\t\ttileOptions.factory = this._tileFactory;\n\t\t}\n\t\tif( tileOptions.mapping === undefined ) {\n\t\t\ttileOptions.mapping = serialized.tile && serialized.tile.mapping;\n\t\t}\n\n\t\t// Done\n\t\treturn options;\n\t}\n\n\tprotected toBackgroundAmbient( theme: THEME, options?: OPTIONS ): boolean {\n\t\tconst background = options && options.background;\n\t\tconst ambient = background && background.ambient;\n\t\treturn ( ambient != null ? ambient : theme.getBackgroundAmbient() );\n\t}\n\n\tprotected abstract isEditMode(): boolean;\n\n\tprotected toBackground( serialized: DDiagramSerialized ): { color: number, alpha: number } {\n\t\tconst background = serialized.background;\n\t\tif( background != null ) {\n\t\t\tconst color = background.color;\n\t\t\tconst alpha = background.alpha;\n\t\t\treturn {\n\t\t\t\tcolor: ( color != null ? color : 0xffffff ),\n\t\t\t\talpha: ( alpha != null ? alpha : 1.0 )\n\t\t\t};\n\t\t}\n\t\treturn {\n\t\t\tcolor: 0xffffff,\n\t\t\talpha: 1.0\n\t\t};\n\t}\n\n\topenByName( name: string ) {\n\t\tconst controller = this._controller;\n\t\tif( controller ) {\n\t\t\tcontroller.getByName( name ).then(( found ): void => {\n\t\t\t\tthis.set( DDiagrams.toSerialized( found ) );\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected initialize( shapes: EShape[] ): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected abstract newCanvas( serialized: DDiagramSerialized ): CANVAS;\n\n\tprotected onUnset(): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\tthis.canvas = null;\n\t\t}\n\t}\n\n\tget(): DDiagramSerialized | null {\n\t\treturn this._serialized;\n\t}\n\n\tget layer(): DDiagramLayer | null {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas != null ) {\n\t\t\treturn canvas.layer.active;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramBase\";\n\t}\n}\n","\n/**\n * {@link DDiagramEditorThumbnail} options.\n */\nexport interface DDiagramEditorThumbnailOptions {\n\tenable?: boolean;\n\tsize?: number;\n}\n\n/**\n * {@link DDiagramEditorThumbnail} theme.\n */\nexport interface DThemeDiagramEditorThumbnail {\n\tisThumbnailEnabled(): boolean;\n\tgetThumbnailSize(): number;\n}\n\nexport interface DDiagramEditorThumbnailSnapshot {\n\tcreateAsUrl( size: number ): string | undefined;\n}\n\nexport class DDiagramEditorThumbnail {\n\tprotected _snapshot: DDiagramEditorThumbnailSnapshot;\n\tprotected _isEnabled: boolean;\n\tprotected _size: number;\n\n\tconstructor( snapshot: DDiagramEditorThumbnailSnapshot, theme: DThemeDiagramEditorThumbnail, options: DDiagramEditorThumbnailOptions | undefined ) {\n\t\tthis._snapshot = snapshot;\n\t\tthis._isEnabled = options?.enable ?? theme.isThumbnailEnabled();\n\t\tthis._size = options?.size ?? theme.getThumbnailSize();\n\t}\n\n\tget enable() {\n\t\treturn this._isEnabled;\n\t}\n\n\tset enable( enable: boolean ) {\n\t\tthis._isEnabled = enable;\n\t}\n\n\tget size(): number {\n\t\treturn this._size;\n\t}\n\n\tset size( size: number ) {\n\t\tthis._size = size;\n\t}\n\n\tserialize(): string | undefined {\n\t\tif( this._isEnabled ) {\n\t\t\treturn this._snapshot.createAsUrl( this._size );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DControllerDocument } from \"./d-controller-document\";\nimport { DControllers } from \"./d-controllers\";\nimport {\n\tDDiagramBase, DDiagramBaseController, DDiagramBaseEvents, DDiagramBaseOptions,\n\tDDiagramBasePieceController, DThemeDiagramBase\n} from \"./d-diagram-base\";\nimport { DDiagramCanvasEditor, DDiagramCanvasEditorOptions } from \"./d-diagram-canvas-editor\";\nimport { DDiagramEditorThumbnail, DDiagramEditorThumbnailOptions, DThemeDiagramEditorThumbnail } from \"./d-diagram-editor-thumbnail\";\nimport { DDiagramSerialized, DDiagramSerializedSimple, DDiagramSerializedVersion } from \"./d-diagram-serialized\";\nimport { DDiagrams } from \"./d-diagrams\";\nimport { ESnapper } from \"./snapper/e-snapper\";\n\n/**\n * {@link DDiagramEditor} piece controller.\n */\nexport interface DDiagramEditorPieceController extends DDiagramBasePieceController {\n\n}\n\n/**\n * {@link DDiagramEditor} controller.\n */\nexport interface DDiagramEditorController extends DDiagramBaseController {\n\tget( id: number ): Promise<DDiagramSerializedSimple | DDiagramSerialized>;\n\tsave( simple: DDiagramSerializedSimple ): Promise<number>;\n\tdelete( id: number ): Promise<void>;\n}\n\n/**\n * {@link DDiagramEditor} events.\n */\nexport interface DDiagramEditorEvents<EMITTER> extends DDiagramBaseEvents<DDiagramCanvasEditor, EMITTER> {\n\t/**\n\t * Triggered when a serialized data is changed without using the set / unset methods.\n\t * This happens, for instance, when the name or the ID of the serialized data is changed.\n\t *\n\t * @param emitter an emitter\n\t */\n\tchange( emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered before saving.\n\t *\n\t * @param simple a serialized data\n\t * @param emitter an emitter\n\t */\n\tsaving( simple: DDiagramSerializedSimple, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when saved successfully or when failed to save.\n\t *\n\t * @param reason Null if succeeded. Otherwise, a string representing a reason.\n\t * @param emitter an emitter\n\t */\n\tsaved( reason: string | null, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered before opening.\n\t *\n\t * @param emitter an emitter\n\t */\n\topening( emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when opened successfully or when failed to open.\n\t *\n\t * @param reason Null if succeeded. Otherwise, a string representing a reason.\n\t * @param emitter an emitter\n\t */\n\topened( reason: string | null, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered before deleting.\n\t *\n\t * @param emitter an emitter\n\t */\n\tdeleting( emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when deleted successfully or when failed to delete.\n\t *\n\t * @param reason Null if succeeded. Otherwise, a string representing a reason.\n\t * @param emitter an emitter.\n\t */\n\tdeleted( reason: string | null, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DDiagramEditor} \"on\" options.\n */\nexport interface DDiagramEditorOnOptions<EMITTER> extends Partial<DDiagramEditorEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DDiagramEditor} options.\n */\nexport interface DDiagramEditorOptions<\n\tTHEME extends DThemeDiagramEditor = DThemeDiagramEditor,\n\tEMITTER = any\n> extends DDiagramBaseOptions<DDiagramCanvasEditor, DDiagramCanvasEditorOptions, DDiagramEditorController, THEME> {\n\tcontroller?: DDiagramEditorController;\n\ton?: DDiagramEditorOnOptions<EMITTER>;\n\tthumbnail?: DDiagramEditorThumbnailOptions;\n}\n\n/**\n * {@link DDiagramEditor} theme.\n */\nexport interface DThemeDiagramEditor extends DThemeDiagramBase, DThemeDiagramEditorThumbnail {\n\n}\n\nexport class DDiagramEditor<\n\tTHEME extends DThemeDiagramEditor = DThemeDiagramEditor,\n\tOPTIONS extends DDiagramEditorOptions<THEME> = DDiagramEditorOptions<THEME>\n> extends DDiagramBase<DDiagramCanvasEditor, DDiagramCanvasEditorOptions, DDiagramEditorController, THEME, OPTIONS>\n\timplements DControllerDocument<DDiagramSerialized> {\n\tprotected _isChanged: boolean = false;\n\tprotected _snapper: ESnapper;\n\tprotected _thumbnail: DDiagramEditorThumbnail;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._isChanged = false;\n\n\t\tconst commands = DControllers.getCommandController();\n\t\tcommands.on( \"dirty\", (): void => {\n\t\t\tif( this._isChanged !== true ) {\n\t\t\t\tthis._isChanged = true;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t});\n\n\t\tthis._snapper = new ESnapper( this );\n\t\tthis._thumbnail = new DDiagramEditorThumbnail( this._snapshot, this.theme, options?.thumbnail );\n\t}\n\n\tget thumbnail(): DDiagramEditorThumbnail {\n\t\treturn this._thumbnail;\n\t}\n\n\tget snapper(): ESnapper {\n\t\treturn this._snapper;\n\t}\n\n\tprotected isEditMode(): boolean {\n\t\treturn true;\n\t}\n\n\tprotected newCanvas( serialized: DDiagramSerialized ): DDiagramCanvasEditor {\n\t\treturn new DDiagramCanvasEditor( this.toCanvasOptions( serialized ) );\n\t}\n\n\tprotected toCanvasOptions( serialized: DDiagramSerialized ): DDiagramCanvasEditorOptions {\n\t\tconst options = super.toCanvasBaseOptions( serialized, this._canvasOptions || { snapper: this._snapper } );\n\t\tif( options.snapper === undefined ) {\n\t\t\toptions.snapper = this._snapper;\n\t\t}\n\t\treturn options;\n\t}\n\n\tserialize(): DDiagramSerialized | null {\n\t\tconst canvas = this.canvas;\n\t\tconst serialized = this._serialized;\n\t\tif( canvas != null && serialized != null ) {\n\t\t\treturn canvas.serialize( serialized.id, this._thumbnail );\n\t\t}\n\t\treturn null;\n\t}\n\n\tsave(): Promise<unknown> {\n\t\tconst serialized = this.serialize();\n\t\tif( serialized != null ) {\n\t\t\tconst controller = this._controller;\n\t\t\tif( controller ) {\n\t\t\t\tconst simple = DDiagrams.toSimple( serialized );\n\t\t\t\tthis.emit( \"saving\", simple, this );\n\t\t\t\treturn controller.save( simple )\n\t\t\t\t.then(( newId: number ): void => {\n\t\t\t\t\tthis._isChanged = false;\n\t\t\t\t\tserialized.id = newId;\n\t\t\t\t\tthis._serialized = serialized;\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\tthis.emit( \"saved\", null, this );\n\t\t\t\t}, ( reason: string ): void => {\n\t\t\t\t\tthis.emit( \"saved\", reason, this );\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.emit( \"saved\", \"no-controller\", this );\n\t\t\t\treturn Promise.reject();\n\t\t\t}\n\t\t}\n\t\tthis.emit( \"saved\", null, this );\n\t\treturn Promise.resolve();\n\t}\n\n\tsaveAs( name: string ): Promise<unknown> {\n\t\tconst serialized = this.serialize();\n\t\tif( serialized != null ) {\n\t\t\tconst controller = this._controller;\n\t\t\tif( controller ) {\n\t\t\t\tserialized.id = undefined;\n\t\t\t\tserialized.name = name;\n\t\t\t\tconst simple = DDiagrams.toSimple( serialized );\n\t\t\t\tthis.emit( \"saving\", simple, this );\n\t\t\t\treturn controller.save( simple )\n\t\t\t\t.then(( newId: number ): void => {\n\t\t\t\t\tthis._isChanged = false;\n\t\t\t\t\tserialized.id = newId;\n\t\t\t\t\tthis._serialized = serialized;\n\t\t\t\t\tconst canvas = this.canvas;\n\t\t\t\t\tif( canvas != null ) {\n\t\t\t\t\t\tcanvas.name = name;\n\t\t\t\t\t}\n\t\t\t\t\tthis.emit( \"change\", this );\n\t\t\t\t\tthis.emit( \"saved\", null, this );\n\t\t\t\t}, ( reason: string ): void => {\n\t\t\t\t\tthis.emit( \"saved\", reason, this );\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.emit( \"saved\", \"no-controller\", this );\n\t\t\t\treturn Promise.reject( \"no-controller\" );\n\t\t\t}\n\t\t}\n\t\tthis.emit( \"saved\", null, this );\n\t\treturn Promise.resolve();\n\t}\n\n\tdelete(): Promise<unknown> {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized && serialized.id != null ) {\n\t\t\tconst controller = this._controller;\n\t\t\tif( controller ) {\n\t\t\t\tthis.emit( \"deleting\", this );\n\t\t\t\treturn controller.delete( serialized.id )\n\t\t\t\t.then((): void => {\n\t\t\t\t\tthis.set( null );\n\t\t\t\t\tthis.emit( \"deleted\", this );\n\t\t\t\t}, ( reason: string ): void => {\n\t\t\t\t\tthis.emit( \"deleted\", reason, this );\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tthis.emit( \"deleted\", \"no-controller\", this );\n\t\t\t\treturn Promise.reject( \"no-controller\" );\n\t\t\t}\n\t\t}\n\t\tthis.set( null );\n\t\tthis.emit( \"deleted\", null, this );\n\t\treturn Promise.resolve();\n\t}\n\n\tcreate( name: string, width: number, height: number ): void {\n\t\tthis.set({\n\t\t\tversion: DDiagramSerializedVersion,\n\t\t\tid: undefined,\n\t\t\tname,\n\t\t\twidth,\n\t\t\theight,\n\t\t\tresources: [],\n\t\t\ttags: [],\n\t\t\tlayers: [[ \"Default layer\" ]],\n\t\t\titems: [],\n\t\t\tsnap: undefined\n\t\t});\n\t}\n\n\tprotected onSet( serialized: DDiagramSerialized ): void {\n\t\tsuper.onSet( serialized );\n\t\tconst snap = serialized.snap;\n\t\tconst snapper = this._snapper;\n\t\tif( snap != null ) {\n\t\t\tsnapper.deserialize( snap );\n\t\t} else {\n\t\t\tsnapper.reset();\n\t\t}\n\t\tthis._isChanged = false;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\tprotected onUnset(): void {\n\t\tsuper.onUnset();\n\t\tthis._isChanged = false;\n\t\tthis.emit( \"change\", this );\n\t}\n\n\topen( id: number ): Promise<unknown> {\n\t\tconst controller = this._controller;\n\t\tif( controller ) {\n\t\t\tthis.emit( \"opening\", this );\n\t\t\treturn controller.get( id )\n\t\t\t.then(( serialized: DDiagramSerializedSimple | DDiagramSerialized ): void => {\n\t\t\t\tthis.set( DDiagrams.toSerialized( serialized ) );\n\t\t\t\tthis.emit( \"opened\", null, this );\n\t\t\t}, ( reason: string ): void => {\n\t\t\t\tthis.emit( \"opened\", reason, this );\n\t\t\t});\n\t\t}\n\t\tthis.emit( \"opened\", \"no-controller\", this );\n\t\treturn Promise.reject( \"no-controller\" );\n\t}\n\n\tclose(): void {\n\t\tthis.set( null );\n\t}\n\n\tisChanged(): boolean {\n\t\treturn this._isChanged || this.isNew();\n\t}\n\n\tisNew(): boolean {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\treturn serialized.id == null;\n\t\t}\n\t\treturn false;\n\t}\n\n\tgetName(): string | null {\n\t\tconst serialized = this._serialized;\n\t\tif( serialized != null ) {\n\t\t\treturn serialized.name;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagramEditor\";\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Renderer, utils } from \"pixi.js\";\nimport { DApplicationTarget } from \"./d-application-like\";\nimport { DApplications } from \"./d-applications\";\nimport { DDiagramCanvasIdMap } from \"./d-diagram-canvas-id-map\";\nimport { EShape } from \"./shape/e-shape\";\n\nexport interface DDiagramShapeLayer {\n\tchildren: EShape[];\n}\n\nexport interface DDiagramShapeLayerContainer {\n\tchildren: DDiagramShapeLayer[];\n}\n\nexport interface DDiagramShapeCanvas {\n\tlayer: DDiagramShapeLayerContainer;\n\tids: DDiagramCanvasIdMap;\n\tactionables: EShape[];\n}\n\nexport interface DDiagramShapeDiagram extends DApplicationTarget {\n\tcanvas: DDiagramShapeCanvas | null;\n}\n\n/**\n * A shape helper class for diagrams.\n */\nexport class DDiagramShape extends utils.EventEmitter {\n\tprotected _diagram: DDiagramShapeDiagram;\n\tprotected _updateBound: () => void;\n\n\tconstructor( diagram: DDiagramShapeDiagram ) {\n\t\tsuper();\n\t\tthis._diagram = diagram;\n\t\tthis._updateBound = (): void => {\n\t\t\tDApplications.update( diagram );\n\t\t};\n\t}\n\n\tupdate(): void {\n\t\tconst diagram = this._diagram;\n\t\tconst canvas = diagram.canvas;\n\t\tif( canvas ) {\n\t\t\tconst actionables = canvas.actionables;\n\t\t\tif( 0 < actionables.length ) {\n\t\t\t\tlet effect = -1;\n\t\t\t\tconst time = Date.now();\n\t\t\t\tfor( let i = 0, imax = actionables.length; i < imax; ++i ) {\n\t\t\t\t\tconst actionable = actionables[ i ];\n\t\t\t\t\tactionable.update( time );\n\t\t\t\t\tconst runtime = actionable.runtime;\n\t\t\t\t\tif( runtime && time < runtime.effect ) {\n\t\t\t\t\t\tconst runtimeEffect = runtime.effect;\n\t\t\t\t\t\tif( time < runtimeEffect ) {\n\t\t\t\t\t\t\teffect = ( effect < 0 ? runtimeEffect : Math.min( effect, runtimeEffect ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( 0 <= effect ) {\n\t\t\t\t\tsetTimeout( this._updateBound, effect - Date.now() );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tonRender( renderer: Renderer ): void {\n\t\tconst diagram = this._diagram;\n\t\tconst canvas = diagram.canvas;\n\t\tif( canvas ) {\n\t\t\tconst actionables = canvas.actionables;\n\t\t\tif( 0 < actionables.length ) {\n\t\t\t\tlet effect = -1;\n\t\t\t\tconst time = Date.now();\n\t\t\t\tfor( let i = 0, imax = actionables.length; i < imax; ++i ) {\n\t\t\t\t\tconst actionable = actionables[ i ];\n\t\t\t\t\tactionable.onRender( time, renderer );\n\t\t\t\t\tconst runtime = actionable.runtime;\n\t\t\t\t\tif( runtime && time < runtime.effect ) {\n\t\t\t\t\t\tconst runtimeEffect = runtime.effect;\n\t\t\t\t\t\tif( time < runtimeEffect ) {\n\t\t\t\t\t\t\teffect = ( effect < 0 ? runtimeEffect : Math.min( effect, runtimeEffect ) );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif( 0 <= effect ) {\n\t\t\t\t\tsetTimeout( this._updateBound, effect - Date.now() );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget( id: string ): EShape | null {\n\t\tconst canvas = this._diagram.canvas;\n\t\tconst shapes = ( canvas && canvas.ids[ id ] );\n\t\treturn ( shapes && 0 < shapes.length ? shapes[ 0 ] : null );\n\t}\n\n\tgetAll( id: string ): EShape[] {\n\t\tconst canvas = this._diagram.canvas;\n\t\treturn ( canvas && canvas.ids[ id ] ) || [];\n\t}\n\n\teach( callback: ( shape: EShape ) => (boolean | void), reverse = false ): EShape | null {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst layers = canvas.layer.children;\n\t\t\tif( ! reverse ) {\n\t\t\t\tfor( let i = 0, imax = layers.length; i < imax; ++i ) {\n\t\t\t\t\tconst layer = layers[ i ];\n\t\t\t\t\tconst children = layer.children;\n\t\t\t\t\tfor( let j = 0, jmax = children.length; j < jmax; ++j ) {\n\t\t\t\t\t\tconst child = children[ j ];\n\t\t\t\t\t\tif( callback( child ) === false ) {\n\t\t\t\t\t\t\treturn child;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = layers.length - 1; 0 <= i; --i ) {\n\t\t\t\t\tconst layer = layers[ i ];\n\t\t\t\t\tconst children = layer.children;\n\t\t\t\t\tfor( let j = children.length - 1; 0 <= j; --j ) {\n\t\t\t\t\t\tconst child = children[ j ];\n\t\t\t\t\t\tif( callback( child ) === false ) {\n\t\t\t\t\t\t\treturn child;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n}\n","\nexport interface DDiagramTagRemoteController {\n\twrite( id: string, value: unknown ): void;\n}\n\nexport interface DDiagramTagRemoteOptions {\n\tcontroller?: DDiagramTagRemoteController;\n}\n\nexport class DDiagramTagRemote {\n\tprotected _controller?: DDiagramTagRemoteController;\n\n\tconstructor( options?: DDiagramTagRemoteOptions ) {\n\t\tthis._controller = options && options.controller;\n\t}\n\n\tset( id: string, value: unknown, time: number ): void {\n\t\tconst controller = this._controller;\n\t\tif( controller ) {\n\t\t\tcontroller.write( id, value );\n\t\t}\n\t}\n}\n","import { DDiagramCanvasTagMap } from \"./d-diagram-canvas-tag-map\";\nimport { DDiagramTagRemote, DDiagramTagRemoteOptions } from \"./d-diagram-tag-remote\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeTagValue } from \"./shape/e-shape-tag-value\";\nimport { EShapeTagValueRangeType } from \"./shape/e-shape-tag-value-range\";\n\nexport interface DDiagramTagCanvas {\n\ttags: DDiagramCanvasTagMap;\n}\n\nexport interface DDiagramTagDiagram {\n\tcanvas: DDiagramTagCanvas | null;\n}\n\n/**\n * A tag mapper.\n *\n * @param tag a tag\n * @returns a mapped tag\n */\nexport type DDiagramTagMapper = ( tag: EShapeTagValue, shape: EShape ) => void;\n\nexport interface DDiagramTagOptions {\n\t/**\n\t * A tag mapper.\n\t */\n\tmapper?: DDiagramTagMapper;\n\n\t/**\n\t * Remote tag options.\n\t */\n\tremote?: DDiagramTagRemoteOptions;\n}\n\n/**\n * A tag helper class for diagrams.\n */\nexport class DDiagramTag {\n\tprotected _diagram: DDiagramTagDiagram;\n\tprotected _mapper: DDiagramTagMapper | null;\n\tprotected _remote: DDiagramTagRemote;\n\n\tconstructor( diagram: DDiagramTagDiagram, options?: DDiagramTagOptions ) {\n\t\tthis._diagram = diagram;\n\t\tthis._mapper = (options && options.mapper) || null;\n\t\tthis._remote = new DDiagramTagRemote( options && options.remote );\n\t}\n\n\tupdate(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget mapper(): DDiagramTagMapper | null {\n\t\treturn this._mapper;\n\t}\n\n\tset mapper( mapper: DDiagramTagMapper | null ) {\n\t\tthis._mapper = mapper;\n\t}\n\n\tget remote(): DDiagramTagRemote {\n\t\treturn this._remote;\n\t}\n\n\tgetIds(): string[] {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\treturn Object.keys( canvas.tags );\n\t\t}\n\t\treturn [];\n\t}\n\n\teach( callback: ( tagId: string ) => (boolean | void) ): string | null {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tags = canvas.tags;\n\t\t\tfor( const id in tags ) {\n\t\t\t\tif( callback( id ) === false ) {\n\t\t\t\t\treturn id;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( id: string, value: unknown, time?: number, from?: number | null, to?: number | null ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\t\t\t\t\tconst range = tagValue.range;\n\n\t\t\t\t\t// Range\n\t\t\t\t\trange.set( from, to );\n\n\t\t\t\t\t// Time\n\t\t\t\t\tif( time !== undefined ) {\n\t\t\t\t\t\ttagValue.time = time;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Value\n\t\t\t\t\ttagValue.value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclear( id: string ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\ttagValues[ i ].clear();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetAll( id: string, values: unknown[], times?: number[], from?: number | null, to?: number | null ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\t\t\t\t\tconst range = tagValue.range;\n\n\t\t\t\t\t// Range\n\t\t\t\t\trange.set( from, to );\n\n\t\t\t\t\t// Time\n\t\t\t\t\tif( times !== undefined ) {\n\t\t\t\t\t\ttagValue.times = times;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Value\n\t\t\t\t\ttagValue.values = values;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetValue( id: string, value: unknown, time?: number ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\n\t\t\t\t\tif( time !== undefined ) {\n\t\t\t\t\t\ttagValue.time = time;\n\t\t\t\t\t}\n\n\t\t\t\t\ttagValue.value = value;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetValues( id: string, values: unknown[], times?: number[] ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst tagValue = tagValues[ i ];\n\n\t\t\t\t\tif( times !== undefined ) {\n\t\t\t\t\t\ttagValue.times = times;\n\t\t\t\t\t}\n\n\t\t\t\t\ttagValue.values = values;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTime( id: string, time: number ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\ttagValues[ i ].time = time;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetTimes( id: string, times: number[] ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\ttagValues[ i ].times = times;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tsetRange( id: string, from?: number | null, to?: number | null ): void {\n\t\tconst canvas = this._diagram.canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst tagValues = canvas.tags[ id ];\n\t\t\tif( tagValues != null ) {\n\t\t\t\tfor( let i = 0, imax = tagValues.length; i < imax; ++i ) {\n\t\t\t\t\tconst range = tagValues[ i ].range;\n\t\t\t\t\tif( from !== undefined ) {\n\t\t\t\t\t\tif( from !== null ) {\n\t\t\t\t\t\t\trange.type |= EShapeTagValueRangeType.FROM;\n\t\t\t\t\t\t\trange.from = from;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.type &= ~EShapeTagValueRangeType.FROM;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif( to !== undefined ) {\n\t\t\t\t\t\tif( to !== null ) {\n\t\t\t\t\t\t\trange.type |= EShapeTagValueRangeType.TO;\n\t\t\t\t\t\t\trange.to = to;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\trange.type &= ~EShapeTagValueRangeType.TO;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Renderer } from \"pixi.js\";\nimport {\n\tDDiagramBase, DDiagramBaseController, DDiagramBaseOptions, DDiagramBasePieceController, DThemeDiagramBase\n} from \"./d-diagram-base\";\nimport { DDiagramCanvas, DDiagramCanvasOptions } from \"./d-diagram-canvas\";\nimport { DDiagramSerialized } from \"./d-diagram-serialized\";\nimport { DDiagramShape } from \"./d-diagram-shape\";\nimport { DDiagramTag, DDiagramTagMapper, DDiagramTagOptions } from \"./d-diagram-tag\";\nimport { EShapeActionRuntime } from \"./shape/action/e-shape-action-runtime\";\nimport { EShapeActionRuntimeOpen } from \"./shape/action/e-shape-action-runtime-open\";\nimport { EShapeActionValue } from \"./shape/action/e-shape-action-value\";\nimport { EShape } from \"./shape/e-shape\";\nimport { EShapeRuntime } from \"./shape/e-shape-runtime\";\nimport { EShapeRuntimes } from \"./shape/e-shape-runtimes\";\nimport { EShapeType } from \"./shape/e-shape-type\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\n/**\n * {@link DDiagram} piece controller.\n */\nexport interface DDiagramPieceController extends DDiagramBasePieceController {\n\n}\n\n/**\n * {@link DDiagram} controller.\n */\nexport interface DDiagramController extends DDiagramBaseController {\n\n}\n\n/**\n * {@link DDiagram} options.\n */\nexport interface DDiagramOptions<\n\tTHEME extends DThemeDiagram = DThemeDiagram,\n\tEMITTER = any\n> extends DDiagramBaseOptions<DDiagramCanvas, DDiagramCanvasOptions, DDiagramController, THEME, EMITTER> {\n\ttag?: DDiagramTagOptions;\n}\n\n/**\n * {@link DDiagram} theme.\n */\nexport interface DThemeDiagram extends DThemeDiagramBase {\n\n}\n\nexport class DDiagram<\n\tTHEME extends DThemeDiagram = DThemeDiagram,\n\tOPTIONS extends DDiagramOptions<THEME> = DDiagramOptions<THEME>\n> extends DDiagramBase<DDiagramCanvas, DDiagramCanvasOptions, DDiagramController, THEME, OPTIONS> {\n\ttag: DDiagramTag;\n\tshape: DDiagramShape;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\t// Hover handling\n\t\tthis.on( UtilPointerEvent.move, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas ) {\n\t\t\t\t\tcanvas.onShapeMove( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Pointer down / up handling\n\t\tthis.on( UtilPointerEvent.up, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas ) {\n\t\t\t\t\tcanvas.onShapeUp( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t// Click handling\n\t\tthis.on( \"click\", ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( UtilPointerEvent.contains( this, e.target ) ) {\n\t\t\t\tconst canvas = this.canvas;\n\t\t\t\tif( canvas ) {\n\t\t\t\t\tcanvas.onShapeClick( e );\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\n\t\t//\n\t\tthis.tag = new DDiagramTag( this, options && options.tag );\n\t\tthis.shape = new DDiagramShape( this );\n\t}\n\n\tprotected initialize( shapes: EShape[] ): void {\n\t\tthis.initializeShapes( shapes, null, this.tag.mapper );\n\t}\n\n\tprotected initializeShapes( shapes: EShape[], tagShape: EShape | null, tagMapper: DDiagramTagMapper | null ): void {\n\t\tconst formatterMap: { [format: string]: ( value: unknown ) => unknown } = {};\n\t\tconst initialMap: { [initial: string]: unknown | undefined } = {};\n\t\tconst actionMap: Map<EShapeActionValue, EShapeActionRuntime> = new Map<EShapeActionValue, EShapeActionRuntime>();\n\n\t\tfor( let i = 0, imax = shapes.length; i < imax; ++i ) {\n\t\t\tconst shape = shapes[ i ];\n\t\t\tconst runtimeConstructor = EShapeRuntimes[ shape.type ] || EShapeRuntime;\n\t\t\tconst runtime = shape.runtime = new (runtimeConstructor)( shape );\n\n\t\t\t// Tag\n\t\t\tconst tag = shape.tag;\n\t\t\tfor( let j = 0, jmax = tag.size(); j < jmax; ++j ) {\n\t\t\t\tconst value = tag.get( j );\n\t\t\t\tif( value ) {\n\t\t\t\t\t// Mapping\n\t\t\t\t\tif( tagMapper ) {\n\t\t\t\t\t\ttagMapper( value, tagShape || shape );\n\t\t\t\t\t}\n\n\t\t\t\t\t// Format\n\t\t\t\t\tconst tagFormat = value.format;\n\t\t\t\t\tconst tagInitial = value.initial;\n\t\t\t\t\tif( tagFormat in formatterMap ) {\n\t\t\t\t\t\tvalue.formatter = formatterMap[ tagFormat ];\n\t\t\t\t\t} else if( 0 < tagFormat.length ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconst formatter = Function(\n\t\t\t\t\t\t\t\t\"value\",\n\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t`return (${tagFormat});` +\n\t\t\t\t\t\t\t\t`} catch( e1 ) {` +\n\t\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t\t`return (${0 < tagInitial.length ? tagInitial : 0});` +\n\t\t\t\t\t\t\t\t\t`} catch( e2 ) {` +\n\t\t\t\t\t\t\t\t\t\t`return 0;` +\n\t\t\t\t\t\t\t\t\t`}` +\n\t\t\t\t\t\t\t\t`}`\n\t\t\t\t\t\t\t) as any;\n\t\t\t\t\t\t\tformatterMap[ tagFormat ] = formatter;\n\t\t\t\t\t\t\tvalue.formatter = formatter;\n\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t// Initial\n\t\t\t\t\tif( tagInitial in initialMap ) {\n\t\t\t\t\t\tvalue.value = initialMap[ tagInitial ];\n\t\t\t\t\t} else if( 0 < tagInitial.length ) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvalue.value = initialMap[ tagInitial ] = (Function(\n\t\t\t\t\t\t\t\t`try {` +\n\t\t\t\t\t\t\t\t\t`return (${tagInitial});` +\n\t\t\t\t\t\t\t\t`} catch( e ) {` +\n\t\t\t\t\t\t\t\t\t`return 0;` +\n\t\t\t\t\t\t\t\t`}`\n\t\t\t\t\t\t\t)());\n\t\t\t\t\t\t} catch( e ) {\n\t\t\t\t\t\t\t//\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Initialize runtime actions\n\t\t\tconst values = shape.action.values;\n\t\t\tconst actions = runtime.actions;\n\t\t\tfor( let j = 0, jmax = values.length; j < jmax; ++j ) {\n\t\t\t\tconst value = values[ j ];\n\t\t\t\tlet action: EShapeActionRuntime | undefined | null = actionMap.get( value );\n\t\t\t\tif( action == null ) {\n\t\t\t\t\taction = value.toRuntime();\n\t\t\t\t\tif( action != null ) {\n\t\t\t\t\t\tif( action instanceof EShapeActionRuntimeOpen ) {\n\t\t\t\t\t\t\tif( shape.cursor.length <= 0 ) {\n\t\t\t\t\t\t\t\tshape.cursor = \"pointer\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tactionMap.set( value, action );\n\t\t\t\t\t\tactions.push( action );\n\t\t\t\t\t\truntime.reset |= action.reset;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tactions.push( action );\n\t\t\t\t\truntime.reset |= action.reset;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Children\n\t\t\tconst children = shape.children;\n\t\t\tif( 0 < children.length ) {\n\t\t\t\tthis.initializeShapes(\n\t\t\t\t\tchildren,\n\t\t\t\t\tthis.toTagShape( tagShape, shape ),\n\t\t\t\t\ttagMapper\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toTagShape( tagShape: EShape | null, shape: EShape ): EShape | null {\n\t\tif( tagShape != null ) {\n\t\t\treturn tagShape;\n\t\t}\n\t\tif( shape.type === EShapeType.EMBEDDED ) {\n\t\t\treturn shape;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected isEditMode(): boolean {\n\t\treturn false;\n\t}\n\n\tprotected newCanvas( serialized: DDiagramSerialized ): DDiagramCanvas {\n\t\treturn new DDiagramCanvas( this.toCanvasOptions( serialized ) );\n\t}\n\n\tprotected toCanvasOptions( serialized: DDiagramSerialized ): DDiagramCanvasOptions {\n\t\treturn super.toCanvasBaseOptions( serialized, this._canvasOptions || {} );\n\t}\n\n\tprotected onDown( e: interaction.InteractionEvent ): void {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas && canvas.onShapeDown( e ) ) {\n\t\t\treturn;\n\t\t}\n\t\tsuper.onDown( e );\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst canvas = this.canvas;\n\t\tif( canvas && canvas.onShapeDblClick( e, interactionManager ) ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn super.onDblClick( e, interactionManager );\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis.shape.onRender( renderer );\n\t\tsuper.render( renderer );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDiagram\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\n\nexport interface DDialogConfirmMessageOptions<\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage\n> extends DImageOptions<string, THEME> {\n\n}\n\nexport interface DThemeDialogConfirmMessage extends DThemeImage<string> {\n\n}\n\nexport class DDialogConfirmMessage<\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage,\n\tOPTIONS extends DDialogConfirmMessageOptions<THEME> = DDialogConfirmMessageOptions<THEME>\n> extends DImage<string, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DDialogCommand, DDialogCommandOptions, DThemeDialogCommand } from \"./d-dialog-command\";\nimport { DDialogConfirmMessage, DDialogConfirmMessageOptions } from \"./d-dialog-confirm-message\";\nimport { DLayoutVertical } from \"./d-layout-vertical\";\nimport { DStateAwareOrValue } from \"./d-state-aware\";\nimport { isFunction } from \"./util/is-function\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DDialogConfirmOptions<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm\n> extends DDialogCommandOptions<void, THEME> {\n\tmessage?: DStateAwareOrValue<string> | DDialogConfirmMessageOptions | DDialogConfirmMessage;\n}\n\nexport interface DThemeDialogConfirm extends DThemeDialogCommand {\n\tgetMessage(): DStateAwareOrValue<string>;\n}\n\nexport class DDialogConfirm<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmOptions<THEME> = DDialogConfirmOptions<THEME>\n> extends DDialogCommand<void, THEME, OPTIONS> {\n\tprotected _message?: DDialogConfirmMessage;\n\n\tprotected onInit( layout: DLayoutVertical, options?: OPTIONS ) {\n\t\tsuper.onInit( layout, options );\n\t\tlayout.addChild( this.message );\n\t}\n\n\tprotected toMessage( theme: THEME, options?: OPTIONS ): DDialogConfirmMessage {\n\t\tconst message = options?.message;\n\t\tif( message != null ) {\n\t\t\tif( isString( message ) || isFunction( message ) ) {\n\t\t\t\treturn this.newMessage(\n\t\t\t\t\tthis.toMessageOptions( message )\n\t\t\t\t);\n\t\t\t} else if( message instanceof DBase ) {\n\t\t\t\treturn message;\n\t\t\t} else {\n\t\t\t\treturn this.newMessage(\n\t\t\t\t\tthis.toMessageOptionsMerged( message, theme.getMessage() )\n\t\t\t\t);\n\t\t\t}\n\t\t}\n\t\treturn this.newMessage(\n\t\t\tthis.toMessageOptions( theme.getMessage() )\n\t\t);\n\t}\n\n\tprotected toMessageOptionsMerged(\n\t\toptions: DDialogConfirmMessageOptions,\n\t\tmessage: DStateAwareOrValue<string>\n\t): DDialogConfirmMessageOptions {\n\t\tlet text = options.text;\n\t\tif( text == null ) {\n\t\t\ttext = {};\n\t\t\toptions.text =text;\n\t\t}\n\t\tif( text.value === undefined ) {\n\t\t\ttext.value = message;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected toMessageOptions( message: DStateAwareOrValue<string> ): DDialogConfirmMessageOptions {\n\t\treturn {\n\t\t\ttext: {\n\t\t\t\tvalue: message\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected newMessage( options: DDialogConfirmMessageOptions ): DDialogConfirmMessage {\n\t\treturn new DDialogConfirmMessage( options );\n\t}\n\n\tget message(): DDialogConfirmMessage {\n\t\tlet result = this._message;\n\t\tif( result == null ) {\n\t\t\tresult = this.toMessage( this.theme, this._options );\n\t\t\tthis._message = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getResolvedValue(): void | PromiseLike<void> {\n\t\treturn undefined;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirm\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogConfirmDeleteOptions<\n\tTHEME extends DThemeDialogConfirm\n> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogConfirmDelete extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogConfirmDelete<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmDeleteOptions<THEME> = DDialogConfirmDeleteOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmDelete\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogConfirmDiscardOptions<\n\tTHEME extends DThemeDialogConfirm\n> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogConfirmDiscard extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogConfirmDiscard<\n\tTHEME extends DThemeDialogConfirm = DThemeDialogConfirm,\n\tOPTIONS extends DDialogConfirmDiscardOptions<THEME> = DDialogConfirmDiscardOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogConfirmDiscard\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\n\nexport interface DDialogMessageOptions<THEME extends DThemeDialogMessage> extends DDialogConfirmOptions<THEME> {\n\n}\n\nexport interface DThemeDialogMessage extends DThemeDialogConfirm {\n\n}\n\nexport class DDialogMessage<\n\tTHEME extends DThemeDialogMessage = DThemeDialogMessage,\n\tOPTIONS extends DDialogMessageOptions<THEME> = DDialogMessageOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDDialogConfirmMessage, DDialogConfirmMessageOptions, DThemeDialogConfirmMessage\n} from \"./d-dialog-confirm-message\";\n\nexport class DDialogProcessingMessage<\n\tTHEME extends DThemeDialogConfirmMessage = DThemeDialogConfirmMessage,\n\tOPTIONS extends DDialogConfirmMessageOptions<THEME> = DDialogConfirmMessageOptions<THEME>\n> extends DDialogConfirmMessage<THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDialogProcessingMessage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseState } from \"./d-base-state\";\nimport { DDialogConfirm, DDialogConfirmOptions, DThemeDialogConfirm } from \"./d-dialog-confirm\";\nimport { DDialogConfirmMessage, DDialogConfirmMessageOptions } from \"./d-dialog-confirm-message\";\nimport { DDialogProcessingMessage } from \"./d-dialog-processing-message\";\nimport { DStateAwareOrValueMightBe } from \"./d-state-aware\";\n\nexport interface DDialogProcessingDelayOptions {\n\tdone?: number;\n\tclose?: number | null;\n}\n\nexport interface DDialogProcessingOptions<THEME extends DThemeDialogProcessing> extends DDialogConfirmOptions<THEME> {\n\tdelay?: DDialogProcessingDelayOptions;\n}\n\nexport interface DThemeDialogProcessing extends DThemeDialogConfirm {\n\tgetDoneDelay(): number;\n\tgetCloseDelay(): number | null;\n}\n\nexport class DDialogProcessing<\n\tTHEME extends DThemeDialogProcessing = DThemeDialogProcessing,\n\tOPTIONS extends DDialogProcessingOptions<THEME> = DDialogProcessingOptions<THEME>\n> extends DDialogConfirm<THEME, OPTIONS> {\n\tprotected _isDone: boolean;\n\tprotected _startTime: number;\n\tprotected _delayDone: number;\n\tprotected _delayClose: number | null;\n\tprotected _timeoutId?: number;\n\tprotected _messageText: DStateAwareOrValueMightBe<string>;\n\tprotected _closeTimeoutId?: number;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._isDone = true;\n\t\tthis._startTime =  0;\n\t\tconst delay = options?.delay;\n\t\tthis._delayDone = ( delay?.done ?? this.theme.getDoneDelay() );\n\t\tconst delayClose = delay?.close;\n\t\tthis._delayClose = ( delayClose !== undefined ? delayClose : this.theme.getCloseDelay() );\n\t\tthis._messageText = this.message.text;\n\t}\n\n\tprotected newMessage( options: DDialogConfirmMessageOptions ): DDialogConfirmMessage {\n\t\treturn new DDialogProcessingMessage( options );\n\t}\n\n\tprotected onOpen() {\n\t\tthis._isDone = false;\n\t\tthis._startTime = Date.now();\n\t\tconst timeoutId = this._timeoutId;\n\t\tif( timeoutId != null ) {\n\t\t\tclearTimeout( timeoutId );\n\t\t}\n\t\tconst closeTimeoutId = this._closeTimeoutId;\n\t\tif( closeTimeoutId != null ) {\n\t\t\tclearTimeout( closeTimeoutId );\n\t\t}\n\t\tconst message = this.message;\n\t\tmessage.text = this._messageText;\n\t\tmessage.state.removeAll( DBaseState.SUCCEEDED, DBaseState.FAILED );\n\t\tconst buttonLayout = this._buttonLayout;\n\t\tif( buttonLayout != null ) {\n\t\t\tbuttonLayout.hide();\n\t\t}\n\t\tsuper.onOpen();\n\t}\n\n\tprotected onDone( delay: number | null ) {\n\t\tif( delay != null ) {\n\t\t\tthis._closeTimeoutId = window.setTimeout(() => {\n\t\t\t\tthis.close();\n\t\t\t}, delay );\n\t\t} else {\n\t\t\tthis.close();\n\t\t}\n\t}\n\n\tprotected onResolved( message?: string ): void {\n\t\tif( message != null ) {\n\t\t\tthis.message.text = message;\n\t\t}\n\t\tthis.message.state.set( DBaseState.SUCCEEDED, DBaseState.FAILED );\n\t\tconst delayClose = this._delayClose;\n\t\tif( delayClose != null ) {\n\t\t\tthis.onDone( delayClose );\n\t\t} else {\n\t\t\tconst buttonLayout = this._buttonLayout;\n\t\t\tif( buttonLayout != null ) {\n\t\t\t\tbuttonLayout.show();\n\t\t\t} else {\n\t\t\t\tthis.close();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onRejected( message?: string ): void {\n\t\tif( message != null ) {\n\t\t\tthis.message.text = message;\n\t\t}\n\t\tthis.message.state.set( DBaseState.FAILED, DBaseState.SUCCEEDED );\n\t\tconst buttonLayout = this._buttonLayout;\n\t\tif( buttonLayout != null ) {\n\t\t\tbuttonLayout.show();\n\t\t} else {\n\t\t\tthis.onDone( this._delayClose );\n\t\t}\n\t}\n\n\tresolve( message?: string ): void {\n\t\tif( ! this._isDone ) {\n\t\t\tthis._isDone = true;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst delay = this._delayDone - elapsedTime;\n\t\t\tif( 0 < delay ) {\n\t\t\t\tthis._timeoutId = window.setTimeout((): void => {\n\t\t\t\t\tthis._timeoutId = undefined;\n\t\t\t\t\tthis.onResolved( message );\n\t\t\t\t}, delay );\n\t\t\t} else {\n\t\t\t\tthis.onResolved( message );\n\t\t\t}\n\t\t}\n\t}\n\n\treject( message?: string ): void {\n\t\tif( ! this._isDone ) {\n\t\t\tthis._isDone = true;\n\t\t\tconst elapsedTime = Date.now() - this._startTime;\n\t\t\tconst delay = this._delayDone - elapsedTime;\n\t\t\tif( 0 < delay ) {\n\t\t\t\tthis._timeoutId = window.setTimeout((): void => {\n\t\t\t\t\tthis._timeoutId = undefined;\n\t\t\t\t\tthis.onRejected( message );\n\t\t\t\t}, delay );\n\t\t\t} else {\n\t\t\t\tthis.onRejected( message );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onCloseOn(): void {\n\t\tif( this._isDone ) {\n\t\t\tsuper.onCloseOn();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogProcessing\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DCommandSaveAs } from \"./d-command-save-as\";\nimport { DControllers } from \"./d-controllers\";\nimport { DDialogInputText, DDialogInputTextOptions, DThemeDialogInputText } from \"./d-dialog-input-text\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DDialogSaveAsOptions<THEME extends DThemeDialogSaveAs> extends DDialogInputTextOptions<THEME> {\n\n}\n\nexport interface DThemeDialogSaveAs extends DThemeDialogInputText {\n\n}\n\nexport class DDialogSaveAs<\n\tTHEME extends DThemeDialogSaveAs = DThemeDialogSaveAs,\n\tOPTIONS extends DDialogSaveAsOptions<THEME> = DDialogSaveAsOptions<THEME>\n> extends DDialogInputText<THEME, OPTIONS> {\n\tprotected onOpen(): void {\n\t\tconst name = DControllers.getDocumentController().getName();\n\t\tif( name != null ) {\n\t\t\tthis.input.value = name;\n\t\t}\n\t\tsuper.onOpen();\n\t}\n\n\tprotected onOk( value: string | PromiseLike<string> ): void {\n\t\tsuper.onOk( value );\n\t\tconst commandController = DControllers.getCommandController();\n\t\tif( isString( value ) ) {\n\t\t\tcommandController.push( new DCommandSaveAs( value ) );\n\t\t} else {\n\t\t\tvalue.then(( resolved: string ): void => {\n\t\t\t\tcommandController.push( new DCommandSaveAs( resolved ) );\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDialogSaveAs\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\n\nexport interface Owner {\n\tfocus(): void;\n}\n\nexport interface Parent {\n\tparent: unknown;\n}\n\nexport interface Closeable extends DisplayObject {\n\tclose(): void;\n}\n\nexport class DMenuContext {\n\tprotected _owner: Owner;\n\tprotected _closeables: Closeable[];\n\n\tconstructor( owner: Owner ) {\n\t\tthis._owner = owner;\n\t\tthis._closeables = [];\n\t}\n\n\tprotected indexOf( target: unknown ): number {\n\t\treturn this._closeables.indexOf( target as any );\n\t}\n\n\tprotected close( index: number ): void {\n\t\tconst closeables = this._closeables;\n\t\tconst imin = Math.max( 0, index );\n\t\tfor( let i = closeables.length - 1; imin <= i; --i ) {\n\t\t\tcloseables[ i ].close();\n\t\t}\n\t}\n\n\tadd( closeable: Closeable ): void {\n\t\tthis._closeables.push( closeable );\n\t}\n\n\ttrim( closeable: Closeable | null ): void {\n\t\tthis.close( this.indexOf( closeable ) + 1 );\n\t}\n\n\tremove( closeable: Closeable ): void {\n\t\tconst index = this.indexOf( closeable );\n\t\tif( 0 <= index ) {\n\t\t\tthis.close( index + 1 );\n\t\t\tthis._closeables.splice( index, 1 );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, Point } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DFocusable } from \"./d-controller-focus\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\nimport { DMenuAlign } from \"./d-menu-align\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenus } from \"./d-menus\";\nimport { toEnum } from \"./util/to-enum\";\nimport { UtilAttach } from \"./util/util-attach\";\nimport { UtilClickOutside } from \"./util/util-click-outside\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilOverlay } from \"./util/util-overlay\";\n\nexport interface DMenuOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenu = DThemeMenu\n> extends DLayoutVerticalOptions<THEME> {\n\talign?: (keyof typeof DMenuAlign) | DMenuAlign;\n\tfit?: boolean;\n\tsticky?: boolean;\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject | null | undefined>;\n}\n\nexport interface DThemeMenu extends DThemeLayoutVertical {\n\tgetOffsetX(): number;\n\tgetOffsetY(): number;\n}\n\nexport class DMenu<\n\tVALUE,\n\tTHEME extends DThemeMenu = DThemeMenu,\n\tOPTIONS extends DMenuOptions<VALUE, THEME> = DMenuOptions<VALUE, THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _align!: DMenuAlign;\n\tprotected _fit!: boolean;\n\tprotected _sticky!: boolean;\n\tprotected _sub!: boolean;\n\tprotected _owner!: DBase<any, any> | null;\n\tprotected _context!: DMenuContext | null;\n\tprotected _overlay!: UtilOverlay;\n\tprotected _onPrerenderBound!: () => void;\n\tprotected _focused?: DFocusable | null;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._onPrerenderBound = (): void => {\n\t\t\tthis.onPrerender();\n\t\t};\n\n\t\tthis._align = toEnum( options?.align ?? DMenuAlign.BOTTOM, DMenuAlign );\n\t\tthis._fit = ( options?.fit ?? false );\n\t\tthis._sticky = ( options?.sticky ?? false );\n\t\tthis._sub = false;\n\t\tthis._owner = null;\n\t\tthis._context = null;\n\t\tthis.visible = false;\n\t\tthis.state.isFocusRoot = true;\n\n\t\t// Event handlers\n\t\tUtilClickOutside.apply( this, (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\tthis.on( \"select\", (): void => {\n\t\t\tthis.close();\n\t\t});\n\n\t\t// Items\n\t\tconst items = options?.items;\n\t\tif( items ) {\n\t\t\tDMenus.newItems( this, items, this._sticky );\n\t\t}\n\n\t\t// Overlay\n\t\tthis._overlay = new UtilOverlay( options );\n\t}\n\n\tfindItem( value: VALUE ): DMenuItem<VALUE> | null {\n\t\tconst children = this.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DMenuItem && child.value === value ) {\n\t\t\t\treturn child;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenu\";\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen( owner: DBase<any, any>, closeable?: Closeable | null, context?: DMenuContext | null ): this {\n\t\tif( this.isHidden() ) {\n\t\t\tconst layer = this._overlay.pick( this );\n\t\t\tthis._owner = owner;\n\n\t\t\t// States\n\t\t\tconst children = this.children;\n\t\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\t\tconst child = children[ i ];\n\t\t\t\tif( child instanceof DBase ) {\n\t\t\t\t\tchild.state.removeAll( DBaseState.FOCUSED, DBaseState.HOVERED );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Position & size\n\t\t\tconst renderer = layer.renderer;\n\t\t\tconst onPrerenderBound = this._onPrerenderBound;\n\t\t\tif( this._sticky ) {\n\t\t\t\trenderer.on( \"prerender\", onPrerenderBound );\n\t\t\t} else {\n\t\t\t\trenderer.once( \"prerender\", onPrerenderBound );\n\t\t\t}\n\t\t\tif( this._fit ) {\n\t\t\t\tconst bounds = owner.getBounds();\n\t\t\t\tif( bounds != null ) {\n\t\t\t\t\tthis.width = bounds.width;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\t// Target\n\t\t\tthis._sub = (context != null);\n\t\t\tcontext = context || new DMenuContext( owner );\n\t\t\tif( closeable != null ) {\n\t\t\t\tcontext.trim( closeable );\n\t\t\t}\n\t\t\tcontext.add( this );\n\t\t\tthis._context = context;\n\n\t\t\t// Stage\n\t\t\tlayer.stage.addChild( this );\n\n\t\t\t// Focus\n\t\t\tthis._focused = layer.getFocusController().get();\n\t\t\tthis.focus();\n\n\t\t\t// Show\n\t\t\tsuper.show();\n\n\t\t\t// Event\n\t\t\tthis.emit( \"open\", this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tprotected onPrerender(): void {\n\t\tconst owner = this._owner;\n\t\tif( owner ) {\n\t\t\tconst bounds = owner.getBounds();\n\t\t\tif( bounds ) {\n\t\t\t\tif( this._fit ) {\n\t\t\t\t\tthis.width = bounds.width;\n\t\t\t\t}\n\t\t\t\tconst layer = this._overlay.picked;\n\t\t\t\tif( layer ) {\n\t\t\t\t\tconst theme = this.theme;\n\t\t\t\t\tUtilAttach.attach(\n\t\t\t\t\t\tthis,\n\t\t\t\t\t\tbounds,\n\t\t\t\t\t\ttheme.getOffsetX(), theme.getOffsetY(),\n\t\t\t\t\t\tlayer.width, layer.height,\n\t\t\t\t\t\tthis._align\n\t\t\t\t\t);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tclose(): this {\n\t\tif( this.isShown() ) {\n\t\t\t// Remove from the context\n\t\t\tconst context = this._context;\n\t\t\tif( context ) {\n\t\t\t\tcontext.remove( this );\n\t\t\t}\n\n\t\t\t// Remove the prerender event handler\n\t\t\tconst layer = this._overlay.picked;\n\t\t\tif( layer ) {\n\t\t\t\tlayer.renderer.off( \"prerender\", this._onPrerenderBound );\n\t\t\t}\n\n\t\t\t// Forget the owner\n\t\t\tthis._owner = null;\n\n\t\t\t// Restore the focus\n\t\t\tconst focused = this._focused;\n\t\t\tif( focused != null ) {\n\t\t\t\tthis._focused = null;\n\t\t\t\tif( layer ) {\n\t\t\t\t\tlayer.getFocusController().focus( focused );\n\t\t\t\t} else {\n\t\t\t\t\tthis.blur( true );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tthis.blur( true );\n\t\t\t}\n\n\t\t\t// Visibility\n\t\t\tsuper.hide();\n\n\t\t\t// Remove from the tree\n\t\t\tconst parent = this.parent;\n\t\t\tif( parent ) {\n\t\t\t\tparent.removeChild( this );\n\t\t\t}\n\n\t\t\t// Emit the event\n\t\t\tthis.emit( \"close\", this );\n\t\t}\n\t\treturn this;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tUtilKeyboardEvent.moveFocusVertically( e, this, this._overlay );\n\t\tif( this.state.isActionable && (UtilKeyboardEvent.isArrowLeftKey( e ) || UtilKeyboardEvent.isCancelKey( e )) ) {\n\t\t\tthis.close();\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected containsGlobalPoint( point: Point ): boolean {\n\t\treturn ! this._sub;\n\t}\n}\n\nDMenus.setMenuCreator( ( options?: DMenuOptions<any> ) => new DMenu<any>( options ) );\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButtonBase, DButtonBaseEvents, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\nimport { DMenu, DMenuOptions, DThemeMenu } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\n/**\n * {@link DDropdownBase} events.\n */\nexport interface DDropdownBaseEvents<VALUE, TEXT_VALUE, EMITTER> extends DButtonBaseEvents<VALUE, EMITTER> {\n\n}\n\n/**\n * {@link DDropdownBase} \"on\" options.\n */\nexport interface DDropdownBaseOnOptions<VALUE, TEXT_VALUE, EMITTER>\n\textends Partial<DDropdownBaseEvents<VALUE, TEXT_VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DDropdownBase} options.\n */\nexport interface DDropdownBaseOptions<\n\tVALUE = unknown,\n\tTEXT_VALUE = string,\n\tTHEME extends DThemeDropdownBase<TEXT_VALUE> = DThemeDropdownBase<TEXT_VALUE>,\n\tEMITTER = any\n> extends DButtonBaseOptions<TEXT_VALUE, THEME, EMITTER> {\n\t/**\n\t * Menu options.\n\t */\n\tmenu?: DMenuOptions<VALUE> | DMenu<VALUE>;\n\n\ton?: DDropdownBaseOnOptions<VALUE, TEXT_VALUE, EMITTER>;\n}\n\n/**\n * {@link DDropdownBase} theme.\n */\nexport interface DThemeDropdownBase<TEXT_VALUE = unknown> extends DThemeButtonBase<TEXT_VALUE> {\n\n}\n\n/**\n * A dropdown base class.\n */\nexport class DDropdownBase<\n\tVALUE = unknown,\n\tTEXT_VALUE = string,\n\tTHEME extends DThemeDropdownBase<TEXT_VALUE> = DThemeDropdownBase<TEXT_VALUE>,\n\tOPTIONS extends DDropdownBaseOptions<VALUE, TEXT_VALUE, THEME> = DDropdownBaseOptions<VALUE, TEXT_VALUE, THEME>\n> extends DButtonBase<TEXT_VALUE, THEME, OPTIONS> {\n\tprotected _menu?: DMenu<VALUE>;\n\tprotected _onMenuSelectBound?: ( selected: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ) => void;\n\tprotected _onMenuCloseBound?: () => void;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tthis.emit( \"select\", value, item, this );\n\t}\n\n\tprotected onMenuClose(): void {\n\t\tconst menu = this.menu;\n\t\tconst onMenuSelectBound = this._onMenuSelectBound;\n\t\tif( onMenuSelectBound ) {\n\t\t\tmenu.off( \"select\", onMenuSelectBound );\n\t\t}\n\t\tconst onMenuCloseBound = this._onMenuCloseBound;\n\t\tif( onMenuCloseBound ) {\n\t\t\tmenu.off( \"close\", onMenuCloseBound );\n\t\t}\n\t}\n\n\tprotected toMenu( theme: THEME, options?: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options?.menu;\n\t\tif( menu instanceof DMenu ) {\n\t\t\treturn menu;\n\t\t}\n\t\treturn new DMenu<VALUE>( this.toMenuOptions( theme, menu ) );\n\t}\n\n\tprotected toMenuOptions( theme: THEME, options?: DMenuOptions<VALUE> ): DMenuOptions<VALUE, DThemeMenu> {\n\t\tif( options ) {\n\t\t\tif( options.fit == null ) {\n\t\t\t\toptions.fit = true;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tfit: true\n\t\t};\n\t}\n\n\tget menu(): DMenu<VALUE> {\n\t\tlet result = this._menu;\n\t\tif( result == null ) {\n\t\t\tresult = this.toMenu( this.theme, this._options );\n\t\t\tthis._menu = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DDropdownBase\";\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isArrowDownKey( e ) ) {\n\t\t\tthis.onKeyDownArrowDown( e );\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onKeyDownArrowDown( e: KeyboardEvent ): boolean {\n\t\tif( this.state.isActionable && this.state.isFocused ) {\n\t\t\tthis.onClick( e );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tthis.start();\n\t}\n\n\tstart(): void {\n\t\tconst menu = this.menu;\n\t\tif( menu.isHidden() ) {\n\t\t\t// In the case that the menu is created elsewhere,\n\t\t\t// the menu might be opened by other UI elements\n\t\t\t// and the `select` event might be triggered. In\n\t\t\t// that case, we are not supposed to catct that\n\t\t\t// `select` event. This is why the `select` event\n\t\t\t// handler is registered here. Instead of the\n\t\t\t// initialization time.\n\t\t\tlet onMenuSelectBound = this._onMenuSelectBound;\n\t\t\tif( onMenuSelectBound == null ) {\n\t\t\t\tonMenuSelectBound = ( value: VALUE, item: DMenuItem<VALUE>, m: DMenu<VALUE> ): void => {\n\t\t\t\t\tthis.onMenuSelect( value, item, m );\n\t\t\t\t};\n\t\t\t\tthis._onMenuSelectBound = onMenuSelectBound;\n\t\t\t}\n\t\t\tlet onMenuCloseBound = this._onMenuCloseBound;\n\t\t\tif( onMenuCloseBound == null ) {\n\t\t\t\tonMenuCloseBound = (): void => {\n\t\t\t\t\tthis.onMenuClose();\n\t\t\t\t};\n\t\t\t}\n\t\t\tmenu.on( \"select\", onMenuSelectBound );\n\t\t\tmenu.on( \"close\", onMenuCloseBound );\n\t\t\tmenu.open( this );\n\t\t}\n\t}\n\n\tclose(): void {\n\t\tthis.menu.close();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, utils } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DListItem, DListItemSelection } from \"./d-list-item\";\nimport { DMenu } from \"./d-menu\";\nimport { isString } from \"./util/is-string\";\n\nexport enum DMenuSidedSelectionMode {\n\tNONE,\n\tSINGLE,\n\tSINGLE_ONCE,\n\tDEFAULT = SINGLE_ONCE\n}\n\n/**\n * {@link DMenuSidedSelection} events.\n */\nexport interface DMenuSidedSelectionEvents<EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param emitter an emitter\n\t */\n\tchange( emitter: EMITTER ): void;\n}\n\n/**\n * {@link DMenuSidedSelection} \"on\" options.\n */\nexport interface DMenuSidedSelectionOnOptions<EMITTER> extends Partial<DMenuSidedSelectionEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DMenuSidedSelection} options.\n */\nexport interface DMenuSidedSelectionOptions<EMITTER = any> {\n\tmode?: (keyof typeof DMenuSidedSelectionMode) | DMenuSidedSelectionMode;\n\ton?: DMenuSidedSelectionOnOptions<EMITTER>;\n\tfilter?: ( item: DBase | null ) => boolean;\n}\n\nconst defaultFilter = () => true;\n\nexport class DMenuSidedSelection extends utils.EventEmitter implements DListItemSelection {\n\tprotected _content: Container;\n\tprotected _item: DBase | null;\n\tprotected _isDirty: boolean;\n\tprotected _mode: DMenuSidedSelectionMode;\n\tprotected _filter: ( item: DBase | null ) => boolean;\n\n\tconstructor( content: Container, options?: DMenuSidedSelectionOptions ) {\n\t\tsuper();\n\n\t\tthis._content = content;\n\t\tthis._item = null;\n\t\tthis._isDirty = true;\n\t\tthis._mode = ( options && options.mode != null ?\n\t\t\t(isString( options.mode ) ? DMenuSidedSelectionMode[ options.mode ] : options.mode) :\n\t\t\tDMenuSidedSelectionMode.DEFAULT\n\t\t);\n\t\tthis._filter = ( options && options.filter ) || this.getFilterDefault();\n\n\t\t// Events\n\t\tconst on = options && options.on;\n\t\tif( on ) {\n\t\t\tfor( const name in on ) {\n\t\t\t\tconst handler = on[ name ];\n\t\t\t\tif( handler ) {\n\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\ttoDirty() {\n\t\tthis._isDirty = true;\n\t}\n\n\tupdate() {\n\t\tif( this._isDirty ) {\n\t\t\tthis._isDirty = false;\n\t\t\tthis.update_( this._content );\n\t\t}\n\t}\n\n\tprotected hasMenu( child: any ): child is { menu: DMenu<any> } {\n\t\treturn child && child.menu instanceof DMenu;\n\t}\n\n\tprotected update_( root: Container ): void {\n\t\tconst children = root.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DListItem ) {\n\t\t\t\tif( child.state.isActive ) {\n\t\t\t\t\tthis.set_( child, false );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tif( child instanceof Container ) {\n\t\t\t\tthis.update_( child );\n\t\t\t}\n\n\t\t\tif( this.hasMenu( child ) ) {\n\t\t\t\tthis.update_( child.menu );\n\t\t\t}\n\t\t}\n\t}\n\n\tadd( item: DBase ): void {\n\t\tthis.update();\n\t\tthis.set_( item, true );\n\t}\n\n\tset( item: DBase ): void {\n\t\tthis.update();\n\t\tthis.set_( item, true );\n\t}\n\n\tget(): DBase | null {\n\t\tthis.update();\n\t\treturn this._item;\n\t}\n\n\tsize(): number {\n\t\treturn ( this._item ? 1 : 0 );\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._item == null;\n\t}\n\n\tremove( item: DBase ): void {\n\t\tthis.update();\n\t\tif( this._item === item ) {\n\t\t\tthis.set_( null, true );\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tthis.update();\n\t\tthis.set_( null, true );\n\t}\n\n\tprotected getFilterDefault(): ( item: DBase | null ) => boolean {\n\t\treturn defaultFilter;\n\t}\n\n\tprotected set_( item: DBase | null, emit: boolean ): void {\n\t\tconst oldItem = this._item;\n\t\tconst mode = this._mode;\n\t\tif( mode !== DMenuSidedSelectionMode.NONE && this._filter( item ) && oldItem !== item ) {\n\t\t\tthis.setState( oldItem, mode, false );\n\t\t\tthis._item = item;\n\t\t\tthis.setState( item, mode, true );\n\t\t\tif( emit ) {\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected setState( item: DBase | null, mode: DMenuSidedSelectionMode, isOn: boolean ): void {\n\t\tif( item ) {\n\t\t\tif( mode === DMenuSidedSelectionMode.SINGLE ) {\n\t\t\t\titem.state.isActive = isOn;\n\t\t\t} else {\n\t\t\t\tif( isOn ) {\n\t\t\t\t\titem.state.addAll( DBaseState.ACTIVE, DBaseState.READ_ONLY );\n\t\t\t\t} else {\n\t\t\t\t\titem.state.removeAll( DBaseState.ACTIVE, DBaseState.READ_ONLY );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDropdownBase, DDropdownBaseOptions, DThemeDropdownBase } from \"./d-dropdown-base\";\n\n/**\n * Dropdown options.\n */\nexport interface DDropdownOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeDropdown = DThemeDropdown\n> extends DDropdownBaseOptions<VALUE, string, THEME> {\n\n}\n\n/**\n * A dropdown theme.\n */\nexport interface DThemeDropdown extends DThemeDropdownBase<string> {\n\n}\n\nexport class DDropdown<\n\tVALUE = unknown,\n\tTHEME extends DThemeDropdown = DThemeDropdown,\n\tOPTIONS extends DDropdownOptions<VALUE, THEME> = DDropdownOptions<VALUE, THEME>\n> extends DDropdownBase<VALUE, string, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DDropdown\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DExpandableHeaderOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeExpandableHeader<VALUE> = DThemeExpandableHeader<VALUE>\n> extends DImageOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeExpandableHeader<VALUE = unknown> extends DThemeImage<VALUE> {\n\n}\n\nexport class DExpandableHeader<\n\tVALUE = unknown,\n\tTHEME extends DThemeExpandableHeader<VALUE> = DThemeExpandableHeader<VALUE>,\n\tOPTIONS extends DExpandableHeaderOptions<VALUE, THEME> = DExpandableHeaderOptions<VALUE, THEME>\n> extends DImage<VALUE, THEME, OPTIONS> {\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( this.state.isActionable ) {\n\t\t\t\tthis.onSelect( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onSelect( e: KeyboardEvent | interaction.InteractionEvent ) {\n\t\tthis.emit( \"select\", this );\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onKeyDownActivate( e );\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onKeyDownActivate( e: KeyboardEvent ): boolean {\n\t\tif( this.state.isActionable && this.state.isFocused ) {\n\t\t\tthis.onSelect( e );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DExpandableHeader\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, DisplayObject } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DExpandableHeader, DExpandableHeaderOptions } from \"./d-expandable-header\";\nimport { DLayoutVertical, DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DExpandableOptions<\n\tTHEME extends DThemeExpandable = DThemeExpandable\n> extends DLayoutVerticalOptions<THEME> {\n\theader?: DisplayObject | DExpandableHeaderOptions;\n\tbody: Container;\n}\n\nexport interface DThemeExpandable extends DThemeLayoutVertical {\n\n}\n\nexport class DExpandable<\n\tTHEME extends DThemeExpandable = DThemeExpandable,\n\tOPTIONS extends DExpandableOptions<THEME> = DExpandableOptions<THEME>\n> extends DLayoutVertical<THEME, OPTIONS> {\n\tprotected _header!: DisplayObject;\n\tprotected _body!: Container;\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\t// Header\n\t\tconst theme = this.theme;\n\t\tconst header = this.toHeader( theme, options );\n\t\tthis._header = header;\n\t\theader.on( \"select\", (): void => {\n\t\t\tthis.toggle();\n\t\t});\n\t\tthis.addChild( header );\n\n\t\t// Body\n\t\tconst body = this.toBody( theme, options );\n\t\tthis._body = body;\n\t\tthis.addChild( body );\n\n\t\t//\n\t\tif( this.state.isActive ) {\n\t\t\tthis.onActivated();\n\t\t} else {\n\t\t\tthis.onDeactivated();\n\t\t}\n\t}\n\n\tprotected toHeader( theme: THEME, options?: OPTIONS ): DisplayObject {\n\t\tif( options && options.header ) {\n\t\t\tif( options.header instanceof DisplayObject ) {\n\t\t\t\treturn options.header;\n\t\t\t} else {\n\t\t\t\treturn this.newHeader( theme, options.header );\n\t\t\t}\n\t\t}\n\t\treturn this.newHeader( theme );\n\t}\n\n\tprotected newHeader( theme: THEME, options?: DExpandableHeaderOptions ): DisplayObject {\n\t\treturn new DExpandableHeader( options );\n\t}\n\n\tprotected toBody( theme: THEME,  options: OPTIONS ): Container {\n\t\treturn options.body;\n\t}\n\n\topen(): void {\n\t\tthis.state.isActive = true;\n\t}\n\n\tclose(): void {\n\t\tthis.state.isActive = false;\n\t}\n\n\ttoggle(): void {\n\t\tthis.state.isActive = ! this.state.isActive;\n\t}\n\n\tprotected onActivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.show();\n\t\t} else {\n\t\t\tbody.visible = true;\n\t\t}\n\t}\n\n\tprotected onDeactivated(): void {\n\t\tconst body = this._body;\n\t\tif( body instanceof DBase ) {\n\t\t\tbody.hide();\n\t\t} else {\n\t\t\tbody.visible = false;\n\t\t}\n\t}\n\n\tprotected onStateChange( newState: DBaseStateSet, oldState: DBaseStateSet ): void {\n\t\tsuper.onStateChange( newState, oldState );\n\n\t\tif( newState.isActive ) {\n\t\t\tif( ! oldState.isActive ) {\n\t\t\t\tthis.onActivated();\n\t\t\t}\n\t\t} else {\n\t\t\tif( oldState.isActive ) {\n\t\t\t\tthis.onDeactivated();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DExpandable\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputAndLabel, DInputAndLabelOptions, DThemeInputAndLabel } from \"./d-input-and-label\";\nimport { DInputInteger, DInputIntegerOptions, DThemeInputInteger } from \"./d-input-integer\";\n\nexport interface DInputIntegerAndLabelOptions<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel\n> extends DInputAndLabelOptions<DInputIntegerOptions, THEME> {}\n\nexport class DInputIntegerAndLabel<\n\tTHEME extends DThemeInputAndLabel = DThemeInputAndLabel,\n\tOPTIONS extends DInputIntegerAndLabelOptions<THEME> = DInputIntegerAndLabelOptions<THEME>\n> extends DInputAndLabel<DInputInteger, DInputIntegerOptions, THEME, OPTIONS> {\n\tprotected createInput( options?: DInputIntegerOptions<DThemeInputInteger> ): DInputInteger {\n\t\treturn new DInputInteger( options );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMapCoordinate, DMapPoint } from \"./d-map-coordinate\";\n\nexport class DMapCoordinateEPSG3857 implements DMapCoordinate {\n\tprotected static CIRCUMFERENCE_HALF: number = Math.PI * 6378137 /* Approximate earth radius in meter */;\n\tprotected _tileSize: number;\n\n\tconstructor( tileSize: number = 256 ) {\n\t\tthis._tileSize = tileSize;\n\t}\n\n\tgetTileSize(): number {\n\t\treturn this._tileSize;\n\t}\n\n\t/**\n\t * Converts the given (lon, lat) point in WGS84 to (x, y) in EPSG:900913.\n\t * The origin of the converted point (x, y) is at the middle-left corner.\n\t * The `meters` can be the same instance that is passed in as the `lonlat`.\n\t *\n\t * @param lonlat (lon, lat) point\n\t * @param meters (x, y) point in meters converted from the given lonlat.\n\t * @return (x, y) point in meters\n\t * @see https://www.maptiler.com/google-maps-coordinates-tile-bounds-projection/\n\t * @see https://qiita.com/MALORGIS/items/1a9114dd090e5b891bf7\n\t */\n\tlonLatToMeters( lonlat: DMapPoint, meters: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = lonlat.x * C / 180;\n\t\tmeters.y = Math.log( Math.tan( ( 90 + lonlat.y ) * Math.PI / 360 ) ) * C / Math.PI;\n\t\treturn meters;\n\t}\n\n\t/**\n\t * The `lonlat` can be the same instance that is passed in as the `meters`.\n\t *\n\t * @param meters\n\t * @param lonlat\n\t */\n\tmetersToLonLat( meters: DMapPoint, lonlat: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tlonlat.x = meters.x / C * 180;\n\t\tlonlat.y = Math.atan( Math.exp( meters.y * Math.PI / C ) ) * 360 / Math.PI - 90;\n\t\treturn lonlat;\n\t}\n\n\t/**\n\t * Converts pixel coordinates in given zoom level of pyramid to EPSG:900913.\n\t * The origin of the `pixels` is the top-left corner.\n\t * The `meters` can be the same instance that is passed in as the `pixels`.\n\t */\n\tpixelsToMeters( pixels: DMapPoint, tz: number, tileSize: number, meters: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolution( tz, tileSize );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = pixels.x * R - C;\n\t\tmeters.y = C - pixels.y * R;\n\t\treturn meters;\n\t}\n\n\t/**\n\t * Converts EPSG:900913 to pyramid pixel coordinates in given zoom level.\n\t * The origin of the pixels is the top-left corner.\n\t * The `pixels` can be the same instance that is passed in as the `meters`.\n\t */\n\tmetersToPixels( meters: DMapPoint, tz: number, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolution( tz, tileSize );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tpixels.x = ( meters.x + C ) / R;\n\t\tpixels.y = ( C - meters.y ) / R;\n\t\treturn pixels;\n\t}\n\n\t/**\n\t * Returns a tile covering region in given pixel coordinates.\n\t * The origin of the tile is the top-left corner.\n\t * The `tile` can be the same instance that is passed in as the `pixels`.\n\t */\n\tpixelsToTile( pixels: DMapPoint, tileSize: number, tile: DMapPoint ): DMapPoint {\n\t\ttile.x = Math.ceil( pixels.x / tileSize ) - 1;\n\t\ttile.y = Math.ceil( pixels.y / tileSize ) - 1;\n\t\treturn tile;\n\t}\n\n\t/**\n\t * The origin of the tile is the top-left corner.\n\t * The `tile` can be the same instance that is passed in as the `meters`.\n\t */\n\tmetersToTile( meters: DMapPoint, tz: number, tile: DMapPoint ): DMapPoint {\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tconst Z = 1 << tz;\n\t\ttile.x = Math.ceil( 0.5 * ( meters.x / C + 1 ) * Z ) - 1;\n\t\ttile.y = Math.ceil( 0.5 * ( 1 - meters.y / C ) * Z ) - 1;\n\t\treturn tile;\n\t}\n\n\tlonLatToTile( lonlat: DMapPoint, tz: number, tile: DMapPoint ): DMapPoint {\n\t\treturn this.metersToTile( this.lonLatToMeters( lonlat, tile ), tz, tile );\n\t}\n\n\tlonLatToPixels( lonlat: DMapPoint, tz: number, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\treturn this.metersToPixels( this.lonLatToMeters( lonlat, pixels ), tz, tileSize, pixels );\n\t}\n\n\tpixelsToLonLat( pixels: DMapPoint, tz: number, tileSize: number, lonlat: DMapPoint ): DMapPoint {\n\t\treturn this.metersToLonLat( this.pixelsToMeters( pixels, tz, tileSize, lonlat ), lonlat );\n\t}\n\n\t/**\n\t * The `pixels` can be the same instance that is passed in as the `tile`.\n\t */\n\ttileToPixels( tile: DMapPoint, tileSize: number, pixels: DMapPoint ): DMapPoint {\n\t\tpixels.x = tile.x * tileSize;\n\t\tpixels.y = tile.y * tileSize;\n\t\treturn pixels;\n\t}\n\n\t/**\n\t * Returns bounds of the given tile in EPSG:900913 coordinates\n\t * The `meters` can be the same instance that is passed in as the `tile`.\n\t */\n\ttileToMeters( tile: DMapPoint, tz: number, meters: DMapPoint ): DMapPoint {\n\t\tconst R = this.toResolutionMeter( tz );\n\t\tconst C = DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF;\n\t\tmeters.x = tile.x * R + C;\n\t\tmeters.y = C - tile.y * R;\n\t\treturn meters;\n\t}\n\n\tprotected toResolutionMeter( tz: number ): number {\n\t\treturn ( 2 * DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF ) / ( 1 << tz );\n\t}\n\n\tprotected toResolution( tz: number, tileSize: number ): number {\n\t\treturn ( 2 * DMapCoordinateEPSG3857.CIRCUMFERENCE_HALF ) / ( tileSize << tz );\n\t}\n\n\ttoTileCount( tz: number ): number {\n\t\treturn (1 << tz);\n\t}\n\n\ttoTileCode( tz: number, tx: number, ty: number ): number {\n\t\treturn (tx << tz) + ty;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapCoordinateEPSG3857 } from \"./d-map-coordinate-epsg3857\";\n\nexport class DMapCoordinates {\n\tprotected static _default?: DMapCoordinate;\n\n\tstatic get DEFAULT(): DMapCoordinate {\n\t\tif( this._default == null ) {\n\t\t\tthis._default = new DMapCoordinateEPSG3857();\n\t\t}\n\t\treturn this._default;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Container, Renderer, resources, Sprite, Texture } from \"pixi.js\";\n\nexport class DMapTile {\n\ttx: number;\n\tty: number;\n\n\tprotected _sprite: Sprite;\n\n\tconstructor(\n\t\tparent: Container,\n\t\ttx: number, ty: number,\n\t\tpx: number, py: number,\n\t\tscale: number\n\t) {\n\t\tthis.tx = tx;\n\t\tthis.ty = ty;\n\t\tconst sprite = new Sprite( Texture.EMPTY );\n\t\t(sprite as any).parent = parent;\n\t\tsprite.position.set( px, py );\n\t\tsprite.scale.set( scale, scale );\n\t\tthis._sprite = sprite;\n\t}\n\n\tload( url: string, onLoaded: () => void ): void {\n\t\tconst texture = Texture.from( url, { resolution: 1 } );\n\t\tthis._sprite.texture = texture;\n\t\tif( texture.valid ) {\n\t\t\tonLoaded();\n\t\t} else {\n\t\t\ttexture.on( \"update\", onLoaded );\n\t\t}\n\t}\n\n\ttransform( px: number, py: number, scale: number ): void {\n\t\tconst sprite = this._sprite;\n\t\tsprite.position.set( px, py );\n\t\tsprite.scale.set( scale, scale );\n\t}\n\n\tget loaded(): boolean {\n\t\treturn this._sprite.texture.valid;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tconst sprite = this._sprite;\n\t\tsprite.updateTransform();\n\t\tsprite.render( renderer );\n\t}\n\n\tdestroy(): void {\n\t\tconst sprite = this._sprite;\n\t\tconst texture = sprite.texture;\n\t\tconst resource = texture.baseTexture.resource;\n\t\tlet image: HTMLImageElement | null = null;\n\t\tif( resource instanceof resources.BaseImageResource ) {\n\t\t\tif( resource.source instanceof HTMLImageElement ) {\n\t\t\t\timage = resource.source;\n\t\t\t}\n\t\t}\n\t\ttexture.destroy( true );\n\t\tsprite.destroy();\n\t\tif( image ) {\n\t\t\timage.src = \"\";\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Renderer } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapTile } from \"./d-map-tile\";\nimport { DMapTileMappingInternal } from \"./d-map-tile-mapping-internal\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport class DMapTilePlane {\n\tprotected static WORK: Point = new Point();\n\n\tprotected readonly _parent: DBase;\n\tprotected readonly _builder: DMapTileUrlBuilder;\n\tprotected readonly _tz: number;\n\tprotected _lon0: number;\n\tprotected _lat0: number;\n\tprotected _lon1: number;\n\tprotected _lat1: number;\n\tprotected readonly _tiles: Map<number, DMapTile>;\n\tprotected _renderer?: Renderer;\n\tprotected readonly _renderTileBound: ( tile: DMapTile ) => void;\n\tprotected _txmin: number;\n\tprotected _txmax: number;\n\tprotected _tymin: number;\n\tprotected _tymax: number;\n\tprotected readonly _deleteTileBound: ( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ) => void;\n\tprotected readonly _destroyTileBound: ( tile: DMapTile ) => void;\n\tprotected _tileCount: number;\n\tprotected _tileScale: number;\n\tprotected _tileScaleRelative: number;\n\tprotected _tileSize: number;\n\tprotected _mapping: DMapTileMappingInternal;\n\tprotected _coordinate: DMapCoordinate;\n\tprotected _isLoaded: boolean;\n\tprotected readonly _updateLoadingStateForEach: ( tile: DMapTile ) => void;\n\tprotected readonly _onLoaded: () => void;\n\tprotected readonly _onLoadedBound: () => void;\n\tprotected _isOnLoadedCalled: boolean;\n\tprotected _isOnLoadedAllowed: boolean;\n\n\tconstructor(\n\t\tparent: DBase,\n\t\tbuilder: DMapTileUrlBuilder,\n\t\ttz: number,\n\t\tmapping: DMapTileMappingInternal,\n\t\tcoordinate: DMapCoordinate,\n\t\tonLoaded: () => void\n\t) {\n\t\tthis._parent = parent;\n\t\tthis._builder = builder;\n\t\tthis._onLoaded = onLoaded;\n\t\tthis._isOnLoadedCalled = false;\n\t\tthis._isOnLoadedAllowed = true;\n\t\tthis._onLoadedBound = (): void => {\n\t\t\tthis.onLoaded();\n\t\t};\n\t\tthis._tz = tz;\n\t\tthis._lon0 = NaN;\n\t\tthis._lat0 = NaN;\n\t\tthis._lon1 = NaN;\n\t\tthis._lat1 = NaN;\n\t\tthis._tiles = new Map<number, DMapTile>();\n\t\tthis._renderTileBound = ( tile: DMapTile ): void => {\n\t\t\tthis.renderTile( tile );\n\t\t};\n\t\tthis._txmin = NaN;\n\t\tthis._txmax = NaN;\n\t\tthis._tymin = NaN;\n\t\tthis._tymax = NaN;\n\t\tthis._deleteTileBound = ( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ): void => {\n\t\t\tthis.deleteTile( tile, tileCode, tiles );\n\t\t};\n\t\tthis._destroyTileBound = ( tile: DMapTile ): void => {\n\t\t\tthis.destroyTile( tile );\n\t\t};\n\t\tthis._updateLoadingStateForEach = ( tile: DMapTile ): void => {\n\t\t\tif( ! tile.loaded ) {\n\t\t\t\tthis._isLoaded = false;\n\t\t\t}\n\t\t};\n\t\tthis._tileCount = coordinate.toTileCount( tz );\n\t\tthis._tileScaleRelative = 1 / this._tileCount;\n\t\tthis._tileScale = mapping.scale * this._tileScaleRelative;\n\t\tthis._tileSize = coordinate.getTileSize() * mapping.scale;\n\t\tthis._mapping = mapping;\n\t\tthis._coordinate = coordinate;\n\t\tthis._isLoaded = true;\n\t}\n\n\tprotected newTile( tx: number, ty: number, px: number, py: number, scale: number ): DMapTile {\n\t\treturn new DMapTile( this._parent, tx, ty, px, py, scale );\n\t}\n\n\tprotected renderTile( tile: DMapTile ): void {\n\t\ttile.render( this._renderer! );\n\t}\n\n\tget tz(): number {\n\t\treturn this._tz;\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tthis._renderer = renderer;\n\t\tthis._tiles.forEach( this._renderTileBound );\n\t}\n\n\tmove( lon0: number, lat0: number, lon1: number, lat1: number ): void {\n\t\tconst oldLon0 = this._lon0;\n\t\tconst oldLat0 = this._lat0;\n\t\tconst oldLon1 = this._lon1;\n\t\tconst oldLat1 = this._lat1;\n\t\tif( oldLon0 !== lon0 || oldLat0 !== lat0 || oldLon1 !== lon1 || oldLat1 !== lat1 ) {\n\t\t\tthis._lon0 = lon0;\n\t\t\tthis._lat0 = lat0;\n\t\t\tthis._lon1 = lon1;\n\t\t\tthis._lat1 = lat1;\n\n\t\t\tconst tz = this._tz;\n\t\t\tconst coordinate = this._coordinate;\n\n\t\t\tconst work = DMapTilePlane.WORK;\n\t\t\twork.set( lon0, lat0 );\n\t\t\tcoordinate.lonLatToTile( work, tz, work );\n\t\t\tconst tx0 = work.x;\n\t\t\tconst ty0 = work.y;\n\n\t\t\twork.set( lon1, lat1 );\n\t\t\tcoordinate.lonLatToTile( work, tz, work );\n\t\t\tconst tx1 = work.x;\n\t\t\tconst ty1 = work.y;\n\n\t\t\tconst tileCount = this._tileCount;\n\t\t\tlet txmin = Math.max( 0, tx0 );\n\t\t\tlet txmax = Math.min( tileCount - 1, tx1 );\n\t\t\tlet tymin = Math.max( 0, ty0 );\n\t\t\tlet tymax = Math.min( tileCount - 1, ty1 );\n\t\t\tconst dtxmin = txmin - this._txmin;\n\t\t\tconst dtxmax = txmax - this._txmax;\n\t\t\tconst dtymin = tymin - this._tymin;\n\t\t\tconst dtymax = tymax - this._tymax;\n\n\t\t\tconst isTxMinChanged = dtxmin !== dtxmin || dtxmin < 0 || 1 < dtxmin;\n\t\t\tconst isTxMaxChanged = dtxmax !== dtxmax || 0 < dtxmax || dtxmax < -1;\n\t\t\tconst isTyMinChanged = dtymin !== dtymin || dtymin < 0 || 1 < dtymin;\n\t\t\tconst isTyMaxChanged = dtymax !== dtymax || 0 < dtymax || dtymax < -1;\n\t\t\tif( isTxMinChanged || isTxMaxChanged || isTyMinChanged || isTyMaxChanged ) {\n\t\t\t\tif( isTxMinChanged ) {\n\t\t\t\t\tthis._txmin = txmin;\n\t\t\t\t} else {\n\t\t\t\t\ttxmin = this._txmin;\n\t\t\t\t}\n\t\t\t\tif( isTxMaxChanged ) {\n\t\t\t\t\tthis._txmax = txmax;\n\t\t\t\t} else {\n\t\t\t\t\ttxmax = this._txmax;\n\t\t\t\t}\n\t\t\t\tif( isTyMinChanged ) {\n\t\t\t\t\tthis._tymin = tymin;\n\t\t\t\t} else {\n\t\t\t\t\ttymin = this._tymin;\n\t\t\t\t}\n\t\t\t\tif( isTyMaxChanged ) {\n\t\t\t\t\tthis._tymax = tymax;\n\t\t\t\t} else {\n\t\t\t\t\ttymax = this._tymax;\n\t\t\t\t}\n\n\t\t\t\tconst tiles = this._tiles;\n\t\t\t\ttiles.forEach( this._deleteTileBound );\n\n\t\t\t\tconst ctx = (txmin + txmax) >> 1;\n\t\t\t\tconst cty = (tymin + tymax) >> 1;\n\t\t\t\tconst ltx = Math.max( ctx - txmin, txmax - ctx );\n\t\t\t\tconst lty = Math.max( cty - tymin, tymax - cty );\n\t\t\t\tconst lt = Math.max( ltx, lty );\n\n\t\t\t\tthis.toOffset( work );\n\t\t\t\tconst offsetX = work.x;\n\t\t\t\tconst offsetY = work.y;\n\n\t\t\t\tthis._isOnLoadedCalled = false;\n\t\t\t\tthis._isOnLoadedAllowed = false;\n\t\t\t\tthis.loadTile( tz, ctx, cty, offsetX, offsetY, work );\n\t\t\t\tfor( let it = 1; it <= lt; ++it ) {\n\t\t\t\t\tconst txa = ctx - it;\n\t\t\t\t\tif( txmin <= txa ) {\n\t\t\t\t\t\tthis.loadTilesY( tz, txa, cty, it, tymin, tymax, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst txb = ctx + it;\n\t\t\t\t\tif( txb <= txmax ) {\n\t\t\t\t\t\tthis.loadTilesY( tz, txb, cty, it, tymin, tymax, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst tya = cty - it;\n\t\t\t\t\tif( tymin <= tya ) {\n\t\t\t\t\t\tthis.loadTilesX( tz, ctx, it - 1, txmin, txmax, tya, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t\tconst tyb = cty + it;\n\t\t\t\t\tif( tyb <= tymax ) {\n\t\t\t\t\t\tthis.loadTilesX( tz, ctx, it - 1, txmin, txmax, tyb, offsetX, offsetY, work );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tthis._isOnLoadedAllowed = true;\n\t\t\t\tif( this._isOnLoadedCalled ) {\n\t\t\t\t\tthis.onLoaded();\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTilesX(\n\t\ttz: number,\n\t\tctx: number, ltx: number, txmin: number, txmax: number,\n\t\tty: number,\n\t\tox: number, oy: number,\n\t\twork: Point\n\t): void {\n\t\tthis.loadTile( tz, ctx, ty, ox, oy, work );\n\t\tfor( let i = 1; i <= ltx; ++i ) {\n\t\t\tconst txa = ctx - i;\n\t\t\tif( txmin <= txa ) {\n\t\t\t\tthis.loadTile( tz, txa, ty, ox, oy, work );\n\t\t\t}\n\t\t\tconst txb = ctx + i;\n\t\t\tif( txb <= txmax ) {\n\t\t\t\tthis.loadTile( tz, txb, ty, ox, oy, work );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTilesY(\n\t\ttz: number, tx: number,\n\t\tcty: number, lty: number, tymin: number, tymax: number,\n\t\tox: number, oy: number,\n\t\twork: Point\n\t): void {\n\t\tthis.loadTile( tz, tx, cty, ox, oy, work );\n\t\tfor( let i = 1; i <= lty; ++i ) {\n\t\t\tconst tya = cty - i;\n\t\t\tif( tymin <= tya ) {\n\t\t\t\tthis.loadTile( tz, tx, tya, ox, oy, work );\n\t\t\t}\n\t\t\tconst tyb = cty + i;\n\t\t\tif( tyb <= tymax ) {\n\t\t\t\tthis.loadTile( tz, tx, tyb, ox, oy, work );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected loadTile( tz: number, tx: number, ty: number, ox: number, oy: number, work: Point ): void {\n\t\tconst coordinate = this._coordinate;\n\t\tconst tileCode = coordinate.toTileCode( tz, tx, ty );\n\t\tconst tiles = this._tiles;\n\t\tlet tile = tiles.get( tileCode );\n\t\tif( tile == null ) {\n\t\t\tthis.toTilePosition( tx, ty, ox, oy, work );\n\t\t\ttile = this.newTile( tx, ty, work.x, work.y, this._tileScale );\n\t\t\ttiles.set( tileCode, tile );\n\t\t\ttile.load( this._builder( tz, tx, ty ), this._onLoadedBound );\n\t\t\tthis._isLoaded = false;\n\t\t}\n\t}\n\n\tprotected toTilePosition( tx: number, ty: number, ox: number, oy: number, result: Point ): Point {\n\t\tconst tileSize = this._tileSize;\n\t\tconst tileScaleRelative = this._tileScaleRelative;\n\t\tresult.set( tx, ty );\n\t\tthis._coordinate.tileToPixels( result, tileSize, result );\n\t\tresult.set( result.x * tileScaleRelative + ox, result.y * tileScaleRelative + oy );\n\t\treturn result;\n\t}\n\n\tprotected toOffset( result: Point ): Point {\n\t\tconst parent = this._parent;\n\t\tconst mapping = this._mapping;\n\t\tconst tileSize = this._tileSize;\n\t\tresult.set(\n\t\t\t-mapping.x * tileSize + parent.width * 0.5,\n\t\t\t-mapping.y * tileSize + parent.height * 0.5\n\t\t);\n\t\treturn result;\n\t}\n\n\tprotected deleteTile( tile: DMapTile, tileCode: number, tiles: Map<number, DMapTile> ): void {\n\t\tconst tx = tile.tx;\n\t\tconst ty = tile.ty;\n\t\tif( tx < this._txmin || this._txmax < tx || ty < this._tymin || this._tymax < ty ) {\n\t\t\ttiles.delete( tileCode );\n\t\t\ttile.destroy();\n\t\t}\n\t}\n\n\tdestroy(): void {\n\t\tconst tiles = this._tiles;\n\t\ttiles.forEach( this._destroyTileBound );\n\t\ttiles.clear();\n\t}\n\n\tprotected destroyTile( tile: DMapTile ): void {\n\t\ttile.destroy();\n\t}\n\n\tprotected updateLoadingState(): void {\n\t\tthis._isLoaded = true;\n\t\tthis._tiles.forEach( this._updateLoadingStateForEach );\n\t}\n\n\tprotected onLoaded(): void {\n\t\tif( this._isOnLoadedAllowed ) {\n\t\t\tthis._onLoaded();\n\t\t} else {\n\t\t\tthis._isOnLoadedCalled = true;\n\t\t}\n\t}\n\n\tget loaded(): boolean {\n\t\tif( ! this._isLoaded ) {\n\t\t\tthis.updateLoadingState();\n\t\t}\n\t\treturn this._isLoaded;\n\t}\n\n\tget mapping(): DMapTileMappingInternal {\n\t\treturn this._mapping;\n\t}\n\n\tset mapping( mapping: DMapTileMappingInternal ) {\n\t\tconst coordinate = this._coordinate;\n\t\tconst tileScale = mapping.scale * this._tileScaleRelative;\n\t\tconst tileSize = coordinate.getTileSize() * mapping.scale;\n\t\tthis._tileScale = tileScale;\n\t\tthis._tileSize = tileSize;\n\t\tthis._mapping = mapping;\n\n\t\tconst work = DMapTilePlane.WORK;\n\t\tthis.toOffset( work );\n\t\tconst offsetX = work.x;\n\t\tconst offsetY = work.y;\n\n\t\tthis._tiles.forEach(( tile: DMapTile ): void => {\n\t\t\tthis.toTilePosition( tile.tx, tile.ty, offsetX, offsetY, work );\n\t\t\ttile.transform( work.x, work.y, tileScale );\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point, Renderer, utils } from \"pixi.js\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase } from \"./d-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapTileMapping } from \"./d-map-tile-mapping\";\nimport { DMapTileMappingInternal } from \"./d-map-tile-mapping-internal\";\nimport { DMapTilePlane } from \"./d-map-tile-plane\";\nimport { DMapTilePyramid, DMapTilePyramidOptions } from \"./d-map-tile-pyramid\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport class DMapTilePyramidImpl extends utils.EventEmitter implements DMapTilePyramid {\n\tprotected static WORK_LONLAT: Point = new Point();\n\n\tprotected readonly _canvas: DBase;\n\tprotected readonly _builder: DMapTileUrlBuilder;\n\tprotected readonly _planes: Array<DMapTilePlane | undefined>;\n\tprotected _z: number;\n\tprotected _tz: number;\n\tprotected _minZ: number;\n\tprotected _maxZ: number;\n\tprotected _mapping: DMapTileMapping;\n\tprotected _mappingInternal: DMapTileMappingInternal;\n\tprotected _coordinate: DMapCoordinate;\n\tprotected _onLoadedBound: () => void;\n\tprotected _fitBound: () => void;\n\tprotected _fitBoundTimeout: number | undefined;\n\tprotected _fitThrottledBound: () => void;\n\tprotected _fitThrottle: number;\n\n\tconstructor( options: DMapTilePyramidOptions ) {\n\t\tsuper();\n\t\tconst canvas = this._canvas = options.canvas;\n\t\tthis._builder = options.builder;\n\t\tconst mappingLonLat = this._mapping = options.mapping;\n\t\tconst coordinate = this._coordinate = options.coordinate;\n\t\tthis._mappingInternal = this.toMapping( canvas, mappingLonLat, coordinate );\n\t\tthis._z = NaN;\n\t\tthis._tz = NaN;\n\t\tthis._minZ = options.plane.min;\n\t\tthis._maxZ = options.plane.max;\n\t\tthis._planes = [];\n\t\tthis._onLoadedBound = (): void => {\n\t\t\tthis.onLoaded();\n\t\t};\n\t\tthis._fitBound = (): void => {\n\t\t\tthis._fitBoundTimeout = undefined;\n\t\t\tthis.fit();\n\t\t};\n\t\tthis._fitThrottle = options.plane.throttle;\n\t\tconst fitThrottledBound = this._fitThrottledBound = (): void => {\n\t\t\tthis.fitThrottled();\n\t\t};\n\t\tcanvas.on( \"scale\", fitThrottledBound );\n\t\tcanvas.on( \"move\", fitThrottledBound );\n\t\tcanvas.addRenderable( this, true );\n\t}\n\n\tget coordinate(): DMapCoordinate {\n\t\treturn this._coordinate;\n\t}\n\n\tprotected fitThrottled(): void {\n\t\tif( this._fitBoundTimeout == null ) {\n\t\t\tthis._fitBoundTimeout = window.setTimeout( this._fitBound, this._fitThrottle );\n\t\t}\n\t}\n\n\tprotected toMapping( canvas: DBase, mapping: DMapTileMapping, coordinate: DMapCoordinate ): DMapTileMappingInternal {\n\t\tconst work = DMapTilePyramidImpl.WORK_LONLAT;\n\t\tconst tileSize = coordinate.getTileSize();\n\n\t\twork.set( mapping.from.lon, mapping.from.lat );\n\t\tcoordinate.lonLatToPixels( work, 0, tileSize, work );\n\t\tconst x0 = work.x;\n\t\tconst y0 = work.y;\n\n\t\twork.set( mapping.to.lon, mapping.to.lat );\n\t\tcoordinate.lonLatToPixels( work, 0, tileSize, work );\n\t\tconst x1 = work.x;\n\t\tconst y1 = work.y;\n\n\t\tconst dx = Math.abs(x1 - x0);\n\t\tconst dy = Math.abs(y1 - y0);\n\t\tconst dmin = 0.0000001;\n\t\tlet scale = 1;\n\t\tif( dmin < dx ) {\n\t\t\tif( dmin < dy ) {\n\t\t\t\tscale = Math.max( canvas.width / dx, canvas.height / dy );\n\t\t\t} else {\n\t\t\t\tscale = canvas.width / dx;\n\t\t\t}\n\t\t} else {\n\t\t\tif( dmin < dy ) {\n\t\t\t\tscale = canvas.height / dy;\n\t\t\t}\n\t\t}\n\t\treturn {\n\t\t\tscale,\n\t\t\tx: 0.5 * (x1 + x0) / tileSize,\n\t\t\ty: 0.5 * (y1 + y0) / tileSize\n\t\t};\n\t}\n\n\tget mapping(): DMapTileMapping {\n\t\treturn this._mapping;\n\t}\n\n\tset mapping( mapping: DMapTileMapping ) {\n\t\tconst oldMapping = this._mappingInternal;\n\t\tconst newMapping = this.toMapping( this._canvas, mapping, this._coordinate );\n\t\tconst threshold = 0.0000001;\n\t\tif(\n\t\t\tthreshold < Math.abs(oldMapping.scale - newMapping.scale) ||\n\t\t\tthreshold < Math.abs(oldMapping.x - newMapping.x) ||\n\t\t\tthreshold < Math.abs(oldMapping.y - newMapping.y)\n\t\t) {\n\t\t\tthis._mappingInternal = newMapping;\n\n\t\t\tconst planes = this._planes;\n\t\t\tfor( let i = 0, imax = planes.length; i < imax; ++i ) {\n\t\t\t\tconst plane = planes[ i ];\n\t\t\t\tif( plane ) {\n\t\t\t\t\tplane.mapping = newMapping;\n\t\t\t\t}\n\t\t\t}\n\t\t\tDApplications.update( this._canvas );\n\n\t\t\tthis._fitThrottledBound();\n\t\t}\n\t}\n\n\tprotected newPlane( tz: number ): DMapTilePlane {\n\t\treturn new DMapTilePlane(\n\t\t\tthis._canvas,\n\t\t\tthis._builder,\n\t\t\ttz,\n\t\t\tthis._mappingInternal,\n\t\t\tthis._coordinate,\n\t\t\tthis._onLoadedBound\n\t\t);\n\t}\n\n\trender( renderer: Renderer ): void {\n\t\tconst tz = this._tz;\n\t\tconst planes = this._planes;\n\t\tfor( let i = 0; i < tz; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane != null ) {\n\t\t\t\tplane.render( renderer );\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = planes.length - 1; tz < i; --i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane != null ) {\n\t\t\t\tplane.render( renderer );\n\t\t\t}\n\t\t}\n\n\t\tconst planeTz = planes[ tz ];\n\t\tif( planeTz != null ) {\n\t\t\tplaneTz.render( renderer );\n\t\t}\n\t}\n\n\tprotected toTileZ( tz: number ): number {\n\t\treturn Math.min( this._maxZ, Math.max( this._minZ, Math.floor( tz ) ) );\n\t}\n\n\tupdateTransform(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected toZ( scale: number ): number {\n\t\treturn Math.log( this._mappingInternal.scale * scale ) / Math.log( 2 );\n\t}\n\n\tmove( scale: number, lon0: number, lat0: number, lon1: number, lat1: number ): this {\n\t\tconst planes = this._planes;\n\t\tconst z = this.toZ( scale );\n\t\tif( this._z !== z ) {\n\t\t\tthis._z = z;\n\n\t\t\tconst tz = this.toTileZ( z );\n\t\t\tif( this._tz !== tz ) {\n\t\t\t\tthis._tz = tz;\n\n\t\t\t\tlet newPlane = planes[ tz ];\n\t\t\t\tif( newPlane == null ) {\n\t\t\t\t\tnewPlane = this.newPlane( tz );\n\t\t\t\t\tplanes[ tz ] = newPlane;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tconst plane = planes[ this._tz ];\n\t\tif( plane != null ) {\n\t\t\tplane.move( lon0, lat0, lon1, lat1 );\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tfit(): this {\n\t\tconst canvas = this._canvas;\n\t\tif( canvas != null ) {\n\t\t\tconst container = canvas.parent;\n\t\t\tif( container != null ) {\n\t\t\t\tconst scale = canvas.scale;\n\t\t\t\tconst scaleX = scale.x;\n\t\t\t\tconst scaleY = scale.y;\n\t\t\t\tconst x = canvas.x;\n\t\t\t\tconst y = canvas.y;\n\t\t\t\tconst coordinate = this._coordinate;\n\t\t\t\tconst mapping = this._mappingInternal;\n\t\t\t\tconst tileSize = coordinate.getTileSize() * mapping.scale;\n\t\t\t\tconst x0 = mapping.x * tileSize - (x / scaleX + 0.5 * canvas.width);\n\t\t\t\tconst x1 = x0 + container.width / scaleX;\n\t\t\t\tconst y0 = mapping.y * tileSize - (y / scaleY + 0.5 * canvas.height);\n\t\t\t\tconst y1 = y0 + container.height / scaleY;\n\n\t\t\t\tconst work = DMapTilePyramidImpl.WORK_LONLAT;\n\t\t\t\twork.set( x0, y0 );\n\t\t\t\tcoordinate.pixelsToLonLat( work, 0, tileSize, work );\n\t\t\t\tconst lon0 = work.x;\n\t\t\t\tconst lat0 = work.y;\n\n\t\t\t\twork.set( x1, y1 );\n\t\t\t\tcoordinate.pixelsToLonLat( work, 0, tileSize, work );\n\t\t\t\tconst lon1 = work.x;\n\t\t\t\tconst lat1 = work.y;\n\n\t\t\t\tthis.move( scaleX, lon0, lat0, lon1, lat1 );\n\t\t\t}\n\t\t}\n\n\t\treturn this;\n\t}\n\n\tprotected destroyPlanesBefore( tz: number, planes: Array<DMapTilePlane | undefined> ): void {\n\t\tfor( let i = 0; i < tz; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected destroyPlanesAfter( tz: number, planes: Array<DMapTilePlane | undefined> ): void {\n\t\tfor( let i = tz + 1, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected cleanup(): void {\n\t\tconst tz = this._tz;\n\t\tconst planes = this._planes;\n\t\tconst planeTz = planes[ tz ];\n\t\tif( planeTz && planeTz.loaded ) {\n\t\t\tthis.destroyPlanesBefore( tz, planes );\n\t\t\tthis.destroyPlanesAfter( tz, planes );\n\t\t\treturn;\n\t\t}\n\n\t\tfor( let i = tz + 1, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane && plane.loaded ) {\n\t\t\t\tthis.destroyPlanesBefore( tz, planes );\n\t\t\t\tthis.destroyPlanesAfter( i, planes );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\n\t\tfor( let i = tz - 1; 0 <= i; --i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane && plane.loaded ) {\n\t\t\t\tthis.destroyPlanesBefore( i, planes );\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onLoaded(): void {\n\t\tthis.cleanup();\n\t\tDApplications.update( this._canvas );\n\t}\n\n\tdestroy(): this {\n\t\tconst planes = this._planes;\n\t\tfor( let i = 0, imax = planes.length; i < imax; ++i ) {\n\t\t\tconst plane = planes[ i ];\n\t\t\tif( plane ) {\n\t\t\t\tplane.destroy();\n\t\t\t\tplanes[ i ] = undefined;\n\t\t\t}\n\t\t}\n\n\t\tconst canvas = this._canvas;\n\t\tconst fitThrottledBound = this._fitThrottledBound;\n\t\tcanvas.off( \"scale\", fitThrottledBound );\n\t\tcanvas.off( \"move\", fitThrottledBound );\n\t\tcanvas.removeRenderable( this, true );\n\n\t\treturn this;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDiagramCanvasBase } from \"./d-diagram-canvas-base\";\nimport { DMapCoordinate } from \"./d-map-coordinate\";\nimport { DMapCoordinates } from \"./d-map-coordinates\";\nimport { DMapTilePyramid, DMapTilePyramidPlaneOptions } from \"./d-map-tile-pyramid\";\nimport { DMapTilePyramidImpl } from \"./d-map-tile-pyramid-impl\";\nimport { DMapTileUrlBuilder } from \"./d-map-tile-url-builder\";\n\nexport const DMapTileUrlBuilderKokudo: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\tif( 5 <= tz ) {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/pale/${tz}/${tx}/${ty}.png`;\n\t} else if( 2 <= tz ) {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/std/${tz}/${tx}/${ty}.png`;\n\t} else {\n\t\treturn `https://cyberjapandata.gsi.go.jp/xyz/earthhillshade/${tz}/${tx}/${ty}.png`;\n\t}\n};\n\nexport const DMapTileUrlBuilderOsm: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\treturn `https://${\"abc\"[( tx + ty ) % 3]}.tile.openstreetmap.org/${tz}/${tx}/${ty}.png`;\n};\n\nexport const DMapTileUrlBuilderOsmfj: DMapTileUrlBuilder = ( tz: number, tx: number, ty: number ): string => {\n\treturn `https://j.tile.openstreetmap.jp/${tz}/${tx}/${ty}.png`;\n};\n\nexport interface DMapTilePyramidsFromOptions {\n\tcanvas: DDiagramCanvasBase<any, any>;\n\tbuilder?: DMapTileUrlBuilder;\n\tcoordinate?: DMapCoordinate;\n\tplane?: Partial<DMapTilePyramidPlaneOptions>;\n}\n\nexport class DMapTilePyramids {\n\tprotected static MIN: number = 0;\n\tprotected static MAX: number = 18;\n\tprotected static THROTTLE: number = 333;\n\n\tprotected static toPlaneOptions( options: DMapTilePyramidsFromOptions ) {\n\t\tconst plane = options.plane;\n\t\tif( plane ) {\n\t\t\treturn {\n\t\t\t\tmin: ( plane.min != null ? plane.min : this.MIN ),\n\t\t\t\tmax: ( plane.max != null ? plane.max : this.MAX ),\n\t\t\t\tthrottle: ( plane.throttle != null ? plane.throttle : this.THROTTLE )\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tmin: this.MIN,\n\t\t\t\tmax: this.MAX,\n\t\t\t\tthrottle: this.THROTTLE\n\t\t\t};\n\t\t}\n\t}\n\n\tstatic from( options: DMapTilePyramidsFromOptions ): DMapTilePyramid {\n\t\treturn new DMapTilePyramidImpl({\n\t\t\tcanvas: options.canvas,\n\t\t\tbuilder: options.builder || DMapTileUrlBuilderOsmfj,\n\t\t\tmapping: options.canvas.tile.mapping,\n\t\t\tcoordinate: options.coordinate || DMapCoordinates.DEFAULT,\n\t\t\tplane: this.toPlaneOptions( options )\n\t\t});\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DMenuBarItemOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBarItem<VALUE> = DThemeMenuBarItem<VALUE>\n> extends DButtonOptions<VALUE, THEME> {\n\tmenu?: DMenuOptions<VALUE> | DMenu<VALUE>;\n}\n\nexport interface DThemeMenuBarItem<VALUE = unknown> extends DThemeButton<VALUE> {\n\n}\n\nexport class DMenuBarItem<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBarItem<VALUE> = DThemeMenuBarItem<VALUE>,\n\tOPTIONS extends DMenuBarItemOptions<VALUE, THEME> = DMenuBarItemOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected _menu?: DMenu<VALUE>;\n\n\tprotected toMenu( theme: THEME, options?: OPTIONS ): DMenu<VALUE> {\n\t\tconst menu = options?.menu;\n\t\tif( menu instanceof DMenu ) {\n\t\t\treturn menu;\n\t\t} else {\n\t\t\treturn new DMenu( this.toMenuOptions( theme, menu ) );\n\t\t}\n\t}\n\n\tprotected newMenu( theme: THEME, options?: DMenuOptions<VALUE> ): DMenu<VALUE> {\n\t\treturn new DMenu<VALUE>( this.toMenuOptions( theme, options ) );\n\t}\n\n\tprotected toMenuOptions( theme: THEME, options?: DMenuOptions<VALUE> ): DMenuOptions<VALUE> | undefined {\n\t\tif( options ) {\n\t\t\tif( options.fit == null ) {\n\t\t\t\toptions.fit = false;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tfit: false\n\t\t};\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tthis.open();\n\t}\n\n\topen(): void {\n\t\tthis.menu.open( this );\n\t}\n\n\tclose(): void {\n\t\tthis.menu.close();\n\t}\n\n\tget menu(): DMenu<VALUE> {\n\t\tlet result = this._menu;\n\t\tif( result == null ) {\n\t\t\tresult = this.toMenu( this.theme, this._options );\n\t\t\tresult.on( \"select\", ( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void => {\n\t\t\t\tthis.onMenuSelect( value, item, menu );\n\t\t\t});\n\t\t\tthis._menu = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tthis.emit( \"select\", value, item, this );\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tparent.emit( \"select\", value, item, parent );\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isArrowDownKey( e ) ) {\n\t\t\tthis.onKeyDownArrowDown( e );\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onKeyDownArrowDown( e: KeyboardEvent ): boolean {\n\t\tif( this.state.isActionable && this.state.isFocused ) {\n\t\t\tthis.onActivate( e );\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuBarItem\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutSpace, DLayoutSpaceOptions, DThemeLayoutSpace } from \"./d-layout-space\";\nimport { DMenuBarItem, DMenuBarItemOptions } from \"./d-menu-bar-item\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DMenuBarItemSpaceOptions<\n\tTHEME extends DThemeMenuBarItemSpace = DThemeMenuBarItemSpace\n> extends DLayoutSpaceOptions<THEME> {\n\tspace: true;\n}\n\nexport interface DThemeMenuBarItemSpace extends DThemeLayoutSpace {\n\n}\n\nexport interface DMenuBarOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBar = DThemeMenuBar\n> extends DLayoutHorizontalOptions<THEME> {\n\titems?: Array<DMenuBarItemOptions<VALUE> | DMenuBarItemSpaceOptions | DisplayObject | null>;\n}\n\nexport interface DThemeMenuBar extends DThemeLayoutHorizontal {\n\n}\n\nexport class DMenuBar<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuBar = DThemeMenuBar,\n\tOPTIONS extends DMenuBarOptions<VALUE, THEME> = DMenuBarOptions<VALUE, THEME>\n>extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis.state.isFocusRoot = true;\n\n\t\tconst items = options?.items;\n\t\tif( items ) {\n\t\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\t\tconst item = this.toItem( items[ i ] );\n\t\t\t\tif( item ) {\n\t\t\t\t\tthis.addChild( item );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toItem( item: DMenuBarItemOptions<VALUE> | DMenuBarItemSpaceOptions | DisplayObject | null ): DisplayObject | null {\n\t\tif( item == null ) {\n\t\t\treturn null;\n\t\t} else if( item instanceof DisplayObject ) {\n\t\t\treturn item;\n\t\t} else if( \"space\" in item ) {\n\t\t\treturn new DLayoutSpace( item );\n\t\t}\n\t\treturn new DMenuBarItem<VALUE>( item );\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tUtilKeyboardEvent.moveFocusHorizontally( e, this );\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuBar\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DLayoutVerticalOptions, DThemeLayoutVertical } from \"./d-layout-vertical\";\n\nexport interface DMenuSidedContentOptions<\n\tTHEME extends DThemeMenuSidedContent = DThemeMenuSidedContent\n> extends DLayoutVerticalOptions<THEME> {\n\n}\n\nexport interface DThemeMenuSidedContent extends DThemeLayoutVertical {\n\n}\n\nexport class DMenuSidedContent<\n\tTHEME extends DThemeMenuSidedContent = DThemeMenuSidedContent,\n\tOPTIONS extends DMenuSidedContentOptions<THEME> = DMenuSidedContentOptions<THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.state.isFocusable = false;\n\t}\n\n\tprotected initReflowable(): void {\n\t\t// DO NOTHING\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSidedContent\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DDialogSelectOptions } from \"./d-dialog-select\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DTableBodyCellButtonOptions } from \"./d-table-body-cell-button\";\nimport { DTableBodyCellCheckOptions } from \"./d-table-body-cell-check\";\nimport { DTableBodyCellColorOptions } from \"./d-table-body-cell-color\";\nimport { DTableBodyCellDateOptions } from \"./d-table-body-cell-date\";\nimport { DTableBodyCellDatetimeOptions } from \"./d-table-body-cell-datetime\";\nimport { DTableBodyCellIndexOptions } from \"./d-table-body-cell-index\";\nimport { DTableBodyCellInputIntegerOptions } from \"./d-table-body-cell-input-integer\";\nimport { DTableBodyCellInputRealOptions } from \"./d-table-body-cell-input-real\";\nimport { DTableBodyCellInputTextOptions } from \"./d-table-body-cell-input-text\";\nimport { DTableBodyCellLinkLinkOptions, DTableBodyCellLinkOptions } from \"./d-table-body-cell-link\";\nimport { DTableBodyCellSelectDialogOptions } from \"./d-table-body-cell-select-dialog\";\nimport { DTableBodyCellSelectMenuOptions } from \"./d-table-body-cell-select-menu\";\nimport { DTableBodyCellSelectMultipleOptions } from \"./d-table-body-cell-select-multiple\";\nimport { DTableBodyCellSelectPromiseOptions } from \"./d-table-body-cell-select-promise\";\nimport { DTableBodyCellTextOptions } from \"./d-table-body-cell-text\";\nimport { DTableBodyCellTimeOptions } from \"./d-table-body-cell-time\";\nimport { DTableBodyCellTreeOptions } from \"./d-table-body-cell-tree\";\nimport { DTableDataComparatorFunction, DTableDataComparatorObject } from \"./d-table-data-sorter\";\nimport { DTableHeaderCellOptions } from \"./d-table-header-cell\";\n\nexport enum DTableColumnType {\n\tINDEX,\n\tTEXT,\n\tINTEGER,\n\tREAL,\n\tCHECK,\n\tCHECK_SINGLE,\n\tCOLOR,\n\tBUTTON,\n\tSELECT,\n\tDATE,\n\tDATETIME,\n\tTIME,\n\tACTION,\n\tLINK,\n\tTREE\n}\n\nexport type DTableGetter<ROW_VALUE, CELL_VALUE> = ( row: ROW_VALUE, columnIndex: number ) => CELL_VALUE;\nexport type DTableSetter<ROW_VALUE, CELL_VALUE> = ( row: ROW_VALUE, columnIndex: number, cell: CELL_VALUE ) => void;\nexport type DTableFormatter<CELL_VALUE> = ( cell: CELL_VALUE ) => string;\nexport type DTableEditingFormatter<CELL_VALUE> = ( cell: CELL_VALUE ) => string;\nexport type DTableEditingUnformatter<CELL_VALUE> = ( formatted: string ) => CELL_VALUE;\nexport type DTableEditingValidator<CELL_VALUE> = ( cell: CELL_VALUE ) => string | null;\nexport type DTableSelectingGetter<CELL_VALUE, DIALOG> = ( dialog: DIALOG ) => CELL_VALUE;\nexport type DTableSelectingSetter<CELL_VALUE, DIALOG> = ( dialog: DIALOG, cell: CELL_VALUE ) => void;\nexport type DTableEditable<ROW_VALUE> = ( row: ROW_VALUE, columnIndex: number ) => boolean;\nexport type DTableRenderable<ROW_VALUE> = ( row: ROW_VALUE, columnIndex: number ) => boolean;\n\nexport type DTableBodyCellOptionsUnion<ROW_VALUE> = DTableBodyCellTextOptions<ROW_VALUE> | DTableBodyCellInputTextOptions<ROW_VALUE> |\n\tDTableBodyCellInputIntegerOptions<ROW_VALUE> | DTableBodyCellInputRealOptions<ROW_VALUE> | DTableBodyCellIndexOptions<ROW_VALUE> |\n\tDTableBodyCellColorOptions<ROW_VALUE> | DTableBodyCellCheckOptions<ROW_VALUE> | DTableBodyCellSelectDialogOptions<ROW_VALUE> |\n\tDTableBodyCellSelectPromiseOptions<ROW_VALUE> | DTableBodyCellSelectMenuOptions<ROW_VALUE> | DTableBodyCellDateOptions<ROW_VALUE> |\n\tDTableBodyCellDatetimeOptions<ROW_VALUE> | DTableBodyCellTimeOptions<ROW_VALUE> | DTableBodyCellButtonOptions<ROW_VALUE> |\n\tDTableBodyCellLinkOptions<ROW_VALUE> | DTableBodyCellSelectMultipleOptions<ROW_VALUE> | DTableBodyCellTreeOptions<ROW_VALUE>;\n\nexport interface DTableColumnEditingOptions<ROW_VALUE, CELL_VALUE> {\n\tenable?: boolean | DTableEditable<ROW_VALUE> | \"auto\" | \"AUTO\";\n\tformatter?: DTableEditingFormatter<CELL_VALUE>;\n\tunformatter?: DTableEditingUnformatter<CELL_VALUE>;\n\tvalidator?: DTableEditingValidator<CELL_VALUE>;\n}\n\nexport interface DTableColumnEditing<ROW_VALUE, CELL_VALUE> {\n\tenable: boolean | DTableEditable<ROW_VALUE>;\n\tformatter?: DTableEditingFormatter<CELL_VALUE>;\n\tunformatter?: DTableEditingUnformatter<CELL_VALUE>;\n\tvalidator?: DTableEditingValidator<CELL_VALUE>;\n}\n\nexport interface DTableColumnSortingOptions<ROW_VALUE> {\n\tenable?: boolean;\n\tcomparator?: DTableDataComparatorFunction<ROW_VALUE> | DTableDataComparatorObject<ROW_VALUE>;\n}\n\nexport interface DTableColumnSorting<ROW_VALUE> {\n\tenable: boolean;\n\tcomparator?: DTableDataComparatorFunction<ROW_VALUE> | DTableDataComparatorObject<ROW_VALUE>;\n}\n\nexport interface DTableColumnSelectingDialog<DIALOG_VALUE> {\n\treadonly value: DIALOG_VALUE;\n\topen(): Promise<DIALOG_VALUE>;\n}\n\nexport interface DTableColumnSelectingOptions<\n\tCELL_VALUE,\n\tDIALOG_VALUE,\n\tDIALOG extends DTableColumnSelectingDialog<DIALOG_VALUE>\n> {\n\tgetter?: DTableSelectingGetter<CELL_VALUE, DIALOG>;\n\tsetter?: DTableSelectingSetter<CELL_VALUE, DIALOG>;\n\n\tmenu?: DMenuOptions<CELL_VALUE> | DMenu<CELL_VALUE>;\n\tmultiple?: DMenuOptions<CELL_VALUE> | DMenu<CELL_VALUE>;\n\tdialog?: DDialogSelectOptions<DIALOG_VALUE> | DIALOG;\n\tpromise?: () => Promise<CELL_VALUE>;\n}\n\nexport interface DTableColumnSelecting<\n\tCELL_VALUE,\n\tDIALOG_VALUE,\n\tDIALOG extends DTableColumnSelectingDialog<DIALOG_VALUE>\n> {\n\tgetter: DTableSelectingGetter<CELL_VALUE, DIALOG>;\n\tsetter: DTableSelectingSetter<CELL_VALUE, DIALOG>;\n\n\tmenu?: DMenu<CELL_VALUE>;\n\tmultiple?: DMenu<CELL_VALUE>;\n\tdialog?: DIALOG;\n\tpromise?: () => Promise<CELL_VALUE>;\n}\n\nexport interface DTableColumnOptions<\n\tROW_VALUE,\n\tCELL_VALUE = any,\n\tDIALOG_VALUE = any,\n\tDIALOG extends DTableColumnSelectingDialog<DIALOG_VALUE> = any\n> {\n\tweight?: number;\n\twidth?: number;\n\n\ttype?: (keyof typeof DTableColumnType) | DTableColumnType;\n\tlabel?: string;\n\tgetter?: DTableGetter<ROW_VALUE, CELL_VALUE>;\n\tsetter?: DTableSetter<ROW_VALUE, CELL_VALUE>;\n\tpath?: string;\n\tdefault?: CELL_VALUE;\n\tformatter?: DTableFormatter<CELL_VALUE>;\n\talign?: (keyof typeof DAlignHorizontal) | DAlignHorizontal;\n\n\t/**\n\t * If the renderable is\n\t *\n\t * * true, cells get rendered.\n\t * * false, cells do not get rendered.\n\t * * a function, cells get rendered only when that function returns true.\n\t * * \"AUTO\", cells get rendered only when the cell data exit.\n\t */\n\trenderable?: boolean | DTableRenderable<ROW_VALUE> | \"auto\" | \"AUTO\";\n\n\t/**\n\t * If the editable is\n\t *\n\t * * true, cells get editable.\n\t * * false, cells do not get editable.\n\t * * a function, cells are editable only when that function returns true.\n\t * * \"AUTO\", cells are editable only when the cell data exist.\n\t */\n\teditable?: boolean | DTableEditable<ROW_VALUE> | \"auto\" | \"AUTO\";\n\tediting?: DTableColumnEditingOptions<ROW_VALUE, CELL_VALUE>;\n\n\tsortable?: boolean;\n\tsorting?: DTableColumnSortingOptions<ROW_VALUE>;\n\n\theader?: DTableHeaderCellOptions<ROW_VALUE>;\n\tbody?: DTableBodyCellOptionsUnion<ROW_VALUE>;\n\n\tselecting?: DTableColumnSelectingOptions<CELL_VALUE, DIALOG_VALUE, DIALOG>;\n\n\tcategory?: string | string[];\n\tfrozen?: boolean;\n\n\tlink?: DTableBodyCellLinkLinkOptions<ROW_VALUE, CELL_VALUE>;\n}\n\nexport interface DTableColumn<\n\tROW_VALUE,\n\tCELL_VALUE,\n\tDIALOG_VALUE = CELL_VALUE,\n\tDIALOG extends DTableColumnSelectingDialog<DIALOG_VALUE> = DTableColumnSelectingDialog<DIALOG_VALUE>\n> {\n\tweight: number | undefined;\n\twidth: number | undefined;\n\n\ttype: DTableColumnType;\n\tlabel: string;\n\tgetter: DTableGetter<ROW_VALUE, CELL_VALUE>;\n\tsetter: DTableSetter<ROW_VALUE, CELL_VALUE>;\n\tformatter?: DTableFormatter<CELL_VALUE>;\n\talign: DAlignHorizontal;\n\trenderable: boolean | DTableRenderable<ROW_VALUE>;\n\n\tediting: DTableColumnEditing<ROW_VALUE, CELL_VALUE>;\n\tsorting: DTableColumnSorting<ROW_VALUE>;\n\n\theader?: DTableHeaderCellOptions<ROW_VALUE>;\n\tbody?: DTableBodyCellOptionsUnion<ROW_VALUE>;\n\n\tselecting: DTableColumnSelecting<CELL_VALUE, DIALOG_VALUE, DIALOG>;\n\n\tcategory?: string | string[];\n\tfrozen?: boolean;\n\toffset: number;\n\n\tlink?: DTableBodyCellLinkLinkOptions<ROW_VALUE, CELL_VALUE>;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject } from \"pixi.js\";\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { Closeable, DMenuContext } from \"./d-menu-context\";\nimport { DMenuItemOptionsUnion } from \"./d-menu-item-options-union\";\nimport { DMenuSidedContent, DMenuSidedContentOptions } from \"./d-menu-sided-content\";\nimport { DMenuSidedSelection, DMenuSidedSelectionOptions } from \"./d-menu-sided-selection\";\nimport { DMenuSideds } from \"./d-menu-sideds\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\n\nexport interface DMenuSidedOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuSided = DThemeMenuSided,\n\tCONTENT_OPTIONS extends DBaseOptions = DMenuSidedContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\titems?: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>;\n\tsticky?: boolean;\n\tselection?: DMenuSidedSelectionOptions | DMenuSidedSelection;\n}\n\nexport interface DThemeMenuSided extends DThemePane {\n\n}\n\nexport class DMenuSided<\n\tVALUE = unknown,\n\tTHEME extends DThemeMenuSided = DThemeMenuSided,\n\tCONTENT_OPTIONS extends DMenuSidedContentOptions = DMenuSidedContentOptions,\n\tOPTIONS extends DMenuSidedOptions<VALUE, THEME, CONTENT_OPTIONS> = DMenuSidedOptions<VALUE, THEME, CONTENT_OPTIONS>\n> extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _context!: DMenuContext | null;\n\tprotected _selection!: DMenuSidedSelection;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tconst context = new DMenuContext( this );\n\t\tthis._context = context;\n\t\tcontext.add( this );\n\n\t\tconst items = options && options.items;\n\t\tif( items != null ) {\n\t\t\tconst sticky = ( options && options.sticky != null ? options.sticky : false );\n\t\t\tthis.newItems( items, sticky );\n\t\t}\n\n\t\tconst selection = options && options.selection;\n\t\tthis._selection = ( selection instanceof DMenuSidedSelection ?\n\t\t\tselection : this.newSelection( selection ) );\n\t}\n\n\tprotected newSelection( options?: DMenuSidedSelectionOptions ): DMenuSidedSelection {\n\t\treturn new DMenuSidedSelection( this._content, options );\n\t}\n\n\tprotected onChildrenDirty(): void {\n\t\tconst selection = this._selection;\n\t\tif( selection != null ) {\n\t\t\tselection.toDirty();\n\t\t}\n\t\tsuper.onChildrenDirty();\n\t}\n\n\tprotected newItems( items: Array<DMenuItemOptionsUnion<VALUE> | DisplayObject>, sticky: boolean ): void {\n\t\tDMenuSideds.newItems( this._content, items, sticky );\n\t}\n\n\tprotected newContent( options?: CONTENT_OPTIONS ): DBase {\n\t\treturn new DMenuSidedContent( options );\n\t}\n\n\tget selection(): DMenuSidedSelection {\n\t\treturn this._selection;\n\t}\n\n\tgetContext(): DMenuContext | null {\n\t\treturn this._context;\n\t}\n\n\tgetCloseable(): Closeable | null {\n\t\treturn this;\n\t}\n\n\topen(): void {\n\t\t// DO NOTHING\n\t}\n\n\tclose(): void {\n\t\t// DO NOTHING\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tUtilKeyboardEvent.moveFocusVertically( e, this );\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DMenuSided\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DNotificationOptions<THEME extends DThemeNotification> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemeNotification extends DThemeBase {\n\n}\n\nexport class DNotification<\n\tTHEME extends DThemeNotification = DThemeNotification,\n\tOPTIONS extends DNotificationOptions<THEME> = DNotificationOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPaginationDotsButtonOptions<\n\tTHEME extends DThemePaginationDotsButton = DThemePaginationDotsButton\n> extends DButtonAmbientOptions<string, THEME> {\n}\n\nexport interface DThemePaginationDotsButton extends DThemeButtonAmbient<string> {\n\n}\n\nexport class DPaginationDotsButton<\n\tTHEME extends DThemePaginationDotsButton = DThemePaginationDotsButton,\n\tOPTIONS extends DPaginationDotsButtonOptions<THEME> = DPaginationDotsButtonOptions<THEME>\n> extends DButtonAmbient<string, THEME, OPTIONS> {\n\n\tprotected getType(): string {\n\t\treturn \"DPaginationDotsButton\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DPaginationDotsButton } from \"./d-pagination-dots-button\";\n\nexport interface DPaginationDynamicButtonsOptions<\n\tTHEME extends DThemePaginationDynamicButtons> extends DLayoutHorizontalOptions<THEME> {\n\t\tstart?: number;\n\t\tend?: number;\n\t\tselected?: number;\n\t\tbutton: {\n\t\t\twidth: number,\n\t\t\tdotsLeft?: boolean,\n\t\t\tdotsRight?: boolean\n\t\t};\n}\n\nexport interface DThemePaginationDynamicButtons extends DThemeLayoutHorizontal {\n}\n\nexport class DPaginationDynamicButtons<\n\tTHEME extends DThemePaginationDynamicButtons = DThemePaginationDynamicButtons,\n\tOPTIONS extends DPaginationDynamicButtonsOptions<THEME> = DPaginationDynamicButtonsOptions<THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _dotsBtnLeft!: DPaginationDotsButton;\n\tprotected _dotsBtnRight!: DPaginationDotsButton;\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._dotsBtnLeft = new DPaginationDotsButton({\n\t\t\twidth: options.button.width,\n\t\t\tvisible: !!options.button.dotsLeft\n\t\t});\n\t\tthis._dotsBtnRight = new DPaginationDotsButton({\n\t\t\twidth: options.button.width,\n\t\t\tvisible: !!options.button.dotsRight\n\t\t});\n\t\tthis.addChild( this._dotsBtnLeft );\n\t\tthis.addChild( this._dotsBtnRight );\n\t}\n\n\tpublic update( options: DPaginationDynamicButtonsOptions<THEME> ) {\n\t\tif( options.start == null || options.end == null ) {\n\t\t\treturn;\n\t\t}\n\t\tconst btnsCount = options.end - options.start + 1 > 0 ? options.end - options.start + 1 : 0;\n\t\tlet pageButtons = ( this.children as DButton[] ).slice( 1, this.children.length - 1 );\n\t\tif( pageButtons.length < btnsCount ) {\n\t\t\tfor ( let i = pageButtons.length; i < btnsCount; i++ ) {\n\t\t\t\tconst btn = new DButton({\n\t\t\t\t\twidth: options.button.width\n\t\t\t\t});\n\t\t\t\tthis.addChildAt( btn, this.children.length - 1 );\n\t\t\t\tbtn.on( \"active\", ( clickedBtn: DButton ) => {\n\t\t\t\t\tthis.emit( \"active\", clickedBtn );\n\t\t\t\t});\n\t\t\t}\n\t\t\t// re-new \"pageButtons\" after add new buttons\n\t\t\tpageButtons = ( this.children as DButton[]).slice( 1, this.children.length - 1 );\n\n\t\t} else if( pageButtons.length > btnsCount ) {\n\t\t\tfor ( let i = btnsCount; i < pageButtons.length; i++ ) {\n\t\t\t\tpageButtons[ i ].hide();\n\t\t\t}\n\t\t}\n\t\t// update button text and active state\n\t\tfor ( let i = 0; i < btnsCount; i++ ) {\n\t\t\tconst btn = pageButtons[ i ];\n\t\t\tbtn.text = options.start + i + 1;\n\t\t\tbtn.state.isActive = ( options.start + i === options.selected );\n\t\t\tif( btn.isHidden() ) {\n\t\t\t\tbtn.show();\n\t\t\t}\n\t\t}\n\n\t\t// update visible state of dots buttons\n\t\tif( !!options.button.dotsLeft ) {\n\t\t\tthis._dotsBtnLeft.show();\n\t\t} else {\n\t\t\tthis._dotsBtnLeft.hide();\n\t\t}\n\t\tif( !!options.button.dotsRight ) {\n\t\t\tthis._dotsBtnRight.show();\n\t\t} else {\n\t\t\tthis._dotsBtnRight.hide();\n\t\t}\n\t}\n\tprotected getType(): string {\n\t\treturn \"DPaginationDynamicButtons\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonAmbient, DButtonAmbientOptions, DThemeButtonAmbient } from \"./d-button-ambient\";\n\nexport interface DPaginationNavigationButtonOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemePaginationNavigationButton<VALUE> = DThemePaginationNavigationButton<VALUE>\n> extends DButtonAmbientOptions<VALUE, THEME> {\n}\n\nexport interface DThemePaginationNavigationButton<VALUE = unknown> extends DThemeButtonAmbient<VALUE> {\n\n}\n\nexport class DPaginationNavigationButton<\n\tVALUE = unknown,\n\tTHEME extends DThemePaginationNavigationButton<VALUE> = DThemePaginationNavigationButton<VALUE>,\n\tOPTIONS extends DPaginationNavigationButtonOptions<VALUE, THEME> = DPaginationNavigationButtonOptions<VALUE, THEME>\n> extends DButtonAmbient<VALUE, THEME, OPTIONS> {\n\n\tprotected getType(): string {\n\t\treturn \"DPaginationNavigationButton\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton } from \"./d-button\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DPaginationDynamicButtons } from \"./d-pagination-dynamic-buttons\";\nimport { DPaginationNavigationButton } from \"./d-pagination-navigation-button\";\nimport { DThemes } from \"./theme/d-themes\";\n\nexport interface DPaginationOptions<THEME extends DThemePagination> extends DLayoutHorizontalOptions<THEME> {\n\ttotal: number;\n\tselected?: number;\n\tbutton?: {\n\t\tfirst?: boolean;\n\t\tlast?: boolean;\n\t\twidth?: number;\n\t};\n}\n\nexport interface DThemePagination extends DThemeLayoutHorizontal {\n\tgetButtonWidth(): number;\n}\n\ninterface DPaginationButtonOption {\n\tfirst: boolean;\n\tlast: boolean;\n\twidth?: number;\n}\n\nexport class DPagination<\n\tTHEME extends DThemePagination = DThemePagination,\n\tOPTIONS extends DPaginationOptions<THEME> = DPaginationOptions<THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _total!: number;\n\tprotected _selected!: number;\n\tprotected _buttonOptions!: DPaginationButtonOption;\n\tprotected _numberPageButtonVisible!: number;\n\tprotected DEFAULT_SELECTED!: number;\n\n\tprotected _firstPageBtn!: DButton;\n\tprotected _lastPageBtn!: DButton;\n\tprotected _dynamicPageBtns!: DPaginationDynamicButtons;\n\n\tprotected _previousBtn!: DPaginationNavigationButton;\n\tprotected _nextBtn!: DPaginationNavigationButton;\n\tprotected _goFirstBtn!: DPaginationNavigationButton;\n\tprotected _goLastBtn!: DPaginationNavigationButton;\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.DEFAULT_SELECTED = 0; // set default selected index page is page 0\n\t\t// get total pages\n\t\tthis._total = options.total;\n\t\t// get selected page\n\t\tthis._selected = options.selected ? options.selected : this.DEFAULT_SELECTED;\n\t\t// get button options\n\t\tthis._buttonOptions = {\n\t\t\tfirst: !! ( options.button && options.button.first ),\n\t\t\tlast: !! ( options.button && options.button.last ),\n\t\t\twidth: options.button && options.button.width\n\t\t};\n\n\t\tthis.initButtons( this.getButtonWidth() );\n\t\tthis.listenButtonClicked();\n\n\t\tthis.on( \"resize\",  (): void => {\n\t\t\tthis._numberPageButtonVisible = this.toNumberVisible();\n\t\t\tthis.update();\n\t\t});\n\n\t}\n\n\t/**\n\t * Set selected page.\n\t *\n\t * @param selected page's index want to select.\n\t */\n\tset selected( selected: number ) {\n\t\tif( selected < 0 || selected >= this._total || !Number.isInteger( selected ) ) {\n\t\t\tselected = this.DEFAULT_SELECTED;\n\t\t}\n\t\tthis._selected = selected;\n\t\tthis.update();\n\n\t}\n\n\t/**\n\t * Get selected page.\n\t *\n\t * @returns index of selected page.\n\t */\n\tget selected() {\n\t\treturn this._selected;\n\t}\n\n\t/**\n\t * Set total page.\n\t *\n\t * @param total number of page want to present in pagination.\n\t */\n\tset total( total: number ) {\n\t\tif( total >= 0 && Number.isInteger( total ) ) {\n\t\t\tthis._total = total;\n\t\t\tthis._numberPageButtonVisible = this.toNumberVisible();\n\t\t\tthis.selected = this._selected;\n\t\t\tthis._lastPageBtn.text = this._total;\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\t/**\n\t * Get total pages.\n\t *\n\t * @returns number of total pages.\n\t */\n\tget total() {\n\t\treturn this._total;\n\t}\n\n\tprotected initButtons( width: number ) {\n\t\tthis._previousBtn = new DPaginationNavigationButton({\n\t\t\twidth,\n\t\t\timage: {\n\t\t\t\tsource: DThemes.getInstance().getAtlas().mappings.pagination_navigation_button_previous\n\n\t\t\t}\n\t\t});\n\n\t\tthis._nextBtn = new DPaginationNavigationButton({\n\t\t\twidth,\n\t\t\timage: {\n\t\t\t\tsource: DThemes.getInstance().getAtlas().mappings.pagination_navigation_button_next\n\n\t\t\t}\n\t\t});\n\n\t\tthis._goFirstBtn = new DPaginationNavigationButton({\n\t\t\twidth,\n\t\t\timage: {\n\t\t\t\tsource: DThemes.getInstance().getAtlas().mappings.pagination_navigation_button_go_first\n\n\t\t\t},\n\t\t\tvisible: this._buttonOptions.first\n\t\t});\n\n\t\tthis._goLastBtn = new DPaginationNavigationButton({\n\t\t\twidth,\n\t\t\timage: {\n\t\t\t\tsource: DThemes.getInstance().getAtlas().mappings.pagination_navigation_button_go_last\n\n\t\t\t},\n\t\t\tvisible: this._buttonOptions.last\n\t\t});\n\n\t\tthis._dynamicPageBtns = new DPaginationDynamicButtons({\n\t\t\tbutton: {\n\t\t\t\twidth\n\t\t\t}\n\t\t});\n\n\t\tthis._firstPageBtn = new DButton({\n\t\t\twidth,\n\t\t\ttext: {\n\t\t\t\tvalue: 1\n\t\t\t}\n\t\t});\n\n\t\tthis._lastPageBtn = new DButton({\n\t\t\twidth,\n\t\t\ttext: {\n\t\t\t\tvalue: this._total\n\t\t\t}\n\t\t});\n\n\t\tthis.addChild( this._goFirstBtn );\n\t\tthis.addChild( this._previousBtn );\n\t\tthis.addChild( this._firstPageBtn );\n\t\tthis.addChild( this._dynamicPageBtns );\n\t\tthis.addChild( this._lastPageBtn );\n\t\tthis.addChild( this._nextBtn );\n\t\tthis.addChild( this._goLastBtn );\n\t}\n\n\tprotected listenButtonClicked() {\n\t\tthis._firstPageBtn.on( \"active\", ( btn: DButton ) => {\n\t\t\tthis.onClickPageButton( btn );\n\t\t});\n\t\tthis._lastPageBtn.on( \"active\", ( btn: DButton ) => {\n\t\t\tthis.onClickPageButton( btn );\n\t\t});\n\t\tthis._dynamicPageBtns.on( \"active\", ( btn: DButton ) => {\n\t\t\tthis.onClickPageButton( btn );\n\t\t});\n\t\tthis._goFirstBtn.on( \"active\", (btn: DButton) => {\n\t\t\tthis.selected = this.DEFAULT_SELECTED;\n\t\t});\n\t\tthis._goLastBtn.on( \"active\", (btn: DButton) => {\n\t\t\tthis.selected = this._total - 1;\n\t\t});\n\t\tthis._nextBtn.on( \"active\", (btn: DButton) => {\n\t\t\tif( this.selected !== this._total + 1 ) {\n\t\t\t\tthis.selected = this._selected + 1;\n\t\t\t}\n\t\t});\n\t\tthis._previousBtn.on( \"active\", (btn: DButton) => {\n\t\t\tif( this._selected !== 0 ) {\n\t\t\t\tthis.selected = this._selected - 1;\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected update() {\n\t\tlet startDynamic: number;\n\t\tlet endDynamic: number;\n\t\tlet dotsLeft: boolean;\n\t\tlet dotsRight: boolean;\n\t\tlet numberButtonsInLeft = 0;\n\t\tlet numberButtonsInRight = 0;\n\n\t\tthis.updateStaticButtons();\n\t\t// Number displayed buttons from first button to selected button when select center button of all buttons.\n\t\t// Not including selected button.\n\t\tconst numberButtonsFirstToCenter = Math.ceil( ( this._numberPageButtonVisible  - 1 ) * 0.5 );\n\t\tconst numberButtonsCenterToEnd = Math.floor( ( this._numberPageButtonVisible  - 1 ) * 0.5 );\n\n\t\tif( this._selected < numberButtonsFirstToCenter ) {\n\t\t\tnumberButtonsInLeft =  this._selected;\n\t\t\tnumberButtonsInRight = this._numberPageButtonVisible - numberButtonsInLeft - 1;\n\t\t} else if ( this._selected + numberButtonsCenterToEnd > this._total - 1 ) {\n\t\t\tnumberButtonsInRight = ( this._total - 1 ) - this.selected;\n\t\t\tnumberButtonsInLeft = this._numberPageButtonVisible - numberButtonsInRight - 1;\n\t\t} else {\n\t\t\tnumberButtonsInLeft = numberButtonsFirstToCenter;\n\t\t\tnumberButtonsInRight = numberButtonsCenterToEnd;\n\t\t}\n\n\t\tif( this._selected <= numberButtonsInLeft ) {\n\t\t\tstartDynamic  = 1;\n\t\t\tdotsLeft = false;\n\t\t} else {\n\t\t\tstartDynamic = this._selected - numberButtonsInLeft + 2;\n\t\t\tdotsLeft = true;\n\t\t}\n\n\t\tif( this._selected + numberButtonsInRight >= this._total - 1 ) {\n\t\t\tendDynamic = this._total - 2;\n\t\t\tdotsRight = false;\n\t\t} else {\n\t\t\tendDynamic = this._selected + numberButtonsInRight - 2;\n\t\t\tdotsRight = true;\n\t\t}\n\n\t\tthis._dynamicPageBtns.update({\n\t\t\tstart: startDynamic,\n\t\t\tend: endDynamic,\n\t\t\tselected: this._selected,\n\t\t\tbutton: {\n\t\t\t\twidth: this.getButtonWidth(),\n\t\t\t\tdotsLeft,\n\t\t\t\tdotsRight\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected updateStaticButtons() {\n\t\tif( this._total > 0 ) {\n\t\t\tthis._firstPageBtn.show();\n\t\t} else {\n\t\t\tthis._firstPageBtn.hide();\n\t\t}\n\t\tif( this._total > 1 ) {\n\t\t\tthis._lastPageBtn.show();\n\t\t} else {\n\t\t\tthis._lastPageBtn.hide();\n\t\t}\n\t\tconst isFirst = this._selected === this.DEFAULT_SELECTED;\n\t\tconst isLast = this._selected === this._total - 1 || this._total === 0;\n\t\tthis._firstPageBtn.state.isActive = isFirst;\n\t\tthis._lastPageBtn.state.isActive = isLast;\n\t\tthis._goFirstBtn.state.isDisabled = isFirst;\n\t\tthis._previousBtn.state.isDisabled = isFirst;\n\t\tthis._nextBtn.state.isDisabled = isLast;\n\t\tthis._goLastBtn.state.isDisabled = isLast;\n\t}\n\n\tprotected getButtonWidth() {\n\t\treturn this._buttonOptions.width ? this._buttonOptions.width : this.theme.getButtonWidth();\n\t}\n\n\tprotected toNumberVisible() {\n\t\tlet numberNavigationBtn = 2; // 2 buttons always displayed are \"next\" and \"previous\" button\n\t\tif( this._buttonOptions.first ) {\n\t\t\tnumberNavigationBtn++;\n\t\t}\n\t\tif( this._buttonOptions.last ) {\n\t\t\tnumberNavigationBtn++;\n\t\t}\n\t\tconst widthOfNavigationBtns = numberNavigationBtn * ( this.getButtonWidth() + this._margin.horizontal * 2 );\n\t\tconst widthOfPageBtns = this.width -  widthOfNavigationBtns;\n\t\tconst numberVisible = Math.floor( widthOfPageBtns / ( this.getButtonWidth() + this._margin.horizontal * 2 ) );\n\t\t/* set numberVisible is 5, if it less than 5\n\t\t\t If total pages less than numberVisible, set numberVisible equal total pages\n\t\t**/\n\t\treturn Math.min( this._total, Math.max( numberVisible, 5 ) );\n\t}\n\n\tprotected onClickPageButton( btn: DButton ) {\n\t\tconst btnIndex = Number( btn.text ) - 1;\n\t\tif( this._selected !== btnIndex ) {\n\t\t\tthis._selected = btnIndex;\n\t\t\tthis.update();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DPagination\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPickerDatetimeRangeOptions<THEME extends DThemePickerDatetimeRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerDatetimeRange extends DThemeBase {\n\n}\n\nexport class DPickerDatetimeRange<\n\tTHEME extends DThemePickerDatetimeRange = DThemePickerDatetimeRange,\n\tOPTIONS extends DPickerDatetimeRangeOptions<THEME> = DPickerDatetimeRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\n\nexport interface DPickerTimeRangeOptions<THEME extends DThemePickerTimeRange> extends DBaseOptions<THEME> {\n\n}\n\nexport interface DThemePickerTimeRange extends DThemeBase {\n\n}\n\nexport class DPickerTimeRange<\n\tTHEME extends DThemePickerTimeRange = DThemePickerTimeRange,\n\tOPTIONS extends DPickerTimeRangeOptions<THEME> = DPickerTimeRangeOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDropdownBase, DDropdownBaseEvents, DDropdownBaseOptions, DThemeDropdownBase } from \"./d-dropdown-base\";\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemCheck } from \"./d-menu-item-check\";\nimport { DMenuItemMenu } from \"./d-menu-item-menu\";\n\n/**\n * {@link DSelectMultiple} events.\n */\nexport interface DSelectMultipleEvents<VALUE, EMITTER>\n\textends DDropdownBaseEvents<VALUE, DMenuItem<VALUE> | null, EMITTER> {\n\t/**\n\t * Triggered when a menu item is selected.\n\t *\n\t * @param value a value of a selected menu item\n\t * @param item a selected menu item\n\t * @param emitter an emitter\n\t */\n\tmenuselect( value: VALUE, item: DMenuItem<VALUE>, emitter: EMITTER ): void;\n\n\t/**\n\t * Triggered when the selection is changed.\n\t *\n\t * @param newValues new selected values\n\t * @param oldValues old selected values\n\t * @param items selected items\n\t * @param emitter an emitter\n\t */\n\tchange( newValues: VALUE[], oldValues: VALUE[], items: Array<DMenuItem<VALUE>>, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DSelectMultiple} \"on\" options.\n */\nexport interface DSelectMultipleOnOptions<VALUE, EMITTER> extends Partial<DSelectMultipleEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DSelectMultiple} options.\n */\nexport interface DSelectMultipleOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelectMultiple<VALUE> = DThemeSelectMultiple<VALUE>,\n\tEMITTER = any\n> extends DDropdownBaseOptions<VALUE, Array<DMenuItem<VALUE>>, THEME, EMITTER> {\n\t/**\n\t * A default values.\n\t */\n\tvalues?: VALUE[];\n\n\ton?: DSelectMultipleOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DSelectMultiple} theme.\n */\nexport interface DThemeSelectMultiple<VALUE = unknown> extends DThemeDropdownBase<Array<DMenuItem<VALUE>>> {\n\n}\n\n/**\n * A multi-value selector class.\n */\nexport class DSelectMultiple<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelectMultiple<VALUE> = DThemeSelectMultiple<VALUE>,\n\tOPTIONS extends DSelectMultipleOptions<VALUE, THEME> = DSelectMultipleOptions<VALUE, THEME>\n> extends DDropdownBase<VALUE, Array<DMenuItem<VALUE>>, THEME, OPTIONS> {\n\tprotected _values: VALUE[];\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\t// Default values\n\t\tthis._values = [];\n\t\tconst values = options?.values;\n\t\tif( values ) {\n\t\t\tthis.values = values;\n\t\t}\n\t}\n\n\tprotected onMenuSelect( value: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tsuper.onMenuSelect( value, item, menu );\n\t\tif( item instanceof DMenuItemCheck ) {\n\t\t\tconst oldValues = this._values;\n\t\t\tconst newValues: VALUE[] = [];\n\t\t\tconst newItems: Array<DMenuItem<VALUE>> = [];\n\t\t\tif( item.state.isActive ) {\n\t\t\t\tthis.updateMenuItems( menu, oldValues, value, undefined, newValues, newItems );\n\t\t\t} else {\n\t\t\t\tthis.updateMenuItems( menu, oldValues, undefined, value, newValues, newItems );\n\t\t\t}\n\t\t\tthis._values = newValues;\n\t\t\tthis.text = newItems;\n\t\t\tthis.onValueChange( newValues, oldValues, newItems );\n\t\t}\n\t}\n\n\tprotected onValueChange( newValues: VALUE[], oldValues: VALUE[], items: Array<DMenuItem<VALUE>> ): void {\n\t\tthis.emit( \"change\", newValues, oldValues, items, this );\n\t}\n\n\tstart(): void {\n\t\tthis.updateMenuItems( this.menu, this._values );\n\t\tsuper.start();\n\t}\n\n\t/**\n\t * Returns a selected value or null.\n\t */\n\tget values(): VALUE[] {\n\t\treturn this._values;\n\t}\n\n\t/**\n\t * Sets to the specified value.\n\t */\n\tset values( values: VALUE[] ) {\n\t\tconst oldValues = this._values;\n\t\tif( ! this.isSameValues( values, oldValues ) ) {\n\t\t\tconst newValues: VALUE[] = [];\n\t\t\tconst newItems: Array<DMenuItem<VALUE>> = [];\n\t\t\tthis.updateMenuItems( this.menu, values, undefined, undefined, newValues, newItems );\n\t\t\tthis._values = newValues;\n\t\t\tthis.text = newItems;\n\t\t}\n\t}\n\n\tprotected isSameValues( a: VALUE[], b: VALUE[] ): boolean {\n\t\tif( a.length === b.length ) {\n\t\t\tfor( let i = 0, imax = a.length; i < imax; ++i ) {\n\t\t\t\tif( b.indexOf( a[ i ] ) < 0 ) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected updateMenuItems(\n\t\tmenu: DMenu<VALUE>,\n\t\toldValues: VALUE[],\n\t\taddedValue?: VALUE,\n\t\tremovedValue?: VALUE,\n\t\tnewValues?: VALUE[],\n\t\tnewItems?: Array<DMenuItem<VALUE>>\n\t): void {\n\t\tconst children = menu.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DMenuItemMenu ) {\n\t\t\t\tthis.updateMenuItems( child.menu, oldValues, addedValue, removedValue, newValues, newItems );\n\t\t\t} else if( child instanceof DMenuItemCheck ) {\n\t\t\t\tconst childValue = child.value;\n\t\t\t\tif( removedValue !== undefined && removedValue === childValue ) {\n\t\t\t\t\tchild.state.isActive = false;\n\t\t\t\t} else if( ( addedValue !== undefined && child.value === addedValue ) || 0 <= oldValues.indexOf( child.value ) ) {\n\t\t\t\t\tif( newValues ) {\n\t\t\t\t\t\tnewValues.push( child.value );\n\t\t\t\t\t}\n\t\t\t\t\tif( newItems ) {\n\t\t\t\t\t\tnewItems.push( child );\n\t\t\t\t\t}\n\t\t\t\t\tchild.state.isActive = true;\n\t\t\t\t} else {\n\t\t\t\t\tchild.state.isActive = false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSelectMultiple\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDropdownBase, DDropdownBaseEvents, DDropdownBaseOptions, DThemeDropdownBase } from \"./d-dropdown-base\";\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DMenuItemMenu } from \"./d-menu-item-menu\";\n\n/**\n * {@link DSelect} events.\n */\nexport interface DSelectEvents<VALUE, EMITTER> extends DDropdownBaseEvents<VALUE, DMenuItem<VALUE> | null, EMITTER> {\n\t/**\n\t * Triggered when a selection is changed.\n\t *\n\t * @param newVAlue a newly-selected value\n\t * @param oldValue a previously-selected value\n\t * @param item a newly-selected item\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: VALUE | null, oldValue: VALUE | null, item: DMenuItem<VALUE> | null, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DSelect} \"on\" options.\n */\nexport interface DSelectOnOptions<VALUE, EMITTER> extends Partial<DSelectEvents<VALUE, EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DSelect} options.\n */\nexport interface DSelectOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelect<VALUE> = DThemeSelect<VALUE>,\n\tEMITTER = any\n> extends DDropdownBaseOptions<VALUE, DMenuItem<VALUE> | null, THEME, EMITTER> {\n\t/**\n\t * A default value.\n\t */\n\tvalue?: VALUE | null;\n\n\ton?: DSelectOnOptions<VALUE, EMITTER>;\n}\n\n/**\n * {@link DSelect} theme.\n */\nexport interface DThemeSelect<VALUE = unknown> extends DThemeDropdownBase<DMenuItem<VALUE> | null> {\n\n}\n\n/**\n * A selector class.\n */\nexport class DSelect<\n\tVALUE = unknown,\n\tTHEME extends DThemeSelect<VALUE> = DThemeSelect<VALUE>,\n\tOPTIONS extends DSelectOptions<VALUE, THEME> = DSelectOptions<VALUE, THEME>\n> extends DDropdownBase<VALUE, DMenuItem<VALUE> | null, THEME, OPTIONS> {\n\tprotected _value: VALUE | null;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\t// Default value\n\t\tthis._value = null;\n\t\tconst value = options?.value;\n\t\tif( value != null ) {\n\t\t\tthis.value = value;\n\t\t}\n\t}\n\n\tprotected onMenuSelect( newValue: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tsuper.onMenuSelect( newValue, item, menu );\n\t\tconst oldValue = this._value;\n\t\tif( oldValue !== newValue ) {\n\t\t\tthis._value = newValue;\n\t\t\tthis.text = item;\n\t\t\tthis.onValueChange( newValue, oldValue, item );\n\t\t}\n\t}\n\n\tprotected onValueChange( newValue: VALUE | null, oldValue: VALUE | null, item: DMenuItem<VALUE> | null ) {\n\t\tthis.emit( \"change\", newValue, oldValue, item,  this );\n\t}\n\n\tprotected findMenuItem( menu: DMenu<VALUE>, value: VALUE | null ): DMenuItem<VALUE> | null {\n\t\tconst children = menu.children;\n\t\tfor( let i = 0, imax = children.length; i < imax; ++i ) {\n\t\t\tconst child = children[ i ];\n\t\t\tif( child instanceof DMenuItemMenu ) {\n\t\t\t\tconst result = this.findMenuItem( child.menu, value );\n\t\t\t\tif( result != null ) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\t\t\t} else if( child instanceof DMenuItem ) {\n\t\t\t\tif( child.value === value ) {\n\t\t\t\t\treturn child;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Returns a selected value or null.\n\t */\n\tget value(): VALUE | null {\n\t\treturn this._value;\n\t}\n\n\t/**\n\t * Sets to the specified value.\n\t */\n\tset value( value: VALUE | null ) {\n\t\tif( this._value !== value ) {\n\t\t\tconst item = this.findMenuItem( this.menu, value );\n\t\t\tthis._value = value;\n\t\t\tthis.text = item;\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSelect\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { NineSlicePlane, Texture } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DShadow } from \"./d-shadow\";\n\nexport class DShadowImpl extends NineSlicePlane implements DShadow {\n\tprotected _offsetX: number;\n\tprotected _offsetY: number;\n\tprotected _shiftX: number;\n\tprotected _shiftY: number;\n\n\tconstructor( texture: Texture, width: number, height: number, offsetX: number, offsetY: number ) {\n\t\tsuper( texture, width, height, width, height );\n\n\t\tthis._offsetX = offsetX;\n\t\tthis._offsetY = offsetY;\n\t\tthis._shiftX = width * 0.5;\n\t\tthis._shiftY = height * 0.5;\n\n\t\tthis.interactive = false;\n\t\tthis.interactiveChildren = false;\n\n\t\ttexture.on( \"update\", (): void => {\n\t\t\tthis.onTextureUpdate();\n\t\t});\n\t}\n\n\tprotected onTextureUpdate(): void {\n\t\tthis.emit( \"update\", this );\n\t}\n\n\tonReflow( base: DBase, width: number, height: number ): void {\n\t\tconst sx = this._shiftX;\n\t\tconst sy = this._shiftY;\n\t\tthis.x = -sx + this._offsetX;\n\t\tthis.y = -sy + this._offsetY;\n\t\tthis.width = sx + width + sx;\n\t\tthis.height = sy + height + sy;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\n\nexport interface DSliderLabelOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderLabel<VALUE> = DThemeSliderLabel<VALUE>\n> extends DTextBaseOptions<VALUE, THEME> {\n\tvalue?: number;\n}\n\nexport interface DThemeSliderLabel<VALUE = unknown> extends DThemeTextBase<VALUE> {\n\n}\n\nexport class DSliderLabel<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderLabel<VALUE> = DThemeSliderLabel<VALUE>,\n\tOPTIONS extends DSliderLabelOptions<VALUE, THEME> = DSliderLabelOptions<VALUE, THEME>\n> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected _value!: number;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis.state.isFocusable = false;\n\n\t\tthis._value = options && options.value || 0;\n\t}\n\n\tset value( value: number ) {\n\t\tthis._value = value;\n\t}\n\n\tget value(): number {\n\t\treturn this._value;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSliderLabel\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\n\nexport interface DSliderThumbOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderThumb<VALUE> = DThemeSliderThumb<VALUE>\n> extends DButtonOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeSliderThumb<VALUE = unknown> extends DThemeButton<VALUE> {\n\n}\n\nexport class DSliderThumb<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderThumb<VALUE> = DThemeSliderThumb<VALUE>,\n\tOPTIONS extends DSliderThumbOptions<VALUE, THEME> = DSliderThumbOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DSliderThumb\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DTextBase, DTextBaseOptions, DThemeTextBase } from \"./d-text-base\";\n\nexport interface DSliderValueOptions<\n\tVALUE = number,\n\tTHEME extends DThemeSliderValue<VALUE> = DThemeSliderValue<VALUE>\n\t> extends DTextBaseOptions<VALUE, THEME> {\n\tvalue?: number;\n\tprecision?: number;\n\trounder?: ( value: number ) => number;\n}\n\nexport interface DThemeSliderValue<VALUE = unknown> extends DThemeTextBase<VALUE> {\n\tgetPrecision(): number;\n}\n\nexport class DSliderValue<\n\tVALUE = number,\n\tTHEME extends DThemeSliderValue<VALUE> = DThemeSliderValue<VALUE>,\n\tOPTIONS extends DSliderValueOptions<VALUE, THEME> = DSliderValueOptions<VALUE, THEME>\n\t> extends DTextBase<VALUE, THEME, OPTIONS> {\n\tprotected _value!: number;\n\tprotected _rounder!: ( value: number ) => number;\n\n\tprotected init( options?: OPTIONS ) {\n\n\t\tsuper.init( options );\n\t\tthis.state.isFocusable = false;\n\n\t\tthis._value = options && options.value || 0;\n\t\tthis._rounder = this.toRounder( options );\n\t}\n\n\ttoRounder( options?: OPTIONS ) {\n\t\tconst rounder = options && options.rounder;\n\t\tif ( rounder ) {\n\t\t\treturn rounder;\n\t\t}\n\n\t\tconst precision = ( options && options.precision ) ? options.precision : this.theme.getPrecision();\n\t\treturn ( value: number ) => {\n\t\t\tconst base = Math.pow( 10, precision );\n\t\t\treturn Math.round( value * base ) / base;\n\t\t};\n\t}\n\n\tset value( value: number ) {\n\t\tthis._value = value;\n\t}\n\n\tget value(): number {\n\t\treturn this._value;\n\t}\n\n\tget rounder(): ( value: number ) => number {\n\t\treturn this._rounder;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSliderValue\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport InteractionManager = interaction.InteractionManager;\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseEvents, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DSliderLabel, DSliderLabelOptions } from \"./d-slider-label\";\nimport { DSliderThumb, DSliderThumbOptions } from \"./d-slider-thumb\";\nimport { DSliderTrack, DSliderTrackOptions } from \"./d-slider-track\";\nimport { DSliderValue, DSliderValueOptions } from \"./d-slider-value\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\n/**\n * {@link DSlider} events.\n */\nexport interface DSliderEvents<EMITTER> extends DBaseEvents<EMITTER> {\n\t/**\n\t * Triggered when a value is changed.\n\t *\n\t * @param newValue a new value\n\t * @param oldValue an old value\n\t * @param emitter an emitter\n\t */\n\tchange( newValue: number, oldValue: number, emitter: EMITTER ): void;\n}\n\n/**\n * {@link DSlider} \"on\" options.\n */\nexport interface DSliderOnOptions<EMITTER> extends Partial<DSliderEvents<EMITTER>> {\n\t[ key: string ]: Function | undefined;\n}\n\n/**\n * {@link DSlider} options.\n */\nexport interface DSliderOptions<\n\tTHEME extends DThemeSlider = DThemeSlider,\n\tEMITTER = any\n> extends DBaseOptions<THEME, EMITTER> {\n\tmin?: DSliderLabelOptions;\n\tmax?: DSliderLabelOptions;\n\tvalue?: DSliderValueOptions;\n\ttrack?: DSliderTrackOptions;\n\tthumb?: DSliderThumbOptions;\n\ton?: DSliderOnOptions<EMITTER>;\n}\n\n/**\n * {@link DSlider} theme.\n */\nexport interface DThemeSlider extends DThemeBase {\n\n}\n\n/**\n * A slider class.\n */\nexport abstract class DSlider<\n\tTHEME extends DThemeSlider = DThemeSlider,\n\tOPTIONS extends DSliderOptions<THEME> = DSliderOptions<THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected _track!: DSliderTrack;\n\tprotected _thumb!: DSliderThumb;\n\tprotected _trackSelected!: DSliderTrack;\n\tprotected _value!: DSliderValue;\n\tprotected _roundNumber!: number;\n\tprotected _offset!: number;\n\tprotected _yOffset!: number;\n\tprotected _ratioValue!: number;\n\tprotected _min!: DSliderLabel;\n\tprotected _max!: DSliderLabel;\n\tprotected _onThumbMoveBound!: ( e: InteractionEvent ) => void;\n\tprotected _onThumbUpBound!: ( e: InteractionEvent ) => void;\n\tprotected _onTrackUpBound!: ( e: InteractionEvent ) => void;\n\tprotected _onTrackSelectedUpBound!: ( e: InteractionEvent ) => void;\n\tprotected _interactionManager?: InteractionManager;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tsuper.init( options );\n\n\t\tthis._ratioValue = 0;\n\n\t\tthis._track = this.newTrack( options );\n\t\tthis.addChild( this._track );\n\t\tthis._trackSelected = this.newTrackSelected( options );\n\t\tthis._trackSelected.state.isActive = true;\n\t\tthis.addChild( this._trackSelected );\n\t\tthis._thumb = this.newThumb( options );\n\t\tthis.addChild( this._thumb );\n\t\tthis._min = this.newLabelMin( options );\n\t\tthis.addChild( this._min );\n\t\tthis._max = this.newLabelMax( options );\n\t\tthis.addChild( this._max );\n\t\tthis._value = this.newValue( options );\n\t\tthis.addChild( this._value );\n\n\t\t// Event listeners\n\t\tthis._track.on( UtilPointerEvent.down, ( e: InteractionEvent) => {\n\t\t\tthis._value.visible = this.state.inEnabled;\n\t\t\tthis.onTrackDown( e.data.global );\n\t\t});\n\n\t\tthis._trackSelected.on( UtilPointerEvent.down, ( e: InteractionEvent) => {\n\t\t\tthis._value.visible = this.state.inEnabled;\n\t\t\tthis.onTrackSelectedDown( e.data.global );\n\t\t});\n\n\t\tthis._onTrackUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onTrackUpBound( e );\n\t\t\tthis._value.visible = false;\n\t\t};\n\n\t\tthis._onTrackSelectedUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onTrackSelectedUpBound( e );\n\t\t\tthis._value.visible = false;\n\t\t};\n\n\t\tthis._thumb.on( UtilPointerEvent.down, ( e: InteractionEvent ) => {\n\t\t\tthis._value.visible = true;\n\t\t\tthis.onThumbDown( e );\n\t\t});\n\n\t\tthis._onThumbMoveBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onThumbMove( e );\n\t\t};\n\n\t\tthis._onThumbUpBound = ( e: InteractionEvent ): void => {\n\t\t\tthis.onThumbUp( e );\n\t\t\tthis._value.visible = false;\n\t\t};\n\n\t\t//\n\t\tthis.onValuesChange();\n\t}\n\n\tprotected newThumb( options?: OPTIONS ): DSliderThumb {\n\t\treturn new DSliderThumb( options && options.thumb );\n\t}\n\n\tprotected newValue( options?: OPTIONS ): DSliderValue {\n\t\treturn new DSliderValue( this.toValueOptions( options && options.value ) );\n\t}\n\n\tprotected toValueOptions( options?: DSliderValueOptions ): DSliderValueOptions {\n\t\toptions = options || {};\n\t\tif( options.value == null ) {\n\t\t\toptions.value = 0;\n\t\t}\n\t\tconst text = options.text = options.text || {};\n\t\tif( text.value == null ) {\n\t\t\ttext.value = options.value;\n\t\t}\n\t\tif( options.visible == null ) {\n\t\t\toptions.visible = false;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected newLabelMin( options?: OPTIONS ): DSliderLabel {\n\t\treturn new DSliderLabel( this.toLabelMinOptions( options && options.min ) );\n\t}\n\n\tprotected toLabelMinOptions( options?: DSliderLabelOptions ): DSliderLabelOptions {\n\t\toptions = options || {};\n\t\tif( options.value == null ) {\n\t\t\toptions.value = 0;\n\t\t}\n\t\tconst text = options.text = options.text || {};\n\t\tif( text.value == null ) {\n\t\t\ttext.value = `${options.value}`;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected newLabelMax( options?: OPTIONS ): DSliderLabel {\n\t\treturn new DSliderLabel( this.toLabelMaxOptions( options && options.max ) );\n\t}\n\n\tprotected toLabelMaxOptions( options?: DSliderLabelOptions ): DSliderLabelOptions {\n\t\toptions = options || {};\n\t\tif( options.value == null ) {\n\t\t\toptions.value = 1;\n\t\t}\n\t\tconst text = options.text = options.text || {};\n\t\tif( text.value == null ) {\n\t\t\ttext.value = `${options.value}`;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected abstract newTrack( options?: OPTIONS ): DSliderTrack;\n\tprotected abstract newTrackSelected( options?: OPTIONS ): DSliderTrack;\n\n\tprotected abstract onPick( global: Point ): void;\n\tprotected abstract onValuesChange(): void;\n\tprotected abstract moveThumbPosition( thumbCoordinate: number ): void;\n\n\tprotected getValueMargin(): number {\n\t\treturn 14;\n\t}\n\n\tprotected onTrackDown( global: Point ): void {\n\t\tif( this.state.inDisabled ) {\n\t\t\treturn;\n\t\t}\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\n\t\t\tthis._interactionManager = interactionManager;\n\t\t\tinteractionManager.on( UtilPointerEvent.up, this._onTrackUpBound );\n\t\t}\n\t\tthis.onPick( global );\n\t}\n\n\tprotected onTrackSelectedDown( global: Point ): void {\n\t\tif( this.state.inDisabled ) {\n\t\t\treturn;\n\t\t}\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\n\t\t\tthis._interactionManager = interactionManager;\n\t\t\tinteractionManager.on( UtilPointerEvent.up, this._onTrackSelectedUpBound );\n\t\t}\n\t\tthis.onPick( global );\n\t}\n\n\tprotected onTrackUpBound( e: InteractionEvent ): void {\n\t\tconst interactionManager = this._interactionManager;\n\t\tif( interactionManager ) {\n\t\t\tthis._interactionManager = undefined;\n\t\t\tinteractionManager.off( UtilPointerEvent.up, this._onTrackUpBound );\n\t\t}\n\t}\n\n\tprotected onTrackSelectedUpBound( e: InteractionEvent ): void {\n\t\tconst interactionManager = this._interactionManager;\n\t\tif( interactionManager ) {\n\t\t\tthis._interactionManager = undefined;\n\t\t\tinteractionManager.off( UtilPointerEvent.up, this._onTrackSelectedUpBound );\n\t\t}\n\t}\n\n\tprotected onThumbMove( e: InteractionEvent ): void {\n\t\tif( this.state.inDisabled ) {\n\t\t\treturn;\n\t\t}\n\t\tthis.onPick( e.data.global );\n\t}\n\n\tprotected onThumbDown( e: InteractionEvent ): void {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer ) {\n\t\t\tconst interactionManager = layer.renderer.plugins.interaction;\n\t\t\tthis._interactionManager = interactionManager;\n\t\t\tinteractionManager.on( UtilPointerEvent.move, this._onThumbMoveBound );\n\t\t\tinteractionManager.on( UtilPointerEvent.up, this._onThumbUpBound );\n\t\t}\n\t}\n\n\tprotected onThumbUp( e: InteractionEvent ): void {\n\t\tconst interactionManager = this._interactionManager;\n\t\tif( interactionManager ) {\n\t\t\tthis._interactionManager = undefined;\n\t\t\tinteractionManager.off( UtilPointerEvent.move, this._onThumbMoveBound );\n\t\t\tinteractionManager.off( UtilPointerEvent.up, this._onThumbUpBound );\n\t\t}\n\t}\n\n\tprotected updateValue(): void {\n\t\tconst min = this._min.value;\n\t\tconst max = this._max.value;\n\t\tconst value = this._value;\n\t\tconst newValue = value.rounder( min + this._ratioValue * ( max - min ) );\n\t\tconst oldValue = value.value;\n\t\tif( newValue !== oldValue ) {\n\t\t\tvalue.value = newValue;\n\t\t\tvalue.text = value.value;\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t}\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.onValuesChange();\n\t}\n\n\t/**\n\t * Returns a current value.\n\t */\n\tget value(): number {\n\t\treturn this._value.value;\n\t}\n\n\t/**\n\t * Sets a current value.\n\t */\n\tset value( value: number ) {\n\t\tvalue = Math.max( this._min.value, Math.min( this._max.value, value ) );\n\t\t// Adjust if value is new\n\t\tif( this._value.value !== value ) {\n\t\t\tthis._value.value = value;\n\t\t\tthis.onValuesChange();\n\t\t}\n\t}\n\n\t/**\n\t * Returns a minimum value.\n\t */\n\tget min(): number {\n\t\treturn this._min.value;\n\t}\n\n\t/**\n\t * Sets a minimum value.\n\t */\n\tset min( newMin: number ) {\n\t\tconst min = this._min;\n\t\tnewMin = Math.min( this._max.value, newMin );\n\t\tif( min.value !== newMin ) {\n\t\t\tconst value = this._value;\n\t\t\tmin.text = min.value = newMin;\n\t\t\tvalue.value = Math.max( newMin, value.value );\n\t\t\tthis.onValuesChange();\n\t\t}\n\t}\n\n\t/**\n\t * Returns a maximum value.\n\t */\n\tget max(): number {\n\t\treturn this._max.value;\n\t}\n\n\t/**\n\t * Sets a maximum value.\n\t */\n\tset max( newMax: number ) {\n\t\tconst max = this._max;\n\t\tnewMax = Math.max( this._min.value, newMax );\n\t\tif( max.value !== newMax ) {\n\t\t\tconst value = this._value;\n\t\t\tmax.text = max.value = newMax;\n\t\t\tvalue.value = Math.min( newMax, value.value );\n\t\t\tthis.onValuesChange();\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSlider\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\n\nexport interface DSliderTrackOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderTrack<VALUE> = DThemeSliderTrack<VALUE>\n> extends DButtonOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeSliderTrack<VALUE = unknown> extends DThemeButton<VALUE> {\n\n}\n\nexport class DSliderTrack<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderTrack<VALUE> = DThemeSliderTrack<VALUE>,\n\tOPTIONS extends DSliderTrackOptions<VALUE, THEME> = DSliderTrackOptions<VALUE, THEME>\n> extends DButton<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DSliderTrack\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DSliderTrack, DSliderTrackOptions, DThemeSliderTrack } from \"./d-slider-track\";\n\nexport interface DSliderTrackHorizontalOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderTrackHorizontal<VALUE> = DThemeSliderTrackHorizontal<VALUE>\n> extends DSliderTrackOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeSliderTrackHorizontal<VALUE = unknown> extends DThemeSliderTrack<VALUE> {\n\n}\n\nexport class DSliderTrackHorizontal<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderTrackHorizontal<VALUE> = DThemeSliderTrackHorizontal<VALUE>,\n\tOPTIONS extends DSliderTrackHorizontalOptions<VALUE, THEME> = DSliderTrackHorizontalOptions<VALUE, THEME>\n> extends DSliderTrack<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DSliderTrackHorizontal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DSlider, DSliderOptions, DThemeSlider } from \"./d-slider\";\nimport { DSliderLabelOptions } from \"./d-slider-label\";\nimport { DSliderTrack } from \"./d-slider-track\";\nimport { DSliderTrackHorizontal } from \"./d-slider-track-horizontal\";\nimport { DSliderValueOptions } from \"./d-slider-value\";\n\nexport interface DSliderHorizontalOptions<THEME extends DThemeSliderHorizontal> extends DSliderOptions<THEME> {\n\n}\n\nexport interface DThemeSliderHorizontal extends DThemeSlider {\n\n}\n\nexport class DSliderHorizontal<\n\tTHEME extends DThemeSliderHorizontal = DThemeSliderHorizontal,\n\tOPTIONS extends DSliderHorizontalOptions<THEME> = DSliderHorizontalOptions<THEME>\n> extends DSlider<THEME, OPTIONS> {\n\tprotected newTrack( options?: OPTIONS ): DSliderTrack {\n\t\treturn new DSliderTrackHorizontal( options && options.track );\n\t}\n\n\tprotected newTrackSelected( options?: OPTIONS ): DSliderTrack {\n\t\treturn new DSliderTrackHorizontal( options && options.track );\n\t}\n\n\tprotected toValueOptions( options?: DSliderValueOptions ): DSliderValueOptions {\n\t\toptions = super.toValueOptions( options );\n\t\tif( options.y == null ) {\n\t\t\toptions.y = ( p, s ) => p * 0.5 - s - this.getValueMargin();\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected toLabelMinOptions( options?: DSliderLabelOptions ): DSliderLabelOptions {\n\t\toptions = super.toLabelMinOptions( options );\n\t\tif( options.x == null ) {\n\t\t\toptions.x = ( p, s ) => -s * 0.5;\n\t\t}\n\t\tif( options.y == null ) {\n\t\t\toptions.y = ( p, s ) => -s;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected toLabelMaxOptions( options?: DSliderLabelOptions ): DSliderLabelOptions {\n\t\toptions = super.toLabelMaxOptions( options );\n\t\tif( options.x == null ) {\n\t\t\toptions.x = ( p, s ) => p - s * 0.5;\n\t\t}\n\t\tif( options.y == null ) {\n\t\t\toptions.y = ( p, s ) => -s;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected onPick( global: Point ): void {\n\t\tconst point = new Point(0, 0);\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst x = Math.max( 0, Math.min( this._track.width, point.x ) );\n\t\tthis._ratioValue = x / this._track.width;\n\t\tthis.moveThumbPosition( x );\n\t}\n\n\tprotected onValuesChange(): void {\n\t\tconst min = this._min.value;\n\t\tconst max = this._max.value;\n\t\tconst value = this._value.value;\n\t\tthis._ratioValue = ( value - min ) / ( max - min );\n\t\tconst x =  this._ratioValue * this._track.width;\n\t\tthis.moveThumbPosition( x );\n\t}\n\n\tprotected moveThumbPosition( x: number ): void {\n\t\tconst thumb = this._thumb;\n\t\tthumb.x = x - thumb.width * 0.5;\n\n\t\tthis._trackSelected.width = x;\n\n\t\tconst value = this._value;\n\t\tvalue.x = x - value.width * 0.5;\n\n\t\tthis.updateValue();\n\t}\n\n\tprotected toThumbCoordinate( x: number ): number {\n\t\treturn x - this._thumb.width * 0.5;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSliderHorizontal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DSliderTrack, DSliderTrackOptions, DThemeSliderTrack } from \"./d-slider-track\";\n\nexport interface DSliderTrackVerticalOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderTrackVertical<VALUE> = DThemeSliderTrackVertical<VALUE>\n> extends DSliderTrackOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeSliderTrackVertical<VALUE = unknown> extends DThemeSliderTrack<VALUE> {\n\n}\n\nexport class DSliderTrackVertical<\n\tVALUE = unknown,\n\tTHEME extends DThemeSliderTrackVertical<VALUE> = DThemeSliderTrackVertical<VALUE>,\n\tOPTIONS extends DSliderTrackVerticalOptions<VALUE, THEME> = DSliderTrackVerticalOptions<VALUE, THEME>\n> extends DSliderTrack<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DSliderTrackVertical\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DSlider, DSliderOptions, DThemeSlider } from \"./d-slider\";\nimport { DSliderLabelOptions } from \"./d-slider-label\";\nimport { DSliderTrack } from \"./d-slider-track\";\nimport { DSliderTrackVertical } from \"./d-slider-track-vertical\";\n\nexport interface DSliderVerticalOptions<\n\tTHEME extends DThemeSliderVertical = DThemeSliderVertical\n> extends DSliderOptions<THEME> {\n\n}\n\nexport interface DThemeSliderVertical extends DThemeSlider {\n\n}\n\nexport class DSliderVertical<\n\tTHEME extends DThemeSliderVertical = DThemeSliderVertical,\n\tOPTIONS extends DSliderVerticalOptions<THEME> = DSliderVerticalOptions<THEME>\n> extends DSlider<THEME, OPTIONS> {\n\tprotected newTrack( options?: OPTIONS ): DSliderTrack {\n\t\treturn new DSliderTrackVertical( options && options.track );\n\t}\n\n\tprotected newTrackSelected( options?: OPTIONS ): DSliderTrack {\n\t\treturn new DSliderTrackVertical( options && options.track );\n\t}\n\n\tprotected toLabelMinOptions( options?: DSliderLabelOptions ): DSliderLabelOptions {\n\t\toptions = super.toLabelMinOptions( options );\n\t\tif( options.x == null ) {\n\t\t\toptions.x = ( p, s ) => -s;\n\t\t}\n\t\tif( options.y == null ) {\n\t\t\toptions.y = ( p, s ) => p - s * 0.5;\n\t\t}\n\t\tconst text = options.text = options.text || {};\n\t\tconst textAlign = text.align = text.align || {};\n\t\tif( textAlign.horizontal == null ) {\n\t\t\ttextAlign.horizontal = DAlignHorizontal.RIGHT;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected toLabelMaxOptions( options?: DSliderLabelOptions ): DSliderLabelOptions {\n\t\toptions = super.toLabelMaxOptions( options );\n\t\tif( options.x == null ) {\n\t\t\toptions.x = ( p, s ) => -s;\n\t\t}\n\t\tif( options.y == null ) {\n\t\t\toptions.y = ( p, s ) => -s * 0.5;\n\t\t}\n\t\tconst text = options.text = options.text || {};\n\t\tconst textAlign = text.align = text.align || {};\n\t\tif( textAlign.horizontal == null ) {\n\t\t\ttextAlign.horizontal = DAlignHorizontal.RIGHT;\n\t\t}\n\t\treturn options;\n\t}\n\n\tprotected onPick( global: Point ): void {\n\t\tconst point = new Point( 0, 0 );\n\t\tthis.toLocal( global, undefined, point );\n\t\tconst height = this.height;\n\t\tconst y = Math.max( 0, Math.min( height, point.y ) );\n\t\tthis._ratioValue = ( height - y ) / height;\n\t\tthis.moveThumbPosition( y );\n\t}\n\n\tprotected onValuesChange(): void {\n\t\tconst min = this._min.value;\n\t\tconst max = this._max.value;\n\t\tconst value = this._value.value;\n\t\tthis._ratioValue = ( value - min ) / ( max - min );\n\t\tconst y = this.height * ( 1 - this._ratioValue );\n\t\tthis.moveThumbPosition( y );\n\t}\n\n\tprotected moveThumbPosition( y: number ): void {\n\t\tconst thumb = this._thumb;\n\t\tthumb.y = y - thumb.height * 0.5;\n\n\t\tconst trackSelected = this._trackSelected;\n\t\ttrackSelected.y = y;\n\t\ttrackSelected.height = this.height - y;\n\n\t\tconst value = this._value;\n\t\tvalue.y = y - value.height - this.getValueMargin();\n\n\t\tthis.updateValue();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DSliderVertical\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DTableEditable, DTableRenderable } from \"./d-table-column\";\n\nexport interface DTableBodyCellsColumnEditing<ROW> {\n\tenable: boolean | DTableEditable<ROW>;\n}\n\nexport interface DTableBodyCellsColumn<ROW> {\n\tediting: DTableBodyCellsColumnEditing<ROW>;\n\trenderable: boolean | DTableRenderable<ROW>;\n}\n\nexport interface DTableBodyCellsTarget {\n\trenderable: boolean;\n\tstate: DBaseStateSet;\n}\n\nexport class DTableBodyCells {\n\tstatic setReadOnly<ROW>( target: DTableBodyCellsTarget, row: ROW, columnIndex: number, column: DTableBodyCellsColumn<ROW> ): void {\n\t\ttarget.state.isReadOnly = this.toReadOnly( row, columnIndex, column );\n\t}\n\n\tstatic setRenderable<ROW>( target: DTableBodyCellsTarget, row: ROW, columnIndex: number, column: DTableBodyCellsColumn<ROW> ): void {\n\t\tconst renderable = this.toRenderable( row, columnIndex, column );\n\t\ttarget.renderable = renderable;\n\t\ttarget.state.isDisabled = ! renderable;\n\t}\n\n\tstatic toReadOnly<ROW>( row: ROW, columnIndex: number, column: DTableBodyCellsColumn<ROW> ): boolean {\n\t\tconst enable = column.editing.enable;\n\t\tif( enable === true ) {\n\t\t\treturn false;\n\t\t} else if( enable === false ) {\n\t\t\treturn true;\n\t\t} else {\n\t\t\treturn ! enable( row, columnIndex );\n\t\t}\n\t}\n\tstatic toRenderable<ROW>( row: ROW, columnIndex: number, column: DTableBodyCellsColumn<ROW> ): boolean {\n\t\tconst renderable = column.renderable;\n\t\tif( renderable === true ) {\n\t\t\treturn true;\n\t\t} else if( renderable === false ) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\treturn renderable( row, columnIndex );\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectDialogOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectDialog<VALUE> = DThemeTableBodyCellSelectDialog<VALUE>\n> extends DButtonOptions<VALUE | null, THEME> {\n\t/**\n\t * False to stop synchronization of the selected value and the text.\n\t */\n\tsync?: boolean;\n}\n\nexport interface DThemeTableBodyCellSelectDialog<VALUE = unknown> extends DThemeButton<VALUE | null> {\n\tisSyncEnabled(): boolean;\n}\n\nexport class DTableBodyCellSelectDialog<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectDialog<VALUE> = DThemeTableBodyCellSelectDialog<VALUE>,\n\tOPTIONS extends DTableBodyCellSelectDialogOptions<ROW, VALUE, THEME> =\n\t\tDTableBodyCellSelectDialogOptions<ROW, VALUE, THEME>\n> extends DButton<VALUE | null, THEME, OPTIONS> implements DTableBodyCell<ROW, VALUE | null> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, VALUE | null>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, VALUE | null>;\n\tprotected _isSyncEnabled: boolean;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE | null>, onChange: DTableBodyCellOnChange<ROW, VALUE | null>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t\tthis._isSyncEnabled = ( options?.sync ?? this.theme.isSyncEnabled() );\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst selecting = this._column.selecting;\n\t\tconst dialog = selecting.dialog;\n\t\tif( dialog ) {\n\t\t\tconst oldValue = this._textValueComputed ?? null;\n\t\t\tselecting.setter( dialog, oldValue );\n\t\t\tdialog.open().then((): void => {\n\t\t\t\tconst newValue = selecting.getter( dialog );\n\t\t\t\tif( this._isSyncEnabled ) {\n\t\t\t\t\tif( newValue !== oldValue ) {\n\t\t\t\t\t\tthis.text = newValue;\n\t\t\t\t\t\tthis.onValueChange( newValue, oldValue );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.onValueChange( newValue, null );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onValueChange( newValue: VALUE | null, oldValue: VALUE | null ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, VALUE | null> {\n\t\treturn this._column;\n\t}\n\n\tget value(): VALUE | null {\n\t\tconst textValueComputed = this._textValueComputed;\n\t\tif( textValueComputed !== undefined ) {\n\t\t\treturn textValueComputed;\n\t\t}\n\t\treturn null;\n\t}\n\n\tset value( value: VALUE | null ) {\n\t\tthis.text = value;\n\t}\n\n\tset(\n\t\tvalue: VALUE | null, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tif( forcibly ) {\n\t\t\tthis._textValue = value as VALUE;\n\t\t\tthis._textValueComputed = value as VALUE;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t} else {\n\t\t\tthis.text = value as VALUE;\n\t\t}\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectDialog\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDTableBodyCellSelectDialog, DTableBodyCellSelectDialogOptions, DThemeTableBodyCellSelectDialog\n} from \"./d-table-body-cell-select-dialog\";\n\nexport interface DTableBodyCellActionDialogOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellActionDialog<VALUE> = DThemeTableBodyCellActionDialog<VALUE>\n> extends DTableBodyCellSelectDialogOptions<ROW, VALUE, THEME> {\n\n}\n\nexport interface DThemeTableBodyCellActionDialog<VALUE = unknown> extends DThemeTableBodyCellSelectDialog<VALUE> {\n\n}\n\nexport class DTableBodyCellActionDialog<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellActionDialog<VALUE> = DThemeTableBodyCellActionDialog<VALUE>,\n\tOPTIONS extends DTableBodyCellActionDialogOptions<ROW, VALUE, THEME> = DTableBodyCellActionDialogOptions<ROW, VALUE, THEME>\n> extends DTableBodyCellSelectDialog<ROW, VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellActionDialog\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DDropdown, DDropdownOptions, DThemeDropdown } from \"./d-dropdown\";\nimport { DMenu } from \"./d-menu\";\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellActionMenuOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellActionMenu = DThemeTableBodyCellActionMenu\n> extends DDropdownOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeTableBodyCellActionMenu extends DThemeDropdown {\n\n}\n\nexport class DTableBodyCellActionMenu<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellActionMenu = DThemeTableBodyCellActionMenu,\n\tOPTIONS extends DTableBodyCellActionMenuOptions<ROW, VALUE, THEME> = DTableBodyCellActionMenuOptions<ROW, VALUE, THEME>\n> extends DDropdown<VALUE, THEME, OPTIONS> implements DTableBodyCell<ROW, VALUE | null> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, VALUE | null>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, VALUE | null>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE | null>, onChange: DTableBodyCellOnChange<ROW, VALUE | null>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onMenuSelect( selected: VALUE, item: DMenuItem<VALUE>, menu: DMenu<VALUE> ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, selected );\n\t\t\tsuper.onMenuSelect( selected, item, menu );\n\t\t\tthis._onChange( selected, null, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tprotected onKeyDownArrowDown( e: KeyboardEvent ): boolean {\n\t\treturn false;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, VALUE | null> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.text = value as string | undefined;\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellActionMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectPromiseOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectPromise<VALUE> = DThemeTableBodyCellSelectPromise<VALUE>\n> extends DButtonOptions<VALUE | null, THEME> {\n\t/**\n\t * False to stop synchronizing the resolved value and the text.\n\t */\n\tsync?: boolean;\n}\n\nexport interface DThemeTableBodyCellSelectPromise<VALUE = unknown> extends DThemeButton<VALUE | null> {\n\tisSyncEnabled(): boolean;\n}\n\nexport class DTableBodyCellSelectPromise<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectPromise<VALUE> = DThemeTableBodyCellSelectPromise<VALUE>,\n\tOPTIONS extends DTableBodyCellSelectPromiseOptions<ROW, VALUE, THEME> =\n\t\tDTableBodyCellSelectPromiseOptions<ROW, VALUE, THEME>\n> extends DButton<VALUE | null, THEME, OPTIONS> implements DTableBodyCell<ROW, VALUE | null> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, VALUE | null>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, VALUE | null>;\n\tprotected _isSyncEnabled: boolean;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE | null>, onChange: DTableBodyCellOnChange<ROW, VALUE | null>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t\tthis._isSyncEnabled = ( options?.sync ?? this.theme.isSyncEnabled() );\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst selecting = this._column.selecting;\n\t\tconst promise = selecting.promise;\n\t\tif( promise ) {\n\t\t\tpromise().then(( newValue: VALUE | null ): void => {\n\t\t\t\tif( this._isSyncEnabled ) {\n\t\t\t\t\tconst oldValue = this._textValueComputed ?? null;\n\t\t\t\t\tif( newValue !== oldValue ) {\n\t\t\t\t\t\tthis.text = newValue;\n\t\t\t\t\t\tthis.onValueChange( newValue, oldValue );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.onValueChange( newValue, null );\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tprotected onValueChange( newValue: VALUE | null, oldValue: VALUE | null ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, VALUE | null> {\n\t\treturn this._column;\n\t}\n\n\tget value(): VALUE | null {\n\t\tconst textValueComputed = this._textValueComputed;\n\t\tif( textValueComputed !== undefined ) {\n\t\t\treturn textValueComputed;\n\t\t}\n\t\treturn null;\n\t}\n\n\tset value( value: VALUE | null ) {\n\t\tthis.text = value;\n\t}\n\n\tset(\n\t\tvalue: VALUE | null, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tif( forcibly ) {\n\t\t\tthis._textValue = value;\n\t\t\tthis._textValueComputed = value;\n\t\t\tthis.onTextChange();\n\t\t\tthis.createOrUpdateText();\n\t\t} else {\n\t\t\tthis.text = value;\n\t\t}\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectPromise\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport {\n\tDTableBodyCellSelectPromise, DTableBodyCellSelectPromiseOptions, DThemeTableBodyCellSelectPromise\n} from \"./d-table-body-cell-select-promise\";\n\nexport interface DTableBodyCellActionPromiseOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellActionPromise<VALUE> = DThemeTableBodyCellActionPromise<VALUE>\n> extends DTableBodyCellSelectPromiseOptions<ROW, VALUE, THEME> {\n\n}\n\nexport interface DThemeTableBodyCellActionPromise<VALUE = unknown> extends DThemeTableBodyCellSelectPromise<VALUE> {\n\n}\n\nexport class DTableBodyCellActionPromise<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellActionPromise<VALUE> = DThemeTableBodyCellActionPromise<VALUE>,\n\tOPTIONS extends DTableBodyCellActionPromiseOptions<ROW, VALUE, THEME> = DTableBodyCellActionPromiseOptions<ROW, VALUE, THEME>\n> extends DTableBodyCellSelectPromise<ROW, VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellActionPromise\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { DStateAwareOrValue } from \"./d-state-aware\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellTextOptions<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellText<VALUE> = DThemeTableBodyCellText<VALUE>\n> extends DImageBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeTableBodyCellText<VALUE = unknown> extends DThemeImageBase<VALUE> {\n\n}\n\nexport class DTableBodyCellText<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellText<VALUE> = DThemeTableBodyCellText<VALUE>,\n\tOPTIONS extends DTableBodyCellTextOptions<ROW, VALUE, THEME> = DTableBodyCellTextOptions<ROW, VALUE, THEME>\n> extends DImageBase<VALUE, THEME, OPTIONS> implements DTableBodyCell<ROW, VALUE> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, VALUE>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, VALUE>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE>, onChange: DTableBodyCellOnChange<ROW, VALUE>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, VALUE> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.text = value as DStateAwareOrValue<VALUE>;\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButtonBaseWhen } from \"./d-button-base-when\";\nimport { DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCellText, DTableBodyCellTextOptions, DThemeTableBodyCellText } from \"./d-table-body-cell-text\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { toEnum } from \"./util/to-enum\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTableBodyCellButtonOptions<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellButton<VALUE> = DThemeTableBodyCellButton<VALUE>\n> extends DTableBodyCellTextOptions<ROW, VALUE | null, THEME> {\n\twhen?: DButtonBaseWhen | (keyof typeof DButtonBaseWhen);\n}\n\nexport interface DThemeTableBodyCellButton<VALUE = unknown> extends DThemeTableBodyCellText<VALUE | null> {\n\n}\n\nexport class DTableBodyCellButton<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellButton<VALUE> = DThemeTableBodyCellButton<VALUE>,\n\tOPTIONS extends DTableBodyCellButtonOptions<ROW, VALUE, THEME> = DTableBodyCellButtonOptions<ROW, VALUE, THEME>\n> extends DTableBodyCellText<ROW, VALUE | null, THEME, OPTIONS> {\n\tprotected _when: DButtonBaseWhen;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE | null>, onChange: DTableBodyCellOnChange<ROW, VALUE | null>, options?: OPTIONS ) {\n\t\tsuper( columnIndex, column, onChange, options );\n\n\t\tconst when = toEnum( options?.when ?? DButtonBaseWhen.CLICKED, DButtonBaseWhen );\n\t\tthis._when = when;\n\t\tthis.initOnClick( when, this.theme, options );\n\t}\n\n\tprotected initOnClick( when: DButtonBaseWhen, theme: THEME, options?: OPTIONS ): void {\n\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( when === DButtonBaseWhen.CLICKED ) {\n\t\t\t\tthis.onClick( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tonClick( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tthis.onActivate( e );\n\t\t}\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tif( this._when === DButtonBaseWhen.DOUBLE_CLICKED ) {\n\t\t\tthis.onClick( e );\n\t\t}\n\t\treturn super.onDblClick( e, interactionManager );\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tthis.emit( \"active\", this );\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis.emit( \"change\", null, null, this );\n\t\t\tthis._onChange( null, null, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tprotected onActivateKeyDown( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tthis.state.isPressed = true;\n\t\t}\n\t}\n\n\tprotected onActivateKeyUp( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.state.isPressed ) {\n\t\t\t\tthis.onActivate( e );\n\t\t\t}\n\t\t\tthis.state.isPressed = false;\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyDown( e );\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyUp( e );\n\t\t}\n\n\t\treturn super.onKeyUp( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellButton\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButtonCheck, DButtonCheckOptions, DThemeButtonCheck } from \"./d-button-check\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn, DTableColumnType } from \"./d-table-column\";\nimport { DTableData } from \"./d-table-data\";\n\nexport interface DTableBodyCellCheckOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellCheck = DThemeTableBodyCellCheck\n> extends DButtonCheckOptions<boolean, THEME> {\n}\n\nexport interface DThemeTableBodyCellCheck extends DThemeButtonCheck<boolean> {\n\n}\n\nexport class DTableBodyCellCheck<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellCheck = DThemeTableBodyCellCheck,\n\tOPTIONS extends DTableBodyCellCheckOptions<ROW, THEME> = DTableBodyCellCheckOptions<ROW, THEME>\n> extends DButtonCheck<boolean, THEME, OPTIONS> implements DTableBodyCell<ROW, boolean> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, boolean>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, boolean>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, boolean>, onChange: DTableBodyCellOnChange<ROW, boolean>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tthis.onValueChange( true, false );\n\t}\n\n\tprotected onInactivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onInactivate( e );\n\t\tthis.onValueChange( false, true );\n\t}\n\n\tprotected onValueChange( newValue: boolean, oldValue: boolean ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tconst column = this._column;\n\t\t\tcolumn.setter( row, columnIndex, newValue );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\tconst onChange = this._onChange;\n\t\t\tonChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t\tif( newValue && column.type === DTableColumnType.CHECK_SINGLE ) {\n\t\t\t\tthis.onChangeSingle( rowIndex, columnIndex, column, onChange );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onChangeSingle(\n\t\trowIndex: number,\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, boolean>,\n\t\tonChange: DTableBodyCellOnChange<ROW, boolean>\n\t): void {\n\t\tconst tableBodyRow = this.parent;\n\t\tif( tableBodyRow ) {\n\t\t\tconst tableBody = tableBodyRow.parent as any;\n\t\t\tif( tableBody ) {\n\t\t\t\tlet isChanged = false;\n\t\t\t\tconst getter = column.getter;\n\t\t\t\tconst setter = column.setter;\n\t\t\t\tconst data = tableBody.data as DTableData<ROW>;\n\t\t\t\tdata.each(( row: ROW, index: number ): boolean => {\n\t\t\t\t\tif( rowIndex !== index && getter( row, columnIndex ) ) {\n\t\t\t\t\t\tsetter( row, columnIndex, false );\n\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\tonChange( false, true, row, index, columnIndex, this );\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\treturn true;\n\t\t\t\t});\n\t\t\t\tif( isChanged ) {\n\t\t\t\t\ttableBody.update( true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, boolean> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.state.isActive = !! value;\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellCheck\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableData } from \"./d-table-data\";\n\nexport enum DTableDataSelectionType {\n\tNONE,\n\tSINGLE,\n\tMULTIPLE\n}\n\nexport interface DTableDataSelectionOptions {\n\ttype?: (keyof typeof DTableDataSelectionType) | DTableDataSelectionType;\n}\n\nexport interface DTableDataSelection<ROW> extends utils.EventEmitter {\n\t/**\n\t * Returns a copy of an index array of selected rows.\n\t * The order of indices is an insertion order.\n\t */\n\treadonly indices: number[];\n\n\t/**\n\t * Returns a copy of an array of selected row value.\n\t * The order is an insertion order.\n\t */\n\treadonly rows: ROW[];\n\n\treadonly type: DTableDataSelectionType;\n\n\treadonly first: number | null;\n\treadonly last: number | null;\n\n\ttoggle( rowIndex: number ): void;\n\tadd( rowIndex: number ): void;\n\taddTo( rowIndex: number ): void;\n\taddRange( from: number, includeFrom: boolean, to: number, includeTo: boolean ): void;\n\taddAll( rowIndices: number[] ): void;\n\tcontains( rowIndex: number ): boolean;\n\tremove( rowIndex: number ): void;\n\tclear(): void;\n\tclearAndAdd( rowIndex: number ): void;\n\tclearAndAddAll( rowIndices: number[] ): void;\n\tshift( rowIndex: number, amount: number ): void;\n\tsize(): number;\n\tisEmpty(): boolean;\n\n\t/**\n\t * Returns an array of the (index, row value) pairs of selected rows.\n\t * The order of pairs is an insertion order.\n\t */\n\ttoArray(): Array<[ number, ROW ]>;\n\n\t/**\n\t * Returns an sorted array of the (index, row value) pairs of selected rows.\n\t */\n\ttoSortedArray(): Array<[ number, ROW ]>;\n\n\ttoObject(): {[index: number]: ROW};\n\n\ttoMap(): Map<number, ROW>;\n}\n\nexport interface DTableDataSelectionParent<ROW> extends DTableData<ROW> {\n\tupdate(): void;\n}\n\nexport type DTableDataSelectionCreator<NODE> = ( parent: DTableDataSelectionParent<NODE> ) => DTableDataSelection<NODE>;\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonColor, DButtonColorOptions, DThemeButtonColor } from \"./d-button-color\";\nimport { DColorAndAlpha } from \"./d-color-and-alpha\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\nimport { isString } from \"./util/is-string\";\n\nexport interface DTableBodyCellColorOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellColor = DThemeTableBodyCellColor\n> extends DButtonColorOptions<THEME> {\n}\n\nexport interface DThemeTableBodyCellColor extends DThemeButtonColor {\n\n}\n\nexport class DTableBodyCellColor<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellColor = DThemeTableBodyCellColor,\n\tOPTIONS extends DTableBodyCellColorOptions<ROW, THEME> = DTableBodyCellColorOptions<ROW, THEME>\n> extends DButtonColor<THEME, OPTIONS> implements DTableBodyCell<ROW, DColorAndAlpha> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, DColorAndAlpha>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, DColorAndAlpha>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, DColorAndAlpha>, onChange: DTableBodyCellOnChange<ROW, DColorAndAlpha>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onValueChange( newValue: DColorAndAlpha, oldValue: DColorAndAlpha ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tsuper.onValueChange( newValue, oldValue );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, DColorAndAlpha> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tnewValue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tconst value = this._value;\n\t\tif( isNumber( newValue ) ) {\n\t\t\tvalue.color = newValue;\n\t\t\tvalue.alpha = 1;\n\t\t} else if( isString( newValue ) ) {\n\t\t\tconst parsed = Number( newValue );\n\t\t\tvalue.color = (parsed === parsed ? parsed : 0xffffff);\n\t\t\tvalue.alpha = 1;\n\t\t} else if( newValue != null ) {\n\t\t\tconst color = (newValue as any).color;\n\t\t\tconst alpha = (newValue as any).alpha;\n\t\t\tvalue.color = (isNumber( color ) ? color : 0xffffff);\n\t\t\tvalue.alpha = (isNumber( alpha ) ? alpha : 1);\n\t\t} else {\n\t\t\tvalue.color = 0xffffff;\n\t\t\tvalue.alpha = 1;\n\t\t}\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellColor\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDate, DDialogDateOptions } from \"./d-dialog-date\";\nimport { DDialogDates } from \"./d-dialog-dates\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\n\nexport interface DTableBodyCellDateOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDate = DThemeTableBodyCellDate\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogDateOptions;\n}\n\nexport interface DThemeTableBodyCellDate extends DThemeButton<Date> {\n\n}\n\nexport class DTableBodyCellDate<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDate = DThemeTableBodyCellDate,\n\tOPTIONS extends DTableBodyCellDateOptions<ROW, THEME> = DTableBodyCellDateOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell<ROW, Date> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, Date>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, Date>;\n\tprotected _dialog?: DDialogDate;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, Date>, onChange: DTableBodyCellOnChange<ROW, Date>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed?.getTime() ?? Date.now();\n\t\tconst dialog = this.dialog;\n\t\tdialog.current = new Date( value );\n\t\tdialog.new = new Date( value );\n\t\tdialog.page = new Date( value );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = dialog.new;\n\t\t\tconst oldValue = dialog.current;\n\t\t\tthis.text = new Date( newValue.getTime() );\n\t\t\tconst row = this._row;\n\t\t\tif( row !== undefined ) {\n\t\t\t\tconst rowIndex = this._rowIndex;\n\t\t\t\tconst columnIndex = this._columnIndex;\n\t\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t\t}\n\t\t});\n\t}\n\n\tget dialog(): DDialogDate {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options ) {\n\t\t\t\tdialog = new DDialogDate( options );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDates.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, Date> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: Date, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( isNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed === undefined ) {\n\t\t\t\tthis.text = new Date( value );\n\t\t\t} else if( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellDate\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogDatetime, DDialogDatetimeOptions } from \"./d-dialog-datetime\";\nimport { DDialogDatetimes } from \"./d-dialog-datetimes\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerDatetimes } from \"./d-picker-datetimes\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\n\nexport interface DTableBodyCellDatetimeOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDatetime = DThemeTableBodyCellDatetime\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogDatetimeOptions;\n}\n\nexport interface DThemeTableBodyCellDatetime extends DThemeButton<Date> {\n\n}\n\nexport class DTableBodyCellDatetime<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellDatetime = DThemeTableBodyCellDatetime,\n\tOPTIONS extends DTableBodyCellDatetimeOptions<ROW, THEME> = DTableBodyCellDatetimeOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell<ROW, Date> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, Date>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, Date>;\n\tprotected _dialog?: DDialogDatetime;\n\tprotected _datetimeMask?: DPickerDatetimeMask;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, Date>, onChange: DTableBodyCellOnChange<ROW, Date>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed?.getTime() ?? Date.now();\n\t\tconst dialog = this.dialog;\n\t\tdialog.current = new Date( value );\n\t\tdialog.new = new Date( value );\n\t\tdialog.page = new Date( value );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = dialog.new;\n\t\t\tconst oldValue = dialog.current;\n\t\t\tthis.text = new Date( newValue.getTime() );\n\t\t\tconst row = this._row;\n\t\t\tif( row !== undefined ) {\n\t\t\t\tconst rowIndex = this._rowIndex;\n\t\t\t\tconst columnIndex = this._columnIndex;\n\t\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t\t}\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\tlet result = this._datetimeMask;\n\t\tif( result == null ) {\n\t\t\tresult = DPickerDatetimes.toMask( this._options?.dialog?.picker );\n\t\t\tthis._datetimeMask = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tget dialog(): DDialogDatetime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options ) {\n\t\t\t\tdialog = new DDialogDatetime( options );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogDatetimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, Date> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: Date, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( isNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed === undefined ) {\n\t\t\t\tthis.text = new Date( value );\n\t\t\t} else if( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellDatetime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImageBase, DImageBaseOptions, DThemeImageBase } from \"./d-image-base\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellIndexOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellIndex = DThemeTableBodyCellIndex\n> extends DImageBaseOptions<number, THEME> {\n}\n\nexport interface DThemeTableBodyCellIndex<VALUE = unknown> extends DThemeImageBase<number> {\n\n}\n\nexport class DTableBodyCellIndex<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellIndex<VALUE> = DThemeTableBodyCellIndex<VALUE>,\n\tOPTIONS extends DTableBodyCellIndexOptions<ROW, VALUE, THEME> = DTableBodyCellIndexOptions<ROW, VALUE, THEME>\n> extends DImageBase<number, THEME, OPTIONS> implements DTableBodyCell<ROW, VALUE> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, VALUE>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, VALUE>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE>, onChange: DTableBodyCellOnChange<ROW, unknown>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, VALUE> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.text = rowIndex;\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellIndex\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputInteger, DInputIntegerOptions, DThemeInputInteger } from \"./d-input-integer\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputIntegerOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputInteger = DThemeTableBodyCellInputInteger\n> extends DInputIntegerOptions<THEME> {\n}\n\nexport interface DThemeTableBodyCellInputInteger extends DThemeInputInteger {\n\n}\n\nexport class DTableBodyCellInputInteger<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputInteger = DThemeTableBodyCellInputInteger,\n\tOPTIONS extends DTableBodyCellInputIntegerOptions<ROW, THEME> = DTableBodyCellInputIntegerOptions<ROW, THEME>\n> extends DInputInteger<THEME, OPTIONS> implements DTableBodyCell<ROW, number> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, number>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, number>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, number>, onChange: DTableBodyCellOnChange<ROW, number>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onValueChange( newValue: number, oldValue: number ) {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tsuper.onValueChange( newValue, oldValue );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, number> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.text = Number( value );\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputInteger\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputReal, DInputRealOptions, DThemeInputReal } from \"./d-input-real\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputRealOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputReal = DThemeTableBodyCellInputReal\n> extends DInputRealOptions<THEME> {\n}\n\nexport interface DThemeTableBodyCellInputReal extends DThemeInputReal {\n\n}\n\nexport class DTableBodyCellInputReal<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputReal = DThemeTableBodyCellInputReal,\n\tOPTIONS extends DTableBodyCellInputRealOptions<ROW, THEME> = DTableBodyCellInputRealOptions<ROW, THEME>\n> extends DInputReal<THEME, OPTIONS> implements DTableBodyCell<ROW, number> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, number>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, number>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, number>, onChange: DTableBodyCellOnChange<ROW, number>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onValueChange( newValue: number, oldValue: number ) {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tsuper.onValueChange( newValue, oldValue );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, number> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.text = Number( value );\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputReal\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DInputText, DInputTextOptions, DThemeInputText } from \"./d-input-text\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellInputTextOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputText = DThemeTableBodyCellInputText\n> extends DInputTextOptions<THEME> {\n}\n\nexport interface DThemeTableBodyCellInputText extends DThemeInputText {\n\n}\n\nexport class DTableBodyCellInputText<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputText = DThemeTableBodyCellInputText,\n\tOPTIONS extends DTableBodyCellInputTextOptions<ROW, THEME> = DTableBodyCellInputTextOptions<ROW, THEME>\n> extends DInputText<THEME, OPTIONS> implements DTableBodyCell<ROW, string> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, string>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, string>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, string>, onChange: DTableBodyCellOnChange<ROW, string>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onValueChange( newValue: string, oldValue: string ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tsuper.onValueChange( newValue, oldValue );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, string> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.text = String( value );\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputText\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DThemeBase } from \"./d-base\";\nimport { DPadding } from \"./d-padding\";\n\nexport interface DBasePaddingAdjuster {\n\tleft: number;\n\ttop: number;\n\tright: number;\n\tbottom: number;\n}\n\nexport class DBasePaddingAdjustable implements DPadding {\n\tprotected _target: DPadding;\n\tprotected _adjuster: DBasePaddingAdjuster;\n\n\tconstructor( target: DPadding ) {\n\t\tthis._target = target;\n\t\tthis._adjuster = {\n\t\t\tleft: 0,\n\t\t\ttop: 0,\n\t\t\tright: 0,\n\t\t\tbottom: 0\n\t\t};\n\t}\n\n\tget adjuster(): DBasePaddingAdjuster {\n\t\treturn this._adjuster;\n\t}\n\n\tgetTheme(): DThemeBase {\n\t\treturn this._target.getTheme();\n\t}\n\n\tsetTheme( theme: DThemeBase ): void {\n\t\tthis._target.setTheme( theme );\n\t}\n\n\tgetLeft(): number {\n\t\treturn this._target.getLeft() + this._adjuster.left;\n\t}\n\n\tget left(): number | undefined {\n\t\treturn this._target.left;\n\t}\n\n\tset left( left: number | undefined ) {\n\t\tthis._target.left = left;\n\t}\n\n\tgetTop(): number {\n\t\treturn this._target.getTop() + this._adjuster.top;\n\t}\n\n\tget top(): number | undefined {\n\t\treturn this._target.top;\n\t}\n\n\tset top( top: number | undefined ) {\n\t\tthis._target.top = top;\n\t}\n\n\tgetRight(): number {\n\t\treturn this._target.getRight() + this._adjuster.right;\n\t}\n\n\tget right(): number | undefined {\n\t\treturn this._target.right;\n\t}\n\n\tset right( right: number | undefined ) {\n\t\tthis._target.right = right;\n\t}\n\n\tgetBottom(): number {\n\t\treturn this._target.getBottom() + this._adjuster.bottom;\n\t}\n\n\tget bottom(): number | undefined {\n\t\treturn this._target.bottom;\n\t}\n\n\tset bottom( bottom: number | undefined ) {\n\t\tthis._target.bottom = bottom;\n\t}\n\n\tset( padding: number ): void;\n\tset( topAndBottom: number, leftAndRight: number ): void;\n\tset( top: number, leftAndRight: number, bottom: number ): void;\n\tset( top: number, right: number, bottom: number, left: number ): void;\n\tset( top: number, right?: number, bottom?: number, left?: number ) {\n\t\tthis._target.set( top, right!, bottom!, left! );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBasePaddingAdjustable } from \"./d-base-padding-adjustable\";\nimport { DInputText, DInputTextOptions, DThemeInputText } from \"./d-input-text\";\n\nexport interface DTableBodyCellInputTreeInputOptions<\n\tTHEME extends DThemeTableBodyCellInputTreeInput = DThemeTableBodyCellInputTreeInput\n> extends DInputTextOptions<THEME> {\n\n}\n\nexport interface DThemeTableBodyCellInputTreeInput extends DThemeInputText {\n\n}\n\nexport class DTableBodyCellInputTreeInput<\n\tTHEME extends DThemeTableBodyCellInputTreeInput = DThemeTableBodyCellInputTreeInput,\n\tOPTIONS extends DTableBodyCellInputTreeInputOptions<THEME> = DTableBodyCellInputTreeInputOptions<THEME>\n> extends DInputText<THEME, OPTIONS> {\n\tprotected _padding!: DBasePaddingAdjustable;\n\n\tconstructor( options?: OPTIONS ) {\n\t\tsuper( options );\n\t\tthis._padding = new DBasePaddingAdjustable( this._padding );\n\t}\n\n\tget padding(): DBasePaddingAdjustable {\n\t\treturn this._padding;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputTreeInput\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DButtonBase, DButtonBaseOptions, DThemeButtonBase } from \"./d-button-base\";\n\nexport interface DTableBodyCellInputTreeMarkerOptions<\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellInputTreeMarker<VALUE> = DThemeTableBodyCellInputTreeMarker<VALUE>\n> extends DButtonBaseOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeTableBodyCellInputTreeMarker<VALUE = unknown> extends DThemeButtonBase<VALUE> {\n\n}\n\nexport class DTableBodyCellInputTreeMarker<\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellInputTreeMarker<VALUE> = DThemeTableBodyCellInputTreeMarker<VALUE>,\n\tOPTIONS extends DTableBodyCellInputTreeMarkerOptions<VALUE, THEME> = DTableBodyCellInputTreeMarkerOptions<VALUE, THEME>\n> extends DButtonBase<VALUE, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputTreeMarker\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * {@link DTable} states.\n */\nexport const DTableState = {\n\t/**\n\t * Start cells in rows.\n\t */\n\tSTART: \"START\",\n\n\t/**\n\t * End cells in rows.\n\t */\n\tEND: \"END\",\n\n\t/**\n\t * Cells of frozen columns.\n\t */\n\tFROZEN: \"FROZEN\",\n\n\t/**\n\t * Cells of a right-most frozen column.\n\t */\n\tFROZEN_END: \"FROZEN_END\",\n\n\t/**\n\t * Header cells of sortable columns.\n\t */\n\tSORTABLE: \"SORTABLE\",\n\n\t/**\n\t * Header cells of columns sorted in the ascending order.\n\t */\n\tSORTED_ASCENDING: \"SORTED_ASCENDING\",\n\n\t/**\n\t * Header cells of columns sorted in the descending order.\n\t */\n\tSORTED_DESCENDING: \"SORTED_DESCENDING\",\n\n\t/**\n\t * Tree cells with child cells.\n\t */\n\tHAS_CHILDREN: \"HAS_CHILDREN\",\n\n\t/**\n\t * Tree cells opened.\n\t */\n\tOPENED: \"OPENED\",\n\n\t/**\n\t * Header cells of checkable columns.\n\t */\n\tCHECKABLE: \"CHECKABLE\",\n\n\t/**\n\t * Selectable row\n\t */\n\tSELECTABLE: \"SELECTABLE\"\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DBase, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DTableBodyCellInputTreeInput, DTableBodyCellInputTreeInputOptions } from \"./d-table-body-cell-input-tree-input\";\nimport { DTableBodyCellInputTreeMarker } from \"./d-table-body-cell-input-tree-marker\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableState } from \"./d-table-state\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\n\nexport interface DThemeTableBodyCellInputTree extends DThemeBase {\n\tgetLevelPadding( level: number ): number;\n}\n\nconst toBaseOptions = ( options?: DTableBodyCellInputTreeInputOptions ) => {\n\tif( options != null ) {\n\t\treturn {\n\t\t\tweight: options.weight,\n\t\t\twidth: options.width\n\t\t};\n\t}\n\treturn undefined;\n}\n\nexport class DTableBodyCellInputTree<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellInputTree = DThemeTableBodyCellInputTree,\n\tOPTIONS extends DTableBodyCellInputTreeInputOptions = DTableBodyCellInputTreeInputOptions\n> extends DBase<THEME> implements DTableBodyCell<ROW, string> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, string>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, string>;\n\n\tprotected _marker: DTableBodyCellInputTreeMarker;\n\tprotected _input: DTableBodyCellInputTreeInput;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, string>, onChange: DTableBodyCellOnChange<ROW, string>, options?: OPTIONS ) {\n\t\tsuper( toBaseOptions( options ) );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\n\t\t// Input\n\t\tconst input = this.newInput( options );\n\t\tthis._input = input;\n\t\tthis.addChild( input );\n\n\t\t// Marker\n\t\tconst marker = this.newMarker( options );\n\t\tthis._marker = marker;\n\t\tthis.addChild( marker );\n\n\t\tthis.state.isFocusable = false;\n\t\tthis.state.isFocusReverse = true;\n\t}\n\n\tprotected newInput( options?: OPTIONS ): DTableBodyCellInputTreeInput {\n\t\treturn new DTableBodyCellInputTreeInput( this.toInputOptions( options ) );\n\t}\n\n\tprotected toInputOptions( options?: OPTIONS ): DTableBodyCellInputTreeInputOptions {\n\t\treturn {\n\t\t\tweight: 1,\n\t\t\ttext: options?.text,\n\t\t\tediting: options?.editing,\n\t\t\twhen: options?.when,\n\t\t\tcursor: options?.cursor,\n\t\t\ton: {\n\t\t\t\tchange: ( newValue: string, oldValue: string ): void => {\n\t\t\t\t\tthis.onInputChange( newValue, oldValue );\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t}\n\n\tprotected onInputChange( newValue: string, oldValue: string ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tprotected newMarker( options?: OPTIONS ) {\n\t\treturn new DTableBodyCellInputTreeMarker({\n\t\t\tvisible: false,\n\t\t\ton: {\n\t\t\t\tactive: (): void => {\n\t\t\t\t\tthis.onMarkerActive();\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t}\n\n\tprotected onMarkerActive(): void {\n\t\tif( this._marker.state.is( DTableState.HAS_CHILDREN ) ) {\n\t\t\tconst row = this.parent;\n\t\t\tif( row ) {\n\t\t\t\tconst body = row.parent as any;\n\t\t\t\tif( body ) {\n\t\t\t\t\tconst data = body.data;\n\t\t\t\t\tif( data && data.toggle ) {\n\t\t\t\t\t\tdata.toggle( this._row );\n\t\t\t\t\t\tthis.emit( \"cellchange\", null, null, this._row, this._rowIndex, this._columnIndex, this );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, string> {\n\t\treturn this._column;\n\t}\n\n\tonRowSelect( e: interaction.InteractionEvent, local: Point ): boolean {\n\t\tif( local.x <= this.position.x + this._input.padding.getLeft() ) {\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tconst input = this._input;\n\t\tinput.visible = true;\n\t\tinput.text = String( value );\n\n\t\tconst marker = this._marker;\n\t\tif( isNumber( supplimental ) ) {\n\t\t\tconst isOpened = !! (supplimental & 0x1);\n\t\t\tconst hasChildren = !! (supplimental & 0x2);\n\t\t\tconst level = (supplimental >> 2);\n\t\t\tconst markerState = marker.state;\n\t\t\tmarkerState.lock();\n\t\t\tmarkerState.set( DTableState.HAS_CHILDREN, hasChildren );\n\t\t\tmarkerState.set( DBaseState.DISABLED, ! hasChildren );\n\t\t\tmarkerState.set( DTableState.OPENED, isOpened );\n\t\t\tmarkerState.unlock();\n\t\t\tconst padding = this.theme.getLevelPadding( level );\n\t\t\tmarker.width = padding;\n\t\t\tif( hasChildren ) {\n\t\t\t\tmarker.show();\n\t\t\t} else {\n\t\t\t\tmarker.hide();\n\t\t\t}\n\t\t\tinput.padding.adjuster.left = padding;\n\t\t} else {\n\t\t\tmarker.state.removeAll( DTableState.OPENED, DTableState.HAS_CHILDREN );\n\t\t\tmarker.hide();\n\t\t}\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this._input, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t\tthis._input.visible = false;\n\t\tthis._marker.hide();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellInputTree\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButtonBaseWhen } from \"./d-button-base-when\";\nimport { DLink, DLinkChecker, DLinkOptions, DLinkUrlMaker, DThemeLink } from \"./d-link\";\nimport { DLinkMenuItemId } from \"./d-link-menu-item-id\";\nimport { DLinkTarget } from \"./d-link-target\";\nimport { DLinks } from \"./d-links\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport {\n\tDTableBodyCellButton, DTableBodyCellButtonOptions, DThemeTableBodyCellButton\n} from \"./d-table-body-cell-button\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isString } from \"./util/is-string\";\n\nexport type DTableBodyCellLinkUrlMaker<ROW, VALUE> = (\n\trow: ROW, rowIndex: number, columnIndex: number, link: DTableBodyCell<ROW, VALUE | null>\n) => string | null | Promise<string | null>;\n\nexport type DTableBodyCellLinkChecker<ROW, VALUE> = (\n\trow: ROW, rowIndex: number, columnIndex: number, link: DTableBodyCell<ROW, VALUE | null>\n) => boolean | Promise<boolean>;\n\nexport interface DTableBodyCellLinkLinkOptions<ROW, VALUE> {\n\turl?: string | DTableBodyCellLinkUrlMaker<ROW, VALUE>;\n\ttarget?: DLinkTarget | (keyof typeof DLinkTarget);\n\tchecker?: DTableBodyCellLinkChecker<ROW, VALUE>;\n\tmenu?: DMenuOptions<DLinkMenuItemId> | DMenu<DLinkMenuItemId>;\n}\n\nexport interface DTableBodyCellLinkOptions<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellLink<VALUE> = DThemeTableBodyCellLink<VALUE>\n> extends DTableBodyCellButtonOptions<ROW, VALUE, THEME> {\n\tlink?: DTableBodyCellLinkLinkOptions<ROW, VALUE>;\n}\n\nexport interface DThemeTableBodyCellLink<VALUE = unknown> extends DThemeTableBodyCellButton<VALUE>, DThemeLink {\n\n}\n\nexport const toLinkOptions = <ROW, VALUE>(\n\tcell: DTableBodyCell<ROW, VALUE | null>,\n\toptions?: DTableBodyCellLinkLinkOptions<ROW, VALUE>\n): DLinkOptions | undefined => {\n\tif( options ) {\n\t\treturn {\n\t\t\turl: toUrl( cell, options.url ),\n\t\t\ttarget: options.target,\n\t\t\tchecker: toChecker( cell, options.checker ),\n\t\t\tmenu: options.menu\n\t\t};\n\t}\n\treturn undefined;\n};\n\nexport const toUrl = <ROW, VALUE>(\n\tcell: DTableBodyCell<ROW, VALUE | null>,\n\turl?: string | DTableBodyCellLinkUrlMaker<ROW, VALUE>\n): string | DLinkUrlMaker | undefined => {\n\tif( isString( url ) || url == null ) {\n\t\treturn url;\n\t} else {\n\t\treturn () => {\n\t\t\tconst row = cell.row;\n\t\t\tif( row !== undefined ) {\n\t\t\t\treturn url( row, cell.rowIndex, cell.columnIndex, cell );\n\t\t\t}\n\t\t\treturn null;\n\t\t};\n\t}\n};\n\nexport const toChecker = <ROW, VALUE>(\n\tcell: DTableBodyCell<ROW, VALUE | null>,\n\tchecker?: DTableBodyCellLinkChecker<ROW, VALUE>\n): DLinkChecker | undefined => {\n\tif( checker != null ) {\n\t\treturn (): boolean | Promise<boolean> => {\n\t\t\tconst row = cell.row;\n\t\t\tif( row !== undefined ) {\n\t\t\t\treturn checker( row, cell.rowIndex, cell.columnIndex, cell );\n\t\t\t}\n\t\t\treturn false;\n\t\t};\n\t}\n\treturn undefined;\n};\n\nexport class DTableBodyCellLink<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellLink<VALUE> = DThemeTableBodyCellLink<VALUE>,\n\tOPTIONS extends DTableBodyCellLinkOptions<ROW, VALUE, THEME> = DTableBodyCellLinkOptions<ROW, VALUE, THEME>\n> extends DTableBodyCellButton<ROW, VALUE, THEME, OPTIONS> {\n\tprotected _link?: DLink;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE | null>, onChange: DTableBodyCellOnChange<ROW, VALUE | null>, options: OPTIONS ) {\n\t\tsuper( columnIndex, column, onChange, DLinks.toStateOptions( options?.link?.target, options ) );\n\t}\n\n\tprotected initOnClick( when: DButtonBaseWhen, theme: THEME, options?: OPTIONS ): void {\n\t\tthis.link.apply( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\tif( when === DButtonBaseWhen.CLICKED ) {\n\t\t\t\tthis.onClick( e );\n\t\t\t}\n\t\t});\n\t}\n\n\tget link(): DLink {\n\t\tlet result = this._link;\n\t\tif( result == null ) {\n\t\t\tresult = new DLink( this.theme, toLinkOptions( this, this._options?.link ) );\n\t\t\tthis._link = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellLink\";\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tthis.link.open( e );\n\t}\n\n\topen( inNewWindow: boolean ): void {\n\t\tthis.link.open( inNewWindow );\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DSelect, DSelectOptions, DThemeSelect } from \"./d-select\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectMenuOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMenu<VALUE> = DThemeTableBodyCellSelectMenu<VALUE>\n> extends DSelectOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeTableBodyCellSelectMenu<VALUE = unknown> extends DThemeSelect<VALUE> {\n\n}\n\nexport class DTableBodyCellSelectMenu<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMenu<VALUE> = DThemeTableBodyCellSelectMenu<VALUE>,\n\tOPTIONS extends DTableBodyCellSelectMenuOptions<ROW, VALUE, THEME> = DTableBodyCellSelectMenuOptions<ROW, VALUE, THEME>\n> extends DSelect<VALUE, THEME, OPTIONS> implements DTableBodyCell<ROW, VALUE | null> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, VALUE | null>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, VALUE | null>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE | null>, onChange: DTableBodyCellOnChange<ROW, VALUE | null>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onValueChange( newValue: VALUE | null, oldValue: VALUE | null, item: DMenuItem<VALUE> | null ) {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\tsuper.onValueChange( newValue, oldValue, item );\n\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tprotected onKeyDownArrowDown( e: KeyboardEvent ): boolean {\n\t\treturn false;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, VALUE | null> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.value = value as VALUE | null;\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectMenu\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DMenuItem } from \"./d-menu-item\";\nimport { DSelectMultiple, DSelectMultipleOptions, DThemeSelectMultiple } from \"./d-select-multiple\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\n\nexport interface DTableBodyCellSelectMultipleOptions<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMultiple<VALUE> = DThemeTableBodyCellSelectMultiple<VALUE>\n> extends DSelectMultipleOptions<VALUE, THEME> {\n\n}\n\nexport interface DThemeTableBodyCellSelectMultiple<VALUE = unknown> extends DThemeSelectMultiple<VALUE> {\n\n}\n\nexport class DTableBodyCellSelectMultiple<\n\tROW = unknown,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellSelectMultiple<VALUE> = DThemeTableBodyCellSelectMultiple<VALUE>,\n\tOPTIONS extends DTableBodyCellSelectMultipleOptions<ROW, VALUE, THEME>\n\t\t= DTableBodyCellSelectMultipleOptions<ROW, VALUE, THEME>\n> extends DSelectMultiple<VALUE, THEME, OPTIONS> implements DTableBodyCell<ROW, VALUE[]> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, VALUE[]>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, VALUE[]>;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE[]>, onChange: DTableBodyCellOnChange<ROW, VALUE[]>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onValueChange( newValues: VALUE[], oldValues: VALUE[], items: Array<DMenuItem<VALUE>> ): void {\n\t\tconst row = this._row;\n\t\tif( row !== undefined ) {\n\t\t\tconst rowIndex = this._rowIndex;\n\t\t\tconst columnIndex = this._columnIndex;\n\t\t\tthis._column.setter( row, columnIndex, newValues );\n\t\t\tsuper.onValueChange( newValues, oldValues, items );\n\t\t\tthis._onChange( newValues, oldValues, row, rowIndex, columnIndex, this );\n\t\t}\n\t}\n\n\tprotected onKeyDownArrowDown( e: KeyboardEvent ): boolean {\n\t\treturn false;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, VALUE[]> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.values = value as VALUE[];\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellSelectMultiple\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DBasePaddingAdjustable } from \"./d-base-padding-adjustable\";\nimport { DButtonBaseWhen } from \"./d-button-base-when\";\nimport { DLink, DThemeLink } from \"./d-link\";\nimport { DLinks } from \"./d-links\";\nimport {\n\tDTableBodyCellButton, DTableBodyCellButtonOptions, DThemeTableBodyCellButton\n} from \"./d-table-body-cell-button\";\nimport { DTableBodyCellLinkLinkOptions, toLinkOptions } from \"./d-table-body-cell-link\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableState } from \"./d-table-state\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\nimport { DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DStateAwareOrValue } from \"./d-state-aware\";\n\nexport interface DTableBodyCellTreeOptions<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellTree<VALUE> = DThemeTableBodyCellTree<VALUE>\n> extends DTableBodyCellButtonOptions<ROW, VALUE, THEME> {\n\tlink?: DTableBodyCellLinkLinkOptions<ROW, VALUE>;\n}\n\nexport interface DThemeTableBodyCellTree<VALUE = unknown> extends DThemeTableBodyCellButton<VALUE>, DThemeLink {\n\tgetLevelPadding( level: number ): number;\n}\n\nexport class DTableBodyCellTree<\n\tROW,\n\tVALUE = unknown,\n\tTHEME extends DThemeTableBodyCellTree<VALUE> = DThemeTableBodyCellTree<VALUE>,\n\tOPTIONS extends DTableBodyCellTreeOptions<ROW, VALUE, THEME> = DTableBodyCellTreeOptions<ROW, VALUE, THEME>\n> extends DTableBodyCellButton<ROW, VALUE, THEME, OPTIONS> {\n\tprotected _padding!: DBasePaddingAdjustable;\n\tprotected _link?: DLink | null;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, VALUE | null>, onChange: DTableBodyCellOnChange<ROW, VALUE | null>, options?: OPTIONS ) {\n\t\tsuper( columnIndex, column, onChange, DLinks.toStateOptions( options?.link?.target, options ) );\n\t\tthis._padding = new DBasePaddingAdjustable( this._padding );\n\t}\n\n\tprotected initOnClick( when: DButtonBaseWhen, theme: THEME, options: OPTIONS ): void {\n\t\tconst link = this.link;\n\t\tif( link ) {\n\t\t\tlink.apply( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\t\tif( when === DButtonBaseWhen.CLICKED ) {\n\t\t\t\t\tthis.onClick( e );\n\t\t\t\t}\n\t\t\t});\n\t\t} else {\n\t\t\tsuper.initOnClick( when, theme, options );\n\t\t}\n\t}\n\n\tget link(): DLink | null {\n\t\tlet result = this._link;\n\t\tif( result === undefined ) {\n\t\t\tresult = this.newLink();\n\t\t\tthis._link = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newLink(): DLink | null {\n\t\tconst options = this._options?.link;\n\t\tif( options ) {\n\t\t\treturn new DLink( this.theme, toLinkOptions( this, options ) );\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tif( this.state.is( DTableState.HAS_CHILDREN ) ) {\n\t\t\tthis.toggle();\n\t\t} else {\n\t\t\tthis.link?.open( e );\n\t\t}\n\t}\n\n\tprotected toggle(): void {\n\t\tconst row = this._row;\n\t\tif( row === undefined ) {\n\t\t\treturn;\n\t\t}\n\t\tconst parent = this.parent;\n\t\tif( parent == null ) {\n\t\t\treturn;\n\t\t}\n\t\tconst body = parent.parent;\n\t\tif( body == null ) {\n\t\t\treturn;\n\t\t}\n\t\tconst data = (body as any).data;\n\t\tif( data && data.toggle ) {\n\t\t\tdata.toggle( row );\n\t\t}\n\t}\n\n\tonRowSelect( e: interaction.InteractionEvent, local: Point ): boolean {\n\t\tif( local.x <= this.position.x + this.padding.getLeft() ) {\n\t\t\tthis.toggle();\n\t\t\treturn true;\n\t\t}\n\t\treturn false;\n\t}\n\n\tset(\n\t\tvalue: unknown, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tthis.text = value as DStateAwareOrValue<VALUE | null>;\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\n\t\tconst link = this.link;\n\t\tconst adjuster = this._padding.adjuster;\n\t\tif( isNumber( supplimental ) ) {\n\t\t\tconst isOpened = !! (supplimental & 0x1);\n\t\t\tconst hasChildren = !! (supplimental & 0x2);\n\t\t\tconst level = (supplimental >> 2);\n\t\t\tconst state = this.state;\n\t\t\tstate.lock();\n\t\t\tstate.set( DTableState.HAS_CHILDREN, hasChildren );\n\t\t\tstate.set( DTableState.OPENED, isOpened );\n\t\t\tstate.unlock();\n\t\t\tif( link ) {\n\t\t\t\tlink.menu.enable = ! hasChildren;\n\t\t\t}\n\t\t\tadjuster.left = this.theme.getLevelPadding( level );\n\t\t} else {\n\t\t\tthis.state.removeAll( DTableState.OPENED, DTableState.HAS_CHILDREN );\n\t\t\tadjuster.left = 0;\n\t\t\tif( link ) {\n\t\t\t\tlink.menu.enable = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellTree\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction } from \"pixi.js\";\nimport { DButton, DButtonOptions, DThemeButton } from \"./d-button\";\nimport { DDialogTime, DDialogTimeOptions } from \"./d-dialog-time\";\nimport { DDialogTimes } from \"./d-dialog-times\";\nimport { DPickerDatetimeMask } from \"./d-picker-datetime-mask\";\nimport { DPickerTimes } from \"./d-picker-times\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCells } from \"./d-table-body-cells\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { isNumber } from \"./util/is-number\";\n\nexport interface DTableBodyCellTimeOptions<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellTime = DThemeTableBodyCellTime\n> extends DButtonOptions<Date, THEME> {\n\tdialog?: DDialogTimeOptions;\n}\n\nexport interface DThemeTableBodyCellTime extends DThemeButton<Date> {\n\n}\n\nexport class DTableBodyCellTime<\n\tROW = unknown,\n\tTHEME extends DThemeTableBodyCellTime = DThemeTableBodyCellTime,\n\tOPTIONS extends DTableBodyCellTimeOptions<ROW, THEME> = DTableBodyCellTimeOptions<ROW, THEME>\n> extends DButton<Date, THEME, OPTIONS> implements DTableBodyCell<ROW, Date> {\n\tprotected _row?: ROW;\n\tprotected _rowIndex: number;\n\tprotected _columnIndex: number;\n\tprotected _column: DTableColumn<ROW, Date>;\n\tprotected _onChange: DTableBodyCellOnChange<ROW, Date>;\n\tprotected _dialog?: DDialogTime;\n\tprotected _datetimeMask?: DPickerDatetimeMask;\n\n\tconstructor( columnIndex: number, column: DTableColumn<ROW, Date>, onChange: DTableBodyCellOnChange<ROW, Date>, options?: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._rowIndex = -1;\n\t\tthis._columnIndex = columnIndex;\n\t\tthis._column = column;\n\t\tthis._onChange = onChange;\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tsuper.onActivate( e );\n\t\tconst value = this._textValueComputed?.getTime() ?? Date.now();\n\t\tconst dialog = this.dialog;\n\t\tdialog.current = new Date( value );\n\t\tdialog.new = new Date( value );\n\t\tdialog.open().then((): void => {\n\t\t\tconst newValue = dialog.new;\n\t\t\tconst oldValue = dialog.current;\n\t\t\tthis.text = new Date( newValue.getTime() );\n\t\t\tconst row = this._row;\n\t\t\tif( row !== undefined ) {\n\t\t\t\tconst rowIndex = this._rowIndex;\n\t\t\t\tconst columnIndex = this._columnIndex;\n\t\t\t\tthis._column.setter( row, columnIndex, newValue );\n\t\t\t\tthis.emit( \"change\", newValue, oldValue, this );\n\t\t\t\tthis._onChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t\t}\n\t\t});\n\t}\n\n\tgetDatetimeMask(): DPickerDatetimeMask {\n\t\tlet result = this._datetimeMask;\n\t\tif( result == null ) {\n\t\t\tresult = DPickerTimes.toMask( this._options?.dialog?.picker );\n\t\t\tthis._datetimeMask = result;\n\t\t}\n\t\treturn result;\n\t}\n\n\tget dialog(): DDialogTime {\n\t\tlet dialog = this._dialog;\n\t\tif( dialog == null ) {\n\t\t\tconst options = this._options?.dialog;\n\t\t\tif( options ) {\n\t\t\t\tdialog = new DDialogTime( options );\n\t\t\t} else {\n\t\t\t\tdialog = DDialogTimes.getInstance();\n\t\t\t}\n\t\t\tthis._dialog = dialog;\n\t\t}\n\t\treturn dialog;\n\t}\n\n\tget row(): ROW | undefined {\n\t\treturn this._row;\n\t}\n\n\tget rowIndex(): number {\n\t\treturn this._rowIndex;\n\t}\n\n\tget columnIndex(): number {\n\t\treturn this._columnIndex;\n\t}\n\n\tget column(): DTableColumn<ROW, Date> {\n\t\treturn this._column;\n\t}\n\n\tset(\n\t\tvalue: Date, row: ROW, supplimental: unknown,\n\t\trowIndex: number, columnIndex: number,\n\t\tforcibly?: boolean\n\t): void {\n\t\tthis._row = row;\n\t\tthis._rowIndex = rowIndex;\n\t\tif( value instanceof Date ) {\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._textValue = value;\n\t\t\t\tthis._textValueComputed = value;\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t} else {\n\t\t\t\tthis.text = value;\n\t\t\t}\n\t\t} else if( isNumber( value ) ) {\n\t\t\tconst textValueComputed = this._textValueComputed;\n\t\t\tif( textValueComputed == null ) {\n\t\t\t\tthis.text = new Date( value );\n\t\t\t} else if( textValueComputed.getTime() !== value ) {\n\t\t\t\ttextValueComputed.setTime( value );\n\t\t\t\tthis.onTextChange();\n\t\t\t\tthis.createOrUpdateText();\n\t\t\t}\n\t\t}\n\n\t\tconst column = this._column;\n\t\tDTableBodyCells.setReadOnly( this, row, columnIndex, column );\n\t\tDTableBodyCells.setRenderable( this, row, columnIndex, column );\n\t}\n\n\tunset(): void {\n\t\tthis._row = undefined;\n\t\tthis._rowIndex = -1;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyCellTime\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Rectangle } from \"pixi.js\";\nimport { DBase } from \"./d-base\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DTableState } from \"./d-table-state\";\n\nexport interface DTableRowOptions<\n\tROW,\n\tCOLUMN,\n\tTHEME extends DThemeTableRow = DThemeTableRow\n> extends DLayoutHorizontalOptions<THEME> {\n\tcolumns?: COLUMN[];\n\tfrozen?: number;\n}\n\nexport interface DThemeTableRow extends DThemeLayoutHorizontal {\n\n}\n\nexport interface DTableRowColumn {\n\tweight?: number;\n\tfrozen?: boolean;\n\toffset: number;\n}\n\nexport abstract class DTableRow<\n\tROW,\n\tCOLUMN extends DTableRowColumn,\n\tTHEME extends DThemeTableRow = DThemeTableRow,\n\tOPTIONS extends DTableRowOptions<ROW, COLUMN, THEME> = DTableRowOptions<ROW, COLUMN, THEME>\n> extends DLayoutHorizontal<THEME, OPTIONS> {\n\tprotected _columns: COLUMN[];\n\tprotected _frozen: number;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.state.isFocusReverse = true;\n\t\tthis._reverse = true;\n\t\tthis._frozen = options.frozen ?? 0;\n\t\tthis._columns = options.columns ?? [];\n\t}\n\n\tprotected initCells( options: OPTIONS, columns: COLUMN[], frozen: number ): void {\n\t\tconst iend = this.toIndexEnd( columns );\n\t\tfor( let i = columns.length - 1; 0 <= i; --i ) {\n\t\t\tconst cell = this.newCell( i, columns[ i ], columns, options );\n\t\t\tconst cellState = cell.state;\n\t\t\tcellState.lock( false );\n\t\t\tif( i === 0 ) {\n\t\t\t\tcellState.add( DTableState.START );\n\t\t\t}\n\t\t\tif( i === iend ) {\n\t\t\t\tcellState.add( DTableState.END );\n\t\t\t}\n\t\t\tif( i < frozen ) {\n\t\t\t\tcellState.add( DTableState.FROZEN );\n\t\t\t}\n\t\t\tif( i === frozen - 1 ) {\n\t\t\t\tcellState.add( DTableState.FROZEN_END );\n\t\t\t}\n\t\t\tcellState.unlock();\n\t\t\tthis.addChild( cell );\n\t\t}\n\t}\n\n\tprotected toIndexEnd( columns: COLUMN[] ): number {\n\t\tconst imax = columns.length;\n\t\tfor( let i = 0; i < imax; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tif( column.weight !== undefined ) {\n\t\t\t\treturn imax - 1;\n\t\t\t}\n\t\t}\n\t\treturn imax;\n\t}\n\n\tprotected onRefit(): void {\n\t\tsuper.onRefit();\n\t\tthis.resetFrozenCellPosition();\n\t}\n\n\tupdateFrozenCellPosition( x: number ): void {\n\t\tconst columns = this._columns;\n\t\tconst cells = this.children;\n\t\tconst cellsLength = cells.length;\n\t\tconst frozen = this._frozen;\n\t\tfor( let i = 0; i < frozen; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tconst cell = cells[ cellsLength - 1 - i ];\n\t\t\tcell.position.x = -x + column.offset;\n\t\t}\n\t}\n\n\tprotected resetFrozenCellPosition(): void {\n\t\tconst columns = this._columns;\n\t\tconst cells = this.children;\n\t\tconst cellsLength = cells.length;\n\t\tconst frozen = this._frozen;\n\t\tconst x = this.getContentPositionX();\n\t\tfor( let i = 0; i < frozen; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tconst cell = cells[ cellsLength - 1 - i ];\n\t\t\tcolumn.offset = cell.position.x;\n\t\t\tcell.position.x = -x + column.offset;\n\t\t}\n\t}\n\n\tprotected abstract getContentPositionX(): number;\n\n\tgetClippingRect( target: unknown, result: Rectangle ): void {\n\t\tsuper.getClippingRect( target, result );\n\n\t\tconst frozen = this._frozen;\n\t\tif( 0 < frozen ) {\n\t\t\tconst cell = target as any;\n\t\t\tif( cell && cell.parent === this ) {\n\t\t\t\tconst cells = this.children as DBase[];\n\t\t\t\tconst cellIndex = cells.indexOf( cell );\n\t\t\t\tif( 0 <= cellIndex ) {\n\t\t\t\t\tconst columnIndex = cells.length - 1 - cellIndex;\n\t\t\t\t\tif( frozen <= columnIndex ) {\n\t\t\t\t\t\tconst previous = cells[ cellIndex + 1 ];\n\t\t\t\t\t\tconst shiftX = previous.position.x + previous.width;\n\t\t\t\t\t\tresult.x += shiftX;\n\t\t\t\t\t\tresult.width -= shiftX;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected abstract newCell(\n\t\tcolumnIndex: number,\n\t\tcolumn: COLUMN,\n\t\tcolumns: COLUMN[],\n\t\toptions: OPTIONS\n\t): DBase;\n\n\tprotected getType(): string {\n\t\treturn \"DTableRow\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\n\n/**\n * A row comparator function.\n */\nexport type DTableDataComparatorFunction<ROW> =\n\t( rowA: ROW, rowB: ROW, indexA: number, indexB: number ) => number;\n\n/**\n * A row comparator object.\n */\nexport interface DTableDataComparatorObject<ROW> {\n\tcompare( rowA: ROW, rowB: ROW, indexA: number, indexB: number ): number;\n}\n\n/**\n * A sort order.\n */\nexport enum DTableDataOrder {\n\tASCENDING,\n\tDESCENDING\n}\n\n/**\n * Table data sorter.\n */\nexport interface DTableDataSorter<ROW> extends utils.EventEmitter {\n\treadonly id: number;\n\n\t/**\n\t * An indices of sorted rows.\n\t * Must not change this indices directly.\n\t */\n\treadonly indices: number[] | null;\n\n\t/**\n\t * A sort order.\n\t */\n\torder: DTableDataOrder;\n\n\t/**\n\t * Applys a sorting.\n\t */\n\tapply(): void;\n\n\t/**\n\t * Unapplys a sorting.\n\t */\n\tunapply(): void;\n\n\t/**\n\t * Returns true if a sorting is applied.\n\t */\n\tisApplied(): boolean;\n\n\t/**\n\t * Returns a current comparator.\n\t */\n\tget(): DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null;\n\n\t/**\n\t * Sets to the given comparator.\n\t *\n\t * @param comparator A comparator\n\t */\n\tset( comparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null ): void;\n\n\t/**\n\t * Returns a sorted index of the specified unmapped index.\n\t *\n\t * @param unmappedIndex an unmapped index\n\t */\n\tmap( unmappedIndex: number ): number | null;\n\n\t/**\n\t * Returns an unmapped index of the specified sorted index.\n\t *\n\t * @param index a mapped index\n\t */\n\tunmap( index: number ): number;\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DBaseStateSet } from \"./d-base-state-set\";\nimport { DTableBodyCell, DTableBodyCellOnChange } from \"./d-table-body-cell\";\nimport { DTableBodyCellActionDialog } from \"./d-table-body-cell-action-dialog\";\nimport { DTableBodyCellActionMenu } from \"./d-table-body-cell-action-menu\";\nimport { DTableBodyCellActionPromise } from \"./d-table-body-cell-action-promise\";\nimport { DTableBodyCellButton } from \"./d-table-body-cell-button\";\nimport { DTableBodyCellCheck } from \"./d-table-body-cell-check\";\nimport { DTableBodyCellColor } from \"./d-table-body-cell-color\";\nimport { DTableBodyCellDate } from \"./d-table-body-cell-date\";\nimport { DTableBodyCellDatetime } from \"./d-table-body-cell-datetime\";\nimport { DTableBodyCellIndex } from \"./d-table-body-cell-index\";\nimport { DTableBodyCellInputInteger } from \"./d-table-body-cell-input-integer\";\nimport { DTableBodyCellInputReal } from \"./d-table-body-cell-input-real\";\nimport { DTableBodyCellInputText } from \"./d-table-body-cell-input-text\";\nimport { DTableBodyCellInputTree } from \"./d-table-body-cell-input-tree\";\nimport { DTableBodyCellLink } from \"./d-table-body-cell-link\";\nimport { DTableBodyCellSelectDialog } from \"./d-table-body-cell-select-dialog\";\nimport { DTableBodyCellSelectMenu } from \"./d-table-body-cell-select-menu\";\nimport { DTableBodyCellSelectMultiple } from \"./d-table-body-cell-select-multiple\";\nimport { DTableBodyCellSelectPromise } from \"./d-table-body-cell-select-promise\";\nimport { DTableBodyCellText } from \"./d-table-body-cell-text\";\nimport { DTableBodyCellTime } from \"./d-table-body-cell-time\";\nimport { DTableBodyCellTree } from \"./d-table-body-cell-tree\";\nimport { DTableBodyCellOptionsUnion, DTableColumn, DTableColumnType } from \"./d-table-column\";\nimport { DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\nimport { DTableState } from \"./d-table-state\";\n\nexport interface DTableBodyRowSelectionOptions {\n\ttype?: DTableDataSelectionType;\n}\n\nexport interface DTableBodyRowOptions<\n\tROW,\n\tTHEME extends DThemeTableBodyRow = DThemeTableBodyRow\n> extends DTableRowOptions<ROW, DTableColumn<ROW, unknown>, THEME> {\n\theight?: number;\n\tcell?: DTableBodyCellOptionsUnion<ROW>;\n\tselection?: DTableBodyRowSelectionOptions;\n}\n\nexport interface DThemeTableBodyRow extends DThemeTableRow {\n\n}\n\nexport type DTableBodyRowOnChange<ROW, VALUE, EMITTER = any> = (\n\tnewValue: VALUE, oldValue: VALUE,\n\trow: ROW, rowIndex: number, columnIndex: number, emitter: EMITTER\n) => void;\n\nexport class DTableBodyRow<\n\tROW,\n\tTHEME extends DThemeTableBodyRow = DThemeTableBodyRow,\n\tOPTIONS extends DTableBodyRowOptions<ROW, THEME> = DTableBodyRowOptions<ROW, THEME>\n> extends DTableRow<ROW, DTableColumn<ROW, unknown>, THEME, OPTIONS> {\n\tprotected _value?: ROW;\n\tprotected _index: number;\n\tprotected _onCellChangeBound: DTableBodyCellOnChange<ROW, unknown>;\n\n\tconstructor( onChange: DTableBodyRowOnChange<ROW, unknown>, isEven: boolean, options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._index = -1;\n\t\tthis._onCellChangeBound = ( newValue, oldValue, row, rowIndex, columnIndex ): void => {\n\t\t\tthis.emit( \"change\", newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t\tonChange( newValue, oldValue, row, rowIndex, columnIndex, this );\n\t\t};\n\t\tthis.state.isAlternated = isEven;\n\t\tthis.initCells( options, this._columns, this._frozen );\n\t}\n\n\tprotected newCell(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, unknown>,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\toptions: OPTIONS\n\t): DBase {\n\t\tconst onChange = this._onCellChangeBound;\n\t\tconst cellOptions = this.toCellOptions( columnIndex, column, options );\n\t\tif( column.editing.enable !== false ) {\n\t\t\treturn this.newCellEditable( columnIndex, column, onChange, cellOptions );\n\t\t} else {\n\t\t\tconst cell = this.newCellUnediable( columnIndex, column, onChange, cellOptions );\n\t\t\tif( column.type !== DTableColumnType.TREE ) {\n\t\t\t\tcell.state.isReadOnly = true;\n\t\t\t}\n\t\t\treturn cell;\n\t\t}\n\t}\n\n\tprotected newCellEditable(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, any>,\n\t\tonChange: DTableBodyCellOnChange<ROW, unknown>,\n\t\toptions: any\n\t): DBase {\n\t\tswitch( column.type ) {\n\t\tcase DTableColumnType.INDEX:\n\t\t\treturn new DTableBodyCellIndex( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.TEXT:\n\t\t\treturn new DTableBodyCellInputText( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.TREE:\n\t\t\treturn new DTableBodyCellInputTree( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.INTEGER:\n\t\t\treturn new DTableBodyCellInputInteger( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.REAL:\n\t\t\treturn new DTableBodyCellInputReal( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.CHECK:\n\t\tcase DTableColumnType.CHECK_SINGLE:\n\t\t\treturn new DTableBodyCellCheck( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.COLOR:\n\t\t\treturn new DTableBodyCellColor( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.BUTTON:\n\t\t\treturn new DTableBodyCellButton( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.LINK:\n\t\t\treturn new DTableBodyCellLink( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.SELECT:\n\t\t\treturn this.newCellSelect( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.ACTION:\n\t\t\treturn this.newCellAction( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.DATE:\n\t\t\treturn new DTableBodyCellDate( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.DATETIME:\n\t\t\treturn new DTableBodyCellDatetime( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.TIME:\n\t\t\treturn new DTableBodyCellTime( columnIndex, column, onChange, options );\n\t\tdefault:\n\t\t\treturn new DTableBodyCellText( columnIndex, column, onChange, options );\n\t\t}\n\t}\n\n\tprotected newCellUnediable(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, any>,\n\t\tonChange: DTableBodyCellOnChange<ROW, unknown>,\n\t\toptions: any\n\t): DBase {\n\t\tswitch( column.type ) {\n\t\tcase DTableColumnType.INDEX:\n\t\t\treturn new DTableBodyCellIndex( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.TEXT:\n\t\t\treturn new DTableBodyCellText( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.TREE:\n\t\t\treturn new DTableBodyCellTree( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.INTEGER:\n\t\t\treturn new DTableBodyCellText( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.REAL:\n\t\t\treturn new DTableBodyCellText( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.CHECK:\n\t\tcase DTableColumnType.CHECK_SINGLE:\n\t\t\treturn new DTableBodyCellCheck( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.COLOR:\n\t\t\treturn new DTableBodyCellColor( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.BUTTON:\n\t\t\treturn new DTableBodyCellButton( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.LINK:\n\t\t\treturn new DTableBodyCellLink( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.SELECT:\n\t\t\treturn this.newCellSelect( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.ACTION:\n\t\t\treturn this.newCellAction( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.DATE:\n\t\t\treturn new DTableBodyCellDate( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.DATETIME:\n\t\t\treturn new DTableBodyCellDatetime( columnIndex, column, onChange, options );\n\t\tcase DTableColumnType.TIME:\n\t\t\treturn new DTableBodyCellTime( columnIndex, column, onChange, options );\n\t\tdefault:\n\t\t\treturn new DTableBodyCellText( columnIndex, column, onChange, options );\n\t\t}\n\t}\n\n\tprotected newCellSelect(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, any>,\n\t\tonChange: DTableBodyCellOnChange<ROW, unknown>,\n\t\toptions: any\n\t): DBase {\n\t\tconst selecting = column.selecting;\n\t\tif( selecting.menu != null ) {\n\t\t\treturn new DTableBodyCellSelectMenu( columnIndex, column, onChange, options );\n\t\t} else if( selecting.multiple != null ) {\n\t\t\treturn new DTableBodyCellSelectMultiple( columnIndex, column, onChange, options );\n\t\t} else if( selecting.dialog != null ) {\n\t\t\treturn new DTableBodyCellSelectDialog( columnIndex, column, onChange, options );\n\t\t} else if( selecting.promise != null ) {\n\t\t\treturn new DTableBodyCellSelectPromise( columnIndex, column, onChange, options );\n\t\t} else {\n\t\t\treturn new DTableBodyCellText( columnIndex, column, onChange, options );\n\t\t}\n\t}\n\n\tprotected newCellAction(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, any>,\n\t\tonChange: DTableBodyCellOnChange<ROW, unknown>,\n\t\toptions: any\n\t): DBase {\n\t\tconst selecting = column.selecting;\n\t\tif( selecting.menu != null ) {\n\t\t\treturn new DTableBodyCellActionMenu( columnIndex, column, onChange, options );\n\t\t} else if( selecting.dialog != null ) {\n\t\t\treturn new DTableBodyCellActionDialog( columnIndex, column, onChange, options );\n\t\t} else if( selecting.promise != null ) {\n\t\t\treturn new DTableBodyCellActionPromise( columnIndex, column, onChange, options );\n\t\t} else {\n\t\t\treturn new DTableBodyCellText( columnIndex, column, onChange, options );\n\t\t}\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, unknown>,\n\t\toptions: OPTIONS\n\t): DTableBodyCellOptionsUnion<ROW> {\n\t\tlet result: any = (column.body || options.cell);\n\t\tconst columnWeight = column.weight;\n\t\tconst columnWidth = column.width;\n\t\tconst columnFormatter = column.formatter;\n\t\tconst columnAlign = column.align;\n\t\tconst columnSelecting = column.selecting;\n\t\tconst columnSelectingMenu = columnSelecting.menu || columnSelecting.multiple;\n\t\tif( result != null ) {\n\t\t\tresult.weight = columnWeight;\n\t\t\tresult.width = columnWidth;\n\n\t\t\tconst text = result.text || {};\n\t\t\tresult.text = text;\n\t\t\ttext.formatter ||= columnFormatter;\n\n\t\t\tconst textAlign = text.align || {};\n\t\t\ttext.align = textAlign;\n\t\t\ttextAlign.horizontal = columnAlign;\n\n\t\t\tresult.menu ||= columnSelectingMenu;\n\t\t} else {\n\t\t\tresult = {\n\t\t\t\tweight: columnWeight,\n\t\t\t\twidth: columnWidth,\n\t\t\t\ttext: {\n\t\t\t\t\tformatter: columnFormatter,\n\t\t\t\t\talign: {\n\t\t\t\t\t\thorizontal: columnAlign\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tmenu: columnSelectingMenu\n\t\t\t};\n\t\t}\n\n\t\tconst columnEditing = column.editing;\n\t\tif( columnEditing.enable !== false ) {\n\t\t\tconst editing = result.editing || {};\n\t\t\tresult.editing = editing;\n\t\t\tediting.formatter ||= columnEditing.formatter;\n\t\t\tediting.unformatter ||= columnEditing.unformatter;\n\t\t\tediting.validator ||= columnEditing.validator;\n\t\t}\n\n\t\tconst columnLink = column.link;\n\t\tif( columnLink ) {\n\t\t\tresult.link = columnLink;\n\t\t}\n\n\t\tconst selectionType = ( options?.selection?.type ?? DTableDataSelectionType.NONE );\n\t\tif( selectionType !== DTableDataSelectionType.NONE ) {\n\t\t\tresult.when = \"DOUBLE_CLICKED\";\n\t\t\tresult.cursor = ( state: DBaseStateSet ): string | undefined => {\n\t\t\t\tif( state.in( DTableState.SELECTABLE ) ) {\n\t\t\t\t\treturn \"pointer\";\n\t\t\t\t}\n\t\t\t\treturn undefined;\n\t\t\t};\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBodyRow\";\n\t}\n\n\t/**\n\t * Returns a row data if exists.\n\t * Returns undefined if a row data does not exit.\n\t *\n\t * @returns a row data or undefined.\n\t */\n\tget value(): ROW | undefined {\n\t\treturn this._value;\n\t}\n\n\t/**\n\t * Returns a row index if a row data exists.\n\t * Returns -1 if a row data does not exit.\n\t *\n\t * @returns a row index or -1.\n\t */\n\tget index(): number {\n\t\treturn this._index;\n\t}\n\n\tprotected isCell( target: any ): target is DTableBodyCell<unknown, unknown> {\n\t\treturn (target != null && \"set\" in target);\n\t};\n\n\tset( value: ROW, supplimental: unknown, rowIndex: number, forcibly?: boolean ): void {\n\t\tif( forcibly || this._value !== value || this._index !== rowIndex ) {\n\t\t\tthis._value = value;\n\t\t\tthis._index = rowIndex;\n\n\t\t\tconst cells = this.children;\n\t\t\tconst cellsLength = cells.length;\n\t\t\tconst columns = this._columns;\n\t\t\tconst columnsLength = columns.length;\n\t\t\tfor( let i = 0; i < cellsLength; ++i ) {\n\t\t\t\tconst cell = cells[ i ];\n\t\t\t\tconst columnIndex = columnsLength - 1 - i;\n\t\t\t\tconst column = columns[ columnIndex ];\n\t\t\t\tif( this.isCell( cell ) ) {\n\t\t\t\t\tcell.set( column.getter( value, columnIndex ), value, supplimental, rowIndex, columnIndex, forcibly );\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onSet( value, rowIndex );\n\t\t}\n\t}\n\n\tprotected onSet( value: ROW, rowIndex: number ): void {\n\t\tthis.emit( \"set\", value, rowIndex, this );\n\t}\n\n\tunset(): void {\n\t\tif( this._value !== undefined ) {\n\t\t\tthis._value = undefined;\n\t\t\tthis._index = -1;\n\n\t\t\tconst cells = this.children;\n\t\t\tconst cellsLength = cells.length;\n\t\t\tfor( let i = 0; i < cellsLength; ++i ) {\n\t\t\t\tconst cell = cells[ i ];\n\t\t\t\tif( this.isCell( cell ) ) {\n\t\t\t\t\tcell.unset();\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.onUnset();\n\t\t}\n\t}\n\n\tprotected onUnset(): void {\n\t\tthis.emit( \"unset\", this );\n\t}\n\n\tprotected getContentPositionX(): number {\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tconst content = parent.parent;\n\t\t\tif( content ) {\n\t\t\t\treturn content.position.x;\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableDataFilter, DTableDataFilterFunction, DTableDataFilterObject } from \"./d-table-data-filter\";\nimport { DTableDataSorter } from \"./d-table-data-sorter\";\nimport { isFunction } from \"./util/is-function\";\n\ninterface DTableDataListFilterParent<ROW> {\n\treadonly sorter: DTableDataSorter<ROW>;\n\treadonly rows: ROW[];\n\tupdate(): void;\n}\n\nexport class DTableDataListFilter<ROW> extends utils.EventEmitter implements DTableDataFilter<ROW> {\n\tprotected _id: number;\n\tprotected _idUpdated: number;\n\tprotected _isApplied: boolean;\n\tprotected _sorterId: number;\n\tprotected _parent: DTableDataListFilterParent<ROW>;\n\tprotected _filter: DTableDataFilterFunction<ROW> | DTableDataFilterObject<ROW> | null;\n\tprotected _filtered: number[] | null;\n\n\tconstructor( parent: DTableDataListFilterParent<ROW> ) {\n\t\tsuper();\n\n\t\tthis._id = 0;\n\t\tthis._idUpdated = -1;\n\t\tthis._isApplied = false;\n\t\tthis._sorterId = -1;\n\n\t\tthis._parent = parent;\n\t\tthis._filter = null;\n\t\tthis._filtered = null;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tapply(): void {\n\t\tthis._isApplied = true;\n\t\tthis._id += 1;\n\t\tthis._parent.update();\n\t}\n\n\tunapply(): void {\n\t\tif( this._isApplied ) {\n\t\t\tthis._isApplied = false;\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.update();\n\t\t}\n\t}\n\n\tisApplied(): boolean {\n\t\treturn this._isApplied;\n\t}\n\n\tprotected newFiltered(): number[] | null {\n\t\tconst filter = this._filter;\n\t\tif( filter != null ) {\n\t\t\tconst filtered: number[] = [];\n\t\t\tconst parent = this._parent;\n\t\t\tconst sorter = parent.sorter;\n\t\t\tconst rows = parent.rows;\n\t\t\tif( isFunction( filter ) ) {\n\t\t\t\tconst indicesSorted = sorter.indices;\n\t\t\t\tif( indicesSorted ) {\n\t\t\t\t\tfor( let i = 0, imax = indicesSorted.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst indexSorted = indicesSorted[ i ];\n\t\t\t\t\t\tif( filter( rows[ indexSorted ], indexSorted ) ) {\n\t\t\t\t\t\t\tfiltered.push( i );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = rows.length; i < imax; ++i ) {\n\t\t\t\t\t\tif( filter( rows[ i ], i ) ) {\n\t\t\t\t\t\t\tfiltered.push( i );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tconst indicesSorted = sorter.indices;\n\t\t\t\tif( indicesSorted ) {\n\t\t\t\t\tfor( let i = 0, imax = indicesSorted.length; i < imax; ++i ) {\n\t\t\t\t\t\tconst indexSorted = indicesSorted[ i ];\n\t\t\t\t\t\tif( filter.test( rows[ indexSorted ], indexSorted ) ) {\n\t\t\t\t\t\t\tfiltered.push( i );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tfor( let i = 0, imax = rows.length; i < imax; ++i ) {\n\t\t\t\t\t\tif( filter.test( rows[ i ], i ) ) {\n\t\t\t\t\t\t\tfiltered.push( i );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn filtered;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tget(): DTableDataFilterFunction<ROW> | DTableDataFilterObject<ROW> | null {\n\t\treturn this._filter;\n\t}\n\n\tset( filter: DTableDataFilterFunction<ROW> | DTableDataFilterObject<ROW> | null ): void {\n\t\tif( this._filter !== filter ) {\n\t\t\tthis._filter = filter;\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n\n\tupdate(): void {\n\t\tif( this._id !== this._idUpdated || this._parent.sorter.id !== this._sorterId ) {\n\t\t\tthis._idUpdated = this._id;\n\t\t\tthis._sorterId = this._parent.sorter.id;\n\t\t\tif( this._isApplied ) {\n\t\t\t\tthis._filtered = this.newFiltered();\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t} else if( this._filtered != null ) {\n\t\t\t\tthis._filtered = null;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tget indices(): number[] | null {\n\t\tthis.update();\n\t\treturn this._filtered;\n\t}\n\n\tmap( sortedIndex: number ): number | null {\n\t\tlet result = sortedIndex;\n\n\t\tconst indicesFiltered = this.indices;\n\t\tif( indicesFiltered ) {\n\t\t\tconst index = indicesFiltered.indexOf( result );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tresult = index;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tunmap( index: number ): number {\n\t\tlet result = index;\n\n\t\tconst indicesFiltered = this.indices;\n\t\tif( indicesFiltered ) {\n\t\t\tresult = indicesFiltered[ result ];\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","import { DTableData, DTableDataMapped, DTableDataMappedEachIteratee } from \"./d-table-data\";\n\nexport interface DTableDataListMappedParent<ROW> extends DTableData<ROW> {\n\treadonly rows: ROW[];\n\treadonly supplimentals?: unknown[];\n}\n\nexport class DTableDataListMapped<ROW> implements DTableDataMapped<ROW> {\n\tprotected _parent: DTableDataListMappedParent<ROW>;\n\n\tconstructor( parent: DTableDataListMappedParent<ROW> ) {\n\t\tthis._parent = parent;\n\t}\n\n\tmap( unmappedIndex: number ): number | null {\n\t\tconst parent = this._parent;\n\t\tconst sortedIndex = parent.sorter.map( unmappedIndex );\n\t\tif( sortedIndex != null ) {\n\t\t\treturn parent.filter.map( sortedIndex );\n\t\t}\n\t\treturn null;\n\t}\n\n\tunmap( index: number ): number {\n\t\tconst parent = this._parent;\n\t\treturn parent.sorter.unmap(\n\t\t\tparent.filter.unmap( index )\n\t\t);\n\t}\n\n\tsize(): number {\n\t\tconst parent = this._parent;\n\t\tconst indicesFiltered = parent.filter.indices;\n\t\treturn ( indicesFiltered != null ? indicesFiltered.length : parent.size() );\n\t}\n\n\tget( index: number ): ROW | null {\n\t\tconst parent = this._parent;\n\t\treturn parent.get( this.unmap( index ) );\n\t}\n\n\teach( iteratee: DTableDataMappedEachIteratee<ROW>, ifrom?: number, ito?: number ): void {\n\t\tconst parent = this._parent;\n\t\tconst rows = parent.rows;\n\t\tconst supplimentals = parent.supplimentals;\n\t\tconst indicesFiltered = parent.filter.indices;\n\t\tconst indicesSorted = parent.sorter.indices;\n\t\tifrom = ( ifrom != null ? Math.max( 0, ifrom ) : 0 );\n\t\tif( indicesFiltered ) {\n\t\t\tconst size = indicesFiltered.length;\n\t\t\tito = ( ito != null ? Math.min( size, ito ) : size );\n\t\t\tif( indicesSorted ) {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst unmappedIndex = indicesSorted[ indicesFiltered[ i ] ];\n\t\t\t\t\tconst row = rows[ unmappedIndex ];\n\t\t\t\t\tconst supplimental = ( supplimentals ? supplimentals[ unmappedIndex ] : null );\n\t\t\t\t\tif( iteratee( row, supplimental, i, unmappedIndex ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst unmappedIndex = indicesFiltered[ i ];\n\t\t\t\t\tconst row = rows[ unmappedIndex ];\n\t\t\t\t\tconst supplimental = ( supplimentals ? supplimentals[ unmappedIndex ] : null );\n\t\t\t\t\tif( iteratee( row, supplimental, i, unmappedIndex ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tconst size = rows.length;\n\t\t\tito = ( ito != null ? Math.min( size, ito ) : size );\n\t\t\tif( indicesSorted ) {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst unmappedIndex = indicesSorted[ i ];\n\t\t\t\t\tconst row = rows[ unmappedIndex ];\n\t\t\t\t\tconst supplimental = ( supplimentals ? supplimentals[ unmappedIndex ] : null );\n\t\t\t\t\tif( iteratee( row, supplimental, i, unmappedIndex ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\t\t\tconst row = rows[ i ];\n\t\t\t\t\tconst supplimental = ( supplimentals ? supplimentals[ i ] : null );\n\t\t\t\t\tif( iteratee( row, supplimental, i, i ) === false ) {\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableDataSelection, DTableDataSelectionOptions, DTableDataSelectionParent, DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { toEnum } from \"./util/to-enum\";\n\nconst COMPARATOR = ( a: [number, unknown], b: [number, unknown] ): number => {\n\treturn a[ 0 ] - b[ 0 ];\n};\n\nexport class DTableDataListSelection<ROW> extends utils.EventEmitter implements DTableDataSelection<ROW> {\n\tprotected _parent: DTableDataSelectionParent<ROW>;\n\tprotected _type: DTableDataSelectionType;\n\tprotected _indices: Set<number>;\n\n\tconstructor( parent: DTableDataSelectionParent<ROW>, options?: DTableDataSelectionOptions ) {\n\t\tsuper();\n\n\t\tthis._parent = parent;\n\t\tthis._type = toEnum( options?.type ?? DTableDataSelectionType.NONE, DTableDataSelectionType );\n\t\tthis._indices = new Set<number>();\n\t}\n\n\tget type(): DTableDataSelectionType {\n\t\treturn this._type;\n\t}\n\n\tprotected onChange(): void {\n\t\tthis._parent.update();\n\t\tthis.emit( \"change\", this );\n\t}\n\n\ttoggle( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tif( indices.has( rowIndex ) ) {\n\t\t\tindices.delete( rowIndex );\n\t\t} else {\n\t\t\tindices.add( rowIndex );\n\t\t}\n\t\tthis.onChange();\n\t}\n\n\tadd( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tindices.add( rowIndex );\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tget first(): number | null {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tlet result: number = NaN;\n\t\t\tindices.forEach(( index: number ): void => {\n\t\t\t\tif( result !== result ) {\n\t\t\t\t\tresult = index;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tget last(): number | null {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tlet result: number = 0;\n\t\t\tindices.forEach(( index: number ): void => {\n\t\t\t\tresult = index;\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\taddTo( rowIndex: number ): void {\n\t\tconst lastRowIndex = this.last;\n\t\tif( lastRowIndex != null ) {\n\t\t\tthis.addRange( lastRowIndex, false, rowIndex, true );\n\t\t}\n\t}\n\n\taddRange( from: number, includeFrom: boolean, to: number, includeTo: boolean ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tif( from < to ) {\n\t\t\tfor( let i = from + (includeFrom ? 0 : 1), imax = to + (includeTo ? 1 : 0); i < imax; ++i ) {\n\t\t\t\tindices.add( i );\n\t\t\t}\n\t\t} else {\n\t\t\tfor( let i = to + (includeTo ? 0 : 1), imax = from + (includeFrom ? 1 : 0); i < imax; ++i ) {\n\t\t\t\tindices.add( i );\n\t\t\t}\n\t\t}\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\taddAll( rowIndices: number[] ): void {\n\t\tconst indices = this._indices;\n\t\tconst oldSize = indices.size;\n\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\tindices.add( rowIndices[ i ] );\n\t\t}\n\t\tconst newSize = indices.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tcontains( rowIndex: number ): boolean {\n\t\treturn this._indices.has( rowIndex );\n\t}\n\n\tremove( rowIndex: number ): void {\n\t\tif( this._indices.delete( rowIndex ) ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size ) {\n\t\t\tindices.clear();\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclearAndAdd( rowIndex: number ): void {\n\t\tconst indices = this._indices;\n\t\tif( ! indices.has( rowIndex ) || indices.size !== 1 ) {\n\t\t\tindices.clear();\n\t\t\tindices.add( rowIndex );\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclearAndAddAll( rowIndices: number[] ): void {\n\t\tconst indices = this._indices;\n\t\tif( 0 < indices.size || 0 < rowIndices.length ) {\n\t\t\tindices.clear();\n\t\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\t\tindices.add( rowIndices[ i ] );\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tshift( rowIndex: number, amount: number ): void {\n\t\tconst shifted: number[] = [];\n\t\tconst indices = this._indices;\n\t\tindices.forEach(( index: number ): void => {\n\t\t\tif( rowIndex <= index ) {\n\t\t\t\tshifted.push( index );\n\t\t\t}\n\t\t});\n\t\tconst shiftedLength = shifted.length;\n\t\tif( 0 < shiftedLength ) {\n\t\t\tfor( let i = 0, imax = shifted.length; i < imax; ++i ) {\n\t\t\t\tindices.delete( shifted[ i ] );\n\t\t\t}\n\t\t\tfor( let i = 0, imax = shifted.length; i < imax; ++i ) {\n\t\t\t\tindices.add( shifted[ i ] + amount );\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this._indices.size;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._indices.size === 0;\n\t}\n\n\t/**\n\t * Returns a copy of an index array of selected rows.\n\t * The order of indices is an insertion order.\n\t */\n\tget indices(): number[] {\n\t\tconst result: number[] = [];\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push( index );\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns a copy of an array of selected row value.\n\t * The order is an insertion order.\n\t */\n\tget rows(): ROW[] {\n\t\tconst result: ROW[] = [];\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push( parent.get( index )! );\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns an array of the (index, row value) pairs of selected rows.\n\t * The order of pairs is an insertion order.\n\t */\n\ttoArray(): Array<[ number, ROW ]> {\n\t\tconst result: Array<[ number, ROW ]> = [];\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.push([ index, parent.get( index )! ]);\n\t\t});\n\t\treturn result;\n\t}\n\n\t/**\n\t * Returns an sorted array of the (index, row value) pairs of selected rows.\n\t */\n\ttoSortedArray(): Array<[ number, ROW ]> {\n\t\treturn this.toArray().sort( COMPARATOR );\n\t}\n\n\ttoObject(): {[index: number]: ROW} {\n\t\tconst result: {[index: number]: ROW} = {};\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult[ index ] = parent.get( index )!;\n\t\t});\n\t\treturn result;\n\t}\n\n\ttoMap(): Map<number, ROW> {\n\t\tconst result: Map<number, ROW> = new Map<number, ROW>();\n\t\tconst parent = this._parent;\n\t\tthis._indices.forEach(( index: number ): void => {\n\t\t\tresult.set( index, parent.get( index )! );\n\t\t});\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport {\n\tDTableDataComparatorFunction, DTableDataComparatorObject,\n\tDTableDataOrder, DTableDataSorter\n} from \"./d-table-data-sorter\";\nimport { isFunction } from \"./util/is-function\";\n\nexport interface DTableDataListSorterParent<ROW> {\n\treadonly rows: ROW[];\n\tupdate(): void;\n}\n\nexport class DTableDataListSorter<ROW> extends utils.EventEmitter implements DTableDataSorter<ROW> {\n\tprotected _id: number;\n\tprotected _idUpdated: number;\n\tprotected _isApplied: boolean;\n\tprotected _parent: DTableDataListSorterParent<ROW>;\n\tprotected _comparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null;\n\tprotected _sorted: number[] | null;\n\tprotected _order: DTableDataOrder;\n\n\tconstructor( parent: DTableDataListSorterParent<ROW> ) {\n\t\tsuper();\n\n\t\tthis._id = 0;\n\t\tthis._idUpdated = -1;\n\t\tthis._isApplied = false;\n\t\tthis._parent = parent;\n\t\tthis._comparator = null;\n\t\tthis._sorted = null;\n\t\tthis._order = DTableDataOrder.ASCENDING;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tget order(): DTableDataOrder {\n\t\treturn this._order;\n\t}\n\n\tset order( order: DTableDataOrder ) {\n\t\tthis._order = order;\n\t}\n\n\tapply(): void {\n\t\tthis._isApplied = true;\n\t\tthis._id += 1;\n\t\tthis._parent.update();\n\t}\n\n\tunapply(): void {\n\t\tif( this._isApplied ) {\n\t\t\tthis._isApplied = false;\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.update();\n\t\t}\n\t}\n\n\tisApplied(): boolean {\n\t\treturn this._isApplied;\n\t}\n\n\tprotected newSorted(): number[] | null {\n\t\tconst comparator = this._comparator;\n\t\tif( comparator != null ) {\n\t\t\tconst parent = this._parent;\n\t\t\tconst sorted: number[] = [];\n\t\t\tconst rows: ROW[] = parent.rows;\n\t\t\tfor( let i = 0, imax = rows.length; i < imax; ++i ) {\n\t\t\t\tsorted.push( i );\n\t\t\t}\n\t\t\tsorted.sort( this.toComparator( rows, comparator ) );\n\t\t\treturn sorted;\n\t\t} else {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\tprotected toComparator(\n\t\trows: ROW[],\n\t\tcomparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW>\n\t): ( indexA: number, indexB: number) => number {\n\t\tconst order = this._order;\n\t\tif( isFunction( comparator ) ) {\n\t\t\tif( order === DTableDataOrder.ASCENDING ) {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator(\n\t\t\t\t\t\trows[ indexA ], rows[ indexB ],\n\t\t\t\t\t\tindexA, indexB\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator(\n\t\t\t\t\t\trows[ indexB ], rows[ indexA ],\n\t\t\t\t\t\tindexB, indexA\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t}\n\t\t} else {\n\t\t\tif( order === DTableDataOrder.ASCENDING ) {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator.compare(\n\t\t\t\t\t\trows[ indexA ], rows[ indexB ],\n\t\t\t\t\t\tindexA, indexB\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn ( indexA: number, indexB: number ): number => {\n\t\t\t\t\treturn comparator.compare(\n\t\t\t\t\t\trows[ indexB ], rows[ indexA ],\n\t\t\t\t\t\tindexB, indexA\n\t\t\t\t\t);\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t}\n\n\tget(): DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null {\n\t\treturn this._comparator;\n\t}\n\n\tset( comparator: DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null ): void {\n\t\tif( this._comparator !== comparator ) {\n\t\t\tthis._comparator = comparator;\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n\n\tupdate(): void {\n\t\tif( this._id !== this._idUpdated ) {\n\t\t\tthis._idUpdated = this._id;\n\t\t\tif( this._isApplied ) {\n\t\t\t\tthis._sorted = this.newSorted();\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t} else if( this._sorted != null ) {\n\t\t\t\tthis._sorted = null;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tget indices(): number[] | null {\n\t\tthis.update();\n\t\treturn this._sorted;\n\t}\n\n\tmap( unmappedIndex: number ): number | null {\n\t\tlet result = unmappedIndex;\n\n\t\tconst indicesSorted = this.indices;\n\t\tif( indicesSorted ) {\n\t\t\tconst index = indicesSorted.indexOf( result );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tresult = index;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tunmap( index: number ): number {\n\t\tlet result = index;\n\n\t\tconst indicesSorted = this.indices;\n\t\tif( indicesSorted ) {\n\t\t\tresult = indicesSorted[ result ];\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction, Texture } from \"pixi.js\";\nimport { DBaseOptions } from \"./d-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport { DThemeTreeItem, DTreeItem, DTreeItemOptions } from \"./d-tree-item\";\nimport { DTreeSelection } from \"./d-tree-selection\";\nimport { DThemes } from \"./theme/d-themes\";\n\nexport enum DTreeAddedItemPosition {\n\tBEFORE,\n\tAFTER\n}\n\nexport interface DTreeOptions<\n\tTHEME extends DThemeTree = DThemeTree,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DPaneOptions <THEME, CONTENT_OPTIONS> {\n\tvalue: DTreeItemRawData[];\n}\n\nexport interface DThemeTree extends DThemePane {\n\n}\n\nexport interface DTreeItemRawData {\n\ttext: string;\n\timage?: DisplayObject | Texture | null;\n\tchildren: DTreeItemRawData[];\n}\n\nexport interface DTreeAddedItemOptions {\n\titem: DTreeItemRawData;\n\tsibling: DTreeItemRawData;\n\tpositon: DTreeAddedItemPosition;\n}\n\nexport class DTree<\n\tTHEME extends DThemeTree = DThemeTree,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DTreeOptions <THEME, CONTENT_OPTIONS> = DTreeOptions <THEME, CONTENT_OPTIONS>\n> extends DPane <THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _itemOptions!: WeakMap<DTreeItemRawData, DTreeItemOptions>;\n\tprotected _itemOptionsShowable!: DTreeItemOptions[];\n\tprotected _selection!: DTreeSelection;\n\tprotected _value!: DTreeItemRawData[];\n\tprotected _itemIndexMappedStart!: number;\n\tprotected _itemIndexMappedEnd!: number;\n\tprivate _itemY!: number;\n\tprivate _itemHeight!: number;\n\tprivate _removeItem!: DTreeItemRawData | null;\n\tprivate _addItemOptions!: DTreeAddedItemOptions | null;\n\n\tprotected init( options ?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._itemOptions = new WeakMap();\n\t\tthis._selection = new DTreeSelection();\n\t\tthis._itemOptionsShowable = [];\n\t\tthis._itemIndexMappedStart = 0;\n\t\tthis._itemIndexMappedEnd = 0;\n\t\tthis._itemY = 0;\n\n\t\tconst itemTheme: DThemeTreeItem = DThemes.getInstance().get( \"DTreeItem\" );\n\t\tthis._itemHeight = Number( itemTheme.getHeight() );\n\n\t\tthis._value = options && options.value ? options.value : [];\n\t\tthis.updateData( null, this._value, 0 );\n\n\t\tthis._content.on( \"move\", (): void => {\n\t\t\tthis.update();\n\t\t});\n\n\t\tthis._content.on( \"resize\", (): void => {\n\t\t\tthis._content.removeChildren();\n\t\t\tthis.update();\n\t\t});\n\n\t\tthis.update();\n\t}\n\n\tprotected update() {\n\t\tconst content = this._content;\n\t\tconst items = content.children as DTreeItem[] ;\n\t\t// calculate content height\n\t\tcontent.height = this._itemOptionsShowable.length * this._itemHeight;\n\t\tconst contentY = content.position.y;\n\t\tconst height = this.height;\n\t\tconst itemIndexMappedStart = ( 0 - contentY ) / this._itemHeight - 2 < 0 ?\n\t\t\t0 :\n\t\t\tMath.floor( ( 0 - contentY ) / this._itemHeight ) - 2;\n\n\t\tconst itemIndexMappedEnd = ( height - contentY ) / this._itemHeight + 2 < this._itemOptionsShowable.length - 1 ?\n\t\t\tMath.floor( ( height - contentY ) / this._itemHeight ) + 2 :\n\t\t\tthis._itemOptionsShowable.length;\n\n\t\t// get items options are shown in Dpane content frame\n\t\tconst itemOptionsShown = this._itemOptionsShowable.slice( itemIndexMappedStart, itemIndexMappedEnd );\n\n\t\tif ( items.length < itemOptionsShown.length ) {\n\t\t\tfor ( let i = items.length; i < itemOptionsShown.length; i++ ) {\n\t\t\t\tconst itemOptions = itemOptionsShown[ i ];\n\t\t\t\tconst treeItem = new DTreeItem( itemOptions );\n\t\t\t\tcontent.addChild( treeItem );\n\t\t\t\t// listen select item event\n\t\t\t\ttreeItem.on( \"select\", ( e: interaction.InteractionEvent ): void => {\n\t\t\t\t\tif( this.state.inEnabled ) {\n\t\t\t\t\t\tthis.onSelect( treeItem.getRawData(), e );\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t\t// listen toggle item event\n\t\t\t\ttreeItem.on( \"toggle\", (): void => {\n\t\t\t\t\tif( treeItem.isParent() ) {\n\t\t\t\t\t\tif( this.state.inEnabled ) {\n\t\t\t\t\t\t\tthis.toggle( treeItem.getRawData() );\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\n\t\t} else if ( items.length > itemOptionsShown.length ) {\n\t\t\tfor ( let i = itemOptionsShown.length; i < items.length; i++ ) {\n\t\t\t\titems[ i ].hide();\n\t\t\t}\n\t\t}\n\n\t\tconst selection = this._selection;\n\t\tfor ( let i = 0; i < itemOptionsShown.length; i++ ) {\n\t\t\tconst item = items[ i ];\n\t\t\tconst itemOptions = itemOptionsShown[ i ];\n\t\t\titem.update( itemOptions, selection.contains( itemOptions.rawData ) );\n\t\t\tif( item.isHidden() ) {\n\t\t\t\titem.show();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected reload( expandAll?: boolean ) {\n\t\t// reset data of tree widget\n\t\tthis._itemOptionsShowable.length = 0;\n\t\tthis._itemY = 0;\n\t\t// re-render tree\n\t\tthis.updateData( null, this._value, 0, expandAll );\n\t\tthis.update();\n\t}\n\n\t/**\n\t * Getter method to access raw data.\n\t *\n\t * @returns raw data.\n\t */\n\tget value() {\n\t\treturn this._value;\n\t}\n\n\t/**\n\t * Toggle an tree parent item,\n\t * Expand an collapsed tree item or collapse an expanded item.\n\t *\n\t * @param item Reference data of item want to toggle in value array.\n\t */\n\tpublic toggle( item: DTreeItemRawData ) {\n\t\tconst itemOptions = this._itemOptions.get( item );\n\t\tif( itemOptions ) {\n\t\t\titemOptions.expanded = !itemOptions.expanded;\n\t\t\tthis.reload();\n\t\t}\n\t}\n\n\t/**\n\t * Expand a collapsed tree item.\n\t *\n\t * @param item Reference data of item want to expand in value array.\n\t */\n\tpublic expand( item: DTreeItemRawData ) {\n\t\tconst itemOptions = this._itemOptions.get( item );\n\t\tif( itemOptions ) {\n\t\t\titemOptions.expanded = true;\n\t\t\tthis.reload();\n\t\t}\n\t}\n\n\t/**\n\t * Collapse an expanded tree item.\n\t *\n\t * @param item Reference data of item want to collapse in value array.\n\t */\n\tpublic collapse( item: DTreeItemRawData ) {\n\t\tconst itemOptions = this._itemOptions.get( item );\n\t\tif( itemOptions ) {\n\t\t\titemOptions.expanded = false;\n\t\t\tthis.reload();\n\t\t}\n\t}\n\n\t/**\n\t * Expand all tree item.\n\t */\n\tpublic expandAll() {\n\t\tthis.reload( true );\n\t}\n\n\t/**\n\t * Collapse all tree item.\n\t */\n\tpublic collapseAll() {\n\t\tthis.reload( false );\n\t}\n\n\t/**\n\t * Check if an item is collapsed.\n\t *\n\t * @param item Reference data of item want to check in value array.\n\t *\n\t * @returns collapse status of the item.\n\t */\n\tpublic isCollapsed( item: DTreeItemRawData ) {\n\t\tconst itemOptions = this._itemOptions.get( item );\n\t\treturn itemOptions && !itemOptions.expanded;\n\t}\n\n\t/**\n\t * Check if an item is expanded.\n\t *\n\t * @param item Reference data of item want to check in value array.\n\t *\n\t * @returns expand status of the item.\n\t */\n\tpublic isExpanded( item: DTreeItemRawData ) {\n\t\tconst itemOptions = this._itemOptions.get( item );\n\t\treturn itemOptions && itemOptions.expanded;\n\t}\n\n\t/**\n\t * Clear all tree item.\n\t */\n\tpublic clear() {\n\t\tthis._value = [];\n\t\tthis.reload();\n\t}\n\n\t/**\n\t * Remove a tree item\n\t *\n\t * @param item Reference data of item want to remove in value array.\n\t */\n\tpublic remove( item: DTreeItemRawData ) {\n\t\tthis._removeItem = item;\n\t\tthis.reload();\n\t}\n\n\t/**\n\t * Add a tree item\n\t *\n\t * @param item data of new item want to add to tree.\n\t * @param parent Reference data of parent item will contain the adding item.\n\t * If the parent is undefined, the item will be added at the top level.\n\t * If the parent is not undefined, the item will be inserted as a child of the given parent item.\n\t */\n\tpublic add( item: DTreeItemRawData, parent?: DTreeItemRawData ) {\n\t\tif( parent ) {\n\t\t\tif( parent.children ) {\n\t\t\t\tparent.children.push( item );\n\t\t\t} else {\n\t\t\t\tparent.children = [ item ];\n\t\t\t}\n\t\t} else {\n\t\t\tthis._value.push( item );\n\t\t}\n\t\tthis.reload();\n\t}\n\n\t/**\n\t * Add the given item will be inserted before the given sibling item.\n\t *\n\t * @param item data of new item want to add to tree.\n\t * @param sibling Reference data of parent item will be using like anchor to add new item.\n\t */\n\tpublic addBefore( item: DTreeItemRawData, sibling: DTreeItemRawData ) {\n\t\tthis._addItemOptions = {\n\t\t\titem,\n\t\t\tsibling,\n\t\t\tpositon: DTreeAddedItemPosition.BEFORE\n\t\t};\n\t\tthis.reload();\n\t}\n\n\t/**\n\t * Add the given item will be inserted after the given sibling item.\n\t *\n\t * @param item data of new item want to add to tree.\n\t * @param sibling Reference data of parent item will be using like anchor to add new item.\n\t */\n\tpublic addAfter( item: DTreeItemRawData, sibling: DTreeItemRawData ) {\n\t\tthis._addItemOptions = {\n\t\t\titem,\n\t\t\tsibling,\n\t\t\tpositon: DTreeAddedItemPosition.AFTER\n\t\t};\n\t\tthis.reload();\n\t}\n\n\t/**\n\t * Iterate over all the items.\n\t *\n\t * @param iteratee  boolean function. If the iteratee explicitly returns false, an iteration stops.\n\t * @param item data of browsed item.\n\t */\n\tpublic each( iteratee:(item: DTreeItemRawData) => boolean ):void {\n\t\tthis.inOrder(this._value, iteratee);\n\t}\n\n\t/**\n\t * The recursive function performs item browsing in the tree.\n\t */\n\tprivate inOrder(items: DTreeItemRawData[], iteratee:(item: DTreeItemRawData) => boolean) {\n\t\tfor (const item of items) {\n\t\t\tif(!iteratee (item)) {\n\t\t\t\treturn;\n\t\t\t} else if( item.children ) {\n\t\t\t\tthis.inOrder(item.children, iteratee);\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Get selection object.\n\t * @returns selection.\n\t */\n\tget selection() {\n\t\treturn this._selection;\n\t}\n\n\tprivate updateData(\n\t\tparentItemOptions: DTreeItemOptions | null,\n\t\titems: DTreeItemRawData[],\n\t\tlevel: number,\n\t\texpandAll?: boolean\n\t) {\n\t\tfor ( let i = 0; i < items.length; i++ ) {\n\t\t\tconst item = items[ i ];\n\t\t\t// handle remove item\n\t\t\tif( item === this._removeItem ) {\n\t\t\t\t// remove item from this._value.\n\t\t\t\titems.splice( i, 1 );\n\t\t\t\tthis._removeItem = null;\n\t\t\t\ti--;\n\t\t\t\tif ( parentItemOptions && items.length === 0 ) {\n\t\t\t\t\tparentItemOptions.isParent  = false;\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\t// handle add item\n\t\t\tif( this._addItemOptions && item === this._addItemOptions.sibling ) {\n\t\t\t\tif( this._addItemOptions.positon === DTreeAddedItemPosition.AFTER ) {\n\t\t\t\t\titems.splice( i + 1, 0, this._addItemOptions.item );\n\t\t\t\t\tthis._addItemOptions = null;\n\t\t\t\t} else if ( this._addItemOptions.positon === DTreeAddedItemPosition.BEFORE ) {\n\t\t\t\t\titems.splice( i, 0, this._addItemOptions.item );\n\t\t\t\t\ti--;\n\t\t\t\t\tthis._addItemOptions = null;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tconst isParent: boolean = item.children && ( item.children.length > 0 );\n\t\t\tconst text = item.text ? item.text : \"\";\n\n\t\t\tconst itemImage = item.image ? item.image : null;\n\t\t\tlet isItemExisted = false;\n\t\t\tlet itemOptions = this._itemOptions.get( item );\n\t\t\tlet expanded = false; // set default expand status of item is false\n\t\t\tif( expandAll != null ) {\n\t\t\t\texpanded = expandAll;\n\t\t\t} else if ( itemOptions ) {\n\t\t\t\texpanded = itemOptions.expanded;\n\t\t\t}\n\n\t\t\tif( itemOptions != null ) {\n\t\t\t\titemOptions.rawData = item;\n\t\t\t\titemOptions.text = text;\n\t\t\t\titemOptions.y = this._itemY;\n\t\t\t\titemOptions.isParent = isParent;\n\t\t\t\titemOptions.expanded = expanded;\n\t\t\t\titemOptions.image = itemImage;\n\t\t\t\tisItemExisted = true;\n\t\t\t} else {\n\t\t\t\titemOptions = {\n\t\t\t\t\trawData: item,\n\t\t\t\t\ttext,\n\t\t\t\t\tlevel,\n\t\t\t\t\ty: this._itemY,\n\t\t\t\t\tisParent,\n\t\t\t\t\texpanded,\n\t\t\t\t\timage: itemImage\n\t\t\t\t};\n\t\t\t}\n\n\t\t\t/* displayed items need to satisfy 1 of the 2 conditions:\n\t\t\t1. is root item\n\t\t\t2. the parent item is show and expand\n\t\t\t*/\n\t\t\tif ( parentItemOptions == null ||\n\t\t\t\t( parentItemOptions &&\n\t\t\t\t\tparentItemOptions.expanded &&\n\t\t\t\t\tparentItemOptions.showable ) ) {\n\t\t\t\titemOptions.showable = true;\n\t\t\t\tthis._itemOptionsShowable.push( itemOptions );\n\t\t\t\tthis._itemY += this._itemHeight;\n\t\t\t} else {\n\t\t\t\titemOptions.showable = false;\n\t\t\t}\n\t\t\tif ( !isItemExisted ) {\n\t\t\t\tthis._itemOptions.set( item, itemOptions );\n\t\t\t}\n\t\t\tif ( item && item.children ) {\n\t\t\t\tthis.updateData( itemOptions, item.children, level + 1, expandAll );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onSelect( selectedData: DTreeItemRawData, e: interaction.InteractionEvent ) {\n\t\tconst selection = this._selection;\n\t\tconst originalEvent = e.data.originalEvent;\n\t\tif( originalEvent.ctrlKey ) {\n\t\t\t// multi select by \"ctr\" key + click\n\t\t\tselection.toggle( selectedData );\n\t\t} else if ( originalEvent.shiftKey ) {\n\t\t\t// multi select by \"shift\" key + click\n\t\t\tconst lastSelectedData = selection.get( selection.size() - 1 );\n\t\t\tif( lastSelectedData ) {\n\t\t\t\tconst itemOptions = this._itemOptions;\n\t\t\t\tconst selectedItemOptions = itemOptions.get( selectedData );\n\t\t\t\tconst lastSelectedItemOptions = itemOptions.get( lastSelectedData );\n\t\t\t\tif( selectedItemOptions && lastSelectedItemOptions ) {\n\t\t\t\t\tconst selectedItemY = selectedItemOptions.y;\n\t\t\t\t\tconst lastSelectedItemY = lastSelectedItemOptions.y;\n\t\t\t\t\tconst itemHeight = this._itemHeight;\n\t\t\t\t\tconst maxY = selectedItemY < lastSelectedItemY ? lastSelectedItemY - itemHeight : selectedItemY;\n\t\t\t\t\tconst minY = selectedItemY < lastSelectedItemY ? selectedItemY : lastSelectedItemY + itemHeight;\n\n\t\t\t\t\tselection.clear();\n\t\t\t\t\tthis._itemOptionsShowable.forEach(( itemOptionsShowable ): void => {\n\t\t\t\t\t\tconst itemY = itemOptionsShowable.y;\n\t\t\t\t\t\tif( minY <= itemY && itemY <= maxY && itemOptionsShowable.showable ) {\n\t\t\t\t\t\t\tselection.add( itemOptionsShowable.rawData );\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tselection.add( lastSelectedData );\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\t// single select\n\t\t\tselection.clear();\n\t\t\tselection.add( selectedData );\n\t\t}\n\t\tthis.updateActiveState();\n\t}\n\n\t/* update active state of all shown item.\n\t*\n\t**/\n\tpublic updateActiveState() {\n\t\tconst selection = this._selection;\n\t\tconst items = this._content.children as DTreeItem[];\n\t\tfor( let i = 0, imax = items.length; i < imax; ++i ) {\n\t\t\tconst item = items[ i ];\n\t\t\titem.state.isActive = selection.contains( item.getRawData() );\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTree\";\n\t}\n}\n","import { utils } from \"pixi.js\";\nimport { DTableData, DTableDataMapped, DTableDataOptions, DTableDataParent } from \"./d-table-data\";\nimport { DTableDataFilter } from \"./d-table-data-filter\";\nimport { DTableDataListFilter } from \"./d-table-data-list-filter\";\nimport { DTableDataListMapped } from \"./d-table-data-list-mapped\";\nimport { DTableDataSelection, DTableDataSelectionCreator, DTableDataSelectionOptions } from \"./d-table-data-selection\";\nimport { DTableDataListSelection } from \"./d-table-data-list-selection\";\nimport { DTableDataSorter } from \"./d-table-data-sorter\";\nimport { DTableDataListSorter } from \"./d-table-data-list-sorter\";\nimport { isFunction } from \"./util/is-function\";\n\nexport interface DTableDataListOptions<ROW> extends DTableDataOptions<ROW> {\n\trows?: ROW[];\n}\n\nexport class DTableDataList<ROW> extends utils.EventEmitter implements DTableData<ROW> {\n\tprotected _parent: DTableDataParent | null;\n\tprotected _rows: ROW[];\n\tprotected _filter: DTableDataListFilter<ROW>;\n\tprotected _sorter: DTableDataListSorter<ROW>;\n\tprotected _selection: DTableDataSelection<ROW>;\n\tprotected _mapped: DTableDataMapped<ROW>;\n\n\tconstructor( options?: DTableDataListOptions<ROW> ) {\n\t\tsuper();\n\n\t\tthis._parent = null;\n\t\tthis._rows = this.toRows( options?.rows );\n\t\tthis._mapped = new DTableDataListMapped<ROW>( this );\n\t\tthis._selection = this.toSelection( options?.selection );\n\t\tthis._filter = new DTableDataListFilter<ROW>( this );\n\t\tthis._sorter = new DTableDataListSorter<ROW>( this );\n\t\tif( options ) {\n\t\t\t// Filter\n\t\t\tconst filter = options.filter;\n\t\t\tif( filter ) {\n\t\t\t\tthis._filter.set( filter );\n\t\t\t}\n\n\t\t\t// Comparator\n\t\t\tconst comparator = options.comparator;\n\t\t\tif( comparator ) {\n\t\t\t\tthis._sorter.set( comparator );\n\t\t\t}\n\n\t\t\t// Events\n\t\t\tconst on = options.on;\n\t\t\tif( on ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tconst handler = on[ name ];\n\t\t\t\t\tif( handler ) {\n\t\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toSelection( options?: DTableDataSelection<ROW> | DTableDataSelectionCreator<ROW> | DTableDataSelectionOptions ): DTableDataSelection<ROW> {\n\t\tif( options instanceof utils.EventEmitter ) {\n\t\t\treturn options;\n\t\t} else if( isFunction( options ) ) {\n\t\t\treturn options( this );\n\t\t}\n\t\treturn this.newSelection( options );\n\t}\n\n\tprotected newSelection( options?: DTableDataSelectionOptions ): DTableDataSelection<ROW> {\n\t\treturn new DTableDataListSelection( this, options );\n\t}\n\n\tbind( parent: DTableDataParent ): void {\n\t\tthis._parent = parent;\n\t}\n\n\tprotected toRows( row?: ROW[] ): ROW[] {\n\t\tconst result: ROW[] = [];\n\t\tif( row != null ) {\n\t\t\tfor( let i = 0, imax = row.length; i < imax; ++i ) {\n\t\t\t\tresult.push( row[ i ] );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tget rows(): ROW[] {\n\t\treturn this._rows;\n\t}\n\n\tupdate(): void {\n\t\tconst parent = this._parent;\n\t\tif( parent ) {\n\t\t\tparent.update();\n\t\t}\n\t}\n\n\tlock(): void {\n\t\tconst parent = this._parent;\n\t\tif( parent ) {\n\t\t\tparent.lock();\n\t\t}\n\t}\n\n\tunlock(): void {\n\t\tconst parent = this._parent;\n\t\tif( parent ) {\n\t\t\tparent.unlock( false );\n\t\t\tparent.update();\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this._rows.length;\n\t}\n\n\tclear(): void {\n\t\tconst rows = this._rows;\n\t\tif( 0 < rows.length ) {\n\t\t\trows.length = 0;\n\t\t\tthis.lock();\n\t\t\tthis._selection.clear();\n\t\t\tthis._sorter.toDirty();\n\t\t\tthis._filter.toDirty();\n\t\t\tthis.unlock();\n\t\t}\n\t}\n\n\tclearAndAdd( row: ROW ): void {\n\t\tconst rows = this._rows;\n\t\trows.length = 0;\n\t\trows.push( row );\n\t\tthis.lock();\n\t\tthis._selection.clear();\n\t\tthis._sorter.toDirty();\n\t\tthis._filter.toDirty();\n\t\tthis.unlock();\n\t}\n\n\tclearAndAddAll( newRows: ROW[] ): void {\n\t\tconst rows = this._rows;\n\t\trows.length = 0;\n\t\tfor( let i = 0, imax = newRows.length; i < imax; ++i ) {\n\t\t\trows.push( newRows[ i ] );\n\t\t}\n\t\tthis.lock();\n\t\tthis._selection.clear();\n\t\tthis._sorter.toDirty();\n\t\tthis._filter.toDirty();\n\t\tthis.unlock();\n\t}\n\n\tadd( row: ROW, index?: number ): void {\n\t\tconst rows = this._rows;\n\t\tconst selection = this._selection;\n\t\tconst sorter = this._sorter;\n\t\tconst filter = this._filter;\n\t\tif( index == null ) {\n\t\t\trows.push( row );\n\t\t\tthis.lock();\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t} else if( 0 <= index && index < rows.length ) {\n\t\t\trows.splice( index, 0, row );\n\t\t\tthis.lock();\n\t\t\tselection.shift( index, 1 );\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t}\n\t}\n\n\taddAll( newRows: ROW[], index?: number ): void {\n\t\tconst rows = this._rows;\n\t\tconst rowsLength = rows.length;\n\t\tconst selection = this._selection;\n\t\tconst sorter = this._sorter;\n\t\tconst filter = this._filter;\n\t\tif( index == null ) {\n\t\t\tconst newRowsLength = newRows.length;\n\t\t\tfor( let i = 0, imax = newRowsLength; i < imax; ++i ) {\n\t\t\t\trows.push( newRows[ i ] );\n\t\t\t}\n\t\t\tthis.lock();\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t} else if( 0 <= index && index < rowsLength ) {\n\t\t\tconst newRowsLength = newRows.length;\n\t\t\tfor( let i = 0; i < newRowsLength; ++i ) {\n\t\t\t\trows.splice( index + i, 0, newRows[ i ] );\n\t\t\t}\n\t\t\tthis.lock();\n\t\t\tselection.shift( index, newRowsLength );\n\t\t\tsorter.toDirty();\n\t\t\tfilter.toDirty();\n\t\t\tthis.unlock();\n\t\t}\n\t}\n\n\tget( index: number ): ROW | null {\n\t\tconst rows = this._rows;\n\t\tif( 0 <= index && index < rows.length ) {\n\t\t\treturn rows[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tset( index: number, row: ROW ): ROW | null {\n\t\tconst rows = this._rows;\n\t\tif( 0 <= index && index < rows.length ) {\n\t\t\tconst result = rows[ index ];\n\t\t\trows[ index ] = row;\n\t\t\tthis.lock();\n\t\t\tthis._sorter.toDirty();\n\t\t\tthis._filter.toDirty();\n\t\t\tthis.unlock();\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tremove( index: number ): ROW | null {\n\t\tconst rows = this._rows;\n\t\tif( 0 <= index && index < rows.length ) {\n\t\t\tconst result = rows.splice( index, 1 )[ 0 ];\n\t\t\tthis.lock();\n\t\t\tthis._selection.remove( index );\n\t\t\tthis._sorter.toDirty();\n\t\t\tthis._filter.toDirty();\n\t\t\tthis.unlock();\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\teach( iteratee: ( row: ROW, index: number ) => boolean | void, ifrom?: number, ito?: number ): void {\n\t\tconst rows = this._rows;\n\t\tifrom = ( ifrom != null ? Math.max( 0, ifrom ) : 0 );\n\t\tito = ( ito != null ? Math.min( rows.length, ito ) : rows.length );\n\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\tconst row = rows[ i ];\n\t\t\tif( iteratee( row, i ) === false ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tget selection(): DTableDataSelection<ROW> {\n\t\treturn this._selection;\n\t}\n\n\tget filter(): DTableDataFilter<ROW> {\n\t\treturn this._filter;\n\t}\n\n\tget sorter(): DTableDataSorter<ROW> {\n\t\treturn this._sorter;\n\t}\n\n\tget mapped(): DTableDataMapped<ROW> {\n\t\treturn this._mapped;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point, Rectangle } from \"pixi.js\";\nimport InteractionEvent = interaction.InteractionEvent;\nimport { DBase, DBaseOptions, DThemeBase } from \"./d-base\";\nimport { DBaseState } from \"./d-base-state\";\nimport { DTableBodyRow, DTableBodyRowOnChange, DTableBodyRowOptions } from \"./d-table-body-row\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { DTableData, DTableDataOptions } from \"./d-table-data\";\nimport { DTableDataList, DTableDataListOptions } from \"./d-table-data-list\";\nimport { DTableDataSelection, DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { DTableBodyCell } from \"./d-table-body-cell\";\nimport { DTableState } from \"./d-table-state\";\n\nexport interface DTableBodyOptions<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTableBody = DThemeTableBody\n> extends DBaseOptions<THEME> {\n\tcolumns?: Array<DTableColumn<ROW, unknown>>;\n\trow?: DTableBodyRowOptions<ROW>;\n\tdata?: DTableDataListOptions<ROW> | DATA;\n\toffset?: number;\n\tfrozen?: number;\n}\n\nexport interface DThemeTableBody extends DThemeBase {\n\tgetRowHeight(): number;\n}\n\nconst toRowOptions = <ROW, DATA extends DTableData<ROW>>(\n\ttheme: DThemeTableBody,\n\toptions: DTableBodyOptions<ROW, DATA>,\n\tselectionType: DTableDataSelectionType\n): DTableBodyRowOptions<ROW> => {\n\tconst columns = options.columns || [];\n\tlet result = options.row;\n\tif( result != null ) {\n\t\tif( result.height == null ) {\n\t\t\tresult.height = theme.getRowHeight();\n\t\t}\n\t\tif( result.columns === undefined ) {\n\t\t\tresult.columns = columns;\n\t\t}\n\t\tif( result.frozen == null ) {\n\t\t\tresult.frozen = options.frozen;\n\t\t}\n\t\tif( result.selection === undefined ) {\n\t\t\tresult.selection = {\n\t\t\t\ttype: selectionType\n\t\t\t};\n\t\t} else if( result.selection.type === undefined ) {\n\t\t\tresult.selection.type = selectionType;\n\t\t}\n\t} else {\n\t\tresult = {\n\t\t\tcolumns,\n\t\t\theight: theme.getRowHeight(),\n\t\t\tfrozen: options.frozen,\n\t\t\tselection: {\n\t\t\t\ttype: selectionType\n\t\t\t}\n\t\t};\n\t}\n\treturn result as DTableBodyRowOptions<ROW>;\n};\n\nexport class DTableBody<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTableBody = DThemeTableBody,\n\tOPTIONS extends DTableBodyOptions<ROW, DATA, THEME> = DTableBodyOptions<ROW, DATA, THEME>\n> extends DBase<THEME, OPTIONS> {\n\tprotected static WORK_ON_CLICK = new Point();\n\n\tprotected _columns: Array<DTableColumn<ROW, unknown>>;\n\tprotected _rowHeight: number;\n\tprotected _rowIndexMappedStart: number;\n\tprotected _rowIndexMappedEnd: number;\n\tprotected _rowOptions: DTableBodyRowOptions<ROW>;\n\tprotected _updateRowsCount: number;\n\tprotected _isUpdateRowsCalled: boolean;\n\tprotected _isUpdateRowsCalledForcibly: boolean;\n\tprotected _workRows: Array<DTableBodyRow<ROW>>;\n\tprotected _onRowChangeBound: DTableBodyRowOnChange<ROW, unknown>;\n\tprotected _data: DATA;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis.state.isFocusable = false;\n\t\tthis.transform.position.y = options.offset ?? 0;\n\t\tconst data = this.toData( options.data );\n\t\tthis._data = data;\n\t\tdata.bind( this );\n\t\tconst theme = this.theme;\n\t\tconst rowOptions = toRowOptions( theme, options, data.selection.type );\n\t\tthis._rowOptions = rowOptions;\n\t\tthis._rowHeight = ( rowOptions.height != null ? rowOptions.height : theme.getRowHeight() );\n\t\tthis._columns = rowOptions.columns || [];\n\t\tthis._rowIndexMappedStart = 0;\n\t\tthis._rowIndexMappedEnd = 0;\n\t\tthis._updateRowsCount = 0;\n\t\tthis._isUpdateRowsCalled = false;\n\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\tthis._workRows = [];\n\t\tthis._onRowChangeBound = ( newValue, oldValue, row, rowIndex, columnIndex ): void => {\n\t\t\tdata.emit( \"change\", newValue, oldValue, row, rowIndex, columnIndex, data );\n\t\t};\n\t\tthis._data.emit( \"init\", this._data );\n\t}\n\n\tprotected toData( options?: DATA | DTableDataListOptions<ROW> ): DATA {\n\t\tif( this.isData( options ) ) {\n\t\t\treturn options;\n\t\t}\n\t\treturn new DTableDataList<ROW>( options ) as any;\n\t}\n\n\tprotected isData( target?: ROW[] | DTableDataOptions<ROW> | DTableData<ROW> ): target is DTableData<ROW> {\n\t\treturn ( target != null && \"mapped\" in target );\n\t};\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tthis.update();\n\t}\n\n\tget selection(): DTableDataSelection<ROW> {\n\t\treturn this._data.selection;\n\t}\n\n\tlock(): void {\n\t\tthis._updateRowsCount += 1;\n\t\tif( this._updateRowsCount === 1 ) {\n\t\t\tthis._isUpdateRowsCalled = false;\n\t\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\t}\n\t}\n\n\tunlock( callIfNeeded: boolean ): void {\n\t\tthis._updateRowsCount -= 1;\n\t\tif( this._updateRowsCount === 0 ) {\n\t\t\tif( callIfNeeded && this._isUpdateRowsCalled ) {\n\t\t\t\tthis.update( this._isUpdateRowsCalledForcibly );\n\t\t\t}\n\t\t\tthis._isUpdateRowsCalled = false;\n\t\t\tthis._isUpdateRowsCalledForcibly = false;\n\t\t}\n\t}\n\n\t/**\n\t * Updates rows. If the `forcibly` is true, some dirty checkings for\n\t * avoiding unnecessary state changes are skipped.\n\t *\n\t * @param forcibly true to update forcibly\n\t */\n\tupdate( forcibly?: boolean ): void {\n\t\tif( 0 < this._updateRowsCount ) {\n\t\t\tthis._isUpdateRowsCalled = true;\n\t\t\tif( forcibly ) {\n\t\t\t\tthis._isUpdateRowsCalledForcibly = true;\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\n\t\tconst content = this.parent;\n\t\tconst rows = this.children as Array<DTableBodyRow<ROW>>;\n\t\tconst height = content.parent.height;\n\t\tconst rowHeight = this._rowHeight;\n\n\t\tconst data = this._data;\n\t\tconst dataMappedSize = data.mapped.size();\n\n\t\tconst oldRowIndexMappedStart = this._rowIndexMappedStart;\n\t\tlet oldRowIndexMappedEnd = this._rowIndexMappedEnd;\n\t\tlet oldRowCount = oldRowIndexMappedEnd - oldRowIndexMappedStart;\n\n\t\tconst y = this.transform.position.y;\n\t\tconst newHeight = y + dataMappedSize * rowHeight;\n\t\tconst newContentHeight = Math.max( height, newHeight );\n\t\tconst newContentY = Math.max( height - newContentHeight, content.position.y );\n\n\t\tconst newRowIndexMappedLowerBound = Math.floor( (0 - (newContentY + y)) / rowHeight );\n\t\tconst newRowIndexMappedUpperBound = Math.floor( (height - (newContentY + y)) / rowHeight );\n\t\tconst newRowIndexMappedStart = newRowIndexMappedLowerBound - ( newRowIndexMappedLowerBound % 2 === 0 ? 2 : 1 );\n\t\tlet newRowIndexMappedEnd = newRowIndexMappedUpperBound +\n\t\t\t((newRowIndexMappedUpperBound - newRowIndexMappedStart + 1) % 2 === 0 ? 3 : 2);\n\t\tlet newRowCount = newRowIndexMappedEnd - newRowIndexMappedStart;\n\t\tif( newRowCount < oldRowCount && oldRowCount - 2 <= newRowCount ) {\n\t\t\tnewRowCount = oldRowCount;\n\t\t\tnewRowIndexMappedEnd = newRowIndexMappedStart + newRowCount;\n\t\t}\n\n\t\tif( oldRowCount < newRowCount ) {\n\t\t\tfor( let i = oldRowCount; i < newRowCount; ++i ) {\n\t\t\t\tconst oldRowIndexMapped = oldRowIndexMappedStart + i;\n\t\t\t\tconst newRow = this.newRow( (oldRowIndexMapped % 2) === 0 );\n\t\t\t\tthis.addChild( newRow );\n\t\t\t}\n\t\t\toldRowCount = newRowCount;\n\t\t\toldRowIndexMappedEnd = oldRowIndexMappedStart + oldRowCount;\n\t\t} else if( newRowCount < oldRowCount ) {\n\t\t\tfor( let i = oldRowCount - 1; newRowCount <= i; --i ) {\n\t\t\t\tthis.removeChild( rows[ i ] );\n\t\t\t}\n\t\t\toldRowCount = newRowCount;\n\t\t\toldRowIndexMappedEnd = oldRowIndexMappedStart + oldRowCount;\n\t\t}\n\n\t\tthis._rowIndexMappedStart = newRowIndexMappedStart;\n\t\tthis._rowIndexMappedEnd = newRowIndexMappedEnd;\n\n\t\tconst rowIndexMappedStartDelta = newRowIndexMappedStart - oldRowIndexMappedStart;\n\t\tconst rowIndexMappedStartDeltaAbs = Math.abs(rowIndexMappedStartDelta);\n\t\tconst rowsLength = rows.length;\n\t\tif( 0 < rowIndexMappedStartDeltaAbs && rowIndexMappedStartDeltaAbs < rowsLength ) {\n\t\t\tconst work = this._workRows;\n\t\t\tif( 0 < rowIndexMappedStartDelta ) {\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\twork.push( this.resetRow( rows[ i ] ) );\n\t\t\t\t}\n\t\t\t\tfor( let i = rowIndexMappedStartDeltaAbs; i < rowsLength; ++i ) {\n\t\t\t\t\trows[ i - rowIndexMappedStartDeltaAbs ] = rows[ i ];\n\t\t\t\t}\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\trows[ rowsLength - rowIndexMappedStartDeltaAbs + i ] = work[ i ];\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\twork.push( this.resetRow( rows[ rowsLength - rowIndexMappedStartDeltaAbs + i ] ) );\n\t\t\t\t}\n\t\t\t\tfor( let i = rowsLength - rowIndexMappedStartDeltaAbs - 1; 0 <= i; --i ) {\n\t\t\t\t\trows[ i + rowIndexMappedStartDeltaAbs ] = rows[ i ];\n\t\t\t\t}\n\t\t\t\tfor( let i = 0; i < rowIndexMappedStartDeltaAbs; ++i ) {\n\t\t\t\t\trows[ i ] = work[ i ];\n\t\t\t\t}\n\t\t\t}\n\t\t\twork.length = 0;\n\t\t}\n\n\t\tconst selection = data.selection;\n\t\tconst isRowSelectable = (selection.type !== DTableDataSelectionType.NONE);\n\t\tdata.mapped.each(( datum: ROW, supplimental: unknown, index: number, unmappedIndex: number ): void | boolean => {\n\t\t\tconst row = rows[ index - newRowIndexMappedStart ];\n\n\t\t\t// Position\n\t\t\trow.position.y = index * rowHeight;\n\n\t\t\t// State\n\t\t\tconst rowState = row.state;\n\t\t\trowState.lock();\n\t\t\trowState.set( DTableState.SELECTABLE, isRowSelectable );\n\t\t\trowState.set( DBaseState.ACTIVE, selection.contains( unmappedIndex ) );\n\t\t\trowState.remove( DBaseState.DISABLED );\n\t\t\trowState.unlock();\n\n\t\t\t// Data\n\t\t\trow.set( datum, supplimental, unmappedIndex, forcibly );\n\t\t}, newRowIndexMappedStart, newRowIndexMappedStart + rowsLength );\n\n\t\tfor( let i = 0; newRowIndexMappedStart + i < 0 && i < rowsLength; ++i ) {\n\t\t\tconst row = rows[ i ];\n\n\t\t\t// Position\n\t\t\trow.position.y = ( newRowIndexMappedStart + i ) * rowHeight;\n\n\t\t\t// State\n\t\t\tconst rowState = row.state;\n\t\t\trowState.lock();\n\t\t\trowState.add( DBaseState.DISABLED );\n\t\t\trowState.removeAll( DTableState.SELECTABLE, DBaseState.ACTIVE );\n\t\t\trowState.unlock();\n\n\t\t\t// Data\n\t\t\trow.unset();\n\t\t}\n\n\t\tfor( let i = rowsLength - 1; dataMappedSize <= newRowIndexMappedStart + i && 0 <= i; --i ) {\n\t\t\tconst row = rows[ i ];\n\n\t\t\t// Position\n\t\t\trow.position.y = ( newRowIndexMappedStart + i ) * rowHeight;\n\n\t\t\t// State\n\t\t\tconst rowState = row.state;\n\t\t\trowState.lock();\n\t\t\trowState.add( DBaseState.DISABLED );\n\t\t\trowState.removeAll( DTableState.SELECTABLE, DBaseState.ACTIVE );\n\t\t\trowState.unlock();\n\n\t\t\t// Data\n\t\t\trow.unset();\n\t\t}\n\n\t\tthis.lock();\n\t\tcontent.position.y = newContentY;\n\t\tcontent.height = newContentHeight;\n\t\tthis.height = newHeight;\n\t\tthis.unlock( false );\n\t}\n\n\tprotected resetRow( row: DTableBodyRow<ROW> ): DTableBodyRow<ROW> {\n\t\trow.blur( true );\n\t\tconst cells = row.children;\n\t\tfor( let i = 0, imax = cells.length; i < imax; ++i ) {\n\t\t\tconst cell = cells[ i ];\n\t\t\tif( cell instanceof DBase ) {\n\t\t\t\tcell.state.isPressed = false;\n\t\t\t}\n\t\t}\n\t\treturn row;\n\t}\n\n\tprotected newRow( isEven: boolean ): DTableBodyRow<ROW> {\n\t\treturn new DTableBodyRow<ROW>( this._onRowChangeBound, isEven, this._rowOptions );\n\t}\n\n\tprotected onParentMove( newX: number, newY: number, oldX: number, oldY: number ): void {\n\t\tsuper.onParentMove( newX, newY, oldX, oldY );\n\t\tthis.updateFrozenCellPosition( newX );\n\t}\n\n\tprotected updateFrozenCellPosition( x: number ): void {\n\t\tconst frozen = this._rowOptions.frozen;\n\t\tif( frozen != null && 0 < frozen ) {\n\t\t\tconst rows = this.children as Array<DTableBodyRow<ROW>>;\n\t\t\tfor( let i = 0, imax = rows.length; i < imax; ++i ) {\n\t\t\t\trows[ i ].updateFrozenCellPosition( x );\n\t\t\t}\n\t\t}\n\t}\n\n\tgetClippingRect( target: unknown, result: Rectangle ): void {\n\t\tsuper.getClippingRect( target, result );\n\n\t\tconst parent = this.parent;\n\t\tif( parent ) {\n\t\t\tconst dy = -parent.transform.position.y;\n\t\t\tresult.y += dy;\n\t\t\tresult.height -= dy;\n\t\t}\n\t}\n\n\tprotected toRowIndexMapped( local: Point ): number {\n\t\tif( 0 <= this.parent.position.y + local.y ) {\n\t\t\treturn Math.floor( local.y / this._rowHeight );\n\t\t}\n\t\treturn -1;\n\t}\n\n\tprotected toRow( rowIndexMapped: number ): DTableBodyRow<ROW> | null {\n\t\tconst index = rowIndexMapped - this._rowIndexMappedStart;\n\t\tconst rows = this.children as Array<DTableBodyRow<ROW>>;\n\t\tif( 0 <= index && index < rows.length ) {\n\t\t\treturn rows[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected toCell( row: DTableBodyRow<ROW>, local: Point ): DTableBodyCell<ROW, unknown> | null {\n\t\tconst cells = row.children as Array<DTableBodyCell<ROW, unknown>>;\n\t\tconst cellsLength = cells.length;\n\t\tconst columns = this._columns;\n\t\tconst columnsLength = columns.length;\n\t\tfor( let i = 0, imax = Math.min( cellsLength, columnsLength ); i < imax; ++i ) {\n\t\t\tconst cell = cells[ cellsLength - i - 1 ];\n\t\t\tconst x = local.x - cell.position.x;\n\t\t\tif( 0 <= x && x <= cell.width ) {\n\t\t\t\treturn cell;\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tonRowClick( e: InteractionEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tconst local = DTableBody.WORK_ON_CLICK;\n\t\t\tlocal.copyFrom( e.data.global );\n\t\t\tthis.toLocal( local, undefined, local, false );\n\t\t\tconst rowIndexMapped = this.toRowIndexMapped( local );\n\t\t\tif( 0 <= rowIndexMapped && rowIndexMapped < this._data.mapped.size() ) {\n\t\t\t\t// Delegate to the cell at first\n\t\t\t\tconst row = this.toRow( rowIndexMapped );\n\t\t\t\tif( row ) {\n\t\t\t\t\tconst cell = this.toCell( row, local );\n\t\t\t\t\tif( cell && cell.onRowSelect && cell.onRowSelect( e, local ) ) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t// Fallback to the default\n\t\t\t\tthis.onRowSelect( e, rowIndexMapped );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onRowSelect( e: InteractionEvent, rowIndexMapped: number ): void {\n\t\tconst data = this._data;\n\t\tconst selection = data.selection;\n\t\tconst isSingle = ( selection.type === DTableDataSelectionType.SINGLE );\n\t\tconst isNotSingle = ! isSingle;\n\t\tconst rowIndex = data.mapped.unmap( rowIndexMapped );\n\t\tconst originalEvent = e.data.originalEvent;\n\t\tconst ctrlKey = originalEvent.ctrlKey;\n\t\tconst shiftKey = originalEvent.shiftKey;\n\t\tif( isSingle || selection.isEmpty() || ! ( isNotSingle && ( ctrlKey || shiftKey ) ) ) {\n\t\t\tselection.clearAndAdd( rowIndex );\n\t\t} else if( ctrlKey ) {\n\t\t\tselection.toggle( rowIndex );\n\t\t} else if( shiftKey ) {\n\t\t\tconst lastRowIndex = selection.last;\n\t\t\tif( lastRowIndex != null ) {\n\t\t\t\tconst sorter = data.sorter;\n\t\t\t\tconst filter = data.filter;\n\t\t\t\tconst rowIndexSorted = sorter.map( rowIndex );\n\t\t\t\tconst lastRowIndexSorted = sorter.map( lastRowIndex );\n\t\t\t\tif( rowIndexSorted != null && lastRowIndexSorted != null ) {\n\t\t\t\t\tlet istart = lastRowIndexSorted + 1;\n\t\t\t\t\tlet iend = rowIndexSorted + 1;\n\t\t\t\t\tif( rowIndexSorted < lastRowIndexSorted ) {\n\t\t\t\t\t\tistart = rowIndexSorted;\n\t\t\t\t\t\tiend = lastRowIndexSorted;\n\t\t\t\t\t}\n\t\t\t\t\tif( istart < iend ) {\n\t\t\t\t\t\tconst rowIndices: number[] = [];\n\t\t\t\t\t\tconst indicesFiltered = filter.indices;\n\t\t\t\t\t\tconst indicesSorted = sorter.indices;\n\t\t\t\t\t\tif( indicesFiltered ) {\n\t\t\t\t\t\t\tif( indicesSorted ) {\n\t\t\t\t\t\t\t\tfor( let i = 0, imax = indicesFiltered.length; i < imax; ++i ) {\n\t\t\t\t\t\t\t\t\tconst indexFiltered = indicesFiltered[ i ];\n\t\t\t\t\t\t\t\t\tif( istart <= indexFiltered && indexFiltered < iend ) {\n\t\t\t\t\t\t\t\t\t\trowIndices.push( indicesSorted[ indexFiltered ] );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfor( let i = 0, imax = indicesFiltered.length; i < imax; ++i ) {\n\t\t\t\t\t\t\t\t\tconst indexFiltered = indicesFiltered[ i ];\n\t\t\t\t\t\t\t\t\tif( istart <= indexFiltered && indexFiltered < iend ) {\n\t\t\t\t\t\t\t\t\t\trowIndices.push( indexFiltered );\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tif( indicesSorted ) {\n\t\t\t\t\t\t\t\tfor( let i = istart; i < iend; ++i ) {\n\t\t\t\t\t\t\t\t\trowIndices.push( indicesSorted[ i ] );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tfor( let i = istart; i < iend; ++i ) {\n\t\t\t\t\t\t\t\t\trowIndices.push( i );\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tselection.addAll( rowIndices );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableBody\";\n\t}\n\n\tget data(): DATA {\n\t\treturn this._data;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\n\nexport interface DTableCategoryCellOptions<\n\tTHEME extends DThemeTableCategoryCell = DThemeTableCategoryCell\n> extends DImageOptions<string | null, THEME> {\n\n}\n\nexport interface DThemeTableCategoryCell extends DThemeImage<string | null> {\n\n}\n\nexport class DTableCategoryCell<\n\tTHEME extends DThemeTableCategoryCell = DThemeTableCategoryCell,\n\tOPTIONS extends DTableCategoryCellOptions<THEME> = DTableCategoryCellOptions<THEME>\n> extends DImage<string | null, THEME, OPTIONS> {\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\tsuper.init( options );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableCategoryCell\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DTableCategoryCell, DTableCategoryCellOptions } from \"./d-table-category-cell\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\n\nexport interface DTableCategoryColumn {\n\tlabel?: string;\n\tweight?: number;\n\twidth?: number;\n\toffset: number;\n}\n\nexport interface DTableCategoryOptions<\n\tTHEME extends DThemeTableCategory = DThemeTableCategory\n> extends DTableRowOptions<unknown, DTableCategoryColumn, THEME> {\n\toffset?: number;\n\tcell?: DTableCategoryCellOptions;\n}\n\nexport interface DThemeTableCategory extends DThemeTableRow {\n\n}\n\nexport class DTableCategory<\n\tTHEME extends DThemeTableCategory = DThemeTableCategory,\n\tOPTIONS extends DTableCategoryOptions<THEME> = DTableCategoryOptions<THEME>\n> extends DTableRow<unknown, DTableCategoryColumn, THEME, OPTIONS> {\n\tprotected _offset: number;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tconst offset = options.offset ?? 0;\n\t\tthis._offset = offset;\n\t\tthis.transform.position.y = offset;\n\n\t\tthis.initCells( options, this._columns, this._frozen );\n\t}\n\n\tprotected onParentMove( newX: number, newY: number, oldX: number, oldY: number ): void {\n\t\tsuper.onParentMove( newX, newY, oldX, oldY );\n\t\tthis.transform.position.y = -newY + this._offset;\n\t\tthis.updateFrozenCellPosition( newX );\n\t}\n\n\tprotected getContentPositionX(): number {\n\t\tconst content = this.parent;\n\t\tif( content ) {\n\t\t\treturn content.position.x;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected newCell(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableCategoryColumn,\n\t\tcolumns: DTableCategoryColumn[],\n\t\toptions: OPTIONS\n\t): DBase {\n\t\treturn new DTableCategoryCell( this.toCellOptions( columnIndex, column, options ) );\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableCategoryColumn,\n\t\toptions: OPTIONS\n\t): DTableCategoryCellOptions {\n\t\tconst result = options.cell;\n\t\tif( result ) {\n\t\t\tresult.weight = column.weight;\n\t\t\tresult.width = column.width;\n\t\t\tconst text = result.text = result.text || {};\n\t\t\ttext.value = text.value || column.label;\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tweight: column.weight,\n\t\t\t\twidth: column.width,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: column.label\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableCategory\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableDataFilter, DTableDataFilterFunction, DTableDataFilterObject } from \"./d-table-data-filter\";\nimport { DTableDataTreeItem } from \"./d-table-data-tree-item\";\nimport { DTableDataTreeItemAccessor } from \"./d-table-data-tree-item-accessor\";\nimport { isFunction } from \"./util/is-function\";\n\ninterface DTableDataTreeFilterParent<NODE> {\n\treadonly nodes: NODE[] | undefined;\n\treadonly accessor: DTableDataTreeItemAccessor<NODE>;\n\tisOpened( node: NODE ): boolean;\n\tupdate(): void;\n}\n\nexport class DTableDataTreeFilter<NODE extends DTableDataTreeItem<NODE, NODE>>\n\textends utils.EventEmitter implements DTableDataFilter<NODE> {\n\tprotected _id: number;\n\tprotected _idUpdated: number;\n\tprotected _isApplied: boolean;\n\tprotected _parent: DTableDataTreeFilterParent<NODE>;\n\tprotected _filter: DTableDataFilterFunction<NODE> | DTableDataFilterObject<NODE> | null;\n\tprotected _filtered: number[] | null;\n\n\tconstructor( parent: DTableDataTreeFilterParent<NODE> ) {\n\t\tsuper();\n\n\t\tthis._id = 0;\n\t\tthis._idUpdated = -1;\n\t\tthis._isApplied = false;\n\n\t\tthis._parent = parent;\n\t\tthis._filter = null;\n\t\tthis._filtered = null;\n\t}\n\n\tget id(): number {\n\t\treturn this._id;\n\t}\n\n\tapply(): void {\n\t\tthis._isApplied = true;\n\t\tthis._id += 1;\n\t\tthis._parent.update();\n\t}\n\n\tunapply(): void {\n\t\tif( this._isApplied ) {\n\t\t\tthis._isApplied = false;\n\t\t\tthis._id += 1;\n\t\t\tthis._parent.update();\n\t\t}\n\t}\n\n\tisApplied(): boolean {\n\t\treturn this._isApplied;\n\t}\n\n\tprotected isFiltered(\n\t\tnode: NODE, index: number,\n\t\tfilter: DTableDataFilterFunction<NODE> | DTableDataFilterObject<NODE>\n\t): boolean {\n\t\tif( isFunction( filter ) ) {\n\t\t\treturn filter( node, index );\n\t\t} else {\n\t\t\treturn filter.test( node, index );\n\t\t}\n\t}\n\n\tprotected hasFiltered(\n\t\tparent: DTableDataTreeFilterParent<NODE>,\n\t\tnodes: NODE[],\n\t\tfilter: DTableDataFilterFunction<NODE> | DTableDataFilterObject<NODE>\n\t): boolean {\n\t\tconst toChildren = this._parent.accessor.toChildren;\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( this.isFiltered( node, -1, filter ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\tconst children = toChildren( node );\n\t\t\tif( children != null && 0 < children.length && this.hasFiltered( parent, children, filter ) ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected addAllToFiltered(\n\t\tparent: DTableDataTreeFilterParent<NODE>,\n\t\tnodes: NODE[],\n\t\tfiltered: number[],\n\t\tcursor: [ number ]\n\t): void {\n\t\tconst toChildren = this._parent.accessor.toChildren;\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tfiltered.push( cursor[ 0 ] );\n\t\t\tcursor[ 0 ] += 1;\n\t\t\tconst children = toChildren( node );\n\t\t\tif( children != null && 0 < children.length && parent.isOpened( node ) ) {\n\t\t\t\tthis.addAllToFiltered( parent, children, filtered, cursor );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected newFilteredSub(\n\t\tparent: DTableDataTreeFilterParent<NODE>,\n\t\tnodes: NODE[],\n\t\tfilter: DTableDataFilterFunction<NODE> | DTableDataFilterObject<NODE>,\n\t\tfiltered: number[],\n\t\tcursor: [ number ]\n\t): boolean {\n\t\tlet result = false;\n\t\tconst toChildren = this._parent.accessor.toChildren;\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tconst index = cursor[ 0 ];\n\t\t\tcursor[ 0 ] += 1;\n\t\t\tconst isFiltered = this.isFiltered( node, index, filter );\n\t\t\tconst children = toChildren( node );\n\t\t\tif( children != null && 0 < children.length ) {\n\t\t\t\tif( parent.isOpened( node ) ) {\n\t\t\t\t\tif( isFiltered ) {\n\t\t\t\t\t\tfiltered.push( index );\n\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\tthis.addAllToFiltered( parent, children, filtered, cursor );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst position = filtered.length;\n\t\t\t\t\t\tif( this.newFilteredSub( parent, children, filter, filtered, cursor ) ) {\n\t\t\t\t\t\t\tfiltered.splice( position, 0, index );\n\t\t\t\t\t\t\tresult = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if( isFiltered || this.hasFiltered( parent, children, filter ) ) {\n\t\t\t\t\tfiltered.push( index );\n\t\t\t\t\tresult = true;\n\t\t\t\t}\n\t\t\t} else if( isFiltered ) {\n\t\t\t\tfiltered.push( index );\n\t\t\t\tresult = true;\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected newFiltered(): number[] | null {\n\t\tconst filter = this._filter;\n\t\tif( filter != null ) {\n\t\t\tconst filtered: number[] = [];\n\t\t\tconst parent = this._parent;\n\t\t\tconst nodes = parent.nodes;\n\t\t\tif( nodes ) {\n\t\t\t\tconst cursor: [ number ] = [ 0 ];\n\t\t\t\tthis.newFilteredSub( parent, nodes, filter, filtered, cursor );\n\t\t\t}\n\t\t\treturn filtered;\n\t\t}\n\t\treturn null;\n\t}\n\n\tget(): DTableDataFilterFunction<NODE> | DTableDataFilterObject<NODE> | null {\n\t\treturn this._filter;\n\t}\n\n\tset( filter: DTableDataFilterFunction<NODE> | DTableDataFilterObject<NODE> | null ): void {\n\t\tif( this._filter !== filter ) {\n\t\t\tthis._filter = filter;\n\t\t}\n\t}\n\n\ttoDirty(): void {\n\t\tthis._id += 1;\n\t}\n\n\tupdate(): void {\n\t\tif( this._id !== this._idUpdated ) {\n\t\t\tthis._idUpdated = this._id;\n\t\t\tif( this._isApplied ) {\n\t\t\t\tthis._filtered = this.newFiltered();\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t} else if( this._filtered != null ) {\n\t\t\t\tthis._filtered = null;\n\t\t\t\tthis.emit( \"change\", this );\n\t\t\t}\n\t\t}\n\t}\n\n\tget indices(): number[] | null {\n\t\tthis.update();\n\t\treturn this._filtered;\n\t}\n\n\tmap( sortedIndex: number ): number | null {\n\t\tlet result = sortedIndex;\n\n\t\tconst indices = this.indices;\n\t\tif( indices ) {\n\t\t\tconst index = indices.indexOf( result );\n\t\t\tif( 0 <= index ) {\n\t\t\t\tresult = index;\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tunmap( index: number ): number {\n\t\tlet result = index;\n\n\t\tconst indices = this.indices;\n\t\tif( indices ) {\n\t\t\tresult = indices[ result ];\n\t\t}\n\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport interface DTableDataTreeItemAccessorOptions<NODE> {\n\ttoParent?: ( node: NODE ) => NODE | null | undefined;\n\ttoChildren?: ( node: NODE ) => NODE[] | null | undefined;\n}\n\nconst toParent = <NODE>( node: any ): NODE | null | undefined => {\n\treturn node.parent;\n};\n\nconst toChildren = <NODE>( node: any ): NODE | null | undefined => {\n\treturn node.children;\n};\n\nexport class DTableDataTreeItemAccessor<NODE> {\n\ttoParent: ( node: NODE ) => NODE | null | undefined;\n\ttoChildren: ( node: NODE ) => NODE[] | null | undefined;\n\n\tconstructor( options?: DTableDataTreeItemAccessorOptions<NODE> ) {\n\t\tthis.toParent = options?.toParent ?? toParent;\n\t\tthis.toChildren = options?.toChildren ?? toChildren;\n\t}\n\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableDataSelectionOptions, DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { DTableDataTreeSelection, DTableDataTreeSelectionParent } from \"./d-table-data-tree-selection\";\nimport { toEnum } from \"./util/to-enum\";\n\nconst COMPARATOR = ( a: [number, unknown], b: [number, unknown] ): number => {\n\treturn a[ 0 ] - b[ 0 ];\n};\n\nexport class DTableDataTreeSelectionImpl<NODE> extends utils.EventEmitter implements DTableDataTreeSelection<NODE> {\n\tprotected _parent: DTableDataTreeSelectionParent<NODE>;\n\tprotected _type: DTableDataSelectionType;\n\tprotected _rows: Set<NODE>;\n\n\tconstructor( parent: DTableDataTreeSelectionParent<NODE>, options?: DTableDataSelectionOptions ) {\n\t\tsuper();\n\t\tthis._parent = parent;\n\t\tthis._type = toEnum( options?.type ?? DTableDataSelectionType.NONE, DTableDataSelectionType );\n\t\tthis._rows = new Set<NODE>();\n\t}\n\n\tonNodeChange( nodes?: NODE[] ): void {\n\t\tif( nodes != null ) {\n\t\t\tconst toChildren = this._parent.accessor.toChildren;\n\t\t\tconst oldRows = this._rows;\n\t\t\tconst newRows = this.newRows( nodes, toChildren, oldRows, new Set<NODE>() );\n\t\t\tif( oldRows.size !== newRows.size ) {\n\t\t\t\tthis._rows = newRows;\n\t\t\t\tthis.onChange();\n\t\t\t}\n\t\t} else {\n\t\t\tconst rows = this._rows;\n\t\t\tif( 0 < rows.size ) {\n\t\t\t\trows.clear();\n\t\t\t\tthis.onChange();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected newRows(\n\t\tnodes: NODE[], toChildren: ( node: NODE ) => NODE[] | null | undefined,\n\t\trows: Set<NODE>, result: Set<NODE>\n\t): Set<NODE> {\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tif( rows.has( node ) ) {\n\t\t\t\tresult.add( node );\n\t\t\t}\n\t\t\tconst children = toChildren( node );\n\t\t\tif( children != null ) {\n\t\t\t\tthis.newRows( children, toChildren, rows, result );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tget indices(): number[] {\n\t\tconst rows = this._rows;\n\t\tconst result: number[] = [];\n\t\tthis._parent.each(( row: NODE, index: number ): void => {\n\t\t\tif( rows.has( row ) ) {\n\t\t\t\tresult.push( index );\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\tget rows(): NODE[] {\n\t\tconst result: NODE[] = [];\n\t\tthis._rows.forEach(( row: NODE ): void => {\n\t\t\tresult.push( row );\n\t\t});\n\t\treturn result;\n\t}\n\n\tget type(): DTableDataSelectionType {\n\t\treturn this._type;\n\t}\n\n\tprotected getFirst(): NODE | null {\n\t\tconst rows = this._rows;\n\t\tif( 0 < rows.size ) {\n\t\t\tlet result: NODE | null = null;\n\t\t\trows.forEach(( row: NODE ): void => {\n\t\t\t\tif( result == null ) {\n\t\t\t\t\tresult = row;\n\t\t\t\t}\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getLast(): NODE | null {\n\t\tconst rows = this._rows;\n\t\tif( 0 < rows.size ) {\n\t\t\tlet result: NODE | null = null;\n\t\t\trows.forEach(( row: NODE ): void => {\n\t\t\t\tresult = row;\n\t\t\t});\n\t\t\treturn result;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected toIndex( target: NODE ): number | null {\n\t\tlet result: number | null = null;\n\t\tthis._parent.each(( row: NODE, index: number ): boolean => {\n\t\t\tif( target === row ) {\n\t\t\t\tresult = index;\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t});\n\t\treturn result;\n\t}\n\n\tget first(): number | null {\n\t\tconst row = this.getFirst();\n\t\tif( row ) {\n\t\t\treturn this.toIndex( row );\n\t\t}\n\t\treturn null;\n\t}\n\n\tget last(): number | null {\n\t\tconst row = this.getLast();\n\t\tif( row ) {\n\t\t\treturn this.toIndex( row );\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected onChange(): void {\n\t\tthis._parent.update();\n\t\tthis.emit( \"change\", this );\n\t}\n\n\ttoggle( rowIndex: number ): void {\n\t\tconst row = this._parent.get( rowIndex );\n\t\tif( row ) {\n\t\t\tconst rows = this._rows;\n\t\t\tif( rows.has( row ) ) {\n\t\t\t\trows.delete( row );\n\t\t\t} else {\n\t\t\t\trows.add( row );\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tadd( rowIndex: number ): void {\n\t\tconst row = this._parent.get( rowIndex );\n\t\tif( row ) {\n\t\t\tconst rows = this._rows;\n\t\t\tif( ! rows.has( row ) ) {\n\t\t\t\trows.add( row );\n\t\t\t\tthis.onChange();\n\t\t\t}\n\t\t}\n\t}\n\n\taddTo( rowIndex: number ): void {\n\t\tconst lastRowIndex = this.last;\n\t\tif( lastRowIndex != null ) {\n\t\t\tthis.addRange( lastRowIndex, false, rowIndex, true );\n\t\t}\n\t}\n\n\taddRange( from: number, includeFrom: boolean, to: number, includeTo: boolean ): void {\n\t\tconst rows = this._rows;\n\t\tconst oldSize = rows.size;\n\t\tconst parent = this._parent;\n\t\tif( from < to ) {\n\t\t\tparent.each(( row: NODE ): void => {\n\t\t\t\trows.add( row );\n\t\t\t}, from + (includeFrom ? 0 : 1), to + (includeTo ? 1 : 0) );\n\t\t} else {\n\t\t\tparent.each(( row: NODE ): void => {\n\t\t\t\trows.add( row );\n\t\t\t}, to + (includeTo ? 0 : 1), from + (includeFrom ? 1 : 0) );\n\t\t}\n\t\tconst newSize = rows.size;\n\t\tif( oldSize !== newSize ) {\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\taddAll( rowIndices: number[] ): void {\n\t\tif( 0 < rowIndices.length ) {\n\t\t\tconst rows = this._rows;\n\t\t\tconst parent = this._parent;\n\t\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\t\tconst row = parent.get( rowIndices[ i ] );\n\t\t\t\tif( row ) {\n\t\t\t\t\trows.add( row );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tcontains( rowIndex: number ): boolean {\n\t\tconst row = this._parent.get( rowIndex );\n\t\tif( row ) {\n\t\t\treturn this._rows.has( row );\n\t\t}\n\t\treturn false;\n\t}\n\n\tremove( rowIndex: number ): void {\n\t\tconst row = this._parent.get( rowIndex );\n\t\tif( row ) {\n\t\t\tconst rows = this._rows;\n\t\t\tif( rows.has( row ) ) {\n\t\t\t\trows.delete( row );\n\t\t\t\tthis.onChange();\n\t\t\t}\n\t\t}\n\t}\n\n\tclear(): void {\n\t\tconst rows = this._rows;\n\t\tif( 0 < rows.size ) {\n\t\t\trows.clear();\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tclearAndAdd( rowIndex: number ): void {\n\t\tconst row = this._parent.get( rowIndex );\n\t\tif( row ) {\n\t\t\tconst rows = this._rows;\n\t\t\tif( rows.has( row ) ) {\n\t\t\t\tif( 1 < rows.size ) {\n\t\t\t\t\trows.clear();\n\t\t\t\t\trows.add( row );\n\t\t\t\t\tthis.onChange();\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\trows.clear();\n\t\t\t\trows.add( row );\n\t\t\t\tthis.onChange();\n\t\t\t}\n\t\t}\n\t}\n\n\tclearAndAddAll( rowIndices: number[] ): void {\n\t\tconst rows = this._rows;\n\t\tif( 0 < rows.size || 0 < rowIndices.length ) {\n\t\t\trows.clear();\n\t\t\tconst parent = this._parent;\n\t\t\tfor( let i = 0, imax = rowIndices.length; i < imax; ++i ) {\n\t\t\t\tconst row = parent.get( rowIndices[ i ] );\n\t\t\t\tif( row ) {\n\t\t\t\t\trows.add( row );\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.onChange();\n\t\t}\n\t}\n\n\tshift( rowIndex: number, amount: number ): void {\n\t\t// DO NOTHING\n\t}\n\n\tsize(): number {\n\t\treturn this._rows.size;\n\t}\n\n\tisEmpty(): boolean {\n\t\treturn this._rows.size <= 0;\n\t}\n\n\ttoArray(): Array<[number, NODE]> {\n\t\tconst rows = this._rows;\n\t\tconst result: Array<[ number, NODE ]> = [];\n\t\tthis._parent.each(( row: NODE, index: number ): void => {\n\t\t\tif( rows.has( row ) ) {\n\t\t\t\tresult.push([ index, row ]);\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\ttoSortedArray(): Array<[number, NODE]> {\n\t\treturn this.toArray().sort( COMPARATOR );\n\t}\n\n\ttoObject(): { [index: number]: NODE; } {\n\t\tconst rows = this._rows;\n\t\tconst result: {[index: number]: NODE} = {};\n\t\tthis._parent.each(( row: NODE, index: number ): void => {\n\t\t\tif( rows.has( row ) ) {\n\t\t\t\tresult[ index ] = row;\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n\n\ttoMap(): Map<number, NODE> {\n\t\tconst rows = this._rows;\n\t\tconst result = new Map<number, NODE>();\n\t\tthis._parent.each(( row: NODE, index: number ): void => {\n\t\t\tif( rows.has( row ) ) {\n\t\t\t\tresult.set( index, row );\n\t\t\t}\n\t\t});\n\t\treturn result;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport {\n\tDTableDataComparatorFunction, DTableDataComparatorObject,\n\tDTableDataOrder, DTableDataSorter\n} from \"./d-table-data-sorter\";\n\nexport class DTableDataTreeSorter<NODE> extends utils.EventEmitter implements DTableDataSorter<NODE> {\n\tconstructor() {\n\t\tsuper();\n\t}\n\n\tget id(): number {\n\t\treturn 0;\n\t}\n\n\tget order(): DTableDataOrder {\n\t\treturn DTableDataOrder.ASCENDING;\n\t}\n\n\tset order( order: DTableDataOrder ) {\n\t\t// DO NOTHING\n\t}\n\n\tapply(): void {\n\t\t// DO NOTHING\n\t}\n\n\tunapply(): void {\n\t\t// DO NOTHING\n\t}\n\n\tisApplied(): boolean {\n\t\treturn false;\n\t}\n\n\tget(): DTableDataComparatorFunction<NODE> | DTableDataComparatorObject<NODE> | null {\n\t\treturn null;\n\t}\n\n\tset( comparator: DTableDataComparatorFunction<NODE> | DTableDataComparatorObject<NODE> | null ): void {\n\t\t// DO NOTHING\n\t}\n\n\ttoDirty(): void {\n\t\t// DO NOTHING\n\t}\n\n\tupdate(): void {\n\t\t// DO NOTHING\n\t}\n\n\tget indices(): number[] | null {\n\t\treturn null;\n\t}\n\n\tmap( unmappedIndex: number ): number | null {\n\t\treturn unmappedIndex;\n\t}\n\n\tunmap( index: number ): number {\n\t\treturn index;\n\t}\n}\n","/*\n * Copyright (C) 2021 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { utils } from \"pixi.js\";\nimport { DTableData, DTableDataMapped, DTableDataParent } from \"./d-table-data\";\nimport { DTableDataFilter, DTableDataFilterFunction, DTableDataFilterObject } from \"./d-table-data-filter\";\nimport { DTableDataTreeFilter } from \"./d-table-data-tree-filter\";\nimport { DTableDataListMapped } from \"./d-table-data-list-mapped\";\nimport { DTableDataSelection } from \"./d-table-data-selection\";\nimport { DTableDataComparatorFunction, DTableDataComparatorObject, DTableDataSorter } from \"./d-table-data-sorter\";\nimport { DTableDataTreeSorter } from \"./d-table-data-tree-sorter\";\nimport { DTableDataTreeItem } from \"./d-table-data-tree-item\";\nimport { DTableDataTreeItemAccessor, DTableDataTreeItemAccessorOptions } from \"./d-table-data-tree-item-accessor\";\nimport { DTableDataTreeSelection, DTableDataTreeSelectionCreator, DTableDataTreeSelectionOptions } from \"./d-table-data-tree-selection\";\nimport { DTableDataTreeSelectionImpl } from \"./d-table-data-tree-selection-impl\";\nimport { isFunction } from \"./util/is-function\";\nimport { DBaseOnOptions } from \"./d-base\";\n\nexport interface DTableDataTreeOptions<NODE, EMITTER = any> extends DTableDataTreeItemAccessorOptions<NODE> {\n\tnodes?: NODE[];\n\n\t/**\n\t * Selection options.\n\t */\n\tselection?: DTableDataTreeSelection<NODE> | DTableDataTreeSelectionCreator<NODE> | DTableDataTreeSelectionOptions;\n\n\t/**\n\t * A filter.\n\t */\n\tfilter?: DTableDataFilterFunction<NODE> | DTableDataFilterObject<NODE>;\n\n\t/**\n\t * A comparator.\n\t */\n\tcomparator?: DTableDataComparatorFunction<NODE> | DTableDataComparatorObject<NODE>;\n\n\t/**\n\t * Mappings of event names and event handlers.\n\t */\n\ton?: DBaseOnOptions<EMITTER>;\n}\n\n/**\n * Please note that this data class does not support the sorter.\n */\nexport class DTableDataTree<NODE extends DTableDataTreeItem<NODE, NODE>> extends utils.EventEmitter\n\timplements DTableData<NODE> {\n\tprotected _parent: DTableDataParent | null;\n\tprotected _nodes?: NODE[];\n\tprotected _rows: NODE[];\n\tprotected _isRowsDirty: boolean;\n\tprotected _supplimentals: number[];\n\tprotected _flags: WeakMap<NODE, number>;\n\tprotected _filter: DTableDataTreeFilter<NODE>;\n\tprotected _sorter: DTableDataTreeSorter<NODE>;\n\tprotected _selection: DTableDataTreeSelection<NODE>;\n\tprotected _mapped: DTableDataMapped<NODE>;\n\tprotected _accessor: DTableDataTreeItemAccessor<NODE>;\n\n\tconstructor( options?: DTableDataTreeOptions<NODE> ) {\n\t\tsuper();\n\n\t\tthis._parent = null;\n\t\tthis._accessor = this.toAccessor( options );\n\t\tthis._mapped = new DTableDataListMapped<NODE>( this );\n\t\tthis._rows = [];\n\t\tthis._isRowsDirty = false;\n\t\tthis._supplimentals = [];\n\t\tthis._flags = new WeakMap<NODE, number>();\n\t\tthis._selection = this.toSelection( options?.selection );\n\t\tthis._filter = new DTableDataTreeFilter<NODE>( this );\n\t\tthis._sorter = new DTableDataTreeSorter<NODE>();\n\n\t\tif( options ) {\n\t\t\t// Filter\n\t\t\tconst filter = options.filter;\n\t\t\tif( filter ) {\n\t\t\t\tthis._filter.set( filter );\n\t\t\t}\n\n\t\t\t// Events\n\t\t\tconst on = options.on;\n\t\t\tif( on ) {\n\t\t\t\tfor( const name in on ) {\n\t\t\t\t\tconst handler = on[ name ];\n\t\t\t\t\tif( handler ) {\n\t\t\t\t\t\tthis.on( name, handler );\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Update rows\n\t\tthis.nodes = options?.nodes;\n\t}\n\n\tprotected toSelection(\n\t\toptions?: DTableDataTreeSelection<NODE> | DTableDataTreeSelectionCreator<NODE> | DTableDataTreeSelectionOptions\n\t): DTableDataTreeSelection<NODE> {\n\t\tif( options instanceof utils.EventEmitter ) {\n\t\t\treturn options;\n\t\t} else if( isFunction( options ) ) {\n\t\t\treturn options( this );\n\t\t}\n\t\treturn this.newSelection( options );\n\t}\n\n\tprotected newSelection( options?: DTableDataTreeSelectionOptions ): DTableDataTreeSelection<NODE> {\n\t\treturn new DTableDataTreeSelectionImpl( this, options );\n\t}\n\n\tprotected toAccessor( options?: DTableDataTreeOptions<NODE> ): DTableDataTreeItemAccessor<NODE> {\n\t\treturn new DTableDataTreeItemAccessor( options );\n\t}\n\n\tbind( parent: DTableDataParent ): void {\n\t\tthis._parent = parent;\n\t}\n\n\tget nodes(): NODE[] | undefined {\n\t\treturn this._nodes;\n\t}\n\n\tset nodes( nodes: NODE[] | undefined ) {\n\t\tthis._nodes = nodes;\n\t\tthis._isRowsDirty = true;\n\t\tthis._selection.onNodeChange( nodes );\n\t\tthis._filter.toDirty();\n\t\tthis.update( true );\n\t}\n\n\tget rows(): NODE[] {\n\t\tif( this._isRowsDirty ) {\n\t\t\tthis._isRowsDirty = false;\n\t\t\tthis.updateRows( this._nodes );\n\t\t}\n\t\treturn this._rows;\n\t}\n\n\tget supplimentals(): number[] {\n\t\treturn this._supplimentals;\n\t}\n\n\tget accessor(): DTableDataTreeItemAccessor<NODE> {\n\t\treturn this._accessor;\n\t}\n\n\tprotected updateRows( nodes: NODE[] | undefined ): void {\n\t\tconst rows = this._rows;\n\t\tconst supplimentals = this._supplimentals;\n\t\tconst flags = this._flags;\n\t\tif( nodes != null ) {\n\t\t\tconst irows = this.newRows( nodes, 0, 0, rows, supplimentals, flags );\n\t\t\tif( irows !== rows.length ) {\n\t\t\t\trows.length = irows;\n\t\t\t\tsupplimentals.length = irows;\n\t\t\t}\n\t\t} else {\n\t\t\trows.length = 0;\n\t\t\tsupplimentals.length = 0;\n\t\t}\n\t}\n\n\tprotected toSupplimental( ilevel: number, hasChildren: boolean, isOpened: boolean ) {\n\t\treturn (ilevel << 2) | (hasChildren ? 2 : 0) | (isOpened ? 1 : 0);\n\t}\n\n\tprotected newRows(\n\t\tnodes: NODE[],\n\t\tirows: number,\n\t\tilevel: number,\n\t\trows: NODE[],\n\t\tsupplimentals: number[],\n\t\tflags: WeakMap<NODE, number>\n\t): number {\n\t\tconst toChildren = this._accessor.toChildren;\n\t\tfor( let i = 0, imax = nodes.length; i < imax; ++i ) {\n\t\t\tconst node = nodes[ i ];\n\t\t\tconst children = toChildren( node );\n\t\t\tconst isOpened = flags.has( node );\n\t\t\tconst supplimental = this.toSupplimental( ilevel, !! (children && 0 < children.length), isOpened );\n\t\t\tif( irows < rows.length ) {\n\t\t\t\trows[ irows ] = node;\n\t\t\t\tsupplimentals[ irows ] = supplimental;\n\t\t\t} else {\n\t\t\t\trows.push( node );\n\t\t\t\tsupplimentals.push( supplimental );\n\t\t\t}\n\t\t\tirows += 1;\n\n\t\t\tif( isOpened && children ) {\n\t\t\t\tirows = this.newRows( children, irows, ilevel + 1, rows, supplimentals, flags );\n\t\t\t}\n\t\t}\n\t\treturn irows;\n\t}\n\n\tupdate( forcibly?: boolean ): void {\n\t\tconst parent = this._parent;\n\t\tif( parent ) {\n\t\t\tparent.update( forcibly );\n\t\t}\n\t}\n\n\tsize(): number {\n\t\treturn this.rows.length;\n\t}\n\n\tget( index: number ): NODE | null {\n\t\tconst rows = this.rows;\n\t\tif( 0 <= index && index < rows.length ) {\n\t\t\treturn rows[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\topen( node: NODE ): void {\n\t\tconst flags = this._flags;\n\t\tif( ! flags.has( node ) ) {\n\t\t\tflags.set( node, 1 );\n\t\t\tthis._isRowsDirty = true;\n\t\t\tthis._filter.toDirty();\n\t\t\tthis.update( true );\n\t\t}\n\t}\n\n\tclose( node: NODE ): void {\n\t\tconst flags = this._flags;\n\t\tif( flags.has( node ) ) {\n\t\t\tflags.delete( node );\n\t\t\tthis._isRowsDirty = true;\n\t\t\tthis._filter.toDirty();\n\t\t\tthis.update( true );\n\t\t}\n\t}\n\n\tisOpened( node: NODE ): boolean {\n\t\treturn this._flags.has( node );\n\t}\n\n\ttoggle( node: NODE ): void {\n\t\tconst flags = this._flags;\n\t\tif( flags.has( node ) ) {\n\t\t\tflags.delete( node );\n\t\t} else {\n\t\t\tflags.set( node, 1 );\n\t\t}\n\t\tthis._isRowsDirty = true;\n\t\tthis._filter.toDirty();\n\t\tthis.update( true );\n\t}\n\n\teach( iteratee: ( node: NODE, index: number ) => boolean | void, ifrom?: number, ito?: number ): void {\n\t\tconst rows = this.rows;\n\t\tifrom = ( ifrom != null ? Math.max( 0, ifrom ) : 0 );\n\t\tito = ( ito != null ? Math.min( rows.length, ito ) : rows.length );\n\t\tfor( let i = ifrom; i < ito; ++i ) {\n\t\t\tconst row = rows[ i ];\n\t\t\tif( iteratee( row, i ) === false ) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\n\tget selection(): DTableDataSelection<NODE> {\n\t\treturn this._selection;\n\t}\n\n\tget filter(): DTableDataFilter<NODE> {\n\t\treturn this._filter;\n\t}\n\n\tget sorter(): DTableDataSorter<NODE> {\n\t\treturn this._sorter;\n\t}\n\n\tget mapped(): DTableDataMapped<NODE> {\n\t\treturn this._mapped;\n\t}\n}\n","import { DTableColumn } from \"./d-table-column\";\nimport { DTableHeaderTable } from \"./d-table-header\";\nimport { DTableHeaderCellHeader } from \"./d-table-header-cell\";\n\nexport interface DTableHeaderCellCheckOptions {\n\tenable?: boolean;\n\tfilterable?: boolean;\n\temittable?: boolean;\n}\n\nexport interface DTableHeaderCellCheckParent<ROW> {\n\treadonly column?: DTableColumn<ROW, unknown>;\n\treadonly columnIndex?: number;\n\treadonly header?: DTableHeaderCellHeader<ROW>;\n}\n\nexport class DTableHeaderCellCheck<ROW> {\n\tprotected _parent: DTableHeaderCellCheckParent<ROW>;\n\tprotected _isEnabled: boolean;\n\tprotected _isFilterable: boolean;\n\tprotected _isEmittable: boolean;\n\n\tconstructor( parent: DTableHeaderCellCheckParent<ROW>, options?: DTableHeaderCellCheckOptions ) {\n\t\tthis._parent = parent;\n\t\tthis._isEnabled = options?.enable ?? false;\n\t\tthis._isFilterable = options?.filterable ?? true;\n\t\tthis._isEmittable = options?.emittable ?? true;\n\t}\n\n\tget isEnabled(): boolean {\n\t\treturn this._isEnabled;\n\t}\n\n\tget isFilterable(): boolean {\n\t\treturn this._isFilterable;\n\t}\n\n\tset isFilterable( isFilterable: boolean ) {\n\t\tthis._isFilterable = isFilterable;\n\t}\n\n\tget isEmittable(): boolean {\n\t\treturn this._isEmittable;\n\t}\n\n\tset isEmittable( isEmittable: boolean ) {\n\t\tthis._isEmittable = isEmittable;\n\t}\n\n\tprotected newIteratee(\n\t\ttable: DTableHeaderTable<ROW>,\n\t\tisChecked: boolean\n\t): (( row: ROW, rowIndex: number ) => boolean) | null {\n\t\tconst parent = this._parent;\n\t\tconst column = parent.column;\n\t\tconst columnIndex = parent.columnIndex;\n\t\tif( column != null && columnIndex != null ) {\n\t\t\tconst getter = column.getter;\n\t\t\tconst setter = column.setter;\n\t\t\tif( this._isEmittable ) {\n\t\t\t\tconst data = table.data;\n\t\t\t\treturn ( row: ROW, rowIndex: number ): boolean => {\n\t\t\t\t\tif( getter( row, columnIndex ) !== isChecked ) {\n\t\t\t\t\t\tsetter( row, columnIndex, isChecked );\n\t\t\t\t\t\tdata.emit( \"change\", isChecked, ! isChecked, row, rowIndex, columnIndex, data );\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\treturn ( row: ROW ): boolean => {\n\t\t\t\t\tif( getter( row, columnIndex ) !== isChecked ) {\n\t\t\t\t\t\tsetter( row, columnIndex, isChecked );\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t}\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn null;\n\t}\n\n\tpublic execute( isChecked: boolean ) {\n\t\tconst table = this._parent.header?.table;\n\t\tif( table ) {\n\t\t\tconst iteratee = this.newIteratee( table, isChecked );\n\t\t\tif( iteratee ) {\n\t\t\t\tlet isChanged = false;\n\t\t\t\tif( this._isFilterable ) {\n\t\t\t\t\ttable.data.mapped.each(( row: ROW, supplimental: unknown, index: number, unmappedIndex: number ): void => {\n\t\t\t\t\t\tif( iteratee( row, unmappedIndex ) ) {\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\ttable.data.each(( row: ROW, index: number ): void => {\n\t\t\t\t\t\tif( iteratee( row, index ) ) {\n\t\t\t\t\t\t\tisChanged = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\tif( isChanged ) {\n\t\t\t\t\ttable.body.update( true );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Point } from \"pixi.js\";\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\nimport { DTableState } from \"./d-table-state\";\nimport { DTableColumn } from \"./d-table-column\";\nimport {\n\tDTableDataComparatorFunction, DTableDataComparatorObject,\n\tDTableDataOrder, DTableDataSorter\n} from \"./d-table-data-sorter\";\nimport { DTableHeaderTable } from \"./d-table-header\";\nimport { DTableHeaderCellCheck, DTableHeaderCellCheckOptions } from \"./d-table-header-cell-check\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTableHeaderCellHeader<ROW> {\n\treadonly table: DTableHeaderTable<ROW> | null;\n}\n\nexport interface DTableHeaderCellOptions<\n\tROW,\n\tTHEME extends DThemeTableHeaderCell = DThemeTableHeaderCell\n> extends DImageOptions<string | null, THEME> {\n\theader?: DTableHeaderCellHeader<ROW>;\n\tcolumn?: DTableColumn<ROW, unknown>;\n\tcolumnIndex?: number;\n\tcheck?: DTableHeaderCellCheckOptions;\n}\n\nexport interface DThemeTableHeaderCell extends DThemeImage<string | null> {\n\n}\n\nexport class DTableHeaderCell<\n\tROW,\n\tTHEME extends DThemeTableHeaderCell = DThemeTableHeaderCell,\n\tOPTIONS extends DTableHeaderCellOptions<ROW, THEME> = DTableHeaderCellOptions<ROW, THEME>\n> extends DImage<string | null, THEME, OPTIONS> {\n\tprotected _sorter?: DTableDataSorter<ROW>;\n\tprotected _onSorterChangeBound?: () => void;\n\tprotected _header?: DTableHeaderCellHeader<ROW>;\n\tprotected _column?: DTableColumn<ROW, unknown>;\n\tprotected _columnIndex?: number;\n\tprotected _check!: DTableHeaderCellCheck<ROW>;\n\tprotected _checkWork?: Point;\n\n\tprotected init( options?: OPTIONS ) {\n\t\tif( options != null ) {\n\t\t\tthis._header = options.header;\n\t\t\tthis._column = options.column;\n\t\t\tthis._columnIndex = options.columnIndex;\n\t\t\tthis._check = new DTableHeaderCellCheck<ROW>( this, options.check );\n\t\t} else {\n\t\t\tthis._check = new DTableHeaderCellCheck<ROW>( this );\n\t\t}\n\t\tsuper.init( options );\n\t\tthis.initOnClick( options );\n\t}\n\n\tget column(): DTableColumn<ROW, unknown> | undefined {\n\t\treturn this._column;\n\t}\n\n\tget columnIndex(): number | undefined {\n\t\treturn this._columnIndex;\n\t}\n\n\tget header(): DTableHeaderCellHeader<ROW> | undefined {\n\t\treturn this._header;\n\t}\n\n\tget check(): DTableHeaderCellCheck<ROW> {\n\t\treturn this._check;\n\t}\n\n\tprotected initOnClick( options?: OPTIONS ): void {\n\t\tconst column = this._column;\n\t\tif( column ) {\n\t\t\tconst sortable = column.sorting.enable;\n\t\t\tconst checkable = this._check.isEnabled;\n\t\t\tif( checkable || sortable ) {\n\t\t\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\t\t\tthis.onClick( e );\n\t\t\t\t});\n\t\t\t\tconst state = this.state;\n\t\t\t\tstate.lock();\n\t\t\t\tstate.set( DTableState.SORTABLE, sortable );\n\t\t\t\tstate.set( DTableState.CHECKABLE, checkable );\n\t\t\t\tstate.unlock();\n\t\t\t}\n\t\t}\n\t}\n\n\tget sorter(): DTableDataSorter<ROW> | null {\n\t\tlet sorter = this._sorter;\n\t\tif( sorter == null ) {\n\t\t\tconst header = this._header;\n\t\t\tif( header ) {\n\t\t\t\tconst table = header.table;\n\t\t\t\tif( table ) {\n\t\t\t\t\tsorter = table.data.sorter;\n\t\t\t\t\tthis._sorter = sorter;\n\t\t\t\t\tthis._onSorterChangeBound = this._onSorterChangeBound || (() => {\n\t\t\t\t\t\tthis.onSorterChange();\n\t\t\t\t\t});\n\t\t\t\t\tsorter.on( \"change\", this._onSorterChangeBound );\n\t\t\t\t} else {\n\t\t\t\t\treturn null;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\t\t}\n\t\treturn sorter;\n\t}\n\n\tget comparator(): DTableDataComparatorFunction<ROW> | DTableDataComparatorObject<ROW> | null {\n\t\tconst column = this._column;\n\t\tif( column ) {\n\t\t\treturn column.sorting.comparator || null;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected onSorterChange(): void {\n\t\tconst comparator = this.comparator;\n\t\tif( comparator ) {\n\t\t\tconst sorter = this._sorter;\n\t\t\tif( sorter ) {\n\t\t\t\tconst SORTED_ASCENDING = DTableState.SORTED_ASCENDING;\n\t\t\t\tconst SORTED_DESCENDING = DTableState.SORTED_DESCENDING;\n\t\t\t\tif( sorter.isApplied() && sorter.get() === comparator ) {\n\t\t\t\t\tif( sorter.order === DTableDataOrder.ASCENDING ) {\n\t\t\t\t\t\tthis.state.set( SORTED_ASCENDING, SORTED_DESCENDING );\n\t\t\t\t\t} else {\n\t\t\t\t\t\tthis.state.set( SORTED_DESCENDING, SORTED_ASCENDING );\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tthis.state.removeAll( SORTED_ASCENDING, SORTED_DESCENDING );\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toClickPosition( e: interaction.InteractionEvent ): number {\n\t\tconst checkWork = ( this._checkWork || new Point() );\n\t\tthis._checkWork = checkWork;\n\t\treturn e.data.getLocalPosition( this, checkWork ).x;\n\t}\n\n\tprotected isCheckClicked( e: interaction.InteractionEvent ): boolean {\n\t\tif( this._check.isEnabled ) {\n\t\t\tif( this.isSortable ) {\n\t\t\t\tconst image = this._images[ 1 ];\n\t\t\t\tif( image && image.image != null ) {\n\t\t\t\t\tconst position = this.toClickPosition( e );\n\t\t\t\t\tconst bound = image.bound;\n\t\t\t\t\tconst margin = image.margin.horizontal;\n\t\t\t\t\treturn ( bound.left - margin <= position && position <= bound.right + margin );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tonClick( e: interaction.InteractionEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isCheckClicked( e ) ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t\tthis.onToggleEnd();\n\t\t\t} else {\n\t\t\t\tthis.onActivate( e );\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onActivate( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tthis.doSort( e );\n\t\tthis.emit( \"active\", this );\n\t}\n\n\tprotected doSort( e?: interaction.InteractionEvent | KeyboardEvent | MouseEvent | TouchEvent ): void {\n\t\tif( this.isSortable ) {\n\t\t\tconst comparator = this.comparator;\n\t\t\tif( comparator ) {\n\t\t\t\tconst sorter = this.sorter;\n\t\t\t\tif( sorter ) {\n\t\t\t\t\tif( sorter.get() === comparator ) {\n\t\t\t\t\t\tif( sorter.order === DTableDataOrder.ASCENDING ) {\n\t\t\t\t\t\t\tsorter.order = DTableDataOrder.DESCENDING;\n\t\t\t\t\t\t\tsorter.apply();\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsorter.set( null );\n\t\t\t\t\t\t\tsorter.apply();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsorter.set( comparator );\n\t\t\t\t\t\tsorter.order = DTableDataOrder.ASCENDING;\n\t\t\t\t\t\tsorter.apply();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tget isSortable(): boolean {\n\t\tconst column = this._column;\n\t\tif( column ) {\n\t\t\treturn column.sorting.enable;\n\t\t}\n\t\treturn false;\n\t}\n\n\tget isToggle(): boolean {\n\t\treturn this._check.isEnabled;\n\t}\n\n\ttoggle(): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isToggle ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t\tthis.onToggleEnd();\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onToggleStart(): void {\n\t\tthis.state.isActive = ! this.state.isActive;\n\t}\n\n\tprotected onToggleEnd(): void {\n\t\tif( this.state.isActive ) {\n\t\t\tthis._check.execute( true );\n\t\t\tthis.emit( \"active\", this );\n\t\t} else {\n\t\t\tthis._check.execute( false );\n\t\t\tthis.emit( \"inactive\", this );\n\t\t}\n\t}\n\n\tprotected onActivateKeyDown( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isToggle ) {\n\t\t\t\tthis.onToggleStart();\n\t\t\t} else {\n\t\t\t\tthis.state.isPressed = true;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected onActivateKeyUp( e: KeyboardEvent ): void {\n\t\tif( this.state.isActionable ) {\n\t\t\tif( this.isToggle ) {\n\t\t\t\tthis.onToggleEnd();\n\t\t\t} else {\n\t\t\t\tif( this.state.isPressed ) {\n\t\t\t\t\tthis.onActivate( e );\n\t\t\t\t}\n\t\t\t\tthis.state.isPressed = false;\n\t\t\t}\n\t\t}\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyDown( e );\n\t\t}\n\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tonKeyUp( e: KeyboardEvent ): boolean {\n\t\tif( UtilKeyboardEvent.isActivateKey( e ) ) {\n\t\t\tthis.onActivateKeyUp( e );\n\t\t}\n\n\t\treturn super.onKeyUp( e );\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableHeaderCell\";\n\t}\n\n\tdestroy(): void {\n\t\tconst sorter = this._sorter;\n\t\tconst onSorterChangeBound = this._onSorterChangeBound;\n\t\tif( sorter && onSorterChangeBound ) {\n\t\t\tsorter.off( \"change\", onSorterChangeBound );\n\t\t}\n\t\tthis._sorter = undefined;\n\t\tthis._onSorterChangeBound = undefined;\n\n\t\tsuper.destroy();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DBase } from \"./d-base\";\nimport { DTableColumn } from \"./d-table-column\";\nimport { DTableData } from \"./d-table-data\";\nimport { DTableHeaderCell, DTableHeaderCellOptions } from \"./d-table-header-cell\";\nimport { DTableRow, DTableRowOptions, DThemeTableRow } from \"./d-table-row\";\n\nexport interface DTableHeaderTableBody {\n\tupdate( forcibly?: boolean ): void;\n}\n\nexport interface DTableHeaderTable<ROW> {\n\treadonly data: DTableData<ROW>;\n\treadonly body: DTableHeaderTableBody;\n}\n\nexport interface DTableHeaderOptions<\n\tROW,\n\tTHEME extends DThemeTableHeader = DThemeTableHeader\n> extends DTableRowOptions<ROW, DTableColumn<ROW, unknown>, THEME> {\n\ttable?: DTableHeaderTable<ROW>;\n\toffset?: number;\n\tcell?: DTableHeaderCellOptions<ROW>;\n}\n\nexport interface DThemeTableHeader extends DThemeTableRow {\n\n}\n\nexport class DTableHeader<\n\tROW,\n\tTHEME extends DThemeTableHeader = DThemeTableHeader,\n\tOPTIONS extends DTableHeaderOptions<ROW, THEME> = DTableHeaderOptions<ROW, THEME>\n> extends DTableRow<ROW, DTableColumn<ROW, unknown>, THEME, OPTIONS> {\n\tprotected _table: DTableHeaderTable<ROW> | null;\n\tprotected _offset: number;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\n\t\tthis._table = options.table ?? null;\n\n\t\tconst offset = options.offset ?? 0;\n\t\tthis._offset = offset;\n\t\tthis.transform.position.y = offset;\n\n\t\tthis.initCells( options, this._columns, this._frozen );\n\t}\n\n\tget table(): DTableHeaderTable<ROW> | null {\n\t\treturn this._table;\n\t}\n\n\tprotected onParentMove( newX: number, newY: number, oldX: number, oldY: number ): void {\n\t\tsuper.onParentMove( newX, newY, oldX, oldY );\n\t\tthis.transform.position.y = -newY + this._offset;\n\t\tthis.updateFrozenCellPosition( newX );\n\t}\n\n\tprotected getContentPositionX(): number {\n\t\tconst content = this.parent;\n\t\tif( content ) {\n\t\t\treturn content.position.x;\n\t\t}\n\t\treturn 0;\n\t}\n\n\tprotected newCell(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, unknown>,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\toptions: OPTIONS\n\t): DBase {\n\t\treturn new DTableHeaderCell<ROW>( this.toCellOptions( columnIndex, column, options ) );\n\t}\n\n\tprotected toCellOptions(\n\t\tcolumnIndex: number,\n\t\tcolumn: DTableColumn<ROW, unknown>,\n\t\toptions: OPTIONS\n\t): DTableHeaderCellOptions<ROW> {\n\t\tconst result = column.header || options.cell;\n\t\tif( result != null ) {\n\t\t\tif( result.weight === undefined ) {\n\t\t\t\tresult.weight = column.weight;\n\t\t\t}\n\t\t\tif( result.width === undefined ) {\n\t\t\t\tresult.width = column.width;\n\t\t\t}\n\t\t\tif( result.text === undefined ) {\n\t\t\t\tresult.text = {\n\t\t\t\t\tvalue: column.label\n\t\t\t\t};\n\t\t\t} else if( result.text.value === undefined ) {\n\t\t\t\tresult.text.value = column.label;\n\t\t\t}\n\t\t\tif( result.header === undefined ) {\n\t\t\t\tresult.header = this;\n\t\t\t}\n\t\t\tif( result.column === undefined ) {\n\t\t\t\tresult.column = column;\n\t\t\t}\n\t\t\tif( result.columnIndex === undefined ) {\n\t\t\t\tresult.columnIndex = columnIndex;\n\t\t\t}\n\t\t\treturn result;\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tweight: column.weight,\n\t\t\t\twidth: column.width,\n\t\t\t\ttext: {\n\t\t\t\t\tvalue: column.label\n\t\t\t\t},\n\t\t\t\theader: this,\n\t\t\t\tcolumn,\n\t\t\t\tcolumnIndex\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTableHeader\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { interaction, Rectangle } from \"pixi.js\";\nimport { DDialogSelectOptions } from \"../ui/d-dialog-select\";\nimport { DAlignHorizontal } from \"./d-align-horizontal\";\nimport { DApplications } from \"./d-applications\";\nimport { DBase, DBaseOptions } from \"./d-base\";\nimport { DContentOptions } from \"./d-content\";\nimport { DFocusable, DFocusableContainer } from \"./d-controller-focus\";\nimport { DCoordinateSize } from \"./d-coordinate\";\nimport { DDialogSelect } from \"./d-dialog-select\";\nimport { DMenu, DMenuOptions } from \"./d-menu\";\nimport { DPane, DPaneOptions, DThemePane } from \"./d-pane\";\nimport { DTableBody, DTableBodyOptions } from \"./d-table-body\";\nimport { DTableCategory, DTableCategoryColumn, DTableCategoryOptions } from \"./d-table-category\";\nimport {\n\tDTableColumn, DTableColumnEditing, DTableColumnOptions,\n\tDTableColumnSelecting, DTableColumnSelectingDialog, DTableColumnSelectingOptions, DTableColumnSorting,\n\tDTableColumnType, DTableEditable, DTableGetter, DTableRenderable, DTableSetter\n} from \"./d-table-column\";\nimport { DTableData, DTableDataOptions } from \"./d-table-data\";\nimport { DTableDataList, DTableDataListOptions } from \"./d-table-data-list\";\nimport { DTableDataSelectionType } from \"./d-table-data-selection\";\nimport { DTableDataComparatorFunction } from \"./d-table-data-sorter\";\nimport { DTableHeader, DTableHeaderOptions } from \"./d-table-header\";\nimport { DTableRow } from \"./d-table-row\";\nimport { isArray } from \"./util/is-array\";\nimport { isString } from \"./util/is-string\";\nimport { UtilKeyboardEvent } from \"./util/util-keyboard-event\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTableOptions<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTable = DThemeTable,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions\n> extends DPaneOptions<THEME, CONTENT_OPTIONS> {\n\tcolumns: Array<DTableColumnOptions<ROW>>;\n\tcategory?: DTableCategoryOptions;\n\theader?: DTableHeaderOptions<ROW>;\n\tbody?: DTableBodyOptions<ROW, DATA>;\n\tdata?: ROW[] | DTableDataListOptions<ROW> | DATA;\n}\n\nexport interface DThemeTable extends DThemePane {\n\n}\n\nconst defaultGetter = <ROW, CELL>( row: ROW, columnIndex: number ): CELL => {\n\treturn (row as any)[ columnIndex ];\n};\n\nconst defaultSetter = <ROW, CELL>( row: ROW, columnIndex: number, cell: CELL ): void => {\n\t(row as any)[ columnIndex ] = cell;\n};\n\nconst defaultGetterEmpty = <CELL>(): CELL => \"\" as any;\n\nconst defaultSetterEmpty = (): void => {\n\t// DO NOTHING\n};\n\nconst toPathGetter = <ROW, CELL>( path: string[], def?: CELL ): DTableGetter<ROW, CELL> => {\n\tif( path.length <= 1 ) {\n\t\tconst key = path[ 0 ];\n\t\tif( def === undefined ) {\n\t\t\treturn ( row: ROW ): CELL => {\n\t\t\t\treturn (row as any)[ key ];\n\t\t\t};\n\t\t} else {\n\t\t\treturn ( row: ROW ): CELL => {\n\t\t\t\treturn key in row ? (row as any)[ key ] : def;\n\t\t\t};\n\t\t}\n\t} else {\n\t\tif( def === undefined ) {\n\t\t\treturn ( row: ROW ): CELL => {\n\t\t\t\tfor( let i = 0, imax = path.length - 1; i < imax; ++i ) {\n\t\t\t\t\trow = (row as any)[ path[ i ] ];\n\t\t\t\t}\n\t\t\t\treturn (row as any)[ path[ path.length - 1 ] ];\n\t\t\t};\n\t\t} else {\n\t\t\treturn ( row: ROW ): CELL => {\n\t\t\t\tfor( let i = 0, imax = path.length - 1; i < imax; ++i ) {\n\t\t\t\t\trow = (row as any)[ path[ i ] ];\n\t\t\t\t}\n\t\t\t\tconst key = path[ path.length - 1 ];\n\t\t\t\treturn key in row ? (row as any)[ key ] : def;\n\t\t\t};\n\t\t}\n\t}\n};\n\nconst toPathSetter = <ROW, CELL>( path: string[] ): DTableSetter<ROW, CELL> => {\n\tif( path.length <= 1 ) {\n\t\tconst key = path[ 0 ];\n\t\treturn ( row: ROW, columnIndex: number, cell: CELL ): void => {\n\t\t\t(row as any)[ key ] = cell;\n\t\t};\n\t} else {\n\t\treturn ( row: ROW, columnIndex: number, cell: CELL ): void => {\n\t\t\tfor( let i = 0, imax = path.length - 1; i < imax; ++i ) {\n\t\t\t\trow = (row as any)[ path[ i ] ] || {};\n\t\t\t}\n\t\t\t(row as any)[ path[ path.length - 1 ] ] = cell;\n\t\t};\n\t}\n};\n\nconst toColumnAlign = <ROW, CELL>(\n\toptions: DTableColumnOptions<ROW, CELL>,\n\ttype: DTableColumnType\n): DAlignHorizontal => {\n\tif( options.align != null ) {\n\t\tif( isString( options.align ) ) {\n\t\t\treturn DAlignHorizontal[ options.align ];\n\t\t} else {\n\t\t\treturn options.align;\n\t\t}\n\t}\n\tswitch( type ) {\n\tcase DTableColumnType.TEXT:\n\t\treturn DAlignHorizontal.LEFT;\n\tcase DTableColumnType.REAL:\n\tcase DTableColumnType.INTEGER:\n\t\treturn DAlignHorizontal.RIGHT;\n\tcase DTableColumnType.BUTTON:\n\tcase DTableColumnType.INDEX:\n\tcase DTableColumnType.SELECT:\n\tcase DTableColumnType.ACTION:\n\tcase DTableColumnType.LINK:\n\t\treturn DAlignHorizontal.CENTER;\n\tdefault:\n\t\treturn DAlignHorizontal.LEFT;\n\t}\n};\n\nconst toColumnDataChecker = <ROW>( path: string[] | null ): DTableEditable<ROW> => {\n\tif( path != null ) {\n\t\tif( path.length <= 1 ) {\n\t\t\tconst key = path[ 0 ];\n\t\t\treturn ( row: ROW ): boolean => {\n\t\t\t\treturn key in row;\n\t\t\t};\n\t\t} else {\n\t\t\treturn ( row: any ): boolean => {\n\t\t\t\tfor( let i = 0, imax = path.length; i < imax; ++i ) {\n\t\t\t\t\tconst part = path[ i ];\n\t\t\t\t\tif( part in row ) {\n\t\t\t\t\t\trow = row[ part ];\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\treturn true;\n\t\t\t};\n\t\t}\n\t}\n\treturn ( row: any, columnIndex: number ): boolean => {\n\t\treturn columnIndex < row.length;\n\t};\n};\n\nconst toColumnEditingEnable = <ROW>(\n\tenable: boolean | DTableEditable<ROW> | \"auto\" | \"AUTO\" | undefined,\n\tpath: string[] | null\n): boolean | DTableEditable<ROW> => {\n\tif( isString( enable ) ) {\n\t\treturn toColumnDataChecker( path );\n\t} else if( enable != null ) {\n\t\treturn enable;\n\t} else {\n\t\treturn false;\n\t}\n};\n\nconst toColumnEditing = <ROW, CELL>(\n\toptions: DTableColumnOptions<ROW, CELL>,\n\tpath: string[] | null\n): DTableColumnEditing<ROW, CELL> => {\n\tconst editing = options.editing;\n\tif( editing ) {\n\t\treturn {\n\t\t\tenable: toColumnEditingEnable( editing.enable != null ? editing.enable : options.editable, path ),\n\t\t\tformatter: editing.formatter,\n\t\t\tunformatter: editing.unformatter,\n\t\t\tvalidator: editing.validator\n\t\t};\n\t}\n\treturn {\n\t\tenable: toColumnEditingEnable( options.editable, path )\n\t};\n};\n\nconst toComparator = <ROW, CELL>(\n\tgetter: DTableGetter<ROW, CELL>,\n\tindex: number\n): DTableDataComparatorFunction<ROW> => {\n\treturn ( rowA: ROW, rowB: ROW ): number => {\n\t\tconst valueA = getter( rowA, index ) as any;\n\t\tconst valueB = getter( rowB, index ) as any;\n\t\treturn ( valueA < valueB ? -1 : ( valueB < valueA ? +1 : 0 ) );\n\t};\n};\n\nconst toColumnSorting = <ROW, CELL>(\n\tgetter: DTableGetter<ROW, CELL>,\n\tindex: number,\n\toptions: DTableColumnOptions<ROW, CELL>\n): DTableColumnSorting<ROW> => {\n\tconst sorting = options.sorting;\n\tif( sorting ) {\n\t\tconst enable = sorting.enable === true || options.sortable === true;\n\t\tif( enable ) {\n\t\t\treturn {\n\t\t\t\tenable,\n\t\t\t\tcomparator: sorting.comparator || toComparator( getter, index )\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tenable\n\t\t\t};\n\t\t}\n\t}\n\tif( options.sortable === true ) {\n\t\treturn {\n\t\t\tenable: true,\n\t\t\tcomparator: toComparator( getter, index )\n\t\t};\n\t} else {\n\t\treturn {\n\t\t\tenable: false\n\t\t};\n\t}\n};\n\nconst toColumnMenu = ( options?: DMenuOptions<unknown> | DMenu<unknown> ): DMenu<unknown> | undefined => {\n\tif( options == null ) {\n\t\treturn undefined;\n\t} else if( options instanceof DMenu ) {\n\t\treturn options;\n\t} else {\n\t\treturn new DMenu( options );\n\t}\n};\n\nconst toColumnDialog = (\n\toptions?: DDialogSelectOptions<unknown> | DTableColumnSelectingDialog<unknown>\n): DTableColumnSelectingDialog<unknown> | undefined => {\n\tif( options == null ) {\n\t\treturn undefined;\n\t} else if( \"open\" in options ) {\n\t\treturn options;\n\t} else {\n\t\treturn new DDialogSelect( options );\n\t}\n};\n\nconst defaultSelectingGetter = ( dialog: DTableColumnSelectingDialog<unknown> ): unknown => {\n\treturn dialog.value;\n};\n\nconst defaultSelectingSetter = (): void => {\n\t// DO NOTHING\n};\n\nconst toColumnSelecting = (\n\toptions: DTableColumnSelectingOptions<any, any, any> | undefined\n): DTableColumnSelecting<any, any, any> => {\n\tif( options ) {\n\t\treturn {\n\t\t\tgetter: options.getter || defaultSelectingGetter,\n\t\t\tsetter: options.setter || defaultSelectingSetter,\n\t\t\tmenu: toColumnMenu( options.menu ),\n\t\t\tmultiple: toColumnMenu( options.multiple ),\n\t\t\tdialog: toColumnDialog( options.dialog ),\n\t\t\tpromise: options.promise\n\t\t};\n\t}\n\treturn {\n\t\tgetter: defaultSelectingGetter,\n\t\tsetter: defaultSelectingSetter\n\t};\n};\n\nconst toColumnGetter = <ROW, CELL>(\n\toptions: DTableColumnOptions<ROW, CELL>,\n\ttype: DTableColumnType,\n\tparts: string[] | null\n): DTableGetter<ROW, CELL> => {\n\tconst getter = options.getter;\n\tif( getter ) {\n\t\treturn getter;\n\t}\n\tswitch( type ) {\n\tcase DTableColumnType.ACTION:\n\tcase DTableColumnType.LINK:\n\t\treturn defaultGetterEmpty;\n\tdefault:\n\t\tif( parts == null ) {\n\t\t\treturn defaultGetter;\n\t\t} else {\n\t\t\treturn toPathGetter( parts, options.default );\n\t\t}\n\t}\n};\n\nconst toColumnSetter = <ROW, CELL>(\n\toptions: DTableColumnOptions<ROW, CELL>,\n\ttype: DTableColumnType,\n\tpath: string[] | null\n): DTableSetter<ROW, CELL> => {\n\tconst setter = options.setter;\n\tif( setter ) {\n\t\treturn setter;\n\t}\n\tswitch( type ) {\n\tcase DTableColumnType.BUTTON:\n\tcase DTableColumnType.ACTION:\n\tcase DTableColumnType.LINK:\n\t\treturn defaultSetterEmpty;\n\tdefault:\n\t\tif( path == null ) {\n\t\t\treturn defaultSetter;\n\t\t} else {\n\t\t\treturn toPathSetter( path );\n\t\t}\n\t}\n};\n\nconst toColumnPath = <ROW, CELL>(\n\toptions: DTableColumnOptions<ROW, CELL>\n): string[] | null => {\n\treturn options.path != null ? options.path.split( \".\" ) : null;\n};\n\nconst toColumnRenderable = <ROW, CELL>(\n\toptions: DTableColumnOptions<ROW, CELL>,\n\tpath: string[] | null\n): boolean | DTableRenderable<ROW> => {\n\tconst renderable = options.renderable;\n\tif( isString( renderable ) ) {\n\t\treturn toColumnDataChecker( path );\n\t} else if( renderable != null ) {\n\t\treturn renderable;\n\t}\n\treturn true;\n};\n\nconst toColumn = <ROW, CELL>(\n\tindex: number,\n\toptions: DTableColumnOptions<ROW, CELL>\n): DTableColumn<ROW, CELL> => {\n\tconst weight = ( options.weight != null ? options.weight :\n\t\t( options.width != null ? undefined : +1 )\n\t);\n\tconst width = ( weight != null ? undefined :\n\t\t( options.width != null ? options.width : 100 )\n\t);\n\tconst type = ( options.type != null ?\n\t\t( isString( options.type ) ? DTableColumnType[ options.type ] : options.type ) :\n\t\tDTableColumnType.TEXT\n\t);\n\tconst align = toColumnAlign( options, type );\n\tconst label = options.label || \"\";\n\tconst path = toColumnPath( options );\n\tconst getter = toColumnGetter( options, type, path );\n\tconst setter = toColumnSetter( options, type, path );\n\treturn {\n\t\tweight,\n\t\twidth,\n\t\ttype,\n\t\tlabel,\n\t\tgetter,\n\t\tsetter,\n\t\tformatter: options.formatter,\n\t\trenderable: toColumnRenderable( options, path ),\n\t\talign,\n\n\t\tediting: toColumnEditing( options, path ),\n\t\tsorting: toColumnSorting( getter, index, options ),\n\n\t\theader: options.header,\n\t\tbody: options.body,\n\n\t\tselecting: toColumnSelecting( options.selecting ),\n\n\t\tcategory: options.category,\n\t\tfrozen: options.frozen,\n\t\toffset: 0.0,\n\n\t\tlink: options.link\n\t};\n};\n\nconst toColumns = <ROW, CELL>(\n\toptions: Array<DTableColumnOptions<ROW, CELL>>\n): Array<DTableColumn<ROW, CELL>> => {\n\tconst result = [];\n\tfor( let i = 0, imax = options.length; i < imax; ++i ) {\n\t\tresult.push( toColumn( i, options[ i ] ) );\n\t}\n\treturn result;\n};\n\nconst toFrozen = <ROW, CELL>(\n\tcolumns: Array<DTableColumn<ROW, CELL>>\n): number => {\n\tfor( let i = columns.length - 1; 0 <= i; --i ) {\n\t\tif( columns[ i ].frozen === true ) {\n\t\t\treturn i + 1;\n\t\t}\n\t}\n\treturn 0;\n};\n\nexport class DTable<\n\tROW,\n\tDATA extends DTableData<ROW> = DTableDataList<ROW>,\n\tTHEME extends DThemeTable = DThemeTable,\n\tCONTENT_OPTIONS extends DBaseOptions = DContentOptions,\n\tOPTIONS extends DTableOptions<ROW, DATA, THEME, CONTENT_OPTIONS> = DTableOptions<ROW, DATA, THEME, CONTENT_OPTIONS>\n>  extends DPane<THEME, CONTENT_OPTIONS, OPTIONS> {\n\tprotected _categories!: DTableCategory[];\n\tprotected _header!: DTableHeader<ROW> | null;\n\tprotected _body!: DTableBody<ROW, DATA>;\n\tprotected _bodyOffset!: number;\n\tprotected _frozen!: number;\n\n\tconstructor( options: OPTIONS ) {\n\t\tsuper( options );\n\t}\n\n\tprotected init( options: OPTIONS ) {\n\t\t// Column\n\t\tconst columns = toColumns( options.columns );\n\n\t\t// Frozen\n\t\tconst frozen = toFrozen( columns );\n\t\tthis._frozen = frozen;\n\n\t\t// Categories\n\t\tconst categories = this.newCategories( options, columns, frozen );\n\t\tthis._categories = categories;\n\n\t\t// Header\n\t\tlet headerOffset = 0;\n\t\tfor( let i = 0, imax = categories.length; i < imax; ++i ) {\n\t\t\theaderOffset += categories[ i ].height;\n\t\t}\n\t\tconst header = this.newHeader( options, columns, frozen, headerOffset );\n\t\tthis._header = header;\n\n\t\t// Body\n\t\tconst bodyOffset = headerOffset + ((header && header.height) || 0);\n\t\tthis._bodyOffset = bodyOffset;\n\t\tconst body = this.newBody( options, columns, frozen, bodyOffset );\n\t\tthis._body = body;\n\n\t\t// Super\n\t\tsuper.init( options );\n\n\t\t// Content\n\t\tconst content = this._content;\n\t\tcontent.setWidth( this.toContentWidth( options ) );\n\t\tcontent.addChild( body );\n\t\tif( header ) {\n\t\t\tcontent.addChild( header );\n\t\t}\n\t\tfor( let i = categories.length - 1; 0 <= i; --i ) {\n\t\t\tcontent.addChild( categories[ i ] );\n\t\t}\n\t\tcontent.on( \"move\", (): void => {\n\t\t\tbody.update();\n\t\t});\n\t\tcontent.on( \"resize\", (): void => {\n\t\t\tbody.update();\n\t\t});\n\t\tif( body.data.selection.type !== DTableDataSelectionType.NONE ) {\n\t\t\tUtilPointerEvent.onClick( this, ( e: interaction.InteractionEvent ): void => {\n\t\t\t\tbody.onRowClick( e );\n\t\t\t});\n\t\t}\n\t\tcontent.state.isFocusReverse = true;\n\t\tbody.update();\n\t}\n\n\tonResize( newWidth: number, newHeight: number, oldWidth: number, oldHeight: number ): void {\n\t\tconst body = this._body;\n\t\tbody.lock();\n\t\tsuper.onResize( newWidth, newHeight, oldWidth, oldHeight );\n\t\tbody.update();\n\t\tbody.unlock( true );\n\t}\n\n\tprotected getCategoryCount( columns: Array<DTableColumn<ROW, unknown>> ): number {\n\t\tlet result = 0;\n\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\tconst category = columns[ i ].category;\n\t\t\tif( category != null ) {\n\t\t\t\tconst count = isString( category ) ? 1 : category.length;\n\t\t\t\tresult = Math.max( result, count );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected toCategoryLabel( index: number, category: string | string[] | undefined ): string | undefined {\n\t\tif( category ) {\n\t\t\tif( isString( category ) ) {\n\t\t\t\tif( index === 0 ) {\n\t\t\t\t\treturn category;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( index < category.length ) {\n\t\t\t\t\treturn category[ index ];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn undefined;\n\t}\n\n\tprotected isSameCategory(\n\t\tindex: number,\n\t\ta: string | string[] | undefined,\n\t\tb: string | string[] | undefined\n\t): boolean {\n\t\tif( a != null ) {\n\t\t\tif( b != null ) {\n\t\t\t\tif( isString( a ) ) {\n\t\t\t\t\tif( isString( b ) ) {\n\t\t\t\t\t\tif( 0 < index ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn a === b;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( 0 < index ) {\n\t\t\t\t\t\t\treturn b.length <= index;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn b.length === 1 && a === b[ 0 ];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( isString( b ) ) {\n\t\t\t\t\t\tif( 0 < index ) {\n\t\t\t\t\t\t\treturn a.length <= index;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\treturn a.length === 1 && a[ 0 ] === b;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif( a.length <= index && b.length <= index ) {\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t} else if( b.length === a.length ) {\n\t\t\t\t\t\t\tfor( let i = index, imax = a.length; i < imax; ++i ) {\n\t\t\t\t\t\t\t\tif( a[ i ] !== b[ i ] ) {\n\t\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\treturn true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tif( isString( a ) ) {\n\t\t\t\t\tif( 0 < index ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( a.length <= index ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif( b != null ) {\n\t\t\t\tif( isString( b ) ) {\n\t\t\t\t\tif( 0 < index ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif( b.length <= index ) {\n\t\t\t\t\t\treturn true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t}\n\n\tprotected toCategoryColumns(\n\t\tindex: number,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\tfrozen: number\n\t): DTableCategoryColumn[] {\n\t\tconst result: DTableCategoryColumn[] = [];\n\t\tlet tcolumn: DTableColumn<ROW, unknown> | null = null;\n\t\tlet ccolumn: DTableCategoryColumn | null = null;\n\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\tconst column = columns[ i ];\n\t\t\tif( i !== frozen && ccolumn && tcolumn && this.isSameCategory( index, tcolumn.category, column.category ) ) {\n\t\t\t\tif( ccolumn.weight != null && column.weight != null ) {\n\t\t\t\t\tccolumn.weight += column.weight;\n\t\t\t\t} else if( ccolumn.width != null && column.width != null ) {\n\t\t\t\t\tccolumn.width += column.width;\n\t\t\t\t} else {\n\t\t\t\t\ttcolumn = column;\n\t\t\t\t\tccolumn = {\n\t\t\t\t\t\tlabel: this.toCategoryLabel( index, column.category ),\n\t\t\t\t\t\tweight: column.weight,\n\t\t\t\t\t\twidth: column.width,\n\t\t\t\t\t\toffset: 0.0\n\t\t\t\t\t};\n\t\t\t\t\tresult.push( ccolumn );\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\ttcolumn = column;\n\t\t\t\tccolumn = {\n\t\t\t\t\tlabel: this.toCategoryLabel( index, column.category ),\n\t\t\t\t\tweight: column.weight,\n\t\t\t\t\twidth: column.width,\n\t\t\t\t\toffset: 0.0\n\t\t\t\t};\n\t\t\t\tresult.push( ccolumn );\n\t\t\t}\n\t\t}\n\t\treturn result;\n\t}\n\n\tprotected toCategoryOptions(\n\t\tindex: number,\n\t\toptions: DTableCategoryOptions | undefined,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\tfrozen: number,\n\t\toffset: number\n\t): DTableCategoryOptions {\n\t\tif( options ) {\n\t\t\tif( options.columns === undefined ) {\n\t\t\t\toptions.columns = this.toCategoryColumns( index, columns, frozen );\n\t\t\t}\n\t\t\tif( options.frozen == null ) {\n\t\t\t\toptions.frozen = frozen;\n\t\t\t}\n\t\t\tif( options.offset == null ) {\n\t\t\t\toptions.offset = offset;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tcolumns: this.toCategoryColumns( index, columns, frozen ),\n\t\t\tfrozen,\n\t\t\toffset\n\t\t};\n\t}\n\n\tprotected newCategories( options: OPTIONS, columns: Array<DTableColumn<ROW, unknown>>, frozen: number ): DTableCategory[] {\n\t\tconst count = this.getCategoryCount( columns );\n\t\tconst result: DTableCategory[] = [];\n\t\tlet offset: number = 0;\n\t\tfor( let i = count - 1; 0 <= i; --i ) {\n\t\t\tconst category = new DTableCategory( this.toCategoryOptions( i, options.category, columns, frozen, offset ) );\n\t\t\tresult.push( category );\n\t\t\toffset += category.height;\n\t\t}\n\t\treturn result;\n\t}\n\n\tonDblClick( e: MouseEvent | TouchEvent, interactionManager: interaction.InteractionManager ): boolean {\n\t\tconst result = this._body.onDblClick( e, interactionManager );\n\t\treturn super.onDblClick( e, interactionManager ) || result;\n\t}\n\n\tprotected getScrollBarOffsetVerticalStart( size: number ): number {\n\t\treturn size * 0.5 + this._body.position.y;\n\t}\n\n\tprotected toContentWidth( options: OPTIONS ): DCoordinateSize {\n\t\tlet columnWidthTotal = 0;\n\t\tconst columns = options.columns;\n\t\tif( columns ) {\n\t\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\t\tconst column = columns[ i ];\n\t\t\t\tconst columnWidth = column.width;\n\t\t\t\tif( columnWidth != null ) {\n\t\t\t\t\tcolumnWidthTotal += columnWidth;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif( 0 < columnWidthTotal ) {\n\t\t\treturn ( p: number ): number => {\n\t\t\t\treturn Math.max( p, columnWidthTotal );\n\t\t\t};\n\t\t}\n\t\treturn \"100%\";\n\t}\n\n\tprotected hasHeader( options: OPTIONS ): boolean {\n\t\tconst columns = options.columns;\n\t\tfor( let i = 0, imax = columns.length; i < imax; ++i ) {\n\t\t\tif( columns[ i ].label != null ) {\n\t\t\t\treturn true;\n\t\t\t}\n\t\t}\n\t\treturn false;\n\t}\n\n\tprotected newHeader(\n\t\toptions: OPTIONS,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\tfrozen: number,\n\t\toffset: number\n\t): DTableHeader<ROW> | null {\n\t\tif( this.hasHeader( options ) ) {\n\t\t\treturn new DTableHeader<ROW>( this.toHeaderOptions( options.header, columns, frozen, offset ) );\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected toHeaderOptions(\n\t\toptions: DTableHeaderOptions<ROW> | undefined,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\tfrozen: number,\n\t\toffset: number\n\t): DTableHeaderOptions<ROW> {\n\t\tif( options ) {\n\t\t\tif( options.columns === undefined ) {\n\t\t\t\toptions.columns = columns;\n\t\t\t}\n\t\t\tif( options.frozen == null ) {\n\t\t\t\toptions.frozen = frozen;\n\t\t\t}\n\t\t\tif( options.offset === undefined ) {\n\t\t\t\toptions.offset = offset;\n\t\t\t}\n\t\t\tif( options.table === undefined ) {\n\t\t\t\toptions.table = this;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\treturn {\n\t\t\tcolumns,\n\t\t\tfrozen,\n\t\t\toffset,\n\t\t\ttable: this\n\t\t};\n\t}\n\n\tprotected newBody(\n\t\toptions: OPTIONS,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\tfrozen: number,\n\t\toffset: number\n\t): DTableBody<ROW, DATA> {\n\t\treturn new DTableBody<ROW, DATA>(\n\t\t\tthis.toBodyOptions( options.body, columns, frozen, offset, options.data )\n\t\t);\n\t}\n\n\tprotected toBodyOptions(\n\t\toptions: DTableBodyOptions<ROW, DATA> | undefined,\n\t\tcolumns: Array<DTableColumn<ROW, unknown>>,\n\t\tfrozen: number,\n\t\toffset: number,\n\t\tdata: ROW[] | DTableDataOptions<ROW> | DATA | undefined\n\t): DTableBodyOptions<ROW, DATA> {\n\t\tif( options != null ) {\n\t\t\tif( options.columns === undefined ) {\n\t\t\t\toptions.columns = columns;\n\t\t\t}\n\t\t\tif( options.frozen == null ) {\n\t\t\t\toptions.frozen = frozen;\n\t\t\t}\n\t\t\tif( options.offset === undefined ) {\n\t\t\t\toptions.offset = offset;\n\t\t\t}\n\t\t\tif( options.data === undefined && data !== undefined ) {\n\t\t\t\tif( isArray( data ) ) {\n\t\t\t\t\toptions.data = {\n\t\t\t\t\t\trows: data\n\t\t\t\t\t};\n\t\t\t\t} else {\n\t\t\t\t\toptions.data = data;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif( options.height === undefined && options.weight === undefined ) {\n\t\t\t\toptions.weight = 1;\n\t\t\t}\n\t\t\treturn options;\n\t\t}\n\t\tif( isArray( data ) ) {\n\t\t\treturn {\n\t\t\t\tcolumns,\n\t\t\t\tfrozen,\n\t\t\t\toffset,\n\t\t\t\tdata: {\n\t\t\t\t\trows: data\n\t\t\t\t},\n\t\t\t\tweight: 1\n\t\t\t};\n\t\t} else {\n\t\t\treturn {\n\t\t\t\tcolumns,\n\t\t\t\tfrozen,\n\t\t\t\toffset,\n\t\t\t\tdata,\n\t\t\t\tweight: 1\n\t\t\t};\n\t\t}\n\t}\n\n\tprotected getFocusedChildClippingRect(\n\t\tfocused: DBase,\n\t\tcontentX: number, contentY: number,\n\t\tcontentWidth: number, contentHeight: number,\n\t\twidth: number, height: number,\n\t\tresult: Rectangle\n\t): Rectangle {\n\t\tsuper.getFocusedChildClippingRect(\n\t\t\tfocused,\n\t\t\tcontentX, contentY,\n\t\t\tcontentWidth, contentHeight,\n\t\t\twidth, height,\n\t\t\tresult\n\t\t);\n\n\t\tconst cell = this.toCell( focused );\n\t\tif( cell ) {\n\t\t\t// X\n\t\t\tconst dx = contentX + this.toFrozenCellX( cell ) - result.x;\n\t\t\tif( 0 < dx ) {\n\t\t\t\tresult.x += dx;\n\t\t\t\tresult.width -= dx;\n\t\t\t}\n\n\t\t\t// Y\n\t\t\tif( cell.parent.parent === this._body ) {\n\t\t\t\tconst dy = this._bodyOffset;\n\t\t\t\tresult.y += dy;\n\t\t\t\tresult.height -= dy;\n\t\t\t}\n\t\t}\n\n\n\t\t// Done\n\t\treturn result;\n\t}\n\n\tprotected toFrozenCellX( cell: DBase ): number {\n\t\tconst frozen = this._frozen;\n\t\tif( 0 < frozen ) {\n\t\t\tconst cells = cell.parent.children as DBase[];\n\t\t\tconst cellIndex = cells.indexOf( cell );\n\t\t\tif( 0 <= cellIndex ) {\n\t\t\t\tconst cellsLength = cells.length;\n\t\t\t\tconst columnIndex = cellsLength - 1 - cellIndex;\n\t\t\t\tif( frozen <= columnIndex ) {\n\t\t\t\t\tconst cellFrozen = cells[ cellsLength - frozen ];\n\t\t\t\t\treturn cellFrozen.position.x + cellFrozen.width;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn 0;\n\t}\n\n\tonKeyDown( e: KeyboardEvent ): boolean {\n\t\tUtilKeyboardEvent.moveFocusHorizontally( e, this );\n\t\tconst isArrowUpKey = UtilKeyboardEvent.isArrowUpKey( e );\n\t\tconst isArrowDownKey = UtilKeyboardEvent.isArrowDownKey( e );\n\t\tif( isArrowUpKey || isArrowDownKey ) {\n\t\t\tthis.onKeyDownArrowUpOrDown( e, isArrowDownKey );\n\t\t}\n\t\treturn super.onKeyDown( e );\n\t}\n\n\tprotected onKeyDownArrowUpOrDown( e: KeyboardEvent, isDown: boolean ): boolean {\n\t\tconst layer = DApplications.getLayer( this );\n\t\tif( layer == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst focusController = layer.getFocusController();\n\t\tconst oldFocusable = focusController.get();\n\t\tif( oldFocusable == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst oldCell = this.toCell( oldFocusable );\n\t\tif( oldCell == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst oldRow = oldCell.parent;\n\t\tif( oldRow == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newRowChild = focusController.find( oldRow, false, false, isDown, this );\n\t\tif( newRowChild == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newCellSibling = this.toCell( newRowChild );\n\t\tif( newCellSibling == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newRow = newCellSibling.parent;\n\t\tif( newRow == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst oldCellIndex = oldRow.children.indexOf( oldCell );\n\t\tif( oldCellIndex < 0 ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newCell = newRow.children[ oldCellIndex ];\n\t\tif( newCell == null || newCell === oldCell || !(\"state\" in newCell) ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tconst newFocusable = focusController.find( newCell, true, true, isDown, this );\n\t\tif( newFocusable == null ) {\n\t\t\treturn false;\n\t\t}\n\n\t\tfocusController.focus( newFocusable );\n\t\treturn true;\n\t}\n\n\tprotected toCell( focused: DFocusable ): DBase | null {\n\t\tlet current: DFocusable | DFocusableContainer | null = focused;\n\t\twhile( current != null ) {\n\t\t\tconst parent: DFocusableContainer | null = current.parent;\n\t\t\tif( parent instanceof DTableRow ) {\n\t\t\t\tif( current instanceof DBase ) {\n\t\t\t\t\treturn current;\n\t\t\t\t}\n\t\t\t\treturn null;\n\t\t\t}\n\t\t\tcurrent = parent;\n\t\t}\n\t\treturn null;\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTable\";\n\t}\n\n\tget categories(): DTableCategory[] {\n\t\treturn this._categories;\n\t}\n\n\tget header(): DTableHeader<ROW> | null {\n\t\treturn this._header;\n\t}\n\n\tget body(): DTableBody<ROW, DATA> {\n\t\treturn this._body;\n\t}\n\n\tget data(): DATA {\n\t\treturn this._body.data;\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\n/**\n * Tree item states.\n */\nexport const DTreeItemState = {\n\t/**\n\t * the parent item is expanded\n\t */\n\tEXPANDED: \"EXPANDED\",\n\n\t/**\n\t * the parent item is collapsed\n\t */\n\tCOLLAPSED: \"COLLAPSED\"\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\n\nexport interface DTreeItemTextAndImageOptions<\n\tTHEME extends DThemeTreeItemTextAndImage = DThemeTreeItemTextAndImage\n> extends DImageOptions <string, THEME> {\n\n}\n\nexport interface DThemeTreeItemTextAndImage extends DThemeImage<string> {\n\n}\n\nexport class DTreeItemTextAndImage<\n\tTHEME extends DThemeTreeItemTextAndImage = DThemeTreeItemTextAndImage,\n\tOPTIONS extends DTreeItemTextAndImageOptions<THEME> = DTreeItemTextAndImageOptions<THEME>\n> extends DImage<string, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DTreeItemTextAndImage\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\nimport { DImage, DImageOptions, DThemeImage } from \"./d-image\";\n\nexport interface DTreeItemToggleIconOptions<\n\tTHEME extends DThemeTreeItemToggleIcon = DThemeTreeItemToggleIcon\n> extends DImageOptions<string, THEME> {\n\n}\n\nexport interface DThemeTreeItemToggleIcon extends DThemeImage<string> {\n\n}\n\nexport class DTreeItemToggleIcon<\n\tTHEME extends DThemeTreeItemToggleIcon = DThemeTreeItemToggleIcon,\n\tOPTIONS extends DTreeItemToggleIconOptions<THEME> = DTreeItemToggleIconOptions<THEME>\n> extends DImage<string, THEME, OPTIONS> {\n\tprotected getType(): string {\n\t\treturn \"DTreeItemToggleIcon\";\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { DisplayObject, interaction, Texture } from \"pixi.js\";\nimport { DLayoutHorizontal, DLayoutHorizontalOptions, DThemeLayoutHorizontal } from \"./d-layout-horizontal\";\nimport { DTreeItemRawData } from \"./d-tree\";\nimport { DTreeItemState } from \"./d-tree-item-state\";\nimport { DTreeItemTextAndImage } from \"./d-tree-item-text-and-image\";\nimport { DTreeItemToggleIcon} from \"./d-tree-item-toggle-icon\";\nimport { UtilPointerEvent } from \"./util/util-pointer-event\";\n\nexport interface DTreeItemOptions<\n\tTHEME extends DThemeTreeItem = DThemeTreeItem\n> extends DLayoutHorizontalOptions <THEME> {\n\ttext: string;\n\tisParent: boolean;\n\texpanded: boolean;\n\trawData: DTreeItemRawData;\n\ty: number;\n\tlevel: number;\n\tshowable?: boolean;\n\timage?: DisplayObject | Texture | null;\n}\n\nexport interface DThemeTreeItem extends DThemeLayoutHorizontal {\n\tgetPaddingByLevel( level: number ): number;\n}\n\nconst toText = ( options?: DTreeItemOptions ): string => {\n\treturn options?.text ?? \"\";\n};\n\nconst toImage = ( options?: DTreeItemOptions ): DisplayObject | Texture | null => {\n\treturn options?.image ?? null;\n};\n\nconst toYCoordinate = ( options?: DTreeItemOptions ): number => {\n\treturn options?.y ?? 0;\n};\n\nconst toRawData = ( options?: DTreeItemOptions ): DTreeItemRawData => {\n\treturn options?.rawData ?? {\n\t\ttext: \"\",\n\t\tchildren: []\n\t};\n};\n\nconst toPaddingLeft = <THEME extends DThemeTreeItem>(\n\ttheme: DThemeTreeItem,\n\toptions?: DTreeItemOptions<THEME>\n): number => {\n\treturn theme.getPaddingByLevel( options?.level ?? 0 );\n};\n\nconst toTreeItemTextAndImage = ( options?: DTreeItemOptions ): DTreeItemTextAndImage => {\n\treturn new DTreeItemTextAndImage({\n\t\ttext: {\n\t\t\tvalue: toText( options )\n\t\t},\n\t\timage: {\n\t\t\tsource: toImage( options )\n\t\t}\n\t});\n};\n\nexport class DTreeItem<\n\tTHEME extends DThemeTreeItem = DThemeTreeItem,\n\tOPTIONS extends DTreeItemOptions <THEME> = DTreeItemOptions <THEME>\n> extends DLayoutHorizontal < THEME, OPTIONS > {\n\tprotected _isParent!: boolean;\n\tprotected _isExpanded!: boolean;\n\tprotected _rawData!: DTreeItemRawData;\n\tprotected _textAndImage!: DTreeItemTextAndImage;\n\tprotected _icon!: DTreeItemToggleIcon;\n\n\tprotected init( options ?: OPTIONS ) {\n\t\tsuper.init( options );\n\t\tthis._isParent = !! options?.isParent;\n\t\tthis._isExpanded = !! options?.expanded;\n\t\tthis._rawData = toRawData( options );\n\n\t\tthis._icon = new DTreeItemToggleIcon();\n\t\tthis._textAndImage = toTreeItemTextAndImage( options );\n\n\t\tthis.addChild( this._icon );\n\t\tthis.addChild( this._textAndImage );\n\n\t\tthis._icon.on( UtilPointerEvent.down, (): void => {\n\t\t\tthis.onToggle();\n\t\t});\n\t\tthis._textAndImage.on( UtilPointerEvent.down, ( e: interaction.InteractionEvent ): void => {\n\t\t\tthis.onSelect( e );\n\t\t});\n\n\t\t// update states\n\t\tthis.updateStates( false );\n\t}\n\n\tprotected onSelect( e: interaction.InteractionEvent ): void {\n\t\tthis.emit( \"select\", e );\n\t}\n\n\tpublic onToggle(): void {\n\t\tthis.emit( \"toggle\" );\n\t}\n\n\tpublic isExpanded(): boolean {\n\t\treturn this._isExpanded;\n\t}\n\n\tpublic isParent(): boolean {\n\t\treturn this._isParent;\n\t}\n\n\tpublic getRawData(): DTreeItemRawData {\n\t\treturn this._rawData;\n\t}\n\n\tpublic update( options: OPTIONS, isActive: boolean ) {\n\t\tthis._textAndImage.text = toText( options );\n\t\tthis._textAndImage.image = toImage( options );\n\t\tthis._rawData = toRawData( options );\n\t\tthis._padding.left = toPaddingLeft( this.theme, options );\n\t\tthis.position.y = toYCoordinate( options );\n\t\tthis._isParent = !! options.isParent;\n\t\tthis._isExpanded = !! options.expanded;\n\t\tthis.updateStates( isActive );\n\t\treturn this;\n\t}\n\n\tprotected updateStates( isActive: boolean ): void {\n\t\tthis.state.isActive = isActive;\n\n\t\tconst iconState = this._icon.state;\n\t\tconst isParent = this._isParent;\n\t\tconst isExpanded = this._isExpanded;\n\t\ticonState.lock();\n\t\ticonState.set( DTreeItemState.EXPANDED, isParent && isExpanded );\n\t\ticonState.set( DTreeItemState.COLLAPSED, isParent && ! isExpanded );\n\t\ticonState.unlock();\n\t}\n\n\tprotected getType(): string {\n\t\treturn \"DTreeItem\";\n\t}\n}\n","import { DTreeItemRawData } from \"./d-tree\";\n\n/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport class DTreeSelection {\n\tprotected _selection!: DTreeItemRawData[];\n\n\tconstructor() {\n\t\tthis._selection = [];\n\t}\n\n\t/**\n\t * Select an item.\n\t * Add item data to this._selection if it not exist in this._selection.\n\t *\n\t * @param item Reference data of item want to remove in value array.\n\t */\n\tpublic add( item: DTreeItemRawData ) {\n\t\tif( this._selection.indexOf( item ) === -1 ) {\n\t\t\tthis._selection.push( item );\n\t\t}\n\t}\n\n\t/**\n\t * Un-select an item.\n\t * remove item data to this._selection if it exist in this._selection.\n\t *\n\t * @param item Reference data of item want to remove in value array.\n\t */\n\tpublic remove( item: DTreeItemRawData ) {\n\t\tconst itemIndex = this._selection.indexOf( item );\n\t\tif( itemIndex !== -1 ) {\n\t\t\tthis._selection.splice( itemIndex, 1 );\n\t\t}\n\t}\n\n\t/**\n\t * Select/un-select an item.\n\t * If item data not exist in this._selection, add it to this._selection.\n\t * If item data exist in this._selection, remove it to this._selection.\n\t *\n\t * @param item Reference data of item want to remove in value array.\n\t */\n\tpublic toggle( item: DTreeItemRawData ) {\n\t\tconst itemIndex = this._selection.indexOf( item );\n\t\tif( itemIndex !== -1 ) {\n\t\t\tthis._selection.splice( itemIndex, 1 );\n\t\t} else {\n\t\t\tthis._selection.push( item );\n\t\t}\n\t}\n\n\t/**\n\t * Un-select all item.\n\t *\n\t */\n\tpublic clear() {\n\t\tthis._selection.length = 0;\n\t}\n\n\t/**\n\t * Get selected item by index.\n\t *\n\t * @param index index of item in this._selection\n\t *\n\t * @returns  Reference data of selected item in value array.\n\t */\n\tpublic get( index: number ): DTreeItemRawData | null {\n\t\tconst selection = this._selection;\n\t\tif( 0 <= index && index < selection.length ) {\n\t\t\treturn selection[ index ];\n\t\t}\n\t\treturn null;\n\t}\n\n\t/**\n\t * Check item is selected or not.\n\t *\n\t * @param item Reference data of item want to remove in value array.\n\t *\n\t * @returns selected state of checked item.\n\t */\n\tpublic contains( item: DTreeItemRawData ) {\n\t\treturn this._selection.indexOf( item ) !== -1;\n\t}\n\n\t/**\n\t * Get number of selected .\n\t *\n\t * @returns number of selected.\n\t */\n\tpublic size() {\n\t\treturn this._selection.length;\n\t}\n\n\t/**\n\t * Iterate over selected items.\n\t *\n\t * @param iteratee  boolean function. If the iteratee explicitly returns false, an iteration stops.\n\t * @param item data of browsed item.\n\t */\n\tpublic each( iteratee: ( item: DTreeItemRawData ) => boolean ) {\n\t\tfor (const item of this._selection) {\n\t\t\tif( !iteratee( item ) ) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapeImageElements } from \"../e-shape-image-elements\";\nimport { EShapeImage } from \"./e-shape-image\";\n\nexport const createImage = ( dataUrl: string ): Promise<EShapeImage> => {\n\treturn EShapeImageElements.toImageElement( dataUrl ).then(( imageElement: HTMLImageElement ): EShapeImage => {\n\t\treturn new EShapeImage( imageElement );\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { EShapePointsStyle } from \"../e-shape-points-style\";\nimport { EShapeLine } from \"./e-shape-line\";\n\nexport const createLine = (\n\tpoints: number[],\n\tsegments: number[],\n\tstrokeWidth: number,\n\tstyle: EShapePointsStyle\n): EShapeLine => {\n\treturn new EShapeLine( points, segments, strokeWidth, style );\n};\n\nexport const toLineStrokeWidth = ( index: number, resources: string[] ): number => {\n\tif( 0 <= index && index < resources.length  ) {\n\t\ttry {\n\t\t\treturn JSON.parse( resources[ index ] )[ 3 ];\n\t\t} catch( e ) {\n\t\t\t//\n\t\t}\n\t}\n\treturn 8;\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Point } from \"pixi.js\";\n\nexport class ESnapperResultScale {\n\tdistance: number;\n\tscale: Point;\n\n\tconstructor() {\n\t\tthis.distance = NaN;\n\t\tthis.scale = new Point();\n\t}\n}\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { isNumber } from \"./is-number\";\nimport { isString } from \"./is-string\";\n\nexport const toLabel = ( target: any ): string => {\n\tif( target != null ) {\n\t\tif( isString( target ) ) {\n\t\t\treturn target;\n\t\t} else if( isNumber( target ) ) {\n\t\t\treturn String( target );\n\t\t} else if( \"name\" in target ) {\n\t\t\treturn target.name;\n\t\t} else if( \"label\" in target ) {\n\t\t\treturn target.label;\n\t\t} else if( \"id\" in target ) {\n\t\t\treturn target.id;\n\t\t}\n\t}\n\treturn \"\";\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nexport const toString = ( value: unknown ): string => {\n\treturn ( value != null ? String( value ) : \"\" );\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport { Texture } from \"pixi.js\";\nimport { toSvgUrl } from \"./to-svg-url\";\n\nexport const toSvgTexture = ( svg: string, resolution: number ): Texture => {\n\treturn Texture.from( toSvgUrl( svg ), {\n\t\tresolution\n\t});\n};\n","/*\n * Copyright (C) 2019 Toshiba Corporation\n * SPDX-License-Identifier: Apache-2.0\n */\n\nimport * as ui from \"./wcardinal/ui\";\n\nui.loadAll();\n\nconst global = window as any;\nglobal.wcardinal = global.wcardinal || {};\nglobal.wcardinal.ui = ui;\n"],"names":["EShapeType","EShapeDeserializers","EShapePointsStyle","EShapeUploadeds","EShapeTextWeight","EShapeTextStyle","EShapeTextAlignHorizontal","EShapeTextAlignVertical","EShapeTextDirection","toDash","length","strokeWidth","style","result","set","NON_SOLID_MASK","DOTTED","DOTTED_DENSELY","DOTTED_LOOSELY","DASHED","DASHED_DENSELY","DASHED_LOOSELY","toScaleInvariant","nonExpandingWidth","NON_EXPANDING_WIDTH","nonShrinkingWidth","NON_SHRINKING_WIDTH","nonScalingDotAndDash","NON_SCALING_DOT_AND_DASH","BAR_WORK_POINT","Point","this","_target","_position","Object","UtilCharacterIterator","position","target","istart","iend","i","code","charCodeAt","isLowSurrogate","isVariationSelector","nextBreak","findNextBreak","substring","except","_instance","instance","init","EShapeBarPosition","toLength","p0x","p0y","p1x","p1y","dx01","dy01","Math","sqrt","TEXT_FMIN","TEXT_WORK_POINT","toTextBufferCount","shape","ceil","text","value","buildTextClipping","clippings","voffset","vcount","imax","buildTextIndex","indices","ioffset","icount","ii","j","buildTextStep","steps","textAtlas","textSize","textOutlineWidth","textWeight","antialiasWeight","scale","font","size","outlineWidth","weight","NORMAL","getTextBBox","halign","valign","hoffset","hpadding","vpadding","width","height","x0","y0","x1","y1","x2","y2","x3","y3","hnx","hny","vnx","vny","LEFT","TOP","x","y","MIDDLE","BOTTOM","OUTSIDE_TOP","OUTSIDE_BOTTOM","CENTER","RIGHT","OUTSIDE_LEFT","OUTSIDE_RIGHT","toNormalized","dx","dy","defx","defy","d","l","li","buildTextVertex","vertices","uvs","originX","originY","sizeX","sizeY","textValue","textStyle","textAlignHorizontal","textAlignVertical","textOffsetHorizontal","textOffsetVertical","textSpacingHorizontal","textSpacingVertical","textDirection","textPaddingHorizontal","textPaddingVertical","textClipping","textWorld","textureUvs","internalTransform","sx","sy","work","apply","hl","a","b","vl","c","heightChar","lineHeight","max","lineWidth","textAtlasCharacters","characters","iterator","from","advancePrevious","hasNext","character","next","data","advance","tx0","ty0","lineWidthMaximum","NaN","LEFT_TO_RIGHT","TOP_TO_BOTTOM","align","rotateAlignVerticalRight","rotateAlignHorizontalRight","BOTTOM_TO_TOP","rotateAlignVerticalLeft","rotateAlignHorizontalLeft","dwidth","uvx0","uvx1","uvx3","uvy0","uvy1","uvy3","duvx01","duvy01","duvx03","duvy03","lhx","lhy","snx","sny","offsetY","oyx","oyy","offsetItalic","bx0","by0","bx3","by3","cx0","cy0","cx3","cy3","lineCount","iv","lineWidthPrevious","ax","ay","dots","bx","by","writeCharacter","writeCharacterEmpty","adjustTextAlignment","ivmax","atlas","dataOffsetX","origin","dataWidth","dx0","dy0","dx1","dy1","px0","py0","px1","py1","dux0","duy0","dux1","duy1","dvx0","dvy0","dvx1","dvy1","moveText","vertexIndex","textCount","moveTextHalf","offset","nx","ny","moveTextFull","extendStatics","setPrototypeOf","__proto__","Array","p","prototype","hasOwnProperty","call","__extends","__","constructor","create","EShapeCopyPart","parent","_parent","_id","_values","_segments","_style","NONE","_size","_updatedSize","_updatedParentSizeX","_updatedParentSizeY","_updatedPosition","EShapeBarPoints","abs","parentSize","parentSizeX","parentSizeY","psxh","psyh","computedSize","getComputedSize","values","update","segments","moveTo","undefined","source","newValues","newSegments","newStyle","newPosition","newSize","isChanged","updateUploaded","transform","point","push","manager","addResource","resourceId","resources","resource","parsed","JSON","parse","threshold","range","tester","DApplications","INSTANCES","instances","Error","index","indexOf","stage","getStage","layer","application","getLayerBase","getLayerOverlay","getLayer","renderer","resolution","window","devicePixelRatio","render","EShapeAction","splice","sources","destinations","isEquals","indexA","indexB","tmp","serialize","EShapeCorner","DBaseState","HOVERED","ACTIVE","FOCUSED","UNFOCUSABLE","FOCUS_ROOT","FOCUS_REVERSE","READ_ONLY","DISABLED","DRAGGING","PRESSED","INVALID","SUCCEEDED","FAILED","WARNED","CHANGED","ALTERNATED","NEW_WINDOW","_data","Map","DBaseStateSetDataImpl","key","get","delete","clear","iteratee","forEach","other","otherData","thisData_1","stringify","toArray","isFunction","isString","toString","_local","Set","DBaseStateSetImpl","state","has","is","under","in","callOnChange","added","checkAdded","begin","add","end","states","local","stateOrStates","arguments","checkAddeds","removed","checkRemoved","stateOrStatesOrMatcher","isDirty_1","_this","checkRemoveds","stateOrAdded","isOnOrRemoved","remove","statesOrAddeds","isOnOrRemoveds","addAll","removeAll","addeds","removeds","local_1","copy","newState","oldState","isHovered","on","isActive","isPressed","isReadOnly","isEnabled","isDisabled","isDragging","isFocused","isFocusRoot","isFocusReverse","isFocusable","unfocusable","invalid","succeeded","failed","isWarned","isAlternated","toObject","onChange","_super","_onChange","_isLocked","_isSaved","_doSave","DBaseStateSetImplObservable","_saved","saved","EShapeState","EShapeStateSetImplObservable","isClicked","isDown","isUp","Matrix","EShapeTransformImpl","onTransformChange","updateSkew","_currentLocalID","_localID","_parentID","_worldID","parentTransform","oldLocalId","oldWorldId","updateTransform","newLocalId","newWorldId","localTransform","copyTo","prepend","Transform","toPadded","str","strLength","padding","UtilRgb","color","toUpperCase","trimmed","trim","toLowerCase","Number","r","g","colorA","colorB","t","ar","ag","ab","br","bg","bb","w1","min","w0","amount","blend","EShapeGradients","gradient","points","direction","alpha","e","parseGradient","serialized","serializeGradient","stops","toCode","radian","PI","cos","sin","btoa","type","id","uuid","newTransform","_onTransformChangeLock","_isOnTransformChanged","action","_visible","_uploadedUpdateLock","_isUploadedUpdated","_isUploadedUpdatedRecursively","_boundsTransformId","_boundsInternalTransformId","_boundsLocalTransformId","interactive","children","selected","reference","EShapeBase","onTransformChange_","updateUploadedRecursively","parent_1","onChildTransformChange","invokeOnTransformChange","uploaded","_image","image","_points","root","visible","worldVisible","toDirty","at","detach","IDENTITY","childrenSerialized","child","src","toGradientId","pivot","shortcut","shortcutId","title","titleId","rotation","skew","fill","stroke","cursor","tag","radius","corner","serializeImage","serializeChildren","addUuid","updateUuid","s","rect","toLocalRect","WORK_RECT","containsAbs","containsText","containsChildren","world","tx","ty","th","tv","applyInverse","childResult","contains","containsAbsBBox","skipUpdate","copyFrom","worldTransform","bounds","_bounds","Rectangle","worldId","getWorldId","getBounds_","boundsInternal","_boundsInternal","currentLocalId","getLocalIdCurrent","boundsLocal","_boundsLocal","px","py","getBoundsSize","xmin","ymin","xmax","ymax","destroy","runtime","onStateChange","onParentChange","_state","setFocused","getFocusController","onKeyDown","onKeyUp","time","onRender","part","ALL","TRANSFORM","sourceTransform","SIZE","STYLE","ACTION","POINTS","sourcePoints","clone","STATE","lock","unlock","utils","EventEmitter","EShapeTagValueOrder","EShapeTagValueRangeType","DThemes","theme","DEFAULT_THEME_CLASS","INSTANCE","defaultThemeClass","getDefaultThemeClass","EShapeDefaults","_THEME","newTheme","getInstance","THEME","getFillColor","getFillAlpha","getStrokeColor","getStrokeAlpha","getStrokeWidth","getStrokeAlign","getStrokeSide","getTextValue","getTextColor","getTextAlpha","getTextFamily","getTextSize","getCursor","getRadius","getSizeX","getSizeY","getHighlightColor","enable","_enable","_color","_alpha","EShapeFillImpl","stringified","getFill","deserialized","setFill","side","_width","_align","_side","EShapeStrokeImpl","getStroke","setStroke","EShapeRuntimeReset","_type","_from","_to","EShapeTagValueRangeImpl","parent_2","to","parent_3","FROM","TO","parent_4","FROM_TO","copy_","parent_5","getRange","setRange","INDEX_COMPARATOR","initial","format","_value","_time","_capacity","_order","ASCENDING","EShapeTagValueImpl","newValue","formatter","capacity","order","unshift","count","shift","normalize","newTime","times","_times","parent_6","newTimes","parent_7","parent_8","parent_9","parent_10","sorted","slice","sort","parent_11","parent_12","idSerialized","addTag","initialSerialized","formatSerialized","rangeSerialized","getTagValue","setTagValue","tags","deserialize","EShapeTagImpl","inherited","RANGE_DUMMY","nvalue","EMPTY_ARRAY","valuesLength","getTag","setTag","deserializedLength","horizontal","vertical","_horizontal","_vertical","EShapeTextAlignImpl","getAlign","setAlign","EShapeTextOffsetImpl","getMargin","setMargin","EShapeTextOutlineImpl","getTextOutline","setTextOutline","family","_family","_weight","spacing","outline","_direction","_clipping","EShapeTextImpl","isCompatible","clipping","isChangedDirty","isChangedUploaded","alignSerialized","offsetSerialized","outlineSerialized","spacingSerialized","paddingSerialized","getText","setText","newFill","newStroke","_radius","RADIUS","_corner","newText","CURSOR","EShapePrimitive","ObservablePoint","onSizeChange","SIZE_X","SIZE_Y","FILL_COLOR","FILL_ALPHA","STROKE_COLOR","STROKE_ALPHA","STROKE_WIDTH","STROKE_ALIGN","STROKE_SIDE","TEXT_VALUE","TEXT_FAMILY","TEXT_SIZE","imageSrc","EShapeLineBase","container","getPixelScale","toThreshold","strokeScale","getStrokeWidthScale","toHitThreshold","calcHitPointAbs","calcHitPointAbsHitTester","d0x","d0y","d1x","d1y","BAR","EShapeBar","buildColor","colors","ic","buffer","transformLocalId","vertexOffset","vertexCount","indexOffset","indexCount","colorFill","alphaFill","colorStroke","alphaStroke","strokeAlign","strokeSide","texture","textureTransformId","EShapeUploadedBase","getLocalId","Texture","WHITE","textureAny","_uvs","updateUvs","_updateID","updateColorFills","colorFills","updateColorStrokes","colorStrokes","updateColorFill","updateColorStroke","builder","baseTexture","tvcount","ticount","textFamily","textTexture","textTextureTransformId","textColor","textAlpha","textOutlineColor","textOutlineAlpha","textVertexOffset","textIndexOffset","textVertexCount","textIndexCount","EShapeTextUploaded","updateClippings","updateIndices","updateTextVertex","updateTextColorFill","updateTextColorStroke","updateTextStep","updateColorFillAndStroke","toTextureTransformId","isCharChanged","isCharSizeChanged","isCharStyleChanged","isCharAlignChanged","isCharOffsetChanged","isCharSpacingChanged","isCharDirectionChanged","isClippingChanged","isTextureChanged","updateVertices","shapeSize","toTextureUvs","textOutline","updateSteps","buildUnit","textBaseTexture","pointsId","pointsStyle","EShapeBarUploaded","buildBarClipping","buildBarIndex","initText","updateVertexStepAndColorFill","updateColor","updateUv","updateText","isSizeChanged","isStrokeWidthChanged","toTransformLocalId","isTransformChanged","isPointsIdChanged","isPointsStyleChanged","pointValues","pointsSize","pv0","pv1","pv2","pv3","p2x","p2y","distance","ratio","p3x","p3y","scaleInvariant","icf","dash","dash0","dash1","buildBarVertexStepAndColorFill","iuv","toTexture","createBarUploaded","tcount","check","isArray","isNumber","UtilKeyboardEvent","which","ctrlKey","shiftKey","expressionOrShortcut","event_1","expression","arrowIndex","keyExpression","keys","split","setShortcutKeyAndWhich","alt","ctrl","event","parts","join","handler","toShortcut","document","body","addEventListener","altKey","isActionable","emit","preventDefault","picker","isBackward","isArrowUpKey","isForward","isArrowDownKey","moveFocus","isArrowLeftKey","isArrowRightKey","picked","focusController","focused","find","focus","EShapeActionValueBlinkType","actions","reset","written","effect","isStateChanged","EShapeRuntime","inDisabled","interactionManager","onDblClick","onDownThisBefore","findParent","onDownThisAfter","onClick","isActivateKey","onDown","onUp","onFocus","onBlur","isEffectTimeUp","disallowUploadedUpdate","onUpdate","allowUploadedUpdate","execute","doReset","POSITION_X","POSITION_Y","VISIBILITY","COLOR_FILL","COLOR_STROKE","COLOR_TEXT","COLOR_TEXT_OUTLINE","HEIGHT","WIDTH","ROTATION","TEXT","EShapeActionBases","EShapeActionExpressions","caster","def","defLiteral","nullable","parameter","Function","NULL","ZERO","ONE","ONE_HUNDRED","EMPTY","TRUE","FALSE","EShapeActionRuntime","condition","ofBoolean","interval","EShapeActionRuntimeBlink","dinterval","elapsed","toOff","toOn","EShapeActionRuntimeConditional","COLOR","EShapeActionRuntimeBlinkBrighten","toBaseFill","brighten","toBaseStroke","toBaseText","toBaseTextOutline","EShapeActionRuntimeBlinkColorFill","EShapeActionRuntimeBlinkColorStroke","EShapeActionRuntimeBlinkDarken","darken","COLOR_FILL_AND_STROKE","EShapeActionRuntimeBlinkOpacity","EShapeActionRuntimeBlinkVisibility","EShapeActionValueType","EShapeActionValueBase","toLabel","subtype","EShapeActionValueSubtyped","EShapeActionValueChangeColorTarget","EShapeActionValues","BLINK","EShapeActionValueBlink","BRIGHTEN","DARKEN","OPACITY","conditionId","toResource","UtilAlpha","alphaA","alphaB","w","EShapeActionRuntimeChangeColorBase","base","EShapeActionValueChangeColorType","EShapeActionValueChangeColorTypeLegacy","ALPHA","ofNumberOrNull","EShapeActionRuntimeChangeColor","EShapeActionValueChangeTextType","EShapeActionValueChangeColorTypes","CHANGE_COLOR","FILL","STROKE","FILL_AND_STROKE","TEXT_OUTLINE","types","EShapeActionValueChangeColor","blendId","brightness","EShapeActionRuntimeChangeColorBrightness","toAdjusted","EShapeActionValueChangeColorBrightness","BRIGHTNESS","brightnessId","EShapeActionRuntimeChangeColorCode","EShapeActionValueChangeColorCode","CODE","colorId","alphaId","name","ofStringOrNull","EShapeActionRuntimeChangeCursor","name_1","CHANGE_CURSOR","EShapeActionValueChangeCursor","nameId","FormatNodeA","step","date","getHours","FormatNodea","FormatNodeD","String","getDate","FormatNoded","precision","FormatNodee","toExponential","FormatNodePrecision","FormatNodef","toFixed","FormatNodefsi","toAbs","format_","unitInverse","postfix","FormatNodeg","toPrecision","FormatNodeH","FormatNodeh","FormatNodeM","getMonth","FormatNodem","getMinutes","FormatNodemi","getMilliseconds","FormatNodeP","FormatNodep","node","FormatNodePadding","FormatNodeParenthesis","FormatNodePlus","FormatNodeRP","round","FormatNoderp","Y","M","D","H","m","mi","FormatNodesdt","FormatNodeSpace","FormatNodessi","FormatNodeString","FormatNodeY","getFullYear","FormatNodey","FormatNodez","z","getTimezoneOffset","floor","FormatNoderd","FormatNodes","getSeconds","REGEXP","previousIndex","isDateRequired","nodes","lastIndex","matched","exec","all","modifier","toModifiedNodeDatetime2","toModifiedNodeDatetime3","toModifiedNodeNumber","Date","NumberFormatterImpl","setTime","NumberFormatters","number","ofNumber","formatters","EShapeActionRuntimeChangeTextNumber","newFormatter","getFormatter","ofString","EShapeActionRuntimeChangeTextText","DBorderMask","CHANGE_TEXT","EShapeActionValueChangeText","NUMBER","valueId","options","callback","_theme","_callback","background","DBaseBackground","getBackgroundColor","getBackgroundAlpha","DCornerMask","border","_mask","mask","DBaseBorder","getBorderColor","getBorderAlpha","getBorderWidth","getBorderAlign","getBorderMask","DBaseInteractive","DBaseCorner","getCornerRadius","getCornerMask","DLayoutClearType","NodeType","_offset","DBaseOutline","getOutlineColor","getOutlineAlpha","getOutlineWidth","getOutlineOffset","getOutlineAlign","getOutlineMask","_left","_top","_right","_bottom","left","top","right","bottom","DBasePadding","getPaddingLeft","getPaddingTop","getPaddingRight","getPaddingBottom","_point","DBasePoint","oldX","oldY","equals","borderSize","cornerMask","Float32Array","Uint16Array","_height","_texture","_borderSize","_cornerMask","_isDirty","_textureId","_vertexBuffer","getBuffer","_vertices","_uvBuffer","_indexBuffer","getIndex","_indices","DBaseBackgroundMeshGeometry","array","u0","u1","u2","u3","v0","v1","v2","v3","fillVertices","valid","textureId","getTextureId","h","ctl","TOP_LEFT","ctr","TOP_RIGHT","cbl","BOTTOM_LEFT","cbr","BOTTOM_RIGHT","ia","fillUvsCorner","fillIndices","fillUvs","MeshGeometry","MeshMaterial","DBaseBackgroundMesh","shader","geometry","_render","Mesh","_cornerRadius","DBaseBackgroundRenderable","cornerRadius","cornerHeight","_mesh","getBackgroundTexture","mesh","backgroundColor","getColor","backgroundAlpha","getAlpha","backgroundMesh","tint","hide","borderMask","_borderMask","DBaseBorderMeshGeometry","b1","b2","uz","vz","bt","bl","DBaseBorderMesh","_borderWidth","DBaseBorderRenderable","borderWidth","getBorderTexture","borderColor","borderAlpha","getWidth","getMask","borderMesh","borderOffset","_outlineWidth","DBaseOutlineRenderable","outlineMask","outlineColor","outlineAlpha","outlineMesh","outlineOffsetAccumulative","getOffset","_background","addRenderable","_border","_outline","addReflowable","DBaseReflowable","onReflow","DMouseModifier","TOKEN_MAPPING_OPERATOR","+","-","*","/","(",")",",","TOKEN_MAPPING_LITERAL","%","toToken","toParensesis","toUnary","toArithmetic","_node","DScalarExpression","ifrom","ito","nodeType","nodeTypePrev","jnode","toComma","operand","iprev","toCommaOf","toUnaryNode","operatorA","operatorB","toArithmeticNode","tokens","TOKEN_REGEX","token","tokenTypeOperator","parsedToken","parseFloat","tokenTypeLiteral","self","current","evaluate","args","POSITION_CENTER","POSITION_PADDING","SIZE_MAXIMIZED","SIZE_PADDING","DScalarFunctions","coordinate","scalarExpression_1","calculate","scalar_1","scalarExpression_2","scalar_2","UtilPointerEvent","touches","changedTouches","touch","mapPositionToPoint","clientX","clientY","global","CLICK_DISTANCE_THRESHOLD","touchable","isDowned_1","downX_1","downY_1","interactionManagerBound_1","cleanup_1","off","up_1","onUp_1","up","isValidDistance","down","global_1","global_2","plugins","interaction","once","onLongClick","isLongClickable","isDowned_2","downX_2","downY_2","timeoutId_1","interactionManagerBound_2","cleanupTimeout_1","clearTimeout","cleanup_2","up_2","onUp_2","move_1","onMove_1","move","global_3","originalEvent","setTimeout","LONG_CLICK_THRESHOLD","isDowned_3","downX_3","downY_3","clickTime_1","timeStamp","DBLCLICK_INTERVAL_THRESHOLD","item","targetOrChild","_isOn","DBaseAuto","toEnum","te","newX","newY","onMove","_scale","onScale","_skew","onSkew","_options","scalarSet","_scalarSet","_auto","DBaseAutoSet","_hasDirty","_isChildrenDirty","_shadow","toTheme","getThemeDefault","_befores","_afters","_reflowables","_clearType","getClearType","_padding","layout","toChildrenDirty","toDirtyAndUpdate","getX","getY","getHeight","getInteractive","SELF","interactiveChildren","CHILDREN","_title","getTitle","getWeight","initReflowable","_onShadowUpdateBound","shadow","getShadow","newShadowWeak","newShadow","over","onOver","out","onOut","isDirty","hasDirty","toParentHasDirty","toParentChildrenDirty","newParent","DBase","blur","shortcuts","_shortcuts","toShortcuts","onShortcutBound","onShortcut","addChild","_cursor","toCursor","renderable","phase","list","reflowable","reflowables","onChildrenChange","onParentMove","oldWidth","oldHeight","widthResized","heightResized","resized","onResize","getParentOfSize","getLeft","getTop","newWidth","newHeight","onParentResize","getType","scalar","toCoordinate","auto","isOn","isAuto","applyTitle","view","toHasDirty","onChildrenDirty","recursively","onChildFocus","blured","onChildBlur","setTheme","refit","onRefit","isWidthAuto","isHeightAuto","hasRefitableWidth","hasRefitableHeight","resize","getRight","getBottom","isRefitable","reflow","previous","removeReflowable","removeRenderable","addRenderableAt","parentWidth","parentHeight","parentPadding","paddingWidth","paddingHeight","deltas","isEventTarget","onDownThis","lastDownPoint","_lastDownPoint","focusOnClosest","onUpThis","worldAlpha","renderBefore","renderAfter","befores","before","afters","after","WORK_CONTAINS_POINT","addPoint","_calculateBounds","containsGlobalPoint","containsLocalPoint","Container","DBaseOverflowMask","tl","tr","beginFill","lineStyle","drawRect","arcTo","lineTo","endFill","Graphics","DDragMode","DMouseModifiers","oe","CTRL","ALT","SHIFT","OR","UtilHtmlElementWhen","DAnimationTimings","_startTime","_duration","duration","_durationInverse","_reverse","_onTime","onTime","_onTimeBaseBound","onTimeBase","_onStart","onStart","_onEnd","onEnd","_timing","timing","ELASTIC","DAnimationBase","reverse","stop","now","toTime","isReverse","elapsedTime","ds","dt","UtilDragEasingHistory","_histories","_historiesSorted","_historyBegin","_historyEnd","_dx","_dy","_ds","_dt","_animation","onEase","LINEAR","_durationPosition","_durationScale","_onMove","UtilDragEasing","histories","HISTORY_CAPACITY","oldHistoryEnd","newHistoryEnd","oldHistoryBegin","unsorted","total","history_1","history_2","history_3","ldt","adt","updateHistoriesSorted","sortedLength","history_4","d0","d1","animation","start","_modifier","_checker","checker","defaultChecker","match","toChecker","_interactionManager","_center","_scalingCenter","easing","_easing","onEasingMove","toEasingOptions","_onDownBound","_onMoveBound","_onEndBound","_down","_move","_up","bind","UtilDrag","center","touchesLength","first","centerX","centerY","squareDistance","stopPropagation","calcCenterAndScale","newScale","oldScale","oldTime","EPSILON","scalingCenter","toTarget","stopper","_toTarget","_stopper","mode","getDragMode","getDragModifier","getDragDurationPosition","getDragDurationScale","TOUCH","_bind","ON","_dragUtil","toNormalizedScale","scaleRatio","cx","cy","DViewDragImpl","dragUtil","_newScaleX","_newScaleY","_newX","_newY","_oldScaleX","_oldScaleY","_oldX","_oldY","DViewTransformImpl","scaleX","scaleY","_workRect","zoom","_zoomPoint","_zoomMin","getZoomMin","_zoomMax","getZoomMax","_zoomKeepRatio","keepRatio","getZoomKeepRatio","wheelZoom","wheel","_isWheelZoomEnabled","isWheelZoomEnabled","_wheelZoomSpeed","speed","getWheelZoomSpeed","_wheelZoomModifier","getWheelZoomModifier","_wheelZoomChecker","dblClickZoom","dblclick","_isDblClickZoomEnabled","isDblClickZoomEnabled","_dblClickZoomSpeed","getDblClickZoomSpeed","_dblClickZoomModifier","getDblClickZoomModifier","_dblClickZoomChecker","_dblclickZoomDuration","getDblClickZoomDuration","wheelTranslation","translation","_isWheelTranslationEnabled","isWheelTranslationEnabled","_wheelTranslationSpeed","getWheelTranslationSpeed","_wheelTranslationModifier","getWheelTranslationModifier","_wheelTranslationChecker","_drag","drag","_transform","DViewImpl","targetRect","getLocalBounds","newTargetX","newTargetY","targetX","targetY","targetWidth","targetHeight","newTargetScaleX","newTargetScaleY","newTargetScale","factor","targetScale","oldScaleX","oldScaleY","newScaleX","newScaleY","scaleRatioX","scaleRatioY","toLocal","zoomAt","toGlobal","deltaY","lowest","zoomAtGlobal","deltaX","DCanvasContainer","_canvas","_view","canvas","_canvasOptions","isOverflowMaskEnabled","getOverflowMask","updateContentSize","removeChild","_overflowMask","canvasX","canvasY","vresult","onWheel","sresult","overflowMask","EShapeActionRuntimes","toContainer","openByName","remote","EShapeActionRuntimeEmitEvent","EMIT_EVENT","EShapeActionValueEmitEvent","EShapeActionRuntimeMiscEmitEvent","DHtmlElementState","NO_POINTER_EVENTS","EShapeActionValueMiscType","operation","_operation","toData","_isElementShown","_onElementFocusBound","onElementFocus","_onBeforeFocusBound","onBeforeFocus","_onAfterFocusBound","onAfterFocus","_isStarted","_wasStarted","_doSelectBound","doSelect","_isStartRequested","when","ALWAYS","_onPostRenderBound","updateElement","_rendererBound","UtilHtmlElement","element","toElementOptions","clipper","toClipperOptions","toBeforeOptions","toAfterOptions","getWhen","select","getSelect","creator","getElementCreator","styler","newElementStyler","elementRect","elementMatrix","clipperRect","setElementStyle","getClipperCreator","newClipperStyler","setClipperStyle","getBeforeCreator","newBeforeStyler","setBeforeStyle","getAfterCreator","newAfterStyler","setAfterStyle","_element","CLICKED","DOUBLE_CLICKED","onEndByBlur","cancel","isStartable","doStart","_elementRectResult","getElementRect","getElementMatrix","_clipperRectResult","getClipperRect","rendererBound","getClipper","getBefore","getElement","getAfter","getResolution","toClipperRectAdjusted","getPadding","onElementAttached","display","scrollTop","scrollLeft","HTMLInputElement","HTMLTextAreaElement","onCancel","activeElement","containsPoint","mouse","onElementDetached","_before","_after","_clipper","removeEventListener","getElementContainer","focusable","stopImmediatePropagation","ex0","ey0","ex1","ey1","cx1","cy1","ncx0","ncx1","ncy0","ncy1","isFirst","getClippingRect","EShapeActionValueOnInputAction","onInputAction","elementCreator","ofElementOrNull","noPointerEvent","HTML_ELEMENT_WITHOUT_POINTER_EVENTS","EShapeActionRuntimeMiscHtmlElement","newUtil","newOperation","newUtilOptions","getClipperToRect","newElementCreator","toWhen","WORK","getUtil","_onInputKeyDownBound","onInputKeyDown","_onInputChangeBound","onInputChange","_onInputInputBound","onInputInput","_description","description","editing","_editingFormatter","getEditingFormatter","_editingUnformatter","unformatter","getEditingUnformatter","_editingValidator","validator","getEditingValidator","UtilInput","getInputType","fromValue","getValue","isOkKey","onEnter","isCancelKey","isShown","toValue","oldValue","onValueChange","valueAsString","onValueInput","_editingValidationResult","isInvalid","editingValidationResult","_step","getStep","_min","getMin","_max","getMax","UtilInputNumber","onStepChange","onMinChange","onMaxChange","updateStep","updateMin","updateMax","input","removeAttribute","DButtonBaseWhen","DAlignHorizontal","DAlignVertical","DAlignWith","EShapeActionValueOnInputActions","WRITE_LOCAL","write","WRITE_REMOTE","WRITE_BOTH","EShapeActionRuntimeMiscInput","EShapeActionRuntimeMiscInputInteger","EShapeActionRuntimeMiscInputReal","UtilInputText","EShapeActionRuntimeMiscInputText","ofUnknown","EShapeActionRuntimeMiscWrite","EShapeActionRuntimeMiscWriteBoth","EShapeActionRuntimeMiscWriteLocal","EShapeActionRuntimeMiscWriteRemote","MISC","EShapeActionValueMisc","INPUT_TEXT","INPUT_INTEGER","INPUT_REAL","HTML_ELEMENT","targetId","UtilAttachAlign","DDynamicTextMeasureResultCharacter","clipped","DDynamicTextMeasureResult","newLine","DDynamicTextMeasure","clippingWidth","RESULT","pop","DDynamicTextGeometry","vertexBuffer","uvBuffer","indexBuffer","measure","requiredTextSize","requiredVertexSize","requiredIndexSize","cw","ch","vo","_idApproved","defaultOptions","getDefaultOptions","_fontFamily","fontFamily","_fontSize","fontSize","_fontStyle","fontStyle","_fontVariant","fontVariant","_fontWeight","fontWeight","_fill","_fontIdId","_fontId","_fontIdApproved","_fillApproved","DDynamicTextStyle","DEFAULT_OPTIONS","getFontFamilly","getFontSize","newFontId","_isGeometryDirty","_atlas","update_","_text","_textApproved","_atlasRevisionUpdated","_clippingWidthDelta","DDynamicText","textApproved","fontId","fontIdApproved","fillApproved","approve","atlases","getDynamicFontAtlases","geometryWidth","geometryHeight","getRevisionUpdate","revisionUpdate","_clippingWidth","newClippingWidth","getClippingWidth","DImageBaseThemeWrapperSecondary","getSecondaryImageAlignHorizontal","getSecondaryImageAlignVertical","getSecondaryImageAlignWith","getSecondaryImageMarginHorizontal","getSecondaryImageMarginVertial","getSecondaryImageTintColor","getSecondaryImageTintAlpha","getSecondaryImageSource","DImageBaseThemeWrapperTertiary","getTertiaryImageAlignHorizontal","getTertiaryImageAlignVertical","getTertiaryImageAlignWith","getTertiaryImageMarginHorizontal","getTertiaryImageMarginVertial","getTertiaryImageTintColor","getTertiaryImageTintAlpha","getTertiaryImageSource","textAlign","_textAlign","with","getImageAlignWith","getImageAlignVertical","getImageAlignHorizontal","toImageAlign","_margin","margin","getImageMarginVertial","getImageMarginHorizontal","toImageMargin","_tint","_bound","_source","_computed","_onUpdateBound","DImagePiece","getImageSource","updateTint","bound","getImageTintColor","getImageTintAlpha","isTintAware","toTintColor","toTintAlpha","newComputed","computeSource","oldComputed","oldImage","onUpdateBound","Sprite","newImage","computed","DBaseOverflowMaskSimple","DTextBase","_textValue","newTextValue","_textValueComputed","computeTextValue","_textColor","_textAlpha","_textStyle","getFontWeight","getFontStyle","getFontVariant","getTextStyleClipping","toTextStyle","getTextAlignVertical","getTextAlignHorizontal","toTextAlign","_textFormatter","getTextFormatter","_textDynamic","dynamic","isTextDynamic","_isOverflowMaskEnabled","onTextChange","createOrUpdateText","updateTextValue","textValueComputed","formatted","createText","updateTextPosition","Text","scaleMode","SCALE_MODES","NEAREST","toRounded","newTextValueComputed","updateTextColor","DImageBase","_images","newImages","images","toImageOptions","hasSecondaryImageSource","hasTertiaryImageSource","imageSource","updateTextAndImage","pl","pr","pt","pb","noText","textLeftFirst","textTopFirst","textRightLastMargin","textBottomLastMargin","textLeft","textRight","textTop","textBottom","paddingLeft","paddingRight","paddingTop","paddingBottom","borderLeft","borderRight","borderTop","borderBottom","updateSource","updateBound","imageImage","imageBoundWidth","imageBound","imageBoundHeight","imageMargin","imageMarginHorizontal","imageMarginVertical","PADDING","BORDER","textLeftAdjust","textCenterAdjust","textRightAdjust","textTopAdjust","textMiddleAdjust","textBottomAdjust","setClippingWidthDelta","textWidth","textHeight","paddingCenterAdjust","paddingMiddleAdjust","borderCenterAdjust","borderMiddleAdjust","DButtonBase","_isToggle","toggle","isToggle","_when","initOnClick","initOnPress","group","onToggleStart","onToggleEnd","onActivate","onInactivate","onActivateKeyDown","onActivateKeyUp","DButton","DButtonPrimary","_shiftX","_shiftY","_onPrerenderBound","onPrerender","_onPostrenderBound","onPostrender","DAnimationFadeIn","_storedTime","removeEventListeners","_layer","_storedTarget","addEventListeners","storedTime","unsafe","_storedX","_storedY","_storedAlpha","DDialogCloseOn","DDialogMode","UtilAttach","offsetX","clippingHeight","LEFT_TOP","LEFT_MIDDLE","LEFT_BOTTOM","RIGHT_TOP","RIGHT_MIDDLE","RIGHT_BOTTOM","adjust","TOP_CENTER","BOTTOM_CENTER","OVER","clippingSize","DLayoutDirection","DDialogState","MODAL","MODELESS","MENU","UtilClickOutside","_application","last","UtilOverlay","DDialog","getMode","_mode","_sticky","sticky","isSticky","closeOn","_closeOn","DDialogAlign","_overlay","CLICK_OUTSIDE","onCloseOn","onAnimationEnd","_focusable","firstFocusable","owner","_promise","Promise","resolve","reject","_resolve","_reject","_owner","pick","onPrerenderBound","onOpen","getBounds","attach","getOffsetX","getOffsetY","getAnimation","doReject","onClose","reason","ESC","close","EShapeActionValueOpenType","DLayoutSpace","isVisible","DLayout","themeMargin","toMargin","getDirection","toDirection","_cornerAdjust","getCornerAdjust","toCornerAdjust","_multiplicity","row","column","getMultiplicity","toMultiplicity","getReverse","toReverse","multiplicity","clearType","BEFORE","AFTER","baseSize","VERTICAL","marginNext","getSpaceLeft","marginVertical","marginHorizontal","weightTotal","getWeightTotal","cornerAdjustWork","requiredSize","CORNER_ADJUST_WORK","irow","weightTotalInverse","spaceLeft","calcSpaceLeft","k","icolumn1","i1","irow1","icolumn0","i0","findRowIndexPrevious","hasClearTypeAfter","icolumn2","i2","findRowIndexNext","hasClearTypeBefore","ncolumn","countColumn","toCornerMaskColumn","icolumn","irow0","findColumnIndexPrevious","irow2","findColumnIndexNext","nrow","countRow","toCornerMaskRow","hasClearType","n","DLayoutHorizontal","DLayoutVertical","DDialogCommand","getLayoutX","getLayoutY","getLayoutWidth","getLayoutHeight","getLayoutMargin","onInit","ok","getOk","getCancel","buttonLayout","_buttonLayout","_buttonCancel","active","_buttonOk","onOk","getResolvedValue","doResolve","getRejectReason","DText","DDialogInput","labelOptions","toLabelOptions","_label","getMarginHorizontal","getMarginVertical","label","getLabel","_input","newInput","_buttons","_active","_onActiveBound","button","DButtonGroup","_isEnabled","newActive","oldActive","buttons","DInputBooleanButtonOff","DInputBooleanButtonOn","getButtonOff","getButtonOn","getButtonGroup","DInputBoolean","_buttonGroup","newButtonGroup","_buttonOn","newButtonOn","_buttonOff","newButtonOff","DDialogInputBoolean","toInputOptions","isOpened","EShapeActionRuntimeOpenDialog","target_1","initial_1","open","then","EShapeActionRuntimeOpen","ofBooleanOrFalse","EShapeActionRuntimeOpenDialogBoolean","dialog","DIALOG","DHtmlElement","_util","util","DInput","validate","DInputNumber","DInputInteger","DDialogInputInteger","EShapeActionRuntimeOpenDialogInteger","DInputReal","DDialogInputReal","EShapeActionRuntimeOpenDialogReal","DInputText","DDialogInputText","EShapeActionRuntimeOpenDialogText","EShapeActionRuntimeOpenDiagram","EShapeActionRuntimeOpenPage","EShapeActionRuntimeOpenPageInplace","location","href","DPickerDatetimeMask","DButtonAmbient","DPickerDatetimeButtonBack","DPickerDatetimeButtonDate","DPickerDatetimeButtonNext","DPickerDatetimeLabel","DPickerDatetimeLabelDate","DPickerDatetimeSpace","EShapeActionValueShowHideType","DPickerDatetimeMasks","themeOrThemeName","_date","_inclusive","inclusive","DPickerTimeBound","DPickerTimeBoundHours","lower","lowerDate","constant","DATE","hour","lowerDateHours","SECONDS","second","MINUTES","minute","upper","upperDate","upperDateHours","DPickerTimeBoundMinutes","HOURS","lowerDateMinutes","upperDateMinutes","DPickerTimeBoundSeconds","newConstant","hours","minutes","seconds","DPickerTimeBounds","test","getTime","setSeconds","setMinutes","setHours","setDate","am","bm","ad","bd","ah","bh","compare","toBoundOptions","onNewChange","DPickerTime","_dateCurrent","dateCurrentTime","_dateNew","_dateBounds","getLowerBound","isLowerBoundInclusive","getUpperBound","isUpperBoundInclusive","toBoundsOptions","newChildren","dateCurrent","dateNew","_inputHours","_inputMinutes","_inputSeconds","currentTime","onReset","dateBounds","inputHours","inputMinutes","inputSeconds","newInputHours","newInputMinutes","newInputSeconds","newTimeLayout","newTimeLayoutChildren","getTimeLayoutWidth","getTimeLayoutHeight","newMinuteSeparator","newSecondSeparator","getMinuteSeparator","getSecondSeparator","inputOptions","getHoursOptions","adjustInputOptions","onHoursChange","getMinutesOptions","onMinutesChange","getSecondsOptions","onSecondsChange","DPickerDatetime","_datePage","_dateButtons","newDateButtons","_dateDecorator","decorator","getDateDecorator","newLabel","newBackButton","newNextButton","newDateLabels","datePage","onPageChange","setFullYear","spaceCount","getDay","getDayStart","show","dateDecorator","dateCount","dateNewDate","labelText","labelTextAlign","getLabelFormatter","buttonOptions","back","getBackButtonOptions","getNextButtonOptions","dateLabels","getDayLabels","dayStart","newDateLabel","newSpace","newDateButton","onDateButtonClicked","setMonth","DDialogDatetime","new","page","_picker","EShapeActionRuntimeOpenDialogDatetime","toDate","toISOString","DDialogTime","isNaN","EShapeActionRuntimeOpenDialogTime","getPattern","toHours","toMinutes","toSeconds","milliseconds","toMilliseconds","setMilliseconds","toNumber","length_1","num","PATTERN","newPattern","FORMATTER","DPickerDate","DDialogDate","EShapeActionRuntimeOpenDialogDate","OPEN","EShapeActionValueOpen","DIAGRAM","PAGE","PAGE_INPLACE","DIALOG_TEXT","DIALOG_INTEGER","DIALOG_REAL","DIALOG_BOOLEAN","DIALOG_DATE","DIALOG_TIME","DIALOG_DATETIME","initialId","EShapeActionValueTransformMoveType","EShapeActionValueTransformType","visibility","SHOW","EShapeActionRuntimeShowHide","SHOW_HIDE","EShapeActionValueShowHide","EShapeActionRuntimeTransformMoveAbsoluteX","EShapeActionRuntimeTransformMove","EShapeActionRuntimeTransformMoveAbsoluteY","POSITION","EShapeActionRuntimeTransformMoveForwardOrBackward","writtenPositionX","writtenPositionY","oldPositionX","oldPositionY","EShapeActionRuntimeTransformMoveLeftOrRight","EShapeActionRuntimeTransformMoveRelativeX","EShapeActionRuntimeTransformMoveRelativeY","opetype","EShapeActionValueOpetyped","EShapeActionValueTransformResizeType","MOVE","EShapeActionValueTransformMove","ABSOLUTE_X","ABSOLUTE_Y","FORWARD_OR_BACKWARD","LEFT_OR_RIGHT","RELATIVE_X","RELATIVE_Y","amountId","EShapeSizes","centerMode","isPerfect","hsize","EShapeActionValueTransformRotateType","RELATIVE_SIZE","ofNumberOrOne","ABSOLUTE_SIZE","ofNumberOrOneHundred","RELATIVE_HEIGHT","ABSOLUTE_HEIGHT","RELATIVE_WIDTH","ABSOLUTE_WIDTH","EShapeActionRuntimeTransformResize","dsx","dsy","EShapeActionRuntimeTransformResizeHeightAbsolute","sizeAbsolute","oldSizeY","adjustPosition","EShapeActionRuntimeTransformResizeHeightRelative","sizeRelative","EShapeActionRuntimeTransformResizeSizeAbsolute","writtenWidth","writtenHeight","oldSizeX","EShapeActionRuntimeTransformResizeSizeRelative","EShapeActionRuntimeTransformResizeWidthAbsolute","EShapeActionRuntimeTransformResizeWidthRelative","RESIZE","EShapeActionValueTransformResize","EShapeActionRuntimeTransformRotate","oldRotation","newRotation","EShapeActionRuntimeTransformRotateAbsolute","EShapeActionRuntimeTransformRotateRelative","EShapeCapability","ROTATE","EShapeActionValueTransformRotate","ABSOLUTE","RELATIVE","EShapeActionValueDeserializer","getAction","toSerialized","CHANGE_COLOR_LEGACY","COLOR_AND_ALPHA","EShapeImageElements","dataUrl","imageElements","cachedImageElement","HTMLImageElement","imageElement","createElement","onload","onabort","onerror","EShapeDeserializer","shapeDeserializer","childrenPromise","childrenOrPromises","childSerialized","childOrPromise","toShape","serializedActions","gradientId","deserializeGradient","imagePromise","imageId","toImageElement","serializeds","shapes","resolved","jmax","deserializeBar","loadShapeBar","buildStep","swx","swy","STEP_VALUES","toStep","FMIN","dpc0","pc0","pc1","swc","pc","CIRCLE_WORLD_SIZE","CIRCLE_WORK_POINT","buildCircleClipping","buildCircleIndex","buildCircleVertex","worldSize","x4","y4","x7","y7","buildCircleStep","buildCircleUv","EShapeCircleUploaded","updateCircleVertexAndStep","updateCircleUv","isStrokeChanged","createCircle","CIRCLE","EShapeCircle","ay2","ax2","wx","wy","wx2","wy2","deserializeCircle","loadShapeCircle","EShapeStrokeSide","EShapeCapabilities","capability","mappings","PRIMITIVE","EShapeGroupUploaded","createGroupUploaded","pieces","pieceData","isEditMode","_actions","_fills","_strokes","_tags","_tagValues","_ranges","_aligns","_margins","_texts","_textOutlines","_extensions","EShapeResourceManagerDeserialization","tagValue","extension","EShapeGroupFillViewer","internalTransformParentInverse","EShapeTransforms","editor","EShapeEditor","invert","identity","disallowOnTransformChange","allowOnTransformChange","keepSize","newLocalTransform","append","applyLocal","rx","atan2","ry","shapeBase","EShapeGroupSizeLayout","baseX","baseY","pivotX","pivotY","childBase","WORK_TRANSFORM","translate","isFittable","_layouts","_isFittable","EShapeGroupSizeEditor","ox","oy","doFit","calcRect","_workRectForFit","layouts","workPoint","_workPoint","workRect","_workRectForCalcRect","getBoundsLocal","enlarge","onChange_","newLayout","_x","_y","_base","EShapeGroupSizeViewer","DLinkMenuItemId","EShapeGroupStrokeViewer","EShapeGroupTextAlignViewer","EShapeGroupTextOffsetViewer","EShapeGroupTextOutlineViewer","EShapeGroupTextPaddingViewer","EShapeGroupTextSpacingViewer","EShapeGroupTextViewer","_isEditMode","newTag","newGroupSize","newGroupFill","newGroupStroke","newGroupText","EShapeGroupViewer","isGroupSizeFittable","fit","LAYER","_name","EShapeEmbeddedLayer","newClone","EShapeEmbeddedLayerContainer","DDiagrams","version","thumbnail","tile","layers","items","snap","serializedLayers","serializedItems","shapePromises","deserializeAll","serializedItem","controller","newMappings_1","finished","onFinished","load","piece","getByName","found","toPieceDataSub","serializedOrSimple","EShapeEmbeddedDatum","pieceDataOrPromise","toPieceData","newLayer","EShapeGroupTextAlignEditor","EShapeGroupTextOffsetEditor","EShapeGroupTextOutlineEditor","EShapeGroupTextPaddingEditor","EShapeGroupTextSpacingEditor","EShapeGroupTextEditor","EMBEDDED","EShapeEmbedded","addPiece","EShapeEmbeddeds","from_","deserializeEmbedded","pieceId","pieceDatum","loadShapeEmbedded","EShapeGroupFillEditor","EShapeGroupPoints","toPoints","EShapeGroupStrokeEditor","GROUP","newGroupPoints","EShapeGroup","deserializeGroup","loadShapeGroup","EShapeGroupSizeShadowed","GROUP_SHADOWED","EShapeGroupShadowed","deserializeGroupShadowed","loadShapeGroupShadowed","RECTANGLE_VERTEX_COUNT","RECTANGLE_WORLD_SIZE","RECTANGLE_WORK_POINT","buildRectangleClipping","bri","buildRectangleClippingVertical","cbx","cby","buildRectangleIndex","buildRectangleVertex","bx1","by1","bx2","by2","buildRectangleVertexVertical","xc","yc","x5","y5","x6","y6","xcl","ycl","x8","y8","x9","y9","x10","y10","x11","y11","x12","y12","x13","y13","xcr","ycr","x14","y14","x15","y15","x16","y16","x17","y17","buildRectangleStep","worldSizeX","worldSizeY","swt","pt0","swr","pr0","swb","pb0","swl","pl0","pm0","buildRectangleStepVertical","buildRectangleStepHorizontal","buildRectangleUv","buildRectangleUvVertical","x01","y01","x02","y02","x23","y23","x03","y03","xbu","ybu","xbb","ybb","EShapeRectangleUploaded","updateVertexClippingStepAndUv","isVertexChanged","createRectangleUploaded","RECTANGLE","EShapeRectangle","TOP_OR_LEFT","BOTTOM_OR_LEFT","TOP_OR_RIGHT","BOTTOM_OR_RIGHT","IMAGE","EShapeImage","deserializeImage","loadShapeImage","IMAGE_SDF_WORLD_SIZE","IMAGE_SDF_FMIN","IMAGE_SDF_WORK_POINT","buildImageSdfClipping","buildImageSdfIndex","buildImageSdfStep","textureWidth","textureHeight","scaleBase","scaleZ","outlinePosition","buildImageSdfVertex","buildImageSdfUv","textureUv","EShapeImageSdfUploaded","updateVertexAndStep","isTextureSizeChanged","createImageSdfUploaded","IMAGE_SDF","EShapeImageSdf","deserializeImageSdf","EShapeLabelUploaded","updateLabelVertex","updateLabelUv","createLabelUploaded","LABEL","EShapeLabel","deserializeLabel","loadShapeLabel","toIndexOf","LINE_WORK_POINT","toLineVertexCount","pointCount","buildLineClipping","pointsClosed","icmax","buildLineIndex","iimax","io","buildLineUv","dx32","dy32","lengthInverse","iuvmax","buildLineVertexStepAndColorFill","pointSegments","lmax","lprev","lnext","llop","llo","pprevx","pprevy","pnextx","pnexty","pseg","psegnext","icfprev","loffset","pfirstx","pfirsty","psegfirst","pvl0","pvl1","plastx","plasty","pseglast","psecondx","psecondy","psegsecond","nextIndex","pvn0","pvn1","pnextxn","pnextyn","loffsetprev","pointId","EShapeLineUploaded","updateLineClipping","updateLineVertexStepAndColorFill","updateLineUv","CLOSED","isPointChanged","createLineUploaded","minX","maxX","minY","maxY","pointsLength","_valuesBase","_valuesBaseLength","_sizeBase","EShapeLinePoints","ssx","ssy","sizeBase","hasSizeBaseX","hasSizeBaseY","valuesBase","fitToParentSize","isUpdated","valuesBaseLength","newValuesLength","iupdate","newSegmentsLength","rangeResult","WORK_RANGE","lineOrPoints","LINE","EShapeLine","deserializeLine","getExtension","setExtension","loadShapeLine","toLineOfAnyPointCount","buildLineOfAnyColor","vcountPerPoint","colorDef","alphaDef","isStaticColor","isStaticAlpha","createLineOfAnyUploaded","icountPerPoint","buildNullClipping","buildNullVertex","buildNullStep","buildNullUv","copyClipping","icd","ics","copyIndex","idiv","iid","iis","copyStep","iss0","isd","iss","copyUvs","iuvd","iuvs","copyVertex","pointsValues","pointOffset","isStaticX","isStaticY","ip","ivd","ivs","isStatic","toComputed","EShapeLineOfAnyPointsFillImpl","defX","defY","_defX","_defY","_limit","_limitComputed","_limitId","_limitParentLength","EShapeLineOfAnyPointsPointImpl","limit","updateLimitComputed","limitId","limitParentLength","calcLimit","parentLenght","EShapeLineOfAnyPointsStrokeImpl","_valuesLength","_stroke","EShapeLineOfAnyPointsImpl","getLimit","o","pointCountReserved","pointSizeId","pointOffsetId","pointFillId","pointStrokeId","EShapeLineOfAnyUploaded","pointFill","isPointFillChanged","isFillEnabled","isFillChanged","pointStroke","isPointStrokeChanged","isStrokeEnabled","EShapeLineOfCirclesUploaded","updateLineOfAnyColorFill","updateLineOfAnyColorStroke","pointSize","isPointSizeChanged","pointSizeX","pointSizeY","voffsetReserved","vcountReserved","createLineOfCirclesUploaded","LINE_OF_CIRCLES","_tester","containsPointAbs","_testerBBox","containsPointAbsBBox","EShapeLineOfCircles","deserializeLineOfCircles","loadShapeLineOfCircles","RECTANGLE_ROUNDED_VERTEX_COUNT","RECTANGLE_ROUNDED_WORLD_SIZE","RECTANGLE_ROUNDED_WORK_POINT","buildRectangleRoundedIndex","buildRectangleRoundedVertex","dxh","dyh","dxhr","dyhr","dxv","dyv","dxvr","dyvr","x20","y20","x18","y18","x19","y19","x22","y22","x21","y21","buildRectangleRoundedClipping","rxc","ryc","buildRectangleRoundedStep","swtc","ptc0","swrc","prc0","swbc","pbc0","swlc","plc0","plr0","ptb0","buildRectangleRoundedUv","ruvx","ruvy","EShapeLineOfRectangleRoundedsUploaded","isCornerChanged","createLineOfRectangleRoundedsUploaded","RECTANGLE_ROUNDED","EShapeRectangleRounded","containsAbs_","wr","hasLeftSide","hasTopSide","hasBottomSide","hasRightSide","LINE_OF_RECTANGLE_ROUNDEDS","EShapeLineOfRectangleRoundeds","deserializeLineOfRectangleRoundeds","loadShapeLineOfRectangleRoundeds","BORDER_RADIUS","EShapeLineOfRectanglesUploaded","createLineOfRectanglesUploaded","LINE_OF_RECTANGLES","EShapeLineOfRectangles","deserializeLineOfRectangles","loadShapeLineOfRectangles","TRIANGLE_ROUNDED_VERTEX_COUNT","TRIANGLE_ROUNDED_WORLD_SIZE","TRIANGLE_ROUNDED_WORK_POINT","buildTriangleRoundedIndex","buildTriangleRoundedVertex","sz","sw","rz","dx14","dy14","dx47r","dy47r","dx71","dy71","xb","yb","buildTriangleRoundedClipping","buildTriangleRoundedStep","wsr","pr1","p0","p1","buildTriangleRoundedUv","EShapeLineOfTriangleRoundedsUploaded","isRadiusChanged","createLineOfTriangleRoundedsUploaded","TRIANGLE","EShapeTriangle","ay1","aw","TRIANGLE_ROUNDED","EShapeTriangleRounded","r12","r13","xl","yl","ni","nlx","nly","nrx","nry","det","deti","containsCorner_","az","c0","c1","c2","containsCorner","LINE_OF_TRIANGLE_ROUNDEDS","EShapeLineOfTriangleRoundeds","deserializeLineOfTriangleRoundeds","loadShapeLineOfTriangleRoundeds","TRIANGLE_WORLD_SIZE","TRIANGLE_WORK_POINT","buildTriangleClipping","buildTriangleIndex","buildTriangleVertex","buildTriangleStep","buildTriangleUv","EShapeLineOfTrianglesUploaded","updateVertexStepAndUvs","createLineOfTrianglesUploaded","LINE_OF_TRIANGLES","EShapeLineOfTriangles","deserializeLineOfTriangles","loadShapeLineOfTriangles","EShapeNullUploaded","createNullUploaded","EShapeNull","deserializeNull","loadShapeNull","deserializeRectangle","loadShapeRectangle","EShapeRectangleRoundedUploaded","createRectangleRoundedUploaded","deserializeRectangleRounded","loadShapeRectangleRounded","EShapeTriangleUploaded","updateVertexStepAndUv","createTriangleUploaded","deserializeTriangle","loadShapeTriangle","EShapeTriangleRoundedUploaded","createTriangleRoundedUploaded","deserializeTriangleRounded","loadShapeTriangleRounded","loadShapeAll","DImage","DListItem","onSelect","selection","hasSelection","getSelection","onKeyDownActivate","DMenuItem","getContext","getCloseable","DMenuItemText","initOnOver","initShortcuts","context","shortcutTextValue","_shortcutText","_shortcutMargin","getShortcutTextMargin","shortcutText","getShortcutColor","getShortcutAlpha","updateShortcutText","closeable","DMenuItemCheck","DLinkTarget","DMenus","CREATORS","CREATOR_DEFAULT","MENU_CREATOR","creators","creatorDefault","created","newItemOf","DisplayObject","newItem","newItemsOf","DLinkMenu","_menu","toMenu","menu","newMenu","OPEN_LINK_IN_NEW_WINDOW","COPY_LINK_ADDRESS","ESnapperTargetValueType","createRange","selectNodeContents","removeAllRanges","addRange","toClipboardData","clipboardData","UtilClipboard","clipboard","navigator","writeText","ClipboardEvent","setData","copyUsingWindow","div","setAttribute","textContent","appendChild","getData","execCommand","copyUsingDiv","userAgent","span","innerText","attachShadow","copyUsingSpan","_url","url","AUTO","getLinkMenuOptions","DLink","onResolved","ANCHOR_ELEMENT","toStringifiedUrl","toNormalizedUrl","inNewWindow","checked","a_1","rel","click","THIS_WINDOW","InteractionEvent","metaKey","menu_1","DLinks","DMenuItemLink","toUrl","_link","toLinkOptions","toStateOptions","DMenuItemMenu","initHover","onMenuSelect","isHidden","onKeyDownArrowRight","DMenuAlign","DListItemSeparatorReflowable","borderAlign","middle","DListItemSeparator","DMenuItemSeparator","DMenuItemSpace","loadMenuItem","addItemCreator","toSubMenuOptions","setItemCreatorDefault","DMenuItemExpandableBody","DMenuItemExpandableHeader","DMenuItemExpandables","DMenuItemExpandable","header","toHeader","_header","toBody","_body","newItems","onActivated","onDeactivated","newHeader","newBody","DMenuItemExpandableItemCheck","DMenuItemExpandableItemLink","DMenuItemExpandableItemSeparator","DMenuItemExpandableItemSpace","DMenuItemExpandableItemText","loadMenuItemExpandable","DMenuSidedItemCheck","DMenuSidedItemLink","DMenuSidedItemMenu","DMenuSidedItemSeparator","DMenuSidedItemSpace","DMenuSidedItemText","DMenuSideds","loadMenuSidedItem","DMenuSidedItemExpandables","DMenuSidedItemExpandable","DMenuSidedItemExpandableItemCheck","DMenuSidedItemExpandableItemLink","DMenuItemExpandableItemMenu","DMenuSidedItemExpandableItemMenu","DMenuSidedItemExpandableItemSeparator","DMenuSidedItemExpandableItemSpace","DMenuSidedItemExpandableItemText","loadMenuSidedItemExpandable","loadMenuItemAll","loadAll","_gl","_shaderProgram","_vertexPositionAttribute","_textureCoordAttribute","_samplerUniform","_sizeUniform","_vb","_uvb","_onLostBound","_onRestoreBound","restore","_onUnloadBound","DynamicSDFFontGenerator","isContextLost","config","antialias","depth","stencil","premultipliedAlpha","gl","clearColor","makeVertexBuffer","makeUvBuffer","makeShaders","createShader","FRAGMENT_SHADER","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","console","error","getShaderInfoLog","vertexShader","getShader","fragmentShader","shaderProgram","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","deleteShader","useProgram","getAttribLocation","getUniformLocation","getError","deleteProgram","viewport","createTexture","bindTexture","TEXTURE_2D","texImage2D","RGBA","UNSIGNED_BYTE","texParameteri","TEXTURE_WRAP_S","CLAMP_TO_EDGE","TEXTURE_WRAP_T","TEXTURE_MAG_FILTER","TEXTURE_MIN_FILTER","deleteTexture","vb","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","STATIC_DRAW","deleteBuffer","uvb","COLOR_BUFFER_BIT","vertexPositionAttribute","enableVertexAttribArray","vertexAttribPointer","FLOAT","textureCoordAttribute","activeTexture","TEXTURE0","uniform1i","uniform2f","drawArrays","TRIANGLE_STRIP","copyCanvas","copyContext","drawImage","destroyVertexBuffer","destroyUvBuffer","destroyShaders","WebGLLoseContext","loseContext","_INSTANCE","createImageSdf","convertToSdf","generator","updateTexture","read","toDataURL","units","EShapeBufferUnitBuilder","unit","EShapeBufferUnit","ntriangles","nindices","nvertices","_vertexCapacity","_vertexCount","_clippingBuffer","_stepBuffer","_colorFillBuffer","_colorStrokeBuffer","isIndicesShort","Uint32Array","_indexCapacity","_indexCount","indexCountRequested","_renderer","_builder","_geometry","EShapeBuffer","clippingBuffer","stepBuffer","colorFillBuffer","colorStrokeBuffer","Buffer","Geometry","addIndex","addAttribute","getGeometry","unitCount","DRAW_MODES","TRIANGLES","unit0","unit1","ioffset0","ioffset1","uniforms","sampler","draw","vindex","iindex","getVertexOffset","getIndexOffset","noMoreThanOne","getVertexCount","getIndexCount","creater","ref","frame","DynamicAtlasItem","resolutionInverse","DynamicAtlasItemEmpty","DynamicAtlasItemWhite","save","fillStyle","fillRect","_baseTexture","BaseTexture","mipmap","MIPMAP_MODES","OFF","_idToDatum","_sortedData","_predefined","empty","white","DynamicAtlas","maxRowHeight","datum","minHeight","applyFrame","ITEM_COMPARATOR","idToDatum","forcibly","cleanup","canvasWidth","calcCanvasWidth","canvasHeight","updateFrames","renderFrames","setRealSize","applyFrames","predefined","DynamicAtlasItemFontAtlas","ASCII_CHARACTERS","reserved","life","DynamicFontAtlasCharacterOrigin","_generator","_font","DynamicSDFFontAtlas","toFontFamily","italic","_characters","_length","addChar","DynamicFontAtlasCharacter","characterSize","toPowerOf2","textBaseline","lineCap","lineJoin","miterLimit","measureText","characterWidth","characterHeight","clearRect","fillText","toJson","getAutoFontFamily","FONT_FAMILY_AUTO","_atlases","DynamicSDFFontAtlases","addAscii","targets","newAtlas","baseAtlas","getBaseTexture","atlasId","DynamicAtlasItemImage","DUMMY_SHAPES","EShapeRendererIteratorDatum","_index","_datum","_current","EShapeRendererIterator","datumIndex","newDatum","EShapeRenderer","SHADER","Shader","_shader","_iterator","_bufferSizeMax","getBufferSizeMax","extensions","webGLVersion","uint32ElementIndex","fontAtlases","defaultTexture","textureItem","newTextureItem","updateAtlas","updateAtlases","fontAtlas","updateFontAtlas","updateFontAtlases","buffers","getBuffers","getAntialiasWeight","getAtlas","getFontAtlases","getDefaultTexture","repack","updateBuffers","pixelScale","toPixelScale","translationMatrix","setBlendMode","correctBlendMode","BLEND_MODES","buffersLength","upload","ib","bufferSize","bufferSizeBase","bufferSizeMax","jb","ibmax","ObjectRenderer","_childrenId","_childrenIdRendered","_fontAtlases","_pixelScale","_pixelScaleId","_work","_buffers","EShapeContainer","childrenId","childrenIdRendered","isChildrenDirty","shapeRenderer","_shapeRenderer","batch","setObjectRenderer","render_","worldID","childLocal","containsBBox","EShapeSearch","shapeA","shapeB","toDepth","isParent","shapeParent","findChildById","findChildByType","matcher","findChild","findChildrenByType","findChildren","EShapeDeleter","generateListOfDetachedShapes","COMPARATOR_INDEX","resourceToIndex","tagToIndex","pieceToIndex","uuids","uuidNext","EShapeResourceManagerSerialization","add_","newUuid","map","EShapeRuntimes","ESnapperGrid","ESnapperResult","snapped","newDistance","oldDistance","ESnapperModifierAnchor","ESnapperTargetValue","_isVisible","ESnapperTarget","valueA","UtilFileAs","_normals","_lengths","_workScale","_workSnapResultX","_workSnapResultY","_workScaleResult","_workTranslate","_workSnapRectangle","_workSnap","grid","ESnapper","prepare","delta","workTranslate","newDx","newDy","baseRotation","deltaRotation","gridSize","getGridSizeRotation","newRotationDegree","toDegree","newRotationDegreeResidual","toRadian","anchor","normals","lengths","calcNormalizedVector","MIDDLE_LEFT","MIDDLE_RIGHT","axis","normal","mx","setScaleSnappedResult","my","calcScaleSnapped1D","detA","mdx","mdy","pointO","pointX","pointY","calcScaleSnapped2D","calcScaleSnappedX","calcScaleSnappedY","calcScaleSnappedXY","DynamicAtlasItemText","hex2string","metrics","TextMetrics","measureFont","ascent","descent","fontColor","_context","DynamicFontAtlasFont","_unrefCount","_revision","_revisionUpdated","DynamicFontAtlas","getAdvance","remove_","strokeStyle","cleanup_","fontHeight","realWidth","realHeight","updateAll","colorToAltas","destroyAll","_resolution","DynamicFontAtlases","colorToAtlas","newInstance","Lazy","toCeilingIndex","toSvgUrl","svg","_ratio","_frames","_svg","_nextX","_nextY","UtilSvgAtlasBuilder","path","frames","build","built","_built","force","pow","log","LN2","scaling","frames_1","UtilExtractor","skipUpdateTransform","RenderTexture","matrix","renderTexture","pixels","Uint8Array","readPixels","ignorePremutipliedAlpha","canvasRenderTarget","CanvasRenderTarget","imageData","getImageData","Extract","arrayPostDivide","putImageData","scaledWidth","scaledHeight","scaledImageData","quality","UtilFileDownloader","filename","contents","insertBom","blob","Blob","msSaveBlob","downloadUrl","URL","createObjectURL","UtilExtract","toResolution","toSkipUpdateTransform","toRenderer","toPixels","premultiplied","ignore","toIgnorePremultipliedAlpha","toScale","toCanvas","toBase64","base64","DCommandFlag","as","facade","_as","_facade","UtilFileOpener","getOrCreateInput","input_1","files","file_1","FILE","fileReader","FileReader","onAboart","readAsText","DATA_URL","readAsDataURL","BINARY_STRING","readAsBinaryString","ARRAY_BUTTER","readAsArrayBuffer","file","UtilHsv","v","UtilName","mapping","_mapping","UtilPromise","UtilRgba","delay","_targets","_delay","_interval","_timeout","_updateBound","UtilStateBlinker","timeout","_backgroundCache","_backgroundAttribute","_borderCache","_borderAttribute","_onUpdate","UtilTexturePlane","attr","realRadius","realSize","toCornerBr","toCornerTl","toSvg","make","cache","newBackground","maskToTexture","newBorder","UtilTexture","onLoad","_lastUpdate","_updateId","UtilTransition","updateId","lastUpdate","remaining","_names","documentMode","UtilWheelEvent","useCapture","names","name_2","_lineHeight","getLineHeight","_pageHeight","detail","wheelDelta","wheelDeltaY","wheelDeltaX","HORIZONTAL_AXIS","_timestamp","_lowest","shouldAdjust","deltaMode","getPageHeight","DAnimationEmpty","DApplicationPadding","_root","overlay","getBoundingClientRect","bbox","transparent","_pixi","autoStart","DApplicationLayerOptions","updateWidthAndHeight","pixi","DControllerDefaultFocus","_focused","mightBeFocusable","includesTarget","includesTargetChildren","findNext","childrenLength","findPrevious","isFocusableContainer","inEnabled","DListSelectionMode","DCommandClear","UNSTORABLE","CLEAR","DCommandRedo","DCommandUndo","isCommandStorable","command","getFlag","_done","_waiting","_executing","DControllerDefaultCommand","done","waiting","command_1","undo","onSuccess","onFail","redo","isClear","isStorable","isRedoable","isUndoable","DControllerKeyboard","hasOnKeyDown","isFocusKey","getFocusDirection","hasOnKeyUp","DControllers","KEYBOARD","COMMAND","DOCUMENT","getPixiApplicationOptions","isOverlay","_isOverlay","rootElement","getRootElement","_rootElement","_refitLimit","_reflowLimit","_renderBound","_renderId","elementContainer","newElementContainer","_elementContainer","viewStyle","initRootElement","hasFocus","onBlurBound","getKeyboardController","onResizeBound","wheelGlobal","wheelEventUtil","wheelEvent","hitTest","DApplicationLayer","insertionPosition","insertBefore","oldOnChildrenChange_1","onStageDirty","rootElementStyle","getComputedStyle","overflow","bboxWidth","bboxHeight","requestAnimationFrame","screen","ilimit","_focus","_dynamicFontAtlases","Application","toRootElement","Renderer","__plugins","accessibility","newLayerBase","_isOverlayEnabled","DApplication","querySelector","toLayerBaseOptions","toLayerOverlayOptions","newLayerOverlay","DBoard","DButtonCheck","DButtonCheckRight","_selected","DColorGradientPointObservable","POINT_SORTER","_onChangeBound","_workColor","DColorGradientObservable","isSelectionChanged","rgb0","hex2rgb","r0","g0","b0","rgb1","r1","g1","rgb","rgb2hex","oldDirection","oldSelected","pointsCopy","pointLike","DInputLabel","createInput","space","DInputAndLabel","DInputRealAndLabel","DInputTextAndLabel","colorAndAlpha","onColorChange","onAlphaChange","_colorAndAlpha","_onColorChange","_onAlphaChange","DPickerColorAndAlpha","recents","_recents","DPickerColorRecent","recent","DPickerColor","_currentPicker","_newPicker","_recent","_new","setColorNew","setAlphaNew","setColorCurrent","setAlphaCurrent","_pointerPoint","mainWidth","getMainWidth","mainHeight","getMainHeight","mainBaseSprite","_mainBaseSprite","mainSprite","getMainTexture","_mainSprite","_onMainMoveBound","onMainMove","_onMainUpBound","onMainUp","onMainDown","baseSprite","_baseSprite","getBaseMargin","_onBaseMoveBound","onBaseMove","_onBaseUpBound","onBaseUp","onBaseDown","alphaCheckerboardSprite","getAlphaCheckerboardTexture","_alphaCheckerboardSprite","getBaseHeight","alphaSprite","getAlphaTexture","_onAlphaMoveBound","onAlphaMove","_onAlphaUpBound","onAlphaUp","onAlphaDown","mainPointerSprite","getMainPointerTexture","_mainPointerSprite","getMainPointerColor","getMainPointerAlpha","alphaPointerSprite","getAlphaPointerTexture","_alphaPointerSprite","getAlphaPointerColor","getAlphaPointerAlpha","basePointerSprite","getBasePointerTexture","_basePointerSprite","getBasePointerColor","getBasePointerAlpha","_recentColorSprites","recentColorSprites","recentColorCount","getRecentColorCount","recentColorWidth","getRecentColorWidth","recentColorHeight","getRecentColorHeight","recentColorWidthHalf","recentColorHeightHalf","recentColorMargin","getRecentColorMargin","recentColorY","getAlphaHeight","getRecentMargin","recentCheckerboardTexture","getRecentCheckerboardTexture","RECENT_COLORS","getRecents","onRecentChange","onRecentClick","checkerboardSprite","currentTarget","sprite","buttonMode","recentColorAndAlpha","inputMargin","getInputMargin","inputLabelWidth","getInputLabelWidth","inputY","inputWidth","inputAndLabelColor","fromCode","_inputAndLabelColor","inputHeight","inputAndLabelAlpha","_inputAndLabelAlpha","sampleWidth","sampleHeight","sampleX","sampleY","sampleCurrentCheckerboardSprite","getSampleCheckerboardTexture","_sampleCurrentCheckerboardSprite","sampleCurrentSprite","_sampleCurrentSprite","sampleNewCheckerboardSprite","_sampleNewCheckerboardSprite","sampleNewSprite","_sampleNewSprite","onMainPick","hw","ux","uy","toMainHex","onColorNew","toMainColor","hsv","fromRgb","toRgb","ns","nv","onBasePick","toBaseHex","onColorBase","toBaseColor","onAlphaPick","onAlphaNew","sprites","isEqual","ap","bp","apj","bpj","DPickerColorGradientRecent","nPointsPerData","_nPointsPerData","_colors","_lastHitIndex","_parts","uSampler","DPickerColorGradientView","setColors","setColorsHex","setColorsWhite","setVertices","setUvs","newIndices","setColorsPoint","checkerColors","uCheckerColors","DPickerColorGradient","gradientPointsWidth","getGradientPointsWidth","gradientPointsMargin","getGradientPointsMargin","onAnchorColorChange","onAnchorAlphaChange","getGradientCheckerColors","setRectangle","getLastHitIndex","onViewDown","_onAnchorDownBound","onAnchorDown","_onAnchorMoveBound","onAnchorMove","_onAnchorUpBound","onAnchorUp","_anchors","inputDirectionMargin","getGradientDirectionMargin","inputDirectionTexture","getGradientDirectionTexture","inputLeft","inputDirection","change","recentColumn","getGradientRecentColumn","recentWidth","getGradientRecentWidth","recentMargin","getGradientRecentMargin","recentWidthAndMargin","RECENT_COLOR_GRADIENT","getGradientRecents","getGradientRecentCount","getCapacity","onRecentUpdate","lastHitIndex","updateAnchors","onAnchorSelect","recentData","fromObject","addAt","toAnchorPosition","onAnchorDragStart","anchorTexture","getGradientAnchorTexture","anchorOutlinedTexture","getGradientAnchorOutlinedTexture","anchors","anchorSize","newAnchor","oldAnchor","isDeleteKey","DDialogColorGradient","DButtonColorGradient","getViewBaseTexture","checkers","getCheckerColors","_dialog","DDialogColor","DButtonColor","updateTextForcibly","dialogCurrent","dialogNew","toClone","toImageTintOptions","DButtonDanger","DDialogDates","DButtonDate","DDialogDatetimes","DPickerDates","DPickerTimes","DPickerDatetimes","hms","DButtonDatetime","_datetimeMask","toMask","DButtonFileAs","DButtonFile","_opener","newOpener","onResolve","getChecker","getOpener","DButtonLink","link","DButtonRadio","DButtonRadioRight","commandController","getCommandController","DButtonRedo","DButtonSecondary","DChartAxisPosition","DChartAxisTickPosition","content","_content","SINGLE","DListSelection","getChildIndex","MULTIPLE","targetIndex","DContent","DScrollBar","_start","_end","thumb","_thumb","createThumb","onRegionChange","DScrollBarThumb","onDragMove","getThumbMinimumLength","DScrollBarThumbReflowableHorizontal","DScrollBarThumbHorizontal","DScrollBarHorizontal","getLocalPosition","newStart","thumbMinimumLength","getMinimumLength","barStart","barLength","DScrollBarThumbReflowableVertical","DScrollBarThumbVertocal","DScrollBarVertical","DPane","toContent","scrollbar","newScrollBar","_scrollbar","onRegionMoveY","onRegionMoveX","onContentChange","updateScrollBar","initDrag","dragMode","position_1","toContentX","toContentY","newContent","getWheelContentX","getWheelContentY","getWheelSpeed","updateScrollBarRegions","updateScrollBarVisibilities","updateScrollBarPositions","verticalWidth","verticalOffsetStart","getScrollBarOffsetVerticalStart","verticalOffsetEnd","getScrollBarOffsetVerticalEnd","horizontalHeight","horizontalOffsetStart","getScrollBarOffsetHorizontalStart","horizontalOffsetEnd","getScrollBarOffsetHorizontalEnd","setRegion","isChangedHorizontal","updateScrollBarVisibility","isChangedVertical","isRegionVisible","contentX","contentY","contentWidth","contentHeight","WORK_POINT","clippingRect","WORK_RECTANGLE","getFocusedChildClippingRect","clippingRectX","clippingRectY","clippingRectX0","clippingRectY0","clippingRectX1","clippingRectY1","contentPosition","DList","_selection","newSelection","updateChildPosition","updateChildVisibility","scrollLimit","itemY","moveFocusVertically","DDialogSelectList","DDialogSelectListItem","search","_search","_","_idCompleted","_result","DDialogSelectSearh","searchResult","DNote","toNoteOptions","DDialogSelect","_itemToLabel","getItemToLabel","_itemIsEqual","getItemIsEqual","_itemPredefineds","predefineds","_list","noteNoItems","getNoteNoItemsText","note","noItems","_noteNoItems","noteSearching","getNoteSearchingText","searching","_noteSearching","toSearch","results","onSearched","transition","isDone","getResult","resultsLength","predefinedsLength","totalLength","minLength","newChild","defaultGetter","defaultSetter","dialogFormatter","toOptions","_dialogGetter","getter","_dialogSetter","setter","DButtonSelect","DDialogTimes","DButtonTime","DButtonUndo","DCanvas","DChartCoordinateDirection","EShapePointsStyles","_coordinateIndex","toPosition","_tick","toTickContainer","_bar","toBar","DChartAxisBaseOptionParser","getPosition","getStyle","toBarStroke","tick","getTickEnable","major","toTickMajor","minor","toMinorTick","getMajorTickPosition","optionsStyle","getMajorTickStyle","optionsStroke","toTickMajorStroke","getMajorTickCount","getMajorTickSize","toTickPosition","toMajorTickText","toMajorTickFormatter","gridline","toTickMajorGridline","getMajorTickGridlineStyle","getMajorTickGridlineEnable","toTickMajorGridlineStroke","tickPosition","OUTSIDE","getMinorTickPosition","getMinorTickStyle","getMinorTickCount","getMinorTickSize","toTickMinorStroke","toStroke","getStrokeEnable","optionsA","optionsB","getMajorTickStrokeEnable","getMajorTickStrokeColor","getMajorTickStrokeAlpha","getMajorTickStrokeWidth","getMajorTickStrokeAlign","getMajorTickStrokeSide","getMajorTickGridlineStrokeEnable","getMajorTickGridlineStrokeColor","getMajorTickGridlineStrokeAlpha","getMajorTickGridlineStrokeWidth","getMajorTickGridlineStrokeAlign","getMajorTickGridlineStrokeSide","getMinorTickStrokeEnable","getMinorTickStrokeColor","getMinorTickStrokeAlpha","getMinorTickStrokeWidth","getMinorTickStrokeAlign","getMinorTickStrokeSide","getMajorTickTextFormat","toMajorTickTextColor","toMajorTickTextAlign","toMajorTickTextOffset","toMajorTickTextOutline","toMajorTickTextSpacing","toTickMajorTextDirection","toMajorTickTextPadding","getMajorTickTextAlignHorizontal","getMajorTickTextAlignVertical","getMajorTickTextPaddingHorizontal","getMajorTickTextPaddingVertical","getMajorTickTextDirection","getMajorTickTextColor","toLabelColor","toLabelAlign","toLabelOffset","toLabelOutline","toLabelSpacing","toLabelDirection","toLabelPadding","getLabelAlignHorizontal","getLabelAlignVertical","getLabelPaddingHorizontal","getLabelPaddingVertical","getLabelDirection","getLabelColor","parser","coordinateIndex","bar","_majorTicks","Float64Array","_minorTicks","DChartAxisBase","barShape","plotArea","plotAreaWidth","plotAreaHeight","domainMin","domainMax","majorShapes","minorShapes","gridlineShapes","shapePositionY","majorCount","majorFormatter","minorCountPerMajor","minorCount","majorTicks","minorTicks","ticks","majorShape","imajorTick","majorTickPosition","majotTickPositionX","majorTickStep","gridlineShape","minorShape","iminorTick","minorTickPosition","minorTickProjectedPosition","shapePositionX","majotTickPositionY","getBoundsInContainer","domainFrom","unmap","domainTo","updateTicksX","updateTicksY","_container","tickShapeContainer","barPosition","tickMajor","gridlinePosition","gridlineCount","gridlineStyle","tickMajorShapes","tickMajorCount","tickMajorSize","tickMajorPosition","tickMajorStyle","tickMajorShape","tickMinor","tickMinorShapes","tickMinorCount","tickMinorSize","tickMinorPosition","tickMinorStyle","tickMinorShape","tickMajorGridlineShapes","updateBar","updateTicks","_plotArea","DChartAxisContainerImpl","axes","DChartAxisX","DChartAxisXDatetime","DChartAxisY","DCHART_COLOR_SET_1","DCHART_COLOR_SET_2","DChartColorSet2","DChartSelectionPoint","DChartCoordinateContainerSubImpl","coordinateOrIndex","unbind","mark","X","cxs","cys","DChartCoordinateContainerImpl","rangeFrom","rangeTo","DChartCoordinateLinearTick","power","LN10","toStepScale","majorPosition","rangeMin","rangeMax","iresult","minorPosition","majorResult","minorResult","majorStep","calcStepMajor","imajorResult","iminorResult","idomainStart","idomainEnd","minorStep","calcStepMinor","imajor","iminor","majorProjectedPosition","minorProjectedPosition","_translate","_itranslate","_iscale","DChartCoordinateTransformImpl","isZero","ratioi","newTranslate","oldTranslate","stride","itranslate","iscale","DChartCoordinateTransformMarkImpl","DChartRegionImpl","_mark","DChartCoordinateLinear","doFit_","toFitDomain","toFitRange","series","getDomain","pixelFrom","pixelTo","region","regionFrom","regionTo","regionSize","newTranslation","DChartCoordinateLogTick","domainFromMapped","domainToMapped","domainMinMapped","domainMaxMapped","majorStepMapped","idomainStartMapped","idomainEndMapped","minorStepMapped","majorPositionMapped","minorPositionMapped","DChartCoordinateLog","regionFromMapped","regionSizeMapped","DChartLegendItem","DChartLegend","DChartOverview","DChartPlotAreaContainer","_lastBoundsID","getBoundsInternal","DChartSeriesHitResult","DChartSeriesFillComputedImpl","DChartSeriesScalars","outer","inner","DChartSeriesPaddingComputedImpl","DChartSeriesPointComputedImpl","DChartSeriesStrokeComputedImpl","_domain","_range","DChartSeriesFillImpl","DChartSeriesStrokeImpl","DChartSeriesPointImpl","DChartSeriesPaddingImpl","listLength","DChartSeriesContainerImpl","domain","tmp1","tmp2","WORK_CALCHITPOINT","closest","calcHitPoint","chart","_chart","_blendStartTime","_blendDuration","_blendTimeout","_onBlendBound","onBlend","DChartPlotArea","_isViewDirty","_isBoundsInContainerDirty","_coordinate","_series","_axis","_boundsInContainer","blendTimeout","DChartRegionImplObservable","newFrom","newTo","_coordinateIndexX","_coordinateIndexY","_coordinateIdUpdatedX","_coordinateIdUpdatedY","_coordinateTransformIdUpdatedX","_coordinateTransformIdUpdatedY","DChartSeriesBaseCoordinateContainer","coordinateX","coordinateY","coordinateIdX","coordinateIdY","isCoordinateXChanged","isCoordinateYChanged","coordinateTransformIdX","coordinateTransformIdY","isCoordinateTransformXChanged","isCoordinateTransformYChanged","_regionPointId","DChartSeriesBase","updateRegion","_line","_pointId","_pointIdUpdated","DChartSeriesLineOfAny","line","newLineOfAny","initLine","sizeDefault","getSizeDefault","offsetDefault","getOffsetDefault","newOffset","isCoordinateChanged","isCoordinateTransformChanged","isTransformDirty","updateLine","xcoordinate","ycoordinate","ivalues","mapAll","adjustLineRegion","WORK_REGION","applyLine","calcRegion","xraw","yraw","calcHitPointTestRange","calcHitPointHitTester","_barCount","_barIndex","_xcoordinateId","_xcoordinateTransformId","_isSizeAutomatic","DChartSeriesBar","newPadding","barIndex","barCount","xcoordinateId","xcoordinateTransformId","updateBarCountAndIndex","totalBandWidth","totalBarWidth","barWidth","barX","sizes","sizesLength","offsets","offsetsLength","isize","calcSizeX","sxh","DChartSeriesLineOfCircles","DChartSeriesLineOfRectangleRoundeds","DChartSeriesLineOfRectangles","_sizeId","DChartSeriesLineOfTriangles","DChartSeriesLineOfTriangleRoundeds","_centerX","_centerY","DChartSeriesLine","isPointsDirty","segmentsLength","isegments","segment","_idUpdated","_a","_b","_x0","_y0","DChartSeriesExpressionParametersImpl","_plotAreaSizeXUpdated","_plotAreaSizeYUpdated","_parameters","DChartSeriesLinear","parameters","isParametersChanged","isPlotAreaSizeChagned","toClean","plotAreaSizeX","plotAreaSizeY","aabs","babs","xfrom0","xto0","xfrom1","xto1","yfrom0","yto0","yfrom1","yto1","_shape","setStyle","DChartSelectionShapeBase","newShape","mappedPosition","seriesShape","getTheme","DChartSelectionGridlineX","mappedX","DChartSelectionGridlineY","mappedY","DChartSelectionGridlineContainerImpl","unset","DChartSelectionMarker","_gridline","_marker","marker","_coordinateX","_coordinateY","CLOSER","DChartSelectionSubImpl","PREVIOUS","NEXT","oldSeries","newSelected","_hovered","newHovered","hovered","_onClickBound","DChartSelectionSimple","toSubOptions","gridlineX","gridlineY","WORK_SELECT","DChart","_destroyed","DCommandCreate","DCommandDelete","getDocumentController","DCommandSaveAs","saveAs","DCommandSave","DDiagramCanvasEditorBackground","baseColor","DDiagramCanvasTileMappingPointImpl","lon","lat","cb","mappingOrEnable","lon0","lat0","lon1","lat1","_cb","DDiagramCanvasTileMappingImpl","_factory","factory","onMappingChange","DDiagramCanvasTile","pyramid","_pyramid","DDiagramLayer","DDiagramLayerContainer","activate","addChildAt","activateNext","toBackgroundAmbient","toBackgroundColorBase","_tile","DDiagramCanvasBase","ambient","getBackgroundAmbient","backgroundBase","getBackgroundBase","snapper","_snapper","snapperGraphics","_snapperGraphics","DDiagramCanvasEditor","interactives","actionables","ids","_workLocal","_workGlobal","_lastOverShape","DDiagramCanvas","initializeShapes","updateShapes","initializeFocus","shapeId","this_1","lastOverShape","previousRuntime","lastOverParent","parentRuntime","DDiagramSnapshot","extractor","viewPosition","viewScale","_serialized","_tileFactory","_controller","_backgroundAmbient","_snapshot","DDiagramBase","oldSerialized","onUnset","onSet","newCanvas","initialize","toBackground","backgroundAmbient","backgroundSerialized","diagramOptions","diagramBackgroundOptions","tileOptions","snapshot","isThumbnailEnabled","getThumbnailSize","DDiagramEditorThumbnail","createAsUrl","_isChanged","_thumbnail","DDiagramEditor","toCanvasOptions","toCanvasBaseOptions","simple","toSimple","newId","isNew","diagram","_diagram","DDiagramShape","actionable","runtimeEffect","DDiagramTagRemote","_mapper","mapper","_remote","DDiagramTag","tagValues","onShapeMove","onShapeUp","onShapeClick","DDiagram","tagShape","tagMapper","formatterMap","initialMap","actionMap","runtimeConstructor","tagFormat","tagInitial","toRuntime","toTagShape","onShapeDown","onShapeDblClick","DDialogConfirmMessage","DDialogConfirm","message","newMessage","toMessageOptions","toMessageOptionsMerged","getMessage","_message","toMessage","DDialogConfirmDelete","DDialogConfirmDiscard","DDialogMessage","DDialogProcessingMessage","_isDone","_delayDone","getDoneDelay","delayClose","_delayClose","getCloseDelay","_messageText","DDialogProcessing","timeoutId","_timeoutId","closeTimeoutId","_closeTimeoutId","onDone","onRejected","DDialogSaveAs","getName","_closeables","DMenuContext","closeables","imin","DMenu","_fit","_sub","setMenuCreator","DMenuSidedSelectionMode","DDropdownBase","onMenuSelectBound","_onMenuSelectBound","onMenuCloseBound","_onMenuCloseBound","toMenuOptions","onKeyDownArrowDown","onMenuClose","DDropdown","DExpandableHeader","DExpandable","DInputIntegerAndLabel","tileSize","_tileSize","DMapCoordinateEPSG3857","lonlat","meters","C","CIRCUMFERENCE_HALF","tan","atan","exp","tz","R","Z","metersToTile","lonLatToMeters","metersToPixels","metersToLonLat","pixelsToMeters","toResolutionMeter","DMapCoordinates","_default","_sprite","DMapTile","onLoaded","BaseImageResource","_onLoaded","_isOnLoadedCalled","_isOnLoadedAllowed","_onLoadedBound","_tz","_lon0","_lat0","_lon1","_lat1","_tiles","_renderTileBound","renderTile","_txmin","_txmax","_tymin","_tymax","_deleteTileBound","tileCode","tiles","deleteTile","_destroyTileBound","destroyTile","_updateLoadingStateForEach","loaded","_isLoaded","_tileCount","toTileCount","_tileScaleRelative","_tileScale","getTileSize","DMapTilePlane","oldLon0","oldLat0","oldLon1","oldLat1","lonLatToTile","tx1","ty1","tileCount","txmin","txmax","tymin","tymax","dtxmin","dtxmax","dtymin","dtymax","isTxMinChanged","isTxMaxChanged","isTyMinChanged","isTyMaxChanged","ctx","cty","ltx","lty","lt","toOffset","loadTile","it","txa","loadTilesY","txb","tya","loadTilesX","tyb","toTileCode","toTilePosition","newTile","tileScaleRelative","tileToPixels","updateLoadingState","tileScale","mappingLonLat","_mappingInternal","toMapping","_z","_minZ","plane","_maxZ","_planes","_fitBound","_fitBoundTimeout","_fitThrottle","throttle","fitThrottledBound","_fitThrottledBound","fitThrottled","DMapTilePyramidImpl","WORK_LONLAT","lonLatToPixels","dmin","oldMapping","newMapping","planes","planeTz","toZ","toTileZ","newPlane","pixelsToLonLat","destroyPlanesBefore","destroyPlanesAfter","DMapTileUrlBuilderOsmfj","DMapTilePyramids","MIN","MAX","THROTTLE","DEFAULT","toPlaneOptions","DMenuBarItem","DMenuBar","toItem","moveFocusHorizontally","DMenuSidedContent","DTableColumnType","defaultFilter","_item","_filter","filter","getFilterDefault","DMenuSidedSelection","set_","hasMenu","oldItem","setState","DMenuSided","DPaginationDotsButton","DPaginationDynamicButtons","_dotsBtnLeft","dotsLeft","_dotsBtnRight","dotsRight","btnsCount","pageButtons","btn","clickedBtn","DPaginationNavigationButton","DPagination","DEFAULT_SELECTED","_total","_buttonOptions","initButtons","getButtonWidth","listenButtonClicked","_numberPageButtonVisible","toNumberVisible","isInteger","_lastPageBtn","_previousBtn","pagination_navigation_button_previous","_nextBtn","pagination_navigation_button_next","_goFirstBtn","pagination_navigation_button_go_first","_goLastBtn","pagination_navigation_button_go_last","_dynamicPageBtns","_firstPageBtn","onClickPageButton","startDynamic","endDynamic","numberButtonsInLeft","numberButtonsInRight","updateStaticButtons","numberButtonsFirstToCenter","numberButtonsCenterToEnd","isLast","numberNavigationBtn","widthOfNavigationBtns","widthOfPageBtns","numberVisible","btnIndex","DSelectMultiple","oldValues","updateMenuItems","isSameValues","addedValue","removedValue","childValue","DSelect","findMenuItem","_offsetX","_offsetY","onTextureUpdate","DShadowImpl","NineSlicePlane","DSliderLabel","DSliderThumb","DSliderValue","_rounder","toRounder","rounder","getPrecision","DSlider","_ratioValue","_track","newTrack","_trackSelected","newTrackSelected","newThumb","newLabelMin","newLabelMax","onTrackDown","onTrackSelectedDown","_onTrackUpBound","onTrackUpBound","_onTrackSelectedUpBound","onTrackSelectedUpBound","onThumbDown","_onThumbMoveBound","onThumbMove","_onThumbUpBound","onThumbUp","onValuesChange","toValueOptions","toLabelMinOptions","toLabelMaxOptions","onPick","newMin","newMax","DSliderTrack","DSliderTrackHorizontal","DSliderHorizontal","track","getValueMargin","moveThumbPosition","updateValue","DSliderTrackVertical","DSliderVertical","trackSelected","DTableBodyCells","columnIndex","toReadOnly","toRenderable","_rowIndex","_columnIndex","_column","_isSyncEnabled","sync","isSyncEnabled","DTableBodyCellSelectDialog","selecting","oldValue_1","_row","rowIndex","supplimental","setReadOnly","setRenderable","DTableBodyCellActionDialog","DTableBodyCellActionMenu","DTableBodyCellSelectPromise","promise","DTableBodyCellActionPromise","DTableBodyCellText","DTableBodyCellButton","DTableDataSelectionType","DTableBodyCellCheck","CHECK_SINGLE","onChangeSingle","tableBodyRow","tableBody","isChanged_1","getter_1","setter_1","each","DTableBodyCellColor","DTableBodyCellDate","DTableBodyCellDatetime","DTableBodyCellIndex","DTableBodyCellInputInteger","DTableBodyCellInputReal","DTableBodyCellInputText","_adjuster","DBasePaddingAdjustable","DTableBodyCellInputTreeInput","DTableBodyCellInputTreeMarker","DTableState","START","END","FROZEN","FROZEN_END","SORTABLE","SORTED_ASCENDING","SORTED_DESCENDING","HAS_CHILDREN","OPENED","CHECKABLE","SELECTABLE","toBaseOptions","newMarker","DTableBodyCellInputTree","onMarkerActive","hasChildren","level","markerState","getLevelPadding","adjuster","cell","DTableBodyCellLink","DTableBodyCellSelectMenu","DTableBodyCellSelectMultiple","DTableBodyCellTree","newLink","DTableBodyCellTime","DTableDataOrder","_frozen","frozen","_columns","columns","DTableRow","toIndexEnd","newCell","cellState","resetFrozenCellPosition","cells","cellsLength","getContentPositionX","cellIndex","shiftX","isEven","_onCellChangeBound","initCells","DTableBodyRow","cellOptions","toCellOptions","newCellEditable","newCellUnediable","TREE","INDEX","INTEGER","REAL","CHECK","BUTTON","LINK","SELECT","newCellSelect","newCellAction","DATETIME","TIME","multiple","columnWeight","columnWidth","columnFormatter","columnAlign","columnSelecting","columnSelectingMenu","columnEditing","columnLink","columnsLength","isCell","_isApplied","_sorterId","_filtered","DTableDataListFilter","indicesSorted","filtered","sorter","rows","indexSorted","newFiltered","sortedIndex","indicesFiltered","DTableDataListMapped","unmappedIndex","supplimentals","COMPARATOR","DTableDataListSelection","oldSize","result_1","result_2","lastRowIndex","includeFrom","includeTo","rowIndices","shifted","DTreeAddedItemPosition","_comparator","_sorted","DTableDataListSorter","comparator","toComparator","newSorted","_rows","toRows","_mapped","toSelection","_sorter","DTableDataList","newRows","rowsLength","newRowsLength","rowOptions","selectionType","getRowHeight","toRowOptions","_rowOptions","_rowHeight","_rowIndexMappedStart","_rowIndexMappedEnd","_updateRowsCount","_isUpdateRowsCalled","_isUpdateRowsCalledForcibly","_workRows","_onRowChangeBound","DTableBody","isData","callIfNeeded","rowHeight","dataMappedSize","mapped","oldRowIndexMappedStart","oldRowIndexMappedEnd","oldRowCount","newContentHeight","newContentY","newRowIndexMappedLowerBound","newRowIndexMappedUpperBound","newRowIndexMappedStart","newRowIndexMappedEnd","newRowCount","oldRowIndexMapped","newRow","rowIndexMappedStartDelta","rowIndexMappedStartDeltaAbs","resetRow","isRowSelectable","rowState","updateFrozenCellPosition","rowIndexMapped","WORK_ON_CLICK","toRowIndexMapped","toRow","toCell","onRowSelect","isSingle","isNotSingle","isEmpty","clearAndAdd","rowIndexSorted","lastRowIndexSorted","indexFiltered","DTableCategoryCell","DTableCategory","DTableDataTreeFilter","toChildren","accessor","isFiltered","hasFiltered","addAllToFiltered","newFilteredSub","toParent","DTableDataTreeSelectionImpl","oldRows","getFirst","toIndex","getLast","DTableDataTreeSorter","_accessor","toAccessor","_isRowsDirty","_supplimentals","_flags","WeakMap","DTableDataTree","DTableDataTreeItemAccessor","_nodes","onNodeChange","updateRows","flags","irows","ilevel","toSupplimental","_isFilterable","filterable","_isEmittable","emittable","DTableHeaderCellCheck","isFilterable","isEmittable","table","isChecked","data_1","iteratee_1","newIteratee","DTableHeaderCell","_check","sortable","sorting","checkable","_onSorterChangeBound","onSorterChange","isApplied","checkWork","_checkWork","isSortable","toClickPosition","isCheckClicked","doSort","DESCENDING","onSorterChangeBound","_table","DTableHeader","defaultGetterEmpty","defaultSetterEmpty","toColumnDataChecker","key_3","toColumnEditingEnable","toColumnEditing","editable","rowA","rowB","valueB","toColumnSorting","toColumnMenu","toColumnDialog","defaultSelectingGetter","defaultSelectingSetter","toColumnSelecting","toColumnRenderable","toColumn","toColumnAlign","toColumnPath","key_1","toPathGetter","default","toColumnGetter","key_2","toPathSetter","toColumnSetter","category","DTable","toColumns","toFrozen","categories","newCategories","_categories","headerOffset","bodyOffset","_bodyOffset","setWidth","toContentWidth","onRowClick","tcolumn","ccolumn","isSameCategory","toCategoryLabel","toCategoryColumns","getCategoryCount","toCategoryOptions","columnWidthTotal","hasHeader","toHeaderOptions","toBodyOptions","toFrozenCellX","cellFrozen","onKeyDownArrowUpOrDown","oldFocusable","oldCell","oldRow","newRowChild","newCellSibling","oldCellIndex","newFocusable","DTreeItemState","EXPANDED","COLLAPSED","DTreeItemTextAndImage","DTreeItemToggleIcon","toText","toImage","toRawData","rawData","DTreeItem","_isParent","_isExpanded","expanded","_rawData","_icon","_textAndImage","toTreeItemTextAndImage","onToggle","updateStates","getPaddingByLevel","toPaddingLeft","toYCoordinate","iconState","isExpanded","DTreeSelection","itemIndex","_i","DTree","_itemOptions","_itemOptionsShowable","_itemIndexMappedStart","_itemIndexMappedEnd","_itemY","itemTheme","_itemHeight","updateData","removeChildren","itemIndexMappedStart","itemIndexMappedEnd","itemOptionsShown","itemOptions","treeItem","getRawData","expandAll","reload","_removeItem","sibling","_addItemOptions","positon","inOrder","items_1","parentItemOptions","itemImage","isItemExisted","showable","selectedData","lastSelectedData","selectedItemOptions","lastSelectedItemOptions","selectedItemY","lastSelectedItemY","itemHeight","maxY_1","minY_1","itemOptionsShowable","updateActiveState","wcardinal","ui"],"mappings":"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"}