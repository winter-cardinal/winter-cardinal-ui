/*
 Winter Cardinal UI v0.459.0
 Copyright (C) 2019 Toshiba Corporation
 SPDX-License-Identifier: Apache-2.0

 Material Design icons by Google
 Apache license version 2.0.
*/
!function(t){"use strict";var e={},n={},i={CIRCLE:0,RECTANGLE:1,RECTANGLE_ROUNDED:2,TRIANGLE:3,TRIANGLE_ROUNDED:4,LINE:5,IMAGE:6,IMAGE_SDF:7,GROUP:8,BAR:9,LABEL:10,NULL:11,GROUP_SHADOWED:12,LINE_OF_CIRCLES:13,LINE_OF_RECTANGLES:14,LINE_OF_RECTANGLE_ROUNDEDS:15,LINE_OF_TRIANGLES:16,LINE_OF_TRIANGLE_ROUNDEDS:17,EMBEDDED:18,EMBEDDED_LAYER:19,BUTTON:20,RECTANGLE_PIVOTED:21,CONNECTOR_LINE:22,CONNECTOR_ELBOW:23,SEMICIRCLE:24,EMBEDDED_ACCEPTOR_EDGE:25,POLYGON:26,EXTENSION:1e3},r={},o=function(){function t(t,e,n,i,r,o){this._builders=o,this._vertexOffset=e,this._indexOffset=n,this._vertexCount=i,this._indexCount=r}return t.prototype.init=function(t){t.uploaded=this;for(var e=this._builders,n=0,i=e.length;n<i;++n)e[n].init();return this.update(t),this},t.prototype.reinit=function(t,e,n,i){for(var r=this._builders,o=n,s=i,a=0,u=r.length;a<u;++a){var l=r[a];if(!l.reinit(t,e,o,s))return!1;o+=l.vertexCount,s+=l.indexCount}return this._vertexCount=o-n,this._indexCount=s-i,this.update(e),!0},t.prototype.update=function(t){for(var e=this._builders,n=0,i=e.length;n<i;++n)e[n].update(t);return this},t.prototype.isCompatible=function(t){for(var e=this._builders,n=0,i=e.length;n<i;++n)if(!e[n].isCompatible(t))return!1;return!0},t.prototype.getVertexOffset=function(){return this._vertexOffset},t.prototype.getVertexCount=function(){return this._vertexCount},t.prototype.getIndexOffset=function(){return this._indexOffset},t.prototype.getIndexCount=function(){return this._indexCount},t.prototype.buildUnit=function(t){for(var e=this._builders,n=0,i=e.length;n<i;++n)e[n].buildUnit(t)},t}(),s={NONE:0,NON_EXPANDING_WIDTH:2,NON_SHRINKING_WIDTH:4,NON_SCALING_DOT_AND_DASH:8,NON_SCALING:14,NON_SCALING_MASK:14,DOTTED:16,DOTTED_DENSELY:32,DOTTED_LOOSELY:64,DOTTED_MASK:112,DASHED:128,DASHED_DENSELY:256,DASHED_LOOSELY:512,DASHED_MASK:896},a=function(t){return t&s.DOTTED_MASK?t&s.DOTTED?1:t&s.DOTTED_DENSELY?2:3:t&s.DASHED_MASK?t&s.DASHED?4:t&s.DASHED_DENSELY?5:6:0},u=function(t){var e=t&s.NON_EXPANDING_WIDTH?1:0,n=t&s.NON_SHRINKING_WIDTH?2:0;return t&(s.DOTTED_MASK||s.DASHED_MASK)?e|n|(t&s.NON_SCALING_DOT_AND_DASH?4:0):e|n},l=function(t,e,n,i,r){return r[0]=n-t,r[1]=i-e,r},h=function(t,e){if(1e-5<e){var n=1/e,i=t[0]*n,r=t[1]*n;t[0]=-r,t[1]=+i}else t[0]=0,t[1]=1;return t},c=function(t,e){return Math.round(511.5*(1+t[0]))+(Math.round(511.5*(1+e[0]))<<10)+((0<=t[1]?1:0)+(0<=e[1]?2:0)<<20)},p=function(t,e,n,i){return t+(e<<6)+(n<<12)+(i<<18)},f=function(t,e){return Math.round(1023*t)+(Math.round(1023*e)<<10)},d=[0,1],y=[0,1],g=function(t,e,n){var i=3*n-1;t[++i]=e,t[++i]=e+2,t[++i]=e+1,t[++i]=e+1,t[++i]=e+2,t[++i]=e+3},v=function(t,e,n,i,r,o,s,f){var g=f.a,v=f.b,_=f.c,m=f.d,b=f.tx,T=f.ty,w=i[0],E=i[1],O=g*w+_*E+b,C=v*w+m*E+T,S=i[2],x=i[3],D=g*S+_*x+b,I=v*S+m*x+T,A=D-O,R=I-C,P=Math.sqrt(A*A+R*R),M=P;if(0<=r&&1e-5<P){var k=r/P;D=O+(A*=k),I=C+(R*=k),M=r}var L=d,N=y;l(O-A,C-R,O,C,L),l(O,C,D,I,N),h(L,M),h(N,M);var B=c(L,N),z=u(s),U=a(s),j=p(3,z,U,0),F=p(5,z,U,0),H=(n<<1)-1,G=6*n-1;t[++H]=O,t[++H]=C,t[++H]=O,t[++H]=C,e[++G]=o,e[++G]=j,e[++G]=B,e[++G]=0,e[++G]=M,e[++G]=0,e[++G]=o,e[++G]=F,e[++G]=B,e[++G]=0,e[++G]=M,e[++G]=0,t[++H]=D,t[++H]=I,t[++H]=D,t[++H]=I,e[++G]=o,e[++G]=j,e[++G]=B,e[++G]=M,e[++G]=M,e[++G]=0,e[++G]=o,e[++G]=F,e[++G]=B,e[++G]=M,e[++G]=M,e[++G]=0},_=function(t,e,n){var i=(e<<1)-1;t[++i]=n.x0,t[++i]=n.y0,t[++i]=n.x3,t[++i]=n.y3,t[++i]=n.x1,t[++i]=n.y1,t[++i]=n.x2,t[++i]=n.y2},m={NORMAL:0,BOLD:1},b={NORMAL:0,ITALIC:1},T={LEFT:0,CENTER:1,RIGHT:2,OUTSIDE_LEFT:3,OUTSIDE_RIGHT:4},w={TOP:0,MIDDLE:1,BOTTOM:2,OUTSIDE_TOP:3,OUTSIDE_BOTTOM:4},E={LEFT_TO_RIGHT:0,TOP_TO_BOTTOM:1,BOTTOM_TO_TOP:2,RIGHT_TO_LEFT:3},O=function(t,e,n,i){var r=n-t,o=i-e;return Math.sqrt(r*r+o*o)},C={ASCII:{LOW:{FROM:33,TO:126},HIGH:{FROM:161,TO:255}},SURROGATE:{LOW:{FROM:56320,TO:57343},HIGH:{FROM:55296,TO:56319}},VARIATION:{FROM:65024,TO:65039},SPACE:" ",TAB:"\t",SOFT_TAB:"    ",DOTS:"...",NEW_LINE:"\n"},S=1e-5,x=new t.Point,D=function(t){var e=t.text.plength;return(e>>3)+(0<(7&e)?1:0)<<3},I=function(t,e,n,i){for(var r=3*n-1,o=3*(n+i)-1,s=e;r<o;)t[++r]=s,t[++r]=s+1,t[++r]=s+3,t[++r]=s+1,t[++r]=s+2,t[++r]=s+3,s+=4},A=function(t,e,n,i,r,o,a,l,h){var c=6*e-1,f=6*(e+n)-1,d=u(s.NONE),y=p(2,d,1,1);if(null!=i)for(var g=i.font.size/(r*(l+h)*.5),v=a===m.NORMAL?0:.05;c<f;)t[++c]=o,t[++c]=y,t[++c]=g,t[++c]=0,t[++c]=v,t[++c]=0;else for(;c<f;)t[++c]=0,t[++c]=y,t[++c]=0,t[++c]=0,t[++c]=0,t[++c]=0},R=function(t,e,n,i,r,o,s,a,u,l,h,c,p,f,d,y,g,v,_,m,b){switch(t){case T.LEFT:switch(e){case w.TOP:b.x=u+g*(n+r)+_*(i+o),b.y=l+v*(n+r)+m*(i+o);break;case w.MIDDLE:b.x=.5*(u+d)+g*(n+r)+_*(i-.5*a),b.y=.5*(l+y)+v*(n+r)+m*(i-.5*a);break;case w.BOTTOM:b.x=d+g*(n+r)+_*(i-o-a),b.y=y+v*(n+r)+m*(i-o-a);break;case w.OUTSIDE_TOP:b.x=u+g*(n+r)+_*(i-o-a),b.y=l+v*(n+r)+m*(i-o-a);break;case w.OUTSIDE_BOTTOM:b.x=d+g*(n+r)+_*(i+o),b.y=y+v*(n+r)+m*(i+o)}break;case T.CENTER:switch(e){case w.TOP:b.x=.5*(u+h)+g*(n-.5*s)+_*(i+o),b.y=.5*(l+c)+v*(n-.5*s)+m*(i+o);break;case w.MIDDLE:b.x=.5*(u+p)+g*(n-.5*s)+_*(i-.5*a),b.y=.5*(l+f)+v*(n-.5*s)+m*(i-.5*a);break;case w.BOTTOM:b.x=.5*(d+p)+g*(n-.5*s)+_*(i-o-a),b.y=.5*(y+f)+v*(n-.5*s)+m*(i-o-a);break;case w.OUTSIDE_TOP:b.x=.5*(u+h)+g*(n-.5*s)+_*(i-o-a),b.y=.5*(l+c)+v*(n-.5*s)+m*(i-o-a);break;case w.OUTSIDE_BOTTOM:b.x=.5*(d+p)+g*(n-.5*s)+_*(i+o),b.y=.5*(y+f)+v*(n-.5*s)+m*(i+o)}break;case T.RIGHT:switch(e){case w.TOP:b.x=h+g*(n-r-s)+_*(i+o),b.y=c+v*(n-r-s)+m*(i+o);break;case w.MIDDLE:b.x=.5*(h+p)+g*(n-r-s)+_*(i-.5*a),b.y=.5*(c+f)+v*(n-r-s)+m*(i-.5*a);break;case w.BOTTOM:b.x=p+g*(n-r-s)+_*(i-o-a),b.y=f+v*(n-r-s)+m*(i-o-a);break;case w.OUTSIDE_TOP:b.x=h+g*(n-r-s)+_*(i-o-a),b.y=c+v*(n-r-s)+m*(i-o-a);break;case w.OUTSIDE_BOTTOM:b.x=p+g*(n-r-s)+_*(i+o),b.y=f+v*(n-r-s)+m*(i+o)}break;case T.OUTSIDE_LEFT:switch(e){case w.TOP:b.x=u+g*(n-r-s)+_*(i+o),b.y=l+v*(n-r-s)+m*(i+o);break;case w.MIDDLE:b.x=.5*(u+d)+g*(n-r-s)+_*(i-.5*a),b.y=.5*(l+y)+v*(n-r-s)+m*(i-.5*a);break;case w.BOTTOM:b.x=d+g*(n-r-s)+_*(i-o-a),b.y=y+v*(n-r-s)+m*(i-o-a);break;case w.OUTSIDE_TOP:b.x=u+g*(n-r-s)+_*(i-o-a),b.y=l+v*(n-r-s)+m*(i-o-a);break;case w.OUTSIDE_BOTTOM:b.x=d+g*(n-r-s)+_*(i+o),b.y=y+v*(n-r-s)+m*(i+o)}break;case T.OUTSIDE_RIGHT:switch(e){case w.TOP:b.x=h+g*(n+r)+_*(i+o),b.y=c+v*(n+r)+m*(i+o);break;case w.MIDDLE:b.x=.5*(h+p)+g*(n+r)+_*(i-.5*a),b.y=.5*(c+f)+v*(n+r)+m*(i-.5*a);break;case w.BOTTOM:b.x=p+g*(n+r)+_*(i-o-a),b.y=f+v*(n+r)+m*(i-o-a);break;case w.OUTSIDE_TOP:b.x=h+g*(n+r)+_*(i-o-a),b.y=c+v*(n+r)+m*(i-o-a);break;case w.OUTSIDE_BOTTOM:b.x=p+g*(n+r)+_*(i+o),b.y=f+v*(n+r)+m*(i+o)}}},P=function(t,e,n,i,r,o,s,a,u,l,h,c,p,f,d,y,g,v,_,m,D,I,A,P,N,B){var z=.5*s,j=.5*a,F=B.a,H=B.b,G=B.c,V=B.d,W=B.tx,K=B.ty,X=r-z,Y=o-j,q=r+z,Z=o-j,J=r+z,Q=o+j,$=F*X+G*Y+W,tt=H*X+V*Y+K,et=F*q+G*Z+W,nt=H*q+V*Z+K,it=F*J+G*Q+W,rt=H*J+V*Q+K,ot=$+(it-et),st=tt+(rt-nt),at=O($,tt,et,nt),ut=O(0,0,F,H),lt=1,ht=0;if(S<ut){var ct=1/ut;lt=F*ct,ht=H*ct}var pt=O($,tt,ot,st),ft=O(0,0,G,V),dt=0,yt=1;if(S<ut){var gt=1/ft;dt=G*gt,yt=V*gt}var vt=x;switch(_){case E.LEFT_TO_RIGHT:break;case E.TOP_TO_BOTTOM:vt.set(dt,yt),dt=-lt,yt=-ht,lt=vt.x,ht=vt.y,vt.x=ft,ft=ut,ut=vt.x;break;case E.BOTTOM_TO_TOP:vt.set(dt,yt),dt=lt,yt=ht,lt=-vt.x,ht=-vt.y,vt.x=ft,ft=ut,ut=vt.x;break;case E.RIGHT_TO_LEFT:lt=-lt,ht=-ht,dt=-dt,yt=-yt}for(var _t=0,mt=0,bt=0,Tt=l*ft,wt=Math.max(0,l+v)*ft,Et=0,Ot=1,Ct=u.characters,St=0,xt=0,Dt=h.length;xt<Dt;++xt)(fe=h[xt])!==C.NEW_LINE?(0<St&&(Et+=Math.max(0,St+g)),(ye=Ct.get(fe))?(St=ye.advance,bt=ye.height):St=0):(Et+=St,St=0,_t=Math.max(_t,Et),Et=0,mt+=wt,Ot+=1);if(Et+=St,_t=Math.max(_t,Et),mt+=Tt,Et=0,A&&M(p,f)){var It=0,At=0;switch(_){case E.LEFT_TO_RIGHT:case E.RIGHT_TO_LEFT:It=Math.max(0,at-2*m),At=Math.max(0,pt-2*D);break;case E.TOP_TO_BOTTOM:case E.BOTTOM_TO_TOP:It=Math.max(0,pt-2*D),At=Math.max(0,at-2*m)}var Rt=_t*ut*(l/u.font.size),Pt=mt,Mt=Math.min(1,Math.min(It/Rt,At/Pt));l*=Mt,Tt*=Mt,wt*=Mt,mt*=Mt}var kt=l/u.font.size,Lt=ut*kt;bt*=ft*kt;var Nt=0,Bt=0,zt=_t*=Lt;switch(_){case E.LEFT_TO_RIGHT:R(p,f,d,y,m,D,_t,mt,$,tt,et,nt,it,rt,ot,st,lt,ht,dt,yt,vt),Nt=vt.x,Bt=vt.y,I&&M(p,f)&&(zt=at-2*m);break;case E.TOP_TO_BOTTOM:R(function(t){switch(t){case w.TOP:return T.LEFT;case w.MIDDLE:return T.CENTER;case w.BOTTOM:return T.RIGHT;case w.OUTSIDE_TOP:return T.OUTSIDE_LEFT;case w.OUTSIDE_BOTTOM:return T.OUTSIDE_RIGHT}}(f),function(t){switch(t){case T.LEFT:return w.BOTTOM;case T.CENTER:return w.MIDDLE;case T.RIGHT:return w.TOP;case T.OUTSIDE_LEFT:return w.OUTSIDE_BOTTOM;case T.OUTSIDE_RIGHT:return w.OUTSIDE_TOP}}(p),y,d,D,m,_t,mt,et,nt,it,rt,ot,st,$,tt,lt,ht,dt,yt,vt),Nt=vt.x,Bt=vt.y,I&&M(p,f)&&(zt=pt-2*D);break;case E.BOTTOM_TO_TOP:R(function(t){switch(t){case w.TOP:return T.RIGHT;case w.MIDDLE:return T.CENTER;case w.BOTTOM:return T.LEFT;case w.OUTSIDE_TOP:return T.OUTSIDE_RIGHT;case w.OUTSIDE_BOTTOM:return T.OUTSIDE_LEFT}}(f),function(t){switch(t){case T.LEFT:return w.TOP;case T.CENTER:return w.MIDDLE;case T.RIGHT:return w.BOTTOM;case T.OUTSIDE_LEFT:return w.OUTSIDE_TOP;case T.OUTSIDE_RIGHT:return w.OUTSIDE_BOTTOM}}(p),y,d,D,m,_t,mt,ot,st,$,tt,et,nt,it,rt,lt,ht,dt,yt,vt),Nt=vt.x,Bt=vt.y,I&&M(p,f)&&(zt=pt-2*D);break;case E.RIGHT_TO_LEFT:R(function(t){switch(t){case T.LEFT:return T.RIGHT;case T.CENTER:return T.CENTER;case T.RIGHT:return T.LEFT;case T.OUTSIDE_LEFT:return T.OUTSIDE_RIGHT;case T.OUTSIDE_RIGHT:return T.OUTSIDE_LEFT}}(p),function(t){switch(t){case w.TOP:return w.BOTTOM;case w.MIDDLE:return w.MIDDLE;case w.BOTTOM:return w.TOP;case w.OUTSIDE_TOP:return w.OUTSIDE_BOTTOM;case w.OUTSIDE_BOTTOM:return w.OUTSIDE_TOP}}(f),d,y,m,D,_t,mt,it,rt,ot,st,$,tt,et,nt,lt,ht,dt,yt,vt),Nt=vt.x,Bt=vt.y,I&&M(p,f)&&(zt=at-2*m)}if(zt<_t){var Ut=.5*(_t-zt);P[0]=Nt+lt*Ut,P[1]=Bt+ht*Ut,P[2]=lt,P[3]=ht,P[4]=dt,P[5]=yt,P[6]=zt,P[7]=mt,P[8]=ut,P[9]=ft}else P[0]=Nt,P[1]=Bt,P[2]=lt,P[3]=ht,P[4]=dt,P[5]=yt,P[6]=_t,P[7]=mt,P[8]=ut,P[9]=ft;var jt=N.x0,Ft=N.x1,Ht=N.x3,Gt=N.y0,Vt=N.y1,Wt=N.y3,Kt=Ft-jt,Xt=Vt-Gt,Yt=Ht-jt,qt=Wt-Gt,Zt=wt*dt,Jt=wt*yt,Qt=Lt*lt,$t=Lt*ht,te=.5*(bt-Tt),ee=te*dt,ne=te*yt,ie=c===b.NORMAL?0:.25*l,re=Nt-ee+ie*Qt,oe=Bt-ne+ie*$t,se=Nt+ee+Tt*dt,ae=Bt+ne+Tt*yt,ue=re,le=oe,he=se,ce=ae;Et=0,St=0,Ot=0;var pe=2*n;for(xt=0,Dt=h.length;xt<Dt;xt+=1,pe+=8){var fe;if((fe=h[xt])!==C.NEW_LINE){var de=Et;0<St&&(Et+=Math.max(0,St+g));var ye,ge=Et*Qt,ve=Et*$t;if(ue=re+ge,le=oe+ve,he=se+ge,ce=ae+ve,Ot+=1,ye=Ct.get(fe)){var _e=ye.advance;if(zt<(Et+_e)*Lt){var me=Ct.get(C.DOTS);if(me){if(1<Ot&&zt<(Et+me.advance)*Lt){pe-=8,Ot-=1;var be=(Et=de)*Qt,Te=Et*$t;ue=re+be,le=oe+Te,he=se+be,ce=ae+Te}for(St=me.advance,L(t,e,pe,me,u,Qt,$t,ue,le,he,ce,Kt,Xt,Yt,qt,jt,Gt),pe+=8;;pe+=8){if(!(xt+1<Dt&&h[xt+1]!==C.NEW_LINE)){pe-=8;break}k(t,e,pe,ue,le,he,ce,jt,Gt,Ht,Wt),Ot+=1,xt+=1}}else St=_e,k(t,e,pe,ue,le,he,ce,jt,Gt,Ht,Wt)}else St=_e,L(t,e,pe,ye,u,Qt,$t,ue,le,he,ce,Kt,Xt,Yt,qt,jt,Gt)}else St=0,k(t,e,pe,ue,le,he,ce,jt,Gt,Ht,Wt)}else Et+=St,St=0,k(t,e,pe,ue=re+=Zt,le=oe+=Jt,he=se+=Zt,ce=ae+=Jt,jt,Gt,Ht,Wt),U(t,lt,ht,Ot,pe,_t-Et*Lt,_,p,f),Et=0,Ot=0}U(t,lt,ht,Ot,pe,_t-(Et+=St)*Lt,_,p,f);for(var we=2*(n+i);pe<we;pe+=2)t[pe+0]=Nt,t[pe+1]=Bt,e[pe+0]=jt,e[pe+1]=Gt},M=function(t,e){switch(t){case T.LEFT:case T.CENTER:case T.RIGHT:switch(e){case w.TOP:case w.MIDDLE:case w.BOTTOM:return!0}}return!1},k=function(t,e,n,i,r,o,s,a,u,l,h){t[n+0]=i,t[n+1]=r,t[n+2]=i,t[n+3]=r,t[n+4]=o,t[n+5]=s,t[n+6]=o,t[n+7]=s,e[n+0]=a,e[n+1]=u,e[n+2]=a,e[n+3]=u,e[n+4]=l,e[n+5]=h,e[n+6]=l,e[n+7]=h},L=function(t,e,n,i,r,o,s,a,u,l,h,c,p,f,d,y,g){var v=i.x-i.origin.x,_=i.width,m=v*o,b=v*s,T=(v+_)*o,w=(v+_)*s;t[n+0]=a+m,t[n+1]=u+b,t[n+2]=a+T,t[n+3]=u+w,t[n+4]=l+T,t[n+5]=h+w,t[n+6]=l+m,t[n+7]=h+b;var E=i.x/r.width,O=i.y/r.height,C=(i.x+i.width)/r.width,S=(i.y+i.height)/r.height,x=c*E,D=p*E,I=c*C,A=p*C,R=f*O,P=d*O,M=f*S,k=d*S;e[n+0]=y+x+R,e[n+1]=g+D+P,e[n+2]=y+I+R,e[n+3]=g+A+P,e[n+4]=y+I+M,e[n+5]=g+A+k,e[n+6]=y+x+M,e[n+7]=g+D+k},N=function(t,e,n,i,r){for(var o=e-8*n-1,s=0;s<n;++s)t[++o]+=i,t[++o]+=r,t[++o]+=i,t[++o]+=r,t[++o]+=i,t[++o]+=r,t[++o]+=i,t[++o]+=r},B=function(t,e,n,i,r,o){N(t,e,n,(i*=.5)*r,i*o)},z=function(t,e,n,i,r,o){N(t,e,n,i*r,i*o)},U=function(t,e,n,i,r,o,s,a,u){if(S<o)switch(s){case E.LEFT_TO_RIGHT:switch(a){case T.OUTSIDE_RIGHT:case T.LEFT:break;case T.CENTER:B(t,r,i,o,e,n);break;case T.OUTSIDE_LEFT:case T.RIGHT:z(t,r,i,o,e,n)}break;case E.TOP_TO_BOTTOM:switch(u){case w.OUTSIDE_BOTTOM:case w.TOP:break;case w.MIDDLE:B(t,r,i,o,e,n);break;case w.OUTSIDE_TOP:case w.BOTTOM:z(t,r,i,o,e,n)}break;case E.BOTTOM_TO_TOP:switch(u){case w.OUTSIDE_BOTTOM:case w.TOP:z(t,r,i,o,e,n);break;case w.MIDDLE:B(t,r,i,o,e,n)}break;case E.RIGHT_TO_LEFT:switch(a){case T.OUTSIDE_RIGHT:case T.LEFT:z(t,r,i,o,e,n);break;case T.CENTER:B(t,r,i,o,e,n)}}},j=function(t,e){return(j=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])})(t,e)};function F(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");function n(){this.constructor=t}j(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}"function"==typeof SuppressedError&&SuppressedError;var H,G,V,W,K,X={NONE:0,CLOSED:1,NON_EXPANDING_WIDTH:2,NON_SHRINKING_WIDTH:4,NON_SCALING_DOT_AND_DASH:8,NON_SCALING_MASK:14,DOTTED:16,DOTTED_DENSELY:32,DOTTED_LOOSELY:64,DOTTED_MASK:112,DASHED:128,DASHED_DENSELY:256,DASHED_LOOSELY:512,DASHED_MASK:896,CURVE:1024,CURVE_SPLINE:1024,CURVE_BEZIER_QUADRATIC:2048,FORMATTER_SHIFT:10,FORMATTER_MASK:1047552,FORMATTER_EXTENSION_LOWEST:512,FORMATTER_EXTENSION_HIGHEST:1023,FORMATTER_CURVE:1,FORMATTER_CURVE_SPLINE:1,FORMATTER_CURVE_BEZIER_QUADRATIC:2},Y={NONE:0,VERTEX:1,STEP:2,COLOR:4,UV:8,INDEX:16,VERTEX_AND_STEP:3,VERTEX_STEP_AND_UV:11,VERTEX_STEP_UV_AND_INDEX:27,ALL:31},q=function(t,e,n,i,r,o,s){for(var a=f(Math.max(0,Math.min(1,e)),Math.max(0,Math.min(1,i))),u=3*r-1,l=3*(r+o)-1;u<l;)s[++u]=t,s[++u]=n,s[++u]=a},Z={NONE:0,TOP:1,RIGHT:2,BOTTOM:4,LEFT:8,TOP_OR_LEFT:9,TOP_OR_RIGHT:3,BOTTOM_OR_LEFT:12,BOTTOM_OR_RIGHT:6,ALL:15},J={TOP:0,RIGHT:1,BOTTOM:2,LEFT:3},Q=function(){function e(t,e,n,i,r){this.buffer=t,this.vertexOffset=e,this.indexOffset=n,this.vertexCount=i,this.indexCount=r,this.inited=Y.NONE,this.sizeX=0,this.sizeY=0,this.transformLocalId=-1,this.fillDirection=J.BOTTOM,this.fillPercent=1,this.strokeAlign=0,this.strokeWidth=0,this.strokeSide=Z.NONE,this.strokeStyle=s.NONE,this.colorFill=0,this.alphaFill=0,this.colorStroke=0,this.alphaStroke=0,this.texture=null,this.textureTransformId=-1}return e.prototype.reinit=function(t,e,n,i){return this.buffer===t&&this.vertexOffset===n&&this.indexOffset===i||!!t.check(n,i,this.vertexCount,this.indexCount)&&(this.inited=Y.NONE,this.buffer=t,this.vertexOffset=n,this.indexOffset=i,this.init(),!0)},e.prototype.isCompatible=function(t){return!0},e.prototype.updateColor=function(t,e){var n=e.fill,i=n.color,r=e.visible&&n.enable?n.alpha:0,o=e.stroke,s=o.color,a=e.visible&&o.enable&&0<o.width?o.alpha:0;(!(this.inited&Y.COLOR)||i!==this.colorFill||r!==this.alphaFill||s!==this.colorStroke||a!==this.alphaStroke)&&(this.inited|=Y.COLOR,this.colorFill=i,this.alphaFill=r,this.colorStroke=s,this.alphaStroke=a,t.updateColors(),q(i,r,s,a,this.vertexOffset,this.vertexCount,t.colors))},e.prototype.buildUnit=function(e){var n=this.texture||t.Texture.WHITE,i=n.baseTexture;if(i!==e.baseTexture){e.baseTexture=i;var r=this.indexOffset;e.push(n,r)}},e}(),$=function(t){return t.updateTransform(),t.transform.getLocalId()},tt=function(e){return e.texture||t.Texture.WHITE},et=function(t){var e=t;return null==e._uvs&&t.updateUvs(),e._updateID},nt=function(t){return t._uvs},it=function(){function t(){}return t.setDefaultThemeClass=function(t){this.DEFAULT_THEME_CLASS=t},t.getDefaultThemeClass=function(){return this.DEFAULT_THEME_CLASS},t.getInstance=function(){if(null==this.INSTANCE){var t=this.getDefaultThemeClass();if(null==t)throw new Error("No default theme class found");this.INSTANCE=new t}return this.INSTANCE},t.setInstance=function(t){var e=this.INSTANCE;return this.INSTANCE=t,e},t.get=function(t){return this.getInstance().get(t)},t.set=function(t,e){this.getInstance().set(t,e)},t.getClass=function(t){return this.getInstance().getClass(t)},t.setClass=function(t,e){this.getInstance().setClass(t,e)},t.getAtlas=function(){return this.getInstance().getAtlas()},t.DEFAULT_THEME_CLASS=null,t.INSTANCE=null,t}(),rt=function(){function t(){}return Object.defineProperty(t,"THEME",{get:function(){var t=this._THEME;if(null!=t)return t;var e=it.getInstance().get("EShape");return this._THEME=e,e},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILL_COLOR",{get:function(){return this.THEME.getFillColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILL_ALPHA",{get:function(){return this.THEME.getFillAlpha()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILL_DIRECTION",{get:function(){return this.THEME.getFillDirection()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"FILL_PERCENT",{get:function(){return this.THEME.getFillPercent()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_COLOR",{get:function(){return this.THEME.getStrokeColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_ALPHA",{get:function(){return this.THEME.getStrokeAlpha()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_WIDTH",{get:function(){return this.THEME.getStrokeWidth()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_ALIGN",{get:function(){return this.THEME.getStrokeAlign()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_SIDE",{get:function(){return this.THEME.getStrokeSide()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"STROKE_STYLE",{get:function(){return this.THEME.getStrokeStyle()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_VALUE",{get:function(){return this.THEME.getTextValue()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_COLOR",{get:function(){return this.THEME.getTextColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_ALPHA",{get:function(){return this.THEME.getTextAlpha()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_FAMILY",{get:function(){return this.THEME.getTextFamily()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"TEXT_SIZE",{get:function(){return this.THEME.getTextSize()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"RADIUS",{get:function(){return this.THEME.getRadius()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SIZE_X",{get:function(){return this.THEME.getSizeX()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"SIZE_Y",{get:function(){return this.THEME.getSizeY()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"HIGHLIGHT_COLOR",{get:function(){return this.THEME.getHighlightColor()},enumerable:!1,configurable:!0}),Object.defineProperty(t,"CURVE_SEGMENT_COUNT",{get:function(){return this.THEME.getCurveSegmentCount()},enumerable:!1,configurable:!0}),t}(),ot={NONE:0,CIRCLE:1,TRIANGLE:2,RECTANGLE:3},st=function(){function t(t,e,n,i,r,o){this._parent=t,this._enable=e,this._color=n,this._alpha=i,this._direction=r,this._percent=o}return Object.defineProperty(t.prototype,"enable",{get:function(){return this._enable},set:function(t){this.set(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this.set(void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(t){this.set(void 0,void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percent",{get:function(){return this._percent},set:function(t){this.set(void 0,void 0,void 0,void 0,t)},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha,t.direction,t.percent)},t.prototype.set=function(t,e,n,i,r){var o=!1;void 0!==t&&this._enable!==t&&(this._enable=t,o=!0),void 0!==e&&this._color!==e&&(this._color=e,o=!0),void 0!==n&&this._alpha!==n&&(this._alpha=n,o=!0),void 0!==i&&this._direction!==i&&(this._direction=i,o=!0),void 0!==r&&(r=Math.max(0,Math.min(1,r)),this._percent!==r&&(this._percent=r,o=!0)),o&&this._parent.updateUploaded()},t.prototype.clone=function(){return new t(this._parent,this._enable,this._color,this._alpha,this._direction,this._percent)},t.prototype.toObject=function(){return{enable:this._enable,color:this._color,alpha:this._alpha,direction:this._direction,percent:this._percent}},t.prototype.serialize=function(t){var e=this._enable?1:0,n="[".concat(e,",").concat(this._color,",").concat(this._alpha,",").concat(this._direction,",").concat(this._percent,"]");return t.addResource(n)},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getFill(t);null!=i||(i=JSON.parse(n[t]),e.setFill(t,i)),this.set(!!i[0],i[1],i[2],i[3],i[4])}},t}(),at=function(){function e(){}return e.prototype.lock=function(){return this},e.prototype.unlock=function(){return this},Object.defineProperty(e.prototype,"type",{get:function(){return ot.NONE},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){var e=this._size;return null==e&&(e=new t.Point,this._size=e),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"transform",{get:function(){var e=this._transform;return null==e&&(e=new t.Matrix,this._transform=e),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){var t=this._fill;return null==t&&(t=new st(this,!0,rt.FILL_COLOR,1,rt.FILL_DIRECTION,rt.FILL_PERCENT),this._fill=t),t},enumerable:!1,configurable:!0}),e.prototype.updateUploaded=function(){},e.prototype.copy=function(t){return this},e.prototype.set=function(t,e,n){return this},e.prototype.serialize=function(t){return-1},e.prototype.deserialize=function(t,e){},e}(),ut=function(){function t(){this._marker=new at}return t.prototype.lock=function(){return this},t.prototype.unlock=function(){return this},Object.defineProperty(t.prototype,"head",{get:function(){return this._marker},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tail",{get:function(){return this._marker},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){return this},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,e){},t.getInstance=function(){var e=this.INSTANCE;return null==e&&(e=new t,this.INSTANCE=e),e},t}(),lt={TOP:0,LEFT:1,RIGHT:2,BOTTOM:3},ht=function(){function e(t){this._parent=t,this._id=0,this._values=[0,0,0,0],this._segments=[],this._style=X.NONE,this._size=-1,this._position=lt.TOP,this._updatedSize=NaN,this._updatedParentSizeX=NaN,this._updatedParentSizeY=NaN,this._updatedPosition=NaN}return e.prototype.getComputedSize=function(t,e,n,i){if(0<=t)return t;switch(e){case lt.TOP:case lt.BOTTOM:return Math.abs(i);case lt.RIGHT:case lt.LEFT:return Math.abs(n)}return 0},e.prototype.onSizeChange=function(){this.update()},e.prototype.update=function(){var t=this._parent.size,e=t.x,n=t.y,i=this._position,r=this._size;if(this._updatedSize!==r||this._updatedParentSizeX!==e||this._updatedParentSizeY!==n||this._updatedPosition!==i){this._id+=1,this._updatedSize=r,this._updatedParentSizeX=e,this._updatedParentSizeY=n,this._updatedPosition=i;var o=.5*e,s=.5*n,a=this.getComputedSize(r,i,e,n),u=this._values;switch(i){case lt.TOP:u[0]=0,u[1]=-s,u[2]=0,u[3]=-s+a;break;case lt.RIGHT:u[0]=o,u[1]=0,u[2]=o-a,u[3]=0;break;case lt.BOTTOM:u[0]=0,u[1]=s,u[2]=0,u[3]=s-a;break;case lt.LEFT:u[0]=-o,u[1]=0,u[2]=-o+a,u[3]=0}}},Object.defineProperty(e.prototype,"length",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plength",{get:function(){return 2},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.update(),this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.update(),this._values},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"segments",{get:function(){return this._segments},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this.moveTo(void 0,t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this.moveTo(t,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){this.moveTo(void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"marker",{get:function(){var t=this._marker;return null==t&&(t=ut.getInstance(),this._marker=t),t},enumerable:!1,configurable:!0}),e.prototype.getMarker=function(){},Object.defineProperty(e.prototype,"formatter",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formatted",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.copy=function(t){return t instanceof e?this.moveTo(t.position,t.size,t.style):this.moveTo(void 0,void 0,t.style)},e.prototype.set=function(t,e,n){var i,r;if(null!=t){var o=t[0];if(0===o){var s=t[1];i=s<=0?lt.TOP:lt.BOTTOM,r=Math.abs(t[3]-s)}else i=o<=0?lt.LEFT:lt.RIGHT,r=Math.abs(t[2]-o)}return this.moveTo(i,r,n)},e.prototype.moveTo=function(t,e,n){var i=!1;return null!=n&&this._style!==n&&(this._style=n,i=!0),null!=t&&this._position!==t&&(this._position=t,i=!0),null!=e&&this._size!==e&&(this._size=e,i=!0),i&&this._parent.updateUploaded(),this},e.prototype.clone=function(t){return new e(t).copy(this)},e.prototype.toPoints=function(e){for(var n=[],i=this.values,r=0,o=i.length;r<o;r+=2){var s=new t.Point(i[r+0],i[r+1]);n.push(e.apply(s,s))}return n},e.prototype.serialize=function(t){return t.addResource("[".concat(this._position,",").concat(this._size,",").concat(this._style,"]"))},e.prototype.deserialize=function(t,e){if(0<=t&&t<e.resources.length){var n=e.resources[t],i=JSON.parse(n);this.moveTo(i[0],i[1],i[2])}},e.prototype.calcHitPointAbs=function(t,e,n,i,r,o,s,a){if(2<=this.length){var u=this._values;if(s(t,e,u[0],u[1],u[2],u[3],0,r,a))return!0}return!1},e}(),ct={NONE:0,LINE:1,MARKER_TAIL:2,MARKER_HEAD:3,TEXT:4,CHILDREN:5},pt={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_LEFT:4,BOTTOM_RIGHT:8,TOP:3,BOTTOM:12,LEFT:5,RIGHT:10,ALL:15},ft=function(){function t(){}return t.add=function(e){t.INSTANCES.push(e)},t.first=function(){var e=t.INSTANCES;if(0<e.length)return e[0];throw new Error("No application found.")},t.last=function(){var e=t.INSTANCES;if(0<e.length)return e[e.length-1];throw new Error("No application found.")},t.get=function(e){var n=t.INSTANCES;return 0<=e&&e<n.length?n[e]:null},t.indexOf=function(e){return t.INSTANCES.indexOf(e)},t.size=function(){return t.INSTANCES.length},t.getStage=function(t){for(var e=t;e.parent;)e=e.parent;return"application"in e&&"layer"in e?e:null},t.find=function(t){var e=this.getStage(t);return e?e.layer.application:null},t.getLayerBase=function(t){var e=this.getStage(t);return e?e.layer.application.getLayerBase():null},t.getLayerOverlay=function(t){var e=this.getStage(t);return e?e.layer.application.getLayerOverlay():null},t.getLayer=function(t){var e=this.getStage(t);return e?e.layer:null},t.getResolution=function(t){var e,n=this.getLayer(t);return n?n.renderer.resolution:null!==(e=window.devicePixelRatio)&&void 0!==e?e:1},t.update=function(e){if(e){var n=this.getStage(e);n&&n.layer.update()}else for(var i=t.INSTANCES,r=0,o=i.length;r<o;++r)i[r].update()},t.render=function(e){if(e){var n=this.getStage(e);n&&n.layer.render()}else for(var i=t.INSTANCES,r=0,o=i.length;r<o;++r)i[r].render()},t.INSTANCES=[],t}(),dt=function(){function t(){this.values=[]}return t.prototype.add=function(t,e){var n=this.values;return null!=e?n.splice(e,0,t):n.push(t),this},t.prototype.addAll=function(t){for(var e=this.values,n=0,i=t.length;n<i;++n)e.push(t[n]);return this},t.prototype.clearAndAdd=function(t){return this.clear(),this.add(t),this},t.prototype.clearAndAddAll=function(t){return this.clear(),this.addAll(t),this},t.prototype.indexOf=function(t){for(var e=this.values,n=0,i=e.length;n<i;++n)if(e[n]===t)return n;for(n=0,i=e.length;n<i;++n)if(e[n].isEquals(t))return n;return-1},t.prototype.get=function(t){var e=this.values;return 0<=t||t<e.length?e[t]:null},t.prototype.set=function(t,e){var n=this.values;if(0<=t||t<n.length){var i=n[t];return n[t]=e,i}return null},t.prototype.remove=function(t){var e=this.values;return 0<=t||t<e.length?e.splice(t,1)[0]:null},t.prototype.clear=function(){return this.values.length=0,this},t.prototype.size=function(){return this.values.length},t.prototype.swap=function(t,e){var n=this.values,i=n[e];return n[e]=n[t],n[t]=i,this},t.prototype.serialize=function(t){for(var e=[],n=this.values,i=0,r=n.length;i<r;++i)e.push(n[i].serialize(t));return e},t}(),yt=function(){function t(t){this._parent=t,this._edges=new Set}return t.prototype.add=function(t){var e=this._edges;return!e.has(t)&&(e.add(t),!0)},t.prototype.contains=function(t){return this._edges.has(t)},t.prototype.size=function(){return this._edges.size},t.prototype.remove=function(t){return this._edges.delete(t)},t.prototype.clear=function(){return 0<this._edges.size&&(this._edges.clear(),!0)},t.prototype.copy=function(t){var e=this._edges;return e.clear(),t.each((function(t){e.add(t)})),this},t.prototype.each=function(t){return this._edges.forEach(t),this},t.prototype.fit=function(t){this._edges.forEach(this.toOnFitBound(t))},t.prototype.toOnFitBound=function(t){var e;return t?(null==(e=this._onFitBoundForcibly)&&(e=this.newOnFitBound(!0),this._onFitBoundForcibly=e),e):(null==(e=this._onFitBound)&&(e=this.newOnFitBound(!1),this._onFitBound=e),e)},t.prototype.newOnFitBound=function(t){var e=this;return function(n){e.onFit(n,t)}},t.prototype.onFit=function(t,e){t.fit(e)},t.prototype.attach=function(){var t=this._parent;return this._edges.forEach((function(e){e.set(t)})),this},t.prototype.detach=function(t){return this._edges.forEach((function(e){null!=t&&t.has(e.parent)||e.set(null)})),this},t}(),gt={NONE:0,TRANSFORM:1,SIZE:2,STYLE:4,ACTION:8,POINTS:16,STATE:32,IMAGE:64,DATA:128,TAG:128,CONNECTOR:256,CAPABILITY:512,ALL:1023},vt={HOVERED:"HOVERED",ACTIVE:"ACTIVE",FOCUSED:"FOCUSED",UNFOCUSABLE:"UNFOCUSABLE",FOCUS_ROOT:"FOCUS_ROOT",FOCUS_REVERSE:"FOCUS_REVERSE",READ_ONLY:"READ_ONLY",DISABLED:"DISABLED",GESTURING:"GESTURING",PRESSED:"PRESSED",INVALID:"INVALID",PROCESSING:"PROCESSING",SUCCEEDED:"SUCCEEDED",FAILED:"FAILED",WARNED:"WARNED",CHANGED:"CHANGED",ALTERNATED:"ALTERNATED",NEW_WINDOW:"NEW_WINDOW"},_t=function(){function t(t){var e=this;this._stateToTargets=new Map,this._interval=t,this._onTimeBound=function(){return e.onTime()}}return Object.defineProperty(t.prototype,"interval",{get:function(){return this._interval},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){var n=this._stateToTargets,i=n.get(t);return null==i?((i=new Set).add(e),n.set(t,i),n.size<=1&&this.start()):i.add(e),this},t.prototype.remove=function(t,e){var n=this._stateToTargets,i=n.get(t);return null!=i&&i.has(e)&&(i.delete(e),e.remove(t),i.size<=0&&n.delete(t),n.size<=0&&this.stop()),this},t.prototype.start=function(){return null==this._timeoutId&&this.onTime(),this},t.prototype.stop=function(){var t=this._timeoutId;return null!=t&&(clearTimeout(t),this._timeoutId=void 0),this},t.prototype.onTime=function(){var t=Date.now(),e=this.interval,n=this.newValue(t,e),i=this.newOn(t,e);this._stateToTargets.forEach((function(t,e){t.forEach((function(t){t.set(e,n,i)}))})),this._timeoutId=window.setTimeout(this._onTimeBound,Math.max(0,e-t%e))},t}(),mt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newValue=function(t,e){return null},e.prototype.newOn=function(t,e){return Math.round(t/e)%2==0},e}(_t),bt=function(){function t(t,e){this._parent=t,this._stateToInterval=new Map,this._intervalToDatum=e}return t.prototype.add=function(t,e){var n=this._stateToInterval,i=n.get(t);if(i===e)return this;if(null!=i){n.delete(t);var r=this._intervalToDatum.get(i);null!=r&&r.remove(t,this._parent)}n.set(t,e);var o=this._intervalToDatum.get(e);return null==o&&(o=this.newDatum(e),this._intervalToDatum.set(e,o)),o.add(t,this._parent),this},t.prototype.remove=function(t){var e=this._stateToInterval.get(t);if(null==e)return this;this._stateToInterval.delete(t);var n=this._intervalToDatum.get(e);return null==n||n.remove(t,this._parent),this},t.prototype.set=function(t,e,n){return n?this.add(t,e):this.remove(t)},t.prototype.has=function(t){return this._stateToInterval.has(t)},t.prototype.clear=function(){var t=this,e=this._parent,n=this._stateToInterval;return n.forEach((function(n,i){var r=t._intervalToDatum.get(n);null!=r&&r.remove(i,e)})),n.clear(),this},t}(),Tt=function(t){function e(e){return t.call(this,e,null!=H?H:H=new Map)||this}return F(e,t),e.prototype.newDatum=function(t){return new mt(t)},e}(bt),wt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newValue=function(t,e){return Math.round(t/e)},e.prototype.newOn=function(t,e){return!0},e}(_t),Et=function(t){function e(e){return t.call(this,e,null!=G?G:G=new Map)||this}return F(e,t),e.prototype.newDatum=function(t){return new wt(t)},e}(bt),Ot=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},Ct=function(t){return"function"==typeof t},St=function(t){return"number"==typeof t||"[object Number]"===Object.prototype.toString.call(t)},xt=function(t){return"string"==typeof t||"[object String]"===Object.prototype.toString.call(t)},Dt=function(){function t(){this._local=new Map,this._parent=null}return Object.defineProperty(t.prototype,"local",{get:function(){return this._local},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent!==t&&(this.begin(),this._parent=t,this.end())},enumerable:!1,configurable:!0}),t.prototype.onParentChange=function(t,e){this._parent=e,this.begin(),this._parent=t,this.end()},Object.defineProperty(t.prototype,"blinker",{get:function(){var t=this._blinker;return null==t&&(t=this.newBlinker(),this._blinker=t),t},enumerable:!1,configurable:!0}),t.prototype.newBlinker=function(){return new Tt(this)},Object.defineProperty(t.prototype,"ticker",{get:function(){var t=this._ticker;return null==t&&(t=this.newTicker(),this._ticker=t),t},enumerable:!1,configurable:!0}),t.prototype.newTicker=function(){return new Et(this)},t.prototype.is=function(t,e){var n=this._local.get(t);return void 0!==n&&(void 0===e||e===n)},t.prototype.in=function(t,e){return this.is(t,e)||this.under(t,e)},t.prototype.on=function(t,e){var n=this._parent;return null!=n&&n.is(t,e)},t.prototype.under=function(t,e){var n=this._parent;return null!=n&&n.in(t,e)},t.prototype.lock=function(t){return this},t.prototype.unlock=function(){return this},t.prototype.begin=function(){return this},t.prototype.end=function(){return this},t.prototype.checkAdded=function(t,e){var n=this._local.get(t);return void 0===n||n!==e},t.prototype.add=function(t,e){return void 0===e&&(e=null),this.checkAdded(t,e)&&(this.begin(),this._local.set(t,e),this.end()),this},t.prototype.checkAddedsString=function(t){for(var e=this._local,n=0,i=t.length;n<i;++n){var r=e.get(t[n]);if(void 0===r||null!==r)return!0}return!1},t.prototype.checkAddedsObject=function(t){for(var e=this._local,n=0,i=t.length;n<i;++n){var r=t[n],o=e.get(r.state);if(void 0===o||o!==r.value)return!0}return!1},t.prototype.addAll=function(t){if(xt(t))return this.addAllString(arguments);if(Ot(t)){if(0<t.length){var e=t[0];return xt(e)?this.addAllString(t):this.addAllObject(t)}return this}return this.addAllObject(arguments)},t.prototype.addAllString=function(t){if(this.checkAddedsString(t)){this.begin();for(var e=this._local,n=0,i=t.length;n<i;++n)e.set(t[n],null);this.end()}return this},t.prototype.addAllObject=function(t){if(this.checkAddedsObject(t)){this.begin();for(var e=this._local,n=0,i=t.length;n<i;++n){var r=t[n];e.set(r.state,r.value)}this.end()}return this},t.prototype.checkRemoved=function(t){return this._local.has(t)},t.prototype.remove=function(t){return this.checkRemoved(t)&&(this.begin(),this._local.delete(t),this.end()),this},t.prototype.checkRemovedsString=function(t){for(var e=this._local,n=0,i=t.length;n<i;++n)if(e.has(t[n]))return!0;return!1},t.prototype.checkRemovedsObject=function(t){for(var e=this._local,n=0,i=t.length;n<i;++n)if(e.has(t[n].state))return!0;return!1},t.prototype.removeAll=function(t){if(Ct(t))return this.removeAllMatcher(t);if(xt(t))return this.removeAllString(arguments);if(Ot(t)){if(0<t.length){var e=t[0];return xt(e)?this.removeAllString(t):this.removeAllObject(t)}return this}return this.removeAllObject(arguments)},t.prototype.removeAllMatcher=function(t){var e=this,n=!1,i=this._local;return i.forEach((function(r,o){t(o)&&(n||(n=!0,e.begin()),i.delete(o))})),n&&this.end(),this},t.prototype.removeAllString=function(t){if(this.checkRemovedsString(t)){this.begin();for(var e=this._local,n=0,i=t.length;n<i;++n)e.delete(t[n]);this.end()}return this},t.prototype.removeAllObject=function(t){if(this.checkRemovedsObject(t)){this.begin();for(var e=this._local,n=0,i=t.length;n<i;++n)e.delete(t[n].state);this.end()}return this},t.prototype.set=function(t,e,n){if(!0===e)null!=t&&this.add(t);else if(!1===e)null!=t&&this.remove(t);else{if(null!=e&&!St(e))return this.doSet(t,null,e);if(!0===n)null!=t&&this.add(t,e);else{if(!1!==n)return this.doSet(t,e,n);null!=t&&this.remove(t)}}return this},t.prototype.doSet=function(t,e,n){return null!=t?null!=n?(this.checkAdded(t,e)||this.checkRemoved(n))&&(this.begin(),this._local.set(t,e).delete(n),this.end()):this.add(t,e):null!=n&&this.remove(n),this},t.prototype.setAll=function(t,e){if(!0===e)null!=t&&this.addAll(t);else if(!1===e)null!=t&&this.removeAll(t);else if(null!=t&&0<t.length){if(null!=e&&0<e.length){var n=t[0];return xt(n)?this.setAllString(t,e):this.setAllObject(t,e)}this.addAll(t)}else null!=e&&this.removeAll(e);return this},t.prototype.setAllString=function(t,e){if(this.checkAddedsString(t)||this.checkRemovedsString(e)){this.begin();for(var n=this._local,i=0,r=t.length;i<r;++i)n.set(t[i],null);for(i=0,r=e.length;i<r;++i)n.delete(e[i]);this.end()}return this},t.prototype.setAllObject=function(t,e){if(this.checkAddedsObject(t)||this.checkRemovedsString(e)){this.begin();for(var n=this._local,i=0,r=t.length;i<r;++i){var o=t[i];n.set(o.state,o.value)}for(i=0,r=e.length;i<r;++i)n.delete(e[i]);this.end()}return this},t.prototype.clear=function(){var t=this._local;return 0<t.size&&(this.begin(),t.clear(),this.end()),this},t.prototype.valueOf=function(t,e){var n=this._local.get(t);if(void 0!==n)return null==n&&void 0!==e?e:n;var i=this._parent;return null!=i?void 0!==e?i.valueOf(t,e):i.valueOf(t):e},t.prototype.each=function(t){return this._local.forEach((function(e,n){t(n,e)})),this},t.prototype.size=function(){return this._local.size},t.prototype.copy=function(e){if(e instanceof t){this.begin();var n=this._local;n.clear(),e.local.forEach((function(t,e){n.set(e,t)})),this._parent=e.parent,this.end()}return this},Object.defineProperty(t.prototype,"isHovered",{get:function(){return this.is(vt.HOVERED)},set:function(t){this.set(vt.HOVERED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inHovered",{get:function(){return this.in(vt.HOVERED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onHovered",{get:function(){return this.on(vt.HOVERED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underHovered",{get:function(){return this.under(vt.HOVERED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActive",{get:function(){return this.is(vt.ACTIVE)},set:function(t){this.set(vt.ACTIVE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inActive",{get:function(){return this.in(vt.ACTIVE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onActive",{get:function(){return this.on(vt.ACTIVE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underActive",{get:function(){return this.under(vt.ACTIVE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isPressed",{get:function(){return this.is(vt.PRESSED)},set:function(t){this.set(vt.PRESSED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inPressed",{get:function(){return this.in(vt.PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onPressed",{get:function(){return this.on(vt.PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underPressed",{get:function(){return this.under(vt.PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isReadOnly",{get:function(){return this.is(vt.READ_ONLY)},set:function(t){this.set(vt.READ_ONLY,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inReadOnly",{get:function(){return this.in(vt.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onReadOnly",{get:function(){return this.on(vt.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underReadOnly",{get:function(){return this.under(vt.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnabled",{get:function(){return!this.is(vt.DISABLED)},set:function(t){this.set(vt.DISABLED,!t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inEnabled",{get:function(){return!this.in(vt.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onEnabled",{get:function(){return!this.on(vt.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underEnabled",{get:function(){return!this.under(vt.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isDisabled",{get:function(){return this.is(vt.DISABLED)},set:function(t){this.set(vt.DISABLED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inDisabled",{get:function(){return this.in(vt.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onDisabled",{get:function(){return this.on(vt.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underDisabled",{get:function(){return this.under(vt.DISABLED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isActionable",{get:function(){return!this.in(vt.DISABLED)&&!this.in(vt.READ_ONLY)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isGesturing",{get:function(){return this.is(vt.GESTURING)},set:function(t){this.set(vt.GESTURING,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inGesturing",{get:function(){return this.in(vt.GESTURING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onGesturing",{get:function(){return this.on(vt.GESTURING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underGesturing",{get:function(){return this.under(vt.GESTURING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocused",{get:function(){return this.is(vt.FOCUSED)},set:function(t){this.set(vt.FOCUSED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocused",{get:function(){return this.in(vt.FOCUSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocused",{get:function(){return this.on(vt.FOCUSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocused",{get:function(){return this.under(vt.FOCUSED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusRoot",{get:function(){return this.is(vt.FOCUS_ROOT)},set:function(t){this.set(vt.FOCUS_ROOT,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocusRoot",{get:function(){return this.in(vt.FOCUS_ROOT)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusRoot",{get:function(){return this.on(vt.FOCUS_ROOT)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocusRoot",{get:function(){return this.under(vt.FOCUS_ROOT)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusReverse",{get:function(){return this.is(vt.FOCUS_REVERSE)},set:function(t){this.set(vt.FOCUS_REVERSE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocusReverse",{get:function(){return this.in(vt.FOCUS_REVERSE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusReverse",{get:function(){return this.on(vt.FOCUS_REVERSE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocusReverse",{get:function(){return this.under(vt.FOCUS_REVERSE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFocusable",{get:function(){return!this.is(vt.UNFOCUSABLE)},set:function(t){this.set(vt.UNFOCUSABLE,!t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFocusable",{get:function(){return!this.in(vt.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFocusable",{get:function(){return!this.on(vt.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFocusable",{get:function(){return!this.under(vt.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isUnfocusable",{get:function(){return this.is(vt.UNFOCUSABLE)},set:function(t){this.set(vt.UNFOCUSABLE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inUnfocusable",{get:function(){return this.in(vt.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onUnfocusable",{get:function(){return this.on(vt.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underUnfocusable",{get:function(){return this.under(vt.UNFOCUSABLE)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isInvalid",{get:function(){return this.is(vt.INVALID)},set:function(t){this.set(vt.INVALID,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inInvalid",{get:function(){return this.in(vt.INVALID)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onInvalid",{get:function(){return this.on(vt.INVALID)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underInvalid",{get:function(){return this.on(vt.INVALID)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isProcessing",{get:function(){return this.is(vt.PROCESSING)},set:function(t){this.set(vt.PROCESSING,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inProcessing",{get:function(){return this.in(vt.PROCESSING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onProcessing",{get:function(){return this.on(vt.PROCESSING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underProcessing",{get:function(){return this.under(vt.PROCESSING)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isSucceeded",{get:function(){return this.is(vt.SUCCEEDED)},set:function(t){this.set(vt.SUCCEEDED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inSucceeded",{get:function(){return this.in(vt.SUCCEEDED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onSucceeded",{get:function(){return this.on(vt.SUCCEEDED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underSucceeded",{get:function(){return this.under(vt.SUCCEEDED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFailed",{get:function(){return this.is(vt.FAILED)},set:function(t){this.set(vt.FAILED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inFailed",{get:function(){return this.in(vt.FAILED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onFailed",{get:function(){return this.on(vt.FAILED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underFailed",{get:function(){return this.under(vt.FAILED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isWarned",{get:function(){return this.is(vt.WARNED)},set:function(t){this.set(vt.WARNED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inWarned",{get:function(){return this.in(vt.WARNED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onWarned",{get:function(){return this.on(vt.WARNED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underWarned",{get:function(){return this.on(vt.WARNED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChanged",{get:function(){return this.is(vt.CHANGED)},set:function(t){this.set(vt.CHANGED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inChanged",{get:function(){return this.in(vt.CHANGED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onChanged",{get:function(){return this.on(vt.CHANGED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underChanged",{get:function(){return this.on(vt.CHANGED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isAlternated",{get:function(){return this.is(vt.ALTERNATED)},set:function(t){this.set(vt.ALTERNATED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inAlternated",{get:function(){return this.in(vt.ALTERNATED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"onAlternated",{get:function(){return this.on(vt.ALTERNATED)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"underAlternated",{get:function(){return this.on(vt.ALTERNATED)},enumerable:!1,configurable:!0}),t.prototype.toObject=function(){var t=[];return this._local.forEach((function(e,n){t.push(n)})),{local:t}},t.prototype.toString=function(){return JSON.stringify(this.toObject())},t}(),It=function(t){function e(e){var n=t.call(this)||this;return n._onChange=e,n._isLocked=0,n._isSaved=!1,n._doSave=!0,n}return F(e,t),e.prototype.lock=function(t){return this._isLocked+=1,!1===t&&(this._doSave=!1),this},e.prototype.unlock=function(){return this._isLocked-=1,this.end()},Object.defineProperty(e.prototype,"saved",{get:function(){var t=this._saved;return null==t&&(t=new Dt,this._saved=t),t},enumerable:!1,configurable:!0}),e.prototype.begin=function(){return this._doSave&&!this._isSaved&&(this._isSaved=!0,this.saved.copy(this)),this},e.prototype.end=function(){return this._isLocked<=0&&(this._doSave=!0,this._isSaved&&(this._isSaved=!1,this.onChange(this,this.saved))),this},e.prototype.onChange=function(t,e){this._onChange(t,e)},e}(Dt),At={CLICKED:"CLICKED",DBL_CLICKED:"DBL_CLICKED",DOWN:"DOWN",UP:"UP",UP_OUTSIDE:"UP_OUTSIDE",RIGHT_CLICKED:"RIGHT_CLICKED",RIGHT_DOWN:"RIGHT_DOWN",RIGHT_UP:"RIGHT_UP",RIGHT_UP_OUTSIDE:"RIGHT_UP_OUTSIDE",RIGHT_PRESSED:"RIGHT_PRESSED",ACTIVATED:"ACTIVATED",DEACTIVATED:"DEACTIVATED"},Rt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onChange=function(e,n){e.isActive?n.isActive||this._local.set(At.ACTIVATED,null).delete(At.DEACTIVATED):n.isActive&&this._local.set(At.DEACTIVATED,null).delete(At.ACTIVATED),t.prototype.onChange.call(this,e,n)},Object.defineProperty(e.prototype,"isClicked",{get:function(){return this.is(At.CLICKED)},set:function(t){this.set(At.CLICKED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inClicked",{get:function(){return this.in(At.CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onClicked",{get:function(){return this.on(At.CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underClicked",{get:function(){return this.under(At.CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDblClicked",{get:function(){return this.is(At.DBL_CLICKED)},set:function(t){this.set(At.DBL_CLICKED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inDblClicked",{get:function(){return this.in(At.DBL_CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDblClicked",{get:function(){return this.on(At.DBL_CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underDblClicked",{get:function(){return this.under(At.DBL_CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDown",{get:function(){return this.is(At.DOWN)},set:function(t){this.set(At.DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inDown",{get:function(){return this.in(At.DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDown",{get:function(){return this.on(At.DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underDown",{get:function(){return this.under(At.DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUp",{get:function(){return this.is(At.UP)},set:function(t){this.set(At.UP,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inUp",{get:function(){return this.in(At.UP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onUp",{get:function(){return this.on(At.UP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underUp",{get:function(){return this.under(At.UP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUpOutside",{get:function(){return this.is(At.UP_OUTSIDE)},set:function(t){this.set(At.UP_OUTSIDE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inUpOutside",{get:function(){return this.in(At.UP_OUTSIDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onUpOutside",{get:function(){return this.on(At.UP_OUTSIDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underUpOutside",{get:function(){return this.under(At.UP_OUTSIDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRightClicked",{get:function(){return this.is(At.RIGHT_CLICKED)},set:function(t){this.set(At.RIGHT_CLICKED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inRightClicked",{get:function(){return this.in(At.RIGHT_CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRightClicked",{get:function(){return this.on(At.RIGHT_CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underRightClicked",{get:function(){return this.under(At.RIGHT_CLICKED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRightDown",{get:function(){return this.is(At.RIGHT_DOWN)},set:function(t){this.set(At.RIGHT_DOWN,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inRightDown",{get:function(){return this.in(At.RIGHT_DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRightDown",{get:function(){return this.on(At.RIGHT_DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underRightDown",{get:function(){return this.under(At.RIGHT_DOWN)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRightUp",{get:function(){return this.is(At.RIGHT_UP)},set:function(t){this.set(At.RIGHT_UP,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inRightUp",{get:function(){return this.in(At.RIGHT_UP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRightUp",{get:function(){return this.on(At.RIGHT_UP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underRightUp",{get:function(){return this.under(At.RIGHT_UP)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRightUpOutside",{get:function(){return this.is(At.RIGHT_UP_OUTSIDE)},set:function(t){this.set(At.RIGHT_UP_OUTSIDE,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inRightUpOutside",{get:function(){return this.in(At.RIGHT_UP_OUTSIDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRightUpOutside",{get:function(){return this.on(At.RIGHT_UP_OUTSIDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underRightUpOutside",{get:function(){return this.under(At.RIGHT_UP_OUTSIDE)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isRightPressed",{get:function(){return this.is(At.RIGHT_PRESSED)},set:function(t){this.set(At.RIGHT_PRESSED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inRightPressed",{get:function(){return this.in(At.RIGHT_PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onRightPressed",{get:function(){return this.on(At.RIGHT_PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underRightPressed",{get:function(){return this.under(At.RIGHT_PRESSED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isActivated",{get:function(){return this.is(At.ACTIVATED)},set:function(t){this.set(At.ACTIVATED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inActivated",{get:function(){return this.in(At.ACTIVATED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onActivated",{get:function(){return this.on(At.ACTIVATED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underActivated",{get:function(){return this.under(At.ACTIVATED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDeactivated",{get:function(){return this.is(At.DEACTIVATED)},set:function(t){this.set(At.DEACTIVATED,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"inDeactivated",{get:function(){return this.in(At.DEACTIVATED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"onDeactivated",{get:function(){return this.on(At.DEACTIVATED)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"underDeactivated",{get:function(){return this.under(At.DEACTIVATED)},enumerable:!1,configurable:!0}),e}(It),Pt=function(e){function n(n){var i=e.call(this)||this;return i.internalTransform=new t.Matrix,i._parent=n,i}return F(n,e),n.prototype.onChange=function(){e.prototype.onChange.call(this),this._parent.onTransformChange()},n.prototype.updateSkew=function(){e.prototype.updateSkew.call(this),this._parent.onTransformChange()},n.prototype.getLocalIdCurrent=function(){return this._currentLocalID},n.prototype.getLocalId=function(){return this._localID},n.prototype.getParentId=function(){return this._parentID},n.prototype.getWorldId=function(){return this._worldID},n.prototype.updateTransform=function(t){var i=this._currentLocalID,r=this._worldID;e.prototype.updateTransform.call(this,t);var o=this._currentLocalID,s=this._worldID;if(i!==o){var a=this.localTransform,u=this.internalTransform;a.copyTo(u),t instanceof n&&u.prepend(t.internalTransform)}else r!==s&&(a=this.localTransform,u=this.internalTransform,t instanceof n&&(a.copyTo(u).prepend(t.internalTransform),this._currentLocalID+=1,this._localID=this._currentLocalID))},n}(t.Transform),Mt=function(){function t(){this.x=0,this.y=0,this.width=0,this.height=0,this.strokeWidth=0,this.strokeScale=1,this.strokeAlign=0}return t.prototype.set=function(t,e,n,i,r,o,s){return this.x=t,this.y=e,this.width=n,this.height=i,this.strokeWidth=r,this.strokeScale=o,this.strokeAlign=s,this},t}(),kt=function(t,e,n,i){return-n<=t&&t<=+n&&-i<=e&&e<=+i},Lt={NONE:0,ID:1,POSITION:2,WIDTH:4,HEIGHT:8,ROTATION:16,SKEW:32,ALIGN:0,REPLACING:64,GROUPING:128,UNGROUPING:256,FILL:512,STROKE:1024,STROKE_SIDE:2048,BORDER_RADIUS:4096,TEXT:8192,TEXTURE:16384,TAG:32768,DATA:32768,DATA_MAPPING:1048576,ACTION:65536,CURSOR:131072,ORDER_IN_LAYER:262144,CHILDREN:524288,LINE:2097152,LINE_TAIL:4194304,LINE_HEAD:8388608,COORDINATE:62,SHAPE:14681792,LAYER:262144,PRIMITIVE:15722239,GROUP:15722495,EMBEDDED:1417471,EMBEDDED_ACCEPTOR_EDGE:517759,CONNECTOR:15722177,ALL:16777215},Nt=function(){function t(){this.added=Lt.NONE,this.removed=Lt.NONE,this.locked=Lt.NONE}return t.prototype.add=function(t){return this.removed&=~t,this.added|=t,this},t.prototype.remove=function(t){return this.added&=~t,this.removed|=t,this},t.prototype.lock=function(t){return this.locked|=t,this},t.prototype.unlock=function(t){return this.locked&=~t,this},t.prototype.clear=function(){return this.added=Lt.NONE,this.removed=Lt.NONE,this.locked=Lt.NONE,this},t.prototype.set=function(t,e,n){return null!=t&&(this.added=t),null!=e&&(this.removed=e),null!=n&&(this.locked=n),this},t.prototype.copy=function(t){return this.added=t.added,this.removed=t.removed,this.locked=t.locked,this},t}(),Bt=function(){function t(){this._count=0,this._flag=0}return t.prototype.lock=function(){return this._count+=1,1===this._count&&(this._flag=0,!0)},t.prototype.unlock=function(){return this._count-=1,this._count<=0&&0!==this._flag},t.prototype.isLocked=function(t){return 0<this._count&&(this._flag|=t?3:1,!0)},t.prototype.isHigh=function(){return 1<this._flag},t}(),zt={TRANSFORM_CHILD:1,TRANSFORM_THIS:2,TRANSFORM_PARENT:4,TRANSFORM:7,UPLOADED:8,TRANSFORM_AND_UPLOADED:15,CONNECTOR:16,ALL:31},Ut={CURRENT:null},jt=function(e){function n(t){var n=e.call(this)||this;return n.id="",n.uuid=0,n.type=t,n.transform=n.newTransform(),n.action=new dt,n._visible=!0,n._lockTransformChild=new Bt,n._lockTransformThis=new Bt,n._lockTransformParent=new Bt,n._lockUploaded=new Bt,n._boundsTransformId=-1,n._boundsInternalTransformId=-1,n._boundsLocalTransformId=-1,n.interactive=!1,n.parent=null,n.children=[],n.selected=!1,n.index=0,n.reference=0,n}return F(n,e),n.prototype.newTransform=function(){return new Pt(this)},n.prototype.onSizeChange=function(){this._boundsTransformId=-1,this._boundsInternalTransformId=-1,this._boundsLocalTransformId=-1,this._lockTransformChild.isLocked()||this.callChildTransformChange();var t=this._points;null!=t&&t.onSizeChange(),this.updateUploaded();var e=this._connector;null!=e&&e.fit(!0);var n=this.runtime;null!=n&&(Ut.CURRENT=this,n.onResize(this),Ut.CURRENT=null)},n.prototype.onTransformChange=function(){this._lockTransformChild.isLocked()||this.callChildTransformChange(),this._lockTransformThis.isLocked()||this.onThisTransformChange(),this._lockTransformParent.isLocked()||this.callParentTransformChange()},n.prototype.callChildTransformChange=function(){var t=this.parent;null!=t&&t.onChildTransformChange()},n.prototype.onThisTransformChange=function(){this.updateUploaded();var t=this._connector;null!=t&&t.fit(!0)},n.prototype.callParentTransformChange=function(){for(var t=this.children,e=0,n=t.length;e<n;++e)t[e].onParentTransformChange()},n.prototype.onParentTransformChange=function(){this._lockTransformThis.isLocked()||this.onThisTransformChange(),this._lockTransformParent.isLocked()||this.callParentTransformChange()},n.prototype.lock=function(t){return t&zt.UPLOADED&&this._lockUploaded.lock(),t&zt.TRANSFORM_PARENT&&this._lockTransformParent.lock(),t&zt.TRANSFORM_THIS&&this._lockTransformThis.lock(),t&zt.TRANSFORM_CHILD&&this._lockTransformChild.lock(),this},n.prototype.unlock=function(t,e){if(t&zt.TRANSFORM_CHILD&&this._lockTransformChild.unlock()&&e){var n=this.parent;null!=n&&n.onChildTransformChange()}if(t&zt.TRANSFORM_THIS&&this._lockTransformThis.unlock()&&e&&this.onThisTransformChange(),t&zt.TRANSFORM_PARENT&&this._lockTransformParent.unlock()&&e)for(var i=this.children,r=0,o=i.length;r<o;++r)i[r].onParentTransformChange();if(t&zt.UPLOADED){var s=this._lockUploaded;s.unlock()&&e&&this.updateUploaded(s.isHigh())}return this},n.prototype.onChildTransformChange=function(){},n.prototype.updateUploaded=function(t){if(!this._lockUploaded.isLocked(t)){var e=this.uploaded;if(null!=e&&e.update(this),!0===t)for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].updateUploaded(!0)}},Object.defineProperty(n.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){for(var t=this;t.parent instanceof n;)t=t.parent;return t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"connector",{get:function(){var t=this._connector;return null==t&&(t=new yt(this),this._connector=t),t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"visible",{get:function(){if(this._visible){var t=this.parent;return!(t instanceof n)||t.visible}return!1},set:function(t){this._visible!==t&&(this._visible=t,this.updateUploaded(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"worldVisible",{get:function(){if(this._visible){var t=this.parent;return!t||t.worldVisible}return!1},enumerable:!1,configurable:!0}),n.prototype.toDirty=function(){var t=this.parent;null!=t&&t.toDirty()},n.prototype.attach=function(t,e){this.detach(),this.parent=t;var n=t.children;return null!=e&&0<=e&&e<n.length?n.splice(e,0,this):n.push(this),t.onChildTransformChange(),t.toDirty(),this.onAttach(),this},n.prototype.onAttach=function(){this.uploaded=void 0;var t=this._connector;t&&(t.attach(),t.fit(!0));for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].onAttach()},n.prototype.detach=function(t){var e=this.parent;if(e){this.parent=null;var n=e.children,i=n.indexOf(this);0<=i&&(n.splice(i,1),e.onChildTransformChange(),e.toDirty(),this.onDetach(t))}return this},n.prototype.onDetach=function(t){this.uploaded=void 0;var e=this._connector;e&&e.detach(t);for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].onDetach(t)},n.prototype.updateTransform=function(){var e=this.parent;e?(e.parent&&e.updateTransform(),this.transform.updateTransform(e.transform)):this.transform.updateTransform(t.Transform.IDENTITY)},n.prototype.serializeChildren=function(t){for(var e=this.children,n=[],i=0,r=e.length;i<r;++i){var o=e[i];n.push(o.serialize(t))}return n},n.prototype.serializeState=function(t){var e=this.state;return(this.interactive?1:0)|(e.isFocusable?0:2)|(e.isActive?4:0)},n.prototype.serialize=function(t){var e=this.transform,n=e.position,i=e.pivot,r=this.size,o=this.shortcut,s=null!=o?t.addResource(o):-1,a=this.cursor,u=null!=a?t.addResource(a):-1,l=this.title,h=null!=l?t.addResource(l):-1,c=Lt.NONE,p=Lt.NONE,f=Lt.NONE,d=this._capability;return null!=d&&(c=d.added,p=d.removed,f=d.locked),[this.type,t.addResource(this.id),n.x,n.y,r.x,r.y,e.rotation,e.skew.x,this.fill.serialize(t),this.stroke.serialize(t),u,this.text.serialize(t),this.data.serialize(t),this.radius,this.corner,-1,-1,this.action.serialize(t),this.serializeImage(t),this.serializeGradient(t),this.serializeChildren(t),i.x,i.y,this.serializeState(t),s,h,this.uuid,c,p,f]},n.prototype.addUuid=function(t){this.uuid=t.addUuid(this.uuid);for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].addUuid(t)},n.prototype.updateUuid=function(t){this.uuid=t.updateUuid(this.uuid);for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].updateUuid(t)},n.prototype.getShapeScale=function(){var t=this.root.parent;return null!=t&&null!=t.getShapeScale?t.getShapeScale():1},n.prototype.getStrokeWidthScale=function(t){return t&s.NON_EXPANDING_WIDTH?t&s.NON_SHRINKING_WIDTH?this.getShapeScale():Math.min(1,this.getShapeScale()):t&s.NON_SHRINKING_WIDTH?Math.max(1,this.getShapeScale()):1},n.prototype.getHitTestSize=function(t){var e=this.size;return t.width=.5*e.x,t.height=.5*e.y,t},n.prototype.toHitTestData=function(t,e){var i,r=this.getHitTestSize(null!==(i=n.WORK_HIT_TEST_DATA)&&void 0!==i?i:n.WORK_HIT_TEST_DATA=new Mt),o=r.width,s=r.height,a=this.transform.pivot,u=t-a.x,l=e-a.y,h=this.stroke,c=h.enable?h.width:0,p=this.getStrokeWidthScale(h.style),f=h.align,d=this.toHitTestStrokeShift(c,p,f);return r.set(0<=o?+u:-u,0<=s?+l:-l,Math.abs(o)+d,Math.abs(s)+d,c,p,f)},n.prototype.toHitTestStrokeShift=function(t,e,n){return t*e*n},n.prototype.contains=function(t,e){var n=this.toHitTestData(t,e);return this.containsAbs(n.x,n.y,n.width,n.height,n.strokeWidth,n.strokeScale,n.strokeAlign)?this:this.containsText(t,e)||this.containsChildren(t,e)},n.prototype.containsText=function(t,e){var n=this.text;if(null!=n.atlas){var i=n.world;if(null!=i){var r=this.transform.internalTransform,o=r.a*t+r.c*e+r.tx-i[0],s=r.b*t+r.d*e+r.ty-i[1],a=i[2]*o+i[3]*s,u=i[4]*o+i[5]*s,l=i[6],h=i[7];if(0<=a&&a<=l&&0<=u&&u<=h)return this}}return null},n.prototype.containsChildren=function(t,e){for(var n=this.children,i=n.length-1;0<=i;--i){var r=n[i];r.updateTransform();var o=r.transform.localTransform,s=o.a,a=o.b,u=o.c,l=o.d,h=o.tx,c=o.ty,p=1/(s*l-u*a),f=(l*t-u*e+c*u-h*l)*p,d=(s*e-a*t-c*s+h*a)*p,y=r.contains(f,d);if(null!=y)return y}return null},n.prototype.containsBBox=function(t,e){var n=this.toHitTestData(t,e);return this.containsAbsBBox(n.x,n.y,n.width,n.height)},n.prototype.containsAbs=function(t,e,n,i,r,o,s){return this.containsAbsBBox(t,e,n,i)},n.prototype.containsAbsBBox=function(t,e,n,i){return kt(t,e,n,i)},n.prototype.select=function(t){return!1},n.prototype.toGlobal=function(t,e,n){return!0!==n&&this.updateTransform(),e.copyFrom(t),this.transform.worldTransform.apply(e,e),e},n.prototype.toLocal=function(e,n,i,r){return!0!==r&&this.updateTransform(),void 0===i&&(i=new t.Point),i.copyFrom(e),this.transform.worldTransform.applyInverse(i,i),i},n.prototype.getBounds=function(e,n){!0!==e&&this.updateTransform();var i=this._bounds||new t.Rectangle;this._bounds=i;var r=this.transform.getWorldId();return r!==this._boundsTransformId&&(this._boundsTransformId=r,this.getBounds_(this.transform.worldTransform,i)),null!=n||(n=new t.Rectangle),n.copyFrom(i),n},n.prototype.getBoundsInternal=function(e,n){!0!==e&&this.updateTransform();var i=this._boundsInternal||new t.Rectangle;this._boundsInternal=i;var r=this.transform.getLocalIdCurrent();return r!==this._boundsInternalTransformId&&(this._boundsInternalTransformId=r,this.getBounds_(this.transform.internalTransform,i)),null!=n||(n=new t.Rectangle),n.copyFrom(i),n},n.prototype.getBoundsLocal=function(e,n){!0!==e&&this.updateTransform();var i=this._boundsLocal||new t.Rectangle;this._boundsLocal=i;var r=this.transform.getLocalIdCurrent();return r!==this._boundsLocalTransformId&&(this._boundsLocalTransformId=r,this.getBounds_(this.transform.localTransform,i)),null!=n||(n=new t.Rectangle),n.copyFrom(i),n},n.prototype.getBoundsSize=function(){return this.size},n.prototype.getBounds_=function(t,e){var n=this.transform.pivot,i=n.x,r=n.y,o=this.getBoundsSize(),s=.5*o.x,a=.5*o.y,u=t.a,l=t.b,h=t.c,c=t.d,p=-s+i,f=-a+r,d=u*p+h*f,y=l*p+c*f,g=u*(p=+s+i)+h*(f=-a+r),v=l*p+c*f,_=u*(p=-s+i)+h*(f=+a+r),m=l*p+c*f,b=u*(p=+s+i)+h*(f=+a+r),T=l*p+c*f,w=Math.min(d,g,_,b),E=Math.min(y,v,m,T),O=Math.max(d,g,_,b),C=Math.max(y,v,m,T);return e.x=w+t.tx,e.y=E+t.ty,e.width=O-w,e.height=C-E,e},n.prototype.destroy=function(){for(var t=this.children,e=t.length-1;0<=e;--e)t[e].destroy();t.length=0},n.prototype.onStateChange=function(t,e){var i=this.runtime;null!=i&&(Ut.CURRENT=this,i.onStateChange(this,t,e),Ut.CURRENT=null);for(var r=this.children,o=0,s=r.length;o<s;++o){var a=r[o];a instanceof n&&a.state.onParentChange(t,e)}},Object.defineProperty(n.prototype,"state",{get:function(){var t=this,e=this._state;return null==e&&(e=new Rt((function(e,n){t.onStateChange(e,n)})),this._state=e),e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"capability",{get:function(){var t=this._capability;return null==t&&(t=new Nt,this._capability=t),t},enumerable:!1,configurable:!0}),n.prototype.getCapability=function(){return this._capability},n.prototype.focus=function(){return this.setFocused(!0),this},n.prototype.blur=function(){return this.setFocused(!1),this},n.prototype.setFocused=function(t){if(this.state.isFocused!==t){var e=ft.getLayer(this);e&&e.getFocusController().set(this,t)}},n.prototype.onKeyDown=function(t){var e=this.runtime;if(e){Ut.CURRENT=this;var n=e.onKeyDown(this,t);return Ut.CURRENT=null,n}return!1},n.prototype.onKeyUp=function(t){var e=this.runtime;if(e){Ut.CURRENT=this;var n=e.onKeyUp(this,t);return Ut.CURRENT=null,n}return!1},n.prototype.update=function(t){var e=this.runtime;e&&(Ut.CURRENT=this,e.update(this,t),Ut.CURRENT=null)},n.prototype.onRender=function(t,e){var n=this.runtime;n&&(Ut.CURRENT=this,n.onRender(this,t,e),Ut.CURRENT=null)},n.prototype.copy=function(t,e){if(void 0===e&&(e=gt.ALL),this.lock(zt.ALL),this.id=t.id,this.uuid=t.uuid,this.visible=t.visible,e&gt.TRANSFORM){var i=this.transform,r=t.transform;i.position.copyFrom(r.position),i.rotation=r.rotation,i.skew.copyFrom(r.skew),i.pivot.copyFrom(r.pivot),i.scale.copyFrom(r.scale)}if(e&gt.SIZE&&this.size.copyFrom(t.size),e&gt.STYLE&&(this.fill.copy(t.fill),this.stroke.copy(t.stroke),this.text.copy(t.text),this.radius=t.radius,this.corner=t.corner),e&gt.DATA&&this.data.copy(t.data),e&gt.IMAGE&&(this.image=t.image),e&gt.ACTION&&(this.action.clearAndAddAll(t.action.values),this.interactive=t.interactive,this.title=t.title,this.cursor=t.cursor,this.shortcut=t.shortcut),e&gt.POINTS){var o=t.points;if(null!=o){var s=this.points;null!=s&&s.copy(o)}}if(e&gt.STATE&&this.state.lock(!1).copy(t.state).unlock(),e&gt.CONNECTOR)if(t instanceof n){var a=t._connector;a?this.connector.copy(a):(u=this._connector)&&u.clear()}else{var u;(u=this._connector)&&u.clear()}if(e&gt.CAPABILITY){var l=t.getCapability();if(null!=l)this.capability.copy(l);else{var h=this._capability;null!=h&&h.clear()}}return this.unlock(zt.ALL,!0),this},n}(t.utils.EventEmitter),Ft=function(){function t(t,e,n,i,r,o,s,a){this._parent=t,this._enable=e,this._color=n,this._alpha=i,this._width=r,this._align=o,this._side=s,this._style=a}return Object.defineProperty(t.prototype,"enable",{get:function(){return this._enable},set:function(t){this._enable!==t&&(this._enable=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){return this._side},set:function(t){this._side!==t&&(this._side=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(t){this._style!==t&&(this._style=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha,t.width,t.align,t.side,t.style)},t.prototype.set=function(t,e,n,i,r,o,s){var a=!1;void 0!==t&&this._enable!==t&&(this._enable=t,a=!0),void 0!==e&&this._color!==e&&(this._color=e,a=!0),void 0!==n&&this._alpha!==n&&(this._alpha=n,a=!0),void 0!==i&&this._width!==i&&(this._width=i,a=!0),void 0!==r&&this._align!==r&&(this._align=r,a=!0),void 0!==o&&this._side!==o&&(this._side=o,a=!0),void 0!==s&&this._style!==s&&(this._style=s,a=!0),a&&this._parent.updateUploaded()},t.prototype.clone=function(){return new t(this._parent,this._enable,this._color,this._alpha,this._width,this._align,this._side,this._style)},t.prototype.toObject=function(){return{enable:this._enable,color:this._color,alpha:this._alpha,width:this._width,align:this._align,side:this._side,style:this._style}},t.prototype.serialize=function(t){var e=this._enable?1:0,n="[".concat(e,",").concat(this._color,",").concat(this._alpha,",").concat(this._width,",").concat(this._align,",").concat(this._side,",").concat(this._style,"]");return t.addResource(n)},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getStroke(t);if(null!=i)this.set(!!i[0],i[1],i[2],i[3],i[4],i[5],i[6]);else{var r=JSON.parse(n[t]);e.setStroke(t,r),this.set(!!r[0],r[1],r[2],r[3],r[4],r[5],r[6])}}},t}(),Ht={NONE:0,FROM:1,TO:2,FROM_TO:3},Gt=function(){function t(){this._type=Ht.NONE,this._from=0,this._to=1}return Object.defineProperty(t.prototype,"type",{get:function(){return this._type},set:function(t){if(this._type!==t){this._type=t;var e=this.parent;null!=e&&(e.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"from",{get:function(){return this._from},set:function(t){if(this._from!==t){this._from=t;var e=this.parent;null!=e&&(e.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this._to},set:function(t){if(this._to!==t){this._to=t;var e=this.parent;null!=e&&(e.isChanged=!0)}},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;if(void 0!==t&&void 0!==e)if(null!==t&&null!==e){var i=this._type|Ht.FROM|Ht.TO;this._type===i&&this._from===t&&this._to===e||(this._type=i,this._from=t,this._to=e,n=!0)}else null!==t?(i=(this._type|Ht.FROM)&~Ht.TO,this._type===i&&this._from===t||(this._type=i,this._from=t,n=!0)):null!==e?(i=(this._type|Ht.TO)&~Ht.FROM,this._type===i&&this._from===t||(this._type=i,this._to=e,n=!0)):(i=this._type&~(Ht.TO|Ht.FROM),this._type!==i&&(this._type=i,n=!0));else void 0!==t?null!==t?(i=this._type|Ht.FROM,this._type===i&&this._from===t||(this._type=i,this._from=t,n=!0)):(i=this._type&~Ht.FROM,this._type!==i&&(this._type=i,n=!0)):void 0!==e&&(null!==e?(i=this._type|Ht.TO,this._type===i&&this._to===e||(this._type=i,this._to=e,n=!0)):(i=this._type&~Ht.TO,this._type!==i&&(this._type=i,n=!0)));if(n){var r=this.parent;null!=r&&(r.isChanged=!0)}return n},t.prototype.normalize=function(t){var e=this._type,n=this._from,i=this._to;switch(e){case Ht.FROM_TO:return(t-n)/(i-n);case Ht.FROM:return t-n;case Ht.TO:return i-t;case Ht.NONE:default:return t}},t.prototype.isEquals=function(t){return this._type===t.type&&this._from===t.from&&this._to===t.to},t.prototype.copy=function(t){return this.copy_(t.type,t.from,t.to)},t.prototype.copy_=function(t,e,n){var i=!1;if(this._type!==t&&(this._type=t,i=!0),this._from!==e&&(this._from=e,i=!0),this._to!==n&&(this._to=n,i=!0),i){var r=this.parent;null!=r&&(r.isChanged=!0)}return this},t.prototype.toObject=function(){return{type:this.type,from:this.from,to:this.to}},t.prototype.serialize=function(t){var e="[".concat(this._type,",").concat(this._from,",").concat(this._to,"]");return t.addResource(e)},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getRange(t);if(null!=i)this.copy_(i[0],i[1],i[2]);else{var r=JSON.parse(n[t]);e.setRange(t,r),this.copy_(r[0],r[1],r[2])}}},t}(),Vt={ASCENDING:0,DESCENDING:1},Wt={BOOLEAN:7,BOOLEAN_ARRAY:8,NUMBER:0,NUMBER_ARRAY:1,STRING:2,STRING_ARRAY:3,OBJECT:4,OBJECT_ARRAY:5,TICKER:6,EXTENSION:1e3},Kt={PRIVATE:0,PUBLIC:1,PROTECTED:2},Xt={UNKNOWN:-1,FOUND:0,NOT_FOUND:1,BAD_REQUEST:2,SERVER_ERROR:3,SERVICE_UNAVAILABLE:4,FORBIDDEN:5,NOT_DEFINED:6},Yt=function(t,e){return t-e},qt=function(){function t(){this.id="",this.as="",this.type=Wt.NUMBER,this.scope=Kt.PUBLIC,this.initial="",this.format="",this.range=new Gt,this._value=0,this._time=0,this._state=Xt.UNKNOWN,this._capacity=0,this._order=Vt.ASCENDING}return Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},set:function(t){this._parent!==t&&(this._parent=t,this.range.parent=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){var e=this.formatter;null!=e&&(t=e(t));var n=this._capacity;if(n<=0){if(this._value!==t){this._value=t;var i=this.parent;null!=i&&(i.isChanged=!0)}}else{var r=this._values;null==r&&(r=[],this._values=r),this._value=t;var o=this._order;o===Vt.ASCENDING?r.push(t):r.unshift(t);var s=r.length-n;if(0<s)if(o===Vt.ASCENDING)for(var a=0;a<s;++a)r.shift();else r.length=n;var u=this.parent;null!=u&&(u.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nvalue",{get:function(){return this.range.normalize(this._value)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var t=this._values;return null==t&&(t=[],this._values=t),t},set:function(t){var e=t.length;if(0<e){var n=this._capacity;if(n<=0){var i=t[e-1];if(null!=(s=this.formatter)&&(i=s(i)),this._value!==i){this._value=i;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var o=this._values;null==o&&(o=[],this._values=o);var s,a=this._order;if(null!=(s=this.formatter))if(this._value=s(t[e-1]),a===Vt.ASCENDING)for(var u=0;u<e;++u)o.push(s(t[u]));else for(u=0;u<e;++u)o.unshift(s(t[u]));else if(this._value=t[e-1],a===Vt.ASCENDING)for(u=0;u<e;++u)o.push(t[u]);else for(u=0;u<e;++u)o.unshift(t[u]);var l=o.length-n;if(0<l)if(a===Vt.ASCENDING)for(u=0;u<l;++u)o.shift();else o.length=n;var h=this.parent;null!=h&&(h.isChanged=!0)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){return this._time},set:function(t){var e=this._capacity;if(e<=0){if(this._time!==t){this._time=t;var n=this.parent;null!=n&&(n.isChanged=!0)}}else{var i=this._times;null==i&&(i=[],this._times=i),this._time=t;var r=this._order;r===Vt.ASCENDING?i.push(t):i.unshift(t);var o=i.length-e;if(0<o)if(r===Vt.ASCENDING)for(var s=0;s<o;++s)i.shift();else i.length=e;var a=this.parent;null!=a&&(a.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"times",{get:function(){var t=this._times;return null==t&&(t=[],this._times=t),t},set:function(t){var e=t.length;if(0<e){var n=this._capacity;if(n<=0){var i=t[e-1];if(this._time!==i){this._time=i;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var o=this._times;null==o&&(o=[],this._times=o),this._time=t[e-1];var s=this._order;if(s===Vt.ASCENDING)for(var a=0;a<e;++a)o.push(t[a]);else for(a=0;a<e;++a)o.unshift(t[a]);var u=o.length-n;if(0<u)if(s===Vt.ASCENDING)for(a=0;a<u;++a)o.shift();else o.length=n;var l=this.parent;null!=l&&(l.isChanged=!0)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._state},set:function(t){var e=this._capacity;if(e<=0){if(this._state!==t){this._state=t;var n=this.parent;null!=n&&(n.isChanged=!0)}}else{var i=this._states;null==i&&(i=[],this._states=i),this._state=t;var r=this._order;r===Vt.ASCENDING?i.push(t):i.unshift(t);var o=i.length-e;if(0<o)if(r===Vt.ASCENDING)for(var s=0;s<o;++s)i.shift();else i.length=e;var a=this.parent;null!=a&&(a.isChanged=!0)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"states",{get:function(){var t=this._states;return null==t&&(t=[],this._states=t),t},set:function(t){var e=t.length;if(0<e){var n=this._capacity;if(n<=0){var i=t[e-1];if(this._state!==i){this._state=i;var r=this.parent;null!=r&&(r.isChanged=!0)}}else{var o=this._states;null==o&&(o=[],this._states=o),this._state=t[e-1];var s=this._order;if(s===Vt.ASCENDING)for(var a=0;a<e;++a)o.push(t[a]);else for(a=0;a<e;++a)o.unshift(t[a]);var u=o.length-n;if(0<u)if(s===Vt.ASCENDING)for(a=0;a<u;++a)o.shift();else o.length=n;var l=this.parent;null!=l&&(l.isChanged=!0)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){return this._capacity},set:function(t){if(this._capacity<t)this._capacity=t;else if(t<this._capacity){this._capacity=t;var e=!1,n=this._order,i=this._values;if(null!=i&&0<(s=i.length-t)){if(n===Vt.ASCENDING)for(var r=0;r<s;++r)i.shift();else i.length=t;e=!0}var o=this._times;if(null!=o&&0<(s=o.length-t)){if(n===Vt.ASCENDING)for(r=0;r<s;++r)o.shift();else o.length=t;e=!0}var s,a=this._states;if(null!=a&&0<(s=a.length-t)){if(n===Vt.ASCENDING)for(r=0;r<s;++r)a.shift();else a.length=t;e=!0}if(e){var u=this.parent;null!=u&&(u.isChanged=!0)}}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"order",{get:function(){return this._order},set:function(t){this._order=t},enumerable:!1,configurable:!0}),t.prototype.remove=function(t){var e=!1,n=this._values;null!=n&&0<=t&&t<n.length&&(n.splice(t,1),e=!0);var i=this._times;null!=i&&0<=t&&t<i.length&&(i.splice(t,1),e=!0);var r=this._states;if(null!=r&&0<=t&&t<r.length&&(r.splice(t,1),e=!0),e){var o=this.parent;null!=o&&(o.isChanged=!0)}},t.prototype.removeAll=function(t){var e=!1,n=t.slice(0).sort(Yt),i=n.length,r=this._values;if(null!=r)for(var o=i-1;0<=o;--o)0<=(u=n[o])&&u<r.length&&(r.splice(u,1),e=!0);var s=this._times;if(null!=s)for(o=i-1;0<=o;--o)0<=(u=n[o])&&u<s.length&&(s.splice(u,1),e=!0);var a=this._states;if(null!=a)for(o=i-1;0<=o;--o){var u;0<=(u=n[o])&&u<a.length&&(a.splice(u,1),e=!0)}if(e){var l=this.parent;null!=l&&(l.isChanged=!0)}},t.prototype.clear=function(){var t=!1,e=this._values;null!=e&&(e.length=0,t=!0);var n=this._times;null!=n&&(n.length=0,t=!0);var i=this._states;if(null!=i&&(i.length=0,t=!0),t){var r=this.parent;null!=r&&(r.isChanged=!0)}},t.prototype.toDirty=function(){var t=this.parent;null!=t&&(t.isChanged=!0)},t.prototype.copy=function(t){return this.id=t.id,this.as=t.as,this.type=t.type,this.scope=t.scope,this.initial=t.initial,this.format=t.format,this.formatter=t.formatter,this.range.copy(t.range),this._value=t.value,this._time=t.time,this._state=t.state,this._capacity=t.capacity,this},t.prototype.isEquals=function(t){return this.id===t.id&&this.as===t.as&&this.type===t.type&&this.scope===t.scope&&this.initial===t.initial&&this.formatter===t.formatter&&this.range.isEquals(t.range)},t.prototype.serialize=function(t){var e=t.addData(this.id),n=t.addResource(this.as),i=t.addResource(this.initial),r=t.addResource(this.format.trim()),o=this.range.serialize(t);return t.addResource("[".concat(e,",").concat(i,",").concat(r,",").concat(o,",").concat(this._capacity,",").concat(this._order,",").concat(this.type,",").concat(this.scope,",").concat(n,"]"))},t.prototype.deserialize=function(t,e){var n,i,r=e.resources;if(0<=t&&t<r.length){var o=e.getDataValue(t);null==o&&(o=JSON.parse(r[t]),e.setDataValue(t,o)),this.id=e.data[o[0]]||"";var s=o[8];this.as=null!=s&&r[s]||"",this.type=null!==(n=o[6])&&void 0!==n?n:Wt.NUMBER,this.scope=null!==(i=o[7])&&void 0!==i?i:Kt.PUBLIC,this.initial=r[o[1]]||"",this.format=r[o[2]]||"",this.range.deserialize(o[3],e),this._capacity=o[4],this._order=o[5]}return this},t}(),Zt=function(){function t(){this.values=[]}return t.prototype.add=function(t,e){var n=this.values;return null!=e?n.splice(e,0,t):n.push(t),this},t.prototype.addAll=function(t){for(var e=this.values,n=0,i=t.length;n<i;++n)e.push(t[n]);return this},t.prototype.clearAndAdd=function(t){return this.clear(),this.add(t),this},t.prototype.clearAndAddAll=function(t){return this.clear(),this.addAll(t),this},t.prototype.indexOf=function(t){for(var e=this.values,n=0,i=e.length;n<i;++n)if((r=e[n])===t)return n;for(n=0,i=e.length;n<i;++n){var r;if((r=e[n])[0]===t[0]&&r[1]===t[1]&&r[2]===t[2])return n}return-1},t.prototype.get=function(t){var e=this.values;return 0<=t||t<e.length?e[t]:null},t.prototype.set=function(t,e){var n=this.values;if(0<=t||t<n.length){var i=n[t];return n[t]=e,i}return null},t.prototype.remove=function(t){var e=this.values;return 0<=t||t<e.length?e.splice(t,1)[0]:null},t.prototype.clear=function(){return this.values.length=0,this},t.prototype.size=function(){return this.values.length},t.prototype.swap=function(t,e){var n=this.values,i=n[e];return n[e]=n[t],n[t]=i,this},t.prototype.copy=function(t){this.clearAndAddAll(t.values)},t.prototype.serialize=function(t){var e=this.values;if(e.length<=0)return-1;for(var n="[",i="",r=0,o=e.length;r<o;++r){var s=e[r],a=t.addResource(s[0]),u=t.addResource(s[1]),l=t.addResource(s[2]);n+="".concat(i).concat(a,",").concat(u,",").concat(l),i=","}return n+="]",t.addResource(n)},t.prototype.deserialize=function(t,e){var n=this.values;n.length=0;var i=e.resources,r=i.length;if(0<=t&&t<r){var o=e.getDataMapping(t);null==o&&(o=JSON.parse(i[t]),e.setDataMapping(t,o));for(var s=0,a=o.length;s<a;s+=3){var u=o[s],l=o[s+1],h=o[s+2];n.push([0<=u&&u<r?i[u]:"",0<=l&&l<r?i[l]:"",0<=h&&h<r?i[h]:""])}}},t}(),Jt=function(){function t(){}return Object.defineProperty(t.prototype,"ids",{get:function(){var t=this._data;if(null==t)return[];var e=[];return t.forEach((function(t,n){e.push(n)})),e},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){var n,i=null!==(n=this._data)&&void 0!==n?n:this._data=new Map,r=i.get(t);null==r?i.set(t,[e]):r.push(e)},t.prototype.set=function(t,e,n,i,r,o){var s=this._data;if(null==s)return!1;var a=s.get(t);if(null==a)return!1;var u=a.length;if(u<=0)return!1;for(var l=0;l<u;++l){var h=a[l];h.range.set(r,o),void 0!==n&&(h.time=n),void 0!==i&&(h.state=i),h.value=e}return!0},t.prototype.toDirty=function(t){var e=this._data;if(null==e)return!1;var n=e.get(t);if(null==n)return!1;var i=n.length;if(i<=0)return!1;for(var r=0;r<i;++r)n[r].toDirty();return!0},t.prototype.each=function(t){var e=this._data;if(null==e)return null;var n=null;return e.forEach((function(e,i){null==n&&!1===t(i)&&(n=i)})),n},t}(),Qt=function(){function t(){this._data=new Map}return t.prototype.set=function(t,e){return this._data.set(t,e),this},t.prototype.get=function(t){var e;return null!==(e=this._data.get(t))&&void 0!==e?e:null},t.prototype.contains=function(t){return this._data.has(t)},t.prototype.remove=function(t){var e=this._data,n=e.get(t);return e.delete(t),null!=n?n:null},t.prototype.clear=function(){return this._data.clear(),this},t.prototype.size=function(){return this._data.size},t.prototype.each=function(t){var e=!1;return this._data.forEach((function(n,i){e||!1===t(n,i)&&(e=!0)})),this},t.prototype.copy=function(t){var e=this._data;return e.clear(),t.each((function(t,n){e.set(n,t)})),this},t.prototype.serialize=function(t){var e=this._data;if(e.size<=0)return-1;var n=[];return e.forEach((function(e,i){var r=t.addResource(e),o=t.addResource(i);n.push(o,r)})),t.addResource(JSON.stringify(n))},t.prototype.deserialize=function(t,e){var n=this._data;n.clear();var i=e.resources,r=i.length;if(0<=t&&t<r){var o=e.getDataSystem(t);null==o&&(o=JSON.parse(i[t]),e.setDataSystem(t,o));for(var s=0,a=o.length;s<a;s+=2){var u=o[s];if(0<=u&&u<r){var l=i[u],h=o[s+1];0<=h&&h<r&&n.set(l,i[h])}}}},t}(),$t=function(){function t(){this._values=[],this._isChanged=!0}return Object.defineProperty(t.prototype,"values",{get:function(){return this._values},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isChanged",{get:function(){return this._isChanged},set:function(t){this._isChanged=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var t=this._values;return 0<t.length?t[0].id:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"as",{get:function(){var t=this._values;return 0<t.length?t[0].as:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){var t=this._values;return 0<t.length?t[0].type:Wt.NUMBER},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scope",{get:function(){var t=this._values;return 0<t.length?t[0].scope:Kt.PRIVATE},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"initial",{get:function(){var t=this._values;return 0<t.length?t[0].initial:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"format",{get:function(){var t=this._values;return 0<t.length?t[0].format:""},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){var t=this._values;return 0<t.length?t[0].range:null!=V?V:V=new Gt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){var t=this._values;return 0<t.length?t[0].value:0},set:function(t){var e=this._values;0<e.length&&(e[0].value=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nvalue",{get:function(){var t=this._values;return 0<t.length?t[0].nvalue:0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"time",{get:function(){var t=this._values;return 0<t.length?t[0].time:0},set:function(t){var e=this._values;0<e.length&&(e[0].time=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){var t=this._values;return 0<t.length?t[0].state:Xt.UNKNOWN},set:function(t){var e=this._values;0<e.length&&(e[0].state=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"capacity",{get:function(){var t=this._values;return 0<t.length?t[0].capacity:0},set:function(t){var e=this._values;0<e.length&&(e[0].capacity=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alias",{get:function(){var t=this._alias;return null==t&&(t=this.newAlias(),this._alias=t),t},enumerable:!1,configurable:!0}),t.prototype.newAlias=function(){var t=this._values,e=t.length;if(0<e){for(var n={},i=0;i<e;++i){var r=t[i];n[r.as||r.id]=r}return n}return null!=W?W:W={}},Object.defineProperty(t.prototype,"mapping",{get:function(){var t=this._mapping;return null==t&&(t=this.newMapping(),this._mapping=t),t},enumerable:!1,configurable:!0}),t.prototype.newMapping=function(){return new Zt},t.prototype.getMapping=function(){return this._mapping},Object.defineProperty(t.prototype,"private",{get:function(){var t=this._private;return null==t&&(t=this.newPrivate(),this._private=t),t},enumerable:!1,configurable:!0}),t.prototype.newPrivate=function(){return new Jt},t.prototype.getPrivate=function(){return this._private},Object.defineProperty(t.prototype,"system",{get:function(){var t=this._system;return null==t&&(t=this.newSystem(),this._system=t),t},enumerable:!1,configurable:!0}),t.prototype.newSystem=function(){return new Qt},t.prototype.getSystem=function(){return this._system},t.prototype.add=function(t,e){var n=this._values;t.parent=this,void 0===e?n.push(t):n.splice(e,0,t)},t.prototype.set=function(t,e){var n=this._values;if(0<=t&&t<n.length){var i=n[t];return e.parent=this,n[t]=e,i.parent=void 0,i}return null},t.prototype.remove=function(t){var e=this._values;0<=t&&t<e.length&&(e.splice(t,1)[0].parent=void 0)},t.prototype.indexOf=function(t){for(var e=this._values,n=e.length,i=0;i<n;++i)if(e[i]===t)return i;for(i=0;i<n;++i)if(e[i].isEquals(t))return i;for(i=0;i<n;++i)if(e[i].id===t.id)return i;return-1},t.prototype.get=function(t){var e=this._values;return 0<=t&&t<e.length?e[t]:null},t.prototype.size=function(){return this._values.length},t.prototype.swap=function(t,e){var n=this._values,i=n[e];n[e]=n[t],n[t]=i},t.prototype.copy=function(t){var e=this._values;e.length=0;for(var n=0,i=t.size();n<i;++n){var r=t.get(n);if(null!=r){var o=(new qt).copy(r);o.parent=this,e.push(o)}}var s=t.getMapping();s&&this.mapping.copy(s);var a=t.getSystem();return a&&this.system.copy(a),this},t.prototype.serialize=function(t){for(var e=this._values,n=[],i=0,r=e.length;i<r;++i)n.push(e[i].serialize(t));var o,s=this._mapping;return null!=s?(n.push(s.serialize(t)),null!=(o=this._system)?t.addResource("[".concat(JSON.stringify(n),",").concat(o.serialize(t),"]")):t.addResource("[".concat(JSON.stringify(n),"]"))):null!=(o=this._system)?(n.push(-1),t.addResource("[".concat(JSON.stringify(n),",").concat(o.serialize(t),"]"))):t.addResource(JSON.stringify(n))},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getData(t);null==i&&(i=JSON.parse(n[t]),e.setData(t,i));var r=this._values;if(r.length=0,this.isMapped(i)){for(var o=i[0],s=o.length,a=0,u=s-1;a<u;++a){var l=o[a];(p=new qt).parent=this,p.deserialize(l,e),r.push(p)}var h=o[s-1];0<=h&&this.mapping.deserialize(h,e);var c=i[1];null!=c&&0<=c&&this.system.deserialize(c,e)}else for(a=0,u=i.length;a<u;++a){var p;l=i[a],(p=new qt).parent=this,p.deserialize(l,e),r.push(p)}}},t.prototype.isMapped=function(t){return 0<t.length&&Ot(t[0])},t}(),te=function(){function t(t,e,n){this._parent=t,this._horizontal=e,this._vertical=n}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return this._horizontal},set:function(t){this._horizontal!==t&&(this._horizontal=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this._vertical},set:function(t){this._vertical!==t&&(this._vertical=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.horizontal,t.vertical)},t.prototype.set=function(t,e){var n=!1;null!=t&&this._horizontal!==t&&(this._horizontal=t,n=!0),null!=e&&this._vertical!==e&&(this._vertical=e,n=!0),n&&this._parent.updateUploaded()},t.prototype.toObject=function(){return{horizontal:this._horizontal,vertical:this._vertical}},t.prototype.serialize=function(t){return t.addResource("[".concat(this._horizontal,",").concat(this._vertical,"]"))},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getAlign(t);if(null!=i)this.set(i[0],i[1]);else{var r=JSON.parse(n[t]);e.setAlign(t,r),this.set(r[0],r[1])}}},t}(),ee=function(){function t(t,e,n){this._parent=t,this._horizontal=e,this._vertical=n}return Object.defineProperty(t.prototype,"horizontal",{get:function(){return this._horizontal},set:function(t){this._horizontal!==t&&(this._horizontal=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this._vertical},set:function(t){this._vertical!==t&&(this._vertical=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.horizontal,t.vertical)},t.prototype.set=function(t,e){var n=!1;null!=t&&this._horizontal!==t&&(this._horizontal=t,n=!0),null!=e&&this._vertical!==e&&(this._vertical=e,n=!0),n&&this._parent.updateUploaded()},t.prototype.toObject=function(){return{horizontal:this._horizontal,vertical:this._vertical}},t.prototype.serialize=function(t){return t.addResource("[".concat(this._horizontal,",").concat(this._vertical,"]"))},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getMargin(t);if(null!=i)this.set(i[0],i[1]);else{var r=JSON.parse(n[t]);e.setMargin(t,r),this.set(r[0],r[1])}}},t}(),ne=function(){function t(t,e,n,i,r){this._parent=t,this._enable=e,this._color=n,this._alpha=i,this._width=r}return Object.defineProperty(t.prototype,"enable",{get:function(){return this._enable},set:function(t){this._enable!==t&&(this._enable=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){t&&this.set(t.enable,t.color,t.alpha,t.width)},t.prototype.set=function(t,e,n,i){var r=!1;void 0!==t&&this._enable!==t&&(this._enable=t,r=!0),void 0!==e&&this._color!==e&&(this._color=e,r=!0),void 0!==n&&this._alpha!==n&&(this._alpha=n,r=!0),void 0!==i&&this._width!==i&&(this._width=i,r=!0),r&&this._parent.updateUploaded()},t.prototype.clone=function(){return new t(this._parent,this._enable,this._color,this._alpha,this._width)},t.prototype.toObject=function(){return{enable:this._enable,color:this._color,alpha:this._alpha,width:this._width}},t.prototype.serialize=function(t){var e="[".concat(this._enable?1:0,",").concat(this._color,",").concat(this._alpha,",").concat(this._width,"]");return t.addResource(e)},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getTextOutline(t);if(null!=i)this.set(!!i[0],i[1],i[2],i[3]);else{var r=JSON.parse(n[t]);e.setTextOutline(t,r),this.set(!!r[0],r[1],r[2],r[3])}}},t}(),ie=function(){function t(t,e,n,i,r,o){this._parent=t,this._enable=!0,this._value=e,this._plength=this._length=e.length,this._color=n,this._alpha=i,this._family=r,this._size=o,this._weight=m.NORMAL,this.align=new te(t,T.CENTER,w.MIDDLE),this.offset=new ee(t,0,0),this._style=b.NORMAL,this.spacing=new ee(t,0,0),this.outline=new ne(t,!1,16777215,1,.5),this._direction=E.LEFT_TO_RIGHT,this.padding=new ee(t,10,10),this._clipping=!1,this._fitting=!1,this._characters=[],this._nacharacters=[],this.updateCharacters(e)}return Object.defineProperty(t.prototype,"enable",{get:function(){return this._enable},set:function(t){this._enable!==t&&(this._enable=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){return this._value},set:function(t){if(this._value!==t){this._value=t;var e=t.length;this._length=e,this._plength<e&&(this._plength=e),this.updateCharacters(t),this.isCompatible()?this._parent.updateUploaded():(this.atlas=void 0,this._parent.toDirty())}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"characters",{get:function(){return this._characters},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nacharacters",{get:function(){return this._nacharacters},enumerable:!1,configurable:!0}),t.prototype.updateCharacters=function(t){for(var e=this._characters,n=e.length,i=0,r=this._nacharacters,o=r.length,s=0,a=0,u=t.length;a<u;){var l=t.charCodeAt(a);if(C.ASCII.LOW.FROM<=l&&l<=C.ASCII.LOW.TO||C.ASCII.HIGH.FROM<=l&&l<=C.ASCII.HIGH.TO){var h=t.substring(a,a+1);i<n?e[i]=h:e.push(h),i+=1,a+=1}else{for(var c=a+1;c<u;++c){var p=t.charCodeAt(c);if(!(C.SURROGATE.LOW.FROM<=p&&p<=C.SURROGATE.LOW.TO||C.VARIATION.FROM<=p&&p<=C.VARIATION.TO))break}var f=t.substring(a,c);i<n?e[i]=f:e.push(f),i+=1,s<o?r[s]=f:r.push(f),s+=1,a=c}}i<n&&(e.length=i),s<o&&(r.length=s)},t.prototype.isCompatible=function(){var t=this._parent,e=t.uploaded;if(null==e||!e.isCompatible(t))return!1;var n=this.atlas;if(null==n)return!1;for(var i=n.characters,r=this._nacharacters,o=0,s=r.length;o<s;++o)if(!i.has(r[o]))return!1;return!0},Object.defineProperty(t.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plength",{get:function(){return this._plength},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"family",{get:function(){return this._family},set:function(t){this._family!==t&&(this._family=t,this._parent.toDirty())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},set:function(t){this._size!==t&&(this._size=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"weight",{get:function(){return this._weight},set:function(t){this._weight!==t&&(this._weight=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return this._style},set:function(t){this._style!==t&&(this._style=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){return this._clipping},set:function(t){this._clipping!==t&&(this._clipping=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fitting",{get:function(){return this._fitting},set:function(t){this._fitting!==t&&(this._fitting=t,this._parent.updateUploaded())},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){return t&&(this.set(t.value,t.color,t.alpha,t.family,t.size,t.weight,t.style,t.direction,t.clipping,t.fitting),this.align.copy(t.align),this.offset.copy(t.offset),this.outline.copy(t.outline),this.spacing.copy(t.spacing),this.padding.copy(t.padding)),this},t.prototype.set=function(t,e,n,i,r,o,s,a,u,l){var h=!1,c=!1;if(null!=t&&this._value!==t){this._value=t;var p=t.length;this._length=p,this._plength<p&&(this._plength=p),this.updateCharacters(t),this.isCompatible()?c=!0:(this.atlas=void 0,h=!0)}return null!=e&&this._color!==e&&(this._color=e,c=!0),null!=n&&this._alpha!==n&&(this._alpha=n,c=!0),null!=i&&this._family!==i&&(this._family=i,h=!0),null!=r&&this._size!==r&&(this._size=r,c=!0),null!=o&&this._weight!==o&&(this._weight=o,c=!0),null!=s&&this._style!==s&&(this._style=s,c=!0),null!=a&&this._direction!==a&&(this._direction=a,c=!0),null!=u&&this._clipping!==u&&(this._clipping=u,c=!0),null!=l&&this._fitting!==l&&(this._fitting=l,c=!0),h?this._parent.toDirty():c&&this._parent.updateUploaded(),this},t.prototype.toObject=function(){return{value:this._value,color:this._color,alpha:this._alpha,family:this._family,size:this._size,weight:this._weight,align:this.align.toObject(),offset:this.offset.toObject(),style:this._style,outline:this.outline.toObject(),direction:this._direction,spacing:this.spacing.toObject(),padding:this.padding.toObject(),clipping:this._clipping,fitting:this._fitting}},t.prototype.serialize=function(t){var e=t.addResource(this._value),n=t.addResource(this._family),i=this.align.serialize(t),r=this.offset.serialize(t),o=this.outline.serialize(t),s=this.spacing.serialize(t),a=this.padding.serialize(t),u=this._clipping?1:0,l=this._fitting?1:0,h="[".concat(e,",").concat(this._color,",").concat(this._alpha,",").concat(n,",").concat(this._size,",")+"".concat(this._weight,",").concat(i,",").concat(r,",").concat(this._style,",").concat(o,",")+"".concat(s,",").concat(this._direction,",").concat(a,",").concat(u,",").concat(l,"]");return t.addResource(h)},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getText(t);null==i&&(i=JSON.parse(n[t]),e.setText(t,i)),this.set(n[i[0]]||"",i[1],i[2],n[i[3]]||"auto",i[4],i[5],i[8],i[11],!!i[13],!!i[14]),this.align.deserialize(i[6],e),this.offset.deserialize(i[7],e),this.outline.deserialize(i[9],e),this.spacing.deserialize(i[10],e),this.padding.deserialize(i[12],e)}},t}(),re=function(t){for(var e=t.points,n="[".concat(t.direction),i=0,r=e.length,o=1;i<r;i+=1,o+=3){var s=e[i];n+=",".concat(s.color,",").concat(s.alpha,",").concat(s.position)}return n+"]"},oe=function(e){function n(t){var n=e.call(this,t)||this;n.size=n.newSize(),n.fill=n.newFill(),n.stroke=n.newStroke(),n._radius=rt.RADIUS,n._corner=pt.ALL;var i=new $t;return n.data=i,n.tag=i,n.text=n.newText(),n}return F(n,e),n.prototype.newSize=function(){var e=this;return new t.ObservablePoint((function(){e.onSizeChange()}),void 0,rt.SIZE_X,rt.SIZE_Y)},n.prototype.newFill=function(){return new st(this,!0,rt.FILL_COLOR,rt.FILL_ALPHA,rt.FILL_DIRECTION,rt.FILL_PERCENT)},n.prototype.newStroke=function(){return new Ft(this,!0,rt.STROKE_COLOR,rt.STROKE_ALPHA,rt.STROKE_WIDTH,rt.STROKE_ALIGN,rt.STROKE_SIDE,rt.STROKE_STYLE)},n.prototype.newText=function(){return new ie(this,rt.TEXT_VALUE,rt.TEXT_COLOR,rt.TEXT_ALPHA,rt.TEXT_FAMILY,rt.TEXT_SIZE)},Object.defineProperty(n.prototype,"corner",{get:function(){return this._corner},set:function(t){this._corner!==t&&(this._corner=t,this.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"radius",{get:function(){return this._radius},set:function(t){this._radius!==t&&(this._radius=t,this.updateUploaded())},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"image",{get:function(){return this._image},set:function(t){if(this._image!==t){this._image=null!=t?t:void 0;var e=this.parent;null!=e&&e.toDirty()}},enumerable:!1,configurable:!0}),n.prototype.serializeImage=function(t){var e=this._image;return null!=e?t.addResource(e.url):-1},n.prototype.serializeGradient=function(t){var e=this.gradient;return null!=e?(null==e.serialized&&(e.serialized=re(e)),t.addResource(e.serialized)):-1},n}(jt),se=function(t,e,n,i,r,o,s){if(t.fill.enable){if((h=e*e)*(u=r*r)+(c=n*n)*(a=i*i)<=a*u)return!0}else if(0<o){var a,u,l=o*s,h=e*e,c=n*n,p=Math.max(0,i-l),f=Math.max(0,r-l),d=p*p,y=f*f;if(d*y<=h*y+c*d&&h*(u=r*r)+c*(a=i*i)<=a*u)return!0}return!1},ae=function(t,e,n,i,r,o,s){if(kt(e,n,i,r)){if(t.fill.enable)return!0;var a=t.stroke.side;if(0<o&&a!==Z.NONE){var u=o*s,l=Math.max(0,i-u),h=Math.max(0,r-u);if(!kt(e,n,l,h))return!(a!==Z.ALL&&!(e<=-l?n<=-h?a&Z.TOP_OR_LEFT:+h<=n?a&Z.BOTTOM_OR_LEFT:a&Z.LEFT:+l<=e?n<=-h?a&Z.TOP_OR_RIGHT:+h<=n?a&Z.BOTTOM_OR_RIGHT:a&Z.RIGHT:n<=-h?a&Z.TOP:+h<=n&&a&Z.BOTTOM))}}return!1},ue=function(t,e,n,i,r){return+n*t+i-e<=0&&-n*t+i-e<=0&&e<=r},le=function(t,e,n,i,r,o,s){var a=2*r/i;if(t.fill.enable){if(ue(e,n,a,-r,+r))return!0}else if(0<o){var u=o*s;if(ue(e,n,a,-r,+r)){var l=2*i*r/(i+Math.sqrt(i*i+4*r*r)),h=r-l,c=h+(-r-h)*Math.max(0,l-u)/l;if(!ue(e,n,a,c,r-u))return!0}}return!1},he=function(t,e,n){return.5*(n+t*e)},ce=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getHitTestSize=function(e){var n=this._points.formatted;if("boundary"in n){var i=n.boundary;e.width=Math.max(Math.abs(i[0]),Math.abs(i[2])),e.height=Math.max(Math.abs(i[1]),Math.abs(i[3]))}else t.prototype.getHitTestSize.call(this,e);return e},e.prototype.toMarkerSize=function(t){var e=0,n=t.getMarker();if(n){var i=n.head;if(i.type!==ot.NONE){var r=i.size;e=Math.max(e,2*Math.max(Math.abs(r.x),Math.abs(r.y)))}var o=n.tail;o.type!==ot.NONE&&(r=o.size,e=Math.max(e,2*Math.max(Math.abs(r.x),Math.abs(r.y))))}return e},e.prototype.containsAbsMarker=function(t,e,n,i,r,o){var s=t.type;if(s!==ot.NONE){var a=t.transform,u=a.a,l=a.b,h=a.c,c=a.d,p=a.tx,f=a.ty,d=1/(u*c-h*l),y=(c*e-h*n+f*h-p*c)*d,g=(u*n-l*e-f*u+p*l)*d,v=t.size,_=.5*v.x,m=.5*v.y;_<0&&(_=-_,e=-e),m<0&&(m=-m,n=-n);var b=i*r*o;switch(_+=b,m+=b,s){case ot.CIRCLE:return se(this,y,g,_,m,i,r);case ot.TRIANGLE:return le(this,y,g,_,m,i,r);case ot.RECTANGLE:return ae(this,y,g,_,m,i,r)}}return!1},e.prototype.containsAbs=function(t,e,n,i,r,o,s){var a=this._points,u=he(r,o,0),l=u+this.toMarkerSize(a);if(this.containsAbsBBox(t,e,n+l,i+l)){var h=a.getMarker();if(h){if(this.containsAbsMarker(h.head,t,e,r,o,s))return!0;if(this.containsAbsMarker(h.tail,t,e,r,o,s))return!0}var c=this.calcHitPointAbsHitTester;return a.calcHitPointAbs(t,e,n,i,u,null,c,null)}return!1},e.prototype.calcHitPart=function(t,e){var n=this.toHitTestData(t,e),i=n.strokeWidth,r=n.strokeScale,o=he(i,r,0),s=this._points,a=o+this.toMarkerSize(s),u=n.x,l=n.y,h=n.width,c=n.height;if(this.containsAbsBBox(u,l,h+a,c+a)){var p=s.getMarker();if(p){var f=n.strokeAlign;if(this.containsAbsMarker(p.head,u,l,i,r,f))return ct.MARKER_HEAD;if(this.containsAbsMarker(p.tail,u,l,i,r,f))return ct.MARKER_TAIL}var d=this.calcHitPointAbsHitTester;if(s.calcHitPointAbs(u,l,h,c,o,null,d,null))return ct.LINE}return this.containsText(t,e)?ct.TEXT:this.containsChildren(t,e)?ct.CHILDREN:ct.NONE},e.prototype.calcHitPoint=function(t,e,n,i,r,o){var s=this._points,a=this.toHitTestData(t,e),u=(n||he)(a.strokeWidth,a.strokeScale,0);return!!this.containsAbsBBox(a.x,a.y,a.width+u,a.height+u)&&s.calcHitPointAbs(a.x,a.y,a.width,a.height,u,i,r,o)},e.prototype.calcHitPointAbsHitTester=function(t,e,n,i,r,o,s,a,u){var l=r-n,h=o-i,c=t-n,p=e-i,f=l*l+h*h,d=l*c+h*p,y=c*c+p*p;if(1e-4<f){var g=Math.max(0,Math.min(1,d/f));if(f*g*g-2*d*g+y<a*a)return!0}return!1},e}(oe),pe=function(t){function e(e){void 0===e&&(e=i.BAR);var n=t.call(this,e)||this;return n._points=new ht(n),n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbsBBox=function(e,n,i,r){var o=Math.max(0,this._points.size);return t.prototype.containsAbsBBox.call(this,e,n,i+o,r+o)},e.prototype.serialize=function(e){var n=t.prototype.serialize.call(this,e);return n[15]=this._points.serialize(e),n},e}(ce),fe=function(t){function e(e,n,i){var r=t.call(this,e,n,i,4,2)||this;return r.pointsId=-1,r.pointsStyle=X.NONE,r}return F(e,t),e.prototype.init=function(){var t=this.vertexOffset,e=this.indexOffset,n=this.buffer;n.updateIndices(),g(n.indices,t,e),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexStep(e,t),this.updateColor(e,t),this.updateUv(e,t)},e.prototype.updateVertexStep=function(t,e){if(e instanceof pe){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=e.stroke,a=s.enable?s.width:0,u=s.style,l=a!==this.strokeWidth||u!==this.strokeStyle,h=$(e),c=this.transformLocalId!==h,p=e.points,f=p.id,d=f!==this.pointsId,y=p.style,g=y!==this.pointsStyle;(!(this.inited&Y.VERTEX_AND_STEP)||o||c||l||d||g)&&(this.inited|=Y.VERTEX_AND_STEP,this.sizeX=i,this.sizeY=r,this.strokeWidth=a,this.strokeStyle=u,this.transformLocalId=h,this.pointsId=f,this.pointsStyle=y,d&&(this.inited&=~Y.UV),t.updateVertices(),t.updateSteps(),v(t.vertices,t.steps,this.vertexOffset,p.values,p.size,a,u,e.transform.internalTransform))}},e.prototype.updateUv=function(t,e){var n=tt(e),i=et(n);(!(this.inited&Y.UV)||n!==this.texture||i!==this.textureTransformId)&&(this.inited|=Y.UV,this.texture=n,this.textureTransformId=i,t.updateUvs(),_(t.uvs,this.vertexOffset,nt(n)))},e}(Q),de=function(){function e(t,e,n,i,r){this.buffer=t,this.vertexOffset=e,this.indexOffset=n,this.vertexCount=i,this.indexCount=r,this.inited=Y.NONE,this.sizeX=0,this.sizeY=0,this.transformLocalId=0,this.scaleX=1,this.scaleY=1,this.size=0,this.family="auto",this.value="",this.texture=null,this.textureTransformId=0,this.color=0,this.alpha=0,this.weight=0,this.style=0,this.alignHorizontal=0,this.alignVertical=0,this.offsetHorizontal=0,this.offsetVertical=0,this.outlineWidth=0,this.outlineColor=0,this.outlineAlpha=0,this.spacingHorizontal=0,this.spacingVertical=0,this.direction=0,this.paddingHorizontal=0,this.paddingVertical=0,this.clipping=!1,this.fitting=!1}return e.prototype.init=function(){if(0<this.vertexCount){var t=this.buffer,e=this.vertexOffset;t.updateIndices(),I(t.indices,e,this.indexOffset,this.indexCount)}return this.inited|=Y.INDEX,this},e.prototype.reinit=function(t,e,n,i){var r=D(e),o=r<<2,s=r<<1;return this.buffer===t&&this.vertexOffset===n&&this.indexOffset===i&&this.vertexCount===o&&this.indexCount===s||!!t.check(n,i,o,s)&&(this.inited=Y.NONE,this.buffer=t,this.vertexOffset=n,this.indexOffset=i,this.vertexCount=o,this.indexCount=s,this.init(),!0)},e.prototype.isCompatible=function(t){return D(t)<<2===this.vertexCount},e.prototype.update=function(t){if(0<this.vertexCount){var e=t.text.atlas;if(null!=e){var n=this.buffer;this.updateVertex(n,t,e),this.updateColor(n,t),this.updateStep(n,t)}}return this},e.prototype.updateVertex=function(e,n,i){var r=n.size,o=r.x,s=r.y,a=o!==this.sizeX||s!==this.sizeY,u=$(n),l=this.transformLocalId!==u,h=n.text,c=h.size,p=h.family,f=h.value,d=h.style,y=h.align.horizontal,g=h.align.vertical,v=h.offset.horizontal,_=h.offset.vertical,m=h.spacing.horizontal,b=h.spacing.vertical,T=h.direction,w=h.padding.horizontal,E=h.padding.vertical,O=h.clipping,C=h.fitting,S=h.texture||t.Texture.WHITE,x=et(S),D=f!==this.value||p!==this.family,I=c!==this.size,A=d!==this.style,R=y!==this.alignHorizontal||g!==this.alignVertical,M=v!==this.offsetHorizontal||_!==this.offsetVertical,k=m!==this.spacingHorizontal||b!==this.spacingVertical||w!==this.paddingHorizontal||E!==this.paddingVertical,L=T!==this.direction,N=this.clipping!==O,B=this.fitting!==C,z=S!==this.texture||x!==this.textureTransformId;if(!(this.inited&Y.VERTEX)||a||l||D||I||A||R||M||k||L||N||B||z){this.inited|=Y.VERTEX,this.size=c,this.family=p,this.value=f,this.style=d,this.alignHorizontal=y,this.alignVertical=g,this.offsetHorizontal=v,this.offsetVertical=_,this.spacingHorizontal=m,this.spacingVertical=b,this.direction=T,this.paddingHorizontal=w,this.paddingVertical=E,this.clipping=O,this.fitting=C,this.texture=S,this.textureTransformId=x,(I||B||C&&a)&&(this.inited&=~Y.STEP),e.updateVertices(),e.updateUvs();var U=n.size,j=h.world;null==j&&(j=[0,0,0,0,0,0,0,0],h.world=j),P(e.vertices,e.uvs,this.vertexOffset,this.vertexCount,0,0,U.x,U.y,i,c,h.characters,d,y,g,v,_,m,b,T,w,E,O,C,j,nt(S),n.transform.internalTransform)}},e.prototype.updateColor=function(t,e){var n=e.text,i=n.color,r=e.visible&&n.enable?n.alpha:0,o=n.outline,s=o.color,a=e.visible&&n.enable?o.alpha:0;(!(this.inited&Y.COLOR)||i!==this.color||r!==this.alpha||i!==this.outlineColor||r!==this.outlineAlpha)&&(this.inited|=Y.COLOR,this.color=i,this.alpha=r,this.outlineColor=s,this.outlineAlpha=a,t.updateColors(),q(i,r,s,a,this.vertexOffset,this.vertexCount,t.colors))},e.prototype.updateStep=function(t,e){var n=e.text,i=n.outline,r=i.enable?i.width:0,o=r!==this.outlineWidth,s=n.weight,a=s!==this.weight,u=1,l=1,h=n.world;null!=h&&(u=h[8],l=h[9]);var c=S<Math.abs(this.scaleX-u)||S<Math.abs(this.scaleY-l);(!(this.inited&Y.STEP)||a||o||c)&&(this.inited|=Y.STEP,this.weight=s,this.outlineWidth=r,this.scaleX=u,this.scaleY=l,t.updateSteps(),A(t.steps,this.vertexOffset,this.vertexCount,n.atlas,n.size,r,s,this.scaleX,this.scaleY))},e.prototype.buildUnit=function(e){if(0<this.vertexCount){var n=this.texture||t.Texture.WHITE,i=n.baseTexture;i!==e.baseTexture&&(e.baseTexture=i,e.push(n,this.indexOffset))}},e}(),ye=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=4+a,h=2+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new fe(t,n,i),new de(t,n+4,i+2,a,u)]).init(e):null},ge=function(t,e,n){var i=t.length;if(e<i)return t;for(var r="",o=0,s=e-i;o<s;++o)r+=n;return r+t},ve=function(){function t(){}return t.toCode=function(t){return ge(t.toString(16).toUpperCase(),6,"0")},t.fromCode=function(t){var e=t.trim().toLowerCase();if(6===e.length){var n=Number("0x".concat(e));if(n==n)return n}return null},t.fromRgb=function(t,e,n){return 255*t<<16|255*e<<8|255*n|0},t.blend=function(t,e,n){var i=t>>16&255,r=t>>8&255,o=255&(0|t),s=e>>16&255,a=e>>8&255,u=255&(0|e),l=Math.max(0,Math.min(1,n)),h=1-l;return Math.max(0,Math.min(255,i*h+s*l))<<16|Math.max(0,Math.min(255,r*h+a*l))<<8|0|Math.max(0,Math.min(255,o*h+u*l))},t.brighten=function(t,e){return 0<=e?this.blend(t,16777215,e):this.blend(t,0,-e)},t.darken=function(t,e){return 0<=e?this.blend(t,0,e):this.blend(t,16777215,-e)},t.toGrayscale=function(t){var e=this.toLuma(t);return e<<16|e<<8|e},t.toLuma=function(t){return.2126*(t>>16&255)+.7152*(t>>8&255)+.0722*(255&(0|t))&255},t}(),_e={NONE:0,POSITION_X:1,POSITION_Y:2,POSITION:3,ROTATION:4,COLOR_FILL:8,COLOR_STROKE:16,COLOR_FILL_AND_STROKE:24,COLOR_TEXT:32,COLOR_TEXT_OUTLINE:64,COLOR:120,VISIBILITY:128,HEIGHT:256,WIDTH:512,SIZE:768,TEXT:1024,CURSOR:2048,FILL_PERCENT:4096},me=function(){function t(){}return t.toBaseFill=function(t,e){return(e.written&_e.COLOR_FILL?t:e).fill},t.toBaseStroke=function(t,e){return(e.written&_e.COLOR_STROKE?t:e).stroke},t.toBaseText=function(t,e){return(e.written&_e.COLOR_TEXT?t:e).text},t.toBaseTextOutline=function(t,e){return(e.written&_e.COLOR_TEXT_OUTLINE?t:e).text.outline},t}(),be={isInitializing:!1},Te=function(){function t(){}return t.from=function(t,e,n,i,r,o){if(t.trim().length<=0)return n;try{var s="try {with (shape) {with (state) {with (data.alias) {with (environment) {"+(r?"var result = (".concat(t,");")+"return (result != null ? ".concat(e,"(result) : null);"):"return ".concat(e,"(").concat(t,");"))+"}}}}} catch (e) {"+"return ".concat(i,";")+"}";return null==o?Function("shape","time","environment",s):Function("shape","time","environment",o,s)}catch(t){return n}},t.ofNumberOrNull=function(t){return this.from(t,"Number",this.NULL,"null",!0)},t.ofStringOrNull=function(t){return this.from(t,"String",this.NULL,"null",!0)},t.ofUnknown=function(t){return this.from(t,"",this.NULL,"null",!1)},t.ofNumber=function(t){return this.from(t,"Number",this.ZERO,"0",!1)},t.ofNumberOrOne=function(t){return this.from(t,"Number",this.ONE,"1",!1)},t.ofNumberOrOneHundred=function(t){return this.from(t,"Number",this.ONE_HUNDRED,"100",!1)},t.ofString=function(t){return this.from(t,"String",this.EMPTY,'""',!1)},t.ofBoolean=function(t){return this.from(t,"Boolean",this.TRUE,"true",!1)},t.ofBooleanOrTrue=function(t){return this.from(t,"Boolean",this.TRUE,"true",!1)},t.ofBooleanOrFalse=function(t){return this.from(t,"Boolean",this.FALSE,"false",!1)},t.ofElementOrNull=function(t){return this.from(t,"",void 0,"null",!1,"container")},t.NULL=function(){return null},t.ZERO=function(){return 0},t.ONE=function(){return 1},t.ONE_HUNDRED=function(){return 100},t.EMPTY=function(){return""},t.TRUE=function(){return!0},t.FALSE=function(){return!1},t}(),we=function(){function t(t){this.reset=t||_e.NONE}return t.prototype.initialize=function(t,e){},t.prototype.execute=function(t,e,n){},t.prototype.onResize=function(t,e){},t.prototype.onFocus=function(t,e){},t.prototype.onBlur=function(t,e){},t.prototype.onClick=function(t,e,n){},t.prototype.onDblClick=function(t,e,n,i){},t.prototype.onDowning=function(t,e,n){},t.prototype.onDown=function(t,e,n){},t.prototype.onMove=function(t,e,n){},t.prototype.onOver=function(t,e,n){},t.prototype.onOut=function(t,e,n){},t.prototype.onUp=function(t,e,n){},t.prototype.onUpOutside=function(t,e,n){},t.prototype.onPressed=function(t,e,n){},t.prototype.onUnpressed=function(t,e,n){},t.prototype.onKeyDown=function(t,e,n){},t.prototype.onKeyUp=function(t,e,n){},t.prototype.onRightClick=function(t,e,n){},t.prototype.onRightDowning=function(t,e,n){},t.prototype.onRightDown=function(t,e,n){},t.prototype.onRightUp=function(t,e,n){},t.prototype.onRightUpOutside=function(t,e,n){},t.prototype.onRightPressed=function(t,e,n){},t.prototype.onRightUnpressed=function(t,e,n){},t.prototype.onRender=function(t,e,n,i){},t}(),Ee=function(t){function e(e,n){var i=t.call(this,n)||this;return i.condition=Te.ofBoolean(e.condition),i}return F(e,t),e}(we),Oe=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.interval=e.interval,i}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.interval,r=i<<1,o=n%r;o<i?(this.toOff(t,e),e.effect=n+(i-o)):(this.toOn(t,e),e.effect=n+(r-o))}},e.prototype.toOn=function(t,e){},e.prototype.toOff=function(t,e){},e}(Ee),Ce=function(t){function e(e){return t.call(this,e,_e.COLOR)||this}return F(e,t),e.prototype.toOn=function(t,e){var n=me.toBaseFill(t,e);t.fill.set(void 0,ve.brighten(n.color,.5),n.alpha);var i=me.toBaseStroke(t,e);t.stroke.set(void 0,ve.brighten(i.color,.5),i.alpha);var r=me.toBaseText(t,e);t.text.set(void 0,ve.brighten(r.color,.5),r.alpha);var o=me.toBaseTextOutline(t,e);t.text.outline.set(void 0,ve.brighten(o.color,.5),o.alpha),e.written|=this.reset},e}(Oe),Se=function(t){function e(e){var n=t.call(this,e,_e.COLOR_FILL)||this;return n.color=e.color,n.alpha=e.alpha,n}return F(e,t),e.prototype.toOn=function(t,e){t.fill.set(void 0,this.color,this.alpha),e.written|=this.reset},e}(Oe),xe=function(t){function e(e){var n=t.call(this,e,_e.COLOR_STROKE)||this;return n.color=e.color,n.alpha=e.alpha,n}return F(e,t),e.prototype.toOn=function(t,e){t.stroke.set(void 0,this.color,this.alpha),e.written|=this.reset},e}(Oe),De=function(t){function e(e){return t.call(this,e,_e.COLOR)||this}return F(e,t),e.prototype.toOn=function(t,e){var n=me.toBaseFill(t,e);t.fill.set(void 0,ve.darken(n.color,.5),n.alpha);var i=me.toBaseStroke(t,e);t.stroke.set(void 0,ve.darken(i.color,.5),i.alpha);var r=me.toBaseText(t,e);t.text.set(void 0,ve.darken(r.color,.5),r.alpha);var o=me.toBaseTextOutline(t,e);t.text.outline.set(void 0,ve.darken(o.color,.5),o.alpha),e.written|=this.reset},e}(Oe),Ie=function(t){function e(e){return t.call(this,e,_e.COLOR_FILL_AND_STROKE)||this}return F(e,t),e.prototype.toOn=function(t,e){var n=me.toBaseFill(t,e);t.fill.set(void 0,n.color,.5*n.alpha);var i=me.toBaseStroke(t,e);t.stroke.set(void 0,i.color,.5*i.alpha),e.written|=this.reset},e}(Oe),Ae=function(t){function e(e){return t.call(this,e,_e.VISIBILITY)||this}return F(e,t),e.prototype.toOn=function(t,e){t.visible=!0,e.written|=this.reset},e.prototype.toOff=function(t,e){t.visible=!1,e.written|=this.reset},e}(Oe),Re={VISIBILITY:0,BRIGHTEN:1,DARKEN:2,OPACITY:3,COLOR_FILL:4,COLOR_STROKE:5},Pe=function(){function t(t,e){this.type=t,this.condition=e}return t.prototype.isEquals=function(t){return this.type===t.type&&this.condition===t.condition},t.prototype.toLabel=function(){return this.getTheme().toLabel(this)},t.prototype.getTheme=function(){var e;return null!==(e=t.THEME)&&void 0!==e?e:t.THEME=it.getInstance().get("EShapeActionValue")},t}(),Me=function(t){function e(e,n,i){var r=t.call(this,e,n)||this;return r.subtype=i,r}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.subtype===n.subtype},e}(Pe),ke={SHOW_HIDE:0,BLINK:1,TRANSFORM:2,OPEN:3,EMIT_EVENT:4,CHANGE_COLOR_LEGACY:5,CHANGE_TEXT:6,CHANGE_CURSOR:7,MISC:8,CHANGE_COLOR:9,GESTURE:10,CHANGE_FILL_PERCENT:11,EXTENSION:1e3},Le=function(){function t(){}return t.toResource=function(t,e,n){if(0<=t&&t<e.length){var i=e[t];if(St(i)&&0<=i&&i<n.length)return n[i]}return""},t}(),Ne=function(t){function e(e,n,i,r,o){var s=t.call(this,ke.BLINK,n,e)||this;return s.interval=i,s.color=r,s.alpha=o,s}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.interval===n.interval&&this.color===n.color&&this.alpha===n.alpha},e.prototype.toRuntime=function(){switch(this.subtype){case Re.BRIGHTEN:return new Ce(this);case Re.COLOR_FILL:return new Se(this);case Re.COLOR_STROKE:return new xe(this);case Re.DARKEN:return new De(this);case Re.OPACITY:return new Ie(this);case Re.VISIBILITY:return new Ae(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(this.interval,",").concat(this.color,",").concat(this.alpha,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources);return new e(t[2],i,t[3],t[4],t[5])},e}(Me),Be=function(){function t(){}return t.blend=function(t,e,n){var i=Math.max(0,Math.min(1,n));return Math.max(0,Math.min(1,t*(1-i)+e*i))},t}(),ze=function(t){function e(e){return t.call(this,e,e.subtype<<3)||this}return F(e,t),e.prototype.set=function(t,e,n,i,r,o){var s=this.reset;if(null!=i){if(null!=r)if(null!=o){if(s&_e.COLOR_FILL){var a=me.toBaseFill(t,e);t.fill.set(void 0,ve.blend(a.color,i,o),Be.blend(a.alpha,r,o))}s&_e.COLOR_STROKE&&(a=me.toBaseStroke(t,e),t.stroke.set(void 0,ve.blend(a.color,i,o),Be.blend(a.alpha,r,o))),s&_e.COLOR_TEXT&&(a=me.toBaseText(t,e),t.text.set(void 0,ve.blend(a.color,i,o),Be.blend(a.alpha,r,o))),s&_e.COLOR_TEXT_OUTLINE&&(a=me.toBaseTextOutline(t,e),t.text.outline.set(void 0,ve.blend(a.color,i,o),Be.blend(a.alpha,r,o)))}else s&_e.COLOR_FILL&&t.fill.set(void 0,i,r),s&_e.COLOR_STROKE&&t.stroke.set(void 0,i,r),s&_e.COLOR_TEXT&&t.text.set(void 0,i,r),s&_e.COLOR_TEXT_OUTLINE&&t.text.outline.set(void 0,i,r);else null!=o?(s&_e.COLOR_FILL&&(a=me.toBaseFill(t,e),t.fill.set(void 0,ve.blend(a.color,i,o),a.alpha)),s&_e.COLOR_STROKE&&(a=me.toBaseStroke(t,e),t.stroke.set(void 0,ve.blend(a.color,i,o),a.alpha)),s&_e.COLOR_TEXT&&(a=me.toBaseText(t,e),t.text.set(void 0,ve.blend(a.color,i,o),a.alpha)),s&_e.COLOR_TEXT_OUTLINE&&(a=me.toBaseTextOutline(t,e),t.text.outline.set(void 0,ve.blend(a.color,i,o),a.alpha))):(s&_e.COLOR_FILL&&(a=me.toBaseFill(t,e),t.fill.set(void 0,i,a.alpha)),s&_e.COLOR_STROKE&&(a=me.toBaseStroke(t,e),t.stroke.set(void 0,i,a.alpha)),s&_e.COLOR_TEXT&&(a=me.toBaseText(t,e),t.text.set(void 0,i,a.alpha)),s&_e.COLOR_TEXT_OUTLINE&&(a=me.toBaseTextOutline(t,e),t.text.outline.set(void 0,i,a.alpha)));e.written|=s}else null!=r&&(null!=o?(s&_e.COLOR_FILL&&(a=me.toBaseFill(t,e),t.fill.set(void 0,a.color,Be.blend(a.alpha,r,o))),s&_e.COLOR_STROKE&&(a=me.toBaseStroke(t,e),t.stroke.set(void 0,a.color,Be.blend(a.alpha,r,o))),s&_e.COLOR_TEXT&&(a=me.toBaseText(t,e),t.text.set(void 0,a.color,Be.blend(a.alpha,r,o))),s&_e.COLOR_TEXT_OUTLINE&&(a=me.toBaseTextOutline(t,e),t.text.outline.set(void 0,a.color,Be.blend(a.alpha,r,o)))):(s&_e.COLOR_FILL&&(a=me.toBaseFill(t,e),t.fill.set(void 0,a.color,r)),s&_e.COLOR_STROKE&&(a=me.toBaseStroke(t,e),t.stroke.set(void 0,a.color,r)),s&_e.COLOR_TEXT&&(a=me.toBaseText(t,e),t.text.set(void 0,a.color,r)),s&_e.COLOR_TEXT_OUTLINE&&(a=me.toBaseTextOutline(t,e),t.text.outline.set(void 0,a.color,r))),e.written|=s)},e}(Ee),Ue={COLOR_AND_ALPHA:0,COLOR:1,ALPHA:2,CODE:3,BRIGHTNESS:4},je=function(t){function e(e){var n=t.call(this,e)||this;switch(e.target){case Ue.COLOR:n.color=e.color,n.alpha=null;break;case Ue.ALPHA:n.color=null,n.alpha=e.alpha;break;default:n.color=e.color,n.alpha=e.alpha}return n.blend=Te.ofNumberOrNull(e.blend),n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.color,r=this.alpha,o=this.blend(t,n,be);this.set(t,e,n,i,r,o)}},e}(ze),Fe={NONE:0,FILL:1,STROKE:2,TEXT:4,TEXT_OUTLINE:8,FILL_AND_STROKE:3,ALL:15},He={FILL:0,STROKE:1,FILL_AND_STROKE:2,TEXT:3,TEXT_OUTLINE:4,ALL:5},Ge=function(){function t(){}return t.from=function(t){if(t[0]===ke.CHANGE_COLOR)return t[2];switch(t[2]){case He.FILL:return Fe.FILL;case He.STROKE:return Fe.STROKE;case He.FILL_AND_STROKE:return Fe.FILL_AND_STROKE;case He.TEXT:return Fe.TEXT;case He.TEXT_OUTLINE:return Fe.TEXT_OUTLINE;case He.ALL:return Fe.ALL}},t.unpack=function(t){var e=[];return t&Fe.FILL&&e.push(Fe.FILL),t&Fe.STROKE&&e.push(Fe.STROKE),t&Fe.TEXT&&e.push(Fe.TEXT),t&Fe.TEXT_OUTLINE&&e.push(Fe.TEXT_OUTLINE),e},t.pack=function(t){for(var e=Fe.NONE,n=0,i=t.length;n<i;++n)e|=t[n];return e},t}(),Ve=function(t){function e(e,n,i,r,o,s){var a=t.call(this,ke.CHANGE_COLOR,n,e)||this;return a.target=i,a.color=r,a.alpha=o,a.blend=s,a}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.target===n.target&&this.color===n.color&&this.alpha===n.alpha&&this.blend===n.blend},e.prototype.toRuntime=function(){return new je(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.blend);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(this.target,",").concat(this.color,",").concat(this.alpha,",").concat(n,"]"))},e.deserialize=function(t,n){var i=Ge.from(t),r=Le.toResource(1,t,n.resources),o=Le.toResource(6,t,n.resources);return new e(i,r,t[3],t[4],t[5],o)},e}(Me),We=function(t){function e(e){var n=t.call(this,e)||this;return n.brightness=Te.ofNumberOrNull(e.brightness),n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.brightness(t,n,be);this.set(t,e,n,i)}},e.prototype.set=function(t,e,n,i){var r=this.reset;if(null!=i){var o=this.toAdjusted;if(r&_e.COLOR_FILL){var s=me.toBaseFill(t,e);t.fill.set(void 0,o(s.color,i),s.alpha)}r&_e.COLOR_STROKE&&(s=me.toBaseStroke(t,e),t.stroke.set(void 0,o(s.color,i),s.alpha)),r&_e.COLOR_TEXT&&(s=me.toBaseText(t,e),t.text.set(void 0,o(s.color,i),s.alpha)),r&_e.COLOR_TEXT_OUTLINE&&(s=me.toBaseTextOutline(t,e),t.text.outline.set(void 0,o(s.color,i),s.alpha)),e.written|=r}},e.prototype.toAdjusted=function(t,e){return 0<=e?ve.brighten(t,+e):ve.darken(t,-e)},e}(ze),Ke=function(t){function e(e,n,i){var r=t.call(this,ke.CHANGE_COLOR,n,e)||this;return r.brightness=i,r}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.brightness===n.brightness},e.prototype.toRuntime=function(){return new We(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=Ue.BRIGHTNESS,i=t.addResource(this.brightness);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",").concat(i,"]"))},e.deserialize=function(t,n){return new e(Ge.from(t),Le.toResource(1,t,n.resources),Le.toResource(4,t,n.resources))},e}(Me),Xe=function(t){function e(e){var n=t.call(this,e)||this;return n.color=Te.ofNumberOrNull(e.color),n.alpha=Te.ofNumberOrNull(e.alpha),n.blend=Te.ofNumberOrNull(e.blend),n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.color(t,n,be),r=this.alpha(t,n,be),o=this.blend(t,n,be);this.set(t,e,n,i,r,o)}},e}(ze),Ye=function(t){function e(e,n,i,r,o){var s=t.call(this,ke.CHANGE_COLOR,n,e)||this;return s.color=i,s.alpha=r,s.blend=o,s}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.color===n.color&&this.alpha===n.alpha&&this.blend===n.blend},e.prototype.toRuntime=function(){return new Xe(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=Ue.CODE,i=t.addResource(this.color),r=t.addResource(this.alpha),o=t.addResource(this.blend);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",").concat(i,",").concat(r,",").concat(o,"]"))},e.deserialize=function(t,n){return new e(Ge.from(t),Le.toResource(1,t,n.resources),Le.toResource(4,t,n.resources),Le.toResource(5,t,n.resources),Le.toResource(6,t,n.resources))},e}(Me),qe=function(t){function e(e){var n=t.call(this,e,_e.CURSOR)||this;return n.name=Te.ofStringOrNull(e.name),n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.name(t,n,be);null!=i&&(t.cursor=i,e.written|=this.reset)}},e}(Ee),Ze=function(t){function e(e,n){var i=t.call(this,ke.CHANGE_CURSOR,e)||this;return i.name=n,i}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.name===n.name},e.prototype.toRuntime=function(){return new qe(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.name);return t.addResource("[".concat(this.type,",").concat(e,",").concat(n,"]"))},e.deserialize=function(t,n){return new e(Le.toResource(1,t,n.resources),Le.toResource(2,t,n.resources))},e}(Pe),Je=function(t){function e(e){var n=t.call(this,e,_e.FILL_PERCENT)||this;return n.value=Te.ofNumber(e.value),n}return F(e,t),e.prototype.execute=function(t,e,n){this.condition(t,n,be)&&(t.fill.percent=this.value(t,n,be),e.written|=this.reset)},e}(Ee),Qe=function(t){function e(e,n){var i=t.call(this,ke.CHANGE_FILL_PERCENT,e)||this;return i.value=n,i}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.value===n.value},e.prototype.toRuntime=function(){return new Je(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.value);return t.addResource("[".concat(this.type,",").concat(e,",").concat(n,"]"))},e.deserialize=function(t,n){return new e(Le.toResource(1,t,n.resources),Le.toResource(2,t,n.resources))},e}(Pe),$e=function(){function t(){}return t.prototype.format=function(t,e,n){return n.getHours()<12?"AM":"PM"},t}(),tn=function(){function t(){}return t.prototype.format=function(t,e,n){return n.getHours()<12?"am":"pm"},t}(),en=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getDate())},t}(),nn=function(){function t(){}return t.prototype.format=function(t,e,n){return"".concat(0|t)},t}(),rn=function(t){this.precision=null!=t?+t.substring(1,t.length):void 0},on=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.format=function(t,e,n){return t.toExponential(this.precision)},e}(rn),sn=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.format=function(t,e,n){return t.toFixed(this.precision)},e}(rn),an=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.format=function(t,e,n){var i=this.toAbs(t,e,n);return i<1e-24?this.format_(t,1,""):i<1e-21?this.format_(t,1e24,"y"):i<1e-18?this.format_(t,1e21,"z"):i<1e-15?this.format_(t,1e18,"a"):i<1e-12?this.format_(t,1e15,"f"):i<1e-9?this.format_(t,1e12,"p"):i<1e-6?this.format_(t,1e9,"n"):i<.001?this.format_(t,1e6,""):i<1?this.format_(t,1e3,"m"):i<1e3?this.format_(t,1,""):i<1e6?this.format_(t,.001,"k"):i<1e9?this.format_(t,1e-6,"M"):i<1e12?this.format_(t,1e-9,"G"):i<1e15?this.format_(t,1e-12,"T"):i<1e18?this.format_(t,1e-15,"P"):i<1e21?this.format_(t,1e-18,"E"):i<1e24?this.format_(t,1e-21,"Z"):this.format_(t,1e-24,"Y")},e.prototype.toAbs=function(t,e,n){return Math.abs(t)},e.prototype.format_=function(t,e,n){return"".concat((t*e).toFixed(this.precision)).concat(n)},e}(rn),un=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.format=function(t,e,n){return t.toPrecision(this.precision)},e}(rn),ln=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getHours())},t}(),hn=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getHours()%12)},t}(),cn=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getMonth()+1)},t}(),pn=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getMinutes())},t}(),fn=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getMilliseconds())},t}(),dn=function(){function t(){}return t.prototype.format=function(t,e,n){return"".concat(100*t|0,"%")},t}(),yn=function(){function t(){}return t.prototype.format=function(t,e,n){return"".concat(0|t,"%")},t}(),gn=function(){function t(t,e,n){this.length=t,this.character=e,this.node=n}return t.prototype.format=function(t,e,n){return ge(this.node.format(t,e,n),this.length,this.character)},t}(),vn=function(){function t(t){this.node=t}return t.prototype.format=function(t,e,n){var i=this.node.format(t,e,n);return 0<i.length&&"-"===i[0]?"(".concat(i.substring(1,i.length),")"):i},t}(),_n=function(){function t(t){this.node=t}return t.prototype.format=function(t,e,n){var i=this.node.format(t,e,n);return 0<i.length&&"-"!==i[0]?"+".concat(i):i},t}(),mn=function(){function t(){}return t.prototype.format=function(t,e,n){return"".concat(Math.round(100*t),"%")},t}(),bn=function(){function t(){}return t.prototype.format=function(t,e,n){return"".concat(Math.round(t),"%")},t}(),Tn=function(){function t(t,e,n,i,r,o,s){this.Y=t,this.M=e,this.D=n,this.H=i,this.m=r,this.s=o,this.mi=s}return t.prototype.format=function(t,e,n){if(e<1e3)return"".concat(this.s.format(t,e,n),".").concat(this.mi.format(t,e,n));if(e<6e4)return"".concat(this.m.format(t,e,n),":").concat(this.s.format(t,e,n));if(e<36e5)return"".concat(this.H.format(t,e,n),":").concat(this.m.format(t,e,n));if(e<864e5){var i=this.M.format(t,e,n),r=this.D.format(t,e,n);return"".concat(i,"/").concat(r," ").concat(this.H.format(t,e,n))}return e<2592e6?"".concat(this.M.format(t,e,n),"/").concat(this.D.format(t,e,n)):"".concat(this.Y.format(t,e,n),"/").concat(this.M.format(t,e,n))},t}(),wn=function(){function t(t){this.node=t}return t.prototype.format=function(t,e,n){var i=this.node.format(t,e,n);return 0<i.length&&"-"!==i[0]?" ".concat(i):i},t}(),En=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toAbs=function(t,e,n){return Math.abs(e)},e}(an),On=function(){function t(t){this.str=t}return t.prototype.format=function(t,e,n){return this.str},t}(),Cn=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getFullYear())},t}(),Sn=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getFullYear()%100)},t}(),xn=function(){function t(){}return t.prototype.format=function(t,e,n){var i=n.getTimezoneOffset(),r=i<=0?"+":"-",o=ge(String(Math.floor(Math.abs(i)/60)),2,"0"),s=ge(String(Math.floor(Math.abs(i)%60)),2,"0");return"".concat(r).concat(o,":").concat(s)},t}(),Dn=function(){function t(){}return t.prototype.format=function(t,e,n){return"".concat(Math.round(t))},t}(),In=function(){function t(){}return t.prototype.format=function(t,e,n){return String(n.getSeconds())},t}(),An=void 0,Rn=function(t,e,n){switch(t){case"_":return new gn(e," ",n);case"-":return n;default:return new gn(e,"0",n)}},Pn=function(t,e){switch(t){case"_":return new wn(e);case"+":return new _n(e);case"(":return new vn(e);default:return e}},Mn=function(){function t(t){var e=function(t){for(var e=0,n=!1,i=[],r=function(){var t=An;return t?t.lastIndex=0:An=t=/%(0|_|-|\+|\()?(\.\d+)?(Y(?:MD?)?|y(?:MD?)?|MD?|D|H(?:ms?)?|h(?:ms?)?|m(?:i|s)?|a|A|s(?:s?i|dt)?|z|%|f(?:si)?|e|g|d|r(?:d|p)|p|P|RP)/g,t}();;){var o=r.exec(t);if(null==o){e<t.length&&i.push(new On(t.substring(e,t.length)));break}var s=o.index;e<s&&i.push(new On(t.substring(e,s))),e=s+o[0].length;var a=o[0],u=o[1],l=o[2];switch(o[3]){case"Y":n=!0,i.push(new Cn);break;case"YM":n=!0,i.push(new Cn,new On("/"),Rn(u,2,new cn));break;case"YMD":n=!0,i.push(new Cn,new On("/"),Rn(u,2,new cn),new On("/"),Rn(u,2,new en));break;case"y":n=!0,i.push(Rn(u,2,new Sn));break;case"yM":n=!0,i.push(Rn(u,2,new Sn),new On("/"),Rn(u,2,new cn));break;case"yMD":i.push(Rn(u,2,new Sn),new On("/"),Rn(u,2,new cn),new On("/"),Rn(u,2,new en));break;case"M":n=!0,i.push(Rn(u,2,new cn));break;case"MD":n=!0,i.push(Rn(u,2,new cn),new On("/"),Rn(u,2,new en));break;case"D":n=!0,i.push(Rn(u,2,new en));break;case"H":n=!0,i.push(Rn(u,2,new ln));break;case"Hm":n=!0,i.push(Rn(u,2,new ln),new On(":"),Rn(u,2,new pn));break;case"Hms":n=!0,i.push(Rn(u,2,new ln),new On(":"),Rn(u,2,new pn),new On(":"),Rn(u,2,new In));break;case"h":n=!0,i.push(Rn(u,2,new hn));break;case"hm":n=!0,i.push(Rn(u,2,new hn),new On(":"),Rn(u,2,new pn));break;case"hms":n=!0,i.push(Rn(u,2,new hn),new On(":"),Rn(u,2,new pn),new On(":"),Rn(u,2,new In));break;case"m":n=!0,i.push(Rn(u,2,new pn));break;case"ms":n=!0,i.push(Rn(u,2,new pn),new On(":"),Rn(u,2,new In));break;case"mi":n=!0,i.push(Rn(u,3,new fn));break;case"a":n=!0,i.push(new tn);break;case"A":n=!0,i.push(new $e);break;case"s":n=!0,i.push(Rn(u,2,new In));break;case"sdt":n=!0,i.push(new Tn(new Cn,Rn(u,2,new cn),Rn(u,2,new en),Rn(u,2,new ln),Rn(u,2,new pn),Rn(u,2,new In),Rn(u,3,new fn)));break;case"z":n=!0,i.push(new xn);break;case"%":i.push(new On("%"));break;case"f":i.push(Pn(u,new sn(l)));break;case"e":i.push(Pn(u,new on(l)));break;case"g":i.push(Pn(u,new un(l)));break;case"rd":i.push(Pn(u,new Dn));break;case"d":i.push(Pn(u,new nn));break;case"P":i.push(Pn(u,new dn));break;case"p":i.push(Pn(u,new yn));break;case"RP":i.push(Pn(u,new mn));break;case"rp":i.push(Pn(u,new bn));break;case"fsi":i.push(Pn(u,new an(l)));break;case"ssi":i.push(Pn(u,new En(l)));break;default:i.push(new On(a))}}return{nodes:i,date:n}}(t);this.date=e.date,this.nodes=e.nodes}return t.prototype.format=function(e,n){var i=this.nodes,r=t.DATE;null==r&&(r=new Date,t.DATE=r),this.date&&r.setTime(e);for(var o="",s=0,a=i.length;s<a;++s)o+=i[s].format(e,n,r);return o},t}(),kn=function(){function t(){}return t.create=function(t){return new Mn(t)},t}(),Ln=function(t){function e(e){var n=t.call(this,e,_e.TEXT)||this;return n.number=Te.ofNumber(e.value),n.formatters=new Map,n}return F(e,t),e.prototype.getFormatter=function(t,e){var n=this.formatters,i=e.text.value,r=n.get(i);return void 0===r&&(r=this.newFormatter(i),n.set(i,r)),r},e.prototype.newFormatter=function(t){return 0<(t=t.trim()).length?kn.create(t):null},e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.number(t,n,be),r=this.getFormatter(t,e);t.text.value=null!=r?r.format(i,0):String(i),e.written|=this.reset}},e}(Ee),Nn=function(t){function e(e){var n=t.call(this,e,_e.TEXT)||this;return n.text=Te.ofString(e.value),n}return F(e,t),e.prototype.execute=function(t,e,n){this.condition(t,n,be)&&(t.text.value=this.text(t,n,be),e.written|=this.reset)},e}(Ee),Bn={TEXT:0,NUMBER:1},zn=function(t){function e(e,n,i){var r=t.call(this,ke.CHANGE_TEXT,n,e)||this;return r.value=i,r}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.value===n.value},e.prototype.toRuntime=function(){switch(this.subtype){case Bn.TEXT:return new Nn(this);case Bn.NUMBER:return new Ln(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.value);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources),r=Le.toResource(3,t,n.resources);return new e(t[2],i,r)},e}(Me),Un={DIAGRAM:0,PAGE:1,EXTENSION:1e3},jn=function(){function t(t){this._sources=this.newSources(t)}return t.prototype.map=function(e,n,i){var r=this._sources;if(null==r)return!1;var o=e.id,s=o.toLowerCase(),a=s.length;if(a!==o.length)return!1;var u=r[0],l=u.length;if(0!==l&&0!==s.indexOf(u))return!1;var h=t.SPANS;h[0]=0,h[1]=l;for(var c=r.length,p=1;p<c;++p){var f=p<<1,d=r[p],y=d.length;if(0===y)h[f]=a,h[f+1]=a;else{var g=s.indexOf(d,h[f-1]);if(g<0)return!1;h[f]=g,h[f+1]=g+y}}if(null!=n){for(var v=n.length,_="",m=(p=0,c);p<m;++p){var b=p<v?n[p]:r[p],T=h[1+(f=p<<1)],w=h[f+2];_+=b+o.substring(T,p+1<m?w:a)}e.id=_}return 0<i.length&&(e.initial=i),!0},t.prototype.newSources=function(e){if(null==e)return null;var n=e.trim();return n.length<=0?null:n.toLowerCase().split(t.WILDCARD)},t.split=function(t){if(null==t)return null;var e=t.trim();return e.length<=0?null:e.split(this.WILDCARD)},t.WILDCARD="*",t.SPANS=[],t}(),Fn=function(){function t(t,e,n,i,r){this.resources=t.resources,this.data=t.data||t.tags||t.resources,this.pieces=e,this.pieceData=n,this.mode=i,this.depth=r,this._actions=new Map,this._fills=new Map,this._strokes=new Map,this._data=new Map,this._dataValues=new Map,this._dataMapping=new Map,this._dataMappers=new Map,this._dataDestinations=new Map,this._dataSystem=new Map,this._ranges=new Map,this._aligns=new Map,this._margins=new Map,this._texts=new Map,this._textOutlines=new Map,this._capabilities=new Map,this._extensions=new Map}return t.prototype.getAction=function(t){return this._actions.get(t)},t.prototype.setAction=function(t,e){this._actions.set(t,e)},t.prototype.getFill=function(t){return this._fills.get(t)},t.prototype.setFill=function(t,e){this._fills.set(t,e)},t.prototype.getStroke=function(t){return this._strokes.get(t)},t.prototype.setStroke=function(t,e){this._strokes.set(t,e)},t.prototype.getData=function(t){return this._data.get(t)},t.prototype.setData=function(t,e){this._data.set(t,e)},t.prototype.getDataValue=function(t){return this._dataValues.get(t)},t.prototype.setDataValue=function(t,e){this._dataValues.set(t,e)},t.prototype.getDataMapping=function(t){return this._dataMapping.get(t)},t.prototype.setDataMapping=function(t,e){this._dataMapping.set(t,e)},t.prototype.getDataMapper=function(t){var e=this._dataMappers,n=e.get(t);return void 0===n&&(n=new jn(t),e.set(t,n)),n},t.prototype.getDataDestination=function(t){var e=this._dataDestinations,n=e.get(t);return void 0===n&&(n=jn.split(t),e.set(t,n)),n},t.prototype.getDataSystem=function(t){return this._dataSystem.get(t)},t.prototype.setDataSystem=function(t,e){this._dataSystem.set(t,e)},t.prototype.getRange=function(t){return this._ranges.get(t)},t.prototype.setRange=function(t,e){this._ranges.set(t,e)},t.prototype.getAlign=function(t){return this._aligns.get(t)},t.prototype.setAlign=function(t,e){this._aligns.set(t,e)},t.prototype.getMargin=function(t){return this._margins.get(t)},t.prototype.setMargin=function(t,e){this._margins.set(t,e)},t.prototype.getText=function(t){return this._texts.get(t)},t.prototype.setText=function(t,e){this._texts.set(t,e)},t.prototype.getTextOutline=function(t){return this._textOutlines.get(t)},t.prototype.setTextOutline=function(t,e){this._textOutlines.set(t,e)},t.prototype.getCapability=function(t){return this._capabilities.get(t)},t.prototype.setCapability=function(t,e){this._capabilities.set(t,e)},t.prototype.getExtension=function(t){return this._extensions.get(t)},t.prototype.setExtension=function(t,e){this._extensions.set(t,e)},t}(),Hn={VIEWER:0,EDITOR_DATA_MAPPED:1,EDITOR:2},Gn={NONE:0,TOP:1,RIGHT:2,BOTTOM:4,LEFT:8,ALL:15},Vn={TAIL:1,HEAD:2,ALL:3},Wn=function(t){function e(e){return void 0===e&&(e=i.CIRCLE),t.call(this,e)||this}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(e,n,i,r,o,s,a){return!!t.prototype.containsAbsBBox.call(this,e,n,i,r)&&se(this,e,n,i,r,o,s)},e}(oe),Kn=function(t){function e(e){void 0===e&&(e=i.EMBEDDED_ACCEPTOR_EDGE);var n=t.call(this,e)||this;return n._subtype=Vn.HEAD,n._side=Gn.ALL,n._vvisible=!0,n}return F(e,t),Object.defineProperty(e.prototype,"subtype",{get:function(){return this._subtype},set:function(t){this._subtype=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"side",{get:function(){return this._side},set:function(t){this._side=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"vvisible",{get:function(){return this._vvisible},set:function(t){this._vvisible=t},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.copy=function(n,i){return void 0===i&&(i=gt.ALL),t.prototype.copy.call(this,n,i),n instanceof e&&(this._subtype=n.subtype,this._side=n.side,this._vvisible=n.vvisible),this},e.prototype.serialize=function(e){var n=t.prototype.serialize.call(this,e);return n[15]=this._subtype|this._side<<2|(this._vvisible?64:0),n},e}(Wn),Xn=function(){function t(){}return t.get=function(t){var e=this.mappings[t];return null!=e?e:Lt.PRIMITIVE},t.contains=function(t,e){if(null!=t){var n=this.get(t.type),i=t.getCapability();return null!=i&&(n&=~i.removed,n|=i.added,n&=~i.locked),(n&e)===e}return!1},t.set=function(t,e){this.mappings[t]=e},t.mappings={},t}(),Yn=function(t){return Math.abs(t)<.001?t<0?-.001:.001:t},qn=function(){function e(e,n,i){this.shape=e,this.base=new t.Point(n,i);var r=e.size;this.shapeBase=new t.Point(r.x,r.y),this.transform=new t.Matrix,e.updateTransform(),e.transform.localTransform.copyTo(this.transform),this.capable=Xn.contains(e,Lt.POSITION)&&Xn.contains(e,Lt.WIDTH)&&Xn.contains(e,Lt.HEIGHT)&&Xn.contains(e,Lt.ROTATION)&&Xn.contains(e,Lt.SKEW)}return e.prototype.isCompatible=function(t){return this.shape===t},e.prototype.reset=function(t,e,n){this.base.set(e,n);var i=t.size;this.shapeBase.copyFrom(i),t.updateTransform(),t.transform.localTransform.copyTo(this.transform)},e.prototype.update=function(t,n,i,r,o){if(this.capable){var s=n/this.base.x,a=i/this.base.y,u=this.shapeBase,l=e.WORK_TRANSFORM;l.identity().append(this.transform).translate(-r,-o).scale(s,a).translate(+r,+o),t.lock(zt.TRANSFORM_AND_UPLOADED),this.apply(t,l,Lt.ALL,u),t.unlock(zt.TRANSFORM_CHILD,!1),t.unlock(zt.TRANSFORM_THIS|zt.TRANSFORM_PARENT|zt.UPLOADED,!0)}},e.prototype.apply=function(t,e,n,i){var r=e.a,o=e.b,s=e.c,a=e.d,u=e.tx,l=e.ty,h=t.transform,c=!!(n&Lt.POSITION),p=!!(n&Lt.ROTATION),f=!!(n&Lt.SKEW),d=!!(n&Lt.WIDTH),y=!!(n&Lt.HEIGHT);if(p||f){var g=Math.atan2(-s,a),v=Math.atan2(+o,r);if(p&&(h.rotation=.5*(g+v)),f){var _=.5*(v-g);h.skew.set(_,_)}}if(c){var m=h.pivot,b=m.x,T=m.y;h.position.set(u+(r*b+s*T),l+(o*b+a*T))}if(null!=i&&(d||y)){var w=Yn(i.x*Math.sqrt(r*r+o*o)),E=Yn(i.y*Math.sqrt(s*s+a*a)),O=t.size;d&&y?O.set(w,E):d?O.x=w:O.y=E}},e.WORK_TRANSFORM=new t.Matrix,e}(),Zn=function(){function e(e,n,i,r){this._workRectForCalcRect=new t.Rectangle,this._workRectForFit=new t.Rectangle,this._parent=e,this._layouts=[],this._size=new t.Point(n,i),this._isFittable=r}return e.prototype.init=function(){return this},Object.defineProperty(e.prototype,"x",{get:function(){return this._size.x},set:function(t){var e=this._size;if(e.x!==t){var n=e.x;e.x=t,this.onChange(n,e.y)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._size.y},set:function(t){var e=this._size;if(e.y!==t){var n=e.y;e.y=t,this.onChange(e.x,n)}},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e){var n=!1,i=this._size,r=i.x,o=i.y;return null!=t&&r!==t&&(n=!0,i.x=t),null!=e&&o!==e&&(n=!0,i.y=e),n&&this.onChange(r,o),this},e.prototype.clone=function(){var t=this._size;return new e(this._parent,t.x,t.y,this._isFittable)},e.prototype.copy=function(){},e.prototype.copyFrom=function(t){var e=t.x,n=t.y,i=this._size,r=i.x,o=i.y;return r===e&&o===n||(i.x=e,i.y=n,this.onChange(r,o)),this},e.prototype.copyTo=function(t){return this._size.copyTo(t)},e.prototype.equals=function(t){return this._size.equals(t)},e.prototype.fit=function(){return this._isFittable&&this.doFit(),this},e.prototype.doFit=function(){var t=this._parent;t.lock(zt.TRANSFORM);var e=this.calcRect(this._workRectForFit),n=this._size;n.set(e.width,e.height),t.updateTransform();var i=t.transform,r=e.x+.5*e.width,o=e.y+.5*e.height,s=i.position,a=i.localTransform,u=a.a,l=a.b,h=a.c,c=a.d,p=i.pivot,f=r-p.x,d=o-p.y;s.set(s.x+(u*f+h*d),s.y+(l*f+c*d)),p.set(r,o),this.reset(t.children,this._layouts,n),t.unlock(zt.TRANSFORM_CHILD|zt.TRANSFORM_THIS,!0),t.unlock(zt.TRANSFORM_PARENT,!1)},e.prototype.reset=function(t,e,n){for(var i=0,r=Math.min(e.length,t.length);i<r;++i){var o=t[i],s=e[i];if(!s.isCompatible(o)){e.length=i;break}s.reset(o,n.x,n.y)}t.length<e.length&&(e.length=t.length)},e.prototype.calcRect=function(t){var e=this._parent.children;if(e.length<=0)t.x=0,t.y=0,t.width=0,t.height=0;else{var n=this._workRectForCalcRect;e[0].getBoundsLocal(!1,t);for(var i=1,r=e.length;i<r;++i)e[i].getBoundsLocal(!1,n),t.enlarge(n)}return t},e.prototype.onChange=function(t,e){var n=this._parent,i=this._size,r=n.transform.pivot;this.onChange_(n.children,this._layouts,i.x,i.y,r.x,r.y,t,e),n.onSizeChange()},e.prototype.onChange_=function(t,e,n,i,r,o,s,a){for(var u=0,l=Math.min(e.length,t.length);u<l;++u){var h=t[u];if(!(c=e[u]).isCompatible(h)){e.length=u;break}c.update(h,n,i,r,o)}for(u=e.length,l=t.length;u<l;++u){var c;h=t[u],(c=this.newLayout(h,s,a)).update(h,n,i,r,o),e.push(c)}e.length!==t.length&&(e.length=t.length)},e.prototype.newLayout=function(t,e,n){return t.layout||new qn(t,e,n)},e}(),Jn=function(){function e(e,n,i,r,o){this._parent=e,this._x=n,this._y=i,this._base=new t.Point(r,o)}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(t){this._x!==t&&(this._x=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(t){this._y!==t&&(this._y=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"base",{get:function(){return this._base},enumerable:!1,configurable:!0}),e.prototype.init=function(){return this._base.copyFrom(this),this.onChange(),this},e.prototype.clone=function(){var t=this._base;return new e(this._parent,this._x,this._y,t.x,t.y)},e.prototype.set=function(t,e){var n=!1;return null!=t&&this._x!==t&&(this._x=t,n=!0),null!=e&&this._y!==e&&(this._y=e,n=!0),n&&this.onChange(),this},e.prototype.copyFrom=function(t){return t instanceof e&&this._base.copyFrom(t.base),this._x===t.x&&this._y===t.y||(this._x=t.x,this._y=t.y,this.onChange()),this},e.prototype.copyTo=function(t){return t instanceof e&&this._base.copyTo(t.base),t.set(this._x,this._y),t},e.prototype.equals=function(t){return t.x===this._x&&t.y===this._y},e.prototype.fit=function(){return this},e.prototype.onChange=function(){var t=this._base;this._parent.transform.scale.set(this._x/t.x,this._y/t.y)},e}(),Qn=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){return J.BOTTOM},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percent",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,e,n,i,r){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!0,color:16777215,alpha:1,direction:J.BOTTOM,percent:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,e){},t}(),$n=function(){function t(){}return Object.defineProperty(t.prototype,"enable",{get:function(){return!1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return 16777215},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return 1},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){return Z.NONE},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){return s.NONE},set:function(t){},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){},t.prototype.set=function(t,e,n,i,r,o,s){},t.prototype.clone=function(){return new t},t.prototype.toObject=function(){return{enable:!1,color:16777215,alpha:1,width:1,align:0,side:Z.NONE,style:s.NONE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,e){},t}(),ti=function(t){function e(e,n,i){var r=t.call(this,i)||this;r._mode=e,r._depth=n;var o=r.newData();return r.data=o,r.tag=o,r.size=r.newGroupSize(e,n),r.fill=r.newGroupFill(),r.stroke=r.newGroupStroke(),r.text=r.newGroupText(),r}return F(e,t),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"depth",{get:function(){return this._depth},enumerable:!1,configurable:!0}),e.prototype.newGroupSize=function(t,e){var n=rt.SIZE_X,i=rt.SIZE_Y;return t!==Hn.VIEWER?new Zn(this,n,i,this.isGroupSizeFittable()):new Jn(this,n,i,n,i)},e.prototype.isGroupSizeFittable=function(){return!0},e.prototype.newData=function(){return new $t},e.prototype.newGroupFill=function(){return new Qn},e.prototype.newGroupStroke=function(){return new $n},e.prototype.newGroupText=function(){return new ie(this,rt.TEXT_VALUE,rt.TEXT_COLOR,rt.TEXT_ALPHA,rt.TEXT_FAMILY,rt.TEXT_SIZE)},e.prototype.getBoundsSize=function(){var t=this.size;return t instanceof Jn?t.base:t},e.prototype.onChildTransformChange=function(){t.prototype.onChildTransformChange.call(this),this.size.fit()},Object.defineProperty(e.prototype,"corner",{get:function(){return pt.NONE},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gradient",{get:function(){},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.serializeGradient=function(t){return-1},Object.defineProperty(e.prototype,"radius",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"image",{get:function(){},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.serializeImage=function(t){return-1},Object.defineProperty(e.prototype,"points",{get:function(){},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.containsAbs=function(t,e,n,i,r,o,s){return!1},e}(jt),ei=function(e){function n(t,n,r,o){void 0===o&&(o=i.EMBEDDED);var s=e.call(this,n,r,o)||this;return s._name=t,s._depth=r,s}return F(n,e),Object.defineProperty(n.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"edges",{get:function(){var t;return null!==(t=this._edges)&&void 0!==t?t:this._edges=this.newEdges()},enumerable:!1,configurable:!0}),n.prototype.newEdges=function(){var e,i,r=new Map,o=this.children;if(null!=o)for(var s=this.size,a=s.x,u=s.y,l=void 0,h=void 0,c=0,p=o.length;c<p;++c)for(var f=o[c].children,d=0,y=f.length;d<y;++d){var g=f[d];g instanceof Kn&&(g.updateTransform(),null==l&&(l=(null!==(e=n.WORK_NEW_EDGE1)&&void 0!==e?e:n.WORK_NEW_EDGE1=new t.Matrix).copyFrom(this.transform.internalTransform).invert()),null==h&&(h=null!==(i=n.WORK_NEW_EDGE2)&&void 0!==i?i:n.WORK_NEW_EDGE2=new t.Matrix),h.copyFrom(l).append(g.transform.internalTransform),r.set(g.id,{type:g.subtype,x:this.toEdgePosition(h.tx,a),y:this.toEdgePosition(h.ty,u),normal:this.toEdgeNormal(-h.c,-h.d),size:{x:0,y:0},side:g.side}))}return r},n.prototype.toEdgePosition=function(t,e){return 1e-5<Math.abs(e)?t/e:0},n.prototype.toEdgeNormal=function(t,e){var n=t*t+e*e;if(1e-5<n){var i=1/Math.sqrt(n);return{x:t*i,y:e*i}}return{x:0,y:-1}},n.prototype.isGroupSizeFittable=function(){return!1},n.prototype.newGroupSize=function(t,e){var n=rt.SIZE_X,i=rt.SIZE_Y;return t!==Hn.VIEWER&&e<=0?new Zn(this,n,i,this.isGroupSizeFittable()):new Jn(this,n,i,n,i)},n.prototype.clone=function(){for(var t=this.newClone().copy(this),e=this.children,n=0,i=e.length;n<i;++n){var r=e[n].clone();r.parent=t,t.children.push(r)}return t.onChildTransformChange(),t.toDirty(),t},n.prototype.newClone=function(){return new(0,this.constructor)(this._name,this._mode,this._depth,this.type)},n.prototype.serializeChildren=function(t){return[]},n.prototype.serializeImage=function(t){return-1},n.prototype.serializeGradient=function(t){return-1},n.prototype.serialize=function(t){var n=e.prototype.serialize.call(this,t);return n[15]=t.addPiece(this._name),n},n.prototype.addUuid=function(t){this.uuid=t.addUuid(this.uuid)},n.prototype.updateUuid=function(t){this.uuid=t.updateUuid(this.uuid)},n}(ti),ni=function(){function t(t){this._shapes=t}return t.prototype.find=function(t){return this.getUuidToShape().get(t)},t.prototype.getUuidToShape=function(){var t=this._uuidToShape;return null==t&&(t=this.newUuidToShape(),this._uuidToShape=t),t},t.prototype.newUuidToShape=function(){var t=new Map;return this.fillUuidToShape(this._shapes,t),t},t.prototype.fillUuidToShape=function(t,e){for(var n=0,i=t.length;n<i;++n){var r=t[n];if(e.set(r.uuid,r),!(r instanceof ei)){var o=r.children;0<o.length&&this.fillUuidToShape(o,e)}}},t}(),ii=function(t,n){var r=e[t[0]]||e[i.NULL];if(null!=r){var o=r(t,n);if(null!=o)return o}throw new Error("Missing shape deserializers")},ri=function(t,e){for(var n=[],i=0,r=t.length;i<r;++i)n.push(ii(t[i],e));return 0<n.length?Promise.all(n).then((function(n){return oi(t,n,new ni(n),e),n})):null},oi=function(t,e,i,r){for(var o=0,s=t.length;o<s;++o){var a=t[o],u=e[o],l=n[a[0]];l&&l(a,u,i,r),oi(a[20],u.children,i,r)}},si=function(t,e,n,i){this.name=t,this.width=e,this.height=n,this.layer=i},ai=function(t,e){return xt(t)?e[t]:t},ui=function(){function t(){this._edges=new Map}return t.prototype.add=function(t,e,n,i,r,o,s,a,u){return this._edges.set(t,{type:ai(e,Vn),x:n,y:i,normal:this.toNormal(n,i,r,o),size:{x:null!=s?s:0,y:null!=a?a:0},side:this.toSide(u)}),!0},t.prototype.toNormal=function(t,e,n,i){if(null!=n&&null!=i)return{x:n,y:i};var r=t*t+e*e;if(1e-5<r){var o=1/Math.sqrt(r);return{x:t*o,y:e*o}}return{x:0,y:0}},t.prototype.toSide=function(t){if(null==t)return Gn.TOP;if(St(t))return t;if(xt(t))return ai(t,Gn);for(var e=Gn.NONE,n=0,i=t.length;n<i;++n)e|=ai(t[n],Gn);return e},t.prototype.remove=function(t){var e=this._edges,n=e.get(t);return null!=n?(e.delete(t),n):null},t.prototype.size=function(){return this._edges.size},t.prototype.get=function(t,e){return this._edges.get(e)||null},t.prototype.each=function(t,e){return this._edges.forEach(e),this},t.prototype.contains=function(t){return this._edges.has(t)},t.prototype.clear=function(){var t=this._edges;return 0<t.size&&(t.clear(),!0)},t}(),li=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.get=function(e,n){var i=this.getEdges(e);if(null!=i){var r=i.get(n);if(null!=r)return r}return t.prototype.get.call(this,e,n)},e.prototype.each=function(e,n){var i=this.getEdges(e);return null!=i&&i.forEach((function(t,e){n(t,e)})),t.prototype.each.call(this,e,n)},e.prototype.getEdges=function(t){return t instanceof ei?t.edges:null},e}(ui),hi=function(){function t(){}return t.set=function(t,e){var n=this._acceptors;null==n&&(n=new Map,this._acceptors=n),n.set(t,e)},t.get=function(t){var e,n=this._acceptors;if(null!=n){var r=n.get(t);if(null!=r)return r}var o=null!==(e=this._defaults)&&void 0!==e?e:this._defaults=new Map;switch(t){case i.EMBEDDED:var s=o.get(t);return null==s&&(s=this.newDefaultEmbedded(),o.set(t,s)),s;case i.EMBEDDED_ACCEPTOR_EDGE:var a=o.get(t);return null==a&&(a=this.newDefaultEmbeddedAcceptorEdge(),o.set(t,a)),a;default:var u=o.get(null);return null==u&&(u=this.newDefaultOther(),o.set(null,u)),u}},t.newDefaultEmbedded=function(){return this.initDefault(new li)},t.newDefaultEmbeddedAcceptorEdge=function(){var t=new ui;return t.add("CENTER",Vn.ALL,0,0,0,0),t},t.newDefaultOther=function(){return this.initDefault(new ui)},t.initDefault=function(t){var e=1/Math.sqrt(2);return t.add("TOP",Vn.ALL,0,-.5,0,-1),t.add("LEFT",Vn.ALL,-.5,0,-1,0),t.add("RIGHT",Vn.ALL,.5,0,1,0),t.add("BOTTOM",Vn.ALL,0,.5,0,1),t.add("CENTER",Vn.ALL,0,0,0,0),t.add("TOP_LEFT",Vn.ALL,-.5,-.5,-e,-e),t.add("TOP_RIGHT",Vn.ALL,.5,-.5,e,-e),t.add("BOTTOM_LEFT",Vn.ALL,-.5,.5,-e,e),t.add("BOTTOM_RIGHT",Vn.ALL,.5,.5,e,e),t},t}(),ci=function(){function t(t){this._parent=t,this._shape=null,this._edge=null,this._x=null,this._y=null}return Object.defineProperty(t.prototype,"shape",{get:function(){return this._shape},set:function(t){this.set(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"edge",{get:function(){return this._edge},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this.set(void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this.set(void 0,void 0,void 0,t)},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){return this.set(t.shape,t.edge,t.x,t.y)},t.prototype.set=function(t,e,n,i){var r=!1;return void 0!==t&&this._shape!==t&&(this._shape=t,r=!0),void 0!==e&&this._edge!==e&&(this._edge=e,r=!0),void 0!==n&&this._x!==n&&(this._x=n,r=!0),void 0!==i&&this._y!==i&&(this._y=i,r=!0),r&&this._parent.onAcceptorChange(),this},t}(),pi=function(){function e(e,n){var i=this;this._parent=e,this._onChange=n,this._acceptor=new ci(this),this._acceptorTransformNew=new t.Matrix,this._acceptorTransformOld=new t.Matrix,this._hasAcceptorTransformOld=!1,this._local=new t.ObservablePoint((function(){i.onLocalChange()}),void 0),this._localIdRequired=0,this._localId=0,this._normal=new t.ObservablePoint((function(){i.onNormalChange()}),void 0),this._normalIdRequired=0,this._normalId=0,this._side=Gn.TOP,this._margin=0,this._other=null,this._lockCount=0,this._isAcceptorChanged=!1,this._isLocalChanged=!1,this._isNormalChanged=!1,this._isOtherChanged=!1}return e.prototype.lock=function(){this._lockCount+=1,1===this._lockCount&&(this._isAcceptorChanged=!1,this._isLocalChanged=!1,this._isNormalChanged=!1,this._isOtherChanged=!1)},e.prototype.unlock=function(){if(this._lockCount-=1,0===this._lockCount){var t=!1;this._isLocalChanged&&(this._localIdRequired+=1,this._localId=this._localIdRequired,t=!0),this._isNormalChanged&&(this._normalIdRequired+=1,this._normalId=this._normalIdRequired,t=!0),this._isOtherChanged&&(t=!0),this._isAcceptorChanged&&(this._hasAcceptorTransformOld=!1,this._isLocalChanged||(this._localIdRequired+=1),this._isNormalChanged||(this._normalIdRequired+=1),this.doFit()&&(t=!1)),t&&this._onChange()}},Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"acceptor",{get:function(){return this._acceptor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"local",{get:function(){return this._local},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"localId",{get:function(){return this._localId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normal",{get:function(){return this._normal},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"normalId",{get:function(){return this._normalId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"side",{get:function(){return this._side},set:function(t){this._side!==t&&(this._side=t,this.onOtherChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"margin",{get:function(){return this._margin},set:function(t){this._margin!==t&&(this._margin=t,this.onOtherChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"other",{get:function(){return this._other},set:function(t){this._other=t},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o,s,a,u,l){this.lock(),this._acceptor.set(t,e,n,i);var h=this._local;null!=o&&null!=s?h.set(o,s):null!=o?h.x=o:null!=s&&(h.y=s);var c=this._normal;return null!=a&&null!=u?c.set(a,u):null!=a?c.x=a:null!=u&&(c.y=u),null!=l&&(this.side=l),null!=r&&(this.margin=r),this.unlock(),this},e.prototype.copy=function(t){return this.lock(),this._acceptor.copy(t.acceptor),this._local.copyFrom(t.local),this._normal.copyFrom(t.normal),this.side=t.side,this.margin=t.margin,this.unlock(),this},e.prototype.serialize=function(t){var e=this._acceptor,n=e.shape,i=n?n.uuid:null,r=e.edge,o=null!=r?t.addResource(r):-1,s=this._local,a=this._normal,u=this._side;return t.addResource("[".concat(i,",").concat(o,",").concat(s.x,",").concat(s.y,",").concat(this._margin,",").concat(a.x,",").concat(a.y,",").concat(e.x,",").concat(e.y,",").concat(u,"]"))},e.prototype.deserialize=function(t,e,n){var i,r,o,s=n.resources;if(0<=t&&t<s.length){var a=n.getExtension(t);null==a&&(a=JSON.parse(s[t]),n.setExtension(t,a));var u=null,l=a[0];null!=l&&(u=e.find(l)||null),this.lock();var h=this._acceptor;h.shape=u;var c=a[1];h.edge=0<=c&&c<s.length?s[c]:null,h.x=null!==(i=a[7])&&void 0!==i?i:null,h.y=null!==(r=a[8])&&void 0!==r?r:null,this._local.set(a[2],a[3]);var p=a[5],f=a[6],d=this._normal;null!=p&&null!=f?d.set(p,f):d.set(1,0),this.side=null!==(o=a[9])&&void 0!==o?o:Gn.TOP,this.margin=a[4]||0,this.unlock(),u&&u.connector.add(this)}},e.prototype.fit=function(t){return t&&(this._localIdRequired+=1,this._normalIdRequired+=1),this.doFit(),this},e.prototype.doFit=function(){var n,i,r,o=this._localIdRequired,s=this._localId!==o,a=this._normalIdRequired,u=this._normalId!==a;if(s||u){this._localId=o,this._normalId=a;var l=this._acceptor,h=l.shape,c=l.edge;if(null!=h&&null!=c){var p=hi.get(h.type).get(h,c);if(p){var f=this._acceptorTransformOld,d=this._acceptorTransformNew;this.toAcceptorTransform(h,d);var y=this._other,g=this._hasAcceptorTransformOld&&null!=y&&null==y.acceptor.shape,v=null!==(n=e.WORK_MATRIX)&&void 0!==n?n:e.WORK_MATRIX=new t.Matrix;if(g&&f.copyTo(v).invert().prepend(d),this._acceptorTransformNew=f,this._acceptorTransformOld=d,this._hasAcceptorTransformOld=!0,this.lock(),s){var _=this._local,m=_.x,b=_.y,T=h.size,w=h.transform.pivot,E=w.x+T.x*(null!==(i=l.x)&&void 0!==i?i:p.x),O=w.y+T.y*(null!==(r=l.y)&&void 0!==r?r:p.y),C=d.a*E+d.c*O+d.tx,S=d.b*E+d.d*O+d.ty;if(_.set(C,S),g){var x=y.local,D=x.x,I=x.y,A=v.a*D+v.c*I+v.tx,R=v.b*D+v.d*I+v.ty,P=D-m,M=I-b,k=A-C,L=R-S,N=P*P+M*M,B=k*k+L*L;if(1e-6<B){var z=Math.sqrt(N/B);x.set(C+k*z,S+L*z)}else x.set(A,R)}}if(u){var U=p.normal,j=U.x,F=U.y,H=d.a*j+d.c*F,G=d.b*j+d.d*F,V=H*H+G*G,W=this._normal;if(1e-6<V?(z=1/Math.sqrt(V),W.set(H*z,G*z)):W.set(j,F),g){var K=y.normal,X=K.x,Y=K.y,q=v.a*X+v.c*Y,Z=v.b*X+v.d*Y,J=q*q+Z*Z;1e-6<J?(z=1/Math.sqrt(J),K.set(q*z,Z*z)):K.set(X,Y)}}var Q=this._isLocalChanged||this._isNormalChanged;return this.unlock(),Q}}}return!1},e.prototype.toAcceptorTransform=function(t,e){t.updateTransform();var n=this._parent,i=n.parent;return i instanceof jt?(n.updateTransform(),e.copyFrom(i.transform.internalTransform).invert().append(t.transform.internalTransform)):e.copyFrom(t.transform.internalTransform)},e.prototype.onAcceptorChange=function(){if(0<this._lockCount)return this._isLocalChanged=!1,this._isNormalChanged=!1,void(this._isAcceptorChanged=!0);this._hasAcceptorTransformOld=!1,this.fit(!0)},e.prototype.onLocalChange=function(){0<this._lockCount?this._isLocalChanged=!0:(this._localIdRequired+=1,this._localId=this._localIdRequired,this._onChange())},e.prototype.onNormalChange=function(){0<this._lockCount?this._isNormalChanged=!0:(this._normalIdRequired+=1,this._normalId=this._normalIdRequired,this._onChange())},e.prototype.onOtherChange=function(){0<this._lockCount?this._isOtherChanged=!0:this._onChange()},e.prototype.attach=function(){var t=this._acceptor.shape;return t&&t.connector.add(this)&&this.onAcceptorChange(),this},e.prototype.detach=function(t){var e=this._acceptor.shape;return null==e||null!=t&&t.has(e)||e.connector.remove(this)&&this.onAcceptorChange(),this},e}(),fi=function(){function t(t,e){var n=this;this._parent=t,this._lockCount=0,this._isChanged=!1,this._onChange=e;var i=function(){n.onChange()},r=new pi(t,i),o=new pi(t,i);r.other=o,o.other=r,this._tail=r,this._head=o}return t.prototype.lock=function(){return this._lockCount+=1,1===this._lockCount&&(this._isChanged=!1),this},t.prototype.unlock=function(){return this._lockCount-=1,0===this._lockCount&&this._isChanged&&this._onChange(),this},t.prototype.onChange=function(){0<this._lockCount?this._isChanged=!0:this._onChange()},Object.defineProperty(t.prototype,"tail",{get:function(){return this._tail},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"head",{get:function(){return this._head},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){return this.lock(),this._tail.copy(t.tail),this._head.copy(t.head),this.unlock(),this},t.prototype.fit=function(t){return this.lock(),this._tail.fit(t),this._head.fit(t),this.unlock(),this},t.prototype.serialize=function(t){var e=this._tail.serialize(t),n=this._head.serialize(t);return t.addResource("[".concat(e,",").concat(n,"]"))},t.prototype.deserialize=function(t,e,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getExtension(t);null==r&&(r=JSON.parse(i[t]),n.setExtension(t,r)),this.lock(),this._tail.deserialize(r[0],e,n),this._head.deserialize(r[1],e,n),this.unlock()}},t.prototype.attach=function(){this.lock();var t=this._tail,e=this._head;return t.attach(),e.attach(),t.fit(!0),e.fit(!0),this.unlock(),this},t.prototype.detach=function(t){return this.lock(),this._tail.detach(t),this._head.detach(t),this.unlock(),this},t}(),di=function(t,e){for(var n=0,i=t.length-1;n<=i;){var r=n+(i-n>>1),o=t[r];if(e<o)i=r-1;else{if(!(o<e))return r;n=r+1}}return-1},yi=function(t,e){if(2<=t.length){for(var n=t[0],i=t[1],r=n,o=i,s=2,a=t.length;s<a;s+=2){var u=t[s],l=t[s+1];n=Math.min(n,u),i=Math.min(i,l),r=Math.max(r,u),o=Math.max(o,l)}e[0]=n,e[1]=i,e[2]=r,e[3]=o}else e[0]=0,e[1]=0,e[2]=0,e[3]=0;return e},gi=function(){function e(e){var n=this;this._parent=e,this._lockCount=0,this._isTypeChanged=!1,this._isSizeChanged=!1,this._isFillChanged=!1,this._type=ot.NONE,this._size=new t.ObservablePoint((function(){n.onSizeChange()}),void 0,.15*rt.SIZE_X,.15*rt.SIZE_Y),this._fill=this.newFill(),this._transformId=0}return e.prototype.newFill=function(){return new st(this,!0,rt.FILL_COLOR,1,rt.FILL_DIRECTION,rt.FILL_PERCENT)},e.prototype.lock=function(){return this._lockCount+=1,1===this._lockCount&&(this._isTypeChanged=!1,this._isSizeChanged=!1,this._isFillChanged=!1),this},e.prototype.unlock=function(){return this._lockCount-=1,0===this._lockCount&&(this._isTypeChanged?this.onTypeChange():this._isSizeChanged?this.onSizeChange():this._isFillChanged&&this.onFillChange(),this._isTypeChanged=!1,this._isSizeChanged=!1,this._isFillChanged=!1),this},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},set:function(t){this._type!==t&&(this._type=t,this.onTypeChange())},enumerable:!1,configurable:!0}),e.prototype.onTypeChange=function(){0<this._lockCount?this._isTypeChanged=!0:this._parent.onTypeChange()},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),e.prototype.onSizeChange=function(){0<this._lockCount?this._isSizeChanged=!0:this._parent.onSizeChange()},Object.defineProperty(e.prototype,"transform",{get:function(){return this.updateTransform()},enumerable:!1,configurable:!0}),e.prototype.updateTransform=function(){var e=this._transform;null==e&&(e=new t.Matrix,this._transform=e);var n=this._parent.parent,i=n.id;if(this._transformId!==i){this._transformId=i;var r=n.formatted;2<=r.length?this.toTransform(r.values,e):e.identity()}return e},e.prototype.toTransformMatrix=function(t,e,n,i,r){var o=t-n,s=e-i,a=o*o+s*s;if(1e-5<a){var u=1/Math.sqrt(a),l=o*u,h=s*u;r.set(h,-l,-l,-h,t,e)}else r.set(1,0,0,1,t,e);return r},Object.defineProperty(e.prototype,"fill",{get:function(){return this._fill},enumerable:!1,configurable:!0}),e.prototype.onFillChange=function(){0<this._lockCount?this._isFillChanged=!0:this._parent.onFillChange()},e.prototype.updateUploaded=function(){this.onFillChange()},e.prototype.copy=function(t){this.lock(),this.type=t.type;var e=t.size;return this.size.set(e.x,e.y),this.fill.copy(t.fill),this.unlock(),this},e.prototype.set=function(t,e,n){return this.lock(),null!=t&&(this.type=t),this.size.set(e,n),this.unlock(),this},e.prototype.serialize=function(t){var e=this._size,n=this._fill.serialize(t);return t.addResource("[".concat(this._type,",").concat(e.x,",").concat(e.y,",").concat(n,"]"))},e.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getExtension(t);null==i&&(i=JSON.parse(n[t]),e.setExtension(t,i)),this.lock(),this.type=i[0],this._size.set(i[1],i[2]),this._fill.deserialize(i[3],e),this.unlock()}},e}(),vi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toTransform=function(t,e){var n=t.length;return 4<=n?this.toTransformMatrix(t[n-2],t[n-1],t[n-4],t[n-3],e):(e.identity(),e)},e}(gi),_i=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toTransform=function(t,e){return 4<=t.length?this.toTransformMatrix(t[0],t[1],t[2],t[3],e):(e.identity(),e)},e}(gi),mi=function(){function t(t){this._parent=t,this._lockCount=0,this._isTypeChanged=!1,this._isSizeChanged=!1,this._isFillChanged=!1,this._head=new vi(this),this._tail=new _i(this)}return t.prototype.lock=function(){return this._lockCount+=1,1===this._lockCount&&(this._isTypeChanged=!1,this._isSizeChanged=!1,this._isFillChanged=!1),this},t.prototype.unlock=function(){return this._lockCount-=1,0===this._lockCount&&(this._isTypeChanged?this.onTypeChange():this._isSizeChanged?this.onSizeChange():this._isFillChanged&&this.onFillChange(),this._isTypeChanged=!1,this._isSizeChanged=!1,this._isFillChanged=!1),this},Object.defineProperty(t.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"head",{get:function(){return this._head},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tail",{get:function(){return this._tail},enumerable:!1,configurable:!0}),t.prototype.onTypeChange=function(){0<this._lockCount?this._isTypeChanged=!0:this._parent.onMarkerTypeChange()},t.prototype.onSizeChange=function(){0<this._lockCount?this._isSizeChanged=!0:this._parent.onMarkerSizeChange()},t.prototype.onFillChange=function(){0<this._lockCount?this._isFillChanged=!0:this._parent.onMarkerFillChange()},t.prototype.copy=function(t){return this.lock(),this._head.copy(t.head),this._tail.copy(t.tail),this.unlock(),this},t.prototype.serialize=function(t){var e=this._head.serialize(t),n=this._tail.serialize(t);return t.addResource("[".concat(e,",").concat(n,"]"))},t.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getExtension(t);null==i&&(i=JSON.parse(n[t]),e.setExtension(t,i)),this.lock(),this._head.deserialize(i[0],e),this._tail.deserialize(i[1],e),this.unlock()}},t}(),bi=2*Math.PI,Ti=.5*Math.PI,wi=function(t,e,n,i){return t*n+e*i},Ei=function(t,e){return Math.sqrt(wi(t,e,t,e))},Oi=function(t,e,n,i){return t*i-e*n},Ci=function(t,e,n,i,r,o,s,a,u,l){var h=l.center;h[0]=t,h[1]=e;var c=l.axis1;c[0]=n,c[1]=i;var p=l.axis2;p[0]=r,p[1]=o;var f=l.angle;return f[0]=s,f[1]=a,f[2]=u,l},Si=function(t,e){var n=t.center,i=t.axis1,r=t.axis2,o=t.angle;return Ci(n[0],n[1],i[0],i[1],r[0],r[1],o[0],o[1],o[2],e)},xi=function(t,e){for(var n=t.length,i=0;i<n;++i)e[i]=t[i];return e.length!==n&&(e.length=n),e},Di=function(){function t(){}return t.set=function(t,e,n,i,r,o,s,a,u,l,h,c,p,f,d){for(var y=Math.max(Math.abs(e-n),Math.abs(s-a)),g=c?Math.max(1,Math.round(h*(y/Ti))):h,v=p?g+1:g,_=0;_<v;++_){var m=_/g,b=1-m,T=m,w=b*e+T*n,E=Math.cos(w),O=Math.sin(w),C=t[0]+E*i[0]+O*r[0],S=t[1]+E*i[1]+O*r[1],x=b*s+T*a,D=Math.cos(x),I=Math.sin(x),A=o[0]+D*u[0]+I*l[0],R=o[1]+D*u[1]+I*l[1],P=Ti*m,M=Math.cos(P),k=Math.sin(P),L=M*M,N=k*k,B=L*C+N*A,z=L*S+N*R;f[++d]=B,f[++d]=z}return d},t.interpolate=function(t,e,n,i,r,o,s,a){var u=a.values,l=a.segments;if(t<=2)return xi(e,u),xi(n,l),a;var h=this.WORK_P0||{center:[0,0],axis1:[0,0],axis2:[0,0],angle:[0,0,0]},c=this.WORK_P1||{center:[0,0],axis1:[0,0],axis2:[0,0],angle:[0,0,0]},p=this.WORK_P2||{center:[0,0],axis1:[0,0],axis2:[0,0],angle:[0,0,0]};this.WORK_P0=h,this.WORK_P1=c,this.WORK_P2=p;var f=-1,d=-1;if(r){i(0,t,e,h),Si(h,c);for(var y=1;y<t;++y){if(i(y,t,e,p),0<=di(n,y)){var g=y-1<<1;u[++f]=e[g+0],u[++f]=e[g+1],l[++d]=f+1>>1}else f=this.set(c.center,c.angle[1],c.angle[2],c.axis1,c.axis2,p.center,p.angle[0],p.angle[1],p.axis1,p.axis2,o,s,!1,u,f);var v=c;c=p,p=v}0<=di(n,0)?(g=t-1<<1,u[++f]=e[g+0],u[++f]=e[g+1],l.unshift(0),d+=1):f=this.set(c.center,c.angle[1],c.angle[2],c.axis1,c.axis2,h.center,h.angle[0],h.angle[1],h.axis1,h.axis2,o,s,!1,u,f)}else{i(1,t,e,h),0<=di(n,1)?(u[++f]=e[0],u[++f]=e[1],l[++d]=1):f=this.set(h.center,h.angle[0],h.angle[1],h.axis1,h.axis2,h.center,h.angle[0],h.angle[1],h.axis1,h.axis2,o,s,!1,u,f),Si(h,c),y=2;for(var _=t-1;y<_;++y)i(y,t,e,p),0<=di(n,y)?(g=y-1<<1,u[++f]=e[g+0],u[++f]=e[g+1],l[++d]=f+1>>1):f=this.set(c.center,c.angle[1],c.angle[2],c.axis1,c.axis2,p.center,p.angle[0],p.angle[1],p.axis1,p.axis2,o,s,!1,u,f),v=c,c=p,p=v;0<=di(n,t-1)?(g=t-2<<1,u[++f]=e[g+0],u[++f]=e[g+1],l[++d]=f+1>>1):f=this.set(c.center,c.angle[1],c.angle[2],c.axis1,c.axis2,c.center,c.angle[1],c.angle[2],c.axis1,c.axis2,o,s,!0,u,f)}return f+=1,u.length!==f&&(u.length=f),d+=1,l.length!==d&&(l.length=d),a},t.toCircle=function(t,e,n,i){var r=(0<t?t-1:e-1)<<1,o=t<<1,s=(t<e-1?t+1:0)<<1,a=n[r+0],u=n[r+1],l=n[o+0],h=n[o+1],c=n[s+0],p=n[s+1],f=l-a,d=h-u,y=c-l,g=p-h,v=a+.5*f,_=u+.5*d,m=l+.5*y,b=h+.5*g,T=-d,w=+f,E=-g,O=+y,C=Oi(T,w,E,O);if(Math.abs(C)<.001){if(0<=wi(f,d,y,g)||e<=2){var S=.01,x=Math.sin(S),D=Ei(f,d),I=Ei(y,g);return Ci(l,h,0,0,y/x,g/x,-S*D/I,0,S,i)}C=.001}var A=(O*(m-v)+E*(_-b))/C,R=v+A*T,P=_+A*w,M=l-R,k=h-P,L=-k,N=+M,B=c-R,z=p-P,U=Math.atan2(wi(L,N,B,z),wi(M,k,B,z)),j=a-R,F=u-P,H=Math.atan2(wi(L,N,j,F),wi(M,k,j,F));return 0<H*U&&(Math.abs(H)<Math.abs(U)&&(0<U?U-=bi:U+=bi),Math.abs(U)<Math.abs(H)&&(0<H?H-=bi:H+=bi)),Ci(R,P,M,k,L,N,H,0,U,i)},t.toEllipse=function(t,e,n,i){var r=(0<t?t-1:e-1)<<1,o=t<<1,s=(t<e-1?t+1:0)<<1,a=n[r+0],u=n[r+1],l=n[o+0],h=n[o+1],c=n[s+0],p=n[s+1],f=a-l,d=u-h,y=c-l,g=p-h;if(e<=2){var v=.01,_=Math.sin(v);return Ci(l,h,0,0,y/_,g/_,-v,0,v,i)}for(var m=Ei(f,d),b=Ei(y,g),T=wi(f,d,y,g)/(m*b),w=Math.acos(T),E=.5*w,O=.25*w,C=0,S=0,x=0,D=0,I=Math.max(m,b),A=Math.min(m,b),R=0;R<16;++R){var P=.5*E,M=w-P;C=I*Math.sin(P),S=I*Math.cos(P),x=A*Math.sin(M),1<(1-(D=A*Math.cos(M))/S)*(1-D/S)+x*x/(C*C)?E+=O:E-=O,O*=.5}var k=Math.asin(Math.min(x/C,1));if(m<b){var L=y/b,N=g/b,B=void 0,z=void 0;return 0<Oi(f,d,y,g)?(B=+N,z=-L):(B=-N,z=+L),Ci(G=l-(F=(U=-S*S/b)*L+(j=-S*C/b)*B),V=h-(H=U*N+j*z),F,H,c-G,p-V,-k,0,Ti,i)}var U,j,F,H,G,V,W=f/m,K=d/m;return B=void 0,z=void 0,Oi(f,d,y,g)<0?(B=+K,z=-W):(B=-K,z=+W),Ci(G=l-(F=(U=-S*S/m)*W+(j=-S*C/m)*B),V=h-(H=U*K+j*z),F,H,-(a-G),-(u-V),-Ti,0,k,i)},t.toHybrid=function(e,n,i,r){var o=t.toCircle(e,n,i,r),s=o.angle[0],a=o.angle[2],u=Math.min(s,a),l=Math.max(s,a);return u<-Ti||Ti<l?t.toEllipse(e,n,i,r):o},t}(),Ii=function(t,e,n,i,r){return Di.interpolate(t,e,n,Di.toHybrid,!!(i&X.CLOSED),rt.CURVE_SEGMENT_COUNT,!0,r),r.length=r.values.length>>1,r.style=i,r},Ai=function(t,e){for(var n=t.length,i=0;i<n;++i)e[i]=t[i];return e.length!==n&&(e.length=n),e},Ri=function(t,e,n,i,r,o){var s=1-r;return o[0]=t*s+n*r,o[1]=e*s+i*r,o},Pi=function(t,e,n,i,r,o,s,a,u,l,h){for(var c=[0,0],p=[0,0],f=[0,0],d=s;d<a;++d){var y=d/u;Ri(t,e,n,i,y,c),Ri(n,i,r,o,y,p),Ri(c[0],c[1],p[0],p[1],y,f),l[++h]=f[0],l[++h]=f[1]}return h},Mi=function(t,e,n,i,r){return function(t,e,n,i,r,o){var s=o.values,a=o.segments;if(t<=2)return Ai(e,s),Ai(n,a),o;var u=-1,l=-1,h=r>>1;if(i){for(var c=0;c+2<t;c+=2){var p=c<<1,f=0<=di(n,c+1),d=0<=di(n,c+2);f&&d?(s[++u]=e[p+0],s[++u]=e[p+1],a[++l]=1+(u>>1)):f?(s[++u]=e[p+0],s[++u]=e[p+1],a[++l]=1+(u>>1),u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],h,r,r,s,u)):d?(u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],0,h,r,s,u),a[++l]=1+(u>>1)):u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],0,r,r,s,u)}c+1<t?(p=c<<1,f=0<=di(n,c+1),d=0<=di(n,0),f&&d?(s[++u]=e[0],s[++u]=e[1],a.unshift(0),l+=1):f?(s[++u]=e[p+0],s[++u]=e[p+1],a[++l]=1+(u>>1),u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[0],e[1],h,r,r,s,u)):d?(u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[0],e[1],0,h,r,s,u),a[++l]=1+(u>>1)):u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[0],e[1],0,r,r,s,u)):c<t&&(p=c<<1,s[++u]=e[p+0],s[++u]=e[p+1],0<=di(n,0)&&(a.unshift(0),l+=1))}else{for(c=0;c+2<t;c+=2)p=c<<1,f=0<=di(n,c+1),d=0<=di(n,c+2),f&&d?(s[++u]=e[p+0],s[++u]=e[p+1],a[++l]=1+(u>>1)):f?(s[++u]=e[p+0],s[++u]=e[p+1],a[++l]=1+(u>>1),u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],h,r,r,s,u)):d?(u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],0,h,r,s,u),a[++l]=1+(u>>1)):u=Pi(e[p+0],e[p+1],e[p+2],e[p+3],e[p+4],e[p+5],0,r,r,s,u);for(;c+1<t;++c)p=c<<1,s[++u]=e[p+0],s[++u]=e[p+1],s[++u]=e[p+2],s[++u]=e[p+3],0<=di(n,c+1)&&(a[++l]=1+(u>>1));for(;c<t;++c)p=c<<1,s[++u]=e[p+0],s[++u]=e[p+1]}u+=1,s.length!==u&&(s.length=u),l+=1,a.length!==l&&(a.length=l)}(t,e,n,!!(i&X.CLOSED),rt.CURVE_SEGMENT_COUNT,r),r.length=r.values.length>>1,r.style=i,r},ki=function(){function t(){}return t.set=function(t,e){null==this.data&&(this.data=this.newData()),this.data.set(t,e)},t.get=function(t){return null==this.data&&(this.data=this.newData()),this.data.get(t)},t.each=function(t){null==this.data&&(this.data=this.newData()),this.data.forEach((function(e,n){t(n,e)}))},t.find=function(t){return this.get((t&X.FORMATTER_MASK)>>X.FORMATTER_SHIFT)},t.newData=function(){var t=new Map,e=it.get("EShapePointsFormatter");return t.set(X.FORMATTER_CURVE_SPLINE,{label:e.getCurveSplineLabel(),formatter:Ii}),t.set(X.FORMATTER_CURVE_BEZIER_QUADRATIC,{label:e.getCurveBezierQuadraticLabel(),formatter:Mi}),t},t}(),Li=function(){function e(e){this._parent=e,this._valuesBaseLength=0,this._values=[],this._segments=[],this._length=0,this._plength=0;var n=e.size,i=n.x,r=n.y;this._parentSizeBase=new t.Point(i,r),this._parentSizeFitted=new t.Point(i,r),this._id=0,this._style=this.newStyle(),this._formattedId=-1}return e.prototype.newStyle=function(){return X.NONE},Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plength",{get:function(){return this._plength},enumerable:!1,configurable:!0}),e.prototype.toFitted=function(t,e){this._valuesBase=void 0,this._parentSizeFitted.set(t,e),this._parentSizeBase.set(t,e)},e.prototype.onSizeChange=function(){this.fit()},e.prototype.fit=function(){var t=this._parent,e=this._parentSizeFitted,n=t.size,i=n.x,r=n.y,o=1e-5;if(!(Math.abs(i-e.x)<=o&&Math.abs(r-e.y)<=o)){e.set(i,r);var s=this._parentSizeBase,a=o<Math.abs(s.x),u=o<Math.abs(s.y);if(a||u){var l=a?i/s.x:1,h=u?r/s.y:1,c=this._values,p=this._valuesBase;if(null==p){p=[],this._valuesBase=p;for(var f=0,d=c.length;f<d;f+=2){var y=c[f],g=c[f+1];c[f]=y*l,c[f+1]=g*h,p.push(y,g)}}else for(f=0,d=c.length;f<d;f+=2)c[f]=p[f]*l,c[f+1]=p[f+1]*h;if(this._id+=1,this._formatter||this._style&X.FORMATTER_MASK){var v=t.uploaded;v&&!v.isCompatible(t)&&t.toDirty()}}}},Object.defineProperty(e.prototype,"id",{get:function(){return this.fit(),this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this.fit(),this._values},set:function(t){this.set(t,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"segments",{get:function(){return this._segments},set:function(t){this.set(void 0,t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},set:function(t){this.set(void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"marker",{get:function(){var t;return null!==(t=this._marker)&&void 0!==t?t:this._marker=this.newMarker()},enumerable:!1,configurable:!0}),e.prototype.getMarker=function(){return this._marker},e.prototype.newMarker=function(){return new mi(this)},e.prototype.onMarkerTypeChange=function(){var t=this._parent;t.uploaded=void 0,t.toDirty()},e.prototype.onMarkerSizeChange=function(){this._parent.updateUploaded()},e.prototype.onMarkerFillChange=function(){this._parent.updateUploaded()},Object.defineProperty(e.prototype,"formatter",{get:function(){return this._formatter||null},set:function(t){this._formatter!==t&&(this._formattedId=-1,this._formatter=t,this.toDirty(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formatted",{get:function(){var t,e;this.fit();var n=this._id,i=this._formatted;if(this._formattedId!==n){this._formattedId=n;var r=this._style,o=null!==(t=this._formatter)&&void 0!==t?t:null===(e=ki.find(r))||void 0===e?void 0:e.formatter;if(null!=o){null==i&&(i={length:0,plength:0,values:[],segments:[],boundary:[0,0,0,0],style:X.NONE});var s=this._values,a=this._segments;o(s.length>>1,s,a,r,i),i.plength<i.length&&(i.plength=i.length),yi(i.values,i.boundary)}else i=void 0;this._formatted=i}return i||this},enumerable:!1,configurable:!0}),e.prototype.toScaled=function(t,e,n,i){var r=this._parentSizeFitted,o=this._parentSizeBase,s=1e-5,a=s<Math.abs(o.x),u=s<Math.abs(o.y);if(a||u){for(var l=a?r.x/o.x:1,h=u?r.y/o.y:1,c=0,p=e.length;c<p;c+=2)t[c]=e[c]*l,t[c+1]=e[c+1]*h;for(c=0,p=i.length;c<p;c+=2)n[c]=i[c]*l,n[c+1]=i[c+1]*h}},e.prototype.copy=function(t){this.set(t.values,t.segments,t.style);var e=t.getMarker();return e&&this.marker.copy(e),this},e.prototype.set=function(t,e,n){var i=!1,r=!1,o=this._style,s=o&X.FORMATTER_MASK,a=this._formatter;if(null!=t){var u=this._values,l=this._valuesBaseLength,h=t.length,c=Math.min(h,l),p=this._parent.size;if(this.toFitted(p.x,p.y),u!==t){for(var f=0;f<c;++f)u[f]=t[f];for(f=c;f<h;++f)u.push(t[f]);l!==h?(u.length=h,this._valuesBaseLength=h,i=!0):null!=a||s?i=!0:r=!0}else l!==h?(this._valuesBaseLength=h,i=!0):null!=a||s?i=!0:r=!0;var d=h>>1;this._length=d,this._plength<d&&(this._plength=d)}if(null!=e){var y=this._segments;if(y!==e){var g=e.length;for(c=Math.min(y.length,g),f=0;f<c;++f)y[f]=e[f];for(f=c;f<g;++f)y.push(e[f]);y.length!==g&&(y.length=g)}null!=a||s?i=!0:r=!0}return null!=n&&o!==n&&(s!==(n&X.FORMATTER_MASK)||(null!=a||s)&&(o&X.CLOSED)!=(n&X.CLOSED)?i=!0:r=!0,this._style=n),(r||i)&&this.toDirty(i),this},e.prototype.toDirty=function(t){if(t){this._id+=1;var e=this._parent,n=e.uploaded;n?n.isCompatible(e)?e.updateUploaded():e.toDirty():e.updateUploaded()}else this._id+=1,this._parent.updateUploaded()},e.prototype.clone=function(t){return new e(t).copy(this)},e.prototype.toPoints=function(e){for(var n=[],i=this.values,r=0,o=i.length;r<o;r+=2){var s=new t.Point(i[r+0],i[r+1]);n.push(e.apply(s,s))}return n},e.prototype.serialize=function(t){var e=JSON.stringify(this._values),n=JSON.stringify(this._segments),i=this._style,r=-1,o=this._marker;return o&&(r=o.serialize(t)),t.addResource("[".concat(e,",").concat(n,",").concat(i,",").concat(r,"]"))},e.prototype.deserialize=function(t,e){var n=e.resources;if(0<=t&&t<n.length){var i=e.getExtension(t);null==i&&(i=JSON.parse(n[t]),e.setExtension(t,i)),this.set(i[0],i[1],i[2]);var r=i[3];null!=r&&0<=r&&this.marker.deserialize(r,e)}},e.prototype.calcHitPointAbs=function(t,n,i,r,o,s,a,u){var l=this.formatted,h=l.length;if(2<=h){var c=l.values,p=l.segments,f=l.style,d=0,y=h;if(s){var g=e.WORK_RANGE;s(t,n,o,c,g),d=g[0],y=g[1]}for(var v=d,_=Math.min(y,h-1);v<_;++v){var m;if(di(p,v+1)<0&&a(t,n,c[0+(m=v<<1)],c[m+1],c[m+2],c[m+3],v,o,u))return!0}if(2<h&&h<=y&&f&X.CLOSED&&di(p,0)<0&&a(t,n,c[0+(m=(v=h-1)<<1)],c[m+1],c[0],c[1],v,o,u))return!0}return!1},e.WORK_RANGE=[0,0],e}(),Ni=function(){function t(t,e){this._parent=t,this._id=0,this._values=[],this._lockCount=0,this._isChanged=!1,this._onChange=e}return t.prototype.lock=function(){this._lockCount+=1,1===this._lockCount&&(this._isChanged=!1)},t.prototype.unlock=function(){this._lockCount-=1,0===this._lockCount&&(this._isChanged&&this.onChange(),this._isChanged=!1)},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){return this._values},set:function(t){this.set(t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t){if(null!=t){if(this._id+=1,this._values!==t){for(var e=t.length,n=this._values,i=0;i<e;++i)n[i]=t[i];n.length=e}this.onChange()}return this},t.prototype.copy=function(t){return this.set(t.values)},t.prototype.serialize=function(t){return t.addResource(JSON.stringify(this._values))},t.prototype.deserialize=function(t,e,n){var i=n.resources;if(0<=t&&t<i.length){var r=n.getExtension(t);null==r&&(r=JSON.parse(i[t]),n.setExtension(t,r)),this.set(r)}},t.prototype.onChange=function(){0<this._lockCount?this._isChanged=!0:this._onChange()},t}(),Bi=function(t){function e(e){void 0===e&&(e=i.CONNECTOR_LINE);var n=t.call(this,e)||this;n._tailLocalId=0,n._tailNormalId=0,n._tailMargin=0,n._headLocalId=0,n._headNormalId=0,n._headMargin=0,n._bodyId=0,n._lockConnector=new Bt;var r=.5*rt.SIZE_X,o=.5*rt.SIZE_Y;n._points=new Li(n).set([-r,-o,+r,+o]);var s=function(){n.onChange()};return n._edge=new fi(n,s),n._body=new Ni(n,s),n}return F(e,t),e.prototype.lock=function(e){return e&zt.CONNECTOR&&this._lockConnector.lock(),t.prototype.lock.call(this,e),this},e.prototype.unlock=function(e,n){return t.prototype.unlock.call(this,e,n),e&zt.CONNECTOR&&this._lockConnector.unlock()&&n&&this.onChange(),this},Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"edge",{get:function(){return this._edge},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},enumerable:!1,configurable:!0}),e.prototype.onAttach=function(){t.prototype.onAttach.call(this),this._edge.attach()},e.prototype.onDetach=function(e){this._edge.detach(e),t.prototype.onDetach.call(this,e)},e.prototype.onChange=function(){var t;if(!this._lockConnector.isLocked()){var n=this._edge,i=n.tail,r=i.localId,o=i.normalId,s=i.margin,a=n.head,u=a.localId,l=a.normalId,h=a.margin,c=this._body,p=c.id;if(this._tailLocalId!==r||this._tailNormalId!==o||this._tailMargin!==s||this._headLocalId!==u||this._headNormalId!==l||this._headMargin!==h||this._bodyId!==p){this._tailLocalId=r,this._tailNormalId=o,this._tailMargin=s,this._headLocalId=u,this._headNormalId=l,this._headMargin=h,this._bodyId;var f=this.transform,d=f.position,y=d.x,g=d.y,v=this._points,_=v.values;this.fillPoints(i,s,a,h,c,y,g,_);var m=null!==(t=e.WORK_BOUNDARY)&&void 0!==t?t:e.WORK_BOUNDARY=[0,0,0,0];yi(_,m);for(var b=.5*(m[2]+m[0]),T=.5*(m[3]+m[1]),w=m[2]-m[0],E=m[3]-m[1],O=0,C=_.length;O<C;O+=2)_[O+0]-=b,_[O+1]-=T;this.lock(zt.TRANSFORM_AND_UPLOADED),d.set(y+b,g+T),f.scale.set(1,1),f.rotation=0,f.skew.set(0,0),v.toFitted(w,E),this.size.set(w,E),v.set(_),this.unlock(zt.TRANSFORM_AND_UPLOADED,!0)}}},e.prototype.fillPoints=function(t,e,n,i,r,o,s,a){var u=1e-6,l=t.local,h=l.x-o,c=l.y-s,p=n.local,f=p.x-o,d=p.y-s,y=r.values,g=y.length;if(a[0]=h,a[1]=c,0<g)for(var v=.5*(f+h),_=.5*(d+c),m=f-h,b=d-c,T=Math.atan2(b,m),w=Math.cos(T),E=Math.sin(T),O=Math.sqrt(m*m+b*b),C=0;C<g;C+=2){var S=y[C+0],x=y[C+1];a[C+2]=v+(w*S-E*x)*O,a[C+3]=_+(w*x+E*S)*O}if(a[2+g]=f,a[3+g]=d,0!==e&&u<(m=a[2]-h)*m+(b=a[3]-c)*b){var D=e/Math.sqrt(m*m+b*b);a[0]=h+m*D,a[1]=c+b*D}0!==i&&u<(m=a[0+g]-f)*m+(b=a[1+g]-d)*b&&(D=i/Math.sqrt(m*m+b*b),a[2+g]=f+m*D,a[3+g]=d+b*D),a.length=g+4},e.prototype.copy=function(n,i){return void 0===i&&(i=gt.ALL),this.lock(zt.ALL),t.prototype.copy.call(this,n,i),n instanceof e&&(this._edge.copy(n.edge),this._body.copy(n.body)),this.unlock(zt.ALL,!0),this},e.prototype.clone=function(){return new(0,this.constructor)(this.type).copy(this)},e.prototype.serialize=function(e){var n=t.prototype.serialize.call(this,e),i=this._edge.serialize(e),r=this._body.serialize(e),o=this._points.serialize(e);return n[15]=e.addResource("[".concat(i,",").concat(o,",").concat(r,"]")),n},e}(ce),zi=function(){function t(){}return t.isConnector=function(t){return t instanceof Bi},t.newMapping=function(e,n,i){var r;null==i&&(i=null!==(r=t._MAPPING)&&void 0!==r?r:t._MAPPING=new Map).clear();for(var o=0,s=e.length;o<s;++o){var a=e[o],u=n[o];i.set(a,u),this.newMapping(a.children,u.children,i)}return i},t.moveAll=function(t,e,n,i,r){for(var o=0,s=n.length;o<s;++o){var a=n[o],u=i[o];if(this.isConnector(a)&&this.isConnector(u)){var l=a.edge,h=u.edge,c=l.head,p=c.acceptor.shape;if(p){null==r&&(r=this.newMapping(t,e));var f=r.get(p);if(f){var d=h.head;d.detach(),d.set(f),d.attach(),f.connector.remove(c)}}var y=l.tail,g=y.acceptor.shape;if(g){null==r&&(r=this.newMapping(t,e));var v=r.get(g);if(v){var _=h.tail;_.detach(),_.set(v),_.attach(),v.connector.remove(y)}}}r=this.moveAll(t,e,a.children,u.children,r)}return r},t.move=function(t,e){var n=t.children,i=e.children;this.moveAll(n,i,n,i)},t}(),Ui=function(){function e(e,n,i,r,o){this.id=e,this.ref=0;var s=o.resolution;this.frame=new t.Rectangle(0,0,n*s,i*s),this.texture=new t.Texture(o,new t.Rectangle(0,0,1,1)),this.width=n,this.height=i,this.strokeWidth=r}return e.prototype.applyFrame=function(){var t=1/this.texture.baseTexture.resolution;this.texture.frame.x=this.frame.x*t,this.texture.frame.y=this.frame.y*t,this.texture.frame.width=this.width,this.texture.frame.height=this.height,this.texture.updateUvs(),this.texture.emit("update",this)},e.prototype.destroy=function(){this.texture.destroy()},e}(),ji=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.render=function(t){},e}(Ui),Fi=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.render=function(t){var e=this.frame;t.save(),t.fillStyle="#ffffff",t.fillRect(e.x-1,e.y-1,e.width+2,e.height+2),t.restore()},e}(Ui),Hi=function(){function e(e){var n=this._canvas=document.createElement("canvas");n.width=n.height=256;var i=t.BaseTexture.from(n,{mipmap:t.MIPMAP_MODES.OFF,resolution:e});this._baseTexture=i,this._idToDatum={},this._sortedData=[],this._predefined={empty:new ji("empty",10,10,0,i),white:new Fi("white",10,10,0,i)},this._isDirty=!0}return e.prototype.updateFrames=function(t,e){for(var n=4,i=4,r=0,o=0,s=e.length;o<s;++o){var a=e[o];t<n+a.frame.width+4&&(n=4,i+=r+4,r=0),a.frame.x=0|n,a.frame.y=0|i,n+=a.frame.width+4,r=Math.max(r,a.frame.height)}for(var u=i+r+4,l=256;l<u;)l<<=1;return Math.min(4096,l)},e.prototype.renderFrames=function(t,e,n){var i=this._canvas;i.width=t,i.height=e;var r=i.getContext("2d");if(null!=r)for(var o=0,s=n.length;o<s;++o)n[o].render(r)},e.prototype.applyFrames=function(t){for(var e=0,n=t.length;e<n;++e)t[e].applyFrame()},e.prototype.calcCanvasWidth=function(t){for(var e=512,n=t.length-1;0<=n;--n)for(var i=t[n],r=Math.max(i.frame.width,i.frame.height);e<r;)e<<=1;return Math.min(4096,e<<1)},e.prototype.cleanup=function(t){t.sort(e.ITEM_COMPARATOR);for(var n=t.length-1;0<=n;--n)if(0<t[n].ref)return void(t.length=n+1);t.length=0},e.prototype.begin=function(){for(var t=this._sortedData,e=0,n=t.length;e<n;++e)t[e].ref=0;this._isDirty=!1},e.prototype.end=function(){for(var t=this._idToDatum,e=this._sortedData,n=0,i=e.length;n<i;++n){var r=e[n];r.ref<=0&&(r.id in this._predefined||r.destroy(),delete t[r.id],this._isDirty=!0)}},e.prototype.repack=function(t){if(!0===t||this._isDirty){this._isDirty=!1;var e=this._sortedData;this.cleanup(e);var n=this.calcCanvasWidth(e),i=this.updateFrames(n,e);this.renderFrames(n,i,e),this._baseTexture.setRealSize(n,i),this.applyFrames(e)}},e.prototype.get=function(t){var e=this._idToDatum[t];if(null!=e)return e.ref+=1,e;var n=this._predefined[t];return null!=n?(this.set(t,n),n):null},e.prototype.contains=function(t){return t in this._idToDatum},e.prototype.set=function(t,e){var n=this._idToDatum[t];return e.ref+=1,this._idToDatum[t]=e,this._sortedData.push(e),this._isDirty=!0,n},e.prototype.toDirty=function(){this._isDirty=!0},e.prototype.getDefaultTexture=function(){return this.get("white").texture},e.prototype.getBaseTexture=function(){return this._baseTexture},e.prototype.release=function(t){var e=this._idToDatum,n=e[t];null!=n&&(n.ref-=1,n.ref<=0&&(n.id in this._predefined||n.destroy(),delete e[t],this._isDirty=!0))},e.prototype.destroy=function(){var t=this._baseTexture;null!=t&&t.destroy()},e.ITEM_COMPARATOR=function(t,e){return t.ref<=0?e.ref<=0?0:1:e.ref<=0||t.frame.height<e.frame.height?-1:e.frame.height<t.frame.height?1:t.frame.width-e.frame.width},e}(),Gi=function(t){function e(e,n){var i=t.call(this,e.id,e.width/n.resolution,e.height/n.resolution,0,n)||this;return i.canvas=e.canvas,i}return F(e,t),e.prototype.render=function(t){var e=this.canvas;if(null!=e){var n=this.frame;t.drawImage(e,n.x,n.y,n.width,n.height)}},e}(Ui),Vi=function(t,e){this.x=t,this.y=e},Wi=function(){function t(e,n,i,r,o,s,a){this.ref=1,this.life=t.LIFE,this.character=n,this.x=i,this.y=r,this.width=o,this.height=s,this.advance=a,this.origin=new Vi(0,0),this.type=e}return t.LIFE=10,t}(),Ki={RESERVED:1,NON_BREAKING:2,SPACE:4,SPACE_R:5,SPACE_NB:6,SPACE_RNB:7,LETTER:8,LETTER_R:9,LETTER_NB:10,LETTER_RNB:11},Xi=function(){function t(e){this.id=t.toFontFamily(e),this.size=32,this.italic=!1,this.measured=!1,this.ascent=0,this.descent=0}return t.toFontFamily=function(e){return"auto"===e?t.getAutoFontFamily():e},t.getAutoFontFamily=function(){return null==t.FONT_FAMILY_AUTO&&(t.FONT_FAMILY_AUTO=it.getInstance().get("DBase").getFontFamilly()),t.FONT_FAMILY_AUTO},t.FONT_FAMILY_AUTO=null,t}(),Yi=function(){function t(){var t=this;this._gl=null,this._texture=null,this._shaderProgram=null,this._vertexPositionAttribute=0,this._textureCoordAttribute=1,this._samplerUniform=null,this._sizeUniform=null,this._vb=null,this._uvb=null;var e=this._canvas=document.createElement("canvas");e.width=64,e.height=64,this._onLostBound=function(t){t.preventDefault()},this._onRestoreBound=function(){t.restore()},this._onUnloadBound=function(){t.destroy()},e.addEventListener("webglcontextlost",this._onLostBound,!1),e.addEventListener("webglcontextrestored",this._onRestoreBound,!1),window.addEventListener("unload",this._onUnloadBound,!1)}return t.prototype.init=function(){var t=this._canvas;if(null!=t&&(null==this._gl||this._gl.isContextLost())){var e={alpha:!0,antialias:!1,depth:!1,stencil:!1,premultipliedAlpha:!1},n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e);this._gl=n,null!=n&&(n.clearColor(1,1,1,0),this.makeVertexBuffer(),this.makeUvBuffer(),this.makeShaders(),this._texture=null)}return this},t.prototype.restore=function(){this.init()},t.prototype.getCanvas=function(){return this._canvas},t.prototype.getShader=function(t,e,n){var i=n?t.createShader(t.FRAGMENT_SHADER):t.createShader(t.VERTEX_SHADER);return null==i||(t.shaderSource(i,e),t.compileShader(i),t.getShaderParameter(i,t.COMPILE_STATUS))?i:(console&&console.error("Failed to compile the shader: ".concat(t.getShaderInfoLog(i))),null)},t.prototype.makeShaders=function(){var t=this._gl;if(null!=t&&!0!==t.isContextLost()){var e=this.getShader(t,"\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nvarying mediump vec2 vTextureCoord;\nvoid main(void) {\n\tgl_Position = vec4(aVertexPosition, 0.0, 1.0);\n\tvTextureCoord = aTextureCoord;\n}\n",!1);if(null!=e){var n=this.getShader(t,"\nprecision mediump float;\n\nvarying mediump vec2 vTextureCoord;\nuniform sampler2D uSampler;\nuniform vec2 uSize;\n\nfloat norm(vec2 v) {\n\treturn dot(v, v);\n}\n\nfloat norm(vec2 p, vec2 dp) {\n\tvec2 xy = p + dp;\n\tvec2 uvi = vec2(1.0) / uSize;\n\tvec2 uv = xy * uvi;\n\tvec4 t0 = vec4(texture2D(uSampler, uv).a);\n\tvec4 t1 = vec4(\n\t\ttexture2D(uSampler, uv + vec2(-uvi.x, 0.0   )).a,\n\t\ttexture2D(uSampler, uv + vec2(0.0   , -uvi.y)).a,\n\t\ttexture2D(uSampler, uv + vec2(+uvi.x, 0.0   )).a,\n\t\ttexture2D(uSampler, uv + vec2(0.0   , +uvi.y)).a\n\t);\n\tvec4 t2 = vec4(0.5);\n\tvec4 t3 = min(t1,t0);\n\tvec4 t4 = max(t1,t0);\n\n\tvec4 w0 = (t2 - t0) / (t1 - t0);\n\tvec4 s0 = vec4(\n\t\tt3.x < 0.5 && 0.5 <= t4.x,\n\t\tt3.y < 0.5 && 0.5 <= t4.y,\n\t\tt3.z < 0.5 && 0.5 <= t4.z,\n\t\tt3.w < 0.5 && 0.5 <= t4.w\n\t);\n\tvec4 l0 = vec4(\n\t\tnorm(dp + vec2(-w0.x, 0.0  )),\n\t\tnorm(dp + vec2(0.0  , -w0.y)),\n\t\tnorm(dp + vec2(+w0.z, 0.0  )),\n\t\tnorm(dp + vec2(0.0  , +w0.w))\n\t);\n\tvec4 c0 = vec4(100.0);\n\tvec4 r0 = mix(c0, l0, s0);\n\n\tvec4 w1 = w0 * vec4(0.5);\n\tvec4 s1 = vec4(\n\t\t0.5 < s0.x && 0.5 < s0.y,\n\t\t0.5 < s0.y && 0.5 < s0.z,\n\t\t0.5 < s0.z && 0.5 < s0.w,\n\t\t0.5 < s0.w && 0.5 < s0.x\n\t);\n\tvec4 l1 = vec4(\n\t\tnorm(dp + vec2(-w1.x, -w1.y)),\n\t\tnorm(dp + vec2(+w1.z, -w1.y)),\n\t\tnorm(dp + vec2(+w1.z, +w1.w)),\n\t\tnorm(dp + vec2(-w1.x, +w1.w))\n\t);\n\tvec4 r1 = mix(c0, l1, s1);\n\tvec4 r2 = min(r0, r1);\n\tvec2 r3 = min(r2.xy, r2.zw);\n\treturn min(r3.x, r3.y);\n}\n\nfloat normY(vec2 p, float dx) {\n\tfloat result = 100.0;\n\tfor (float dy=-6.0; dy < 6.5; dy += 1.0) {\n\t\tresult = min(result, norm(p, vec2(dx, dy)));\n\t}\n\treturn result;\n}\n\nfloat normX(vec2 p) {\n\tfloat result = 100.0;\n\tfor (float dx=-6.0; dx < 6.5; dx += 1.0) {\n\t\tresult = min(result, normY(p, dx));\n\t}\n\treturn result;\n}\n\nvoid main(void) {\n\tfloat t = texture2D(uSampler, vTextureCoord).a;\n\tfloat d = min( 6.0, sqrt(normX( vTextureCoord * uSize )) ) / 12.0;\n\td = clamp( mix( 0.5 - d, 0.5 + d, step( 0.5, t ) ), 0.0, 1.0 ) * 255.0;\n\tfloat r = floor(d);\n\td = (d - r) * 255.0;\n\tfloat g = floor(d);\n\tgl_FragColor = vec4(r * 0.00392156862745098, g * 0.00392156862745098, d - g, 1.0);\n}\n",!0);if(null!=n){var i=this._shaderProgram=t.createProgram();if(null!=i)return t.attachShader(i,e),t.attachShader(i,n),t.bindAttribLocation(i,0,"aVertexPosition"),t.bindAttribLocation(i,1,"aTextureCoord"),t.linkProgram(i),t.getProgramParameter(i,t.LINK_STATUS)?(t.deleteShader(e),t.deleteShader(n),t.useProgram(i),this._samplerUniform=t.getUniformLocation(i,"uSampler"),this._sizeUniform=t.getUniformLocation(i,"uSize"),t.useProgram(null),i):(console&&console.error("Failed to link the program: ".concat(t.getError())),t.deleteShader(e),t.deleteShader(n),null);t.deleteShader(e),t.deleteShader(n)}else t.deleteShader(e)}}return null},t.prototype.destroyShaders=function(){var t=this._gl;if(null!=t&&!0!==t.isContextLost()){var e=this._shaderProgram;null!=e&&(this._shaderProgram=null,t.useProgram(null),t.deleteProgram(e))}},t.prototype.updateTexture=function(t,e,n){var i=this._gl,r=this._canvas;if(null!=i&&!0!==i.isContextLost()&&null!=r){r.width===t&&r.height===e||(r.width=t,r.height=e,i.viewport(0,0,t,e));var o=this._texture;return null==o?(o=this._texture=i.createTexture(),i.bindTexture(i.TEXTURE_2D,o),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_S,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_WRAP_T,i.CLAMP_TO_EDGE),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MAG_FILTER,i.NEAREST),i.texParameteri(i.TEXTURE_2D,i.TEXTURE_MIN_FILTER,i.NEAREST),i.bindTexture(i.TEXTURE_2D,null)):(i.bindTexture(i.TEXTURE_2D,o),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,n),i.bindTexture(i.TEXTURE_2D,null)),o}return null},t.prototype.destroyTexture=function(){var t=this._gl,e=this._texture;null!=t&&!0!==t.isContextLost()&&null!=e&&(this._texture=null,t.bindTexture(t.TEXTURE_2D,null),t.deleteTexture(e))},t.prototype.makeVertexBuffer=function(){var t=this._gl;if(null!=t&&!0!==t.isContextLost()){var e=this._vb=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([-1,1,1,1,-1,-1,1,-1]),t.STATIC_DRAW),e}return null},t.prototype.destroyVertexBuffer=function(){var t=this._gl,e=this._vb;null!=t&&!0!==t.isContextLost()&&null!=e&&(this._vb=null,t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(e))},t.prototype.makeUvBuffer=function(){var t=this._gl;if(null!=t&&!0!==t.isContextLost()){var e=this._uvb=t.createBuffer();return t.bindBuffer(t.ARRAY_BUFFER,e),t.bufferData(t.ARRAY_BUFFER,new Float32Array([0,0,1,0,0,1,1,1]),t.STATIC_DRAW),e}return null},t.prototype.destroyUvBuffer=function(){var t=this._gl,e=this._uvb;null!=t&&!0!==t.isContextLost()&&null!=e&&(this._uvb=null,t.bindBuffer(t.ARRAY_BUFFER,null),t.deleteBuffer(e))},t.prototype.render=function(){var t=this._gl,e=this._canvas,n=this._shaderProgram,i=this._vb,r=this._uvb,o=this._texture;if(null!=t&&!0!==t.isContextLost()&&null!=e&&null!=n&&null!=i&&null!=r&&null!=o){t.clear(t.COLOR_BUFFER_BIT),t.useProgram(n),t.bindBuffer(t.ARRAY_BUFFER,i);var s=this._vertexPositionAttribute;t.enableVertexAttribArray(s),t.vertexAttribPointer(s,2,t.FLOAT,!1,0,0),t.bindBuffer(t.ARRAY_BUFFER,r);var a=this._textureCoordAttribute;t.enableVertexAttribArray(a),t.vertexAttribPointer(a,2,t.FLOAT,!1,0,0),t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,o),t.uniform1i(this._samplerUniform,0),t.uniform2f(this._sizeUniform,e.width,e.height),t.drawArrays(t.TRIANGLE_STRIP,0,4),t.bindTexture(t.TEXTURE_2D,null),t.bindBuffer(t.ARRAY_BUFFER,null),t.useProgram(null)}},t.prototype.read=function(t){var e=this._gl,n=this._canvas;if(null!=e&&!0!==e.isContextLost()&&null!=n){var i=n.width,r=n.height;t.width=i,t.height=r;var o=t.getContext("2d");null!=o&&o.drawImage(n,0,0)}},t.prototype.destroy=function(){this.destroyVertexBuffer(),this.destroyUvBuffer(),this.destroyShaders();var t=this._canvas;null!=t&&(this._canvas=null,t.removeEventListener("webglcontextlost",this._onLostBound,!1),t.removeEventListener("webglcontextrestored",this._onRestoreBound,!1),window.removeEventListener("unload",this._onUnloadBound,!1));var e=this._gl;if(null!=e){this._gl=null;var n=e.getExtension("WEBGL_lose_context");null!=n&&n.loseContext()}},t.getInstance=function(){return null==t._INSTANCE&&(t._INSTANCE=new t),t._INSTANCE},t._INSTANCE=null,t}(),qi=function(){function e(){}return e.measure=function(e,n){if(!n.measured){if("fontBoundingBoxAscent"in window.TextMetrics.prototype){var i=e.measureText(t.TextMetrics.METRICS_STRING);n.ascent=i.fontBoundingBoxAscent,n.descent=i.fontBoundingBoxDescent}else{var r=t.TextMetrics.measureFont(n.id);n.ascent=r.ascent,n.descent=r.descent}n.measured=!0}},e.toSize=function(t){return this.setup(t),parseFloat(window.getComputedStyle(this._span).fontSize)},e.setup=function(t){var e=this._span;null==e&&((e=document.createElement("span")).innerText="|q",e.style.border="none",e.style.margin="0px",this._span=e);var n=this._block;null==n&&((n=document.createElement("div")).style.display="inline-block",n.style.width="0px",n.style.height="0px",n.style.border="none",n.style.margin="0px",n.style.verticalAlign="baseline",this._block=n);var i=this._div;null==i&&((i=document.createElement("div")).style.position="absolute",i.style.padding="0px",i.style.margin="0px",i.style.visibility="hidden",i.appendChild(e),i.appendChild(n),document.body.appendChild(i),this._div=i),e.style.font=t},e}(),Zi=function(){function t(t){this._id="font-atlas:".concat(t),this._generator=Yi.getInstance().init(),this._canvas=document.createElement("canvas"),this._font=new Xi(t),this._width=1,this._height=1;var e=new Map;e.set(C.SPACE,this.newChar(C.SPACE,Ki.SPACE_R)),e.set(C.TAB,this.newChar(C.SOFT_TAB,Ki.SPACE_R)),e.set(C.DOTS,this.newChar(C.DOTS,Ki.LETTER_RNB));for(var n=C.ASCII.LOW.FROM;n<=C.ASCII.LOW.TO;++n){var i=String.fromCodePoint(n);e.set(i,this.newChar(i,Ki.LETTER_RNB))}for(n=C.ASCII.HIGH.FROM;n<=C.ASCII.HIGH.TO;++n)i=String.fromCodePoint(n),e.set(i,this.newChar(i,Ki.LETTER_RNB));this._characters=e,this._isDirty=!0,this._isTouched=!1,this._life=Wi.LIFE}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"font",{get:function(){return this._font},set:function(t){this._font.id=t.id,this._font.size=t.size,this._font.italic=t.italic},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"generator",{get:function(){return this._generator},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"characters",{get:function(){return this._characters},enumerable:!1,configurable:!0}),t.prototype.begin=function(){this._isTouched=!1,this._characters.forEach((function(t){t.type&Ki.RESERVED||(t.ref=0)}))},t.prototype.end=function(){var t=this,e=this._characters;this._isTouched?(this._life=Wi.LIFE,e.forEach((function(n,i){n.ref<=0&&!(n.type&Ki.RESERVED)&&(n.life-=1,n.life<=0&&(e.delete(i),t._isDirty=!0))}))):(this._life-=1,this._life<=0&&0<e.size&&(e.clear(),this._isDirty=!0))},t.prototype.newChar=function(t,e){return new Wi(e,t,0,0,1,1,0)},t.prototype.add=function(t,e){for(var n=this._characters,i=0,r=e.length;i<r;++i){var o=e[i],s=n.get(o);null!=s?(s.ref+=1,s.life=Wi.LIFE):(n.set(o,this.newChar(o,Ki.LETTER)),this._isDirty=!0)}0<t.length&&(this._isTouched=!0)},t.prototype.get=function(t){return this._characters.get(t)},t.prototype.update=function(){if(this._isDirty){var t=this._canvas,e=this._generator;if(null!=t&&null!=e){var n=t.getContext("2d");if(null!=n){this._isDirty=!1;var i=this._font,r=i.size+14,o=this._characters,s=this.toPowerOf2(Math.ceil(Math.sqrt(o.size))*r);this._width=s;var a=(i.italic?"italic ":"")+i.size+"px "+i.id;n.font=a,n.textAlign="left",n.textBaseline="alphabetic",n.lineWidth=0,n.lineCap="round",n.lineJoin="miter",n.miterLimit=10,n.fillStyle="#FFFFFF",qi.measure(n,i);var u=Math.round(.5*(r-(i.ascent+i.descent))+i.ascent),l=0,h=0;o.forEach((function(t){var e=n.measureText(t.character).width,i=Math.ceil(7+e+7),o=r;s<=l+i&&(l=0,h+=r),t.x=l,t.y=h,t.width=i,t.height=o,t.advance=e,t.origin.x=l+7,t.origin.y=h+u,l+=i}));var c=this._height=h+r;return t.width=s,t.height=c,n.font=a,n.textAlign="left",n.textBaseline="alphabetic",n.lineWidth=0,n.lineCap="round",n.lineJoin="miter",n.miterLimit=10,n.fillStyle="#FFFFFF",n.clearRect(0,0,s,c),o.forEach((function(t){n.fillText(t.character,t.origin.x,t.origin.y)})),e.updateTexture(s,c,t),e.render(),e.read(t),!0}}}return!1},Object.defineProperty(t.prototype,"length",{get:function(){return this._characters.size},enumerable:!1,configurable:!0}),t.prototype.toJson=function(){return{width:this._width,height:this._height,font:this._font,characters:this._characters}},t.prototype.toString=function(){return JSON.stringify(this.toJson())},t.prototype.destroy=function(){null!=this._generator&&(this._generator=null),null!=this._canvas&&(this._canvas=null),this._characters.clear()},t.prototype.toPowerOf2=function(t){for(var e=32;e<t;)e<<=1;return e},t}(),Ji=function(){function t(){this._atlases=new Map}return t.prototype.begin=function(){this._atlases.forEach((function(t){t.begin()}))},t.prototype.end=function(){var t=this._atlases;t.forEach((function(e,n){e.end(),e.length<=0&&(e.destroy(),t.delete(n))}))},t.prototype.add=function(t,e,n){var i=this._atlases,r=i.get(t);if(null!=r)r.add(e,n);else{var o=new Zi(t);o.add(e,n),i.set(t,o)}},t.prototype.get=function(t){var e=this._atlases.get(t);return null!=e?e:null},t.prototype.update=function(t){var e=t.getBaseTexture();this._atlases.forEach((function(n){var i=n.id;if(n.update()){var r=t.get(i);if(null!=r){var o=n.width,s=n.height,a=e.resolution;r.frame.width=o,r.frame.height=s,r.width=o/a,r.height=s/a,t.toDirty()}else t.set(i,new Gi(n,e))}else t.contains(i)||t.set(i,new Gi(n,e))}))},t.prototype.destroy=function(){var t=this._atlases;t.forEach((function(t){t.destroy()})),t.clear()},t}(),Qi=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n/o.resolution,i/o.resolution,0,o)||this;return s.source=r,s}return F(e,t),e.prototype.render=function(t){var e=this.frame,n=e.x,i=e.y,r=e.width,o=e.height,s=this.source;s instanceof ImageData?(t.putImageData(s,n,i),t.putImageData(s,n-1,i,0,0,1,o),t.putImageData(s,n,i-1,0,0,r,1),t.putImageData(s,n+r,i,r-1,0,1,o),t.putImageData(s,n,i+o,0,o-1,r,1)):(t.drawImage(s,n,i,r,o),t.drawImage(s,0,0,1,o,n-1,i-1,1,o+2),t.drawImage(s,0,0,r,1,n,i-1,r,1),t.drawImage(s,r-1,0,1,o,n+r,i-1,1,o+2),t.drawImage(s,0,o-1,r,1,n,i+o,r,1))},e}(Ui),$i=function(t,e){this.texture=t,this.indexOffset=e},tr=function(){function t(){this.index=0,this.baseTexture=null,this.units=[]}return t.prototype.begin=function(){this.index=0,this.baseTexture=null},t.prototype.push=function(t,e){if(this.index<this.units.length){var n=this.units[this.index];n.texture=t,n.indexOffset=e}else this.units.push(new $i(t,e));this.index+=1},t.prototype.end=function(){this.units.length!==this.index&&(this.units.length=this.index)},t.prototype.destroy=function(){this.units.length=0},t}(),er=function(){function e(t,e){var n=3*t,i=n;this.vertices=new Float32Array(2*i),this._vertexCapacity=i,this._vertexCount=0,this._vertexBuffer=null,this.steps=new Float32Array(6*i),this._stepBuffer=null,this.colors=new Float32Array(3*i),this._colorBuffer=null,this.uvs=new Float32Array(2*i),this._uvBuffer=null;var r=i<=65535;this.indices=r?new Uint16Array(n):new Uint32Array(n),this._indexCapacity=t,this._indexCount=0,this.indexCountRequested=0,this._indexBuffer=null,this._renderer=e,this._builder=new tr,this._geometry=null}return e.prototype.updateVertices=function(){var t=this._vertexBuffer;t&&t.update()},e.prototype.updateSteps=function(){var t=this._stepBuffer;t&&t.update()},e.prototype.updateColors=function(){var t=this._colorBuffer;t&&t.update()},e.prototype.updateUvs=function(){var t=this._uvBuffer;t&&t.update()},e.prototype.updateIndices=function(){var t=this._indexBuffer;t&&t.update()},e.prototype.getGeometry=function(){var e=this._geometry;return null==e&&(this._vertexBuffer=new t.Buffer(this.vertices,!1,!1),this._stepBuffer=new t.Buffer(this.steps,!1,!1),this._colorBuffer=new t.Buffer(this.colors,!1,!1),this._uvBuffer=new t.Buffer(this.uvs,!1,!1),this._indexBuffer=new t.Buffer(this.indices,!1,!0),this._geometry=e=(new t.Geometry).addIndex(this._indexBuffer).addAttribute("aPosition",this._vertexBuffer,2).addAttribute("aStepA",this._stepBuffer,2).addAttribute("aStepB",this._stepBuffer,4).addAttribute("aColor",this._colorBuffer,3).addAttribute("aUv",this._uvBuffer,2)),e},e.prototype.upload=function(){this._renderer.geometry.bind(this.getGeometry())},e.prototype.render=function(e){var n=this._renderer;n.geometry.bind(this.getGeometry());var i=this._builder.units,r=i.length;if(0<r){for(var o=t.DRAW_MODES.TRIANGLES,s=null,a=i[0],u=0,l=3*a.indexOffset,h=0,c=t.Texture.WHITE,p=0,f=r-1;p<f;++p)s=a,u=l,h=(l=3*(a=i[p+1]).indexOffset)-u,c=s.texture||t.Texture.WHITE,0<h&&c.valid&&(e.uniforms.sampler=n.texture.bind(c),n.geometry.draw(o,h,u));h=3*this._indexCount-l,c=a.texture||t.Texture.WHITE,0<h&&c.valid&&(e.uniforms.sampler=n.texture.bind(c),n.geometry.draw(o,h,l))}},e.prototype.update=function(t,e,n){var o=this._builder;o.begin();for(var s=0,a=0,u=t.get();null!=u;u=t.next()){var l=u.uploaded;if(null==l){var h=r[u.type]||r[i.GROUP];if(null==h)break;var c=h(this,u,s,a,e);if(null==c)break;l=c}else if(!l.reinit(this,u,s,a))break;if(l.buildUnit(o),s+=l.getVertexCount(),a+=l.getIndexCount(),n){t.next();break}}return o.end(),this._vertexCount=s,this._indexCount=a,0<o.units.length},e.prototype.check=function(t,e,n,i){return this.indexCountRequested=i,t+n<=this._vertexCapacity&&e+i<=this._indexCapacity},e.prototype.destroy=function(){var t=this._geometry;t&&t.destroy(),this._builder.destroy()},e}(),nr=[],ir=function(){this.index=0,this.shapes=nr,this.current=null},rr=function(){function t(){this._index=-1,this._datum=new ir,this._data=[this._datum],this._current=null}return t.prototype.reset=function(t,e){this._index=0;var n=this._data[0];return n.index=-1,n.shapes=e,n.current=null,this._datum=n,null!=t?(this._current=t,t):this.next()},t.prototype.get=function(){return this._current},t.prototype.next=function(){for(;;){var t=this._datum,e=t.index+=1,n=t.shapes,i=e<n.length?t.current=n[e]:t.current=null;if(null==i)return r=this._index-=1,o=this._data,0<=r?(a=o[r],this._datum=a,this._current=a.current):this._current=null;var r,o,s=i.children;if(!(0<s.length))return this._current=i,i;if((r=this._index+=1)<(o=this._data).length)(a=o[r]).index=-1,a.shapes=s,a.current=null,this._datum=a;else{var a=new ir;o.push(a),a.index=-1,a.shapes=s,a.current=null,this._datum=a}}},t}(),or=function(e){function n(i){var r=e.call(this,i)||this;return n.SHADER=n.SHADER||t.Shader.from("\nattribute highp vec2 aPosition;\nattribute highp vec2 aStepA;\nattribute highp vec4 aStepB;\nattribute highp vec3 aColor;\nattribute highp vec2 aUv;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform mediump float shapeScale;\nuniform mediump float antialiasWeight;\n\nvarying mediump float vType;\nvarying mediump vec2 vStepA;\nvarying mediump vec4 vStepB;\nvarying mediump vec4 vLength;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nvec2 toInverse(in vec2 v) {\n\treturn vec2(-v.y, v.x);\n}\n\nvec4 toGeneral(in float v) {\n\tvec4 c = vec4(1.0, 1.0/64.0, 1.0/64.0/64.0, 1.0/64.0/64.0/64.0) * v;\n\tc -= fract(c);\n\tc -= c.yzwx * vec4(64.0, 64.0, 64.0, 0.0);\n\treturn c;\n}\n\nfloat toStrokeWidthScale(in float scale) {\n\treturn (\n\t\tscale == 3.0 || scale == 7.0 ?\n\t\tshapeScale : (\n\t\t\tscale == 1.0 || scale == 5.0 ?\n\t\t\tmin(1.0, shapeScale) : (\n\t\t\t\tscale == 2.0 || scale == 6.0 ?\n\t\t\t\tmax(1.0, shapeScale) : 1.0\n\t\t\t)\n\t\t)\n\t);\n}\n\nvec2 toUnpackedF2x1024(in float v) {\n\tvec2 c = vec2(1.0, 1.0/1024.0) * v;\n\tc -= fract(c);\n\tc -= c.yx * vec2(1024.0, 0.0);\n\tc /= vec2(1023.0, 1023.0);\n\treturn c;\n}\n\nvec3 toUnpackedF3x256(in float v) {\n\tvec3 c = vec3(1.0, 1.0/256.0, 1.0/256.0/256.0) * v;\n\tc -= fract(c);\n\tc -= c.yzx * vec3(256.0, 256.0, 0.0);\n\tc /= 255.0;\n\treturn c;\n}\n\nvec2 toPosition012(in vec2 v) {\n\treturn (projectionMatrix * translationMatrix * vec3(v, 1.0)).xy;\n}\n\nvec4 toStepB01(in vec4 sb) {\n\treturn vec4(sb.xy, toUnpackedF2x1024(sb.z));\n}\n\nvec4 toStepB2(in vec4 sb, in float strokeWidth) {\n\tfloat x = min(0.4, 0.4 / 12.0 * sb.x * antialiasWeight);\n\tfloat w = clamp(strokeWidth, 0.0, 1.0) * 0.4;\n\tfloat p = w * sb.y + sb.z;\n\tfloat y = 0.5 - p;\n\tfloat z = 0.5 - p - w;\n\treturn vec4(y, z, y - max(0.01, y - x), z - max(0.01, z - x));\n}\n\nvec2 toPosition3(in float type, in vec2 p, in float npacked, in float length, in float strokeWidth, out float shift) {\n\tvec3 t = vec3(1.0, 1.0/1024.0, 1.0/1024.0/1024.0) * npacked;\n\tt -= fract(t);\n\tt -= t.yzx * vec3(1024.0, 1024.0, 0.0);\n\tt *= vec3(1.0/511.5, 1.0/511.5, 1.0);\n\tt -= vec3(1.0, 1.0, 0.0);\n\tvec2 n0 = vec2(t.x, ((0.5 < t.z && t.z < 1.5) || 2.5 < t.z ? +1.0 : -1.0) * sqrt(max(0.0, 1.0 - t.x * t.x)));\n\tvec2 n1 = vec2(t.y, (1.5 < t.z ? +1.0 : -1.0) * sqrt(max(0.0, 1.0 - t.y * t.y)));\n\n\tvec2 n0i = toInverse(n0);\n\tvec2 n1i = toInverse(n1);\n\tfloat direction = sign(4.5 - type);\n\n\t// Offset\n\tfloat cross = dot(n0i, n1);\n\tbool bcross = 0.00001 < abs(cross);\n\tfloat crossi = (bcross ? 1.0 / cross : 0.0);\n\tfloat b = dot(n1 - n0, n0) * crossi;\n\tfloat offsetSize = direction * strokeWidth * 0.5;\n\tvec2 offset = n1 + n1i * b;\n\n\t// Miter\n\tvec2 pmiter = p + offsetSize * offset;\n\tfloat miterAngle0 = dot( n0i, offsetSize * offset - length * n0i );\n\tfloat miterAngle1 = dot( n1i, offsetSize * offset + length * n1i );\n\tfloat miterLength = dot( offset, offset );\n\tfloat miterSide = direction * cross;\n\n\t// Bevel\n\tvec2 n = (type == 4.0 || type == 6.0 ? n1 : n0);\n\tvec2 pbevel = p + offsetSize * n;\n\n\t//\n\tvec2 presult = (\n\t\t0.0 <= miterSide ?\n\t\t(miterAngle0 < 0.0 && 0.0 <= miterAngle1 && bcross ? pmiter : pbevel) :\n\t\t(miterLength < 6.0 && bcross ? pmiter : pbevel)\n\t);\n\tvec2 ni = (type == 4.0 || type == 6.0 ? n1i : n0i);\n\tshift = dot(ni, p - presult);\n\treturn toPosition012(presult);\n}\n\nvec2 toStepA3(in float type, in float strokeWidth) {\n\treturn vec2(type < 4.5 ? 1.0 : 0.0, strokeWidth);\n}\n\nfloat toDotWidth(in float strokeScaling, in float strokeWidthScale) {\n\treturn aStepA.x * (\n\t\tstrokeScaling == 4.0 || strokeScaling == 5.0 ||\n\t\tstrokeScaling == 6.0 || strokeScaling == 7.0 ?\n\t\tstrokeWidthScale : 1.0\n\t);\n}\n\nvec2 toDotPattern(in float dash) {\n\treturn (dash < 0.5 ?\n\t\tvec2(1.0, 0.0) :\n\t\t(dash < 3.5 ?\n\t\t\t(dash < 1.5 ?\n\t\t\t\tvec2(1.0, 1.0) :\n\t\t\t\t(2.5 < dash ?\n\t\t\t\t\tvec2(1.0, 2.0) :\n\t\t\t\t\tvec2(1.0, 0.5)\n\t\t\t\t)\n\t\t\t) :\n\t\t\t(dash < 4.5 ?\n\t\t\t\tvec2(2.0, 1.0) :\n\t\t\t\t(5.5 < dash ?\n\t\t\t\t\tvec2(2.0, 2.0) :\n\t\t\t\t\tvec2(2.0, 0.5)\n\t\t\t\t)\n\t\t\t)\n\t\t)\n\t);\n}\n\nvec4 toLength3(in float shift, in float dash, in float strokeScaling, in float strokeWidthScale) {\n\tfloat width = toDotWidth(strokeScaling, strokeWidthScale);\n\tvec2 pattern = toDotPattern(dash);\n\treturn vec4(aStepB.y + shift, pattern.x * width, pattern.y * width, aStepB.z);\n}\n\nvec4 toLength7(in float type, in float strokeScaling, in float strokeWidthScale) {\n\tfloat width = toDotWidth(strokeScaling, strokeWidthScale);\n\tvec2 pattern = toDotPattern(type - 7.0);\n\treturn vec4(aStepB.w, pattern.x * width, pattern.y * width, -1.0);\n}\n\nvoid toColors(in vec3 source, out vec4 fillColor, out vec4 strokeColor) {\n\tvec2 a = toUnpackedF2x1024(source.z);\n\tfillColor.xyz = toUnpackedF3x256(source.x).zyx * a.x;\n\tfillColor.w = a.x;\n\tstrokeColor.xyz = toUnpackedF3x256(source.y).zyx * a.y;\n\tstrokeColor.w = a.y;\n}\n\nvoid main(void) {\n\tvec4 general = toGeneral(aStepA.y);\n\tfloat type = general.x;\n\tfloat strokeScaling = general.y;\n\tfloat strokeWidthScale = toStrokeWidthScale(strokeScaling);\n\tfloat strokeWidth = strokeWidthScale * aStepA.x;\n\n\tvType = type;\n\tif (type < 2.5 || 6.5 < type) {\n\t\tgl_Position = vec4(toPosition012(aPosition), 0.0, 1.0);\n\t\tvStepA = strokeWidth * general.zw;\n\t\tif (type < 1.5) {\n\t\t\tvStepB = toStepB01(aStepB);\n\t\t\tvLength = vec4(-1.0, 0.0, 0.0, -1.0);\n\t\t} else if (type < 2.5) {\n\t\t\tvStepB = toStepB2(aStepB, strokeWidth);\n\t\t\tvLength = vec4(-1.0, 0.0, 0.0, -1.0);\n\t\t} else {\n\t\t\tvStepB = toStepB01(aStepB);\n\t\t\tvLength = toLength7(type, strokeScaling, strokeWidthScale);\n\t\t}\n\t} else {\n\t\tfloat shift3 = 0.0;\n\t\tgl_Position = vec4(toPosition3(type, aPosition, aStepB.x, aStepB.w, strokeWidth, shift3), 0.0, 1.0);\n\t\tvStepA = toStepA3(type, strokeWidth);\n\t\tvStepB = vec4(0.0);\n\t\tvLength = toLength3(shift3, general.z, strokeScaling, strokeWidthScale);\n\t}\n\ttoColors(aColor, vColorFill, vColorStroke);\n\tvUv = aUv;\n}","\nvarying mediump float vType;\nvarying mediump vec2 vStepA;\nvarying mediump vec4 vStepB;\nvarying mediump vec4 vLength;\nvarying mediump vec4 vColorFill;\nvarying mediump vec4 vColorStroke;\nvarying mediump vec2 vUv;\n\nuniform sampler2D sampler;\nuniform mediump float antialiasWeight;\n\nvec4 toColor0(in vec4 texture) {\n\tvec2 f = vec2(1.0) / vStepB.xy;\n\tvec2 c = vStepB.zw;\n\tvec2 awd = antialiasWeight * f;\n\tvec2 swd = vStepA * f;\n\tvec2 one = vec2(1.0);\n\tvec2 zero = vec2(0.0);\n\tvec2 p0 = clamp(one - awd, zero, one);\n\tvec2 p1 = clamp(one - swd, zero, one);\n\tvec2 p2 = clamp(one - swd - awd, zero, one);\n\tvec2 s0 = smoothstep(p0, one, c);\n\tvec2 s1 = smoothstep(p2, p1, c);\n\tfloat s2 = max(s0.x, s0.y);\n\tfloat s3 = max(s1.x, s1.y);\n\n\treturn texture * (\n\t\tvColorStroke * (s3 - s2) +\n\t\tvColorFill * (1.0 - s3)\n\t);\n}\n\nvec4 toColor1(in vec4 texture) {\n\tvec2 d = vStepB.xy;\n\tvec2 c = vStepB.zw;\n\tvec2 awd = antialiasWeight / d;\n\tvec2 swd = vStepA / d;\n\tvec2 one = vec2(1.0);\n\tvec2 zero = vec2(0.0);\n\tfloat s0 = smoothstep(length(c), length(c/clamp(one - awd, zero, one)), 1.0);\n\tfloat s1 = smoothstep(length(c/clamp(one - swd, zero, one)), length(c/clamp(one - swd - awd, zero, one)), 1.0);\n\treturn texture * (\n\t\tvColorStroke * (s0 - s1) +\n\t\tvColorFill * s1\n\t);\n}\n\nvec4 toColor2(in vec4 texture) {\n\tvec2 p0 = vStepB.xy;\n\tvec2 p1 = vStepB.zw;\n\tvec2 d = vec2(dot(texture, vec4(1.0, 1.0/255.0, 1.0/255.0/255.0, 0.0)));\n\tvec2 s = smoothstep(p0 - p1, p0 + p1, d);\n\treturn vColorStroke * (s.y - s.x) + vColorFill * s.x;\n}\n\nfloat toLineStep(in vec4 parameters) {\n\tfloat l = parameters.x;\n\tfloat lp0 = parameters.y;\n\tfloat lp1 = parameters.z;\n\tfloat lt = parameters.w;\n\tfloat ld = antialiasWeight;\n\tfloat lm = mod(l, lp0 + lp1);\n\tfloat s0 = (0.0 < lp1 ? smoothstep(0.0, ld, lm) - smoothstep(lp0, lp0 + ld, lm) : 1.0);\n\tfloat s1 = (0.0 <= lt ? smoothstep(0.0, ld, l) - smoothstep(lt - ld, lt, l) : 1.0);\n\treturn s0 * s1;\n}\n\nvec4 toColor3(in vec4 texture) {\n\tfloat c = vStepA.x;\n\tfloat awd = antialiasWeight / vStepA.y;\n\tfloat p0 = clamp(awd, 0.0, 1.0);\n\tfloat p1 = clamp(1.0 - awd, 0.0, 1.0);\n\tfloat s0 = smoothstep(0.0, p0, c);\n\tfloat s1 = smoothstep(p1, 1.0, c);\n\treturn texture * vColorStroke * (s0 - s1) * toLineStep(vLength);\n}\n\nvec4 toColor7(in vec4 texture) {\n\tfloat awd = antialiasWeight * vStepB.x;\n\tfloat swd = vStepA.x * vStepB.x;\n\tfloat p0 = clamp(1.0 - awd, 0.0, 1.0);\n\tfloat p1 = clamp(1.0 - swd, 0.0, 1.0);\n\tfloat p2 = clamp(1.0 - swd - awd, 0.0, 1.0);\n\tfloat s0 = smoothstep(p0, 1.0, vStepB.z);\n\tfloat s1 = smoothstep(p2, p1, vStepB.z) * toLineStep(vLength);\n\tfloat s2 = smoothstep(-antialiasWeight, 0.0, vStepB.y);\n\treturn texture * (\n\t\tvColorStroke * (s1 - s0) +\n\t\tvColorFill * (1.0 - s1) * s2\n\t);\n}\n\nvoid main(void) {\n\tvec4 texture = texture2D(sampler, vUv);\n\tif (vType < 0.5) {\n\t\tgl_FragColor = toColor0(texture);\n\t} else if (vType < 1.5) {\n\t\tgl_FragColor = toColor1(texture);\n\t} else if (vType < 2.5) {\n\t\tgl_FragColor = toColor2(texture);\n\t} else if (vType < 6.5) {\n\t\tgl_FragColor = toColor3(texture);\n\t} else {\n\t\tgl_FragColor = toColor7(texture);\n\t}\n}"),r._shader=n.SHADER,r._iterator=new rr,r._bufferSizeMax=r.getBufferSizeMax(i),r}return F(n,e),n.prototype.getBufferSizeMax=function(t){var e=t.context,n=e.extensions;return 1<e.webGLVersion||n.uint32ElementIndex?1431655765:21845},n.prototype.updateAtlas=function(t,e,n,i,r){var o=t.image;if(null!=o){var s=e.get(o.url);if(null!=s)t.texture=s.texture;else{var a=new Qi(o.url,o.width,o.height,o.source,r);t.texture=a.texture,e.set(a.id,a)}}else t.texture=i;var u=t.text,l=u.characters;0<l.length&&n.add(u.family,l,u.nacharacters)},n.prototype.updateAtlases=function(t,e,n,i,r){for(var o=0,s=t.length;o<s;++o){var a=t[o];this.updateAtlas(a,e,n,i,r);for(var u=a.children,l=0,h=u.length;l<h;++l){var c=u[l];this.updateAtlas(c,e,n,i,r),this.updateAtlases(c.children,e,n,i,r)}}},n.prototype.updateFontAtlas=function(t,e,n,i){var r=t.text,o=n.get(r.family);if(null!=o){var s=e.get(o.id);null!=s?(r.atlas=o,r.texture=s.texture):(r.atlas=void 0,r.texture=i)}else r.atlas=void 0,r.texture=i},n.prototype.updateFontAtlases=function(t,e,n,i){for(var r=0,o=t.length;r<o;++r){var s=t[r];this.updateFontAtlas(s,e,n,i);for(var a=s.children,u=0,l=a.length;u<l;++u){var h=a[u];this.updateFontAtlas(h,e,n,i),this.updateFontAtlases(h.children,e,n,i)}}},n.prototype.render_=function(e,n,i,r){var o=this.renderer,s=this._shader;if(null!=s&&(null!=n||0<i.length)){var a=o.resolution,u=e.getBuffers(),l=e.toAntialiasWeight(a);if(r){var h=e.getAtlas(a),c=e.getFontAtlases();h.begin(),c.begin();var p=h.getDefaultTexture(),f=h.getBaseTexture();this.updateAtlases(i,h,c,p,f),c.end(),c.update(h),this.updateFontAtlases(i,h,c,p),h.end(),h.repack(),this.updateBuffers(n,i,u,o,l)}s.uniforms.shapeScale=e.toShapeScale(),s.uniforms.antialiasWeight=e.toPixelScale(a)*l,s.uniforms.translationMatrix=e.worldTransform.toArray(!0),o.shader.bind(s,!1),o.state.setBlendMode(t.utils.correctBlendMode(t.BLEND_MODES.NORMAL,!0));var d=u.length;if(1<d)for(var y=0;y<d;++y)u[y].upload();for(y=0;y<d;++y)u[y].render(s)}},n.prototype.updateBuffers=function(t,e,n,i,r){var o=this._iterator;o.reset(t,e);for(var s=0,a=0,u=5e3,l=this._bufferSizeMax;null!=o.get();){var h=null,c=!1;if(0<a?(h=new er(a,i),n.splice(s,0,h),c=!0):s<n.length?(h=n[s],c=!1):(h=new er(u,i),n.push(h),c=!1),h.update(o,r,c))a=0,s+=1;else{if(!((a=h.indexCountRequested)<=l))break;a=Math.ceil(a/u)*u,a=Math.min(a,l)}}if(s<n.length){for(var p=s,f=n.length;p<f;++p)n[p].destroy();n.length=s}},n.SHADER=null,n}(t.ObjectRenderer),sr=function(e){function n(){var n=e.call(this)||this;return n._shapeRenderer=null,n.children=[],n._shape=null,n._childrenId=0,n._childrenIdRendered=-1,n._atlas=null,n._fontAtlases=new Ji,n._pixelScale=1,n._pixelScaleId=-2,n._shapeScale=1,n._shapeScaleId=-1,n._work=new t.Point,n._buffers=[],n}return F(n,e),n.prototype.calculateBounds=function(){this._bounds.clear()},n.prototype.onChildTransformChange=function(){},n.prototype.toDirty=function(){return this._childrenId+=1},n.prototype.isDirty=function(){return this._childrenIdRendered<this._childrenId},n.prototype.render=function(t){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable){var e=this._childrenId,n=this._childrenIdRendered;this._childrenIdRendered=e;var i=n<e,r=this._shapeRenderer;null==r&&(r=this._shapeRenderer=new or(t)),t.batch.setObjectRenderer(r);var o=this.mask,s=this._shape,a=this.children;o?(t.mask.push(this,o),r.render_(this,s,a,i),t.mask.pop(this)):r.render_(this,s,a,i)}},n.prototype.containsPoint=function(t){return!1},n.prototype.getFontAtlases=function(){return this._fontAtlases},n.prototype.getAtlas=function(t){var e=this._atlas;return null==e&&(e=new Hi(t),this._atlas=e),e},n.prototype.getBuffers=function(){return this._buffers},n.prototype.toShapeScale=function(){this.updateTransform();var t=this.transform,e=t._worldID;if(e!==this._shapeScaleId){this._shapeScaleId=e;var n=t.worldTransform,i=n.a,r=n.b;this._shapeScale=1/Math.sqrt(i*i+r*r)}return this._shapeScale},n.prototype.getShapeScale=function(){return this._shapeScale},n.prototype.toPixelScale=function(t){var e=this.toShapeScale(),n=this._shapeScaleId;return this._pixelScaleId!==n&&(this._pixelScaleId=n,this._pixelScale=1/t*e),this._pixelScale},n.prototype.getPixelScale=function(){return this._pixelScale},n.prototype.toAntialiasWeight=function(t){return 1.25/t},n.prototype.hitTest=function(t,e){for(var n=this._work,i=this.children,r=i.length-1;0<=r;--r){var o=i[r];if(o.visible){o.toLocal(t,void 0,n);var s=o.contains(n.x,n.y);if(null!=s&&(null==e||e(s)))return s}}return null},n.prototype.hitTestBBox=function(t,e){for(var n=this._work,i=this.children,r=i.length-1;0<=r;--r){var o=i[r];if(o.visible&&(o.toLocal(t,void 0,n),o.containsBBox(n.x,n.y)&&(null==e||e(o))))return o}return null},n.prototype.destroy=function(){var t=this._buffers;if(null!=t)for(var n=0,i=t.length;n<i;++n)t[n].destroy();this._buffers.length=0;var r=this.children;for(n=r.length-1;0<=n;--n)r[n].destroy();r.length=0;var o=this._atlas;null!=o&&o.destroy(),this._fontAtlases.destroy(),e.prototype.destroy.call(this)},n}(t.DisplayObject),ar=function(t){function e(e,n,r,o){void 0===o&&(o=i.EMBEDDED_LAYER);var s=t.call(this,n,r,o)||this;return s._name=e,s}return F(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.newGroupFill=function(){return new st(this,!1,16777215,1,J.BOTTOM,1)},e.prototype.isGroupSizeFittable=function(){return!1},e.prototype.newGroupSize=function(t,e){var n=rt.SIZE_X,i=rt.SIZE_Y;return new Jn(this,n,i,n,i)},e.prototype.clone=function(){for(var t=this.newClone().copy(this),e=this.children,n=0,i=e.length;n<i;++n){var r=e[n].clone();r.parent=t,t.children.push(r)}zi.move(this,t),t.onChildTransformChange(),t.toDirty();var o=this.size;if(o instanceof Jn){var s=o.base;t.size.set(s.x,s.y).init().set(o.x,o.y)}else t.size.init();return t},e.prototype.newClone=function(){return new(0,this.constructor)(this._name,this._mode,this._depth,this.type)},e.prototype.serializeChildren=function(t){return[]},e.prototype.serializeImage=function(t){return-1},e.prototype.serializeGradient=function(t){return-1},e}(ti),ur=function(){function t(){}return t.toLayers=function(t,e){var n=[],i=this.toLayer(t);if(i){var r=i.parent;if(r)for(var o=r.children,s=o.length,a=0,u=e.length;a<u;++a){var l=e[a];0<=l&&l<s&&n.push(o[l])}}return n},t.toLayer=function(t){for(var e=t.parent;null!=e;){if(e instanceof sr)return e;if(e instanceof ar)return e;e=e.parent}return null},t.show=function(t){return!t.visible&&(t.visible=!0,!0)},t.showAll=function(t){for(var e=!1,n=0,i=t.length;n<i;++n){var r=t[n];r.visible||(r.visible=!0,e=!0)}return e},t.hide=function(t){return!!t.visible&&(t.visible=!1,!0)},t.hideAll=function(t){for(var e=!1,n=0,i=t.length;n<i;++n){var r=t[n];r.visible&&(r.visible=!1,e=!0)}return e},t.bringToFront=function(t){var e=t.parent;return!!e&&this.doBringToFront(t,e.children,0)},t.bringAllToFront=function(t){var e=t.length;if(0<e){var n=t[0].parent;if(n){for(var i=!1,r=n.children,o=0;o<e;++o){var s=t[e-1-o];this.doBringToFront(s,r,o)&&(i=!0)}return i}}return!1},t.doBringToFront=function(t,e,n){for(var i=e.length-1-n,r=i;0<=r;--r){var o=e[r];if(o===t){if(r!==i){for(var s=r+1;s<=i;++s)e[s-1]=e[s];return e[i]=o,!0}return!1}}return!1},t}(),lr={NONE:0,CTRL:1,SHIFT:2,ALT:4,AND:8,OR:16,NOT_NONE:23},hr=function(){function t(){}return t.from=function(t){var e="data"in t?t.data.originalEvent:t;return(e.ctrlKey?lr.CTRL:lr.NONE)|(e.altKey?lr.ALT:lr.NONE)|(e.shiftKey?lr.SHIFT:lr.NONE)},t.match=function(e,n){return n&lr.OR?!!(t.from(e)&n):t.from(e)===n},t}(),cr=function(){function t(){}return Object.defineProperty(t,"touchable",{get:function(){return"ontouchstart"in document},enumerable:!1,configurable:!0}),Object.defineProperty(t,"tap",{get:function(){return"pointertap"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"down",{get:function(){return"pointerdown"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"enter",{get:function(){return"pointerenter"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"leave",{get:function(){return"pointerleave"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"move",{get:function(){return"pointermove"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"out",{get:function(){return"pointerout"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"over",{get:function(){return"pointerover"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"up",{get:function(){return"pointerup"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"upoutside",{get:function(){return"pointerupoutside"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"cancel",{get:function(){return"pointercancel"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"righttap",{get:function(){return"rightclick"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"rightdown",{get:function(){return"rightdown"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"rightup",{get:function(){return"rightup"},enumerable:!1,configurable:!0}),Object.defineProperty(t,"rightupoutside",{get:function(){return"rightupoutside"},enumerable:!1,configurable:!0}),t.toGlobal=function(t,e,n){if("touches"in t){var i=t.changedTouches,r=i[i.length-1];null!=r?e.mapPositionToPoint(n,r.clientX,r.clientY):e.mapPositionToPoint(n,0,0)}else e.mapPositionToPoint(n,t.clientX,t.clientY);return n},t.onDblClick=function(t,e){var n=this;if(t.addEventListener("dblclick",(function(t){return e(t,!1)})),this.touchable){var i=0,r=0,o=0,s=0;t.addEventListener("touchstart",(function(t){if(0===i||2===i){var e=t.touches,n=e.length;if(n<=0)i=0;else{var s=e.item(n-1);null!=s?(i+=1,r=s.clientX,o=s.clientY):i=0}}else i=0})),t.addEventListener("touchend",(function(t){if(1===i||3===i){var a=t.changedTouches,u=a.length;if(u<=0)i=0;else{var l=a[u-1];if(null!=l){var h=r-l.clientX,c=o-l.clientY;n.CLICK_DISTANCE_THRESHOLD<=Math.abs(h)+Math.abs(c)?i=0:1===i?(s=t.timeStamp,i=2):t.timeStamp-s<n.DBLCLICK_INTERVAL_THRESHOLD?(i=0,e(t,!0)):(s=t.timeStamp,i=2)}else i=0}}else i=0})),t.addEventListener("touchcancel",(function(){i=0}))}},t.contains=function(t,e){for(var n=e;null!=n&&n!==t;)n=n.parent;return n===t},t.CLICK_DISTANCE_THRESHOLD=10,t.DBLCLICK_INTERVAL_THRESHOLD=333,t.LONG_CLICK_THRESHOLD=750,t}(),pr=function(){function e(){this.pointers=new Map,this.center=new t.Point,this.scale=0,this.time=0,this.distance=0}return e.prototype.start=function(t){var e=t.data.originalEvent;"pointerId"in e&&this.pointers.set(e.pointerId,e),this.doUpdate(t)},e.prototype.isUpdatable=function(t){var e=t.data.originalEvent;return!("pointerId"in e)||this.pointers.has(e.pointerId)},e.prototype.update=function(t){var e=t.data.originalEvent;"pointerId"in e&&this.pointers.set(e.pointerId,e),this.doUpdate(t)},e.prototype.end=function(t){var e=!0,n=t.data.originalEvent;if("touches"in n)e=n.touches.length<=0;else if("pointerId"in n){var i=this.pointers;i.delete(n.pointerId),e=i.size<=0}return this.doUpdate(t),e},e.prototype.bind=function(t){var e=this.interactionManager;if(e){var n=this.onMove;n&&e.on(cr.move,n);var i=this.onEnd;i&&(e.on(cr.up,i),e.on(cr.upoutside,i),e.on(cr.cancel,i))}},e.prototype.unbind=function(){var t=this.interactionManager;if(t){var e=this.onMove;e&&t.off(cr.move,e);var n=this.onEnd;n&&(t.off(cr.up,n),t.off(cr.upoutside,n),t.off(cr.cancel,n))}},e.prototype.doUpdate=function(t){var e=this.interactionManager,n=this.center,i=t.data.originalEvent;if(this.scale=0,this.time=i.timeStamp,"touches"in i){var r=i.touches,o=r.length;if(0<o){for(var s=0,a=0,u=0,l=r.length;u<l;++u)s+=(c=r[u]).clientX,a+=c.clientY;if(s/=o,a/=o,e?e.mapPositionToPoint(n,s,a):n.set(s,a),1<o){var h=0;for(u=1,l=r.length;u<l;++u){var c,p=(c=r[u]).clientX-s,f=c.clientY-a;h=Math.max(h,p*p+f*f)}this.scale=Math.sqrt(h)}}}else if("pointerId"in i){var d=this.pointers,y=d.size;if(0<y){var g=0,v=0;if(d.forEach((function(t){g+=t.clientX,v+=t.clientY})),g/=y,v/=y,e?e.mapPositionToPoint(n,g,v):n.set(g,v),1<y){var _=0;d.forEach((function(t){var e=t.clientX-g,n=t.clientY-v;_=Math.max(_,e*e+n*n)})),this.scale=Math.sqrt(_)}}}else n.copyFrom(t.data.global)},e}(),fr=function(){function t(){}return t.LINEAR=function(t){return t},t.ELASTIC=function(t){return t*(3*(1-t)*(1-t)+t*(3*(1-t)+t))},t.QUAD_IN_OUT=function(t){return t<.5?2*t*t:(4-2*t)*t-1},t}(),dr=function(t){function e(e){var n,i,r,o=t.call(this)||this;o._id=null,o._target=null!==(n=null==e?void 0:e.target)&&void 0!==n?n:null,o._startTime=0,o._duration=null!==(i=null==e?void 0:e.duration)&&void 0!==i?i:200,o._durationInverse=1/Math.max(1,o._duration),o._reverse=!1,o._onTime=null==e?void 0:e.onTime,o._onTimeBaseBound=function(){o.onTimeBase()},o._onStart=null==e?void 0:e.onStart,o._onEnd=null==e?void 0:e.onEnd,o._onStop=null==e?void 0:e.onStop,o._timing=null!==(r=null==e?void 0:e.timing)&&void 0!==r?r:fr.ELASTIC;var s=null==e?void 0:e.on;if(s)for(var a in s){var u=s[a];u&&o.on(a,u)}return o}return F(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return this._duration},set:function(t){this._duration=t,this._durationInverse=1/Math.max(1,t)},enumerable:!1,configurable:!0}),e.prototype.start=function(t){void 0===t&&(t=!1),this.stop(),this._startTime=Date.now(),this._reverse=t,this._id=window.setTimeout(this._onTimeBaseBound,0),this.onStart(t);var e=this._duration,n=this.toTime(t?e:0);this.onTime(n,t,0)},e.prototype.onStart=function(t){var e=this._onStart;null!=e&&e(t,this),this.emit("start",t,this)},e.prototype.onTime=function(t,e,n){var i=this._onTime;null!=i&&i(t,e,n,this),this.emit("time",t,e,n,this)},e.prototype.onEnd=function(t){var e=this._onEnd;null!=e&&e(t,this),this.emit("end",t,this)},e.prototype.onStop=function(t){var e=this._onStop;null!=e&&e(t,this),this.emit("stop",t,this)},e.prototype.isStarted=function(){return null!=this._id},e.prototype.isReverse=function(){return this._reverse},e.prototype.onTimeBase=function(){if(null!=this._id){this._id=null;var t=Date.now()-this._startTime,e=this._duration,n=this._reverse;if(t<e){this._id=window.setTimeout(this._onTimeBaseBound,0);var i=this.toTime(n?e-t:t);this.onTime(i,n,t)}else i=this.toTime(n?0:e),this.onTime(i,n,t),this.onEnd(n)}},e.prototype.toTime=function(t){return this._timing(t*this._durationInverse,this)},e.prototype.stop=function(){var t=this._id;null!=t&&(this._id=null,window.clearTimeout(t),this.onStop(this._reverse))},e.prototype.end=function(){var t=this._id;if(null!=t){this._id=null,window.clearTimeout(t);var e=this._reverse,n=Date.now()-this._startTime,i=this._duration,r=this.toTime(e?0:i);this.onTime(r,e,n),this.onEnd(e)}},e}(t.utils.EventEmitter),yr=function(){function t(t,e,n,i){this.dx=t,this.dy=e,this.ds=n,this.dt=i}return t.prototype.set=function(t,e,n,i){this.dx=t,this.dy=e,this.ds=n,this.dt=i},t}(),gr=function(){function t(t,e,n){var i,r=this;this._histories=[],this._historiesSorted=[],this._historyBegin=0,this._historyEnd=-1,this._dx=0,this._dy=0,this._ds=0,this._dt=0,this._dtw=0,this._t=0,this._duration=333*(null!==(i=null==n?void 0:n.duration)&&void 0!==i?i:1),this._animation=new dr({onTime:function(t){r.onEase(t)},onEnd:function(){r.onEaseEnd()},timing:fr.LINEAR,duration:this._duration}),this._onMove=t,this._onEnd=e}return t.prototype.onStart=function(){for(var e=this._histories,n=e.length,i=t.HISTORY_CAPACITY;n<i;++n)e.push(new yr(0,0,1,0));this._historyBegin=0,this._historyEnd=-1,this._animation.stop()},t.prototype.onMove=function(e,n,i,r){var o=t.HISTORY_CAPACITY,s=this._historyEnd,a=(s+1)%o;this._historyEnd=a;var u=this._historyBegin;(a<s||0<=s&&s<u)&&(this._historyBegin=(u+1)%o),this._histories[a].set(e,n,i,r)},t.prototype.updateHistoriesSorted=function(t){var e=this._histories,n=this._historiesSorted,i=this._historyBegin,r=this._historyEnd,o=e.length;if(r<0)return n.length=0,t;if(r<i){var s=t;n.length=0;for(var a=r;0<=a;--a){var u=e[a];if(!(s+u.dt<160))return s;s+=u.dt,n.push(u)}for(a=o-1;i<=a;--a){var l=e[a];if(!(s+l.dt<160))return s;s+=l.dt,n.push(l)}return s}for(s=t,n.length=0,a=r;i<=a;--a){var h=e[a];if(!(s+h.dt<160))return s;s+=h.dt,n.push(h)}return s},t.prototype.onEnd=function(t){var e=this._duration,n=e-t;if(n<=0)return this.onEaseEnd();this.updateHistoriesSorted(t);var i=this._historiesSorted,r=i.length;if(r<=0)return this.onEaseEnd();for(var o=0,s=0,a=0,u=0,l=0;l<r;++l){var h=i[l];o+=h.dx,s+=h.dy,a+=h.ds,u+=h.dt}if(u<=0)return this.onEaseEnd();var c=1/r;o*=c,s*=c,a*=c,u*=c*(e/n),this._dx=o,this._dy=s,this._ds=a,this._dt=u;var p=this._animation;p.duration=n,this._t=0,this._dtw=n/u,p.start()},t.prototype.onEase=function(t){var e=this._t;this._t=t;var n=(1-.5*(t+e))*(t-e)*this._dtw;this._onMove(this._dx*n,this._dy*n,1+(this._ds-1)*n,t)},t.prototype.onEaseEnd=function(){this._onEnd()},t.prototype.stop=function(){this._animation.stop()},t.HISTORY_CAPACITY=5,t}(),vr=function(){function t(t,e){null!=t&&(this._onTap=t.tap,this._onLongPress=t.longpress),this._threshold=this.toThreshold(e),this._unused=[],this._used=new Map}return t.prototype.toThreshold=function(t){var e,n;if(null!=t){var i=t.threshold;if(null!=i)return{distance:null!==(e=i.distance)&&void 0!==e?e:10,long:null!==(n=i.long)&&void 0!==n?n:500}}return{distance:10,long:500}},t.prototype.newData=function(t){var e=this._used,n=e.get(t);if(null!=n)return n;var i=this._unused.pop();if(null!=i)return e.set(t,i),i;var r=new pr;return r.easing=void 0,r.onMove=this.newOnMove(r),r.onEnd=this.newOnEnd(r),e.set(t,r),r},t.prototype.deleteData=function(t){var e=t.target;if(e&&this._used.delete(e)){var n=t.timeoutId;null!=n&&(t.timeoutId=void 0,window.clearTimeout(n)),t.target=void 0,t.pointers.clear(),this._unused.push(t)}},t.prototype.newOnMove=function(t){var e=this;return function(n){e.onMove(n,t)}},t.prototype.newOnEnd=function(t){var e=this;return function(n){e.onEnd(n,t)}},t.prototype.onDown=function(t,e){var n;if(null!=this._onTap||null!=this._onLongPress){var i=ft.getLayer(t);if(null!=i)if(e.stopPropagation(),t.state.isGesturing)null===(n=this._used.get(t))||void 0===n||n.start(e);else{var r=this.newData(t);r.target=t,r.distance=0,t.state.isGesturing=!0;var o=i.renderer.plugins.interaction;r.interactionManager=o,r.start(e),r.bind(e),this.start(t,r,e)}}},t.prototype.onMove=function(t,e){var n=e.target;if(null!=n&&n.state.isGesturing&&e.isUpdatable(t)){var i=e.center,r=i.x,o=i.y;e.update(t);var s=i.x-r,a=i.y-o;e.distance+=Math.abs(s)+Math.abs(a)}},t.prototype.onEnd=function(t,e){var n=e.target;if(null!=n&&n.state.isGesturing&&e.end(t)){n.state.isGesturing=!1;var i=e.interactionManager;if(e.interactionManager=void 0,i){var r=e.onMove;r&&i.off(cr.move,r);var o=e.onEnd;o&&(i.off(cr.up,o),i.off(cr.cancel,o))}this.end(n,e,t),this.deleteData(e)}},t.prototype.onLongPress=function(t,e,n){if(e.timeoutId=void 0,e.distance<this._threshold.distance){e.distance=this._threshold.distance;var i=this._onLongPress;null!=i&&i(t,n)}},t.prototype.start=function(t,e,n){var i=this,r=this._threshold.long;0<=r&&(e.timeoutId=window.setTimeout((function(){i.onLongPress(t,e,n)}),r))},t.prototype.end=function(t,e,n){var i=e.timeoutId;if(null!=i&&(e.timeoutId=void 0,window.clearTimeout(i)),e.distance<this._threshold.distance){var r=this._onTap;r&&r(t,n)}},t.prototype.stop=function(t){var e=this._used.get(t);null!=e&&this.deleteData(e)},t}(),_r=function(){function t(t){var e,n,i,r=t.on;if(r){this._onStart=r.start,this._onMove=r.move,this._onEnd=r.end,this._onStop=r.stop;var o=r.easing;null!=o&&(this._onEasingStart=o.start,this._onEasingEnd=o.end)}this._modifier=null!==(e=null==t?void 0:t.modifier)&&void 0!==e?e:lr.NONE;var s=t.checker,a=hr.match;this._checkerStart=null!==(n=null==s?void 0:s.start)&&void 0!==n?n:a,this._checkerMove=null!==(i=null==s?void 0:s.move)&&void 0!==i?i:a,this._easing=t.easing,this._touch=!!t.touch,this._unused=[],this._used=new Map,this._tap=new vr(t.on,t.tap);var u=t.bind;null!=u&&this.bind(u)}return t.prototype.newData=function(t){var e=this._used,n=e.get(t);if(null!=n)return n;var i=this._unused.pop();if(null!=i)return e.set(t,i),i;var r=new pr;return r.easing=this.newEasing(r),r.onMove=this.newOnMove(r),r.onEnd=this.newOnEnd(r),e.set(t,r),r},t.prototype.newEasing=function(t){var e=this,n=this._easing;if(null==n||!1!==n)return new gr((function(n,i,r,o){e.onEasingMove(n,i,r,o,t)}),(function(){e.onEasingEnd(t)}),this.toEasingOptions(n))},t.prototype.toEasingOptions=function(t){return null==t||!0===t?void 0:t},t.prototype.deleteData=function(t){var e=t.target;e&&this._used.delete(e)&&(t.target=void 0,t.pointers.clear(),this._unused.push(t))},t.prototype.bind=function(t){var e=this;return t.on(cr.down,(function(n){e.onDown(t,n)})),this},t.prototype.isTouch=function(t){var e=t.data.originalEvent;return"touches"in e||"pointerId"in e&&"mouse"!==e.pointerType},t.prototype.onDown=function(t,e){var n;if(!this._touch||this.isTouch(e)){if(!this._checkerStart(e,this._modifier,t))return this._tap.onDown(t,e);var i=ft.getLayer(t);if(null!=i)if(e.stopPropagation(),t.state.isGesturing)null===(n=this._used.get(t))||void 0===n||n.start(e);else{var r=this._onStart;null!=r&&r(t);var o=this.newData(t);o.target=t,o.distance=0,t.state.isGesturing=!0;var s=i.renderer.plugins.interaction;o.interactionManager=s,o.start(e);var a=o.easing;a&&a.onStart(),o.bind(e),this._tap.start(t,o,e)}}},t.prototype.newOnMove=function(t){var e=this;return function(n){e.onMove(n,t)}},t.prototype.newOnEnd=function(t){var e=this;return function(n){e.onEnd(n,t)}},t.prototype.onMove=function(t,e){var n=e.target;if(null!=n&&n.state.isGesturing&&e.isUpdatable(t)&&this._checkerMove(t,this._modifier,n)){var i=e.center,r=i.x,o=i.y,s=e.scale,a=e.time;e.update(t);var u=i.x,l=i.y,h=e.scale,c=u-r,p=l-o,f=e.time-a,d=1e-5,y=d<s&&d<h?h/s:1;e.distance+=Math.abs(c)+Math.abs(p);var g=e.easing;g&&g.onMove(c,p,y,f);var v=this._onMove;null!=v&&(0===c&&0===p&&1===y||v(n,c,p,u,l,y))}},t.prototype.onEnd=function(t,e){var n=e.target;if(null!=n&&n.state.isGesturing){var i=e.time;if(e.end(t)){n.state.isGesturing=!1;var r=e.interactionManager;if(e.interactionManager=void 0,r){var o=e.onMove;o&&r.off(cr.move,o);var s=e.onEnd;s&&(r.off(cr.up,s),r.off(cr.cancel,s))}var a=this._onEnd;null!=a&&a(n),this._tap.end(n,e,t);var u=this._onEasingStart;u&&u(e.target);var l=e.easing;if(l)l.onEnd(e.time-i);else{this.deleteData(e);var h=this._onEasingEnd;h&&h(e.target)}}}},t.prototype.onEasingMove=function(t,e,n,i,r){var o=r.target;if(null!=o){var s=this._onMove;if(null!=s&&(0!==t||0!==e||1!==n)){var a=r.center,u=a.x+t,l=a.y+e;a.set(u,l),s(o,t,e,u,l,n)}}},t.prototype.onEasingEnd=function(t){var e=t.target;if(this.deleteData(t),null!=e){var n=this._onEasingEnd;n&&n(e)}},t.prototype.stop=function(t){this._tap.stop(t);var e=this._used.get(t);if(null!=e){var n=e.easing;null!=n&&n.stop(),this.deleteData(e);var i=this._onStop;i&&i(t)}},t}(),mr={NONE:0,DRAG:1,PINCH:2,ALL:3},br=function(e){function n(t){var n=e.call(this,t,_e.NONE)||this;return n._layers=new Map,n._operationType=t.operationType,n._scaleMin=t.scaleMin,n._scaleMax=t.scaleMax,n}return F(n,e),n.prototype.initialize=function(t,n){if(e.prototype.initialize.call(this,t,n),null==this._layers.get(t)){var i=ur.toLayer(t);null!=i&&this._layers.set(t,i)}},n.prototype.onDown=function(n,i,r){if(e.prototype.onDown.call(this,n,i,r),r instanceof t.InteractionEvent){var o=this._layers.get(n),s=r.data.originalEvent.timeStamp;o&&this.condition(n,s,be)&&this.getGestureUtil().onDown(o,r)}},n.prototype.getGestureUtil=function(){var t;return null!==(t=n.GESTURE_UTIL)&&void 0!==t?t:n.GESTURE_UTIL=this.newGestureUtil()},n.prototype.newGestureUtil=function(){var e=this,n=new t.Point;return new _r({on:{move:function(t,i,r,o,s,a){e.onGestureMove(t,i,r,o,s,a,n)}}})},n.prototype.onGestureMove=function(t,e,n,i,r,o,s){var a=t.parent;if(a){var u=t.transform,l=this._operationType,h=!1,c=1;if(l&mr.PINCH){var p=u.scale,f=p.y,d=Math.min(this._scaleMax,Math.max(this._scaleMin,f*o));c=d/f,p.set(d,d),h=!0}if(l&mr.DRAG){a.toLocal(s.set(i,r),void 0,s);var y=s.x,g=s.y,v=i-e,_=r-n;a.toLocal(s.set(v,_),void 0,s);var m=s.x,b=s.y,T=u.position,w=(T.x-m)*c+y,E=(T.y-b)*c+g;T.set(w,E),h=!0}h&&ft.update(t)}},n.prototype.toSize=function(t,e){return"size"in t?e.copyFrom(t.size):e.set(t.width,t.height),e},n}(Ee),Tr=function(e){function n(t){var n=e.call(this,t,_e.NONE)||this;return n._operationType=t.operationType,n._scaleMin=t.scaleMin,n._scaleMax=t.scaleMax,n}return F(n,e),n.prototype.onDown=function(n,i,r){e.prototype.onDown.call(this,n,i,r),r instanceof t.InteractionEvent&&this.condition(n,r.data.originalEvent.timeStamp,be)&&this.getGestureUtil().onDown(n,r)},n.prototype.getGestureUtil=function(){var t;return null!==(t=n.GESTURE_UTIL)&&void 0!==t?t:n.GESTURE_UTIL=this.newGestureUtil()},n.prototype.newGestureUtil=function(){var e=this,n=new t.Point;return new _r({on:{move:function(t,i,r,o,s,a){e.onGestureMove(t,i,r,o,s,a,n)}}})},n.prototype.onGestureMove=function(t,e,n,i,r,o,s){var a=t.parent;if(a){var u=t.transform,l=this._operationType,h=!1,c=1;if(l&mr.PINCH){var p=u.scale,f=p.y,d=Math.min(this._scaleMax,Math.max(this._scaleMin,f*o));c=d/f,p.set(d,d),h=!0}if(l&mr.DRAG){a.toLocal(s.set(i,r),void 0,s);var y=s.x,g=s.y,v=i-e,_=r-n;a.toLocal(s.set(v,_),void 0,s);var m=s.x,b=s.y,T=u.position,w=(T.x-m)*c+y,E=(T.y-b)*c+g;T.set(w,E),h=!0}h&&ft.update(t)}},n}(Ee),wr={SHAPE:0,LAYER:1},Er={INPUT_TEXT:0,INPUT_INTEGER:1,INPUT_REAL:2,EMIT_EVENT:3,WRITE_BOTH:4,WRITE_LOCAL:5,WRITE_REMOTE:6,HTML_ELEMENT:7,HTML_ELEMENT_WITHOUT_POINTER_EVENTS:8,SHOW_HIDE_LAYER:9,GESTURE_LAYER:10,GESTURE:11,EXECUTE:12,EXTENSION:1e3},Or=function(t){function e(e,n,i,r,o){void 0===e&&(e=""),void 0===r&&(r=.05),void 0===o&&(o=20);var s=t.call(this,ke.GESTURE,e,n)||this;return s.operationType=i,s.scaleMin=r,s.scaleMax=o,s}return F(e,t),e.prototype.toRuntime=function(){switch(this.subtype){case wr.SHAPE:return new Tr(this);case wr.LAYER:return new br(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(this.operationType,",").concat(this.scaleMin,",").concat(this.scaleMax,"]"))},e.deserialize=function(t,n){return new e(Le.toResource(1,t,n.resources),this.toSubType(t),t[3],t[4],t[5])},e.toSubType=function(t){if(t[0]!==ke.MISC)return t[2];switch(t[2]){case Er.GESTURE:return wr.SHAPE;case Er.GESTURE_LAYER:return wr.LAYER}},e}(Me),Cr={INVISIBLE:"INVISIBLE",INTERACTIVE:"INTERACTIVE",DRAGGABLE:"DRAGGABLE",PINCHABLE:"PINCHABLE"},Sr=function(t,e,n,i,r){var o,s,a,u=function(t,e){if(xt(t))return t;var n=e.resources;return 0<=t&&t<=n.length?n[t]:""}(t[0],e),l=r?r(u,e):new ar(u,e.mode,e.depth),h=t[1];null==h||2&h||(l.visible=!1,l.state.add(Cr.INVISIBLE));var c=-.5*n+(t[2]||0),p=-.5*i+(t[3]||0);l.transform.position.set(c,p);var f=null!==(o=t[4])&&void 0!==o?o:n,d=null!==(s=t[5])&&void 0!==s?s:i;l.size.set(f,d),l.size.init();var y=t[6];if(null!=y&&l.fill.deserialize(y,e),e.mode===Hn.VIEWER){var g=null!==(a=t[7])&&void 0!==a?a:1,v=1&g,_=2&g,m=4&g;if(_||m){var b=(_?mr.DRAG:mr.NONE)|(m?mr.PINCH:mr.NONE);l.action.add(new Or("",wr.LAYER,b))}(v||_||m)&&(l.interactive=!0)}return l},xr=function(){function t(t,e){this.children=[],this._width=t,this._height=e}return t.prototype.hasConnectors=function(t){for(var e=0,n=t.length;e<n;++e){var i=t[e];if(i instanceof Bi)return!0;var r=i.children;if(0<r.length&&this.hasConnectors(r))return!0}return!1},t.prototype.newHasConnectors=function(){for(var t=new Map,e=this.children,n=0,i=e.length;n<i;++n){var r=e[n];t.set(r,this.hasConnectors(r.children))}return t},t.prototype.copyTo=function(t){for(var e,n=null!==(e=this._hasConnectors)&&void 0!==e?e:this._hasConnectors=this.newHasConnectors(),i=this.children,r=t.children,o=0,s=i.length;o<s;++o){var a=i[o],u=a.clone();u.parent=t,r.push(u),n.get(a)&&zi.move(a,u)}t.onChildTransformChange(),t.toDirty(),t.onAttach()},t.prototype.deserialize=function(t,e){var n=t.length;if(0<n)for(var i=this._width,r=this._height,o=0;o<n;++o)this.children.push(Sr(t[o],e,i,r))},t}(),Dr=function(){function t(){}return t.parse=function(t){if(null!=t&&xt(t))try{var e=JSON.parse(t);if(null!=e&&St(e.version)&&xt(e.name)){if(St(e.width)&&St(e.height)&&Ot(e.items)&&Ot(e.resources))return e;if(xt(e.data))return this.toSerialized(e)}}catch(t){}return null},t.toSimple=function(t){return{version:t.version,id:t.id,name:t.name,label:t.label,category:t.category,summary:t.summary,description:t.description,thumbnail:t.thumbnail,data:JSON.stringify({width:t.width,height:t.height,background:t.background,tile:t.tile,resources:t.resources,data:t.data||t.tags,pieces:t.pieces,layers:t.layers,items:t.items,snap:t.snap})}},t.toSerialized=function(t){if(!("items"in t)){var e=JSON.parse(t.data),n={version:t.version,id:t.id,name:t.name,label:t.label,width:e.width,height:e.height,category:t.category,summary:t.summary,description:t.description,background:e.background,tile:e.tile,resources:e.resources,data:e.data||e.tags,pieces:e.pieces,layers:e.layers,items:e.items,snap:e.snap,thumbnail:t.thumbnail};if(null==n.data){var i=t.tags;null!=i&&(n.data=JSON.parse(i))}if(null==n.pieces){var r=t.pieces;null!=r&&(n.pieces=JSON.parse(r))}return n}return t},t.newLayer=function(t,e,n){e.deserialize(t.layers,n);var i=t.items,r=ri(i,n);return null!=r?r.then((function(t){for(var n=e.children,r=0,o=t.length;r<o;++r){var s=i[r],a=t[r];null!=(u=n[s[16]])&&(a.parent=u,a.uploaded=void 0,u.children.push(a))}for(r=0,o=n.length;r<o;++r){var u;(u=n[r]).onChildTransformChange(),u.toDirty();for(var l=u.children,h=0,c=l.length;h<c;++h)l[h].onAttach()}return t})):Promise.resolve([])},t.toPieceData=function(t,e,n){var i=new Map,r=new Map,o=function(){return i};return this.toPieceData_(t,e,i,r,n,0).then(o,o)},t.toPieceData_=function(t,e,n,i,r,o){var s=this,a=[];if(e&&0<e.length&&t)for(var u=function(u,l){var h=e[u],c=i.get(h);if(null!=c)a.push(c);else{var p=t.piece.getByName(h).then((function(e){return s.toPieceData__(t,h,e,r,o+1,n,i)}),(function(){return null}));i.set(h,p),a.push(p)}},l=0,h=e.length;l<h;++l)u(l);return Promise.all(a)},t.toPieceData__=function(t,e,n,i,r,o,s){var a=this,u=this.toSerialized(n),l=u.width,h=u.height,c=new xr(l,h);o.set(e,new si(e,l,h,c));var p=u.pieces;return this.toPieceData_(t,p,o,s,i,r).then((function(){return a.newLayer(u,c,new Fn(u,p,o,i,r))}))},t}(),Ir={},Ar=function(){function t(t,e,n){this._theme=t,this._callback=n;var i=null==e?void 0:e.background;i&&(this._color=i.color,this._alpha=i.alpha)}return t.prototype.getTheme=function(){return this._theme},t.prototype.setTheme=function(t){this._theme=t},t.prototype.getColor=function(t){var e=this._color;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getBackgroundColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){var e=this._alpha;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getBackgroundAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.onChange=function(){var t=this._callback;null!=t&&t()},t}(),Rr={NONE:0,TOP:1,RIGHT:2,BOTTOM:4,LEFT:8,TOP_RIGHT:3,TOP_BOTTOM:5,TOP_LEFT:9,RIGHT_BOTTOM:6,RIGHT_LEFT:10,BOTTOM_LEFT:12,NOT_TOP:14,NOT_RIGHT:13,NOT_BOTTOM:11,NOT_LEFT:7,ALL:15},Pr=function(){function t(t,e,n){this._theme=t,this._callback=n;var i=null==e?void 0:e.border;i&&(this._color=i.color,this._alpha=i.alpha,this._width=i.width,this._align=i.align,this._mask=ai(i.mask,Rr))}return t.prototype.getTheme=function(){return this._theme},t.prototype.setTheme=function(t){this._theme=t},t.prototype.getColor=function(t){var e=this._color;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getBorderColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){var e=this._alpha;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getBorderAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getWidth=function(t){var e=this._width;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getBorderWidth(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getAlign=function(t){var e=this._align;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getBorderAlign(t)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){this._align!==t&&(this._align=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getMask=function(t){var e=this._mask;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getBorderMask(t)},Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(t){this._mask!==t&&(this._mask=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.onChange=function(){var t=this._callback;null!=t&&t()},t}(),Mr={NONE:0,TOP_LEFT:1,TOP_RIGHT:2,BOTTOM_LEFT:4,BOTTOM_RIGHT:8,TOP:3,BOTTOM:12,LEFT:5,RIGHT:10,ALL:15},kr=function(){function t(t,e,n){this._theme=t,this._callback=n;var i=null==e?void 0:e.corner;i&&(St(i)?(this._radius=i,this._mask=void 0):(this._radius=i.radius,this._mask=ai(i.mask,Mr)))}return t.prototype.getTheme=function(){return this._theme},t.prototype.setTheme=function(t){this._theme=t},t.prototype.getRadius=function(){var t;return null!==(t=this._radius)&&void 0!==t?t:this._theme.getCornerRadius()},Object.defineProperty(t.prototype,"radius",{get:function(){return this._radius},set:function(t){if(this._radius!==t){this._radius=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t.prototype.getMask=function(){var t;return null!==(t=this._mask)&&void 0!==t?t:this._theme.getCornerMask()},Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){this._mask=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;this._radius!==t&&(this._radius=t,n=!0),this._mask!==e&&(this._mask=e,n=!0);var i=this._callback;n&&null!=i&&i()},t}(),Lr={NONE:0,SELF:1,CHILDREN:2,BOTH:3},Nr=function(){function t(t,e,n){this._theme=t,this._callback=n;var i=null==e?void 0:e.outline;i&&(this._color=i.color,this._alpha=i.alpha,this._width=i.width,this._offset=i.offset,this._align=i.align,this._mask=ai(i.mask,Rr))}return t.prototype.getTheme=function(){return this._theme},t.prototype.setTheme=function(t){this._theme=t},t.prototype.getColor=function(t){var e=this._color;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getOutlineColor(t)},Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){if(this._color!==t){this._color=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){var e=this._alpha;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getOutlineAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){if(this._alpha!==t){this._alpha=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t.prototype.getWidth=function(t){var e=this._width;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getOutlineWidth(t)},Object.defineProperty(t.prototype,"width",{get:function(){return this._width},set:function(t){if(this._width!==t){this._width=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t.prototype.getOffset=function(t){var e=this._offset;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getOutlineOffset(t)},Object.defineProperty(t.prototype,"offset",{get:function(){return this._offset},set:function(t){if(this._offset!==t){this._offset=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t.prototype.getAlign=function(t){var e=this._align;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getOutlineAlign(t)},Object.defineProperty(t.prototype,"align",{get:function(){return this._align},set:function(t){if(this._align!==t){this._align=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t.prototype.getMask=function(t){var e=this._mask;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getOutlineMask(t)},Object.defineProperty(t.prototype,"mask",{get:function(){return this._mask},set:function(t){if(this._mask!==t){this._mask=t;var e=this._callback;null!=e&&e()}},enumerable:!1,configurable:!0}),t}(),Br=function(){function t(t,e,n){this._theme=t,this._callback=n;var i=null==e?void 0:e.padding;null!=i&&(St(i)?(this._left=i,this._top=i,this._right=i,this._bottom=i):(this._left=i.left,this._top=i.top,this._right=i.right,this._bottom=i.bottom))}return t.prototype.getTheme=function(){return this._theme},t.prototype.setTheme=function(t){this._theme=t},t.prototype.getCallback=function(){return this._callback},t.prototype.getLeft=function(){var t;return null!==(t=this._left)&&void 0!==t?t:this._theme.getPaddingLeft()},Object.defineProperty(t.prototype,"left",{get:function(){return this._left},set:function(t){this._left!==t&&(this._left=t,null!=this._callback&&this._callback())},enumerable:!1,configurable:!0}),t.prototype.getTop=function(){var t;return null!==(t=this._top)&&void 0!==t?t:this._theme.getPaddingTop()},Object.defineProperty(t.prototype,"top",{get:function(){return this._top},set:function(t){this._top!==t&&(this._top=t,null!=this._callback&&this._callback())},enumerable:!1,configurable:!0}),t.prototype.getRight=function(){var t;return null!==(t=this._right)&&void 0!==t?t:this._theme.getPaddingRight()},Object.defineProperty(t.prototype,"right",{get:function(){return this._right},set:function(t){this._right!==t&&(this._right=t,null!=this._callback&&this._callback())},enumerable:!1,configurable:!0}),t.prototype.getBottom=function(){var t;return null!==(t=this._bottom)&&void 0!==t?t:this._theme.getPaddingBottom()},Object.defineProperty(t.prototype,"bottom",{get:function(){return this._bottom},set:function(t){this._bottom!==t&&(this._bottom=t,null!=this._callback&&this._callback())},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n,i){null==e?(this.top=t,this.right=t,this.bottom=t,this.left=t):null==n?(this.top=t,this.right=e,this.bottom=t,this.left=e):null==i?(this.top=t,this.right=e,this.bottom=n,this.left=e):(this.top=t,this.right=e,this.bottom=n,this.left=i),null!=this._callback&&this._callback()},t}(),zr=function(){function t(t,e){this._point=t,this._onChange=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._point.x},set:function(t){var e=this._point,n=e.x;if(n!==t){e.x=t;var i=e.y;this._onChange(t,i,n,i)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._point.y},set:function(t){var e=this._point,n=e.y;if(n!==t){e.y=t;var i=e.x;this._onChange(i,t,i,n)}},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=this._point,i=n.x,r=n.y;return i===t&&r===e||(n.set(t,e),this._onChange(t,e,i,r)),this},t.prototype.copyFrom=function(t){var e=t.x,n=t.y,i=this._point,r=i.x,o=i.y;return r===e&&o===n||(i.copyFrom(t),this._onChange(e,n,r,o)),this},t.prototype.copyTo=function(t){return t.copyFrom(this._point)},t.prototype.copy=function(){return this.copyFrom(arguments[0])},t.prototype.clone=function(e){return new t(this._point,e||this._onChange)},t.prototype.equals=function(t){return this._point.equals(t)},t}(),Ur=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r._width=100,r._height=100,r._cornerRadius=0,r._cornerMask=Mr.NONE,r._isDirty=!0,r._resolution=1,r._vertexBuffer=r.getBuffer("aVertexPosition"),r._vertices=r._vertexBuffer.data,r._uvBuffer=r.getBuffer("aTextureCoord"),r._uvs=r._uvBuffer.data,r._indexBuffer=r.getIndex(),r._indices=r._indexBuffer.data,r}return F(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){this._width!==t&&(this._width=t,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},set:function(t){this._height!==t&&(this._height=t,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cornerRadius",{get:function(){return this._cornerRadius},set:function(t){this._cornerRadius!==t&&(this._cornerRadius=t,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cornerMask",{get:function(){return this._cornerMask},set:function(t){this._cornerMask!==t&&(this._cornerMask=t,this._isDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.getTables=function(){var t=e.TABLES;return null==t&&(t=this.newTables(e.N),e.TABLES=t),t},e.prototype.newTables=function(t){var e=1/(t-1)*.5;return[this.newTable(t,1,e),this.newTable(t,.5,e),this.newTable(t,0,e),this.newTable(t,1.5,e)]},e.prototype.newTable=function(t,e,n){for(var i=[],r=[],o=Math.PI,s=0,a=e;s<t;s+=1,a-=n){var u=a*o,l=+Math.cos(u),h=-Math.sin(u);i.push(l),r.push(h)}return{cos:i,sin:r}},e.N=5,e}(t.MeshGeometry),jr=function(t){function e(){return t.call(this,new Float32Array(16*Ur.N),new Float32Array(16*Ur.N),new Uint16Array(3*(12*Ur.N-2)))||this}return F(e,t),e.prototype.fillVertices=function(t,e,n,i,r,o,s,a,u,l){for(var h=l.cos,c=l.sin,p=a+u,f=0;f<r;++f){var d=h[f],y=c[f];t[++n]=o+d*a,t[++n]=s+y*a,t[++n]=o+d*p,t[++n]=s+y*p,e[++i]=.5,e[++i]=.5,e[++i]=.5*(1+d),e[++i]=.5*(1+y)}},e.prototype.fillIndices=function(t,e,n,i){for(var r=0;r<i;++r)t[++n]=e+0,t[++n]=e+1,t[++n]=e+2,t[++n]=e+2,t[++n]=e+1,t[++n]=e+3,e+=2},e.prototype.fillIndicesEnd=function(t,e,n,i){for(var r=0,o=i-1;r<o;++r)t[++n]=e+0,t[++n]=e+1,t[++n]=e+2,t[++n]=e+2,t[++n]=e+1,t[++n]=e+3,e+=2;t[++n]=e+0,t[++n]=e+1,t[++n]=0,t[++n]=0,t[++n]=e+1,t[++n]=1,e+=2},e.prototype.update=function(t){var e=t.resolution;if(this._isDirty||this._resolution!==e){this._isDirty=!1,this._resolution=e;var n=this._vertices,i=this._uvs,r=this._indices,o=this._width,s=this._height,a=Math.min(.5*o,.5*s,this._cornerRadius),u=.5/e,l=a,h=o-a,c=o,p=a,f=s-a,d=s,y=this._cornerMask,g=!(y&Mr.TOP_LEFT),v=!(y&Mr.TOP_RIGHT),_=!(y&Mr.BOTTOM_LEFT),m=!(y&Mr.BOTTOM_RIGHT),b=-1,T=-1,w=0,E=-1,O=Ur.N,C=O<<2,S=O<<1,x=6*O,D=this.getTables(),I=D[0],A=D[1],R=D[2],P=D[3];g?this.fillVertices(n,i,b,T,O,l,p,a,u,I):this.fillVertices(n,i,b,T,O,0,0,0,u,I),this.fillIndices(r,w,E,O),b+=C,T+=C,w+=S,E+=x,v?this.fillVertices(n,i,b,T,O,h,p,a,u,A):this.fillVertices(n,i,b,T,O,c,0,0,u,A),this.fillIndices(r,w,E,O),b+=C,T+=C,w+=S,E+=x,m?this.fillVertices(n,i,b,T,O,h,f,a,u,R):this.fillVertices(n,i,b,T,O,c,d,0,u,R),this.fillIndices(r,w,E,O),b+=C,T+=C,w+=S,E+=x,_?this.fillVertices(n,i,b,T,O,l,f,a,u,P):this.fillVertices(n,i,b,T,O,0,d,0,u,P),this.fillIndicesEnd(r,w,E,O),b+=C,T+=C,w+=S,E+=x,w=2;for(var M=1,k=4*O-1;M<k;M+=1,w+=2)r[++E]=0,r[++E]=w,r[++E]=w+2;this._vertexBuffer.update(),this._uvBuffer.update(),this._indexBuffer.update()}},e}(Ur),Fr=function(e){function n(n){var i=e.call(this,new jr,new t.MeshMaterial(n))||this;return n.on("update",(function(){ft.update(i)})),i}return F(n,e),Object.defineProperty(n.prototype,"width",{get:function(){return this.geometry.width},set:function(t){this.geometry.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.geometry.height},set:function(t){this.geometry.height=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cornerRadius",{get:function(){return this.geometry.cornerRadius},set:function(t){this.geometry.cornerRadius=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cornerMask",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.cornerMask=t},enumerable:!1,configurable:!0}),n.prototype._render=function(t){this.geometry.update(t),e.prototype._render.call(this,t)},n}(t.Mesh),Hr=function(){function t(){}return t.prototype.get=function(t,e){var n=this._mesh;return null==n&&((n=new Fr(e.getBackgroundTexture())).parent=t,this._mesh=n),n},t.prototype.hide=function(){var t=this._mesh;null!=t&&(t.visible=!1)},t.prototype.onReflow=function(t,e,n,i,r,o,s){var a=t.background,u=a.getColor(r);if(null!=u){var l=a.getAlpha(r);if(0<l){var h=this.get(t,i);h.tint=u,h.alpha=l,h.width=e,h.height=n,h.cornerRadius=o,h.cornerMask=s,h.visible=!0}else this.hide()}else this.hide()},t.prototype.render=function(t){var e;null===(e=this._mesh)||void 0===e||e.render(t)},t.prototype.updateTransform=function(){var t;null===(t=this._mesh)||void 0===t||t.updateTransform()},t}(),Gr=function(t){function e(){var e=t.call(this,new Float32Array(32*Ur.N),new Float32Array(32*Ur.N),new Uint16Array(72*Ur.N))||this;return e._borderWidth=0,e._borderMask=Rr.NONE,e}return F(e,t),Object.defineProperty(e.prototype,"borderWidth",{get:function(){return this._borderWidth},set:function(t){this._borderWidth!==t&&(this._borderWidth=t,this._isDirty=!0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"borderMask",{get:function(){return this._borderMask},set:function(t){this._borderMask!==t&&(this._borderMask=t,this._isDirty=!0)},enumerable:!1,configurable:!0}),e.prototype.fillVertices=function(t,e,n,i,r,o,s,a,u,l,h){var c=.5*l,p=a-c,f=a+c,d=p-u,y=f+u,g=h.cos,v=h.sin;if(d<=0){var _=g[0]+g[r-1],m=v[0]+v[r-1];if(p<=0)if(a<=0)for(var b=0;b<r;++b){var T=g[b],w=v[b];t[++n]=o+_*d,t[++n]=s+m*d,t[++n]=o+_*p,t[++n]=s+m*p,t[++n]=o+_*f,t[++n]=s+m*f,t[++n]=o+_*y,t[++n]=s+m*y,e[++i]=.5*(1+T),e[++i]=.5*(1+w),e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5*(1+T),e[++i]=.5*(1+w)}else for(b=0;b<r;++b)T=g[b],w=v[b],t[++n]=o+_*d,t[++n]=s+m*d,t[++n]=o+_*p,t[++n]=s+m*p,t[++n]=o+T*f,t[++n]=s+w*f,t[++n]=o+T*y,t[++n]=s+w*y,e[++i]=.5*(1+T),e[++i]=.5*(1+w),e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5*(1+T),e[++i]=.5*(1+w);else for(b=0;b<r;++b)T=g[b],w=v[b],t[++n]=o+_*d,t[++n]=s+m*d,t[++n]=o+T*p,t[++n]=s+w*p,t[++n]=o+T*f,t[++n]=s+w*f,t[++n]=o+T*y,t[++n]=s+w*y,e[++i]=.5*(1+T),e[++i]=.5*(1+w),e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5*(1+T),e[++i]=.5*(1+w)}else for(b=0;b<r;++b)T=g[b],w=v[b],t[++n]=o+T*d,t[++n]=s+w*d,t[++n]=o+T*p,t[++n]=s+w*p,t[++n]=o+T*f,t[++n]=s+w*f,t[++n]=o+T*y,t[++n]=s+w*y,e[++i]=.5*(1+T),e[++i]=.5*(1+w),e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5,e[++i]=.5*(1+T),e[++i]=.5*(1+w)},e.prototype.fillIndices=function(t,e,n,i,r,o){for(var s=0,a=i-1;s<a;++s)t[++n]=e+0,t[++n]=e+1,t[++n]=e+4,t[++n]=e+4,t[++n]=e+1,t[++n]=e+5,e+=1,t[++n]=e+0,t[++n]=e+1,t[++n]=e+4,t[++n]=e+4,t[++n]=e+1,t[++n]=e+5,e+=1,t[++n]=e+0,t[++n]=e+1,t[++n]=e+4,t[++n]=e+4,t[++n]=e+1,t[++n]=e+5,e+=2;r?o?(t[++n]=e+0,t[++n]=e+1,t[++n]=0,t[++n]=0,t[++n]=e+1,t[++n]=1,e+=1,t[++n]=e+0,t[++n]=e+1,t[++n]=1,t[++n]=1,t[++n]=e+1,t[++n]=2,e+=1,t[++n]=e+0,t[++n]=e+1,t[++n]=2,t[++n]=2,t[++n]=e+1,t[++n]=3,e+=2):(t[++n]=e+0,t[++n]=e+1,t[++n]=e+4,t[++n]=e+4,t[++n]=e+1,t[++n]=e+5,e+=1,t[++n]=e+0,t[++n]=e+1,t[++n]=e+4,t[++n]=e+4,t[++n]=e+1,t[++n]=e+5,e+=1,t[++n]=e+0,t[++n]=e+1,t[++n]=e+4,t[++n]=e+4,t[++n]=e+1,t[++n]=e+5,e+=2):(t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,e+=1,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,e+=1,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,t[++n]=e,e+=2)},e.prototype.update=function(t){var e=t.resolution;if(this._isDirty||this._resolution!==e){this._isDirty=!1,this._resolution=e;var n=this._vertices,i=this._uvs,r=this._indices,o=this._width,s=this._height,a=this._borderWidth,u=Math.min(.5*o,.5*s,this._cornerRadius),l=.5/e,h=u,c=o-u,p=o,f=u,d=s-u,y=s,g=this._borderMask,v=!(g&Rr.TOP),_=!(g&Rr.BOTTOM),m=!(g&Rr.LEFT),b=!(g&Rr.RIGHT),T=this._cornerMask,w=!(T&Mr.TOP_LEFT),E=!(T&Mr.TOP_RIGHT),O=!(T&Mr.BOTTOM_LEFT),C=!(T&Mr.BOTTOM_RIGHT),S=-1,x=-1,D=0,I=-1,A=Ur.N,R=A<<2,P=A<<3,M=18*A,k=this.getTables(),L=k[0],N=k[1],B=k[2],z=k[3];w?m||v?this.fillVertices(n,i,S,x,A,h,f,u,l,a,L):this.fillVertices(n,i,S,x,A,h,f,u,l,0,L):m||v?this.fillVertices(n,i,S,x,A,0,0,0,l,a,L):this.fillVertices(n,i,S,x,A,0,0,0,l,0,L),this.fillIndices(r,D,I,A,v,!1),S+=P,x+=P,D+=R,I+=M,E?v||b?this.fillVertices(n,i,S,x,A,c,f,u,l,a,N):this.fillVertices(n,i,S,x,A,c,f,u,l,0,N):v||b?this.fillVertices(n,i,S,x,A,p,0,0,l,a,N):this.fillVertices(n,i,S,x,A,p,0,0,l,0,N),this.fillIndices(r,D,I,A,b,!1),S+=P,x+=P,D+=R,I+=M,C?b||_?this.fillVertices(n,i,S,x,A,c,d,u,l,a,B):this.fillVertices(n,i,S,x,A,c,d,u,l,0,B):b||_?this.fillVertices(n,i,S,x,A,p,y,0,l,a,B):this.fillVertices(n,i,S,x,A,p,y,0,l,0,B),this.fillIndices(r,D,I,A,_,!1),S+=P,x+=P,D+=R,I+=M,O?_||m?this.fillVertices(n,i,S,x,A,h,d,u,l,a,z):this.fillVertices(n,i,S,x,A,h,d,u,l,0,z):_||m?this.fillVertices(n,i,S,x,A,0,y,0,l,a,z):this.fillVertices(n,i,S,x,A,0,y,0,l,0,z),this.fillIndices(r,D,I,A,m,!0),S+=P,x+=P,D+=R,I+=M,this._vertexBuffer.update(),this._uvBuffer.update(),this._indexBuffer.update()}},e}(Ur),Vr=function(e){function n(n){var i=e.call(this,new Gr,new t.MeshMaterial(n))||this;return n.on("update",(function(){ft.update(i)})),i}return F(n,e),Object.defineProperty(n.prototype,"width",{get:function(){return this.geometry.width},set:function(t){this.geometry.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.geometry.height},set:function(t){this.geometry.height=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cornerRadius",{get:function(){return this.geometry.cornerRadius},set:function(t){this.geometry.cornerRadius=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"cornerMask",{get:function(){return this.geometry.cornerMask},set:function(t){this.geometry.cornerMask=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"borderWidth",{get:function(){return this.geometry.borderWidth},set:function(t){this.geometry.borderWidth=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"borderMask",{get:function(){return this.geometry.borderMask},set:function(t){this.geometry.borderMask=t},enumerable:!1,configurable:!0}),n.prototype._render=function(t){this.geometry.update(t),e.prototype._render.call(this,t)},n}(t.Mesh),Wr=function(){function t(){}return t.prototype.get=function(t,e){var n=this._mesh;return null==n&&((n=new Vr(e.getBorderTexture())).parent=t,this._mesh=n),n},t.prototype.hide=function(){var t=this._mesh;null!=t&&(t.visible=!1)},t.prototype.onReflow=function(t,e,n,i,r,o,s){var a=t.border,u=a.getColor(r);if(null!=u){var l=a.getAlpha(r);if(0<l){var h=a.getWidth(r),c=a.getMask(r),p=this.get(t,i),f=(a.getAlign(r)-.5)*h;p.tint=u,p.alpha=l,p.x=-f,p.y=-f,p.width=e+2*f,p.height=n+2*f,p.cornerRadius=Math.max(0,o+f),p.cornerMask=s,p.borderWidth=h,p.borderMask=c,p.visible=!0}else this.hide()}else this.hide()},t.prototype.render=function(t){var e;null===(e=this._mesh)||void 0===e||e.render(t)},t.prototype.updateTransform=function(){var t;null===(t=this._mesh)||void 0===t||t.updateTransform()},t}(),Kr=function(){function t(){}return t.prototype.get=function(t,e){var n=this._mesh;return null==n&&((n=new Vr(e.getBorderTexture())).parent=t,this._mesh=n),n},t.prototype.hide=function(){var t=this._mesh;null!=t&&(t.visible=!1)},t.prototype.onReflow=function(t,e,n,i,r,o,s){var a=t.outline,u=a.getColor(r);if(null!=u){var l=a.getAlpha(r);if(0<l){var h=a.getWidth(r),c=a.getMask(r),p=this.get(t,i),f=a.getOffset(r)+(a.getAlign(r)-.5)*h;p.tint=u,p.alpha=l,p.x=-f,p.y=-f,p.width=e+2*f,p.height=n+2*f,p.cornerRadius=Math.max(0,o+f),p.cornerMask=s,p.borderWidth=h,p.borderMask=c,p.visible=!0}else this.hide()}else this.hide()},t.prototype.render=function(t){var e;null===(e=this._mesh)||void 0===e||e.render(t)},t.prototype.updateTransform=function(){var t;null===(t=this._mesh)||void 0===t||t.updateTransform()},t}(),Xr=function(){function t(t){var e=new Hr;this._background=e,t.snippet.add(e,!0);var n=new Wr;this._border=n,t.snippet.add(n,!0);var i=new Kr;this._outline=i,t.snippet.add(i,!1),t.reflowable.add(this)}return t.prototype.onReflow=function(t,e,n){var i=t.theme,r=t.state,o=t.corner,s=o.getRadius(),a=o.getMask();this._background.onReflow(t,e,n,i,r,s,a),this._border.onReflow(t,e,n,i,r,s,a),this._outline.onReflow(t,e,n,i,r,s,a)},t}(),Yr={NONE:0,BEFORE:1,AFTER:2,BOTH:3},qr={OPEN:0,CLOSE:1,PARENSESIS:2,ADD_OR_PLUS:3,SUB_OR_MINUS:4,PLUS:5,MINUS:6,ADD:7,SUB:8,MUL:9,DIV:10,MIN:11,MAX:12,COMMA:13,PARENT:14,SELF:15,PADDING:16,CURRENT:17,NUMBER:18},Zr=function(){function t(t){var e=this.toToken(t),n=0;do{n=this.toParensesis(e,n)}while(n<e.length);if(this.toUnary(e),this.toArithmetic(e,qr.MUL,qr.DIV),this.toArithmetic(e,qr.ADD,qr.SUB),1===e.length){var i=e[0];if(!St(i))return void(this._node=i)}throw new Error("Failed to parse '".concat(t,"'"))}return t.prototype.toParensesis=function(t,e){for(var n=t.length,i=e;i<n;++i)if(t[i]===qr.OPEN){var r=i,o=qr.PARENSESIS;if(0<i){var s=t[i-1];s!==qr.MIN&&s!==qr.MAX||(r-=1,o=s)}for(var a=i+1;a<n;++a){var u=t[a];if(u===qr.CLOSE)return t[r]=[o,this.toComma(t,i+1,a)],t.splice(r+1,a-r),r+1;u===qr.OPEN&&(a=this.toParensesis(t,a)-1,n=t.length)}throw new Error("Malformed parensesis")}return n},t.prototype.toCommaOf=function(t,e,n){var i=n-e;if(i<=0)return[qr.NUMBER,0];if(i<=1)return t[e];for(var r=[],o=e;o<n;++o)r.push(t[o]);return[qr.PARENSESIS,r]},t.prototype.toComma=function(t,e,n){for(var i=null,r=e,o=e;o<n;++o)t[o]===qr.COMMA&&((i=i||[]).push(this.toCommaOf(t,r,o)),r=o+1);if(r<n){if(null==i){var s=[];for(o=r;o<n;++o)s.push(t[o]);return s}i.push(this.toCommaOf(t,r,n))}return i||[]},t.prototype.toUnaryNode=function(t){St(t)||t[0]!==qr.PARENSESIS&&t[0]!==qr.MIN&&t[0]!==qr.MAX||this.toUnary(t[1])},t.prototype.toUnary=function(t){for(var e=0,n=t.length;e<n;++e){var i=t[e];if(i===qr.ADD_OR_PLUS||i===qr.SUB_OR_MINUS)if(e<=0||St(t[e-1])){if(!(e+1<n)||St(t[e+1]))throw new Error("Malformed unary operator");var r=t.splice(e+1,1)[0],o=i===qr.ADD_OR_PLUS?qr.PLUS:qr.MINUS;t[e]=[o,r],n=t.length,this.toUnaryNode(r)}else o=i===qr.ADD_OR_PLUS?qr.ADD:qr.SUB,t[e]=o;else this.toUnaryNode(i),n=t.length}},t.prototype.toArithmeticNode=function(t,e,n){St(t)||(t[0]===qr.PARENSESIS||t[0]===qr.MIN||t[0]===qr.MAX?this.toArithmetic(t[1],e,n):t[0]===qr.PLUS||t[0]===qr.MINUS?this.toArithmeticNode(t[1],e,n):t[0]!==qr.ADD&&t[0]!==qr.SUB&&t[0]!==qr.MUL&&t[0]!==qr.DIV||(this.toArithmeticNode(t[1],e,n),this.toArithmeticNode(t[2],e,n)))},t.prototype.toArithmetic=function(t,e,n){for(var i=0,r=t.length;i<r;++i){var o=t[i];if(o===e||o===n){if(0<i&&i+1<r){var s=t[i-1],a=t[i+1];if(!St(s)&&!St(a)){t.splice(i,2),t[i-1]=[o,s,a],i-=1,r=t.length,this.toArithmeticNode(s,e,n),this.toArithmeticNode(a,e,n);continue}}throw new Error("Malformed operands for the operator ".concat(o))}this.toArithmeticNode(o,e,n),r=t.length}},t.prototype.toToken=function(e){for(var n=[];;){var i=t.TOKEN_REGEX.exec(e);if(null==i)break;var r=i[0],o=this.toTokenOperator(r);if(null!=o)n.push(o);else{var s=parseFloat(r);if(s!=s)throw new Error("Unexpected token '".concat(r,"' at ").concat(i.index," in '").concat(e,"'"));var a=this.toTokenLiteral(r);null!=a?n.push([a,.01*s]):n.push([qr.NUMBER,s])}}return n},t.prototype.toTokenOperator=function(t){switch(t){case"+":return qr.ADD_OR_PLUS;case"-":return qr.SUB_OR_MINUS;case"*":return qr.MUL;case"/":return qr.DIV;case"(":return qr.OPEN;case")":return qr.CLOSE;case",":return qr.COMMA;case"min":return qr.MIN;case"max":return qr.MAX}return null},t.prototype.toTokenLiteral=function(t){var e=t.length;if(0<e)switch(t[e-1]){case"%":return qr.PARENT;case"s":return qr.SELF;case"p":return qr.PADDING;case"c":return qr.CURRENT}return null},t.prototype.evaluate=function(t,e,n,i,r){switch(t[0]){case qr.PARENSESIS:var o=t[1];return this.evaluate(o[o.length-1],e,n,i,r);case qr.PLUS:return+this.evaluate(t[1],e,n,i,r);case qr.MINUS:return-this.evaluate(t[1],e,n,i,r);case qr.ADD:return this.evaluate(t[1],e,n,i,r)+this.evaluate(t[2],e,n,i,r);case qr.SUB:return this.evaluate(t[1],e,n,i,r)-this.evaluate(t[2],e,n,i,r);case qr.MUL:return this.evaluate(t[1],e,n,i,r)*this.evaluate(t[2],e,n,i,r);case qr.DIV:return this.evaluate(t[1],e,n,i,r)/this.evaluate(t[2],e,n,i,r);case qr.MIN:if(0<t[1].length){for(var s=t[1],a=this.evaluate(s[0],e,n,i,r),u=1,l=s.length;u<l;++u)a=Math.min(a,this.evaluate(s[u],e,n,i,r));return a}return 0;case qr.MAX:if(0<t[1].length){for(s=t[1],a=this.evaluate(s[0],e,n,i,r),u=1,l=s.length;u<l;++u)a=Math.max(a,this.evaluate(s[u],e,n,i,r));return a}return 0;case qr.PARENT:return t[1]*e;case qr.SELF:return t[1]*n;case qr.PADDING:return t[1]*i;case qr.CURRENT:return t[1]*r;case qr.NUMBER:return t[1]}return 0},t.prototype.calculate=function(t,e,n,i){return this.evaluate(this._node,t,e,n,i)},t.TOKEN_REGEX=/(?:\+|-|\*|\/|\(|\)|min|max|,|(?:\d+(?:\.\d*)?[%psc]?))/g,t}(),Jr=function(t,e){return.5*(t-e)},Qr=function(t,e,n){return n},$r=function(t){return t},to=function(t,e,n){return t-n},eo=function(){function t(){}return t.position=function(t){if(null==t||St(t))return null;if(xt(t)){switch(t){case"center":case"CENTER":return Jr;case"padding":case"PADDING":return Qr}var e=new Zr(t);return function(t,n,i,r){return e.calculate(t,n,i,r)}}if(Ct(t))return t;var n=t;return function(t,e,i,r){return n.calculate(t,e,i,r)}},t.size=function(t){if(null==t||St(t))return null;if(xt(t)){switch(t){case"100%":case"maximized":case"MAXIMIZED":return $r;case"padding":case"PADDING":return to}var e=new Zr(t);return function(t,n,i,r){return e.calculate(t,n,i,r)}}if(Ct(t))return t;var n=t;return function(t,e,i,r){return n.calculate(t,e,i,r)}},t}(),no=function(){function t(){}return t.isActivateKey=function(t){return"Space"===t.key||"Enter"===t.key||32===t.which||13===t.which},t.isArrowUpKey=function(t){return"ArrowUp"===t.key||38===t.which},t.isArrowDownKey=function(t){return"ArrowDown"===t.key||40===t.which},t.isArrowLeftKey=function(t){return"ArrowLeft"===t.key||37===t.which},t.isArrowRightKey=function(t){return"ArrowRight"===t.key||39===t.which},t.isCancelKey=function(t){return"Esc"===t.key||27===t.which},t.isFocusKey=function(t){return"Tab"===t.key||9===t.which},t.isUndoKey=function(t){return t.ctrlKey&&("z"===t.key||90===t.which)},t.isRedoKey=function(t){return t.ctrlKey&&("y"===t.key||89===t.which)},t.isSaveKey=function(t){return t.ctrlKey&&!t.shiftKey&&("s"===t.key||83===t.which)},t.isSaveAsKey=function(t){return t.ctrlKey&&t.shiftKey&&("S"===t.key||83===t.which)},t.isDeleteKey=function(t){return"Delete"===t.key||46===t.which},t.isSelectAllKey=function(t){return t.ctrlKey&&!t.shiftKey&&("a"===t.key||65===t.which)},t.isOkKey=function(t){return"Enter"===t.key||13===t.which},t.getFocusDirection=function(t){return!0!==t.shiftKey},t.toShortcut=function(t){if(xt(t)){var e,n=t,i=n.indexOf("->"),r=void 0;0<=i?(r=n.substring(0,i).trim().toLowerCase(),e=n.substring(i+2).trim()):r=n.trim().toLowerCase();for(var o=!1,s=!1,a=!1,u="a",l=r.length,h=0,c=1;c<l;++c)if("+"===r.charAt(c)){var p=r.substring(h,c);switch(p){case"alt":o=!0;break;case"ctrl":s=!0;break;case"shift":a=!0;break;default:u=p}h=c+=1}return h!==c&&(u=r.substring(h,c)),function(t){var e=t.key;if(e.length<=1){t.shift&&(t.key=e.toUpperCase());var n=e.charCodeAt(0);t.which=97<=n&&n<=122?n-32:n}else switch(e){case"enter":t.key="Enter",t.which=13;break;case"space":t.key=" ",t.which=32;break;case"escape":t.key="Escape",t.which=27;break;case"f1":t.key="F1",t.which=112;break;case"f2":t.key="F2",t.which=113;break;case"f3":t.key="F3",t.which=114;break;case"f4":t.key="F4",t.which=115;break;case"f5":t.key="F5",t.which=116;break;case"f6":t.key="F6",t.which=117;break;case"f7":t.key="F7",t.which=118;break;case"f8":t.key="F8",t.which=119;break;case"f9":t.key="F9",t.which=120;break;case"f10":t.key="F10",t.which=121;break;case"f11":t.key="F11",t.which=122;break;case"f12":t.key="F12",t.which=123;break;case"capslock":t.key="CapsLock",t.shift?t.which=20:t.which=240;break;case"arrowup":t.key="ArrowUp",t.which=38;break;case"arrowdown":t.key="ArrowDown",t.which=40;break;case"arrowleft":t.key="ArrowLeft",t.which=37;break;case"arrowright":t.key="ArrowRight",t.which=39;break;case"insert":t.key="Insert",t.which=45;break;case"delete":t.key="Delete",t.which=46;break;case"pageup":t.key="PageUp",t.which=33;break;case"pagedown":t.key="PageDown",t.which=34;break;case"backspace":t.key="Backspace",t.which=8;break;case"colon":t.key=":",t.which=186;break;case"semicolon":t.key=";",t.which=187;break;case"pause":t.key="Pause",t.which=19;break;case"scrolllock":t.key="ScrollLock",t.which=145;break;case"tab":t.key="Tab",t.which=9;break;case"plus":t.key="+",t.which=187;break;case"minus":t.key="-",t.which=189}return t}({alt:o,ctrl:s,shift:a,key:u,which:0,event:e})}return t},t.toString=function(t){var e=[];return t.ctrl&&e.push("Ctrl"),t.shift&&e.push("Shift"),t.alt&&e.push("Alt"),e.push(t.key.toUpperCase()),e.join("+")},t.on=function(t,e,n){var i=this.toShortcut(e);document.body.addEventListener("keydown",(function(e){e.altKey!==i.alt||e.ctrlKey!==i.ctrl||e.shiftKey!==i.shift||e.key!==i.key&&e.which!==i.which||(t.state.isActionable&&(null!=i.event?t.emit(i.event):null!=n&&n(e)),e.preventDefault())}))},t.moveFocusVertically=function(e,n,i){if(n.state.isActionable){var r=t.isArrowUpKey(e),o=t.isArrowDownKey(e);if(r||o)return this.moveFocus(o,n,i)}return!1},t.moveFocusHorizontally=function(e,n,i){if(n.state.isActionable){var r=t.isArrowLeftKey(e),o=t.isArrowRightKey(e);if(r||o)return this.moveFocus(o,n,i)}return!1},t.moveFocus=function(t,e,n){var i,r=null!==(i=null==n?void 0:n.picked)&&void 0!==i?i:ft.getLayer(e);if(r){var o=r.getFocusController(),s=o.get();if(null!=s){var a=o.find(s,!1,s.state.isFocusRoot||t,t,e);if(null!=a)return o.focus(a),!0}}return!1},t}(),io=function(){function t(){this._isOn=!1}return Object.defineProperty(t.prototype,"isOff",{get:function(){return!this._isOn},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isOn",{get:function(){return this._isOn},enumerable:!1,configurable:!0}),t.prototype.toCoordinate=function(t){return this._isOn?"auto":t},t.prototype.from=function(t){return"auto"===t||"AUTO"===t?(this._isOn=!0,!0):(this._isOn=!1,!1)},t}(),ro=function(){this.width=new io,this.height=new io},oo=function(){function t(t){this._parent=t,this._befores=[],this._afters=[],this._renderable=!0}return Object.defineProperty(t.prototype,"renderable",{get:function(){return this._renderable},set:function(t){this._renderable=t},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){(e?this._befores:this._afters).push(t),"parent"in t&&(t.parent=this._parent)},t.prototype.addAt=function(t,e,n){var i=e?this._befores:this._afters;0===n?i.unshift(t):0<n&&n<i.length?i.splice(n,0,t):i.push(t),"parent"in t&&(t.parent=this._parent)},t.prototype.remove=function(t,e){var n=e?this._befores:this._afters,i=n.indexOf(t);0<=i&&(n.splice(i,1),"parent"in t&&(t.parent=null))},t.prototype.render=function(t,e){if(this._renderable)for(var n=e?this._befores:this._afters,i=0,r=n.length;i<r;++i)n[i].render(t)},t.prototype.updateTransform=function(){for(var t=this._befores,e=0,n=t.length;e<n;++e)t[e].updateTransform();var i=this._afters;for(e=0,n=i.length;e<n;++e)i[e].updateTransform()},t}(),so=function(){function t(){this._list=[]}return t.prototype.add=function(t){this._list.push(t)},t.prototype.remove=function(t){var e=this._list,n=e.indexOf(t);0<=n&&e.splice(n,1)},t.prototype.onReflow=function(t,e,n){for(var i=this._list,r=0,o=i.length;r<o;++r)i[r].onReflow(t,e,n)},t}(),ao=function(e){function n(t){var i,r,o,s,a,u,l,h,c,p=e.call(this)||this,f=p.transform;p._position=new zr(f.position,(function(t,e,n,i){p.onMove(t,e,n,i)})),p._scale=new zr(f.scale,(function(t,e,n,i){p.onScale(t,e,n,i)})),p._skew=new zr(f.skew,(function(t,e,n,i){p.onSkew(t,e,n,i)})),p._options=t;var d=p._scalarSet={};p._auto=new ro,p._isDirty=!0,p._hasDirty=!1,p._isHierarchyDirty=!1,p._shadow=null,p.name=null!==(i=null==t?void 0:t.name)&&void 0!==i?i:"";var y=function(t){var e=null==t?void 0:t.theme;if(e)return xt(e)?it.getInstance().get(e):e}(t)||p.getThemeDefault();p._theme=y,p._snippet=new oo(p),p._reflowable=new so,p._clearType=ai(null!==(r=null==t?void 0:t.clear)&&void 0!==r?r:y.getClearType(),Yr),p._padding=p.newPadding(y,t,(function(){p.toDirty(),p.toParentResized(),p.toHierarchyDirty(),ft.update(p)}));var g=function(){p.toDirty(),ft.update(p)};p._background=new Ar(y,t,g),p._border=new Pr(y,t,g),p._outline=new Nr(y,t,g),p._corner=new kr(y,t,g);var v=f.position,_=null!==(o=null==t?void 0:t.x)&&void 0!==o?o:y.getX();St(_)?v.x=_:(v.x=0,d.x=eo.position(_));var m=null!==(s=null==t?void 0:t.y)&&void 0!==s?s:y.getY();St(m)?v.y=m:(v.y=0,d.y=eo.position(m));var b=null!==(a=null==t?void 0:t.width)&&void 0!==a?a:y.getWidth();p._auto.width.from(b)?p._width=100:St(b)?p._width=b:(p._width=100,d.width=eo.size(b));var T=null!==(u=null==t?void 0:t.height)&&void 0!==u?u:y.getHeight();if(p._auto.height.from(T)?p._height=100:St(T)?p._height=T:(p._height=100,d.height=eo.size(T)),null!=t){var w=t.visible;null!=w&&(p.visible=w)}if(null!=t){var E=t.renderable;null!=E&&(p.renderable=E)}p._state=new It((function(t,e){p.onStateChange(t,e)}));var O,C=ai(null!==(l=null==t?void 0:t.interactive)&&void 0!==l?l:y.getInteractive(),Lr);if(p.interactive=!!(C&Lr.SELF),p.interactiveChildren=!!(C&Lr.CHILDREN),null!=t){var S=t.on;if(null!=S)for(var x in S){var D=S[x];D&&p.on(x,D)}}if(p._title=null!==(h=null==t?void 0:t.title)&&void 0!==h?h:y.getTitle(),p._weight=null!==(c=null==t?void 0:t.weight)&&void 0!==c?c:y.getWeight(),p.initReflowable(),p._onShadowUpdateBound=function(){ft.update(p)},null!=t&&(O=t.shadow),void 0===O&&(O=y.getShadow()),O)if(xt(O))switch(O){case"WEAK":p.shadow=y.newShadowWeak();break;case"DEFAULT":p.shadow=y.newShadow()}else p.shadow=O;p.on(cr.over,(function(t){p.onOver(t)})),p.on(cr.out,(function(t){p.onOut(t)})),p.on(cr.down,(function(t){p.onDown(t)})),p.on(cr.up,(function(t){p.onUp(t)})),p.on("added",(function(){p.toParentResized(),(p.isDirty()||p.hasDirty())&&p.toParentHasDirty(),p._isHierarchyDirty&&p.toParentHierarchyDirty();var t=p.parent;t instanceof n&&(p.state.parent=t.state),ft.update(p)})),p.on("removed",(function(){p.blur(!0),p.state.parent=null,ft.update(p)}));var I,A=function(t){if(t){var e=t.shortcut,n=t.shortcuts;if(null!=n||null!=e){var i=[];if(null!=e&&i.push(no.toShortcut(e)),null!=n)for(var r=0,o=n.length;r<o;++r)i.push(no.toShortcut(n[r]));return i}}}(t);if(p._shortcuts=A,null!=A)for(var R=function(t){p.onShortcut(t)},P=0,M=A.length;P<M;++P)no.on(p,A[P],R);if(p.init(t),y.newState(p._state),null!=t){var k=t.state;if(null!=k){var L=p._state;if(xt(k))L.add(k);else if(Ot(k))L.addAll(k);else{var N=k.values;null!=N&&(xt(N)?L.add(N):L.addAll(N));var B=k.blinkers;if(null!=B){var z=L.blinker;for(P=0,M=B.length;P<M;++P){var U=B[P];z.add(U.state,U.interval)}}var j=k.tickers;if(null!=j){var F=L.ticker;for(P=0,M=j.length;P<M;++P){var H=j[P];F.add(H.state,H.interval)}}}}}if(null!=t){var G=t.parent;null!=G&&G.addChild(p)}if(null!=t){var V=t.children;if(null!=V)for(P=0,M=V.length;P<M;++P){var W=V[P];null!=W&&p.addChild(W)}}return null!=t&&(I=t.cursor,p._cursor=I),p.cursor=p.toCursor(I,p._state),p.emit("init",p),p}return F(n,e),n.prototype.newPadding=function(t,e,n){return new Br(t,e,n)},n.prototype.toCursor=function(t,e){if(t)if(Ct(t)){var n=t(e);if(void 0!==n)return n}else if(void 0!==t)return t;return this.theme.getCursor(e)},Object.defineProperty(n.prototype,"snippet",{get:function(){return this._snippet},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"reflowable",{get:function(){return this._reflowable},enumerable:!1,configurable:!0}),n.prototype.initReflowable=function(){new Xr(this)},n.prototype.onChildrenChange=function(){this.toHierarchyDirty(),e.prototype.onChildrenChange.call(this)},n.prototype.onShortcut=function(t){this.emit("shortcut",t,this)},n.prototype.init=function(t){},Object.defineProperty(n.prototype,"weight",{get:function(){return this._weight},set:function(t){this._weight!==t&&(this._weight=t,this.toHierarchyDirty(),ft.update(this))},enumerable:!1,configurable:!0}),n.prototype.onMove=function(t,e,i,r){for(var o=this.children,s=0,a=o.length;s<a;++s){var u=o[s];u instanceof n&&u.onParentMove(t,e,i,r)}ft.update(this),this.emit("move",t,e,i,r,this)},n.prototype.resize=function(t,e){var n=this._width,i=this._height,r=null!=t?t:n,o=null!=e?e:i,s=n!==r,a=i!==o;s&&(this._width=r),a&&(this._height=o);var u,l=s||a;if(l&&this.onResize(r,o,n,i),s&&null!=(u=this._scalarSet).x){var h=this._position,c=this.getParentOfSize();c&&(this._position.x=u.x(c.width,r,c.padding.getLeft(),h.x))}if(a&&null!=(u=this._scalarSet).y){h=this._position;var p=this.getParentOfSize();p&&(this._position.y=u.y(p.height,o,p.padding.getTop(),h.y))}return l},n.prototype.getClearType=function(){return this._clearType},n.prototype.onResize=function(t,e,i,r){this.toDirty(),this.toHierarchyDirty();for(var o=this._padding,s=this.children,a=0,u=s.length;a<u;++a){var l=s[a];l instanceof n&&l.onParentResize(t,e,o)}ft.update(this),this.emit("resize",t,e,i,r,this)},n.prototype.onScale=function(t,e,n,i){ft.update(this),this.emit("scale",t,e,n,i,this)},n.prototype.onSkew=function(t,e,n,i){ft.update(this),this.emit("skew",t,e,n,i,this)},Object.defineProperty(n.prototype,"type",{get:function(){return this.getType()},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"x",{get:function(){return this._position.x},set:function(t){this.setX(t)},enumerable:!1,configurable:!0}),n.prototype.getX=function(){var t=this._scalarSet;return null!=t.x?t.x:this._position.x},n.prototype.setX=function(t){var e=this._scalarSet;if(St(t)){var n=this._position;n.x!==t?(e.x=void 0,n.x=t):void 0!==e.x&&(e.x=void 0,this.toParentResized())}else{var i=eo.position(t);e.x!==i&&(e.x=i,this.toParentResized())}},Object.defineProperty(n.prototype,"y",{get:function(){return this._position.y},set:function(t){this.setY(t)},enumerable:!1,configurable:!0}),n.prototype.getY=function(){var t=this._scalarSet;return null!=t.y?t.y:this._position.y},n.prototype.setY=function(t){var e=this._scalarSet;if(St(t)){var n=this._position;n.y!==t?(e.y=void 0,n.y=t):void 0!==e.y&&(e.y=void 0,this.toParentResized())}else{var i=eo.position(t);e.y!==i&&(e.y=i,this.toParentResized())}},Object.defineProperty(n.prototype,"width",{get:function(){return this._width},set:function(t){this.setWidth(t)},enumerable:!1,configurable:!0}),n.prototype.getWidth=function(){return this._auto.width.toCoordinate(this._scalarSet.width||this._width)},n.prototype.setWidth=function(t){var e=this._auto.width,n=e.isOn,i=e.from(t);if(e.isOn!==n&&(this.toHierarchyDirty(),ft.update(this)),!i){var r=this._scalarSet;if(St(t)){var o=this._width;if(o!==t){r.width=void 0,this._width=t;var s=this._height;if(this.onResize(t,s,o,s),null!=r.x){var a=this._position,u=this.getParentOfSize();u&&(a.x=r.x(u.width,t,u.padding.getLeft(),a.x))}}else void 0!==r.width&&(r.width=void 0,this.toParentResized())}else{var l=eo.size(t);r.width!==l&&(r.width=l,this.toParentResized())}}},Object.defineProperty(n.prototype,"height",{get:function(){return this._height},set:function(t){this.setHeight(t)},enumerable:!1,configurable:!0}),n.prototype.getHeight=function(){return this._auto.height.toCoordinate(this._scalarSet.height||this._height)},n.prototype.setHeight=function(t){var e=this._auto.height,n=e.isOn,i=e.from(t);if(e.isOn!==n&&(this.toHierarchyDirty(),ft.update(this)),!i){var r=this._scalarSet;if(St(t)){var o=this._height;if(o!==t){r.height=void 0,this._height=t;var s=this._width;if(this.onResize(s,t,s,o),null!=r.y){var a=this._position,u=this.getParentOfSize();u&&(a.y=r.y(u.height,t,u.padding.getTop(),a.y))}}else void 0!==r.height&&(r.height=void 0,this.toParentResized())}else{var l=eo.size(t);r.height!==l&&(r.height=l,this.toParentResized())}}},Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"skew",{get:function(){return this._skew},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this._padding},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"corner",{get:function(){return this._corner},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"background",{get:function(){return this._background},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"border",{get:function(){return this._border},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"outline",{get:function(){return this._outline},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"unsafe",{get:function(){return this.transform},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"title",{get:function(){return this._title},set:function(t){this._title!==t&&(this._title=t,this.state.isHovered&&this.applyTitle())},enumerable:!1,configurable:!0}),n.prototype.applyTitle=function(){var t=ft.getLayer(this);t&&(t.view.title=this._title)},n.prototype.show=function(){return this.visible||(this.visible=!0,this.toParentHierarchyDirty(),ft.update(this)),this},n.prototype.isShown=function(){return this.visible},n.prototype.hide=function(){return this.visible&&(this.visible=!1,this.toParentHierarchyDirty(),this.blur(!0),ft.update(this)),this},n.prototype.isHidden=function(){return!this.visible},n.prototype.toDirty=function(){return!this._isDirty&&(this._isDirty=!0,this.toParentHasDirty(),!0)},n.prototype.toHasDirty=function(){return!this._hasDirty&&(this._hasDirty=!0,this.toParentHasDirty(),!0)},n.prototype.toParentHasDirty=function(){var t=this.parent;t instanceof n&&t.toHasDirty()},n.prototype.toHierarchyDirty=function(){return!this._isHierarchyDirty&&(this._isHierarchyDirty=!0,this.onHierarchyDirty(),this.toParentHierarchyDirty(),!0)},n.prototype.toParentHierarchyDirty=function(){var t=this.parent;t instanceof n&&t.toHierarchyDirty()},n.prototype.isHierarchyDirty=function(){return this._isHierarchyDirty},n.prototype.onHierarchyDirty=function(){},n.prototype.isDirty=function(){return this._isDirty},n.prototype.hasDirty=function(){return this._hasDirty},n.prototype.setFocused=function(t){if(this.state.isFocused!==t){var e=ft.getLayer(this);e&&e.getFocusController().set(this,t)}return this},n.prototype.focus=function(){return this.setFocused(!0)},n.prototype.blur=function(t){if(t){var e=ft.getLayer(this);if(e){var i=e.getFocusController().get();if(i instanceof n)for(var r=i;r;){if(r===this){i.setFocused(!1);break}r=r.parent}}}else this.setFocused(!1);return this},n.prototype.onStateChange=function(t,e){var i=this;this.toDirty(),ft.update(this),this.emit("statechange",t,e,this);for(var r=this.children,o=0,s=r.length;o<s;++o){var a=r[o];a instanceof n&&a.state.onParentChange(t,e)}t.isFocused?(e.isFocused||this.onFocus(),t.inDisabled&&!e.inDisabled&&setTimeout((function(){i.blur()}),0)):e.isFocused&&this.onBlur(),this.cursor=this.toCursor(this._cursor,t)},n.prototype.onChildFocus=function(t){var e=this.parent;e instanceof n&&e.onChildFocus(t)},n.prototype.onFocus=function(){var t=this.parent;t instanceof n&&t.onChildFocus(this)},n.prototype.onChildBlur=function(t){var e=this.parent;e instanceof n&&e.onChildBlur(t)},n.prototype.onBlur=function(){var t=this.parent;t instanceof n&&t.onChildBlur(this)},Object.defineProperty(n.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"options",{get:function(){return this._options},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"theme",{get:function(){return this._theme},set:function(t){this._theme!==t&&(this._theme=t,this._padding.setTheme(t),this._background.setTheme(t),this._border.setTheme(t),this._outline.setTheme(t),this._corner.setTheme(t),this.toDirty(),ft.update(this))},enumerable:!1,configurable:!0}),n.prototype.reflow=function(){var t=this._isDirty;t&&(this.onReflow(),this._isDirty=!1);var e=this._hasDirty,i=this._isHierarchyDirty;if(e||i){this._hasDirty=!1,this._isHierarchyDirty=!1;for(var r=this.children,o=0,s=r.length;o<s;++o){var a=r[o];a instanceof n&&a.reflow()}}(t||e||i)&&this.onRefit()},n.prototype.onRefit=function(){var e=this._auto,i=e.width.isOn,r=e.height.isOn;if(i&&r){for(var o=0,s=0,a=0,u=(f=this.children).length;a<u;++a)if((d=f[a]).visible){var l=this.hasRefitableWidth(d),h=this.hasRefitableHeight(d);if(l||h)if(d instanceof n)l&&(o=Math.max(o,d.x+d.width)),h&&(s=Math.max(s,d.y+d.height));else if(d instanceof t.Container){var c=d.getLocalBounds(void 0,!0);l&&(o=Math.max(o,d.x+c.x+c.width)),h&&(s=Math.max(s,d.y+c.y+c.height))}else c=d.getLocalBounds(),l&&(o=Math.max(o,d.x+c.x+c.width)),h&&(s=Math.max(s,d.y+c.y+c.height))}var p=this.padding;this.resize(o+p.getRight(),s+p.getBottom())}else if(i){for(o=0,a=0,u=(f=this.children).length;a<u;++a)(d=f[a]).visible&&this.hasRefitableWidth(d)&&(d instanceof n?o=Math.max(o,d.x+d.width):d instanceof t.Container?(c=d.getLocalBounds(void 0,!0),o=Math.max(o,d.x+c.x+c.width)):(c=d.getLocalBounds(),o=Math.max(o,d.x+c.x+c.width)));this.resize(o+this.padding.getRight(),void 0)}else if(r){var f;for(s=0,a=0,u=(f=this.children).length;a<u;++a){var d;(d=f[a]).visible&&this.hasRefitableHeight(d)&&(d instanceof n?s=Math.max(s,d.y+d.height):d instanceof t.Container?(c=d.getLocalBounds(void 0,!0),s=Math.max(s,d.y+c.y+c.height)):(c=d.getLocalBounds(),s=Math.max(s,d.y+c.y+c.height)))}this.resize(void 0,s+this.padding.getBottom())}},n.prototype.isRefitable=function(t){return t instanceof n},n.prototype.hasRefitableHeight=function(t){return this.isRefitable(t)&&!(t instanceof n&&Ct(t.getHeight()))},n.prototype.hasRefitableWidth=function(t){return this.isRefitable(t)&&!(t instanceof n&&Ct(t.getWidth()))},n.prototype.onReflow=function(){this._reflowable.onReflow(this,this._width,this._height)},Object.defineProperty(n.prototype,"shadow",{get:function(){return this._shadow},set:function(t){var e=this._shadow;if(e!==t){var n=this._reflowable,i=this._snippet,r=this._onShadowUpdateBound;null!=e&&(e.off("update",r),n.remove(e),i.remove(e,!0)),this._shadow=t,null!=t&&(t.on("update",r),n.add(t),i.addAt(t,!0,0)),ft.update(this)}},enumerable:!1,configurable:!0}),n.prototype.toParentResized=function(){var t=this.getParentOfSize();t&&this.onParentResize(t.width,t.height,t.padding)},n.prototype.getParentOfSize=function(){var t=this.parent;return t instanceof n?t:ft.getLayer(this)},n.prototype.onParentResize=function(t,e,n){var i=this._scalarSet,r=this.transform.position,o=r.x,s=r.y,a=this._width,u=this._height,l=n.getLeft()+n.getRight(),h=n.getTop()+n.getBottom(),c=null!=i.width?i.width(t,a,l,a):a,p=null!=i.height?i.height(e,u,h,u):u;this.resize(c,p);var f=null!=i.x?i.x(t,this._width,n.getLeft(),o):o,d=null!=i.y?i.y(e,this._height,n.getTop(),s):s;this.position.set(f,d)},n.prototype.onParentMove=function(t,e,n,i){},n.prototype.onWheel=function(t,e,n){return this.emit("wheel",t,e,n,this),!1},n.prototype.onKeyDown=function(t){return this.emit("keydown",t,this),!1},n.prototype.onKeyUp=function(t){return this.emit("keyup",t,this),!1},n.prototype.isEventTarget=function(t){var e=t.target;if(e===this)return!0;if(null!=e&&!(e instanceof n&&e.interactive)){for(var i=e.parent;null!=i&&!(i instanceof n&&i.interactive);)i=i.parent;return i===this}return!1},n.prototype.onDown=function(t){this.isEventTarget(t)&&this.onDownThis(t),this.emit("down",t,this)},n.prototype.onDownThis=function(e){var n;"touches"in e.data.originalEvent?(null!==(n=this._lastDownPoint)&&void 0!==n?n:this._lastDownPoint=new t.Point).copyFrom(e.data.global):this.focusOnClosest()},n.prototype.onUp=function(t){this.isEventTarget(t)&&this.onUpThis(t),this.emit("up",t,this)},n.prototype.onUpThis=function(t){if("touches"in t.data.originalEvent){var e=this._lastDownPoint;if(e){var n=t.data.global,i=Math.abs(n.x-e.x),r=Math.abs(n.y-e.y),o=cr.CLICK_DISTANCE_THRESHOLD;i<o&&r<o&&this.focusOnClosest()}}},n.prototype.focusOnClosest=function(){var t=ft.getLayer(this);if(t){var e=t.getFocusController();e.focus(e.findParent(this))}},n.prototype.onOver=function(t){this.state.isHovered=!0,t.target===this&&this.applyTitle(),this.emit("over",t,this)},n.prototype.onOut=function(t){this.state.isHovered=!1,this.emit("out",t,this)},n.prototype.onDblClick=function(t,e){return this.emit("dblclick",t,e,this),!1},n.prototype.render=function(t){if(this.visible&&0<this.worldAlpha&&this.renderable){var n=this._snippet;n.render(t,!0),e.prototype.render.call(this,t),n.render(t,!1)}},n.prototype.updateTransform=function(){e.prototype.updateTransform.call(this),this._snippet.updateTransform()},n.prototype.getThemeDefault=function(){return it.getInstance().get(this.getType())},n.prototype.getType=function(){return"DBase"},n.prototype._calculateBounds=function(){this._bounds.addFrame(this.transform,0,0,this._width,this._height),e.prototype._calculateBounds.call(this)},n.prototype.containsPoint=function(t){return this.containsGlobalPoint(t)||this.containsLocalPoint(this.worldTransform.applyInverse(t,n.WORK_CONTAINS_POINT))},n.prototype.containsGlobalPoint=function(t){return!1},n.prototype.containsLocalPoint=function(t){var e=t.x,n=t.y,i=this._width,r=this._height;return 0<=e&&e<=i&&0<=n&&n<=r},n.prototype.getClippingRect=function(t,e){e.x=0,e.y=0,e.width=this._width,e.height=this._height},n.prototype.destroy=function(){var t=this._scalarSet;t.x=null,t.y=null,t.width=null,t.height=null;var n=this._shadow;n&&(this._shadow=null,n.destroy());for(var i=this.children,r=i.length-1;0<=r;--r)i[r].destroy();i.length=0,e.prototype.destroy.call(this)},n.WORK_CONTAINS_POINT=new t.Point,n}(t.Container),uo=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n._isInitialized=!1,n._width=0,n._height=0,n._cornderRadius=0,n._cornerMask=Mr.NONE,n}return F(e,t),e.prototype.render=function(e){this.updateTransform(),t.prototype.render.call(this,e)},e.prototype.onReflow=function(t,e,n){var i=t.corner,r=Math.max(0,i.getRadius()-.5),o=i.getMask();if(!this._isInitialized||this._width!==e||this._height!==n||this._cornderRadius!==r||this._cornerMask!==o){this._isInitialized=!0,this._width=e,this._height=n,this._cornderRadius=r,this._cornerMask=o;var s=o&Mr.TOP_LEFT?0:r,a=o&Mr.TOP_RIGHT?0:r,u=o&Mr.BOTTOM_LEFT?0:r,l=o&Mr.BOTTOM_RIGHT?0:r;this.clear(),this.beginFill(16777215,1),this.lineStyle(0,0,0,0,!1),s<=0&&a<=0&&u<=0&&l<=0?this.drawRect(0,0,e,n):(this.moveTo(0+s,0),0<a?this.arcTo(0+e,0,0+e,0+n,a):this.lineTo(0+e,0),0<l?this.arcTo(0+e,0+n,0,0+n,l):this.lineTo(0+e,0+n),0<u?this.arcTo(0,0+n,0,0,u):this.lineTo(0,0+n),0<s?this.arcTo(0,0,0+e,0,s):this.lineTo(0,0)),this.endFill()}},e}(t.Graphics),lo={OFF:0,ON:1,TOUCH:2},ho=function(){function e(e,n,i,r,o,s){var a,u,l=this;this._owner=e,this._parent=i,this._constraint=r;var h=ai(null!==(a=null==s?void 0:s.mode)&&void 0!==a?a:o.getGestureMode(),lo),c=ai(null!==(u=null==s?void 0:s.modifier)&&void 0!==u?u:o.getGestureModifier(),lr);if(h===lo.ON||h===lo.TOUCH){var p=new t.Point;this._gestureUtil=new _r({touch:h===lo.TOUCH,modifier:c,checker:s&&s.checker,easing:{duration:null==s?void 0:s.duration},on:{start:function(t){l.onStart(t)},move:function(t,i,r,o,s,a){l.onGestureMove(n(e),i,r,o,s,a,p)},easing:{end:function(t){l.onEnd(t)}},stop:function(t){l.onStop(t)},tap:function(t,e){l.onTap(t,e)},longpress:function(t,e){l.onLongPress(t,e)}}})}}return e.prototype.onStart=function(t){var e=this._parent;e.stop(),e.emit("gesturestart",t,e)},e.prototype.onEnd=function(t){var e=this._parent;e.emit("gestureend",t,e)},e.prototype.onStop=function(t){var e=this._parent;e.emit("gesturestop",t,e)},e.prototype.onTap=function(t,e){var n=this._parent;n.emit("gesturetap",t,e,n)},e.prototype.onLongPress=function(t,e){var n=this._parent;n.emit("gesturelongpress",t,e,n)},e.prototype.onGestureMove=function(t,e,n,i,r,o,s){if(null!=t){var a=this._parent,u=t.scale,l=u.x,h=u.y,c=a.toNormalizedScale(l*o),p=a.toNormalizedScale(h*o),f=c/l,d=p/h,y=o<1?Math.max(f,d):Math.min(f,d);c=y*l,p=y*h;var g=t.parent;null!=g&&(g.toLocal(s.set(i,r),void 0,s),i=s.x,r=s.y);var v=i-e,_=r-n,m=t.position,b=(m.x-v)*y+i,T=(m.y-_)*y+r;this._constraint(t,b,T,c,p)}},e.prototype.stop=function(){var t;null===(t=this._gestureUtil)||void 0===t||t.stop(this._owner)},e.prototype.onDown=function(t){var e;null===(e=this._gestureUtil)||void 0===e||e.onDown(this._owner,t)},e}(),co=function(){function t(t,e,n,i,r){var o=this;this._owner=t,this._toTarget=e,this._constraint=i,this._newScaleX=1,this._newScaleY=1,this._newX=0,this._newY=0,this._oldScaleX=1,this._oldScaleY=1,this._oldX=0,this._oldY=0,this._isStarted=!1,this._animation=new dr({onStart:function(){o.onStart()},onTime:function(t){o.onTime(t)},onEnd:function(){o.onEnd()},onStop:function(){o.onStop()},duration:r}),this._parent=n,this._duration=r}return t.prototype.onStart=function(){var t=this._parent;t.emit("transformstart",this._owner,t)},t.prototype.onTime=function(t){var e=1-t,n=t,i=this._oldScaleX*e+this._newScaleX*n,r=this._oldScaleY*e+this._newScaleY*n,o=this._oldX*e+this._newX*n,s=this._oldY*e+this._newY*n,a=this._toTarget(this._owner);null!=a&&this._constraint(a,o,s,i,r)},t.prototype.onEnd=function(){var t=this._parent;t.emit("transformend",this._owner,t)},t.prototype.onStop=function(){var t=this._parent;t.emit("transformstop",this._owner,t)},t.prototype.start=function(t,e,n,i,r,o,s){var a=this._parent;if(!1!==s&&a.stop(),null==o&&(o=this._duration),o<=0)this.onStart(),this._constraint(t,e,n,i,r),this.onEnd();else{var u=t.position,l=t.scale;this._oldX=u.x,this._oldY=u.y,this._oldScaleX=l.x,this._oldScaleY=l.y,this._newX=e,this._newY=n,this._newScaleX=i,this._newScaleY=r,this._animation.duration=o,this._animation.start()}},t.prototype.stop=function(){this._animation.stop()},t}(),po=function(e){function n(i,r,o){var s,a,u,l,h,c,p,f,d,y,g,v,_,m,b,T,w,E=e.call(this)||this;E._parent=i,E._toTarget=r,E._constraint=o&&o.constraint||n.CONSTRAINT,E._workRect=new t.Rectangle;var O=E.toTheme(o)||E.getThemeDefault(),C=null==o?void 0:o.zoom;E._zoomPoint=new t.Point,E._zoomMin=null!==(s=null==C?void 0:C.min)&&void 0!==s?s:O.getZoomMin(),E._zoomMax=null!==(a=null==C?void 0:C.max)&&void 0!==a?a:O.getZoomMax(),E._zoomKeepRatio=null!==(u=null==C?void 0:C.keepRatio)&&void 0!==u?u:O.getZoomKeepRatio();var S=null==C?void 0:C.wheel;E._isWheelZoomEnabled=null!==(l=null==S?void 0:S.enable)&&void 0!==l?l:O.isWheelZoomEnabled(),E._wheelZoomSpeed=null!==(h=null==S?void 0:S.speed)&&void 0!==h?h:O.getWheelZoomSpeed(),E._wheelZoomModifier=ai(null!==(c=null==S?void 0:S.modifier)&&void 0!==c?c:O.getWheelZoomModifier(),lr),E._wheelZoomChecker=null!==(p=null==S?void 0:S.checker)&&void 0!==p?p:hr.match;var x=null==C?void 0:C.dblclick;E._isDblClickZoomEnabled=null!==(f=null==x?void 0:x.enable)&&void 0!==f?f:O.isDblClickZoomEnabled(),E._dblClickZoomSpeed=null!==(d=null==x?void 0:x.amount)&&void 0!==d?d:O.getDblClickZoomSpeed(),E._dblClickZoomModifier=ai(null!==(y=null==x?void 0:x.modifier)&&void 0!==y?y:O.getDblClickZoomModifier(),lr),E._dblClickZoomChecker=null!==(g=null==x?void 0:x.checker)&&void 0!==g?g:hr.match,E._dblclickZoomDuration=null!==(v=null==x?void 0:x.duration)&&void 0!==v?v:O.getDblClickZoomDuration();var D=null===(_=null==o?void 0:o.translation)||void 0===_?void 0:_.wheel;if(E._isWheelTranslationEnabled=null!==(m=null==D?void 0:D.enable)&&void 0!==m?m:O.isWheelTranslationEnabled(),E._wheelTranslationSpeed=null!==(b=null==D?void 0:D.speed)&&void 0!==b?b:O.getWheelTranslationSpeed(),E._wheelTranslationModifier=ai(null!==(T=null==D?void 0:D.modifier)&&void 0!==T?T:O.getWheelTranslationModifier(),lr),E._wheelTranslationChecker=null!==(w=null==D?void 0:D.checker)&&void 0!==w?w:hr.match,E._gesture=new ho(i,r,E,E._constraint,O,null==o?void 0:o.gesture),E._transform=new co(i,r,E,E._constraint,E._dblclickZoomDuration),null!=o){var I=o.on;if(null!=I)for(var A in I){var R=I[A];R&&E.on(A,R)}}return E}return F(n,e),Object.defineProperty(n.prototype,"gesture",{get:function(){return this._gesture},enumerable:!1,configurable:!0}),n.prototype.stop=function(){this._gesture.stop(),this._transform.stop()},n.prototype.reset=function(t,e){var n=this._parent,i=this._toTarget(n);if(i){var r=n.padding,o=r.getLeft(),s=r.getTop(),a=r.getRight(),u=r.getBottom(),l=n.width-o-a,h=n.height-s-u,c=i.getLocalBounds(this._workRect),p=c.x,f=c.y,d=o+.5*(l-c.width)-p,y=s+.5*(h-c.height)-f;this._transform.start(i,d,y,1,1,t,e)}},n.prototype.fit=function(t,e){var n=this._parent,i=this._toTarget(n);if(i){var r=n.padding,o=r.getLeft(),s=r.getTop(),a=r.getRight(),u=r.getBottom(),l=n.width-o-a,h=n.height-s-u,c=i.getLocalBounds(this._workRect),p=c.x,f=c.y,d=c.width,y=c.height,g=l/d,v=h/y;if(this._zoomKeepRatio){var _=this.toNormalizedScale(Math.min(g,v));g=_,v=_}else g=this.toNormalizedScale(g),v=this.toNormalizedScale(v);var m=o+.5*(l-d*g)-p*g,b=s+.5*(h-y*v)-f*v;this._transform.start(i,m,b,g,v,t,e)}},n.prototype.zoomIn=function(t,e){var n=this._toTarget(this._parent);if(n){var i=this._dblClickZoomSpeed,r=n.scale;this.zoom(r.x*i,r.y*i,t,e)}},n.prototype.zoomOut=function(t,e){var n=this._toTarget(this._parent);if(n){var i=1/this._dblClickZoomSpeed,r=n.scale;this.zoom(r.x*i,r.y*i,t,e)}},n.prototype.zoomAt=function(t,e,n,i,r,o){var s=this._toTarget(this._parent);if(s){var a=s.scale.x,u=s.scale.y,l=this.toNormalizedScale(n),h=this.toNormalizedScale(i),c=l/a,p=h/u,f=(s.position.x-t)*c+t,d=(s.position.y-e)*p+e;this._transform.start(s,f,d,l,h,r,o)}},n.prototype.zoomAtGlobal=function(t,e,n,i,r,o){var s=this._zoomPoint;s.set(t,e),this.toLocal(s,s),this.zoomAt(s.x,s.y,n,i,r,o)},n.prototype.zoom=function(t,e,n,i){var r=this._parent;this.zoomAt(.5*r.width,.5*r.height,t,e,n,i)},Object.defineProperty(n.prototype,"scale",{get:function(){var e=this._toTarget(this._parent);return e?e.scale:new t.Point(1,1)},set:function(t){var e=this._toTarget(this._parent);if(e){var n=this.toNormalizedScale(t.x),i=this.toNormalizedScale(t.y),r=e.position;this._constraint(e,r.x,r.y,n,i)}},enumerable:!1,configurable:!0}),n.prototype.moveTo=function(t,e,n,i){var r=this._toTarget(this._parent);if(r){var o=r.scale;this._transform.start(r,t,e,o.x,o.y,n,i)}},Object.defineProperty(n.prototype,"position",{get:function(){var e=this._toTarget(this._parent);return e?e.position:new t.Point(0,0)},set:function(t){var e=this._toTarget(this._parent);if(e){var n=e.scale;this._constraint(e,t.x,t.y,n.x,n.y)}},enumerable:!1,configurable:!0}),n.prototype.transform=function(t,e,n,i,r,o){var s=this._toTarget(this._parent);s&&this._transform.start(s,t,e,n,i,r,o)},n.prototype.toLocal=function(t,e,n){return this._parent.toLocal(t,void 0,e,n)},n.prototype.toGlobal=function(t,e,n){return this._parent.toGlobal(t,e,n)},n.prototype.toNormalizedScale=function(t){return Math.min(this._zoomMax,Math.max(this._zoomMin,t))},n.prototype.onWheel=function(t,e,n){var i;if(this._isWheelZoomEnabled&&this._wheelZoomChecker(t,this._wheelZoomModifier,this._parent)&&0!==e.deltaY&&(i=this._toTarget(this._parent))){var r=e.lowest*this._wheelZoomSpeed,o=1+e.deltaY*r,s=i.scale;return this.zoomAtGlobal(n.x,n.y,s.x*o,s.y*o,0),!0}if(this._isWheelTranslationEnabled&&this._wheelTranslationChecker(t,this._wheelTranslationModifier,this._parent)&&(i=this._toTarget(this._parent))){this.stop(),this.emit("wheeltranslationstart",this._parent,this),r=e.lowest*this._wheelTranslationSpeed;var a=i.position,u=a.x-e.deltaX*r,l=a.y+e.deltaY*r;return s=i.scale,this._constraint(i,u,l,s.x,s.y),this.emit("wheeltranslationend",this._parent,this),!0}return!1},n.prototype.onDown=function(t){this._gesture.onDown(t)},n.prototype.onDblClick=function(t,e){if(this._isDblClickZoomEnabled&&this._dblClickZoomChecker(t,this._dblClickZoomModifier,this._parent)){var n=this._toTarget(this._parent);if(n){var i=this._zoomPoint;cr.toGlobal(t,e,i);var r=this._dblClickZoomSpeed,o=n.scale;return this.zoomAtGlobal(i.x,i.y,o.x*r,o.y*r,this._dblclickZoomDuration),!0}}return!1},n.prototype.toTheme=function(t){if(t&&t.theme){var e=t.theme;return xt(e)?it.getInstance().get(e):e}return null},n.prototype.getThemeDefault=function(){return it.getInstance().get(this.getType())},n.prototype.getType=function(){return"DView"},n.CONSTRAINT=function(t,e,n,i,r){t.scale.set(i,r),t.position.set(e,n)},n}(t.utils.EventEmitter),fo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){var n,i=this;t.prototype.init.call(this,e),this._canvas=null;var r=this.theme;this._view=new po(this,(function(){return i._canvas}),null==e?void 0:e.view);var o=null==e?void 0:e.canvas;o&&(this.canvas=o),(null!==(n=null==e?void 0:e.mask)&&void 0!==n?n:r.isOverflowMaskEnabled())&&(this.mask=this.getOverflowMask())},e.prototype.getType=function(){return"DCanvasContainer"},e.prototype.onResize=function(e,n,i,r){t.prototype.onResize.call(this,e,n,i,r),this.updateContentSize(e,n,i,r)},Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},set:function(t){var e=this._canvas;null!=e&&(this._canvas=null,this.removeChild(e),this.emit("unset",e,this),e.destroy()),this._canvas=t,null!=t?(this.addChild(t),this._view.reset(0),this.emit("set",t,this)):ft.update(this)},enumerable:!1,configurable:!0}),e.prototype.getOverflowMask=function(){return null==this._overflowMask&&(this._overflowMask=new uo(this),this._reflowable.add(this._overflowMask),this.toDirty()),this._overflowMask},e.prototype.updateContentSize=function(t,e,n,i){var r=this._canvas;if(null!=r){var o=r.x+.5*(t-n),s=r.y+.5*(e-i);r.position.set(o,s)}},Object.defineProperty(e.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),e.prototype.onWheel=function(e,n,i){var r=this._view.onWheel(e,n,i),o=t.prototype.onWheel.call(this,e,n,i);return r||o},e.prototype.onDblClick=function(e,n,i){if(!0!==i){var r=this._view.onDblClick(e,n),o=t.prototype.onDblClick.call(this,e,n);return r||o}return t.prototype.onDblClick.call(this,e,n)},e.prototype.onDown=function(e,n){!0!==n&&this._view.onDown(e),t.prototype.onDown.call(this,e)},e.prototype.destroy=function(){var e=this._overflowMask;null!=e&&(this._overflowMask=null,e.destroy()),this.mask=null,t.prototype.destroy.call(this)},e}(ao),yo=function(){function t(t,e){var n=document.createElement("canvas");this._element=n;var i=this._element.getContext("2d",{willReadFrequently:!0});this._context=i,n.width=t,n.height=e}return Object.defineProperty(t.prototype,"element",{get:function(){var t=this._element;if(null!=t)return t;throw new Error("No Element Available")},enumerable:!1,configurable:!0}),t.prototype.getElement=function(){return this._element},Object.defineProperty(t.prototype,"canvas",{get:function(){return this.element},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){var t=this._context;if(null!=t)return t;throw new Error("No Context Available")},enumerable:!1,configurable:!0}),t.prototype.getContext=function(){return this._context},Object.defineProperty(t.prototype,"resolution",{get:function(){return 1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var t=this._element;return null!=t?t.width:0},set:function(t){var e=this._element;null!=e&&(e.width=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var t=this._element;return null!=t?t.height:0},set:function(t){var e=this._element;null!=e&&(e.height=t)},enumerable:!1,configurable:!0}),t.prototype.clear=function(){var t=this._element,e=this._context;null!=t&&null!=e&&(e.setTransform(1,0,0,1,0,0),e.clearRect(0,0,t.width,t.height))},t.prototype.resize=function(t,e){var n=this._element;null!=n&&(n.width=t,n.height=e)},t.prototype.destroy=function(){this._context=null,this._element=null},t}(),go=function(){function e(){}return e.toTexture=function(e,n,i,r){var o=e.transform.scale,s=Math.max(1,Math.ceil(e.width*o.x)),a=Math.max(1,Math.ceil(e.height*o.y)),u=t.RenderTexture.create({width:s,height:a,scaleMode:t.SCALE_MODES.LINEAR,resolution:n}),l=new t.Matrix(void 0,void 0,void 0,void 0,-e.position.x,-e.position.y),h=ft.getLayer(e);return h&&h.renderer.render(e,u,i,l,r),u},e.toPixels=function(t,e){var n=t.baseTexture,i=n.realWidth,r=n.realHeight,o=t.resolution,s=t.frame,a=Math.floor(s.x*o),u=Math.floor(s.y*o),l=Math.floor((s.x+s.width)*o),h=Math.floor((s.y+s.height)*o),c=Math.min(l-a,i),p=Math.min(h-u,r),f=new Uint8Array(4*c*p);if(0<c&&0<p){var d=e.renderTexture.current;e.renderTexture.bind(t);var y=e.gl;y.readPixels(a,u,c,p,y.RGBA,y.UNSIGNED_BYTE,f),e.renderTexture.bind(d)}return{width:c,height:p,array:f}},e.toCanvas=function(e,n,i,r){var o=e.width,s=e.height,a=e.array;if(null==r?r=new yo(o,s):r.resize(o,s),o<=0||s<=0)return r;var u=r.getContext(),l=r.getElement();if(null==u||null==l)return r;var h=u.getImageData(0,0,o,s);if(i?h.data.set(a):t.Extract.arrayPostDivide(a,h.data),u.putImageData(h,0,0),null!=n&&1!==n){u.scale(n,n),u.drawImage(l,0,0);var c=Math.floor(o*n),p=Math.floor(s*n),f=u.getImageData(0,0,c,p);r.resize(c,p),u.putImageData(f,0,0)}return r},e.toBase64=function(t,e,n){return t.toDataURL(e,n)},e}(),vo=function(){function t(){}return t.downloadUrl=function(t,e){var n=document.createElement("a");"download"in n?(n.href=e,n.setAttribute("download",t),n.style.display="none",document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n)}),66)):window.open(e)||(location.href=e)},t.download=function(t,e,n){var i=new Blob(!1!==n?["\ufeff",e]:[e],{type:"text/plain"}),r=window.navigator;"msSaveBlob"in r?r.msSaveBlob(i,t):this.downloadUrl(t,URL.createObjectURL(i))},t}(),_o=function(t){var e,n=t.target,i=t.resolution;if(null!=i){if(St(i))return i;var r=n.transform.scale,o=Math.max(n.width*r.x,n.height*r.y);return Math.min(1,i.size/o)}return null!==(e=window.devicePixelRatio)&&void 0!==e?e:1},mo=function(t,e){var n=e.scale;if(null!=n){if(St(n))return n;var i=n.size;return Math.min(1,i/t.width,i/t.height)}},bo=function(){function e(){}return e.texture=function(t){var e,n=t.target,i=_o(t),r=null===(e=t.transform)||void 0===e?void 0:e.update;return go.toTexture(n,i,t.clear,r)},e.pixels=function(n){var i,r=function(t){var e=t.renderer;if(e)return e;var n=t.application;if(n)return n.getLayerBase().renderer;var i=t.layer||ft.getLayer(t.target);if(i)return i.renderer;throw new Error("No renderer / application / layer found.")}(n),o=n.target,s=o.transform.scale,a=Math.ceil(o.width*s.x),u=Math.ceil(o.height*s.y);if(a<=0||u<=0)return{width:a,height:u,array:new Uint8Array(0)};var l=_o(n),h=e.WORK_RENDER_TEXTURE;if(null==h)h=t.RenderTexture.create({width:a,height:u,scaleMode:t.SCALE_MODES.LINEAR,resolution:l}),e.WORK_RENDER_TEXTURE=h;else{var c=h.baseTexture,p=c.width,f=c.height,d=p<a,y=f<u,g=h.resolution!==l;(g||d||y)&&(g&&(c.resolution=l),h.resize(Math.max(a,p),Math.max(u,f),!0))}var v=h.frame;0===v.x&&0===v.y&&v.width===a&&v.height===u||(v.x=0,v.y=0,v.width=a,v.height=u,h.frame=v);var _=o.position,m=new t.Matrix(1,0,0,1,-_.x,-_.y);return r.render(o,h,n.clear,m,null===(i=n.transform)||void 0===i?void 0:i.update),go.toPixels(h,r)},e.canvas=function(t){var e,n,i=this.pixels(t),r=null===(n=null===(e=t.alpha)||void 0===e?void 0:e.premultiplied)||void 0===n?void 0:n.ignore,o=mo(i,t);return go.toCanvas(i,o,r)},e.base64=function(t){var e,n,i,r=this.pixels(t),o=null===(n=null===(e=t.alpha)||void 0===e?void 0:e.premultiplied)||void 0===n?void 0:n.ignore,s=mo(r,t),a=null!==(i=this.WORK_CANVAS)&&void 0!==i?i:this.WORK_CANVAS=new yo(r.width,r.height);go.toCanvas(r,s,o,a);var u=a.getElement();return null!=u?go.toBase64(u,t.format,t.quality):"data:,"},e.file=function(t){vo.downloadUrl(t.filename,this.base64(t))},e.destroy=function(){var t=this.WORK_RENDER_TEXTURE;null!=t&&(this.WORK_RENDER_TEXTURE=void 0,t.destroy(!0));var e=this.WORK_CANVAS;null!=e&&(this.WORK_CANVAS=void 0,e.destroy())},e}(),To=function(t){function e(e,n){var i=t.call(this)||this;i._parent=e;var r=null==n?void 0:n.on;if(r)for(var o in r){var s=r[o];s&&i.on(o,s)}return i}return F(e,t),e.prototype.createAsUrl=function(t){return null==t||St(t)?this.create({size:t,extractor:function(t){return bo.base64({target:t})}}):this.create({size:t.size,cleanup:t.cleanup,extractor:function(t){return bo.base64({target:t})}})},e.prototype.createAsFile=function(t,e){xt(t)?this.create({extractor:function(e){bo.file({target:e,filename:t})}}):null===t||St(t)?this.create({size:t,extractor:function(t){bo.file({target:t,filename:e})}}):this.create({size:t.size,cleanup:t.cleanup,extractor:function(e){bo.file({target:e,filename:t.filename})}})},e.prototype.toScale=function(t,e){return null==t?1:t/ft.getResolution(e)/Math.max(e.width,e.height)},e.prototype.toCleanupSnap=function(t){if(null==t)return!0;var e=t.cleanup;return null==e||!0===e||!1!==e&&!1!==e.snap},e.prototype.toCleanupBackground=function(t){if(null==t)return!1;var e=t.cleanup;return null!=e&&!1!==e&&(!0===e||!0===e.background)},e.prototype.toCleanupReflow=function(t){if(null==t)return!0;var e=t.cleanup;return null==e||!0===e||!1!==e&&!1!==e.reflow},e.prototype.create=function(t){var e=this._parent,n=e.canvas;if(n){var i=e.view,r=i.position,o=i.scale,s=r.x,a=r.y,u=o.x,l=o.y,h=this.toScale(t.size,n);i.transform(0,0,h,h,0);var c=void 0;if(this.toCleanupSnap(t)&&"snap"in n){var p=n.snap;null!=p&&((c=p.container).renderable?c.renderable=!1:c=void 0)}var f=void 0;if(this.toCleanupBackground(t)&&((f=n.snippet).renderable?f.renderable=!1:f=void 0),this.toCleanupReflow(t)){var d=ft.getLayer(n);d&&d.reflow()}this.emit("taking",n,this);var y=t.extractor(n);return this.emit("took",n,null,this),f&&(f.renderable=!0),null!=c&&(c.renderable=!0),i.transform(s,a,u,l,0),y}},e}(t.utils.EventEmitter),wo=function(t){function e(e){var n,i=t.call(this,e)||this;return i._serialized=null,i._tileFactory=null==e?void 0:e.tile,i._controller=null==e?void 0:e.controller,i._isAmbient=null!==(n=null==e?void 0:e.ambient)&&void 0!==n?n:i.theme.isAmbient(),i._snapshot=new To(i,null==e?void 0:e.snapshot),i._mode=i.toMode(e),i}return F(e,t),Object.defineProperty(e.prototype,"snapshot",{get:function(){return this._snapshot},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"controller",{get:function(){return this._controller||null},enumerable:!1,configurable:!0}),e.prototype.set=function(t){var e=this,n=this._serialized;if(n!==t){if(n&&(this._serialized=null,this.canvas&&(this.canvas=null),this.onUnset()),this._serialized=t,t){var i=this.newCanvas(t),r=t.pieces,o=this._mode,s=Dr.toPieceData(this._controller,r,o).then((function(n){return e.newLayer(t,i,o,r,n)}));return this.onSet(t,i),this.canvas=i,s}return Promise.resolve(null)}return Promise.resolve(this.canvas)},e.prototype.onSet=function(t,e){},e.prototype.newLayer=function(t,e,n,i,r){var o=this,s=new Fn(t,i,r,n,0),a=Dr.newLayer(t,e.layer,s).then((function(t){return o.initLayer(e,t)}));if(this._isAmbient){var u=this.toCanvasBaseBackgroundOptions(t,this.theme,!1);this.background.color=u.color,this.background.alpha=u.alpha}return a},e.prototype.initLayer=function(t,e,n){return t.layer.init(),t.initialize(e,n),ft.update(this),this.emit("ready",this),t},e.prototype.toCanvasBaseOptions=function(t){var e,n=this.theme,i=this._isAmbient;return{name:t.name,label:t.label,width:t.width,height:t.height,category:t.category,summary:t.summary,description:t.description,background:this.toCanvasBaseBackgroundOptions(t,n,i),border:i?{color:null}:void 0,outline:i?{color:null}:void 0,shadow:i?null:n.getCanvasShadow(),tile:{factory:this._tileFactory,mapping:null===(e=t.tile)||void 0===e?void 0:e.mapping},ambient:i}},e.prototype.toCanvasBaseBackgroundOptions=function(t,e,n){var i,r;if(n)return{color:null};var o=t.background;return{color:null!==(i=null==o?void 0:o.color)&&void 0!==i?i:e.getCanvasBackgroundColor(),alpha:null!==(r=null==o?void 0:o.alpha)&&void 0!==r?r:e.getCanvasBackgroundAlpha()}},e.prototype.onUnset=function(){},e.prototype.get=function(){return this._serialized},Object.defineProperty(e.prototype,"layer",{get:function(){var t=this.canvas;return t?t.layer.active:null},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DDiagramBase"},e}(fo),Eo=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DCanvas"},e}(ao),Oo=function(){function t(t,e){this._target=t,this._base=e}return t.prototype.getTheme=function(){return this._target.getTheme()},t.prototype.setTheme=function(t){this._target.setTheme(t)},t.prototype.getBaseColor=function(){return this._base},t.prototype.setBaseColor=function(t){this._base=t},t.prototype.getColor=function(t){var e=this._target,n=this._base,i=e.getColor(t);return null!=n?null!=i?ve.blend(n,i,e.getAlpha(t)):n:i},Object.defineProperty(t.prototype,"color",{get:function(){return this._target.color},set:function(t){this._target.color=t},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){return null!=this._base?1:this._target.getAlpha(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._target.alpha},set:function(t){this._target.alpha=t},enumerable:!1,configurable:!0}),t}(),Co=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),Object.defineProperty(e.prototype,"lon",{get:function(){return this.x},set:function(t){this.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lat",{get:function(){return this.y},set:function(t){this.y=t},enumerable:!1,configurable:!0}),e.prototype.toObject=function(){return{lon:this.x,lat:this.y}},e}(t.ObservablePoint),So=function(){function t(t,e,n,i,r,o){if(this._cb=t,!0===e||!1===e)this._enable=e,this._from=new Co(t,null,n,i),this._to=new Co(t,null,r,o);else if(null!=e){this._enable=e.enable;var s=e.from,a=e.to;this._from=new Co(t,null,s.lon,s.lat),this._to=new Co(t,null,a.lon,a.lat)}else this._enable=!1,this._from=new Co(t,null,-180,85.05112877980659),this._to=new Co(t,null,180,-85.05112877980659)}return Object.defineProperty(t.prototype,"enable",{get:function(){return this._enable},set:function(t){this._enable!==t&&(this._enable=t,this._cb())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"from",{get:function(){return this._from},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this._to},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return{enable:this._enable,from:this._from.toObject(),to:this._to.toObject()}},t}(),xo=function(){function t(t,e){var n=this;this._canvas=t,this._factory=null==e?void 0:e.factory,this._mapping=new So((function(){n.onMappingChange()}),null==e?void 0:e.mapping)}return t.prototype.init=function(){this.onMappingChange()},t.prototype.onMappingChange=function(){var t=this._factory;if(t){var e,n=this._mapping;n.enable?(e=this._pyramid)?e.mapping=n:this._pyramid=t(this._canvas).fit():(e=this._pyramid)&&(this._pyramid=void 0,e.destroy())}},Object.defineProperty(t.prototype,"pyramid",{get:function(){return this._pyramid},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"factory",{get:function(){return this._factory},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mapping",{get:function(){return this._mapping},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return{mapping:this._mapping.serialize()}},t.prototype.destroy=function(){var t=this._pyramid;null!=t&&(this._pyramid=void 0,t.destroy())},t}(),Do=function(){function t(t){var e=t.transform,n=e.position;this.x=n.x,this.y=n.y;var i=t.size;this.sizeX=i.x,this.sizeY=i.y,this.rotation=e.rotation,this.actions=[],this.fill=t.fill.toObject(),this.stroke=t.stroke.toObject(),this.text=t.text.toObject(),this.cursor=t.cursor,this.reset=_e.NONE,this.written=_e.NONE,this.effect=-1,this.isStateChanged=!1,this.interactive=!1}return t.prototype.initialize=function(t){t.lock(zt.UPLOADED);for(var e=this.actions,n=0,i=e.length;n<i;++n)e[n].initialize(t,this);t.unlock(zt.UPLOADED,!0)},t.prototype.isActionable=function(){return 0<this.actions.length},t.prototype.onResize=function(t){for(var e=this.actions,n=0,i=e.length;n<i;++n)e[n].onResize(t,this)},t.prototype.onClick=function(t,e){var n=t.state;n.isActionable&&(n.isClicked=!0);for(var i=this.actions,r=0,o=i.length;r<o;++r)i[r].onClick(t,this,e)},t.prototype.onDblClick=function(t,e,n){var i=t.state;i.isActionable&&(i.isDblClicked=!0);for(var r=this.actions,o=0,s=r.length;o<s;++o)r[o].onDblClick(t,this,e,n);return!1},t.prototype.onOver=function(t,e){var n=t.state;if(!n.isHovered){n.isHovered=!0;for(var i=this.actions,r=0,o=i.length;r<o;++r)i[r].onOver(t,this,e)}},t.prototype.onOut=function(t,e){if(t.state.isHovered){t.state.isHovered=!1;for(var n=this.actions,i=0,r=n.length;i<r;++i)n[i].onOut(t,this,e)}},t.prototype.onDown=function(t,e){for(var n=this.actions,i=0,r=n.length;i<r;++i)n[i].onDowning(t,this,e);var o=t.state;if(!o.isDown)if(o.isPressed)for(o.isDown=!0,(s=ft.getLayer(t))&&(a=s.getFocusController()).focus(a.findParent(t)),i=0,r=n.length;i<r;++i)n[i].onDown(t,this,e);else{var s,a;for(o.addAll(At.DOWN,vt.PRESSED),(s=ft.getLayer(t))&&(a=s.getFocusController()).focus(a.findParent(t)),i=0,r=n.length;i<r;++i){var u=n[i];u.onDown(t,this,e),u.onPressed(t,this,e)}}},t.prototype.onUp=function(t,e){var n=t.state;if(!n.isUp)if(n.isPressed){n.set(At.UP,vt.PRESSED);for(var i=0,r=(s=this.actions).length;i<r;++i){var o=s[i];o.onUp(t,this,e),o.onUnpressed(t,this,e)}}else{var s;for(n.isUp=!0,i=0,r=(s=this.actions).length;i<r;++i)s[i].onUp(t,this,e)}},t.prototype.onUpOutside=function(t,e){var n=t.state;if(n.isPressed){n.set(At.UP_OUTSIDE,vt.PRESSED);for(var i=0,r=(s=this.actions).length;i<r;++i){var o=s[i];o.onUpOutside(t,this,e),o.onUnpressed(t,this,e)}}else{var s;for(n.isUpOutside=!0,i=0,r=(s=this.actions).length;i<r;++i)s[i].onUpOutside(t,this,e)}},t.prototype.onMove=function(t,e){for(var n=this.actions,i=0,r=n.length;i<r;++i)n[i].onMove(t,this,e)},t.prototype.onKeyDown=function(t,e){no.isActivateKey(e)&&this.onDown(t,e);for(var n=this.actions,i=0,r=n.length;i<r;++i)n[i].onKeyDown(t,this,e);return!1},t.prototype.onKeyUp=function(t,e){if(no.isActivateKey(e)){var n=t.state;if(n.isPressed){var i=n.isUp;this.onUp(t,e),!i&&n.isUp&&this.onClick(t,e)}}for(var r=this.actions,o=0,s=r.length;o<s;++o)r[o].onKeyUp(t,this,e);return!1},t.prototype.onStateChange=function(t,e,n){this.isStateChanged=!0,ft.update(t),e.isFocused?n.isFocused||this.onFocus(t):n.isFocused&&this.onBlur(t)},t.prototype.onFocus=function(t){for(var e=this.actions,n=0,i=e.length;n<i;++n)e[n].onFocus(t,this)},t.prototype.onBlur=function(t){for(var e=this.actions,n=0,i=e.length;n<i;++n)e[n].onBlur(t,this)},t.prototype.onRightClick=function(t,e){var n=t.state;n.isActionable&&(n.isRightClicked=!0);for(var i=this.actions,r=0,o=i.length;r<o;++r)i[r].onRightClick(t,this,e)},t.prototype.onRightDown=function(t,e){for(var n=this.actions,i=0,r=n.length;i<r;++i)n[i].onRightDowning(t,this,e);var o=t.state;if(!o.isRightDown)if(o.isRightPressed)for(o.addAll(At.RIGHT_DOWN,At.RIGHT_PRESSED),(a=ft.getLayer(t))&&(u=a.getFocusController()).focus(u.findParent(t)),i=0,r=n.length;i<r;++i){var s=n[i];s.onRightDown(t,this,e),s.onRightPressed(t,this,e)}else{var a,u;for(o.isRightDown=!1,(a=ft.getLayer(t))&&(u=a.getFocusController()).focus(u.findParent(t)),i=0,r=n.length;i<r;++i)n[i].onRightDown(t,this,e)}},t.prototype.onRightUp=function(t,e){var n=t.state;if(!n.isRightUp)if(n.isRightPressed){n.set(At.RIGHT_UP,At.RIGHT_PRESSED);for(var i=0,r=(s=this.actions).length;i<r;++i){var o=s[i];o.onRightUp(t,this,e),o.onRightUnpressed(t,this,e)}}else{var s;for(n.isRightUp=!0,i=0,r=(s=this.actions).length;i<r;++i)s[i].onRightUp(t,this,e)}},t.prototype.onRightUpOutside=function(t,e){var n=t.state;if(n.isRightPressed){n.set(At.RIGHT_UP_OUTSIDE,At.RIGHT_PRESSED);for(var i=0,r=(s=this.actions).length;i<r;++i){var o=s[i];o.onRightUpOutside(t,this,e),o.onRightUnpressed(t,this,e)}}else{var s;for(n.isRightUpOutside=!0,i=0,r=(s=this.actions).length;i<r;++i)s[i].onRightUpOutside(t,this,e)}},t.prototype.update=function(e,n){var i=e.data,r=this.effect,o=0<=r&&r<=n;if(i.isChanged||this.isStateChanged||o){this.isStateChanged=!1,i.isChanged=!1,o&&(this.effect=-1),e.lock(zt.UPLOADED),this.onUpdate(e,n),e.unlock(zt.UPLOADED,!0);var s=this.isStateChanged;e.state.removeAll(t.TRANSIENT_STATES),this.isStateChanged=s}},t.prototype.onRender=function(t,e,n){for(var i=this.actions,r=0,o=i.length;r<o;++r)i[r].onRender(t,this,e,n);this.update(t,e)},t.prototype.onUpdate=function(t,e){var n=this.actions;if(0<n.length){this.written=_e.NONE;for(var i=0,r=n.length;i<r;++i)n[i].execute(t,this,e);this.doReset(t)}},t.prototype.doReset=function(t){var e=~this.written&this.reset;if(e!==_e.NONE){if(e&_e.POSITION_X&&(t.transform.position.x=this.x),e&_e.POSITION_Y&&(t.transform.position.y=this.y),e&_e.VISIBILITY&&(t.visible=!0),e&_e.COLOR_FILL){var n=this.fill;t.fill.set(void 0,n.color,n.alpha)}if(e&_e.COLOR_STROKE){var i=this.stroke;t.stroke.set(void 0,i.color,i.alpha)}if(e&_e.FILL_PERCENT&&(n=this.fill,t.fill.set(void 0,void 0,void 0,void 0,n.percent)),e&_e.COLOR_TEXT){var r=this.text;t.text.set(void 0,r.color,r.alpha)}if(e&_e.COLOR_TEXT_OUTLINE){var o=this.text.outline;t.text.outline.set(void 0,o.color,o.alpha)}e&_e.HEIGHT&&(t.size.y=this.sizeY),e&_e.WIDTH&&(t.size.x=this.sizeX),e&_e.ROTATION&&(t.transform.rotation=this.rotation),e&_e.TEXT&&(t.text.value=this.text.value),e&_e.CURSOR&&(t.cursor=this.cursor)}},t.TRANSIENT_STATES=[At.CLICKED,At.DBL_CLICKED,At.DOWN,At.UP,At.UP_OUTSIDE,At.RIGHT_CLICKED,At.RIGHT_DOWN,At.RIGHT_UP,At.RIGHT_UP_OUTSIDE,At.ACTIVATED,At.DEACTIVATED],t}(),Io=function(t){function e(e){return void 0===e&&(e=i.RECTANGLE),t.call(this,e)||this}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(e,n,i,r,o,s,a){return!!t.prototype.containsAbsBBox.call(this,e,n,i,r)&&ae(this,e,n,i,r,o,s)},e}(oe),Ao=function(t){function e(e){return void 0===e&&(e=i.RECTANGLE_PIVOTED),t.call(this,e)||this}return F(e,t),e.prototype.toHitTestData=function(e,n){var i=t.prototype.toHitTestData.call(this,e,n);return i.x-=i.width,i.y-=i.height,i},e}(Io),Ro=function(t){function e(e){var n=t.call(this)||this;n.name=e,n.interactive=!1,n.reference=0;var i=n.newShape();return i.parent=n,n._shape=i,n.interactives=[],n}return F(e,t),Object.defineProperty(e.prototype,"width",{get:function(){return this._shape.size.x},set:function(t){this._shape.size.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._shape.size.y},set:function(t){this._shape.size.y=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"background",{get:function(){return this._shape.fill},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._shape.state},enumerable:!1,configurable:!0}),e.prototype.newShape=function(){var t=new Ao;return t.fill.set(!1,16777215,1),t.stroke.set(!1),t.state.add(Cr.INTERACTIVE),t},e.prototype.initialize=function(t){var e=this.interactives,n=this._shape,i=n.state.is(Cr.INTERACTIVE),r=n.state.is(Cr.DRAGGABLE),o=n.state.is(Cr.PINCHABLE);if(r||o){var s=new Do(n);n.runtime=s;var a=(r?mr.DRAG:mr.NONE)|(o?mr.PINCH:mr.NONE);s.actions.push(new Or("",wr.LAYER,a).toRuntime()),t.push(n),Ut.CURRENT=n,s.initialize(n),Ut.CURRENT=null}(i||r||o)&&(n.interactive=!0,e.push(n)),this.doInitialize(this.children,e)},e.prototype.doInitialize=function(t,e){for(var n=0,i=t.length;n<i;++n){var r=t[n],o=r.runtime;if(o)if(r.interactive||o.interactive)e.push(r);else{var s=r.cursor;null!=s&&0<s.length&&e.push(r)}var a=r.children;0<a.length&&this.doInitialize(a,e)}},e.prototype.update=function(t){this.doUpdate(this.children,t)},e.prototype.doUpdate=function(t,e){for(var n=0,i=t.length;n<i;++n){var r=t[n];r.update(e);var o=r.children;0<o.length&&this.doUpdate(o,e)}},e.prototype.hitTestInteractives=function(t){for(var e=this._work,n=this.interactives,i=n.length-1;0<=i;--i){var r=n[i];if(r.visible&&(r.toLocal(t,void 0,e),null!=r.contains(e.x,e.y)))return r}return null},e.prototype.addUuid=function(t){for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].addUuid(t)},e.prototype.updateUuid=function(t){for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].updateUuid(t)},e.prototype.destroy=function(){if(!this._destroyed){for(var e=this.children,n=e.length-1;0<=n;--n)e[n].destroy();e.length=0,t.prototype.destroy.call(this)}},e.prototype.serialize=function(t,e,n){for(var i=this.children,r=0,o=i.length;r<o;++r){var s=i[r].serialize(e);s[16]=t,n.push(s)}var a=this._shape,u=e.addResource(this.name||""),l=(this.visible?1:0)|(a.state.is(Cr.INVISIBLE)?0:2),h=this.position,c=a.size,p=a.fill.serialize(e),f=a.state.is(Cr.INTERACTIVE)?1:0,d=a.state.is(Cr.DRAGGABLE)?2:0,y=a.state.is(Cr.PINCHABLE)?4:0;return[u,l,h.x,h.y,c.x,c.y,p,f|d|y]},e.deserialize=function(t,n,i,r){var o,s,a,u=new e(this.deserializeName(t[0],n)),l=u._shape,h=t[1];if(null!=h){var c=n.mode!==Hn.VIEWER;!c||1&h||(u.visible=!1),2&h||(l.state.add(Cr.INVISIBLE),c||(u.visible=!1))}var p=t[2],f=t[3];u.position.set(p,f);var d=null!==(o=t[4])&&void 0!==o?o:i,y=null!==(s=t[5])&&void 0!==s?s:r;l.size.set(d,y);var g=t[6];null!=g&&l.fill.deserialize(g,n);var v=null!==(a=t[7])&&void 0!==a?a:1;return l.state.set(Cr.INTERACTIVE,!!(1&v)),l.state.set(Cr.DRAGGABLE,!!(2&v)),l.state.set(Cr.PINCHABLE,!!(4&v)),u},e.deserializeName=function(t,e){if(xt(t))return t;var n=e.resources;return 0<=t&&t<=n.length?n[t]:""},e}(sr),Po=function(t){function e(e,n){var i=t.call(this)||this;return i._active=null,i._width=e,i._height=n,i.interactive=!1,i.interactiveChildren=!1,i}return F(e,t),e.prototype.init=function(){if(null==this._active){var t=this.children,e=t.length;0<e&&(this._active=t[e-1])}},Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(t){this._active!==t&&(null==t||0<=this.children.indexOf(t))&&(this._active=t,this.onLayerChange())},enumerable:!1,configurable:!0}),e.prototype.create=function(t,e){var n=new Ro(t);return this.attach(n,e),n},e.prototype.attach=function(t,e){this.addChild(t),!0===e&&(this._active=t),this.onLayerChange(),ft.update(this)},e.prototype.attachAt=function(t,e,n){this.addChildAt(t,e),!0===n&&(this._active=t),this.onLayerChange(),ft.update(this)},e.prototype.detach=function(t,e){var n=this.children,i=n.indexOf(t);0<=i&&(this._active=e,n.splice(i,1),t.parent=void 0,this.onLayerChange(),ft.update(this))},e.prototype.delete=function(t,e){var n=this.children,i=n.indexOf(t);return 0<=i&&(n.splice(i,1),t.parent=void 0,this._active===t&&(!0===e?i<n.length?this._active=n[i]:0<n.length?this._active=n[i-1]:this._active=null:this._active=null),this.onLayerChange(),ft.update(this)),i},e.prototype.get=function(t){var e=this.children[t];return null!=e?e:null},e.prototype.clear=function(){var t=this.children;if(0<t.length){for(var e=t.length-1;0<=e;--e){var n=t[e];n.parent=null,n.destroy()}t.length=0,this.onLayerChange(),ft.update(this)}},e.prototype.destroy=function(){this._destroyed||(this.clear(),t.prototype.destroy.call(this))},e.prototype.size=function(){return this.children.length},e.prototype.onLayerChange=function(){this.emit("change",this)},e.prototype.serialize=function(t,e){for(var n=[],i=this.children,r=0,o=i.length;r<o;++r)i[r].addUuid(t);for(r=0,o=i.length;r<o;++r)i[r].updateUuid(t);for(r=0,o=i.length;r<o;++r)n.push(i[r].serialize(r,t,e));return n},e.prototype.deserialize=function(t,e){var n=t.length;if(0<n){for(var i=this._width,r=this._height,o=0;o<n;++o)this.addChild(Ro.deserialize(t[o],e,i,r));this.onLayerChange(),ft.update(this)}},e}(t.Container),Mo=function(e){function n(t){var n,i,r,o,s=e.call(this,t)||this,a=s.theme;s.isAmbient(a,t)||(s._background=new Oo(s._background,s.toBackgroundBase(a,t)));var u=new Po(s.width,s.height);s._layer=u,s.addChild(u),null!=t?(s._label=null!==(n=t.label)&&void 0!==n?n:"",s._category=null!==(i=t.category)&&void 0!==i?i:null,s._summary=null!==(r=t.summary)&&void 0!==r?r:"",s._description=null!==(o=t.description)&&void 0!==o?o:""):(s._label="",s._category=null,s._summary="",s._description="");var l=new xo(s,null==t?void 0:t.tile);return s._tile=l,l.init(),s._localBoundsLimit=a.getLocalBoundsLimit(),s}return F(n,e),n.prototype.isAmbient=function(t,e){var n;return null!==(n=null==e?void 0:e.ambient)&&void 0!==n?n:t.isAmbient()},n.prototype.toBackgroundBase=function(t,e){var n,i;return null!==(i=null===(n=null==e?void 0:e.background)||void 0===n?void 0:n.base)&&void 0!==i?i:t.getBackgroundBase()},Object.defineProperty(n.prototype,"label",{get:function(){return this._label},set:function(t){this._label=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"category",{get:function(){return this._category},set:function(t){this._category=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"summary",{get:function(){return this._summary},set:function(t){this._summary=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"description",{get:function(){return this._description},set:function(t){this._description=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"tile",{get:function(){return this._tile},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layer",{get:function(){return this._layer},enumerable:!1,configurable:!0}),n.prototype.initialize=function(t,e){},n.prototype.destroy=function(){this._destroyed||(this.onDestroy(),e.prototype.destroy.call(this))},n.prototype.onDestroy=function(){this._tile.destroy(),this._layer.destroy()},n.prototype.hitTest=function(t,e){for(var n=this._layer.children,i=n.length-1;0<=i;--i){var r=n[i];if(r.visible){var o=r.hitTest(t,e);if(null!=o)return o}}return null},n.prototype.getLocalBounds=function(e){var i,r;null==e&&(e=null!==(i=this._localBoundsRect)&&void 0!==i?i:this._localBoundsRect=new t.Rectangle),e.x=0,e.y=0,e.width=this.width,e.height=this.height;var o=this._localBoundsLimit;if(0===o)return e;var s=this.layer.children,a=s.length,u=null!==(r=n.WORK_LOCAL_BOUNDS)&&void 0!==r?r:n.WORK_LOCAL_BOUNDS=new t.Rectangle;if(0<o){for(var l=0,h=0;h<a;++h){var c=(g=s[h]).transform.position;u.x=c.x,u.y=c.y,u.width=g.width,u.height=g.height,e.enlarge(u),l+=g.children.length}if(o<l)return e;for(h=0;h<a;++h)for(var p=(c=(g=s[h]).transform.position).x,f=c.y,d=0,y=(v=g.children).length;d<y;++d)v[d].getBoundsInternal(!0,u),u.x+=p,u.y+=f,e.enlarge(u)}else for(h=0;h<a;++h){var g,v;for(p=(c=(g=s[h]).transform.position).x,f=c.y,u.x=p,u.y=f,u.width=g.width,u.height=g.height,e.enlarge(u),d=0,y=(v=g.children).length;d<y;++d)v[d].getBoundsInternal(!0,u),u.x+=p,u.y+=f,e.enlarge(u)}return e},n.prototype.getType=function(){return"DDiagramCanvasBase"},n}(Eo),ko={},Lo=function(){function t(){}return Object.defineProperty(t.prototype,"private",{get:function(){var t=this._private;return null==t&&(t=this.newPrivate(),this._private=t),t},enumerable:!1,configurable:!0}),t.prototype.newPrivate=function(){return new Jt},Object.defineProperty(t.prototype,"protected",{get:function(){var t=this._protected;return null==t&&(t=this.newProtected(),this._protected=t),t},enumerable:!1,configurable:!0}),t.prototype.newProtected=function(){return new Jt},Object.defineProperty(t.prototype,"extended",{get:function(){var t=this._extended;return null==t&&(t=this.newExtended(),this._extended=t),t},enumerable:!1,configurable:!0}),t.prototype.newExtended=function(){return new Jt},Object.defineProperty(t.prototype,"ids",{get:function(){var t=this._data;if(null==t)return[];var e=[];return t.forEach((function(t,n){e.push(n)})),e},enumerable:!1,configurable:!0}),t.prototype.each=function(t){var e=this._data;if(null==e)return null;var n=null;return e.forEach((function(e,i){null==n&&!1===t(i)&&(n=i)})),n},t.prototype.add=function(t,e){var n,i=null!==(n=this._data)&&void 0!==n?n:this._data=new Map,r=i.get(t);null==r?i.set(t,[e]):r.push(e)},t.prototype.set=function(t,e,n,i,r,o){var s=this._data;if(null==s)return!1;var a=s.get(t);if(null==a)return!1;var u=a.length;if(u<=0)return!1;for(var l=0;l<u;++l){var h=a[l];h.range.set(r,o),void 0!==n&&(h.time=n),void 0!==i&&(h.state=i),void 0!==e&&(h.value=e)}return!0},t.prototype.get=function(t){var e=this._data;if(null==e)return null;var n=e.get(t);return null==n?null:n},t.prototype.clear=function(t){var e=this._data;if(null==e)return!1;var n=e.get(t);if(null==n)return!1;var i=n.length;if(i<=0)return!1;for(var r=0;r<i;++r)n[r].clear();return!0},t.prototype.toDirty=function(t){var e=this._data;if(null==e)return!1;var n=e.get(t);if(null==n)return!1;var i=n.length;if(i<=0)return!1;for(var r=0;r<i;++r)n[r].toDirty();return!0},t.prototype.setAll=function(t,e,n,i,r,o){var s=this._data;if(null==s)return!1;var a=s.get(t);if(null==a)return!1;var u=a.length;if(u<=0)return!1;for(var l=0;l<u;++l){var h=a[l];h.range.set(r,o),void 0!==n&&(h.times=n),void 0!==i&&(h.states=i),void 0!==e&&(h.values=e)}return!0},t.prototype.setValue=function(t,e){var n=this._data;if(null==n)return!1;var i=n.get(t);if(null==i)return!1;var r=i.length;if(r<=0)return!1;for(var o=0;o<r;++o)i[o].value=e;return!0},t.prototype.setValues=function(t,e){var n=this._data;if(null==n)return!1;var i=n.get(t);if(null==i)return!1;var r=i.length;if(r<=0)return!1;for(var o=0;o<r;++o)i[o].values=e;return!0},t.prototype.setTime=function(t,e){var n=this._data;if(null==n)return!1;var i=n.get(t);if(null==i)return!1;var r=i.length;if(r<=0)return!1;for(var o=0;o<r;++o)i[o].time=e;return!0},t.prototype.setTimes=function(t,e){var n=this._data;if(null==n)return!1;var i=n.get(t);if(null==i)return!1;var r=i.length;if(r<=0)return!1;for(var o=0;o<r;++o)i[o].times=e;return!0},t.prototype.setState=function(t,e){var n=this._data;if(null==n)return!1;var i=n.get(t);if(null==i)return!1;var r=i.length;if(r<=0)return!1;for(var o=0;o<r;++o)i[o].state=e;return!0},t.prototype.setStates=function(t,e){var n=this._data;if(null==n)return!1;var i=n.get(t);if(null==i)return!1;var r=i.length;if(r<=0)return!1;for(var o=0;o<r;++o)i[o].states=e;return!0},t.prototype.setRange=function(t,e,n){var i=this._data;if(null==i)return!1;var r=i.get(t);if(null==r)return!1;var o=r.length;if(o<=0)return!1;for(var s=0;s<o;++s){var a=r[s].range;void 0!==e&&(null!==e?(a.type|=Ht.FROM,a.from=e):a.type&=~Ht.FROM),void 0!==n&&(null!==n?(a.type|=Ht.TO,a.to=n):a.type&=~Ht.TO)}return!0},t}(),No=function(){function t(t){this._canvas=t}return t.prototype.each=function(t,e){for(var n=this._canvas.layer.children,i=0,r=n.length;i<r&&!1!==this.each_(n[i].children,t,e);++i);return this},t.prototype.each_=function(t,e,n){for(var i=0,r=t.length;i<r;++i){var o=t[i];if(!1===e(o))return!1;if(n||Xn.contains(o,Lt.CHILDREN)){var s=o.children;if(0<s.length&&!1===this.each_(s,e,n))return!1}}},t}(),Bo=function(t){function e(e){var n=t.call(this,e)||this;return n._data=new Map,n}return F(e,t),e.prototype.add=function(t,e){var n=this._data,i=n.get(t);null==i?n.set(t,[e]):i.push(e)},e.prototype.get=function(t){var e=this._data.get(t);return e&&0<e.length?e[0]:null},e.prototype.getAll=function(t){return this._data.get(t)||[]},e}(No),zo=function(){function t(t,e){var n=this;this._parent=t,this._values=[],this._interval=e,this._onTimeBound=function(){n.onTime()}}return t.prototype.add=function(t){this._values.push(t)},t.prototype.start=function(){null==this._timeoutId&&this.onTime()},t.prototype.getInterval=function(){var t=Date.now(),e=this._interval;return Math.max(0,e-t%e)},t.prototype.onTime=function(){var t=this._values;if(0<t.length){for(var e=Date.now()/this._interval,n=0,i=t.length;n<i;++n)t[n].value=e;ft.update(this._parent)}this._timeoutId=window.setTimeout(this._onTimeBound,this.getInterval())},t.prototype.stop=function(){var t=this._timeoutId;null!=t&&(clearTimeout(t),this._timeoutId=void 0)},t}(),Uo=function(){function t(t){this._parent=t,this._data=new Map}return t.prototype.add=function(t){var e=this._data,n=this.toNormalized(t),i=e.get(n);if(null!=i)return i;var r=new zo(this._parent,n);return e.set(n,r),r},t.prototype.toNormalized=function(t){return St(t)?Math.max(1,Math.round(t)):1e3},t.prototype.start=function(){this._data.forEach((function(t){t.start()}))},t.prototype.stop=function(){this._data.forEach((function(t){t.stop()}))},t}(),jo=function(){function t(){}return t.add=function(t){var e,n,i;(null!==(e=this._typeToDatum)&&void 0!==e?e:this._typeToDatum=new Map).set(t.type,t),(null!==(n=this._idToDatum)&&void 0!==n?n:this._idToDatum=new Map).set(t.id,t),(null!==(i=this._data)&&void 0!==i?i:this._data=[]).push(t)},t.get=function(t){var e=this._typeToDatum;if(null!=e)return e.get(t)},t.getById=function(t){var e=this._idToDatum;if(null!=e)return e.get(t)},t.each=function(t){var e=this._data;if(null!=e)for(var n=0,i=e.length;n<i;++n)t(e[n])},t}(),Fo=function(){function t(){}return t.add=function(t,e){var n=this._typeToRuntimes;null==n&&(n=new Map,this._typeToRuntimes=n);var i=n.get(t);null==i?(i=[e],n.set(t,i)):i.push(e)},t.get=function(t){var e=this._typeToRuntimes;if(null!=e)return e.get(t)},t}(),Ho="[]",Go=function(){return 0},Vo=function(){return[]},Wo=function(){return""},Ko=function(){return{}},Xo=function(){return!1},Yo=function(e){function n(t){var n=e.call(this,t)||this;return n._data=new Lo,n._shape=new Bo(n),n._ticker=new Uo(n),n._actionables=[],n._downeds=new Set,n._updateBound=function(){ft.update(n)},n}return F(n,e),Object.defineProperty(n.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"shape",{get:function(){return this._shape},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"ticker",{get:function(){return this._ticker},enumerable:!1,configurable:!0}),n.prototype.initialize=function(t,e){var n=this,i=this._actionables,r=this._data;this.initialize_(t,null,null,e,new Map,new Map,new Map,this._ticker,this._shape,r,i);for(var o=this._layer.children,s=o.length,a=0;a<s;++a)o[a].initialize(i);be.isInitializing=!0;var u=Date.now();for(a=0;a<s;++a)o[a].update(u);be.isInitializing=!1,r.extended.each((function(t){var e=jo.getById(t);if(e){var i=e.start;i&&i(n)}})),this._ticker.start()},n.prototype.initialize_=function(t,e,n,i,r,o,s,a,u,l,h){for(var c=function(c,f){var d=t[c],y=d.id;0<y.length&&u.add(y,d),p.initData(d,e,n,i,r,o,a,l);var g=new(ko[d.type]||Do)(d);d.runtime=g,p.initActions(d,g,s),Ut.CURRENT=d,g.initialize(d),Ut.CURRENT=null;var v=d.shortcut;null!=v&&no.on(d,v,(function(t){Ut.CURRENT=d,g.onClick(d,t),Ut.CURRENT=null})),g.isActionable()&&h.push(d);var _=d.children;if(0<_.length){var m=e,b=n;d instanceof ei&&(null==m&&(m=d),b=d),p.initialize_(_,m,b,i,r,o,s,a,u,l,h)}},p=this,f=0,d=t.length;f<d;++f)c(f)},n.prototype.initData=function(t,e,n,i,r,o,s,a){for(var u=t.data,l=0,h=u.size();l<h;++l){var c=u.get(l);if(null!=c)switch(c.type){case Wt.BOOLEAN:case Wt.BOOLEAN_ARRAY:case Wt.NUMBER:case Wt.NUMBER_ARRAY:case Wt.STRING:case Wt.STRING_ARRAY:case Wt.OBJECT:case Wt.OBJECT_ARRAY:this.initDataValue(c,t,e,n,i,r,o,a);break;case Wt.TICKER:this.initDataTicker(c,o,s);break;default:this.initDataExtension(c,a)}}},n.prototype.initDataValue=function(t,e,n,i,r,o,s,a){if(t.scope===Kt.PRIVATE)0<(u=t.id).length&&(i?i.data.private.add(u,t):a.private.add(u,t));else if(t.scope===Kt.PROTECTED)0<(u=t.id).length&&a.protected.add(u,t);else{var u;r&&r(t,n||e),0<(u=t.id).length&&a.add(u,t)}var l=t.format,h=t.initial,c=o.get(t.type);null==c&&(c=new Map,o.set(t.type,c));var p=c.get(l);if(null!=p)t.formatter=p;else if(0<l.length){var f=this.calcFormatter(t,l,h);c.set(l,f),t.formatter=f}var d=s.get(t.type);null==d&&(d=new Map,s.set(t.type,d));var y=d.get(h);if(null!=y)t.value=y();else{var g=this.calcInitial(t,h);d.set(h,g),t.value=g()}},n.prototype.initDataTicker=function(t,e,n){var i=t.initial,r=e.get(t.type);null==r&&(r=new Map,e.set(t.type,r));var o=r.get(i);if(void 0!==o)t.value=0,n.add(o()).add(t);else{var s=this.calcInitial(t,i);r.set(i,s),t.value=0,n.add(s()).add(t)}},n.prototype.initDataExtension=function(t,e){var n=jo.get(t.type);n&&(e.extended.add(n.id,t),t.value=n.initial)},n.prototype.initActions=function(t,e,n){var i=t.action.values,r=e.actions,o=Fo.get(t.type);if(null!=o)for(var s=0,a=o.length;s<a;++s){var u=o[s];r.push(u),e.reset|=u.reset}for(s=0,a=i.length;s<a;++s){var l=i[s],h=n.get(l);null==h?null!=(h=l.toRuntime())&&(n.set(l,h),r.push(h),e.reset|=h.reset):(r.push(h),e.reset|=h.reset)}},n.prototype.calcFormatter=function(t,e,n){var i=this.toInitial(t);try{return Function("value","try {"+"return (".concat(e,");")+"} catch( e1 ) {try {"+"return (".concat(0<n.length?n:i,");")+"} catch( e2 ) {"+"return ".concat(i,";")+"}}")}catch(e){return this.toInitializer(t)}},n.prototype.calcInitial=function(t,e){if(e.length<=0)return this.toInitializer(t);try{return Function("try {"+"return (".concat(e,");")+"} catch( e ) {"+"return ".concat(this.toInitial(t),";")+"}")}catch(e){return this.toInitializer(t)}},n.prototype.toInitial=function(t){switch(t.type){case Wt.BOOLEAN:return"false";case Wt.BOOLEAN_ARRAY:return Ho;case Wt.NUMBER:return"0";case Wt.NUMBER_ARRAY:return Ho;case Wt.STRING:return'""';case Wt.STRING_ARRAY:return Ho;case Wt.OBJECT:return"{}";case Wt.OBJECT_ARRAY:return Ho;case Wt.TICKER:default:return"0"}},n.prototype.toInitializer=function(t){switch(t.type){case Wt.BOOLEAN:return Xo;case Wt.BOOLEAN_ARRAY:return Vo;case Wt.NUMBER:return Go;case Wt.NUMBER_ARRAY:return Vo;case Wt.STRING:return Wo;case Wt.STRING_ARRAY:return Vo;case Wt.OBJECT:return Ko;case Wt.OBJECT_ARRAY:return Vo;case Wt.TICKER:default:return Go}},n.prototype.onDestroy=function(){var t=this;this._data.extended.each((function(e){var n=jo.getById(e);if(n){var i=n.stop;i&&i(t)}})),this._ticker.stop(),e.prototype.onDestroy.call(this)},n.prototype.hitTestInteractives=function(t){for(var e=this._layer.children,n=e.length-1;0<=n;--n){var i=e[n];if(i.visible){var r=i.hitTestInteractives(t);if(null!=r)return r}}return null},n.prototype.onShapeMove=function(t){var e=this.hitTestInteractives(t.data.global);this.cursor=this._cursor=this.toShapeCursor(e);var n=ft.getLayer(this);if(n){var i=this.toShapeTitle(e),r=n.view;r.title!==i&&(r.title=i)}var o=this._overed;if(this._overed=e,e===o){if(null!=e){var s=e.runtime;s&&(Ut.CURRENT=e,s.onMove(e,t),Ut.CURRENT=null)}}else this.onShapeOut(t,o,e),this.onShapeOver(t,e);return null!=e},n.prototype.toShapeCursor=function(t){if(null!=t)for(var e=t;;){var n=e.cursor;if(null!=n&&0<n.length)return n;var i=e.parent;if(!(i instanceof jt))break;e=i}return"auto"},n.prototype.toShapeTitle=function(t){if(null!=t)for(var e=t;;){var n=e.title;if(null!=n&&0<n.length)return n;var i=e.parent;if(!(i instanceof jt))break;e=i}return""},n.prototype.onShapeOut=function(t,e,n){for(;null!=e&&e!==n&&e instanceof jt;){var i=e.runtime;i&&(Ut.CURRENT=e,i.onOut(e,t),Ut.CURRENT=null),e=e.parent}},n.prototype.onShapeOver=function(t,e,n){for(;null!=e&&e!==n&&e instanceof jt;){var i=e.runtime;i&&(Ut.CURRENT=e,i.onOver(e,t),Ut.CURRENT=null),e=e.parent}},n.prototype.onShapeDown=function(t){var e=this.hitTestInteractives(t.data.global);if(this._downed=e,e){this._downeds.add(e);for(var n=e;;){var i=n.runtime;i&&(Ut.CURRENT=n,i.onDown(n,t),Ut.CURRENT=null);var r=n.parent;if(!(r instanceof jt))break;n=r}return!0}return!1},n.prototype.onShapeUp=function(t){var e=this._downeds,n=this.hitTestInteractives(t.data.global);if(n){e.delete(n);for(var i=n;;){var r=i.runtime;r&&(Ut.CURRENT=i,r.onUp(i,t),Ut.CURRENT=null);var o=i.parent;if(!(o instanceof jt))break;i=o}}return this.onShapeCancel(t),null!=n},n.prototype.onShapeCancel=function(t){var e=this._downeds;return 0<e.size&&(e.forEach((function(e){for(var n=e;;){var i=n.runtime;i&&(Ut.CURRENT=n,i.onUpOutside(n,t),Ut.CURRENT=null);var r=n.parent;if(!(r instanceof jt))break;n=r}})),e.clear(),!0)},n.prototype.onShapeClick=function(t){var e=this.hitTestInteractives(t.data.global);if(e&&this._downed===e){for(var n=e;;){var i=n.runtime;i&&(Ut.CURRENT=n,i.onClick(n,t),Ut.CURRENT=null);var r=n.parent;if(!(r instanceof jt))break;n=r}return!0}return!1},n.prototype.onShapeDblClick=function(e,i){var r,o=null!==(r=n.WORK_DBLCLICK)&&void 0!==r?r:n.WORK_DBLCLICK=new t.Point;cr.toGlobal(e,i,o);var s=this.hitTestInteractives(o);if(s){for(var a=s;;){var u=a.runtime;u&&(Ut.CURRENT=a,u.onDblClick(a,e,i),Ut.CURRENT=null);var l=a.parent;if(!(l instanceof jt))break;a=l}return!0}return!1},n.prototype.onShapeRightClick=function(t){var e=this.hitTestInteractives(t.data.global);if(e&&this._downed===e){for(var n=e;;){var i=n.runtime;i&&(Ut.CURRENT=n,i.onRightClick(n,t),Ut.CURRENT=null);var r=n.parent;if(!(r instanceof jt))break;n=r}return!0}return!1},n.prototype.onShapeRightDown=function(t){var e=this.hitTestInteractives(t.data.global);if(this._downed=e,e){this._downeds.add(e);for(var n=e;;){var i=n.runtime;i&&(Ut.CURRENT=n,i.onRightDown(n,t),Ut.CURRENT=null);var r=n.parent;if(!(r instanceof jt))break;n=r}return!0}return!1},n.prototype.onShapeRightUp=function(t){var e=this._downeds,n=this.hitTestInteractives(t.data.global);if(n){e.delete(n);for(var i=n;;){var r=i.runtime;r&&(Ut.CURRENT=i,r.onRightUp(i,t),Ut.CURRENT=null);var o=i.parent;if(!(o instanceof jt))break;i=o}}return this.onShapeRightCancel(t),null!=n},n.prototype.onShapeRightCancel=function(t){var e=this._downeds;return 0<e.size&&(e.forEach((function(e){for(var n=e;;){var i=n.runtime;i&&(Ut.CURRENT=n,i.onRightUpOutside(n,t),Ut.CURRENT=null);var r=n.parent;if(!(r instanceof jt))break;n=r}})),e.clear(),!0)},n.prototype.update=function(){var t=this._actionables;if(0<t.length){for(var e=-1,n=Date.now(),i=0,r=t.length;i<r;++i){var o=t[i];o.update(n);var s=o.runtime;if(s){var a=s.effect;0<=a&&n<a&&(e=e<0?a:Math.min(e,a))}}0<=e&&window.setTimeout(this._updateBound,e-Date.now())}},n.prototype.onRender=function(t){var e=this._actionables;if(0<e.length){for(var n=-1,i=Date.now(),r=0,o=e.length;r<o;++r){var s=e[r];s.onRender(i,t);var a=s.runtime;if(a){var u=a.effect;0<=u&&i<u&&(n=n<0?u:Math.min(n,u))}}0<=n&&window.setTimeout(this._updateBound,n-Date.now())}},n.prototype.getType=function(){return"DDiagramCanvas"},n}(Mo),qo=function(t){function e(e){var n=t.call(this)||this;return n._diagram=e,n._updateBound=function(){ft.update(e)},n}return F(e,t),e.prototype.update=function(){var t=this._diagram.canvas;t&&t.update()},e.prototype.get=function(t){var e=this._diagram.canvas;return e?e.shape.get(t):null},e.prototype.getAll=function(t){var e=this._diagram.canvas;return e?e.shape.getAll(t):[]},e.prototype.each=function(t,e){void 0===e&&(e=!1);var n=this._diagram.canvas;if(null!=n){var i=n.layer.children;if(e){for(r=i.length-1;0<=r;--r)for(a=(s=i[r].children).length-1;0<=a;--a)if(!1===t(l=s[a]))return l}else for(var r=0,o=i.length;r<o;++r)for(var s,a=0,u=(s=i[r].children).length;a<u;++a){var l;if(!1===t(l=s[a]))return l}}return null},e}(t.utils.EventEmitter),Zo=function(){function t(t){this._diagram=t}return Object.defineProperty(t.prototype,"ids",{get:function(){var t=this._diagram.canvas;return null!=t?t.data.private.ids:[]},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n,i,r,o){var s=this._diagram.canvas;return null!=s&&s.data.private.set(t,e,n,i,r,o)},t.prototype.toDirty=function(t){var e=this._diagram.canvas;return null!=e&&e.data.private.toDirty(t)},t.prototype.each=function(t){var e=this._diagram.canvas;return null!=e?e.data.private.each(t):null},t}(),Jo=function(){function t(t){this._diagram=t}return Object.defineProperty(t.prototype,"ids",{get:function(){var t=this._diagram.canvas;return null!=t?t.data.protected.ids:[]},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n,i,r,o){var s=this._diagram.canvas;return null!=s&&s.data.protected.set(t,e,n,i,r,o)},t.prototype.toDirty=function(t){var e=this._diagram.canvas;return null!=e&&e.data.protected.toDirty(t)},t.prototype.each=function(t){var e=this._diagram.canvas;return null!=e?e.data.protected.each(t):null},t}(),Qo=function(){function t(t){this._controller=t&&t.controller}return t.prototype.set=function(t,e){var n=this._controller;return!!n&&(n.write(t,e),!0)},t}(),$o=function(){function t(t){this._diagram=t}return Object.defineProperty(t.prototype,"ids",{get:function(){var t=this._diagram.canvas;return null!=t?t.data.extended.ids:[]},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n,i,r,o){var s=this._diagram.canvas;return null!=s&&s.data.extended.set(t,e,n,i,r,o)},t.prototype.toDirty=function(t){var e=this._diagram.canvas;return null!=e&&e.data.extended.toDirty(t)},t.prototype.each=function(t){var e=this._diagram.canvas;return null!=e?e.data.extended.each(t):null},t}(),ts=function(){function t(t,e){this._diagram=t,this._mapper=e&&e.mapper||null,this._remote=new Qo(e&&e.remote),this._private=new Zo(t),this._protected=new Jo(t),this._extended=new $o(t)}return t.prototype.update=function(){},Object.defineProperty(t.prototype,"mapper",{get:function(){return this._mapper},set:function(t){this._mapper=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"remote",{get:function(){return this._remote},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"private",{get:function(){return this._private},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"protected",{get:function(){return this._protected},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"extended",{get:function(){return this._extended},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ids",{get:function(){var t=this._diagram.canvas;return t?t.data.ids:[]},enumerable:!1,configurable:!0}),t.prototype.each=function(t){var e=this._diagram.canvas;return null!=e?e.data.each(t):null},t.prototype.set=function(t,e,n,i,r,o){var s=this._diagram.canvas;return null!=s&&s.data.set(t,e,n,i,r,o)},t.prototype.get=function(t){var e=this._diagram.canvas;return null!=e?e.data.get(t):null},t.prototype.clear=function(t){var e=this._diagram.canvas;return null!=e&&e.data.clear(t)},t.prototype.toDirty=function(t){var e=this._diagram.canvas;return null!=e&&e.data.toDirty(t)},t.prototype.setAll=function(t,e,n,i,r,o){var s=this._diagram.canvas;return null!=s&&s.data.setAll(t,e,n,i,r,o)},t.prototype.setValue=function(t,e){var n=this._diagram.canvas;return null!=n&&n.data.setValue(t,e)},t.prototype.setValues=function(t,e){var n=this._diagram.canvas;return null!=n&&n.data.setValues(t,e)},t.prototype.setTime=function(t,e){var n=this._diagram.canvas;return null!=n&&n.data.setTime(t,e)},t.prototype.setTimes=function(t,e){var n=this._diagram.canvas;return null!=n&&n.data.setTimes(t,e)},t.prototype.setState=function(t,e){var n=this._diagram.canvas;return null!=n&&n.data.setState(t,e)},t.prototype.setStates=function(t,e){var n=this._diagram.canvas;return null!=n&&n.data.setStates(t,e)},t.prototype.setRange=function(t,e,n){var i=this._diagram.canvas;return null!=i&&i.data.setRange(t,e,n)},t}(),es=function(t){function e(e){var n=t.call(this,e)||this;n.on(cr.move,(function(t){n.onShapeMove(t)})),n.on(cr.up,(function(t){n.onShapeUp(t)})),n.on(cr.upoutside,(function(t){n.onShapeCancel(t)})),n.on(cr.cancel,(function(t){n.onShapeCancel(t)})),n.on(cr.tap,(function(t){n.onShapeClick(t)})),n.on(cr.righttap,(function(t){n.onShapeRightClick(t)})),n.on(cr.rightdown,(function(t){n.onShapeRightDown(t)})),n.on(cr.rightup,(function(t){n.onShapeRightUp(t)})),n.on(cr.rightupoutside,(function(t){n.onShapeRightCancel(t)}));var i=new ts(n,e&&(e.data||e.tag));return n.data=i,n.tag=i,n.shape=new qo(n),n}return F(e,t),e.prototype.initLayer=function(e,n,i){return t.prototype.initLayer.call(this,e,n,i||this.data.mapper)},e.prototype.toMode=function(t){return Hn.VIEWER},e.prototype.newCanvas=function(t){return new Yo(this.toCanvasOptions(t))},e.prototype.toCanvasOptions=function(t){return this.toCanvasBaseOptions(t)},e.prototype.onDown=function(e){var n=this.canvas;if(n){var i=e.target;i===this||i===n?t.prototype.onDown.call(this,e,n.onShapeDown(e)):t.prototype.onDown.call(this,e)}else t.prototype.onDown.call(this,e)},e.prototype.onShapeMove=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeMove(t)}},e.prototype.onShapeUp=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeUp(t)}},e.prototype.onShapeCancel=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeCancel(t)}},e.prototype.onShapeClick=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeClick(t)}},e.prototype.onShapeRightClick=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeRightClick(t)}},e.prototype.onShapeRightDown=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeRightDown(t)}},e.prototype.onShapeRightUp=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeRightUp(t)}},e.prototype.onShapeRightCancel=function(t){var e=this.canvas;if(e){var n=t.target;n!==this&&n!==e||e.onShapeRightCancel(t)}},e.prototype.onDblClick=function(e,n){var i=this.canvas;return i?t.prototype.onDblClick.call(this,e,n,i.onShapeDblClick(e,n)):t.prototype.onDblClick.call(this,e,n)},e.prototype.onPrerender=function(t){var e=this._canvas;e&&e.onRender(t)},e.prototype.render=function(e){var n,i=this,r=this._rendererBound;if(r!==e){var o=null!==(n=this._onPrerenderBound)&&void 0!==n?n:this._onPrerenderBound=function(t){i.onPrerender(t)};null!=r&&r.off("prerender",o),this._rendererBound=e,null!=e&&(e.on("prerender",o),null!=this._canvas&&ft.update(this))}t.prototype.render.call(this,e)},e.prototype.destroy=function(){var e=this._rendererBound;if(null!=e){this._rendererBound=void 0;var n=this._onPrerenderBound;null!=n&&e.off("prerender",n)}t.prototype.destroy.call(this)},e.prototype.getType=function(){return"DDiagram"},e}(wo),ns=function(){function t(){}return t.getShape=function(){return Ut.CURRENT},t.getDiagram=function(){return t.toDiagram(Ut.CURRENT)},t.isDiagram=function(t){return t instanceof es},t.isEmbedded=function(t){return t instanceof ei},t.toDiagram=function(t){for(var e=t;null!=e;){if(this.isDiagram(e))return e;e=e.parent}return null},t.open=function(t,e,n,i,r){var o=Ir[e];if(null!=o){var s=this.toDiagram(t);s&&o(n,i,t,s,r)}else if(xt(n))switch(e){case Un.DIAGRAM:var a=this.toDiagram(t);if(a){var u=a.controller;u&&u.getByName(n).then((function(t){a.set(Dr.toSerialized(t))}))}break;case Un.PAGE:i?window.open(n):window.location.href=n}},t.writeLocal=function(t,e,n,i,r){var o;void 0===r&&(r=Xt.FOUND);for(var s=t;null!=s;){if(this.isDiagram(s))return(s.data.private.set(e,n,i,r)||s.data.protected.set(e,n,i,r)||!!s.data.set(e,n,i,r))&&(ft.update(s),!0);if(this.isEmbedded(s)&&(null===(o=s.data.getPrivate())||void 0===o?void 0:o.set(e,n,i,r)))return ft.update(s),!0;s=s.parent}return!1},t.writeRemote=function(t,e,n){var i=this.toDiagram(t);return!!i&&i.data.remote.set(e,n)},t.emit=function(e,n,i,r){var o=t.toDiagram(e);void 0===r?(e.emit(n,e),o&&o.shape.emit(n,e)):(e.emit(n,i,r,e),o&&o.shape.emit(n,i,r,e))},t.SHAPE=null,t}(),is=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;return n.name=Te.ofStringOrNull(e.name),n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.name(t,n,be);null!=i&&ns.emit(t,i)}},e}(Ee),rs=function(t){function e(e,n){var i=t.call(this,ke.EMIT_EVENT,e)||this;return i.name=n,i}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.name===n.name},e.prototype.toRuntime=function(){return new is(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.name);return t.addResource("[".concat(this.type,",").concat(e,",").concat(n,"]"))},e.deserialize=function(t,n){return new e(Le.toResource(1,t,n.resources),Le.toResource(2,t,n.resources))},e}(Pe),os=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;return n.target=Te.ofStringOrNull(e.target),n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.target(t,n,be);null!=i&&ns.emit(t,i)}},e}(Ee),ss={NO_POINTER_EVENTS:"NO_POINTER_EVENTS"},as=function(){function e(t){var e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"svg");n.setAttribute("style","position: absolute;"),n.setAttribute("width","0px"),n.setAttribute("height","0px");var i=document.createElementNS(e,"defs"),r=document.createElementNS(e,"clipPath"),o="clipper_ex_".concat(Math.random().toString(32).substring(2));r.setAttribute("id",o),r.setAttribute("clipPathUnits","objectBoundingBox");var s=document.createElementNS(e,"path");this._path=s,this._pathD="",s.setAttribute("clip-rule","evenodd"),r.appendChild(s),i.appendChild(r),n.appendChild(i),this._id=o,t.appendChild(n)}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),e.prototype.update=function(t,e,n){var i=this.toD(t,e,n);this._pathD!=i&&(this._path.setAttribute("d",i),this._pathD=i)},e.prototype.toD=function(n,i,r){var o,s;if(null==n)return"";var a=n.width,u=n.height,l=1e-4;if(a<l||u<l)return"";if(r.size<=0)return"M0,0 h1 v1 h-1z";var h=null!==(o=e.WORK_MATRIX)&&void 0!==o?o:e.WORK_MATRIX=new t.Matrix;null!=i?(h.copyFrom(i),h.invert()):h.identity(),h.translate(-n.x,-n.y),h.scale(1/a,1/u);for(var c=-1,p=2,f=-1,d=2,y="",g=h.a,v=h.b,_=h.c,m=h.d,b=h.tx,T=h.ty,w=null!==(s=e.WORK_RECTS)&&void 0!==s?s:e.WORK_RECTS=[],E=this.toRects(r,w),O=0;O<E;O+=4){var C=w[O+0],S=w[O+1],x=w[O+2],D=w[O+3],I=g*C+_*S+b,A=v*C+m*S+T,R=g*x+_*S+b,P=v*x+m*S+T,M=g*x+_*D+b,k=v*x+m*D+T,L=g*C+_*D+b,N=v*C+m*D+T;c=Math.min(c,I,R,M,L),p=Math.max(p,I,R,M,L),f=Math.min(f,A,P,k,N),d=Math.max(d,A,P,k,N);var B=I.toFixed(5),z=A.toFixed(5),U=R.toFixed(5),j=P.toFixed(5),F=M.toFixed(5),H=k.toFixed(5),G=L.toFixed(5),V=N.toFixed(5);y+=" M".concat(B,",").concat(z," L").concat(U,",").concat(j," L").concat(F,",").concat(H," L").concat(G,",").concat(V,"Z")}return"M".concat(c,",").concat(f," L").concat(p,",").concat(f," L").concat(p,",").concat(d," L").concat(c,",").concat(d,"Z")+y},e.prototype.toRects=function(t,e){for(var n=t.data,i=t.size<<2,r=0;r<i;r+=4){var o=n[r+0],s=n[r+1],a=n[r+2],u=n[r+3];o<a?(e[r+0]=o,e[r+2]=a):(e[r+0]=a,e[r+2]=o),s<u?(e[r+1]=s,e[r+3]=u):(e[r+1]=u,e[r+3]=s)}for(r=4;r<i;r+=4){o=e[r+0],s=e[r+1],a=e[r+2],u=e[r+3];for(var l=0;l<r;l+=4){var h=e[l+0],c=e[l+1],p=e[l+2],f=e[l+3],d=0,y=0;if(o<=h)if(a<=p){if(a<=h)continue;d=2,y=1}else y=3;else if(a<=p)d=3;else{if(p<=o)continue;d=1,y=2}var g,v,_=0,m=0;if(s<=c)if(u<=f){if(u<=c)continue;_=2,m=1}else m=3;else if(u<=f)_=3;else{if(f<=s)continue;_=1,m=2}if(4==(g=0===d||0===_?0:1===d||2===d?3===_?2:1:3===_?4:2)){r+4<i&&(e[r+0]=e[i+0],e[r+1]=e[i+1],e[r+2]=e[i+2],e[r+3]=e[i+3]),r-=4,i-=4;break}if(4!=(v=0===y||0===m?0:1===y||2===y?3===m?2:1:3===m?4:2))if(0===g)if(0===v){for(b=i-4;l<b;b-=4)e[b+4]=e[b+0],e[b+5]=e[b+1],e[b+6]=e[b+2],e[b+7]=e[b+3];0===y?(e[l+3]=s,e[l+4]=h,e[l+5]=u,e[l+6]=p,e[l+7]=f):(e[l+2]=o,e[l+4]=a,e[l+5]=c,e[l+6]=p,e[l+7]=f),r+=4,i+=4,l+=4}else 2===v&&(1===y?e[l+0]=a:2===y?e[l+2]=o:1===m?e[l+1]=u:2===m&&(e[l+3]=s));else if(1===g){for(b=i-4;l<b;b-=4)e[b+4]=e[b+0],e[b+5]=e[b+1],e[b+6]=e[b+2],e[b+7]=e[b+3];1===y?1===m?(e[l+0]=a,e[l+4]=h,e[l+5]=u,e[l+6]=a,e[l+7]=f):(e[l+0]=a,e[l+4]=h,e[l+5]=c,e[l+6]=a,e[l+7]=s):1===m?(e[l+2]=o,e[l+4]=o,e[l+5]=u,e[l+6]=p,e[l+7]=f):(e[l+2]=o,e[l+4]=o,e[l+5]=c,e[l+6]=p,e[l+7]=s),r+=4,i+=4,l+=4}else 2===g&&(1===d?(e[r+0]=p,o=p):2===d?(e[r+2]=h,a=h):1===_?(e[r+1]=f,s=f):2===_&&(e[r+3]=c,u=c));else{for(var b=l+4;b<i;b+=4)e[b-4]=e[b+0],e[b-3]=e[b+1],e[b-2]=e[b+2],e[b-1]=e[b+3];r-=4,i-=4,l-=4}}}return i},e}(),us=function(){function t(){this._data=[],this._size=0,this._index=0,this._isDirty=!0}return Object.defineProperty(t.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),t.prototype.isDirty=function(){return this._isDirty},t.prototype.toClean=function(){this._isDirty=!1},t.prototype.begin=function(){return this._index=0,this},t.prototype.end=function(){var t=this._index;this._size=t;var e=this._data,n=t<<2;return e.length!==n&&(e.length=n,this._isDirty=!0),this},t.prototype.add=function(t,e,n,i){var r=this._index<<2;this._index+=1;var o=this._data;return r<o.length?o[r+0]===t&&o[r+1]===e&&o[r+2]===n&&o[r+3]===i||(o[r+0]=t,o[r+1]=e,o[r+2]=n,o[r+3]=i,this._isDirty=!0):(o.push(t,e,n,i),this._isDirty=!0),this},t}(),ls={CLICKED:0,DOUBLE_CLICKED:1,FOCUSED:2,ALWAYS:3},hs=function(){function e(t,e,n,i){var r=this;this._target=t,this._operation=e;var o=this.toData(n,i);this._data=o,this._isElementShown=!1,this._onElementFocusBound=function(t){r.onElementFocus(t)},this._onBeforeFocusBound=function(t){r.onBeforeFocus(t)},this._onAfterFocusBound=function(t){r.onAfterFocus(t)},this._isStarted=!1,this._wasStarted=!1,this._doSelectBound=function(){r.doSelect()},this._isStartRequested=this._data.when===ls.ALWAYS,this._onPostRenderBound=function(){r.updateElement(r._rendererBound)}}return e.prototype.toData=function(t,e){var n,i;return{element:this.toElementData(t,null==e?void 0:e.element),clipper:this.toClipperData(t,null==e?void 0:e.clipper),before:this.toBeforeData(t,null==e?void 0:e.before),after:this.toAfterData(t,null==e?void 0:e.after),when:ai(null!==(n=null==e?void 0:e.when)&&void 0!==n?n:t.getWhen(),ls),select:null!==(i=null==e?void 0:e.select)&&void 0!==i?i:t.getSelect()}},e.prototype.toElementData=function(t,e){var n,i;return{creator:null!==(n=null==e?void 0:e.creator)&&void 0!==n?n:t.getElementCreator(),styler:null!==(i=null==e?void 0:e.styler)&&void 0!==i?i:this.newElementStyler(t)}},e.prototype.newElementStyler=function(t){return function(e,n,i,r,o,s,a){return t.setElementStyle(e,n,i,r,o,s,a)}},e.prototype.toClipperData=function(t,e){var n,i,r;return{creator:null!==(n=null==e?void 0:e.creator)&&void 0!==n?n:t.getClipperCreator(),styler:null!==(i=null==e?void 0:e.styler)&&void 0!==i?i:this.newClipperStyler(t),extended:null!==(r=null==e?void 0:e.extended)&&void 0!==r?r:t.isClipperExEnabled()}},e.prototype.newClipperStyler=function(t){return function(e,n,i,r,o,s,a){return t.setClipperStyle(e,n,i,r,o,s,a)}},e.prototype.toBeforeData=function(t,e){var n,i;return{creator:null!==(n=null==e?void 0:e.creator)&&void 0!==n?n:t.getBeforeCreator(),styler:null!==(i=null==e?void 0:e.styler)&&void 0!==i?i:this.newBeforeStyler(t)}},e.prototype.newBeforeStyler=function(t){return function(e){t.setBeforeStyle(e)}},e.prototype.toAfterData=function(t,e){var n,i;return{creator:null!==(n=null==e?void 0:e.creator)&&void 0!==n?n:t.getAfterCreator(),styler:null!==(i=null==e?void 0:e.styler)&&void 0!==i?i:this.newAfterStyler(t)}},e.prototype.newAfterStyler=function(t){return function(e){t.setAfterStyle(e)}},Object.defineProperty(e.prototype,"element",{get:function(){var t;return null!==(t=this._element)&&void 0!==t?t:null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"when",{get:function(){return this._data.when},enumerable:!1,configurable:!0}),e.prototype.onDowning=function(t){switch(this._wasStarted=this._isStarted,this.when){case ls.CLICKED:this.start();break;case ls.FOCUSED:this._target.state.isFocused&&this.start()}},e.prototype.onDown=function(t){!this._wasStarted&&this._isStarted&&("data"in t?t.data.originalEvent.preventDefault():t.preventDefault())},e.prototype.onDblClick=function(t,e){switch(this.when){case ls.DOUBLE_CLICKED:this.start()}},e.prototype.onFocus=function(){var t;switch(this.when){case ls.FOCUSED:this.start();break;default:null===(t=this._element)||void 0===t||t.focus()}},e.prototype.onBlur=function(){var t;switch(this.when){case ls.CLICKED:case ls.DOUBLE_CLICKED:case ls.FOCUSED:this.onEndByBlur(),this.cancel();break;default:null===(t=this._element)||void 0===t||t.blur()}},e.prototype.isStartable=function(){switch(this.when){case ls.CLICKED:case ls.DOUBLE_CLICKED:case ls.FOCUSED:return this._target.state.isActionable;default:return!0}},e.prototype.start=function(){!this._isStarted&&this.isStartable()&&(this._isStarted=!0,this._target.worldVisible?this.doStart():this._isStartRequested=!0,ft.update(this._target))},e.prototype.isShown=function(){return this._isElementShown},e.prototype.onRender=function(t){(this._isStartRequested||!this._isElementShown&&this.when===ls.ALWAYS)&&(this._isStartRequested=!1,this.doStart(t)),this._isStarted&&(this._isStarted=!1)},e.prototype.getElementRect=function(e){var n=this._point||new t.Point(0,0);this._point=n;var i=this._elementRectResult||new t.Rectangle;return this._elementRectResult=i,this._operation.getElementRect(e,n,i)},e.prototype.getElementMatrix=function(){return this._operation.getElementMatrix()},e.prototype.getClipperRect=function(e){var n=this._point||new t.Point(0,0);this._point=n;var i=this._clipperRectResult||new t.Rectangle;return this._clipperRectResult=i,this._operation.getClipperRect(e,n,i)},e.prototype.fillClipperExRects=function(t,e){var n=this._operation;return n.getClipperExRects&&n.getClipperExRects(e),e.isDirty()},e.prototype.doStart=function(t){var e,n;if(!this._isElementShown){this._isElementShown=!0;var i=this._rendererBound;null!=i&&(this._rendererBound=void 0,i.off("postrender",this._onPostRenderBound));var r=this._target;null==t&&(t=null===(e=ft.getLayer(r))||void 0===e?void 0:e.renderer),t&&(this._rendererBound=t,t.on("postrender",this._onPostRenderBound)),this.onStart();var o=this.getClipper();if(o){var s=this.getBefore(o),a=this.getElement(o),u=this.getAfter(o),l=this.getClipperEx(o);if(a){var h=null!==(n=null==t?void 0:t.resolution)&&void 0!==n?n:ft.getResolution(r),c=this.getElementRect(h),p=this.getElementMatrix(),f=this.toClipperRectAdjusted(c,p,this.getClipperRect(h)),d=r.state,y=this._operation.getPadding(),g=this._data;if(g.clipper.styler(o,d,y,c,p,f,l),g.element.styler(a,d,y,c,p,f,l),s&&g.before.styler(s),u&&g.after.styler(u),this.onElementAttached(a,s,u),l){var v=this.getClipperExRects();v&&this.fillClipperExRects(h,v)&&(l.update(c,p,v),v.toClean())}o.style.display="",d.isFocused&&this.toElementFocused(a),o.scrollTop=0,o.scrollLeft=0,this._data.select&&setTimeout(this._doSelectBound,0)}}}},e.prototype.toElementFocused=function(t){t.focus({preventScroll:!0})},e.prototype.onStart=function(){this._operation.onStart()},e.prototype.doSelect=function(){var t=this._element;t&&(t instanceof HTMLInputElement||t instanceof HTMLTextAreaElement)&&t.select()},e.prototype.cancel=function(){var t;if(this._isElementShown){this._isElementShown=!1;var e=this._rendererBound;null!=e&&(this._rendererBound=void 0,e.off("postrender",this._onPostRenderBound)),this.onCancel();var n=this._target,i=ft.getLayer(n);if(i){var r=i.view;switch(this.when){case ls.CLICKED:case ls.DOUBLE_CLICKED:case ls.FOCUSED:document.activeElement===this._element&&r.focus()}var o=n.state,s=i.renderer.plugins.interaction;this._operation.containsPoint(s.mouse.global)&&!o.isHovered&&(o.isHovered=!0,r.style.cursor=null!==(t=n.cursor)&&void 0!==t?t:""),i.update()}var a=this._element;null!=a&&this.onElementDetached(a,this._before,this._after);var u=this._clipper;null!=u&&(u.style.display="none")}},e.prototype.onCancel=function(){this._operation.onCancel()},e.prototype.onElementAttached=function(t,e,n){null==e||e.addEventListener("focus",this._onBeforeFocusBound),null==n||n.addEventListener("focus",this._onAfterFocusBound),t.addEventListener("focus",this._onElementFocusBound,!0)},e.prototype.onElementDetached=function(t,e,n){null==e||e.removeEventListener("focus",this._onBeforeFocusBound),null==n||n.removeEventListener("focus",this._onAfterFocusBound),t.removeEventListener("focus",this._onElementFocusBound,!0)},e.prototype.getClipper=function(){var t=this._clipper;if(null==t){var e=ft.getLayer(this._target);t=e?this._data.clipper.creator(e.getElementContainer()):null,this._clipper=t}return t},e.prototype.getClipperEx=function(t){var e=this._clipperEx;return void 0===e&&(e=null!=this.getClipperExRects()?new as(t):null,this._clipperEx=e),e},e.prototype.getClipperExRects=function(){var t=this._clipperExRects;return void 0===t&&(t=this._data.clipper.extended?new us:null,this._clipperExRects=t),t},e.prototype.getElement=function(t){var e=this._element;return null==e&&(e=this._data.element.creator(t),this._element=e),e},e.prototype.getBefore=function(t){var e=this._before;return null==e&&(e=this._data.before.creator(t),this._before=e),e},e.prototype.getAfter=function(t){var e=this._after;return null==e&&(e=this._data.after.creator(t),this._after=e),e},e.prototype.onBeforeFocus=function(t){var e=this._target,n=ft.getLayer(e);if(n){var i=n.getFocusController(),r=i.find(e,!1,!1,!1);n.view.focus(),i.focus(r),t.preventDefault(),t.stopImmediatePropagation()}},e.prototype.onAfterFocus=function(t){var e=this._target,n=ft.getLayer(e);if(n){var i=n.getFocusController(),r=i.find(e,!1,!1,!0);n.view.focus(),i.focus(r),t.preventDefault(),t.stopImmediatePropagation()}},e.prototype.onElementFocus=function(t){if(this.when===ls.ALWAYS){var e=this._target;e.state.isFocused||e.focus()}},e.prototype.onEndByBlur=function(){this.onEnd()},e.prototype.onEnd=function(){this._operation.onEnd()},e.prototype.end=function(){this.onEnd(),this.cancel()},e.prototype.select=function(){return this._isElementShown&&this._data.select&&this.doSelect(),this},e.prototype.toClipperRectAdjusted=function(t,e,n){if(n&&t&&null==e){var i=t.x,r=t.y,o=i+t.width,s=r+t.height,a=n.x,u=n.y,l=a+n.width,h=u+n.height,c=Math.min(Math.max(a,i),l),p=Math.min(Math.max(a,o),l),f=Math.min(Math.max(u,r),h),d=Math.min(Math.max(u,s),h);n.x=c,n.y=f,n.width=p-c,n.height=d-f}return n},e.prototype.updateElement=function(t){if(this._isElementShown){var e=this._target;if(e.worldVisible){var n=this._element,i=this._clipper,r=this._clipperEx;if(n&&i){var o=t.resolution,s=this.getElementRect(o),a=this.getElementMatrix(),u=this.toClipperRectAdjusted(s,a,this.getClipperRect(o)),l=e.state,h=this._operation.getPadding(),c=this._data;if(c.clipper.styler(i,l,h,s,a,u,r),c.element.styler(n,l,h,s,a,u,r),r){var p=this.getClipperExRects();p&&this.fillClipperExRects(o,p)&&(r.update(s,a,p),p.toClean())}}}else switch(this.when){case ls.ALWAYS:(i=this._clipper)&&(i.style.display="none");break;default:this.cancel()}}},e.getClipperRect=function(t,e,n,i,r){for(var o=!0,s=0,a=0,u=0,l=0,h=t;h instanceof ao;){h.getClippingRect(e,r),i.set(r.x,r.y),h.toGlobal(i,i,!1);var c=(i.x*n|0)/n,p=(i.y*n|0)/n;i.set(r.x+r.width,r.y+r.height),h.toGlobal(i,i,!0);var f=i.x,d=i.y,y=Math.min(c,f),g=Math.min(p,d),v=Math.max(c,f),_=Math.max(p,d);o?(o=!1,s=y,a=g,u=v,l=_):(s=Math.min(Math.max(s,y),v),a=Math.min(Math.max(a,g),_),u=Math.min(Math.max(u,y),v),l=Math.min(Math.max(l,g),_)),h=h.parent}return o?null:(r.x=s,r.y=a,r.width=u-s,r.height=l-a,r)},e}(),cs=!1,ps=function(){return cs},fs=function(e){function n(t){var n=e.call(this)||this;return n.condition=Te.ofString(t.condition),n.utils=new Map,n}return F(n,e),n.prototype.getUtil=function(t,e){var n=this.utils,i=n.get(t);return null==i&&(i=this.newUtil(t,e),n.set(t,i)),i},n.prototype.newUtil=function(t,e){return new hs(t,this.newOperation(t,e),it.getInstance().get("DHtmlElement"),this.newUtilOptions(t,e))},n.prototype.newOperation=function(t,e){var n=this;return{getElementRect:function(i,r,o){return n.getElementRect(t,e,i,r,o)},getElementMatrix:function(){return n.getElementMatrix(t,e)},getClipperRect:function(i,r,o){return n.getClipperToRect(t,e,i,r,o)},getClipperExRects:function(e){n.getClipperExRects(t,e)},getPadding:function(){return n.getPadding(t,e)},containsPoint:function(i){return n.containsPoint(t,e,i)},onStart:function(){},onCancel:function(){},onEnd:function(){}}},n.prototype.newUtilOptions=function(t,e){return{element:{creator:this.newElementCreator(t,e)},when:this.toWhen(t,e),clipper:{extended:ps()}}},n.prototype.toWhen=function(t,e){var n=this.condition(t,Date.now(),be);if(null!=n&&n in ls)return ls[n]},n.prototype.containsPoint=function(e,i,r){var o;if(e.visible){var s=null!==(o=n.WORK)&&void 0!==o?o:n.WORK=new t.Point;return e.toLocal(r,void 0,s),null!=e.contains(s.x,s.y)}return!1},n.prototype.getPadding=function(t,e){return null},n.prototype.getElementRect=function(t,e,n,i,r){var o=t.transform.pivot,s=t.size,a=s.x,u=s.y;return r.x=-.5*a+o.x,r.y=-.5*u+o.y,r.width=a,r.height=u,r},n.prototype.getElementMatrix=function(t,e){return t.updateTransform(),t.transform.worldTransform},n.prototype.getClipperToRect=function(t,e,n,i,r){var o=ns.toDiagram(t);return hs.getClipperRect(o,t,n,i,r)},n.prototype.getClipperExRects=function(t,e){e.begin();var n=t.root.parent;if(n instanceof Ro){var i=n.parent;if(null!=i){var r=i.children,o=r.indexOf(n);if(0<=o)for(var s=o+1,a=r.length;s<a;++s){var u=r[s];if(u.visible){var l=u.width,h=u.height,c=u.transform.worldTransform,p=c.a,f=c.b,d=c.c,y=c.d,g=c.tx,v=c.ty;e.add(g,v,p*l+d*h+g,f*l+y*h+v)}}}}e.end()},n.prototype.onRender=function(t,e,n,i){this.getUtil(t,e).onRender(i)},n.prototype.onFocus=function(t,e){this.getUtil(t,e).onFocus()},n.prototype.onBlur=function(t,e){this.getUtil(t,e).onBlur()},n.prototype.onDowning=function(t,e,n){this.getUtil(t,e).onDowning(n)},n.prototype.onDown=function(t,e,n){this.getUtil(t,e).onDown(n)},n.prototype.onDblClick=function(t,e,n,i){this.getUtil(t,e).onDblClick(n,i)},n}(we),ds=function(t){function e(e){var n=t.call(this,e)||this;return n.elementCreator=Te.ofElementOrNull(e.value),n.noPointerEvent=e.subtype===Er.HTML_ELEMENT_WITHOUT_POINTER_EVENTS,n}return F(e,t),e.prototype.newUtil=function(e,n){return this.noPointerEvent&&e.state.add(ss.NO_POINTER_EVENTS),t.prototype.newUtil.call(this,e,n)},e.prototype.newElementCreator=function(t,e){var n=this.elementCreator;if(n)return function(e){return n(t,Date.now(),be,e)}},e}(fs),ys=function(t){function e(e,n,i,r){var o,s,a,u,l,h,c=t.call(this,e,n,i,r)||this;c._operation=n,c._onInputKeyDownBound=function(t){c.onInputKeyDown(t)},c._onInputChangeBound=function(){c.onInputChange()},c._onInputInputBound=function(t){c.onInputInput(t)},c._description=null!==(o=null==r?void 0:r.description)&&void 0!==o?o:"";var p=null==r?void 0:r.editing;return c._editingFormatter=null!==(u=null!==(s=null==p?void 0:p.formatter)&&void 0!==s?s:null===(a=null==r?void 0:r.text)||void 0===a?void 0:a.formatter)&&void 0!==u?u:i.getEditingFormatter(),c._editingUnformatter=null!==(l=null==p?void 0:p.unformatter)&&void 0!==l?l:i.getEditingUnformatter(),c._editingValidator=null!==(h=null==p?void 0:p.validator)&&void 0!==h?h:i.getEditingValidator(),c}return F(e,t),e.prototype.onEnd=function(){t.prototype.onEnd.call(this),this.onInputChange()},e.prototype.onElementAttached=function(e,n,i){e.value=this.fromValue(this._operation.getValue()),e.addEventListener("change",this._onInputChangeBound),e.addEventListener("input",this._onInputInputBound),t.prototype.onElementAttached.call(this,e,n,i)},e.prototype.onElementDetached=function(e,n,i){t.prototype.onElementDetached.call(this,e,n,i),e.removeEventListener("change",this._onInputChangeBound),e.removeEventListener("input",this._onInputInputBound)},e.prototype.onInputKeyDown=function(t){no.isOkKey(t)?(this.end(),this._operation.onEnter()):no.isCancelKey(t)&&this.cancel()},e.prototype.toElementFocused=function(e){t.prototype.toElementFocused.call(this,e),e.scrollTop=0,e.scrollLeft=0},e.prototype.onInputChange=function(){if(this.isShown()){var t=this.element;if(null!=t){var e=this._operation,n=this.toValue(t.value),i=e.getValue();i!==n&&e.onValueChange(n,i)}}},e.prototype.toValue=function(t){return this._editingUnformatter(t,this)},e.prototype.fromValue=function(t){return void 0!==t?this._editingFormatter(t,this):""},e.prototype.onInputInput=function(t){var e=t.target;(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)&&this._operation.onValueInput(this.toValue(e.value))},e.prototype.validate=function(){var t=this._operation.getValue();if(void 0!==t){var e=this._editingValidator(t,this);if(this._editingValidationResult!==e){this._editingValidationResult=e;var n=this._target.state;n.isInvalid=null!=e,n.isHovered&&this._operation.applyTitle()}return e}return null},e.prototype.applyTitle=function(){var t=this._editingValidationResult;if(xt(t)){var e=ft.getLayer(this._target);return e&&(e.view.title=t),!0}return!1},e}(hs),gs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onElementAttached=function(e,n,i){e.addEventListener("keydown",this._onInputKeyDownBound),t.prototype.onElementAttached.call(this,e,n,i)},e.prototype.onElementDetached=function(e,n,i){e.removeEventListener("keydown",this._onInputKeyDownBound),t.prototype.onElementDetached.call(this,e,n,i)},e}(ys),vs=function(t){function e(e,n,i,r){var o,s,a,u=t.call(this,e,n,i,r)||this;return u._step=null!==(o=null==r?void 0:r.step)&&void 0!==o?o:i.getStep(),u._min=null!==(s=null==r?void 0:r.min)&&void 0!==s?s:i.getMin(),u._max=null!==(a=null==r?void 0:r.max)&&void 0!==a?a:i.getMax(),u}return F(e,t),Object.defineProperty(e.prototype,"step",{get:function(){return this._step},set:function(t){this._step!==t&&(this._step=t,this.onStepChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min},set:function(t){this._min!==t&&(this._min=t,this.onMinChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max},set:function(t){this._max!==t&&(this._max=t,this.onMaxChange())},enumerable:!1,configurable:!0}),e.prototype.toValue=function(e){var n=t.prototype.toValue.call(this,e);if(n==n){var i=this._min;if(null!=i&&n<i)return i;var r=this._max;return null!=r&&r<n?r:n}return 0},e.prototype.fromValue=function(t){return void 0!==t?this._editingFormatter(t,this):"0"},e.prototype.onStepChange=function(){if(this.isShown()){var t=this.element;t&&this.updateStep(t)}},e.prototype.onMinChange=function(){if(this.isShown()){var t=this.element;t&&this.updateMin(t)}},e.prototype.onMaxChange=function(){if(this.isShown()){var t=this.element;t&&this.updateMax(t)}},e.prototype.updateStep=function(t){var e=this.step;t.step=null!=e?"".concat(e):"any"},e.prototype.updateMin=function(t){var e=this.min;null!=e?t.min="".concat(e):t.removeAttribute("min")},e.prototype.updateMax=function(t){var e=this.max;null!=e?t.max="".concat(e):t.removeAttribute("max")},e.prototype.onElementAttached=function(e,n,i){e.type="number",t.prototype.onElementAttached.call(this,e,n,i),this.updateStep(e),this.updateMin(e),this.updateMax(e)},e}(gs),_s={EMIT_EVENT:0,WRITE_BOTH:1,WRITE_LOCAL:2,WRITE_REMOTE:3},ms=function(){function t(){}return t.execute=function(t,e,n,i,r){switch(e){case _s.EMIT_EVENT:t.emit(n,t,i),ns.emit(t,n,i,r);break;case _s.WRITE_LOCAL:ns.writeLocal(t,n,i,r);break;case _s.WRITE_REMOTE:ns.writeRemote(t,n,i);break;case _s.WRITE_BOTH:ns.writeLocal(t,n,i,r),ns.writeRemote(t,n,i)}},t}(),bs=function(t){function e(e){var n=t.call(this,e)||this;return n.target=Te.ofStringOrNull(e.target),n.onInputAction=e.onInputAction,n}return F(e,t),e.prototype.newOperation=function(t,e){var n=this;return{getElementRect:function(i,r,o){return n.getElementRect(t,e,i,r,o)},getElementMatrix:function(){return n.getElementMatrix(t,e)},getClipperRect:function(i,r,o){return n.getClipperToRect(t,e,i,r,o)},getClipperExRects:function(e){n.getClipperExRects(t,e)},getPadding:function(){return n.getPadding(t,e)},containsPoint:function(i){return n.containsPoint(t,e,i)},onStart:function(){t.text.enable=!1},onCancel:function(){t.text.enable=!0},onEnd:function(){},getValue:function(){return n.getUtil(t,e).toValue(t.text.value)},onValueInput:function(t){},onValueChange:function(i,r){n.onValueChange(t,e,i,r)},onEnter:function(){},applyTitle:function(){}}},e.prototype.newElementCreator=function(t,e){},e.prototype.getPadding=function(t,e){return t.text.padding},e.prototype.onValueChange=function(t,e,n,i){t.text.value=this.getUtil(t,e).fromValue(n);var r=Date.now(),o=this.target(t,r,be);null!=o&&ms.execute(t,this.onInputAction,o,n,r)},e}(fs),Ts=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e}(bs),ws=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e}(Ts),Es=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newUtil=function(t,e){return new vs(t,this.newOperation(t,e),it.getInstance().get("DInputInteger"),this.newUtilOptions(t,e))},e}(ws),Os=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newUtil=function(t,e){return new vs(t,this.newOperation(t,e),it.getInstance().get("DInputReal"),this.newUtilOptions(t,e))},e}(ws),Cs=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onElementAttached=function(e,n,i){e.type="text",t.prototype.onElementAttached.call(this,e,n,i)},e}(gs),Ss=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newUtil=function(t,e){return new Cs(t,this.newOperation(t,e),it.getInstance().get("DInputText"),this.newUtilOptions(t,e))},e}(Ts),xs=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;return n.target=Te.ofStringOrNull(e.target),n.value=Te.ofUnknown(e.value),n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.target(t,n,be);null!=i&&this.write(t,i,this.value(t,n,be),n)}},e}(Ee),Ds=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.write=function(t,e,n,i){ns.writeLocal(t,e,n,i),ns.writeRemote(t,e,n)},e}(xs),Is=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.write=function(t,e,n,i){ns.writeLocal(t,e,n,i)},e}(xs),As=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.write=function(t,e,n,i){ns.writeRemote(t,e,n)},e}(xs),Rs=function(t){function e(e,n,i,r,o){var s=t.call(this,ke.MISC,n,e)||this;return s.target=i,s.onInputAction=r,s.value=o,s}return F(e,t),e.prototype.toRuntime=function(){switch(this.subtype){case Er.INPUT_TEXT:return new Ss(this);case Er.INPUT_INTEGER:return new Es(this);case Er.INPUT_REAL:return new Os(this);case Er.EMIT_EVENT:return new os(this);case Er.WRITE_BOTH:return new Ds(this);case Er.WRITE_LOCAL:return new Is(this);case Er.WRITE_REMOTE:return new As(this);case Er.HTML_ELEMENT:case Er.HTML_ELEMENT_WITHOUT_POINTER_EVENTS:return new ds(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.target),i=t.addResource(this.value);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",").concat(this.onInputAction,",").concat(i,"]"))},e.deserialize=function(t,n){var i=n.resources,r=Le.toResource(1,t,i),o=Le.toResource(3,t,i),s=Le.toResource(5,t,i);return new e(t[2],r,o,t[4],s)},e}(Me),Ps=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;return n.target=Te.ofUnknown(e.target),n}return F(e,t),e.prototype.execute=function(t,e,n){this.condition(t,n,be)&&this.target(t,n,be)},e}(Ee),Ms=function(t){function e(e,n){var i=t.call(this,ke.MISC,e,Er.EXECUTE)||this;return i.target=n,i}return F(e,t),e.prototype.toRuntime=function(){return new Ps(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.target);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,"]"))},e.deserialize=function(t,n){var i=n.resources;return new e(Le.toResource(1,t,i),Le.toResource(3,t,i))},e}(Me),ks=function(){function t(){}return t.add=function(t){var e,n;(null!==(e=this._typeToDatum)&&void 0!==e?e:this._typeToDatum=new Map).set(t.type,t),(null!==(n=this._data)&&void 0!==n?n:this._data=[]).push(t)},t.get=function(t){var e=this._typeToDatum;if(null!=e)return e.get(t)},t.each=function(t){var e=this._data;if(null!=e)for(var n=0,i=e.length;n<i;++n)t(e[n])},t}(),Ls=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;return n.argument=Te.ofUnknown(e.argument),n.extension=ks.get(e.subtype),n}return F(e,t),e.prototype.execute=function(t,e,n){var i=this.extension;if(null!=i&&this.condition(t,n,be)){var r=ns.toDiagram(t);null!=r&&i.executor(this.argument(t,n,be),t,r,be)}},e}(Ee),Ns=function(t){function e(e,n,i){var r=t.call(this,ke.MISC,n,e)||this;return r.argument=i,r}return F(e,t),e.prototype.toRuntime=function(){return new Ls(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.argument);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,"]"))},e.deserialize=function(t,n){var i=n.resources,r=Le.toResource(1,t,i),o=Le.toResource(3,t,i);return new e(t[2],r,o)},e}(Me),Bs=function(t){function e(e,n){var i=t.call(this,e,_e.NONE)||this;return i.subtype=n,i.target=Te.ofUnknown(e.target),i.inNewWindow=e.inNewWindow,i}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.target(t,n,be);null!=i&&ns.open(t,this.subtype,i,this.inNewWindow,be)}},e}(Ee),zs={DIAGRAM_LEGACY:0,PAGE_LEGACY:1,PAGE_INPLACE_LEGACY:2,DIALOG_TEXT:3,DIALOG_INTEGER:4,DIALOG_REAL:5,DIALOG_BOOLEAN:6,DIALOG_DATE:7,DIALOG_TIME:8,DIALOG_DATETIME:9,DIAGRAM:10,PAGE:11,DIALOG:12,EXTENSION:Un.EXTENSION},Us=function(t){function e(e,n,i,r){var o=t.call(this,ke.OPEN,n,e)||this;return o.target=i,o.inNewWindow=r,o}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.target===n.target&&this.inNewWindow===n.inNewWindow},e.prototype.toRuntime=function(){switch(this.subtype){case zs.DIAGRAM:return new Bs(this,Un.DIAGRAM);case zs.PAGE:return new Bs(this,Un.PAGE)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.target),i=this.inNewWindow?1:0;return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",").concat(i,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources),r=Le.toResource(3,t,n.resources);return new e(this.toSubType(t),i,r,this.inNewWindow(t))},e.toSubType=function(t){switch(t[2]){case zs.DIAGRAM_LEGACY:return zs.DIAGRAM;case zs.PAGE_LEGACY:case zs.PAGE_INPLACE_LEGACY:return zs.PAGE;case zs.DIAGRAM:return zs.DIAGRAM;case zs.PAGE:return zs.PAGE}return zs.DIAGRAM},e.inNewWindow=function(t){switch(t[2]){case zs.DIAGRAM_LEGACY:return!1;case zs.PAGE_LEGACY:return!0;case zs.PAGE_INPLACE_LEGACY:return!1;case zs.DIAGRAM:case zs.PAGE:return!!t[4]}return!1},e}(Me),js={TOP:0,TOP_LEFT:1,TOP_CENTER:2,TOP_RIGHT:3,LEFT:4,LEFT_TOP:5,LEFT_MIDDLE:6,LEFT_BOTTOM:7,RIGHT:8,RIGHT_TOP:9,RIGHT_MIDDLE:10,RIGHT_BOTTOM:11,BOTTOM:12,BOTTOM_LEFT:13,BOTTOM_CENTER:14,BOTTOM_RIGHT:15,OVER:16,NONE:17},Fs=function(){function t(){}return t.attach=function(t,e,n,i,r,o,s){if(s!==js.NONE){var a=t.width,u=t.height,l=0;switch(s){case js.LEFT:case js.LEFT_TOP:case js.LEFT_MIDDLE:case js.LEFT_BOTTOM:(l=e.left-a-n)<n&&r-n<(l=e.right+n)+a&&(l=n);break;case js.RIGHT:case js.RIGHT_TOP:case js.RIGHT_MIDDLE:case js.RIGHT_BOTTOM:r-n<(l=e.right+n)+a&&(l=e.left-a-n)<n&&(l=r-a-n);break;case js.TOP:case js.TOP_LEFT:case js.BOTTOM:case js.BOTTOM_LEFT:l=this.adjust(e.left,a,n,r);break;case js.TOP_RIGHT:case js.BOTTOM_RIGHT:l=this.adjust(e.right-a,a,n,r);break;case js.TOP_CENTER:case js.BOTTOM_CENTER:case js.OVER:l=this.adjust(.5*(e.left+e.right-a),a,n,r)}var h=0;switch(s){case js.LEFT:case js.LEFT_TOP:case js.RIGHT:case js.RIGHT_TOP:h=this.adjust(e.top,u,i,o);break;case js.LEFT_MIDDLE:case js.RIGHT_MIDDLE:case js.OVER:h=this.adjust(.5*(e.top+e.bottom-u),u,i,o);break;case js.LEFT_BOTTOM:case js.RIGHT_BOTTOM:h=this.adjust(e.bottom,u,i,o);break;case js.TOP:case js.TOP_LEFT:case js.TOP_RIGHT:case js.TOP_CENTER:(h=e.top-u-i)<i&&o<(h=e.bottom+i)+u&&(h=i);break;case js.BOTTOM:case js.BOTTOM_LEFT:case js.BOTTOM_RIGHT:case js.BOTTOM_CENTER:o-i<(h=e.bottom+i)+u&&(h=e.top-u-i)<i&&(h=o-u-i)}t.position.set(l,h)}},t.adjust=function(t,e,n,i){return t<n?i-n<t+e?.5*(i-e):n:i-n<t+e?i<e?.5*(i-e):i-e-n:t},t}(),Hs={NONE:0,ESC:1,CLICK_OUTSIDE:2},Gs={DIRTY:0,CLEAN:1},Vs=function(){function e(t,e){var n;this._parent=t,this._options=e,e.enable&&(this._util=this.newUtil()),this._mode=ai(null!==(n=e.mode)&&void 0!==n?n:Gs.DIRTY,Gs),this._isEnabled=!0,this._isDirty=!1}return Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},set:function(t){this._mode=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"constraint",{get:function(){var t,e,n=this._constraint;return null==n&&(n=null!==(e=null===(t=this._options)||void 0===t?void 0:t.constraint)&&void 0!==e?e:this.newConstraint(),this._constraint=n),n},set:function(t){this._constraint=t},enumerable:!1,configurable:!0}),e.prototype.newConstraint=function(){var t=this;return function(e,n,i,r){t.toConstrained(e,n,i,r)}},e.prototype.isDirty=function(){return this._isDirty},e.prototype.isClean=function(){return!this._isDirty},e.prototype.toClean=function(){this._isDirty&&(this._isDirty=!1)},e.prototype.newUtil=function(){var e=this,n=new t.Point,i=this._parent,r=i.position;return new _r({bind:i,checker:{start:function(t){if(t.target!==i)return!1;n.copyFrom(t.data.global),i.toLocal(n,void 0,n,!0);var e=n.x,r=n.y;return!(e<0||r<0||i.width<e||i.height<r)}},on:{start:function(){n.copyFrom(r)},move:function(t,o,s){n.set(n.x+o,n.y+s),e._isDirty||(e._isDirty=!0,i.setX(r.x),i.setY(r.y));var a=i.layer;null!=a&&e.constraint(i,a,n.x,n.y)}}})},e.prototype.toConstrained=function(n,i,r,o){var s,a=n.position;if(i){var u=n.getBounds(!1,null!==(s=e.WORK_BOUNDS)&&void 0!==s?s:e.WORK_BOUNDS=new t.Rectangle),l=u.x+r-a.x,h=u.y+o-a.y,c=Math.min(Math.max(0,l),i.width-u.width),p=Math.min(Math.max(0,h),i.height-u.height);a.set(r+c-l,o+p-h)}else a.set(r,o)},e}(),Ws={MODAL:0,MODELESS:1,MENU:2},Ks={MODAL:"MODAL",MODELESS:"MODELESS",MENU:"MENU"},Xs=function(){function e(){}return e.apply=function(t,e){var n=this;t.on(cr.down,(function(i){if(i.target===t){var r=n.point;r.copyFrom(i.data.global),t.toLocal(r,void 0,r,!0);var o=r.x,s=r.y;(o<0||s<0||t.width<o||t.height<s)&&setTimeout((function(){e(i)}),0)}}))},e.point=new t.Point,e}(),Ys=function(){function t(t){this._layer=null,this._application=null==(null==t?void 0:t.parent)?ft.last():null}return Object.defineProperty(t.prototype,"picked",{get:function(){return this._layer},enumerable:!1,configurable:!0}),t.prototype.pick=function(t,e){var n=this._layer;if(null==n){if(null==(n=ft.getLayerOverlay(t))&&null!=e&&(n=ft.getLayerOverlay(e)),null==n){var i=this._application;n=i?i.getLayerOverlay():ft.last().getLayerOverlay()}this._layer=n}return n},t}(),qs=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(t){var n,i,r,o=this;e.prototype.init.call(this,t),this._onPrerenderBound=function(){o.onPrerender()},this._layer=null;var s=this.theme,a=ai(null!==(n=null==t?void 0:t.mode)&&void 0!==n?n:s.getMode(),Ws);this._mode=a,this._alwaysOnTop=null!==(i=null==t?void 0:t.alwaysOnTop)&&void 0!==i?i:s.isAlwaysOnTop(),this._sticky=null!==(r=null==t?void 0:t.sticky)&&void 0!==r?r:s.isSticky(a);var u=this.toCloseOn(a,s,t);switch(this._closeOn=u,this._align=this.toAlign(a,s,t),this._overlay=new Ys,this._gesture=new Vs(this,this.toGestureOptions(a,s,t)),this.visible=!1,a){case Ws.MODAL:this.state.addAll(vt.FOCUS_ROOT,Ks.MODAL);break;case Ws.MODELESS:this.state.add(Ks.MODELESS);break;case Ws.MENU:this.state.addAll(vt.FOCUS_ROOT,Ks.MENU)}u&Hs.CLICK_OUTSIDE&&Xs.apply(this,(function(){o.onCloseOn()}))},n.prototype.toCloseOn=function(t,e,n){var i=null==n?void 0:n.closeOn;if(null==i)return e.closeOn(t);if(Ot(i)){for(var r=Hs.NONE,o=0,s=i.length;o<s;++o)r|=Hs[i[o]];return r}return xt(i)?Hs[i]:i},n.prototype.toAlign=function(t,e,n){var i=null==n?void 0:n.align;return null===i?null:void 0===i?e.getAlign(t):ai(i,js)},Object.defineProperty(n.prototype,"mode",{get:function(){return this._mode},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"align",{get:function(){return this._align},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"algin",{set:function(t){this._align=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"alwaysOnTop",{get:function(){return this._alwaysOnTop},set:function(t){this._alwaysOnTop=t},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"gesture",{get:function(){return this._gesture},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"layer",{get:function(){return this._layer},enumerable:!1,configurable:!0}),n.prototype.toGestureOptions=function(t,e,n){var i=null==n?void 0:n.gesture;return!0===i?{enable:!0,mode:e.getGestureMode(t)}:!1===i?{enable:!1,mode:e.getGestureMode(t)}:null!=i?(void 0===i.enable&&(i.enable=e.isGestureEnabled(t)),void 0===i.mode&&(i.mode=e.getGestureMode(t)),i):{enable:e.isGestureEnabled(t),mode:e.getGestureMode(t)}},n.prototype.onParentResize=function(t,n,i){if(this.isOpened()){var r=this._layer;if(null!=r){var o=this._gesture;if(o.isDirty()){var s=this.position;o.constraint(this,r,s.x,s.y)}}}e.prototype.onParentResize.call(this,t,n,i)},n.prototype.getAnimation=function(){var t,e,n=this,i=this._animation;return void 0===i&&((i=null!==(e=null===(t=this._options)||void 0===t?void 0:t.animation)&&void 0!==e?e:this.theme.newAnimation(this._mode))&&(i.target=this,i.on("end",(function(t){n.onAnimationEnd(t)}))),this._animation=i),i},n.prototype.onAnimationEnd=function(t){if(t)if(this._mode===Ws.MODELESS)this.hide();else{var e=this.parent;e&&e.removeChild(this)}else{var n=ft.getLayer(this);if(n){var i=n.getFocusController();this._focused=i.get(),i.focus(this.findFirstFocusable(i)||this)}}},n.prototype.findFirstFocusable=function(t){return t.find(this,!1,!0,!0)},n.prototype.open=function(t){var e=this,n=this._promise;if(null==n){n=new Promise((function(t,n){e._resolve=t,e._reject=n})),this._promise=n,this._opener=t;var i=null;switch(this._mode){case Ws.MODAL:case Ws.MENU:(i=this._overlay.pick(this,t)).stage.addChild(this);break;case Ws.MODELESS:i=ft.getLayer(this),this.show()}this._layer=i;var r=this._gesture;if(r.mode===Gs.CLEAN&&r.toClean(),null!=i)if(r.isClean()){var o=i.renderer,s=this._onPrerenderBound;this._sticky?o.on("prerender",s):o.once("prerender",s)}else{var a=this.position;r.constraint(this,i,a.x,a.y)}this.bringToFront(),this.onOpen()}return n},n.prototype.onChildFocus=function(t){e.prototype.onChildFocus.call(this,t),this.bringToFront()},n.prototype.onFocus=function(){e.prototype.onFocus.call(this),this.bringToFront()},n.prototype.bringToFront=function(){var t=this.parent;if(null!=t){for(var e=t.children,i=e.length,r=i-1;0<=r&&e[r]!==this;--r);if(!(r<0)){for(var o=r+1;o<i;++o)e[o-1]=e[o];e[i-1]=this,e.sort((function(t,e){return(t instanceof n?t._alwaysOnTop?2:1:0)-(e instanceof n?e._alwaysOnTop?2:1:0)}))}}},n.prototype.onPrerender=function(){var e,i=this._layer;if(null!=i){var r=this._align;if(r!==js.NONE){var o=this._opener;if(null!=r&&null!=o){var s=this._mode,a=o.getBounds(!1,null!==(e=n.WORK_BOUNDS)&&void 0!==e?e:n.WORK_BOUNDS=new t.Rectangle),u=this.theme;Fs.attach(this,a,u.getOffsetX(s),u.getOffsetY(s),i.width,i.height,r)}else this.position.set(.5*(i.width-this.width),.5*(i.height-this.height))}}},n.prototype.onOpen=function(){this.emit("open",this);var t=this.getAnimation();t?t.start():this._mode===Ws.MENU&&(this.visible=!0,this.onAnimationEnd(!1))},n.prototype.isOpened=function(){return null!=this._promise},n.prototype.close=function(){this.doReject()},n.prototype.doResolve=function(t){var e=this._resolve;e&&(this._promise=void 0,this._resolve=void 0,this._reject=void 0,this.onClose(),e(t))},n.prototype.doReject=function(t){var e=this._reject;e&&(this._promise=void 0,this._resolve=void 0,this._reject=void 0,this.onClose(),e(t))},n.prototype.onClose=function(){var t=this._layer,e=this._focused;if(null!=e)if(this._focused=null,t){var n=ft.getLayer(e);null!=n&&t!==n&&n.view.focus(),t.getFocusController().focus(e)}else this.blur(!0);else this.blur(!0);t&&(t.renderer.off("prerender",this._onPrerenderBound),this._layer=null),this._opener=null;var i=this.getAnimation();if(i?i.start(!0):(this.visible=!1,this.onAnimationEnd(!0)),this._alwaysOnTop){var r=this.parent;null!=r&&r.off("childAdded",this._onParentChildAddedBound)}this.emit("close",this)},n.prototype.onKeyDown=function(t){return this._closeOn&Hs.ESC&&no.isCancelKey(t)&&this.onCloseOn(),e.prototype.onKeyDown.call(this,t)},n.prototype.onCloseOn=function(){this.close()},n.prototype.containsGlobalPoint=function(t){switch(this._mode){case Ws.MODAL:case Ws.MENU:return!0;case Ws.MODELESS:return e.prototype.containsGlobalPoint.call(this,t)}},n.prototype.getType=function(){return"DDialog"},n}(ao),Zs={VERTICAL:0,HORIZONTAL:1},Js=function(t){function e(e){var n=t.call(this,e)||this;return n.visible=!1,n}return F(e,t),e.prototype.getType=function(){return"DLayoutSpace"},e}(ao),Qs=function(t){return t instanceof ao&&(t.visible||t instanceof Js)},$s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e);var n=this.theme;this._margin=function(t,e){var n,i,r=null==e?void 0:e.margin;if(null!=r){if(St(r))return{horizontal:r,vertical:r};var o=t.getMargin();return{horizontal:null!==(n=r.horizontal)&&void 0!==n?n:o,vertical:null!==(i=r.vertical)&&void 0!==i?i:o}}return{horizontal:o=t.getMargin(),vertical:o}}(n,e),this._direction=function(t,e){var n=null==e?void 0:e.direction;return null!=n?xt(n)?Zs[n]:n:t.getDirection()}(n,e),this._cornerAdjust=function(t,e){var n=null==e?void 0:e.corner;if(null!=n&&!St(n)){var i=n.adjust;if(null!=i)return i}return t.getCornerAdjust()}(n,e),this._multiplicity=function(t,e){if(e){var n=e.row;if(null!=n)return n;var i=e.column;if(null!=i)return i}return t.getMultiplicity()}(n,e),this._reverse=function(t,e){var n;return null!==(n=null==e?void 0:e.reverse)&&void 0!==n?n:t.getReverse()}(n,e)},Object.defineProperty(e.prototype,"margin",{get:function(){return this._margin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"multiplicity",{get:function(){return this._multiplicity},enumerable:!1,configurable:!0}),e.prototype.getWeightTotal=function(){for(var t=this.children,e=0,n=this._multiplicity,i=this._reverse,r=0,o=t.length;r<o;){for(var s=-1,a=0;a<n&&r+a<o;++a){var u=t[i?o-1-(r+a):r+a];if(Qs(u)){var l=u.getClearType();if(0!==a&&l&Yr.BEFORE)break;if(s=Math.max(s,u.weight),l&&Yr.AFTER){a+=1;break}}else r+=1,a-=1}r+=a,0<=s&&(e+=s)}return e},e.prototype.getSpaceLeft=function(t,e){var n=this.children,i=this._multiplicity,r=this._reverse;if(this._direction===Zs.VERTICAL){for(var o=t,s=0,a=0,u=n.length;a<u;){for(var l=0,h=-1,c=0;c<i&&a+c<u;++c){var p=n[r?u-1-(a+c):a+c];if(Qs(p)){var f=p.getClearType();if(0!==c&&f&Yr.BEFORE)break;if(l=(h=Math.max(h,p.weight))<0?Math.max(l,p.height+s):s,f&Yr.AFTER){c+=1;break}}else a+=1,c-=1}a+=c,o-=l,s=e}return Math.max(0,o)}for(o=t,s=0,a=0,u=n.length;a<u;){var d=0;for(h=-1,c=0;c<i&&a+c<u;++c)if(p=n[r?u-1-(a+c):a+c],Qs(p)){if(f=p.getClearType(),0!==c&&f&Yr.BEFORE)break;if(d=(h=Math.max(h,p.weight))<0?Math.max(d,p.width+s):s,f&Yr.AFTER){c+=1;break}}else a+=1,c-=1;a+=c,o-=d,s=e}return Math.max(0,o)},e.prototype.calcSpaceLeft=function(t,e,n,i){return t?0:this.getSpaceLeft(e-n,i)},e.prototype.onRefit=function(){var n=this.children,i=this._padding,r=i.getTop(),o=i.getBottom(),s=i.getLeft(),a=i.getRight(),u=this._margin,l=u.vertical,h=u.horizontal,c=this.getWeightTotal(),p=this._multiplicity,f=this._reverse,d=this._auto,y=null;if(this._cornerAdjust){var g=4+(n.length<<1);(null==e.CORNER_ADJUST_WORK||e.CORNER_ADJUST_WORK.length<g)&&(e.CORNER_ADJUST_WORK=new Float32Array(g)),(y=e.CORNER_ADJUST_WORK)[0]=-2,y[1]=-2,y[g-2]=-3,y[g-1]=-3}if(this._direction===Zs.VERTICAL){var v=0,_=r-l;if(0<c){for(var m=1/c,b=this.calcSpaceLeft(d.height.isOn,this.height,r+o,l),T=0,w=n.length;T<w;){for(var E=s-h,O=0,C=0;C<p&&T+C<w;++C){var S=n[f?w-1-(T+C):T+C];if(Qs(S)){var x=S.getClearType();if(0!==C&&x&Yr.BEFORE)break;if(S.position.set(h+E,l+_),0<=(j=S.weight)&&(S.height=b*(j*m)),E+=h+S.width,O=Math.max(O,S.height),x&Yr.AFTER){null!=y&&(y[0+(F=T+C+1<<1)]=C,y[F+1]=v),C+=1;break}null!=y&&(y[0+(F=T+C+1<<1)]=C,y[F+1]=v)}else null!=y&&(y[0+(F=T+C+1<<1)]=C-1,y[F+1]=v),T+=1,C-=1}_+=l+O,T+=C,v+=1}if(null!=y)for(T=0,w=n.length;T<w;++T)if(S=n[f?w-1-T:T],Qs(S)){var D=y[0+(H=2+(T<<1))],I=y[H+1],A=-2;if(!((x=S.getClearType())&Yr.BEFORE)){var R=this.findRowIndexPrevious(H,I,y);this.hasClearTypeAfter(n,R)||(A=y[R])}var P=-2;if(!(x&Yr.AFTER)){var M=this.findRowIndexNext(H,I,y);this.hasClearTypeBefore(n,M)||(P=y[M])}var k=this.countColumn(H,I,y);S.corner.mask=this.toCornerMaskColumn(A,D,P,k)}}else{for(T=0,w=n.length;T<w;){for(E=s-h,O=0,C=0;C<p&&T+C<w;++C)if(S=n[f?w-1-(T+C):T+C],Qs(S)){if(x=S.getClearType(),0!==C&&x&Yr.BEFORE)break;if(S.position.set(h+E,l+_),0<=(j=S.weight)&&(S.height=0),E+=h+S.width,O=Math.max(O,S.height),x&Yr.AFTER){null!=y&&(y[0+(F=T+C+1<<1)]=C,y[F+1]=v),C+=1;break}null!=y&&(y[0+(F=T+C+1<<1)]=C,y[F+1]=v)}else null!=y&&(y[0+(F=T+C+1<<1)]=C-1,y[F+1]=v),T+=1,C-=1;_+=l+O,T+=C,v+=1}if(null!=y)for(T=0,w=n.length;T<w;++T)S=n[f?w-1-T:T],Qs(S)&&(D=y[0+(H=2+(T<<1))],I=y[H+1],A=-2,(x=S.getClearType())&Yr.BEFORE||(R=this.findRowIndexPrevious(H,I,y),this.hasClearTypeAfter(n,R)||(A=y[R])),P=-2,x&Yr.AFTER||(M=this.findRowIndexNext(H,I,y),this.hasClearTypeBefore(n,M)||(P=y[M])),k=this.countColumn(H,I,y),S.corner.mask=this.toCornerMaskColumn(A,D,P,k))}}else{var L=0;if(E=s-h,0<c){for(m=1/c,b=this.calcSpaceLeft(d.width.isOn,this.width,s+a,h),T=0,w=n.length;T<w;){_=r-l;var N=0;for(C=0;C<p&&T+C<w;++C)if(S=n[f?w-1-(T+C):T+C],Qs(S)){if(x=S.getClearType(),0!==C&&x&Yr.BEFORE)break;if(S.position.set(h+E,l+_),0<=(j=S.weight)&&(S.width=b*(j*m)),N=Math.max(N,S.width),_+=l+S.height,x&Yr.AFTER){null!=y&&(y[0+(F=T+C+1<<1)]=L,y[F+1]=C),C+=1;break}null!=y&&(y[0+(F=T+C+1<<1)]=L,y[F+1]=C)}else null!=y&&(y[0+(F=T+C+1<<1)]=L,y[F+1]=C-1),T+=1,C-=1;E+=h+N,T+=C,L+=1}if(null!=y)for(T=0,w=n.length;T<w;++T)if(S=n[f?w-1-T:T],Qs(S)){D=y[0+(H=2+(T<<1))],I=y[H+1];var B=-2;(x=S.getClearType())&Yr.BEFORE||(R=this.findColumnIndexPrevious(H,D,y),this.hasClearTypeAfter(n,R)||(B=y[R+1]));var z=-2;x&Yr.AFTER||(M=this.findColumnIndexNext(H,D,y),this.hasClearTypeBefore(n,M)||(z=y[M+1]));var U=this.countRow(H,D,y);S.corner.mask=this.toCornerMaskRow(B,I,z,U)}}else{for(T=0,w=n.length;T<w;){for(_=r-l,N=0,C=0;C<p&&T+C<w;++C)if(S=n[f?w-1-(T+C):T+C],Qs(S)){var j;if(x=S.getClearType(),0!==C&&x&Yr.BEFORE)break;if(S.position.set(h+E,l+_),0<=(j=S.weight)&&(S.width=0),N=Math.max(N,S.width),_+=l+S.height,x&Yr.AFTER){null!=y&&(y[0+(F=T+C+1<<1)]=L,y[F+1]=C),C+=1;break}null!=y&&(y[0+(F=T+C+1<<1)]=L,y[F+1]=C)}else{var F;null!=y&&(y[0+(F=T+C+1<<1)]=L,y[F+1]=C-1),T+=1,C-=1}E+=h+N,T+=C,L+=1}if(null!=y)for(T=0,w=n.length;T<w;++T){var H;S=n[f?w-1-T:T],Qs(S)&&(D=y[0+(H=2+(T<<1))],I=y[H+1],B=-2,(x=S.getClearType())&Yr.BEFORE||(R=this.findColumnIndexPrevious(H,D,y),this.hasClearTypeAfter(n,R)||(B=y[R+1])),z=-2,x&Yr.AFTER||(M=this.findColumnIndexNext(H,D,y),this.hasClearTypeBefore(n,M)||(z=y[M+1])),U=this.countRow(H,D,y),S.corner.mask=this.toCornerMaskRow(B,I,z,U))}}}t.prototype.onRefit.call(this)},e.prototype.hasClearTypeBefore=function(t,e){return this.hasClearType(t,e,Yr.BEFORE)},e.prototype.hasClearTypeAfter=function(t,e){return this.hasClearType(t,e,Yr.AFTER)},e.prototype.hasClearType=function(t,e,n){if(2<=e){var i=e-2>>1;if(0<=i&&i<t.length){var r=t[i];if(r instanceof ao)return!!(r.getClearType()&n)}}return!1},e.prototype.findColumnIndexPrevious=function(t,e,n){for(var i=t-2;0<=i;i-=2)if(n[i]!==e)return i;return 0},e.prototype.findColumnIndexNext=function(t,e,n){for(var i=t+2,r=n.length;i<r;i+=2){var o=n[i];if(o!==e){for(var s=i+2;s<r;s+=2)if(n[s]!==o)return s-2;return i}}return n.length-2},e.prototype.countRow=function(t,e,n){for(var i=t+2,r=n.length;i<r;i+=2)if(n[i]!==e)return n[i-2+1]+1;return 0},e.prototype.findRowIndexPrevious=function(t,e,n){for(var i=t-2;0<=i;i-=2)if(n[i+1]!==e)return i;return 0},e.prototype.findRowIndexNext=function(t,e,n){for(var i=t+2,r=n.length;i<r;i+=2){var o=n[i+1];if(o!==e){for(var s=i+2;s<r;s+=2)if(n[s+1]!==o)return s-2;return i}}return n.length-2},e.prototype.countColumn=function(t,e,n){for(var i=t+2,r=n.length;i<r;i+=2)if(n[i+1]!==e)return n[i-2+0]+1;return 0},e.prototype.toCornerMaskColumn=function(t,e,n,i){var r=Mr.NONE;return t+1<e&&0===e&&(r|=Mr.TOP_LEFT),n+1<e&&0===e&&(r|=Mr.BOTTOM_LEFT),t<e&&e+1===i&&(r|=Mr.TOP_RIGHT),n<e&&e+1===i&&(r|=Mr.BOTTOM_RIGHT),Mr.ALL&~r},e.prototype.toCornerMaskRow=function(t,e,n,i){var r=Mr.NONE;return t+1<e&&0===e&&(r|=Mr.TOP_LEFT),n+1<e&&0===e&&(r|=Mr.TOP_RIGHT),t<e&&e+1===i&&(r|=Mr.BOTTOM_LEFT),n<e&&e+1===i&&(r|=Mr.BOTTOM_RIGHT),Mr.ALL&~r},e.prototype.addSpace=function(t){return this.addChild(new Js(t))},e.prototype.getType=function(){return"DLayout"},e.CORNER_ADJUST_WORK=null,e}(ao),ta=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DLayoutVertical"},e}($s),ea=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogLayeredContent"},e}(ta),na={CLICKED:0,DOUBLE_CLICKED:1},ia={TEXT:0,PADDING:1,BORDER:2},ra={LEFT:0,CENTER:1,RIGHT:2},oa={TOP:0,MIDDLE:1,BOTTOM:2},sa=function(){function t(){this._pieces=[],this._bounds=[],this._size=0,this._margin=0}return t.prototype.clear=function(){this._pieces.length=0,this._bounds.length=0,this._size=0,this._margin=0,this._text=void 0},t.prototype.set=function(t){this._text=t},Object.defineProperty(t.prototype,"size",{get:function(){return this._size-(null===this._text?this._margin:0)},enumerable:!1,configurable:!0}),t}(),aa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.add=function(t,e,n){this._pieces.push(t),this._bounds.push(e),this._size+=n+e.height,this._margin=n},e.prototype.execute=function(t,e){var n=this._pieces,i=this._bounds,r=e-t;if(void 0!==this._text)for(var o=0,s=0,a=n.length;s<a;++s){var u=n[s],l=i[s],h=u.object;r-=o+l.height,h.y=r-l.y,o=u.margin.horizontal}else for(s=0,a=n.length;s<a;++s)u=n[s],l=i[s],h=u.object,r-=u.margin.horizontal+l.height,h.y=r-l.y},e}(sa),ua=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.add=function(t,e,n){this._pieces.push(t),this._bounds.push(e),this._size=Math.max(this.size,e.width)},e.prototype.execute=function(t,e,n){for(var i=t+.5*(n-t-e),r=this._pieces,o=this._bounds,s=0,a=r.length;s<a;++s){var u=r[s],l=o[s];u.object.x=i-l.x-.5*l.width}},e}(sa),la=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.add=function(t,e,n){this._pieces.push(t),this._bounds.push(e),this._size+=n+e.width,this._margin=n},e.prototype.execute=function(t){var e=this._pieces,n=this._bounds,i=t;if(void 0!==this._text)for(var r=0,o=e.length;r<o;++r){var s=e[r],a=n[r];(u=s.object).x=i-a.x,i+=a.width+s.margin.horizontal}else for(r=0,o=e.length;r<o;++r){s=e[r],a=n[r];var u=s.object;i+=s.margin.horizontal,u.x=i-a.x,i+=a.width}},e}(sa),ha=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.add=function(t,e,n){this._pieces.push(t),this._bounds.push(e),this._size=Math.max(this.size,e.height)},e.prototype.execute=function(t,e,n){for(var i=t+.5*(n-t-e),r=this._pieces,o=this._bounds,s=0,a=r.length;s<a;++s){var u=r[s],l=o[s];u.object.y=i-l.y-.5*l.height}},e}(sa),ca=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.add=function(t,e,n){this._pieces.push(t),this._bounds.push(e),this._size+=n+e.width,this._margin=n},e.prototype.execute=function(t,e){var n=this._pieces,i=this._bounds,r=e-t;if(void 0!==this._text)for(var o=0,s=0,a=n.length;s<a;++s){var u=n[s],l=i[s],h=u.object;r-=o+l.width,h.x=r-l.x,o=u.margin.horizontal}else for(s=0,a=n.length;s<a;++s)u=n[s],l=i[s],h=u.object,r-=u.margin.horizontal+l.width,h.x=r-l.x},e}(sa),pa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.add=function(t,e,n){this._pieces.push(t),this._bounds.push(e),this._size+=n+e.height,this._margin=n},e.prototype.execute=function(t){var e=this._pieces,n=this._bounds,i=t;if(void 0!==this._text)for(var r=0,o=0,s=e.length;o<s;++o){var a=e[o],u=n[o];(l=a.object).y=r+i-u.y,i+=u.height,r=a.margin.vertical}else for(o=0,s=e.length;o<s;++o){a=e[o],u=n[o];var l=a.object;i+=a.margin.vertical,l.y=i-u.y,i+=u.height}},e}(sa),fa=function(){function t(){this.left=new la,this.center=new ua,this.right=new ca,this.top=new pa,this.middle=new ha,this.bottom=new aa}return t.prototype.clear=function(){this.left.clear(),this.center.clear(),this.right.clear(),this.top.clear(),this.middle.clear(),this.bottom.clear(),this.text=void 0},t.prototype.add=function(t){var e=t.object;if(null!=e){var n=e.getLocalBounds(),i=t.margin,r=t.align;switch(r.horizontal){case ra.LEFT:this.left.add(t,n,i.horizontal);break;case ra.CENTER:this.center.add(t,n,i.horizontal);break;case ra.RIGHT:this.right.add(t,n,i.horizontal)}switch(r.vertical){case oa.TOP:this.top.add(t,n,i.vertical);break;case oa.MIDDLE:this.middle.add(t,n,i.vertical);break;case oa.BOTTOM:this.bottom.add(t,n,i.vertical)}}},t.prototype.set=function(t){this.left.set(t),this.center.set(t),this.right.set(t),this.top.set(t),this.middle.set(t),this.bottom.set(t),this.text=t},Object.defineProperty(t.prototype,"width",{get:function(){var t=this.text,e=this.left.size,n=this.center.size,i=this.right.size;return void 0!==t?null!==t?Math.max(e+t.width+i,n):Math.max(e+i,n):Math.max(e,i,n)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){var t=this.text,e=this.top.size,n=this.middle.size,i=this.bottom.size;return void 0!==t?null!==t?Math.max(e+t.height+i,n):Math.max(e+i,n):Math.max(e,i,n)},enumerable:!1,configurable:!0}),t.prototype.execute=function(t,e,n,i,r,o,s){var a=this.left,u=this.center,l=this.right,h=this.top,c=this.middle,p=this.bottom,f=this.text;if(void 0!==f){var d=a.size,y=l.size,g=h.size,v=p.size,_=0,m=0,b=0;switch(null!=f&&(f.setClippingDelta(d+y,g+v),m=f.width,b=f.height),r.horizontal){case ra.LEFT:_=t+d;break;case ra.CENTER:_=t+.5*(o-t-n-(d+m+y))+d;break;case ra.RIGHT:_=o-n-y-m}var T=0;switch(r.vertical){case oa.TOP:T=e+g;break;case oa.MIDDLE:T=e+.5*(s-e-i-(g+b+v))+g;break;case oa.BOTTOM:T=s-i-v-b}null!=f&&f.position.set(_,T),a.execute(_-d),u.execute(0,0,2*_+m),l.execute(0,_+m+y),h.execute(T-g),c.execute(0,0,2*T+b),p.execute(0,T+b+v)}else a.execute(t),u.execute(t,n,o),l.execute(n,o),h.execute(e),c.execute(e,i,s),p.execute(i,s)},t}(),da=function(){function t(){this.text=new fa,this.padding=new fa,this.border=new fa}return t.prototype.clear=function(){this.text.clear(),this.padding.clear(),this.border.clear()},t.prototype.add=function(t){if(t.object)switch(t.align.with){case ia.TEXT:this.text.add(t);break;case ia.PADDING:this.padding.add(t);break;case ia.BORDER:this.border.add(t)}},t.prototype.set=function(t){this.text.set(t)},t.prototype.execute=function(t,e,n,i){var r=t.getLeft(),o=t.getTop(),s=t.getRight(),a=t.getBottom();null==n&&(n=r+this.width+s),null==i&&(i=o+this.height+a),this.border.execute(0,0,0,0,e,n,i),this.padding.execute(r,o,s,a,e,n,i),this.text.execute(r,o,s,a,e,n,i)},Object.defineProperty(t.prototype,"width",{get:function(){return Math.max(this.border.width,this.padding.width,this.text.width)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"height",{get:function(){return Math.max(this.border.height,this.padding.height,this.text.height)},enumerable:!1,configurable:!0}),t}(),ya=function(t){function e(e){var n=t.call(this)||this;return n.parent=e,n._isInitialized=!1,n._width=n.width,n._height=n.height,n}return F(e,t),e.prototype.render=function(e){this.updateTransform(),t.prototype.render.call(this,e)},e.prototype.onReflow=function(t,e,n){this._isInitialized&&this._width===e&&this._height===n||(this._isInitialized=!0,this._width=e,this._height=n,this.clear(),this.beginFill(16777215,1),this.drawRect(0,0,e,n),this.endFill())},e}(t.Graphics),ga=function(){function t(t,e,n,i){this.x=t,this.y=e,this.character=n,this.wrappable=i}return t.prototype.set=function(t,e,n,i){this.x=t,this.y=e,this.character=n,this.wrappable=i},t}(),va=function(){function t(){this.count=0,this.countPerLine=0,this.width=0,this.height=0,this.characters=[],this.scale=1,this.scaled=!1,this.clipped=!1,this.x=0,this.y=0}return t.prototype.start=function(t,e){this.count=0,this.countPerLine=0,this.width=0,this.height=0,this.scale=1,this.scaled=!1,this.clipped=!1,this.x=0,this.y=.5*(t-e)},t.prototype.isPushable=function(t,e){return!(t<this.x+e.advance&&!(e.type&Ki.SPACE))},t.prototype.isPushableAtNewLine=function(t,e,n){return this.y+1.5*e+.5*n<=t},t.prototype.push=function(t,e){var n=this.x;this.x+=t.advance;var i=this.y,r=this.count,o=this.characters;r<o.length?o[r].set(n,i,t,e):o.push(new ga(n,i,t,e)),this.count+=1,this.countPerLine+=1},t.prototype.newLine=function(t){this.width=Math.max(this.width,this.x),this.x=0,this.y+=t,this.countPerLine=0},t.prototype.wordWrap=function(t){var e=this.countPerLine,n=this.characters;if(0<e){for(var i=this.count,r=i-1,o=i-e;o<r;--r){var s=n[r];if(s.wrappable){var a=s.character.advance,u=s.y+t;s.x=0,s.y=u;for(var l=r+1;l<i;++l)(s=n[l]).x=a,s.y=u,a+=s.character.advance;return this.x=a,this.y=u,this.countPerLine=i-r,!0}}var h=n[i-1];return h.x=0,h.y=h.y+t,this.x=h.character.advance,this.y=h.y,this.countPerLine=1,!1}return!1},t.prototype.pop=function(){var t=this.countPerLine,e=this.characters;if(0<t){var n=e[this.count-1];return this.x-=n.character.advance,this.count-=1,this.countPerLine-=1,!0}return!1},t.prototype.fit=function(t,e){var n=this.width,i=this.height;1e-4<n&&t<n?1e-4<i&&e<i?(this.scale=Math.min(t/n,e/i),this.scaled=!0):(this.scale=t/n,this.scaled=!0):1e-4<i&&e<i&&(this.scale=e/i,this.scaled=!0)},t.prototype.end=function(t,e){this.newLine(t),this.y-=.5*(t-e),this.height=this.y},t}(),_a=function(){function t(){this.target="",this.position=0}return t.prototype.init=function(t){this.target=t,this.position=0},t.prototype.hasNext=function(){return this.position<this.target.length},t.prototype.findNextBreak=function(t,e){for(var n=t.length,i=e;i<n;++i){var r=t.charCodeAt(i);if(!(C.SURROGATE.LOW.FROM<=r&&r<=C.SURROGATE.LOW.TO||C.VARIATION.FROM<=r&&r<=C.VARIATION.TO))return i}return n},t.prototype.next=function(){var t=this.target,e=this.position,n=this.findNextBreak(t,e+1),i=t.substring(e,n);return this.position=n,i},t.prototype.close=function(){var t=this.target.length;return this.position<t&&(this.position=t,!0)},t.from=function(e){null==t._instance&&(t._instance=new t);var n=t._instance;return n.init(e),n},t._instance=null,t}(),ma={NONE:0,NORMAL:1,BREAK_ALL:2},ba=function(){function t(){}return t.measure=function(e,n,i){var r=t.RESULT||new va;if(t.RESULT=r,null!=n){var o=_a.from(e),s=n.font.height,a=i.lineHeight,u=i.fitting,l=!u&&i.clipping,h=i.width,c=i.height,p=!u&&i.wordWrap;switch(r.start(a,s),p){case ma.BREAK_ALL:l?this.measure1(o,h,c,s,a,n,r):this.measure2(o,h,a,n,r);break;case ma.NORMAL:var f=this.newLineBreaker(e);f?l?this.measure1a(f,o,h,c,s,a,n,r):this.measure2a(f,o,h,a,n,r):l?this.measure1b(o,h,c,s,a,n,r):this.measure2b(o,h,a,n,r);break;default:l?this.measure3(o,h,c,s,a,n,r):this.measure4(o,a,n,r)}r.end(a,s),u&&r.fit(h,c)}else r.start(0,0),r.end(0,0);return r},t.measure1a=function(t,e,n,i,r,o,s,a){for(var u=t.next();e.hasNext();){var l=e.position,h=e.next();if(h===C.NEW_LINE)a.isPushableAtNewLine(i,o,r)?a.newLine(o):this.measure5(e,n,o,s,a,!0);else{var c=s.get(h);if(null==c)continue;u=this.advance(l,u,t);var p=this.isWrappable1(l,u);a.isPushable(n,c)?a.push(c,p):a.isPushableAtNewLine(i,o,r)?(a.push(c,p),a.wordWrap(o)):this.measure5(e,n,o,s,a,!0)}}},t.measure1b=function(t,e,n,i,r,o,s){for(;t.hasNext();){var a=t.next();if(a===C.NEW_LINE)s.isPushableAtNewLine(n,r,i)?s.newLine(r):this.measure5(t,e,r,o,s,!0);else{var u=o.get(a);if(null==u)continue;var l=this.isWrappable2(s,u);s.isPushable(e,u)?s.push(u,l):s.isPushableAtNewLine(n,r,i)?(s.push(u,l),s.wordWrap(r)):this.measure5(t,e,r,o,s,!0)}}},t.measure1=function(t,e,n,i,r,o,s){for(;t.hasNext();){var a=t.next();if(a===C.NEW_LINE)s.isPushableAtNewLine(n,r,i)?s.newLine(r):this.measure5(t,e,r,o,s,!0);else{var u=o.get(a);if(null==u)continue;s.isPushable(e,u)?s.push(u,!0):s.isPushableAtNewLine(n,r,i)?(s.newLine(r),s.push(u,!0)):this.measure5(t,e,r,o,s,!0)}}},t.measure2a=function(t,e,n,i,r,o){for(var s=t.next();e.hasNext();){var a=e.position,u=e.next();if(u===C.NEW_LINE)o.newLine(i);else{var l=r.get(u);if(null==l)continue;s=this.advance(a,s,t);var h=this.isWrappable1(a,s);o.isPushable(n,l)?o.push(l,h):(o.push(l,h),o.wordWrap(i))}}},t.measure2b=function(t,e,n,i,r){for(;t.hasNext();){var o=t.next();if(o===C.NEW_LINE)r.newLine(n);else{var s=i.get(o);if(null==s)continue;var a=this.isWrappable2(r,s);r.isPushable(e,s)?r.push(s,a):(r.push(s,a),r.wordWrap(n))}}},t.measure2=function(t,e,n,i,r){for(;t.hasNext();){var o=t.next();if(o===C.NEW_LINE)r.newLine(n);else{var s=i.get(o);if(null==s)continue;r.isPushable(e,s)||r.newLine(n),r.push(s,!1)}}},t.measure3=function(t,e,n,i,r,o,s){for(;t.hasNext();){var a=t.next();if(a===C.NEW_LINE)s.isPushableAtNewLine(n,r,i)?s.newLine(r):this.measure5(t,e,r,o,s,!0);else{var u=o.get(a);if(null==u)continue;s.isPushable(e,u)?s.push(u,!1):this.measure5(t,e,r,o,s,!1)}}},t.measure4=function(t,e,n,i){for(;t.hasNext();){var r=t.next();if(r===C.NEW_LINE)i.newLine(e);else{var o=n.get(r);if(null==o)continue;i.push(o,!1)}}},t.measure5=function(t,e,n,i,r,o){r.clipped=!0;var s=i.get(C.DOTS);if(null!=s){for(;!r.isPushable(e,s)&&r.pop(););r.isPushable(e,s)&&r.push(s,!1)}if(o)t.close();else for(;t.hasNext();)if(t.next()===C.NEW_LINE){r.newLine(n);break}},t.isWrappable2=function(t,e){if(t.countPerLine<=0)return!1;var n=t.characters[t.count-1].character.type,i=e.type;return n&Ki.SPACE?!(i&Ki.SPACE||n&Ki.NON_BREAKING):!(i&Ki.SPACE||n&Ki.NON_BREAKING&&i&Ki.NON_BREAKING)},t.advance=function(t,e,n){return e.done||t<=e.value.end?e:e=n.next()},t.isWrappable1=function(t,e){if(e.done)return!1;var n=e.value;return n.start===t||n.end===t},t.newLineBreaker=function(t){return"css-line-break"in window?window["css-line-break"].LineBreaker(t,{lineBreak:"strict",wordBreak:"normal"}):null},t.RESULT=null,t}(),Ta=function(t){function e(){var n,i,r,o=t.call(this,null!==(n=e.VERTICES)&&void 0!==n?n:e.VERTICES=new Float32Array(0),null!==(i=e.UVS)&&void 0!==i?i:e.UVS=new Float32Array(0),null!==(r=e.INDICES)&&void 0!==r?r:e.INDICES=new Uint16Array(0))||this;return o.width=0,o.height=0,o.scale=1,o.scaled=!1,o.clipped=!1,o.vertexBuffer=o.getBuffer("aVertexPosition"),o.vertices=e.VERTICES,o.uvBuffer=o.getBuffer("aTextureCoord"),o.uvs=e.UVS,o.indexBuffer=o.getIndex(),o.indices=e.INDICES,o.nchars=0,o}return F(e,t),e.prototype.update=function(t,e,n){var i=ba.measure(t,e,n),r=i.count,o=(r>>3)+(7&r?1:0)<<3;if(this.nchars<o){this.nchars=o;var s=o<<3;this.vertices=new Float32Array(s),this.uvs=new Float32Array(s),this.vertexBuffer.data=this.vertices,this.uvBuffer.data=this.uvs;var a=(o<<2)+(o<<1);this.indices=new Uint16Array(a),this.indexBuffer.data=this.indices,this.initIndices(this.indices),this.indexBuffer.update()}else o=this.nchars;if(!(o<=0)){var u=this.vertices,l=this.uvs;if(null!=e){for(var h=i.characters,c=i.scale,p=1/e.width,f=1/e.height,d=0;d<r;++d){var y=h[d],g=y.x,v=y.y,_=y.character;this.fill(u,l,d,g,v,c,_,p,f)}for(d=r;d<o;++d)this.fillBlank(u,l,d);this.width=i.width*c,this.height=i.height*c,this.scale=c,this.scaled=i.scaled,this.clipped=i.clipped}else{for(d=0;d<o;++d)this.fillBlank(u,l,d);this.width=0,this.height=0,this.scale=1,this.scaled=!1,this.clipped=!1}this.vertexBuffer.update(),this.uvBuffer.update()}},e.prototype.fill=function(t,e,n,i,r,o,s,a,u){var l=s.x,h=s.y,c=s.width,p=s.height,f=(i+(l-s.origin.x))*o,d=r*o,y=f+c*o,g=d+p*o,v=n<<3;t[v+0]=f,t[v+1]=d,t[v+2]=y,t[v+3]=d,t[v+4]=y,t[v+5]=g,t[v+6]=f,t[v+7]=g;var _=l*a,m=h*u,b=(l+c)*a,T=(h+p)*u;e[v+0]=_,e[v+1]=m,e[v+2]=b,e[v+3]=m,e[v+4]=b,e[v+5]=T,e[v+6]=_,e[v+7]=T},e.prototype.fillBlank=function(t,e,n){var i=n<<3;t[i+0]=0,t[i+1]=0,t[i+2]=0,t[i+3]=0,t[i+4]=0,t[i+5]=0,t[i+6]=0,t[i+7]=0,e[i+0]=0,e[i+1]=0,e[i+2]=0,e[i+3]=0,e[i+4]=0,e[i+5]=0,e[i+6]=0,e[i+7]=0},e.prototype.initIndices=function(t){for(var e=0,n=this.nchars<<2,i=0;e<n;e+=4,i+=6)t[i]=e,t[i+1]=e+1,t[i+2]=e+3,t[i+3]=e+1,t[i+4]=e+2,t[i+5]=e+3},e}(t.MeshGeometry),wa=function(e){function n(n){var i=e.call(this,new Ta,new t.MeshMaterial(t.Texture.EMPTY))||this;return i._style=n,n.on("change",(function(){i.onStyleChange()})),i._text="",i._textApproved="",i._isDirty=!0,i._isGeometryDirty=!0,i._atlas=null,i._atlasRevisionUpdated=0,i._width=0,i._height=0,i._modifier={clipping:!1,fitting:!1,wordWrap:ma.NONE,width:0,height:0,lineHeight:0,delta:{width:0,height:0}},i}return F(n,e),n.prototype.onStyleChange=function(){this._isDirty=!0,this._isGeometryDirty=!0,this._atlas=null,this.update_()},n.prototype.update_=function(){var t=ft.getLayer(this);if(t&&this._isDirty){this._isDirty=!1;var e=this._text,n=this._textApproved;this._textApproved=e;var i=this._style,r=i.fontId,o=i.fontIdApproved,s=i.fontIdFontSize,a=i.fill,u=i.fillApproved;i.approve();var l=t.getDynamicFontAtlases();e===n&&r===o&&a===u||(l.add(r,s,a,e),l.remove(o,u,n))}},Object.defineProperty(n.prototype,"text",{get:function(){return this._text},set:function(t){this._text!==t&&(this._text=t,this._style.unfit()||(this._isDirty=!0,this._isGeometryDirty=!0,this.update_()))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"width",{get:function(){return this.update(),Math.abs(this.scale.x)*this.geometry.width},set:function(t){this.update();var e=this.geometry.width;if(1e-4<e){var n=t/e;this.scale.x=0<=this.scale.x?+n:-n}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.update(),Math.abs(this.scale.y)*this.geometry.height},set:function(t){this.update();var e=this.geometry.height;if(1e-4<e){var n=t/e;this.scale.y=0<=this.scale.y?+n:-n}},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"clipped",{get:function(){return this.geometry.clipped},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"style",{get:function(){return this._style},enumerable:!1,configurable:!0}),n.prototype.update=function(){var t=this;this.update_();var e=this._style,n=this._atlas;if(null==n){var i=ft.getLayer(this);i&&null!=(n=i.getDynamicFontAtlases().get(e.fontId,e.fill))&&(this._atlasRevisionUpdated=n.getRevisionUpdate(),this._atlas=n,this.texture=n.texture,this._isGeometryDirty=!0)}else{var r=n.getRevisionUpdate();r!==this._atlasRevisionUpdated&&(this._atlasRevisionUpdated=r,this._isGeometryDirty=!0)}var o=this._modifier;if(this.updateClipping(e,o)&&(this._isGeometryDirty=!0),this._isGeometryDirty){this._isGeometryDirty=!1;var s=this.geometry;if(s.update(this._text,n,o),o.fitting&&!e.isFontFitted&&s.scaled){var a=s.scale,u=e.fontSize,l=e.toFontId(Math.ceil(u*a*1e3)/1e3),h=qi.toSize(l),c=h/u,p=e.lineHeight*c;e.fit(h,p)&&setTimeout((function(){ft.update(t)}),0)}}},n.prototype.updateClipping=function(t,e){var n=!1,i=t.clipping;e.clipping!==i&&(e.clipping=i,n=!0);var r=t.fitting;e.fitting!==r&&(e.fitting=r,n=!0);var o=t.wordWrap;e.wordWrap!==o&&(e.wordWrap=o,n=!0);var s=r?t.lineHeightFitted:t.lineHeight;if(e.lineHeight!==s&&(e.lineHeight=s,n=!0),i||r||o){var a=this.parent;if(a instanceof ao){var u=a.padding,l=a.width-u.getLeft()-u.getRight()-e.delta.width;e.width!==l&&(e.width=l,n=!0);var h=a.height-u.getTop()-u.getBottom()-e.delta.height;e.height!==h&&(e.height=h,n=!0)}}return n},n.prototype.setClippingDelta=function(t,e){var n=this._modifier.delta;n.width=t,n.height=e},n.prototype._calculateBounds=function(){this.update();var t=this.geometry;this._bounds.addFrame(this.transform,0,0,t.width,t.height)},n.prototype._render=function(t){this.update(),e.prototype._render.call(this,t)},n}(t.Mesh),Ea=function(t){function e(e,n,i){var r,o,s,a,u,l,h,c,p,f=t.call(this)||this;return f._id=0,f._idApproved=-1,i?(f._fontFamily=null!==(r=i.fontFamily)&&void 0!==r?r:n.getFontFamilly(),f._fontSize=null!==(o=i.fontSize)&&void 0!==o?o:n.getFontSize(),f._fontStyle=null!==(s=i.fontStyle)&&void 0!==s?s:n.getFontStyle(),f._fontVariant=null!==(a=i.fontVariant)&&void 0!==a?a:n.getFontVariant(),f._fontWeight=null!==(u=i.fontWeight)&&void 0!==u?u:n.getFontWeight(),f._clipping=null!==(l=i.clipping)&&void 0!==l?l:n.getTextStyleClipping(),f._fitting=null!==(h=i.fitting)&&void 0!==h?h:n.getTextStyleFitting(),f._wordWrap=ai(null!==(c=i.wordWrap)&&void 0!==c?c:n.getTextStyleWordWrap(),ma),f._lineHeight=null!==(p=i.lineHeight)&&void 0!==p?p:n.getLineHeight()):(f._fontFamily=n.getFontFamilly(),f._fontSize=n.getFontSize(),f._fontStyle=n.getFontStyle(),f._fontVariant=n.getFontVariant(),f._fontWeight=n.getFontWeight(),f._clipping=n.getTextStyleClipping(),f._fitting=n.getTextStyleFitting(),f._wordWrap=n.getTextStyleWordWrap(),f._lineHeight=n.getLineHeight()),f._fill=n.getColor(e.state),f._fontSizeFitted=f._fontSize,f._lineHeightFitted=f._lineHeight,f._isFontFitted=!1,f._fontIdFontSize=f._fontSize,f._fontIdId=-1,f._fontId="",f._fontIdApproved="",f._fillApproved=0,f}return F(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"idApproved",{get:function(){return this._idApproved},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontId",{get:function(){return this.update(),this._fontId},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontIdFontSize",{get:function(){return this.update(),this._fontSizeFitted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontIdApproved",{get:function(){return this._fontIdApproved},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fill},set:function(t){this._fill!==t&&(this._fill=t,this.onChange())},enumerable:!1,configurable:!0}),e.prototype.onChange=function(){this._id+=1,this.emit("change",this)},Object.defineProperty(e.prototype,"fillApproved",{get:function(){return this._fillApproved},enumerable:!1,configurable:!0}),e.prototype.approve=function(){this.update(),this._idApproved=this._id,this._fontIdApproved=this._fontId,this._fillApproved=this._fill},Object.defineProperty(e.prototype,"fontFamily",{get:function(){return this._fontFamily},set:function(t){this._fontFamily!==t&&(this._fontFamily=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSize",{get:function(){return this._fontSize},set:function(t){this._fontSize!==t&&(this._fontSize=t,this._fontSizeFitted=t,this._lineHeightFitted=this._lineHeight,this._isFontFitted=!1,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontSizeFitted",{get:function(){return this._fontSizeFitted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isFontFitted",{get:function(){return this._isFontFitted},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontStyle",{get:function(){return this._fontStyle},set:function(t){this._fontStyle!==t&&(this._fontStyle=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontVariant",{get:function(){return this._fontVariant},set:function(t){this._fontVariant!==t&&(this._fontVariant=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fontWeight",{get:function(){return this._fontWeight},set:function(t){this._fontWeight!==t&&(this._fontWeight=t,this.onChange())},enumerable:!1,configurable:!0}),e.prototype.update=function(){if(this._fontIdId!==this._id){this._fontIdId=this._id;var t=this._fitting?this._fontSizeFitted:this._fontSize;this._fontIdFontSize=t,this._fontId=this.toFontId(t)}},e.prototype.toFontId=function(t){return"".concat(this._fontStyle," ").concat(this._fontVariant," ").concat(this._fontWeight," ").concat(t,"px ").concat(this._fontFamily)},Object.defineProperty(e.prototype,"clipping",{get:function(){return this._clipping},set:function(t){this._clipping!==t&&(this._clipping=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fitting",{get:function(){return this._fitting},set:function(t){this._fitting!==t&&(this._fitting=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"wordWrap",{get:function(){return this._wordWrap},set:function(t){this._wordWrap!==t&&(this._wordWrap=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeight",{get:function(){return this._lineHeight},set:function(t){this._lineHeight!==t&&(this._lineHeight=t,this._fontSizeFitted=this._fontSize,this._lineHeightFitted=t,this._isFontFitted=!1,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"lineHeightFitted",{get:function(){return this._lineHeightFitted},set:function(t){this._lineHeightFitted!==t&&(this._lineHeightFitted=t,this.onChange())},enumerable:!1,configurable:!0}),e.prototype.fit=function(t,e){var n=!1;return t<this._fontSizeFitted&&(this._fontSizeFitted=t,n=!0),this._lineHeightFitted!==e&&(this._lineHeightFitted=e,n=!0),!0!==this._isFontFitted&&(this._isFontFitted=!0,n=!0),n&&this.onChange(),n},e.prototype.unfit=function(){var t=!1;return!1!==this._isFontFitted&&(this._isFontFitted=!1,t=!0),this._fontSizeFitted!==this._fontSize&&(this._fontSizeFitted=this._fontSize,t=!0),this._lineHeightFitted!==this._lineHeight&&(this._lineHeightFitted=this._lineHeight,t=!0),t&&this.onChange(),t},e}(t.utils.EventEmitter),Oa=function(){function t(t,e,n){var i,r;this._parent=t,this._vertical=ai(null!==(i=null==n?void 0:n.vertical)&&void 0!==i?i:e.getTextAlignVertical(),oa),this._horizontal=ai(null!==(r=null==n?void 0:n.horizontal)&&void 0!==r?r:e.getTextAlignHorizontal(),ra)}return Object.defineProperty(t.prototype,"vertical",{get:function(){return this._vertical},set:function(t){t=ai(t,oa),this._vertical!==t&&(this._vertical=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontal",{get:function(){return this._horizontal},set:function(t){t=ai(t,ra),this._horizontal!==t&&(this._horizontal=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;return null!=t&&(t=ai(t,oa),this._vertical!==t&&(this._vertical=t,n=!0)),null!=e&&(e=ai(e,ra),this._horizontal!==e&&(this._horizontal=e,n=!0)),n&&this.onChange(),this},t.prototype.onChange=function(){var t=this._parent;t.toDirty(),ft.update(t)},t}(),Ca=function(){function t(t,e){this._parent=t,this._style=e}return Object.defineProperty(t.prototype,"fontFamily",{get:function(){return this._style.fontFamily},set:function(t){var e=this._style;e.fontFamily!==t&&(e.fontFamily=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontSize",{get:function(){return this._style.fontSize},set:function(t){var e=this._style;e.fontSize!==t&&(e.fontSize=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontStyle",{get:function(){return this._style.fontStyle},set:function(t){var e=this._style;e.fontStyle!==t&&(e.fontStyle=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontVariant",{get:function(){return this._style.fontVariant},set:function(t){var e=this._style;e.fontVariant!==t&&(e.fontVariant=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fontWeight",{get:function(){return this._style.fontWeight},set:function(t){var e=this._style;e.fontWeight!==t&&(e.fontWeight=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clipping",{get:function(){return this._style.clipping},set:function(t){var e=this._style;e.clipping!==t&&(e.clipping=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fitting",{get:function(){return this._style.fitting},set:function(t){var e=this._style;e.fitting!==t&&(e.fitting=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"wordWrap",{get:function(){return this._style.wordWrap},set:function(t){t=ai(t,ma);var e=this._style;e.wordWrap!==t&&(e.wordWrap=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lineHeight",{get:function(){return this._style.lineHeight},set:function(t){var e=this._style;e.lineHeight!==t&&(e.lineHeight=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.onChange=function(){ft.update(this._parent)},t}(),Sa=function(t){function e(e,n,i){var r,o,s=t.call(this)||this;s._parent=e,s._theme=n,s._value=null!==(r=null==i?void 0:i.value)&&void 0!==r?r:n.newTextValue(),s._computed=s.newComputed(),s._color=null==i?void 0:i.color,s._alpha=null==i?void 0:i.alpha;var a=new Ea(e,n,null==i?void 0:i.style);return s._dstyle=a,s._style=new Ca(e,a),s._align=new Oa(e,n,null==i?void 0:i.align),s._formatter=null!==(o=null==i?void 0:i.formatter)&&void 0!==o?o:n.getTextFormatter(),s._isVisible=!0,s.onComputedChange(),s.updateObject()&&(e.toDirty(),ft.update(e)),s}return F(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value!==t&&(this._value=t,this.onValueChange())},enumerable:!1,configurable:!0}),e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(t,e){(e||this._value!==t)&&(this._value=t,this.onValueChange(e))},e.prototype.onValueChange=function(t){var e=this.newComputed();if((t||this._computed!==e)&&(this._computed=e,this.onComputedChange(),this.updateObject())){var n=this._parent;n.toDirty(),ft.update(n)}},e.prototype.compute=function(t){this.onValueChange(t)},Object.defineProperty(e.prototype,"computed",{get:function(){return this._computed},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formatter",{get:function(){return this._formatter},set:function(t){this._formatter!==t&&(this._formatter=t,this.onValueChange(!0))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this.onColorChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this.onColorChange())},enumerable:!1,configurable:!0}),e.prototype.onColorChange=function(){var t=this._object;if(null!=t){var e=this._parent,n=e.state,i=this.newColor(n),r=this.newAlpha(n),o=t.style;o.fill===i&&t.alpha===r||(o.fill=i,t.alpha=r,ft.update(e))}},Object.defineProperty(e.prototype,"align",{get:function(){return this._align},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return this._style},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"object",{get:function(){return this._object},enumerable:!1,configurable:!0}),e.prototype.update=function(t){var e=this.newComputed();this._computed!==e&&(this._computed=e,this.onComputedChange(),this.updateObject());var n=this._object;if(null!=n){var i=this._parent.state;n.style.fill=this.newColor(i),n.alpha=this.newAlpha(i),t.set(n)}else t.set(null)},e.prototype.updateObject=function(){var t=this._computed;if(void 0!==t){var e=this._formatter(t,this._parent);if(null==(o=this._object)){if(0<e.length){var n=this.newObject();n.visible=this._isVisible,this._object=n;var i=this._parent;i.addChild(n);var r=i.getOverflowMask();return r&&(n.mask=r),n.text=e,!0}}else if(o.text!==e)return o.text=e,!0}else{var o;if(null!=(o=this._object)&&""!==o.text)return o.text="",!0}return!1},e.prototype.newComputed=function(){var t=this._value;if(void 0!==t){if(!Ct(t))return t;var e=t(this._parent.state);if(void 0!==e)return e}return this._theme.getTextValue(this._parent.state)},e.prototype.newColor=function(t){var e=this._color;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getColor(t)},e.prototype.newAlpha=function(t){var e=this._alpha;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getAlpha(t)},e.prototype.newObject=function(){return new wa(this._dstyle)},Object.defineProperty(e.prototype,"visible",{get:function(){var t=this._object;return null!=t?t.visible:this._isVisible},set:function(t){var e=this._object;null!=e&&(e.visible=t),this._isVisible=t},enumerable:!1,configurable:!0}),e.prototype.show=function(){return this.visible=!0,this},e.prototype.hide=function(){return this.visible=!1,this},e.prototype.isShown=function(){return this.visible},e.prototype.onComputedChange=function(){this.emit("change",this)},e.prototype.destroy=function(){var t=this._object;return t&&(this._object=void 0,t.destroy()),this},e}(t.utils.EventEmitter),xa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.getText()},e.prototype.getOverflowMask=function(){var t=this._overflowMask;return void 0===t&&(t=this.newOverflowMask(),this._overflowMask=t),null},e.prototype.newOverflowMask=function(){var t,e;if(null!==(e=null===(t=this._options)||void 0===t?void 0:t.mask)&&void 0!==e?e:this.theme.isOverflowMaskEnabled()){var n=new ya(this);return this._reflowable.add(n),this.toDirty(),n}return null},Object.defineProperty(e.prototype,"text",{get:function(){var t;return null!==(t=this._text)&&void 0!==t?t:this._text=this.newText()},set:function(t){this.text.value=t},enumerable:!1,configurable:!0}),e.prototype.getText=function(){var t;return null!==(t=this._text)&&void 0!==t?t:this._text=this.newText()},e.prototype.newText=function(){var t;return new Sa(this,this.theme,null===(t=this._options)||void 0===t?void 0:t.text)},e.prototype.onReflow=function(){t.prototype.onReflow.call(this),this.onReflowTextAndImage()},e.prototype.getLayouter=function(){var t;return null!==(t=e.LAYOUTER)&&void 0!==t?t:e.LAYOUTER=new da},e.prototype.onReflowTextAndImage=function(){var t=this.getLayouter(),e=this.getText();e.update(t);var n=this._auto;t.execute(this._padding,e.align,n.width.isOn?null:this.width,n.height.isOn?null:this.height),t.clear()},e.prototype.isRefitable=function(e){if(t.prototype.isRefitable.call(this,e))return!0;if(null!=e){var n=this._text;if(null!=n&&e===n.object)return!0}return!1},e.prototype.applyTitle=function(){var e=this.text.object;if(this._title.length<=0&&null!=e&&e.clipped){var n=ft.getLayer(this);n&&(n.view.title=e.text)}else t.prototype.applyTitle.call(this)},e.prototype.getType=function(){return"DTextBase"},e.prototype.destroy=function(){var e=this._text;e&&e.destroy();var n=this._overflowMask;n&&(this._overflowMask=null,n.destroy()),t.prototype.destroy.call(this)},e}(ao),Da=function(){function t(t){this._theme=t}return t.prototype.getImageAlignHorizontal=function(){return this._theme.getImageAlignHorizontal()},t.prototype.getImageAlignVertical=function(){return this._theme.getImageAlignVertical()},t.prototype.getImageAlignWith=function(){return this._theme.getImageAlignWith()},t.prototype.getImageMarginHorizontal=function(){return this._theme.getImageMarginHorizontal()},t.prototype.getImageMarginVertial=function(){return this._theme.getImageMarginVertial()},t.prototype.getImageTintColor=function(t){return this._theme.getImageTintColor(t)},t.prototype.getImageTintAlpha=function(t){return this._theme.getImageTintAlpha(t)},t.prototype.getImageRotation=function(t){return this._theme.getImageRotation(t)},t.prototype.getImageSource=function(t){return null},t}(),Ia=function(){function t(t){this._theme=t}return t.prototype.getImageAlignHorizontal=function(){return this._theme.getSecondaryImageAlignHorizontal()},t.prototype.getImageAlignVertical=function(){return this._theme.getSecondaryImageAlignVertical()},t.prototype.getImageAlignWith=function(){return this._theme.getSecondaryImageAlignWith()},t.prototype.getImageMarginHorizontal=function(){return this._theme.getSecondaryImageMarginHorizontal()},t.prototype.getImageMarginVertial=function(){return this._theme.getSecondaryImageMarginVertial()},t.prototype.getImageTintColor=function(t){return this._theme.getSecondaryImageTintColor(t)},t.prototype.getImageTintAlpha=function(t){return this._theme.getSecondaryImageTintAlpha(t)},t.prototype.getImageRotation=function(t){return this._theme.getSecondaryImageRotation(t)},t.prototype.getImageSource=function(t){var e,n,i;return null!==(i=null===(n=(e=this._theme).getSecondaryImageSource)||void 0===n?void 0:n.call(e,t))&&void 0!==i?i:null},t}(),Aa=function(){function t(t){this._theme=t}return t.prototype.getImageAlignHorizontal=function(){return this._theme.getTertiaryImageAlignHorizontal()},t.prototype.getImageAlignVertical=function(){return this._theme.getTertiaryImageAlignVertical()},t.prototype.getImageAlignWith=function(){return this._theme.getTertiaryImageAlignWith()},t.prototype.getImageMarginHorizontal=function(){return this._theme.getTertiaryImageMarginHorizontal()},t.prototype.getImageMarginVertial=function(){return this._theme.getTertiaryImageMarginVertial()},t.prototype.getImageTintColor=function(t){return this._theme.getTertiaryImageTintColor(t)},t.prototype.getImageTintAlpha=function(t){return this._theme.getTertiaryImageTintAlpha(t)},t.prototype.getImageRotation=function(t){return this._theme.getTertiaryImageRotation(t)},t.prototype.getImageSource=function(t){var e,n,i;return null!==(i=null===(n=(e=this._theme).getTertiaryImageSource)||void 0===n?void 0:n.call(e,t))&&void 0!==i?i:null},t}(),Ra=function(){function t(t,e,n){this._parent=t,null!=n&&(this._color=n.color,this._alpha=n.alpha),this._theme=e}return Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getColor=function(t){var e=this._color;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getImageTintColor(t)},Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.getAlpha=function(t){var e=this._alpha;if(void 0!==e){if(!Ct(e))return e;var n=e(t);if(void 0!==n)return n}return this._theme.getImageTintAlpha(t)},t.prototype.set=function(t,e){var n=!1;return null!=t&&this._color!==t&&(this._color=t,n=!0),null!=e&&this._alpha!==e&&(this._alpha=e,n=!0),n&&this.onChange(),this},t.prototype.onChange=function(){this._parent.updateTint(),ft.update(this._parent)},t}(),Pa=function(){function t(t,e,n){var i,r;this._parent=t,this._vertical=null!==(i=null==n?void 0:n.vertical)&&void 0!==i?i:e.getImageMarginVertial(),this._horizontal=null!==(r=null==n?void 0:n.horizontal)&&void 0!==r?r:e.getImageMarginHorizontal()}return Object.defineProperty(t.prototype,"vertical",{get:function(){return this._vertical},set:function(t){this._vertical!==t&&(this._vertical=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontal",{get:function(){return this._horizontal},set:function(t){this._horizontal!==t&&(this._horizontal=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;return null!=t&&this._vertical!==t&&(this._vertical=t,n=!0),null!=e&&this._horizontal!==e&&(this._horizontal=e,n=!0),n&&this.onChange(),this},t.prototype.onChange=function(){this._parent.onUpdate()},t}(),Ma=function(){function t(t,e,n){var i,r,o;this._parent=t,this._with=ai(null!==(i=null==n?void 0:n.with)&&void 0!==i?i:e.getImageAlignWith(),ia),this._vertical=ai(null!==(r=null==n?void 0:n.vertical)&&void 0!==r?r:e.getImageAlignVertical(),oa),this._horizontal=ai(null!==(o=null==n?void 0:n.horizontal)&&void 0!==o?o:e.getImageAlignHorizontal(),ra)}return Object.defineProperty(t.prototype,"with",{get:function(){return this._with},set:function(t){t=ai(t,ia),this._with!==t&&(this._with=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertical",{get:function(){return this._vertical},set:function(t){t=ai(t,oa),this._vertical!==t&&(this._vertical=t,this.onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"horizontal",{get:function(){return this._horizontal},set:function(t){t=ai(t,ra),this._horizontal!==t&&(this._horizontal=t,this.onChange())},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n){var i=!1;return null!=t&&(t=ai(t,ia),this._with!==t&&(this._with=t,i=!0)),null!=e&&(e=ai(e,oa),this._vertical!==e&&(this._vertical=e,i=!0)),null!=n&&(n=ai(n,ra),this._horizontal!==n&&(this._horizontal=n,i=!0)),i&&this.onChange(),this},t.prototype.onChange=function(){this._parent.onUpdate()},t}(),ka=function(){function e(t,e,n){var i=this;this._parent=t,this._theme=e,this._object=null,this._align=new Ma(this,e,null==n?void 0:n.align),this._margin=new Pa(this,e,null==n?void 0:n.margin),this._tint=new Ra(this,e,null==n?void 0:n.tint),this._rotation=null==n?void 0:n.rotation,this._source=null==n?void 0:n.source,this._computed=null,this._onUpdateBound=function(){i.onUpdate()}}return Object.defineProperty(e.prototype,"object",{get:function(){return this._object},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"align",{get:function(){return this._align},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"margin",{get:function(){return this._margin},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"tint",{get:function(){return this._tint},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"source",{get:function(){return this._source},set:function(t){this._source!==t&&(this._source=t,this.updateSource()&&this.onUpdate())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rotation",{get:function(){return this._rotation},set:function(t){this._rotation!==t&&(this._rotation=t,this.updateRotation()&&ft.update(this._parent))},enumerable:!1,configurable:!0}),e.prototype.computeSource=function(){var t=this._source;if(void 0!==t){if(!Ct(t))return t;var e=t(this._parent.state);if(void 0!==e)return e}return this._theme.getImageSource(this._parent.state)},e.prototype.onStateChange=function(t,e){this.updateTint(),this.updateRotation()},e.prototype.isTintAware=function(t){return null!=t&&"tint"in t},e.prototype.updateTint=function(){var t=this._object;if(t&&this.isTintAware(t)){var e=this._parent.state,n=this._tint.getColor(e);if(null!=n){var i=!1;t.tint!==n&&(t.tint=n,i=!0);var r=this._tint.getAlpha(e);return t.alpha!==r&&(t.alpha=r,i=!0),t.visible||(t.visible=!0,i=!0),i}if(t.visible)return t.visible=!1,!0}return!1},e.prototype.toRotation=function(t,e){var n=this._rotation;if(null!=n){if(!Ct(n))return n;var i=n(e);if(void 0!==i)return i}return t.getImageRotation(e)},e.prototype.updateRotation=function(){var t=this._object;if(t){var e=this._theme,n=this._parent.state,i=this.toRotation(e,n);if(null!=i){var r=t.transform;if(r.rotation!==i)return r.rotation=i,!0}}return!1},e.prototype.updateSource=function(){var e=this.computeSource(),n=this._computed;if(e!==n){this._computed=e;var i,r=this._parent,o=this._object,s=this._onUpdateBound;if(e instanceof t.Texture)if(n instanceof t.Texture)n.off("update",s),o instanceof t.Sprite&&(o.texture=e,e.on("update",s));else{null!=o&&r.removeChild(o);var a=new t.Sprite(e);a.anchor.set(.5,.5),(i=r.getOverflowMask())&&(a.mask=i),e.on("update",s),r.addChild(a),this._object=a}else n instanceof t.Texture?(n.off("update",s),null!=o&&(r.removeChild(o),o.destroy())):null!=o&&r.removeChild(o),null!=e&&((i=r.getOverflowMask())&&(e.mask=i),r.addChild(e)),this._object=e;return!0}return!1},e.prototype.isRefitable=function(t){return null!=t&&t===this._object},e.prototype.destroy=function(){this.source=null},e.prototype.onUpdate=function(){this._parent.toDirty(),ft.update(this._parent)},e}(),La=function(){function t(t,e,n){this._parent=t,this._theme=e;var i=[];if(this._pieces=i,null!=n){var r=n.images;if(null!=r){if(i.push(this.newImage(e,0<r.length?r[0]:void 0)),(null!=e.getSecondaryImageSource||1<r.length)&&i.push(this.newImage(new Ia(e),r[1])),(null!=e.getTertiaryImageSource||2<r.length)&&i.push(this.newImage(new Aa(e),r[2])),3<r.length)for(var o=new Da(e),s=3,a=r.length;s<a;++s)i.push(this.newImage(o,r[s]))}else i.push(this.newImage(e,n.image)),null!=e.getSecondaryImageSource&&i.push(this.newImage(new Ia(e))),null!=e.getTertiaryImageSource&&i.push(this.newImage(new Aa(e)))}else i.push(this.newImage(e)),null!=e.getSecondaryImageSource&&i.push(this.newImage(new Ia(e))),null!=e.getTertiaryImageSource&&i.push(this.newImage(new Aa(e)))}return t.prototype.newImage=function(t,e){return new ka(this._parent,t,e)},t.prototype.onStateChange=function(t,e){for(var n=this._pieces,i=0,r=n.length;i<r;++i)n[i].onStateChange(t,e)},t.prototype.isRefitable=function(t){for(var e=this._pieces,n=0,i=e.length;n<i;++n)if(e[n].isRefitable(t))return!0;return!1},t.prototype.update=function(t){for(var e=this._pieces,n=0,i=e.length;n<i;++n){var r=e[n];r.updateSource(),r.updateTint(),r.updateRotation(),t.add(r)}},Object.defineProperty(t.prototype,"object",{get:function(){return this._pieces[0].object},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){return this._pieces[0].align},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"margin",{get:function(){return this._pieces[0].margin},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"tint",{get:function(){return this._pieces[0].tint},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"source",{get:function(){return this._pieces[0].source},set:function(t){this._pieces[0].source=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"rotation",{get:function(){return this._pieces[0].rotation},set:function(t){this._pieces[0].rotation=t},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var e=this.newImage(this._theme,t);return this._pieces.push(e),e},t.prototype.get=function(t){var e=this._pieces;return 0<=t&&t<e.length?e[t]:null},t.prototype.remove=function(t){var e=this._pieces;return 0<=t&&t<e.length&&(e[t].destroy(),!0)},t.prototype.size=function(){return this._pieces.length},t.prototype.destroy=function(){for(var t=this._pieces,e=0,n=t.length;e<n;++e)t[e].destroy()},t}(),Na=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){this.getImage(),t.prototype.init.call(this,e)},Object.defineProperty(e.prototype,"image",{get:function(){var t;return null!==(t=this._image)&&void 0!==t?t:this._image=this.newImage()},set:function(t){var e=this.image.get(0);null!=e&&(e.source=t)},enumerable:!1,configurable:!0}),e.prototype.getImage=function(){var t;return null!==(t=this._image)&&void 0!==t?t:this._image=this.newImage()},e.prototype.newImage=function(){return new La(this,this.theme,this.options)},e.prototype.onStateChange=function(e,n){t.prototype.onStateChange.call(this,e,n),this.getImage().onStateChange(e,n)},e.prototype.onReflowTextAndImage=function(){var t=this.getLayouter();this.getImage().update(t);var e=this.getText();e.update(t);var n=this._auto;t.execute(this._padding,e.align,n.width.isOn?null:this.width,n.height.isOn?null:this.height),t.clear()},e.prototype.isRefitable=function(e){return!!t.prototype.isRefitable.call(this,e)||!!this.getImage().isRefitable(e)},e.prototype.getType=function(){return"DImageBase"},e.prototype.destroy=function(){var e=this._image;null!=e&&e.destroy(),t.prototype.destroy.call(this)},e}(xa),Ba=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){var n,i,r=this;t.prototype.init.call(this,e);var o=this.theme;this._isToggle=null!==(n=null==e?void 0:e.toggle)&&void 0!==n?n:o.isToggle(),this._when=ai(null!==(i=null==e?void 0:e.when)&&void 0!==i?i:o.getWhen(),na),this.on(cr.tap,(function(t){r.onClick(t)})),this.initOnPress();var s=null==e?void 0:e.group;s&&s.add(this)},e.prototype.onShortcut=function(e){this.state.isActionable&&this.activate(e),t.prototype.onShortcut.call(this,e)},Object.defineProperty(e.prototype,"isToggle",{get:function(){return!!this._isToggle},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isGrouped",{get:function(){return!!this._isGrouped},set:function(t){this._isGrouped=t},enumerable:!1,configurable:!0}),e.prototype.initOnPress=function(){var t=this,e=null,n=function(){t.state.isPressed=!1,null!=e&&(e.off(cr.up,n),e.off(cr.upoutside,n),e.off(cr.cancel,n),e=null)};this.on(cr.down,(function(){if(t.state.isActionable){t.state.isPressed=!0;var i=ft.getLayer(t);i&&null!=(e=i.renderer.plugins.interaction)&&(e.on(cr.up,n),e.on(cr.upoutside,n),e.on(cr.cancel,n))}}))},e.prototype.getType=function(){return"DButton"},e.prototype.onClick=function(t){this._when===na.CLICKED&&this.state.isActionable&&this.activate(t)},e.prototype.onDblClick=function(e,n){return this._when===na.DOUBLE_CLICKED&&this.state.isActionable&&this.activate(e),t.prototype.onDblClick.call(this,e,n)},e.prototype.activate=function(t){this._isToggle?this._isGrouped&&this.state.isActive||(this.onToggleStart(t),this.onToggleEnd(t)):this.onActivate(t)},e.prototype.onActivate=function(t){this.emit("active",this)},e.prototype.onInactivate=function(t){this.emit("inactive",this)},e.prototype.toggle=function(){this.state.isActionable&&this._isToggle&&(this.onToggleStart(),this.onToggleEnd())},e.prototype.onToggleStart=function(t){this.state.isActive=!this.state.isActive},e.prototype.onToggleEnd=function(t){this.state.isActive?this.onActivate(t):this.onInactivate(t)},e.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this._isToggle?this.onToggleStart(t):this.state.isPressed=!0)},e.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this._isToggle?this.onToggleEnd(t):(this.state.isPressed&&this.onActivate(t),this.state.isPressed=!1))},e.prototype.onKeyDown=function(e){return no.isActivateKey(e)&&this.onActivateKeyDown(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyUp=function(e){return no.isActivateKey(e)&&this.onActivateKeyUp(e),t.prototype.onKeyUp.call(this,e)},e.prototype.onStateChange=function(e,n){t.prototype.onStateChange.call(this,e,n),e.isPressed?n.isPressed||this.onPress():n.isPressed&&this.onUnpress()},e.prototype.onPress=function(){this.emit("press",this)},e.prototype.onUnpress=function(){this.emit("unpress",this)},e.prototype.destroy=function(){var e,n;null===(n=null===(e=this._options)||void 0===e?void 0:e.group)||void 0===n||n.remove(this),t.prototype.destroy.call(this)},e}(Na),za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButton"},e}(Ba),Ua=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonPrimary"},e}(za),ja=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DLayoutHorizontal"},e}($s),Fa=function(t){function e(e,n){var i=t.call(this,n)||this;return i._parent=e,i}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e);var n=this.newChildren();if(0<n.length)for(var i=0,r=n.length;i<r;++i){var o=n[i];null!=o&&this.addChild(o)}},e.prototype.newChildren=function(){return[this.buttonSpaceLeft,this.buttonCancel,this.buttonOk,this.buttonSpaceRight]},Object.defineProperty(e.prototype,"buttonSpaceLeft",{get:function(){var t=this._buttonSpaceLeft;return void 0===t&&(t=this.newButtonSpaceLeft(),this._buttonSpaceLeft=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonSpaceLeft=function(){var t,e,n,i;return(null!==(i=null===(n=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.space)||void 0===n?void 0:n.left)&&void 0!==i?i:this.theme.isButtonSpaceLeftEnabled())?new Js({weight:1}):null},Object.defineProperty(e.prototype,"buttonSpaceRight",{get:function(){var t=this._buttonSpaceRight;return void 0===t&&(t=this.newButtonSpaceRight(),this._buttonSpaceRight=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonSpaceRight=function(){var t,e,n,i;return(null!==(i=null===(n=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.space)||void 0===n?void 0:n.right)&&void 0!==i?i:this.theme.isButtonSpaceRightEnabled())?new Js({weight:1}):null},Object.defineProperty(e.prototype,"buttonCancel",{get:function(){var t=this._buttonCancel;return void 0===t&&(t=this.newButtonCancel(),this._buttonCancel=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonCancel=function(){var t,e,n=this,i=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.cancel;return void 0===i&&(i=this.theme.getButtonCancel()),null!=i?new Ua({text:{value:i},on:{active:function(){n._parent.cancel()}}}):null},Object.defineProperty(e.prototype,"buttonOk",{get:function(){var t=this._buttonOk;return void 0===t&&(t=this.newButtonOk(),this._buttonOk=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonOk=function(){var t,e,n=this,i=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.ok;return void 0===i&&(i=this.theme.getButtonOk()),null!=i?null!=this.buttonCancel?new za({text:{value:i},on:{active:function(){n._parent.ok()}}}):new Ua({text:{value:i},on:{active:function(){n._parent.ok()}}}):null},e.prototype.getType=function(){return"DDialogLayeredFooter"},e}(ja),Ha=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonAmbient"},e}(za),Ga=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogLayeredHeaderButtonClose"},e}(Ha),Va=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogLayeredHeaderSeparator"},e}(Na),Wa=function(t){function e(e,n){var i=t.call(this,n)||this;i._parent=e;var r=i.separator;r&&i.addChild(r);var o=i.buttonClose;return o&&(i.addChild(o),o.on("active",(function(){i._parent.cancel()}))),i}return F(e,t),Object.defineProperty(e.prototype,"buttonClose",{get:function(){var t=this._buttonClose;return void 0===t&&(t=this.newButtonClose(),this._buttonClose=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonClose=function(){var t,e;return!1!==(null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.close)?new Ga:null},Object.defineProperty(e.prototype,"separator",{get:function(){var t=this._separator;return void 0===t&&(t=this.newSeparator(),this._separator=t),t},enumerable:!1,configurable:!0}),e.prototype.newSeparator=function(){var t;return!1!==(null===(t=this._options)||void 0===t?void 0:t.separator)?new Va:null},e.prototype.getType=function(){return"DDialogLayeredHeader"},e}(Na),Ka=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.addChild(this.layout)},Object.defineProperty(e.prototype,"layout",{get:function(){var t=this._layout;return null==t&&(t=this.newLayout(),this._layout=t),t},enumerable:!1,configurable:!0}),e.prototype.newLayout=function(){return new ta(this.toLayoutOptions(this.theme,this._options))},e.prototype.toLayoutOptions=function(t,e){var n,i,r=null!==(i=null!==(n=null==e?void 0:e.layout)&&void 0!==n?n:t.getLayout())&&void 0!==i?i:this.newLayoutOptions(t,e);return void 0===r.children&&(r.children=this.newLayoutChildren(t,e)),r},e.prototype.newLayoutOptions=function(t,e){return{width:"padding",height:"auto",margin:0}},e.prototype.newLayoutChildren=function(t,e){return[this.header,this.content,this.footer]},Object.defineProperty(e.prototype,"header",{get:function(){var t=this._header;return void 0===t&&(t=this.newHeader(),this._header=t),t},enumerable:!1,configurable:!0}),e.prototype.newHeader=function(){var t=this.toHeaderOptions(this.theme,this._options);return null!==t?new Wa(this,t):null},e.prototype.toHeaderOptions=function(t,e){if(e){var n=e.header;if(void 0!==n)return n}return t.getHeader()},Object.defineProperty(e.prototype,"content",{get:function(){var t=this._content;return null==t&&(t=this.newContent(),this._content=t),t},enumerable:!1,configurable:!0}),e.prototype.newContent=function(){return new ea(this.toContentOptions(this.theme,this._options))},e.prototype.toContentOptions=function(t,e){var n,i,r=null!==(i=null!==(n=null==e?void 0:e.content)&&void 0!==n?n:t.getContent())&&void 0!==i?i:{};return void 0===r.children&&(r.children=this.newContentChildren(t,e)),r},e.prototype.newContentChildren=function(t,e){return[]},Object.defineProperty(e.prototype,"footer",{get:function(){var t=this._footer;return void 0===t&&(t=this.newFooter(),this._footer=t),t},enumerable:!1,configurable:!0}),e.prototype.newFooter=function(){var t=this.toFooterOptions(this.theme,this._options);return null!==t?new Fa(this,t):null},e.prototype.toFooterOptions=function(t,e){if(e){var n=e.footer;if(void 0!==n)return n}return t.getFooter()},e.prototype.findFirstFocusable=function(t){return t.find(this.content,!1,!0,!0)},e.prototype.ok=function(){this.onOk(this.getResolvedValue())},e.prototype.onOk=function(t){this.doResolve(t),this.emit("ok",t,this)},e.prototype.cancel=function(){this.onCancel(this.getRejectReason())},e.prototype.onCancel=function(t){this.doReject(t),this.emit("cancel",t,this)},e.prototype.getRejectReason=function(){},e.prototype.getType=function(){return"DDialogLayered"},e}(qs),Xa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.inputLayout),i},e.prototype.toInputMargin=function(t,e){var n,i;return null!==(i=null===(n=null==e?void 0:e.input)||void 0===n?void 0:n.margin)&&void 0!==i?i:t.getInputMargin()},Object.defineProperty(e.prototype,"inputLayout",{get:function(){var t=this._inputLayout;return null==t&&(t=this.newInputLayout(),this._inputLayout=t),t},enumerable:!1,configurable:!0}),e.prototype.newInputLayout=function(){var t=this.toInputMargin(this.theme,this._options);return new ja({width:"padding",height:"auto",margin:0,children:[new Js({width:t}),this.input,new Js({width:t})]})},Object.defineProperty(e.prototype,"input",{get:function(){var t=this._input;if(null==t){var e=this._options;t=this.newInput(null==e?void 0:e.input),this._input=t}return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.input.value},set:function(t){this.input.value=t},enumerable:!1,configurable:!0}),e.prototype.getResolvedValue=function(){return this.input.value},e.prototype.getType=function(){return"DDialogInput"},e}(Ka),Ya=function(t){function e(e){var n=t.call(this)||this;n._buttons=[],n._active=null,n._onActiveBound=function(t){n.active=t};var i=null==e?void 0:e.on;if(null!=i)for(var r in i){var o=i[r];o&&n.on(r,o)}return n.emit("init",n),n}return F(e,t),e.prototype.add=function(t){if(this._buttons.indexOf(t)<0){this._buttons.push(t),t.isGrouped=!0;var e=this._isEnabled;null!=e&&(t.state.isEnabled=e),t.on("active",this._onActiveBound),t.state.isActive&&(this.active=t)}},Object.defineProperty(e.prototype,"active",{get:function(){return this._active},set:function(t){if((null==t||t.isToggle)&&this._active!==t){var e=this._active;this._active=t;for(var n=this._buttons,i=0,r=n.length;i<r;++i){var o=n[i];o!==t&&o.isToggle&&o.state.isActive&&o.toggle()}this.emit("active",t,e,this)}},enumerable:!1,configurable:!0}),e.prototype.remove=function(t){var e=this._buttons,n=e.indexOf(t);0<=n&&(e.splice(n,1),t.isGrouped=!1,t.off("active",this._onActiveBound),this._active===t&&(this.active=null))},e.prototype.contains=function(t){return 0<=this._buttons.indexOf(t)},e.prototype.clear=function(){for(var t=this._buttons,e=0,n=t.length;e<n;++e)t[e].isGrouped=!1;t.length=0,this.active=null},e.prototype.size=function(){return this._buttons.length},e.prototype.each=function(t){for(var e=this._buttons,n=0,i=e.length;n<i&&!1!==t(e[n]);++n);},e.prototype.disable=function(){for(var t=this._buttons,e=0,n=t.length;e<n;++e)t[e].state.isDisabled=!0;this._isEnabled=!1},e.prototype.enable=function(){for(var t=this._buttons,e=0,n=t.length;e<n;++e)t[e].state.isDisabled=!1;this._isEnabled=!0},e.prototype.destroy=function(){this.clear()},e}(t.utils.EventEmitter),qa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DInputBooleanButtonOff"},e}(za),Za=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DInputBooleanButtonOn"},e}(za),Ja=function(t){function e(e){var n=t.call(this,e)||this;n._lockCount=0,n.addChild(n.getButtonOff()),n.addChild(n.getButtonOn());var i=null==e?void 0:e.value;return null!=i&&(n.value=i),n.getButtonGroup().on("active",(function(){if(n._lockCount<=0){var t=n.value;n.emit("change",t,!t,n)}})),n}return F(e,t),e.prototype.getButtonGroup=function(){var t=this._buttonGroup;return null==t&&(t=this.newButtonGroup(),this._buttonGroup=t),t},e.prototype.newButtonGroup=function(){return new Ya},e.prototype.getButtonOn=function(){var t=this._buttonOn;return null==t&&(t=this.newButtonOn(),this._buttonOn=t),t},e.prototype.newButtonOn=function(){return new Za({weight:1,group:this.getButtonGroup()})},e.prototype.getButtonOff=function(){var t=this._buttonOff;return null==t&&(t=this.newButtonOff(),this._buttonOff=t),t},e.prototype.newButtonOff=function(){return new qa({weight:1,group:this.getButtonGroup(),state:vt.ACTIVE})},Object.defineProperty(e.prototype,"value",{get:function(){return this.getButtonOn().state.isActive},set:function(t){if(this.value!==t){this._lockCount+=1;try{t?this.getButtonOn().activate():this.getButtonOff().activate()}catch(t){}this._lockCount-=1}},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DInputBoolean"},e}(ja),Qa=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newInput=function(t){return new Ja(this.toInputOptions(t))},e.prototype.toInputOptions=function(t){return t?(void 0===t.weight&&(t.weight=1),t):{weight:1}},e.prototype.getType=function(){return"DDialogInputBoolean"},e}(Xa),$a=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;return n.target=Te.ofStringOrNull(e.target),n.onInputAction=e.onInputAction,n.isOpened=!1,n.step=Te.ofNumberOrNull(e.step),n.min=Te.ofNumberOrNull(e.min),n.max=Te.ofNumberOrNull(e.max),n}return F(e,t),e.prototype.execute=function(t,e,n){var i=this;if(!this.isOpened&&this.condition(t,n,be)){var r=this.target(t,n,be);if(null!=r){var o=this.initial(t,n,be),s=this.step(t,n,be),a=this.min(t,n,be),u=this.max(t,n,be);this.isOpened=!0,setTimeout((function(){i.open(t,r,o,s,a,u).then((function(e){i.isOpened=!1,ms.execute(t,i.onInputAction,r,e,n)}),(function(){i.isOpened=!1}))}),0)}}},e}(Ee),tu=function(t){function e(e){var n=t.call(this,e)||this;return n.initial=Te.ofBooleanOrFalse(e.initial),n}return F(e,t),e.prototype.open=function(t,n,i,r,o,s){var a=e.DIALOG;if(null==a)a=new Qa({header:{text:{value:n},button:{close:!1}}}),e.DIALOG=a;else{var u=a.header;u&&(u.text=n)}return a.value=i,a.open(t)},e}($a),eu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getUtil=function(){var t=this._util;return null==t&&(t=this.newUtil(),this._util=t),t},e.prototype.newUtil=function(){return new hs(this,this.newOperation(),this.theme,this._options)},e.prototype.newOperation=function(){var t=this;return{getElementRect:function(e,n,i){return t.getElementRect(e,n,i)},getElementMatrix:function(){return null},getClipperRect:function(e,n,i){return t.getClipperRect(e,n,i)},getPadding:function(){return t.padding},containsPoint:function(e){return t.containsPoint(e)},onStart:function(){},onCancel:function(){},onEnd:function(){}}},Object.defineProperty(e.prototype,"element",{get:function(){return this.getUtil().element},enumerable:!1,configurable:!0}),e.prototype.onDownThis=function(e){var n=this.getUtil();n.onDowning(e),t.prototype.onDownThis.call(this,e),n.onDown(e)},e.prototype.onDblClick=function(e,n){return this.getUtil().onDblClick(e,n),t.prototype.onDblClick.call(this,e,n)},e.prototype.onFocus=function(){t.prototype.onFocus.call(this),this.getUtil().onFocus()},e.prototype.onBlur=function(){t.prototype.onBlur.call(this),this.getUtil().onBlur()},e.prototype.start=function(){this.getUtil().start()},e.prototype.render=function(e){this.getUtil().onRender(e),t.prototype.render.call(this,e)},e.prototype.getElementRect=function(t,e,n){return e.set(0,0),this.toGlobal(e,e,!1),n.x=e.x,n.y=e.y,e.set(this.width,this.height),this.toGlobal(e,e,!0),n.width=e.x-n.x,n.height=e.y-n.y,n},e.prototype.getClipperRect=function(t,e,n){return hs.getClipperRect(this.parent,this,t,e,n)},e.prototype.cancel=function(){this.getUtil().cancel()},e.prototype.end=function(){this.getUtil().end()},e.prototype.select=function(){return this.getUtil().select(),this},e.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this.state.isPressed=!0)},e.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this.state.isPressed&&this.start(),this.state.isPressed=!1)},e.prototype.onKeyDown=function(e){return no.isActivateKey(e)&&this.onActivateKeyDown(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyUp=function(e){return no.isActivateKey(e)&&this.onActivateKeyUp(e),t.prototype.onKeyUp.call(this,e)},e.prototype.getType=function(){return"DHtmlElement"},e}(Na),nu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newOperation=function(){var t=this;return{getElementRect:function(e,n,i){return t.getElementRect(e,n,i)},getElementMatrix:function(){return null},getClipperRect:function(e,n,i){return t.getClipperRect(e,n,i)},getPadding:function(){return t.padding},containsPoint:function(e){return t.containsPoint(e)},onStart:function(){t.text.hide()},onCancel:function(){t.text.show()},onEnd:function(){},getValue:function(){return t.text.computed},onValueInput:function(e){t.onValueInput(e)},onValueChange:function(e,n){t.text=e,t.onValueChange(e,n)},onEnter:function(){t.onEnter()},applyTitle:function(){t.applyTitle()}}},Object.defineProperty(e.prototype,"value",{get:function(){return this.text.computed},set:function(t){this.text=t},enumerable:!1,configurable:!0}),e.prototype.newText=function(){var e=this,n=t.prototype.newText.call(this);return n.on("change",(function(){e.validate()})),n},e.prototype.onValueChange=function(t,e){this.emit("change",t,e,this)},e.prototype.onValueInput=function(t){this.emit("input",t,this)},e.prototype.onEnter=function(){this.emit("enter",this)},e.prototype.validate=function(){return this.getUtil().validate()},e.prototype.applyTitle=function(){this.getUtil().applyTitle()||t.prototype.applyTitle.call(this)},e.prototype.getType=function(){return"DInput"},e}(eu),iu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DInputInput"},e}(nu),ru=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newUtil=function(){return new vs(this,this.newOperation(),this.theme,this._options)},Object.defineProperty(e.prototype,"step",{get:function(){return this.getUtil().step},set:function(t){this.getUtil().step=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this.getUtil().min},set:function(t){this.getUtil().min=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this.getUtil().max},set:function(t){this.getUtil().max=t},enumerable:!1,configurable:!0}),e}(iu),ou=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DInputInteger"},e}(ru),su=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newInput=function(t){var e=this,n=new ou(this.toInputOptions(t));return n.on("enter",(function(){e.ok()})),n},e.prototype.toInputOptions=function(t){return t?(void 0===t.weight&&(t.weight=1),t):{weight:1}},e.prototype.getType=function(){return"DDialogInputInteger"},e}(Xa),au=function(t){function e(e){var n=t.call(this,e)||this;return n.initial=Te.ofNumber(e.initial),n}return F(e,t),e.prototype.open=function(t,n,i,r,o,s){var a=e.DIALOG;if(null==a)a=new su({header:{text:{value:n},button:{close:!1}},input:{step:r,min:o,max:s,text:{value:i}}}),e.DIALOG=a;else{var u=a.header;u&&(u.text=n);var l=a.input;l.step=r,l.min=o,l.max=s,a.value=i}return a.open(t)},e}($a),uu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DInputReal"},e}(ru),lu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newInput=function(t){var e=this,n=new uu(this.toInputOptions(t));return n.on("enter",(function(){e.ok()})),n},e.prototype.toInputOptions=function(t){return t?(void 0===t.weight&&(t.weight=1),t):{weight:1}},e.prototype.getType=function(){return"DDialogInputReal"},e}(Xa),hu=function(t){function e(e){var n=t.call(this,e)||this;return n.initial=Te.ofNumber(e.initial),n}return F(e,t),e.prototype.open=function(t,n,i,r,o,s){var a=e.DIALOG;if(null==a)a=new lu({header:{text:{value:n},button:{close:!1}},input:{step:r,min:o,max:s,text:{value:i}}}),e.DIALOG=a;else{var u=a.header;u&&(u.text=n);var l=a.input;l.step=r,l.min=o,l.max=s,a.value=i}return a.open(t)},e}($a),cu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newUtil=function(){return new Cs(this,this.newOperation(),this.theme,this._options)},e.prototype.getType=function(){return"DInputText"},e}(iu),pu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newInput=function(t){var e=this,n=new cu(this.toInputOptions(t));return n.on("enter",(function(){e.ok()})),n},e.prototype.toInputOptions=function(t){return t?(void 0===t.weight&&(t.weight=1),t):{weight:1}},e.prototype.getType=function(){return"DDialogInputText"},e}(Xa),fu=function(t){function e(e){var n=t.call(this,e)||this;return n.initial=Te.ofString(e.initial),n}return F(e,t),e.prototype.open=function(t,n,i,r,o,s){var a=e.DIALOG;if(null==a)a=new pu({header:{text:{value:n},button:{close:!1}}}),e.DIALOG=a;else{var u=a.header;u&&(u.text=n)}return a.value=i,a.open(t)},e}($a),du=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogFittedContent"},e}(ea),yu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newLayoutOptions=function(t,e){return{width:"auto",height:"auto",margin:0}},e.prototype.newContent=function(){return new du(this.toContentOptions(this.theme,this._options))},e.prototype.getType=function(){return"DDialogFitted"},e}(Ka),gu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPickerDatetimeButtonBack"},e}(Ha),vu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPickerDatetimeButtonDate"},e}(Ha),_u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPickerDatetimeButtonNext"},e}(Ha),mu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DText"},e}(xa),bu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPickerDatetimeLabel"},e}(mu),Tu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPickerDatetimeLabelDate"},e}(mu),wu=function(t){function e(e){var n=t.call(this,e)||this;return n.renderable=!1,n}return F(e,t),e.prototype.getType=function(){return"DPickerDatetimeSpace"},e}(ao),Eu={NONE:0,DATE:1,HOURS:2,MINUTES:4,SECONDS:8,TIME:14,ALL:15},Ou=function(){function t(){}return t.from=function(t,e){var n=null==e?void 0:e.mask;if(null==n){if(xt(t)){var i=it.getInstance().get(t);if(null!=i)return i.getMask()}else if(null!=t)return t.getMask();return Eu.NONE}if(xt(n))return Eu[n];if(St(n))return n;for(var r=Eu.NONE,o=0,s=n.length;o<s;++o)r|=Eu[n[o]];return r},t}(),Cu=function(){function t(t,e){var n,i;this._date=null!==(n=null==t?void 0:t.date)&&void 0!==n?n:null,this._inclusive=null!==(i=null==t?void 0:t.inclusive)&&void 0!==i&&i,this._onChange=e}return Object.defineProperty(t.prototype,"date",{get:function(){return this._date},set:function(t){this._date!==t&&(this._date=t,this._onChange())},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"inclusive",{get:function(){return this._inclusive},set:function(t){this._inclusive!==t&&(this._inclusive=t,this._onChange())},enumerable:!1,configurable:!0}),t}(),Su=function(){function t(t){this._parent=t}return t.prototype.min=function(t){var e=this._parent,n=e.lower,i=n.date,r=e.constant;if(null!=i){var o=e.mask;if(o&Eu.DATE){if(i.getFullYear()<t.getFullYear())return r.hour.min;if(i.getMonth()<t.getMonth())return r.hour.min;if(i.getDate()<t.getDate())return r.hour.min}var s=i.getHours();return n.inclusive||o&Eu.SECONDS&&i.getSeconds()<r.second.max||o&Eu.MINUTES&&i.getMinutes()<r.minute.max?s:s+1}return r.hour.min},t.prototype.max=function(t){var e=this._parent,n=e.upper,i=n.date,r=e.constant;if(null!=i){var o=e.mask;if(o&Eu.DATE){if(t.getFullYear()<i.getFullYear())return r.hour.max;if(t.getMonth()<i.getMonth())return r.hour.max;if(t.getDate()<i.getDate())return r.hour.max}var s=i.getHours();return n.inclusive||o&Eu.SECONDS&&r.second.min<i.getSeconds()||o&Eu.MINUTES&&r.minute.min<i.getMinutes()?s:s-1}return r.hour.max},t}(),xu=function(){function t(t){this._parent=t}return t.prototype.min=function(t){var e=this._parent,n=e.lower,i=n.date,r=e.constant;if(null!=i){var o=e.mask;if(o&Eu.DATE){if(i.getFullYear()<t.getFullYear())return r.minute.min;if(i.getMonth()<t.getMonth())return r.minute.min;if(i.getDate()<t.getDate())return r.minute.min}if(o&Eu.HOURS&&i.getHours()<t.getHours())return r.minute.min;var s=i.getMinutes();return n.inclusive||o&Eu.SECONDS&&i.getSeconds()<r.second.max?s:s+1}return r.minute.min},t.prototype.max=function(t){var e=this._parent,n=e.upper,i=n.date,r=e.constant;if(null!=i){var o=e.mask;if(o&Eu.DATE){if(t.getFullYear()<i.getFullYear())return r.minute.max;if(t.getMonth()<i.getMonth())return r.minute.max;if(t.getDate()<i.getDate())return r.minute.max}if(o&Eu.HOURS&&t.getHours()<i.getHours())return r.minute.max;var s=i.getMinutes();return n.inclusive||o&Eu.SECONDS&&r.second.min<i.getSeconds()?s:s-1}return r.minute.max},t}(),Du=function(){function t(t){this._parent=t}return t.prototype.min=function(t){var e=this._parent,n=e.lower,i=n.date,r=e.constant;if(null!=i){var o=e.mask;if(o&Eu.DATE){if(i.getFullYear()<t.getFullYear())return r.second.min;if(i.getMonth()<t.getMonth())return r.second.min;if(i.getDate()<t.getDate())return r.second.min}return o&Eu.HOURS&&i.getHours()<t.getHours()||o&Eu.MINUTES&&i.getMinutes()<t.getMinutes()?r.second.min:i.getSeconds()+(n.inclusive?0:1)}return r.second.min},t.prototype.max=function(t){var e=this._parent,n=e.upper,i=n.date,r=e.constant;if(null!=i){var o=e.mask;if(o&Eu.DATE){if(t.getFullYear()<i.getFullYear())return r.second.max;if(t.getMonth()<i.getMonth())return r.second.max;if(t.getDate()<i.getDate())return r.second.max}return o&Eu.HOURS&&t.getHours()<i.getHours()||o&Eu.MINUTES&&t.getMinutes()<i.getMinutes()?r.second.max:i.getSeconds()-(n.inclusive?0:1)}return r.second.max},t}(),Iu=function(){function t(t,e){this.constant=this.newConstant(),this.lower=new Cu(t&&t.lower,e),this.upper=new Cu(t&&t.upper,e),this.mask=Eu.ALL,this.hours=new Su(this),this.minutes=new xu(this),this.seconds=new Du(this)}return t.prototype.newConstant=function(){return{second:{min:0,max:59},minute:{min:0,max:59},hour:{min:0,max:23}}},t.prototype.adjust=function(t){var e=this.test(t);if(e<0){var n=this.lower,i=n.date;if(i)return t.setTime(i.getTime()),n.inclusive||((r=this.mask)&Eu.SECONDS?t.setSeconds(i.getSeconds()+1):r&Eu.MINUTES?t.setMinutes(i.getMinutes()+1):r&Eu.HOURS?t.setHours(i.getHours()+1):r&Eu.DATE&&t.setDate(i.getDate()+1)),!0}else if(0<e){var r,o=this.upper,s=o.date;if(s)return t.setTime(s.getTime()),o.inclusive||((r=this.mask)&Eu.SECONDS?t.setSeconds(s.getSeconds()-1):r&Eu.MINUTES?t.setMinutes(s.getMinutes()-1):r&Eu.HOURS?t.setHours(s.getHours()-1):r&Eu.DATE&&t.setDate(s.getDate()-1)),!0}return!1},t.prototype.compare=function(t,e){var n=this.mask;if(n&Eu.DATE){var i,r,o,s,a=t.getFullYear(),u=e.getFullYear();if(a!==u)return a<u?-1:1;if((i=t.getMonth())!==(r=e.getMonth()))return i<r?-1:1;if((o=t.getDate())!==(s=e.getDate()))return o<s?-1:1}if(n&Eu.HOURS){var l=t.getHours(),h=e.getHours();if(l!==h)return l<h?-1:1}return n&Eu.MINUTES&&(i=t.getMinutes())!==(r=e.getMinutes())?i<r?-1:1:n&Eu.SECONDS&&(o=t.getSeconds())!==(s=e.getSeconds())?o<s?-1:1:0},t.prototype.test=function(t){var e=this.lower,n=e.date;if(null!=n){var i=this.compare(n,t);return e.inclusive?i<=0?0:-1:i<0?0:-1}var r=this.upper,o=r.date;return null!=o?(i=this.compare(t,o),r.inclusive?i<=0?0:1:i<0?0:1):0},t.prototype.contains=function(t){return 0===this.test(t)},t}(),Au=function(t,e,n){if(t){var i=t.date,r=t.inclusive;return{date:void 0!==i?i:e,inclusive:void 0!==r?r:n}}return{date:e,inclusive:n}},Ru=function(t){function e(e){var n=t.call(this,e)||this;return n.onNewChange(),n}return F(e,t),e.prototype.init=function(e){var n,i=this;t.prototype.init.call(this,e);var r=this.theme;this._dateCurrent=new Date;var o=this._dateCurrent.getTime();this._dateNew=new Date(o),this._dateBounds=new Iu(function(t,e){return e?{lower:Au(e.lower,t.getLowerBound(),t.isLowerBoundInclusive()),upper:Au(e.upper,t.getUpperBound(),t.isUpperBoundInclusive())}:{lower:{date:t.getLowerBound(),inclusive:t.isLowerBoundInclusive()},upper:{date:t.getUpperBound(),inclusive:t.isUpperBoundInclusive()}}}(r,null==e?void 0:e.bounds),(function(){i.onNewChange()}));var s=null!==(n=null==e?void 0:e.margin)&&void 0!==n?n:r.getMargin();new ta({parent:this,x:"padding",y:"padding",width:"auto",height:"auto",margin:s,children:this.newChildren(r,e,s)})},Object.defineProperty(e.prototype,"current",{get:function(){return this._dateCurrent},set:function(t){this._dateCurrent.getTime()!==t.getTime()&&(this._dateCurrent=t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"new",{get:function(){return this._dateNew},set:function(t){this._dateNew.getTime()!==t.getTime()&&(this._dateNew=t,this.onNewChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"bounds",{get:function(){return this._dateBounds},enumerable:!1,configurable:!0}),e.prototype.hasHours=function(){return null!=this._inputHours},e.prototype.hasMinutes=function(){return null!=this._inputMinutes},e.prototype.hasSeconds=function(){return null!=this._inputSeconds},e.prototype.reset=function(){var t=this._dateCurrent.getTime();this._dateNew.setTime(t),this.onReset()},e.prototype.onReset=function(){this.onNewChange()},e.prototype.onNewChange=function(){var t=this._dateNew,e=this._dateBounds;e.adjust(this._dateNew);var n=this._inputHours;if(n){var i=e.hours;n.value=t.getHours(),n.min=i.min(t),n.max=i.max(t)}var r=this._inputMinutes;if(r){var o=e.minutes;r.value=t.getMinutes(),r.min=o.min(t),r.max=o.max(t)}var s=this._inputSeconds;if(s){var a=e.seconds;s.value=t.getSeconds(),s.min=a.min(t),s.max=a.max(t)}},e.prototype.newChildren=function(t,e,n){var i=Ou.from(t,e);return this._dateBounds.mask=i,this._inputHours=i&Eu.HOURS?this.newInputHours(t,e):null,this._inputMinutes=i&Eu.MINUTES?this.newInputMinutes(t,e):null,this._inputSeconds=i&Eu.SECONDS?this.newInputSeconds(t,e):null,[this.newTimeLayout(this._inputHours,this._inputMinutes,this._inputSeconds,n)]},e.prototype.newTimeLayout=function(t,e,n,i){var r=this.newTimeLayoutChildren(t,e,n);return 0<r.length?new ja({width:this.getTimeLayoutWidth(),height:this.getTimeLayoutHeight(),margin:i,children:r}):null},e.prototype.getTimeLayoutWidth=function(){return"auto"},e.prototype.getTimeLayoutHeight=function(){return"auto"},e.prototype.newTimeLayoutChildren=function(t,e,n){var i=[];return null!=t&&i.push(t),null!=e&&(0<i.length&&i.push(this.newMinuteSeparator()),i.push(e)),null!=n&&(0<i.length&&i.push(this.newSecondSeparator()),i.push(n)),i},e.prototype.newMinuteSeparator=function(){return new mu({width:"auto",text:{value:this.getMinuteSeparator()}})},e.prototype.getMinuteSeparator=function(){return":"},e.prototype.newSecondSeparator=function(){return new mu({width:"auto",text:{value:this.getSecondSeparator()}})},e.prototype.getSecondSeparator=function(){return":"},e.prototype.adjustInputOptions=function(t,e,n){return null==e.step&&(e.step=1),null==e.min&&(e.min=0),null==e.max&&(e.max=n),e},e.prototype.newInputHours=function(t,e){var n,i=this,r=null!==(n=null==e?void 0:e.hours)&&void 0!==n?n:t.getHoursOptions(),o=this._dateBounds.constant.hour.max,s=new ou(this.adjustInputOptions(t,r,o));return s.on("change",(function(t){i.onHoursChange(t)})),s},e.prototype.onHoursChange=function(t){this._dateNew.setHours(t),this.onNewChange()},e.prototype.newInputMinutes=function(t,e){var n=this,i=(null==e?void 0:e.minutes)||t.getMinutesOptions(),r=this._dateBounds.constant.minute.max,o=new ou(this.adjustInputOptions(t,i,r));return o.on("change",(function(t){n.onMinutesChange(t)})),o},e.prototype.onMinutesChange=function(t){this._dateNew.setMinutes(t),this.onNewChange()},e.prototype.newInputSeconds=function(t,e){var n=this,i=(null==e?void 0:e.seconds)||t.getSecondsOptions(),r=this._dateBounds.constant.second.max,o=new ou(this.adjustInputOptions(t,i,r));return o.on("change",(function(t){n.onSecondsChange(t)})),o},e.prototype.onSecondsChange=function(t){this._dateNew.setSeconds(t)},e.prototype.getType=function(){return"DPickerTime"},e}(ao),Pu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this._datePage=new Date(this._dateCurrent.getTime())},e.prototype.newChildren=function(e,n,i){var r,o;this._dateButtons=this.newDateButtons(e,n),this._dateDecorator=null!==(o=null===(r=null==n?void 0:n.date)||void 0===r?void 0:r.decorator)&&void 0!==o?o:e.getDateDecorator(),this._label=this.newLabel(e,n);var s=t.prototype.newChildren.call(this,e,n,i);return s.unshift(new ja({width:"100%",height:"auto",children:[this.newBackButton(e,n),this._label,this.newNextButton(e,n)]}),new ja({width:"auto",height:"auto",margin:i,children:this.newDateLabels(e,n)}),new ta({width:"auto",height:"auto",margin:i,column:7,children:this._dateButtons})),s},Object.defineProperty(e.prototype,"page",{get:function(){return this._datePage},set:function(t){this._datePage.getTime()!==t.getTime()&&(this._datePage=t,this.onPageChange())},enumerable:!1,configurable:!0}),e.prototype.onReset=function(){this._datePage.setTime(this._dateCurrent.getTime()),t.prototype.onReset.call(this)},e.prototype.next=function(){var t=this._datePage;t.setFullYear(t.getFullYear(),t.getMonth()+1,1),t.setHours(0,0,0,0),this.onPageChange()},e.prototype.back=function(){var t=this._datePage;t.setFullYear(t.getFullYear(),t.getMonth()-1,1),t.setHours(0,0,0,0),this.onPageChange()},e.prototype.onNewChange=function(){this._dateBounds.adjust(this._datePage),t.prototype.onNewChange.call(this),this.onPageChange()},e.prototype.onPageChange=function(){var t=this._dateButtons,e=this._dateBounds,n=this._datePage,i=this._dateNew,r=new Date(n.getTime());r.setDate(1),r.setHours(0,0,0,0);for(var o=this.theme,s=(r.getDay()-o.getDayStart()+7)%7,a=0;a<s;++a)t[a].show();for(a=s;a<7;++a)t[a].hide();var u=this._dateDecorator;r.setFullYear(r.getFullYear(),r.getMonth()+1,0);var l=r.getDate(),h=i.getFullYear()===r.getFullYear()&&i.getMonth()===r.getMonth()?i.getDate():0;for(a=0;a<l;++a)r.setDate(a+1),(c=t[a+7]).state.isActive=h===a+1,c.state.isDisabled=!e.contains(r),c.show(),u(r,c);for(a=l;a<31;++a){var c;(c=t[a+7]).state.isActive=!1,c.hide()}r.setTime(n.getTime()),this._label.text=r},e.prototype.adjustInputOptions=function(e,n,i){return null==n.weight&&(n.weight=1),t.prototype.adjustInputOptions.call(this,e,n,i)},e.prototype.getTimeLayoutWidth=function(){return"100%"},e.prototype.toLabelOptions=function(t,e){var n=e&&e.label||{};void 0===n.weight&&(n.weight=1),void 0===n.padding&&(n.padding=0);var i=n.text=n.text||{},r=i.align=i.align||{};return void 0===r.horizontal&&(r.horizontal="CENTER"),void 0===i.formatter&&(i.formatter=t.getLabelFormatter()),n},e.prototype.newLabel=function(t,e){return new bu(this.toLabelOptions(t,e))},e.prototype.newBackButton=function(t,e){var n=this,i=null==e?void 0:e.back;if(void 0===i&&(i=t.getBackButtonOptions()),null!=i){var r=new gu(i);return r.on("active",(function(){n.back()})),r}return null},e.prototype.newNextButton=function(t,e){var n=this,i=null==e?void 0:e.next;if(void 0===i&&(i=t.getNextButtonOptions()),null!=i){var r=new _u(i);return r.on("active",(function(){n.next()})),r}return null},e.prototype.newDateLabels=function(t,e){for(var n=t.getDayLabels(),i=t.getDayStart(),r=[],o=0;o<7;++o){var s=n[(i+o)%7];r.push(this.newDateLabel(t,e,s))}return r},e.prototype.newDateLabel=function(t,e,n){return new Tu({text:{value:n}})},e.prototype.newDateButtons=function(t,e){for(var n=[],i=0;i<7;++i)n.push(this.newSpace(t,e));for(i=1;i<=31;++i)n.push(this.newDateButton(t,e,i));return n},e.prototype.newSpace=function(t,e){return new wu},e.prototype.newDateButton=function(t,e,n){var i=this;return new vu({text:{value:String(n)},on:{active:function(){i.onDateButtonClicked(n)}}})},e.prototype.onDateButtonClicked=function(t){var e=this._dateNew;if(e.getDate()!==t){var n=this._datePage;e.setFullYear(n.getFullYear()),e.setMonth(n.getMonth()),e.setDate(t),this.onNewChange()}},e.prototype.getType=function(){return"DPickerDatetime"},e}(Ru),Mu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.picker),i},Object.defineProperty(e.prototype,"current",{get:function(){return this.picker.current},set:function(t){this.picker.current=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"new",{get:function(){return this.picker.new},set:function(t){this.picker.new=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this.picker.new},set:function(t){this.picker.page=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"picker",{get:function(){var t,e=this._picker;return null==e&&(e=new Pu(null===(t=this._options)||void 0===t?void 0:t.picker),this._picker=e),e},enumerable:!1,configurable:!0}),e.prototype.getResolvedValue=function(){return this.picker.new},e.prototype.getType=function(){return"DDialogDatetime"},e}(yu),ku=function(t){function e(e){var n=t.call(this,e)||this;return n.initial=Te.ofUnknown(e.initial),n}return F(e,t),e.prototype.open=function(t,n,i,r,o,s){var a=e.DIALOG;return null==a&&(a=new Mu,e.DIALOG=a),a.new=a.current=this.toDate(i),a.open(t).then((function(t){return t.toISOString()}))},e.prototype.toDate=function(t){return xt(t)||St(t)?new Date(t):t instanceof Date?t:new Date},e}($a),Lu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.picker),i},Object.defineProperty(e.prototype,"current",{get:function(){return this.picker.current},set:function(t){this.picker.current=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"new",{get:function(){return this.picker.new},set:function(t){this.picker.new=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"picker",{get:function(){var t,e=this._picker;return null==e&&(e=new Ru(null===(t=this._options)||void 0===t?void 0:t.picker),this._picker=e),e},enumerable:!1,configurable:!0}),e.prototype.getResolvedValue=function(){return this.picker.new},e.prototype.getType=function(){return"DDialogTime"},e}(yu),Nu=function(t){return t!=t},Bu=function(t){function e(e){var n=t.call(this,e)||this;return n.initial=Te.ofUnknown(e.initial),n}return F(e,t),e.prototype.open=function(t,n,i,r,o,s){var a=this,u=e.DIALOG;return null==u&&(u=new Lu,e.DIALOG=u),u.new=u.current=this.toDate(i),u.open(t).then((function(t){return a.getFormatter().format(t.getTime(),0)}))},e.prototype.toDate=function(t){if(St(t))return new Date(t);if(xt(t)){var e=new Date,n=this.getPattern().exec(t);if(null!=n){var i=this.toHours(n[1]);null!=i&&e.setHours(i);var r=this.toMinutes(n[2]);null!=r&&e.setMinutes(r);var o=this.toSeconds(n[3]);null!=o&&e.setSeconds(o);var s=this.toMilliseconds(n[4]);null!=s&&e.setMilliseconds(s)}return e}return t instanceof Date?t:new Date},e.prototype.toHours=function(t){return this.toNumber(t,0,23)},e.prototype.toMinutes=function(t){return this.toNumber(t,0,59)},e.prototype.toSeconds=function(t){return this.toNumber(t,0,59)},e.prototype.toMilliseconds=function(t){var e=this.toNumber(t,0,999);if(null!=e){var n=t.length;return 1===n?100*e:2===n?10*e:e}return e},e.prototype.toNumber=function(t,e,n){if(null!=t){var i=+t;if(!Nu(i))return Math.min(n,Math.max(e,i))}return null},e.prototype.getPattern=function(){var t=e.PATTERN;return null==t&&(t=this.newPattern(),e.PATTERN=t),t},e.prototype.newPattern=function(){return/^\s*(?:(\d+)(?::(\d+)(?::(\d+))?)?)?(?:\.(\d+))?\s*$/},e.prototype.getFormatter=function(){var t=e.FORMATTER;return null==t&&(t=this.newFormatter(),e.FORMATTER=t),t},e.prototype.newFormatter=function(){return kn.create("%Hm")},e}($a),zu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPickerDate"},e}(Pu),Uu=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.picker),i},Object.defineProperty(e.prototype,"current",{get:function(){return this.picker.current},set:function(t){this.picker.current=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"new",{get:function(){return this.picker.new},set:function(t){this.picker.new=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"page",{get:function(){return this.picker.new},set:function(t){this.picker.page=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"picker",{get:function(){var t,e=this._picker;return null==e&&(e=new zu(null===(t=this._options)||void 0===t?void 0:t.picker),this._picker=e),e},enumerable:!1,configurable:!0}),e.prototype.getResolvedValue=function(){return this.picker.new},e.prototype.getType=function(){return"DDialogDate"},e}(yu),ju=function(t){function e(e){var n=t.call(this,e)||this;return n.initial=Te.ofUnknown(e.initial),n}return F(e,t),e.prototype.open=function(t,n,i,r,o,s){var a=this,u=e.DIALOG;return null==u&&(u=new Uu,e.DIALOG=u),u.new=u.current=this.toDate(i),u.open(t).then((function(t){return a.getFormatter().format(t.getTime(),0)}))},e.prototype.toDate=function(t){return xt(t)||St(t)?new Date(t):t instanceof Date?t:new Date},e.prototype.getFormatter=function(){var t=e.FORMATTER;return null==t&&(t=this.newFormatter(),e.FORMATTER=t),t},e.prototype.newFormatter=function(){return kn.create("%Y-%M-%D")},e}($a),Fu={TEXT:0,INTEGER:1,REAL:2,BOOLEAN:3,DATE:4,TIME:5,DATETIME:6,EXTENSION:1e3},Hu=function(t){function e(e,n,i,r,o,s,a,u){var l=t.call(this,ke.OPEN,e,zs.DIALOG)||this;return l.target=n,l.onInputAction=i,l.initial=r,l.step=o,l.min=s,l.max=a,l.dialogType=u,l}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.target===n.target&&this.dialogType===n.dialogType&&this.onInputAction===n.onInputAction&&this.initial===n.initial&&this.step===n.step&&this.min===n.min&&this.max===n.max},e.prototype.toRuntime=function(){switch(this.dialogType){case Fu.TEXT:return new fu(this);case Fu.INTEGER:return new au(this);case Fu.REAL:return new hu(this);case Fu.BOOLEAN:return new tu(this);case Fu.DATE:return new ju(this);case Fu.TIME:return new Bu(this);case Fu.DATETIME:return new ku(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.target),i=t.addResource(this.initial),r=t.addResource(this.step),o=t.addResource(this.min),s=t.addResource(this.max);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",").concat(this.onInputAction,",").concat(i,",").concat(this.dialogType,",").concat(r,",").concat(o,",").concat(s,"]"))},e.deserialize=function(t,n){var i=n.resources,r=Le.toResource(1,t,i),o=Le.toResource(3,t,i),s=Le.toResource(5,t,i),a=Le.toResource(7,t,i),u=Le.toResource(8,t,i),l=Le.toResource(9,t,i);return new e(r,o,t[4],s,a,u,l,this.toDialogType(t))},e.toDialogType=function(t){if(t[2]===zs.DIALOG)return t[6];switch(t[2]){case zs.DIALOG_TEXT:return Fu.TEXT;case zs.DIALOG_INTEGER:return Fu.INTEGER;case zs.DIALOG_REAL:return Fu.REAL;case zs.DIALOG_BOOLEAN:return Fu.BOOLEAN;case zs.DIALOG_DATE:return Fu.DATE;case zs.DIALOG_TIME:return Fu.TIME;case zs.DIALOG_DATETIME:return Fu.DATETIME}},e}(Me),Gu=function(){function t(){}return t.add=function(t){var e,n;(null!==(e=this._typeToDatum)&&void 0!==e?e:this._typeToDatum=new Map).set(t.type,t),(null!==(n=this._data)&&void 0!==n?n:this._data=[]).push(t)},t.get=function(t){var e=this._typeToDatum;if(null!=e)return e.get(t)},t.each=function(t){var e=this._data;if(null!=e)for(var n=0,i=e.length;n<i;++n)t(e[n])},t}(),Vu=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;n.target=Te.ofStringOrNull(e.target),n.argument=Te.ofUnknown(e.argument);var i=Gu.get(e.dialogType);return i&&(n.opener=i.opener),n}return F(e,t),e.prototype.execute=function(t,e,n){var i=this.opener;if(i&&this.condition(t,n,be)){var r=this.target(t,n,be);if(null!=r){var o=ns.toDiagram(t);if(null!=o){var s=this.argument(t,n,be);setTimeout((function(){i(r,s,t,o,be)}),0)}}}},e}(Ee),Wu=function(t){function e(e,n,i,r){var o=t.call(this,ke.OPEN,e,zs.DIALOG)||this;return o.target=n,o.argument=i,o.dialogType=r,o}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.target===n.target&&this.argument===n.argument&&this.dialogType===n.dialogType},e.prototype.toRuntime=function(){return new Vu(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.target),i=t.addResource(this.argument);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",0,-1,").concat(this.dialogType,",").concat(i,"]"))},e.deserialize=function(t,n){return new e(Le.toResource(1,t,n.resources),Le.toResource(3,t,n.resources),Le.toResource(7,t,n.resources),t[6])},e}(Me),Ku=function(){function t(){}return t.add=function(t){var e,n;(null!==(e=this._typeToDatum)&&void 0!==e?e:this._typeToDatum=new Map).set(t.type,t),(null!==(n=this._data)&&void 0!==n?n:this._data=[]).push(t),Ir[t.type]=t.opener},t.get=function(t){var e=this._typeToDatum;if(null!=e)return e.get(t)},t.each=function(t){var e=this._data;if(null!=e)for(var n=0,i=e.length;n<i;++n)t(e[n])},t}(),Xu=function(t){function e(e,n,i,r){var o=t.call(this,ke.OPEN,n,e)||this;return o.target=i,o.inNewWindow=r,o}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.target===n.target&&this.inNewWindow===n.inNewWindow},e.prototype.toRuntime=function(){return new Bs(this,this.subtype)},e.prototype.toLabel=function(){var t=this.getTheme().toTypeLabel(this.type),e=Ku.get(this.subtype);return"".concat(t,": ").concat(null!=e?e.label:"Unknown")},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.target),i=this.inNewWindow?1:0;return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",").concat(i,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources),r=Le.toResource(3,t,n.resources);return new e(t[2],i,r,!!t[4])},e}(Me),Yu={SHAPE_SHOW:0,SHAPE_HIDE:1,SHAPE:2,LAYER:3},qu=function(t){function e(e){var n=t.call(this,e,_e.VISIBILITY)||this;return n.visibility=e.subtype===Yu.SHAPE_SHOW,n}return F(e,t),e.prototype.execute=function(t,e,n){this.condition(t,n,be)&&(t.visible=this.visibility,e.written|=this.reset)},e}(Ee),Zu=function(t){function e(e,n){return t.call(this,ke.SHOW_HIDE,n,e)||this}return F(e,t),e.prototype.toRuntime=function(){return new qu(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources);return new e(t[2],i)},e}(Me),Ju=function(t){function e(e){var n=t.call(this,e,_e.NONE)||this;return n._data=new Map,n._layers=e.layers,n._bringToFront=e.bringToFront,n}return F(e,t),e.prototype.initialize=function(e,n){t.prototype.initialize.call(this,e,n);var i=this._data.get(e);null==i&&null!=(i=this.newData(e))&&this._data.set(e,i)},e.prototype.execute=function(t,e,n){var i=this._data.get(t);if(i){var r=this.condition(t,n,be);if(i.condition!==r){i.condition=r;var o=i.layers;r?i.bringToFront?(ur.bringAllToFront(o),ur.showAll(o)):ur.showAll(o):ur.hideAll(o)}}},e.prototype.newData=function(t){var e=ur.toLayers(t,this._layers);if(0<e.length)return{layers:e,bringToFront:this._bringToFront,condition:null}},e}(Ee),Qu=function(t){function e(e,n,i){var r=t.call(this,ke.SHOW_HIDE,e,Yu.LAYER)||this;return r.layers=n,r.bringToFront=i,r}return F(e,t),e.prototype.toRuntime=function(){return new Ju(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=this.serializeLayers(t),i=this.bringToFront?1:0;return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(n,",").concat(i,"]"))},e.prototype.serializeLayers=function(t){for(var e=this.layers,n="[",i="",r=0,o=e.length;r<o;++r)n+=i+e[r],i=",";return n+="]",t.addResource(n)},e.deserialize=function(t,n){return new e(Le.toResource(1,t,n.resources),this.deserializeLayers(t[3],n),!!t[4])},e.deserializeLayers=function(t,e){var n=e.resources,i=n.length;return 0<=t&&t<i?JSON.parse(n[t]):[]},e}(Me),$u=function(t){function e(e){return t.call(this,e,_e.VISIBILITY)||this}return F(e,t),e.prototype.initialize=function(e,n){t.prototype.initialize.call(this,e,n)},e.prototype.execute=function(t,e,n){t.visible=this.condition(t,n,be),e.written|=this.reset},e}(Ee),tl=function(t){function e(e){return t.call(this,ke.SHOW_HIDE,e,Yu.SHAPE)||this}return F(e,t),e.prototype.toRuntime=function(){return new $u(this)},e.prototype.serialize=function(t){var e=t.addResource(this.condition);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,"]"))},e.deserialize=function(t,n){return new e(Le.toResource(1,t,n.resources))},e}(Me),el=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.amount=Te.ofNumber(e.amount),i}return F(e,t),e}(Ee),nl=function(t){function e(e){return t.call(this,e,_e.POSITION_X)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be);t.transform.position.x=i,e.written|=this.reset}},e}(el),il=function(t){function e(e){return t.call(this,e,_e.POSITION_Y)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be);t.transform.position.y=i,e.written|=this.reset}},e}(el),rl=function(t){function e(e){return t.call(this,e,_e.POSITION)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be),r=t.transform,o=r.position,s=!!(e.written&_e.POSITION_X),a=!!(e.written&_e.POSITION_Y),u=s?o.x:e.x,l=a?o.y:e.y;t.updateTransform();var h=r.localTransform;o.set(u-h.c*i,l-h.d*i),e.written|=this.reset}},e}(el),ol=function(t){function e(e){return t.call(this,e,_e.POSITION)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be),r=t.transform,o=r.position,s=!!(e.written&_e.POSITION_X),a=!!(e.written&_e.POSITION_Y),u=s?o.x:e.x,l=a?o.y:e.y;t.updateTransform();var h=r.localTransform;o.set(u+h.a*i,l+h.b*i),e.written|=this.reset}},e}(el),sl=function(t){function e(e){return t.call(this,e,_e.POSITION_X)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be),r=!!(e.written&_e.POSITION_X),o=t.transform.position,s=r?o.x:e.x;o.x=s+i,e.written|=this.reset}},e}(el),al=function(t){function e(e){return t.call(this,e,_e.POSITION_Y)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be),r=!!(e.written&_e.POSITION_Y),o=t.transform.position,s=r?o.y:e.y;o.y=s+i,e.written|=this.reset}},e}(el),ul=function(t){function e(e,n,i,r){var o=t.call(this,e,n,i)||this;return o.opetype=r,o}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.opetype===n.opetype},e}(Me),ll={RELATIVE_X:0,RELATIVE_Y:1,ABSOLUTE_X:2,ABSOLUTE_Y:3,FORWARD_OR_BACKWARD:4,LEFT_OR_RIGHT:5},hl={RESIZE:0,MOVE:1,ROTATE:2},cl=function(t){function e(e,n,i){var r=t.call(this,ke.TRANSFORM,n,hl.MOVE,e)||this;return r.amount=i,r}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.amount===n.amount},e.prototype.toRuntime=function(){switch(this.opetype){case ll.ABSOLUTE_X:return new nl(this);case ll.ABSOLUTE_Y:return new il(this);case ll.FORWARD_OR_BACKWARD:return new rl(this);case ll.LEFT_OR_RIGHT:return new ol(this);case ll.RELATIVE_X:return new sl(this);case ll.RELATIVE_Y:return new al(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.amount);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(this.opetype,",").concat(n,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources),r=Le.toResource(4,t,n.resources);return new e(t[3],i,r)},e}(ul),pl={RELATIVE_SIZE:0,RELATIVE_HEIGHT:1,RELATIVE_WIDTH:2,ABSOLUTE_SIZE:3,ABSOLUTE_HEIGHT:4,ABSOLUTE_WIDTH:5},fl=function(t){function e(e,n){var i=t.call(this,e,n)||this;switch(e.opetype){case pl.RELATIVE_SIZE:i.size=Te.ofNumberOrOne(e.amount);break;case pl.ABSOLUTE_SIZE:i.size=Te.ofNumberOrOneHundred(e.amount);break;case pl.RELATIVE_HEIGHT:i.size=Te.ofNumberOrOne(e.amount);break;case pl.ABSOLUTE_HEIGHT:i.size=Te.ofNumberOrOneHundred(e.amount);break;case pl.RELATIVE_WIDTH:i.size=Te.ofNumberOrOne(e.amount);break;case pl.ABSOLUTE_WIDTH:i.size=Te.ofNumberOrOneHundred(e.amount);break;default:i.size=Te.ONE}return i}return F(e,t),e.prototype.adjustPosition=function(t,e,n,i,r,o){var s=(-.5+r)*n,a=(-.5+o)*i;t.updateTransform();var u=t.transform,l=u.position,h=u.localTransform,c=!!(e.written&_e.POSITION_X),p=!!(e.written&_e.POSITION_Y),f=c?l.x:e.x,d=p?l.y:e.y;e.written|=_e.POSITION,l.set(f+s*h.a+a*h.c,d+s*h.b+a*h.d)},e}(Ee),dl=function(t){function e(e){var n=t.call(this,e,_e.HEIGHT|_e.POSITION)||this;return n.origin=e.originY,n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.size(t,n,be),r=t.size,o=e.written&_e.HEIGHT?r.y:e.sizeY;r.y=Yn(i),e.written|=_e.HEIGHT,this.adjustPosition(t,e,0,o-r.y,.5,this.origin)}},e}(fl),yl=function(t){function e(e){var n=t.call(this,e,_e.HEIGHT|_e.POSITION)||this;return n.origin=e.originY,n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.size(t,n,be),r=t.size,o=e.written&_e.HEIGHT?r.y:e.sizeY;r.y=Yn(o*i),e.written|=_e.HEIGHT,this.adjustPosition(t,e,0,o-r.y,.5,this.origin)}},e}(fl),gl=function(t){function e(e){var n=t.call(this,e,_e.SIZE|_e.POSITION)||this;return n.originX=e.originX,n.originY=e.originY,n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=Yn(this.size(t,n,be)),r=t.size,o=!!(e.written&_e.WIDTH),s=!!(e.written&_e.HEIGHT),a=o?r.x:e.sizeX,u=s?r.y:e.sizeY;r.set(i,i),e.written|=_e.SIZE,this.adjustPosition(t,e,a-r.x,u-r.y,this.originX,this.originY)}},e}(fl),vl=function(t){function e(e){var n=t.call(this,e,_e.SIZE|_e.POSITION)||this;return n.originX=e.originX,n.originY=e.originY,n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.size(t,n,be),r=t.size,o=!!(e.written&_e.WIDTH),s=!!(e.written&_e.HEIGHT),a=o?r.x:e.sizeX,u=s?r.y:e.sizeY;r.set(Yn(a*i),Yn(u*i)),e.written|=_e.SIZE,this.adjustPosition(t,e,a-r.x,u-r.y,this.originX,this.originY)}},e}(fl),_l=function(t){function e(e){var n=t.call(this,e,_e.WIDTH|_e.POSITION)||this;return n.origin=e.originX,n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.size(t,n,be),r=t.size,o=e.written&_e.WIDTH?r.x:e.sizeX;r.x=Yn(i),e.written|=_e.WIDTH,this.adjustPosition(t,e,o-r.x,0,this.origin,.5)}},e}(fl),ml=function(t){function e(e){var n=t.call(this,e,_e.WIDTH|_e.POSITION)||this;return n.origin=e.originX,n}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.size(t,n,be),r=t.size,o=e.written&_e.WIDTH?r.x:e.sizeX;r.x=Yn(o*i),e.written|=_e.WIDTH,this.adjustPosition(t,e,o-r.x,0,this.origin,.5)}},e}(fl),bl=function(t){function e(e,n,i,r,o){var s=t.call(this,ke.TRANSFORM,n,hl.RESIZE,e)||this;return s.originX=i,s.originY=r,s.amount=o,s}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.originX===n.originX&&this.originY===n.originY&&this.amount===n.amount},e.prototype.toRuntime=function(){switch(this.opetype){case pl.ABSOLUTE_HEIGHT:return new dl(this);case pl.ABSOLUTE_WIDTH:return new _l(this);case pl.ABSOLUTE_SIZE:return new gl(this);case pl.RELATIVE_HEIGHT:return new yl(this);case pl.RELATIVE_WIDTH:return new ml(this);case pl.RELATIVE_SIZE:return new vl(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.amount);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(this.opetype,",").concat(this.originX,",").concat(this.originY,",").concat(n,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources),r=Le.toResource(6,t,n.resources);return new e(t[3],i,t[4],t[5],r)},e}(ul),Tl=function(t){function e(e,n){var i=t.call(this,e,n)||this;return i.originX=e.originX,i.originY=e.originY,i.amount=Te.ofNumber("(".concat(e.amount,") * (Math.PI / 180)")),i}return F(e,t),e.prototype.adjustPosition=function(t,e,n,i,r,o){var s=!!(e.written&_e.WIDTH),a=!!(e.written&_e.HEIGHT),u=(-.5+r)*(s?t.size.x:e.sizeX),l=(-.5+o)*(a?t.size.y:e.sizeY),h=Math.sin(n)-Math.sin(i),c=Math.cos(n)-Math.cos(i),p=t.transform.position,f=!!(e.written&_e.POSITION_X),d=!!(e.written&_e.POSITION_Y),y=f?p.x:e.x,g=d?p.y:e.y;e.written|=_e.POSITION,p.set(y+u*c-l*h,g+u*h+l*c)},e}(Ee),wl=function(t){function e(e){return t.call(this,e,_e.ROTATION|_e.POSITION)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be),r=t.transform,o=e.written&_e.ROTATION?r.rotation:e.rotation;r.rotation=i,e.written|=_e.ROTATION,this.adjustPosition(t,e,o,i,this.originX,this.originY)}},e}(Tl),El=function(t){function e(e){return t.call(this,e,_e.ROTATION|_e.POSITION)||this}return F(e,t),e.prototype.execute=function(t,e,n){if(this.condition(t,n,be)){var i=this.amount(t,n,be),r=t.transform,o=e.written&_e.ROTATION?r.rotation:e.rotation;r.rotation=o+i,e.written|=_e.ROTATION,this.adjustPosition(t,e,o,r.rotation,this.originX,this.originY)}},e}(Tl),Ol={RELATIVE:0,ABSOLUTE:1},Cl=function(t){function e(e,n,i,r,o){var s=t.call(this,ke.TRANSFORM,n,hl.ROTATE,e)||this;return s.originX=i,s.originY=r,s.amount=o,s}return F(e,t),e.prototype.isEquals=function(n){return t.prototype.isEquals.call(this,n)&&n instanceof e&&this.originX===n.originX&&this.originY===n.originY&&this.amount===n.amount},e.prototype.toRuntime=function(){switch(this.opetype){case Ol.ABSOLUTE:return new wl(this);case Ol.RELATIVE:return new El(this)}},e.prototype.serialize=function(t){var e=t.addResource(this.condition),n=t.addResource(this.amount);return t.addResource("[".concat(this.type,",").concat(e,",").concat(this.subtype,",").concat(this.opetype,",").concat(this.originX,",").concat(this.originY,",").concat(n,"]"))},e.deserialize=function(t,n){var i=Le.toResource(1,t,n.resources),r=Le.toResource(6,t,n.resources);return new e(t[3],i,t[4],t[5],r)},e}(ul),Sl=function(t,e){switch(t[0]){case ke.SHOW_HIDE:switch(t[2]){case Yu.SHAPE_SHOW:case Yu.SHAPE_HIDE:return Zu.deserialize(t,e);case Yu.SHAPE:return tl.deserialize(t,e);case Yu.LAYER:return Qu.deserialize(t,e)}break;case ke.BLINK:return Ne.deserialize(t,e);case ke.CHANGE_COLOR:case ke.CHANGE_COLOR_LEGACY:switch(t[3]){case Ue.COLOR_AND_ALPHA:case Ue.COLOR:case Ue.ALPHA:return Ve.deserialize(t,e);case Ue.CODE:return Ye.deserialize(t,e);case Ue.BRIGHTNESS:return Ke.deserialize(t,e)}break;case ke.CHANGE_FILL_PERCENT:return Qe.deserialize(t,e);case ke.CHANGE_TEXT:return zn.deserialize(t,e);case ke.CHANGE_CURSOR:return Ze.deserialize(t,e);case ke.EMIT_EVENT:return rs.deserialize(t,e);case ke.OPEN:switch(t[2]){case zs.DIALOG_TEXT:case zs.DIALOG_INTEGER:case zs.DIALOG_REAL:case zs.DIALOG_BOOLEAN:case zs.DIALOG_DATE:case zs.DIALOG_TIME:case zs.DIALOG_DATETIME:case zs.DIALOG:return Fu.EXTENSION<=t[6]?Wu.deserialize(t,e):Hu.deserialize(t,e);case zs.DIAGRAM_LEGACY:case zs.PAGE_LEGACY:case zs.PAGE_INPLACE_LEGACY:case zs.DIAGRAM:case zs.PAGE:return Us.deserialize(t,e);default:if(zs.EXTENSION<=t[2])return Xu.deserialize(t,e)}break;case ke.TRANSFORM:switch(t[2]){case hl.MOVE:return cl.deserialize(t,e);case hl.RESIZE:return bl.deserialize(t,e);case hl.ROTATE:return Cl.deserialize(t,e)}break;case ke.GESTURE:return Or.deserialize(t,e);case ke.MISC:switch(t[2]){case Er.GESTURE:return Or.deserialize(t,e);case Er.SHOW_HIDE_LAYER:return Qu.deserialize(t,e);case Er.GESTURE_LAYER:return Or.deserialize(t,e);case Er.EXECUTE:return Ms.deserialize(t,e);default:return Er.EXTENSION<=t[2]?Ns.deserialize(t,e):Rs.deserialize(t,e)}}return null},xl={},Dl=function(t){try{var e=JSON.parse(t);return Ot(e)&&2<=e.length?e:null}catch(t){return null}},Il=function(t,e,n){var i=e.resources;if(0<=t&&t<i.length){var r=i[t];xt(r)&&(n.gradient=function(t){var e=function(t){try{return JSON.parse(t)}catch(t){return null}}(t);if(!(null==e||e.length<7)){for(var n=e[0],i=[],r=1,o=e.length;r<o;r+=3)i.push({color:e[r+0],alpha:e[r+1],position:e[r+2]});return{points:i,direction:n}}}(r))}},Al={},Rl=function(t){var e=Al[t];if(null!=e)return"url"in e?Promise.resolve(e):e;var n=new Promise((function(e,n){var i=document.createElement("img");i.onload=function(){var n={url:t,width:i.width,height:i.height,source:i};Al[t]=n,e(n)},i.onabort=i.onerror=function(){n()},i.src=t}));return Al[t]=n,n},Pl=function(t,e,n){var i=e.resources;n.id=i[t[1]]||"";var r=n.transform;r.position.set(t[2],t[3]),r.rotation=t[6],r.skew.set(t[7],t[7]),r.pivot.set(t[21],t[22]),n.size.set(Yn(t[4]),Yn(t[5])),n.fill.deserialize(t[8],e),n.stroke.deserialize(t[9],e);var o=t[10];n.cursor=0<=o?i[o]:void 0,n.text.deserialize(t[11],e),n.data.deserialize(t[12],e),n.radius=t[13],n.corner=t[14];var s=t[23];n.interactive=!!(1&s);var a=n.state;a.isFocusable=!(2&s),a.isActive=!!(4&s);var u=t[24];n.shortcut=0<=u?i[u]:void 0;var l=t[25];n.title=0<=l?i[l]:void 0;var h=t[26];n.uuid=null!=h?h:0;var c=t[27],p=t[28],f=t[29];(null!=c&&c!==Lt.NONE||null!=p&&p!==Lt.NONE||null!=f&&f!==Lt.NONE)&&n.capability.set(c,p,f);var d=function(t,e,n){if(0<t.length){for(var i=[],r=0,o=t.length;r<o;++r)i.push(ii(t[r],e));return Promise.all(i).then((function(t){n.children=t;for(var e=0,i=t.length;e<i;++e)t[e].parent=n;return n.onChildTransformChange(),n.toDirty(),n}))}return null}(t[20],e,n);!function(t,e,n){for(var i=n.action,r=e.resources,o=0,s=t.length;o<s;++o){var a=t[o],u=e.getAction(a);if(null!=u)i.add(u);else{var l=r[a];if(null!=l){var h=Dl(l);if(null!=h&&0<h.length){var c=h[0],p=ke.EXTENSION<=c?xl[c]:Sl;if(null!=p){var f=p(h,e);null!=f&&(e.setAction(a,f),i.add(f))}}}}}}(t[17],e,n),Il(t[19],e,n);var y=function(t,e,n){var i=e.resources;if(0<=t&&t<i.length){var r=i[t];if(xt(r))return Rl(r).then((function(t){return n.image=t,n}))}return null}(t[18],e,n);return null!=d?null!=y?Promise.all([d,y]).then((function(){return n})):d:null!=y?y:n},Ml=function(t,e,n){n=n||new pe;var i=Pl(t,e,n);n.points.deserialize(t[15],e);var r=n.points.style,o=X.NON_SCALING_MASK|X.DOTTED_MASK|X.DASHED_MASK,s=r&o;return s&&(n.points.style&=~o,n.stroke.style|=s),i},kl=function(){r[i.BAR]=ye,e[i.BAR]=Ml},Ll=44,Nl=24,Bl=[0,0,0,0,0],zl=new t.Point,Ul=function(t,e,n){var i=3*n-1;t[++i]=e+0,t[++i]=e+1,t[++i]=e+2,t[++i]=e+2,t[++i]=e+1,t[++i]=e+3,t[++i]=e+4,t[++i]=e+5,t[++i]=e+6,t[++i]=e+6,t[++i]=e+5,t[++i]=e+7,t[++i]=e+8,t[++i]=e+9,t[++i]=e+10,t[++i]=e+10,t[++i]=e+9,t[++i]=e+11,t[++i]=e+12,t[++i]=e+13,t[++i]=e+14,t[++i]=e+14,t[++i]=e+13,t[++i]=e+15,t[++i]=e+16,t[++i]=e+17,t[++i]=e+19,t[++i]=e+19,t[++i]=e+17,t[++i]=e+20,t[++i]=e+18,t[++i]=e+20,t[++i]=e+21,t[++i]=e+21,t[++i]=e+20,t[++i]=e+22,t[++i]=e+23,t[++i]=e+24,t[++i]=e+25,t[++i]=e+25,t[++i]=e+24,t[++i]=e+26,t[++i]=e+25,t[++i]=e+27,t[++i]=e+28,t[++i]=e+28,t[++i]=e+27,t[++i]=e+29,t[++i]=e+30,t[++i]=e+31,t[++i]=e+32,t[++i]=e+32,t[++i]=e+31,t[++i]=e+34,t[++i]=e+33,t[++i]=e+34,t[++i]=e+35,t[++i]=e+35,t[++i]=e+34,t[++i]=e+36,t[++i]=e+37,t[++i]=e+38,t[++i]=e+39,t[++i]=e+39,t[++i]=e+38,t[++i]=e+41,t[++i]=e+39,t[++i]=e+40,t[++i]=e+42,t[++i]=e+42,t[++i]=e+40,t[++i]=e+43},jl=function(t,e,n,i,r,o,s,a,u,l,h){var c=s*a,p=.5*r+(0<=r?+c:-c),f=.5*o+(0<=o?+c:-c),d=Math.abs(p),y=Math.abs(f),g=u*Math.min(d,y),v=g/d,_=g/y,m=zl;m.set(n-p,i-f),l.apply(m,m);var b=m.x,T=m.y;m.set(n,i-f),l.apply(m,m);var w=m.x,E=m.y;m.set(n-p,i),l.apply(m,m);var O=m.x,C=m.y,S=w-b,x=E-T,D=O-b,I=C-T,A=w+S,R=E+x,P=O+S,M=C+x,k=A+D,L=R+I,N=O+D,B=C+I,z=N+S,U=B+x,j=z+S,F=U+x,H=v*S,G=v*x,V=_*D,W=_*I,K=b,X=T,Y=K+H,q=X+G,Z=K+V,J=X+W,Q=Z+H,$=J+G,tt=2*e-1;t[++tt]=K,t[++tt]=X,t[++tt]=Y,t[++tt]=q,t[++tt]=Z,t[++tt]=J,t[++tt]=Q,t[++tt]=$;var et=A,nt=R,it=A-H,rt=R-G,ot=it+V,st=rt+W,at=ot+H,ut=st+G;t[++tt]=it,t[++tt]=rt,t[++tt]=et,t[++tt]=nt,t[++tt]=ot,t[++tt]=st,t[++tt]=at,t[++tt]=ut;var lt=N,ht=B,ct=lt-V,pt=ht-W,ft=lt+H,dt=ht+G,yt=ct+H,gt=pt+G;t[++tt]=ct,t[++tt]=pt,t[++tt]=yt,t[++tt]=gt,t[++tt]=lt,t[++tt]=ht,t[++tt]=ft,t[++tt]=dt;var vt=j,_t=F,mt=vt-H,bt=_t-G,Tt=vt-V,wt=_t-W,Et=Tt-H,Ot=wt-G;t[++tt]=Et,t[++tt]=Ot,t[++tt]=Tt,t[++tt]=wt,t[++tt]=mt,t[++tt]=bt,t[++tt]=vt,t[++tt]=_t;var Ct=Y,St=q,xt=w,Dt=E,It=Z,At=J,Rt=Q,Pt=$,Mt=xt+V,kt=Dt+W,Lt=O,Nt=C,Bt=P,zt=M;t[++tt]=Ct,t[++tt]=St,t[++tt]=xt,t[++tt]=Dt,t[++tt]=It,t[++tt]=At,t[++tt]=Rt,t[++tt]=Pt,t[++tt]=Mt,t[++tt]=kt,t[++tt]=Lt,t[++tt]=Nt,t[++tt]=Bt,t[++tt]=zt;var Ut=xt,jt=Dt,Ft=it,Ht=rt,Gt=Mt,Vt=kt,Wt=ot,Kt=st,Xt=at,Yt=ut,qt=Bt,Zt=zt,Jt=k,Qt=L;t[++tt]=Ut,t[++tt]=jt,t[++tt]=Ft,t[++tt]=Ht,t[++tt]=Gt,t[++tt]=Vt,t[++tt]=Wt,t[++tt]=Kt,t[++tt]=Xt,t[++tt]=Yt,t[++tt]=qt,t[++tt]=Zt,t[++tt]=Jt,t[++tt]=Qt;var $t=Lt,te=Nt,ee=Bt,ne=zt,ie=ct,re=pt,oe=yt,se=gt,ae=z-V,ue=U-W,le=ft,he=dt,ce=z,pe=U;t[++tt]=$t,t[++tt]=te,t[++tt]=ee,t[++tt]=ne,t[++tt]=ie,t[++tt]=re,t[++tt]=oe,t[++tt]=se,t[++tt]=ae,t[++tt]=ue,t[++tt]=le,t[++tt]=he,t[++tt]=ce,t[++tt]=pe;var fe=ee,de=ne,ye=Jt,ge=Qt,ve=ae,_e=ue,me=Et,be=Ot,Te=Tt,we=wt,Ee=ce,Oe=pe,Ce=mt,Se=bt;t[++tt]=fe,t[++tt]=de,t[++tt]=ye,t[++tt]=ge,t[++tt]=ve,t[++tt]=_e,t[++tt]=me,t[++tt]=be,t[++tt]=Te,t[++tt]=we,t[++tt]=Ee,t[++tt]=Oe,t[++tt]=Ce,t[++tt]=Se,h[0]=d,h[1]=y,h[2]=g,h[3]=v,h[4]=_},Fl=function(t,e,n,i,r,o,s){var a=u(r),l=s[0],h=s[1],c=s[2],d=i&Z.TOP?1:0,y=i&Z.RIGHT?1:0,g=i&Z.BOTTOM?1:0,v=i&Z.LEFT?1:0,_=p(0,a,v,d),m=p(0,a,y,d),b=p(0,a,v,g),T=p(0,a,y,g),w=p(1,a,v,d),E=p(1,a,y,d),O=p(1,a,v,g),C=p(1,a,y,g),S=1-s[3],x=1-s[4],D=f(1,1),I=f(0,1),A=f(1,0),R=f(0,0),P=f(S,1),M=f(1,x),k=f(S,x),L=f(0,x),N=6*e-1;o&pt.TOP_LEFT?(t[++N]=n,t[++N]=w,t[++N]=c,t[++N]=c,t[++N]=D,t[++N]=0,t[++N]=n,t[++N]=w,t[++N]=c,t[++N]=c,t[++N]=I,t[++N]=0,t[++N]=n,t[++N]=w,t[++N]=c,t[++N]=c,t[++N]=A,t[++N]=0,t[++N]=n,t[++N]=w,t[++N]=c,t[++N]=c,t[++N]=R,t[++N]=0):(t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=D,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0),o&pt.TOP_RIGHT?(t[++N]=n,t[++N]=E,t[++N]=c,t[++N]=c,t[++N]=I,t[++N]=0,t[++N]=n,t[++N]=E,t[++N]=c,t[++N]=c,t[++N]=D,t[++N]=0,t[++N]=n,t[++N]=E,t[++N]=c,t[++N]=c,t[++N]=R,t[++N]=0,t[++N]=n,t[++N]=E,t[++N]=c,t[++N]=c,t[++N]=A,t[++N]=0):(t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=D,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0),o&pt.BOTTOM_LEFT?(t[++N]=n,t[++N]=O,t[++N]=c,t[++N]=c,t[++N]=A,t[++N]=0,t[++N]=n,t[++N]=O,t[++N]=c,t[++N]=c,t[++N]=R,t[++N]=0,t[++N]=n,t[++N]=O,t[++N]=c,t[++N]=c,t[++N]=D,t[++N]=0,t[++N]=n,t[++N]=O,t[++N]=c,t[++N]=c,t[++N]=I,t[++N]=0):(t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=D,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0),o&pt.BOTTOM_RIGHT?(t[++N]=n,t[++N]=C,t[++N]=c,t[++N]=c,t[++N]=R,t[++N]=0,t[++N]=n,t[++N]=C,t[++N]=c,t[++N]=c,t[++N]=A,t[++N]=0,t[++N]=n,t[++N]=C,t[++N]=c,t[++N]=c,t[++N]=I,t[++N]=0,t[++N]=n,t[++N]=C,t[++N]=c,t[++N]=c,t[++N]=D,t[++N]=0):(t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=D,t[++N]=0),t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=I,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=L,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=A,t[++N]=0,t[++N]=n,t[++N]=_,t[++N]=l,t[++N]=h,t[++N]=R,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=I,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=L,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=R,t[++N]=0,t[++N]=n,t[++N]=m,t[++N]=l,t[++N]=h,t[++N]=A,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=A,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=R,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=L,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0,t[++N]=n,t[++N]=b,t[++N]=l,t[++N]=h,t[++N]=I,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=R,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=A,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=L,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=k,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=M,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=I,t[++N]=0,t[++N]=n,t[++N]=T,t[++N]=l,t[++N]=h,t[++N]=P,t[++N]=0},Hl=function(t,e,n,i){var r=n.x0,o=n.y0,s=n.x1,a=n.y1,u=n.x2,l=n.y2,h=n.x3,c=n.y3,p=.5*(r+s),f=.5*(o+a),d=.5*(r+h),y=.5*(o+c),g=p-r,v=f-o,_=d-r,m=y-o,b=d+g,T=y+v,w=s+_,E=a+m,O=h+g,C=c+v,S=i[3],x=i[4],D=S*g,I=S*v,A=x*_,R=x*m,P=r,M=o,k=P+D,L=M+I,N=P+A,B=M+R,z=N+D,U=B+I,j=2*e-1;t[++j]=P,t[++j]=M,t[++j]=k,t[++j]=L,t[++j]=N,t[++j]=B,t[++j]=z,t[++j]=U;var F=s,H=a,G=s-D,V=a-I,W=G+A,K=V+R,X=W+D,Y=K+I;t[++j]=G,t[++j]=V,t[++j]=F,t[++j]=H,t[++j]=W,t[++j]=K,t[++j]=X,t[++j]=Y;var q=h,Z=c,J=q-A,Q=Z-R,$=q+D,tt=Z+I,et=J+D,nt=Q+I;t[++j]=J,t[++j]=Q,t[++j]=et,t[++j]=nt,t[++j]=q,t[++j]=Z,t[++j]=$,t[++j]=tt;var it=u,rt=l,ot=it-D,st=rt-I,at=it-A,ut=rt-R,lt=at-D,ht=ut-I;t[++j]=lt,t[++j]=ht,t[++j]=at,t[++j]=ut,t[++j]=ot,t[++j]=st,t[++j]=it,t[++j]=rt;var ct=k,pt=L,ft=p,dt=f,yt=N,gt=B,vt=z,_t=U,mt=ft+A,bt=dt+R,Tt=d,wt=y,Et=b,Ot=T;t[++j]=ct,t[++j]=pt,t[++j]=ft,t[++j]=dt,t[++j]=yt,t[++j]=gt,t[++j]=vt,t[++j]=_t,t[++j]=mt,t[++j]=bt,t[++j]=Tt,t[++j]=wt,t[++j]=Et,t[++j]=Ot;var Ct=ft,St=dt,xt=G,Dt=V,It=mt,At=bt,Rt=W,Pt=K,Mt=X,kt=Y,Lt=Et,Nt=Ot,Bt=w,zt=E;t[++j]=Ct,t[++j]=St,t[++j]=xt,t[++j]=Dt,t[++j]=It,t[++j]=At,t[++j]=Rt,t[++j]=Pt,t[++j]=Mt,t[++j]=kt,t[++j]=Lt,t[++j]=Nt,t[++j]=Bt,t[++j]=zt;var Ut=Tt,jt=wt,Ft=Et,Ht=Ot,Gt=J,Vt=Q,Wt=et,Kt=nt,Xt=O-A,Yt=C-R,qt=$,Zt=tt,Jt=O,Qt=C;t[++j]=Ut,t[++j]=jt,t[++j]=Ft,t[++j]=Ht,t[++j]=Gt,t[++j]=Vt,t[++j]=Wt,t[++j]=Kt,t[++j]=Xt,t[++j]=Yt,t[++j]=qt,t[++j]=Zt,t[++j]=Jt,t[++j]=Qt;var $t=Ft,te=Ht,ee=Bt,ne=zt,ie=Xt,re=Yt,oe=lt,se=ht,ae=at,ue=ut,le=Jt,he=Qt,ce=ot,pe=st;t[++j]=$t,t[++j]=te,t[++j]=ee,t[++j]=ne,t[++j]=ie,t[++j]=re,t[++j]=oe,t[++j]=se,t[++j]=ae,t[++j]=ue,t[++j]=le,t[++j]=he,t[++j]=ce,t[++j]=pe},Gl=function(t){function e(e,n,i){var r=t.call(this,e,n,i,Ll,Nl)||this;return r.radius=0,r.corner=0,r}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices(),Ul(t.indices,this.vertexOffset,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexStepAndUv(e,t),this.updateColor(e,t)},e.prototype.updateVertexStepAndUv=function(t,e){var n=e.size,i=n.x,r=n.y,o=e.radius,s=i!==this.sizeX||r!==this.sizeY||o!==this.radius,a=$(e),u=this.transformLocalId!==a,l=e.stroke,h=l.align,c=l.enable?l.width:0,p=l.side,f=l.style,d=this.strokeAlign!==h||this.strokeWidth!==c||this.strokeSide!==p||this.strokeStyle!==f,y=e.corner,g=y!==this.corner,v=tt(e),_=et(v),m=v!==this.texture||_!==this.textureTransformId,b=s||d,T=!(this.inited&Y.VERTEX_STEP_AND_UV);if(T||b||u||g||m){this.inited|=Y.VERTEX_STEP_AND_UV,this.sizeX=i,this.sizeY=r,this.radius=o,this.transformLocalId=a,this.strokeAlign=h,this.strokeWidth=c,this.strokeSide=p,this.strokeStyle=f,this.corner=y,this.texture=v,this.textureTransformId=_;var w=this.vertexOffset;t.updateVertices(),jl(t.vertices,w,0,0,i,r,h,c,o,e.transform.internalTransform,Bl),(T||b||g||u)&&(t.updateSteps(),Fl(t.steps,w,c,p,f,y,Bl)),(T||b||m)&&(t.updateUvs(),Hl(t.uvs,w,nt(v),Bl))}},e}(Q),Vl=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=Ll+a,h=Nl+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new Gl(t,n,i),new de(t,n+Ll,i+Nl,a,u)]).init(e):null},Wl=function(t,e,n,i,r){return Vl(t,e,n,i)},Kl=function(t,e,n,i,r,o){var s=-n+r;if(t<=s)return e<=(a=-i+r)&&o&pt.TOP_LEFT?(l=t-s)*l+(h=e-a)*h<=r*r:(u=+i-r)<=e&&o&pt.BOTTOM_LEFT?(l=t-s)*l+(h=e-u)*h<=r*r:-n<=t;var a,u,l,h,c=+n-r;return c<=t?e<=(a=-i+r)&&o&pt.TOP_RIGHT?(l=t-c)*l+(h=e-a)*h<=r*r:(u=+i-r)<=e&&o&pt.BOTTOM_RIGHT?(l=t-c)*l+(h=e-u)*h<=r*r:t<=+n:-i<=e&&e<=+i},Xl=function(t,e,n,i,r,o,s){var a=t.fill;if(a.enable||0<o){var u=t.radius*Math.min(i,r),l=t.corner;if(Kl(e,n,i,r,u,l)){if(a.enable)return!0;var h=o*s,c=Math.max(0,i-h),p=Math.max(0,r-h),f=Math.max(0,u-h);if(!Kl(e,n,c,p,f,l)){var d=t.stroke.side;if(d===Z.ALL)return!0;if(e<=-c+f){var y=!!(d&Z.LEFT);return n<=-p+f?!(!(g=!!(d&Z.TOP))||!y)||(g?-c<=n:!!y&&e<=-c):+p-f<=n?!(!(v=!!(d&Z.BOTTOM))||!y)||(v?+c<=n:!!y&&e<=-c):y}if(+c-f<=e){var g,v,_=!!(d&Z.RIGHT);return n<=-p+f?!(!(g=!!(d&Z.TOP))||!_)||(g?-c<=n:!!_&&+c<=e):+p-f<=n?!(!(v=!!(d&Z.BOTTOM))||!_)||(v?+c<=n:!!_&&+c<=e):_}return n<=-p+f?!!(d&Z.TOP):+p-f<=n&&!!(d&Z.BOTTOM)}}}return!1},Yl=function(t){function e(e){return void 0===e&&(e=i.RECTANGLE_ROUNDED),t.call(this,e)||this}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(e,n,i,r,o,s,a){return!!t.prototype.containsAbsBBox.call(this,e,n,i,r)&&Xl(this,e,n,i,r,o,s)},e}(oe),ql=function(t){function e(e){void 0===e&&(e=i.BUTTON);var n=t.call(this,e)||this;return n._isToggle=!1,n._isGrouped=!1,n}return F(e,t),Object.defineProperty(e.prototype,"isToggle",{get:function(){return this._isToggle},set:function(t){this._isToggle=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isGrouped",{get:function(){return this._isGrouped},set:function(t){this._isGrouped=t},enumerable:!1,configurable:!0}),e.prototype.copy=function(n,i){return t.prototype.copy.call(this,n,i),n instanceof e&&(this._isToggle=n.isToggle,this._isGrouped=n.isGrouped),this},e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.serialize=function(e){var n=t.prototype.serialize.call(this,e),i=this._isToggle?1:0,r=this._isGrouped?2:0;return n[15]=e.addResource("[".concat(i|r,"]")),n},e}(Yl),Zl=function(t,e,n){n=n||new ql;var i=e.resources,r=t[15];if(0<=r&&r<i.length){var o=e.getExtension(r);null==o&&(o=JSON.parse(i[r]),e.setExtension(r,o)),n.isToggle=!!(1&o[0]),n.isGrouped=!!(2&o[0])}return Pl(t,e,n)},Jl=function(t){function e(e){var n=t.call(this,_e.COLOR_FILL_AND_STROKE|_e.COLOR_TEXT|_e.COLOR_TEXT_OUTLINE|_e.CURSOR)||this,i=e.fill,r=i.color,o=n.toOnHovered(r),s=2*o;n._fillColor=r,n._fillColorDisabled=ve.toGrayscale(r),n._fillColorPressed=ve.darken(r,s),n._fillColorHovered=ve.darken(r,o);var a=i.alpha;n._fillAlpha=a,n._fillAlphaDisabled=.5*a;var u=e.stroke,l=u.color,h=n.toOnHovered(l),c=2*h;n._strokeColor=l,n._strokeColorDisabled=ve.toGrayscale(l),n._strokeColorPressed=ve.darken(l,c),n._strokeColorHovered=ve.darken(l,h);var p=u.alpha;n._strokeAlpha=p,n._strokeAlphaDisabled=.5*p;var f=e.text,d=f.color;n._textColor=d,n._textColorDisabled=ve.toGrayscale(d);var y=f.alpha;n._textAlpha=y,n._textAlphaDisabled=.5*y;var g=f.outline,v=g.color;n._textOutlineColor=v,n._textOutlineColorDisabled=ve.toGrayscale(v);var _=g.alpha;return n._textOutlineAlpha=_,n._textOutlineAlphaDisabled=.5*_,n}return F(e,t),e.prototype.toOnHovered=function(t){var e,n=ve.toLuma(t);return 128<=n?.15*(1-(e=(n-128)/127))+.03*e:-.15*(1-(e=(127-n)/127))-.175*e},e.prototype.execute=function(t,e,n){var i=t.state;t.fill.set(void 0,this.getFillColor(i),this.getFillAlpha(i)),t.stroke.set(void 0,this.getStrokeColor(i),this.getStrokeAlpha(i)),t.text.set(void 0,this.getTextColor(i),this.getTextAlpha(i)),t.text.outline.set(void 0,this.getTextOutlineColor(i),this.getTextOutlineAlpha(i)),t.cursor=this.getCursor(i),e.written|=this.reset},e.prototype.getFillColor=function(t){return t.inDisabled?this._fillColorDisabled:t.isPressed||t.isActive?this._fillColorPressed:t.isFocused||t.isHovered?this._fillColorHovered:this._fillColor},e.prototype.getFillAlpha=function(t){return t.inDisabled?this._fillAlphaDisabled:this._fillAlpha},e.prototype.getStrokeColor=function(t){return t.inDisabled?this._strokeColorDisabled:t.isPressed||t.isActive?this._strokeColorPressed:t.isFocused||t.isHovered?this._strokeColorHovered:this._strokeColor},e.prototype.getStrokeAlpha=function(t){return t.inDisabled?this._strokeAlphaDisabled:this._strokeAlpha},e.prototype.getTextColor=function(t){return t.inDisabled?this._textColorDisabled:this._textColor},e.prototype.getTextAlpha=function(t){return t.inDisabled?this._textAlphaDisabled:this._textAlpha},e.prototype.getTextOutlineColor=function(t){return t.inDisabled?this._textOutlineColorDisabled:this._textOutlineColor},e.prototype.getTextOutlineAlpha=function(t){return t.inDisabled?this._textOutlineAlphaDisabled:this._textOutlineAlpha},e.prototype.getCursor=function(t){return t.isActionable?"pointer":""},e}(we),Ql=function(t){function e(e){var n=t.call(this,_e.COLOR_FILL_AND_STROKE|_e.COLOR_TEXT|_e.COLOR_TEXT_OUTLINE|_e.CURSOR)||this,i=e.fill,r=i.color;n._fillColorActive=r;var o=n.toOnHovered(r),s=2*o;n._fillColorActivePressed=ve.darken(r,s),n._fillColorActiveHovered=ve.darken(r,o);var a=15197671;n._fillColor=a;var u=n.toOnHovered(a),l=2*u;n._fillColorPressed=ve.darken(a,l),n._fillColorHovered=ve.darken(a,u);var h=i.alpha;n._fillAlpha=h,n._fillAlphaDisabled=.5*h;var c=e.stroke,p=c.color;n._strokeColorActive=p;var f=n.toOnHovered(p),d=2*f;n._strokeColorActivePressed=ve.darken(p,d),n._strokeColorActiveHovered=ve.darken(p,f);var y=15197671;n._strokeColor=y;var g=n.toOnHovered(y),v=2*g;n._strokeColorPressed=ve.darken(y,v),n._strokeColorGrayscaleHovered=ve.darken(y,g);var _=c.alpha;n._strokeAlpha=_,n._strokeAlphaDisabled=.5*_;var m=e.text,b=m.color;n._textColorActive=b,n._textColorDisabled=ve.toGrayscale(b),n._textColor=5197647;var T=m.alpha;n._textAlpha=T,n._textAlphaDisabled=.5*T;var w=m.outline,E=w.color;n._textOutlineColor=E,n._textOutlineColorDisabled=ve.toGrayscale(E);var O=w.alpha;return n._textOutlineAlpha=O,n._textOutlineAlphaDisabled=.5*O,n}return F(e,t),e.prototype.toOnHovered=function(t){var e,n=ve.toLuma(t);return 128<=n?.15*(1-(e=(n-128)/127))+.03*e:-.15*(1-(e=(127-n)/127))-.175*e},e.prototype.execute=function(t,e,n){var i=t.state;t.fill.set(void 0,this.getFillColor(i),this.getFillAlpha(i)),t.stroke.set(void 0,this.getStrokeColor(i),this.getStrokeAlpha(i)),t.text.set(void 0,this.getTextColor(i),this.getTextAlpha(i)),t.text.outline.set(void 0,this.getTextOutlineColor(i),this.getTextOutlineAlpha(i)),t.cursor=this.getCursor(i),e.written|=this.reset},e.prototype.getFillColor=function(t){return t.inDisabled?this._fillColor:t.isActive?t.isPressed?this._fillColorActivePressed:t.isFocused||t.isHovered?this._fillColorActiveHovered:this._fillColorActive:t.isPressed?this._fillColorPressed:t.isFocused||t.isHovered?this._fillColorHovered:this._fillColor},e.prototype.getFillAlpha=function(t){return t.inDisabled?this._fillAlphaDisabled:this._fillAlpha},e.prototype.getStrokeColor=function(t){return t.inDisabled?this._strokeColor:t.isActive?t.isPressed?this._strokeColorActivePressed:t.isFocused||t.isHovered?this._strokeColorActiveHovered:this._strokeColorActive:t.isPressed?this._strokeColorPressed:t.isFocused||t.isHovered?this._strokeColorGrayscaleHovered:this._strokeColor},e.prototype.getStrokeAlpha=function(t){return t.inDisabled?this._strokeAlphaDisabled:this._strokeAlpha},e.prototype.getTextColor=function(t){return t.inDisabled?this._textColorDisabled:t.isActive?this._textColorActive:this._textColor},e.prototype.getTextAlpha=function(t){return t.inDisabled?this._textAlphaDisabled:this._textAlpha},e.prototype.getTextOutlineColor=function(t){return t.inDisabled?this._textOutlineColorDisabled:this._textOutlineColor},e.prototype.getTextOutlineAlpha=function(t){return t.inDisabled?this._textOutlineAlphaDisabled:this._textOutlineAlpha},e.prototype.getCursor=function(t){return t.isActionable?"pointer":""},e}(we),$l=function(t){function e(e){var n=t.call(this,e)||this;return e instanceof ql&&(n._isToggle=e.isToggle,n._isGrouped=e.isGrouped),n}return F(e,t),e.prototype.isActionable=function(){return!0},e.prototype.initialize=function(e){this.actions.unshift(this._isToggle?new Ql(this):new Jl(this)),t.prototype.initialize.call(this,e)},e.prototype.onClick=function(e,n){var i=e.state,r=i.isClicked;i.lock(),t.prototype.onClick.call(this,e,n),!r&&i.isClicked&&(this._isToggle?i.isActive=!i.isActive:i.isActive||(i.isActivated=!0)),i.unlock()},e.prototype.onStateChange=function(e,n,i){t.prototype.onStateChange.call(this,e,n,i),this._isToggle&&this._isGrouped&&n.is(At.ACTIVATED)&&this.onActivated(e)},e.prototype.onActivated=function(t){var e=t.parent;if(null!=e)for(var n=e.children,i=0,r=n.length;i<r;++i){var o=n[i];o!==t&&o instanceof ql&&o.isToggle&&o.isGrouped&&(o.state.isActive=!1)}},e}(Do),th=function(){r[i.BUTTON]=Wl,e[i.BUTTON]=Zl,ko[i.BUTTON]=$l,Xn.set(i.BUTTON,Lt.PRIMITIVE|Lt.STROKE_SIDE|Lt.BORDER_RADIUS)},eh=[0,0],nh=new t.Point,ih=function(t,e,n){var i=3*n-1;t[++i]=e,t[++i]=e+1,t[++i]=e+3,t[++i]=e+1,t[++i]=e+4,t[++i]=e+3,t[++i]=e+1,t[++i]=e+2,t[++i]=e+4,t[++i]=e+2,t[++i]=e+5,t[++i]=e+4,t[++i]=e+3,t[++i]=e+4,t[++i]=e+6,t[++i]=e+4,t[++i]=e+7,t[++i]=e+6,t[++i]=e+4,t[++i]=e+5,t[++i]=e+7,t[++i]=e+5,t[++i]=e+8,t[++i]=e+7},rh=function(t,e,n,i,r,o,s,a,u,l){var h=nh,c=s*a,p=.5*r+(0<=r?+c:-c),f=.5*o+(0<=o?+c:-c);h.set(-p+n,-f+i),u.apply(h,h);var d=h.x,y=h.y;h.set(0+n,-f+i),u.apply(h,h);var g=h.x,v=h.y,_=g-d,m=v-y;h.set(n,i),u.apply(h,h);var b=h.x,T=h.y,w=b+(b-g),E=T+(T-v),C=b-_,S=T-m,x=2*e-1;t[++x]=d,t[++x]=y,t[++x]=g,t[++x]=v,t[++x]=g+_,t[++x]=v+m,t[++x]=C,t[++x]=S,t[++x]=b,t[++x]=T,t[++x]=b+_,t[++x]=T+m,t[++x]=w-_,t[++x]=E-m,t[++x]=w,t[++x]=E,t[++x]=w+_,t[++x]=E+m,l[0]=O(d,y,g,v),l[1]=O(d,y,C,S)},oh=function(t,e,n,i,r){var o=u(i),s=r[0],a=r[1],l=p(1,o,1,1),h=f(1,1),c=f(0,1),d=f(1,0),y=f(0,0),g=6*e-1;t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=h,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=c,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=h,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=d,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=y,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=d,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=h,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=c,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=h,t[++g]=0},sh=function(t,e,n){var i=n.x0,r=n.x1,o=n.x2,s=n.x3,a=n.y0,u=n.y1,l=n.y2,h=n.y3,c=2*e-1;t[++c]=i,t[++c]=a,t[++c]=.5*(i+r),t[++c]=.5*(a+u),t[++c]=r,t[++c]=u,t[++c]=.5*(i+s),t[++c]=.5*(a+h),t[++c]=.5*(i+o),t[++c]=.5*(a+l),t[++c]=.5*(r+o),t[++c]=.5*(u+l),t[++c]=s,t[++c]=h,t[++c]=.5*(s+o),t[++c]=.5*(h+l),t[++c]=o,t[++c]=l},ah=function(t){function e(e,n,i){return t.call(this,e,n,i,9,8)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=this.vertexOffset;ih(t.indices,e,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexAndStep(e,t),this.updateColor(e,t),this.updateUv(e,t)},e.prototype.updateVertexAndStep=function(t,e){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=$(e),a=this.transformLocalId!==s,u=e.stroke,l=u.align,h=u.enable?u.width:0,c=u.style,p=this.strokeAlign!==l||this.strokeWidth!==h||this.strokeStyle!==c;(!(this.inited&Y.VERTEX_AND_STEP)||o||a||p)&&(this.inited|=Y.VERTEX_AND_STEP,this.sizeX=i,this.sizeY=r,this.transformLocalId=s,this.strokeAlign=l,this.strokeWidth=h,this.strokeStyle=c,t.updateVertices(),t.updateSteps(),rh(t.vertices,this.vertexOffset,0,0,i,r,l,h,e.transform.internalTransform,eh),oh(t.steps,this.vertexOffset,h,c,eh))},e.prototype.updateUv=function(t,e){var n=tt(e),i=et(n);if(!(this.inited&Y.UV)||n!==this.texture||i!==this.textureTransformId){this.inited|=Y.UV,this.texture=n,this.textureTransformId=i,t.updateUvs();var r=nt(n);sh(t.uvs,this.vertexOffset,r)}},e}(Q),uh=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=9+a,h=8+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new ah(t,n,i),new de(t,n+9,i+8,a,u)]).init(e):null},lh=function(t,e,n){return Pl(t,e,n||new Wn)},hh=function(){r[i.CIRCLE]=uh,e[i.CIRCLE]=lh},ch=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},ph=[0,1],fh=[0,1],dh=function(t){return t?t.formatted.plength:0},yh=function(t){var e=dh(t);return(e>>4)+(0<(15&e)?1:0)<<4},gh=function(t,e){return e?2+(t<<2):t<<2},vh=function(t,e){return gh(t,e)-2},_h=function(t,e,n,i){for(var r=3*n-1,o=3*(n+i)-1,s=e;r<o;)t[++r]=s+0,t[++r]=s+2,t[++r]=s+1,t[++r]=s+1,t[++r]=s+2,t[++r]=s+3,s+=2},mh=function(t,e,n,i,r,o){for(var s=1/Math.max(1e-5,o),a=r.x0,u=r.x1,l=r.x2,h=r.x3,c=r.y0,p=r.y1,f=r.y2,d=r.y3,y=u-a,g=p-c,v=l-h,_=f-d,m=(n<<1)-1,b=(n+i<<1)-1,T=6*n-9;m<b;){var w=e[T+=12]*s;t[++m]=a+w*y,t[++m]=c+w*g,t[++m]=h+w*v,t[++m]=d+w*_}},bh=function(t,e,n,i,r,o,s,a,u,l,h){var c=K;null==c&&(K=c=[]);for(var p=h.a,f=h.b,d=h.c,y=h.d,g=h.tx,v=h.ty,_=0;_<r;++_){var m=_<<1,b=s[m],T=s[m+1];c[m]=p*b+d*T+g,c[m+1]=f*b+y*T+v}return wh(t,e,n,i,r,o,c,a,u,l)},Th=function(t,e,n,i,r,o,s,a,u,l,h,p,f,d){var y=c(a,u),g=Math.min(l,h);e[++t]=r,e[++t]=o,i[++n]=s,i[++n]=f,i[++n]=y,i[++n]=p,i[++n]=p,i[++n]=g,e[++t]=r,e[++t]=o,i[++n]=s,i[++n]=d,i[++n]=y,i[++n]=p,i[++n]=p,i[++n]=g},wh=function(t,e,n,i,r,o,s,a,u,l){var h=a.length;if(0<h){if(o){for(var c=0,p=0,f=n,d=0,y=a[0],g=1;g<h;++g)2<=(d=a[g])-y&&(p=Oh(t,e,f,-1,s,y,d,r,u,l,p),c=Math.max(c,p),f+=gh(d-y,!1)),y=d;return 2<=(d=a[0]+r)-y?(p=Oh(t,e,f,n+i-f,s,y,d,r,u,l,p),c=Math.max(c,p),f+=gh(d-y,!1)):Eh(t,e,f,n+i-f,s,y,d,r,u,l,p),c}for(c=0,p=0,f=n,2<=(d=a[0])&&(p=Oh(t,e,f,-1,s,0,d,r,u,l,p),c=Math.max(c,p),f+=gh(d,!1)),y=d,g=1;g<h;++g)2<=(d=a[g])-y&&(p=Oh(t,e,f,-1,s,y,d,r,u,l,p),c=Math.max(c,p),f+=gh(d-y,!1)),y=d;return 2<=(d=r)-y?(p=Oh(t,e,f,n+i-f,s,y,d,r,u,l,p),c=Math.max(c,p),f+=gh(d-y,!1)):Eh(t,e,f,n+i-f,s,y,d,r,u,l,p),c}return o?Ch(t,e,n,i,s,0,r,r,u,l):Oh(t,e,n,i,s,0,r,r,u,l,0)},Eh=function(t,e,n,i,r,o,s,l,h,c,f){if(0<=i)for(var d=u(c),y=a(c),g=p(3,d,y,0),v=p(5,d,y,0),_=(n<<1)-1,m=6*n-1,b=(n+i<<1)-1,T=o%l<<1,w=r[T],E=r[T+1];_<b;)t[++_]=w,t[++_]=E,e[++m]=0,e[++m]=g,e[++m]=0,e[++m]=f,e[++m]=f,e[++m]=0,t[++_]=w,t[++_]=E,e[++m]=0,e[++m]=v,e[++m]=0,e[++m]=f,e[++m]=f,e[++m]=0;return 0},Oh=function(t,e,n,i,r,o,s,f,d,y,g){var v=u(y),_=a(y),m=p(3,v,_,0),b=p(4,v,_,0),T=p(5,v,_,0),w=p(6,v,_,0),E=o%f<<1,O=r[E],C=r[E+1],S=(o+1)%f<<1,x=r[S],D=r[S+1],I=O-(x-O),A=C-(D-C),R=ph,P=fh;l(I,A,O,C,R),l(O,C,x,D,P);var M=ch(R),k=M;h(R,M),h(P,k);var L=(n<<1)-1,N=6*n-1,B=0;Th(L,t,N,e,O,C,d,R,P,M,k,g,m,T),Th(L+=4,t,N+=12,e,O,C,d,R,P,M,k,B,b,w),L+=4,N+=12;for(var z=o+1,U=s-1;z<U;++z){I=O,A=C,O=x,C=D,R[0]=P[0],R[1]=P[1],M=k;var j=(z+1)%f<<1;x=r[j],D=r[j+1],l(O,C,x,D,P),k=ch(P),h(P,k),Th(L,t,N,e,O,C,d,R,P,M,k,B+=M,m,T),Th(L+=4,t,N+=12,e,O,C,d,R,P,M,k,B,b,w),L+=4,N+=12}I=O,A=C,O=x,C=D,R[0]=P[0],R[1]=P[1],M=k,l(O,C,x=O+(O-I),D=C+(C-A),P),h(P,k),Th(L,t,N,e,O,C,d,R,P,M,k,B+=M,m,T),Th(L+=4,t,N+=12,e,O,C,d,R,P,M,k,B,b,w),L+=4,N+=12;var F=6*n-1;for(z=F,U=F+12;z<U;z+=6)e[z+5]=g;for(z=F+12;z<N;z+=6)e[z+5]=B;if(0<=i)for(var H=c(R,P),G=(n+i<<1)-1;L<G;)t[++L]=O,t[++L]=C,e[++N]=0,e[++N]=m,e[++N]=H,e[++N]=B,e[++N]=B,e[++N]=0,t[++L]=O,t[++L]=C,e[++N]=0,e[++N]=T,e[++N]=H,e[++N]=B,e[++N]=B,e[++N]=0;return B},Ch=function(t,e,n,i,r,o,s,f,d,y){var g=u(y),v=a(y),_=p(3,g,v,0),m=p(4,g,v,0),b=p(5,g,v,0),T=p(6,g,v,0),w=(s-1)%f<<1,E=0,O=0,C=r[w],S=r[w+1],x=o%f<<1,D=r[x],I=r[x+1],A=ph,R=fh;l(E,O,C,S,A),l(C,S,D,I,R);var P=ch(A),M=ch(R);h(A,P),h(R,M);for(var k=0,L=(n<<1)-1,N=6*n-1,B=o;B<s;++B){E=C,O=S,C=D,S=I,A[0]=R[0],A[1]=R[1],P=M;var z=(B+1)%f<<1;D=r[z],I=r[z+1],l(C,S,D,I,R),M=ch(R),h(R,M),Th(L,t,N,e,C,S,d,A,R,P,M,k+=P,_,b),Th(L+=4,t,N+=12,e,C,S,d,A,R,P,M,k,m,T),L+=4,N+=12}E=C,O=S,C=D,S=I,A[0]=R[0],A[1]=R[1],P=M;var U=(o+1)%f<<1;for(D=r[U],I=r[U+1],l(C,S,D,I,R),M=ch(R),h(R,M),Th(L,t,N,e,C,S,d,A,R,P,M,k+=P,_,b),L+=4,N+=12,B=6*n-1;B<N;B+=6)e[B+5]=-k;if(0<=i)for(var j=c(A,R),F=(n+i<<1)-1;L<F;)t[++L]=C,t[++L]=S,e[++N]=d,e[++N]=_,e[++N]=j,e[++N]=k,e[++N]=-k,e[++N]=0,t[++L]=C,t[++L]=S,e[++N]=d,e[++N]=b,e[++N]=j,e[++N]=k,e[++N]=-k,e[++N]=0;return k},Sh=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n,i,r,o)||this;return s.pointId=-1,s.pointCount=0,s.pointsClosed=!1,s.length=1,s}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices(),_h(t.indices,this.vertexOffset,this.indexOffset,this.indexCount),this.inited|=Y.INDEX},e.prototype.reinit=function(t,e,n,i){var r=yh(e.points),o=gh(r,!0),s=vh(r,!0);return this.buffer===t&&this.vertexOffset===n&&this.indexOffset===i&&this.vertexCount===o&&this.indexCount===s||!!t.check(n,i,o,s)&&(this.inited=Y.NONE,this.buffer=t,this.vertexOffset=n,this.indexOffset=i,this.vertexCount=o,this.indexCount=s,this.init(),!0)},e.prototype.isCompatible=function(t){return gh(yh(t.points),!0)===this.vertexCount},e.prototype.update=function(t){var e=this.buffer;this.updateLineVertexStep(e,t),this.updateColor(e,t),this.updateLineUv(e,t)},e.prototype.updateLineVertexStep=function(t,e){var n=e.points;if(n){var i=n.id,r=n.formatted,o=r.length,s=!!(r.style&X.CLOSED),a=i!==this.pointId||o!==this.pointCount||s!==this.pointsClosed,u=e.stroke,l=u.enable?u.width:0,h=u.style,c=this.strokeWidth!==l||this.strokeStyle!==h,p=$(e),f=this.transformLocalId!==p;(!(this.inited&Y.VERTEX_AND_STEP)||a||f||c)&&(this.inited|=Y.VERTEX_AND_STEP,this.pointId=i,this.pointCount=o,this.pointsClosed=s,this.strokeWidth=l,this.strokeStyle=h,this.transformLocalId=p,a&&(this.inited&=~Y.UV),t.updateVertices(),t.updateSteps(),this.length=bh(t.vertices,t.steps,this.vertexOffset,this.vertexCount,this.pointCount,this.pointsClosed,r.values,r.segments,l,h,e.transform.internalTransform))}},e.prototype.updateLineUv=function(t,e){var n=tt(e),i=et(n);(!(this.inited&Y.UV)||n!==this.texture||i!==this.textureTransformId)&&(this.inited|=Y.UV,this.texture=n,this.textureTransformId=i,t.updateUvs(),mh(t.uvs,t.steps,this.vertexOffset,this.vertexCount,nt(n),this.length))},e}(Q),xh=[0,0,0],Dh=new t.Point,Ih=function(t,e,n){var i=3*n-1;t[++i]=e+0,t[++i]=e+1,t[++i]=e+2,t[++i]=e+0,t[++i]=e+3,t[++i]=e+4,t[++i]=e+0,t[++i]=e+5,t[++i]=e+6},Ah=function(t,e,n,i,r,o,s,a,u,l){var h=s*a,c=.5*r+(0<=r?+h:-h),p=.5*o+(0<=o?+h:-h),f=2*c*p/(c+Math.sqrt(c*c+4*p*p)),d=Dh;d.set(n,i-p),u.apply(d,d);var y=d.x,g=d.y;d.set(n,i),u.apply(d,d);var v=d.x,_=d.y;d.set(n+c,i),u.apply(d,d);var m=v-y,b=_-g,T=d.x+m,w=d.y+b,E=v+(v-d.x)+m,C=_+(_-d.y)+b;d.set(n,i+p-f),u.apply(d,d);var S=d.x,x=d.y,D=v+m,I=_+b;l[0]=O(D,I,S,x),l[1]=O(T,w,D,I),l[2]=O(y,g,v,_);var A=(e<<1)-1;t[++A]=S,t[++A]=x,t[++A]=y,t[++A]=g,t[++A]=T,t[++A]=w,t[++A]=T,t[++A]=w,t[++A]=E,t[++A]=C,t[++A]=E,t[++A]=C,t[++A]=y,t[++A]=g},Rh=function(t,e,n,i,r){var o=u(i),s=r[0],a=p(0,o,1,1),l=f(0,0),h=f(1,0),c=f(0,1),d=6*e-1;t[++d]=n,t[++d]=a,t[++d]=s,t[++d]=s,t[++d]=l,t[++d]=0,t[++d]=n,t[++d]=a,t[++d]=s,t[++d]=s,t[++d]=h,t[++d]=0,t[++d]=n,t[++d]=a,t[++d]=s,t[++d]=s,t[++d]=h,t[++d]=0,t[++d]=n,t[++d]=a,t[++d]=s,t[++d]=s,t[++d]=c,t[++d]=0,t[++d]=n,t[++d]=a,t[++d]=s,t[++d]=s,t[++d]=c,t[++d]=0,t[++d]=n,t[++d]=a,t[++d]=s,t[++d]=s,t[++d]=h,t[++d]=0,t[++d]=n,t[++d]=a,t[++d]=s,t[++d]=s,t[++d]=h,t[++d]=0},Ph=function(t,e,n,i){var r=e.x0,o=e.x1,s=e.x2,a=e.x3,u=e.y0,l=e.y1,h=e.y2,c=e.y3,p=.5*(r+o),f=.5*(u+l),d=1-.5*i[0]/i[2],y=p+d*(a-r),g=f+d*(c-u),v=(n<<1)-1;t[++v]=y,t[++v]=g,t[++v]=p,t[++v]=f,t[++v]=s,t[++v]=h,t[++v]=s,t[++v]=h,t[++v]=a,t[++v]=c,t[++v]=a,t[++v]=c,t[++v]=p,t[++v]=f},Mh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.updateColor=function(t,e){var n=16777215,i=1,r=e.points;if(null!=r){var o=r.getMarker();if(null!=o){var s=this.toMarker(o).fill;n=s.color,i=e.visible&&s.enable?s.alpha:0}}var a=e.stroke,u=a.color,l=e.visible&&a.enable&&0<a.width?a.alpha:0;(!(this.inited&Y.COLOR)||n!==this.colorFill||i!==this.alphaFill||u!==this.colorStroke||l!==this.alphaStroke)&&(this.inited|=Y.COLOR,this.colorFill=n,this.alphaFill=i,this.colorStroke=u,this.alphaStroke=l,t.updateColors(),q(n,i,u,l,this.vertexOffset,this.vertexCount,t.colors))},e}(Q),kh=function(e){function n(t,n,i){var r=e.call(this,t,n,i,7,3)||this;return r.pointId=-1,r}return F(n,e),n.prototype.init=function(){var t=this.buffer;t.updateIndices(),Ih(t.indices,this.vertexOffset,this.indexOffset),this.inited|=Y.INDEX},n.prototype.update=function(t){var e=this.buffer;this.updateVertexStepAndUv(e,t),this.updateColor(e,t)},n.prototype.updateVertexStepAndUv=function(e,i){var r,o=i.points;if(null!=o){var s=o.getMarker();if(null!=s){var a=this.toMarker(s),u=a.size,l=u.x,h=u.y,c=l!==this.sizeX||h!==this.sizeY,p=$(i),f=this.transformLocalId!==p,d=i.stroke,y=d.align,g=d.enable?d.width:0,v=d.style,_=this.strokeAlign!==y||this.strokeWidth!==g||this.strokeStyle!==v,m=tt(i),b=et(m),T=m!==this.texture||b!==this.textureTransformId,w=c||_,E=o.id,O=E!==this.pointId,C=!(this.inited&Y.VERTEX_STEP_AND_UV);if(C||w||f||T||O){this.inited|=Y.VERTEX_STEP_AND_UV,this.sizeX=l,this.sizeY=h,this.transformLocalId=p,this.strokeAlign=y,this.strokeWidth=g,this.strokeStyle=v,this.texture=m,this.textureTransformId=b,this.pointId=E;var S=this.vertexOffset,x=null!==(r=n.WORK)&&void 0!==r?r:n.WORK=new t.Matrix;x.copyFrom(a.transform).prepend(i.transform.internalTransform),e.updateVertices(),Ah(e.vertices,S,0,0,l,h,y,g,x,xh),(C||w||f)&&(e.updateSteps(),Rh(e.steps,S,g,v,xh)),(C||w||T)&&(e.updateUvs(),Ph(e.uvs,nt(m),S,xh))}}}},n}(Mh),Lh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMarker=function(t){return t.head},e}(kh),Nh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMarker=function(t){return t.tail},e}(kh),Bh=function(e){function n(t,n,i){var r=e.call(this,t,n,i,9,8)||this;return r.pointId=-1,r}return F(n,e),n.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=this.vertexOffset;ih(t.indices,e,this.indexOffset),this.inited|=Y.INDEX},n.prototype.update=function(t){var e=this.buffer;this.updateVertexAndStep(e,t),this.updateColor(e,t),this.updateUv(e,t)},n.prototype.updateVertexAndStep=function(e,i){var r,o=i.points;if(null!=o){var s=o.getMarker();if(null!=s){var a=this.toMarker(s),u=a.size,l=u.x,h=u.y,c=l!==this.sizeX||h!==this.sizeY,p=$(i),f=this.transformLocalId!==p,d=i.stroke,y=d.align,g=d.enable?d.width:0,v=d.style,_=this.strokeAlign!==y||this.strokeWidth!==g||this.strokeStyle!==v,m=o.id,b=m!==this.pointId;if(!(this.inited&Y.VERTEX_AND_STEP)||c||f||_||b){this.inited|=Y.VERTEX_AND_STEP,this.sizeX=l,this.sizeY=h,this.transformLocalId=p,this.strokeAlign=y,this.strokeWidth=g,this.strokeStyle=v,this.pointId=m;var T=null!==(r=n.WORK)&&void 0!==r?r:n.WORK=new t.Matrix;T.copyFrom(a.transform).prepend(i.transform.internalTransform),e.updateVertices(),e.updateSteps(),rh(e.vertices,this.vertexOffset,0,0,l,h,y,g,T,eh),oh(e.steps,this.vertexOffset,g,v,eh)}}}},n.prototype.updateUv=function(t,e){var n=tt(e),i=et(n);if(!(this.inited&Y.UV)||n!==this.texture||i!==this.textureTransformId){this.inited|=Y.UV,this.texture=n,this.textureTransformId=i,t.updateUvs();var r=nt(n);sh(t.uvs,this.vertexOffset,r)}},n}(Mh),zh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMarker=function(t){return t.head},e}(Bh),Uh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMarker=function(t){return t.tail},e}(Bh),jh=function(){function e(t,e,n){this.buffer=t,this.vertexOffset=e,this.indexOffset=n,this.vertexCount=0,this.indexCount=0,this.texture=null}return e.prototype.init=function(){return this},e.prototype.reinit=function(t,e,n,i){return this.buffer=t,this.vertexOffset=n,this.indexOffset=i,!0},e.prototype.isCompatible=function(t){return!0},e.prototype.update=function(t){this.texture=tt(t)},e.prototype.buildUnit=function(e){var n=this.texture||t.Texture.WHITE,i=n.baseTexture;if(i!==e.baseTexture){e.baseTexture=i;var r=this.indexOffset;e.push(n,r)}},e}(),Fh=16,Hh=[0,0],Gh=new t.Point,Vh=function(t,e,n){var i=3*n-1;t[++i]=e+0,t[++i]=e+1,t[++i]=e+2,t[++i]=e+2,t[++i]=e+1,t[++i]=e+3,t[++i]=e+4,t[++i]=e+5,t[++i]=e+6,t[++i]=e+6,t[++i]=e+5,t[++i]=e+7,t[++i]=e+8,t[++i]=e+9,t[++i]=e+10,t[++i]=e+10,t[++i]=e+9,t[++i]=e+11,t[++i]=e+12,t[++i]=e+13,t[++i]=e+14,t[++i]=e+14,t[++i]=e+13,t[++i]=e+15},Wh=function(t,e,n,i,r,o,s,a,u,l){var h=s*a,c=.5*r+(0<=r?+h:-h),p=.5*o+(0<=o?+h:-h),f=Gh;f.set(n-c,i-p),u.apply(f,f);var d=f.x,y=f.y;f.set(n,i-p),u.apply(f,f);var g=f.x,v=f.y;f.set(n-c,i),u.apply(f,f);var _=f.x,m=f.y,b=g-d,T=v-y,w=_-d,E=m-y,C=g+b,S=v+T,x=_+b,D=m+T,I=C+w,A=S+E,R=_+w,P=m+E,M=R+b,k=P+T,L=M+b,N=k+T,B=(e<<1)-1;t[++B]=d,t[++B]=y,t[++B]=g,t[++B]=v,t[++B]=_,t[++B]=m,t[++B]=x,t[++B]=D,t[++B]=g,t[++B]=v,t[++B]=C,t[++B]=S,t[++B]=x,t[++B]=D,t[++B]=I,t[++B]=A,t[++B]=_,t[++B]=m,t[++B]=x,t[++B]=D,t[++B]=R,t[++B]=P,t[++B]=M,t[++B]=k,t[++B]=x,t[++B]=D,t[++B]=I,t[++B]=A,t[++B]=M,t[++B]=k,t[++B]=L,t[++B]=N,l[0]=O(d,y,g,v),l[1]=O(d,y,_,m)},Kh=function(t,e,n,i,r,o){var s=u(r),a=o[0],l=o[1],h=i&Z.TOP?1:0,c=i&Z.RIGHT?1:0,d=i&Z.BOTTOM?1:0,y=i&Z.LEFT?1:0,g=p(0,s,y,h),v=p(0,s,c,h),_=p(0,s,y,d),m=p(0,s,c,d),b=f(1,1),T=f(0,1),w=f(0,0),E=f(1,0),O=6*t-1;e[++O]=n,e[++O]=g,e[++O]=a,e[++O]=l,e[++O]=b,e[++O]=0,e[++O]=n,e[++O]=g,e[++O]=a,e[++O]=l,e[++O]=T,e[++O]=0,e[++O]=n,e[++O]=g,e[++O]=a,e[++O]=l,e[++O]=E,e[++O]=0,e[++O]=n,e[++O]=g,e[++O]=a,e[++O]=l,e[++O]=w,e[++O]=0,e[++O]=n,e[++O]=v,e[++O]=a,e[++O]=l,e[++O]=T,e[++O]=0,e[++O]=n,e[++O]=v,e[++O]=a,e[++O]=l,e[++O]=b,e[++O]=0,e[++O]=n,e[++O]=v,e[++O]=a,e[++O]=l,e[++O]=w,e[++O]=0,e[++O]=n,e[++O]=v,e[++O]=a,e[++O]=l,e[++O]=E,e[++O]=0,e[++O]=n,e[++O]=_,e[++O]=a,e[++O]=l,e[++O]=E,e[++O]=0,e[++O]=n,e[++O]=_,e[++O]=a,e[++O]=l,e[++O]=w,e[++O]=0,e[++O]=n,e[++O]=_,e[++O]=a,e[++O]=l,e[++O]=b,e[++O]=0,e[++O]=n,e[++O]=_,e[++O]=a,e[++O]=l,e[++O]=T,e[++O]=0,e[++O]=n,e[++O]=m,e[++O]=a,e[++O]=l,e[++O]=w,e[++O]=0,e[++O]=n,e[++O]=m,e[++O]=a,e[++O]=l,e[++O]=E,e[++O]=0,e[++O]=n,e[++O]=m,e[++O]=a,e[++O]=l,e[++O]=T,e[++O]=0,e[++O]=n,e[++O]=m,e[++O]=a,e[++O]=l,e[++O]=b,e[++O]=0},Xh=function(t,e,n){var i=n.x0,r=n.y0,o=n.x1,s=n.y1,a=n.x2,u=n.y2,l=n.x3,h=n.y3,c=.5*(i+o),p=.5*(r+s),f=.5*(i+l),d=.5*(r+h),y=c-i,g=p-r,v=f+y,_=d+g,m=o+(f-i),b=s+(d-r),T=l+y,w=h+g,E=(e<<1)-1;t[++E]=i,t[++E]=r,t[++E]=c,t[++E]=p,t[++E]=f,t[++E]=d,t[++E]=v,t[++E]=_,t[++E]=c,t[++E]=p,t[++E]=o,t[++E]=s,t[++E]=v,t[++E]=_,t[++E]=m,t[++E]=b,t[++E]=f,t[++E]=d,t[++E]=v,t[++E]=_,t[++E]=l,t[++E]=h,t[++E]=T,t[++E]=w,t[++E]=v,t[++E]=_,t[++E]=m,t[++E]=b,t[++E]=T,t[++E]=w,t[++E]=a,t[++E]=u},Yh=function(e){function n(t,n,i){var r=e.call(this,t,n,i,Fh,8)||this;return r.pointId=-1,r}return F(n,e),n.prototype.init=function(){var t=this.buffer;t.updateIndices(),Vh(t.indices,this.vertexOffset,this.indexOffset),this.inited|=Y.INDEX},n.prototype.update=function(t){var e=this.buffer;this.updateVertexStepAndUv(e,t),this.updateColor(e,t)},n.prototype.updateVertexStepAndUv=function(e,i){var r,o=i.points;if(null!=o){var s=o.getMarker();if(null!=s){var a=this.toMarker(s),u=a.size,l=u.x,h=u.y,c=l!==this.sizeX||h!==this.sizeY,p=$(i),f=this.transformLocalId!==p,d=i.stroke,y=d.align,g=d.enable?d.width:0,v=d.side,_=d.style,m=this.strokeAlign!==y||this.strokeWidth!==g||this.strokeSide!==v||this.strokeStyle!==_,b=tt(i),T=et(b),w=b!==this.texture||T!==this.textureTransformId,E=c||m,O=o.id!==this.pointId,C=!(this.inited&Y.VERTEX_STEP_AND_UV);if(C||E||f||w||O){this.inited|=Y.VERTEX_STEP_AND_UV,this.sizeX=l,this.sizeY=h,this.transformLocalId=p,this.strokeAlign=y,this.strokeWidth=g,this.strokeSide=v,this.strokeStyle=_,this.texture=b,this.textureTransformId=T;var S=this.vertexOffset,x=null!==(r=n.WORK)&&void 0!==r?r:n.WORK=new t.Matrix;x.copyFrom(a.transform).prepend(i.transform.internalTransform),e.updateVertices(),Wh(e.vertices,S,0,0,l,h,y,g,x,Hh),(C||E||f)&&(e.updateSteps(),Kh(S,e.steps,g,v,_,Hh)),(C||E||w)&&(e.updateUvs(),Xh(e.uvs,S,nt(b)))}}}},n}(Mh),qh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMarker=function(t){return t.tail},e}(Yh),Zh=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMarker=function(t){return t.head},e}(Yh),Jh=function(t){switch(t){case ot.NONE:return 0;case ot.CIRCLE:return 9;case ot.TRIANGLE:return 7;case ot.RECTANGLE:return Fh}return 0},Qh=function(t){switch(t){case ot.NONE:return 0;case ot.CIRCLE:return 8;case ot.TRIANGLE:return 3;case ot.RECTANGLE:return 8}return 0},$h=function(t,e,n,i){switch(t){case ot.NONE:return new jh(e,n,i);case ot.CIRCLE:return new zh(e,n,i);case ot.TRIANGLE:return new Lh(e,n,i);case ot.RECTANGLE:return new Zh(e,n,i)}return new jh(e,n,i)},tc=function(t,e,n,i){switch(t){case ot.NONE:return new jh(e,n,i);case ot.CIRCLE:return new Uh(e,n,i);case ot.TRIANGLE:return new Nh(e,n,i);case ot.RECTANGLE:return new qh(e,n,i)}return new jh(e,n,i)},ec=function(t,e,n,i,r){var s=e.points,a=yh(s),u=gh(a,!0),l=vh(a,!0),h=ot.NONE,c=ot.NONE;if(s&&s instanceof Li){var p=s.getMarker();p&&(h=p.tail.type,c=p.head.type)}var f=Jh(h),d=Qh(h),y=n+u,g=i+l,v=Jh(c),_=Qh(c),m=y+f,b=g+d,T=D(e),w=T<<2,E=T<<1,O=m+v,C=b+_,S=u+v+f+w,x=l+_+d+E;return t.check(n,i,S,x)?new o(t,n,i,S,x,[new Sh(t,n,i,u,l),tc(h,t,y,g),$h(c,t,m,b),new de(t,O,C,w,E)]).init(e):null},nc=function(){function t(t,e,n){this._threshold=1e-6,this._x=t,this._y=e,this._z=0,this._values=n,n[0]=t,n[1]=e,this.index=0}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){if(0===this._z||this._threshold<Math.abs(this._x-t)){this._x=t;var e=this.index,n=this._values;1===this._z?(n[e+0]=this._x,n[e+1]=this._y):(n[e+2]=this._x,n[e+3]=this._y,this.index+=2,this._z=1)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){if(0===this._z||this._threshold<Math.abs(this._y-t)){this._y=t;var e=this.index,n=this._values;2===this._z?(n[e+0]=this._x,n[e+1]=this._y):(n[e+2]=this._x,n[e+3]=this._y,this.index+=2,this._z=2)}},enumerable:!1,configurable:!0}),t.prototype.toSide=function(t,e){return 0<=t-e?0<=t+e?1:0:0<=t+e?2:3},t.prototype.toAxis=function(t,e,n,i,r){var o=Math.abs(n),s=Math.abs(i),a=this._threshold;if(o<a&&s<a)return Math.abs(t)<Math.abs(e)?0<=e?2:0:0<=t?1:3;var u=null,l=0,h=t*t+e*e;if(this._threshold<h){var c=1/Math.sqrt(h),p=t*c,f=e*c,d=+n*p+i*f,y=-i*p+n*f,g=-d,v=-y;r&Gn.TOP&&(null==u||u<d)&&(u=d,l=this.toSide(n,i)),r&Gn.RIGHT&&(null==u||u<y)&&(u=y,l=this.toSide(-i,n)),r&Gn.BOTTOM&&(null==u||u<g)&&(u=g,l=this.toSide(-n,-i)),r&Gn.LEFT&&(null==u||u<v)&&(u=v,l=this.toSide(i,-n))}return l},t.prototype.toTailAxis=function(t,e,n,i,r){return this.toAxis(t-this.x,e-this.y,n,i,r)},t.prototype.tail=function(t,e,n,i,r,o,s,a){switch(this.toTailAxis(t,e,n,i,a)){case 0:this.y-s<=e?(this.y-=Math.max(s,o),this.x=t):this.y=e;break;case 1:t<=this.x+s?(this.x+=Math.max(s,r),this.y=e):this.x=t;break;case 2:e<=this.y+s?(this.y+=Math.max(s,r),this.x=t):this.y=e;break;case 3:this.x-s<=t?(this.x-=Math.max(s,r),this.y=e):this.x=t}},t.prototype.middle=function(t,e){var n=t-this._x,i=e-this._y;Math.abs(n)<Math.abs(i)?this.y=e:this.x=t},t.prototype.toHeadAxis=function(t,e,n,i,r){return this.toAxis(this.x-t,this.y-e,n,i,r)},t.prototype.head=function(t,e,n,i,r,o,s,a){switch(this.toHeadAxis(t,e,n,i,a)){case 0:e-s<=this.y&&(this.y=e-Math.max(s,o)),this.x=t,this.y=e;break;case 1:this.x<=t+s&&(this.x=t+Math.max(s,r)),this.y=e,this.x=t;break;case 2:this.y<=e+s&&(this.y=e+Math.max(s,o)),this.x=t,this.y=e;break;case 3:t-s<=this.x&&(this.x=t-Math.max(s,r)),this.y=e,this.x=t}},t.prototype.margin=function(t,e){var n=this._values,i=this.index;if(0!==t&&2<=i){var r=n[0],o=n[1],s=(u=n[2]-r)*u+(l=n[3]-o)*l;if((h=this._threshold)<s){var a=t/Math.sqrt(u*u+l*l);h<Math.abs(a-1)?(n[0]=r+u*a,n[1]=o+l*a):this.index-=2}}if(i=this.index,0!==e&&2<=i){var u,l,h,c=n[i+0],p=n[i+1];s=(u=n[i-2]-c)*u+(l=n[i-1]-p)*l,(h=this._threshold)<s&&(a=e/Math.sqrt(u*u+l*l),h<Math.abs(a-1)?(n[i+0]=c+u*a,n[i+1]=p+l*a):this.index-=2)}n.length=this.index+2},t}(),ic=function(t){function e(e){return void 0===e&&(e=i.CONNECTOR_ELBOW),t.call(this,e)||this}return F(e,t),e.prototype.fillPoints=function(t,e,n,i,r,o,s,a){var u=t.local,l=u.x,h=u.y,c=t.normal,p=c.x,f=c.y,d=t.side,y=n.local,g=y.x,v=y.y,_=n.normal,m=_.x,b=_.y,T=n.side,w=r.values,E=w.length,O=l-o,C=h-s,S=g-o,x=v-s,D=.5*(S+O),I=.5*(x+C),A=S-O,R=x-C,P=.5*rt.SIZE_X,M=.5*rt.SIZE_Y,k=1e-6;if(Math.abs(A)<k&&Math.abs(R)<k)a[0]=O,a[1]=C,a[2]=S,a[3]=x,a.length=4;else{var L=new nc(O,C,a);if(0<E){var N=Math.atan2(R,A),B=Math.sqrt(A*A+R*R),z=Math.cos(N)*B,U=Math.sin(N)*B,j=w[0],F=w[1],H=D+z*j-U*F,G=I+z*F+U*j;L.tail(H,G,p,f,P,M,e,d);for(var V=2;V<E;V+=2){var W=w[V+0],K=w[V+1],X=D+z*W-U*K,Y=I+z*K+U*W;L.middle(X,Y)}L.head(S,x,m,b,P,M,i,T)}else L.tail(D,I,p,f,P,M,e,d),L.head(S,x,m,b,P,M,i,T);L.margin(e,i)}},e}(Bi),rc=function(t,e,n){return Pl(t,e,n||new ic)},oc=function(){function t(){}return t.from=function(t,e,n){var i=[],r=t.length;if(4<r){var o=1e-6,s=t[0],a=t[1];0!==e&&o<(h=(u=s-t[2])*u+(l=a-t[3])*l)&&(s+=u*(c=e/Math.sqrt(h)),a+=l*c);var u,l,h,c,p=t[r-2],f=t[r-1];0!==n&&o<(h=(u=p-t[r-4])*u+(l=f-t[r-3])*l)&&(p+=u*(c=n/Math.sqrt(h)),f+=l*c);for(var d=.5*(p+s),y=.5*(f+a),g=p-s,v=f-a,_=Math.atan2(v,g),m=Math.cos(_),b=Math.sin(_),T=g*g+v*v,w=o<T?1/Math.sqrt(T):1,E=2,O=r-2;E<O;E+=2){var C=t[E+0]-d,S=t[E+1]-y;i.push((m*C+b*S)*w,(m*S-b*C)*w)}}return i},t}(),sc=function(t,e,n){return Pl(t,e,n||new Bi)},ac=function(t,e,n,i){if(e instanceof Bi){var r=i.resources,o=t[15];if(0<=o&&o<r.length){var s=i.getExtension(o);null==s&&(s=JSON.parse(r[o]),i.setExtension(o,s)),e.lock(zt.CONNECTOR);var a=e.points;a.deserialize(s[1],i);var u=e.edge;u.deserialize(s[0],n,i);var l=e.body,h=s[2];null!=h?l.deserialize(h,n,i):l.set(oc.from(a.values,u.tail.margin,u.head.margin)),e.unlock(zt.CONNECTOR,!0)}}},uc=function(){r[i.CONNECTOR_ELBOW]=ec,e[i.CONNECTOR_ELBOW]=rc,n[i.CONNECTOR_ELBOW]=ac,Xn.set(i.CONNECTOR_ELBOW,Lt.CONNECTOR)},lc=function(){r[i.CONNECTOR_LINE]=ec,e[i.CONNECTOR_LINE]=sc,n[i.CONNECTOR_LINE]=ac,Xn.set(i.CONNECTOR_LINE,Lt.CONNECTOR)},hc=function(t){function e(e,n,i){return t.call(this,e,n,i,Fh,8)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices(),Vh(t.indices,this.vertexOffset,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexStepAndUv(e,t),this.updateColor(e,t)},e.prototype.updateVertexStepAndUv=function(t,e){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=$(e),a=this.transformLocalId!==s,u=e.stroke,l=u.align,h=u.enable?u.width:0,c=u.side,p=u.style,f=this.strokeAlign!==l||this.strokeWidth!==h||this.strokeSide!==c||this.strokeStyle!==p,d=tt(e),y=et(d),g=d!==this.texture||y!==this.textureTransformId,v=o||f,_=!(this.inited&Y.VERTEX_STEP_AND_UV);if(_||v||a||g){this.inited|=Y.VERTEX_STEP_AND_UV,this.sizeX=i,this.sizeY=r,this.transformLocalId=s,this.strokeAlign=l,this.strokeWidth=h,this.strokeSide=c,this.strokeStyle=p,this.texture=d,this.textureTransformId=y;var m=this.vertexOffset;t.updateVertices(),Wh(t.vertices,m,.5*i,.5*r,i,r,l,h,e.transform.internalTransform,Hh),(_||v||a)&&(t.updateSteps(),Kh(m,t.steps,h,c,p,Hh)),(_||v||g)&&(t.updateUvs(),Xh(t.uvs,m,nt(d)))}},e}(Q),cc=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=Fh+a,h=8+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new hc(t,n,i),new de(t,n+Fh,i+8,a,u)]).init(e):null},pc=function(t,e,n,i){var r=D(e),s=r<<2,a=r<<1,u=s,l=a;return t.check(n,i,u,l)?new o(t,n,i,u,l,[new de(t,n,i,s,a)]).init(e):null},fc=function(t,e){var n=t.data.getMapping();if(null!=n)for(var i=n.values,r=0,o=i.length;r<o;++r){var s=i[r],a=s[0],u=e.getDataMapper(a);if(null!=u){var l=t.children,h=e.getDataDestination(s[1]),c=s[2];dc(l,u,h,c)}}},dc=function(t,e,n,i){for(var r=0,o=t.length;r<o;++r){for(var s=t[r],a=s.data,u=0,l=a.size();u<l;++u){var h=a.get(u);h&&h.scope!==Kt.PRIVATE&&e.map(h,n,i)}var c=s.children;0<c.length&&dc(c,e,n,i)}},yc=function(t,e,n){var i=e.pieces,r=t[15];if(i&&0<=r&&r<i.length){var o=e.pieceData;if(o){var s=i[r],a=o.get(s),u=n&&n(s,e);return a?function(t,e,n,i,r,o,s){var a=r.mode,u=r.depth;s=s||new ei(t,a,u);var l=Pl(o,r,s),h=s.size,c=h.x,p=h.y;return s.size.set(e,n),i.copyTo(s),s.size.init(),s.size.set(c,p),a===Hn.EDITOR?0<u&&fc(s,r):fc(s,r),l}(s,a.width,a.height,a.layer,e,t,u):function(t,e,n,i){var r=e.mode,o=e.depth;i=i||new ei(t,r,o);var s=Pl(n,e,i),a=i.size,u=a.x,l=a.y,h=i.children,c=new ar("missing",r,o),p=.5*u,f=.5*u;c.transform.position.set(-p,-f),c.size.set(u,l),c.size.init(),c.parent=i;var d=new Io;return d.stroke.color=16711680,d.transform.position.set(p,f),d.size.copyFrom(i.size),d.attach(c),h.push(c),i.onChildTransformChange(),i.toDirty(),i.onAttach(),i.size.init(),r===Hn.EDITOR?0<o&&fc(i,e):fc(i,e),s}(s,e,t,u)}}return null},gc=function(t,e,n){null!=n||(n=new Kn);var i=t[15];n.subtype=function(t){var e=Vn.ALL&t;return 0!==e?e:Vn.HEAD}(i),n.side=Gn.ALL&i>>2,n.vvisible=0<(1&i>>6);var r=Pl(t,e,n);return!1===n.vvisible&&e.mode===Hn.VIEWER&&(n.visible=!1),r},vc=function(){r[i.EMBEDDED]=pc,e[i.EMBEDDED]=yc,Xn.set(i.EMBEDDED,Lt.EMBEDDED),r[i.EMBEDDED_LAYER]=cc,r[i.EMBEDDED_ACCEPTOR_EDGE]=uh,e[i.EMBEDDED_ACCEPTOR_EDGE]=gc,Xn.set(i.EMBEDDED_ACCEPTOR_EDGE,Lt.EMBEDDED_ACCEPTOR_EDGE)},_c=function(){function t(t){this._parent=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this._parent.children;return!(0<t.length)||t[t.length-1].fill.enable},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].fill.enable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].fill.color:16777215},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].fill.color=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].fill.alpha:1},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].fill.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"direction",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].fill.direction:J.BOTTOM},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].fill.direction=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"percent",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].fill.percent:1},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].fill.percent=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].fill.copy(t)},t.prototype.set=function(t,e,n,i,r){for(var o=this._parent.children,s=0,a=o.length;s<a;++s)o[s].fill.set(t,e,n,i,r)},t.prototype.clone=function(){return new t(this._parent)},t.prototype.toObject=function(){var t=this._parent.children;return 0<t.length?t[t.length-1].fill.toObject():{enable:!0,color:16777215,alpha:1,direction:J.BOTTOM,percent:1}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,e){},t}(),mc=function(){function t(t){this._parent=t}return Object.defineProperty(t.prototype,"length",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.length}return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plength",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.plength}return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.id}return 0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"values",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.values}return[]},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n){var r=e[n].points;null!=r&&(r.values=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"segments",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.segments}return[]},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n){var r=e[n].points;null!=r&&(r.segments=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.style}return X.NONE},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n){var r=e[n].points;null!=r&&(r.style=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"marker",{get:function(){for(var t=this._parent.children,e=0,n=t.length;e<n;++e){var i=t[e].points;if(null!=i)return i.marker}return ut.getInstance()},enumerable:!1,configurable:!0}),t.prototype.getMarker=function(){for(var t=this._parent.children,e=0,n=t.length;e<n;++e){var i=t[e].points;if(null!=i)return i.getMarker()}},Object.defineProperty(t.prototype,"formatter",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.formatter}return null},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n){var r=e[n].points;null!=r&&(r.formatter=t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"formatted",{get:function(){var t=this._parent.children;if(0<t.length){var e=t[t.length-1].points;if(null!=e)return e.formatted}return this},enumerable:!1,configurable:!0}),t.prototype.onSizeChange=function(){},t.prototype.copy=function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n){var r=e[n].points;null!=r&&r.copy(t)}return this},t.prototype.set=function(t,e,n){for(var i=this._parent.children,r=0,o=i.length;r<o;++r){var s=i[r].points;null!=s&&s.set(t,e,n)}return this},t.prototype.clone=function(e){return new t(e)},t.prototype.toPoints=function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n){var r=e[n].points;if(null!=r)return r.toPoints(t)}return[]},t.prototype.serialize=function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n){var r=e[n].points;if(null!=r)return r.serialize(t)}return-1},t}(),bc=function(){function t(t){this._parent=t}return Object.defineProperty(t.prototype,"enable",{get:function(){var t=this._parent.children;return 0<t.length&&t[t.length-1].stroke.enable},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.enable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].stroke.color:16777215},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.color=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].stroke.alpha:1},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.alpha=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"width",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].stroke.width:1},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.width=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"align",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].stroke.align:1},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.align=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"side",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].stroke.side:1},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.side=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"style",{get:function(){var t=this._parent.children;return 0<t.length?t[t.length-1].stroke.style:s.NONE},set:function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.style=t},enumerable:!1,configurable:!0}),t.prototype.copy=function(t){for(var e=this._parent.children,n=0,i=e.length;n<i;++n)e[n].stroke.copy(t)},t.prototype.set=function(t,e,n,i,r){for(var o=this._parent.children,s=0,a=o.length;s<a;++s)o[s].stroke.set(t,e,n,i,r)},t.prototype.clone=function(){return new t(this._parent)},t.prototype.toObject=function(){var t=this._parent.children;return 0<t.length?t[t.length-1].stroke.toObject():{enable:!1,color:16777215,alpha:1,width:1,align:0,side:Z.NONE,style:s.NONE}},t.prototype.serialize=function(t){return-1},t.prototype.deserialize=function(t,e){},t}(),Tc=function(t){function e(e,n){void 0===n&&(n=i.GROUP);var r=t.call(this,n)||this;r._mode=e;var o=new $t;return r.data=o,r.tag=o,r.size=r.newGroupSize(e),r.fill=r.newGroupFill(),r.stroke=r.newGroupStroke(),r.text=r.newGroupText(),r._points=r.newGroupPoints(),r}return F(e,t),Object.defineProperty(e.prototype,"mode",{get:function(){return this._mode},enumerable:!1,configurable:!0}),e.prototype.newGroupSize=function(t){var e=rt.SIZE_X,n=rt.SIZE_Y;return t!==Hn.VIEWER?new Zn(this,e,n,this.isGroupSizeFittable()):new Jn(this,e,n,e,n)},e.prototype.isGroupSizeFittable=function(){return!0},e.prototype.newGroupFill=function(){return new _c(this)},e.prototype.newGroupStroke=function(){return new bc(this)},e.prototype.newGroupText=function(){return new ie(this,rt.TEXT_VALUE,rt.TEXT_COLOR,rt.TEXT_ALPHA,rt.TEXT_FAMILY,rt.TEXT_SIZE)},e.prototype.newGroupPoints=function(){return new mc(this)},e.prototype.getBoundsSize=function(){var t=this.size;return t instanceof Jn?t.base:t},e.prototype.onChildTransformChange=function(){t.prototype.onChildTransformChange.call(this),this.size.fit()},Object.defineProperty(e.prototype,"corner",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].corner:pt.ALL},set:function(t){for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].corner=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"gradient",{get:function(){for(var t=this.children,e=t.length-1;0<=e;--e){var n=t[e].gradient;if(null!=n)return n}},set:function(t){for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].gradient=t},enumerable:!1,configurable:!0}),e.prototype.serializeGradient=function(t){return-1},Object.defineProperty(e.prototype,"radius",{get:function(){var t=this.children;return 0<t.length?t[t.length-1].radius:.5},set:function(t){for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].radius=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"image",{get:function(){for(var t=this.children,e=t.length-1;0<=e;--e){var n=t[e].image;if(null!=n)return n}},set:function(t){for(var e=this.children,n=0,i=e.length;n<i;++n)e[n].image=t},enumerable:!1,configurable:!0}),e.prototype.serializeImage=function(t){return-1},Object.defineProperty(e.prototype,"points",{get:function(){for(var t=this.children,e=t.length-1;0<=e;--e)if(null!=t[e].points)return this._points},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.clone=function(){for(var t=this.newClone().copy(this),e=this.children,n=0,i=e.length;n<i;++n){var r=e[n].clone();r.parent=t,t.children.push(r)}return zi.move(this,t),t.onChildTransformChange(),t.toDirty(),t},e.prototype.newClone=function(){return new(0,this.constructor)(this._mode,this.type)},e.prototype.containsAbs=function(t,e,n,i,r,o,s){return!1},e}(jt),wc=function(t,e,n){n=n||new Tc(e.mode);var i=Pl(t,e,n);return n.size.init(),i},Ec=function(){r[i.GROUP]=pc,e[i.GROUP]=wc,Xn.set(i.GROUP,Lt.GROUP)},Oc=function(){function e(e,n,i){this._parent=e,this._size=new t.Point(n,i)}return e.prototype.init=function(){return this},Object.defineProperty(e.prototype,"x",{get:function(){return this._size.x},set:function(t){var e=this._size;if(e.x!==t){var n=e.x;e.x=t,this.onChange(n,e.y)}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._size.y},set:function(t){var e=this._size;if(e.y!==t){var n=e.y;e.y=t,this.onChange(e.x,n)}},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e){var n=!1,i=this._size,r=i.x,o=i.y;return null!=t&&r!==t&&(n=!0,i.x=t),null!=e&&o!==e&&(n=!0,i.y=e),n&&this.onChange(r,o),this},e.prototype.clone=function(){var t=this._size;return new e(this._parent,t.x,t.y)},e.prototype.copy=function(){},e.prototype.copyFrom=function(t){var e=t.x,n=t.y,i=this._size,r=i.x,o=i.y;return r===e&&o===n||(i.x=e,i.y=n,this.onChange(r,o)),this},e.prototype.copyTo=function(t){return this._size.copyTo(t)},e.prototype.equals=function(t){return this._size.equals(t)},e.prototype.fit=function(){return this},e.prototype.onChange=function(t,e){this._parent.onSizeChange()},e}(),Cc=function(t){function e(e,n){return void 0===n&&(n=i.GROUP_SHADOWED),t.call(this,e,n)||this}return F(e,t),e.prototype.newGroupSize=function(e){return e!==Hn.VIEWER?new Oc(this,rt.SIZE_X,rt.SIZE_Y):t.prototype.newGroupSize.call(this,e)},e}(Tc),Sc=function(t,e,n){n=n||new Cc(e.mode);var i=Pl(t,e,n);return n.size.init(),i},xc=function(){r[i.GROUP_SHADOWED]=pc,e[i.GROUP_SHADOWED]=Sc,Xn.set(i.GROUP_SHADOWED,Lt.GROUP)},Dc=function(t){function e(e,n,i){return t.call(this,e,n,i,Fh,8)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices(),Vh(t.indices,this.vertexOffset,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexStepAndUv(e,t),this.updateColor(e,t)},e.prototype.updateVertexStepAndUv=function(t,e){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=$(e),a=this.transformLocalId!==s,u=e.stroke,l=u.align,h=u.enable?u.width:0,c=u.side,p=u.style,f=this.strokeAlign!==l||this.strokeWidth!==h||this.strokeSide!==c||this.strokeStyle!==p,d=tt(e),y=et(d),g=d!==this.texture||y!==this.textureTransformId,v=o||f,_=!(this.inited&Y.VERTEX_STEP_AND_UV);if(_||v||a||g){this.inited|=Y.VERTEX_STEP_AND_UV,this.sizeX=i,this.sizeY=r,this.transformLocalId=s,this.strokeAlign=l,this.strokeWidth=h,this.strokeSide=c,this.strokeStyle=p,this.texture=d,this.textureTransformId=y;var m=this.vertexOffset;t.updateVertices(),Wh(t.vertices,m,0,0,i,r,l,h,e.transform.internalTransform,Hh),(_||v||a)&&(t.updateSteps(),Kh(m,t.steps,h,c,p,Hh)),(_||v||g)&&(t.updateUvs(),Xh(t.uvs,m,nt(d)))}},e}(Q),Ic=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=Fh+a,h=8+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new Dc(t,n,i),new de(t,n+Fh,i+8,a,u)]).init(e):null},Ac=function(t){function e(e,n){void 0===n&&(n=i.IMAGE);var r=t.call(this,n)||this;return null!=e&&(r.image=e,r.size.set(e.width,e.height)),r.fill.alpha=1,r}return F(e,t),e.prototype.clone=function(){return new e(this.image,this.type).copy(this)},e}(Io),Rc=function(t,e,n){return Pl(t,e,n||new Ac)},Pc=function(){r[i.IMAGE]=Ic,e[i.IMAGE]=Rc},Mc=[0,0],kc=new t.Point,Lc=function(t,e,n){var i=3*n-1;t[++i]=e,t[++i]=e+1,t[++i]=e+3,t[++i]=e+1,t[++i]=e+4,t[++i]=e+3,t[++i]=e+1,t[++i]=e+2,t[++i]=e+4,t[++i]=e+2,t[++i]=e+5,t[++i]=e+4,t[++i]=e+3,t[++i]=e+4,t[++i]=e+6,t[++i]=e+4,t[++i]=e+7,t[++i]=e+6,t[++i]=e+4,t[++i]=e+5,t[++i]=e+7,t[++i]=e+5,t[++i]=e+8,t[++i]=e+7},Nc=function(t,e,n,i,r,o,s,a){var l=u(r),h=p(2,l,1,1),c=o/a[0],f=s/a[1],d=.5*(c+f),y=i/12,g=-1+n,v=6*e-1;t[++v]=y,t[++v]=h,t[++v]=d,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=f,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=d,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=c,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=d,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=c,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=d,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=f,t[++v]=g,t[++v]=0,t[++v]=0,t[++v]=y,t[++v]=h,t[++v]=f,t[++v]=g,t[++v]=0,t[++v]=0},Bc=function(t,e,n,i,r,o,s,a){var u=kc,l=.5*r,h=.5*o;u.set(n-l,i-h),s.apply(u,u);var c=u.x,p=u.y;u.set(n+l,i-h),s.apply(u,u);var f=u.x,d=u.y;u.set(n+l,i+h),s.apply(u,u);var y=u.x,g=u.y,v=c+(y-f),_=p+(g-d),m=(e<<1)-1;t[++m]=c,t[++m]=p,t[++m]=.5*(c+f),t[++m]=.5*(p+d),t[++m]=f,t[++m]=d,t[++m]=.5*(c+v),t[++m]=.5*(p+_),t[++m]=.5*(c+y),t[++m]=.5*(p+g),t[++m]=.5*(f+y),t[++m]=.5*(d+g),t[++m]=v,t[++m]=_,t[++m]=.5*(v+y),t[++m]=.5*(_+g),t[++m]=y,t[++m]=g,a[0]=.5*O(c,p,f,d),a[1]=.5*O(c,p,v,_)},zc=function(t,e,n){var i=n.x0,r=n.y0,o=n.x1,s=n.y1,a=n.x2,u=n.y2,l=n.x3,h=n.y3,c=(e<<1)-1;t[++c]=i,t[++c]=r,t[++c]=.5*(o+i),t[++c]=.5*(s+r),t[++c]=o,t[++c]=s,t[++c]=.5*(i+l),t[++c]=.5*(r+h),t[++c]=.5*(i+a),t[++c]=.5*(r+u),t[++c]=.5*(o+a),t[++c]=.5*(s+u),t[++c]=l,t[++c]=h,t[++c]=.5*(l+a),t[++c]=.5*(h+u),t[++c]=a,t[++c]=u},Uc=function(t){function e(e,n,i){var r=t.call(this,e,n,i,9,8)||this;return r.textureWidth=-1,r.textureHeight=-1,r}return F(e,t),e.prototype.init=function(){var t=this.vertexOffset,e=this.buffer;e.updateIndices(),Lc(e.indices,t,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexAndStep(e,t),this.updateColor(e,t),this.updateUv(e,t)},e.prototype.updateVertexAndStep=function(t,e){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=$(e),a=this.transformLocalId!==s,u=e.stroke,l=u.align,h=u.enable?u.width:0,c=u.style,p=this.strokeAlign!==l||this.strokeWidth!==h||this.strokeStyle!==c,f=tt(e),d=f.width*f.resolution,y=f.height*f.resolution,g=this.textureWidth!==d||this.textureHeight!==y;(!(this.inited&Y.VERTEX_AND_STEP)||o||a||p||g)&&(this.inited|=Y.VERTEX_AND_STEP,this.sizeX=i,this.sizeY=r,this.transformLocalId=s,this.strokeAlign=l,this.strokeWidth=h,this.strokeStyle=c,this.textureWidth=d,this.textureHeight=y,t.updateVertices(),Bc(t.vertices,this.vertexOffset,0,0,i,r,e.transform.internalTransform,Mc),t.updateSteps(),Nc(t.steps,this.vertexOffset,l,h,c,d,y,Mc))},e.prototype.updateUv=function(t,e){var n=tt(e),i=et(n);(!(this.inited&Y.UV)||n!==this.texture||i!==this.textureTransformId)&&(this.inited|=Y.UV,this.texture=n,this.textureTransformId=i,t.updateUvs(),zc(t.uvs,this.vertexOffset,nt(n)))},e}(Q),jc=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=9+a,h=8+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new Uc(t,n,i),new de(t,n+9,i+8,a,u)]).init(e):null},Fc=function(t){function e(e,n){return void 0===n&&(n=i.IMAGE_SDF),t.call(this,e,n)||this}return F(e,t),e.prototype.clone=function(){return new e(this.image,this.type).copy(this)},e}(Ac),Hc=function(t,e,n){return Pl(t,e,n||new Fc)},Gc=function(){function e(t,e,n){this.buffer=t,this.vertexOffset=e,this.indexOffset=n,this.vertexCount=0,this.indexCount=0,this.texture=null}return e.prototype.init=function(){return this},e.prototype.reinit=function(t,e,n,i){return this.buffer=t,this.vertexOffset=n,this.indexOffset=i,!0},e.prototype.isCompatible=function(t){return!0},e.prototype.update=function(t){this.texture=tt(t)},e.prototype.buildUnit=function(e){var n=this.texture||t.Texture.WHITE,i=n.baseTexture;if(i!==e.baseTexture){e.baseTexture=i;var r=this.indexOffset;e.push(n,r)}},e}(),Vc=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=a,h=u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new Gc(t,n,i),new de(t,n,i,a,u)]).init(e):null},Wc=function(t){function e(e){return void 0===e&&(e=i.LABEL),t.call(this,e)||this}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e}(oe),Kc=function(t,e,n){return Pl(t,e,n||new Wc)},Xc=function(){r[i.LABEL]=Vc,e[i.LABEL]=Kc},Yc=function(t){function e(e){void 0===e&&(e=i.LINE);var n=t.call(this,e)||this;return n._points=new Li(n),n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.serialize=function(e){var n=t.prototype.serialize.call(this,e);return n[15]=this._points.serialize(e),n},e}(ce),qc=function(t,e,n){n=n||new Yc;var i=Pl(t,e,n);n.points.deserialize(t[15],e);var r=n.points.style,o=X.NON_SCALING_MASK|X.DOTTED_MASK|X.DASHED_MASK,s=r&o;return s&&(n.points.style&=~o,n.stroke.style|=s),i},Zc=function(){r[i.LINE]=ec,e[i.LINE]=qc},Jc=function(t,e,n){for(var i=2*e,r=2*(e+n);i<r;i+=2)t[i+0]=0,t[i+1]=0},Qc=function(t,e,n){for(var i=6*e,r=6*(e+n);i<r;i+=6)t[i+0]=0,t[i+1]=0,t[i+2]=0,t[i+3]=0,t[i+4]=0,t[i+5]=0},$c=function(t,e,n){for(var i=2*e,r=2*(e+n);i<r;i+=2)t[i+0]=0,t[i+1]=0},tp=function(t){return(t>>4)+(0<(15&t)?1:0)<<4},ep=function(t,e,n,i,r,o,s,a,u,l,h,c){if(s)if(n.isStaticColor()){var p=n.getColor(0,u);if(n.isStaticAlpha()){var f=n.getAlpha(0,l);np(t,e,n,i,r,o,a,h,c,p,f)}else ip(t,e,n,i,r,o,a,h,c,p,l)}else n.isStaticAlpha()?(f=n.getAlpha(0,l),rp(t,e,n,i,r,o,a,h,c,u,f)):op(t,e,n,i,r,o,a,h,c,u,l);else n.isStaticColor()?(p=n.getColor(0,u),np(t,e,n,i,r,o,a,h,c,p,0)):rp(t,e,n,i,r,o,a,h,c,u,0)},np=function(t,e,n,i,r,o,s,a,u,l,h){if(s)if(i.isStaticColor()){var c=i.getColor(0,a);if(i.isStaticAlpha()){var p=i.getAlpha(0,u);q(l,h,c,p,t,e*r,o)}else for(var f=0,d=t;f<r;f+=1,d+=e)p=i.getAlpha(f,u),q(l,h,c,p,d,e,o)}else if(i.isStaticAlpha())for(p=i.getAlpha(0,u),f=0,d=t;f<r;f+=1,d+=e)c=i.getColor(f,a),q(l,h,c,p,d,e,o);else for(f=0,d=t;f<r;f+=1,d+=e)c=i.getColor(f,a),p=i.getAlpha(f,u),q(l,h,c,p,d,e,o);else if(i.isStaticColor())c=i.getColor(0,a),q(l,h,c,0,t,e*r,o);else for(f=0,d=t;f<r;f+=1,d+=e)c=i.getColor(f,a),q(l,h,c,0,d,e,o)},ip=function(t,e,n,i,r,o,s,a,u,l,h){if(s)if(i.isStaticColor()){var c=i.getColor(0,a);if(i.isStaticAlpha())for(var p=i.getAlpha(0,u),f=0,d=t;f<r;f+=1,d+=e){var y=n.getAlpha(f,h);q(l,y,c,p,d,e,o)}else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getAlpha(f,h),p=i.getAlpha(f,u),q(l,y,c,p,d,e,o)}else if(i.isStaticAlpha())for(p=i.getAlpha(0,u),f=0,d=t;f<r;f+=1,d+=e)y=n.getAlpha(f,h),c=i.getColor(f,a),q(l,y,c,p,d,e,o);else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getAlpha(f,h),c=i.getColor(f,a),p=i.getAlpha(f,u),q(l,y,c,p,d,e,o);else if(i.isStaticColor())for(c=i.getColor(0,a),f=0,d=t;f<r;f+=1,d+=e)y=n.getAlpha(f,h),q(l,y,c,0,d,e,o);else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getAlpha(f,h),c=i.getColor(f,a),q(l,y,c,0,d,e,o)},rp=function(t,e,n,i,r,o,s,a,u,l,h){if(s)if(i.isStaticColor()){var c=i.getColor(0,a);if(i.isStaticAlpha())for(var p=i.getAlpha(0,u),f=0,d=t;f<r;f+=1,d+=e){var y=n.getColor(f,l);q(y,h,c,p,d,e,o)}else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),p=i.getAlpha(f,u),q(y,h,c,p,d,e,o)}else if(i.isStaticAlpha())for(p=i.getAlpha(0,u),f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),c=i.getColor(f,a),q(y,h,c,p,d,e,o);else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),c=i.getColor(f,a),p=i.getAlpha(f,u),q(y,h,c,p,d,e,o);else if(i.isStaticColor())for(c=i.getColor(0,a),f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),q(y,h,c,0,d,e,o);else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),c=i.getColor(f,a),q(y,h,c,0,d,e,o)},op=function(t,e,n,i,r,o,s,a,u,l,h){if(s)if(i.isStaticColor()){var c=i.getColor(0,a);if(i.isStaticAlpha())for(var p=i.getAlpha(0,u),f=0,d=t;f<r;f+=1,d+=e){var y=n.getColor(f,l),g=n.getAlpha(f,h);q(y,g,c,p,d,e,o)}else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),g=n.getAlpha(f,h),p=i.getAlpha(f,u),q(y,g,c,p,d,e,o)}else if(i.isStaticAlpha())for(p=i.getAlpha(0,u),f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),g=n.getAlpha(f,h),c=i.getColor(f,a),q(y,g,c,p,d,e,o);else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),g=n.getAlpha(f,h),c=i.getColor(f,a),p=i.getAlpha(f,u),q(y,g,c,p,d,e,o);else if(i.isStaticColor())for(c=i.getColor(0,a),f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),g=n.getAlpha(f,h),q(y,g,c,0,d,e,o);else for(f=0,d=t;f<r;f+=1,d+=e)y=n.getColor(f,l),g=n.getAlpha(f,h),c=i.getColor(f,a),q(y,g,c,0,d,e,o)},sp=function(t){function e(e,n,i,r,o,s,a,u){var l=t.call(this,e,n,i,r,o)||this;return l.pointId=-1,l.pointCount=0,l.pointCountReserved=s,l.pointSizeId=-1,l.pointOffsetId=-1,l.pointFillId=-1,l.pointStrokeId=-1,l.vcountPerPoint=a,l.icountPerPoint=u,l}return F(e,t),e.prototype.reinit=function(t,e,n,i){var r=tp(dh(e.points));if(this.buffer!==t||this.vertexOffset!==n||this.indexOffset!==i||this.pointCountReserved!==r){var o=r*this.vcountPerPoint,s=r*this.icountPerPoint;return!!t.check(n,i,o,s)&&(this.inited=Y.NONE,this.buffer=t,this.vertexOffset=n,this.indexOffset=i,this.vertexCount=o,this.indexCount=s,this.pointCountReserved=r,this.init(),!0)}return!0},e.prototype.isCompatible=function(t){return tp(dh(t.points))===this.pointCountReserved},e.prototype.updateLineOfAnyColor=function(t,e,n,i){var r=n.fill,o=r.id,s=o!==this.pointFillId,a=e.fill,u=e.visible&&a.enable,l=a.color,h=u?a.alpha:0,c=l!==this.colorFill||h!==this.alphaFill,p=n.stroke,f=p.id,d=f!==this.pointStrokeId,y=e.stroke,g=e.visible&&y.enable,v=y.color,_=g?y.alpha:0,m=v!==this.colorStroke||_!==this.alphaStroke;(!(this.inited&Y.COLOR)||s||c||d||m)&&(this.inited|=Y.COLOR,this.colorFill=l,this.alphaFill=h,this.pointFillId=o,this.colorStroke=v,this.alphaStroke=_,this.pointStrokeId=f,t.updateColors(),ep(this.vertexOffset,i,r,p,this.pointCountReserved,t.colors,u,g,l,h,v,_))},e}(Q),ap=function(t,e,n,i,r){for(var o=e,s=n+i,a=1;a<r;++a){for(var u=3*s,l=3*n,h=0;h<i;++h)t[u+0]=t[l+0]+o,t[u+1]=t[l+1]+o,t[u+2]=t[l+2]+o,u+=3,l+=3;o+=e,s+=i}},up=function(t,e,n,i){for(var r=6*e,o=6*(e+n),s=1;s<i;++s)for(var a=r,u=0;u<n;++u)t[o+0]=t[a+0],t[o+1]=t[a+1],t[o+2]=t[a+2],t[o+3]=t[a+3],t[o+4]=t[a+4],t[o+5]=t[a+5],o+=6,a+=6},lp=function(t,e,n,i){for(var r=e+n,o=1;o<i;++o){for(var s=r<<1,a=e<<1,u=0;u<n;++u)t[s]=t[a],t[s+1]=t[a+1],s+=2,a+=2;r+=n}},hp=function(t,e,n,i,r,o,s){var a=e.a,u=e.b,l=e.c,h=e.d,c=r-1,p=n+c*i;if(s.isStaticX()&&s.isStaticY())for(var f=s.getX(0),d=s.getY(0);0<=c;--c){for(var y=a*(T=o[b=c<<1]+f)+l*(w=o[b+1]+d),g=u*T+h*w,v=p<<1,_=n<<1,m=0;m<i;++m)t[v]=t[_]+y,t[v+1]=t[_+1]+g,v+=2,_+=2;p-=i}else for(;0<=c;--c){var b,T,w;for(y=a*(T=o[b=c<<1]+s.getX(c))+l*(w=o[b+1]+s.getY(c)),g=u*T+h*w,v=p<<1,_=n<<1,m=0;m<i;++m)t[v]=t[_]+y,t[v+1]=t[_+1]+g,v+=2,_+=2;p-=i}},cp=function(t){return St(t)||null==t},pp=function(t,e,n){return St(e)?e:Ct(e)?e(t):e?e[t%e.length]:n},fp=function(){function t(t){this._parent=t,this._id=0,this._color=null,this._alpha=null}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;void 0!==t&&this._color!==t&&(n=!0,this._color=t),void 0!==e&&this._alpha!==e&&(n=!0,this._alpha=e),n&&(this._id+=1,this._parent.updateUploaded())},t.prototype.getColor=function(t,e){return pp(t,this._color,e)},t.prototype.getAlpha=function(t,e){return pp(t,this._alpha,e)},t.prototype.isStaticColor=function(){return cp(this._color)},t.prototype.isStaticAlpha=function(){return cp(this._alpha)},t.prototype.toDirty=function(){this._id+=1},t}(),dp=function(){function t(t,e,n){this._parent=t,this._id=0,this._x=null,this._y=null,this._defX=e,this._defY=n,this._limit=null,this._limitComputed=0,this._limitId=-1,this._limitParentLength=0}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x",{get:function(){return this._x},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"limit",{get:function(){return this._limit},set:function(t){this._limit=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;void 0!==t&&this._x!==t&&(n=!0,this._x=t),void 0!==e&&this._y!==e&&(n=!0,this._y=e),n&&(this._id+=1,this._parent.updateUploaded())},t.prototype.getX=function(t){return pp(t,this._x,this._defX)},t.prototype.getY=function(t){return pp(t,this._y,this._defY)},t.prototype.getLimit=function(){var t=this._limit;return null!=t?t:(this.updateLimitComputed(),this._limitComputed)},t.prototype.updateLimitComputed=function(){var t=this._id,e=this._parent.length;this._limitId===t&&this._limitParentLength===e||(this._limitId=t,this._limitParentLength=e,this._limitComputed=Math.max(this.calcLimit(this._x,e,this._defX),this.calcLimit(this._y,e,this._defY)))},t.prototype.calcLimit=function(t,e,n){if(St(t))return Math.abs(t);if(Ct(t)){if(0<e){for(var i=Math.abs(t(0)),r=1;r<e;++r)i=Math.max(i,Math.abs(t(r)));return i}return 0}if(null!=t){var o=t.length;if(0<o){for(i=t[0],r=1;r<o;++r)i=Math.max(i,Math.abs(t[r]));return i}return 0}return Math.abs(n)},t.prototype.isStaticX=function(){return cp(this._x)},t.prototype.isStaticY=function(){return cp(this._y)},t.prototype.toDirty=function(){this._id+=1},t}(),yp=function(){function t(t){this._parent=t,this._id=0,this._color=null,this._alpha=null}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;void 0!==t&&this._color!==t&&(n=!0,this._color=t),void 0!==e&&this._alpha!==e&&(n=!0,this._alpha=e),n&&(this._id+=1,this._parent.updateUploaded())},t.prototype.getColor=function(t,e){return pp(t,this._color,e)},t.prototype.getAlpha=function(t,e){return pp(t,this._alpha,e)},t.prototype.isStaticColor=function(){return cp(this._color)},t.prototype.isStaticAlpha=function(){return cp(this._alpha)},t.prototype.toDirty=function(){this._id+=1},t}(),gp=function(){function e(t){this._parent=t,this._values=[],this._valuesLength=0,this._segments=[],this._length=0,this._plength=0,this._size=new dp(this,rt.SIZE_X,rt.SIZE_Y),this._offset=new dp(this,0,0),this._fill=new fp(t),this._stroke=new yp(t),this._id=0}return Object.defineProperty(e.prototype,"length",{get:function(){return this._length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"plength",{get:function(){return this._plength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"values",{get:function(){return this._values},set:function(t){this.set(t,void 0,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"segments",{get:function(){return this._segments},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return X.NONE},set:function(t){this.set(void 0,void 0,t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"marker",{get:function(){var t=this._marker;return null==t&&(t=ut.getInstance(),this._marker=t),t},enumerable:!1,configurable:!0}),e.prototype.getMarker=function(){},Object.defineProperty(e.prototype,"size",{get:function(){return this._size},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"offset",{get:function(){return this._offset},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fill",{get:function(){return this._fill},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"stroke",{get:function(){return this._stroke},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formatter",{get:function(){return null},set:function(t){},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"formatted",{get:function(){return this},enumerable:!1,configurable:!0}),e.prototype.onSizeChange=function(){},e.prototype.toFitted=function(t,e){},e.prototype.copy=function(t){return this.set(t.values,t.segments,t.style)},e.prototype.set=function(t,e,n){var i=!1,r=!1;if(null!=t){var o=this._values,s=this._valuesLength,a=t.length;if(o!==t){for(var u=Math.min(s,a),l=0;l<u;++l)o[l]=t[l];for(l=u;l<a;++l)o.push(t[l]);s!==a?(o.length=a,this._valuesLength=a,i=!0):r=!0}else s!==a?(this._valuesLength=a,i=!0):r=!0;var h=a>>1;this._length=h,this._plength<h&&(this._plength=h)}if(i){this._id+=1;var c=this._parent,p=c.uploaded;p?p.isCompatible(c)?c.updateUploaded():c.toDirty():c.updateUploaded()}else r&&(this._id+=1,this._parent.updateUploaded());return this},e.prototype.updateUploaded=function(){this._parent.updateUploaded()},e.prototype.clone=function(t){return new e(t).copy(this)},e.prototype.toPoints=function(e){for(var n=[],i=this.values,r=0,o=i.length;r<o;r+=2){var s=new t.Point(i[r+0],i[r+1]);n.push(e.apply(s,s))}return n},e.prototype.serialize=function(t){return t.addResource("[]")},e.prototype.calcHitPointAbs=function(t,n,i,r,o,s,a,u,l){var h=this.formatted,c=h.length,p=h.values,f=this._size,d=this._offset,y=0,g=c;if(a){var v=.5*f.getLimit(),_=d.getLimit(),m=e.WORK_RANGE;a(t,n,v,v,_,_,s,p,m),y=m[0],g=m[1]}for(var b=y,T=Math.min(g,c);b<T;++b){var w=b<<1,E=p[w],O=p[w+1];if(u(t,n,.5*f.getX(b),.5*f.getY(b),d.getX(b),d.getY(b),E,O,i,r,o,b,s,l))return!0}return!1},e.WORK_RANGE=[0,0],e}(),vp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=t.indices,n=this.vertexOffset,i=this.indexOffset,r=this.pointCountReserved;0<r&&(ih(e,n,i),ap(e,9,i,8,r)),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=t.points;if(e instanceof gp){var n=this.buffer;this.updateVertexAndStep(n,t,e),this.updateLineOfAnyColor(n,t,e,9),this.updateUv(n,t)}},e.prototype.updateVertexAndStep=function(t,e,n){var i=n.id,r=n.offset,o=r.id,s=i!==this.pointId||o!==this.pointOffsetId,a=n.size,u=a.id,l=u!==this.pointSizeId,h=e.size,c=h.x,p=h.y,f=c!==this.sizeX||p!==this.sizeY,d=$(e),y=this.transformLocalId!==d,g=e.stroke,v=g.align,_=g.enable?g.width:0,m=g.style,b=this.strokeAlign!==v||this.strokeWidth!==_||this.strokeStyle!==m;if(!(this.inited&Y.VERTEX_AND_STEP)||s||l||f||y||b){this.inited|=Y.VERTEX_AND_STEP,this.pointId=i;var T=n.formatted;this.pointCount=T.length,this.pointOffsetId=o,this.pointSizeId=u,this.sizeX=c,this.sizeY=p,this.transformLocalId=d,this.strokeWidth=_,this.strokeAlign=v,this.strokeStyle=m,t.updateVertices(),t.updateSteps();var w=this.pointCount,E=T.values,O=this.vertexOffset,C=t.vertices,S=t.steps,x=e.transform.internalTransform;if(0<w&&a.isStaticX()&&a.isStaticY()){var D=a.getX(0),I=a.getY(0);rh(C,O,0,0,D,I,v,_,x,eh),hp(C,x,O,9,w,E,r),oh(S,O,_,m,eh),up(S,O,9,w)}else for(var A=0;A<w;++A){var R=A<<1,P=E[R]+r.getX(A),M=E[R+1]+r.getY(A),k=(D=a.getX(A),I=a.getY(A),O+9*A);rh(C,k,P,M,D,I,v,_,x,eh),oh(S,k,_,m,eh)}var L=O+9*w,N=9*(this.pointCountReserved-w);Jc(C,L,N),Qc(S,L,N)}},e.prototype.updateUv=function(t,e){var n=tt(e),i=et(n);if(!(this.inited&Y.UV)||n!==this.texture||i!==this.textureTransformId){this.inited|=Y.UV,this.texture=n,this.textureTransformId=i,t.updateUvs();var r=t.uvs,o=this.vertexOffset,s=nt(n),a=this.pointCountReserved;0<a&&(sh(r,o,s),lp(r,o,9,a))}},e}(sp),_p=function(t,e,n,i,r,s,a,u){var l=D(e),h=l<<2,c=l<<1,p=e.points,f=tp(dh(p)),d=f*i,y=f*s,g=d+h,v=y+c;return t.check(n,r,g,v)?new o(t,n,r,g,v,[new u(t,n,r,d,y,f,i,s),new de(t,n+d,r+y,h,c)]).init(e):null},mp=function(t,e,n,i,r){return _p(t,e,n,9,i,8,0,vp)},bp=function(t){function e(e){void 0===e&&(e=i.LINE_OF_CIRCLES);var n=t.call(this,e)||this;return n._points=new gp(n),n._tester=function(t,e,i,r,o,s,a,u,l,h,c){return n.containsPointAbs(t,e,i,r,o,s,a,u,l,h,c)},n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(t,e,n,i,r,o,s){var a=he(r,o,this._points.size.getLimit());return!!this.containsAbsBBox(t,e,n+a,i+a)&&this._points.calcHitPointAbs(t,e,r,o,s,a,null,this._tester,null)},e.prototype.containsPointAbs=function(e,n,i,r,o,s,a,u,l,h,c){return t.prototype.containsAbs.call(this,e-a-o,n-u-s,i,r,l,h,c)},e.prototype.calcHitPoint=function(t,e,n,i,r,o){var s=this.toHitTestData(t,e),a=(n||he)(s.strokeWidth,s.strokeScale,this._points.size.getLimit());return!!this.containsAbsBBox(s.x,s.y,s.width+a,s.height+a)&&this._points.calcHitPointAbs(s.x,s.y,s.strokeWidth,s.strokeScale,s.strokeAlign,a,i,r||this._tester,o)},e}(Wn),Tp=function(t,e,n){return Pl(t,e,n||new bp)},wp=function(){r[i.LINE_OF_CIRCLES]=mp,e[i.LINE_OF_CIRCLES]=Tp},Ep=function(t){function e(e,n,i,r,o,s,a,u){var l=t.call(this,e,n,i,r,o,s,a,u)||this;return l.radius=0,l.corner=0,l}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=t.indices,n=this.vertexOffset,i=this.indexOffset,r=this.pointCountReserved;0<r&&(Ul(e,n,i),ap(e,Ll,i,Nl,r)),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=t.points;if(e instanceof gp){var n=this.buffer;this.updateVertexStepAndUv(n,t,e),this.updateLineOfAnyColor(n,t,e,Ll)}},e.prototype.updateVertexStepAndUv=function(t,e,n){var i=n.id,r=n.offset,o=r.id,s=i!==this.pointId||o!==this.pointOffsetId,a=n.size,u=a.id,l=u!==this.pointSizeId,h=e.size,c=h.x,p=h.y,f=e.radius,d=c!==this.sizeX||p!==this.sizeY||f!==this.radius,y=$(e),g=this.transformLocalId!==y,v=e.stroke,_=v.align,m=v.enable?v.width:0,b=v.side,T=v.style,w=this.strokeAlign!==_||this.strokeWidth!==m||this.strokeSide!==b||this.strokeStyle!==T,E=e.corner,O=E!==this.corner,C=tt(e),S=et(C),x=C!==this.texture||S!==this.textureTransformId,D=s||l||d||w,I=!(this.inited&Y.VERTEX_STEP_AND_UV);if(I||D||g||O||x){this.inited|=Y.VERTEX_STEP_AND_UV,this.pointId=i;var A=n.formatted;this.pointCount=A.length,this.pointOffsetId=o,this.pointSizeId=u,this.sizeX=c,this.sizeY=p,this.radius=f,this.transformLocalId=y,this.strokeAlign=_,this.strokeWidth=m,this.strokeSide=b,this.strokeStyle=T,this.corner=E,this.texture=C,this.textureTransformId=S,t.updateVertices(),(I||D||g||O)&&t.updateSteps(),(I||D||x)&&t.updateUvs();var R=this.pointCount,P=A.values,M=this.vertexOffset,k=t.vertices,L=t.steps,N=t.uvs,B=e.transform.internalTransform,z=nt(C);if(0<R&&a.isStaticX()&&a.isStaticY()){var U=a.getX(0),j=a.getY(0);jl(k,M,0,0,U,j,_,m,f,B,Bl),hp(k,B,M,Ll,R,P,r),(I||D||g||O)&&(Fl(L,M,m,b,T,E,Bl),up(L,M,Ll,R)),(I||D||x)&&(Hl(N,M,z,Bl),lp(N,M,Ll,R))}else for(var F=0;F<R;++F){var H=F<<1,G=P[H]+r.getX(F),V=P[H+1]+r.getY(F),W=(U=a.getX(F),j=a.getY(F),M+F*Ll);jl(k,W,G,V,U,j,_,m,f,B,Bl),(I||D||g||O)&&Fl(L,W,m,b,T,E,Bl),(I||D||x)&&Hl(N,W,z,Bl)}var K=this.pointCountReserved,X=M+R*Ll,q=Ll*(K-R);Jc(k,X,q),Qc(L,X,q),$c(N,X,q)}},e}(sp),Op=function(t,e,n,i,r){return _p(t,e,n,Ll,i,Nl,0,Ep)},Cp=function(t){function e(e){void 0===e&&(e=i.LINE_OF_RECTANGLE_ROUNDEDS);var n=t.call(this,e)||this;return n._points=new gp(n),n._tester=function(t,e,i,r,o,s,a,u,l,h,c){return n.containsPointAbs(t,e,i,r,o,s,a,u,l,h,c)},n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(t,e,n,i,r,o,s){var a=he(r,o,this._points.size.getLimit());return!!this.containsAbsBBox(t,e,n+a,i+a)&&this._points.calcHitPointAbs(t,e,a,r,o,s,null,this._tester,null)},e.prototype.containsPointAbs=function(e,n,i,r,o,s,a,u,l,h,c){return t.prototype.containsAbs.call(this,e-a-o,n-u-s,i,r,l,h,c)},e.prototype.calcHitPoint=function(t,e,n,i,r,o){var s=this.toHitTestData(t,e),a=(n||he)(s.strokeWidth,s.strokeScale,this._points.size.getLimit());return!!this.containsAbsBBox(s.x,s.y,s.width+a,s.height+a)&&this._points.calcHitPointAbs(s.x,s.y,s.strokeWidth,s.strokeScale,s.strokeAlign,a,i,r||this._tester,o)},e}(Yl),Sp=function(t,e,n){return Pl(t,e,n||new Cp)},xp=function(){r[i.LINE_OF_RECTANGLE_ROUNDEDS]=Op,e[i.LINE_OF_RECTANGLE_ROUNDEDS]=Sp,Xn.set(i.LINE_OF_RECTANGLE_ROUNDEDS,Lt.PRIMITIVE|Lt.STROKE_SIDE|Lt.BORDER_RADIUS)},Dp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=t.indices,n=this.vertexOffset,i=this.indexOffset,r=this.pointCountReserved;0<r&&(Vh(e,n,i),ap(e,Fh,i,8,r)),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=t.points;if(e instanceof gp){var n=this.buffer;this.updateVertexStepAndUv(n,t,e),this.updateLineOfAnyColor(n,t,e,Fh)}},e.prototype.updateVertexStepAndUv=function(t,e,n){var i=n.id,r=n.offset,o=r.id,s=i!==this.pointId||o!==this.pointOffsetId,a=n.size,u=a.id,l=u!==this.pointSizeId,h=e.size,c=h.x,p=h.y,f=c!==this.sizeX||p!==this.sizeY,d=$(e),y=this.transformLocalId!==d,g=e.stroke,v=g.align,_=g.enable?g.width:0,m=g.side,b=g.style,T=this.strokeAlign!==v||this.strokeWidth!==_||this.strokeSide!==m||this.strokeStyle!==b,w=tt(e),E=et(w),O=w!==this.texture||E!==this.textureTransformId,C=s||l||f||T,S=!(this.inited&Y.VERTEX_STEP_AND_UV);if(S||C||y||O){this.inited|=Y.VERTEX_STEP_AND_UV,this.pointId=i;var x=n.formatted;this.pointCount=x.length,this.pointOffsetId=o,this.pointSizeId=u,this.transformLocalId=d,this.strokeWidth=_,this.strokeAlign=v,this.strokeSide=m,this.strokeStyle=b,this.texture=w,this.textureTransformId=E,t.updateVertices(),(S||C||y)&&t.updateSteps(),(S||C||O)&&t.updateUvs();var D=this.pointCount,I=x.values,A=this.vertexOffset,R=t.vertices,P=t.steps,M=t.uvs,k=e.transform.internalTransform,L=nt(w);if(0<D&&a.isStaticX()&&a.isStaticY()){var N=a.getX(0),B=a.getY(0);Wh(R,A,0,0,N,B,v,_,k,Hh),hp(R,k,A,Fh,D,I,r),(S||C||y)&&(Kh(A,P,_,m,b,Hh),up(P,A,Fh,D)),(S||C||O)&&(Xh(M,A,L),lp(M,A,Fh,D))}else for(var z=0;z<D;++z){var U=z<<1,j=I[U]+r.getX(z),F=I[U+1]+r.getY(z),H=(N=a.getX(z),B=a.getY(z),A+z*Fh);Wh(R,H,j,F,N,B,v,_,k,Hh),(S||C||y)&&Kh(H,P,_,m,b,Hh),(S||C||O)&&Xh(M,H,L)}var G=this.pointCountReserved,V=A+D*Fh,W=Fh*(G-D);Jc(R,V,W),Qc(P,V,W),$c(M,V,W)}},e}(sp),Ip=function(t,e,n,i,r){return _p(t,e,n,Fh,i,8,0,Dp)},Ap=function(t){function e(e){void 0===e&&(e=i.LINE_OF_RECTANGLES);var n=t.call(this,e)||this;return n._points=new gp(n),n._tester=function(t,e,i,r,o,s,a,u,l,h,c){return n.containsPointAbs(t,e,i,r,o,s,a,u,l,h,c)},n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(t,e,n,i,r,o,s){var a=he(r,o,this._points.size.getLimit());return!!this.containsAbsBBox(t,e,n+a,i+a)&&this._points.calcHitPointAbs(t,e,r,o,s,a,null,this._tester,null)},e.prototype.containsPointAbs=function(e,n,i,r,o,s,a,u,l,h,c){return t.prototype.containsAbs.call(this,e-a-o,n-u-s,i,r,l,h,c)},e.prototype.calcHitPoint=function(t,e,n,i,r,o){var s=this.toHitTestData(t,e),a=(n||he)(s.strokeWidth,s.strokeScale,this._points.size.getLimit());return!!this.containsAbsBBox(s.x,s.y,s.width+a,s.height+a)&&this._points.calcHitPointAbs(s.x,s.y,s.strokeWidth,s.strokeScale,s.strokeAlign,a,i,r||this._tester,o)},e}(Io),Rp=function(t,e,n){return Pl(t,e,n||new Ap)},Pp=function(){r[i.LINE_OF_RECTANGLES]=Ip,e[i.LINE_OF_RECTANGLES]=Rp,Xn.set(i.LINE_OF_RECTANGLES,Lt.PRIMITIVE|Lt.STROKE_SIDE)},Mp=22,kp=15,Lp=[0,0,0,0,0],Np=new t.Point,Bp=function(t,e,n){var i=3*n-1;t[++i]=e+0,t[++i]=e+1,t[++i]=e+3,t[++i]=e+1,t[++i]=e+2,t[++i]=e+3,t[++i]=e+4,t[++i]=e+5,t[++i]=e+7,t[++i]=e+5,t[++i]=e+6,t[++i]=e+7,t[++i]=e+8,t[++i]=e+9,t[++i]=e+11,t[++i]=e+9,t[++i]=e+10,t[++i]=e+11,t[++i]=e+12,t[++i]=e+13,t[++i]=e+16,t[++i]=e+13,t[++i]=e+14,t[++i]=e+16,t[++i]=e+14,t[++i]=e+15,t[++i]=e+16,t[++i]=e+12,t[++i]=e+16,t[++i]=e+19,t[++i]=e+16,t[++i]=e+17,t[++i]=e+19,t[++i]=e+17,t[++i]=e+18,t[++i]=e+19,t[++i]=e+12,t[++i]=e+19,t[++i]=e+13,t[++i]=e+19,t[++i]=e+20,t[++i]=e+13,t[++i]=e+20,t[++i]=e+21,t[++i]=e+13},zp=function(t,e,n,i,r,o,s,a,u,l,h){var c=s*a,p=.5*r+(0<=r?+c:-c),f=.5*o+(0<=o?+c:-c),d=Math.sqrt(p*p+4*f*f),y=2*p*f/(p+d),g=y*u/(2*f),v=.5*(d-y)*u/d,_=g*d/(2*p),m=Np;m.set(n,i-f),l.apply(m,m);var b=m.x,T=m.y;m.set(n,i),l.apply(m,m);var w=m.x,E=m.y;m.set(n+p,i),l.apply(m,m);var C=w-b,S=E-T,x=m.x+C,D=m.y+S,I=w+(w-m.x)+C,A=E+(E-m.y)+S,R=x-b,P=D-T,M=b+v*R,k=T+v*P,L=x-g*R,N=D-g*P,B=_*(I-x),z=_*(A-D),U=x+B,j=D+z,F=I-B,H=A-z,G=b-I,V=T-A,W=I+g*G,K=A+g*V,X=b-v*G,Y=T-v*V;m.set(n,i+f-y),l.apply(m,m);var q=m.x,Z=m.y,J=b+u*(q-b),Q=T+u*(Z-T),$=x+u*(q-x),tt=D+u*(Z-D),et=I+u*(q-I),nt=A+u*(Z-A),it=w+C,rt=E+S;h[0]=O(it,rt,q,Z),h[1]=_,h[2]=g,h[3]=v,h[4]=1-.5*y/f;var ot=2*e-1;t[++ot]=J,t[++ot]=Q,t[++ot]=X,t[++ot]=Y,t[++ot]=b,t[++ot]=T,t[++ot]=M,t[++ot]=k,t[++ot]=$,t[++ot]=tt,t[++ot]=L,t[++ot]=N,t[++ot]=x,t[++ot]=D,t[++ot]=U,t[++ot]=j,t[++ot]=et,t[++ot]=nt,t[++ot]=F,t[++ot]=H,t[++ot]=I,t[++ot]=A,t[++ot]=W,t[++ot]=K,t[++ot]=q,t[++ot]=Z,t[++ot]=J,t[++ot]=Q,t[++ot]=M,t[++ot]=k,t[++ot]=L,t[++ot]=N,t[++ot]=$,t[++ot]=tt,t[++ot]=U,t[++ot]=j,t[++ot]=F,t[++ot]=H,t[++ot]=et,t[++ot]=nt,t[++ot]=W,t[++ot]=K,t[++ot]=X,t[++ot]=Y},Up=function(t,e,n,i,r,o,s){var a=u(i),l=s[0],h=o*l,c=1-o,d=p(0,a,1,1),y=p(1,a,1,1),g=f(0,0),v=f(1,0),_=f(1,1),m=f(0,1),b=f(c,c),T=f(1,c),w=f(c,1),E=f(c,0),O=6*e-1;r&pt.TOP?(t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=g,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=_,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=m,t[++O]=0):(t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=b,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=T,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=_,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=w,t[++O]=0),r&pt.BOTTOM_RIGHT?(t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=g,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=_,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=m,t[++O]=0):(t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=b,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=T,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=_,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=w,t[++O]=0),r&pt.BOTTOM_LEFT?(t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=g,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=_,t[++O]=0,t[++O]=n,t[++O]=y,t[++O]=h,t[++O]=h,t[++O]=m,t[++O]=0):(t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=b,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=T,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=_,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=w,t[++O]=0),t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=g,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=E,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=E,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=E,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=v,t[++O]=0,t[++O]=n,t[++O]=d,t[++O]=l,t[++O]=l,t[++O]=v,t[++O]=0},jp=function(t,e,n,i,r){var o=n.x0,s=n.x1,a=n.x2,u=n.x3,l=n.y0,h=n.y1,c=n.y2,p=n.y3,f=.5*(o+s),d=.5*(l+h),y=r[4],g=f+y*(u-o),v=d+y*(p-l),_=r[1],m=r[2],b=r[3],T=f+b*(u-f),w=d+b*(p-d),E=f+i*(g-f),O=d+i*(v-d),C=f+b*(a-f),S=d+b*(c-d),x=a+m*(f-a),D=c+m*(d-c),I=a+i*(g-a),A=c+i*(v-c),R=a+_*(u-a),P=c+_*(p-c),M=u+_*(a-u),k=p+_*(c-p),L=u+i*(g-u),N=p+i*(v-p),B=u+m*(f-u),z=p+m*(d-p),U=2*e-1;t[++U]=E,t[++U]=O,t[++U]=T,t[++U]=w,t[++U]=f,t[++U]=d,t[++U]=C,t[++U]=S,t[++U]=I,t[++U]=A,t[++U]=x,t[++U]=D,t[++U]=a,t[++U]=c,t[++U]=R,t[++U]=P,t[++U]=L,t[++U]=N,t[++U]=M,t[++U]=k,t[++U]=u,t[++U]=p,t[++U]=B,t[++U]=z,t[++U]=g,t[++U]=v,t[++U]=E,t[++U]=O,t[++U]=C,t[++U]=S,t[++U]=x,t[++U]=D,t[++U]=I,t[++U]=A,t[++U]=R,t[++U]=P,t[++U]=M,t[++U]=k,t[++U]=L,t[++U]=N,t[++U]=B,t[++U]=z,t[++U]=T,t[++U]=w},Fp=function(t){function e(e,n,i,r,o,s,a,u){var l=t.call(this,e,n,i,r,o,s,a,u)||this;return l.radius=0,l.corner=0,l}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=this.vertexOffset,n=this.indexOffset,i=this.pointCountReserved;0<i&&(Bp(t.indices,e,n),ap(t.indices,Mp,n,kp,i)),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=t.points;if(e instanceof gp){var n=this.buffer;this.updateVertexStepAndUv(n,t,e),this.updateLineOfAnyColor(n,t,e,Mp)}},e.prototype.updateVertexStepAndUv=function(t,e,n){var i=n.id,r=n.offset,o=r.id,s=i!==this.pointId||o!==this.pointOffsetId,a=n.size,u=a.id,l=u!==this.pointSizeId,h=e.size,c=h.x,p=h.y,f=c!==this.sizeX||p!==this.sizeY,d=e.radius,y=d!==this.radius,g=$(e),v=this.transformLocalId!==g,_=e.stroke,m=_.align,b=_.enable?_.width:0,T=_.style,w=this.strokeAlign!==m||this.strokeWidth!==b||this.strokeStyle!==T,E=e.corner,O=this.corner!==E,C=tt(e),S=et(C),x=C!==this.texture||S!==this.textureTransformId,D=s||l||f||y||w,I=!(this.inited&Y.VERTEX_STEP_AND_UV);if(I||D||v||O||x){this.inited|=Y.VERTEX_STEP_AND_UV,this.pointId=i;var A=n.formatted;this.pointCount=A.length,this.pointOffsetId=o,this.pointSizeId=u,this.sizeX=c,this.sizeY=p,this.radius=d,this.transformLocalId=g,this.strokeAlign=m,this.strokeWidth=b,this.strokeStyle=T,this.corner=E,this.texture=C,this.textureTransformId=S,t.updateVertices(),(I||D||v||O)&&t.updateSteps(),(I||D||x)&&t.updateUvs();var R=this.pointCount,P=A.values,M=this.vertexOffset,k=t.vertices,L=t.steps,N=t.uvs,B=e.transform.internalTransform,z=nt(C);if(0<R&&a.isStaticX()&&a.isStaticY()){var U=a.getX(0),j=a.getY(0);zp(k,M,0,0,U,j,m,b,d,B,Lp),hp(k,B,M,Mp,R,P,r),(I||D||v||O)&&(Up(L,M,b,T,E,d,Lp),up(L,M,Mp,R)),(I||D||x)&&(jp(N,M,z,d,Lp),lp(N,M,Mp,R))}else for(var F=0;F<R;++F){var H=F<<1,G=P[H]+r.getX(F),V=P[H+1]+r.getY(F),W=(U=a.getX(F),j=a.getY(F),M+F*Mp);zp(k,W,G,V,U,j,m,b,d,B,Lp),(I||D||v||O)&&Up(L,W,b,T,E,d,Lp),(I||D||x)&&jp(N,W,z,d,Lp)}var K=this.pointCountReserved,X=M+R*Mp,q=Mp*(K-R);Jc(k,X,q),Qc(L,X,q),$c(N,X,q)}},e}(sp),Hp=function(t,e,n,i,r){return _p(t,e,n,Mp,i,kp,0,Fp)},Gp=function(t,e,n,i,r,o,s,a,u,l,h,c,p,f,d,y,g){var v=o+c*(a-o)-i,_=s+c*(u-s)-r,m=Math.sqrt(v*v+_*_),b=1e-5;if(b<m){var T=1/m,w=v*T,E=_*T,O=(o+p*(l-o)-i)*T,C=(s+p*(h-s)-r)*T,S=w*C-O*E;if(b<Math.abs(S)){var x=1/S,D=e-i,I=n-r;if(function(t,e,n,i,r,o,s){if(t.fill.enable){if(e*e+n*n<=i*i)return!0}else if(0<o){var a=e*e+n*n;if(a<=i*i){var u=Math.max(0,i*(1-o*s/r));if(u*u<=a)return!0}}return!1}(t,(+C*D-O*I)*x,(-E*D+w*I)*x,m,f*d,y,g))return!0}}return!1},Vp=function(t,e,n,i,r,o,s){var a=2*r/i;if(ue(e,n,a,-r,+r)){var u=Math.sqrt(i*i+4*r*r),l=2*i*r/(i+u),h=t.radius,c=r-l,p=-r,f=+i,d=+r,y=-f,g=+d,v=0+0*h,_=p+h*(c-p),m=f+h*(0-f),b=d+h*(c-d),T=+b,w=-m,E=-a*e+_-n<=0,O=+a*e+_-n<=0,C=n<=b,S=t.corner;if(!E&&!O&&S&pt.TOP){var x=.5*(u-l)*h/u;if(Gp(t,e,n,v,_,0,p,y,g,f,d,x,x,l,h,o,s))return!0}else if(!E&&!C&&S&pt.BOTTOM_LEFT){if(Gp(t,e,n,w,T,y,g,f,d,0,p,(D=l*h/(2*r))*u/(2*i),D,l,h,o,s))return!0}else if(!O&&!C&&S&pt.BOTTOM_RIGHT){var D;if(Gp(t,e,n,m,b,f,d,0,p,y,g,D=l*h/(2*r),D*u/(2*i),l,h,o,s))return!0}else{if(t.fill.enable)return!0;if(0<o){var I=o*s,A=r-l,R=A+(-r-A)*Math.max(0,l-I)/l;if(!ue(e,n,a,R,r-I))return!0}}}return!1},Wp=function(t){function e(e){return void 0===e&&(e=i.TRIANGLE_ROUNDED),t.call(this,e)||this}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(e,n,i,r,o,s,a){return!!t.prototype.containsAbsBBox.call(this,e,n,i,r)&&Vp(this,e,n,i,r,o,s)},e}(oe),Kp=function(t){function e(e){void 0===e&&(e=i.LINE_OF_TRIANGLE_ROUNDEDS);var n=t.call(this,e)||this;return n._points=new gp(n),n._tester=function(t,e,i,r,o,s,a,u,l,h,c){return n.containsPointAbs(t,e,i,r,o,s,a,u,l,h,c)},n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(t,e,n,i,r,o,s){var a=he(r,o,this._points.size.getLimit());return!!this.containsAbsBBox(t,e,n+a,i+a)&&this._points.calcHitPointAbs(t,e,r,o,s,a,null,this._tester,null)},e.prototype.containsPointAbs=function(e,n,i,r,o,s,a,u,l,h,c){return t.prototype.containsAbs.call(this,e-a-o,n-u-s,i,r,l,h,c)},e.prototype.calcHitPoint=function(t,e,n,i,r,o){var s=this.toHitTestData(t,e),a=(n||he)(s.strokeWidth,s.strokeScale,this._points.size.getLimit());return!!this.containsAbsBBox(s.x,s.y,s.width+a,s.height+a)&&this._points.calcHitPointAbs(s.x,s.y,s.strokeWidth,s.strokeScale,s.strokeAlign,a,i,r||this._tester,o)},e}(Wp),Xp=function(t,e,n){return Pl(t,e,n||new Kp)},Yp=function(){r[i.LINE_OF_TRIANGLE_ROUNDEDS]=Hp,e[i.LINE_OF_TRIANGLE_ROUNDEDS]=Xp,Xn.set(i.LINE_OF_TRIANGLE_ROUNDEDS,Lt.PRIMITIVE|Lt.STROKE_SIDE|Lt.BORDER_RADIUS)},qp=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=t.indices,n=this.vertexOffset,i=this.indexOffset,r=this.pointCountReserved;0<r&&(Ih(e,n,i),ap(e,7,i,3,r)),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=t.points;if(e instanceof gp){var n=this.buffer;this.updateVertexStepAndUvs(n,t,e),this.updateLineOfAnyColor(n,t,e,7)}},e.prototype.updateVertexStepAndUvs=function(t,e,n){var i=n.id,r=n.offset,o=r.id,s=i!==this.pointId||o!==this.pointOffsetId,a=n.size,u=a.id,l=u!==this.pointSizeId,h=e.size,c=h.x,p=h.y,f=c!==this.sizeX||p!==this.sizeY,d=$(e),y=this.transformLocalId!==d,g=e.stroke,v=g.align,_=g.enable?g.width:0,m=g.style,b=this.strokeAlign!==v||this.strokeWidth!==_||this.strokeStyle!==m,T=tt(e),w=et(T),E=T!==this.texture||w!==this.textureTransformId,O=s||l||f||b,C=!(this.inited&Y.VERTEX_STEP_AND_UV);if(C||O||y||E){this.inited|=Y.VERTEX_STEP_AND_UV,this.pointId=i;var S=n.formatted;this.pointCount=S.length,this.pointOffsetId=o,this.pointSizeId=u,this.sizeX=c,this.sizeY=p,this.transformLocalId=d,this.strokeAlign=v,this.strokeWidth=_,this.strokeStyle=m,this.texture=T,this.textureTransformId=w,t.updateVertices(),(C||O||y)&&t.updateSteps(),(C||O||E)&&t.updateUvs();var x=this.pointCount,D=S.values,I=this.vertexOffset,A=t.vertices,R=t.steps,P=t.uvs,M=nt(T),k=e.transform.internalTransform;if(0<x&&a.isStaticX()&&a.isStaticY()){var L=a.getX(0),N=a.getY(0);Ah(A,I,0,0,L,N,v,_,k,xh),hp(A,k,I,7,x,D,r),(C||O||y)&&(Rh(R,I,_,m,xh),up(R,I,7,x)),(C||O||E)&&(Ph(P,M,I,xh),lp(P,I,7,x))}else for(var B=0;B<x;++B){var z=B<<1,U=D[z]+r.getX(B),j=D[z+1]+r.getY(B),F=(L=a.getX(B),N=a.getY(B),I+7*B);Ah(A,F,U,j,L,N,v,_,k,xh),(C||O||y)&&Rh(R,F,_,m,xh),(C||O||E)&&Ph(P,M,F,xh)}var H=I+7*x,G=7*(this.pointCountReserved-x);Jc(A,H,G),Qc(R,H,G),$c(P,H,G)}},e}(sp),Zp=function(t,e,n,i,r){return _p(t,e,n,7,i,3,0,qp)},Jp=function(t){function e(e){return void 0===e&&(e=i.TRIANGLE),t.call(this,e)||this}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(e,n,i,r,o,s,a){return!!t.prototype.containsAbsBBox.call(this,e,n,i,r)&&le(this,e,n,i,r,o,s)},e}(oe),Qp=function(t){function e(e){void 0===e&&(e=i.LINE_OF_TRIANGLES);var n=t.call(this,e)||this;return n._points=new gp(n),n._tester=function(t,e,i,r,o,s,a,u,l,h,c){return n.containsPointAbs(t,e,i,r,o,s,a,u,l,h,c)},n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(t,e,n,i,r,o,s){var a=he(r,o,this._points.size.getLimit());return!!this.containsAbsBBox(t,e,n+a,i+a)&&this._points.calcHitPointAbs(t,e,r,o,s,a,null,this._tester,null)},e.prototype.containsPointAbs=function(e,n,i,r,o,s,a,u,l,h,c){return t.prototype.containsAbs.call(this,e-a-o,n-u-s,i,r,l,h,c)},e.prototype.calcHitPoint=function(t,e,n,i,r,o){var s=this.toHitTestData(t,e),a=(n||he)(s.strokeWidth,s.strokeScale,this._points.size.getLimit());return!!this.containsAbsBBox(s.x,s.y,s.width+a,s.height+a)&&this._points.calcHitPointAbs(s.x,s.y,s.strokeWidth,s.strokeScale,s.strokeAlign,a,i,r||this._tester,o)},e}(Jp),$p=function(t,e,n){return Pl(t,e,n||new Qp)},tf=function(){r[i.LINE_OF_TRIANGLES]=Zp,e[i.LINE_OF_TRIANGLES]=$p},ef=function(t,e,n,i){return new o(t,n,i,0,0,[new jh(t,n,i)]).init(e)},nf=function(t){function e(e){return void 0===e&&(e=i.NULL),t.call(this,e)||this}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e}(oe),rf=function(t,e,n){return Pl(t,e,n||new nf)},of=function(){r[i.NULL]=ef,e[i.NULL]=rf},sf=function(t,e,n,i){for(var r=3*i-1,o=0,s=e.length;o<s;++o)t[++r]=n+e[o]},af=function(t,e,n,i){for(var r=i.a,o=i.b,s=i.c,a=i.d,u=i.tx,l=i.ty,h=(n<<1)-1,c=0,p=e.length;c<p;c+=2){var f=e[c],d=e[c+1];t[++h]=r*f+s*d+u,t[++h]=o*f+a*d+l}},uf=function(t,e,n,i,r,o,s,l,h,c,f,d,y){var g=u(y),v=a(y),_=p(7+v,g,(d&Z.ALL)===Z.ALL?1:0,0),m=Math.max(0,Math.min(1,c));switch(h){case J.TOP:hf(t,e,n,i,r,s,l,f,_,o[3]-o[1],m);break;case J.RIGHT:lf(t,e,n,i,r,s,l,f,_,o[0]-o[2],1-m);break;case J.BOTTOM:hf(t,e,n,i,r,s,l,f,_,o[1]-o[3],1-m);break;case J.LEFT:lf(t,e,n,i,r,s,l,f,_,o[2]-o[0],m)}},lf=function(t,e,n,i,r,o,s,a,u,l,h){for(var c=6*o-1,p=0,d=0;p<s;p+=1,d+=2)t[++c]=a,t[++c]=u,t[++c]=e[p],t[++c]=l*(h-r[d]),t[++c]=f(i[p],0),t[++c]=n[p]},hf=function(t,e,n,i,r,o,s,a,u,l,h){for(var c=6*o-1,p=0,d=1;p<s;p+=1,d+=2)t[++c]=a,t[++c]=u,t[++c]=e[p],t[++c]=l*(h-r[d]),t[++c]=f(i[p],0),t[++c]=n[p]},cf=function(t,e,n,i){for(var r=i.x0,o=i.x1,s=i.y0,a=o-r,u=i.y3-s,l=(n<<1)-1,h=0,c=e.length;h<c;h+=2)t[++l]=r+e[h]*a,t[++l]=s+e[h+1]*u},pf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newStyle=function(){return X.CLOSED},e}(Li),ff=function(){function t(t){this.points=[],this.normals=[],this.epsilon=t}return t.prototype.isCw=function(){for(var t=0,e=this.points,n=e.length,i=e[n-2],r=e[n-1],o=0;o<n;o+=2){var s=e[o],a=e[o+1];t+=i*a-s*r,i=s,r=a}return 0<t},t.prototype.merge=function(){var t=this.points,e=t.length;if(e<=2)return!1;for(var n=this.epsilon,i=this.normals,r=new Set,o=t[0],s=t[1],a=0,u=2;u<e;u+=2){var l=t[u],h=t[u+1],c=l-o,p=h-s;Math.abs(c)<=n&&Math.abs(p)<=n?(i[a]=i[u],i[a+1]=i[u+1],r.add(u)):(o=l,s=h,a=u)}if(0!==a&&(c=t[a]-t[0],p=t[a+1]-t[1],Math.abs(c)<n&&Math.abs(p)<n&&r.add(a)),0<r.size){var f=0;for(u=0;u<e;u+=2,f+=2)r.has(u)?f-=2:u!==f&&(t[f]=t[u],t[f+1]=t[u+1],i[f]=i[u],i[f+1]=i[u+1]);return f<e&&(t.length=f,i.length=f),!0}return!1},t.prototype.cut=function(t){for(var e=this.points,n=e.length,i=e[n-2],r=e[n-1],o=n-2,s=i,a=r,u=0;u<n;u+=2){if(s=e[u],a=e[u+1],this.cut0(o,i,r,s,a,t))return!0;i=s,r=a,o=u}return t.push(this),!1},t.prototype.cut0=function(e,n,i,r,o,s){for(var a,u=null!==(a=t.WORK)&&void 0!==a?a:t.WORK=[0,0,0,0],l=this.points,h=this.normals,c=l.length,p=l[c-2],f=l[c-1],d=h[c-2],y=h[c-1],g=c-2,v=p,_=f,m=d,b=y,T=0;T<c;T+=2){if(v=l[T],_=l[T+1],m=h[T],b=h[T+1],g!==e&&g!==(e+2)%c&&g!==(c+e-2)%c&&this.check0(n,i,r,o,p,f,v,_,d,y,u)){var w=-d,E=y*(n-p)+w*(i-f),O=y*(r-p)+w*(o-f)-E,C=y*(v-p)+w*(_-f);if(this.check1(u,E,O,C,n,i,r,o,u)){var S=u[0],x=u[1],D=u[2],I=u[3];return e<g?(this.cut1(e+2,g,D,I,l,h,s),this.cut2(0,e,g+2,c-2,S,x,l,h,s)):(this.cut1(g+2,e,S,x,l,h,s),this.cut2(0,g,e+2,c-2,D,I,l,h,s)),!0}}p=v,f=_,d=m,y=b,g=T}return!1},t.prototype.check1=function(t,e,n,i,r,o,s,a,u){if(1===t[0]){var l=t[1];if(this.check2(e+l*n,i)){var h=r+l*(d=s-r),c=o+l*(y=a-o);return u[0]=h,u[1]=c,u[2]=h,u[3]=c,!0}}else if(2===t[0]){var p=t[1],f=t[2];if(this.check2(e+p*n,i)||this.check2(e+f*n,i)){var d,y,g=r+p*(d=s-r),v=o+p*(y=a-o),_=r+f*d,m=o+f*y;return u[0]=g,u[1]=v,u[2]=_,u[3]=m,!0}}return!1},t.prototype.check2=function(t,e){return Math.abs(t)<this.epsilon||Math.abs(t-e)<this.epsilon||0<=t&&t<=e},t.prototype.check0=function(t,e,n,i,r,o,s,a,u,l,h){var c=t-r,p=e-o,f=n-r,d=i-o,y=u*c+l*p,g=u*f+l*d,v=y-g,_=this.epsilon;if(_<Math.abs(v)){var m=y/v;if(0<=m&&m<=1)return h[0]=1,h[1]=m,!0}else if((0<=y&&0<=g||y<=0&&g<=0)&&(Math.abs(y)<_||Math.abs(g)<_)||0<=y&&g<=0||y<=0&&0<=g){var b=l,T=-u,w=b*c+T*p,E=w-(b*f+T*d);if(!(_<Math.abs(E)))return h[0]=2,h[1]=0,h[2]=1,!0;var O=b*(s-r)+T*(a-o),C=Math.max(0,w/E),S=Math.min(1,(w-O)/E);if(C<=S)return h[0]=2,h[1]=C,h[2]=S,!0}return!1},t.prototype.cut1=function(e,n,i,r,o,s,a){if(2<=n-e+2){var u=new t(this.epsilon),l=u.points,h=u.normals;l.push(i,r);var c=o[e]-i,p=o[e+1]-r,f=Math.sqrt(c*c+p*p);if(0<f){var d=c*(_=1/f),y=p*_;h.push(-y,d)}else h.push(s[e],s[e+1]);for(var g=e;g<=n;g+=2)l.push(o[g],o[g+1]),h.push(s[g],s[g+1]);var v=l.length;if(2<v){var _,m=l[0]-l[v-2],b=l[1]-l[v-1],T=Math.sqrt(m*m+b*b);0<T?(d=m*(_=1/T),y=b*_,h[v-2]=-y,h[v-1]=d):(h[v-2]=h[0],h[v-1]=h[1])}u.merge(),u.cut(a)}},t.prototype.cut2=function(e,n,i,r,o,s,a,u,l){if(2<=Math.max(0,n-e+2)+Math.max(0,r-i+2)){for(var h=new t(this.epsilon),c=h.points,p=h.normals,f=e;f<=n;f+=2)c.push(a[f],a[f+1]),p.push(u[f],u[f+1]);c.push(o,s);var d=i<=r?i:e,y=a[d]-o,g=a[d+1]-s,v=Math.sqrt(y*y+g*g);if(0<v){var _=y*(T=1/v),m=g*T;p.push(-m,_)}else p.push(u[d],u[d+1]);for(f=i;f<=r;f+=2)c.push(a[f],a[f+1]),p.push(u[f],u[f+1]);var b=c.length;if(2<b){var T,w=n-e,E=(w+2)%b,O=c[E]-c[w],C=c[E+1]-c[w+1],S=Math.sqrt(O*O+C*C);0<S?(_=O*(T=1/S),m=C*T,p[w]=-m,p[w+1]=_):(p[w]=p[E],p[w+1]=p[E+1])}h.merge(),h.cut(l)}},t.from=function(e,n){void 0===n&&(n=1e-5);var i=e.length;if(i<=0)return[];for(var r=new t(n),o=r.points,s=r.normals,a=e[0],u=e[1],l=i-2;0<=l;l-=2){var h=e[l],c=e[l+1],p=a-h,f=u-c;if(!(Math.abs(p)<=n&&Math.abs(f)<n)){var d=1/Math.sqrt(p*p+f*f),y=p*d,g=f*d;s.unshift(-g,y),o.unshift(h,c),a=h,u=c}}o.length<=0&&(o.push(a,u),s.push(0,1));var v=[];return r.cut(v),v},t}(),df=function(){function t(t,e,n){this.parent=t,this.distance=e,this.points=[],this.normals=[],this.mappings=[],this.rmappings=[],this.bridges=[],this.children=[],this.epsilon=n}return t.prototype.advance=function(){var t=this.points,e=t.length;if(e<=4)return!1;for(var n=this.epsilon,i=[],r=this.normals,o=r[e-2],s=r[e-1],a=0;a<e;a+=2){var u=r[a],l=r[a+1],h=l,c=-u,p=h*o+c*s,f=u*o+l*s,d=0<Math.abs(p)?(1-f)/p:0<=f?-.5*p:0,y=u+d*h,g=l+d*c;i.push(y,g),o=u,s=l}var v=0,_=-1,m=t[e-2],b=t[e-1],T=i[e-2],w=i[e-1],E=r[e-2],O=r[e-1];for(a=0;a<e;a+=2){var C=r[a],S=r[a+1],x=S,D=-C,I=i[a],A=i[a+1],R=t[a],P=t[a+1],M=R-m,k=P-b,L=I-T,N=A-w,B=C*L+S*N;if(n<Math.abs(B)){if(0<=(lt=(j=C*M+S*k)/B)&&(_<0||lt<v)){var z=x*M+D*k,U=x*L+D*N;Math.abs(z-lt*U)<n&&(v=lt,_=a)}}else if(z=x*M+D*k,U=x*L+D*N,n<Math.abs(U)){if(0<=(lt=z/U)&&(_<0||lt<v)){var j=C*M+S*k;Math.abs(j-lt*B)<n&&(v=lt,_=a)}}else Math.abs(z)<n&&(j=C*M+S*k,Math.abs(j)<n&&0<=(lt=0)&&(_<0||lt<v)&&(v=lt,_=a));if(0<=x*E+O*D)for(var F=0;F<e;F+=2)if(F!==a&&F!==(e+a-2)%e){var H=t[F],G=t[F+1],V=r[F],W=r[F+1],K=W,X=-V,Y=i[F],q=i[F+1],Z=R-H,J=P-G,Q=I-Y,$=A-q,tt=V*Q+W*$;if(n<Math.abs(tt)){if(0<=(lt=(at=V*Z+W*J)/tt)&&(_<0||lt<v)){var et=(it=K*Z+X*J)-lt*(ot=K*Q+X*$);n<=et&&et-((rt=K*(t[nt=(F+2)%e]-H)+X*(t[nt+1]-G))-lt*(st=K*(i[nt]-Y)+X*(i[nt+1]-q)))<n&&(v=lt,_=a)}}else{var nt,it=K*Z+X*J,rt=K*(t[nt=(F+2)%e]-H)+X*(t[nt+1]-G),ot=K*Q+X*$,st=K*(i[nt]-Y)+X*(i[nt+1]-q);if(n<Math.abs(ot)){if(0<=(lt=it/ot)&&(_<0||lt<v)){var at=V*Z+W*J;Math.abs(at-lt*tt)<n&&(v=lt,_=a)}}else Math.abs(it)<n&&(at=V*Z+W*J,Math.abs(at)<n&&0<=(lt=0)&&(_<0||lt<v)&&(v=lt,_=a));var ut=ot-st;if(n<Math.abs(ut))0<=(lt=(it-rt)/ut)&&(_<0||lt<v)&&(at=V*Z+W*J,Math.abs(at-lt*tt)<n&&(v=lt,_=a));else if(Math.abs(it-rt)<n){var lt;at=V*Z+W*J,Math.abs(at)<n&&0<=(lt=0)&&(_<0||lt<v)&&(v=lt,_=a)}}}T=I,w=A,m=R,b=P,E=C,O=S}if(0<=_&&0<v){for(this.distance+=v,a=0;a<e;a+=2)t[a]-=v*i[a],t[a+1]-=v*i[a+1];return this.merge(),!0}return!1},t.prototype.next=function(){var t=this.points.length,e=this.children;if(t<=4)return e;e.length=0,this.cut(e);for(var n=e.length-1;0<=n;--n)e[n].advance()||e.splice(n,1);return e},t.prototype.merge=function(){var e=this.points,n=e.length;if(n<=2)return!1;for(var i=this.epsilon,r=t.EMPTY_ARRAY,o=this.normals,s=this.mappings,a=this.bridges,u=0,l=e[0],h=e[1],c=0,p=2;p<n;p+=2){var f=e[p],d=e[p+1],y=f-l,g=d-h;Math.abs(y)<=i&&Math.abs(g)<=i?(s[c]=s[c+1]=s[c].concat(s[p]),s[p]=s[p+1]=r,o[c]=o[p],o[c+1]=o[p+1],u+=1):(l=f,h=d,c=p)}if(0!==c&&(y=e[c]-e[0],g=e[c+1]-e[1],Math.abs(y)<i&&Math.abs(g)<i&&(s[0]=s[1]=s[c].concat(s[0]),s[c]=s[c+1]=r,u+=1)),0<u){var v=0;for(p=0;p<n;p+=2,v+=2)s[p].length<=0?v-=2:p!==v&&(e[v]=e[p],e[v+1]=e[p+1],o[v]=o[p],o[v+1]=o[p+1],s[v]=s[p],s[v+1]=s[p+1]);return v<n&&(e.length=v,o.length=v,s.length=v,a.length=v),!0}return!1},t.prototype.insert=function(e,n,i){var r=this.points,o=r.length,s=(e+2)%o,a=r[e],u=r[e+1],l=r[s],h=r[s+1];r.splice(e+2,0,a+n*(l-a),u+n*(h-u));var c=this.normals,p=c[e],f=c[e+1];c.splice(e+2,0,p,f);for(var d=this.bridges,y=0;y<o;y+=2){var g=d[y];e<g&&(d[y]=g+2)}d.splice(e+2,0,-1,-1);var v=this.mappings,_=v[e],m=_.length,b=this.parent;if(b&&0<m){var T=_[m-1];for(y=0;y<o;y+=2)v[y]=v[y+1]=this.toMappingShifted(T,v[y]);var w=[T+2];v.splice(e+2,0,w,w),b.insert(T,n,this)}else{var E=t.EMPTY_ARRAY;v.splice(e+2,0,E,E)}var O=this.children,C=O.length;for(y=0;y<C;++y){var S=O[y];if(S!==i)for(var x=S.mappings,D=x.length,I=0;I<D;I+=2)x[I]=x[I+1]=this.toMappingShifted(e,x[I])}},t.prototype.toMappingShifted=function(t,e){for(var n=e.length,i=0;i<n;++i)if(t<e[i]){for(var r=[],o=0;o<n;++o){var s=e[o];r.push(t<s?s+2:s)}return r}return e},t.prototype.cut=function(e){for(var n=this.points,i=n.length,r=this.normals,o=this.bridges,s=this.epsilon,a=0;a<i;a+=2)for(var u=n[a],l=n[a+1],h=0;h<i;h+=2)if(h!==a&&h!==(i+a-2)%i){var c=n[h],p=n[h+1],f=r[h],d=r[h+1],y=u-c,g=l-p,v=f*y+d*g;if(Math.abs(v)<s){var _=-f,m=(A=d)*y+_*g;if(Math.abs(m)<s){o[a]=h,o[h]=a;break}var b=(h+2)%i,T=A*(n[b]-c)+_*(n[b+1]-p);if(Math.abs(m-T)<s)o[a]=b,o[b]=a;else if(0<=m&&m<=T){Math.abs(T)<s?m<=.5*T?(o[a]=h,o[h]=a):(o[a]=b,o[b]=a):(this.insert(h,m/T,null),h+2<=a&&(a+=2),i+=2,o[a]=h+2,o[h+2]=a);break}}}for(var w=0;w<i;w+=2){var E=o[w];if(0<=E&&w<E){var O=new t(this,this.distance,s),C=O.points,S=O.normals,x=O.mappings,D=O.bridges;for(a=w;a<i;a+=2){C.push(n[a],n[a+1]),S.push(r[a],r[a+1]);var I=[a];if(x.push(I,I),D.push(-1,-1),w<a&&0<=(h=o[a])){if(!(a<h))break;C.push(n[h],n[h+1]),S.push(r[h],r[h+1]);var A=[h];x.push(A,A),D.push(-1,-1),a=h}}O.merge(),e.push(O)}}var R=new t(this,this.distance,s),P=R.points,M=R.normals,k=R.mappings,L=R.bridges;for(a=0;a<i;a+=2)if(P.push(n[a],n[a+1]),M.push(r[a],r[a+1]),I=[a],k.push(I,I),L.push(-1,-1),0<=(h=o[a])){if(!(a<h))break;P.push(n[h],n[h+1]),M.push(r[h],r[h+1]),A=[h],k.push(A,A),L.push(-1,-1),a=h}return R.merge(),e.push(R),!0},t.from=function(e,n){var i=new t(null,0,n),r=e.points,o=r.length;if(o<=0)return i;var s=e.normals,a=i.points,u=i.normals,l=i.mappings,h=i.bridges,c=t.EMPTY_ARRAY;if(e.isCw())for(var p=o-2;0<=p;p-=2){var f=(o+p-2)%o;u.push(-s[f],-s[f+1]),a.push(r[p],r[p+1]),l.push(c,c),h.push(-1,-1)}else for(p=0;p<o;p+=2)u.push(s[p],s[p+1]),a.push(r[p],r[p+1]),l.push(c,c),h.push(-1,-1);return i},t.EMPTY_ARRAY=[],t}(),yf=function(){function t(){}return t.from=function(t,e,n){void 0===e&&(e=-1),void 0===n&&(n=1e-5);for(var i=[],r=ff.from(t,n),o=0,s=r.length;o<s;++o){var a=df.from(r[o],n);(e<0||0<e)&&this.next(a,e),this.map(a),i.push(a)}return i},t.next=function(t,e){var n=t.next();if((e-=1)<0||0<e){var i=n.length;if(0<i)for(var r=0;r<i;++r)this.next(n[r],e)}},t.map=function(t){for(var e=t.points.length,n=t.rmappings,i=0;i<e;i+=2)n.push([],[]);var r=t.children,o=r.length;for(i=0;i<o;++i){for(var s=r[i],a=s.mappings,u=a.length,l=0;l<u;l+=2)for(var h=a[l],c=h.length,p=0;p<c;++p){var f=h[p];n[f].push(i),n[f+1].push(l)}this.map(s)}},t}(),gf=function(){function e(){this._vertices=[],this._distances=[],this._lengths=[],this._clippings=[],this._indices=[],this._ivs=new Map}return e.prototype.addVertex=function(t,e,n){var i=this._ivs.get(t);if(null==i){var r=this.addVertexAt(t,e,n);(s=new Map).set(n,r);var o=new Map;return o.set(e,s),this._ivs.set(t,o),r}var s,a=i.get(e);if(null==a)return r=this.addVertexAt(t,e,n),(s=new Map).set(n,r),i.set(e,s),r;if(null==(r=a.get(n))){var u=this.addVertexAt(t,e,n);return a.set(n,u),u}return r},e.prototype.addVertexAt=function(t,e,n){var i=this._vertices,r=i.length>>1,o=t.points;i.push(o[e],o[e+1]);var s=t.distance;return this._distances.push(s),this._lengths.push(n),r},e.prototype.addWavefront=function(t){if(null==t.parent){var e=this._distances,n=e.length,i=t.points,r=i.length;if(4<r)for(var o=t.normals,s=0,a=0;a<r;a+=2){var u=(a+2)%r,l=i[a],h=i[a+1],c=i[u]-l,p=i[u+1]-h,f=c*c+p*p,d=o[a],y=s+(c*o[a+1]+p*-d),g=0,v=0;if(0<f){var _=1/f;g=c*_,v=p*_}this.addEdge(t,a,u,s,y,l,h,g,v),s=y}var m=e.length;if(!(m<=n)){for(var b=e[n],T=n+1;T<m;++T)b=Math.max(b,e[T]);var w=this._clippings;if(0<b){var E=1/b;for(T=n;T<m;++T)w.push(1-e[T]*E),e[T]=E}else for(T=n;T<m;++T)w.push(1),e[T]=b}}},e.prototype.addWavefrontAll=function(t){for(var e=t.length,n=0;n<e;++n)this.addWavefront(t[n]);return this},e.prototype.calcLength=function(t,e,n,i,r,o,s,a){var u=t.points,l=(u[e]-r)*s+(u[e+1]-o)*a;return(1-l)*n+l*i},e.prototype.addEdge=function(t,e,n,i,r,o,s,a,u){for(var l=[],h=[t,t],c=[],p=[e,n],f=[],d=[i,r],y=[0,0,0];;){var g=this.findEdgeNext(t,e,n,y);if(g[0]<0)break;if(t=t.children[g[0]],(e=g[1])===(n=g[2])){(t.children.length<=0||2<=t.mappings[n].length||0<=t.bridges[n])&&(h.push(t),p.push(n),d.push(this.calcLength(t,n,i,r,o,s,a,u)));break}(t.children.length<=0||2<=t.mappings[e].length||0<=t.bridges[e])&&(l.push(t),c.push(e),f.push(this.calcLength(t,e,i,r,o,s,a,u))),(t.children.length<=0||2<=t.mappings[n].length||0<=t.bridges[n])&&(h.push(t),p.push(n),d.push(this.calcLength(t,n,i,r,o,s,a,u)))}for(var v=l.length-1;0<=v;--v)h.push(l[v]),p.push(c[v]),d.push(f[v]);this.triangulate(h,p,d)},e.prototype.findEdgeNext=function(t,e,n,i){var r=t.rmappings,o=r[e],s=r[e+1],a=r[n],u=r[n+1];i[0]=-1;for(var l=0;l<o.length;++l)for(var h=0;h<a.length;++h)if(o[l]===a[h]){if(!(i[0]<0))return i[0]=-1,i;i[0]=o[l],i[1]=s[l],i[2]=u[h]}return i},e.prototype.triangulate=function(e,n,i){var r=e.length;if(3===r)this._indices.push(this.addVertex(e[0],n[0],i[0]),this.addVertex(e[1],n[1],i[1]),this.addVertex(e[2],n[2],i[2]));else if(3<r){for(var o=[],s=[],a=this._vertices,u=0;u<r;++u){var l=this.addVertex(e[u],n[u],i[u]);o.push(l);var h=l<<1;s.push(a[h],a[h+1])}var c=t.utils.earcut(s),p=c.length;for(u=0;u<p;u+=3)this._indices.push(o[c[u]],o[c[u+1]],o[c[u+2]])}},e.prototype.build=function(){return this._ivs.clear(),new vf(this._vertices,this._distances,this._lengths,this._clippings,this._indices)},e}(),vf=function(){function t(t,e,n,i,r){this.vertices=t,this.distances=e,this.lengths=n,this.clippings=i,this.indices=r}return t.from=function(t){return(new gf).addWavefrontAll(t).build()},t}(),_f=function(){function t(t){this._id=0,this._parent=t,this._parentPointsId=-1,this._vertices=[],this._nvertices=0,this._distances=[],this._lengths=[],this._clippings=[],this._uvs=[],this._indices=[],this._nindices=0,this._boundary=[0,0,0,0]}return Object.defineProperty(t.prototype,"id",{get:function(){return this.triangulate(),this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"vertices",{get:function(){return this.triangulate(),this._vertices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nvertices",{get:function(){return this.triangulate(),this._nvertices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"distances",{get:function(){return this.triangulate(),this._distances},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lengths",{get:function(){return this.triangulate(),this._lengths},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"clippings",{get:function(){return this.triangulate(),this._clippings},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"uvs",{get:function(){return this.triangulate(),this._uvs},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"indices",{get:function(){return this.triangulate(),this._indices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nindices",{get:function(){return this.triangulate(),this._nindices},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"boundary",{get:function(){return this.triangulate(),this._boundary},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e,n,i,r,o,s,a){var u=!1;if(null!=t&&(this._parentPointsId=t,u=!0),null!=e){for(var l=e.length,h=0;h<l;++h)this._vertices[h]=e[h];this._vertices.length!==l&&(this._vertices.length=l),this._nvertices=l>>1,u=!0}if(null!=n){var c=n.length;for(h=0;h<c;++h)this._distances[h]=n[h];this._distances.length!==c&&(this._distances.length=c),u=!0}if(null!=i){var p=i.length;for(h=0;h<p;++h)this._lengths[h]=i[h];this._lengths.length!==p&&(this._lengths.length=p),u=!0}if(null!=r){var f=r.length;for(h=0;h<f;++h)this._clippings[h]=r[h];this._clippings.length!==f&&(this._clippings.length=f),u=!0}if(null!=o){var d=o.length;for(h=0;h<d;++h)this._uvs[h]=o[h];this._uvs.length!==d&&(this._uvs.length=d),u=!0}if(null!=s){var y=s.length;for(h=0;h<y;++h)this._indices[h]=s[h];this._indices.length!==y&&(this._indices.length=y),this._nindices=y/3,u=!0}return null!=a&&(this._boundary[0]=a[0],this._boundary[1]=a[1],this._boundary[2]=a[2],this._boundary[3]=a[3],u=!0),u&&(this._id+=1),this},t.prototype.triangulate=function(){var t=this._parent.points,e=t.id;if(this._parentPointsId!==e){this._parentPointsId=e;var n=vf.from(yf.from(t.formatted.values));this._id+=1;var i=n.vertices;this._vertices=i,this._nvertices=n.vertices.length>>1,this._distances=n.distances,this._lengths=n.lengths,this._clippings=n.clippings;var r=this._boundary;yi(i,r),this._uvs=this.toUvs(i,r),this._indices=n.indices,this._nindices=n.indices.length/3}},t.prototype.toUvs=function(t,e){for(var n=[],i=e[0],r=e[1],o=e[2]-i,s=e[3]-r,a=0<o?1/o:0,u=0<s?1/s:0,l=t.length,h=0;h<l;h+=2)n.push((t[h]-i)*a,(t[h+1]-r)*u);return n},t.prototype.copy=function(t){return this.set(this._parent.points.id,t.vertices,t.distances,t.lengths,t.clippings,t.uvs,t.indices,t.boundary),this},t.prototype.serialize=function(t){this.triangulate();var e=[t.addResource(JSON.stringify(this._vertices)),t.addResource(JSON.stringify(this._distances)),t.addResource(JSON.stringify(this._lengths)),t.addResource(JSON.stringify(this._clippings)),t.addResource(JSON.stringify(this._uvs)),t.addResource(JSON.stringify(this._indices)),t.addResource(JSON.stringify(this._boundary))];return t.addResource(JSON.stringify(e))},t.prototype.deserialize=function(t,e){var n=e.resources,i=n.length;if(0<=t&&t<i){var r=e.getExtension(t);null==r&&(r=JSON.parse(n[t]),e.setExtension(t,r)),this._parentPointsId=this._parent.points.id;var o=r[0];if(0<=o&&o<i){var s=e.getExtension(o);null==s&&(s=JSON.parse(n[o]),e.setExtension(o,s)),this._vertices=s,this._nvertices=s.length>>1}var a=r[1];if(0<=a&&a<i){var u=e.getExtension(a);null==u&&(u=JSON.parse(n[a]),e.setExtension(a,u)),this._distances=u}var l=r[2];if(0<=l&&l<i){var h=e.getExtension(l);null==h&&(h=JSON.parse(n[l]),e.setExtension(l,h)),this._lengths=h}var c=r[3];if(0<=c&&c<i){var p=e.getExtension(c);null==p&&(p=JSON.parse(n[c]),e.setExtension(c,p)),this._clippings=p}var f=r[4];if(0<=f&&f<i){var d=e.getExtension(f);null==d&&(d=JSON.parse(n[f]),e.setExtension(f,d)),this._uvs=d}var y=r[5];if(0<=y&&y<i){var g=e.getExtension(y);null==g&&(g=JSON.parse(n[y]),e.setExtension(y,g)),this._indices=g,this._nindices=g.length/3}var v=r[6];if(null!=v)if(0<=v&&v<i){var _=e.getExtension(v);null==_&&(_=JSON.parse(n[v]),e.setExtension(v,_)),this._boundary=_}else yi(this._vertices,this._boundary);else yi(this._vertices,this._boundary);this._id+=1}},t}(),mf=function(t){function e(e){void 0===e&&(e=i.POLYGON);var n=t.call(this,e)||this;return n._points=n.newPoints(),n._triangulated=n.newTriangulated(),n}return F(e,t),Object.defineProperty(e.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),e.prototype.newPoints=function(){return new pf(this)},e.prototype.newTriangulated=function(){return new _f(this)},Object.defineProperty(e.prototype,"triangulated",{get:function(){return this._triangulated},enumerable:!1,configurable:!0}),e.prototype.toHitTestStrokeShift=function(t,e,n){return 0},e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.copy=function(n,i){void 0===i&&(i=gt.ALL),this.lock(zt.ALL);var r=t.prototype.copy.call(this,n,i);return i&gt.POINTS&&n instanceof e&&this._triangulated.copy(n._triangulated),this.unlock(zt.ALL,!0),r},e.prototype.serialize=function(e){var n=t.prototype.serialize.call(this,e),i=[this._points.serialize(e),this._triangulated.serialize(e)];return n[15]=e.addResource(JSON.stringify(i)),n},e.prototype.deserialize=function(t,e){var n=e.resources,i=n.length;if(0<=t&&t<i){var r=e.getExtension(t);null==r&&(r=JSON.parse(n[t]),e.setExtension(t,r)),this.lock(zt.ALL),this._points.deserialize(r[0],e),this._triangulated.deserialize(r[1],e),this.unlock(zt.ALL,!0)}},e.prototype.containsAbs=function(e,n,i,r,o,s,a){return!!t.prototype.containsAbsBBox.call(this,e,n,i,r)&&function(t,e,n,i,r){var o=t.fill,s=o.enable;if(!s&&i<=0)return!1;var a=t.points.formatted.values,u=a.length;if(6<=u){for(var l=0,h=a[u-3],c=a[u-2],p=a[u-1],f=0;f<u;f+=2){var d=a[f],y=a[f+1];if(p<=n&&n<y||n<=p&&y<n){var g=y-p,v=0;0<Math.abs(g)&&(v=(n-p)/g),e<=c+v*(d-c)&&(v<=0?(h<=n&&n<y||n<=h&&y<n)&&(l+=1):l+=1)}h=p,c=d,p=y}if(l%2==1){if(s){var _=o.percent;if(1<=_)return!0;var m=t.triangulated.boundary;switch(o.direction){case J.TOP:if(n-m[1]<=_*(m[3]-m[1]))return!0;break;case J.RIGHT:if((1-_)*(m[2]-m[0])<=e-m[0])return!0;break;case J.BOTTOM:if((1-_)*(m[3]-m[1])<=n-m[1])return!0;break;case J.LEFT:if(e-m[0]<=_*(m[2]-m[0]))return!0}}var b=i*r;return function(t,e,n,i){if(e<4)return 1/0;for(var r=1/0,o=t[e-2],s=t[e-1],a=0;a<e;a+=2){var u=t[a],l=t[a+1],h=u-o,c=l-s,p=h*h+c*c,f=0;0<p&&((f=((n-o)*h+(i-s)*c)/p)<0?f=0:1<f&&(f=1));var d=n-(o+f*h),y=i-(s+f*c),g=d*d+y*y;g<r&&(r=g),o=u,s=l}return r}(a,u,e,n)<=b*b}}return!1}(this,e,n,o,s)},e}(oe),bf=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n,i,r,o)||this;return s.triangulatedId=-1,s}return F(e,t),e.prototype.init=function(){},e.prototype.reinit=function(t,e,n,i){if(!(e instanceof mf))return!1;var r=e.triangulated,o=r.nvertices,s=r.nindices;return this.buffer===t&&this.vertexOffset===n&&this.indexOffset===i&&this.vertexCount===o&&this.indexCount===s||!!t.check(n,i,o,s)&&(this.inited=Y.NONE,this.buffer=t,this.vertexOffset=n,this.indexOffset=i,this.vertexCount=o,this.indexCount=s,this.triangulatedId=-1,this.init(),!0)},e.prototype.isCompatible=function(t){if(!(t instanceof mf))return!1;var e=t.triangulated,n=e.nvertices,i=e.nindices;return n===this.vertexCount&&i===this.indexCount},e.prototype.update=function(t){if(t instanceof mf){var e=this.buffer;this.updateVertexStepUvAndIndex(e,t),this.updateColor(e,t)}},e.prototype.updateVertexStepUvAndIndex=function(t,e){var n=$(e),i=this.transformLocalId!==n,r=e.triangulated,o=r.id,s=this.triangulatedId!==o,a=e.fill,u=a.direction,l=a.percent,h=this.fillDirection!==u||this.fillPercent!==l,c=e.stroke,p=c.enable?c.width:0,f=c.side,d=c.style,y=this.strokeWidth!==p||this.strokeSide!==f||this.strokeStyle!==d,g=tt(e),v=et(g),_=g!==this.texture||v!==this.textureTransformId,m=!(this.inited&Y.VERTEX_STEP_UV_AND_INDEX);if(m||s||i||h||y||_){this.inited|=Y.VERTEX_STEP_UV_AND_INDEX,this.transformLocalId=n,this.fillDirection=u,this.fillPercent=l,this.strokeWidth=p,this.strokeSide=f,this.strokeStyle=d,this.texture=g,this.textureTransformId=v,this.triangulatedId=o,(m||s)&&(t.updateIndices(),sf(t.indices,r.indices,this.vertexOffset,this.indexOffset));var b=this.vertexOffset;(m||s||i)&&(t.updateVertices(),af(t.vertices,r.vertices,b,e.transform.internalTransform)),(m||s||h||y)&&(t.updateSteps(),uf(t.steps,r.distances,r.lengths,r.clippings,r.uvs,r.boundary,b,this.vertexCount,u,l,p,f,d)),(m||s||_)&&(t.updateUvs(),cf(t.uvs,r.uvs,b,nt(g)))}},e}(Q),Tf=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=0,h=0;if(e instanceof mf){var c=e.triangulated;l=c.nvertices,h=c.nindices}var p=l+a,f=h+u;return t.check(n,i,p,f)?new o(t,n,i,p,f,[new bf(t,n,i,l,h),new de(t,n+l,i+h,a,u)]).init(e):null},wf=function(t,e,n){return n=n||new mf,Pl(t,e,n),n.deserialize(t[15],e),n},Ef=function(){r[i.POLYGON]=Tf,e[i.POLYGON]=wf,Xn.set(i.POLYGON,Lt.PRIMITIVE&~(Lt.LINE_HEAD|Lt.LINE_TAIL))},Of=function(t,e,n){return Pl(t,e,n||new Io)},Cf=function(){r[i.RECTANGLE]=Ic,e[i.RECTANGLE]=Of,Xn.set(i.RECTANGLE,Lt.PRIMITIVE|Lt.STROKE_SIDE)},Sf=function(t,e,n){return Pl(t,e,n||new Ao)},xf=function(t,e,n){return Pl(t,e,n||new Yl)},Df=function(){r[i.RECTANGLE_ROUNDED]=Vl,e[i.RECTANGLE_ROUNDED]=xf,Xn.set(i.RECTANGLE_ROUNDED,Lt.PRIMITIVE|Lt.STROKE_SIDE|Lt.BORDER_RADIUS)},If=[0,0],Af=new t.Point,Rf=function(t,e,n){var i=3*n-1;t[++i]=e,t[++i]=e+1,t[++i]=e+3,t[++i]=e+1,t[++i]=e+4,t[++i]=e+3,t[++i]=e+1,t[++i]=e+2,t[++i]=e+4,t[++i]=e+2,t[++i]=e+5,t[++i]=e+4},Pf=function(t,e,n,i,r,o,s,a,u,l){var h=Af,c=s*a,p=.5*r+(0<=r?+c:-c),f=.5*o+(0<=o?+c:-c);h.set(-p+n,-f+i),u.apply(h,h);var d=h.x,y=h.y;h.set(0+n,-f+i),u.apply(h,h);var g=h.x,v=h.y,_=g-d,m=v-y;h.set(n,i),u.apply(h,h);var b=h.x,T=h.y,w=b-_,E=T-m,C=2*e-1;t[++C]=d,t[++C]=y,t[++C]=g,t[++C]=v,t[++C]=g+_,t[++C]=v+m,t[++C]=w,t[++C]=E,t[++C]=b,t[++C]=T,t[++C]=b+_,t[++C]=T+m,l[0]=O(d,y,g,v),l[1]=O(d,y,w,E)},Mf=function(t,e,n,i,r){var o=u(i),s=r[0],a=r[1],l=p(1,o,1,1),h=f(1,1),c=f(0,1),d=f(1,0),y=f(0,0),g=6*e-1;t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=h,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=c,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=h,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=d,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=y,t[++g]=0,t[++g]=n,t[++g]=l,t[++g]=s,t[++g]=a,t[++g]=d,t[++g]=0},kf=function(t,e,n){var i=n.x0,r=n.x1,o=n.x2,s=n.x3,a=n.y0,u=n.y1,l=n.y2,h=n.y3,c=2*e-1;t[++c]=i,t[++c]=a,t[++c]=.5*(i+r),t[++c]=.5*(a+u),t[++c]=r,t[++c]=u,t[++c]=.5*(i+s),t[++c]=.5*(a+h),t[++c]=.5*(i+o),t[++c]=.5*(a+l),t[++c]=.5*(r+o),t[++c]=.5*(u+l)},Lf=function(t){function e(e,n,i){return t.call(this,e,n,i,6,4)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices();var e=this.vertexOffset;Rf(t.indices,e,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexAndStep(e,t),this.updateColor(e,t),this.updateUv(e,t)},e.prototype.updateVertexAndStep=function(t,e){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=$(e),a=this.transformLocalId!==s,u=e.stroke,l=u.align,h=u.enable?u.width:0,c=u.style,p=this.strokeAlign!==l||this.strokeWidth!==h||this.strokeStyle!==c;(!(this.inited&Y.VERTEX_AND_STEP)||o||a||p)&&(this.inited|=Y.VERTEX_AND_STEP,this.sizeX=i,this.sizeY=r,this.transformLocalId=s,this.strokeAlign=l,this.strokeWidth=h,this.strokeStyle=c,t.updateVertices(),t.updateSteps(),Pf(t.vertices,this.vertexOffset,0,0,i,r,l,h,e.transform.internalTransform,If),Mf(t.steps,this.vertexOffset,h,c,If))},e.prototype.updateUv=function(t,e){var n=tt(e),i=et(n);if(!(this.inited&Y.UV)||n!==this.texture||i!==this.textureTransformId){this.inited|=Y.UV,this.texture=n,this.textureTransformId=i,t.updateUvs();var r=nt(n);kf(t.uvs,this.vertexOffset,r)}},e}(Q),Nf=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=6+a,h=4+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new Lf(t,n,i),new de(t,n+6,i+4,a,u)]).init(e):null},Bf=function(t,e,n,i,r,o,s){return n<=0&&se(t,e,n,i,r,o,s)},zf=function(t){function e(e){void 0===e&&(e=i.SEMICIRCLE);var n=t.call(this,e)||this;return n.stroke.side=Z.ALL&~Z.BOTTOM,n}return F(e,t),e.prototype.clone=function(){return new e(this.type).copy(this)},e.prototype.containsAbs=function(e,n,i,r,o,s,a){return!!t.prototype.containsAbsBBox.call(this,e,n,i,r)&&Bf(this,e,n,i,r,o,s)},e}(oe),Uf=function(t,e,n){return Pl(t,e,n||new zf)},jf=function(){r[i.SEMICIRCLE]=Nf,e[i.SEMICIRCLE]=Uf},Ff=function(t){function e(e,n,i){return t.call(this,e,n,i,7,3)||this}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices(),Ih(t.indices,this.vertexOffset,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexStepAndUv(e,t),this.updateColor(e,t)},e.prototype.updateVertexStepAndUv=function(t,e){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=$(e),a=this.transformLocalId!==s,u=e.stroke,l=u.align,h=u.enable?u.width:0,c=u.style,p=this.strokeAlign!==l||this.strokeWidth!==h||this.strokeStyle!==c,f=tt(e),d=et(f),y=f!==this.texture||d!==this.textureTransformId,g=o||p,v=!(this.inited&Y.VERTEX_STEP_AND_UV);if(v||g||a||y){this.inited|=Y.VERTEX_STEP_AND_UV,this.sizeX=i,this.sizeY=r,this.transformLocalId=s,this.strokeAlign=l,this.strokeWidth=h,this.strokeStyle=c,this.texture=f,this.textureTransformId=d;var _=this.vertexOffset;t.updateVertices(),Ah(t.vertices,_,0,0,i,r,l,h,e.transform.internalTransform,xh),(v||g||a)&&(t.updateSteps(),Rh(t.steps,_,h,c,xh)),(v||g||y)&&(t.updateUvs(),Ph(t.uvs,nt(f),_,xh))}},e}(Q),Hf=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=7+a,h=3+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new Ff(t,n,i),new de(t,n+7,i+3,a,u)]).init(e):null},Gf=function(t,e,n){return Pl(t,e,n||new Jp)},Vf=function(){r[i.TRIANGLE]=Hf,e[i.TRIANGLE]=Gf},Wf=function(t){function e(e,n,i){var r=t.call(this,e,n,i,Mp,kp)||this;return r.radius=0,r.corner=0,r}return F(e,t),e.prototype.init=function(){var t=this.buffer;t.updateIndices(),Bp(t.indices,this.vertexOffset,this.indexOffset),this.inited|=Y.INDEX},e.prototype.update=function(t){var e=this.buffer;this.updateVertexStepAndUv(e,t),this.updateColor(e,t)},e.prototype.updateVertexStepAndUv=function(t,e){var n=e.size,i=n.x,r=n.y,o=i!==this.sizeX||r!==this.sizeY,s=e.radius,a=s!==this.radius,u=$(e),l=this.transformLocalId!==u,h=e.stroke,c=h.align,p=h.enable?h.width:0,f=h.style,d=this.strokeAlign!==c||this.strokeWidth!==p||this.strokeStyle!==f,y=e.corner,g=y!==this.corner,v=tt(e),_=et(v),m=v!==this.texture||_!==this.textureTransformId,b=o||a||d,T=!(this.inited&Y.VERTEX_STEP_AND_UV);if(T||b||l||g||m){this.inited|=Y.VERTEX_STEP_AND_UV,this.sizeX=i,this.sizeY=r,this.radius=s,this.transformLocalId=u,this.strokeAlign=c,this.strokeWidth=p,this.strokeStyle=f,this.corner=y,this.texture=v,this.textureTransformId=_;var w=this.vertexOffset;t.updateVertices(),zp(t.vertices,w,0,0,i,r,c,p,s,e.transform.internalTransform,Lp),(T||b||l||g)&&(t.updateSteps(),Up(t.steps,w,p,f,y,s,Lp)),(T||b||m)&&(t.updateUvs(),jp(t.uvs,w,nt(v),s,Lp))}},e}(Q),Kf=function(t,e,n,i,r){var s=D(e),a=s<<2,u=s<<1,l=Mp+a,h=kp+u;return t.check(n,i,l,h)?new o(t,n,i,l,h,[new Wf(t,n,i),new de(t,n+Mp,i+kp,a,u)]).init(e):null},Xf=function(t,e,n){return Pl(t,e,n||new Wp)},Yf=function(){r[i.TRIANGLE_ROUNDED]=Kf,e[i.TRIANGLE_ROUNDED]=Xf,Xn.set(i.TRIANGLE_ROUNDED,Lt.PRIMITIVE|Lt.STROKE_SIDE|Lt.BORDER_RADIUS)},qf=function(){kl(),th(),hh(),uc(),lc(),vc(),xc(),Ec(),Pc(),r[i.IMAGE_SDF]=jc,e[i.IMAGE_SDF]=Hc,Xc(),Zc(),of(),Ef(),r[i.RECTANGLE_PIVOTED]=cc,e[i.RECTANGLE_PIVOTED]=Sf,Xn.set(i.RECTANGLE_PIVOTED,Lt.PRIMITIVE|Lt.STROKE_SIDE),Df(),Cf(),jf(),Yf(),Vf(),wp(),xp(),Pp(),Yp(),tf()},Zf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DImage"},e}(Na),Jf=function(t){function e(e){var n,i=t.call(this,e)||this;return i._value=null!==(n=null==e?void 0:e.value)&&void 0!==n?n:null,i}return F(e,t),e.prototype.init=function(e){var n=this;t.prototype.init.call(this,e),this.on(cr.tap,(function(t){n.onClick(t)}))},e.prototype.onClick=function(t){this.state.isActionable&&this.activate(t)},e.prototype.activate=function(t){this.onSelect(t)},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t},enumerable:!1,configurable:!0}),e.prototype.hasSelection=function(t){return t&&t.selection&&t.selection.add},e.prototype.getSelection=function(){for(var t=this.parent;t;){if(this.hasSelection(t))return t.selection;t=t.parent}return null},e.prototype.onSelect=function(t){this.emit("select",this._value,this);var e=this.getSelection();e&&e.add(this)},e.prototype.onKeyDown=function(e){return no.isActivateKey(e)&&this.onKeyDownActivate(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyDownActivate=function(t){return!(!this.state.isActionable||!this.state.isFocused||(this.activate(t),0))},e.prototype.getType=function(){return"DMenuItemBase"},e}(Zf),Qf=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getContext=function(){for(var t=this.parent;t;){if(t.getContext)return t.getContext();t=t.parent}return null},e.prototype.getCloseable=function(){for(var t=this.parent;t;){if(t.getCloseable)return t.getCloseable();t=t.parent}return null},e.prototype.getType=function(){return"DMenuItem"},e}(Jf),$f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),this.initOnOver(e),this.initShortcuts(e)},e.prototype.initOnOver=function(t){var e=this;this.on(cr.over,(function(){var t=e.getContext();null!=t&&e.parent instanceof ao&&t.trim(e.getCloseable())}))},e.prototype.initShortcuts=function(t){var e=this._shortcuts;if(null!=e&&0<e.length){var n=e[0],i=this.newShortcutText();this._shortcutText=i,this.snippet.add(i,!0),i.text=no.toString(n)}else this._shortcutText=null;this._shortcutMargin=this.theme.getShortcutTextMargin()},e.prototype.newShortcutText=function(){var t,e;return new wa(new Ea(this,this.theme,null===(e=null===(t=this._options)||void 0===t?void 0:t.text)||void 0===e?void 0:e.style))},e.prototype.updateShortcutText=function(){var t=this._shortcutText,e=this._shortcutMargin;if(null!=t&&null!=e){var n,i=this._auto;n=i.width.isOn?e:this.width-t.width-e;var r,o=this._padding,s=o.getTop();r=i.height.isOn?s:s+.5*(this.height-s-o.getBottom()-t.height),t.position.set(n,r)}},e.prototype.updateShortcutColor=function(){var t=this._shortcutText;if(null!=t){var e=this.theme,n=this.state;t.style.fill=e.getShortcutColor(n),t.alpha=e.getShortcutAlpha(n)}},e.prototype.onReflow=function(){t.prototype.onReflow.call(this),this.updateShortcutColor(),this.updateShortcutText()},e.prototype.getType=function(){return"DMenuItemText"},e.prototype.onSelect=function(e){t.prototype.onSelect.call(this,e);var n=this.getCloseable();null!=n&&n.emit("select",this.value,this,n)},e.prototype.onShortcut=function(e){t.prototype.onShortcut.call(this,e),this.activate(e)},e}(Qf),td=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){t.prototype.init.call(this,e),(null==e?void 0:e.check)&&(this.state.isActive=!0)},e.prototype.getType=function(){return"DMenuItemCheck"},e.prototype.onSelect=function(e){this.state.isActive=!this.state.isActive,t.prototype.onSelect.call(this,e)},e}($f),ed=function(t){return"check"in t},nd={OPEN_LINK:0,OPEN_LINK_IN_NEW_WINDOW:1,COPY_LINK_ADDRESS:2},id=function(){function e(){}return e.addItemCreator=function(t){this.CREATORS.push(t)},e.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},e.setMenuCreator=function(t){this.MENU_CREATOR=t},e.newItemOf=function(t,e,n,i){for(var r=0,o=t.length;r<o;++r){var s=t[r](n,i);if(null!=s)return s}return e?e(n,i):null},e.newItem=function(t,e){return this.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,e)},e.newItemsOf=function(e,n,i,r){for(var o=0,s=i.length;o<s;++o){var a=i[o];if(a instanceof t.DisplayObject)n.addChild(a);else if(null!=a){var u=e.newItem(a,r);if(null==u)throw new Error("No matching menu item creator found: ".concat(JSON.stringify(a)));n.addChild(u)}}},e.newItems=function(t,e,n){this.newItemsOf(this,t,e,n)},e.newMenu=function(t){if(null!=this.MENU_CREATOR)return this.MENU_CREATOR(t);throw new Error("Missing DMenu creator.")},e.CREATORS=[],e.CREATOR_DEFAULT=null,e}(),rd=function(){function e(t,e){this._parent=t,this._options=e,this._isEnabled=!0}return Object.defineProperty(e.prototype,"enable",{get:function(){return this._isEnabled},set:function(t){this._isEnabled=t},enumerable:!1,configurable:!0}),e.prototype.open=function(t){this.get().open(t)},e.prototype.get=function(){var t=this,e=this._menu;return null==e&&(e=this.toMenu(this._options),this._menu=e,e.on("select",(function(e,n,i){t.onSelect(e,n,i)}))),e},e.prototype.toMenu=function(e){return e instanceof t.DisplayObject?e:this.newMenu(e)},e.prototype.newMenu=function(t){return id.newMenu(t)},e.prototype.onSelect=function(t,e,n){var i=this._parent;switch(t){case nd.OPEN_LINK:i.open(!1);break;case nd.OPEN_LINK_IN_NEW_WINDOW:i.open(!0);break;case nd.COPY_LINK_ADDRESS:i.copy()}},e}(),od={AUTO:0,THIS_WINDOW:1,NEW_WINDOW:2},sd=function(t){var e=document.getSelection();if(e){var n=document.createRange();n.selectNodeContents(t),e.removeAllRanges(),e.addRange(n)}return e},ad=function(t){return t.clipboardData||window.clipboardData},ud=function(t){function e(e){var n=t.call(this)||this,i=document.body;return i.addEventListener("copy",(function(t){t.target!==i&&t.target!==e||(t.preventDefault(),t.stopPropagation(),n.emit("copy",ad(t)))})),i.addEventListener("cut",(function(t){t.target!==i&&t.target!==e||(t.preventDefault(),t.stopPropagation(),n.emit("cut",ad(t)))})),i.addEventListener("paste",(function(t){t.target!==i&&t.target!==e||(t.preventDefault(),t.stopPropagation(),n.emit("paste",ad(t)))})),n}return F(e,t),e.copy=function(t){var e=navigator.clipboard;e&&e.writeText?e.writeText(t):function(t,e){if("undefined"==typeof ClipboardEvent){var n=t.clipboardData;if(void 0!==n&&void 0!==n.setData)return n.setData("Text",e),!0}return!1}(window,t)||function(t){var e=document.createElement("div");e.setAttribute("style","-webkit-user-select: text !important"),e.textContent="Dummy",document.body.appendChild(e);var n=sd(e),i=!1;if(n){var r=function(n){if(n.target===e){var r=ad(n);r.setData("text/plain",t),i=r.getData("text/plain")===t,n.preventDefault()}};document.addEventListener("copy",r);try{document.execCommand("copy")}finally{document.removeEventListener("copy",r)}n.removeAllRanges()}return document.body.removeChild(e),i}(t)||navigator.userAgent.indexOf("Edge")<0&&function(t){var e=document.createElement("div");e.setAttribute("style","-webkit-user-select: text !important");var n=document.createElement("span");n.innerText=t,(e.attachShadow?e.attachShadow({mode:"open"}):e).appendChild(n),document.body.appendChild(e);var i=sd(e);i&&(document.execCommand("copy"),i.removeAllRanges()),document.body.removeChild(e)}(t)},e}(t.utils.EventEmitter),ld=function(){function e(t){this._options=t,this._url=null==t?void 0:t.url,this._target=this.toNormalizedTarget(null==t?void 0:t.target),this._checker=null==t?void 0:t.checker,this._isEnabled=!0}return Object.defineProperty(e.prototype,"enable",{get:function(){return this._isEnabled},set:function(t){this._isEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"url",{get:function(){return this._url},set:function(t){this._url=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target=this.toNormalizedTarget(t)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checker",{get:function(){return this._checker},set:function(t){this._checker=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"menu",{get:function(){var t=this._menu;return null==t&&(t=this.newMenu(),this._menu=t),t},enumerable:!1,configurable:!0}),e.prototype.newMenu=function(){var t=this._options;if(t){var n=t.menu;if(n)return new rd(this,n)}var i=e.MENU;return null==i&&(i=new rd(this,it.getInstance().get("DLink").getMenuOptions()),e.MENU=i),i},e.prototype.toStringifiedUrl=function(t,e){var n=Ct(t)?t():t;null!=n&&(xt(n)?e(n):n.then((function(t){null!=t&&e(t)})))},e.prototype.toNormalizedUrl=function(t){var n=e.ANCHOR_ELEMENT||document.createElement("a");return e.ANCHOR_ELEMENT=n,n.href=t,n.href},e.prototype.toNormalizedTarget=function(t){return ai(null!=t?t:od.AUTO,od)},e.prototype.copy=function(){var t=this;this.toStringifiedUrl(this._url,(function(e){ud.copy(t.toNormalizedUrl(e))}))},e.prototype.open=function(t){var e=this;this.toStringifiedUrl(this._url,(function(n){var i=!0===t||!1===t?t:e.inNewWindow(t);e.check(n,i,(function(){e.exec(n,i)}))}))},e.prototype.check=function(t,e,n){var i=this._checker;if(i){var r=i();!0===r?n():!1===r||r.then((function(t){t&&n()}))}else n()},e.prototype.exec=function(t,e){if(e){var n=document.createElement("a");n.href=t,n.target="_blank",n.style.display="none",n.rel="noopener noreferrer",document.body.appendChild(n),n.click(),setTimeout((function(){document.body.removeChild(n)}),100)}else window.location.href=t},e.prototype.inNewWindow=function(e){switch(this._target){case od.NEW_WINDOW:return!0;case od.THIS_WINDOW:return!1;case od.AUTO:if(null!=e){var n=e instanceof t.InteractionEvent?e.data.originalEvent:e;return n.ctrlKey||n.shiftKey||n.altKey||n.metaKey||"button"in n&&0!==n.button}return!1}},e.prototype.onClick=function(t,e){if(this._target===od.AUTO){var n=e.data.originalEvent;if("pointerType"in n&&"mouse"!==n.pointerType||"touches"in n){var i=this.menu;if(i.enable)return this._isEnabled&&t.state.isActionable&&i.open(t),!0}}return!this._isEnabled},e}(),hd=function(){function t(){}return t.toStateOptions=function(t,e){if(e&&(t===od.NEW_WINDOW||"NEW_WINDOW"===t)){var n=e.state;if(null==n)e.state=vt.NEW_WINDOW;else if(xt(n))n!==vt.NEW_WINDOW&&(e.state=[n,vt.NEW_WINDOW]);else if(Ot(n))n.indexOf(vt.NEW_WINDOW)<0&&n.push(vt.NEW_WINDOW);else{var i=n.values;null==i?n.values=vt.NEW_WINDOW:xt(i)?i!==vt.NEW_WINDOW&&(n.values=[i,vt.NEW_WINDOW]):i.indexOf(vt.NEW_WINDOW)<0&&i.push(vt.NEW_WINDOW)}}return e},t}(),cd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toLinkOptions=function(t){if(t)return{url:this.toUrl(t.url),target:t.target,checker:this.toChecker(t.checker),menu:t.menu}},e.prototype.toUrl=function(t){var e=this;return xt(t)||null==t?t:function(){return t(e)}},e.prototype.toChecker=function(t){var e=this;if(null!=t)return function(){return t(e)}},e.prototype.init=function(e){t.prototype.init.call(this,hd.toStateOptions(null==e?void 0:e.target,e))},Object.defineProperty(e.prototype,"link",{get:function(){var t=this._link;return null==t&&(t=new ld(this.toLinkOptions(this._options)),this._link=t),t},enumerable:!1,configurable:!0}),e.prototype.onClick=function(e){this.link.onClick(this,e)||t.prototype.onClick.call(this,e)},e.prototype.getType=function(){return"DMenuItemLink"},e.prototype.onSelect=function(e){t.prototype.onSelect.call(this,e),this.link.open(e)},e.prototype.open=function(t){this.link.open(t)},e.prototype.onShortcut=function(e){t.prototype.onShortcut.call(this,e),this.activate(e)},e}($f),pd=function(t){return"url"in t},fd=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(t){e.prototype.init.call(this,t),this.initHover(t)},n.prototype.initHover=function(t){var e=this;this.on(cr.over,(function(){e.state.isActionable&&e.open()}))},n.prototype.toMenu=function(e){var n=null==e?void 0:e.menu;return n instanceof t.DisplayObject?n:this.newMenu(n)},n.prototype.newMenu=function(t){return id.newMenu(t)},Object.defineProperty(n.prototype,"menu",{get:function(){var t=this,e=this._menu;return null==e&&((e=this.toMenu(this._options)).on("select",(function(e,n,i){t.onMenuSelect(e,n,i)})),this._menu=e),e},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DMenuItemMenu"},n.prototype.open=function(){var t=this.menu;t.isHidden()&&this.onOpen(t)},n.prototype.onOpen=function(t){var e=this.getContext();null!=e&&t.open(this,this.getCloseable(),e)},n.prototype.close=function(){this.menu.close()},n.prototype.toggle=function(){var t=this.menu;t.isHidden()?this.onOpen(t):t.close()},n.prototype.onSelect=function(t){this.open(),e.prototype.onSelect.call(this,t)},n.prototype.onMenuSelect=function(t,e,n){var i=this.getCloseable();null!=i&&i.emit("select",t,e,i)},n.prototype.onKeyDown=function(t){return no.isArrowRightKey(t)&&this.onKeyDownArrowRight(t),e.prototype.onKeyDown.call(this,t)},n.prototype.onKeyDownArrowRight=function(t){return!(!this.state.isActionable||!this.state.isFocused||(this.onSelect(t),0))},n}(Qf),dd=function(t){return"menu"in t},yd=function(e,n){var i=e.menu;return i instanceof t.DisplayObject||(null==i.sticky&&(i.sticky=n),null==i.align&&(i.align=js.RIGHT)),e},gd=function(t){function e(e){var n=t.call(this)||this;return e.snippet.add(n,!0),e.reflowable.add(n),n}return F(e,t),e.prototype.onReflow=function(t,e,n){var i=t.state,r=t.border,o=r.getWidth(i),s=r.getColor(i);if(null!=s){var a=r.getAlpha(i),u=r.getAlign(i),l=t.padding,h=.5*n;this.clear(),this.lineStyle(o,s,a,u),this.moveTo(l.getLeft(),h),this.lineTo(e-l.getRight(),h),this.visible=!0}else this.clear(),this.visible=!1},e}(t.Graphics),vd=function(t){return"separator"in t},_d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.initReflowable=function(){new gd(this)},e.prototype.getType=function(){return"DMenuItemSeparator"},e}(Jf),md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemSpace"},e}(Js),bd=function(t){return"space"in t},Td=function(){id.addItemCreator((function(t){return ed(t)?new td(t):null})),id.addItemCreator((function(t){return pd(t)?new cd(t):null})),id.addItemCreator((function(t,e){return dd(t)?new fd(yd(t,e)):null})),id.addItemCreator((function(t){return vd(t)?new _d(t):null})),id.addItemCreator((function(t){return bd(t)?new md(t):null})),id.setItemCreatorDefault((function(t){return new $f(t)}))},wd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemExpandableBody"},e}(ta),Ed=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getSelection=function(){return null},e.prototype.getType=function(){return"DMenuItemExpandableHeader"},e}(Jf),Od=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,e){return id.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,e)||id.newItem(t,e)},t.newItems=function(t,e,n){id.newItemsOf(this,t,e,n)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),Cd=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(t){var n,i=this;e.prototype.init.call(this,t);var r=this.theme,o=this.toHeader(r,t);this._header=o,o.on("select",(function(){i.toggle()})),this.addChild(o);var s=this.toBody(r,t);this._body=s;var a=null!==(n=null==t?void 0:t.sticky)&&void 0!==n&&n;this.newItems(s,a,r,t),this.addChild(s),this.state.isActive?this.onActivated():this.onDeactivated()},n.prototype.newItems=function(t,e,n,i){var r=null==i?void 0:i.items;null!=r&&Od.newItems(t,r,e)},n.prototype.toHeader=function(e,n){return n?n.header instanceof t.DisplayObject?n.header:this.newHeader(e,n.header):this.newHeader(e)},n.prototype.newHeader=function(t,e){return new Ed(e)},n.prototype.toBody=function(e,n){var i=null==n?void 0:n.body;return i?i instanceof t.DisplayObject?i:this.newBody(e,i):this.newBody(e)},n.prototype.newBody=function(t,e){return new wd(e)},n.prototype.open=function(){this.state.isActive=!0},n.prototype.close=function(){this.state.isActive=!1},n.prototype.toggle=function(){this.state.isActive=!this.state.isActive},n.prototype.onActivated=function(){var t=this._body;t instanceof ao?t.show():t.visible=!0},n.prototype.onDeactivated=function(){var t=this._body;t instanceof ao?t.hide():t.visible=!1},n.prototype.onStateChange=function(t,n){e.prototype.onStateChange.call(this,t,n),t.isActive?n.isActive||this.onActivated():n.isActive&&this.onDeactivated()},n.prototype.onKeyDown=function(t){if(no.isArrowRightKey(t))this.state.isActionable&&!this.state.isActive&&(n=this._header)instanceof ao&&n.state.isFocused&&(this.state.isActive=!0);else if(no.isArrowLeftKey(t)){var n;if(this.state.isActionable&&this.state.isActive)return(n=this._header)instanceof ao?n.focus():this.focus(),this.state.isActive=!1,e.prototype.onKeyDown.call(this,t),!0}return e.prototype.onKeyDown.call(this,t)},n.prototype.getType=function(){return"DMenuItemExpandable"},n}(ta),Sd=function(t){return"header"in t},xd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemExpandableItemCheck"},e}(td),Dd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemExpandableItemLink"},e}(cd),Id=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemExpandableItemSeparator"},e}(_d),Ad=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemExpandableItemSpace"},e}(md),Rd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemExpandableItemText"},e}($f),Pd=function(){id.addItemCreator((function(t){return Sd(t)?new Cd(t):null})),Od.addItemCreator((function(t){return ed(t)?new xd(t):null})),Od.addItemCreator((function(t){return pd(t)?new Dd(t):null})),Od.addItemCreator((function(t){return vd(t)?new Id(t):null})),Od.addItemCreator((function(t){return bd(t)?new Ad(t):null})),Od.setItemCreatorDefault((function(t){return new Rd(t)}))},Md=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemCheck"},e}(td),kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getSelection=function(){return null},e.prototype.getType=function(){return"DMenuSidedItemLink"},e}(cd),Ld=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.initHover=function(t){},e.prototype.onMenuSelect=function(e,n,i){t.prototype.onMenuSelect.call(this,e,n,i);var r=t.prototype.getSelection.call(this);r&&r.add(n)},e.prototype.onOpen=function(t){t.open(this,this)},e.prototype.getSelection=function(){return null},e.prototype.getType=function(){return"DMenuSidedItemMenu"},e}(fd),Nd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemSeparator"},e}(_d),Bd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemSpace"},e}(md),zd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemText"},e}($f),Ud=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,e){return id.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,e)||id.newItem(t,e)},t.newItems=function(t,e,n){id.newItemsOf(this,t,e,n)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),jd=function(){Ud.setItemCreatorDefault((function(t){return new zd(t)})),Ud.addItemCreator((function(t){return bd(t)?new Bd(t):null})),Ud.addItemCreator((function(t){return vd(t)?new Nd(t):null})),Ud.addItemCreator((function(t,e){return dd(t)?new Ld(yd(t,e)):null})),Ud.addItemCreator((function(t){return pd(t)?new kd(t):null})),Ud.addItemCreator((function(t){return ed(t)?new Md(t):null}))},Fd=function(){function t(){}return t.addItemCreator=function(t){this.CREATORS.push(t)},t.setItemCreatorDefault=function(t){this.CREATOR_DEFAULT=t},t.newItem=function(t,e){return id.newItemOf(this.CREATORS,this.CREATOR_DEFAULT,t,e)||Ud.newItem(t,e)},t.newItems=function(t,e,n){id.newItemsOf(this,t,e,n)},t.CREATORS=[],t.CREATOR_DEFAULT=null,t}(),Hd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newItems=function(t,e,n,i){null!=i&&null!=i.items&&Fd.newItems(t,i.items,e)},e.prototype.getType=function(){return"DMenuSidedItemExpandable"},e}(Cd),Gd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemExpandableItemCheck"},e}(xd),Vd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemExpandableItemLink"},e}(cd),Wd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuItemExpandableItemMenu"},e}(fd),Kd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onOpen=function(t){t.open(this,this)},e.prototype.getType=function(){return"DMenuSidedItemExpandableItemMenu"},e}(Wd),Xd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemSeparator"},e}(Id),Yd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemExpandableItemSpace"},e}(Ad),qd=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DMenuSidedItemExpandableItemText"},e}(Rd),Zd=function(){Ud.addItemCreator((function(t){return Sd(t)?new Hd(t):null})),Fd.addItemCreator((function(t){return ed(t)?new Gd(t):null})),Fd.addItemCreator((function(t){return pd(t)?new Vd(t):null})),Fd.addItemCreator((function(t,e){return dd(t)?new Kd(yd(t,e)):null})),Fd.addItemCreator((function(t){return vd(t)?new Xd(t):null})),Fd.addItemCreator((function(t){return bd(t)?new Yd(t):null})),Fd.setItemCreatorDefault((function(t){return new qd(t)}))},Jd=function(){Td(),Pd(),jd(),Zd()},Qd=function(){Jd(),qf()},$d=function(t){function e(e,n){return t.call(this,Er.EMIT_EVENT,e,n,_s.EMIT_EVENT,"")||this}return F(e,t),e}(Rs),ty=function(t){function e(e,n,i){return t.call(this,e,n,"",_s.EMIT_EVENT,i)||this}return F(e,t),e}(Rs),ey=function(t){function e(e,n,i,r){return t.call(this,e,n,i,r,"")||this}return F(e,t),e}(Rs),ny=function(t){function e(e,n,i,r){return t.call(this,e,n,i,_s.EMIT_EVENT,r)||this}return F(e,t),e}(Rs),iy=function(t,e){return e?Rl(t).then((function(t){var e=Yi.getInstance().init();e.updateTexture(t.width,t.height,t.source),e.render();var n=document.createElement("canvas");return e.read(n),iy(n.toDataURL(),!1)})):Rl(t).then((function(t){return new Fc(t)}))},ry=function(){function t(){}return t.from=function(t,e,n){var i=this,r=Dr.toSerialized(t),o=r.pieces;return Dr.toPieceData(e,o,n).then((function(t){return i.from_(r,n,o,t)}))},t.from_=function(t,e,n,i){var r=this,o=t.width,s=t.height,a=new xr(o,s),u=new Fn(t,n,i,e,1);return Dr.newLayer(t,a,u).then((function(){return r.create(t.name,o,s,a,e,0)}))},t.create=function(t,e,n,i,r,o){var s=new ei(t,r,o);return s.size.set(e,n),i.copyTo(s),s.size.init(),s},t}(),oy=function(t){return"data:image/svg+xml;base64,".concat(btoa(t))},sy=function(t){return Math.round(100*t)/100},ay=Vn,uy=function(){function t(){}return t.from=function(t){if(xt(t))return X[t];if(St(t))return t;if(null!=t){for(var e=X.NONE,n=0,i=t.length;n<i;++n)e|=X[t[n]];return e}return X.NONE},t}(),ly=function(){function t(){this.resources=[],this.resourceToIndex=new Map,this.data=[],this.dataToIndex=new Map,this.pieces=[],this.pieceToIndex=new Map,this.uuids=new Set,this.uuidNext=0}return t.prototype.addResource=function(t){return this.add_(t,this.resources,this.resourceToIndex)},t.prototype.addData=function(t){return this.add_(t,this.data,this.dataToIndex)},t.prototype.addPiece=function(t){return this.add_(t,this.pieces,this.pieceToIndex)},t.prototype.addUuid=function(t){if(0!==t){var e=this.uuids;return e.has(t)?0:(e.add(t),t)}return 0},t.prototype.updateUuid=function(t){var e=this.uuids;if(0!==t)return t;var n=this.newUuid();return e.add(n),n},t.prototype.newUuid=function(){for(var t=this.uuids,e=this.uuidNext;;)if(0!==(e+=1)&&!t.has(e))return this.uuidNext=e,e},t.prototype.add_=function(t,e,n){var i=n.get(t);if(null!=i)return i;var r=e.length;return e.push(t),n.set(t,r),r},t}(),hy=function(t){function e(e,n){var i,r,o,s=t.call(this)||this;return s._isVisibleDefault=null!==(i=null==n?void 0:n.visible)&&void 0!==i?i:e.isSnapGridVisible(),s._isVisible=s._isVisibleDefault,s._isEnabledDefault=null!==(r=null==n?void 0:n.enable)&&void 0!==r?r:e.isSnapGridEnabled(),s._isEnabled=s._isEnabledDefault,s._sizeDefault=null!==(o=null==n?void 0:n.size)&&void 0!==o?o:e.getSnapGridSize(),s._size=s._sizeDefault,s}return F(e,t),Object.defineProperty(e.prototype,"visible",{get:function(){return this._isVisible},set:function(t){this._isVisible!==t&&(this._isVisible=t,this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"enable",{get:function(){return this._isEnabled},set:function(t){this._isEnabled!==t&&(this._isEnabled=t,this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){this._size!==t&&(this._size=t,this.emit("change",t,this))},enumerable:!1,configurable:!0}),e.prototype.snap=function(t,e){if(this._isEnabled){var n=this._size;e.set(t,Math.round(t/n)*n)}},e.prototype.reset=function(){this._isVisible=this._isVisibleDefault,this._isEnabled=this._isEnabledDefault,this._size=this._sizeDefault,this.emit("change",this)},e.prototype.serialize=function(){return[this._isEnabled?1:0,this._isVisible?1:0,this._size]},e.prototype.deserialize=function(t){this.enable=!!t[0],2 in t?(this.visible=!!t[1],this.size=t[2]):(this.visible=this._isVisibleDefault,this.size=t[1])},e}(t.utils.EventEmitter),cy=function(){function t(){this.distance=NaN,this.result=0,this.threshold=10}return t.prototype.reset=function(t,e){this.distance=NaN,this.result=t,this.threshold=1e-4<e?10/e:10},t.prototype.set=function(t,e){var n=Math.abs(e-t);if(n<=this.threshold){var i=this.distance;(i!=i||n<i)&&(this.distance=n,this.result=e)}},t}(),py={HORIZONTAL:0,VERTICAL:1},fy=function(){function t(t,e){this.type=t,this.position=e}return t.prototype.serialize=function(){return[this.type,this.position]},t}(),dy=function(t){function e(e,n){var i,r,o=t.call(this)||this;return o.values=[],o._isVisibleDefault=null!==(i=null==n?void 0:n.visible)&&void 0!==i?i:e.isSnapTargetVisible(),o._isVisible=o._isVisibleDefault,o._isEnabledDefault=null!==(r=null==n?void 0:n.enable)&&void 0!==r?r:e.isSnapTargetEnabled(),o._isEnabled=o._isEnabledDefault,o}return F(e,t),Object.defineProperty(e.prototype,"enable",{get:function(){return this._isEnabled},set:function(t){this._isEnabled!==t&&(this._isEnabled=t,this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"visible",{get:function(){return this._isVisible},set:function(t){this._isVisible!==t&&(this._isVisible=t,this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this.values.length},enumerable:!1,configurable:!0}),e.prototype.add=function(t,e){null!=e?this.values.splice(e,0,t):this.values.push(t),this.emit("change",this)},e.prototype.remove=function(t){var e=this.values;0<=t&&t<e.length&&(e.splice(t,1),this.emit("change",this))},e.prototype.replace=function(t,e){var n=this.values;if(0<=t&&t<n.length){var i=n[t];return n[t]=e,this.emit("change",this),i}return null},e.prototype.swap=function(t,e){if(t!==e){var n=this.values,i=n[t];n[t]=n[e],n[e]=i,this.emit("change",this)}},e.prototype.snap=function(t,e,n,i){if(this._isEnabled)for(var r=this.values,o=0,s=r.length;o<s;++o){var a=r[o];a.type===py.VERTICAL?n.set(t,a.position):i.set(e,a.position)}},e.prototype.reset=function(){this._isEnabled=this._isEnabledDefault,this._isVisible=this._isVisibleDefault,this.values.length=0,this.emit("change",this)},e.prototype.serialize=function(){for(var t=[],e=this.values,n=0,i=e.length;n<i;++n)t.push(e[n].serialize());return[this._isEnabled?1:0,this._isVisible?1:0,t]},e.prototype.deserialize=function(t){this._isEnabled=!!t[0],this._isVisible=!!t[1];var e=t[2],n=this.values;n.length=0;for(var i=0,r=e.length;i<r;++i){var o=e[i];n.push(new fy(o[0],o[1]))}this.emit("change",this)},e}(t.utils.EventEmitter),yy=1e-5,gy={NONE:0,TOP_LEFT:1,TOP_CENTER:2,TOP_RIGHT:3,MIDDLE_LEFT:4,MIDDLE_RIGHT:5,BOTTOM_LEFT:6,BOTTOM_CENTER:7,BOTTOM_RIGHT:8,ROTATION:9},vy=function(e){function n(n,i,r){var o,s=e.call(this)||this;return s._points=[new t.Point,new t.Point,new t.Point,new t.Point,new t.Point],s._normals=[new t.Point,new t.Point],s._lengths=[1,1],s._workScale=new t.Point,s._workSnapResultX=new cy,s._workSnapResultY=new cy,s._workScaleResult={distance:0,scale:new t.Point},s._workTranslate=new t.Point,s._workSnapRectangle=new t.Rectangle,s._workSnap=new t.Point,s.grid=new hy(i,null==r?void 0:r.grid),s.target=new dy(i,null==r?void 0:r.target),s._parent=n,s._isEnabledDefault=null!==(o=null==r?void 0:r.enable)&&void 0!==o?o:i.isSnapEnabled(),s._isEnabled=s._isEnabledDefault,s}return F(n,e),Object.defineProperty(n.prototype,"enable",{get:function(){return this._isEnabled},set:function(t){this._isEnabled!==t&&(this._isEnabled=t,this.emit("change",this))},enumerable:!1,configurable:!0}),n.prototype.prepare=function(t){t.updateTransform();var e=t.transform.localTransform,n=t.width,i=t.height,r=this._points;r[0].set(0,0),r[1].set(n,0),r[2].set(n,i),r[3].set(0,i),r[4].set(.5*n,.5*i),e.apply(r[0],r[0]),e.apply(r[1],r[1]),e.apply(r[2],r[2]),e.apply(r[3],r[3]),e.apply(r[4],r[4])},n.prototype.prepareForTranslate=function(t){this._isEnabled&&this.prepare(t)},n.prototype.snap=function(t,e){var n=t.x,i=t.y,r=this._parent.canvas,o=this._workSnapResultX,s=this._workSnapResultY;if(null!=r){var a=Math.max(r.scale.x,r.scale.y);o.reset(n,a),s.reset(i,a),o.set(n,0),o.set(n,r.width),s.set(i,0),s.set(i,r.height)}else o.reset(n,1),s.reset(i,1);return this.target.snap(n,i,o,s),this.grid.snap(n,o),this.grid.snap(i,s),e.x=Nu(o.distance)?NaN:o.result,e.y=Nu(s.distance)?NaN:s.result,e},n.prototype.toSnapped=function(t,e){var n=t.x,i=t.y;if(this._isEnabled){this.snap(t,e);var r=e.x,o=e.y;e.set(Nu(r)?n:r,Nu(o)?i:o)}else e.set(n,i);return e},n.prototype.toTranslationSnapped=function(t,e){var n=t.x,i=t.y,r=NaN,o=NaN;if(this._isEnabled)for(var s=this._workTranslate,a=this._points,u=0,l=a.length;u<l;++u){var h=a[u];if(s.set(h.x+n,h.y+i),this.snap(s,s),!Nu(s.x)){var c=s.x-h.x;(Nu(r)||Math.abs(c-n)<Math.abs(r-n))&&(r=c)}if(!Nu(s.y)){var p=s.y-h.y;(Nu(o)||Math.abs(p-i)<Math.abs(o-i))&&(o=p)}}return e.x=Nu(r)?n:r,e.y=Nu(o)?i:o,e},n.prototype.prepareForRotate=function(t){},n.prototype.getGridSizeRotation=function(){return 5},n.prototype.toRadian=function(t){return t/180*Math.PI},n.prototype.toDegree=function(t){return t/Math.PI*180},n.prototype.toRotationSnapped=function(t,e){if(this._isEnabled){var n=this.getGridSizeRotation(),i=t+e,r=Math.round(this.toDegree(i)),o=r%90;return Math.abs(o)<=n?this.toRadian(r-o)-t:90-n<=o?this.toRadian(r+(90-o))-t:o<=-90+n?this.toRadian(r-(90+o))-t:e}return e},n.prototype.calcNormalizedVector=function(t,e,n){var i=e.x-t.x,r=e.y-t.y,o=Math.sqrt(i*i+r*r);if(yy<o){var s=1/o;n.x=i*s,n.y=r*s}else n.x=1,n.y=0;return o},n.prototype.prepareForScale=function(t,e){if(this._isEnabled){this.prepare(t);var n=this._points,i=this._normals,r=this._lengths;switch(e){case gy.TOP_LEFT:r[0]=this.calcNormalizedVector(n[1],n[0],i[0]),r[1]=this.calcNormalizedVector(n[3],n[0],i[1]);break;case gy.TOP_CENTER:r[0]=this.calcNormalizedVector(n[3],n[0],i[0]);break;case gy.TOP_RIGHT:r[0]=this.calcNormalizedVector(n[0],n[1],i[0]),r[1]=this.calcNormalizedVector(n[2],n[1],i[1]);break;case gy.MIDDLE_LEFT:r[0]=this.calcNormalizedVector(n[1],n[0],i[0]);break;case gy.NONE:break;case gy.MIDDLE_RIGHT:r[0]=this.calcNormalizedVector(n[0],n[1],i[0]);break;case gy.BOTTOM_LEFT:r[0]=this.calcNormalizedVector(n[2],n[3],i[0]),r[1]=this.calcNormalizedVector(n[0],n[3],i[1]);break;case gy.BOTTOM_CENTER:r[0]=this.calcNormalizedVector(n[0],n[3],i[0]);break;case gy.BOTTOM_RIGHT:r[0]=this.calcNormalizedVector(n[3],n[2],i[0]),r[1]=this.calcNormalizedVector(n[1],n[2],i[1])}}},n.prototype.setScaleSnappedResult=function(t,e,n,i,r){if(yy<e&&(Nu(r.distance)||t<r.distance)){r.distance=t;var o=1+n/e;i?r.scale.x=o:r.scale.y=o}},n.prototype.calcScaleSnapped1D=function(t,e,n,i,r,o){var s=this._workScale;t.apply(e,s);var a=s.x,u=s.y;this.snap(s,s);var l=s.x,h=s.y;if(!Nu(l)){var c=Math.abs(n.x);if(yy<c){var p=(l-a)/n.x,f=Math.abs(p),d=(l-e.x)/n.x;this.setScaleSnappedResult(f,i,d,r,o)}}if(!Nu(h)){var y=Math.abs(n.y);if(yy<y){var g=(h-u)/n.y,v=(f=Math.abs(g),(h-e.y)/n.y);this.setScaleSnappedResult(f,i,v,r,o)}}},n.prototype.calcScaleSnappedX=function(t,e,n,i,r){this.calcScaleSnapped1D(t,e,n,i,!0,r)},n.prototype.calcScaleSnappedY=function(t,e,n,i,r){this.calcScaleSnapped1D(t,e,n,i,!1,r)},n.prototype.calcScaleSnapped2D=function(t,e,n,i,r){var o=this._workScale;t.apply(e,o);var s=o.x,a=o.y;this.snap(o,o);var u=o.x,l=o.y;if(Nu(u)){if(Nu(l))return;u=s}else Nu(l)&&(l=a);var h=n[0].x*n[1].y-n[1].x*n[0].y;if(yy<Math.abs(h)){var c=u-s,p=l-a,f=Math.abs(c*c+p*p);if(Nu(r.distance)||f<r.distance){r.distance=f;var d=u-e.x,y=l-e.y,g=(+n[1].y*d-n[1].x*y)/h,v=(-n[0].y*d+n[0].x*y)/h;r.scale.set(1+g/i[0],1+v/i[1])}}},n.prototype.calcScaleSnappedXY=function(t,e,n,i,r,o,s){this.calcScaleSnapped2D(t,e,r,o,s),this.calcScaleSnappedX(t,i,r[0],o[0],s),this.calcScaleSnappedY(t,n,r[1],o[1],s)},n.prototype.toScaleSnapped=function(t,e,n,i){if(this._isEnabled){var r=this._points,o=this._normals,s=this._lengths,a=this._workScaleResult;switch(a.distance=NaN,a.scale.set(i.x,i.y),e){case gy.TOP_LEFT:this.calcScaleSnappedXY(t,r[0],r[1],r[3],o,s,a);break;case gy.TOP_CENTER:this.calcScaleSnappedY(t,r[0],o[0],s[0],a),this.calcScaleSnappedY(t,r[1],o[0],s[0],a);break;case gy.TOP_RIGHT:this.calcScaleSnappedXY(t,r[1],r[0],r[2],o,s,a);break;case gy.MIDDLE_LEFT:this.calcScaleSnappedX(t,r[0],o[0],s[0],a),this.calcScaleSnappedX(t,r[3],o[0],s[0],a);break;case gy.NONE:break;case gy.MIDDLE_RIGHT:this.calcScaleSnappedX(t,r[1],o[0],s[0],a),this.calcScaleSnappedX(t,r[2],o[0],s[0],a);break;case gy.BOTTOM_LEFT:this.calcScaleSnappedXY(t,r[3],r[2],r[0],o,s,a);break;case gy.BOTTOM_CENTER:this.calcScaleSnappedY(t,r[2],o[0],s[0],a),this.calcScaleSnappedY(t,r[3],o[0],s[0],a);break;case gy.BOTTOM_RIGHT:this.calcScaleSnappedXY(t,r[2],r[3],r[1],o,s,a)}if(!Nu(a.distance)){if(i.copyFrom(a.scale),n)switch(e){case gy.TOP_LEFT:case gy.TOP_RIGHT:case gy.BOTTOM_LEFT:case gy.BOTTOM_RIGHT:i.x=i.y=Math.max(i.x,i.y);break;case gy.TOP_CENTER:case gy.BOTTOM_CENTER:i.x=i.y;break;case gy.MIDDLE_LEFT:case gy.MIDDLE_RIGHT:i.y=i.x}return!0}}return!1},n.prototype.reset=function(){this.enable=this._isEnabledDefault,this.target.reset(),this.grid.reset()},n.prototype.serialize=function(){return[this._isEnabled?1:0,this.target.serialize(),this.grid.serialize()]},n.prototype.deserialize=function(t){this.enable=!!t[0],this.target.deserialize(t[1]),this.grid.deserialize(t[2])},n}(t.utils.EventEmitter),_y=function(t){function e(e,n,i){var r=t.call(this,e,n.width,n.height,0,i)||this;return r._text=n,r}return F(e,t),e.prototype.render=function(t){var e=this.frame;t.drawImage(this._text.canvas,e.x,e.y,e.width,e.height)},e}(Ui),my=function(e,n,i,r){this.id=e,this.size=n,this.color=t.utils.hex2string(i),this.height=n+2*r,this.measured=!1,this.ascent=0,this.descent=0},by=function(){function e(e,n,i,r){this._id=e,this._canvas=document.createElement("canvas"),this._context=null;var o=this.toPadding(n);this._padding=o,this._font=new my(e,n,i,o),this._unrefCount=0,this._width=1,this._height=1,this._revisionUpdated=0,this._texture=t.Texture.from(this._canvas,{mipmap:t.MIPMAP_MODES.OFF,resolution:r,scaleMode:t.SCALE_MODES.NEAREST});var s=new Map;s.set(C.SPACE,this.newChar(C.SPACE,Ki.SPACE_R)),s.set(C.TAB,this.newChar(C.SOFT_TAB,Ki.SPACE_R)),s.set(C.DOTS,this.newChar(C.DOTS,Ki.LETTER_RNB));for(var a=C.ASCII.LOW.FROM;a<=C.ASCII.LOW.TO;++a){var u=String.fromCodePoint(a);s.set(u,this.newChar(u,Ki.LETTER_RNB))}for(a=C.ASCII.HIGH.FROM;a<=C.ASCII.HIGH.TO;++a)u=String.fromCodePoint(a),s.set(u,this.newChar(u,Ki.LETTER_RNB));this._characters=s,this._createds=new Map,this._revision=1}return e.prototype.toPadding=function(t){return Math.max(3,Math.ceil(.2*t))},Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"font",{get:function(){return this._font},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"canvas",{get:function(){return this._canvas},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"characters",{get:function(){return this._characters},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"texture",{get:function(){return this._texture},enumerable:!1,configurable:!0}),e.prototype.newChar=function(t,e){var n=this.getAdvance(t),i=this._padding,r=Math.ceil(i+n+i),o=this.font.height;return new Wi(e,t,-r,-o,r,o,n)},e.prototype.add=function(t,e){for(var n=this._characters,i=this._createds,r=0,o=t.length;r<o;){var s=t.charCodeAt(r);if(C.ASCII.LOW.FROM<=s&&s<=C.ASCII.LOW.TO||C.ASCII.HIGH.FROM<=s&&s<=C.ASCII.HIGH.TO)r+=1;else{for(var a=r+1;a<o;++a){var u=t.charCodeAt(a);if(!(C.SURROGATE.LOW.FROM<=u&&u<=C.SURROGATE.LOW.TO||C.VARIATION.FROM<=u&&u<=C.VARIATION.TO))break}var l=t.substring(r,a),h=n.get(l);if(null!=h)h.type&Ki.RESERVED||(0===h.ref&&(this._unrefCount-=1),h.ref+=1);else{var c=i.get(l);if(null!=c)c.ref=1,n.set(l,c);else{var p=this.newChar(l,e);n.set(l,p),i.set(l,p)}this._revision+=1}r=a}}},e.prototype.remove=function(t){for(var e=this._characters,n=0,i=t.length;n<i;){var r=t.charCodeAt(n);if(C.ASCII.LOW.FROM<=r&&r<=C.ASCII.LOW.TO||C.ASCII.HIGH.FROM<=r&&r<=C.ASCII.HIGH.TO)n+=1;else{for(var o=n+1;o<i;++o){var s=t.charCodeAt(o);if(!(C.SURROGATE.LOW.FROM<=s&&s<=C.SURROGATE.LOW.TO||C.VARIATION.FROM<=s&&s<=C.VARIATION.TO))break}var a=t.substring(n,o),u=e.get(a);null!=u&&0<u.ref&&!(u.type&Ki.RESERVED)&&(u.ref-=1,0===u.ref&&(this._unrefCount+=1)),n=o}}},e.prototype.cleanup=function(){var t=this._characters;t.size>>1<=this._unrefCount&&(t.forEach((function(e,n){e.ref<=0&&t.delete(n)})),this._revision+=1,this._unrefCount=0)},e.prototype.get=function(t){return this._characters.get(t)},e.prototype.getAdvance=function(t){var e=this.getContext();return null!=e?e.measureText(t).width:0},e.prototype.getContext=function(){var t=this._context;if(null==t){var e=this._canvas;if(null==e)return null;if(null==(t=this._context=e.getContext("2d",{alpha:!0})))return null}var n=this._font;return t.font!==n.id&&(t.font=n.id,n.id=t.font,t.textAlign="left",t.textBaseline="alphabetic",t.lineWidth=0,t.lineCap="round",t.lineJoin="miter",t.miterLimit=10,t.fillStyle=n.color,t.strokeStyle="#0000ff"),t},e.prototype.update=function(){if(this.cleanup(),this._revisionUpdated<this._revision){this._revisionUpdated=this._revision;var t=this._canvas;if(null!=t){var e=this._font,n=e.height,i=this._characters,r=this._width=this.toPowerOf2(Math.ceil(Math.sqrt(i.size))*n),o=this._padding,s=0,a=0;i.forEach((function(t){r<=s+t.width&&(s=0,a+=n),t.x=s,t.y=a,t.origin.x=s+o,s+=t.width}));var u=this._height=a+n,l=this._texture.baseTexture,h=l.resolution,c=Math.ceil(r*h),p=Math.ceil(u*h);t.width=c,t.height=p;var f=this.getContext();if(null!=f){qi.measure(f,e);var d=Math.round(.5*(n-(e.ascent+e.descent))+e.ascent);f.save(),f.scale(h,h),f.clearRect(0,0,r,u),i.forEach((function(t){t.origin.y=t.y+d,f.fillText(t.character,t.origin.x,t.origin.y)})),f.restore()}return l.setRealSize(c,p),!0}}return!1},e.prototype.getRevision=function(){return this._revision},e.prototype.getRevisionUpdate=function(){return this._revisionUpdated},Object.defineProperty(e.prototype,"length",{get:function(){return this._characters.size},enumerable:!1,configurable:!0}),e.prototype.destroy=function(){null!=this._canvas&&(this._canvas=null),this._characters.clear(),this._createds.clear(),this._unrefCount=0},e.prototype.toPowerOf2=function(t){for(var e=32;e<t;)e<<=1;return e},e}(),Ty=function(t){t.update()},wy=function(t){t.forEach(Ty)},Ey=function(t){t.update()},Oy=function(t){t.forEach(Ey)},Cy=function(){function t(t){var e=this;this._atlases=new Map,this._resolution=t.renderer.resolution,t.renderer.on("prerender",(function(){e.update()}))}return t.prototype.add=function(t,e,n,i){var r=this._atlases,o=r.get(t);null==o&&(o=new Map,r.set(t,o));var s=o.get(n);null==s&&(s=new by(t,e,n,this._resolution),o.set(n,s)),s.add(i,Ki.LETTER)},t.prototype.remove=function(t,e,n){var i=this._atlases.get(t);if(null!=i){var r=i.get(e);null!=r&&r.remove(n)}},t.prototype.get=function(t,e){var n=this._atlases.get(t);if(null==n)return null;var i=n.get(e);return null==i?null:i},t.prototype.update=function(){this._atlases.forEach(wy)},t.prototype.destroy=function(){var t=this._atlases;t.forEach(Oy),t.clear()},t}(),Sy=function(t){if("object"==typeof t&&"[object Object]"===Object.prototype.toString.call(t)){var e=Object.getPrototypeOf(t);return null==e||e===Object.prototype}return!1},xy=function(){function t(t,e,n){var i=this;this.instance=null,this.newInstance=t,this.options=e,null!=n&&(n.state.isActive&&setTimeout((function(){i.get()}),0),n.on("active",(function(){i.get()})))}return t.prototype.get=function(){var t=this.instance;return null==t&&(t=new this.newInstance(this.options),this.instance=t),t},t}(),Dy=function(t,e,n,i){for(var r=0,o=Math.floor(t.length/n)-1;r<=o;){var s=r+(o-r>>1),a=t[s*n+i];if(e<a)o=s-1;else{if(!(a<e))return s;r=s+1}}return Math.max(r,o)},Iy=function(t){return Ot(t)?function(t){for(var e=[],n=0,i=t.length;n<i;++n)e[n]=t[n];return e}(t):Sy(t)?function(t){var e={};for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=Iy(t[n]));return e}(t):t},Ay=function(t){if(null!=t){if(xt(t))return t;if(St(t))return String(t);if("name"in t)return t.name;if("label"in t)return t.label;if("id"in t)return t.id}return""},Ry=function(t,e){if(null!=t){var n=Iy(t);if(null!=e)for(var i in e)if(Object.prototype.hasOwnProperty.call(e,i)){var r=e[i];if(Sy(r))if(Object.prototype.hasOwnProperty.call(n,i)){var o=n[i];Sy(o)&&Ry(o,r)}else n[i]=Iy(r);else Object.prototype.hasOwnProperty.call(n,i)||(n[i]=r)}return n}return null!=e?Iy(e):{}},Py=function(){function e(e){var n,i,r,o,s,a;this._width=null!==(n=e.width)&&void 0!==n?n:256,this._ratio=null!==(i=e.ratio)&&void 0!==i?i:1,this._margin=null!==(r=e.margin)&&void 0!==r?r:3;var u=e.resolution;if(null!=u)this._resolution=u;else{var l=null!==(o=window.devicePixelRatio)&&void 0!==o?o:1;this._resolution=2<l?l:2*l}this._scaling=null!==(s=e.scaling)&&void 0!==s?s:t.settings.SCALE_MODE,this._mipmap=null!==(a=e.mipmap)&&void 0!==a?a:t.settings.MIPMAP_TEXTURES,this._frames={},this._svg="",this._nextX=0,this._nextY=0,this._height=0}return Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"ratio",{get:function(){return this._ratio},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"margin",{get:function(){return this._margin},enumerable:!1,configurable:!0}),e.prototype.add=function(e,n,i,r,o,s,a,u){var l=this._frames;if(!(e in l)){var h=this._margin,c=this._nextX,p=this._nextY;this._width<=c+n?(c=0,p=this._nextY+this._height+h,this._height=i,this._nextY=p):this._height=Math.max(this._height,i),this._nextX=c+n+h,l[e]=new t.Rectangle(c+(null!=o?o:0),p+(null!=s?s:0),null!=a?a:n,null!=u?u:i);var f=this._ratio;return this._svg+='<g transform="translate('.concat(c*f,",").concat(p*f,')">').concat(r,"</g>"),!0}return!1},e.prototype.has=function(t){return t in this._frames},Object.defineProperty(e.prototype,"mappings",{get:function(){return this.build()},enumerable:!1,configurable:!0}),e.prototype.build=function(e){var n,i,r=this._built;if(null==r||(null==e?void 0:e.force)){var o=null!==(n=null==e?void 0:e.resolution)&&void 0!==n?n:this._resolution,s=this._width,a=Math.pow(2,Math.ceil(Math.log(this._nextY+this._height)/Math.LN2)),u=s*o,l=a*o,h=this._ratio,c='width="'.concat(u,'"'),p='height="'.concat(l,'"'),f='viewBox="0 0 '.concat(s*h," ").concat(a*h,'"'),d=oy("<svg ".concat(c," ").concat(p," ").concat(f," ").concat('xmlns="http://www.w3.org/2000/svg"',">").concat(this._svg,"</svg>")),y=null!==(i=null==e?void 0:e.scaling)&&void 0!==i?i:this._scaling,g=t.BaseTexture.from(d,{resolution:o,scaleMode:y,mipmap:this._mipmap}),v=this._frames;for(var _ in r=this._built={},v)r[_]=new t.Texture(g,v[_])}return r},e}(),My={TEXT:0,DATA_URL:1,BINARY_STRING:2,ARRAY_BUTTER:3,FILE:4},ky=function(){function t(t,e){this._input=null,this._as=t,this._facade=e}return t.prototype.open=function(){var t=this.getOrCreateInput();null!=t?t.click():this.onCancel()},t.prototype.getOrCreateInput=function(){var t=this;if("FileReader"in window&&null==this._input){var e=document.createElement("input");this._input=e,e.setAttribute("type","file"),e.setAttribute("style","display:none"),e.addEventListener("change",(function(n){t.onInputChange(e),e.value="",n.stopImmediatePropagation(),n.preventDefault()})),document.body.appendChild(e)}return this._input},t.prototype.onInputChange=function(t){var e=this,n=t.files;if(null!=n&&0<n.length){var i=n[0];if(this._as===My.FILE)this.onOpen(i,i);else{var r=new FileReader;switch(r.onload=function(t){if(null!=t.target){var n=t.target;e.onOpen(n.result,i)}},r.onabort=function(t){e.onAboart(t)},this._as){case My.TEXT:r.readAsText(i);break;case My.DATA_URL:r.readAsDataURL(i);break;case My.BINARY_STRING:r.readAsBinaryString(i);break;case My.ARRAY_BUTTER:r.readAsArrayBuffer(i);break;default:r.readAsText(i)}}}else this.onCancel()},t.prototype.onOpen=function(t,e){var n=this._facade;n.emit("open",t,e,n)},t.prototype.onAboart=function(t){var e=this._facade;e.emit("abort",t,e)},t.prototype.onCancel=function(){var t=this._facade;t.emit("cancel",t)},t}(),Ly=function(){function t(){}return t.fromRgb=function(t){var e=(16711680&t)>>16,n=(65280&t)>>8,i=255&t|0,r=Math.max(e,n,i),o=r-Math.min(e,n,i),s=0;return 0<o&&(e===r?s=60*(n-i)/o:n===r?s=60*(i-e)/o+120:i===r&&(s=60*(e-n)/o+240),s<0&&(s+=360)),[s,o/r*255,r]},t.toRgb=function(t,e,n){var i=n-e/255*n,r=n-i,o=0,s=0,a=0;return t<=60?(o=n,s=t/60*r+i,a=i):t<=120?(o=(120-t)/60*r+i,s=n,a=i):t<=180?(o=i,s=n,a=(t-120)/60*r+i):t<=240?(o=i,s=(240-t)/60*r+i,a=n):t<=300?(o=(t-240)/60*r+i,s=i,a=n):(o=n,s=i,a=(360-t)/60*r+i),(o=Math.max(0,Math.min(255,o)))<<16|(s=Math.max(0,Math.min(255,s)))<<8|Math.max(0,Math.min(255,a))},t}(),Ny=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onElementAttached=function(e,n,i){e.addEventListener("keydown",this._onInputKeyDownBound),t.prototype.onElementAttached.call(this,e,n,i)},e.prototype.onElementDetached=function(e,n,i){e.removeEventListener("keydown",this._onInputKeyDownBound),t.prototype.onElementDetached.call(this,e,n,i)},e.prototype.onInputKeyDown=function(t){no.isOkKey(t)&&this._operation.onEnter()},e}(ys),By=function(){function t(){}return t.create=function(t){var e=this._mapping;return t in e?"".concat(t," ").concat(++e[t]):(e[t]=1,"".concat(t," 1"))},t._mapping={},t}(),zy=function(){function t(){}return t.toCode=function(t,e){var n=t>>8&255,i=255&t;return"rgba(".concat(t>>16&255,",").concat(n,",").concat(i,",").concat(e,")")},t}(),Uy=function(){function t(t,e,n){var i=this;this._targets=new Set,this._state=t,this._delay=e,this._interval=n,this._timeout=null,this._updateBound=function(){i.update()}}return t.prototype.start=function(){return null==this._timeout&&(this._timeout=window.setTimeout(this._updateBound,this._delay)),this},t.prototype.stop=function(){var t=this._timeout;return null!=t&&(this._timeout=null,clearTimeout(t)),this},t.prototype.add=function(t){return this._targets.add(t),t.state.set(this._state,this.isOn(Date.now())),this},t.prototype.remove=function(t){return!!this._targets.delete(t)&&(t.state.remove(this._state),!0)},t.prototype.contains=function(t){return this._targets.has(t)},t.prototype.clear=function(){return this._targets.clear(),this},t.prototype.isOn=function(t){return Math.floor(t/this._interval)%2==0},t.prototype.update=function(){var t=Date.now(),e=this.isOn(t),n=this._state;this._targets.forEach((function(t){t.state.set(n,e)}));var i=this._interval;return this._timeout=window.setTimeout(this._updateBound,i-t%i),this},t}(),jy=function(){function t(t){var e;this._duration=null!==(e=null==t?void 0:t.duration)&&void 0!==e?e:300,this._current=null,this._lastUpdate=0,this._updateId=null}return t.prototype.show=function(t,e){var n=this,i=this._updateId;null!=i&&clearTimeout(i);var r=this._current;if(t!==r){var o=this._duration,s=this._lastUpdate,a=Date.now(),u=s+o-a;!0===e||u<=0?this.update(a,t):this._updateId=window.setTimeout((function(){n.update(Date.now(),t)}),u)}},t.prototype.update=function(t,e){var n=this._current;n!==e&&(this._lastUpdate=t,null!=n&&n.hide(),this._current=e,null!=e&&e.show())},t.prototype.hide=function(){this.show(null)},t}(),Fy=function(){function t(){this._lowest=null,this._timestamp=0,this._lineHeight=null,this._pageHeight=null}return t.prototype.getNames=function(){var t=this._names;return null==t&&(t="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DOMMouseScroll","MozMousePixelScroll"],this._names=t),t},t.prototype.on=function(t,e,n){void 0===n&&(n=!1);for(var i=this.getNames(),r=i.length-1;0<=r;--r){var o=i[r];t.addEventListener(o,e,n)}},t.prototype.off=function(t,e,n){void 0===n&&(n=!1);for(var i=this.getNames(),r=i.length-1;0<=r;--r){var o=i[r];t.removeEventListener(o,e,n)}},t.prototype.getLineHeight=function(){if(null==this._lineHeight){var t=it.getInstance().get("DBase");this._lineHeight=t.getLineHeight()}return this._lineHeight},t.prototype.getPageHeight=function(){return null==this._pageHeight&&(this._pageHeight=12*this.getLineHeight()),this._pageHeight},t.prototype.normalize=function(t){var e=0,n=0;if("detail"in t&&(n=-1*t.detail),"wheelDelta"in t&&(n=t.wheelDelta),"wheelDeltaY"in t&&(n=t.wheelDeltaY),"wheelDeltaX"in t&&(e=-1*t.wheelDeltaX),"axis"in t&&t.axis===t.HORIZONTAL_AXIS&&(e=-1*n,n=0),"deltaY"in t&&(n=-1*t.deltaY),"deltaX"in t&&(e=t.deltaX),0===n&&0===e)return null;var i=Math.max(Math.abs(n),Math.abs(e)),r=Date.now();this._timestamp+200<=r&&(this._lowest=null),this._timestamp=r;var o="mousewheel"===t.type&&i%120==0;(!this._lowest||i<this._lowest)&&(this._lowest=i,o&&(this._lowest/=40)),o&&(i/=40,e/=40,n/=40);var s=this._lowest;i=Math.floor(i/s),e=Math[1<=e?"floor":"ceil"](e/s),n=Math[1<=n?"floor":"ceil"](n/s);var a=t.deltaMode||0;if(0!==a){var u=1===a?this.getLineHeight():this.getPageHeight();i*=u,e*=u,n*=u}return{mode:a,delta:i,deltaX:e,deltaY:n,lowest:s}},t.getInstance=function(){return null==this.INSTANCE&&(this.INSTANCE=new t),this.INSTANCE},t}(),Hy=function(t){function e(e){var n,i=t.call(this)||this;return i._target=null!==(n=null==e?void 0:e.target)&&void 0!==n?n:null,i._reverse=!1,i._isStarted=!1,i._onTime=null==e?void 0:e.onTime,i._onStart=null==e?void 0:e.onStart,i._onEnd=null==e?void 0:e.onEnd,i}return F(e,t),Object.defineProperty(e.prototype,"target",{get:function(){return this._target},set:function(t){this._target=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"duration",{get:function(){return 0},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.start=function(t){void 0===t&&(t=!1),this.stop(),this._isStarted=!0,this._reverse=t,this.onStart(t),this._isStarted&&(this.onTime(t?1:0,t,0),this._isStarted&&(this.onTime(t?0:1,t,0),this._isStarted||this.onEnd(t)))},e.prototype.onStart=function(t){var e=this._onStart;null!=e&&e(t,this),this.emit("start",t,this)},e.prototype.onTime=function(t,e,n){var i=this._onTime;null!=i&&i(t,e,n,this),this.emit("time",t,e,n,this)},e.prototype.onEnd=function(t){var e=this._onEnd;null!=e&&e(t,this),this.emit("end",t,this)},e.prototype.isStarted=function(){return this._isStarted},e.prototype.isReverse=function(){return this._reverse},e.prototype.stop=function(){this._isStarted=!1},e.prototype.end=function(){if(this._isStarted){this._isStarted=!1;var t=this._reverse,e=t?0:1;this.onTime(e,t,0),this.onEnd(t)}},e}(t.utils.EventEmitter),Gy=function(t){function e(e){var n,i,r=t.call(this,e)||this;r._storedX=0,r._storedY=0,r._storedAlpha=0,r._storedTime=0,r._storedTarget=null,r._layer=null;var o=null==e?void 0:e.shift;return r._shiftX=null!==(n=null==o?void 0:o.x)&&void 0!==n?n:0,r._shiftY=null!==(i=null==o?void 0:o.y)&&void 0!==i?i:15,r._onPrerenderBound=function(){r.onPrerender()},r._onPostrenderBound=function(){r.onPostrender()},r}return F(e,t),e.prototype.stop=function(){this._storedTime=0,this.removeEventListeners(),t.prototype.stop.call(this)},e.prototype.addEventListeners=function(t){var e=ft.getLayer(t);if(e){this._layer=e;var n=e.renderer;n.on("prerender",this._onPrerenderBound),n.on("postrender",this._onPostrenderBound)}},e.prototype.removeEventListeners=function(){var t=this._layer;if(t){this._layer=null;var e=t.renderer;e.off("prerender",this._onPrerenderBound),e.off("postrender",this._onPostrenderBound)}},e.prototype.onStart=function(e){var n=this._storedTarget=this._target;null!=n&&(this._storedTime=0,this.removeEventListeners(),this.addEventListeners(n),e||(n.visible=!0),t.prototype.onStart.call(this,e))},e.prototype.onTime=function(e,n,i){if(null!=this._storedTarget){var r=this._layer;r?(this._storedTime=e,t.prototype.onTime.call(this,e,n,i),r.update()):(this._storedTime=e,t.prototype.onTime.call(this,e,n,i))}},e.prototype.onEnd=function(e){var n=this._storedTarget;null!=n&&(this.removeEventListeners(),e&&(n.visible=!1),t.prototype.onEnd.call(this,e))},e.prototype.onPrerender=function(){var t=this._storedTarget;if(null!=t){var e=this._storedTime,n=t.unsafe.position;this._storedX=n.x,this._storedY=n.y,n.set(n.x-this._shiftX*(1-e),n.y-this._shiftY*(1-e)),this._storedAlpha=t.alpha,t.alpha=e}},e.prototype.onPostrender=function(){var t=this._storedTarget;null!=t&&(t.unsafe.position.set(this._storedX,this._storedY),t.alpha=this._storedAlpha)},e}(dr),Vy=function(){function t(t){var e,n,i,r;St(t)?(this.top=t,this.right=t,this.bottom=t,this.left=t):null!=t?(this.top=null!==(e=t.top)&&void 0!==e?e:6,this.right=null!==(n=t.right)&&void 0!==n?n:6,this.bottom=null!==(i=t.bottom)&&void 0!==i?i:6,this.left=null!==(r=t.left)&&void 0!==r?r:6):(this.top=6,this.right=6,this.bottom=6,this.left=6)}return t.prototype.getTheme=function(){throw new Error("Not supported")},t.prototype.setTheme=function(t){throw new Error("Not supported")},t.prototype.getTop=function(){return this.left},t.prototype.getRight=function(){return this.right},t.prototype.getBottom=function(){return this.bottom},t.prototype.getLeft=function(){return this.left},t.prototype.set=function(t,e,n,i){null==e?(this.top=t,this.right=t,this.bottom=t,this.left=t):null==n?(this.top=t,this.right=e,this.bottom=t,this.left=e):null==i?(this.top=t,this.right=e,this.bottom=n,this.left=e):(this.top=t,this.right=e,this.bottom=n,this.left=i)},t}(),Wy=function(){function t(t){var e,n=t.root;this._root=n,this._overlay=t.overlay,this._padding=new Vy(null==t?void 0:t.padding);var i=100,r=100;if(t)if(null!=t.width)i=t.width,r=null!=t.height?t.height:n.getBoundingClientRect().height;else if(null!=t.height)i=n.getBoundingClientRect().width,r=t.height;else{var o;i=(o=n.getBoundingClientRect()).width,r=o.height}else i=(o=n.getBoundingClientRect()).width,r=o.height;this._isWidthFixed=null!=t.width,this._isHeightFixed=null!=t.height;var s=null==t?void 0:t.background,a=0,u=!0;if(null!=s){var l=s.color;null!=l&&(a=l,u=!1)}var h=t.resolution,c=null!==(e=null==t?void 0:t.antialias)&&void 0!==e&&e;this._pixi={width:i,height:r,autoStart:!1,backgroundColor:a,transparent:u,resolution:h,antialias:c}}return t.prototype.getRootElement=function(){return this._root},t.prototype.setRootElement=function(t,e){if(this._root!==t&&(this._root=t,!1!==e)){var n=t.getBoundingClientRect(),i=this._pixi;i.width=n.width,i.height=n.height}return this},t.prototype.getWidth=function(){return this._pixi.width},t.prototype.setWidth=function(t){return this._pixi.width=t,this},t.prototype.isWidthFixed=function(){return this._isWidthFixed},t.prototype.setWidthFixed=function(t){return this._isWidthFixed=t,this},t.prototype.getHeight=function(){return this._pixi.height},t.prototype.setHeight=function(t){return this._pixi.height=t,this},t.prototype.isHeightFixed=function(){return this._isHeightFixed},t.prototype.setHeightFixed=function(t){return this._isHeightFixed=t,this},t.prototype.getPadding=function(){return this._padding},t.prototype.setPadding=function(t,e,n,i){var r=this._padding;return r.left=t,r.top=e,r.right=n,r.bottom=i,this},t.prototype.getBackgroundColor=function(){return this._pixi.backgroundColor},t.prototype.setBackgroundColor=function(t){return this._pixi.backgroundColor=t,this},t.prototype.getAntialias=function(){return this._pixi.antialias},t.prototype.setAntialias=function(t){return this._pixi.antialias=t,this},t.prototype.isOverlay=function(){return this._overlay},t.prototype.getPixiApplicationOptions=function(){return this._pixi},t}(),Ky=function(){function t(){}return t.prototype.isStorable=function(){return!0},t.prototype.isClear=function(){return!1},t.prototype.isClean=function(){return!1},t.prototype.execute=function(){return!0},t.prototype.merge=function(t){return!1},t.prototype.isMerged=function(){return!1},t.prototype.redo=function(){return!0},t.prototype.undo=function(){return!0},t.prototype.destroy=function(){},t}(),Xy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.isStorable=function(){return!1},e.prototype.isClear=function(){return!0},e}(Ky),Yy=function(t){function e(){var e=t.call(this)||this;return e._position=0,e._done=[],e}return F(e,t),e.prototype.last=function(){var t=this._done,e=t.length;return 0<e?t[e-1]:null},e.prototype.push=function(t){this.merge(t),this.execute(t)},e.prototype.merge=function(t){var e=this._done,n=t.isClear(),i=t.isStorable();if(n||i){var r=n?e.length:this._position;0<r&&(this.remove(r),this._position=0,this.emit("change",this)),this.cleanup()}var o=e.length;0<o&&t.merge(e[o-1])},e.prototype.execute=function(t){return this.emit("executing",t,this),t.execute()?this.onSuccess(t):this.onFail(t)},e.prototype.onSuccess=function(t){t.isStorable()&&(t.isMerged()||this._done.push(t),t.isClean()||this.emit("dirty",this)),this.emit("change",this),this.emit("executed",t,this)},e.prototype.onFail=function(t){t.destroy(),this.emit("change",this)},e.prototype.cleanup=function(){var t=this._done,e=t.length-100;if(0<e)for(var n=0;n<e;++n)t[n].destroy(),t.shift()},e.prototype.remove=function(t){var e=this._done;if(0<t){var n=Math.max(0,e.length-t);if(0<(t=e.length-n)){for(var i=n,r=e.length;i<r;++i)e[i].destroy();return e.splice(n,e.length-n),!0}}return!1},e.prototype.size=function(){return this._done.length},e.prototype.clear=function(){this.push(new Xy)},e.prototype.redo=function(){this.isRedoable()&&this.doRedo()},e.prototype.doRedo=function(){var t=this._done;if(0<this._position){var e=t[t.length-this._position];this._position-=1,this.emit("change",this),this.emit("redoing",e,this),!0===e.redo()?this.onRedoSuccess(e):this.onRedoFail(e)}},e.prototype.onRedoSuccess=function(t){t.isClean()||this.emit("dirty",this),this.emit("change",this),this.emit("redoed",t,this)},e.prototype.onRedoFail=function(t){this.emit("change",this)},e.prototype.isRedoable=function(){return 0<this._position},e.prototype.undo=function(){this.isUndoable()&&this.doUndo()},e.prototype.doUndo=function(){var t=this._done;if(this._position<t.length){var e=t[t.length-1-this._position];this._position+=1,this.emit("change",this),this.emit("undoing",e,this),!0===e.undo()?this.onUndoSuccess(e):this.onUndoFail(e)}},e.prototype.onUndoSuccess=function(t){t.isClean()||this.emit("dirty",this),this.emit("change",this),this.emit("undoed",t,this)},e.prototype.onUndoFail=function(t){this.emit("change",this)},e.prototype.isUndoable=function(){return this._position<this._done.length},e}(t.utils.EventEmitter),qy=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(t,e,n){var i=this;t.addEventListener("keydown",(function(t){i.emit("keydown",t);var r=n.get();if(null!=r)for(var o=r;null!=o;){if(i.hasOnKeyDown(o)&&o.onKeyDown(t))return;o=o.parent}if(no.isFocusKey(t)){var s=no.getFocusDirection(t),a=null!=r?n.find(r,!1,r.state.isFocusRoot||s,s):n.find(e,!1,!0,s);null!=a&&(n.focus(a),t.preventDefault(),t.stopImmediatePropagation())}})),t.addEventListener("keyup",(function(t){i.emit("keyup",t);var e=n.get();if(null!=e)for(var r=e;null!=r;){if(i.hasOnKeyUp(r)&&r.onKeyUp(t))return;r=r.parent}}))},e.prototype.hasOnKeyDown=function(t){return"onKeyDown"in t},e.prototype.hasOnKeyUp=function(t){return"onKeyUp"in t},e}(t.utils.EventEmitter),Zy=function(){function t(){}return t.getKeyboardController=function(){return null==this.KEYBOARD&&(this.KEYBOARD=new qy),this.KEYBOARD},t.setKeyboardController=function(t){var e=this.KEYBOARD;return this.KEYBOARD=t,e},t.getCommandController=function(){return null==this.COMMAND&&(this.COMMAND=new Yy),this.COMMAND},t.setCommandController=function(t){var e=this.COMMAND;return this.COMMAND=t,e},t.getDocumentController=function(){if(null==this.DOCUMENT)throw new Error("Not supported");return this.DOCUMENT},t.setDocumentController=function(t){var e=this.DOCUMENT;return this.DOCUMENT=t,e},t}(),Jy=function(e){function n(t,n){var i=e.call(this,n.getPixiApplicationOptions())||this;return i._renderId=null,i._dynamicFontAtlases=null,i._options=n,i._isLocked=!1,i._isVisible=!0,i._isOverlay=n.isOverlay(),i._padding=n.getPadding(),i._rootElement=n.getRootElement(),i._reflowLimit=5,i._elementContainer=i.newElementContainer(),i.application=t,i._renderBound=function(){null!=i._renderId&&i.render()},i.initStage(),i.initView(),i.initRootElement(),i.initFocusHandling(),i.initResizeHandling(),i.initWheelHandling(),i.initDoubleClickHandling(),i}return F(n,e),n.prototype.newElementContainer=function(){var t=document.createElement("div");return t.setAttribute("style","position: absolute; top: 0; left: 0; width: 0; height: 0;margin: 0; padding: 0; outline: none;"),t},n.prototype.initStage=function(){var t=this.stage;t.layer=this,t.application=this.application,t.interactive=!0},n.prototype.initView=function(){var t=this.view.style;t.position="absolute",t.top="0",t.left="0",t.width="100%",t.height="100%",t.display="block",t.outline="none",t.webkitTapHighlightColor="rgba(255,255,255,0)",t.webkitUserSelect="none",t.setProperty("-khtml-user-select","none"),t.setProperty("-moz-user-select","none"),t.setProperty("-ms-user-select","none"),t.userSelect="none"},n.prototype.initRootElement=function(){var t=this,e=this.view,n=this._isOverlay,i=this._rootElement,r=this._elementContainer,o=n?2:0,s=i.children;if(o<s.length){var a=s[o];i.insertBefore(e,a),i.insertBefore(r,a)}else i.appendChild(e),i.appendChild(r);if(n){var u=this.stage,l=u.onChildrenChange;u.onChildrenChange=function(){t.onStageDirty(),l.call(u)}}var h=i.style;i!==document.body&&"static"===window.getComputedStyle(i).position&&(h.position="relative"),h.margin="0",h.padding="0",h.overflow="hidden"},n.prototype.initFocusHandling=function(){var t=this.view,e=this.stage,n=this.getFocusController();t.setAttribute("tabindex","0"),Zy.getKeyboardController().init(t,e,n),this.renderer.plugins.interaction.on(cr.down,(function(t){null!=t.target&&t.target!==e||n.clear()}))},n.prototype.initResizeHandling=function(){var t=this,e=this._options,n=e.isWidthFixed(),i=e.isHeightFixed();if(!n||!i){var r=function(){t.onResize()};null!=window.ResizeObserver?new ResizeObserver(r).observe(this._rootElement):(window.addEventListener("resize",r),window.addEventListener("orientationchange",r))}},n.prototype.onResize=function(){var t=this._options,e=this._rootElement.getClientRects();if(!(e.length<=0)){var n=e[0],i=t.isWidthFixed()?t.getWidth():n.width,r=t.isHeightFixed()?t.getHeight():n.height;this.renderer.resize(i,r);var o=this._isLocked;this._isLocked=!0;for(var s=this._padding,a=this.stage.children,u=0,l=a.length;u<l;++u){var h=a[u];h instanceof ao&&h.onParentResize(i,r,s)}this._isLocked=o,this._isLocked||null!=this._renderId||this.render()}},n.prototype.initWheelHandling=function(){var e=new t.Point,n=Fy.getInstance(),i=this.renderer.plugins.interaction;n.on(this.view,(function(t){var r=t;cr.toGlobal(r,i,e);var o,s=i.hitTest(e),a=n.normalize(t);if(null!=a)for(;null!=s;){if(null!=(o=s)&&null!=o.onWheel&&s.onWheel(r,a,e)){r.preventDefault();break}s=s.parent}}))},n.prototype.initDoubleClickHandling=function(){var t=this.getFocusController(),e=this.renderer.plugins.interaction;cr.onDblClick(this.view,(function(n){var i,r=t.get();if(null!=r)for(var o=r;null!=o&&(null==(i=o)||null==i.onDblClick||!o.onDblClick(n,e));)o=o.parent}))},n.prototype.lock=function(){this._isLocked=!0},n.prototype.unlock=function(){this._isLocked=!1},n.prototype.update=function(){this._isLocked||null!=this._renderId||(this._renderId=requestAnimationFrame(this._renderBound))},n.prototype.onStageDirty=function(){this._isOverlay&&(0<this.stage.children.length?this._isVisible||(this._isVisible=!0,this.view.style.display="block"):this._isVisible&&(this._isVisible=!1,this.view.style.display="none"))},n.prototype.render=function(){this.reflow(),this._renderId=null,e.prototype.render.call(this)},Object.defineProperty(n.prototype,"width",{get:function(){return this.screen.width},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"height",{get:function(){return this.screen.height},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"padding",{get:function(){return this._padding},enumerable:!1,configurable:!0}),n.prototype.reflow=function(){for(var t=this.stage.children,e=0,n=this._reflowLimit;e<n;++e){for(var i=!1,r=0,o=t.length;r<o;++r){var s=t[r];s instanceof ao&&(s.reflow(),i=i||s.isDirty()||s.hasDirty()||s.isHierarchyDirty())}if(!i)break}},n.prototype.getFocusController=function(){return this.application.getFocusController()},n.prototype.getRootElement=function(){return this._rootElement},n.prototype.getElementContainer=function(){return this._elementContainer},n.prototype.getDynamicFontAtlases=function(){return null==this._dynamicFontAtlases&&(this._dynamicFontAtlases=new Cy(this)),this._dynamicFontAtlases},n}(t.Application),Qy=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._focused=null,e}return F(e,t),e.prototype.focus=function(t){var e=this._focused;return e!==t?(null!=e&&(e.state.isFocused=!1),this._focused=t,this.isFocusable(t)&&(t.state.isFocused=!0),this.emit("change",t,e,this),e):null},e.prototype.blur=function(t){return null!=t&&this._focused===t?(this._focused=null,t.state.isFocused=!1,this.emit("change",null,t,this),t):null},e.prototype.clear=function(){return this.focus(null)},e.prototype.set=function(t,e){return e?this.focus(t):this.blur(t)},e.prototype.get=function(){return this._focused},e.prototype.findParent=function(t){for(var e=t;null!=e;){if(this.isFocusable(e))return e;e=e.parent}return null},e.prototype.find=function(t,e,n,i,r){if(i){if(null!=(u=this.findNext(t,e,n)))return u;if(this.isFocusRoot(t,r))return null;var o=t.parent;if(null!=o&&0<=(h=(l=o.children).indexOf(t))){var s=l.length;if(this.isFocusReverse(o)){for(var a=h-1;0<=a;--a)if(null!=(p=this.findNext(l[a],!0,!0)))return p;if(!this.isFocusRoot(o,r)&&null!=(p=this.find(o,!1,!1,!0,r)))return p;for(a=s-1;h<=a;--a)if(null!=(p=this.findNext(l[a],!0,!0)))return p}else{for(a=h+1;a<s;++a)if(null!=(p=this.findNext(l[a],!0,!0)))return p;if(!this.isFocusRoot(o,r)&&null!=(p=this.find(o,!1,!1,!0,r)))return p;for(a=0;a<=h;++a)if(null!=(p=this.findNext(l[a],!0,!0)))return p}}}else{var u;if(null!=(u=this.findPrevious(t,e,n)))return u;var l,h,c=t.parent;if(null!=c&&0<=(h=(l=c.children).indexOf(t)))if(s=l.length,this.isFocusReverse(c)){for(a=h+1;a<s;++a)if(null!=(p=this.findPrevious(l[a],!0,!0)))return p;if(!this.isFocusRoot(c,r)&&null!=(p=this.find(c,!0,!1,!1,r)))return p;for(a=0;a<=h;++a)if(null!=(p=this.findPrevious(l[a],!0,!0)))return p}else{for(a=h-1;0<=a;--a)if(null!=(p=this.findPrevious(l[a],!0,!0)))return p;if(!this.isFocusRoot(c,r)&&null!=(p=this.find(c,!0,!1,!1,r)))return p;for(a=s-1;h<=a;--a){var p;if(null!=(p=this.findPrevious(l[a],!0,!0)))return p}}}return null},e.prototype.findNext=function(t,e,n){if(e&&this.isFocusable(t))return t;if(n&&this.isFocusableContainer(t)&&t.visible){var i=t.children,r=i.length;if(this.isFocusReverse(t)){for(var o=r-1;0<=o;--o)if(null!=(s=this.findNext(i[o],!0,!0)))return s}else for(o=0;o<r;++o){var s;if(null!=(s=this.findNext(i[o],!0,!0)))return s}}return null},e.prototype.findPrevious=function(t,e,n){if(n&&this.isFocusableContainer(t)&&t.visible){var i=t.children,r=i.length;if(this.isFocusReverse(t)){for(var o=0;o<r;++o)if(null!=(s=this.findPrevious(i[o],!0,!0)))return s}else for(o=r-1;0<=o;--o){var s;if(null!=(s=this.findPrevious(i[o],!0,!0)))return s}}return e&&this.isFocusable(t)?t:null},e.prototype.isFocusable=function(t){return null!=t&&"state"in t&&t.state.inEnabled&&t.state.isFocusable&&t.visible},e.prototype.isFocusableContainer=function(t){return null!=t&&"children"in t},e.prototype.isFocusRoot=function(t,e){return t===e||null!=t&&"state"in t&&t.state.isFocusRoot&&t.visible},e.prototype.isFocusReverse=function(t){return null!=t&&"state"in t&&t.state.isFocusReverse},e}(t.utils.EventEmitter),$y=function(){function e(e){var n,i;ft.add(this);var r=this.toRootElement(e);this._root=r,this.initFocusHandling(r);var o=null!==(i=null!==(n=null==e?void 0:e.resolution)&&void 0!==n?n:window.devicePixelRatio)&&void 0!==i?i:1;this._resolution=o,delete t.Renderer.__plugins.accessibility,this._options=e;var s=this.newLayerBase(e);this._base=s,this._isOverlayEnabled=!!(null==e?void 0:e.overlay),this._isOverlayEnabled||(this._overlay=s)}return Object.defineProperty(e.prototype,"stage",{get:function(){return this._base.stage},enumerable:!1,configurable:!0}),e.prototype.getRootElement=function(){return this._root},e.prototype.getResolution=function(){return this._resolution},e.prototype.toRootElement=function(t){var e=null==t?void 0:t.root;if(null!=e){if(!xt(e))return e;var n=document.querySelector(e);if(n)return n}return document.body},e.prototype.toLayerBaseOptions=function(t){var e=this._root,n=this._resolution;return new Wy(t?{root:e,padding:t.padding,width:t.width,height:t.height,background:t.background,resolution:n,antialias:t.antialias,overlay:!1}:{root:e,resolution:n,overlay:!1})},e.prototype.getFocusController=function(){return null==this._focus&&(this._focus=new Qy),this._focus},e.prototype.initFocusHandling=function(t){var e=this,n=!1,i=function(){n||e.getFocusController().clear()};t.addEventListener("focus",(function(){n=!0}),!0),t.addEventListener("blur",(function(){n=!1,setTimeout(i,0)}),!0)},e.prototype.newLayerBase=function(t){return new Jy(this,this.toLayerBaseOptions(t))},e.prototype.getLayerBase=function(){return this._base},e.prototype.toLayerOverlayOptions=function(t){var e=this._root,n=this._resolution;return new Wy(t?{root:e,padding:t.padding,width:t.width,height:t.height,background:{color:null},resolution:n,antialias:t.antialias,overlay:!0}:{root:e,resolution:n,overlay:!0})},e.prototype.newLayerOverlay=function(t){return new Jy(this,this.toLayerOverlayOptions(t))},e.prototype.getLayerOverlay=function(){return this._isOverlayEnabled?(null==this._overlay&&(this._overlay=this.newLayerOverlay(this._options)),this._overlay):this._base},e.prototype.update=function(){if(!this._isOverlayEnabled)return this._base.update();this._base.update();var t=this._overlay;t&&t.update()},e.prototype.render=function(){if(!this._isOverlayEnabled)return this._base.render();this._base.render();var t=this._overlay;t&&t.render()},e}(),tg=function(t){function e(e,n,i){var r=t.call(this,e,n,i)||this;return r._atop=0,r._aright=0,r._abottom=0,r._aleft=0,r}return F(e,t),e.prototype.getLeft=function(){return t.prototype.getLeft.call(this)+this._aleft},e.prototype.adjLeft=function(t){if(this._aleft!==t){this._aleft=t;var e=this._callback;e&&e()}},e.prototype.getTop=function(){return t.prototype.getTop.call(this)+this._atop},e.prototype.adjTop=function(t){if(this._atop!==t){this._atop=t;var e=this._callback;e&&e()}},e.prototype.getRight=function(){return t.prototype.getRight.call(this)+this._aright},e.prototype.adjRight=function(t){if(this._aright!==t){this._aright=t;var e=this._callback;e&&e()}},e.prototype.getBottom=function(){return t.prototype.getBottom.call(this)+this._abottom},e.prototype.adjBottom=function(t){if(this._abottom!==t){this._abottom=t;var e=this._callback;e&&e()}},e}(Br),eg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DBoard"},e}(ao),ng=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonCheck"},e}(Ba),ig=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonCheckRight"},e}(ng),rg=function(){function t(t,e,n,i,r){this._color=t,this._alpha=e,this._position=n,this._callback=r,this._selected=i}return t.prototype.set=function(t,e,n,i){this._color===t&&this._alpha===e&&this._position===n&&this._selected===i||(this._color=t,this._alpha=e,this._position=n,this._selected=i,this._callback(this))},Object.defineProperty(t.prototype,"color",{get:function(){return this._color},set:function(t){this._color!==t&&(this._color=t,this._callback(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._alpha},set:function(t){this._alpha!==t&&(this._alpha=t,this._callback(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},set:function(t){this._position!==t&&(this._position=t,this._callback(this))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selected",{get:function(){return this._selected},set:function(t){this._selected!==t&&(this._selected=t,this._callback(this))},enumerable:!1,configurable:!0}),t.prototype.toObject=function(){return{color:this._color,alpha:this._alpha,position:this._position}},t}(),og=function(t,e){return t.position-e.position},sg=function(e){function n(){var t=e.call(this)||this,n=function(e){t.onChange(e)};t._onChangeBound=n;var i=new rg(16777215,1,0,!1,n),r=new rg(8421504,1,1,!0,n);return t._points=[i,r],t._direction=-90,t._selected=r,t._workColor=[0,0,0],t}return F(n,e),n.prototype.onChange=function(t){var e=t.selected&&this._selected!==t;if(e){var n=this._selected;null!=n&&(n._selected=!1),this._selected=t}this._points.sort(og),e&&this.emit("selectionchange",this._selected,this),this.emit("change",this)},Object.defineProperty(n.prototype,"points",{get:function(){return this._points},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"direction",{get:function(){return this._direction},set:function(t){this._direction!==t&&(this._direction=t,this.emit("directionchange",t,this),this.emit("change",this))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"selected",{get:function(){return this._selected},enumerable:!1,configurable:!0}),n.prototype.size=function(){return this._points.length},n.prototype.get=function(t){var e=this._points;return 0<=t&&t<e.length?e[t]:null},n.prototype.addAt=function(e){for(var n=this._points,i=null,r=0,o=n.length;r<o;++r){var s=n[r];if(e<=s.position){if(null==i)return this.add(s.color,s.alpha,e,!0);var a=s.position-i.position;if(.001<a){var u=t.utils.hex2rgb(s.color,this._workColor),l=u[0],h=u[1],c=u[2],p=t.utils.hex2rgb(i.color,this._workColor),f=p[0],d=p[1],y=p[2],g=(e-i.position)/a,v=l*g+f*(1-g),_=h*g+d*(1-g),m=c*g+y*(1-g),b=this._workColor;b[0]=v,b[1]=_,b[2]=m;var T=t.utils.rgb2hex(b),w=s.alpha*g+i.alpha*(1-g);return this.add(T,w,e,!0)}}i=s}return null!=i?this.add(i.color,i.alpha,e,!0):this.add(16777215,1,e,!0)},n.prototype.add=function(t,e,n,i){var r=this._onChangeBound,o=new rg(t,e,n,i,r);return this._points.push(o),r(o),o},n.prototype.remove=function(t){var e=this._points;if(2<e.length)for(var n=0,i=e.length;n<i;++n)if(e[n]===t){e.splice(n,1);var r=this._selected===t;return r&&(this._selected=n+1<i?e[n]:e[n-1]),r&&this.emit("selectionchange",this._selected,this),this.emit("change",this),!0}return!1},n.prototype.reset=function(){var t=this._direction;this._direction=-90;var e=this._points,n=this._selected,i=n?e.indexOf(n):-1;e.length=0;var r=this._onChangeBound;if(e.push(new rg(16777215,0,0,!1,r)),e.push(new rg(16777215,0,1,!1,r)),0<=i&&i<e.length)(o=e[i])._selected=!0,this._selected=o;else if(0<e.length){var o;(o=e[e.length-1])._selected=!0,this._selected=o}else this._selected=null;return n!==this._selected&&this.emit("selectionchange",this._selected,this),t!==this._direction&&this.emit("directionchange",this._direction,this),this.emit("change",this),this},n.prototype.toObject=function(){for(var t=[],e=this._points,n=0,i=e.length;n<i;++n)t.push(e[n].toObject());return{points:t,direction:this._direction}},n.prototype.fromObject=function(t){var e=this._direction;this._direction=t.direction;var n=this._points,i=this._selected,r=i?n.indexOf(i):-1;n.length=0;for(var o=this._onChangeBound,s=0,a=t.points.length;s<a;++s){var u=t.points[s],l=new rg(u.color,u.alpha,u.position,!1,o);n.push(l)}return n.sort(og),0<=r&&r<n.length?((l=n[r])._selected=!0,this._selected=l):0<n.length?((l=n[n.length-1])._selected=!0,this._selected=l):this._selected=null,i!==this._selected&&this.emit("selectionchange",this._selected,this),e!==this._direction&&this.emit("directionchange",this._direction,this),this.emit("change",this),this},n}(t.utils.EventEmitter),ag=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DInputLabel"},e}(mu),ug=function(t){function e(e){var n=t.call(this,e)||this;n.addChild(n._label=new ag(null==e?void 0:e.label)),n.addChild(n._input=n.createInput(null==e?void 0:e.input));var i=null==e?void 0:e.space;return null!=i&&n.addChild(new Js(i)),n}return F(e,t),Object.defineProperty(e.prototype,"input",{get:function(){return this._input},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"label",{get:function(){return this._label},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DInputAndLabel"},e}(ja),lg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.createInput=function(t){return new uu(t)},e}(ug),hg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.createInput=function(t){return new cu(t)},e}(ug),cg=function(){function t(t,e,n){this._colorAndAlpha=t,this._onColorChange=e,this._onAlphaChange=n}return Object.defineProperty(t.prototype,"color",{get:function(){return this._colorAndAlpha.color},set:function(t){if(this._colorAndAlpha.color!==t){var e=this._onColorChange;null!=e&&e(t)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"alpha",{get:function(){return this._colorAndAlpha.alpha},set:function(t){if(this._colorAndAlpha.alpha!==t){var e=this._onAlphaChange;null!=e&&e(t)}},enumerable:!1,configurable:!0}),t}(),pg=function(){function t(t){this._owner=t,this._closeables=[]}return t.prototype.indexOf=function(t){return this._closeables.indexOf(t)},t.prototype.close=function(t){for(var e=this._closeables,n=Math.max(0,t),i=e.length-1;n<=i;--i)e[i].close()},t.prototype.add=function(t){this._closeables.push(t)},t.prototype.trim=function(t){this.close(this.indexOf(t)+1)},t.prototype.remove=function(t){var e=this.indexOf(t);0<=e&&(this.close(e+1),this._closeables.splice(e,1))},t}(),fg=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(t){var n,i,r,o=this;e.prototype.init.call(this,t),this._onPrerenderBound=function(){o.onPrerender()},this._align=ai(null!==(n=null==t?void 0:t.align)&&void 0!==n?n:js.BOTTOM,js),this._fit=null!==(i=null==t?void 0:t.fit)&&void 0!==i&&i,this._sticky=null!==(r=null==t?void 0:t.sticky)&&void 0!==r&&r,this._sub=!1,this._owner=null,this._context=null,this.visible=!1,Xs.apply(this,(function(){o.close()})),this.on("select",(function(){o.close()}));var s=null==t?void 0:t.items;s&&id.newItems(this,s,this._sticky),this._overlay=new Ys(t)},n.prototype.findItem=function(t){for(var e=this.children,n=0,i=e.length;n<i;++n){var r=e[n];if(r instanceof Qf&&r.value===t)return r}return null},n.prototype.getType=function(){return"DMenu"},n.prototype.getContext=function(){return this._context},n.prototype.getCloseable=function(){return this},n.prototype.open=function(i,r,o){var s;if(this.isHidden()){var a=this._overlay.pick(this,i);this._owner=i;for(var u=this.children,l=0,h=u.length;l<h;++l){var c=u[l];c instanceof ao&&c.state.removeAll(vt.FOCUSED,vt.HOVERED)}var p=a.renderer,f=this._onPrerenderBound;if(this._sticky?p.on("prerender",f):p.once("prerender",f),this._fit){var d=i.getBounds(!1,null!==(s=n.WORK_BOUNDS)&&void 0!==s?s:n.WORK_BOUNDS=new t.Rectangle);null!=d&&(this.width=d.width)}this._sub=null!=o,o=o||new pg(i),null!=r&&o.trim(r),o.add(this),this._context=o,a.stage.addChild(this),this._focused=a.getFocusController().get(),this.focus(),e.prototype.show.call(this),this.emit("open",this)}return this},n.prototype.onPrerender=function(){var e,i=this._owner;if(i){var r=i.getBounds(!1,null!==(e=n.WORK_BOUNDS)&&void 0!==e?e:n.WORK_BOUNDS=new t.Rectangle);if(r){this._fit&&(this.width=r.width);var o=this._overlay.picked;if(o){var s=this.theme;Fs.attach(this,r,s.getOffsetX(),s.getOffsetY(),o.width,o.height,this._align)}}}},n.prototype.close=function(){if(this.isShown()){var t=this._context;t&&t.remove(this);var n=this._overlay.picked;n&&n.renderer.off("prerender",this._onPrerenderBound),this._owner=null;var i=this._focused;if(null!=i)if(this._focused=null,n){var r=ft.getLayer(i);null!=r&&n!==r&&r.view.focus(),n.getFocusController().focus(i)}else this.blur(!0);else this.blur(!0);e.prototype.hide.call(this);var o=this.parent;o&&o.removeChild(this),this.emit("close",this)}return this},n.prototype.onKeyDown=function(t){return no.moveFocusVertically(t,this,this._overlay),this.state.isActionable&&(no.isArrowLeftKey(t)||no.isCancelKey(t))&&this.close(),e.prototype.onKeyDown.call(this,t)},n.prototype.containsGlobalPoint=function(t){return!this._sub},n}(ta);id.setMenuCreator((function(t){return new fg(t)}));var dg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onMenuSelect=function(t,e,n){this.emit("select",t,e,this)},e.prototype.onMenuClose=function(t){if(t){var e=this._onMenuSelectBound;e&&t.off("select",e);var n=this._onMenuCloseBound;n&&t.off("close",n)}},e.prototype.toMenu=function(t,e){var n=null==e?void 0:e.menu;return n instanceof fg?n:new fg(this.toMenuOptions(t,n))},e.prototype.toMenuOptions=function(t,e){return e?(null==e.fit&&(e.fit=!0),e):{fit:!0}},Object.defineProperty(e.prototype,"menu",{get:function(){var t=this._menu;return null==t&&(t=this.toMenu(this.theme,this._options),this._menu=t),t},set:function(t){var e=this._menu;e!=t&&(this._menu=t,this.onMenuReplaced(t,e))},enumerable:!1,configurable:!0}),e.prototype.onMenuReplaced=function(t,e){null!=e&&this.onMenuClose(e)},e.prototype.getType=function(){return"DDropdownBase"},e.prototype.onKeyDown=function(e){return no.isArrowDownKey(e)&&this.onKeyDownArrowDown(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyDownArrowDown=function(t){return!(!this.state.isActionable||!this.state.isFocused||(this.activate(t),0))},e.prototype.onActivate=function(e){t.prototype.onActivate.call(this,e),this.open()},e.prototype.open=function(){var t=this.menu;t.isHidden()&&(this.onMenuOpening(t),t.open(this),this.onMenuOpened(t))},e.prototype.onMenuOpening=function(t){var e=this,n=this._onMenuSelectBound;null==n&&(n=function(t,n,i){e.onMenuSelect(t,n,i)},this._onMenuSelectBound=n);var i=this._onMenuCloseBound;null==i&&(i=function(){e.onMenuClose(e._menu)}),t.on("select",n),t.on("close",i)},e.prototype.onMenuOpened=function(t){this.emit("open",t,this)},e.prototype.close=function(){this.menu.close()},e}(Ba),yg=function(){function t(){}return t.each=function(t,e){for(var n=t.children,i=0,r=n.length;i<r;++i){var o=n[i];if(o instanceof fd){var s=this.each(o.menu,e);if(null!=s)return s}else if(o instanceof Qf&&e(o))return o}return null},t.find=function(t,e){return this.each(t,(function(t){return t.value===e}))},t}(),gg=function(t){function e(e){var n=t.call(this,e)||this;n._value=null;var i=null==e?void 0:e.value;return null!=i&&(n.value=i),n}return F(e,t),e.prototype.onMenuSelect=function(e,n,i){t.prototype.onMenuSelect.call(this,e,n,i);var r=this._value;r!==e&&(this._value=e,this.text=n,this.onValueChange(e,r,n))},e.prototype.onMenuReplaced=function(e,n){t.prototype.onMenuReplaced.call(this,e,n);var i=this._value,r=yg.find(e,i);null!=r?(this._value=i,this.text=r):(this._value=null,this.text=null)},e.prototype.onValueChange=function(t,e,n){this.emit("change",t,e,n,this)},e.prototype.onMenuOpening=function(e){t.prototype.onMenuOpening.call(this,e);var n=this._value;yg.each(e,(function(t){t.state.isActive=t.value===n}))},Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},set:function(t){this.setValue(t)},enumerable:!1,configurable:!0}),e.prototype.getValue=function(){return this._value},e.prototype.setValue=function(t,e){if(e||this._value!==t){var n=yg.find(this.menu,t);null!=n?(this._value=t,this.text.setValue(n,e)):(this._value=null,this.text.setValue(null,e))}},e.prototype.getType=function(){return"DSelect"},e}(dg),vg={CUSTOM:0,STANDARD:1},_g=function(t){function e(e){var n=t.call(this)||this;return n._standards=e,n}return F(e,t),e.prototype.get=function(t){var e=this._standards;return 0<=t&&t<e.length?e[t]:null},e.prototype.set=function(t,e){var n=this._standards;if(0<=t&&t<n.length){var i=n[t];return n[t]=e,this.emit("change",this),i}return null},e.prototype.setAll=function(t){for(var e=!1,n=this._standards,i=0,r=Math.min(t.length,n.length);i<r;++i)n[i]!==t[i]&&(n[i]=t[i],e=!0);return e&&this.emit("change",this),this},e.prototype.contains=function(t){for(var e=this._standards,n=0,i=e.length;n<i;++n)if(e[n]===t)return!0;return!1},e.prototype.size=function(){return this._standards.length},e}(t.utils.EventEmitter),mg=function(){function t(){}return t.getInstance=function(){var t;return null!==(t=this.INSTANCE)&&void 0!==t?t:this.INSTANCE=this.newInstance()},t.newInstance=function(){var t=it.get("DColorStandard");return new _g(t.newColors())},t}(),bg=function(t){function e(e,n){var i=t.call(this)||this;return i._recents=e,i._capacity=n,i}return F(e,t),e.prototype.get=function(t){var e=this._recents;return 0<=t&&t<e.length?e[e.length-1-t]:null},e.prototype.set=function(t,e){var n=this._recents;if(0<=t&&t<n.length){var i=n[n.length-1-t];return n[n.length-1-t]={color:e.color,alpha:e.alpha},this.emit("change",this),i}return null},e.prototype.contains=function(t){for(var e=this._recents,n=0,i=e.length;n<i;++n){var r=e[n];if(r.color===t.color&&r.alpha===t.alpha)return!0}return!1},e.prototype.clear=function(){var t=this._recents;return 0<t.length&&(t.length=0,this.emit("change",this)),this},e.prototype.add=function(t){var e=this._recents;return e.push({color:t.color,alpha:t.alpha}),this._capacity<e.length&&e.shift(),this.emit("change",this),this},e.prototype.addAll=function(t){var e=t.length;if(0<e){for(var n=this._recents,i=0;i<e;++i){var r=t[i];n.push({color:r.color,alpha:r.alpha}),this._capacity<n.length&&n.shift()}this.emit("change",this)}return this},e.prototype.clearAndAddAll=function(t){var e=!1,n=this._recents;0<n.length&&(n.length=0,e=!0);var i=t.length;if(0<i){for(var r=0;r<i;++r){var o=t[r];n.push({color:o.color,alpha:o.alpha}),this._capacity<n.length&&n.shift()}e=!0}return e&&this.emit("change",this),this},e.prototype.pop=function(){var t=this._recents.shift();return null!=t?(this.emit("change",this),t):null},e.prototype.size=function(){return this._recents.length},e}(t.utils.EventEmitter),Tg=function(){function t(){}return t.getInstance=function(){var t;return null!==(t=this.INSTANCE)&&void 0!==t?t:this.INSTANCE=this.newInstance()},t.newInstance=function(){var t=it.get("DColorRecent");return new bg(t.newColors(),t.getCapacity())},t}(),wg=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),Object.defineProperty(n.prototype,"current",{get:function(){return this._currentPicker},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"new",{get:function(){return this._newPicker},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"recent",{get:function(){return this._recent},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"standard",{get:function(){return this._standard},enumerable:!1,configurable:!0}),n.prototype.init=function(n){var i=this;e.prototype.init.call(this,n),this._base=16711680,this._new={color:16777215,alpha:1},this._newPicker=new cg(this._new,(function(t){i.setColorNew(t)}),(function(t){i.setAlphaNew(t)})),this._current={color:16777215,alpha:1},this._currentPicker=new cg(this._current,(function(t){i.setColorCurrent(t)}),(function(t){i.setAlphaCurrent(t)}));var r=this.theme,o=this._padding,s=o.getTop(),a=o.getRight(),u=o.getBottom(),l=o.getLeft();this._pointerPoint=new t.Point;var h=r.getMainWidth(),c=r.getMainHeight(),p=new gg({parent:this,value:vg.STANDARD,menu:{items:[{value:vg.STANDARD,text:{value:r.toColorTypeLabel(vg.STANDARD)}},{value:vg.CUSTOM,text:{value:r.toColorTypeLabel(vg.CUSTOM)}}]},on:{change:function(t){i.onTypeChange(t)}}});this._typeSelector=p,p.x=l,p.y=s,p.width=h,p.interactive=!0,this.addChild(p);var f=new t.Sprite(r.getMainBaseTexture());this._mainBaseSprite=f,f.x=l,f.y=p.y+p.height+r.getBaseMargin(),f.width=h,f.height=c,f.interactive=!0,f.visible=!1,this.addChild(f);var d=new t.Sprite(r.getMainTexture());this._mainSprite=d,d.x=l,d.y=p.y+p.height+r.getBaseMargin(),d.tint=this._base,d.interactive=!1,d.visible=!1,this.addChild(d),this._onMainMoveBound=function(t){i.onMainMove(t)},this._onMainUpBound=function(t){i.onMainUp(t)},f.on(cr.down,(function(t){i.onMainDown(t)}));var y=new t.Sprite(r.getBaseTexture());this._baseSprite=y,y.x=l,y.y=f.y+f.height+r.getBaseMargin(),y.interactive=!0,y.visible=!1,this.addChild(y),this._onBaseMoveBound=function(t){i.onBaseMove(t)},this._onBaseUpBound=function(t){i.onBaseUp(t)},y.on(cr.down,(function(t){i.onBaseDown(t)})),this._standardColorSprites=[];var g=this._standardColorSprites,v=r.getStandardColorCount(),_=r.getStandardColorWidth(),m=r.getStandardColorHeight(),b=r.getStandardColorMargin(),T=p.y+p.height+r.getBaseMargin(),w=r.getStandardTexture(),E=this._standard=mg.getInstance();E.on("change",(function(){i.onStandardChange()}));for(var O=function(e){var n=e.currentTarget;n instanceof t.Sprite&&i.setColorNew(n.tint)},C=0;C<v;++C){var S=l+C%10*(_+b),x=T+Math.floor(C/10)*(m+b),D=new t.Sprite(w),I=E.get(C);null!=I?(D.tint=I,D.alpha=1):(D.tint=16777215,D.alpha=1),D.x=S,D.y=x,D.buttonMode=!0,D.interactive=!0,D.on(cr.tap,O),g.push(D)}var A=new ja({width:"auto",height:"auto",row:8,children:g});this._mainStandardColor=A,A.visible=!0,this.addChild(A);var R=new t.Sprite(r.getAlphaCheckerboardTexture());this._alphaCheckerboardSprite=R,R.x=o.getLeft(),R.y=y.y+r.getBaseHeight()+r.getBaseMargin(),R.interactive=!1,this.addChild(R);var P=new t.Sprite(r.getAlphaTexture());P.tint=this._new.color,P.interactive=!0,R.addChild(P),this._onAlphaMoveBound=function(t){i.onAlphaMove(t)},this._onAlphaUpBound=function(t){i.onAlphaUp(t)},P.on(cr.down,(function(t){i.onAlphaDown(t)}));var M=new t.Sprite(r.getMainPointerTexture());this._mainPointerSprite=M,M.x=l,M.y=p.y+p.height+r.getBaseMargin(),M.anchor.x=.5,M.anchor.y=.5,M.tint=r.getMainPointerColor(),M.alpha=r.getMainPointerAlpha(),M.interactive=!1,M.visible=!1,this.addChild(M);var k=new t.Sprite(r.getAlphaPointerTexture());this._alphaPointerSprite=k,k.x=h,k.y=.5*R.height,k.tint=r.getAlphaPointerColor(),k.alpha=r.getAlphaPointerAlpha(),k.anchor.set(.5,.5),k.interactive=!1,R.addChild(k);var L=new t.Sprite(r.getBasePointerTexture());this._basePointerSprite=L,L.x=0,L.y=.5*y.height,L.tint=r.getBasePointerColor(),L.alpha=r.getBasePointerAlpha(),L.anchor.set(.5,.5),L.interactive=!1,y.addChild(L),this._recentColorSprites=[];var N=this._recentColorSprites,B=r.getRecentColorCount(),z=r.getRecentColorWidth(),U=r.getRecentColorHeight(),j=r.getRecentColorMargin(),F=R.y+r.getAlphaHeight()+r.getRecentMargin(),H=r.getRecentCheckerboardTexture(),G=r.getRecentTexture(),V=this._recent=Tg.getInstance();V.on("change",(function(){i.onRecentChange()}));var W=function(e){var n=e.currentTarget;n instanceof t.Sprite&&(i.setColorNew(n.tint),i.setAlphaNew(n.alpha))};for(C=0;C<B;++C){S=l+C*(z+j),x=F;var K=new t.Sprite(H);K.x=S,K.y=x,K.interactive=!1,this.addChild(K),D=new t.Sprite(G);var X=V.get(C);null!=X?(D.tint=X.color,D.alpha=X.alpha):(D.tint=16777215,D.alpha=0),D.x=S,D.y=x,D.buttonMode=!0,D.interactive=!0,D.on(cr.tap,W),this.addChild(D),N.push(D)}var Y=r.getInputMargin(),q=r.getInputLabelWidth(),Z=F+U+Y,J=.5*(h-Y),Q=new hg({parent:this,x:l,y:Z,width:J,label:{width:q,text:{value:"#"},interactive:Lr.NONE},input:{weight:1,text:{value:"FFFFFF"},on:{input:function(t){var e=ve.fromCode(t);null!=e&&i.setColorNew(e)}}}});this._inputAndLabelColor=Q;var $=Q.height,tt=new lg({parent:this,x:l,y:Z+$+Y,width:J,label:{width:q,text:{value:"A"},interactive:Lr.NONE},input:{weight:1,text:{value:1},min:0,max:1,on:{input:function(t){i.setAlphaNew(t)}}}});this._inputAndLabelAlpha=tt;var et=r.getSampleWidth(),nt=r.getSampleHeight(),it=l+.5*(h-Y)+Y,rt=Z+.5*($+Y+tt.height-nt),ot=r.getSampleMargin(),st=new t.Sprite(r.getSampleCheckerboardOldTexture());this._sampleCurrentCheckerboardSprite=st,st.x=it,st.y=rt,st.width=et,st.height=nt,st.interactive=!1,this.addChild(st);var at=this._current,ut=new t.Sprite(r.getSampleOldTexture());this._sampleCurrentSprite=ut,ut.x=it,ut.y=rt,ut.tint=at.color,ut.alpha=at.alpha,ut.width=et,ut.height=nt,ut.interactive=!0,ut.buttonMode=!0,ut.on(cr.tap,(function(){i.setColorNew(at.color),i.setAlphaNew(at.alpha)})),this.addChild(ut);var lt=new t.Sprite(r.getSampleCheckerboardNewTexture());this._sampleNewCheckerboardSprite=lt,lt.x=it+et+ot,lt.y=rt,lt.width=et,lt.height=nt,lt.interactive=!1,this.addChild(lt);var ht=new t.Sprite(r.getSampleNewTexture());this._sampleNewSprite=ht,ht.x=it+et+ot,ht.y=rt,ht.tint=this._new.color,ht.alpha=this._new.alpha,ht.width=et,ht.height=nt,ht.interactive=!1,this.addChild(ht),null!=n&&null!=n.width||(this.width=l+h+a),null!=n&&null!=n.height||(this.height=Z+Q.height+Y+tt.height+u)},n.prototype.onMainDown=function(t){this.onMainPick(t.data.global);var e=ft.getLayer(this);if(e){var n=e.stage;n.on(cr.move,this._onMainMoveBound),n.on(cr.up,this._onMainUpBound),n.on(cr.upoutside,this._onMainUpBound)}},n.prototype.onMainMove=function(t){this.onMainPick(t.data.global)},n.prototype.onMainUp=function(t){var e=ft.getLayer(this);if(e){var n=e.stage;n.off(cr.move,this._onMainMoveBound),n.off(cr.up,this._onMainUpBound)}},n.prototype.toMainHex=function(t,e,n,i){return Math.max(0,Math.min(255,255*e+n*(t>>i&255)))<<i},n.prototype.toMainColor=function(t,e,n,i,r){var o=.5*i,s=Math.max(0,Math.min(1,((e-o)*(1-n/r)+o)/i)),a=Math.max(0,Math.min(1,n/r)),u=Math.abs(.5*a-s),l=1-u-a;return this.toMainHex(t,l,u,16)|this.toMainHex(t,l,u,8)|this.toMainHex(t,l,u,0)},n.prototype.onMainPick=function(t){var e=this._mainBaseSprite,n=this._pointerPoint,i=this.theme,r=i.getMainWidth(),o=i.getMainHeight();this.toLocal(t,void 0,n);var s=Math.max(0,Math.min(r,n.x-e.x)),a=Math.max(0,Math.min(o,n.y-e.y));this._mainPointerSprite.position.set(e.x+s,e.y+a),this.onColorNew(this.toMainColor(this._base,s,a,r,o))},n.prototype.setColorCurrent=function(t){this._sampleCurrentSprite.tint=this._current.color=t},n.prototype.setAlphaCurrent=function(t){this._sampleCurrentSprite.alpha=this._current.alpha=t},n.prototype.setColorNew=function(t){var e=this.theme,n=e.getMainWidth(),i=e.getMainHeight(),r=this._mainBaseSprite,o=Ly.fromRgb(t);this._mainSprite.tint=this._base=Ly.toRgb(o[0],255,255),this._basePointerSprite.x=Math.max(0,Math.min(1,o[0]/360))*n;var s=Math.max(0,Math.min(1,o[1]/255)),a=Math.max(0,Math.min(1,1-o[2]/255)),u=this._mainPointerSprite;u.tint=a<.45?e.getMainPointerColor():16777215,u.position.set(r.x+s*n,r.y+a*i),this.onColorNew(t)},n.prototype.onColorNew=function(t){var e=ft.getLayer(this);e&&e.lock(),this._sampleNewSprite.tint=this._new.color=t,this._inputAndLabelColor.input.value=ve.toCode(t),this.emit("newcolorchange",t,this),e&&(e.unlock(),e.update())},n.prototype.onBaseDown=function(t){this.onBasePick(t.data.global);var e=ft.getLayer(this);if(e){var n=e.stage;n.on(cr.move,this._onBaseMoveBound),n.on(cr.up,this._onBaseUpBound)}},n.prototype.onBaseMove=function(t){this.onBasePick(t.data.global)},n.prototype.onBaseUp=function(t){var e=ft.getLayer(this);if(e){var n=e.stage;n.off(cr.move,this._onBaseMoveBound),n.off(cr.up,this._onBaseUpBound)}},n.prototype.toBaseHex=function(t,e){return Math.max(0,Math.min(255,6*t*255))<<e},n.prototype.toBaseColor=function(t){return t<=.167?16711680+this.toBaseHex(t,8):t<=.333?(t=.333-t,65280+this.toBaseHex(t,16)):t<=.5?(t-=.333,65280+this.toBaseHex(t,0)):t<.667?(t=.667-t,255+this.toBaseHex(t,8)):t<.883?(t-=.667,255+this.toBaseHex(t,16)):(t=.883-t,16711680+this.toBaseHex(t,0))},n.prototype.onBasePick=function(t){var e=this._pointerPoint,n=this._padding,i=this.theme.getMainWidth();this.toLocal(t,void 0,e);var r=Math.max(0,Math.min(i,e.x-n.getLeft()));this._basePointerSprite.x=r,this.onColorBase(this.toBaseColor(r/i))},n.prototype.setColorBase=function(t){var e=this.theme.getMainWidth();this._basePointerSprite.x=Math.max(0,Math.min(1,t/360))*e,this.onColorBase(Ly.toRgb(t,255,255))},n.prototype.onColorBase=function(t){this._mainSprite.tint=this._base=t;var e=this._mainPointerSprite,n=this.theme,i=n.getMainWidth(),r=n.getMainHeight(),o=this._padding;this.onColorNew(this.toMainColor(this._base,e.x-o.getLeft(),e.y-o.getTop(),i,r))},n.prototype.onAlphaDown=function(t){this.onAlphaPick(t.data.global);var e=ft.getLayer(this);if(e){var n=e.stage;n.on(cr.move,this._onAlphaMoveBound),n.on(cr.up,this._onAlphaUpBound)}},n.prototype.onAlphaMove=function(t){this.onAlphaPick(t.data.global)},n.prototype.onAlphaUp=function(t){var e=ft.getLayer(this);if(e){var n=e.stage;n.off(cr.move,this._onAlphaMoveBound),n.off(cr.up,this._onAlphaUpBound)}},n.prototype.onAlphaPick=function(t){var e=this._pointerPoint,n=this._padding,i=this.theme.getMainWidth();this.toLocal(t,void 0,e);var r=Math.max(0,Math.min(i,e.x-n.getLeft()));this._alphaPointerSprite.x=r,this.onAlphaNew(r/i)},n.prototype.setAlphaNew=function(t){var e=this.theme.getMainWidth();this._alphaPointerSprite.x=Math.max(0,Math.min(1,t))*e,this.onAlphaNew(t)},n.prototype.onAlphaNew=function(t){var e=ft.getLayer(this);e&&e.lock(),this._sampleNewSprite.alpha=this._new.alpha=t,this._inputAndLabelAlpha.input.value=Number(t.toFixed(2)),this.emit("newalphachange",t,this),e&&(e.unlock(),e.update())},n.prototype.onRecentChange=function(){for(var t=this._recentColorSprites,e=this._recent,n=0,i=t.length;n<i;++n){var r=t[n],o=e.get(n);null!=o?(r.tint=o.color,r.alpha=o.alpha):(r.tint=16777215,r.alpha=0)}},n.prototype.onStandardChange=function(){for(var t=this._standardColorSprites,e=this._standard,n=0,i=t.length;n<i;++n){var r=t[n],o=e.get(n);null!=o?(r.tint=o,r.alpha=1):(r.tint=16777215,r.alpha=1)}},n.prototype.onTypeChange=function(t){switch(t){case vg.CUSTOM:this._mainBaseSprite.visible=!0,this._mainSprite.visible=!0,this._mainPointerSprite.visible=!0,this._baseSprite.visible=!0,this._mainStandardColor.visible=!1;break;case vg.STANDARD:this._mainBaseSprite.visible=!1,this._mainSprite.visible=!1,this._mainPointerSprite.visible=!1,this._baseSprite.visible=!1,this._mainStandardColor.visible=!0;break;default:return}},n.prototype.getType=function(){return"DPickerColor"},n}(ao),Eg=function(t,e){if(t.direction!==e.direction)return!1;var n=t.points,i=e.points;if(n.length!==i.length)return!1;for(var r=0,o=n.length;r<o;++r){var s=n[r],a=i[r];if(s.color!==a.color||s.alpha!==a.alpha||s.position!==a.position)return!1}return!0},Og=function(t){function e(e,n){var i=t.call(this)||this;return i._recents=e,i._capacity=n,i}return F(e,t),e.prototype.getCapacity=function(){return this._capacity},e.prototype.get=function(t){var e=this._recents;return 0<=t&&t<e.length?e[e.length-1-t]:null},e.prototype.set=function(t,e){var n=this._recents;if(0<=t&&t<n.length){var i=n[n.length-1-t];return n[n.length-1-t]=e,this.emit("change",this),i}return null},e.prototype.contains=function(t){for(var e=this._recents,n=0,i=e.length;n<i;++n)if(Eg(e[n],t))return!0;return!1},e.prototype.add=function(t){var e=this._recents;return e.push(t),this._capacity<e.length&&e.shift(),this.emit("change",this),this},e.prototype.pop=function(){var t=this._recents.shift();return null!=t?(this.emit("change",this),t):null},e.prototype.size=function(){return this._recents.length},e}(t.utils.EventEmitter),Cg=function(e){function n(n,i,r,o,s,a,u,l){var h=e.call(this,u,l)||this;return h.interactive=!0,h.interactiveChildren=!1,h.cursor="pointer",h._nPointsPerData=n,h._vertices=i,h._uvs=r,h._colors=o,h._indices=s,h._lastHitIndex=-1,h._workColor=[0,0,0],h._workPoint=new t.Point,h._parts=a,l.uniforms.uSampler.on("update",(function(){h.update(),ft.update(h)})),h.update(),h}return F(n,e),n.prototype.getRectangle=function(t){var e=this._parts;return 0<=t&&t<e.length?e[t].rect:null},n.prototype.setRectangle=function(t,e,n,i,r){var o=this._parts;if(0<=t&&t<o.length){var s=o[t].rect;s.x=e,s.y=n,s.width=i,s.height=r}},n.prototype.getData=function(t){var e=this._parts;return 0<=t&&t<e.length?e[t].data:null},n.prototype.setData=function(t,e){var n=this._parts;0<=t&&t<n.length&&(n[t].data=e)},n.prototype.getLastHitIndex=function(){return this._lastHitIndex},n.prototype.setColors=function(t,e,n,i){e[t+0]=n[0],e[t+1]=n[1],e[t+2]=n[2],e[t+3]=i,e[t+4]=n[0],e[t+5]=n[1],e[t+6]=n[2],e[t+7]=i},n.prototype.setColorsHex=function(e,n,i,r){var o=t.utils.hex2rgb(i,this._workColor);this.setColors(e,n,o,r)},n.prototype.setColorsWhite=function(t,e){var n=this._workColor;n[0]=1,n[1]=1,n[2]=1,this.setColors(t,e,n,0)},n.prototype.setColorsPoint=function(t,e,n,i){var r=e.points[n];null!=r?this.setColorsHex(t,i,r.color,r.alpha):this.setColorsWhite(t,i)},n.prototype.setVertices=function(t,e,n,i){var r=i.y+i.height*n;e[t+0]=i.x,e[t+1]=r,e[t+2]=i.x+i.width,e[t+3]=r},n.prototype.setUvs=function(t,e,n,i){var r=i.x0+(i.x3-i.x0)*n,o=i.y0+(i.y3-i.y0)*n,s=i.x1+(i.x2-i.x1)*n,a=i.y1+(i.y2-i.y1)*n;e[t+0]=r,e[t+1]=o,e[t+2]=s,e[t+3]=a},n.prototype.newIndices=function(t,e,n,i){for(var r=0;r<n;++r)i[t+0]=e+0,i[t+1]=e+1,i[t+2]=e+2,i[t+3]=e+2,i[t+4]=e+1,i[t+5]=e+3,t+=6,e+=2;return i},n.prototype._calculateBounds=function(){var t=this.transform.worldTransform,e=this._parts[0].rect,n=this._bounds,i=this._workPoint;i.set(e.x,e.y),t.apply(i,i),n.addPoint(i),i.set(e.x+e.width,e.y+e.height),t.apply(i,i),n.addPoint(i)},n.prototype.update=function(){var t=this._vertices,e=this._uvs,n=this._colors,i=this._indices,r=this.shader.uniforms.uSampler;null==r._uvs&&r.updateUvs();for(var o=r._uvs,s=0,a=0,u=0,l=0,h=this._parts,c=0,p=h.length;c<p;++c){var f=h[c].data,d=h[c].rect;if(null==f)this.setVertices(s,t,0,d),this.setUvs(s,e,0,o),this.setColorsWhite(u,n),this.setVertices(s+4,t,1,d),this.setUvs(s,e,1,o),this.setColorsWhite(u+8,n),this.newIndices(l,a,1,i),s+=8,u+=16,a+=4,l+=6;else{this.setVertices(s,t,0,d),this.setUvs(s,e,0,o),this.setColorsPoint(u,f,0,n),s+=4,u+=8;for(var y=f.points.length,g=0,v=Math.min(y,this._nPointsPerData);g<v;++g){var _=f.points[g];this.setVertices(s,t,_.position,d),this.setUvs(s,e,_.position,o),this.setColorsHex(u,n,_.color,_.alpha),s+=4,u+=8}this.setVertices(s,t,1,d),this.setUvs(s,e,1,o),this.setColorsPoint(u,f,y-1,n),s+=4,u+=8,this.newIndices(l,a,y+1,i),l+=6*(y+1),a+=2*(y+2)}}this.size=l;var m=this.geometry;m.getBuffer("aPosition").update(),m.getBuffer("aUv").update(),m.getBuffer("aColor").update(),m.getIndex().update()},n.prototype.containsPoint=function(t){for(var e=this.toLocal(t,void 0,this._workPoint),n=this._parts,i=0,r=n.length;i<r;++i)if(n[i].rect.contains(e.x,e.y))return this._lastHitIndex=i,!0;return!1},n.from=function(e,i,r,o){void 0===o&&(o=t.Texture.WHITE);for(var s=new Float32Array(e*(i+2)*2*2),a=new Float32Array(e*(i+2)*2*2),u=new Float32Array(e*(i+2)*2*4),l=new Uint16Array(e*(i+1)*6),h=[],c=0;c<e;++c)h.push({data:null,rect:new t.Rectangle});var p=(new t.Geometry).addIndex(new t.Buffer(l,!1,!0)).addAttribute("aPosition",new t.Buffer(s,!1,!1),2).addAttribute("aUv",new t.Buffer(a,!1,!1),2).addAttribute("aColor",new t.Buffer(u,!1,!1),4),f=t.Program.from("\nattribute vec2 aPosition;\nattribute vec2 aUv;\nattribute vec4 aColor;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\n\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main(void) {\n\tvec3 position = vec3(aPosition.x, aPosition.y, 1.0);\n\tgl_Position = vec4((projectionMatrix * translationMatrix * position).xy, 0.0, 1.0);\n\tvUv = aUv;\n\tvColor = aColor;\n}\n","\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nuniform sampler2D uSampler;\nuniform vec2 uCheckerColors;\n\nvoid main(void) {\n\tvec4 texture = texture2D(uSampler, vUv);\n\tfloat cy = step( 1.0, mod( gl_FragCoord.y / 10.0, 2.0 ) );\n\tfloat cx = step( 1.0, mod( gl_FragCoord.x / 10.0 + cy, 2.0 ) );\n\tfloat c = mix( uCheckerColors.x, uCheckerColors.y, cx );\n\tgl_FragColor = texture * vec4( mix( vec3( c ), vColor.xyz, vColor.a ), 1.0 );\n}");return new n(i,s,a,u,l,h,p,new t.MeshMaterial(o,{program:f,uniforms:{uCheckerColors:r}}))},n}(t.Mesh),Sg=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(i){var r=this;e.prototype.init.call(this,i);var o=this.theme,s=this._padding,a=s.getTop(),u=s.getRight(),l=s.getBottom(),h=s.getLeft();this._work=new t.Point;var c=o.getGradientPointsWidth(),p=o.getGradientPointsMargin(),f=new wg({x:h+c+p,y:a});this._picker=f,f.on("newcolorchange",(function(t){r.onAnchorColorChange(t)})),f.on("newalphachange",(function(t){r.onAnchorAlphaChange(t)})),this.addChild(f);var d=this._view=Cg.from(17,10,o.getGradientCheckerColors());d.setRectangle(0,h,a,c,f.height),this.addChild(d),d.on(cr.down,(function(t){0===d.getLastHitIndex()&&r.onViewDown(t)})),this._onAnchorDownBound=function(t){r.onAnchorDown(t)},this._onAnchorMoveBound=function(t){r.onAnchorMove(t)},this._onAnchorUpBound=function(t){r.onAnchorUp(t)},this._anchors=[];var y=o.getGradientRecentColumn(),g=o.getGradientRecentWidth(),v=o.getGradientRecentMargin(),_=g+v,m=f.theme.getInputLabelWidth(),b=g*y+v*(y-1),T=o.getGradientDirectionMargin(),w=o.getGradientDirectionTexture(),E=f.x+f.width+T,O=new uu({parent:this,x:E+m+5,y:a,width:b-2*(m+5),step:1,image:{source:w,align:{with:ia.BORDER},margin:{horizontal:-w.width-5}},on:{change:function(t){r._value._direction=t}}}),C=E,S=O.y+O.height+T;null==n.RECENT_COLOR_GRADIENT&&(n.RECENT_COLOR_GRADIENT=new Og(o.getGradientRecents(),o.getGradientRecentCount())),this._recent=n.RECENT_COLOR_GRADIENT;for(var x=this._recent,D=0,I=x.getCapacity();D<I;++D){var A=C+D%y*_,R=S+(D/y|0)*_;d.setRectangle(1+D,A,R,g,g)}x.on("change",(function(){r.onRecentUpdate()})),d.on(cr.tap,(function(t){var e=d.getLastHitIndex();1<=e&&r.onRecentClick(d.getData(e))}));var P=new sg;this._value=P,P.on("change",(function(){r.updateAnchors(),d.update()})),P.on("selectionchange",(function(t){r.onAnchorSelect(t)})),P.on("directionchange",(function(t){O.value=t})),d.setData(0,P),d.update(),O.value=P.direction,this.updateAnchors();var M=P.selected;null!=M&&this.onAnchorSelect(M),null!=i&&null!=i.width||(this.width=h+c+p+f.width+T+(y-1)*v+y*g+u),null!=i&&null!=i.height||(this.height=a+f.height+l)},Object.defineProperty(n.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"recent",{get:function(){return this._recent},enumerable:!1,configurable:!0}),n.prototype.onRecentClick=function(t){var e=this._value;null!=t?e.fromObject(t):e.reset()},n.prototype.onRecentUpdate=function(){for(var t=this._recent,e=this._view,n=0,i=t.size();n<i;++n)e.setData(1+n,t.get(n));e.update(),ft.update(this)},n.prototype.toAnchorPosition=function(t){var e=this.toLocal(t.data.global,void 0,this._work);return Math.max(0,Math.min(1,(e.y-this.padding.getTop())/this._picker.height))},n.prototype.onViewDown=function(t){this._value.addAt(this.toAnchorPosition(t)),this.onAnchorDragStart()},n.prototype.onAnchorDown=function(e){var n=e.target;if(n instanceof t.Sprite){var i=this._value,r=this._anchors.indexOf(n);0<=r&&r<i.points.length&&(i.points[r].selected=!0,this.onAnchorDragStart())}},n.prototype.onAnchorSelect=function(t){var e=this._picker;e.current.color=t.color,e.current.alpha=t.alpha,e.new.color=t.color,e.new.alpha=t.alpha},n.prototype.onAnchorColorChange=function(t){var e=this._value;if(null!=e){var n=e.selected;null!=n&&(n.color=t)}},n.prototype.onAnchorAlphaChange=function(t){var e=this._value;if(null!=e){var n=e.selected;null!=n&&(n.alpha=t)}},n.prototype.onAnchorDragStart=function(){var t=ft.getLayer(this);if(t){var e=t.stage;e.on(cr.move,this._onAnchorMoveBound),e.on(cr.up,this._onAnchorUpBound)}},n.prototype.onAnchorMove=function(t){var e=this._value;if(null!=e){var n=e.selected;null!=n&&(n.position=this.toAnchorPosition(t))}},n.prototype.onAnchorUp=function(t){var e=ft.getLayer(this);if(e){var n=e.stage;n.off(cr.move,this._onAnchorMoveBound),n.off(cr.up,this._onAnchorUpBound)}},n.prototype.updateAnchors=function(){for(var e=this.theme,n=e.getGradientAnchorTexture(),i=e.getGradientAnchorOutlinedTexture(),r=e.getGradientPointsWidth(),o=this._value,s=o.points.length,a=this._anchors,u=a.length,l=u;l<s;++l){var h=new t.Sprite(n);h.anchor.set(.5,.5),h.cursor="pointer",h.interactive=!0,h.on(cr.down,this._onAnchorDownBound),a.push(h),this.addChild(h)}for(l=u-1;s<=l;--l){var c=a[l];c.off(cr.down,this._onAnchorDownBound),c.destroy()}a.length=s;var p=this.padding.getTop(),f=this.padding.getLeft()+r,d=this._picker.height;for(l=0;l<s;++l){var y=o.points[l],g=a[l];g.tint=y.color,g.position.set(f,p+d*y.position),g.texture=y.selected?i:n}ft.update(this)},n.prototype.onKeyDown=function(t){if(no.isDeleteKey(t)){var n=this._value;if(null!=n){var i=n.selected;if(null!=i)return n.remove(i),e.prototype.onKeyDown.call(this,t),!0}}return e.prototype.onKeyDown.call(this,t)},n.prototype.getType=function(){return"DPickerColorGradient"},n.RECENT_COLOR_GRADIENT=null,n}(ao),xg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.picker),i},e.prototype.onOk=function(e){t.prototype.onOk.call(this,e);var n=this.picker,i=n.value,r=n.recent;r.contains(i)||r.add(i.toObject())},Object.defineProperty(e.prototype,"value",{get:function(){return this.picker.value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"recent",{get:function(){return this.picker.recent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"picker",{get:function(){var t,e=this._picker;return null==e&&(e=new Sg(null===(t=this._options)||void 0===t?void 0:t.picker),this._picker=e),e},enumerable:!1,configurable:!0}),e.prototype.getResolvedValue=function(){return this.picker.value},e.prototype.onKeyDown=function(e){return this.picker.onKeyDown(e),t.prototype.onKeyDown.call(this,e)},e.prototype.getType=function(){return"DDialogColorGradient"},e}(yu),Dg=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(n){var i;if(e.prototype.init.call(this,n),void 0===(null===(i=null==n?void 0:n.image)||void 0===i?void 0:i.source)){var r=this.theme,o=r.getViewBaseTexture();if(o instanceof t.Texture){var s=r.getCheckerColors(),a=Cg.from(1,10,s,o);this._view=a,a.setRectangle(0,0,0,o.width,o.height),a.setData(0,this.text.computed),a.update(),this.image=a}}},n.prototype.onActivate=function(t){var n=this;e.prototype.onActivate.call(this,t);var i=this.text.computed,r=this.dialog;null!=i&&r.value.fromObject(i),r.open(this).then((function(t){n.onValueChange(t,n.toClone(i))}))},n.prototype.toClone=function(t){var e=new sg;return null!=t&&e.fromObject(t),e},n.prototype.onValueChange=function(t,e){var n=this.text.computed;null!=n&&n.fromObject(t);var i=this._view;null!=i&&i.update(),this.text.compute(!0),this.emit("change",t,e,this)},Object.defineProperty(n.prototype,"dialog",{get:function(){var t,e=this._dialog;if(null==e){var i=null===(t=this._options)||void 0===t?void 0:t.dialog;i?e=this.newDialog(i):(null==n.DIALOG&&(n.DIALOG=this.newDialog({mode:"MENU",sticky:!0})),e=n.DIALOG),this._dialog=e}return e},enumerable:!1,configurable:!0}),n.prototype.newDialog=function(t){return new xg(t)},Object.defineProperty(n.prototype,"value",{get:function(){return this.text.computed},enumerable:!1,configurable:!0}),n.prototype.getType=function(){return"DButtonColorGradient"},n}(za),Ig=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.picker),i},e.prototype.onOk=function(e){t.prototype.onOk.call(this,e);var n=this.picker,i=n.recent;i.contains(n.new)||i.add(n.new)},Object.defineProperty(e.prototype,"current",{get:function(){return this.picker.current},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"new",{get:function(){return this.picker.new},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"recent",{get:function(){return this.picker.recent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"picker",{get:function(){var t,e=this._picker;return null==e&&(e=new wg(null===(t=this._options)||void 0===t?void 0:t.picker),this._picker=e),e},enumerable:!1,configurable:!0}),e.prototype.getResolvedValue=function(){return this.picker.new},e.prototype.getType=function(){return"DDialogColor"},e}(yu),Ag=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onActivate=function(e){var n=this;t.prototype.onActivate.call(this,e);var i=this.dialog,r=this.text.computed;if(null!=r){var o=i.current;o.color=r.color,o.alpha=r.alpha;var s=i.new;s.color=r.color,s.alpha=r.alpha}i.open(this).then((function(){n.onValueChange(n.toClone(i.new),n.toClone(i.current))}))},e.prototype.toClone=function(t){return{color:t.color,alpha:t.alpha}},e.prototype.onValueChange=function(t,e){var n=this.text.computed;null!=n&&(n.color=t.color,n.alpha=t.alpha),this.onColorChange(),this.emit("change",t,e,this)},e.prototype.onColorChange=function(){var t=this.image.get(0);if(null!=t){var e=this.text.computed;null!=e&&(t.tint.color=e.color)}this.text.compute(!0)},Object.defineProperty(e.prototype,"dialog",{get:function(){var t,n=this._dialog;if(null==n){var i=null===(t=this._options)||void 0===t?void 0:t.dialog;i?n=this.newDialog(i):(null==e.DIALOG&&(e.DIALOG=this.newDialog({mode:"MENU",sticky:!0})),n=e.DIALOG),this._dialog=n}return n},enumerable:!1,configurable:!0}),e.prototype.newDialog=function(t){return new Ig(t)},Object.defineProperty(e.prototype,"value",{get:function(){var t=this._value;return null==t&&(t=this.newValue(),this._value=t),t},enumerable:!1,configurable:!0}),e.prototype.newValue=function(){var t=this,e=this.text,n=e.computed;return new cg(n,(function(e){n.color=e,t.onColorChange()}),(function(t){n.alpha=t,e.compute(!0)}))},e.prototype.getType=function(){return"DButtonColor"},e}(za),Rg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonDanger"},e}(za),Pg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onActivate=function(e){var n,i,r=this;t.prototype.onActivate.call(this,e);var o=null!==(i=null===(n=this.text.computed)||void 0===n?void 0:n.getTime())&&void 0!==i?i:Date.now(),s=this.dialog;s.current=new Date(o),s.new=new Date(o),s.page=new Date(o),s.open(this).then((function(){r.onValueChange(s.new,s.current)}))},e.prototype.onValueChange=function(t,e){this.text=new Date(t.getTime()),this.emit("change",t,e,this)},Object.defineProperty(e.prototype,"dialog",{get:function(){var t,n=this._dialog;if(null==n){var i=null===(t=this._options)||void 0===t?void 0:t.dialog;i?n=this.newDialog(i):(null==e.DIALOG&&(e.DIALOG=this.newDialog({mode:"MENU",sticky:!0})),n=e.DIALOG),this._dialog=n}return n},enumerable:!1,configurable:!0}),e.prototype.newDialog=function(t){return new Uu(t)},Object.defineProperty(e.prototype,"value",{get:function(){var t;return null!==(t=this.text.computed)&&void 0!==t?t:new Date},set:function(t){var e=this.text.computed;void 0!==e&&e.getTime()===t.getTime()||(this.text=t)},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DButtonDate"},e}(za),Mg=function(){function t(){}return t.format=function(t){var e=ge(String(t.getFullYear()),4,"0"),n=ge(String(t.getMonth()+1),2,"0"),i=ge(String(t.getDate()),2,"0");return"".concat(e,"/").concat(n,"/").concat(i)},t}(),kg=function(){function t(){}return t.format=function(t,e){var n="";return e&Eu.HOURS&&(n+=ge(String(t.getHours()),2,"0")),e&Eu.MINUTES&&(0<n.length&&(n+=":"),n+=ge(String(t.getMinutes()),2,"0")),e&Eu.SECONDS&&(0<n.length&&(n+=":"),n+=ge(String(t.getSeconds()),2,"0")),n},t.toMask=function(t){return Ou.from("DPickerTime",t)},t}(),Lg=function(){function t(){}return t.format=function(t,e){var n=kg.format(t,e);return 0<n.length?"".concat(Mg.format(t)," ").concat(n):"".concat(Mg.format(t))},t.toMask=function(t){return Ou.from("DPickerDatetime",t)},t}(),Ng=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onActivate=function(e){var n,i,r=this;t.prototype.onActivate.call(this,e);var o=null!==(i=null===(n=this.text.computed)||void 0===n?void 0:n.getTime())&&void 0!==i?i:Date.now(),s=this.dialog;s.current=new Date(o),s.new=new Date(o),s.page=new Date(o),s.open(this).then((function(){r.onValueChange(s.new,s.current)}))},e.prototype.onValueChange=function(t,e){this.text=new Date(t.getTime()),this.emit("change",t,e,this)},e.prototype.getDatetimeMask=function(){var t,e,n=this._datetimeMask;return null==n&&(n=Lg.toMask(null===(e=null===(t=this._options)||void 0===t?void 0:t.dialog)||void 0===e?void 0:e.picker),this._datetimeMask=n),n},Object.defineProperty(e.prototype,"dialog",{get:function(){var t,n=this._dialog;if(null==n){var i=null===(t=this._options)||void 0===t?void 0:t.dialog;i?n=this.newDialog(i):(null==e.DIALOG&&(e.DIALOG=this.newDialog({mode:"MENU",sticky:!0})),n=e.DIALOG),this._dialog=n}return n},enumerable:!1,configurable:!0}),e.prototype.newDialog=function(t){return new Mu(t)},Object.defineProperty(e.prototype,"value",{get:function(){var t;return null!==(t=this.text.computed)&&void 0!==t?t:new Date},set:function(t){var e=this.text.computed;void 0!==e&&e.getTime()===t.getTime()||(this.text=t)},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DButtonDatetime"},e}(za),Bg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getChecker=function(){var t,e,n=this._checker;return void 0===n&&(n=null!==(e=null===(t=this._options)||void 0===t?void 0:t.checker)&&void 0!==e?e:null,this._checker=n),n},e.prototype.getOpener=function(){var t=this._opener;return null==t&&(t=this.newOpener(),this._opener=t),t},e.prototype.newOpener=function(){var t,e;return new ky(ai(null!==(e=null===(t=this._options)||void 0===t?void 0:t.as)&&void 0!==e?e:My.TEXT,My),this)},e.prototype.onActivate=function(e){var n=this;t.prototype.onActivate.call(this,e),this.check((function(){n.open()}))},e.prototype.check=function(t){var e=this.getChecker();if(null!=e){var n=e();!0===n?t():!1===n||n.then((function(){t()}))}else t()},e.prototype.open=function(){this.getOpener().open()},e.prototype.getType=function(){return"DButtonFile"},e}(za),zg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onClick=function(e){this.link.onClick(this,e)||t.prototype.onClick.call(this,e)},Object.defineProperty(e.prototype,"link",{get:function(){var t=this._link;return null==t&&(t=new ld(this._options),this._link=t),t},enumerable:!1,configurable:!0}),e.prototype.onActivate=function(e){t.prototype.onActivate.call(this,e),this.link.open(e)},e.prototype.open=function(t){this.link.open(t)},e.prototype.getType=function(){return"DButtonLink"},e}(Ba),Ug=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonRadio"},e}(Ba),jg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonRadioRight"},e}(Ug),Fg=function(t){function e(e){var n=t.call(this,e)||this,i=n.state,r=Zy.getCommandController();return i.isDisabled=!r.isRedoable(),r.on("change",(function(){i.isDisabled=!r.isRedoable()})),n}return F(e,t),e.prototype.onActivate=function(e){t.prototype.onActivate.call(this,e),Zy.getCommandController().redo()},e}(za),Hg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DButtonSecondary"},e}(za),Gg={NONE:0,SINGLE:1,MULTIPLE:2},Vg=function(t){function e(e,n){var i=t.call(this,n)||this;return i._data=e,i.on(cr.tap,(function(t){i.onClick(t)})),i}return F(e,t),Object.defineProperty(e.prototype,"link",{get:function(){var t=this._link;return void 0===t&&(t=this.newLink(),this._link=t),t},enumerable:!1,configurable:!0}),e.prototype.newLink=function(){var t=this._data.accessor.link;return t?new ld(this.toLinkOptions(t)):null},e.prototype.onClick=function(t){var e;!0!==(null===(e=this.link)||void 0===e?void 0:e.onClick(this,t))&&this.state.isActionable&&this.activate(t)},e.prototype.activate=function(t){var e=this._value;void 0!==e&&this.onSelect(t,e)},e.prototype.toLinkOptions=function(t){return{url:this.toLinkUrl(t.toUrl),target:t.target,checker:this.toLinkChecker(t.checker)}},e.prototype.toLinkUrl=function(t){var e=this;return function(){var n=e._value;if(void 0!==n)return t(n)}},e.prototype.toLinkChecker=function(t){var e=this;if(t)return function(){var n=e._value;return null!=n&&t(n)}},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),e.prototype.onSelect=function(t,e){var n;this.emit("select",e,this);var i=this._data,r=i.selection;if(r.type!==Gg.MULTIPLE)r.clearAndAdd(e);else{var o=t&&"data"in t?t.data.originalEvent:t;if(null==o?void 0:o.ctrlKey)r.toggle(e);else if(null==o?void 0:o.shiftKey){var s=i.mapped,a=r.last;if(e===a)r.clearAndAdd(e);else{var u=!1,l=!1,h=[];s.each((function(t){if(u){if(l){if(h.unshift(t),t===e)return!1}else if(h.push(t),t===a)return!1}else t===e?(u=!0,l=!1,h.push(t)):t===a&&(u=!0,l=!0,h.push(t))})),r.clearAndAddAll(h)}}else r.clearAndAdd(e)}null===(n=this._link)||void 0===n||n.open(t)},e.prototype.set=function(t,e,n){var i=this._data,r=n||this._value!==t;if(r){this._value=t,this._index=e;var o=i.accessor;this.text=o.toLabel(t),this.title=o.toTitle(t)||"",this.image=o.toImage(t)}var s=this.state;s.lock(),s.set(vt.ACTIVE,i.selection.contains(t)),s.remove(vt.DISABLED),s.unlock(),r&&this.emit("set",t,e,this)},e.prototype.unset=function(){if(void 0!==this._value){this._value=void 0,this._index=void 0,this.text=void 0,this.title="",this.image=void 0;var t=this.state;t.lock(),t.add(vt.DISABLED),t.remove(vt.ACTIVE),t.unlock(),this.emit("unset",this)}},e.prototype.onKeyDown=function(e){return no.isActivateKey(e)&&this.onKeyDownActivate(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyDownActivate=function(t){return!(!this.state.isActionable||!this.state.isFocused||(this.activate(t),0))},e.prototype.getType=function(){return"DListItem"},e}(Na),Wg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogSelectListItem"},e}(Vg),Kg=function(){function t(t,e,n,i){this._updateItemsCount=0,this._isUpdateItemsCalled=!1,this._isUpdateItemsCalledForcibly=!1,this._itemHeight=-1,this._itemWidth=-1,this._multiplicity=1,this._itemIndexStart=0,this._itemIndexEnd=0,this._workItems=[],this._data=t,this._content=e,this._container=n,this._newItem=this.toNewItem(i),this._initItem=this.toInitItem(i)}return t.prototype.toNewItem=function(t){return(null==t?void 0:t.newItem)||this.newItem},t.prototype.toInitItem=function(t){return t?t.initItem||(!1!==t.stripe?this.initItem:this.initItemNoStriping):this.initItem},t.prototype.initItem=function(t,e,n){return t.state.isAlternated=e%2==1,t},t.prototype.initItemNoStriping=function(t,e,n){return t},Object.defineProperty(t.prototype,"multiplicity",{get:function(){return this._multiplicity},enumerable:!1,configurable:!0}),t.prototype.lock=function(){this._updateItemsCount+=1,1===this._updateItemsCount&&(this._isUpdateItemsCalled=!1,this._isUpdateItemsCalledForcibly=!1)},t.prototype.unlock=function(t){this._updateItemsCount-=1,0===this._updateItemsCount&&(t&&this._isUpdateItemsCalled&&this.update(this._isUpdateItemsCalledForcibly),this._isUpdateItemsCalled=!1,this._isUpdateItemsCalledForcibly=!1)},t.prototype.update=function(t){var e=this;if(0<this._updateItemsCount)return this._isUpdateItemsCalled=!0,void(t&&(this._isUpdateItemsCalledForcibly=!0));var n=this._content,i=n.parent;if(null!=i){var r=this._container,o=r.children,s=i.height,a=this._data,u=this.toMapped(a),l=u.size(),h=this._itemIndexStart,c=this._itemIndexEnd,p=c-h,f=this._newItem,d=this._initItem,y=this._itemHeight,g=this._itemWidth;if(this._itemHeight<0){var v=void 0;0<o.length?v=o[0]:(v=d(f(a),h,a),r.addChild(v),c+=1,p+=1),y=Math.max(1,v.height),St(v.getWidth())&&(g=Math.max(1,v.width)),this._itemHeight=y,this._itemWidth=g}var _=n.padding,m=_.getTop(),b=_.getBottom(),T=_.getLeft(),w=_.getRight(),E=Math.max(0,n.width-T-w),O=0<g?Math.max(1,Math.floor(E/g)):1;this._multiplicity=O;var C=n!==r?r.transform.position.y:m,S=Math.ceil(l/O)*y,x=Math.max(s,m+S+b),D=Math.max(s-x,n.position.y),I=Math.floor((0-(D+C))*O/y),A=Math.floor((s-(D+C))*O/y),R=I-O;R%2!=0&&(R-=1);var P=A+O+O;P%2!=0&&(P+=1);var M=P-R;if(M<p&&(P=R+(M=p)),p<M){for(var k=p;k<M;++k){var L=h+k;v=d(f(a),L,a),r.addChild(v)}c=h+(p=M)}else if(M<p){for(k=p-1;M<=k;--k)r.removeChild(o[k]);c=h+(p=M)}this._itemIndexStart=R,this._itemIndexEnd=P;var N=R-h,B=Math.abs(N),z=o.length;if(0<B&&B<z){var U=this._workItems;if(0<N){for(k=0;k<B;++k)v=o[k],this.reset(v),U.push(v);for(k=B;k<z;++k)o[k-B]=o[k];for(k=0;k<B;++k)o[z-B+k]=U[k]}else{for(k=0;k<B;++k)v=o[z-B+k],this.reset(v),U.push(v);for(k=z-B-1;0<=k;--k)o[k+B]=o[k];for(k=0;k<B;++k)o[k]=U[k]}U.length=0}var j=0,F=0;for(n===r&&(j=T,F=m),u.each((function(n,i){var r=o[i-R],s=i%O,a=Math.floor(i/O);r.position.set(j+s*g,F+a*y),e.set(r,n,i,t)}),R,R+z),k=0;R+k<0&&k<z;++k){v=o[k];var H=(V=R+k)%O,G=Math.floor(V/O);v.position.set(j+H*g,F+G*y),this.unset(v)}for(k=z-1;l<=R+k&&0<=k;--k){var V;v=o[k],H=(V=R+k)%O,G=Math.floor(V/O),v.position.set(j+H*g,F+G*y),this.unset(v)}this.lock(),n.position.y=D,n.height=x,n!==r&&(r.height=S),this.unlock(!1)}},t.prototype.set=function(t,e,n,i){t.set(e,n,i)},t.prototype.unset=function(t){t.unset()},t.prototype.reset=function(t){t.blur(!0);for(var e=t.children,n=0,i=e.length;n<i;++n){var r=e[n];if(r instanceof ao){var o=r.state;o.lock(),o.isPressed=!1,o.isHovered=!1,o.unlock()}}return t.state.isHovered=!1,t},t.prototype.moveFocus=function(t,e,n,i){if(!n&&!i)return!1;var r=n&&no.isArrowUpKey(t),o=n&&no.isArrowDownKey(t),s=i&&no.isArrowLeftKey(t),a=i&&no.isArrowRightKey(t);if(!(r||o||s||a))return!1;if(!e.state.isActionable)return!1;var u=ft.getLayer(e);if(null==u)return!1;var l=u.getFocusController(),h=l.get();if(null==h)return!1;var c=this._container;if(h.parent!==c)return!1;var p=h,f=p.index;if(null==f)return!1;var d=this._multiplicity,y=this._data,g=this.toMapped(y).size(),v=f;if((s||a)&&(s?0<=v-1&&(v-=1):v+1<g&&(v+=1)),(r||o)&&(r?0<=v-d&&(v-=d):v+d<g&&(v+=d)),v===f)return!1;var _=c.children,m=_.indexOf(p);if(m<0)return!1;var b=m+(v-f);if(b<0||_.length<=b)return!1;var T=_[b];return l.focus(T),!0},t}(),Xg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMapped=function(t){return t.mapped},e.prototype.newItem=function(t){return new Vg(t)},e}(Kg),Yg=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newItem=function(t){return new Wg(t)},e}(Xg),qg=function(){function t(t){this._parent=t}return t.prototype.size=function(){var t=this._parent;return t.before.length+t.items.length+t.after.length},t.prototype.each=function(t,e,n){var i=this._parent,r=this.each_(t,i.before,0,e,n);if(!(r<0)){var o=this.each_(t,i.items,r,e,n);o<0||this.each_(t,i.after,o,e,n)}},t.prototype.each_=function(t,e,n,i,r){for(var o=n+e.length,s=null!=i?Math.max(n,i):n,a=null!=r?Math.min(o,r):o,u=s;u<a;++u)if(!1===t(e[u-n],u))return-1;return a},t}(),Zg=function(t){function e(e,n,i){var r=t.call(this)||this;r._parent=e,r._accessor=n,r._items=new Set;var o=null==i?void 0:i.on;if(o)for(var s in o){var a=o[s];a&&r.on(s,a)}return r}return F(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return Gg.MULTIPLE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this.get(0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this.get(this.size()-1)},enumerable:!1,configurable:!0}),e.prototype.get=function(t){var e=this._items;if(0<=t&&t<e.size){var n=0,i=null;return e.forEach((function(e){n===t&&(i=e),n+=1})),i}return null},e.prototype.add=function(t){var e=this._items;return!e.has(t)&&(e.add(t),this.onChange(),!0)},e.prototype.remove=function(t){var e=this._items;return!!e.has(t)&&(e.delete(t),this.onChange(),!0)},e.prototype.toggle=function(t){var e=this._items;return e.has(t)?e.delete(t):e.add(t),this.onChange(),!0},e.prototype.clear=function(){var t=this._items;0<t.size&&(t.clear(),this.onChange())},e.prototype.clearAndAdd=function(t){var e=this._items;return 1===e.size?!e.has(t)&&(e.clear(),e.add(t),this.onChange(),!0):(e.clear(),e.add(t),this.onChange(),!0)},e.prototype.clearAndAddAll=function(t){for(var e=!1,n=new Set,i=this._items,r=0,o=t.length;r<o;++r){var s=t[r];i.has(s)||(e=!0),n.add(s)}return e||i.forEach((function(t){n.has(t)||(e=!0)})),e&&(this._items=n,this.onChange()),e},e.prototype.contains=function(t){return this._items.has(t)},e.prototype.size=function(){return this._items.size},e.prototype.isEmpty=function(){return this.size()<=0},e.prototype.each=function(t){var e=!1;this._items.forEach((function(n){e||!1===t(n)&&(e=!0)}))},e.prototype.toArray=function(){var t=[];return this._items.forEach((function(e){t.push(e)})),t},e.prototype.onChange=function(){this._parent.update(),this.emit("change",this)},e.prototype.toItemIdMap=function(t,e,n){for(var i=0,r=t.length;i<r;++i){var o=t[i];n.set(e(o),o)}},e.prototype.toItemSet=function(t,e){for(var n=0,i=t.length;n<i;++n)e.add(t[n])},e.prototype.onItemChange=function(t,e,n){var i=this._items,r=new Set,o=this._accessor.toId;if(o){var s=new Map;this.toItemIdMap(t,o,s),this.toItemIdMap(e,o,s),this.toItemIdMap(n,o,s),i.forEach((function(t){var e=o(t),n=s.get(e);null!=n&&r.add(n)})),this._items=r,this.onChange()}else{var a=new Set;this.toItemSet(t,a),this.toItemSet(e,a),this.toItemSet(n,a),i.forEach((function(t){a.has(t)&&r.add(t)})),i.size!==r.size&&(this._items=r,this.onChange())}},e.prototype.newItems=function(t,e,n){for(var i=0,r=t.length;i<r;++i){var o=t[i];e.has(o)&&n.add(o)}return n},e}(t.utils.EventEmitter),Jg=function(t){function e(e,n,i){var r=t.call(this)||this;r._parent=e;var o=null==i?void 0:i.on;if(o)for(var s in o){var a=o[s];a&&r.on(s,a)}return r}return F(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return Gg.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return null},enumerable:!1,configurable:!0}),e.prototype.get=function(t){return null},e.prototype.add=function(t){return!1},e.prototype.remove=function(t){return!1},e.prototype.toggle=function(t){return!1},e.prototype.clear=function(){},e.prototype.clearAndAdd=function(t){return!1},e.prototype.clearAndAddAll=function(t){return!1},e.prototype.contains=function(t){return!1},e.prototype.size=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.each=function(t){},e.prototype.toArray=function(){return[]},e.prototype.onChange=function(){this._parent.update(),this.emit("change",this)},e.prototype.onItemChange=function(t,e,n){},e}(t.utils.EventEmitter),Qg=function(t){function e(e,n,i){var r=t.call(this)||this;r._parent=e,r._accessor=n,r._item=null;var o=null==i?void 0:i.on;if(o)for(var s in o){var a=o[s];a&&r.on(s,a)}return r}return F(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return Gg.SINGLE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this._item},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this.get(this.size()-1)},enumerable:!1,configurable:!0}),e.prototype.get=function(t){return 0===t?this._item:null},e.prototype.add=function(t){return this._item!==t&&(this._item=t,this.onChange(),!0)},e.prototype.remove=function(t){return this._item===t&&(this._item=null,this.onChange(),!0)},e.prototype.toggle=function(t){return this._item===t?this._item=null:this._item=t,this.onChange(),!0},e.prototype.clear=function(){null!=this._item&&(this._item=null,this.onChange())},e.prototype.clearAndAdd=function(t){return this._item!==t&&(this._item=t,this.onChange(),!0)},e.prototype.clearAndAddAll=function(t){var e=t.length;if(0<e){var n=t[e-1];if(this._item!==n)return this._item=n,this.onChange(),!0}else if(null!=this._item)return this._item=null,this.onChange(),!0;return!1},e.prototype.contains=function(t){return this._item===t},e.prototype.size=function(){return null!=this._item?1:0},e.prototype.isEmpty=function(){return this.size()<=0},e.prototype.each=function(t){var e=this._item;null!=e&&t(e)},e.prototype.toArray=function(){var t=this._item;return null!=t?[t]:[]},e.prototype.onChange=function(){this._parent.update(),this.emit("change",this)},e.prototype.findById=function(t,e,n){for(var i=0,r=n.length;i<r;++i){var o=n[i];if(t===e(o))return o}return null},e.prototype.find=function(t,e){for(var n=0,i=e.length;n<i;++n){var r=e[n];if(t===r)return r}return null},e.prototype.onItemChange=function(t,e,n){var i=this._item;if(null!=i){var r=null,o=this._accessor.toId;if(o){var s=o(i);r=this.findById(s,o,t)||this.findById(s,o,e)||this.findById(s,o,n)}else r=this.find(i,t)||this.find(i,e)||this.find(i,n);i!==r&&(this._item=r,this.onChange())}},e}(t.utils.EventEmitter),$g=function(t){return t.image},tv=function(t){return t.title},ev=function(t){return t.url},nv=function(){function t(t){this.toLabel=(null==t?void 0:t.toLabel)||Ay,this.toTitle=(null==t?void 0:t.toTitle)||tv,this.toImage=(null==t?void 0:t.toImage)||$g,this.toId=null==t?void 0:t.toId,this.link=this.toLink(t)}return t.prototype.toLink=function(t){if(t){var e=t.link;if(e){var n=e.toUrl,i=e.target,r=e.checker;if(void 0!==n||void 0!==i||void 0!==r)return{toUrl:n||ev,target:i,checker:r}}}},t}(),iv=function(){function t(t,e){this._parent=t,e?(this._before=e.before||[],this._items=e.items||[],this._after=e.after||[]):(this._before=[],this._items=[],this._after=[]);var n=new nv(e);this._accessor=n,this._selection=this.toSelection(n,e),this._mapped=new qg(this)}return t.prototype.toSelection=function(t,e){var n=null==e?void 0:e.selection;switch(null==n?void 0:n.type){case Gg.NONE:case"NONE":return new Jg(this,t,n);case Gg.MULTIPLE:case"MULTIPLE":return new Zg(this,t,n);default:return new Qg(this,t,n)}},Object.defineProperty(t.prototype,"before",{get:function(){return this._before},set:function(t){this._before=t,this._selection.onItemChange(t,this._items,this._after),this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){return this._items},set:function(t){this._items=t,this._selection.onItemChange(this._before,t,this._after),this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"after",{get:function(){return this._after},set:function(t){this._after=t,this._selection.onItemChange(this._before,this._items,t),this.update()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mapped",{get:function(){return this._mapped},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessor",{get:function(){return this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this._selection},enumerable:!1,configurable:!0}),t.prototype.update=function(t){this._parent.update(t)},t.prototype.size=function(){return this._items.length},t.prototype.clear=function(){var t=this._items;return 0<t.length&&(t.length=0,this.onChange(),!0)},t.prototype.clearAndAdd=function(t){var e=this._items;return 1===e.length?e[0]!==t&&(e[0]=t,this.onChange(),!0):(e.length=0,e.push(t),this.onChange(),!0)},t.prototype.clearAndAddAll=function(t){var e=!1,n=this._items;if(0<n.length&&(n.length=0,e=!0),0<t.length){for(var i=0,r=t.length;i<r;++i)n.push(t[i]);e=!0}return!!e&&(this.onChange(),!0)},t.prototype.add=function(t,e){var n=this._items;return null==e?(n.push(t),this.onChange(),!0):0<=e&&e<n.length&&(n.splice(e,0,t),this.onChange(),!0)},t.prototype.addAll=function(t,e){if(0<t.length){var n=this._items,i=n.length;if(null==e){for(var r=0,o=t.length;r<o;++r)n.push(t[r]);return this.onChange(),!0}if(0<=e&&e<i){for(r=0,o=t.length;r<o;++r)n.splice(e+r,0,t[r]);return this.onChange(),!0}}return!1},t.prototype.get=function(t){var e=this._items;return 0<=t&&t<e.length?e[t]:null},t.prototype.set=function(t,e){var n=this._items;if(0<=t&&t<n.length){var i=n[t];return n[t]=e,this.onChange(),i}return null},t.prototype.remove=function(t){var e=this._items;if(0<=t&&t<e.length){var n=e.splice(t,1)[0];return this.onChange(),n}return null},t.prototype.each=function(t,e,n){for(var i=this._items,r=i.length,o=null!=e?Math.max(0,e):0,s=null!=n?Math.min(r,n):r,a=o;a<s&&!1!==t(i[a],a);++a);},t.prototype.onChange=function(){this.update()},t}(),rv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.initReflowable=function(){},e.prototype.getType=function(){return"DContent"},e}(ao),ov=function(t){function e(e){var n,i,r=t.call(this,e)||this;r._start=0,r._end=1,r.visible=!1,r._touchedAt=-1,r._isTouched=!1,r._fadeOutTimeoutId=null,r._fadeOutDelay=null!==(i=null===(n=null==e?void 0:e.fadeOut)||void 0===n?void 0:n.delay)&&void 0!==i?i:r.theme.getFadeOutDelay(),r._isSilent=!0,r._onFadeOutTimeoutBound=function(){r.onFadeOutTimeout()};var o=r.newThumb(null==e?void 0:e.thumb);return o.on("statechange",(function(t,e){r.onThumbStateChange(t,e)})),r._thumb=o,r.addChild(o),r}return F(e,t),Object.defineProperty(e.prototype,"thumb",{get:function(){return this._thumb},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"start",{get:function(){return this._start},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"end",{get:function(){return this._end},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i){n<1?(t=0,e=1):(t=Math.max(0,Math.min(1,t/n)),e=Math.max(t,Math.min(1,e/n))),this._start===t&&this._end===e||(this._start=t,this._end=e,this.onChange(i))},e.prototype.onChange=function(t){this.updateThumb(this.width,this.height),t&&(this._isSilent=!0),this._isTouched||(this._isTouched=!0,ft.update(this))},e.prototype.touch=function(t){this.onChange(t)},e.prototype.isRegionVisible=function(){return 0<this._start||this._end<1},e.prototype.render=function(e){if(this._isTouched)if(this._isTouched=!1,!this._isSilent&&this.isRegionVisible()){var n=this._fadeOutDelay;0<=n&&(this._touchedAt=Date.now(),null==this._fadeOutTimeoutId&&(this._fadeOutTimeoutId=window.setTimeout(this._onFadeOutTimeoutBound,n))),this.visible||(this.visible=!0,this.updateTransform())}else this._fadeOutDelay<0&&this.visible&&(this.visible=!1);this._isSilent&&(this._isSilent=!1),t.prototype.render.call(this,e)},e.prototype.onResize=function(e,n,i,r){t.prototype.onResize.call(this,e,n,i,r),this.updateThumb(e,n)},e.prototype.onFadeOutTimeout=function(){this._fadeOutTimeoutId=null;var t=this._fadeOutDelay,e=this._onFadeOutTimeoutBound,n=this.state;if(n.isGesturing||n.onHovered||n.isHovered||n.isPressed)this._fadeOutTimeoutId=window.setTimeout(e,t);else{var i=this._thumb.state;if(i.isGesturing||i.isHovered||i.isPressed)this._fadeOutTimeoutId=window.setTimeout(e,t);else{var r=t-(Date.now()-this._touchedAt);0<r?this._fadeOutTimeoutId=window.setTimeout(e,r):this.visible&&(this.visible=!1,ft.update(this))}}},e.prototype.onThumbStateChange=function(t,e){t.isGesturing||t.isHovered||t.isPressed||(e.isGesturing||e.isHovered||e.isPressed)&&(this._touchedAt=Date.now())},e.prototype.onStateChange=function(e,n){t.prototype.onStateChange.call(this,e,n),e.isGesturing||e.isHovered||e.isPressed||(n.isGesturing||n.isHovered||n.isPressed)&&(this._touchedAt=Date.now())},e.prototype.getType=function(){return"DScrollBar"},e}(ao),sv=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(n){var i=this;e.prototype.init.call(this,n);var r=new t.Point;this._gestureUtil=new _r({bind:this,on:{start:function(){r.copyFrom(i.position)},move:function(t,e,n){r.set(r.x+e,r.y+n),i.onGestureMove(r.x,r.y)}}})},n.prototype.getMinimumLength=function(){return this.theme.getThumbMinimumLength()},n.prototype.getType=function(){return"DScrollBarThumb"},n}(ao),av=function(t){function e(e){var n=t.call(this)||this;return e.snippet.add(n,!0),e.reflowable.add(n),n}return F(e,t),e.prototype.onReflow=function(t,e,n){this.clear();var i=t.state,r=t.border,o=r.getColor(i);if(null!=o){var s=r.getAlpha(i),a=r.getWidth(i),u=r.getAlign(i);this.beginFill(o,s),this.lineStyle(0,0,0,0),this.drawRect(0,u*(n-a),e,a),this.endFill(),this.visible=!0}else this.visible=!1},e}(t.Graphics),uv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onGestureMove=function(t,e){this.emit("regionmove",t,this)},e.prototype.initReflowable=function(){new av(this)},e}(sv),lv=function(t){function e(e){var n=t.call(this,e)||this;return n._thumb.on("regionmove",(function(t){n.onThumbRegionMove(t)})),n}return F(e,t),e.prototype.onThumbRegionMove=function(t){var e=this.width;if(0<e){var n=this._end-this._start,i=Math.min(1-n,Math.max(0,t/e));this._start!==i&&this.emit("regionmove",i,this)}},e.prototype.onDownThis=function(e){t.prototype.onDownThis.call(this,e);var n=this.width;if(0<n){var i=this._end-this._start,r=e.data.getLocalPosition(this),o=Math.min(1-i,Math.max(0,r.x/n-.5*i));this._start!==o&&this.emit("regionmove",o,this)}},e.prototype.newThumb=function(t){return new uv(t)},e.prototype.updateThumb=function(t,e){var n=this._thumb,i=Math.min(.5*t,n.getMinimumLength()),r=t-i,o=r*this._start,s=r*this._end+i-o;n.position.set(o,0),n.resize(s,e)},e}(ov),hv=function(t){function e(e){var n=t.call(this)||this;return e.snippet.add(n,!0),e.reflowable.add(n),n}return F(e,t),e.prototype.onReflow=function(t,e,n){this.clear();var i=t.state,r=t.border,o=r.getColor(i);if(null!=o){var s=r.getAlpha(i),a=r.getWidth(i),u=r.getAlign(i);this.beginFill(o,s),this.lineStyle(0,0,0,0),this.drawRect(u*(e-a),0,a,n),this.endFill(),this.visible=!0}else this.visible=!1},e}(t.Graphics),cv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onGestureMove=function(t,e){this.emit("regionmove",e,this)},e.prototype.initReflowable=function(){new hv(this)},e}(sv),pv=function(t){function e(e){var n=t.call(this,e)||this;return n._thumb.on("regionmove",(function(t){n.onThumbRegionMove(t)})),n}return F(e,t),e.prototype.onThumbRegionMove=function(t){var e=this.height;if(0<e){var n=this._end-this._start,i=Math.min(1-n,Math.max(0,t/e));this._start!==i&&this.emit("regionmove",i,this)}},e.prototype.onDownThis=function(e){t.prototype.onDownThis.call(this,e);var n=this.height;if(0<n){var i=this._end-this._start,r=e.data.getLocalPosition(this),o=Math.min(1-i,Math.max(0,r.y/n-.5*i));this._start!==o&&this.emit("regionmove",o,this)}},e.prototype.newThumb=function(t){return new cv(t)},e.prototype.updateThumb=function(t,e){var n=this._thumb,i=Math.min(.5*e,n.getMinimumLength()),r=e-i,o=r*this._start,s=r*this._end+i-o;n.position.set(0,o),n.resize(t,s),n.updateTransform()},e}(ov),fv=function(){function t(t,e,n){this._parent=t,this._onUpdate=n,this._isLocked=0,this._isCalled=!1,this.vertical=new pv(null==e?void 0:e.vertical),this.horizontal=new lv(null==e?void 0:e.horizontal)}return t.prototype.lock=function(){this._isLocked+=1,1===this._isLocked&&(this._isCalled=!1,this._isCalledSilently=void 0)},t.prototype.unlock=function(t){this._isLocked-=1,0===this._isLocked&&(t&&this._isCalled&&this.update(this._isCalledSilently),this._isCalled=!1,this._isCalledSilently=void 0)},t.prototype.update=function(t){if(0<this._isLocked)return this._isCalled=!0,void(null!=t&&(this._isCalledSilently||(this._isCalledSilently=t)));var e=this._parent,n=e.width,i=e.height,r=e.content,o=-r.x,s=-r.y,a=this.vertical,u=a.width,l=this.getOffsetVerticalStart(u),h=this.getOffsetVerticalEnd(u);a.set(s,s+i,r.height,t),a.position.set(n-u,l),a.height=i-l-h;var c=this.horizontal,p=c.height,f=this.getOffsetHorizontalStart(p),d=this.getOffsetHorizontalEnd(p);c.set(o,o+n,r.width,t),c.position.set(f,i-p),c.width=n-f-d,this._onUpdate(a.isRegionVisible()||c.isRegionVisible())},t.prototype.touch=function(t){this.vertical.touch(t),this.horizontal.touch(t)},t.prototype.getOffsetHorizontalStart=function(t){return.5*t},t.prototype.getOffsetHorizontalEnd=function(t){return.5*t},t.prototype.getOffsetVerticalStart=function(t){return.5*t},t.prototype.getOffsetVerticalEnd=function(t){return.5*t},t}(),dv=function(e){function n(t){var n,i=e.call(this,t)||this,r=i.theme;(null!==(n=null==t?void 0:t.mask)&&void 0!==n?n:r.isOverflowMaskEnabled())&&(i.mask=i.getOverflowMask()),i.addChild(i.content);var o=i.scrollbar;return i.addChild(o.vertical),i.addChild(o.horizontal),o.update(),i.initGesture(r,t),i}return F(n,e),n.prototype.initGesture=function(e,n){var i,r,o=this,s=ai(null!==(r=null===(i=null==n?void 0:n.gesture)||void 0===i?void 0:i.mode)&&void 0!==r?r:e.getGestureMode(),lo);if(s===lo.ON||s===lo.TOUCH){var a=new t.Point,u=this.content;this._gestureUtil=new _r({bind:this,touch:s===lo.TOUCH,on:{start:function(){a.copyFrom(u.position)},move:function(t,e,n){a.set(a.x+e,a.y+n),u.position.set(o.toContentX(u,a.x),o.toContentY(u,a.y))}}})}},Object.defineProperty(n.prototype,"scrollbar",{get:function(){var t,e=this._scrollbar;return null==e&&(e=this.newScrollBar(null===(t=this._options)||void 0===t?void 0:t.scrollbar),this.initScrollBar(e),this._scrollbar=e),e},enumerable:!1,configurable:!0}),n.prototype.newScrollBar=function(t){var e=this;return new fv(this,t,(function(t){e.onScrollBarUpdate(t)}))},n.prototype.onScrollBarUpdate=function(t){},n.prototype.initScrollBar=function(t){var e=this;t.vertical.on("regionmove",(function(t){e.onScrollBarMoveY(t)})),t.horizontal.on("regionmove",(function(t){e.onScrollBarMoveX(t)}))},n.prototype.onScrollBarMoveX=function(t){var e=this._gestureUtil;null!=e&&e.stop(this);var n=this.content;n.x=-n.width*t},n.prototype.onScrollBarMoveY=function(t){var e=this._gestureUtil;null!=e&&e.stop(this);var n=this.content;n.y=-n.height*t},n.prototype.onOver=function(t){e.prototype.onOver.call(this,t),this.scrollbar.touch()},n.prototype.getType=function(){return"DPane"},Object.defineProperty(n.prototype,"content",{get:function(){var t=this._content;return null==t&&(t=this.toContent(this._options),this.initContent(t),this._content=t),t},enumerable:!1,configurable:!0}),n.prototype.toContent=function(t){var e=null==t?void 0:t.content;return e?e instanceof ao?e:this.newContent(e):this.newContent()},n.prototype.newContent=function(t){return new rv(t)},n.prototype.initContent=function(t){var e=this;t.on("move",(function(){e.onContentChange()})),t.on("resize",(function(){e.onContentChange()}))},n.prototype.getOverflowMask=function(){var t=this._overflowMask;return void 0===t&&(t=this.newOverflowMask(),this._overflowMask=t),t},n.prototype.newOverflowMask=function(){var t=new uo(this);return this.reflowable.add(t),this.toDirty(),t},n.prototype.onWheel=function(t,e,n){var i=this.content,r=this.getWheelContentX(i,e.deltaX*e.lowest),o=this.getWheelContentY(i,e.deltaY*e.lowest);if(i.x!==r||i.y!==o){var s=this._gestureUtil;return null!=s&&s.stop(this),i.position.set(r,o),!0}return!1},n.prototype.getWheelContentX=function(t,e){if(0<e||e<0){var n=this.theme.getWheelSpeed();return this.toContentX(t,t.x-e*n)}return t.x},n.prototype.getWheelContentY=function(t,e){if(0<e||e<0){var n=this.theme.getWheelSpeed();return this.toContentY(t,t.y+e*n)}return t.y},n.prototype.toContentX=function(t,e){return Math.min(0,Math.max(this.width-t.width,e))},n.prototype.toContentY=function(t,e){return Math.min(0,Math.max(this.height-t.height,e))},n.prototype.isRefitable=function(t){return e.prototype.isRefitable.call(this,t)&&!(t instanceof ov)},n.prototype.onResize=function(t,n,i,r){var o=this.scrollbar;o.lock(),e.prototype.onResize.call(this,t,n,i,r),o.update(),o.unlock(!0)},n.prototype.onContentChange=function(){this.scrollbar.update()},n.prototype.getFocusedChildClippingRect=function(t,e,n,i,r,o,s,a){return a.x=0,a.y=0,a.width=o,a.height=s,a},n.prototype.onChildFocus=function(i){var r=n.WORK_POINT||new t.Point;n.WORK_POINT=r;var o=this.content,s=o.x,a=o.y,u=o.width,l=o.height;r.set(0,0),i.toGlobal(r,r,!1),o.toLocal(r,void 0,r,!1);var h=s+Math.min(u,Math.max(0,r.x)),c=a+Math.min(l,Math.max(0,r.y));r.set(i.width,i.height),i.toGlobal(r,r,!0),o.toLocal(r,void 0,r,!0);var p=s+Math.min(u,Math.max(0,r.x)),f=a+Math.min(l,Math.max(0,r.y)),d=this.width,y=this.height,g=n.WORK_RECTANGLE||new t.Rectangle;n.WORK_RECTANGLE=g,this.getFocusedChildClippingRect(i,s,a,u,l,d,y,g);var v=g.x,_=g.y,m=v,b=_,T=v+g.width,w=_+g.height,E=null;h<m?p<=T&&(E=s+Math.min(m-h,T-p),E=Math.max(d-u,Math.min(0,E))):T<p&&(E=s-Math.min(h-m,p-T),E=Math.max(d-u,Math.min(0,E)));var O=null;c<b?f<=w&&(O=a+Math.min(b-c,w-f),O=Math.max(y-l,Math.min(0,O))):w<f&&(O=a-Math.min(c-b,f-w),O=Math.max(y-l,Math.min(0,O)));var C=o.position;null!=E?null!=O?C.set(E,O):C.x=E:null!=O&&(C.y=O),e.prototype.onChildFocus.call(this,i)},n.prototype.destroy=function(){var t=this._overflowMask;null!=t&&(this._overflowMask=null,t.destroy()),this.mask=null,e.prototype.destroy.call(this)},n}(ao),yv=function(t){function e(e){var n=t.call(this,e)||this;return n.update(),n}return F(e,t),Object.defineProperty(e.prototype,"updater",{get:function(){var t=this._updater;return null==t&&(t=this.newUpdater(this.data,this.content,this._options),this._updater=t),t},enumerable:!1,configurable:!0}),e.prototype.newUpdater=function(t,e,n){return new Xg(t,e,e,null==n?void 0:n.updater)},Object.defineProperty(e.prototype,"data",{get:function(){var t=this._data;return null==t&&(t=this.toData(this._options),this._data=t),t},enumerable:!1,configurable:!0}),e.prototype.toData=function(t){var e=t&&(t.data||t.items),n=null==t?void 0:t.selection;return null==e?n?new iv(this,{selection:n}):new iv(this):Ot(e)?new iv(this,n?{items:e,selection:n}:{items:e}):"each"in e?e:n?(void 0===e.selection&&(e.selection=n),new iv(this,e)):new iv(this,e)},e.prototype.onContentChange=function(){t.prototype.onContentChange.call(this),this.update()},e.prototype.onResize=function(e,n,i,r){var o=this.updater;o.lock(),t.prototype.onResize.call(this,e,n,i,r),o.update(),o.unlock(!0)},Object.defineProperty(e.prototype,"selection",{get:function(){return this.data.selection},enumerable:!1,configurable:!0}),e.prototype.lock=function(){this.updater.lock()},e.prototype.unlock=function(t){this.updater.unlock(t)},e.prototype.update=function(t){this.updater.update(t)},e.prototype.onKeyDown=function(e){return this.updater.moveFocus(e,this,!0,!0),t.prototype.onKeyDown.call(this,e)},e.prototype.getType=function(){return"DList"},e}(dv),gv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newUpdater=function(t,e,n){return new Yg(t,e,e,null==n?void 0:n.updater)},e.prototype.getType=function(){return"DDialogSelectList"},e}(yv),vv=function(t){function e(e){var n=t.call(this)||this;return n._search=null!=e?e:function(t,e){return Promise.resolve([])},n._id=0,n._idCompleted=0,n}return F(e,t),e.prototype.create=function(t){var e=this,n=++this._id,i=this._search;(t.length<=1?i(t[0]):i(t[0],t[1])).then((function(t){e._id===n&&(e._idCompleted=n,e.emit("success",e,t),e.emit("change",e))}),(function(){e._id===n&&(e._idCompleted=n,e.emit("fail",e),e.emit("change",e))})),this.emit("change",this)},e.prototype.isDone=function(){return this._id===this._idCompleted},e}(t.utils.EventEmitter),_v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DInputSearch"},e}(cu),mv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNote"},e}(Na),bv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNoteSmall"},e}(mv),Tv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNoteSmallError"},e}(bv),wv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNoteSmallNoItemsFound"},e}(bv),Ev=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNoteSmallSearching"},e}(bv),Ov=function(t){function e(e){var n,i,r=t.call(this,e)||this;r._value=null;var o=null!==(i=null===(n=null==e?void 0:e.category)||void 0===n?void 0:n.items)&&void 0!==i?i:[];r._categories=o,0<o.length&&r.onCategoriesChange(o);var s=new jy,a=r.search;return a.on("success",(function(t,e){0<e.length?s.hide():s.show(r.noteNoItemsFound),r.onSearched(e)})),a.on("fail",(function(){s.show(r.noteError),r.onSearched([])})),a.on("change",(function(){if(!a.isDone()){var t=r.noteSearching;t&&s.show(t)}})),r}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.inputLayout,this.list,this.buttonDismiss),i},Object.defineProperty(e.prototype,"inputLayout",{get:function(){var t;return null!==(t=this._inputLayout)&&void 0!==t?t:this._inputLayout=this.newInputLayout()},enumerable:!1,configurable:!0}),e.prototype.newInputLayout=function(){return new ja({width:"padding",height:"auto",children:[this.selectCategory,this.input]})},e.prototype.newSpace=function(){return new Js({width:this.toInputMargin(this.theme,this._options)})},Object.defineProperty(e.prototype,"selectCategory",{get:function(){var t;return null!==(t=this._selectCategory)&&void 0!==t?t:this._selectCategory=this.newSelectCategory()},enumerable:!1,configurable:!0}),e.prototype.newSelectCategory=function(){var t=this,e=new gg(this.toSelectCategoryOptions(this.theme,this._options));return e.on("change",(function(e){t.onSelectCategoryChange(e)})),e},e.prototype.toSelectCategoryOptions=function(t,e){var n=(null==e?void 0:e.category)||{};return void 0===n.width&&void 0===n.weight&&(n.width=140),void 0===n.visible&&(n.visible=!1),n},e.prototype.onSelectCategoryChange=function(t){this.search.create([this.input.value,t])},Object.defineProperty(e.prototype,"input",{get:function(){var t;return null!==(t=this._input)&&void 0!==t?t:this._input=this.newInput()},enumerable:!1,configurable:!0}),e.prototype.newInput=function(){var t=this,e=new _v(this.toInputOptions(this.theme,this._options));return e.on("input",(function(e){t.onInputInput(e)})),e},e.prototype.toInputOptions=function(t,e){var n=(null==e?void 0:e.input)||{};return void 0===n.width&&void 0===n.weight&&(n.weight=1),n},e.prototype.toInputMargin=function(t,e){var n,i;return null!==(i=null===(n=null==e?void 0:e.input)||void 0===n?void 0:n.margin)&&void 0!==i?i:t.getInputMargin()},e.prototype.onInputInput=function(t){0<this._categories.length?this.search.create([t,this.selectCategory.value]):this.search.create([t])},Object.defineProperty(e.prototype,"list",{get:function(){var t;return null!==(t=this._list)&&void 0!==t?t:this._list=this.newList()},enumerable:!1,configurable:!0}),e.prototype.newList=function(){var t=this,e=new gv(this.toListOptions(this.theme,this._options));return e.selection.on("change",(function(e){t.onListSelectionChange(e)})),e},e.prototype.onListSelectionChange=function(t){var e=t.first;null!=e&&(this._value=e,this.onOk(e))},e.prototype.toListOptions=function(t,e){var n=(null==e?void 0:e.list)||{};return void 0===n.width&&(n.width="padding"),n},Object.defineProperty(e.prototype,"noteError",{get:function(){var t;return null!==(t=this._noteError)&&void 0!==t?t:this._noteError=this.newNoteError()},enumerable:!1,configurable:!0}),e.prototype.newNoteError=function(){var t,e,n=null===(e=null===(t=this._options)||void 0===t?void 0:t.note)||void 0===e?void 0:e.error;return null!==n?new Tv(this.toNoteOptions(this.list,n)):null},Object.defineProperty(e.prototype,"noteNoItemsFound",{get:function(){var t;return null!==(t=this._noteNoItemsFound)&&void 0!==t?t:this._noteNoItemsFound=this.newNoteNoItemsFound()},enumerable:!1,configurable:!0}),e.prototype.newNoteNoItemsFound=function(){var t,e,n=null===(e=null===(t=this._options)||void 0===t?void 0:t.note)||void 0===e?void 0:e.noItemsFound;return null!==n?new wv(this.toNoteOptions(this.list,n)):null},Object.defineProperty(e.prototype,"noteSearching",{get:function(){var t;return null!==(t=this._noteSearching)&&void 0!==t?t:this._noteSearching=this.newNoteSearching()},enumerable:!1,configurable:!0}),e.prototype.newNoteSearching=function(){var t,e,n=null===(e=null===(t=this._options)||void 0===t?void 0:t.note)||void 0===e?void 0:e.searching;return null!=n?new Ev(this.toNoteOptions(this.list,n)):null},e.prototype.toNoteOptions=function(t,e){return null!=e?(null==e.parent&&(e.parent=t),null==e.visible&&(e.visible=!1),e):{parent:t,visible:!1}},Object.defineProperty(e.prototype,"search",{get:function(){var t;return null!==(t=this._search)&&void 0!==t?t:this._search=this.newSearch()},enumerable:!1,configurable:!0}),e.prototype.newSearch=function(){var t=this._options;if(t){var e=t.controller;if(e){var n=e.search;return"create"in n?n:new vv(n)}}return new vv},Object.defineProperty(e.prototype,"buttonDismiss",{get:function(){var t=this._buttonDismiss;return void 0===t&&(t=this.newButtonDismiss(),this._buttonDismiss=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonDismiss=function(){var t=this,e=this.toButtonDismissOptions(this._options);if(!0===e.enabled){var n=new za(e);return n.on("active",(function(){t._value=null,t.onOk(null)})),n}return null},e.prototype.toButtonDismissOptions=function(t){var e=this.theme;if(null!=t){var n=t.dismiss;if(null!=n){void 0===n.enabled&&(n.enabled=e.isDismissable()),void 0===n.weight&&void 0===n.width&&(n.width="padding");var i=n.text;return void 0===i?n.text={value:e.getDismissLabel()}:void 0===i.value&&(i.value=e.getDismissLabel()),n}}return{width:"padding",enabled:e.isDismissable(),text:{value:e.getDismissLabel()}}},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),e.prototype.onSearched=function(t){this.list.data.items=t},e.prototype.getResolvedValue=function(){return this._value},e.prototype.getType=function(){return"DDialogSelect"},e.prototype.onOpen=function(){t.prototype.onOpen.call(this),this.list.selection.clear(),0<this._categories.length?this.search.create([this.input.value,this.selectCategory.value]):this.search.create([this.input.value])},Object.defineProperty(e.prototype,"categories",{get:function(){return this._categories},set:function(t){this._categories=t,this.onCategoriesChange(t)},enumerable:!1,configurable:!0}),e.prototype.onCategoriesChange=function(t){var e,n,i,r,o,s=this.selectCategory;if(0<t.length){var a=[],u=this.theme,l=null!==(i=null===(n=null===(e=this.options)||void 0===e?void 0:e.category)||void 0===n?void 0:n.dismiss)&&void 0!==i?i:{};(null!==(r=l.enable)&&void 0!==r?r:u.isCategoryDismissable())&&a.push({value:null,text:{value:null!==(o=l.label)&&void 0!==o?o:u.getCategoryDismissLabel()}});for(var h=0,c=t.length;h<c;++h){var p=t[h];a.push({value:p.id,text:{value:p.label}})}s.menu=new fg({fit:!0,items:a}),s.show()}else s.hide()},e.prototype.onOk=function(e){this.emit("select",e,this),t.prototype.onOk.call(this,e)},e.prototype.destroy=function(){var e=this._input;e&&e.destroy();var n=this._noteError;n&&n.destroy();var i=this._noteNoItemsFound;i&&(null==i||i.destroy());var r=this._noteSearching;r&&(null==r||r.destroy());var o=this._list;o&&o.destroy(),t.prototype.destroy.call(this)},e}(Ka),Cv=function(t){return t.value},Sv=function(){},xv=function(t){function e(e){var n,i,r=t.call(this,e)||this;return r._dialogGetter=null!==(n=null==e?void 0:e.getter)&&void 0!==n?n:Cv,r._dialogSetter=null!==(i=null==e?void 0:e.setter)&&void 0!==i?i:Sv,r}return F(e,t),e.prototype.onActivate=function(e){var n,i=this;t.prototype.onActivate.call(this,e);var r=this.dialog,o=null!==(n=this.text.computed)&&void 0!==n?n:null;this._dialogSetter(r,o),r.open(this).then((function(){var t=i._dialogGetter(r);t!==o&&(i.text=t,i.emit("change",t,o,i))}))},Object.defineProperty(e.prototype,"dialog",{get:function(){var t,e=this._dialog;if(null==e){var n=null===(t=this._options)||void 0===t?void 0:t.dialog;e=n&&"open"in n?n:new Ov(n),this._dialog=e}return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t;return null!==(t=this.text.computed)&&void 0!==t?t:null},set:function(t){this.text=t},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DButtonSelect"},e}(za),Dv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onActivate=function(e){var n,i,r=this;t.prototype.onActivate.call(this,e);var o=null!==(i=null===(n=this.text.computed)||void 0===n?void 0:n.getTime())&&void 0!==i?i:Date.now(),s=this.dialog;s.current=new Date(o),s.new=new Date(o),s.open(this).then((function(){r.onValueChange(s.new,s.current)}))},e.prototype.onValueChange=function(t,e){this.text=new Date(t.getTime()),this.emit("change",t,e,this)},e.prototype.getDatetimeMask=function(){var t,e,n=this._datetimeMask;return null==n&&(n=kg.toMask(null===(e=null===(t=this._options)||void 0===t?void 0:t.dialog)||void 0===e?void 0:e.picker),this._datetimeMask=n),n},Object.defineProperty(e.prototype,"dialog",{get:function(){var t,n=this._dialog;if(null==n){var i=null===(t=this._options)||void 0===t?void 0:t.dialog;i?n=this.newDialog(i):(null==e.DIALOG&&(e.DIALOG=this.newDialog({mode:"MENU",sticky:!0})),n=e.DIALOG),this._dialog=n}return n},enumerable:!1,configurable:!0}),e.prototype.newDialog=function(t){return new Lu(t)},Object.defineProperty(e.prototype,"value",{get:function(){var t;return null!==(t=this.text.computed)&&void 0!==t?t:new Date},set:function(t){var e=this.text.computed;void 0!==e&&e.getTime()===t.getTime()||(this.text=t)},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DButtonTime"},e}(za),Iv=function(t){function e(e){var n=t.call(this,e)||this,i=n.state,r=Zy.getCommandController();return i.isDisabled=!r.isUndoable(),r.on("change",(function(){i.isDisabled=!r.isUndoable()})),n}return F(e,t),e.prototype.onActivate=function(e){t.prototype.onActivate.call(this,e),Zy.getCommandController().undo()},e}(za),Av={TOP:0,BOTTOM:1,LEFT:2,RIGHT:3},Rv=function(){function t(t){this._parser=t,this._index=0}return Object.defineProperty(t.prototype,"shape",{get:function(){var t=this._shape;return null==t&&(t=this.newShape(),this._shape=t),t},enumerable:!1,configurable:!0}),t.prototype.newShape=function(){var t,e=this._parser,n=e.bar,i=new pe;return i.points.position=this.newShapePosition(),i.points.style=null!==(t=n.style)&&void 0!==t?t:X.NONE,i.stroke.copy(n.stroke),i.text.copy(e.label),i},t.prototype.newShapePosition=function(){switch(this._parser.position){case Av.LEFT:case Av.RIGHT:return lt.TOP;default:return lt.LEFT}},t.prototype.bind=function(t,e){this._container=t,this._index=e,this.shape.attach(t.container)},t.prototype.unbind=function(){var t=this._shape;null!=t&&t.detach(),this._index=0,this._container=void 0},t.prototype.update=function(){var t=this._container,e=this._index,n=this._shape;if(null!=n&&null!=t){var i=this._parser,r=t.plotArea.getAxisBounds(i.position),o=r.x,s=r.y,a=r.width,u=r.height,l=i.padding*e;n.lock(zt.UPLOADED);var h=n.transform.position,c=n.size;switch(i.position){case Av.TOP:h.set(o+.5*a,s-l),c.set(a,0);break;case Av.BOTTOM:h.set(o+.5*a,s+u+l),c.set(a,0);break;case Av.LEFT:h.set(o-l,s+.5*u),c.set(0,u);break;case Av.RIGHT:h.set(o+a+l,s+.5*u),c.set(0,u)}return n.unlock(zt.UPLOADED,!0),!0}return!1},t.prototype.destroy=function(){var t=this._shape;null!=t&&(this._shape=void 0,t.destroy()),this._index=0,this._container=void 0},t}(),Pv=function(){function t(t){this._axis=t,this._index=0,this._list=[]}return t.prototype.add=function(t){this._list.push(t);var e=this._container,n=this._index;return null!=e&&t.bind(e,n,this._axis),this},t.prototype.get=function(t){var e=this._list;return 0<=t&&t<e.length?e[t]:null},t.prototype.indexOf=function(t){return this._list.indexOf(t)},t.prototype.clear=function(){for(var t=this._list,e=0,n=t.length;e<n;++e)t[e].destroy();return t.length=0,this},t.prototype.size=function(){return this._list.length},t.prototype.bind=function(t,e){this._container=t,this._index=e;for(var n=this._axis,i=this._list,r=0,o=i.length;r<o;++r)i[r].bind(t,e,n)},t.prototype.unbind=function(){for(var t=this._list,e=0,n=t.length;e<n;++e)t[e].unbind();this._index=0,this._container=void 0},t.prototype.update=function(){for(var t=!1,e=this._list,n=0,i=e.length;n<i;++n)e[n].update()&&(t=!0);return t},t.prototype.destroy=function(){for(var t=this._list,e=0,n=t.length;e<n;++e)t[e].destroy();t.length=0,this._index=0,this._container=void 0},t}(),Mv={INSIDE:0,OUTSIDE:1},kv=function(){function t(t,e){var n,i;this.coordinate=null!==(n=null==e?void 0:e.coordinate)&&void 0!==n?n:0,this.position=this.toPosition(t,e),this.tick=this.toTick(t,e),this.label=this.toLabel(t,e),this.padding=null!==(i=null==e?void 0:e.padding)&&void 0!==i?i:t.getPadding(),this.bar=this.toBar(t,e),this.guide=this.toGuide(t,e)}return t.prototype.toPosition=function(t,e){var n=null==e?void 0:e.position;return xt(n)?Av[n]:null!=n?n:t.getPosition()},t.prototype.toGuide=function(t,e){var n,i;return{list:null!==(i=null===(n=null==e?void 0:e.guide)||void 0===n?void 0:n.list)&&void 0!==i?i:[]}},t.prototype.toBar=function(t,e){var n;return{style:null!==(n=null==e?void 0:e.style)&&void 0!==n?n:t.getStyle(),stroke:this.toBarStroke(t,null==e?void 0:e.stroke)}},t.prototype.toTick=function(t,e){var n,i=null==e?void 0:e.tick;return{enable:null!==(n=null==i?void 0:i.enable)&&void 0!==n?n:t.getTickEnable(),major:this.toTickMajor(t,i),minor:this.toTickMinor(t,i)}},t.prototype.toTickMajor=function(t,e){var n,i,r,o,s,a,u,l,h=null==e?void 0:e.major,c=null!==(i=null!==(n=null==h?void 0:h.position)&&void 0!==n?n:null==e?void 0:e.position)&&void 0!==i?i:t.getMajorTickPosition(),p=null==e?void 0:e.style,f=uy.from(null!==(o=null!==(r=null==h?void 0:h.style)&&void 0!==r?r:p)&&void 0!==o?o:t.getMajorTickStyle()),d=null==e?void 0:e.stroke,y=this.toTickMajorStroke(t,null==h?void 0:h.stroke,d),g=null!==(s=null==h?void 0:h.count)&&void 0!==s?s:t.getMajorTickCount();return{count:g,capacity:null!==(a=null==h?void 0:h.capacity)&&void 0!==a?a:t.getMajorTickCapacity(g),step:null!==(u=null==h?void 0:h.step)&&void 0!==u?u:t.getMajorTickStep(),size:null!==(l=null==h?void 0:h.size)&&void 0!==l?l:t.getMajorTickSize(),position:this.toTickPosition(c),style:f,stroke:y,text:this.toTickMajorText(t,null==h?void 0:h.text),formatter:this.toTickMajorFormatter(t,h),gridline:this.toTickMajorGridline(t,null==h?void 0:h.gridline,p,d)}},t.prototype.toTickMajorGridline=function(t,e,n,i){var r,o,s,a=uy.from(null!==(o=null!==(r=null==e?void 0:e.style)&&void 0!==r?r:n)&&void 0!==o?o:t.getMajorTickGridlineStyle());return{enable:null!==(s=null==e?void 0:e.enable)&&void 0!==s?s:t.getMajorTickGridlineEnable(),style:a,stroke:this.toTickMajorGridlineStroke(t,null==e?void 0:e.stroke,i)}},t.prototype.toTickPosition=function(t){var e=this.position;if(t===Mv.OUTSIDE||"OUTSIDE"===t)switch(e){case Av.TOP:return lt.BOTTOM;case Av.BOTTOM:return lt.TOP;case Av.LEFT:return lt.RIGHT;case Av.RIGHT:return lt.LEFT;default:return lt.TOP}else switch(e){case Av.TOP:return lt.TOP;case Av.BOTTOM:return lt.BOTTOM;case Av.LEFT:return lt.LEFT;case Av.RIGHT:return lt.RIGHT;default:return lt.TOP}},t.prototype.toTickMinor=function(t,e){var n,i,r,o,s,a,u,l=null==e?void 0:e.minor,h=null!==(i=null!==(n=null==l?void 0:l.position)&&void 0!==n?n:null==e?void 0:e.position)&&void 0!==i?i:t.getMinorTickPosition(),c=uy.from(null!==(o=null!==(r=null==l?void 0:l.style)&&void 0!==r?r:null==e?void 0:e.style)&&void 0!==o?o:t.getMinorTickStyle());return{count:null!==(s=null==l?void 0:l.count)&&void 0!==s?s:t.getMinorTickCount(),step:null!==(a=null==l?void 0:l.step)&&void 0!==a?a:t.getMinorTickStep(),size:null!==(u=null==l?void 0:l.size)&&void 0!==u?u:t.getMinorTickSize(),position:this.toTickPosition(h),style:c,stroke:this.toTickMinorStroke(t,null==l?void 0:l.stroke,null==e?void 0:e.stroke),text:this.toTickMinorText(t,null==l?void 0:l.text),formatter:this.toTickMinorFormatter(t,l)}},t.prototype.toBarStroke=function(t,e){return this.toStroke(e,void 0,t.getStrokeEnable(),t.getStrokeColor(),t.getStrokeAlpha(),t.getStrokeWidth(),t.getStrokeAlign(),t.getStrokeSide(),t.getStrokeStyle())},t.prototype.toTickMajorStroke=function(t,e,n){return this.toStroke(e,n,t.getMajorTickStrokeEnable(),t.getMajorTickStrokeColor(),t.getMajorTickStrokeAlpha(),t.getMajorTickStrokeWidth(),t.getMajorTickStrokeAlign(),t.getMajorTickStrokeSide(),t.getMajorTickStrokeStyle())},t.prototype.toTickMajorGridlineStroke=function(t,e,n){return this.toStroke(e,n,t.getMajorTickGridlineStrokeEnable(),t.getMajorTickGridlineStrokeColor(),t.getMajorTickGridlineStrokeAlpha(),t.getMajorTickGridlineStrokeWidth(),t.getMajorTickGridlineStrokeAlign(),t.getMajorTickGridlineStrokeSide(),t.getMajorTickGridlineStrokeStyle())},t.prototype.toTickMinorStroke=function(t,e,n){return this.toStroke(e,n,t.getMinorTickStrokeEnable(),t.getMinorTickStrokeColor(),t.getMinorTickStrokeAlpha(),t.getMinorTickStrokeWidth(),t.getMinorTickStrokeAlign(),t.getMinorTickStrokeSide(),t.getMinorTickStrokeStyle())},t.prototype.toStroke=function(t,e,n,i,r,o,s,a,u){var l,h,c,p,f,d,y,g,v,_,m,b,T,w,E,O,C,S,x,D,I,A,R,P,M,k,L,N;return t?e?{enable:null!==(h=null!==(l=t.enable)&&void 0!==l?l:e.enable)&&void 0!==h?h:n,color:null!==(p=null!==(c=t.color)&&void 0!==c?c:e.color)&&void 0!==p?p:i,alpha:null!==(d=null!==(f=t.alpha)&&void 0!==f?f:e.alpha)&&void 0!==d?d:r,width:null!==(g=null!==(y=t.width)&&void 0!==y?y:e.width)&&void 0!==g?g:o,align:null!==(_=null!==(v=t.align)&&void 0!==v?v:e.align)&&void 0!==_?_:s,side:null!==(b=null!==(m=t.side)&&void 0!==m?m:e.side)&&void 0!==b?b:a,style:this.toStrokeStyle(null!==(w=null!==(T=t.style)&&void 0!==T?T:e.style)&&void 0!==w?w:u)}:{enable:null!==(E=t.enable)&&void 0!==E?E:n,color:null!==(O=t.color)&&void 0!==O?O:i,alpha:null!==(C=t.alpha)&&void 0!==C?C:r,width:null!==(S=t.width)&&void 0!==S?S:o,align:null!==(x=t.align)&&void 0!==x?x:s,side:null!==(D=t.side)&&void 0!==D?D:a,style:this.toStrokeStyle(null!==(I=t.style)&&void 0!==I?I:u)}:e?{enable:null!==(A=e.enable)&&void 0!==A?A:n,color:null!==(R=e.color)&&void 0!==R?R:i,alpha:null!==(P=e.alpha)&&void 0!==P?P:r,width:null!==(M=e.width)&&void 0!==M?M:o,align:null!==(k=e.align)&&void 0!==k?k:s,side:null!==(L=e.side)&&void 0!==L?L:a,style:this.toStrokeStyle(null!==(N=e.style)&&void 0!==N?N:u)}:{enable:n,color:i,alpha:r,width:o,align:s,side:a,style:u}},t.prototype.toStrokeStyle=function(t){if(xt(t))return s[t];if(Ot(t)){for(var e=s.NONE,n=0,i=t.length;n<i;++n)e|=s[t[n]];return e}return t},t.prototype.toTickMajorFormatter=function(t,e){var n=null==e?void 0:e.text;if(n){var i=n.format;if(null===i)return;if(null!=i)return kn.create(i);var r=n.formatter;if(r)return{format:r}}var o=t.getMajorTickTextFormat();if(null!=o)return kn.create(o)},t.prototype.toTickMajorText=function(t,e){return{format:(e=e||{}).format,color:this.toTickMajorTextColor(t,e.color),alpha:e.alpha,family:e.family,size:e.size,weight:ai(e.weight,m),align:this.toTickMajorTextAlign(t,e.align),offset:this.toTickMajorTextOffset(t,e.offset),style:ai(e.style,b),outline:this.toTickMajorTextOutline(t,e.outline),spacing:this.toTickMajorTextSpacing(t,e.spacing),direction:this.toTickMajorTextDirection(t,e.direction),padding:this.toTickMajorTextPadding(t,e.padding),clipping:e.clipping}},t.prototype.toTickMajorTextOutline=function(t,e){if(e)return{enable:e.enable,color:e.color,alpha:e.alpha,width:e.width}},t.prototype.toTickMajorTextAlign=function(t,e){var n,i,r=this.position;return{horizontal:null!==(n=null==e?void 0:e.horizontal)&&void 0!==n?n:t.getMajorTickTextAlignHorizontal(r),vertical:null!==(i=null==e?void 0:e.vertical)&&void 0!==i?i:t.getMajorTickTextAlignVertical(r)}},t.prototype.toTickMajorTextOffset=function(t,e){if(e)return{horizontal:e.horizontal,vertical:e.vertical}},t.prototype.toTickMajorTextSpacing=function(t,e){if(e)return{horizontal:e.horizontal,vertical:e.vertical}},t.prototype.toTickMajorTextPadding=function(t,e){var n,i;return{horizontal:null!==(n=null==e?void 0:e.horizontal)&&void 0!==n?n:t.getMajorTickTextPaddingHorizontal(),vertical:null!==(i=null==e?void 0:e.vertical)&&void 0!==i?i:t.getMajorTickTextPaddingVertical()}},t.prototype.toTickMajorTextDirection=function(t,e){return ai(null!=e?e:t.getMajorTickTextDirection(),E)},t.prototype.toTickMajorTextColor=function(t,e){return null!=e?e:t.getMajorTickTextColor()},t.prototype.toTickMinorFormatter=function(t,e){var n=null==e?void 0:e.text;if(n){var i=n.format;if(null===i)return;if(null!=i)return kn.create(i);var r=n.formatter;if(r)return{format:r}}var o=t.getMinorTickTextFormat();if(null!=o)return kn.create(o)},t.prototype.toTickMinorText=function(t,e){return{format:(e=e||{}).format,color:this.toTickMinorTextColor(t,e.color),alpha:e.alpha,family:e.family,size:e.size,weight:ai(e.weight,m),align:this.toTickMinorTextAlign(t,e.align),offset:this.toTickMinorTextOffset(t,e.offset),style:ai(e.style,b),outline:this.toTickMinorTextOutline(t,e.outline),spacing:this.toTickMinorTextSpacing(t,e.spacing),direction:this.toTickMinorTextDirection(t,e.direction),padding:this.toTickMinorTextPadding(t,e.padding),clipping:e.clipping}},t.prototype.toTickMinorTextOutline=function(t,e){if(e)return{enable:e.enable,color:e.color,alpha:e.alpha,width:e.width}},t.prototype.toTickMinorTextAlign=function(t,e){var n,i,r=this.position;return{horizontal:null!==(n=null==e?void 0:e.horizontal)&&void 0!==n?n:t.getMinorTickTextAlignHorizontal(r),vertical:null!==(i=null==e?void 0:e.vertical)&&void 0!==i?i:t.getMinorTickTextAlignVertical(r)}},t.prototype.toTickMinorTextOffset=function(t,e){if(e)return{horizontal:e.horizontal,vertical:e.vertical}},t.prototype.toTickMinorTextSpacing=function(t,e){if(e)return{horizontal:e.horizontal,vertical:e.vertical}},t.prototype.toTickMinorTextPadding=function(t,e){var n,i;return{horizontal:null!==(n=null==e?void 0:e.horizontal)&&void 0!==n?n:t.getMinorTickTextPaddingHorizontal(),vertical:null!==(i=null==e?void 0:e.vertical)&&void 0!==i?i:t.getMinorTickTextPaddingVertical()}},t.prototype.toTickMinorTextDirection=function(t,e){return ai(null!=e?e:t.getMinorTickTextDirection(),E)},t.prototype.toTickMinorTextColor=function(t,e){return null!=e?e:t.getMinorTickTextColor()},t.prototype.toLabel=function(t,e){var n=null==e?void 0:e.label;if(n)return{value:n.value,color:this.toLabelColor(t,n.color),alpha:n.alpha,family:n.family,size:n.size,weight:ai(n.weight,m),align:this.toLabelAlign(t,n.align),offset:this.toLabelOffset(t,n.offset),style:ai(n.style,b),outline:this.toLabelOutline(t,n.outline),spacing:this.toLabelSpacing(t,n.spacing),direction:this.toLabelDirection(t,n.direction),padding:this.toLabelPadding(t,n.padding),clipping:n.clipping}},t.prototype.toLabelOutline=function(t,e){if(e)return{enable:e.enable,color:e.color,alpha:e.alpha,width:e.width}},t.prototype.toLabelAlign=function(t,e){var n,i,r=this.position;return{horizontal:null!==(n=null==e?void 0:e.horizontal)&&void 0!==n?n:t.getLabelAlignHorizontal(r),vertical:null!==(i=null==e?void 0:e.vertical)&&void 0!==i?i:t.getLabelAlignVertical(r)}},t.prototype.toLabelOffset=function(t,e){if(e)return{horizontal:e.horizontal,vertical:e.vertical}},t.prototype.toLabelSpacing=function(t,e){if(e)return{horizontal:e.horizontal,vertical:e.vertical}},t.prototype.toLabelPadding=function(t,e){var n,i;return{horizontal:null!==(n=null==e?void 0:e.horizontal)&&void 0!==n?n:t.getLabelPaddingHorizontal(),vertical:null!==(i=null==e?void 0:e.vertical)&&void 0!==i?i:t.getLabelPaddingVertical()}},t.prototype.toLabelDirection=function(t,e){return ai(null!=e?e:t.getLabelDirection(),E)},t.prototype.toLabelColor=function(t,e){return null!=e?e:t.getLabelColor()},t}(),Lv=function(){function t(t){this._parser=t,this._index=0}return Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapes",{get:function(){var t;return null!==(t=this._shapes)&&void 0!==t?t:this._shapes=this.newShapes()},enumerable:!1,configurable:!0}),t.prototype.newShapes=function(){var t,e=[],n=this._parser.tick,i=n.major,r=i.gridline;if(n.enable&&r.enable)for(var o=i.capacity,s=null!==(t=r.style)&&void 0!==t?t:X.NONE,a=this.newShapePosition(),u=0;u<o;++u){var l=new pe;l.points.position=a,l.points.style=s,l.stroke.copy(r.stroke),e.push(l)}return e},t.prototype.newShapePosition=function(){switch(this._parser.position){case Av.LEFT:case Av.RIGHT:return lt.LEFT;default:return lt.TOP}},t.prototype.bind=function(t,e){this._container=t,this._index=e;for(var n=this.shapes,i=t.container,r=0,o=n.length;r<o;++r)n[r].attach(i)},t.prototype.unbind=function(){var t=this._shapes;if(null!=t)for(var e=0,n=t.length;e<n;++e)t[e].detach();this._index=0,this._container=void 0},t.prototype.destroy=function(){var t=this._shapes;if(null!=t){for(var e=0,n=t.length;e<n;++e)t[e].destroy();t.length=0,this._shapes=void 0}this._index=0,this._container=void 0},t}(),Nv=function(){function t(t){this._parser=t,this._index=0,this._gridline=new Lv(t)}return Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapes",{get:function(){var t;return null!==(t=this._shapes)&&void 0!==t?t:this._shapes=this.newShapes()},enumerable:!1,configurable:!0}),t.prototype.newShapes=function(){var t,e=[],n=this._parser.tick;if(n.enable)for(var i=n.major,r=i.capacity,o=i.size,s=i.position,a=null!==(t=i.style)&&void 0!==t?t:X.NONE,u=0;u<r;++u){var l=new pe;l.points.position=s,l.points.size=o,l.points.style=a,l.stroke.copy(i.stroke),l.text.copy(i.text),l.size.set(0,0),e.push(l)}return e},Object.defineProperty(t.prototype,"gridline",{get:function(){return this._gridline},enumerable:!1,configurable:!0}),t.prototype.bind=function(t,e){this._container=t,this._index=e,this._gridline.bind(t,e);for(var n=this.shapes,i=t.container,r=0,o=n.length;r<o;++r)n[r].attach(i)},t.prototype.unbind=function(){var t=this._shapes;if(null!=t)for(var e=0,n=t.length;e<n;++e)t[e].detach();this._gridline.unbind(),this._index=0,this._container=void 0},t.prototype.destroy=function(){var t=this._shapes;if(null!=t){for(var e=0,n=t.length;e<n;++e)t[e].destroy();t.length=0,this._shapes=void 0}this._gridline.destroy(),this._index=0,this._container=void 0},t}(),Bv=function(){function t(t){this._parser=t,this._index=0}return Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"shapes",{get:function(){var t;return null!==(t=this._shapes)&&void 0!==t?t:this._shapes=this.newShapes()},enumerable:!1,configurable:!0}),t.prototype.newShapes=function(){var t,e=[],n=this._parser.tick;if(n.enable)for(var i=n.minor,r=i.count,o=i.size,s=i.position,a=null!==(t=i.style)&&void 0!==t?t:X.NONE,u=0,l=(n.major.capacity+1)*r;u<l;++u){var h=new pe;h.points.position=s,h.points.size=o,h.points.style=a,h.stroke.copy(i.stroke),h.text.copy(i.text),h.size.set(0,0),e.push(h)}return e},t.prototype.bind=function(t,e){this._container=t,this._index=e;for(var n=this.shapes,i=t.container,r=0,o=n.length;r<o;++r)n[r].attach(i)},t.prototype.unbind=function(){var t=this._shapes;if(null!=t)for(var e=0,n=t.length;e<n;++e)t[e].detach();this._index=0,this._container=void 0},t.prototype.destroy=function(){var t=this._shapes;if(null!=t){for(var e=0,n=t.length;e<n;++e)t[e].destroy();t.length=0,this._shapes=void 0}this._index=0,this._container=void 0},t}(),zv=function(){function t(t,e){this.from=t,this.to=e}return t.prototype.set=function(t,e){return null!=t&&(this.from=t),null!=e&&(this.to=e),this},t.prototype.add=function(t,e){return Nu(t)||(this.from=Nu(this.from)?t:Math.min(this.from,t)),Nu(e)||(this.to=Nu(this.to)?e:Math.max(this.to,e)),this},t.prototype.clear=function(){return this.from=NaN,this.to=NaN,this},t}(),Uv=function(){function t(t,e){this._parser=t,this._index=0,this._major=this.newMajor(t,e),this._minor=this.newMinor(t,e),this._majorTicks=[],this._minorTicks=[],this._work=new zv(0,0)}return Object.defineProperty(t.prototype,"parser",{get:function(){return this._parser},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"major",{get:function(){return this._major},enumerable:!1,configurable:!0}),t.prototype.newMajor=function(t,e){return new Nv(t)},Object.defineProperty(t.prototype,"minor",{get:function(){return this._minor},enumerable:!1,configurable:!0}),t.prototype.newMinor=function(t,e){return new Bv(t)},t.prototype.bind=function(t,e){this._container=t,this._index=e,this._major.bind(t,e),this._minor.bind(t,e)},t.prototype.unbind=function(){this._minor.unbind(),this._major.unbind(),this._index=0,this._container=void 0},t.prototype.update=function(){var t=this._parser,e=this._container,n=this._major.shapes,i=this._minor.shapes;if(t.tick.enable&&null!=e&&n&&i){var r=e.plotArea,o=r.getAxisBounds(t.position),s=o.x,a=o.y,u=o.width,l=o.height,h=r.container.transform.localTransform,c=this._major.gridline.shapes,p=t.padding*this._index,f=this._work,d=void 0;switch(t.position){case Av.TOP:if(d=r.coordinate.x.get(t.coordinate)){var y=(m=this.getDomain(r,d,f)).from,g=m.to,v=(b=this.getDomainVisible(r,d,f)).from,_=b.to;return this.updateX(y,g,v,_,d,n,i,c,a-p,h,a,l)}break;case Av.BOTTOM:var m,b;if(d=r.coordinate.x.get(t.coordinate))return y=(m=this.getDomain(r,d,f)).from,g=m.to,v=(b=this.getDomainVisible(r,d,f)).from,_=b.to,this.updateX(y,g,v,_,d,n,i,c,a+l+p,h,a,l);break;case Av.LEFT:if(d=r.coordinate.y.get(t.coordinate)){var T=(C=this.getRange(r,d,f)).from,w=C.to,E=(S=this.getRangeVisible(r,d,f)).from,O=S.to;return this.updateY(T,w,E,O,d,n,i,c,s-p,h,s,u)}break;case Av.RIGHT:var C,S;if(d=r.coordinate.y.get(t.coordinate))return T=(C=this.getRange(r,d,f)).from,w=C.to,E=(S=this.getRangeVisible(r,d,f)).from,O=S.to,this.updateY(T,w,E,O,d,n,i,c,s+u+p,h,s,u)}}return!1},t.prototype.getDomain=function(t,e,n){var i=t.getContainerBounds(),r=e.transform;return n.set(e.unmap(r.unmap(i.x)),e.unmap(r.unmap(i.x+i.width)))},t.prototype.getDomainVisible=function(t,e,n){return n},t.prototype.getRange=function(t,e,n){var i=t.getContainerBounds(),r=e.transform;return n.set(e.unmap(r.unmap(i.y)),e.unmap(r.unmap(i.y+i.height)))},t.prototype.getRangeVisible=function(t,e,n){return n},t.prototype.updateX=function(t,e,n,i,r,o,s,a,u,l,h,c){var p=this._parser.tick,f=p.major,d=f.count,y=f.capacity,g=f.step,v=f.formatter,_=p.minor,m=_.count,b=(y+1)*m,T=_.step,w=_.formatter,E=this._majorTicks,O=this._minorTicks;this.newTicks(r,t,e,n,i,d,y,g,m,b,T,E,O);for(var C=l.a,S=l.tx,x=0;x<y;++x){var D=o[x],I=3*x,A=E[I+0];if(isNaN(A))this.hideMajor(D),x<a.length&&this.hideMajorGridline(a[x]);else{var R=C*E[I+1]+S,P=E[I+2];this.showMajor(D,R,u,null==v?void 0:v.format(A,P)),x<a.length&&this.showMajorGridline(a[x],A,R,h+.5*c,0,c)}}for(x=0;x<b;++x){var M=s[x],k=3*x,L=O[k+0];if(isNaN(L))this.hideMinor(M);else{var N=C*O[k+1]+S,B=O[k+2];this.showMinor(M,N,u,null==w?void 0:w.format(L,B))}}return!0},t.prototype.updateY=function(t,e,n,i,r,o,s,a,u,l,h,c){var p=this._parser.tick,f=p.major,d=f.count,y=f.capacity,g=f.step,v=f.formatter,_=p.minor,m=_.count,b=(y+1)*m,T=_.step,w=_.formatter,E=this._majorTicks,O=this._minorTicks;this.newTicks(r,t,e,n,i,d,y,g,m,b,T,E,O);for(var C=l.d,S=l.ty,x=0;x<y;++x){var D=o[x],I=3*x,A=E[I+0];if(isNaN(A))this.hideMajor(D),x<a.length&&this.hideMajorGridline(a[x]);else{var R=C*E[I+1]+S,P=E[I+2];this.showMajor(D,u,R,null==v?void 0:v.format(A,P)),x<a.length&&this.showMajorGridline(a[x],A,h+.5*c,R,c,0)}}for(x=0;x<b;++x){var M=s[x],k=3*x,L=O[k+0];if(isNaN(L))this.hideMinor(M);else{var N=C*O[k+1]+S,B=O[k+2];this.showMinor(M,u,N,null==w?void 0:w.format(L,B))}}return!0},t.prototype.showMajor=function(t,e,n,i){t.lock(zt.UPLOADED),t.visible=!0,t.transform.position.set(e,n),t.text.value=null!=i?i:"",t.unlock(zt.UPLOADED,!0)},t.prototype.showMajorGridline=function(t,e,n,i,r,o){t.lock(zt.UPLOADED),t.visible=!0,t.transform.position.set(n,i),t.size.set(r,o),t.unlock(zt.UPLOADED,!0)},t.prototype.hideMajor=function(t){t.visible=!1},t.prototype.hideMajorGridline=function(t){t.visible=!1},t.prototype.showMinor=function(t,e,n,i){t.lock(zt.UPLOADED),t.visible=!0,t.transform.position.set(e,n),t.text.value=null!=i?i:"",t.unlock(zt.UPLOADED,!0)},t.prototype.hideMinor=function(t){t.visible=!1},t.prototype.newTicks=function(t,e,n,i,r,o,s,a,u,l,h,c,p){t.ticks(e,n,i,r,o,s,a,u,l,h,c,p)},t.prototype.destroy=function(){this._major.destroy(),this._minor.destroy(),this._index=0,this._container=void 0},t}(),jv=function(){function t(t){var e=this.toTheme(t);this._theme=e;var n=this.newParser(e,t);this._parser=n,this._index=0,this._bar=this.newBar(n,e,t),this._tick=this.newTick(n,e,t),this._guide=this.newGuide(n,e,t)}return t.prototype.newParser=function(t,e){return new kv(t,e)},Object.defineProperty(t.prototype,"position",{get:function(){return this._parser.position},set:function(t){this._parser.position=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"coordinate",{get:function(){return this._parser.coordinate},set:function(t){this._parser.coordinate=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"padding",{get:function(){return this._parser.padding},set:function(t){this._parser.padding=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bar",{get:function(){return this._bar},enumerable:!1,configurable:!0}),t.prototype.newBar=function(t,e,n){return new Rv(t)},Object.defineProperty(t.prototype,"tick",{get:function(){return this._tick},enumerable:!1,configurable:!0}),t.prototype.newTick=function(t,e,n){return new Uv(t)},Object.defineProperty(t.prototype,"guide",{get:function(){return this._guide},enumerable:!1,configurable:!0}),t.prototype.newGuide=function(t,e,n){for(var i=new Pv(this),r=t.guide.list,o=0,s=r.length;o<s;++o)i.add(r[o]);return i},t.prototype.bind=function(t,e){this._container=t,this._index=e,this._bar.bind(t,e),this._tick.bind(t,e),this._guide.bind(t,e)},t.prototype.unbind=function(){this._guide.unbind(),this._tick.unbind(),this._bar.unbind(),this._index=0,this._container=void 0},t.prototype.update=function(){var t=this._bar.update(),e=this._tick.update(),n=this._guide.update();if(t||e||n){var i=this._container;i&&ft.update(i.plotArea)}},t.prototype.onRender=function(){this._bar.update(),this._tick.update(),this._guide.update()},t.prototype.destroy=function(){this._bar.destroy(),this._tick.destroy(),this._guide.destroy(),this._container=void 0},t.prototype.toTheme=function(t){var e;return null!==(e=null==t?void 0:t.theme)&&void 0!==e?e:this.getThemeDefault()},t.prototype.getThemeDefault=function(){return it.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartAxisBase"},t}(),Fv=function(){function t(t,e,n){this._plotArea=t,this._container=e,this._list=new Map}return Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this._plotArea},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var e=this._list,n=e.get(t.position);null==n&&(n=[],e.set(t.position,n)),n.push(t),t.bind(this,n.length-1)},t.prototype.get=function(t,e){var n=this._list.get(ai(t,Av));return n&&0<=e&&e<n.length?n[e]:null},t.prototype.indexOf=function(t){var e=this._list.get(t.position);return e?e.indexOf(t):-1},t.prototype.clear=function(t){var e=this._list.get(ai(t,Av));if(e){for(var n=0,i=e.length;n<i;++n)e[n].destroy();e.length=0}return this},t.prototype.size=function(t){var e=this._list.get(ai(t,Av));return e?e.length:0},t.prototype.update=function(){this._list.forEach((function(t){for(var e=0,n=t.length;e<n;++e)t[e].update()}))},t.prototype.onRender=function(){this._list.forEach((function(t){for(var e=0,n=t.length;e<n;++e)t[e].onRender()}))},t.prototype.destroy=function(){this._list.forEach((function(t){for(var e=0,n=t.length;e<n;++e)t[e].destroy();t.length=0}))},t}(),Hv=function(){function t(t){this._options=t}return Object.defineProperty(t.prototype,"bar",{get:function(){var t=this._bar;return void 0===t&&(t=this.newBar(),this._bar=t),t},enumerable:!1,configurable:!0}),t.prototype.newBar=function(){var t,e,n=null!==(e=null===(t=this._options)||void 0===t?void 0:t.bar)&&void 0!==e?e:{};if(!1!==n.enable){var i=new pe;return i.stroke.copy(this.toStrokeOptions(n.stroke,s.DASHED)),i.text.copy(this.toTextOptions(n.text)),i}return null},t.prototype.toStrokeOptions=function(t,e){var n;return{enable:(t=t||{}).enable,color:t.color,alpha:t.alpha,width:t.width,align:t.align,side:ai(t.side,Z),style:ai(null!==(n=t.style)&&void 0!==n?n:e,s)}},t.prototype.toTextOptions=function(t){return{value:(t=t||{}).value,color:t.color,alpha:t.alpha,family:t.family,size:t.size,weight:ai(t.weight,m),align:this.toTextAlignOptions(t.align),offset:t.offset,style:ai(t.style,b),outline:t.outline,spacing:t.spacing,direction:ai(t.direction,E),padding:t.padding,clipping:t.clipping,fitting:t.fitting}},t.prototype.toTextAlignOptions=function(t){return{horizontal:ai(null==(t=t||{})?void 0:t.horizontal,T),vertical:ai(null==t?void 0:t.vertical,w)}},t.prototype.toBarPosition=function(t){switch(t.position){case Av.LEFT:case Av.RIGHT:return lt.LEFT;default:return lt.TOP}},Object.defineProperty(t.prototype,"label",{get:function(){var t=this._label;return void 0===t&&(t=this.newLabel(),this._label=t),t},enumerable:!1,configurable:!0}),t.prototype.newLabel=function(){var t,e,n,i,r=null!==(e=null===(t=this._options)||void 0===t?void 0:t.label)&&void 0!==e?e:{};if(!0===r.enable){var o=new Yl;return o.stroke.copy(this.toStrokeOptions(r.stroke)),o.fill.copy(r.fill),o.text.copy(this.toTextOptions(r.text)),o.size.set(null!==(n=r.width)&&void 0!==n?n:50,null!==(i=r.height)&&void 0!==i?i:30),o}return null},Object.defineProperty(t.prototype,"labelMargin",{get:function(){var t=this._labelMargin;return null==t&&(t=this.newLabelMargin(),this._labelMargin=t),t},enumerable:!1,configurable:!0}),t.prototype.newLabelMargin=function(){var t=this._options;if(null!=t){var e=t.label;if(null!=e){var n=e.margin;if(null!=n)return n}}return 10},Object.defineProperty(t.prototype,"tick",{get:function(){var t=this._tick;return void 0===t&&(t=this.newTick(),this._tick=t),t},enumerable:!1,configurable:!0}),t.prototype.newTick=function(){var t,e,n,i=null!==(e=null===(t=this._options)||void 0===t?void 0:t.tick)&&void 0!==e?e:{};if(!0===i.enable){var r=new pe;r.stroke.copy(this.toStrokeOptions(i.stroke)),r.text.copy(this.toTextOptions(i.text));var o=null!==(n=i.size)&&void 0!==n?n:5;return r.size.set(o,o),r}return null},Object.defineProperty(t.prototype,"tickMargin",{get:function(){var t=this._tickMargin;return null==t&&(t=this.newTickMargin(),this._tickMargin=t),t},enumerable:!1,configurable:!0}),t.prototype.newTickMargin=function(){var t=this._options;if(null!=t){var e=t.tick;if(null!=e){var n=e.margin;if(null!=n)return n}}return 0},t.prototype.toTickPosition=function(t){switch(t.position){case Av.LEFT:case Av.RIGHT:return lt.LEFT;default:return lt.TOP}},t.prototype.bind=function(t,e,n){var i=this.bar;null!=i&&(i.points.position=this.toBarPosition(n),i.attach(t.container));var r=this.label;null!=r&&r.attach(t.container);var o=this.tick;null!=o&&(o.points.position=this.toTickPosition(n),o.attach(t.container))},t.prototype.unbind=function(){var t=this._bar;null!=t&&t.detach();var e=this._label;null!=e&&e.detach();var n=this._tick;null!=n&&n.detach()},t.prototype.update=function(t,e,n,i,r,o,s){var a=this._bar;if(null!=a){switch(a.lock(zt.UPLOADED),t){case Av.TOP:case Av.BOTTOM:a.transform.position.set(e,n),a.size.set(0,o),a.visible=i;break;case Av.LEFT:case Av.RIGHT:a.transform.position.set(e,n),a.size.set(r,0),a.visible=i}a.unlock(zt.UPLOADED,!0)}var u=this._label;if(null!=u){var l=this.labelMargin,h=s+.5*(f=u.size).x+l,c=s+.5*f.y+l;switch(u.lock(zt.UPLOADED),t){case Av.TOP:u.transform.position.set(e,-c),u.visible=i;break;case Av.BOTTOM:u.transform.position.set(e,o+c),u.visible=i;break;case Av.LEFT:u.transform.position.set(-h,n),u.visible=i;break;case Av.RIGHT:u.transform.position.set(r+h,n),u.visible=i}u.unlock(zt.UPLOADED,!0)}var p=this._tick;if(null!=p){var f;switch(l=this.tickMargin,h=s+.5*(f=p.size).x+l,c=s+.5*f.y+l,p.lock(zt.UPLOADED),t){case Av.TOP:p.transform.position.set(e,-c),p.visible=i;break;case Av.BOTTOM:p.transform.position.set(e,o+c),p.visible=i;break;case Av.LEFT:p.transform.position.set(-h,n),p.visible=i;break;case Av.RIGHT:p.transform.position.set(r+h,n),p.visible=i}p.unlock(zt.UPLOADED,!0)}return!0},t.prototype.destroy=function(){var t=this._bar;null!=t&&t.destroy();var e=this._label;null!=e&&e.destroy();var n=this._tick;null!=n&&n.destroy()},t}(),Gv=function(){function e(t){var e,n;this._options=t,this._index=0,null!=t?(this._position=null!==(e=t.position)&&void 0!==e?e:0,this._fixed=null!==(n=t.fixed)&&void 0!==n&&n):(this._position=0,this._fixed=!1),this._isShown=!0}return Object.defineProperty(e.prototype,"shape",{get:function(){var t=this._shape;return null==t&&(t=this.newShape(),this._shape=t),t},enumerable:!1,configurable:!0}),e.prototype.newShape=function(){return new Hv(this._options)},Object.defineProperty(e.prototype,"position",{get:function(){return this._position},set:function(t){this._position=t},enumerable:!1,configurable:!0}),e.prototype.show=function(){return this._isShown=!0,this},e.prototype.isShown=function(){return this._isShown},e.prototype.hide=function(){return this._isShown=!1,this},e.prototype.isHidden=function(){return!this._isShown},e.prototype.bind=function(t,e,n){this._container=t,this._index=e,this._axis=n,this.shape.bind(t,e,n)},e.prototype.unbind=function(){var t=this._shape;null!=t&&t.unbind(),this._axis=void 0,this._index=0,this._container=void 0},e.prototype.update=function(){var t=this._container,e=this._index,n=this._shape,i=this._axis;if(null!=n&&null!=t&&null!=i){var r=t.plotArea,o=r.getAxisBounds(i.position),s=o.x,a=o.y,u=o.width,l=o.height,h=i.padding*e;switch(i.position){case Av.TOP:case Av.BOTTOM:var c=this.getPositionX(i,r,s);n.update(i.position,c,a+.5*l,this._isShown&&s<=c&&c<=s+u,u,l,h);break;case Av.LEFT:case Av.RIGHT:var p=this.getPositionY(i,r,a);n.update(i.position,s+.5*u,p,this._isShown&&a<=p&&p<=a+l,u,l,h)}return!0}return!1},e.prototype.getPositionX=function(n,i,r){var o,s;if(this._fixed){var a=null!==(o=e.WORK_REGION)&&void 0!==o?o:e.WORK_REGION=new zv(0,0);return i.getPixelDomain(a),a.from+this._position*(a.to-a.from)}var u=i.coordinate.x.get(n.coordinate);return u?((a=null!==(s=e.WORK_POINT)&&void 0!==s?s:e.WORK_POINT=new t.Point).set(u.transform.map(u.map(this._position)),0),i.container.transform.localTransform.apply(a,a),a.x):r-100},e.prototype.getPositionY=function(n,i,r){var o,s;if(this._fixed){var a=null!==(o=e.WORK_REGION)&&void 0!==o?o:e.WORK_REGION=new zv(0,0);return i.getPixelRange(a),a.to+(1-this._position)*(a.from-a.to)}var u=i.coordinate.y.get(n.coordinate);return u?((a=null!==(s=e.WORK_POINT)&&void 0!==s?s:e.WORK_POINT=new t.Point).set(0,u.transform.map(u.map(this._position))),i.container.transform.localTransform.apply(a,a),a.y):r-100},e.prototype.destroy=function(){var t=this._shape;null!=t&&t.destroy(),this._index=0,this._container=void 0},e}(),Vv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DChartAxisX"},e}(jv),Wv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DChartAxisXDatetime"},e}(Vv),Kv=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DChartAxisY"},e}(jv),Xv=[1095651,16667680,15778578,1858929],Yv=[Xv[0],ve.brighten(Xv[0],.4),Xv[1],ve.brighten(Xv[1],.4),Xv[2],ve.brighten(Xv[2],.4),Xv[3],ve.brighten(Xv[3],.4)],qv=function(t){return Yv[t%Yv.length]},Zv={X:0,Y:1},Jv=function(){function t(t){this._theme=this.toTheme(t),this._id=0,this._isTranslationEnabled=null==t?void 0:t.translation,this._translate=0,this._isScalingEnabled=null==t?void 0:t.scaling,this._scale=1,this._itranslate=0,this._iscale=1}return Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"translate",{get:function(){return this._translate},set:function(t){this.set(t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.bind=function(t,e){this.set(0,e===Zv.X?1:-1)},t.prototype.unbind=function(){},t.prototype.set=function(t,e){var n=!1;null!=t&&!1!==this._isTranslationEnabled&&this._translate!==t&&(n=!0,this._translate=t),null!=e&&!1!==this._isScalingEnabled&&this._scale!==e&&(n=!0,this._scale=e),n&&(this._id+=1,this._iscale=this._theme.isZero(this._scale)?0:1/this._scale,this._itranslate=-this._translate*this._iscale)},t.prototype.blend=function(t,e){var n=1-t,i=e.newTranslate*t+e.oldTranslate*n,r=e.newScale*t+e.oldScale*n;this.set(i,r)},t.prototype.map=function(t){return this._translate+this._scale*t},t.prototype.mapAll=function(t,e,n,i,r){for(var o=this._translate,s=this._scale,a=e+r;a<n;a+=i)t[a]=o+s*t[a]},t.prototype.unmap=function(t){return this._itranslate+this._iscale*t},t.prototype.unmapAll=function(t,e,n,i,r){for(var o=this._itranslate,s=this._iscale,a=e+r;a<n;a+=i)t[a]=o+s*t[a]},t.prototype.toTheme=function(t){return t&&t.theme||this.getThemeDefault()},t.prototype.getThemeDefault=function(){return it.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinateTransform"},t}(),Qv=function(){function t(){this.oldTranslate=0,this.oldScale=1,this.newTranslate=0,this.newScale=1}return t.prototype.set=function(t,e){null!=t&&(this.newTranslate=t),null!=e&&(this.newScale=e)},t}(),$v=function(){function t(t){this._id=0,this._direction=Zv.X,this._theme=this.toTheme(t),this._transform=this.newTransform(null==t?void 0:t.transform),this._tick=this.newTick(null==t?void 0:t.tick),this._work=this.newRegion(),this._mark=this.newMark(),this._from=null==t?void 0:t.from,this._to=null==t?void 0:t.to}return t.prototype.newTransform=function(t){return new Jv(t)},t.prototype.newRegion=function(){return new zv(NaN,NaN)},t.prototype.newMark=function(){return new Qv},Object.defineProperty(t.prototype,"from",{get:function(){return this._from},set:function(t){this._from=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this._to},set:function(t){this._to=t},enumerable:!1,configurable:!0}),t.prototype.bind=function(t,e){this._container=t,this._direction=e,this._transform.bind(t,e)},t.prototype.unbind=function(){this._container=void 0,this._transform.unbind()},t.prototype.fit=function(t,e){this.doFit(t,e,this._transform)},t.prototype.mark=function(t,e){var n=this._mark,i=this._transform;n.oldTranslate=i.translate,n.oldScale=i.scale,this.doFit(t,e,n)},t.prototype.blend=function(t){this._transform.blend(t,this._mark)},t.prototype.doFit=function(t,e,n){var i=this._container;if(i){var r=i.container.plotArea,o=this._work;switch(this._direction){case Zv.X:this.getPixelDomain(r,o),this.doFit_(o.from,o.to,this.toFitDomain(t,e,r,o),n);break;case Zv.Y:this.getPixelRange(r,o),this.doFit_(o.from,o.to,this.toFitRange(t,e,r,o),n)}}},t.prototype.getPixelDomain=function(t,e){return t.getPixelDomain(e)},t.prototype.getPixelRange=function(t,e){return t.getPixelRange(e)},t.prototype.toFitDomain=function(t,e,n,i){return null==t&&(t=this._from),null==e&&(e=this._to),null!=t&&null!=e||n.series.getDomain(this,i),i.set(t,e),i},t.prototype.toFitRange=function(t,e,n,i){return null==t&&(t=this._from),null==e&&(e=this._to),null!=t&&null!=e||n.series.getRange(this,i),i.set(t,e),i},t.prototype.doFit_=function(t,e,n,i){var r=n.from,o=n.to;if(!Nu(r)&&!Nu(o)){var s,a=this.map(r),u=this.map(o)-a,l=t-a*(s=this._theme.isZero(u)?e<t?-1:1:(e-t)/u);i.set(l,s)}},Object.defineProperty(t.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"transform",{get:function(){return this._transform},enumerable:!1,configurable:!0}),t.prototype.map=function(t){return t},t.prototype.mapAll=function(t,e,n,i,r){},t.prototype.unmap=function(t){return t},t.prototype.unmapAll=function(t,e,n,i,r){},t.prototype.ticks=function(t,e,n,i,r,o,s,a,u,l,h,c){this._tick.calculate(t,e,n,i,r,o,s,a,u,l,h,c,this)},t.prototype.toTheme=function(t){var e;return null!==(e=null==t?void 0:t.theme)&&void 0!==e?e:this.getThemeDefault()},t.prototype.getThemeDefault=function(){return it.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinate"},t}(),t_=function(){function t(t,e){this._container=t,this._direction=e,this._list=[]}return Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){var n=this._list;return null==e?n.push(t):0<=e&&e<n.length?n.splice(e,0,t):n.push(t),t.bind(this,this._direction),this},t.prototype.get=function(t){var e=this._list;return 0<=t&&t<e.length?e[t]:null},t.prototype.indexOf=function(t){return this._list.indexOf(t)},t.prototype.remove=function(t){var e=this._list;if(St(t)){if(0<=(i=t)&&i<e.length){var n=e.splice(i,1)[0];return n.unbind(),n}}else{var i,r=t;if(0<=(i=e.indexOf(r)))return e.splice(i,1),r.unbind(),r}return null},t.prototype.clear=function(){for(var t=this._list,e=0,n=t.length;e<n;++e)t[e].unbind();return t.length=0,this},t.prototype.destroy=function(){return this.clear()},t.prototype.size=function(){return this._list.length},t.prototype.fit=function(t,e){for(var n=this._list,i=0,r=n.length;i<r;++i)n[i].fit(t,e);return this},t.prototype.mark=function(t,e){for(var n=this._list,i=0,r=n.length;i<r;++i)n[i].mark(t,e);return this},t.prototype.blend=function(t){for(var e=this._list,n=0,i=e.length;n<i;++n)e[n].blend(t);return this},t}(),e_=function(){function t(t,e){this._plotArea=t;var n=new t_(this,Zv.X);this._x=n;var i=new t_(this,Zv.Y);if(this._y=i,e){var r=e.x;if(r)if(Ot(r))for(var o=0,s=r.length;o<s;++o)n.add(r[o]);else n.add(r);var a=e.y;if(a)if(Ot(a))for(o=0,s=a.length;o<s;++o)i.add(a[o]);else i.add(a)}}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this._plotArea},enumerable:!1,configurable:!0}),t.prototype.fit=function(t,e,n,i){return this._x.fit(t,e),this._y.fit(n,i),this},t.prototype.mark=function(t,e,n,i){return this._x.mark(t,e),this._y.mark(n,i),this},t.prototype.blend=function(t){return this._x.blend(t),this._y.blend(t),this},t}(),n_=function(){function t(t){this._theme=this.toTheme(t)}return t.prototype.toMajorStep=function(t,e,n,i){return null==i?0<n?this._theme.toStep(t,e,n):-1:St(i)?i:i(t,e,n)},t.prototype.toMinorStep=function(t,e,n){return null==n?0<=t?this.calcStepMinor(t,e):-1:St(n)?n:n(t,e)},t.prototype.calcStepMinor=function(t,e){return t/(e+1)},t.prototype.calcTickMinorPositions=function(t,e,n,i,r,o,s){for(var a=0;a<e;a+=1){var u=n+(a+1)*t;i<=u&&u<=r&&(s[o++]=u)}},t.prototype.calculate=function(t,e,n,i,r,o,s,a,u,l,h,c,p){if(!(r<=0)){var f=p.transform,d=Math.min(t,e),y=Math.max(t,e),g=Math.min(n,i),v=Math.max(n,i),_=p.map(g),m=p.map(v),b=Math.min(_,m),T=Math.max(_,m),w=p.map(d),E=p.map(y),O=Math.min(w,E),C=Math.max(w,E),S=Math.max(b,O),x=Math.min(T,C),D=0,I=0,A=this.toMajorStep(w,E,r,s);if(A<=0)S<=w&&w<=x&&(h[0]=d,h[1]=f.map(w),h[2]=0,D+=1);else for(var R=Math.floor(w/A)-1,P=Math.ceil(E/A)+1,M=this.toMinorStep(A,a,l),k=R;k<=P;++k){var L=k*A;D<o&&S<=L&&L<=x&&(h[0+(z=3*D)]=p.unmap(L),h[z+1]=f.map(L),h[z+2]=A,D+=1);for(var N=0;N<a;N+=1)if(I<u){var B=L+(N+1)*M;S<=B&&B<=x&&(c[0+(U=3*I)]=p.unmap(B),c[U+1]=f.map(B),c[U+2]=M,I+=1)}}for(k=D;k<o;++k){var z;h[0+(z=3*k)]=NaN,h[z+1]=NaN,h[z+2]=NaN}for(k=I;k<u;++k){var U;c[0+(U=3*k)]=NaN,c[U+1]=NaN,c[U+2]=NaN}}},t.prototype.toTheme=function(t){var e;return null!==(e=null==t?void 0:t.theme)&&void 0!==e?e:this.getThemeDefault()},t.prototype.getThemeDefault=function(){return it.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinateTick"},t}(),i_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newTick=function(t){return new n_(t)},e}($v),r_=function(){function t(t){this._theme=this.toTheme(t)}return t.prototype.toMajorStep=function(t,e,n,i){return null==i?0<n?this._theme.toStep(t,e,n):-1:St(i)?i:i(t,e,n)},t.prototype.toMinorStep=function(t,e,n){return null==n?0<=t?this.calcStepMinor(t,e):-1:St(n)?n:n(t,e)},t.prototype.calcStepMinor=function(t,e){return t/(e+1)},t.prototype.calcTickMinorPositions=function(t,e,n,i,r,o,s){for(var a=0;a<e;a+=1){var u=n+(a+1)*t;i<=u&&u<=r&&(s[o++]=u)}},t.prototype.calculate=function(t,e,n,i,r,o,s,a,u,l,h,c,p){if(!(r<=0)){var f=p.transform,d=Math.min(t,e),y=Math.max(t,e),g=Math.min(n,i),v=Math.max(n,i),_=p.map(g),m=p.map(v),b=Math.min(_,m),T=Math.max(_,m),w=p.map(d),E=p.map(y),O=Math.min(w,E),C=Math.max(w,E),S=Math.max(b,O),x=Math.min(T,C),D=0,I=0,A=this.toMajorStep(w,E,r,s);if(A<=0)S<=w&&w<=x&&(h[0]=d,h[1]=f.map(w),h[2]=0,D+=1);else for(var R=Math.floor(w/A)-1,P=Math.ceil(E/A)+1,M=this.toMinorStep(A,a,l),k=R;k<=P;++k){var L=k*A;D<o&&S<=L&&L<=x&&(h[0+(z=3*D)]=p.unmap(L),h[z+1]=f.map(L),h[z+2]=p.unmap(L-1),D+=1);for(var N=0;N<a;N+=1)if(I<u){var B=L+(N+1)*M;S<=B&&B<=x&&(c[0+(U=3*I)]=p.unmap(B),c[U+1]=f.map(B),c[U+2]=p.unmap(B-1),I+=1)}}for(k=D;k<o;++k){var z;h[0+(z=3*k)]=NaN,h[z+1]=NaN,h[z+2]=NaN}for(k=I;k<u;++k){var U;c[0+(U=3*k)]=NaN,c[U+1]=NaN,c[U+2]=NaN}}},t.prototype.toTheme=function(t){var e;return null!==(e=null==t?void 0:t.theme)&&void 0!==e?e:this.getThemeDefault()},t.prototype.getThemeDefault=function(){return it.getInstance().get(this.getType())},t.prototype.getType=function(){return"DChartCoordinateTick"},t}(),o_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newTick=function(t){return new r_(t)},e.prototype.map=function(t){return Math.log(Math.max(0,t))/Math.LN10},e.prototype.mapAll=function(t,e,n,i,r){for(var o=1/Math.LN10,s=e+r;s<n;s+=i){var a=t[s];t[s]=Math.log(Math.max(0,a))*o}},e.prototype.unmap=function(t){return Math.pow(10,t)},e.prototype.unmapAll=function(t,e,n,i,r){for(var o=e+r;o<n;o+=i)t[o]=Math.pow(10,t[o])},e}($v),s_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DChartLegendItem"},e}(ao),a_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DChartLegend"},e}(ao),u_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DChartOverview"},e}(ao),l_=function(e){function n(n,i){var r=e.call(this,i)||this;return r._isContainerBoundsDirty=!0,r._containerBounds=new t.Rectangle,r._workPoint=new t.Point,r._pixelBounds=new t.Rectangle,r._chart=n,r._blendStartTime=0,r._blendDuration=1e3,r._blendTimeout=null,r._onBlendBound=function(){r.onBlend()},r._isViewDirty=!0,r._view=r.newView(i),r}return F(n,e),n.prototype.onResize=function(t,n,i,r){this._isViewDirty=!0,this._isContainerBoundsDirty=!0,e.prototype.onResize.call(this,t,n,i,r)},Object.defineProperty(n.prototype,"chart",{get:function(){return this._chart},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"view",{get:function(){return this._view},enumerable:!1,configurable:!0}),n.prototype.onWheel=function(t,n,i){var r=this._view.onWheel(t,n,i),o=e.prototype.onWheel.call(this,t,n,i);return r||o},n.prototype.onDblClick=function(t,n){var i=this._view.onDblClick(t,n),r=e.prototype.onDblClick.call(this,t,n);return i||r},n.prototype.onDown=function(t){this._view.onDown(t),e.prototype.onDown.call(this,t)},n.prototype.render=function(t){this._isViewDirty&&(this._isViewDirty=!1,this.onViewDirty()),e.prototype.render.call(this,t)},n.prototype.getPixelDomain=function(t){var e=this.padding;return t.set(e.getLeft(),this.width-e.getRight())},n.prototype.getPixelRange=function(t){var e=this.padding;return t.set(this.height-e.getBottom(),e.getTop())},n.prototype.getPixelBounds=function(){var t=this._pixelBounds;return t.x=0,t.y=0,t.width=this.width,t.height=this.height,t},n.prototype.getAxisBounds=function(t){return this.getPixelBounds()},n.prototype.getSelectionBoundsX=function(){return this.getPixelBounds()},n.prototype.getSelectionBoundsY=function(){return this.getPixelBounds()},n.prototype.getContainerBounds=function(){var t=this._containerBounds;if(this._isContainerBoundsDirty){this._isContainerBoundsDirty=!1;var e=this.container;e.updateTransform();var n=e.transform.localTransform,i=this._workPoint;i.set(0,0),n.applyInverse(i,i),t.x=i.x,t.y=i.y,i.set(this.width,this.height),n.applyInverse(i,i),t.width=i.x-t.x,t.height=i.y-t.y}return t},n.prototype.getType=function(){return"DChartPlotArea"},n}(ao),h_=function(e){function n(n){var i=e.call(this)||this,r=i.transform;return i._position=new zr(r.position,n),i._scale=new zr(r.scale,n),i._workRect=new t.Rectangle,i}return F(n,e),Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),n.prototype.getBounds=function(t,n){return this._lastBoundsID=-1,e.prototype.getBounds.call(this,t,n)},n.prototype.calculateBounds=function(){var t=this._bounds,e=this._work,n=this._workRect,i=this.transform.worldTransform,r=0,o=0,s=0,a=0,u=this.children;if(0<u.length)for(var l=!0,h=0,c=u.length;h<c;++h){var p=u[h];p.visible&&(p.getBoundsInternal(!1,n),l?(l=!1,r=n.x,s=n.y,o=n.x+n.width,a=n.y+n.height):(r=Math.min(r,n.x),s=Math.min(s,n.y),o=Math.max(o,n.x+n.width),a=Math.max(a,n.y+n.height)))}t.clear(),e.set(r,s),i.apply(e,e),t.addPoint(e),e.set(o,a),i.apply(e,e),t.addPoint(e)},n}(sr),c_=function(){function t(){this.shape=null,this.x=0,this.y=0,this.p0x=0,this.p0y=0,this.p1x=0,this.p1y=0,this.index=0,this.t=0,this.distance=0}return t.prototype.copyFrom=function(t){return this.shape=t.shape,this.x=t.x,this.y=t.y,this.p0x=t.p0x,this.p0y=t.p0y,this.p1x=t.p1x,this.p1y=t.p1y,this.index=t.index,this.t=t.t,this.distance=t.distance,this},t}(),p_=function(){function t(t,e,n){this.enable=t,this.color=e,this.alpha=n}return t.from=function(e,n,i){var r,o,s;return new t(null!==(r=null==i?void 0:i.enable)&&void 0!==r?r:e.enable(n),null!==(o=null==i?void 0:i.color)&&void 0!==o?o:e.color(n),null!==(s=null==i?void 0:i.alpha)&&void 0!==s?s:e.alpha(n))},t}(),f_=function(){function t(){}return t.from=function(t,e){return Ot(t)?function(e){return t[e%t.length]}:Ct(t)?t:null!=t?function(){return t}:Ot(e)?function(t){return e[t%e.length]}:Ct(e)?e:function(){return e}},t}(),d_=function(t){this.enable=f_.from(null==t?void 0:t.enable,!0),this.color=f_.from(null==t?void 0:t.color,qv),this.alpha=f_.from(null==t?void 0:t.alpha,rt.FILL_ALPHA)},y_=function(){function t(t,e){this.outer=t,this.inner=e}return t.from=function(e,n,i){var r,o;return new t(null!==(r=null==i?void 0:i.outer)&&void 0!==r?r:e.outer(n),null!==(o=null==i?void 0:i.inner)&&void 0!==o?o:e.inner(n))},t}(),g_=function(t){this.outer=f_.from(null==t?void 0:t.outer,.2),this.inner=f_.from(null==t?void 0:t.inner,.1)},v_=function(){function t(t,e){this.x=t,this.y=e}return t.from=function(e,n,i,r,o){var s,a;return new t(null!==(s=null==i?void 0:i.x)&&void 0!==s?s:null!=e.x?e.x(n):r,null!==(a=null==i?void 0:i.y)&&void 0!==a?a:null!=e.y?e.y(n):o)},t}(),__=function(t){t&&(null!=t.x&&(this.x=f_.from(t.x,0)),null!=t.y&&(this.y=f_.from(t.y,0)))},m_=function(){function t(t,e,n,i,r,o,s){this.enable=t,this.color=e,this.alpha=n,this.width=i,this.align=r,this.side=o,this.style=s}return t.from=function(e,n,i){var r,o,s,a,u,l,h;return new t(null!==(r=null==i?void 0:i.enable)&&void 0!==r?r:e.enable(n),null!==(o=null==i?void 0:i.color)&&void 0!==o?o:e.color(n),null!==(s=null==i?void 0:i.alpha)&&void 0!==s?s:e.alpha(n),null!==(a=null==i?void 0:i.width)&&void 0!==a?a:e.width(n),null!==(u=null==i?void 0:i.align)&&void 0!==u?u:e.align(n),null!==(l=null==i?void 0:i.side)&&void 0!==l?l:e.side(n),null!==(h=null==i?void 0:i.style)&&void 0!==h?h:e.style(n))},t}(),b_=function(t){this.enable=f_.from(null==t?void 0:t.enable,!0),this.color=f_.from(null==t?void 0:t.color,qv),this.alpha=f_.from(null==t?void 0:t.alpha,rt.STROKE_ALPHA),this.width=f_.from(null==t?void 0:t.width,rt.STROKE_WIDTH),this.align=f_.from(null==t?void 0:t.width,rt.STROKE_ALIGN),this.side=f_.from(null==t?void 0:t.side,Z.ALL),this.style=f_.from(null==t?void 0:t.style,s.NON_SCALING)},T_=function(){function t(t,e){this._plotArea=t,this._domain=new zv(NaN,NaN),this._range=new zv(NaN,NaN),this._selection=null,this._fill=new d_(null==e?void 0:e.fill),this._stroke=new b_(null==e?void 0:e.stroke),this._size=new __(null==e?void 0:e.size),this._offset=new __(null==e?void 0:e.offset),this._padding=new g_(null==e?void 0:e.padding),this._list=[]}return t.prototype.newFill=function(t,e){return p_.from(this._fill,t,e)},t.prototype.newStroke=function(t,e){return m_.from(this._stroke,t,e)},t.prototype.newSize=function(t,e,n,i){return v_.from(this._size,t,e,n,i)},t.prototype.newOffset=function(t,e,n,i){return v_.from(this._offset,t,e,n,i)},t.prototype.newPadding=function(t,e){return y_.from(this._padding,t,e)},Object.defineProperty(t.prototype,"plotArea",{get:function(){return this._plotArea},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this._selection},set:function(t){this._selection=t},enumerable:!1,configurable:!0}),t.prototype.update=function(){for(var t=this._list,e=0,n=t.length;e<n;++e)t[e].update();var i=this._selection;i&&i.update()},t.prototype.onRender=function(){for(var t=this._list,e=0,n=t.length;e<n;++e)t[e].onRender();var i=this._selection;i&&i.onRender()},t.prototype.add=function(t){var e=this._list;t.bind(this,e.length),e.push(t)},t.prototype.get=function(t){var e=this._list;return 0<=t&&t<e.length?e[t]:null},t.prototype.indexOf=function(t){return this._list.indexOf(t)},t.prototype.clear=function(){for(var t=this._list,e=0,n=t.length;e<n;++e)t[e].destroy();return t.length=0,this},t.prototype.size=function(){return this._list.length},t.prototype.destroy=function(){this.clear();var t=this._selection;t&&t.unbind()},t.prototype.getDomain=function(t,e){e.clear();for(var n=this._list,i=0,r=n.length;i<r;++i){var o=n[i];if(o.coordinate.x===t){var s=o.domain;e.add(s.from,s.to)}}return e},t.prototype.getRange=function(t,e){e.clear();for(var n=this._list,i=0,r=n.length;i<r;++i){var o=n[i];if(o.coordinate.y===t){var s=o.range;e.add(s.from,s.to)}}return e},Object.defineProperty(t.prototype,"domain",{get:function(){var t=this._domain;t.clear();for(var e=this._list,n=0,i=e.length;n<i;++n){var r=e[n].domain;t.add(r.from,r.to)}return t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){var t=this._range;t.clear();for(var e=this._list,n=0,i=e.length;n<i;++n){var r=e[n].range;t.add(r.from,r.to)}return t},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(t,e){for(var n=this._list,i=n.length-1;0<=i;--i){var r=n[i];if(r.hitTest(t,e))return r}return null},t.prototype.calcHitPoint=function(e,n,i){var r=i,o=t.WORK_CALCHITPOINT,s=this._list,a=null;o.distance=1/0;for(var u=s.length-1;0<=u;--u){var l=s[u];if(l.calcHitPoint(e,n,r)&&r.distance<o.distance){a=l;var h=r;r=o,o=h}}return a&&o!==i&&i.copyFrom(o),a},t.WORK_CALCHITPOINT=new c_,t}(),w_=function(t){function e(e,n){var i,r=t.call(this,e,n)||this,o=new h_((function(){r._isViewDirty=!0,r._isContainerBoundsDirty=!0,ft.update(r)}));r._container=o,r.addChild(o),(null!==(i=null==n?void 0:n.mask)&&void 0!==i?i:r.theme.isOverflowMaskEnabled())&&(o.mask=r.getOverflowMask()),r._isViewDirty=!0,r._view=new po(r,(function(){return o}),null==n?void 0:n.view),r._coordinate=new e_(r,null==n?void 0:n.coordinate);var s=null==n?void 0:n.series,a=new T_(r,s);r._series=a;var u=null==n?void 0:n.axis,l=new Fv(r,new sr,u);r._axis=l,r.addChild(l.container),r.addSeries(a,null==s?void 0:s.list),r.addAxes(l,null==u?void 0:u.list);var h=null==s?void 0:s.selection;return null!=h&&(a.selection=h,h.bind(a)),r}return F(e,t),e.prototype.getOverflowMask=function(){return null==this._overflowMask&&(this._overflowMask=new uo(this),this.reflowable.add(this._overflowMask),this.toDirty()),this._overflowMask},e.prototype.addSeries=function(t,e){if(null!=e){var n=e.length;if(0<n){for(var i=0;i<n;++i)t.add(e[i]);t.update()}}},e.prototype.addAxes=function(t,e){if(null!=e)for(var n=0,i=e.length;n<i;++n)t.add(e[n])},Object.defineProperty(e.prototype,"coordinate",{get:function(){return this._coordinate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"series",{get:function(){return this._series},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"axis",{get:function(){return this._axis},enumerable:!1,configurable:!0}),e.prototype.newView=function(t){var e=this;return new po(this,(function(){return e._container}),null==t?void 0:t.view)},e.prototype.onViewDirty=function(){this._coordinate.fit(),this._axis.onRender(),this._series.onRender()},e.prototype.fit=function(t,e,n,i,r){var o=this._coordinate,s=this._axis,a=this._series;if(null!=t&&t<=0)o.fit(e,n,i,r),s.update(),a.update();else{this._blendDuration=null!=t?t:200,this._blendStartTime=Date.now(),o.mark(e,n,i,r);var u=this._blendTimeout;null!=u&&window.clearTimeout(u),this._blendTimeout=window.setTimeout(this._onBlendBound,0)}return this},e.prototype.onBlend=function(){var t=(Date.now()-this._blendStartTime)/this._blendDuration;t<1?this._blendTimeout=window.setTimeout(this._onBlendBound,0):(this._blendTimeout=null,t=1),this._coordinate.blend(fr.ELASTIC(t)),this._axis.update(),this._series.update()},e.prototype.destroy=function(){this._container.destroy(),this._series.destroy(),this._axis.destroy()},e}(l_),E_=function(){function t(t,e,n,i){this._plotArea=t,this._container=e,this._list=new Map,this._primary=n,this._secondary=i}return Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this._plotArea},enumerable:!1,configurable:!0}),t.prototype.add=function(t){var e=this._list,n=e.get(t.position);null==n&&(n=[],e.set(t.position,n)),n.push(t),t.bind(this,n.length-1)},t.prototype.get=function(t,e){var n=this._primary,i=n.size(t);if(0<=e&&e<i)return n.get(t,e);var r=this._secondary,o=r.size(t);if(i<=e&&e<i+o)return r.get(t,e-i);var s=this._list.get(ai(t,Av));return s&&i+o<=e&&e<i+o+s.length?s[e-i-o]:null},t.prototype.indexOf=function(t){var e=this._primary,n=e.indexOf(t);if(0<=n)return n;var i=this._secondary;if(0<=(n=i.indexOf(t)))return e.size(t.position)+n;var r=this._list.get(t.position);return r?e.size(t.position)+i.size(t.position)+r.indexOf(t):-1},t.prototype.clear=function(t){this._primary.clear(t),this._secondary.clear(t);var e=this._list.get(ai(t,Av));if(e){for(var n=0,i=e.length;n<i;++n)e[n].destroy();e.length=0}return this},t.prototype.size=function(t){var e=this._list.get(ai(t,Av));return this._primary.size(t)+this._secondary.size(t)+(null!=e?e.length:0)},t.prototype.update=function(){this._primary.update(),this._secondary.update(),this._list.forEach((function(t){for(var e=0,n=t.length;e<n;++e)t[e].update()}))},t.prototype.onRender=function(){this._primary.onRender(),this._secondary.onRender(),this._list.forEach((function(t){for(var e=0,n=t.length;e<n;++e)t[e].onRender()}))},t.prototype.destroy=function(){this._primary.destroy(),this._secondary.destroy(),this._list.forEach((function(t){for(var e=0,n=t.length;e<n;++e)t[e].destroy();t.length=0}))},t}(),O_=function(){function t(t,e,n){this._container=t,this._primary=e,this._secondary=n}return Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),t.prototype.add=function(t,e){if(null!=e){var n=this._primary,i=n.size();return e<i?0<=e&&n.add(t,e):this._secondary.add(t,e-i),this}return this._secondary.add(t),this},t.prototype.get=function(t){var e=this._primary,n=e.size();if(0<=t&&t<n)return e.get(t);var i=this._secondary,r=i.size();return n<=t&&t<n+r?i.get(t-n):null},t.prototype.indexOf=function(t){var e=this._primary,n=e.indexOf(t);return 0<=n?n:0<=(n=this._secondary.indexOf(t))?e.size()+n:-1},t.prototype.remove=function(t){if(St(t)){var e=t,n=this._primary,i=n.size();if(0<=e&&e<i)return n.remove(e);var r=this._secondary,o=r.size();if(i<=e&&e<i+o)return r.remove(e-i)}else{var s=t,a=this._primary.remove(s);if(null!=a)return a;if(null!=(a=this._secondary.remove(s)))return a}return null},t.prototype.clear=function(){return this._primary.clear(),this._secondary.clear(),this},t.prototype.destroy=function(){return this.clear()},t.prototype.size=function(){return this._primary.size()+this._secondary.size()},t.prototype.fit=function(t,e){return this._primary.fit(t,e),this._secondary.fit(t,e),this},t.prototype.mark=function(t,e){return this._primary.mark(t,e),this._secondary.mark(t,e),this},t.prototype.blend=function(t){return this._primary.blend(t),this._secondary.blend(t),this},t}(),C_=function(){function t(t,e,n){this._plotArea=t,this._primary=e,this._secondary=n,this._x=new O_(this,e.x,n.x),this._y=new O_(this,e.y,n.y)}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"plotArea",{get:function(){return this._plotArea},enumerable:!1,configurable:!0}),t.prototype.fit=function(t,e,n,i){return this._x.fit(t,e),this._y.fit(n,i),this},t.prototype.mark=function(t,e,n,i){return this._x.mark(t,e),this._y.mark(n,i),this},t.prototype.blend=function(t){return this._x.blend(t),this._y.blend(t),this},t}(),S_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onReflow=function(t,e,n){if(!this._isInitialized||this._width!==e||this._height!==n){this._isInitialized=!0,this._width=e,this._height=n;var i=.5*n;this.clear(),this.beginFill(16777215,1),this.drawRect(0,0,e,i),this.endFill()}},e}(ya),x_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onReflow=function(t,e,n){if(!this._isInitialized||this._width!==e||this._height!==n){this._isInitialized=!0,this._width=e,this._height=n;var i=.5*n;this.clear(),this.beginFill(16777215,1),this.drawRect(0,i,e,i),this.endFill()}},e}(ya),D_=function(){function t(t,e,n){this._plotArea=t,this._primary=e,this._secondary=n,this._domain=new zv(NaN,NaN),this._range=new zv(NaN,NaN)}return t.prototype.newFill=function(t,e){return this._secondary.newFill(t,e)},t.prototype.newStroke=function(t,e){return this._secondary.newStroke(t,e)},t.prototype.newSize=function(t,e,n,i){return this._secondary.newSize(t,e,n,i)},t.prototype.newOffset=function(t,e,n,i){return this._secondary.newOffset(t,e,n,i)},t.prototype.newPadding=function(t,e){return this._secondary.newPadding(t,e)},Object.defineProperty(t.prototype,"plotArea",{get:function(){return this._plotArea},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this._secondary.selection},enumerable:!1,configurable:!0}),t.prototype.update=function(){this._primary.update(),this._secondary.update();var t=this._secondary.selection;t&&t.update()},t.prototype.onRender=function(){this._primary.onRender(),this._secondary.onRender();var t=this._secondary.selection;t&&t.onRender()},t.prototype.add=function(t){this._secondary.add(t)},t.prototype.get=function(t){var e=this._primary,n=e.size();if(0<=t&&t<n)return e.get(t);var i=this._secondary,r=i.size();return n<=t&&t<n+r?i.get(t-n):null},t.prototype.indexOf=function(t){var e=this._primary,n=e.indexOf(t);return 0<=n?n:0<=(n=this._secondary.indexOf(t))?e.size()+n:-1},t.prototype.clear=function(){return this._primary.clear(),this._secondary.clear(),this},t.prototype.size=function(){return this._primary.size()+this._secondary.size()},t.prototype.destroy=function(){this.clear();var t=this._secondary.selection;t&&t.unbind()},t.prototype.getDomain=function(t,e){this._primary.getDomain(t,e);var n=e.from,i=e.to;return this._secondary.getDomain(t,e),e.add(n,i),e},t.prototype.getRange=function(t,e){e.clear(),this._primary.getRange(t,e);var n=e.from,i=e.to;return this._secondary.getRange(t,e),e.add(n,i),e},Object.defineProperty(t.prototype,"domain",{get:function(){var t=this._domain;t.clear();var e=this._primary.domain;t.add(e.from,e.to);var n=this._secondary.domain;return t.add(n.from,n.to),t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"range",{get:function(){var t=this._domain;t.clear();var e=this._primary.range;t.add(e.from,e.to);var n=this._secondary.range;return t.add(n.from,n.to),t},enumerable:!1,configurable:!0}),t.prototype.hitTest=function(t,e){var n=this._secondary.hitTest(t,e);return null!=n?n:this._primary.hitTest(t,e)},t.prototype.calcHitPoint=function(e,n,i){var r,o=i,s=null!==(r=t.WORK_CALCHITPOINT)&&void 0!==r?r:t.WORK_CALCHITPOINT=new c_,a=this._secondary.calcHitPoint(e,n,s),u=this._primary.calcHitPoint(e,n,o);return null!=u?null!=a?o.distance<=s.distance?u:(o.copyFrom(s),a):u:null!=a?(o.copyFrom(s),a):null},t}(),I_=function(){function e(e,n,i,r,o,s){this._isContainerBoundsDirty=!0,this._containerBounds=new t.Rectangle,this._workPoint=new t.Point,this._margin=r,this._plotArea=e;var a=new h_(n);this._container=a,this._coordinate=new e_(this,null==s?void 0:s.coordinate),i&&(a.mask=this.getOverflowMask()),this._series=new T_(this,null==s?void 0:s.series),this._axis=new Fv(this,o,null==s?void 0:s.axis)}return Object.defineProperty(e.prototype,"plotArea",{get:function(){return this._plotArea},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"chart",{get:function(){return this._plotArea.chart},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"series",{get:function(){return this._series},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this._coordinate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"axis",{get:function(){return this._axis},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._plotArea.state},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"view",{get:function(){return this._plotArea.view},enumerable:!1,configurable:!0}),e.prototype.on=function(t,e,n){return this._plotArea.on(t,e,n),this},e.prototype.off=function(t,e,n){return this._plotArea.off(t,e,n),this},e.prototype.getPixelDomain=function(t){var e=this._plotArea,n=e.padding,i=e.width;return t.set(n.getLeft(),i-n.getRight())},e.prototype.getAxisBounds=function(t){return this.getPixelBounds()},e.prototype.getSelectionBoundsX=function(){return this.getPixelBounds()},e.prototype.getSelectionBoundsY=function(){return this.getPixelBounds()},e.prototype.toBoundsDirty=function(){this._isContainerBoundsDirty=!0},e.prototype.toLocal=function(t,e,n,i){return this._plotArea.toLocal(t,e,n,i)},e.prototype.destroy=function(){this._container.destroy(),this._series.destroy(),this._axis.destroy()},e}(),A_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getOverflowMask=function(){if(null==this._overflowMask){var t=this._plotArea;this._overflowMask=new S_(t),t.reflowable.add(this._overflowMask),t.toDirty()}return this._overflowMask},e.prototype.getPixelRange=function(t){var e=this._plotArea,n=e.padding.getTop(),i=e.height;return t.set(.5*(i-this._margin),n)},e.prototype.getPixelBounds=function(){var t=this._plotArea.getPixelBounds();return t.height*=.5,t},e.prototype.getContainerBounds=function(){var t=this._containerBounds;if(this._isContainerBoundsDirty){this._isContainerBoundsDirty=!1;var e=this._plotArea.getContainerBounds();t.width=e.width,t.height=.5*e.height,t.x=e.x,t.y=e.y}return t},e}(I_),R_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getOverflowMask=function(){if(null==this._overflowMask){var t=this._plotArea;this._overflowMask=new x_(t),t.reflowable.add(this._overflowMask),t.toDirty()}return this._overflowMask},e.prototype.getPixelRange=function(t){var e=this._plotArea,n=e.padding.getBottom(),i=e.height;return t.set(i-n,.5*(i+this._margin))},e.prototype.getPixelBounds=function(){var t=this._plotArea.getPixelBounds();return t.height*=.5,t.y=t.height,t},e.prototype.getContainerBounds=function(){var t=this._containerBounds;if(this._isContainerBoundsDirty){this._isContainerBoundsDirty=!1;var e=this._plotArea.getContainerBounds();t.width=e.width,t.height=.5*e.height,t.x=e.x,t.y=e.y+t.height}return t},e}(I_),P_=function(){function t(t,e){this._primary=t,this._secondary=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._secondary.x},set:function(t){this._primary.x=t,this._secondary.x=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._secondary.y},set:function(t){this._primary.y=t,this._secondary.y=t},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){return this._primary.set(t,e),this._secondary.set(t,e),this},t}(),M_=function(){function t(t,e){this._primary=t,this._secondary=e,this._scale=new P_(t.scale,e.scale),this._position=new P_(t.position,e.position)}return Object.defineProperty(t.prototype,"scale",{get:function(){return this._scale},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),t.prototype.getLocalBounds=function(t){this._primary.getLocalBounds(t);var e=t.x,n=t.y,i=t.width,r=t.height;this._secondary.getLocalBounds(t);var o=t.x,s=t.y,a=t.width,u=t.height,l=Math.min(e,o),h=Math.min(n,s),c=Math.max(e+i,o+a),p=Math.max(n+r,s+u);return t.x=l,t.y=h,t.width=c-l,t.height=p-h,t},t}(),k_=function(t){function e(e,n){var i,r,o,s,a,u,l,h=t.call(this,e,n)||this,c=h.theme,p=null!==(i=null==n?void 0:n.margin)&&void 0!==i?i:c.getMargin();h._margin=p;var f=new sr,d=function(){h.onContainerChange()},y=null!==(r=null==n?void 0:n.mask)&&void 0!==r?r:c.isOverflowMaskEnabled(),g=null==n?void 0:n.primary,v=new A_(h,d,y,p,f,g);h._primary=v;var _=null==n?void 0:n.secondary,m=new R_(h,d,y,p,f,_);h._secondary=m,h.addChild(v.container),h.addChild(m.container),h._coordinate=new C_(h,v.coordinate,m.coordinate);var b=v.series,T=m.series,w=new D_(h,b,T);h._series=w;var E=v.axis,O=m.axis;h.addChild(f);var C=new E_(h,f,E,O);h._axis=C,h.addSeries(b,null===(o=null==g?void 0:g.series)||void 0===o?void 0:o.list),h.addSeries(T,null===(s=null==_?void 0:_.series)||void 0===s?void 0:s.list),h.addAxes(E,null===(a=null==g?void 0:g.axis)||void 0===a?void 0:a.list),h.addAxes(O,null===(u=null==_?void 0:_.axis)||void 0===u?void 0:u.list),h.addAxes(C,null===(l=null==n?void 0:n.axis)||void 0===l?void 0:l.list);var S=null==n?void 0:n.selection;return null!=S&&(b.selection=S,T.selection=S,S.bind(w)),h}return F(e,t),e.prototype.onResize=function(e,n,i,r){this._primary.toBoundsDirty(),this._secondary.toBoundsDirty(),t.prototype.onResize.call(this,e,n,i,r)},e.prototype.addSeries=function(t,e){if(null!=e){var n=e.length;if(0<n){for(var i=0;i<n;++i)t.add(e[i]);t.update()}}},e.prototype.addAxes=function(t,e){if(null!=e)for(var n=0,i=e.length;n<i;++n)t.add(e[n])},Object.defineProperty(e.prototype,"primary",{get:function(){return this._primary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"secondary",{get:function(){return this._secondary},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this.secondary.container},enumerable:!1,configurable:!0}),e.prototype.onContainerChange=function(){this._isViewDirty=!0,this._isContainerBoundsDirty=!0,this._primary.toBoundsDirty(),this._secondary.toBoundsDirty(),ft.update(this)},Object.defineProperty(e.prototype,"coordinate",{get:function(){return this._coordinate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"series",{get:function(){return this._series},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"axis",{get:function(){return this._axis},enumerable:!1,configurable:!0}),e.prototype.newView=function(t){var e,n=this;return new po(this,(function(){return null!=e?e:e=new M_(n._primary.container,n._secondary.container)}),null==t?void 0:t.view)},e.prototype.onViewDirty=function(){this._coordinate.fit(),this._axis.onRender(),this._series.onRender()},e.prototype.fit=function(t,e,n,i,r){if(null!=t&&t<=0){var o=this.primary;o.coordinate.fit(e,n,i,r),o.axis.update(),o.series.update();var s=this.secondary;s.coordinate.fit(e,n,i,r),s.axis.update(),s.series.update()}else{this._blendDuration=null!=t?t:200,this._blendStartTime=Date.now(),this.primary.coordinate.mark(e,n,i,r),this.secondary.coordinate.mark(e,n,i,r);var a=this._blendTimeout;null!=a&&window.clearTimeout(a),this._blendTimeout=window.setTimeout(this._onBlendBound,0)}return this},e.prototype.onBlend=function(){var t=(Date.now()-this._blendStartTime)/this._blendDuration;t<1?this._blendTimeout=window.setTimeout(this._onBlendBound,0):(this._blendTimeout=null,t=1);var e=fr.ELASTIC(t),n=this.primary;n.coordinate.blend(e),n.axis.update(),n.series.update();var i=this.secondary;i.coordinate.blend(e),i.axis.update(),i.series.update()},e.prototype.destroy=function(){var t,e;null===(t=this._primary)||void 0===t||t.destroy(),null===(e=this._secondary)||void 0===e||e.destroy(),this._axis.destroy()},e}(l_),L_=function(){function t(t,e,n){this._from=t,this._to=e,this._onChange=n}return Object.defineProperty(t.prototype,"from",{get:function(){return this._from},set:function(t){this.set(t,void 0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"to",{get:function(){return this._to},set:function(t){this.set(void 0,t)},enumerable:!1,configurable:!0}),t.prototype.set=function(t,e){var n=!1;return null!=t&&this._from!==t&&(Nu(this._from)&&Nu(t)||(this._from=t,n=!0)),null!=e&&this._to!==e&&(Nu(this._to)&&Nu(e)||(this._to=e,n=!0)),n&&this._onChange(),this},t.prototype.add=function(t,e){var n,i;return Nu(t)||(n=Nu(this.from)?t:Math.min(this.from,t)),Nu(e)||(i=Nu(this.to)?e:Math.max(this.to,e)),this.set(n,i)},t.prototype.clear=function(){return this.set(NaN,NaN)},t}(),N_=function(){function t(t,e){this._x=t,this._y=e}return Object.defineProperty(t.prototype,"x",{get:function(){return this._x},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y",{get:function(){return this._y},enumerable:!1,configurable:!0}),t.prototype.bind=function(t){this._x.bind(t),this._y.bind(t)},t.prototype.unbind=function(){this._x.unbind(),this._y.unbind()},t.prototype.set=function(t,e,n,i){this._x.set(t,e,n,i),this._y.set(t,e,n,i)},t.prototype.unset=function(){this._x.unset(),this._y.unset()},t.prototype.update=function(t,e,n,i){var r=this._x.update(t,e,n,i),o=this._y.update(t,e,n,i);return r||o},t}(),B_=function(){function t(t){var e,n,i,r=this.toTheme(t);this._theme=r;var o=(new Dt).add(null!==(e=null==t?void 0:t.state)&&void 0!==e?e:vt.HOVERED);if(this._state=o,this._isEnabled=null!==(n=null==t?void 0:t.enable)&&void 0!==n?n:r.isEnabled(o),null!=t){var s=t.shape;null!=s&&(Ct(s)?this._newShape=s:this._shape=s)}this._style=null!==(i=null==t?void 0:t.style)&&void 0!==i?i:this.setStyle}return t.prototype.bind=function(t){if(this._isEnabled){var e=this._shape;if(null==e){var n=this._state,i=this._newShape;e=null!=i?i(n):this.newShape(n,this._theme)}this._shape=e,e.attach(t.plotArea.axis.container),e.visible=!1}},t.prototype.unbind=function(){var t=this._shape;t&&t.detach()},t.prototype.newShape=function(t,e){return e.newShape(t)},t.prototype.set=function(t,e,n,i){this.update(t,e,n,i);var r=this._shape;null!=r&&this._style(r,i)},t.prototype.setStyle=function(t,e){},t.prototype.unset=function(){var t=this._shape;t&&(t.visible=!1)},t.prototype.toTheme=function(t){var e=null==t?void 0:t.theme;return xt(e)?this.getTheme(e):null!=e?e:this.getTheme(this.getType())},t.prototype.getTheme=function(t){return it.getInstance().get(t)},t}(),z_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.update=function(t,e,n,i){var r=this._shape;if(r){var o=n.x,s=t.plotArea.getSelectionBoundsX();r.transform.position.set(o,s.y+.5*s.height),r.size.set(0,s.height);var a=.5*r.stroke.width;return r.visible=s.x<=o+a&&o-a<=s.x+s.width,!0}return!1},e.prototype.getType=function(){return"DChartSelectionGridlineX"},e}(B_),U_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.update=function(t,e,n,i){var r=this._shape;if(r){var o=n.y,s=t.plotArea.getSelectionBoundsY();r.transform.position.set(s.x+.5*s.width,o),r.size.set(s.width,0);var a=.5*r.stroke.width;return r.visible=s.y<=o+a&&o-a<=s.y+s.height,!0}return!1},e.prototype.getType=function(){return"DChartSelectionGridlineY"},e}(B_),j_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.update=function(t,e,n,i){var r=this._shape;return!!r&&(r.transform.position.copyFrom(n),r.visible=this.isVisible(t,e,n,i),!0)},e.prototype.isVisible=function(t,e,n,i){t=(null==i?void 0:i.container)||t;var r=n.x,o=n.y,s=t.plotArea.getPixelBounds();return s.x<=r&&r<=s.x+s.width&&s.y<=o&&o<=s.y+s.height},e.prototype.getType=function(){return"DChartSelectionMarker"},e}(B_),F_={PREVIOUS:0,NEXT:1,CLOSER:2,INTERSECTION:3},H_=function(e){function n(n){var i,r,o,s=e.call(this)||this;s._container=null,s._series=null,s._isEnabled=null===(i=n.enable)||void 0===i||i,s._isVisible=!1;var a=n.gridline;s._gridline=null!=a?new N_(new z_(a.x),new U_(a.y)):new N_(new z_,new U_),s._marker=new j_(n.marker),s._state=null!==(r=n.state)&&void 0!==r?r:vt.HOVERED,s._coordinateX=null,s._coordinateY=null,s._position=new t.Point,s._point=null!==(o=n.point)&&void 0!==o?o:F_.CLOSER,s._work=new t.Point;var u=n.on;if(u)for(var l in u){var h=u[l];h&&s.on(l,h)}return s}return F(n,e),n.prototype.bind=function(t){this._isEnabled&&(this._container=t,this._gridline.bind(t),this._marker.bind(t))},n.prototype.unbind=function(){this._marker.unbind(),this._gridline.unbind(),this._container=null,this._coordinateX=null,this._coordinateY=null},Object.defineProperty(n.prototype,"visible",{get:function(){return this._isVisible},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"series",{get:function(){return this._series},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"position",{get:function(){return this._position},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"gridline",{get:function(){return this._gridline},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"marker",{get:function(){return this._marker},enumerable:!1,configurable:!0}),n.prototype.set=function(t,e){St(t)?this.set1(t,e):this.set2(t,e)},n.prototype.set1=function(t,e){var n=this._container;if(null!=n){var i=this._work;i.set(t,e);var r=n.plotArea;r.container.toLocal(i,void 0,i,!0);var o=r.coordinate,s=o.x.get(0),a=o.y.get(0),u=i.x,l=i.y;s&&a?(u=s.unmap(s.transform.unmap(u)),l=a.unmap(a.transform.unmap(l))):(s=null,a=null);var h=this._series,c=this._position;if(!this._isVisible||null!=h||u!==c.x||l!==c.y){if(this._isVisible=!0,c.set(u,l),this._coordinateX=s,this._coordinateY=a,r.container.localTransform.apply(i,i),this._gridline.set(n,c,i,null),this._marker.set(n,c,i,null),null!=h){var p=this._state;h&&h.state.remove(p),this._series=null}this.emit("change",this),ft.update(r)}}},n.prototype.set2=function(t,e){var n=this._container;if(null!=n){var i=this._work,r=e.x,o=e.y;switch(this._point){case F_.PREVIOUS:r=e.p0x,o=e.p0y;break;case F_.NEXT:r=e.p1x,o=e.p1y;break;case F_.CLOSER:Math.abs(e.p0x-e.x)<Math.abs(e.p1x-e.x)?(r=e.p0x,o=e.p0y):(r=e.p1x,o=e.p1y)}i.set(r,o);var s=n.plotArea;s.container.localTransform.apply(i,i);var a=t.coordinate.x,u=t.coordinate.y,l=r,h=o;a&&u?(l=a.unmap(a.transform.unmap(l)),h=u.unmap(u.transform.unmap(h))):(a=null,u=null);var c=this._series,p=this._position;if(!this._isVisible||c!==t||l!==p.x||h!==p.y){if(this._isVisible=!0,p.set(l,h),this._coordinateX=a,this._coordinateY=u,this._gridline.set(n,p,i,t),this._marker.set(n,p,i,t),c!==t){var f=this._state;c&&c.state.remove(f),this._series=t,t.state.add(f)}this.emit("change",this),ft.update(s)}}},n.prototype.unset=function(){var t=this._container;if(null!=t){var e=this._series;(this._isVisible||null!=e)&&(this._isVisible=!1,this._coordinateX=null,this._coordinateY=null,this._gridline.unset(),this._marker.unset(),null!=e&&(this._series=null,e.state.remove(this._state)),this.emit("change",this),ft.update(t.plotArea))}},n.prototype.update=function(){var t=this._container;if(null==t)return!1;if(!this._isVisible)return!1;var e=this._position,n=this._work,i=this._coordinateX,r=this._coordinateY;i&&r?n.set(i.transform.map(i.map(e.x)),r.transform.map(r.map(e.y))):n.copyFrom(e),t.plotArea.container.localTransform.apply(n,n);var o=this._series,s=this._gridline.update(t,e,n,o),a=this._marker.update(t,e,n,o);return s||a},n}(t.utils.EventEmitter),G_=function(t){function e(e){var n,i=t.call(this)||this;i._container=null;var r=ai(null!==(n=null==e?void 0:e.point)&&void 0!==n?n:F_.CLOSER,F_);i._selected=i.newSelected(r,null==e?void 0:e.selected),i._hovered=i.newHovered(r,null==e?void 0:e.hovered),i._dismiss=i.toDismiss(e);var o=null==e?void 0:e.on;if(null!=o)for(var s in o){var a=o[s];a&&i.on(s,a)}return i._onMoveBound=function(t){i.onMove(t)},i._onTapBound=function(t,e){i.onTap(e)},i._onLongPressBound=function(t,e){i.onLongPress(e)},i}return F(e,t),e.prototype.toDismiss=function(t){var e;if(null!=t){var n=t.dismiss;if(null!=n)return{enable:null===(e=n.enable)||void 0===e||e,tap:this.toDismissTap(n.tap),longPress:this.toDismissLongPress(n.longPress),noSeries:this.toDismissNoSeries(n.noSeries)}}return{enable:!0,tap:this.toDismissTap(),longPress:this.toDismissLongPress(),noSeries:this.toDismissNoSeries()}},e.prototype.toDismissTap=function(t){var e,n;return{enable:null===(e=null==t?void 0:t.enable)||void 0===e||e,modifier:ai(null!==(n=null==t?void 0:t.modifier)&&void 0!==n?n:lr.NOT_NONE,lr)}},e.prototype.toDismissLongPress=function(t){var e;return{enable:null===(e=null==t?void 0:t.enable)||void 0===e||e}},e.prototype.toDismissNoSeries=function(t){var e;return{enable:null===(e=null==t?void 0:t.enable)||void 0===e||e}},e.prototype.newSelected=function(t,e){return new H_(this.toSelectedOptions(t,e))},e.prototype.newHovered=function(t,e){return new H_(this.toHoveredOptions(t,e))},e.prototype.toSelectedOptions=function(t,e){return this.toSubOptions(t,e,vt.ACTIVE)},e.prototype.toHoveredOptions=function(t,e){return this.toSubOptions(t,e,vt.HOVERED)},e.prototype.toSubOptions=function(t,e,n){var i,r,o,s,a,u,l;null==(e=e||{}).point&&(e.point=t),null==e.state&&(e.state=n);var h=null!==(i=e.gridline)&&void 0!==i?i:e.gridline={},c=null!==(r=h.x)&&void 0!==r?r:h.x={};null==c.state&&(c.state=n);var p=null!==(o=h.y)&&void 0!==o?o:h.y={};null==p.state&&(p.state=n);var f=null!==(s=e.marker)&&void 0!==s?s:e.marker={};null==f.state&&(f.state=n);var d=null!==(a=e.label)&&void 0!==a?a:e.label={},y=null!==(u=d.x)&&void 0!==u?u:d.x={};null==y.state&&(y.state=n);var g=null!==(l=d.y)&&void 0!==l?l:d.y={};return null==g.state&&(g.state=n),e},e.prototype.onTap=function(t){var n=this._container;if(null!=n){var i=this._dismiss,r=this._selected;if(i.enable&&i.tap.enable&&hr.match(t,i.tap.modifier))r.unset();else{var o=e.WORK_SELECT,s=t.data.global,a=n.calcHitPoint(s.x,s.y,o);null!=a?r.set(a,o):i.enable&&i.noSeries.enable?r.unset():r.set(s.x,s.y)}}},e.prototype.onLongPress=function(t){if(null!=this._container){var e=this._dismiss;e.enable&&e.longPress.enable&&this._selected.unset()}},e.prototype.onMove=function(t){var n=this._container;if(null!=n&&!n.plotArea.state.isGesturing){var i=this._hovered;if(t.target===n.plotArea){var r=e.WORK_SELECT,o=t.data.global,s=n.calcHitPoint(o.x,o.y,r);null!=s?i.set(s,r):i.unset()}else i.unset()}},e.prototype.bind=function(t){this._container=t,this._selected.bind(t),this._hovered.bind(t);var e=t.plotArea,n=e.view;e.on(cr.move,this._onMoveBound),n.on("gesturetap",this._onTapBound),n.on("gesturelongpress",this._onLongPressBound)},e.prototype.unbind=function(){var t=this._container;if(this._container=null,null!=t){var e=t.plotArea,n=e.view;e.off(cr.move,this._onMoveBound),n.off("gesturetap",this._onTapBound),n.off("gesturelongpress",this._onLongPressBound)}this._selected.unbind(),this._hovered.unbind()},Object.defineProperty(e.prototype,"selected",{get:function(){return this._selected},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"hovered",{get:function(){return this._hovered},enumerable:!1,configurable:!0}),e.prototype.update=function(){var t=this._selected.update(),e=this._hovered.update();if(t||e){var n=this._container;null!=n&&ft.update(n.plotArea)}},e.prototype.onRender=function(){this._selected.update(),this._hovered.update()},e.WORK_SELECT=new c_,e}(t.utils.EventEmitter),V_=function(){function t(t,e){var n,i;this._parent=t,this._coordinateIndexX=null!==(n=null==e?void 0:e.x)&&void 0!==n?n:0,this._coordinateIndexY=null!==(i=null==e?void 0:e.y)&&void 0!==i?i:0,this._coordinateIdUpdatedX=NaN,this._coordinateIdUpdatedY=NaN,this._coordinateTransformIdUpdatedX=NaN,this._coordinateTransformIdUpdatedY=NaN}return Object.defineProperty(t.prototype,"x",{get:function(){var t=this._parent.container;return t?t.plotArea.coordinate.x.get(this._coordinateIndexX):null},set:function(t){var e=this.toIndexX(t);this._coordinateIndexX!==e&&(this._coordinateIndexX=e,this._coordinateIdUpdatedX=NaN,this._coordinateTransformIdUpdatedX=NaN)},enumerable:!1,configurable:!0}),t.prototype.toIndexX=function(t){if(St(t))return t;if(null!=t){var e=this._parent.container;if(e)return e.plotArea.coordinate.x.indexOf(t)}return-1},Object.defineProperty(t.prototype,"y",{get:function(){var t=this._parent.container;return t?t.plotArea.coordinate.y.get(this._coordinateIndexY):null},set:function(t){var e=this.toIndexY(t);this._coordinateIndexY!==e&&(this._coordinateIndexY=e,this._coordinateIdUpdatedY=NaN,this._coordinateTransformIdUpdatedY=NaN)},enumerable:!1,configurable:!0}),t.prototype.toIndexY=function(t){if(St(t))return t;if(null!=t){var e=this._parent.container;if(e)return e.plotArea.coordinate.y.indexOf(t)}return-1},t.prototype.isDirty=function(t,e){var n=t.id,i=e.id,r=n!==this._coordinateIdUpdatedX,o=i!==this._coordinateIdUpdatedY;return this._coordinateIdUpdatedX=n,this._coordinateIdUpdatedY=i,r||o},t.prototype.isTransformDirty=function(t,e){var n=t.transform.id,i=e.transform.id,r=n!==this._coordinateTransformIdUpdatedX,o=i!==this._coordinateTransformIdUpdatedY;return this._coordinateTransformIdUpdatedX=n,this._coordinateTransformIdUpdatedY=i,r||o},t.prototype.reset=function(){this._coordinateIdUpdatedX=NaN,this._coordinateIdUpdatedY=NaN},t.prototype.destroy=function(){this.reset()},t}(),W_=function(t){function e(e){var n=t.call(this)||this;n._coordinate=new V_(n,null==e?void 0:e.coordinate),n._index=0,n._domain=new zv(NaN,NaN),n._range=new zv(NaN,NaN),n._regionPointId=NaN,n._isShown=!0,n._state=new It((function(t,e){n.onStateChange(t,e)}));var i=null==e?void 0:e.on;if(null!=i)for(var r in i){var o=i[r];o&&n.on(r,o)}return n}return F(e,t),e.prototype.bind=function(t,e){this._container=t,this._coordinate.reset(),this._index=e;var n=t.plotArea.chart;return n&&(this._state.parent=n.state),this},e.prototype.unbind=function(){return this._container=void 0,this},Object.defineProperty(e.prototype,"domain",{get:function(){return this.updateRegion(),this._domain},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"range",{get:function(){return this.updateRegion(),this._range},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._container||null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"coordinate",{get:function(){return this._coordinate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"state",{get:function(){return this._state},enumerable:!1,configurable:!0}),e.prototype.show=function(){return!0!==this._isShown&&(this._isShown=!0,this.onShow()),this},e.prototype.onShow=function(){var t=this.shape;null!=t&&(t.visible=!0)},e.prototype.isShown=function(){return this._isShown},e.prototype.hide=function(){return!1!==this._isShown&&(this._isShown=!1,this.onHide()),this},e.prototype.onHide=function(){var t=this.shape;null!=t&&(t.visible=!1)},e.prototype.isHidden=function(){return!this._isShown},e.prototype.destroy=function(){return this._container=void 0,this._coordinate.destroy(),this},e.prototype.hitTest=function(t,e){return!1},e.prototype.calcHitPoint=function(t,e,n){return!1},e.prototype.onStateChange=function(t,e){var n;this.toDirty();var i=null===(n=this._container)||void 0===n?void 0:n.plotArea.chart;ft.update(i),this.emit("statechange",t,e,this)},e}(t.utils.EventEmitter),K_=function(e){function n(t){var n,i=e.call(this,t)||this;return i._line=null,i._options=t,i._points=null!==(n=null==t?void 0:t.points)&&void 0!==n?n:[],i._pointId=0,i._pointIdUpdated=NaN,i}return F(n,e),n.prototype.getSizeDefault=function(){return 10},n.prototype.getOffsetDefault=function(){return 0},n.prototype.bind=function(t,n){var i=this._line;if(!i){(i=this._line=this.newLineOfAny()).visible=this._isShown;var r=this._options;this.initLine(i,r,t,n)}return i.attach(t.plotArea.container,n),this._pointIdUpdated=NaN,e.prototype.bind.call(this,t,n),this},n.prototype.initLine=function(t,e,n,i){var r=n.newFill(i,null==e?void 0:e.fill);this._fill=r,t.fill.copy(r);var o=n.newStroke(i,null==e?void 0:e.stroke);this._stroke=o,t.stroke.copy(o);var s=this.getSizeDefault(),a=n.newSize(i,null==e?void 0:e.size,s,s);this._size=a,t.points.size.set(a.x,a.y);var u=this.getOffsetDefault(),l=n.newOffset(i,e&&e.offset,u,u);this._offset=l,t.points.offset.set(l.x,l.y)},n.prototype.unbind=function(){var t=this._line;return t&&t.detach(),e.prototype.unbind.call(this),this},Object.defineProperty(n.prototype,"shape",{get:function(){return this._line},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t,this._pointId+=1},enumerable:!1,configurable:!0}),n.prototype.toDirty=function(){return this._pointId+=1,this},n.prototype.update=function(){return this.doUpdate(!0),this},n.prototype.onRender=function(){return this.doUpdate(!1),this},n.prototype.doUpdate=function(t){var e=this._line;if(e){var n=this._coordinate,i=n.x,r=n.y;if(i&&r){var o=this._pointId,s=o!==this._pointIdUpdated,a=n.isDirty(i,r),u=n.isTransformDirty(i,r);if(s||a||u)return this._pointIdUpdated=o,this.doUpdateLine(e,i,r),t&&ft.update(e),!0}}return!1},n.prototype.doUpdateLine=function(t,e,i){for(var r=t.points.values,o=r.length,s=0,a=this._points,u=NaN,l=NaN,h=NaN,c=NaN,p=0,f=a.length;p<f;p+=2){var d=a[p],y=a[p+1];null!=d&&null!=y&&(s<o?(r[s]=d,r[s+1]=y):r.push(d,y),s+=2,u!=u?(u=d,l=d,h=y,c=y):(u=Math.min(u,d),l=Math.max(l,d),h=Math.min(h,y),c=Math.max(c,y)))}r.length!==s&&(r.length=s),e.mapAll(r,0,s,2,0),i.mapAll(r,0,s,2,1),e.transform.mapAll(r,0,s,2,0),i.transform.mapAll(r,0,s,2,1),u!=u&&(u=0,l=0,h=0,c=0);var g=n.WORK_REGION||{xmin:0,xmax:0,ymin:0,ymax:0};n.WORK_REGION=g,this.adjustLineRegion(u,l,h,c,g),u=e.transform.map(e.map(g.xmin)),l=e.transform.map(e.map(g.xmax)),h=i.transform.map(i.map(g.ymin)),c=i.transform.map(i.map(g.ymax));var v=Math.abs(l-u),_=Math.abs(c-h),m=.5*(u+l),b=.5*(h+c);for(p=0,f=r.length;p<f;p+=2)r[p+0]-=m,r[p+1]-=b;t.lock(zt.UPLOADED),this.applyLine(t,e,i,v,_,m,b,r),t.unlock(zt.UPLOADED,!0)},n.prototype.adjustLineRegion=function(t,e,n,i,r){return r.xmin=t,r.xmax=e,r.ymin=n,r.ymax=i,r},n.prototype.applyLine=function(t,e,n,i,r,o,s,a){t.points.set(a),t.points.toFitted(i,r),t.size.set(i,r),t.transform.position.set(o,s)},n.prototype.updateRegion=function(){var t=this._pointId;if(this._regionPointId!==t){this._regionPointId=t;var e=this._points,n=this._domain,i=this._range;n.clear(),i.clear(),this.calcRegion(e,n,i)}},n.prototype.calcRegion=function(t,e,n){for(var i=0,r=t.length;i<r;i+=2){var o=t[i];null!=o&&e.add(o,o);var s=t[i+1];null!=s&&n.add(s,s)}},n.prototype.destroy=function(){var t=this._line;return t&&(this._line=null,t.detach(),t.destroy()),this._points.length=0,this._pointId=0,this._pointIdUpdated=NaN,e.prototype.destroy.call(this),this},n.prototype.hitTest=function(t,e){var i=this._line;if(i){var r=n.WORK;return r.set(t,e),i.toLocal(r,void 0,r),null!=i.contains(r.x,r.y)}return!1},n.prototype.calcHitPoint=function(t,e,i){var r=this._line;if(r){var o=n.WORK;return o.set(t,e),r.toLocal(o,void 0,o),i.shape=r,r.calcHitPoint(o.x,o.y,null,this.calcHitPointTestRange,this.calcHitPointHitTester,i)}return!1},n.prototype.calcHitPointTestRange=function(t,e,n,i,r,o,s,a,u){for(var l=Dy(a,t+n+r,2,0),h=0,c=l-1,p=c<<1;0<=c;c-=1,p-=2)if(a[p]<=t-n){h=c;break}return u[0]=h,u[1]=h!==l?l:Math.min(a.length<<1,l+1),u},n.prototype.calcHitPointHitTester=function(t,e,n,i,r,o,s,a,u,l,h,c,p,f){var d=f.shape;if(d.containsPointAbs(t,e,n,i,r,o,s,a,u,l,h)){var y=d.transform,g=y.position,v=y.scale;f.x=f.p0x=f.p1x=g.x+v.x*s,f.y=f.p0y=f.p1y=g.y+v.y*a,f.t=p,f.index=c;var _=t-(s+r),m=e-(a+o);return f.distance=Math.sqrt(_*_+m*m),!0}return!1},n.WORK=new t.Point,n}(W_),X_=function(t){function e(e){var n=t.call(this,e)||this;return n._barCount=-1,n._barIndex=-1,n._xcoordinateId=-1,n._xcoordinateTransformId=-1,n._isSizeAutomatic=!1!==(e&&e.size&&e.size.auto),n}return F(e,t),e.prototype.bind=function(e,n){return this._barCount=-1,this._barIndex=-1,this._xcoordinateId=-1,this._xcoordinateTransformId=-1,t.prototype.bind.call(this,e,n),this},e.prototype.initLine=function(e,n,i,r){t.prototype.initLine.call(this,e,n,i,r),this._padding=i.newPadding(r,n&&n.padding)},e.prototype.newLineOfAny=function(){return new Ap},e.prototype.getSizeDefault=function(){return 1},e.prototype.adjustLineRegion=function(e,n,i,r,o){return t.prototype.adjustLineRegion.call(this,e,n,Math.min(0,i),Math.max(0,r),o)},e.prototype.updateBarCountAndIndex=function(){if(this._barIndex<0||this._barCount<0){var t=0,n=0,i=this._container;if(i)for(var r=0,o=i.size();r<o;++r){var s=i.get(r);s===this&&(t=n),s instanceof e&&(n+=1)}return n=Math.max(1,n),this._barCount=n,this._barIndex=t,!0}return!1},e.prototype.applyLine=function(e,n,i,r,o,s,a,u){var l=e.points,h=l.offset,c=l.size,p=this._size,f=this._offset,d=this._padding;if(p&&f&&d){var y=n.id,g=n.transform.id;if(this.updateBarCountAndIndex()||this._xcoordinateId!==y||this._xcoordinateTransformId!==g){var v=this._barCount,_=this._barIndex;this._xcoordinateId=y,this._xcoordinateTransformId=g;var m=n.transform.map(n.map(0)),b=n.transform.map(n.map(p.x)),T=Math.abs(m-b)*(1-d.outer);if(v<=1)h.x=f.x,c.x=T;else{var w=T*(1-d.inner),E=w/v,O=E*(_+.5)+_*((T-w)/(v-1));h.x=f.x+O-.5*T,c.x=E}}}var C=c.y;Ot(C)||(C=[]);var S=C.length,x=h.y;Ot(x)||(x=[]);for(var D=x.length,I=0,A=i.transform.map(i.map(0))-a,R=0,P=u.length;R<P;R+=2,I+=1){var M=u[R+1]-A,k=Math.abs(M);I<S?C[I]=k:C.push(k);var L=-.5*M;I<D?x[I]=L:x.push(L)}C.length!==I&&(C.length=I),x.length!==I&&(x.length=I),h.y=x,c.y=C,t.prototype.applyLine.call(this,e,n,i,r,o,s,a,u)},e.prototype.calcSizeX=function(t){var e=this._points;if(2<e.length)for(var n=e.length,i=e[n-2],r=n-4;0<=r;r-=2){var o=e[r];if(null!=i&&null!=o)return Math.abs(i-o);i=o}return t},e.prototype.calcRegion=function(e,n,i){t.prototype.calcRegion.call(this,e,n,i);var r=this._size;if(r){var o=r.x;this._isSizeAutomatic&&(o=this.calcSizeX(o),r.x=o);var s=.5*o;n.set(n.from-s,n.to+s)}i.add(0,0)},e}(K_),Y_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newLineOfAny=function(){return new bp},e}(K_),q_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newLineOfAny=function(){return new Cp},e}(K_),Z_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newLineOfAny=function(){return new Ap},e}(K_),J_=function(t){function e(e){var n=t.call(this,e)||this;return n._sizeId=0,n}return F(e,t),e.prototype.newLineOfAny=function(){return new Qp},e.prototype.applyLine=function(e,n,i,r,o,s,a,u){var l=this._size,h=this._offset;l&&h&&this._sizeId!==l.y&&(this._sizeId=l.y,e.points.offset.y=h.y-.2*l.y),t.prototype.applyLine.call(this,e,n,i,r,o,s,a,u)},e}(K_),Q_=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newLineOfAny=function(){return new Kp},e}(J_),$_=function(e){function n(t){var n,i=e.call(this,t)||this;return i._line=null,i._options=t,i._points=null!==(n=null==t?void 0:t.points)&&void 0!==n?n:[],i._pointId=0,i._pointIdUpdated=NaN,i._centerX=0,i._centerY=0,i}return F(n,e),n.prototype.bind=function(t,n){var i,r=this._line;if(!r){var o=t.newStroke(n,null===(i=this._options)||void 0===i?void 0:i.stroke);this._stroke=o,(r=new Yc).stroke.copy(o),r.visible=this._isShown,this._line=r}return r.attach(t.plotArea.container,n),this._pointIdUpdated=NaN,e.prototype.bind.call(this,t,n),this},n.prototype.unbind=function(){var t=this._line;return t&&t.detach(),e.prototype.unbind.call(this),this},Object.defineProperty(n.prototype,"shape",{get:function(){return this._line},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"points",{get:function(){return this._points},set:function(t){this._points=t,this._pointId+=1},enumerable:!1,configurable:!0}),n.prototype.toDirty=function(){return this._pointId+=1,this},n.prototype.update=function(){return this.doUpdate(!0),this},n.prototype.onRender=function(){return this.doUpdate(!1),this},n.prototype.doUpdate=function(t){var e=this._line;if(e){var n=this._coordinate,i=n.x,r=n.y;if(i&&r){var o=this._pointId,s=o!==this._pointIdUpdated,a=n.isDirty(i,r),u=n.isTransformDirty(i,r);if(s||a||u)return this._pointIdUpdated=o,this.doUpdateLine(e,i,r,s||a),t&&ft.update(e),!0}}return!1},n.prototype.doUpdateLine=function(t,e,n,i){if(t.lock(zt.UPLOADED),i){for(var r=t.points.values,o=t.points.segments,s=r.length,a=o.length,u=0,l=0,h=this._points,c=NaN,p=NaN,f=NaN,d=NaN,y=0,g=h.length;y<g;y+=2){var v=h[y],_=h[y+1];if(null!=v&&null!=_)u<s?(r[u]=v,r[u+1]=_):r.push(v,_),u+=2,c!=c?(c=v,p=v,f=_,d=_):(c=Math.min(c,v),p=Math.max(p,v),f=Math.min(f,_),d=Math.max(d,_));else{var m=(y>>1)-l;l<a?o[l]=m:o.push(m),l+=1}}r.length!==u&&(r.length=u),o.length!==l&&(o.length=l),e.mapAll(r,0,u,2,0),n.mapAll(r,0,u,2,1),c!=c&&(c=0,p=0,f=0,d=0),c=e.map(c),p=e.map(p),f=n.map(f),d=n.map(d);var b=Math.abs(p-c),T=Math.abs(d-f),w=.5*(c+p),E=.5*(f+d);for(y=0,g=r.length;y<g;y+=2)r[y+0]-=w,r[y+1]-=E;t.points.set(r,o),t.points.toFitted(b,T),t.size.set(b,T),this._centerX=w,this._centerY=E}t.transform.position.set(e.transform.map(this._centerX),n.transform.map(this._centerY)),t.transform.scale.set(e.transform.scale,n.transform.scale),t.unlock(zt.UPLOADED,!0)},n.prototype.updateRegion=function(){var t=this._pointId;if(this._regionPointId!==t){this._regionPointId=t;var e=this._points,n=this._domain,i=this._range;if(n.clear(),i.clear(),null!=e)for(var r=0,o=e.length;r<o;r+=2){var s=e[r];null!=s&&n.add(s,s);var a=e[r+1];null!=a&&i.add(a,a)}}},n.prototype.destroy=function(){var t=this._line;return t&&(this._line=null,t.detach(),t.destroy()),this._points.length=0,this._pointId=0,this._pointIdUpdated=NaN,e.prototype.destroy.call(this),this},n.prototype.hitTest=function(t,e){var i=this._line;if(i){var r=n.WORK;return r.set(t,e),i.toLocal(r,void 0,r),null!=i.contains(r.x,r.y)}return!1},n.prototype.calcHitPoint=function(t,e,i){var r=this._line;if(r){var o=n.WORK;return o.set(t,e),r.toLocal(o,void 0,o),i.shape=r,r.calcHitPoint(o.x,o.y,this.toThreshold,this.calcHitPointTestRange,this.calcHitPointHitTester,i)}return!1},n.prototype.toThreshold=function(t,e){return 1/0},n.prototype.calcHitPointTestRange=function(t,e,n,i,r){var o=Dy(i,t,2,0);return r[0]=Math.max(0,o-1),r[1]=o,r},n.prototype.calcHitPointHitTester=function(t,e,n,i,r,o,s,a,u){if(n<=t&&t<r){var l=r-n;if(1e-4<Math.abs(l)){var h=(t-n)/l,c=t,p=i+h*(o-i),f=Math.abs(p-e);if(f<a){var d=u.shape.transform,y=d.position,g=y.x,v=y.y,_=d.scale,m=_.x,b=_.y;return u.x=g+m*c,u.y=v+b*p,u.p0x=g+m*n,u.p0y=v+b*i,u.p1x=g+m*r,u.p1y=v+b*o,u.t=h,u.index=s,u.distance=f,!0}}}return!1},n.WORK=new t.Point,n}(W_),tm=function(){function t(t,e,n,i){this._id=0,this._idUpdated=NaN,this._a=t,this._b=e,this._x0=n,this._y0=i}return Object.defineProperty(t.prototype,"a",{get:function(){return this._a},set:function(t){this._a!==t&&(this._id+=1,this._a=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"b",{get:function(){return this._b},set:function(t){this._b!==t&&(this._id+=1,this._b=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"x0",{get:function(){return this._x0},set:function(t){this._x0!==t&&(this._id+=1,this._x0=t)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"y0",{get:function(){return this._y0},set:function(t){this._y0!==t&&(this._id+=1,this._y0=t)},enumerable:!1,configurable:!0}),t.prototype.toDirty=function(){this._id+=1},t.prototype.isDirty=function(){return this._id!==this._idUpdated},t.prototype.toClean=function(){this._idUpdated=this._id},t.from=function(e){var n,i,r,o;return new t(null!==(n=null==e?void 0:e.a)&&void 0!==n?n:1,null!==(i=null==e?void 0:e.b)&&void 0!==i?i:1,null!==(r=null==e?void 0:e.x0)&&void 0!==r?r:0,null!==(o=null==e?void 0:e.y0)&&void 0!==o?o:0)},t}(),em=function(e){function n(t){var n=e.call(this,t)||this;return n._line=null,n._options=t,n._parameters=tm.from(t),n}return F(n,e),n.prototype.bind=function(t,n){var i,r=this._line;if(!r){var o=t.newStroke(n,null===(i=this._options)||void 0===i?void 0:i.stroke);this._stroke=o,(r=new Yc).stroke.copy(o),r.visible=this._isShown,this._line=r}return r.attach(t.plotArea.container,n),e.prototype.bind.call(this,t,n),this},n.prototype.unbind=function(){var t=this._line;return t&&t.detach(),e.prototype.unbind.call(this),this},Object.defineProperty(n.prototype,"shape",{get:function(){return this._line},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"parameters",{get:function(){return this._parameters},enumerable:!1,configurable:!0}),n.prototype.toDirty=function(){return this._parameters.toDirty(),this},n.prototype.update=function(){return this.doUpdate(!0),this},n.prototype.onRender=function(){return this.doUpdate(!1),this},n.prototype.doUpdate=function(t){var e=this._line,n=this._container;if(e&&n){var i=this._coordinate,r=i.x,o=i.y;if(r&&o)return this.doUpdateLine(e,n,r,o),t&&ft.update(e),!0}return!1},n.prototype.doUpdateLine=function(t,e,n,i){var r=t.points.values,o=t.points.segments,s=this._parameters,a=s.a,u=s.b,l=s.x0,h=s.y0,c=Math.abs(a),p=Math.abs(u),f=NaN,d=NaN,y=NaN,g=NaN,v=1e-5,_=e.plotArea.getContainerBounds();if(p<=c){var m=n.unmap(n.transform.unmap(_.x)),b=n.unmap(n.transform.unmap(_.x+_.width));f=Math.min(m,b),y=Math.max(m,b);var T=i.unmap(i.transform.unmap(_.y)),w=i.unmap(i.transform.unmap(_.y+_.height));if(d=Math.min(T,w),g=Math.max(T,w),v<p){var E=(x=u/a)*(T-h)+l,O=x*(w-h)+l,C=Math.min(E,O),S=Math.max(E,O);d=(D=1/x)*((f=Math.max(f,C))-l)+u*h,g=D*((y=Math.min(y,S))-l)+u*h}else f=l,y=l}else if(T=i.unmap(i.transform.unmap(_.y)),w=i.unmap(i.transform.unmap(_.y+_.height)),d=Math.min(T,w),g=Math.max(T,w),m=n.unmap(n.transform.unmap(_.x)),b=n.unmap(n.transform.unmap(_.x+_.width)),f=Math.min(m,b),y=Math.max(m,b),v<c){var x,D,I=(x=a/u)*(m-l)+h,A=x*(b-l)+h,R=Math.min(I,A),P=Math.max(I,A);f=(D=1/x)*((d=Math.max(d,R))-h)+a*l,y=D*((g=Math.min(g,P))-h)+a*l}else d=h,g=h;f=n.transform.map(n.map(f)),d=i.transform.map(i.map(d));var M=.5*(f+(y=n.transform.map(n.map(y)))),k=.5*(d+(g=i.transform.map(i.map(g)))),L=Math.abs(y-f),N=Math.abs(g-d);f-=M,d-=k,y-=M,g-=k,4!==r.length?(r.length=0,r.push(f,d,y,g)):(r[0]=f,r[1]=d,r[2]=y,r[3]=g),0<o.length&&(o.length=0),t.lock(zt.UPLOADED),t.points.set(r,o),t.points.toFitted(L,N),t.size.set(L,N),t.transform.position.set(M,k),t.unlock(zt.UPLOADED,!0)},n.prototype.updateRegion=function(){},n.prototype.destroy=function(){var t=this._line;return t&&(this._line=null,t.detach(),t.destroy()),e.prototype.destroy.call(this),this},n.prototype.hitTest=function(t,e){var i=this._line;if(i){var r=n.WORK;return r.set(t,e),i.toLocal(r,void 0,r),null!=i.contains(r.x,r.y)}return!1},n.prototype.calcHitPoint=function(t,e,i){var r=this._line;if(r){var o=n.WORK;return o.set(t,e),r.toLocal(o,void 0,o),i.shape=r,r.calcHitPoint(o.x,o.y,this.toThreshold,null,this.calcHitPointHitTester,i)}return!1},n.prototype.toThreshold=function(t,e){return 1/0},n.prototype.calcHitPointHitTester=function(t,e,n,i,r,o,s,a,u){if(n<=t&&t<r){var l=r-n;if(1e-4<Math.abs(l)){var h=(t-n)/l,c=t,p=i+h*(o-i),f=Math.abs(p-e);if(f<a){var d=u.shape.transform,y=d.position,g=y.x,v=y.y,_=d.scale,m=_.x,b=_.y;return u.x=u.p0x=u.p1x=g+m*c,u.y=u.p0y=u.p1y=v+b*p,u.t=h,u.index=s,u.distance=f,!0}}}return!1},n.WORK=new t.Point,n}(W_),nm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){var n;t.prototype.init.call(this,e);var i=this.plotArea;(null!==(n=null==e?void 0:e.mask)&&void 0!==n?n:this.theme.isOverflowMaskEnabled())&&(i.axis.container.mask=this.getOverflowMask())},e.prototype.getOverflowMask=function(){return null==this._overflowMask&&(this._overflowMask=new uo(this),this.reflowable.add(this._overflowMask),this.toDirty()),this._overflowMask},Object.defineProperty(e.prototype,"plotArea",{get:function(){var t;return null!==(t=this._plotArea)&&void 0!==t?t:this._plotArea=this.newPlotArea()},enumerable:!1,configurable:!0}),e.prototype.newPlotArea=function(){var t,e=null===(t=this._options)||void 0===t?void 0:t.plotArea;if(null!=e&&("primary"in e||"secondary"in e)){var n=new k_(this,e);return this.addChild(n),n}return n=new w_(this,e),this.addChild(n),n},e.prototype.destroy=function(){var e;this._destroyed||(null===(e=this._plotArea)||void 0===e||e.destroy(),t.prototype.destroy.call(this))},e.prototype.getType=function(){return"DChart"},e}(ao),im=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.isStorable=function(){return!1},e.prototype.isClear=function(){return!0},e}(Ky),rm=function(t){function e(e){var n=t.call(this)||this;return n._name=e,n}return F(e,t),Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),e.prototype.isStorable=function(){return!1},e.prototype.execute=function(){return Zy.getDocumentController().saveAs(this._name),!0},e}(Ky),om=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.isStorable=function(){return!1},e.prototype.execute=function(){return Zy.getDocumentController().save(),!0},e}(Ky),sm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e}(No),am=function(){function t(t,e,n){var i=this;this._parent=t,this._isDirty=!0;var r=n.controller;this._controller=r;var o=function(){i.onChange()};r.grid.on("change",o),r.target.on("change",o);var s=new sr;s.visible=!1,this._container=s,t.addChildAt(s,t.children.length-1),this._grid=this.toGrid(e,n.grid),this._gridParentWidth=t.width,this._gridParentHeight=t.height,this._gridParentScale=t.scale.x,this._gridSize=this.newGridSize(),this._target=this.toTarget(e,n.target)}return t.prototype.toGrid=function(t,e){var n;return null!=e?{major:this.toGridMajor(t,e.major),minor:this.toGridMinor(t,e.minor),size:null!==(n=e.size)&&void 0!==n?n:t.getSnapGridSize()}:{major:this.toGridMajor(t),minor:this.toGridMinor(t),size:t.getSnapGridSize()}},t.prototype.toGridMajor=function(t,e){var n,i,r,o,s;return null!=e?{interval:null!==(n=e.interval)&&void 0!==n?n:t.getSnapGridMajorInterval(),color:null!==(i=e.color)&&void 0!==i?i:t.getSnapGridMajorColor(),alpha:null!==(r=e.alpha)&&void 0!==r?r:t.getSnapGridMajorAlpha(),width:null!==(o=e.width)&&void 0!==o?o:t.getSnapGridMajorWidth(),style:null!==(s=e.style)&&void 0!==s?s:t.getSnapGridMajorStyle()}:{interval:t.getSnapGridMajorInterval(),color:t.getSnapGridMajorColor(),alpha:t.getSnapGridMajorAlpha(),width:t.getSnapGridMajorWidth(),style:t.getSnapGridMajorStyle()}},t.prototype.toGridMinor=function(t,e){var n,i,r,o;return null!=e?{color:null!==(n=e.color)&&void 0!==n?n:t.getSnapGridMinorColor(),alpha:null!==(i=e.alpha)&&void 0!==i?i:t.getSnapGridMinorAlpha(),width:null!==(r=e.width)&&void 0!==r?r:t.getSnapGridMinorWidth(),style:null!==(o=e.style)&&void 0!==o?o:t.getSnapGridMinorStyle()}:{color:t.getSnapGridMinorColor(),alpha:t.getSnapGridMinorAlpha(),width:t.getSnapGridMinorWidth(),style:t.getSnapGridMinorStyle()}},t.prototype.toTarget=function(t,e){var n,i,r,o;return null!=e?{color:null!==(n=e.color)&&void 0!==n?n:t.getSnapTargetColor(),alpha:null!==(i=e.alpha)&&void 0!==i?i:t.getSnapTargetAlpha(),width:null!==(r=e.width)&&void 0!==r?r:t.getSnapTargetWidth(),style:null!==(o=e.style)&&void 0!==o?o:t.getSnapTargetStyle()}:{color:t.getSnapTargetColor(),alpha:t.getSnapTargetAlpha(),width:t.getSnapTargetWidth(),style:t.getSnapTargetStyle()}},t.prototype.onChange=function(){this._isDirty=!0,ft.update(this._parent)},Object.defineProperty(t.prototype,"container",{get:function(){return this._container},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){return this._controller.serialize()},t.prototype.onResize=function(t,e,n,i){this._gridParentWidth===t&&this._gridParentHeight===e||(this._gridParentWidth=t,this._gridParentHeight=e,this._isDirty=!0,this.updateGridSize())},t.prototype.onScale=function(t,e,n,i){this._gridParentScale!==t&&(this._gridParentScale=t,this.updateGridSize())},t.prototype.updateGridSize=function(){var t=this.newGridSize();this._gridSize!==t&&(this._gridSize=t,this._isDirty=!0)},t.prototype.newGridSize=function(){return this._grid.size(this._controller.grid.size,this._gridParentWidth,this._gridParentHeight,this._gridParentScale)},t.prototype.onRender=function(){this._isDirty&&(this._isDirty=!1,this.updateAll())},t.prototype.updateAll=function(){var t=this._container,e=this._controller,n=e.grid.visible,i=e.target.visible;if(n||i){var r=this._gridParentWidth,o=this._gridParentHeight,s=.5*r,a=.5*o,u=lt.TOP,l=lt.LEFT,h=t.children,c=0;if(n){for(var p=this._grid,f=p.major,d=p.minor,y=f.interval,g=this._gridSize,v=g,_=1;v<r;v+=g,_+=1,c+=1){var m=_%y==0?f:d;this.update(t,h,c,v,a,u,r,o,m)}for(var b=g,T=1;b<o;b+=g,T+=1,c+=1)m=T%y==0?f:d,this.update(t,h,c,s,b,l,r,o,m)}if(i)for(var w=e.target.values,E=this._target,O=0,C=w.length;O<C;O+=1,c+=1){var S=w[O],x=S.position;S.type===py.VERTICAL?this.update(t,h,c,x,a,u,r,o,E):this.update(t,h,c,s,x,l,r,o,E)}for(O=c,C=h.length;O<C;++O)h[O].visible=!1;t.visible=!0}else t.visible=!1},t.prototype.update=function(t,e,n,i,r,o,s,a,u){var l=null;n<e.length?((l=e[n]).lock(zt.UPLOADED),l.points.position=o,l.transform.position.set(i,r),l.stroke.set(!0,u.color,u.alpha,u.width,void 0,void 0,u.style),l.size.set(s,a),l.visible=!0,l.unlock(zt.UPLOADED,!0)):((l=new pe).lock(zt.UPLOADED),l.points.position=o,l.transform.position.set(i,r),l.stroke.set(!0,u.color,u.alpha,u.width,void 0,void 0,u.style),l.size.set(s,a),l.visible=!0,l.unlock(zt.UPLOADED,!0),l.attach(t))},t}(),um=function(t){function e(e){var n=t.call(this,e)||this;return n._snap=n.toSnap(n.theme,e.snap),n}return F(e,t),e.prototype.toSnap=function(t,e){return e?new am(this,t,e):null},Object.defineProperty(e.prototype,"snap",{get:function(){return this._snap},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"shape",{get:function(){var t;return null!==(t=this._shape)&&void 0!==t?t:this._shape=this.newShape()},enumerable:!1,configurable:!0}),e.prototype.newShape=function(){return new sm(this)},e.prototype.serialize=function(t,e){var n,i=new ly,r=[],o=this._background,s=o.color,a=o.alpha;return{version:1,id:t,name:this.name,label:this.label,width:this.width,height:this.height,category:this.category,summary:this.summary,description:this.description,background:{color:St(s)?s:16777215,alpha:St(a)?a:0},tile:this._tile.serialize(),resources:i.resources,data:i.data,pieces:i.pieces,layers:this._layer.serialize(i,r),items:r,snap:null===(n=this._snap)||void 0===n?void 0:n.serialize(),thumbnail:null==e?void 0:e.serialize()}},e.prototype.onResize=function(e,n,i,r){var o=this._snap;null!=o&&o.onResize(e,n,i,r),t.prototype.onResize.call(this,e,n,i,r)},e.prototype.onScale=function(e,n,i,r){var o=this._snap;null!=o&&o.onScale(e,n,i,r),t.prototype.onScale.call(this,e,n,i,r)},e.prototype.render=function(e){var n=this._snap;null!=n&&n.onRender(),t.prototype.render.call(this,e)},e.prototype.getType=function(){return"DDiagramCanvasEditor"},e}(Mo),lm=function(){function t(t,e,n){this._snapshot=t,this._isEnabled=this.toIsEnabled(e,n),this._options=this.toCreateAsUrlOptions(e,n)}return t.prototype.toIsEnabled=function(t,e){var n;return null!==(n=null==e?void 0:e.enable)&&void 0!==n?n:t.isThumbnailEnabled()},t.prototype.toSize=function(t,e){return void 0!==e?e:t.getThumbnailSize()},t.prototype.toCleanup=function(t,e){var n,i;return null==e||!0===e?{snap:!0,background:!0}:!1===e?{snap:!1,background:!1}:{snap:null===(n=e.snap)||void 0===n||n,background:null===(i=e.background)||void 0===i||i}},t.prototype.toCreateAsUrlOptions=function(t,e){return{size:this.toSize(t,null==e?void 0:e.size),cleanup:this.toCleanup(t,null==e?void 0:e.cleanup)}},Object.defineProperty(t.prototype,"enable",{get:function(){return this._isEnabled},set:function(t){this._isEnabled=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._options.size},set:function(t){this._options.size=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cleanup",{get:function(){return this._options.cleanup},enumerable:!1,configurable:!0}),t.prototype.serialize=function(){if(this._isEnabled)return this._snapshot.createAsUrl(this._options)},t}(),hm=function(t){function e(e){var n=t.call(this,e)||this;n._isChanged=!1,n._isChanged=!1,Zy.getCommandController().on("dirty",(function(){!0!==n._isChanged&&(n._isChanged=!0,n.emit("change",n))}));var i=n.theme;return n._snapper=new vy(n,i,null==e?void 0:e.snapper),n._thumbnail=new lm(n._snapshot,i,null==e?void 0:e.thumbnail),n}return F(e,t),Object.defineProperty(e.prototype,"thumbnail",{get:function(){return this._thumbnail},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"snapper",{get:function(){return this._snapper},enumerable:!1,configurable:!0}),e.prototype.toMode=function(t){return(null==t?void 0:t.mapping)?Hn.EDITOR_DATA_MAPPED:Hn.EDITOR},e.prototype.newCanvas=function(t){return new um(this.toCanvasOptions(t))},e.prototype.toCanvasOptions=function(t){var e=this.toCanvasBaseOptions(t),n=this._snapper,i=e.snap;return null==i?e.snap={controller:n}:null==i.controller&&(i.controller=n),e},e.prototype.serialize=function(){var t=this.canvas,e=this._serialized;if(null!=t&&null!=e){this.emit("serializing",t,this);try{var n=t.serialize(e.id,this._thumbnail);return this.emit("serialized",t,null,this),n}catch(e){return this.emit("serialized",t,"exception",this),null}}return null},e.prototype.save=function(){var t=this,e=this.serialize();if(null!=e){var n=this._controller;if(n){var i=Dr.toSimple(e);return this.emit("saving",i,this),n.save(i).then((function(n){t._isChanged=!1,e.id=n,t._serialized=e,t.emit("change",t),t.emit("saved",null,t)}),(function(e){t.emit("saved",e,t)}))}return this.emit("saved","no-controller",this),Promise.reject()}return this.emit("saved",null,this),Promise.resolve()},e.prototype.saveAs=function(t){var e=this,n=this.serialize();if(null!=n){var i=this._controller;if(i){n.id=void 0,n.name=t;var r=Dr.toSimple(n);return this.emit("saving",r,this),i.save(r).then((function(i){e._isChanged=!1,n.id=i,e._serialized=n;var r=e.canvas;null!=r&&(r.name=t),e.emit("change",e),e.emit("saved",null,e)}),(function(t){e.emit("saved",t,e)}))}return this.emit("saved","no-controller",this),Promise.reject("no-controller")}return this.emit("saved",null,this),Promise.resolve()},e.prototype.delete=function(){var t=this,e=this._serialized;if(e&&null!=e.id){var n=this._controller;return n?(this.emit("deleting",this),n.delete(e.id).then((function(){var e=t.set(null);return t.emit("deleted",null,t),e}),(function(e){return t.emit("deleted",e,t),Promise.reject(e)}))):(this.emit("deleted","no-controller",this),Promise.reject("no-controller"))}return this.set(null),this.emit("deleted",null,this),Promise.resolve(null)},e.prototype.create=function(t){return this.set({version:1,id:void 0,name:t.name,label:t.label,width:t.width,height:t.height,category:t.category,summary:t.summary,description:t.description,background:t.background,resources:[],data:[],layers:[[this.theme.getBaseLayerLabel()]],items:[],snap:void 0})},e.prototype.onSet=function(e,n){t.prototype.onSet.call(this,e,n);var i=e.snap,r=this._snapper;null!=i?r.deserialize(i):r.reset(),this._isAmbient&&(r.target.visible=!1,r.grid.visible=!1),this._isChanged=!1,this.emit("change",this)},e.prototype.onUnset=function(){t.prototype.onUnset.call(this),this._isChanged=!1,this.emit("change",this)},e.prototype.open=function(t){var e=this,n=this._controller;return n?(this.emit("opening",this),n.get(t).then((function(t){var n=e.set(Dr.toSerialized(t));return e.emit("opened",null,e),n}),(function(t){return e.emit("opened",t,e),Promise.reject(t)}))):(this.emit("opened","no-controller",this),Promise.reject("no-controller"))},e.prototype.close=function(){return this.set(null)},e.prototype.isChanged=function(){return this._isChanged||this.isNew()},e.prototype.isNew=function(){var t=this._serialized;return null!=t&&null==t.id},e.prototype.getName=function(){var t=this._serialized;return null!=t?t.name:null},e.prototype.getType=function(){return"DDiagramEditor"},e}(wo),cm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogConfirmMessage"},e}(Zf),pm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newContentChildren=function(e,n){var i=t.prototype.newContentChildren.call(this,e,n);return i.push(this.message),i},e.prototype.toMessage=function(t,e){var n=null==e?void 0:e.message;return null!=n?xt(n)||Ct(n)?this.newMessage(this.toMessageOptions(n)):n instanceof ao?n:this.newMessage(this.toMessageOptionsMerged(n,t.getMessage())):this.newMessage(this.toMessageOptions(t.getMessage()))},e.prototype.toMessageOptionsMerged=function(t,e){var n=t.text;return null==n&&(n={},t.text=n),void 0===n.value&&(n.value=e),t},e.prototype.toMessageOptions=function(t){return{text:{value:t}}},e.prototype.newMessage=function(t){return new cm(t)},Object.defineProperty(e.prototype,"message",{get:function(){var t=this._message;return null==t&&(t=this.toMessage(this.theme,this._options),this._message=t),t},enumerable:!1,configurable:!0}),e.prototype.getResolvedValue=function(){},e.prototype.getType=function(){return"DDialogConfirm"},e}(Ka),fm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogConfirmDelete"},e}(pm),dm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogConfirmDiscard"},e}(pm),ym=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogMessage"},e}(pm),gm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDialogProcessingMessage"},e}(cm),vm=function(t){function e(e){var n,i=t.call(this,e)||this;i._isDone=!0,i._startTime=0;var r=i.theme,o=null==e?void 0:e.delay;i._delayDone=null!==(n=null==o?void 0:o.done)&&void 0!==n?n:r.getDoneDelay();var s=null==o?void 0:o.close;return i._delayClose=void 0!==s?s:r.getCloseDelay(),i._messageText=i.message.text.value,i}return F(e,t),e.prototype.newMessage=function(t){return new gm(t)},e.prototype.onOpen=function(){this._isDone=!1,this._startTime=Date.now();var e=this._timeoutId;null!=e&&clearTimeout(e);var n=this._closeTimeoutId;null!=n&&clearTimeout(n);var i=this.message;i.text=this._messageText,i.state.removeAll(vt.SUCCEEDED,vt.FAILED);var r=this._footer;null!=r&&r.hide(),t.prototype.onOpen.call(this)},e.prototype.onDone=function(t){var e=this;null!=t?this._closeTimeoutId=window.setTimeout((function(){e.close()}),t):this.close()},e.prototype.onResolved=function(t){null!=t&&(this.message.text=t),this.message.state.set(vt.SUCCEEDED,vt.FAILED);var e=this._delayClose;if(null!=e)this.onDone(e);else{var n=this._footer;null!=n?n.show():this.close()}},e.prototype.onRejected=function(t){null!=t&&(this.message.text=t),this.message.state.set(vt.FAILED,vt.SUCCEEDED);var e=this._footer;null!=e?e.show():this.onDone(this._delayClose)},e.prototype.resolve=function(t){var e=this;if(!this._isDone){this._isDone=!0;var n=Date.now()-this._startTime,i=this._delayDone-n;0<i?this._timeoutId=window.setTimeout((function(){e._timeoutId=void 0,e.onResolved(t)}),i):this.onResolved(t)}},e.prototype.reject=function(t){var e=this;if(!this._isDone){this._isDone=!0;var n=Date.now()-this._startTime,i=this._delayDone-n;0<i?this._timeoutId=window.setTimeout((function(){e._timeoutId=void 0,e.onRejected(t)}),i):this.onRejected(t)}},e.prototype.onCloseOn=function(){this._isDone&&t.prototype.onCloseOn.call(this)},e.prototype.getType=function(){return"DDialogProcessing"},e}(pm),_m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onOpen=function(){var e=Zy.getDocumentController().getName();null!=e&&(this.input.value=e),t.prototype.onOpen.call(this)},e.prototype.onOk=function(e){t.prototype.onOk.call(this,e);var n=Zy.getCommandController();xt(e)?n.push(new rm(e)):e.then((function(t){n.push(new rm(t))}))},e.prototype.getType=function(){return"DDialogSaveAs"},e}(pu),mm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DDropdown"},e}(dg),bm=function(t){function e(e){var n=t.call(this,e)||this;return n.on(cr.down,(function(t){n.state.isActionable&&n.onSelect(t)})),n}return F(e,t),e.prototype.onSelect=function(t){this.emit("select",this)},e.prototype.onKeyDown=function(e){return no.isActivateKey(e)&&this.onKeyDownActivate(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyDownActivate=function(t){return!(!this.state.isActionable||!this.state.isFocused||(this.onSelect(t),0))},e.prototype.getType=function(){return"DExpandableHeader"},e}(Zf),Tm=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(t){var n=this;e.prototype.init.call(this,t);var i=this.theme,r=this.toHeader(i,t);this._header=r,r.on("select",(function(){n.toggle()})),this.addChild(r);var o=this.toBody(i,t);this._body=o,this.addChild(o),this.state.isActive?this.onActivated():this.onDeactivated()},n.prototype.toHeader=function(e,n){return n&&n.header?n.header instanceof t.DisplayObject?n.header:this.newHeader(e,n.header):this.newHeader(e)},n.prototype.newHeader=function(t,e){return new bm(e)},n.prototype.toBody=function(t,e){return e.body},n.prototype.open=function(){this.state.isActive=!0},n.prototype.close=function(){this.state.isActive=!1},n.prototype.toggle=function(){this.state.isActive=!this.state.isActive},n.prototype.onActivated=function(){var t=this._body;t instanceof ao?t.show():t.visible=!0},n.prototype.onDeactivated=function(){var t=this._body;t instanceof ao?t.hide():t.visible=!1},n.prototype.onStateChange=function(t,n){e.prototype.onStateChange.call(this,t,n),t.isActive?n.isActive||this.onActivated():n.isActive&&this.onDeactivated()},n.prototype.getType=function(){return"DExpandable"},n}(ta),wm={INITIAL:0,STARTED:1,RESOLVED:2,REJECTED:3},Em=function(){function t(t,e){var n,i,r,o,s,a,u;this._parent=t,this._state=wm.INITIAL,this._startTime=0;var l=this.theme,h=null==e?void 0:e.delay;this._delayDone=null!==(n=null==h?void 0:h.done)&&void 0!==n?n:l.getProcessDoneDelay();var c=null==h?void 0:h.close;this._delayClose=void 0!==c?c:l.getProcessCloseDelay();var p=null==e?void 0:e.text;this._isTextEnabled=null!==(i=null==p?void 0:p.enabled)&&void 0!==i?i:l.isProcessTextEnabled(),this._textValue=null!==(r=null==p?void 0:p.value)&&void 0!==r?r:l.newProcessTextValue();var f=null==e?void 0:e.image;this._isImageEnabled=null!==(o=null==f?void 0:f.enabled)&&void 0!==o?o:l.isProcessImageEnabled(),this._imageIndex=null!==(s=null==f?void 0:f.index)&&void 0!==s?s:l.getProcessImageIndex(),this._imageSource=null!==(a=null==f?void 0:f.source)&&void 0!==a?a:l.newProcessImageSource(),this._imageRotation=null!==(u=null==f?void 0:f.rotation)&&void 0!==u?u:l.newProcessImageRotation(),this._wasReadOnly=!1}return t.prototype.start=function(){var t=this._state;return t===wm.INITIAL?(this._state=wm.STARTED,this.onBegin()):t!==wm.RESOLVED&&t!==wm.REJECTED||(this._state=wm.STARTED,this.onEnd(),this.onBegin()),this},t.prototype.onBegin=function(){this._startTime=Date.now();var t=this._timeoutId;null!=t&&clearTimeout(t);var e=this._closeTimeoutId;null!=e&&clearTimeout(e);var n=this._parent,i=n.state;if(i.lock(),i.ticker.remove(vt.PROCESSING).add(vt.PROCESSING,32),i.removeAll(vt.SUCCEEDED,vt.FAILED),this._wasReadOnly=i.isReadOnly,this._wasReadOnly||i.add(vt.READ_ONLY),i.unlock(),this._isTextEnabled){this._textValueBackup=n.text.value;var r=this._textValue;void 0!==r&&(n.text=r)}if(this._isImageEnabled){var o=n.image.get(this._imageIndex);if(null!=o){this._imageSourceBackup=o.source,this._imageRotationBackup=o.rotation;var s=this._imageSource;void 0!==s&&(o.source=s);var a=this._imageRotation;void 0!==a&&(o.rotation=a)}}},t.prototype.end=function(){var t=this._state;return t!==wm.STARTED&&t!==wm.RESOLVED&&t!==wm.REJECTED||(this._state=wm.INITIAL,this.onEnd()),this},t.prototype.onEnd=function(){var t=this._timeoutId;null!=t&&clearTimeout(t);var e=this._closeTimeoutId;null!=e&&clearTimeout(e);var n=this._parent,i=n.state;if(i.lock(),i.ticker.remove(vt.PROCESSING),i.removeAll(vt.SUCCEEDED,vt.FAILED),this._wasReadOnly||i.remove(vt.READ_ONLY),i.unlock(),this._isTextEnabled&&(n.text=this._textValueBackup),this._isImageEnabled){var r=n.image.get(this._imageIndex);null!=r&&(r.source=this._imageSourceBackup,r.rotation=this._imageRotationBackup)}},t.prototype.resolve=function(t){var e=this;if(this._state===wm.STARTED){this._state=wm.RESOLVED;var n=Date.now()-this._startTime,i=this._delayDone-n;0<i?this._timeoutId=window.setTimeout((function(){e._timeoutId=void 0,e.onResolved(t)}),i):this.onResolved(t)}},t.prototype.onResolved=function(t){var e=this._parent;this._isTextEnabled&&null!=t&&(e.text=t);var n=e.state;n.lock(),n.ticker.remove(vt.PROCESSING),n.add(vt.SUCCEEDED),n.remove(vt.FAILED),this._wasReadOnly||n.remove(vt.READ_ONLY),n.unlock(),this.onDone(this._delayClose)},t.prototype.reject=function(t){var e=this;if(this._state===wm.STARTED){this._state=wm.REJECTED;var n=Date.now()-this._startTime,i=this._delayDone-n;0<i?this._timeoutId=window.setTimeout((function(){e._timeoutId=void 0,e.onRejected(t)}),i):this.onRejected(t)}},t.prototype.onRejected=function(t){var e=this._parent;this._isTextEnabled&&null!=t&&(e.text=t);var n=e.state;n.lock(),n.ticker.remove(vt.PROCESSING),n.add(vt.FAILED),n.remove(vt.SUCCEEDED),this._wasReadOnly||n.remove(vt.READ_ONLY),n.unlock(),this.onDone(this._delayClose)},t.prototype.onDone=function(t){var e=this;null!=t?this._closeTimeoutId=window.setTimeout((function(){e._closeTimeoutId=void 0,e.end()}),t):this.end()},t.prototype.getType=function(){return"DIndicatorProcessing"},Object.defineProperty(t.prototype,"theme",{get:function(){return it.get(this.getType())},enumerable:!1,configurable:!0}),t}(),Om=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.createInput=function(t){return new ou(t)},e}(ug),Cm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newUtil=function(){return new Ny(this,this.newOperation(),this.theme,this._options)},e.prototype.getType=function(){return"DInputTextArea"},e}(nu),Sm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DLayoutBoard"},e}(ao),xm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DListItemAmbient"},e}(Vg),Dm=function(){function t(t){void 0===t&&(t=256),this._tileSize=t}return t.prototype.getTileSize=function(){return this._tileSize},t.prototype.lonLatToMeters=function(e,n){var i=t.CIRCUMFERENCE_HALF;return n.x=e.x*i/180,n.y=Math.log(Math.tan((90+e.y)*Math.PI/360))*i/Math.PI,n},t.prototype.metersToLonLat=function(e,n){var i=t.CIRCUMFERENCE_HALF;return n.x=e.x/i*180,n.y=360*Math.atan(Math.exp(e.y*Math.PI/i))/Math.PI-90,n},t.prototype.pixelsToMeters=function(e,n,i,r){var o=this.toResolution(n,i),s=t.CIRCUMFERENCE_HALF;return r.x=e.x*o-s,r.y=s-e.y*o,r},t.prototype.metersToPixels=function(e,n,i,r){var o=this.toResolution(n,i),s=t.CIRCUMFERENCE_HALF;return r.x=(e.x+s)/o,r.y=(s-e.y)/o,r},t.prototype.pixelsToTile=function(t,e,n){return n.x=Math.ceil(t.x/e)-1,n.y=Math.ceil(t.y/e)-1,n},t.prototype.metersToTile=function(e,n,i){var r=t.CIRCUMFERENCE_HALF,o=1<<n;return i.x=Math.ceil(.5*(e.x/r+1)*o)-1,i.y=Math.ceil(.5*(1-e.y/r)*o)-1,i},t.prototype.lonLatToTile=function(t,e,n){return this.metersToTile(this.lonLatToMeters(t,n),e,n)},t.prototype.lonLatToPixels=function(t,e,n,i){return this.metersToPixels(this.lonLatToMeters(t,i),e,n,i)},t.prototype.pixelsToLonLat=function(t,e,n,i){return this.metersToLonLat(this.pixelsToMeters(t,e,n,i),i)},t.prototype.tileToPixels=function(t,e,n){return n.x=t.x*e,n.y=t.y*e,n},t.prototype.tileToMeters=function(e,n,i){var r=this.toResolutionMeter(n),o=t.CIRCUMFERENCE_HALF;return i.x=e.x*r+o,i.y=o-e.y*r,i},t.prototype.toResolutionMeter=function(e){return 2*t.CIRCUMFERENCE_HALF/(1<<e)},t.prototype.toResolution=function(e,n){return 2*t.CIRCUMFERENCE_HALF/(n<<e)},t.prototype.toTileCount=function(t){return 1<<t},t.prototype.toTileCode=function(t,e,n){return(e<<t)+n},t.CIRCUMFERENCE_HALF=6378137*Math.PI,t}(),Im=function(){function t(){}return Object.defineProperty(t,"DEFAULT",{get:function(){return null==this._default&&(this._default=new Dm),this._default},enumerable:!1,configurable:!0}),t}(),Am=function(){function e(e,n,i,r,o,s){this.tx=n,this.ty=i;var a=new t.Sprite(t.Texture.EMPTY);a.parent=e,a.position.set(r,o),a.scale.set(s,s),this._sprite=a}return e.prototype.load=function(e,n){var i=t.Texture.from(e,{resolution:1});this._sprite.texture=i,i.valid?n():i.on("update",n)},e.prototype.transform=function(t,e,n){var i=this._sprite;i.position.set(t,e),i.scale.set(n,n)},Object.defineProperty(e.prototype,"loaded",{get:function(){return this._sprite.texture.valid},enumerable:!1,configurable:!0}),e.prototype.render=function(t){var e=this._sprite;e.updateTransform(),e.render(t)},e.prototype.destroy=function(){var e=this._sprite,n=e.texture,i=n.baseTexture.resource,r=null;i instanceof t.resources.BaseImageResource&&i.source instanceof HTMLImageElement&&(r=i.source),n.destroy(!0),e.destroy(),r&&(r.src="")},e}(),Rm=function(){function e(t,e,n,i,r,o){var s=this;this._parent=t,this._builder=e,this._onLoaded=o,this._isOnLoadedCalled=!1,this._isOnLoadedAllowed=!0,this._onLoadedBound=function(){s.onLoaded()},this._tz=n,this._lon0=NaN,this._lat0=NaN,this._lon1=NaN,this._lat1=NaN,this._tiles=new Map,this._renderTileBound=function(t){s.renderTile(t)},this._txmin=NaN,this._txmax=NaN,this._tymin=NaN,this._tymax=NaN,this._deleteTileBound=function(t,e,n){s.deleteTile(t,e,n)},this._destroyTileBound=function(t){s.destroyTile(t)},this._updateLoadingStateForEach=function(t){t.loaded||(s._isLoaded=!1)},this._tileCount=r.toTileCount(n),this._tileScaleRelative=1/this._tileCount,this._tileScale=i.scale*this._tileScaleRelative,this._tileSize=r.getTileSize()*i.scale,this._mapping=i,this._coordinate=r,this._isLoaded=!0}return e.prototype.newTile=function(t,e,n,i,r){return new Am(this._parent,t,e,n,i,r)},e.prototype.renderTile=function(t){t.render(this._renderer)},Object.defineProperty(e.prototype,"tz",{get:function(){return this._tz},enumerable:!1,configurable:!0}),e.prototype.render=function(t){this._renderer=t,this._tiles.forEach(this._renderTileBound)},e.prototype.move=function(t,n,i,r){var o=this._lon0,s=this._lat0,a=this._lon1,u=this._lat1;if(o!==t||s!==n||a!==i||u!==r){this._lon0=t,this._lat0=n,this._lon1=i,this._lat1=r;var l=this._tz,h=this._coordinate,c=e.WORK;c.set(t,n),h.lonLatToTile(c,l,c);var p=c.x,f=c.y;c.set(i,r),h.lonLatToTile(c,l,c);var d=c.x,y=c.y,g=this._tileCount,v=Math.max(0,p),_=Math.min(g-1,d),m=Math.max(0,f),b=Math.min(g-1,y),T=v-this._txmin,w=_-this._txmax,E=m-this._tymin,O=b-this._tymax,C=T!=T||T<0||1<T,S=w!=w||0<w||w<-1,x=E!=E||E<0||1<E,D=O!=O||0<O||O<-1;if(C||S||x||D){C?this._txmin=v:v=this._txmin,S?this._txmax=_:_=this._txmax,x?this._tymin=m:m=this._tymin,D?this._tymax=b:b=this._tymax,this._tiles.forEach(this._deleteTileBound);var I=v+_>>1,A=m+b>>1,R=Math.max(I-v,_-I),P=Math.max(A-m,b-A),M=Math.max(R,P);this.toOffset(c);var k=c.x,L=c.y;this._isOnLoadedCalled=!1,this._isOnLoadedAllowed=!1,this.loadTile(l,I,A,k,L,c);for(var N=1;N<=M;++N){var B=I-N;v<=B&&this.loadTilesY(l,B,A,N,m,b,k,L,c);var z=I+N;z<=_&&this.loadTilesY(l,z,A,N,m,b,k,L,c);var U=A-N;m<=U&&this.loadTilesX(l,I,N-1,v,_,U,k,L,c);var j=A+N;j<=b&&this.loadTilesX(l,I,N-1,v,_,j,k,L,c)}this._isOnLoadedAllowed=!0,this._isOnLoadedCalled&&this.onLoaded()}}},e.prototype.loadTilesX=function(t,e,n,i,r,o,s,a,u){this.loadTile(t,e,o,s,a,u);for(var l=1;l<=n;++l){var h=e-l;i<=h&&this.loadTile(t,h,o,s,a,u);var c=e+l;c<=r&&this.loadTile(t,c,o,s,a,u)}},e.prototype.loadTilesY=function(t,e,n,i,r,o,s,a,u){this.loadTile(t,e,n,s,a,u);for(var l=1;l<=i;++l){var h=n-l;r<=h&&this.loadTile(t,e,h,s,a,u);var c=n+l;c<=o&&this.loadTile(t,e,c,s,a,u)}},e.prototype.loadTile=function(t,e,n,i,r,o){var s=this._coordinate.toTileCode(t,e,n),a=this._tiles,u=a.get(s);null==u&&(this.toTilePosition(e,n,i,r,o),u=this.newTile(e,n,o.x,o.y,this._tileScale),a.set(s,u),u.load(this._builder(t,e,n),this._onLoadedBound),this._isLoaded=!1)},e.prototype.toTilePosition=function(t,e,n,i,r){var o=this._tileSize,s=this._tileScaleRelative;return r.set(t,e),this._coordinate.tileToPixels(r,o,r),r.set(r.x*s+n,r.y*s+i),r},e.prototype.toOffset=function(t){var e=this._parent,n=this._mapping,i=this._tileSize;return t.set(-n.x*i+.5*e.width,-n.y*i+.5*e.height),t},e.prototype.deleteTile=function(t,e,n){var i=t.tx,r=t.ty;(i<this._txmin||this._txmax<i||r<this._tymin||this._tymax<r)&&(n.delete(e),t.destroy())},e.prototype.destroy=function(){var t=this._tiles;t.forEach(this._destroyTileBound),t.clear()},e.prototype.destroyTile=function(t){t.destroy()},e.prototype.updateLoadingState=function(){this._isLoaded=!0,this._tiles.forEach(this._updateLoadingStateForEach)},e.prototype.onLoaded=function(){this._isOnLoadedAllowed?this._onLoaded():this._isOnLoadedCalled=!0},Object.defineProperty(e.prototype,"loaded",{get:function(){return this._isLoaded||this.updateLoadingState(),this._isLoaded},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mapping",{get:function(){return this._mapping},set:function(t){var n=this,i=this._coordinate,r=t.scale*this._tileScaleRelative,o=i.getTileSize()*t.scale;this._tileScale=r,this._tileSize=o,this._mapping=t;var s=e.WORK;this.toOffset(s);var a=s.x,u=s.y;this._tiles.forEach((function(t){n.toTilePosition(t.tx,t.ty,a,u,s),t.transform(s.x,s.y,r)}))},enumerable:!1,configurable:!0}),e.WORK=new t.Point,e}(),Pm=function(e){function n(t){var n=e.call(this)||this,i=t.canvas;n._canvas=i,n._builder=t.builder;var r=t.mapping;n._mapping=r;var o=t.coordinate;n._coordinate=o,n._mappingInternal=n.toMapping(i,r,o),n._z=NaN,n._tz=NaN,n._minZ=t.plane.min,n._maxZ=t.plane.max,n._planes=[],n._onLoadedBound=function(){n.onLoaded()},n._fitBound=function(){n._fitBoundTimeout=void 0,n.fit()},n._fitThrottle=t.plane.throttle;var s=function(){n.fitThrottled()};return n._fitThrottledBound=s,i.on("scale",s),i.on("move",s),i.snippet.add(n,!0),n}return F(n,e),Object.defineProperty(n.prototype,"coordinate",{get:function(){return this._coordinate},enumerable:!1,configurable:!0}),n.prototype.fitThrottled=function(){null==this._fitBoundTimeout&&(this._fitBoundTimeout=window.setTimeout(this._fitBound,this._fitThrottle))},n.prototype.toMapping=function(t,e,i){var r=n.WORK_LONLAT,o=i.getTileSize();r.set(e.from.lon,e.from.lat),i.lonLatToPixels(r,0,o,r);var s=r.x,a=r.y;r.set(e.to.lon,e.to.lat),i.lonLatToPixels(r,0,o,r);var u=r.x,l=r.y,h=Math.abs(u-s),c=Math.abs(l-a),p=1e-7,f=1;return p<h?f=p<c?Math.max(t.width/h,t.height/c):t.width/h:p<c&&(f=t.height/c),{scale:f,x:.5*(u+s)/o,y:.5*(l+a)/o}},Object.defineProperty(n.prototype,"mapping",{get:function(){return this._mapping},set:function(t){var e=this._mappingInternal,n=this.toMapping(this._canvas,t,this._coordinate),i=1e-7;if(i<Math.abs(e.scale-n.scale)||i<Math.abs(e.x-n.x)||i<Math.abs(e.y-n.y)){this._mappingInternal=n;for(var r=this._planes,o=0,s=r.length;o<s;++o){var a=r[o];a&&(a.mapping=n)}ft.update(this._canvas),this._fitThrottledBound()}},enumerable:!1,configurable:!0}),n.prototype.newPlane=function(t){return new Rm(this._canvas,this._builder,t,this._mappingInternal,this._coordinate,this._onLoadedBound)},n.prototype.render=function(t){for(var e=this._tz,n=this._planes,i=0;i<e;++i)null!=(r=n[i])&&r.render(t);for(i=n.length-1;e<i;--i){var r;null!=(r=n[i])&&r.render(t)}var o=n[e];null!=o&&o.render(t)},n.prototype.toTileZ=function(t){return Math.min(this._maxZ,Math.max(this._minZ,Math.floor(t)))},n.prototype.updateTransform=function(){},n.prototype.toZ=function(t){return Math.log(this._mappingInternal.scale*t)/Math.log(2)},n.prototype.move=function(t,e,n,i,r){var o=this._planes,s=this.toZ(t);if(this._z!==s){this._z=s;var a=this.toTileZ(s);if(this._tz!==a){this._tz=a;var u=o[a];null==u&&(u=this.newPlane(a),o[a]=u)}}var l=o[this._tz];return null!=l&&l.move(e,n,i,r),this},n.prototype.fit=function(){var t=this._canvas;if(null!=t){var e=t.parent;if(null!=e){var i=t.scale,r=i.x,o=i.y,s=t.x,a=t.y,u=this._coordinate,l=this._mappingInternal,h=u.getTileSize()*l.scale,c=l.x*h-(s/r+.5*t.width),p=c+e.width/r,f=l.y*h-(a/o+.5*t.height),d=f+e.height/o,y=n.WORK_LONLAT;y.set(c,f),u.pixelsToLonLat(y,0,h,y);var g=y.x,v=y.y;y.set(p,d),u.pixelsToLonLat(y,0,h,y);var _=y.x,m=y.y;this.move(r,g,v,_,m)}}return this},n.prototype.destroyPlanesBefore=function(t,e){for(var n=0;n<t;++n){var i=e[n];i&&(i.destroy(),e[n]=void 0)}},n.prototype.destroyPlanesAfter=function(t,e){for(var n=t+1,i=e.length;n<i;++n){var r=e[n];r&&(r.destroy(),e[n]=void 0)}},n.prototype.cleanup=function(){var t=this._tz,e=this._planes,n=e[t];if(n&&n.loaded)return this.destroyPlanesBefore(t,e),void this.destroyPlanesAfter(t,e);for(var i=t+1,r=e.length;i<r;++i)if((o=e[i])&&o.loaded)return this.destroyPlanesBefore(t,e),void this.destroyPlanesAfter(i,e);for(i=t-1;0<=i;--i){var o;if((o=e[i])&&o.loaded)return void this.destroyPlanesBefore(i,e)}},n.prototype.onLoaded=function(){this.cleanup(),ft.update(this._canvas)},n.prototype.destroy=function(){for(var t=this._planes,e=0,n=t.length;e<n;++e){var i=t[e];i&&(i.destroy(),t[e]=void 0)}var r=this._canvas,o=this._fitThrottledBound;return r.off("scale",o),r.off("move",o),r.snippet.remove(this,!0),this},n.WORK_LONLAT=new t.Point,n}(t.utils.EventEmitter),Mm=function(t,e,n){return"https://j.tile.openstreetmap.jp/".concat(t,"/").concat(e,"/").concat(n,".png")},km=function(){function t(){}return t.toPlaneOptions=function(t){var e,n,i,r=t.plane;return{min:null!==(e=null==r?void 0:r.min)&&void 0!==e?e:this.MIN,max:null!==(n=null==r?void 0:r.max)&&void 0!==n?n:this.MAX,throttle:null!==(i=null==r?void 0:r.throttle)&&void 0!==i?i:this.THROTTLE}},t.from=function(t){return new Pm({canvas:t.canvas,builder:t.builder||Mm,mapping:t.canvas.tile.mapping,coordinate:t.coordinate||Im.DEFAULT,plane:this.toPlaneOptions(t)})},t.MIN=0,t.MAX=18,t.THROTTLE=333,t}(),Lm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMenu=function(t,e){var n=null==e?void 0:e.menu;return n instanceof fg?n:new fg(this.toMenuOptions(t,n))},e.prototype.newMenu=function(t,e){return new fg(this.toMenuOptions(t,e))},e.prototype.toMenuOptions=function(t,e){return e?(null==e.fit&&(e.fit=!1),e):{fit:!1}},e.prototype.onActivate=function(e){t.prototype.onActivate.call(this,e),this.open()},e.prototype.open=function(){this.menu.open(this)},e.prototype.close=function(){this.menu.close()},Object.defineProperty(e.prototype,"menu",{get:function(){var t=this,e=this._menu;return null==e&&((e=this.toMenu(this.theme,this._options)).on("select",(function(e,n,i){t.onMenuSelect(e,n,i)})),this._menu=e),e},enumerable:!1,configurable:!0}),e.prototype.onMenuSelect=function(t,e,n){this.emit("select",t,e,this);var i=this.parent;i&&i.emit("select",t,e,i)},e.prototype.onKeyDown=function(e){return no.isArrowDownKey(e)&&this.onKeyDownArrowDown(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyDownArrowDown=function(t){return!(!this.state.isActionable||!this.state.isFocused||(this.onActivate(t),0))},e.prototype.getType=function(){return"DMenuBarItem"},e}(za),Nm=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.init=function(t){e.prototype.init.call(this,t);var n=null==t?void 0:t.items;if(n)for(var i=0,r=n.length;i<r;++i){var o=this.toItem(n[i]);o&&this.addChild(o)}},n.prototype.toItem=function(e){return null==e?null:e instanceof t.DisplayObject?e:"space"in e?new Js(e):new Lm(e)},n.prototype.onKeyDown=function(t){return no.moveFocusHorizontally(t,this),e.prototype.onKeyDown.call(this,t)},n.prototype.getType=function(){return"DMenuBar"},n}(ja),Bm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.initReflowable=function(){},e.prototype.getType=function(){return"DMenuSidedContent"},e}(ja),zm={NONE:0,SINGLE:1,SINGLE_ONCE:2},Um=function(){return!0},jm=function(e){function n(t,n){var i,r,o,s=e.call(this)||this;s._content=t,s._item=null,s._isDirty=!0,s._type=ai(null!==(r=null!==(i=null==n?void 0:n.mode)&&void 0!==i?i:null==n?void 0:n.type)&&void 0!==r?r:zm.SINGLE_ONCE,zm),s._filter=null!==(o=null==n?void 0:n.filter)&&void 0!==o?o:s.getFilterDefault();var a=null==n?void 0:n.on;if(a)for(var u in a){var l=a[u];l&&s.on(u,l)}return s}return F(n,e),n.prototype.first=function(){return this._item},n.prototype.toDirty=function(){this._isDirty=!0},n.prototype.update=function(){this._isDirty&&(this._isDirty=!1,this.update_(this._content))},n.prototype.hasMenu=function(t){return t&&t.menu instanceof fg},n.prototype.update_=function(e){for(var n=e.children,i=0,r=n.length;i<r;++i){var o=n[i];o instanceof Jf&&o.state.isActive&&this.set_(o,!1),o instanceof t.Container&&this.update_(o),this.hasMenu(o)&&this.update_(o.menu)}},n.prototype.add=function(t){this.update(),this.set_(t,!0)},n.prototype.set=function(t){this.update(),this.set_(t,!0)},n.prototype.get=function(t){return this.update(),this._item},n.prototype.getIndex=function(t){return null},n.prototype.size=function(){return this._item?1:0},n.prototype.isEmpty=function(){return null==this._item},n.prototype.remove=function(t){this.update(),this._item===t&&this.set_(null,!0)},n.prototype.clear=function(){this.update(),this.set_(null,!0)},n.prototype.getFilterDefault=function(){return Um},n.prototype.set_=function(t,e){var n=this._item,i=this._type;i!==zm.NONE&&this._filter(t)&&n!==t&&(this.setState(n,i,!1),this._item=t,this.setState(t,i,!0),e&&this.emit("change",this))},n.prototype.setState=function(t,e,n){t&&(e===zm.SINGLE?t.state.isActive=n:n?t.state.addAll(vt.ACTIVE,vt.READ_ONLY):t.state.removeAll(vt.ACTIVE,vt.READ_ONLY))},n}(t.utils.EventEmitter),Fm=function(t){function e(e){var n,i=t.call(this,e)||this,r=new pg(i);i._context=r,r.add(i);var o=null==e?void 0:e.items;if(null!=o){var s=null!==(n=null==e?void 0:e.sticky)&&void 0!==n&&n;i.newItems(o,s)}var a=null==e?void 0:e.selection;return i._selection=a instanceof jm?a:i.newSelection(a),i}return F(e,t),e.prototype.newSelection=function(t){return new jm(this.content,t)},e.prototype.onHierarchyDirty=function(){var e=this._selection;null!=e&&e.toDirty(),t.prototype.onHierarchyDirty.call(this)},e.prototype.newItems=function(t,e){Ud.newItems(this.content,t,e)},e.prototype.newContent=function(t){return new Bm(t)},Object.defineProperty(e.prototype,"selection",{get:function(){return this._selection},enumerable:!1,configurable:!0}),e.prototype.getContext=function(){return this._context},e.prototype.getCloseable=function(){return this},e.prototype.open=function(){},e.prototype.close=function(){},e.prototype.onKeyDown=function(e){return no.moveFocusVertically(e,this),t.prototype.onKeyDown.call(this,e)},e.prototype.getType=function(){return"DMenuSided"},e}(dv),Hm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNoteError"},e}(mv),Gm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNoteNoItemsFound"},e}(mv),Vm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DNoteSearching"},e}(mv),Wm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e}(ao),Km=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPaginationButtonLast"},e}(Ha),Xm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPaginationButtonNext"},e}(Ha),Ym=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPaginationButtonPage"},e}(Ha),qm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPaginationButtonPrevious"},e}(Ha),Zm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPaginationButtonTop"},e}(Ha),Jm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPaginationDots"},e}(Na),Qm=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DPaginationPage"},e}(Na),$m=function(t){function e(e){var n,i,r,o,s=t.call(this,e)||this;null!=e?(s._size=null!==(i=null!==(n=e.size)&&void 0!==n?n:e.total)&&void 0!==i?i:10,s._value=null!==(o=null!==(r=e.value)&&void 0!==r?r:e.selected)&&void 0!==o?o:0):(s._size=10,s._value=0);var a=s.buttonTop;null!=a&&s.addChild(a);var u=s.buttonPrevious;null!=u&&s.addChild(u);var l=s.spaceLeft;null!=l&&s.addChild(l);var h=s.buttonPages0,c=h.length;s.addChild(h[0]),s.addChild(s.dots0);for(var p=1;p<c;++p)s.addChild(h[p]);s.addChild(s.page);for(var f=s.buttonPages1,d=f.length,y=(p=0,d-1);p<y;++p)s.addChild(f[p]);s.addChild(s.dots1),s.addChild(f[d-1]);var g=s.spaceRight;null!=g&&s.addChild(g);var v=s.buttonNext;null!=v&&s.addChild(v);var _=s.buttonLast;return null!=_&&s.addChild(_),s}return F(e,t),Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){0<=t&&t<this._size&&this._value!==t&&(this._value=t,this.toDirty(),ft.update(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"selected",{get:function(){return this.value},set:function(t){this.value=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"size",{get:function(){return this._size},set:function(t){0<=t&&this._size!==t&&(this._size=t,this._value=0===t?-1:Math.max(0,Math.min(this._size-1,this._value)),this.toDirty(),ft.update(this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"total",{get:function(){return this.size},set:function(t){this.size=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dots0",{get:function(){var t=this._dots0;return null==t&&(t=this.newDots(),this._dots0=t),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"dots1",{get:function(){var t=this._dots1;return null==t&&(t=this.newDots(),this._dots1=t),t},enumerable:!1,configurable:!0}),e.prototype.newDots=function(){return new Jm},Object.defineProperty(e.prototype,"buttonLast",{get:function(){var t=this._buttonLast;return void 0===t&&(t=this.newButtonLast(),this._buttonLast=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonLast=function(){var t,e,n=this,i=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.last;if(null!==i&&!1!==i&&void 0!==i){var r=new Km(!0!==i?i:void 0);return r.on("active",(function(){n.onButtonLastActive()})),r}return null},e.prototype.onButtonLastActive=function(){this.goToLast()},e.prototype.goToLast=function(t){return this.goTo(this._size-1,t)},e.prototype.goTo=function(t,e){if(0<=t&&t<this._size&&this._value!==t){var n=this._value;return this._value=t,!0!==e&&this.emit("change",t,n,this),this.toDirty(),ft.update(this),!0}return!1},Object.defineProperty(e.prototype,"buttonNext",{get:function(){var t=this._buttonNext;return void 0===t&&(t=this.newButtonNext(),this._buttonNext=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonNext=function(){var t,e,n=this,i=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.next;if(null!==i&&!1!==i){var r=new Xm(!0!==i?i:void 0);return r.on("active",(function(){n.onButtonNextActive()})),r}return null},e.prototype.onButtonNextActive=function(){this.goToNext()},e.prototype.goToNext=function(t){return this.goTo(this._value+1,t)},Object.defineProperty(e.prototype,"buttonPrevious",{get:function(){var t=this._buttonPrevious;return void 0===t&&(t=this.newButtonPrevious(),this._buttonPrevious=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonPrevious=function(){var t,e,n=this,i=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.previous;if(null!==i&&!1!==i){var r=new qm(!0!==i?i:void 0);return r.on("active",(function(){n.onButtonPreviousActive()})),r}return null},e.prototype.onButtonPreviousActive=function(){this.goToPrevious()},e.prototype.goToPrevious=function(t){return this.goTo(this._value-1,t)},Object.defineProperty(e.prototype,"buttonTop",{get:function(){var t=this._buttonTop;return void 0===t&&(t=this.newButtonTop(),this._buttonTop=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonTop=function(){var t,e,n=this,i=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.top;if(null!==i&&!1!==i&&void 0!==i){var r=new Zm(!0!==i?i:void 0);return r.on("active",(function(){n.onButtonTopActive()})),r}return null},e.prototype.onButtonTopActive=function(){this.goToTop()},e.prototype.goToTop=function(t){return this.goTo(0,t)},e.prototype.newButtonPage=function(){var t,e,n=this,i=new Ym(null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.page);return i.on("active",(function(){n.onButtonPageActive(i)})),i},Object.defineProperty(e.prototype,"buttonPages0",{get:function(){var t=this._buttonPages0;return null==t&&(t=this.newButtonPages0(),this._buttonPages0=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonPages0=function(){return[this.newButtonPage(),this.newButtonPage(),this.newButtonPage(),this.newButtonPage()]},e.prototype.allocButtonPages0=function(t){for(var e=this.buttonPages0,n=e.length,i=this.getChildIndex(e[n-1])+1,r=0,o=t-n;r<o;++r){var s=this.newButtonPage();this.addChildAt(s,i+r),e.push(s)}},Object.defineProperty(e.prototype,"buttonPages1",{get:function(){var t=this._buttonPages1;return null==t&&(t=this.newButtonPages1(),this._buttonPages1=t),t},enumerable:!1,configurable:!0}),e.prototype.newButtonPages1=function(){return[this.newButtonPage(),this.newButtonPage(),this.newButtonPage(),this.newButtonPage()]},e.prototype.allocButtonPages1=function(t){for(var e=this.buttonPages1,n=e.length,i=this.getChildIndex(e[0]),r=0,o=t-n;r<o;++r){var s=this.newButtonPage();this.addChildAt(s,i),e.unshift(s)}},Object.defineProperty(e.prototype,"page",{get:function(){var t=this._page;return null==t&&(t=this.newPage(),this._page=t),t},enumerable:!1,configurable:!0}),e.prototype.newPage=function(){var t;return new Qm(null===(t=this._options)||void 0===t?void 0:t.page)},e.prototype.onButtonPageActive=function(t){var e=t.text.value;St(e)&&(this.goTo(e-1),t.state.isFocused&&(t.state.isHovered=!1,this.page.focus()))},Object.defineProperty(e.prototype,"spaceLeft",{get:function(){var t=this._spaceLeft;return void 0===t&&(t=this.newSpaceLeft(),this._spaceLeft=t),t},enumerable:!1,configurable:!0}),e.prototype.newSpaceLeft=function(){return null!=this.buttonTop||null!=this.buttonPrevious?this.newSpace():null},Object.defineProperty(e.prototype,"spaceRight",{get:function(){var t=this._spaceRight;return void 0===t&&(t=this.newSpaceRight(),this._spaceRight=t),t},enumerable:!1,configurable:!0}),e.prototype.newSpaceRight=function(){return null!=this.buttonLast||null!=this.buttonNext?this.newSpace():null},e.prototype.newSpace=function(){var t,e,n=null===(e=null===(t=this._options)||void 0===t?void 0:t.button)||void 0===e?void 0:e.space;return null!==n&&!1!==n?!0===n||void 0===n?new Js({weight:1}):St(n)?new Js({width:n}):new Js(n):null},e.prototype.onReflow=function(){this.update(),t.prototype.onReflow.call(this)},e.prototype.update=function(){var t=this._size,e=this._value;t<=0?this.doUpdate0(e,t):this._auto.width.isOn?this.doUpdate2(e,t,0,0,0,0):this.doUpdate1(e,t)},e.prototype.doUpdate0=function(t,e){var n=this.buttonTop;null!=n&&(n.state.isEnabled=!1);var i=this.buttonPrevious;null!=i&&(i.state.isEnabled=!1),this.hideDots(this.dots0);for(var r=this.buttonPages0,o=0,s=r.length;o<s;++o)this.hidePage(r[o]);this.hidePage(this.page);var a=this.buttonPages1;for(o=0,s=a.length;o<s;++o)this.hidePage(a[o]);this.hideDots(this.dots1);var u=this.buttonNext;null!=u&&(u.state.isEnabled=!1);var l=this.buttonLast;l&&(l.state.isEnabled=!1)},e.prototype.doUpdate1=function(t,e){var n=0,i=0,r=this.buttonTop;null!=r&&(n+=r.width,i+=1);var o=this.buttonPrevious;null!=o&&(n+=o.width,i+=1);var s=this.spaceLeft;null!=s&&(s.weight<0&&(n+=s.width),i+=1),n+=this.page.width,i+=1;var a=this.spaceRight;null!=a&&(a.weight<0&&(n+=a.width),i+=1);var u=this.buttonNext;null!=u&&(n+=u.width,i+=1);var l=this.buttonLast;l&&(n+=l.width,i+=1);var h=this._margin.horizontal;2<=i&&(n+=(i-1)*h);var c=this.padding,p=this.width-(c.getLeft()+c.getRight());if(p<=n)this.doUpdate2(t,e,4,4,0,0);else{var f=this.buttonPages0[0].width,d=t,y=d*(f+h),g=this.buttonPages1[0].width,v=e-(t+1),_=v*(g+h);if(n+y+_<=p)this.doUpdate2(t,e,0,0,0,0);else{var m=this.dots1.width,b=this.dots0.width,T=h+f,w=h+g,E=b+T,O=m+w,C=E+T,S=O+w;if(y<=_)if(3<=v&&n+y+S<=p){var x=p-(n+y+S),D=Math.floor(x/w);this.doUpdate2(t,e,0,1,0,D)}else if(3<=d&&3<=v&&n+C+S<=p){x=p-(n+C+S),D=Math.floor(.5*x/w);var I=Math.floor((x-D*w)/T);this.doUpdate2(t,e,1,1,I,D)}else 2<=v&&n+y+O<=p?this.doUpdate2(t,e,0,2,0,0):3<=d&&2<=v&&n+C+O<=p?(x=p-(n+C+O),I=Math.floor(x/T),this.doUpdate2(t,e,1,2,I,0)):2<=d&&2<=v&&n+E+O<=p?this.doUpdate2(t,e,2,2,0,0):1<=d&&1<=v&&n+b+m<=p?this.doUpdate2(t,e,3,3,0,0):this.doUpdate2(t,e,4,4,0,0);else 3<=d&&n+C+_<=p?(x=p-(n+C+_),I=Math.floor(x/T),this.doUpdate2(t,e,1,0,I,0)):3<=d&&3<=v&&n+C+S<=p?(x=p-(n+C+S),I=Math.floor(.5*x/T),D=Math.floor((x-I*T)/w),this.doUpdate2(t,e,1,1,I,D)):2<=d&&n+E+_<=p?this.doUpdate2(t,e,2,0,0,0):2<=d&&3<=v&&n+E+S<=p?(x=p-(n+E+S),D=Math.floor(x/w),this.doUpdate2(t,e,2,1,0,D)):2<=d&&2<=v&&n+E+O<=p?this.doUpdate2(t,e,2,2,0,0):1<=d&&1<=v&&n+b+m<=p?this.doUpdate2(t,e,3,3,0,0):this.doUpdate2(t,e,4,4,0,0)}}},e.prototype.doUpdate2=function(t,e,n,i,r,o){var s=this.buttonTop;null!=s&&(s.state.isEnabled=0<t);var a=this.buttonPrevious;null!=a&&(a.state.isEnabled=0<t);var u=this.buttonPages0;switch(n){case 0:this.hideDots(this.dots0),this.allocButtonPages0(t);for(var l=0,h=u.length;l<h;++l)l<t?this.showPage(u[l],l):this.hidePage(u[l]);break;case 1:for(this.showDots(this.dots0,1,t-2-r),this.allocButtonPages0(2+r),this.showPage(u[0],0),l=1,h=u.length-r-1;l<h;++l)this.hidePage(u[l]);for(l=0,h=1+r;l<h;++l)this.showPage(u[u.length-h+l],t-1-(h-1)+l);break;case 2:for(this.showDots(this.dots0,0,t-2),l=0,h=u.length-1;l<h;++l)this.hidePage(u[l]);this.showPage(u[u.length-1],t-1);break;case 3:for(this.showDots(this.dots0,0,t-1),l=0,h=u.length;l<h;++l)this.hidePage(u[l]);break;case 4:for(this.hideDots(this.dots0),l=0,h=u.length;l<h;++l)this.hidePage(u[l])}this.showPage(this.page,t);var c=this.buttonPages1;switch(i){case 0:for(this.allocButtonPages1(e-(t+1)),l=0,h=c.length;l<h;++l){var p=t+1+l;p<e?this.showPage(c[l],p):this.hidePage(c[l])}this.hideDots(this.dots1);break;case 1:for(this.allocButtonPages1(2+o),l=0,h=1+o;l<h;++l)this.showPage(c[l],t+1+l);for(l=1+o,h=c.length-1;l<h;++l)this.hidePage(c[l]);this.showPage(c[c.length-1],e-1),this.showDots(this.dots1,t+2+o,e-2);break;case 2:for(this.showPage(c[0],t+1),l=1,h=c.length;l<h;++l)this.hidePage(c[l]);this.showDots(this.dots1,t+2,e-1);break;case 3:for(l=0,h=c.length;l<h;++l)this.hidePage(c[l]);this.showDots(this.dots1,t+1,e-1);break;case 4:for(l=0,h=c.length;l<h;++l)this.hidePage(c[l]);this.hideDots(this.dots1)}var f=this.buttonNext;null!=f&&(f.state.isEnabled=t<e-1);var d=this.buttonLast;null!=d&&(d.state.isEnabled=t<e-1)},e.prototype.showPage=function(t,e){t.text=e+1,t.show()},e.prototype.hidePage=function(t){t.hide()},e.prototype.showDots=function(t,e,n){t.show()},e.prototype.hideDots=function(t){t.hide()},e.prototype.getType=function(){return"DPagination"},e}(ja),tb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e}(ao),eb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e}(ao),nb=function(t){function e(e){var n=t.call(this,e)||this;n._values=[];var i=null==e?void 0:e.values;return i&&(n.values=i),n}return F(e,t),e.prototype.onMenuSelect=function(e,n,i){if(t.prototype.onMenuSelect.call(this,e,n,i),n instanceof td){var r=this._values,o=[],s=[];n.state.isActive?this.updateMenuItems(i,r,e,void 0,o,s):this.updateMenuItems(i,r,void 0,e,o,s),this._values=o,this.text=s,this.onValueChange(o,r,s)}},e.prototype.onMenuReplaced=function(e,n){t.prototype.onMenuReplaced.call(this,e,n);var i=this._values,r=[],o=[];this.updateMenuItems(e,i,void 0,void 0,r,o),this._values=r,this.text=o},e.prototype.onValueChange=function(t,e,n){this.emit("change",t,e,n,this)},e.prototype.onMenuOpening=function(e){t.prototype.onMenuOpening.call(this,e),this.updateMenuItems(this.menu,this._values)},Object.defineProperty(e.prototype,"values",{get:function(){return this.getValues()},set:function(t){this.setValues(t)},enumerable:!1,configurable:!0}),e.prototype.getValues=function(){return this._values},e.prototype.setValues=function(t,e){var n=this._values;if(e||!this.isSameValues(t,n)){var i=[],r=[];this.updateMenuItems(this.menu,t,void 0,void 0,i,r),this._values=i,this.text.setValue(r,e)}},e.prototype.isSameValues=function(t,e){if(t.length===e.length)for(var n=0,i=t.length;n<i;++n)if(e.indexOf(t[n])<0)return!1;return!1},e.prototype.updateMenuItems=function(t,e,n,i,r,o){for(var s=t.children,a=0,u=s.length;a<u;++a){var l=s[a];if(l instanceof fd)this.updateMenuItems(l.menu,e,n,i,r,o);else if(l instanceof td){var h=l.value;void 0!==i&&i===h?l.state.isActive=!1:void 0!==n&&l.value===n||0<=e.indexOf(l.value)?(r&&r.push(l.value),o&&o.push(l),l.state.isActive=!0):l.state.isActive=!1}}},e.prototype.getType=function(){return"DSelectMultiple"},e}(dg),ib=function(t){function e(e,n,i,r,o){var s=t.call(this,e,n,i,n,i)||this;return s._offsetX=r,s._offsetY=o,s._shiftX=.5*n,s._shiftY=.5*i,s.interactive=!1,s.interactiveChildren=!1,e.on("update",(function(){s.onTextureUpdate()})),s}return F(e,t),e.prototype.onTextureUpdate=function(){this.emit("update",this)},e.prototype.onReflow=function(t,e,n){var i=this._shiftX,r=this._shiftY;this.x=-i+this._offsetX,this.y=-r+this._offsetY,this.width=i+e+i,this.height=r+n+r},e.prototype.render=function(e){var n=this.parent;if(n){var i=n.alpha;this.alpha=i*i*i}t.prototype.render.call(this,e)},e}(t.NineSlicePlane),rb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){var n;t.prototype.init.call(this,e),this._value=null!==(n=null==e?void 0:e.value)&&void 0!==n?n:0},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DSliderLabel"},e}(xa),ob=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DSliderThumb"},e}(za),sb=function(t){function e(e){var n,i,r=t.call(this,e)||this;return r._value=null!==(n=null==e?void 0:e.value)&&void 0!==n?n:0,r._rounder=r.toRounder(e),r._delta=null!==(i=null==e?void 0:e.delta)&&void 0!==i?i:1,r}return F(e,t),e.prototype.toRounder=function(t){var e,n=null==t?void 0:t.rounder;if(n)return n;var i=null!==(e=null==t?void 0:t.precision)&&void 0!==e?e:this.theme.getPrecision(),r=Math.pow(10,i);return function(t){return Math.round(t*r)/r}},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(t){this._value=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rounder",{get:function(){return this._rounder},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"delta",{get:function(){return this._delta},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DSliderValue"},e}(xa),ab=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.init=function(e){var n=this;t.prototype.init.call(this,e),this._ratioValue=0,this._track=this.newTrack(e),this.addChild(this._track),this._trackSelected=this.newTrackSelected(e),this._trackSelected.state.isActive=!0,this.addChild(this._trackSelected),this._thumb=this.newThumb(e),this.addChild(this._thumb),this._min=this.newLabelMin(e),this.addChild(this._min),this._max=this.newLabelMax(e),this.addChild(this._max),this._value=this.newValue(e),this.addChild(this._value),this._track.on(cr.down,(function(t){n._value.visible=n.state.inEnabled,n.onTrackDown(t.data.global)})),this._trackSelected.on(cr.down,(function(t){n._value.visible=n.state.inEnabled,n.onTrackSelectedDown(t.data.global)})),this._onTrackUpBound=function(t){n.onTrackUpBound(t),n._value.visible=!1},this._onTrackSelectedUpBound=function(t){n.onTrackSelectedUpBound(t),n._value.visible=!1},this._thumb.on(cr.down,(function(t){n._value.visible=!0,n.onThumbDown(t)})),this._onThumbMoveBound=function(t){n.onThumbMove(t)},this._onThumbUpBound=function(t){n.onThumbUp(t),n._value.visible=!1},this.onValuesChange()},e.prototype.newThumb=function(t){return new ob(null==t?void 0:t.thumb)},e.prototype.newValue=function(t){return new sb(this.toValueOptions(null==t?void 0:t.value))},e.prototype.toValueOptions=function(t){null==(t=t||{}).value&&(t.value=0);var e=t.text||{};return t.text=e,null==e.value&&(e.value=t.value),null==t.visible&&(t.visible=!1),t},e.prototype.newLabelMin=function(t){return new rb(this.toLabelMinOptions(null==t?void 0:t.min))},e.prototype.toLabelMinOptions=function(t){null==(t=t||{}).value&&(t.value=0);var e=t.text||{};return t.text=e,null==e.value&&(e.value="".concat(t.value)),t},e.prototype.newLabelMax=function(t){return new rb(this.toLabelMaxOptions(null==t?void 0:t.max))},e.prototype.toLabelMaxOptions=function(t){null==(t=t||{}).value&&(t.value=1);var e=t.text||{};return t.text=e,null==e.value&&(e.value="".concat(t.value)),t},e.prototype.getValueMargin=function(){return 14},e.prototype.onTrackDown=function(t){if(!this.state.inDisabled){var e=ft.getLayer(this);if(e){var n=e.renderer.plugins.interaction;this._interactionManager=n;var i=this._onTrackUpBound;n.on(cr.up,i),n.on(cr.upoutside,i),n.on(cr.cancel,i)}this.onPick(t)}},e.prototype.onTrackSelectedDown=function(t){if(!this.state.inDisabled){var e=ft.getLayer(this);if(e){var n=e.renderer.plugins.interaction;this._interactionManager=n;var i=this._onTrackSelectedUpBound;n.on(cr.up,i),n.on(cr.upoutside,i),n.on(cr.cancel,i)}this.onPick(t)}},e.prototype.onTrackUpBound=function(t){var e=this._interactionManager;if(e){this._interactionManager=void 0;var n=this._onTrackUpBound;e.off(cr.up,n),e.off(cr.upoutside,n),e.off(cr.cancel,n)}},e.prototype.onTrackSelectedUpBound=function(t){var e=this._interactionManager;if(e){this._interactionManager=void 0;var n=this._onTrackSelectedUpBound;e.off(cr.up,n),e.off(cr.upoutside,n),e.off(cr.cancel,n)}},e.prototype.onThumbMove=function(t){this.state.inDisabled||this.onPick(t.data.global)},e.prototype.onThumbDown=function(t){var e=ft.getLayer(this);if(e){var n=e.renderer.plugins.interaction;this._interactionManager=n;var i=this._onThumbMoveBound;n.on(cr.move,i);var r=this._onThumbUpBound;n.on(cr.up,r),n.on(cr.upoutside,r),n.on(cr.cancel,r)}},e.prototype.onThumbUp=function(t){var e=this._interactionManager;if(e){this._interactionManager=void 0;var n=this._onThumbMoveBound;e.off(cr.move,n);var i=this._onThumbUpBound;e.off(cr.up,i),e.off(cr.upoutside,i),e.off(cr.cancel,i)}},e.prototype.updateValue=function(){var t=this._min.value,e=this._max.value,n=this._value,i=n.rounder(t+this._ratioValue*(e-t)),r=n.value;i!==r&&(n.value=i,n.text=n.value,this.emit("change",i,r,this))},e.prototype.onResize=function(e,n,i,r){t.prototype.onResize.call(this,e,n,i,r),this.onValuesChange()},Object.defineProperty(e.prototype,"value",{get:function(){return this._value.value},set:function(t){t=Math.max(this._min.value,Math.min(this._max.value,t)),this._value.value!==t&&(this._value.value=t,this.onValuesChange())},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"min",{get:function(){return this._min.value},set:function(t){var e=this._min;if(t=Math.min(this._max.value,t),e.value!==t){var n=this._value;e.text=e.value=t,n.value=Math.max(t,n.value),this.onValuesChange()}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"max",{get:function(){return this._max.value},set:function(t){var e=this._max;if(t=Math.max(this._min.value,t),e.value!==t){var n=this._value;e.text=e.value=t,n.value=Math.min(t,n.value),this.onValuesChange()}},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DSlider"},e}(ao),ub=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DSliderTrack"},e}(za),lb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DSliderTrackHorizontal"},e}(ub),hb=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.newTrack=function(t){return new lb(null==t?void 0:t.track)},n.prototype.newTrackSelected=function(t){return new lb(null==t?void 0:t.track)},n.prototype.toValueOptions=function(t){var n=this;return null==(t=e.prototype.toValueOptions.call(this,t)).y&&(t.y=function(t,e){return.5*t-e-n.getValueMargin()}),t},n.prototype.toLabelMinOptions=function(t){return null==(t=e.prototype.toLabelMinOptions.call(this,t)).x&&(t.x=function(t,e){return.5*-e}),null==t.y&&(t.y=function(t,e){return-e}),t},n.prototype.toLabelMaxOptions=function(t){return null==(t=e.prototype.toLabelMaxOptions.call(this,t)).x&&(t.x=function(t,e){return t-.5*e}),null==t.y&&(t.y=function(t,e){return-e}),t},n.prototype.onPick=function(e){var n=new t.Point(0,0);this.toLocal(e,void 0,n);var i=Math.max(0,Math.min(this._track.width,n.x));this._ratioValue=i/this._track.width,this.moveThumbPosition(i)},n.prototype.onValuesChange=function(){var t=this._min.value,e=this._max.value,n=this._value.value;this._ratioValue=(n-t)/(e-t);var i=this._ratioValue*this._track.width;this.moveThumbPosition(i)},n.prototype.moveThumbPosition=function(t){var e=this._thumb;e.x=t-.5*e.width,this._trackSelected.width=t;var n=this._value;n.x=t-.5*n.width,this.updateValue()},n.prototype.onKeyDown=function(t){return no.isArrowRightKey(t)?this.value+=this._value.delta:no.isArrowLeftKey(t)&&(this.value-=this._value.delta),e.prototype.onKeyDown.call(this,t)},n.prototype.getType=function(){return"DSliderHorizontal"},n}(ab),cb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DSliderTrackVertical"},e}(ub),pb=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return F(n,e),n.prototype.newTrack=function(t){return new cb(null==t?void 0:t.track)},n.prototype.newTrackSelected=function(t){return new cb(null==t?void 0:t.track)},n.prototype.toLabelMinOptions=function(t){null==(t=e.prototype.toLabelMinOptions.call(this,t)).x&&(t.x=function(t,e){return-e}),null==t.y&&(t.y=function(t,e){return t-.5*e});var n=t.text||{};t.text=n;var i=n.align||{};return n.align=i,null==i.horizontal&&(i.horizontal=ra.RIGHT),t},n.prototype.toLabelMaxOptions=function(t){null==(t=e.prototype.toLabelMaxOptions.call(this,t)).x&&(t.x=function(t,e){return-e}),null==t.y&&(t.y=function(t,e){return.5*-e});var n=t.text||{};t.text=n;var i=n.align||{};return n.align=i,null==i.horizontal&&(i.horizontal=ra.RIGHT),t},n.prototype.onPick=function(e){var n=new t.Point(0,0);this.toLocal(e,void 0,n);var i=this.height,r=Math.max(0,Math.min(i,n.y));this._ratioValue=(i-r)/i,this.moveThumbPosition(r)},n.prototype.onValuesChange=function(){var t=this._min.value,e=this._max.value,n=this._value.value;this._ratioValue=(n-t)/(e-t);var i=this.height*(1-this._ratioValue);this.moveThumbPosition(i)},n.prototype.moveThumbPosition=function(t){var e=this._thumb;e.y=t-.5*e.height;var n=this._trackSelected;n.y=t,n.height=this.height-t;var i=this._value;i.y=t-i.height-this.getValueMargin(),this.updateValue()},n.prototype.onKeyDown=function(t){return no.isArrowUpKey(t)?this.value+=this._value.delta:no.isArrowDownKey(t)&&(this.value-=this._value.delta),e.prototype.onKeyDown.call(this,t)},n.prototype.getType=function(){return"DSliderVertical"},n}(ab),fb=function(){function t(){}return t.set=function(t,e,n,i,r){var o,s=this.toRenderable(e,n,i);t.renderable=s;var a=t.state;a.lock(),a.isDisabled=!s,!1!==r&&(a.isReadOnly=this.toReadOnly(e,n,i));var u=null===(o=i.state)||void 0===o?void 0:o.modifier;u&&u(e,n,t.state),a.unlock()},t.toReadOnly=function(t,e,n){var i=n.editing.enable;return!0!==i&&(!1===i||!i(t,e))},t.toRenderable=function(t,e,n){var i=n.renderable;return!0===i||!1!==i&&i(t,e)},t}(),db=function(t){function e(e,n,i,r){var o,s=t.call(this,r)||this;return s._rowIndex=-1,s._columnIndex=e,s._column=n,s._onChange=i,s._isSyncEnabled=null!==(o=null==r?void 0:r.sync)&&void 0!==o?o:s.theme.isSyncEnabled(),s}return F(e,t),e.prototype.onActivate=function(e){var n,i=this;t.prototype.onActivate.call(this,e);var r=this._column.selecting,o=r.dialog;if(o){var s=null!==(n=this.text.computed)&&void 0!==n?n:null;r.setter(o,s),o.open(this).then((function(){var t=r.getter(o,s);i._isSyncEnabled?t!==s&&(i.text=t,i.onValueChange(t,s)):i.onValueChange(t,null)}))}},e.prototype.onValueChange=function(t,e){var n=this._row;if(void 0!==n){var i=this._rowIndex,r=this._columnIndex,o=this._column;o.setter(n,r,t),this.emit("change",t,e,this),this._onChange(t,e,n,i,r,o,this)}},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t;return null!==(t=this.text.computed)&&void 0!==t?t:null},set:function(t){this.text=t},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(t,o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellSelectDialog"},e}(za),yb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DTableBodyCellActionDialog"},e}(db),gb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onMenuSelect=function(e,n,i){var r=this._row;if(void 0!==r){var o=this._rowIndex,s=this._columnIndex,a=this._column;a.setter(r,s,e),t.prototype.onMenuSelect.call(this,e,n,i),this._onChange(e,null,r,o,s,a,this)}},e.prototype.onKeyDownArrowDown=function(t){return!1},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(t,o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellActionMenu"},e}(mm),vb=function(t){function e(e,n,i,r){var o,s=t.call(this,r)||this;return s._rowIndex=-1,s._columnIndex=e,s._column=n,s._onChange=i,s._isSyncEnabled=null!==(o=null==r?void 0:r.sync)&&void 0!==o?o:s.theme.isSyncEnabled(),s}return F(e,t),e.prototype.onActivate=function(e){var n=this;t.prototype.onActivate.call(this,e);var i=this._column.selecting.promise;i&&i().then((function(t){var e;if(n._isSyncEnabled){var i=null!==(e=n.text.computed)&&void 0!==e?e:null;t!==i&&(n.text=t,n.onValueChange(t,i))}else n.onValueChange(t,null)}))},e.prototype.onValueChange=function(t,e){var n=this._row;if(void 0!==n){var i=this._rowIndex,r=this._columnIndex,o=this._column;o.setter(n,r,t),this.emit("change",t,e,this),this._onChange(t,e,n,i,r,o,this)}},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){var t;return null!==(t=this.text.computed)&&void 0!==t?t:null},set:function(t){this.text=t},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(t,o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellSelectPromise"},e}(za),_b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DTableBodyCellActionPromise"},e}(vb),mb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(t,o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellText"},e}(Na),bb=function(t){function e(e,n,i,r){var o,s=t.call(this,e,n,i,r)||this;return s._when=ai(null!==(o=null==r?void 0:r.when)&&void 0!==o?o:na.CLICKED,na),s.on(cr.tap,(function(t){s.onClick(t)})),s}return F(e,t),e.prototype.onClick=function(t){this._when===na.CLICKED&&this.state.isActionable&&this.activate(t)},e.prototype.onDblClick=function(e,n){return this._when===na.DOUBLE_CLICKED&&this.state.isActionable&&this.activate(e),t.prototype.onDblClick.call(this,e,n)},e.prototype.activate=function(t){this.onActivate(t)},e.prototype.onActivate=function(t){this.emit("active",this);var e=this._row;if(void 0!==e){var n=this._rowIndex,i=this._columnIndex,r=this._column;this.emit("change",null,null,this),this._onChange(null,null,e,n,i,r,this)}},e.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this.state.isPressed=!0)},e.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this.state.isPressed&&this.onActivate(t),this.state.isPressed=!1)},e.prototype.onKeyDown=function(e){return no.isActivateKey(e)&&this.onActivateKeyDown(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyUp=function(e){return no.isActivateKey(e)&&this.onActivateKeyUp(e),t.prototype.onKeyUp.call(this,e)},e.prototype.getType=function(){return"DTableBodyCellButton"},e}(mb),Tb={INDEX:0,TEXT:1,INTEGER:2,REAL:3,CHECK:4,CHECK_SINGLE:5,COLOR:6,BUTTON:7,SELECT:8,DATE:9,DATETIME:10,TIME:11,ACTION:12,LINK:13,TREE:14,TEXT_AREA:15},wb={CELL:0,ROW:1,ALL:2},Eb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onActivate=function(e){t.prototype.onActivate.call(this,e),this.onValueChange(!0,!1)},e.prototype.onInactivate=function(e){t.prototype.onInactivate.call(this,e),this.onValueChange(!1,!0)},e.prototype.onValueChange=function(t,e){var n=this._row;if(void 0!==n){var i=this._rowIndex,r=this._columnIndex,o=this._column;o.setter(n,r,t),this.emit("change",t,e,this);var s=this._onChange;s(t,e,n,i,r,o,this),t&&o.type===Tb.CHECK_SINGLE&&this.onChangeSingle(i,r,o,s)}},e.prototype.onChangeSingle=function(t,e,n,i){var r=this,o=this.parent;if(null!=o){var s=o.parent;if(null!=s){var a=!1,u=n.getter,l=n.setter;s.data.each((function(o,s){return t===s||!u(o,e)||(l(o,e,!1),a=!0,i(!1,!0,o,s,e,n,r),!1)})),a&&n.update!==wb.ALL&&s.update(!0)}}},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.state.isActive=!!t,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1},e.prototype.getType=function(){return"DTableBodyCellCheck"},e}(ng),Ob=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}else t.prototype.onValueChange.call(this,e,n)},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i;var s=this.value;if(St(t))s.color=t,s.alpha=1;else if(xt(t)){var a=Number(t);s.color=a==a?a:16777215,s.alpha=1}else if(null!=t){var u=t.color,l=t.alpha;s.color=St(u)?u:16777215,s.alpha=St(l)?l:1}else s.color=16777215,s.alpha=1;fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1},e.prototype.getType=function(){return"DTableBodyCellColor"},e}(Ag),Cb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}else t.prototype.onValueChange.call(this,e,n)},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){if(this._row=e,this._rowIndex=i,t instanceof Date)this.text.setValue(t,o||this._forcibly);else if(St(t)){var s=this.text,a=s.computed;void 0===a?this.text=new Date(t):a.getTime()!==t&&(a.setTime(t),s.compute(!0))}this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellDate"},e}(Pg),Sb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}else t.prototype.onValueChange.call(this,e,n)},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){if(this._row=e,this._rowIndex=i,t instanceof Date)this.text.setValue(t,o||this._forcibly);else if(St(t)){var s=this.text,a=s.computed;null==a?this.text=new Date(t):a.getTime()!==t&&(a.setTime(t),s.compute(!0))}this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellDatetime"},e}(Ng),xb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(i,o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellIndex"},e}(Na),Db=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(Number(t),o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellInputInteger"},e}(ou),Ib=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(Number(t),o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellInputReal"},e}(uu),Ab=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(String(t),o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellInputTextArea"},e}(Cm),Rb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text.setValue(String(t),o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellInputText"},e}(cu),Pb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.newPadding=function(t,e,n){return new tg(t,e,n)},Object.defineProperty(e.prototype,"padding",{get:function(){return this._padding},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DTableBodyCellInputTreeInput"},e}(cu),Mb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DTableBodyCellInputTreeMarker"},e}(Ba),kb={START:"START",END:"END",FROZEN:"FROZEN",FROZEN_END:"FROZEN_END",HAS_DATA:"HAS_DATA",SORTABLE:"SORTABLE",SORTED_ASCENDING:"SORTED_ASCENDING",SORTED_DESCENDING:"SORTED_DESCENDING",HAS_CHILDREN:"HAS_CHILDREN",OPENED:"OPENED",CHECKABLE:"CHECKABLE",SELECTABLE:"SELECTABLE",HOVERED_ON_EDGE:"HOVERED_ON_EDGE",RESIZING:"RESIZING"},Lb=function(t){function e(e,n,i,r){var o=t.call(this,function(t){if(null!=t)return{weight:t.weight,width:t.width}}(r))||this;o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i;var s=o.newInput(r);o._input=s,o.addChild(s);var a=o.newMarker(r);return o._marker=a,o.addChild(a),o}return F(e,t),e.prototype.newInput=function(t){return new Pb(this.toInputOptions(t))},e.prototype.toInputOptions=function(t){var e=this;return{weight:1,text:null==t?void 0:t.text,editing:null==t?void 0:t.editing,when:null==t?void 0:t.when,cursor:null==t?void 0:t.cursor,on:{change:function(t,n){e.onInputChange(t,n)}}}},e.prototype.onInputChange=function(t,e){var n=this._row;if(void 0!==n){var i=this._rowIndex,r=this._columnIndex,o=this._column;o.setter(n,r,t),this.emit("change",t,e,this),this._onChange(t,e,n,i,r,o,this)}},e.prototype.newMarker=function(t){var e=this;return new Mb({visible:!1,on:{active:function(){e.onMarkerActive()}}})},e.prototype.onMarkerActive=function(){this._marker.state.is(kb.HAS_CHILDREN)&&this.toggle()},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.toggle=function(){var t=this._row;if(void 0!==t){var e=this.parent;if(null!=e){var n=e.parent;if(null!=n){var i=n.data;i&&i.toggle&&(i.isExpanded(t)?i.collapse(t)&&(this.emit("collapse",this),i.emit("collapse",t,this)):i.expand(t)&&(this.emit("expand",this),i.emit("expand",t,this)))}}}},e.prototype.onRowSelect=function(t,e){return e.x<=this.position.x+this._input.padding.getLeft()},e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i;var s=this._input;s.visible=!0,s.text.setValue(String(t),o||this._forcibly),this._forcibly=void 0;var a=this._marker;if(null!=n){var u=!!(1&n),l=!!(2&n),h=n>>2,c=a.state;c.lock(),c.set(kb.HAS_CHILDREN,l),c.set(vt.DISABLED,!l),c.set(kb.OPENED,u),c.unlock();var p=this.theme.getLevelPadding(h);a.width=p,l?a.show():a.hide(),s.padding.adjLeft(p)}else a.state.removeAll(kb.OPENED,kb.HAS_CHILDREN),a.hide(),s.padding.adjLeft(0);fb.set(this._input,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._input.visible=!1,this._marker.hide(),this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellInputTree"},e}(ao),Nb=function(t,e){if(e)return{url:Bb(t,e.url),target:e.target,checker:zb(t,e.checker),menu:e.menu}},Bb=function(t,e){return xt(e)||null==e?e:function(){var n=t.row;return void 0!==n?e(n,t.rowIndex,t.columnIndex,t):null}},zb=function(t,e){if(null!=e)return function(){var n=t.row;return void 0!==n&&e(n,t.rowIndex,t.columnIndex,t)}},Ub=function(t){function e(e,n,i,r){var o;return t.call(this,e,n,i,hd.toStateOptions(null===(o=null==r?void 0:r.link)||void 0===o?void 0:o.target,r))||this}return F(e,t),e.prototype.onClick=function(e){this.link.onClick(this,e)||t.prototype.onClick.call(this,e)},Object.defineProperty(e.prototype,"link",{get:function(){var t,e=this._link;return null==e&&(e=new ld(Nb(this,null===(t=this._options)||void 0===t?void 0:t.link)),this._link=e),e},enumerable:!1,configurable:!0}),e.prototype.getType=function(){return"DTableBodyCellLink"},e.prototype.onActivate=function(e){t.prototype.onActivate.call(this,e),this.link.open(e)},e.prototype.open=function(t){this.link.open(t)},e}(bb),jb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n,i){var r=this._row;if(void 0!==r){var o=this._rowIndex,s=this._columnIndex,a=this._column;a.setter(r,s,e),t.prototype.onValueChange.call(this,e,n,i),this._onChange(e,n,r,o,s,a,this)}},e.prototype.onKeyDownArrowDown=function(t){return!1},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.setValue(t,o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellSelectMenu"},e}(gg),Fb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n,i){var r=this._row;if(void 0!==r){var o=this._rowIndex,s=this._columnIndex,a=this._column;a.setter(r,s,e),t.prototype.onValueChange.call(this,e,n,i),this._onChange(e,n,r,o,s,a,this)}},e.prototype.onKeyDownArrowDown=function(t){return!1},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.setValues(t,o||this._forcibly),this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellSelectMultiple"},e}(nb),Hb=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getType=function(){return"DTableBodyCellTextArea"},e}(mb),Gb=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._rowIndex=-1,o._columnIndex=e,o._column=n,o._onChange=i,o}return F(e,t),e.prototype.onValueChange=function(e,n){var i=this._row;if(void 0!==i){var r=this._rowIndex,o=this._columnIndex,s=this._column;s.setter(i,o,e),t.prototype.onValueChange.call(this,e,n),this._onChange(e,n,i,r,o,s,this)}else t.prototype.onValueChange.call(this,e,n)},Object.defineProperty(e.prototype,"row",{get:function(){return this._row},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rowIndex",{get:function(){return this._rowIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),e.prototype.set=function(t,e,n,i,r,o){if(this._row=e,this._rowIndex=i,t instanceof Date)this.text.setValue(t,o||this._forcibly);else if(St(t)){var s=this.text,a=s.computed;null==a?this.text=new Date(t):a.getTime()!==t&&(a.setTime(t),s.compute(!0))}this._forcibly=void 0,fb.set(this,e,r,this._column)},e.prototype.unset=function(t){this._row=void 0,this._rowIndex=-1,this._forcibly||(this._forcibly=t)},e.prototype.getType=function(){return"DTableBodyCellTime"},e}(Dv),Vb=function(t){function e(e,n,i,r){var o;return t.call(this,e,n,i,hd.toStateOptions(null===(o=null==r?void 0:r.link)||void 0===o?void 0:o.target,r))||this}return F(e,t),e.prototype.newPadding=function(t,e,n){return new tg(t,e,n)},e.prototype.onClick=function(e){var n;!0!==(null===(n=this.link)||void 0===n?void 0:n.onClick(this,e))&&t.prototype.onClick.call(this,e)},Object.defineProperty(e.prototype,"link",{get:function(){var t=this._link;return void 0===t&&(t=this.newLink(),this._link=t),t},enumerable:!1,configurable:!0}),e.prototype.newLink=function(){var t,e=null===(t=this._options)||void 0===t?void 0:t.link;return e?new ld(Nb(this,e)):null},e.prototype.onActivate=function(e){var n;t.prototype.onActivate.call(this,e),this.state.is(kb.HAS_CHILDREN)?this.toggle():null===(n=this.link)||void 0===n||n.open(e)},e.prototype.toggle=function(){var t=this._row;if(void 0!==t){var e=this.parent;if(null!=e){var n=e.parent;if(null!=n){var i=n.data;i&&i.toggle&&(i.isExpanded(t)?i.collapse(t)&&(this.emit("collapse",this),i.emit("collapse",t,this)):i.expand(t)&&(this.emit("expand",this),i.emit("expand",t,this)))}}}},e.prototype.onRowSelect=function(t,e){return e.x<=this.position.x+this.padding.getLeft()&&(this.toggle(),!0)},e.prototype.set=function(t,e,n,i,r,o){this._row=e,this._rowIndex=i,this.text=t,fb.set(this,e,r,this._column,!1);var s=this.link,a=this._padding;if(null!=n){var u=!!(1&n),l=!!(2&n),h=n>>2,c=this.state;c.lock(),c.set(kb.HAS_CHILDREN,l),c.set(kb.OPENED,u),c.unlock(),a.adjLeft(this.theme.getLevelPadding(h)),s&&(s.menu.enable=!l)}else this.state.removeAll(kb.OPENED,kb.HAS_CHILDREN),a.adjLeft(0),s&&(s.menu.enable=!1)},e.prototype.getType=function(){return"DTableBodyCellTree"},e}(bb),Wb={NONE:0,SINGLE:1,MULTIPLE:2},Kb=function(t){function e(e,n,i){var r=t.call(this,i)||this;return r._reverse=!0,r._frozen=n,r._columns=e,r}return F(e,t),e.prototype.initCells=function(){for(var t=this._columns,e=this._frozen,n=this._options,i=this.toIndexEnd(t),r=t.length-1;0<=r;--r){var o=this.newCell(r,t[r],t,n),s=o.state;s.lock(!1),0===r&&s.add(kb.START),r===i&&s.add(kb.END),r<e&&s.add(kb.FROZEN),r===e-1&&s.add(kb.FROZEN_END),s.unlock(),this.addChild(o)}},e.prototype.toIndexEnd=function(t){for(var e=t.length,n=0;n<e;++n)if(void 0!==t[n].weight)return e-1;return e},e.prototype.onRefit=function(){t.prototype.onRefit.call(this),this.resetFrozenCellPosition()},e.prototype.updateFrozenCellPosition=function(t){for(var e=this._columns,n=this.children,i=n.length,r=this._frozen,o=0;o<r;++o){var s=e[o];n[i-1-o].position.x=-t+s.offset}},e.prototype.resetFrozenCellPosition=function(){for(var t=this._columns,e=this.children,n=e.length,i=this._frozen,r=this.getContentPositionX(),o=0;o<i;++o){var s=t[o],a=e[n-1-o];s.offset=a.position.x,a.position.x=-r+s.offset}},e.prototype.getClippingRect=function(e,n){t.prototype.getClippingRect.call(this,e,n);var i=this._frozen;if(0<i){var r=e;if(r&&r.parent===this){var o=this.children,s=o.indexOf(r);if(0<=s&&i<=o.length-1-s){var a=o[s+1],u=a.position.x+a.width;n.x+=u,n.width-=u}}}},e.prototype.getType=function(){return"DTableRow"},e}(ja),Xb=function(t){function e(e,n,i,r,o,s){var a=t.call(this,r,o,s)||this;return a._index=-1,a._onChange=e,a._onCellChangeBound=function(t,e,n,i,r,o){a.onCellChange(t,e,n,i,r,o)},a._columnIndexToCellOptions=i,a.state.isAlternated=!n,a.initCells(),a}return F(e,t),e.prototype.onCellChange=function(t,e,n,i,r,o){if(this.emit("change",t,e,n,i,r,this),o.update===wb.ROW){var s=this._value,a=this._supplimental,u=this._index;void 0!==s&&void 0!==a&&this.set(s,a,u,!0)}this._onChange(t,e,n,i,r,o,this)},e.prototype.newCell=function(t,e,n,i){var r=this._onCellChangeBound,o=this._columnIndexToCellOptions,s=o.get(t);if(null==s&&(s=this.toCellOptions(t,e,i),o.set(t,s)),!1!==e.editing.enable)return this.newCellEditable(t,e,r,s);var a=this.newCellUnediable(t,e,r,s);return e.type!==Tb.TREE&&(a.state.isReadOnly=!0),a},e.prototype.newCellEditable=function(t,e,n,i){switch(e.type){case Tb.INDEX:return new xb(t,e,n,i);case Tb.TEXT:return new Rb(t,e,n,i);case Tb.TEXT_AREA:return new Ab(t,e,n,i);case Tb.TREE:return new Lb(t,e,n,i);case Tb.INTEGER:return new Db(t,e,n,i);case Tb.REAL:return new Ib(t,e,n,i);case Tb.CHECK:case Tb.CHECK_SINGLE:return new Eb(t,e,n,i);case Tb.COLOR:return new Ob(t,e,n,i);case Tb.BUTTON:return new bb(t,e,n,i);case Tb.LINK:return new Ub(t,e,n,i);case Tb.SELECT:return this.newCellSelect(t,e,n,i);case Tb.ACTION:return this.newCellAction(t,e,n,i);case Tb.DATE:return new Cb(t,e,n,i);case Tb.DATETIME:return new Sb(t,e,n,i);case Tb.TIME:return new Gb(t,e,n,i);default:return new mb(t,e,n,i)}},e.prototype.newCellUnediable=function(t,e,n,i){switch(e.type){case Tb.INDEX:return new xb(t,e,n,i);case Tb.TEXT:return new mb(t,e,n,i);case Tb.TEXT_AREA:return new Hb(t,e,n,i);case Tb.TREE:return new Vb(t,e,n,i);case Tb.INTEGER:case Tb.REAL:return new mb(t,e,n,i);case Tb.CHECK:case Tb.CHECK_SINGLE:return new Eb(t,e,n,i);case Tb.COLOR:return new Ob(t,e,n,i);case Tb.BUTTON:return new bb(t,e,n,i);case Tb.LINK:return new Ub(t,e,n,i);case Tb.SELECT:return this.newCellSelect(t,e,n,i);case Tb.ACTION:return this.newCellAction(t,e,n,i);case Tb.DATE:return new Cb(t,e,n,i);case Tb.DATETIME:return new Sb(t,e,n,i);case Tb.TIME:return new Gb(t,e,n,i);default:return new mb(t,e,n,i)}},e.prototype.newCellSelect=function(t,e,n,i){var r=e.selecting;return null!=r.menu?new jb(t,e,n,i):null!=r.multiple?new Fb(t,e,n,i):null!=r.dialog?new db(t,e,n,i):null!=r.promise?new vb(t,e,n,i):new mb(t,e,n,i)},e.prototype.newCellAction=function(t,e,n,i){var r=e.selecting;return null!=r.menu?new gb(t,e,n,i):null!=r.dialog?new yb(t,e,n,i):null!=r.promise?new _b(t,e,n,i):new mb(t,e,n,i)},e.prototype.toCellOptions=function(t,e,n){var i,r,o,s,a,u,l,h,c,p,f,d,y,g,v=Ry(e.body,null==n?void 0:n.cell);v.weight=e.weight,v.width=e.width,null!==(i=v.state)&&void 0!==i||(v.state=e.state.initial);var _=e.formatter;null!=_&&(null!==(o=(b=null!==(r=v.text)&&void 0!==r?r:v.text={}).formatter)&&void 0!==o||(b.formatter=_));var m=e.align;if(null!=m){var b,T=null!==(a=(b=null!==(s=v.text)&&void 0!==s?s:v.text={}).align)&&void 0!==a?a:b.align={};null!==(u=T.horizontal)&&void 0!==u||(T.horizontal=m)}var w=e.editing;if(!1!==w.enable){var E=null!==(l=(g=v).editing)&&void 0!==l?l:g.editing={};null!==(h=E.formatter)&&void 0!==h||(E.formatter=w.formatter),null!==(c=E.unformatter)&&void 0!==c||(E.unformatter=w.unformatter),null!==(p=E.validator)&&void 0!==p||(E.validator=w.validator)}var O=e.link;void 0!==O&&(v.link=O);var C=e.selecting,S=null!==(f=C.menu)&&void 0!==f?f:C.multiple;return void 0!==S&&(v.menu=S),(null!==(y=null===(d=null==n?void 0:n.selection)||void 0===d?void 0:d.type)&&void 0!==y?y:Wb.NONE)!==Wb.NONE&&(v.when="DOUBLE_CLICKED",v.cursor=function(t){if(t.in(kb.SELECTABLE))return"pointer"}),v},e.prototype.getType=function(){return"DTableBodyRow"},Object.defineProperty(e.prototype,"value",{get:function(){return this._value},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),e.prototype.isCell=function(t){return null!=t&&"set"in t},e.prototype.set=function(t,e,n,i){if(i||this._value!==t||this._supplimental!==e||this._index!==n){this._value=t,this._supplimental=e,this._index=n;for(var r=this.children,o=r.length,s=this._columns,a=s.length,u=0;u<o;++u){var l=r[u],h=a-1-u,c=s[h];this.isCell(l)&&l.set(c.getter(t,h),t,e,n,h,i)}this.onSet(t,n)}},e.prototype.onSet=function(t,e){this.emit("set",t,e,this)},e.prototype.unset=function(t){if(t||void 0!==this._value){this._value=void 0,this._index=-1;for(var e=this.children,n=e.length,i=0;i<n;++i){var r=e[i];this.isCell(r)&&r.unset(t)}this.onUnset()}},e.prototype.onUnset=function(){this.emit("unset",this)},e.prototype.getContentPositionX=function(){var t=this.parent;if(t){var e=t.parent;if(e)return e.position.x}return 0},e}(Kb),Yb=function(t){function e(e){var n=t.call(this)||this;return n._id=0,n._idUpdated=-1,n._isApplied=!1,n._sorterId=-1,n._parent=e,n._filter=null,n._filtered=null,n}return F(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),e.prototype.apply=function(){this._isApplied=!0,this._id+=1,this._parent.update()},e.prototype.unapply=function(){this._isApplied&&(this._isApplied=!1,this._id+=1,this._parent.update())},e.prototype.isApplied=function(){return this._isApplied},e.prototype.newFiltered=function(){var t=this._filter;if(null!=t){var e,n=[],i=this._parent,r=i.sorter,o=i.rows;if(Ct(t))if(e=r.indices)for(var s=0,a=e.length;s<a;++s)t(o[u=e[s]],u)&&n.push(s);else for(s=0,a=o.length;s<a;++s)t(o[s],s)&&n.push(s);else if(e=r.indices)for(s=0,a=e.length;s<a;++s){var u=e[s];t.test(o[u],u)&&n.push(s)}else for(s=0,a=o.length;s<a;++s)t.test(o[s],s)&&n.push(s);return n}return null},e.prototype.get=function(){return this._filter},e.prototype.set=function(t){this._filter!==t&&(this._filter=t)},e.prototype.toDirty=function(){this._id+=1},e.prototype.update=function(){this._id===this._idUpdated&&this._parent.sorter.id===this._sorterId||(this._idUpdated=this._id,this._sorterId=this._parent.sorter.id,this._isApplied?(this._filtered=this.newFiltered(),this.emit("change",this)):null!=this._filtered&&(this._filtered=null,this.emit("change",this)))},Object.defineProperty(e.prototype,"indices",{get:function(){return this.update(),this._filtered},enumerable:!1,configurable:!0}),e.prototype.map=function(t){var e=t,n=this.indices;if(n){var i=n.indexOf(e);if(!(0<=i))return null;e=i}return e},e.prototype.unmap=function(t){var e=t,n=this.indices;return n&&(e=n[e]),e},e}(t.utils.EventEmitter),qb=function(){function t(t){this._parent=t}return Object.defineProperty(t.prototype,"rows",{get:function(){var t=[];return this.each((function(e){t.push(e)})),t},enumerable:!1,configurable:!0}),t.prototype.map=function(t){var e=this._parent,n=e.sorter.map(t);return null!=n?e.filter.map(n):null},t.prototype.unmap=function(t){var e=this._parent;return e.sorter.unmap(e.filter.unmap(t))},t.prototype.size=function(){var t=this._parent,e=t.filter.indices;return null!=e?e.length:t.size()},t.prototype.get=function(t){return this._parent.get(this.unmap(t))},t.prototype.each=function(t,e,n){var i=this._parent,r=i.rows,o=i.supplimentals,s=i.filter.indices,a=i.sorter.indices;if(e=null!=e?Math.max(0,e):0,s){var u=s.length;if(n=null!=n?Math.min(u,n):u,a)for(var l=e;l<n&&!1!==t(r[h=a[s[l]]],o?o[h]:null,l,h);++l);else for(l=e;l<n&&!1!==t(r[h=s[l]],o?o[h]:null,l,h);++l);}else if(u=r.length,n=null!=n?Math.min(u,n):u,a)for(l=e;l<n;++l){var h;if(!1===t(r[h=a[l]],o?o[h]:null,l,h))break}else for(l=e;l<n&&!1!==t(r[l],o?o[l]:null,l,l);++l);},t}(),Zb=function(t,e){return t[0]-e[0]},Jb=function(t){function e(e,n){var i,r=t.call(this)||this;r._parent=e,r._type=ai(null!==(i=null==n?void 0:n.type)&&void 0!==i?i:Wb.NONE,Wb),r._indices=new Set;var o=null==n?void 0:n.on;if(o)for(var s in o){var a=o[s];a&&r.on(s,a)}return r}return F(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),e.prototype.onChange=function(){this._parent.update(),this.emit("change",this)},e.prototype.toggle=function(t){var e=this._indices;e.has(t)?e.delete(t):e.add(t),this.onChange()},e.prototype.add=function(t){var e=this._indices,n=e.size;e.add(t),n!==e.size&&this.onChange()},Object.defineProperty(e.prototype,"first",{get:function(){var t=this._indices;if(0<t.size){var e=-1;return t.forEach((function(t){e<0&&(e=t)})),e}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){var t=this._indices;if(0<t.size){var e=0;return t.forEach((function(t){e=t})),e}return null},enumerable:!1,configurable:!0}),e.prototype.addTo=function(t){var e=this.last;null!=e&&this.addRange(e,!1,t,!0)},e.prototype.addRange=function(t,e,n,i){var r=this._indices,o=r.size;if(t<n)for(var s=n+(i?1:0),a=t+(e?0:1);a<s;++a)r.add(a);else for(s=t+(e?1:0),a=n+(i?0:1);a<s;++a)r.add(a);o!==r.size&&this.onChange()},e.prototype.addAll=function(t){for(var e=this._indices,n=e.size,i=0,r=t.length;i<r;++i)e.add(t[i]);n!==e.size&&this.onChange()},e.prototype.contains=function(t){return this._indices.has(t)},e.prototype.remove=function(t){this._indices.delete(t)&&this.onChange()},e.prototype.clear=function(){var t=this._indices;0<t.size&&(t.clear(),this.onChange())},e.prototype.clearAndAdd=function(t){var e=this._indices;e.has(t)&&1===e.size||(e.clear(),e.add(t),this.onChange())},e.prototype.clearAndAddAll=function(t){var e=this._indices;if(0<e.size||0<t.length){e.clear();for(var n=0,i=t.length;n<i;++n)e.add(t[n]);this.onChange()}},e.prototype.shift=function(t,e){var n=[],i=this._indices;if(i.forEach((function(e){t<=e&&n.push(e)})),0<n.length){for(var r=0,o=n.length;r<o;++r)i.delete(n[r]);for(r=0,o=n.length;r<o;++r)i.add(n[r]+e);this.onChange()}},e.prototype.size=function(){return this._indices.size},e.prototype.isEmpty=function(){return 0===this._indices.size},e.prototype.each=function(t){var e=!1;this._indices.forEach((function(n){e||!1===t(n)&&(e=!0)}))},Object.defineProperty(e.prototype,"indices",{get:function(){var t=[];return this._indices.forEach((function(e){t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){var t=[],e=this._parent;return this._indices.forEach((function(n){t.push(e.get(n))})),t},enumerable:!1,configurable:!0}),e.prototype.toArray=function(){var t=[],e=this._parent;return this._indices.forEach((function(n){t.push([n,e.get(n)])})),t},e.prototype.toSortedArray=function(){return this.toArray().sort(Zb)},e.prototype.toObject=function(){var t={},e=this._parent;return this._indices.forEach((function(n){t[n]=e.get(n)})),t},e.prototype.toMap=function(){var t=new Map,e=this._parent;return this._indices.forEach((function(n){t.set(n,e.get(n))})),t},e}(t.utils.EventEmitter),Qb={ASCENDING:0,DESCENDING:1},$b=function(t){function e(e){var n=t.call(this)||this;return n._id=0,n._idUpdated=-1,n._isApplied=!1,n._parent=e,n._comparator=null,n._sorted=null,n._order=Qb.ASCENDING,n}return F(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return this._order},set:function(t){this._order=t},enumerable:!1,configurable:!0}),e.prototype.apply=function(){this._isApplied=!0,this._id+=1,this._parent.update()},e.prototype.unapply=function(){this._isApplied&&(this._isApplied=!1,this._id+=1,this._parent.update())},e.prototype.isApplied=function(){return this._isApplied},e.prototype.newSorted=function(){var t=this._comparator;if(null!=t){for(var e=[],n=this._parent.rows,i=0,r=n.length;i<r;++i)e.push(i);return e.sort(this.toComparator(n,t)),e}return null},e.prototype.toComparator=function(t,e){var n=this._order;return Ct(e)?n===Qb.ASCENDING?function(n,i){return e(t[n],t[i],n,i)}:function(n,i){return e(t[i],t[n],i,n)}:n===Qb.ASCENDING?function(n,i){return e.compare(t[n],t[i],n,i)}:function(n,i){return e.compare(t[i],t[n],i,n)}},e.prototype.get=function(){return this._comparator},e.prototype.set=function(t){this._comparator!==t&&(this._comparator=t)},e.prototype.toDirty=function(){this._id+=1},e.prototype.update=function(){this._id!==this._idUpdated&&(this._idUpdated=this._id,this._isApplied?(this._sorted=this.newSorted(),this.emit("change",this)):null!=this._sorted&&(this._sorted=null,this.emit("change",this)))},Object.defineProperty(e.prototype,"indices",{get:function(){return this.update(),this._sorted},enumerable:!1,configurable:!0}),e.prototype.map=function(t){var e=t,n=this.indices;if(n){var i=n.indexOf(e);if(!(0<=i))return null;e=i}return e},e.prototype.unmap=function(t){var e=t,n=this.indices;return n&&(e=n[e]),e},e}(t.utils.EventEmitter),tT=function(e){function n(t){var n=e.call(this)||this;if(n._parent=null,n._rows=n.toRows(null==t?void 0:t.rows),n._mapped=new qb(n),n._selection=n.toSelection(null==t?void 0:t.selection),n._filter=new Yb(n),n._sorter=new $b(n),t){var i=t.filter;i&&n._filter.set(i);var r=t.comparator;r&&n._sorter.set(r);var o=t.on;if(o)for(var s in o){var a=o[s];a&&n.on(s,a)}}return n}return F(n,e),n.prototype.toSelection=function(e){return e instanceof t.utils.EventEmitter?e:Ct(e)?e(this):this.newSelection(e)},n.prototype.newSelection=function(t){return new Jb(this,t)},n.prototype.bind=function(t){this._parent=t},n.prototype.toRows=function(t){var e=[];if(null!=t)for(var n=0,i=t.length;n<i;++n)e.push(t[n]);return e},Object.defineProperty(n.prototype,"rows",{get:function(){return this._rows},enumerable:!1,configurable:!0}),n.prototype.update=function(t){var e=this._parent;e&&e.update(t)},n.prototype.lock=function(){var t=this._parent;t&&t.lock()},n.prototype.unlock=function(t){var e=this._parent;e&&e.unlock(t)},n.prototype.size=function(){return this._rows.length},n.prototype.clear=function(){var t=this._rows;0<t.length&&(t.length=0,this.lock(),this._selection.clear(),this._sorter.toDirty(),this._filter.toDirty(),this.update(),this.unlock(!0))},n.prototype.clearAndAdd=function(t){var e=this._rows;e.length=0,e.push(t),this.lock(),this._selection.clear(),this._sorter.toDirty(),this._filter.toDirty(),this.update(),this.unlock(!0)},n.prototype.clearAndAddAll=function(t){var e=this._rows;e.length=0;for(var n=0,i=t.length;n<i;++n)e.push(t[n]);this.lock(),this._selection.clear(),this._sorter.toDirty(),this._filter.toDirty(),this.update(),this.unlock(!0)},n.prototype.add=function(t,e){var n=this._rows,i=this._selection,r=this._sorter,o=this._filter;null==e?(n.push(t),this.lock(),r.toDirty(),o.toDirty(),this.update(),this.unlock(!0)):0<=e&&e<n.length&&(n.splice(e,0,t),this.lock(),i.shift(e,1),r.toDirty(),o.toDirty(),this.update(),this.unlock(!0))},n.prototype.addAll=function(t,e){var n=this._rows,i=n.length,r=this._selection,o=this._sorter,s=this._filter;if(null==e){for(var a=0,u=l=t.length;a<u;++a)n.push(t[a]);this.lock(),o.toDirty(),s.toDirty(),this.update(),this.unlock(!0)}else if(0<=e&&e<i){var l=t.length;for(a=0;a<l;++a)n.splice(e+a,0,t[a]);this.lock(),r.shift(e,l),o.toDirty(),s.toDirty(),this.update(),this.unlock(!0)}},n.prototype.get=function(t){var e=this._rows;return 0<=t&&t<e.length?e[t]:null},n.prototype.set=function(t,e){var n=this._rows;if(0<=t&&t<n.length){var i=n[t];return n[t]=e,this.lock(),this._sorter.toDirty(),this._filter.toDirty(),this.update(),this.unlock(!0),i}return null},n.prototype.remove=function(t){var e=this._rows;if(0<=t&&t<e.length){var n=e.splice(t,1)[0];return this.lock(),this._selection.remove(t),this._sorter.toDirty(),this._filter.toDirty(),this.update(),this.unlock(!0),n}return null},n.prototype.each=function(t,e,n){var i=this._rows;e=null!=e?Math.max(0,e):0,n=null!=n?Math.min(i.length,n):i.length;for(var r=e;r<n&&!1!==t(i[r],r);++r);},Object.defineProperty(n.prototype,"selection",{get:function(){return this._selection},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"filter",{get:function(){return this._filter},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sorter",{get:function(){return this._sorter},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mapped",{get:function(){return this._mapped},enumerable:!1,configurable:!0}),n}(t.utils.EventEmitter),eT=function(e){function n(t,n,i,r){var o=e.call(this,r)||this;o.transform.position.y=i;var s=o.toData(r.data);o._data=s,s.bind(o);var a=o.theme;o._columns=t,o._frozen=n;var u=function(t,e,n){var i=e.row;return null!=i?(null==i.height&&(i.height=t.getRowHeight()),void 0===i.selection?i.selection={type:n}:void 0===i.selection.type&&(i.selection.type=n)):i={height:t.getRowHeight(),selection:{type:n}},i}(a,r,s.selection.type);return o._rowOptions=u,o._rowHeight=null!=u.height?u.height:a.getRowHeight(),o._rowIndexMappedStart=0,o._rowIndexMappedEnd=0,o._updateRowsCount=0,o._isUpdateRowsCalled=!1,o._isUpdateRowsCalledForcibly=!1,o._workRows=[],o._onRowChangeBound=function(t,e,n,i,r,s){o.onRowChange(t,e,n,i,r,s)},o._columnIndexToCellOptions=new Map,o._data.emit("init",o._data),o}return F(n,e),n.prototype.onRowChange=function(t,e,n,i,r,o){var s=this._data;s.emit("change",t,e,n,i,r,s),o.update===wb.ALL&&this.update(!0)},n.prototype.toData=function(t){return this.isData(t)?t:new tT(t)},n.prototype.isData=function(t){return null!=t&&"mapped"in t},n.prototype.onResize=function(t,n,i,r){e.prototype.onResize.call(this,t,n,i,r),this.update()},Object.defineProperty(n.prototype,"selection",{get:function(){return this._data.selection},enumerable:!1,configurable:!0}),n.prototype.lock=function(){this._updateRowsCount+=1,1===this._updateRowsCount&&(this._isUpdateRowsCalled=!1,this._isUpdateRowsCalledForcibly=!1)},n.prototype.unlock=function(t){this._updateRowsCount-=1,0===this._updateRowsCount&&(t&&this._isUpdateRowsCalled&&this.update(this._isUpdateRowsCalledForcibly),this._isUpdateRowsCalled=!1,this._isUpdateRowsCalledForcibly=!1)},n.prototype.update=function(t){if(0<this._updateRowsCount)return this._isUpdateRowsCalled=!0,void(t&&(this._isUpdateRowsCalledForcibly=!0));var e=this.parent;if(null!=e){var n=e.parent;if(null!=n){var i=this.children,r=n.height,o=this._rowHeight,s=this._data,a=s.mapped.size(),u=this._rowIndexMappedStart,l=this._rowIndexMappedEnd,h=l-u,c=this.transform.position.y,p=c+a*o,f=Math.max(r,p),d=Math.max(r-f,e.position.y),y=-d/o,g=(r-(d+c))/o,v=Math.floor(y);v-=v%2==0?2:1;var _=Math.floor(g),m=(_+=(_-v)%2==1?3:2)-v;if(m<h&&(_=v+(m=h)),h<m){for(var b=h;b<m;++b){var T=u+b,w=this.newRow(T%2==0);this.addChild(w)}l=u+(h=m)}else if(m<h){for(b=h-1;m<=b;--b)this.removeChild(i[b]);l=u+(h=m)}this._rowIndexMappedStart=v,this._rowIndexMappedEnd=_;var E=v-u,O=Math.abs(E),C=i.length;if(0<O&&O<C){var S=this._workRows;if(0<E){for(b=0;b<O;++b)S.push(this.resetRow(i[b]));for(b=O;b<C;++b)i[b-O]=i[b];for(b=0;b<O;++b)i[C-O+b]=S[b]}else{for(b=0;b<O;++b)S.push(this.resetRow(i[C-O+b]));for(b=C-O-1;0<=b;--b)i[b+O]=i[b];for(b=0;b<O;++b)i[b]=S[b]}S.length=0}var x=s.selection,D=x.type!==Wb.NONE;for(s.mapped.each((function(e,n,r,s){var a=i[r-v];a.position.y=r*o;var u=a.state;u.lock(),u.add(kb.HAS_DATA),u.set(kb.SELECTABLE,D),u.set(vt.ACTIVE,x.contains(s)),u.remove(vt.DISABLED),u.unlock(),a.set(e,n,s,t)}),v,v+C),b=0;v+b<0&&b<C;++b)(I=i[b]).position.y=(v+b)*o,(A=I.state).lock(),A.add(vt.DISABLED),A.removeAll(kb.HAS_DATA,kb.SELECTABLE,vt.ACTIVE),A.unlock(),I.unset(t);for(b=C-1;a<=v+b&&0<=b;--b){var I,A;(I=i[b]).position.y=(v+b)*o,(A=I.state).lock(),A.add(vt.DISABLED),A.removeAll(kb.HAS_DATA,kb.SELECTABLE,vt.ACTIVE),A.unlock(),I.unset(t)}this.lock(),e.position.y=d,e.height=f,this.height=p,this.unlock(!1),this.emit("update",y,g,this)}}},n.prototype.resetRow=function(t){t.blur(!0);for(var e=t.children,n=0,i=e.length;n<i;++n){var r=e[n];r instanceof ao&&(r.state.isPressed=!1)}return t},n.prototype.newRow=function(t){return new Xb(this._onRowChangeBound,t,this._columnIndexToCellOptions,this._columns,this._frozen,this._rowOptions)},n.prototype.onParentMove=function(t,n,i,r){e.prototype.onParentMove.call(this,t,n,i,r),this.updateFrozenCellPosition(t)},n.prototype.updateFrozenCellPosition=function(t){var e=this._frozen;if(null!=e&&0<e)for(var n=this.children,i=0,r=n.length;i<r;++i)n[i].updateFrozenCellPosition(t)},n.prototype.getClippingRect=function(t,n){e.prototype.getClippingRect.call(this,t,n);var i=this.parent;if(i){var r=-i.transform.position.y;n.y+=r,n.height-=r}},n.prototype.scrollTo=function(t){var e=this.parent;if(null==e)return!1;var n=e.parent;if(null==n)return!1;var i=-1;return St(t)?0<=t&&t<this.data.mapped.size()&&(i=t):this.data.mapped.each((function(e,n,r){return e!==t||(i=r,!1)})),!(i<0||(e.position.y=Math.max(Math.min(0,n.height-e.height),-i*this._rowHeight),ft.update(this),0))},n.prototype.toRowIndexMapped=function(t){if(0<=this.parent.position.y+t){var e=Math.floor(t/this._rowHeight);if(0<=e&&e<this._data.mapped.size())return e}return-1},n.prototype.toRow=function(t){var e=t-this._rowIndexMappedStart,n=this.children;return 0<=e&&e<n.length?n[e]:null},n.prototype.toCell=function(t,e){for(var n=t.children,i=n.length,r=this._columns.length,o=0,s=Math.min(i,r);o<s;++o){var a=n[i-o-1],u=e-a.position.x;if(0<=u&&u<=a.width)return a}return null},n.prototype.onRowClick=function(t){if(this.state.isActionable){var e=n.WORK_ON_CLICK;e.copyFrom(t.data.global),this.toLocal(e,void 0,e,!1);var i=this.toRowIndexMapped(e.y);if(0<=i){var r=this.toRow(i);if(r){var o=this.toCell(r,e.x);if(o&&o.onRowSelect&&o.onRowSelect(t,e))return}this.onRowSelect(t,i)}}},n.prototype.onRowSelect=function(t,e){var n=this._data,i=n.selection,r=i.type===Wb.SINGLE,o=!r,s=n.mapped.unmap(e),a=t.data.originalEvent,u=a.ctrlKey,l=a.shiftKey;if(r||i.isEmpty()||!o||!u&&!l)i.clearAndAdd(s);else if(u)i.toggle(s);else if(l){var h=i.last;if(null!=h){var c=n.sorter,p=n.filter,f=c.map(s),d=c.map(h);if(null!=f&&null!=d){var y=d+1,g=f+1;if(f<d&&(y=f,g=d),y<g){var v=[],_=p.indices,m=c.indices;if(_)if(m)for(var b=0,T=_.length;b<T;++b)y<=(w=_[b])&&w<g&&v.push(m[w]);else for(b=0,T=_.length;b<T;++b){var w;y<=(w=_[b])&&w<g&&v.push(w)}else if(m)for(b=y;b<g;++b)v.push(m[b]);else for(b=y;b<g;++b)v.push(b);i.addAll(v)}}}}},n.prototype.onDblClick=function(t,n){return e.prototype.onDblClick.call(this,t,n)},n.prototype.getType=function(){return"DTableBody"},Object.defineProperty(n.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),n.WORK_ON_CLICK=new t.Point,n}(ao),nT={NONE:0,LEFT:1,RIGHT:2,BOTH:3},iT=function(){function e(t,e,n,i){this._row=t,this._cell=e,this._columnIndex=n,this._size=i,this._dragged=!1,this._minWidth=8}return e.prototype.findResizableCell=function(t,e,n){var i=this._row.children,r=i.length;if(e){for(var o=t;o<r;++o)if((a=(s=i[r-o-1]).column).resizable){if(null==n)return s;if(!0===n){if(null!=a.weight)return s}else if(null==a.weight)return s}}else for(o=t;0<=o;--o){var s,a;if((a=(s=i[r-o-1]).column).resizable){if(null==n)return s;if(!0===n){if(null!=a.weight)return s}else if(null==a.weight)return s}}return null},e.prototype.findCells=function(t,e,n){var i=[],r=this._row.children,o=r.length;if(e)for(var s=t;s<o;++s){var a=r[o-s-1];n?null!=a.column.weight&&i.push(a):null==a.column.weight&&i.push(a)}else for(s=t;0<=s;--s)a=r[o-s-1],n?null!=a.column.weight&&i.push(a):null==a.column.weight&&i.push(a);return i},e.prototype.calcData=function(t){var e=this.findResizableCell(t,!1,null);if(null!=e){var n=e.column,i=this.findResizableCell(t+1,!0,null);if(null!=i){var r=i.column;return null==n.weight?null==r.weight?[1,e,i]:[2,e,i,this.findCells(0,!0,!0)]:null==r.weight?[3,e,i,this.findCells(0,!0,!0)]:[1,e,i]}return null==n.weight&&this.findCells(e.columnIndex-1,!1,!0).length<=0?[0,e]:null}return null},Object.defineProperty(e.prototype,"left",{get:function(){var t=this._left;return void 0===t&&(t=this.calcData(this._columnIndex-1),this._left=t),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"right",{get:function(){var t=this._right;return void 0===t&&(t=this.calcData(this._columnIndex),this._right=t),t},enumerable:!1,configurable:!0}),e.prototype.onDown=function(t){var e=this._cell,n=e.state.valueOf(kb.HOVERED_ON_EDGE);if(null!=n){this._dragged=!0;var i=ft.getLayer(e);if(null!=i){var r=i.renderer.plugins.interaction;if(n===nT.LEFT){var o=this.left;null!=o&&this.onDown_(t.data.global.x,o,r)}else{var s=this.right;null!=s&&this.onDown_(t.data.global.x,s,r)}}return!0}return this._dragged=!1,!1},e.prototype.onDown_=function(t,e,n){switch(e[0]){case 0:this.onDown0(t,e,n);break;case 1:this.onDown1(t,e,n);break;case 2:this.onDown2(t,e,n);break;case 3:this.onDown3(t,e,n)}},e.prototype.onOver=function(t){var e,n=this;if(null!=this.left||null!=this.right){var i=null!==(e=this._onHoveredBound)&&void 0!==e?e:this._onHoveredBound=function(t){n.onHovered(t)},r=this._cell;r.off(cr.move,i),r.on(cr.move,i),this.onHovered(t);var o=ft.getLayer(r);null!=o&&(o.renderer.plugins.interaction.cursor=r.cursor)}},e.prototype.onOut=function(t){var e=this._onHoveredBound;if(null!=e){var n=this._cell;n.state.remove(kb.HOVERED_ON_EDGE),n.off(cr.move,e)}},e.prototype.onHovered=function(t){var e=this._cell,n=e.width,i=this.toX(t),r=this._size,o=0<=i&&i<=r,s=n-r<=i&&i<=n;o&&s&&(i<=n-i?s=!1:o=!1),o?null!=this.left?e.state.add(kb.HOVERED_ON_EDGE,nT.LEFT):e.state.remove(kb.HOVERED_ON_EDGE):s&&null!=this.right?e.state.add(kb.HOVERED_ON_EDGE,nT.RIGHT):e.state.remove(kb.HOVERED_ON_EDGE)},e.prototype.toX=function(e){var n,i=null!==(n=this._checkWork)&&void 0!==n?n:this._checkWork=new t.Point;return this._cell.toLocal(e.data.global,void 0,i,!0).x},e.prototype.onDown0=function(t,e,n){var i=e[1],r=i.column,o=i.width,s=Math.max(this._minWidth,r.minWidth);this.newOnUp((function(e){r.width=Math.max(s,o+e.data.global.x-t)}),n)},e.prototype.onDown1=function(t,e,n){var i=this._minWidth,r=e[1],o=r.column,s=r.width,a=e[2],u=a.column,l=a.width,h=s+l;if(null==o.weight){var c=Math.max(i,o.minWidth),p=Math.max(i,u.minWidth),f=h-p;if(h<=0||f<=c)return;var d=function(e){var n=Math.max(c,Math.min(f,s+e.data.global.x-t));o.width=n,u.width=h-n};this.newOnUp(d,n)}else{var y=r.weight+a.weight,g=o.minWeight,v=u.minWeight,_=y-v,m=i,b=h-(p=i);if(h<=0||b<=m||_<=g)return;d=function(e){var n=Math.max(m,Math.min(b,s+e.data.global.x-t)),i=Math.max(g,Math.min(_,y*(n/h)));o.weight=i,u.weight=y-i},this.newOnUp(d,n)}},e.prototype.onDown2=function(t,e,n){e[3].length<=1?this.onDown2a(t,e,n):this.onDown2b(t,e,n)},e.prototype.onDown2a=function(t,e,n){var i=this._minWidth,r=e[1],o=r.column,s=r.width,a=Math.max(i,o.minWidth),u=e[2].width,l=s+u,h=l-i;l<=0||h<=a||this.newOnUp((function(e){o.width=Math.max(a,Math.min(h,s+e.data.global.x-t))}),n)},e.prototype.onDown2b=function(t,e,n){for(var i=this._minWidth,r=e[1],o=r.column,s=r.width,a=Math.max(i,o.minWidth),u=e[2],l=u.column,h=u.width,c=l.minWeight,p=s+h,f=e[3],d=0,y=0,g=0,v=f.length;g<v;++g){var _=f[g];d+=_.weight,y+=_.width}if(d<=0||y<=0){var m=p-(O=i);if(p<=0||m<=a)return;if(d<=0)for(d=0,g=0,v=f.length;g<v;++g){var b=(_=f[g]).column;if(_!==u){var T=b.minWeight;b.weight=T,d+=T}else{var w=Math.max(1,c);b.weight=w,d+=w}}var E=function(e){o.width=Math.max(a,Math.min(m,s+e.data.global.x-t))};this.newOnUp(E,n)}else{var O=Math.max(i,y*(c/d)),C=p-O;if(p<=0||C<=a)return;E=function(e){var n=Math.max(a,Math.min(C,s+e.data.global.x-t)),i=p-n,r=Math.max(c,d*(i/y));o.width=n,l.weight=r},this.newOnUp(E,n)}},e.prototype.onDown3=function(t,e,n){e[3].length<=1?this.onDown3a(t,e,n):this.onDown3b(t,e,n)},e.prototype.onDown3a=function(t,e,n){var i=this._minWidth,r=e[1].width,o=i,s=e[2],a=s.column,u=s.width,l=Math.max(i,a.minWidth),h=r+u,c=h-o;h<=0||c<=l||this.newOnUp((function(e){a.width=Math.max(l,Math.min(c,u+t-e.data.global.x))}),n)},e.prototype.onDown3b=function(t,e,n){for(var i=this._minWidth,r=e[1],o=r.column,s=r.width,a=o.minWeight,u=e[2],l=u.column,h=u.width,c=Math.max(i,l.minWidth),p=s+h,f=e[3],d=0,y=0,g=0,v=f.length;g<v;++g){var _=f[g];d+=_.weight,y+=_.width}if(d<=0||y<=0){var m=p-(O=i);if(p<=0||m<=c)return;if(d<=0)for(d=0,g=0,v=f.length;g<v;++g){var b=(_=f[g]).column;if(_!==r){var T=b.minWeight;b.weight=T,d+=T}else{var w=Math.max(1,a);b.weight=w,d+=w}}var E=function(e){l.width=Math.max(c,Math.min(m,h+t-e.data.global.x))};this.newOnUp(E,n)}else{var O=Math.max(i,y*(a/d)),C=p-O;if(p<=0||C<=c)return;E=function(e){var n=Math.max(c,Math.min(C,h+t-e.data.global.x)),i=p-n,r=Math.max(a,d*(i/y));l.width=n,o.weight=r},this.newOnUp(E,n)}},e.prototype.newOnUp=function(t,e){var n=this._row;n.state.add(kb.RESIZING);var i=function(){n.state.remove(kb.RESIZING),e.off(cr.move,t),e.off(cr.up,i),e.off(cr.upoutside,i),e.off(cr.cancel,i)};return e.on(cr.move,t),e.on(cr.up,i),e.on(cr.upoutside,i),e.on(cr.cancel,i),i},e.prototype.isClicked=function(e){return e instanceof t.InteractionEvent&&(this._cell.state.is(kb.HOVERED_ON_EDGE)||this._dragged)},e}(),rT=function(t){function e(e,n,i,r){var o=t.call(this,r)||this;return o._category=e,o._columnIndex=n,o._column=i,o._edge=new iT(o._category,o,n,o.theme.getEdgeWidth()),o}return F(e,t),Object.defineProperty(e.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"category",{get:function(){return this._category},enumerable:!1,configurable:!0}),e.prototype.onDown=function(e){this._edge.onDown(e)||t.prototype.onDown.call(this,e)},e.prototype.onOver=function(e){t.prototype.onOver.call(this,e),this._edge.onOver(e)},e.prototype.onOut=function(e){t.prototype.onOut.call(this,e),this._edge.onOut(e)},e.prototype.getType=function(){return"DTableCategoryCell"},e}(Zf),oT=function(t){function e(e,n){var i=t.call(this)||this,r=n.category;r&&(xt(r)?0===e&&(i.label=r):e<r.length&&(i.label=r[e])),i._weight=n.weight,i._width=n.width,i._isLocked=!1,i.offset=0,i._columns=[n],i.resizable=n.resizable;var o=function(){i.onResize()};return i._onResizeBound=o,n.on("resize",o),i}return F(e,t),e.prototype.onResize=function(){if(!this._isLocked){var t=this._columns;if(null!=this._weight){for(var e=0,n=0,i=t.length;n<i;++n){var r=t[n].weight;null!=r&&(e+=r)}this._weight!==e&&(this._weight=e,this.emit("resize",this))}else{var o=0;for(n=0,i=t.length;n<i;++n){var s=t[n].width;null!=s&&(o+=s)}this._width!==o&&(this._width=o,this.emit("resize",this))}}},Object.defineProperty(e.prototype,"weight",{get:function(){return this._weight},set:function(t){var e=this._weight;if(null!=e&&e!==t){var n=this._columns,i=n.length,r=this.minWeight,o=Math.max(r,t);if(this._weight!==o){if(this._isLocked=!0,r<e)for(var s=o/e,a=0;a<i;++a)null!=(l=(u=n[a]).weight)&&(u.weight=Math.max(u.minWeight,l*s));else for(a=0;a<i;++a){var u,l;null!=(l=(u=n[a]).weight)&&(u.weight=u.minWeight)}this._isLocked=!1,this.onResize()}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minWeight",{get:function(){for(var t=0,e=this._columns,n=e.length,i=0;i<n;++i){var r=e[i];null!=r.weight&&(t+=r.minWeight)}return t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){var e=this._width;if(null!=e&&e!==t){var n=this._columns,i=n.length,r=this.minWidth,o=Math.max(r,t);if(e!==o){if(this._isLocked=!0,r<e)for(var s=o/e,a=0;a<i;++a)null!=(l=(u=n[a]).width)&&(u.width=Math.max(u.minWidth,l*s));else for(a=0;a<i;++a){var u,l;null!=(l=(u=n[a]).width)&&(u.width=u.minWidth)}this._isLocked=!1,this.onResize()}}},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"minWidth",{get:function(){for(var t=0,e=this._columns,n=e.length,i=0;i<n;++i){var r=e[i];null!=r.width&&(t+=r.minWidth)}return t},enumerable:!1,configurable:!0}),e.prototype.add=function(t){if(this._columns.push(t),null!=this._weight){var e=t.weight;null!=e&&(this._weight+=e,t.on("resize",this._onResizeBound))}else if(null!=this._width){var n=t.width;null!=n&&(this._width+=n,t.on("resize",this._onResizeBound))}},e}(t.utils.EventEmitter),sT=function(t){function e(e,n,i,r){var o=t.call(this,e,n,r)||this;o._columns=e,o._frozen=n,o._offset=i,o.transform.position.y=i,o.initCells();for(var s=0,a=e.length;s<a;++s){var u=e[s];u.on("resize",o.newOnColumnResize(s,u))}return o}return F(e,t),e.prototype.newOnColumnResize=function(t,e){var n=this;return function(){n.onColumnResize(t,e)}},e.prototype.onColumnResize=function(t,e){var n=e.weight;if(null!=n)this.onColumnResizeWeight(this,t,n);else{var i=e.width;null!=i&&this.onColumnResizeWidth(this,t,i)}},e.prototype.onColumnResizeWeight=function(t,e,n){var i=t.children,r=i.length,o=r-e-1;0<=o&&o<r&&(i[o].weight=n)},e.prototype.onColumnResizeWidth=function(t,e,n){var i=t.children,r=i.length,o=r-e-1;0<=o&&o<r&&(i[o].width=n)},e.prototype.onParentMove=function(e,n,i,r){t.prototype.onParentMove.call(this,e,n,i,r),this.transform.position.y=-n+this._offset,this.updateFrozenCellPosition(e)},e.prototype.getContentPositionX=function(){var t=this.parent;return t?t.position.x:0},e.prototype.newCell=function(t,e,n,i){return new rT(this,t,e,this.toCellOptions(t,e,i))},e.prototype.toCellOptions=function(t,e,n){var i=null==n?void 0:n.cell;if(i){i.weight=e.weight,i.width=e.width;var r=i.text||{};return i.text=r,r.value=r.value||e.label,i}return{weight:e.weight,width:e.width,text:{value:e.label}}},e.prototype.getType=function(){return"DTableCategory"},e}(Kb),aT=function(){function t(t,e,n){for(var i=[],r=0,o=this.toCount(t)-1;0<=o;--o){var s=new sT(this.toColumns(o,t,e),e,r,n);i.push(s),r+=s.height}this.items=i}return t.prototype.toCount=function(t){for(var e=0,n=0,i=t.length;n<i;++n){var r=t[n].category;if(null!=r){var o=xt(r)?1:r.length;e=Math.max(e,o)}}return e},t.prototype.isEqual=function(t,e,n){if(null!=e){if(null!=n){if(xt(e))return xt(n)?0<t||e===n:0<t?n.length<=t:1===n.length&&e===n[0];if(xt(n))return 0<t?e.length<=t:1===e.length&&e[0]===n;if(e.length<=t&&n.length<=t)return!0;if(n.length===e.length){for(var i=t,r=e.length;i<r;++i)if(e[i]!==n[i])return!1;return!0}return!1}return xt(e)?0<t:e.length<=t}return null==n||(xt(n)?0<t:n.length<=t)},t.prototype.toColumns=function(t,e,n){for(var i=[],r=null,o=null,s=0,a=e.length;s<a;++s){var u=e[s];s!==n&&o&&r&&this.isEqual(t,r.category,u.category)&&o.resizable===u.resizable&&(null!=o.weight&&null!=u.weight||null!=o.width&&null!=u.width)?o.add(u):(r=u,o=new oT(t,u),i.push(o))}return i},t}(),uT=function(t,e){return t[e]},lT=function(t,e,n){t[e]=n},hT=function(){return""},cT=function(){},pT=function(t){if(null!=t){var e=t.length;if(e<=1){var n=t[0];return function(t){return Object.prototype.hasOwnProperty.call(t,n)}}return function(n){for(var i=0;i<e;++i){var r=t[i];if(!(r in n))return!1;n=n[r]}return!0}}return function(t,e){return e<t.length}},fT=function(t,e){return xt(t)?pT(e):null!=t&&t},dT=function(t,e){return function(n,i){var r=t(n,e),o=t(i,e);return r<o?-1:o<r?1:0}},yT=function(t){return null==t?void 0:t instanceof fg?t:new fg(t)},gT=function(t){return null==t?void 0:"open"in t?t:new Ov(t)},vT=function(t){return t.value},_T=function(){},mT=function(t){function e(e,n){var i,r,o,s=t.call(this)||this,a=n.weight,u=n.width;null!=a?null!=u&&(u=void 0):null==u&&(a=1);var l=ai(null!==(i=n.type)&&void 0!==i?i:Tb.TEXT,Tb),h=function(t,e){var n=t.align;if(null!=n)return xt(n)?ra[n]:n;switch(e){case Tb.TEXT:case Tb.TEXT_AREA:return ra.LEFT;case Tb.REAL:case Tb.INTEGER:return ra.RIGHT;case Tb.BUTTON:case Tb.INDEX:case Tb.SELECT:case Tb.ACTION:case Tb.LINK:case Tb.CHECK:case Tb.CHECK_SINGLE:case Tb.COLOR:return ra.CENTER;default:return ra.LEFT}}(n,l),c=n.label||"",p=function(t){return null!=t.path?t.path.split("."):null}(n),f=function(t,e,n){var i=t.getter;if(i)return i;switch(e){case Tb.ACTION:case Tb.LINK:return hT;default:return null==n?uT:function(t,e){if(t.length<=1){var n=t[0];return void 0===e?function(t){return t[n]}:function(t){return Object.prototype.hasOwnProperty.call(t,n)?t[n]:e}}return void 0===e?function(e){for(var n=0,i=t.length-1;n<i;++n)e=e[t[n]];return e[t[t.length-1]]}:function(n){for(var i=0,r=t.length-1;i<r;++i)n=n[t[i]];var o=t[t.length-1];return Object.prototype.hasOwnProperty.call(n,o)?n[o]:e}}(n,t.default)}}(n,l,p),d=function(t,e,n){var i=t.setter;if(i)return i;switch(e){case Tb.BUTTON:case Tb.ACTION:case Tb.LINK:return cT;default:return null==n?lT:function(t){if(t.length<=1){var e=t[0];return function(t,n,i){t[e]=i}}return function(e,n,i){for(var r=0,o=t.length-1;r<o;++r)e=e[t[r]]||{};e[t[t.length-1]]=i}}(n)}}(n,l,p);return s._weight=a,s.minWeight=0,s._width=u,s.minWidth=0,s.resizable=null!==(r=n.resizable)&&void 0!==r&&r,s.type=l,s.label=c,s.getter=f,s.setter=d,s.formatter=n.formatter,s.renderable=function(t,e){var n=t.renderable;return xt(n)?pT(e):null==n||n}(n,p),s.align=h,s.state=function(t){var e=t.state;return null!=e?xt(e)||Ot(e)?{initial:e,modifier:void 0}:{initial:void 0,modifier:e}:{initial:void 0,modifier:void 0}}(n),s.editing=function(t,e){var n,i=t.editing,r=t.editable;return i?{enable:fT(null!==(n=i.enable)&&void 0!==n?n:r,e),formatter:i.formatter,unformatter:i.unformatter,validator:i.validator}:{enable:fT(r,e)}}(n,p),s.sorting=function(t,e,n){var i=n.sorting,r=n.sortable;return i?i.enable||r?{enable:!0,comparator:i.comparator||dT(t,e)}:{enable:!1}:r?{enable:!0,comparator:dT(t,e)}:{enable:!1}}(f,e,n),s.header=n.header,s.body=n.body,s.selecting=function(t){return t?{getter:t.getter||vT,setter:t.setter||_T,menu:yT(t.menu),multiple:yT(t.multiple),dialog:gT(t.dialog),promise:t.promise}:{getter:vT,setter:_T}}(n.selecting),s.category=n.category,s.frozen=n.frozen,s.offset=0,s.link=n.link,s.update=ai(null!==(o=n.update)&&void 0!==o?o:wb.CELL,wb),s}return F(e,t),Object.defineProperty(e.prototype,"weight",{get:function(){return this._weight},set:function(t){null!=this._weight&&this._weight!==t&&(this._weight=t,this.emit("resize",this))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},set:function(t){null!=this._width&&this._width!==t&&(this._width=t,this.emit("resize",this))},enumerable:!1,configurable:!0}),e}(t.utils.EventEmitter),bT=function(t){function e(e,n){var i=t.call(this)||this;i.parent=e;var r=[];if(null!=n)for(var o=0,s=n.length;o<s;++o){var a=new mT(o,n[o]);r.push(a),a.on("resize",i.newOnColumnResize(o,a))}i.items=r;var u=0;for(o=r.length-1;0<=o;--o)if(!0===r[o].frozen){u=o+1;break}return i.frozen=u,i}return F(e,t),e.prototype.newOnColumnResize=function(t,e){var n=this;return function(){n.onColumnResize(t,e)}},e.prototype.onColumnResize=function(t,e){this.onColumnResizeHeader(t,e),this.onColumnResizeBody(t,e),this.emit("resize",t,e,this)},e.prototype.onColumnResizeHeader=function(t,e){var n=this.parent.header;if(null!=n){var i=e.weight;if(null!=i)this.onColumnResizeWeight(n,t,i);else{var r=e.width;null!=r&&this.onColumnResizeWidth(n,t,r)}}},e.prototype.onColumnResizeBody=function(t,e){var n=this.parent.body.children,i=e.weight;if(null!=i)for(var r=0,o=n.length;r<o;++r)this.onColumnResizeWeight(n[r],t,i);else{var s=e.width;if(null!=s)for(r=0,o=n.length;r<o;++r)this.onColumnResizeWidth(n[r],t,s)}},e.prototype.onColumnResizeWeight=function(t,e,n){var i=t.children,r=i.length,o=r-e-1;0<=o&&o<r&&(i[o].weight=n)},e.prototype.onColumnResizeWidth=function(t,e,n){var i=t.children,r=i.length,o=r-e-1;0<=o&&o<r&&(i[o].width=n)},Object.defineProperty(e.prototype,"width",{get:function(){for(var t=0,e=this.items,n=e.length,i=0;i<n;++i){var r=e[i].width;null!=r&&(t+=r)}return t},enumerable:!1,configurable:!0}),e.prototype.get=function(t){var e=this.items;return 0<=t&&t<e.length?e[t]:null},e.prototype.each=function(t){for(var e=this.items,n=0,i=e.length;n<i&&!1!==t(e[n],n);++n);return this},e.prototype.size=function(){return this.items.length},e}(t.utils.EventEmitter),TT=function(t){function e(e){var n=t.call(this)||this;return n._id=0,n._idUpdated=-1,n._isApplied=!1,n._parent=e,n._filter=null,n._filtered=null,n}return F(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!1,configurable:!0}),e.prototype.apply=function(){this._isApplied=!0,this._id+=1,this._parent.update()},e.prototype.unapply=function(){this._isApplied&&(this._isApplied=!1,this._id+=1,this._parent.update())},e.prototype.isApplied=function(){return this._isApplied},e.prototype.isFiltered=function(t,e,n){return Ct(n)?n(t,e):n.test(t,e)},e.prototype.hasFiltered=function(t,e,n){for(var i=this._parent.accessor,r=i.toChildren,o=i.hasChildren,s=0,a=e.length;s<a;++s){var u=e[s];if(this.isFiltered(u,-1,n))return!0;var l=r(u);if(o(u,l)&&this.hasFiltered(t,l,n))return!0}return!1},e.prototype.addAllToFiltered=function(t,e,n,i){for(var r=this._parent.accessor,o=r.toChildren,s=r.hasChildren,a=0,u=e.length;a<u;++a){var l=e[a];n.push(i[0]),i[0]+=1;var h=o(l);s(l,h)&&t.isOpened(l)&&this.addAllToFiltered(t,h,n,i)}},e.prototype.newFilteredSub=function(t,e,n,i,r){for(var o=!1,s=this._parent.accessor,a=s.toChildren,u=s.hasChildren,l=0,h=e.length;l<h;++l){var c=e[l],p=r[0];r[0]+=1;var f=this.isFiltered(c,p,n),d=a(c);if(u(c,d))if(t.isOpened(c))if(f)i.push(p),o=!0,this.addAllToFiltered(t,d,i,r);else{var y=i.length;this.newFilteredSub(t,d,n,i,r)&&(i.splice(y,0,p),o=!0)}else(f||this.hasFiltered(t,d,n))&&(i.push(p),o=!0);else f&&(i.push(p),o=!0)}return o},e.prototype.newFiltered=function(){var t=this._filter;if(null!=t){var e=[],n=this._parent,i=n.nodes;return i&&this.newFilteredSub(n,i,t,e,[0]),e}return null},e.prototype.get=function(){return this._filter},e.prototype.set=function(t){this._filter!==t&&(this._filter=t)},e.prototype.toDirty=function(){this._id+=1},e.prototype.update=function(){this._id!==this._idUpdated&&(this._idUpdated=this._id,this._isApplied?(this._filtered=this.newFiltered(),this.emit("change",this)):null!=this._filtered&&(this._filtered=null,this.emit("change",this)))},Object.defineProperty(e.prototype,"indices",{get:function(){return this.update(),this._filtered},enumerable:!1,configurable:!0}),e.prototype.map=function(t){var e=t,n=this.indices;if(n){var i=n.indexOf(e);if(!(0<=i))return null;e=i}return e},e.prototype.unmap=function(t){var e=t,n=this.indices;return n&&(e=n[e]),e},e}(t.utils.EventEmitter),wT=function(t){return t.parent},ET=function(t){return t.children},OT=function(t,e){return null!=e&&0<e.length},CT=function(t){null!=t?(this.toParent=t.toParent||wT,this.toChildren=t.toChildren||ET,this.hasChildren=t.hasChildren||OT):(this.toParent=wT,this.toChildren=ET,this.hasChildren=OT)},ST=function(t,e){return t[0]-e[0]},xT=function(t){function e(e,n){var i,r=t.call(this)||this;r._parent=e,r._type=ai(null!==(i=null==n?void 0:n.type)&&void 0!==i?i:Wb.NONE,Wb),r._rows=new Set;var o=null==n?void 0:n.on;if(o)for(var s in o){var a=o[s];a&&r.on(s,a)}return r}return F(e,t),Object.defineProperty(e.prototype,"parent",{get:function(){return this._parent},enumerable:!1,configurable:!0}),e.prototype.onNodeChange=function(t){if(null!=t){var e=this._parent.accessor,n=e.toChildren,i=e.hasChildren,r=this._rows,o=this.newRows(t,n,i,r,new Set);r.size!==o.size&&(this._rows=o,this.onChange())}else{var s=this._rows;0<s.size&&(s.clear(),this.onChange())}},e.prototype.newRows=function(t,e,n,i,r){for(var o=0,s=t.length;o<s;++o){var a=t[o];i.has(a)&&r.add(a);var u=e(a);n(a,u)&&this.newRows(u,e,n,i,r)}return r},Object.defineProperty(e.prototype,"indices",{get:function(){var t=this._rows,e=[];return this._parent.each((function(n,i){t.has(n)&&e.push(i)})),e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rows",{get:function(){var t=[];return this._rows.forEach((function(e){t.push(e)})),t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),e.prototype.getFirst=function(){var t=this._rows;if(0<t.size){var e=null;return t.forEach((function(t){null==e&&(e=t)})),e}return null},e.prototype.getLast=function(){var t=this._rows;if(0<t.size){var e=null;return t.forEach((function(t){e=t})),e}return null},e.prototype.toIndex=function(t){var e=null;return this._parent.each((function(n,i){return t!==n||(e=i,!1)})),e},Object.defineProperty(e.prototype,"first",{get:function(){var t=this.getFirst();return t?this.toIndex(t):null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){var t=this.getLast();return t?this.toIndex(t):null},enumerable:!1,configurable:!0}),e.prototype.onChange=function(){this._parent.update(),this.emit("change",this)},e.prototype.toggle=function(t){var e=this._parent.get(t);if(e){var n=this._rows;n.has(e)?n.delete(e):n.add(e),this.onChange()}},e.prototype.add=function(t){var e=this._parent.get(t);if(e){var n=this._rows;n.has(e)||(n.add(e),this.onChange())}},e.prototype.addTo=function(t){var e=this.last;null!=e&&this.addRange(e,!1,t,!0)},e.prototype.addRange=function(t,e,n,i){var r=this._rows,o=r.size,s=this._parent;t<n?s.each((function(t){r.add(t)}),t+(e?0:1),n+(i?1:0)):s.each((function(t){r.add(t)}),n+(i?0:1),t+(e?1:0)),o!==r.size&&this.onChange()},e.prototype.addAll=function(t){if(0<t.length){for(var e=this._rows,n=this._parent,i=0,r=t.length;i<r;++i){var o=n.get(t[i]);o&&e.add(o)}this.onChange()}},e.prototype.contains=function(t){var e=this._parent.get(t);return!!e&&this._rows.has(e)},e.prototype.remove=function(t){var e=this._parent.get(t);if(e){var n=this._rows;n.has(e)&&(n.delete(e),this.onChange())}},e.prototype.clear=function(){var t=this._rows;0<t.size&&(t.clear(),this.onChange())},e.prototype.clearAndAdd=function(t){var e=this._parent.get(t);if(e){var n=this._rows;n.has(e)?1<n.size&&(n.clear(),n.add(e),this.onChange()):(n.clear(),n.add(e),this.onChange())}},e.prototype.clearAndAddAll=function(t){var e=this._rows;if(0<e.size||0<t.length){e.clear();for(var n=this._parent,i=0,r=t.length;i<r;++i){var o=n.get(t[i]);o&&e.add(o)}this.onChange()}},e.prototype.shift=function(t,e){},e.prototype.size=function(){return this._rows.size},e.prototype.isEmpty=function(){return this._rows.size<=0},e.prototype.each=function(t){var e=this._rows;this._parent.each((function(n,i){return!e.has(n)||!1!==t(i)}))},e.prototype.toArray=function(){var t=this._rows,e=[];return this._parent.each((function(n,i){t.has(n)&&e.push([i,n])})),e},e.prototype.toSortedArray=function(){return this.toArray().sort(ST)},e.prototype.toObject=function(){var t=this._rows,e={};return this._parent.each((function(n,i){t.has(n)&&(e[i]=n)})),e},e.prototype.toMap=function(){var t=this._rows,e=new Map;return this._parent.each((function(n,i){t.has(n)&&e.set(i,n)})),e},e}(t.utils.EventEmitter),DT=function(t){function e(){return t.call(this)||this}return F(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return 0},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"order",{get:function(){return Qb.ASCENDING},set:function(t){},enumerable:!1,configurable:!0}),e.prototype.apply=function(){},e.prototype.unapply=function(){},e.prototype.isApplied=function(){return!1},e.prototype.get=function(){return null},e.prototype.set=function(t){},e.prototype.toDirty=function(){},e.prototype.update=function(){},Object.defineProperty(e.prototype,"indices",{get:function(){return null},enumerable:!1,configurable:!0}),e.prototype.map=function(t){return t},e.prototype.unmap=function(t){return t},e}(t.utils.EventEmitter),IT=function(e){function n(t){var n=e.call(this)||this;if(n._parent=null,n._accessor=n.toAccessor(t),n._mapped=new qb(n),n._rows=[],n._isRowsDirty=!1,n._supplimentals=[],n._flags=new WeakMap,n._reverse=!!(null==t?void 0:t.reverse),n._selection=n.toSelection(null==t?void 0:t.selection),n._filter=new TT(n),n._sorter=new DT,t){var i=t.filter;i&&n._filter.set(i);var r=t.on;if(r)for(var o in r){var s=r[o];s&&n.on(o,s)}}return n.nodes=null==t?void 0:t.nodes,n}return F(n,e),n.prototype.toSelection=function(e){return e instanceof t.utils.EventEmitter?e:Ct(e)?e(this):this.newSelection(e)},n.prototype.newSelection=function(t){return new xT(this,t)},n.prototype.toAccessor=function(t){return new CT(t)},n.prototype.bind=function(t){this._parent=t},Object.defineProperty(n.prototype,"nodes",{get:function(){return this._nodes},set:function(t){this._nodes=t,this._isRowsDirty=!0,this._selection.onNodeChange(t),this._filter.toDirty(),this.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"rows",{get:function(){return this._isRowsDirty&&(this._isRowsDirty=!1,this.updateRows(this._nodes)),this._rows},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"supplimentals",{get:function(){return this._supplimentals},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"accessor",{get:function(){return this._accessor},enumerable:!1,configurable:!0}),n.prototype.updateRows=function(t){var e=this._rows,n=this._supplimentals,i=this._flags;if(null!=t){var r=this._accessor,o=this.newRows(t,0,0,e,n,i,this._reverse,r.toChildren,r.hasChildren);o!==e.length&&(e.length=o,n.length=o)}else e.length=0,n.length=0},n.prototype.toSupplimental=function(t,e,n){return t<<2|(e?2:0)|(n?1:0)},n.prototype.newRows=function(t,e,n,i,r,o,s,a,u){for(var l=t.length,h=s?-1:1,c=s?l-1:0;0<=c&&c<l;c+=h){var p=t[c],f=a(p),d=o.has(p),y=this.toSupplimental(n,u(p,f),d);e<i.length?(i[e]=p,r[e]=y):(i.push(p),r.push(y)),e+=1,d&&f&&(e=this.newRows(f,e,n+1,i,r,o,s,a,u))}return e},n.prototype.update=function(t){var e=this._parent;e&&e.update(t)},n.prototype.lock=function(){var t=this._parent;t&&t.lock()},n.prototype.unlock=function(t){var e=this._parent;e&&e.unlock(t)},n.prototype.size=function(){return this.rows.length},n.prototype.get=function(t){var e=this.rows;return 0<=t&&t<e.length?e[t]:null},n.prototype.expand=function(t){var e=this._flags;return!e.has(t)&&(e.set(t,1),this._isRowsDirty=!0,this._filter.toDirty(),this.update(!0),!0)},n.prototype.collapse=function(t){var e=this._flags;return!!e.has(t)&&(e.delete(t),this._isRowsDirty=!0,this._filter.toDirty(),this.update(!0),!0)},n.prototype.isCollapsed=function(t){return!this._flags.has(t)},n.prototype.isExpanded=function(t){return this._flags.has(t)},n.prototype.toggle=function(t){return this.isExpanded(t)?this.collapse(t):this.expand(t)},n.prototype.open=function(t){return this.expand(t)},n.prototype.close=function(t){return this.collapse(t)},n.prototype.isOpened=function(t){return this.isExpanded(t)},n.prototype.each=function(t,e,n){var i=this.rows;e=null!=e?Math.max(0,e):0,n=null!=n?Math.min(i.length,n):i.length;for(var r=e;r<n&&!1!==t(i[r],r);++r);},Object.defineProperty(n.prototype,"selection",{get:function(){return this._selection},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"filter",{get:function(){return this._filter},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"sorter",{get:function(){return this._sorter},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"mapped",{get:function(){return this._mapped},enumerable:!1,configurable:!0}),n}(t.utils.EventEmitter),AT=function(){function t(t,e){var n,i,r;this._parent=t,this._isEnabled=null!==(n=null==e?void 0:e.enable)&&void 0!==n&&n,this._isFilterable=null===(i=null==e?void 0:e.filterable)||void 0===i||i,this._isEmittable=null===(r=null==e?void 0:e.emittable)||void 0===r||r}return Object.defineProperty(t.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isFilterable",{get:function(){return this._isFilterable},set:function(t){this._isFilterable=t},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEmittable",{get:function(){return this._isEmittable},set:function(t){this._isEmittable=t},enumerable:!1,configurable:!0}),t.prototype.newIteratee=function(t,e){var n=this._parent,i=n.column,r=n.columnIndex;if(null!=i&&null!=r){var o=i.getter,s=i.setter;if(this._isEmittable){var a=t.data;return function(t,n){return o(t,r)!==e&&(s(t,r,e),a.emit("change",e,!e,t,n,r,a),!0)}}return function(t){return o(t,r)!==e&&(s(t,r,e),!0)}}return null},t.prototype.execute=function(t){var e,n=null===(e=this._parent.header)||void 0===e?void 0:e.table;if(n){var i=this.newIteratee(n,t);if(i){var r=!1;this._isFilterable?n.data.mapped.each((function(t,e,n,o){i(t,o)&&(r=!0)})):n.data.each((function(t,e){i(t,e)&&(r=!0)})),r&&n.body.update(!0)}}},t}(),RT=function(e){function n(t,n,i,r){var o=e.call(this,r)||this;o._header=t,o._column=i,o._columnIndex=n;var s=new AT(o,null==r?void 0:r.check);o._check=s,o._edge=new iT(o._header,o,n,o.theme.getEdgeWidth());var a=i.sorting.enable,u=s.isEnabled;if(u||a){o.on(cr.tap,(function(t){o.onClick(t)}));var l=o.state;l.lock(),l.set(kb.SORTABLE,a),l.set(kb.CHECKABLE,u),l.unlock()}return o}return F(n,e),Object.defineProperty(n.prototype,"column",{get:function(){return this._column},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"columnIndex",{get:function(){return this._columnIndex},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"header",{get:function(){return this._header},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"check",{get:function(){return this._check},enumerable:!1,configurable:!0}),n.prototype.onDown=function(t){this._edge.onDown(t)||e.prototype.onDown.call(this,t)},n.prototype.onOver=function(t){e.prototype.onOver.call(this,t),this._edge.onOver(t)},n.prototype.onOut=function(t){e.prototype.onOut.call(this,t),this._edge.onOut(t)},Object.defineProperty(n.prototype,"sorter",{get:function(){var t=this,e=this._sorter;if(null==e){var n=this._header;if(!n)return null;var i=n.table;if(!i)return null;e=i.data.sorter,this._sorter=e,this._onSorterChangeBound=this._onSorterChangeBound||function(){t.onSorterChange()},e.on("change",this._onSorterChangeBound)}return e},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"comparator",{get:function(){return this._column.sorting.comparator||null},enumerable:!1,configurable:!0}),n.prototype.onSorterChange=function(){var t=this.comparator;if(t){var e=this._sorter;if(e){var n=kb.SORTED_ASCENDING,i=kb.SORTED_DESCENDING;e.isApplied()&&e.get()===t?e.order===Qb.ASCENDING?this.state.set(n,i):this.state.set(i,n):this.state.removeAll(n,i)}}},n.prototype.toClickPosition=function(e){var n,i=null!==(n=this._checkWork)&&void 0!==n?n:this._checkWork=new t.Point;return e.data.getLocalPosition(this,i).x},n.prototype.isCheckClicked=function(e){if(e instanceof t.InteractionEvent&&this._check.isEnabled){if(!this.isSortable)return!0;var n=this.image.get(1);if(n){var i=this.toClickPosition(e),r=n.object;if(null!=r){var o=r.getLocalBounds(),s=n.margin.horizontal,a=r.x;return a+o.left-s<=i&&i<=a+o.right+s}}}return!1},n.prototype.onClick=function(t){this.state.isActionable&&this.activate(t)},n.prototype.activate=function(t){this.onActivate(t)},n.prototype.onActivate=function(t){this._edge.isClicked(t)||(this.isCheckClicked(t)?(this.onToggleStart(),this.onToggleEnd()):(this.doSort(t),this.emit("active",this)))},n.prototype.doSort=function(t){if(this.isSortable){var e=this.comparator;if(e){var n=this.sorter;n&&(n.get()===e?n.order===Qb.ASCENDING?(n.order=Qb.DESCENDING,n.apply()):(n.set(null),n.apply()):(n.set(e),n.order=Qb.ASCENDING,n.apply()))}}},Object.defineProperty(n.prototype,"isSortable",{get:function(){return this._column.sorting.enable},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isResizable",{get:function(){return this._column.resizable},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"isToggle",{get:function(){return this._check.isEnabled},enumerable:!1,configurable:!0}),n.prototype.toggle=function(){this.state.isActionable&&this.isToggle&&(this.onToggleStart(),this.onToggleEnd())},n.prototype.onToggleStart=function(){this.state.isActive=!this.state.isActive},n.prototype.onToggleEnd=function(){this.state.isActive?(this._check.execute(!0),this.emit("active",this)):(this._check.execute(!1),this.emit("inactive",this))},n.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this.isToggle?this.onToggleStart():this.state.isPressed=!0)},n.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this.isToggle?this.onToggleEnd():(this.state.isPressed&&this.activate(t),this.state.isPressed=!1))},n.prototype.onKeyDown=function(t){return no.isActivateKey(t)&&this.onActivateKeyDown(t),e.prototype.onKeyDown.call(this,t)},n.prototype.onKeyUp=function(t){return no.isActivateKey(t)&&this.onActivateKeyUp(t),e.prototype.onKeyUp.call(this,t)},n.prototype.getType=function(){return"DTableHeaderCell"},n.prototype.destroy=function(){var t=this._sorter,n=this._onSorterChangeBound;t&&n&&t.off("change",n),this._sorter=void 0,this._onSorterChangeBound=void 0,e.prototype.destroy.call(this)},n}(Zf),PT=function(t){function e(e,n,i,r,o){var s=t.call(this,n,i,o)||this;return s._table=e,s._offset=r,s.transform.position.y=r,s.initCells(),s}return F(e,t),Object.defineProperty(e.prototype,"table",{get:function(){return this._table},enumerable:!1,configurable:!0}),e.prototype.onParentMove=function(e,n,i,r){t.prototype.onParentMove.call(this,e,n,i,r),this.transform.position.y=-n+this._offset,this.updateFrozenCellPosition(e)},e.prototype.getContentPositionX=function(){var t=this.parent;return t?t.position.x:0},e.prototype.newCell=function(t,e,n,i){return new RT(this,t,e,this.toCellOptions(e,i))},e.prototype.toCellOptions=function(t,e){var n=t.header||(null==e?void 0:e.cell);return null!=n?(void 0===n.weight&&(n.weight=t.weight),void 0===n.width&&(n.width=t.width),void 0===n.text?n.text={value:t.label}:void 0===n.text.value&&(n.text.value=t.label),n):{weight:t.weight,width:t.width,text:{value:t.label}}},e.prototype.getType=function(){return"DTableHeader"},e}(Kb),MT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.getOffsetVerticalStart=function(t){return.5*t+this._parent.body.position.y},e}(fv),kT=function(t){function e(e){var n=t.call(this,e)||this,i=n.content,r=n.body;i.addChild(r),r.data.selection.type!==Wb.NONE&&n.on(cr.tap,(function(t){r.onRowClick(t)}));var o=n.header;o&&i.addChild(o);for(var s=n.categories,a=s.length-1;0<=a;--a)i.addChild(s[a]);return r.update(),n}return F(e,t),Object.defineProperty(e.prototype,"column",{get:function(){var t;return null!==(t=this._column)&&void 0!==t?t:this._column=this.newColumn()},enumerable:!1,configurable:!0}),e.prototype.newColumn=function(){var t;return new bT(this,null===(t=this._options)||void 0===t?void 0:t.columns)},Object.defineProperty(e.prototype,"columns",{get:function(){return this.column.items},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"frozen",{get:function(){return this.column.frozen},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"category",{get:function(){var t;return null!==(t=this._category)&&void 0!==t?t:this._category=this.newCategory()},enumerable:!1,configurable:!0}),e.prototype.newCategory=function(){var t,e=this.column;return new aT(e.items,e.frozen,null===(t=this._options)||void 0===t?void 0:t.category)},Object.defineProperty(e.prototype,"categories",{get:function(){return this.category.items},enumerable:!1,configurable:!0}),e.prototype.initContent=function(e){t.prototype.initContent.call(this,e),e.state.isFocusReverse=!0},e.prototype.onContentChange=function(){t.prototype.onContentChange.call(this),this.body.update()},e.prototype.onResize=function(e,n,i,r){var o=this.scrollbar;o.lock();var s=this.body;s.lock(),t.prototype.onResize.call(this,e,n,i,r),s.update(),s.unlock(!0),o.unlock(!0)},e.prototype.onDblClick=function(e,n){var i=this.body.onDblClick(e,n);return t.prototype.onDblClick.call(this,e,n)||i},e.prototype.newScrollBar=function(t){var e=this;return new MT(this,t,(function(t){e.onScrollBarUpdate(t)}))},e.prototype.newContent=function(e){var n=this,i=t.prototype.newContent.call(this,e),r=this.column,o=r.width;return 0<o?(r.on("resize",(function(){o=r.width;var t=n.width,e=n.height,s=t-Math.max(t,o);i.x<s&&(i.x=s),i.onParentResize(t,e,n.padding)})),i.setWidth((function(t){return Math.max(t,o)}))):i.setWidth("100%"),i},e.prototype.getHeaderOffset=function(){var t=this._headerOffset;return null==t&&(t=this.newHeaderOffset(),this._headerOffset=t),t},e.prototype.newHeaderOffset=function(){for(var t=0,e=this.categories,n=0,i=e.length;n<i;++n)t+=e[n].height;return t},Object.defineProperty(e.prototype,"header",{get:function(){var t=this._header;return void 0===t&&(t=this.newHeader(),this._header=t),t},enumerable:!1,configurable:!0}),e.prototype.hasHeader=function(t){if(t)for(var e=t.columns,n=0,i=e.length;n<i;++n)if(null!=e[n].label)return!0;return!1},e.prototype.newHeader=function(){var t=this._options;if(this.hasHeader(t)){var e=this.column;return new PT(this,e.items,e.frozen,this.getHeaderOffset(),null==t?void 0:t.header)}return null},e.prototype.getBodyOffset=function(){var t;return null!==(t=this._bodyOffset)&&void 0!==t?t:this._bodyOffset=this.newBodyOffset()},e.prototype.newBodyOffset=function(){var t,e;return this.getHeaderOffset()+(null!==(e=null===(t=this.header)||void 0===t?void 0:t.height)&&void 0!==e?e:0)},Object.defineProperty(e.prototype,"body",{get:function(){var t;return null!==(t=this._body)&&void 0!==t?t:this._body=this.newBody()},enumerable:!1,configurable:!0}),e.prototype.newBody=function(){var t=this._options,e=this.column;return new eT(e.items,e.frozen,this.getBodyOffset(),this.toBodyOptions(null==t?void 0:t.body,null==t?void 0:t.data))},e.prototype.toBodyOptions=function(t,e){return null!=t?(void 0===t.data&&void 0!==e&&(Ot(e)?t.data={rows:e}:t.data=e),void 0===t.height&&void 0===t.weight&&(t.weight=1),t):Ot(e)?{data:{rows:e},weight:1}:{data:e,weight:1}},Object.defineProperty(e.prototype,"data",{get:function(){return this.body.data},enumerable:!1,configurable:!0}),e.prototype.getFocusedChildClippingRect=function(e,n,i,r,o,s,a,u){t.prototype.getFocusedChildClippingRect.call(this,e,n,i,r,o,s,a,u);var l=this.toCell(e);if(l){var h=n+this.toFrozenCellX(l)-u.x;if(0<h&&(u.x+=h,u.width-=h),l.parent.parent===this.body){var c=this.getBodyOffset();u.y+=c,u.height-=c}}return u},e.prototype.toFrozenCellX=function(t){var e=this.frozen;if(0<e){var n=t.parent.children,i=n.indexOf(t);if(0<=i){var r=n.length;if(e<=r-1-i){var o=n[r-e];return o.position.x+o.width}}}return 0},e.prototype.onKeyDown=function(e){no.moveFocusHorizontally(e,this);var n=no.isArrowUpKey(e),i=no.isArrowDownKey(e);return(n||i)&&this.onKeyDownArrowUpOrDown(e,i),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyDownArrowUpOrDown=function(t,e){var n=ft.getLayer(this);if(null==n)return!1;var i=n.getFocusController(),r=i.get();if(null==r)return!1;var o=this.toCell(r);if(null==o)return!1;var s=o.parent;if(null==s)return!1;var a=i.find(s,!1,!1,e,this);if(null==a)return!1;var u=this.toCell(a);if(null==u)return!1;var l=u.parent;if(null==l)return!1;var h=s.children.indexOf(o);if(h<0)return!1;var c=l.children[h];if(null==c||c===o||!("state"in c))return!1;var p=i.find(c,!0,!0,e,this);return null!=p&&(i.focus(p),!0)},e.prototype.toCell=function(t){for(var e=t;null!=e;){var n=e.parent;if(n instanceof Kb)return e instanceof ao?e:null;e=n}return null},e.prototype.getType=function(){return"DTable"},e}(dv),LT=function(t){var e=t.text;if(xt(e))return e;var n=t.label;if(xt(n))return n;var i=t.name;return xt(i)?i:void 0},NT=function(t){var e=t.title;if(xt(e))return e},BT=function(t){return t.image},zT=function(t){return t.children},UT=function(t){return t.children=[]},jT=function(t){var e,n,i,r,o;this.toLabel=null!==(e=null==t?void 0:t.toLabel)&&void 0!==e?e:LT,this.toTitle=null!==(n=null==t?void 0:t.toTitle)&&void 0!==n?n:NT,this.toImage=null!==(i=null==t?void 0:t.toImage)&&void 0!==i?i:BT,this.toChildren=null!==(r=null==t?void 0:t.toChildren)&&void 0!==r?r:zT,this.newChildren=null!==(o=null==t?void 0:t.newChildren)&&void 0!==o?o:UT},FT={NONE:0,SINGLE:1,MULTIPLE:2},HT=function(){function t(t,e){this._parent=t,this._nodes=[],this._levels=[],this._reverse=e,this._isDirty=!1}return Object.defineProperty(t.prototype,"nodes",{get:function(){return this.update(),this._nodes},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"levels",{get:function(){return this.update(),this._levels},enumerable:!1,configurable:!0}),t.prototype.toDirty=function(){this._isDirty=!0},t.prototype.size=function(){return this.update(),this._nodes.length},t.prototype.each=function(t,e,n){this.update();for(var i=this._nodes,r=null!=e?Math.max(0,e):0,o=null!=n?Math.min(i.length,n):i.length,s=r;s<o&&!1!==t(i[s],s);++s);},t.prototype.update=function(){if(this._isDirty){this._isDirty=!1;var t=this._parent,e=t.nodes,n=t.accessor.toChildren,i=this._nodes,r=this._levels,o=this.newNodes(t,e,0,0,i,r,this._reverse,n);i.length!==o&&(i.length=o,r.length=o)}},t.prototype.newNodes=function(t,e,n,i,r,o,s,a){for(var u=e.length,l=s?-1:1,h=s?u-1:0;0<=h&&h<u;h+=l){var c=e[h];n<r.length?(r[n]=c,o[n]=i):(r.push(c),o.push(i)),n+=1;var p=a(c);p&&t.isExpanded(c)&&(n=this.newNodes(t,p,n,i+1,r,o,s,a))}return n},t}(),GT=function(t){function e(e,n){var i=t.call(this)||this;i._parent=e,i._nodes=new Set;var r=null==n?void 0:n.on;if(r)for(var o in r){var s=r[o];s&&i.on(o,s)}return i}return F(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return FT.MULTIPLE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){var t=this._nodes;if(0<t.size){var e=null;return t.forEach((function(t){null==e&&(e=t)})),e}return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){var t=this._nodes;if(0<t.size){var e=null;return t.forEach((function(t){e=t})),e}return null},enumerable:!1,configurable:!0}),e.prototype.get=function(t){var e=this._nodes;if(0<=t&&t<e.size){var n=0,i=null;return e.forEach((function(e){n===t&&(i=e),n+=1})),i}return null},e.prototype.add=function(t){var e=this._nodes;return!e.has(t)&&(e.add(t),this.onChange(),!0)},e.prototype.remove=function(t){var e=this._nodes;return!!e.has(t)&&(e.delete(t),this.onChange(),!0)},e.prototype.toggle=function(t){var e=this._nodes;return e.has(t)?e.delete(t):e.add(t),this.onChange(),!0},e.prototype.clear=function(){var t=this._nodes;return 0<t.size&&(t.clear(),this.onChange(),!0)},e.prototype.clearAndAdd=function(t){var e=this._nodes;return 1===e.size?!e.has(t)&&(e.clear(),e.add(t),this.onChange(),!0):(e.clear(),e.add(t),this.onChange(),!0)},e.prototype.clearAndAddAll=function(t){for(var e=!1,n=new Set,i=this._nodes,r=0,o=t.length;r<o;++r){var s=t[r];i.has(s)||(e=!0),n.add(s)}return e||i.forEach((function(t){n.has(t)||(e=!0)})),e&&(this._nodes=n,this.onChange()),e},e.prototype.contains=function(t){return this._nodes.has(t)},e.prototype.size=function(){return this._nodes.size},e.prototype.isEmpty=function(){return this._nodes.size<=0},e.prototype.each=function(t){var e=!1;this._nodes.forEach((function(n){e||!1===t(n)&&(e=!0)}))},e.prototype.toArray=function(){var t=[];return this._nodes.forEach((function(e){t.push(e)})),t},e.prototype.onChange=function(){this._parent.update(),this.emit("change",this)},e.prototype.onNodeChange=function(t){var e=this._nodes;if(0<e.size){var n=this.newNodes(t,e,new Set);e.size!==n.size&&(this._nodes=n,this.onChange())}},e.prototype.newNodes=function(t,e,n){for(var i=this._parent.accessor.toChildren,r=0,o=t.length;r<o;++r){var s=t[r];e.has(s)&&n.add(s);var a=i(s);a&&this.newNodes(a,e,n)}return n},e}(t.utils.EventEmitter),VT=function(t){function e(e,n){var i=t.call(this)||this;i._parent=e,i._node=null;var r=null==n?void 0:n.on;if(r)for(var o in r){var s=r[o];s&&i.on(o,s)}return i}return F(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return FT.SINGLE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return this._node},enumerable:!1,configurable:!0}),e.prototype.get=function(t){return 0===t?this._node:null},e.prototype.add=function(t){return this._node!==t&&(this._node=t,this.onChange(),!0)},e.prototype.remove=function(t){return this._node===t&&(this._node=null,this.onChange(),!0)},e.prototype.toggle=function(t){return this._node===t?this._node=null:this._node=t,this.onChange(),!0},e.prototype.clear=function(){return null!=this._node&&(this._node=null,this.onChange(),!0)},e.prototype.clearAndAdd=function(t){return this._node!==t&&(this._node=t,this.onChange(),!0)},e.prototype.clearAndAddAll=function(t){if(0<t.length){var e=t[t.length-1];return this.clearAndAdd(e)}return this.clear()},e.prototype.contains=function(t){return this._node===t},e.prototype.size=function(){return null!=this._node?1:0},e.prototype.isEmpty=function(){return null==this._node},e.prototype.each=function(t){var e=this._node;null!=e&&t(e)},e.prototype.toArray=function(){var t=this._node;return null!=t?[t]:[]},e.prototype.onChange=function(){this._parent.update(),this.emit("change",this)},e.prototype.onNodeChange=function(t){var e=this._node;if(null!=e){var n=this.newNode(t,e);e!==n&&(this._node=n,this.onChange())}},e.prototype.newNode=function(t,e){for(var n=this._parent.accessor.toChildren,i=0,r=t.length;i<r;++i){var o=t[i];if(e===o)return o;var s=n(o);if(s){var a=this.newNode(s,e);if(null!=a)return a}}return null},e}(t.utils.EventEmitter),WT=function(t){function e(e,n){var i=t.call(this)||this;i._parent=e;var r=null==n?void 0:n.on;if(r)for(var o in r){var s=r[o];s&&i.on(o,s)}return i}return F(e,t),Object.defineProperty(e.prototype,"type",{get:function(){return FT.NONE},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"first",{get:function(){return null},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"last",{get:function(){return null},enumerable:!1,configurable:!0}),e.prototype.get=function(t){return null},e.prototype.add=function(t){return!1},e.prototype.remove=function(t){return!1},e.prototype.toggle=function(t){return!1},e.prototype.clear=function(){return!1},e.prototype.clearAndAdd=function(t){return!1},e.prototype.clearAndAddAll=function(t){return!1},e.prototype.contains=function(t){return!1},e.prototype.size=function(){return 0},e.prototype.isEmpty=function(){return!0},e.prototype.each=function(t){},e.prototype.toArray=function(){return[]},e.prototype.onNodeChange=function(t){},e}(t.utils.EventEmitter),KT=function(){function t(t,e){this._parent=t,this._nodeToFlag=new WeakMap,this._selection=this.toSelection(e),this._accessor=new jT(e);var n=new HT(this,!!(null==e?void 0:e.reverse));this._mapped=n;var i=null==e?void 0:e.nodes;null!=i?(this._nodes=i,n.toDirty()):this._nodes=[]}return t.prototype.toSelection=function(t){var e=null==t?void 0:t.selection;switch(null==e?void 0:e.type){case FT.NONE:case"NONE":return new WT(this,e);case FT.MULTIPLE:case"MULTIPLE":return new GT(this,e);default:return new VT(this,e)}},Object.defineProperty(t.prototype,"nodes",{get:function(){return this._nodes},set:function(t){this._nodes=t,this.update(!0)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"mapped",{get:function(){return this._mapped},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"accessor",{get:function(){return this._accessor},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selection",{get:function(){return this._selection},enumerable:!1,configurable:!0}),t.prototype.update=function(t){t&&(this._mapped.toDirty(),this._selection.onNodeChange(this._nodes)),this._parent.update(t)},t.prototype.toggle=function(t){var e=this._nodeToFlag;return e.has(t)?e.delete(t):e.set(t,1),this._mapped.toDirty(),this.update(),!0},t.prototype.expand=function(t){var e=this._nodeToFlag;return!e.has(t)&&(e.set(t,1),this._mapped.toDirty(),this.update(),!0)},t.prototype.collapse=function(t){var e=this._nodeToFlag;return!!e.has(t)&&(e.delete(t),this._mapped.toDirty(),this.update(),!0)},t.prototype.expandAll=function(){var t=!1,e=this._nodeToFlag;return this.each((function(n){e.has(n)||(e.set(n,1),t=!0)})),!!t&&(this._mapped.toDirty(),this.update(),!0)},t.prototype.collapseAll=function(){var t=!1,e=this._nodeToFlag;return this.each((function(n){e.has(n)&&(e.delete(n),t=!0)})),!!t&&(this._mapped.toDirty(),this.update(),!0)},t.prototype.isCollapsed=function(t){return!this.isExpanded(t)},t.prototype.isExpanded=function(t){return this._nodeToFlag.has(t)},t.prototype.clear=function(){var t=this._nodes;return 0<t.length&&(t.length=0,this._mapped.toDirty(),this._selection.clear(),this.update(),!0)},t.prototype.remove=function(t){var e=!1;return this.each((function(n,i,r){return n!==t||(r.splice(i,1),e=!0,!1)})),!!e&&(this._mapped.toDirty(),this._selection.remove(t),this.update(),!0)},t.prototype.add=function(t,e){var n=!1;if(e){var i=this._accessor,r=i.toChildren(e);if(r)r.push(t),n=!0;else{var o=i.newChildren(e);o&&(o.push(t),n=!0)}}else{var s=this._nodes;s?s.push(t):this._nodes=[t],n=!0}return n&&(this._mapped.toDirty(),this.update()),!0},t.prototype.addBefore=function(t,e){var n=!1;return this.each((function(i,r,o){return i!==e||(o.splice(r,0,t),n=!0,!1)})),n&&(this._mapped.toDirty(),this.update()),n},t.prototype.addAfter=function(t,e){var n=!1;return this.each((function(i,r,o){return i!==e||(o.splice(r+1,0,t),n=!0,!1)})),n&&(this._mapped.toDirty(),this.update()),n},t.prototype.each=function(t){var e=this._nodes;e&&this.each_(e,null,t)},t.prototype.each_=function(t,e,n){for(var i=this._accessor.toChildren,r=0,o=t.length;r<o;++r){var s=t[r];if(!1===n(s,r,t,e))return;var a=i(s);a&&this.each_(a,s,n)}},t}(),XT={HAS_CHILDREN:"HAS_CHILDREN",OPENED:"OPENED"},YT=function(t){function e(e,n){var i=t.call(this,n)||this;return i._data=e,i}return F(e,t),e.prototype.newPadding=function(t,e,n){return new tg(t,e,n)},Object.defineProperty(e.prototype,"node",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this._node},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"index",{get:function(){return this._index},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"data",{get:function(){return this._data},enumerable:!1,configurable:!0}),e.prototype.toggle=function(){var t=this._node;void 0!==t&&this._data.toggle(t)},e.prototype.set=function(t,e,n){var i,r=this._data,o=n||this._node!==t;if(o){this._node=t,this._index=e;var s=r.accessor;this.text=s.toLabel(t),this.title=null!==(i=s.toTitle(t))&&void 0!==i?i:"",this.image=s.toImage(t)}var a=r.mapped.levels[e];this._padding.adjLeft(this.theme.getLevelPadding(a));var u=r.accessor.toChildren(t),l=!!(u&&0<u.length),h=this.state;h.lock(),h.set(vt.ACTIVE,r.selection.contains(t)),h.remove(vt.DISABLED),h.set(XT.HAS_CHILDREN,l),h.set(XT.OPENED,r.isExpanded(t)),h.unlock(),o&&this.emit("set",t,e,this)},e.prototype.unset=function(){if(void 0!==this._node){this._node=void 0,this._index=void 0,this.text=void 0,this.title="",this.image=void 0;var t=this.state;t.lock(),t.add(vt.DISABLED),t.remove(vt.ACTIVE),t.unlock(),this.emit("unset",this)}},e.prototype.onSelect=function(t,e){var n=this._data,i=n.selection;if(i.type!==FT.MULTIPLE)i.clearAndAdd(e);else{var r=t&&"data"in t?t.data.originalEvent:t;if(null==r?void 0:r.ctrlKey)i.toggle(e);else if(null==r?void 0:r.shiftKey){var o=n.mapped,s=i.last;if(e===s)i.clearAndAdd(e);else{var a=!1,u=!1,l=[];o.each((function(t){if(a){if(u){if(l.unshift(t),t===e)return!1}else if(l.push(t),t===s)return!1}else t===e?(a=!0,u=!1,l.push(t)):t===s&&(a=!0,u=!0,l.push(t))})),i.clearAndAddAll(l)}}else i.clearAndAdd(e)}},e.prototype.onKeyDown=function(e){var n;return no.isActivateKey(e)&&this.onKeyDownActivate(e),no.isArrowRightKey(e)&&void 0!==(n=this._node)&&this.state.is(XT.HAS_CHILDREN)&&this._data.expand(n),no.isArrowLeftKey(e)&&void 0!==(n=this._node)&&this.state.is(XT.HAS_CHILDREN)&&this._data.collapse(n),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyDownActivate=function(t){if(this.state.isActionable&&this.state.isFocused){var e=this._node;return void 0!==e&&this.onSelect(t,e),!0}return!1},e.prototype.getType=function(){return"DTreeItemText"},e}(Na),qT=function(t){function e(e,n){var i,r=t.call(this,e,n)||this;return r._when=ai(null!==(i=null==n?void 0:n.when)&&void 0!==i?i:na.CLICKED,na),r.on(cr.tap,(function(t){r.onClick(t)})),r}return F(e,t),e.prototype.onClick=function(t){this._when===na.CLICKED&&this.state.isActionable&&this.activate(t)},e.prototype.onDblClick=function(e,n){return this._when===na.DOUBLE_CLICKED&&this.activate(e),t.prototype.onDblClick.call(this,e,n)},e.prototype.activate=function(t){this.onActivate(t)},e.prototype.onActivate=function(t){this.emit("active",this)},e.prototype.onActivateKeyDown=function(t){this.state.isActionable&&(this.state.isPressed=!0)},e.prototype.onActivateKeyUp=function(t){this.state.isActionable&&(this.state.isPressed&&this.activate(t),this.state.isPressed=!1)},e.prototype.onKeyDown=function(e){return no.isActivateKey(e)&&this.onActivateKeyDown(e),t.prototype.onKeyDown.call(this,e)},e.prototype.onKeyUp=function(e){return no.isActivateKey(e)&&this.onActivateKeyUp(e),t.prototype.onKeyUp.call(this,e)},e.prototype.getType=function(){return"DTreeItemButton"},e}(YT),ZT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.onActivate=function(n){t.prototype.onActivate.call(this,n);var i=this._node;void 0!==i&&(this.state.is(XT.HAS_CHILDREN)?n&&"data"in n&&(this.toLocal(n.data.global,void 0,e.WORK_CONTAINS_POINT).x<=this.padding.getLeft()?this.toggle():this.onSelect(n,i)):this.onSelect(n,i))},e.prototype.getType=function(){return"DTreeItemNonEditable"},e}(qT),JT=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return F(e,t),e.prototype.toMapped=function(t){return t.mapped},e.prototype.newItem=function(t){return new ZT(t)},e}(Kg),QT=function(t){function e(e){var n=t.call(this,e)||this;return n.update(),n}return F(e,t),e.prototype.onContentChange=function(){t.prototype.onContentChange.call(this),this.update()},e.prototype.onResize=function(e,n,i,r){var o=this.updater;o.lock(),t.prototype.onResize.call(this,e,n,i,r),o.update(),o.unlock(!0)},Object.defineProperty(e.prototype,"updater",{get:function(){var t=this._updater;return null==t&&(t=this.newUpdater(this.data,this.content,this._options),this._updater=t),t},enumerable:!1,configurable:!0}),e.prototype.newUpdater=function(t,e,n){return new JT(t,e,e,null==n?void 0:n.updater)},Object.defineProperty(e.prototype,"data",{get:function(){var t=this._data;return null==t&&(t=this.toData(this._options),this._data=t),t},enumerable:!1,configurable:!0}),e.prototype.toData=function(t){var e=t&&(t.data||t.nodes||t.value)||[];return Ot(e)?new KT(this,{nodes:e}):"add"in e?e:new KT(this,e)},e.prototype.update=function(t){this.updater.update(t)},e.prototype.lock=function(){this.updater.lock()},e.prototype.unlock=function(t){this.updater.unlock(t)},Object.defineProperty(e.prototype,"selection",{get:function(){return this.data.selection},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"value",{get:function(){return this.data.nodes},set:function(t){this.data.nodes=t},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"nodes",{get:function(){return this.data.nodes},set:function(t){this.data.nodes=t},enumerable:!1,configurable:!0}),e.prototype.toggle=function(t){return this.data.toggle(t)},e.prototype.expand=function(t){return this.data.expand(t)},e.prototype.collapse=function(t){return this.data.collapse(t)},e.prototype.expandAll=function(){return this.data.expandAll()},e.prototype.collapseAll=function(){return this.data.collapseAll()},e.prototype.isCollapsed=function(t){return this.data.isCollapsed(t)},e.prototype.isExpanded=function(t){return this.data.isExpanded(t)},e.prototype.clear=function(){return this.data.clear()},e.prototype.remove=function(t){return this.data.remove(t)},e.prototype.add=function(t,e){return this.data.add(t,e)},e.prototype.addBefore=function(t,e){return this.data.addBefore(t,e)},e.prototype.addAfter=function(t,e){return this.data.addAfter(t,e)},e.prototype.each=function(t){return this.data.each(t)},e.prototype.onKeyDown=function(e){return this.updater.moveFocus(e,this,!0,!1),t.prototype.onKeyDown.call(this,e)},e.prototype.getType=function(){return"DTree"},e}(dv),$T={__proto__:null,loadAll:Qd,loadMenuItemAll:Jd,loadMenuItemExpandable:Pd,loadMenuItem:Td,loadMenuSidedItemExpandable:Zd,loadMenuSidedItem:jd,deserializeActionValue:Sl,EShapeActionBases:me,EShapeActionEnvironment:be,EShapeActionExpressions:Te,EShapeActionMiscExtensions:ks,EShapeActionOpenDialogExtensions:Gu,EShapeActionOpenExtensions:Ku,EShapeActionOpenOpeners:Ir,EShapeActionRuntimeBase:we,EShapeActionRuntimeBlinkBrighten:Ce,EShapeActionRuntimeBlinkColorFill:Se,EShapeActionRuntimeBlinkColorStroke:xe,EShapeActionRuntimeBlinkDarken:De,EShapeActionRuntimeBlinkOpacity:Ie,EShapeActionRuntimeBlinkVisibility:Ae,EShapeActionRuntimeBlink:Oe,EShapeActionRuntimeChangeColorBrightness:We,EShapeActionRuntimeChangeColorCode:Xe,EShapeActionRuntimeChangeColor:je,EShapeActionRuntimeChangeCursor:qe,EShapeActionRuntimeChangeFillPercent:Je,EShapeActionRuntimeChangeTextNumber:Ln,EShapeActionRuntimeChangeTextText:Nn,EShapeActionRuntimeConditional:Ee,EShapeActionRuntimeEmitEvent:is,EShapeActionRuntimeGestureLayer:br,EShapeActionRuntimeGestureShape:Tr,EShapeActionRuntimeMiscEmitEvent:os,EShapeActionRuntimeMiscExecute:Ps,EShapeActionRuntimeMiscExtension:Ls,EShapeActionRuntimeMiscHtmlElement:ds,EShapeActionRuntimeMiscInputInput:Ts,EShapeActionRuntimeMiscInputInteger:Es,EShapeActionRuntimeMiscInputNumber:ws,EShapeActionRuntimeMiscInputReal:Os,EShapeActionRuntimeMiscInputText:Ss,EShapeActionRuntimeMiscInput:bs,EShapeActionRuntimeMiscWriteBoth:Ds,EShapeActionRuntimeMiscWriteLocal:Is,EShapeActionRuntimeMiscWriteRemote:As,EShapeActionRuntimeMiscWrite:xs,EShapeActionRuntimeOpenDialogBoolean:tu,EShapeActionRuntimeOpenDialogDate:ju,EShapeActionRuntimeOpenDialogDatetime:ku,EShapeActionRuntimeOpenDialogExtension:Vu,EShapeActionRuntimeOpenDialogInteger:au,EShapeActionRuntimeOpenDialogReal:hu,EShapeActionRuntimeOpenDialogText:fu,EShapeActionRuntimeOpenDialogTime:Bu,EShapeActionRuntimeOpenDialog:$a,EShapeActionRuntimeOpen:Bs,EShapeActionRuntimeShowHideLayer:Ju,EShapeActionRuntimeShowHideShape:$u,EShapeActionRuntimeShowHide:qu,EShapeActionRuntimeTransformMoveAbsoluteX:nl,EShapeActionRuntimeTransformMoveAbsoluteY:il,EShapeActionRuntimeTransformMoveForwardOrBackward:rl,EShapeActionRuntimeTransformMoveLeftOrRight:ol,EShapeActionRuntimeTransformMoveRelativeX:sl,EShapeActionRuntimeTransformMoveRelativeY:al,EShapeActionRuntimeTransformMove:el,EShapeActionRuntimeTransformResizeHeightAbsolute:dl,EShapeActionRuntimeTransformResizeHeightRelative:yl,EShapeActionRuntimeTransformResizeSizeAbsolute:gl,EShapeActionRuntimeTransformResizeSizeRelative:vl,EShapeActionRuntimeTransformResizeWidthAbsolute:_l,EShapeActionRuntimeTransformResizeWidthRelative:ml,EShapeActionRuntimeTransformResize:fl,EShapeActionRuntimeTransformRotateAbsolute:wl,EShapeActionRuntimeTransformRotateRelative:El,EShapeActionRuntimeTransformRotate:Tl,EShapeActionRuntimes:Fo,EShapeActionValueBase:Pe,EShapeActionValueBlinkType:Re,EShapeActionValueBlink:Ne,EShapeActionValueChangeColorBrightness:Ke,EShapeActionValueChangeColorCode:Ye,EShapeActionValueChangeColorTarget:Ue,EShapeActionValueChangeColorTypeLegacy:He,EShapeActionValueChangeColorType:Fe,EShapeActionValueChangeColorTypes:Ge,EShapeActionValueChangeColor:Ve,EShapeActionValueChangeCursor:Ze,EShapeActionValueChangeFillPercent:Qe,EShapeActionValueChangeTextType:Bn,EShapeActionValueChangeText:zn,EShapeActionValueDeserializers:xl,EShapeActionValueEmitEvent:rs,EShapeActionValueGestureOperationType:mr,EShapeActionValueGestureType:wr,EShapeActionValueGesture:Or,EShapeActionValueMiscEmitEvent:$d,EShapeActionValueMiscExecute:Ms,EShapeActionValueMiscExtension:Ns,EShapeActionValueMiscHtmlElement:ty,EShapeActionValueMiscInput:ey,EShapeActionValueMiscType:Er,EShapeActionValueMiscWrite:ny,EShapeActionValueMisc:Rs,EShapeActionValueOnInputAction:_s,EShapeActionValueOnInputActions:ms,EShapeActionValueOpenDialogExtension:Wu,EShapeActionValueOpenDialogType:Fu,EShapeActionValueOpenDialog:Hu,EShapeActionValueOpenExtension:Xu,EShapeActionValueOpenType:zs,EShapeActionValueOpen:Us,EShapeActionValueOpetyped:ul,EShapeActionValueShowHideLayer:Qu,EShapeActionValueShowHideShape:tl,EShapeActionValueShowHideType:Yu,EShapeActionValueShowHide:Zu,EShapeActionValueSubtyped:Me,EShapeActionValueTransformMoveType:ll,EShapeActionValueTransformMove:cl,EShapeActionValueTransformResizeType:pl,EShapeActionValueTransformResize:bl,EShapeActionValueTransformRotateType:Ol,EShapeActionValueTransformRotate:Cl,EShapeActionValueTransformType:hl,EShapeActionValueType:ke,EShapeActionValues:Le,EShapeAction:dt,EShapeActions:ns,loadShapeAll:qf,loadShapeBar:kl,loadShapeButton:th,loadShapeCircle:hh,loadShapeClipperEx:function(){cs=!0},isShapeClipperExLoaded:ps,loadShapeConnectorElbow:uc,loadShapeConnectorLine:lc,loadShapeEmbedded:vc,loadShapeGroupShadowed:xc,loadShapeGroup:Ec,loadShapeImage:Pc,loadShapeLabel:Xc,loadShapeLineOfCircles:wp,loadShapeLineOfRectangleRoundeds:xp,loadShapeLineOfRectangles:Pp,loadShapeLineOfTriangleRoundeds:Yp,loadShapeLineOfTriangles:tf,loadShapeLine:Zc,loadShapeNull:of,loadShapePolygon:Ef,loadShapeRectangleRounded:Df,loadShapeRectangle:Cf,loadShapeSemicircle:jf,loadShapeTriangleRounded:Yf,loadShapeTriangle:Vf,BAR_VERTEX_COUNT:4,BAR_INDEX_COUNT:2,buildBarIndex:g,buildBarVertexStep:v,buildBarUv:_,CIRCLE_VERTEX_COUNT:9,CIRCLE_INDEX_COUNT:8,CIRCLE_WORLD_SIZE:eh,buildCircleIndex:ih,buildCircleVertex:rh,buildCircleStep:oh,buildCircleUv:sh,buildColor:q,IMAGE_SDF_VERTEX_COUNT:9,IMAGE_SDF_INDEX_COUNT:8,IMAGE_SDF_WORLD_SIZE:Mc,buildImageSdfIndex:Lc,buildImageSdfStep:Nc,buildImageSdfVertex:Bc,buildImageSdfUv:zc,toLineOfAnyPointCount:tp,buildLineOfAnyColor:ep,toPointCount:dh,toLinePointCount:yh,toLineVertexCount:gh,toLineIndexCount:vh,buildLineIndex:_h,buildLineUv:mh,buildLineVertexStep:bh,buildNullIndex:function(t,e,n,i){for(var r=3*n,o=3*(n+i);r<o;r+=3)t[r+0]=e,t[r+1]=e,t[r+2]=e},buildNullVertex:Jc,buildNullStep:Qc,buildNullUv:$c,buildPolygonIndex:sf,buildPolygonVertex:af,buildPolygonStep:uf,buildPolygonStepX:lf,buildPolygonStepY:hf,buildPolygonUv:cf,RECTANGLE_ROUNDED_VERTEX_COUNT:Ll,RECTANGLE_ROUNDED_INDEX_COUNT:Nl,RECTANGLE_ROUNDED_WORLD_SIZE:Bl,buildRectangleRoundedIndex:Ul,buildRectangleRoundedVertex:jl,buildRectangleRoundedStep:Fl,buildRectangleRoundedUv:Hl,RECTANGLE_VERTEX_COUNT:Fh,RECTANGLE_INDEX_COUNT:8,RECTANGLE_WORLD_SIZE:Hh,buildRectangleIndex:Vh,buildRectangleVertex:Wh,buildRectangleStep:Kh,buildRectangleUv:Xh,SEMICIRCLE_VERTEX_COUNT:6,SEMICIRCLE_INDEX_COUNT:4,SEMICIRCLE_WORLD_SIZE:If,buildSemicircleIndex:Rf,buildSemicircleVertex:Pf,buildSemicircleStep:Mf,buildSemicircleUv:kf,TEXT_VERTEX_COUNT:4,TEXT_VERTEX_COUNT_SHIFT:2,TEXT_INDEX_COUNT:2,TEXT_INDEX_COUNT_SHIFT:1,TEXT_FMIN:S,toTextBufferCount:D,buildTextIndex:I,buildTextStep:A,buildTextVertex:P,TRIANGLE_ROUNDED_VERTEX_COUNT:Mp,TRIANGLE_ROUNDED_INDEX_COUNT:kp,TRIANGLE_ROUNDED_WORLD_SIZE:Lp,buildTriangleRoundedIndex:Bp,buildTriangleRoundedVertex:zp,buildTriangleRoundedStep:Up,buildTriangleRoundedUv:jp,TRIANGLE_VERTEX_COUNT:7,TRIANGLE_INDEX_COUNT:3,TRIANGLE_WORLD_SIZE:xh,buildTriangleIndex:Ih,buildTriangleVertex:Ah,buildTriangleStep:Rh,buildTriangleUv:Ph,BuilderBar:fe,BuilderBase:Q,BuilderCircle:ah,BuilderImageSdf:Uc,BuilderLabel:Gc,BuilderLineOfAny:sp,BuilderLineOfCircles:vp,BuilderLineOfRectangleRoundeds:Ep,BuilderLineOfRectangles:Dp,BuilderLineOfTriangleRoundeds:Fp,BuilderLineOfTriangles:qp,BuilderLine:Sh,BuilderMarkerCircleHead:zh,BuilderMarkerCircleTail:Uh,BuilderMarkerCircle:Bh,BuilderMarkerRectangleHead:Zh,BuilderMarkerRectangleTail:qh,BuilderMarkerRectangle:Yh,BuilderMarkerTriangleHead:Lh,BuilderMarkerTriangleTail:Nh,BuilderMarkerTriangle:kh,BuilderNull:jh,BuilderPolygon:bf,BuilderRectanglePivoted:hc,BuilderRectangleRounded:Gl,BuilderRectangle:Dc,BuilderSemicircle:Lf,BuilderText:de,BuilderTriangleRounded:Wf,BuilderTriangle:Ff,BuilderFlag:Y,toTransformLocalId:$,toTexture:tt,toTextureTransformId:et,toTextureUvs:nt,copyIndex:ap,copyStep:up,copyUvs:lp,copyVertex:hp,createBarUploaded:ye,createButtonUploaded:Wl,createCircleUploaded:uh,createRectanglePivotedUploaded:cc,createGroupUploaded:pc,createImageSdfUploaded:jc,createImageSdf:iy,createImage:function(t){return Rl(t).then((function(t){return new Ac(t)}))},createLabelUploaded:Vc,createLineOfAnyUploaded:_p,createLineOfCirclesUploaded:mp,createLineOfRectangleRoundedsUploaded:Op,createLineOfRectanglesUploaded:Ip,createLineOfTriangleRoundedsUploaded:Hp,createLineOfTrianglesUploaded:Zp,createLineUploaded:ec,createLine:function(t,e,n,i){for(var r=yi(t,[0,0,0,0]),o=.5*(r[2]+r[0]),s=.5*(r[3]+r[1]),a=r[2]-r[0],u=r[3]-r[1],l=[],h=0,c=t.length;h<c;h+=2)l.push(t[h]-o,t[h+1]-s);var p=new Yc;return p.stroke.set(!0,void 0,void 0,n),p.transform.position.set(o,s),p.size.set(a,u),p.points.set(l,e,i),p},createNullUploaded:ef,createPolygonUploaded:Tf,createPolygon:function(t,e){null!=e||(e=new mf);var n=t.length;if(n<2)return e.points.values=[],e;var i=0,r=0,o=0,s=0;i=r=t[0],o=s=t[1];for(var a=2;a<n;a+=2){var u=t[a],l=t[a+1];i=Math.min(i,u),r=Math.max(r,u),o=Math.min(o,l),s=Math.max(s,l)}var h=r-i,c=s-o,p=i+.5*h,f=o+.5*c,d=[];for(a=0;a<n;a+=2)d.push(t[a]-p,t[a+1]-f);return e.lock(zt.ALL),e.transform.position.set(p,f),e.size.set(h,c),e.points.values=d,e.unlock(zt.ALL,!0),e},createRectangleRoundedUploaded:Vl,createRectangleUploaded:Ic,createSemicircleUploaded:Nf,createTriangleRoundedUploaded:Kf,createTriangleUploaded:Hf,deserializeAll:ri,deserializeBar:Ml,deserializeBase:Pl,deserializeButton:Zl,deserializeCircle:lh,deserializeConnectorElbow:rc,deserializeConnectorLine:sc,onDeserializedConnectorLine:ac,deserializeEmbeddedAcceptorEdge:gc,deserializeEmbeddedLayer:Sr,deserializeEmbedded:yc,deserializeGradient:Il,deserializeGroupShadowed:Sc,deserializeGroup:wc,deserializeImageSdf:Hc,deserializeImage:Rc,deserializeLabel:Kc,deserializeLineOfCircles:Tp,deserializeLineOfRectangleRoundeds:Sp,deserializeLineOfRectangles:Rp,deserializeLineOfTriangleRoundeds:Xp,deserializeLineOfTriangles:$p,deserializeLine:qc,deserializeNull:rf,deserializePolygon:wf,deserializeRectanglePivoted:Sf,deserializeRectangleRounded:xf,deserializeRectangle:Of,deserializeSemicircle:Uf,deserializeTriangleRounded:Xf,deserializeTriangle:Gf,deserialize:ii,EShapeBarPoints:ht,EShapeBarPosition:lt,EShapeBar:pe,EShapeBaseHitTestData:Mt,EShapeBase:jt,EShapeButtonRuntimeActionToggle:Ql,EShapeButtonRuntimeAction:Jl,EShapeButtonRuntime:$l,EShapeButton:ql,EShapeCircle:Wn,EShapeConnectorElbowPointsFiller:nc,EShapeConnectorElbow:ic,EShapeConnectorLine:Bi,EShapeEmbeddedAcceptorEdge:Kn,EShapeEmbeddedAcceptor:li,EShapeEmbeddedDatum:si,EShapeEmbeddedLayerContainer:xr,EShapeEmbeddedLayer:ar,EShapeEmbedded:ei,EShapeEmbeddeds:ry,EShapeFillImpl:st,EShapeGroupFillEditor:_c,EShapeGroupFillViewer:Qn,EShapeGroupPoints:mc,EShapeGroupShadowed:Cc,EShapeGroupSizeEditor:Zn,EShapeGroupSizeLayout:qn,EShapeGroupSizeShadowed:Oc,EShapeGroupSizeViewer:Jn,EShapeGroupStrokeEditor:bc,EShapeGroupStrokeViewer:$n,EShapeGroupViewer:ti,EShapeGroup:Tc,EShapeImageSdf:Fc,EShapeImage:Ac,EShapeLabel:Wc,EShapeLineBaseHitPart:ct,EShapeLineBase:ce,EShapeLineOfAnyPointsFillImpl:fp,EShapeLineOfAnyPointsImpl:gp,EShapeLineOfAnyPointsPointImpl:dp,EShapeLineOfAnyPointsStrokeImpl:yp,EShapeLineOfCircles:bp,EShapeLineOfRectangleRoundeds:Cp,EShapeLineOfRectangles:Ap,EShapeLineOfTriangleRoundeds:Kp,EShapeLineOfTriangles:Qp,EShapeLinePoints:Li,EShapeLine:Yc,EShapeLockPart:zt,EShapeLock:Bt,EShapeNull:nf,EShapePolygonTriangulatedImpl:_f,EShapePolygon:mf,EShapePrimitive:oe,EShapeRectanglePivoted:Ao,EShapeRectangleRounded:Yl,EShapeRectangle:Io,EShapeSemicircle:zf,EShapeStrokeImpl:Ft,EShapeTextAlignImpl:te,EShapeTextImpl:ie,EShapeTextOffsetImpl:ee,EShapeTextOutlineImpl:ne,EShapeTriangleRounded:Wp,EShapeTriangle:Jp,hitTestBBox:kt,hitTestCircle:se,hitTestSemicircle:Bf,hitTestRectangleRounded:Xl,hitTestRectangle:ae,hitTestTriangleRounded:Vp,hitTestTriangleFilled:ue,hitTestTriangle:le,isStatic:cp,toComputed:pp,toDash:a,toGradientImageUrl:function(t){for(var e=t.direction,n=t.points,i="",r=0,o=n.length;r<o;++r){var s=n[r],a=ve.toCode(s.color),u=s.alpha,l=100*s.position;i+='<stop offset="'.concat(l,'%" stop-color="#').concat(a,'" stop-opacity="').concat(u,'" />')}var h=e*Math.PI/180,c=.5*Math.cos(h),p=-.5*Math.sin(h);return oy('<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32"><defs>'+'<linearGradient id="o2glkm3aeu2oio" x1="'.concat(.5-c,'" x2="').concat(.5+c,'" y1="').concat(.5-p,'" y2="').concat(.5+p,'">')+i+'</linearGradient></defs><rect x="0" y="0" width="32" height="32" stroke="none" fill="url(#o2glkm3aeu2oio)" /></svg>')},toGradientSerialized:re,toImageElement:Rl,toLength:O,toResized:function(t,e,n,i,r){var o=Xn.contains(t,Lt.POSITION),s=Xn.contains(t,Lt.WIDTH),a=Xn.contains(t,Lt.HEIGHT);t.lock(zt.UPLOADED);var u=t.transform.position;if(i){var l=Math.abs(n.x-e.x),h=Math.abs(n.y-e.y);if(r){var c=Math.max(l,h),p=Yn(c+c),f=sy(e.x),d=sy(e.y),y=t.size;s&&a?y.set(p,p):s?y.x=p:a&&(y.y=p),o&&u.set(f,d)}else{var g=Yn(l+l),v=Yn(h+h);f=sy(e.x),d=sy(e.y),y=t.size,s&&a?y.set(g,v):s?y.x=g:a&&(y.y=v),o&&u.set(f,d)}}else if(r){l=n.x-e.x,h=n.y-e.y,c=Math.max(Math.abs(l),Math.abs(h));var _=e.x+(l<0?-c:+c),m=e.y+(h<0?-c:+c),b=.5*c;p=Yn(c),f=sy(Math.min(e.x,_)+b),d=sy(Math.min(e.y,m)+b),y=t.size,s&&a?y.set(p,p):s?y.x=p:a&&(y.y=p),o&&u.set(f,d)}else{var T=Math.min(e.x,n.x),w=Math.min(e.y,n.y),E=.5*(l=Math.max(e.x,n.x)-T),O=.5*(h=Math.max(e.y,n.y)-w);g=Yn(l),v=Yn(h),f=sy(T+E),d=sy(w+O),y=t.size,s&&a?y.set(g,v):s?y.x=g:a&&(y.y=v),o&&u.set(f,d)}t.unlock(zt.UPLOADED,!0)},toScaleInvariant:u,toSizeNormalized:Yn,toSizeRounded:sy,toThresholdDefault:he,EShapeAcceptorEdgeSide:Gn,EShapeAcceptorEdgeType:Vn,EShapeAcceptorImpl:ui,EShapeAcceptorType:ay,EShapeAcceptors:hi,EShapeBufferUnitBuilder:tr,EShapeBufferUnit:$i,EShapeBuffer:er,EShapeCapabilities:Xn,EShapeCapabilityContainerImpl:Nt,EShapeCapability:Lt,EShapeConnectorBodies:oc,EShapeConnectorBodyImpl:Ni,EShapeConnectorContainerImpl:yt,EShapeConnectorEdgeAcceptorImpl:ci,EShapeConnectorEdgeContainerImpl:fi,EShapeConnectorEdgeImpl:pi,EShapeConnectors:zi,EShapeContainer:sr,EShapeCopyPart:gt,EShapeCorner:pt,EShapeDataImpl:$t,EShapeDataMapperImpl:jn,EShapeDataMappingImpl:Zt,EShapeDataScopedImpl:Jt,EShapeDataSystemImpl:Qt,EShapeDataValueExtensions:jo,EShapeDataValueImpl:qt,EShapeDataValueOrder:Vt,EShapeDataValueRangeImpl:Gt,EShapeDataValueRangeType:Ht,EShapeDataValueScope:Kt,EShapeDataValueState:Xt,EShapeDataValueType:Wt,EShapeDefaults:rt,EShapeDeserializers:e,EShapeOnDeserializeds:n,EShapeEditor:function(){this.localTransform=new t.Matrix,this.internalTransform=new t.Matrix,this.internalTransformParentInverse=new t.Matrix,this.rotation=0,this.size=new t.Point},EShapeFillDirection:J,EShapeLayerState:Cr,toPointsBoundary:yi,eShapePointsFormatterCurveBezierQuadratic:Mi,eShapePointsFormatterCurve:Ii,EShapePointsFormatters:ki,EShapePointsMarkerBase:gi,EShapePointsMarkerContainerImplNoop:ut,EShapePointsMarkerContainerImpl:mi,EShapePointsMarkerHead:vi,EShapePointsMarkerNoop:at,EShapePointsMarkerTail:_i,EShapePointsMarkerType:ot,EShapePointsStyle:X,EShapePointsStyles:uy,EShapeRendererIteratorDatum:ir,EShapeRendererIterator:rr,EShapeRenderer:or,EShapeResourceManagerDeserializationMode:Hn,EShapeResourceManagerDeserialization:Fn,EShapeResourceManagerSerialization:ly,EShapeRuntimeImpl:Do,EShapeRuntimeReset:_e,EShapeRuntimes:ko,EShapeStateSetImplObservable:Rt,EShapeState:At,EShapeStrokeSide:Z,EShapeStrokeStyle:s,EShapeTextAlignHorizontal:T,EShapeTextAlignVertical:w,EShapeTextDirection:E,EShapeTextWeight:m,EShapeTextStyle:b,EShapeTransformImpl:Pt,EShapeType:i,EShapeUploadedImpl:o,EShapeUploadeds:r,EShapeUuidMappingImpl:ni,ESnapperGrid:hy,ESnapperResultScale:function(){this.distance=NaN,this.scale=new t.Point},ESnapperResult:cy,ESnapperTargetValueType:py,ESnapperTargetValue:fy,ESnapperTarget:dy,ESnapperModifierAnchor:gy,ESnapper:vy,DThemes:it,FormatNodeA:$e,FormatNodea:tn,FormatNodeD:en,FormatNoded:nn,FormatNodee:on,FormatNodef:sn,FormatNodefsi:an,FormatNodeg:un,FormatNodeH:ln,FormatNodeh:hn,FormatNodeM:cn,FormatNodem:pn,FormatNodemi:fn,FormatNodeP:dn,FormatNodep:yn,FormatNodePadding:gn,FormatNodeParenthesis:vn,FormatNodePlus:_n,FormatNodePrecision:rn,FormatNoderd:Dn,FormatNodeRP:mn,FormatNoderp:bn,FormatNodesdt:Tn,FormatNodeSpace:wn,FormatNodessi:En,FormatNodeString:On,FormatNodeY:Cn,FormatNodey:Sn,FormatNodez:xn,FormatNodes:In,Character:C,DynamicAtlasItemEmpty:ji,DynamicAtlasItemFontAtlas:Gi,DynamicAtlasItemImage:Qi,DynamicAtlasItemText:_y,DynamicAtlasItemWhite:Fi,DynamicAtlasItem:Ui,DynamicAtlas:Hi,DynamicFontAtlasCharacterOrigin:Vi,DynamicFontAtlasCharacterType:Ki,DynamicFontAtlasCharacter:Wi,DynamicFontAtlasFont:my,DynamicFontAtlas:by,DynamicFontAtlases:Cy,DynamicSDFFontAtlasFont:Xi,DynamicSDFFontAtlas:Zi,DynamicSDFFontAtlases:Ji,DynamicSDFFontGenerator:Yi,isArray:Ot,isFunction:Ct,isNaN:Nu,isNumber:St,isObject:Sy,isString:xt,Lazy:xy,NumberFormatterImpl:Mn,NumberFormatters:kn,toCeilingIndex:Dy,toCloned:Iy,toEnum:ai,toId:function(t){if(null!=t){if(xt(t))return t;if(St(t))return t;if("id"in t)return t.id;if("name"in t)return t.name;if("label"in t)return t.label}return 0},toIndexOf:di,toLabel:Ay,toMerged:Ry,toPadded:ge,toString:function(t){return null!=t?String(t):""},toSvgTexture:function(e,n){return t.Texture.from(oy(e),{resolution:n})},toSvgUrl:oy,UtilAlpha:Be,UtilSvgAtlasBuilder:Py,UtilAttachAlign:js,UtilAttach:Fs,UtilCharacterIterator:_a,UtilClickOutside:Xs,UtilClipboard:ud,UtilGestureData:pr,UtilGestureEasingHistory:yr,UtilGestureEasing:gr,UtilGestureMode:lo,UtilGestureModifier:lr,UtilGestureModifiers:hr,UtilGestureTap:vr,UtilGesture:_r,UtilExtract:bo,UtilExtractorCanvas:yo,UtilExtractor:go,UtilFileDownloader:vo,UtilFileAs:My,UtilFileOpener:ky,UtilFont:qi,UtilHsv:Ly,UtilHtmlElementClipperExImpl:as,UtilHtmlElementClipperExRectsImpl:us,UtilHtmlElementWhen:ls,UtilHtmlElement:hs,UtilInputInput:gs,UtilInputNumber:vs,UtilInputTextArea:Ny,UtilInputText:Cs,UtilInput:ys,UtilKeyboardEvent:no,UtilName:By,UtilOverlay:Ys,UtilPointerEvent:cr,UtilPolygon:ff,UtilRgb:ve,UtilRgba:zy,UtilStateBlinker:Uy,UtilStraightSkeletonBufferBuilder:gf,UtilStraightSkeletonBuffer:vf,UtilStraightSkeletonWavefront:df,UtilStraightSkeleton:yf,UtilTransition:jy,UtilWheelEvent:Fy,DAlignHorizontal:ra,DAlignVertical:oa,DAlignWith:ia,DAnimationBase:dr,DAnimationEmpty:Hy,DAnimationFadeIn:Gy,DAnimationTimings:fr,DApplicationLayerOptions:Wy,DApplicationLayer:Jy,DApplicationPadding:Vy,DApplication:$y,DApplications:ft,DBaseAutoSet:ro,DBaseAuto:io,DBaseBackgroundMeshGeometry:jr,DBaseBackgroundMesh:Fr,DBaseBackgroundSnippet:Hr,DBaseBackground:Ar,DBaseBorderMeshGeometry:Gr,DBaseBorderMesh:Vr,DBaseBorderSnippet:Wr,DBaseBorder:Pr,DBaseCorner:kr,DBaseInteractive:Lr,DBaseMeshGeometry:Ur,DBaseOutlineSnippet:Kr,DBaseOutline:Nr,DBaseOverflowMaskSimple:ya,DBaseOverflowMask:uo,DBasePaddingAdjustable:tg,DBasePadding:Br,DBasePoint:zr,DBaseReflowableContainer:so,DBaseReflowableImpl:Xr,DBaseSnippetContainer:oo,DBaseStateSetBlinkerDatumImpl:mt,DBaseStateSetBlinkerImpl:Tt,DBaseStateSetImplObservable:It,DBaseStateSetImpl:Dt,DBaseStateSetSubDatumImp:_t,DBaseStateSetSubImpl:bt,DBaseStateSetTickerDatumImpl:wt,DBaseStateSetTickerImpl:Et,DBaseState:vt,DBase:ao,DBoard:eg,DBorderMask:Rr,DButtonAmbient:Ha,DButtonBaseWhen:na,DButtonBase:Ba,DButtonCheckRight:ig,DButtonCheck:ng,DButtonColorGradient:Dg,DButtonColor:Ag,DButtonDanger:Rg,DButtonDate:Pg,DButtonDatetime:Ng,DButtonFileAs:My,DButtonFile:Bg,DButtonGroup:Ya,DButtonLink:zg,DButtonPrimary:Ua,DButtonRadioRight:jg,DButtonRadio:Ug,DButtonRedo:Fg,DButtonSecondary:Hg,DButtonSelect:xv,DButtonTime:Dv,DButtonUndo:Iv,DButton:za,DCanvasContainer:fo,DCanvas:Eo,DChartAxisBaseBar:Rv,DChartAxisBaseGuideContainer:Pv,DChartAxisBaseOptionParser:kv,DChartAxisBaseTickContainer:Uv,DChartAxisBaseTickMajorGridline:Lv,DChartAxisBaseTickMajor:Nv,DChartAxisBaseTickMinor:Bv,DChartAxisBase:jv,DChartAxisContainerImpl:Fv,DChartAxisGuideSimpleShapeImpl:Hv,DChartAxisGuideSimple:Gv,DChartAxisPosition:Av,DChartAxisTickPosition:Mv,DChartAxisXDatetime:Wv,DChartAxisX:Vv,DChartAxisY:Kv,DChartColorSet1:function(t){return Xv[t%Xv.length]},DChartColorSet2:qv,DChartCoordinateBase:$v,DChartCoordinateContainerImpl:e_,DChartCoordinateContainerSubImpl:t_,DChartCoordinateDirection:Zv,DChartCoordinateLinearTick:n_,DChartCoordinateLinear:i_,DChartCoordinateLogTick:r_,DChartCoordinateLog:o_,DChartCoordinateTransformImpl:Jv,DChartCoordinateTransformMarkImpl:Qv,DChartLegendItem:s_,DChartLegend:a_,DChartOverview:u_,DChartPlotAreaBase:l_,DChartPlotAreaContainer:h_,DChartPlotAreaOnefold:w_,DChartPlotAreaTwofoldAxisContainer:E_,DChartPlotAreaTwofoldCoorinateContainerSub:O_,DChartPlotAreaTwofoldCoorinateContainer:C_,DChartPlotAreaTwofoldOverflowMaskPrimary:S_,DChartPlotAreaTwofoldOverflowMaskSecondary:x_,DChartPlotAreaTwofoldSeriesContainer:D_,DChartPlotAreaTwofoldSubBase:I_,DChartPlotAreaTwofoldSubPrimary:A_,DChartPlotAreaTwofoldSubSecondary:R_,DChartPlotAreaTwofoldViewTargetPoint:P_,DChartPlotAreaTwofoldViewTarget:M_,DChartPlotAreaTwofold:k_,DChartRegionImplObservable:L_,DChartRegionImpl:zv,DChartSelectionContainerImpl:N_,DChartSelectionGridlineX:z_,DChartSelectionGridlineY:U_,DChartSelectionMarker:j_,DChartSelectionShapeBase:B_,DChartSelectionSimple:G_,DChartSelectionSubImpl:H_,DChartSelectionPoint:F_,DChartSeriesBar:X_,DChartSeriesBaseCoordinateContainer:V_,DChartSeriesBase:W_,DChartSeriesContainerImpl:T_,DChartSeriesFillComputedImpl:p_,DChartSeriesFillImpl:d_,DChartSeriesLineOfAny:K_,DChartSeriesLineOfCircles:Y_,DChartSeriesLineOfRectangleRoundeds:q_,DChartSeriesLineOfRectangles:Z_,DChartSeriesLineOfTriangleRoundeds:Q_,DChartSeriesLineOfTriangles:J_,DChartSeriesLine:$_,DChartSeriesExpressionParametersImpl:tm,DChartSeriesLinear:em,DChartSeriesPaddingComputedImpl:y_,DChartSeriesPaddingImpl:g_,DChartSeriesPointComputedImpl:v_,DChartSeriesPointImpl:__,DChartSeriesScalars:f_,DChartSeriesStrokeComputedImpl:m_,DChartSeriesStrokeImpl:b_,DChartSeriesHitResult:c_,DChart:nm,DColorGradientObservable:sg,DColorGradientPointObservable:rg,DColorRecent:bg,DColorRecents:Tg,DColorStandard:_g,DColorStandards:mg,DColorType:vg,DCommandBase:Ky,DCommandClear:Xy,DCommandCreate:im,DCommandSaveAs:rm,DCommandSave:om,DContent:rv,DControllerCommandImpl:Yy,DControllerFocusImpl:Qy,DControllerKeyboardImpl:qy,DControllers:Zy,DCornerMask:Mr,DDiagramBaseControllerOpenType:Un,DDiagramBase:wo,DDiagramCanvasBase:Mo,DDiagramCanvasBaseShapeImpl:No,DDiagramCanvasDataImpl:Lo,DDiagramCanvasEditorBackground:Oo,DDiagramCanvasEditorShapeImpl:sm,DDiagramCanvasEditorSnap:am,DDiagramCanvasEditor:um,DDiagramCanvasTileMappingImpl:So,DDiagramCanvasTileMappingPointImpl:Co,DDiagramCanvasShapeImpl:Bo,DDiagramCanvasTickerImpl:Uo,DDiagramCanvasTile:xo,DDiagramCanvas:Yo,DDiagramDataImpl:ts,DDiagramDataPrivateImpl:Zo,DDiagramDataRemoteImpl:Qo,DDiagramEditorThumbnail:lm,DDiagramEditor:hm,DDiagramLayerContainer:Po,DDiagramLayer:Ro,DDiagramLayers:ur,DDiagramSerializedVersion:1,DDiagramShape:qo,DDiagramSnapshot:To,DDiagramTicker:zo,DDiagram:es,DDiagrams:Dr,DDialogAlign:js,DDialogCloseOn:Hs,DDialogColorGradient:xg,DDialogColor:Ig,DDialogConfirmDelete:fm,DDialogConfirmDiscard:dm,DDialogConfirmMessage:cm,DDialogConfirm:pm,DDialogDate:Uu,DDialogDatetime:Mu,DDialogFittedContent:du,DDialogFitted:yu,DDialogGestureImpl:Vs,DDialogGestureMode:Gs,DDialogInputBoolean:Qa,DDialogInputInteger:su,DDialogInputReal:lu,DDialogInputText:pu,DDialogInput:Xa,DDialogLayeredContent:ea,DDialogLayeredFooter:Fa,DDialogLayeredHeaderButtonClose:Ga,DDialogLayeredHeaderSeparator:Va,DDialogLayeredHeader:Wa,DDialogLayered:Ka,DDialogMessage:ym,DDialogMode:Ws,DDialogProcessingMessage:gm,DDialogProcessing:vm,DDialogSaveAs:_m,DDialogSelectListItemUpdater:Yg,DDialogSelectListItem:Wg,DDialogSelectList:gv,DDialogSelectSearhImpl:vv,DDialogSelect:Ov,DDialogState:Ks,DDialogTime:Lu,DDialog:qs,DDropdownBase:dg,DDropdown:mm,DDynamicTextGeometry:Ta,DDynamicTextMeasureResultCharacter:ga,DDynamicTextMeasureResult:va,DDynamicTextMeasure:ba,DDynamicTextStyleWordWrap:ma,DDynamicTextStyle:Ea,DDynamicText:wa,DExpandableHeader:bm,DExpandable:Tm,DHtmlElementState:ss,DHtmlElement:eu,DImageBaseThemeWrapperOther:Da,DImageBaseThemeWrapperSecondary:Ia,DImageBaseThemeWrapperTertiary:Aa,DImageBase:Na,DImagePieceAlignImpl:Ma,DImagePieceContainerImpl:La,DImagePieceImpl:ka,DImagePieceLayouterPartBottom:aa,DImagePieceLayouterPartCenter:ua,DImagePieceLayouterPartContainer:fa,DImagePieceLayouterPartLeft:la,DImagePieceLayouterPartMiddle:ha,DImagePieceLayouterPartRight:ca,DImagePieceLayouterPartTop:pa,DImagePieceLayouterPart:sa,DImagePieceLayouter:da,DImagePieceMarginImpl:Pa,DImagePieceTintImpl:Ra,DImage:Zf,DIndicatorProcessingState:wm,DIndicatorProcessing:Em,DInputAndLabel:ug,DInputBooleanButtonOff:qa,DInputBooleanButtonOn:Za,DInputBoolean:Ja,DInputInput:iu,DInputIntegerAndLabel:Om,DInputInteger:ou,DInputLabel:ag,DInputNumber:ru,DInputRealAndLabel:lg,DInputReal:uu,DInputSearch:_v,DInputTextAndLabel:hg,DInputTextArea:Cm,DInputText:cu,DInput:nu,DItemUpdater:Kg,DLayoutBoard:Sm,DLayoutClearType:Yr,DLayoutDirection:Zs,DLayoutHorizontal:ja,DLayoutSpace:Js,DLayoutVertical:ta,DLayout:$s,DLinkMenuItemId:nd,DLinkMenu:rd,DLinkTarget:od,DLink:ld,DLinks:hd,DListDataImpl:iv,DListDataMappedImpl:qg,DListDataSelectionMultiple:Zg,DListDataSelectionNone:Jg,DListDataSelectionSingle:Qg,DListDataSelectionType:Gg,DListItemAccessorImpl:nv,DListItemAmbient:xm,DListItemUpdater:Xg,DListItem:Vg,DList:yv,DMapCoordinateEPSG3857:Dm,DMapCoordinates:Im,DMapTilePlane:Rm,DMapTilePyramidImpl:Pm,DMapTileUrlBuilderKokudo:function(t,e,n){return 5<=t?"https://cyberjapandata.gsi.go.jp/xyz/pale/".concat(t,"/").concat(e,"/").concat(n,".png"):2<=t?"https://cyberjapandata.gsi.go.jp/xyz/std/".concat(t,"/").concat(e,"/").concat(n,".png"):"https://cyberjapandata.gsi.go.jp/xyz/earthhillshade/".concat(t,"/").concat(e,"/").concat(n,".png")},DMapTileUrlBuilderOsm:function(t,e,n){return"https://".concat("abc"[(e+n)%3],".tile.openstreetmap.org/").concat(t,"/").concat(e,"/").concat(n,".png")},DMapTileUrlBuilderOsmfj:Mm,DMapTilePyramids:km,DMapTile:Am,DMenuAlign:js,DMenuBarItem:Lm,DMenuBar:Nm,DMenuContext:pg,DMenuItemBase:Jf,DMenuItemCheckIsCompatible:ed,DMenuItemCheck:td,DMenuItemExpandableBody:wd,DMenuItemExpandableHeader:Ed,DMenuItemExpandableIsCompatible:Sd,DMenuItemExpandableItemCheck:xd,DMenuItemExpandableItemLink:Dd,DMenuItemExpandableItemMenu:Wd,DMenuItemExpandableItemSeparator:Id,DMenuItemExpandableItemSpace:Ad,DMenuItemExpandableItemText:Rd,DMenuItemExpandable:Cd,DMenuItemExpandables:Od,DMenuItemLinkIsCompatible:pd,DMenuItemLink:cd,DMenuItemMenuIsCompatible:dd,DMenuItemMenuToSubMenuOptions:yd,DMenuItemMenu:fd,DMenuItemSeparatorReflowable:gd,DMenuItemSeparatorIsCompatible:vd,DMenuItemSeparator:_d,DMenuItemSpaceIsCompatible:bd,DMenuItemSpace:md,DMenuItemText:$f,DMenuItem:Qf,DMenuItems:yg,DMenuSidedContent:Bm,DMenuSidedItemCheck:Md,DMenuSidedItemExpandableItemCheck:Gd,DMenuSidedItemExpandableItemLink:Vd,DMenuSidedItemExpandableItemMenu:Kd,DMenuSidedItemExpandableItemSeparator:Xd,DMenuSidedItemExpandableItemSpace:Yd,DMenuSidedItemExpandableItemText:qd,DMenuSidedItemExpandable:Hd,DMenuSidedItemExpandables:Fd,DMenuSidedItemLink:kd,DMenuSidedItemMenu:Ld,DMenuSidedItemSeparator:Nd,DMenuSidedItemSpace:Bd,DMenuSidedItemText:zd,DMenuSidedSelectionType:zm,DMenuSidedSelection:jm,DMenuSided:Fm,DMenuSideds:Ud,DMenu:fg,DMenus:id,DNoteError:Hm,DNoteNoItemsFound:Gm,DNoteSearching:Vm,DNoteSmallError:Tv,DNoteSmallNoItemsFound:wv,DNoteSmallSearching:Ev,DNoteSmall:bv,DNote:mv,DNotification:Wm,DPaginationButtonLast:Km,DPaginationButtonNext:Xm,DPaginationButtonPage:Ym,DPaginationButtonPrevious:qm,DPaginationButtonTop:Zm,DPaginationDots:Jm,DPaginationPage:Qm,DPagination:$m,DPaneScrollBar:fv,DPane:dv,DPickerColorAndAlpha:cg,DPickerColorGradientRecent:Og,DPickerColorGradientView:Cg,DPickerColorGradient:Sg,DPickerColor:wg,DPickerDate:zu,DPickerDates:Mg,DPickerDatetimeButtonBack:gu,DPickerDatetimeButtonDate:vu,DPickerDatetimeButtonNext:_u,DPickerDatetimeLabelDate:Tu,DPickerDatetimeLabel:bu,DPickerDatetimeMask:Eu,DPickerDatetimeMasks:Ou,DPickerDatetimeRange:tb,DPickerDatetimeSpace:wu,DPickerDatetime:Pu,DPickerDatetimes:Lg,DPickerTimeBoundHours:Su,DPickerTimeBoundMinutes:xu,DPickerTimeBoundSeconds:Du,DPickerTimeBound:Cu,DPickerTimeBounds:Iu,DPickerTimeRange:eb,DPickerTime:Ru,DPickerTimes:kg,DScalarExpressionNodeType:qr,DScalarExpression:Zr,DScalarFunctions:eo,DScrollBarHorizontal:lv,DScrollBarThumbHorizontal:uv,DScrollBarThumbReflowableHorizontal:av,DScrollBarThumbReflowableVertical:hv,DScrollBarThumbVertical:cv,DScrollBarThumb:sv,DScrollBarVertical:pv,DScrollBar:ov,DSelectMultiple:nb,DSelect:gg,DShadowImpl:ib,DSliderHorizontal:hb,DSliderLabel:rb,DSliderThumb:ob,DSliderTrackHorizontal:lb,DSliderTrackVertical:cb,DSliderTrack:ub,DSliderValue:sb,DSliderVertical:pb,DSlider:ab,DTableBodyCellActionDialog:yb,DTableBodyCellActionMenu:gb,DTableBodyCellActionPromise:_b,DTableBodyCellButton:bb,DTableBodyCellCheck:Eb,DTableBodyCellColor:Ob,DTableBodyCellDate:Cb,DTableBodyCellDatetime:Sb,DTableBodyCellIndex:xb,DTableBodyCellInputInteger:Db,DTableBodyCellInputReal:Ib,DTableBodyCellInputTextArea:Ab,DTableBodyCellInputText:Rb,DTableBodyCellInputTreeInput:Pb,DTableBodyCellInputTreeMarker:Mb,DTableBodyCellInputTree:Lb,toLinkOptions:Nb,toUrl:Bb,toChecker:zb,DTableBodyCellLink:Ub,DTableBodyCellSelectDialog:db,DTableBodyCellSelectMenu:jb,DTableBodyCellSelectMultiple:Fb,DTableBodyCellSelectPromise:vb,DTableBodyCellTextArea:Hb,DTableBodyCellText:mb,DTableBodyCellTime:Gb,DTableBodyCellTree:Vb,DTableBodyCells:fb,DTableBodyRow:Xb,DTableBody:eT,DTableCategoryCell:rT,DTableCategoryColumnImpl:oT,DTableCategoryContainerImpl:aT,DTableCategory:sT,DTableCellEdgeHovered:nT,DTableCellEdge:iT,DTableColumnContainerImpl:bT,DTableColumnImpl:mT,DTableColumnType:Tb,DTableColumnUpdate:wb,DTableDataListFilter:Yb,DTableDataListMapped:qb,DTableDataListSelection:Jb,DTableDataListSorter:$b,DTableDataList:tT,DTableDataSelectionType:Wb,DTableDataOrder:Qb,DTableDataTreeFilter:TT,DTableDataTreeItemAccessor:CT,DTableDataTreeSelectionImpl:xT,DTableDataTreeSorter:DT,DTableDataTree:IT,DTableHeaderCellCheck:AT,DTableHeaderCell:RT,DTableHeader:PT,DTableRow:Kb,DTableScrollBar:MT,DTableState:kb,DTable:kT,DTextBase:xa,DTextPieceAlignImpl:Oa,DTextPieceImpl:Sa,DTextPieceStyleImpl:Ca,DText:mu,DTreeDataImpl:KT,DTreeDataMappedImpl:HT,DTreeDataSelectionMultiple:GT,DTreeDataSelectionNone:WT,DTreeDataSelectionSingle:VT,DTreeDataSelectionType:FT,DTreeItemButton:qT,DTreeItemNonEditable:ZT,DTreeItemState:XT,DTreeItemText:YT,DTreeItemUpdater:JT,DTreeNodeAccessorImpl:jT,DTree:QT,DViewGestureImpl:ho,DViewImpl:po,DViewTransformImpl:co};Qd();var tw=window;tw.wcardinal=tw.wcardinal||{},tw.wcardinal.ui=$T}(PIXI);
//# sourceMappingURL=wcardinal-ui.min.js.map
